[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1574291320, "post_id": 58964788, "comment_id": 104184667, "body": "you must activate the workbook and worksheet before trying to select a cell."}, {"owner": {"reputation": 39, "user_id": 12401306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0398ce99e0e65db50c2fa20fb48d53c?s=128&d=identicon&r=PG&f=1", "display_name": "Mturks83", "link": "https://stackoverflow.com/users/12401306/mturks83"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1574291741, "post_id": 58964788, "comment_id": 104184807, "body": "Thanks Scott - the strange thing is there is code exactly the same as the above the runs before it but for different data &amp; it works?"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 1, "creation_date": 1574291857, "post_id": 58964788, "comment_id": 104184850, "body": "@Mturks83 which is probably the reason the second set does not work, the other workbook is the active workbook."}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1574293159, "creation_date": 1574293159, "answer_id": 58965061, "question_id": 58964788, "link": "https://stackoverflow.com/questions/58964788/select-method-of-range-class-failed-in-vba-when-excel-cell-is-selected/58965061#58965061", "title": "Select Method of Range Class Failed in VBA when Excel cell is selected", "body": "<p>First things first - try to avoid <code>.Select</code> and the <code>.Activate</code> from every VBA - <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>.</p>\n\n<p>Concerning the error - it appears, because it is trying to select a cell in a non-selected worksheet. To avoid it, try adding this:</p>\n\n<p>Before this line:</p>\n\n<pre><code>Workbooks(\"PS &amp; Config - Actuals &amp; FC.xlsm\").Worksheets(3).Range(\"a1\").Select\n</code></pre>\n\n<p>Write this line:</p>\n\n<pre><code>Workbooks(\"PS &amp; Config - Actuals &amp; FC.xlsm\").Worksheets(3).Select\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 12401306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0398ce99e0e65db50c2fa20fb48d53c?s=128&d=identicon&r=PG&f=1", "display_name": "Mturks83", "link": "https://stackoverflow.com/users/12401306/mturks83"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574293192, "creation_date": 1574291144, "last_edit_date": 1574293192, "question_id": 58964788, "link": "https://stackoverflow.com/questions/58964788/select-method-of-range-class-failed-in-vba-when-excel-cell-is-selected", "title": "Select Method of Range Class Failed in VBA when Excel cell is selected", "body": "<p>Very new VBA user here. I keep getting an error when I have copied over a range of cells from 1 workbook to another &amp; then go to select a new cell. When I open the workbook that the data was copied too there is still the selection active where the data was pasted &amp; I'm thinking this is causing the error but I would expect once I clicked a new cell the selection should cancel?</p>\n\n<p>The error is occurring in the 3rd line of code: </p>\n\n<blockquote>\n  <p>'Select Method of Range Class Failed'</p>\n</blockquote>\n\n<p>The strange thing is I do the same in some code earlier &amp; it works.</p>\n\n<pre><code>Workbooks(\"PS 2019_June 19_updated (Macro).xlsm\").Worksheets(8).Range(\"A2\").CurrentRegion.Copy\nWorkbooks(\"PS &amp; Config - Actuals &amp; FC.xlsm\").Worksheets(3).Range(\"a2\").PasteSpecial Paste:=xlPasteValuesAndNumberFormats\nWorkbooks(\"PS &amp; Config - Actuals &amp; FC.xlsm\").Worksheets(3).Range(\"a1\").Select\nWorkbooks(\"PS &amp; Config - Actuals &amp; FC.xlsm\").Worksheets(3).Range(\"a2\").Select\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1574290988, "post_id": 58964712, "comment_id": 104184527, "body": "AutoOpen is a special case macro that is run because <a href=\"https://support.microsoft.com/en-us/help/286310/description-of-behaviors-of-autoexec-and-autoopen-macros-in-word\" rel=\"nofollow noreferrer\">it&#39;s a convention</a>. <code>Document_Open</code> is a handler for the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/word.document.open\" rel=\"nofollow noreferrer\"><code>Document.Open</code> event</a>."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 2, "creation_date": 1574317238, "post_id": 58964712, "comment_id": 104191160, "body": "AutoOPen is &quot;old&quot; - comes from WordBasic. It can be placed in any normal module. <code>Document_Open</code> Is an event and must be in the <code>ThisDocument</code> module. They trigger at different times (one before the other) which can be important in some circumstances. So mostly, except for the last point, it&#39;s a matter of preference."}], "owner": {"reputation": 982, "user_id": 4163743, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/6b53688d0bbc845af7c7e7907ba0013c?s=128&d=identicon&r=PG&f=1", "display_name": "PBeezy", "link": "https://stackoverflow.com/users/4163743/pbeezy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 249, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1574317053, "creation_date": 1574290708, "last_edit_date": 1574317053, "question_id": 58964712, "link": "https://stackoverflow.com/questions/58964712/what-is-the-difference-between-autoopen-and-document-open", "title": "What is the difference between AutoOpen() and Document_Open()?", "body": "<p>They both fire when the document opens. When should you use one over the other?</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 429, "user_id": 10762409, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-B8yWgIKwCVo/AAAAAAAAAAI/AAAAAAAADPo/rqsyRhLycf0/photo.jpg?sz=128", "display_name": "10762409 says Reinstate Monica", "link": "https://stackoverflow.com/users/10762409/10762409-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1574290264, "post_id": 58964526, "comment_id": 104184238, "body": "Have you tried anything?"}, {"owner": {"reputation": 17, "user_id": 10274352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b3492294dc1c335a823b8745b511675?s=128&d=identicon&r=PG&f=1", "display_name": "Imran", "link": "https://stackoverflow.com/users/10274352/imran"}, "reply_to_user": {"reputation": 429, "user_id": 10762409, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-B8yWgIKwCVo/AAAAAAAAAAI/AAAAAAAADPo/rqsyRhLycf0/photo.jpg?sz=128", "display_name": "10762409 says Reinstate Monica", "link": "https://stackoverflow.com/users/10762409/10762409-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1574290437, "post_id": 58964526, "comment_id": 104184297, "body": "I have tried many things but no success"}, {"owner": {"reputation": 429, "user_id": 10762409, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-B8yWgIKwCVo/AAAAAAAAAAI/AAAAAAAADPo/rqsyRhLycf0/photo.jpg?sz=128", "display_name": "10762409 says Reinstate Monica", "link": "https://stackoverflow.com/users/10762409/10762409-says-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1574300022, "post_id": 58964526, "comment_id": 104186781, "body": "When you ask a question on StackOverflow, you are expected to show your work and what you&#39;ve tried, including what exact error you&#39;ve gotten."}, {"owner": {"reputation": 1056, "user_id": 656585, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f0cd436cd48026cc2ed582f4133a0f64?s=128&d=identicon&r=PG", "display_name": "Christoph J&#252;ngling", "link": "https://stackoverflow.com/users/656585/christoph-j%c3%bcngling"}, "edited": false, "score": 0, "creation_date": 1574328885, "post_id": 58964526, "comment_id": 104196875, "body": "Which error excatly did you receive? In which line of code?"}], "answers": [{"tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": true, "score": 0, "last_activity_date": 1574330170, "creation_date": 1574330170, "answer_id": 58972016, "question_id": 58964526, "link": "https://stackoverflow.com/questions/58964526/errors-ms-access-vba-email-report/58972016#58972016", "title": "Errors ms access vba email report", "body": "<p>If you are filtering on a text field, use apostrophe delimiters for parameter:</p>\n\n<p><code>DoCmd.OpenReport \"Maturing Loans in 90\", acViewPreview, , \"RespName = '\" &amp; rs!RMName &amp; \"'\"</code></p>\n\n<p>Use # for date/time fields, nothing for number type.</p>\n\n<p>Could reduce amount of data pulled by including just necessary fields in SQL statement. Appears you need only RMName and Email. </p>\n"}], "owner": {"reputation": 17, "user_id": 10274352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b3492294dc1c335a823b8745b511675?s=128&d=identicon&r=PG&f=1", "display_name": "Imran", "link": "https://stackoverflow.com/users/10274352/imran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 58972016, "answer_count": 1, "score": -4, "last_activity_date": 1574330170, "creation_date": 1574289691, "last_edit_date": 1574323913, "question_id": 58964526, "link": "https://stackoverflow.com/questions/58964526/errors-ms-access-vba-email-report", "title": "Errors ms access vba email report", "body": "<p>I keep getting an error when I run this code.</p>\n\n<pre><code>Sub SendEmailMaturing()\n    Dim rs As DAO.Recordset\n    Dim db As Database\n    Dim strSQL As String\n\n    Set db = CurrentDb\n\n    strSQL = \"SELECT * FROM qRespCodeEmail\"\n    Set rs = CurrentDb.OpenRecordset(strSQL)\n\n    If Not rs.BOF And Not rs.EOF Then\n        rs.MoveFirst\n        Do While Not rs.EOF\n            'Debug.Print rs.Fields(\"RMName\")\n            DoCmd.OpenReport \"Maturing Loans in 90\", acViewPreview, , \"RespName = \" &amp; rs!RMName\n            DoCmd.SendObject acSendReport, \"Maturing Loans in 90\", acFormatPDF, rs!Email, , , \"Maturing Loans\", \"Kindly take a look and send me an update on the status of matured loans.\", True\n            DoCmd.Close acReport, \"Maturing Loans in 90\", acSaveNo\n\n            rs.MoveNext\n        Loop\n    End If\n\n    rs.Close\n    Set rs = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "runtime-error", "excel-2010"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1574289498, "post_id": 58964239, "comment_id": 104183973, "body": "You&#39;re trying to set an entire column as a single integer.  That&#39;s going to throw an error...(<code>firstRng = Sheet2.Range(&quot;A:A&quot;).Value</code>)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1574324104, "post_id": 58964239, "comment_id": 104194091, "body": "And a <code>Value</code> has no <code>.Copy</code> method: <code>Sheet2.Range(&quot;A1:C1&quot;).Value.Copy</code> check your syntax. You need to copy the range and then you can use <code>PasteSpecial</code> to only paste the values of that range."}, {"owner": {"reputation": 655, "user_id": 2670777, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d69cb2368cc72bf16229fdddf46e557a?s=128&d=identicon&r=PG", "display_name": "joehua", "link": "https://stackoverflow.com/users/2670777/joehua"}, "edited": false, "score": 0, "creation_date": 1574324280, "post_id": 58964239, "comment_id": 104194174, "body": "Not sure what your For ... Next loop tries to do. The variable i is not found in the loop. I think you want to copy cells in Sheet2 column A that also appear in Sheet1 column A. If so, declare another variable (Dim cell as Range). Then use &quot;For each cell in secondrng&quot;. This way, you are going through each cell in secondrng. By the way, set the two ranges to their proper size, not the entire column."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 12266479, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCho2-ul48_7cEl8_HIugNGSSQbfQ1SEWxk-_qOz28=k-s128", "display_name": "Richa Bajpai", "link": "https://stackoverflow.com/users/12266479/richa-bajpai"}, "edited": false, "score": 0, "creation_date": 1574391717, "post_id": 58970203, "comment_id": 104225777, "body": "Hi, there thanks for your help and but i have one more question in which value in sheet is not symmetric (i.e.2,1,4,3,5) not is ascending order but all the values are present similar to sheet1.range(&quot;A:A&quot;).Can you please help for this as well."}], "tags": [], "owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "is_accepted": true, "score": 0, "last_activity_date": 1574324231, "creation_date": 1574324231, "answer_id": 58970203, "question_id": 58964239, "link": "https://stackoverflow.com/questions/58964239/how-to-compare-two-values-in-different-worksheet-in-vba/58970203#58970203", "title": "How to compare two values in different worksheet in VBA?", "body": "<p>This code should work out. As already mentioned:\nYou cannot asign a range to an integer. Then secondly VBA is not that great with arrays, that is why I like to compare the values 1 by 1. What I didn't get was if you want to copy whenever a column is equal OR if you want to copy everything if everything is equal. The code below does the the first.</p>\n\n<pre><code>Sub check()\nDim ws As Workbook\nSet ws = ThisWorkbook\nDim firstrng As Range\nDim secondrng As Range\nSet firstrng = Sheets(1).Range(\"A:A\")\nSet secondrng = Sheets(2).Range(\"A:A\")\n\nDim i As Integer\nFor i = 1 To 5\n    If firstrng.Cells(i, 1).Value = secondrng.Cells(i, 1).Value Then\n        Sheets(1).Range(\"A\" &amp; i &amp; \":C\" &amp; i).Copy Destination:=Sheets(3).Range(\"A\" &amp; i &amp; \":C\" &amp; i)\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 428, "user_id": 10569362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb9c61d2dbd18a14e34005ab752e682e?s=128&d=identicon&r=PG&f=1", "display_name": "patel", "link": "https://stackoverflow.com/users/10569362/patel"}, "is_accepted": false, "score": 0, "last_activity_date": 1574325243, "creation_date": 1574325243, "answer_id": 58970457, "question_id": 58964239, "link": "https://stackoverflow.com/questions/58964239/how-to-compare-two-values-in-different-worksheet-in-vba/58970457#58970457", "title": "How to compare two values in different worksheet in VBA?", "body": "<p>Richa, your code is completely wrong, try this solution</p>\n\n<pre><code>Sub Columnscompare() 'ok\nDim Dn As Range\nLR1 = Sheets(1).Cells(Rows.Count, \"A\").End(xlUp).Row\nLR2 = Sheets(2).Cells(Rows.Count, \"A\").End(xlUp).Row\nLR = LR2\nIf LR1 &gt; LR2 Then LR = LR1\nFor Each Dn In Sheets(1).Range(\"A1:A\" &amp; LR)\n  If Not Dn = Sheets(2).Range(\"A1\")(Dn.Row, Dn.Column) Then MsgBox \"Not equals Ranges\": Exit Sub\nNext Dn\nMsgBox \"Both Ranges have the same data\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 12266479, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCho2-ul48_7cEl8_HIugNGSSQbfQ1SEWxk-_qOz28=k-s128", "display_name": "Richa Bajpai", "link": "https://stackoverflow.com/users/12266479/richa-bajpai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 58970203, "answer_count": 2, "score": 1, "last_activity_date": 1574325243, "creation_date": 1574288239, "last_edit_date": 1574324014, "question_id": 58964239, "link": "https://stackoverflow.com/questions/58964239/how-to-compare-two-values-in-different-worksheet-in-vba", "title": "How to compare two values in different worksheet in VBA?", "body": "<p>I am new to VBA. Here I want to compare two values in different worksheet belongs to same workbook. In Sheet1 only column A is filled with few number (i.e 1,2,3,4,5) and in Sheet2 three columns are filled with <code>enter code here</code>values. Whereas in Sheet2 column A has following values (i.e. 2,1,4,3,5). Here I am comparing values of Sheet1 column A with values of column A from Sheet2.\nI am getting continus error of </p>\n\n<blockquote>\n  <p>Runtime error \"13\"</p>\n</blockquote>\n\n<pre><code>Option Explicit\n\nSub chek()\nDim ws As Workbook\nSet ws = ThisWorkbook\nDim sheet As Worksheet\nDim firstRng As Integer\nfirstRng = Sheet2.Range(\"A:A\").Value\nDim secondrng As Integer\nsecondrng = Sheet1.Range(\"A:A\").Value\n\nDim i As Integer\nFor i = 1 To 5\n\n    For Each sheet In Worksheets\n        If IsArray(secondrng) = IsArray(firstRng) Then\n            Sheet2.Range(\"A1:C1\").Value.Copy\n            Sheet3.PasteSpecial\n\n        End If\n\n    Next sheet\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "edited": false, "score": 0, "creation_date": 1574287140, "post_id": 58963687, "comment_id": 104183118, "body": "You should use <code>ListBox1.Text</code> instead of <code>ListBox1.Name</code>. Another alternative would be <code>ListBox1.List(ListBox1.ListIndex)</code>."}, {"owner": {"reputation": 1, "user_id": 12406577, "user_type": "registered", "profile_image": "https://graph.facebook.com/2533228186944472/picture?type=large", "display_name": "Anastasia Lebedeva", "link": "https://stackoverflow.com/users/12406577/anastasia-lebedeva"}, "reply_to_user": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "edited": false, "score": 0, "creation_date": 1574287877, "post_id": 58963687, "comment_id": 104183421, "body": "So easy) Thank you so much"}], "owner": {"reputation": 1, "user_id": 12406577, "user_type": "registered", "profile_image": "https://graph.facebook.com/2533228186944472/picture?type=large", "display_name": "Anastasia Lebedeva", "link": "https://stackoverflow.com/users/12406577/anastasia-lebedeva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574324167, "creation_date": 1574285446, "last_edit_date": 1574324167, "question_id": 58963687, "link": "https://stackoverflow.com/questions/58963687/how-to-name-txt-file-created-with-vba-using-listbox-value", "title": "How to name txt file, created with VBA using Listbox Value?", "body": "<p>I have my first quite large project, and I can't do only this. \nThere are different values saved to txt, that depends on selected item in ListBox, therefore I want to name the file accordingly. \nWith this code file is named \"ListBox1.txt\"</p>\n\n<pre><code>Dim File As String\nDim i, n\nFile = ThisWorkbook.Path &amp; \"\\\" &amp; ListBox1.Name &amp; \".txt\"\nOpen File For Output As #1\nFor n = 2 To 7\nIf Line.ListBox1.ListIndex &lt;&gt; -1 Then\nFor i = 0 To Line.ListBox1.ListCount - 1\n    If Line.ListBox1.Selected(i) Then\n       Data = \" \" &amp; Cells(i + 2, n).Value\n    End If\nNext i\nEnd If\nPrint #1, Cells(1, n) &amp; \":\" &amp; Data\nNext n\nClose #1\nMsgBox (\"File is saved in the same folder with current file\")\nEnd Sub```\n\n\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 1, "last_activity_date": 1574284835, "creation_date": 1574284835, "answer_id": 58963563, "question_id": 58963466, "link": "https://stackoverflow.com/questions/58963466/adding-a-pdf-file-path-and-name-to-cells/58963563#58963563", "title": "Adding a PDF file path and name to cells", "body": "<p>You're missing an <code>s</code>, and your filter is off:</p>\n\n<pre><code>.Filters.Add \"PDF Files\", \"*.pdf\", 1\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 11159814, "user_type": "registered", "profile_image": "https://graph.facebook.com/2126279457439144/picture?type=large", "display_name": "Calum Burns", "link": "https://stackoverflow.com/users/11159814/calum-burns"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1577616046, "creation_date": 1574284403, "last_edit_date": 1577616046, "question_id": 58963466, "link": "https://stackoverflow.com/questions/58963466/adding-a-pdf-file-path-and-name-to-cells", "title": "Adding a PDF file path and name to cells", "body": "<p>I am trying to add the file path and name of some PDF files into my spreadsheet.</p>\n\n<p>It works for Word documents however when I tried to edit the code to find PDF files it does not like the term \".Filter\". </p>\n\n<p>Here is the original Word document code;</p>\n\n<pre><code>Sub AddWordTemplate()\nDim WordTempLoc As FileDialog\nDim FirstRow As Long\nSet WordTempLoc = Application.FileDialog(msoFileDialogFilePicker)\nFirstRow = Sheet9.Range(\"E99999\").End(xlUp).Row + 1 'First Available Row\nWith WordTempLoc\n    .Title = \"Select Word file to attach\"\n    .Filters.Add \"Word Type Files\", \"*.docx,*.doc\", 1\n    If .Show &lt;&gt; -1 Then GoTo NoSelection\n    Sheet9.Range(\"E\" &amp; FirstRow).Value = Dir(.SelectedItems(1)) 'Document Name\n    Sheet9.Range(\"F\" &amp; FirstRow).Value = .SelectedItems(1) 'Document Pathway\nEnd With\nNoSelection:\nEnd Sub\n</code></pre>\n\n<p>and here is the code for the PDF version;</p>\n\n<pre><code>Sub AddPDFCert()\nDim CalCertLoc As FileDialog\nDim FirstRow As Long\nSet CalCertLoc = Application.FileDialog(msoFileDialogFilePicker)\nFirstRow = Sheet10.Range(\"E99999\").End(xlUp).Row + 1 'First Available Row\nWith CalCertLoc\n    .Title = \"Select PDF file to attach\"\n    .Filter.Add \"PDF Files\", \"(*.pdf), *.pdf\", 1\n    If .Show &lt;&gt; -1 Then GoTo NoSelection\n    Sheet10.Range(\"E\" &amp; FirstRow).Value = Dir(.SelectedItems(1)) 'Document Name\n    Sheet10.Range(\"F\" &amp; FirstRow).Value = .SelectedItems(1) 'Document Pathway\nEnd With\nNoSelection:\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 12406544, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rh_agQ5C-BY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reSVZPBRE-dSy83uOjkI3eByX1V_A/photo.jpg?sz=128", "display_name": "Trust", "link": "https://stackoverflow.com/users/12406544/trust"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574284867, "post_id": 58963436, "comment_id": 104182197, "body": "Thanks, I added the code!"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1574285707, "post_id": 58963436, "comment_id": 104182525, "body": "Are you asking basically how to create a <a href=\"https://support.office.com/en-us/article/Define-and-use-names-in-formulas-4D0F13AC-53B7-422E-AFD2-ABD7FF379C64\" rel=\"nofollow noreferrer\">Named Range</a>?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1574290602, "post_id": 58963436, "comment_id": 104184361, "body": "Please explain the manual process which you want to automate - it&#39;s not clear what you want to do here."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1574290754, "post_id": 58963436, "comment_id": 104184414, "body": "<code>stCol = 2 + ((Weekday(fMOn) - 1) * 3)</code>"}, {"owner": {"reputation": 1, "user_id": 12406544, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rh_agQ5C-BY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reSVZPBRE-dSy83uOjkI3eByX1V_A/photo.jpg?sz=128", "display_name": "Trust", "link": "https://stackoverflow.com/users/12406544/trust"}, "edited": false, "score": 0, "creation_date": 1574344130, "post_id": 58963436, "comment_id": 104206007, "body": "To assign names to cells that react to the calendar date. it is used to see who is in office at a specific date. For example,for the second  week  David is in office MON. WED, and  FRI while Mary is in office TUE, THUR, Friday. Also, the ability to swap days if they wanted to change shifts."}, {"owner": {"reputation": 1, "user_id": 12406544, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rh_agQ5C-BY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reSVZPBRE-dSy83uOjkI3eByX1V_A/photo.jpg?sz=128", "display_name": "Trust", "link": "https://stackoverflow.com/users/12406544/trust"}, "edited": false, "score": 0, "creation_date": 1574344309, "post_id": 58963436, "comment_id": 104206129, "body": "Also, when i say to react to the calendar date I mean numerical date and the month to date in cell B1"}], "owner": {"reputation": 1, "user_id": 12406544, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rh_agQ5C-BY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reSVZPBRE-dSy83uOjkI3eByX1V_A/photo.jpg?sz=128", "display_name": "Trust", "link": "https://stackoverflow.com/users/12406544/trust"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1574284802, "creation_date": 1574284255, "last_edit_date": 1574284802, "question_id": 58963436, "link": "https://stackoverflow.com/questions/58963436/how-to-assign-a-name-to-a-cell-in-relation-to-calendar-date", "title": "How to assign a name to a cell in relation to calendar date?", "body": "<p>I created a Calendar in Excel using VBA and I wanted to know how to assign specific names to cells in relation to the calendar date. If possible could I substitute the names using a Userform name selection in relation to the calendar date.</p>\n\n<p><a href=\"https://i.stack.imgur.com/f9iux.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/f9iux.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>    Sub CreateCalendar()\nDim csheet As Worksheet\nSet csheet = ThisWorkbook.Sheets(\"Sheet1\")\n\nselDate = [b1]\nfMOn = DateSerial(Year(selDate), Month(selDate), 1)\nlMon = CDate(Application.WorksheetFunction.EoMonth(fMOn, 0))\n\nstRow = 4\n\n'clear last cal\nRange(\"B4:V4\").ClearContents\nRange(\"B10:V10\").ClearContents\nRange(\"B16:V16\").ClearContents\nRange(\"B22:V22\").ClearContents\nRange(\"B28:V28\").ClearContents\nRange(\"B34:V34\").ClearContents\n\n\n'determine what weekday 1st is. . .\nIf Weekday(fMOn) = 1 Then\n         stCol = 2\nElseIf Weekday(fMOn) = 2 Then\n         stCol = 5\nElseIf Weekday(fMOn) = 3 Then\n         stCol = 8\nElseIf Weekday(fMOn) = 4 Then\n         stCol = 11\nElseIf Weekday(fMOn) = 5 Then\n         stCol = 14\nElseIf Weekday(fMOn) = 6 Then\n         stCol = 17\nElseIf Weekday(fMOn) = 7 Then\n         stCol = 20\nEnd If\n\nFor x = 1 To Day(lMon)\n       If FirstT = Empty Then\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1574282485, "post_id": 58963014, "comment_id": 104181140, "body": "you while loop keeps testing the same cell and never moves to the next i so once it enters that loop it never leaves."}, {"owner": {"reputation": 1, "user_id": 11898222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a20ab2cab5fe2d58a199f4d591d5461e?s=128&d=identicon&r=PG&f=1", "display_name": "AOjha", "link": "https://stackoverflow.com/users/11898222/aojha"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1574282770, "post_id": 58963014, "comment_id": 104181272, "body": "Sorry, at what line is that happening could you tell me?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1574282890, "post_id": 58963014, "comment_id": 104181331, "body": "since this is based on <code>i</code>: <code>While t_req(i, 1) &gt; 0</code> it will always test the same cell once true.  As it never moves out of that loop to get to the <code>next i</code>"}, {"owner": {"reputation": 1, "user_id": 11898222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a20ab2cab5fe2d58a199f4d591d5461e?s=128&d=identicon&r=PG&f=1", "display_name": "AOjha", "link": "https://stackoverflow.com/users/11898222/aojha"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1574283014, "post_id": 58963014, "comment_id": 104181402, "body": "But I update t_req(i,1) inside the conditions that follow. Every time a decision is assigned, it&#39;s reduced by one."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1574283434, "post_id": 58963014, "comment_id": 104181574, "body": "That <code>While</code> looks supicious to me, why not just loop <code>j</code> and check the <code>While</code>&#39;s condition at the appropriate time, then exit the loop if needed. I&#39;m also not fond of the <code>goto</code>s. Why not loop normally and use <code>Exit for</code> once the exit conditions are met?"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1574283613, "post_id": 58963014, "comment_id": 104181648, "body": "To help with figuring out what&#39;s going on, you can put <code>DoEvents</code> inside the While loop to enable you to pause the macro. You can also put <code>Debug.Print</code> statements to help verify that conditions are being met when expected."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574283763, "post_id": 58963014, "comment_id": 104181725, "body": "Side notes: <code>While...Wend</code> is deprecated, the <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">indentation</a> is off, the <code>GoTo</code>s are suspicious, and maybe consider using more meaningful variable names."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 2, "creation_date": 1574283895, "post_id": 58963014, "comment_id": 104181779, "body": "I tend to agree with others&#39; comments but... You say Excel is &quot;crashing&quot;: Please describe that behavior in more detail. Is there an error? Is Excel closing? Or is the macro simply not ending? If the last, then there&#39;s an &quot;infinite loop&quot; and the <code>While</code> is the most likely culprit. <b><i>Test</i></b> <code>t_req(i, 1)</code> either using <code>Debug.Print</code> or stepping through the code to check the value or something similar. Since we don&#39;t have the workbook and the data, we can&#39;t test..."}, {"owner": {"reputation": 1, "user_id": 11898222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a20ab2cab5fe2d58a199f4d591d5461e?s=128&d=identicon&r=PG&f=1", "display_name": "AOjha", "link": "https://stackoverflow.com/users/11898222/aojha"}, "edited": false, "score": 0, "creation_date": 1574284638, "post_id": 58963014, "comment_id": 104182110, "body": "Thank you everyone. Let me try to change things around and see if it works"}, {"owner": {"reputation": 1, "user_id": 11898222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a20ab2cab5fe2d58a199f4d591d5461e?s=128&d=identicon&r=PG&f=1", "display_name": "AOjha", "link": "https://stackoverflow.com/users/11898222/aojha"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1574284675, "post_id": 58963014, "comment_id": 104182121, "body": "@CindyMeister Excel freezes and says not responding and then I have to go into Task Manager and force close Excel."}, {"owner": {"reputation": 1, "user_id": 11898222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a20ab2cab5fe2d58a199f4d591d5461e?s=128&d=identicon&r=PG&f=1", "display_name": "AOjha", "link": "https://stackoverflow.com/users/11898222/aojha"}, "edited": false, "score": 0, "creation_date": 1574347045, "post_id": 58963014, "comment_id": 104207928, "body": "Hi guys. Thank you for your help. Managed to restructure the While loop better and the macro runs now."}], "owner": {"reputation": 1, "user_id": 11898222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a20ab2cab5fe2d58a199f4d591d5461e?s=128&d=identicon&r=PG&f=1", "display_name": "AOjha", "link": "https://stackoverflow.com/users/11898222/aojha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574282597, "creation_date": 1574282364, "last_edit_date": 1574282597, "question_id": 58963014, "link": "https://stackoverflow.com/questions/58963014/excel-keeps-freezing-on-running-macro", "title": "Excel keeps freezing on running Macro", "body": "<p>So I am using the following code to make a bunch of decisions based on values in table columns. I have taken each table column containing values that go into making the decision in variant arrays. And then used a combination of for and while loops to assign decisions in the ans() variant array. </p>\n\n<p>The problem is, every time I run the macro my Excel hangs.\nI tried the usual method of adding automatic calculations and disabling events and screen updates. But it did not help the matter in any way. I tried simplifying my code as well but this is about as much simplification I can include while still achieving what I would like the code to. Can someone please tell me what else I can do to make this run?</p>\n\n<pre><code>Dim sh As Worksheet\nSet sh = Sheets(\"LOGIC\")\nDim t As ListObject\nSet t = sh.ListObjects(\"Table8\")\nn = t.ListRows.Count\n\nDim rel() As Variant\nrel = t.ListColumns(61).DataBodyRange.Value\n\nDim dc() As Variant\ndc = t.ListColumns(62).DataBodyRange.Value\n\nDim t_req() As Variant\nt_req = t.ListColumns(63).DataBodyRange.Value\n\nDim sc_req() As Variant\nsc_req = t.ListColumns(64).DataBodyRange.Value\n\nDim x_req() As Variant\nx_req = t.ListColumns(65).DataBodyRange.Value\n\nDim bo() As Variant\nbo = t.ListColumns(69).DataBodyRange.Value\n\nDim ans() As Variant\nans = t.ListColumns(70).DataBodyRange.Value\n\nDim reqkind() As Variant\nreqkind = t.ListColumns(2).DataBodyRange.Value\n\n For i = 2 To n Step 1\n  If rel(i, 1) = 0 Or ans(i, 1) &lt;&gt; 0 Then\n   GoTo Nexti\n  ElseIf ans(i, 1) = 0 And rel(i, 1) = 1 Then\n   While t_req(i, 1) &gt; 0\n    For j = i To n - 1\n     If dc(i, 1) &gt; 0 Then\n      If reqkind(i, 1) = \"\" Then\n       ans(i, 1) = \"YES\"\n       t_req(i, 1) = t_req(i, 1) - 1\n       sc_req(i, 1) = sc_req(i, 1) - 1\n      ElseIf sc_req(i, 1) &lt;= 0 Then\n       ans(i, 1) = \"YES\"\n       t_req(i, 1) = t_req(i, 1) - 1\n       x_req(i, 1) = x_req(i, 1) - 1\n      Else: GoTo Nextj\n      End If\n     ElseIf reqkind(i, 1) = \"\" Then\n      If bo(i, 1) &gt; 0 Then\n       ans(i, 1) = \"YES\"\n       t_req(i, 1) = t_req(i, 1) - 1\n       bo(i, 1) = bo(i, 1) - 1\n      Else\n       ans(i, 1) = \"NO\"\n       t_req(i, 1) = t_req(i, 1) - 1\n      End If\n     Else\n      ans(i, 1) = \"NO\"\n      t_req(i, 1) = t_req(i, 1) - 1\n     End If\nNextj:\n    Next j\n    Wend\n  End If\nNexti:\n  Next i```\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba", "rows", "listobject"], "comments": [{"owner": {"reputation": 35, "user_id": 9529207, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bpf5FYlY-6k/AAAAAAAAAAI/AAAAAAAAAL8/Vf8fSzYZB6w/photo.jpg?sz=128", "display_name": "Kristopher Penland", "link": "https://stackoverflow.com/users/9529207/kristopher-penland"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1574282405, "post_id": 58962952, "comment_id": 104181112, "body": "Refering to filtering the table, pasting the values elsewhere, then copying that range into the array and deleting it?"}, {"owner": {"reputation": 35, "user_id": 9529207, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bpf5FYlY-6k/AAAAAAAAAAI/AAAAAAAAAL8/Vf8fSzYZB6w/photo.jpg?sz=128", "display_name": "Kristopher Penland", "link": "https://stackoverflow.com/users/9529207/kristopher-penland"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1574282510, "post_id": 58962952, "comment_id": 104181148, "body": "Is there no way to just reference the listobject data from specific (multiple) rows directly without those workarounds?"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 9529207, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bpf5FYlY-6k/AAAAAAAAAAI/AAAAAAAAAL8/Vf8fSzYZB6w/photo.jpg?sz=128", "display_name": "Kristopher Penland", "link": "https://stackoverflow.com/users/9529207/kristopher-penland"}, "edited": false, "score": 0, "creation_date": 1574282687, "post_id": 58963024, "comment_id": 104181231, "body": "Thank you, @BigBen, that did work to select the two rows!  Is it possible to use variables to represent the row numbers in it?"}, {"owner": {"reputation": 35, "user_id": 9529207, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bpf5FYlY-6k/AAAAAAAAAAI/AAAAAAAAAL8/Vf8fSzYZB6w/photo.jpg?sz=128", "display_name": "Kristopher Penland", "link": "https://stackoverflow.com/users/9529207/kristopher-penland"}, "edited": false, "score": 0, "creation_date": 1574283525, "post_id": 58963024, "comment_id": 104181613, "body": "Thank you so much, @BigBen!!!!!  I greatly appreciate the help and understanding!"}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 2, "last_activity_date": 1574282830, "last_edit_date": 1574282830, "creation_date": 1574282416, "answer_id": 58963024, "question_id": 58962952, "link": "https://stackoverflow.com/questions/58962952/capture-specific-rows-of-a-listobject-to-an-array/58963024#58963024", "title": "Capture specific rows of a ListObject to an array", "body": "<p>You can't index into the <code>ListRows</code> collection like that. Use <code>DataBodyRange.Rows</code>.</p>\n\n<pre><code>varESInvoiceBreakdown = PrimeLO.DataBodyRange.Rows(\"1:2\").Value\n</code></pre>\n\n<p>With variables:</p>\n\n<pre><code>Dim startRow as Long\nDim endRow as Long\n\nstartRow = 1\nendRow = 2\n\nvarESInvoiceBreakdown = PrimeLO.DataBodyRange.Rows(startRow &amp; \":\" &amp; endRow).Value\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 9529207, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bpf5FYlY-6k/AAAAAAAAAAI/AAAAAAAAAL8/Vf8fSzYZB6w/photo.jpg?sz=128", "display_name": "Kristopher Penland", "link": "https://stackoverflow.com/users/9529207/kristopher-penland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 355, "favorite_count": 0, "accepted_answer_id": 58963024, "answer_count": 1, "score": 0, "last_activity_date": 1574282830, "creation_date": 1574282101, "question_id": 58962952, "link": "https://stackoverflow.com/questions/58962952/capture-specific-rows-of-a-listobject-to-an-array", "title": "Capture specific rows of a ListObject to an array", "body": "<p>I need help trying to figure out something I haven't done before in Excel VBA.  I'm trying to assign specific (consecutive) rows of a listobject to an array.  Is this possible?  </p>\n\n<p>Previously I was using code to copy over the entire table into the array, which worked, but it would capture unused blank rows I didn't want included.  I was able to get some FUNCTIONS up and running which capture the first and low filled row numbers of the listobject for reference, but I cannot figure out how to assign ONLY this range of rows from the listobject into the array</p>\n\n<p>This, for instance, works to assign only the 1st row:\n<strong>varESInvoiceBreakdown = PrimeLO.ListRows(1).Range.Value</strong></p>\n\n<p>However, this doesn't work to capture the first two rows.  I get an error\n<strong>varESInvoiceBreakdown = PrimeLO.ListRows(\"1:2\").Range.Value</strong></p>\n\n<p>Even though it indicates in a segment of this article that you can reference multiple rows in this manner\n<a href=\"https://www.thespreadsheetguru.com/blog/2014/6/20/the-vba-guide-to-listobject-excel-tables\" rel=\"nofollow noreferrer\">https://www.thespreadsheetguru.com/blog/2014/6/20/the-vba-guide-to-listobject-excel-tables</a></p>\n\n<p>I was hoping to reference the two integer variables I have setup for the row selection.</p>\n\n<p>Sincerely,\nKris</p>\n"}, {"tags": ["excel", "vba", "excel-formula", "conditional-formatting"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1574281678, "post_id": 58962543, "comment_id": 104180794, "body": "Side note, &quot;People&#39;s Party&quot; has 0 elected officials. Might want to reconsider what &quot;popular&quot; stands for ;-)"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1574281358, "post_id": 58962658, "comment_id": 104180655, "body": "I don&#39;t like that a count is being used as a Boolean value (I&#39;d much rather have an explicit <code>COUNTIF(...)=0</code> and then there&#39;s no need for a <code>NOT</code> and everything is as explicit a no-hack as it gets, but maybe that&#39;s just me)"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1574281458, "post_id": 58962658, "comment_id": 104180704, "body": "@MathieuGuindon - I agree, and to be honest, I only recently realized <code>COUNTIF()</code> can be used as Boolean, so perhaps am a little overzealous in using it :P  ...I agree with you and will update."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1574281836, "post_id": 58962658, "comment_id": 104180865, "body": "It&#39;s essentially the same hack that makes <code>InStr(...)</code> usable in an <code>If</code> statement, and <a href=\"https://stackoverflow.com/a/57515088/1188513\">it will eventually bite you in the rear end</a> if you keep abusing it =) (that said I don&#39;t think Excel&#39;s <code>AND</code> function uses bitwise logic, so there&#39;s that)"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1574282423, "post_id": 58962658, "comment_id": 104181120, "body": "@MathieuGuindon - Thanks for that! I had been wondering if it was a good/bad/ugly practice, and that clarifies it a lot for me.  Cheers :D"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1574349019, "post_id": 58962658, "comment_id": 104209192, "body": "You could include an empty cell to your named range <code>popular_parties</code> thus simplifying the condition to <code>=AND(F2&lt;&gt;popular_parties)</code> :-)"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1574349110, "post_id": 58962658, "comment_id": 104209248, "body": "BTW note that conditional formatting is using local language (formulae) settings :-)"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1574349411, "post_id": 58962658, "comment_id": 104209417, "body": "@T.M. - Oh good point!  In that example (<code>=AND(F2&lt;&gt;popular_parties)</code>), is the <code>AND()</code> necessary?"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1574350602, "post_id": 58962658, "comment_id": 104210128, "body": "@BruceWayne, I fear it is, possibly because of array like evaluation - feel free to edit this as further possibility :-)"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 2, "last_activity_date": 1574357225, "last_edit_date": 1574357225, "creation_date": 1574280995, "answer_id": 58962658, "question_id": 58962543, "link": "https://stackoverflow.com/questions/58962543/is-there-a-way-to-do-conditional-formatting-for-everything-other-than-in-excel/58962658#58962658", "title": "Is there a way to do Conditional Formatting for &quot;Everything other than&quot; in Excel", "body": "<p>Put the \"popular\" parties somewhere in your worksheet/workbook.  Then, highlight them and create a Named Range.</p>\n\n<p>Then, you can use a formula to check if the cell is in that named range.</p>\n\n<p>Create a Conditional Format, with the Formula:</p>\n\n<pre><code>=AND(F2&lt;&gt;\"\",COUNTIF(popular_parties,$F2)=0)\n</code></pre>\n\n<p>Applies To Range: <code>$F$2:$F$100</code> (adjust as needed).  Then format as you wish.</p>\n\n<p><a href=\"https://i.stack.imgur.com/lKZ3G.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lKZ3G.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Also, to note, you can use this to more easily mark those Popular Ones.  The Conditional Format formula on that would be <code>=AND(F2&lt;&gt;\"\",COUNTIF(popular_parties,$F2)&gt;0)</code>. (Assuming you don't want the formatting to apply to empty cells.)</p>\n\n<p>Edit: As @T.M. points out, if you include an empty cell in your named range, you can just do <code>=AND(F2&lt;&gt;popular_parties)</code> to get the non-popular parties CF.</p>\n"}, {"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 2, "last_activity_date": 1574281385, "creation_date": 1574281385, "answer_id": 58962769, "question_id": 58962543, "link": "https://stackoverflow.com/questions/58962543/is-there-a-way-to-do-conditional-formatting-for-everything-other-than-in-excel/58962769#58962769", "title": "Is there a way to do Conditional Formatting for &quot;Everything other than&quot; in Excel", "body": "<p>If you wanted to hard-code these parties in your conditional formula, you could do something like:</p>\n\n<pre><code>=AND($F1&lt;&gt;\"Political Affiliation\", $F1&lt;&gt;\"Liberal\", $F1&lt;&gt;\"Conservative\", $F1&lt;&gt;\"Green Party\", $F1&lt;&gt;\"NDP\", $F1&lt;&gt;\"Bloc Qu\u00e9b\u00e9cois\", $F1&lt;&gt;\"People's Party\")\n</code></pre>\n\n<ol>\n<li>Select the entire F Column</li>\n<li>Create a new conditional Formatting rule</li>\n<li>Select <strong>Use a formula to determine which cells to format</strong></li>\n<li>Paste the above formula in the box</li>\n</ol>\n"}], "owner": {"reputation": 33, "user_id": 9103994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0255d69543be89f1e45fedb215d073ae?s=128&d=identicon&r=PG&f=1", "display_name": "zlauzon48", "link": "https://stackoverflow.com/users/9103994/zlauzon48"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1574357225, "creation_date": 1574280531, "question_id": 58962543, "link": "https://stackoverflow.com/questions/58962543/is-there-a-way-to-do-conditional-formatting-for-everything-other-than-in-excel", "title": "Is there a way to do Conditional Formatting for &quot;Everything other than&quot; in Excel", "body": "<p>I'm having trouble formatting an entire column based on what Political Affiliation a certain politician has. The more popular parties have already been formatted with the \"Cell contains\" formatting option, but I am trying to format everything else in the specific column that hasn't been picked up by the certain rules. These are other parties that are not popular, such as \"Independent\", \"Rhinoceros Party\", and other none popular parties. I've tried using the \"Use Formula\" rule to format it but have no luck in doing so. My idea is to format everything that is not the following.</p>\n\n<ul>\n<li>Political Affiliation, Liberal, Conservative, Green Party, NDP, Bloc Quebecois, People's Party, and \" \" (For empty cells)</li>\n</ul>\n\n<p><code>=NOT(OR(\"Political Affiliation\", \"Liberal\", \"Conservative\", \"Green Party\", \"NDP\", \"Bloc Qu\u00e9b\u00e9cois\", \"People's Party\", \" \"))</code></p>\n\n<p>The column in F:F if that information is required as well. If this needs to be done in VBA and it's the only way, I don't mind. Thank you</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1574280080, "post_id": 58962398, "comment_id": 104180061, "body": "Will the values always be unique, can the max number happen more than once in the data range?"}, {"owner": {"reputation": 3, "user_id": 9901373, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RIKGvnkpvn0/AAAAAAAAAAI/AAAAAAAAH8M/dinxoObIH70/photo.jpg?sz=128", "display_name": "khalid", "link": "https://stackoverflow.com/users/9901373/khalid"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1574280322, "post_id": 58962398, "comment_id": 104180179, "body": "Not sure if it is possible to attach the actual excel file here."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9901373, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RIKGvnkpvn0/AAAAAAAAAAI/AAAAAAAAH8M/dinxoObIH70/photo.jpg?sz=128", "display_name": "khalid", "link": "https://stackoverflow.com/users/9901373/khalid"}, "edited": false, "score": 0, "creation_date": 1574281298, "post_id": 58962491, "comment_id": 104180630, "body": "This answers my question. These are magical formulas and work perfectly. Now trying to make sense of it. Thanks. :)"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1574280288, "creation_date": 1574280288, "answer_id": 58962491, "question_id": 58962398, "link": "https://stackoverflow.com/questions/58962398/find-header-values-for-a-maximum-in-a-range/58962491#58962491", "title": "Find header values for a maximum in a range", "body": "<p>To find the Column Header(no helper cells needed):</p>\n\n<pre><code>=INDEX($1:$1,AGGREGATE(15,7,COLUMN(C1022:D1352)/(C1022:D1352=MAX(C1022:D1352)),1))\n</code></pre>\n\n<p>To find the row time:</p>\n\n<pre><code>=INDEX($A:$A,AGGREGATE(15,7,ROW(C1022:D1352)/(C1022:D1352=MAX(C1022:D1352)),1))\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9901373, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RIKGvnkpvn0/AAAAAAAAAAI/AAAAAAAAH8M/dinxoObIH70/photo.jpg?sz=128", "display_name": "khalid", "link": "https://stackoverflow.com/users/9901373/khalid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 58962491, "answer_count": 1, "score": 0, "last_activity_date": 1574324187, "creation_date": 1574279856, "last_edit_date": 1574324187, "question_id": 58962398, "link": "https://stackoverflow.com/questions/58962398/find-header-values-for-a-maximum-in-a-range", "title": "Find header values for a maximum in a range", "body": "<p><a href=\"https://i.stack.imgur.com/OPDJG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OPDJG.png\" alt=\"Example Data Set\"></a></p>\n\n<p>I am trying to write a formula or a VBA to find </p>\n\n<ol>\n<li>The column header (located in row1)</li>\n<li>The corresponding time  (located in colum1)</li>\n</ol>\n\n<p>for the Max value in the Range <code>C1022:D1352</code> from the attached excel sheet.</p>\n\n<p>I have managed to extract column header value by first manually finding the maximum value in each column in the range from \"C\" to \"D\" in row 1444 and then using the formula </p>\n\n<pre><code>=INDEX($C$1:$E$1,0,MATCH(MAX($C$1444:$E$1444),$C$1444:$E$1444,0))\n</code></pre>\n\n<p>Now I am trying to find corresponding time at which the maximum value occurred from column1 using the formula </p>\n\n<pre><code>=INDEX($A1022:$A1352,MATCH(MAX(C1022:C1352),C1022:C1352,0),0) \n</code></pre>\n\n<p>but I have to manually update the formula for 20 sheets every day with Column Name (eg. \"C\") every time as the maximum could be found in either column \"C\" or \"D\".</p>\n\n<p>Is there an easy way to find the maximum in a table range then get the value of the header and the value from the first column in the same row as the maximum value. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1574396933, "post_id": 58962093, "comment_id": 104226886, "body": "Another suggestion: don&#39;t rely on VBA&#39;s defaults. Instead of <code>If c =</code> or <code>Select Case c</code>, use <code>If c.Value =</code> or <code>Select Case c.Value</code>."}], "tags": [], "owner": {"reputation": 21, "user_id": 6100466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98057cf7ed52d73a4b08175ffa19e9fa?s=128&d=identicon&r=PG&f=1", "display_name": "AssemblyRequired", "link": "https://stackoverflow.com/users/6100466/assemblyrequired"}, "is_accepted": false, "score": 0, "last_activity_date": 1574278674, "creation_date": 1574278674, "answer_id": 58962093, "question_id": 58961890, "link": "https://stackoverflow.com/questions/58961890/update-bar-colors-on-chart-based-on-axis-labels-that-change-each-month/58962093#58962093", "title": "Update bar colors on chart based on axis labels that change each month", "body": "<p>Your code is moving to the next cell because once the series is found and color changed, the if statement ends and the loop forces it to Next c.</p>\n\n<p>Two options: </p>\n\n<ol>\n<li>Make an if statement for each series within the 'c' loop so that once the series is found and altered, it checks the next if statement. </li>\n<li>Instead of the 'c' For loop, use 'select case'. Easier than using a bunch of if statements.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 11986137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fcc3408cb4410b9240a5dad502965e6?s=128&d=identicon&r=PG&f=1", "display_name": "TommyO", "link": "https://stackoverflow.com/users/11986137/tommyo"}, "is_accepted": true, "score": 0, "last_activity_date": 1574278726, "creation_date": 1574278726, "answer_id": 58962103, "question_id": 58961890, "link": "https://stackoverflow.com/questions/58961890/update-bar-colors-on-chart-based-on-axis-labels-that-change-each-month/58962103#58962103", "title": "Update bar colors on chart based on axis labels that change each month", "body": "<p>My mistake was trying to use nested for loops which was unnecessary. There is probably a more efficient way to do this but the solution below removing the outer for loop worked for me.</p>\n\n<pre><code>Sub update_factor_barcharts()\n    '\n    ' The order of factor returns can change each month\n    'This macro automatically updates the charts to adjust for the changing order\n    Dim cht As Chart\n    Dim i As Long\n    Dim c As Range\n    Dim rng As Range\n\n    Set cht = ActiveSheet.ChartObjects(\"Chart 7\").Chart\n    Set rng = ActiveSheet.Range(\"Q26:Q31\")\n\n    i = 1\n    For Each c In rng.Cells\n        If c = \"Size\" Then\n            cht.SeriesCollection(1).Points(i).Interior.Color = RGB(Range(\"AS19\").Value, Range(\"AT19\").Value, Range(\"AU19\").Value)\n            i = i + 1\n        ElseIf c = \"Value\" Then\n            cht.SeriesCollection(1).Points(i).Interior.Color = RGB(Range(\"AS20\").Value, Range(\"AT20\").Value, Range(\"AU20\").Value)\n             i = i + 1\n        ElseIf c = \"Mom.\" Then\n            cht.SeriesCollection(1).Points(i).Interior.Color = RGB(Range(\"AS21\").Value, Range(\"AT21\").Value, Range(\"AU21\").Value)\n             i = i + 1\n        ElseIf c = \"Low Vol.\" Then\n            cht.SeriesCollection(1).Points(i).Interior.Color = RGB(Range(\"AS22\").Value, Range(\"AT22\").Value, Range(\"AU22\").Value)\n             i = i + 1\n        ElseIf c = \"Quality\" Then\n            cht.SeriesCollection(1).Points(i).Interior.Color = RGB(Range(\"AS23\").Value, Range(\"AT23\").Value, Range(\"AU23\").Value)\n             i = i + 1\n        ElseIf c = \"Div. Yield\" Then\n            cht.SeriesCollection(1).Points(i).Interior.Color = RGB(Range(\"AS24\").Value, Range(\"AT24\").Value, Range(\"AU24\").Value)\n             i = i + 1\n        End If\n    Next c\n\nEnd Sub\n\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 11986137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fcc3408cb4410b9240a5dad502965e6?s=128&d=identicon&r=PG&f=1", "display_name": "TommyO", "link": "https://stackoverflow.com/users/11986137/tommyo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 58962103, "answer_count": 2, "score": 1, "last_activity_date": 1574406962, "creation_date": 1574277831, "last_edit_date": 1574406962, "question_id": 58961890, "link": "https://stackoverflow.com/questions/58961890/update-bar-colors-on-chart-based-on-axis-labels-that-change-each-month", "title": "Update bar colors on chart based on axis labels that change each month", "body": "<p>My chart measures factor returns placing the highest returning factor at the top of the chart. As the order may change on a monthly basis, I want to dynamically adjust the color based on the factor order.</p>\n\n<p>I want to loop through each bar, match the factor name to the RGB code in my if statement block then move to the next bar.</p>\n\n<p>What happens: The code starts on the first bar, correctly matches the bar to factor names color and moves on to the next cell instead of moving to next series.</p>\n\n<pre><code>Sub update_factor_barcharts()\n\n    Dim cht As Chart\n    Dim i As Long\n    Dim c As Range\n    Dim rng As Range\n\n    Set cht = ActiveSheet.ChartObjects(\"Chart 7\").Chart\n    Set rng = ActiveSheet.Range(\"Q26:Q31\")\n\n    For i = 1 To cht.SeriesCollection.Count\n        For Each c In rng.Cells\n            If c = \"Size\" Then\n                cht.SeriesCollection(1).Points(i).Interior.Color = RGB(Range(\"AS19\").Value, Range(\"AT19\").Value, Range(\"AU19\").Value)\n            ElseIf c = \"Value\" Then\n                cht.SeriesCollection(1).Points(i).Interior.Color = RGB(Range(\"AS20\").Value, Range(\"AT20\").Value, Range(\"AU20\").Value)\n            ElseIf c = \"Mom.\" Then\n                cht.SeriesCollection(1).Points(i).Interior.Color = RGB(Range(\"AS21\").Value, Range(\"AT21\").Value, Range(\"AU21\").Value)\n            ElseIf c = \"Low Vol.\" Then\n                cht.SeriesCollection(1).Points(i).Interior.Color = RGB(Range(\"AS22\").Value, Range(\"AT22\").Value, Range(\"AU22\").Value)\n            ElseIf c = \"Quality\" Then\n                cht.SeriesCollection(1).Points(i).Interior.Color = RGB(Range(\"AS23\").Value, Range(\"AT23\").Value, Range(\"AU23\").Value)\n            ElseIf c = \"Div. Yield\" Then\n                cht.SeriesCollection(1).Points(i).Interior.Color = RGB(Range(\"AS24\").Value, Range(\"AT24\").Value, Range(\"AU24\").Value)\n            End If\n        Next c\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/3il4X.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3il4X.png\" alt=\"Chart and factor names\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/vq0Jb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vq0Jb.png\" alt=\"RGB Codes\"></a></p>\n"}, {"tags": ["vba", "filesystemobject", "hp-quality-center"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1574282991, "post_id": 58961829, "comment_id": 104181390, "body": "What type is <code>attachment</code>, and why is <a href=\"https://stackoverflow.com/questions/tagged/excel\">excel</a> relevant?"}, {"owner": {"reputation": 37, "user_id": 8382644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06600844895d17930ab396e99175081f?s=128&d=identicon&r=PG&f=1", "display_name": "Raja", "link": "https://stackoverflow.com/users/8382644/raja"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1574283941, "post_id": 58961829, "comment_id": 104181796, "body": "attachment is a .docx file. Removed the excel tag"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1574284110, "post_id": 58961829, "comment_id": 104181871, "body": "That was not the question. <code>attachment</code> is some object variable, and your code isn&#39;t showing any declaration for any of the variables involved, so we&#39;re left guessing what&#39;s what. Presumably we&#39;re not looking at an <code>Outlook.MailItem</code>? What type/class is the <code>Post</code> method defined in? Is it a custom VBA class? Have you verified your permissions? &quot;you to not have have the required permissions&quot; looks pretty clearly like a permission error, not a code error."}, {"owner": {"reputation": 37, "user_id": 8382644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06600844895d17930ab396e99175081f?s=128&d=identicon&r=PG&f=1", "display_name": "Raja", "link": "https://stackoverflow.com/users/8382644/raja"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1574285786, "post_id": 58961829, "comment_id": 104182563, "body": "yes, I am getting the runtime error for Permissions only. but I am not sure what sort of permission is required."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1574285914, "post_id": 58961829, "comment_id": 104182606, "body": "Usually that implies read/write permissions for your Windows login user, to whatever <code>&quot;FilePath&quot;</code> stands for."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1574286488, "post_id": 58961829, "comment_id": 104182840, "body": "Then again that&#39;s just a stab in the dark, because I&#39;ve no idea what class type an <code>attachment</code> is and what its <code>Post</code> method does. Is it provided by the QC object model? Does QC have a user permission system?"}, {"owner": {"reputation": 37, "user_id": 8382644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06600844895d17930ab396e99175081f?s=128&d=identicon&r=PG&f=1", "display_name": "Raja", "link": "https://stackoverflow.com/users/8382644/raja"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1574286585, "post_id": 58961829, "comment_id": 104182877, "body": "@MathieuGuindon : Thanks for your inputs. Filepath is a folder in my local machine. It is just the POST method for File Attach that is having this issue. I am able to execute test cases through the tool, but unable to attach my test results"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1574286863, "post_id": 58961829, "comment_id": 104183009, "body": "Ok, see, the file being local <i>is</i> relevant information that belongs in the post. Now since the file being local rules out file/path permissions, we&#39;re left with <code>attachment.Post</code> being the problem. So, one last time, <a href=\"https://stackoverflow.com/posts/58961829/edit\">edit</a> your post to indicate what class type <code>attachment</code> is and more context around what its <code>Post</code> method is supposed to be doing. Most people viewing your question are not familiar with <a href=\"https://stackoverflow.com/questions/tagged/qc\">qc</a>, and associate attachments with Outlook emails. Verify that your user is allowed to add attachments... does it work if you do it manually, without scripting?"}, {"owner": {"reputation": 37, "user_id": 8382644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06600844895d17930ab396e99175081f?s=128&d=identicon&r=PG&f=1", "display_name": "Raja", "link": "https://stackoverflow.com/users/8382644/raja"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1574287838, "post_id": 58961829, "comment_id": 104183407, "body": "I just uploaded my entire code. Yes, I am able to upload attachments manually in QC version 12.5"}], "answers": [{"tags": [], "owner": {"reputation": 37, "user_id": 8382644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06600844895d17930ab396e99175081f?s=128&d=identicon&r=PG&f=1", "display_name": "Raja", "link": "https://stackoverflow.com/users/8382644/raja"}, "is_accepted": false, "score": 0, "last_activity_date": 1578432012, "last_edit_date": 1578432012, "creation_date": 1574436436, "answer_id": 58997266, "question_id": 58961829, "link": "https://stackoverflow.com/questions/58961829/how-to-attach-files-to-qc-using-vba/58997266#58997266", "title": "How to attach files to QC using VBA?", "body": "<p>Here is the fix I made to upload attachments to Quality Center.</p>\n\n<pre><code>Set attachFactory = theRun.Attachments\nSet attachment = attachFactory.AddItem(Null)\nattachment.Filename = \"Filename\"\nattachment.Type = 1     \nattachment.Save       ' &lt;------changed the method to save instead of post for upload in QC\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 8382644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06600844895d17930ab396e99175081f?s=128&d=identicon&r=PG&f=1", "display_name": "Raja", "link": "https://stackoverflow.com/users/8382644/raja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 224, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1578453901, "creation_date": 1574277500, "last_edit_date": 1578453901, "question_id": 58961829, "link": "https://stackoverflow.com/questions/58961829/how-to-attach-files-to-qc-using-vba", "title": "How to attach files to QC using VBA?", "body": "<p>I get a Runtime error:</p>\n\n<blockquote>\n  <p>\"-2147219913 (80040637) Automation error<br>\n  \"you do not have the required permissions to execute this action\"</p>\n</blockquote>\n\n<p>while trying to upload a file to Test case in QC using VBA.</p>\n\n<pre><code>Set QCConnection = CreateObject(\"TDApiOle80.TDConnection\")\nQCConnection.InitConnectionEx QCurl\nQCConnection.Login qcID, qcPWD\nQCConnection.Connect qcDomain, qcProject\n\nDim runName, sCount, TestSetParent, TestSetCount, ActualMessage, attachFactory\n\nnPath = \"Test Lab Path\"\nSet TSetFact = QCConnection.TestSetFactory\nSet tsTreeMgr = QCConnection.TestSetTreeManager\nSet tsFolder = tsTreeMgr.NodeByPath(nPath)\nSet tslist = tsFolder.FindTestSets(\"Test Set Name\")\n\ni = 1\nj = 1\nSet theTestSet = tslist.Item(i)\nFor Each testsetfound In tslist\n    Set tsFolder = testsetfound.TestSetFolder\n    Set TSTestFactory = testsetfound.TSTestFactory\n    Set tsTestList = TSTestFactory.NewList(\"\")\n    k = 1\n    For Each tstItem In tsTestList\n        If Not IsEmpty(tstItem) Then\n            runName = tstItem.RunFactory.UniqueRunName\n            Set RunF = tstItem.RunFactory\n            Set theRun = RunF.AddItem(runName)\n            theRun.Name = runName\n            theRun.Status = \"Passed\"\n            theRun.CopyDesignSteps\n            theRun.Post\n        End If\n        Set runStepF = theRun.StepFactory\n        Set aTestStepArray = runStepF.NewList(\"\")\n        step_cnt = aTestStepArray.Count\n        For j = 1 To step_cnt ' Loop through steps and update in qc\n            Set runStep = aTestStepArray.Item(j)\n            step_QC = runStep.Name\n            runStep.Field(\"ST_ACTUAL\") = runStep.Field(\"ST_EXPECTED\")\n            runStep.Status = \"Passed\"\n            runStep.Post\n            k = k + 1\n        Next\n\n        Set fso = CreateObject(\"Scripting.FileSystemObject\")\n        Set Inputfolder = fso.GetFolder(\"FilePath\")\n        Set Infiles = Inputfolder.Files\n        For Each InFile In Infiles\n            Set attachFactory = theRun.Attachments\n            Set attachment = attachFactory.AddItem(Null)\n            attachment.Filename = \"Filename\"\n            attachment.Type = 1     \n            attachment.Post\n            theRun.Refresh\n            theRun.Post\n            Set attachFactory = Nothing\n        Next\n    Next\nNext\n</code></pre>\n\n<p>Error happens in the line</p>\n\n<pre><code>         attachment.Post\n</code></pre>\n\n<p>What might be the required permission?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1574277539, "post_id": 58961802, "comment_id": 104178773, "body": "Hard to say without seeing more code. You may find <a href=\"https://stackoverflow.com/help/mcve\">this</a> to be useful in providing us with a minimal, complete example of your code"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1574278634, "post_id": 58961802, "comment_id": 104179337, "body": "Unclear why you would need to activate any worksheet to begin with, or to dereference a worksheet <i>at all</i> from <code>ThisWorkbook.Worksheets</code>. Is the sheet created at run-time or it exists in <code>ThisWorkbook</code> at compile-time?"}, {"owner": {"reputation": 7, "user_id": 12406090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c56643bc565ba6dd058485ac6f6fe669?s=128&d=identicon&r=PG&f=1", "display_name": "zrobers", "link": "https://stackoverflow.com/users/12406090/zrobers"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1574367786, "post_id": 58961802, "comment_id": 104218837, "body": "@MathieuGuindon I am not sure what you mean by that (I am relatively new to VBA). I was, however, able to fix this by changing any instance of &quot;ThisWorkbook&quot; to &quot;ActiveWorkbook.&quot; I know this does not give you a lot to look at, but any idea as to why that would work? I know some implications can arise later down the road with using ActiveWorkbook as opposed to ThisWorkbook, but it will work for now at least. I see now that I could just reference the cells on the worksheet without activating it, but regardless, any instance of ThisWorkbook gives me the same error."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1574367839, "post_id": 58961802, "comment_id": 104218862, "body": "<code>ThisWorkbook</code> is always going to be the document that&#39;s hosting your VBA project. <code>ActiveWorkbook</code> is whatever document is currently active. Read <a href=\"https://stackoverflow.com/q/10714251/1188513\">this</a> though: you almost (like 99.999%) never need to <code>Select</code> or <code>Activate</code> anything."}, {"owner": {"reputation": 7, "user_id": 12406090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c56643bc565ba6dd058485ac6f6fe669?s=128&d=identicon&r=PG&f=1", "display_name": "zrobers", "link": "https://stackoverflow.com/users/12406090/zrobers"}, "edited": false, "score": 0, "creation_date": 1574367975, "post_id": 58961802, "comment_id": 104218924, "body": "I know that. It&#39;s just strange that ThisWorkbook would not work, but ActiveWorkbook did. The workbook hosting the project is the only one I used/had open. The error came out of nowhere after running the program multiple times flawlessly."}], "owner": {"reputation": 7, "user_id": 12406090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c56643bc565ba6dd058485ac6f6fe669?s=128&d=identicon&r=PG&f=1", "display_name": "zrobers", "link": "https://stackoverflow.com/users/12406090/zrobers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574286417, "creation_date": 1574277424, "last_edit_date": 1574286417, "question_id": 58961802, "link": "https://stackoverflow.com/questions/58961802/activex-control-cant-create-object", "title": "ActiveX Control can&#39;t create object", "body": "<p>I have a program that opens up a file, pulls data from it, and puts said data into the corresponding worksheet based on the some information form the file it opens (that part isn't important). I have a Power Query that tells me the names and locations of all the files within a specified folder.</p>\n\n<p>The macro will open the sheet with the power query and begin opening/closing and pulling the data from the files one at a time. Up until now, it has run smoothly. However, today I received an error saying \"ActiveX Control can't create object.\" I have never seen this error before. When I go to Debug, it shows me the line with the error:</p>\n\n<pre><code>ThisWorkbook.Worksheets(\"Query1\").Activate\n</code></pre>\n\n<p>I am unsure as to why it would all of the sudden be erroring out. Any ideas?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574277250, "post_id": 58961655, "comment_id": 104178639, "body": "The range should be a parameter of <code>Nth_Occurrence</code>."}, {"owner": {"reputation": 27, "user_id": 2627814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe124dc36f0aed933fbe100d9e8909af?s=128&d=identicon&r=PG", "display_name": "mikesingleton", "link": "https://stackoverflow.com/users/2627814/mikesingleton"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574277582, "post_id": 58961655, "comment_id": 104178794, "body": "Sorry, BigBen. As I said I&#39;m struggling with  vba, but don&#39;t want to give up. Do you maem that in the code, Activecell.value = NthOccurrence(&quot;k4:k36&quot;,   etc. or are you saying that in the function &quot;Range_Look&quot; should be inside the bracket following Nth_Occurrence(??"}, {"owner": {"reputation": 27, "user_id": 2627814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe124dc36f0aed933fbe100d9e8909af?s=128&d=identicon&r=PG", "display_name": "mikesingleton", "link": "https://stackoverflow.com/users/2627814/mikesingleton"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574277832, "post_id": 58961655, "comment_id": 104178915, "body": "I&#39;m also aware that I have missed a &quot;)&quot; at the end of Activecell.Value = etc...."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574277994, "post_id": 58961655, "comment_id": 104179001, "body": "No. Right now <code>Nth_Occurrence</code> has 3 parameters: <code>Find_It As String, Occurrence As Long, Offset_Row As Long</code>. It should have an additional parameter, which would be the range in question."}, {"owner": {"reputation": 27, "user_id": 2627814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe124dc36f0aed933fbe100d9e8909af?s=128&d=identicon&r=PG", "display_name": "mikesingleton", "link": "https://stackoverflow.com/users/2627814/mikesingleton"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574278495, "post_id": 58961655, "comment_id": 104179266, "body": "OK, tried that. now on the code line I&#39;m getting &quot;By ref argument type mismatch&quot;"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1574278861, "post_id": 58961655, "comment_id": 104179447, "body": "@mikesingleton  update the question with the change.  Do not put it in the comments as it is to hard to read."}, {"owner": {"reputation": 27, "user_id": 2627814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe124dc36f0aed933fbe100d9e8909af?s=128&d=identicon&r=PG", "display_name": "mikesingleton", "link": "https://stackoverflow.com/users/2627814/mikesingleton"}, "edited": false, "score": 0, "creation_date": 1574278891, "post_id": 58961655, "comment_id": 104179461, "body": "I don&#39;t understand where it&#39;s supposed to get the range from, inside the function or in the code line???"}, {"owner": {"reputation": 27, "user_id": 2627814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe124dc36f0aed933fbe100d9e8909af?s=128&d=identicon&r=PG", "display_name": "mikesingleton", "link": "https://stackoverflow.com/users/2627814/mikesingleton"}, "edited": false, "score": 0, "creation_date": 1574278960, "post_id": 58961655, "comment_id": 104179498, "body": "sorry guys, I stand corrected. I&#39;m also new at posting questions even though I&#39;ve been a member for a few years."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 2627814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe124dc36f0aed933fbe100d9e8909af?s=128&d=identicon&r=PG", "display_name": "mikesingleton", "link": "https://stackoverflow.com/users/2627814/mikesingleton"}, "edited": false, "score": 0, "creation_date": 1574321479, "post_id": 58964423, "comment_id": 104192902, "body": "Thank you. Sorry for the delay in responding, but it was late here and I had to leave the forum. I will try your solution later and let you know the result."}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "reply_to_user": {"reputation": 27, "user_id": 2627814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe124dc36f0aed933fbe100d9e8909af?s=128&d=identicon&r=PG", "display_name": "mikesingleton", "link": "https://stackoverflow.com/users/2627814/mikesingleton"}, "edited": false, "score": 1, "creation_date": 1574365235, "post_id": 58964423, "comment_id": 104217748, "body": "@mikesingleton that is because the second variable in the find  needs to be a single cell and not a range of cells.  Updated answer"}, {"owner": {"reputation": 27, "user_id": 2627814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe124dc36f0aed933fbe100d9e8909af?s=128&d=identicon&r=PG", "display_name": "mikesingleton", "link": "https://stackoverflow.com/users/2627814/mikesingleton"}, "edited": false, "score": 0, "creation_date": 1574366059, "post_id": 58964423, "comment_id": 104218096, "body": "Thanks Sorcen. Once again, you must be getting up as I&#39;m going to bed. I&#39;ll try later and let you know!"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1574536337, "post_id": 58964423, "comment_id": 104270322, "body": "This will fail if the first cell in Range_Look matches Find_It (Find starts <i>After</i> the specified cell).  Use <code>Set rFound = Range_Look(Range_Look.Cell.Count)</code>"}, {"owner": {"reputation": 27, "user_id": 2627814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe124dc36f0aed933fbe100d9e8909af?s=128&d=identicon&r=PG", "display_name": "mikesingleton", "link": "https://stackoverflow.com/users/2627814/mikesingleton"}, "edited": false, "score": 0, "creation_date": 1574549661, "post_id": 58964423, "comment_id": 104273592, "body": "Thanks Chris. Tried this and I get &quot;Run time error 438:Object doesn&#39;t support this property or method&quot; at Set rFound = etc.: I just don&#39;t get it!!!"}], "tags": [], "owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "is_accepted": false, "score": 0, "last_activity_date": 1574365246, "last_edit_date": 1574365246, "creation_date": 1574289180, "answer_id": 58964423, "question_id": 58961655, "link": "https://stackoverflow.com/questions/58961655/how-can-i-find-the-nth-occurrence-of-a-value-in-a-column/58964423#58964423", "title": "how can i find the nth occurrence of a value in a column", "body": "<p>You need to add the Range parameter to your function signature.</p>\n\n<pre><code>Dim Range_Look As Range\nRange_Look = ActiveSheet.Range(\"K4:K31\")                    'The worksheet has already been selected\n\n          ActiveCell.Value = Nth_Occurrence(Range_Look, bankacctA, 2, 1)\n\n\n'Function: Add the Range as a paramter\nPublic Function Nth_Occurrence(Range_Look As Range, Find_It As String, Occurrence As Long, Offset_Row As Long)\n\nDim lCount As Long\nDim rFound As Range\n\n    Set rFound = Range_Look(1)'set it to the first cell in the range\n\n\n        For lCount = 1 To Occurrence\n\n            Set rFound = Range_Look.Find(Find_It, rFound, xlValues, xlWhole)\n\n        Next lCount\n\n    Nth_Occurrence = rFound.Offset(Offset_Row)\n\nEnd Function\n</code></pre>\n\n<p>now when you get the by ref error it is because you are passing in a variant where a string is declared for the parameter <code>bankacctA</code> (at least in the provide sample).  You need to declare <code>Dim bankacctA as String</code> or wrap in in a cast <code>CStr(bankacctA)</code></p>\n"}], "owner": {"reputation": 27, "user_id": 2627814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe124dc36f0aed933fbe100d9e8909af?s=128&d=identicon&r=PG", "display_name": "mikesingleton", "link": "https://stackoverflow.com/users/2627814/mikesingleton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 263, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574534052, "creation_date": 1574276819, "last_edit_date": 1574534052, "question_id": 58961655, "link": "https://stackoverflow.com/questions/58961655/how-can-i-find-the-nth-occurrence-of-a-value-in-a-column", "title": "how can i find the nth occurrence of a value in a column", "body": "<p>I have revamped the VBA yet again. Now when I run it I get nothing. It doesn't \"crash\", but it doesn't give the expected answer.</p>\n\n<p>I copied this from a VBA example on the net, and after the explanation of the function it said:</p>\n\n<blockquote>\n  <p>The custom function/formula can now be used as shown below:<br>\n  \"=Nth_Occurrence($B$1:$B$22,\"Harry\",3,0,1)\" (ignore the \"speach marks\")</p>\n</blockquote>\n\n<p>It does not explain what in the code you have to have before the <code>=Nth_Occurrence</code> etc. Should this be a variable (variant or string)? or something else.</p>\n\n<p>It also does not explain how to define \"Range_Look\" so I'm guessing at: <code>set Range_Look = range($K$4:$K$41)</code> (my range as opposed to the example).</p>\n\n<p>And finally, if I change the <code>Set Range_Look = Range(\"K4:K34\")</code> to <code>Range_Look = ActiveSheet.Range(\"K4:K31\")</code>, I get \"Run time error 91: Object variable or With block variable not set\", or do I need both?</p>\n\n<p>I know I'm being a real pain in the proverbial, but it's driving me crazy. I also know this is NOT the only way to achieve my end result, but it IS (I think) quite elegant, or it would be if I can get it to work.</p>\n\n<p>Please someone (Sorceri?), put me out of my misery.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Macro2()\n'\n' Macro2 Macro\n'\n' Keyboard Shortcut: Ctrl+q\n\n    Dim bankacctA As String                      'Finds the \"Check Year\" bankacct\n    Dim bankacctB As String                      'This will be the \"New\" generated year\n\n    Input_Year = InputBox(Prompt:=\"What is the Year you wish to Add - Enter in format yyyy\", _\n        Title:=\"ENTER THE YEAR\", Default:=\"No Year Entered\")\n\n    If IsNumeric(Input_Year) = False Then\n        Exit Sub\n    Else\n    End If\n\n    Short_Input_Year = Right(Input_Year, 2)      'The last 2 digits of the Input Year\n    Check_Year = Input_Year - 1\n    Short_Check_Year = Right(Check_Year, 2)      'The last 2 digits of the Check Year\n    Next_Year = (Input_Year + 1)\n\n    bankacctA = (\"bankacct\" &amp; Short_Check_Year) &amp; \".xlsx\"                                          'Finds the \"Check Year\" bankacct\n\n    Dim Range_Look As Range\n    Dim a As Variant\n\n    Windows(\"Savings Details.xlsm\").Activate\n    Sheets(\"Table Sort\").Select\n\n    Set Range_Look = Range(\"K4:K34\")    'The worksheet has already been selected\n\n    a = Nth_Occurrence(Range_Look, CStr(bankacctA), 2, 1, -1)\n\n    ActiveCell.Offset(0, -1).Value = a\nEnd Sub\n\nFunction Nth_Occurrence(Range_Look As Range, Find_It As String, Occurrence As Long, Offset_Row As Long, Offset_Col As Long)\n    Dim lCount As Long\n    Dim rFound As Range\n\n    Set rFound = Range_Look.Cells(1, 1)\n        For lCount = 1 To Occurrence\n           Set rFound = Range_Look.Find(Find_It, rFound, xlValues, xlPart)\n        Next lCount\n     Nth_Occurrence = rFound.Offset(Offset_Row, Offset_Col)\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "select-case"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1574277171, "post_id": 58961632, "comment_id": 104178603, "body": "Highly suggest you give <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">this question</a> a read."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1574277259, "post_id": 58961632, "comment_id": 104178644, "body": "It all depends on exactly what your data is on the worksheet and what you expect. Can you provide an example of your data?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1574277976, "post_id": 58961632, "comment_id": 104178992, "body": "What is the <code>ActiveCell</code> address when this procedure is called, and what is its value? Note that <code>Check</code> is constant for every iteration of the loop..."}, {"owner": {"reputation": 638, "user_id": 6262777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba70681b78b1049d75c733e25afa4fe6?s=128&d=identicon&r=PG&f=1", "display_name": "LowKeyEnergy", "link": "https://stackoverflow.com/users/6262777/lowkeyenergy"}, "edited": false, "score": 0, "creation_date": 1574278019, "post_id": 58961632, "comment_id": 104179011, "body": "If this is wrong, what is the behavior you are expecting?"}, {"owner": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 0, "creation_date": 1574278172, "post_id": 58961632, "comment_id": 104179115, "body": "Right now, this code is getting the value of whatever cell you happen to have selected when you start running it, and storing it in <code>Check</code>. Then, starting with cell A2, it&#39;s coloring the cells of column A with a color, depending on the value that came from that initially selected cell. Once it hits a cell that has a value, it stops. Is  all that what you mean to happen?"}, {"owner": {"reputation": 29, "user_id": 12405955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa0cab509042d6398b542e54c92a2f1?s=128&d=identicon&r=PG&f=1", "display_name": "JakubTracz", "link": "https://stackoverflow.com/users/12405955/jakubtracz"}, "edited": false, "score": 0, "creation_date": 1574282715, "post_id": 58961632, "comment_id": 104181245, "body": "The pattern in the cells (their value) counting from the cell A2 down is: Red Blue Green. What I wanted: if e.g the cell in A5 says Green the entire row 5 should go green. If the cell in A28 says Blue, the entire row 28 should go blue, etc. If I change the Select Case to a bunch of Elseif, it works fine."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1574282835, "post_id": 58961632, "comment_id": 104181305, "body": "The point is that your code is doing exactly what you wrote the code to do. We&#39;re less clear about what you <b>want</b> the code to do. What is the data? What result do you want to see, based on the data and the active cell?"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 12405955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa0cab509042d6398b542e54c92a2f1?s=128&d=identicon&r=PG&f=1", "display_name": "JakubTracz", "link": "https://stackoverflow.com/users/12405955/jakubtracz"}, "edited": false, "score": 0, "creation_date": 1574285231, "post_id": 58961970, "comment_id": 104182336, "body": "Thank you very much for this reply. I understand your point and checked - it works, however I don&#39;t understand why the <code>Check</code> variable with the <code>ActiveCell.Value</code> assigned to it gives a different output than the plain <code>ActiveCell.Value</code> used within the <code>Select Case</code>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 29, "user_id": 12405955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa0cab509042d6398b542e54c92a2f1?s=128&d=identicon&r=PG&f=1", "display_name": "JakubTracz", "link": "https://stackoverflow.com/users/12405955/jakubtracz"}, "edited": false, "score": 0, "creation_date": 1574285681, "post_id": 58961970, "comment_id": 104182509, "body": "@JakubTracz <code>Check</code> is assigned once, before the loop, and then never reassigned again: it&#39;s still holding the exact same cell reference at every iteration - <code>Check</code> isn&#39;t magically going to &quot;keep up&quot; with what the <code>ActiveCell</code> is while the body of the loop constantly activates a different cell. Don&#39;t do this to yourself - avoid Select/Activate and you won&#39;t have to deal with this kind of issues."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1574278172, "creation_date": 1574278172, "answer_id": 58961970, "question_id": 58961632, "link": "https://stackoverflow.com/questions/58961632/why-do-i-get-random-wrong-output-from-vba-select-case/58961970#58961970", "title": "Why do I get random/wrong output from VBA Select Case?", "body": "<p><code>Check</code> in constant for every iteration of the loop, so <code>Select Case Check</code> always evaluates to the same thing, and the outcome of the execution of this procedure depends solely on the value of whatever cell happened to be the <code>ActiveCell</code> when the procedure was invoked.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">Avoid Select and Activate</a>, but to fix your current immediate problem, you'll want to replace <code>Check</code> with <code>ActiveCell</code> here, and maybe explicitly invoke its <code>Value</code> member:</p>\n\n<pre><code>Select Case ActiveCell.Value\n</code></pre>\n\n<p>The <code>Check</code> assignment becomes redundant, and now the loop will successively activate a cell starting in A2, evaluate its content, and set the interior color accordingly.</p>\n\n<p>This could also be achieved without any VBA code, using conditional formatting rules applied to the entire row. Consider using conditional formatting instead.</p>\n"}], "owner": {"reputation": 29, "user_id": 12405955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa0cab509042d6398b542e54c92a2f1?s=128&d=identicon&r=PG&f=1", "display_name": "JakubTracz", "link": "https://stackoverflow.com/users/12405955/jakubtracz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 58961970, "answer_count": 1, "score": 0, "last_activity_date": 1574283431, "creation_date": 1574276728, "last_edit_date": 1574283431, "question_id": 58961632, "link": "https://stackoverflow.com/questions/58961632/why-do-i-get-random-wrong-output-from-vba-select-case", "title": "Why do I get random/wrong output from VBA Select Case?", "body": "<p>I have a problem with the code below. I've just started to learn this and when I did a simple exercise, it turned out the code is working really randomly. </p>\n\n<p>Sometime nothing is done, sometime only one case is being selected but never the right formatting is applied. I'm quite confused. </p>\n\n<p>Could you please help on this one? ;)</p>\n\n<pre><code>Sub Colors()\n\nDim Check As String\nCheck = ActiveCell.Value\nRange(\"A2\").Select\n\nDo While ActiveCell.Value &lt;&gt; \"\"\n\n    Select Case Check\n    Case \"Red\"\n        ActiveCell.EntireRow.Interior.Color = RGB(200, 100, 100)\n    Case \"Blue\"\n        ActiveCell.EntireRow.Interior.Color = RGB(100, 100, 200)\n    Case \"Green\"\n        ActiveCell.EntireRow.Interior.Color = RGB(100, 200, 100)\n    End Select\n\n    ActiveCell.Offset(1, 0).Select\n\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1574276596, "post_id": 58961548, "comment_id": 104178306, "body": "Is the workbook open or not? If not, you need to do workbook.open. other wise, just use <code>Set ws = ThisWorkbook.Sheets(&quot;Sheet1&quot;)</code>"}, {"owner": {"reputation": 39, "user_id": 12401306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0398ce99e0e65db50c2fa20fb48d53c?s=128&d=identicon&r=PG&f=1", "display_name": "Mturks83", "link": "https://stackoverflow.com/users/12401306/mturks83"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1574276842, "post_id": 58961548, "comment_id": 104178427, "body": "Thanks - that worked. Any idea why stating the location caused an issue?"}, {"owner": {"reputation": 890, "user_id": 9085446, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QTMxB.png?s=128&g=1", "display_name": "MRah", "link": "https://stackoverflow.com/users/9085446/mrah"}, "edited": false, "score": 0, "creation_date": 1574277301, "post_id": 58961548, "comment_id": 104178663, "body": "@Mturks83, if the worksheet you&#39;re trying to access is inside the current workbook then you don&#39;t need to open the workbook as it is already open and you&#39;re code is inside.  ThisWorkbook gives you the handle of the workbook you&#39;re code is in."}], "answers": [{"tags": [], "owner": {"reputation": 890, "user_id": 9085446, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QTMxB.png?s=128&g=1", "display_name": "MRah", "link": "https://stackoverflow.com/users/9085446/mrah"}, "is_accepted": false, "score": 1, "last_activity_date": 1606852696, "last_edit_date": 1606852696, "creation_date": 1574277153, "answer_id": 58961726, "question_id": 58961548, "link": "https://stackoverflow.com/questions/58961548/declare-worksheet-as-variable/58961726#58961726", "title": "Declare Worksheet as Variable", "body": "<p>You need to open the workbook. Here is an example, I also declared a workbook variable so that it's easier to do workbook operations once you are finished doing work with the worksheet.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Test()\n    Dim wb As Workbook\n    Dim ws As Worksheet\n      \n    ' The workbook file path string should be another workbook that \n    ' you're trying to open (Not the current workbook)\n        \n    Set wb = Workbooks.Open(&quot;C:\\Users\\mturkenburg\\OneDrive -    WHISPIR\\Whispir\\Desktop\\IT Learnings\\VBA\\The Complete VBA Excel VBA Course for Beginners.xlsm&quot;)\n     \n    '   Use the following if you're trying to access the worksheet\n    '   Inside the Workbook\n    '   Set ws = ThisWorkbook.Worksheets(&quot;TestSheet&quot;)\n        Set ws = wb.Worksheets(&quot;Testsheet&quot;)\n         \n    ' Do your thing with worksheet\n    Debug.Print ws.Name\n        \n    ' Close the workbook\n    wb.Close False\n        \nEnd Sub\n</code></pre>\n<p>Here is another example, if you have multiple workbooks open and you want to access one of them,</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Test()\n    Dim ws As Worksheet\n\n    '   Only use the name of the workbook inside the Workbooks Function\n    Set ws = Workbooks(&quot;The Complete VBA Excel VBA Course for Beginners&quot;).Worksheets(&quot;TestSheet&quot;)\n        \n    '   Do your thing with the worksheet\n    Debug.Print ws.Name\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 12401306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0398ce99e0e65db50c2fa20fb48d53c?s=128&d=identicon&r=PG&f=1", "display_name": "Mturks83", "link": "https://stackoverflow.com/users/12401306/mturks83"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1606852696, "creation_date": 1574276379, "last_edit_date": 1606846699, "question_id": 58961548, "link": "https://stackoverflow.com/questions/58961548/declare-worksheet-as-variable", "title": "Declare Worksheet as Variable", "body": "<p>I'm trying to declare a particular worksheet as a variable.</p>\n<p>I'm receiving a runtime error 9</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Test()\n    Dim ws As Worksheet\n    Set ws = Workbooks(&quot;C:\\Users\\mturkenburg\\OneDrive - WHISPIR\\Whispir\\Desktop\\IT Learnings\\VBA\\The Complete VBA Excel VBA Course for Beginners.xlsm&quot;).Worksheets(&quot;Testsheet&quot;)\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1574277084, "creation_date": 1574277084, "answer_id": 58961713, "question_id": 58961465, "link": "https://stackoverflow.com/questions/58961465/how-to-save-a-code-in-thisoutlooksession-as-a-script-which-i-can-choose-when-i/58961713#58961713", "title": "How to save a code in ThisOutlookSession as a script which I can choose, when I choose the &quot;run a script&quot; rule in Outlook", "body": "<p>A VBA method should have the following signature:</p>\n\n<pre><code>Public Sub Test(item as MailItem)\n   ' do whatever you need here\nEnd Sub\n</code></pre>\n\n<p>You can read more about that in the <a href=\"https://www.slipstick.com/outlook/rules/outlooks-rules-and-alerts-run-a-script/\" rel=\"nofollow noreferrer\">Outlook's Rules and Alerts: Run a Script</a> article.</p>\n"}], "owner": {"reputation": 27, "user_id": 10967719, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MLkFYWV8x-w/AAAAAAAAAAI/AAAAAAAABs8/Kc1pcKGcRqc/photo.jpg?sz=128", "display_name": "cyriac jacob", "link": "https://stackoverflow.com/users/10967719/cyriac-jacob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "closed_date": 1574321473, "answer_count": 1, "score": 0, "last_activity_date": 1583834399, "creation_date": 1574276044, "last_edit_date": 1583834399, "question_id": 58961465, "link": "https://stackoverflow.com/questions/58961465/how-to-save-a-code-in-thisoutlooksession-as-a-script-which-i-can-choose-when-i", "closed_reason": "Duplicate", "title": "How to save a code in ThisOutlookSession as a script which I can choose, when I choose the &quot;run a script&quot; rule in Outlook", "body": "<p>I ran a code in VBA in Outlook to save a .csv attachment of a particular sender with a particular subject line to a folder on my local drive. This code was run on ThisOutlookSession and not as a module. I tried to use the \"run a script\" rule in my outlook, but when the pop-up window appears with the option to choose a script, it is blank. Can someone help me out with this? How do I save the code in ThisOutlookSession for it appear as an option in the scripts pop-up window of \"run a script\" rule in Outlook? </p>\n\n<p><a href=\"https://i.stack.imgur.com/aNMJS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aNMJS.png\" alt=\"Pop-up window to select script after selecting rule\"></a></p>\n"}, {"tags": ["excel", "vba", "charts"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1574276114, "post_id": 58961461, "comment_id": 104178127, "body": "If this is working code, then <a href=\"https://codereview.stackexchange.com/\">Code Review</a> may be a more appropriate place for this question."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1574276221, "post_id": 58961461, "comment_id": 104178166, "body": "Related to your statement, &quot;<i>can all of the chart parameters we want be set programmatically as default</i>&quot;, you want to set a theme in Excel for a chart?  Without seeing your charts, there could be umpteen ways to work, like making 1 chart with desired format, then copy/paste and modify that copy for each new dataseries.  At the end of the day, more information will be needed."}, {"owner": {"reputation": 3, "user_id": 12405947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5cea613dfe1e31822bdb5eb6ac6063a?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Neitzel", "link": "https://stackoverflow.com/users/12405947/scott-neitzel"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1574276626, "post_id": 58961461, "comment_id": 104178322, "body": "Cyril, the code is working right now but bogs down when excel is formatting the chart.  The process is, Access culls data, send to excel, tells excel to draw a chart (with the code above) then formats it; next data set, access culls data, sends to excel (same workbook) draws chart then formats it. My hope was I could set the chart parameters once in the main function once, then when the sub above is run, all it needs to do is draw the chart.  It would already be in the desired format."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12405947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5cea613dfe1e31822bdb5eb6ac6063a?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Neitzel", "link": "https://stackoverflow.com/users/12405947/scott-neitzel"}, "edited": false, "score": 0, "creation_date": 1574457225, "post_id": 58987494, "comment_id": 104254044, "body": "Interesting idea. One additional issue is the process is run from different PCs so that template would need to be on every one.  Unless it could be saved in same spot on the network as the access DB and called from there...  I&#39;ll try that and see if it works."}, {"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "reply_to_user": {"reputation": 3, "user_id": 12405947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5cea613dfe1e31822bdb5eb6ac6063a?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Neitzel", "link": "https://stackoverflow.com/users/12405947/scott-neitzel"}, "edited": false, "score": 0, "creation_date": 1574571513, "post_id": 58987494, "comment_id": 104276814, "body": "I think a network admin could put a template into a shared folder somewhere. I don&#39;t know how that stuff works."}], "tags": [], "owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "is_accepted": true, "score": 0, "last_activity_date": 1574396638, "creation_date": 1574396638, "answer_id": 58987494, "question_id": 58961461, "link": "https://stackoverflow.com/questions/58961461/setting-default-chart-parametersin-excel-vba/58987494#58987494", "title": "Setting default chart parametersin Excel/VBA", "body": "<p>If the chart isn't too complicated (and yours isn't), you could make it manually, save it as a template (named \"MyChartTemplate\" in this example), then apply the template to the chart. You would essentially replace this</p>\n\n<pre><code>ObjXlChrt.ChartType = xlLineMarkers\n</code></pre>\n\n<p>with this</p>\n\n<pre><code>ObjXlChrt.ApplyChartTemplate Environ(\"appdata\") &amp; _\n    \"\\Microsoft\\Templates\\Charts\\MyChartTemplate.crtx\"\n</code></pre>\n\n<p>and then cut out all of that formatting.</p>\n"}, {"comments": [{"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1574571625, "post_id": 59003325, "comment_id": 104276830, "body": "Glad it helped. Could you mark my post as answering your question?"}], "tags": [], "owner": {"reputation": 3, "user_id": 12405947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5cea613dfe1e31822bdb5eb6ac6063a?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Neitzel", "link": "https://stackoverflow.com/users/12405947/scott-neitzel"}, "is_accepted": false, "score": 0, "last_activity_date": 1574467533, "creation_date": 1574467533, "answer_id": 59003325, "question_id": 58961461, "link": "https://stackoverflow.com/questions/58961461/setting-default-chart-parametersin-excel-vba/59003325#59003325", "title": "Setting default chart parametersin Excel/VBA", "body": "<p>Thanks Jon Peltier!</p>\n\n<p>Your approach works great.\nI saved the format of one of my completed charts as a template and copied that .crtx file to a network location.\nThen I simply inserted <code>ObjXlChrt.ApplyChartTemplate \"\\\\Network\\location\\MyChHartTemplate.crtx</code> in my code to replace all the formatting.\nMakes future changes easier as well, as all I need to do is create a new template file.</p>\n\n<p>Not the route I thought I needed to take but that's why I posted here to get some other opinions.</p>\n\n<p>Thanks again Jon</p>\n"}], "owner": {"reputation": 3, "user_id": 12405947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5cea613dfe1e31822bdb5eb6ac6063a?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Neitzel", "link": "https://stackoverflow.com/users/12405947/scott-neitzel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 58987494, "answer_count": 2, "score": 0, "last_activity_date": 1574467533, "creation_date": 1574276028, "question_id": 58961461, "link": "https://stackoverflow.com/questions/58961461/setting-default-chart-parametersin-excel-vba", "title": "Setting default chart parametersin Excel/VBA", "body": "<p>I have a process in MSAccess that culls data then creates a new excel workbook, pushes data out to it then creates a chart in excel.</p>\n\n<p>Once created, the chart is formatted to our preferred look.<br>\nThat is where things slow down.\nWe are setting up each individual chart after it has been drawn and with 150 or so charts total, it takes a while.</p>\n\n<p>What I am wondering is, can all of the chart parameters we want be set programmatically as default?\nThat way, we set once and all charts drawn are in that format from the beginning.</p>\n\n<p>Code used to generate and format charts attached.</p>\n\n<p>Thanks</p>\n\n<pre><code>Sub CreateChart(ObjXlWs As Worksheet, K As Integer)\nDim ObjXlChrt As Chart\nDim FixChart As ChartObject\nDim Cntr, J As Integer\nDim ChartNm\nDim xRg As Range\n\nCntr = K\nSet xRg = Range(Split(Cells(1, (((Cntr - 1) * 12 + 1) + 1)).Address, \"$\")(1) &amp; \"4:\" &amp; (Split(Cells(1, (((Cntr - 1) * 12 + 10) + 1)).Address, \"$\")(1) &amp; \"26\"))\n\n    Set ObjXlChrt = ObjXlWs.ChartObjects.Add(50, 40, 600, 400).Chart\n    ObjXlChrt.ChartType = xlLineMarkers\n    ObjXlChrt.SetSourceData Source:=Sheets(ObjXlWs.Name).Range(Split(Cells(1, (((Cntr - 1) * 12 + 2) + 1)).Address, \"$\")(1) &amp; \"66:\" &amp; _\n        Split(Cells(1, (((Cntr - 1) * 12 + 7) + 1)).Address, \"$\")(1) &amp; 65 + ObjXlWs.Range(Split(Cells(1, (((Cntr - 1) * 12 + 5) + 1)).Address, \"$\")(1) &amp; \"62\").Value), PlotBy:=xlColumns\n    ObjXlChrt.Location Where:=xlLocationAsObject, Name:=ObjXlWs.Name\n    Set FixChart = ActiveSheet.ChartObjects(K)\n    With FixChart\n        .Top = xRg(1).Top\n        .Left = xRg(1).Left\n        .Width = xRg.Width\n        .Height = xRg.Height\n    End With\n\n    With ObjXlChrt\n        .HasAxis(xlCategory, xlPrimary) = True\n        .HasAxis(xlValue, xlPrimary) = True\n        .HasTitle = False\n        .Axes(xlCategory).CategoryType = xlCategoryScale\n        .Axes(xlCategory, xlPrimary).HasTitle = True\n        .Axes(xlCategory, xlPrimary).AxisTitle.Characters.Text = \"Date:\"\n        .Axes(xlValue, xlPrimary).HasTitle = True\n        .Axes(xlValue, xlPrimary).AxisTitle.Characters.Text = Sheets(ObjXlWs.Name).Range(Split(Cells(1, (((Cntr - 1) * 12 + 1) + 1)).Address, \"$\")(1) &amp; \"60\").Value\n        .Axes(xlCategory).HasMajorGridlines = False\n        .Axes(xlCategory).HasMinorGridlines = False\n        .Axes(xlValue).HasMajorGridlines = False\n        .Axes(xlValue).HasMinorGridlines = False\n        .HasLegend = False\n    End With\n\n   With ObjXlChrt.Axes(xlCategory).TickLabels\n        .Orientation = xlUpward\n        .Font.Name = \"Arial\"\n        .Font.FontStyle = \"Regular\"\n        .Font.Size = 8\n    End With\n\n    With ObjXlChrt.Axes(xlCategory).AxisTitle\n        .Font.Name = \"Arial\"\n        .Font.FontStyle = \"Regular\"\n        .Font.Size = 8\n    End With\n\n    With ObjXlChrt.Axes(xlValue).TickLabels\n        .Font.Name = \"Arial\"\n        .Font.FontStyle = \"Regular\"\n        .Font.Size = 8\n    End With\n\n    With ObjXlChrt.Axes(xlValue).AxisTitle\n        .Font.Name = \"Arial\"\n        .Font.FontStyle = \"Regular\"\n        .Font.Size = 8\n    End With\n\n    ObjXlChrt.PlotArea.ClearFormats\n\n    ObjXlChrt.Axes(xlCategory).AxisTitle.Left = 16\n    ObjXlChrt.Axes(xlCategory).AxisTitle.Top = 300\n\n    ObjXlChrt.PlotArea.Left = 45\n    ObjXlChrt.PlotArea.Width = 425\n    ObjXlChrt.PlotArea.Top = 21\n    ObjXlChrt.PlotArea.Height = 310\n\n    On Error Resume Next\n\n    With ObjXlChrt.SeriesCollection(5)\n        .Border.ColorIndex = 1\n        .Border.Weight = xlThin\n        .Border.LineStyle = xlDot\n        .MarkerStyle = xlNone\n    End With\n\n    With ObjXlChrt.SeriesCollection(4)\n        .Border.ColorIndex = 1\n        .Border.Weight = xlThin\n        .Border.LineStyle = xlDot\n        .MarkerStyle = xlNone\n    End With\n\n    With ObjXlChrt.SeriesCollection(3)\n        .Border.ColorIndex = 1\n        .Border.Weight = xlThin\n        .Border.LineStyle = xlDashDot\n        .MarkerStyle = xlNone\n    End With\n\n    With ObjXlChrt.SeriesCollection(2)\n        .Border.ColorIndex = 1\n        .Border.Weight = xlThin\n        .Border.LineStyle = xlContinuous\n        .MarkerStyle = xlSquare\n        .MarkerBackgroundColorIndex = 2\n        .MarkerForegroundColorIndex = 1\n        .MarkerSize = 3\n    End With\n\n    With ObjXlChrt.SeriesCollection(1)\n        .Border.ColorIndex = 1\n        .Border.Weight = xlHairline\n        .Border.LineStyle = xlContinuous\n        .MarkerStyle = xlAutomatic\n        .MarkerBackgroundColorIndex = xlAutomatic\n        .MarkerForegroundColorIndex = xlAutomatic\n        .MarkerSize = 3\n    End With\n\n    On Error GoTo 0\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "vlookup"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12405690, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ycmjwrdkTM8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfxmamtNOqWoZ0Cwk8r250y5B8qRw/photo.jpg?sz=128", "display_name": "gautham s", "link": "https://stackoverflow.com/users/12405690/gautham-s"}, "edited": false, "score": 0, "creation_date": 1574408457, "post_id": 58961170, "comment_id": 104230437, "body": "Hello Scott, Thanks for reading the above case and sharing your ideas. i will try the above and let you soon. thanks for the support"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1574274837, "creation_date": 1574274837, "answer_id": 58961170, "question_id": 58961096, "link": "https://stackoverflow.com/questions/58961096/vlookup-to-pick-the-nearest-date-lesser-date-from-the-reference-cell/58961170#58961170", "title": "vlookup to pick the nearest date lesser date from the reference cell", "body": "<p>Use AGGREGATE:</p>\n\n<pre><code>=AGGREGATE(14,7,B2:B100/((A2:A100=\"Bearing\")*(B2:B100&lt;=Date(2019,10,22)),1)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12405690, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ycmjwrdkTM8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfxmamtNOqWoZ0Cwk8r250y5B8qRw/photo.jpg?sz=128", "display_name": "gautham s", "link": "https://stackoverflow.com/users/12405690/gautham-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1574274837, "creation_date": 1574274489, "last_edit_date": 1574274663, "question_id": 58961096, "link": "https://stackoverflow.com/questions/58961096/vlookup-to-pick-the-nearest-date-lesser-date-from-the-reference-cell", "title": "vlookup to pick the nearest date lesser date from the reference cell", "body": "<p>I required your support,</p>\n\n<p>I have a datasheet (Sheet1) which is having product details and its dates which are been imported. Another sheet (Sheet2) which are also having product details and its dates which are been exported by the seller. Both the sheet dates might not be equal nor the total no. of rows will be the same. </p>\n\n<p>I wanted to understand if a Vlookup can compare the dates of sheet 1 &amp; sheet2 for each product keeping the imported dates of sheet 1 as a reference and pull the nearest lowest date from the sheet2 \"created date\"  </p>\n\n<p>Sheet 1 is having the data which is from imported data </p>\n\n<p>Sheet 2 is the date which shows the actual export from the seller </p>\n\n<p>So now I need to do a comparison for the Product bearing (cell A2) from Sheet 1, which is having the imported date as of 10/22/2019. Comparing to the next Sheet2 (Image 2 ) for the same product bearing which is having the created dates as 10/18/2019, 11/08/2019,10/16/2019. </p>\n\n<p>The formula should now pick a date which is nearest lesser to the imported date which is in the sheet1. in this case, formula to pick the date 10/18/2019.</p>\n\n<p><a href=\"https://i.stack.imgur.com/L0ASu.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/L0ASu.jpg\" alt=\"Image 1 - Imported data with dates[][1]\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/kprs7.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kprs7.jpg\" alt=\"Image2 - Exported Data from Seller\"></a></p>\n\n<p>I tried to sort the data to lowest to highest and highest to lowest, but v-lookup results were not always right. I tried to insert the IF condition resulted in no luck. </p>\n\n<p>It would be very helpful if you all share some insight into this case. </p>\n\n<p>Thank you for reading the above case.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1574272703, "post_id": 58960405, "comment_id": 104176461, "body": "Don&#39;t use worksheet functions for flow control. Use VBA language constructs (e.g. <code>If...Then...Else...End If</code>) for that."}], "answers": [{"comments": [{"owner": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "edited": false, "score": 0, "creation_date": 1574272355, "post_id": 58960488, "comment_id": 104176271, "body": "@ Scott Craner - Does VB/VBA default to &quot;ByVal&quot; when not specified as in this example?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "edited": false, "score": 4, "creation_date": 1574272450, "post_id": 58960488, "comment_id": 104176326, "body": "@GlennG parameters in VBA are always <code>ByRef</code> unless specified otherwise (and yes, you want <code>ByVal</code> 99.999% of the time)"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1574272521, "last_edit_date": 1574272521, "creation_date": 1574272088, "answer_id": 58960488, "question_id": 58960405, "link": "https://stackoverflow.com/questions/58960405/how-can-i-add-an-if-clause-in-a-vba-custom-function/58960488#58960488", "title": "How can I add an if clause in a [vba] custom function", "body": "<p>Use:</p>\n\n<pre><code>Function potential(ByVal Volume As Double, ByVal Original As Double, Optional ByVal Better As Double = 0) As Double\n    If Better = 0 Then Exit Function\n    potential = (Original - Better) * Volume\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 11499924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/677f568ba5205a72867399140d4823b0?s=128&d=identicon&r=PG&f=1", "display_name": "Shevy", "link": "https://stackoverflow.com/users/11499924/shevy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 58960488, "answer_count": 1, "score": 0, "last_activity_date": 1574272521, "creation_date": 1574271812, "question_id": 58960405, "link": "https://stackoverflow.com/questions/58960405/how-can-i-add-an-if-clause-in-a-vba-custom-function", "title": "How can I add an if clause in a [vba] custom function", "body": "<p>I wrote this function</p>\n\n<pre><code>Function potential(Volume, Original, Better)\npotential = (Original - Better) * Volume\nEnd Function\n</code></pre>\n\n<p>Its pretty basic but what i really need is in the case when Better is blank the answer should be 0</p>\n\n<p>I tried \n<code>potential = Application.WorksheetFunction.If(Better = 0, 0, (Original - Better) * Volume)</code>\nresult is always an error</p>\n\n<p>or <code>potential = ((Original - Better) * Volume) * (Better / Better)</code> only gave an error when Better is blank</p>\n\n<p>So I tried <code>potential = Application.WorksheetFunction.IfError(((Original - Better) * Volume) * (Better / Better), 0)</code>  with the same results</p>\n\n<p>What am I doing wrong here?</p>\n"}, {"tags": ["excel", "vba", "authentication", "internet-explorer"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1574274152, "post_id": 58959954, "comment_id": 104177204, "body": "I can&#39;t quickly find a decent dupe target but this is a dupe. You can use attribute selectors e.g. ie.document.querySelector(&quot;[name=Usuario]&quot;).value = &quot;username&quot;  ......."}, {"owner": {"reputation": 1, "user_id": 12405486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9377de1c2346552f87754ba3f69be521?s=128&d=identicon&r=PG&f=1", "display_name": "borjaille", "link": "https://stackoverflow.com/users/12405486/borjaille"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1574288375, "post_id": 58959954, "comment_id": 104183588, "body": "If I fill the username field or password field, results this  <a href=\"https://pixeldrain.com/u/dB-IB9gR\" rel=\"nofollow noreferrer\">pixeldrain.com/u/dB-IB9gR</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12405486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9377de1c2346552f87754ba3f69be521?s=128&d=identicon&r=PG&f=1", "display_name": "borjaille", "link": "https://stackoverflow.com/users/12405486/borjaille"}, "edited": false, "score": 0, "creation_date": 1574440578, "post_id": 58968203, "comment_id": 104246912, "body": "An error occurred in VBA while using your code. Maybe because the &quot;value&quot; in developer mode doesn&#39;t appear until I fill in the field  <a href=\"https://pixeldrain.com/u/BQ1_BZa1\" rel=\"nofollow noreferrer\">pixeldrain.com/u/BQ1_BZa1</a> <a href=\"https://pixeldrain.com/u/tYX9_eID\" rel=\"nofollow noreferrer\">pixeldrain.com/u/tYX9_eID</a>"}, {"owner": {"reputation": 10390, "user_id": 7062291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17ca0ff9016cfdb9352adaf4435737d6?s=128&d=identicon&r=PG&f=1", "display_name": "Zhi Lv", "link": "https://stackoverflow.com/users/7062291/zhi-lv"}, "reply_to_user": {"reputation": 1, "user_id": 12405486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9377de1c2346552f87754ba3f69be521?s=128&d=identicon&r=PG&f=1", "display_name": "borjaille", "link": "https://stackoverflow.com/users/12405486/borjaille"}, "edited": false, "score": 0, "creation_date": 1574646612, "post_id": 58968203, "comment_id": 104293409, "body": "How about using the getElementsByName method, whether it works well? Besides, about the &quot;Method &#39;Document&#39; of object &#39;IWebBrowser2&#39; failed&quot; error, try to use internet explorer at a medium integrity level. InternetExplorer defaults to a low integrity level which, if you are doing this over a local intranet at work, sometimes will give the second error message you show above. More detail information, please refer <a href=\"https://stackoverflow.com/questions/30086425/excel-vba-method-document-of-object-iwebbrowser2-failed\">this thread</a>."}], "tags": [], "owner": {"reputation": 10390, "user_id": 7062291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17ca0ff9016cfdb9352adaf4435737d6?s=128&d=identicon&r=PG&f=1", "display_name": "Zhi Lv", "link": "https://stackoverflow.com/users/7062291/zhi-lv"}, "is_accepted": false, "score": 0, "last_activity_date": 1574315976, "creation_date": 1574315976, "answer_id": 58968203, "question_id": 58959954, "link": "https://stackoverflow.com/questions/58959954/login-using-internet-explorer/58968203#58968203", "title": "Login using Internet Explorer", "body": "<p>You could find the html elements based on the elements' <strong>Name</strong> attribute, try to use the <strong>getElementsByName()</strong> method or the <strong><a href=\"https://www.w3schools.com/jsref/met_document_queryselector.asp\" rel=\"nofollow noreferrer\">querySelector()</a></strong> method. </p>\n\n<p>Sample code as below:</p>\n\n<pre><code>Sub Test()\n    Dim IE As Object\n\n    Dim startDateText As Object, endDateText As Object\n\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    With IE\n        .Visible = True\n        .Navigate \"&lt;web page url&gt;\"\n\n        While IE.ReadyState &lt;&gt; 4\n            DoEvents\n        Wend\n        ''uncomment the following code to use the getElementsByName() method to find the elements.\n        '.document.getElementsByName(\"Usuario\")(0).Focus\n        '.document.getElementsByName(\"Usuario\")(0).Value = \"rodrigo.bs\"\n        '.document.getElementsByName(\"Senha\")(0).Focus\n        '.document.getElementsByName(\"Senha\")(0).Value = \"Rb123456\"\n        '.document.getElementsByName(\"Submit\")(0).Click\n\n        'using the queryselector method to find the elements (based on the input element name attribute). \n        IE.document.querySelector(\"input[name='Usuario']\").Focus\n        IE.document.querySelector(\"input[name='Usuario']\").Value = \"rodrigo.ba\"\n        IE.document.querySelector(\"input[name='Senha']\").Focus\n        IE.document.querySelector(\"input[name='Senha']\").Value = \"Rb123456\"\n        IE.document.querySelector(\"input[name='Submit']\").Click\n\n    End With\n    Set IE = Nothing\nEnd Sub\n</code></pre>\n\n<p>the web page resource:</p>\n\n<pre><code>&lt;table&gt;\n    &lt;tr&gt;\n        &lt;td&gt;\n            Usuario:\n        &lt;/td&gt;\n        &lt;td&gt;\n            &lt;input name=\"Usuario\" id=\"\" style=\"height:22px; width:102px\" type=\"text\" maxlength=\"11\" value=\"\" /&gt;\n        &lt;/td&gt;\n    &lt;/tr&gt;\n    &lt;tr&gt;\n        &lt;td&gt;\n            Senha:\n        &lt;/td&gt;\n        &lt;td&gt;\n            &lt;input name=\"Senha\" id=\"\" style=\"height:22px; width:102px\" type=\"password\" maxlength=\"10\" value=\"\" /&gt;\n        &lt;/td&gt;\n    &lt;/tr&gt;\n    &lt;tr&gt; \n        &lt;td colspan=\"2\"&gt;\n            &lt;input name=\"Submit\" id=\"\" type=\"button\" value=\"Submit\" onclick=\"javascript: alert(document.getElementsByName('Usuario')[0].value + ' - ' + document.getElementsByName('Senha')[0].value);\" /&gt;\n        &lt;/td&gt;\n    &lt;/tr&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>The output like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/SQxSl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SQxSl.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 12405486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9377de1c2346552f87754ba3f69be521?s=128&d=identicon&r=PG&f=1", "display_name": "borjaille", "link": "https://stackoverflow.com/users/12405486/borjaille"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1574315976, "creation_date": 1574270142, "last_edit_date": 1574288436, "question_id": 58959954, "link": "https://stackoverflow.com/questions/58959954/login-using-internet-explorer", "title": "Login using Internet Explorer", "body": "<p>I'm trying to use VBA to login on site at work, with this code that I found on web.</p>\n\n<pre><code>Sub LoginSite()\n Dim IE As Object\n Set IE = CreateObject(\"InternetExplorer.application\")\n With IE\n  .Visible = True\n  .Navigate (\"``m``y site\")\n While .Busy Or .ReadyState &amp;lt;&amp;gt; 4: DoEvents: Wend\n  .Document.getElementById(\"look the Login ID at site\").Focus\n  .Document.getElementById(\"look the Login ID at site \").Value = \"my user\"\n  .Document.getElementById(\"look the Password ID at site\").Focus\n  .Document.getElementById(\"look the Password ID at site\").Value = \"my password\"\n  .Document.All(\"Verificar qual ID do Bot\u00e3o \").Click\n While .Busy Or .ReadyState &amp;lt;&amp;gt; 4: DoEvents: Wend\nDebug.Print .LocationURL\nEnd With\nEnd Sub\n</code></pre>\n\n<p>But when I look at codes of the site, there isn't ID names for Login or Password. As posted at links bellow</p>\n\n<p><a href=\"https://pixeldrain.com/u/yyswM5j8\" rel=\"nofollow noreferrer\">https://pixeldrain.com/u/yyswM5j8</a></p>\n\n<p><a href=\"https://pixeldrain.com/u/oxNJ8_Pi\" rel=\"nofollow noreferrer\">https://pixeldrain.com/u/oxNJ8_Pi</a></p>\n\n<p><a href=\"https://pixeldrain.com/u/hfteWoWY\" rel=\"nofollow noreferrer\">https://pixeldrain.com/u/hfteWoWY</a></p>\n\n<p>LOGIN: <code>&lt;INPUT style=\"HEIGHT: 22px; WIDTH: 102px\" maxLength=11 name=Usuario&gt;</code></p>\n\n<p>PASSWORD: <code>&lt;INPUT style=\"HEIGHT: 22px; WIDTH: 102px\" maxLength=10 type=password value=\"\" name=Senha&gt;</code></p>\n\n<p>There is another way to fill the login and password without the ID name??</p>\n\n<p>Edit1: If I fill the username field or password field, results this</p>\n\n<p><a href=\"https://pixeldrain.com/u/dB-IB9gR\" rel=\"nofollow noreferrer\">https://pixeldrain.com/u/dB-IB9gR</a></p>\n"}, {"tags": ["vba", "pdf", "solidworks"], "owner": {"reputation": 31, "user_id": 12405366, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBeBRdVMVjlMYoxx8nBkNrY_MfmuFaVt7AwEnU2rg=k-s128", "display_name": "Jeremy Delorme", "link": "https://stackoverflow.com/users/12405366/jeremy-delorme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1574277674, "creation_date": 1574269430, "last_edit_date": 1574277674, "question_id": 58959735, "link": "https://stackoverflow.com/questions/58959735/combine-2-pdfs-in-one-using-vba", "title": "Combine 2 pdfs in one using VBA", "body": "<p>I'm currently working on a macro that creates a PDF from a SolidWorks file and then, if the Solidworks File is an assembly, it would merge the pdf with its BOM.</p>\n\n<p>The problem is that I've coded the merge part of the macro, but I keep getting a \"False\" result on the merge line of my code and I can't find why...</p>\n\n<p>Once it will be debugged, this will become a Function that will get 2 file paths to merge.</p>\n\n<p>Can you help me make the macro actually merge the two files? I can't find anything about why it can return a false results.</p>\n\n<p>So thank you for your help!</p>\n\n<p>Here's my actual code:</p>\n\n<pre><code>Sub CombinePDFs() '(ByVal NewAsmPdf As String, ByVal OldAsmPdf As String)\n\n' The function will combine the PDFs keeping the BOM of the older file merged (The one which is replaced)\n\nDim Adobe As AcroPDDoc\nDim PDF1    As Object\nDim PDF2    As Object\nDim PageNF  As Long\nDim PageOF  As Long\n\nDim b As Byte\nDim NewAsmPdf   As String\nDim OldAsmPdf   As String\n\nNewAsmPdf = \"Path.PDF\"\nOldAsmPdf = \"Path_BOM.PDF\"\n\n' Defines the two PDFs to be merged\nSet PDF1 = CreateObject(\"AcroExch.PDDoc\")\nPDF1.Open (NewAsmPdf)\nSet PDF2 = CreateObject(\"AcroExch.PDDoc\")\nPDF2.Open (OldAsmPdf)\n\n'Get the pages to be keep\nPageNF = PDF1.GetNumPages\nPageOF = PDF2.GetNumPages - PageNF\n\n'Insert PDF2 BOM in PDF1\nIf PDF1.InsertPages(PageNF, PDF2, PageNF + 1, PageOF, 0) Then 'Here is my problem : Keep having false (No merge)\nKill (OldAsmPdf)\nElse\nMsgBox (\"Could not merge the Old and New file\")\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p><strong>SOLVED!</strong></p>\n\n<p>I found out that VBA counts from 0 (So page 1 is actually the page 0) so the false was returned due to impossible values in attributes.</p>\n\n<p>Here's the code of the function that I've done:</p>\n\n<pre><code>Function CombinePDFs(ByVal NewAsmPdf As String, ByVal OldAsmPdf As String)\n\n\n' The function will combine the 2 PDFs and replace the OldFile by the NewFile\n\n    Dim PDF1    As Object\n    Dim PDF2    As Object\n\n    Dim PageNF  As Long\n    Dim PageOF  As Long\n\n    Dim NewAsmPdf   As String\n    Dim OldAsmPdf   As String\n\n    ' Defines the two PDFs to be merged\n    Set PDF1 = CreateObject(\"AcroExch.PDDoc\")\n    PDF1.Open (NewAsmPdf)\n    Set PDF2 = CreateObject(\"AcroExch.PDDoc\")\n    PDF2.Open (OldAsmPdf)\n\n    'Get the pages to be keep\n    PageNF = PDF1.GetNumPages\n    PageOF = PDF2.GetNumPages\n\n\n    ' Insert PDF2 BOM in PDF1\n    If PDF1.InsertPages(PageNF - 1, PDF2, PageNF, PageOF-1, 0)\n\n        If Not PDF1.Save(PDSaveFill, NewAsmPdf) Then\n            MsgBox (\"Not saved\")\n        End If\n\n        ' Delete \"_BOM.PDF\" file\n        PDF2.Close\n        Kill (OldAsmPdf)\n\n    Else\n        MsgBox (\"Could not merge the Old and New file\")\n    End If\n\n    ' Clear memory\n    Set PDF1 = Nothing\n    Set PDF2 = Nothing\n\n    End Function\n</code></pre>\n\n<p>Have fun!</p>\n"}, {"tags": ["excel", "vba", "pdf"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 3, "creation_date": 1574269279, "post_id": 58959608, "comment_id": 104174643, "body": "The issue is right in the middle of the <b>huge code dump</b> you provided. Sorry for my tone, but if you read about creating a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> you will get <i>much more help</i> in solving your issue. No one is going to want to go through this amount of code to fish out an issue for you. It would also be wise to point out you are using <code>pdfforge</code>"}, {"owner": {"reputation": 77029, "user_id": 1729265, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VMMeP.jpg?s=128&g=1", "display_name": "mkl", "link": "https://stackoverflow.com/users/1729265/mkl"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1574271711, "post_id": 58959608, "comment_id": 104175937, "body": "<i>&quot;but if you read about creating a minimal reproducible example you will get much more help in solving your issue&quot;</i> - Actually merely reading about it won&#39;t suffice, you&#39;ll have to <i>do</i> it ;). Nonetheless, @Scott is right of course, providing a wall of code is about as bad as providing no code at all."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 77029, "user_id": 1729265, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VMMeP.jpg?s=128&g=1", "display_name": "mkl", "link": "https://stackoverflow.com/users/1729265/mkl"}, "edited": false, "score": 0, "creation_date": 1574295984, "post_id": 58959608, "comment_id": 104185847, "body": "@mkl - well said :)"}, {"owner": {"reputation": 103, "user_id": 8343120, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/1b9b492522142acd923d64beee398bda?s=128&d=identicon&r=PG&f=1", "display_name": "Aur&#233;lien", "link": "https://stackoverflow.com/users/8343120/aur%c3%a9lien"}, "reply_to_user": {"reputation": 77029, "user_id": 1729265, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VMMeP.jpg?s=128&g=1", "display_name": "mkl", "link": "https://stackoverflow.com/users/1729265/mkl"}, "edited": false, "score": 0, "creation_date": 1574344753, "post_id": 58959608, "comment_id": 104206389, "body": "@mkl I modified"}], "owner": {"reputation": 103, "user_id": 8343120, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/1b9b492522142acd923d64beee398bda?s=128&d=identicon&r=PG&f=1", "display_name": "Aur&#233;lien", "link": "https://stackoverflow.com/users/8343120/aur%c3%a9lien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574344484, "creation_date": 1574269029, "last_edit_date": 1574344484, "question_id": 58959608, "link": "https://stackoverflow.com/questions/58959608/pdf-generated-and-merged-upside-down-with-pdfforge", "title": "PDF generated and merged upside down with pdfforge", "body": "<p>I use a code to generate pdf and to merge with others pdfs. But the pdfs I merge are upside down. The original pdfs are right side up. All codes and functions are here in the order of process.</p>\n\n<p>Code saving originals in a file and create one with all merged using pdfforge. </p>\n\n<p>Edit : I reduce my code here, first I get the different pdfs, second I launch functions to merge its.</p>\n\n<pre><code>\nrecuperer_PJ strChemin3, \"Ticket\", \"Ticket_FO_Documents\", \"(((Ticket.[Ticket_FO_Num\u00e9ro ticket])='\" &amp; Me![Ticket_FO_Num\u00e9ro ticket] &amp; \"'))\"\nrecuperer_PJ strChemin3, \"Ticket\", \"Ticket_FO_Justificatif_Delegation\", \"(((Ticket.[Ticket_FO_Num\u00e9ro ticket])='\" &amp; Me![Ticket_FO_Num\u00e9ro ticket] &amp; \"'))\"\nrecuperer_PJ strChemin3, \"Ticket\", \"[Ticket_FO_Pi\u00e8ces jointes]\", \"(((Ticket.[Ticket_FO_Num\u00e9ro ticket])='\" &amp; Me![Ticket_FO_Num\u00e9ro ticket] &amp; \"'))\"\nrecuperer_PJ strChemin3, \"Ticket\", \"Ticket_MO_Documents\", \"(((Ticket.[Ticket_FO_Num\u00e9ro ticket])='\" &amp; Me![Ticket_FO_Num\u00e9ro ticket] &amp; \"'))\"\nrecuperer_PJ strChemin3, \"Ticket\", \"Ticket_BO_Documents\", \"(((Ticket.[Ticket_FO_Num\u00e9ro ticket])='\" &amp; Me![Ticket_FO_Num\u00e9ro ticket] &amp; \"'))\"\nrecuperer_PJ strChemin3, \"Ticket\", \"Ordre_Justificatif_Validation\", \"(((Ticket.[Ticket_FO_Num\u00e9ro ticket])='\" &amp; Me![Ticket_FO_Num\u00e9ro ticket] &amp; \"'))\"\nrecuperer_PJ strChemin3, \"Ticket\", \"Ticket_BO_Documents_Conformit\u00e9\", \"(((Ticket.[Ticket_FO_Num\u00e9ro ticket])='\" &amp; Me![Ticket_FO_Num\u00e9ro ticket] &amp; \"'))\"\n'Fusion des PJ\nPilotageMacro1 strChemin3, strChemin2 &amp; \"\\\" &amp; Me![Ticket_FO_Num\u00e9ro ticket] &amp; \" - \" &amp; Me!Titre &amp; \".pdf\"\n\nFileMove strChemin2 &amp; \"\\\" &amp; Me![Ticket_FO_Num\u00e9ro ticket] &amp; \" - \" &amp; Me!Titre &amp; \".pdf\", strChemin3 &amp; \"\\\" &amp; Me![Ticket_FO_Num\u00e9ro ticket] &amp; \" - \" &amp; Me!Titre &amp; \" initial complet.pdf\"\n\n</code></pre>\n\n<p>function to save and launch the \"mergage\"</p>\n\n<pre><code>Public Sub recuperer_PJ(ByVal strNomDestination As String, ByVal strTable As String, ByVal strChamp As String, ByVal strWhere As String)\n  Dim rst1 As DAO.Recordset\n  Dim rst2 As DAO.Recordset\n  Dim strSQL As String\n\n  ' Se positionner sur l'enregistrement souhait\u00e9\n  strSQL = \"SELECT * FROM \" &amp; strTable &amp; \" WHERE\" &amp; strWhere &amp; \";\"\n  Set rst1 = CurrentDb.OpenRecordset(strSQL, dbOpenSnapshot)\n\n  ' Obtenir le \"sous-recordset\" des pi\u00e8ces jointes\n  Set rst2 = rst1(strChamp).Value\n\n  ' Lister les pi\u00e8ces jointes\n  While Not rst2.EOF\n  test = 0\n  dossier = strNomDestination &amp; \"\\\"\n  Do While Not test = 1\n  txt = Dir(dossier &amp; rst2.Fields(\"FileName\"))\n  If txt = \"\" Then\n  test = 1\n  Else\n  dossier = dossier &amp; \"_\"\n  End If\n  Loop\n  dossier = dossier &amp; rst2.Fields(\"FileName\")\n  rst2.Fields(0).SaveToFile dossier\n  rst2.MoveNext\n  Wend\n\n  ' On ferme les 2 Recordsets\n  rst2.Close\n  Set rst2 = Nothing\n  rst1.Close\n  Set rst1 = Nothing\nEnd Sub\n</code></pre>\n\n<p>functions to merge</p>\n\n<pre><code>Public Sub PilotageMacro1(ByVal dossierFusion As String, ByVal dossierSortie As String)\n    Dim Xl As Excel.Application\n    Dim wbk As Excel.Workbook\n\n    ' D\u00e9marrer Excel et le rendre visible\n    Set Xl = New Excel.Application\n    Xl.Visible = False\n\n\n    ' Ouvrir le classeur qui contient les macros\nSet db = CurrentDb\nSet rs = db.OpenRecordset(\"SELECT [Lien PDF] FROM Param\u00eatres\")\nLien_PDF = rs.Fields(0)\nSet wbk = Xl.Workbooks.Open(Lien_PDF &amp; \".xlsm\")\n    'Set wbk = xl.Workbooks.Open(Lien_Dossier_Tickets &amp; \"\\A_ne_pas_supprimer_G2T.xlsm\")\n\n    ' Ex\u00e9cuter une macro\n    Xl.Run \"SelDossierFusion\", dossierFusion, dossierSortie\n\n    ' Fermer le classeur sans l'enregistrer\n    wbk.Close False\n    Set wbk = Nothing\n\n    ' Quitter Excel\n    Xl.Quit\n    Set Xl = Nothing\nEnd Sub\n</code></pre>\n\n<pre><code>Option Explicit\n\nDim Cpt As Long\nDim Tableau() As Variant\nConst TypeFichier As String = \"*.pdf\"\n\nPrivate Sub Fusion(ByVal dossierSortie As String)\nDim Pdf As Object\n    Set Pdf = CreateObject(\"pdfforge.pdf.pdf\")\n    Pdf.MergePDFFiles_2 Tableau, dossierSortie, True\n    Set Pdf = Nothing\nEnd Sub\n\nPrivate Sub ListeFichiers(ByVal sChemin As String, ByVal Recursif As Boolean)\nDim FSO As Object\nDim Dossier As Object\nDim SousDossier As Object\nDim Fichier As Object\n\n    Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set Dossier = FSO.GetFolder(sChemin)\n\n    For Each Fichier In Dossier.Files\n        If UCase(Fichier.Name) Like UCase(TypeFichier) Then\n            ReDim Preserve Tableau(Cpt)\n            Tableau(Cpt) = Fichier.Path\n            Cpt = Cpt + 1\n            Application.StatusBar = Cpt\n        End If\n    Next Fichier\n\n    If Recursif Then\n        For Each SousDossier In Dossier.SubFolders\n            ListeFichiers SousDossier.Path, True\n        Next SousDossier\n    End If\n\n    Set Dossier = Nothing\n    Set FSO = Nothing\nEnd Sub\n\nSub SelDossierFusion(ByVal dossierFusion As String, ByVal dossierSortie As String)\nDim sChemin As String\nDim FSO As Object\nDim Dossier As Object\nsChemin = dossierFusion\n\n    Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set Dossier = FSO.GetFolder(sChemin)\n\n           '    ListeFichiers r\u00e9cursive ou non True/False\n            ListeFichiers Dossier, True\n            Fusion (dossierSortie)\n\n    Set FSO = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops", "syntax", "concatenation"], "comments": [{"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 1, "creation_date": 1574268686, "post_id": 58959489, "comment_id": 104174306, "body": "it seems a cuestion of double quotes. try with   <code>ActiveChart.FullSeriesCollection(i).Name = &quot;=&quot;&quot;&quot; &amp; i &amp; &quot;&quot;&quot;&quot;</code>"}, {"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 2, "creation_date": 1574269173, "post_id": 58959489, "comment_id": 104174595, "body": "Have you tried <code>ActiveChart.FullSeriesCollection(i).Name = i</code>?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1574269441, "post_id": 58959489, "comment_id": 104174731, "body": "Does the <code>=</code> need to be part of the name? Looks pretty awkward, are you sure you don&#39;t want just <code>i</code> to be the name (see above comment)?"}, {"owner": {"reputation": 1, "user_id": 12404771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81d183e15b34242d9692fc27f8c3adcf?s=128&d=identicon&r=PG&f=1", "display_name": "Brian W", "link": "https://stackoverflow.com/users/12404771/brian-w"}, "edited": false, "score": 0, "creation_date": 1574275157, "post_id": 58959489, "comment_id": 104177684, "body": "Yes, I have tried Dean&#39;s suggestion, which did not work.  Luis&#39; actually worked!  but I&#39;m new to stack overflow, so I&#39;m not seeing where I can mark my question answered (maybe I need more time on the system)."}], "answers": [{"tags": [], "owner": {"reputation": 3795, "user_id": 6672923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff4bdb9435397969c9b7d3acbdc1583?s=128&d=identicon&r=PG&f=1", "display_name": "zip", "link": "https://stackoverflow.com/users/6672923/zip"}, "is_accepted": false, "score": 0, "last_activity_date": 1574282338, "creation_date": 1574282338, "answer_id": 58963004, "question_id": 58959489, "link": "https://stackoverflow.com/questions/58959489/excel-vba-loop-syntax/58963004#58963004", "title": "Excel VBA Loop Syntax", "body": "<p>Just replace <code>ActiveChart.FullSeriesCollection(i).Name = \"=\" &amp; i &amp; \"\"</code></p>\n\n<p>with <code>ActiveChart.FullSeriesCollection(i).Name = Trim(i &amp; \" \")</code> and it will just work fine.</p>\n\n<p>Hope it helps</p>\n"}], "owner": {"reputation": 1, "user_id": 12404771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81d183e15b34242d9692fc27f8c3adcf?s=128&d=identicon&r=PG&f=1", "display_name": "Brian W", "link": "https://stackoverflow.com/users/12404771/brian-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1574282338, "creation_date": 1574268571, "question_id": 58959489, "link": "https://stackoverflow.com/questions/58959489/excel-vba-loop-syntax", "title": "Excel VBA Loop Syntax", "body": "<p>Similar to an earlier question I had, which was easily resolvable with concatenate, I'm trying to do the same for naming a large number of chart series, but not having luck this time.<br>\nI commented the line that the macro recorder captured, and have my current (non-working) attempt at concatenation.<br>\nBasically I want each series name to be it's number.</p>\n\n<pre><code>Sub Macro6()\n'\n' Macro6 Macro\n'\n' Keyboard Shortcut: Ctrl+x\n'\nDim i As Integer\n\nFor i = 92 To 250\n\n    ActiveChart.FullSeriesCollection(i).Name = \"=\" &amp; i &amp; \"\"\n\n'   ActiveChart.FullSeriesCollection(92).Name = \"=\"\"92\"\"\"\n\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "enumerate"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1574269678, "post_id": 58959484, "comment_id": 104174852, "body": "Start by using <code>Option Explicit</code> and declaring all your variables."}, {"owner": {"reputation": 1, "user_id": 12405209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a2867052cb6b10c07ea84a77e4a65e0?s=128&d=identicon&r=PG&f=1", "display_name": "madbilly", "link": "https://stackoverflow.com/users/12405209/madbilly"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1574344731, "post_id": 58959484, "comment_id": 104206381, "body": "Hi @cybernetic.nomad thanks for that tip, but that&#39;s not really what I was hoping for help with (although it is useful for my learning, so I appreciate it). I was hoping that someone could show me how to write my pseudo-code in VBA :)"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1574349996, "post_id": 58959484, "comment_id": 104209779, "body": "Showing you how to write code in VBA is too broad a topic for this site. There are plenty of online tutorials and you can use those. If you hit a specific roadblock then is the time to come back here and ask a question to find out how to solve that specific problem"}, {"owner": {"reputation": 1, "user_id": 12405209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a2867052cb6b10c07ea84a77e4a65e0?s=128&d=identicon&r=PG&f=1", "display_name": "madbilly", "link": "https://stackoverflow.com/users/12405209/madbilly"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1574357280, "post_id": 58959484, "comment_id": 104214008, "body": "Okay, that&#39;s one way to look at it. Apart from that, is my pseudo-code going to work if I get the syntax right?"}], "owner": {"reputation": 1, "user_id": 12405209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a2867052cb6b10c07ea84a77e4a65e0?s=128&d=identicon&r=PG&f=1", "display_name": "madbilly", "link": "https://stackoverflow.com/users/12405209/madbilly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574268553, "creation_date": 1574268553, "question_id": 58959484, "link": "https://stackoverflow.com/questions/58959484/fills-three-excel-columns-based-on-numbers-in-another-sheet", "title": "Fills three Excel columns based on numbers in another sheet", "body": "<p>I think I know what I want to write, but unfortunately VBA syntax etc always confuses me... I guess I just don't get enough practice.</p>\n\n<p>I want to fill three columns in Excel based on the values in another sheet. The two columns are Room and Module. There are several different values for Room and several different values for module. Each Room can contain 0 or more of each type of Module. I want to fill two columns (A and B) based on the number of times each Module appears in each room. I would like to fill column C with a sequential number for each type of module.</p>\n\n<p>E.g. this is the source data:</p>\n\n<pre><code>            Room 1  Room 2\nModule A    2       4\nModule B    8       3\n</code></pre>\n\n<p>And this is the desired end result:</p>\n\n<pre><code>Room    Module  \n        Type        No.\nRoom 1  Module A    1\nRoom 1  Module A    2\nRoom 1  Module B    1\nRoom 1  Module B    2\nRoom 1  Module B    3\nRoom 1  Module B    4\nRoom 1  Module B    5\nRoom 1  Module B    6\nRoom 1  Module B    7\nRoom 1  Module B    8\nRoom 2  Module A    3\nRoom 2  Module A    4\nRoom 2  Module A    5\nRoom 2  Module A    6\nRoom 2  Module B    9\nRoom 2  Module B    10\nRoom 2  Module B    11\n</code></pre>\n\n<p>I think that what I want to write is something like:</p>\n\n<pre><code>For each R in Range(B:1 to C:1)\nFor each M in Range(A:2 to A:3)\nM = 0\nFor each C in Value(R:M)\nX = (R*M)+C\nM = 0+1\nCell A:X = Value(Cell(R))\nCell B:X = Value(Cell(M))\nCell C:X = M\nNext C\nNext M\nNext R\n</code></pre>\n\n<p>I'm sure this contains errors but I hope I've explained and shown what I'm trying to do.</p>\n\n<p>All constructive help and feedback welcome.\nCheers :)</p>\n"}, {"tags": ["vba", "object", "copy", "copy-paste", "paste"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1574268739, "post_id": 58959241, "comment_id": 104174332, "body": "Which specific line is raising this error? I&#39;ve never seen an error message that says &quot;object rejected&quot;. Are you sure that wasn&#39;t &quot;Object required&quot;?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1574268769, "post_id": 58959241, "comment_id": 104174351, "body": "Also <code>SingleCell.Select</code> is redundant, remove it"}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1574269131, "creation_date": 1574269131, "answer_id": 58959639, "question_id": 58959241, "link": "https://stackoverflow.com/questions/58959241/vba-object-rejected/58959639#58959639", "title": "VBA - Object rejected", "body": "<pre><code>SingleCell.Value.Copy\n</code></pre>\n\n<p><code>Range.Value</code> is a <em>value</em>, not an object: values don't have members that can be invoked - this instruction is illegal and raises an <strong>object required</strong> error, because, well, an object would be required in order for that <code>.Copy</code> member call to be made.</p>\n\n<p>You want to invoke <code>Range.Copy</code>, so do <code>SingleCell.Copy</code>.</p>\n\n<p>If you mean to just copy the value and not the formatting, borders, conditional formats and whatnot, then don't involve the clipboard and just write to the cells:</p>\n\n<pre><code>Dim targetSheet As Worksheet\nSet targetSheet = Worksheets(\"Sheet1\")\n\ntargetSheet.Range(\"A1\").End(xlToRight).Offset(0, 1).Value = SingleCell.Value\ntargetSheet.Range(\"A2\").End(xlToRight).Offset(0, 1).Value = SingleCell.Offset(-155, 0).Value\ntargetSheet.Range(\"A3\").End(xlToRight).Offset(0, 1).Value = SingleCell.Offset(-154, 0).Value\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12405278, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YbQ9iR_mQB0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reeTHNCCJs-ha9bUxdByGl1lPIYLA/photo.jpg?sz=128", "display_name": "user12405278", "link": "https://stackoverflow.com/users/12405278/user12405278"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574269131, "creation_date": 1574267759, "last_edit_date": 1574267777, "question_id": 58959241, "link": "https://stackoverflow.com/questions/58959241/vba-object-rejected", "title": "VBA - Object rejected", "body": "<p>I am a new learner of VBA programming. It is really so tough to figure out the error. For the following code, there is always a message of </p>\n\n<blockquote>\n  <p>'object rejected'</p>\n</blockquote>\n\n<p>May I understand why it is happening ToT </p>\n\n<p>Thank you so much!!! </p>\n\n<pre><code>Sub SelectAndCopyCellsWithValue()\n\n    Dim SingleCell As Range\n\n    Dim area As Range\n    Set area = ActiveSheet.Range(\"C158\", \"ED158\")\n\n    For Each SingleCell In area\n        If SingleCell &lt;&gt; 0 Then\n            SingleCell.Select\n            SingleCell.Value.Copy Worksheets(\"Sheet1\").Range(\"A1\").End(xlToRight).Offset(0, 1)\n            SingleCell.Offset(-155, 0).Value.Copy Worksheets(\"Sheet1\").Range(\"A2\").End(xlToRight).Offset(0, 1)\n            SingleCell.Offset(-154, 0).Value.Copy Worksheets(\"Sheet1\").Range(\"A3\").End(xlToRight).Offset(0, 1)\n\n        End If\n    Next SingleCell\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["javascript", "python", "vba", "zip"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1574267667, "post_id": 58959132, "comment_id": 104173696, "body": "Your best bet is to use Visual Studio as it&#39;s built in and you can schedule it on a timer to run at night."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12405254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b84b4109804ff9ef61e71e348681ce5?s=128&d=identicon&r=PG&f=1", "display_name": "NiharikaP", "link": "https://stackoverflow.com/users/12405254/niharikap"}, "edited": false, "score": 0, "creation_date": 1581525998, "post_id": 58959247, "comment_id": 106466595, "body": "can you elaborate on what my_directories_to_zip = [&#39;complete/path/dir1&#39;, &#39;complete/path/dir2&#39;, &#39;complete/path/dir3&#39;] destination = &#39;result.zip&#39; means? sorry this is my first time!"}, {"owner": {"reputation": 4530, "user_id": 2973474, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100004343619888/picture?type=large", "display_name": "alexisdevarennes", "link": "https://stackoverflow.com/users/2973474/alexisdevarennes"}, "reply_to_user": {"reputation": 1, "user_id": 12405254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b84b4109804ff9ef61e71e348681ce5?s=128&d=identicon&r=PG&f=1", "display_name": "NiharikaP", "link": "https://stackoverflow.com/users/12405254/niharikap"}, "edited": false, "score": 0, "creation_date": 1581526177, "post_id": 58959247, "comment_id": 106466706, "body": "No problem; my_directories_to_zip is a list of paths that you wish to add to the zip. It&#39;s a list as you might want to zip multiple paths. destination is simply the path that you wish to save the results to. These two variables are passed to the method zipit which then iterates over the paths in my_directories_to_zip and uses destination to output the result. Feel free to start a chat if you have more questions."}], "tags": [], "owner": {"reputation": 4530, "user_id": 2973474, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100004343619888/picture?type=large", "display_name": "alexisdevarennes", "link": "https://stackoverflow.com/users/2973474/alexisdevarennes"}, "is_accepted": false, "score": 0, "last_activity_date": 1574267781, "creation_date": 1574267781, "answer_id": 58959247, "question_id": 58959132, "link": "https://stackoverflow.com/questions/58959132/how-to-automate-zipping-files-on-a-network/58959247#58959247", "title": "How to Automate Zipping Files on a Network", "body": "<p>You could use python:</p>\n\n<pre><code>import os\nimport zipfile\n\ndef zipdir(path, ziph):\n    # ziph is zipfile handle\n    for root, dirs, files in os.walk(path):\n        for file in files:\n            ziph.write(os.path.join(root, file),\n                       os.path.relpath(os.path.join(root, file),\n                                       os.path.join(path, '..')))\n\n\ndef zipit(dir_list, zip_name):\n    zipf = zipfile.ZipFile(zip_name, 'w', zipfile.ZIP_DEFLATED)\n    for dir in dir_list:\n        zipdir(dir, zipf)\n    zipf.close()\n\nmy_directories_to_zip = ['complete/path/dir1', 'complete/path/dir2', 'complete/path/dir3']\ndestination = 'result.zip'\n\nzipit(my_directories_to_zip, destination)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12405254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b84b4109804ff9ef61e71e348681ce5?s=128&d=identicon&r=PG&f=1", "display_name": "NiharikaP", "link": "https://stackoverflow.com/users/12405254/niharikap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574267781, "creation_date": 1574267459, "last_edit_date": 1574267614, "question_id": 58959132, "link": "https://stackoverflow.com/questions/58959132/how-to-automate-zipping-files-on-a-network", "title": "How to Automate Zipping Files on a Network", "body": "<p>I have been trying to write a script to automate zipping folders on a drive. I want to be able to zip 3 folders at a time and then rename the zipped file (on the drive). This takes my computer way too long so I want to write a script that will automatically do this for me at night when I am not when I am not working.</p>\n\n<p>Is this possible? Should I use Java/ Python or VBA for this? Do you recommend any other programming language? Any help will be greatly appreciated - thank you! </p>\n"}, {"tags": ["excel", "vba", "if-statement", "emulation", "bluezone"], "comments": [{"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1574269735, "post_id": 58958879, "comment_id": 104174882, "body": "Please try a variation of  bzhao.SetCursor 6, 53     bzhao.SendKey &quot;qwrety@E&quot;     bzhao.WaitReady 10, 1"}, {"owner": {"reputation": 93, "user_id": 10129598, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eIVSw.png?s=128&g=1", "display_name": "AKow", "link": "https://stackoverflow.com/users/10129598/akow"}, "reply_to_user": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1574271502, "post_id": 58958879, "comment_id": 104175834, "body": "Hi Don, I&#39;ve tried the SetCursor and talke d to the BlueZone helpdesk. It is not a supported command in VT."}, {"owner": {"reputation": 93, "user_id": 10129598, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eIVSw.png?s=128&g=1", "display_name": "AKow", "link": "https://stackoverflow.com/users/10129598/akow"}, "reply_to_user": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1574273196, "post_id": 58958879, "comment_id": 104176713, "body": "@donPablo ^above"}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1574287822, "post_id": 58958879, "comment_id": 104183395, "body": "There&#39;s no Wait statement between the 5th and 6th tabs when res_check &gt; 0. There is a Wait statement between the 5th and 6th tabs when res_check is not &gt; 0. Which behaviour is correct?"}, {"owner": {"reputation": 93, "user_id": 10129598, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eIVSw.png?s=128&g=1", "display_name": "AKow", "link": "https://stackoverflow.com/users/10129598/akow"}, "reply_to_user": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1574294112, "post_id": 58958879, "comment_id": 104185404, "body": "@barrowc The wait times are set very generously to monitor the macro while running. It is just pausing for 1 second (or whatever setting). I believe that has no impact on the problem."}, {"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1574310012, "post_id": 58958879, "comment_id": 104189131, "body": "After the &quot;ActiveSheet.Paste&quot;  and before the  &quot;If res_check &gt; 0&quot;  you need to move ActiveSheet.Cells(7, &quot;P&quot;)  into res_check.  Otherwise the program is looking at the value from the first location."}, {"owner": {"reputation": 93, "user_id": 10129598, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eIVSw.png?s=128&g=1", "display_name": "AKow", "link": "https://stackoverflow.com/users/10129598/akow"}, "reply_to_user": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1574362928, "post_id": 58958879, "comment_id": 104216647, "body": "@donpablo Tried it - the code wont run at all like that."}, {"owner": {"reputation": 93, "user_id": 10129598, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eIVSw.png?s=128&g=1", "display_name": "AKow", "link": "https://stackoverflow.com/users/10129598/akow"}, "reply_to_user": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1574362954, "post_id": 58958879, "comment_id": 104216658, "body": "@donpablo what do you mean by (7,&quot;P&quot;)?"}, {"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1574389209, "post_id": 58958879, "comment_id": 104225257, "body": "Row 7, Column P   which is where the Reserve Position code value is shown after the screen Paste into J1.  Alternatively, it could be similar to the first time, but now P7 instead of D3 as ----------&gt; res_check = ActiveSheet.Range(&quot;P7&quot;).Value"}, {"owner": {"reputation": 93, "user_id": 10129598, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eIVSw.png?s=128&g=1", "display_name": "AKow", "link": "https://stackoverflow.com/users/10129598/akow"}, "reply_to_user": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1574391171, "post_id": 58958879, "comment_id": 104225658, "body": "@donpablo Ah - the value is actually in cell D3 pulled out by a mid() formula. All of the values from the screen print are in column D."}, {"owner": {"reputation": 93, "user_id": 10129598, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eIVSw.png?s=128&g=1", "display_name": "AKow", "link": "https://stackoverflow.com/users/10129598/akow"}, "reply_to_user": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1574391221, "post_id": 58958879, "comment_id": 104225669, "body": "@donpablo Column P is blank."}, {"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1574395312, "post_id": 58958879, "comment_id": 104226561, "body": "Right, res_check is in D3.  BUT, how does it get from the   bzhao.Copy 32 // Range(&quot;J1&quot;).Select // ActiveSheet.Paste // finally into D3??  I agree with you... that  &quot; the variable doesn&#39;t update with the loop.&quot;  And further say is needs to be moved from P7 into res_check.  The screen has an orange highlight on P7 that shows a value of &quot;1&quot; for 241054.  What does that look like for 241051?"}, {"owner": {"reputation": 93, "user_id": 10129598, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eIVSw.png?s=128&g=1", "display_name": "AKow", "link": "https://stackoverflow.com/users/10129598/akow"}, "reply_to_user": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1574511918, "post_id": 58958879, "comment_id": 104263720, "body": "@donpablo Res_check updates on the screen no problem with each iteration. The screenshot is pasted into J1. Columns J1:J24 contain the pasted information.   Cell D3 is mid(J8, 63,1) which returns 1 on the screenshot. The paste is a funky text + spaces mess. I have also tried running the mid() statement in the loop instead of declaring it; that doesnt work either."}, {"owner": {"reputation": 93, "user_id": 10129598, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eIVSw.png?s=128&g=1", "display_name": "AKow", "link": "https://stackoverflow.com/users/10129598/akow"}, "reply_to_user": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1574512144, "post_id": 58958879, "comment_id": 104263764, "body": "@donpablo the orange is just a visual check. 241051 returns 0 into D3."}, {"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1574556222, "post_id": 58958879, "comment_id": 104274799, "body": "Going by what I see on the lower half of the paste above, I would think that Position/Reserve is cell D3 which should be mid(J7, 63, 1)  [whereas mid(J8, 63, 1) would give us Height/Reserve, instead of what we want as Position] .   Take a look at the prior characters  mid (J7, 1, 10)  vs.  mid (J8, 1,10)"}, {"owner": {"reputation": 93, "user_id": 10129598, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eIVSw.png?s=128&g=1", "display_name": "AKow", "link": "https://stackoverflow.com/users/10129598/akow"}, "reply_to_user": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1574644365, "post_id": 58958879, "comment_id": 104293023, "body": "@donpablo mid(J7, 63, 1) is the fx returning the desired Position value. The problem continues to be the Else condition runs in both cases."}, {"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1574654529, "post_id": 58958879, "comment_id": 104294881, "body": "Since this is VBA, put a breakpoint on the IF and examine the values and then F8 to single step the code.  Examine mid(J8, 63, 1) and examine res_check -- to bracket the problem.  If the values are not the same, then a move needs to be added before the IF.  Based on the value you see, use F8 to step the program and determine if the proper clause is being executed.  (crazy thought --&gt; indent the code between the else and the endif )"}, {"owner": {"reputation": 93, "user_id": 10129598, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eIVSw.png?s=128&g=1", "display_name": "AKow", "link": "https://stackoverflow.com/users/10129598/akow"}, "reply_to_user": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1574701862, "post_id": 58958879, "comment_id": 104316685, "body": "@donpablo I did your indent and added the cell value directly to the If Then statement versus using a variable. It works! Thanks for keeping up on this one with me!"}], "answers": [{"tags": [], "owner": {"reputation": 93, "user_id": 10129598, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eIVSw.png?s=128&g=1", "display_name": "AKow", "link": "https://stackoverflow.com/users/10129598/akow"}, "is_accepted": false, "score": 0, "last_activity_date": 1574701796, "creation_date": 1574701796, "answer_id": 59036887, "question_id": 58958879, "link": "https://stackoverflow.com/questions/58958879/vba-if-statement-within-for-each-for-emulation/59036887#59036887", "title": "VBA If Statement within For Each for Emulation", "body": "<p>The below code works. </p>\n\n<p>Cell D3 =mid(J7, 63, 1) and cell D8 =D3*1</p>\n\n<p>I also did @donpablo's suggested indent (see comments).</p>\n\n<pre><code>Sub FiXCoord_Loop()\n\n'Must start at IMLOA screen\n\nDim bzhao As Object\nSet bzhao = CreateObject(\"BZWhll.WhllObj\")\nbzhao.Connect \"\"\n\nDim myX As Integer\nDim res_check As Integer\nDim myLoc As Variant\n\n\n\nmyRange = ActiveSheet.Range(\"A2:A1000\")\nmyX = ActiveSheet.Range(\"E1\").Value\nres_check = ActiveSheet.Range(\"D8\").Value\n\nFor Each myLoc In myRange\n\n\n'end loop at blank cell\n    If myLoc = \"\" Then\n        Exit For\n            End If\n\n'Query location\n\nbzhao.SendKey \"Q\"\nbzhao.Wait 0.2\nbzhao.SendKey myLoc\nbzhao.Wait 0.2\nbzhao.SendKey \"&lt;enter&gt;\"\nbzhao.Wait 0.2\n\n'Copy screen to get res#\n\nbzhao.Wait 1\nbzhao.Copy 32\nbzhao.Wait 1\n\n'Paste info to sheet for res_check\n\nRange(\"J1\").Select\nActiveSheet.Paste\n\n'Modify data\n\nbzhao.SendKey \"M\"\nbzhao.Wait 0.2\nbzhao.SendKey \"&lt;tab&gt;&lt;tab&gt;&lt;tab&gt;&lt;tab&gt;&lt;tab&gt;\" 'tab to Res\n\n\n'Decide 6 or 7 tabs\n\nIf ActiveSheet.Range(\"D8\").Value &gt; 0 Then\n\n    bzhao.Wait 0.1\n    bzhao.SendKey \"&lt;tab&gt;\"\n\nElse\n\n    End If\n\nbzhao.Wait 0.1\nbzhao.SendKey \"&lt;tab&gt;\"\nbzhao.Wait 0.1\nbzhao.SendKey myX\nbzhao.Wait 0.1\nbzhao.SendKey \"&lt;enter&gt;\"\nbzhao.Wait 0.1\nbzhao.SendKey \"E\"\nbzhao.Wait 0.5\n\n\nNext myLoc\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 10129598, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eIVSw.png?s=128&g=1", "display_name": "AKow", "link": "https://stackoverflow.com/users/10129598/akow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 243, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575116673, "creation_date": 1574266602, "last_edit_date": 1575116673, "question_id": 58958879, "link": "https://stackoverflow.com/questions/58958879/vba-if-statement-within-for-each-for-emulation", "title": "VBA If Statement within For Each for Emulation", "body": "<p>I need to update several thousand X coordinates in BlueZone. I'm using VBA to enter key commands in BlueZone VT. Unfortunately, there is no \"set cursor position\" command, so I am limited to using \"tabs\" to put the cursor where it needs to go.</p>\n\n<p>At the coordinate updating screen there are two possibilities: 6 or 7 tabs depending on the presence of a 0 or not on the screen. </p>\n\n<p>For example: location 241054 has a 1 and needs 7 tabs, location 241051 has a 0 and needs 6 tabs to get to the X location field for me to dump in my variable.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Sub FiXCoord_Loop()\n\n'Must start at IMLOA screen\n\nDim bzhao As Object\nSet bzhao = CreateObject(\"BZWhll.WhllObj\")\nbzhao.Connect \"\"\n\nDim myX As Integer\nDim res_check As Integer\nDim myLoc As Variant\n'Dim res_check As Variant\n\n\nmyRange = ActiveSheet.Range(\"A2:A1000\")\n'myResRange = ActiveSheet.Range(\"D3\")\nmyX = ActiveSheet.Range(\"E1\").Value\nres_check = ActiveSheet.Range(\"D3\").Value\n\nFor Each myLoc In myRange\n\n\n'end loop at blank cell\n    If myLoc = \"\" Then\n        Exit For\n            End If\n\n'Query location\n\nbzhao.SendKey \"Q\"\nbzhao.Wait 0.2\nbzhao.SendKey myLoc\nbzhao.Wait 0.2\nbzhao.SendKey \"&lt;enter&gt;\"\nbzhao.Wait 0.2\n\n'Copy screen to get res#\n\nbzhao.Wait 1\nbzhao.Copy 32\nbzhao.Wait 1\n\n'Paste info to sheet for res_check\n\nRange(\"J1\").Select\nActiveSheet.Paste\n\n\nbzhao.SendKey \"M\"\nbzhao.Wait 0.2\nbzhao.SendKey \"&lt;tab&gt;\"\nbzhao.Wait 0.2\nbzhao.SendKey \"&lt;tab&gt;\"\nbzhao.Wait 0.2\nbzhao.SendKey \"&lt;tab&gt;\"\nbzhao.Wait 0.2\nbzhao.SendKey \"&lt;tab&gt;\"\nbzhao.Wait 0.2\nbzhao.SendKey \"&lt;tab&gt;\"\n\n\n\n'if value &gt; 0 extra tab\n\nIf res_check &gt; 0 Then\n\n    bzhao.SendKey \"&lt;tab&gt;\"\n    bzhao.Wait 1\n    bzhao.SendKey \"&lt;tab&gt;\"\n    bzhao.Wait 1\n    bzhao.SendKey myX\n    bzhao.Wait 0.2\n    bzhao.SendKey \"&lt;enter&gt;\"\n    bzhao.Wait 0.2\n    bzhao.SendKey \"E\"\n    bzhao.Wait 0.5\n\nElse\n\nbzhao.Wait 0.2\nbzhao.SendKey \"&lt;tab&gt;\"\nbzhao.Wait 1\nbzhao.SendKey myX\nbzhao.Wait 0.2\nbzhao.SendKey \"&lt;enter&gt;\"\nbzhao.Wait 0.2\nbzhao.SendKey \"E\"\nbzhao.Wait 0.5\n\nEnd If\n\n\nNext myLoc\n\n\nEnd Sub\n</code></pre>\n\n<p>As I'm limited to walking the screen by key commands, I am copying the screen and pasting it onto my sheet to check for the 0 or not. I cannot get the if - then statement to work, though. </p>\n\n<p>The code just keeps running with 6 tabs which tells me that either the res_check value (which is a mid() statement to pull the value off the screen) is not being recognized, or the the variable doesn't update with the loop. If I run the res_check > 0 location first, though, it still does 6 tabs so I can eliminate that possibility.</p>\n\n<p>As a further check I ran a TRUE FALSE check on the res_check value and it passed when dimmed as an integer. On the sheet, though, ISNUMBER() fails.</p>\n\n<p>TLDR: If Then will not produce desired result - code keeps defaulting to the Else condition.\n<a href=\"https://i.stack.imgur.com/oiBRf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oiBRf.png\" alt=\"enter image description here\"></a><a href=\"https://i.stack.imgur.com/Rg0w6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Rg0w6.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "vlookup"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1574267243, "post_id": 58958514, "comment_id": 104173453, "body": "Perhaps use <code>MATCH()</code> instead?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1574268296, "post_id": 58958514, "comment_id": 104174079, "body": "You can&#39;t get a row number from <code>VLOOKUP</code> because that function returns a value, not a <code>Range</code>. If you need a row number, use a function that returns a row number - like <code>MATCH</code>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1574268600, "post_id": 58958514, "comment_id": 104174246, "body": "Also make sure your module says <code>Option Explicit</code> at the very top - you don&#39;t want to be using undeclared variables, accidentally or not. e.g. <code>Find &amp; Edit</code> probably means to be enclosed in double quotes as a string literal; as it stands, it&#39;s understood as the concatenation of two undeclared <code>Variant&#47;Empty</code> values, and your inputbox title is an empty string."}], "owner": {"reputation": 1, "user_id": 12405083, "user_type": "registered", "profile_image": "https://graph.facebook.com/2553167854732729/picture?type=large", "display_name": "Christopher P. Bryan", "link": "https://stackoverflow.com/users/12405083/christopher-p-bryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574268496, "creation_date": 1574265423, "last_edit_date": 1574268496, "question_id": 58958514, "link": "https://stackoverflow.com/questions/58958514/vba-finding-row-value-from-vlookup-function", "title": "VBA Finding row value from Vlookup function", "body": "<p>Im trying to get the row number back after matching the user input via Vlook up this is meant to be used in the process of pulling items into a custom userform for editing. How should i return this Row number.\nHere is my code for this.</p>\n\n<pre><code>Sub Sheet1_Button2_Click()\nDim Vall As String\n\nVall = InputBox(\"Enter Refernce #\", Find &amp; Edit)\nVall2 = Application.VLookup(Vall, 11, K1)\nMsgBox \"found\" &amp; Application.Row(Vall2)\nVall3 = Vall2.Rows\n\nUserForm1.TextBox1 = Sheets(1).Range(\"A\" + Vall3).Text\nUserForm1.TextBox2 = Sheets(1).Range(\"B\" + Vall3).Text\nUserForm1.TextBox3 = Sheets(1).Range(\"C\" + Vall3).Text\nUserForm1.TextBox4 = Sheets(1).Range(\"D\" + Vall3).Text\nUserForm1.TextBox5 = Sheets(1).Range(\"E\" + Vall3).Text\nUserForm1.TextBox6 = Sheets(1).Range(\"J\" + Vall3).Text\nUserForm1.TextBox12 = Sheets(1).Range(\"K\" + Vall3).Text\nUserForm1.TextBox7 = Sheets(1).Range(\"M\" + Vall3).Text\nUserForm1.TextBox8 = Sheets(1).Range(\"N\" + Vall3).Text\nUserForm1.TextBox10 = Sheets(1).Range(\"O\" + Vall3).Text\nUserForm1.TextBox11 = Sheets(1).Range(\"P\" + Vall3).Text\n\nUserForm1.Show\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1574264181, "post_id": 58958037, "comment_id": 104171559, "body": "<code>Range(&quot;B&quot; &amp; lastrow - 2).Value = &quot;=SUM(B&quot; &amp; lastrow-1 &amp; &quot;:B&quot; &amp; lastrow &amp; &quot;)&quot;</code> - everything in quotes will be literally quoted."}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 1, "last_activity_date": 1574264174, "creation_date": 1574264174, "answer_id": 58958089, "question_id": 58958037, "link": "https://stackoverflow.com/questions/58958037/how-to-sum-with-lastrow1-and-lastrow2/58958089#58958089", "title": "How to sum with lastrow+1 and lastrow+2", "body": "<p>If I understand, you're trying to sum values in Column B, based on what you get as the LastRow in Col. B.  </p>\n\n<p>In the formula in VBA, you need to use the variable, as below:</p>\n\n<pre><code>Range(\"B\" &amp; lastrow - 2).Value = \"=SUM(B\" &amp; lastrow - 1 &amp; \":B\" &amp; lastrow &amp; \")\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "is_accepted": false, "score": 1, "last_activity_date": 1574264434, "creation_date": 1574264434, "answer_id": 58958173, "question_id": 58958037, "link": "https://stackoverflow.com/questions/58958037/how-to-sum-with-lastrow1-and-lastrow2/58958173#58958173", "title": "How to sum with lastrow+1 and lastrow+2", "body": "<p>It doesn't work because you are trying to use your VBA variables as variables in a cell formula.  That isn't possible since the vba variables have no values once they go out of scope (the macro finishes running)</p>\n\n<p>Instead try this</p>\n\n<pre><code>Range(\"B\" &amp; lastrow - 2).FormulaR1C1 = \"=SUM(R[1]C:R[2]C)\"\n</code></pre>\n\n<p>This will create a dynamic formula that is the the same as typing in \"=SUM(B200:B201)\" into the cell.</p>\n"}], "owner": {"reputation": 197, "user_id": 10186814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70a16739b4f390d68b13008f18c6108?s=128&d=identicon&r=PG&f=1", "display_name": "Xavi", "link": "https://stackoverflow.com/users/10186814/xavi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 58958089, "answer_count": 2, "score": 1, "last_activity_date": 1574264434, "creation_date": 1574263989, "last_edit_date": 1574264299, "question_id": 58958037, "link": "https://stackoverflow.com/questions/58958037/how-to-sum-with-lastrow1-and-lastrow2", "title": "How to sum with lastrow+1 and lastrow+2", "body": "<p>I have a macro in VBA and I would like that my cell B199 (lastrow-2 in my code) returns me the sum of my cell B200 (lastrow-1 in my code) and cell B201 (lastrow in my code). Unfortunately it does not work because by running my macro, the formula returns me an error in cell B199: #NAME?</p>\n\n<p>Apparently, the problem comes in my code from this part of the code: <code>\"=SUM(lastrow-1&amp;lastrow )\"</code></p>\n\n<p>Please find my code below, if someone can help me, it would be great. Thanks Xavi</p>\n\n<p><a href=\"https://i.stack.imgur.com/8Tv7h.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8Tv7h.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub fgdjkgfjbbg2222()\nDim lastrow As Long\nlastrow = Worksheets(\"youpi\").Range(\"B\" &amp; Rows.Count).End(xlUp).Row\nWorksheets(\"youpi\").Activate\nRange(\"B\" &amp; lastrow - 2).Value = \"=SUM(lastrow-1&amp;lastrow )\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1574263961, "post_id": 58957862, "comment_id": 104171429, "body": "I&#39;m sorry, but I couldn&#39;t help but think of the <a href=\"https://www.youtube.com/watch?v=xOrgLj9lOwk\" rel=\"nofollow noreferrer\">Holy Hand Grenade</a> reading the description.  That being said, I&#39;m not sure what you&#39;re trying to do.  You could use <code>MIN()</code> and <code>MAX()</code> to set the sum. Are you trying to go &quot;down&quot; the column until you hit at least <code>800</code> but no more than <code>2000</code>, and return that sum?"}, {"owner": {"reputation": 59, "user_id": 11573047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5150d4762672e2a7351c846af9bbfba?s=128&d=identicon&r=PG&f=1", "display_name": "contiDevTeam", "link": "https://stackoverflow.com/users/11573047/contidevteam"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1574264426, "post_id": 58957862, "comment_id": 104171714, "body": "updated the question"}], "answers": [{"tags": [], "owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "is_accepted": false, "score": 0, "last_activity_date": 1574264930, "creation_date": 1574264930, "answer_id": 58958344, "question_id": 58957862, "link": "https://stackoverflow.com/questions/58957862/excel-show-subtotals-distributed-according-to-various-conditions/58958344#58958344", "title": "Excel, show Subtotals distributed according to various conditions", "body": "<p>You can loop through the rows in Column A, and keep a running total.</p>\n\n<p>You can then check the running total against your limits, and write the value / update the running total, as needed:</p>\n\n<pre><code>Sub foo()\n    Dim lRow As Long\n    Dim i As Integer\n    lRow = 2\n    With ActiveSheet\n        Do Until IsEmpty(.Cells(lRow, 1))\n            If i &lt; 800 Then\n                i = i + .Cells(lRow, 1).Value\n                If i &gt;= 800 Then .Cells(lRow, 2).Value = i\n            Else\n                i = i + .Cells(lRow, 1).Value\n                If i + .Cells(lRow + 1, 1).Value &gt;= 2000 Then\n                    .Cells(lRow, 2).Value = i\n                    i = 0\n                End If\n            End If\n            lRow = lRow + 1\n        Loop\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1574265761, "creation_date": 1574265761, "answer_id": 58958612, "question_id": 58957862, "link": "https://stackoverflow.com/questions/58957862/excel-show-subtotals-distributed-according-to-various-conditions/58958612#58958612", "title": "Excel, show Subtotals distributed according to various conditions", "body": "<p>Solution with formulas:</p>\n\n<ul>\n<li>B2: <code>=IF(C1+A2&gt;=2000,A2,B1+A2)</code></li>\n<li>C2: <code>=IF(AND(B2&gt;=800,B1&lt;800),B2,IF(B2+A3&gt;=2000,B2,0))</code></li>\n</ul>\n\n<p>copy formulas down and make sure B1 and C1 are empty or <code>0</code>. Column C then shows either 0 or the lower and higher bond of the sum that you requested. Column B is only a helper column needed to calculate the sums.</p>\n\n<p><a href=\"https://i.stack.imgur.com/u5Q1t.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/u5Q1t.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 59, "user_id": 11573047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5150d4762672e2a7351c846af9bbfba?s=128&d=identicon&r=PG&f=1", "display_name": "contiDevTeam", "link": "https://stackoverflow.com/users/11573047/contidevteam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 58958612, "answer_count": 2, "score": 0, "last_activity_date": 1574265761, "creation_date": 1574263461, "last_edit_date": 1574264405, "question_id": 58957862, "link": "https://stackoverflow.com/questions/58957862/excel-show-subtotals-distributed-according-to-various-conditions", "title": "Excel, show Subtotals distributed according to various conditions", "body": "<p>I am trying to do the following:</p>\n\n<p>I have a column \"volume\" that looks like the column on the pic.</p>\n\n<p>This VOLUME ROW is flexible meaning that it can be shorter or larger depending on the situation. Its not fixed and volume changes constantly.</p>\n\n<p>I would like to make subtotals:</p>\n\n<ol>\n<li><p>Minimum amount is 800. The sum of minimum 800 should be diplayed. It can\u00b4t be 799, it \nhas to be equal or above 800. In this case 818 is the correct sum! It has to reach minimum 800 and max. 2000, but must not exceed 2000.</p></li>\n<li><p>Maximum amount is 2000. Since 2000 is the limit, it must not exceed 2000. Therefore the correct sum to \ndisplay is the nearest amount below 2000 or equal to 2000. In this case 1940 is the correct sum!</p></li>\n<li><p>After 2000 or in this case 1940 is reached it starts to count from cero \nuntil it reraches again minimum 800 to max. 2000. \nAnd so on until the end of volume column</p></li>\n</ol>\n\n<p>Here is a picture to better understand what it should look like.</p>\n\n<p><a href=\"https://i.stack.imgur.com/BXllR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BXllR.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "class", "properties"], "comments": [{"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 2, "creation_date": 1574279453, "post_id": 58957743, "comment_id": 104179739, "body": "IMO the class2 has a wrong way how <code>Get</code> should be used. Have a look e.g. <a href=\"http://www.cpearson.com/excel/classes.aspx\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 2, "creation_date": 1574279625, "post_id": 58957743, "comment_id": 104179840, "body": "Why to have properties and <i>not</i> just public variables is because of encapsulation, without it everybody can change the class which sooner or later leads to unexpected behaviour and problems. Have a look e.g. <a href=\"https://stackoverflow.com/questions/18300953/why-encapsulation-is-an-important-feature-of-oop-languages\">here</a>."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 9471210, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kIMu6_QXRxQ/AAAAAAAAAAI/AAAAAAAAAGs/iXfIo-rWX_w/photo.jpg?sz=128", "display_name": "sirocco13", "link": "https://stackoverflow.com/users/9471210/sirocco13"}, "edited": false, "score": 0, "creation_date": 1574264570, "post_id": 58957902, "comment_id": 104171795, "body": "But even then, when talking about <code>fullName</code> wouldn&#39;t I be able to achieve the same result w/o using a Property OR a Class module?"}, {"owner": {"reputation": 2822, "user_id": 1137406, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uw7gI.jpg?s=128&g=1", "display_name": "Pavel Lint", "link": "https://stackoverflow.com/users/1137406/pavel-lint"}, "reply_to_user": {"reputation": 45, "user_id": 9471210, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kIMu6_QXRxQ/AAAAAAAAAAI/AAAAAAAAAGs/iXfIo-rWX_w/photo.jpg?sz=128", "display_name": "sirocco13", "link": "https://stackoverflow.com/users/9471210/sirocco13"}, "edited": false, "score": 0, "creation_date": 1574264667, "post_id": 58957902, "comment_id": 104171858, "body": "Of course. You can avoid using classes all-together. But it&#39;s commonly accepted that they make the code more structured and closer to real life (&quot;Customer&quot; class better reflects a customer than a bunch of subs do)"}, {"owner": {"reputation": 45, "user_id": 9471210, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kIMu6_QXRxQ/AAAAAAAAAAI/AAAAAAAAAGs/iXfIo-rWX_w/photo.jpg?sz=128", "display_name": "sirocco13", "link": "https://stackoverflow.com/users/9471210/sirocco13"}, "edited": false, "score": 0, "creation_date": 1574265118, "post_id": 58957902, "comment_id": 104172175, "body": "Agreed, thanks for your input :) I&#39;ll be looking around for more information."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1574268404, "post_id": 58957902, "comment_id": 104174132, "body": "Another advantage is that you can use intellisense when you declare them as properties."}], "tags": [], "owner": {"reputation": 2822, "user_id": 1137406, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uw7gI.jpg?s=128&g=1", "display_name": "Pavel Lint", "link": "https://stackoverflow.com/users/1137406/pavel-lint"}, "is_accepted": false, "score": 1, "last_activity_date": 1574263587, "creation_date": 1574263587, "answer_id": 58957902, "question_id": 58957743, "link": "https://stackoverflow.com/questions/58957743/are-excel-vba-custom-made-class-properties-useful/58957902#58957902", "title": "Are Excel VBA custom made Class Properties useful?", "body": "<p>Two things come to mind. First, properties can be made <code>ReadOnly</code> (and even <code>WriteOnly</code>). That can be handy at times. Second, some properties are more complicated than just returning the value. A classic example is <code>fullName</code>, which would return <code>firstName &amp; \" \" &amp; lastName</code>. So getting (or setting) a property may have some custom logic that you want to execute each time the value is set (or read). If none of the two apply to a specific case, however, then using method #1 is totally fine.</p>\n"}], "owner": {"reputation": 45, "user_id": 9471210, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kIMu6_QXRxQ/AAAAAAAAAAI/AAAAAAAAAGs/iXfIo-rWX_w/photo.jpg?sz=128", "display_name": "sirocco13", "link": "https://stackoverflow.com/users/9471210/sirocco13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1577816810, "creation_date": 1574263092, "last_edit_date": 1577816810, "question_id": 58957743, "link": "https://stackoverflow.com/questions/58957743/are-excel-vba-custom-made-class-properties-useful", "title": "Are Excel VBA custom made Class Properties useful?", "body": "<p>I've been using VBA for Excel for simple Subs and Functions to automate tasks.</p>\n\n<p>I am familiar with what Class Modules and the term Property in VBA are but all my code so far consists solely of simple Modules and UserForms and I want to delve deeper in the language.</p>\n\n<p>I'm having trouble understanding the significance of Properties, specifically I'm trying to understand the difference between these two pieces of code: </p>\n\n<p><strong>Code#1</strong></p>\n\n<pre><code>'Class Module: \"clsCustomer1\"\nOption Explicit\n\nPublic fName As String\nPublic sName As String\nPublic PhoneNumber As String\nPublic PIN As String\n</code></pre>\n\n<pre><code>'Module: \"Test1\"\nSub test1()\n    Dim customer1 As New clsCustomer1\n\n    With customer1\n        .fName = \"John\"\n        .sName = \"Smith\"\n        .PhoneNumber = \"6512346590\"\n        .PIN = \"55648\"\n\n        Debug.Print .fName, .sName, .PhoneNumber, .PIN\n    End With\nEnd Sub\n</code></pre>\n\n<p><strong>Code#2</strong></p>\n\n<pre><code>'Class Module: \"clsCustomer2\"\nOption Explicit\nPublic Property Get cl_fName(ByVal name As String) As String\n    cl_fName = name\nEnd Property\n\nPublic Property Get cl_sName(ByVal name As String) As String\n    cl_sName = name\nEnd Property\n\nPublic Property Get cl_PhoneNumber(ByVal number As String) As String\n    cl_PhoneNumber = number\nEnd Property\n\nPublic Property Get cl_PIN(ByVal number As String) As String\n    cl_PIN = number\nEnd Property\n</code></pre>\n\n<pre><code>'Module: \"Test2\"\nSub test2()\n    Dim customer2 As New clsCustomer2\n\n    With customer2\n        Debug.Print _\n                    .cl_fName(\"John\"), _\n                    .cl_sName(\"Smith\"), _\n                    .cl_PhoneNumber(\"6512346590\"), _\n                    .cl_PIN(\"55648\")\n    End With\nEnd Sub\n</code></pre>\n\n<p>In both cases debug.print gives the same output. I could even assign the same variables in the second case to match the first one. The actual code in the normal Module is pretty much the same in both cases, if anything the second one looks messier.</p>\n\n<p><strong>Why bother to use Properties when I can declare my variables inside a Class module?</strong></p>\n\n<p>Obviously my example is as simple as it gets, but I can't find a proper use case for Properties here.</p>\n"}, {"tags": ["excel", "vba", "loops", "reference"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574263028, "post_id": 58957662, "comment_id": 104170784, "body": "Then concatenate <code>i + 4</code> into the formula."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1574263038, "post_id": 58957662, "comment_id": 104170790, "body": "&quot;=&#39;C&#39;!$M$&quot; &amp; i+4 &amp; &quot;:$T$&quot; &amp; i+4"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1574263049, "post_id": 58957662, "comment_id": 104170799, "body": "<code>&quot;=&#39;C&#39;!$M$&quot; &amp; i + 4 &amp; &quot;:$T$&quot; &amp; i + 4</code>"}], "owner": {"reputation": 1, "user_id": 12404771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81d183e15b34242d9692fc27f8c3adcf?s=128&d=identicon&r=PG&f=1", "display_name": "Brian W", "link": "https://stackoverflow.com/users/12404771/brian-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574262874, "creation_date": 1574262874, "question_id": 58957662, "link": "https://stackoverflow.com/questions/58957662/excel-vba-loop-with-changing-range-references", "title": "Excel VBA loop with changing range references", "body": "<p>I've got an excel chart with many series, and was looking to get VBA's help to automate some of the repetitive tasks of adding reference cells to the labels on the data series.  </p>\n\n<p>Using the Record Macro function, I got the following lines of code that do the work I need performed, but I'm stuck at getting the Range reference to update in the row with \"='C'!$M$74:$T$74\".  </p>\n\n<p>I'd like to get the 74 to be a dynamic i+4 as it goes through the loop (so that for series 70, the reference is \"='C'!$M$74:$T$74\", series 71 the reference is \"='C'!$M$75:$T$75\", and so on).  </p>\n\n<pre><code>Sub UpdateLabelRanges()\n'\n' UpdateLabelRanges Macro\n'\n' Keyboard Shortcut: Ctrl+r\n'\nDim i As Integer\nFor i = 70 To 250\n\n    ActiveChart.FullSeriesCollection(i).DataLabels.Select\n    ActiveChart.SeriesCollection(i).DataLabels.Format.TextFrame2.TextRange. _\n        InsertChartField msoChartFieldRange, \"='C'!$M$74:$T$74\", 0\n    Selection.ShowRange = True\n    Selection.ShowValue = False\n    ActiveChart.FullSeriesCollection(i).HasLeaderLines = False\n\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "columnsorting"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1574263604, "post_id": 58957625, "comment_id": 104171199, "body": "Should <code>sortRange = WorksheetFunction.Concat(&quot;A1:&quot;, &quot;AM&quot;, LR)</code> be <code>sortRange = WorksheetFunction.Concat(&quot;A1&quot;, &quot;AM&quot; &amp; LR)</code>"}, {"owner": {"reputation": 1, "user_id": 12402988, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Y9oGTJARgDQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reF19snRAk2wOzkwZmoGxwMLT_CGw/photo.jpg?sz=128", "display_name": "SRKAN", "link": "https://stackoverflow.com/users/12402988/srkan"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1574264649, "post_id": 58957625, "comment_id": 104171847, "body": "I tried fixing with &amp; but still getting error (run time error 450 -wrong number of argument or invalid property assignment ) at .SetRange.SR"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1574265510, "post_id": 58957625, "comment_id": 104172412, "body": "Oh! You don&#39;t need that <code>.</code>. Use <code>.SetRange SR</code> (This assumes that <code>SR</code> is a valid range. I think you should actually do <code>Set SR = Range(&quot;A1:AM&quot; &amp; LR)</code>. Otherwise I <i>think</i> your <code>sortRange</code> will be a string of the values in those cells, not a valid &quot;string range&quot;?"}, {"owner": {"reputation": 1, "user_id": 12402988, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Y9oGTJARgDQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reF19snRAk2wOzkwZmoGxwMLT_CGw/photo.jpg?sz=128", "display_name": "SRKAN", "link": "https://stackoverflow.com/users/12402988/srkan"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1574266653, "post_id": 58957625, "comment_id": 104173086, "body": "Hi Bruce, with setting SR as you mentioned still getting same type of error and SR being no value"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1574266921, "post_id": 58957625, "comment_id": 104173249, "body": "What is <code>LR</code>? After you do <code>LR = ...</code>, add <code>Debug.Print LR</code>, is it showing as 0?  (To see the debug print, in the VBEditor press <code>CTRL+G</code> to see the Immediate Window.)  I suspect it may be better to do <code>LR = Range(&quot;A&quot; &amp; rows.Count).End(xlUp).Row</code>."}, {"owner": {"reputation": 1, "user_id": 12402988, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Y9oGTJARgDQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reF19snRAk2wOzkwZmoGxwMLT_CGw/photo.jpg?sz=128", "display_name": "SRKAN", "link": "https://stackoverflow.com/users/12402988/srkan"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1574267546, "post_id": 58957625, "comment_id": 104173609, "body": "the value is 783187 which is last row number in worksheet data that I have."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1574270557, "post_id": 58957625, "comment_id": 104175335, "body": "Also, remove that <code>SR.Select</code> line ...you don&#39;t need it. Don&#39;t think that&#39;ll solve the issue, but just wanted to note."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1574274047, "post_id": 58957625, "comment_id": 104177153, "body": "With your code as written, and <code>SR.Select</code> deleted, that error line should read <code>.SetRange SR</code>. It works here. If that doesn&#39;t work, what does <code>?SR.Address</code> return in the immediate window."}, {"owner": {"reputation": 1, "user_id": 12402988, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Y9oGTJARgDQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reF19snRAk2wOzkwZmoGxwMLT_CGw/photo.jpg?sz=128", "display_name": "SRKAN", "link": "https://stackoverflow.com/users/12402988/srkan"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1574326952, "post_id": 58957625, "comment_id": 104195665, "body": "Thanks@BruceWayne and @Ron. It is working now."}, {"owner": {"reputation": 1, "user_id": 12402988, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Y9oGTJARgDQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reF19snRAk2wOzkwZmoGxwMLT_CGw/photo.jpg?sz=128", "display_name": "SRKAN", "link": "https://stackoverflow.com/users/12402988/srkan"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1574431547, "post_id": 58957625, "comment_id": 104242040, "body": "@BruceWayne. The code was running well, I am getting error on sort value. Can you please help."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1574434606, "post_id": 58957625, "comment_id": 104243821, "body": "What line is throwing an error?"}, {"owner": {"reputation": 1, "user_id": 12402988, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Y9oGTJARgDQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reF19snRAk2wOzkwZmoGxwMLT_CGw/photo.jpg?sz=128", "display_name": "SRKAN", "link": "https://stackoverflow.com/users/12402988/srkan"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1574439751, "post_id": 58957625, "comment_id": 104246508, "body": "@BruceWayne  I am again facing problem in sort field. Error (run time error 424-object required with Sort value being nothing )"}], "owner": {"reputation": 1, "user_id": 12402988, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Y9oGTJARgDQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reF19snRAk2wOzkwZmoGxwMLT_CGw/photo.jpg?sz=128", "display_name": "SRKAN", "link": "https://stackoverflow.com/users/12402988/srkan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574434578, "creation_date": 1574262771, "last_edit_date": 1574434578, "question_id": 58957625, "link": "https://stackoverflow.com/questions/58957625/sort-the-data-by-column", "title": "Sort the data by column", "body": "<p>Earlier the code was running well but now I am again facing problem in sort field. Error (run time error 424-object required with Sort value being nothing\n)</p>\n\n<pre><code>ThisWorkbook.Sheets(\"Sheet1\").Activate\nDim LR As Long\nDim SR As Range\n\nLR = Range(\"D1\").SpecialCells(xlCellTypeLastCell).Row\nSet SR = Range(\"A1:AM\" &amp; LR)\n\nWith Sort\n    .SortFields.Clear\n    .SortFields.Add Key:= _\n    Range(\"D1\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n    .SetRange.SR\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1574262487, "post_id": 58957473, "comment_id": 104170419, "body": "Do you use <code>.Select</code> or <code>.Activate</code> in your code?  If so, don&#39;t. There are very very few reasons to do so.  See: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 9659480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/160dae1fd54aadf66db0482c1f31a61d?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Ross", "link": "https://stackoverflow.com/users/9659480/chris-ross"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1574262588, "post_id": 58957473, "comment_id": 104170487, "body": "I do use both. Do you think that is causing my problem?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1574262615, "post_id": 58957473, "comment_id": 104170502, "body": "Yes I do think that is what is causing the problem."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1574262668, "post_id": 58957473, "comment_id": 104170534, "body": "It is also slowing your code, and making it harder to read."}, {"owner": {"reputation": 1, "user_id": 9659480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/160dae1fd54aadf66db0482c1f31a61d?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Ross", "link": "https://stackoverflow.com/users/9659480/chris-ross"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1574263208, "post_id": 58957473, "comment_id": 104170912, "body": "Thanks Scott! I will take a look at this."}], "owner": {"reputation": 1, "user_id": 9659480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/160dae1fd54aadf66db0482c1f31a61d?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Ross", "link": "https://stackoverflow.com/users/9659480/chris-ross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1574262464, "creation_date": 1574262351, "last_edit_date": 1574262464, "question_id": 58957473, "link": "https://stackoverflow.com/questions/58957473/how-can-i-fix-the-excel-ghost-phantom-tab-glitch", "title": "How can I fix the Excel ghost/phantom tab glitch?", "body": "<p>I am working with a large Excel spreadsheet full of VBA macros, but I keep running into the infamous Excel glitch that shows a ghost image of one tab on top of the currently selected tab. Has anybody else seen this? Does anybody have any suggestions on how to fix this?</p>\n\n<p><a href=\"https://i.stack.imgur.com/34gXI.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/34gXI.jpg\" alt=\"Example Screenshot\"></a></p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 1, "creation_date": 1574349927, "post_id": 58957402, "comment_id": 104209745, "body": "Your original post was too broad. It could have been closed. Ask only one question at a time, as is <b>expected</b> on this Q &amp; A (not a forum). Now you have negated the answer provided and not awarded the fake internet points, if you had accepted the answer.  Fake internet points encourage responses. You can roll back this post and ask a new question about creating a folder."}, {"owner": {"reputation": 65, "user_id": 12297683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UYb16.png?s=128&g=1", "display_name": "Codingnoob", "link": "https://stackoverflow.com/users/12297683/codingnoob"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1574432983, "post_id": 58957402, "comment_id": 104242855, "body": "@niton thank your for your comment. You are absolutely right. I&#39;m new to this website and i&#39;m trying to be in the guidelines as much as possible."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 12297683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UYb16.png?s=128&g=1", "display_name": "Codingnoob", "link": "https://stackoverflow.com/users/12297683/codingnoob"}, "edited": false, "score": 0, "creation_date": 1574267595, "post_id": 58958038, "comment_id": 104173649, "body": "It does&#39;nt work. It gives me an error compilation &#39;&#39; for each must be variable or object &#39;&#39;"}, {"owner": {"reputation": 65, "user_id": 12297683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UYb16.png?s=128&g=1", "display_name": "Codingnoob", "link": "https://stackoverflow.com/users/12297683/codingnoob"}, "edited": false, "score": 0, "creation_date": 1574268562, "post_id": 58958038, "comment_id": 104174214, "body": "nvm, it worked, but that&#39;s only one part of the problem!"}, {"owner": {"reputation": 65, "user_id": 12297683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UYb16.png?s=128&g=1", "display_name": "Codingnoob", "link": "https://stackoverflow.com/users/12297683/codingnoob"}, "edited": false, "score": 0, "creation_date": 1574269497, "post_id": 58958038, "comment_id": 104174763, "body": "for anyone who is interested in how i made it work, i just had to add <code>Dim Att As Variant</code>"}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1574263990, "creation_date": 1574263990, "answer_id": 58958038, "question_id": 58957402, "link": "https://stackoverflow.com/questions/58957402/save-attachments-to-a-new-windows-folder/58958038#58958038", "title": "Save attachments to a new Windows folder?", "body": "<p>The code</p>\n\n<pre><code>Set myAttachments = item.Attachments\nAtt = myAttachments.item(1).DisplayName\nmyAttachments.item(1).SaveAsFile attPath &amp; Att\n</code></pre>\n\n<p>needs to be changed to</p>\n\n<pre><code>Set myAttachments = item.Attachments\nfor each Att in myAttachments \n    Att.SaveAsFile attPath &amp; Att.FileName\nnext\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 12297683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UYb16.png?s=128&g=1", "display_name": "Codingnoob", "link": "https://stackoverflow.com/users/12297683/codingnoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1583834417, "creation_date": 1574262151, "last_edit_date": 1583834417, "question_id": 58957402, "link": "https://stackoverflow.com/questions/58957402/save-attachments-to-a-new-windows-folder", "title": "Save attachments to a new Windows folder?", "body": "<p>Every time I receive an email with the subject \"Test\", I want to: </p>\n\n<ol>\n<li>Automatically extract all attachments and store them in its own new created folder.</li>\n<li>Automatically copy the email inside this new folder</li>\n<li>Automatically add a Word document inside this new folder.</li>\n<li>The folder must be named by the date received.</li>\n</ol>\n\n<p>The code I have copies all attachments in a pre-selected folder, but it doesn't create a personal folder for them.</p>\n\n<pre><code>Private WithEvents Items As Outlook.Items\n\nPrivate Sub Application_Startup()\n    Dim olApp As Outlook.Application\n    Dim objNS As Outlook.NameSpace\n    Set olApp = Outlook.Application\n    Set objNS = olApp.GetNamespace(\"MAPI\")\n    Set Items = objNS.GetDefaultFolder(olFolderInbox).Items\nEnd Sub\n\nPrivate Sub Items_ItemAdd(ByVal item As Object)\n\nOn Error GoTo ErrorHandler\n\n    'Only act if it's a MailItem\n    Dim Msg As Outlook.MailItem\n    If TypeName(item) = \"MailItem\" Then\n        Set Msg = item\n\n    'Change variables to match need. Comment or delete any part unnecessary.\n        If (Msg.Subject = \"Heures\") And _\n        (Msg.Attachments.Count &gt;= 1) Then\n\n    'Set folder to save in.\n    Dim olDestFldr As Outlook.MAPIFolder\n    Dim myAttachments As Outlook.Attachments\n    Dim Att As Variant\n\n    Const attPath As String = \"C:\\Users\\NASC02\\Test\\\"\n\n    ' save attachment\n    Set myAttachments = item.Attachments\n    For Each Att In myAttachments\n    Att.SaveAsFile attPath &amp; Att.FileName\n\nNext\n\n    ' mark as read\n   Msg.UnRead = False\n\n\n\nEnd If\nEnd If\n\n\nProgramExit:\n  Exit Sub\n\nErrorHandler:\n  MsgBox Err.Number &amp; \" - \" &amp; Err.Description\n  Resume ProgramExit\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "internationalization", "userform"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1574262698, "post_id": 58957391, "comment_id": 104170562, "body": "Welcome to SO. So if you do <code>Debug.Print Me.Controls(&quot;exchangeRate&quot;).Value</code> you get the number without the comma? Are the comma your decimal separator? Make sure also VBA gets the value as decimal , because by default, VBA decimal separator <b>is not</b> the comma, but the dot."}, {"owner": {"reputation": 13, "user_id": 12404731, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KuKmJOYVHp0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcHfenmbohOLo4Lojy3qLuBGMxVaQ/photo.jpg?sz=128", "display_name": "Johan Andersson", "link": "https://stackoverflow.com/users/12404731/johan-andersson"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1574265632, "post_id": 58957391, "comment_id": 104172486, "body": "&gt;11,1119203934117  This is the debug output. How do i make sure VBA captures the value as decimal , ?"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1574267098, "post_id": 58957391, "comment_id": 104173361, "body": "If the output is correct, then it&#39;s right. So when you do <code>exchangeRate.Value</code> is when it looses the comma?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 12404731, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KuKmJOYVHp0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcHfenmbohOLo4Lojy3qLuBGMxVaQ/photo.jpg?sz=128", "display_name": "Johan Andersson", "link": "https://stackoverflow.com/users/12404731/johan-andersson"}, "edited": false, "score": 1, "creation_date": 1574323142, "post_id": 58962089, "comment_id": 104193630, "body": "Thanks, solution verified!"}], "tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": true, "score": 1, "last_activity_date": 1574278650, "creation_date": 1574278650, "answer_id": 58962089, "question_id": 58957391, "link": "https://stackoverflow.com/questions/58957391/userform-error-in-excel-when-updating-record-with-decimals/58962089#58962089", "title": "Userform Error in Excel When updating record with decimals", "body": "<p><strong>TextBox values are strings</strong></p>\n\n<p>There are some points causing your issue due to your <em>local number settings</em> (deviating from VBA's number formatting):</p>\n\n<ol>\n<li>Apparently your <code>Application.DecimalSeparator</code> equals \u25ba <code>,</code> and <strong>not</strong> the defaulting comma <code>.</code> as used in <em>VBA</em>\n(in many middle European countries the default comma is represented by a column <code>,</code>, whereas the local <code>Application.ThousandsSeparator</code> is a point <code>.</code>).</li>\n<li>Initially you are assigning a cell value of double type to a textbox only capable to hold text.\nVBA prefers to convert this number (VBA internal value: <code>10.8116705323301</code>) to a locally formatted string \ndisplayed as <code>10,8116705323301</code>.</li>\n<li>Writing a basically <em>numeric string</em> back to a cell will be interpreted as number, but following the English default settings.\nIf there appears an English ThousandsSeparator (i.e. a colon <code>,</code>) in a numeric stringthis will be neglected as unnecessary deco, \nthus resulting in a cell value of <code>108116705323301</code> (assuming a local numberformat of \"0\").</li>\n</ol>\n\n<p><strong>Remedy</strong></p>\n\n<p>As I suppose you intend to continue displaying the value in your local format within Userform,\nyou'll have to convert the control value to a number (double type). If you are sure that your\n<code>Application.DecimalSeparator</code> equals \",\" and not to the English colon, you could recode your <strong><code>CommandButton1_Click()</code></strong> event as follow:</p>\n\n<pre><code>    ThisWorkbook.WorkSheets(\"sheet\").Cells(activeRow, 21).Value = Val(Replace(Me.TextBox1, \",\" , \".\"))\n</code></pre>\n\n<p>BTW Always use fully qualified range references; note that it would even preferrable to use a sheet's <code>CodeName</code> instead it's\nnormal sheet name that could be overwritten too easily by other users. </p>\n"}], "owner": {"reputation": 13, "user_id": 12404731, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KuKmJOYVHp0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcHfenmbohOLo4Lojy3qLuBGMxVaQ/photo.jpg?sz=128", "display_name": "Johan Andersson", "link": "https://stackoverflow.com/users/12404731/johan-andersson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 58962089, "answer_count": 1, "score": 1, "last_activity_date": 1574278725, "creation_date": 1574262100, "last_edit_date": 1574278725, "question_id": 58957391, "link": "https://stackoverflow.com/questions/58957391/userform-error-in-excel-when-updating-record-with-decimals", "title": "Userform Error in Excel When updating record with decimals", "body": "<p>I've written a userform that edits records from an Excel table. </p>\n\n<pre><code>Private Sub UserForm_Initialize()\nDim ActiveRow As Long\nActiveRow = ActiveCell.Row\n...\nMe.Controls(\"exchangeRate\").Value = Cells(ActiveRow, 21)\n</code></pre>\n\n<p>In the userform the value shows up as expected. We copy this value from our bank, and there for receive a long value with lots of decimal places. </p>\n\n<p>Example: </p>\n\n<blockquote>\n  <p>10,8116705323301</p>\n</blockquote>\n\n<p>So the userform shows this value, no problem. But when i save this value again, the comma is removed. </p>\n\n<blockquote>\n  <p>108116705323301</p>\n</blockquote>\n\n<pre><code>Private Sub CommandButton1_Click()\nApplication.ScreenUpdating = False\nSheets(\"sheet\").Unprotect Password:=\"xxx\"\nDim ActiveRow As Long\nActiveRow = ActiveCell.Row\n   Cells(ActiveRow, 21).Value = exchangeRate.Value\nApplication.ScreenUpdating = True\nSheets(\"sheet\").Protect DrawingObjects:=True, Contents:=True, Scenarios:=True, AllowFormattingRows:=True, AllowFormattingColumns:=True, Password:=\"xxx\"\n</code></pre>\n\n<p>What am I doing wrong? </p>\n"}, {"tags": ["excel", "vba", "charts", "multiple-columns"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574261897, "post_id": 58957204, "comment_id": 104170022, "body": "I think you need to <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.seriescollection.add\" rel=\"nofollow noreferrer\"><code>Add</code></a> the series and then change its axis group to <code>xlSecondary</code>."}, {"owner": {"reputation": 23, "user_id": 10343282, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HRXnGPMaFHU/AAAAAAAAAAI/AAAAAAAAAFk/al6HxQjRmGE/photo.jpg?sz=128", "display_name": "Muhammad Mustafa", "link": "https://stackoverflow.com/users/10343282/muhammad-mustafa"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574262928, "post_id": 58957204, "comment_id": 104170716, "body": "I am rookie at this. How should that look like exactly. Thanks a lot"}], "answers": [{"tags": [], "owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "is_accepted": false, "score": 0, "last_activity_date": 1574395708, "creation_date": 1574395708, "answer_id": 58987362, "question_id": 58957204, "link": "https://stackoverflow.com/questions/58957204/mutiple-quantaties-plotting-in-a-chart-in-vba-excel/58987362#58987362", "title": "Mutiple quantaties plotting in a chart in vba excel", "body": "<p>It should go something like this:</p>\n\n<pre><code>Sub CreateEmbeddedChartUsingShapesAddChart()\n\n  Dim MyRange1 As Range\n  Set MyRange1 = Application.InputBox(Prompt:=\"Select line chart inputs\", Type:=8)\n\n  Dim MyChart As Chart\n  Set MyChart = ActiveSheet.Shapes.AddChart(xlLine).Chart\n  MyChart.SetSourceData Source:=MyRange1, PlotBy:=xlColumns\n\n  Dim MyRange2 As Range\n  Set MyRange2 = Application.InputBox(Prompt:=\"Select column chart inputs\", Type:=8)\n\n  With MyChart.SeriesCollection.NewSeries\n    If IsNumeric(MyRange2.Cells(1)) Then\n      .Values = MyRange2\n    Else\n      .Values = MyRange2.Offset(1).Resize(MyRange2.Rows.Count - 1)\n      .Name = \"=\" &amp; MyRange2.Cells(1).Address(, , , True)\n    End If\n    .ChartType = xlColumnClustered\n  End With\n\nEnd Sub\n</code></pre>\n\n<p>Since the name of your procedure included \"Embedded\", I created an embedded chart, not the standalone chart sheet you ended up with.</p>\n\n<p>Suggestion: Use more descriptive prompts for the input box commands. Also, if you're using Excel 2013 or later, use AddChart2, not AddChart.</p>\n"}], "owner": {"reputation": 23, "user_id": 10343282, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HRXnGPMaFHU/AAAAAAAAAAI/AAAAAAAAAFk/al6HxQjRmGE/photo.jpg?sz=128", "display_name": "Muhammad Mustafa", "link": "https://stackoverflow.com/users/10343282/muhammad-mustafa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574395708, "creation_date": 1574261610, "last_edit_date": 1574265589, "question_id": 58957204, "link": "https://stackoverflow.com/questions/58957204/mutiple-quantaties-plotting-in-a-chart-in-vba-excel", "title": "Mutiple quantaties plotting in a chart in vba excel", "body": "<p>I am trying to plot a exam sheet of the students in excel. A target line that shows the maximum you can get in a test and all along. Then what a student have achieved in each of the questions. The image will have line and bar graph in one chart.</p>\n\n<p>The bar graph shows how much a student scored in a test. With the two colors blue and orange representation scores in the two respective sections. His performance is plotted for the whole year. The dotted line graph represents the target of the students that they can reach if they score maximum. \nI use the following code function to draw one chart but when I try to include the second one, it overwrites the first one. </p>\n\n<pre><code>Sub CreateEmbeddedChartUsingShapesAddChart()\n\nDim myRange As Range\n\nSet myRange = Application.InputBox(Prompt:=\"Select chart inputs\", Type:=8)\nCharts.Add\nActiveChart.ChartType = xlLine\nActiveChart.SetSourceData Source:=myRange, PlotBy:=xlColumns\n\nmyRange2 = Application.InputBox(Prompt:=\"Select chart inputs\", Type:=8)\nActiveChart.ChartType = xlColumnClustered\nActiveChart.SetSourceData Source:=myRange, PlotBy:=xlColumns\n\nActiveChart.Location Where:=xlLocationAsNewSheet\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "format", "conditional-statements"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1574260829, "post_id": 58956789, "comment_id": 104169352, "body": "Hm, maybe different routes here. I&#39;m thinking along the lines of <code>SpecialCells</code> or an adaptation of your formula to include <code>&quot;&lt;&gt;&quot;&quot;&quot;</code>"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574260975, "post_id": 58956789, "comment_id": 104169436, "body": "So should the conditional formatting check if either <code>D14</code> or <code>E14</code> is blank, or just <code>E14</code>?"}, {"owner": {"reputation": 1, "user_id": 12344119, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hzuM8baBZBU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdt4YabwmOzoV1hXcG50nL_66hRUA/photo.jpg?sz=128", "display_name": "Brandon Campbell", "link": "https://stackoverflow.com/users/12344119/brandon-campbell"}, "edited": false, "score": 0, "creation_date": 1574261651, "post_id": 58956789, "comment_id": 104169853, "body": "Just E14. The way I have my spreadsheet is I have a measurement in D14 and a tolerance in E14 and F14. Some measurements do not have tolerances."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12344119, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hzuM8baBZBU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdt4YabwmOzoV1hXcG50nL_66hRUA/photo.jpg?sz=128", "display_name": "Brandon Campbell", "link": "https://stackoverflow.com/users/12344119/brandon-campbell"}, "edited": false, "score": 0, "creation_date": 1574262676, "post_id": 58957224, "comment_id": 104170545, "body": "I will definitely give this a try.Thanks!"}, {"owner": {"reputation": 1, "user_id": 12344119, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hzuM8baBZBU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdt4YabwmOzoV1hXcG50nL_66hRUA/photo.jpg?sz=128", "display_name": "Brandon Campbell", "link": "https://stackoverflow.com/users/12344119/brandon-campbell"}, "edited": false, "score": 0, "creation_date": 1574263054, "post_id": 58957224, "comment_id": 104170801, "body": "I am really new to VBA. Do you know of a formula to use?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 1, "user_id": 12344119, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hzuM8baBZBU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdt4YabwmOzoV1hXcG50nL_66hRUA/photo.jpg?sz=128", "display_name": "Brandon Campbell", "link": "https://stackoverflow.com/users/12344119/brandon-campbell"}, "edited": false, "score": 0, "creation_date": 1574263166, "post_id": 58957224, "comment_id": 104170883, "body": "@brandoncampbell, check out the other answer for that alternative =)"}, {"owner": {"reputation": 1, "user_id": 12344119, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hzuM8baBZBU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdt4YabwmOzoV1hXcG50nL_66hRUA/photo.jpg?sz=128", "display_name": "Brandon Campbell", "link": "https://stackoverflow.com/users/12344119/brandon-campbell"}, "edited": false, "score": 0, "creation_date": 1574264315, "post_id": 58957224, "comment_id": 104171643, "body": "Oh thanks! I just saw the answer pop up. Im also fairly new to this website haha"}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 0, "last_activity_date": 1574261669, "creation_date": 1574261669, "answer_id": 58957224, "question_id": 58956789, "link": "https://stackoverflow.com/questions/58956789/conditionally-formatting-cells-in-vba/58957224#58957224", "title": "Conditionally formatting cells in VBA", "body": "<p>You can do this multiple ways, but as per my comment, for example:</p>\n\n<pre><code>Set rg = Range(\"D14\", Range(\"G14\").End(xlDown))\nSet rg = Intersect(rg.Columns(1).SpecialCells(2).Rows.EntireRow, Range(\"G:G\"))\n</code></pre>\n\n<p>I would also consider to be explicit about your range object, consider refering to a Sheet object.</p>\n\n<p>Btw, if you also want to avoid if <code>E14</code> is blank, you can extend the <code>Intersect</code>:</p>\n\n<pre><code>Set rg = Intersect(rg.Columns(1).SpecialCells(2).Rows.EntireRow, rg.Columns(2).SpecialCells(2).Rows.EntireRow, Range(\"G:G\"))\n</code></pre>\n\n<p>Obviously, another answer could be on how you could use a formula as a condition which checks if cells are '&lt;>\"\"` </p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 12344119, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hzuM8baBZBU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdt4YabwmOzoV1hXcG50nL_66hRUA/photo.jpg?sz=128", "display_name": "Brandon Campbell", "link": "https://stackoverflow.com/users/12344119/brandon-campbell"}, "edited": false, "score": 0, "creation_date": 1574264738, "post_id": 58957638, "comment_id": 104171904, "body": "This worked for G14. is there a way to do the whole selection or loop this?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 1, "user_id": 12344119, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hzuM8baBZBU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdt4YabwmOzoV1hXcG50nL_66hRUA/photo.jpg?sz=128", "display_name": "Brandon Campbell", "link": "https://stackoverflow.com/users/12344119/brandon-campbell"}, "edited": false, "score": 0, "creation_date": 1574269601, "post_id": 58957638, "comment_id": 104174813, "body": "I can&#39;t replicate that - works for the entire range for me. How did you implement it?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1574270261, "post_id": 58957638, "comment_id": 104175161, "body": "Unless OP needs <code>xlUp</code> (meaning maybe <code>G15</code> was empty?), but for me it also works =)"}, {"owner": {"reputation": 1, "user_id": 12344119, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hzuM8baBZBU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdt4YabwmOzoV1hXcG50nL_66hRUA/photo.jpg?sz=128", "display_name": "Brandon Campbell", "link": "https://stackoverflow.com/users/12344119/brandon-campbell"}, "edited": false, "score": 0, "creation_date": 1574363623, "post_id": 58957638, "comment_id": 104216954, "body": "I copied and pasted the new code into my original code. It worked for the first 2 cells but not the rest of the cells where the condition was blank. the rest of the spreadsheet formats fine."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574363670, "post_id": 58957638, "comment_id": 104216971, "body": "What is the range that the conditional formatting is applied to? You can see it under <i>Conditional Formatting</i> &gt; <i>Manage Rules</i>."}, {"owner": {"reputation": 1, "user_id": 12344119, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hzuM8baBZBU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdt4YabwmOzoV1hXcG50nL_66hRUA/photo.jpg?sz=128", "display_name": "Brandon Campbell", "link": "https://stackoverflow.com/users/12344119/brandon-campbell"}, "edited": false, "score": 0, "creation_date": 1574364560, "post_id": 58957638, "comment_id": 104217413, "body": "It is being applied to G14-G1443. None of that range is blank. It is formatting correctly for the whole range. It is just not skipping if cells E or F is blank."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574364741, "post_id": 58957638, "comment_id": 104217495, "body": "Should the conditional formatting also check if F is blank then? You did not stipulate that."}, {"owner": {"reputation": 1, "user_id": 12344119, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hzuM8baBZBU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdt4YabwmOzoV1hXcG50nL_66hRUA/photo.jpg?sz=128", "display_name": "Brandon Campbell", "link": "https://stackoverflow.com/users/12344119/brandon-campbell"}, "edited": false, "score": 0, "creation_date": 1574365484, "post_id": 58957638, "comment_id": 104217846, "body": "Oh yes. Sorry... Would I copy the code and specify for F as well? F is actually cond2. i just realized that"}, {"owner": {"reputation": 1, "user_id": 12344119, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hzuM8baBZBU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdt4YabwmOzoV1hXcG50nL_66hRUA/photo.jpg?sz=128", "display_name": "Brandon Campbell", "link": "https://stackoverflow.com/users/12344119/brandon-campbell"}, "edited": false, "score": 0, "creation_date": 1574366010, "post_id": 58957638, "comment_id": 104218073, "body": "It is only applying the formula above to G14. The rest of the cells are $G16&gt;$D16+$E16 and  $G16&lt;$D16-$F16"}, {"owner": {"reputation": 1, "user_id": 12344119, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hzuM8baBZBU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdt4YabwmOzoV1hXcG50nL_66hRUA/photo.jpg?sz=128", "display_name": "Brandon Campbell", "link": "https://stackoverflow.com/users/12344119/brandon-campbell"}, "edited": false, "score": 0, "creation_date": 1574426737, "post_id": 58957638, "comment_id": 104239512, "body": "This is probably different from what I&#39;m trying to do but each format needs to be specific for that row. All of the cells are in the same position but have different values (i.e. D and F). Each cell has a different value. Right now everything is being tied to cells &quot;D14&quot; and &quot;F14&quot;"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574427761, "post_id": 58957638, "comment_id": 104240063, "body": "Did you by accident add dollar signs <code>$</code> before the <code>14</code>?"}, {"owner": {"reputation": 1, "user_id": 12344119, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hzuM8baBZBU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdt4YabwmOzoV1hXcG50nL_66hRUA/photo.jpg?sz=128", "display_name": "Brandon Campbell", "link": "https://stackoverflow.com/users/12344119/brandon-campbell"}, "edited": false, "score": 0, "creation_date": 1574434180, "post_id": 58957638, "comment_id": 104243546, "body": "No. after digging a little deeper it is applying the formula in the code to row 14 and applying the basic formula for the rest of the sheet referencing row 17."}, {"owner": {"reputation": 1, "user_id": 12344119, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hzuM8baBZBU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdt4YabwmOzoV1hXcG50nL_66hRUA/photo.jpg?sz=128", "display_name": "Brandon Campbell", "link": "https://stackoverflow.com/users/12344119/brandon-campbell"}, "edited": false, "score": 0, "creation_date": 1574434223, "post_id": 58957638, "comment_id": 104243576, "body": "Do yo think I need to set the row number as a variable and do them one at a time with a loop?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574434656, "post_id": 58957638, "comment_id": 104243843, "body": "No. You need relative references - no <code>$</code> before the 14. Excel updates the 14 to 15, 16, 17, etc. for each successive row when applying conditional formatting."}, {"owner": {"reputation": 1, "user_id": 12344119, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hzuM8baBZBU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdt4YabwmOzoV1hXcG50nL_66hRUA/photo.jpg?sz=128", "display_name": "Brandon Campbell", "link": "https://stackoverflow.com/users/12344119/brandon-campbell"}, "edited": false, "score": 0, "creation_date": 1574438107, "post_id": 58957638, "comment_id": 104245663, "body": "For some reason it stop after row 15 and references all other rows to 15. Could my Dim rg be constraining it?"}, {"owner": {"reputation": 1, "user_id": 12344119, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hzuM8baBZBU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdt4YabwmOzoV1hXcG50nL_66hRUA/photo.jpg?sz=128", "display_name": "Brandon Campbell", "link": "https://stackoverflow.com/users/12344119/brandon-campbell"}, "edited": false, "score": 0, "creation_date": 1574438348, "post_id": 58957638, "comment_id": 104245795, "body": "I discovered I had .select for my Dim rg. i took that away and now the formula applies to all cells but it is the same formula referencing row 14"}, {"owner": {"reputation": 1, "user_id": 12344119, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hzuM8baBZBU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdt4YabwmOzoV1hXcG50nL_66hRUA/photo.jpg?sz=128", "display_name": "Brandon Campbell", "link": "https://stackoverflow.com/users/12344119/brandon-campbell"}, "edited": false, "score": 0, "creation_date": 1574438453, "post_id": 58957638, "comment_id": 104245847, "body": "Is there a way to change the applies to option? My Dim rg isnt allowing the format to go down i think. Sorry for all of the comments.... Haha"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 1, "user_id": 12344119, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hzuM8baBZBU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdt4YabwmOzoV1hXcG50nL_66hRUA/photo.jpg?sz=128", "display_name": "Brandon Campbell", "link": "https://stackoverflow.com/users/12344119/brandon-campbell"}, "edited": false, "score": 0, "creation_date": 1574438735, "post_id": 58957638, "comment_id": 104245984, "body": "@BrandonCampbell - at this point I think you should ask a new question, with the exact code you&#39;re trying and the problem you&#39;re having."}, {"owner": {"reputation": 1, "user_id": 12344119, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hzuM8baBZBU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdt4YabwmOzoV1hXcG50nL_66hRUA/photo.jpg?sz=128", "display_name": "Brandon Campbell", "link": "https://stackoverflow.com/users/12344119/brandon-campbell"}, "edited": false, "score": 0, "creation_date": 1574439421, "post_id": 58957638, "comment_id": 104246345, "body": "Ok Thanks for all of your help. I&#39;m just really new at this."}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 1, "last_activity_date": 1574262796, "creation_date": 1574262796, "answer_id": 58957638, "question_id": 58956789, "link": "https://stackoverflow.com/questions/58956789/conditionally-formatting-cells-in-vba/58957638#58957638", "title": "Conditionally formatting cells in VBA", "body": "<p>Proposing the alternate solution to use a formula:</p>\n\n<pre><code>Sub Test()\n    Dim rg As Range\n    Dim cond1 As FormatCondition, cond2 As FormatCondition, cond3 As FormatCondition\n    Set rg = Range(\"G14\", Range(\"G14\").End(xlDown))\n\n    'clear any existing conditional formatting\n    rg.FormatConditions.Delete\n\n    'define the rule for each conditional format\n    Set cond1 = rg.FormatConditions.Add(xlExpression, , \"=AND($G14&gt;$D14+$E14,$E14&lt;&gt;\"\"\"\")\")\n    Set cond2 = rg.FormatConditions.Add(xlExpression, , \"=AND($G14&lt;$D14-$E14,$E14&lt;&gt;\"\"\"\")\")\n\n    'define the format applied for each conditional format\n    With cond1\n        .Font.FontStyle = \"Bold\"\n        .Font.Color = vbRed\n    End With\n\n    With cond2\n        .Font.FontStyle = \"Bold\"\n        .Font.Color = vbRed\n    End With\nEnd Sub\n</code></pre>\n\n<p>Note that if the format is the same for each rule, then you could combine the two into one.</p>\n"}], "owner": {"reputation": 1, "user_id": 12344119, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hzuM8baBZBU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdt4YabwmOzoV1hXcG50nL_66hRUA/photo.jpg?sz=128", "display_name": "Brandon Campbell", "link": "https://stackoverflow.com/users/12344119/brandon-campbell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1574262796, "creation_date": 1574260442, "last_edit_date": 1574260611, "question_id": 58956789, "link": "https://stackoverflow.com/questions/58956789/conditionally-formatting-cells-in-vba", "title": "Conditionally formatting cells in VBA", "body": "<p>I am conditionally formatting a range of cells. I want to do greater than and less than another cell value. I have found this code online that lets me do that but I was wondering if there is a way to skip formatting if the condition cell is blank.</p>\n\n<p>Example: I want to highlight \"G14\" red if the value is greater than \"D14\"+\"E14\". Vise versa for minus. If the value of \"E14\" is blank it still make s it red because it is acting as if it is zero. </p>\n\n<p>Here is my code:</p>\n\n<pre><code>'Format Measured\n Dim rg As Range\n Dim cond1 As FormatCondition, cond2 As FormatCondition, cond3 As FormatCondition\n Set rg = Range(\"G14\", Range(\"G14\").End(xlDown))\n\n'clear any existing conditional formatting\nrg.FormatConditions.Delete\n\n'define the rule for each conditional format\nSet cond1 = rg.FormatConditions.Add(xlCellValue, xlGreater, \"=$D14+$E14+$H14\")\nSet cond2 = rg.FormatConditions.Add(xlCellValue, xlLess, \"=$D14-$F14\")\n\n'define the format applied for each conditional format\nWith cond1\n.Font.FontStyle = \"Bold\"\n.Font.Color = vbRed\nEnd With\n\nWith cond2\n.Font.FontStyle = \"Bold\"\n.Font.Color = vbRed\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7862651, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Fz63LcXOXTg/AAAAAAAAAAI/AAAAAAAADL0/Mdv3efKfB4g/photo.jpg?sz=128", "display_name": "Vanessa Goncalves", "link": "https://stackoverflow.com/users/7862651/vanessa-goncalves"}, "edited": false, "score": 0, "creation_date": 1574269044, "post_id": 58957160, "comment_id": 104174519, "body": "The lists of stores would be in the sheet &quot;aux&quot; starting on the column &quot;AF&quot;. On the same workbook. The change its going to be on the cell  &quot;B2&quot; on the sheet &quot;Tabela - M&#233;dia Mensal&quot;"}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 23, "user_id": 7862651, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Fz63LcXOXTg/AAAAAAAAAAI/AAAAAAAADL0/Mdv3efKfB4g/photo.jpg?sz=128", "display_name": "Vanessa Goncalves", "link": "https://stackoverflow.com/users/7862651/vanessa-goncalves"}, "edited": false, "score": 1, "creation_date": 1574273126, "post_id": 58957160, "comment_id": 104176679, "body": "Can you better explain the scenario you need to be implemented? Shell we understand that in column &quot;AF:AF&quot; there will be strings meaning what you say &#39;stores&#39;? Starting from the &quot;AF2&quot; and going down. For each such a &#39;Store&#39; do you need to run the above code replacing &#39;Worksheets(&quot;Tabela - M&#233;dia Mensal&quot;).Range(&quot;B2&quot;).value&#39; with the string found in each AF column cell?"}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 23, "user_id": 7862651, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Fz63LcXOXTg/AAAAAAAAAAI/AAAAAAAADL0/Mdv3efKfB4g/photo.jpg?sz=128", "display_name": "Vanessa Goncalves", "link": "https://stackoverflow.com/users/7862651/vanessa-goncalves"}, "edited": false, "score": 1, "creation_date": 1574273545, "post_id": 58957160, "comment_id": 104176911, "body": "And where do you need to manually write `a value&#39;...? In &quot;Worksheets(&quot;Tabela - M&#233;dia Mensal&quot;).Range(&quot;B2&quot;)&quot; cell?"}, {"owner": {"reputation": 23, "user_id": 7862651, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Fz63LcXOXTg/AAAAAAAAAAI/AAAAAAAADL0/Mdv3efKfB4g/photo.jpg?sz=128", "display_name": "Vanessa Goncalves", "link": "https://stackoverflow.com/users/7862651/vanessa-goncalves"}, "edited": false, "score": 0, "creation_date": 1574335418, "post_id": 58957160, "comment_id": 104200967, "body": "At this moment im writing, manually, around 60 stores, and running the macro where it hides the sheets i want to hide, delete the data from other stores, and save a new workbook with this changes... And this is time consuming, so wanted to stop writing manually the store name. Yes the column is on AF:AF, and its starting at &quot;AF1&quot;. Yes, for each store i need to run the code, so the data its delete from other stores and then hides the data sheets, only showing tables and the charts"}, {"owner": {"reputation": 23, "user_id": 7862651, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Fz63LcXOXTg/AAAAAAAAAAI/AAAAAAAADL0/Mdv3efKfB4g/photo.jpg?sz=128", "display_name": "Vanessa Goncalves", "link": "https://stackoverflow.com/users/7862651/vanessa-goncalves"}, "edited": false, "score": 0, "creation_date": 1574335449, "post_id": 58957160, "comment_id": 104200982, "body": "I write the name of the store in the cell you mention:   &quot;Worksheets(&quot;Tabela - M&#233;dia Mensal&quot;).Range(&quot;B2&quot;)&quot;"}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 23, "user_id": 7862651, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Fz63LcXOXTg/AAAAAAAAAAI/AAAAAAAADL0/Mdv3efKfB4g/photo.jpg?sz=128", "display_name": "Vanessa Goncalves", "link": "https://stackoverflow.com/users/7862651/vanessa-goncalves"}, "edited": false, "score": 1, "creation_date": 1574336827, "post_id": 58957160, "comment_id": 104201717, "body": "OK. It is not so complicate. In some minutes  I will post the code. Basically, the existing code must be modified in order to accept a parameter (store) which will replace your existing range. Then, another sub introducing the specified column cells values in an array and then iterate for each of them in order to call the existing modified one..."}], "tags": [], "owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "is_accepted": false, "score": 0, "last_activity_date": 1574261492, "creation_date": 1574261492, "answer_id": 58957160, "question_id": 58956762, "link": "https://stackoverflow.com/questions/58956762/vba-change-cell-based-on-a-list-and-then-save-a-new-workbook-based-on-that-cel/58957160#58957160", "title": "VBA - Change Cell based on a list and then save a new workbook based on that cell / list", "body": "<p>Would that 'list of stores' be another excel workbook/sheet?\nDo we have to deduce where the 'store' in discussion exists in your workbook?\nIsn't it better you to describe where the change must be done?</p>\n\n<p>Of course, this is not an answer but I do not know how else I can clarify the issue...</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 7862651, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Fz63LcXOXTg/AAAAAAAAAAI/AAAAAAAADL0/Mdv3efKfB4g/photo.jpg?sz=128", "display_name": "Vanessa Goncalves", "link": "https://stackoverflow.com/users/7862651/vanessa-goncalves"}, "edited": false, "score": 0, "creation_date": 1574348650, "post_id": 58974417, "comment_id": 104208961, "body": "Im finishing something urgent, but after i finish it i will test it and give feedback."}, {"owner": {"reputation": 23, "user_id": 7862651, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Fz63LcXOXTg/AAAAAAAAAAI/AAAAAAAADL0/Mdv3efKfB4g/photo.jpg?sz=128", "display_name": "Vanessa Goncalves", "link": "https://stackoverflow.com/users/7862651/vanessa-goncalves"}, "edited": false, "score": 0, "creation_date": 1574348667, "post_id": 58974417, "comment_id": 104208974, "body": "Just one question at this moment when i run the macro in the the workbook is saved as and the &quot;template&quot; workbook is closed. This will still happen, and if it do it will still run the macro to all the stores? (thank you so much for the help :))"}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 23, "user_id": 7862651, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Fz63LcXOXTg/AAAAAAAAAAI/AAAAAAAADL0/Mdv3efKfB4g/photo.jpg?sz=128", "display_name": "Vanessa Goncalves", "link": "https://stackoverflow.com/users/7862651/vanessa-goncalves"}, "edited": false, "score": 0, "creation_date": 1574349485, "post_id": 58974417, "comment_id": 104209462, "body": "I must confess I did not look too much to the code itself... And your question is a good one.  I am afraid it will not work in this circumstances. But it must be a work around. The code must be run from a different workbook, remaining open for all the process. The code will not refer to the AcctiveDocument. You will receive a InputBox/MsgBox giving you the possibility to choose the document from the range of the opened ones. Then, after processing of each store the workbook will be saved with each appropriate name and the master (let as say) workbook will be opened again and reprocessed."}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 23, "user_id": 7862651, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Fz63LcXOXTg/AAAAAAAAAAI/AAAAAAAADL0/Mdv3efKfB4g/photo.jpg?sz=128", "display_name": "Vanessa Goncalves", "link": "https://stackoverflow.com/users/7862651/vanessa-goncalves"}, "edited": false, "score": 0, "creation_date": 1574349514, "post_id": 58974417, "comment_id": 104209481, "body": "But now I must live the office. I will look at it after some hours and I will give you a sign here, with a new code..."}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 23, "user_id": 7862651, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Fz63LcXOXTg/AAAAAAAAAAI/AAAAAAAADL0/Mdv3efKfB4g/photo.jpg?sz=128", "display_name": "Vanessa Goncalves", "link": "https://stackoverflow.com/users/7862651/vanessa-goncalves"}, "edited": false, "score": 0, "creation_date": 1575118539, "post_id": 58974417, "comment_id": 104462811, "body": "@Vanessa Goncalves: Did you receive the addin and using instructions? I can see that our discussion has been moved to chat. I sent you a message there but no answer. So, did you see my comment with the link to the files? If not, this is the link: <a href=\"https://wetransfer.com/downloads/243fd0260687fcb408fdbf096e3a7fe520191129194240/dc2e5fb51d404af6ad074464a2000cf620191129194241/33668d?utm_campaign=WT_email_tracking&amp;utm_content=general&amp;utm_medium=download_button&amp;utm_source=notify_recipient_email\" rel=\"nofollow noreferrer\">addin download</a>."}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 23, "user_id": 7862651, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Fz63LcXOXTg/AAAAAAAAAAI/AAAAAAAADL0/Mdv3efKfB4g/photo.jpg?sz=128", "display_name": "Vanessa Goncalves", "link": "https://stackoverflow.com/users/7862651/vanessa-goncalves"}, "edited": false, "score": 0, "creation_date": 1575119791, "post_id": 58974417, "comment_id": 104463110, "body": "@Vanessa Goncalves: In order to see the chat room where our conversation has been moved, you must go here <a href=\"https://chat.stackoverflow.com/rooms/203354/discussion-on-answer-by-faneduru-vba-change-cell-based-on-a-list-and-then-save\">our chat room</a>. When you want to find a chat room and no clue about its site address you can go here [chat site](chat.stackoverflow.com) and look for the discussion. It will be something like this: &quot;Discussion between...&quot; followed by something like this &quot;Importent from a comment discussion on...&quot;. I never used the stackoverflow chat until now, neither..."}], "tags": [], "owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "is_accepted": false, "score": 0, "last_activity_date": 1574337240, "creation_date": 1574337240, "answer_id": 58974417, "question_id": 58956762, "link": "https://stackoverflow.com/questions/58956762/vba-change-cell-based-on-a-list-and-then-save-a-new-workbook-based-on-that-cel/58974417#58974417", "title": "VBA - Change Cell based on a list and then save a new workbook based on that cell / list", "body": "<pre><code>Sub AutomaticallySelectStore()\n    Dim W As Workbook, Sh As Worksheet, store As Variant, Arr As Variant\n    Set W = ActiveWorkbook\n     Set Sh = W.Worksheets(\"Tabela - M\u00e9dia Mensal\")\n     Arr = Sh.Range(\"AF2:AF\" &amp; Sh.Range(\"AF2\").SpecialCells(xlCellTypeLastCell).Row)\n     For Each store In Arr\n        Nova_loja store\n     Next\nEnd Sub\n\nSub Nova_loja(store As Variant)\n\n   Dim sht As Worksheet, Fname As String, Cell As Range, cRange As Range\n\n    Application.ScreenUpdating = False\n    Application.DisplayStatusBar = False\n\n    With Range(\"K44:L66\")\n        .Cells.Copy\n        .Cells.PasteSpecial xlPasteValues\n    End With\n\n    Application.CutCopyMode = False\n\n  'filter and delete\n\n    Sheets(\"BD Geral\").Select\n    ActiveSheet.ListObjects(\"Table2\").Range.AutoFilter Field:=52, Criteria1:=\"&lt;&gt;\" &amp; store, Operator:=xlFilterValues\n\n    Application.DisplayAlerts = False\n    ActiveSheet.ListObjects(\"Table2\").DataBodyRange.SpecialCells(xlCellTypeVisible).Delete\n    Application.DisplayAlerts = True\n\n    ActiveSheet.ListObjects(\"Table2\").AutoFilter.ShowAllData\n\n    'filter and delete\n\n    Sheets(\"BD BONUS_MALUS\").Select\n    ActiveSheet.ListObjects(\"Table35\").Range.AutoFilter Field:=3, Criteria1:=\"&lt;&gt;\" &amp; Worksheets(\"Tabela - M\u00e9dia Mensal\").Range(\"B1\").Value, Operator:=xlFilterValues\n\n    Application.DisplayAlerts = False\n    ActiveSheet.ListObjects(\"Table35\").DataBodyRange.SpecialCells(xlCellTypeVisible).Delete\n    Application.DisplayAlerts = True\n\n    ActiveSheet.ListObjects(\"Table35\").AutoFilter.ShowAllData\n\n    'filter and delete\n\n    Sheets(\"BD NPS\").Select\n    ActiveSheet.ListObjects(\"Table3\").Range.AutoFilter Field:=2, Criteria1:=\"&lt;&gt;\" &amp; Worksheets(\"Tabela - M\u00e9dia Mensal\").Range(\"B1\").Value, Operator:=xlFilterValues\n\n    Application.DisplayAlerts = False\n    ActiveSheet.ListObjects(\"Table3\").DataBodyRange.SpecialCells(xlCellTypeVisible).Delete\n    Application.DisplayAlerts = True\n\n    ActiveSheet.ListObjects(\"Table3\").AutoFilter.ShowAllData\n\n    Sheets(\"BD Dept\").Select\n    ActiveSheet.ListObjects(\"Table4\").Range.AutoFilter Field:=8, Criteria1:=\"&lt;&gt;\" &amp; Worksheets(\"Tabela - M\u00e9dia Mensal\").Range(\"B1\").Value, Operator:=xlFilterValues\n\n    Application.DisplayAlerts = False\n    ActiveSheet.ListObjects(\"Table4\").DataBodyRange.SpecialCells(xlCellTypeVisible).Delete\n    Application.DisplayAlerts = True\n\n    ActiveSheet.ListObjects(\"Table4\").AutoFilter.ShowAllData\n\n    'refresh pivots\n\n    ThisWorkbook.RefreshAll\n\n    'hide sheets\n\n    For Each sht In ThisWorkbook.Worksheets\n    If sht.Name &lt;&gt; \"Dashboard\" And sht.Name &lt;&gt; \"Tabela - M\u00e9dia Mensal\" Then\n    sht.Visible = xlSheetVeryHidden\n    End If\n    Next sht\n\n    'protect sheets\n\n    For Each sht In ActiveWorkbook.Sheets\n       sht.Protect Password:=\"fnacrh\", AllowSorting:=True, AllowFiltering:=True, AllowUsingPivotTables:=True\n    Next\n\n    'leave active main worksheet\n\n    Sheets(\"Dashboard\").Select\n\n    'save as with new name\n\n    Application.DisplayAlerts = False\n\n    Fname = ThisWorkbook.Path &amp; \"\\\" &amp; \"02.VIM_REPORT MENSAL - \" &amp; Worksheets(\"aux\").Range(\"V2\") &amp; \" - \" &amp; Worksheets(\"aux\").Range(\"V3\") &amp; \".xlsx\"\n    ActiveWorkbook.SaveAs Filename:=Fname, FileFormat:=xlWorkbookDefault\n\n    Application.DisplayAlerts = True\n    Application.DisplayStatusBar = True\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>So, you must run <code>'AutomaticallySelectStore'</code> procedure and wait...\nI do not have such a file in order to test it, so, it is a code based only on VBA logic and my understanding about your situation.\nDepending on how big are your workbooks it may load your system RAM and CPU, working continuously. I am waiting for some feedback.\nThe initial code can also be optimized a little, but let us see how it works now.</p>\n"}, {"comments": [{"owner": {"reputation": 67968, "user_id": 584192, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YBSIc.png?s=128&g=1", "display_name": "Samuel Liew", "link": "https://stackoverflow.com/users/584192/samuel-liew"}, "edited": false, "score": 0, "creation_date": 1575059235, "post_id": 58982914, "comment_id": 104452460, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/203354/discussion-on-answer-by-faneduru-vba-change-cell-based-on-a-list-and-then-save\">moved to chat</a>."}], "tags": [], "owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "is_accepted": true, "score": 1, "last_activity_date": 1575027823, "last_edit_date": 1575027823, "creation_date": 1574366652, "answer_id": 58982914, "question_id": 58956762, "link": "https://stackoverflow.com/questions/58956762/vba-change-cell-based-on-a-list-and-then-save-a-new-workbook-based-on-that-cel/58982914#58982914", "title": "VBA - Change Cell based on a list and then save a new workbook based on that cell / list", "body": "<p>The next code would do what I understood you need.\nCopy the next code in a module of another workbook, different from the one to be processed, and run <code>AutomaticallySelectStore</code> procedure. An InputBox will appear asking to select the number from the right side of the workbook name to be processed. </p>\n\n<pre><code>   Sub AutomaticallySelectStore()\n            Dim w As Workbook, Wb As Workbook, sh As Worksheet, store As Variant, Arr As Variant, Ans As String\n            Dim i As Long, strWorkb As String, strWbName As String, strWbPath As String, nrStores As Long\n\n            strWorkb = \"Please write the number of the workbook needed to be processed:\" &amp; vbCrLf &amp; vbCrLf\n\n            For Each Wb In Workbooks\n                i = i + 1\n                strWorkb = strWorkb &amp; Wb.name &amp; \" - \" &amp; i &amp; vbCrLf\n            Next\n            strWorkb = left(strWorkb, Len(strWorkb) - 1)\n            Ans = InputBox(strWorkb, \"Necessary workbook selection\", 1)\n              If Ans = \"\" Then MsgBox \"You did not select anything...\", vbInformation, \"No workbook selected\": Exit Sub\n              If Not IsNumeric(Ans) Then\n                MsgBox \"You must write the number from the right side of the needed workbook name!\", vbInformation, _\n                        \"Wrong choice...\": Exit Sub\n              ElseIf Ans &gt; Workbooks.Count Then\n                MsgBox \"You must write a number less or equal with \" &amp; Workbooks.Count, vbInformation, _\n                        \"Wrong chosen number\": Exit Sub\n              End If\n\n            Set w = Workbooks(CLng(Ans))\n\n             On Error Resume Next\n               Set sh = w.Worksheets(\"aux\")\n             If Err.Number &lt;&gt; 0 Then\n                Err.Clear: On Error GoTo 0\n                MsgBox \"The chosen workbook looks to be wrong...\" &amp; vbCrLf &amp; _\n                       \" Worksheet \"\"Tabela - M\u00e9dia Mensal\"\" is missing.\", vbInformation, _\n                       \"Wrong workbook or necessary worksheet missing\": Exit Sub\n             End If\n             On Error GoTo 0\n\n             strWbName = w.FullName\n             nrStores = sh.Range(\"AF2\").End(xlDown).Row\n             Arr = sh.Range(\"AF2:AF\" &amp; nrStores)\n             w.Activate\n             i = 0\n             Application.Calculation = xlCalculationManual\n              For Each store In Arr\n                i = i + 1\n                Nova_loja strWbName, store, i, nrStores - 1\n              Next\n             Application.Calculation = xlCalculationAutomatic\n             Application.StatusBar = \"Ready...\"\n        End Sub\n\n    Sub Nova_loja(strWbName As String, store As Variant, No As Long, NrPag As Long)\n\n       Dim sht As Worksheet, fName As String, Cell As Range, cRange As Range\n       Dim w As Workbook, Wb As Workbook, boolFound As Boolean, shortName As String\n       Dim Arr As Variant, shAr As Worksheet, shortWbName As String\n\n       shortWbName = Right(strWbName, Len(strWbName) - InStrRev(strWbName, \"\\\"))\n       For Each Wb In Workbooks\n            If Wb.FullName = strWbName Then\n                Set w = Wb: boolFound = True: Exit For\n            End If\n       Next\n       If Not boolFound Then\n            Set w = Workbooks.Open(strWbName)\n       End If\n\n        Application.ScreenUpdating = False\n\n        Application.StatusBar = \"Working on \" &amp; store &amp; \" store (\" &amp; No &amp; \" of \" &amp; NrPag &amp; \")...\"\n        Application.CalculateBeforeSave = True\n\n\n        Set shAr = Workbooks(shortWbName).Worksheets(\"aux\")\n        Arr = shAr.Range(\"K44:L66\")\n        shAr.Range(\"K44:L66\") = Arr\n\n\n        Sheets(\"Tabela - M\u00e9dia Mensal\").Range(\"B2\").Value = store\n\n        Sheets(\"BD Geral\").ListObjects(\"Table2\").Range.AutoFilter field:=52, Criteria1:=\"&lt;&gt;\" &amp; store, _\n                                                                                    Operator:=xlFilterValues\n\n        Application.DisplayAlerts = False\n          Sheets(\"BD Geral\").ListObjects(\"Table2\").DataBodyRange.SpecialCells(xlCellTypeVisible).Delete\n          Sheets(\"BD Geral\").ListObjects(\"Table2\").AutoFilter.ShowAllData 'it returns an error if no filter is applied\n        Application.DisplayAlerts = True\n\n        'filter and delete\n        Sheets(\"BD BONUS_MALUS\").ListObjects(\"Table35\").Range.AutoFilter field:=3, Criteria1:=\"&lt;&gt;\" &amp; Worksheets(\"Tabela - M\u00e9dia Mensal\").Range(\"B1\").Value, Operator:=xlFilterValues\n\n        Application.DisplayAlerts = False\n         Sheets(\"BD BONUS_MALUS\").ListObjects(\"Table35\").DataBodyRange.SpecialCells(xlCellTypeVisible).Delete\n        Application.DisplayAlerts = True\n\n        Sheets(\"BD BONUS_MALUS\").ListObjects(\"Table35\").AutoFilter.ShowAllData\n\n        'filter and delete\n        Sheets(\"BD NPS\").ListObjects(\"Table3\").Range.AutoFilter field:=2, Criteria1:=\"&lt;&gt;\" &amp; Worksheets(\"Tabela - M\u00e9dia Mensal\").Range(\"B1\").Value, Operator:=xlFilterValues\n\n        Application.DisplayAlerts = False\n         Sheets(\"BD NPS\").ListObjects(\"Table3\").DataBodyRange.SpecialCells(xlCellTypeVisible).Delete\n        Application.DisplayAlerts = True\n\n        Sheets(\"BD NPS\").ListObjects(\"Table3\").AutoFilter.ShowAllData\n\n        'This sheet does not contain any \"Table\"...\n        Sheets(\"BD Dept\").ListObjects(\"Table4\").Range.AutoFilter field:=8, Criteria1:=\"&lt;&gt;\" &amp; Worksheets(\"Tabela - M\u00e9dia Mensal\").Range(\"B1\").Value, Operator:=xlFilterValues\n\n        Application.DisplayAlerts = False\n         Sheets(\"BD Dept\").ListObjects(\"Table4\").DataBodyRange.SpecialCells(xlCellTypeVisible).Delete\n        Application.DisplayAlerts = True\n\n        Sheets(\"BD Dept\").ListObjects(\"Table4\").AutoFilter.ShowAllData\n\n        'hide sheets\n        For Each sht In w.Worksheets\n            If sht.name &lt;&gt; \"Dashboard\" And sht.name &lt;&gt; \"Tabela - M\u00e9dia Mensal\" Then\n                sht.Visible = xlSheetVeryHidden\n            End If\n        Next sht\n\n        'protect sheets\n        For Each sht In ActiveWorkbook.Sheets\n           sht.Protect Password:=\"fnacrh\", AllowSorting:=True, AllowFiltering:=True, AllowUsingPivotTables:=True\n        Next\n\n        'leave active main worksheet\n        Sheets(\"Dashboard\").Select\n\n        w.RefreshAll\n\n        shortName = \"02.VIM_REPORT MENSAL - \" &amp; store &amp; \" - \" &amp; Worksheets(\"aux\").Range(\"V3\") &amp; \".xlsx\"\n        fName = w.Path &amp; \"\\\" &amp; shortName\n         Application.DisplayAlerts = False\n          ActiveWorkbook.SaveAs Filename:=fName, FileFormat:=xlWorkbookDefault\n          Workbooks(shortName).Close , False\n        Application.DisplayAlerts = True\n\n        Application.DisplayStatusBar = True\n        Application.ScreenUpdating = True\n    End Sub\n</code></pre>\n\n<p>Please, test it and confirm if it works as expected.\nIf not, mention what wrong happens.</p>\n"}], "owner": {"reputation": 23, "user_id": 7862651, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Fz63LcXOXTg/AAAAAAAAAAI/AAAAAAAADL0/Mdv3efKfB4g/photo.jpg?sz=128", "display_name": "Vanessa Goncalves", "link": "https://stackoverflow.com/users/7862651/vanessa-goncalves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 1, "accepted_answer_id": 58982914, "answer_count": 3, "score": 0, "last_activity_date": 1575027823, "creation_date": 1574260360, "last_edit_date": 1574260391, "question_id": 58956762, "link": "https://stackoverflow.com/questions/58956762/vba-change-cell-based-on-a-list-and-then-save-a-new-workbook-based-on-that-cel", "title": "VBA - Change Cell based on a list and then save a new workbook based on that cell / list", "body": "<p>I have a workbook already with a macro that does several things based on a cell value:</p>\n\n<p>When i change a cell value (its a store name) the code will filter several sheets with, just to show the store of that specific cell, then hides several sheets. \nJust showing 2 specific sheets.\nAnd in the end of the code i save a new workbook with the name of that store.</p>\n\n<p>My question is:</p>\n\n<p>Is it possible to change my code (shown below), so i dont have to write manually the name of the store, ie, i want that the macro sees a list of stores, then change the cell with each store, do all the tasks i want, and then writes a new workbook with that store name, and so on, until the end of the list store?</p>\n\n<p>Thank you so much</p>\n\n<p>(PS: im new in vba, so my code probably is a little rough around the edges)</p>\n\n<pre><code>Sub Nova_loja()\n\n   Dim sht As Worksheet\n   Dim Fname As String\n   Dim Cell As Range, cRange As Range\n\n    Application.ScreenUpdating = False\n    Application.DisplayStatusBar = False\n\n    'copy past in values\n\n    With Range(\"K44:L66\")\n        .Cells.Copy\n        .Cells.PasteSpecial xlPasteValues\n    End With\n\n    Application.CutCopyMode = False\n\n  'filter and delete\n\n    Sheets(\"BD Geral\").Select\n    ActiveSheet.ListObjects(\"Table2\").Range.AutoFilter Field:=52, Criteria1:=\"&lt;&gt;\" &amp; Worksheets(\"Tabela - M\u00e9dia Mensal\").Range(\"B2\").value, Operator:=xlFilterValues\n\n    Application.DisplayAlerts = False\n    ActiveSheet.ListObjects(\"Table2\").DataBodyRange.SpecialCells(xlCellTypeVisible).Delete\n    Application.DisplayAlerts = True\n\n    ActiveSheet.ListObjects(\"Table2\").AutoFilter.ShowAllData\n\n    'filter and delete\n\n    Sheets(\"BD BONUS_MALUS\").Select\n    ActiveSheet.ListObjects(\"Table35\").Range.AutoFilter Field:=3, Criteria1:=\"&lt;&gt;\" &amp; Worksheets(\"Tabela - M\u00e9dia Mensal\").Range(\"B1\").value, Operator:=xlFilterValues\n\n    Application.DisplayAlerts = False\n    ActiveSheet.ListObjects(\"Table35\").DataBodyRange.SpecialCells(xlCellTypeVisible).Delete\n    Application.DisplayAlerts = True\n\n\n    ActiveSheet.ListObjects(\"Table35\").AutoFilter.ShowAllData\n\n\n    'filter and delete\n\n    Sheets(\"BD NPS\").Select\n    ActiveSheet.ListObjects(\"Table3\").Range.AutoFilter Field:=2, Criteria1:=\"&lt;&gt;\" &amp; Worksheets(\"Tabela - M\u00e9dia Mensal\").Range(\"B1\").value, Operator:=xlFilterValues\n\n    Application.DisplayAlerts = False\n    ActiveSheet.ListObjects(\"Table3\").DataBodyRange.SpecialCells(xlCellTypeVisible).Delete\n    Application.DisplayAlerts = True\n\n    ActiveSheet.ListObjects(\"Table3\").AutoFilter.ShowAllData\n\n\n    Sheets(\"BD Dept\").Select\n    ActiveSheet.ListObjects(\"Table4\").Range.AutoFilter Field:=8, Criteria1:=\"&lt;&gt;\" &amp; Worksheets(\"Tabela - M\u00e9dia Mensal\").Range(\"B1\").value, Operator:=xlFilterValues\n\n    Application.DisplayAlerts = False\n    ActiveSheet.ListObjects(\"Table4\").DataBodyRange.SpecialCells(xlCellTypeVisible).Delete\n    Application.DisplayAlerts = True\n\n    ActiveSheet.ListObjects(\"Table4\").AutoFilter.ShowAllData\n\n\n\n\n    'refresh pivots\n\n    ThisWorkbook.RefreshAll\n\n\n    'hide sheets\n\n    For Each sht In ThisWorkbook.Worksheets\n    If sht.Name &lt;&gt; \"Dashboard\" And sht.Name &lt;&gt; \"Tabela - M\u00e9dia Mensal\" Then\n    sht.Visible = xlSheetVeryHidden\n    End If\n    Next sht\n\n\n\n    'protect sheets\n\n    For Each sht In ActiveWorkbook.Sheets\n       sht.Protect Password:=\"fnacrh\", AllowSorting:=True, AllowFiltering:=True, AllowUsingPivotTables:=True\n    Next\n\n\n\n    'leave active main worksheet\n\n    Sheets(\"Dashboard\").Select\n\n\n\n    'save as with new name\n\n    Application.DisplayAlerts = False\n\n\n\n\n\n    Fname = ThisWorkbook.Path &amp; \"\\\" &amp; \"02.VIM_REPORT MENSAL - \" &amp; Worksheets(\"aux\").Range(\"V2\") &amp; \" - \" &amp; Worksheets(\"aux\").Range(\"V3\") &amp; \".xlsx\"\n    ActiveWorkbook.SaveAs Filename:=Fname, FileFormat:=xlWorkbookDefault\n\n\n\n\n\n\n\n    Application.DisplayAlerts = True\n\n\n    Application.DisplayStatusBar = True\n    Application.ScreenUpdating = True\n\n\n\n\nEnd Sub\n</code></pre>\n\n<p>Thank you so much</p>\n"}, {"tags": ["excel", "vba", "pdf", "printing"], "comments": [{"owner": {"reputation": 9, "user_id": 5312830, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2nli5.jpg?s=128&g=1", "display_name": "Arkadiusz Iwanowski", "link": "https://stackoverflow.com/users/5312830/arkadiusz-iwanowski"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1574260864, "post_id": 58956745, "comment_id": 104169374, "body": "Unfortunately no. I don&#39;t need to print sheets to pdf. I need to use excel VBA to print specific pages from existing pdf file."}], "answers": [{"tags": [], "owner": {"reputation": 327, "user_id": 8571717, "user_type": "registered", "profile_image": "https://graph.facebook.com/1524531667605038/picture?type=large", "display_name": "Kirill Tkachenko", "link": "https://stackoverflow.com/users/8571717/kirill-tkachenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1574262008, "creation_date": 1574262008, "answer_id": 58957351, "question_id": 58956745, "link": "https://stackoverflow.com/questions/58956745/printing-specific-pages-form-pdf-file-using-print-scope-string/58957351#58957351", "title": "printing specific pages form pdf file using print scope string", "body": "<p>Judging from <a href=\"https://stackoverflow.com/a/50366592/8571717\">this post</a>, it is not possible using <code>ShellExecute</code> alone. What you would need is to write a script which will open the file in whatever PDF reader you have installed, find a \"Print\" button there and provide all the options. This will take a huge amount of work and will depend on the version of Windows and the PDF reader, so basically it will work only for you, and not for other users.\nIf you want to go this path though, take a look at <code>FindWindow</code> and <code>SendMessage</code> WinAPI functions. </p>\n"}], "owner": {"reputation": 9, "user_id": 5312830, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2nli5.jpg?s=128&g=1", "display_name": "Arkadiusz Iwanowski", "link": "https://stackoverflow.com/users/5312830/arkadiusz-iwanowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574262008, "creation_date": 1574260327, "last_edit_date": 1574260675, "question_id": 58956745, "link": "https://stackoverflow.com/questions/58956745/printing-specific-pages-form-pdf-file-using-print-scope-string", "title": "printing specific pages form pdf file using print scope string", "body": "<p>I need to print selected pages of *.pdf file using excel VBA.\nI need to do this not by providing scope \"from - to\" but giving scoope of pages like \"1-3,4,8, 17-25\" </p>\n\n<p>I can only print whole file using below code:</p>\n\n<pre><code>Public Declare Function ShellExecute Lib \"shell32.dll\" Alias \"ShellExecuteA\" ( _\nByVal hwnd As Long, _\nByVal lpOperation As String, _\nByVal lpFile As String, _\nByVal lpParameters As String, _\nByVal lpDirectory As String, _\nByVal nShowCmd As Long) As Long\n\nPublic Function PrintThisDoc(formname As Long, FileName As String)\nOn Error Resume Next\nDim X As Long\nX = ShellExecute(formname, \"Print\", FileName, 0&amp;, 0&amp;, 3)\nEnd Function\n\nSub testPrint()\nDim printThis\nDim strDir As String\nDim strFile As String\nstrDir = \"C:\\Users\\any\\Desktop\"\nstrFile = \"somefile.pdf\"\n\n\nprintThis = PrintThisDoc(0, strDir &amp; \"\\\" &amp; strFile)\nEnd Sub ```\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1574260316, "post_id": 58956715, "comment_id": 104169017, "body": "Use <code>Select Case</code> or <code>If...ElseIf...End If</code>."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1574260459, "post_id": 58956715, "comment_id": 104169106, "body": "What do you mean with &quot;different&quot;. What are your options? Can you elaborate, because then we can help you even more specifically =)"}, {"owner": {"reputation": 127, "user_id": 3281441, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/bbede7dd4a74e75c0ab3afee82d7adbe?s=128&d=identicon&r=PG&f=1", "display_name": "Sherbetdab", "link": "https://stackoverflow.com/users/3281441/sherbetdab"}, "edited": false, "score": 0, "creation_date": 1574261550, "post_id": 58956715, "comment_id": 104169785, "body": "If B19 = Open range(B5:B17,B20:B24) and if Closed then as it is in my code"}], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 3281441, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/bbede7dd4a74e75c0ab3afee82d7adbe?s=128&d=identicon&r=PG&f=1", "display_name": "Sherbetdab", "link": "https://stackoverflow.com/users/3281441/sherbetdab"}, "edited": false, "score": 1, "creation_date": 1574264466, "post_id": 58957184, "comment_id": 104171737, "body": "Thanks very much, that\u2019s fine the trick. I\u2019m still learning so cheers."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1574261557, "creation_date": 1574261557, "answer_id": 58957184, "question_id": 58956715, "link": "https://stackoverflow.com/questions/58956715/change-range-depending-on-cell-value/58957184#58957184", "title": "Change range depending on cell value", "body": "<p>Not sure what you're stuck on as you don't specify, you just need an <code>If</code> clause along these lines:</p>\n\n<pre><code>Sub AreYouSure()\n\nDim myCellRange As Range\n\nWith ThisWorkbook.Worksheets(\"Input\")\n    If .Range(\"B19\").Value = \"Closed\" Then  'assuming it's B19 on the same sheet ...\n        Set myCellRange = .Range(\"B5:B21,B23:B26\")\n        If WorksheetFunction.CountA(myCellRange) &lt; myCellRange.Count Then\n            myCellRange.SpecialCells(xlCellTypeBlanks).Interior.ColorIndex = 3\n            MsgBox \"Please Enter Data In Red Cells And Then Update.\"\n            Exit Sub\n        End If\n    ElseIf .Range(\"B19\").Value = \"Open\" Then\n        'Set myCellRange = ...\n        'whatever\n    End If\nEnd With\n\nCall UpdateRecords\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "is_accepted": false, "score": 1, "last_activity_date": 1574261965, "creation_date": 1574261965, "answer_id": 58957336, "question_id": 58956715, "link": "https://stackoverflow.com/questions/58956715/change-range-depending-on-cell-value/58957336#58957336", "title": "Change range depending on cell value", "body": "<pre><code>Sub AreYouSure()\n\n  Dim myCellRange As Range\n\n'identify cell range you work with\nIf Thisworkbook.Worksheets(\"Input\").Range(\"B19\") = \"Open\" then\n   Set myCellRange = ThisWorkbook.Worksheets(\"Input\").Range(\"B5:B17,B20:B24\")   \nElse\n   Set myCellRange = ThisWorkbook.Worksheets(\"Input\").Range(\"B5:B21,B23:B26\")\nEnd If\n\n'check if number of non-empty cells in range is less than total number of cells in range. Depending on result, display message box indicating whether cell range contains any empty cell (True) or not (False)\nIf WorksheetFunction.CountA(myCellRange) &lt; myCellRange.Count Then\n\nmyCellRange.SpecialCells(xlCellTypeBlanks).Interior.ColorIndex = 3\n\n    MsgBox \"Please Enter Data In Red Cells And Then Update.\"\n\n  Exit Sub\n\n End If\n\n  Call UpdateRecords\n\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 127, "user_id": 3281441, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/bbede7dd4a74e75c0ab3afee82d7adbe?s=128&d=identicon&r=PG&f=1", "display_name": "Sherbetdab", "link": "https://stackoverflow.com/users/3281441/sherbetdab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 58957184, "answer_count": 2, "score": 0, "last_activity_date": 1574264067, "creation_date": 1574260226, "last_edit_date": 1574264067, "question_id": 58956715, "link": "https://stackoverflow.com/questions/58956715/change-range-depending-on-cell-value", "title": "Change range depending on cell value", "body": "<p>The code below highlights cells that are left blank when button is clicked. I need <code>myCellRange</code> to be different depending if cell B19 has \u2018Open\u2019 or \u2018Closed\u2019.</p>\n\n<p>Can anyone point me in the right direction please?</p>\n\n<pre><code>Sub AreYouSure()\n\nDim myCellRange As Range\n\n'identify cell range you work with\nSet myCellRange = ThisWorkbook.Worksheets(\"Input\").Range(\"B5:B21,B23:B26\")\n\n'check if number of non-empty cells in range is less than total number of cells in range.\n'Depending on result, display message box indicating whether cell range contains any empty\n'cell (True) or not (False)\n\nIf WorksheetFunction.CountA(myCellRange) &lt; myCellRange.Count Then\n\n    myCellRange.SpecialCells(xlCellTypeBlanks).Interior.ColorIndex = 3\n\n    MsgBox \"Please Enter Data In Red Cells And Then Update.\"\n\n    Exit Sub\n\nEnd If\n\nCall UpdateRecords\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574258644, "post_id": 58956173, "comment_id": 104167971, "body": "Don&#39;t use <code>Windows(&quot;Workbook2&quot;).Activate</code> - see <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">this question</a> for how to properly reference workbooks and worksheets."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1574258717, "post_id": 58956173, "comment_id": 104168020, "body": "What do you mean by copy all comments?"}, {"owner": {"reputation": 81, "user_id": 12042134, "user_type": "registered", "profile_image": "https://graph.facebook.com/2538694236190596/picture?type=large", "display_name": "MooChang Park", "link": "https://stackoverflow.com/users/12042134/moochang-park"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1574258818, "post_id": 58956173, "comment_id": 104168073, "body": "@Davesexcel The memos in cells:)"}, {"owner": {"reputation": 331, "user_id": 7834321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/147fb04269e2225ecafbcf20dfbbd76d?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Nevins", "link": "https://stackoverflow.com/users/7834321/tim-nevins"}, "edited": false, "score": 0, "creation_date": 1574259366, "post_id": 58956173, "comment_id": 104168411, "body": "Record using Home &gt; Find &amp; Select &gt; Go To Special... and select Notes from the selection. Then Copy and paste. Not sure if this will really work.... Excel help says Notes is equivalent to Comments. I just tried this. It copies the entire cell contents and the not just the note. Apparently, Notes are what have always been comments. Comments are now some way of attaching commentary from multiple people to a cell."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1574259623, "post_id": 58956173, "comment_id": 104168604, "body": "I&#39;m still not sure if you are talking about comments in a cell, or notations in a cell"}], "answers": [{"comments": [{"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 1, "creation_date": 1574262081, "post_id": 58956638, "comment_id": 104170151, "body": "Yes, it is correct. I just wanted to bring him in the sheet keeping the result."}, {"owner": {"reputation": 81, "user_id": 12042134, "user_type": "registered", "profile_image": "https://graph.facebook.com/2538694236190596/picture?type=large", "display_name": "MooChang Park", "link": "https://stackoverflow.com/users/12042134/moochang-park"}, "edited": false, "score": 0, "creation_date": 1574262270, "post_id": 58956638, "comment_id": 104170273, "body": "@FaneDuru your code works perfectly too! Thank you both of you :) Geniuses in excel!"}], "tags": [], "owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "is_accepted": false, "score": 2, "last_activity_date": 1574260030, "creation_date": 1574260030, "answer_id": 58956638, "question_id": 58956173, "link": "https://stackoverflow.com/questions/58956173/is-there-a-way-to-copy-all-the-comments-in-one-workbook-to-another-workbook/58956638#58956638", "title": "Is there a way to copy all the comments in one workbook to another workbook?", "body": "<pre><code>Sub CopyComments()\nDim W As Workbook, W1 As Workbook, Sh As Worksheet, Sh1 As Worksheet\n    Set W = Workbooks(\"Workbook1.xlsx\")\n    Set W1 = Workbooks(\"Workbook2.xlsx\")\n      Set Sh = W.Worksheets(\"HR&amp;Finance\")\n      Set Sh1 = W1.Worksheets(\"Budget\")\n\n      Sh.UsedRange.Copy\n\n      W1.Activate: Sh1.Activate\n      Sh1.Range(\"A1\").PasteSpecial Paste:=xlPasteComments, Operation:=xlNone, _\n                                        SkipBlanks:=False, Transpose:=False\n      Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n\n<p>But, the structure of the page where the comments are pasted special must be the same with the one where from they are copied...</p>\n"}, {"comments": [{"owner": {"reputation": 81, "user_id": 12042134, "user_type": "registered", "profile_image": "https://graph.facebook.com/2538694236190596/picture?type=large", "display_name": "MooChang Park", "link": "https://stackoverflow.com/users/12042134/moochang-park"}, "edited": false, "score": 0, "creation_date": 1574261558, "post_id": 58956904, "comment_id": 104169793, "body": "Hi! thank you for the help. I copied the code and pasted in the vba of &quot;HR&amp;Finance&quot; worksheet in Workbook1 and ran the code but it says subscript out of range :("}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "reply_to_user": {"reputation": 81, "user_id": 12042134, "user_type": "registered", "profile_image": "https://graph.facebook.com/2538694236190596/picture?type=large", "display_name": "MooChang Park", "link": "https://stackoverflow.com/users/12042134/moochang-park"}, "edited": false, "score": 1, "creation_date": 1574261855, "post_id": 58956904, "comment_id": 104169994, "body": "You have to make sure the sheet names are correct and the workbook names, the code should also be in a regular module, not a worksheet module"}, {"owner": {"reputation": 81, "user_id": 12042134, "user_type": "registered", "profile_image": "https://graph.facebook.com/2538694236190596/picture?type=large", "display_name": "MooChang Park", "link": "https://stackoverflow.com/users/12042134/moochang-park"}, "edited": false, "score": 0, "creation_date": 1574262118, "post_id": 58956904, "comment_id": 104170174, "body": "super genius! thank you it works ! Learned a lot today from you:)"}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": true, "score": 1, "last_activity_date": 1574260720, "creation_date": 1574260720, "answer_id": 58956904, "question_id": 58956173, "link": "https://stackoverflow.com/questions/58956173/is-there-a-way-to-copy-all-the-comments-in-one-workbook-to-another-workbook/58956904#58956904", "title": "Is there a way to copy all the comments in one workbook to another workbook?", "body": "<p>I have used the same area as your code, and pasted the comments to the book2 cells. The comments will appear in the same place as the 1st workbook.</p>\n\n<p>If you wanted a list of comments, then we would have to do something else</p>\n\n<p>Assuming the code will be in the first workbook.</p>\n\n<pre><code>Sub CopyComments()\n    Dim bk1 As Workbook, bk2 As Workbook\n    Dim sh1 As Worksheet, sh2 As Worksheet\n\n    Set bk1 = ThisWorkbook\n    Set bk2 = Workbooks(\"Book2.xlsx\") ' change name of workbook\n    Set sh1 = bk1.Sheets(\"HR&amp;Finance\")\n    Set sh2 = bk2.Sheets(\"Budget\")\n\n    With sh1\n        .Range(\"A:Z\").SpecialCells(xlCellTypeConstants, 23).Copy\n        sh2.Range(\"A1\").PasteSpecial xlPasteComments\n    End With\n\n    Application.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 12042134, "user_type": "registered", "profile_image": "https://graph.facebook.com/2538694236190596/picture?type=large", "display_name": "MooChang Park", "link": "https://stackoverflow.com/users/12042134/moochang-park"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 58956904, "answer_count": 2, "score": 0, "last_activity_date": 1574260720, "creation_date": 1574258569, "last_edit_date": 1574259020, "question_id": 58956173, "link": "https://stackoverflow.com/questions/58956173/is-there-a-way-to-copy-all-the-comments-in-one-workbook-to-another-workbook", "title": "Is there a way to copy all the comments in one workbook to another workbook?", "body": "<p>Hi I am trying to copy all the comments in a worksheet(\"HR&amp;Finance\") in Workbook1 to another worksheet(\"Budget\") in Workbook2.</p>\n\n<p>So far I recorded the below code in the worksheet in workbook1 and ran the code with the two workbooks open but it says subscript out of range error...</p>\n\n<p>Can you give me some advice on how to fix this?</p>\n\n<p>Thank you!</p>\n\n<pre><code> Sub comment()\n'\n' comment Macro\n'\n\n'\n    Range(A:Z).Select\n    Selection.Copy\n    Windows(\"Workbook2\").Activate\n    Range(A:Z).Select\n    ActiveSheet.Paste\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql-server", "vba", "ms-access", "ms-access-2016"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1574256709, "post_id": 58955452, "comment_id": 104166752, "body": "Can you provide the field type for the recordset? And preferably, the entire code for <code>OpenMyRecordset</code>? Some recordset types (server-side cursors, forward-only recordsets) should not be used when filling a listbox."}, {"owner": {"reputation": 136, "user_id": 12404102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4092034588c3d8aaf8d88f1dba31b58b?s=128&d=identicon&r=PG&f=1", "display_name": "Ayam", "link": "https://stackoverflow.com/users/12404102/ayam"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1574257885, "post_id": 58955452, "comment_id": 104167490, "body": "I have added the extra information. The entire recordset code is in a module with interlinking functions. Therefore I only posted a link to the code, instead of flooding this page."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1574261600, "post_id": 58955452, "comment_id": 104169825, "body": "I&#39;ve removed my answer since it&#39;s not the solution. You might want to report this through official channels, since it&#39;s new behavior and Access has been plagued with another bug since the last Office update. This might be a new bug in Access."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1574262668, "post_id": 58955452, "comment_id": 104170533, "body": "Have you tried Compact&amp;Repair and <a href=\"https://stackoverflow.com/a/3268188/3820271\">Decompile</a> ?"}, {"owner": {"reputation": 3725, "user_id": 6777839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YYN3g.jpg?s=128&g=1", "display_name": "Wolfgang Kais", "link": "https://stackoverflow.com/users/6777839/wolfgang-kais"}, "edited": false, "score": 0, "creation_date": 1574292762, "post_id": 58955452, "comment_id": 104185110, "body": "What does &quot;crashing&quot; mean? Did you receive an error message? What did it say?"}, {"owner": {"reputation": 136, "user_id": 12404102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4092034588c3d8aaf8d88f1dba31b58b?s=128&d=identicon&r=PG&f=1", "display_name": "Ayam", "link": "https://stackoverflow.com/users/12404102/ayam"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1574323813, "post_id": 58955452, "comment_id": 104193946, "body": "@Andre I have tried that to no avail"}, {"owner": {"reputation": 136, "user_id": 12404102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4092034588c3d8aaf8d88f1dba31b58b?s=128&d=identicon&r=PG&f=1", "display_name": "Ayam", "link": "https://stackoverflow.com/users/12404102/ayam"}, "reply_to_user": {"reputation": 3725, "user_id": 6777839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YYN3g.jpg?s=128&g=1", "display_name": "Wolfgang Kais", "link": "https://stackoverflow.com/users/6777839/wolfgang-kais"}, "edited": false, "score": 0, "creation_date": 1574323817, "post_id": 58955452, "comment_id": 104193948, "body": "@WolfgangKais No error message safe for a windows prompt saying &#39;microsoft access has stopped working&#39;"}, {"owner": {"reputation": 86, "user_id": 7008757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3916e74c7724d1a7abd05da3285d5c0f?s=128&d=identicon&r=PG&f=1", "display_name": "JennyW", "link": "https://stackoverflow.com/users/7008757/jennyw"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1574333987, "post_id": 58955452, "comment_id": 104200120, "body": "@Erik referred the bug since the Office update. The posted workaround from Microsoft  may be worth trying:     update the query so that it updates the results of another query, rather than updating a table directly. For example, if you have a query similar to: UPDATE Table1 SET Table1.Field1 = &quot;x&quot; WHERE ([Table1].[Field2]=1); You can create a new query (Query1) defined as: SELECT * from Table1; And update your original query to: UPDATE Query1 SET Query1.Field1 = &quot;x&quot; WHERE ([Query1].[Field2]=1); By replacing all references to Table1 with Query1 This will avoid the error."}, {"owner": {"reputation": 86, "user_id": 7008757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3916e74c7724d1a7abd05da3285d5c0f?s=128&d=identicon&r=PG&f=1", "display_name": "JennyW", "link": "https://stackoverflow.com/users/7008757/jennyw"}, "edited": false, "score": 1, "creation_date": 1574334215, "post_id": 58955452, "comment_id": 104200264, "body": "This is the link to the Microsoft page about the fault, with the above suggested workaround:   <a href=\"https://support.office.com/en-us/article/access-error-query-is-corrupt-fad205a5-9fd4-49f1-be83-f21636caedec\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1580985155, "post_id": 60087752, "comment_id": 106281286, "body": "That&#39;s wrong (see docs)! You can use both, but Adodb only with rs!"}], "tags": [], "owner": {"reputation": 237, "user_id": 3304214, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RwjY3.jpg?s=128&g=1", "display_name": "trevor", "link": "https://stackoverflow.com/users/3304214/trevor"}, "is_accepted": false, "score": 0, "last_activity_date": 1580963348, "creation_date": 1580963348, "answer_id": 60087752, "question_id": 58955452, "link": "https://stackoverflow.com/questions/58955452/setting-listbox-recordset-to-an-adodb-recordset-causes-crashes-when-using-the-li/60087752#60087752", "title": "Setting listbox.recordset to an ADODB recordset causes crashes when using the listbox", "body": "<p>A form control of type listbox gets its data from .RowSource  - not .Recordset  </p>\n\n<p>If your code, as above, worked in the past, it may have been due to an error or oversight - but I would not expect it to work.</p>\n"}], "owner": {"reputation": 136, "user_id": 12404102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4092034588c3d8aaf8d88f1dba31b58b?s=128&d=identicon&r=PG&f=1", "display_name": "Ayam", "link": "https://stackoverflow.com/users/12404102/ayam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 233, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1594278296, "creation_date": 1574256301, "last_edit_date": 1594278296, "question_id": 58955452, "link": "https://stackoverflow.com/questions/58955452/setting-listbox-recordset-to-an-adodb-recordset-causes-crashes-when-using-the-li", "title": "Setting listbox.recordset to an ADODB recordset causes crashes when using the listbox", "body": "<p>I am working in ms-access (office 365, v1808), and today my code suddenly broke down. I have not been able to pinpoint the problem specifically nor have I been able to find useful information on the internet.</p>\n\n<p>I'm retrieving a recordset with an ADODB.Recordset object from an external SQL-server table. This is the code that causes Access to crash without any useful information:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Command_Click()\n    Dim rs As ADODB.Recordset\n    Dim strSQL As String\n    Dim i As Long\n\n    strSQL = \"SELECT TOP 100 *\" &amp; _\n                \" FROM myTable;\"\n\n    Call OpenMyRecordset(rs, strSQL)\n    Set Me.myListbox.Recordset = rs\n\n    Me.myListbox.Value = Me.myListbox.ItemData(0)\n\n    rs.Close\n    Set rs = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Usually the line 'Me.Listbox...' causes the crash (after experimenting with a break and stepping through the code)</p>\n\n<p>I have tried this with no success:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>i = Me.myListbox.ItemData(0)\nMe.myListbox.Value = i\n</code></pre>\n\n<p>Sometimes the code also breaks down if I only use:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Debug.print Me.myListbox.Value\n</code></pre>\n\n<p>The weirdest part is that the errors are not consistent: sometimes it runs a once or twice and then crashes, while other times it crashes immediately.</p>\n\n<p>Additional information gathered so far:</p>\n\n<ul>\n<li>The rs that is returned is O.K. (and non-empty)</li>\n<li>If I only use 'Set me.myListbox.Recordset = rs' and do not inquire/alter the .Value property all is good</li>\n<li>Using the .Value property without loading a recordset is also no problem</li>\n<li>Recreating the SQL table does not help</li>\n<li>Using a different table/database does not help</li>\n<li>Restarting Access/My computer/Creating a new Access file with only relevant code does not help</li>\n</ul>\n\n<p><strong>EDIT:</strong></p>\n\n<p>The field types for the recordset are int, int, nvarchar(255), nvarchar(255).</p>\n\n<p>The code for OpenMyRecordset is copied and adjusted accordingly from <a href=\"http://accessexperts.net/blog/2011/01/21/easy-adodb-recordsets-and-commands-in-access/\" rel=\"nofollow noreferrer\">http://accessexperts.net/blog/2011/01/21/easy-adodb-recordsets-and-commands-in-access/</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1574256092, "post_id": 58955305, "comment_id": 104166382, "body": "Looks like you&#39;re missing the file extension."}, {"owner": {"reputation": 13, "user_id": 11899128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5ee25ee68ed5c9ca2b1af2bd3befa9e?s=128&d=identicon&r=PG&f=1", "display_name": "mmk541", "link": "https://stackoverflow.com/users/11899128/mmk541"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574256775, "post_id": 58955305, "comment_id": 104166792, "body": "That&#39;s it I was missing! Thank you so much for your help!"}], "owner": {"reputation": 13, "user_id": 11899128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5ee25ee68ed5c9ca2b1af2bd3befa9e?s=128&d=identicon&r=PG&f=1", "display_name": "mmk541", "link": "https://stackoverflow.com/users/11899128/mmk541"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574256029, "creation_date": 1574255870, "last_edit_date": 1574256029, "question_id": 58955305, "link": "https://stackoverflow.com/questions/58955305/using-dirfilename-to-determine-if-file-exists-or-not", "title": "Using Dir(FileName) to determine if file exists or not", "body": "<p>I try to use Dir(FileName) to determine if the file exists or not. However, even I extracted the correct file name using the following code, Dir(FileName) returns empty regardless the file actually exists in the drive or not. Thank you in advance for your help!</p>\n\n<pre><code> Sub SetUpTable()\n\n    Dim ws As Worksheet, fName As String, SNumber As String, fPath As String, wbName As String\n\n    wbName = ActiveWorkbook.Name\n\n    SNumber = Left(wbName, InStr(wbName, \"_\") - 1)\n\n    fPath = ThisWorkbook.Path\n\n    Set ws = ActiveSheet\n\n    With ws\u00a0\u00a0\u00a0 \n        \u00a0\u00a0\u00a0 \n        \u00a0\u00a0\u00a0 fName = fPath &amp; \"\\\" &amp; SNumber &amp; \" Tbl \" &amp; .Name\n        \u00a0\u00a0\u00a0 \n        \u00a0\u00a0\u00a0 If Dir(fName) &lt;&gt; vbNullString Then\n        \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 FileExistsWarning.Show\u00a0\u00a0\u00a0 \n        \u00a0\u00a0\u00a0 Else:\n        \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Call ConvertToPDF\u00a0\u00a0\u00a0 \n        \u00a0\u00a0\u00a0 End If\n        \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \n     End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "listbox"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 2, "creation_date": 1574255749, "post_id": 58955204, "comment_id": 104166181, "body": "Instead of passing the <code>ListBoxName</code> as a <code>String</code> why not just pass the <code>ListBox</code>?"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1574256228, "post_id": 58955204, "comment_id": 104166456, "body": "Also, in your example it doesn&#39;t look like there is anyway to select which <code>ListBox</code> you want to add it to"}, {"owner": {"reputation": 3, "user_id": 8111729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a32d6f96b8f9849fa946a725b2292e9a?s=128&d=identicon&r=PG&f=1", "display_name": "pingoui", "link": "https://stackoverflow.com/users/8111729/pingoui"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1574257396, "post_id": 58955204, "comment_id": 104167199, "body": "Hi Tom, thanks for anserw. After pressing button &quot;add event&quot; the new userform appears where user can select which listbox (by name) he will choose (I used checkboxes described with names so I can get String from it). How can I refer to the listboxes there? It will be much easier to passing listBoxes but I can&#39;t imagine how to do it.."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1574257701, "post_id": 58955204, "comment_id": 104167382, "body": "From the new userform how do you pass the inputs back to the parent userform?"}, {"owner": {"reputation": 3, "user_id": 8111729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a32d6f96b8f9849fa946a725b2292e9a?s=128&d=identicon&r=PG&f=1", "display_name": "pingoui", "link": "https://stackoverflow.com/users/8111729/pingoui"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1574258582, "post_id": 58955204, "comment_id": 104167925, "body": "So I need to pass all the listBoxes to child userform, let user to choose one, and pass back the chosen listBox back to parent form in another function written in parent userform called from the child userform?"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1574261013, "post_id": 58955204, "comment_id": 104169453, "body": "Have a look at my update as well. This uses the <code>Label</code> captions in your parent <code>UserForm</code> instead of using <code>Control</code> names which will mean nothing to the end user"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8111729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a32d6f96b8f9849fa946a725b2292e9a?s=128&d=identicon&r=PG&f=1", "display_name": "pingoui", "link": "https://stackoverflow.com/users/8111729/pingoui"}, "edited": false, "score": 0, "creation_date": 1574263723, "post_id": 58956499, "comment_id": 104171282, "body": "Thank you very much! This was really helpful!"}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 0, "last_activity_date": 1574260949, "last_edit_date": 1574260949, "creation_date": 1574259508, "answer_id": 58956499, "question_id": 58955204, "link": "https://stackoverflow.com/questions/58955204/changing-reference-to-listbox-to-add-item/58956499#58956499", "title": "Changing reference to Listbox to add item", "body": "<p>Personally this is how I would approach it with my two forms</p>\n\n<p>My main form is called <code>UserForm1</code> and my 'Event Picker' is called <code>EventPicker</code></p>\n\n<p><code>UserForm1</code> is set up as your example</p>\n\n<p><a href=\"https://i.stack.imgur.com/J4MYE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/J4MYE.png\" alt=\"UserForm1\"></a></p>\n\n<p>and <code>EventPicker</code> shows</p>\n\n<p><a href=\"https://i.stack.imgur.com/iIwFu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iIwFu.png\" alt=\"EventPicker\"></a></p>\n\n<p>Behind my <code>UserForm1</code> I have the following code</p>\n\n<pre><code>Option Explicit\nPrivate Sub CommandButton1_Click()\n    Dim ctrl\n    Dim Eventfrm As EventPicker\n\n    Set Eventfrm = New EventPicker\n    Set Eventfrm.ParentForm = Me\n\n    For Each ctrl In Me.Controls\n        If TypeName(ctrl) = \"ListBox\" Then\n            Eventfrm.NamePickerCombo.AddItem ctrl.Name\n        End If\n    Next ctrl\n\n    Eventfrm.Show\nEnd Sub\n</code></pre>\n\n<p>This is called on <code>Click</code> of the 'Add Event' button and initiates the <code>EventPicker</code> form by populating the <code>ComboBox</code> and setting the <code>ParentForm</code> property so that the child form knows where it has come from.</p>\n\n<p>Behind my <code>EventPicker</code> form I then have the following code</p>\n\n<pre><code>Option Explicit\nPrivate vParentForm As UserForm1\nPublic Property Set ParentForm(v As UserForm1)\n    Set vParentForm = v\nEnd Property\nPublic Property Get ParentForm() As UserForm1\n    Set ParentForm = vParentForm\nEnd Property\nPrivate Sub CommandButton1_Click()\n    Dim lBox As MSForms.ListBox\n\n    Set lBox = ParentForm.Controls(Me.NamePickerCombo.Value)\n    lBox.AddItem Me.TextBox1.Value\n\n    Unload Me\nEnd Sub\nPrivate Sub CommandButton2_Click()\n    Unload Me\nEnd Sub\n</code></pre>\n\n<p>Leaving me with the following</p>\n\n<p><a href=\"https://i.stack.imgur.com/yqeRU.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yqeRU.gif\" alt=\"Result\"></a></p>\n\n<p>Update for using Names instead of control <code>Name</code>s.</p>\n\n<p>Behind <code>UserForm1</code></p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CommandButton1_Click()\n    Dim ctrl\n    Dim Eventfrm As EventPicker\n\n    Set Eventfrm = New EventPicker\n    Set Eventfrm.ParentForm = Me\n\n    Debug.Print Me.Name, TypeName(Me)\n\n    For Each ctrl In Me.Controls\n        Debug.Print ctrl.Name, TypeName(ctrl)\n        If TypeName(ctrl) = \"Label\" Then\n            Eventfrm.NamePickerCombo.AddItem ctrl.Caption\n        End If\n    Next ctrl\n\n    Eventfrm.Show\nEnd Sub\n</code></pre>\n\n<p>Behind <code>EventPicker</code></p>\n\n<pre><code>Option Explicit\nPrivate vParentForm As UserForm1\nPublic Property Set ParentForm(v As UserForm1)\n    Set vParentForm = v\nEnd Property\nPublic Property Get ParentForm() As UserForm1\n    Set ParentForm = vParentForm\nEnd Property\nPrivate Sub CommandButton1_Click()\n    Dim lBox As MSForms.ListBox\n    Dim lbl As MSForms.Label\n    Dim ctrl As Control\n\n    Debug.Print Me.NamePickerCombo.Value, Me.TextBox1.Value\n\n    For Each ctrl In ParentForm.Controls\n        If TypeName(ctrl) = \"Label\" Then\n            If ctrl.Caption = Me.NamePickerCombo.Value Then\n                Set lbl = ctrl\n                Exit For\n            End If\n        End If\n    Next ctrl\n\n    For Each ctrl In ParentForm.Controls\n        If ctrl.Left &gt;= lbl.Left And ctrl.Left + ctrl.Width &lt;= lbl.Left + lbl.Width Then\n            Set lBox = ctrl\n            Exit For\n        End If\n    Next ctrl\n\n    lBox.AddItem Me.TextBox1.Value\n\n    Unload Me\nEnd Sub\nPrivate Sub CommandButton2_Click()\n    Unload Me\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/OMHAk.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OMHAk.gif\" alt=\"Results 2\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 8111729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a32d6f96b8f9849fa946a725b2292e9a?s=128&d=identicon&r=PG&f=1", "display_name": "pingoui", "link": "https://stackoverflow.com/users/8111729/pingoui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 58956499, "answer_count": 1, "score": 0, "last_activity_date": 1574260949, "creation_date": 1574255573, "question_id": 58955204, "link": "https://stackoverflow.com/questions/58955204/changing-reference-to-listbox-to-add-item", "title": "Changing reference to Listbox to add item", "body": "<p>I've got userform with multiple listboxes inside and a button for adding item.\n<a href=\"https://i.stack.imgur.com/WvYX6.jpg\" rel=\"nofollow noreferrer\">it looks like this.</a>\nWhen user click a button he can select the listbox by name and add new event (it's now static typed). When user tries to save it code will call the function which should change reference to listbox in which new item should be added and created. </p>\n\n<p>I see the draft like this but I don't know how to handle this listboxnames (see comments):</p>\n\n<pre><code>Function AddItemToListbox(listBoxName as String)\n    Select case listBoxName\n        case listBoxName1\n            'here I'd like to set listbox\n            'something like set listbox=listBox1\n        case listBoxName2\n            'here I'd like to set listbox\n        case listBoxName3\n            'here I'd like to set listbox\n        case listBoxName4\n            'here I'd like to set listbox\n        End Select\n\nlistbox.addItem\n\n'and do the other stuff with this listbox which I need to do\n\nEnd Function\n</code></pre>\n\n<p>Do you have solution or reference to materials wehre it can be explained? </p>\n"}, {"tags": ["excel", "vba", "range"], "answers": [{"tags": [], "owner": {"reputation": 521, "user_id": 12268796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LVipW.jpg?s=128&g=1", "display_name": "barneyos", "link": "https://stackoverflow.com/users/12268796/barneyos"}, "is_accepted": true, "score": 0, "last_activity_date": 1574257975, "creation_date": 1574257975, "answer_id": 58955980, "question_id": 58955052, "link": "https://stackoverflow.com/questions/58955052/iterate-named-ranges-to-use-with-linest/58955980#58955980", "title": "Iterate named ranges to use with LINEST", "body": "<p>Try maybe change your code like below:</p>\n\n<pre><code>' ...\nXX = \"Xxx\" &amp; i\n'...\n'XX = \"Xxx\"\nSelection.FormulaArray = \"=LINEST(\" &amp; XX &amp; \",TimeX^{1,2},TRUE,FALSE)\"\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11897011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cfdfe62f23fa5923602361177a4a7da?s=128&d=identicon&r=PG&f=1", "display_name": "jcm5", "link": "https://stackoverflow.com/users/11897011/jcm5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 58955980, "answer_count": 1, "score": 0, "last_activity_date": 1577730521, "creation_date": 1574255091, "last_edit_date": 1577730521, "question_id": 58955052, "link": "https://stackoverflow.com/questions/58955052/iterate-named-ranges-to-use-with-linest", "title": "Iterate named ranges to use with LINEST", "body": "<p>I have a large data set. I need to filter then copy the filtered data to a new sheet, and perform a polynomial regression to predict data at a certain time.</p>\n\n<p>The length of the data set is not a defined value, and can change from one data set to the next. I use VBA to find the end of the data set, and then I create named ranges that are later used in LINEST.                 </p>\n\n<p>It works for one filtered data set.</p>\n\n<p>When I iterate through my data, I believe the code overwrites the named ranges with new data. At the end all of my LINEST calculations are the same.</p>\n\n<p>Is there a way to change the named ranges so they can be iterated? I tried creating a variable that was set to my Range name + i, but I can\u2019t use the variable in LINEST.</p>\n\n<pre><code>Sub Regression()\n\nDim TimeX As Range\nDim X_Time As String\nDim Xxx As Range\nDim XX As String\nDim rws As Long\n\ni = 1\n\nDo While i &lt; 70\n\n    rws = Cells(Rows.Count, \"A\").End(xlUp).Row\n\n    Set TimeX = Range(\"$B$2:$B$\" &amp; rws)\n    Set Xxx = Range(\"$C$2:$C$\" &amp; rws)\n\n    \u2018X_Time = \"TimeX\" &amp; i\n    \u2018XX = \"Xxx\" &amp; i\n\n    X_Time = \"TimeX\"\n    XX = \"Xxx\"\n\n    ThisWorkbook.Names.Add Name:=X_Time, RefersTo:=TimeX\n    ThisWorkbook.Names.Add Name:=XX, RefersTo:=Xxx\n\n    Range(\"L4:N4\").Select\n    Selection.FormulaArray = \"=LINEST(Xxx,TimeX^{1,2},TRUE,FALSE)\"\n\n    i = i + 1\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9709831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ade7adcbca4f8fa25d44e92afe7da0bd?s=128&d=identicon&r=PG&f=1", "display_name": "lucg", "link": "https://stackoverflow.com/users/9709831/lucg"}, "edited": false, "score": 0, "creation_date": 1574256769, "post_id": 58955410, "comment_id": 104166789, "body": "Thank you for your answer, but I want to keep the excel table in the email. I edited my question for clarification. Sorry for the confusion."}, {"owner": {"reputation": 3, "user_id": 9709831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ade7adcbca4f8fa25d44e92afe7da0bd?s=128&d=identicon&r=PG&f=1", "display_name": "lucg", "link": "https://stackoverflow.com/users/9709831/lucg"}, "edited": false, "score": 0, "creation_date": 1574258378, "post_id": 58955410, "comment_id": 104167800, "body": "I want to keep the text that already is in the table cell and format it as a bulleted list. This solution would replace the data. I think it&#39;s done with <code>ListFormat.ApplyListTemplate</code>, but I cant figure out how?"}, {"owner": {"reputation": 123, "user_id": 1578569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Dx4sp.png?s=128&g=1", "display_name": "HaeschenaufGras", "link": "https://stackoverflow.com/users/1578569/haeschenaufgras"}, "reply_to_user": {"reputation": 3, "user_id": 9709831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ade7adcbca4f8fa25d44e92afe7da0bd?s=128&d=identicon&r=PG&f=1", "display_name": "lucg", "link": "https://stackoverflow.com/users/9709831/lucg"}, "edited": false, "score": 0, "creation_date": 1574258480, "post_id": 58955410, "comment_id": 104167863, "body": "The point I am after here is to use <code>Chr(149)</code> as bullet. Of coarse you need to replace the <code>text</code> variable with the already exisiting data in the cell and combine it with <code>Chr(149)</code>."}, {"owner": {"reputation": 3, "user_id": 9709831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ade7adcbca4f8fa25d44e92afe7da0bd?s=128&d=identicon&r=PG&f=1", "display_name": "lucg", "link": "https://stackoverflow.com/users/9709831/lucg"}, "edited": false, "score": 0, "creation_date": 1574260499, "post_id": 58955410, "comment_id": 104169130, "body": "I understood your point, but still it&#39;s not the result that I want as if the content is multiple lines long it&#39;s not properly indented like a bulleted list. I attached a picture of the structure I want to my question."}], "tags": [], "owner": {"reputation": 123, "user_id": 1578569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Dx4sp.png?s=128&g=1", "display_name": "HaeschenaufGras", "link": "https://stackoverflow.com/users/1578569/haeschenaufgras"}, "is_accepted": false, "score": 0, "last_activity_date": 1574257845, "last_edit_date": 1574257845, "creation_date": 1574256172, "answer_id": 58955410, "question_id": 58954928, "link": "https://stackoverflow.com/questions/58954928/indent-list-item-of-bulleted-list-in-table-in-outlook-wordeditor/58955410#58955410", "title": "Indent list item of bulleted list in table in Outlook WordEditor", "body": "<p>This VBA function creates a mail and adds a bullet list in the mail body.\nNow you just need to replace the <code>text</code> variable with the data from the cells</p>\n\n<pre><code>Sub send()\n\n    Dim objOutlook As Object\n    Dim objMail As Object\n    Dim text As String\n\n    Set objOutlook = CreateObject(\"Outlook.Application\")\n    Set objMail = objOutlook.CreateItem(0)\n\n    text = \"This is a summary\" &amp; Chr(10) &amp; _\n    Chr(149) &amp; \" First point\" &amp; Chr(10) &amp; _\n    Chr(149) &amp; \" Second point\" &amp; Chr(10) &amp; _\n    Chr(149) &amp; \" Last point\"\n\n    With objMail\n       .To = \"name@domain.de\"\n       .Subject = \"Subject\"\n       .Body = text\n       .Display\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>If you want to add a bullet list into one cell you can use the same method, e.g. the below code adds the list into the current active cell:</p>\n\n<pre><code>Sub Bullets()\n    Text = \"This is a summary\" &amp; Chr(10) &amp; _\n        Chr(149) &amp; \" First point\" &amp; Chr(10) &amp; _\n        Chr(149) &amp; \" Second point\" &amp; Chr(10) &amp; _\n        Chr(149) &amp; \" Last point\"\n\n    ActiveCell.Value = Text\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 9709831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ade7adcbca4f8fa25d44e92afe7da0bd?s=128&d=identicon&r=PG&f=1", "display_name": "lucg", "link": "https://stackoverflow.com/users/9709831/lucg"}, "edited": false, "score": 0, "creation_date": 1574264861, "post_id": 58958048, "comment_id": 104171986, "body": "Thank you this helps! One additional question. When I do <code>currentCell.ListFormat.ListIndent</code> the whole cell of the table indents, not just the list in the cell. Which then breaks the table. How can I fix this?"}, {"owner": {"reputation": 3, "user_id": 9709831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ade7adcbca4f8fa25d44e92afe7da0bd?s=128&d=identicon&r=PG&f=1", "display_name": "lucg", "link": "https://stackoverflow.com/users/9709831/lucg"}, "edited": false, "score": 0, "creation_date": 1574270154, "post_id": 58958048, "comment_id": 104175102, "body": "I want to increase the Tab to the right (indent the ListLevel). Therefore I tried ``` With .ListLevels(1)           .NumberFormat = &quot;-&quot;           .TabPosition = 50           .NumberPosition = 20         End With ``` but both don&#39;t have any effect. What am I doing wrong?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11818836"}, "is_accepted": true, "score": 1, "last_activity_date": 1574274022, "last_edit_date": 1574274022, "creation_date": 1574264022, "answer_id": 58958048, "question_id": 58954928, "link": "https://stackoverflow.com/questions/58954928/indent-list-item-of-bulleted-list-in-table-in-outlook-wordeditor/58958048#58958048", "title": "Indent list item of bulleted list in table in Outlook WordEditor", "body": "<p>Not sure how this works when you're in Outlook, but in Word you would need to create a ListTemplate with the relevant bullet style layout, then apply it. Something like this:</p>\n\n<pre><code>Const bulletLTName As String = \"mybullet\"\nWith ActiveDocument\n  ' Unless you are always creating new documents, you might\n  ' need to verify that mybullet doesn't exist and delete then recreate,\n  ' or modify. Not done here.\n  With .ListTemplates.Add(OutlineNumbered:=False, Name:=BulletLTName)\n    With .ListLevels(1)\n      .NumberFormat = \"-\"\n      ' If you need to modify the bullet font, you can do it\n      ' like this...\n      With .Font\n        .Name = \"&lt;whatever font name you want to use&gt;\"\n        .Size = 10 ' etc.\n      End With\n      ' You can modify other layout properties - best to\n      ' look at Word's object model, but for example\n      .NumberPosition = 0\n      .TabPosition = 10\n      .TextPosition = 10 ' and so on.\n    End With\n  End With\n  With .Tables(1).Cell(2, 2).Range\n    .Text = \"text\"\n    .ListFormat.ApplyListTemplate .Document.ListTemplates(bulletLTName)\n  End With\nEnd With\n</code></pre>\n\n<p>Although it does function, I would try to avoid defining currentCell as a Variant because it makes the code less obvious (e.g. it's not obvious that, as written, currentCell is a Word Range and not a Word Cell).</p>\n"}], "owner": {"reputation": 3, "user_id": 9709831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ade7adcbca4f8fa25d44e92afe7da0bd?s=128&d=identicon&r=PG&f=1", "display_name": "lucg", "link": "https://stackoverflow.com/users/9709831/lucg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 0, "accepted_answer_id": 58958048, "answer_count": 2, "score": 0, "last_activity_date": 1577480771, "creation_date": 1574254737, "last_edit_date": 1577480771, "question_id": 58954928, "link": "https://stackoverflow.com/questions/58954928/indent-list-item-of-bulleted-list-in-table-in-outlook-wordeditor", "title": "Indent list item of bulleted list in table in Outlook WordEditor", "body": "<p>I'm trying to compose an email with Outlook VBA with data from an Excel sheet.</p>\n\n<p>I pasted a table from Excel into the mail and now want to format some cells as a bulleted list inside the table.</p>\n\n<p>Now I need to format the text of the cell e.g. as a bulleted list.</p>\n\n<p>This works with this code:</p>\n\n<pre><code>Dim currentCell As Variant\ncurrentCell = wdDoc.Tables(1).Cell(2, 2)\ncurrentCell.ListFormat.ApplyBulletDefault\n</code></pre>\n\n<p>How would I format the text in the Cell(2,2) as a bulleted list with multiple indentations?</p>\n\n<p>When I use <code>currentCell.ListFormat.ListIndent</code> the whole cell shifts to the left, not just the list.</p>\n\n<p>This is the structure I am looking for<br>\n<a href=\"https://i.stack.imgur.com/AwkmZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AwkmZ.png\" alt=\"Picture: This is the structure I am looking for\"></a></p>\n"}, {"tags": ["sql", "excel", "vba"], "comments": [{"owner": {"reputation": 580, "user_id": 7309473, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13b549a4f4613ac7f096c97765a7e02a?s=128&d=identicon&r=PG&f=1", "display_name": "Tomasz", "link": "https://stackoverflow.com/users/7309473/tomasz"}, "edited": false, "score": 2, "creation_date": 1574254444, "post_id": 58954529, "comment_id": 104165366, "body": "I am not the Excel specialist, but maybe you can specify the SalesDate mask when filtering. The real, stored data mask can be different, that those is being printed, which you see in the Excel sheet. See that 5th October 2019 could be written as: 1) 2019.10.05 (European notation) or 2) 2019.05.10 (US notation)."}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 2, "creation_date": 1574254456, "post_id": 58954529, "comment_id": 104165376, "body": "I can&#39;t be 100% sure, but it might be a date format thing? i.e. 24/10/2019 is 24 October, but 05/10/2019 is 10 May instead? 10/10/2019 might work fine because is the same either way (10 October)."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1574255076, "post_id": 58954529, "comment_id": 104165761, "body": "Have you tried converting the dates into doubles in the query? Something like <code>...where SalesDate = &quot; &amp; cdbl(dt) &amp; &quot;</code> with no <code>#</code>"}, {"owner": {"reputation": 33, "user_id": 12403871, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MI1wnbRcQn4/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qHQNDme6TgK8qaNdnjw9hnkBuIVQ/mo/photo.jpg?sz=128", "display_name": "Ja30", "link": "https://stackoverflow.com/users/12403871/ja30"}, "edited": false, "score": 0, "creation_date": 1574257162, "post_id": 58954529, "comment_id": 104167041, "body": "Thanks for the ideas, but I&#39;ve already thought of that, and in fact there are no data for either 10th May or 10th August. I am using MsgBox to output info at various points and I can see that I am searching for the right date format (and it matches with what is stored in the cell, despite that it is displayed differently in the sheet), and I am getting the right data for 8th October (there was a typo in the original post - it was 8th October not 10th October). I have also experimented with cdbl() but with no success!"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1574257885, "post_id": 58954529, "comment_id": 104167491, "body": "I know we are beating a dead horse here, but perhaps instead of just <code>dt</code> try formatting it like ` &amp; Format(dt, &quot;dd/mm/yyyy&quot;) &amp; ` and see if that makes it happy. Alternatively, check that the cells/column you are querying actually holds dates and not just strings formatted like dates. <code>ACE</code> and <code>JET</code> only use the first 10 or so rows to determine data types when querying so they can get kind of stupid."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 12403871, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MI1wnbRcQn4/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qHQNDme6TgK8qaNdnjw9hnkBuIVQ/mo/photo.jpg?sz=128", "display_name": "Ja30", "link": "https://stackoverflow.com/users/12403871/ja30"}, "edited": false, "score": 1, "creation_date": 1574275033, "post_id": 58957548, "comment_id": 104177622, "body": "thank you FunThomas, using your suggested code I&#39;ve now got it working."}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": true, "score": 3, "last_activity_date": 1574262534, "creation_date": 1574262534, "answer_id": 58957548, "question_id": 58954529, "link": "https://stackoverflow.com/questions/58954529/using-sql-to-get-data-from-excel-sheets/58957548#58957548", "title": "using sql to get data from excel sheets", "body": "<p>If it comes to dates, you should deal with dates, not with representations of dates. <code>08/10/2019</code> is not a date - it's a string that might be seen as a date - but is it 8th of October or is it 10th of August?</p>\n\n<p>If you have real dates in your sheet, they are stored as <code>Double</code> values and only shown to you in a way that you can see them as a date. That depends on the formatting of your cells and also on regional settings of the computer. So 8th of October is stored as number 43746, and if you add 0.5, it's noon of 8th October.  You might see it as <code>08/10/2019</code>, or as 08-Oct-2019 or as 08. Oktober 2019 - possibilities are endless, but the value itself stays the same.</p>\n\n<p>If you want to query dates, you should pass a date parameter to the query. If you pass <code>#\" &amp; dt &amp; \"#</code>, you are passing a string. if <code>dt</code> is a <code>Date</code>-variable, VBA converts the date to a string and the SQL parser tries to convert it back to a date - not necessarily in the same way. Of course you also don't want to pass <code>43746</code> as parameter. You don't mind about how a date is stored, and if you query a different datasource (eg Oracle, SQL Server...), they will store the date in a different format.</p>\n\n<p>The best way to solve this problem is to use <code>ADODB.Parameter</code>. It's a little bit more coding because you cannot pass a <code>ADODB.Parameter</code> to the <code>Execute</code>-method of the Connection-object, you have to involve a <code>ADODB.Command</code>-object, but once you are used to it, you will enjoy the benefits: You no longer have to take care about formatting, don't need to put a string-parameter into quotes and so on. Plus, it prevents <em>SQL injection</em>.</p>\n\n<p>Have a look to the following code (as you can see, I prefer to use early binding, but of course this works also when you switch to late binding)</p>\n\n<pre><code>Dim cn As ADODB.Connection, cmd As ADODB.Command, param As ADODB.Parameter\nSet cn = New ADODB.Connection\n\nWith cn\n    .Provider = \"Microsoft.ACE.OLEDB.12.0\"\n    .ConnectionString = \"Data Source=\" &amp; ThisWorkbook.FullName &amp; \";\" &amp; \"Extended Properties=\"\"Excel 12.0 Xml;HDR=YES\"\";\"\n    .Open\nEnd With\n\nDim sql As String\nsql = \"SELECT * FROM [Sheet1$] where SalesDate = ?\"   ' The ? is a placeholder for a parameter\n' Create command\nSet cmd = New ADODB.Command\nSet cmd.ActiveConnection = cn\ncmd.CommandText = sql\n' Create a parameter of type Date and pass the date value\nSet param = cmd.CreateParameter(\"p1\", adDate, adParamInput, , dt)\ncmd.Parameters.Append param\n\nDim rs As ADODB.Recordset\nSet rs = cmd.Execute\n</code></pre>\n\n<p>With this, the query runs with a real Date (there are other parameter types for numbers, Strings etc).</p>\n\n<p>Now, there is another aspect when it comes to SQL queries involving dates: A date can contain a time part, which is stored as the fraction part of the double. If you're searching for a date and you want to include date values from the whole day, you could change your code to </p>\n\n<pre><code>sql = \"SELECT * FROM [Sheet1$] where SalesDate &gt;= ? and SalesDate &lt; ?\"\n' Now we have to provide two parameters:\nSet param = cmd.CreateParameter(\"p1\", adDate, adParamInput, , dt)\ncmd.Parameters.Append param\n' Second parameter is the next day - a little lazy, you can deal with DateAdd instead\nSet param = cmd.CreateParameter(\"p2\", adDate, adParamInput, , dt+1)\ncmd.Parameters.Append param    \n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 12403871, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MI1wnbRcQn4/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qHQNDme6TgK8qaNdnjw9hnkBuIVQ/mo/photo.jpg?sz=128", "display_name": "Ja30", "link": "https://stackoverflow.com/users/12403871/ja30"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 1, "accepted_answer_id": 58957548, "answer_count": 1, "score": 3, "last_activity_date": 1574262534, "creation_date": 1574253407, "last_edit_date": 1574257186, "question_id": 58954529, "link": "https://stackoverflow.com/questions/58954529/using-sql-to-get-data-from-excel-sheets", "title": "using sql to get data from excel sheets", "body": "<p>I am using SQL to extract data from a worksheet. I have a sheet of sales data (\"Sales\"). The 1st three columns are <code>SalesDate</code>, <code>Customer</code> and <code>CBand</code>.\n<a href=\"https://i.stack.imgur.com/axWxE.png\" rel=\"nofollow noreferrer\">sample of my sheet</a></p>\n\n<p>First, I get a list of distinct dates:</p>\n\n<pre><code>wb = ThisWorkbook.Path &amp; \"\\\" &amp; ThisWorkbook.name\nSet cn = CreateObject(\"ADODB.Connection\")\nWith cn\n    .Provider = \"Microsoft.ACE.OLEDB.12.0\"\n    .ConnectionString = \"Data Source=\" &amp; wb &amp; \";\" &amp; \"Extended Properties=\"\"Excel 12.0 Xml;HDR=YES\"\";\"\n    .Open\nEnd With\n\nsql = \"SELECT distinct SalesDate FROM [Sales$] where CBand=3 order by SalesDate desc\"\nSet RS = cn.Execute(sql)\nct = 0\nIf Not RS.EOF Then\n</code></pre>\n\n<p>... etc</p>\n\n<p>I save all the dates thus retrieved in another worksheet.</p>\n\n<p>Then, using one of the dates I have saved, I again query the sales sheet:\n(note, 'dt' is supplied as a parameter to this sub - eg \"08/10/2019\" or \"05/10/2019\" - the same format that the date is stored)</p>\n\n<pre><code>wb = ThisWorkbook.Path &amp; \"\\\" &amp; ThisWorkbook.name\nSet cn = CreateObject(\"ADODB.Connection\")\nWith cn\n    .Provider = \"Microsoft.ACE.OLEDB.12.0\"\n    .ConnectionString = \"Data Source=\" &amp; wb &amp; \";\" &amp; \"Extended Properties=\"\"Excel 12.0 Xml;HDR=YES\"\";\"\n    .Open\nEnd With\nsql = \"SELECT distinct Customer FROM [Sales$] where SalesDate = #\" &amp; dt &amp; \"# and CBand=3\"\noutput = output &amp; sql &amp; vbNewLine\nSet RS = cn.Execute(sql)\nct = 0\nIf Not RS.EOF Then...\n</code></pre>\n\n<p>The second query will only work for certain dates. For example, using the sample portion of sheet attached, the 5th October returns no rows (the RS.EOF test fails), but the 8th October works fine, and I am able to loop through all the rows associated with that date. I have tried with several dates, most work, but there are a handful that don't, and I can't see why.</p>\n\n<p>I am stumped!</p>\n"}, {"tags": ["excel", "vba", "date"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1574253234, "post_id": 58954421, "comment_id": 104164642, "body": "Try <code>strFile = strName &amp; &quot;_&quot; &amp; Format(strDate,&quot;dd-mm-yyyy&quot;) &amp; &quot;.pdf&quot;</code>"}, {"owner": {"reputation": 29, "user_id": 10612087, "user_type": "registered", "profile_image": "https://graph.facebook.com/761038534231425/picture?type=large", "display_name": "Mike Rophone", "link": "https://stackoverflow.com/users/10612087/mike-rophone"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1574253617, "post_id": 58954421, "comment_id": 104164885, "body": "Worked perfectly! It was so easy though... Thanks a bunch!"}], "answers": [{"comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 29, "user_id": 10612087, "user_type": "registered", "profile_image": "https://graph.facebook.com/761038534231425/picture?type=large", "display_name": "Mike Rophone", "link": "https://stackoverflow.com/users/10612087/mike-rophone"}, "edited": false, "score": 0, "creation_date": 1582188932, "post_id": 58954881, "comment_id": 106693595, "body": "@MikeRophone No problem. If this answer worked for you, pelase, mark it as correct so it can be closed <a href=\"https://stackoverflow.com/help/someone-answers\">What should I do when someone answers my question?</a>"}], "tags": [], "owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "is_accepted": true, "score": 1, "last_activity_date": 1574254594, "creation_date": 1574254594, "answer_id": 58954881, "question_id": 58954421, "link": "https://stackoverflow.com/questions/58954421/changing-date-format-when-saving-as-pdf/58954881#58954881", "title": "Changing Date format when saving as PDF", "body": "<p>When you use <code>strDate = Replace(strDate, \"/\", \"-\")</code> you are calling the value in cell. Even if you see a date on it, dates on Excel are, actually, numbers.</p>\n\n<p>So <code>Replace(strDate, \"/\", \"-\")</code> does not work, because there is nothing to replace.</p>\n\n<p>Using <code>Format</code> allows to change how a value is displayed, and you can save that new formated value into a string variable.</p>\n\n<p>That explains why <code>strFile = strName &amp; \"_\" &amp; Format(strDate,\"dd-mm-yyyy\") &amp; \".pdf\"</code> works.</p>\n"}], "owner": {"reputation": 29, "user_id": 10612087, "user_type": "registered", "profile_image": "https://graph.facebook.com/761038534231425/picture?type=large", "display_name": "Mike Rophone", "link": "https://stackoverflow.com/users/10612087/mike-rophone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "accepted_answer_id": 58954881, "answer_count": 1, "score": 1, "last_activity_date": 1574254594, "creation_date": 1574253018, "last_edit_date": 1574253343, "question_id": 58954421, "link": "https://stackoverflow.com/questions/58954421/changing-date-format-when-saving-as-pdf", "title": "Changing Date format when saving as PDF", "body": "<p>I'm confronted with the following issue:<br>\nI would like to save a Sheet to PDF using VBA. The file name should include the values of some Cells, including one cell that holds a date. This date has been changed to the format \"dd-mm-yyyy\" (by means of code or in the Number Format dropdown in the Home tab) since Filenames cannot hold \"/\" but when I look at the formula bar the date is still \"dd/mm/yyyy\".</p>\n\n<p>When running the code the filename returns the date in that format...\nHow can I change the date format so that I can include it correctly in the filename?</p>\n\n<pre><code>\nDim wsA As Worksheet\nDim wbA As Workbook\nDim strDate As Range\nDim strName As Range\nDim strPath As String\nDim strFile As String\nDim strPathFile As String\nDim myFile As Variant\nOn Error GoTo errHandler\n\nSet wbA = ActiveWorkbook\nSet wsA = ActiveWorkbook.Sheets(\"Devis\")\nSet strName = ActiveWorkbook.Sheets(\"Calc\").Range(\"Designation\")\nSet strDate = ActiveWorkbook.Sheets(\"Calc\").Range(\"arrival\")\n\nstrPath = wbA.Path\nIf strPath = \"\" Then\n  strPath = Application.DefaultFilePath\nEnd If\nstrPath = strPath &amp; \"\\\"\nstrDate = Replace(strDate, \"/\", \"-\")\n\nstrFile = strName &amp; \"_\" &amp; strDate &amp; \".pdf\"\nstrPathFile = strPath &amp; strFile\n\nmyFile = Application.GetSaveAsFilename _\n    (InitialFileName:=strPathFile, _\n        FileFilter:=\"PDF Files (*.pdf), *.pdf\", _\n        Title:=\"Select Folder and FileName to save\")\n\nIf myFile &lt;&gt; \"False\" Then\n    wsA.ExportAsFixedFormat _\n        Type:=xlTypePDF, _\n        Filename:=myFile, _\n        Quality:=xlQualityStandard, _\n        IncludeDocProperties:=True, _\n        IgnorePrintAreas:=False, _\n        OpenAfterPublish:=False\n    'confirmation message with file info\n    MsgBox \"PDF file has been created: \" _\n      &amp; vbCrLf _\n      &amp; myFile\nEnd If\n\nexitHandler:\n    Exit Sub\nerrHandler:\n    MsgBox \"Could not create PDF file\"\n    Resume exitHandler\n\n\nEnd Sub\n\n</code></pre>\n\n<p>You will see I tried to replace the \"/\" with \"-\" in the code but this does not seem to help...\nLooking forward to your suggestions!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 45, "user_id": 12227875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ac8febe3e3cc08d724931fd9327354a?s=128&d=identicon&r=PG&f=1", "display_name": "user12227875", "link": "https://stackoverflow.com/users/12227875/user12227875"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1574253849, "post_id": 58954143, "comment_id": 104165010, "body": "trying to compare column A and D and put missing values in Col A that are available in Col D thats why use this code to put eqaute value in Blank cells of Col A from column D"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1574255059, "post_id": 58954143, "comment_id": 104165750, "body": "What is the error?"}, {"owner": {"reputation": 45, "user_id": 12227875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ac8febe3e3cc08d724931fd9327354a?s=128&d=identicon&r=PG&f=1", "display_name": "user12227875", "link": "https://stackoverflow.com/users/12227875/user12227875"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1574255282, "post_id": 58954143, "comment_id": 104165899, "body": "putting 0&#39;s in the cells of Col A Or 0&#39;s in the blank cells of Col A at the end"}], "answers": [{"comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1574258201, "post_id": 58955195, "comment_id": 104167678, "body": "Upp&#39;d one so you can get closer to commenting"}], "tags": [], "owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "is_accepted": false, "score": 1, "last_activity_date": 1574257097, "last_edit_date": 1574257097, "creation_date": 1574255536, "answer_id": 58955195, "question_id": 58954143, "link": "https://stackoverflow.com/questions/58954143/getting-error-in-output-using-formula-in-vba/58955195#58955195", "title": "Getting error in output using formula in VBA", "body": "<p>Try this:</p>\n\n<pre><code>Dim WkRg as Range\n\nWith WkRg.Columns(1).SpecialCells(xlCellTypeBlanks)\n       .Formula = \"=if(RC[3]=\"\"\"\",\"\"\"\",RC[3])\"\nEnd With\n</code></pre>\n\n<p>Otherwise, it returns 0 instead of the nullString (nothing) if nothing is found on column D:D.\nBut, I must confess I do not understand the meaning/need of </p>\n\n<pre><code>Set WkRg = Intersect(WkRg, WkRg.Offset(3, 0))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": true, "score": 0, "last_activity_date": 1574256602, "last_edit_date": 1574256602, "creation_date": 1574255847, "answer_id": 58955295, "question_id": 58954143, "link": "https://stackoverflow.com/questions/58954143/getting-error-in-output-using-formula-in-vba/58955295#58955295", "title": "Getting error in output using formula in VBA", "body": "<p>I believe you don't want 0's if d is blank</p>\n\n<pre><code>Sub Button1_Click()\n    On Error GoTo er\n    Columns(\"A:A\").SpecialCells(xlCellTypeBlanks).FormulaR1C1 = \"=IF(RC[3]&lt;&gt;\"\"\"\",RC[3],\"\"\"\")\"\ner:     MsgBox \"No Blanks Found\"\nEnd Sub\n</code></pre>\n\n<p>You can also loop through the range and make the blank cell equal the d cell.</p>\n\n<pre><code>Sub Button2_Click()\n    Dim rng As Range, c As Range\n    On Error GoTo er\n    Set rng = Range(\"A:A\").SpecialCells(xlCellTypeBlanks)\n    For Each c In rng.Cells\n        c = c.Offset(, 3)\n    Next\ner:\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 12227875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ac8febe3e3cc08d724931fd9327354a?s=128&d=identicon&r=PG&f=1", "display_name": "user12227875", "link": "https://stackoverflow.com/users/12227875/user12227875"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 58955295, "answer_count": 2, "score": 0, "last_activity_date": 1574257097, "creation_date": 1574252108, "last_edit_date": 1574252898, "question_id": 58954143, "link": "https://stackoverflow.com/questions/58954143/getting-error-in-output-using-formula-in-vba", "title": "Getting error in output using formula in VBA", "body": "<p>I am using below VBA macro that looks in D column cell values and equates/ copy pastes in Col A those values that are available in Col D but not in A. </p>\n\n<p>After using below formula, I however get missing values in Col A but additionally  0's in Col A. Please help me to correct this error. Or, is there any way using vba to get desired results. Thank you</p>\n\n<pre><code>Sub fillIntheBlank()\n    Set WkRg = Worksheets(\"sheet1\").UsedRange\n    Set WkRg = Intersect(WkRg, WkRg.Offset(3, 0))\n\n    If Application.CountBlank(WkRg.Columns(1)) &lt;&gt; 0 Then\n        With WkRg.Columns(1).SpecialCells(xlCellTypeBlanks)\n                .Formula = \"=RC[3]\"\n        End With\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 0, "creation_date": 1574251798, "post_id": 58954004, "comment_id": 104163781, "body": "Try to erase <code>ActiveWorkbook.</code> and leave just <code>Windows(&quot;cw 38.xls&quot;).Visible = False</code>"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1574252058, "post_id": 58954004, "comment_id": 104163949, "body": "<a href=\"https://stackoverflow.com/questions/579797/open-excel-file-for-reading-with-vba-without-display\" title=\"open excel file for reading with vba without display\">stackoverflow.com/questions/579797/&hellip;</a>"}, {"owner": {"reputation": 15, "user_id": 12182266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/523dbd90a19315d8c3a0e707c0fdc816?s=128&d=identicon&r=PG&f=1", "display_name": "Hoesl", "link": "https://stackoverflow.com/users/12182266/hoesl"}, "reply_to_user": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 0, "creation_date": 1574340011, "post_id": 58954004, "comment_id": 104203562, "body": "@Teamothy If I do that, it doesn&#39;t hide at all"}], "owner": {"reputation": 15, "user_id": 12182266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/523dbd90a19315d8c3a0e707c0fdc816?s=128&d=identicon&r=PG&f=1", "display_name": "Hoesl", "link": "https://stackoverflow.com/users/12182266/hoesl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574272995, "creation_date": 1574251671, "last_edit_date": 1574272995, "question_id": 58954004, "link": "https://stackoverflow.com/questions/58954004/why-does-it-say-runtimeerror9-when-hiding-an-activeworkbook", "title": "Why does it say RuntimeError9 When Hiding an ActiveWorkbook", "body": "<p>As the title says, my aim was to Open another workbook when opening one, which works perfectly fine.</p>\n\n<p>Imagine now that the second workbook has to be opened for calculations on the first one, but I don't want to see the second one at all.</p>\n\n<p>I accomplished that task with the following code:</p>\n\n<pre><code>Private Sub Workbook_Open()\n\nWorkbooks.Open \"E:\\excelweeks\\cw 38.xls\"\nOn Error Resume Next\nActiveWorkbook.Windows(\"cw 38.xls\").Visible = False\n\nEnd Sub\n</code></pre>\n\n<p>It's pretty simple, but gives me </p>\n\n<blockquote>\n  <p>Runtime error \"9\"</p>\n</blockquote>\n\n<p>when running it, which I kind of understand but 1. it works nonetheless 2. can't seem to fix it, so I decided to just ignore the error, but I'm still curious.</p>\n\n<p>Glad for any answer :)</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1574251704, "post_id": 58953931, "comment_id": 104163724, "body": "<a href=\"https://excelchamps.com/blog/max-if-formula/\" rel=\"nofollow noreferrer\">excelchamps.com/blog/max-if-formula</a> should do the trick with just normal excel formula"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1574251943, "post_id": 58953931, "comment_id": 104163879, "body": "A dictionary would be a natural data structure for a VBA solution."}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 1, "creation_date": 1574254009, "post_id": 58953931, "comment_id": 104165111, "body": "One easy approach would be to create a Pivot table (assuming all versions are a numeric value) and then set the value field setting as &quot;MAX&quot;. If you convert your input list to a table then refreshing pivot is what it would take! You will not need any VBA with this route."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1574256595, "post_id": 58953931, "comment_id": 104166676, "body": "As @Luuklag said.  Or if you have the correct Excel version you could use <a href=\"https://support.office.com/en-us/article/MAXIFS-function-dfd611e6-da2c-488a-919b-9b6376b28883\" rel=\"nofollow noreferrer\">MAXIFS</a> which isn&#39;t an array formula."}, {"owner": {"reputation": 41, "user_id": 11001266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0625d0e5b096ce04540f8a4c0decf31?s=128&d=identicon&r=PG&f=1", "display_name": "accurist", "link": "https://stackoverflow.com/users/11001266/accurist"}, "edited": false, "score": 0, "creation_date": 1574265150, "post_id": 58953931, "comment_id": 104172192, "body": "Unfortunately don&#39;t have MAXIFS. I did however used  {MAX(IF} did work like a charm, thanks for advise everybody"}], "owner": {"reputation": 41, "user_id": 11001266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0625d0e5b096ce04540f8a4c0decf31?s=128&d=identicon&r=PG&f=1", "display_name": "accurist", "link": "https://stackoverflow.com/users/11001266/accurist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574251633, "creation_date": 1574251399, "last_edit_date": 1574251633, "question_id": 58953931, "link": "https://stackoverflow.com/questions/58953931/showing-latest-version-vba", "title": "Showing Latest Version VBA", "body": "<p>I need to find a way to show latest version next to corresponding letter. I have two sheets. Sheet1 shows <strong>ALL</strong> the versions that been released so far (the list is constantly growing)\n i.e.:</p>\n\n<p><a href=\"https://i.stack.imgur.com/vXPAY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vXPAY.png\" alt=\"enter image description here\"></a></p>\n\n<p>and sheet2 where the list of available names are, and next to it I would like to have corresponding <strong>LATEST</strong> version only, so for example above this would be like follows</p>\n\n<p><a href=\"https://i.stack.imgur.com/MsUHC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MsUHC.png\" alt=\"enter image description here\"></a></p>\n\n<p>I was thinking to declare variable and use <code>.Find</code> method</p>\n\n<pre><code>Set SearchRange = Worksheets(\"VIEW\").Range(\"A\").End(xlDown)\nSet FindLatestVersion = SearchRange.Find(What:=Version, MatchCase:=False, LookAt:=xlPart)\n</code></pre>\n\n<p>and use if statement.</p>\n\n<p>Could anyone point me into right direction please? </p>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1574250385, "post_id": 58953573, "comment_id": 104162999, "body": "If this is event code you need to disable events before making changes to avoid re-triggering the code."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 1, "creation_date": 1574250411, "post_id": 58953573, "comment_id": 104163017, "body": "Please include the beginning of the code. If it is a worksheet_change event, the code will be an infinite loop"}, {"owner": {"reputation": 13, "user_id": 12403679, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAmk3HFYSZ6HQbYxxyqw38gdP4ibj2t6sTDHb-yTQ=k-s128", "display_name": "Kestas", "link": "https://stackoverflow.com/users/12403679/kestas"}, "edited": false, "score": 0, "creation_date": 1574250699, "post_id": 58953573, "comment_id": 104163197, "body": "Yes its worksheet_change event, so i have to exclude somehow cells that already was written? im out of options at this moment..."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1574250749, "post_id": 58953573, "comment_id": 104163232, "body": "Also <code>For Each cl In Target</code> makes no sense as you have already defined <code>cl</code> as another range (though won&#39;t cause any problems, possibly just unintended consequences)."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 1, "creation_date": 1574250978, "post_id": 58953573, "comment_id": 104163342, "body": "Your for loops make no sense as you exit them before there can be a second iteration"}], "answers": [{"comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "reply_to_user": {"reputation": 13, "user_id": 12403679, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAmk3HFYSZ6HQbYxxyqw38gdP4ibj2t6sTDHb-yTQ=k-s128", "display_name": "Kestas", "link": "https://stackoverflow.com/users/12403679/kestas"}, "edited": false, "score": 0, "creation_date": 1574251665, "post_id": 58953756, "comment_id": 104163699, "body": "Including what the other members have mentioned, you do not require a loop just check target value . <code>if target.value&lt;&gt;&quot;&quot; then</code>"}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": true, "score": 2, "last_activity_date": 1574250769, "creation_date": 1574250769, "answer_id": 58953756, "question_id": 58953573, "link": "https://stackoverflow.com/questions/58953573/appending-text-to-cell-but-stuck-in-loop/58953756#58953756", "title": "Appending text to cell but stuck in loop", "body": "<p>Before making a change to the worksheet you need to set enableEvent to false or the worksheet_change event will kick in again.</p>\n\n<pre><code>application.enableEvents=false\n'change the worksheet\napplication.enableEvents=true\n'resets the worksheet_change event\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 12403679, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAmk3HFYSZ6HQbYxxyqw38gdP4ibj2t6sTDHb-yTQ=k-s128", "display_name": "Kestas", "link": "https://stackoverflow.com/users/12403679/kestas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 58953756, "answer_count": 1, "score": 1, "last_activity_date": 1574253134, "creation_date": 1574250216, "last_edit_date": 1574253134, "question_id": 58953573, "link": "https://stackoverflow.com/questions/58953573/appending-text-to-cell-but-stuck-in-loop", "title": "Appending text to cell but stuck in loop", "body": "<p>My problem is that my code doesn't work how I think it should work. I have Loop in my worksheet_change macro, and in that loop I want that if statement is correct (<code>MsgBox</code> button pressed Yes), what is written in that cell would have appended value at the end of that text.</p>\n\n<p>But if I run this macro and I press Yes - cell value has the value at the end, but MsgBox comes right again, and I'm stuck in that loop... I'm new to VBA programming and syntax. </p>\n\n<p>Can someone help me and explain my mistake?</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim rLockable As Range\nDim cl As Range\n\nSet rLockable = Range(\"C13:J1000\")\nSet cl = Range(\"C13:J1000\")\nSet cele = Range(\"K13:K1000\")\nvardas = ActiveWorkbook.Sheets(\"Login\").Range(\"O8\").Value\n\nSelect Case True\n    Case Not Intersect(rLockable, Target) Is Nothing\n        'If target is within the range then do nothing\n        If Intersect(rLockable, Target) Is Nothing Then Exit Sub\n        ActiveSheet.Unprotect Password:=\"1234\"\n        For Each cl In Target\n            If cl.Value &lt;&gt; \"\" Then\n                check = MsgBox(\"Ar \u00e1ra\u00f0yti \u00e1ra\u00f0\u00e0? Koreguoti \u00e1ra\u00f0o nebegal\u00ebsite.\", vbYesNo, \"\u00c1ra\u00f0o i\u00f0saugojimas\")\n                If check = vbYes Then\n                    Target.Worksheet.Unprotect Password:=\"1234\"\n                    cl.MergeArea.Locked = True\n                    cl.Value = cl.Value &amp; \" \" + vardas\n                Else\n                    cl.Value = \"\"\n                    ActiveSheet.Protect Password:=\"1234\"\n                End If\n            End If\n            Exit For\n        Next cl\n\n    Case Not Intersect(Range(\"K13:K1000\"), Target) Is Nothing\n        ActiveSheet.Unprotect Password:=\"1234\"\n        For Each cele In Target\n            If cele.Value &lt;&gt; \"\" Then\n               cele.Offset(0, 2).MergeArea.Value = vardas\n            End If\n            Exit For\n        Next cele\nEnd Select\n\nActiveSheet.Protect Password:=\"1234\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba", "max", "evaluate"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1574251065, "post_id": 58953568, "comment_id": 104163387, "body": "Surely if the array is very small, looping would be extremely fast."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1574251090, "post_id": 58953568, "comment_id": 104163407, "body": "Do you mean the array is very big?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1574255695, "post_id": 58953568, "comment_id": 104166141, "body": "Check my answer. The total string to be evaluated cannot exceed more than 255 characters. Possibly making this not the way you want to approach this issue =)"}], "answers": [{"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1574251178, "post_id": 58953703, "comment_id": 104163445, "body": "Wondering why that works. Doesn&#39;t Join just produce a string?"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1574251258, "post_id": 58953703, "comment_id": 104163484, "body": "@SJR I wsa just about to ask that :)"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1574251279, "post_id": 58953703, "comment_id": 104163497, "body": "It indeed does so @SJR, but that&#39;s why I included the parenthesis in the full string to be evaluated. Check <code>Debug.Print &quot;MAX(LEN({&quot;&quot;&quot; &amp; Join(arr, &quot;&quot;&quot;,&quot;&quot;&quot;) &amp; &quot;&quot;&quot;}))&quot;</code> also."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 1, "creation_date": 1574251323, "post_id": 58953703, "comment_id": 104163515, "body": "@Zac, it may be confusing, but the <code>Evaluate</code> needs to be &quot;fed&quot; a string to evaluate. Therefor this works. Note: <code>MX_LEN = EVALUATE(&quot;MAX(LEN(&quot; &amp; Rng.Address &amp; &quot;))&quot;)</code> worked for OP because <code>rng.Address</code> returned a string to be concatenated within the <code>Evaluate</code>."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1574251442, "post_id": 58953703, "comment_id": 104163574, "body": "Ah yes, in fact I had missed the double quotes round the commas which presumably turns it into 4 strings. And the curly brackets tell it to evaluate each one separately?"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1574251492, "post_id": 58953703, "comment_id": 104163605, "body": "It maybe my lack of knowledge but seems a very clever way of doing things!"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1574252243, "post_id": 58953703, "comment_id": 104164053, "body": "@SJR, if you find this stuff interesting, you could also be interested in <a href=\"https://stackoverflow.com/questions/58505728/create-one-dimensional-array-from-evaluate\">this</a> and <a href=\"https://stackoverflow.com/q/58524525/9758194\">this</a>. In fact, you have replied over there :)"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1574252253, "post_id": 58953703, "comment_id": 104164057, "body": "@Zac, if you find this stuff interesting, you could also be interested in <a href=\"https://stackoverflow.com/questions/58505728/create-one-dimensional-array-from-evaluate\">this</a> and <a href=\"https://stackoverflow.com/q/58524525/9758194\">this</a>"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1574252845, "post_id": 58953703, "comment_id": 104164415, "body": "Very interesting reading. I do particularly like the use of <code>CHOOSE</code>"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1574253711, "post_id": 58953703, "comment_id": 104164934, "body": "@sifar, no issues on my end. I have tried it. Can you include example data in your question? And a result of <code>Debug.Print &quot;MAX(LEN({&quot;&quot;&quot; &amp; Join(Application.Transpose(Application.Index(Arr, 0, 1)), &quot;&quot;&quot;, &quot;&quot;&quot;) &amp; &quot;&quot;&quot;}))&quot;</code>"}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1574256918, "post_id": 58953703, "comment_id": 104166891, "body": "@JvdV, you are right. i think it would because some of the text is &gt;255 characters. Guess, there is no other way than to use a loop, right?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1574256953, "post_id": 58953703, "comment_id": 104166910, "body": "@Sifar, well....do you know the amount of items that would be in your array beforehand?"}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1574256989, "post_id": 58953703, "comment_id": 104166936, "body": "it would be max 5 to 20 items. not more."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1574257020, "post_id": 58953703, "comment_id": 104166960, "body": "Without a fixed size, I guess a loop will have to be your go to. Otherwise there would be another way. Now looping is your best bet (which as @Rory mentioned should be extremely fast anyway)"}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1574258008, "post_id": 58953703, "comment_id": 104167559, "body": "I checked, the max size was 242. Will that make the Evaluate function not work? Anways, i have alternatively used a Loop now."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 1, "creation_date": 1574258074, "post_id": 58953703, "comment_id": 104167595, "body": "@Sifar, that would indeed be the culprit. The whole string: <code>=MAX(LEN({&quot;Hello&quot;, &quot;World&quot;, &quot;Wide&quot;, &quot;Web&quot;}))</code> must not exceed 255 characters. I&#39;m still trying to find another way, but I guess a loop is your best bet =)"}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1574258636, "post_id": 58953703, "comment_id": 104167961, "body": "Thanks @JvdV, your advice is valuable for me."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1574259327, "post_id": 58953703, "comment_id": 104168378, "body": "@Sifar, there is another way, which I would not recommend, but I will update the answer with it."}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 3, "last_activity_date": 1574259493, "last_edit_date": 1574259493, "creation_date": 1574250601, "answer_id": 58953703, "question_id": 58953568, "link": "https://stackoverflow.com/questions/58953568/evaluate-the-maximum-length-amongst-variable-length-strings-in-an-one-dimensiona/58953703#58953703", "title": "Evaluate the Maximum Length amongst variable length strings in an one-dimensional Array using Excel VBA", "body": "<p>Nice question. You need to <code>Join</code> the array into a string:</p>\n\n<pre><code>Sub Filtering()\n\nDim arr As Variant: arr = Array(\"Hello\", \"World\", \"Wide\", \"Web\")\n\nWith Application\n    Dim MX_LEN As Long: MX_LEN = .Evaluate(\"MAX(LEN({\"\"\" &amp; Join(arr, \"\"\",\"\"\") &amp; \"\"\"}))\")\nEnd With\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>To elaborate a bit more on why this works:</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.evaluate\" rel=\"nofollow noreferrer\"><code>.Evaluate</code></a> needs to be fed a string in the form of a valid formula. Therefor we need to think how we would write this out in an excel sheet. OP mentioned that <code>MX_LEN = EVALUATE(\"MAX(LEN(\" &amp; Rng.Address &amp; \"))\")</code> worked. Very logical because on a worksheet that would read (lets assume rng to be <code>A1:A5</code>):</p>\n\n<pre><code>=MAX(LEN(A1:A5))\n</code></pre>\n\n<p>Now, because <code>Evaluate</code> will recognize that we meant to enter this as an array formula, it will return the correct value.</p>\n\n<p>OP said he want's to feed to function an array. Therefor we can reverse the logic and think how a function on the sheet would look like:</p>\n\n<pre><code>=MAX(LEN({\"Hello\", \"World\", \"Wide\", \"Web\"}))\n</code></pre>\n\n<p>Now we just need to build that string using <code>Join</code> and not forget the curly paranthesis. To check if we build it up correctly one can check with <code>Debug.Print \"MAX(LEN({\"\"\" &amp; Join(arr, \"\"\",\"\"\") &amp; \"\"\"}))\"</code></p>\n\n<hr>\n\n<p>If we want to mimic this, but instead for the first dimension of a two-dimensional array we can apply the following:</p>\n\n<pre><code>With Application\n    MX_LEN = .Evaluate(\"MAX(LEN({\"\"\" &amp; Join(.Transpose(.Index(arr, 0, 1)), \"\"\",\"\"\") &amp; \"\"\"}))\")\nEnd With\n</code></pre>\n\n<hr>\n\n<p><strong>One catch</strong>, just as with a lot more occasions, your string cannot exceed more than 255 characters. Otherwise <code>Evaluate</code> will return an error (as per documentation)</p>\n\n<p>That means <code>.Evaluate</code> cannot be used on large strings, making a loop over the array the most effective go-to strategy.</p>\n\n<p>However, if you really don't want to loop you can populate a cell with a formula instead, and read the cell's resulting <code>value2</code>:</p>\n\n<pre><code>With Application\n    Sheet1.Range(\"A1\").Formula = \"=MAX(LEN({\"\"\" &amp; Join(.Transpose(.Index(arr, 0, 1)), \"\"\",\"\"\") &amp; \"\"\"}))\"\nEnd With\n</code></pre>\n\n<p>Now you can read this through:</p>\n\n<pre><code>MX_LEN = Sheet1.Range(\"A1\").Value2\n</code></pre>\n"}], "owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 3, "accepted_answer_id": 58953703, "answer_count": 1, "score": 1, "last_activity_date": 1574259493, "creation_date": 1574250200, "last_edit_date": 1574253143, "question_id": 58953568, "link": "https://stackoverflow.com/questions/58953568/evaluate-the-maximum-length-amongst-variable-length-strings-in-an-one-dimensiona", "title": "Evaluate the Maximum Length amongst variable length strings in an one-dimensional Array using Excel VBA", "body": "<p>I have a one-dimensional Array that contains variable length strings. I want to find the maximum length amongst these strings using a combination of the <code>EVALUATE</code>, <code>MAX</code> &amp; <code>LEN</code> functions.</p>\n\n<p>I know for a worksheet Range declared <code>Rng</code>, the following code works:</p>\n\n<p><code>MX_LEN = EVALUATE(\"MAX(LEN(\" &amp; Rng.Address &amp; \"))\")</code></p>\n\n<p>But i am not able to achieve something like this with an one-dimensional array <code>Arr</code>.</p>\n\n<p><code>MX_LEN = EVALUATE(\"MAX(LEN(\" &amp; Arr &amp; \"))\")</code></p>\n\n<p><strong>EDIT</strong>:</p>\n\n<p>I am getting <code>Runtime error 13: Type Mismatch</code> with the below code. This one is a 2-D array, of which i am only accessing the 1st dimension. </p>\n\n<p><strong>Observations:</strong></p>\n\n<ul>\n<li><p>The strings here are slightly long viz., approx 100-200 characters each.</p></li>\n<li><p>I see, somehow the starting and ending double quotes are missing in the Join.</p></li>\n</ul>\n\n<p>The code is:</p>\n\n<pre><code>MX = Application.Evaluate(\"MAX(LEN({\"\"\" &amp; Join(Application.Transpose(Application.Index(Arr, 0, 1)), \"\"\", \"\"\") &amp; \"\"\"}))\")\n</code></pre>\n\n<p>P.S: I don't want to loop the array as the array is very small.</p>\n"}, {"tags": ["excel", "vba", "copy"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1574252200, "post_id": 58953484, "comment_id": 104164018, "body": "Is the duplicate row that you keep always blank in column E?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1574252202, "post_id": 58953484, "comment_id": 104164022, "body": "What if the row being retained already has an entry in column 5?"}, {"owner": {"reputation": 3, "user_id": 12403593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acf61edc36707fed3ad35c34169bfa30?s=128&d=identicon&r=PG&f=1", "display_name": "Aku", "link": "https://stackoverflow.com/users/12403593/aku"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1574321315, "post_id": 58953484, "comment_id": 104192834, "body": "@SJR not always, but the first row will overwrite to remaining row if its not blank in the new row. Sorry didn&#39;t clarify it earlier :)"}, {"owner": {"reputation": 3, "user_id": 12403593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acf61edc36707fed3ad35c34169bfa30?s=128&d=identicon&r=PG&f=1", "display_name": "Aku", "link": "https://stackoverflow.com/users/12403593/aku"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1574321349, "post_id": 58953484, "comment_id": 104192854, "body": "@RonRosenfeld Then it will just overwrite it :)"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12403593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acf61edc36707fed3ad35c34169bfa30?s=128&d=identicon&r=PG&f=1", "display_name": "Aku", "link": "https://stackoverflow.com/users/12403593/aku"}, "edited": false, "score": 0, "creation_date": 1574321198, "post_id": 58954783, "comment_id": 104192780, "body": "Wow @RonRosenfeld ! It works so well and so fast. I still have couple of questions (Im VERY new to VBA, so dont mind my questions..) If the cell5 (column that I want to copy to remaining row) isn&#39;t last column on the table, how can I change the location for it in the code? Next question: If I want to overwrite original table and not to do a new table, how can I do that? Your code is so nicely done and its so advanced, so I have little bit struggle to read it, Im sorry :)"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 3, "user_id": 12403593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acf61edc36707fed3ad35c34169bfa30?s=128&d=identicon&r=PG&f=1", "display_name": "Aku", "link": "https://stackoverflow.com/users/12403593/aku"}, "edited": false, "score": 0, "creation_date": 1574336853, "post_id": 58954783, "comment_id": 104201732, "body": "@Aku See my edit in the code above for what you need to do to refer to some column other than the last column (as written, it refers to the last column)."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 3, "user_id": 12403593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acf61edc36707fed3ad35c34169bfa30?s=128&d=identicon&r=PG&f=1", "display_name": "Aku", "link": "https://stackoverflow.com/users/12403593/aku"}, "edited": false, "score": 0, "creation_date": 1574337218, "post_id": 58954783, "comment_id": 104201938, "body": "@Aku  <code>rRes</code> is the range to which the results are written. You can set it to some other range than the offset from <code>rgTable</code> that I used. It needs to be the same size as <code>vRes</code> (the results array).  I would suggest, for audit purposes, not overwriting your original data, but you certainly can. Something like <code>Set rRes = ThisWorkbook.Worksheets(&quot;Sheet2&quot;).cells(1,1).Resize(Ubound(v&zwnj;&#8203;Res,1)+1,Ubound(vRes&zwnj;&#8203;,2))</code>. Suggest also you read the late Chip Pearsons article on <a href=\"http://www.cpearson.com/Excel/ArraysAndRanges.aspx\" rel=\"nofollow noreferrer\">VBA Arrays and Worksheet Ranges</a>"}, {"owner": {"reputation": 3, "user_id": 12403593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acf61edc36707fed3ad35c34169bfa30?s=128&d=identicon&r=PG&f=1", "display_name": "Aku", "link": "https://stackoverflow.com/users/12403593/aku"}, "edited": false, "score": 0, "creation_date": 1574673836, "post_id": 58954783, "comment_id": 104301176, "body": "Hi @RonRosenfeld and thanks again for your help. You are right about the audit purposes, and Im trying to move updated data into another sheet so the original one can be saved also, but Im having some troubles with the code. I have tried to change the code with your assistant and with the article and changed this: Dim rRes As Range Set rRes = rRes.Worksheets(&quot;Sheet2&quot;).Cells(1, 1).Resize(UBound(vRes, 1) + 1, UBound(vRes, 2)) Also I changed from the beggining this: Dim rRes As Range but I still doestn work and gives me an error code. Is this right way to do it?"}, {"owner": {"reputation": 3, "user_id": 12403593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acf61edc36707fed3ad35c34169bfa30?s=128&d=identicon&r=PG&f=1", "display_name": "Aku", "link": "https://stackoverflow.com/users/12403593/aku"}, "edited": false, "score": 0, "creation_date": 1574678611, "post_id": 58954783, "comment_id": 104303943, "body": "Im having hard time perceiving the arrays and ranges, thats why Im confused"}, {"owner": {"reputation": 3, "user_id": 12403593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acf61edc36707fed3ad35c34169bfa30?s=128&d=identicon&r=PG&f=1", "display_name": "Aku", "link": "https://stackoverflow.com/users/12403593/aku"}, "edited": false, "score": 0, "creation_date": 1574692171, "post_id": 58954783, "comment_id": 104311358, "body": "Hi @RonRosenfeld :) I edited my post so it is easier to show what I have changed. Hope this is ok. Error code is &#39;Duplicate declaration in current scope&#39;"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 3, "user_id": 12403593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acf61edc36707fed3ad35c34169bfa30?s=128&d=identicon&r=PG&f=1", "display_name": "Aku", "link": "https://stackoverflow.com/users/12403593/aku"}, "edited": false, "score": 0, "creation_date": 1574692685, "post_id": 58954783, "comment_id": 104311626, "body": "@Aku Delete one of your <code>Dim rRes</code> lines"}, {"owner": {"reputation": 3, "user_id": 12403593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acf61edc36707fed3ad35c34169bfa30?s=128&d=identicon&r=PG&f=1", "display_name": "Aku", "link": "https://stackoverflow.com/users/12403593/aku"}, "edited": false, "score": 0, "creation_date": 1574700003, "post_id": 58954783, "comment_id": 104315681, "body": "Now it gives error code &#39;supscript out of range&#39; should I have Set rRes = rRes.Worksheet(&quot;Sheet2&quot;).Resize(UBound(vRes(J, 1)) + 1, UBound(vRes(J, 2))) this like this?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 3, "user_id": 12403593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acf61edc36707fed3ad35c34169bfa30?s=128&d=identicon&r=PG&f=1", "display_name": "Aku", "link": "https://stackoverflow.com/users/12403593/aku"}, "edited": false, "score": 0, "creation_date": 1574701728, "post_id": 58954783, "comment_id": 104316608, "body": "@Aku No.  Do it as I showed you in my comment above, and make sure you have worksheet named <code>Sheet2</code>."}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 1, "last_activity_date": 1574336785, "last_edit_date": 1574336785, "creation_date": 1574254245, "answer_id": 58954783, "question_id": 58953484, "link": "https://stackoverflow.com/questions/58953484/how-to-delete-duplicates-save-latest-entry-and-copy-data-to-remaining-one/58954783#58954783", "title": "How to delete duplicates, save latest entry and copy data to remaining one?", "body": "<ul>\n<li>suggest using a dictionary object, and storing the row contents as an array.</li>\n<li>then you can \n\n<ul>\n<li>write preceding duplicates cell5 content into that array</li>\n<li>delete the previous key and add it back to re-order it</li>\n</ul></li>\n<li>The algorithm assumes that the last column in the duplicates will be blank, or should always be overwritten by the first of the duplicates. If that is not the case, you will need to specify how that should be handled.</li>\n</ul>\n\n<p>Also, I used a different way of defining <code>rgTable</code> and also worked in VBA arrays as it is much faster than read/write from the worksheet.</p>\n\n<p>Finally, I set the results range to be an offset of rgTable, but if you have this working, and prefer, you can overwrite the original, or put it on a different worksheet.</p>\n\n<p>But this should get you started.</p>\n\n<pre><code>'Set reference to microsoft scripting runtime\n'   or use late binding\nOption Explicit\n\nSub remDup()\n    Dim rgTable As Range, rw As Range\n    Dim dict As Dictionary\n    Dim sKey As String\n    Dim vSrc As Variant, vRes As Variant, vRow As Variant\n    Dim I As Long, J As Long, v As Variant\n\n'should use fully qualified references to avoid confusion\n'For example:\nSet rgTable = ThisWorkbook.Worksheets(\"sheet2\").Cells(1, 1).CurrentRegion\n\n'in VBA, much faster to work with arrays\nvSrc = rgTable\nReDim vRow(1 To UBound(vSrc, 2))\n\nSet dict = New Dictionary\nFor I = 2 To UBound(vSrc) 'skip header row\n    sKey = vSrc(I, 1) &amp; \"|\" &amp; vSrc(I, 2) &amp; \"|\" &amp; vSrc(I, 3)\n    For J = 1 To UBound(vSrc, 2)\n        vRow(J) = vSrc(I, J)\n    Next J\n\n    If Not dict.Exists(sKey) Then\n        dict.Add Key:=sKey, Item:=vRow\n    Else 'add previous col5 to vrow\n         'remove old key and re-enter to re-order\n\n         'To overwrite a different column instead of the last column, replace\n         '(in the line below) Ubound(vRwo)  and  Ubound(dict(sKey)) with the \n         'column number\n        vRow(UBound(vRow)) = dict(sKey)(UBound(dict(sKey)))\n        dict.Remove (sKey)\n        dict.Add Key:=sKey, Item:=vRow\n    End If\nNext I\n\n'create results array\nReDim vRes(0 To dict.Count, 1 To UBound(vSrc, 2))\n\n'headers\nFor J = 1 To UBound(vSrc, 2)\n    vRes(0, J) = vSrc(1, J)\nNext J\n\n'Data\nI = 0\nFor Each v In dict.Keys\n    I = I + 1\n    For J = 1 To UBound(vSrc, 2)\n        vRes(I, J) = dict(v)(J)\n    Next J\nNext v\n\n'write the results\n'once it works ok, can overwrite original\n\nDim rRes As Range\nSet rRes = rgTable.Offset(columnoffset:=2 + rgTable.Columns.Count).Resize(UBound(vRes, 1) + 1, UBound(vRes, 2))\n\nWith rRes\n    .EntireColumn.Clear\n    .Value = vRes\n    .Style = \"Output\"\n    .EntireColumn.AutoFit\nEnd With\n\nEnd Sub\n</code></pre>\n\n<h3>Source Data</h3>\n\n<p><a href=\"https://i.stack.imgur.com/euptO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/euptO.png\" alt=\"enter image description here\"></a></p>\n\n<h3>Results</h3>\n\n<p><a href=\"https://i.stack.imgur.com/LcWfp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LcWfp.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 12403593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acf61edc36707fed3ad35c34169bfa30?s=128&d=identicon&r=PG&f=1", "display_name": "Aku", "link": "https://stackoverflow.com/users/12403593/aku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 58954783, "answer_count": 1, "score": 0, "last_activity_date": 1574692070, "creation_date": 1574249923, "last_edit_date": 1574692070, "question_id": 58953484, "link": "https://stackoverflow.com/questions/58953484/how-to-delete-duplicates-save-latest-entry-and-copy-data-to-remaining-one", "title": "How to delete duplicates, save latest entry and copy data to remaining one?", "body": "<p>My goal is to remove duplicates, save the latest entry and copy specific column data to remaining row. So I have columns from A to E. If columns from A to C are duplicate, older row will be deleted and column E information will be copied to remaining row.</p>\n\n<p>Here is an example:</p>\n\n<pre><code>cell1 cell2 cell3 cell4 cell5\n 1     2     2     4     tax\n 1     3     3     1     extra\n 1     2     2     5     \n 1     2     3     1     tax \n</code></pre>\n\n<p><strong>After macro</strong></p>\n\n<pre><code>cell1 cell2 cell3 cell4 cell5\n 1     3     3     1     extra\n 1     2     2     5     tax\n 1     2     3     1     tax\n</code></pre>\n\n<p>So now, row 1 has been deleted and its 'cell5' information has been copied to row 3.</p>\n\n<p>Here is the code (Deleting duplicates and saving the latest entry works, I just don't know how to save cell5 information and paste it to remaining row). !!EDITED!! (Code changed according to this post's answer by @RonRosenfeld)</p>\n\n<pre><code>Option Explicit\n\nSub remDup()\n    Dim rRes As Range\n    Dim dict As Dictionary\n    Dim sKey As String\n    Dim vSrc As Variant, vRes As Variant, vRow As Variant\n    Dim I As Long, J As Long, v As Variant\n\n'Also changed here rgTable into rRes\nSet rRes = ThisWorkbook.Worksheets(\"Sheet1\").Cells(1, 1).CurrentRegion\n\nvSrc = rRes\nReDim vRow(1 To UBound(vSrc, 2))\n\nSet dict = New Dictionary\nFor I = 2 To UBound(vSrc)\n    sKey = vSrc(I, 1) &amp; \"|\" &amp; vSrc(I, 2) &amp; \"|\" &amp; vSrc(I, 3)\n    For J = 1 To UBound(vSrc, 2)\n        vRow(J) = vSrc(I, J)\n    Next J\n\n    If Not dict.Exists(sKey) Then\n    dict.Add Key:=sKey, Item:=vRow\n    Else \n\n        vRow(UBound(vRow)) = dict(sKey)(UBound(dict(sKey)))\n        dict.Remove (sKey)\n        dict.Add Key:=sKey, Item:=vRow\n    End If\nNext I\n\nReDim vRes(0 To dict.Count, 1 To UBound(vSrc, 2))\n\nFor J = 1 To UBound(vSrc, 2)\n    vRes(0, J) = vSrc(1, J)\nNext J\n\nI = 0\nFor Each v In dict.Keys\n    I = I + 1\n    For J = 1 To UBound(vSrc, 2)\n        vRes(I, J) = dict(v)(J)\n    Next J\nNext v\n\n'here I try to get the new table into sheet2\nDim rRes As Range\nSet rRes = rRes.Worksheet(\"Sheet2\").Resize(UBound(vRes, 1) + 1, UBound(vRes, 2))\n\nWith rRes\n    .EntireColumn.Clear\n    .Value = vRes\n    .Style = \"Output\"\n    .EntireColumn.AutoFit\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula", "excel-2010", "excel-2007"], "answers": [{"tags": [], "owner": {"reputation": 1048, "user_id": 9194464, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-seaWoF1hiDU/AAAAAAAAAAI/AAAAAAAAADo/raR_sZ3tMJo/photo.jpg?sz=128", "display_name": "Jorge Ribeiro", "link": "https://stackoverflow.com/users/9194464/jorge-ribeiro"}, "is_accepted": true, "score": 3, "last_activity_date": 1574250507, "creation_date": 1574250507, "answer_id": 58953664, "question_id": 58953435, "link": "https://stackoverflow.com/questions/58953435/how-to-count-total-numbers-in-specific-cell/58953664#58953664", "title": "How to count total numbers in specific cell", "body": "<p>Try this:</p>\n\n<pre><code>Public Function CountDigits(value As String)\nCountDigits = 0\n\nFor x = 1 To Len(value)\nExt = Mid$(value, x, 1)\nIf InStr(1, \"0123456789\", Ext, vbTextCompare) &gt; 0 Then\nCountDigits = CountDigits + 1\nEnd If\nNext\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "reply_to_user": {"reputation": 133, "user_id": 11542140, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTkSASrLazo/AAAAAAAAAAI/AAAAAAAAABQ/pdJs1QIx6OY/photo.jpg?sz=128", "display_name": "Arshit patel", "link": "https://stackoverflow.com/users/11542140/arshit-patel"}, "edited": false, "score": 0, "creation_date": 1574258632, "post_id": 58953900, "comment_id": 104167957, "body": "Thanks - basically same method as VBA."}], "tags": [], "owner": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "is_accepted": false, "score": 1, "last_activity_date": 1574251680, "last_edit_date": 1574251680, "creation_date": 1574251255, "answer_id": 58953900, "question_id": 58953435, "link": "https://stackoverflow.com/questions/58953435/how-to-count-total-numbers-in-specific-cell/58953900#58953900", "title": "How to count total numbers in specific cell", "body": "<p>You can also do it by formula:</p>\n\n<pre><code>=SUMPRODUCT(--ISNUMBER(FIND(MID(A1,ROW($A$1:INDEX($A:$A,LEN(A1))),1),\"0123456789\")))\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 11542140, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTkSASrLazo/AAAAAAAAAAI/AAAAAAAAABQ/pdJs1QIx6OY/photo.jpg?sz=128", "display_name": "Arshit patel", "link": "https://stackoverflow.com/users/11542140/arshit-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 58953664, "answer_count": 2, "score": 0, "last_activity_date": 1574251680, "creation_date": 1574249742, "last_edit_date": 1574250910, "question_id": 58953435, "link": "https://stackoverflow.com/questions/58953435/how-to-count-total-numbers-in-specific-cell", "title": "How to count total numbers in specific cell", "body": "<p>How can we count total numbers in one cell.</p>\n\n<p>for e.g.  I have 1422.45 in cell F11, Then count value should be 6 considering 1 4 2 2 4 5</p>\n\n<p>here blanks,special character,text etc. should not be counted in other words only numbers should be counted.</p>\n\n<p>This can be solved Either by formula or by vba.</p>\n\n<p>any help ll be appriciated. thank you.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1574256417, "post_id": 58953347, "comment_id": 104166558, "body": "To autofilter dates can be tricky.  See <a href=\"https://stackoverflow.com/questions/19767043/excel-vba-autofilter-not-working-with-date-column\">Excel VBA Autofilter not working with Date column</a>. Basically you need to work with &quot;real dates&quot; and use the numeric equivalent when setting the criteria."}, {"owner": {"reputation": 35, "user_id": 7552259, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FNWdwYf-t4g/AAAAAAAAAAI/AAAAAAAAA4o/CK-FvmTYOuI/photo.jpg?sz=128", "display_name": "devendra", "link": "https://stackoverflow.com/users/7552259/devendra"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1574315335, "post_id": 58953347, "comment_id": 104190482, "body": "Hi Ron Rosenfeld,"}, {"owner": {"reputation": 35, "user_id": 7552259, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FNWdwYf-t4g/AAAAAAAAAAI/AAAAAAAAA4o/CK-FvmTYOuI/photo.jpg?sz=128", "display_name": "devendra", "link": "https://stackoverflow.com/users/7552259/devendra"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1574316430, "post_id": 58953347, "comment_id": 104190867, "body": "Hi Ron Rosenfeld, thanks for the reply. I have referred the post mentioned by you but no luck, could you please help me with the code to exclude 18/Nov/2019 and select remaining dates in autofilter."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1574336524, "post_id": 58953347, "comment_id": 104201561, "body": "Are the dates in your table &quot;real dates&quot;? Or are they text strings? Edit your post to show how you tried to apply the principles shown in the linked post."}], "owner": {"reputation": 35, "user_id": 7552259, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FNWdwYf-t4g/AAAAAAAAAAI/AAAAAAAAA4o/CK-FvmTYOuI/photo.jpg?sz=128", "display_name": "devendra", "link": "https://stackoverflow.com/users/7552259/devendra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574250294, "creation_date": 1574249473, "last_edit_date": 1574250294, "question_id": 58953347, "link": "https://stackoverflow.com/questions/58953347/vba-autofilter-exclude-date-criteria", "title": "VBA Autofilter exclude Date criteria", "body": "<p>I'm trying to filter dates by excluding input date criteria but not succeed, my code selecting all the dates in the filter. Please help me with the code, I want to exclude the input date and select remaining dates in the filter column. below is my code.</p>\n\n<p><a href=\"https://i.stack.imgur.com/xnnX8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xnnX8.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub Date_Filter()\n\nDim fdate As String\n\n\nfdate = InputBox(\"Enter report From date in (Ex: DD/MM/yyy)format Ex:23/Oct/2019\", Format(Now(), \"dd/mmm/yyyy\"))\n\n\nRange(\"A1:G\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row).Select\n\nSelection.AutoFilter Field:=7, Criteria1:=\"&lt;&gt;\" &amp; fdate, Operator:=xlFilterValues\n\nSelection.Copy\nSheets(\"Observation\").Activate\nRange(\"A1\").Select\nActiveSheet.Paste\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "user-defined-functions"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1574251399, "post_id": 58953200, "comment_id": 104163552, "body": "You can&#39;t, as far as I know. <i>Any</i> function that returns <code>#N&#47;A</code> other than <code>NA()</code> will be flagged if you have that error checking option switched on."}, {"owner": {"reputation": 327, "user_id": 8571717, "user_type": "registered", "profile_image": "https://graph.facebook.com/1524531667605038/picture?type=large", "display_name": "Kirill Tkachenko", "link": "https://stackoverflow.com/users/8571717/kirill-tkachenko"}, "edited": false, "score": 2, "creation_date": 1574251779, "post_id": 58953200, "comment_id": 104163765, "body": "Why don&#39;t you use <code>=IFERROR(GTZero(Test1),NA())</code>? If what you are trying to do is to calculate <code>Test1</code> just once, this should work for you."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1574252385, "post_id": 58953200, "comment_id": 104164134, "body": "Instead of returning <code>#N&#47;A</code>, return a &quot;BLANK CELL&quot; as shown <a href=\"https://stackoverflow.com/questions/1119614/return-empty-cell-from-formula-in-excel\">HERE</a>. When I say &quot;BLANK CELL&quot;, I do not mean <code>&quot;&quot;</code> as this will get plotted in the chart. Also Right click on the <code>Chart | Select Data | Hidden and Empty Cells | Show Empty Cell as &quot;Connect data points with line&quot;</code>This again is tested on a line chart."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1574252832, "post_id": 58953200, "comment_id": 104164405, "body": "BTW I am referring to <code>Przemyslaw Remin</code> answer in the above link"}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1574276792, "post_id": 58953200, "comment_id": 104178407, "body": "My original assumption was that &quot;Test1&quot; was a named range. However, the statement &quot;As the formulae for Test<i>n</i> are long&quot; gives me some doubt. How is <code>Test1</code> really represented when you call the function? Because otherwise your code seems fine."}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1574277229, "post_id": 58953200, "comment_id": 104178633, "body": "BTW, I just tested your code as written in Excel O365, and it worked as expected. And yes, it is a &#39;true error&#39; because that is what you are telling the UDF to do."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 3665109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4rQ7M.jpg?s=128&g=1", "display_name": "ChemEnger", "link": "https://stackoverflow.com/users/3665109/chemenger"}, "edited": false, "score": 0, "creation_date": 1574258021, "post_id": 58953884, "comment_id": 104167563, "body": "Thanks @ImaginaryHuman.  That&#39;s a really elegant solution and I get it but I&#39;d be a bit worried about someone coming along later and getting worried by the EXP and LN!"}, {"owner": {"reputation": 4326, "user_id": 8370633, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/gxmCt.png?s=128&g=1", "display_name": "ImaginaryHuman072889", "link": "https://stackoverflow.com/users/8370633/imaginaryhuman072889"}, "reply_to_user": {"reputation": 71, "user_id": 3665109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4rQ7M.jpg?s=128&g=1", "display_name": "ChemEnger", "link": "https://stackoverflow.com/users/3665109/chemenger"}, "edited": false, "score": 0, "creation_date": 1574279318, "post_id": 58953884, "comment_id": 104179676, "body": "That seems like a silly reason to not do something... but ok. Anyway you should mark one of these answers as correct if they helped you."}, {"owner": {"reputation": 71, "user_id": 3665109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4rQ7M.jpg?s=128&g=1", "display_name": "ChemEnger", "link": "https://stackoverflow.com/users/3665109/chemenger"}, "edited": false, "score": 0, "creation_date": 1575024967, "post_id": 58953884, "comment_id": 104438916, "body": "A thought - could also use <code>=IFERROR(Test1^1,NA())</code> to give the same sort of result?"}, {"owner": {"reputation": 4326, "user_id": 8370633, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/gxmCt.png?s=128&g=1", "display_name": "ImaginaryHuman072889", "link": "https://stackoverflow.com/users/8370633/imaginaryhuman072889"}, "reply_to_user": {"reputation": 71, "user_id": 3665109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4rQ7M.jpg?s=128&g=1", "display_name": "ChemEnger", "link": "https://stackoverflow.com/users/3665109/chemenger"}, "edited": false, "score": 1, "creation_date": 1575120579, "post_id": 58953884, "comment_id": 104463297, "body": "@ChemEnger No... (any number)^1 is always defined, even for negative numbers. This accomplishes nothing. Try it for yourself. (-1)^1 still returns (-1) in Excel."}], "tags": [], "owner": {"reputation": 4326, "user_id": 8370633, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/gxmCt.png?s=128&g=1", "display_name": "ImaginaryHuman072889", "link": "https://stackoverflow.com/users/8370633/imaginaryhuman072889"}, "is_accepted": false, "score": 1, "last_activity_date": 1574251185, "creation_date": 1574251185, "answer_id": 58953884, "question_id": 58953200, "link": "https://stackoverflow.com/questions/58953200/excel-vba-to-generate-n-a-error-on-sheet/58953884#58953884", "title": "Excel VBA to generate #N/A error on sheet", "body": "<p>No VBA needed. You can do this trick using formulas:</p>\n\n<p><em>e^(ln(whatever))</em> always returns <em>whatever</em> because <em>e^</em> and <em>ln()</em> are inverse functions.</p>\n\n<p>Except... <em>ln()</em> has no real solution for negative numbers and 0, resulting in error in Excel, which is what you want.</p>\n\n<p>So you can do this:</p>\n\n<pre><code>= IFERROR(EXP(LN(Test1)),NA())\n</code></pre>\n\n<p>Same as your formula, except <code>Test1</code> only appears once.</p>\n\n<p>See below working example. Formula in <code>B1</code> is dragged down.</p>\n\n<p><a href=\"https://i.stack.imgur.com/z7uo4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/z7uo4.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 3665109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4rQ7M.jpg?s=128&g=1", "display_name": "ChemEnger", "link": "https://stackoverflow.com/users/3665109/chemenger"}, "edited": false, "score": 0, "creation_date": 1574258546, "post_id": 58953934, "comment_id": 104167902, "body": "Looks like you&#39;re right.  I think probably your suggestion of just <code>=IFERROR(GTZero(Test1),NA())</code> is going to be the way to go.  Either that or live with / &#39;ignore the flags."}], "tags": [], "owner": {"reputation": 327, "user_id": 8571717, "user_type": "registered", "profile_image": "https://graph.facebook.com/1524531667605038/picture?type=large", "display_name": "Kirill Tkachenko", "link": "https://stackoverflow.com/users/8571717/kirill-tkachenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1574251407, "creation_date": 1574251407, "answer_id": 58953934, "question_id": 58953200, "link": "https://stackoverflow.com/questions/58953200/excel-vba-to-generate-n-a-error-on-sheet/58953934#58953934", "title": "Excel VBA to generate #N/A error on sheet", "body": "<p>Seems like this is not possible. I've tried putting <code>=NA()</code> or just <code>#N/A</code> as string in one cell and returning a reference to that cell from the UDF. I've also tried defining a name which refers to <code>=NA()</code> and returning this name, but nothing worked. \n<br>According to <a href=\"https://support.office.com/en-GB/Article/detect-errors-in-formulas-3a8acca5-1d61-4702-80e0-99a36a2822c1\" rel=\"nofollow noreferrer\">support.office.com</a>:</p>\n\n<blockquote>\n  <p>Note: If you enter an error value directly in a cell, it is stored as that error value but is not marked as an error. However, if a formula in another cell refers to that cell, the formula returns the error value from that cell.</p>\n</blockquote>\n"}], "owner": {"reputation": 71, "user_id": 3665109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4rQ7M.jpg?s=128&g=1", "display_name": "ChemEnger", "link": "https://stackoverflow.com/users/3665109/chemenger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 543, "favorite_count": 0, "accepted_answer_id": 58953934, "answer_count": 2, "score": 2, "last_activity_date": 1574251407, "creation_date": 1574249033, "question_id": 58953200, "link": "https://stackoverflow.com/questions/58953200/excel-vba-to-generate-n-a-error-on-sheet", "title": "Excel VBA to generate #N/A error on sheet", "body": "<p>I have a sheet formula of <code>IF(Test1&gt;0, Test1, NA())</code> which is designed to put a 'controlled' #N/A in the sheet if the condition is not met.  Similarly, I am using <code>IFERROR(Test2,NA())</code> elsewhere in the same sheet.</p>\n\n<p>As the formulae for Test<em>n</em> are long, I would like to put them into a UDF but can't find a way to generate a 'controlled' #N/A error (one not green-flagged as an error on the sheet).</p>\n\n<p>So far I have got as far as:</p>\n\n<pre><code>Function GTZero(sngInput As Single) As Variant\n\n    If sngInput &gt; 0 Then GTZero = sngInput Else GTZero = CVErr(xlErrNA)\n\nEnd Function\n</code></pre>\n\n<p>This is then called in the sheet as <code>=GTZero(Test1)</code>. The answer <em>looks</em> right but Excel flags this as a true error.  I don't want to just use \"#N/A\" text as I need to use the results in a chart and want to skip the #N/As</p>\n"}, {"tags": ["excel", "vba", "filter"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1574249014, "post_id": 58952968, "comment_id": 104162211, "body": "What type of data are we talking about in column C. Just single words?"}, {"owner": {"reputation": 1, "user_id": 9945472, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LqdEq9SsmlA/AAAAAAAAAAI/AAAAAAAAADE/9r9hk1QUp4U/photo.jpg?sz=128", "display_name": "andreacomi", "link": "https://stackoverflow.com/users/9945472/andreacomi"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1574254466, "post_id": 58952968, "comment_id": 104165385, "body": "It&#39;s a string like &quot;Name XWord Word&quot; or &quot;Word Y Word&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9945472, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LqdEq9SsmlA/AAAAAAAAAAI/AAAAAAAAADE/9r9hk1QUp4U/photo.jpg?sz=128", "display_name": "andreacomi", "link": "https://stackoverflow.com/users/9945472/andreacomi"}, "edited": false, "score": 0, "creation_date": 1574254091, "post_id": 58953558, "comment_id": 104165150, "body": "Thank you @JvdV! I&#39;ve understood the logic of the first part. I don&#39;t understand <code>If .SpecialCells(12).Count &gt; 5 Then .Offset(1).Resize(lr - 1, 5).Rows.EntireRow.Delete</code> and I don&#39;t see the first filter for the date (e.g.31/10/2019)"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 1, "user_id": 9945472, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LqdEq9SsmlA/AAAAAAAAAAI/AAAAAAAAADE/9r9hk1QUp4U/photo.jpg?sz=128", "display_name": "andreacomi", "link": "https://stackoverflow.com/users/9945472/andreacomi"}, "edited": false, "score": 0, "creation_date": 1574255063, "post_id": 58953558, "comment_id": 104165756, "body": "A short breakdown: <code>.SpecialCells(12).Count</code> will count all visible cells first to ensure we won&#39;t get an error in the occasion where you would have zero hits. Then the <code>.Offset(1).Resize(lr-1,5)</code> will get a new range object underneath your header row. The <code>5</code> specifically is there because you talking about a 5 column range."}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 1, "last_activity_date": 1574250167, "creation_date": 1574250167, "answer_id": 58953558, "question_id": 58952968, "link": "https://stackoverflow.com/questions/58952968/vba-to-filter-value-in-two-colums-and-to-delete-rows/58953558#58953558", "title": "VBA to filter value in two colums and to delete rows", "body": "<p>Here is something you can work with and get some ideas from hopefully. I made an example with some sample data. It's a bit extensive (read: It can be made more compact), but I'm hoping you'll be able to understand what is going on like this.</p>\n\n<hr>\n\n<p><strong><em><sub>Sample data:</sub></em></strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/0sCZ0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0sCZ0.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p><strong><em><sub>Sample code:</sub></em></strong></p>\n\n<pre><code>Option Explicit\n\nSub Filtering()\n\nDim lr As Long\nDim rng As Range\n\nWith Sheet1 'Change according to your sheets CodeName\n\n    'Retrieve the last used row\n    lr = .Cells(.Rows.Count, 1).End(xlUp).Row\n\n    'Set your range object where you want to apply a filter\n    Set rng = .Range(\"A1:E\" &amp; lr)\n\n    With rng\n\n        'Apply first two filters in one go\n        .AutoFilter 3, Array(\"*X*\", \"*Y*\"), xlFilterValues\n\n        'Test for visible rows and if so, delete them\n        If .SpecialCells(12).Count &gt; 5 Then .Offset(1).Resize(lr - 1, 5).Rows.EntireRow.Delete\n\n        'Apply second filter\n        .AutoFilter 3, \"&lt;&gt;*Z*\", xlFilterValues\n\n        'Test for visible rows and if so, delete them\n        If .SpecialCells(12).Count &gt; 5 Then .Offset(1).Resize(lr - 1, 5).Rows.EntireRow.Delete\n\n        'Remove filter\n        .AutoFilter\n\n    End With\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong><em><sub>Result:</sub></em></strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/AvTk6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AvTk6.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 9945472, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LqdEq9SsmlA/AAAAAAAAAAI/AAAAAAAAADE/9r9hk1QUp4U/photo.jpg?sz=128", "display_name": "andreacomi", "link": "https://stackoverflow.com/users/9945472/andreacomi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574266557, "creation_date": 1574248258, "last_edit_date": 1574266557, "question_id": 58952968, "link": "https://stackoverflow.com/questions/58952968/vba-to-filter-value-in-two-colums-and-to-delete-rows", "title": "VBA to filter value in two colums and to delete rows", "body": "<p>I'm working on a sub() to import a .csv that i receive monthly (it's my very first macro).\nThe structure of the file is very easy: there are 5 columns and a variable number of rows.</p>\n\n<p>In columns A there are dates (dd/mm/yyyy), in B codes, in C names, in D and E statistics (numbers).\nIn the first row I have created a row with titles.\nHere the code:</p>\n\n<pre><code>Sub ImportCSV()\n\n    With ActiveSheet.QueryTables.Add(Connection:= _\n        \"TEXT;D:\\File.csv\", Destination:=Range(\"$A$1\"))\n        Application.ScreenUpdating = False\n        .Name = \"FileName\"\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .TextFilePromptOnRefresh = False\n        .TextFilePlatform = 850\n        .TextFileStartRow = 1\n        .TextFileParseType = xlDelimited\n        .TextFileTextQualifier = xlTextQualifierDoubleQuote\n        .TextFileConsecutiveDelimiter = False\n        .TextFileTabDelimiter = True\n        .TextFileSemicolonDelimiter = True\n        .TextFileCommaDelimiter = False\n        .TextFileSpaceDelimiter = False\n        .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1)\n        .TextFileDecimalSeparator = \".\"\n        .TextFileThousandsSeparator = \",\"\n        .TextFileTrailingMinusNumbers = True\n        .Refresh BackgroundQuery:=False\n         Application.ScreenUpdating = True\n    End With\n\n    Range(\"A1\").EntireRow.Insert\n    Cells(1, 1) = \"DATE\"\n    Cells(1, 2) = \"CODE\"\n    Cells(1, 3) = \"NAME\"\n    Cells(1, 4) = \"STATS1\"\n    Cells(1, 5) = \"STATS2\"\n    Rows(\"1:1\").Select\n    Selection.Font.Bold = True\n    Selection.HorizontalAlignment = xlCenter\n\n    Columns(\"D\").NumberFormat = \"#,##0.00\"\n    Columns(\"D\").HorizontalAlignment = xlCenter\n    Columns(\"E\").NumberFormat = \"#,##0.00\"\n    Columns(\"E\").HorizontalAlignment = xlCenter\n\n    Range(\"A1:E1\").Select\n    Selection.AutoFilter\n    Cells.Select\n    Cells.EntireColumn.AutoFit\n\n    Range(\"C2\").Select\n    ActiveWindow.FreezePanes = True\n\nEnd Sub\n</code></pre>\n\n<p>Now, I would like to clean these sheet with a filter that:</p>\n\n<ul>\n<li>can select the last day of the previous month from column A (usually\nI receive the file during the firs days of the current month. In\ncolumn A could be also dates of the current month so I can't select \nthe last day...alternatively, I was thinking about an inputbox) and\nthen delete all the other dates; <strong>in this column I have dates repeated</strong></li>\n<li>then, the filter is on column C and should apply 3 different filter:\n\n<ol>\n<li>cells in column C <strong>with the word \"x\"</strong> and then delete these rows;</li>\n<li>cells in column C <strong>with the word \"y\"</strong> and then delete these rows;</li>\n<li>cells in column C <strong>without the word \"z\"</strong> and then delete these rows;</li>\n</ol></li>\n</ul>\n\n<p>Hope that everything is clear...</p>\n"}, {"tags": ["excel", "vba", "pdf", "reporting-services", "ssrs-2012"], "answers": [{"tags": [], "owner": {"reputation": 466, "user_id": 11372842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7fc959664b448651c4b254e99f6fc5b?s=128&d=identicon&r=PG&f=1", "display_name": "Geoff Griswald", "link": "https://stackoverflow.com/users/11372842/geoff-griswald"}, "is_accepted": true, "score": 1, "last_activity_date": 1574261127, "last_edit_date": 1574261127, "creation_date": 1574260362, "answer_id": 58956763, "question_id": 58952637, "link": "https://stackoverflow.com/questions/58952637/how-do-i-loop-through-a-list-of-report-paramaters-in-excel-and-automatically-gen/58956763#58956763", "title": "How do I loop through a list of report paramaters in Excel and automatically generate Report Server Reports as .PDF using VBA?", "body": "<p>After quite a bit of Googling and some trial and error, I have a working solution.</p>\n\n<p>I placed my list into columns A and B of a worksheet named \"Control\" in Excel, and in column C I added a folder name, so that statements for each product type go to a different folder. I then run this VBA on the worksheet:</p>\n\n<pre><code>Declare PtrSafe Function URLDownloadToFile Lib \"urlmon\" Alias \"URLDownloadToFileA\" _\n(ByVal pCaller As Long, ByVal szURL As String, ByVal szFileName As String, _\nByVal dwReserved As Long, ByVal lpfnCB As Long) As Long\n\nSub DownloadStatements()\n\nDim wb As Workbook\nSet wb = ThisWorkbook\nDim Product As String\nDim CustomerID As String\n\n'Loop down all records in Control sheet\nFor x = 2 To wb.Sheets(\"Control\").Range(\"A1\").CurrentRegion.Rows.Count\n\n    'Set CustomerID to the relevant value\n    CustomerID = wb.Sheets(\"Control\").Range(\"A\" &amp; x).Value\n\n    'Set ClientString to the relevant value\n    Product = wb.Sheets(\"Control\").Range(\"B\" &amp; x).Value\n\n    'Set download filename to CustomerID + \".pdf\"\n    DownloadFile$ = CustomerID &amp; \".pdf\"\n\n    'Set download URL as the report URL, passing in the Product and CustomerID as paramaters\n    Url$ = \"http://myreportserver/ReportServer/Pages/ReportViewer.aspx?%2fCustomer+Reports%2fCustomer+Statement&amp;rs:Format=PDF&amp;rs:ClearSession=true&amp;CustomerID=\" &amp; CustomerID &amp; \"&amp;Product=\" &amp; Product\n\n    'Set local download location based on main output folder cell and output subfolder cell for the specific row\n    LocalFilename$ = wb.Sheets(\"Control\").Range(\"E2\").Value &amp; wb.Sheets(\"Control\").Range(\"C\" &amp; x) &amp; DownloadFile\n\n    'Download the file (in a slightly cheaty way)\n    On Error Resume Next\n    Debug.Print \"Some junk text \" &amp; URLDownloadToFile(0, Url, LocalFilename, 0, 0) = 0\n    On Error GoTo 0\n\nNext x\n\nEnd Sub\n</code></pre>\n\n<p>All works perfectly, Excel will sit there and churn through the list creating the .PDF files, it's pretty quick and will be easy to automate further!</p>\n"}], "owner": {"reputation": 466, "user_id": 11372842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7fc959664b448651c4b254e99f6fc5b?s=128&d=identicon&r=PG&f=1", "display_name": "Geoff Griswald", "link": "https://stackoverflow.com/users/11372842/geoff-griswald"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 58956763, "answer_count": 1, "score": -1, "last_activity_date": 1574261127, "creation_date": 1574247256, "last_edit_date": 1574259614, "question_id": 58952637, "link": "https://stackoverflow.com/questions/58952637/how-do-i-loop-through-a-list-of-report-paramaters-in-excel-and-automatically-gen", "title": "How do I loop through a list of report paramaters in Excel and automatically generate Report Server Reports as .PDF using VBA?", "body": "<p>I have an SSRS report named \"Customer Statement\", and a large list of customer IDs and the relevant product a customer has bought. EG:</p>\n\n<ul>\n<li>C1222, Broadband</li>\n<li>C1223, Broadband</li>\n<li>C1224, Mobile</li>\n<li>C1225, Broadband</li>\n<li>C1226, Mobile</li>\n</ul>\n\n<p>... (approx 10,000 records)</p>\n\n<p>The report generates a customer statement and has two parameters, one for the type of report and one for the customer ID.</p>\n\n<p>I need to save an individual .PDF of the exported report for each customer and place it into a folder, named as the customer ID. EG \"C1222.pdf\"</p>\n\n<p>I've figured out half the problem, I can download the .PDF file directly from Report Server using an URL that looks something like this:</p>\n\n<p><a href=\"http://myreportserver/ReportServer/Pages/ReportViewer.aspx?%2fCustomer+Reports%2fCustomer+Statement&amp;rs:Format=PDF&amp;rs:ClearSession=true&amp;Product=Broadband&amp;CustomerID=C1222\" rel=\"nofollow noreferrer\">http://myreportserver/ReportServer/Pages/ReportViewer.aspx?%2fCustomer+Reports%2fCustomer+Statement&amp;rs:Format=PDF&amp;rs:ClearSession=true&amp;Product=Broadband&amp;CustomerID=C1222</a></p>\n\n<p>Opening that link in a web browser automatically downloads the report as a .PDF file named \"Customer Statement.pdf\", with the correct parameters passed in.</p>\n\n<p>What I need is to loop through my entire list and produce a file for each row, with the relevant parameters passed into the URL. The filename of the .PDF needs to be the customer ID from the list.</p>\n\n<p>Ideally I want to do this in Excel with a VBA macro, but I'm open to using Powershell, SQL Server or even a Windows batch file if that would be easier.</p>\n\n<p>EDIT:</p>\n\n<p>I have SSRS Standard Edition, so a \"Data-Driven Subscription\" is not an option for me.</p>\n"}, {"tags": ["vba", "if-statement", "foreach"], "answers": [{"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": true, "score": 4, "last_activity_date": 1574244705, "creation_date": 1574244705, "answer_id": 58951740, "question_id": 58951693, "link": "https://stackoverflow.com/questions/58951693/use-if-statement-to-push-next-statement-if-true/58951740#58951740", "title": "Use IF statement to push Next statement if true", "body": "<p>Instead, just nest all the code you didnt include in your question inside the If statement, and switch the condition to the opposite of the boolean:</p>\n\n<pre><code>If Not comment_Or_coupon Then\n  ' i want to continue doing code\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1574266396, "post_id": 58952586, "comment_id": 104172950, "body": "Although using <code>GoTo</code> is considered very bad practice these days, and should be used only when absolutely necessary."}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1574272368, "post_id": 58952586, "comment_id": 104176278, "body": "@braX: Why is it a bad practice? Not only these days...When you are in a For Each loop, it is the best way to jump at the end of it. You also can avoid the case of reference missing in some cases, I think."}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 1, "creation_date": 1574277938, "post_id": 58952586, "comment_id": 104178968, "body": "Spaghetti code using <code>GoTo</code> is always bad practice. The <code>Do While</code> or <code>Do Until</code> loop constructs can be used instead of <code>For x =</code> or <code>For Each</code> Loops. Or you can <code>Exit For</code>. All of these have better control, readability and maintainability. Remember, your <code>GoTo</code> will work fine until it doesn&#39;t and then you will have difficulty in troubleshooting or understanding why that single line of code that you added screwed completely with your logic."}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1574281706, "post_id": 58952586, "comment_id": 104180808, "body": "@AJD: But, in this specific case the trick was to not exit the loop. Just to jump to the end of the loop in some specific circumstances. Avoiding If - End if. Why GoTo will not work as expected ? I think that exactly for avoiding debugging confusions the label is automatically positioned to the editor most left position, independent of your wish."}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 1, "creation_date": 1574308571, "post_id": 58952586, "comment_id": 104188794, "body": "<code>If</code>.. <code>End If</code> will skip the extra code, and the <code>End If</code> should bring you out near the end of the loop. It <b><i>should</i></b> do that because you <b><i>should</i></b> code it that way. <code>GoTo</code> can be easily broken, especially if you continue down your paradigm. What if you want two exits? what if you put an extra line of code in - before the <code>Goto</code>, after the <code>GoTo</code> or around the <code>Label:</code>? From a maintenance perspective, it is too easy to start missing things because trying to follow <code>GoTo</code> logic branches (and the relevant values of variables) gets difficult and complicated. This is coding 101 these days."}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 1, "creation_date": 1574308719, "post_id": 58952586, "comment_id": 104188828, "body": "And, having seen how some people indent (or don&#39;t indent) their code - there is no guarantees that the label will stick out! Of course, if you wish to continue to fly in the face of experience and learn the lessons the hard way, feel free! Remind me in 5 years time to ask about your views on <code>GoTo</code> again :-)."}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "edited": false, "score": 0, "creation_date": 1574327285, "post_id": 58952586, "comment_id": 104195868, "body": "I learned about this myth and I tried to understand it. Experimenting also and trying to understand the potential bad things able to happen. I program in VBA from more than 15 years and initially I tried to avoid using or GoTo, because of that myth. But I started to use it when served better my intentions and nothing wrong happened. So, I can have as many &#39;exits&#39; I want! But they must be located before the GoTo or after its label. Anyhow, in the presented case you couldn&#39;t use such &#39;Exits&#39; because the code between If and End If does not run. I can also put as many lines I want after the label."}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1574327776, "post_id": 58952586, "comment_id": 104196132, "body": "@AJD: Without indenting, the code is infinitely more difficult to be debugged if you use If .. End If (with a lot of others If ..End If in between). In this case, having an error you must visually check what is happening there. It is obviously easier to find a label, I think. But making the long story short, I do not care about &quot;I should code in that way&quot;. I can accept that it may be something dangerous which I do not faced/know. But, can you explain <b>Why</b> is it better? Otherwise, with all respect, I consider we are just losing time."}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1574362714, "post_id": 58952586, "comment_id": 104216547, "body": "Simple search reveals many links. But that requires reading and understanding all the arguments. And, simply put - your example of <code>GoTo</code> in the above code is a bad use of <code>GoTo</code> - for all the reasons people suggest <code>GoTo</code> is still useful your code has none of them. <a href=\"https://www.harrisgeospatial.com/Learn/Blogs/Blog-Details/ArtMID/10198/ArticleID/15289/Why-should-GOTO-be-avoided\" rel=\"nofollow noreferrer\">harrisgeospatial.com/Learn/Blogs/Blog-Details/ArtMID/10198/&hellip;</a> <a href=\"https://stackoverflow.com/q/46586/9101981\">stackoverflow.com/q/46586/9101981</a> <a href=\"https://www.drdobbs.com/jvm/programming-with-reason-why-is-goto-bad/228200966?pgno=1\" rel=\"nofollow noreferrer\">drdobbs.com/jvm/programming-with-reason-why-is-goto-bad/&hellip;</a> <a href=\"https://en.wikipedia.org/wiki/Goto\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Goto</a> <a href=\"http://www.cs.utexas.edu/users/EWD/ewd02xx/EWD215.PDF\" rel=\"nofollow noreferrer\">cs.utexas.edu/users/EWD/ewd02xx/EWD215.PDF</a>"}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1574363454, "post_id": 58952586, "comment_id": 104216887, "body": "<a href=\"https://stackoverflow.com/q/16599982/9101981\">stackoverflow.com/q/16599982/9101981</a> <a href=\"https://stackoverflow.com/q/52705264/9101981\">stackoverflow.com/q/52705264/9101981</a> <a href=\"https://www.quora.com/Why-is-the-goto-statement-in-C-advised-to-avoid\" rel=\"nofollow noreferrer\">quora.com/Why-is-the-goto-statement-in-C-advised-to-avoid</a>"}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1574369793, "post_id": 58952586, "comment_id": 104219742, "body": "@AJD: I would conclude that you are knocking to an open door giving those example. On my test, both of them prove that not using <code>GoTo</code> is a myth or a pretentious approach. I think it&#39;s a pity to fight on the issue. I can admit that it may not be the best approach, but since the main invoked issue/argument on the subject is the not very well code readability, I state that I can handle this aspect even better than in <code>If - End If</code> cases... I like learning and if you have some other links trying to bring arguments, not statements I will read them with attention. Thanks, anyhow!"}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1574383327, "post_id": 58952586, "comment_id": 104224025, "body": "I have taken the water to the horse, but I cannot make the horse drink. Don&#39;t look at those articles for reasons to reinforce your current views - look at those articles for the arguments against your current views and see how that fits in with your example above. It behoves all of us providing answers to practice the best code hygiene that we can. Avoiding <code>IF ,,, End If</code> for ideological reasons as you are is exhibiting the very behaviour that you seem to railing against for the &#39;GoTo myth&#39;."}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1574410942, "post_id": 58952586, "comment_id": 104231381, "body": "@AJD: I do not say that you are not right. I try to say that you maybe are not right... I would like to emphasize the idea that I am not against, I do not try to avoid <code>IF ... End If</code>. I use <code>GoTo</code> very seldom but, when it does its &quot;job&quot; better (on my taste, of course), then I use it. Without bothering of the &quot;myth&quot;... I used to believe the &quot;myth&quot;, but only some years before."}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1574411034, "post_id": 58952586, "comment_id": 104231418, "body": "@AJD:  In this very case we are talking about, nothing can persuade me that the solution was wrong. All the argumentation regarding some eventual Exits does not stand. The piece of code between <code>If ... End If</code>, anyhow is jumped by the code. On the contrary, supposing that condition in the piece of code using <code>GoTo</code> is false, and you need &quot;exits&quot; in the following code, you can also use the <code>label</code>, in case you need to reach the end of the loop, remaining inside it. Besides <code>Exit For</code>and <code>Exit Sub</code> which exits the loop. Based on this discussion I only can promise to check the &quot;myth&quot; deeper. :-)"}], "tags": [], "owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "is_accepted": false, "score": 0, "last_activity_date": 1574247096, "creation_date": 1574247096, "answer_id": 58952586, "question_id": 58951693, "link": "https://stackoverflow.com/questions/58951693/use-if-statement-to-push-next-statement-if-true/58952586#58952586", "title": "Use IF statement to push Next statement if true", "body": "<p>In order to make us understand your need, I think you must better describe what you need.\nIf I correctly understand, next code should do what you want to do:</p>\n\n<pre><code> For Each rowHeader In tempList:\n        comment_Or_coupon = False\n        If InStr(1, LCase(rowHeader), \"comment\", vbTextCompare) = 0 Then _\n                                comment_Or_coupon = True: GoTo NextRowHeader\n        If InStr(1, LCase(rowHeader), \"coupon\", vbTextCompare) = 0 Then _\n                                comment_Or_coupon = True: GoTo NextRowHeader      \n\n         ' you can do here whatever you want. This part of the code will be running only \n         ' if the previous two conditions are false. If you need 'comment_Or_coupon'\n         ' boolean variable only for this reason, you can delete it.\n\nNextRowHeader:\n Next rowHeader\n</code></pre>\n"}], "owner": {"reputation": 189, "user_id": 12344417, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207096864594264/picture?type=large", "display_name": "Sam Harper", "link": "https://stackoverflow.com/users/12344417/sam-harper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 58951740, "answer_count": 2, "score": 0, "last_activity_date": 1574247096, "creation_date": 1574244563, "last_edit_date": 1574245005, "question_id": 58951693, "link": "https://stackoverflow.com/questions/58951693/use-if-statement-to-push-next-statement-if-true", "title": "Use IF statement to push Next statement if true", "body": "<p>I am trying to look at ways to if a statement is true, go to next for statement instead of carrying on code.</p>\n\n<p>The issue is kicking off on <code>If comment_Or_coupon Then goto Next rowHeader</code>, because I can't go to the next <code>rowHeader</code>.</p>\n\n<pre><code>Sub UniqueFetchDBTabletest()\n\nDim tempList As Variant\nDim rowHeader As Variant\nDim comment_Or_coupon As Boolean\n\ntempList = [RangeofIDCells]\n\nFor Each rowHeader In tempList:\n    comment_Or_coupon = False\n    If InStr(1, LCase(rowHeader), \"comment\", vbTextCompare) = 0 Then comment_Or_coupon = True\n    If InStr(1, LCase(rowHeader), \"coupon\", vbTextCompare) = 0 Then comment_Or_coupon = True\n    If comment_Or_coupon Then goto Next rowHeader\n\n    ' else I want to continue doing code\n\nNext rowHeader\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["python", "excel", "python-3.x", "vba", "xlsxwriter"], "answers": [{"tags": [], "owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "is_accepted": false, "score": 0, "last_activity_date": 1574250618, "creation_date": 1574250618, "answer_id": 58953713, "question_id": 58951584, "link": "https://stackoverflow.com/questions/58951584/vba-script-to-trigger-python-and-saving-down-xlsx-file/58953713#58953713", "title": "VBA script to trigger Python and saving down xlsx file", "body": "<p>Does that 'excel_file' have a path?\nDoes Python use a current directory and automatically add it to Excel file name?\nIf yes, do you know how to obtain it and can you look for .xlsx file there?\nIf not, how do you check if the .xlsx file has been saved? Where are you looking for?\nDoes Python raise any error?</p>\n\n<p>I am looking to the code mostly like a VBA user...\nI would suggest to send a message from Python, containing the current directory path. Supposing that the .xlsx workbook path has not somehow been defined and the code presented here does not include that part. Theoretically it should use the same current directory, but I think it is good to be checked...</p>\n"}], "owner": {"reputation": 327, "user_id": 2560244, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/PKzId.jpg?s=128&g=1", "display_name": "abhi_phoenix", "link": "https://stackoverflow.com/users/2560244/abhi-phoenix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574250618, "creation_date": 1574244242, "last_edit_date": 1574244454, "question_id": 58951584, "link": "https://stackoverflow.com/questions/58951584/vba-script-to-trigger-python-and-saving-down-xlsx-file", "title": "VBA script to trigger Python and saving down xlsx file", "body": "<p>I am trying to save the .xlsx file and using VBA as a wrapper to execute the python file. However,  I can validate that python code runs, but somehow .xlsx file is not saved. When I run the same python file via IDE, it saves down the .xlsx file.</p>\n\n<p><strong>VBA code</strong></p>\n\n<pre><code>Sub RunPython()\n\nDim shell As Object\nDim exepath, scriptPath As String\n\nSet Shell = VBA.CreateObject(\"Wscript.Shell\")\nexePath = \"\"\"C:\\Program Files\\...\\python.exe\"\"\"\nscriptPath = \"C:\\....\\mymodule.py\"\n</code></pre>\n\n<p><strong>Python Script</strong></p>\n\n<pre><code>import pandas as pd\nimport xlsxwriter\n\ndf = pd.DataFrame(np.random.randn(5,2),index=range(0,10,2),columns =list('AB'))\nexcel_file ='sample.xlsx'\nwriter = pd.ExcelWriter(excel_file,engine='xlsxwriter')\ndf.to_excel(writer,sheet_name='Data')\nprint (\"file read\")\nwriter.save()\nwriter.close()\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 99, "user_id": 10379438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c8cc36aa4c8e8b9108366f5e3ec1d43?s=128&d=identicon&r=PG", "display_name": "Christophe C.", "link": "https://stackoverflow.com/users/10379438/christophe-c"}, "edited": false, "score": 0, "creation_date": 1574244967, "post_id": 58951549, "comment_id": 104159828, "body": "If I understand your response, I would have to add .value to trainingDate = training.Rows (4)&quot;?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1574245285, "post_id": 58951549, "comment_id": 104160009, "body": "Which line errors? You are probably not finding the search term."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1574245460, "post_id": 58951549, "comment_id": 104160133, "body": "<code>allDate = .Range(&quot;A2:A&quot; &amp; lastRow)</code> should be <code>Set allDate = .Range(&quot;A2:A&quot; &amp; lastRow)</code>"}, {"owner": {"reputation": 99, "user_id": 10379438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c8cc36aa4c8e8b9108366f5e3ec1d43?s=128&d=identicon&r=PG", "display_name": "Christophe C.", "link": "https://stackoverflow.com/users/10379438/christophe-c"}, "edited": false, "score": 0, "creation_date": 1574245495, "post_id": 58951549, "comment_id": 104160153, "body": "Indeed, the error is located at the line firstRowDate = .... Yet the date sought is present in the sheet &quot;B&quot;"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1574245613, "post_id": 58951549, "comment_id": 104160221, "body": "That is becuase it could not find the relevant cell. You need to check if the <code>.Find</code> was successful before finding the row using <code>If Not FoundCell is nothing</code> before using <code>FoundCell.Row</code> You may want to see <a href=\"http://www.siddharthrout.com/index.php/2018/01/05/find-and-findnext-in-excel-vba/\" rel=\"nofollow noreferrer\">THIS</a>"}, {"owner": {"reputation": 99, "user_id": 10379438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c8cc36aa4c8e8b9108366f5e3ec1d43?s=128&d=identicon&r=PG", "display_name": "Christophe C.", "link": "https://stackoverflow.com/users/10379438/christophe-c"}, "edited": false, "score": 0, "creation_date": 1574245805, "post_id": 58951549, "comment_id": 104160350, "body": "I tried this solution and the problem is the same"}], "answers": [{"comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 2, "creation_date": 1574246081, "post_id": 58952149, "comment_id": 104160535, "body": "Nicely explained. One more thing <code>firstRowDate = allDate.Find(What:=trainingDate, After:=.Range(&quot;A&quot; &amp; lastRow)).Row</code> will give error if the <code>.Find</code> doesn&#39;t return a range object"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1574246760, "post_id": 58952149, "comment_id": 104160955, "body": "Good addition @SiddharthRout. Didn&#39;t think of that at first since OP said his lookup value is 100% surely there. But it most likely isn&#39;t (in the form/data type) he is expecting it to be in"}, {"owner": {"reputation": 99, "user_id": 10379438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c8cc36aa4c8e8b9108366f5e3ec1d43?s=128&d=identicon&r=PG", "display_name": "Christophe C.", "link": "https://stackoverflow.com/users/10379438/christophe-c"}, "edited": false, "score": 0, "creation_date": 1574265458, "post_id": 58952149, "comment_id": 104172379, "body": "Thank you for all your advice. I just applied but the problem is still not solved."}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 2, "last_activity_date": 1574246698, "last_edit_date": 1574246698, "creation_date": 1574245795, "answer_id": 58952149, "question_id": 58951549, "link": "https://stackoverflow.com/questions/58951549/find-a-date-in-other-sheet/58952149#58952149", "title": "Find a date in other sheet", "body": "<p>There are a few things going wrong here:</p>\n\n<hr>\n\n<p><strong><em>First:</em></strong> Declare your variables, it's even best to use <code>Option Explicit</code> on top of your module to actually make you not forget any. Otherwise VBA will try to make an educated guess which will be a <code>Variant</code> type of the date type.</p>\n\n<p><strong><em>Second</em></strong> I would try to avoid <code>ActiveSheet</code> but instead use a <code>CodeName</code>. For example <code>Sheet1.Range(\"...\")</code>. <a href=\"https://stackoverflow.com/q/10714251/9758194\">This</a> post on SO can clarify a thing or two on this matter.</p>\n\n<p><strong><em>Third</em></strong>, <code>UsedRange</code> is not the most reliable way to return a last used column. Instead I would go with something like:</p>\n\n<pre><code>With Sheet1 'The explicit sheet reference from the first point\n    lastColTraining = .Cells(1, .Columns.Count).End(xlToLeft).Column\nEnd with\n</code></pre>\n\n<p><strong><em>Fourth</em></strong>: You don't really need the column letter to refer to the column. There are other ways, for example using <code>.Cells</code> within a range. You could use:</p>\n\n<pre><code>With Sheet1 'The explicit sheet reference from the first point\n    lastColTraining = .Cells(1, .Columns.Count).End(xlToLeft).Column\n    Set allTraining = .Range(.Cells(3,11),.Cells(lastColTraining,11))`\nEnd with\n</code></pre>\n\n<p><strong><em>Fifth:</em></strong> If you have a <code>Range</code> object, you want to (most likely) <code>Set</code> it as a <code>Range</code> object. Otherwise (as per my first point) Excel will make an educated guess and in your case will return an array when you write: <code>allDate = .Range(\"A2:A\" &amp; lastRow)</code>, instead use: <code>Set allDate = .Range(\"A2:A\" &amp; lastRow)</code></p>\n\n<p><strong><em>Sixth</em></strong>: As per @SiddharthRout his comment, you'll recieve an error once your value isn't found. You can test that first trying to <code>Set</code> a <code>FoundRange</code> and check if it's not nothing.</p>\n\n<p>Considering all the above, your code would run smoother using:</p>\n\n<pre><code>Option Explicit\n\nSub SearchDate()\n\nDim lastColTraining As Long, lastRow As Long, firstRowDate\nDim allTraining As Range, training As Range, allDate As Range, FoundCell As Range\nDim trainingDate As Variant\n\nWith Sheet1 'Change according to your sheets CodeName\n    lastColTraining = .Cells(1, .Columns.Count).End(xlToLeft).Column\n    Set allTraining = .Range(.Cells(3, 11), .Cells(7, lastColTraining))\n    For Each training In allTraining.Columns\n        trainingDate = training.Rows(4)\n        With Worksheets(\"B\")\n            lastRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n            Set allDate = .Range(\"A2:A\" &amp; lastRow)\n            Set FoundCell = allDate.Find(What:=trainingDate, AFter:=.Range(\"A\" &amp; lastRow))\n            If Not FoundCell Is Nothing Then firstRowDate = FoundCell.Row\n        End With\n   Next training\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>I'm just not sure what you want with <code>trainingDate = training.Rows(4)</code>. If you just interested in the 7th row of each column, then refer to that Range instead. Neither am I sure what your goal is with the code, but hopefully you can get it to work now.</p>\n"}], "owner": {"reputation": 99, "user_id": 10379438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c8cc36aa4c8e8b9108366f5e3ec1d43?s=128&d=identicon&r=PG", "display_name": "Christophe C.", "link": "https://stackoverflow.com/users/10379438/christophe-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1584688455, "creation_date": 1574244121, "last_edit_date": 1584688455, "question_id": 58951549, "link": "https://stackoverflow.com/questions/58951549/find-a-date-in-other-sheet", "title": "Find a date in other sheet", "body": "<p>I extract a date from sheet \"A\" to find in a sheet \"B\".</p>\n\n<p>I have the same type of date in each sheet (type 7) and the date exists.</p>\n\n<p>With the code below I have </p>\n\n<blockquote>\n  <p>Error 91 : Object variable or With undefined block variable</p>\n</blockquote>\n\n<pre><code>Sub SearchDate()\n    lastColTraining = ActiveSheet.UsedRange.SpecialCells(xlCellTypeLastCell).Column\n    lastLetterTraining = Split(Cells(1, lastColTraining).Address, \"$\")(1)\n    Set allTraining = Range(\"K3:\" &amp; lastLetterTraining &amp; \"7\")\n    For Each training In allTraining.Columns\n        trainingDate = training.Rows(4)\n        With Worksheets(\"B\")\n            lastRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n            allDate = .Range(\"A2:A\" &amp; lastRow)\n            firstRowDate = allDate.Find(What:=trainingDate, After:=.Range(\"A\" &amp; lastRow)).Row\n        End With\n    Next training\nEnd Sub\n</code></pre>\n\n<p>I scoured many forums and tried different solutions without finding an answer.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 1534, "user_id": 5373986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5937e22068b8355cf94c4c18f747660f?s=128&d=identicon&r=PG&f=1", "display_name": "Taazar", "link": "https://stackoverflow.com/users/5373986/taazar"}, "edited": false, "score": 0, "creation_date": 1574249117, "post_id": 58951484, "comment_id": 104162271, "body": "Query01 should probably be in quotes at the very top, <code>= &quot;Query01&quot;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 9, "user_id": 12366104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/085e6540757cf86f8d06da9283882e9d?s=128&d=identicon&r=PG&f=1", "display_name": "Lourensohn", "link": "https://stackoverflow.com/users/12366104/lourensohn"}, "is_accepted": false, "score": 0, "last_activity_date": 1574252793, "creation_date": 1574252793, "answer_id": 58954356, "question_id": 58951484, "link": "https://stackoverflow.com/questions/58951484/how-do-i-prompt-for-a-csv-user-input-on-my-on-start-event-for-my-form/58954356#58954356", "title": "How do I prompt for a CSV user input on my on-start event for my form?", "body": "<p>I fixed my issue by using the Filter-method instead and just deleting the declaration in line 2 since the data source was already defined in the properties sheet before.\nMy VBA code:</p>\n\n<pre><code>Private Sub Form_Open(Cancel As Integer)\nDim m As String\n\nm = InputBox(\"Enter itemID (numeric), separated by comma\", \"itemID\")\nIf m &lt;&gt; \"\" Then\n     Me.Filter = \"itemID in (\" &amp; m &amp; \")\"\n      Me.FilterOn = True\nElse\n     Me.FilterOn = False\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Hope this helps anyone encountering a similar problem.\nCheers!</p>\n"}], "owner": {"reputation": 9, "user_id": 12366104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/085e6540757cf86f8d06da9283882e9d?s=128&d=identicon&r=PG&f=1", "display_name": "Lourensohn", "link": "https://stackoverflow.com/users/12366104/lourensohn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1594237435, "creation_date": 1574243924, "last_edit_date": 1594237435, "question_id": 58951484, "link": "https://stackoverflow.com/questions/58951484/how-do-i-prompt-for-a-csv-user-input-on-my-on-start-event-for-my-form", "title": "How do I prompt for a CSV user input on my on-start event for my form?", "body": "<p>at work, we're trying to build a database to get an output of all kinds of data from different excel tables (items in stock, sales per week, price, etc) into one table by using the ItemID as primary key for all the tables and as a user input for the queries.</p>\n\n<p>My goal is to let the user enter multiple itemIDs seperated by commas and get back a table with multiple rows (one for each item).</p>\n\n<p>I have now created a form with all the fields I need and have used one of my queries that I implemented before as my data source.\nI'm trying to write some code for my On-Start event and have used an example someone posted online regarding entering multiple parameters:</p>\n\n<pre><code>Option Compare Database\n\nConst record source = Query01\n\n\n\nPrivate Sub Form_Open(Cancel As Integer)\n\nDim m As String\n\nm = InputBox(\"Enter itemID (numeric), separated by comma\", \"itemID\")\n\nIf m &lt;&gt; \"\" Then\n\nMe.RecordSource = record_source &amp; \" where itemID in (\" &amp; m &amp; \");\"\n\nElse\n\nMe.RecordSource = record_source\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>For the line:</p>\n\n<pre><code>Me.RecordSource = record_source &amp; \" where SKU in (\" &amp; m &amp; \");\"\n</code></pre>\n\n<p>I get the error</p>\n\n<pre><code>Run-Time error '2580'\nThe record source 'where SKU in (\" &amp; m &amp; \");' specified on this form or report does not exist.\n</code></pre>\n\n<p>Do I need to declare my record source differently in the second line? Do I need to somehow specify which table I get my \"itemID\" field out of? The Query01 that I put as my data source gets fields out of three different tables.</p>\n\n<p>Thank you so much for your help!\nCheers!</p>\n"}, {"tags": ["excel", "vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 2, "last_activity_date": 1574245354, "creation_date": 1574245354, "answer_id": 58951994, "question_id": 58951405, "link": "https://stackoverflow.com/questions/58951405/assign-a-variable-to-an-opened-excel-workbook-from-access/58951994#58951994", "title": "Assign a variable to an opened Excel workbook from Access", "body": "<p>You don't need any of this, only the full path to the Excel file. Then <code>GetObject()</code> can get a reference to the open workbook.</p>\n\n<pre><code>sPath = \"C:\\my\\path\\myWorkbook.xlsx\"\nSet wb = GetObject(sPath)\n' Demo\nDebug.Print wb.Sheets(1).Cells(1,1).Value\n' If you need the Application\nSet g_xl = wb.Application\n</code></pre>\n\n<p>This will only start a new Excel instance, if the file isn't open.</p>\n"}, {"tags": [], "owner": {"reputation": 823, "user_id": 4786843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwVWr.jpg?s=128&g=1", "display_name": "NeepNeepNeep", "link": "https://stackoverflow.com/users/4786843/neepneepneep"}, "is_accepted": false, "score": 1, "last_activity_date": 1574245654, "creation_date": 1574245654, "answer_id": 58952097, "question_id": 58951405, "link": "https://stackoverflow.com/questions/58951405/assign-a-variable-to-an-opened-excel-workbook-from-access/58952097#58952097", "title": "Assign a variable to an opened Excel workbook from Access", "body": "<p>With g_xl as type <code>Excel.Application</code>, that commented line is going to be </p>\n\n<pre><code>Set g_xl = CreateObject(\"Excel.Application\")\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Set g_xl = GetObject(\"Excel.Application\")\n</code></pre>\n\n<p>The latter will hook up with an existing <code>Excel.Application</code> which is what I think you're trying to do.  It will create a new instance if an existing one isn't found.</p>\n"}], "owner": {"reputation": 189, "user_id": 3057893, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/nvJwi.jpg?s=128&g=1", "display_name": "Javier", "link": "https://stackoverflow.com/users/3057893/javier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1577728690, "creation_date": 1574243674, "last_edit_date": 1577728690, "question_id": 58951405, "link": "https://stackoverflow.com/questions/58951405/assign-a-variable-to-an-opened-excel-workbook-from-access", "title": "Assign a variable to an opened Excel workbook from Access", "body": "<p>I am working on an Access database with VBA, which needs to obtain data from an Excel workbook.</p>\n\n<p>I need to assign a variable to the open book (set g_xl = ????) without opening another Excel instance (appoint to opened workbook).</p>\n\n<pre><code>Sub AssignVariableToExcelApplication()\n    Dim g_xl As Excel.Application\n    Dim strComputer As String\n    Dim objWMIService As Object\n    Dim colitems As Object\n    Dim objitem As Object\n\n    strComputer = \".\"\n    Set objWMIService = GetObject(\"winmgmts:\\\\\" &amp; strComputer &amp; \"\\root\\CIMV2\")\n    Set colitems = objWMIService.ExecQuery(\"SELECT * FROM Win32_Process\", , 48)\n\n    Dim row As Integer\n    row = 1\n    For Each objitem In colitems\n        If objitem.Name = \"EXCEL.EXE\" Then\n            Debug.Print objitem.ProcessID &amp; vbCrLf &amp; _\n                        objitem.Name &amp; vbCrLf &amp; _\n                        objitem.Caption &amp; vbCrLf &amp; _\n                        objitem.CommandLine &amp; vbCrLf &amp; _\n                        objitem.ExecutablePath\n\n            'This is the question\n            'Set g_xl = objitem ?????? (I need that g_xl appoints to objitem)\n            Exit For\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1574241188, "post_id": 58950311, "comment_id": 104157539, "body": "A UDF can only be used to set the value, not the formula. If the function returns a formula like in your example, then you would have to use it within code (like the example below illustrates), not as a UDF."}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1574241950, "post_id": 58950311, "comment_id": 104157991, "body": "I see that is unfortunate. I thought I could simplify my code by using a UDF. My problem is that I have to use events to actually activate the code which is troublesome because events often fire when cells are changed or worksheets are activated/deactivated (for my case) and sometimes the cells do not update or updates too often and is more error prone. I used to hard code all the conditions in the cell without VBA but would be a half page to 1 page long formula--which is too hard to look at and error prone due to too many nested loops"}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1574243443, "post_id": 58950311, "comment_id": 104158879, "body": "But then this method is also error prone now that I think about it since changes to the data will not be considered once the UDF can be replaced by a hard coded formula. I guess using events is the way to go to automate"}], "answers": [{"comments": [{"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1574243562, "post_id": 58950445, "comment_id": 104158950, "body": "Thanks although I had automation in mind when asking the question. But as mentioned above it is not possible for a UDF to replace it into a formula"}], "tags": [], "owner": {"reputation": 57, "user_id": 10530856, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kKum1VFRLRA/AAAAAAAAAAI/AAAAAAAAABs/pMhQPLeWjrI/photo.jpg?sz=128", "display_name": "Jhaze Franco", "link": "https://stackoverflow.com/users/10530856/jhaze-franco"}, "is_accepted": false, "score": -1, "last_activity_date": 1574243302, "last_edit_date": 1574243302, "creation_date": 1574240739, "answer_id": 58950445, "question_id": 58950311, "link": "https://stackoverflow.com/questions/58950311/how-to-create-a-user-defined-function-in-vba-that-will-replace-the-cell-that-cal/58950445#58950445", "title": "How to create a user defined function in VBA that will replace the cell that calls the user defined function into another formula?", "body": "<p>You should add <code>.FormulaLocal</code> at the end of the cell assignment to read it as a formula in excel</p>\n\n<p><code>WorkSheet.Cells[1, 1].FormulaLocal = Hours_alloted()</code></p>\n"}, {"comments": [{"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1574322713, "post_id": 58954539, "comment_id": 104193457, "body": "I was hoping it had a visual effect for the user using the excel worksheet. But apparently it is not possible and makes it more error prone and less flexible. So I guess i&#39;m sticking to this calculated in the VBA functions"}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1574328459, "post_id": 58954539, "comment_id": 104196576, "body": "It is not complicated to reproduce your worksheet function in VBA. Name it whatever you like. But it should return the result..."}], "tags": [], "owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "is_accepted": false, "score": 0, "last_activity_date": 1574253445, "creation_date": 1574253445, "answer_id": 58954539, "question_id": 58950311, "link": "https://stackoverflow.com/questions/58950311/how-to-create-a-user-defined-function-in-vba-that-will-replace-the-cell-that-cal/58954539#58954539", "title": "How to create a user defined function in VBA that will replace the cell that calls the user defined function into another formula?", "body": "<p>But why using a formula able to create a formula, and not the result of the formula. Of course, calculated in that VBA function...</p>\n"}], "owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1574253445, "creation_date": 1574240266, "question_id": 58950311, "link": "https://stackoverflow.com/questions/58950311/how-to-create-a-user-defined-function-in-vba-that-will-replace-the-cell-that-cal", "title": "How to create a user defined function in VBA that will replace the cell that calls the user defined function into another formula?", "body": "<p>For instance I have a user defined function, but if I do <code>=Hours_alotted()</code> it will cause the cell to be populated with a string <code>\"=min(8, [@[Hours Worked]])\"</code> instead of replacing the formula in excel like the image shown below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/RqDSO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RqDSO.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Function Hours_allotted()\n    Hours_allotted = \"=min(8, [@[Hours Worked]])\"\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "combobox"], "comments": [{"owner": {"reputation": 521, "user_id": 12268796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LVipW.jpg?s=128&g=1", "display_name": "barneyos", "link": "https://stackoverflow.com/users/12268796/barneyos"}, "edited": false, "score": 1, "creation_date": 1574240524, "post_id": 58950229, "comment_id": 104157160, "body": "To fill ComboBox control you may use <code>.RowSource</code> method instead, e.g. <a href=\"https://docs.microsoft.com/en-us/office/vba/api/access.combobox.rowsource\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 2, "creation_date": 1574241627, "post_id": 58950229, "comment_id": 104157804, "body": "I guess the error would come from your named ranges not being present on &quot;LookupLists&quot; sheet."}, {"owner": {"reputation": 10618, "user_id": 2018133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e3fd4734236360fc59fa597dc8f9ffa7?s=128&d=identicon&r=PG", "display_name": "Geert Bellekens", "link": "https://stackoverflow.com/users/2018133/geert-bellekens"}, "edited": false, "score": 1, "creation_date": 1574241926, "post_id": 58950229, "comment_id": 104157974, "body": "On which line do you get an error? have you checked if you didn&#39;t misspell the name of the range?"}, {"owner": {"reputation": 1, "user_id": 12402688, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JJ5FPbA1AVA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rchxUlER-iUkpFFFd6bMBom4fpWoQ/photo.jpg?sz=128", "display_name": "Darcy", "link": "https://stackoverflow.com/users/12402688/darcy"}, "edited": false, "score": 0, "creation_date": 1574755008, "post_id": 58950229, "comment_id": 104333417, "body": "Thanks for your help everyone! I ended up taking an .AddItem approach for each option in the ComboBox, as there was only a small number of set options for each list, and this way kept it nice and simple."}], "owner": {"reputation": 1, "user_id": 12402688, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JJ5FPbA1AVA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rchxUlER-iUkpFFFd6bMBom4fpWoQ/photo.jpg?sz=128", "display_name": "Darcy", "link": "https://stackoverflow.com/users/12402688/darcy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574240909, "creation_date": 1574239999, "last_edit_date": 1574240909, "question_id": 58950229, "link": "https://stackoverflow.com/questions/58950229/vba-userform-comboboxes-getting-run-time-1004-method-range-of-object-work", "title": "VBA: Userform Comboboxes (Getting run-time 1004: Method &#39;Range&#39; of object &#39;_Worksheet)", "body": "<p>I am trying to set up a userform with multiple (7) comboboxes as drop down lists. I want some of the comboboxes to display the same list from my 'Lookuplists' sheet as they feed into different sections of a database.</p>\n\n<p>I have used a similar code for a user form with 1 combo box with success, but I just keep getting the </p>\n\n<blockquote>\n  <p>Method 'Range' of object '_Worksheet error</p>\n</blockquote>\n\n<p>as soon as I have more than 1 combobox. Any help or advice is much appreciated! </p>\n\n<p>The code I'm using is as follows:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\nDim cMeal As Range\nDim cSPFC As Range\nDim cSPMT As Range\nDim cKFFC As Range\nDim cKFMT As Range\nDim cPMFC As Range\nDim cPMMT As Range\nDim ws As Worksheet\nSet ws = Worksheets(\"LookupLists\")\n\nFor Each cMeal In ws.Range(\"Meal\")\n    With Me.cbMeal\n        .AddItem cMeal.value\n    End With\nNext cMeal\n\nFor Each cSPFC In ws.Range(\"FluidConsistency\")\n    With Me.cbSPFC\n        .AddItem cSPFC.value\n    End With\nNext cSPFC\n\nFor Each cSPMT In ws.Range(\"MealTexture\")\n    With Me.cbSPMT\n        .AddItem cSPMT.value\n    End With\nNext cSPMT\n\nFor Each cKFFC In ws.Range(\"FluidConsistency\")\n    With Me.cbKFFC\n        .AddItem cKFFC.value\n    End With\nNext cKFFC\n\nFor Each cKFMT In ws.Range(\"MealTexture\")\n    With Me.cbKFMT\n        .AddItem cKFMT.value\n    End With\nNext cKFMT\n\nFor Each cPMFC In ws.Range(\"FluidConsistency\")\n    With Me.cbPMFC\n        .AddItem cPMFC.value\n    End With\nNext cPMFC\n\nFor Each cPMMT In ws.Range(\"MealTexture\")\n    With Me.cbPMMT\n        .AddItem cPMMT.value\n    End With\nNext cPMMT\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1574239632, "post_id": 58950084, "comment_id": 104156626, "body": "Please include the code you are using in your question to attempt this."}, {"owner": {"reputation": 101, "user_id": 10206926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1abcb91b73a358b0458351b1b4fe0c8e?s=128&d=identicon&r=PG&f=1", "display_name": "sant", "link": "https://stackoverflow.com/users/10206926/sant"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1574239875, "post_id": 58950084, "comment_id": 104156759, "body": "Yes updated, in the Code <b>team_name</b> is TextBox to <b>search</b> and <b>emp_name</b> is Textbox to <b>Replace</b> the team name"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1574243023, "post_id": 58950084, "comment_id": 104158647, "body": "Are they always in groups of 3? What exactly is the problem with your current code? You would benefit from reading <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a>"}, {"owner": {"reputation": 101, "user_id": 10206926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1abcb91b73a358b0458351b1b4fe0c8e?s=128&d=identicon&r=PG&f=1", "display_name": "sant", "link": "https://stackoverflow.com/users/10206926/sant"}, "edited": false, "score": 0, "creation_date": 1574246891, "post_id": 58950084, "comment_id": 104161039, "body": "When I run my Code the new rows are copied in different rows not as I required."}, {"owner": {"reputation": 101, "user_id": 10206926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1abcb91b73a358b0458351b1b4fe0c8e?s=128&d=identicon&r=PG&f=1", "display_name": "sant", "link": "https://stackoverflow.com/users/10206926/sant"}, "edited": false, "score": 0, "creation_date": 1574251506, "post_id": 58950084, "comment_id": 104163610, "body": "Yes it is always in Groups of 3"}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 10206926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1abcb91b73a358b0458351b1b4fe0c8e?s=128&d=identicon&r=PG&f=1", "display_name": "sant", "link": "https://stackoverflow.com/users/10206926/sant"}, "edited": false, "score": 0, "creation_date": 1574319861, "post_id": 58958804, "comment_id": 104192160, "body": "This works perfect!! If the Groups of 3 varies to 4 or 5 but I need first 3 lines only, what changes to be made in the Code?"}], "tags": [], "owner": {"reputation": 459, "user_id": 10547271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/59Gqb.png?s=128&g=1", "display_name": "AsUsual", "link": "https://stackoverflow.com/users/10547271/asusual"}, "is_accepted": true, "score": 2, "last_activity_date": 1574343919, "last_edit_date": 1574343919, "creation_date": 1574266376, "answer_id": 58958804, "question_id": 58950084, "link": "https://stackoverflow.com/questions/58950084/how-to-copy-insert-and-replace-cell-data-based-on-cell-content-search-in-comulm/58958804#58958804", "title": "How to copy, insert and replace cell data based on cell content search in comulmns using VBA", "body": "<p>I don't see how your code could give that result, try this.</p>\n\n<pre><code>Sub Add()\n    Dim sh As Worksheet, c As Range, cnt As Integer, cl As Long, tN$, eN$\n\n    Set sh = Sheets(1) 'sheet by index\n    cl = 4 'column by index\n    tN = \"blue\": eN = \"green\"\n\n    With sh\n        'For cl = 3 To 5 Step 2\n            For Each c In .Range(Cells(1, cl), Cells(Rows.Count, cl).End(xlUp))\n                If LCase(c) Like LCase(tN) &amp; \"*\" Then\n                    .Cells(c.Row, 1).Resize(, 6).Copy .Cells(Rows.Count, 1).End(xlUp).Offset(1).Resize(, 6)\n                    .Cells(Rows.Count, 1).End(xlUp).Resize(, 6).Replace tN, eN, xlWhole, , False\n                    If cnt &gt; 3 Then Exit Sub\n                    cnt = cnt + 1\n                End If\n            Next c\n        'Next cl\n    End With\nEnd Sub\n</code></pre>\n\n<p>LCase() isn't needed if you're consistent in your input to the code.</p>\n\n<p>And if you want to loop through your columns of choice un-comment [For cl..] and [Next cl], this won't result in 3 rows though, since C or E doesn't contain any team on row 6.</p>\n"}], "owner": {"reputation": 101, "user_id": 10206926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1abcb91b73a358b0458351b1b4fe0c8e?s=128&d=identicon&r=PG&f=1", "display_name": "sant", "link": "https://stackoverflow.com/users/10206926/sant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 58958804, "answer_count": 1, "score": 1, "last_activity_date": 1574343919, "creation_date": 1574239536, "last_edit_date": 1574239713, "question_id": 58950084, "link": "https://stackoverflow.com/questions/58950084/how-to-copy-insert-and-replace-cell-data-based-on-cell-content-search-in-comulm", "title": "How to copy, insert and replace cell data based on cell content search in comulmns using VBA", "body": "<p>I am trying to copy all the 3 rows which contains cells with \"red\" and similar with blue when the user gives the Input in the userform. </p>\n\n<p>What I required is, when the user gives \"red\" and want to replace red with \"green\" and \"click on commandbutton\", the new rows should be created by copying the rows contatining red and <strong>replace red with green</strong>.</p>\n\n<p><em>Userform:</em></p>\n\n<p>TextBox to search : red</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Sub Add()\r\n\r\nsheet_name = \"Sheet1\"\r\ncolumn_name = \"C\"\r\n\r\nFor r = 1 To Sheets(sheet_name).Range(column_name &amp; Rows.Count).End(xlUp).row\r\n    If Trim(Sheets(sheet_name).Cells(r, column_name).Value) = team_name Then\r\n        Sheets(sheet_name).Rows(r).EntireRow.Select\r\n        Selection.Copy\r\n        ActiveCell.Offset(1, 0).Rows(\"1:1\").EntireRow.Select\r\n        Selection.Insert Shift:=xlDown\r\n        Selection.Replace What:=team_name, Replacement:=emp_name, LookAt:=xlPart, _\r\n                    SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\r\n                    ReplaceFormat:=False\r\n    End If\r\nNext\r\ncolumn_name = \"E\"\r\nFor r = 1 To Sheets(sheet_name).Range(column_name &amp; Rows.Count).End(xlUp).row\r\n    If Trim(Sheets(sheet_name).Cells(r, column_name).Value) = team_name Then\r\n        Sheets(sheet_name).Rows(r).EntireRow.Select\r\n        Selection.Copy\r\n        ActiveCell.Offset(1, 0).Rows(\"1:1\").EntireRow.Select\r\n        Selection.Insert Shift:=xlDown\r\n        Selection.Replace What:=team_name, Replacement:=emp_name, LookAt:=xlPart, _\r\n                    SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\r\n                    ReplaceFormat:=False\r\n    End If\r\nNext\r\nEnd sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>TextBox to replace : green\nThe Excel sheet Looks like below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/j9IrZ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/j9IrZ.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Output should be like below:\n<a href=\"https://i.stack.imgur.com/SIvSU.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SIvSU.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1574239468, "post_id": 58949981, "comment_id": 104156546, "body": "hi. should it be <code>myFile=fullpath</code>? fullPath is a variable and not a text, correct ?"}, {"owner": {"reputation": 1, "user_id": 11249444, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lqsPD4Ga_YQ/AAAAAAAAAAI/AAAAAAAAAvE/rtjac2xMb8Y/photo.jpg?sz=128", "display_name": "ajinkya gaikwad", "link": "https://stackoverflow.com/users/11249444/ajinkya-gaikwad"}, "reply_to_user": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1574240305, "post_id": 58949981, "comment_id": 104157015, "body": "yes its a variable in which selected file will be stored."}, {"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1574240612, "post_id": 58949981, "comment_id": 104157205, "body": "ok, so change the line to <code>myFile=fullpath</code>.  does each line contain an ERROR, or its possible that one line contains 2 ERROR ?"}, {"owner": {"reputation": 1, "user_id": 11249444, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lqsPD4Ga_YQ/AAAAAAAAAAI/AAAAAAAAAvE/rtjac2xMb8Y/photo.jpg?sz=128", "display_name": "ajinkya gaikwad", "link": "https://stackoverflow.com/users/11249444/ajinkya-gaikwad"}, "reply_to_user": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1574241032, "post_id": 58949981, "comment_id": 104157443, "body": "Thanks. Each line contains only one error."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11249444, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lqsPD4Ga_YQ/AAAAAAAAAAI/AAAAAAAAAvE/rtjac2xMb8Y/photo.jpg?sz=128", "display_name": "ajinkya gaikwad", "link": "https://stackoverflow.com/users/11249444/ajinkya-gaikwad"}, "edited": false, "score": 0, "creation_date": 1574252665, "post_id": 58952463, "comment_id": 104164301, "body": "thanks, there is no error after running the code. But after running there is no output."}, {"owner": {"reputation": 1, "user_id": 11249444, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lqsPD4Ga_YQ/AAAAAAAAAAI/AAAAAAAAAvE/rtjac2xMb8Y/photo.jpg?sz=128", "display_name": "ajinkya gaikwad", "link": "https://stackoverflow.com/users/11249444/ajinkya-gaikwad"}, "edited": false, "score": 0, "creation_date": 1574252685, "post_id": 58952463, "comment_id": 104164311, "body": "Input: $ information: $ Role : component $ Role : battery_box   ERROR = &#39;Some data&#39; $-----------------------------------------------------------&zwnj;&#8203;-----------LIST  $ information: $ Role : component $ Role : front   ERROR = &#39;Some data&#39;  $-----------------------------------------------------------&zwnj;&#8203;-----------LIST   ERROR = &#39;Some data&#39; $-----------------------------------------------------------&zwnj;&#8203;-----------LIST   ERROR = &#39;Some data&#39;    expected output in Excel in A1,B1,C1 and so on Some data Some data Some data Some data  Thanks."}], "tags": [], "owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "is_accepted": false, "score": 0, "last_activity_date": 1574262605, "last_edit_date": 1574262605, "creation_date": 1574246726, "answer_id": 58952463, "question_id": 58949981, "link": "https://stackoverflow.com/questions/58949981/search-text-and-copy-data-followed-by-it/58952463#58952463", "title": "Search text and copy data followed by it", "body": "<p><strong><em>UPDATE</em></strong></p>\n\n<p>try with this</p>\n\n<pre><code>Sub import()\n\nDim myFile As String, text As String, textline As String\nDim posLat As Integer, posLong As Integer, i As Long\nmyFile = fullpath\n\nOpen myFile For Input As #1\n\ni = 1\n\nDo Until EOF(1)\n    Line Input #1, textline\n    posLat = InStr(textline, \"ERROR = '\") + 9\n    posLatFin = InStr(posLat, textline, \"'\")\n    Cells(1, i).Value = Mid(textline, posLat, posLatFin - posLat)\n    i = i + 1\nLoop\n\nClose #1\nEnd Sub\n</code></pre>\n\n<p><strong><em>OLD</em></strong></p>\n\n<p>try like this</p>\n\n<pre><code>Sub import()\n\nDim myFile As String, text As String, textline As String\nDim posLat As Integer, posLong As Integer, i as long\nmyFile = fullpath\n\nOpen myFile For Input As #1\n\ni=1\n\nDo Until EOF(1)\n    Line Input #1, textline\n    text = text &amp; textline\n    posLat = InStr(text, \"ERROR\")\n    Range(\"A\"&amp; i ).Value = Mid(text, posLat + 10, 5)\nLoop\n\nClose #1\nEnd Sub\n</code></pre>\n\n<p>PS: i didnt test the Mid(text, posLat + 10, 5), so i dond know exacly what happends.</p>\n"}], "owner": {"reputation": 1, "user_id": 11249444, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lqsPD4Ga_YQ/AAAAAAAAAAI/AAAAAAAAAvE/rtjac2xMb8Y/photo.jpg?sz=128", "display_name": "ajinkya gaikwad", "link": "https://stackoverflow.com/users/11249444/ajinkya-gaikwad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574262605, "creation_date": 1574239224, "last_edit_date": 1574240011, "question_id": 58949981, "link": "https://stackoverflow.com/questions/58949981/search-text-and-copy-data-followed-by-it", "title": "Search text and copy data followed by it", "body": "<p>I have one text file which contains data about list of errors.</p>\n\n<p>I want to search only for ERROR word which have occurred multiple times in file and copy data quoted in '......' which is following the word ERROR=\nFormat is: ERROR = \"short name of error.(number of words may vary,but the text following error is quoted in '...')\" .</p>\n\n<p>I tried this to open the file:</p>\n\n<pre><code>Sub FileOpenDialogBox()\n\nDim myFile As String, text As String, textline As String\nDim posLat As Integer, posLong As Integer\nWith Application.FileDialog(msoFileDialogFilePicker)\n    .AllowMultiSelect = False\n    .Filters.Add \"Excel Files\", \" *.txt\", 1\n    .Show\n    fullpath = .SelectedItems.Item(1)\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>And to search and copy data:</p>\n\n<pre><code>Sub import()\n\nDim myFile As String, text As String, textline As String\nDim posLat As Integer, posLong As Integer\nmyFile = \"fullpath\"\n\nOpen myFile For Input As #1\n\nDo Until EOF(1)\n    Line Input #1, textline\n    text = text &amp; textline\nLoop\n\nClose #1\nposLat = InStr(text, \"ERROR\")\nRange(\"A1\").Value = Mid(text, posLat + 10, 5)\n\nEnd Sub\n</code></pre>\n\n<p>With this script I am not able to copy each error from that text file and also data between '......' is not captured.</p>\n\n<p>Can you please help me with it?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 647, "user_id": 2116936, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/q1TFp.jpg?s=128&g=1", "display_name": "PropK", "link": "https://stackoverflow.com/users/2116936/propk"}, "edited": false, "score": 0, "creation_date": 1574248313, "post_id": 58949910, "comment_id": 104161841, "body": "Updated Question to better clarify the issue i&#39;m facing"}], "answers": [{"comments": [{"owner": {"reputation": 647, "user_id": 2116936, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/q1TFp.jpg?s=128&g=1", "display_name": "PropK", "link": "https://stackoverflow.com/users/2116936/propk"}, "edited": false, "score": 0, "creation_date": 1574240655, "post_id": 58950239, "comment_id": 104157235, "body": "Sheet 1 is currently using the script above. So when i enter a value into B5:B50, it populates cells in the same row with a pre-defined text. What im looking to do is, when B5:B50 is populated in Sheet 1, it populates cells in the same row with pre-defined text but in sheet 2"}], "tags": [], "owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "is_accepted": false, "score": 0, "last_activity_date": 1574240042, "creation_date": 1574240042, "answer_id": 58950239, "question_id": 58949910, "link": "https://stackoverflow.com/questions/58949910/using-vba-in-excel-to-share-cell-vales-between-sheets-to-populate-data-in-cells/58950239#58950239", "title": "Using VBA in Excel to share cell vales between sheets to populate data in cells", "body": "<p>As I understand you, you want something like an equivalent of <code>offset</code> which returns a range on a different sheet.  There are a couple of options.</p>\n\n<p>You can use <code>Range.AddressLocal</code>, which returns the address of <code>Range</code> without any worksheet or workbook qualifiers, and then apply this to the other worksheet:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>'returns a cell 1 to the right of rng, but on Sheet2\nWorksheets(\"Sheet2\").Range(rng.Offset(0, 1).AddressLocal)\n</code></pre>\n\n<p>Or you can get the <code>Row</code> and <code>Column</code> properties of your range and use them in <code>Cells</code> in the other worksheet:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>'returns a cell 1 to the right of rng, but on Sheet2\nWorksheets(\"Sheet2\").Cells(rng.Row, rng.Column + 1)\n</code></pre>\n\n<p>To use it in your code, I think it's just a case of replacing</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>If .Value = \"\" Then .Value = TXT\n</code></pre>\n\n<p>with</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>If Worksheets(\"Sheet2\").Range(.Offset(0, 1).AddressLocal).Value = \"\" Then Worksheets(\"Sheet2\").Range(.Offset(0, 1).AddressLocal).Value = TXT\n</code></pre>\n\n<p>and replacing</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>.Value = \"\"\n</code></pre>\n\n<p>with</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Worksheets(\"Sheet2\").Range(.Offset(0, 1).AddressLocal).Value = \"\"\n</code></pre>\n\n<p>(or the same using the <code>Cells</code> construction).</p>\n"}, {"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1574241794, "creation_date": 1574241794, "answer_id": 58950787, "question_id": 58949910, "link": "https://stackoverflow.com/questions/58949910/using-vba-in-excel-to-share-cell-vales-between-sheets-to-populate-data-in-cells/58950787#58950787", "title": "Using VBA in Excel to share cell vales between sheets to populate data in cells", "body": "<p>The below will copy the <code>Target.Value</code> into the same cell in <code>Sheet2</code></p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim ws1 As Worksheet, ws2 As Worksheet\n\n    Set ws2 = ThisWorkbook.Worksheets(\"Sheet2\")\n\n    If Not Intersect(Target, Me.Range(\"B5:B50\")) Is Nothing And Target.Count = 1 Then\n        With Target\n            ws2.Cells(.Row, .Column).Value = .Value\n        End With\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 647, "user_id": 2116936, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/q1TFp.jpg?s=128&g=1", "display_name": "PropK", "link": "https://stackoverflow.com/users/2116936/propk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1574252826, "creation_date": 1574238913, "last_edit_date": 1574252826, "question_id": 58949910, "link": "https://stackoverflow.com/questions/58949910/using-vba-in-excel-to-share-cell-vales-between-sheets-to-populate-data-in-cells", "title": "Using VBA in Excel to share cell vales between sheets to populate data in cells", "body": "<p><strong>Updated Question</strong></p>\n\n<p>I have a VBA script attached to sheet 1 that uses the B5:B50 cell values to populate the adjacent column with pre-defined text. If I want to use this script in another sheet, but still use the B5:B50 cell values of the previous sheet. How to I do that?</p>\n\n<p>For Example:</p>\n\n<p>In sheet 1, If I enter the value of 2 in the cell B5, it will populate D5 and E5 with the text value attached to CONST TXT. I want to do the same thing in sheet 2, but instead of the user entering the value again into B5 of sheet 2, it just gets the value of B5 from the previous sheet and then populate D5 and E5.</p>\n\n<p>Sheet 2 B values will need to update as soon as the B values are updated in Sheet 1.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Const NUM_COLS As Long = 5\n    Const TXT = \"\u2022 Course Name:\" &amp; vbNewLine &amp; _\n              \"\u2022 No. Of Slides Affected:\" &amp; vbNewLine &amp; _\n              \"\u2022 No. of Activities Affected:\"\n\n    Dim rng As Range, i As Long, v\n\n    If Target.CountLarge &lt;&gt; 1 Then Exit Sub\n\n    If Not Intersect(Target, Me.Range(\"B5:B50\")) Is Nothing Then\n\n        Set rng = Target.Offset(0, 2).Resize(1, NUM_COLS) 'range to check\n        v = Target.Value\n\n        If IsNumeric(v) And v &gt;= 1 And v &lt;= NUM_COLS Then\n            For i = 1 To rng.Cells.Count\n                With rng.Cells(i)\n                    If i &lt;= v Then\n                        'Populate if not already populated\n                        If .Value = \"\" Then .Value = TXT\n                    Else\n                        'Clear any existing value\n                        .Value = \"\"\n                    End If\n                End With\n            Next i\n        Else\n            rng.Value = \"\" 'clear any existing content\n        End If\n\n    End If\n\nEnd Sub\n\n</code></pre>\n"}, {"tags": ["excel", "vba", "checkbox", "dynamic", "textbox"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 11497024, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SNiiEa4DfFc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdNKVCM0wLzM6Jv1nXZ2bdKLGXtwQ/mo/photo.jpg?sz=128", "display_name": "GabrieleS", "link": "https://stackoverflow.com/users/11497024/gabrieles"}, "edited": false, "score": 0, "creation_date": 1574334797, "post_id": 58957760, "comment_id": 104200617, "body": "Thank you very much @Jorge Ribeiro. It works fine. Just for curiosity, if I would that when checkbox was deselected the relative textbox will restored to default value (i.e. 50 in my example) and also will disabled the textbox? Is possible to do it?"}, {"owner": {"reputation": 1048, "user_id": 9194464, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-seaWoF1hiDU/AAAAAAAAAAI/AAAAAAAAADo/raR_sZ3tMJo/photo.jpg?sz=128", "display_name": "Jorge Ribeiro", "link": "https://stackoverflow.com/users/9194464/jorge-ribeiro"}, "reply_to_user": {"reputation": 25, "user_id": 11497024, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SNiiEa4DfFc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdNKVCM0wLzM6Jv1nXZ2bdKLGXtwQ/mo/photo.jpg?sz=128", "display_name": "GabrieleS", "link": "https://stackoverflow.com/users/11497024/gabrieles"}, "edited": false, "score": 0, "creation_date": 1574419414, "post_id": 58957760, "comment_id": 104235791, "body": "Yes, you can add a property on classe to store the value, and restore it on the click event (if state of checkbox is checked)"}, {"owner": {"reputation": 25, "user_id": 11497024, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SNiiEa4DfFc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdNKVCM0wLzM6Jv1nXZ2bdKLGXtwQ/mo/photo.jpg?sz=128", "display_name": "GabrieleS", "link": "https://stackoverflow.com/users/11497024/gabrieles"}, "edited": false, "score": 0, "creation_date": 1574421268, "post_id": 58957760, "comment_id": 104236705, "body": "Great. Thank you Jorge. Could you suggest me the code for this option, please?"}, {"owner": {"reputation": 1048, "user_id": 9194464, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-seaWoF1hiDU/AAAAAAAAAAI/AAAAAAAAADo/raR_sZ3tMJo/photo.jpg?sz=128", "display_name": "Jorge Ribeiro", "link": "https://stackoverflow.com/users/9194464/jorge-ribeiro"}, "reply_to_user": {"reputation": 25, "user_id": 11497024, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SNiiEa4DfFc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdNKVCM0wLzM6Jv1nXZ2bdKLGXtwQ/mo/photo.jpg?sz=128", "display_name": "GabrieleS", "link": "https://stackoverflow.com/users/11497024/gabrieles"}, "edited": false, "score": 0, "creation_date": 1574421582, "post_id": 58957760, "comment_id": 104236860, "body": "something like that: first declare: private value as string then change the code Private Sub ckbEvent1_Click() If UserForm3.Controls(&quot;CK&quot; &amp; xx).value = True Then UserForm3.Controls(&quot;TB&quot; &amp; xx).Enabled = True value = UserForm3.Controls(&quot;TB&quot; &amp; xx).Text else UserForm3.Controls(&quot;TB&quot; &amp; xx).Text = value End If"}, {"owner": {"reputation": 25, "user_id": 11497024, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SNiiEa4DfFc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdNKVCM0wLzM6Jv1nXZ2bdKLGXtwQ/mo/photo.jpg?sz=128", "display_name": "GabrieleS", "link": "https://stackoverflow.com/users/11497024/gabrieles"}, "edited": false, "score": 0, "creation_date": 1574431125, "post_id": 58957760, "comment_id": 104241805, "body": "Ok, I tried something similar <code>Private Sub ckbEvent1_Click() Dim tx As Variant  tx = UserForm3.Controls(&quot;TB&quot; &amp; xx).Value If UserForm3.Controls(&quot;CK&quot; &amp; xx).Value = True Then  UserForm3.Controls(&quot;TB&quot; &amp; xx).Enabled = True Else  UserForm3.Controls(&quot;TB&quot; &amp; xx).Enabled = False  UserForm3.Controls(&quot;TB&quot; &amp; xx).Value = tx End If End Sub</code> it works partially, but when checkbox is deselected the textbox value doesn&#39;t return to starting value if changed it before deselecting checkbox"}], "tags": [], "owner": {"reputation": 1048, "user_id": 9194464, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-seaWoF1hiDU/AAAAAAAAAAI/AAAAAAAAADo/raR_sZ3tMJo/photo.jpg?sz=128", "display_name": "Jorge Ribeiro", "link": "https://stackoverflow.com/users/9194464/jorge-ribeiro"}, "is_accepted": true, "score": 1, "last_activity_date": 1574263156, "creation_date": 1574263156, "answer_id": 58957760, "question_id": 58949445, "link": "https://stackoverflow.com/questions/58949445/dynamic-checkbox-to-enable-textbox/58957760#58957760", "title": "Dynamic checkbox to enable textbox", "body": "<p>Your code will not work.</p>\n\n<p>You need to create an array of classe1. \nCheck this changes:</p>\n\n<p>Classe1</p>\n\n<pre><code>Option Explicit\nPublic WithEvents cmbEvent1 As MSForms.CommandButton\nPublic WithEvents txbEvent1 As MSForms.TextBox\nPublic WithEvents frmEvent1 As MSForms.Frame\nPublic WithEvents ckbEvent1 As MSForms.CheckBox\n\nPublic xx As Integer\n\nPrivate Sub cmbEvent1_Click()\nUserForm3.Hide\nEnd Sub\n\nPrivate Sub frmEvent1_Click()\nEnd Sub\n\nPublic Sub txbEvent1_Change()\nEnd Sub\n\nPrivate Sub ckbEvent1_Click()\nIf UserForm3.Controls(\"CK\" &amp; xx).value = True Then\nUserForm3.Controls(\"TB\" &amp; xx).Enabled = True\nEnd If\nEnd Sub\n</code></pre>\n\n<p>UserForm3</p>\n\n<pre><code>Dim cmdB() As New Classe1\nDim txtB() As Classe1\nDim chkB() As Classe1\nDim frm() As New Classe1\n\n\nDim chkBColl As New Collection\n\nPrivate Sub UserForm_Initialize()\nDim x As Long\nDim c As Variant\nDim cmdB1 As MSForms.CommandButton\nDim frm1 As MSForms.Frame\nDim txtB1 As MSForms.TextBox\nDim chkB1 As MSForms.CheckBox\nReDim Preserve cmdB(1)\nSet cmdB1 = UserForm3.Controls.Add(\"Forms.CommandButton.1\")\n       With cmdB1\n            .Name = \"OKButton\"\n            .Caption = \"OK\"\n            .Top = 40 * rngprt\n            .Left = 120\n            .Width = 40\n            .Height = 25\n       End With\n       Set cmdB(0).cmbEvent1 = cmdB1\n\nFor x = cel.Row To cel.Row + rngprt - 1 '**rngprt is a number from a Module1**\n\nxx = x - cel.Row + 1  '**for progessive name of controls Dim xx as long into the Module1**\n\n    ReDim Preserve txtB(xx)\nSet txtB(xx) = New Classe1\nSet frm1 = UserForm3.Controls.Add(\"Forms.Frame.1\")\n            frm1.Top = 40 * (xx - 1)\n            frm1.Left = 10\n            frm1.Width = 300\n            frm1.Height = 35\n            frm1.Name = \"FR\" &amp; xx\n\nWith frm1.Controls\n\nSet txtB1 = .Add(\"Forms.TextBox.1\")\n       With txtB1\n            .Name = \"TB\" &amp; xx\n            .Top = 10\n            .Left = 160\n            .Width = 30\n            .Height = 15\n            .TextAlign = fmTextAlignRight\n            .Enabled = False\n            .Value=50\n       End With\n       txtB(xx).xx = xx\n       Set txtB(xx).txbEvent1 = txtB1\n\nReDim Preserve chkB(xx + 1)\nSet chkB(xx) = New Classe1\n     Set chkB1 = .Add(\"Forms.CheckBox.1\")\n       With chkB1\n            .Name = \"CK\" &amp; xx\n            .Caption = \"Part\"\n            .Top = 10\n            .Left = 245\n            .Width = 45\n            .Height = 15\n       End With\n       Set chkB(xx).ckbEvent1 = chkB1\n       chkB(xx).xx = xx\n       'Here I added the code below\n\nEnd With\nReDim Preserve frm(xx)\n       Set frm(xx).frmEvent1 = frm1\nNext x\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 11497024, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SNiiEa4DfFc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdNKVCM0wLzM6Jv1nXZ2bdKLGXtwQ/mo/photo.jpg?sz=128", "display_name": "GabrieleS", "link": "https://stackoverflow.com/users/11497024/gabrieles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 1, "accepted_answer_id": 58957760, "answer_count": 1, "score": 2, "last_activity_date": 1574263156, "creation_date": 1574237207, "last_edit_date": 1574258252, "question_id": 58949445, "link": "https://stackoverflow.com/questions/58949445/dynamic-checkbox-to-enable-textbox", "title": "Dynamic checkbox to enable textbox", "body": "<p>I have a problem about dynamic controls. I create a dynamic userform with single frames depending by a number (rngprt in my example dependent by user input). No problem till now. Now I want to enable a textbox (in order to change its value) inside a specific frame when the relative checkbox is click. I used a Class Module (Classe1), but with my code I succeeded  only to enable the last textbox of the n-frames when its checkbox is clicked (e.g. if I have 3 frames with 3 textboxes and 3 checkboxes, only the third checkbox it's able to enable the third textbox, the first and the second don't work).</p>\n\n<p>Class Module: Classe1</p>\n\n<pre><code>Option Explicit\nPublic WithEvents cmbEvent1 As MSForms.CommandButton\nPublic WithEvents txbEvent1 As MSForms.TextBox\nPublic WithEvents frmEvent1 As MSForms.Frame\nPublic WithEvents ckbEvent1 As MSForms.CheckBox\n\nPrivate Sub cmbEvent1_Click()\nUserForm3.Hide\nEnd Sub\n\nPrivate Sub frmEvent1_Click()\nEnd Sub\n\nPublic Sub txbEvent1_Change()\nEnd Sub\n\nPrivate Sub ckbEvent1_Click()\nIf UserForm3.Controls(\"CK\" &amp; xx).Value = True Then\nUserForm3.Controls(\"TB\" &amp; xx).Enabled = True\nEnd If\nEnd Sub\n\n</code></pre>\n\n<p>Module: UserForm3 </p>\n\n<pre><code>Option Explicit\nDim cmdB As New Classe1\nDim txtB As New Classe1\nDim chkB As New Classe1\nDim frm As New Classe1\nDim chkBColl As New Collection\n\nPrivate Sub UserForm_Initialize()\nDim x As Long\nDim c As Variant\nDim cmdB1 As MSForms.CommandButton\nDim frm1 As MSForms.Frame\nDim txtB1 As MSForms.TextBox\nDim chkB1 As MSForms.CheckBox\n\nSet cmdB1 = UserForm3.Controls.Add(\"Forms.CommandButton.1\")\n       With cmdB1\n            .Name = \"OKButton\"\n            .Caption = \"OK\"\n            .Top = 40 * rngprt\n            .Left = 120\n            .Width = 40\n            .Height = 25\n       End With\n       Set cmdB.cmbEvent1 = cmdB1\n\nFor x = cel.Row To cel.Row + rngprt - 1 '**rngprt is a number from a Module1**\n\nxx = x - cel.Row + 1  '**for progessive name of controls Dim xx as long into the Module1**\n\nSet frm1 = UserForm3.Controls.Add(\"Forms.Frame.1\")\n            frm1.Top = 40 * (xx - 1)\n            frm1.Left = 10\n            frm1.Width = 300\n            frm1.Height = 35\n            frm1.Name = \"FR\" &amp; xx\n\nWith frm1.Controls\n\nSet txtB1 = .Add(\"Forms.TextBox.1\")\n       With txtB1\n            .Name = \"TB\" &amp; xx\n            .Top = 10\n            .Left = 160\n            .Width = 30\n            .Height = 15\n            .TextAlign = fmTextAlignRight\n            .Enabled = False\n            .Value=50\n       End With\n       Set txtB.txbEvent1 = txtB1\n\n     Set chkB1 = .Add(\"Forms.CheckBox.1\")\n       With chkB1\n            .Name = \"CK\" &amp; xx\n            .Caption = \"Part\"\n            .Top = 10\n            .Left = 245\n            .Width = 45\n            .Height = 15\n       End With\n       Set chkB.ckbEvent1 = chkB1\n       'Here I added the code below\n\nEnd With\n       Set frm.frmEvent1 = frm1\nNext x\n\nEnd Sub\n</code></pre>\n\n<p>I tried also to add this code below the chkB1 setting, but nothing.</p>\n\n<pre><code>       Set chkB = New Classe1\n       Set chkB.ckbEvent1 = Me.Controls(chkB.txbEvent1)\n       chkBColl.Add chkB\n</code></pre>\n\n<p>Anybody have idea. Thank in advance to all for help.</p>\n"}, {"tags": ["vba", "rest", "api", "maximo"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1574236463, "post_id": 58949171, "comment_id": 104155200, "body": "Is this really how the documentation recommends you interact with the API rather than xmlhttp? I would have expected a POST XHR."}, {"owner": {"reputation": 25, "user_id": 3989857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/febe4ac204ac93a8db1c852b81338113?s=128&d=identicon&r=PG&f=1", "display_name": "Rhye", "link": "https://stackoverflow.com/users/3989857/rhye"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1574236718, "post_id": 58949171, "comment_id": 104155318, "body": "I have tried with POST XHR:     `     PostData = &quot;statusdate=23-08-2018&quot;     PostData = StrConv(PostData, vbFromUnicode)          myheader = myheader &amp; &quot;x-http-method-override: createPOsFromPR&quot; &amp; vbNewLine     myheader = myheader &amp; &quot;Content-Type: application/json;&quot;           objHTTP.Open &quot;POST&quot;, &quot;<a href=\"https://url/maxrest/rest/mbo/PR/123\" rel=\"nofollow noreferrer\">url/maxrest/rest/mbo/PR/123</a>&quot;, False     objHTTP.send (PostData)` Still not working."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1574236818, "post_id": 58949171, "comment_id": 104155359, "body": "Hi, 1) What happened? 2) that is not how you would add headers to xhr. You would use .setrequestheader &quot;myheader&quot;,&quot;pair&quot;  3) Do you have the link to the documentation? Worth reading it and sharing here if possible."}, {"owner": {"reputation": 25, "user_id": 3989857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/febe4ac204ac93a8db1c852b81338113?s=128&d=identicon&r=PG&f=1", "display_name": "Rhye", "link": "https://stackoverflow.com/users/3989857/rhye"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1574237182, "post_id": 58949171, "comment_id": 104155511, "body": "1) No result is produced, I should try con construct a better POST XHR I guess.. In other cases when I need HTTP POST this worked. 2) <a href=\"https://www.ibm.com/support/knowledgecenter/SSANHD_7.6.1/com.ibm.mif.doc/gp_intfrmwk/rest_api/c_rest_service_query.html\" rel=\"nofollow noreferrer\">ibm.com/support/knowledgecenter/SSANHD_7.6.1/com.ibm.mif.doc&zwnj;&#8203;/&hellip;</a> This is not exactly the same but there is no clear documentation on this subject. Search for x-http-method-override"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1574237253, "post_id": 58949171, "comment_id": 104155543, "body": "There may be other methods I haven&#39;t seen :-) I will look at the documentation."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1574237424, "post_id": 58949171, "comment_id": 104155602, "body": "I think you need .SetRequestHeader. Now, which of the following is the method you are trying to apply for creation? <a href=\"https://www.ibm.com/support/knowledgecenter/search/create%20po?scope=SSANHD_7.6.1\" rel=\"nofollow noreferrer\">ibm.com/support/knowledgecenter/search/&hellip;</a>"}, {"owner": {"reputation": 25, "user_id": 3989857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/febe4ac204ac93a8db1c852b81338113?s=128&d=identicon&r=PG&f=1", "display_name": "Rhye", "link": "https://stackoverflow.com/users/3989857/rhye"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1574238328, "post_id": 58949171, "comment_id": 104155999, "body": "Yes, I did it with .setRequestHeader and I think my code before wasn&#39;t passing the header. So now I get Error 500 just like with InternetExplorer.  In the search there is no documentation of my scenario. The closest think is the link I get posted."}, {"owner": {"reputation": 25, "user_id": 3989857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/febe4ac204ac93a8db1c852b81338113?s=128&d=identicon&r=PG&f=1", "display_name": "Rhye", "link": "https://stackoverflow.com/users/3989857/rhye"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1574238566, "post_id": 58949171, "comment_id": 104156106, "body": "This link also is a good one:  <a href=\"https://www.ibm.com/support/knowledgecenter/SSANHD_7.6.1/com.ibm.mif.doc/gp_intfrmwk/rest_api/c_rest_service_update.html\" rel=\"nofollow noreferrer\">ibm.com/support/knowledgecenter/SSANHD_7.6.1/com.ibm.mif.doc&zwnj;&#8203;/&hellip;</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1574239557, "post_id": 58949171, "comment_id": 104156585, "body": "Yes... I had seen that one but is that what you are trying to do? If so, your post body needs to look like that and that is what goes in the .send body"}, {"owner": {"reputation": 25, "user_id": 3989857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/febe4ac204ac93a8db1c852b81338113?s=128&d=identicon&r=PG&f=1", "display_name": "Rhye", "link": "https://stackoverflow.com/users/3989857/rhye"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1574242527, "post_id": 58949171, "comment_id": 104158351, "body": "The idea is the same but the action I want to perform is different - &quot;createPOsFromPR&quot; so the post body is also different. For the post pody I do reference to this page: <a href=\"https://developer.ibm.com/static/site-id/155/maximodev/7609/maximocore/businessobjects/psdi/app/pr/PR.html\" rel=\"nofollow noreferrer\">developer.ibm.com/static/site-id/155/maximodev/7609/maximoco&zwnj;&#8203;re/&hellip;</a> search for &quot;createPOsFromPR&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 3989857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/febe4ac204ac93a8db1c852b81338113?s=128&d=identicon&r=PG&f=1", "display_name": "Rhye", "link": "https://stackoverflow.com/users/3989857/rhye"}, "edited": false, "score": 0, "creation_date": 1574408060, "post_id": 58978292, "comment_id": 104230276, "body": "Hello, thank you for the effort. The problem is that I don&#39;t have access to Maximo Admin Panel (I guess) where scripting happens. I cannot do changes to the system."}, {"owner": {"reputation": 891, "user_id": 2453443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/986d6d19ea658271ddc5742cfded9ec4?s=128&d=identicon&r=PG", "display_name": "JPTremblay", "link": "https://stackoverflow.com/users/2453443/jptremblay"}, "reply_to_user": {"reputation": 25, "user_id": 3989857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/febe4ac204ac93a8db1c852b81338113?s=128&d=identicon&r=PG&f=1", "display_name": "Rhye", "link": "https://stackoverflow.com/users/3989857/rhye"}, "edited": false, "score": 1, "creation_date": 1574705056, "post_id": 58978292, "comment_id": 104318163, "body": "@Rhye Unfortunately, it seems that the PR service doesn&#39;t expose a REST accessible Web Method for CreatePOsFromPR. You can get the allowed actions with a similar call: <a href=\"http://maximohost/maximo/oslc/os/mxpr?oslc.where=prnum=&quot;PR1000&quot;&amp;oslc.select=allowedactions\" rel=\"nofollow noreferrer\">maximohost/maximo/oslc/os/&hellip;</a>  Ref.: <a href=\"https://developer.ibm.com/static/site-id/155/maximodev/restguide/Maximo_Nextgen_REST_API.html#_actions\" rel=\"nofollow noreferrer\">developer.ibm.com/static/site-id/155/maximodev/restguide/&hellip;</a>"}], "tags": [], "owner": {"reputation": 891, "user_id": 2453443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/986d6d19ea658271ddc5742cfded9ec4?s=128&d=identicon&r=PG", "display_name": "JPTremblay", "link": "https://stackoverflow.com/users/2453443/jptremblay"}, "is_accepted": false, "score": 1, "last_activity_date": 1574349871, "creation_date": 1574349871, "answer_id": 58978292, "question_id": 58949171, "link": "https://stackoverflow.com/questions/58949171/ibm-maximo-how-to-create-po-from-pr-with-rest-api/58978292#58978292", "title": "IBM MAXIMO: How to create PO from PR with REST API", "body": "<p>You could use the New REST API that allows you to directly call an automation script.\nYou'd add the PR number and date as request parameters and use them in the script to call\nthe <code>PR.createPOsFromPR</code> method.</p>\n\n<p>Your call would look like this: </p>\n\n<pre><code>http://maximohost/maximo/oslc/script/genPOsScript?prnum=ABC&amp;date=2019-11-21\n</code></pre>\n\n<p>You might want to add the site as param too because PR is a site level object.</p>\n\n<p>You can see an example here:\n<a href=\"https://developer.ibm.com/static/site-id/155/maximodev/restguide/Maximo_Nextgen_REST_API.html#_automation_scripts\" rel=\"nofollow noreferrer\">https://developer.ibm.com/static/site-id/155/maximodev/restguide/Maximo_Nextgen_REST_API.html#_automation_scripts</a></p>\n"}], "owner": {"reputation": 25, "user_id": 3989857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/febe4ac204ac93a8db1c852b81338113?s=128&d=identicon&r=PG&f=1", "display_name": "Rhye", "link": "https://stackoverflow.com/users/3989857/rhye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 743, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1574349871, "creation_date": 1574236062, "question_id": 58949171, "link": "https://stackoverflow.com/questions/58949171/ibm-maximo-how-to-create-po-from-pr-with-rest-api", "title": "IBM MAXIMO: How to create PO from PR with REST API", "body": "<p>in IBM Maximo 7.6.0.8 I would like to create PO from a PR using REST API and VBA (HTTP requests).\nMy code is:</p>\n\n<pre><code>Dim PostData() As Byte\nDim IE As InternetExplorerMedium\nSet IE = New InternetExplorerMedium\n\nPostData = \"~date=23-08-2018\"\nPostData = StrConv(PostData, vbFromUnicode)\n\nmyheader = myheader &amp; \"x-http-method-override: createPOsFromPR\" &amp; vbNewLine\nmyheader = myheader  &amp; \"Content-Type: application/json\" &amp; vbCrLf\n\nIE.Navigate \"https://host:port/maxrest/rest/mbo/pr/123\", 0, \"myIE\", PostData, myheader\n</code></pre>\n\n<p>But I get Error 500. Authentication is not the problem.\nIn general I would like to be albe to copy (assign) PR lines to POs and RFQs.\nIs this the way to do this? Does someone has working solution?\nThanks!</p>\n"}, {"tags": ["excel", "database", "vba"], "answers": [{"tags": [], "owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "is_accepted": false, "score": 1, "last_activity_date": 1574268058, "creation_date": 1574268058, "answer_id": 58959329, "question_id": 58949128, "link": "https://stackoverflow.com/questions/58949128/check-if-server-are-reachable/58959329#58959329", "title": "Check if server are reachable", "body": "<p>You can trap an error when connecting to db:</p>\n\n<pre><code>'enable to catch an error\non error resume next\n'attempt to connect to db\nrs.Open SqlStr, DbCn, adOpenStatic, adLockReadOnly\n'if there's an error when connecting to db, do whatever you want to do\nif err.number &lt;&gt; 0 then msgbox err.number\n'reset error handling procedure\non error goto 0\n</code></pre>\n\n<p>There might be a better solution but this works for me.</p>\n"}], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574268058, "creation_date": 1574235879, "last_edit_date": 1574253294, "question_id": 58949128, "link": "https://stackoverflow.com/questions/58949128/check-if-server-are-reachable", "title": "Check if server are reachable", "body": "<p>I using the below code to connect on a database with VBA. Is there a way to check when the server is down and import a line of code to get a message box for that?</p>\n\n<pre><code>Public Const DbCn = \"Driver={SQL Server};Server=10.10.10.10;Database=dbTest;Uid=user;Pwd=1234567890;\"\n\nDim rs As ADODB.Recordset\n\nSet rs = New ADODB.Recordset\n\nWith rs\n    .Open SqlStr, DbCn, adOpenStatic, adLockReadOnly\n    If Not .EOF Then\n\n    End If\n    .Close\nEnd With\nSet rs = Nothing\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 35, "user_id": 12072484, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1itCvviVgkM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdD7lx96ZhlJ__RtYUjtsx390gxsw/photo.jpg?sz=128", "display_name": "Jovic Viduya", "link": "https://stackoverflow.com/users/12072484/jovic-viduya"}, "edited": false, "score": 0, "creation_date": 1574232982, "post_id": 58948399, "comment_id": 104153724, "body": "by the way i removed that loop first since it will be easy to incorporate that when the main code&#39;s been fixed. Thanks!"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1574233707, "post_id": 58948399, "comment_id": 104154026, "body": "Does <code>sDFolder</code> end with a backslash? It needs to. <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/copyfile-method\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/language/reference/&hellip;</a>"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1574234014, "post_id": 58948399, "comment_id": 104154156, "body": "foldname is not automatically passed to the first code, you could create the folder in the first code instead of calling the macro. what if you uncomment   <code>&#39;foldname = Cells(r, 1)</code>"}], "owner": {"reputation": 35, "user_id": 12072484, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1itCvviVgkM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdD7lx96ZhlJ__RtYUjtsx390gxsw/photo.jpg?sz=128", "display_name": "Jovic Viduya", "link": "https://stackoverflow.com/users/12072484/jovic-viduya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574233545, "creation_date": 1574232938, "last_edit_date": 1574233545, "question_id": 58948399, "link": "https://stackoverflow.com/questions/58948399/getting-a-file-copying-that-file-then-creating-a-folder-then-pasting-that-fil", "title": "Getting a file, copying that file, then creating a folder, then pasting that file in the created folder", "body": "<p>So basically, I need to transfer pdf file from one folder to another. But the source folder contains thousands of pdfs and i need to transfer about 500+ of them in another folder which I should create as well. So it means, I copy \"apple\" from source then in the destination folder, I'll create a folder named \"apple\" then paste the copied \"apple\" file in the created \"apple\" folder.</p>\n\n<pre><code>Sub transferpdf()\nApplication.ScreenUpdating = False\nSheets(\"Stress Log\").Activate\nr = 3\n'Declare Variables\n'Do While Cells(r, 3) &lt;&gt; \"\"\nDim FSO\nDim sFile As String\nDim sSFolder As String\nDim sDFolder As String\nDim foldname As String\nCall create_folder\n\n'Name of new folder\n'foldname = Cells(r, 1)\n'File name to copy\nsFile = Cells(r, 3) &amp; \"_R\" &amp; Cells(r, 4) &amp; \".pdf\"\n\n'Source file path\nsSFolder = \"\\\\Fdnet.com\\ca_projects\\CA_LNGC\\000_GENERAL\\TRANSFER\\TO CSA_From Stress  - PERMANENT\\\"\n\n'Destination file path\nsDFolder = \"C:\\Users\\vid14865\\Desktop\\VLM - Sir Earl\\3RC430BB VLM - Stress ISOs\\\" &amp; foldname\n\n'Create Object\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\n\n'Checking If File Is Located in the Source Folder\nIf Not FSO.FileExists(sSFolder &amp; sFile) Then\n    MsgBox [sFile] &amp; \" Not Found\", vbInformation, \"Not Found\"\n\n'Copying If the Same File is Not Located in the Destination Folder\nElseIf Not FSO.FileExists(sDFolder &amp; sFile) Then\n    FSO.CopyFile (sSFolder &amp; sFile), sDFolder, True\n    MsgBox [sFile] &amp; (\" Copied Successfully\")\n\nElse\n    MsgBox [sFile] &amp; \" Already Exists In The Destination Folder\", vbExclamation, \"File Already Exists\"\nEnd If\n'r = r + 1\n'Loop\nMsgBox \"Finished Creating\"\nEnd Sub\nSub create_folder()\nSheets(\"Stress Log\").Activate\nr = 3\nfoldname = Cells(r, 1)\nMkDir (\"C:\\Users\\vid14865\\Desktop\\VLM - Sir Earl\\3RC430BB VLM - Stress ISOs\\\" &amp; foldname)\n\nEnd Sub\n</code></pre>\n\n<p>This is what I have so far. This creates the folder and copies the file very well, but then the file is not copied in the folder. It's copied outside the created file.</p>\n\n<p><a href=\"https://i.stack.imgur.com/BVyyN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BVyyN.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "match"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1574233333, "post_id": 58948061, "comment_id": 104153855, "body": "Please include the code in your question you are working on to solve this if you would like help."}, {"owner": {"reputation": 25, "user_id": 10851969, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ciCJaqgA9eo/AAAAAAAAAAI/AAAAAAAAC4o/7wwhKfHWHfk/photo.jpg?sz=128", "display_name": "Adnan Ahmad", "link": "https://stackoverflow.com/users/10851969/adnan-ahmad"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1574234436, "post_id": 58948061, "comment_id": 104154346, "body": "Please see now. I have added the code I&#39;m working on."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 10851969, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ciCJaqgA9eo/AAAAAAAAAAI/AAAAAAAAC4o/7wwhKfHWHfk/photo.jpg?sz=128", "display_name": "Adnan Ahmad", "link": "https://stackoverflow.com/users/10851969/adnan-ahmad"}, "edited": false, "score": 0, "creation_date": 1574244529, "post_id": 58948980, "comment_id": 104159536, "body": "Thank you @daveexcel. This seems to work. But one more thing, I wanted to add another condition too that would check if a.Offset(0, 15) = -c.Offset(0, 16). But the headers of the columns are preventing it because they are strings, not integers. How to work out this?"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "reply_to_user": {"reputation": 25, "user_id": 10851969, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ciCJaqgA9eo/AAAAAAAAAAI/AAAAAAAAC4o/7wwhKfHWHfk/photo.jpg?sz=128", "display_name": "Adnan Ahmad", "link": "https://stackoverflow.com/users/10851969/adnan-ahmad"}, "edited": false, "score": 0, "creation_date": 1574249979, "post_id": 58948980, "comment_id": 104162768, "body": "I am not quite sure I understand. <code>a.Offset(0, 15) = -c.Offset(0, 16)</code> would be the same cell would it not?"}, {"owner": {"reputation": 25, "user_id": 10851969, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ciCJaqgA9eo/AAAAAAAAAAI/AAAAAAAAC4o/7wwhKfHWHfk/photo.jpg?sz=128", "display_name": "Adnan Ahmad", "link": "https://stackoverflow.com/users/10851969/adnan-ahmad"}, "edited": false, "score": 0, "creation_date": 1574250059, "post_id": 58948980, "comment_id": 104162811, "body": "An IF with IsNumber to skip strings worked. Thank you so much. &lt;3"}, {"owner": {"reputation": 25, "user_id": 10851969, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ciCJaqgA9eo/AAAAAAAAAAI/AAAAAAAAC4o/7wwhKfHWHfk/photo.jpg?sz=128", "display_name": "Adnan Ahmad", "link": "https://stackoverflow.com/users/10851969/adnan-ahmad"}, "edited": false, "score": 0, "creation_date": 1574319122, "post_id": 58948980, "comment_id": 104191856, "body": "But this is not checking for multiple matches of rng1 in rng2. Because there are cases where one policy is knocked off by multiple partial endorsements. Is there any way of checking that?"}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": true, "score": 0, "last_activity_date": 1574235264, "creation_date": 1574235264, "answer_id": 58948980, "question_id": 58948061, "link": "https://stackoverflow.com/questions/58948061/for-each-cell-in-a-column-check-multiple-matches-in-the-next-column-and-then-hi/58948980#58948980", "title": "For each cell in a column, check multiple matches in the next column and then highlight them", "body": "<p>A double loop could work.</p>\n\n<pre><code>Sub DoubleLoop3()\n    Dim rng1 As Range, rng2 As Range\n    Dim a As Range, c As Range\n    Set rng1 = Columns(\"D:D\").EntireColumn.SpecialCells(xlCellTypeConstants, 23)\n    Set rng2 = Columns(\"E:E\").EntireColumn.SpecialCells(xlCellTypeConstants, 23)\n    Columns(\"D:F\").Interior.Color = xlNone\n\n    For Each c In rng1.Cells\n        For Each a In rng2.Cells\n            If c = a And a.Offset(, 1) &lt;&gt; 0 Then\n                c.Interior.ColorIndex = 6\n                a.Interior.ColorIndex = 6\n                a.Offset(, 1).Interior.ColorIndex = 6\n            End If\n        Next a\n    Next c\n\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 10851969, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ciCJaqgA9eo/AAAAAAAAAAI/AAAAAAAAC4o/7wwhKfHWHfk/photo.jpg?sz=128", "display_name": "Adnan Ahmad", "link": "https://stackoverflow.com/users/10851969/adnan-ahmad"}, "edited": false, "score": 0, "creation_date": 1574316289, "post_id": 58949837, "comment_id": 104190811, "body": "Thank you for the solution @Error1004. Though I didn&#39;t have time to try this one because Dave&#39;s solution worked for me already but I appreciate your time and effort. Thank you once again &lt;3"}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1574238647, "creation_date": 1574238647, "answer_id": 58949837, "question_id": 58948061, "link": "https://stackoverflow.com/questions/58948061/for-each-cell-in-a-column-check-multiple-matches-in-the-next-column-and-then-hi/58949837#58949837", "title": "For each cell in a column, check multiple matches in the next column and then highlight them", "body": "<p>@Adnan Ahmad have in mind the the title of your third column has mistake. You could use:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim LastRowA As Long, LastRowB As Long, i As Long, y As Long\n    Dim Policy_No As String, Outstanding As Double\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        LastRowA = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        LastRowB = .Cells(.Rows.Count, \"B\").End(xlUp).Row\n\n        For i = 2 To LastRowA\n\n            If IsNumeric(.Range(\"C\" &amp; i).Value) Then\n\n                Policy_No = .Range(\"A\" &amp; i).Value\n                Outstanding = .Range(\"C\" &amp; i).Value\n\n                For y = 2 To LastRowB\n                    If IsNumeric(.Range(\"C\" &amp; y).Value) Then\n\n                        If (.Range(\"B\" &amp; y).Value = Policy_No) And (.Range(\"C\" &amp; y).Value + Outstanding = 0) Then\n                            .Range(\"A\" &amp; i).Interior.ColorIndex = 6\n                            .Range(\"B\" &amp; y).Interior.ColorIndex = 6\n                            .Range(\"C\" &amp; i).Interior.ColorIndex = 6\n                            .Range(\"C\" &amp; y).Interior.ColorIndex = 6\n                        End If\n\n                    End If\n\n                Next y\n\n            End If\n\n        Next i\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 10851969, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ciCJaqgA9eo/AAAAAAAAAAI/AAAAAAAAC4o/7wwhKfHWHfk/photo.jpg?sz=128", "display_name": "Adnan Ahmad", "link": "https://stackoverflow.com/users/10851969/adnan-ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 58948980, "answer_count": 2, "score": 2, "last_activity_date": 1574238647, "creation_date": 1574231378, "last_edit_date": 1574234401, "question_id": 58948061, "link": "https://stackoverflow.com/questions/58948061/for-each-cell-in-a-column-check-multiple-matches-in-the-next-column-and-then-hi", "title": "For each cell in a column, check multiple matches in the next column and then highlight them", "body": "<p>In an excel sheet, I have insurance policy numbers in one column and endorsements against each of them in the next column with the same policy number. Then there is the third column with outstanding amount against each policy and endorsement. </p>\n\n<p>I want a macro that checks for policy matches in the next column and then checks if the outstanding amounts are both non-zero and equal.</p>\n\n<p>I'm working on this code currently:</p>\n\n<pre><code>Sub Outstandingknockoff() \nDim Cell As Range \nLR = Cells(Rows.Count, 1).End(xlUp).Row\nFor Each Cell In Range(\"D2:D\" &amp; LR)\nMatch = Application.Match(Cell, Range(\"e2:e\" &amp; LR), 0)\nIf Match &lt;&gt; 0 And Cell.Offset(0, 16) &lt;&gt; 0 And Cell.Offset(0, 16) = -Range(\"T\" &amp; Match + 1) Then\nOn Error Resume Next\nCell.EntireRow.Interior.ColorIndex = 6\nMatch.EntireRow.Interior.ColorIndex = 6\nEnd If\nNext Cell\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/N8kMY.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/N8kMY.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "compiler-errors"], "comments": [{"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 1, "creation_date": 1574225247, "post_id": 58946796, "comment_id": 104151400, "body": "I tested a small code like this <code>Sub Go() Set ws = ActiveSheet ws.Activate End Sub </code> and it worked. I could not reproduce your issue. My suggestion is change routine name from <code>Go</code> to something like <code>ProcessData</code> and test."}, {"owner": {"reputation": 302, "user_id": 6372189, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Zoyi3VZI18M/AAAAAAAAAAI/AAAAAAAAAFU/KxAN6u1BTSs/photo.jpg?sz=128", "display_name": "Prashant Kumar", "link": "https://stackoverflow.com/users/6372189/prashant-kumar"}, "reply_to_user": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 1, "creation_date": 1574225687, "post_id": 58946796, "comment_id": 104151496, "body": "@shrivallabha.redij that actually worked, I think VBA might have a syntax <code>Go</code> which might be in conflict with the sub name, hence the error. Changing the sub name to something else worked fine.Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "is_accepted": true, "score": 1, "last_activity_date": 1574225797, "creation_date": 1574225797, "answer_id": 58946963, "question_id": 58946796, "link": "https://stackoverflow.com/questions/58946796/why-does-the-macro-gives-compile-error-without-any-logical-or-syntax-error-in-sc/58946963#58946963", "title": "Why does the macro gives compile error without any logical or syntax error in script?", "body": "<p><code>Go</code> is a reserved word according to <a href=\"http://www.audeser.com/vba-reserved-words/\" rel=\"nofollow noreferrer\">http://www.audeser.com/vba-reserved-words/</a></p>\n\n<p>Any uses of reserved words can have unitended consequences. Suggest changing the name of your sub to something else, for example as @ shrivallabha.redij stated <code>ProcessData</code></p>\n"}], "owner": {"reputation": 302, "user_id": 6372189, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Zoyi3VZI18M/AAAAAAAAAAI/AAAAAAAAAFU/KxAN6u1BTSs/photo.jpg?sz=128", "display_name": "Prashant Kumar", "link": "https://stackoverflow.com/users/6372189/prashant-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 58946963, "answer_count": 1, "score": 2, "last_activity_date": 1574225797, "creation_date": 1574224718, "last_edit_date": 1574224803, "question_id": 58946796, "link": "https://stackoverflow.com/questions/58946796/why-does-the-macro-gives-compile-error-without-any-logical-or-syntax-error-in-sc", "title": "Why does the macro gives compile error without any logical or syntax error in script?", "body": "<p>I wrote a macro in excel vba. I am attaching the script below. I don't see any logical or syntax error in the macro but when I try to compile it, I get <code>Compile error: Expected: To</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/gx3N4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gx3N4.png\" alt=\"Error\"></a></p>\n\n<p>Below is my script attached</p>\n\n<pre><code>Sub Go()\n\nSet ws = ActiveSheet\n\nws.Range(\"D:D\").ClearContents\nws.Range(\"D:D\").ClearFormats\n\nws.Cells(1, 4).Value = \"Status\"\nws.Cells(1, 4).Font.Bold = True\n\nmaxEntry = ActiveSheet.Cells(1048576, \"A\").End(xlUp).Row\n\npricePath = ws.Cells(2, 6).Value + \"\\\" + ws.Cells(2, 7).Value\nSet wbpp = Workbooks.Open(pricePath, UpdateLinks:=False)\n\nws.Activate\n\nFor i = 2 To maxEntry\n    Path = ws.Cells(i, 1).Value + \"\\\" + ws.Cells(i, 2).Value\n    currSheet = ws.Cells(i, 3).Value\n    Set wbp = Workbooks.Open(Path, UpdateLinks:=False)\n    Set wbs = wbp.Sheets(currSheet)\n    wbs.Activate\n    wbs.Cells(1, 1).Value = \"abc\"\n\n    wbp.Close Savechanges:=True\n    ws.Activate\n    ws.Cells(i, 4).Value = \"Updated\"\nNext i\n\nwbpp.Close Savechanges:=False\n\nEnd Sub\n</code></pre>\n\n<p>After trying out various things I found out that the macro throws an error when my cursor is inside the macro sub, something like this</p>\n\n<p><a href=\"https://i.stack.imgur.com/BYPrH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BYPrH.png\" alt=\"Cursor in the Sub\"></a></p>\n\n<p>But when my cursor is outside the sub, the script runs fine</p>\n\n<p><a href=\"https://i.stack.imgur.com/NzQo6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NzQo6.png\" alt=\"Out of Sub\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/OMKxK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OMKxK.png\" alt=\"Run Box\"></a></p>\n\n<p>I don't remember this issue happening with my previous macros. </p>\n\n<p>Any ideas why this is happening? Its really annoying to move cursor to the bottom to run every time I want to test/compile.</p>\n"}, {"tags": ["excel", "vba", "selenium", "office365"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1574224773, "post_id": 58946545, "comment_id": 104151286, "body": "Just newer version of office or did you get windows 10 thrown in? Where there any other software updates (dependencies e.g. browser, .Net framework) that happened?"}, {"owner": {"reputation": 25, "user_id": 11346855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/699099831fa6738d9a24120949a22131?s=128&d=identicon&r=PG&f=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/11346855/dev"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1574227356, "post_id": 58946545, "comment_id": 104151942, "body": "No I have only upgraded my office from office 2016 home edition to office 365. However my system shut off some two days ago abruptly leading to excel locked and became read only. However it is now working properly."}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1574280910, "post_id": 58947972, "comment_id": 104180449, "body": "Good to know + for that"}], "tags": [], "owner": {"reputation": 116545, "user_id": 7429447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5a25589e600c8ae89717c14e51a6754b?s=128&d=identicon&r=PG&f=1", "display_name": "DebanjanB", "link": "https://stackoverflow.com/users/7429447/debanjanb"}, "is_accepted": true, "score": 2, "last_activity_date": 1574230991, "creation_date": 1574230991, "answer_id": 58947972, "question_id": 58946545, "link": "https://stackoverflow.com/questions/58946545/automation-error-catastrophic-failure-error-using-excel-through-selenium-and-vb/58947972#58947972", "title": "Automation error. Catastrophic failure error using Excel through Selenium and VBA", "body": "<p>This error message...</p>\n\n<pre><code>Automation error. Catastrophic failure\n</code></pre>\n\n<p>...implies that there was an <strong>Automation error</strong> while accessing the   excel sheet based on <strong>Office 365</strong>.</p>\n\n<hr>\n\n<p>As per the discussion in <a href=\"https://answers.microsoft.com/en-us/msoffice/forum/all/automation-error-catastrophic-failure-problem-with/7dec2412-6cab-4c30-9bfd-c522bf38c8ad\" rel=\"nofollow noreferrer\">Automation error: Catastrophic failure Problem with Excel 2016</a> the main problem is related to the version of <strong>Excel</strong> that comes with <strong>Office 365</strong> is different from the version that is given to Enterprise users.</p>\n\n<hr>\n\n<h2>Solution</h2>\n\n<p>The easiest solution would be to save the file as an <strong>Excel Binary Workbook</strong> and use it in your <em>automated tests</em></p>\n"}], "owner": {"reputation": 25, "user_id": 11346855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/699099831fa6738d9a24120949a22131?s=128&d=identicon&r=PG&f=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/11346855/dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "accepted_answer_id": 58947972, "answer_count": 1, "score": 1, "last_activity_date": 1574253285, "creation_date": 1574223036, "last_edit_date": 1574253285, "question_id": 58946545, "link": "https://stackoverflow.com/questions/58946545/automation-error-catastrophic-failure-error-using-excel-through-selenium-and-vb", "title": "Automation error. Catastrophic failure error using Excel through Selenium and VBA", "body": "<p>I am trying to fill a web form through selenium VBA. I have used some codes which used to work well . Now I have updated to new version of office and now when I try the same code it says </p>\n\n<blockquote>\n  <p>\" Automation error. Catastrophic failure\"</p>\n</blockquote>\n\n<pre><code>    Sub Rel_join()\n\n        Dim bot As New ChromeDriver\n        bot.Start \"chrome\", \"******\"\n        Dim x, y,w\n        bot.Get \"/\"\n        'bot.Window.Maximize\n        'login\n        bot.Wait 1500\n        bot.FindElementByXPath(\"//*[@id='lang-menu']/li[5]/a\").Click\n        bot.Wait 500\n        'select department\n        d = \"********\"\n\n        Set ele = bot.FindElementById(\"ddldept\").AsSelect\n        ele.SelectByText [d]\n        bot.FindElementByXPath(\"//input[@id='txtusername']\").SendKeys \"*****\"\n        bot.FindElementByXPath(\"//input[@id='txtpwd']\").SendKeys \"******\"\n        Stop\n        'Navigate to service book\n        bot.Get \"***********URL\"\n\n           For y = 4 To 4\n       ** x = ThisWorkbook.Sheets(\"sheet1\").Range(\"w\" &amp; y).Value**\n        cSCRIPT = \"document.getElementById('txtempcd').value='\" &amp; x &amp; \"'\"\n        bot.ExecuteScript cSCRIPT\n        Stop\n        cSCRIPT = \"document.getElementById('Save').click()\"\n        bot.ExecuteScript cSCRIPT\n        bot.SwitchToAlert.Accept\n        bot.Wait 3000\n        Next y\n    End Sub\n\n</code></pre>\n\n<p>I have also noticed that this error is shown on the line</p>\n\n<pre><code> ** x = ThisWorkbook.Sheets(\"sheet1\").Range(\"w\" &amp; y).Value**\n</code></pre>\n"}, {"tags": ["sql", "excel", "vba"], "comments": [{"owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "edited": false, "score": 0, "creation_date": 1574227977, "post_id": 58946479, "comment_id": 104152125, "body": "What database are you using?  For the 500 records issue, you could use <code>Select Limit</code> statement(see <a href=\"https://www.techonthenet.com/sql/select_limit.php\" rel=\"nofollow noreferrer\">here</a>) or <code>Select Top</code> statement(see <a href=\"https://www.techonthenet.com/sql/select_top.php\" rel=\"nofollow noreferrer\">here</a>) to get first 500 records."}, {"owner": {"reputation": 1, "user_id": 12401504, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-opuveogfK8w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcaDvKZqJuFd6HbDq3IWeR1v0-rLw/photo.jpg?sz=128", "display_name": "Dmitry Volkov", "link": "https://stackoverflow.com/users/12401504/dmitry-volkov"}, "reply_to_user": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "edited": false, "score": 0, "creation_date": 1574228813, "post_id": 58946479, "comment_id": 104152372, "body": "I&#39;m using Oracle, so it is impossible to put more than 1000 values in  IN statement"}, {"owner": {"reputation": 4636, "user_id": 4295763, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/q1g7U.jpg?s=128&g=1", "display_name": "Arun Palanisamy", "link": "https://stackoverflow.com/users/4295763/arun-palanisamy"}, "edited": false, "score": 1, "creation_date": 1574230317, "post_id": 58946479, "comment_id": 104152833, "body": "I dont know <code>vba</code> but one alternative from SQL side is that you can create temporary table(<i>say temp</i>) and insert these column values into that table. Then you can easily query like <code>select * from mytable where name in (select myname from temp);</code>"}], "owner": {"reputation": 1, "user_id": 12401504, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-opuveogfK8w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcaDvKZqJuFd6HbDq3IWeR1v0-rLw/photo.jpg?sz=128", "display_name": "Dmitry Volkov", "link": "https://stackoverflow.com/users/12401504/dmitry-volkov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574230139, "creation_date": 1574222557, "last_edit_date": 1574230139, "question_id": 58946479, "link": "https://stackoverflow.com/questions/58946479/create-sql-query-that-contains-values-from-excel-column", "title": "Create SQL query that contains values from Excel column", "body": "<p>So I have an issue, I have a column with <code>1000+</code> values, and I need to create a macro that takes all of the values of the cells and pass them to SQL query like <code>\"select * from the table where name in (here is values from column separate with a comma)\"</code>.\nAnother issue that this query can contain only <code>500</code> values, and if the column contains <code>1000+</code> values query have to be split like <code>\"select * ...500 values...union all select * ....500 values \" and so on</code>.</p>\n\n<p>Here is some code I already have:</p>\n\n<pre><code>Dim wbBook As Workbook\nDim wsSheet As Worksheet\nDim queryString As String\nDim queryString2 As String\nDim queryString3 As String\n\n\n\nSet wbBook = ActiveWorkbook\nSet wsSheet = wbBook.Worksheets(\"Sheet1\")\nqueryString = \"select * from table where name in (\"\n\nWith wsSheet\n\n  Range(\"B2\").Select\n\n  Do Until IsEmpty(ActiveCell) And IsEmpty(ActiveCell.Offset(1, 0))\n\n     i = ActiveCell.Value\n     queryString = queryString &amp; \"'\" &amp; i &amp; \"',\"\n\n     ActiveCell.Offset(2, 0).Select\n\n  Loop\n  wsSheet.Range(\"N1\") = queryString\nEnd With\n</code></pre>\n\n<p>Thanks in advance for your help.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "edited": false, "score": 0, "creation_date": 1574238415, "post_id": 58946346, "comment_id": 104156038, "body": "A question - this separation codes are inside of the .csv file or in it&#39;s name? Anyway, you need to loop through files in folders and depending on where the code is  - open file and look for it, or evaluate its name. You may look <a href=\"https://stackoverflow.com/questions/58801191/vba-code-to-copy-specific-range-cells-from-multiple-sheets-to-one-sheet/58802736#58802736\">here</a> how to loop through files in folder."}, {"owner": {"reputation": 11, "user_id": 12401160, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EzDBk3_83qo/AAAAAAAAAAI/AAAAAAAAHNI/TGNtMlK7QSo/photo.jpg?sz=128", "display_name": "R.Harsha vardhan Reddy", "link": "https://stackoverflow.com/users/12401160/r-harsha-vardhan-reddy"}, "reply_to_user": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "edited": false, "score": 0, "creation_date": 1574252862, "post_id": 58946346, "comment_id": 104164428, "body": "Yes, this separation codes are inside of the .csv files and not in it&#39;s name. I have looked into the code that you linked and it is a little different than what I need because I am looking for Files that contain this string and not the string itself. I need to copy all the files that has this separation code in them and then have to paste them in a destination."}, {"owner": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "edited": false, "score": 0, "creation_date": 1574263639, "post_id": 58946346, "comment_id": 104171226, "body": "So, you may adapt the code from link, but instead of just copying - open it first, check whether it is the one you need, close it and copy if it fits the condition. Excel knows how to open .csv files."}, {"owner": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "edited": false, "score": 0, "creation_date": 1574265105, "post_id": 58946346, "comment_id": 104172163, "body": "And also, add comment to each line of your code which describes what it, you think, does."}], "answers": [{"tags": [], "owner": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "is_accepted": false, "score": 0, "last_activity_date": 1574329218, "creation_date": 1574329218, "answer_id": 58971676, "question_id": 58946346, "link": "https://stackoverflow.com/questions/58946346/search-for-a-string-and-move-files-containing-string-from-source-folder-to-desti/58971676#58971676", "title": "Search for a string and move files containing string from source folder to destination folder", "body": "<p>So, here's the code that should work for you.\nAs you can see, this is a version of code which I linked to you with small updates:</p>\n\n<pre><code>Sub GoThroughFilesAndCopy()\n\nDim BrowseFolder As String, DestinationFolder As String\nDim FileItem As Object\nDim oFolder As Object\nDim FSO As Object\nDim TempFileName As String\nDim CheckCode As String\n\nApplication.ScreenUpdating = False\n\n    ' selecting the folder with files\n    With Application.FileDialog(msoFileDialogFolderPicker)\n        .Title = \"Select the folder with files\"\n        .Show\n        On Error Resume Next\n        Err.Clear\n        BrowseFolder = .SelectedItems(1)\n        If Err.Number &lt;&gt; 0 Then\n            MsgBox \"You didn't select anything!\"\n            Application.ScreenUpdating = True\n            Exit Sub\n        End If\n        On Error GoTo 0\n    End With\n    ' or you may hardcode it (data from your post):\n    'BrowseFolder = \"C:\\Users\\hr315e\\Downloads\\Nov_03_2019\\\"\n\n\n    ' selecting the destination folder\n    With Application.FileDialog(msoFileDialogFolderPicker)\n        .Title = \"Select the the destination folder\"\n        .Show\n        On Error Resume Next\n        Err.Clear\n        DestinationFolder = .SelectedItems(1)\n        If Err.Number &lt;&gt; 0 Then\n            MsgBox \"You didn't select anything!\"\n            Application.ScreenUpdating = True\n            Exit Sub\n        End If\n        On Error GoTo 0\n    End With\n    ' or you may hardcode it (data from your post):\n    'DestinationFolder = \"C:\\Users\\hr315e\\Downloads\\Target\\\"\n\n\n    CheckCode = \"Some string\" ' this is you check code\n\n\n    Set FSO = CreateObject(\"Scripting.FileSystemObject\") ' creating filesystem object\n    Set oFolder = FSO.getfolder(BrowseFolder) ' creating folder object\n\n    For Each FileItem In oFolder.Files 'looking through each file in selected forlder\n        TempFileName = \"\"\n        If UCase(FileItem.Name) Like \"*.CSV*\" Then 'try opening only .csv files\n            TempFileName = BrowseFolder &amp; Application.PathSeparator &amp; FileItem.Name ' getting the full name of the file (with full path)\n            If CheckTheFile(TempFileName, CheckCode) Then ' if the file passes the checking function\n                If Dir(DestinationFolder &amp; Application.PathSeparator &amp; FileItem.Name) = \"\" Then 'if the file doesn't exist in destination folder\n                    FileCopy Source:=TempFileName, Destination:=DestinationFolder &amp; Application.PathSeparator &amp; FileItem.Name  ' it is copied to destination\n                Else ' otherwise, there are to options how to deal with it further\n\n                    'uncomment the part you need below:\n\n                    ' this will Overwrite existing file\n                    'FSO.CopyFile Source:=TempFileName, Destination:=DestinationFolder &amp; Application.PathSeparator &amp; FileItem.Name\n\n                    ' this will get new name for file and save it as copy\n                    'FileCopy Source:=TempFileName, Destination:=GetNewDestinationName(FileItem.Name, DestinationFolder)\n\n                End If\n            End If\n        End If\n    Next\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n\n'////////////////////////////////////////////////////////////////////////\n\nFunction CheckTheFile(File As String, Check As String) As Boolean\nDim TestLine As String\nDim TestCondition As String\n\nTestCondition = \"*\" &amp; Check &amp; \"*\" ' this is needed to look for specific text in the file, refer to Like operator fro details\n\nCheckTheFile = False\n\nOpen File For Input As #1 ' open file to read it line by line\n    Do While Not EOF(1)\n        Line Input #1, TestLine ' put each line of the text to variable to be able to check it\n\n        If TestLine Like TestCondition Then ' if the line meets the condition\n            CheckTheFile = True             ' then function gets True value, no need to check other lines as main condition is met\n            Close #1                        ' don't forget to close the file, beacuse it will be still opened in background\n            Exit Function                   ' exit the loop and function\n        End If\n    Loop\nClose #1 ' if condiotion is not found in file just close the file, beacuse it will be still opened in background\n\nEnd Function\n\n'////////////////////////////////////////////////////////////////////////\n\nFunction GetNewDestinationName(File As String, Destination As String) As String\nDim i As Integer: i = 1\n\nDo Until Dir(Destination &amp; Application.PathSeparator &amp; \"Copy (\" &amp; i &amp; \") \" &amp; File) = \"\" ' if Dir(FilePath) returns \"\" (empty string) it means that the file does not exists, so can save new file with this name\n    i = i + 1   ' incrementing counter untill get a unique name\nLoop\n\nGetNewDestinationName = Destination &amp; Application.PathSeparator &amp; \"Copy (\" &amp; i &amp; \") \" &amp; File ' return new file name\n\nEnd Function\n</code></pre>\n\n<p>Basically, there is one sub, which is mostly copy-paste from linked topic, and two simple functions.</p>\n"}], "owner": {"reputation": 11, "user_id": 12401160, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EzDBk3_83qo/AAAAAAAAAAI/AAAAAAAAHNI/TGNtMlK7QSo/photo.jpg?sz=128", "display_name": "R.Harsha vardhan Reddy", "link": "https://stackoverflow.com/users/12401160/r-harsha-vardhan-reddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1574329218, "creation_date": 1574221555, "last_edit_date": 1574255239, "question_id": 58946346, "link": "https://stackoverflow.com/questions/58946346/search-for-a-string-and-move-files-containing-string-from-source-folder-to-desti", "title": "Search for a string and move files containing string from source folder to destination folder", "body": "<p>I have large number of .csv files in a folder and each file has few separation codes in them. Separation code usually will be 5 digit code eg: B82A6.</p>\n\n<p>I have to copy files with a certain separation code and move them to a destination folder.</p>\n\n<p>I am new to VBA. I've been searching for code to modify it to my use.</p>\n\n<pre><code>Sub Test()\nDim R As Range, r1 As Range\nDim SourcePath As String, DestPath As String, SeperationCode As String\n\nSourcePath = \"C:\\Users\\hr315e\\Downloads\\Nov_03_2019\\\"\nDestPath = \"C:\\Users\\hr315e\\Downloads\\Target\\\"\nSet r1 = Range(\"A1\", Range(\"A\" &amp; Rows.Count).End(xlUp))\n\nFor Each R In r1\n    SeperationCode = Dir(SourcePath &amp; R)\n\n    Do While SeperationCode &lt;&gt; \"\"\n\n        If Application.CountIf(r1, SeperationCode) Then\n            FileCopy SourcePath &amp; SeperationCode, DestPath &amp; SeperationCode\n\n            R.Offset(0, 1).Value = SeperationCode\n\n        Else\n\n            MsgBox \"Bad file: \" &amp; SeperationCode &amp; \" ==&gt;\" &amp; SeperationCode &amp; \"&lt;== \"\n\n        End If\n\n       SeperationCode = Dir(SourcePath &amp; \"B82A6\" &amp; R.Value &amp; \"B82A6\")\n    Loop\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7643980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67e12f1490154b4af4737fb971ada47d?s=128&d=identicon&r=PG&f=1", "display_name": "Leif", "link": "https://stackoverflow.com/users/7643980/leif"}, "is_accepted": false, "score": 0, "last_activity_date": 1574224277, "creation_date": 1574224277, "answer_id": 58946725, "question_id": 58946054, "link": "https://stackoverflow.com/questions/58946054/find-cell-select-copy-from-active-cell-to-last-row-including-blanks/58946725#58946725", "title": "Find cell &amp; select/copy from active cell to last row including blanks", "body": "<p>To find the column use Match wit the column header name. Once you have that column, set the values in the destination range to be the same as that column. Selecting, copying, and pasting in VBA are unnecessary as the values themselves can be moved--plus it adds load.</p>\n\n<p>I don't have Office anymore so I'm running this from memory. I hope it helps.</p>\n\n<pre><code>dim wb as workbook, ws1, ws2 as worksheet, myCol, myRow as long\n\nset wb=excel.thisworkbook 'assuming this code goes in that workbook\nset ws1=wb.sheets(2) 'set variables\n\nmyCol=worksheetfunction.match(\"FFA Name\",ws1.[a1:zz1],0) 'search through 1st row\nmyRow=ws1.[a3].currentregion.rows.count 'grab last row containing data in this set\n\n'do not select, nor copy and paste, if it can all be done with VBA. This can.\n\nset ws2=wb.sheets.add 'a little rusty on this line, you can get the method from the macro recorder\nws2.cells(1,1).resize(myrow).value=ws1.cells(1,myCol).resize(myrow).value\n\n</code></pre>\n\n<p>The reason your original code stops when there's a blank cell is because the .end() method simulates pushing the end key and then an arrow, which goes to the first/last contiguous cell with data.\n<code>\nRange(ActiveCell, ActiveCell.End(xlDown)).Select\n</code></p>\n"}], "owner": {"reputation": 39, "user_id": 12401306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0398ce99e0e65db50c2fa20fb48d53c?s=128&d=identicon&r=PG&f=1", "display_name": "Mturks83", "link": "https://stackoverflow.com/users/12401306/mturks83"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 672, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574264244, "creation_date": 1574219514, "last_edit_date": 1574264244, "question_id": 58946054, "link": "https://stackoverflow.com/questions/58946054/find-cell-select-copy-from-active-cell-to-last-row-including-blanks", "title": "Find cell &amp; select/copy from active cell to last row including blanks", "body": "<p>I'm attempting to find a column using the column header name, then select all the data from the column (including the blank cells) &amp; paste into another range.</p>\n\n<p>Currently I can only copy until the 1st blank cell. I have seen similar problems on the board but the solutions I have seen are coming from the angle of knowing which column it is in first &amp; then finding the last row from the bottom of the worksheet.</p>\n\n<pre><code>Workbooks(\"PS &amp; Config - Actuals &amp; FC.xlsm\").Worksheets(2).Range(\"A3\").CurrentRegion.Find(What:=\"FFA Name\").Select\nRange(ActiveCell, ActiveCell.End(xlDown)).Select\nRange(\"A3\").Select\nActiveSheet.Paste\n</code></pre>\n"}, {"tags": ["vba", "search", "outlook", "vlookup"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1574218685, "post_id": 58945944, "comment_id": 104149974, "body": "Firstly, use <code>.Add ExcelFilename</code> instead of <code>.Open(ExcelFilename)</code> so it will open even if someone else has it open. Then dont forget to close it when you are done."}, {"owner": {"reputation": 1, "user_id": 12401265, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159532042088312/picture?type=large", "display_name": "Yue", "link": "https://stackoverflow.com/users/12401265/yue"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1574219198, "post_id": 58945944, "comment_id": 104150061, "body": "Thanks for the feedback, I have made the adjustment!"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1574221493, "post_id": 58945944, "comment_id": 104150547, "body": "Now you just need to record a macro that does a <code>Find</code> on a range and adjust it to your liking, then add it in the spot it needs to be. There really is no need for a <code>VLookup</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 12401265, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159532042088312/picture?type=large", "display_name": "Yue", "link": "https://stackoverflow.com/users/12401265/yue"}, "is_accepted": false, "score": 0, "last_activity_date": 1574802181, "creation_date": 1574802181, "answer_id": 59059283, "question_id": 58945944, "link": "https://stackoverflow.com/questions/58945944/outlook-vba-vlookup-into-excel-file/59059283#59059283", "title": "Outlook VBA VLOOKUP into Excel File", "body": "<p>Got the code to work properly :)\nThanks @braX for the tip.</p>\n\n<pre><code>Sub LookUpExcel()\n\nDim objExcel As New Excel.Application\nDim exWb As Excel.Workbook\nDim ExcelFileName As String\nDim ColumnA As String\nDim ColumnB As String\n\nDim oMsg As MailItem\n\nExcelFileName = \"C:\\Filelocation\\Testfile.xlsx\"\n\nSet exWb = objExcel.Workbooks.Add(ExcelFileName)\n\n\nColumnA = InputBox(\"Please Column A value.\")\n\nColumnB = exWb.Worksheets(\"Sheet1\").Range(\"A:A\").Find(ColumnA).Offset(0, 1).Value\n\nmsgbox (ColumnB)\n\nExitRoutine:\n    Set oMsg = Nothing\n    Set exWb = Nothing\n    Set objExcel = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12401265, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159532042088312/picture?type=large", "display_name": "Yue", "link": "https://stackoverflow.com/users/12401265/yue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 236, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574802181, "creation_date": 1574218577, "last_edit_date": 1574218599, "question_id": 58945944, "link": "https://stackoverflow.com/questions/58945944/outlook-vba-vlookup-into-excel-file", "title": "Outlook VBA VLOOKUP into Excel File", "body": "<p>New to Outlook VBA what are my choices if I want Outlook to look into an Excel file's A column for a value and return the B column value? (Same as a VLOOKUP)</p>\n\n<pre><code>Option Explicit\n\nSub LookUpExcel()\n\nDim objExcel As New Excel.Application\nDim exWb As Excel.Workbook\nDim ExcelFileName As String\nDim ColumnA As String\nDim ColumnB As String\n\nDim oMsg As MailItem\n\nExcelFileName = \"C:\\Users\\vfdme\\Desktop\\test.xlsx\"\n\nSet exWb = objExcel.Workbooks.Open(ExcelFileName)\n\nColumnA = InputBox(\"Please Column A value.\") \n\n\n\n'[VLOOKUP / Search function?]\n\n\n\nMsgBox (ColumnB)\n\nExitRoutine:\n    Set oMsg = Nothing\n    Set exWb = Nothing\n    Set objExcel = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "bert-language-model"], "answers": [{"tags": [], "owner": {"reputation": 80, "user_id": 4143456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd743d4e245185f2f596eebab920f3e?s=128&d=identicon&r=PG&f=1", "display_name": "Mon Mo", "link": "https://stackoverflow.com/users/4143456/mon-mo"}, "is_accepted": false, "score": 0, "last_activity_date": 1582150464, "creation_date": 1582150464, "answer_id": 60310115, "question_id": 58945354, "link": "https://stackoverflow.com/questions/58945354/run-excel-macro-from-bert/60310115#60310115", "title": "Run Excel macro from BERT", "body": "<p>The function to run a macro requires calling the name of the macro and the sheet that hosts it within the workbook. It uses the name of the macro as saved in the macros menu and the action associated with it, not the text written on the clickable button itself. In this case that button was labeled with the text \"Button_To_Click\", but the actual name of the macro was \"CalculateButton\", saved in Sheet2, and the action associated with it was \"Click\". The BERT command <code>Run.Macro()</code> was sufficient as long as the BERT scripts are sourced. </p>\n\n<pre><code>source(file.path(\"C:/Users/MyName/Documents/BERT2/examples/excel-functions.r\" )) #loads special BERT functions needed to have Excel and R interact\nRun.Macro ( \"Sheet2.CalculateButton_Click\") #runs the macro named 'CalculateButton' located in Sheet2\n</code></pre>\n"}], "owner": {"reputation": 80, "user_id": 4143456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd743d4e245185f2f596eebab920f3e?s=128&d=identicon&r=PG&f=1", "display_name": "Mon Mo", "link": "https://stackoverflow.com/users/4143456/mon-mo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 184, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1582150464, "creation_date": 1574213597, "question_id": 58945354, "link": "https://stackoverflow.com/questions/58945354/run-excel-macro-from-bert", "title": "Run Excel macro from BERT", "body": "<p>I'm trying to run an Excel 2016 macro in BERT. Within the spreadsheet, I can operate the macro as a button called \"Button_To_Click\". This is the name of the macro in the Excel document's list of macros as well. I'm using the command <code>EXCEL$Application.Run(\"BERT.Call\", \"Button_To_Click\")</code> and receiving the message <code>Error: attempt to apply non-function</code>.</p>\n\n<p>This is my first time using BERT or anything VBA-related (I'm more familiar with R), and the documentation is unclear to me on how to make macros that were created and stored in Excel work in BERT. A more complete example is below:</p>\n\n<pre><code>wb &lt;- EXCEL$Application$get_ActiveWorkbook();\nINsheet &lt;- wb$get_Sheets(1); #get first sheet in active workbook\n\nS = c(155,157,159)\nrange &lt;- MEMsheet$get_Range( \"B10:B10\" ); #change B10 to S[1]\nrange$put_Value(S[1]);\n\n### 'Run Model' button is named 'Button_To_Click'. ###\nEXCEL$Application.Run(\"BERT.Call\", \"Button_To_Click\");\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 6, "creation_date": 1574210253, "post_id": 58944867, "comment_id": 104148240, "body": "If 23.1 is different from 23.10, then they are not numbers to begin with. If they are not numbers, you should keep them as strings, for which format the cells as &quot;Text&quot; before assigning the value."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12400785, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDflBPMDcS9HzsJpBk3eCp6DBf2TV_OwM_erRAF=k-s128", "display_name": "Jasmine", "link": "https://stackoverflow.com/users/12400785/jasmine"}, "edited": false, "score": 0, "creation_date": 1574282810, "post_id": 58948161, "comment_id": 104181287, "body": "This works to keep the zeros but it would affect the vlookups later on where I would have formulas that would take that string and find it in a different table. So in order for the vlookup to work, the table would also need to have apostrophes at the beginning. So I used something similar to your idea to try to make it work."}], "tags": [], "owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "is_accepted": false, "score": 0, "last_activity_date": 1574231865, "creation_date": 1574231865, "answer_id": 58948161, "question_id": 58944867, "link": "https://stackoverflow.com/questions/58944867/keep-trailing-zero-after-using-left-function-in-vba/58948161#58948161", "title": "Keep trailing zero after using LEFT function in VBA", "body": "<p>As @GSerg noted in the comments, the OP is not dealing with numbers, but with identifiers. Identifiers are usually best handled as strings.</p>\n\n<p>Treat this as an array, which can be split and joined.</p>\n\n<pre><code>Dim DataElements as Variant\nDim SelectedElements as Variant\nDataElements = Split(Cells(i, 26).value, \".\") '&lt;-- create an array out of the elements\nSelectedElements = Array(DataElements(0), DataElements(1)) '&lt;-- create a new array of only the wanted elements\n\nCells(i, 27).value = \"='\" &amp; Join(SelectedElements,\".\") \n' The =' at the start will force the entry to be a string, and not automatically interpreted as a number\n' Otherwise, you could format the column to be Text rather than General\n</code></pre>\n\n<p>The above will preserve the strings as originally presented.</p>\n\n<blockquote>\n  <p>Cells(i, 26).value: 23.10.847475993.38.12039</p>\n  \n  <p>DataElements: 23, 10, 847475993, 38, 12039</p>\n  \n  <p>SelectedElements:  23, 10</p>\n  \n  <p>Cells(i, 27).value: ='23.10</p>\n</blockquote>\n\n<p>Second case</p>\n\n<blockquote>\n  <p>Cells(i, 26).value: 23.1.875934.28301.23814</p>\n  \n  <p>DataElements: 23, 1, 875934, 28301, 23814</p>\n  \n  <p>SelectedElements:  23, 1</p>\n  \n  <p>Cells(i, 27).value: ='23.1</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12400785, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDflBPMDcS9HzsJpBk3eCp6DBf2TV_OwM_erRAF=k-s128", "display_name": "Jasmine", "link": "https://stackoverflow.com/users/12400785/jasmine"}, "is_accepted": false, "score": 0, "last_activity_date": 1574283254, "creation_date": 1574283254, "answer_id": 58963211, "question_id": 58944867, "link": "https://stackoverflow.com/questions/58944867/keep-trailing-zero-after-using-left-function-in-vba/58963211#58963211", "title": "Keep trailing zero after using LEFT function in VBA", "body": "<p>Building off of @AJD's answer, I modified the code so that there wouldn't be an apostrophe since the string would be used in a vlookup. I'm not much of a coder so this is what I got to work with formulas but I'm sure there is a better and quicker way.</p>\n\n<pre><code>Dim DataElements1 As String\nDim DataElements2 As String\nDim SelectedElements As Variant\n\nDataElements1 = Split(Cells(i, 26).Value, \".\")(0)\nDataElements2 = Split(Cells(i, 26).Value, \".\")(1)\n\nCells(i, 27).Formula = \"=\" &amp; DataElements1 &amp; \"&amp;\"\".\"\"&amp;\" &amp; DataElements2 &amp; \"\"\nRange(\"AA3:AA\" &amp; RowCount).Copy\nRange(\"AA3:AA\" &amp; RowCount).PasteSpecial xlPasteValues\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12400785, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDflBPMDcS9HzsJpBk3eCp6DBf2TV_OwM_erRAF=k-s128", "display_name": "Jasmine", "link": "https://stackoverflow.com/users/12400785/jasmine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1574283338, "creation_date": 1574209513, "last_edit_date": 1574283338, "question_id": 58944867, "link": "https://stackoverflow.com/questions/58944867/keep-trailing-zero-after-using-left-function-in-vba", "title": "Keep trailing zero after using LEFT function in VBA", "body": "<p>I'm trying to figure out how to keep the trailing zero after a decimal in a set of numbers that is being extracted from a string of numbers with decimals. First I determine the position of the second decimal and then use the LEFT function to extract everything before. Ideally I want the extracted numbers to stay the way it was in the string but some have trailing zeros and some don't (ie 23.1 is different from 23.10). Right now the results of my code drops the trailing zeros.</p>\n\n<p>Edit: The result cannot have any other additions to it as it will be used in a vlookup.</p>\n\n<p>Examples of what the results should be:</p>\n\n<pre><code>String: 23.10.847475993.38.12039\n\nResult: 23.10\n\nString: 23.1.875934.28301.23814\n\nResult: 23.1\n</code></pre>\n\n<p>Here is my code:</p>\n\n<pre><code>Dim Datastring  As String\nDim PeriodPosition As Integer\n\nDatastring = Cells(i, 26).Value\nPeriodPosition = InStr(1, Datastring, \".\", vbTextCompare)\nPeriodPosition = InStr(1 + PeriodPosition, Datastring, \".\", vbTextCompare)\n\nCells(i, 27).Value = Left(Datastring, PeriodPosition - 1)\n</code></pre>\n\n<p>Any help is appreciated!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 2, "creation_date": 1574210521, "post_id": 58944853, "comment_id": 104148297, "body": "No, the code below receives error 424 Object required."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1574210655, "post_id": 58944853, "comment_id": 104148321, "body": "Your code doesn&#39;t generate the error you&#39;ve indicated. In addition, it contains a fairly obvious typo that I&#39;d wager you can spot yourself by carefully reading the code, especially the line which generates the <i>Object required</i> error."}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1574212780, "post_id": 58944853, "comment_id": 104148791, "body": "You do not need to <code>Select</code> the range that you set"}], "owner": {"reputation": 21, "user_id": 12305625, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156611201375592/picture?type=large", "display_name": "Ricky Dhaliwal", "link": "https://stackoverflow.com/users/12305625/ricky-dhaliwal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574210427, "creation_date": 1574209426, "last_edit_date": 1574210427, "question_id": 58944853, "link": "https://stackoverflow.com/questions/58944853/vba-code-runtime-7-error-message-out-of-memory", "title": "VBA Code - Runtime 7 Error Message - out of memory", "body": "<p>The code below receives a Runtime 7 Error Message - out of memory</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub CommandButton1_Click()\n    Var = InputBox(\"Enter the test, test\")\n\n    Dim myrange As Range\n    Set myrange = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A1:J50\").Select\n\n    For Each Cell In myrange.Cells\n        If Cells.Value = Var Then\n            Cell.Interior.Color = 255\n        End If\n    Next \nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1110, "user_id": 5572384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2BvJ.jpg?s=128&g=1", "display_name": "StoneGiant", "link": "https://stackoverflow.com/users/5572384/stonegiant"}, "edited": false, "score": 2, "creation_date": 1574209227, "post_id": 58944737, "comment_id": 104148017, "body": "Check the length of the value of D5. If there is something in it, don&#39;t put anything there."}], "answers": [{"comments": [{"owner": {"reputation": 647, "user_id": 2116936, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/q1TFp.jpg?s=128&g=1", "display_name": "PropK", "link": "https://stackoverflow.com/users/2116936/propk"}, "edited": false, "score": 0, "creation_date": 1574211850, "post_id": 58944969, "comment_id": 104148561, "body": "How would I use the values I set in B5:B50 in this sheet in a macro from another sheet? I want to use the value from B5 for instance in this macro to populate another range of cells with another const txt in another sheet."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 647, "user_id": 2116936, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/q1TFp.jpg?s=128&g=1", "display_name": "PropK", "link": "https://stackoverflow.com/users/2116936/propk"}, "edited": false, "score": 0, "creation_date": 1574212053, "post_id": 58944969, "comment_id": 104148618, "body": "Instead of <code>Me</code> you would reference the other sheet, either using its tab name or its codename."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1574210452, "creation_date": 1574210452, "answer_id": 58944969, "question_id": 58944737, "link": "https://stackoverflow.com/questions/58944737/keep-text-changes-of-data-when-cell-is-still-within-resize-range/58944969#58944969", "title": "Keep text changes of data when cell is still within resize range", "body": "<p>Something like this:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Const NUM_COLS As Long = 5\n    Const TXT = \"\u2022 Course Name:\" &amp; vbNewLine &amp; _\n              \"\u2022 No. Of Slides Affected:\" &amp; vbNewLine &amp; _\n              \"\u2022 No. of Activities Affected:\"\n\n    Dim rng As Range, i As Long, v\n\n    If Target.CountLarge &lt;&gt; 1 Then Exit Sub\n\n    If Not Intersect(Target, Me.Range(\"B5:B50\")) Is Nothing Then\n\n        Set rng = Target.Offset(0, 2).Resize(1, NUM_COLS) 'range to check\n        v = Target.Value\n\n        If IsNumeric(v) And v &gt;= 1 And v &lt;= NUM_COLS Then\n            For i = 1 To rng.Cells.Count\n                With rng.Cells(i)\n                    If i &lt;= v Then\n                        'Populate if not already populated\n                        If .Value = \"\" Then .Value = TXT\n                    Else\n                        'Clear any existing value\n                        .Value = \"\"\n                    End If\n                End With\n            Next i\n        Else\n            rng.Value = \"\" 'clear any existing content\n        End If\n\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 647, "user_id": 2116936, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/q1TFp.jpg?s=128&g=1", "display_name": "PropK", "link": "https://stackoverflow.com/users/2116936/propk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 58944969, "answer_count": 1, "score": 0, "last_activity_date": 1574252906, "creation_date": 1574208452, "last_edit_date": 1574252906, "question_id": 58944737, "link": "https://stackoverflow.com/questions/58944737/keep-text-changes-of-data-when-cell-is-still-within-resize-range", "title": "Keep text changes of data when cell is still within resize range", "body": "<p>I have a VBA Macro that is setting the values of cells based on user input from specific cells in range.<br>\nHowever if I add text to the cell that was updated, if I change the user value it wipes my additional text.</p>\n\n<p>For Example:</p>\n\n<p>I set B5 as 2, which populates D5 and E5 with the following text values:</p>\n\n<ul>\n<li>Course Name:</li>\n<li>No. Of Slides Affected:</li>\n<li>No. of Activities Affected:</li>\n</ul>\n\n<p>If I update the D5 with additional text in the cell etc. Course Name: abc, and update the value of B5 to 1. D5 is still within the range, but it deletes the additional text I just entered.</p>\n\n<p>How can I set it so that it doesn't reset the text values if they have been edited when I reduce or increase the value of B5?</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.CountLarge &lt;&gt; 1 Then Exit Sub\n\n    If Not Intersect(Target, Me.Range(\"B5:B50\")) Is Nothing Then\n        Dim rw As Long\n        rw = Target.Row\n\n        Dim txt As String\n        txt = \"\u2022 Course Name:\" &amp; vbNewLine &amp; _\n              \"\u2022 No. Of Slides Affected:\" &amp; vbNewLine &amp; _\n              \"\u2022 No. of Activities Affected:\"\n\n        Select Case Target.Value\n            Case 1 To 5\n                Me.Range(\"D\" &amp; rw).Resize(, Target.Value).Value = txt\n            Case Else\n                Me.Range(\"D\" &amp; rw &amp; \":H\" &amp; rw).Value = \"\"\n        End Select\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "pivot-table"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1574208047, "post_id": 58944298, "comment_id": 104147697, "body": "It will be easier to troubleshoot and maintain your code if you follow the guidelines here: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 19, "user_id": 12398922, "user_type": "registered", "profile_image": "https://graph.facebook.com/10220481198243103/picture?type=large", "display_name": "Antonio Inserni", "link": "https://stackoverflow.com/users/12398922/antonio-inserni"}, "is_accepted": false, "score": 0, "last_activity_date": 1574282429, "creation_date": 1574282429, "answer_id": 58963029, "question_id": 58944298, "link": "https://stackoverflow.com/questions/58944298/add-pivot-table-to-sequential-worksheets/58963029#58963029", "title": "Add Pivot Table to Sequential Worksheets", "body": "<p>I think I've got it. The solution lay in changing the PivotTable number. I did so by making PivotTable an Array in the declaration, then using the Do While index to assign the array index. Again, I did very little of this on my own. THANK YOU community for posting such helpful guidance! </p>\n\n<pre><code>Sub Pivot_Maker() 'from internet\n\nDim FinalRow            As Long\nDim DataSheet           As String\nDim PvtCache            As PivotCache\nDim PvtTbl(7)              As PivotTable\nDim DataRng             As Range\nDim TableDest           As Range\n\nSalesman(0) = \"House\"\nSalesman(1) = \"Guy1\"\nSalesman(2) = \"Gal1\"\nSalesman(3) = \"Guy2\"\nSalesman(4) = \"Gal2\"\nSalesman(5) = \"Chucky\"\nSalesman(6) = \"Kenny\"\nNumSalesPeeps = UBound(Salesman)\n\ni = 0\n\nDo While i &lt; NumSalesPeeps\n    Sheets(Salesman(i)).Select\n\n        FinalRow = Cells(Rows.Count, 1).End(xlUp).Row\n        DataSheet = ActiveSheet.Name\n        PvtTblName = ActiveSheet.Name &amp; \"pvt\"\n\n        ' set data range for Pivot Table\n        Set DataRng = Sheets(DataSheet).Range(Cells(1, 1), Cells(FinalRow, 10))  ' conversion of R1C1:R &amp; FinalRow &amp; C8\n\n        ' set range for Pivot table placement\n        Set TableDest = Sheets(DataSheet).Cells(1, 12)  ' conversion of R1C9\n\n\n        Set PvtCache = ActiveWorkbook.PivotCaches.Add(xlDatabase, DataRng)\n\n        ' this line in case the Pivot table doesn't exit &gt;&gt; first time running this Macro\n        On Error Resume Next\n        Set PvtTbl(i) = ActiveWorkbook.Sheets(DataSheet).PivotTables(PvtTblName) ' check if PvtTblName Pivot Table already created (in past runs of this Macro)\n\n        On Error GoTo 0\n        If PvtTbl(i) Is Nothing Then ' PvtTblName doesn't exist &gt;&gt; create it\n\n            ' create a new Pivot Table in PvtTblName sheet\n            Set PvtTbl(i) = ActiveWorkbook.Sheets(DataSheet).PivotTables.Add(PivotCache:=PvtCache, TableDestination:=TableDest, TableName:=PvtTblName)\n\n\n        With PvtTbl(i).PivotFields(\"Account\")\n                .Orientation = xlColumnField\n                .Position = 1\n            End With\n            With PvtTbl(i).PivotFields(\"Name\")\n                .Orientation = xlRowField\n                .Position = 1\n            End With\n            PvtTbl(i).AddDataField ActiveSheet.PivotTables( _\n                PvtTblName).PivotFields(\"Amount\"), \"Sum of Amount\", xlSum\n\n        Else\n            ' just refresh the Pivot cache with the updated Range\n            PvtTbl(i).ChangePivotCache PvtCache\n            PvtTbl(i).RefreshTable\n        End If\ni = i + 1\nLoop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 12398922, "user_type": "registered", "profile_image": "https://graph.facebook.com/10220481198243103/picture?type=large", "display_name": "Antonio Inserni", "link": "https://stackoverflow.com/users/12398922/antonio-inserni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1574282429, "creation_date": 1574205229, "last_edit_date": 1574208318, "question_id": 58944298, "link": "https://stackoverflow.com/questions/58944298/add-pivot-table-to-sequential-worksheets", "title": "Add Pivot Table to Sequential Worksheets", "body": "<p>First THANK YOU everyone who's contributed to this forum. The following is a result of all that help. I've taken an entire db of sales data and separated on different sheets by saleman. Now I want to summarize the data in a pivot table on each sheet. The problem is: this uses new data each iteration, but it only updates the first Pivot Table. What's NOT changing is this statement:</p>\n\n<hr>\n\n<pre><code> Set PvtTbl = ActiveWorkbook.Sheets(DataSheet).PivotTables(PvtTblName) ' check if PvtTblName Pivot Table already created (in past runs of this     Macro)\n</code></pre>\n\n<hr>\n\n<p>In every case, the PvtTbl remains \"John\" </p>\n\n<p>Do I need to clear the Pivot Tables at the start?</p>\n\n<hr>\n\n<pre><code>   Sub Pivot_Maker() 'from internet\n\n    Dim FinalRow            As Long\n    Dim DataSheet           As String\n    Dim PvtCache            As PivotCache\n    Dim PvtTbl              As PivotTable\n    Dim DataRng             As Range\n    Dim TableDest           As Range\n\n    Salesman(0) = \"John\"\n    Salesman(1) = \"Joe\"\n    Salesman(2) = \"Jody\"\n    Salesman(3) = \"Jack\"\n    Salesman(4) = \"Junior\"\n    Salesman(5) = \"Janet\"\n    Salesman(6) = \"Jona\"\n    NumSalesPeeps = UBound(Salesman)\n\n    i = 0\n\n    Do While i &lt; NumSalesPeeps\n        Sheets(Salesman(i)).Select\n\n            FinalRow = Cells(Rows.Count, 1).End(xlUp).Row\n            DataSheet = ActiveSheet.Name\n            PvtTblName = ActiveSheet.Name &amp; \"pvt\"\n\n        ' set data range for Pivot Table\n        Set DataRng = Sheets(DataSheet).Range(Cells(1, 1), Cells(FinalRow, 10))  ' conversion of R1C1:R &amp; FinalRow &amp; C8\n\n'*************************************************************\n    DataRng.Select\nWith Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 60407\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n\n'*******************************************************\n\n\n\n        ' set range for Pivot table placement\n        Set TableDest = Sheets(DataSheet).Cells(1, 12)  ' conversion of R1C9\n\n'***********************************************\n    TableDest.Select\nWith Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 49407\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n\n'***********************************************\n\n        Set PvtCache = ActiveWorkbook.PivotCaches.Add(xlDatabase, DataRng)\n\n        ' this line in case the Pivot table doesn't exit &gt;&gt; first time running this Macro\n        On Error Resume Next\n        Set PvtTbl = ActiveWorkbook.Sheets(DataSheet).PivotTables(PvtTblName) ' check if PvtTblName Pivot Table already created (in past runs of this Macro)\n\n        On Error GoTo 0\n        If PvtTbl Is Nothing Then ' PvtTblName doesn't exist &gt;&gt; create it\n\n            ' create a new Pivot Table in PvtTblName sheet\n            Set PvtTbl = ActiveWorkbook.Sheets(DataSheet).PivotTables.Add(PivotCache:=PvtCache, TableDestination:=TableDest, TableName:=PvtTblName)\n\n\n        With PvtTbl.PivotFields(\"Account\")\n                .Orientation = xlColumnField\n                .Position = 1\n            End With\n            With PvtTbl.PivotFields(\"Name\")\n                .Orientation = xlRowField\n                .Position = 1\n            End With\n            PvtTbl.AddDataField ActiveSheet.PivotTables( _\n            PvtTblName).PivotFields(\"Amount\"), \"Sum of Amount\", xlSum\n\n        Else\n            ' just refresh the Pivot cache with the updated Range\n            PvtTbl.ChangePivotCache PvtCache\n            PvtTbl.RefreshTable\n        End If\ni = i + 1\nLoop\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 647, "user_id": 2116936, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/q1TFp.jpg?s=128&g=1", "display_name": "PropK", "link": "https://stackoverflow.com/users/2116936/propk"}, "edited": false, "score": 0, "creation_date": 1574206434, "post_id": 58944418, "comment_id": 104147291, "body": "Yes, thats perfect! Saved me a few hours of c&amp;p :-)"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 647, "user_id": 2116936, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/q1TFp.jpg?s=128&g=1", "display_name": "PropK", "link": "https://stackoverflow.com/users/2116936/propk"}, "edited": false, "score": 0, "creation_date": 1574206453, "post_id": 58944418, "comment_id": 104147296, "body": "Glad to help out!"}, {"owner": {"reputation": 647, "user_id": 2116936, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/q1TFp.jpg?s=128&g=1", "display_name": "PropK", "link": "https://stackoverflow.com/users/2116936/propk"}, "edited": false, "score": 0, "creation_date": 1574207117, "post_id": 58944418, "comment_id": 104147463, "body": "if i set a value of 2 for B5, it populates 2 cells with the data. If i was to add additional text to that cell it gets removed if i update B5 to 1. It resets the text values. Is there a way to save changes if the change is still within range?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 647, "user_id": 2116936, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/q1TFp.jpg?s=128&g=1", "display_name": "PropK", "link": "https://stackoverflow.com/users/2116936/propk"}, "edited": false, "score": 0, "creation_date": 1574207754, "post_id": 58944418, "comment_id": 104147631, "body": "Yes. Sounds like the code should only add the text if the range in question is currently empty?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 647, "user_id": 2116936, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/q1TFp.jpg?s=128&g=1", "display_name": "PropK", "link": "https://stackoverflow.com/users/2116936/propk"}, "edited": false, "score": 0, "creation_date": 1574207772, "post_id": 58944418, "comment_id": 104147632, "body": "Might be worth asking that as a new question since I&#39;m not sure I understand the details. Feel free to ping me here with the link too."}, {"owner": {"reputation": 647, "user_id": 2116936, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/q1TFp.jpg?s=128&g=1", "display_name": "PropK", "link": "https://stackoverflow.com/users/2116936/propk"}, "edited": false, "score": 0, "creation_date": 1574207792, "post_id": 58944418, "comment_id": 104147638, "body": "No problem, will do! Thank you"}, {"owner": {"reputation": 647, "user_id": 2116936, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/q1TFp.jpg?s=128&g=1", "display_name": "PropK", "link": "https://stackoverflow.com/users/2116936/propk"}, "edited": false, "score": 0, "creation_date": 1574208511, "post_id": 58944418, "comment_id": 104147826, "body": "Link here: <a href=\"https://stackoverflow.com/questions/58944737/excel-vba-keep-text-changes-of-data-when-cell-is-still-within-resize-range\" title=\"excel vba keep text changes of data when cell is still within resize range\">stackoverflow.com/questions/58944737/&hellip;</a>"}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 1, "last_activity_date": 1574206093, "creation_date": 1574206093, "answer_id": 58944418, "question_id": 58944290, "link": "https://stackoverflow.com/questions/58944290/excel-vba-for-setting-specific-cell-values-based-on-user-choice/58944418#58944418", "title": "Excel VBA for setting specific cell values based on user choice", "body": "<p>If I understand what you're trying to do, perhaps the following using <code>Resize</code> and <code>Target.Row</code></p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.CountLarge &lt;&gt; 1 Then Exit Sub\n\n    If Not Intersect(Target, Me.Range(\"B5:B10\")) Is Nothing Then\n        Dim rw As Long\n        rw = Target.Row\n\n        Dim txt As String\n        txt = \"\u2022 Course Name:\" &amp; vbNewLine &amp; _\n              \"\u2022 No. Of Slides Affected:\" &amp; vbNewLine &amp; _\n              \"\u2022 No. of Activities Affected:\"\n\n        Select Case Target.Value\n            Case 1 To 3\n                Me.Range(\"D\" &amp; rw).Resize(, Target.Value).Value = txt\n            Case Else\n                Me.Range(\"D\" &amp; rw &amp; \":F\" &amp; rw).Value = \"\"\n        End Select\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 647, "user_id": 2116936, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/q1TFp.jpg?s=128&g=1", "display_name": "PropK", "link": "https://stackoverflow.com/users/2116936/propk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 58944418, "answer_count": 1, "score": 0, "last_activity_date": 1574208330, "creation_date": 1574205211, "last_edit_date": 1574208330, "question_id": 58944290, "link": "https://stackoverflow.com/questions/58944290/excel-vba-for-setting-specific-cell-values-based-on-user-choice", "title": "Excel VBA for setting specific cell values based on user choice", "body": "<p>Looking for help to improve the efficiency of my VBA code here.\nNot sure how i can set it up that if i have 10 row in B (B5 to B10), that it will automatically populate the: </p>\n\n<ul>\n<li>D column of that row if the value of B is 1, </li>\n<li>update D and E if the value of B is 2, </li>\n<li>and update D,E, and F if the value of B if 3</li>\n</ul>\n\n<p>Without manually specifying it row by row in the code itself</p>\n\n<p>Example:</p>\n\n<p>-If i set value of B9 as 2, it populate the values of the cells D9 and E9</p>\n\n<p>-If i set value of B6 as 1, it populate the value of the cell D6</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Not Intersect(Target, Range(\"B5\")) Is Nothing Then\n    Select Case Target.Value\n        Case Is = 1\n            Range(\"D5\").Value = \"\u2022 Course Name:\" &amp; vbNewLine &amp; \"\u2022 No. Of Slides Affected:\" &amp; vbNewLine &amp; \"\u2022 No. of Activities Affected:\"\n        Case Is = 2\n            Range(\"D5\").Value = \"\u2022 Course Name:\" &amp; vbNewLine &amp; \"\u2022 No. Of Slides Affected:\" &amp; vbNewLine &amp; \"\u2022 No. of Activities Affected:\"\n            Range(\"E5\").Value = \"\u2022 Course Name:\" &amp; vbNewLine &amp; \"\u2022 No. Of Slides Affected:\" &amp; vbNewLine &amp; \"\u2022 No. of Activities Affected:\"\n        Case Is = 3\n            Range(\"D5\").Value = \"\u2022 Course Name:\" &amp; vbNewLine &amp; \"\u2022 No. Of Slides Affected:\" &amp; vbNewLine &amp; \"\u2022 No. of Activities Affected:\"\n            Range(\"E5\").Value = \"\u2022 Course Name:\" &amp; vbNewLine &amp; \"\u2022 No. Of Slides Affected:\" &amp; vbNewLine &amp; \"\u2022 No. of Activities Affected:\"\n            Range(\"F5\").Value = \"\u2022 Course Name:\" &amp; vbNewLine &amp; \"\u2022 No. Of Slides Affected:\" &amp; vbNewLine &amp; \"\u2022 No. of Activities Affected:\"\n        Case Else\n            Range(\"D5:F5\").Value = \"\"\n    End Select\nEnd If\nIf Not Intersect(Target, Range(\"B6\")) Is Nothing Then\n    Select Case Target.Value\n        Case Is = 1\n            Range(\"D6\").Value = \"\u2022 Course Name:\" &amp; vbNewLine &amp; \"\u2022 No. Of Slides Affected:\" &amp; vbNewLine &amp; \"\u2022 No. of Activities Affected:\"\n        Case Is = 2\n            Range(\"D6\").Value = \"\u2022 Course Name:\" &amp; vbNewLine &amp; \"\u2022 No. Of Slides Affected:\" &amp; vbNewLine &amp; \"\u2022 No. of Activities Affected:\"\n            Range(\"E6\").Value = \"\u2022 Course Name:\" &amp; vbNewLine &amp; \"\u2022 No. Of Slides Affected:\" &amp; vbNewLine &amp; \"\u2022 No. of Activities Affected:\"\n        Case Is = 3\n            Range(\"D6\").Value = \"\u2022 Course Name:\" &amp; vbNewLine &amp; \"\u2022 No. Of Slides Affected:\" &amp; vbNewLine &amp; \"\u2022 No. of Activities Affected:\"\n            Range(\"E6\").Value = \"\u2022 Course Name:\" &amp; vbNewLine &amp; \"\u2022 No. Of Slides Affected:\" &amp; vbNewLine &amp; \"\u2022 No. of Activities Affected:\"\n            Range(\"F6\").Value = \"\u2022 Course Name:\" &amp; vbNewLine &amp; \"\u2022 No. Of Slides Affected:\" &amp; vbNewLine &amp; \"\u2022 No. of Activities Affected:\"\n        Case Else\n            Range(\"D6:F6\").Value = \"\"\n    End Select\nEnd If\nIf Not Intersect(Target, Range(\"B7\")) Is Nothing Then\n    Select Case Target.Value\n        Case Is = 1\n            Range(\"D7\").Value = \"\u2022 Course Name:\" &amp; vbNewLine &amp; \"\u2022 No. Of Slides Affected:\" &amp; vbNewLine &amp; \"\u2022 No. of Activities Affected:\"\n        Case Is = 2\n            Range(\"D7\").Value = \"\u2022 Course Name:\" &amp; vbNewLine &amp; \"\u2022 No. Of Slides Affected:\" &amp; vbNewLine &amp; \"\u2022 No. of Activities Affected:\"\n            Range(\"E7\").Value = \"\u2022 Course Name:\" &amp; vbNewLine &amp; \"\u2022 No. Of Slides Affected:\" &amp; vbNewLine &amp; \"\u2022 No. of Activities Affected:\"\n        Case Is = 3\n            Range(\"D7\").Value = \"\u2022 Course Name:\" &amp; vbNewLine &amp; \"\u2022 No. Of Slides Affected:\" &amp; vbNewLine &amp; \"\u2022 No. of Activities Affected:\"\n            Range(\"E7\").Value = \"\u2022 Course Name:\" &amp; vbNewLine &amp; \"\u2022 No. Of Slides Affected:\" &amp; vbNewLine &amp; \"\u2022 No. of Activities Affected:\"\n            Range(\"F7\").Value = \"\u2022 Course Name:\" &amp; vbNewLine &amp; \"\u2022 No. Of Slides Affected:\" &amp; vbNewLine &amp; \"\u2022 No. of Activities Affected:\"\n        Case Else\n            Range(\"D7:F7\").Value = \"\"\n    End Select\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1574204501, "post_id": 58944129, "comment_id": 104146761, "body": "<code>iCell.Value Like &quot;*&quot; &amp; myValue &amp; &quot;*&quot;</code>"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1574204564, "post_id": 58944129, "comment_id": 104146780, "body": "<code>If InStr( iCell.Value, myValue) &gt; 0 Then</code>"}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1574204618, "post_id": 58944129, "comment_id": 104146793, "body": "<code>InStr</code> has better performance.."}, {"owner": {"reputation": 1, "user_id": 12393128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edd5b9bb017cbd308b02455cc3c5a716?s=128&d=identicon&r=PG&f=1", "display_name": "PianPian", "link": "https://stackoverflow.com/users/12393128/pianpian"}, "edited": false, "score": 0, "creation_date": 1574204929, "post_id": 58944129, "comment_id": 104146900, "body": "Outstanding! Thanks everyone. Worked like a charm."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1574205427, "post_id": 58944129, "comment_id": 104147041, "body": "The first example <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.findnext\" rel=\"nofollow noreferrer\">here</a> is pretty much what you are looking for and saves you looping through all cells in your range"}], "answers": [{"tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 0, "last_activity_date": 1574237401, "creation_date": 1574237401, "answer_id": 58949498, "question_id": 58944129, "link": "https://stackoverflow.com/questions/58944129/isolating-partial-string-and-deleting-any-cell-containing-it/58949498#58949498", "title": "Isolating partial string and deleting any cell containing it", "body": "<p>You won't need any looping, just use a wildcard in a <code>Range.Replace</code>:</p>\n\n<pre><code>Sub FindandDeleteLessThan\n    Dim myRange As Range: Set myRange = ThisWorkbook.Worksheets(\"sheet1\").Range(\"A1:K48\")\n    myRange.Replace \"*&lt;*\", \"\"\nEnd sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12393128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edd5b9bb017cbd308b02455cc3c5a716?s=128&d=identicon&r=PG&f=1", "display_name": "PianPian", "link": "https://stackoverflow.com/users/12393128/pianpian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574237401, "creation_date": 1574204255, "question_id": 58944129, "link": "https://stackoverflow.com/questions/58944129/isolating-partial-string-and-deleting-any-cell-containing-it", "title": "Isolating partial string and deleting any cell containing it", "body": "<p>Excuse my question, I know it pedestrian, however I have very little experience with VBA.</p>\n\n<p>I am looking to isolate the \"Less than\" character within a series of spreadsheets, and then delete those cells while leaving the row intact. I can't seem to find a solution, albeit Im sure it's a simple one.</p>\n\n<p>I have tried the following, </p>\n\n<pre><code>Sub FindandDeleteLessThan\nDim myRange As Range\n        Dim iCell As Range\n        Dim myValue As String\n        Set myRange = ThisWorkbook.Worksheets(\"sheet1\").Range(\"A1:K48\")\n        myValue = \"&lt;\"\n        For Each iCell In myRange\n          If iCell.Value = myValue Then iCell.Clear\n       Next iCell\nend sub\n</code></pre>\n\n<p>However it seems that because the cells that contain the character also contain other values my loop wont identify them. </p>\n\n<p>Any help would be greatly appreciated. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1574200466, "post_id": 58943291, "comment_id": 104145292, "body": "There&#39;s not enough code here for anyone to be able to make an informed guess about your problem.  What happens in <code>closeworkbook</code> for example?"}, {"owner": {"reputation": 1, "user_id": 12392492, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ztMw8p6oPTM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc-v2e_LUr2MQSrmRw5JXQ0T7c4zg/photo.jpg?sz=128", "display_name": "IMI", "link": "https://stackoverflow.com/users/12392492/imi"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1574239948, "post_id": 58943291, "comment_id": 104156803, "body": "@TimWilliams I&#39;ve updated the body of the code to show you the whole squence I thought relevant."}, {"owner": {"reputation": 1, "user_id": 12392492, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ztMw8p6oPTM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc-v2e_LUr2MQSrmRw5JXQ0T7c4zg/photo.jpg?sz=128", "display_name": "IMI", "link": "https://stackoverflow.com/users/12392492/imi"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1574249175, "post_id": 58943291, "comment_id": 104162305, "body": "@TimWilliams - Further updates now, cearly depicting each bulk of code"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1574311282, "post_id": 58943291, "comment_id": 104189402, "body": "I don&#39;t see any obvious issues there.  What code runs when <code>LoginForm</code> runs?  Do you have code in the userform activate event?"}, {"owner": {"reputation": 1, "user_id": 12392492, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ztMw8p6oPTM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc-v2e_LUr2MQSrmRw5JXQ0T7c4zg/photo.jpg?sz=128", "display_name": "IMI", "link": "https://stackoverflow.com/users/12392492/imi"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1574326576, "post_id": 58943291, "comment_id": 104195441, "body": "@TimWilliams, I got the soruce file in the end and there are lines of code missing from the tutorial on the youtube video. However, even are replacing these and then finally replacing the whole code, paste and copy style, the sheet still didn&#39;t work properly  I think i&#39;m left with no choice but to transfer my sheets to another workbook!   I spoke to the creator of the book and he told me it may be a programme issue involving control source, and instread to write it in code.   On this occasion I have decided to use the free source file. I still thank you very much for your help on this."}], "owner": {"reputation": 1, "user_id": 12392492, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ztMw8p6oPTM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc-v2e_LUr2MQSrmRw5JXQ0T7c4zg/photo.jpg?sz=128", "display_name": "IMI", "link": "https://stackoverflow.com/users/12392492/imi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574249130, "creation_date": 1574199959, "last_edit_date": 1574249130, "question_id": 58943291, "link": "https://stackoverflow.com/questions/58943291/path-file-access-error-for-loginform-show", "title": "Path/File Access error for LoginForm.show", "body": "<p>I am trying to create a login form for my workbook, I was all finished on the code side of things.</p>\n\n<p>I am getting a massive problem after enabling the code, it runs fine until the book is closed, upon re-opening the book I get a Path/File Access error, also it deletes all contents of the form, text boxes, labels, and togglebutton. It then states a mistmatch error on code tested fine before closing the book.</p>\n\n<p>I've narrowed it down to the code highlighted, specifically the <code>LoginForm.show</code>.</p>\n\n<p>Can someone suggest any actions at all?</p>\n\n<p><strong><em>Sheet9 (ListSheets)</em></strong></p>\n\n<pre><code>Option Explicit\n\n\n\nPrivate Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\nIf Not Intersect(Target, Range(\"k4:r8\")) Is Nothing Then\n\n\n    If Target.Value = \"\u00d0\" Then\n    Target.Value = \"\u00cf\"\n    Exit Sub\n    End If\n     If Target.Value = \"x\" Then Target.Value = \"\u00d0\"\n    If Target.Value = \"\u00cf\" Then Target.Value = \"x\"\n    If Target.Value = Empty Then Target.Value = \"\u00d0\"\nEnd If\n\nIf Not Intersect(Target, Range(\"J4:J8\")) Is Nothing Then\nIf Target.Value = \"\u00d0\" Then\n    Range(\"J\" &amp; Target.Row &amp; \":r\" &amp; Target.Row).Value = \"\u00cf\"\n    Exit Sub\n    End If\n     If Target.Value = \"x\" Then Range(\"J\" &amp; Target.Row &amp; \":r\" &amp; Target.Row).Value = \"\u00d0\"\n    If Target.Value = \"\u00cf\" Then Range(\"J\" &amp; Target.Row &amp; \":r\" &amp; Target.Row).Value = \"x\"\n    If Target.Value = Empty Then Range(\"J\" &amp; Target.Row &amp; \":r\" &amp; Target.Row).Value = \"\u00d0\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p><strong><em>This Workbook</em></strong></p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Workbook_BeforeClose(Cancel As Boolean)\ncloseworkbook\nEnd Sub\n\nPrivate Sub Workbook_Open()\nLoginForm.Show\nEnd Sub\n</code></pre>\n\n<p><strong><em>Assorted Macros</em></strong></p>\n\n<pre><code>Option Explicit\n\nSub CheckUser()\nDim UserRow, SheetCol As Long\nDim SheetNm As String\nWith Sheet9\n.Calculate\n\nIf .Range(\"B7\").Value = Empty Then 'Incorrect Username\n    MsgBox \"Please Enter a correct user name\"\n    Exit Sub\nEnd If\n\nIf .Range(\"B6\").Value &lt;&gt; True Then 'Incorrect password\n    MsgBox \"Please Enter a correct password\"\n    Exit Sub\nEnd If\n\nLoginForm.Hide\n.Range(\"B4,B5\").ClearContents\nUserRow = .Range(\"B7\").Value 'User Row\n\nFor SheetCol = 11 To 18\nSheetNm = .Cells(3, SheetCol).Value 'Sheet Name\nIf .Cells(UserRow, SheetCol).Value = \"\u00d0\" Then\n    Sheets(SheetNm).Unprotect \"123\"\n    Sheets(SheetNm).Visible = xlSheetVisible\nEnd If\n\nIf .Cells(UserRow, SheetCol).Value = \"\u00cf\" Then\n    Sheets(SheetNm).Protect \"123\"\n    Sheets(SheetNm).Visible = xlSheetVisible\nEnd If\n\nIf .Cells(UserRow, SheetCol).Value = \"x\" Then Sheets(SheetNm).Visible = xlVeryHidden\nNext SheetCol\nEnd With\nEnd Sub\n\nSub closeworkbook()\nSheet8.Activate\nDim wksht As Worksheet\nFor Each wksht In ThisWorkbook.Worksheets\nIf wksht.Name &lt;&gt; \"Login\" Then wksht.Visible = xlSheetVeryHidden\nNext wksht\nThisWorkbook.Save\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1110, "user_id": 5572384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2BvJ.jpg?s=128&g=1", "display_name": "StoneGiant", "link": "https://stackoverflow.com/users/5572384/stonegiant"}, "edited": false, "score": 0, "creation_date": 1574205876, "post_id": 58943109, "comment_id": 104147152, "body": "Stackoverflow is not a code-writing service. Make an attempt. Post your results if you can&#39;t figure it out."}], "answers": [{"tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": false, "score": 2, "last_activity_date": 1574199404, "creation_date": 1574199404, "answer_id": 58943173, "question_id": 58943109, "link": "https://stackoverflow.com/questions/58943109/replace-the-first-space-in-a-column-with-a-delimiting-character/58943173#58943173", "title": "Replace the first space in a column with a delimiting character", "body": "<p>You can do this with a formula: </p>\n\n<pre><code>=LEFT(A1, FIND(\" \", A1, 1)-1) &amp; \"~\" &amp; RIGHT(A1,LEN(A1) - FIND(\" \", A1, 1))\n</code></pre>\n\n<p>Copy that down. Copy/PasteSpecial Values. Then text-to-column that result</p>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1574200571, "last_edit_date": 1574200571, "creation_date": 1574200112, "answer_id": 58943334, "question_id": 58943109, "link": "https://stackoverflow.com/questions/58943109/replace-the-first-space-in-a-column-with-a-delimiting-character/58943334#58943334", "title": "Replace the first space in a column with a delimiting character", "body": "<p>With VBA, the following approach is possible:</p>\n\n<ul>\n<li>Locate the first empty string position and write it to a variable</li>\n<li>Take the left part of the string to the position and append the replacement string</li>\n<li>Take the right part of the string from the position to the end and append the rest</li>\n</ul>\n\n<p>This is the function:</p>\n\n<pre><code>Public Function ReplaceFirstSpace(myInput As String, _\n                Optional replacement As String = \"~\") As String\n\n    Dim position As Long\n    position = InStr(1, myInput, \" \")\n\n    If position = 0 Then\n        ReplaceFirstSpace = myInput\n    Else\n        ReplaceFirstSpace = Left(myInput, position - 1) &amp; _\n                            replacement &amp; Right(myInput, Len(myInput) - position)\n\n    End If\n\nEnd Function\n</code></pre>\n\n<p>And some tests:</p>\n\n<pre><code>Sub TestMe()    \n    Debug.Print ReplaceFirstSpace(\"my name is\")\n    Debug.Print ReplaceFirstSpace(\"slim shaddy\")\n    Debug.Print ReplaceFirstSpace(\"tikitiki\")\n    Debug.Print ReplaceFirstSpace(\" taram\")\n    Debug.Print ReplaceFirstSpace(\"tam \")\n    Debug.Print ReplaceFirstSpace(\"\")    \nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1574202919, "creation_date": 1574202919, "answer_id": 58943869, "question_id": 58943109, "link": "https://stackoverflow.com/questions/58943109/replace-the-first-space-in-a-column-with-a-delimiting-character/58943869#58943869", "title": "Replace the first space in a column with a delimiting character", "body": "<p>Use REPLACE:</p>\n\n<pre><code>=REPLACE(A1,FIND(\" \",A1),1,\"~\")\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 12400259, "user_type": "registered", "profile_image": "https://graph.facebook.com/10219421910612373/picture?type=large", "display_name": "Seth Fluder", "link": "https://stackoverflow.com/users/12400259/seth-fluder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1574202919, "creation_date": 1574199054, "last_edit_date": 1574200384, "question_id": 58943109, "link": "https://stackoverflow.com/questions/58943109/replace-the-first-space-in-a-column-with-a-delimiting-character", "title": "Replace the first space in a column with a delimiting character", "body": "<p>I have a report that includes a bunch of text in one cell.  The first part of the text is a product# but the length varies.  The product number is separated from the other information by a space.  </p>\n\n<p>I'm looking to write a macro that will replace just the first space with a delimiting character. I usually use \"~\". This will then allow me to script a text-to-columns command that will isolate the product number in one column.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1574197713, "post_id": 58942768, "comment_id": 104144086, "body": "You aren&#39;t copying your <code>area</code> under variable <code>a</code> you are doing <code>Selection.Copy</code>. And <code>Selection</code> is basically <code>range(FilterRange, FilterRange.End(xlToRight))</code>. Why loop through <code>areas</code> of <code>FilterRange</code> and then copy a <code>Selection</code> made from <code>FilterRange</code>?"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1574197722, "post_id": 58942768, "comment_id": 104144087, "body": "Might as will show sample data and result so we can see how your data is laid out?"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1574197992, "post_id": 58942768, "comment_id": 104144187, "body": "You may find <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">this to be useful</a>"}, {"owner": {"reputation": 31, "user_id": 12293980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f86d0f25368a909d7ad43a85767461a?s=128&d=identicon&r=PG&f=1", "display_name": "atschoe", "link": "https://stackoverflow.com/users/12293980/atschoe"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1574200116, "post_id": 58942768, "comment_id": 104145118, "body": "@JNevill I cannot thank you enough for asking me this question! I thought it out and tried some things, and ended up fixing the problem. I will post the answer below."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1574200160, "post_id": 58942768, "comment_id": 104145140, "body": "That&#39;s great news! I was going to take a shot at what I thought you might be going for, but I wasn&#39;t certain enough and thought I would just add to the confusion."}, {"owner": {"reputation": 31, "user_id": 12293980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f86d0f25368a909d7ad43a85767461a?s=128&d=identicon&r=PG&f=1", "display_name": "atschoe", "link": "https://stackoverflow.com/users/12293980/atschoe"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1574200619, "post_id": 58942768, "comment_id": 104145369, "body": "@JNevill Answer has been added to comments. Seriously, thank you so SO much. I&#39;m new to VBA and have been working on this problem for a few days now, I really didn&#39;t think I&#39;d ever find a solution. You&#39;ve been a great help!"}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 12293980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f86d0f25368a909d7ad43a85767461a?s=128&d=identicon&r=PG&f=1", "display_name": "atschoe", "link": "https://stackoverflow.com/users/12293980/atschoe"}, "is_accepted": false, "score": 0, "last_activity_date": 1574200432, "creation_date": 1574200432, "answer_id": 58943393, "question_id": 58942768, "link": "https://stackoverflow.com/questions/58942768/properly-looping-through-non-contiguous-ranges/58943393#58943393", "title": "Properly looping through non-contiguous ranges?", "body": "<pre><code>For Each a In filterRange.Areas\n\n    Sheets(newSheetName).Select\n    range(a, a.End(xlToRight)).Copy\n\n    With a\n    If filterRange Is Nothing Then\n       MsgBox (\"Value not present in this workbook.\")\n    Else\n        With Sheets.Add(After:=Sheets(Sheets.Count))\n             .Name = a.Cells(1, 1).Value\n             .range(\"A1\").Value = a.Offset(, 1)\n             range(\"A50\").Select\n             ActiveSheet.paste\n        End With\n             range(\"A10:A49\").Select\n             range(Selection, Selection.End(xlToRight)).Select\n             Selection.Delete\n             range(\"A1\").Select\n    End If\n    End With\nNext a\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 12293980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f86d0f25368a909d7ad43a85767461a?s=128&d=identicon&r=PG&f=1", "display_name": "atschoe", "link": "https://stackoverflow.com/users/12293980/atschoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574220933, "creation_date": 1574197485, "last_edit_date": 1574220933, "question_id": 58942768, "link": "https://stackoverflow.com/questions/58942768/properly-looping-through-non-contiguous-ranges", "title": "Properly looping through non-contiguous ranges?", "body": "<p>I have a few non-contiguous ranges that may vary in size each time it is run. I would like to take each of the ranges and copy and paste them onto their own individual worksheets (one range per sheet).</p>\n\n<p>My code currently works for the first range and sheet. After the second sheet is created, the ranges are highlighted, but the first range is again copied and pasted onto the second sheet, instead of the corresponding second range. Then, the third sheet is created, but again, only the first range is copied and pasted onto this sheet. I know something is wrong with my looping, but I can't figure out where.</p>\n\n<p>I have exhausted all of my resources. I just can't figure out why the loop isn't getting to the other 2 ranges.</p>\n\n<pre><code>'Get current sheet name\nDim activeSheetName As String\nactiveSheetName = ActiveSheet.Name\n\n'Create a new sheet to reformat existing data\nDim newSheetName As String\nnewSheetName = (activeSheetName + \"_Data\")\n\nDim filterRange As range\nDim areasCount As Integer\nFor Each a In filterRange.Areas\n    Sheets(newSheetName).Select\n    filterRange.Select\n    range(Selection, Selection.End(xlToRight)).Select\n    areasCount = Selection.Areas.Count\n    With a\n        For i = 2 To areasCount + 1\n            Selection.Copy\n            With Sheets.Add(After:=Sheets(Sheets.Count))\n                .Name = a.Cells(1, 1).Value\n                .range(\"A1\").Value = a.Offset(, 1)\n                range(\"A50\").Select\n                Selection.PasteSpecial paste:=xlPasteAll, Operation:=xlNone, _\n                    SkipBlanks:= False, Transpose:=False\n                Application.CutCopyMode = False\n            End With\n        Next i\n    End With\nNext a\n</code></pre>\n\n<p>I have tried to incorporate the following code I found in a book, but no such luck.</p>\n\n<pre><code>Dim SelAreas() As range\nDim pasteRange As range\nDim upperLeft As range\nDim numAreas As Long, i As Long\nDim topRow As Long, leftCol As Long\nDim rowOffset As Long, colOffset As Long\n\nIf TypeName(Selection) &lt;&gt; \"Range\" Then Exit Function\n\nnumAreas = Selection.Areas.Count\nReDim SelAreas(1 To numAreas)\n\nFor i = 1 To numAreas\n    Set SelAreas(i) = Selection.Areas(i)\nNext\n\ntopRow = ActiveSheet.Rows.Count\nleftCol = ActiveSheet.Columns.Count\n\nFor i = 1 To numAreas\n    If SelAreas(i).Row &lt; topRow Then topRow = SelAreas(i).Row\n    If SelAreas(i).Column &lt; leftCol Then leftCol = SelAreas(i).Column\nNext\n\nSet upperLeft = Cells(topRow, leftCol)\n\nOn Error Resume Next\nSet pasteRange = range(\"A50\")\nOn Error GoTo 0\n\nIf TypeName(pasteRange) &lt;&gt; \"Range\" Then Exit Function\n\nSet pasteRange = pasteRange.range(\"A1\")\n\nFor i = 1 To numAreas\n    rowOffset = SelAreas(i).Row - topRow\n    colOffset = SelAreas(i).Column - leftCol\n    SelAreas(i).Copy\n    range(\"A1\").Value = pasteRange.Offset(rowOffset, colOffset)\nNext i\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574198787, "post_id": 58943037, "comment_id": 104144506, "body": "Wouldn&#39;t you go the other way - loop through the range and try to find each cell value within the array? <b>EDIT:</b> Well I guess based on the OP&#39;s description of no duplicates in the range, this would work."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574199141, "post_id": 58943037, "comment_id": 104144675, "body": "1. It sounds like the range is bigger than the array, so looping the smaller of the two will be more efficient. 2. There is no <code>Array.Find()</code> method so one would have to loop the array upon each cell in the range which would be double taxing. | This has 5 iterations, the other method would have 200."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574199427, "post_id": 58943037, "comment_id": 104144804, "body": "Right. I was considering the possibility of duplicates in the range, at which point only one <code>Find</code> call per member of the array wouldn&#39;t work. But you could call <code>Match</code> on the array right, to avoid looping the array in the other method?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574199501, "post_id": 58943037, "comment_id": 104144837, "body": "Oh I see! Yes that makes sense. That would make it quite a bit uglier."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574199539, "post_id": 58943037, "comment_id": 104144868, "body": "Right - so your answer is appropriate given the OP&#39;s specifications."}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 1, "last_activity_date": 1574198683, "creation_date": 1574198683, "answer_id": 58943037, "question_id": 58942702, "link": "https://stackoverflow.com/questions/58942702/how-to-highlight-cells-in-an-arbitary-selection-which-match-to-a-value-in-an-arr/58943037#58943037", "title": "How to highlight cells in an arbitary selection which match to a value in an array?", "body": "<p>Here's one way to accomplish this. This is assuming you've selected/highlighted the range that has the values you are going to match. This just sets the color of the cell to an ugly gray. </p>\n\n<pre><code>Sub highlightfromarray()\n    S = Array(1, 5, 10, 23, 38)\n\n    'Capture user range selection to a variable\n    Dim userRange As Range\n    Set userRange = Selection\n\n    'VAriable for found range\n    Dim foundRange As Range\n\n    'Loop through array\n    For Each numItem In S\n        'Using Range.Find() method, find each item and highlight\n        Set foundRange = userRange.Find(numItem)\n        If Not foundRange Is Nothing Then foundRange.Interior.ColorIndex = 15\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12400129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/864fbaa071f7829fa2296d93e9f83450?s=128&d=identicon&r=PG&f=1", "display_name": "Sally", "link": "https://stackoverflow.com/users/12400129/sally"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 58943037, "answer_count": 1, "score": 0, "last_activity_date": 1574199021, "creation_date": 1574197190, "last_edit_date": 1574199021, "question_id": 58942702, "link": "https://stackoverflow.com/questions/58942702/how-to-highlight-cells-in-an-arbitary-selection-which-match-to-a-value-in-an-arr", "title": "How to highlight cells in an arbitary selection which match to a value in an array?", "body": "<p>So for example, say my array is [32,43,92,99] (\"hard coded\" into the VBA code, don't need to worry about any inputs) and then in an excel sheet I highlight some rectangular grid of cells numbered 1-100. Would it be possible to cycle through the array and highlight the corresponding cells with those values in the sheet? In this case highlighting the cells reading 32, 43, 92, 99.</p>\n\n<pre><code>Sub readClipboard()\n  Dim DataObj As New MSForms.DataObject\n  Dim S As String\n  DataObj.GetFromClipboard\n  S = DataObj.GetText\n  S = Application.Clean(S)\n  S = Application.Trim(S)\n  S = Split(S)\nEnd Sub\n\n</code></pre>\n\n<p>So I'd want to then match up this array S with a selection, then highlight the cells which have values that match to values in the array.</p>\n"}, {"tags": ["excel", "vba", "office365", "saprfc"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1574197291, "post_id": 58942674, "comment_id": 104143893, "body": "Can you do <code>Set Functions = New SAPFunctionsOCX.SAPFunctions</code> instead of using <code>CreateObject()</code> two lines above the error. It seems like a strange mix of early and late binding in the same codebase. I don&#39;t know if it will help, but it might..."}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1574199332, "post_id": 58942674, "comment_id": 104144761, "body": "<code>Set Functions = New SAPFunctionsOCX.SAPFunctions</code> doesn&#39;t rectify...same error on same line."}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1574200355, "post_id": 58942674, "comment_id": 104145243, "body": "a few more differences...stdole2.tlb (OLE automation reference) is stored in the sysWOW64 folder on the on-prem system and in the System32 folder on the 365 system."}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1574200455, "post_id": 58942674, "comment_id": 104145286, "body": "the on-prem system stores the Office-related references (Office object library, Excel object library, and VBA in the Program Files (x86) folder...the 365 system stores them in the Program Files folder (no x86)."}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1574863846, "post_id": 58942674, "comment_id": 104381976, "body": "@JNevill Just following up on this...zero progress has been made and I could really use a good lead. Thanks!"}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1574866831, "post_id": 58942674, "comment_id": 104383793, "body": "I&#39;ve never written my own DLL, but it look&#39;s like this is what is going to be required ... <a href=\"http://mikejuniperhill.blogspot.com/2017/06/excelvba-multi-threading-example.html\" rel=\"nofollow noreferrer\">mikejuniperhill.blogspot.com/2017/06/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 1, "creation_date": 1610037528, "post_id": 65460025, "comment_id": 116011963, "body": "Yes, after I posted this I learned that 7.70 will rectify this...I am patiently waiting for the end of the month (<a href=\"https://blogs.sap.com/2020/05/06/sap-gui-for-windows-7.70-beta-program-call-for-participation/\" rel=\"nofollow noreferrer\">blogs.sap.com/2020/05/06/&hellip;</a>)"}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1610037601, "post_id": 65460025, "comment_id": 116011998, "body": "I only have one user that this impacts at this point...IT has decided to wait to move her to 365 (64-bit) until we can get 7.70 installed on her system."}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1610037766, "post_id": 65460025, "comment_id": 116012087, "body": "Your answer is the correct one...if you have an IT department that is willing to make changes to the registry as a workaround. Mine isn&#39;t. Others might not have that problem, so I&#39;ll mark yours as the accepted answer."}], "tags": [], "owner": {"reputation": 8896, "user_id": 9150270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07e89ef7ec2f93f949e76081bd9d1749?s=128&d=identicon&r=PG&f=1", "display_name": "Sandra Rossi", "link": "https://stackoverflow.com/users/9150270/sandra-rossi"}, "is_accepted": true, "score": 1, "last_activity_date": 1609011514, "creation_date": 1609011514, "answer_id": 65460025, "question_id": 58942674, "link": "https://stackoverflow.com/questions/58942674/vba-program-executing-sap-rfcs-works-in-excel-2016-on-prem-but-not-in-office-36/65460025#65460025", "title": "VBA program executing SAP RFCs works in Excel 2016 on-prem, but not in Office 365 (Run-time error 20080008...Bad Variant Type)", "body": "<p>It's due to the fact that your Office is in 64 bits version, and SAP GUI for Windows up to version 7.60 is in 32 bits (next SAP GUI version 7.70 should be in 64 bits, so it should work again).</p>\n<p>You have a workaround to make VBA work with SAP GUI 32-bits DLL, by using <a href=\"http://msdn.microsoft.com/en-us/library/ms691260%28v=vs.85%29.aspx\" rel=\"nofollow noreferrer\">DLL Surrogate</a>, i.e. by editing the Windows Registry of all incompatible SAP GUI DLL. The original solution <a href=\"https://answers.sap.com/questions/10687512/connect-excel-2010-64-bits-with-sap.html?childToView=10701970#comment-10701970\" rel=\"nofollow noreferrer\">was proposed here at SAP Community</a>.</p>\n<p>To simplify the task, you may create <a href=\"https://answers.sap.com/comments/13152790/view.html\" rel=\"nofollow noreferrer\">my .REG file</a>, execute it to update automatically the Windows Registry, and your VBA macro should then work.</p>\n<p>I duplicate here my .REG file:</p>\n<pre><code>; ====================================================================================\n; SAP Logon Unicode Control %ProgramFiles(x86)%\\SAP\\FrontEnd\\SAPgui\\wdtlogU.ocx {0AAF5A11-8C04-4385-A925-0B62F6632BEC}\n; ====================================================================================\n\n[HKEY_CLASSES_ROOT\\WOW6432Node\\AppID\\{0AAF5A11-8C04-4385-A925-0B62F6632BEC}]\n&quot;DllSurrogate&quot;=&quot;&quot;\n\n[HKEY_CLASSES_ROOT\\WOW6432Node\\CLSID\\{0AAF5A11-8C04-4385-A925-0B62F6632BEC}]\n&quot;AppID&quot;=&quot;{0AAF5A11-8C04-4385-A925-0B62F6632BEC}&quot;\n\n[HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\AppID\\{0AAF5A11-8C04-4385-A925-0B62F6632BEC}]\n\n; ====================================================================================\n; SAP Remote Function Call Unicode Control %ProgramFiles(x86)%\\SAP\\FrontEnd\\SAPgui\\wdtfuncu.ocx {0AF427E7-03B9-4673-8F21-F33A683BCE28}\n; ====================================================================================\n\n[HKEY_CLASSES_ROOT\\WOW6432Node\\AppID\\{0AF427E7-03B9-4673-8F21-F33A683BCE28}]\n&quot;DllSurrogate&quot;=&quot;&quot;\n\n[HKEY_CLASSES_ROOT\\WOW6432Node\\CLSID\\{0AF427E7-03B9-4673-8F21-F33A683BCE28}]\n&quot;AppID&quot;=&quot;{0AF427E7-03B9-4673-8F21-F33A683BCE28}&quot;\n\n[HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\AppID\\{0AF427E7-03B9-4673-8F21-F33A683BCE28}]\n\n; ====================================================================================\n; SAP Logon Control (not Unicode) %ProgramFiles(x86)%\\SAP\\FrontEnd\\SAPgui\\wdtlog.ocx {B24944D6-1501-11CF-8981-0000E8A49FA0}\n; ====================================================================================\n\n[HKEY_CLASSES_ROOT\\WOW6432Node\\AppID\\{B24944D6-1501-11CF-8981-0000E8A49FA0}]\n&quot;DllSurrogate&quot;=&quot;&quot;\n\n[HKEY_CLASSES_ROOT\\WOW6432Node\\CLSID\\{B24944D6-1501-11CF-8981-0000E8A49FA0}]\n&quot;AppID&quot;=&quot;{B24944D6-1501-11CF-8981-0000E8A49FA0}&quot;\n\n[HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\AppID\\{B24944D6-1501-11CF-8981-0000E8A49FA0}]\n\n; ====================================================================================\n; SAP Remote Function Call Control (not Unicode) %ProgramFiles(x86)%\\SAP\\FrontEnd\\SAPgui\\wdtfuncs.ocx {5B076C03-2F26-11CF-9AE5-0800096E19F4}\n; ====================================================================================\n\n[HKEY_CLASSES_ROOT\\WOW6432Node\\AppID\\{5B076C03-2F26-11CF-9AE5-0800096E19F4}]\n&quot;DllSurrogate&quot;=&quot;&quot;\n\n[HKEY_CLASSES_ROOT\\WOW6432Node\\CLSID\\{5B076C03-2F26-11CF-9AE5-0800096E19F4}]\n&quot;AppID&quot;=&quot;{5B076C03-2F26-11CF-9AE5-0800096E19F4}&quot;\n\n[HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\AppID\\{5B076C03-2F26-11CF-9AE5-0800096E19F4}]\n</code></pre>\n"}], "owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 652, "favorite_count": 0, "accepted_answer_id": 65460025, "answer_count": 1, "score": 0, "last_activity_date": 1609011514, "creation_date": 1574197012, "question_id": 58942674, "link": "https://stackoverflow.com/questions/58942674/vba-program-executing-sap-rfcs-works-in-excel-2016-on-prem-but-not-in-office-36", "title": "VBA program executing SAP RFCs works in Excel 2016 on-prem, but not in Office 365 (Run-time error 20080008...Bad Variant Type)", "body": "<p>Let me first say that I saw the other two threads that mentioned this issue <a href=\"https://stackoverflow.com/questions/56459823/sap-rfc-connection-with-vba-bad-variant-type\">here</a> and <a href=\"https://stackoverflow.com/questions/14454574/sap-rfc-connection-bad-variant-type\">here</a>, but they didn't help me solve my problem.</p>\n\n<p>I've been testing a program for several weeks in the on-prem Excel 2016 environment (32-bit) with no problems. My company is making the move to Office 365 soon, so I decided to test it over there as well. On that system, I'm getting a run-time error on the line <code>Functions.Connection = objConnection</code></p>\n\n<pre><code>Option Explicit\nPublic Functions As SAPFunctionsOCX.SAPFunctions\nPrivate LogonControl As SAPLogonCtrl.SAPLogonControl\nPrivate objConnection As SAPLogonCtrl.Connection\nPublic Func As SAPFunctionsOCX.Function\nPublic Commit As SAPFunctionsOCX.Function\nPublic TableFactory As SAPTableFactory\nPublic silentLogon As Boolean\nPublic tblReadTableOptions, tblReadTableFields, tblReadTableData As SAPTableFactoryCtrl.Table\n\nSub ExtractProjectData()\n    If objConnection Is Nothing Then LogonToSAP\n    InitiateSAPVariables\n    Set Func = Functions.Add(\"BBP_RFC_READ_TABLE\")\n    Set tblReadTableOptions = Func.Tables(\"OPTIONS\")\n    Set tblReadTableFields = Func.Tables(\"FIELDS\")\n    Set tblReadTableData = Func.Tables(\"DATA\")\n\n    'extract/transform data from SAP tables\n\nEnd Sub\n\nFunction InitiateSAPVariables()\n    Set Functions = Nothing\n    Set TableFactory = Nothing\n    Set Func = Nothing\n    Set Functions = CreateObject(\"SAP.Functions\")\n    Set TableFactory = CreateObject(\"SAP.TableFactory.1\")\n    Functions.Connection = objConnection 'run-time error here in Office 365 but not in on-prem\nEnd Function\n\nFunction LogonToSAP()\n    Dim establishConnection As Boolean\n    silentLogon = false\n    Set LogonControl = CreateObject(\"SAP.LogonControl.1\")\n    Set objConnection = LogonControl.NewConnection\n    objConnection.Client = \"###\"\n    objConnection.Language = \"EN\"\n    objConnection.SystemNumber = \"##\"\n    objConnection.User = \"\"\n    objConnection.Password = \"\"\n    objConnection.HostName = \"###############\"\n    objConnection.System = \"###\"\n    objConnection.ApplicationServer = \"###.###.#.##\"\n    establishConnection = objConnection.Logon(0, silentLogon)\nEnd Function\n</code></pre>\n\n<p>A quick check of objConnection tells me that logon was successful...so I know that part is working on 365. For some reason though, it doesn't like assigning the <code>Connection</code> property of the <code>Functions</code> SAPFunctionsOCX.SAPFunctions object in the 365 environment (please feel free to correct my verbiage on that...I know it's not quite right).</p>\n\n<p>Note that I'm not seeing any reference issues nor am I getting any compile errors in either environment. The first sign of trouble is on execution of <code>Functions.Connection = objConnection</code></p>\n\n<p>There's one more twist here and that is that I have another older VBA program that logs into SAP and runs remote function calls that doesn't use SAPFunctionsOCX.SAPFunctions, but rather declares variable R3 as <code>Public R3 As Object</code> and then sets R3 later in the logon code as <code>Set R3 = CreateObject(\"SAP.Functions\")</code>...it does not use OCX. In other words, the old routine uses late binding. When the Functions object (R3 in this case) is set this way, I am able to run RFCs in both on prem and Office 365 environments.</p>\n\n<pre><code>Function LogonProdSAP(Optional SuppressLoginScreen As Boolean)\n    Application.ScreenUpdating = False\n    '**********************************************\n    'Create Server object and Setup the connection for DEV\n    '**********************************************\n    Set R3 = CreateObject(\"SAP.Functions\")\n    If SuppressLoginScreen Then\n        R3.Connection.System = \"###\"\n        R3.Connection.HostName = \"###################\"\n        R3.Connection.SystemNumber = \"##\"\n        R3.Connection.Client = \"###\"\n        R3.Connection.User = \"##########\"\n        R3.Connection.Password = \"#########\"\n        R3.Connection.Language = \"EN\"\n'        Call Logger(\"LogonProdSAP&gt;  \" &amp; GetUserName)\n    End If\n    LogonProdSAP = R3.Connection.logon(0, SuppressLoginScreen)\n    If LogonProdSAP &lt;&gt; True Then MsgBox (\"Logon error\"): Exit Function\nEnd Function\n</code></pre>\n\n<p>I could just go back to doing it this way, but I'd rather not have to reconfigure all of the code I just set up. In addition, I prefer binding early so Intellitype works to show all properties/methods available to that object. I'm sure there are other benefits as well.</p>\n\n<p>What do I have to do to get the early-binding technique to work on Office 365?</p>\n"}, {"tags": ["sql-server", "vba", "tsql", "ms-access"], "comments": [{"owner": {"reputation": 59343, "user_id": 2029983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0118fb43d1ce086d768e295339cf0ff4?s=128&d=identicon&r=PG", "display_name": "Larnu", "link": "https://stackoverflow.com/users/2029983/larnu"}, "edited": false, "score": 1, "creation_date": 1574196774, "post_id": 58942479, "comment_id": 104143657, "body": "Why do that as 19 <code>UPDATE</code> statements, when  you could do it as 1?"}, {"owner": {"reputation": 684, "user_id": 5017647, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/af8091d51c64e0558d5b600a3cbde430?s=128&d=identicon&r=PG&f=1", "display_name": "Whiteclaws", "link": "https://stackoverflow.com/users/5017647/whiteclaws"}, "reply_to_user": {"reputation": 59343, "user_id": 2029983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0118fb43d1ce086d768e295339cf0ff4?s=128&d=identicon&r=PG", "display_name": "Larnu", "link": "https://stackoverflow.com/users/2029983/larnu"}, "edited": false, "score": 0, "creation_date": 1574196917, "post_id": 58942479, "comment_id": 104143727, "body": "@Larnu well this is not a good example, but those statements are automatically generated, and might update fields that are not in that table... The idea was to batch those statements instead of updating 200 times on VBA which would be excruciatingly slow."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 1, "creation_date": 1574198351, "post_id": 58942479, "comment_id": 104144341, "body": "with Currentdb.Execute you need to include the DBFailOnError clause"}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 1, "creation_date": 1574202033, "post_id": 58942479, "comment_id": 104145937, "body": "Post your actual execution code."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1574203174, "post_id": 58942479, "comment_id": 104146349, "body": "Are you aware of <a href=\"https://stackoverflow.com/questions/58832269/getting-error-3340-query-is-corrupt-while-executing-queries-docmd-runsql\" title=\"getting error 3340 query is corrupt while executing queries docmd runsql\">stackoverflow.com/questions/58832269/&hellip;</a> ? (Not sure this is a duplicate too.)"}, {"owner": {"reputation": 684, "user_id": 5017647, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/af8091d51c64e0558d5b600a3cbde430?s=128&d=identicon&r=PG&f=1", "display_name": "Whiteclaws", "link": "https://stackoverflow.com/users/5017647/whiteclaws"}, "reply_to_user": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1574226389, "post_id": 58942479, "comment_id": 104151664, "body": "@krish KM <code>currentDb.Execute SQLQuery</code> is all there is. And SQLQuery is essentially what was given at the top."}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 1, "creation_date": 1574259969, "post_id": 58942479, "comment_id": 104168814, "body": "@Whiteclaws reason why we ask to see your code is if you have any other stupid code somewhere that is preventing you from seeing errors i.e. <code>on error resume next</code> :)"}, {"owner": {"reputation": 1056, "user_id": 656585, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f0cd436cd48026cc2ed582f4133a0f64?s=128&d=identicon&r=PG", "display_name": "Christoph J&#252;ngling", "link": "https://stackoverflow.com/users/656585/christoph-j%c3%bcngling"}, "edited": false, "score": 0, "creation_date": 1574344460, "post_id": 58942479, "comment_id": 104206220, "body": "As far as I remember, DoCmd.RunSQL and CurrentDb.Execute only can handle one SQL statement at a time."}], "answers": [{"comments": [{"owner": {"reputation": 684, "user_id": 5017647, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/af8091d51c64e0558d5b600a3cbde430?s=128&d=identicon&r=PG&f=1", "display_name": "Whiteclaws", "link": "https://stackoverflow.com/users/5017647/whiteclaws"}, "edited": false, "score": 0, "creation_date": 1574350398, "post_id": 58962965, "comment_id": 104210011, "body": "Really? You can&#39;t batch SQL statements in Access SQL? Another reason to hate Access, I guess :) . I guess what I feared came true, huh. Also, update statements should be the same between Access SQL and T-SQL"}], "tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": true, "score": 2, "last_activity_date": 1574282185, "creation_date": 1574282185, "answer_id": 58962965, "question_id": 58942479, "link": "https://stackoverflow.com/questions/58942479/access-2016-docmd-runsql-currentdb-execute-are-not-working-for-update-queries/58962965#58962965", "title": "Access 2016 DoCmd.RunSQL &amp; CurrentDb.Execute are not working for update queries", "body": "<p>Are you passing it as a single string to be executed all at once? That will not work. You have to execute each <code>UPDATE</code> query separately.</p>\n\n<p>Also (this is not the case here, but FYI) MS SQL Server SQL is not the same as MS Access SQL. Just because code works on one it does not mean it will work on the other. </p>\n"}], "owner": {"reputation": 684, "user_id": 5017647, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/af8091d51c64e0558d5b600a3cbde430?s=128&d=identicon&r=PG&f=1", "display_name": "Whiteclaws", "link": "https://stackoverflow.com/users/5017647/whiteclaws"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 0, "accepted_answer_id": 58962965, "answer_count": 1, "score": 0, "last_activity_date": 1594349127, "creation_date": 1574196135, "last_edit_date": 1594349127, "question_id": 58942479, "link": "https://stackoverflow.com/questions/58942479/access-2016-docmd-runsql-currentdb-execute-are-not-working-for-update-queries", "title": "Access 2016 DoCmd.RunSQL &amp; CurrentDb.Execute are not working for update queries", "body": "<p>I have a SQLQuery string that I pass to <code>DoCmd.RunSQL</code> or <code>CurrentDb.Execute</code> and both commands return no warnings and don't do anything...</p>\n\n<pre><code>UPDATE [tblEngrDetails] SET [Colour] = 'Tangerine' WHERE [Reference Number] = '2018-202' AND ([Colour] IS NULL OR [Colour] &lt;&gt; 'Tangerine');\nUPDATE [tblEngrDetails] SET [Colour] = 'Tangerine' WHERE [Reference Number] = '2019-525' AND ([Colour] IS NULL OR [Colour] &lt;&gt; 'Tangerine');\nUPDATE [tblEngrDetails] SET [Colour] = 'Tangerine' WHERE [Reference Number] = '2019-103' AND ([Colour] IS NULL OR [Colour] &lt;&gt; 'Tangerine');\nUPDATE [tblEngrDetails] SET [Colour] = 'Tangerine' WHERE [Reference Number] = '2018-605' AND ([Colour] IS NULL OR [Colour] &lt;&gt; 'Tangerine');\nUPDATE [tblEngrDetails] SET [Colour] = 'Tangerine' WHERE [Reference Number] = '2018-520' AND ([Colour] IS NULL OR [Colour] &lt;&gt; 'Tangerine');\nUPDATE [tblEngrDetails] SET [Colour] = 'Tangerine' WHERE [Reference Number] = '2018-512' AND ([Colour] IS NULL OR [Colour] &lt;&gt; 'Tangerine');\nUPDATE [tblEngrDetails] SET [Colour] = 'Tangerine' WHERE [Reference Number] = '2018-402' AND ([Colour] IS NULL OR [Colour] &lt;&gt; 'Tangerine');\nUPDATE [tblEngrDetails] SET [Colour] = 'Tangerine' WHERE [Reference Number] = '2018-203' AND ([Colour] IS NULL OR [Colour] &lt;&gt; 'Tangerine');\nUPDATE [tblEngrDetails] SET [Colour] = 'Orange' WHERE [Reference Number] = '2017-609' AND ([Colour] IS NULL OR [Colour] &lt;&gt; 'Orange');\nUPDATE [tblEngrDetails] SET [Colour] = 'Orange' WHERE [Reference Number] = '2016-616' AND ([Colour] IS NULL OR [Colour] &lt;&gt; 'Orange');\nUPDATE [tblEngrDetails] SET [Colour] = 'Orange' WHERE [Reference Number] = '2016-528' AND ([Colour] IS NULL OR [Colour] &lt;&gt; 'Orange');\nUPDATE [tblEngrDetails] SET [Colour] = 'Orange' WHERE [Reference Number] = '2016-524' AND ([Colour] IS NULL OR [Colour] &lt;&gt; 'Orange');\nUPDATE [tblEngrDetails] SET [Colour] = 'Orange' WHERE [Reference Number] = '2016-405' AND ([Colour] IS NULL OR [Colour] &lt;&gt; 'Orange');\nUPDATE [tblEngrDetails] SET [Colour] = 'Orange' WHERE [Reference Number] = '2015-206' AND ([Colour] IS NULL OR [Colour] &lt;&gt; 'Orange');\nUPDATE [tblEngrDetails] SET [Colour] = 'Orange' WHERE [Reference Number] = '2015-204' AND ([Colour] IS NULL OR [Colour] &lt;&gt; 'Orange');\nUPDATE [tblEngrDetails] SET [Colour] = 'Orange' WHERE [Reference Number] = '2013-530' AND ([Colour] IS NULL OR [Colour] &lt;&gt; 'Orange');\nUPDATE [tblEngrDetails] SET [Colour] = 'Orange' WHERE [Reference Number] = '2013-509' AND ([Colour] IS NULL OR [Colour] &lt;&gt; 'Orange');\nUPDATE [tblEngrDetails] SET [Colour] = 'Orange' WHERE [Reference Number] = '2013-208' AND ([Colour] IS NULL OR [Colour] &lt;&gt; 'Orange');\nUPDATE [tblEngrDetails] SET [Colour] = 'Orange' WHERE [Reference Number] = '2012-604' AND ([Colour] IS NULL OR [Colour] &lt;&gt; 'Orange');\n</code></pre>\n\n<p>The query works fine when ran in SQL Server Studio, so I don't know what's wrong.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1574196721, "post_id": 58942205, "comment_id": 104143627, "body": "Start by adding <code>Option Explicit</code> at the top of all of your code modules (and set that as the default in VB options by checking &quot;Require variable declaration&quot;.  If you use that it will tell you about problems like <code>SARWorkbook</code> vs <code>SARWorkbk</code>"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 12216189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6b864c847953821057338fa37eb5d06?s=128&d=identicon&r=PG&f=1", "display_name": "KeithK", "link": "https://stackoverflow.com/users/12216189/keithk"}, "edited": false, "score": 0, "creation_date": 1574267911, "post_id": 58942692, "comment_id": 104173868, "body": "Using your code produced a &quot;error &#39;91&#39;: Object variable or With block variable no set&quot; message. When I check the data type of <code>wbSAR</code> using <code>MsgBox TypeName(wbSAR)</code> it returns <code>nothing</code>. It should be <code>workbook</code> right?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 25, "user_id": 12216189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6b864c847953821057338fa37eb5d06?s=128&d=identicon&r=PG&f=1", "display_name": "KeithK", "link": "https://stackoverflow.com/users/12216189/keithk"}, "edited": false, "score": 1, "creation_date": 1574268212, "post_id": 58942692, "comment_id": 104174046, "body": "Yes - if that workbook_open code runs successfully then <code>wbSAR</code> should reference a notebook  It&#39;s possible that some event is resetting your global variables.  Some things to check: <a href=\"https://stackoverflow.com/questions/7041138/what-is-the-lifetime-of-a-global-variable-in-excel-vba/7043901#7043901\" title=\"what is the lifetime of a global variable in excel vba\">stackoverflow.com/questions/7041138/&hellip;</a>"}, {"owner": {"reputation": 25, "user_id": 12216189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6b864c847953821057338fa37eb5d06?s=128&d=identicon&r=PG&f=1", "display_name": "KeithK", "link": "https://stackoverflow.com/users/12216189/keithk"}, "edited": false, "score": 0, "creation_date": 1574270017, "post_id": 58942692, "comment_id": 104175018, "body": "I removed the <code>end sub</code> statement from <code>Private sub workbook_open()</code> and it did the trick. &quot;Yes&quot; and &quot;No&quot; now show up in my new workbook. Otherwise, keeping this <code>end</code> statement would reset the <code>wbSAR</code> object to &#39;nothing&#39;."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 25, "user_id": 12216189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6b864c847953821057338fa37eb5d06?s=128&d=identicon&r=PG&f=1", "display_name": "KeithK", "link": "https://stackoverflow.com/users/12216189/keithk"}, "edited": false, "score": 0, "creation_date": 1574273794, "post_id": 58942692, "comment_id": 104177019, "body": "That sounds odd - removing <code>End Sub</code> should have broken your code.  It&#39;s only <code>End</code> by itself which causes a problem."}, {"owner": {"reputation": 25, "user_id": 12216189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6b864c847953821057338fa37eb5d06?s=128&d=identicon&r=PG&f=1", "display_name": "KeithK", "link": "https://stackoverflow.com/users/12216189/keithk"}, "edited": false, "score": 0, "creation_date": 1574274264, "post_id": 58942692, "comment_id": 104177261, "body": "Yes, you are right. It somehow worked though, but now I am back to the same problem."}, {"owner": {"reputation": 25, "user_id": 12216189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6b864c847953821057338fa37eb5d06?s=128&d=identicon&r=PG&f=1", "display_name": "KeithK", "link": "https://stackoverflow.com/users/12216189/keithk"}, "edited": false, "score": 0, "creation_date": 1574274890, "post_id": 58942692, "comment_id": 104177556, "body": "I don&#39;t see evidence of the 3 other problems listed in that post. I get no run-time error messages."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 25, "user_id": 12216189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6b864c847953821057338fa37eb5d06?s=128&d=identicon&r=PG&f=1", "display_name": "KeithK", "link": "https://stackoverflow.com/users/12216189/keithk"}, "edited": false, "score": 0, "creation_date": 1574275786, "post_id": 58942692, "comment_id": 104177973, "body": "If the workbook path and name is hard-coded in your <code>Workbook_open</code> procedure, can&#39;t you use that same information later elsewhere?  You don&#39;t need to store it in a second place if you move it outside of the Open into a global constant for example.  See my edit above"}, {"owner": {"reputation": 25, "user_id": 12216189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6b864c847953821057338fa37eb5d06?s=128&d=identicon&r=PG&f=1", "display_name": "KeithK", "link": "https://stackoverflow.com/users/12216189/keithk"}, "edited": false, "score": 0, "creation_date": 1574276230, "post_id": 58942692, "comment_id": 104178172, "body": "To wrap this up, I only notice this problem if private subs are repeatedly activated at command line using the run button in VBE. That must somehow reset the global variable."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1574275955, "last_edit_date": 1574275955, "creation_date": 1574197106, "answer_id": 58942692, "question_id": 58942205, "link": "https://stackoverflow.com/questions/58942205/public-variable-not-recognized-in-sub-for-activex-control/58942692#58942692", "title": "Public variable not recognized in sub for ActiveX control", "body": "<p>Simpler like this:</p>\n\n<pre><code>Public wbSAR As Workbook   '&lt;&lt; public variable in Module1 \n\n'in ThisWorkbook module\nPrivate Sub Workbook_Open()\n    Set wbSAR = Workbooks.Add(\"C:\\Users\\...xlsm\") 'Set the workbook reference\nEnd Sub\n</code></pre>\n\n<p>Then later:</p>\n\n<pre><code>'If box is checked, a \"Yes\" string is entered into range object of new workbook wbSAR\nwbSAR.Worksheets(\"COC Form\").Range(\"B46\").Value = IIf(FilBox1.Value, \"Yes\", \"No\")\n</code></pre>\n\n<p>EDIT: alternative approach using constants for wb path and name    </p>\n\n<pre><code>'Constants in module1\nPublic Const WB_PATH As String = \"C:\\Folder1\\Folder2\\\"   \nPublic Const WB_NAME As String = \"ThisIsIt.xlsm\"   \n\n'in ThisWorkbook module\nPrivate Sub Workbook_Open()\n    Workbooks.Add(WB_PATH &amp; WB_NAME) \nEnd Sub\nThen later:\n\n'If box is checked, a \"Yes\" string is entered into range object of new workbook wbSAR\nWorkbooks(WB_NAME).Worksheets(\"COC Form\").Range(\"B46\").Value = IIf(FilBox1.Value, \"Yes\", \"No\")\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 12216189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6b864c847953821057338fa37eb5d06?s=128&d=identicon&r=PG&f=1", "display_name": "KeithK", "link": "https://stackoverflow.com/users/12216189/keithk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 58942692, "answer_count": 1, "score": 0, "last_activity_date": 1574275955, "creation_date": 1574194793, "last_edit_date": 1574196727, "question_id": 58942205, "link": "https://stackoverflow.com/questions/58942205/public-variable-not-recognized-in-sub-for-activex-control", "title": "Public variable not recognized in sub for ActiveX control", "body": "<p>I have a workbook that is programmed upon opening to open a new copy of a second workbook and save the value of the second book's name in a variable that can be accessed by a private sub routine for an ActiveX control. </p>\n\n<p>In a separate module I have the value:</p>\n\n<pre><code>'variable holding the name of the new workbook\nPublic sarname As String\n</code></pre>\n\n<p>In the 'ThisWorkbook' object  I have the code:</p>\n\n<pre><code>Private Sub Workbook_Open()\n\n'creates a new workbook and saves name in public variable\nDim SARWorkbook As Workbook\nSet SARWorkbook = Workbooks.Add(\"C:\\Users\\...xlsm\")\nModule1.sarname = SARWorkbk.Name\n\nEnd Sub\n</code></pre>\n\n<p>Finally, I am using this value in the code:</p>\n\n<pre><code>Private Sub FilBox1_Click()\n\n'If box is checked, a \"Yes\" string is entered into range object of new workbook with name saved in Module1.sarname\nIf FilBox1.Value = True Then\n     Workbooks(Module1.sarname).Worksheets(\"COC Form\").Range(\"b46\").Value = \"Yes\"\nElse\n     Workbooks(Module1.sarname).Worksheets(\"COC Form\").Range(\"b46\").Value = \"No\"\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>The ActiveX control after responding to its status, is supposed place a \"yes\" or \"no\" answer into a cell in the new workbook using the name stored in \"sarname\". After doing some investigating with <code>MsgBox</code>, I know that the value is stored in the variable but the private sub routine only sees it as \"\", and I get a run-time error 13.</p>\n\n<p>I don't have this issue with other private subs that reference public variables, so I'm not sure where this is going wrong.</p>\n\n<p>Taking advice from an answer to a similar question, I took different approach and I wrote in my module:</p>\n\n<pre><code>Public Property Get Somesarname() As String\n\nSomesarname = sarname\n\nEnd Property\n\n</code></pre>\n\n<p>I then used 'somesarname' in my FilBox1 sub instead. That gets me a 'subscript out of range' error and 'somesarname' still showing up as \" \" when I hover the cursor over it. </p>\n\n<p>I'm totally stumped now. What basic thing am I missing here?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 412, "user_id": 6226158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecafe459d3eaec4134cf289a15a1d537?s=128&d=identicon&r=PG&f=1", "display_name": "rxex", "link": "https://stackoverflow.com/users/6226158/rxex"}, "edited": false, "score": 0, "creation_date": 1574198331, "post_id": 58941680, "comment_id": 104144332, "body": "I am not sure what is the problem that you are experiencing. I ran your code and works fine on my end. The only thing I found somewhat odd is that you are renaming the first four sheets, but if you are merging four files that have more than one sheet each, then you will have more than four sheets so none will be renamed. Can you specify more precisely what happens when you run your code?"}, {"owner": {"reputation": 412, "user_id": 6226158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecafe459d3eaec4134cf289a15a1d537?s=128&d=identicon&r=PG&f=1", "display_name": "rxex", "link": "https://stackoverflow.com/users/6226158/rxex"}, "edited": false, "score": 0, "creation_date": 1574198922, "post_id": 58941680, "comment_id": 104144580, "body": "Also, referencing the .png you added, is it possible that three of the files you are trying to merge all contain a sheet called &quot;Table 1&quot;?"}, {"owner": {"reputation": 1, "user_id": 12399787, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pEjSVkuCgQI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rezMQ48z0c-YFoI90P-TokmiomC-Q/photo.jpg?sz=128", "display_name": "Jordan Pinchard", "link": "https://stackoverflow.com/users/12399787/jordan-pinchard"}, "reply_to_user": {"reputation": 412, "user_id": 6226158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecafe459d3eaec4134cf289a15a1d537?s=128&d=identicon&r=PG&f=1", "display_name": "rxex", "link": "https://stackoverflow.com/users/6226158/rxex"}, "edited": false, "score": 0, "creation_date": 1574346728, "post_id": 58941680, "comment_id": 104207731, "body": "The issue I&#39;m having is that I only want it to add the names of the file (EL, FM, NL, WL) but it adds the table(1), table(2),... I don&#39;t want it adding the table names to the worksheet. basically I want table(1),table(2),... so on to be named EL, FM, NL, depending on the file name. It creates double the worksheets I just want one set that&#39;s named EL, FM,..."}, {"owner": {"reputation": 412, "user_id": 6226158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecafe459d3eaec4134cf289a15a1d537?s=128&d=identicon&r=PG&f=1", "display_name": "rxex", "link": "https://stackoverflow.com/users/6226158/rxex"}, "edited": false, "score": 0, "creation_date": 1574352259, "post_id": 58941680, "comment_id": 104211194, "body": "The if block to rename sheets only contemplates renaming sheets if the workbook has 2, 3, or 4 sheets. It will not rename anything otherwise. Given that the book where you have the macro must have one sheet (at least), it will only kick in if you only consolidate three files (which will end up with a 4-sheet book). There is no way that your macro can rename any sheet if you end up with more than 4 sheets (i.e. if you try to consolidate more than three files, providing you only have one sheet to start with in your macro book)."}, {"owner": {"reputation": 412, "user_id": 6226158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecafe459d3eaec4134cf289a15a1d537?s=128&d=identicon&r=PG&f=1", "display_name": "rxex", "link": "https://stackoverflow.com/users/6226158/rxex"}, "edited": false, "score": 0, "creation_date": 1574353159, "post_id": 58941680, "comment_id": 104211724, "body": "My guess is that you ran the macro once with three files and got the result you wanted, but then you ran it again and it ended up just adding the new sheets and not renaming them. That is what I did and I ended up with the exact same .png you posted in your original question: <a href=\"https://postimg.cc/f3NSyt62\" rel=\"nofollow noreferrer\">postimg.cc/f3NSyt62</a>"}, {"owner": {"reputation": 1, "user_id": 12399787, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pEjSVkuCgQI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rezMQ48z0c-YFoI90P-TokmiomC-Q/photo.jpg?sz=128", "display_name": "Jordan Pinchard", "link": "https://stackoverflow.com/users/12399787/jordan-pinchard"}, "reply_to_user": {"reputation": 412, "user_id": 6226158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecafe459d3eaec4134cf289a15a1d537?s=128&d=identicon&r=PG&f=1", "display_name": "rxex", "link": "https://stackoverflow.com/users/6226158/rxex"}, "edited": false, "score": 0, "creation_date": 1574354308, "post_id": 58941680, "comment_id": 104212410, "body": "So how would I got about fixing this issue?"}, {"owner": {"reputation": 1, "user_id": 12399787, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pEjSVkuCgQI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rezMQ48z0c-YFoI90P-TokmiomC-Q/photo.jpg?sz=128", "display_name": "Jordan Pinchard", "link": "https://stackoverflow.com/users/12399787/jordan-pinchard"}, "reply_to_user": {"reputation": 412, "user_id": 6226158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecafe459d3eaec4134cf289a15a1d537?s=128&d=identicon&r=PG&f=1", "display_name": "rxex", "link": "https://stackoverflow.com/users/6226158/rxex"}, "edited": false, "score": 0, "creation_date": 1574354455, "post_id": 58941680, "comment_id": 104212498, "body": "By the way I add the code to every file that I consolidate. So it&#39;s not an excel file that I load info to. I add the code to a new document everytime."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12399787, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pEjSVkuCgQI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rezMQ48z0c-YFoI90P-TokmiomC-Q/photo.jpg?sz=128", "display_name": "Jordan Pinchard", "link": "https://stackoverflow.com/users/12399787/jordan-pinchard"}, "edited": false, "score": 0, "creation_date": 1574367968, "post_id": 58980956, "comment_id": 104218919, "body": "So the only issue with this is that certain files need to be named certain things based on what the excel file is names. i.e. if it has <i>FM</i> in the file name then the page needs to be named FM if it has the name NL in the file name then it needs to be names NL and so on."}, {"owner": {"reputation": 1, "user_id": 12399787, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pEjSVkuCgQI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rezMQ48z0c-YFoI90P-TokmiomC-Q/photo.jpg?sz=128", "display_name": "Jordan Pinchard", "link": "https://stackoverflow.com/users/12399787/jordan-pinchard"}, "edited": false, "score": 0, "creation_date": 1574369388, "post_id": 58980956, "comment_id": 104219546, "body": "Sorry I just re-ran the program and it worked. I had one of the sheets open that it was trying to add so it errored out. Thanks for the help."}, {"owner": {"reputation": 1, "user_id": 12399787, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pEjSVkuCgQI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rezMQ48z0c-YFoI90P-TokmiomC-Q/photo.jpg?sz=128", "display_name": "Jordan Pinchard", "link": "https://stackoverflow.com/users/12399787/jordan-pinchard"}, "edited": false, "score": 0, "creation_date": 1574369736, "post_id": 58980956, "comment_id": 104219713, "body": "Sorry I take it back it didn&#39;t work I just checked the documents it added. even though I manually picked which files to add it pulled info from a different excel files information."}, {"owner": {"reputation": 412, "user_id": 6226158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecafe459d3eaec4134cf289a15a1d537?s=128&d=identicon&r=PG&f=1", "display_name": "rxex", "link": "https://stackoverflow.com/users/6226158/rxex"}, "reply_to_user": {"reputation": 1, "user_id": 12399787, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pEjSVkuCgQI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rezMQ48z0c-YFoI90P-TokmiomC-Q/photo.jpg?sz=128", "display_name": "Jordan Pinchard", "link": "https://stackoverflow.com/users/12399787/jordan-pinchard"}, "edited": false, "score": 0, "creation_date": 1574432391, "post_id": 58980956, "comment_id": 104242478, "body": "If you want to name the sheets according to the file names you are consolidating then you need to put the file name you are opening into a variable and then apply that variable value into the sheet.name in the new file. I am not sure what you mean by &quot;it pulled info from a different excel files information.&quot; Seems to be a different problem from the one posed on your original question."}, {"owner": {"reputation": 1, "user_id": 12399787, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pEjSVkuCgQI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rezMQ48z0c-YFoI90P-TokmiomC-Q/photo.jpg?sz=128", "display_name": "Jordan Pinchard", "link": "https://stackoverflow.com/users/12399787/jordan-pinchard"}, "edited": false, "score": 0, "creation_date": 1574438173, "post_id": 58980956, "comment_id": 104245701, "body": "I mean that when I selected the files I wanted to add into one excel file it took the info from another excel file instead of what I chose."}, {"owner": {"reputation": 1, "user_id": 12399787, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pEjSVkuCgQI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rezMQ48z0c-YFoI90P-TokmiomC-Q/photo.jpg?sz=128", "display_name": "Jordan Pinchard", "link": "https://stackoverflow.com/users/12399787/jordan-pinchard"}, "edited": false, "score": 0, "creation_date": 1574438324, "post_id": 58980956, "comment_id": 104245782, "body": "example I chose to add files with name 071-358-525 but instead it added file name 071-301-107"}, {"owner": {"reputation": 412, "user_id": 6226158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecafe459d3eaec4134cf289a15a1d537?s=128&d=identicon&r=PG&f=1", "display_name": "rxex", "link": "https://stackoverflow.com/users/6226158/rxex"}, "reply_to_user": {"reputation": 1, "user_id": 12399787, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pEjSVkuCgQI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rezMQ48z0c-YFoI90P-TokmiomC-Q/photo.jpg?sz=128", "display_name": "Jordan Pinchard", "link": "https://stackoverflow.com/users/12399787/jordan-pinchard"}, "edited": false, "score": 0, "creation_date": 1574518863, "post_id": 58980956, "comment_id": 104265328, "body": "This is a problem that is not related to the question you initially posted, which was that more worksheets were generated when you were running your code. The proper way of proceeding would be 1) If any of my answers of comments were useful, please upvote them. 2) initiate a new question and describe the problem you are encountering, so your question is not buried in this thread and you can solicit help from a wider audience."}], "tags": [], "owner": {"reputation": 412, "user_id": 6226158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecafe459d3eaec4134cf289a15a1d537?s=128&d=identicon&r=PG&f=1", "display_name": "rxex", "link": "https://stackoverflow.com/users/6226158/rxex"}, "is_accepted": false, "score": 0, "last_activity_date": 1574358766, "creation_date": 1574358766, "answer_id": 58980956, "question_id": 58941680, "link": "https://stackoverflow.com/questions/58941680/vba-code-error-in-creating-too-many-worksheets/58980956#58980956", "title": "VBA code Error in creating too many worksheets", "body": "<p>Of course there are many ways of doing what you want. </p>\n\n<p>This is one way: If you want to consider four files at a time for consolidation into one sheet, I would create a master file that contains that code, such as \u201cMergeFilesMaster.xlsm.\u201d Said file would have a sheet which you can name \u201cControl\u201d where you can put a button to activate the code contained in that .xlsm file. Given that your process only contemplates renaming four sheets, I assume you only want to merge four files at a time into a new workbook. The code would thus be:</p>\n\n<pre><code>Sub MergeExcelFiles()\n    Dim fnameList, fnameCurFile As Variant\n    Dim countFiles, countSheets As Integer\n    Dim wksCurSheet As Worksheet\n    Dim wbkCurBook, wbkSrcBook As Workbook\n    Dim a As Long\n\n    fnameList = Application.GetOpenFilename(FileFilter:=\"Microsoft Excel Workbooks (*.xls;*.xlsx;*.xlsm),*.xls;*.xlsx;*.xlsm\", Title:=\"Choose Excel files to merge\", MultiSelect:=True)\n\n    If (vbBoolean &lt;&gt; VarType(fnameList)) Then\n\n        If (UBound(fnameList) &gt; 0) Then\n            countFiles = 0\n            countSheets = 0\n\n            Application.ScreenUpdating = False\n            Application.Calculation = xlCalculationManual\n\n            Set wbkCurBook = ActiveWorkbook\n            n = wbkCurBook.Name\n\n            For Each fnameCurFile In fnameList\n                countFiles = countFiles + 1\n\n                Set wbkSrcBook = Workbooks.Open(Filename:=fnameCurFile)\n\n                For Each wksCurSheet In wbkSrcBook.Sheets\n                    countSheets = countSheets + 1\n                    Select Case countSheets\n                        Case 1\n                            wksCurSheet.Name = \"EL\"\n                        Case 2\n                            wksCurSheet.Name = \"WL\"\n                        Case 3\n                            wksCurSheet.Name = \"FM\"\n                        Case 4\n                            wksCurSheet.Name = \"NL\"\n                    End Select\n                    wksCurSheet.Copy after:=wbkCurBook.Sheets(wbkCurBook.Sheets.Count)\n                Next\n\n                wbkSrcBook.Close SaveChanges:=False\n                ' because SaveChanges is set to False, the new names in the original files will not be saved.\n\n            Next\n\n            Application.ScreenUpdating = True\n            Application.Calculation = xlCalculationAutomatic\n\n            MsgBox \"Processed \" &amp; countFiles &amp; \" files\" &amp; vbCrLf &amp; \"Merged \" &amp; countSheets &amp; \" worksheets\", Title:=\"Merge Excel files\"\n        End If\n\n    Else\n        MsgBox \"No files selected\", Title:=\"Merge Excel files\"\n    End If\n\n    wbkCurBook.Sheets(\"Control\").Delete\n    ' delete the empty sheet\n\n    wbkCurBook.SaveAs Filename:= _\n            \"C:[your directory here]\\MergeFilesMaster.xlsx\" _\n            , FileFormat:=xlOpenXMLWorkbook\n\n    ' this will save your MergeFilesMaster.xlsm into an .xlsx file\n    ' or add a line to change the file name, such as YYMMDD.xlsx so you can sort them by the date you processed it.\n\nEnd Sub\n</code></pre>\n\n<p>Let me know if this worked.</p>\n"}], "owner": {"reputation": 1, "user_id": 12399787, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pEjSVkuCgQI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rezMQ48z0c-YFoI90P-TokmiomC-Q/photo.jpg?sz=128", "display_name": "Jordan Pinchard", "link": "https://stackoverflow.com/users/12399787/jordan-pinchard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574358766, "creation_date": 1574192304, "last_edit_date": 1574194386, "question_id": 58941680, "link": "https://stackoverflow.com/questions/58941680/vba-code-error-in-creating-too-many-worksheets", "title": "VBA code Error in creating too many worksheets", "body": "<pre><code>Sub MergeExcelFiles()\nDim fnameList, fnameCurFile As Variant\nDim countFiles, countSheets As Integer\nDim wksCurSheet As Worksheet\nDim wbkCurBook, wbkSrcBook As Workbook\nDim a As Long\n\nfnameList = Application.GetOpenFilename(FileFilter:=\"Microsoft Excel Workbooks (*.xls;*.xlsx;*.xlsm),*.xls;*.xlsx;*.xlsm\", Title:=\"Choose Excel files to merge\", MultiSelect:=True)\n\nIf (vbBoolean &lt;&gt; VarType(fnameList)) Then\n\n    If (UBound(fnameList) &gt; 0) Then\n        countFiles = 0\n        countSheets = 0\n\n        Application.ScreenUpdating = False\n        Application.Calculation = xlCalculationManual\n\n        Set wbkCurBook = ActiveWorkbook\n\n        For Each fnameCurFile In fnameList\n            countFiles = countFiles + 1\n\n            Set wbkSrcBook = Workbooks.Open(Filename:=fnameCurFile)\n\n            For Each wksCurSheet In wbkSrcBook.Sheets\n                countSheets = countSheets + 1\n                wksCurSheet.Copy after:=wbkCurBook.Sheets(wbkCurBook.Sheets.Count)\n            Next\n\n            wbkSrcBook.Close SaveChanges:=False\n\n        Next\n\n        Dim NowTic As Long\n        Dim EndToc As Long\n\n        EndToc = (10 * 1000)\n\n        Do\n            NowTic = NowTic + 1\n            DoEvents\n        Loop Until NowTic &gt;= EndToc\n\n        If Sheets.Count = 2 Then\n            Sheets(1).Name = \"EL\"\n            Sheets(2).Name = \"WL\"\n        ElseIf Sheets.Count = 3 Then\n            Sheets(1).Name = \"EL\"\n            If InStr(1, fnameList(1), \"_FM_\") &gt; 0 Then\n                Sheets(2).Name = \"FM\"\n            ElseIf InStr(1, fnameList(1), \"_NL_\") &gt; 0 Then\n                Sheets(2).Name = \"NL\"\n            End If\n            Sheets(3).Name = \"WL\"\n        ElseIf Sheets.Count = 4 Then\n            Sheets(1).Name = \"EL\"\n            Sheets(2).Name = \"FM\"\n            Sheets(3).Name = \"NL\"\n            Sheets(4).Name = \"WL\"\n        End If\n\n        Application.ScreenUpdating = True\n        Application.Calculation = xlCalculationAutomatic\n\n        MsgBox \"Processed \" &amp; countFiles &amp; \" files\" &amp; vbCrLf &amp; \"Merged \" &amp; countSheets &amp; \" worksheets\", Title:=\"Merge Excel files\"\n    End If\n\nElse\n    MsgBox \"No files selected\", Title:=\"Merge Excel files\"\nEnd If\n</code></pre>\n\n<p>End Sub</p>\n\n<p>My code keeps producing more worksheets than needed. How do I get it to stop? It only does it when I try to have 3 workbooks total. I've tried adding a TicToc to the code as you can see above but that hasn't helped. I don't know what else to try. </p>\n\n<p><a href=\"https://i.stack.imgur.com/8AvkL.png\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/8AvkL.png</a></p>\n"}, {"tags": ["excel", "vba", "subdirectory", "msg"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12399734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1e5d9c4fc494dd519c279ef2a722402?s=128&d=identicon&r=PG&f=1", "display_name": "Scarborough12345", "link": "https://stackoverflow.com/users/12399734/scarborough12345"}, "edited": false, "score": 0, "creation_date": 1574264981, "post_id": 58941804, "comment_id": 104172074, "body": "I tried this and it still only does it for the top folder. Perhaps I&#39;m doing it wrong. Would it be possible for you to provide more detail?"}, {"owner": {"reputation": 594, "user_id": 1126927, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d6701ce88607ae792d291de20eabf78b?s=128&d=identicon&r=PG", "display_name": "Brownish Monster", "link": "https://stackoverflow.com/users/1126927/brownish-monster"}, "reply_to_user": {"reputation": 1, "user_id": 12399734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1e5d9c4fc494dd519c279ef2a722402?s=128&d=identicon&r=PG&f=1", "display_name": "Scarborough12345", "link": "https://stackoverflow.com/users/12399734/scarborough12345"}, "edited": false, "score": 0, "creation_date": 1574266094, "post_id": 58941804, "comment_id": 104172766, "body": "Please would you be able to edit your question and add the code you&#39;re using now?"}, {"owner": {"reputation": 1, "user_id": 12399734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1e5d9c4fc494dd519c279ef2a722402?s=128&d=identicon&r=PG&f=1", "display_name": "Scarborough12345", "link": "https://stackoverflow.com/users/12399734/scarborough12345"}, "edited": false, "score": 0, "creation_date": 1574267153, "post_id": 58941804, "comment_id": 104173395, "body": "Updated as requested"}, {"owner": {"reputation": 594, "user_id": 1126927, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d6701ce88607ae792d291de20eabf78b?s=128&d=identicon&r=PG", "display_name": "Brownish Monster", "link": "https://stackoverflow.com/users/1126927/brownish-monster"}, "reply_to_user": {"reputation": 1, "user_id": 12399734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1e5d9c4fc494dd519c279ef2a722402?s=128&d=identicon&r=PG&f=1", "display_name": "Scarborough12345", "link": "https://stackoverflow.com/users/12399734/scarborough12345"}, "edited": false, "score": 0, "creation_date": 1574325850, "post_id": 58941804, "comment_id": 104195014, "body": "@Scarborough12345 Please find this should now be updated"}], "tags": [], "owner": {"reputation": 594, "user_id": 1126927, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d6701ce88607ae792d291de20eabf78b?s=128&d=identicon&r=PG", "display_name": "Brownish Monster", "link": "https://stackoverflow.com/users/1126927/brownish-monster"}, "is_accepted": false, "score": 0, "last_activity_date": 1574325840, "last_edit_date": 1574325840, "creation_date": 1574192842, "answer_id": 58941804, "question_id": 58941521, "link": "https://stackoverflow.com/questions/58941521/extract-attachments-from-msg-files-saved-in-a-folder-using-excel-vba-subdirec/58941804#58941804", "title": "Extract attachments from .msg files saved in a folder using excel vba - subdirectories", "body": "<p>This loops through a directory and it's sub-directories. It will call <code>MyCode</code> and pass in the folder's full path. You will need to modify <code>MyCode</code> to do what you want.</p>\n\n<pre><code>Sub LoopThrough(parentFolder As String)\nDim fso As Object\n    ' Create a File System object to loop through folders\n    If fso Is Nothing Then\n        Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    End If\n\n    ' Get the specified folder\n    Dim folder As Object\n    Set folder = fso.GetFolder(parentFolder)\n\n    ' Call my code on it\n    MyCode msgfiles.Path\n\n    ' Get all sub folders\n    Dim subFolder As Object\n    On Error Resume Next                    ' We might have permission issues so lets carry on if we get a folder we cannot access\n    For Each subFolder In folder.subfolders\n        On Error GoTo 0                     ' If we cant access the folder, reset error\n        If Not subFolder Is Nothing Then    ' Folder will be null/nothing if we had an error so ignore it if it is\n            LoopThrough subFolder.Path\n        End If\n        On Error Resume Next                ' When going back over the loop  we can still get an error\n    Next\n    On Error GoTo 0\nEnd Sub\n\nSub MyCode(folder As String)\n    Dim outApp As Object\n    Dim outEmail As Object\n    Dim outAttachment As Object\n    Dim msgfiles As String, sourceFolder As String, saveInFolder As String\n    Dim fileName As String\n\n    Debug.Print folder\n    msgfiles = folder &amp; \"\\*.msg\"\n    ' Your code Here\n\n\n    ''msgfiles = \"C:\\test\\*.msg\"       'CHANGE - folder location and filespec of .msg files\n    saveInFolder = \"C:\\test 2\"         'CHANGE - folder where extracted attachments are saved\n\n    If Right(saveInFolder, 1) &lt;&gt; \"\\\" Then saveInFolder = saveInFolder &amp; \"\\\"\n    sourceFolder = Left(msgfiles, InStrRev(msgfiles, \"\\\"))\n\n    On Error Resume Next\n    Set outApp = GetObject(, \"Outlook.Application\")\n    If outApp Is Nothing Then\n        MsgBox \"Outlook is not open\"\n        Exit Sub\n    End If\n    On Error GoTo 0\n\n    fileName = Dir(msgfiles)\n    While fileName &lt;&gt; vbNullString\n\n        'Open .msg file in Outlook 2003\n        'Set outEmail = outApp.CreateItemFromTemplate(sourceFolder &amp; fileName)\n\n        'Open .msg file in Outlook 2007+\n        Set outEmail = outApp.Session.OpenSharedItem(sourceFolder &amp; fileName)\n\n        For Each outAttachment In outEmail.Attachments\n            outAttachment.SaveAsFile saveInFolder &amp; outAttachment.fileName\n        Next\n\n        fileName = Dir\n\n    Wend\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12399734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1e5d9c4fc494dd519c279ef2a722402?s=128&d=identicon&r=PG&f=1", "display_name": "Scarborough12345", "link": "https://stackoverflow.com/users/12399734/scarborough12345"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 690, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574325840, "creation_date": 1574191626, "last_edit_date": 1574267114, "question_id": 58941521, "link": "https://stackoverflow.com/questions/58941521/extract-attachments-from-msg-files-saved-in-a-folder-using-excel-vba-subdirec", "title": "Extract attachments from .msg files saved in a folder using excel vba - subdirectories", "body": "<p>Was able to put together something to go through the main folder and pick up msg files and extract attachments\nI want the code to be able to loop through subfolders also\nHow would I go about it? I've seen a few threads on the topic but I'm having difficulty translating it to what I've got</p>\n\n<p>'''</p>\n\n<pre><code>Dim outApp As Object\nDim outEmail As Object\nDim outAttachment As Object\nDim msgfiles As String, sourceFolder As String, saveInFolder As String\nDim fileName As String\n\nmsgfiles = \"C:\\test\\*.msg\"       'CHANGE - folder location and filespec of .msg files\nsaveInFolder = \"C:\\test 2\"         'CHANGE - folder where extracted attachments are saved\n\nIf Right(saveInFolder, 1) &lt;&gt; \"\\\" Then saveInFolder = saveInFolder &amp; \"\\\"\nsourceFolder = Left(msgfiles, InStrRev(msgfiles, \"\\\"))\n\nOn Error Resume Next\nSet outApp = GetObject(, \"Outlook.Application\")\nIf outApp Is Nothing Then\n    MsgBox \"Outlook is not open\"\n    Exit Sub\nEnd If\nOn Error GoTo 0\n\nfileName = dir(msgfiles)\nWhile fileName &lt;&gt; vbNullString\n\n    'Open .msg file in Outlook 2003\n    'Set outEmail = outApp.CreateItemFromTemplate(sourceFolder &amp; fileName)\n\n    'Open .msg file in Outlook 2007+\n    Set outEmail = outApp.Session.OpenSharedItem(sourceFolder &amp; fileName)\n\n    For Each outAttachment In outEmail.Attachments\n        outAttachment.SaveAsFile saveInFolder &amp; outAttachment.fileName\n    Next\n\n    fileName = dir\n\nWend\n</code></pre>\n\n<p>'''</p>\n\n<p>EDIT</p>\n\n<p>Including code below after first suggestion</p>\n\n<pre><code>Sub LoopThrough(parentFolder As String)\nDim fso As Object\n    ' Create a File System object to loop through folders\n    If fso Is Nothing Then\n        Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    End If\n\n    ' Get the specified folder\n    Dim folder As Object\n    Set folder = fso.GetFolder(parentFolder)\n\n    ' Call my code on it\n    MyCode msgfiles.Path\n\n    ' Get all sub folders\n    Dim subFolder As Object\n    On Error Resume Next                    ' We might have permission issues so lets carry on if we get a folder we cannot access\n    For Each subFolder In folder.subfolders\n        On Error GoTo 0                     ' If we cant access the folder, reset error\n        If Not subFolder Is Nothing Then    ' Folder will be null/nothing if we had an error so ignore it if it is\n            LoopThrough subFolder.Path\n        End If\n        On Error Resume Next                ' When going back over the loop  we can still get an error\n    Next\n    On Error GoTo 0\nEnd Sub\n\nSub MyCode(folder As String)\n    Debug.Print folder\n    msgfiles = folder &amp; \"\\*.msg\"\n    ' Your code Here\n\nDim outApp As Object\nDim outEmail As Object\nDim outAttachment As Object\nDim msgfiles As String, sourceFolder As String, saveInFolder As String\nDim fileName As String\n\nmsgfiles = \"C:\\test\\*.msg\"       'CHANGE - folder location and filespec of .msg files\nsaveInFolder = \"C:\\test 2\"         'CHANGE - folder where extracted attachments are saved\n\nIf Right(saveInFolder, 1) &lt;&gt; \"\\\" Then saveInFolder = saveInFolder &amp; \"\\\"\nsourceFolder = Left(msgfiles, InStrRev(msgfiles, \"\\\"))\n\nOn Error Resume Next\nSet outApp = GetObject(, \"Outlook.Application\")\nIf outApp Is Nothing Then\n    MsgBox \"Outlook is not open\"\n    Exit Sub\nEnd If\nOn Error GoTo 0\n\nfileName = Dir(msgfiles)\nWhile fileName &lt;&gt; vbNullString\n\n    'Open .msg file in Outlook 2003\n    'Set outEmail = outApp.CreateItemFromTemplate(sourceFolder &amp; fileName)\n\n    'Open .msg file in Outlook 2007+\n    Set outEmail = outApp.Session.OpenSharedItem(sourceFolder &amp; fileName)\n\n    For Each outAttachment In outEmail.Attachments\n        outAttachment.SaveAsFile saveInFolder &amp; outAttachment.fileName\n    Next\n\n    fileName = Dir\n\nWend\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-2007"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574191332, "post_id": 58941410, "comment_id": 104141251, "body": "Instead of looping row by row, why not just use a filter?"}, {"owner": {"reputation": 19, "user_id": 11173362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d55fc9ea751100ecdc0643b9d909f0a1?s=128&d=identicon&r=PG&f=1", "display_name": "junepeace", "link": "https://stackoverflow.com/users/11173362/junepeace"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574191412, "post_id": 58941410, "comment_id": 104141286, "body": "I&#39;m very new, I&#39;ve got no idea how :( Pros/Cons?"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1574192383, "post_id": 58941410, "comment_id": 104141727, "body": "The macro recorder is your friend."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1574192954, "post_id": 58941410, "comment_id": 104142001, "body": "Call one sub rather than repeat your code 5 times. What is the value of lastrow?"}, {"owner": {"reputation": 19, "user_id": 11173362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d55fc9ea751100ecdc0643b9d909f0a1?s=128&d=identicon&r=PG&f=1", "display_name": "junepeace", "link": "https://stackoverflow.com/users/11173362/junepeace"}, "edited": false, "score": 0, "creation_date": 1574194673, "post_id": 58941410, "comment_id": 104142723, "body": "I want to be able to pick specifically Level 1, 2, 3, 4 or 5 and not get the results from other ones. Would combining them under one SUB not mean they all get done? Lastrow is there to make sure it pastes below the last row used."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1574196856, "post_id": 58941410, "comment_id": 104143696, "body": "You can add a parameter to your sub. I meant what is its value when you step through the code?"}, {"owner": {"reputation": 19, "user_id": 11173362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d55fc9ea751100ecdc0643b9d909f0a1?s=128&d=identicon&r=PG&f=1", "display_name": "junepeace", "link": "https://stackoverflow.com/users/11173362/junepeace"}, "edited": false, "score": 0, "creation_date": 1574197170, "post_id": 58941410, "comment_id": 104143836, "body": "hmm when I try to step through it gives me Subscript Out of Range just before getting to lastrow."}], "owner": {"reputation": 19, "user_id": 11173362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d55fc9ea751100ecdc0643b9d909f0a1?s=128&d=identicon&r=PG&f=1", "display_name": "junepeace", "link": "https://stackoverflow.com/users/11173362/junepeace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574253243, "creation_date": 1574191133, "last_edit_date": 1574253243, "question_id": 58941410, "link": "https://stackoverflow.com/questions/58941410/excel-2007-vba-code-for-list-generating-works-but-only-sometimes", "title": "Excel 2007 VBA Code for list generating works but only sometimes", "body": "<p>I'm putting together a list generator and I'm having trouble getting my code to work properly (again!).</p>\n\n<h2>The code works for the first row of data but ignores all the others.</h2>\n\n<p>All the codes are the same, I've got 5 buttons. The Level # is stored in column X, so #24.</p>\n\n<p>I want to be able to click the button and generate a list of the rows that contain the Level #, from the PI sheet to the Lists sheet. </p>\n\n<p>The data that will be transferred is contact info and sizing info and is in the same row as the Level #.</p>\n\n<pre><code>Private Sub CommandButton2_Click() 'level 1 button\n    Dim LastRow As Long\n    Dim i As Long, j As Long\n\n    'Find the last used row in a Column: column A in this example\n    With Worksheets(\"PI\")\n    LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    End With\n\n'first row number where you need to paste values in Sheet1'\n    With Worksheets(\"Lists\")\n    j = .Cells(.Rows.Count, \"A\").End(xlUp).Row + 1\n    End With\n\nFor i = 1 To LastRow\n   With Worksheets(\"PI\")\n       If .Cells(i, 24).Value = \"1\" Then\n           .Rows(i).Copy Destination:=Worksheets(\"Lists\").Range(\"A\" &amp; j)\n           j = j + 1\n       End If\n   End With\nNext i\n    End Sub\n\nPrivate Sub Level5_Click()\nDim LastRow As Long\n   Dim i As Long, j As Long\n\n   'Find the last used row in a Column: column A in this example\n   With Worksheets(\"PI\")\n      LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n   End With\n\n   'first row number where you need to paste values in Sheet1'\n   With Worksheets(\"Lists\")\n      j = .Cells(.Rows.Count, \"A\").End(xlUp).Row + 1\n   End With\n\n   For i = 1 To LastRow\n       With Worksheets(\"PI\")\n           If .Cells(i, 24).Value = \"5\" Then\n               .Rows(i).Copy Destination:=Worksheets(\"Lists\").Range(\"A\" &amp; j)\n               j = j + 1\n           End If\n       End With\n   Next i\n    End Sub\n\nPrivate Sub Lvl2_Click()\nDim LastRow As Long\n   Dim i As Long, j As Long\n\n   'Find the last used row in a Column: column A in this example\n   With Worksheets(\"PI\")\n      LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n   End With\n\n   'first row number where you need to paste values in Sheet1'\n   With Worksheets(\"Lists\")\n      j = .Cells(.Rows.Count, \"A\").End(xlUp).Row + 1\n   End With\n\n   For i = 1 To LastRow\n       With Worksheets(\"PI\")\n           If .Cells(i, 24).Value = \"2\" Then\n               .Rows(i).Copy Destination:=Worksheets(\"Lists\").Range(\"A\" &amp; j)\n               j = j + 1\n           End If\n       End With\n   Next i\n    End Sub\n\nPrivate Sub Lvl3_Click()\nDim LastRow As Long\n   Dim i As Long, j As Long\n\n   'Find the last used row in a Column: column A in this example\n   With Worksheets(\"PI\")\n      LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n   End With\n\n   'first row number where you need to paste values in Sheet1'\n   With Worksheets(\"Lists\")\n      j = .Cells(.Rows.Count, \"A\").End(xlUp).Row + 1\n   End With\n\n   For i = 1 To LastRow\n       With Worksheets(\"PI\")\n           If .Cells(i, 24).Value = \"3\" Then\n               .Rows(i).Copy Destination:=Worksheets(\"Lists\").Range(\"A\" &amp; j)\n               j = j + 1\n           End If\n       End With\n   Next i\nEnd Sub\n\nPrivate Sub Lvl4_Click()\nDim LastRow As Long\n   Dim i As Long, j As Long\n\n   'Find the last used row in a Column: column A in this example\n   With Worksheets(\"PI\")\n      LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n   End With\n\n   'first row number where you need to paste values in Sheet1'\n   With Worksheets(\"Lists\")\n      j = .Cells(.Rows.Count, \"A\").End(xlUp).Row + 1\n   End With\n\n   For i = 1 To LastRow\n       With Worksheets(\"PI\")\n           If .Cells(i, 24).Value = \"4\" Then\n               .Rows(i).Copy Destination:=Worksheets(\"Lists\").Range(\"A\" &amp; j)\n               j = j + 1\n           End If\n       End With\n   Next i\nEnd Sub\n</code></pre>\n"}]