[{"tags": ["excel", "vba", "email", "outlook", "range"], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1525996121, "creation_date": 1525996121, "answer_id": 50283018, "question_id": 50263395, "link": "https://stackoverflow.com/questions/50263395/add-mail-body-from-excel-range-vba/50283018#50283018", "title": "add mail body from excel range vba", "body": "<p>You need to use the <code>Text</code> property of the <code>Range</code> class instead of <code>Value</code>:</p>\n\n<pre><code>Sub test()\n  Dim Sendrng As Range\n  Dim outlookApp As Outlook.Application\n  Dim outlookMail As Outlook.MailItem\n  Dim i As Integer\n\n\n  For i = 2 To ActiveSheet.Cells(5, 2).Value + 1\n    Set Sendrng = ActiveSheet.Range(\"B12:K29\")\n    Set outlookApp = New Outlook.Application\n    Set outlookMail = outlookApp.CreateItem(olMailItem)\n    With outlookMail\n      .To = ActiveSheet.Cells(7, 2).Text\n      .Subject = ActiveSheet.Cells(8, 2).Text\n      .Save\n    End With\n    i = i + 1\n    ActiveSheet.Cells(4, 2) = i\n    Set outlookMail = Nothing\n    Set outlookApp = Nothing\n\n  Next i\n\n 'I want to start every time in position 2\n ActiveSheet.Cells(4, 2) = 2\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5300183, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001484205570/picture?type=large", "display_name": "Henrique Umbelino", "link": "https://stackoverflow.com/users/5300183/henrique-umbelino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1525996121, "creation_date": 1525908267, "question_id": 50263395, "link": "https://stackoverflow.com/questions/50263395/add-mail-body-from-excel-range-vba", "title": "add mail body from excel range vba", "body": "<p>I have a database, just with names and e-mail addresses and I need to create individual e-mails with a specific fixed text, that is in a specific range of my excel and save it in a specific folder of my hard drive.</p>\n\n<p>However, I'm having problems with the body text. </p>\n\n<p>Here it is the code:</p>\n\n<pre><code>Sub test()\nDim Sendrng As Range\nDim outlookApp As Outlook.Application\nDim outlookMail As Outlook.MailItem\nDim i As Integer\n\n\nFor i = 2 To ActiveSheet.Cells(5, 2).Value + 1\n\n    Set Sendrng = ActiveSheet.Range(\"B12:K29\")\n    Set outlookApp = New Outlook.Application\n    Set outlookMail = outlookApp.CreateItem(olMailItem)\n    With outlookMail\n        .To = ActiveSheet.Cells(7, 2).Value\n        .Subject = ActiveSheet.Cells(8, 2).Value\n        '.HTMLBody = Sendrng\n        .Save\n    End With\n\n    i = i + 1\n\n    ActiveSheet.Cells(4, 2) = i\n\n    Set outlookMail = Nothing\n    Set outlookApp = Nothing\n\nNext i\n\n'I want to start every time in position 2\nActiveSheet.Cells(4, 2) = 2\n\nEnd Sub\n</code></pre>\n\n<p>Can you explain to me where is missing? I'm getting the following error: Run-time Error 13: Type mismatch</p>\n\n<p>Thanks,\nHenrique</p>\n"}, {"tags": ["excel", "error-handling", "excel-formula", "excel-tables", "vba"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1525911646, "post_id": 50263284, "comment_id": 87545593, "body": "Wrap it in <code>IfError(... , result you want instead of error)</code>"}, {"owner": {"reputation": 3, "user_id": 9718644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccc50339bba460465a4b175e23fc04df?s=128&d=identicon&r=PG&f=1", "display_name": "Kev", "link": "https://stackoverflow.com/users/9718644/kev"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1525913224, "post_id": 50263284, "comment_id": 87545900, "body": "Thanks but can you be more specific? because with if error, i will always stop runing the function if there is any division to zero, but that is not where I want to stop I want to be able to then move to the next item in the list and run the function for the entire table column and get the sumproduct."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9718644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccc50339bba460465a4b175e23fc04df?s=128&d=identicon&r=PG&f=1", "display_name": "Kev", "link": "https://stackoverflow.com/users/9718644/kev"}, "edited": false, "score": 0, "creation_date": 1525950418, "post_id": 50264263, "comment_id": 87560018, "body": "Hi thank you very much, this seems to work with my initial test, only one thing how can I also include the year criteria to the above code to make sure it also takes info from the correct year?"}], "tags": [], "owner": {"reputation": 586, "user_id": 9633414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a17a4ec5f0dbe53ee0a2153b37138b17?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/9633414/j-doe"}, "is_accepted": true, "score": 1, "last_activity_date": 1525996382, "last_edit_date": 1525996382, "creation_date": 1525916247, "answer_id": 50264263, "question_id": 50263284, "link": "https://stackoverflow.com/questions/50263284/div-to-0-handling-excel/50264263#50264263", "title": "div to 0 handling excel", "body": "<p>You are not making this easy but I think I found something suitable :</p>\n\n<p><a href=\"https://i.stack.imgur.com/jkPvZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jkPvZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>Edit:</p>\n\n<p>For DIV 0 Error, using the same set up as above in M9 cell :</p>\n\n<p><code>{=SUMPRODUCT(($J$2:$J$4=$K10)*(M$2:M$4*(IFERROR(SUMIF($B$2:$B$5,$K$2:$K$4,E$2:E$5)/SUMIF($K$2:$K$4,$K$2:$K$4,M$2:M$4),0))))}</code></p>\n\n<p>Validation with CTRL + SHIFT + ENTER</p>\n\n<hr>\n\n<p>Edit 2 :</p>\n\n<p><a href=\"https://i.stack.imgur.com/BW50b.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BW50b.png\" alt=\"enter image description here\"></a></p>\n\n<p><code>=SUMPRODUCT(M$2:M$9,(IFERROR(SUMIFS(E$2:E$17,$A$2:$A$17,$P5,$B$2:$B$17,$K$2:$K$9)/SUMIFS(M$2:M$9,$I$2:$I$9,$P5,$K$2:$K$9,$K$2:$K$9),0))*($I$2:$I$9=$P5)*($J$2:$J$9=$Q5))</code></p>\n\n<p>Validation with CTRL + SHIFT + ENTER</p>\n"}], "owner": {"reputation": 3, "user_id": 9718644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccc50339bba460465a4b175e23fc04df?s=128&d=identicon&r=PG&f=1", "display_name": "Kev", "link": "https://stackoverflow.com/users/9718644/kev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 50264263, "answer_count": 1, "score": 0, "last_activity_date": 1525996382, "creation_date": 1525907305, "last_edit_date": 1531161705, "question_id": 50263284, "link": "https://stackoverflow.com/questions/50263284/div-to-0-handling-excel", "title": "div to 0 handling excel", "body": "<p>So I have this issue, I have two tables one is employees, and another one is the projects.</p>\n\n<p>Employees Table:</p>\n\n<pre><code>Year Name Type Jan Feb    \n2018 Kevin Salary 5000 2000    \n2018 Kevin Insurance 200 400    \n2018 Alex Salary 3000 4000    \n2018 Alex Insurance 300 400\n</code></pre>\n\n<p>Projects Table</p>\n\n<pre><code>Year Project_Name Employee_Name Jan_Hours_Worked Feb_Hours_Worked    \n2018 Apple Alex 7 5    \n2018 Apple Kevin 5 0    \n2018 LG Kevin 0 3\n</code></pre>\n\n<p>Now I am creating a result list of all the projects and costs recurred for them in each month, what I need is for each project in Table 2 to find which employees are involved and then use that info to find costs from the Table 1 and calculate the hourly rate to charge for the projects in each month.</p>\n\n<p>(e.g for project LG, I have Kevin working on that in Feb,for him company paid 2400(salary+insurance) and the hourly rate to charge in Feb then will be 2400 divided by total hours he spends on the project which is 3 hours. </p>\n\n<p>For the project Apple in Feb, it would be Alex's: 4400/5, since Kevin didn't work any hours in Feb in this project. And when both of them works  for example as in Jan for the apple project then it should be Kevin's costs/hours he worked + Alex's costs/hours he worked in that month for that project. </p>\n\n<p>Now I have the formula to calculate this which works fine unless I have the 0 value in the table. </p>\n\n<blockquote>\n  <p>When it comes to the 0 it gives me division to zero error</p>\n</blockquote>\n\n<pre><code>=SUMPRODUCT(SUMIFS(Employees[Feb], Employees[Name],Project[Employee_Name], Employees[Year], 2018 )/Project[Feb_Hours_Worked],--(Project[Project_Name]=K14))\n</code></pre>\n\n<p>How can I alter this formula to make that work for the above scenario without getting error and finding correct result for each month.</p>\n"}, {"tags": ["vba", "excel", "match", "matching"], "comments": [{"owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "edited": false, "score": 0, "creation_date": 1525908213, "post_id": 50263253, "comment_id": 87544802, "body": "So, there will always be <code>key1</code> and <code>key2</code> columns but you don&#39;t know their position, is that correct?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1525917079, "post_id": 50263253, "comment_id": 87546735, "body": "Is this formatted as a table? If so, you could do something like this <code>=IF(AND(ISNA(MATCH([Key1],[Key2],0)),ISNA(MATCH([Key2],[Key1&zwnj;&#8203;],0))),&quot;&quot;,&quot;Yes&quot;)</code>."}, {"owner": {"reputation": 73, "user_id": 5340507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-BqJEJ0Y1fQQ/AAAAAAAAAAI/AAAAAAAAACw/KmRt38AREyA/photo.jpg?sz=128", "display_name": "Arri Ferrari", "link": "https://stackoverflow.com/users/5340507/arri-ferrari"}, "edited": false, "score": 0, "creation_date": 1525968965, "post_id": 50263253, "comment_id": 87570999, "body": "It&#39;s not yet formatted as a table, I don&#39;t know how to do that in VBA. That sounds like it might be the simplest solution. Ahmed has the right idea, that I will always have the columns, but not the position. I do track the column number with an integer."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1525969385, "post_id": 50263253, "comment_id": 87571263, "body": "ListObjects: see <a href=\"https://www.thespreadsheetguru.com/blog/2014/6/20/the-vba-guide-to-listobject-excel-tables\" rel=\"nofollow noreferrer\">here</a> or <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/listobject-object-excel\" rel=\"nofollow noreferrer\">here</a>. Once you have a <code>ListObject</code>, you can reference the <code>ListColumn</code> by its header, bypassing the need to track its position with an integer."}, {"owner": {"reputation": 73, "user_id": 5340507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-BqJEJ0Y1fQQ/AAAAAAAAAAI/AAAAAAAAACw/KmRt38AREyA/photo.jpg?sz=128", "display_name": "Arri Ferrari", "link": "https://stackoverflow.com/users/5340507/arri-ferrari"}, "edited": false, "score": 0, "creation_date": 1525972621, "post_id": 50263253, "comment_id": 87573063, "body": "BigBen&#39;s method worked perfectly! <code>ActiveSheet.ListObjects.Add(xlSrcRange, Range(&quot;$A$1:$E$19&quot;), , xlYes).Name = &quot;Table1&quot;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 1, "last_activity_date": 1525973657, "creation_date": 1525973657, "answer_id": 50278464, "question_id": 50263253, "link": "https://stackoverflow.com/questions/50263253/excel-vba-matching-against-all-cells-in-a-specific-column/50278464#50278464", "title": "Excel VBA Matching against all cells in a specific column", "body": "<p>If you are fine with creating a Table (<code>ListObject</code>) from your data, your MATCH column formula will be <code>=IF(AND(ISNA(MATCH([Key1],[Key2],0)),ISNA(MATCH([Key2],[Key1],0))),\"\",\"Yes\")</code>.</p>\n\n<p>This references the <code>Key1</code> and <code>Key2</code> columns based on their headers, eliminating the problem of a changing number and/or order of columns.</p>\n"}], "owner": {"reputation": 73, "user_id": 5340507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-BqJEJ0Y1fQQ/AAAAAAAAAAI/AAAAAAAAACw/KmRt38AREyA/photo.jpg?sz=128", "display_name": "Arri Ferrari", "link": "https://stackoverflow.com/users/5340507/arri-ferrari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 50278464, "answer_count": 1, "score": 0, "last_activity_date": 1526361719, "creation_date": 1525907130, "last_edit_date": 1526361719, "question_id": 50263253, "link": "https://stackoverflow.com/questions/50263253/excel-vba-matching-against-all-cells-in-a-specific-column", "title": "Excel VBA Matching against all cells in a specific column", "body": "<p>This table is made by pulling a variable number of columns from several workbooks into one. I keep track of the column index for \"Key1\" and \"Key2\" with integers \"i1\" and \"i2\", respectively.</p>\n\n<pre><code>+-------------+-----------+-------------+-----------+-----------+--------+-------------+-----------+-------+\n|  Thisjust   | Indexcode | Specialcode |   Key1    | Indexcode |  Some  | Specialcode |   Key2    | MATCH |\n+-------------+-----------+-------------+-----------+-----------+--------+-------------+-----------+-------+\n| isanexample |       101 |       27223 | 101_27223 |       101 | Values |        1112 | 101_1112  |       |\n| isanexample |       102 |       27224 | 102_27224 |       102 | Values |        1113 | 102_1113  |       |\n| isanexample |       103 |       27225 | 103_27225 |       103 | Values |        1114 | 103_1114  |       |\n| isanexample |       104 |       27226 | 104_27226 |       104 | Values |        1115 | 104_1115  |       |\n| isanexample |       108 |       11130 | 108_11130 |       105 | Values |        1116 | 105_1116  | Yes   |\n| isanexample |       106 |       27228 | 106_27228 |       106 | Values |        1117 | 106_1117  |       |\n| isanexample |       107 |       27229 | 107_27229 |       107 | Values |        1118 | 107_1118  |       |\n| isanexample |       110 |       27227 | 110_27227 |       108 | Values |       11130 | 108_11130 | Yes   |\n| isanexample |       109 |       37345 | 109_37345 |       109 | Values |        1112 | 109_1112  |       |\n| isanexample |       105 |       37346 | 105_37346 |       110 | Values |        1113 | 110_1113  |       |\n| isanexample |       111 |       37347 | 111_37347 |       111 | Values |        1114 | 111_1114  |       |\n| isanexample |       112 |       37348 | 112_37348 |       112 | Values |        1115 | 112_1115  |       |\n| isanexample |       113 |       37349 | 113_37349 |       113 | Values |        1116 | 113_1116  |       |\n| isanexample |       114 |       37350 | 114_37350 |       114 | Values |        1117 | 114_1117  |       |\n| isanexample |       115 |       37351 | 115_37351 |       115 | Values |        1118 | 115_1118  |       |\n| isanexample |       116 |       11138 | 116_11138 |       116 | Values |       11138 | 116_11138 | Yes   |\n| isanexample |       117 |       11139 | 117_11139 |       117 | Values |       11139 | 117_11139 | Yes   |\n| isanexample |       118 |       11140 | 118_11140 |       118 | Values |       11140 | 118_11140 | Yes   |\n+-------------+-----------+-------------+-----------+-----------+--------+-------------+-----------+-------+\n</code></pre>\n\n<p>I am checking if </p>\n\n<p>EITHER key1 in a particular row matches one of the key2 cells </p>\n\n<p>OR if key2 in a particular row matches one of the key1 cells</p>\n\n<p>I used this formula to accomplish that</p>\n\n<pre><code>=IF(AND(ISNA(MATCH(H2,$D$2:$D$19,0)),ISNA(MATCH(D2,$H$2:$H$19,0))),\"\",\"Yes\")\n</code></pre>\n\n<p>Knowing that this whole table could have a wildly different number of columns, and the order of columns is also variable:</p>\n\n<p>How do I do my match function in VBA? The MATCH column will always be at the end. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1525911338, "post_id": 50263106, "comment_id": 87545520, "body": "More code is needed. You are skipping parts where you are assigning values to the variables. Also the .Formula = portions at the end are missing a lot of &quot;&quot; marks. Is this the code you are really using or you just worte it fast for the question?"}, {"owner": {"reputation": 25, "user_id": 9488198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c989ffbd9e79ae67c3277bfad470ff88?s=128&d=identicon&r=PG&f=1", "display_name": "Elliott", "link": "https://stackoverflow.com/users/9488198/elliott"}, "reply_to_user": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1525965005, "post_id": 50263106, "comment_id": 87568741, "body": "I skipped the assignment of the variables LRowE2 and LRowE2 because they match LRowB2 above.  But the .Formula portion is what I am trying to figure out.  I don&#39;t know how or where to place all of the &quot;&quot; properly, or even the proper syntax of the formual to make the equation work."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 9488198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c989ffbd9e79ae67c3277bfad470ff88?s=128&d=identicon&r=PG&f=1", "display_name": "Elliott", "link": "https://stackoverflow.com/users/9488198/elliott"}, "edited": false, "score": 1, "creation_date": 1525968424, "post_id": 50263841, "comment_id": 87570702, "body": "Thank you so much for your help!  I appreciate the notations and explanations on every step you made, it helps me follow what is being done.  Also thank you for showing how you created the error handler, that will be my next step in making sure this spreadsheet is foolproof.  I tried so many different combinations of quotation marks and &amp; symbols to make the syntax work, but it never did.  I now know how to carry this through and update the rest of the cells on my summary page.  Thank you again, have a great day."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 25, "user_id": 9488198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c989ffbd9e79ae67c3277bfad470ff88?s=128&d=identicon&r=PG&f=1", "display_name": "Elliott", "link": "https://stackoverflow.com/users/9488198/elliott"}, "edited": false, "score": 0, "creation_date": 1525990641, "post_id": 50263841, "comment_id": 87581074, "body": "I\u2019m glad you found it helpful. I know how challenging it was for me when trying to find the optimal solutions, and this site was always helpful. A tip about figuring out quotation marks - let Excel tell you the perfect syntax; you probably started out trying to build the formula in VBA and tried to make it work in Excel. I reversed the process: build the formula in Excel, then adapted it to work in VBA"}, {"owner": {"reputation": 25, "user_id": 9488198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c989ffbd9e79ae67c3277bfad470ff88?s=128&d=identicon&r=PG&f=1", "display_name": "Elliott", "link": "https://stackoverflow.com/users/9488198/elliott"}, "edited": false, "score": 0, "creation_date": 1526083273, "post_id": 50263841, "comment_id": 87619874, "body": "I&#39;m not sure I fully understand your suggestion. I built my initial, cell specific formula using the macro recorder. That is actually how I learned how to do most of my coding. I then found this site and a couple others that have helped tremendously. Where I keep running into problems is how to write the syntax when variables are used in formulas and other parts of the code. Variables in VBA are relatively new to me, but it has been fun to learn how to make them work. I appreciate people like yourself that are willing to teach others how to work through these puzzles. Have a great day."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 25, "user_id": 9488198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c989ffbd9e79ae67c3277bfad470ff88?s=128&d=identicon&r=PG&f=1", "display_name": "Elliott", "link": "https://stackoverflow.com/users/9488198/elliott"}, "edited": false, "score": 1, "creation_date": 1526100105, "post_id": 50263841, "comment_id": 87622155, "body": "When building variables from strings we need to match quotation marks carefully. In this particular case, the space in the sheet name forces you to use double quotation marks. If the formula is <code>&#39;Current Billing&#39;</code> this is the quoted string for the Excel Formula, but in VBA we have to build another string which needs quotes as well: <code>&quot;&#39;Current Billing&#39;&quot;</code>. If the sheet name doesn&#39;t have a space we don&#39;t need to quote it in the Formula <code>Sheet1</code>, and in VBA it in: <code>&quot;Sheet1&quot;</code>"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 25, "user_id": 9488198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c989ffbd9e79ae67c3277bfad470ff88?s=128&d=identicon&r=PG&f=1", "display_name": "Elliott", "link": "https://stackoverflow.com/users/9488198/elliott"}, "edited": false, "score": 1, "creation_date": 1526100320, "post_id": 50263841, "comment_id": 87622192, "body": "String variables become more complex when you have to use quotes inside quotes: <code>String with &quot;&quot;double quotations&quot;&quot;</code> can be built with <code>str = &quot;String with &quot;&quot;&quot;&quot;double quotations&quot;&quot;&quot;&quot;&quot;</code>, or <code>str = &quot;String with &quot; &amp; Chr(34) &amp; &quot;&quot;&quot;double quotations&quot;&quot;&quot; &amp; Chr(34)</code>, or <code>str = &quot;String with &quot; &amp; Chr(34) &amp; Chr(34) &amp; &quot;double quotations&quot; &amp; Chr(34) &amp; Chr(34)</code> (I&#39;ll add this note to my answer to make it easier to read)"}, {"owner": {"reputation": 25, "user_id": 9488198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c989ffbd9e79ae67c3277bfad470ff88?s=128&d=identicon&r=PG&f=1", "display_name": "Elliott", "link": "https://stackoverflow.com/users/9488198/elliott"}, "edited": false, "score": 0, "creation_date": 1526314951, "post_id": 50263841, "comment_id": 87685977, "body": "Wow, thank you!  That is the best explanation I have seen on how to build string variables.  That is super helpful.  This info will definitely be going into my notes.  Have a great day."}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 1, "last_activity_date": 1526100498, "last_edit_date": 1526100498, "creation_date": 1525912122, "answer_id": 50263841, "question_id": 50263106, "link": "https://stackoverflow.com/questions/50263106/cell-cross-reference-using-vba/50263841#50263841", "title": "Cell Cross-Reference using VBA", "body": "<p>The syntax of the formula is similar to <code>=SUM('Current Billing'!C9, 'Current Billing'!D9)</code></p>\n\n<p>This will check for errors, and is a bit more dynamic</p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPublic Sub UpdateSummary()\n    Dim wsCB As Worksheet, lrCB As Long, cbCellC As Range, cbCellD As Range\n    Dim wsSummary As Worksheet, sumCell As Range\n\n    Set wsCB = ThisWorkbook.Worksheets(\"Current Billing\")\n    Set wsSummary = ThisWorkbook.Worksheets(\"Summary\")\n\n    lrCB = wsCB.Cells(wsCB.Rows.Count, \"C\").End(xlUp).Row\n\n    'Verify that we have the same last row for col C and D on sheet \"Current Billing\"\n    If wsCB.Cells(wsCB.Rows.Count, \"D\").End(xlUp).Row = lrCB Then\n        Set cbCellC = wsCB.Cells(lrCB, \"C\")     '\"Current Billing\".Cell(lr, C)\n        Set cbCellD = wsCB.Cells(lrCB, \"D\")     '\"Current Billing\".Cell(lr, D)\n        Set sumCell = wsSummary.Cells(2, \"B\")   '\"Summary\".Cell(2, B)\n        sumCell = \"Invalid 'Current Billing' values\"    'Default (in case of errors)\n\n        'Check \"Current Billing\" cells for errors (#N/A, #VALUE!, #REF!, #DIV/0!, etc)\n        If Not IsError(cbCellC) And Not IsError(cbCellD) Then\n\n            'Verify that \"Current Billing\" cells are numbers\n            If IsNumeric(cbCellC) And IsNumeric(cbCellD) Then\n                Dim cbC As String, cbD As String\n\n                cbC = \"'\" &amp; wsCB.Name &amp; \"'!\" &amp; cbCellC.Address(0, 0) 'Current Billing'!C9\n                cbD = \"'\" &amp; wsCB.Name &amp; \"'!\" &amp; cbCellD.Address(0, 0) 'Current Billing'!D9\n\n                'Final format: =SUM('Current Billing'!C9, 'Current Billing'!D9)\n\n                sumCell.Formula = \"=SUM(\" &amp; cbC &amp; \", \" &amp; cbD &amp; \")\"  'Update Summary cell\n            End If\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>If the formula will contain a division, verify that the divisor is not 0</p>\n\n<p>But if you are using VBA for this, you can simplify the syntax: <strong><code>sumCell = cbCellC + cbCellD</code></strong></p>\n\n<hr>\n\n<p>Note:</p>\n\n<p>String variables become more complex when we have to use quotes inside quotes:</p>\n\n<ul>\n<li><p><code>Str with \"\"double quotes\"\"</code> can be built like this</p>\n\n<ul>\n<li><code>str = \"Str with \"\"\"\"double quotes\"\"\"\"\"</code>, or</li>\n<li><code>str = \"Str with \" &amp; Chr(34) &amp; \"\"\"double quotes\"\"\" &amp; Chr(34)</code>, or</li>\n<li><code>str = \"Str with \" &amp; Chr(34) &amp; Chr(34) &amp; \"double quotes\" &amp; Chr(34) &amp; Chr(34)</code></li>\n</ul></li>\n<li><p>This string <code>str = \"Str with 'double quotes'\"</code> is <code>Str with 'double quotes'</code></p></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 9488198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c989ffbd9e79ae67c3277bfad470ff88?s=128&d=identicon&r=PG&f=1", "display_name": "Elliott", "link": "https://stackoverflow.com/users/9488198/elliott"}, "edited": false, "score": 0, "creation_date": 1525968715, "post_id": 50263855, "comment_id": 87570852, "body": "Thank you for the suggestion, however, I&#39;m not sure I fully understand how the event works.  If I&#39;m understanding this properly, does the event check for differences between two sets of cells and then updates the master cell if the supporting cell is different?  If so, I like the process behind how this could work.  It doesn&#39;t quite fit what I need for this spreadsheet because the code will only be run once, and if changes are made after the code is run I would like the changes to be automatically updated.  But I can see potential for this type of code working in other sheets.  Thanks again!"}, {"owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "reply_to_user": {"reputation": 25, "user_id": 9488198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c989ffbd9e79ae67c3277bfad470ff88?s=128&d=identicon&r=PG&f=1", "display_name": "Elliott", "link": "https://stackoverflow.com/users/9488198/elliott"}, "edited": false, "score": 0, "creation_date": 1525982634, "post_id": 50263855, "comment_id": 87577938, "body": "@Elliott, the <code>Workbook_SheetChange</code> event is built into Excel.  It won&#39;t work if you change the name of the sub.  The event is triggered by an actual change to any cell in the workbook or by an event that causes formulas to update, even if no values are changed (for example, entering the formula bar and pressing enter without changing anything).  All of the code inside the sub is what happens when it is triggered but the actual trigger is something behind the scenes that happens when you use a sub called <code>Workbook_SheetChange</code> in your workbook module."}, {"owner": {"reputation": 25, "user_id": 9488198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c989ffbd9e79ae67c3277bfad470ff88?s=128&d=identicon&r=PG&f=1", "display_name": "Elliott", "link": "https://stackoverflow.com/users/9488198/elliott"}, "edited": false, "score": 0, "creation_date": 1525984483, "post_id": 50263855, "comment_id": 87578774, "body": "I still don&#39;t fully understand how it works, but I will definitely be doing some Google searches to learn more about it.  Thanks for the great tip and idea.  Have a great day."}], "tags": [], "owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "is_accepted": false, "score": 0, "last_activity_date": 1525912214, "creation_date": 1525912214, "answer_id": 50263855, "question_id": 50263106, "link": "https://stackoverflow.com/questions/50263106/cell-cross-reference-using-vba/50263855#50263855", "title": "Cell Cross-Reference using VBA", "body": "<p>Use the <code>Workbook_SheetChange</code> event.  It's an \"event\" action that is triggered when changes are made anywhere in your workbook.  Within the event sub add code to update the value of your hard-coded/static cell with the value in your formula.</p>\n\n<p>The <code>Workbook_SheetChange</code> sub must be in your workbook module (the default module name is \"ThisWorkbook\").</p>\n\n<p>Here's an example of how you could use it.  Just update the sheet names and range addresses for the variables <code>myStaticCell</code> and <code>myFormulaCell</code>.</p>\n\n<h2>In your ThisWorkbook Module:</h2>\n\n<pre><code>Option Explicit\n\nPublic myVar As Variant ' stores last known value of static cell\n\nPrivate Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n\n    ' Define the locations of your formula cell and static cell.\n    Dim myStaticCell As Range\n    Dim myFormulaCell As Range\n    Set myStaticCell = Worksheets(\"Sheet2\").Range(\"A2\")\n    Set myFormulaCell = Worksheets(\"Sheet1\").Range(\"A2\")\n\n    ' Ignore changes made directly to the static cell by comparing\n    '   the sheet name and address where the workbook change\n    '   occurred (variables Sh and Target which are built into the\n    '   Workbook_SheetChange event) with the sheet name and address\n    '   of your static cell.\n    If Sh.Name = myStaticCell.Parent.Name And _\n            Target.Address = myStaticCell.Address Then Exit Sub\n\n    ' Save the value to a public variable so it can\n    '   be checked the next time something changes.\n    myVar = myFormulaCell.Value\n\n    ' If different, update the static cell with the\n    '   value from your formula.\n    If myStaticCell &lt;&gt; myVar Then myStaticCell = myFormulaCell.Value\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 9488198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c989ffbd9e79ae67c3277bfad470ff88?s=128&d=identicon&r=PG&f=1", "display_name": "Elliott", "link": "https://stackoverflow.com/users/9488198/elliott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 686, "favorite_count": 0, "accepted_answer_id": 50263841, "answer_count": 2, "score": 2, "last_activity_date": 1526100498, "creation_date": 1525906058, "last_edit_date": 1525906417, "question_id": 50263106, "link": "https://stackoverflow.com/questions/50263106/cell-cross-reference-using-vba", "title": "Cell Cross-Reference using VBA", "body": "<p>I have done some searching and cannot figure out the syntax for what I would like to accomplish.  I would like to have a specific, static cell on a Summary sheet automatically update to a dynamic cell on a different worksheet.  I started with the following code:</p>\n\n<pre><code>Sheets(\"Summary\").Activate\nRange(\"B1\").Select\nActiveCell.FormulaR1C1 = \"='Current Billing'!R[46]C\"\nRange(\"B2\").Select\nActiveCell.FormulaR1C1 = _\n    \"='Current Billing'!R[45]C[3]+'Current Billing'!R[45]C[4]\"\n</code></pre>\n\n<p>After getting some advice on a different topic for this same workbook, I now know .Select is a no-no and should be avoided.  I also know that my last row on the \"Current Billing\" worksheet will change when I copy the code to another workbook for billing that project.  This has led to me to modify my code to make it more fool-proof and versatile.  </p>\n\n<p>I have figured out how to get the the cell value to insert from my \"Current Billing\" sheet to my \"Summary\" sheet.  But if something changes on the \"Current Billing\" sheet, the \"Summary\" sheet will not automatically update.  This is the code I have that sort of works:</p>\n\n<pre><code>Dim ws5 As Worksheet\n'ws5 is \"Current Billing\"\nDim ws6 As Worksheet\n'ws6 is \"Summary\"\nDim LRowB2 As Long\nDim LRowB3 As String\nLRowB2 = ws5.Cells(Rows.Count, \"B\").End(xlUp).Row\nLRowB3 = ws5.Cells(LRowB2, \"B\")\nws6.Cells(1, \"B\").Formula = LRowB3\n</code></pre>\n\n<p>I tried these two code sequences, but kept getting errors:</p>\n\n<pre><code>Dim LRowB4 As String\nDim LRowE2 As Long\nDim LRowF2 As Long\n\nLRowB4 = \"= &amp; ws5 &amp; ! &amp; LRowB3\"\nws6.Cells(2, \"B\").Formula = \"=sum(&amp; LRowE2 &amp;,&amp; LRowF2 &amp;)\"\n</code></pre>\n\n<p>In short, is there a way to mimic the function of the first code procedure, but have the stability and fool-proofness of the second procedure?  And, is there a way to integrate a =Sum() formula into the second procedure so I can add two cells from \"Current Billing\" on the \"Summary\" page?  Thanks for the help!</p>\n"}, {"tags": ["vba", "excel", "copy-paste"], "comments": [{"owner": {"reputation": 2237, "user_id": 8347081, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C2gg5Z3zU2w/AAAAAAAAAAI/AAAAAAAABXE/M2GK2Eixhms/photo.jpg?sz=128", "display_name": "mypetlion", "link": "https://stackoverflow.com/users/8347081/mypetlion"}, "edited": false, "score": 1, "creation_date": 1525909642, "post_id": 50262655, "comment_id": 87545106, "body": "And what&#39;s going wrong with your attempts? How does the actual result differ from what you want/expect to happen?"}, {"owner": {"reputation": 1, "user_id": 9767526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f60658d801e1e4a6d2f7028c9449d7?s=128&d=identicon&r=PG&f=1", "display_name": "Tchen006", "link": "https://stackoverflow.com/users/9767526/tchen006"}, "reply_to_user": {"reputation": 2237, "user_id": 8347081, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C2gg5Z3zU2w/AAAAAAAAAAI/AAAAAAAABXE/M2GK2Eixhms/photo.jpg?sz=128", "display_name": "mypetlion", "link": "https://stackoverflow.com/users/8347081/mypetlion"}, "edited": false, "score": 0, "creation_date": 1526940295, "post_id": 50262655, "comment_id": 87927934, "body": "I was working on this again. Changed my code and got the first 2 parts to work. What is wrong w my attempts now is that I can&#39;t get it to go back and copy the next 40 rows onto a new workbook. I suspect I am on the right track but the <i>DoUntil</i> loop is placed in the wrong area. Thank you for asking."}], "owner": {"reputation": 1, "user_id": 9767526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f60658d801e1e4a6d2f7028c9449d7?s=128&d=identicon&r=PG&f=1", "display_name": "Tchen006", "link": "https://stackoverflow.com/users/9767526/tchen006"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1526940079, "creation_date": 1525903210, "last_edit_date": 1526940079, "question_id": 50262655, "link": "https://stackoverflow.com/questions/50262655/excel-vba-copy-and-paste-specific-of-rows-and-new-workbook", "title": "Excel VBA Copy and Paste Specific # of Rows and New Workbook", "body": "<p>I have a Master Sheet called <code>ContactsforEmails</code> from this workbook, I am copying the header into every new workbook.</p>\n\n<p>Then, I am copying and pasting every 40 rows starting at <code>A2</code> until <code>I</code> column. The new workbook is saved and closed. Then I want to loop back create another new Workbook name it \"EmailList(next number)\" and so copy the next 40. Then run till the next cell in the <code>A</code> column is blank.</p>\n\n<p>I have managed to copy the header,save as a new document,and copy the first 40.\nI haven't figured out how to make it loop correctly, I suspect it is with <em>DoUntil</em> loop and <em>Offset</em>. But I am hoping someone more advanced in this can advise. </p>\n\n<p>The error I run into is \"Run-time error 9: Subscript out of range.\"</p>\n\n<p>Here is my attempt:</p>\n\n<pre><code>'Copy Header\n   Range(\"A1\").Select\n   Range(Selection, Selection.End(xlToRight)).Select\n   Selection.Copy\n   Workbooks.Add\n   ActiveSheet.Paste\n   Selection.PasteSpecial Paste:=xlPasteColumnWidths, Operation:=xlNone, _\n   SkipBlanks:=False, Transpose:=False\n   Rows(\"1:1\").EntireRow.AutoFit\n\n'Save File As New Name\n   Dim fpath As String\n   Dim fcount As Integer\n   Dim fname As String\n   Do While Len(Dir(fpath &amp; fname)) &lt;&gt; 0\n     fpath = \"C:\\Users\\Path\\\"\n     fcount = fcount + 1\n     fname = \"EmailList\" &amp; fcount &amp; \".xlsx\"\n   Loop\n   ActiveWorkbook.SaveAs Filename:=fpath &amp; fname\n'Copy and Paste 40\n  Windows(\"ContactsForEmails.xlsx\").Activate\n    Dim fcopy As Range\n    Set fcopy = Range(\"A2:H41\")\n    fcopy.Select\n    Selection.Copy\n    Windows(fname).Activate\n    Range(\"A2\").Select\n    ActiveSheet.Paste\n    ActiveWorkbook.Save\n    ActiveWorkbook.Close\n\n    Do Until IsEmpty(fcopy)\n     fcopy.Offset(40, 0).Select\n     Selection.Copy\n     Windows(fname).Activate\n     Range(\"A2\").Select\n     ActiveSheet.Paste\n     ActiveWorkbook.Save\n     ActiveWorkbook.Close\n   Loop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1526259219, "post_id": 50262556, "comment_id": 87659621, "body": "The number and order is OS dependent, but not sure if on the OS where the folder is created or maybe where the partition is formatted. On Windows 10 they are up to 315, on Vista less than 300, and on XP a lot less. <code>If objFolder.GetDetailsOf(, propertyCnt) = &quot;&quot;</code> is enough to check for the last property. The only exception that I know of that has value but no name is -1."}, {"owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1526259831, "post_id": 50262556, "comment_id": 87659721, "body": "Thanks for feedback on how it looks on different systems. I have Windows 7 and it&#39;s 0 to 299. From about 290 there are 4 empty names."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1526260901, "post_id": 50262556, "comment_id": 87659894, "body": "Ah yes, I get a lot of missing property names at -1, 54,165 to 166, 200 to 202, 213, 291, and from 316. I am not aware of any better way to get the properties count."}, {"owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1526261134, "post_id": 50262556, "comment_id": 87659930, "body": "I posted an idea in my answer, we can assume there won&#39;t be more than for example 500 properties and go backwards to check last populated name on one of folders, as  <code>GetDetailsOf</code> doesn&#39;t limit the index parameter."}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1526132862, "post_id": 50266846, "comment_id": 87629757, "body": "Any feedback on this? I put some effort into writing for you."}, {"owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "edited": false, "score": 0, "creation_date": 1526150447, "post_id": 50266846, "comment_id": 87635003, "body": "I appreciate it, but I don&#39;t always have time to do full tests during workweek. I&#39;m a rather meticulous person and didn&#39;t want to respond or mark as an answer until I have checked all the aspects."}, {"owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "edited": false, "score": 0, "creation_date": 1526153258, "post_id": 50266846, "comment_id": 87635738, "body": "No problem about downvote, what I really care about is to get solution and You already committed some time to help me. The link is very helpful, now I know where do all fixed number property checks in internet codes come from. Unfortunately I could be not clear enough, I&#39;ve put an edit to my initial post. What I seek is to go past these properties listed in documentation, because there are many more and see how many of them (not values, property names) there are and if this number varies depending on the folder. Thanks to the link I&#39;m sure that these start properties will always be same."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "edited": false, "score": 0, "creation_date": 1526153424, "post_id": 50266846, "comment_id": 87635786, "body": "Ah... so there are more than 35 properties? Can you give an example of one please? Or are you referring to not just &quot;extended&quot; properties but all properties of a file?"}, {"owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "edited": false, "score": 0, "creation_date": 1526153590, "post_id": 50266846, "comment_id": 87635835, "body": "The names vary depending on local language for machine. You can use safely perhaps any long value &gt;=0 to list them. On test folder I has about 300 of them displayed. My main issue is that I can enter index = 500 and macro will still go on and list all non-existing properties as null strings. I&#39;m not sure what is exact scope of Extended Properties, but I would like to get all properties obtainable with <code>GetDetailsOf</code> method."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "edited": false, "score": 0, "creation_date": 1526153787, "post_id": 50266846, "comment_id": 87635901, "body": "Are you referring specifically to extended properties of a file ?"}, {"owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "edited": false, "score": 1, "creation_date": 1526154320, "post_id": 50266846, "comment_id": 87636064, "body": "I will attach my current file, so that I don&#39;t keep You guessing. Main function of interest is CountProperties in list_properties module. It decides on how many property columns will be returned. You can test with setting it arbitrarily to let&#39;s 300 and see the difference, because now the counter stops whenever property name is empty, but this is a trap, after a while there are another property names."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "edited": false, "score": 0, "creation_date": 1526205114, "post_id": 50266846, "comment_id": 87645472, "body": "I see where you are coming from. See this: <a href=\"http://www.cpearson.com/excel/DocProp.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/DocProp.aspx</a> There were also a lot of  other things I noticed with your code so you might consider the following tool as helpful to inspect your code: <a href=\"http://rubberduckvba.com/\" rel=\"nofollow noreferrer\">rubberduckvba.com</a>"}, {"owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "edited": false, "score": 0, "creation_date": 1526249510, "post_id": 50266846, "comment_id": 87658040, "body": "I&#39;ve checked the 1st link before doing my own code actually, but I always refuse all solutions using external files, because of problems which can appear on different machines and usually required TeamViewer assistance when my non-IT Client has no clue what to do when what he gets is not a single Excel file. I&#39;ve added as an answer what I found out during some checks."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 2, "last_activity_date": 1526060143, "last_edit_date": 1526060143, "creation_date": 1525933772, "answer_id": 50266846, "question_id": 50262556, "link": "https://stackoverflow.com/questions/50262556/vba-get-all-file-properties/50266846#50266846", "title": "VBA - get all file properties", "body": "<p>I am not entirely clear what the end goal of this is but the following should extract all the info you need.</p>\n\n<p>Includes: Count of total set properties by file, folder count of set properties , each file's extended properties values and whether all files in a folder have the same number of properties with assigned values. I'd probably re-factor the function but await your feedback. </p>\n\n<p><strong>Note:</strong> </p>\n\n<p>I chose an array to be returned as I thought you might end up comparing folders and this way you can simply create a collection/dictionary of the returned arrays using the folder paths as keys. You can then access and compare items within the arrays across folders.</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Option Explicit\n\n''******************************************************************\n'' folderInfo returns:\n'' folderInfo(0) = PATH_FOLDER - folder path used\n'' folderInfo(1) = AllFileProperties - Dictionary of arrays containing all the file properties of each file within the folder\n'' folderInfo(2) = totalPropertiesSetInFolder - total count of extended properties &lt;&gt; vbNullString in the folder\n'' folderInfo(3) = filePropertyCounts - dictionary of each file with its respective set property count\n'' folderInfo(4) = AllFilesHaveSamePropertyCount - Boolean to say if all files in folder have same # extended properties set\n\n''******************************************************************\nPublic Sub test()\n\n    Const PATH_FOLDER As String = \"C:\\Users\\User\\Desktop\\TestFolder\\\"\n    Dim resultsArray()\n    resultsArray() = folderInfo(PATH_FOLDER) '&lt;== All the info is now returned here\n\n''***************************************************************************************\n       '' Examples of extracting the retrieved information from the array\n\n''***************************************************************************************    \n\n    'Example: folderInfo(0) = folderPath\n    Debug.Print \"Folderpath = \" &amp; resultsArray(0)\n    Debug.Print String$(20, Chr$(60))\n    Debug.Print vbNewLine\n\n''***************************************************************************************\n\n    'Example: folderInfo(1) = AllFileProperties\n    Debug.Print \"AllFileProperties:\"\n    Dim dict As Object\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n    Set dict = resultsArray(1)\n\n    Dim key As Variant, arr(), i As Long\n\n    For Each key In dict.keys\n        Debug.Print \"FileName = \" &amp; key\n        arr() = dict(key)\n        For i = LBound(arr, 1) To UBound(arr, 1)\n            Debug.Print arr(i, 1), arr(i, 2)\n        Next i\n\n        Debug.Print String$(20, Chr$(60))\n        Debug.Print vbNewLine\n    Next key\n\n''***************************************************************************************\n\n    ''Example: folderInfo(2) = totalPropertiesSetInFolder\n    MsgBox \"Total properties set in folder = \" &amp; resultsArray(2)\n\n\n''***************************************************************************************\n\n    ''Example: folderInfo(3) = filePropertyCounts\n    Dim dict2 As Object\n    Set dict2 = CreateObject(\"Scripting.Dictionary\")\n    Set dict2 = resultsArray(3)\n\n    Dim key2 As Variant\n\n    For Each key2 In dict2.keys\n        Debug.Print key2 &amp; \" set property count = \" &amp; dict2(key2)\n    Next key2\n\n''***************************************************************************************\n    ''Example: folderInfo(4) = AllFilesHaveSamePropertyCount\n    MsgBox \"All files have the same # of set properties? = \" &amp; resultsArray(4)\n\nEnd Sub\n\nPublic Function folderInfo(ByVal PATH_FOLDER As String) As Variant\n\n    Dim objShell As Object\n    Dim objFolder As Object\n\n    Set objShell = CreateObject(\"Shell.Application\")\n    Set objFolder = objShell.Namespace(Left$(PATH_FOLDER, Len(PATH_FOLDER) - 1))\n\n    'Retrieving Extended File Properties\n    Dim i As Long\n    Dim arrHeaders(35)\n\n    For i = 0 To 34\n        arrHeaders(i) = objFolder.GetDetailsOf(objFolder.items, i)\n    Next\n\n    Dim fileName As Object, setPropertyCount As Long, filePropertyCounts As Object, totalPropertiesSetInFolder As Long\n    Set filePropertyCounts = CreateObject(\"Scripting.Dictionary\")\n    Dim AllFileProperties As Object\n    Set AllFileProperties = CreateObject(\"Scripting.Dictionary\")\n\n    For Each fileName In objFolder.items\n        setPropertyCount = 0\n        Dim fileProperties(0 To 35, 0 To 35)\n        fileProperties(0, 0) = fileName\n        For i = 0 To 34\n            If objFolder.GetDetailsOf(fileName, i) &lt;&gt; vbNullString Then setPropertyCount = setPropertyCount + 1\n             fileProperties(i + 1, 1) = arrHeaders(i)\n             fileProperties(i + 1, 2) = objFolder.GetDetailsOf(fileName, i)\n\n            '            Debug.Print i &amp; vbTab &amp; arrHeaders(i) _\n            '                      &amp; \": \" &amp; objFolder.GetDetailsOf(fileName, i)\n            '            Debug.Print vbNewLine\n        Next i\n        'Debug.Print fileName &amp; \": setpropertyCount = \" &amp; setPropertyCount\n        filePropertyCounts.Add fileName.Name, setPropertyCount\n\n        AllFileProperties.Add fileName.Name, fileProperties\n    Next fileName\n\n    totalPropertiesSetInFolder = Application.WorksheetFunction.Sum(filePropertyCounts.items)\n\n    folderInfo = Array(PATH_FOLDER, AllFileProperties, totalPropertiesSetInFolder, filePropertyCounts, AllFilesHaveSamePropertyCount(filePropertyCounts))\n\nEnd Function\n\nPublic Function AllFilesHaveSamePropertyCount(ByVal filePropertyCounts As Object) As Boolean\n\n    AllFilesHaveSamePropertyCount = True\n    Dim key As Variant\n\n    For Each key In filePropertyCounts.Keys\n        If filePropertyCounts(key) &lt;&gt; Application.WorksheetFunction.Max(filePropertyCounts.items) Then\n            AllFilesHaveSamePropertyCount = False\n            Exit Function\n        End If\n    Next key\n\nEnd Function\n</code></pre>\n\n<p><strong>Example run:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/J0ysl.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/J0ysl.gif\" alt=\"Example run\"></a></p>\n\n<p><strong>Reference:</strong></p>\n\n<p><a href=\"https://technet.microsoft.com/en-us/library/ee176615.aspx\" rel=\"nofollow noreferrer\">https://technet.microsoft.com/en-us/library/ee176615.aspx</a></p>\n"}, {"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1526278620, "post_id": 50321024, "comment_id": 87663822, "body": "Interesting. What does 4 empty string names mean? Are these particular fields?"}, {"owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1526301672, "post_id": 50321024, "comment_id": 87677100, "body": "I have just realized that these 4 empty strings separate names in language according to my regional settings and 9 other names in English."}], "tags": [], "owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "is_accepted": true, "score": 0, "last_activity_date": 1526260036, "last_edit_date": 1526260036, "creation_date": 1526249090, "answer_id": 50321024, "question_id": 50262556, "link": "https://stackoverflow.com/questions/50262556/vba-get-all-file-properties/50321024#50321024", "title": "VBA - get all file properties", "body": "<p>After running some code to learn more about file properties obtained via <code>GetDetailsOf</code>, especially checking property names of thousands of folders on C, here is what I've found out (Windows 7):</p>\n\n<ul>\n<li>Number of property names is constant for all these folders and all of them appear in the same order.</li>\n<li>The maximum index of non-empty string property was 299 (0 to 299). There were 4 empty string names several indices near the end. @Slai claims that the number varies depending on Windows version, as new are added with another releases or updates.</li>\n</ul>\n\n<p>I think that checking one folder with <code>GetDetailsOf</code> let's say from 500 to 0 and seeing index of 1st not empty name would be the way to find last index.</p>\n\n<p>I would however recommend getting only needed properties, because processing time depends heavily on file type and while for some 50 GB directories containing 1500 files I could get 300 property values for all files in a few seconds, a directory with even less files, but all mp3, took minutes. </p>\n"}], "owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7622, "favorite_count": 0, "accepted_answer_id": 50321024, "answer_count": 2, "score": 2, "last_activity_date": 1578651769, "creation_date": 1525902571, "last_edit_date": 1578651769, "question_id": 50262556, "link": "https://stackoverflow.com/questions/50262556/vba-get-all-file-properties", "title": "VBA - get all file properties", "body": "<p>I want to get properties from all files in a folder. I have this already working for a fixed number of properties, my only concern is to find the last property's index, used in <code>GetDetailsOf</code> method, so that I can have all properties listed.</p>\n\n<p>Function below returns count of properties, but is incorrect, because it's based on last non-empty property name. There are however a few indices with empty names (not sure if they can have values), followed by another indices which have property name with normal string.</p>\n\n<p>I also tried <code>On Error Resume Next</code> with error indicating that last index has already been used, but there never was an error and it resulted in an endless loop, apparently <code>GetDetailsOf</code> will accept every long >=0.</p>\n\n<p>I would also like to know if the number of file properties is the same for each folder on one machine.</p>\n\n<p>EDIT: I may have not clearly expressed it, what I want is to get index of last property name, so that I can check values for all existing properties.</p>\n\n<p>EDIT 2: Here's a link to my file, listing properties for all files in selected folder and subfolders of all levels. There may be some not handled bugs (I already sorted one with shortcuts crashing macro), Windows path length limit comes to my mind, but it will in general work for selected folder.</p>\n\n<p>Main function of interest is CountProperties in list_properties module. It decides on how many property columns will be returned.</p>\n\n<p><a href=\"https://drive.google.com/open?id=1TRIZJoGnHXs9LJtxDBj9rp27ngkects-\" rel=\"nofollow noreferrer\">https://drive.google.com/open?id=1TRIZJoGnHXs9LJtxDBj9rp27ngkects-</a></p>\n\n<pre><code>Function CountProperties(ByRef FldPath) As Long\n\nDim objShell As Object\nDim objFolder As Object\nDim testStr As String\nDim propertyCnt As Long\n\nSet objShell = CreateObject(\"Shell.Application\")\nSet objFolder = objShell.Namespace(Left(FldPath, Len(FldPath) - 1)) 'no slash in the end\n\nDo\n    testStr = vbNullString      \n    testStr = objFolder.GetDetailsOf(objFolder.Items, propertyCnt)      \n    If testStr = vbNullString Then Exit Do\n    propertyCnt = propertyCnt + 1\nLoop\n\nCountProperties = propertyCnt\n\nEnd Function\n</code></pre>\n"}, {"tags": ["html", "excel", "vba", "object", "runtime-error"], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 5956443, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/8550eea72361e9a4e9f5da7b9cf8ceb5?s=128&d=identicon&r=PG", "display_name": "Wells", "link": "https://stackoverflow.com/users/5956443/wells"}, "edited": false, "score": 0, "creation_date": 1525901639, "post_id": 50262340, "comment_id": 87542845, "body": "Literally was editing that as you posted. Still an error. If I remove the .value it works, but I need that to enter my login ID."}, {"owner": {"reputation": 7231, "user_id": 4915798, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb8af3ae95300addb5dfa2e6cb5940c3?s=128&d=identicon&r=PG&f=1", "display_name": "afonso", "link": "https://stackoverflow.com/users/4915798/afonso"}, "reply_to_user": {"reputation": 83, "user_id": 5956443, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/8550eea72361e9a4e9f5da7b9cf8ceb5?s=128&d=identicon&r=PG", "display_name": "Wells", "link": "https://stackoverflow.com/users/5956443/wells"}, "edited": false, "score": 0, "creation_date": 1525901750, "post_id": 50262340, "comment_id": 87542883, "body": "That&#39;s because you are instantiating an object. See edited answer."}], "tags": [], "owner": {"reputation": 7231, "user_id": 4915798, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb8af3ae95300addb5dfa2e6cb5940c3?s=128&d=identicon&r=PG&f=1", "display_name": "afonso", "link": "https://stackoverflow.com/users/4915798/afonso"}, "is_accepted": false, "score": 0, "last_activity_date": 1525901796, "last_edit_date": 1525901796, "creation_date": 1525901334, "answer_id": 50262340, "question_id": 50262242, "link": "https://stackoverflow.com/questions/50262242/object-doesnt-support-this-property-or-method-runtime-error-438-using-vba-to/50262340#50262340", "title": "object doesn&#39;t support this property or method (runtime error 438) using VBA to link to IE", "body": "<p>Try this:</p>\n\n<pre><code>Set ObjCollection = .Document.getElementByID(\"ID\")\nObjCollection.Value = \"insert login ID\"\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 5956443, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/8550eea72361e9a4e9f5da7b9cf8ceb5?s=128&d=identicon&r=PG", "display_name": "Wells", "link": "https://stackoverflow.com/users/5956443/wells"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 488, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525901796, "creation_date": 1525900850, "last_edit_date": 1525901427, "question_id": 50262242, "link": "https://stackoverflow.com/questions/50262242/object-doesnt-support-this-property-or-method-runtime-error-438-using-vba-to", "title": "object doesn&#39;t support this property or method (runtime error 438) using VBA to link to IE", "body": "<pre><code>Sub wpieautologin()\nDim ie As SHDocVw.InternetExplorer\nDim ObjCollection As Object\nSet ie = New SHDocVw.InternetExplorer\nWith ie\n.Visible = True\n.Navigate \"website name\"\nDo\nDoEvents\nLoop Until .ReadyState = 4\nSet ObjCollection = .Document.getElementByID(\"ID\").Value = \"insert login \nID\"\n</code></pre>\n\n<p>I'm trying to enter login information to a website using VBA, but I'm getting this error message. I'm using excel 2016. Any ideas?</p>\n\n<p>Error is on last line</p>\n"}, {"tags": ["string", "excel", "function", "vba"], "comments": [{"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 2, "creation_date": 1525901373, "post_id": 50262070, "comment_id": 87542767, "body": "Putting your code in a normal module made it run correctly for me. TestDynamic 1, 2 and 3 worked and the non-existent TestDynamic4 caused an error as expected"}, {"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1526390639, "post_id": 50262070, "comment_id": 87718645, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/19845944/dynamic-function-calls-in-excel-vba\">Dynamic Function Calls in Excel VBA</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "is_accepted": false, "score": -1, "last_activity_date": 1525902014, "creation_date": 1525902014, "answer_id": 50262464, "question_id": 50262070, "link": "https://stackoverflow.com/questions/50262070/how-do-i-reference-a-function-using-its-name-in-a-string/50262464#50262464", "title": "How do I reference a function using its name in a string", "body": "<p>You have some naming inconsistencies...</p>\n\n<p>Also using 'test' as a function doesn't work</p>\n\n<pre><code>Sub testSub()\n    '*... some code here ...*\n    testFunction \"test1\"\nEnd Sub\n\nFunction testFunction(functionName As String)\n    Application.Run functionName\nEnd Function\n\nFunction test1()\n    Debug.Print \"This function works\"\nEnd Function\n</code></pre>\n\n<blockquote>\n  <p>Note: OP references the following code: <a href=\"https://stackoverflow.com/questions/19845944/dynamic-function-calls-in-excel-vba\">Dynamic Function Calls in Excel VBA</a></p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 9767406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78cf4d46d0e498af0979fccf3a08b812?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Dean", "link": "https://stackoverflow.com/users/9767406/michael-dean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1525902014, "creation_date": 1525900049, "last_edit_date": 1531164843, "question_id": 50262070, "link": "https://stackoverflow.com/questions/50262070/how-do-i-reference-a-function-using-its-name-in-a-string", "title": "How do I reference a function using its name in a string", "body": "<p>I am looking to make reference to a function using only a string that contains the function's name. I have looked at callbyname and application.run but I am unsure as to where I am going wrong.</p>\n\n<p>Any thoughts?</p>\n\n<pre><code>Option Explicit\n\nPublic Sub TestDynamic1()\n  Debug.Print \"TestDynamic 1\"\nEnd Sub\n\nSub TestDynamic2()\n  Debug.Print \"TestDynamic 2\"\nEnd Sub\n\nPrivate Sub TestDynamic3()\n  Debug.Print \"TestDynamic 3\"\nEnd Sub\n\nSub callTestDynamic(i As Integer)\n  On Error GoTo DynamicCallError\n  Application.Run \"TestDynamic\" &amp; i\n  Exit Sub\nDynamicCallError:\n  Debug.Print \"Failed dynamic call: \" &amp; Err.Description\nEnd Sub\n\nPublic Sub TestMe()\n  callTestDynamic 1\n  callTestDynamic 2\n  callTestDynamic 3\n  callTestDynamic 4\nEnd Sub\n</code></pre>\n\n<p>All I get are the errors saying that the macros do not exist.</p>\n\n<p>What I want to be able to do is</p>\n\n<pre><code>function testFunction(functionName as string)\n    run functionName\nend function\n\nsub testSub()\n    *... some code here ...*\n    testFunction \"test\"\nend sub\n\nfunction test()\n    debug.print \"This function works\"\nend function\n</code></pre>\n\n<p>Any help anyone can give would be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba", "insert", "rows"], "answers": [{"comments": [{"owner": {"reputation": 1229, "user_id": 3161253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/860baa703ae4165a5b42f945d10feec7?s=128&d=identicon&r=PG&f=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/3161253/sean"}, "edited": false, "score": 0, "creation_date": 1525922652, "post_id": 50264981, "comment_id": 87547939, "body": "Nice. Do you think @Derek would want some comments to understand what&#39;s going on? If you don&#39;t know about row/column notation or ranges, there&#39;s a lot going on. ;)"}, {"owner": {"reputation": 254, "user_id": 9651005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156222119417368/picture?type=large", "display_name": "Lee Li Fong", "link": "https://stackoverflow.com/users/9651005/lee-li-fong"}, "reply_to_user": {"reputation": 1229, "user_id": 3161253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/860baa703ae4165a5b42f945d10feec7?s=128&d=identicon&r=PG&f=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/3161253/sean"}, "edited": false, "score": 1, "creation_date": 1525923136, "post_id": 50264981, "comment_id": 87548058, "body": "R=11     &#39;the first row to paste the data For each cell in Range(Range(&quot;C2&quot;),  Range(&quot;C2&quot;).End(xlDown))    &#39;cells C2 to last cell down i=0 Do     Cells(R,1).value=cell.offset(0, -2).value   &#39;Test Data     Cells(R,2).value=cell.offset(0, -1).value   &#39;Time Data     Cells(R,2).value=cell.offset(0, i).value      &#39;Data      R=R+1     &#39;add 1 row down if have more data       i=i+1       &#39;i refer Data value to the right Loop until cell.offset(0,i).value=&quot;&quot; Next"}, {"owner": {"reputation": 6861, "user_id": 1594286, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1c31013ccab64b0efbc9b18236d80ac1?s=128&d=identicon&r=PG", "display_name": "Shadow", "link": "https://stackoverflow.com/users/1594286/shadow"}, "edited": false, "score": 0, "creation_date": 1525924770, "post_id": 50264981, "comment_id": 87548505, "body": "Thanks for the clarification. Can you please edit this into your answer? That way you can format and align your extra information neatly."}], "tags": [], "owner": {"reputation": 254, "user_id": 9651005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156222119417368/picture?type=large", "display_name": "Lee Li Fong", "link": "https://stackoverflow.com/users/9651005/lee-li-fong"}, "is_accepted": false, "score": 0, "last_activity_date": 1525922484, "creation_date": 1525922484, "answer_id": 50264981, "question_id": 50261935, "link": "https://stackoverflow.com/questions/50261935/excel-vba-loop-through-worksheek-insert-a-new-row-when-there-are-multiple-value/50264981#50264981", "title": "Excel VBA loop through worksheek, insert a new row when there are multiple values for data, keeping the rest of the information the same", "body": "<pre><code>R=11\nFor each cell in Range(Range(\"C2\"), \nRange(\"C2\").End(xlDown))\ni=0\nDo\n    Cells(R,1).value=cell.offset(0, -2).value\n    Cells(R,2).value=cell.offset(0, -1).value\n    Cells(R,2).value=cell.offset(0, i).value\n    R=R+1\n     i=i+1\nLoop until cell.offset(0,i).value=\"\"\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 254, "user_id": 9651005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156222119417368/picture?type=large", "display_name": "Lee Li Fong", "link": "https://stackoverflow.com/users/9651005/lee-li-fong"}, "is_accepted": false, "score": 0, "last_activity_date": 1525938297, "creation_date": 1525938297, "answer_id": 50268024, "question_id": 50261935, "link": "https://stackoverflow.com/questions/50261935/excel-vba-loop-through-worksheek-insert-a-new-row-when-there-are-multiple-value/50268024#50268024", "title": "Excel VBA loop through worksheek, insert a new row when there are multiple values for data, keeping the rest of the information the same", "body": "<pre><code>R=11 'the first row to paste the data \nFor each cell in _\n     Range(Range(\"C2\"),Range(\"C2\").End(xlDown))\n      'cells C2 to last cell down\ni=0 \nDo \n    Cells(R,1).value=cell.offset(0, -2).value 'Test Data \n    Cells(R,2).value=cell.offset(0, -1).value 'Time Data \n    Cells(R,2).value=cell.offset(0, i).value 'Data\n    R=R+1    'add 1 row down if have more data\n    i=i+1      'i refer Data value to the right \n Loop until cell.offset(0,i).value=\"\" \n Next \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9767354, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Derek WILLIAMS", "link": "https://stackoverflow.com/users/9767354/derek-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 478, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1525938297, "creation_date": 1525899445, "last_edit_date": 1592644375, "question_id": 50261935, "link": "https://stackoverflow.com/questions/50261935/excel-vba-loop-through-worksheek-insert-a-new-row-when-there-are-multiple-value", "title": "Excel VBA loop through worksheek, insert a new row when there are multiple values for data, keeping the rest of the information the same", "body": "<p>I currently have a large set of information, its size varies. The last piece of data may span 1 column, 0 columns, or many columns.</p>\n<p>I need a row for each individual piece of data, and for all of the data to be in the same column.</p>\n<p><a href=\"https://i.stack.imgur.com/7dUmw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7dUmw.png\" alt=\"This image shows an example of the original data and expected outcome\" /></a></p>\n<p>I have no idea how to solve this problem.</p>\n"}, {"tags": ["excel", "vba", "textbox"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1525901149, "post_id": 50261864, "comment_id": 87542674, "body": "Yes it&#39;s possible (!) - but for clarity can you share your code?"}, {"owner": {"reputation": 75, "user_id": 7395776, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XO-DLPFtH-4/AAAAAAAAAAI/AAAAAAAAAVQ/5YVUhPGuqUU/photo.jpg?sz=128", "display_name": "Pedro Gaspar", "link": "https://stackoverflow.com/users/7395776/pedro-gaspar"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1525901596, "post_id": 50261864, "comment_id": 87542835, "body": "I work in a company and i can&#39;t share the code policy of company, for my bad i can only express my ideia"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1525901973, "post_id": 50261864, "comment_id": 87542956, "body": "Can you obfuscate the code? Certainly you can share things like <code>Sub myMacro &#47;&#47; With Worksheets(&quot;My Sheet&quot;) &#47;&#47; ...</code>  If not, you may not have much luck here as we typically need an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "edited": false, "score": 0, "creation_date": 1525958995, "post_id": 50261864, "comment_id": 87564892, "body": "Read this: <a href=\"https://www.mrexcel.com/forum/excel-questions/33032-text-box-input-mask.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a>"}, {"owner": {"reputation": 75, "user_id": 7395776, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XO-DLPFtH-4/AAAAAAAAAAI/AAAAAAAAAVQ/5YVUhPGuqUU/photo.jpg?sz=128", "display_name": "Pedro Gaspar", "link": "https://stackoverflow.com/users/7395776/pedro-gaspar"}, "edited": false, "score": 0, "creation_date": 1525979888, "post_id": 50261864, "comment_id": 87576663, "body": "I managed to get it work with one type of format but the one i want seems to not work.  &quot;###-###.###-###&quot; or &quot;@@@-@@@.@@@-@@@&quot;"}, {"owner": {"reputation": 75, "user_id": 7395776, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XO-DLPFtH-4/AAAAAAAAAAI/AAAAAAAAAVQ/5YVUhPGuqUU/photo.jpg?sz=128", "display_name": "Pedro Gaspar", "link": "https://stackoverflow.com/users/7395776/pedro-gaspar"}, "edited": false, "score": 0, "creation_date": 1525981777, "post_id": 50261864, "comment_id": 87577538, "body": "I have this so far..."}, {"owner": {"reputation": 75, "user_id": 7395776, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XO-DLPFtH-4/AAAAAAAAAAI/AAAAAAAAAVQ/5YVUhPGuqUU/photo.jpg?sz=128", "display_name": "Pedro Gaspar", "link": "https://stackoverflow.com/users/7395776/pedro-gaspar"}, "edited": false, "score": 0, "creation_date": 1525981783, "post_id": 50261864, "comment_id": 87577540, "body": "Private Sub TextBox2_Change()     ~~&gt; This avoids refiring of the event     If boolSkip = True Then         boolSkip = False         Exit Sub     End If      ~~&gt; Get current cursor postion     CursorPosition = TextBox2.SelStart     boolSkip = True      ~~&gt; Format the text          TextBox2.Text = Format(TextBox2.Text, &quot;###-###.###-###&quot;)                ~~&gt; Re-position the cursor     If InStr(1, TextBox2.Text, &quot;.&quot;) - 1 &gt; 0 Then _     TextBox2.SelStart = InStr(1, TextBox2.Text, &quot;.&quot;) - 1 End Sub"}], "answers": [{"tags": [], "owner": {"reputation": 75, "user_id": 7395776, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XO-DLPFtH-4/AAAAAAAAAAI/AAAAAAAAAVQ/5YVUhPGuqUU/photo.jpg?sz=128", "display_name": "Pedro Gaspar", "link": "https://stackoverflow.com/users/7395776/pedro-gaspar"}, "is_accepted": true, "score": 0, "last_activity_date": 1528119212, "creation_date": 1528119212, "answer_id": 50681883, "question_id": 50261864, "link": "https://stackoverflow.com/questions/50261864/excel-vba-format-textbox-while-writing-or-when-tab-is-pressed/50681883#50681883", "title": "EXCEL VBA format textbox while writing or when tab is pressed", "body": "<pre><code>Private Sub TextBox1_Change()\n    If Len(TextBox1.Text) = 3 And TextBox1.Text Like \"###\" = True Then     \n        TextBox1.Text = TextBox1.Text &amp; \"-\"\n    If Len(TextBox1.Text) = 7 And TextBox1.Text Like \"###-###\" = True Then \n        TextBox1.Text = TextBox1.Text &amp; \".\"\n    If Len(TextBox1.Text) = 11 And TextBox1.Text Like \"###-###.###\" = True Then \n        TextBox1.Text = TextBox1.Text &amp; \"-\"\n    If Len(TextBox1.Text) &gt; 15 Then TextBox1.Text = Left(TextBox1.Text, 15)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 7395776, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XO-DLPFtH-4/AAAAAAAAAAI/AAAAAAAAAVQ/5YVUhPGuqUU/photo.jpg?sz=128", "display_name": "Pedro Gaspar", "link": "https://stackoverflow.com/users/7395776/pedro-gaspar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 50681883, "answer_count": 1, "score": -3, "last_activity_date": 1528119212, "creation_date": 1525899139, "question_id": 50261864, "link": "https://stackoverflow.com/questions/50261864/excel-vba-format-textbox-while-writing-or-when-tab-is-pressed", "title": "EXCEL VBA format textbox while writing or when tab is pressed", "body": "<p>so i'm almost finished with my code, just missing one thing, the user will have to introduce 12 numbers, example \"123456789123\" and the outcome is 123-456.789-123, i managed to get the format when printing to excel sheet, but i wanted something that could give me that format in the moment as it's easier to spot any error of input. Example the user puts 123456789123 on the textbox and when tabing to another box it formats. Is it possible? </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3608, "user_id": 908624, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/RWEjG.jpg?s=128&g=1", "display_name": "Alon Adler", "link": "https://stackoverflow.com/users/908624/alon-adler"}, "edited": false, "score": 3, "creation_date": 1525899285, "post_id": 50261660, "comment_id": 87541901, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/19851951/split-text-in-cells-at-line-breaks?utm_medium=organic&amp;utm_source=google_rich_qa&amp;utm_campaign=google_rich_qa\">Split text in cells at line breaks</a>"}, {"owner": {"reputation": 4329, "user_id": 1406420, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/qApC0.jpg?s=128&g=1", "display_name": "Stryker", "link": "https://stackoverflow.com/users/1406420/stryker"}, "edited": false, "score": 0, "creation_date": 1525900100, "post_id": 50261660, "comment_id": 87542249, "body": "I tried that solution already but it doesn\u2019t seem to work with multi lines that have blank lines and or multiple returns."}, {"owner": {"reputation": 4329, "user_id": 1406420, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/qApC0.jpg?s=128&g=1", "display_name": "Stryker", "link": "https://stackoverflow.com/users/1406420/stryker"}, "edited": false, "score": 0, "creation_date": 1525900245, "post_id": 50261660, "comment_id": 87542313, "body": "Even though it is 100 lines, Each line has a cell that contains over 50 lines of text all in one cell. I have tried it with a few formulas with no luck."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1525953503, "post_id": 50261660, "comment_id": 87561692, "body": "The important question: are cells merged or text is in only one cell?"}, {"owner": {"reputation": 4329, "user_id": 1406420, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/qApC0.jpg?s=128&g=1", "display_name": "Stryker", "link": "https://stackoverflow.com/users/1406420/stryker"}, "edited": false, "score": 0, "creation_date": 1525953579, "post_id": 50261660, "comment_id": 87561738, "body": "Text is in one cell only. It\u2019s not a merged cell."}], "answers": [{"comments": [{"owner": {"reputation": 4329, "user_id": 1406420, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/qApC0.jpg?s=128&g=1", "display_name": "Stryker", "link": "https://stackoverflow.com/users/1406420/stryker"}, "edited": false, "score": 0, "creation_date": 1525965217, "post_id": 50270922, "comment_id": 87568883, "body": "This worked like a charm. A few glitches here and there but it does the job."}], "tags": [], "owner": {"reputation": 78, "user_id": 9769705, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qYq0gD8B-ow/AAAAAAAAAAI/AAAAAAAAACQ/p5kjblPP-bU/photo.jpg?sz=128", "display_name": "MasovyKnedlicek", "link": "https://stackoverflow.com/users/9769705/masovyknedlicek"}, "is_accepted": true, "score": 2, "last_activity_date": 1525949147, "last_edit_date": 1525949147, "creation_date": 1525948510, "answer_id": 50270922, "question_id": 50261660, "link": "https://stackoverflow.com/questions/50261660/how-to-convert-a-multi-line-excel-cell-to-multi-row-while-keeping-other-values-t/50270922#50270922", "title": "How to convert a multi line excel cell to multi row while keeping other values the same?", "body": "<p>this works for me.\n<a href=\"https://i.stack.imgur.com/QRdmX.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QRdmX.jpg\" alt=\"Results of macro\"></a></p>\n\n<pre><code>Sub ConvertMultiLine()\n\n    Dim cellVal     As String\n    Dim WrdArray()  As String\n\n    Dim Item        As Variant\n\n    Dim iRow        As Long\n    Dim Counter     As Long\n\n    Dim colNum      As Integer  'column number where multi line cells are\n        colNum = 3              'e.g. column \"C\"\n\n    Dim rowStart    As Integer  'row number where the first multiline cell is\n        rowStart = 2\n\n    Dim rowPaste    As Integer  'row number where you want to paste the result\n        rowPaste = 2            'if rowPaste = rowStart, the data will be overwritten\n\n    Dim Arr()       As String   'array that will contain the separated values\n\n\n    '1st loop to get the number of items (it's used to skip redim of 2D array)\n    iRow = 0\n    Counter = 0\n    Do Until IsEmpty(ThisWorkbook.ActiveSheet.Cells(rowStart + iRow, colNum))\n\n        'Split content of a cell\n        cellVal = ThisWorkbook.ActiveSheet.Cells(rowStart + iRow, colNum).Value\n        WrdArray() = Split(cellVal, vbLf)\n\n        'Counting items\n        For Each Item In WrdArray\n            Counter = Counter + 1\n        Next Item\n\n        iRow = iRow + 1\n    Loop\n\n    '2nd loop to insert values into array\n    iRow = 0\n    ReDim Arr(1 To Counter, 1 To 3)\n    Counter = 0\n    Do Until IsEmpty(ThisWorkbook.ActiveSheet.Cells(rowStart + iRow, colNum))\n\n        'Split content of a cell\n        cellVal = ThisWorkbook.ActiveSheet.Cells(rowStart + iRow, colNum).Value\n        WrdArray() = Split(cellVal, vbLf)\n\n        'Set items to array\n        For Each Item In WrdArray\n            Arr(1 + Counter, 1) = ThisWorkbook.ActiveSheet.Cells(rowStart + iRow, colNum - 2)\n            Arr(1 + Counter, 2) = ThisWorkbook.ActiveSheet.Cells(rowStart + iRow, colNum - 1)\n            Arr(1 + Counter, 3) = Item\n            Counter = Counter + 1\n        Next Item\n\n        iRow = iRow + 1\n    Loop\n\n    'Paste array\n    ThisWorkbook.ActiveSheet.Cells(rowPaste, colNum - 2).Resize(Counter, 3) = Arr\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": false, "score": 2, "last_activity_date": 1525960375, "last_edit_date": 1525960375, "creation_date": 1525959630, "answer_id": 50274311, "question_id": 50261660, "link": "https://stackoverflow.com/questions/50261660/how-to-convert-a-multi-line-excel-cell-to-multi-row-while-keeping-other-values-t/50274311#50274311", "title": "How to convert a multi line excel cell to multi row while keeping other values the same?", "body": "<p>Assuming data is in columns A, B and C:</p>\n\n<pre><code>Sub G()\n\n    Dim r&amp;, x&amp;, cnt%, arr\n    Dim wksOutput As Worksheet\n    Dim this As Worksheet\n\n    x = 2 '//Skip header\n    Set this = ActiveSheet\n    Set wksOutput = Sheets.Add(After:=Sheets(Sheets.Count))\n\n    With wksOutput\n        For r = 2 To this.Cells(Rows.Count, 1).End(xlUp).Row\n            arr = Split(this.Cells(r, \"C\"), Chr(10))\n            cnt = UBound(arr) + 1\n            .Cells(x, \"A\").Resize(cnt) = this.Cells(r, \"A\")\n            .Cells(x, \"B\").Resize(cnt) = this.Cells(r, \"B\")\n            .Cells(x, \"C\").Resize(cnt) = Application.Transpose(arr)\n            x = x + cnt\n        Next\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 4329, "user_id": 1406420, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/qApC0.jpg?s=128&g=1", "display_name": "Stryker", "link": "https://stackoverflow.com/users/1406420/stryker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1868, "favorite_count": 2, "accepted_answer_id": 50270922, "answer_count": 2, "score": 0, "last_activity_date": 1525960375, "creation_date": 1525898336, "last_edit_date": 1531161705, "question_id": 50261660, "link": "https://stackoverflow.com/questions/50261660/how-to-convert-a-multi-line-excel-cell-to-multi-row-while-keeping-other-values-t", "title": "How to convert a multi line excel cell to multi row while keeping other values the same?", "body": "<p>How can I convert a multi line cell to a multi row while keeping the data in other cells the same.\nHere is what I have and the desired result is shown below as well. \nTried text to column but it converts it to multi column which is not what I am looking for. Here is what I have with over 100 rows.</p>\n\n<p><a href=\"https://i.stack.imgur.com/8xT20.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8xT20.png\" alt=\"Current spreadsheet with over 100 rows\"></a></p>\n\n<p>Here is what the it should look like.</p>\n\n<p><a href=\"https://i.stack.imgur.com/EuSfd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EuSfd.png\" alt=\"enter image description here\"></a></p>\n\n<p>Any help would be appreciated..</p>\n"}, {"tags": ["excel", "multiple-monitors", "vba"], "comments": [{"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1525968892, "post_id": 50261160, "comment_id": 87570946, "body": "and you say, users can&#39;t move the inputbox?"}], "answers": [{"comments": [{"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "edited": false, "score": 0, "creation_date": 1525897532, "post_id": 50261354, "comment_id": 87541022, "body": "It&#39;s not the inputbox that I need to specify the location of as much as the e-mail."}, {"owner": {"reputation": 3608, "user_id": 908624, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/RWEjG.jpg?s=128&g=1", "display_name": "Alon Adler", "link": "https://stackoverflow.com/users/908624/alon-adler"}, "reply_to_user": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "edited": false, "score": 0, "creation_date": 1525897696, "post_id": 50261354, "comment_id": 87541093, "body": "@Selkie But the email is not in Excel, or is it ?"}, {"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "edited": false, "score": 0, "creation_date": 1525897854, "post_id": 50261354, "comment_id": 87541181, "body": "The E-mail is from outlook. A macro on Excel&#39;s side is scraping it."}, {"owner": {"reputation": 3608, "user_id": 908624, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/RWEjG.jpg?s=128&g=1", "display_name": "Alon Adler", "link": "https://stackoverflow.com/users/908624/alon-adler"}, "reply_to_user": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "edited": false, "score": 0, "creation_date": 1525898191, "post_id": 50261354, "comment_id": 87541338, "body": "@Selkie so you present it&#39;s text inside an Excel sheet and on-top position the <code>MsgBox</code> ?"}, {"owner": {"reputation": 3608, "user_id": 908624, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/RWEjG.jpg?s=128&g=1", "display_name": "Alon Adler", "link": "https://stackoverflow.com/users/908624/alon-adler"}, "reply_to_user": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "edited": false, "score": 0, "creation_date": 1525898830, "post_id": 50261354, "comment_id": 87541664, "body": "@Selkie per your comments, I&#39;ve wrote a second answer."}], "tags": [], "owner": {"reputation": 3608, "user_id": 908624, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/RWEjG.jpg?s=128&g=1", "display_name": "Alon Adler", "link": "https://stackoverflow.com/users/908624/alon-adler"}, "is_accepted": false, "score": 0, "last_activity_date": 1525897476, "last_edit_date": 1525897476, "creation_date": 1525897000, "answer_id": 50261354, "question_id": 50261160, "link": "https://stackoverflow.com/questions/50261160/getting-an-e-mail-to-popup-on-one-monitor-with-a-message-box-appearing-on-anoth/50261354#50261354", "title": "Getting an e-mail to popup on one monitor, with a message box appearing on another", "body": "<p>A <code>MsgBox</code> doesn't include any way to specify a location. Instead, Excel displays the message box centered on the screen. If you need the capability to position the box, then the easiest solution is to rely upon the <code>InputBox</code>. Unlike <code>MsgBox</code>, <code>InputBox</code> includes option parameters for specifying a location. Here's an example:</p>\n\n<pre><code>vendorName = InputBox(Prompt:=\"Who is this e-mail from?\", XPos:=2880, YPos:=1440)\n</code></pre>\n\n<p>The look and feel wont be the same with an <code>InputBox</code>, but you will be able to locate your box in (for example) the screen bottom left/right corner.</p>\n\n<p>You can tell your users to input the Vendor's name, so you will know if it was found or not.</p>\n"}, {"tags": [], "owner": {"reputation": 3608, "user_id": 908624, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/RWEjG.jpg?s=128&g=1", "display_name": "Alon Adler", "link": "https://stackoverflow.com/users/908624/alon-adler"}, "is_accepted": false, "score": 0, "last_activity_date": 1525898700, "creation_date": 1525898700, "answer_id": 50261755, "question_id": 50261160, "link": "https://stackoverflow.com/questions/50261160/getting-an-e-mail-to-popup-on-one-monitor-with-a-message-box-appearing-on-anoth/50261755#50261755", "title": "Getting an e-mail to popup on one monitor, with a message box appearing on another", "body": "<p>You should try using a <code>UserForm</code> to display your message - instead of a <code>MsgBox</code> </p>\n\n<p><code>UserForm</code>has a property named <code>StartUpPosition</code>. By default, this property is set to 1 (<code>CenterOwner</code>), which means that it should appear in the center of Excel's window.</p>\n\n<p><strong>But</strong>, if you have a dual-monitor system. The <code>UserForm</code> is not centered in the Excel window - On my system, <code>UserForm</code> always display on the left side of the secondary monitor, even if Excel is maximized on the primary monitor.</p>\n\n<p>Try it, and even if it will be centered above the Excel window, you can easily modify it's location.</p>\n\n<p>The code below will force an Excel <code>UserForm</code> to be centered in Excel's window - modify it per your needs (but try first initiating a <code>UserForm</code> without any modification - it might just pop-up on the secondary screen exactly like you need).</p>\n\n<pre><code>With UserForm1\n  .StartUpPosition = 0\n  .Left = Application.Left + (0.5 * Application.Width) - (0.5 * .Width)\n  .Top = Application.Top + (0.5 * Application.Height) - (0.5 * .Height)\n  .Show\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 141, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1525898700, "creation_date": 1525896025, "last_edit_date": 1531164843, "question_id": 50261160, "link": "https://stackoverflow.com/questions/50261160/getting-an-e-mail-to-popup-on-one-monitor-with-a-message-box-appearing-on-anoth", "title": "Getting an e-mail to popup on one monitor, with a message box appearing on another", "body": "<p>So I'm creating an e-mail scrape. Scrapes, etc. etc. </p>\n\n<p>It tries to detect if a given vendor name is in the e-mail. If it finds it, great! It knows who it came from.</p>\n\n<p>However, sometimes it'll fail to find a name. What I'm currently doing is displaying the e-mail in question, and popping up an input box asking \"Who is this e-mail from?\"</p>\n\n<p>Unfortunately, the e-mail and the input box tend to pop up in the same monitor, so the message box ends up \"overwriting\"  the e-mail, effectively hiding it. That makes it fairly difficult for the end user to see what e-mail I'm talking about!</p>\n\n<p>Is there an easy way to say in VBA \"Please display on whatever monitor Excel isn't using\", or should I simply add into the instructions \"Hey, have your outlook and Excel in different monitors for ease of use\"?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2207, "user_id": 8357864, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4fe690b4dfe322a7c5b9d8ba23b3bd05?s=128&d=identicon&r=PG&f=1", "display_name": "LetEpsilonBeLessThanZero", "link": "https://stackoverflow.com/users/8357864/letepsilonbelessthanzero"}, "edited": false, "score": 2, "creation_date": 1525895825, "post_id": 50261080, "comment_id": 87540276, "body": "Excel is not well suited for medium/big data sets like this. I strongly recommend considering alternative tools that are meant for working with large data, such as the programming language R. Python is another good option. Both are completely free and there&#39;s tons of good documentation out there on how to use them. They both also have very active communities here on this website."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 3, "creation_date": 1525895926, "post_id": 50261080, "comment_id": 87540317, "body": "&quot;1 800 000 rows&quot; ???"}, {"owner": {"reputation": 695, "user_id": 7343313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OB1ru.png?s=128&g=1", "display_name": "jonyfries", "link": "https://stackoverflow.com/users/7343313/jonyfries"}, "edited": false, "score": 1, "creation_date": 1525896628, "post_id": 50261080, "comment_id": 87540656, "body": "You&#39;ll want to use an Array to process the data instead of directly accessing each cell. Accessing individual cells is much slower."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1525898703, "post_id": 50261080, "comment_id": 87541613, "body": "@SJR lots of people go through a lot of pain just to avoid having to deal with a database, apparently ;0)"}], "answers": [{"comments": [{"owner": {"reputation": 695, "user_id": 7343313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OB1ru.png?s=128&g=1", "display_name": "jonyfries", "link": "https://stackoverflow.com/users/7343313/jonyfries"}, "edited": false, "score": 0, "creation_date": 1525897323, "post_id": 50261363, "comment_id": 87540928, "body": "The OP wanted to also clear out the excess data. To achieve that using this remove duplicate values could be used based on column C. I&#39;m curious how much time this would have with almost 2 million rows however."}], "tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1525897516, "last_edit_date": 1525897516, "creation_date": 1525897037, "answer_id": 50261363, "question_id": 50261080, "link": "https://stackoverflow.com/questions/50261080/average-on-a-sheets-excel-vba/50261363#50261363", "title": "Average on a sheets Excel Vba", "body": "<p>I'd like to suggest a different approach - a one without VBA and just plain Excel formula.<br>\nYou will have to add two columns next to your data. In this example I have a timestamp in column A and a value in column B. Column C have a formula <code>=TRUNC(A1)</code> and column D have this formula <code>=IF(C1&lt;&gt;C2,AVERAGEIF(C:C,C1,B:B),\"\")</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/5IpSR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5IpSR.png\" alt=\"Example\"></a></p>\n"}], "owner": {"reputation": 21, "user_id": 9740797, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jhonny D", "link": "https://stackoverflow.com/users/9740797/jhonny-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1525897516, "creation_date": 1525895651, "last_edit_date": 1525896252, "question_id": 50261080, "link": "https://stackoverflow.com/questions/50261080/average-on-a-sheets-excel-vba", "title": "Average on a sheets Excel Vba", "body": "<p>I have a sheets with 1,800,000 rows and 100 columns. The first column is the time column and each cell in the column correspond to an increment of 0.002 s (more or less) for a total of 3600 sec. I'm trying to make an average of the values in each of the other columns for 1s step ( i sum all the value in 1s step, I divide for the step number and i get the average). Then I clear all the values and I just copy the Value i get for every 1s step. My code works but i guess there is a better way to do that because this is very slow due to the big amount of data.</p>\n\n<pre><code>Option Explicit\nSub AverageResult()\n\n'-------dall altro script\nDim LastRowInca As Long\nDim FirstRowInca As Long\nDim LastRow As Long\nDim FirstRow As Long\n'-------dall'altro script\n\n\nDim i As Long\nDim t1 As Long\nDim t2 As Long\nDim variable As Long\nDim avg As Long\nDim numSampling As Long\nnumSampling = 0\nDim ColumnSelected As Long\n\n\n\n'lunghezza della colonna del tempo\nDim timeColumn As Long\ntimeColumn = Sheets(1).UsedRange.Rows(Sheets(1).UsedRange.Rows.Count).Row\n\n'numero totale di colonne\nDim totColumn As Long\ntotColumn = Cells(1, Columns.Count).End(xlToLeft).Column\ntotColumn = Sheets(1).UsedRange.Columns(Sheets(1).UsedRange.Columns.Count).Column\n\nFirstRowInca = 2\n\nFor ColumnSelected = 2 To totColumn\nt1 = 0\nt2 = 1\nvariable = 0\navg = 0\nnumSampling = 0\n\nDebug.Print \"colonna selezionata\"; ColumnSelected\nFor i = FirstRowInca To timeColumn\n\nDebug.Print \"calcolo la riga\"; i; \"colonna\"; ColumnSelected\n' definisco l'intervallo di un secondo in cui deve fare la media\nIf Cells(i, 1).Value &gt; t1 And Cells(i, 1).Value &lt;= t2 Then\n    'calcolo la prima variabile se la cella non \u00e8 vuota\n    If Cells(i, ColumnSelected).Value &lt;&gt; \"\" Then\n    variable = variable + Sheets(1).Cells(i, ColumnSelected).Value\n\n    'Setto la cella come vuota\n    Cells(i, ColumnSelected).Value = \"\"\n\n    'Segno il divisore\n    numSampling = numSampling + 1\n\n'Se la cella come vuota\n    ElseIf Cells(i, ColumnSelected).Value = \"\" Then\n    Debug.Print \"Vuoto\"\n    End If\nElse\n'Faccio il valore medio e passo all'intervallo successivo\nIf numSampling &lt;&gt; 0 Then\navg = variable / (numSampling)\n'metto nella cella precedente il valore\nCells(i - 1, ColumnSelected).Value = avg\nDebug.Print \"la media \u00e8\"; avg; \"l'intervallo era\"; t1; \"a\"; t2; \"la riga \u00e8\"; i\nvariable = 0\navg = 0\nnumSampling = 0\nt1 = t1 + 1\nt2 = t2 + 1\nIf Cells(i, ColumnSelected).Value &lt;&gt; \"\" Then\n    variable = variable + Sheets(1).Cells(i, ColumnSelected).Value\n    'Setto la cella come vuota\n    Cells(i, ColumnSelected).Value = \"\"\n    'Segno il divisore\n    numSampling = numSampling + 1\n\n'Se la cella come vuota\n    ElseIf Cells(i, ColumnSelected).Value = \"\" Then\n    Debug.Print \"Vuoto\"\n    End If\n    End If\nEnd If\n\nNext i\nNext ColumnSelected\n\n\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1525893384, "post_id": 50260527, "comment_id": 87539096, "body": "You could add a helper column which returns the col G value if your conditions are met (blank otherwise) and then filter on that column and delete anything with a value in it."}], "answers": [{"tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": true, "score": 0, "last_activity_date": 1525976552, "last_edit_date": 1525976552, "creation_date": 1525897631, "answer_id": 50261501, "question_id": 50260527, "link": "https://stackoverflow.com/questions/50260527/how-to-delete-all-rows-of-a-multiple-entry-even-if-just-one-row-meets-defined-cr/50261501#50261501", "title": "How to delete all rows of a multiple entry even if just one row meets defined criteria", "body": "<pre><code>Sub ToDelete()\n\n    Dim last_row&amp;\n\n    '// NOTE! The code assumes that range:\n    '// 1) starts in column A\n    '// 2) ends in column O\n    last_row = Cells(Rows.Count, \"G\").End(xlUp).Row\n    '// Helper column 1\n    With Range(\"P2:P\" &amp; last_row)\n        .Formula = \"=IF(OR(M2&gt;0.9,L2&gt;0.9),1,0)\"\n        .Value = .Value 'Overwrite formula\n    End With\n    '// Helper column 2\n    With Range(\"Q2:Q\" &amp; last_row)\n        .Formula = \"=IF(SUMIF(G:G,G2,P:P)&gt;0,1,0)\"\n        .Value = .Value 'Overwrite formula\n    End With\n\n    Rows(1).CurrentRegion.AutoFilter Field:=17, Criteria1:=1\n    Rows(\"2:\" &amp; last_row).EntireRow.Delete\n    ActiveSheet.AutoFilterMode = False 'Remove filter\n    Columns(\"P:Q\").Delete 'Remove helper columns\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9697727, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bLpzCjgGYhc/AAAAAAAAAAI/AAAAAAAAAxQ/1ogvJaJZsAQ/photo.jpg?sz=128", "display_name": "brad", "link": "https://stackoverflow.com/users/9697727/brad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 50261501, "answer_count": 1, "score": 0, "last_activity_date": 1525976552, "creation_date": 1525893189, "last_edit_date": 1531161705, "question_id": 50260527, "link": "https://stackoverflow.com/questions/50260527/how-to-delete-all-rows-of-a-multiple-entry-even-if-just-one-row-meets-defined-cr", "title": "How to delete all rows of a multiple entry even if just one row meets defined criteria", "body": "<p>Below is the current (incomplete) code I'm using which works fine to delete any one given row, but what I really need to do is identify rows which meet certain criteria:<br>\n<em>Cell Value in Column L > 90%</em><br>\nOR<br>\n<em>Cell Value in Column M > 90%</em>  </p>\n\n<p>Then if either of those is true I need to find the Cell Value in same row Column G and delete all rows which contain that same Value in Column G.</p>\n\n<pre><code>   Sub sbDelete_Rows_Based_On_Multiple_Criteria()\n    Dim lRow As Long\n    Dim iCntr As Long\n    lRow = Cells(Rows.Count, \"G\").End(xlUp).Row\n    For iCntr = lRow To 2 Step -1\n        If Cells(iCntr, \"L\") &gt; 0.90 OR Cells(iCntr, \"M\") &gt; 0.90 Then\n            Cells(iCntr, \"G\").EntireRow.Delete\n        End If\n    Next iCntr\n  End Sub\n</code></pre>\n\n<p>--</p>\n\n<p><a href=\"https://i.stack.imgur.com/D9HnF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/D9HnF.png\" alt=\"enter image description here\"></a></p>\n\n<p>What I hope to accomplish in my example would result in the only Serial # which is NOT deleted would be 1910910 </p>\n\n<p>thank you in advance for your assistance.</p>\n"}, {"tags": ["excel", "runtime-error", "vba"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1525893304, "post_id": 50260509, "comment_id": 87539054, "body": "you used <code>Application.WorksheetFunction</code> in previous lines, but changed it later for the <code>sum</code> function. You may consider an if statement as well so lr is not smaller than sr"}, {"owner": {"reputation": 61, "user_id": 9621316, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P_ni4ZHUXrc/AAAAAAAAAAI/AAAAAAAACFk/7nG65aNvU9E/photo.jpg?sz=128", "display_name": "TCO", "link": "https://stackoverflow.com/users/9621316/tco"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1525893686, "post_id": 50260509, "comment_id": 87539242, "body": "In my case, lr can never be smaller than sr. Would you please write the if statement and let me know where to insert it?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1525893699, "post_id": 50260509, "comment_id": 87539248, "body": "Not the cause of your problem, but this line <code>Dim sr, leg, lr, fm, sm, tval, sval, i, j As Long</code> declares only j as Long, the others being Variants. Presumably a value is not being assigned to fm or sm."}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 9621316, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P_ni4ZHUXrc/AAAAAAAAAAI/AAAAAAAACFk/7nG65aNvU9E/photo.jpg?sz=128", "display_name": "TCO", "link": "https://stackoverflow.com/users/9621316/tco"}, "edited": false, "score": 0, "creation_date": 1525898273, "post_id": 50261581, "comment_id": 87541390, "body": "You figured it out! everything entered into the wo needs to be in caps! How would I change that in the code?  wo = Trim(UserForm1.TextBox4.Value)"}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "reply_to_user": {"reputation": 61, "user_id": 9621316, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P_ni4ZHUXrc/AAAAAAAAAAI/AAAAAAAACFk/7nG65aNvU9E/photo.jpg?sz=128", "display_name": "TCO", "link": "https://stackoverflow.com/users/9621316/tco"}, "edited": false, "score": 0, "creation_date": 1525898863, "post_id": 50261581, "comment_id": 87541675, "body": "There is a <code>UCase</code> function to convert to upper case."}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "reply_to_user": {"reputation": 61, "user_id": 9621316, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P_ni4ZHUXrc/AAAAAAAAAAI/AAAAAAAACFk/7nG65aNvU9E/photo.jpg?sz=128", "display_name": "TCO", "link": "https://stackoverflow.com/users/9621316/tco"}, "edited": false, "score": 0, "creation_date": 1525898930, "post_id": 50261581, "comment_id": 87541717, "body": "One other potential bug --- should your resizes be <code>Resize(lr-sr+1,1)</code>?"}, {"owner": {"reputation": 61, "user_id": 9621316, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P_ni4ZHUXrc/AAAAAAAAAAI/AAAAAAAACFk/7nG65aNvU9E/photo.jpg?sz=128", "display_name": "TCO", "link": "https://stackoverflow.com/users/9621316/tco"}, "edited": false, "score": 0, "creation_date": 1525899212, "post_id": 50261581, "comment_id": 87541861, "body": "Where do you see that?"}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "reply_to_user": {"reputation": 61, "user_id": 9621316, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P_ni4ZHUXrc/AAAAAAAAAAI/AAAAAAAACFk/7nG65aNvU9E/photo.jpg?sz=128", "display_name": "TCO", "link": "https://stackoverflow.com/users/9621316/tco"}, "edited": false, "score": 0, "creation_date": 1525901658, "post_id": 50261581, "comment_id": 87542854, "body": "For instance, if sr = 5 and lr = 6, don&#39;t you want to resize to 2 rows (lr-sr+1) instead of lr rows?"}], "tags": [], "owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "is_accepted": true, "score": 0, "last_activity_date": 1525897937, "creation_date": 1525897937, "answer_id": 50261581, "question_id": 50260509, "link": "https://stackoverflow.com/questions/50260509/vba-runtime-error-1004-application-defined-or-object-defined-error/50261581#50261581", "title": "vba runtime error 1004 application defined or object defined error", "body": "<p>Is it possible that the inputs <code>wo</code> and <code>leg</code> are invalid? If so then</p>\n\n<pre><code>If Trim(ws.Cells(i, 1)) = wo And Trim(ws.Cells(i, 4)) = leg\n</code></pre>\n\n<p>will not evaluate to <code>True</code> for any <code>i</code>, and then <code>fm</code> and <code>sm</code> will be <code>Empty</code>. That would cause line 34 to throw an error.</p>\n\n<p>Hope that helps.</p>\n"}], "owner": {"reputation": 61, "user_id": 9621316, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P_ni4ZHUXrc/AAAAAAAAAAI/AAAAAAAACFk/7nG65aNvU9E/photo.jpg?sz=128", "display_name": "TCO", "link": "https://stackoverflow.com/users/9621316/tco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 50261581, "answer_count": 1, "score": 1, "last_activity_date": 1525904965, "creation_date": 1525893096, "last_edit_date": 1531161705, "question_id": 50260509, "link": "https://stackoverflow.com/questions/50260509/vba-runtime-error-1004-application-defined-or-object-defined-error", "title": "vba runtime error 1004 application defined or object defined error", "body": "<p>Something very strange happened. At one point this was working and all of a sudden now I get an error. </p>\n\n<p>The issue is <code>fm</code> and <code>sm</code>, when the debug is on, <code>fm = Empty</code> and <code>sm = Empty</code></p>\n\n<p>Therefore <code>tval = Empty</code> the error occurs at line 34:</p>\n\n<p><code>tval = WorksheetFunction.Sum(ws.Range(ws.Cells(fm, 11), ws.Cells(sm, 11)))</code></p>\n\n<p>Full code:</p>\n\n<pre><code>Private Sub TextBox6_Change()\n\n    Dim ws As Worksheet\n    Dim sr, leg, lr, fm, sm, tval, sval, i, j As Long\n    Dim wo, rc As String\n\n    Set ws = ThisWorkbook.Worksheets(\"Cost Analysis\") ' ws = Work Sheet\n    sr = 5                                       ' sr = Start row\n    lr = ws.Cells(Rows.Count, 1).End(xlUp).Row   ' lr = Last row\n    wo = Trim(UserForm1.TextBox4.Value)          ' Work Order\n    leg = Trim(UserForm1.TextBox5.Value)         ' leg\n    rc = Trim(UserForm1.ComboBox3.Value)         ' rc = Root Cause\n\n    If wo &lt;&gt; \"\" And leg &lt;&gt; \"\" And rc &lt;&gt; \"\" And TextBox6.Value &lt;&gt; \"\" Then\n\n        If Application.WorksheetFunction.CountIfs(ws.Cells(sr, 1).Resize(lr, 1), wo, _\n                                                  ws.Cells(sr, 4).Resize(lr, 1), leg, _\n                                                  ws.Cells(sr, 5).Resize(lr, 1), rc) &gt; 0 Then\n\n            For i = sr To lr\n\n                If Trim(ws.Cells(i, 1)) = wo And Trim(ws.Cells(i, 4)) = leg Then\n\n                    j = j + 1\n\n                    If j = 1 Then\n                        fm = i\n                    End If\n\n                    If Trim(ws.Cells(i, 5)) = rc Then\n                        sm = i\n                        Exit For\n                    Else\n                    End If\n\n                End If\n            Next\n\n            tval = WorksheetFunction.Sum(ws.Range(ws.Cells(fm, 11), ws.Cells(sm, 11)))\n            sval = WorksheetFunction.Sum(ws.Range(ws.Cells(fm, 11), ws.Cells(sm, 11))) * Trim(TextBox6.Value)\n\n        Else\n        End If\n    End If\n\n    UserForm1.TextBox7 = tval\n    UserForm1.TextBox16 = sval\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "passwords"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1525894800, "post_id": 50260332, "comment_id": 87539787, "body": "I have that linked code stored in a macro-enabled workbook named <code>CrackerJack.xlsm</code> that I keep handy. If you can remove the VBA password and/or change it to something else, then why don&#39;t you just do that? If the password itself was stored anywhere, I&#39;m pretty sure it&#39;d be all over the Internet by now, and effectively useless. So, remove the passwords, and call it a day. No?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1525895102, "post_id": 50260332, "comment_id": 87539939, "body": "<a href=\"https://stackoverflow.com/questions/1026483/is-there-a-way-to-crack-the-password-on-an-excel-vba-project?noredirect=1&amp;lq=1\" title=\"is there a way to crack the password on an excel vba project\">stackoverflow.com/questions/1026483/&hellip;</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1525895134, "post_id": 50260332, "comment_id": 87539952, "body": "@braX that&#39;s precisely what the OP is linking to ;-)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1525895464, "post_id": 50260332, "comment_id": 87540098, "body": "Point is, cracking VBE protection is <i>already</i> all over the Internet, making this protection effectively useless. I&#39;d just remove the passwords, and leave it at that."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1525895518, "post_id": 50260332, "comment_id": 87540121, "body": "@MathieuGuindon as the post said, there IS benefit to knowing the password (would save me time of having to move all the workbooks, unlock them one by one, save them, and move them back to my original machine). This is a work-around to a root problem (whats the password) and I was just seeing if there was a way to avoid the workaround for both practicality reasons and pure curiosity if it was possible."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1525895616, "post_id": 50260332, "comment_id": 87540175, "body": "@MathieuGuindon I assumed my ask was not do-able, but I also assumed i wouldn&#39;t be able to view a locked macro with only 10 min of research so I figured why not ask!"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1525895252, "post_id": 50260974, "comment_id": 87540004, "body": "Twitched at &quot;encrypted in a way that can&#39;t be decrypted - also known as a hash&quot; - hashing != encryption... but I see what you&#39;re saying. Anyway, Excel (the host application) has zero knowledge of the VBA project&#39;s password, and zero bearing on the VBE&#39;s password-protection mechanics - that&#39;s all on the VBE."}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1525895590, "post_id": 50260974, "comment_id": 87540157, "body": "I expected this comment, but I have found that this is the easiest, albeit not technically correct, way to explain hashing."}], "tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": true, "score": 1, "last_activity_date": 1525895132, "creation_date": 1525895132, "answer_id": 50260974, "question_id": 50260332, "link": "https://stackoverflow.com/questions/50260332/show-password-on-protected-macro-while-unlocked/50260974#50260974", "title": "Show password on protected macro while unlocked", "body": "<p>No, it is not possible to show the password. The reason is that it isn't stored in the workbook. When you enter the password it encrypted in a way that can't be decrypted - also known as a hash. When you log in the entered password is also encrypted and then compared.<br>\nIf you want to do something like this, you'll have to build something around Excel's password mechanisms that capture passwords and store them somewhere, before using them to unlock. There are single sign on solutions that do things like this, but I can't recommend this approach.</p>\n"}], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 692, "favorite_count": 0, "accepted_answer_id": 50260974, "answer_count": 1, "score": 0, "last_activity_date": 1525895132, "creation_date": 1525892351, "last_edit_date": 1531164843, "question_id": 50260332, "link": "https://stackoverflow.com/questions/50260332/show-password-on-protected-macro-while-unlocked", "title": "Show password on protected macro while unlocked", "body": "<p>Is there a way to show the password that protects macros after you have entered the password (or in this case, bypassed the password)? (Not looking for workbook protected password). </p>\n\n<p>Example: 1) Open excel, 2) open VB Editor, 3) enter password to view macros, <em>4) add new macro that shows you the password.</em></p>\n\n<p>I have been asked to update the macros on a lot of legacy files that have password protected macros. To be clear: the workbook is <strong>not</strong> protected. I used the below link which allowed me to view the macros on the book. (I used the 32 bit code, but I had to transfer my files to a computer with 32 bit excel since my work station is running 64 and then transfer them back).</p>\n\n<p>I realize there are other workarounds after bypassing the password, such as disabling the password and then work on that file moving forward, but there is benefit in just finding out what the password is, thus I'm hoping there is a direct solution to my problem. The individual who made this password has locked many macros in many workbooks, and we have it on good authority he used the same passwords across the board. If I can find the password on one, I can unlock all of them. </p>\n\n<p>Please let me know if anything else needs to be clarified.  </p>\n\n<p>Link that allowed me to bypass password: \n<a href=\"https://stackoverflow.com/questions/1026483/is-there-a-way-to-crack-the-password-on-an-excel-vba-project/31005696#31005696\">Is there a way to crack the password on an Excel VBA Project?</a></p>\n"}, {"tags": ["sql", "vba", "ms-access", "outlook"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 2, "creation_date": 1525892912, "post_id": 50260288, "comment_id": 87538863, "body": "That&#39;s a <code>SELECT</code> statement. What do you expect to happen when you run it?"}, {"owner": {"reputation": 172, "user_id": 9621551, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4D9XE.jpg?s=128&g=1", "display_name": "Analyst123456789", "link": "https://stackoverflow.com/users/9621551/analyst123456789"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1525893478, "post_id": 50260288, "comment_id": 87539145, "body": "I am attempting to have the datasheet view (list of all records meeting these requirements) appear in access. The code is supposed to open access, and run the query based on the sql in the vba code"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1525893683, "post_id": 50260288, "comment_id": 87539238, "body": "Well... You can&#39;t just show a datasheet filled from an SQL statement. You can create a new query, and open it in datasheet view, or edit an existing query, and open that. Or, if you want to do really fancy things, you can have a form that can display any SQL statement in datasheet view (something like I shared <a href=\"https://stackoverflow.com/a/49551221/7296893\">here</a>), but that&#39;s quite complex."}], "answers": [{"comments": [{"owner": {"reputation": 172, "user_id": 9621551, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4D9XE.jpg?s=128&g=1", "display_name": "Analyst123456789", "link": "https://stackoverflow.com/users/9621551/analyst123456789"}, "edited": false, "score": 0, "creation_date": 1525892968, "post_id": 50260376, "comment_id": 87538889, "body": "I am still getting the error. the debugger has highlighted this line again even with the change.. The error says, &quot;A runSQL action requires an argument consisting of an SQL statement.&quot;     Do you know if I am not allowed to declare it as a string above and call it down here?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 172, "user_id": 9621551, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4D9XE.jpg?s=128&g=1", "display_name": "Analyst123456789", "link": "https://stackoverflow.com/users/9621551/analyst123456789"}, "edited": false, "score": 1, "creation_date": 1525896590, "post_id": 50260376, "comment_id": 87540641, "body": "@Analyst123456789 if your string is assigned exactly the way you have it in your post, then I don&#39;t see how your code can even compile; it&#39;s missing line continuations ` _`."}, {"owner": {"reputation": 172, "user_id": 9621551, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4D9XE.jpg?s=128&g=1", "display_name": "Analyst123456789", "link": "https://stackoverflow.com/users/9621551/analyst123456789"}, "edited": false, "score": 0, "creation_date": 1525901984, "post_id": 50260376, "comment_id": 87542959, "body": "It does contain line continuations, but I took them out of this so that I could write it continually on one line. The string itself is working, its just the last line that is having the issue. I have also attempted to use appAccess.DoCmd.Execute with an update sql query, but that did not work either."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 172, "user_id": 9621551, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4D9XE.jpg?s=128&g=1", "display_name": "Analyst123456789", "link": "https://stackoverflow.com/users/9621551/analyst123456789"}, "edited": false, "score": 1, "creation_date": 1525937082, "post_id": 50260376, "comment_id": 87553056, "body": "Your SQL string as posted will not work. <a href=\"http://stackoverflow.com/a/1099570/3820271\">How to debug dynamic SQL in VBA</a> . Please post working code and the result of <code>Debug.Print strsqlQuery</code> @Analyst123456789"}], "tags": [], "owner": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "is_accepted": false, "score": 1, "last_activity_date": 1525892544, "creation_date": 1525892544, "answer_id": 50260376, "question_id": 50260288, "link": "https://stackoverflow.com/questions/50260288/execute-a-sql-statement-inside-vba-code/50260376#50260376", "title": "Execute a SQL statement inside VBA Code", "body": "<p>Remove the quotes. </p>\n\n<p><code>appAccess.DoCmd.RunSQL \"strsqlQuery\"</code> to <code>appAccess.DoCmd.RunSQL strsqlQuery</code></p>\n"}, {"tags": [], "owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "is_accepted": false, "score": 2, "last_activity_date": 1525893695, "creation_date": 1525893695, "answer_id": 50260651, "question_id": 50260288, "link": "https://stackoverflow.com/questions/50260288/execute-a-sql-statement-inside-vba-code/50260651#50260651", "title": "Execute a SQL statement inside VBA Code", "body": "<p>If you want to have a datasheet form view show these records you can use </p>\n\n<pre><code>DoCmd.OpenForm \n</code></pre>\n\n<p>First create a query with the data you want to see, then bind that to your form using the <code>Record Source</code> property, then when you call <code>DoCmd.OpenForm</code> pass in the filter you want. </p>\n\n<p>I'm not following what you're trying to do with <code>SWITCH</code> in your query (is that supposed to be the <code>switch()</code> function? it has no parentheses). But you'll need to adjust that to join to use a <code>Where</code> statement instead.</p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 7292038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1cfb0bd38a4dbd8ff1c0d6353d1b924?s=128&d=identicon&r=PG&f=1", "display_name": "The Special", "link": "https://stackoverflow.com/users/7292038/the-special"}, "is_accepted": false, "score": 2, "last_activity_date": 1525899823, "creation_date": 1525899823, "answer_id": 50262017, "question_id": 50260288, "link": "https://stackoverflow.com/questions/50260288/execute-a-sql-statement-inside-vba-code/50262017#50262017", "title": "Execute a SQL statement inside VBA Code", "body": "<p>I agree with a couple of the above posts.</p>\n\n<ol>\n<li>You need to do a Debug.Print of the strsqlQuery variable BEFORE YOU DO ANYTHING! Then evaluate that statement.  Does it look right?  As Matt says, it doesn't look like you have line continuations, which would make your SQL statement incomplete (and thus, the computer doesn't think its a query at all).</li>\n</ol>\n\n<p>My personal preference is to define the SQL like you have, then create the actual query using that SQL (create query def), and then call that query, because it will now be an actual object in the database. The QUERY can show up as a datasheet without any form requirement, but a pure SQL Statement cannot.</p>\n\n<p>Michael</p>\n"}], "owner": {"reputation": 172, "user_id": 9621551, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4D9XE.jpg?s=128&g=1", "display_name": "Analyst123456789", "link": "https://stackoverflow.com/users/9621551/analyst123456789"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1963, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1592948841, "creation_date": 1525892155, "last_edit_date": 1592948841, "question_id": 50260288, "link": "https://stackoverflow.com/questions/50260288/execute-a-sql-statement-inside-vba-code", "title": "Execute a SQL statement inside VBA Code", "body": "<p>I am attempting to execute a SQL query inside of VBA Code. The query works in MS Access and asks the user to input a value for Customer_Name and Part_Number</p>\n\n<p>What I have done is written the VBA Code in outlook so we can run the macro to execute the query from Outlook. The code I have currently works until the very bottom line on the DoCmd.RunSQL portion. I think I have this syntax incorrect. I need to tell it to run the string of SQL listed above: </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub AppendAllTables()\nPart_Number = InputBox(\"Enter Part Number\")\nCustomer_Name = InputBox(\"Enter Customer Name\")\nDim strsqlQuery As String\nDim Y As String\nY = \"YES, Exact Match\"\nDim P As String\nP = \"Possible Match - Base 6\"\nDim X As String\nX = \"*\"\n\n    strsqlQuery = \"SELECT Append_All_Tables.Customer, \n    Append_All_Tables.CustomerCode, Append_All_Tables.PartNumber, \n    Append_All_Tables.Description, Append_All_Tables.Vehicle, SWITCH\" &amp; \n    Customer_Name &amp; \" = Append_All_Tables.PartNumber, \" &amp; Y &amp; \", LEFT(\" &amp; \n    Part_Number &amp; \",12) = LEFT(Append_All_Tables.PartNumber,12),\" &amp; Y &amp; \", \n    LEFT(\" &amp; Part_Number &amp; \",6) = LEFT(Append_All_Tables.PartNumber,6),\" &amp; P \n    &amp; \") AS Interchangeability FROM Append_All_Tables WHERE\" &amp; Customer_Name \n    &amp; \"Like \" &amp; X &amp; Customer_Name &amp; X &amp; \"AND \n    LEFT(Append_All_Tables.PartNumber,6) = LEFT(\" &amp; Part_Number &amp; \",6);\"\n\nSet appAccess = CreateObject(\"Access.Application\")\nappAccess.OpenCurrentDatabase \"path.accdb\"\nappAccess.DoCmd.RunSQL \"strsqlQuery\"\n\nEnd Sub\n</code></pre>\n\n<p>Please note, the path has been changed for privacy. The SQL code already works in Access. I am only needing the last line to be evaluated.</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 357, "user_id": 7053699, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kfwzm.png?s=128&g=1", "display_name": "brianyates", "link": "https://stackoverflow.com/users/7053699/brianyates"}, "edited": false, "score": 3, "creation_date": 1525892170, "post_id": 50260119, "comment_id": 87538529, "body": "Do you need to count conditional formatting? Why not create a &quot;helper column&quot; that equates to <code>TRUE</code> or <code>FALSE</code> based on whether or not it meets the conditional formatting criteria, then count up the trues?"}, {"owner": {"reputation": 5143, "user_id": 929560, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1be7eb473b1fc17df684e66a977c9bea?s=128&d=identicon&r=PG", "display_name": "InsanityOnABun", "link": "https://stackoverflow.com/users/929560/insanityonabun"}, "reply_to_user": {"reputation": 357, "user_id": 7053699, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kfwzm.png?s=128&g=1", "display_name": "brianyates", "link": "https://stackoverflow.com/users/7053699/brianyates"}, "edited": false, "score": 0, "creation_date": 1525893073, "post_id": 50260119, "comment_id": 87538945, "body": "@BYates that&#39;s actually an incredibly obvious solution that I completely missed, I&#39;ve already added it in and will probably stick with it. I am curious though if something like the original question is possible."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1525893949, "post_id": 50260119, "comment_id": 87539377, "body": "Maybe use <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-displayformat-property-excel\" rel=\"nofollow noreferrer\">DisplayFormat</a> property."}], "owner": {"reputation": 5143, "user_id": 929560, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1be7eb473b1fc17df684e66a977c9bea?s=128&d=identicon&r=PG", "display_name": "InsanityOnABun", "link": "https://stackoverflow.com/users/929560/insanityonabun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 261, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1525893163, "creation_date": 1525891373, "last_edit_date": 1531161705, "question_id": 50260119, "link": "https://stackoverflow.com/questions/50260119/count-number-of-cells-in-a-column-with-conditional-formatting-from-vlookup", "title": "Count number of cells in a column with conditional formatting from VLOOKUP", "body": "<p>I've done some searching and I can't find anything that seems to match up with what I'm trying to do precisely. I'm familiar with Excel, formatting, and formulas, but by no means a master.</p>\n\n<p>I have three sheets - <code>Summary</code> which is where the count value should be done, <code>Tracker</code> which is where the range to count is, and <code>OrigTrackerData</code> which has data used in the conditional formatting formula.</p>\n\n<p>What I'm trying to do is count the number of cells within a certain table column that have a certain conditional formatting rule applied (rule below).</p>\n\n<p>Here is the conditional formatting rule:</p>\n\n<pre><code>=A1&lt;&gt;VLOOKUP($A1,OrigTrackerData!$A:$L,COLUMN(),FALSE)\n</code></pre>\n\n<p>The intent of the rule, which is applied over the entirety of <code>Table710</code> which exists in <code>Tracker</code>, is to determine which cells have changed relative to <code>OrigTrackerData</code>, regardless of row order of the two sheets - column A of both sheets have an \"index\" of sorts.</p>\n\n<p>I've gotten as far as something like <code>=COUNTIF(Table710[Notes], ???)</code> but I can't determine how to convert the conditional formatting formula to a <code>COUNTIF</code> condition.</p>\n\n<p>I am open to accomplishing this via VBA as well - I originally attempted to do so using color functions found here: <a href=\"http://www.cpearson.com/excel/colors.aspx\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/colors.aspx</a> but those functions apparently don't work on colors applied by conditional formatting.</p>\n\n<p>Edit: BYate's comment neatly obviated the need for this. I am curious if something like this is possible though, but now just out of idle curiosity.</p>\n"}, {"tags": ["vba", "excel", "charts"], "comments": [{"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 4, "creation_date": 1525891265, "post_id": 50259934, "comment_id": 87538040, "body": "The first thing to do in these cases is to record a macro while doing what you just described. That will result in some code that you can put in your own code."}, {"owner": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "edited": false, "score": 0, "creation_date": 1525891723, "post_id": 50259934, "comment_id": 87538295, "body": "Probably something like <code>ActiveChart.Location Where:=xlLocationAsObject, Name:=&quot;{SheetName}&quot;</code>"}, {"owner": {"reputation": 1601, "user_id": 1907765, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/ed02bd6c00c0fb529136773bacdd072e?s=128&d=identicon&r=PG&f=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1907765/lou"}, "reply_to_user": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1525893333, "post_id": 50259934, "comment_id": 87539068, "body": "@Sam That&#39;s really helpful, I&#39;ve worked out using your method how to dynamically format the axis labels, series labels and title. What I still can&#39;t work out is how to put the chart on a separate worksheet."}, {"owner": {"reputation": 1601, "user_id": 1907765, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/ed02bd6c00c0fb529136773bacdd072e?s=128&d=identicon&r=PG&f=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1907765/lou"}, "reply_to_user": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "edited": false, "score": 0, "creation_date": 1525893354, "post_id": 50259934, "comment_id": 87539081, "body": "@Jiggles32 I tried the code you suggested, but it only works for existing sheets. I want to create a new sheet and put the chart on there."}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1525894532, "post_id": 50259934, "comment_id": 87539679, "body": "I think <code>ActiveChart.Location Where:=xlLocationAsNewSheet</code> is what you want"}, {"owner": {"reputation": 1601, "user_id": 1907765, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/ed02bd6c00c0fb529136773bacdd072e?s=128&d=identicon&r=PG&f=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1907765/lou"}, "edited": false, "score": 0, "creation_date": 1525895750, "post_id": 50259934, "comment_id": 87540239, "body": "Thanks so much, you&#39;ve helped me work it out :)"}], "answers": [{"tags": [], "owner": {"reputation": 1601, "user_id": 1907765, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/ed02bd6c00c0fb529136773bacdd072e?s=128&d=identicon&r=PG&f=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1907765/lou"}, "is_accepted": false, "score": 1, "last_activity_date": 1525895718, "creation_date": 1525895718, "answer_id": 50261098, "question_id": 50259934, "link": "https://stackoverflow.com/questions/50259934/using-vba-to-create-charts-with-data-labels-based-on-cell-values/50261098#50261098", "title": "Using VBA to create charts with data labels based on cell values", "body": "<p>Thanks to Sam, I was able to work out the code I needed.</p>\n\n<pre><code>Sub createChart()\n\n    Dim myRange As Range\n    Set myRange = Selection\n\n    ActiveSheet.Shapes.AddChart.Select\n    ActiveChart.ChartType = xlColumnClustered\n    ActiveChart.SetSourceData Source:=myRange\n\n    Dim SheetName As String\n    SheetName = Cells(myRange.Row, 2).Value\n    ActiveChart.Location Where:=xlLocationAsNewSheet, Name:=SheetName\n\n    ActiveChart.FullSeriesCollection(1).XValues = \"=Scores!$E$1:$I$1\"\n\n    Dim i As Integer\n\n    For i = 1 To ActiveChart.FullSeriesCollection.Count\n        ActiveChart.FullSeriesCollection(i).Name = \"=Scores!$C\" &amp; myRange.Row + i - 1\n    Next\n\n    ActiveChart.SetElement (msoElementChartTitleAboveChart)\n    ActiveChart.ChartTitle.Select\n    ActiveChart.ChartTitle.Text = \"=Scores!$A\" &amp; myRange.Row\n\nEnd Sub\n</code></pre>\n\n<p>This lets me select the range, click the button, and the chart is created in a new sheet with all of the data labels I need. This should really help me out next time I need to create a chart-based macro.</p>\n"}], "owner": {"reputation": 1601, "user_id": 1907765, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/ed02bd6c00c0fb529136773bacdd072e?s=128&d=identicon&r=PG&f=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1907765/lou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1541, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525895718, "creation_date": 1525890639, "question_id": 50259934, "link": "https://stackoverflow.com/questions/50259934/using-vba-to-create-charts-with-data-labels-based-on-cell-values", "title": "Using VBA to create charts with data labels based on cell values", "body": "<p>I'm completely new to VBA, and would appreciate some guidance. I would like to use a macro that, on a button press, creates a chart</p>\n\n<ol>\n<li>Based on the range selected by the user (shown in the image below)</li>\n<li>On a new worksheet</li>\n<li>With x-axis data labels being set to the top row of headings (the blue range)</li>\n<li>With series labels being set according to the three group labels immediately to the left of the data. (the orange range)</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/SbkB2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SbkB2.png\" alt=\"enter image description here\"></a></p>\n\n<p>So far, all I've succeeded doing is the first one, based on <a href=\"https://stackoverflow.com/a/39453998/1907765\">this answer</a>, resulting in the following code:</p>\n\n<pre><code>Sub CommandButton1_Click()\n    createChart\nEnd Sub\n\nSub createChart()\n    Dim myRange As Range\n    Set myRange = Selection\n\n    ActiveSheet.Shapes.AddChart.Select\n    ActiveChart.ChartType = xlColumnClustered\n    ActiveChart.SetSourceData Source:=myRange\n\n    Cells(1, 1).Select\nEnd Sub\n</code></pre>\n\n<p>Can anyone advise me how I can change this code to create the chart on a new worksheet, and using the data and series labels in a given range of cells? If need be, I can separate these into different questions. Thank you.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7268577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/544958b28d99d330e8ca68b85e9fda9e?s=128&d=identicon&r=PG&f=1", "display_name": "Chameleon", "link": "https://stackoverflow.com/users/7268577/chameleon"}, "is_accepted": false, "score": 0, "last_activity_date": 1525955871, "creation_date": 1525955871, "answer_id": 50273177, "question_id": 50259932, "link": "https://stackoverflow.com/questions/50259932/excel-vba-macro-to-save-series-of-worksheets-to-one-pdf-then-repeat-for-differen/50273177#50273177", "title": "Excel VBA Macro to save series of worksheets to one pdf then repeat for different series of worksheets", "body": "<p>You could amalgamate each set of 4 worksheets into a single worksheet for PDF creation (eg a new worksheet named \"A_PDF\" would contain data from A1 to A4). Use formulas or a macro to copy the data across, depending on the size and structure of each worksheet. Then modify your PDF macro so it only creates one PDF at a time, and create a master macro to loop through the *_PDF worksheets:</p>\n\n<pre><code>Sub MasterPDFCreator()\n\n    Call PDFActiveSheetNoPrompt(Sheets(\"A_PDF\"))\n    Call PDFActiveSheetNoPrompt(Sheets(\"B_PDF\"))\n    Call PDFActiveSheetNoPrompt(Sheets(\"C_PDF\"))\n\nEnd Sub\n\nSub PDFActiveSheetNoPrompt(wsName as Worksheet)\n\n'www.contextures.com\n'for Excel 2010 and later\nDim wsa As Worksheet\nDim wba As Workbook\nDim strName As String\nDim strPath As String\nDim strFile As String\nDim strPathFile As String\nDim myFile As Variant\nOn Error GoTo errHandler\n\nSet wba = ActiveWorkbook\nSet wsa = wsName\n\n'get active workbook folder, if saved\n strPath = wba.Path\nIf strPath = \"\" Then\n  strPath = Application.DefaultFilePath\nEnd If\nstrPath = strPath &amp; \"\\\"\n\nstrName = wsa.Range(\"A1\").Value _\n      &amp; \" - \" &amp; wsa.Range(\"A2\").Value _\n      &amp; \" - \" &amp; wsa.Range(\"A3\").Value\n\n'create default name for saving file\nstrFile = strName &amp; \".pdf\"\nstrPathFile = strPath &amp; strFile\n\n'export to PDF in current folder\n    wsa.ExportAsFixedFormat _\n    Type:=xlTypePDF, _\n    Filename:=strPathFile, _\n    Quality:=xlQualityStandard, _\n    IncludeDocProperties:=True, _\n    IgnorePrintAreas:=False, _\n    OpenAfterPublish:=False\n'confirmation message with file info\n'MsgBox \"PDF file has been created: \" _\n ' &amp; vbCrLf _\n  '&amp; strPathFile\n\nexitHandler:\n    Exit Sub\nerrHandler:\n    MsgBox \"Could not create PDF file\"\n    Resume exitHandler\n\nEnd Sub\n</code></pre>\n\n<p>Not the neatest solution perhaps but I haven't yet found another way of merging sheets into a single PDF.</p>\n"}], "owner": {"reputation": 21, "user_id": 9766306, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dfUuAL2FwiU/AAAAAAAAAAI/AAAAAAAABfk/zMcHXGlC_Xk/photo.jpg?sz=128", "display_name": "user9766306", "link": "https://stackoverflow.com/users/9766306/user9766306"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 575, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1525955871, "creation_date": 1525890635, "last_edit_date": 1525941331, "question_id": 50259932, "link": "https://stackoverflow.com/questions/50259932/excel-vba-macro-to-save-series-of-worksheets-to-one-pdf-then-repeat-for-differen", "title": "Excel VBA Macro to save series of worksheets to one pdf then repeat for different series of worksheets", "body": "<p>Trying for a macro that prints groups of four worksheets to one PDF until all groups of worksheets in the workbook have been printed.</p>\n\n<p>I have a workbook that contains many sets of worksheets. </p>\n\n<p>The worksheets are in sets of four reports: <code>A1, A2, A3, A4, B1, B2, B3, B4...</code>.</p>\n\n<p>I would like to create a macro that allows me to print worksheets <code>A1-A4</code> to one PDF, then repeat for worksheets <code>B1-B4, C1-C4...</code>.</p>\n\n<p>I would like to use a range of cells to name the PDFs. Perhaps on sheet A1, cells <code>A1:A3</code> (sheet <code>B1</code>, cells <code>A1:A3</code>, etc).</p>\n\n<p>The end result would be a folder that contains one PDF for each group of worksheets 1-4.</p>\n\n<p>I have seen macros that do this for one set of worksheets or for selected worksheets, but cannot figure out how to have the macro repeat the process for another set of worksheets after it has completed the first set.</p>\n\n<p>Any tips, hints, tricks, help or points in the right direction would be beneficent, magnanimous. Trying to save gobs of time printing reports every time someone makes a little update to the data...</p>\n\n<p>The following macro (not mine) does this all beautifully for selected worksheets, but not for series of 4 worksheets over and over again.</p>\n\n<pre><code>Sub PDFActiveSheetNoPrompt()\n\n'www.contextures.com\n'for Excel 2010 and later\nDim wsa As Worksheet\nDim wba As Workbook\nDim strName As String\nDim strPath As String\nDim strFile As String\nDim strPathFile As String\nDim myFile As Variant\nOn Error GoTo errHandler\n\nSet wba = ActiveWorkbook\nSet wsa = ActiveSheet\n\nFor Each wsa In ActiveWorkbook.Worksheets\n\n'get active workbook folder, if saved\nstrPath = wba.Path\nIf strPath = \"\" Then\n  strPath = Application.DefaultFilePath\nEnd If\nstrPath = strPath &amp; \"\\\"\n\nstrName = wsa.Range(\"A1\").Value _\n          &amp; \" - \" &amp; wsa.Range(\"A2\").Value _\n          &amp; \" - \" &amp; wsa.Range(\"A3\").Value\n\n'create default name for saving file\nstrFile = strName &amp; \".pdf\"\nstrPathFile = strPath &amp; strFile\n\n'export to PDF in current folder\n    wsa.ExportAsFixedFormat _\n        Type:=xlTypePDF, _\n        Filename:=strPathFile, _\n        Quality:=xlQualityStandard, _\n        IncludeDocProperties:=True, _\n        IgnorePrintAreas:=False, _\n        OpenAfterPublish:=False\n    'confirmation message with file info\n    'MsgBox \"PDF file has been created: \" _\n     ' &amp; vbCrLf _\n      '&amp; strPathFile\n\n    Next\n\nexitHandler:\n    Exit Sub\nerrHandler:\n    MsgBox \"Could not create PDF file\"\n    Resume exitHandler\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1525889810, "post_id": 50259608, "comment_id": 87537294, "body": "Try (&quot;TextBox&quot; &amp; i).Value or Controls(&quot;TextBox&quot; &amp; i).Value"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1525890267, "post_id": 50259608, "comment_id": 87537528, "body": "You may have to use formname.Controls or Me.Controls"}, {"owner": {"reputation": 36, "user_id": 9766571, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ting Fung Li", "link": "https://stackoverflow.com/users/9766571/ting-fung-li"}, "reply_to_user": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1525891106, "post_id": 50259608, "comment_id": 87537953, "body": "It works perfect with Controls(&quot;TextBox&quot; &amp; i).Value, thank you very much."}], "answers": [{"tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 0, "last_activity_date": 1525890588, "creation_date": 1525890588, "answer_id": 50259919, "question_id": 50259608, "link": "https://stackoverflow.com/questions/50259608/vba-for-statement-with-userform-textbox/50259919#50259919", "title": "VBA For statement with userform textbox", "body": "<p>This should work,</p>\n\n<pre><code>Dim i As Long\n\nFor i = 1 to 59\nCells(1,i).Value = Me.Controls(\"TextBox\" &amp; i).Value\nNext\n</code></pre>\n"}], "owner": {"reputation": 36, "user_id": 9766571, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ting Fung Li", "link": "https://stackoverflow.com/users/9766571/ting-fung-li"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525890588, "creation_date": 1525889321, "last_edit_date": 1531164843, "question_id": 50259608, "link": "https://stackoverflow.com/questions/50259608/vba-for-statement-with-userform-textbox", "title": "VBA For statement with userform textbox", "body": "<p>I am using the userform for inputing data and used following codes to trasnfer te data to excel:</p>\n\n<pre><code>    Cells(1,1).Value = Textbox1.Value\n    Cells(1,2).Value = Textbox2.Value\n    Cells(1,3).Value = Textbox3.Value\n......\n    Cells(1,57).Value = Textbox57.Value\n    Cells(1,58).Value = Textbox58.Value\n    Cells(1,59).Value = Textbox59.Value\n</code></pre>\n\n<p>I am going to simplified with the followings</p>\n\n<pre><code>Dim i As integer\n\nFor i = 1 to 59\nCells(1,i).Value = \"Textbox\" &amp; i.Value\nNext\n</code></pre>\n\n<p>But error occurs on the \"Textbox\" &amp; i.Value part</p>\n\n<p>Please suggest, thank you</p>\n"}, {"tags": ["html", "excel", "frames", "vba"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1525889577, "post_id": 50259592, "comment_id": 87537179, "body": "One thing to bear in mind is that <code>IE.readyState &lt;&gt; 4</code> does not pay attention to frame content, i.e. it can return before frames are loaded/ready.  Introduce an artificial delay (set a breakpoint &amp; wait) and see if that makes a difference."}, {"owner": {"reputation": 1, "user_id": 9766579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f874d55fea8d769f9787408e4f22cdd2?s=128&d=identicon&r=PG&f=1", "display_name": "joaocunha", "link": "https://stackoverflow.com/users/9766579/joaocunha"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1525895930, "post_id": 50259592, "comment_id": 87540321, "body": "Thanks for the response Alex. Actually, it does not, I&#39;ve also ran in break mode, and in the original code, I&#39;ve put the application wait for 3 seconds, but didnt make a difference, as the first iframedoc works. I believe there probably is a problem with the way I&#39;m referring to the nested frame."}], "owner": {"reputation": 1, "user_id": 9766579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f874d55fea8d769f9787408e4f22cdd2?s=128&d=identicon&r=PG&f=1", "display_name": "joaocunha", "link": "https://stackoverflow.com/users/9766579/joaocunha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1525897833, "creation_date": 1525889255, "last_edit_date": 1531164843, "question_id": 50259592, "link": "https://stackoverflow.com/questions/50259592/vba-nested-frame-error-handling", "title": "VBA nested frame error handling", "body": "<p>So my problem is that I have to click on an element that is nested within two Frames in a html page. I've tried the following, but keep getting <code>\"run-time error '-2147352319'</code> when I run the line:</p>\n\n<pre><code>Set iframedocy = iframedoc.Frames(\"catalogo\")\n</code></pre>\n\n<p>Here's the complete code:</p>\n\n<pre><code>Sub download()\nDim IE As Object\nDim doc As MSHTML.HTMLDocument\nSet IE = CreateObject(\"internetexplorer.application\")\nIE.navigate \"page\"\nDo While IE.readyState &lt;&gt; 4: DoEvents: Loop\nSet doc = IE.Document    \nSet iframedoc = doc.Frames(\"frmMain\").Document\nSet iframedocy = iframedoc.Frames(\"catalogo\")\niframedocy.getElementsByTagName(\"img\")(0).click\nEnd sub  \n</code></pre>\n\n<p>and here's the relevant part of the html code</p>\n\n<p><a href=\"https://i.stack.imgur.com/ci2uC.png\" rel=\"nofollow noreferrer\">html code</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1742, "user_id": 9463489, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "jblood94", "link": "https://stackoverflow.com/users/9463489/jblood94"}, "edited": false, "score": 1, "creation_date": 1525888961, "post_id": 50259477, "comment_id": 87536875, "body": "Did you save and reopen? Variables stored in memory will be lost when the code recompiled when you added the button."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1525889382, "post_id": 50259477, "comment_id": 87537078, "body": "Would you happen to have an <code>End</code> instruction anywhere by any chance?"}, {"owner": {"reputation": 315, "user_id": 4534796, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/efb7a1f078cc0924d400ddc530222272?s=128&d=identicon&r=PG", "display_name": "GRoston", "link": "https://stackoverflow.com/users/4534796/groston"}, "edited": false, "score": 0, "creation_date": 1525984445, "post_id": 50259477, "comment_id": 87578757, "body": "No End instruction"}], "answers": [{"comments": [{"owner": {"reputation": 315, "user_id": 4534796, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/efb7a1f078cc0924d400ddc530222272?s=128&d=identicon&r=PG", "display_name": "GRoston", "link": "https://stackoverflow.com/users/4534796/groston"}, "edited": false, "score": 0, "creation_date": 1525984419, "post_id": 50259845, "comment_id": 87578743, "body": "All - thanks for the feedback and allowing me to clarify. The form on the existing spreadsheet works regardless of how many times it is opened/closed. When I add any control to the form, and then manually execute the Workbook_Open subroutine (in order to define the global variables), the form works properly the first time is it opened, but fails to work properly thereafter. The global variables are the symptom of the problem, not the cause."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 315, "user_id": 4534796, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/efb7a1f078cc0924d400ddc530222272?s=128&d=identicon&r=PG", "display_name": "GRoston", "link": "https://stackoverflow.com/users/4534796/groston"}, "edited": false, "score": 0, "creation_date": 1525991172, "post_id": 50259845, "comment_id": 87581242, "body": "@GRoston so... does that mean it&#39;s fixed or not?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 315, "user_id": 4534796, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/efb7a1f078cc0924d400ddc530222272?s=128&d=identicon&r=PG", "display_name": "GRoston", "link": "https://stackoverflow.com/users/4534796/groston"}, "edited": false, "score": 0, "creation_date": 1526046610, "post_id": 50259845, "comment_id": 87603977, "body": "FWIW If you&#39;re not going to show us any code, that&#39;s likely the only possible answer you can get."}, {"owner": {"reputation": 315, "user_id": 4534796, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/efb7a1f078cc0924d400ddc530222272?s=128&d=identicon&r=PG", "display_name": "GRoston", "link": "https://stackoverflow.com/users/4534796/groston"}, "edited": false, "score": 0, "creation_date": 1526091689, "post_id": 50259845, "comment_id": 87621045, "body": "Not fixed. I will &#39;answer my own question&#39; in order to provide a link to the code and specific instructions to show the issue."}, {"owner": {"reputation": 315, "user_id": 4534796, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/efb7a1f078cc0924d400ddc530222272?s=128&d=identicon&r=PG", "display_name": "GRoston", "link": "https://stackoverflow.com/users/4534796/groston"}, "edited": false, "score": 0, "creation_date": 1526092431, "post_id": 50259845, "comment_id": 87621143, "body": "Problem (?) solved?? If I save and exit Excel, then re-open the file, the weird behavior goes away. Per the above comments, it is almost as if the execution context is stopped each time the form is closed during the session in which it was edited. Not sure what to say/think - I have done lots of Excel macro work and do not recall ever having experienced this oddness. Should I mark someone&#39;s response as being the answer?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 315, "user_id": 4534796, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/efb7a1f078cc0924d400ddc530222272?s=128&d=identicon&r=PG", "display_name": "GRoston", "link": "https://stackoverflow.com/users/4534796/groston"}, "edited": false, "score": 0, "creation_date": 1526132652, "post_id": 50259845, "comment_id": 87629695, "body": "@GRoston again, it&#39;s pretty hard to tell what&#39;s going on without seeing that form&#39;s code."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 4, "last_activity_date": 1525891722, "last_edit_date": 1525891722, "creation_date": 1525890216, "answer_id": 50259845, "question_id": 50259477, "link": "https://stackoverflow.com/questions/50259477/global-variables-inexplicably-reset-when-adding-form-controls/50259845#50259845", "title": "Global variables inexplicably reset when adding form controls", "body": "<p>Grasping at straws for lack of proper context, but here's a fix for the most likely scenario.</p>\n\n<p>You likely have your globals assigned like this:</p>\n\n<pre><code>Private Sub Workbook_Open()\n    SomeGlobalVariable = 42\n    AnotherGlobalVariable = \"foo\"\nEnd Sub\n</code></pre>\n\n<p>Pull that out of the handler:</p>\n\n<pre><code>Private Sub Workbook_Open()\n    AssignGlobalDefaults\nEnd Sub\n</code></pre>\n\n<p>...and have this <code>AssignGlobalDefaults</code> procedure live in a standard module (.bas):</p>\n\n<pre><code>Option Explicit\nOption Private Module\nPublic SomeGlobalVariable As Long\nPublic AnotherGlobalVariable As String\n\nPublic Sub AssignGlobalDefaults()\n    SomeGlobalVariable = 42\n    AnotherGlobalVariable = \"foo\"\nEnd Sub\n</code></pre>\n\n<p>Now when you make changes to the project that require recompiling the VBA code, go to the <em>immediate pane</em> (Ctrl+G) and type <code>AssignGlobalDefaults</code> before testing your code.</p>\n\n<p>Save, then close. Now reopen. Still broken? Doubt so.</p>\n\n<hr>\n\n<p>Global variables live in the <em>runtime context</em>. If the code is running, then they're alive. When you kill that context, global variables are still accessible, but since <code>Workbook_Open</code> is the only thing that assigns them (right?) and that handler only ever runs <em>when the workbook is being opened</em>, then the values aren't going to be automagically re-assigned.</p>\n\n<p>The <code>End</code> keyword kills the execution context - if that keyword is anywhere in your code, remove it. Typing <code>End</code> in the <em>immediate pane</em> will do the same.</p>\n\n<p>Changing project references also kills the execution context. Removing a module from the project does the same.</p>\n\n<p>In other words, you can never assume that you can make changes to the VBA project and preserve global variable values. Sometimes it works, sometimes it doesn't, depending on what you've changed and how it affects the underlying P-Code.</p>\n\n<p>The solution is to have a procedure responsible for initializing your globals, and to invoke it when you need your globals to be initialized.</p>\n"}], "owner": {"reputation": 315, "user_id": 4534796, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/efb7a1f078cc0924d400ddc530222272?s=128&d=identicon&r=PG", "display_name": "GRoston", "link": "https://stackoverflow.com/users/4534796/groston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1525899279, "creation_date": 1525888780, "last_edit_date": 1525899279, "question_id": 50259477, "link": "https://stackoverflow.com/questions/50259477/global-variables-inexplicably-reset-when-adding-form-controls", "title": "Global variables inexplicably reset when adding form controls", "body": "<p>I have a MS Excel spreadsheet that contains macros and that has worked flawlessly for years. I have copied and modified the spreadsheet innumerable times without issue. Until today. I made a copy of an existing, properly functioning file and ran into an inexplicable issue: </p>\n\n<p>The spreadsheet includes a user-form that gathers certain data, some of which comes from option buttons contained within a frame. The data gathered is compared to global variables whose values are set in the workbook's Workbook_Open subroutine. For the existing workbook, I can beat on the form as hard as I want without issue. In the copy, I added an option button to the frame (that it - nothing else!) and upon clicking the form's 'submit' button, the values of the global variables are lost. (And this is without selecting the new option button.)</p>\n\n<p>This behavior is repeatable and makes no sense. Can anyone suggest why Excel is behaving this strangely? Note - the file does not have any external references.</p>\n\n<p>Update: This behavior happens when any new controls are added to the form...</p>\n"}, {"tags": ["excel", "vba"], "owner": {"reputation": 11, "user_id": 9241458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5311f0b27d69492a2477d9c9ab6fe35?s=128&d=identicon&r=PG&f=1", "display_name": "Tejas Kore", "link": "https://stackoverflow.com/users/9241458/tejas-kore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1525888755, "creation_date": 1525888755, "last_edit_date": 1531164843, "question_id": 50259466, "link": "https://stackoverflow.com/questions/50259466/hold-on-the-flow-of-execution-vba-excel", "title": "Hold on the flow of execution VBA Excel", "body": "<p>I am trying to automate mail sending process. Now, the code which I have is working fine. But I want to add more functionality to it.</p>\n\n<p>After ML.Display in the below code snippet, I want to hold on the flow of execution. ML.Display will display the mail which is ready. After that I want to add the functionality which is I should be able to send the mail by clicking on send mail button if i want and if I don't then I will close the mail template. Right now I am achieving the same functionality by using message box. </p>\n\n<p>As soon as I take the action i.e. either I send the mail or I close the ready template then the flow which was hold off should resume execution.</p>\n\n<pre><code>.\n. \nML.To = Madd ' address\nML.CC = MaddCC 'CC\nML.Subject = \"Testing\"\n\nML.Display\n\nanswer = MsgBox(\"To continue select YES\", vbYesNo)\nIf answer = vbYes Then\nOn Error GoTo ErrCatcher\nML.Send 'sending\nElse\nMws.Cells(j, 9).Value = \"Not Send\"\nEnd If\nOn Error GoTo 0\nErrCatcher:\nIf Err &lt;&gt; 0 Then Mws.Cells(j, 8).Value = \"Name Resolution Failed\"\n'Else\n' Mws.Cells(j, 9).Value = \"Not Send\"\n'End If\n\nj = j + 1\n.\n.\n.\n</code></pre>\n\n<p>Any suggestions/solutions are welcome.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1525888023, "post_id": 50259111, "comment_id": 87536405, "body": "<code>Like</code> works for simple stuff. For anything non-trivial (like <i>alternatives</i>), look into <i>regular expressions</i> instead."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1525888038, "post_id": 50259264, "comment_id": 87536417, "body": "You&#39;ll probably want to <code>Exit For</code> when a match is found."}], "tags": [], "owner": {"reputation": 848, "user_id": 9221684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gcnG9.jpg?s=128&g=1", "display_name": "warner_sc", "link": "https://stackoverflow.com/users/9221684/warner-sc"}, "is_accepted": false, "score": 2, "last_activity_date": 1525888170, "last_edit_date": 1525888170, "creation_date": 1525887970, "answer_id": 50259264, "question_id": 50259111, "link": "https://stackoverflow.com/questions/50259111/vba-variable-with-multiple-value-text/50259264#50259264", "title": "VBA : variable with multiple value (text)", "body": "<p>What about this..</p>\n\n<pre><code>Sub testsearch()\n\n    Application.ScreenUpdating = False\n\n    Dim string_patterns As Variant\n\n    string_patterns = Array(\"_[ang]\", \"[fre]\", \"_[ger]\")\n\n    For Each cel In ActiveSheet.Range(\"H1:H\" &amp; Range(\"H\" &amp; Rows.Count).End(xlUp).Row)\n\n        For Each element In string_patterns\n\n            If cel Like \"*\" &amp; CStr(element) &amp; \"*\" Then\n                cel.Offset(0, 4) = CStr(element)\n                Exit For\n            End If\n\n        Next element\n\n    Next cel\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 6767178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65312288b908fc33e559f6293b5c0e52?s=128&d=identicon&r=PG&f=1", "display_name": "orlin", "link": "https://stackoverflow.com/users/6767178/orlin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1525888170, "creation_date": 1525887381, "last_edit_date": 1531164843, "question_id": 50259111, "link": "https://stackoverflow.com/questions/50259111/vba-variable-with-multiple-value-text", "title": "VBA : variable with multiple value (text)", "body": "<p>Really inexperienced in VBA\nI'm trying to built a macro searching differents strings in multiple columns.\nI'm searching pattern like : \"<em>[ang]\" \"</em>[fre]\" \"_[ger]</p>\n\n<p>For now, I'm able to find _[ang] in column H, but I think there's a way to find all three patterns with one formula. Important part is to add a note in a specific cell (that's why I use cel.Offset(0, 4))</p>\n\n<pre><code>Sub testsearch()\n    For Each cel In ActiveSheet.Range(\"H1:H\" &amp; Range(\"H\" &amp; Rows.Count).End(xlUp).Row)\n        If cel Like \"*_[ang]*\" Then\n            cel.Offset(0, 4) = \"_[ang]\"\n        End If\n    Next cel\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1525888203, "post_id": 50259019, "comment_id": 87536505, "body": "What&#39;s the cell value? If it&#39;s a cell error, then it&#39;s not a string and can&#39;t be converted to one."}, {"owner": {"reputation": 1041, "user_id": 1811159, "user_type": "registered", "accept_rate": 27, "profile_image": "https://i.stack.imgur.com/JBmj0.png?s=128&g=1", "display_name": "Nicholas Humphrey", "link": "https://stackoverflow.com/users/1811159/nicholas-humphrey"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1525888283, "post_id": 50259019, "comment_id": 87536549, "body": "Thanks, The cell value is of Text type after the conversion by .NumberFormat = &quot;@&quot;"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1525888302, "post_id": 50259019, "comment_id": 87536563, "body": "NumberFormat won&#39;t make a cell error turn into a string; use <code>IsError</code> to validate your values. Also, how many cells are in <code>.Range(&quot;TableExport[CARD]&quot;)</code>? If the answer is anything other than 1, then you&#39;re working with an array, not a string. <code>Right</code> wants a string, not an array."}], "answers": [{"comments": [{"owner": {"reputation": 1041, "user_id": 1811159, "user_type": "registered", "accept_rate": 27, "profile_image": "https://i.stack.imgur.com/JBmj0.png?s=128&g=1", "display_name": "Nicholas Humphrey", "link": "https://stackoverflow.com/users/1811159/nicholas-humphrey"}, "edited": false, "score": 0, "creation_date": 1525889259, "post_id": 50259357, "comment_id": 87537012, "body": "Thanks! Now it works, I had no idea that it would become a two dim array. Really helpful!"}], "tags": [], "owner": {"reputation": 695, "user_id": 7343313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OB1ru.png?s=128&g=1", "display_name": "jonyfries", "link": "https://stackoverflow.com/users/7343313/jonyfries"}, "is_accepted": true, "score": 5, "last_activity_date": 1525888391, "creation_date": 1525888391, "answer_id": 50259357, "question_id": 50259019, "link": "https://stackoverflow.com/questions/50259019/vba-use-right-on-range/50259357#50259357", "title": "VBA use right() on range", "body": "<p>You can't use RIGHT on a range and need to use it on the specific elements.\nAlso, because you're setting the array equal to a range it will be a two dimensional array which is why <code>arrCard(cardnum)</code> wouldn't work and you have to use <code>arrCard(cardnum,1)</code>.</p>\n\n<pre><code>Dim arrCard As Variant\nDim cardnum As Long\n\nWith ThisWorkbook.Sheets(1)\n    .Range(\"CARD\").NumberFormat = \"@\"\n    arrCard = .Range(\"CARD\").Value\n    For cardnum = LBound(arrCard, 1) To UBound(arrCard, 1)\n        arrCard(cardnum, 1) = Right(arrCard(cardnum, 1), 4)\n    Next cardnum\n    .Range(\"L2:L10000\") = arrCard\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1041, "user_id": 1811159, "user_type": "registered", "accept_rate": 27, "profile_image": "https://i.stack.imgur.com/JBmj0.png?s=128&g=1", "display_name": "Nicholas Humphrey", "link": "https://stackoverflow.com/users/1811159/nicholas-humphrey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 325, "favorite_count": 0, "accepted_answer_id": 50259357, "answer_count": 1, "score": 1, "last_activity_date": 1525888391, "creation_date": 1525887061, "last_edit_date": 1525887556, "question_id": 50259019, "link": "https://stackoverflow.com/questions/50259019/vba-use-right-on-range", "title": "VBA use right() on range", "body": "<p>I'm trying to put the last 4 characters of a table column into an array and dump to column L. I'm using array because it's faster:</p>\n\n<pre><code>Dim arrCard() As String\n.Range(\"TableExport[CARD]\").NumberFormat = \"@\"\narrCard = Right(.Range(\"TableExport[CARD]\").Text, 4)\n.Range(\"L2:L10000\") = arrCard\n</code></pre>\n\n<p>Then it says </p>\n\n<blockquote>\n  <p>type mismatch</p>\n</blockquote>\n\n<p>which doesn't make sens, as CARD column is already text. Does that mean that I cannot use Right() on a range? But I do see a lot of examples use this method (except they do not apply on table columns)</p>\n\n<p>I also tried:</p>\n\n<pre><code>Dim arrCard() As Variant\nDim cardnum As Integer\n.Range(\"TableExport[CARD]\").NumberFormat = \"@\"\narrCard = Right(.Range(\"TableExport[CARD]\").Text, 4)\n.Range(\"L2:L10000\") = arrCard\n</code></pre>\n\n<p>Then it complains about Type Mismatch on the 4th line. TBH I don't get it, it doesn't seem to be a hell amount of requirement.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 7237850, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uIj12.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/7237850/chris"}, "edited": false, "score": 0, "creation_date": 1525966622, "post_id": 50258924, "comment_id": 87569706, "body": "Sorry for my ignorance, how can I change the tab separator for tilde you use stSeparator = vbTab   for tilde it should be stSeparator = ~?  Additionally, the macro I use exports all sheets to a separate txt file and uses the sheet name for file name adding &quot;PO&quot; at the beginning"}, {"owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "reply_to_user": {"reputation": 29, "user_id": 7237850, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uIj12.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/7237850/chris"}, "edited": false, "score": 0, "creation_date": 1525969357, "post_id": 50258924, "comment_id": 87571249, "body": "I&#39;ve edited my answer to show one way of doing what you want."}, {"owner": {"reputation": 29, "user_id": 7237850, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uIj12.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/7237850/chris"}, "edited": false, "score": 0, "creation_date": 1525971521, "post_id": 50258924, "comment_id": 87572501, "body": "Thanks Olly. this is exactly what I&#39;m looking for. I modified the code to start at row 2.   Thanks again, you helped great deal"}], "tags": [], "owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "is_accepted": true, "score": 0, "last_activity_date": 1525969324, "last_edit_date": 1525969324, "creation_date": 1525886622, "answer_id": 50258924, "question_id": 50258824, "link": "https://stackoverflow.com/questions/50258824/export-in-tilde-delimited/50258924#50258924", "title": "Export in tilde delimited", "body": "<p>Here's one approach, which would be easy to modify to suit - this gives you control over the character set and the delimiter:</p>\n\n<p><a href=\"https://excel.solutions/2014/04/using-vba-write-excel-data-to-text-file/\" rel=\"nofollow noreferrer\">https://excel.solutions/2014/04/using-vba-write-excel-data-to-text-file/</a></p>\n\n<pre><code>Sub WriteTextFile()\n\nDim rng As Range, lRow As Long\nDim stOutput As String, stNextLine As String, stSeparator As String\nDim stFilename As String, stEncoding As String\nDim fso As Object\n\n'-------------------------------------------------------------------------------------\n'CHANGE THESE PARAMETERS TO SUIT\nSet rng = ActiveSheet.UsedRange 'this is the range which will be written to text file\nstFilename = \"C:\\Temp\\TextOutput.txt\" 'this is the text file path / name\nstSeparator = vbTab 'e.g. for comma seperated value, change this to \",\"\nstEncoding = \"UTF-8\" 'e.g. \"UTF-8\", \"ASCII\"\n'-------------------------------------------------------------------------------------\n\nFor lRow = 1 To rng.Rows.Count\n    If rng.Columns.Count = 1 Then\n        stNextLine = rng.Rows(lRow).Value\n    Else\n        stNextLine = Join$(Application.Transpose(Application.Transpose(rng.Rows(lRow).Value)), stSeparator)\n    End If\n    If stOutput = \"\" Then\n        stOutput = stNextLine\n    Else\n        stOutput = stOutput &amp; vbCrLf &amp; stNextLine\n    End If\nNext lRow\n\nSet fso = CreateObject(\"ADODB.Stream\")\nWith fso\n    .Type = 2\n    .Charset = stEncoding\n    .Open\n    .WriteText stOutput\n    .SaveToFile stFilename, 2\nEnd With\nSet fso = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>I'm sure you could adapt that to loop through your worksheets, and output the UsedRange of each.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Here's how to adapt it to use tilde as separator, and loop through each worksheet;</p>\n\n<pre><code>Sub OutputAllSheetsTildeSeparated()\n\n    Dim rng As Range, lRow As Long\n    Dim stOutput As String, stNextLine As String, stSeparator As String\n    Dim stFilepath As String, stFilename As String, stEncoding As String\n    Dim ws As Worksheet\n    Dim fso As Object\n\n    stFilepath = ThisWorkbook.Path &amp; \"\\\" &amp; Left(ThisWorkbook.Name, Len(ThisWorkbook.Name) - 4)\n    stSeparator = \"~\"\n    stEncoding = \"UTF-8\"\n\n    If Dir(stFilepath, vbDirectory) = vbNullString Then MkDir stFilepath\n\n    For Each ws In ThisWorkbook.Worksheets\n        Set rng = ws.UsedRange\n        stFilename = stFilepath &amp; \"\\PO\" &amp; ws.Name &amp; \".txt\"\n\n        For lRow = 1 To rng.Rows.Count\n            If rng.Columns.Count = 1 Then\n                stNextLine = rng.Rows(lRow).Value\n            Else\n                stNextLine = Join$(Application.Transpose(Application.Transpose(rng.Rows(lRow).Value)), stSeparator)\n            End If\n            If stOutput = \"\" Then\n                stOutput = stNextLine\n            Else\n                stOutput = stOutput &amp; vbCrLf &amp; stNextLine\n            End If\n        Next lRow\n\n        Set fso = CreateObject(\"ADODB.Stream\")\n        With fso\n            .Type = 2\n            .Charset = stEncoding\n            .Open\n            .WriteText stOutput\n            .SaveToFile stFilename, 2\n        End With\n        Set fso = Nothing\n\n    Next ws\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 7237850, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uIj12.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/7237850/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 739, "favorite_count": 0, "accepted_answer_id": 50258924, "answer_count": 1, "score": 2, "last_activity_date": 1570772060, "creation_date": 1525886255, "last_edit_date": 1570772060, "question_id": 50258824, "link": "https://stackoverflow.com/questions/50258824/export-in-tilde-delimited", "title": "Export in tilde delimited", "body": "<p>I first create files in Excel. This macro saves all sheets into separate tab delimited text files. </p>\n\n<p>How can I save with a tilde \"~\" instead of a tab?</p>\n\n<pre><code>Sub newworkbooks()\n    Dim Sheet As Worksheet, SheetName$, MyFilePath$, N&amp;\n    MyFilePath$ = ActiveWorkbook.Path &amp; \"\\\" &amp; _\n    Left(ThisWorkbook.Name, Len(ThisWorkbook.Name) - 4)\n    With Application\n        .ScreenUpdating = False\n        .DisplayAlerts = False\n         '      End With\n        On Error Resume Next '&lt;&lt; a folder exists\n        MkDir MyFilePath '&lt;&lt; create a folder\n        For N = 1 To Sheets.Count\n            Sheets(N).Activate\n            SheetName = ActiveSheet.Name\n            Cells.Copy\n            Workbooks.Add (xlWBATWorksheet)\n            With ActiveWorkbook\n                With .ActiveSheet\n                    .Paste\n                    .Name = SheetName\n                    [A1].Select\n                End With\n                 'save book in this folder\n                .saveas Filename:=MyFilePath _\n                &amp; \"\\PO\" &amp; SheetName &amp; \".txt\", FileFormat:=xlTextWindows\n                .Close SaveChanges:=True\n            End With\n            .CutCopyMode = False\n        Next\n    End With\n    Sheet1.Activate\n\nEnd Sub\n</code></pre>\n\n<p>Instead of looking like the following</p>\n\n<pre><code>this   is   a   test\n</code></pre>\n\n<p>it should look like this</p>\n\n<pre><code>this~is~a~test\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 4, "creation_date": 1525884290, "post_id": 50258108, "comment_id": 87534498, "body": "This question would be best answered on <a href=\"https://codereview.stackexchange.com\">Code Review</a>, given a title that <i>describes the purpose of the code</i> (as opposed to what you need to fix about it)."}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1525885187, "post_id": 50258108, "comment_id": 87534968, "body": "An idea to try out - add a nonsense variable to the method and give it a unique value in every call. That might give the wished effect."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 7501251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e56ada0c3bdd193c6fd8cacf5906641d?s=128&d=identicon&r=PG&f=1", "display_name": "Faiz", "link": "https://stackoverflow.com/users/7501251/faiz"}, "edited": false, "score": 0, "creation_date": 1525894879, "post_id": 50259206, "comment_id": 87539829, "body": "This did make it a bit faster."}], "tags": [], "owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "is_accepted": true, "score": 2, "last_activity_date": 1525887751, "creation_date": 1525887751, "answer_id": 50259206, "question_id": 50258108, "link": "https://stackoverflow.com/questions/50258108/improve-speed-of-vba-application-volatile/50259206#50259206", "title": "Improve Speed of VBA - Application Volatile", "body": "<p>When I was looking into an issue with a UDF recently, I found a page with (semi) helpful info <a href=\"https://support.microsoft.com/en-us/help/170787/description-of-limitations-of-custom-functions-in-excel\" rel=\"nofollow noreferrer\">here</a>. I just want to emphasis that:</p>\n\n<blockquote>\n  <p>For correct calculation, all ranges that are used in the calculation should be passed to the function as arguments. If you do not pass the calculation ranges as arguments, instead of referring to the ranges within the VBA code of the function, Excel cannot account for them within the calculation engine.</p>\n</blockquote>\n\n<p>In other words, Excel uses the parameters passed to the function to determine when recalculation is required.</p>\n\n<p>You are correct in your belief that <code>Application.Volatile</code> is slowing things down. Using <code>Application.Volatile</code> tells Excel that it <strong>always</strong> need to recalculate this formula whenever <strong>anything</strong> changes.</p>\n\n<p>And you are right that currently, how your code is formatted, the function requires <code>Application.Volatile</code> to stay updated. One potential way of eliminating <code>Application.Volatile</code> is to change your function to require the needed range(s) reference as a parameter. Something like the below:</p>\n\n<pre><code>Private Function EstimateFunctions(ByVal calc As String, ByVal rangesum as Range, Optional rangeapproved as Range, Optional ByVal repdate As Date)\n</code></pre>\n\n<hr>\n\n<p>Whenever you reference ranges within a UDF, but not as a parameter passed into the function, Excel is unable to correctly determine proper precedence for the calculation order, or which other ranges the UDF is dependent on.</p>\n\n<p>As far as determining if it's possible to rework your code <em>so that passing all referenced ranges as parameters is a feasible solution</em> -- I would follow Mathieu Guindon's suggestion about going over to <a href=\"https://codereview.stackexchange.com/\">Code Review</a>....</p>\n"}, {"tags": [], "owner": {"reputation": 1742, "user_id": 9463489, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "jblood94", "link": "https://stackoverflow.com/users/9463489/jblood94"}, "is_accepted": false, "score": 0, "last_activity_date": 1525888380, "creation_date": 1525888380, "answer_id": 50259355, "question_id": 50258108, "link": "https://stackoverflow.com/questions/50258108/improve-speed-of-vba-application-volatile/50259355#50259355", "title": "Improve Speed of VBA - Application Volatile", "body": "<p><code>Application.Volatile</code> isn't slowing down the code, it simply tells the worksheet to recalculate the function whenever <em>any</em> cell is changed in the worksheet. The code runs just as fast--<code>Application.Volatile</code> simply causes it to run much more frequently.</p>\n\n<p><strong>Two ways I can think of to avoid Application.Volatile:</strong></p>\n\n<p>1) Include all the ranges that may affect the function as input parameters. Then Excel will know when to recalculate based on the dependency tree. This may not be practical--it looks like you have 100-200 named ranges that your function may be referencing.</p>\n\n<p>2) Use the worksheet object's <code>Worksheet_Change</code> event. Check whether the <code>Target</code> range is a range of interest (possibly by using <code>Application.Intersect</code>), and call a macro to update Row 8.</p>\n\n<p>You should be able to speed up your code by directly referencing ranges instead of using <code>WorksheetFunction.Index</code>. For example, change</p>\n\n<pre><code>temphrs = WorksheetFunction.Index(Range(rangesum), 0, Application.Caller.Column - (WorksheetFunction.Index(Range(rangesum), 0, 1).Column - 1))\n</code></pre>\n\n<p>to </p>\n\n<pre><code>temphrs = Range(rangesum).cells(1, Application.Caller.Column - Range(rangesum).Column + 1)\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 7501251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e56ada0c3bdd193c6fd8cacf5906641d?s=128&d=identicon&r=PG&f=1", "display_name": "Faiz", "link": "https://stackoverflow.com/users/7501251/faiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 794, "favorite_count": 0, "closed_date": 1525890182, "accepted_answer_id": 50259206, "answer_count": 2, "score": 0, "last_activity_date": 1528717462, "creation_date": 1525883491, "last_edit_date": 1528717462, "question_id": 50258108, "link": "https://stackoverflow.com/questions/50258108/improve-speed-of-vba-application-volatile", "closed_reason": "Needs more focus", "title": "Improve Speed of VBA - Application Volatile", "body": "<p>I do not have much experience with VBA, and therefore need the help of this community for the following issue encountered:</p>\n\n<p>I used application volatile in my code to run a series of calculation which slowed it down considerably. Without application volatile the code is fast enough for my purposes, but does not calculate/update row 8 (green row) when I change one of the input cells. Cell E8 (Image attached/ green row) references an estimate function which has several cases but will not update when any of cells in column E (or other columns) are changed without the use of Application Volatile. </p>\n\n<p>So I am pretty sure whats causing it to slow down is application volatile, but I dont see away around this. Anyway I can go around using application volatile, or what step should I take to make it run faster. I've tried a bunch of things but to no avail. I am considering to remove the functions completely and add formulas to those Row 8 Cells (green). </p>\n\n<pre><code>Private Function EstimateFunctions(ByVal calc As String, Optional ByVal repdate As Date)\n\n    'update1 As Range, update2 As Range\n\n    Application.Volatile\n\n    Dim rangeapproved As String\n    Dim rangesum As String\n\n    tempsum = 0\n\n    Select Case calc\n\n    Case \"SumHrs\"\n\n        For n = 1 To 10 Step 1\n            rangesum = \"P\" + CStr(n) + \"_RESOURCE_HOURS\"\n            rangeapproved = \"P\" + CStr(n) + \"_APPROVAL\"\n\n            If RangeExists(rangesum) = False Then Exit For\n\n            If Range(rangeapproved).Value = \"Y\" Then\n                temphrs = WorksheetFunction.Index(Range(rangesum), 0, Application.Caller.Column - (WorksheetFunction.Index(Range(rangesum), 0, 1).Column - 1))\n            Else\n                temphrs = 0\n            End If\n\n            If temphrs = \"-\" Then temphrs = 0\n            finalsum = finalsum + temphrs\n\n        Next n\n\n        If finalsum = 0 Then finalsum = \"\"\n        EstimateFunctions = finalsum\n\n\n    Case \"SumQty\"\n\n        For n = 1 To 10 Step 1\n            rangesum = \"P\" + CStr(n) + \"_EXPENSE_QTY\"\n            rangeapproved = \"P\" + CStr(n) + \"_APPROVAL\"\n\n            If RangeExists(rangesum) = False Then Exit For\n\n            If Range(rangeapproved).Value = \"Y\" Then\n                tempsum = WorksheetFunction.Index(Range(rangesum), 0, Application.Caller.Column - (WorksheetFunction.Index(Range(rangesum), 0, 1).Column - 1))\n            Else\n                tempsum = 0\n            End If\n\n            If tempsum = \"-\" Then tempsum = 0\n            finalsum = finalsum + tempsum\n\n        Next n\n\n        If finalsum = 0 Then finalsum = \"\"\n        EstimateFunctions = finalsum\n\n\n    Case \"SumActuals\"\n\n        For n = 1 To 10 Step 1\n            rangesum = \"P\" + CStr(n) + \"_ACTUALS_SUMMARY\"\n\n            If RangeExists(rangesum) = False Then Exit For\n            tempsum = WorksheetFunction.Index(Range(rangesum), 0, Application.Caller.Column - (WorksheetFunction.Index(Range(rangesum), 0, 1).Column - 1))\n\n            If tempsum = \"\" Then tempsum = 0\n            finalsum = finalsum + tempsum\n\n        Next n\n\n        EstimateFunctions = finalsum\n\n\n    Case \"SumDateActuals\"\n\n        For n = 1 To 10 Step 1\n            rangesum = \"P\" + CStr(n) + \"_ACTUALS_DATECOST\"\n\n            If RangeExists(rangesum) = False Then Exit For\n            tempsum = WorksheetFunction.Index(Range(rangesum), 0, Application.Caller.Column - (WorksheetFunction.Index(Range(rangesum), 0, 1).Column - 1))\n\n            If tempsum = \"\" Then tempsum = 0\n            finalsum = finalsum + tempsum\n\n        Next n\n\n        EstimateFunctions = finalsum\n\n\n    Case \"SumPerformance\"\n\n        For n = 1 To 10 Step 1\n            rangesum = \"P\" + CStr(n) + \"_PERFORMANCE_SUMMARY\"\n            rangeapproved = \"P\" + CStr(n) + \"_APPROVAL\"\n\n            If RangeExists(rangesum) = False Then Exit For\n\n            If Range(rangeapproved).Value = \"Y\" Then\n                tempsum = WorksheetFunction.Index(Range(rangesum), 0, Application.Caller.Column - (WorksheetFunction.Index(Range(rangesum), 0, 1).Column - 1))\n            Else\n                tempsum = 0\n            End If\n\n            If tempsum = \"\" Then tempsum = 0\n            finalsum = finalsum + tempsum\n\n        Next n\n\n        EstimateFunctions = finalsum\n\n\n    Case \"SumEarnedValue\"\n\n        For n = 1 To 10 Step 1\n            rangesum = \"P\" + CStr(n) + \"_EARNED_VALUE\"\n            rangeapproved = \"P\" + CStr(n) + \"_APPROVAL\"\n\n            If RangeExists(rangesum) = False Then Exit For\n\n            If Range(rangeapproved).Value = \"Y\" Then\n                tempsum = WorksheetFunction.Index(Range(rangesum), 0, Application.Caller.Column - (WorksheetFunction.Index(Range(rangesum), 0, 1).Column - 1))\n            Else\n                tempsum = 0\n            End If\n\n            If tempsum = \"-\" Then tempsum = 0\n            finalsum = finalsum + tempsum\n\n        Next n\n\n        EstimateFunctions = finalsum\n\n\n    Case \"SumPercentComplete\"\n\n        For n = 1 To 10 Step 1\n            rangesum = \"P\" + CStr(n) + \"_PERCENT_COMPLETE\"\n            rangeapproved = \"P\" + CStr(n) + \"_BUDGET_SUMMARY\"\n\n            If RangeExists(rangesum) = False Then Exit For\n\n            temp1 = WorksheetFunction.Index(Range(rangeapproved), 0, 3).Value\n            temp2 = WorksheetFunction.Index(Range(rangesum), 0, Application.Caller.Column - (WorksheetFunction.Index(Range(rangesum), 0, 1).Column - 1))\n\n            If temp2 = \"\" Then temp2 = 0\n\n            tempsum = temp1 * temp2\n\n            'If tempsum = \"\" Then tempsum = 0\n            finalsum = finalsum + tempsum\n\n        Next n\n\n        If finalsum = 0 Then\n            EstimateFunctions = \"\"\n        Else\n            EstimateFunctions = finalsum / WorksheetFunction.Index(Range(\"SUMMARY_BUDGET\"), 0, 3)\n        End If\n\n\n    Case \"SumActualExpense\"\n\n        For n = 1 To 10 Step 1\n            rangesum = \"P\" + CStr(n) + \"_ACTUAL_EXPENSES\"\n\n            If RangeExists(rangesum) = False Then Exit For\n\n            tempsum = WorksheetFunction.Index(Range(rangesum), 0, Application.Caller.Column - (WorksheetFunction.Index(Range(rangesum), 0, 1).Column - 1))\n\n            If tempsum = \"\" Then tempsum = 0\n            finalsum = finalsum + tempsum\n\n        Next n\n\n        EstimateFunctions = finalsum\n\n\n    Case \"SumExpenseForecast\"\n\n        For n = 1 To 10 Step 1\n            rangesum = \"P\" + CStr(n) + \"_ACTUALS_SUMMARY\"\n\n            If RangeExists(rangesum) = False Then Exit For\n\n            tempsum = WorksheetFunction.Index(Range(rangesum), 0, 4)\n\n            If tempsum = \"\" Then tempsum = 0\n            finalsum = finalsum + tempsum\n\n        Next n\n\n        EstimateFunctions = finalsum\n\n\n    Case \"SumCont\"\n\n        For n = 1 To 10 Step 1\n            rangesum = \"P\" + CStr(n) + \"_LABOUR_SUMMARY\"\n\n            If RangeExists(rangesum) = False Then Exit For\n\n            tempsum = WorksheetFunction.Index(Range(rangesum), 0, 5)\n\n            If tempsum = \"\" Then tempsum = 0\n            finalsum = finalsum + tempsum\n\n        Next n\n\n        EstimateFunctions = finalsum\n\n    End Select\n\nEnd Function\n</code></pre>\n\n<h3>Screenshot</h3>\n\n<p><img src=\"https://i.stack.imgur.com/r4TZz.png\" alt=\"Screenshot\"></p>\n"}, {"tags": ["vba", "excel", "report", "advanced-filter"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9766075, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cZl8bZlVVP4/AAAAAAAAAAI/AAAAAAAAAG8/vM0DZBQPljY/photo.jpg?sz=128", "display_name": "James Ling", "link": "https://stackoverflow.com/users/9766075/james-ling"}, "edited": false, "score": 0, "creation_date": 1525938827, "post_id": 50265509, "comment_id": 87553924, "body": "I have copied the headers from the data set onto the criteria range, still same problem. I have also checked manually for at least one row that matches my current criteria.  Is there any way I can upload a screenshot or the whole file for review?"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 13, "user_id": 9766075, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cZl8bZlVVP4/AAAAAAAAAAI/AAAAAAAAAG8/vM0DZBQPljY/photo.jpg?sz=128", "display_name": "James Ling", "link": "https://stackoverflow.com/users/9766075/james-ling"}, "edited": false, "score": 0, "creation_date": 1525940559, "post_id": 50265509, "comment_id": 87554743, "body": "You can upload the file to either one drive or google drive or dropbox and then share the link here."}, {"owner": {"reputation": 13, "user_id": 9766075, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cZl8bZlVVP4/AAAAAAAAAAI/AAAAAAAAAG8/vM0DZBQPljY/photo.jpg?sz=128", "display_name": "James Ling", "link": "https://stackoverflow.com/users/9766075/james-ling"}, "edited": false, "score": 0, "creation_date": 1525944630, "post_id": 50265509, "comment_id": 87556745, "body": "Thanks, if you wouldn&#39;t mind having a look for me:  <a href=\"https://www.dropbox.com/s/kj5e80dafgkbxzm/Job%20Register%20Dashboard.xlsx?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/kj5e80dafgkbxzm/&hellip;</a>"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 13, "user_id": 9766075, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cZl8bZlVVP4/AAAAAAAAAAI/AAAAAAAAAG8/vM0DZBQPljY/photo.jpg?sz=128", "display_name": "James Ling", "link": "https://stackoverflow.com/users/9766075/james-ling"}, "edited": false, "score": 0, "creation_date": 1525958029, "post_id": 50265509, "comment_id": 87564281, "body": "I have added an edited code for you. Please give it a try. There were several issues like date criteria was not date but a text string etc. I have also removed the formulas from the criteria range and placed the criteria through the code itself once you hit the Get Data button. The file is working and here is the file link for you. <a href=\"https://www.dropbox.com/s/l3cqpd813ykwxc6/Job%20Register%20Dashboard.xlsm?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/l3cqpd813ykwxc6/&hellip;</a>"}, {"owner": {"reputation": 13, "user_id": 9766075, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cZl8bZlVVP4/AAAAAAAAAAI/AAAAAAAAAG8/vM0DZBQPljY/photo.jpg?sz=128", "display_name": "James Ling", "link": "https://stackoverflow.com/users/9766075/james-ling"}, "edited": false, "score": 0, "creation_date": 1525968522, "post_id": 50265509, "comment_id": 87570760, "body": "Wow! Thank you so much! On to the next challenge - to see if Excel will let me create a dynamic chart based on that data. I think this is going to be a longer project than I imagined, but hopefully I&#39;ll learn lots of useful Excel skills for later on."}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 0, "last_activity_date": 1525957919, "last_edit_date": 1525957919, "creation_date": 1525926623, "answer_id": 50265509, "question_id": 50258072, "link": "https://stackoverflow.com/questions/50258072/excel-advanced-filter-not-returning-any-data/50265509#50265509", "title": "Excel advanced filter not returning any data", "body": "<p>If the code is only returning headers that means you have either one of these issue. </p>\n\n<ol>\n<li>You don't have any matching data as per the criteria set in the range <code>Sheets(\"RawData\").Range(\"W1:AA2\")</code>. Manually check for those criteria in the data set and see if you find any matching rows.</li>\n<li>And if you find some matching rows, there must be an issue with the headers you put in the range <code>W1:AA1</code> on Sheet <code>RawData</code>. <strong>The headers in the criteria range must be exactly same as headers in the data set</strong>. Check for any leading or trailing spaces as well.</li>\n</ol>\n\n<p><strong>Edited Code:</strong></p>\n\n<p>Here is the edited code. Please give this a try...</p>\n\n<pre><code>Sub GetData()\nDim sws As Worksheet, dws As Worksheet\n\nApplication.ScreenUpdating = False\n\nSet sws = Sheets(\"RawData\")\nSet dws = Sheets(\"Filter\")\n\n'Clearing the Criteria Range\nsws.Range(\"W2:AA2\").ClearContents\n\nIf dws.Range(\"C3\") = \"\" Or dws.Range(\"C3\").Value = \"Any\" Then\n    sws.Range(\"X2\").Value = \"\"\nElse\n    sws.Range(\"X2\").Value = dws.Range(\"C3\").Value\nEnd If\n\nIf dws.Range(\"C4\") = \"\" Or dws.Range(\"C4\").Value = \"Any\" Then\n    sws.Range(\"Z2\").Value = \"\"\nElse\n    sws.Range(\"Z2\").Value = dws.Range(\"C4\").Value\nEnd If\n\nIf dws.Range(\"C5\") = \"\" Or dws.Range(\"C5\").Value = \"Any\" Then\n    sws.Range(\"Y2\").Value = \"\"\nElse\n    sws.Range(\"Y2\").Value = dws.Range(\"C5\").Value\nEnd If\n\nIf dws.Range(\"C6\") = \"\" Or dws.Range(\"C6\").Value = \"Any\" Then\n    sws.Range(\"AA2\").Value = \"\"\nElse\n    sws.Range(\"AA2\").Value = dws.Range(\"C6\").Value\nEnd If\n\nIf dws.Range(\"C7\") = \"\" Or dws.Range(\"C7\").Value = \"Any\" Then\n    sws.Range(\"W2\").Value = \"\"\nElse\n    sws.Range(\"W2\").Value = dws.Range(\"C7\").Value\nEnd If\n\n\n'Clear data field\n\ndws.Range(\"B10\").CurrentRegion.Clear\n\n'Advanced Filter code\nsws.Range(\"JobRegister[#All]\").AdvancedFilter Action:=xlFilterCopy, CriteriaRange:= _\n    sws.Range(\"W1:AA2\"), CopyToRange:=dws.Range(\"B10:T10\"), Unique:=True\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9766075, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cZl8bZlVVP4/AAAAAAAAAAI/AAAAAAAAAG8/vM0DZBQPljY/photo.jpg?sz=128", "display_name": "James Ling", "link": "https://stackoverflow.com/users/9766075/james-ling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2387, "favorite_count": 0, "accepted_answer_id": 50265509, "answer_count": 1, "score": 1, "last_activity_date": 1525957919, "creation_date": 1525883344, "last_edit_date": 1525883982, "question_id": 50258072, "link": "https://stackoverflow.com/questions/50258072/excel-advanced-filter-not-returning-any-data", "title": "Excel advanced filter not returning any data", "body": "<p>Trying to get a working filter for quick report building - as seen <a href=\"https://chandoo.org/wp/2012/11/27/extract-subset-of-data/\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>My code at the moment reads like this:</p>\n\n<pre><code>Option Explicit\nSub GetData()\n\n'Clear data field\n\n    Sheets(\"Filter\").Select\n    Range(\"B10\").Select\n    Range(Selection, Selection.End(xlToRight)).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Clear\n\n'Advanced Filter code\n\n    Sheets(\"RawData\").Range(\"JobRegister[#All]\").AdvancedFilter Action:=xlFilterCopy, CriteriaRange:= _\n        Sheets(\"RawData\").Range(\"W1:AA2\"), CopyToRange:=Sheets(\"Filter\").Range(\"B10:T10\"), Unique:=True\n\n\n\n    Range(\"B10\").Select\n\nEnd Sub\n</code></pre>\n\n<p>And it only returns the column headers and no results, regardless of what I use as criteria. </p>\n\n<p>My criteria filters look like this:</p>\n\n<pre><code>=IF(Filter!C4=\"Any\",\"\",Filter!C4)\n</code></pre>\n\n<p>Where C4 contains a DV list drawn from another sheet.</p>\n\n<p>I had it sort of working temporarily (it would filter for some criteria, not others) but I don't know what it was that I did to make it work nor why it's not working any more!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1525883371, "post_id": 50258048, "comment_id": 87534012, "body": "<i>Local/temporary somewhere</i> doesn&#39;t exist on my machine. Where specifically is it on yours?"}, {"owner": {"reputation": 45, "user_id": 9670450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef2451658ebc10388293e02bc22fcd0?s=128&d=identicon&r=PG&f=1", "display_name": "Adem", "link": "https://stackoverflow.com/users/9670450/adem"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1525883935, "post_id": 50258048, "comment_id": 87534325, "body": "Users/XXX/Library/Containers/com.microsoft.Excel/Data/Deskto&zwnj;&#8203;p/AdminExport.CSV    Which seems to be a folder called &#39;Desktop&#39;, and not the desktop it self :)"}, {"owner": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "edited": false, "score": 0, "creation_date": 1525884193, "post_id": 50258048, "comment_id": 87534449, "body": "I could be wrong here, but shouldn&#39;t <code>ActiveWorkbook.Path</code> instead be <code>Application.ActiveWorkbook.Path</code> ? Alternatively, <code>ThisWorkbook.path</code> uses the path of the workbook with the code in it, not the &quot;currently active&quot; one."}, {"owner": {"reputation": 45, "user_id": 9670450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef2451658ebc10388293e02bc22fcd0?s=128&d=identicon&r=PG&f=1", "display_name": "Adem", "link": "https://stackoverflow.com/users/9670450/adem"}, "edited": false, "score": 0, "creation_date": 1525884477, "post_id": 50258048, "comment_id": 87534599, "body": "Well, you could be wrong or right, i am very unsure of this code to be honest. I&#39;m going to try it, and write back in 5 min :)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "edited": false, "score": 1, "creation_date": 1525884486, "post_id": 50258048, "comment_id": 87534601, "body": "@Jiggles32 <code>Application.ActiveWorkbook</code> is just fully-qualifying <code>ActiveWorkbook</code> - both are one and the same (there are no namespaces in VBA). Same as <code>MsgBox</code> vs <code>VBA.Interaction.MsgBox</code> or <code>VBA.MsgBox</code> or <code>Interaction.MsgBox</code>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1525884528, "post_id": 50258048, "comment_id": 87534629, "body": "That said your code needs some <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">proper and consistent indentation</a>"}, {"owner": {"reputation": 45, "user_id": 9670450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef2451658ebc10388293e02bc22fcd0?s=128&d=identicon&r=PG&f=1", "display_name": "Adem", "link": "https://stackoverflow.com/users/9670450/adem"}, "edited": false, "score": 0, "creation_date": 1525884586, "post_id": 50258048, "comment_id": 87534663, "body": "If it helps guys, i see that the file is being named &quot;Desktop\\AdminExport.csv&quot;"}, {"owner": {"reputation": 45, "user_id": 9670450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef2451658ebc10388293e02bc22fcd0?s=128&d=identicon&r=PG&f=1", "display_name": "Adem", "link": "https://stackoverflow.com/users/9670450/adem"}, "edited": false, "score": 0, "creation_date": 1525884686, "post_id": 50258048, "comment_id": 87534710, "body": "Thanks Mathieu, i changed it! :)"}, {"owner": {"reputation": 45, "user_id": 9670450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef2451658ebc10388293e02bc22fcd0?s=128&d=identicon&r=PG&f=1", "display_name": "Adem", "link": "https://stackoverflow.com/users/9670450/adem"}, "edited": false, "score": 0, "creation_date": 1525884736, "post_id": 50258048, "comment_id": 87534736, "body": "But are you able to help me with it though Mathieu? :-)"}, {"owner": {"reputation": 45, "user_id": 9670450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef2451658ebc10388293e02bc22fcd0?s=128&d=identicon&r=PG&f=1", "display_name": "Adem", "link": "https://stackoverflow.com/users/9670450/adem"}, "edited": false, "score": 0, "creation_date": 1525885168, "post_id": 50258048, "comment_id": 87534951, "body": "I asked the question 2 times before this one, but noone was able to fix it."}, {"owner": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "edited": false, "score": 1, "creation_date": 1525885357, "post_id": 50258048, "comment_id": 87535056, "body": "Well, one option would be to force the path, rather than making it dynamic, but it depends what you need. Or a half-way dynamic and non-dynamic way <code>Pth = Environ(&quot;USERPROFILE&quot;) &amp; &quot;\\Desktop&quot;</code>"}, {"owner": {"reputation": 45, "user_id": 9670450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef2451658ebc10388293e02bc22fcd0?s=128&d=identicon&r=PG&f=1", "display_name": "Adem", "link": "https://stackoverflow.com/users/9670450/adem"}, "edited": false, "score": 0, "creation_date": 1525885639, "post_id": 50258048, "comment_id": 87535188, "body": "It needs to be dynamic, as its supposed to get send to other people, where it should also save on their desktop :) If possible.."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1525888301, "post_id": 50258048, "comment_id": 87536561, "body": "The only thing I see that will cause the file to save in the wrong folder is if the activeworkbook is in the wrong place. try <code>msgbox pth</code> somewhere in the code and see if it is the correct path. When you have <code>sh.move</code> that sheet becomes the active sheet, but it still does not change the value of <code>Pth</code>"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1525887870, "post_id": 50258909, "comment_id": 87536312, "body": "While valid 99% of the time, <code>C:\\Users</code> is making too many assumptions for my taste. I&#39;d go with <code>path = Environ$(&quot;USERPROFILE&quot;) &amp; &quot;\\Desktop\\&quot; &amp; filename</code> for a more robust solution."}, {"owner": {"reputation": 848, "user_id": 9221684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gcnG9.jpg?s=128&g=1", "display_name": "warner_sc", "link": "https://stackoverflow.com/users/9221684/warner-sc"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1525888428, "post_id": 50258909, "comment_id": 87536628, "body": "Thank you @MathieuGuindon, that&#39;s new for me!"}, {"owner": {"reputation": 45, "user_id": 9670450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef2451658ebc10388293e02bc22fcd0?s=128&d=identicon&r=PG&f=1", "display_name": "Adem", "link": "https://stackoverflow.com/users/9670450/adem"}, "edited": false, "score": 0, "creation_date": 1525902523, "post_id": 50258909, "comment_id": 87543141, "body": "Cheers everybody, thanks for the help. My only problem now is, that the data is so weird when being pasted into the CSV file.. Gonna make a new question with that"}, {"owner": {"reputation": 45, "user_id": 9670450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef2451658ebc10388293e02bc22fcd0?s=128&d=identicon&r=PG&f=1", "display_name": "Adem", "link": "https://stackoverflow.com/users/9670450/adem"}, "edited": false, "score": 0, "creation_date": 1525943404, "post_id": 50258909, "comment_id": 87556078, "body": "USERPROFILE - What am i supposed to write there, since its different userprofiles? :-)  I will mark your questions as acceptable, how do it do it?? :)"}, {"owner": {"reputation": 45, "user_id": 9670450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef2451658ebc10388293e02bc22fcd0?s=128&d=identicon&r=PG&f=1", "display_name": "Adem", "link": "https://stackoverflow.com/users/9670450/adem"}, "edited": false, "score": 0, "creation_date": 1525943605, "post_id": 50258909, "comment_id": 87556192, "body": "Mathieu, it gives me error in If Dir(Pth, vbArchive) &lt;&gt; vbNullString Then"}, {"owner": {"reputation": 848, "user_id": 9221684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gcnG9.jpg?s=128&g=1", "display_name": "warner_sc", "link": "https://stackoverflow.com/users/9221684/warner-sc"}, "edited": false, "score": 0, "creation_date": 1525964440, "post_id": 50258909, "comment_id": 87568384, "body": "You dont need to change <code>user_id = Environ$(&quot;USERPROFILE&quot;)</code> and just tested the line <code>If Dir(Pth, vbArchive) &lt;&gt; vbNullString Then</code> it works for me, what kind of error its showing?"}], "tags": [], "owner": {"reputation": 848, "user_id": 9221684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gcnG9.jpg?s=128&g=1", "display_name": "warner_sc", "link": "https://stackoverflow.com/users/9221684/warner-sc"}, "is_accepted": false, "score": 1, "last_activity_date": 1525888378, "last_edit_date": 1525888378, "creation_date": 1525886573, "answer_id": 50258909, "question_id": 50258048, "link": "https://stackoverflow.com/questions/50258048/csv-saves-on-wrong-location/50258909#50258909", "title": "CSV saves on wrong location", "body": "<p>Try using <code>Environ$(\"USERPROFILE\")</code> to create a default desktop save path, then create a simple message box with YesNo option as the code shows:</p>\n\n<pre><code>Sub Opgave8()\n    Dim sh As Worksheet\n    Dim Pth As String\n\n    Application.ScreenUpdating = False\n\n    ' Create default desktop path using windows user id\n    user_id = Environ$(\"USERPROFILE\")\n    ' Create full path\n    file_name$ = \"\\AdminExport.csv\"\n    Pth = user_id &amp; \"\\Desktop\" &amp; file_name\n\n    Set sh = Sheets.Add\n\n    For i = 2 To 18288\n        If Left(Worksheets(\"Base\").Cells(i, 12), 6) = \"262015\" Then\n            sh.Cells(i, 2) = Worksheets(\"Base\").Cells(i, 4)\n        End If\n    Next i\n\n    sh.Move\n\n    If Dir(Pth, vbArchive) &lt;&gt; vbNullString Then\n        overwrite_question = MsgBox(\"File already exist, do you want to overwrite it?\", vbYesNo)\n    End If\n\n    If overwrite_question = vbYes Then\n        With ActiveWorkbook\n            .SaveAs Filename:=Pth, FileFormat:=xlCSV\n            .Close False\n        End With\n    End If\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n\nFunction UniqueRandDigits(x As Long) As String\n    Dim i As Long\n    Dim n As Integer\n    Dim s As String\n    Do\n        n = Int(Rnd() * 10)\n        If InStr(s, n) = 0 Then\n            s = s &amp; n\n            i = i + 1\n        End If\n    Loop Until i = x + 1\n\n    UniqueRandDigits = s\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 9670450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef2451658ebc10388293e02bc22fcd0?s=128&d=identicon&r=PG&f=1", "display_name": "Adem", "link": "https://stackoverflow.com/users/9670450/adem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1525888684, "creation_date": 1525883249, "last_edit_date": 1531164843, "question_id": 50258048, "link": "https://stackoverflow.com/questions/50258048/csv-saves-on-wrong-location", "title": "CSV saves on wrong location", "body": "<p>My code is saving in Local/temporary somewhere - It's supposed to save on Desktop, AND if it already exists, ask before overwriting. Can you help me?</p>\n\n<pre><code>Sub Opgave8()\n    Dim sh As Worksheet\n    Dim Pth As String\n    Application.ScreenUpdating = False\n    Pth = ActiveWorkbook.Path\n    Set sh = Sheets.Add\n\n    For i = 2 To 18288\n        If Left(Worksheets(\"Base\").Cells(i, 12), 6) = \"262015\" Then\n            sh.Cells(i, 2) = Worksheets(\"Base\").Cells(i, 4)\n        End If\n    Next i\n\n    sh.Move\n    With ActiveWorkbook\n        .SaveAs Filename:=Pth &amp; \"\\AdminExport.csv\", FileFormat:=xlCSV\n        .Close False\n    End With\n    Application.ScreenUpdating = True\n\nEnd Sub\nFunction UniqueRandDigits(x As Long) As String\n    Dim i As Long\n    Dim n As Integer\n    Dim s As String\n    Do\n        n = Int(Rnd() * 10)\n        If InStr(s, n) = 0 Then\n            s = s &amp; n\n            i = i + 1\n        End If\n    Loop Until i = x + 1\n\n    UniqueRandDigits = s\nEnd Function\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "edited": false, "score": 1, "creation_date": 1525883620, "post_id": 50257903, "comment_id": 87534149, "body": "IMHO, if creating a new database with replicated code worked, the problem would likely reside in the old database, but not within the code. One of several possibilities could be a corruption in the database. Or some sort of global variable screwing with your declarations. But, no, it does not appear (to me) that anything is obviously incorrect."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1525883845, "post_id": 50257903, "comment_id": 87534277, "body": "That&#39;s a lot of <code>With</code>s, some of them nested. I&#39;ve noticed oddities with nested <code>With</code>s previously that I couldn&#39;t diagnose. Can you try to declare all variables explicitly and not use any?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1525888934, "post_id": 50257903, "comment_id": 87536866, "body": "@Erikvonasmuth I&#39;ll try that when I&#39;m back in the office. I just hope it isn&#39;t corruption -I&#39;ve only just finished rebuilding it from text files after losing all the VBA previously."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1525902755, "post_id": 50257903, "comment_id": 87543213, "body": "Why are you running &#39;DML_Clear_tmp_LunchPatterns&#39; every time you make a pass through? Doesn&#39;t that clear all your temp time periods? I don&#39;t see any code that fills those in before you prompt for a new pattern. Unless I&#39;m missing something obvious - that would result in blank times"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1525903974, "post_id": 50257903, "comment_id": 87543618, "body": "Yes, sorry I should have explained that. The form uses <code>List_LunchPatterns</code> as its data source. A combo box using <code>List_LunchPattern_Names</code> filters the form to the relevant data. The combo box also has a <i>New Pattern</i> option which changes the source to the <code>tmp_LunchPatterns</code> table allowing the user to create a new 7 day pattern and compare it against existing patterns before committing it to the final table. Bit off a faff come to think about it now... might be better to use a batch update &amp; not a temp table."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1525916959, "post_id": 50257903, "comment_id": 87546709, "body": "Sorry I can&#39;t imagine that but in any case that&#39;s where I&#39;d be checking. Put a Pause Code on the line <code>With .QueryDefs(&quot;DML_Add_NewLunchPattern&quot;)</code> and manually check the tmp table befoe the query is allowed to run. If it&#39;s empty you have the problem source. If it&#39;s full and it gets filled correctly after you step thru the query then it might need a <code>DoEvents</code> before running to insure the data has been processed before your query runs."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1526026876, "post_id": 50257903, "comment_id": 87592060, "body": "@dbmitch.  Sorry, would&#39;ve tested earlier but can never take illness into account. :)  After checking the tables it&#39;s looking more like a problem with the changing record source as the new times I add after I&#39;ve changed the source to <code>tmp_LunchPatterns</code> do no appear in the table.  I&#39;ll add this pretty important detail to the question and probably come up with the solution while doing it."}], "answers": [{"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 0, "last_activity_date": 1526030944, "creation_date": 1526030944, "answer_id": 50289229, "question_id": 50257903, "link": "https://stackoverflow.com/questions/50257903/insert-and-update-parameter-queries-not-working-when-executed-from-code/50289229#50289229", "title": "INSERT and UPDATE Parameter queries not working when executed from code", "body": "<p>It turns out the answer was simple, kind of obvious and not likely to get answered on my first iteration of the question as I'd left out the key points (see edits in the question).  </p>\n\n<p>The scenario is a <code>Continuous Form</code> linked to a table containing seven empty records, save for the Primary Key listing the number range 1 to 7.<br>\nThe user enters data to one or more of these records and then clicks the <em>Save</em> button which transfers all records entered to the final table.  </p>\n\n<p>The problem here is that the controls you entered data into and the button are on the same form so the last record entered isn't saved when you click the button.<br>\nWhile looking up the order of events to explain this I found this:  </p>\n\n<blockquote>\n  <p>Q1. If data is entered in one or more fields on the main form and the\n  user then clicks the button that opens the message box, is the record\n  saved?  </p>\n  \n  <p>No, if the button is on the main form. However, you sometimes\n  want to save a record (perhaps to print the values) so in the OnClick\n  event you'd have something like If Me.Dirty then Me.Dirty = False in\n  order to force a save.</p>\n  \n  <p><a href=\"https://bytes.com/topic/access/answers/204281-when-record-saved\" rel=\"nofollow noreferrer\">Bytes.com - When is a record saved?</a>  </p>\n</blockquote>\n\n<p>So the answer was to add </p>\n\n<pre><code>If Me.Dirty Then Me.Dirty = False  \n</code></pre>\n\n<p>to the start of the <code>btnCreateLunchPattern_Click()</code> procedure.  </p>\n\n<p><hr>\n<em>In light of this - the question doesn't really fit the answer now.  Should I just delete the question?  Reword it so it fits the answer?  Ask on meta?</em></p>\n"}], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 50289229, "answer_count": 1, "score": 0, "last_activity_date": 1594635159, "creation_date": 1525882728, "last_edit_date": 1594635159, "question_id": 50257903, "link": "https://stackoverflow.com/questions/50257903/insert-and-update-parameter-queries-not-working-when-executed-from-code", "title": "INSERT and UPDATE Parameter queries not working when executed from code", "body": "<p>I'm having trouble getting three parameter queries to return any results when executed within code.  </p>\n\n<p>The queries work fine if I manually execute them, and when I copied the relevant tables, queries and VBA code into a new database to try and create a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> it worked fine as well....  </p>\n\n<p>My three tables are: </p>\n\n<p><strong>Table:</strong>  <code>List_LunchPattern_Names</code></p>\n\n<ul>\n<li><code>PatternID</code> (AutoNumber &amp; Primary Key)  </li>\n<li><code>Pattern_Name</code> (Text)  </li>\n</ul>\n\n<p><strong>Table:</strong>  <code>List_LunchPatterns</code>  </p>\n\n<ul>\n<li><code>PatternID</code> (Number &amp; Primary Key - Long Integer)  </li>\n<li><code>Pattern_Step</code> (Number &amp; Primary Key - Long Integer)  </li>\n<li><code>LunchStart1</code>, <code>LunchEnd1</code>, <code>LunchStart2</code> and <code>LunchEnd2</code> (Date/Time - Short Time)  </li>\n</ul>\n\n<p><strong>Table:</strong>  <code>tmp_LunchPatterns</code>  </p>\n\n<ul>\n<li><code>Pattern_Step</code> (Number &amp; Primary Key - Long Integer)<br>\nPre-populated with numbers 1 - 7 representing days of the week.</li>\n<li><code>LunchStart1</code>, <code>LunchEnd1</code>, <code>LunchStart2</code> and <code>LunchEnd2</code> (Date/Time - Short Time) </li>\n</ul>\n\n<p>The three queries are:  </p>\n\n<p><strong>Query:</strong>  <code>DML_Add_NewLunchPattern_Name</code>  </p>\n\n<pre><code>PARAMETERS  New_Pattern_Name Text ( 255 );\nINSERT INTO List_LunchPattern_Names ( Pattern_Name )\nVALUES      (New_Pattern_Name);  \n</code></pre>\n\n<p><strong>Query:</strong>  <code>DML_Add_NewLunchPattern</code>  </p>\n\n<pre><code>PARAMETERS  Pattern_Identifier Long;\nINSERT INTO List_LunchPatterns ( \n                PatternID, Pattern_Step, LunchStart1, \n                LunchEnd1, LunchStart2, LunchEnd2 \n                                )\nSELECT      Pattern_Identifier, Pattern_Step, LunchStart1\n            , LunchEnd1, LunchStart2, LunchEnd2\nFROM        tmp_LunchPatterns;  \n</code></pre>\n\n<p><strong>Query:</strong> <code>DML_Clear_tmp_LunchPatterns</code>  </p>\n\n<pre><code>UPDATE  tmp_LunchPatterns \nSET     LunchStart1 = NULL, LunchEnd1 = NULL\n        , LunchStart2 = NULL, LunchEnd2 = NULL;  \n</code></pre>\n\n<p>The code sits behind a button on the <code>List_LunchPatterns</code> form:  </p>\n\n<pre><code>Private Sub btnCreateLunchPattern_Click()\n\n    Dim sResult As String\n    Dim sExisting As Variant\n    Dim lNewID As Long\n    Dim db As DAO.Database\n\n    On Error GoTo ERR_HANDLE\n\n    sResult = InputBox(\"Please provide a unique name for the new lunch pattern.\", \"Lunch Patterns\")\n    sResult = Trim(sResult)\n    If Len(sResult) = 0 Then\n        'No entry.\n    Else\n        sExisting = DLookup(\"Pattern_Name\", \"List_LunchPattern_Names\", \"Pattern_Name='\" &amp; sResult &amp; \"'\")\n        If sExisting &lt;&gt; \"\" Then\n            'Existing entry.\n            MsgBox \"'\" &amp; sResult &amp; \"' already exists.  Please choose another name.\", vbOKOnly + vbInformation\n        Else\n            'Valid answer.\n            Set db = CurrentDb\n\n            'Add the new name to the pattern name list.\n            'Add the temporary times into the final table.\n            'Clear the temporary table, requery the combo-box for the new name\n            With db\n                With .QueryDefs(\"DML_Add_NewLunchPattern_Name\")\n                    .Parameters(\"New_Pattern_Name\") = sResult\n                    .Execute\n                End With\n                lNewID = DLookup(\"PatternID\", \"List_LunchPattern_Names\", \"Pattern_Name='\" &amp; sResult &amp; \"'\")\n                With .QueryDefs(\"DML_Add_NewLunchPattern\")\n                    .Parameters(\"Pattern_Identifier\") = lNewID\n                    .Execute\n                End With\n                .QueryDefs(\"DML_Clear_tmp_LunchPatterns\").Execute\n            End With\n\n            With Me\n                .cmbPattern_Selector.Requery\n                .cmbPattern_Selector = lNewID\n                .RecordSource = \"List_LunchPatterns\"\n                FilterForm Me, \"PatternID=\" &amp; .cmbPattern_Selector\n            End With\n\n        End If\n    End If\n\nEXIT_PROC:\n\n        On Error GoTo 0\n        Exit Sub\n\nERR_HANDLE:\n        DisplayError Err.Number, Err.Description, \"Form_List_LunchPatterns.btnCreateLunchPattern_Click()\"\n        Resume EXIT_PROC\n\nEnd Sub  \n</code></pre>\n\n<p>The <code>FilterForm</code> procedure used at the bottom of the code is:  </p>\n\n<pre><code>Public Sub FilterForm(frm As Object, FilterString As String)\n\n    On Error GoTo ERR_HANDLE\n\n    With frm\n        .Filter = FilterString\n        .FilterOn = True\n    End With\n\nEXIT_PROC:\n        On Error GoTo 0\n        Exit Sub\n\nERR_HANDLE:\n    Select Case Err.Number\n\n    Case Else\n        DisplayError Err.Number, Err.Description, \"mdl_FormFilter.FilterForm()\"\n        Resume EXIT_PROC\n    End Select\n\nEnd Sub\n</code></pre>\n\n<h1>The question:</h1>\n\n<p>If I copy the QueryDefs part of the code and all tables/queries to a new database and run it it works fine, if I manually run each query it works fine, if I run it using this block of code above then <code>DML_Add_NewLunchPattern_Name</code> works fine, but the second query only partially works and the last doesn't at all.<br>\nThe second query adds seven records using the correct <code>PatternID</code>, but the start and end times are blank even though the seven records must have come from the temp table which contains the start/end times as expected.  </p>\n\n<p>Is there anything obvious I'm missing?   </p>\n\n<h2>Edit:</h2>\n\n<p>In trying to keep my question minimal it looks like I missed out a pretty important part.<br>\nThe <code>List_LunchPattern_Names</code> table is used to populate a combo-box on the form which filters the records displayed from <code>List_LunchPatterns</code> to the relevant pattern.<br>\nThe <code>Row Source</code> for the combo-box is:  </p>\n\n<pre><code>SELECT DISTINCT 0 AS PatternID\n                , '&lt;New Pattern&gt;' AS Pattern_Name \nFROM            SingleRecord \n\nUNION SELECT    PatternID, Pattern_Name \nFROM            List_LunchPattern_Names \nORDER BY        PatternID  \n</code></pre>\n\n<p>The first option on the combo-box is to create a new pattern.  Choosing this changes the forms <code>RecordSource</code> to the temp table so the new pattern can be entered and checked against existing patterns before being finalised.<br>\nThe code for this is below, and I <em>think</em> the problem is that the form needs a refresh or a requery to finish off the change of record source.  </p>\n\n<pre><code>Private Sub cmbPattern_Selector_AfterUpdate()\n\n    On Error GoTo ERR_HANDLE\n\n    With Me\n\n        'If the selected pattern is different from the currently\n        'active pattern unhide the Assign Pattern button.\n        If Not IsNull(OpenArgs) Then\n            If .cmbPattern_Selector &lt;&gt; Split(OpenArgs, \"|\")(2) Then\n                .btnAssignLunchPattern.Visible = True\n            End If\n        End If\n\n        If .cmbPattern_Selector &lt;&gt; 0 Then\n            .cmbPattern_Selector.SetFocus\n            .btnCreateLunchPattern.Visible = False\n            .RecordSource = \"List_LunchPatterns\"\n            FilterForm Me, \"PatternID=\" &amp; .cmbPattern_Selector\n        Else\n            .btnCreateLunchPattern.Visible = True\n            .RecordSource = \"tmp_LunchPatterns\"\n            .btnAssignLunchPattern.Visible = False\n        End If\n\n    End With\n\nEXIT_PROC:\n\n        On Error GoTo 0\n        Exit Sub\n\nERR_HANDLE:\n        DisplayError Err.Number, Err.Description, \"Form_List_LunchPatterns.cmbPattern_Selector_AfterUpdate()\"\n        Resume EXIT_PROC\n\nEnd Sub  \n</code></pre>\n\n<h2>Edit 2:</h2>\n\n<p>This is turning into more of an exercise in making sure I tested everything correctly first.  </p>\n\n<p>It's only the last record I add to the temp table that gets ignored during the update queries - I didn't see this on earlier tests as I was only adding a single record.  For example, adding times to Monday and Tuesday will create a pattern using Monday only, while Tuesday remains in the temp table - even after I execute the query to clear the table.<br>\nThis leads me to believe that when I exit the control for the time period to click the button which finalises the pattern that record isn't added to the table until after the click event has finished, so at the start of the click event I should either <code>DoEvents</code> or save the record.....</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1525882386, "post_id": 50257547, "comment_id": 87533463, "body": "Make sure you&#39;re not reinventing the wheel: <a href=\"https://github.com/VBA-tools/VBA-JSON\" rel=\"nofollow noreferrer\">github.com/VBA-tools/VBA-JSON</a>"}], "answers": [{"comments": [{"owner": {"reputation": 716, "user_id": 6819959, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/53e270754d794040cf238ecd9093c6eb?s=128&d=identicon&r=PG&f=1", "display_name": "S31", "link": "https://stackoverflow.com/users/6819959/s31"}, "edited": false, "score": 0, "creation_date": 1525883204, "post_id": 50257742, "comment_id": 87533923, "body": "Got it. Is there a way to pass it through as a whole named range? Or is it most efficient/realistic to use a loop?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 716, "user_id": 6819959, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/53e270754d794040cf238ecd9093c6eb?s=128&d=identicon&r=PG&f=1", "display_name": "S31", "link": "https://stackoverflow.com/users/6819959/s31"}, "edited": false, "score": 0, "creation_date": 1525883939, "post_id": 50257742, "comment_id": 87534327, "body": "The trick is that you need to join each cell together with a comma, which is why I went with the <code>Join()</code> function. That takes a single dimension array as an argument and Ranges are more like a two dimension array, so looping the range to put all the values into a single-dim array seemed the most efficient here. It should be a pretty quick loop."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 716, "user_id": 6819959, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/53e270754d794040cf238ecd9093c6eb?s=128&d=identicon&r=PG&f=1", "display_name": "S31", "link": "https://stackoverflow.com/users/6819959/s31"}, "edited": false, "score": 0, "creation_date": 1525884035, "post_id": 50257742, "comment_id": 87534379, "body": "And... also as Mathieu pointed out in the comments, there is a .bas module for dealing with json. It may be worth checking out. It is a very nice set of code for monkeying with json (writing and parsing) within VBA."}, {"owner": {"reputation": 716, "user_id": 6819959, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/53e270754d794040cf238ecd9093c6eb?s=128&d=identicon&r=PG&f=1", "display_name": "S31", "link": "https://stackoverflow.com/users/6819959/s31"}, "edited": false, "score": 0, "creation_date": 1525885613, "post_id": 50257742, "comment_id": 87535164, "body": "Great! Appreciate it"}, {"owner": {"reputation": 716, "user_id": 6819959, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/53e270754d794040cf238ecd9093c6eb?s=128&d=identicon&r=PG&f=1", "display_name": "S31", "link": "https://stackoverflow.com/users/6819959/s31"}, "edited": false, "score": 0, "creation_date": 1526840368, "post_id": 50257742, "comment_id": 87889933, "body": "had a little problem with the code but I adjusted it to - <code>Function convertRangetoList(myRange As Range, delimiter As String) As String Dim rngCell As Range Dim arrNames() As Variant Dim i As Long  &#39;redim the array ReDim (arrNames(myRange - 1))   &#39;Load the array i = 0 For Each rngCell In myRange     arrNames(i) = rngCell.Value     i = i + 1 Next          &#39; Join to comma seperate array     convertRangetoList = Join(arrNames, delimiter)  End Function</code> I just keep getting this new error that&#39;s giving me a type mismatch with the redim line that I can&#39;t seem to fix."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 716, "user_id": 6819959, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/53e270754d794040cf238ecd9093c6eb?s=128&d=identicon&r=PG&f=1", "display_name": "S31", "link": "https://stackoverflow.com/users/6819959/s31"}, "edited": false, "score": 0, "creation_date": 1526907630, "post_id": 50257742, "comment_id": 87912075, "body": "Oh... perhaps that should be <code>Redim arrNames(Range.cells.count - 1)</code> That would make more sense."}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": false, "score": 0, "last_activity_date": 1525882125, "creation_date": 1525882125, "answer_id": 50257742, "question_id": 50257547, "link": "https://stackoverflow.com/questions/50257547/embedding-excel-into-json-script/50257742#50257742", "title": "Embedding Excel into JSON script", "body": "<p>You could do something like:</p>\n\n<pre><code>Function convertRangeToList(myRange As Range, delimiter As String) As String\n    Dim rngCell As Range\n    Dim arrNames() As Variant\n\n    'redim the array\n    ReDim arrNames(myRange - 1)\n\n    'Load the array\n    i = 0\n    For Each rngCell In myRange\n        arrNames(i) = rngCell.Value\n        i = i + 1\n    Next\n\n    'Join to comma seperate the array\n    convertRangeToList Join(arrNames, delimiter)\n\nEnd Function\n</code></pre>\n\n<p>This will take your range and convert it into a list. You can use it like:</p>\n\n<pre><code>mylist = convertRangeToList(Range(\"names\"), \",\")\n</code></pre>\n"}], "owner": {"reputation": 716, "user_id": 6819959, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/53e270754d794040cf238ecd9093c6eb?s=128&d=identicon&r=PG&f=1", "display_name": "S31", "link": "https://stackoverflow.com/users/6819959/s31"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525882125, "creation_date": 1525881442, "question_id": 50257547, "link": "https://stackoverflow.com/questions/50257547/embedding-excel-into-json-script", "title": "Embedding Excel into JSON script", "body": "<p>Looking for some resources online, thought it wouldn't hurt to ask if someone else here might have further advice or helpful links. I'm trying to encode an Excel function / range into a JSON script that I'm POSTing to an API. </p>\n\n<p>The sample JSON needs to go through looking like:</p>\n\n<pre><code>{\nName: \"John Doe,Jane Doe\",\nDate: \"05/09/15 7:05:10\"\n}\n</code></pre>\n\n<p>The way I was going to put it through was:</p>\n\n<pre><code>sampleBody = \"{\n        Name: Sheet2.Range(\"Names\"),\n        Date: NOW()\n        }\"\n</code></pre>\n\n<p>Where Names is a named range from Excel that looks like:</p>\n\n<pre><code>John Doe\nJane Doe\nEmily Doe\n</code></pre>\n\n<p>I'm sure that'll give me a fair share of issues (I took out all the <code>\" &amp; Chr(34) &amp; \"</code> for ease of reading.</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "is_accepted": true, "score": 2, "last_activity_date": 1525880755, "creation_date": 1525880755, "answer_id": 50257340, "question_id": 50257261, "link": "https://stackoverflow.com/questions/50257261/sql-query-that-returns-parent-records-regardless-if-child-records-are-present/50257340#50257340", "title": "SQL Query that returns parent records regardless if child records are present", "body": "<p>Generally, when using <code>LEFT JOIN</code>, they need to be chained -- that is, all the joins should be outer joins.</p>\n\n<p>Try this:</p>\n\n<pre><code>SELECT mem.FirtName, mem.LastName, m.Notes, m.Location, ai.Details, \nai.CompleteByDate, c.Name\nFROM ((Meetings as m LEFT JOIN\n       ActionItems as ai \n       ON m.Id = ai.MeetingId Members\n      ) LEFT JOIN\n      Category as c\n      ON c.Id = ai.CategoryId\n     ) LEFT JOIN\n     Members mem\n     ON mem.Id = m.MemberId;\n</code></pre>\n\n<p>That said, if there are multiple action items for the meeting, then each member will be duplicated for each action item.</p>\n"}, {"tags": [], "owner": {"reputation": 493, "user_id": 5283663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AoeY4.jpg?s=128&g=1", "display_name": "A. Lion", "link": "https://stackoverflow.com/users/5283663/a-lion"}, "is_accepted": false, "score": 1, "last_activity_date": 1525883260, "last_edit_date": 1525883260, "creation_date": 1525880951, "answer_id": 50257403, "question_id": 50257261, "link": "https://stackoverflow.com/questions/50257261/sql-query-that-returns-parent-records-regardless-if-child-records-are-present/50257403#50257403", "title": "SQL Query that returns parent records regardless if child records are present", "body": "<p>All the join on the same \"branch\" must be left till the end of the chain. So in this case all what joined to ActionItems need to be left join. \nYour select should be working like this:</p>\n\n<pre><code>SELECT  Members.FirtName\n        , Members.LastName\n        , Meeting.Notes\n        , Meeting.Location\n        , ActionItems.Details\n        , ActionItems.CompleteByDate\n        , Category.Name\nFROM    Members INNER JOIN \n            (Meetings LEFT JOIN \n                (ActionItems LEFT JOIN Category.Id = ActionItems.CategoryId) \n             ON Meeting.Id = ActionItems.MeetingId) \n        ON Members.Id = Meeting.MemberId;\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 9726346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Kvo la", "link": "https://stackoverflow.com/users/9726346/kvo-la"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 50257340, "answer_count": 2, "score": 1, "last_activity_date": 1525883371, "creation_date": 1525880498, "last_edit_date": 1525883371, "question_id": 50257261, "link": "https://stackoverflow.com/questions/50257261/sql-query-that-returns-parent-records-regardless-if-child-records-are-present", "title": "SQL Query that returns parent records regardless if child records are present", "body": "<p>I need help constructing a query that returns parent records (from the Meeting table), regardless if the child records are present (from the ActionItems table). I was able to do this with a LEFT JOIN, but once I added other associated tables (Members and Category), the code wouldn't work. </p>\n\n<p>Here is the structure of my tables:</p>\n\n<p><a href=\"https://i.stack.imgur.com/2PmYg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2PmYg.png\" alt=\"enter image description here\"></a></p>\n\n<p>I need to display information from each Meeting</p>\n\n<ol>\n<li><p>The CategoryId field might be blank in the ActionItems Table, I need to show ActioItem even if CategoryId is blank</p></li>\n<li><p>Meeting might not have any Action Items associated with it, need to return Meeting records even if there are no ActionItems</p></li>\n</ol>\n\n<p>Here's my code that doesn't work (I may need to make multiple queries which is fine):</p>\n\n<pre><code>SELECT  Members.FirtName\n        , Members.LastName\n        , Meeting.Notes\n        , Meeting.Location\n        , ActionItems.Details\n        , ActionItems.CompleteByDate\n        , Category.Name\nFROM    Members INNER JOIN \n            (Meetings LEFT JOIN \n                (ActionItems INNER JOIN Category.Id = ActionItems.CategoryId) \n             ON Meeting.Id = ActionItems.MeetingId) \n        ON Members.Id = Meeting.MemberId;\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1525881796, "post_id": 50257105, "comment_id": 87533139, "body": "Will probably need more info, meanwhile I suggest to try shorten the target .xlsm file (abc.xlsm) and put it in the same directory as the source file.  If that works for you starts debugging from there."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1525881999, "post_id": 50257105, "comment_id": 87533246, "body": "Ensure that the location (if network based) is direct to the location (\\\\locale) rather than using your labels (C:), as well as ensure that the path or the file name don&#39;t include symbols that the system doesn&#39;t like (I know # is an issue for a lot of sites/networks)."}, {"owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 0, "creation_date": 1525882087, "post_id": 50257105, "comment_id": 87533306, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/30368582/cant-find-link-in-excel-workbook\">Can&#39;t find link in Excel Workbook</a>"}], "owner": {"reputation": 45, "user_id": 9765819, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211835480229822/picture?type=large", "display_name": "Farid Farmani", "link": "https://stackoverflow.com/users/9765819/farid-farmani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1525880007, "creation_date": 1525880007, "last_edit_date": 1531164843, "question_id": 50257105, "link": "https://stackoverflow.com/questions/50257105/error-on-excel-external-links", "title": "Error on excel external links", "body": "<p>I am getting this error of \"We can`t connect to \".... .xlsm\" file. I checked the external links and tried to break the link but I was not able to break it. I also tried the following codes in workbook.open but I am still getting errors when opening the file:</p>\n\n<p>ActiveWorkbook.UpdateLinks = xlUpdateLinksNever\nApplication.AskToUpdateLinks = False</p>\n\n<p>I also tried data validation/circle invalid data to find the external links in my excel file, but I was not able to see them.</p>\n\n<p>Any suggestions?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba", "xmlhttprequest"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1525878806, "post_id": 50256479, "comment_id": 87531236, "body": "Which line is causing the error? And what&#39;s the text of the error message, please? Note that you can use the <a href=\"https://stackoverflow.com/posts/50256479/edit\">edit</a> link to add this directly to your question."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1525878892, "post_id": 50256479, "comment_id": 87531313, "body": "@CindyMeister error 91 would be the classic &quot;Object variable or With block variable not set&quot; ;-)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1525879097, "post_id": 50256479, "comment_id": 87531436, "body": "The error means you&#39;re making a member call against an object that doesn&#39;t exist, i.e. its reference is <code>Nothing</code>, a <i>null pointer</i>. You have a lot of chained member calls, which makes this particular problem much harder to debug than it needs to be. Take the result of <code>address_array(what_to_check)</code> into its own local variable, then take <code>.querySelector(thatVariable)</code> into its own local variable, then make the cell value <code>= thatOtherVariable.innerText</code> - <i>then</i> you&#39;ll know exactly which object reference is <code>Nothing</code>, and you can act accordingly."}, {"owner": {"reputation": 3, "user_id": 9765380, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155420923281787/picture?type=large", "display_name": "SirBacon", "link": "https://stackoverflow.com/users/9765380/sirbacon"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1525879198, "post_id": 50256479, "comment_id": 87531511, "body": "@MathieuGuindon many many thanks. I&#39;ll take a look into that."}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 2, "creation_date": 1525879932, "post_id": 50256479, "comment_id": 87532000, "body": "Arrays starts with 0 index and the last item would be ubound(array) -1."}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 9765380, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155420923281787/picture?type=large", "display_name": "SirBacon", "link": "https://stackoverflow.com/users/9765380/sirbacon"}, "is_accepted": false, "score": 0, "last_activity_date": 1526383435, "creation_date": 1526383435, "answer_id": 50348974, "question_id": 50256479, "link": "https://stackoverflow.com/questions/50256479/error-91-using-for-loop-with-xmlhttprequest-vba/50348974#50348974", "title": "Error 91 Using For Loop with XMLHttpRequest VBA", "body": "<p>Turns out I was being given an error I either didn't fully understand or wasn't very clear. The issue was that the response didn't have the tag inside it that I was looking for as it wasn't present on the site. By using:</p>\n\n<pre><code>With html\n         .body.innerHTML = http.responseText\n         If .body.contains(.querySelector(tag_array(tag_array_index_no))) \nThen\n        Sheets(1).Range(Cells(down_var, 2).Address).Value = \n tag_array(tag_array_index_no)\n        Sheets(1).Range(Cells(down_var, 3).Address).Value = \n.querySelector(tag_array(tag_array_index_no)).innerText\n        Else\n        Sheets(1).Range(Cells(down_var, 2).Address).Value = \ntag_array(tag_array_index_no)\n        Sheets(1).Range(Cells(down_var, 3).Address).Value = \ntag_array(tag_array_index_no) + \" not set.\"\n        End If\n        End With\n</code></pre>\n\n<p>I'm able to check if the tag exists in the response text.</p>\n"}], "owner": {"reputation": 3, "user_id": 9765380, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155420923281787/picture?type=large", "display_name": "SirBacon", "link": "https://stackoverflow.com/users/9765380/sirbacon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1526383435, "creation_date": 1525877994, "last_edit_date": 1525879244, "question_id": 50256479, "link": "https://stackoverflow.com/questions/50256479/error-91-using-for-loop-with-xmlhttprequest-vba", "title": "Error 91 Using For Loop with XMLHttpRequest VBA", "body": "<p>I am trying to scrape a site for the contents of various HTML tags. I am using an array of html tags against an array of URLs. </p>\n\n<pre><code>Sub pArse(UserForm4_HiddenList_Text)\n\nDim http As New XMLHTTP60\n'Dim html As New HTMLDocument\nDim hero_true_Val As Integer\nDim down_var As Integer\nDim bill_array_redim\nDim element_tag As String\nDim address_count As Integer\n\n\n        hero_true_Val = Application.WorksheetFunction.CountIf(Range(\"B:B\"), True)\n        down_var = 1\n        bill_array_redim = Split(UserForm4_HiddenList_Text, Chr(10))\n\nReDim address_array(hero_true_Val)\n\nFor Z = 2 To 6\n        If Sheets(\"resource\").Cells(Z, 2).Value &lt;&gt; \"False\" Then\n            address_count = address_count + 1\n            address_array(address_count) = Sheets(\"resource\").Cells(Z, 1).Value\n        End If\n\nNext Z\n\n\n\nSheets(\"Sheet1\").Select\n\nFor url_stack = 0 To UBound(bill_array_redim)\n    Sheets(\"sheet1\").Cells(down_var, 1) = bill_array_redim(url_stack)\n\n    For what_to_check = 1 To address_count\n\n\n        With http\n        .Open \"GET\", bill_array_redim(url_stack), False\n        .send\n        Do While http.readyState &lt;&gt; 4\n        DoEvents\n        Loop\n\n\n        End With\n\n                Dim html As New HTMLDocument\n                With html\n                .body.innerHTML = http.responseText\n                ' the next line is where the error occurs \n                Sheets(\"Sheet1\").Cells(down_var, 2).Value = .querySelector(address_array(what_to_check)).innerText\n                End With\n\n                down_var = down_var + 1\n\n    Next what_to_check\nNext url_stack\n\nUserForm4.Hide\nEnd Sub\n</code></pre>\n\n<p>A user clicks a command button which then feeds in an array of URLs (UserForm4_HiddenList_Text). The code then checks for the existence of the word \"true\" in the sheet named \"resource.\" This generates an array of terms to check for.</p>\n\n<p>the problem I'm having is that on the second iteration of the what_to_check loop, I'm getting </p>\n\n<blockquote>\n  <p>error 91 : Object or with block variable not set</p>\n</blockquote>\n\n<p>I'm unsure of what the issue is here and it only seems to occur if I pass in two html tags rather than one.</p>\n\n<p>edit: thanks for replying Cindy. The error location is bolded. The message is \"Object or with block variable not set.\"</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 91, "user_id": 8162409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/410cfa5a02bcde46c916341a4ede658f?s=128&d=identicon&r=PG&f=1", "display_name": "Eric D.", "link": "https://stackoverflow.com/users/8162409/eric-d"}, "is_accepted": true, "score": 1, "last_activity_date": 1525879047, "creation_date": 1525879047, "answer_id": 50256799, "question_id": 50256383, "link": "https://stackoverflow.com/questions/50256383/only-copy-cell-value-if-active-cell-is-in-table-column/50256799#50256799", "title": "Only copy cell value if active cell is in table column", "body": "<p>Figured it out. I just needed to add DataBodyRange to that line. Code is now:</p>\n\n<pre><code>If Intersect(ActiveCell, ActiveSheet.ListObjects(\"Table1\").ListColumns(2).DataBodyRange) Is Nothing Then\n        MsgBox \"You must select a cell in the appropriate column.\", vbOKOnly + vbInformation, \"Error\"\n    Else\n        ActiveCell.Copy\n        Sheets(\"Destination\").Range(\"G3\").PasteSpecial xlPasteValues\n    End If\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 8162409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/410cfa5a02bcde46c916341a4ede658f?s=128&d=identicon&r=PG&f=1", "display_name": "Eric D.", "link": "https://stackoverflow.com/users/8162409/eric-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 0, "accepted_answer_id": 50256799, "answer_count": 1, "score": 0, "last_activity_date": 1525879047, "creation_date": 1525877687, "last_edit_date": 1531161705, "question_id": 50256383, "link": "https://stackoverflow.com/questions/50256383/only-copy-cell-value-if-active-cell-is-in-table-column", "title": "Only copy cell value if active cell is in table column", "body": "<p>I'm trying to write a macro that checks whether or not the user has selected a cell within a certain column, then copies that cell's value to another sheet. I keep getting a type mismatch error in the very first line where I'm checking to see if the user has selected a cell in the second column. Here's my code:</p>\n\n<pre><code>    If Intersect(ActiveCell, ActiveSheet.ListObjects(\"Table1\").ListColumns(2)) Is Nothing Then\n    MsgBox \"You must select a cell in the appropriate column.\", vbOKOnly + vbInformation, \"Error\"\nElse\n    ActiveCell.Copy\n    Sheets(\"Destination\").Range(\"G3\").PasteSpecial xlPasteValues\nEnd If\n</code></pre>\n\n<p>I'm guessing it has to do with my use of ListColumns...?</p>\n\n<p>(I don't want the header row to count as a valid selection, so really only the body of column 2.)</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1525877003, "post_id": 50255851, "comment_id": 87530033, "body": "Where is the <code>End Sub</code> for <code>CombineDocs</code>?  You can move the <code>Dim fso</code> and <code>Set fso</code> into <code>pastedoc</code> and probably be OK."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1525878629, "post_id": 50255851, "comment_id": 87531104, "body": "I agree, it&#39;s because your code can&#39;t find <code>fso</code>. Either pass that as an argument, as well, or put the declaration and instantiation in <code>pastedoc</code>. Also, as commented, you&#39;re missing an <code>End Sub</code> I edited one in, just before the next <code>Sub</code> but you should double-check it."}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 1, "creation_date": 1525884784, "post_id": 50255851, "comment_id": 87534757, "body": "By the way, a belated welcome to the site!  Check out the <a href=\"https://stackoverflow.com/tour\">tour</a> and the <a href=\"https://stackoverflow.com/help/how-to-ask\">how-to-ask page</a> for more about asking questions that will attract quality answers.  As you may already know, you can <a href=\"https://stackoverflow.com/posts/50255851/edit\">edit your question</a> to include more information."}, {"owner": {"reputation": 51, "user_id": 9734563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/215aa58e203c97d348b03d57199d040a?s=128&d=identicon&r=PG&f=1", "display_name": "plaene", "link": "https://stackoverflow.com/users/9734563/plaene"}, "edited": false, "score": 0, "creation_date": 1526022309, "post_id": 50255851, "comment_id": 87589523, "body": "The end sub was in my code, before the getfolders dub, but I missed it when copying it here."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 9734563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/215aa58e203c97d348b03d57199d040a?s=128&d=identicon&r=PG&f=1", "display_name": "plaene", "link": "https://stackoverflow.com/users/9734563/plaene"}, "edited": false, "score": 0, "creation_date": 1526023718, "post_id": 50260821, "comment_id": 87590298, "body": "Got it! Indeed the getfolders sub was unnecessary."}], "tags": [], "owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "is_accepted": true, "score": 1, "last_activity_date": 1525894443, "creation_date": 1525894443, "answer_id": 50260821, "question_id": 50255851, "link": "https://stackoverflow.com/questions/50255851/get-doc-files-from-folder-and-subfolders-using-word-vba/50260821#50260821", "title": "Get doc files from folder and subfolders using Word VBA", "body": "<p>One option: assuming the <code>End Sub</code> for <code>CombineDocs</code> was after the <code>getfolders</code> call, you can:</p>\n\n<ol>\n<li><p>Remove <code>getfolders</code> entirely</p></li>\n<li><p>In <code>CombineDocs</code>, say <code>pastedoc foldername</code> instead of <code>getfolders foldername</code></p></li>\n<li><p>Change the beginning of <code>pastedoc</code> to:</p>\n\n<pre><code>Sub pastedoc(StartFolderPath as String)\n    Dim fso As Scripting.FileSystemObject       ' ** Added\n    Set fso = New Scripting.FileSystemObject    ' ** Added\n\n    Dim file As Scripting.file\n    Dim subfol As Scripting.folder\n    Dim mainfolder As Scripting.folder\n    Set mainfolder = fso.GetFolder(StartFolderPath )\n\n    ' ... (everything else the same)\n</code></pre></li>\n</ol>\n\n<p>In general, you need to <code>Dim</code> variables either in the <code>Sub</code> where they are used, or at the top of your module, outside any subs.  Please put the <code>Dim</code>s inside the <code>Sub</code>s whenever you can, since that makes your code much easier to change and maintain.</p>\n"}], "owner": {"reputation": 51, "user_id": 9734563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/215aa58e203c97d348b03d57199d040a?s=128&d=identicon&r=PG&f=1", "display_name": "plaene", "link": "https://stackoverflow.com/users/9734563/plaene"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 548, "favorite_count": 0, "accepted_answer_id": 50260821, "answer_count": 1, "score": 1, "last_activity_date": 1525894443, "creation_date": 1525876012, "last_edit_date": 1525878548, "question_id": 50255851, "link": "https://stackoverflow.com/questions/50255851/get-doc-files-from-folder-and-subfolders-using-word-vba", "title": "Get doc files from folder and subfolders using Word VBA", "body": "<p>I am inserting a bunch of Word documents into one file for post-processing. When all the files are in one folder, I got my script to work. However to make it robust for future work, I'd like to insert Word files from all folders and subfolders (and possible futher subs) from a certain starting point. I followed this Youtube tutorial: <a href=\"https://www.youtube.com/watch?v=zHJPliWS9FQ\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=zHJPliWS9FQ</a> to consider all folders and subfolders and of course amended it for my particular use. </p>\n\n<pre><code>  Sub CombineDocs()\n    On Error Resume Next\n    MsgBox \"Opening\"\n    On Error GoTo 0\n\n    Dim foldername As String 'parent folder\n    With Application.FileDialog(msoFileDialogFolderPicker)\n      .AllowMultiSelect = False\n      .Show\n      On Error Resume Next\n      foldername = .SelectedItems(1)\n      Err.Clear\n      On Error GoTo 0\n    End With\n\n    Documents.Add\n    Selection.Style = ActiveDocument.Styles(\"Heading 1\")\n    Selection.TypeText Text:=\"Opening text\"\n    Selection.TypeParagraph\n    Selection.InsertNewPage\n    Selection.InsertBreak Type:=wdSectionBreakNextPage\n    ActiveDocument.GoTo(What:=wdGoToPage, Count:=2).Select\n\n    Dim fso As Scripting.FileSystemObject\n    Dim file As Scripting.file\n    getfolders foldername\n  End sub\n\nSub getfolders(foldername)\n    Set fso = New Scripting.FileSystemObject\n    Call pastedoc(foldername)\n    Set fso = Nothing\nEnd Sub\n\nSub pastedoc(StartFolderPath as String)\n    Dim file As Scripting.file\n    Dim subfol As Scripting.folder\n    Dim mainfolder As Scripting.folder\n    Set mainfolder = fso.GetFolder(StartFolderPath )\n\n    For Each file In mainfolder.Files\n    If ((InStr(1, LCase(fso.GetExtensionName(file.Path)), \"doc\", vbTextCompare) &gt; 0) Or _\n         (InStr(1, LCase(fso.GetExtensionName(file.Path)), \"docx\", vbTextCompare) &gt; 0)) And _\n                (InStr(1, file.Name, \"~$\") = 0) Then\n        Selection.InsertFile FileName:= _\n        file.Path _\n        , Range:=\"\", ConfirmConversions:=False, Link:=False, Attachment:=False\n        Selection.InsertBreak Type:=wdSectionBreakNextPage\n        End If\n    Next file\n\n    For Each subfol In mainfolder.SubFolders\n        pastedoc subfol.Path\n    Next subfol\nEnd Sub\n</code></pre>\n\n<p>A difference between my code and the tutorial's is that I define the parent folder in the main code and the tutorial does it in the sub script. As a result I get an </p>\n\n<blockquote>\n  <p>'object required'</p>\n</blockquote>\n\n<p>error in the 'set mainfolder' line. I tried defining all objects and names between the main code and calling the subs but I still can't get it to work. Any guidance what could fix the code? </p>\n"}, {"tags": ["vba", "excel", "sharepoint"], "comments": [{"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1525874622, "post_id": 50255127, "comment_id": 87528273, "body": "Are you adding a new entry to the table? If so, can you use INSERT INTO [DB] ?"}, {"owner": {"reputation": 387, "user_id": 7889517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dbabbb45e58afd3a6c7d7ee679d8eaf?s=128&d=identicon&r=PG&f=1", "display_name": "tsdn", "link": "https://stackoverflow.com/users/7889517/tsdn"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1525880818, "post_id": 50255127, "comment_id": 87532556, "body": "@pnuts they are list of products with mostly text fields and a few &#39;yes/no&#39; choice fields. My test list is a replica of the original list, yet it behaves differently."}, {"owner": {"reputation": 387, "user_id": 7889517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dbabbb45e58afd3a6c7d7ee679d8eaf?s=128&d=identicon&r=PG&f=1", "display_name": "tsdn", "link": "https://stackoverflow.com/users/7889517/tsdn"}, "reply_to_user": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1525881380, "post_id": 50255127, "comment_id": 87532912, "body": "@RicardoA just tried your suggestion now, but I&#39;m getting some inconsistent behavior - for the original list, I&#39;m getting an error saying I didn&#39;t provide values for some required fields (not true cause I made sure I did). For my replica list (List2), it worked fine a couple of times, but then it started giving me the same error. None of the fields in List2 requires a value so not sure why this error pops up and why it didn&#39;t initially."}, {"owner": {"reputation": 387, "user_id": 7889517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dbabbb45e58afd3a6c7d7ee679d8eaf?s=128&d=identicon&r=PG&f=1", "display_name": "tsdn", "link": "https://stackoverflow.com/users/7889517/tsdn"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1525881982, "post_id": 50255127, "comment_id": 87533232, "body": "@pnuts apart from the fact that List2 doesn&#39;t require values be entered, they are identical. I had them side by side and made sure the settings, column order, field types, etc. match. My fields are single-line-of-text type. There are the default fields with dates, numbers, Created By, etc. that are added automatically to all lists, but their settings are locked so I&#39;d imagine they&#39;d be the same for both lists."}, {"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1525882103, "post_id": 50255127, "comment_id": 87533311, "body": "Are you providing the name for the Fields? Ej: INSERT into [DB] (Field0,Field1,Field4,Field7) VALUES (F0Value,F1Value,F4Value,F7Value)"}, {"owner": {"reputation": 387, "user_id": 7889517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dbabbb45e58afd3a6c7d7ee679d8eaf?s=128&d=identicon&r=PG&f=1", "display_name": "tsdn", "link": "https://stackoverflow.com/users/7889517/tsdn"}, "reply_to_user": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1525882347, "post_id": 50255127, "comment_id": 87533441, "body": "@RicardoA I am, and also using single quotes for filed name with spaces"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 3155012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a04d2c071cfebf6b70b4bcd178578c9?s=128&d=identicon&r=PG&f=1", "display_name": "user3155012", "link": "https://stackoverflow.com/users/3155012/user3155012"}, "is_accepted": false, "score": 0, "last_activity_date": 1587188557, "last_edit_date": 1587188557, "creation_date": 1587140083, "answer_id": 61276053, "question_id": 50255127, "link": "https://stackoverflow.com/questions/50255127/row-handle-is-invalid-error-excel-vba-sharepoint-list-automation/61276053#61276053", "title": "&quot;Row handle is invalid&quot; error, Excel, VBA, SharePoint list automation", "body": "<p>I've just came across your post while I was in search of a similar question.</p>\n\n<p>Did you check the SharePoint list mandatory fields? Few columns would automatically be marked as 'Required' (eg: Title column). Removing such criteria or including such columns in the code by passing a value would help. I hope this can fix your issue.  </p>\n"}], "owner": {"reputation": 387, "user_id": 7889517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dbabbb45e58afd3a6c7d7ee679d8eaf?s=128&d=identicon&r=PG&f=1", "display_name": "tsdn", "link": "https://stackoverflow.com/users/7889517/tsdn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 809, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1587188557, "creation_date": 1525873917, "last_edit_date": 1525882546, "question_id": 50255127, "link": "https://stackoverflow.com/questions/50255127/row-handle-is-invalid-error-excel-vba-sharepoint-list-automation", "title": "&quot;Row handle is invalid&quot; error, Excel, VBA, SharePoint list automation", "body": "<p>I am trying to automate population of a SharePoint list, but getting \"Row handle is invalid\" error.\nMy code:</p>\n\n<pre><code>Sub test() \nDim cnt As New ADODB.Connection \nDim rst As New ADODB.Recordset \nDim SQLstr As String\n\nSQLstr = \"SELECT * FROM [DB];\"\n\nWith cnt\n    .ConnectionString = _\n    \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n    \"WSS;\" &amp; _\n    \"IMEX=0;\" &amp; _\n    \"RetrieveIds=Yes;\" &amp; _\n    \"DATABASE=\" &amp; URL &amp; \";\" &amp; _\n    \"LIST=\" &amp; ListID &amp; \";\"\n    .Open \nEnd With\n\nrst.Open SQLstr, cnt, adOpenDynamic, adLockOptimistic\n\nWith rst\n    .AddNew\n    .Fields(1) = ws.Cells(1, 1).Value\n    .Fields(4) = ws.Cells(1, 2).Value\n    .Fields(7) = ws.Cells(1, 3).Value\n    .Update \nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>The error pops up on the <code>.Update</code> line.\nI created a brand new SP list and the code works fine. But for some reason it doesn't work with the list I need it to work with.\nAlso, on both lists, I am able to use <code>rst.Find</code> Method and successfully update existing records. \nWhy am I getting this error?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1525875190, "post_id": 50254884, "comment_id": 87528650, "body": "I&#39;m curious - What&#39;s the overall result of what you&#39;re doing? Do you need to paste it all in to excel? Can&#39;t you connect and parse the data using MSXML2 as a background task without using IE? If you&#39;re only extracting one or two things maybe even just use an <code>InStrRev()</code> function on the text which finds the last instance of a word."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1525874765, "creation_date": 1525874765, "answer_id": 50255451, "question_id": 50254884, "link": "https://stackoverflow.com/questions/50254884/how-to-get-the-row-number-of-the-second-or-the-last-occurence-of-a-word-in-exc/50255451#50255451", "title": "How to get the row number of the second (or the last) occurence of a word in Excel?", "body": "<p>Like this</p>\n\n<pre><code>Option Explicit\n\nPublic Sub test()\n    Dim found As Range\n    With Worksheets(\"temp\").Range(\"E2:E10000\")\n       Set found = .Find(what:=\"End Analysis\", searchorder:=xlByColumns, searchdirection:=xlPrevious)\n       If Not found Is Nothing Then Debug.Print found.Row\n    End With\nEnd Sub\n</code></pre>\n\n<p>Which looking like yours would be more:</p>\n\n<pre><code>Dim found As Range, row_no As Long\nIf Result &gt; 1 Then\n   Set found = Worksheets(\"temp\").Range(\"E2:E10000\").Find(what:=\"End Analysis\", searchorder:=xlByColumns, searchdirection:=xlPrevious)\n   If Not found Is Nothing Then \n       row_no = found.Row\n   Else\n      MsgBox \"Not Found\"\n   End If\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 9710880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2061b19d192bf7ab2f78d9073247a9fd?s=128&d=identicon&r=PG&f=1", "display_name": "user9710880", "link": "https://stackoverflow.com/users/9710880/user9710880"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525874765, "creation_date": 1525873304, "last_edit_date": 1531164843, "question_id": 50254884, "link": "https://stackoverflow.com/questions/50254884/how-to-get-the-row-number-of-the-second-or-the-last-occurence-of-a-word-in-exc", "title": "How to get the row number of the second (or the last) occurence of a word in Excel?", "body": "<p>I am copying some content from a webpage in an excel sheet, and searching for a particular word and then fetching the row number of the record. The copied content is from an HTML page and is pasted in a table format in excel. At times, the word is mentioned twice in the table and I want to get the row number of the record which is in the last. I have code for getting the row number at the first time, but I am not able to figure out the row number of the last record. When I am fetching the row number value, in the variable \"row_no\", then I need the row number of the record which is displayed in last. How can I get that? \nPlease find below the code which I have written:</p>\n\n<pre><code>Set ie = New InternetExplorerMedium\n            ie.Visible = True\n            ws.Activate\nstrHTML = URL\n            ie.navigate strHTML\nDo While ie.Busy Or ie.READYSTATE &lt;&gt; 4\n                DoEvents\n            Loop\n\n            Set oXMLHTTP = CreateObject(\"MSXML2.ServerXMLHTTP\")\n            Set objCollection = ie.document.getElementsByTagName(\"input\")\n\n            Set tables = ie.document.getElementsByTagName(\"Table\")\n\n            msg = ie.document.Body.innerHTML\n\n              If InStr(msg, \"Word1\") = 0 Then\n            Else\n               For x = 0 To tables.Length\n\n                        If tables(x).innerText Like \"*Word1*\" Then\n                         found = True\n\n                         If x &gt; 0 Then\n                         Set clipboard = New MSForms.DataObject\n                         clipboard.SetText tables(x).outerHTML\n                         clipboard.PutInClipboard\n                         ws.Activate\n                         ws.Range(\"A1\").PasteSpecial\n                         Result = Application.WorksheetFunction.CountIf(Range(\"E2:E10000\"), \"End Analysis\")\n                         MsgBox Result\n                         If Result&gt; 1 Then\n'get the row number                            \n                          row_no = Worksheets(\"temp\").Range(\"E2:E10000\").Find(\"End Analysis\", lookat:=xlWhole).Row\n                         End If\n                         End If\n                    Next x\n                 End If   \n</code></pre>\n"}, {"tags": ["excel", "error-handling", "vba"], "comments": [{"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1525873998, "post_id": 50254853, "comment_id": 87527797, "body": "pword = TextBox1     -&gt;       pword = TextBox1.Value"}], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 9659467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B35kJ.jpg?s=128&g=1", "display_name": "R.E.L.", "link": "https://stackoverflow.com/users/9659467/r-e-l"}, "edited": false, "score": 0, "creation_date": 1525876828, "post_id": 50255289, "comment_id": 87529890, "body": "(is your screen name Russian for Ren? Not that it matters :) ) Worked perfectly thank you! @RicardoA, this didn&#39;t work when I input &#39;NOI&#39; because Sheets(TextBox1.Value).Activate would be trying to activate Sheets(&quot;NOI&quot;).Activate, which does not exist. But thank you!!"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1525874333, "creation_date": 1525874333, "answer_id": 50255289, "question_id": 50254853, "link": "https://stackoverflow.com/questions/50254853/on-error-goto-displays-when-no-error-for-select-case/50255289#50255289", "title": "On Error GoTo Displays When No Error (for Select Case)", "body": "<ol>\n<li>You don't need a <code>Select</code> statement for this a simple <code>If \u2026 Else</code> would do it.</li>\n<li>Always deactivate your error handler after the line where you expect the error. Otherwise any error that occurs later will also trigger that error handler and you might get a misleading error message.</li>\n</ol>\n\n<p>So we come up with something like this.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim pword As String\n    pword = TextBox1.Value\n\n    If pword = \"NOI\" Then\n        UnHideAllSheets\n    Else\n        On Error GoTo endit\n        Sheets(TextBox1.Value).Visible = True\n        On Error GoTo 0 'always deactivate error handler after the expected error\n    End If\n\n    Sheets(\"ERROR\").Visible = False\n    Sheets(\"Stats\").Visible = True\n    Sheets(TextBox1.Value).Activate\n    Me.Hide\n\n    Exit Sub\nendit: \n    MsgBox \"Incorrect Input: check spelling and capitalization\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 157, "user_id": 9659467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B35kJ.jpg?s=128&g=1", "display_name": "R.E.L.", "link": "https://stackoverflow.com/users/9659467/r-e-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 50255289, "answer_count": 1, "score": 0, "last_activity_date": 1525874521, "creation_date": 1525873213, "last_edit_date": 1531161705, "question_id": 50254853, "link": "https://stackoverflow.com/questions/50254853/on-error-goto-displays-when-no-error-for-select-case", "title": "On Error GoTo Displays When No Error (for Select Case)", "body": "<p>I've created an excel with several macros and this particular section is really stumping me because it was working perfectly 24 hours ago and I've made no changes to it.</p>\n\n<p>I have a form (Access) that pops up every time someone opens the Excel, and they have to enter their last name, then the sheet that is their name and another sheet called 'Stats' will be visible to them. Everything else hidden. Now if someone puts in 'NOI' it's the 'master password' if you will and almost everything displays. </p>\n\n<p>If they don't capitalize their inputs correctly or misspell something it SHOULD kick out an error message. However, the form is kicking out the error message even when the inputs aren't errors. The correct sheets will display but the error message box comes up no matter what you input. I know there has to be a better way than 'Error GoTo' but I'm not as skilled at using 'Try...'</p>\n\n<p>Here's the code:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim pword As String\n    On Error GoTo endit\n          pword = TextBox1\n          Select Case pword\n          Case Is = \"NOI\": Call UnHideAllSheets\n          Case Is &lt;&gt; \"NOI\": Sheets(TextBox1.Value).Visible = True\n    End Select\n    Sheets(\"ERROR\").Visible = False\n    Sheets(\"Stats\").Visible = True\n    Sheets(TextBox1.Value).Activate\n    Me.Hide\n    Exit Sub\n    endit: MsgBox \"Incorrect Input: check spelling and capitalization\"\nEnd Sub\n</code></pre>\n\n<p>I did not set absolute passwords with individual 'Case Is =' because this is designed to work for people who have absolutely no idea how to make any updates or changes to VBA. All of the people who will be using and updating this don't know the developer tab in excel exists.</p>\n\n<p>Here is the code that the Case Is refers to when it says <code>Call UnHideAllSheets</code>:</p>\n\n<pre><code>Sub UnHideAllSheets()\n    Application.ScreenUpdating = False\n\n    Dim n As Single\n    For n = 1 To Sheets.Count\n        Sheets(n).Visible = True\n    Next n\n\n    Application.ScreenUpdating = True\n\n    Sheets(\"CleanData\").Visible = False\n    Sheets(\"Template\").Visible = True\n    Sheets(\"ERROR\").Visible = False\n    Sheets(\"2018\").Activate\nEnd Sub\n</code></pre>\n\n<p>All of this is code I've modified from other locations. Like I said, it was working perfectly 24 hours ago. Any help much appreciated!</p>\n"}, {"tags": ["vba", "excel", "autofill"], "comments": [{"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1525873344, "post_id": 50254488, "comment_id": 87527266, "body": "If you are always going to start from A8 and you want to fill the next X rows you can do a quick dirty +8 and it will do what you ask, if you put 20, it will do the next 20 rows, if you do 30, it will do the next 30 rows: Selection.AutoFill Destination:=Range(&quot;A8:A&quot; &amp; Range(&quot;J1&quot;).Value + 8), Type:=xlFillSeries"}, {"owner": {"reputation": 77, "user_id": 9283777, "user_type": "registered", "profile_image": "https://graph.facebook.com/1363078390413019/picture?type=large", "display_name": "RobertW081171", "link": "https://stackoverflow.com/users/9283777/robertw081171"}, "reply_to_user": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1525875819, "post_id": 50254488, "comment_id": 87529089, "body": "Ricardo - see below Olly gave me some code which fitted most easily with my existing code and it worked a treat - thanks for comments."}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 9283777, "user_type": "registered", "profile_image": "https://graph.facebook.com/1363078390413019/picture?type=large", "display_name": "RobertW081171", "link": "https://stackoverflow.com/users/9283777/robertw081171"}, "edited": false, "score": 0, "creation_date": 1525875776, "post_id": 50254866, "comment_id": 87529057, "body": "Olly - this was the simplest option for me to try with the other code I had - many thanks as this worked an absolute treat."}], "tags": [], "owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "is_accepted": true, "score": 0, "last_activity_date": 1525873252, "creation_date": 1525873252, "answer_id": 50254866, "question_id": 50254488, "link": "https://stackoverflow.com/questions/50254488/code-to-autofill-x-number-of-rows-based-on-a-value-from-another-cell/50254866#50254866", "title": "Code to autofill x number of rows based on a value from another cell", "body": "<p>Try:</p>\n\n<p><code>Range(\"A8\").AutoFill Destination:=Range(\"A8\").Resize(Range(\"J1\").Value,1), Type:=xlFillSeries</code></p>\n"}, {"comments": [{"owner": {"reputation": 77, "user_id": 9283777, "user_type": "registered", "profile_image": "https://graph.facebook.com/1363078390413019/picture?type=large", "display_name": "RobertW081171", "link": "https://stackoverflow.com/users/9283777/robertw081171"}, "edited": false, "score": 0, "creation_date": 1525875864, "post_id": 50254920, "comment_id": 87529116, "body": "QHarr - Olly below bave me some code which fitted more easily with the code I had in place, thankfully it worked a treat.  As such I didn&#39;t try out your code, but can keep for another day.  Thanks for the efforts."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 77, "user_id": 9283777, "user_type": "registered", "profile_image": "https://graph.facebook.com/1363078390413019/picture?type=large", "display_name": "RobertW081171", "link": "https://stackoverflow.com/users/9283777/robertw081171"}, "edited": false, "score": 0, "creation_date": 1525875956, "post_id": 50254920, "comment_id": 87529168, "body": "No worries. The advantage of the above, for later use, is that you can re-use the same sub (AutoFillRange) with different start cell and different cell to use for row count."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1525873387, "creation_date": 1525873387, "answer_id": 50254920, "question_id": 50254488, "link": "https://stackoverflow.com/questions/50254488/code-to-autofill-x-number-of-rows-based-on-a-value-from-another-cell/50254920#50254920", "title": "Code to autofill x number of rows based on a value from another cell", "body": "<p>Like this?</p>\n\n<pre><code>Option Explicit\n\nPublic Sub test()\n    With ActiveSheet\n       AutoFillRange .Range(\"A8\"), Range(\"J1\").Value\n    End With\nEnd Sub\n\nPublic Sub AutoFillRange(ByVal startCell As Range, ByVal numberOfRows As Long)\n    startCell.AutoFill Destination:=startCell.Parent.Range(startCell, startCell.Offset(numberOfRows - 1)), Type:=xlFillSeries\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 9283777, "user_type": "registered", "profile_image": "https://graph.facebook.com/1363078390413019/picture?type=large", "display_name": "RobertW081171", "link": "https://stackoverflow.com/users/9283777/robertw081171"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 831, "favorite_count": 0, "accepted_answer_id": 50254866, "answer_count": 2, "score": 0, "last_activity_date": 1525877960, "creation_date": 1525872090, "last_edit_date": 1531164843, "question_id": 50254488, "link": "https://stackoverflow.com/questions/50254488/code-to-autofill-x-number-of-rows-based-on-a-value-from-another-cell", "title": "Code to autofill x number of rows based on a value from another cell", "body": "<p>I have a macro which will autofill a sheet down a number of rows based on a value in another cell.</p>\n\n<p>My code is as below. At the moment it will only autofill the series down to the row number of the value in the reference cell. (basically if I have the number 40 on the referenced cell, the code autofills down to row 40 and not down 40 rows which is what I need).</p>\n\n<p>Wondering if someone could help me here.</p>\n\n<pre><code>    Range(\"A8\").Select\n    Application.CutCopyMode = False\n    Selection.AutoFill Destination:=Range(\"A8:A\" &amp; Range(\"J1\").Value), Type:=xlFillSeries\n    Range(\"A8:A104\").Select\n</code></pre>\n\n<p>This is part of the code, the code before copies some other info into the sheet.</p>\n"}, {"tags": ["vba", "excel", "properties", "runtime-error"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1525871685, "post_id": 50254169, "comment_id": 87526021, "body": "If your code is dealing with multiple workbooks, it&#39;s possible that the <code>ActiveWorkbook</code> might not be what you&#39;re expecting. Have you verified that? (One way to verify, add <code>MsgBox ActiveWorkbook.Name</code>, somewhere in that sub.) I would personally pass the workbook into the sub as a parameter. That way I could ensure that it&#39;s referencing the correct workbook (and makes the sub for flexible for reuse, if needed)"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9764803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f19d8dbfd78d9a59e9657f1050e39cd?s=128&d=identicon&r=PG&f=1", "display_name": "Brad Stout", "link": "https://stackoverflow.com/users/9764803/brad-stout"}, "edited": false, "score": 0, "creation_date": 1526504409, "post_id": 50254689, "comment_id": 87775834, "body": "Thank you! That was the answer to my issue!"}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 0, "last_activity_date": 1525872670, "creation_date": 1525872670, "answer_id": 50254689, "question_id": 50254169, "link": "https://stackoverflow.com/questions/50254169/invalid-procedure-error-adding-custom-document-properties-programmatically/50254689#50254689", "title": "Invalid Procedure error adding Custom Document Properties Programmatically", "body": "<p>You have the parameters incorrect.</p>\n\n<p>basically:</p>\n\n<ul>\n<li><p>if <code>LinkToContent</code> =<code>True</code>, then the <code>LinkSource</code> argument is required. </p></li>\n<li><p>if <code>LinkToContent</code> = <code>False</code>, then the <code>Value</code> argument is required. </p></li>\n</ul>\n\n<h2>Syntax:</h2>\n\n<pre><code>ActiveWorkbook.CustomDocumentProperties.Add (Name, LinkToContent, [Type], _\n    [Value], [LinkSource])\n</code></pre>\n\n<hr>\n\n<h2>Value</h2>\n\n<p>The data value of the <code>Value</code> property, if it's not linked to the contents of the container document. The value is converted to match the data type specified by the Type argument, and if it can't be converted, an error occurs.   </p>\n\n<p><strong>If <code>LinkToContent</code> is <code>True</code>, the argument is ignored</strong> and the new document property is assigned a default value until the linked property values are updated by the container application (usually when the document is saved).</p>\n\n<hr>\n\n<h2>LinkSource</h2>\n\n<p><strong>Ignored if <code>LinkToContent</code> is <code>False</code>.</strong> The source of the <code>LinkSource</code> property. The container application determines what types of source linking you can use.  </p>\n\n<p>For example, <strong>DDE</strong> links use the <code>Server|Document!Item</code> syntax.</p>\n\n<hr>\n\n<p>See the <a href=\"https://msdn.microsoft.com/en-us/vba/office-shared-vba/articles/documentproperties-add-method-office\" rel=\"nofollow noreferrer\">documentation</a> for more information.</p>\n"}], "owner": {"reputation": 1, "user_id": 9764803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f19d8dbfd78d9a59e9657f1050e39cd?s=128&d=identicon&r=PG&f=1", "display_name": "Brad Stout", "link": "https://stackoverflow.com/users/9764803/brad-stout"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 425, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525872670, "creation_date": 1525871180, "last_edit_date": 1525872056, "question_id": 50254169, "link": "https://stackoverflow.com/questions/50254169/invalid-procedure-error-adding-custom-document-properties-programmatically", "title": "Invalid Procedure error adding Custom Document Properties Programmatically", "body": "<p>I'm trying to use VBA to add Custom Document Properties to a new workbook that is being created by another sub. I'd like my code to add the property to the active workbook. The ultimate goal is that SharePoint reads these properties as the workbook is uploaded (working fine so far).</p>\n\n<p>I am trying the code below with no luck and keep getting the error \"Invalid Procedure Call or Argument\"</p>\n\n<pre><code>ActiveWorkbook.CustomDocumentProperties.Add \"Part Number\", True, _\n    msoPropertyTypeString, \"PartNumberMetadata.Value\"\n</code></pre>\n\n<blockquote>\n  <p><code>Name of Doc Property = \"Part Number\"</code><br>\n  <code>Linked to Content = True</code><br>\n  <code>Doc Property Type = msoPropertyTypeString</code><br>\n  <code>Value = \"PartNumberMetadata\" '(A named range in my workbook)</code>  </p>\n</blockquote>\n\n<p>Can someone explain what I'm doing wrong?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 9167485, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3e9b292e1271d971bc2542a5642984d?s=128&d=identicon&r=PG&f=1", "display_name": "alex2002", "link": "https://stackoverflow.com/users/9167485/alex2002"}, "edited": false, "score": 0, "creation_date": 1525874775, "post_id": 50254758, "comment_id": 87528379, "body": "but how should i set the part which is &quot;not found&quot;? Thanks"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "reply_to_user": {"reputation": 151, "user_id": 9167485, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3e9b292e1271d971bc2542a5642984d?s=128&d=identicon&r=PG&f=1", "display_name": "alex2002", "link": "https://stackoverflow.com/users/9167485/alex2002"}, "edited": false, "score": 0, "creation_date": 1525877470, "post_id": 50254758, "comment_id": 87530341, "body": "Put it in the iferror portion of your formula   =iferror(vlookup(a4, &quot; &amp; ws2.Range(&quot;a2:b&quot; &amp; lastRow2).Address(1, 1, external:=True) &amp; &quot;, 2, false),&quot; &amp; &quot;&quot;&quot; &amp; &quot;Not Found&quot; &amp; &quot;&quot;)&quot;"}, {"owner": {"reputation": 151, "user_id": 9167485, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3e9b292e1271d971bc2542a5642984d?s=128&d=identicon&r=PG&f=1", "display_name": "alex2002", "link": "https://stackoverflow.com/users/9167485/alex2002"}, "edited": false, "score": 0, "creation_date": 1525956556, "post_id": 50254758, "comment_id": 87563444, "body": "i couldn&#39;t succeed to do it. So what I have done was to replace the part of my code which starts from &quot; <code>For i =4</code>... until <code>Next i</code>&quot; with the code provided by you. Am I doing it wrong? Thanks"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 1, "last_activity_date": 1525872856, "creation_date": 1525872856, "answer_id": 50254758, "question_id": 50254127, "link": "https://stackoverflow.com/questions/50254127/if-vlookup-looking-in-different-worksheets/50254758#50254758", "title": "IF &amp; vlookup looking in different worksheets", "body": "<p>put the formula in g4 and copy it down</p>\n\n<pre><code>ws1.Range(\"g4\").formula = \"=iferror(vlookup(a4, \" &amp; ws2.Range(\"a2:b\" &amp; lastRow2).Address(1, 1, external:=True) &amp; \", 2, false), text(,))\"\nws1.Range(\"g4\").copy ws1.Range(\"g4:G\" &amp; lastrow1\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 9167485, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3e9b292e1271d971bc2542a5642984d?s=128&d=identicon&r=PG&f=1", "display_name": "alex2002", "link": "https://stackoverflow.com/users/9167485/alex2002"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525884162, "creation_date": 1525871040, "last_edit_date": 1531164843, "question_id": 50254127, "link": "https://stackoverflow.com/questions/50254127/if-vlookup-looking-in-different-worksheets", "title": "IF &amp; vlookup looking in different worksheets", "body": "<p>I have the code below which does the job I need too. It checks column D to see if the value is bigger than 200, and if it is, then it vlookups in sheet2 to take the corresponding value. However, my approach takes quite time to load because of the loop. Can anyone help me to make the code faster or to have a different approach on it? Thanks</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Dim vlookup As Variant\n    Dim lastRow1 As Long, lastRow2 As Long\n    Dim ws1 As Worksheet, ws2 As Worksheet\n    Dim i As Long\n\n\n\n    Set ws1 = Sheets(\"Sheet1\")\n    lastRow1 = ws1.Cells(ws1.Rows.Count, \"A\").End(xlUp).Row\n    Set ws2 = Sheets(\"Sheet2\")\n    lastRow2 = ws2.Cells(ws2.Rows.Count, \"A\").End(xlUp).Row\n\n    For i = 4 To lastRow1\n\n    If Cells(i, \"D\") &gt; 200 Then\n\n    With ws1.Range(\"g4:g\" &amp; lastRow1)\n        .Formula = \"=iferror(vlookup(a4, \" &amp; ws2.Range(\"a2:b\" &amp; lastRow2).Address(1, 1, external:=True) &amp; \", 2, false), text(,))\"\n        .value = .value\n    End With\n\n    Else\n\n    Cells(i, \"g\") = \"Not found\"\n\n    End If\n\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "events", "combobox", "activex"], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 7843463, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e77cb13f50ae9f33dfb3210fee4a4c3c?s=128&d=identicon&r=PG&f=1", "display_name": "christian890", "link": "https://stackoverflow.com/users/7843463/christian890"}, "edited": false, "score": 0, "creation_date": 1525873718, "post_id": 50254962, "comment_id": 87527566, "body": "thank you for your time and effort. Can you explain this? I dont fully understand how it should work. What is   &quot;Combobox1.value&quot; and  whatdoes the  WorksheetFunction.Match do? and how does it work? same for the last line?"}, {"owner": {"reputation": 254, "user_id": 9651005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156222119417368/picture?type=large", "display_name": "Lee Li Fong", "link": "https://stackoverflow.com/users/9651005/lee-li-fong"}, "reply_to_user": {"reputation": 147, "user_id": 7843463, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e77cb13f50ae9f33dfb3210fee4a4c3c?s=128&d=identicon&r=PG&f=1", "display_name": "christian890", "link": "https://stackoverflow.com/users/7843463/christian890"}, "edited": false, "score": 1, "creation_date": 1525874008, "post_id": 50254962, "comment_id": 87527804, "body": "Combobox1.value mean your selected &quot;Item B&quot;."}, {"owner": {"reputation": 254, "user_id": 9651005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156222119417368/picture?type=large", "display_name": "Lee Li Fong", "link": "https://stackoverflow.com/users/9651005/lee-li-fong"}, "reply_to_user": {"reputation": 147, "user_id": 7843463, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e77cb13f50ae9f33dfb3210fee4a4c3c?s=128&d=identicon&r=PG&f=1", "display_name": "christian890", "link": "https://stackoverflow.com/users/7843463/christian890"}, "edited": false, "score": 1, "creation_date": 1525874085, "post_id": 50254962, "comment_id": 87527883, "body": "Worksheetfunction.match same as match function use at Excel to check selected &quot;Item B&quot; row."}, {"owner": {"reputation": 147, "user_id": 7843463, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e77cb13f50ae9f33dfb3210fee4a4c3c?s=128&d=identicon&r=PG&f=1", "display_name": "christian890", "link": "https://stackoverflow.com/users/7843463/christian890"}, "edited": false, "score": 0, "creation_date": 1525878768, "post_id": 50254962, "comment_id": 87531204, "body": "Thanks! i understood. But one last question, how do i &quot;activate&quot; the Event for every Combobox? The Code in my Posts shows how i add currently the new comboboxen, how do i create an event / link them to &quot;ComboBox1_Change&quot; so it activates? Thank you, i really appreciate it"}, {"owner": {"reputation": 254, "user_id": 9651005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156222119417368/picture?type=large", "display_name": "Lee Li Fong", "link": "https://stackoverflow.com/users/9651005/lee-li-fong"}, "reply_to_user": {"reputation": 147, "user_id": 7843463, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e77cb13f50ae9f33dfb3210fee4a4c3c?s=128&d=identicon&r=PG&f=1", "display_name": "christian890", "link": "https://stackoverflow.com/users/7843463/christian890"}, "edited": false, "score": 0, "creation_date": 1525883460, "post_id": 50254962, "comment_id": 87534064, "body": "Right click the combobox and click view code, then you will go to the event of the combobox."}, {"owner": {"reputation": 147, "user_id": 7843463, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e77cb13f50ae9f33dfb3210fee4a4c3c?s=128&d=identicon&r=PG&f=1", "display_name": "christian890", "link": "https://stackoverflow.com/users/7843463/christian890"}, "edited": false, "score": 0, "creation_date": 1525897948, "post_id": 50254962, "comment_id": 87541226, "body": "Yeah but the problem is i am creating multiple comboboxes during runtime (dynamic) and every new combobox needs the event. So i cant do that i need to add the event programmatically somehow"}], "tags": [], "owner": {"reputation": 254, "user_id": 9651005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156222119417368/picture?type=large", "display_name": "Lee Li Fong", "link": "https://stackoverflow.com/users/9651005/lee-li-fong"}, "is_accepted": false, "score": 1, "last_activity_date": 1525876994, "last_edit_date": 1525876994, "creation_date": 1525873492, "answer_id": 50254962, "question_id": 50253747, "link": "https://stackoverflow.com/questions/50253747/dynamic-activex-combobox-change-event/50254962#50254962", "title": "Dynamic ActiveX.ComboBox Change Event", "body": "<pre><code>Private Sub ComboBox1_Change()\n\n    CB1=ComboBox1.Value\n    R=WorksheetFunction.Match(CB1, Columns(\"A:A\"),0)\n\n    Activesheet.OLEObjects(\"ComBox2\").ListFillRange =Cells(R,2).Address\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 7843463, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e77cb13f50ae9f33dfb3210fee4a4c3c?s=128&d=identicon&r=PG&f=1", "display_name": "christian890", "link": "https://stackoverflow.com/users/7843463/christian890"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 624, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525878504, "creation_date": 1525869829, "last_edit_date": 1525878504, "question_id": 50253747, "link": "https://stackoverflow.com/questions/50253747/dynamic-activex-combobox-change-event", "title": "Dynamic ActiveX.ComboBox Change Event", "body": "<p>i got a Problem while working on a little project. I hope someone can help me, thanks in advance!</p>\n\n<p><strong>What i am trying to accomplish?</strong></p>\n\n<p>I create dynamic new ActiveX.ComboBoxes with a given List in it. When the user selects the ComboBox and changes the selected Item in the List i need an event to trigger.\nFor every dynamic comboboxes the event should be the same.\nExample: Combobox in D10 changes from \"ItemA\" to \"ItemB\" then i need an Event that checks in a Table for \"ItemB\" (Column A) and then pick the Value of the same Row of Column B and put it in the Column E10 where the combobox is located.</p>\n\n<p>I have no clue how to add DynamicEvents and then let them act all the same. And even if i still need to delete events dynamic too since the user can delete Rows and Comboboxes again.</p>\n\n<p><strong>What i tried:</strong></p>\n\n<p>Linking the Combobox to its Cell below it and then i tried to get the \"worksheet Change\" Event working, but apparently it doesnt work with linkedcells....</p>\n\n<p><strong>Current Code:</strong></p>\n\n<pre><code> Sub NewComboBox(ByVal Row As Integer, Name As String, CellWidth As Integer,  CellHeight As Integer)\n\n    Set ourCombo = ActiveSheet.OLEObjects.Add(ClassType:=\"Forms.ComboBox.1\", _\n                Link:=True, DisplayAsIcon:=False, Left:=plan.Cells(Row, CellNumber_Product).Left, Top:=plan.Cells(Row, CellNumber_Product).Top, Width:=CellWidth, _\n                Height:=CellHeight)\n        With ourCombo\n            .LinkedCell = plan.Cells(Row, CellNumber_Product).Address          \n            .ListFillRange = \"DTB_1!A:A\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "function", "scope"], "comments": [{"owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 0, "creation_date": 1525869538, "post_id": 50253406, "comment_id": 87524426, "body": "You&#39;re calling the function, but not doing anything with the output?"}, {"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 0, "creation_date": 1525871043, "post_id": 50253406, "comment_id": 87525600, "body": "By default, parameters are passed by reference, meaning that strCont and Cont point to the same memory location.  So it is working as expected."}, {"owner": {"reputation": 117, "user_id": 8571376, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GwQwi2wKtJU/AAAAAAAAAAI/AAAAAAAAACk/FsQ6lfTmR18/photo.jpg?sz=128", "display_name": "bookman B.", "link": "https://stackoverflow.com/users/8571376/bookman-b"}, "reply_to_user": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 0, "creation_date": 1525873284, "post_id": 50253406, "comment_id": 87527223, "body": "@Olly I call the function so it fills a word doc, I don&#39;t need any variable as output from it."}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 8571376, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GwQwi2wKtJU/AAAAAAAAAAI/AAAAAAAAACk/FsQ6lfTmR18/photo.jpg?sz=128", "display_name": "bookman B.", "link": "https://stackoverflow.com/users/8571376/bookman-b"}, "edited": false, "score": 0, "creation_date": 1525873839, "post_id": 50254121, "comment_id": 87527661, "body": "Thank you, I didn&#39;t know pointers worked that way in VBAfunctions.   Maybe it&#39;s just because I&#39;m more used to C#, but VBA way of handling that is kinda weird right ?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 117, "user_id": 8571376, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GwQwi2wKtJU/AAAAAAAAAAI/AAAAAAAAACk/FsQ6lfTmR18/photo.jpg?sz=128", "display_name": "bookman B.", "link": "https://stackoverflow.com/users/8571376/bookman-b"}, "edited": false, "score": 0, "creation_date": 1525875304, "post_id": 50254121, "comment_id": 87528719, "body": "@bookmanB. VBA is pretty much like any VB langauge in this respect, including VB.NET. But, yes, as I recall C#&#39;s default is to pass arguments by value, so it will seem backwards to you :-) It&#39;s all in what you&#39;re used to... I added some links with more in-depth explanation. But whether C# or VB or any other language: strings are complex types and an address to the memory is stored in the variable (on the Stack, as I recall) as opposed to the value of a numerical type being stored in the variable, itself (on the Heap, if memory serves)."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 3, "last_activity_date": 1525875362, "last_edit_date": 1525875362, "creation_date": 1525871024, "answer_id": 50254121, "question_id": 50253406, "link": "https://stackoverflow.com/questions/50253406/local-variable-passed-in-parameters-changes-in-the-function-despite-not-being-a/50254121#50254121", "title": "Local variable passed in parameters changes in the function despite not being a return value", "body": "<p>While we think of strings as \"simple\", they actually aren't, \"under the covers\". In reality, they're \"reference types\" - you've set the two \"pointers\" for the strings to the same address in memory, making them completely equivalent. (This won't happen with numbers.) Strings are passed implicitly \"ByRef\", meaning they can be changed in the other procedure.</p>\n\n<p>Change the function to get the strings explicitly <code>ByVal</code>. This way, what's coming into the function will only be changed <em>in the function</em>.</p>\n\n<pre><code>Sub btnPrint_Click()\n    Dim strClient2 As String, strTag As String, strCont As String\n    '...\n    strCont = strClient2\n    strTag = \"client2\"\n    Call Filling(strCont, strTag)\n    If strCont = \"\" Then Call Filling(\"\", \"and2\")\n    '...\nEnd Sub\n\nFunction Filling(ByVal Cont As String, ByVal whatev As String)\n    'other ifs...\n    If Cont = \"\" Then Cont = \"_ _ _ _ _ _ _ _ _ _\"\n    'fills doc...\nEnd Function\n</code></pre>\n\n<p>Useful links:</p>\n\n<ul>\n<li><a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/programming-guide/language-features/procedures/passing-arguments-by-value-and-by-reference\" rel=\"nofollow noreferrer\">Passing Arguments by Value and by Reference (Visual Basic)</a></li>\n<li><a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/programming-guide/language-features/data-types/value-types-and-reference-types\" rel=\"nofollow noreferrer\">Value Types and Reference Types</a></li>\n<li><a href=\"http://excelmatters.com/2016/03/10/byval-or-byref-whats-the-difference/\" rel=\"nofollow noreferrer\">ByVal or ByRef \u2013 what\u2019s the difference?</a></li>\n</ul>\n"}], "owner": {"reputation": 117, "user_id": 8571376, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GwQwi2wKtJU/AAAAAAAAAAI/AAAAAAAAACk/FsQ6lfTmR18/photo.jpg?sz=128", "display_name": "bookman B.", "link": "https://stackoverflow.com/users/8571376/bookman-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 50254121, "answer_count": 1, "score": 1, "last_activity_date": 1525875362, "creation_date": 1525868732, "last_edit_date": 1525872803, "question_id": 50253406, "link": "https://stackoverflow.com/questions/50253406/local-variable-passed-in-parameters-changes-in-the-function-despite-not-being-a", "title": "Local variable passed in parameters changes in the function despite not being a return value", "body": "<p>The <code>strCont</code> variable is sent in my function to fill a doc, and I then test that variable instead of having the same content as before being sent (empty string in that case) it has now the value that the <code>Cont</code> variable took in the function (<code>\"_ _ _ _ _ _ _ _ _ _\"</code>).</p>\n\n<p><code>strCont</code> changes value at the exact instant <code>Cont</code> does, which means it's not about the Return, but that the two variables are somehow linked together.<br>\nWhy are those two variables linked  ? Everything I know about functions tells me it should exactly <em>not</em> work like that.  </p>\n\n<p>Thanks in advance  </p>\n\n<p>Here's the code :</p>\n\n<pre><code>Private Sub btnPrint_Click()\n    Dim strClient2 As String, strTag As String, strCont As String\n    '...\n    strCont = strClient2\n    strTag = \"client2\"\n    Call Filling(strCont, strTag)\n    If strCont = \"\" Then Call Filling(\"\", \"and2\")\n    '...\nEnd Sub\n</code></pre>\n\n<p>The function</p>\n\n<pre><code>Function Filling(Cont As String, whatev As String)\n    'other ifs...\n    If Cont = \"\" Then Cont = \"_ _ _ _ _ _ _ _ _ _\"\n    'fills doc...\nEnd Function\n</code></pre>\n\n<p>Of course, the problem can be (and is in my program) avoided by just passing a copy of the variable in parameters, but this happening is not how it's supposed to, and I just don't understand why.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 9390235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02cdde7232e1bd65c54d855a97b52329?s=128&d=identicon&r=PG&f=1", "display_name": "Kippa2005", "link": "https://stackoverflow.com/users/9390235/kippa2005"}, "reply_to_user": {"reputation": 35, "user_id": 5709334, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f36fc1d5c5c7daefd69ecaf28c8185a5?s=128&d=identicon&r=PG&f=1", "display_name": "bonziia", "link": "https://stackoverflow.com/users/5709334/bonziia"}, "edited": false, "score": 0, "creation_date": 1525870589, "post_id": 50253102, "comment_id": 87525243, "body": "If you put a msgbox in there, does the msgbox run?"}, {"owner": {"reputation": 35, "user_id": 5709334, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f36fc1d5c5c7daefd69ecaf28c8185a5?s=128&d=identicon&r=PG&f=1", "display_name": "bonziia", "link": "https://stackoverflow.com/users/5709334/bonziia"}, "edited": false, "score": 0, "creation_date": 1525870718, "post_id": 50253102, "comment_id": 87525330, "body": "Yes the message box runs. The issue is the code is trying to run before the data has finished loading. I&#39;ve also tried adding a DoEvents still no luck."}, {"owner": {"reputation": 41, "user_id": 9390235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02cdde7232e1bd65c54d855a97b52329?s=128&d=identicon&r=PG&f=1", "display_name": "Kippa2005", "link": "https://stackoverflow.com/users/9390235/kippa2005"}, "reply_to_user": {"reputation": 35, "user_id": 5709334, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f36fc1d5c5c7daefd69ecaf28c8185a5?s=128&d=identicon&r=PG&f=1", "display_name": "bonziia", "link": "https://stackoverflow.com/users/5709334/bonziia"}, "edited": false, "score": 0, "creation_date": 1525870857, "post_id": 50253102, "comment_id": 87525439, "body": "I see, sorry I misread the question and kind of omitted that line in my mind. Let me have a look and I&#39;ll update my answer"}], "tags": [], "owner": {"reputation": 41, "user_id": 9390235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02cdde7232e1bd65c54d855a97b52329?s=128&d=identicon&r=PG&f=1", "display_name": "Kippa2005", "link": "https://stackoverflow.com/users/9390235/kippa2005"}, "is_accepted": false, "score": 0, "last_activity_date": 1525871969, "last_edit_date": 1525871969, "creation_date": 1525867929, "answer_id": 50253102, "question_id": 50252936, "link": "https://stackoverflow.com/questions/50252936/issue-updating-sql-server-with-excel-2016-on-workbook-activate/50253102#50253102", "title": "Issue updating SQL Server with Excel 2016 on Workbook_Activate()", "body": "<p>I know that in the other answer you said that you had tried adding a couple of secounds, i wasn't completely sure what you meant by that, but I'm guessing you have already attempted something like this?</p>\n\n<p>Change the 20 seconds to what ever you feel like</p>\n\n<pre><code>Private Sub workbook_activate()\nDim time_delay As Date\ntime_delay = Now() + TimeValue(\"00:00:20\")\nApplication.OnTime time_delay, \"thisworkbook.updatetable\"\nEnd Sub\n\n\nPrivate Sub updatetable()\n\nDim cn As ADODB.Connection\nSet cn = New ADODB.Connection\nDim rs As ADODB.Recordset\nDim strSql As String\n\nDim conn As New ADODB.Connection\nDim strConn As String\nDim PN As String\nDim partid As Integer\n\nActiveWorkbook.RefreshAll\n\nstrConn = \"Driver={SQL Server};Server=servername; Database=CI; UID=userID; PWD=UserPassword\"\ncn.Open strConn\n\npartid = Worksheets(\"Sheet3\").Range(\"G2\").Value\n\nstrSql = \"UPDATE dbo.OHW_Schedule SET Grabbed = '1' WHERE ID = '\" &amp; partid &amp; \"' \"\n\ncn.Execute strSql\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 5709334, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f36fc1d5c5c7daefd69ecaf28c8185a5?s=128&d=identicon&r=PG&f=1", "display_name": "bonziia", "link": "https://stackoverflow.com/users/5709334/bonziia"}, "edited": false, "score": 0, "creation_date": 1525869145, "post_id": 50253130, "comment_id": 87524173, "body": "Excel is still trying to update before the data is loaded. I&#39;ve tried adding a couple of seconds nothing seems to be working."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 35, "user_id": 5709334, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f36fc1d5c5c7daefd69ecaf28c8185a5?s=128&d=identicon&r=PG&f=1", "display_name": "bonziia", "link": "https://stackoverflow.com/users/5709334/bonziia"}, "edited": false, "score": 0, "creation_date": 1525869199, "post_id": 50253130, "comment_id": 87524206, "body": "Does running <code>UpdateData</code> manually (by pressing [F5] or the green &quot;Run&quot; button) work correctly?"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 35, "user_id": 5709334, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f36fc1d5c5c7daefd69ecaf28c8185a5?s=128&d=identicon&r=PG&f=1", "display_name": "bonziia", "link": "https://stackoverflow.com/users/5709334/bonziia"}, "edited": false, "score": 0, "creation_date": 1525872665, "post_id": 50253130, "comment_id": 87526766, "body": "So is the problem that <code>ThisWorkbook.RefreshAll</code> is refreshing in the Background, and not waiting until complete before the macro triggers?  If so, try putting it <i>before</i> the <code>Application.OnTime</code> or put <code>DoEvents</code> <b>immediately</b> after the <code>RefreshAll</code> line"}, {"owner": {"reputation": 35, "user_id": 5709334, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f36fc1d5c5c7daefd69ecaf28c8185a5?s=128&d=identicon&r=PG&f=1", "display_name": "bonziia", "link": "https://stackoverflow.com/users/5709334/bonziia"}, "edited": false, "score": 0, "creation_date": 1525874702, "post_id": 50253130, "comment_id": 87528317, "body": "Tried that still no help. I found out the problem for some reason I enabled background refresh, so disabling that makes the code work perfectly."}], "tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": true, "score": 0, "last_activity_date": 1525867989, "creation_date": 1525867989, "answer_id": 50253130, "question_id": 50252936, "link": "https://stackoverflow.com/questions/50252936/issue-updating-sql-server-with-excel-2016-on-workbook-activate/50253130#50253130", "title": "Issue updating SQL Server with Excel 2016 on Workbook_Activate()", "body": "<p>I have often found that you need to trigger your ADODB connections in a seperate proceedure, called via <code>Application.OnTime Now(), \"ProceedureName\"</code> so that Excel finishes Opening &amp; allocating References first and the update happens immediately after.</p>\n\n<p>E.g.:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Workbook_Activate()\n    Application.OnTime Now(), \"ThisWorkbook.UpdateData\"\nEnd Sub\n\nPrivate Sub UpdateData()\n    Dim cn As ADODB.Connection, strSql As String\n    Set cn = New ADODB.Connection\n\n    Dim strConn As String, partid As Integer\n\n    ThisWorkbook.RefreshAll 'Try to avoid ActiveWorkbook wherever possible!\n\n    Application.StatusBar = \"Connecting to DB\"\n    strConn = \"Driver={SQL Server};Server=servername; Database=CI; UID=userID; PWD=UserPassword\"\n    cn.Open strConn\n\n    partid = ThisWorkbook.Worksheets(\"Sheet3\").Range(\"G2\").Value 'Fully Qualify your Worksheets\n\n    Application.StatusBar = \"Running Update\"\n    strSql = \"UPDATE dbo.OHW_Schedule SET Grabbed = '1' WHERE ID = '\" &amp; partid &amp; \"' \"\n\n    cn.Execute strSql\n\n    Application.StatusBar = \"Disconnecting from DB\"\n    cn.Close\n    Set cn = Nothing\n    Application.StatusBar = False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 5709334, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f36fc1d5c5c7daefd69ecaf28c8185a5?s=128&d=identicon&r=PG&f=1", "display_name": "bonziia", "link": "https://stackoverflow.com/users/5709334/bonziia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 50253130, "answer_count": 2, "score": 1, "last_activity_date": 1525871969, "creation_date": 1525867453, "last_edit_date": 1531164843, "question_id": 50252936, "link": "https://stackoverflow.com/questions/50252936/issue-updating-sql-server-with-excel-2016-on-workbook-activate", "title": "Issue updating SQL Server with Excel 2016 on Workbook_Activate()", "body": "<p>I'm trying to update SQL Server using Excel on Workbook_Activate() that grabs the data and sends a reply of <code>1</code> in the <code>Grabbed</code> field after the data has been loaded to the sheet. It seems like the code isn't executing.</p>\n\n<pre><code>Private Sub Workbook_Activate()\n\nDim cn As ADODB.Connection\nSet cn = New ADODB.Connection\nDim rs As ADODB.Recordset\nDim strSql As String\n\nDim conn As New ADODB.Connection\nDim strConn As String\nDim PN As String\nDim partid As Integer\n\nActiveWorkbook.RefreshAll\n\nstrConn = \"Driver={SQL Server};Server=servername; Database=CI; UID=userID; PWD=UserPassword\"\ncn.Open strConn\n\npartid = Worksheets(\"Sheet3\").Range(\"G2\").Value\n\nstrSql = \"UPDATE dbo.OHW_Schedule SET Grabbed = '1' WHERE ID = '\" &amp; partid &amp; \"' \"\n\ncn.Execute strSql\n\nEnd Sub\n</code></pre>\n\n<p>when I go through the code line by line everything works fine. I've tried adding a DoEvents after the refresh but still no luck. I've also tried using Workbook_Open()</p>\n"}, {"tags": ["excel", "vba", "key", "row"], "comments": [{"owner": {"reputation": 697, "user_id": 5449244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/131ad184c67440a0a499852f247b4ea6?s=128&d=identicon&r=PG&f=1", "display_name": "onlyf", "link": "https://stackoverflow.com/users/5449244/onlyf"}, "edited": false, "score": 0, "creation_date": 1525870417, "post_id": 50252521, "comment_id": 87525114, "body": "I dont understand the negative vote. I ve seen questions being answered here which did not even supply a logic, or were described properly - and they received no negative votes."}], "answers": [{"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 2, "last_activity_date": 1525881390, "creation_date": 1525881390, "answer_id": 50257527, "question_id": 50252521, "link": "https://stackoverflow.com/questions/50252521/single-excel-sheet-to-multiple-sheets-based-on-specific-column-value/50257527#50257527", "title": "Single Excel Sheet to Multiple Sheets, based on specific column value", "body": "<p>From your sample data (using <code>ActiveSheet</code>), this generates 3 files in current path</p>\n\n<pre><code>KeyA.xlsx\nKeyB.xlsx\nKeyC.xlsx\n</code></pre>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPublic Sub GenerateKeyFiles()\n    Const K_COL = \"C\"\n\n    Dim ws As Worksheet:    Set ws = ActiveSheet\n    Dim ur As Range:        Set ur = ws.UsedRange\n    Dim ck As Range:        Set ck = ur.Columns(K_COL)\n    Dim arr As Variant:     arr = ck.Offset(1)\n    Dim d As Object:        Set d = CreateObject(\"Scripting.Dictionary\")\n\n    Dim itm As Variant, i As Long, wbp As String\n    For Each itm In arr\n        If Len(itm) &gt; 0 Then d(itm) = 0\n    Next\n    Dim wbX As Workbook:    Set wbX = Workbooks.Add\n    Dim wsX As Worksheet:   Set wsX = wbX.Worksheets(1):    wbp = ThisWorkbook.Path &amp; \"\\\"\n\n    Application.ScreenUpdating = False: Application.DisplayAlerts = False\n    For i = 2 To wbX.Worksheets.Count\n        wbX.Worksheets(i).Delete\n    Next\n\n    If ws.AutoFilterMode Then ur.AutoFilter\n    For Each itm In d\n        ck.AutoFilter Field:=1, Criteria1:=itm\n        ur.Copy\n        wsX.Cells(1).PasteSpecial xlPasteColumnWidths\n        wsX.Cells(1).PasteSpecial xlPasteAll:   wsX.Cells(1).Select\n        wsX.SaveAs wbp &amp; itm, Excel.XlFileFormat.xlOpenXMLWorkbook\n        wsX.UsedRange.Clear\n    Next\n    wbX.Close SaveChanges:=False:       ur.AutoFilter\n    Application.DisplayAlerts = True:   Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong><code>Main.xlsm</code></strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/yXoaJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yXoaJ.png\" alt=\"Main\"></a></p>\n\n<p><strong><code>KeyA.xlsx</code></strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/zdaR4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zdaR4.png\" alt=\"KeyA\"></a></p>\n\n<p><strong><code>KeyB.xlsx</code></strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/WzZed.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WzZed.png\" alt=\"KeyB\"></a></p>\n\n<p><strong><code>KeyC.xlsx</code></strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/9XmwS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9XmwS.png\" alt=\"KeyC\"></a></p>\n"}], "owner": {"reputation": 697, "user_id": 5449244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/131ad184c67440a0a499852f247b4ea6?s=128&d=identicon&r=PG&f=1", "display_name": "onlyf", "link": "https://stackoverflow.com/users/5449244/onlyf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 50257527, "answer_count": 1, "score": -1, "last_activity_date": 1525881390, "creation_date": 1525866047, "question_id": 50252521, "link": "https://stackoverflow.com/questions/50252521/single-excel-sheet-to-multiple-sheets-based-on-specific-column-value", "title": "Single Excel Sheet to Multiple Sheets, based on specific column value", "body": "<p>i have the following problem :</p>\n\n<p>I have a spreadsheet of the type :</p>\n\n<pre><code>Field1    Field2     Field3    Field4\nNameA     AddressA   KeyA      ValueA\nNameB     AddressB   KeyA      ValueB\nNameD     AddressD   KeyA      ValueD\nNameE     AddressE   KeyB      ValueE\nNameC     AddressC   KeyB      ValueC\nNameF     AddressF   KeyC      ValueF\n.... (200k entries)\n</code></pre>\n\n<p>I would like to read the worksheet, and create a number of separate excel workbooks, with only one worksheet in them, each containing ie:</p>\n\n<pre><code>Workbook1/Sheet1: (Workbookname ie KeyA.xlsx)\nField1    Field2     Field3    Field4\nNameA     AddressA   KeyA      ValueA\nNameB     AddressB   KeyA      ValueB\nNameD     AddressD   KeyA      ValueD\n\nWorkbook2/Sheet1: (Workbookname ie KeyB.xlsx)\nField1    Field2     Field3    Field4\nNameC     AddressC   KeyB      ValueC\nNameE     AddressE   KeyB      ValueE\n\nWorkbook3/Sheet1: (Workbookname ie KeyC.xlsx)\nField1    Field2     Field3    Field4\nNameF     AddressF   KeyC      ValueF\n</code></pre>\n\n<p>The first row must exist in all produced workbooks. They Field3 values are sorted, this is the logic i had in c:</p>\n\n<pre><code>main(excel_file)\n{\n   open(excel_file, r)\n   header = read(excel_file)\n   first_line = true\n\n   while not eof(excel_file)\n  {\n  line_cur = read(excel_file)\n\n  if first_line\n  {\n     office = get_office(line_cur)\n     office_file = open(name=office, w)\n\n     write(office_file, header)\n     write(office_file, line_cur)\n\n     line_prv = line_cur\n     first_line = false\n     continue\n  }\n\n  office_cur = get_office(line_cur)\n  office_prv = get_office(line_prv)\n\n  // If same group.\n  if office_cur = office_prv\n  {\n     write(office_file, line_cur)\n\n     line_prv = line_cur\n     continue\n  }\n\n  // If different group.\n  if office_cur != office_prv\n  {\n     close(office_file)\n     office_file = open(name=office_cur, w)\n\n     write(office_file, header)\n     write(office_file, line_cur)\n\n     line_prv = line_cur\n     continue\n  }\n   }   // while end.\n\n   close(office_file)\n   close(excel_file)\n}\n</code></pre>\n\n<p>Could you guys help me figure out how to implement this logic in VBA? Zero experience in it. Thank you in advance. </p>\n"}, {"tags": ["vba", "excel", "powerpoint"], "comments": [{"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1525868676, "post_id": 50252442, "comment_id": 87523853, "body": "Has &quot;Sheet3&quot; been activated at all, to ensure that the range is loaded into the VRAM or graphics buffer?"}, {"owner": {"reputation": 13, "user_id": 8043622, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JB6Qj6dVrVo/AAAAAAAAAAI/AAAAAAAAB5g/T38VD1tstHQ/photo.jpg?sz=128", "display_name": "P. Swapna", "link": "https://stackoverflow.com/users/8043622/p-swapna"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1525942363, "post_id": 50252442, "comment_id": 87555596, "body": "Hi Chronocidal,.. Thanks for you response..Not activated..but wherever is required I&#39;m taking as worksheet(&quot;sheet3&quot;)"}], "owner": {"reputation": 13, "user_id": 8043622, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JB6Qj6dVrVo/AAAAAAAAAAI/AAAAAAAAB5g/T38VD1tstHQ/photo.jpg?sz=128", "display_name": "P. Swapna", "link": "https://stackoverflow.com/users/8043622/p-swapna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1525877052, "creation_date": 1525865802, "last_edit_date": 1525877052, "question_id": 50252442, "link": "https://stackoverflow.com/questions/50252442/pasting-blank-picturebitmap-only-for-1-slide-remaining-working-as-expected-whi", "title": "Pasting blank picture(Bitmap) only for 1 slide remaining working as expected while pasting data from Excel to power point using VBA", "body": "<p>I am trying to copy paste data from excel to powerpoint slide.</p>\n\n<p>Data is copied in bitmap format and pasted to slides. This is a repeated process and is put in a loop.</p>\n\n<p>When i debug and do everything works fine. But when I perform a complete run in any one of the slide blank image gets pasted.This slide varies in each run.</p>\n\n<p>During the run the image will have a red 'x' mark and a message saying 'This image cannot be displayed now'. But once the run is completed and if you open the ppt, that slide will have a blank picture.</p>\n\n<pre><code>'Copy-Paste the data to PPT Slide\n         Workbooks(\"Statistics\").Worksheets(\"Sheet3\").UsedRange.CopyPicture_Appearance:=xlScreen, Format:=xlBitmap                      \n\n                    Set PPSlide = PPFile.Slides(PPFile.Slides.Count)\n                    PPSlide.Select\n                    PPSlide.Shapes.Paste\n                    Set myshape = PPSlide.Shapes(PPSlide.Shapes.Count)\n\n\n                    Application.CutCopyMode = False\n\n                    'Set position\n                    myshape.Left = 40\n                    myshape.Top = 90\n                    myshape.Width = 700                      \n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1525864727, "post_id": 50251939, "comment_id": 87521273, "body": "Which line of code is throwing the error?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1525865578, "post_id": 50251939, "comment_id": 87521857, "body": "You are using regex the wrong way! Have a look here: <a href=\"https://stackoverflow.com/questions/25102372/how-to-use-enable-regexp-object-regular-expression-using-vba-macro-in-word\">How to Use/Enable (RegExp object) Regular Expression using VBA (MACRO) in word</a>. Also you don&#39;t need 2 loops for this. You can do everything in one backwards loop (the second one)."}], "answers": [{"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": true, "score": 0, "last_activity_date": 1525905256, "creation_date": 1525905256, "answer_id": 50262994, "question_id": 50251939, "link": "https://stackoverflow.com/questions/50251939/add-cross-reference-to-number-or-text-found-using-regex-with-numbered-item-macro/50262994#50262994", "title": "add cross reference to number or text found using regex with numbered item macro", "body": "<p>You don't need RegEx for this. Consider:</p>\n\n<pre><code>Sub Demo()\nApplication.ScreenUpdating = False\nDim Rng As Range\nWith ActiveDocument.Range\n  With .Find\n    .ClearFormatting\n    .Replacement.ClearFormatting\n    .Text = \"(^#)\"\n    .Forward = True\n    .Format = False\n    .Wrap = wdFindStop\n    .MatchWildcards = False\n    .Execute\n  End With\n  Do While .Find.Found\n    If .Paragraphs(1).Style &lt;&gt; wdStyleHeading1 Then\n      Set Rng = .Characters(2)\n      With Rng\n        .InsertCrossReference wdRefTypeNumberedItem, wdNumberFullContext, .Text, True\n      End With\n    End If\n    .Collapse wdCollapseEnd\n    .Find.Execute\n  Loop\nEnd With\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p><strong>Note:</strong> the above code assumes your cross-reference is to the heading with the found number.</p>\n\n<p>If the bracketed numbers you want to process might be more than one digit, you could use Word's <em>wildcard</em> Find:</p>\n\n<pre><code>Sub Demo()\nApplication.ScreenUpdating = False\nDim Rng As Range\nWith ActiveDocument.Range\n  With .Find\n    .ClearFormatting\n    .Replacement.ClearFormatting\n    .Text = \"\\([0-9]@\\)\"\n    .Forward = True\n    .Format = False\n    .Wrap = wdFindStop\n    .MatchWildcards = True\n    .Execute\n  End With\n  Do While .Find.Found\n    If .Paragraphs(1).Style &lt;&gt; wdStyleHeading1 Then\n      Set Rng = .Duplicate\n      With Rng\n        .Start = .Start + 1\n        .End = .End - 1\n        .InsertCrossReference wdRefTypeNumberedItem, wdNumberFullContext, .Text, True\n      End With\n    End If\n    .Collapse wdCollapseEnd\n    .Find.Execute\n  Loop\nEnd With\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 239, "user_id": 6104783, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3M6eNa023VE/AAAAAAAAAAI/AAAAAAAAAPo/chG-hJ3I4fI/photo.jpg?sz=128", "display_name": "vikash vishnu", "link": "https://stackoverflow.com/users/6104783/vikash-vishnu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 50262994, "answer_count": 1, "score": -1, "last_activity_date": 1525905256, "creation_date": 1525864182, "last_edit_date": 1525865691, "question_id": 50251939, "link": "https://stackoverflow.com/questions/50251939/add-cross-reference-to-number-or-text-found-using-regex-with-numbered-item-macro", "title": "add cross reference to number or text found using regex with numbered item macro", "body": "<p>I have to find the text in the format or regex from the document - <code>\"([\\(]){1}([0-9]){1, 2}([\\)]){1}\"</code></p>\n\n<p>I want to replace the number alone found in the regex with a cross reference to the corresponding numbered item found using word macro. The only condition is that it should not take the number item with a style - \"Heading1\" (which has a number item to it)</p>\n\n<p>For Ex: text found: \"(1)\" replace the text with cross reference at the number alone</p>\n\n<p>The code I used throw a run time error: \"Object Required\".</p>\n\n<pre><code>Dim WorkPara As String\nDim CheckP() As Boolean\nDim NumPara As Integer, J As Integer\nNumPara = ActiveDocument.Paragraphs.count\n\nReDim CheckP(NumPara)\nFor J = 1 To NumPara\n    CheckP(J) = False\n    WorkPara = ActiveDocument.Paragraphs(J).Range.Text\n    If InStr(WorkPara, regex.Pattern(\"([\\(]){1}([0-9]){1}([\\)]){1}\")) &gt; 0 Then\n        CheckP(J) = True\n    End If\nNext J\n\nFor J = NumPara To 1 Step -1\n    If CheckP(J) Then\n        Selection.Range.InsertCrossReference wdRefTypeNumberedItem, wdNumberFullContext, \"1\"\n    End If\nNext J\n</code></pre>\n\n<p>Could any one help me out with it</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1525864301, "post_id": 50251858, "comment_id": 87520948, "body": "Is the range on <code>Worksheets(&quot;Items&quot;)</code> a column?"}, {"owner": {"reputation": 11, "user_id": 9741802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580a4c14c721607089e00bef61d11388?s=128&d=identicon&r=PG", "display_name": "Tom Rundle", "link": "https://stackoverflow.com/users/9741802/tom-rundle"}, "reply_to_user": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1525864557, "post_id": 50251858, "comment_id": 87521135, "body": "It is right now, but that is not a requirement"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1525870103, "post_id": 50251858, "comment_id": 87524892, "body": "Just so I have it correct - Somewhere you have a range of cells containing values.  You want to work your way through these values and see if they also appear in column <code>H</code> of <code>Sheet1</code>.  If it does then copy the values from columns <code>A</code>, <code>B</code>, <code>C</code> and <code>F</code> on that row in <code>Sheet1</code> and paste into the next available row on <code>Sheet2</code>, or is it paste onto the next available row on a sheet with the same name as the value you just looked up?"}, {"owner": {"reputation": 11, "user_id": 9741802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580a4c14c721607089e00bef61d11388?s=128&d=identicon&r=PG", "display_name": "Tom Rundle", "link": "https://stackoverflow.com/users/9741802/tom-rundle"}, "edited": false, "score": 0, "creation_date": 1525871961, "post_id": 50251858, "comment_id": 87526218, "body": "Yes, paste it onto a brand new sheet with the sheet name the same as the value it is looking for from the range.  ie. So rage value #1 = 8754 copy to worksheet named 8754  (fyi, I have all of the worksheets created already)"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9741802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580a4c14c721607089e00bef61d11388?s=128&d=identicon&r=PG", "display_name": "Tom Rundle", "link": "https://stackoverflow.com/users/9741802/tom-rundle"}, "edited": false, "score": 0, "creation_date": 1525866371, "post_id": 50252447, "comment_id": 87522396, "body": "Thank you for the reply, one thing I need would be rather than specifying &quot;Sheet2&quot;, I would like to use the same variable from the &quot;Items&quot; list as the name of the worksheet to copy to. ie.  If the value in the range is 8475, then it should paste to worksheet 8475. If the value is 9999 then it should paste to worksheet 9999.  Sorry if I am not explaining this correctly."}, {"owner": {"reputation": 11, "user_id": 9741802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580a4c14c721607089e00bef61d11388?s=128&d=identicon&r=PG", "display_name": "Tom Rundle", "link": "https://stackoverflow.com/users/9741802/tom-rundle"}, "edited": false, "score": 0, "creation_date": 1525867386, "post_id": 50252447, "comment_id": 87522978, "body": "Yes, there are multiple repeating values on Sheet1. The previous code worked perfectly, but I wanted to replace the hard coded 1234 with the range variable."}, {"owner": {"reputation": 11, "user_id": 9741802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580a4c14c721607089e00bef61d11388?s=128&d=identicon&r=PG", "display_name": "Tom Rundle", "link": "https://stackoverflow.com/users/9741802/tom-rundle"}, "edited": false, "score": 0, "creation_date": 1525868632, "post_id": 50252447, "comment_id": 87523820, "body": "Unfortunately it is not working. BTW, the values I am searching for are embedded in a text string. so the 8475 would be in a cell where the cell value could be &quot;2018 - Cookbook - Item 8475&quot;"}, {"owner": {"reputation": 11, "user_id": 9741802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580a4c14c721607089e00bef61d11388?s=128&d=identicon&r=PG", "display_name": "Tom Rundle", "link": "https://stackoverflow.com/users/9741802/tom-rundle"}, "edited": false, "score": 0, "creation_date": 1525870673, "post_id": 50252447, "comment_id": 87525297, "body": "Thank you for the effort, but the code isn&#39;t doing anything. My original code was moving the selected search fields to the indicated sheets, but now nothing is being copied at all."}, {"owner": {"reputation": 11, "user_id": 9741802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580a4c14c721607089e00bef61d11388?s=128&d=identicon&r=PG", "display_name": "Tom Rundle", "link": "https://stackoverflow.com/users/9741802/tom-rundle"}, "edited": false, "score": 0, "creation_date": 1525873250, "post_id": 50252447, "comment_id": 87527194, "body": "Maybe I am missing something, but nothing is working for me. I have worksheets named: &quot;Data&quot;, &quot;Items&quot;,&quot;8596&quot; and the first value in the range in column A on the Items sheet is &quot;8596&quot;. There is a string of text in column Q on the &quot;Data&quot; sheet that contains the text &quot;8596&quot;. When I run the code, nothing gets copied to sheet &quot;8596&quot;"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 11, "user_id": 9741802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580a4c14c721607089e00bef61d11388?s=128&d=identicon&r=PG", "display_name": "Tom Rundle", "link": "https://stackoverflow.com/users/9741802/tom-rundle"}, "edited": false, "score": 0, "creation_date": 1525873519, "post_id": 50252447, "comment_id": 87527402, "body": "So <code>Sheet1</code> is called <code>Data</code>?"}, {"owner": {"reputation": 11, "user_id": 9741802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580a4c14c721607089e00bef61d11388?s=128&d=identicon&r=PG", "display_name": "Tom Rundle", "link": "https://stackoverflow.com/users/9741802/tom-rundle"}, "edited": false, "score": 0, "creation_date": 1525874103, "post_id": 50252447, "comment_id": 87527892, "body": "yes, that is the sheet containing the values to be searched"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 11, "user_id": 9741802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580a4c14c721607089e00bef61d11388?s=128&d=identicon&r=PG", "display_name": "Tom Rundle", "link": "https://stackoverflow.com/users/9741802/tom-rundle"}, "edited": false, "score": 0, "creation_date": 1525874196, "post_id": 50252447, "comment_id": 87527964, "body": "I updated the code (changed sheet name from <code>Sheet1</code> to <code>Data</code>)"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 1, "last_activity_date": 1525874162, "last_edit_date": 1525874162, "creation_date": 1525865811, "answer_id": 50252447, "question_id": 50251858, "link": "https://stackoverflow.com/questions/50251858/using-values-in-a-range-as-a-variable/50252447#50252447", "title": "Using values in a range as a variable", "body": "<hr>\n\n<pre><code>Option Explicit\n\nPublic Sub Test()\n    Dim ws1 As Worksheet, ws2 As Worksheet, ws3 As Worksheet, lr1 As Long, lr2 As Long\n    Dim luArr As Variant, luVal As Variant, r As String, itm As Variant, itmRow As Long\n\n    Set ws1 = ThisWorkbook.Worksheets(\"Data\")       'Sheet with data to check for value\n    Set ws3 = ThisWorkbook.Worksheets(\"Items\")      'LookUp values\n    luArr = ws3.UsedRange.Columns(\"A\")              'LookUp column\n    lr1 = ws1.Cells(ws1.Rows.Count, \"H\").End(xlUp).Row\n\n    Dim findRng As Range, copyRng As Range, toRng As Range, fr As Long\n    Set findRng = ws1.Range(\"H1:H\" &amp; lr1)\n\n    On Error Resume Next    'Expected error: sheet not found\n    Application.ScreenUpdating = False\n    For Each luVal In luArr\n        Set ws2 = Nothing\n        Set ws2 = ThisWorkbook.Worksheets(luVal)    'Copy to\n        If ws2 Is Nothing Then\n            Err.Clear\n        Else\n            itm = Application.Match(luVal, findRng, 0)\n            If Not IsError(itm) Then\n                findRng.AutoFilter Field:=1, Criteria1:=\"*\" &amp; luVal &amp; \"*\"\n                fr = IIf(findRng.SpecialCells(xlCellTypeVisible).Cells.Count = 1, 1, 2)\n                With ws1.UsedRange\n                    Set copyRng = .Range(\"A\" &amp; fr &amp; \":C\" &amp; lr1)\n                    Set copyRng = Union(copyRng, .Range(\"F\" &amp; fr &amp; \":F\" &amp; lr1))\n                    Set copyRng = Union(copyRng, .Range(\"H\" &amp; fr &amp; \":H\" &amp; lr1))\n                End With\n                lr2 = ws2.Cells(ws2.Rows.Count, \"A\").End(xlUp).Row + 1\n                copyRng.Copy\n                ws2.Cells(lr2, 1).PasteSpecial\n                findRng.AutoFilter\n            End If\n        End If\n    Next\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Sheet1</p>\n\n<p><a href=\"https://i.stack.imgur.com/sOYm4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sOYm4.png\" alt=\"Sheet1\"></a></p>\n\n<p>Items</p>\n\n<p><a href=\"https://i.stack.imgur.com/cN2oS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cN2oS.png\" alt=\"Items\"></a></p>\n\n<p>Before (Sheet A1, A2, and A3)</p>\n\n<p><a href=\"https://i.stack.imgur.com/TiTd7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TiTd7.png\" alt=\"A1\"></a>\n<a href=\"https://i.stack.imgur.com/D5Zix.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/D5Zix.png\" alt=\"A2\"></a>\n<a href=\"https://i.stack.imgur.com/XyhQE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XyhQE.png\" alt=\"A3\"></a></p>\n\n<p>After</p>\n\n<p><a href=\"https://i.stack.imgur.com/tiXsd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tiXsd.png\" alt=\"A1\"></a>\n<a href=\"https://i.stack.imgur.com/TTepY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TTepY.png\" alt=\"A2\"></a>\n<a href=\"https://i.stack.imgur.com/Eso9M.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Eso9M.png\" alt=\"A3\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 9741802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580a4c14c721607089e00bef61d11388?s=128&d=identicon&r=PG", "display_name": "Tom Rundle", "link": "https://stackoverflow.com/users/9741802/tom-rundle"}, "edited": false, "score": 0, "creation_date": 1525874285, "post_id": 50254767, "comment_id": 87528027, "body": "This worked great, thank you! Is there a way to also copy the cell that contained the data that was searched for? So I actually need the cells from columns A:L from the Data worksheet and the cell containing the text string from the range being searched:Q1:Z100. So rather than just looking at one column(H), search the range Q1:Z100 then copy those found cells to the worksheet.  Thank you again for this!"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 11, "user_id": 9741802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580a4c14c721607089e00bef61d11388?s=128&d=identicon&r=PG", "display_name": "Tom Rundle", "link": "https://stackoverflow.com/users/9741802/tom-rundle"}, "edited": false, "score": 0, "creation_date": 1525874878, "post_id": 50254767, "comment_id": 87528450, "body": "I&#39;m not exactly sure what you mean.  It&#39;s easy enough to copy extra data  from the search range (<code>ValueToFind</code> in my code).  A reference to that cell is passed around, not just the value so to copy extra data you&#39;d just need to add <code>ValueToFind.Resize(, 12).Copy Destination:=rLastUsedCell.Offset(, 4)</code> after the line that does the first copy/paste.  You mention a <code>Data</code> worksheet in your comment - you haven&#39;t mentioned that in your post, but you have mentioned a sheet called <code>Items</code> - apologies, that is the equivalent of <code>Sheet3</code> in the code.  Where does <code>Q1:Z100</code> come into it?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 11, "user_id": 9741802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580a4c14c721607089e00bef61d11388?s=128&d=identicon&r=PG", "display_name": "Tom Rundle", "link": "https://stackoverflow.com/users/9741802/tom-rundle"}, "edited": false, "score": 0, "creation_date": 1525875259, "post_id": 50254767, "comment_id": 87528695, "body": "lol, no problem.  Just looked at your profile - you&#39;ve got a title of <i>Director</i> so wouldn&#39;t expect all the required information first time round :D"}, {"owner": {"reputation": 11, "user_id": 9741802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580a4c14c721607089e00bef61d11388?s=128&d=identicon&r=PG", "display_name": "Tom Rundle", "link": "https://stackoverflow.com/users/9741802/tom-rundle"}, "edited": false, "score": 0, "creation_date": 1525875456, "post_id": 50254767, "comment_id": 87528831, "body": "Worksheets: &quot;Data&quot; this is where the values to be searched live. I need to search range Q1:Z100 on this sheet.  Sheet &quot;Items&quot; contains the search criteria in column A, and the other sheets are named after each cell in the search criteria range. Other sheet names are &quot;8475&quot;, &quot;9999&quot; etc. I need the search to look at Column A on the Items sheet, search for the value in cell A1, say &quot;9999&quot;. Search the range Q1:Z100 on the Data sheet then if it finds the value in row 1 on the Data sheet, copy cells A1:L1 and the cell in range Q1:Z100 that contained the search data to the worksheet named &quot;9999&quot;"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 11, "user_id": 9741802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580a4c14c721607089e00bef61d11388?s=128&d=identicon&r=PG", "display_name": "Tom Rundle", "link": "https://stackoverflow.com/users/9741802/tom-rundle"}, "edited": false, "score": 0, "creation_date": 1525876358, "post_id": 50254767, "comment_id": 87529498, "body": "So &quot;8475&quot; could appear anywhere in the range Q1:Z100.  Is it possible that two values from the <code>Item</code> sheet may appear on the same row in the <code>Data</code> sheet?  e.g. &quot;8475&quot; is in <code>Q20</code> and &quot;9999&quot; is in <code>V20</code>?  I don&#39;t think this will stop the code - it will just copy the values to both sheets."}, {"owner": {"reputation": 11, "user_id": 9741802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580a4c14c721607089e00bef61d11388?s=128&d=identicon&r=PG", "display_name": "Tom Rundle", "link": "https://stackoverflow.com/users/9741802/tom-rundle"}, "edited": false, "score": 0, "creation_date": 1525876608, "post_id": 50254767, "comment_id": 87529704, "body": "Yes, the values can appear anywhere in the range Q1:Z100. Yes, two values from the Items range could appear in two different cells in that range as you have stated."}, {"owner": {"reputation": 11, "user_id": 9741802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580a4c14c721607089e00bef61d11388?s=128&d=identicon&r=PG", "display_name": "Tom Rundle", "link": "https://stackoverflow.com/users/9741802/tom-rundle"}, "edited": false, "score": 0, "creation_date": 1525878347, "post_id": 50254767, "comment_id": 87530927, "body": "I tried the new code, but now nothing is being copied at all."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 11, "user_id": 9741802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580a4c14c721607089e00bef61d11388?s=128&d=identicon&r=PG", "display_name": "Tom Rundle", "link": "https://stackoverflow.com/users/9741802/tom-rundle"}, "edited": false, "score": 0, "creation_date": 1525879033, "post_id": 50254767, "comment_id": 87531393, "body": "My set up of the workbook was:  In the <code>Items</code> sheet I have the values <b>4175</b> and <b>412</b> in cells <code>A1:A2</code>.  In the <code>Data</code> sheet I have values in cells <code>A1:L100</code> and <code>Q1:Z100</code> - in this last range I have randomly placed the values <b>4175</b> and <b>412</b> in various cells.  I have two blank sheets called <code>4175</code> and <code>412</code>  When I run the code the data from columns A:L are copied across as well as the value in the found cell.  Is this similar to your setup?"}, {"owner": {"reputation": 11, "user_id": 9741802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580a4c14c721607089e00bef61d11388?s=128&d=identicon&r=PG", "display_name": "Tom Rundle", "link": "https://stackoverflow.com/users/9741802/tom-rundle"}, "edited": false, "score": 0, "creation_date": 1525879206, "post_id": 50254767, "comment_id": 87531516, "body": "Similar, but the values being searched are buried in text strings, not just numeric values in the cell. The value of cell Q40 can be something like:  &quot;2018 - Cookbook - Item - 4175&quot;"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 11, "user_id": 9741802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580a4c14c721607089e00bef61d11388?s=128&d=identicon&r=PG", "display_name": "Tom Rundle", "link": "https://stackoverflow.com/users/9741802/tom-rundle"}, "edited": false, "score": 0, "creation_date": 1525879493, "post_id": 50254767, "comment_id": 87531719, "body": "That&#39;s odd - it found &quot;2018 - Cookbook - Item - 4175&quot; fine when I told it to search for &quot;4175&quot;.  The <code>LookAt:=xlPart</code> in the <code>Find</code> code does that - you sure yours doesn&#39;t say <code>LookAt:=xlWhole</code>?"}, {"owner": {"reputation": 11, "user_id": 9741802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580a4c14c721607089e00bef61d11388?s=128&d=identicon&r=PG", "display_name": "Tom Rundle", "link": "https://stackoverflow.com/users/9741802/tom-rundle"}, "edited": false, "score": 0, "creation_date": 1525880450, "post_id": 50254767, "comment_id": 87532317, "body": "I&#39;m sorry, but mine is not working. I copied all of your code from the Edit 2 box, pasted it into the code on my Data sheet and tried to run it, and nothing happens. (Your first code did paste some data for me) I apologize for not being able to offer more help."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 11, "user_id": 9741802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580a4c14c721607089e00bef61d11388?s=128&d=identicon&r=PG", "display_name": "Tom Rundle", "link": "https://stackoverflow.com/users/9741802/tom-rundle"}, "edited": false, "score": 0, "creation_date": 1525880857, "post_id": 50254767, "comment_id": 87532576, "body": "Try pasting it into a new module rather than the code sheet attached to the <code>Data</code> sheet.  If that doesn&#39;t work try adding some watches and watching them as you step through the code using F8 - to do this choose <i>Watch Window</i> from the <i>View</i> menu, right click and select <code>Add Watch</code>.  Add things like <code>RangeToSearch.Address</code> and change the <code>Procedure</code> drop-down to <code>FindValues</code>, click in the <code>Main</code> procedure and start tapping F8 to step through the code.  Make sure all variables are returning expected values."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 11, "user_id": 9741802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580a4c14c721607089e00bef61d11388?s=128&d=identicon&r=PG", "display_name": "Tom Rundle", "link": "https://stackoverflow.com/users/9741802/tom-rundle"}, "edited": false, "score": 0, "creation_date": 1525881643, "post_id": 50254767, "comment_id": 87533049, "body": "That&#39;ll be it then - it should be <code>$Q$1:$Z$100</code>.  In the <code>Main</code> procedure is this line:  <code>Set rSearchRange = .Range(&quot;Q1&quot;, .Cells(.Rows.Count, 26).End(xlUp))</code>  It uses column Z (26) to find the last row.  Change it to <code>Set rSearchRange = .Range(&quot;Q1&quot;, .Cells(.Cells(.Rows.Count, 19).End(xlUp).Row, 26))</code> - this uses column S (19) to find the last row.  Change the <code>19</code> to a column that contains values in each row... or hardcode <code>Set rSearchRange = .Range(&quot;Q1:Z100&quot;)</code>."}, {"owner": {"reputation": 11, "user_id": 9741802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580a4c14c721607089e00bef61d11388?s=128&d=identicon&r=PG", "display_name": "Tom Rundle", "link": "https://stackoverflow.com/users/9741802/tom-rundle"}, "edited": false, "score": 1, "creation_date": 1525883649, "post_id": 50254767, "comment_id": 87534164, "body": "VOILA!  Thank you so much, for the answer and for being so patient. You really helped me out!"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 1, "last_activity_date": 1525877323, "last_edit_date": 1525877323, "creation_date": 1525872898, "answer_id": 50254767, "question_id": 50251858, "link": "https://stackoverflow.com/questions/50251858/using-values-in-a-range-as-a-variable/50254767#50254767", "title": "Using values in a range as a variable", "body": "<p>This uses <code>FIND</code> rather than <code>FILTER</code> to copy the correct rows.<br>\nThe <code>Main</code> procedure defines the range you're searching and which values will be searched for.  The <code>FindValues</code> procedure finds the value and copies it to the correct sheet.  </p>\n\n<p>This assumes that <code>Sheet3!A1:A3</code> contains a unique list of values to be searched for and the these values can be found in <code>Sheet1!H:H</code>.<br>\nIt also assumes that all sheets already exist.  </p>\n\n<pre><code>Public Sub Main()\n\n    Dim rToFind As Range\n    Dim rValue As Range\n    Dim rSearchRange As Range\n\n    With ThisWorkbook\n\n        'Update to the range being searched.\n        With .Worksheets(\"Sheet1\")\n            Set rSearchRange = .Range(\"H1\", .Cells(.Rows.Count, 8).End(xlUp))\n        End With\n\n        'Update to the range containing the values to be searched for.\n        Set rToFind = .Worksheets(\"Sheet3\").Range(\"A1:A3\")\n\n    End With\n\n    'Passe each of the values to be searched to the FindValues procedure.\n    For Each rValue In rToFind\n        FindValues rValue, rSearchRange\n    Next rValue\n\n\n'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n'    Alternative method to look for hard-coded values.\n'    `ValuesToFind` in FindValues procedure will needed changing to a Variant.\n'\n'    Dim vAlternativeSearch As Variant\n'    Dim vAlternativeValue As Variant\n'    vAlternativeSearch = Array(1475, 1683, 219)\n'\n'    For Each vAlternativeValue In vAlternativeSearch\n'        FindValues vAlternativeValue, rSearchRange\n'    Next vAlternativeValue\n\nEnd Sub\n\nPublic Sub FindValues(ValueToFind As Range, RangeToSearch As Range)\n\n    Dim rFound As Range\n    Dim sFirstAddress\n    Dim rLastUsedCell As Range\n\n    'Find the next available row on the referenced sheet.\n    With ThisWorkbook.Worksheets(CStr(ValueToFind))\n        Set rLastUsedCell = .Range(\"A1\", .Cells(.Rows.Count, 1).End(xlUp)).Offset(1)\n    End With\n\n    With RangeToSearch\n\n        'Find the first value.\n        Set rFound = .Find(What:=ValueToFind, _\n                           After:=RangeToSearch.Cells(RangeToSearch.Cells.Count), _\n                           LookAt:=xlPart, _\n                           SearchDirection:=xlNext)\n\n        'If the first value exists then remember the address, copy the cells to the\n        'correct sheet and look for the next row with the same value.  Stop when\n        'it reaches the first address again.\n        If Not rFound Is Nothing Then\n            sFirstAddress = rFound.Address\n            Do\n                'You may have to muck around with this to get the correct range to copy.\n                'If rFound is in column H this will copy columns B:D and F.\n                Union(rFound.Offset(, -6).Resize(, 3), rFound.Offset(, -2)).Copy Destination:=rLastUsedCell\n                Set rLastUsedCell = rLastUsedCell.Offset(1)\n                Set rFound = .FindNext(rFound)\n            Loop While rFound.Address &lt;&gt; sFirstAddress\n        End If\n    End With\n\nEnd Sub  \n</code></pre>\n\n<h3>Edit 1:</h3>\n\n<p>You say the worksheets already exists, but in your comment you say put it in a brand new sheet.<br>\nTo add a new sheet add this function:  </p>\n\n<pre><code>Public Function WorkSheetExists(SheetName As String, Optional WrkBk As Workbook) As Boolean\n    Dim wrkSht As Worksheet\n\n    If WrkBk Is Nothing Then\n        Set WrkBk = ThisWorkbook\n    End If\n\n    On Error Resume Next\n        Set wrkSht = WrkBk.Worksheets(SheetName)\n        WorkSheetExists = (Err.Number = 0)\n        Set wrkSht = Nothing\n    On Error GoTo 0\nEnd Function\n</code></pre>\n\n<p>and then add this code directly after the variable declaration in the <code>FindValues</code> procedure:  </p>\n\n<pre><code>Dim wrkSht As Worksheet\nIf Not WorkSheetExists(CStr(ValueToFind)) Then\n    Set wrkSht = ThisWorkbook.Worksheets.Add\n    wrkSht.Name = CStr(ValueToFind)\nEnd If  \n</code></pre>\n\n<h1>Edit 2:</h1>\n\n<p>This updated code searches columns Q:Z, returns the values from A:L as well as the found cell.<br>\nTo update from the original code I had to change <code>rSearchRange</code> to look from Q1 to column 26, and update the Copy/Paste line to return the correct range.  </p>\n\n<pre><code>Public Sub Main()\n\n    Dim rToFind As Range\n    Dim rValue As Range\n    Dim rSearchRange As Range\n\n    With ThisWorkbook\n\n        'Update to the range being searched.\n        With .Worksheets(\"Data\")\n            Set rSearchRange = .Range(\"Q1\", .Cells(.Rows.Count, 26).End(xlUp))\n        End With\n\n        'Update to the range containing the values to be searched for.\n        Set rToFind = .Worksheets(\"Items\").Range(\"A1:A2\")\n\n    End With\n\n    'Passe each of the values to be searched to the FindValues procedure.\n    For Each rValue In rToFind\n        FindValues rValue, rSearchRange\n    Next rValue\n\nEnd Sub\n\nPublic Sub FindValues(ValueToFind As Range, RangeToSearch As Range)\n\n    Dim rFound As Range\n    Dim sFirstAddress\n    Dim rLastUsedCell As Range\n\n    'Find the next available row on the referenced sheet.\n    With ThisWorkbook.Worksheets(CStr(ValueToFind))\n        Set rLastUsedCell = .Range(\"A1\", .Cells(.Rows.Count, 1).End(xlUp)).Offset(1)\n    End With\n\n    With RangeToSearch\n\n        'Find the first value.\n        Set rFound = .Find(What:=ValueToFind, _\n                           After:=RangeToSearch.Cells(RangeToSearch.Cells.Count), _\n                           LookAt:=xlPart, _\n                           SearchDirection:=xlNext)\n\n        'If the first value exists then remember the address, copy the cells to the\n        'correct sheet and look for the next row with the same value.  Stop when\n        'it reaches the first address again.\n        If Not rFound Is Nothing Then\n            sFirstAddress = rFound.Address\n            Do\n                'Parent of RangeToSeach range which will be the Data worksheet.\n                With .Parent\n                    'Copy columns A:L (columns 1 to 12) and the found cell.\n                    Union(.Range(.Cells(rFound.Row, 1), .Cells(rFound.Row, 12)), rFound).Copy Destination:=rLastUsedCell\n                End With\n                Set rLastUsedCell = rLastUsedCell.Offset(1)\n                Set rFound = .FindNext(rFound)\n\n            Loop While rFound.Address &lt;&gt; sFirstAddress\n        End If\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9741802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580a4c14c721607089e00bef61d11388?s=128&d=identicon&r=PG", "display_name": "Tom Rundle", "link": "https://stackoverflow.com/users/9741802/tom-rundle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 533, "favorite_count": 0, "accepted_answer_id": 50254767, "answer_count": 2, "score": 0, "last_activity_date": 1525877323, "creation_date": 1525863930, "question_id": 50251858, "link": "https://stackoverflow.com/questions/50251858/using-values-in-a-range-as-a-variable", "title": "Using values in a range as a variable", "body": "<p>Instead of hard coding the value to be looked up (\"1234\"), I would like to use a range of values, on a separate worksheet(\"Items\") to use as the search criteria.</p>\n\n<p>I would also like to substitute that same value for the destination sheet.</p>\n\n<p>For example, the first value in the range could be \"8754\", I would like the code to look for this value then paste the columns, A,B,C,F and the cell containing the value onto the worksheet \"8754\". (I have all of the worksheets created already)</p>\n\n<p>TIA</p>\n\n<pre><code>Sub Test()\nDim Cell As Range\n\nWith Sheets(\"Sheet1\") 'Sheet with data to check for value\nFor Each Cell In .Range(\"H1:H\" &amp; .Cells(.Rows.Count, \"H\").End(xlUp).Row)\n    pos = InStr(Cell.Value, \"1234\")\n    If pos &gt; 0 Then\n        NextFreeRow = Sheets(\"Sheet2\").Cells(Sheets(\"Sheet2\").Rows.Count, \n\"A\").End(xlUp).Row + 1\n         'get the next empty row to paste data to\n        .Range(\"A\" &amp; Cell.Row &amp; \",B\" &amp; Cell.Row &amp; \",C\" &amp; Cell.Row &amp; \",F\" &amp; \nCell.Row &amp; \",\" &amp; Cell.Address).Copy Destination:=Sheets(\"Sheet2\").Range(\"A\" &amp; NextFreeRow)\n        End If\n    Next Cell\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3, "user_id": 9764270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e10ce620d1a3cc963ad2c9c96cd0c038?s=128&d=identicon&r=PG&f=1", "display_name": "OMNI", "link": "https://stackoverflow.com/users/9764270/omni"}, "edited": false, "score": 0, "creation_date": 1525864713, "post_id": 50251748, "comment_id": 87521262, "body": "This does not work for me. How to find it?"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 1, "creation_date": 1525864878, "post_id": 50251748, "comment_id": 87521373, "body": "<code>Worksheets(&quot;Sheet1&quot;).UsedRange.Cells(1).Select</code>"}], "answers": [{"comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1525867287, "post_id": 50252759, "comment_id": 87522911, "body": "It&#39;s cool to see how Excel maintains B2 as <i>used</i> even if it has no value. Your answer is great and your method to get the <i>real first used cell</i> is really useful. Thanks for sharing it"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 2, "last_activity_date": 1525866904, "creation_date": 1525866904, "answer_id": 50252759, "question_id": 50251748, "link": "https://stackoverflow.com/questions/50251748/how-to-find-the-first-used-cell-in-the-excel-sheet-dynamically-in-vba/50252759#50252759", "title": "How to find the first used cell in the excel sheet dynamically in VBA?", "body": "<p>Sadly the first cell in <code>UsedRange</code> may not actually be used.  For example:</p>\n\n<pre><code>Sub ExamineUsedrange1()\n    MsgBox ActiveSheet.UsedRange.Address(0, 0)\nEnd Sub\n</code></pre>\n\n<p>However:</p>\n\n<p><a href=\"https://i.stack.imgur.com/4iexZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4iexZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>where <strong>B2</strong> is not used.  It is better to use:</p>\n\n<pre><code>Sub ExamineUsedrange2()\n    Dim r As Range\n    Set r = Cells.Find(What:=\"*\", _\n                    After:=Cells(Rows.Count, Columns.Count), _\n                    LookAt:=xlPart, _\n                    LookIn:=xlFormulas, _\n                    SearchOrder:=xlByRows, _\n                    SearchDirection:=xlNext, _\n                    MatchCase:=False)\n    MsgBox r.Address(0, 0)\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Szlw1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Szlw1.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 9764270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e10ce620d1a3cc963ad2c9c96cd0c038?s=128&d=identicon&r=PG&f=1", "display_name": "OMNI", "link": "https://stackoverflow.com/users/9764270/omni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 597, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1525866904, "creation_date": 1525863564, "last_edit_date": 1531164843, "question_id": 50251748, "link": "https://stackoverflow.com/questions/50251748/how-to-find-the-first-used-cell-in-the-excel-sheet-dynamically-in-vba", "title": "How to find the first used cell in the excel sheet dynamically in VBA?", "body": "<pre><code>info.Worksheets(\"sheet1\").UsedRange().Select\n    ActiveCell.SpecialCells(xlFirstCell).Select\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1525863480, "post_id": 50251293, "comment_id": 87520433, "body": "Are you trying to delete empty columns in the range as well?"}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1525863685, "post_id": 50251293, "comment_id": 87520553, "body": "@QHarr No, not empty columns. I need to delete all columns that do not contain the headers &quot;Employee Number&quot; or &quot;Status&quot;. But these 3 worksheets do not contain headers, so no columns are deleted even though there should be a few columns deleted."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1525863747, "post_id": 50251293, "comment_id": 87520589, "body": "If there is no header how would the correct columns to delete be determined in those sheets?"}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1525864055, "post_id": 50251293, "comment_id": 87520788, "body": "@QHarr So that&#39;s the issue. That&#39;s why I was thinking of some code that would determine the lastColumn that has data, then scan row 1 until lastColumn and if a cell is empty in row 1, I insert some text and when I run the code to delete the columns, it would have text to compare to."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1525865695, "post_id": 50251293, "comment_id": 87521946, "body": "How would you determine which columns to add the text to if the header positions are not fixed? Conversely, if they are fixed you  could modify your array to the column numbers to keep."}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1525866708, "post_id": 50251293, "comment_id": 87522561, "body": "@QHarr perhaps something like this: Find the last column that has data in it; Identify the column (lets assume column E) - at this point, we know from column A - E there is data in those columns; Set a loop from cell B1 - cell E1 to check if the cells are blank or not (I say cell B1 because I know cell A1 will contain &quot;Employee Number&quot;); if the cell is blank, insert the text &quot;blank&quot;; When I execute the macro that check column headers, it would therefore be able to check that from column B - E needs to be deleted because it has text and doesn&#39;t match the required text in the array."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1525866762, "post_id": 50251293, "comment_id": 87522594, "body": "My code below would do the same thing. See the  For Each rng In Intersect(.Rows(1), .UsedRange) and combine with the &lt;&gt;0 test."}], "answers": [{"comments": [{"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 1, "creation_date": 1525867328, "post_id": 50251659, "comment_id": 87522943, "body": "Ahhh you see, I knew you knew what I was trying to do! Thank you very much :)"}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1525869277, "post_id": 50251659, "comment_id": 87524251, "body": "I seem to be having an issue. I changed the code a little to not be specific to one sheet but rather loop through them all and I seem to be getting an error with that.. I updated my question with that error.."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1525869840, "post_id": 50251659, "comment_id": 87524673, "body": "Is it thrown when the sheet has nothing in the first row at all? See bottom version of answer."}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1525871263, "post_id": 50251659, "comment_id": 87525735, "body": "I used your code exactly, I get the error: Method &#39;union&#39; of &#39;object&#39;_Global&#39; failed at this line Set unionRng = Union(unionRng, rng). However, when you posted your original answer, the code worked perfectly."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1525871576, "post_id": 50251659, "comment_id": 87525953, "body": "Not sure what else to say without seeing your data layout as the above should work. This line in the bottom version Application.WorksheetFunction.CountA(.Rows(1)) &gt; 0   ensures that union is not attempted if there is no data in row 1."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1525980575, "post_id": 50251659, "comment_id": 87576982, "body": "Was additional problem sorted?"}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 1, "creation_date": 1526025302, "post_id": 50251659, "comment_id": 87591148, "body": "Yes it was, thank you very much! :) I had to leave early so I did not get to contact you again."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1525873953, "last_edit_date": 1525873953, "creation_date": 1525863278, "answer_id": 50251659, "question_id": 50251293, "link": "https://stackoverflow.com/questions/50251293/vba-find-lastcolumn-and-check-if-first-row-is-empty/50251659#50251659", "title": "VBA - Find lastColumn and Check if First Row Is Empty", "body": "<p>You could change the condition to </p>\n\n<pre><code>IsError(Application.Match(rng.Value, keepCols, 0)) \n</code></pre>\n\n<p>That picks up all non-matching items.</p>\n\n<p>Note:</p>\n\n<pre><code>For Each rng In Intersect(.Rows(1), .UsedRange)\n</code></pre>\n\n<p>The above is going to loop through the used range of row 1 in the selected sheet.</p>\n\n<p>Looping multiple sheets might be something like:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim keepCols()\n    keepCols = Array(\"Employee Number\", \"Status\")\n\n    Dim unionRng As Range, rng As Range, ws As Worksheet\n\n    For Each ws In ThisWorkbook.Worksheets\n        With ws\n            If Application.WorksheetFunction.CountA(.Rows(1)) &gt; 0 Then\n                For Each rng In Intersect(.Rows(1), .UsedRange)\n                    If IsError(Application.Match(rng.Value, keepCols, 0)) Then\n                        If Not unionRng Is Nothing Then\n                            Set unionRng = Union(unionRng, rng)\n                        Else\n                            Set unionRng = rng\n                        End If\n                    End If\n                Next rng\n                If Not unionRng Is Nothing Then \n                    Debug.Print unionRng.EntireColumn.Address 'unionRng.EntireColumn.Delete '.  ''&lt;== Swop when ready to delete\n                    Set unionRng = Nothing\n                End If\n            End If\n        End With\n    Next ws\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 502, "favorite_count": 0, "accepted_answer_id": 50251659, "answer_count": 1, "score": 0, "last_activity_date": 1525947585, "creation_date": 1525862126, "last_edit_date": 1525947585, "question_id": 50251293, "link": "https://stackoverflow.com/questions/50251293/vba-find-lastcolumn-and-check-if-first-row-is-empty", "title": "VBA - Find lastColumn and Check if First Row Is Empty", "body": "<p>I am not too sure how I should solve this issue, but there are two methods that make sense to me..</p>\n\n<p>Some of the sheets in my workbook do not have headers, so I use the below code to insert a blank row and assign a header to column A - I know column A will always be employee number.</p>\n\n<pre><code>Sub insertRow()\n\n    Dim ws1 As Worksheet, ws2 As Worksheet, ws3 As Worksheet\n    Dim wkbk1 As Workbook\n\n    Set wkbk1 = Workbooks(\"testWorkbook.xlsm\")\n\n    'Set sheets to be used in each workbook\n    Set ws1 = wkbk1.Sheets(\"mySheet\")\n    Set ws2 = wkbk1.Sheets(\"hisSheet\")\n    Set ws3 = wkbk1.Sheets(\"herSheet\")\n\n    wkbk1.Activate\n\n    ws1.Range(\"A1\").EntireRow.Insert\n    ws1.Range(\"A1\").Value = \"Employee Number\"\n\n    ws2.Range(\"A1\").EntireRow.Insert\n    ws2.Range(\"A1\").Value = \"Employee Number\"\n\n    ws3.Range(\"A1\").EntireRow.Insert\n    ws3.Range(\"A1\").Value = \"Employee Number\"\n\nEnd Sub\n</code></pre>\n\n<p>The below code deletes columns based on the header name.</p>\n\n<pre><code>Sub ManipulateSheets()\n\n    Dim a As Long, w As Long\n    Dim keepCols As Variant\n    Dim wkbk1 As Workbook\n\n    Set wkbk1 = Workbooks(\"testWorkbook.xlsm\")\n\n    keepCols = Array(\"Employee Number\", \"Status\")\n\n    wkbk1.Activate\n\n    With wkbk1\n\n        For w = 1 To .Worksheets.count\n\n            With Worksheets(w)\n\n                For a = .Columns.count To 1 Step -1\n\n                    If UBound(Filter(keepCols, .Cells(1, a), True, vbTextCompare)) &lt; 0 Then _\n                            .Columns(a).EntireColumn.Delete\n\n                Next a\n\n            End With\n\n        Next w\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>The issue is this:</p>\n\n<p>The 3 sheets that I insert a row in and set the column header for column A to Employee Number, still has empty headers for the remainder of the row.. So when I run the code above to delete the columns, nothing happens on these 3 sheets as there is no data to compare to in the header.</p>\n\n<p>So the two options I thought would work are:</p>\n\n<ol>\n<li><p>Find the lastColumn and insert text into the cells between column A and the lastColumn</p></li>\n<li><p>Find the lastColumn and include a criteria in the if statement that looks for blank cells as well as non-matching headers</p></li>\n</ol>\n\n<p>I got the code to find the lastColumn here:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/11926972/excel-vba-finding-the-last-column-with-data\">Excel VBA- Finding the last column with data</a></p>\n\n<pre><code>Sub findColumn()\n\n    Dim rLastCell As Range\n    Dim i As Long\n    Dim MyVar As Variant\n    Dim ws1 As Worksheet\n    Dim wkbk1 As Workbook\n    i = 2\n\n    Set wkbk1 = Workbooks(\"testWorkbook.xlsm\")\n\n    Set ws2 = wkbk1.Sheets(\"ws1\")\n\n    Set rLastCell = ws2.Cells.Find(What:=\"*\", After:=ws2.Cells(1, 1), LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByColumns, SearchDirection:=xlPrevious, MatchCase:=False)\n\nEnd Sub\n</code></pre>\n\n<p>I'm thinking of a Do While Loop along the lines of the below:</p>\n\n<pre><code>Do While (MyVar1 &gt;= 2 And MyVar1 &lt; rLastCell.Column)\n\n\n\nLoop\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 7035439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea81d39de8770008c0cf6af9351953d6?s=128&d=identicon&r=PG&f=1", "display_name": "Horenz", "link": "https://stackoverflow.com/users/7035439/horenz"}, "edited": false, "score": 0, "creation_date": 1525888186, "post_id": 50256858, "comment_id": 87536497, "body": "Thanks for your help! It works for the first duplicate, but it lacks switching to the next duplicate it should look for. Given the above mentioned example, your code deletes all the &quot;b&quot; but it lacks to delete &quot;c&quot;, &quot;e&quot;, &quot;f&quot;... Hope you get what i meant..."}, {"owner": {"reputation": 15, "user_id": 7035439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea81d39de8770008c0cf6af9351953d6?s=128&d=identicon&r=PG&f=1", "display_name": "Horenz", "link": "https://stackoverflow.com/users/7035439/horenz"}, "edited": false, "score": 0, "creation_date": 1525889136, "post_id": 50256858, "comment_id": 87536960, "body": "Also, excel crashes when i try to run your code. I just saw the error message once, and i think it was &quot;Run-time error &#39;-2147024809 (80070057)&quot;.. But when i go through with F8 it works for the first duplicate."}], "tags": [], "owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "is_accepted": false, "score": 0, "last_activity_date": 1526361782, "last_edit_date": 1526361782, "creation_date": 1525879219, "answer_id": 50256858, "question_id": 50251129, "link": "https://stackoverflow.com/questions/50251129/delete-one-duplicate-cell-out-of-table-range/50256858#50256858", "title": "Delete one duplicate cell out of table range", "body": "<p>Try this: </p>\n\n<pre><code>duplikat = reportsheet.Cells(Duplikat_row, Duplikat_column).Value\n\nFor Sucher_row = 1 To Sucher_rowTotalRows\n    For Sucher_column = 2 To (Cells(Sucher_row, Columns.Count).End(xlToLeft).Column) '' Breite der Spalte\n        Do While duplikat = Cells(Sucher_row, Sucher_column).Value  '' Falls gesuchtes und gesuchert uebereinstimmt\n            If Sucher_row = Duplikat_row And Sucher_column = Duplikat_column Then\n                Exit Do\n            Else\n                Cells(Sucher_row, Sucher_column).Delete xlShiftToLeft '' l\u00f6schen und nach links verschieben\n            End If\n        Loop\n    Next\nNext\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 7035439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea81d39de8770008c0cf6af9351953d6?s=128&d=identicon&r=PG&f=1", "display_name": "Horenz", "link": "https://stackoverflow.com/users/7035439/horenz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1526361782, "creation_date": 1525861662, "last_edit_date": 1531164843, "question_id": 50251129, "link": "https://stackoverflow.com/questions/50251129/delete-one-duplicate-cell-out-of-table-range", "title": "Delete one duplicate cell out of table range", "body": "<p>I want to delete duplicate cells out of a specific table range, but one duplicate (the first from the top) should not be deleted. Column A of the table should not be searched for duplicates. It is also possible that there is no content in the table starting from column B.</p>\n\n<p>This is how it looks (sorry for the numbering, wasn't sure how to format it otherwise):</p>\n\n<ol>\n<li>ABCDE</li>\n<li>a</li>\n<li>bbcde</li>\n<li>cbcef</li>\n<li>ddefgh</li>\n</ol>\n\n<p>This is what i want:</p>\n\n<ol>\n<li>ABCDE</li>\n<li>a</li>\n<li>bbcde</li>\n<li>cf</li>\n<li>dgh</li>\n</ol>\n\n<p>I tried to do this with two for loops. The first one loops through each row and the second one through each column. If it finds a duplicate, it should delete it. </p>\n\n<p>But I guess I have messed something up with the for loops there, because sometimes it deletes some weird stuff and not the duplicates..</p>\n\n<pre><code>Dim reportsheet As Worksheet\nDim C1row As Long\nDim C2row As Long\nDim C2column As Long\nDim C2TotalRows As Long\nDim CustID As String\nDim NoDups As Long\n\nSet reportsheet = ThisWorkbook.Worksheets(\"Tabelle44\")\nreportsheet.Activate\nSucher_rowTotalRows = Application.CountA(Range(\"A:A\")) ' switchen durch Reihen\nDuplikat_row = 1 'f\u00fcr aeuseres For zum durchswitschen zwischen den Ist\nSucher_row = 1\nDuplikat_column = 2\nSucher_column = 2\n\ntestwert = Cells(Duplikat_row, Columns.Count).End(xlToLeft).Column\n\nDo While Duplikat_row &lt;= Sucher_rowTotalRows\n\n    If Cells(Duplikat_row, Columns.Count).End(xlToLeft).Column = 1 Then\n    Duplikat_row = Duplikat_row + 1\n    Sucher_row = Sucher_row + 1\n    End If\n\n    duplikat = reportsheet.Cells(Duplikat_row, Duplikat_column).Value\n\n     For Sucher_row = 1 To Sucher_rowTotalRows\n        For Sucher_column = 2 To (Cells(Sucher_row, Columns.Count).End(xlToLeft).Column) '' Breite der Spalte\n            If duplikat = Cells(Sucher_row, Sucher_column).Value Then '' Falls gesuchtes und gesuchert uebereinstimmt\n\n                Cells(Sucher_row, Sucher_column).Delete xlShiftToLeft '' l\u00f6schen und nach links verschieben\n                Sucher_column = Sucher_column - 1\n                Exit For\n            End If\n        Next\n        Sucher_column = Sucher_column + 1 '' Suchspalte eins weiter\n    Next\n    Duplikat_row = Duplikat_row + 1 ''suchreihe eins weiter\nLoop\n</code></pre>\n\n<p>Any idea what is going wrong there? Thanks so much!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1525861117, "post_id": 50250631, "comment_id": 87518967, "body": "What do you mean by &quot; ideally i could run this without opening the the powerpoint&quot;? Are you looking for the problem with SaveAs or do you really want to ask a different question? If the SaveAs, why don&#39;t you have a PowerPoint tag in your question?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1525861371, "post_id": 50250631, "comment_id": 87519140, "body": "Your problem is that you&#39;re using <code>Set PPT_pres = PPT.Presentations.SaveAs</code> instead of <code>PPT_pres.SaveAs</code>. Copy/paste when you&#39;re tired has its pitfalls..."}, {"owner": {"reputation": 143, "user_id": 9602830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54a836bb337b79183be9ac3a78bb65bb?s=128&d=identicon&r=PG&f=1", "display_name": "TisButaScratch ", "link": "https://stackoverflow.com/users/9602830/tisbutascratch"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1525862634, "post_id": 50250631, "comment_id": 87519941, "body": "Yeah I think its time for a coffee break... Thank you Cindy"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 1, "creation_date": 1525867499, "post_id": 50250631, "comment_id": 87523040, "body": "To do this without opening Powerpoint, for <i>any</i> filetype:  <a href=\"https://msdn.microsoft.com/en-us/VBA/language-reference-vba/articles/filecopy-statement\" rel=\"nofollow noreferrer\"><code>FileCopy</code></a><code>ThisWorkbook.Sheets(&quot;Automation&quot;).Range(&quot;D20&quot;), &quot;C:\\Users\\[userName]\\Desktop\\test\\Weekly Pack Update - Final.pptx&quot;</code>"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1525868069, "post_id": 50250631, "comment_id": 87523387, "body": "@Chronicidal - I&#39;d write that up as an answer.  Or you could use the <code>CopyFile</code> from the <code>Scripting.FileSystemObject</code> which can be used to trap a &quot;File already exists&quot; error."}], "answers": [{"tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": true, "score": 1, "last_activity_date": 1525868972, "creation_date": 1525868972, "answer_id": 50253480, "question_id": 50250631, "link": "https://stackoverflow.com/questions/50250631/vba-open-powerpoint-save-with-new-name/50253480#50253480", "title": "VBA open powerpoint save with new name", "body": "<p><em>Upgraded from a Comment on the question:</em><br>\nTo do this without opening Powerpoint, for any filetype: <a href=\"https://msdn.microsoft.com/en-us/VBA/language-reference-vba/articles/filecopy-statement\" rel=\"nofollow noreferrer\"><code>FileCopy</code></a><code>ThisWorkbook.Sheets(\"Automation\").Range(\"D20\"), \"C:\\Users\\[userName]\\Desktop\\test\\Weekly Pack Update - Final.pptx\"</code></p>\n\n<p>To do this slightly more safely:</p>\n\n<pre><code>Public Function SafeCopy(Source As String, Destination As String) As Boolean\n    SafeCopy = False\n    'Source does not exist\n    If Len(Dir(Source)) &lt; 2 Then Exit Function\n    'Clear destination file if it already exists\n    If Len(Dir(Destination)) &gt; 1 Then\n        Kill Destination\n        'Cannot clear destination\n        If Len(Dir(Destination)) &gt; 1 Then Exit Function\n    End If\n    'Do the actual copy\n    FileCopy Source, Destination\n    'Report on success/failure\n    SaveCopy = (Len(Dir(Destination)) &gt; 1)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 9602830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54a836bb337b79183be9ac3a78bb65bb?s=128&d=identicon&r=PG&f=1", "display_name": "TisButaScratch ", "link": "https://stackoverflow.com/users/9602830/tisbutascratch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 50253480, "answer_count": 1, "score": 0, "last_activity_date": 1525868972, "creation_date": 1525860207, "last_edit_date": 1531164843, "question_id": 50250631, "link": "https://stackoverflow.com/questions/50250631/vba-open-powerpoint-save-with-new-name", "title": "VBA open powerpoint save with new name", "body": "<p>I am trying to simply open a powerpoint and then SaveAs with a new name.</p>\n\n<p>I get \"compile error: Method or data member not found\"</p>\n\n<pre><code>Public Sub OpenPPTfinalOpp()\n    Dim templatePath As String\n    Set PPT = New PowerPoint.Application\n\n\n    templatePath = ThisWorkbook.Sheets(\"Automation\").Range(\"D20\")\n    'templatePath = \"C:\\Users\\[userName]\\Desktop\\test\\Weekly Pack Update - Template.pptx\"\n\n    PPT.Visible = False\n    Set PPT_pres = PPT.Presentations.Open(Filename:=templatePath)\n\n    Set PPT_pres = PPT.Presentations.SaveAs(Filename:=\"C:\\Users\\[userName]\\Desktop\\test\\Weekly Pack Update - Final.pptx\")\n\n\nEnd Sub\n</code></pre>\n\n<p>The code runs without the SaveAs line, ideally i could run this without opening the the powerpoint as this is just the first step before attaching it to an email.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1525867304, "post_id": 50250467, "comment_id": 87522929, "body": "Would using the <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/names-object-excel\" rel=\"nofollow noreferrer\">Names Collection</a> solve your issue?"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1525872307, "post_id": 50250467, "comment_id": 87526479, "body": "The Names collection is the VBA way to access Formulas &gt; Name Manager (or select a Range and give it a name in the box on the left of the Formula Bar) - if you add a name like <code>ThisWorkbook.Names.Add &quot;KINDACC&quot;, Worksheets(&quot;Database&quot;).Range(&quot;N4:N14&quot;)</code> then you can use <code>ThisWorkbook.Range(&quot;KINDACC&quot;)</code> to access the range."}, {"owner": {"reputation": 43, "user_id": 9754887, "user_type": "registered", "profile_image": "https://graph.facebook.com/10217115643109851/picture?type=large", "display_name": "Emma Frost", "link": "https://stackoverflow.com/users/9754887/emma-frost"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1525872978, "post_id": 50250467, "comment_id": 87526992, "body": "Ok, the thing is, i have about 300 keywords. So it should automatically set the right range to my rngKeyword.   i tried:          rngKeyword.name=&quot;r_&quot; &amp; strKeyword  and it kind of works. But if I change the Keyword it doesn&#39;t change my rngKeyword too.."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1525877490, "post_id": 50250467, "comment_id": 87530362, "body": "Once you have set up the Names, you can use <code>Set rngKeyword = Range(strKeyword)</code> - this needs calling every time you want to change <code>rngKeyword</code>...  OR you just replace all of your <code>rngKeyword</code> with <code>Range(strkeyword)</code> instead"}, {"owner": {"reputation": 43, "user_id": 9754887, "user_type": "registered", "profile_image": "https://graph.facebook.com/10217115643109851/picture?type=large", "display_name": "Emma Frost", "link": "https://stackoverflow.com/users/9754887/emma-frost"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1526384737, "post_id": 50250467, "comment_id": 87714429, "body": "Hey Chronocidal, thanks for your help, i tried your first option, which just didn&#39;t work, so i replaced everything, and now it works. thanks"}], "owner": {"reputation": 43, "user_id": 9754887, "user_type": "registered", "profile_image": "https://graph.facebook.com/10217115643109851/picture?type=large", "display_name": "Emma Frost", "link": "https://stackoverflow.com/users/9754887/emma-frost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1525859734, "creation_date": 1525859734, "last_edit_date": 1531164843, "question_id": 50250467, "link": "https://stackoverflow.com/questions/50250467/vba-use-string-for-range", "title": "VBA use string for range", "body": "<p>I need help for my VBA tool.</p>\n\n<p>In my program I define a string keyword:</p>\n\n<pre><code>    Public Sub SetKeyword()\n\n        Call Define_Variables.variables\n        Call Database.Allocation\n\n        strKeyword=\"KINDACC\"\n</code></pre>\n\n<p>Now I would like to set the name of the range keyword with my string keyword, so it looks like this:</p>\n\n<pre><code>    Public Sub SetKeyword()\n\n\n        Call Define_Variables.variables\n        Call Database.Allocation\n\n\n        strKeyword=\"KINDACC\"\n        rngKeyword= r_KINDACC\n\n     End Sub\n</code></pre>\n\n<p>In my module \"Database\" I have those r_strKeywords already defined:</p>\n\n<pre><code>    Sub Allocation()\n\n\n    'General accident information\n     ...\n     Set r_KINDACC = Worksheets(\"Database\").Range(\"N4:N14\")\n     End sub\n</code></pre>\n\n<p>So later with my GUI I would like to define a string-keyword and my program automatically defines my range-keyword with my string keyword:</p>\n\n<pre><code>     Public Sub SetKeyword()\n\n\n          Call Define_Variables.variables\n          Call Database.Allocation\n\n\n          strKeyword=blabla\n          rngKeyword= r_strKeyword\n\n    End Sub\n</code></pre>\n\n<p>Is that possible?\nI hope it's not too confusing</p>\n\n<p>thanks!!</p>\n\n<p>Viktoria</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "edited": false, "score": 0, "creation_date": 1525858926, "post_id": 50250072, "comment_id": 87517587, "body": "strRangeValue should be range."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1525859050, "post_id": 50250072, "comment_id": 87517654, "body": "It&#39;s about 255 characters, IIRC. By the way, you are not using Name Manager here at all."}, {"owner": {"reputation": 781, "user_id": 1000471, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/422b6d180734c30ab942aa1171fb8a33?s=128&d=identicon&r=PG", "display_name": "Nithin", "link": "https://stackoverflow.com/users/1000471/nithin"}, "edited": false, "score": 0, "creation_date": 1525859097, "post_id": 50250072, "comment_id": 87517690, "body": "But my requirement is to add the strings valuse directly  to a named range"}, {"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1525859249, "post_id": 50250072, "comment_id": 87517790, "body": "The limit is 255, but there are some workarounds, but it all depends how exactly does the strRangeValue look like, how do you build it, etc."}, {"owner": {"reputation": 781, "user_id": 1000471, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/422b6d180734c30ab942aa1171fb8a33?s=128&d=identicon&r=PG", "display_name": "Nithin", "link": "https://stackoverflow.com/users/1000471/nithin"}, "edited": false, "score": 0, "creation_date": 1525859726, "post_id": 50250072, "comment_id": 87518068, "body": "strRangeValue is added as:   strRangeValue=&quot;={&quot;&quot;a&quot;&quot;,&quot;&quot;b&quot;&quot;,&quot;&quot;c&quot;&quot;;&quot;&quot;d&quot;&quot;,&quot;&quot;e&quot;&quot;,&quot;&quot;f&quot;&quot;}&quot;"}, {"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1525861066, "post_id": 50250072, "comment_id": 87518940, "body": "It looks like you are adding constant array as a named range. To workaround string length limit you should be adding variant array instead of string. It should be easy to get it directly from a range."}], "owner": {"reputation": 781, "user_id": 1000471, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/422b6d180734c30ab942aa1171fb8a33?s=128&d=identicon&r=PG", "display_name": "Nithin", "link": "https://stackoverflow.com/users/1000471/nithin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1525858583, "creation_date": 1525858583, "last_edit_date": 1531161705, "question_id": 50250072, "link": "https://stackoverflow.com/questions/50250072/error-while-adding-name-in-excel-name-manager", "title": "Error while adding name in Excel Name Manager", "body": "<p>I am getting an error(Error 1004:Application defined or object defined error) while adding name in Excel Name Manager using VBA</p>\n\n<pre><code>ActiveWorkbook.Names.Add Name:=\"SaveSelections\", RefersToR1C1:=strRangeValue\n</code></pre>\n\n<p>The code works fine when the strRangeValue is of small length,but throws error for long values.Is there any character limit for the string value that is added to name manager directly?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 1, "creation_date": 1525857823, "post_id": 50249768, "comment_id": 87516884, "body": "<b><code>Range(&quot;N2:N&quot; &amp; R).Value</code></b>"}, {"owner": {"reputation": 387, "user_id": 7889517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dbabbb45e58afd3a6c7d7ee679d8eaf?s=128&d=identicon&r=PG&f=1", "display_name": "tsdn", "link": "https://stackoverflow.com/users/7889517/tsdn"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 1, "creation_date": 1525858129, "post_id": 50249768, "comment_id": 87517079, "body": "@Zac I don&#39;t think the above will work, R is a range here. Perhaps this will Range(&quot;N2:N&quot; &amp; R.Rows.Count).Value =..."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 387, "user_id": 7889517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dbabbb45e58afd3a6c7d7ee679d8eaf?s=128&d=identicon&r=PG&f=1", "display_name": "tsdn", "link": "https://stackoverflow.com/users/7889517/tsdn"}, "edited": false, "score": 0, "creation_date": 1525858409, "post_id": 50249768, "comment_id": 87517250, "body": "@JK2017: good shout.. I missed that <code>R</code> was set as range"}], "answers": [{"tags": [], "owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "is_accepted": true, "score": 1, "last_activity_date": 1525858045, "creation_date": 1525858045, "answer_id": 50249898, "question_id": 50249768, "link": "https://stackoverflow.com/questions/50249768/how-to-use-a-variable-with-range/50249898#50249898", "title": "How to use a variable with Range?", "body": "<p>Can look as a more complicated but is logical:</p>\n\n<pre><code>Set R = Range(\"a1\", cells(rows.count, \"A\").end(xlup))\nrange(\"N2\", cells(r.rows.count, \"N\")).value=...\n</code></pre>\n\n<p>Step-by-step solution:</p>\n\n<pre><code>Set lastA = cells(rows.count, \"A\").end(xlup)\nset R = range(\"A1\", lastA)\n\nrange(\"N2\", cells(lastA.row, \"N\")).value = ...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 8137381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d762d590cc9e1ec557a16130652c2a?s=128&d=identicon&r=PG&f=1", "display_name": "Marius", "link": "https://stackoverflow.com/users/8137381/marius"}, "edited": false, "score": 0, "creation_date": 1525858372, "post_id": 50249944, "comment_id": 87517231, "body": "Thanks for the answer, but I want to use &quot;r&quot; just for the second value of the Range, not for the whole"}, {"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "reply_to_user": {"reputation": 15, "user_id": 8137381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d762d590cc9e1ec557a16130652c2a?s=128&d=identicon&r=PG&f=1", "display_name": "Marius", "link": "https://stackoverflow.com/users/8137381/marius"}, "edited": false, "score": 0, "creation_date": 1525858654, "post_id": 50249944, "comment_id": 87517412, "body": "you want the second value of r range (i.e A2) in N2?"}, {"owner": {"reputation": 15, "user_id": 8137381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d762d590cc9e1ec557a16130652c2a?s=128&d=identicon&r=PG&f=1", "display_name": "Marius", "link": "https://stackoverflow.com/users/8137381/marius"}, "edited": false, "score": 0, "creation_date": 1526301242, "post_id": 50249944, "comment_id": 87676786, "body": "the solution above is perfectly working, thank you though!"}, {"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "reply_to_user": {"reputation": 15, "user_id": 8137381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d762d590cc9e1ec557a16130652c2a?s=128&d=identicon&r=PG&f=1", "display_name": "Marius", "link": "https://stackoverflow.com/users/8137381/marius"}, "edited": false, "score": 0, "creation_date": 1526369257, "post_id": 50249944, "comment_id": 87704853, "body": "@Marius, Good to hear. Thanks"}], "tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": false, "score": 0, "last_activity_date": 1525859349, "last_edit_date": 1525859349, "creation_date": 1525858143, "answer_id": 50249944, "question_id": 50249768, "link": "https://stackoverflow.com/questions/50249768/how-to-use-a-variable-with-range/50249944#50249944", "title": "How to use a variable with Range?", "body": "<p>pls try with below</p>\n\n<pre><code>Sub test()\n    Dim r As Range\n    Set r = Range(\"A1\", Range(\"A\" &amp; Rows.Count).End(xlUp))\n    Range(\"N2:N\" &amp; r.Rows.Count).Value = \"R\"\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 52, "user_id": 7995847, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTJwg.png?s=128&g=1", "display_name": "FishermansFriend", "link": "https://stackoverflow.com/users/7995847/fishermansfriend"}, "is_accepted": false, "score": 1, "last_activity_date": 1525859915, "creation_date": 1525859915, "answer_id": 50250533, "question_id": 50249768, "link": "https://stackoverflow.com/questions/50249768/how-to-use-a-variable-with-range/50250533#50250533", "title": "How to use a variable with Range?", "body": "<pre><code>Set R = Range(\"A1\", Range(\"A\" &amp; Rows.Count).End(xlUp))\nRange(\"N2:\" &amp; R.Address).Value =...\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 8137381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d762d590cc9e1ec557a16130652c2a?s=128&d=identicon&r=PG&f=1", "display_name": "Marius", "link": "https://stackoverflow.com/users/8137381/marius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 50249898, "answer_count": 3, "score": 0, "last_activity_date": 1525859915, "creation_date": 1525857606, "last_edit_date": 1525857729, "question_id": 50249768, "link": "https://stackoverflow.com/questions/50249768/how-to-use-a-variable-with-range", "title": "How to use a variable with Range?", "body": "<p>I want to use the Rowcount as the second Parameter for the Range.</p>\n\n<pre><code>Set R = Range(\"A1\", Range(\"A\" &amp; Rows.Count).End(xlUp))\n\nRange(\"N2\":R).Value =...\n</code></pre>\n\n<p>How is it possible to use R here as the second Parameter?</p>\n\n<p>Best regards!</p>\n"}, {"tags": ["excel", "vba", "button", "case", "option"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1525856188, "post_id": 50249176, "comment_id": 87515860, "body": "Instead of using <code>ActiveSheet</code> try qualifying your sheet (i.e. change your <code>With</code> statement to something like: <code>With ThisWorkbook.Worksheets(&quot;Sheet1&quot;)</code>.. where sheet name is the sheet where your option buttons are)"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1525856327, "post_id": 50249176, "comment_id": 87515952, "body": "Is the Event routine called at all? Put a statement like <code>msgBox target.address</code> as first statement or use the debugger to check"}, {"owner": {"reputation": 3, "user_id": 9736767, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "FGF", "link": "https://stackoverflow.com/users/9736767/fgf"}, "edited": false, "score": 0, "creation_date": 1525856836, "post_id": 50249176, "comment_id": 87516251, "body": "Still isn&#39;t working"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1525857339, "post_id": 50249176, "comment_id": 87516541, "body": "As we are not sitting at your computer, please give more details what you mean with <i>&quot;isn&#39;t working&quot;</i>. Have you used the debugger to check what fails? Is the name of your shape correct? Do you really want to access cell A1 to check? What is it value of the cell? Is the routine triggered at all?"}, {"owner": {"reputation": 3, "user_id": 9736767, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "FGF", "link": "https://stackoverflow.com/users/9736767/fgf"}, "edited": false, "score": 0, "creation_date": 1525858044, "post_id": 50249176, "comment_id": 87517034, "body": "There is no error when I run it. The name of the option button is correct. It&#39;s simply OptionButton1. First button I created. It doesn&#39;t necessarily have to be cell A1. I&#39;d like to test the process first before I expand it. I keep changing the value of A1 to either &quot;A&quot; or &quot;B&quot;. It should disappear when its &quot;B&quot;. It&#39;s not triggered."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1525860430, "post_id": 50249176, "comment_id": 87518564, "body": "<code>Option Button 1</code> or <code>OptionButton1</code>?"}, {"owner": {"reputation": 3, "user_id": 9736767, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "FGF", "link": "https://stackoverflow.com/users/9736767/fgf"}, "edited": false, "score": 0, "creation_date": 1525864645, "post_id": 50249176, "comment_id": 87521207, "body": "OptionButton1 - I know my code above has both. I changed it all to be consistent."}], "owner": {"reputation": 3, "user_id": 9736767, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "FGF", "link": "https://stackoverflow.com/users/9736767/fgf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1525856221, "creation_date": 1525855858, "last_edit_date": 1525856221, "question_id": 50249176, "link": "https://stackoverflow.com/questions/50249176/option-button-not-disappearing-is-there-something-wrong-with-my-code", "title": "Option Button not disappearing? Is there something wrong with my code?", "body": "<p>I want different option buttons to appear based on the outcome of a cell. Can't seem the get this to work? </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nWith ActiveSheet\n    Select Case Range(\"A1\").Value\n    Case \"A\"\n        .Shapes(\"Option Button 1\").Visible = True\n    Case \"B\"\n        .Shapes(\"Option Button 1\").Visible = False\n    End Select\nEnd With\nEnd Sub\n\nSub OptionButton1_Click()\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "button", "userform"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1525855330, "post_id": 50248967, "comment_id": 87515326, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/31684157/how-to-add-a-command-button-in-vba\">How to add a command button in VBA?</a>"}, {"owner": {"reputation": 33, "user_id": 3121718, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/43ca9a18c032ec90691395240236fbc4?s=128&d=identicon&r=PG&f=1", "display_name": "user3121718", "link": "https://stackoverflow.com/users/3121718/user3121718"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1525856070, "post_id": 50248967, "comment_id": 87515778, "body": "nope, it explains how to create a button and assign it to a macro - this i know. My problem is that my sub is dynamic, i wish to call it with different input parameters, taken from my user form."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1525856309, "post_id": 50248967, "comment_id": 87515933, "body": "A button can only call a sub without parameters. So probably better save these parameters in a sheet and use them from there?"}, {"owner": {"reputation": 33, "user_id": 3121718, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/43ca9a18c032ec90691395240236fbc4?s=128&d=identicon&r=PG&f=1", "display_name": "user3121718", "link": "https://stackoverflow.com/users/3121718/user3121718"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1525856504, "post_id": 50248967, "comment_id": 87516043, "body": "I&#39;m able to save them to the sheet, did that. But how can i create now new macro calling Analyze with those parameters?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1525856721, "post_id": 50248967, "comment_id": 87516169, "body": "Eg if you have a button on each row of parameters you can link all buttons with the same procedure and use <code>ActiveSheet.Shapes(Application.Caller).TopLeftCell.Row</code> to get the row of the clicked button and read the parameters from this row then."}, {"owner": {"reputation": 33, "user_id": 3121718, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/43ca9a18c032ec90691395240236fbc4?s=128&d=identicon&r=PG&f=1", "display_name": "user3121718", "link": "https://stackoverflow.com/users/3121718/user3121718"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1525857082, "post_id": 50248967, "comment_id": 87516396, "body": "maybe. but i&#39;m looking for something cleaner. maybe this will help, will try: <a href=\"https://stackoverflow.com/questions/29858176/how-to-call-a-macro-from-a-button-and-pass-arguments\" title=\"how to call a macro from a button and pass arguments\">stackoverflow.com/questions/29858176/&hellip;</a>"}], "owner": {"reputation": 33, "user_id": 3121718, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/43ca9a18c032ec90691395240236fbc4?s=128&d=identicon&r=PG&f=1", "display_name": "user3121718", "link": "https://stackoverflow.com/users/3121718/user3121718"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1525858242, "creation_date": 1525855127, "last_edit_date": 1525856294, "question_id": 50248967, "link": "https://stackoverflow.com/questions/50248967/excel-vba-add-a-new-procedure-by-vba", "title": "Excel VBA - Add a new procedure by VBA", "body": "<p>I created a user form that asks the user to fill in 3 parameters (textbox) + having OK button.</p>\n\n<p>I also have a sub procedure,\n<code>public sub Analyze (actionName as String, endStr as String, startStr as String)</code>\nwhich I call with different parameters.</p>\n\n<p>I wish that upon clicking on Ok button on my user form, a new button will be created (this can easily be done by <code>activesheet.buttons.add</code>) and will be assigned to a new macro - the Analyze procedure with the parameters from the user form --> so i need to create each time a new sub calling Analyze sub with different parameters.</p>\n\n<p>Is it possible? how can I do that?</p>\n"}, {"tags": ["excel", "vba", "save", "userform"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9763455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1bde71fe82de8eea60dd6811197e4dd?s=128&d=identicon&r=PG&f=1", "display_name": "Jaxven", "link": "https://stackoverflow.com/users/9763455/jaxven"}, "edited": false, "score": 0, "creation_date": 1525871261, "post_id": 50249473, "comment_id": 87525731, "body": "Thank you for the response, how would this be set out in code please? As I said, I am very new to VBA!"}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1525856692, "creation_date": 1525856692, "answer_id": 50249473, "question_id": 50248843, "link": "https://stackoverflow.com/questions/50248843/checking-a-userform-has-been-saved-with-save-click-before-closing/50249473#50249473", "title": "Checking a userform has been saved with save_click before closing", "body": "<p>Define a boolean var (eg \"dataIsSaved\") in your form</p>\n\n<ul>\n<li>set it to <code>false</code> when data is changed (or whenever you think that a\nsave would be needed),  </li>\n<li>set it to <code>true</code> when the data is saved </li>\n<li>check it when the close button is pressed.</li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 9763455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1bde71fe82de8eea60dd6811197e4dd?s=128&d=identicon&r=PG&f=1", "display_name": "Jaxven", "link": "https://stackoverflow.com/users/9763455/jaxven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1525856692, "creation_date": 1525854699, "question_id": 50248843, "link": "https://stackoverflow.com/questions/50248843/checking-a-userform-has-been-saved-with-save-click-before-closing", "title": "Checking a userform has been saved with save_click before closing", "body": "<p>I am very new to VBA and have created a userform for colleagues to input data that is then saved to a worksheet. I have save button, a new record button, and a close button. Save does what it says on the tin, new record clears the form and close closes it. All pretty straightforward. However, I would like to be able to add a function to check if the form has been saved when the 'close' has been clicked, which then gives a pop up with \"This record has not been saved, do you wish to save now or close without saving\" and two options to choose from, 'save and close' or 'close without saving'.</p>\n\n<p>Is this possible? I have searched and searched and cant find the answer! Thank you in advance. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 1, "creation_date": 1525855320, "post_id": 50248746, "comment_id": 87515318, "body": "You know, you don&#39;t have to activate the workbooks in order to insert those rows? You can turn <code>wkbk1.Activate &#47; ws2.Activate &#47; Range(&quot;A1&quot;).EntireRow.Insert</code> into just <code>ws2.Range(&quot;A1&quot;).EntireRow.Insert</code>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1525856494, "post_id": 50248746, "comment_id": 87516037, "body": "You are trying to use AutoFilter as a Range property but not specifying a range."}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "reply_to_user": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1525856682, "post_id": 50248746, "comment_id": 87516137, "body": "@jamheadart Thank you for the help. I knew that code was unnecessary and was going to change it, but thank you for a neat solution to it :)"}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1525856778, "post_id": 50248746, "comment_id": 87516218, "body": "@SJR The thing is, not every sheet has the header &quot;Status&quot; so I cant specify Range(&quot;B:B&quot;) for example."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1525857111, "post_id": 50248746, "comment_id": 87516416, "body": "So test first whether Status is found, using Find or Match."}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1525860599, "post_id": 50248746, "comment_id": 87518682, "body": "Thank you @SJR, Xabier has provided a solution with that function :)"}], "answers": [{"tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 2, "last_activity_date": 1525857083, "creation_date": 1525857083, "answer_id": 50249599, "question_id": 50248746, "link": "https://stackoverflow.com/questions/50248746/vba-apply-filter-across-multiple-sheets-if-column-header-is-a-match/50249599#50249599", "title": "VBA - Apply Filter Across Multiple Sheets if Column Header is a Match", "body": "<p>@EitelDagnin you should first use .Find to see if the header exists and then use the AutoFilter, something like:</p>\n\n<pre><code>Set StatusFound = Worksheets(w).Rows(1).Find(What:=\"Status\", LookAt:=xlWhole)\n'Above search for the Word \"Status\" on the first row of the Sheet\n\nIf NOT StatusFound is Nothing then\n'''''If Status is found then\n'''''Apply your filter\n\n    For a = .Columns.count To 1 Step -1\n        If UBound(Filter(filterCols, Worksheets(w).Cells(1, a), True, vbTextCompare)) &lt; 0 Then _\n            Worksheets(w).UsedRange.AutoFilter Field:=StatusFound.Column, Criteria1:=(\"INACTIVE\"), Operator:=xlFilterValues\n        End If\n    Next a\nEnd if\n</code></pre>\n"}], "owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 50249599, "answer_count": 1, "score": 0, "last_activity_date": 1525857083, "creation_date": 1525854342, "question_id": 50248746, "link": "https://stackoverflow.com/questions/50248746/vba-apply-filter-across-multiple-sheets-if-column-header-is-a-match", "title": "VBA - Apply Filter Across Multiple Sheets if Column Header is a Match", "body": "<p>I have a macro that renames certain headers, deletes certain columns and inserts a row on specific sheets.</p>\n\n<p>I need to apply a filter across the sheets <strong>IF</strong> the header is found on the sheet.</p>\n\n<p>The <code>with wkbk1</code> statement has 2 <code>for loops</code>, the second loop I just copied from the first one and attempted to apply the filter.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>Sub ManipulateSheets()\n\n    Dim ws1 As Worksheet, ws2 As Worksheet, ws3 As Worksheet, ws4 As Worksheet\n    Dim a As Long, w As Long\n    Dim keepCols As Variant\n    Dim wkbk1 As Workbook\n\n    Set wkbk1 = Workbooks(\"testWorkbook.xlsm\")\n\n    'Set sheets to be used in each workbook\n    Set ws2 = wkbk1.Sheets(\"mySheet\")\n    Set ws3 = wkbk1.Sheets(\"hisSheet\")\n    Set ws4 = wkbk1.Sheets(\"herSheet\")\n\n    keepCols = Array(\"Employee Number\", \"Status\")\n    filterCols = Array(\"Status\")\n\n    wkbk1.Activate\n\n    ws2.Activate\n\n    Range(\"A1\").EntireRow.Insert\n\n    Range(\"A1\").Value = \"Employee Number\"\n\n    ws3.Activate\n\n    Range(\"A1\").EntireRow.Insert\n\n    Range(\"A1\").Value = \"Employee Number\"\n\n    ws4.Activate\n\n    Range(\"A1\").EntireRow.Insert\n\n    Range(\"A1\").Value = \"Employee Number\"\n\n    For Each ws1 In wkbk1.Sheets\n\n        ws1.Cells(1, 1).EntireRow.Replace What:=\"USERID\", Replacement:=\"Employee Number\", Lookat:=xlWhole\n        ws1.Cells(1, 1).EntireRow.Replace What:=\"STATUS\", Replacement:=\"Status\", Lookat:=xlWhole\n        ws1.Cells(1, 1).EntireRow.Replace What:=\"USER_ID\", Replacement:=\"Employee Number\", Lookat:=xlWhole\n        ws1.Cells(1, 1).EntireRow.Replace What:=\"USER-ID\", Replacement:=\"Employee Number\", Lookat:=xlWhole\n        ws1.Cells(1, 1).EntireRow.Replace What:=\"USER_STATUS\", Replacement:=\"Status\", Lookat:=xlWhole\n        ws1.Cells(1, 1).EntireRow.Replace What:=\"HR_STATUS\", Replacement:=\"Status\", Lookat:=xlWhole\n\n    Next ws1\n\n    With wkbk1\n\n        For w = 1 To .Worksheets.count\n\n            With Worksheets(w)\n\n                For a = .Columns.count To 1 Step -1\n\n                    If UBound(Filter(keepCols, .Cells(1, a), True, vbTextCompare)) &lt; 0 Then _\n                            .Columns(a).EntireColumn.Delete\n\n                Next a\n\n            End With\n\n        Next w\n\n        For w = 1 To .Worksheets.count\n\n            With Worksheets(w)\n\n                For a = .Columns.count To 1 Step -1\n\n                    If UBound(Filter(filterCols, .Cells(1, a), True, vbTextCompare)) &lt; 0 Then _\n                            .AutoFilter Field:=1, Criteria1:=(\"INACTIVE\"), Operator:=xlFilterValues\n\n                Next a\n\n            End With\n\n        Next w\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Currently, when I run this code, everything works great up until this line:</p>\n\n<pre><code>.AutoFilter Field:=1, Criteria1:=(\"INACTIVE\"), Operator:=xlFilterValues\n</code></pre>\n\n<p>I get the error:</p>\n\n<blockquote>\n  <p>Named argument not found</p>\n</blockquote>\n"}, {"tags": ["mysql", "vba", "excel"], "comments": [{"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1525854172, "post_id": 50248506, "comment_id": 87514653, "body": "Have you tried to use &#39;IS NOT NULL&#39; in your query?"}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1525854531, "post_id": 50248506, "comment_id": 87514875, "body": "<a href=\"https://stackoverflow.com/questions/5285448/mysql-select-only-not-null-values\" title=\"mysql select only not null values\">stackoverflow.com/questions/5285448/&hellip;</a>"}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "reply_to_user": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1525854683, "post_id": 50248506, "comment_id": 87514958, "body": "That would only give me rows that didn&#39;t contain NULL values in any field right? I still want those rows, I just want the one or two instances of NULL to be replaced with &quot;&quot;"}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "reply_to_user": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1525855010, "post_id": 50248506, "comment_id": 87515135, "body": "Maybe I just need to not allow any NULL values in my database to begin with and default everything to an empty string..."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 1, "creation_date": 1525855233, "post_id": 50248506, "comment_id": 87515266, "body": "Why don&#39;t you check with <code>IsNull(MyRecordset.Fields(0).Value)</code> before you do <code>x = MyRecordset.Fields(0).Value</code>"}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1525855438, "post_id": 50248506, "comment_id": 87515398, "body": "Thanks! <code>IsNull</code> - I knew there was a proper check for it..."}], "answers": [{"comments": [{"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1525856265, "post_id": 50249095, "comment_id": 87515910, "body": "Thanks, I&#39;ll accept this, I have a module of converting functions of a similar ilk so I think this would fit nicely in that toolbox."}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": true, "score": 1, "last_activity_date": 1525855601, "creation_date": 1525855601, "answer_id": 50249095, "question_id": 50248506, "link": "https://stackoverflow.com/questions/50248506/vba-adodb-recordset-field-is-null-from-mysql-is-there-an-easy-way-to-check-or/50249095#50249095", "title": "VBA ADODB recordset field is Null from MySQL - is there an easy way to check or prevent &quot;NULL&quot;?", "body": "<p>Use a function like that</p>\n\n<pre><code>Option Explicit\n\nFunction rcdString(rcdField As Variant) As String\n\n    If IsNull(rcdField) Then\n        rcdString = \"\"\n    Else\n        rcdString = rcdField.Value\n    End If\n\nEnd Function\n</code></pre>\n\n<p>And</p>\n\n<pre><code>x = rcdString(MyRecordset.Fields(0))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1525867655, "post_id": 50251946, "comment_id": 87523122, "body": "Hi, thanks for the input, the <code>Nz()</code> function apparently only works in Access and I&#39;m using Excel - Helpful though, since I did a search for it and I saw a good snippet to recreate it based on <code>IIF()</code> - as for the <code>COALESCE()</code> idea, also great, I will do some speed tests using both to see which one is faster - I think the post-query processing in Excel might be quicker and put the &#39;CPU&#39; onus on the user&#39;s application rather than the server."}], "tags": [], "owner": {"reputation": 10345, "user_id": 11436, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b26e48dab1a79c105f773ecec62e6d75?s=128&d=identicon&r=PG", "display_name": "Philippe Grondier", "link": "https://stackoverflow.com/users/11436/philippe-grondier"}, "is_accepted": false, "score": 1, "last_activity_date": 1525864743, "last_edit_date": 1525864743, "creation_date": 1525864212, "answer_id": 50251946, "question_id": 50248506, "link": "https://stackoverflow.com/questions/50248506/vba-adodb-recordset-field-is-null-from-mysql-is-there-an-easy-way-to-check-or/50251946#50251946", "title": "VBA ADODB recordset field is Null from MySQL - is there an easy way to check or prevent &quot;NULL&quot;?", "body": "<p>How to do that:</p>\n\n<p><strong>1 - on the VBA side</strong></p>\n\n<p>If I am not wrong, there is already a VBA function that does the job of converting nulls to default values. In your case that would then be </p>\n\n<pre><code>Nz(MyRecordset.Fields(1).Value,\"\")\n</code></pre>\n\n<p>Returning a zero length string if the field value is null.</p>\n\n<p><strong>2 - on the MYSQL side</strong></p>\n\n<p>You could use the COALESCE function, that sneds back the first non-null value in its parameters list. Your select will then look like:</p>\n\n<pre><code>SELECT COALESCE(myFieldName,'') \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 2, "last_activity_date": 1525873323, "creation_date": 1525873323, "answer_id": 50254894, "question_id": 50248506, "link": "https://stackoverflow.com/questions/50248506/vba-adodb-recordset-field-is-null-from-mysql-is-there-an-easy-way-to-check-or/50254894#50254894", "title": "VBA ADODB recordset field is Null from MySQL - is there an easy way to check or prevent &quot;NULL&quot;?", "body": "<p>If I remember correctly, if you have a variable that might hold null, concatenating an empty string will turn the variable into an empty string, while having no affect on any other value. But that might not work with ADO recordsets</p>\n\n<pre><code> x = MyRecordset.Fields(0).Value &amp; \"\"\n</code></pre>\n"}], "owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2553, "favorite_count": 0, "accepted_answer_id": 50249095, "answer_count": 3, "score": 0, "last_activity_date": 1525873323, "creation_date": 1525853435, "last_edit_date": 1531164843, "question_id": 50248506, "link": "https://stackoverflow.com/questions/50248506/vba-adodb-recordset-field-is-null-from-mysql-is-there-an-easy-way-to-check-or", "title": "VBA ADODB recordset field is Null from MySQL - is there an easy way to check or prevent &quot;NULL&quot;?", "body": "<p>I pull a large recordset from a MySQL server and I assign a bunch of variables in an Excel VBA routine based on the field position, e.g.:</p>\n\n<pre><code>x = MyRecordset.Fields(0).Value\ny = MyRecordset.Fields(1).Value\n' etc...\n</code></pre>\n\n<p>The only time this throws an error is when one of the values is NULL, because VBA doesn't allow a string to be NULL. I have a question for both sides, VBA and the MySQL side in case the VBA side falls down:</p>\n\n<p><strong>VBA:</strong> I'm currently using <code>On Error Resume Next</code> to skip the NULL error - is there a better / more official way to achieve this? Is this error skipping slowing my code down?</p>\n\n<p><strong>MySQL:</strong> Is there a way to prevent \"NULL\" being sent, e.g. to quickly replace instances of NULL with an empty string in my <code>SELECT</code> statement?</p>\n"}, {"tags": ["c++", "vba", "libraries"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1525849962, "post_id": 50247452, "comment_id": 87512311, "body": "If you just want to make your application scriptable, there are other libraries and frameworks that are easier to use and integrate (a quick search for <code>embeddable script languages</code> or similar should give you plenty of hits). Is there a specific reason you want VBA?"}, {"owner": {"reputation": 17871, "user_id": 1171191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9e7708869e2b3234fbf0e34c9506742?s=128&d=identicon&r=PG", "display_name": "BoBTFish", "link": "https://stackoverflow.com/users/1171191/bobtfish"}, "edited": false, "score": 1, "creation_date": 1525850024, "post_id": 50247452, "comment_id": 87512346, "body": "How set are you on VBA? There are scripting languages that may be easier to embed, for example <a href=\"https://www.lua.org/\" rel=\"nofollow noreferrer\">Lua</a> is a popular choice."}, {"owner": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 0, "creation_date": 1525850027, "post_id": 50247452, "comment_id": 87512347, "body": "Worth noting that Excel now supports JavaScript scripting. That&#39;s a very, very strong hint. Besides, who will write the scripts? Who are the users? What language will they know? What kind of scripts will they create? Even for business users JavaScript is a more popular language nowadays. Other applications, use Python, another very popular language"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 0, "creation_date": 1525850351, "post_id": 50247452, "comment_id": 87512510, "body": "@PanagiotisKanavos: Although that said, I don&#39;t see financial services ever moving away from VBA, annoying as that may be."}, {"owner": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1525851780, "post_id": 50247452, "comment_id": 87513342, "body": "@Bathsheba and yet, Excel got JavaScript support. Visual Studio has R and Python in the Data Science workload. Finance doesn&#39;t write VBA macros, it forces the IT guys to write them, the intern, or they hire consultants"}], "answers": [{"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 2, "last_activity_date": 1525849816, "creation_date": 1525849816, "answer_id": 50247467, "question_id": 50247452, "link": "https://stackoverflow.com/questions/50247452/is-it-possible-to-add-vba-programming-environment-to-my-c-application/50247467#50247467", "title": "Is it possible to add VBA programming environment to my C++ application?", "body": "<p>Yes it is possible, but do regard it as being <em>extremely</em> difficult. As a starter for ten, your application will need a comprehensive Component Object Model interface. At that point, you would be able to use VBScript, so it might be wise to stop there.</p>\n\n<p>For fully-fledged embedded VBA, you'll need to negotiate a licence with Microsoft.</p>\n\n<p>Some applications (e.g. Reuters Kobra) licence the VBA interface in a similar way.</p>\n"}], "owner": {"reputation": 984, "user_id": 2315230, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/2ee66032c2c475fb9f04b75d4fdf3e6a?s=128&d=identicon&r=PG", "display_name": "Noldor130884", "link": "https://stackoverflow.com/users/2315230/noldor130884"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "closed_date": 1525864907, "answer_count": 1, "score": 3, "last_activity_date": 1525849816, "creation_date": 1525849740, "question_id": 50247452, "link": "https://stackoverflow.com/questions/50247452/is-it-possible-to-add-vba-programming-environment-to-my-c-application", "closed_reason": "Not suitable for this site", "title": "Is it possible to add VBA programming environment to my C++ application?", "body": "<p>I have an application that is written in C++ and would like to offer the user the possibility to have a VBA-programming interface (not dissimilar from the one in Excel). Is there the possibility to do that? Does a set of libraries exists for this? Is it very difficult to do?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 101, "user_id": 8946456, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f8a702ef9803d27250d7d35b28d766ba?s=128&d=identicon&r=PG&f=1", "display_name": "K. Robert", "link": "https://stackoverflow.com/users/8946456/k-robert"}, "edited": false, "score": 0, "creation_date": 1525850334, "post_id": 50247313, "comment_id": 87512498, "body": "Made a change to the original post as I&#39;ve recognized some errors myself but it&#39;s still not working."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 4, "creation_date": 1525850712, "post_id": 50247313, "comment_id": 87512705, "body": "I recommend to use <code>Option Explicit</code> in <b>every</b> module/userform etc. And define your public variable in a Module not in userform1 otherwise it is public but only in userform1."}, {"owner": {"reputation": 101, "user_id": 8946456, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f8a702ef9803d27250d7d35b28d766ba?s=128&d=identicon&r=PG&f=1", "display_name": "K. Robert", "link": "https://stackoverflow.com/users/8946456/k-robert"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1525851134, "post_id": 50247313, "comment_id": 87512958, "body": "That makes a lot more sense. Thanks for the help, I will test it and let you know if it worked so you can post it as an answer."}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1525852908, "post_id": 50247313, "comment_id": 87513988, "body": "Like what @P\u1d07\u029c said, you cannot access a variable declared on one UserForm Module in another UserForm Module. All you need is to declare that variable as a <code>Public Varaible</code> on a <code>Standard Module</code> like <code>Module1</code> etc. Then you can initialize that public variable in one UserForm Module and access it&#39;s value in another UserForm Module."}, {"owner": {"reputation": 101, "user_id": 8946456, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f8a702ef9803d27250d7d35b28d766ba?s=128&d=identicon&r=PG&f=1", "display_name": "K. Robert", "link": "https://stackoverflow.com/users/8946456/k-robert"}, "edited": false, "score": 0, "creation_date": 1525854004, "post_id": 50247313, "comment_id": 87514557, "body": "Thanks, it does work now (well... that bit...), can you post it as an answer so I can mark it as accepted?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1525855101, "post_id": 50247313, "comment_id": 87515188, "body": "@K.Robert posted it as an answer."}], "answers": [{"tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": -1, "last_activity_date": 1525851914, "creation_date": 1525851914, "answer_id": 50248095, "question_id": 50247313, "link": "https://stackoverflow.com/questions/50247313/how-to-use-public-range-value-in-multiple-user-forms/50248095#50248095", "title": "How to use Public Range value in multiple user forms?", "body": "<p>Add a property in your first form:</p>\n\n<pre><code>Property Get FillRange() As Range\n    Set FillRange = Range(\"A1\")\nEnd Property\n</code></pre>\n\n<p>And read it from your second form:</p>\n\n<pre><code>Dim FillRange\nSet FillRange = UserForm1.FillRange\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1525855071, "creation_date": 1525855071, "answer_id": 50248947, "question_id": 50247313, "link": "https://stackoverflow.com/questions/50247313/how-to-use-public-range-value-in-multiple-user-forms/50248947#50248947", "title": "How to use Public Range value in multiple user forms?", "body": "<p>If you make use of <code>Option Explicit</code> in every module/userform etc. This forces you to declare all variables properly and shows a message if a variable is not declared.</p>\n\n<p>The issue is that if you declare <code>Public FillRange As Range</code> in Userform1 the variable is only valid in Userform1 but not in Userform2.</p>\n\n<p>So I recommend to decare the variable in a Module instead of Userform1. This way it is accessible everywhere. </p>\n\n<p><strong>Alternative</strong><br>\nYou can access a public Userform1 variable in Userfrom2 by <code>Userform1.FillRange</code></p>\n"}], "owner": {"reputation": 101, "user_id": 8946456, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f8a702ef9803d27250d7d35b28d766ba?s=128&d=identicon&r=PG&f=1", "display_name": "K. Robert", "link": "https://stackoverflow.com/users/8946456/k-robert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 50248947, "answer_count": 2, "score": 0, "last_activity_date": 1525855071, "creation_date": 1525849276, "last_edit_date": 1525850298, "question_id": 50247313, "link": "https://stackoverflow.com/questions/50247313/how-to-use-public-range-value-in-multiple-user-forms", "title": "How to use Public Range value in multiple user forms?", "body": "<p>I have a userform which will ask for a number that is then getting looked up in a spreadsheet, saving that range in a variable. When it's found the number, it will hide the first userform and bring up the second one, but in order for me to proceed with the update, I will need to use the same range that I've previously set against my variable in userform1, any idea how to do that? I have declared it as a Public variable but it still doesn't work. Code as it follows:</p>\n\n<p>UserForm1:</p>\n\n<pre><code>Public FillRange As Range\nPublic BKref As Variant\n\n\nPrivate Sub CommandButton1_Click()\n\nOn Error GoTo errhndlr:\n    Set FillRange = Sheets(\"Loader\").Cells.Find(TextRef.Value).Offset(0, 2)\n\nBKref = TextRef.Value\n\nIf Not FillRange = \"\" Then\n    UserForm1.Hide\n    UserForm2.Show\n    Exit Sub\nElseIf FillRange = \"\" Then\n    MsgBox \"Booking Reference cannot be empty!\", vbCritical, \"Error: No Booking Ref.\"\n    UserForm1.Hide\n    Exit Sub\nElse\n    MsgBox \"Unexpected error, please re-start and try again. If you had this message more than 2 times, please update the line manually.\", vbCritical, \"Error\"\n    UserForm1.Hide\n    Exit Sub\nEnd If\n\nExit Sub\n\nerrhndlr:\nMsgBox \"Booking reference not found, please double-check that the booking reference you've entered is correct, alternatively update it manually.\", vbCritical, \"Error\"\nUserFrom1.Hide\n\nEnd Sub\n</code></pre>\n\n<p>UserForm2: </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nFillRange = TextPloaded.Value\nFillRange.Offset(0, 2) = TextTime.Value\nFillRange.Offset(0, 3) = TextLoader.Value\n\nIf Not TextComm.Value = \"\" Then\n    FillRange.Offset(0, 4) = TextComm.Value\nElseIf TextComm.Value = \"\" Then\n    FillRange.Offset(0, 4) = \"\"\nEnd If\n\nIf Not FillRange = FillRange(0, -1) Then\n    MsgBox \"Actual and Planned pallets doesn't match, please highlight the diescrepancies on the assembly sheet!\"\n    BKref = FillRange.Offset(0, -2)\n    Sheets(\"Assembly\").Activate\n    Sheets(\"Assembly\").Rows(1).AutoFilter Field:=16, Criteria1:=BKref\n    UserForm2.Hide\nElse\n    UserForm2.Hide\n    UserForm1.Show\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 83, "user_id": 8585970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22f697fdac54ab148b296b5fb7e62ed5?s=128&d=identicon&r=PG&f=1", "display_name": "Oskar", "link": "https://stackoverflow.com/users/8585970/oskar"}, "edited": false, "score": 0, "creation_date": 1525849953, "post_id": 50247228, "comment_id": 87512307, "body": "Doesn&#39;t something like this: <code>Selection.Offset(1 - Selection.Row).Select</code> fix it?"}, {"owner": {"reputation": 35, "user_id": 3424554, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c86282c66853d0155119a7048f51cde3?s=128&d=identicon&r=PG&f=1", "display_name": "user3424554", "link": "https://stackoverflow.com/users/3424554/user3424554"}, "reply_to_user": {"reputation": 83, "user_id": 8585970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22f697fdac54ab148b296b5fb7e62ed5?s=128&d=identicon&r=PG&f=1", "display_name": "Oskar", "link": "https://stackoverflow.com/users/8585970/oskar"}, "edited": false, "score": 0, "creation_date": 1525893463, "post_id": 50247228, "comment_id": 87539138, "body": "sigh... where were you when I started...i might have some hairs left :D haha thank you!! That worked great!!"}], "answers": [{"comments": [{"owner": {"reputation": 168, "user_id": 9364326, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216080483105051/picture?type=large", "display_name": "Aaron Pan Vega", "link": "https://stackoverflow.com/users/9364326/aaron-pan-vega"}, "edited": false, "score": 0, "creation_date": 1525850032, "post_id": 50247459, "comment_id": 87512349, "body": "In other way, the column normaly have a name in top, you can search this name and get this position an select the row below."}, {"owner": {"reputation": 35, "user_id": 3424554, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c86282c66853d0155119a7048f51cde3?s=128&d=identicon&r=PG&f=1", "display_name": "user3424554", "link": "https://stackoverflow.com/users/3424554/user3424554"}, "edited": false, "score": 1, "creation_date": 1525893647, "post_id": 50247459, "comment_id": 87539218, "body": "Thanks for offering your help! I tried the function given in the first comment and it worked perfectly. But thanks for your advice here! Had that not worked I might have tried this, and perhaps your answer here will help someone else down the road. Thanks!"}], "tags": [], "owner": {"reputation": 168, "user_id": 9364326, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216080483105051/picture?type=large", "display_name": "Aaron Pan Vega", "link": "https://stackoverflow.com/users/9364326/aaron-pan-vega"}, "is_accepted": false, "score": 0, "last_activity_date": 1525850264, "last_edit_date": 1525850264, "creation_date": 1525849769, "answer_id": 50247459, "question_id": 50247228, "link": "https://stackoverflow.com/questions/50247228/excel-vba-how-to-select-the-top-row-absolute-of-whichever-column-relative/50247459#50247459", "title": "Excel / VBA - How to select the top row (absolute) of whichever column (relative) the currently selected cell is in?", "body": "<p>For do it faster you can optimize like this:</p>\n\n<pre><code>Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n\nDo Until Selection.Row = 1\n    If Selection.Row &lt;&gt; 1 Then\n        Selection.Offset(-1, 0).Select\n    End If\nLoop\n\n\nApplication.ScreenUpdating = True\n    Application.Calculation = xlAutomatic\n</code></pre>\n\n<p>One question, you can not use Cells(x,y).row instead of Selection metod ? This is a faster way.</p>\n\n<p>In other way, the column normaly have a name in top, you can search this name and get this position an select the row below.\nSomething like this:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n\nDim intColumn As Integer\nintColumn = ObtainColumn(Range(\"A1:F1\"), \"NameColum\")\nintRow = ObtainRow(Range(\"A1:A10\"), \"NameColum\")\nCells(intRow, intColumn).Select\n\nEnd Sub\n\n\nFunction ObtainColumn(rng As Range, strValue As String) As Long\nDim lCol As Long\n'Set rng = ActiveSheet.Cells\nOn Error Resume Next\nlCol = 0\nlCol = rng.Find(What:=strValue, _\n                        After:=rng.Cells(1), _\n                        LookAt:=xlWhole, _\n                        LookIn:=xlFormulas, _\n                        SearchOrder:=xlByColumns, _\n                        SearchDirection:=xlPrevious, _\n                        MatchCase:=False).Column\n    ObtainColumn = lCol\nOn Error GoTo 0\nEnd Function\n\nFunction ObtainRow(rng As Range, strValue As String) As Long\nDim lRow As Long\n'Set rng = ActiveSheet.Cells\nlRow = 0\n    On Error Resume Next\n    lRow = rng.Find(What:=strValue, _\n                       After:=rng.Cells(1), _\n                       LookAt:=xlWhole, _\n                       LookIn:=xlFormulas, _\n                       SearchOrder:=xlByRows, _\n                       SearchDirection:=xlPrevious, _\n                       MatchCase:=False).Row\n    ObtainRow = lRow\n    On Error GoTo 0\nOn Error GoTo 0\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 3424554, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c86282c66853d0155119a7048f51cde3?s=128&d=identicon&r=PG&f=1", "display_name": "user3424554", "link": "https://stackoverflow.com/users/3424554/user3424554"}, "edited": false, "score": 0, "creation_date": 1525893558, "post_id": 50248751, "comment_id": 87539182, "body": "thank you! this worked! you know it is almost impossible to find more data on this particular function online. hopefully this helps someone!! Thank you!! :)"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 1, "last_activity_date": 1525900117, "last_edit_date": 1525900117, "creation_date": 1525854366, "answer_id": 50248751, "question_id": 50247228, "link": "https://stackoverflow.com/questions/50247228/excel-vba-how-to-select-the-top-row-absolute-of-whichever-column-relative/50248751#50248751", "title": "Excel / VBA - How to select the top row (absolute) of whichever column (relative) the currently selected cell is in?", "body": "<p>There is no need to iterate to find the top of the current column:</p>\n\n<pre><code>Selection.End(xlUp).Activate\n</code></pre>\n\n<p>The <code>.End(xlUp)</code> member of a <code>Range</code> finds the end of the <em>contiguous</em> data set. <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-end-property-excel\" rel=\"nofollow noreferrer\">More info here</a>.</p>\n\n<p>or</p>\n\n<pre><code>Cells(1, Selection.Column).Activate\n</code></pre>\n\n<p>This method uses the <code>Column</code> member of a <code>Range</code> to return the <em>number</em> of that column, then uses the <code>Cells</code> function to call the first row of that column. <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheet-cells-property-excel\" rel=\"nofollow noreferrer\">More info here</a>.</p>\n\n<p>or (as mentioned)</p>\n\n<pre><code>Selection.Offset(1 - Selection.Row).Select\n</code></pre>\n\n<p>This method uses the <code>Offset</code> member of a <code>Range</code>. This function (<a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-offset-property-excel\" rel=\"nofollow noreferrer\">more info here</a>) has two optional parameters. The first is <code>RowOffset</code>, so this formula will offset a cell in A21 by -20 rows, thus giving A1.</p>\n\n<p><em>Edited for more information and references</em></p>\n"}], "owner": {"reputation": 35, "user_id": 3424554, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c86282c66853d0155119a7048f51cde3?s=128&d=identicon&r=PG&f=1", "display_name": "user3424554", "link": "https://stackoverflow.com/users/3424554/user3424554"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3410, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1525900117, "creation_date": 1525848943, "question_id": 50247228, "link": "https://stackoverflow.com/questions/50247228/excel-vba-how-to-select-the-top-row-absolute-of-whichever-column-relative", "title": "Excel / VBA - How to select the top row (absolute) of whichever column (relative) the currently selected cell is in?", "body": "<p>I spent 11 hours a few days ago ripping my brain apart to do this. Everyone either answers using sample ranges with absolute values, or with the entirely relative .offset function. Or they mention it's not good to select in vba, or they provide a workaround of some sort that I can't adapt, or .select doesn't work with R1C1...etc, etc. My script is done now, and fully functioning with the following loop code, but it's SLOW because it uses this loop about 2000-3000 times each time the macro runs:</p>\n\n<pre><code>Do Until Selection.Row = 1\n    If Selection.Row &lt;&gt; 1 Then\n        Selection.Offset(-1, 0).Select\n    End If\nLoop\n</code></pre>\n\n<p>I just want to know, for whichever cell is currently selected, wherever it is, is there a faster way in vba to .Select the top row (row #1, absolute reference) of that (any) column (relative reference)?</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1525905470, "post_id": 50248920, "comment_id": 87544122, "body": "You don&#39;t even need a macro for this - it can be done for all dates via a single <i>wildcard</i> Find/Replace without the need to select anything..."}], "tags": [], "owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "is_accepted": true, "score": 1, "last_activity_date": 1525854980, "creation_date": 1525854980, "answer_id": 50248920, "question_id": 50247079, "link": "https://stackoverflow.com/questions/50247079/convert-date-mm-dd-yyyy-to-mm-dd-yyyy-word-vba/50248920#50248920", "title": "convert date mm/dd/yyyy to mm.dd.yyyy word vba", "body": "<p>This snippet will insert the date in the desired format to the cursor position and inserts a trailing space, too. </p>\n\n<pre><code>Dim d As String\n\nd = \"7/25/2011\"\nWith Selection\n    .Font.Underline = wdNone            ' next text will not be underlined\n    .TypeText \" \"                       ' or any separator that will follow the date\n    .Collapse                           ' remove selection\n    .Start = .Start - 1                 ' set cursor before the separator\n    .Collapse                           ' remove selection\n    .Font.Underline = wdUnderlineSingle ' next text will be underlined\n    .TypeText Format(d, \"dd.mm.yyyy\")\n    .Collapse                ' remove selection and leave the cursor right after the date\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 5866783, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b84666cb4d9b38d8a9aa79f2bde7d659?s=128&d=identicon&r=PG&f=1", "display_name": "rakesh  seebaruth", "link": "https://stackoverflow.com/users/5866783/rakesh-seebaruth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 450, "favorite_count": 0, "closed_date": 1525864951, "accepted_answer_id": 50248920, "answer_count": 1, "score": -1, "last_activity_date": 1525860690, "creation_date": 1525848346, "last_edit_date": 1525860690, "question_id": 50247079, "link": "https://stackoverflow.com/questions/50247079/convert-date-mm-dd-yyyy-to-mm-dd-yyyy-word-vba", "closed_reason": "Needs more focus", "title": "convert date mm/dd/yyyy to mm.dd.yyyy word vba", "body": "<p>I have  the  following dates</p>\n\n<p>2/12/2018\n2/13/2018\n2/14/2018</p>\n\n<p>I need to convert the above dates into 12.2.2018,13.2.2018,14.2.2018  and these dates  should be  underline.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 2, "creation_date": 1525845413, "post_id": 50246330, "comment_id": 87510212, "body": "Is MyObject_Obj a custom type you created? Where is its declaration?"}, {"owner": {"reputation": 152, "user_id": 2135330, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c0ac4dfff22379827329f17f88c3dec3?s=128&d=identicon&r=PG", "display_name": "Pclaverie", "link": "https://stackoverflow.com/users/2135330/pclaverie"}, "reply_to_user": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1525846600, "post_id": 50246330, "comment_id": 87510701, "body": "It is an object coming from my References. I actually simplified quite much on purpose here. My point is to know if I can use function(with parameters) to return an array of custom object."}, {"owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1525847247, "post_id": 50246330, "comment_id": 87511008, "body": "Show the type declaration or there&#39;s no way to answer your question. &quot;coming from references&quot; is not the right answer."}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 2, "creation_date": 1525846571, "post_id": 50246518, "comment_id": 87510687, "body": "A line like?  As per @ThomasG&#39;s comment - where is the code governing the custom type you have created (MyObject_Obj). You are treating it as an array so you can&#39;t use the Set keyword. You declare things in the same way Dim x As <b><i>type</i></b>"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1525845960, "creation_date": 1525845960, "answer_id": 50246518, "question_id": 50246330, "link": "https://stackoverflow.com/questions/50246330/using-array-returning-function-in-vba/50246518#50246518", "title": "Using Array returning function in VBA", "body": "<p>Ignoring the rest, you can't do</p>\n\n<pre><code>Set my_legs = legbuilder(param1, param2)\n</code></pre>\n\n<p>Set is for objects. Your \"custom\" <code>legbuilder</code> is essentially returning an array ,so drop the <code>Set</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": true, "score": 1, "last_activity_date": 1525873621, "creation_date": 1525873621, "answer_id": 50255016, "question_id": 50246330, "link": "https://stackoverflow.com/questions/50246330/using-array-returning-function-in-vba/50255016#50255016", "title": "Using Array returning function in VBA", "body": "<pre><code>Public Function ReturnArray(param1,param2) as variant\nDim A(4) as variant\nA(0) = \"One\"\nA(1) = \"Two\"\nA(2)= \"Three\"\nA(3) = \"Four\"\nReturnArray = A()\nEnd Function\n\nSub test()\n MsgBox ReturnArray(\"A\", \"B\")(2)\n\n End Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": false, "score": 0, "last_activity_date": 1525881210, "creation_date": 1525881210, "answer_id": 50257479, "question_id": 50246330, "link": "https://stackoverflow.com/questions/50246330/using-array-returning-function-in-vba/50257479#50257479", "title": "Using Array returning function in VBA", "body": "<pre><code>private Function legbuilder (...) As MyObject_Obj()\n</code></pre>\n"}], "owner": {"reputation": 152, "user_id": 2135330, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c0ac4dfff22379827329f17f88c3dec3?s=128&d=identicon&r=PG", "display_name": "Pclaverie", "link": "https://stackoverflow.com/users/2135330/pclaverie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 50255016, "answer_count": 3, "score": 1, "last_activity_date": 1525881210, "creation_date": 1525844988, "last_edit_date": 1531164843, "question_id": 50246330, "link": "https://stackoverflow.com/questions/50246330/using-array-returning-function-in-vba", "title": "Using Array returning function in VBA", "body": "<p>I am trying to define an array of object from a function but I always get the Compile error <code>Can't assign to array</code>.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Dim param1 As String\nDim param2 As String\nDim my_legs(1 To 4) As MyObject_Obj\n\nSet my_legs = legBuilder(param1,param2)\n\n\nprivate Function legbuilder (ByVal param1 As String,ByVal param2 As String)As MyObject_Obj\n\nDim my_legs(1 To 4) As MyObject_Obj\n\n---Filling my Array---\n\nlegBuilder = my_legs\n\nEnd Function\n</code></pre>\n\n<p>It seems that my function is, by design not returning the expected type (an Array of <code>MyObject_Obj</code>)</p>\n\n<p>Am I doing it wrong?</p>\n"}, {"tags": ["excel", "vba", "vlookup"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1525843510, "post_id": 50245911, "comment_id": 87509492, "body": "Side note: Safer to use Application.WorksheetFunction"}], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 9762654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2460956a0ef3539fa45a65ce6018d234?s=128&d=identicon&r=PG&f=1", "display_name": "MrMonk", "link": "https://stackoverflow.com/users/9762654/mrmonk"}, "is_accepted": false, "score": 0, "last_activity_date": 1525850856, "last_edit_date": 1525850856, "creation_date": 1525846767, "answer_id": 50246698, "question_id": 50245911, "link": "https://stackoverflow.com/questions/50245911/macro-vlookup-multiple-condition-type-mismatch-error/50246698#50246698", "title": "Macro Vlookup Multiple condition Type Mismatch error", "body": "<p>error is caused by this line:</p>\n\n<pre><code>.Cells(rw, 11) = Application.VLookup(.Cells(rw, 11).Value + .Cells(rw, 1).Value, x, 2, False)\n</code></pre>\n\n<p>My guess is that problem is in Arg1 - summation <code>.Cells(rw, 11).Value + .Cells(rw, 1).Value</code> cannot be performed correctly. I don't know if you want to add text values (e.g. \"a\"+\"a\") or numerical values (1+1). But if you add text and number (1 + \"a\") it will return error</p>\n\n<p>Also you return result of Vlookup into column used in summation.</p>\n"}], "owner": {"reputation": 93, "user_id": 4742807, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b9f533d43d09c8dffe7f38ee7bf6c5df?s=128&d=identicon&r=PG&f=1", "display_name": "Aanshi", "link": "https://stackoverflow.com/users/4742807/aanshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525850856, "creation_date": 1525842672, "question_id": 50245911, "link": "https://stackoverflow.com/questions/50245911/macro-vlookup-multiple-condition-type-mismatch-error", "title": "Macro Vlookup Multiple condition Type Mismatch error", "body": "<p>I am working on a Excel VBA Macro that gets the id of a response from another sheet.</p>\n\n<p>I am getting Error 13 \"Type Mismatch\" from the VLookup:</p>\n\n<pre><code>    Dim i As Integer\n    Dim LastRow As Integer\n    Dim LastColumn As Integer\n    Dim rw As Long, x As Range, x1 As Range\n    Dim extwbk As Workbook, twb As Workbook\n\n\n    Sub Job_Res()\n    LastRow = Worksheets(\"Sheet1\").Cells(Rows.Count, 1).End(xlUp).Row\n\n    '----------SET RES ID-----------------------------\n    Set twb = Workbooks.Open(\"C:\\DM\\excel_files\\jobs.xlsx\")\n    Set extwbk = Workbooks.Open(\"C:\\DM\\excel_files\\RefRes.xlsx\")\n    Set x = extwbk.Worksheets(\"Sheet1\").Range(\"A:D\")\n\n    With twb.Sheets(\"Sheet1\")\n        MsgBox \"OK\"\n        For rw = 2 To .Cells(Rows.Count, 1).End(xlUp).Row\n            .Cells(rw, 11) = Application.VLookup(.Cells(rw, 11).Value + .Cells(rw, 1).Value, x, 2, False)\n        Next rw\n\n    End With\n\n    extwbk.Close savechanges:=False\n\n    End Sub\n</code></pre>\n\n<p>Any help appreciated!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 0, "last_activity_date": 1525841830, "creation_date": 1525841830, "answer_id": 50245773, "question_id": 50245638, "link": "https://stackoverflow.com/questions/50245638/change-current-row-color-with-macro/50245773#50245773", "title": "Change current row color with macro", "body": "<p>If your Form Control CommandButtons are properly aligned with Rows, place the following two macros on a Standard Module like Module1.</p>\n\n<pre><code>Sub RED(iRow As Long)\nWith Rows(iRow).Interior\n    .Pattern = xlSolid\n    .PatternColorIndex = xlAutomatic\n    .Color = 10066431\n    .TintAndShade = 0\n    .PatternTintAndShade = 0\nEnd With\nEnd Sub\n\nSub ColorRow()\nDim r As Long\nDim shp As Shape\nSet shp = ActiveSheet.Shapes(Application.Caller)\nr = shp.TopLeftCell.Row\nCall RED(r)\nEnd Sub\n</code></pre>\n\n<p>Now assign the macro ColorRow to all the CommnadButtons. So when you click a CommandButton the code will color the row which the CommandButton is aligned to.</p>\n"}], "owner": {"reputation": 3, "user_id": 9762448, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Kevin Kzo", "link": "https://stackoverflow.com/users/9762448/kevin-kzo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 50245773, "answer_count": 1, "score": 0, "last_activity_date": 1525854834, "creation_date": 1525840832, "last_edit_date": 1525854834, "question_id": 50245638, "link": "https://stackoverflow.com/questions/50245638/change-current-row-color-with-macro", "title": "Change current row color with macro", "body": "<p>I'm trying to use a form control button in excel to change the color of that entire row and be able to duplicate that button on following rows but only have the button action affect the row corresponding to said button. Current Macro is:</p>\n\n<pre><code>    Sub RED()\n    Rows(\"3:3\").Select\n    With Selection.Interior\n    .Pattern = xlSolid\n    .PatternColorIndex = xlAutomatic\n    .Color = 10066431\n    .TintAndShade = 0\n    .PatternTintAndShade = 0\n    End With\n    End Sub\n</code></pre>\n\n<p>This works fine for the first button, but when I try to duplicate (pull down more buttons) they all only affect the row stated in the original code (3:3) I can't figure out a way, if there is one, to select current row as opposed to the defined row 3.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 96, "user_id": 5535343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac5beca5b86579dd3f90a5e5f07f6c77?s=128&d=identicon&r=PG&f=1", "display_name": "K&#252;rsat Aydinli", "link": "https://stackoverflow.com/users/5535343/k%c3%bcrsat-aydinli"}, "is_accepted": false, "score": 0, "last_activity_date": 1525841856, "creation_date": 1525841856, "answer_id": 50245776, "question_id": 50245184, "link": "https://stackoverflow.com/questions/50245184/insert-the-content-from-worksheet-adding-some-more-text-into-another-worksheet-u/50245776#50245776", "title": "Insert the content from worksheet adding some more text into another worksheet using VBA", "body": "<p>To copy some data with a specified range, you can just use following command in your module:</p>\n\n<pre><code>Sub copyData()\nSheets(\"Sheet1\").Range(\"C1:D7\").Copy Destination:=Sheets(\"Sheet2\").Range(\"C3\")\nEnd Sub\n</code></pre>\n\n<p>Also take a look at this site: <a href=\"https://analysistabs.com/excel-vba/copy-data-from-one-worksheet-to-another/\" rel=\"nofollow noreferrer\">https://analysistabs.com/excel-vba/copy-data-from-one-worksheet-to-another/</a></p>\n"}], "owner": {"reputation": 1, "user_id": 9720251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1fa315eb17e36dd323038a820d97d21?s=128&d=identicon&r=PG&f=1", "display_name": "Danny", "link": "https://stackoverflow.com/users/9720251/danny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 19, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525841856, "creation_date": 1525837230, "last_edit_date": 1531164843, "question_id": 50245184, "link": "https://stackoverflow.com/questions/50245184/insert-the-content-from-worksheet-adding-some-more-text-into-another-worksheet-u", "title": "Insert the content from worksheet adding some more text into another worksheet using VBA", "body": "<p>I am new to this VBA and got need help on how to fulfill my requirement. I have a excel sheet where i get the input from users using a userform. The data is stored on a sheet2. I need to use the contents of this sheet to create some text and then insert the newly created data into another sheet3 on specified cells.</p>\n\n<p>For example, I have Fruit name and Fruit type on columns D2:E6 which i need to add to another sheet3 on cell C3</p>\n\n<p>Contents from <strong>Sheet2</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/3VDFX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3VDFX.png\" alt=\"enter image description here\"></a></p>\n\n<p>Content to be added on <strong>Sheet3</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/xWzfh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xWzfh.png\" alt=\"enter image description here\"></a></p>\n\n<p>Please help with this.</p>\n"}, {"tags": ["regex", "excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 117184, "user_id": 9473764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aGMXl.jpg?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/9473764/nick"}, "reply_to_user": {"reputation": 1722, "user_id": 563231, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/2rzat.jpg?s=128&g=1", "display_name": "David Metcalfe", "link": "https://stackoverflow.com/users/563231/david-metcalfe"}, "edited": false, "score": 0, "creation_date": 1525834522, "post_id": 50244843, "comment_id": 87507204, "body": "See my edit. That is where the space is coming from."}, {"owner": {"reputation": 117184, "user_id": 9473764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aGMXl.jpg?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/9473764/nick"}, "reply_to_user": {"reputation": 1722, "user_id": 563231, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/2rzat.jpg?s=128&g=1", "display_name": "David Metcalfe", "link": "https://stackoverflow.com/users/563231/david-metcalfe"}, "edited": false, "score": 0, "creation_date": 1525834877, "post_id": 50244843, "comment_id": 87507276, "body": "See my revised edit. I&#39;m assuming your desired output is 1:05 PM"}, {"owner": {"reputation": 1722, "user_id": 563231, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/2rzat.jpg?s=128&g=1", "display_name": "David Metcalfe", "link": "https://stackoverflow.com/users/563231/david-metcalfe"}, "edited": false, "score": 0, "creation_date": 1525835113, "post_id": 50244843, "comment_id": 87507339, "body": "Yep, that one did it. Thanks!"}], "tags": [], "owner": {"reputation": 117184, "user_id": 9473764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aGMXl.jpg?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/9473764/nick"}, "is_accepted": true, "score": 1, "last_activity_date": 1525834796, "last_edit_date": 1525834796, "creation_date": 1525834318, "answer_id": 50244843, "question_id": 50244778, "link": "https://stackoverflow.com/questions/50244778/excel-vba-regex-replace-loses-one-character/50244843#50244843", "title": "Excel VBA Regex replace loses one character", "body": "<p>It's because you have an un-captured \\d in your regex. Try putting () around the <code>\\d</code> i.e. <code>(\\d)(AM|PM)</code>.</p>\n\n<p>You also need to change strReplace to <code>\"$1 $2\"</code></p>\n"}], "owner": {"reputation": 1722, "user_id": 563231, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/2rzat.jpg?s=128&g=1", "display_name": "David Metcalfe", "link": "https://stackoverflow.com/users/563231/david-metcalfe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 50244843, "answer_count": 1, "score": 0, "last_activity_date": 1525834796, "creation_date": 1525833782, "last_edit_date": 1531164843, "question_id": 50244778, "link": "https://stackoverflow.com/questions/50244778/excel-vba-regex-replace-loses-one-character", "title": "Excel VBA Regex replace loses one character", "body": "<p>The below code matches and replaces, but the digit next to the capture group is consumed. Where am I going wrong?</p>\n\n<pre><code>Sub test()\n    Dim regex As Object 'Regexp object.\n    Set regex = CreateObject(\"VBScript.RegExp\") 'Regexp object.\n    Dim strPattern As String: strPattern = \"\\d(AM|PM)\" 'Declare regex pattern.\n    Dim strReplace As String 'Placeholder string for replace operation.\n    Dim target As String\n\n    target = \"1:05PM\"\n\n    strReplace = \" $1\"\n\n    With regex\n        .Global = True\n        .IgnoreCase = False\n        .Pattern = strPattern\n    End With\n\n    If regex.test(target) Then\n        Debug.Print regex.Replace(target, strReplace)\n    End If\nEnd Sub\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>1:0 PM\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 1, "creation_date": 1525833779, "post_id": 50244718, "comment_id": 87507035, "body": "We can&#39;t help you without seeing the code that&#39;s running slowly. Though I&#39;d make an educated guess that it&#39;s doing something that triggers Excel to perform an entire workbook recalculation or invalidating something displayed on-screen. Does it run as slowly on Excel 2010? (Office 2010 was the last version to use faster 2D painting)"}, {"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1525833813, "post_id": 50244718, "comment_id": 87507044, "body": "Also, you could rewrite the code in C# or even C++ using the Office COM Automation APIs (VSTO) if it turns out the bottleneck is in the VBA code itself rather than inside Excel."}, {"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1525833866, "post_id": 50244718, "comment_id": 87507054, "body": "Finally, have you profiled your code (e.g. using <code>GetTickCount</code>) to determine exactly what&#39;s going on? And have you eliminated any algorithmic or design issues (e.g. algorithms with <code>O(n^2)</code> time complexity?)"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1525833892, "post_id": 50244718, "comment_id": 87507059, "body": "Maybe &quot;purging memory&quot;, as in <a href=\"https://stackoverflow.com/a/33828800/4717755\">this answer</a>"}, {"owner": {"reputation": 1, "user_id": 9762048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92832ec361d03162a15ee74aea8eb0ac?s=128&d=identicon&r=PG&f=1", "display_name": "BlueStallion", "link": "https://stackoverflow.com/users/9762048/bluestallion"}, "edited": false, "score": 0, "creation_date": 1525834209, "post_id": 50244718, "comment_id": 87507126, "body": "Thanks for the quick response.  The part about the workbook recalc sounds interesting, and I&#39;ll look at the purging memory.  I&#39;m not doing any serious math. It&#39;s primarily reformatting data into different views.  So it is sorting, and then deleting lots of lines, and it deletes some columns.  I&#39;ve read that these can be slow processes, but it doesn&#39;t make sense that it would be 11 hours difference."}, {"owner": {"reputation": 1, "user_id": 9762048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92832ec361d03162a15ee74aea8eb0ac?s=128&d=identicon&r=PG&f=1", "display_name": "BlueStallion", "link": "https://stackoverflow.com/users/9762048/bluestallion"}, "edited": false, "score": 0, "creation_date": 1525834515, "post_id": 50244718, "comment_id": 87507203, "body": "I just looked at the purging memory answer.  I had seen that one before and am saving the file periodically.  It was one of my earlier optimizations, and it does help."}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1525835511, "post_id": 50244718, "comment_id": 87507406, "body": "The short answer is: use the correct tool for the job. If this tool is just formatting data into reports, use a tool that can do that faster."}, {"owner": {"reputation": 4740, "user_id": 1148564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eQICm.jpg?s=128&g=1", "display_name": "Joseph", "link": "https://stackoverflow.com/users/1148564/joseph"}, "edited": false, "score": 0, "creation_date": 1525839299, "post_id": 50244718, "comment_id": 87508281, "body": "There are lots of ways to make VBA run faster: turn off screen updating, turn off events, turn off sheet calculation, don&#39;t use <code>.Select</code>, use autofilter rather than loops if you can, etc. Can you please provide the code that is running slowly since you narrowed it down?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1525872814, "post_id": 50244718, "comment_id": 87526867, "body": "You have a lot of reading from and writing to individual cells. One way to speed up VBA is to read and write data in arrays. Build up a VBA array and write it to a range in a single line of code rather than looping through a range, writing values one by one. The code is a bit much to look at in detail. You might consider using <a href=\"https://codereview.stackexchange.com\">Code Review</a> rather than Stack Overflow."}, {"owner": {"reputation": 1, "user_id": 9762048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92832ec361d03162a15ee74aea8eb0ac?s=128&d=identicon&r=PG&f=1", "display_name": "BlueStallion", "link": "https://stackoverflow.com/users/9762048/bluestallion"}, "edited": false, "score": 0, "creation_date": 1525894139, "post_id": 50244718, "comment_id": 87539479, "body": "Thanks for all the suggestions Joseph.  I have done most of those except turning off autocalculation.  I have just added that to the module and will test it tonight.  From running some tests on weekly data it did bring down the times, but the big test will be against the monthly data.  I&#39;ll post my results once it&#39;s done."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1526042211, "post_id": 50244718, "comment_id": 87601184, "body": "Definitely one for <a href=\"https://codereview.stackexchange.com/\">Code Review</a>  rather than here.  Going with the comment from @JohnColeman - you could significantly reduce the time by not reading/writing to the sheet so much.  Why can&#39;t we select Code Review in: &quot;This question belongs on another site in the Stack Exchange network&quot; when voting to close?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1526043096, "post_id": 50244718, "comment_id": 87601721, "body": "Also declare all your variables (Option Explicit at the top!) - <code>up_curline</code>, <code>up_IS</code>, <code>myPath</code>, <code>Logging</code>, <code>i</code>, <code>o</code>, <code>j</code>, <code>r</code>, <code>p</code>, <code>q</code>, <code>up_lastrow</code>, <code>CDRLData</code>, <code>commenttext</code>, <code>cd_lastrow</code>, <code>temp2</code>, <code>mycomment</code> to name a few.  If you add to CodeReview also include the other procedures - <code>logit</code>, <code>myFileExists</code> and any others I&#39;ve missed."}], "answers": [{"tags": [], "owner": {"reputation": 2844, "user_id": 8740349, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FRL1s.jpg?s=128&g=1", "display_name": "Top-Master", "link": "https://stackoverflow.com/users/8740349/top-master"}, "is_accepted": false, "score": 0, "last_activity_date": 1525845770, "creation_date": 1525845770, "answer_id": 50246475, "question_id": 50244718, "link": "https://stackoverflow.com/questions/50244718/why-does-vba-run-very-slow/50246475#50246475", "title": "Why does VBA run very slow?", "body": "<p>the <code>VBA</code> is kind of like <code>Java</code> which runs on <code>JVM</code> it is not really the CPU that does run it.\nfor example, consider the game speed when you would emulate <code>PS3</code> on <code>PC</code>/<code>Mac</code> rather than using the real device (in short very slow).</p>\n\n<p>what mean's <code>VBA</code> is already very slow and now your code does run on <code>Excel</code> and that will further slow everything since it will wait for <code>Excel</code> view/update.</p>\n\n<p>my choice would be to rewrite your code using <code>Qt</code> and <a href=\"https://github.com/VSRonin/QtXlsxWriter\" rel=\"nofollow noreferrer\">QtXlsxWriter</a>.\nalthough changing from <code>VBA</code> to <code>C++</code> was a great step for me but the <code>Qt</code> libraries where/are even more clear to understand as <code>VBA</code>.</p>\n\n<p>another option would be to provide your code so we see what is the problem but it looks like that is not an option ;-)</p>\n\n<p>without the code's I think it has to do with <code>VBA</code> waiting for <code>Excel</code> update</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9762048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92832ec361d03162a15ee74aea8eb0ac?s=128&d=identicon&r=PG&f=1", "display_name": "BlueStallion", "link": "https://stackoverflow.com/users/9762048/bluestallion"}, "is_accepted": true, "score": 0, "last_activity_date": 1526037952, "creation_date": 1526037952, "answer_id": 50291286, "question_id": 50244718, "link": "https://stackoverflow.com/questions/50244718/why-does-vba-run-very-slow/50291286#50291286", "title": "Why does VBA run very slow?", "body": "<p>I have pretty much solved my problem, but still do not have an answer to my question.  I now have the monthly run being completed in less than 4 hours, and still see where other optimizations can be made.  I primarily made three changes.  First, I put in Application.Calculation = xlCalculationManual at the beginning of the module that was taking so long, and set it back to automatic at the end of the module.  This cut the 11 hours down to around 4 to 5 hours.  I had read a lot on optimization, but the comment above was the first time I had heard of this.  Next I moved this module up to the beginning of the run.  Recall that running this module later in the full run took 11 hours, but when run alone, it only took around three minutes.  When run as the first module, in the full run it just takes three to four minutes.  And finally, I rewrote the module to use 2D array instead of inserting and deleting rows and columns in the worksheets.  The module now takes around 1 minute.  From 11 + hours to 1 minute is pretty good I'm thinking.  But the question is still there.  Why did moving the module from later in the run to first cause such a big difference, especially when recalc was set to manual.  Is it memory management?  Is it ?????  I dunno, but I'm very happy with the results.</p>\n"}], "owner": {"reputation": 1, "user_id": 9762048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92832ec361d03162a15ee74aea8eb0ac?s=128&d=identicon&r=PG&f=1", "display_name": "BlueStallion", "link": "https://stackoverflow.com/users/9762048/bluestallion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "closed_date": 1526042358, "accepted_answer_id": 50291286, "answer_count": 2, "score": -2, "last_activity_date": 1526039290, "creation_date": 1525833322, "last_edit_date": 1526039290, "question_id": 50244718, "link": "https://stackoverflow.com/questions/50244718/why-does-vba-run-very-slow", "closed_reason": "Not suitable for this site", "title": "Why does VBA run very slow?", "body": "<p>I have a large excel VBA project that reads in several files and generates a new excel spreadsheet with several tabs.  When run with weekly data it takes around 7 minutes to run.  When run with monthly data it is taking almost 18 hours to run.  It used to take over 30 hours, but thanks to several post on here I have been able to optimize it a lot.  I have tried to make the project modular, and I can select which portions of the program I want to run each time it is run.  It is the full run that takes the 18 hours.  I wrote in a logging capability to see what was taking so long, and have found a portion of the program that takes about 11 hours to run.  The issue is, if I select only that portion of the program to run by itself, it only takes 3 minutes to run.  During the full run this portion is run later in the full process, so there are several tabs already created before this one is done.  When run alone, there are only the two tabs that this portion creates.  I'm trying to figure out why there would be such a huge difference in the processing time between running it by itself, and running it in the full process. </p>\n\n<p>I have added the module in question.  It's probably not real pretty, but it works.  Again, 11 hours when run in the full process and about three minutes when run alone against the same data set.</p>\n\n<p>Thanks,</p>\n\n<pre><code>Sub Upcoming()\n\nDim Days As Integer\nDim gd_lastrow As Long\n\n'If Logging = True Then\n'    logIt (\"    Create new sheet\")\n'End If\n\nSheets.Add after:=ActiveSheet\nActiveSheet.Name = \"Coming Due\"\nRange(\"A1\").Value = \"IS Code\"\nRange(\"B1\").Value = \"Cage\"\nRange(\"C1\").Value = \"Contractor\"\nRange(\"D1\").Value = \"Contract Number\"\nRange(\"E1\").Value = \"Job #\"\nRange(\"F1\").Value = \"CLIN\"\nRange(\"G1\").Value = \"Due Date\"\nRange(\"H1\").Value = \"RDF\"\nRange(\"I1\").Value = \"Product\"\nRange(\"J1\").Value = \"Qty\"\nRange(\"K1\").Value = \"CA\"\nRows(\"1:1\").WrapText = True\nColumns(\"B:B\").ColumnWidth = 8\nColumns(\"C:C\").ColumnWidth = 46\nColumns(\"D:D\").ColumnWidth = 21\nColumns(\"G:G\").ColumnWidth = 18\nColumns(\"H:H\").ColumnWidth = 18\nColumns(\"I:I\").ColumnWidth = 15\nColumns(\"F:F\").ColumnWidth = 10\nColumns(\"G:G\").ColumnWidth = 21\nColumns(\"K:K\").ColumnWidth = 18\n\nColumns(\"E:F\").NumberFormat = \"0000\"\nColumns(\"E:F\").HorizontalAlignment = xlRight\nColumns(\"G:H\").NumberFormat = \"[$-409]mmmm d, yyyy;@\"\n\nup_curline = 2\nup_IS = \"\"\n\n'Sheets(\"GD\").Select\n'gd_lastrow = (ActiveSheet.UsedRange.Rows.Count + ActiveSheet.UsedRange.Rows(1).Row) - 1\ngd_lastrow = (Sheets(\"GD\").UsedRange.Rows.Count + ActiveSheet.UsedRange.Rows(1).Row) - 1\n\nIf myFileExists(myPath &amp; \"\\GD.xlsx\") Then\n    If Logging = True Then\n        logIt (\"    Prep the GD for vLookup\")\n    End If\n    Sheets(\"GD\").Select\n    If Range(\"BF6\").Value = \"\" Then\n        For i = 6 To gd_lastrow\n            Range(\"BF\" &amp; i).Value = Range(\"F\" &amp; i).Value &amp; Range(\"G\" &amp; i).Value &amp; Range(\"T\" &amp; i)\n            Range(\"BG\" &amp; i).Value = Abs(Range(\"P\" &amp; i))\n            Range(\"BH\" &amp; i).Value = Range(\"F\" &amp; i).Value &amp; Range(\"G\" &amp; i).Value &amp; Range(\"U\" &amp; i)\n            Range(\"BI\" &amp; i).Value = Abs(Range(\"P\" &amp; i))\n        Next i\n    End If\nEnd If\n\n'If Logging = True Then\n'    logIt (\"    Get upcoming schedules or RDFs\")\n'End If\n\nSheets(\"DWR\").Select\nup_lastRow = (ActiveSheet.UsedRange.Rows.Count + ActiveSheet.UsedRange.Rows(1).Row) - 1\n\nFor i = 2 To up_lastRow  'Get upcoming RDF's\n    Sheets(\"DWR\").Select\n    If Not IsError(Application.Match(Range(\"C\" &amp; i), Worksheets(\"CAR\").Range(\"C:C\"), 0)) Then  'Only get RDF's for the IS's in the CAR\n        If Not IsError(Application.Match(Range(\"G\" &amp; i), Worksheets(\"CAR\").Range(\"H:H\"), 0)) Then  'Only get RDFs for active contracts\n            If ((Range(\"K\" &amp; i) &gt;= Now()) And (Range(\"K\" &amp; i) &lt;= Now() + 90) And (Range(\"AE\" &amp; i) = \"\")) Or _\n               ((Range(\"Q\" &amp; i) &gt;= Now()) And (Range(\"Q\" &amp; i) &lt;= Now() + 90) And (Range(\"AE\" &amp; i) = \"\")) Or _\n               ((Range(\"AE\" &amp; i) &gt;= Now()) And (Range(\"AE\" &amp; i) &lt;= Now() + 90)) Then\n                Worksheets(\"Coming Due\").Range(\"A\" &amp; up_curline) = Range(\"C\" &amp; i)  'IS\n                Worksheets(\"Coming Due\").Range(\"B\" &amp; up_curline) = Range(\"E\" &amp; i)  ' Cage\n                Worksheets(\"Coming Due\").Range(\"C\" &amp; up_curline) = Range(\"D\" &amp; i)  'Contractor\n                Worksheets(\"Coming Due\").Range(\"D\" &amp; up_curline) = Range(\"G\" &amp; i)  ' Contract #\n                Worksheets(\"Coming Due\").Range(\"F\" &amp; up_curline) = Range(\"J\" &amp; i)  ' CLIN\n                If (Range(\"K\" &amp; i) = 0) Then\n                    Worksheets(\"Coming Due\").Range(\"G\" &amp; up_curline) = Range(\"Q\" &amp; i)\n                    Sheets(\"Coming Due\").Select\n                    Range(\"H\" &amp; up_curline).Select\n                    'Sheets(\"Coming Due\").Range(\"H\" &amp; up_curline).ThemeColor = xlThemeColorDark1\n                    'Sheets(\"Coming Due\").Range(\"H\" &amp; up_curline).TintAndShade = -0.249977111117893\n                    With Selection.Interior\n                        .Pattern = xlSolid\n                        .PatternColorIndex = xlAutomatic\n                        .ThemeColor = xlThemeColorDark1\n                        .TintAndShade = -0.249977111117893\n                        .PatternTintAndShade = 0\n                    End With\n                    Sheets(\"DWR\").Select\n                Else\n                    Worksheets(\"Coming Due\").Range(\"G\" &amp; up_curline) = Range(\"K\" &amp; i)  ' Due Date\n                End If\n                If Worksheets(\"Coming Due\").Range(\"H\" &amp; up_curline) &lt;&gt; \"Service CLIN\" Then\n                    Worksheets(\"Coming Due\").Range(\"H\" &amp; up_curline) = Range(\"AE\" &amp; i)  ' RDF\n                End If\n                If ((Worksheets(\"Coming Due\").Range(\"H\" &amp; up_curline) = \"\") Or (Worksheets(\"Coming Due\").Range(\"H\" &amp; up_curline)) = \"Service CLIN\") Then\n                    Worksheets(\"Coming Due\").Range(\"G\" &amp; up_curline).Style = \"Neutral\"\n                Else\n                    Worksheets(\"Coming Due\").Range(\"H\" &amp; up_curline).Style = \"Neutral\"\n                End If\n                'Worksheets(\"Coming Due\").Range(\"I\" &amp; up_curline) = Range(\"V\" &amp; i) ' Item\n                If ((Range(\"N\" &amp; i) &gt; 0) And (Range(\"N\" &amp; i) = Range(\"O\" &amp; i))) Then\n                    Worksheets(\"Coming Due\").Range(\"J\" &amp; up_curline) = \"Shipped\"\n                Else\n                    'Worksheets(\"Coming Due\").Range(\"J\" &amp; up_curline) = Range(\"N\" &amp; i) - Range(\"O\" &amp; i)  ' Qty\n                    On Error Resume Next\n                    Err.Clear\n                    Worksheets(\"Coming Due\").Range(\"J\" &amp; up_curline) = Application.WorksheetFunction.VLookup(Worksheets(\"DWR\").Range(\"G\" &amp; i).Value &amp; format(Worksheets(\"DWR\").Range(\"J\" &amp; i), \"0000\") &amp; Worksheets(\"DWR\").Range(\"K\" &amp; i), Worksheets(\"GD\").Range(\"BF6:BG\" &amp; gd_lastrow), 2, 0)\n                    If Err.Number &lt;&gt; 0 Then\n                        Err.Clear\n                        Worksheets(\"Coming Due\").Range(\"J\" &amp; up_curline) = Application.WorksheetFunction.VLookup(Worksheets(\"DWR\").Range(\"G\" &amp; i).Value &amp; Worksheets(\"DWR\").Range(\"J\" &amp; i) &amp; Worksheets(\"DWR\").Range(\"K\" &amp; i), Worksheets(\"GD\").Range(\"BF6:BG\" &amp; gd_lastrow), 2, 0)\n                        If Err.Number &lt;&gt; 0 Then\n                            Err.Clear\n                            Worksheets(\"Coming Due\").Range(\"J\" &amp; up_curline) = Application.WorksheetFunction.VLookup(Worksheets(\"DWR\").Range(\"G\" &amp; i).Value &amp; format(Worksheets(\"DWR\").Range(\"J\" &amp; i), \"0000\") &amp; Worksheets(\"DWR\").Range(\"K\" &amp; i), Worksheets(\"GD\").Range(\"BH6:BI\" &amp; gd_lastrow), 2, 0)\n                            If Err.Number &lt;&gt; 0 Then\n                                Err.Clear\n                                Worksheets(\"Coming Due\").Range(\"J\" &amp; up_curline) = Application.WorksheetFunction.VLookup(Worksheets(\"DWR\").Range(\"G\" &amp; i).Value &amp; Worksheets(\"DWR\").Range(\"J\" &amp; i) &amp; Worksheets(\"DWR\").Range(\"K\" &amp; i), Worksheets(\"GD\").Range(\"BH6:BI\" &amp; gd_lastrow), 2, 0)\n                                If Err.Number &lt;&gt; 0 Then\n                                    If Logging = True Then\n                                        logIt (\"            VlookUp Still Not Found\")\n                                        logIt (\"            \" &amp; Err.Number &amp; \": \" &amp; Err.Description)\n                                        logIt (\"            i = \" &amp; i)\n                                        logIt (\"            Contract = \" &amp; Worksheets(\"DWR\").Range(\"G\" &amp; i).Value)\n                                        logIt (\"            CLIN = \" &amp; format(Worksheets(\"DWR\").Range(\"J\" &amp; i), \"0000\"))\n                                        logIt (\"            Schedule Date = \" &amp; Worksheets(\"DWR\").Range(\"K\" &amp; i))\n                                        logIt (\"            Lookup Value = \" &amp; Worksheets(\"DWR\").Range(\"G\" &amp; i).Value &amp; format(Worksheets(\"DWR\").Range(\"J\" &amp; i), \"0000\") &amp; Worksheets(\"DWR\").Range(\"K\" &amp; i))\n                                    End If\n                                End If\n                            End If\n                        End If\n                    End If\n                    On Error GoTo 0\n                End If\n                For o = 0 To 2000\n                    If CDRLdata(o).contract = Worksheets(\"Coming Due\").Range(\"D\" &amp; up_curline) Then\n                        Worksheets(\"Coming Due\").Range(\"E\" &amp; up_curline) = CDRLdata(o).job\n                        Worksheets(\"Coming Due\").Range(\"I\" &amp; up_curline) = CDRLdata(o).Product\n                        Exit For\n                    End If\n                Next o\n                up_curline = up_curline + 1\n            End If\n        End If\n    End If\nNext i\n\nSheets(\"Coming Due\").Select\nup_lastRow = (ActiveSheet.UsedRange.Rows.Count + ActiveSheet.UsedRange.Rows(1).Row) - 1\n\n'If Logging = True Then\n'    logIt (\"    Get service CLIN data\")\n'End If\n\nSheets(\"GD\").Select  'Get service CLINs qty due\ngd_lastrow = (ActiveSheet.UsedRange.Rows.Count + ActiveSheet.UsedRange.Rows(1).Row) - 1\n\nFor j = 2 To up_lastRow\n    If Worksheets(\"Coming Due\").Range(\"J\" &amp; j) = 0 Then\n        For i = 6 To gd_lastrow\n            If ((Range(\"F\" &amp; i) = Worksheets(\"Coming Due\").Range(\"D\" &amp; j)) And (Range(\"G\" &amp; i) = Worksheets(\"Coming Due\").Range(\"F\" &amp; j)) And (Range(\"W\" &amp; i) = Worksheets(\"Coming Due\").Range(\"G\" &amp; j))) Then\n                If ((Range(\"H\" &amp; i) &gt; 0) And (Range(\"H\" &amp; i) = Range(\"I\" &amp; i))) Then\n                    Worksheets(\"Coming Due\").Range(\"J\" &amp; j) = \"Shipped\"\n                Else\n                    Worksheets(\"Coming Due\").Range(\"J\" &amp; j) = Range(\"H\" &amp; i) - Range(\"I\" &amp; i)\n                End If\n            End If\n        Next i\n    End If\nNext j\n\nFor j = 2 To up_lastRow\n    If Worksheets(\"Coming Due\").Range(\"J\" &amp; j) = \"Shipped\" Then\n        For i = 6 To gd_lastrow\n            If ((Range(\"F\" &amp; i) = Worksheets(\"Coming Due\").Range(\"D\" &amp; j)) And (Range(\"G\" &amp; i) = Worksheets(\"Coming Due\").Range(\"F\" &amp; j)) And (Range(\"U\" &amp; i) = Worksheets(\"Coming Due\").Range(\"G\" &amp; j))) Then\n                If ((Range(\"N\" &amp; i) &gt; 0) And (Range(\"N\" &amp; i) = Range(\"O\" &amp; i))) Then\n                    Worksheets(\"Coming Due\").Range(\"J\" &amp; j) = \"Shipped\"\n                Else\n                    Worksheets(\"Coming Due\").Range(\"J\" &amp; j) = Range(\"N\" &amp; i) - Range(\"O\" &amp; i)\n                End If\n            End If\n        Next i\n    End If\nNext j\n\n' Add any comments\n\n'If Logging = True Then\n'    logIt (\"    Add comments to the list\")\n'End If\n\nDim tCLIN As String\n\nSheets(\"Coming Due\").Select\ncommenttext = \"\"\n\ncd_lastrow = (ActiveSheet.UsedRange.Rows.Count + ActiveSheet.UsedRange.Rows(1).Row) - 1\n\nFor r = 2 To cd_lastrow\n    For p = 0 To 2000\n        If CDRLdata(p).company = \"\" Then\n            Exit For\n        End If\n\n        ' Contract level\n\n        If ((CDRLdata(p).contract = Worksheets(\"Coming Due\").Range(\"D\" &amp; r)) And (CDRLdata(p).CoNotes &lt;&gt; \"\")) Then\n            commenttext = CDRLdata(p).contract &amp; \": \" &amp; CDRLdata(p).CoNotes\n            temp2 = \"D\" &amp; r\n            Set mycomment = Range(temp2).Comment\n            If mycomment Is Nothing Then\n                Range(temp2).AddComment\n                Range(temp2).Comment.Visible = False\n                Range(temp2).Comment.Text commenttext\n                Range(temp2).Comment.Shape.TextFrame.AutoSize = True\n            End If\n        End If\n\n        ' CLIN Level\n\n        If CDRLdata(p).contract = Worksheets(\"Coming Due\").Range(\"D\" &amp; r) Then\n            If Len(Worksheets(\"Coming Due\").Range(\"F\" &amp; r)) = 1 Then\n                tCLIN = \"000\" &amp; Worksheets(\"Coming Due\").Range(\"F\" &amp; r)\n            Else\n                If Len(Worksheets(\"Coming Due\").Range(\"F\" &amp; r)) = 2 Then\n                    tCLIN = \"00\" &amp; Worksheets(\"Coming Due\").Range(\"F\" &amp; r)\n                Else\n                    If Len(Worksheets(\"Coming Due\").Range(\"F\" &amp; r)) = 3 Then\n                        tCLIN = \"0\" &amp; Worksheets(\"Coming Due\").Range(\"F\" &amp; r)\n                    Else\n                        tCLIN = Worksheets(\"Coming Due\").Range(\"F\" &amp; r)\n                    End If\n                End If\n            End If\n\n            If ((CDRLdata(p).CLIN = tCLIN) And (tCLIN &lt;&gt; \"\")) Then\n                If CDRLdata(p).CdNotes &lt;&gt; \"\" Then\n                    commenttext = CDRLdata(p).contract &amp; \" CLIN \" &amp; CDRLdata(p).CLIN &amp; \": \"\n                    If CDRLdata(p).di &lt;&gt; \"\" Then\n                        commenttext = commenttext &amp; CDRLdata(p).di &amp; \" \"\n                    End If\n                    commenttext = commenttext &amp; CDRLdata(p).CdNotes\n                    For q = p + 1 To 2000\n                        If ((CDRLdata(q).contract = Worksheets(\"Coming Due\").Range(\"D\" &amp; r)) And (CDRLdata(q).CLIN = Worksheets(\"Coming Due\").Range(\"F\" &amp; r)) And (CDRLdata(q).CdNotes &lt;&gt; \"\")) Then\n                            commenttext = commenttext &amp; \"  \" &amp; \" CLIN \" &amp; CDRLdata(q).CLIN &amp; \": \"\n                            If CDRLdata(q).di &lt;&gt; \"\" Then\n                                commenttext = commenttext &amp; CDRLdata(q).di &amp; \" \"\n                            End If\n                            commenttext = commenttext &amp; CDRLdata(q).CdNotes\n                        End If\n                    Next q\n                    temp2 = \"F\" &amp; r\n                    Set mycomment = Range(temp2).Comment\n                    If mycomment Is Nothing Then\n                        Range(temp2).AddComment\n                        Range(temp2).Comment.Visible = False\n                        Range(temp2).Comment.Text commenttext\n                        Range(temp2).Comment.Shape.TextFrame.AutoSize = True\n                    End If\n                    Exit For\n                End If\n            End If\n        End If\n    Next p\nNext r\n\n'If Logging = True Then\n'    logIt (\"    Format comments\")\n'End If\n\nComments_Tom\n\n'If Logging = True Then\n'    logIt (\"    Sort table by IS, Cage, Due date, Contract and CLIN\")\n'End If\n\nSheets(\"Coming Due\").Select\n\nup_lastRow = (ActiveSheet.UsedRange.Rows.Count + ActiveSheet.UsedRange.Rows(1).Row) - 1\n\nFor i = 2 To up_lastRow\n    If Range(\"H\" &amp; i) = \"\" Then\n        Range(\"M\" &amp; i) = Range(\"G\" &amp; i)\n    Else\n        If Range(\"H\" &amp; i) = \"Service CLIN\" Then\n            Range(\"M\" &amp; i) = Range(\"G\" &amp; i)\n        Else\n            Range(\"M\" &amp; i) = Range(\"H\" &amp; i)\n        End If\n    End If\nNext\n\nFor i = 2 To up_lastRow\n    For p = 0 To 2000\n        ' Get CA Name\n        If CDRLdata(p).contract = Worksheets(\"Coming Due\").Range(\"D\" &amp; i) Then\n            If CDRLdata(p).Position1 = \"Contract Administrator\" Then\n                Range(\"K\" &amp; i) = CDRLdata(p).Name1\n            Else\n                If CDRLdata(p).Position2 = \"Contract Administrator\" Then\n                    Range(\"K\" &amp; i) = CDRLdata(p).Name2\n                Else\n                    If CDRLdata(p).Position3 = \"Contract Administrator\" Then\n                        Range(\"K\" &amp; i) = CDRLdata(p).Name3\n                    End If\n                End If\n            End If\n            Exit For\n        End If\n    Next p\nNext i\n\n'sort by IS, Cage, Due date, Contract, CLIN\n\nRange(\"A2:M\" &amp; up_lastRow).Select\nActiveWorkbook.Worksheets(\"Coming Due\").Sort.SortFields.Clear\nActiveWorkbook.Worksheets(\"Coming Due\").Sort.SortFields.Add Key:=Range( _\n    \"A2:A\" &amp; up_lastRow), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nActiveWorkbook.Worksheets(\"Coming Due\").Sort.SortFields.Add Key:=Range( _\n    \"B2:B\" &amp; up_lastRow), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortTextAsNumbers\nActiveWorkbook.Worksheets(\"Coming Due\").Sort.SortFields.Add Key:=Range( _\n    \"M2:M\" &amp; up_lastRow), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nActiveWorkbook.Worksheets(\"Coming Due\").Sort.SortFields.Add Key:=Range( _\n    \"D2:D\" &amp; up_lastRow), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nActiveWorkbook.Worksheets(\"Coming Due\").Sort.SortFields.Add Key:=Range( _\n    \"F2:F\" &amp; up_lastRow), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nWith ActiveWorkbook.Worksheets(\"Coming Due\").Sort\n    .SetRange Range(\"A1:M\" &amp; up_lastRow)\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n\nActiveWorkbook.Save\n\n' enter 30/60/90 day group headers\n\nIf Logging = True Then\n    logIt (\"    Enter 30/60/90 day headers\")\nEnd If\n\nSheets(\"Coming Due\").Select\nRange(\"A2\").Select\n\nup_curline = 2\nup_IS = Range(\"A2\")\nup_cage = Range(\"B2\")\nup_Contract = Range(\"C2\")\nup_Due = Range(\"G2\")\nup_RDF = Range(\"H2\")\nup_Due = 0\nup_RDF = 0\n\nRows(\"2:4\").Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\nup_lastRow = up_lastRow + 3\nup_curline = up_curline + 3\n\nIf ((Range(\"G\" &amp; up_curline) &lt;= Now() + 30) And (Range(\"H\" &amp; up_curline) = \"\")) Then\n    Range(\"D\" &amp; up_curline - 2).Value = \"Due within 30 days\"\n    Days = 30\nElse\n    If ((Range(\"G\" &amp; up_curline) &lt;= Now() + 60) And (Range(\"H\" &amp; up_curline) = \"\")) Then\n        Range(\"D\" &amp; up_curline - 2).Value = \"Due within 60 days\"\n        Days = 60\n    Else\n        If Range(\"H\" &amp; up_curline) = \"\" Then\n            Range(\"D\" &amp; up_curline - 2).Value = \"Due within 90 days\"\n            Days = 90\n        End If\n    End If\nEnd If\nIf (Range(\"H\" &amp; up_curline) &lt;&gt; \"\") Then\n    If Range(\"H\" &amp; up_curline) &lt;= Now() + 30 Then\n        Range(\"D\" &amp; up_curline - 2).Value = \"Due within 30 days\"\n        Days = 30\n    Else\n        If Range(\"H\" &amp; up_curline) &lt;= Now() + 60 Then\n            Range(\"D\" &amp; up_curline - 2).Value = \"Due within 60 days\"\n            Days = 60\n        Else\n            Range(\"D\" &amp; up_curline - 2).Value = \"Due within 90 days\"\n            Days = 90\n        End If\n    End If\nEnd If\n\ni = up_curline\nDo Until IsEmpty(Cells(i, 1))\n    If Range(\"B\" &amp; i) &lt;&gt; up_cage Then\n        up_cage = Range(\"B\" &amp; i)\n        Rows(i &amp; \":\" &amp; i + 2).Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n        up_lastRow = up_lastRow + 3\n        i = i + 3\n        If ((Range(\"G\" &amp; i) &lt;= Now() + 30) And ((Range(\"H\" &amp; i) = \"\")) Or _\n            (((Range(\"H\" &amp; i) &lt;&gt; \"\")) And (Range(\"H\" &amp; i) &lt;= Now() + 30))) Then\n            Range(\"D\" &amp; i - 2).Value = \"Due within 30 days\"\n            Days = 30\n        Else\n            If ((Range(\"G\" &amp; i) &lt;= Now() + 60) And ((Range(\"H\" &amp; i) = \"\")) Or _\n                (((Range(\"H\" &amp; i) &lt;&gt; \"\")) And (Range(\"H\" &amp; i) &lt;= Now() + 60))) Then\n                Range(\"D\" &amp; i - 2).Value = \"Due within 60 days\"\n                Days = 60\n            Else\n                Range(\"D\" &amp; i - 2).Value = \"Due within 90 days\"\n                Days = 90\n            End If\n        End If\n    End If\n    If (Days = 30) And _\n       (((Range(\"G\" &amp; i) &gt; Now() + 30) And (Range(\"G\" &amp; i) &lt;= Now + 60) And (Range(\"H\" &amp; i) = \"\")) Or _\n       ((Range(\"H\" &amp; i) &gt; Now() + 30) And (Range(\"H\" &amp; i) &lt;= Now + 60) And (Range(\"H\" &amp; i) &lt;&gt; \"\"))) Then\n        Days = 60\n        Rows(i &amp; \":\" &amp; i + 2).Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n        up_lastRow = up_lastRow + 3\n        i = i + 3\n        Range(\"D\" &amp; i - 2).Value = \"Due within 60 days\"\n    End If\n    If (Days = 30) And _\n       (((Range(\"G\" &amp; i) &gt; Now() + 60) And (Range(\"G\" &amp; i) &lt;= Now + 90) And (Range(\"H\" &amp; i) = \"\")) Or _\n       ((Range(\"H\" &amp; i) &gt; Now() + 60) And (Range(\"H\" &amp; i) &lt;= Now + 90) And (Range(\"H\" &amp; i) &lt;&gt; \"\"))) Then\n        Days = 90\n        Rows(i &amp; \":\" &amp; i + 2).Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n        up_lastRow = up_lastRow + 3\n        i = i + 3\n        Range(\"D\" &amp; i - 2).Value = \"Due within 90 days\"\n    End If\n    If (Days = 60) And _\n       (((Range(\"G\" &amp; i) &gt; Now() + 60) And (Range(\"G\" &amp; i) &lt;= Now + 90) And (Range(\"H\" &amp; i) = \"\")) Or _\n       ((Range(\"H\" &amp; i) &gt; Now() + 60) And (Range(\"H\" &amp; i) &lt;= Now + 90) And (Range(\"H\" &amp; i) &lt;&gt; \"\"))) Then\n        Days = 90\n        Rows(i &amp; \":\" &amp; i + 2).Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n        up_lastRow = up_lastRow + 3\n        i = i + 3\n        Range(\"D\" &amp; i - 2).Value = \"Due within 90 days\"\n    End If\n    i = i + 1\nLoop\n\nColumns(\"M:M\").Delete\n\nFor i = 5 To up_lastRow\n    If Left(Range(\"D\" &amp; i), 10) = \"Due within\" Then\n        Range(\"G\" &amp; i - 1 &amp; \":H\" &amp; i + 1).Style = \"Normal\"\n    End If\nNext\n\nSheets(\"Coming Due\").Select\nActiveCell.ClearComments\nRange(\"A2\").Select\nActiveWindow.FreezePanes = True\nActiveSheet.Name = \"30-60-90 By Date\"\nup_lastRow = (ActiveSheet.UsedRange.Rows.Count + ActiveSheet.UsedRange.Rows(1).Row) - 1\nRange(\"A1:K\" &amp; up_lastRow).Borders.LineStyle = xlContinuous\n\nActiveWorkbook.Save\n\n' Create the 30-60-90 by Contract Tab\n\nIf Logging = True Then\n    logIt (\"Begin Upcoming By Contract\")\nEnd If\n\nDim curCage As String\nDim curContract As String\n\nRange(\"A1:K\" &amp; up_lastRow).Select\nSelection.Copy\nSheets.Add\nActiveSheet.Name = \"30-60-90 By Contract\"\nRange(\"A1\").Select\nSelection.PasteSpecial Paste:=xlPasteColumnWidths, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\nActiveSheet.Paste\nApplication.CutCopyMode = False\nIf Logging = True Then\n    logIt (\"    Begin Sorting By Contract\")\nEnd If\nActiveWorkbook.Worksheets(\"30-60-90 By Contract\").Sort.SortFields.Clear\nActiveWorkbook.Worksheets(\"30-60-90 By Contract\").Sort.SortFields.Add Key:= _\n    Range(\"B5:B\" &amp; up_lastRow), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption _\n    :=xlSortNormal\nActiveWorkbook.Worksheets(\"30-60-90 By Contract\").Sort.SortFields.Add Key:= _\n    Range(\"D5:D\" &amp; up_lastRow), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption _\n    :=xlSortNormal\nActiveWorkbook.Worksheets(\"30-60-90 By Contract\").Sort.SortFields.Add Key:= _\n    Range(\"G5:G\" &amp; up_lastRow), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption _\n    :=xlSortNormal\nWith ActiveWorkbook.Worksheets(\"30-60-90 By Contract\").Sort\n    .SetRange Range(\"A5:K\" &amp; up_lastRow)\n    .Header = xlGuess\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\nRows(\"3:4\").Delete Shift:=xlUp\nIf Logging = True Then\n    logIt (\"    Begin Deleting Blank Rows\")\nEnd If\nFor i = up_lastRow - 2 To 1 Step -1\n    If Range(\"A\" &amp; i).Value = \"\" Then\n        Rows(i &amp; \":\" &amp; i).Delete Shift:=xlUp\n    Else\n        up_lastRow = i\n        Exit For\n    End If\n    If ((i Mod 200) = 0) Then\n        If Logging = True Then\n            logIt (\"    Line =\" &amp; i)\n        End If\n    End If\nNext i\nRange(\"A2\").Select\nActiveWindow.FreezePanes = True\ncurCage = Range(\"B3\").Value\ncurContract = Range(\"D3\").Value\nj = 4\nIf Logging = True Then\n    logIt (\"    Begin Looking For New CAGE or Contract Number\")\nEnd If\n\nWhile Range(\"A\" &amp; j).Value &lt;&gt; \"\"\n    If Range(\"B\" &amp; j).Value &lt;&gt; curCage Then\n        curCage = Range(\"B\" &amp; j).Value\n        curContract = Range(\"D\" &amp; j).Value\n        Rows(j &amp; \":\" &amp; j + 1).Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n        j = j + 2\n    End If\n    If Range(\"D\" &amp; j).Value &lt;&gt; curContract Then\n        curContract = Range(\"D\" &amp; j).Value\n        Rows(j &amp; \":\" &amp; j).Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n        j = j + 1\n    End If\n    j = j + 1\n    If ((j Mod 200) = 0) Then\n        If Logging = True Then\n            logIt (\"    Line =\" &amp; j)\n        End If\n    End If\nWend\nEnd Sub\n</code></pre>\n"}, {"tags": ["json", "excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1525875936, "post_id": 50244611, "comment_id": 87529157, "body": "<code>Results</code> is a string. You don&#39;t <code>Set</code> a string since it&#39;s not an Object. Also, more importantly, what you hoping would be written to that string since <code>Results</code> in your JSON has many attributes."}, {"owner": {"reputation": 551, "user_id": 1892706, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a821b91cf97360ec38ba2774f389c1e1?s=128&d=identicon&r=PG", "display_name": "OrdinaryHuman", "link": "https://stackoverflow.com/users/1892706/ordinaryhuman"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1525876291, "post_id": 50244611, "comment_id": 87529440, "body": "It&#39;s a stock quote, so <code>last_trade_price</code>. I can remove the entire <code>results</code> block and the original error remains if I try to Debug.Print <code>jsonResponse</code>."}], "answers": [{"comments": [{"owner": {"reputation": 551, "user_id": 1892706, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a821b91cf97360ec38ba2774f389c1e1?s=128&d=identicon&r=PG", "display_name": "OrdinaryHuman", "link": "https://stackoverflow.com/users/1892706/ordinaryhuman"}, "edited": false, "score": 0, "creation_date": 1525876973, "post_id": 50256022, "comment_id": 87530011, "body": "Works perfectly. Thank you."}, {"owner": {"reputation": 2934, "user_id": 4770813, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/bbd367dc9a67d5dcbdfc769b64f3eff3?s=128&d=identicon&r=PG&f=1", "display_name": "Scaramouche", "link": "https://stackoverflow.com/users/4770813/scaramouche"}, "edited": false, "score": 0, "creation_date": 1599752958, "post_id": 50256022, "comment_id": 112878122, "body": "hello, please, on line <code>Set jsonResponse = JsonConverter.ParseJson(http.responseText)</code> it throws <i>run-time error 424 &gt; Object required</i>, could you please help me with that? simple pointer will suffice, thanks!"}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 2, "last_activity_date": 1525876536, "creation_date": 1525876536, "answer_id": 50256022, "question_id": 50244611, "link": "https://stackoverflow.com/questions/50244611/extract-json-in-excel-vba/50256022#50256022", "title": "Extract JSON in Excel VBA", "body": "<p>Your json has an object called <code>results</code>. There could be, but isn't, multiple <code>result</code> objects. You have only one, so I think it's leading to confusion. Each <code>result</code> is going to get it's own entry in your <code>jsonResponse</code> dictionary. The ITEM in that dictionary will, itself, be a dictionary. </p>\n\n<p>The best way to deal with iterating through the dictionary in a dictionary is to declare a new dictionary, I'm calling <code>att</code> for \"Attributes\" and then fill that dictionary with each iteration through the <code>jsonResponse</code> dictionary. It will only iterate once though as you only have one <code>result</code>:</p>\n\n<pre><code>Public Sub STOCKQUOTE()\n\n    Dim http As Object\n    Set http = CreateObject(\"MSXML2.XMLHTTP\")\n\n    Const sURL As String = \"https://api.robinhood.com/quotes/?symbols=AMZN\"\n    http.Open \"GET\", sURL, False\n    http.send\n\n    Dim jsonResponse As Dictionary\n    Set jsonResponse = JsonConverter.ParseJson(http.responseText)\n\n    Dim att As Dictionary\n\n    For Each att In jsonResponse(\"results\")\n     Debug.Print att(\"last_trade_price\")\n    Next att\nEnd Sub\n</code></pre>\n\n<p>Alternatively, because you have only a single result, you could just refer to that result by it's index in the <code>jsonResponse</code> dictionary and then it's attribute you are after. This makes the code smaller, but if you ever get more than one result from your REST query it will be lost forever. No biggie though since you don't expect that to happen:</p>\n\n<pre><code>Public Sub STOCKQUOTE()\n\n    Dim http As Object\n    Set http = CreateObject(\"MSXML2.XMLHTTP\")\n\n    Const sURL As String = \"https://api.robinhood.com/quotes/?symbols=AMZN\"\n    http.Open \"GET\", sURL, False\n    http.send\n\n    Dim jsonResponse As Dictionary\n    Set jsonResponse = JsonConverter.ParseJson(http.responseText)\n\n    MsgBox (jsonResponse(\"results\")(1)(\"last_trade_price\"))\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 551, "user_id": 1892706, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a821b91cf97360ec38ba2774f389c1e1?s=128&d=identicon&r=PG", "display_name": "OrdinaryHuman", "link": "https://stackoverflow.com/users/1892706/ordinaryhuman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 930, "favorite_count": 0, "accepted_answer_id": 50256022, "answer_count": 1, "score": 1, "last_activity_date": 1525876536, "creation_date": 1525832304, "last_edit_date": 1531161705, "question_id": 50244611, "link": "https://stackoverflow.com/questions/50244611/extract-json-in-excel-vba", "title": "Extract JSON in Excel VBA", "body": "<p>I want to parse stock quotes from the Robin Hood API via Excel VBA.</p>\n\n<p>Say I want Amazon, which is <code>https://api.robinhood.com/quotes/?symbols=AMZN</code>.</p>\n\n<p>Which produces:</p>\n\n<pre><code>{  \n   \"results\":[  \n      {  \n         \"ask_price\":\"1592.3900\",\n         \"ask_size\":100,\n         \"bid_price\":\"1591.0000\",\n         \"bid_size\":500,\n         \"last_trade_price\":\"1592.3900\",\n         \"last_extended_hours_trade_price\":\"1592.0000\",\n         \"previous_close\":\"1600.1400\",\n         \"adjusted_previous_close\":\"1600.1400\",\n         \"previous_close_date\":\"2018-05-07\",\n         \"symbol\":\"AMZN\",\n         \"trading_halted\":false,\n         \"has_traded\":true,\n         \"last_trade_price_source\":\"consolidated\",\n         \"updated_at\":\"2018-05-08T23:58:44Z\",\n         \"instrument\":\"https://api.robinhood.com/instruments/c0bb3aec-bd1e-471e-a4f0-ca011cbec711/\"\n      }\n   ]\n}\n</code></pre>\n\n<p>Using an example like <a href=\"https://stackoverflow.com/questions/48521809/issue-with-jsonconverter\">this answer</a>, I have installed <a href=\"https://github.com/VBA-tools/VBA-JSON\" rel=\"nofollow noreferrer\">VBA-JSON</a> and turned on Microsoft Scripting Runtime.</p>\n\n<p>My code:</p>\n\n<pre><code>Public Sub STOCKQUOTE()\n\n Dim http As Object\n Set http = CreateObject(\"MSXML2.XMLHTTP\")\n\n Const sURL As String = \"https://api.robinhood.com/quotes/?symbols=AMZN\"\n http.Open \"GET\", sURL, False\n http.send\n\n Dim jsonResponse As Dictionary\n Set jsonResponse = JsonConverter.ParseJson(http.responseText)\n\n Dim results As String\n Set results = jsonResponse(\"results\")\n\n MsgBox results\nEnd Sub\n</code></pre>\n\n<p>But this doesn't work, instead I get <code>Compiler Error: Object Required</code> for the line <code>Set results = jsonResponse(\"results\")</code>.</p>\n\n<p>If I add <code>Debug.Print http.responseText</code> I see the correct JSON, but any idea what I'm doing wrong?</p>\n\n<p>VBA-JSON is installed correctly, because if I use <a href=\"https://github.com/VBA-tools/VBA-JSON\" rel=\"nofollow noreferrer\">their example</a>, it works fine:</p>\n\n<pre><code>Dim Json As Object\nSet Json = JsonConverter.ParseJson(\"{\"\"a\"\":123,\"\"b\"\":[1,2,3,4],\"\"c\"\":{\"\"d\"\":456}}\")\n</code></pre>\n\n<p>But if I try changing <code>Dictionary</code> to <code>Object</code>, I get <code>Run-time error '450': Wrong number of arguments or invalid property assignment</code>.</p>\n"}, {"tags": ["vba", "excel", "protection"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1525830167, "post_id": 50243722, "comment_id": 87506352, "body": "Your issue is the <code>Sheets(Sheet1). ...</code>.  Use <code>Sheets(&quot;Sheet1&quot;). ...</code> to use the sheet name, or <code>Sheet1. ...</code> to use the code name"}, {"owner": {"reputation": 5, "user_id": 9060320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd469422b30e7568b248378ef53d2683?s=128&d=identicon&r=PG&f=1", "display_name": "Mystery Man", "link": "https://stackoverflow.com/users/9060320/mystery-man"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1525833811, "post_id": 50243722, "comment_id": 87507043, "body": ".... Sweet Georgia Brown....  If that&#39;s what it was, thank you, now please excuse me while I go hide in a closet in embarrassment."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 9060320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd469422b30e7568b248378ef53d2683?s=128&d=identicon&r=PG&f=1", "display_name": "Mystery Man", "link": "https://stackoverflow.com/users/9060320/mystery-man"}, "edited": false, "score": 0, "creation_date": 1525833932, "post_id": 50243952, "comment_id": 87507068, "body": "Yes, as much as I&#39;d like to have a way to lock everything down like Fort Knox, I know the limits of Excel and it&#39;s protections.  This is more to just keep people from fiddling with numbers &quot;to make it look good&quot; and breaking things when it&#39;s convenient.   I&#39;ll check into this too, thank you."}], "tags": [], "owner": {"reputation": 1, "user_id": 8098256, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y0JQVWAL1yY/AAAAAAAAAAI/AAAAAAAAAT4/KjsaxLZgch4/photo.jpg?sz=128", "display_name": "Stephen Lowery", "link": "https://stackoverflow.com/users/8098256/stephen-lowery"}, "is_accepted": false, "score": -1, "last_activity_date": 1525826293, "creation_date": 1525826293, "answer_id": 50243952, "question_id": 50243722, "link": "https://stackoverflow.com/questions/50243722/excel-vba-to-apply-specific-granular-protection-to-specific-worksheets/50243952#50243952", "title": "Excel - VBA to apply specific/granular protection to specific worksheets?", "body": "<p>At the end of the day, you're not going to have a perfect solution. VBA protections on sheets won't stop malicious users from accessing whatever you have stored there. It's simple to brute force through the protections they have.</p>\n\n<p>Assuming that you're ok with the above and only trying to dissuade (but not prevent) users from accessing your sheets, I'd set up a variant first. Your loop will assign that variant to each of the sheet objects in the workbook, and you'll protect them with your statement.</p>\n\n<pre><code>dim sht as WorkSheet\nfor each sht in ThisWorkbook.Sheets\n    sht.protect {args go here...}\nnext sht\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 9060320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd469422b30e7568b248378ef53d2683?s=128&d=identicon&r=PG&f=1", "display_name": "Mystery Man", "link": "https://stackoverflow.com/users/9060320/mystery-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525826293, "creation_date": 1525823825, "question_id": 50243722, "link": "https://stackoverflow.com/questions/50243722/excel-vba-to-apply-specific-granular-protection-to-specific-worksheets", "title": "Excel - VBA to apply specific/granular protection to specific worksheets?", "body": "<p>I'm trying to secure a rather large and tricky workbook and I just don't seem to be putting all the tools together properly.</p>\n\n<p>I have seen many examples here and on other sites that will run through a loop of all worksheet names and apply protection.  My quirk is that I have different protection options that I would like to enable or disable on each different sheet.  Currently I'm wrestling with:</p>\n\n<pre><code>Private Sub Workbook_Open()\n\n'For each Worksheet:\nSheets(Sheet1).Protect Password:=\"superpassword\", UserInterFaceOnly:=True, Contents:=True, AllowFormattingCells:=True, _\n    AllowFormattingColumns:=True, AllowFormattingRows:=True, AllowInsertingColumns:=False, AllowInsertingRows:=False, _\n    AllowInsertingHyperlinks:=False, AllowDeletingColumns:=False, AllowDeletingRows:=False, AllowSorting:=False, _\n    AllowFiltering:=False, AllowUsingPivotTables:=False, DrawingObjects:=False, Scenarios:=False\n\nSheets(Sheet2).Protect Password:=\"superpassword\", UserInterFaceOnly:=True,  Contents:=True, AllowFormattingCells:=True, _\n    AllowFormattingColumns:=True, AllowFormattingRows:=False, AllowInsertingColumns:=False, AllowInsertingRows:=True, _\n    AllowInsertingHyperlinks:=False, AllowDeletingColumns:=False, AllowDeletingRows:=False, AllowSorting:=False, _\n    AllowFiltering:=False, AllowUsingPivotTables:=True, DrawingObjects:=False, Scenarios:=False \n\n\u2018and so on\u2026 for other sheets\n\nEnd Sub\n</code></pre>\n\n<p>But I'm running into a rat's nest of errors whether I try Sheets() or Worksheets().  Just can't get it to loop through.</p>\n\n<p>I've seen examples for applying the UserInterfaceOnly to the entire sheet in the background, so I realize I could trim it down a little that way.  </p>\n\n<p>And there should be a quick/short way to call back to this sub and reapply these protections when the sheet gets closed, yes?</p>\n\n<p>Thanks in advance for any assistance.  I realize it's a lot, but I've been banging my head against this for weeks while configuring other areas of the workbook and it feels like my brain is Excel'ed out at this point.</p>\n"}, {"tags": ["vba", "for-loop"], "comments": [{"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1525822350, "post_id": 50243529, "comment_id": 87504759, "body": "What is the precise error you are getting?"}, {"owner": {"reputation": 1, "user_id": 9761581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e0763389c93de9269336f9a3c61732e?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley Wellington", "link": "https://stackoverflow.com/users/9761581/bradley-wellington"}, "reply_to_user": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1525822632, "post_id": 50243529, "comment_id": 87504833, "body": "The error I&#39;m gettin says &quot;Compile error: For control variable already in use.&quot;  I know that it is never going to work the way I have it right now, because I am basically using objFile twice... My question is essentially if there is a way to  dim another variable as an objfile or something like that?  And thank you for the quick response!"}, {"owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "edited": false, "score": 0, "creation_date": 1525822677, "post_id": 50243529, "comment_id": 87504845, "body": "Is there a reason you&#39;re using nested loops instead of two separate loops?"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1525822730, "post_id": 50243529, "comment_id": 87504860, "body": "Which line does the compiler point to? The code you;ve listed has two separate variables -- <code>objFile</code> and <code>objFile2</code>. Also, the error message, and the line to which it points, should be edited into your question."}, {"owner": {"reputation": 1, "user_id": 9761581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e0763389c93de9269336f9a3c61732e?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley Wellington", "link": "https://stackoverflow.com/users/9761581/bradley-wellington"}, "edited": false, "score": 0, "creation_date": 1525822838, "post_id": 50243529, "comment_id": 87504891, "body": "Hello Ahmed, the nested second loop is referencing something from the first loop. Basically what I am doing is I have two folders and I want it to go through each item in the first folder and check if an item in the second folder matches this item. Thank you too for your quick reply!"}, {"owner": {"reputation": 1, "user_id": 9761581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e0763389c93de9269336f9a3c61732e?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley Wellington", "link": "https://stackoverflow.com/users/9761581/bradley-wellington"}, "edited": false, "score": 0, "creation_date": 1525822932, "post_id": 50243529, "comment_id": 87504908, "body": "It points to the second objFile for loop."}, {"owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "edited": false, "score": 1, "creation_date": 1525823209, "post_id": 50243529, "comment_id": 87504970, "body": "Well, now that you edited the question, it&#39;s pretty obvious. You can&#39;t use the same variable for two nested loops. However, I don&#39;t think you even need nested loops. Why don&#39;t you explain exactly what you&#39;re trying to do? What do you mean by <code>if an item in the second folder matches this item</code>? Matches what exactly?"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1525823232, "post_id": 50243529, "comment_id": 87504974, "body": "Why do you need the same variable? Use a different variable."}, {"owner": {"reputation": 1, "user_id": 9761581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e0763389c93de9269336f9a3c61732e?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley Wellington", "link": "https://stackoverflow.com/users/9761581/bradley-wellington"}, "edited": false, "score": 0, "creation_date": 1525823444, "post_id": 50243529, "comment_id": 87505030, "body": "When I use a different variable (e.g. objFile2) I get the error message &quot;Run time error 424: Object required&quot;. What I am trying to do is find specific files in the first folder and then check if there is a file in the second folder with the same name. THanks again!"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1525823535, "post_id": 50243529, "comment_id": 87505050, "body": "This is also information which you should edit into your question. As far as the error goes, are you sure <code>AnotherFolder</code> is initialized -- <code>Set AnotherFolder = ...</code>? If this is indeed the problem, then this is an entirely different error, and has no connection to multiple variables."}, {"owner": {"reputation": 1, "user_id": 9761581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e0763389c93de9269336f9a3c61732e?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley Wellington", "link": "https://stackoverflow.com/users/9761581/bradley-wellington"}, "edited": false, "score": 0, "creation_date": 1525824004, "post_id": 50243529, "comment_id": 87505159, "body": "I have it set in the following way: <code>SecondPath = &quot;C:\\pathname...&quot;</code> And then my &quot;nested&quot; function starts with: <code>For Each objFile In SecondPath.Files</code>  That should work, right?"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1525824782, "post_id": 50243529, "comment_id": 87505327, "body": "Wait. That means <code>ExcelPath</code> contains a <code>String</code>, not a <code>Scripting.Folder</code> object. A <code>String</code> doesn&#39;t have a <code>Files</code> property. You&#39;ll need to initialize with a <code>Folder</code> object -- <code>Set ExcelPath = objFso.GetFolder(&quot;C:\\pathname...&quot;)</code> In order to avoid these kinds of mistakes, add a reference to the <b>Microsoft Scripting Runtime</b> library (<b>Tools</b> -&gt; <b>References...</b>) and strongly-type your variables: <code>Dim ExcelPath As Scripting.Folder</code>"}, {"owner": {"reputation": 1, "user_id": 9761581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e0763389c93de9269336f9a3c61732e?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley Wellington", "link": "https://stackoverflow.com/users/9761581/bradley-wellington"}, "reply_to_user": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1525825029, "post_id": 50243529, "comment_id": 87505377, "body": "@ZevSpitz Wow I feel so stupid, that was actually the problem... Thank you so much to you and Ahmed Abdelhameed for your help!"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1525825583, "post_id": 50243529, "comment_id": 87505501, "body": "I&#39;ve taken the liberty of cleaning up the question. Does it better represent the problem you had now? Do you have any comments / suggestions / corrections?"}, {"owner": {"reputation": 1, "user_id": 9761581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e0763389c93de9269336f9a3c61732e?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley Wellington", "link": "https://stackoverflow.com/users/9761581/bradley-wellington"}, "edited": false, "score": 0, "creation_date": 1530652727, "post_id": 50243529, "comment_id": 89309160, "body": "It does represent it better. I hope maybe someone else who comes along this problem sees the solution here. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9761581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e0763389c93de9269336f9a3c61732e?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley Wellington", "link": "https://stackoverflow.com/users/9761581/bradley-wellington"}, "edited": false, "score": 0, "creation_date": 1525824408, "post_id": 50243737, "comment_id": 87505250, "body": "Wow thank your for the thorough reply! However, I cannot quite use it as I am only comparing parts of the file name. Currently my code looks like this:"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 1, "creation_date": 1525824946, "post_id": 50243737, "comment_id": 87505367, "body": "I would strongly recommend adding a reference to <b>Microsoft Scripting Runtime</b> and using early-bound types -- <code>Dim oFSO As New Scripting.FileSystemObject</code>. This will help avoid the OP&#39;s problem of assigning a string to a <code>Scripting.Folder</code> variable."}, {"owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "reply_to_user": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1525825051, "post_id": 50243737, "comment_id": 87505384, "body": "@ZevSpitz I used late-binding because the OP didn&#39;t show how he initializes his variables and I didn&#39;t want to confuse him more. But it&#39;s a good point."}], "tags": [], "owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "is_accepted": false, "score": 1, "last_activity_date": 1525824740, "last_edit_date": 1525824740, "creation_date": 1525824061, "answer_id": 50243737, "question_id": 50243529, "link": "https://stackoverflow.com/questions/50243529/how-to-set-two-different-objfile-variables/50243737#50243737", "title": "How to set two different objFile variables?", "body": "<p>To check if files in one folder exist in another folder, you don't need to compare each file in the first folder against <em>each file in the second folder</em>. You can simply concat the path and check if the file exists using <code>FileSystemObject.FileExists()</code>.</p>\n\n<p>Something like this would work:</p>\n\n<pre><code>Dim oFile       As Object\nDim oFSO        As Object\nDim oFolder     As Object\n\nDim folderPath1 As String, folderPath2 As String\nfolderPath1 = \"The\\path\\of\\your\\original\\folder\"\nfolderPath2 = \"The\\path\\of\\your\\second\\folder\"\n\nSet oFSO = CreateObject(\"Scripting.FileSystemObject\")\nSet oFolder = oFSO.GetFolder(folderPath1)\n\nFor Each oFile In oFolder.Files\n    If oFSO.FileExists(folderPath2 &amp; \"\\\" &amp; oFile.Name) Then\n        ' File exists in the second folder\n    End If\nNext oFile\n</code></pre>\n\n<hr>\n\n<p><strong>Edit:</strong> If you have to use nested loops for some reason, you can adapt the above code to something like this:</p>\n\n<pre><code>Dim oFSO        As Object\nDim oFile       As Object\nDim oFolder     As Object\nDim oFile2      As Object\nDim oFolder2    As Object\n\nDim folderPath1 As String, folderPath2 As String\nfolderPath1 = \"The\\path\\of\\your\\original\\folder\"\nfolderPath2 = \"The\\path\\of\\your\\second\\folder\"\n\nSet oFSO = CreateObject(\"Scripting.FileSystemObject\")\nSet oFolder = oFSO.GetFolder(folderPath1)\nSet oFolder2 = oFSO.GetFolder(folderPath2)\n\nFor Each oFile In oFolder.Files\n    For Each oFile2 In oFolder2.Files\n        ' Use oFile.Name and oFile2.Name to do whatever you want.\n    Next oFile2\nNext oFile\n</code></pre>\n\n<p>Hope that helps.</p>\n"}], "owner": {"reputation": 1, "user_id": 9761581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e0763389c93de9269336f9a3c61732e?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley Wellington", "link": "https://stackoverflow.com/users/9761581/bradley-wellington"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525825533, "creation_date": 1525822116, "last_edit_date": 1525825533, "question_id": 50243529, "link": "https://stackoverflow.com/questions/50243529/how-to-set-two-different-objfile-variables", "title": "How to set two different objFile variables?", "body": "<p>I have code which goes through each <code>objFile</code> in a <code>Folder</code> object:</p>\n\n<pre><code>For Each objFile In objFolder.Files\n    ' do something...\nNext objFile\n</code></pre>\n\n<p>Now I would like to create an inner <code>For Each</code> loop:</p>\n\n<pre><code>For Each objFile In objFolder.Files\n    'do something...\n    For Each objFile In AnotherFolder.Files\n        'Do something else...\n    Next objFile\nNext objFile\n</code></pre>\n\n<p>However, I can only declare one <code>objFile</code> per script. When I try to run this, I get the following error:</p>\n\n<blockquote>\n  <p>Compile error: For control variable already in use</p>\n</blockquote>\n\n<p>pointing at the <code>For Each</code> line of the inner loop.</p>\n\n<hr>\n\n<p><strong>Update</strong></p>\n\n<p>I tried using two different variables, with the following code:</p>\n\n<pre><code>For Each objFile In objFolder.Files\n\n    ' Read creation date of file\n    Set f = objFSO.GetFile(objFile)\n    s = f.DateLastModified\n\n    Dim objFile2 As Object\n\n    ExcelPath = \"C:/...\"\n    For Each objFile2 In ExcelPath.Files\n        If InStr(s, objFile2) Then\n            objFSO.CopyFile objFile, strNewFolder &amp; \"\\\", True\n        End If\n    Next objFile2\nNext objFile\n</code></pre>\n\n<p>but then I get a runtime error:</p>\n\n<blockquote>\n  <p>Run time error 424: Object required</p>\n</blockquote>\n\n<p>again pointing at the <code>For Each</code> line of the inner loop.</p>\n\n<p>How can I resolve these issues?</p>\n"}, {"tags": ["excel", "excel-formula", "sum", "excel-tables", "vba"], "comments": [{"owner": {"reputation": 586, "user_id": 9633414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a17a4ec5f0dbe53ee0a2153b37138b17?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/9633414/j-doe"}, "edited": false, "score": 0, "creation_date": 1525822415, "post_id": 50242934, "comment_id": 87504780, "body": "Are you sure you want to divide the employee cost by hours worked ? It is not going to give you the project cost. I would go for a basic pro rata e.g. <code>Kevin total costs * (Kevin project hours &#47; total Kevin hours)</code>. &quot;Kevin: 5200/5 + Alex:3300/7 + 4400/5&quot; is not the cost for Apple project for JAN+FEB."}, {"owner": {"reputation": 3, "user_id": 9718644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccc50339bba460465a4b175e23fc04df?s=128&d=identicon&r=PG&f=1", "display_name": "Kev", "link": "https://stackoverflow.com/users/9718644/kev"}, "reply_to_user": {"reputation": 586, "user_id": 9633414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a17a4ec5f0dbe53ee0a2153b37138b17?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/9633414/j-doe"}, "edited": false, "score": 0, "creation_date": 1525863694, "post_id": 50242934, "comment_id": 87520561, "body": "Ha exactly as you said, that is what I want to do."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9718644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccc50339bba460465a4b175e23fc04df?s=128&d=identicon&r=PG&f=1", "display_name": "Kev", "link": "https://stackoverflow.com/users/9718644/kev"}, "edited": false, "score": 0, "creation_date": 1525864096, "post_id": 50243860, "comment_id": 87520809, "body": "Thanks for the suggestion,  the thing is I had many other calculations I used the table for,  it would certainly be nice if I had the table in this structure, but it&#39;s late for that, I need to figure out doing this with the table structure I have."}], "tags": [], "owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "is_accepted": false, "score": 0, "last_activity_date": 1525825322, "creation_date": 1525825322, "answer_id": 50243860, "question_id": 50242934, "link": "https://stackoverflow.com/questions/50242934/sum-product-for-all-the-months-if-2-tables-match/50243860#50243860", "title": "Sum product for all the months if 2 tables match", "body": "<p>I suggest you to change how you store your data. If you can make some minor changes, then you can have an easy way to get the information you want, and also a Pivot Table with a summary of cost recurred for each proyect and which employee generated that cost.</p>\n\n<blockquote>\n  <p><strong>IMPORTANT:</strong> For this answer to work, you must make sure that every Employee's Name is UNIQUE. If not, adapt the example trying to create\n  an Employee's ID or something.</p>\n</blockquote>\n\n<p>Also, <strong>please, note i got a spanish version of Excel, so screenshots are in spanish</strong> but I will translate formulas :)</p>\n\n<p>Ok, first of all, I changed the design of your table Employees. Creating a column for each month is kind of annoying. Use just a column to get the month. You can type the month in a cell just like <code>01/2018</code> and Excel will change it instantly to format mmm-yy (Jan-18)</p>\n\n<p>This is how your Employees table should look:</p>\n\n<p><a href=\"https://i.stack.imgur.com/eO1Bp.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eO1Bp.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The column <code>TOTAL COST</code> is just a sum of SALARY + INSURANCE. If you have any other concept, just add it as a column and modify the TOTAL COST COLUMN to include it.</p>\n\n<p>Second, the table Project, I think it should be like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/moVk7.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/moVk7.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The column <code>Employee Cost</code> has an Array Formula.</p>\n\n<blockquote>\n  <p><strong>IMPORTANT</strong>: Array formulas are inserted pressing <kbd>CTRL</kbd>+<kbd>SHIFT</kbd>+<kbd>ENTER</kbd></p>\n</blockquote>\n\n<p>The formula is (I used same names for tables, so copy-pasting should work for you):</p>\n\n<p><code>=INDEX(Employees;MATCH(Project[[#This row];[Employee_Name]]&amp;Project[[#This row];[Month]];Employees[Name]&amp;Employees[Month];0);COLUMN(Employees[[#Headers];[TOTAL COST]]))</code></p>\n\n<p>If you typed the formula right, you should see <strong>{</strong> at start and <strong>}</strong> at end.</p>\n\n<p>The formula in <code>Cost Recurred to Project</code> is just a division of <code>Employee Cost / Hours</code>. Added an <code>IFERROR</code> when the hours worked are 0, then show 0.</p>\n\n<p><code>=IFERROR(Project[[#This row];[Employee Cost]]/Project[[#This row];[Hours]];0)</code></p>\n\n<p>And last step, your Pivot Table. Create one and organise it to get the sum per hours and month and proyect you want. You can get one like the one below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/a5qKX.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/a5qKX.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>As you can see,e.g. for project Apple, you can see that total cost is 2.391,43\nbut also you can see the cost of each Employee. Pretty cool I think.</p>\n\n<p>I really hope you can modify the design of your data, because Excel is designed to work going down (I mean using rows) more than using columns. Excel 2007 got more than 1 million of rows and just around 16.000 columns, so it's designed to work vertically.</p>\n\n<p>Hope this helps, or at least, give to you a clue of how to proceed :)</p>\n"}], "owner": {"reputation": 3, "user_id": 9718644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccc50339bba460465a4b175e23fc04df?s=128&d=identicon&r=PG&f=1", "display_name": "Kev", "link": "https://stackoverflow.com/users/9718644/kev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1525825322, "creation_date": 1525817311, "last_edit_date": 1531161705, "question_id": 50242934, "link": "https://stackoverflow.com/questions/50242934/sum-product-for-all-the-months-if-2-tables-match", "title": "Sum product for all the months if 2 tables match", "body": "<p>So I have this issue, I have two tables one is employees, and another one is the projects.</p>\n\n<p>Employees Table:</p>\n\n<p>Year Name Type       Jan   Feb     </p>\n\n<p>2018 Kevin Salary    5000    2000</p>\n\n<p>2018 Kevin Insurance 200    400</p>\n\n<p>2018 Alex  Salary    3000    4000</p>\n\n<p>2018 Alex  Insurance 300      400</p>\n\n<p>Projects Table</p>\n\n<p>Year Project_Name  Employee_Name  Jan_Hours_Worked    Feb_Hours_Worked</p>\n\n<p>2018  Apple        Alex                7                   5</p>\n\n<p>2018  Apple        Kevin               5                   0</p>\n\n<p>2018  LG           Kevin               0                   3</p>\n\n<p>Now I am creating a result list of all the projects and costs recurred for them, what I need is for each project in Table 2 to find which employees are involved and then use that to find related costs for the employee from the Table 1 and calculate total costs for that project.</p>\n\n<p>(e.g for project LG, I have Kevin working on that in Feb,for him company paid 4400(salary+insurance) in Feb and the costs recurred for the LG project would be 4400 divided by hours spent on the project which Kevin in total spent 3 hours; e.g.2 for the project Apple it would be the same but sum of Kevin's and Alex's costs from Jan and Feb, so  Kevin: 5200/5 + Alex:3300/7 + 4400/5)</p>\n\n<p>Now I have the formula to calculate this for 1 months which is something like this </p>\n\n<p>=SUMPRODUCT(SUMIFS(Employees[Jan], Employees[Name],Project[Employee_Name], Employees[Year], 2018 )/Project[Jan_Hours_Worked],--(Project[Project_Name]=K14))</p>\n\n<p>I need to find how to get the yearly result per project without repeating the formula 12 times, also with this formula, i get div to 0 error when an employee didn't work on particular months, so that needs to be sorted somehow. Any Help?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1525813540, "post_id": 50242205, "comment_id": 87502071, "body": "We have no clue how your workbook is setup so there is no way we can really provide any solutions other than, add the 10 manually.   I you want to provide a bit more context on how the 10 sheets are named or some other way to distinguish them from the others then you will get a more robust answer."}, {"owner": {"reputation": 67, "user_id": 7977215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ea889061458b83edca6cf5a20c723c?s=128&d=identicon&r=PG&f=1", "display_name": "RealHelper", "link": "https://stackoverflow.com/users/7977215/realhelper"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1525814678, "post_id": 50242205, "comment_id": 87502553, "body": "Hi @Sorceri , For example they are name Part C (B), Part C (D), Part C (E).... Part C (M)"}, {"owner": {"reputation": 67, "user_id": 7977215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ea889061458b83edca6cf5a20c723c?s=128&d=identicon&r=PG&f=1", "display_name": "RealHelper", "link": "https://stackoverflow.com/users/7977215/realhelper"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1525814706, "post_id": 50242205, "comment_id": 87502563, "body": "I don&#39;t mind adding them manually only if i knew how to do it"}, {"owner": {"reputation": 67, "user_id": 7977215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ea889061458b83edca6cf5a20c723c?s=128&d=identicon&r=PG&f=1", "display_name": "RealHelper", "link": "https://stackoverflow.com/users/7977215/realhelper"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1525814870, "post_id": 50242205, "comment_id": 87502617, "body": "The other sheets are Part A, Part B and Part D. I dont want them in the dropdown"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1525815610, "post_id": 50242205, "comment_id": 87502902, "body": "so all the sheets you want to add have a ( in them and all the ones you don&#39;t want to add do not have a ( in them, correct?... ` ComboBox1.AddItem  ThisWorkbook.Sheets(&quot;Part C (B)&quot;)`"}, {"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1525816077, "post_id": 50242205, "comment_id": 87503089, "body": "Are you able to tell me the exact name for all the sheets and which ones you want listed?"}, {"owner": {"reputation": 67, "user_id": 7977215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ea889061458b83edca6cf5a20c723c?s=128&d=identicon&r=PG&f=1", "display_name": "RealHelper", "link": "https://stackoverflow.com/users/7977215/realhelper"}, "reply_to_user": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1525818015, "post_id": 50242205, "comment_id": 87503699, "body": "@Ricardo A the sheet names are Part C (B), Part C (D), Part C (E), Part C (D), Part C (E), Part C (F), Part C (G), Part C (H), Part C (J), Part C (K) Part C (L), Part C (M)"}, {"owner": {"reputation": 67, "user_id": 7977215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ea889061458b83edca6cf5a20c723c?s=128&d=identicon&r=PG&f=1", "display_name": "RealHelper", "link": "https://stackoverflow.com/users/7977215/realhelper"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1525818117, "post_id": 50242205, "comment_id": 87503728, "body": "Yes @Sorceri that is correct"}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 7977215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ea889061458b83edca6cf5a20c723c?s=128&d=identicon&r=PG&f=1", "display_name": "RealHelper", "link": "https://stackoverflow.com/users/7977215/realhelper"}, "edited": false, "score": 0, "creation_date": 1525817716, "post_id": 50242786, "comment_id": 87503629, "body": "Thank although it is only not showing &quot;Part A&quot;. Part B and D are still showing"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 67, "user_id": 7977215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ea889061458b83edca6cf5a20c723c?s=128&d=identicon&r=PG&f=1", "display_name": "RealHelper", "link": "https://stackoverflow.com/users/7977215/realhelper"}, "edited": false, "score": 0, "creation_date": 1525872424, "post_id": 50242786, "comment_id": 87526574, "body": "@RealHelper - See my edited answer and try again. I forgot &quot;&lt;&gt;&quot; does not work well for multiple statements in <code>Case</code>"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 2, "last_activity_date": 1525872393, "last_edit_date": 1525872393, "creation_date": 1525816475, "answer_id": 50242786, "question_id": 50242205, "link": "https://stackoverflow.com/questions/50242205/vba-dropown-to-navigate-to-a-sheet-workbook/50242786#50242786", "title": "VBA- Dropown to navigate to a sheet/workbook", "body": "<p>Based on this comment:</p>\n\n<blockquote>\n  <p>\"The other sheets are Part A, Part B and Part D. I dont want them in\n  the dropdown\"</p>\n</blockquote>\n\n<p>This will work</p>\n\n<pre><code>    For Each xSheet In ThisWorkbook.Sheets\n        Select Case xSheet.Name\n            Case Is = \"Part A\", \"Part B\", \"Part D\"\n            Case Else\n                ComboBox1.AddItem xSheet.Name\n        End Select\n    Next xSheet\n</code></pre>\n\n<p>You can easily modify the Select Case statement to create more conditions.</p>\n\n<p>You could also do something more complex like below for more pattern matching:</p>\n\n<pre><code>Select Case Instr(xSheet.Name, \"(\")\n    Case Is &gt; 0: ComboBox1.AddItem xSheet.Name\nEnd Select\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 67, "user_id": 7977215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ea889061458b83edca6cf5a20c723c?s=128&d=identicon&r=PG&f=1", "display_name": "RealHelper", "link": "https://stackoverflow.com/users/7977215/realhelper"}, "edited": false, "score": 0, "creation_date": 1525819301, "post_id": 50243180, "comment_id": 87504037, "body": "Thanks Man! Do you have a solution that includes specifc names of the sheet?"}, {"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "reply_to_user": {"reputation": 67, "user_id": 7977215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ea889061458b83edca6cf5a20c723c?s=128&d=identicon&r=PG&f=1", "display_name": "RealHelper", "link": "https://stackoverflow.com/users/7977215/realhelper"}, "edited": false, "score": 0, "creation_date": 1525820099, "post_id": 50243180, "comment_id": 87504238, "body": "I&#39;ve edited the answer to include specific sheet names."}, {"owner": {"reputation": 67, "user_id": 7977215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ea889061458b83edca6cf5a20c723c?s=128&d=identicon&r=PG&f=1", "display_name": "RealHelper", "link": "https://stackoverflow.com/users/7977215/realhelper"}, "edited": false, "score": 0, "creation_date": 1525829451, "post_id": 50243180, "comment_id": 87506221, "body": "can you tell me how to do default value for the Combo Box?"}], "tags": [], "owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1525819986, "last_edit_date": 1525819986, "creation_date": 1525819124, "answer_id": 50243180, "question_id": 50242205, "link": "https://stackoverflow.com/questions/50242205/vba-dropown-to-navigate-to-a-sheet-workbook/50243180#50243180", "title": "VBA- Dropown to navigate to a sheet/workbook", "body": "<p>Here you go.</p>\n\n<pre><code>Private Sub ComboBox1_Change()\n  If ComboBox1.ListIndex &gt; -1 Then Sheets(ComboBox1.Text).Select\nEnd Sub\nPrivate Sub ComboBox1_DropButtonClick()\n    Dim xSheet As Worksheet\n    On Error Resume Next\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n    If ComboBox1.ListCount &lt;&gt; ThisWorkbook.Sheets.Count Then\n        ComboBox1.Clear\n        For Each xSheet In ThisWorkbook.Sheets\n            If xSheet.Name Like \"Part C (*\" Then ComboBox1.AddItem xSheet.Name\n        Next xSheet\n    End If\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Specific Sheet Names on a Switch: (requested by OP)</p>\n\n<pre><code>Private Sub ComboBox1_DropButtonClick()\n    Dim xSheet As Worksheet\n    On Error Resume Next\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n    If ComboBox1.ListCount &lt;&gt; ThisWorkbook.Sheets.Count Then\n        ComboBox1.Clear\n        For Each xSheet In ThisWorkbook.Sheets\n            Select Case xSheet.Name\n                Case \"Part C (B)\", \"Part C (D)\", \"Part C (E)\", \"Part C (F)\", \"Part C (G)\", _\n                    \"Part C (H)\", \"Part C (J)\", \"Part C (K)\", \"Part C (L)\", \"Part C (K)\"\n                    ComboBox1.AddItem xSheet.Name\n            End Select\n        Next xSheet\n    End If\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>You can add, remove sheet names, if you decide to break the line, do not forget to use the \"_\" symbol to break it. (very common mistake)</p>\n"}], "owner": {"reputation": 67, "user_id": 7977215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ea889061458b83edca6cf5a20c723c?s=128&d=identicon&r=PG&f=1", "display_name": "RealHelper", "link": "https://stackoverflow.com/users/7977215/realhelper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 50243180, "answer_count": 2, "score": 1, "last_activity_date": 1526141991, "creation_date": 1525813281, "last_edit_date": 1525816414, "question_id": 50242205, "link": "https://stackoverflow.com/questions/50242205/vba-dropown-to-navigate-to-a-sheet-workbook", "title": "VBA- Dropown to navigate to a sheet/workbook", "body": "<pre><code>Private Sub ComboBox1_Change()\n  If ComboBox1.ListIndex &gt; -1 Then Sheets(ComboBox1.Text).Select\nEnd Sub\nPrivate Sub ComboBox1_DropButtonClick()\n    Dim xSheet As Worksheet\n    On Error Resume Next\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n    If ComboBox1.ListCount &lt;&gt; ThisWorkbook.Sheets.Count Then\n        ComboBox1.Clear\n        For Each xSheet In ThisWorkbook.Sheets\n            ComboBox1.AddItem xSheet.Name\n        Next xSheet\n    End If\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>This is what I have So far. At the moment it shows all my workbooks/sheets where as I only want it to show 10 specific sheets.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1525812769, "creation_date": 1525812769, "answer_id": 50242101, "question_id": 50241847, "link": "https://stackoverflow.com/questions/50241847/how-to-create-new-worksheet-based-on-filter-value-in-vba/50242101#50242101", "title": "How to create new worksheet based on filter value in VBA", "body": "<p>When using an Array to filter multiple results, use the 3rd parameter of <code>Operator:=xlFilterValues</code>.</p>\n\n<p>Try the line below:</p>\n\n<pre><code>Range(\"A:D\").AutoFilter Field:=4, Criteria1:=Array(\"Marth\", \"Rick\", \"Georgia\"), _\nOperator:=xlFilterValues\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 5530723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YcLId.jpg?s=128&g=1", "display_name": "ejdav", "link": "https://stackoverflow.com/users/5530723/ejdav"}, "is_accepted": false, "score": 0, "last_activity_date": 1525814496, "creation_date": 1525814496, "answer_id": 50242449, "question_id": 50241847, "link": "https://stackoverflow.com/questions/50241847/how-to-create-new-worksheet-based-on-filter-value-in-vba/50242449#50242449", "title": "How to create new worksheet based on filter value in VBA", "body": "<p>This code filters the source data (sheet1) for the first criteria \"marth\" and copy/pasting into the \"marth\" worksheet.  </p>\n\n<p>To complete the code you would need to build it out for each sheet by adding additional steps to filter,copy and paste.  Good Luck! </p>\n\n<pre><code>Sheets(\"Sheet1\").Select\nRange(\"A1\").Select\nSelection.AutoFilter\n\n'identifiers that need to be filtered from the full report\nActiveSheet.Range(\"A:D\").AutoFilter Field:=4, Criteria1:= _\nArray(\"Marth\"), Operator:=xlFilterValues\n\n\n'columns that need to be brought from full report to the group tab\nRange(\"A:D\").Copy\n\n'update for the sheet you are pasting to\nSheets(\"Marth\").Select\n\nRange(\"A1\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n:=False, Transpose:=False\nApplication.CutCopyMode = False\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 8635780, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a6a1f2938c54b10f5a34f00f775ebd18?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/8635780/jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 406, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1525814496, "creation_date": 1525811453, "last_edit_date": 1525812050, "question_id": 50241847, "link": "https://stackoverflow.com/questions/50241847/how-to-create-new-worksheet-based-on-filter-value-in-vba", "title": "How to create new worksheet based on filter value in VBA", "body": "<p>As you see below screenshot, I have a workbook with all user's information(left screenshot) . I would like to make separate worksheet based on name of team lead(right screenshot). My problem is team lead column value is always changed because I run a report from an application. </p>\n\n<p>but my actual code looks : </p>\n\n<pre><code>Range(\"A:D\").AutoFilter Field:=4, Array(\"Marth\", \"Rick\", \"Georgia\")\n</code></pre>\n\n<p>It would be appreciated if anyone could help me!</p>\n\n<p><a href=\"https://i.stack.imgur.com/PZev1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PZev1.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "hyperlink", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 5828093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fd601d81e7f40e450ce160a3aa42e98e?s=128&d=identicon&r=PG&f=1", "display_name": "cjhutton", "link": "https://stackoverflow.com/users/5828093/cjhutton"}, "edited": false, "score": 0, "creation_date": 1525877944, "post_id": 50242037, "comment_id": 87530665, "body": "Thank you so much! I was closer than I thought I was.   All I did was add &quot;Selection.HomeKey Unit:=wdLine, Extend:=wdExtend&quot; before you define TicketID. This automatically highlights the word to the left of the cursor. Mapping this macro to a shortcut key will save me a ton of time"}], "tags": [], "owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "is_accepted": true, "score": 1, "last_activity_date": 1525812889, "last_edit_date": 1525812889, "creation_date": 1525812432, "answer_id": 50242037, "question_id": 50241650, "link": "https://stackoverflow.com/questions/50241650/create-macro-to-make-text-into-hyperlink-concatenating-the-display-text-to-stand/50242037#50242037", "title": "Create macro to make text into hyperlink concatenating the display text to standard format", "body": "<p>This may work:</p>\n\n<pre><code>Sub textToHyperlink()\n'\n    Dim TicketID As String\n    TicketID = Selection.Range.Text \n    'You may need to clean up TicketID (remove &lt;CR&gt; etc.) before \n    'sticking it in the hyperlink. Depends on what's in Selection.\n\n    ' Not sure what this line does\n    ' ChangeFileOpenDirectory _\n        \"/Users/chris/Library/Containers/com.microsoft.Word/Data/Library/Preferences/AutoRecovery/\"\n    ActiveDocument.Hyperlinks.Add Anchor:=Selection.Range, Address:= _\n        \"https://someboringwebsite.com/WorkItem&amp;id=\" &amp; TicketID, SubAddress:=\"\", ScreenTip:=\"\", _\n        TextToDisplay:=TicketID\n\nEnd Sub\n</code></pre>\n\n<p>Hope that helps.</p>\n"}, {"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 1, "last_activity_date": 1525878157, "creation_date": 1525878157, "answer_id": 50256541, "question_id": 50241650, "link": "https://stackoverflow.com/questions/50241650/create-macro-to-make-text-into-hyperlink-concatenating-the-display-text-to-stand/50256541#50256541", "title": "Create macro to make text into hyperlink concatenating the display text to standard format", "body": "<p>The following is in response to your clarification in a comment (which I've incorporated into your question). There are two variations</p>\n\n<p>1) Following your premise, working with user input. Note that this will take the preceding word, no matter where it is in the text. And in the case the user may have typed a space (or many spaces) all spaces are removed from the end of that word. (These lines of code are commented out.)</p>\n\n<p>2) You (and the user) might find it simpler to work with an InputBox so that the user can type the ticket id directly - no worries about where it is in the text, or spaces, or anything. The hyperlink is inserted at the selection.</p>\n\n<pre><code>Sub textToHyperlink()\n'\n    Dim sID As String\n'    Dim rng As word.Range\n'\n'    Set rng = Selection.Range\n'    rng.MoveStart wdWord, -1\n'    sID = Trim(rng.Text)\n    sID = InputBox(\"Please enter the ticket ID\")\n    ActiveDocument.Hyperlinks.Add anchor:=rng, Address:= _\n        \"https://someboringwebsite.com/WorkItem&amp;id=\" &amp; sID, SubAddress:=\"\", ScreenTip:=\"\", _\n        TextToDisplay:=sID\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 5828093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fd601d81e7f40e450ce160a3aa42e98e?s=128&d=identicon&r=PG&f=1", "display_name": "cjhutton", "link": "https://stackoverflow.com/users/5828093/cjhutton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1054, "favorite_count": 0, "accepted_answer_id": 50242037, "answer_count": 2, "score": 2, "last_activity_date": 1525878229, "creation_date": 1525810618, "last_edit_date": 1525878229, "question_id": 50241650, "link": "https://stackoverflow.com/questions/50241650/create-macro-to-make-text-into-hyperlink-concatenating-the-display-text-to-stand", "title": "Create macro to make text into hyperlink concatenating the display text to standard format", "body": "<p>I have to create a large number of hyperlinks for ticket items where the only part of the URL that changes is the ticket ID. I am new to this and much of the VBA help is for excel. My problem exists in MS-word and its difficult to transfer the syntax. </p>\n\n<p>I expect the user to invoke the macro after entering a 6 digit Ticket ID. Ideally the macro would automatically select the last word typed by the user, and append it to the url segment which never changes.</p>\n\n<p>I attempted to record a macro that copies the last word typed then concatenates it onto the end of the standard URL. </p>\n\n<p>I can successfully do everything with keyboard shortcuts so I thought I would be set. The problem is the macro just uses the text from the recording example. It also turns my text to display to the example text. </p>\n\n<p>Turning any text into the link I used as an example in the recording. </p>\n\n<p>I can't figure out how to make VBA use the copied text for the text to display and the last 6 digits of the URL. </p>\n\n<p>Please see VBA syntax below </p>\n\n<pre><code>Sub textToHyperlink()\n'\n    Selection.HomeKey Unit:=wdLine, Extend:=wdExtend\n    Selection.Copy\n    ChangeFileOpenDirectory _\n        \"/Users/chris/Library/Containers/com.microsoft.Word/Data/Library/Preferences/AutoRecovery/\"\n    ActiveDocument.Hyperlinks.Add Anchor:=Selection.Range, Address:= _\n        \"https://someboringwebsite.com/WorkItem&amp;id=123456\", SubAddress:=\"\", ScreenTip:=\"\", _\n        TextToDisplay:=\"123456\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1525818180, "post_id": 50241456, "comment_id": 87503747, "body": "<a href=\"https://stackoverflow.com/a/48897439/4539709\">stackoverflow.com/a/48897439/4539709</a>"}, {"owner": {"reputation": 58, "user_id": 4455015, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vwitt.png?s=128&g=1", "display_name": "clarencebuttowski", "link": "https://stackoverflow.com/users/4455015/clarencebuttowski"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1525888124, "post_id": 50241456, "comment_id": 87536454, "body": "@0m3r thanks that is what I ended up using not sure why there is an issue with PasteSpecial but not with PasteAndFormat."}], "answers": [{"tags": [], "owner": {"reputation": 58, "user_id": 4455015, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vwitt.png?s=128&g=1", "display_name": "clarencebuttowski", "link": "https://stackoverflow.com/users/4455015/clarencebuttowski"}, "is_accepted": false, "score": 0, "last_activity_date": 1525812769, "creation_date": 1525812769, "answer_id": 50242100, "question_id": 50241456, "link": "https://stackoverflow.com/questions/50241456/copy-a-report-from-excel-to-outlook-as-a-bmp-and-the-sparklines-do-not-copy-over/50242100#50242100", "title": "Copy a report from Excel to Outlook as a BMP and the sparklines do not copy over", "body": "<p>This is the work around I came up with but I am not stoked. Would prefer to use wdPasteBitmap as the formatting is a little cleaner but I cannot figure out why it is dropping the sparklines.</p>\n\n<pre><code>wordDoc.Range.PasteAndFormat wdChartPicture\nwordDoc.Application.ActiveDocument.InlineShapes(1).Width = 850\nwordDoc.Application.ActiveDocument.InlineShapes(1).Height = 950\n</code></pre>\n"}], "owner": {"reputation": 58, "user_id": 4455015, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vwitt.png?s=128&g=1", "display_name": "clarencebuttowski", "link": "https://stackoverflow.com/users/4455015/clarencebuttowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 232, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1592993476, "creation_date": 1525809745, "last_edit_date": 1592993476, "question_id": 50241456, "link": "https://stackoverflow.com/questions/50241456/copy-a-report-from-excel-to-outlook-as-a-bmp-and-the-sparklines-do-not-copy-over", "title": "Copy a report from Excel to Outlook as a BMP and the sparklines do not copy over", "body": "<p>I am copying a report dashboard from Excel into Outlook and the sparkline charts in column J do not copy over. When I step through the code it appears that they are being copied and pasted as an image. </p>\n\n<p>When I export the same report to SharePoint as a BMP the sparklines do appear. </p>\n\n<p>I cannot figure out what the issue is. Any help trouble shooting would be appreciated. </p>\n\n<p>*** Edit: The issue appears to be with this line wordDoc.Range.PasteSpecial , , , , wdPasteBitmap </p>\n\n<p>What would be a better paste method that appears clear and not blurry?</p>\n\n<p>The code is shown below:</p>\n\n<pre><code>Sub Mail()\n\nDim OutApp As Object\nDim OutMail As Object\n\n'Unprotect Scorecard\nWorksheets(\"Scorecard\").Unprotect\n\n With Application\n    .EnableEvents = False\n    .ScreenUpdating = False\nEnd With\n\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\n\nOn Error Resume Next\n\nWith OutMail\n    .To = \"email@email.com&gt;\"\n    .CC = \"\"\n    .BCC = \"\"\n    .Subject = \"Report\"\n    '.HTMLBody =\n    .Display   'or use .Send\n\n    Dim wordDoc As Object\n    Set wordDoc = OutMail.GetInspector.WordEditor\n\n    Worksheets(\"Scorecard\").Activate\n\n    Set Plage = ThisWorkbook.Worksheets(\"Scorecard\").Range(\"B1:M62\")\n    Plage.CopyPicture\n\n    With ThisWorkbook.Worksheets(\"Scorecard\").ChartObjects.Add(Plage.Left, Plage.Top, Plage.Width, Plage.Height)\n        .Activate\n        .Chart.Paste\n        .Chart.ChartArea.Border.LineStyle = xlNone\n    End With\n    Worksheets(\"Scorecard\").ChartObjects(Worksheets(\"Scorecard\").ChartObjects.Count).Copy\n    wordDoc.Range.PasteSpecial , , wdInline, , wdPasteBitmap\n    Worksheets(\"Scorecard\").ChartObjects(Worksheets(\"Scorecard\").ChartObjects.Count).Delete\n\n    Application.CutCopyMode = False\n    wordDoc.Range.InsertBefore vbLf\n    wordDoc.Range.InsertBefore vbLf\n    wordDoc.Hyperlinks.Add Anchor:=wordDoc.Range(0, 0), Address:=\"http://sharepoint.com\", TextToDisplay:=\"archive\"\n    wordDoc.Range.InsertBefore vbLf\n    wordDoc.Hyperlinks.Add Anchor:=wordDoc.Range(0, 0), Address:=\"http://sharepoint.com\", TextToDisplay:=\"web version\"\n\nEnd With\nOn Error GoTo 0\n\nWith Application\n    .EnableEvents = True\n    .ScreenUpdating = True\nEnd With\n\nSet OutMail = Nothing\nSet OutApp = Nothing\n\n'Protect\nWorksheets(\"Scorecard\").Protect DrawingObjects:=True, Contents:=True, Scenarios:=True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4740, "user_id": 1148564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eQICm.jpg?s=128&g=1", "display_name": "Joseph", "link": "https://stackoverflow.com/users/1148564/joseph"}, "edited": false, "score": 0, "creation_date": 1525809609, "post_id": 50241350, "comment_id": 87500391, "body": "Have you tried fully qualifying the Workbook name in the second module? For example, <code>Sheets(&quot;Projects&quot;)</code> to <code>Workbooks(&quot;MyWorkbook&quot;).Sheets(&quot;Projects&quot;)</code>"}, {"owner": {"reputation": 147, "user_id": 9446506, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-ysBC7WQsCUI/AAAAAAAAAAI/AAAAAAAAFPw/OFpVp5M12OI/photo.jpg?sz=128", "display_name": "Remi", "link": "https://stackoverflow.com/users/9446506/remi"}, "reply_to_user": {"reputation": 4740, "user_id": 1148564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eQICm.jpg?s=128&g=1", "display_name": "Joseph", "link": "https://stackoverflow.com/users/1148564/joseph"}, "edited": false, "score": 0, "creation_date": 1525810257, "post_id": 50241350, "comment_id": 87500689, "body": "@JosephSerido It caused a script out of range error when I tried your suggestion."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1525810511, "post_id": 50241350, "comment_id": 87500820, "body": "that&#39;s &quot;subscript&quot;, i.e. the index supplied doesn&#39;t exist in the collection. Likely &quot;MyWorkbook&quot; isn&#39;t it and you mean to work with <code>ThisWorkbook</code> instead, rather than whatever workbook is currently active (unqualified <code>Sheets</code> implicitly refers to <code>ActiveWorkbook</code>)."}, {"owner": {"reputation": 4740, "user_id": 1148564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eQICm.jpg?s=128&g=1", "display_name": "Joseph", "link": "https://stackoverflow.com/users/1148564/joseph"}, "edited": false, "score": 0, "creation_date": 1525810731, "post_id": 50241350, "comment_id": 87500912, "body": "What is calling <code>NewDatabaseEntry</code>? Is it a worksheet event? If so, you should turn off events until you finished your data manipulation in the second module."}, {"owner": {"reputation": 147, "user_id": 9446506, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-ysBC7WQsCUI/AAAAAAAAAAI/AAAAAAAAFPw/OFpVp5M12OI/photo.jpg?sz=128", "display_name": "Remi", "link": "https://stackoverflow.com/users/9446506/remi"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1525810838, "post_id": 50241350, "comment_id": 87500969, "body": "@MathieuGuindon Still doesn&#39;t work. Changed to <code>LastRow = Workbooks(&quot;ThisWorkbook&quot;).Sheets(&quot;Projects&quot;)...</code>"}, {"owner": {"reputation": 147, "user_id": 9446506, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-ysBC7WQsCUI/AAAAAAAAAAI/AAAAAAAAFPw/OFpVp5M12OI/photo.jpg?sz=128", "display_name": "Remi", "link": "https://stackoverflow.com/users/9446506/remi"}, "reply_to_user": {"reputation": 4740, "user_id": 1148564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eQICm.jpg?s=128&g=1", "display_name": "Joseph", "link": "https://stackoverflow.com/users/1148564/joseph"}, "edited": false, "score": 0, "creation_date": 1525811045, "post_id": 50241350, "comment_id": 87501071, "body": "@JosephSerido If that doesn&#39;t run, there is no new row to be found."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1525811230, "post_id": 50241350, "comment_id": 87501155, "body": "Drop the <code>Workbooks(...)</code> part - if the <code>Projects</code> sheet exists at compile-time in <code>ThisWorkbook</code>, then give that <code>Projects</code> sheet a <i>code name</i> (change its <code>(Name)</code> property in the <i>properties</i> toolwindow (F4)), and then refer to it by its code name - e.g. <code>ProjectsSheet.Cells.Find(...)</code> - there&#39;s never a good reason to dereference a worksheet from <code>ThisWorkbook</code> through the <code>Workheets</code> (or worse, <code>Sheets</code>) collection. FWIW what I meant was <code>ThisWorkbook.Worksheets(&quot;Projects&quot;)</code>, not <code>Workbooks(&quot;ThisWorkbook&quot;)...</code>"}, {"owner": {"reputation": 147, "user_id": 9446506, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-ysBC7WQsCUI/AAAAAAAAAAI/AAAAAAAAFPw/OFpVp5M12OI/photo.jpg?sz=128", "display_name": "Remi", "link": "https://stackoverflow.com/users/9446506/remi"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1525812297, "post_id": 50241350, "comment_id": 87501616, "body": "@MathieuGuindon Okay so I changed to <code>ThisWorkbook.Worksheets(&quot;Projects&quot;),,,</code> and it still runs in a loop until I click No."}], "answers": [{"tags": [], "owner": {"reputation": 4740, "user_id": 1148564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eQICm.jpg?s=128&g=1", "display_name": "Joseph", "link": "https://stackoverflow.com/users/1148564/joseph"}, "is_accepted": false, "score": 0, "last_activity_date": 1525811303, "creation_date": 1525811303, "answer_id": 50241806, "question_id": 50241350, "link": "https://stackoverflow.com/questions/50241350/conflict-between-modules-excel-vba/50241806#50241806", "title": "Conflict between Modules Excel VBA", "body": "<p>Since you mention that this gets stuck in an infinite loop to ask if they want to create a new project, I believe that the reason is because you have a <code>Worksheet_Change</code> event (or similar) that fires off when you add a value to the <code>Projects</code> worksheet.</p>\n\n<p>The problem comes in when you have your <code>FindProject</code> manipulating data on the same worksheet that your <code>Worksheet_Change</code> event is looking for.</p>\n\n<p>So what I believe you should do is turn off events until <code>FindProject</code> is done (by the way, I would recommend changing <code>FindProject</code> to something else because it does more than just \"find a project\").</p>\n\n<pre><code>Sub FindRow()\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False ' ADDED THIS\n    Dim LastRow As Long\n    LastRow = Sheets(\"Projects\").Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n    Dim rng As Range\n    Dim foundRng As Range\n    For Each rng In Sheets(\"Projects\").Range(\"B2:B\" &amp; LastRow)\n        Set foundRng = Sheets(\"Database\").Range(\"C:C\").Find(rng, LookIn:=xlValues, lookat:=xlWhole)\n        If Not foundRng Is Nothing Then\n            rng.Offset(0, -1) = foundRng.Row\n        End If\n    Next rng\n    Application.EnableEvents = True ' ADDED THIS\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 9446506, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-ysBC7WQsCUI/AAAAAAAAAAI/AAAAAAAAFPw/OFpVp5M12OI/photo.jpg?sz=128", "display_name": "Remi", "link": "https://stackoverflow.com/users/9446506/remi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1525811303, "creation_date": 1525809294, "question_id": 50241350, "link": "https://stackoverflow.com/questions/50241350/conflict-between-modules-excel-vba", "title": "Conflict between Modules Excel VBA", "body": "<p>The two modules below always run in a loop.\nI want the second module for verification that a record was created after the first module runs, since all the user sees is the question, but not the result.</p>\n\n<p>First module detects when new row is added to a table and asks if you want to export data to another worksheet:</p>\n\n<pre><code>Sub NewDatabaseEntry() \n\nDim sh As Worksheet\nDim rspn As VbMsgBoxResult\n\nrspn = MsgBox(\"Do you want to create a project? If you did not add a new row, click No\", vbYesNo)\nIf rspn = vbNo Then Exit Sub       \n        Range(\"MasterTemplate\").Copy\n        Sheets(\"Database\").Range(\"C\" &amp; Rows.Count).End(xlUp).Offset(1).PasteSpecial Paste:=xlPasteFormulas\n\nFindProjectName 'A macro that literally finds the name of the project...\n'FindRow\nEnd Sub\n</code></pre>\n\n<p>This module then looks at the row number on the destination worksheet and then copies that row number value to a predefined range.</p>\n\n<pre><code>Sub FindRow()\n\n    Application.ScreenUpdating = False\n    Dim LastRow As Long\n    LastRow = Sheets(\"Projects\").Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n    Dim rng As Range\n    Dim foundRng As Range\n    For Each rng In Sheets(\"Projects\").Range(\"B2:B\" &amp; LastRow)\n        Set foundRng = Sheets(\"Database\").Range(\"C:C\").Find(rng, LookIn:=xlValues, lookat:=xlWhole)\n        If Not foundRng Is Nothing Then\n            rng.Offset(0, -1) = foundRng.Row\n        End If\n    Next rng\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>The only way <code>FindRow</code> works is when I place it in the <code>ThisWorkbook~ Excel Object.\nIf I place it anywhere else, it gets into a loop with the NewDatabaseEntry module where it keeps asking you if you</code>want to create a new project.`\nI would've liked for the user to know that the entry was created without having to close out of the workbook and then reopening it, just to verify what row number their record was placed on.</p>\n\n<p>Is there something I am missing?</p>\n"}, {"tags": ["excel", "vba", "function", "msgbox"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1525809416, "post_id": 50241192, "comment_id": 87500289, "body": "This isn&#39;t very clear. Perhaps showing your code would help. In any event, you can make your own user form if neither <code>MsgBox</code> nor the built-in file-picker works to your satisfaction. For information on how to use the file picker function see this: <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/application-filedialog-property-excel\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/vba/excel-vba/articles/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 9318346, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215773691394687/picture?type=large", "display_name": "Jreya Kyong", "link": "https://stackoverflow.com/users/9318346/jreya-kyong"}, "edited": false, "score": 0, "creation_date": 1525872608, "post_id": 50247423, "comment_id": 87526716, "body": "Thank you so much!! I have one question If I wanted to use the file name (for thisWorkbook.activate) would I use path.activate?Also thank you once again!!"}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "reply_to_user": {"reputation": 65, "user_id": 9318346, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215773691394687/picture?type=large", "display_name": "Jreya Kyong", "link": "https://stackoverflow.com/users/9318346/jreya-kyong"}, "edited": false, "score": 1, "creation_date": 1525872942, "post_id": 50247423, "comment_id": 87526960, "body": "The dialog simply selects a file in a folder and returns its path as a string. If you want to open the selected file, use <code>Workbooks.Open(path)</code>."}, {"owner": {"reputation": 65, "user_id": 9318346, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215773691394687/picture?type=large", "display_name": "Jreya Kyong", "link": "https://stackoverflow.com/users/9318346/jreya-kyong"}, "edited": false, "score": 0, "creation_date": 1525879227, "post_id": 50247423, "comment_id": 87531534, "body": "I saw it passing as a string, I was just wondering if I was correct in connecting path as the holding the name. Thanks again!!"}], "tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": true, "score": 1, "last_activity_date": 1525849626, "creation_date": 1525849626, "answer_id": 50247423, "question_id": 50241192, "link": "https://stackoverflow.com/questions/50241192/excel-vba-open-msg-title/50247423#50247423", "title": "Excel VBA Open Msg Title", "body": "<p>I believe you are looking for a <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/application-filedialog-property-excel\" rel=\"nofollow noreferrer\">FileDialog</a> as per John's comment.</p>\n\n<p>The example below will show a FileDialog and return the path of the file selected. If the dialog is cancelled, the return value will be <code>vbNullString</code>.</p>\n\n<p>You could pass the default path as a parameter to the function as well as the file extension for the Filter.</p>\n\n<hr>\n\n<pre><code>Public Function OpenFileDialogToString() As String\n    On Error GoTo Trap\n\n    Dim fd As FileDialog\n    Set fd = Application.FileDialog(msoFileDialogFilePicker)\n\n    With fd\n        .Title = \"Dialog Title\"\n        .InitialFileName = \"Dialog start-up path\"\n        .Filters.Clear\n        .Filters.Add \"Text Documents (*.txt)\", \"*.txt\", 1\n        .ButtonName = \" Open \"\n        .AllowMultiSelect = False\n    End With\n\n    If fd.Show &lt;&gt; 0 Then OpenFileDialogToString = fd.SelectedItems(1)\n\nLeave:\n    Set fd = Nothing\n    On Error GoTo 0\nExit Function\n\nTrap:\n    MsgBox Err.Description, vbCritical \n    Resume Leave\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>To call it:</p>\n\n<pre><code>Dim path As String\npath = OpenFileDialogToString()\n\nIf path &lt;&gt; vbNullString Then Debug.Print path\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 9318346, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215773691394687/picture?type=large", "display_name": "Jreya Kyong", "link": "https://stackoverflow.com/users/9318346/jreya-kyong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 50247423, "answer_count": 1, "score": 0, "last_activity_date": 1525849626, "creation_date": 1525808578, "question_id": 50241192, "link": "https://stackoverflow.com/questions/50241192/excel-vba-open-msg-title", "title": "Excel VBA Open Msg Title", "body": "<p>I'm trying to prompt the user to open a file, but the title says something other than Open. I know that there exists MsgBox and a function to prompt open(that I'm not familiar with). I was wondering if there exists some combination of the MsgBox and that function so that instead of the open title on the open prompt I can insert my own instruction. The file collected from this function would then be collected for later use.</p>\n\n<p>I'm trying to avoid inserting both the MsgBox and another function for the open prompt. If this is possible any assistance is appreciated, if not thank you anyways. </p>\n"}, {"tags": ["excel", "commandbutton", "memory-efficient", "vba"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1525810121, "post_id": 50240928, "comment_id": 87500626, "body": "Are you saying you are planning to create 4 buttons for each row, so in total more than 1000 buttons."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1525816919, "post_id": 50240928, "comment_id": 87503405, "body": "Adding 4 buttons per row, for many rows will make everything very slow, just because of the objects themselves, never mind their functionality. When I had to make similar functionality, I would create &quot;clickable cells&quot; - if columns <code>A to K</code> contain data, I&#39;d make columns <code>L to O</code> clickable (distinct background color as well), using <code>SelectionChange()</code> event allows you to determine the coordinates of each cell, and to build specific actions depending on current row. This approach is much more effective and scalable"}, {"owner": {"reputation": 1, "user_id": 9741922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55f329f088bbfbaa9364ae657a65f961?s=128&d=identicon&r=PG&f=1", "display_name": "Perry Kendrick", "link": "https://stackoverflow.com/users/9741922/perry-kendrick"}, "edited": false, "score": 0, "creation_date": 1525864797, "post_id": 50240928, "comment_id": 87521318, "body": "Yes Storax if I were to do buttons it would be around 1200 total buttons maybe more, but thanks to Paul I will work on doing the clickable cells and see if it is possible to still have the functions I am trying to use in the overall document. Thank you."}, {"owner": {"reputation": 1, "user_id": 9741922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55f329f088bbfbaa9364ae657a65f961?s=128&d=identicon&r=PG&f=1", "display_name": "Perry Kendrick", "link": "https://stackoverflow.com/users/9741922/perry-kendrick"}, "edited": false, "score": 0, "creation_date": 1525867045, "post_id": 50240928, "comment_id": 87522759, "body": "Paul with your suggestion, how do I get it so that if I click a cell in column K, the macro will only run in the corresponding row. Example I was originally doing a TIME IN button. This button when clicked would log time in and place the words &quot;IN PROGRESS&quot; in another column on the same row. I can make the clickable cells for an entire column run a macro but I don&#39;t know how to make it so that when K5 is clicked IN PROGRESS shows in M5 and time shows in O5 without making each individual macro and coding each individual cell, which I think takes up the same amount of space in memory. Advice?"}], "answers": [{"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 0, "last_activity_date": 1525907831, "last_edit_date": 1525907831, "creation_date": 1525907251, "answer_id": 50263279, "question_id": 50240928, "link": "https://stackoverflow.com/questions/50240928/creating-large-numbers-of-command-buttons-and-writing-more-efficiently/50263279#50263279", "title": "Creating large numbers of command buttons and writing more efficiently", "body": "<p>Example for \"clickable cells\" mentioned in my first comment</p>\n\n<blockquote>\n  <p><em>...If columns A to K contain data, I'd make columns L to O clickable</em>\n  <em>(distinct background color as well), using SelectionChange() event</em>\n  <em>allows you to determine the coordinates of each cell, and to build</em>\n  <em>specific actions depending on current row</em></p>\n</blockquote>\n\n<hr>\n\n<p>Place this <code>Sub</code> in <strong><code>ThisWorkbook</code></strong> module</p>\n\n<pre><code>Option Explicit\n\n'In ThisWorkbook module - Sh parameter contains the sheet being used (ActiveSheet)\nPrivate Sub Workbook_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)\n    With Target\n        Select Case Sh.Name\n            Case \"Sheet1\", \"Sheet2\", \"Sheet3\"   'Processing the first 3 sheets\n                If .Row &gt; 1 And .CountLarge = 1 Then 'Ignore Headers &amp; multiple cells\n                    Select Case .Column\n                        Case 1 To 4         'Ignore col A to D\n                            .Interior.Color = RGB(255, 204, 204)    'Revert to initial\n                            .Font.ColorIndex = xlAutomatic  'Default Black\n                        Case 5              'Mouse clicked in a cell in col E\n                            With Sh.Cells(.Row, \"A\")    'Change cell in same row, col A\n                                .Interior.Color = RGB(190, 0, 0)    'Dark Red\n                                .Font.Color = vbYellow\n                            End With\n                            .Interior.Color = RGB(255, 255, 204)    'Light Yellow\n                            .Font.Color = vbRed     'current cell (in column E)\n                            .Font.Bold = True\n                        Case 6              'Mouse clicked in a cell in col F\n                            With Sh.Cells(.Row, \"B\")    'Change cell in same row, col B\n                                .Interior.Color = RGB(0, 0, 190)    'Dark Blue\n                                .Font.Color = vbYellow\n                            End With\n                            .Interior.Color = RGB(255, 255, 204)    'Light Yellow\n                            .Font.Color = vbRed\n                            .Font.Bold = True\n                        Case 7              'Mouse clicked in a cell in col G\n                            If Len(.Value2) &gt; 0 Then\n                                With Sh.Cells(.Row, \"C\")    'Cell in same row, col B\n                                    .Interior.Color = RGB(255, 255, 0)  'vbYellow\n                                    .Font.Color = RGB(190, 0, 0)        'Dark Red\n                                End With\n                            End If\n                        Case 8\n                            .Value = Format(Now, \"ddd mm-dd-yyyy\")\n                            .Font.Bold = True\n                            .Offset(, 1).Value2 = \"In Progress\"\n                    End Select\n                End If\n            Case \"Sheet4\", \"Sheet5\"\n                '...\n        End Select\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>.</p>\n\n<p>Result, after clicking individual cells in columns E to H</p>\n\n<hr>\n\n<p><strong><code>Sheet1</code></strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/g3I8g.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/g3I8g.png\" alt=\"Sheet1\"></a></p>\n\n<p><strong><code>Sheet2</code></strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/WtVOI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WtVOI.png\" alt=\"Sheet2\"></a></p>\n\n<p><strong><code>Sheet3</code></strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/k3iTc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/k3iTc.png\" alt=\"Sheet3\"></a></p>\n\n<hr>\n\n<p>.</p>\n\n<p>Another way to detect current selection</p>\n\n<hr>\n\n<pre><code>Option Explicit\n\n'In Sheet1 module\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Not Intersect(Target, Me.UsedRange.Columns(1)) Is Nothing Then\n        MsgBox \"Clicked cell in Column 'A', Row: \" &amp; Target.Row\n    End If\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Message Box when clicking <code>Sheet1.Cell(A5)</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/1zUar.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1zUar.png\" alt=\"MsgBoxForA5\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9741922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55f329f088bbfbaa9364ae657a65f961?s=128&d=identicon&r=PG&f=1", "display_name": "Perry Kendrick", "link": "https://stackoverflow.com/users/9741922/perry-kendrick"}, "is_accepted": false, "score": 0, "last_activity_date": 1525951365, "creation_date": 1525951365, "answer_id": 50271785, "question_id": 50240928, "link": "https://stackoverflow.com/questions/50240928/creating-large-numbers-of-command-buttons-and-writing-more-efficiently/50271785#50271785", "title": "Creating large numbers of command buttons and writing more efficiently", "body": "<p>Thanks a lot Paul. I ended up going with this:</p>\n\n<p><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As \n    Boolean)\n    Application.EnableEvents = False\n    On Error GoTo Xit\n    If Target.Column = 11 Then\n      Cancel = True\n      Target.Offset(, 2).Value = \"IN PROGRESS\"\n      Target.Offset(, 4).Value = Time\n    ElseIf Target.Column = 12 Then\n      Cancel = True\n      Target.Offset(, 1).Value = \"COMPLETE\"\n      Target.Offset(, 4).Value = Time\n    ElseIf Target.Column = 14 Then\n      Cancel = True\n      Target.Offset(, -1).Value = \"PARTIAL HOLD\"\n      Target.Offset(, 3).Value = Time\n    End If\n    Xit:\n    Application.EnableEvents = True\n    End Sub</code></p>\n"}], "owner": {"reputation": 1, "user_id": 9741922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55f329f088bbfbaa9364ae657a65f961?s=128&d=identicon&r=PG&f=1", "display_name": "Perry Kendrick", "link": "https://stackoverflow.com/users/9741922/perry-kendrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 108, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1525951365, "creation_date": 1525807400, "last_edit_date": 1531164843, "question_id": 50240928, "link": "https://stackoverflow.com/questions/50240928/creating-large-numbers-of-command-buttons-and-writing-more-efficiently", "title": "Creating large numbers of command buttons and writing more efficiently", "body": "<p>I am working on an Excel VBA project with 300 rows that will be filled with outgoing orders daily. There are going to be 4 command buttons and various macros for each row. The first is \"TIME IN\" this will log when the order started as well as place the words \"IN PROGRESS\" in a column on sheet 1. The next button will be \"TIME OUT\" when clicked this will log time of completion place the word \"COMPLETE\" in the proper column and move the entire row to a separate workbook. The third button will be \"HOLD\" this will log the time a hold is placed on loading, move the entire row to sheet 3 of the same workbook and put the words \"PARTIAL HOLD\" in the appropriate column. The fourth button will be on sheet 3 it will be a \"RESUME\" button. This button will send the row from sheet 3 back to sheet 1 with the words \"IN PROGRESS\" in the appropriate column. My question is, is it possible to make these buttons and respective macros in bulk or do I have to make each individual button and macro that goes along with it? If it is possible to do it in bulk could you please tell me how. Below is an example of the code for the command buttons and the correlated macros for each button that I have created so far individually. All of them have the same basic code and macro associated. Thank you for helping me write more efficiently.\nCommand button</p>\n\n<pre><code>Private Sub HOLD1_Click()\nSheet1.Cells(5, 17).Value = Format$(Now, \"hh:nn:ss\")\nHOLD_1\nEnd Sub\n</code></pre>\n\n<p>Macro</p>\n\n<pre><code>Sub HOLD_1()\n'\n' HOLD_1 Macro\n'\n\n'\nRange(\"M5\").Select\nActiveCell.FormulaR1C1 = \"PARTIAL HOLD\"\nRange(\"M6\").Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "excel-match", "excel-tables", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1525807340, "post_id": 50240855, "comment_id": 87499217, "body": "so even though Kevin worked on both the Apple would be 5200/5+3300/7?"}, {"owner": {"reputation": 3, "user_id": 9718644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccc50339bba460465a4b175e23fc04df?s=128&d=identicon&r=PG&f=1", "display_name": "Kev", "link": "https://stackoverflow.com/users/9718644/kev"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1525807576, "post_id": 50240855, "comment_id": 87499343, "body": "Yes for the project Apple the cost will be : 5200/5(from Kevin) + 3300/7(from Alex)"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9718644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccc50339bba460465a4b175e23fc04df?s=128&d=identicon&r=PG&f=1", "display_name": "Kev", "link": "https://stackoverflow.com/users/9718644/kev"}, "edited": false, "score": 0, "creation_date": 1525809764, "post_id": 50241009, "comment_id": 87500467, "body": "Thanks Scott, what you mean by &quot;The references to the second table must be limited to the data set.&quot;?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 3, "user_id": 9718644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccc50339bba460465a4b175e23fc04df?s=128&d=identicon&r=PG&f=1", "display_name": "Kev", "link": "https://stackoverflow.com/users/9718644/kev"}, "edited": false, "score": 0, "creation_date": 1525810001, "post_id": 50241009, "comment_id": 87500571, "body": "Looking my formula, there are some references that are full columns and others that are not, because of the way the formula evaluates we need to limit some of the references to limit the number of iterations.  Those that are full column (References to the first table) can remain full column without detriment.  Those that are limited (References to the second table) must remain limited to the actual data set, do not use full column references.  This part will iterate one by one through all the cells and if you use full columns it will do over 3 million calculations per instance."}, {"owner": {"reputation": 3, "user_id": 9718644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccc50339bba460465a4b175e23fc04df?s=128&d=identicon&r=PG&f=1", "display_name": "Kev", "link": "https://stackoverflow.com/users/9718644/kev"}, "edited": false, "score": 0, "creation_date": 1525811704, "post_id": 50241009, "comment_id": 87501373, "body": "Thanks a lot this seems to work except I use a tables with column names and my references doesn&#39;t work properly : so the code is something like this now   =SUMPRODUCT(SUMIF(Employees[Employee], Project[Employee], Employees[Jan])/Project[Jan],--(Project[Name]=K14)),  could you please let me know how to do the correct referencing to the cells? Also one more thing, I do this calculation for each month (I have 12 separate columns in both tables for each months in place of the amount and hours worked) is there any way I can also sum all 12 months  together?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 3, "user_id": 9718644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccc50339bba460465a4b175e23fc04df?s=128&d=identicon&r=PG&f=1", "display_name": "Kev", "link": "https://stackoverflow.com/users/9718644/kev"}, "edited": false, "score": 0, "creation_date": 1525814219, "post_id": 50241009, "comment_id": 87502346, "body": "the formula works for me if I make it tables and name the columns correctly.  As to the full year thing that is a new question and will change the formula significantly."}, {"owner": {"reputation": 3, "user_id": 9718644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccc50339bba460465a4b175e23fc04df?s=128&d=identicon&r=PG&f=1", "display_name": "Kev", "link": "https://stackoverflow.com/users/9718644/kev"}, "edited": false, "score": 0, "creation_date": 1525814941, "post_id": 50241009, "comment_id": 87502648, "body": "Yes thanks, I was thinking off just adding up this formula 12 times for each months(not so efficient probably), also I found the problem, since I am doing this for the whole year, there is a chance that in some months employee didn&#39;t work on the project, therefore,  in division, it gives me an error. Any help on this?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 3, "user_id": 9718644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccc50339bba460465a4b175e23fc04df?s=128&d=identicon&r=PG&f=1", "display_name": "Kev", "link": "https://stackoverflow.com/users/9718644/kev"}, "edited": false, "score": 0, "creation_date": 1525815303, "post_id": 50241009, "comment_id": 87502796, "body": "This question has been answered.  You are asking a whole new question.  Please mark this as correct if it answered this question and ask a new one with your new requirements."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1525807722, "creation_date": 1525807722, "answer_id": 50241009, "question_id": 50240855, "link": "https://stackoverflow.com/questions/50240855/search-returned-value-in-another-table-excel/50241009#50241009", "title": "Search returned value in another table excel", "body": "<p>Your formula would use SUMPRODUCT and SUMIFS:</p>\n\n<pre><code>=SUMPRODUCT(SUMIF(B:B,$H$2:$H$4,D:D)/$I$2:$I$4,--($G$2:$G$4=K2))\n</code></pre>\n\n<p>The references to the second table must be limited to the data set.</p>\n\n<p><a href=\"https://i.stack.imgur.com/m80Vy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/m80Vy.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 9718644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccc50339bba460465a4b175e23fc04df?s=128&d=identicon&r=PG&f=1", "display_name": "Kev", "link": "https://stackoverflow.com/users/9718644/kev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 1, "accepted_answer_id": 50241009, "answer_count": 1, "score": -1, "last_activity_date": 1525807865, "creation_date": 1525807038, "last_edit_date": 1531161705, "question_id": 50240855, "link": "https://stackoverflow.com/questions/50240855/search-returned-value-in-another-table-excel", "title": "Search returned value in another table excel", "body": "<p>So I have this issue, I have two tables one is employees,  and another one is the projects. </p>\n\n<p><strong>Table Employees:</strong></p>\n\n<pre><code>Year Name Type       Amount    \n2018 Kevin Salary    5000    \n2018 Kevin Insurance 200    \n2018 Alex  Salary    3000    \n2018 Alex  Insurance 300\n</code></pre>\n\n<p><strong>Projects Table</strong></p>\n\n<pre><code>Year Project_Name  Employee_Name  Hours_Worked    \n2018  Apple        Alex                7    \n2018  Apple        Kevin               5    \n2018  LG           Kevin               3 \n</code></pre>\n\n<p>Now I am creating a result list of all the projects and costs recurred for them, what I need is for each project in the Table 2 find which employees are involved and then use that information to find related costs for the employee and calculate total costs for that project.</p>\n\n<p>(e.g for project LG, I have Kevin working on that,for him company paid 5200(salary+insurance) and the  costs recurred for the LG project would be 5200 divided by hours spent on the project, for the project Apple it would be the same but sum of Kevin's and Alex's costs recurred)</p>\n\n<p>I have tried several things but didn't work, is there a way to lookup project name in one table and use the returned value(employees) to get the related costs from another Table ? </p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 9760679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71edb25e188b5719163f835bbc50d5f9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Lee", "link": "https://stackoverflow.com/users/9760679/mike-lee"}, "edited": false, "score": 0, "creation_date": 1525806745, "post_id": 50240755, "comment_id": 87498933, "body": "first time posting on this site and it took the second half of my code and put it in that gray box, not sure why it only got that half but i can repost if this is too strenuous on the eyes"}, {"owner": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "edited": false, "score": 0, "creation_date": 1525807364, "post_id": 50240755, "comment_id": 87499226, "body": "I could be wrong here, but it looks like this line is wrong somehow: <code>LEFT JOIN (Contacts  RIGHT JOIN Jobs ON Contacts.ContactID = Jobs.ContactID) ON Invoices.JobNo = Jobs.JobNo)</code>"}, {"owner": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "edited": false, "score": 0, "creation_date": 1525807480, "post_id": 50240755, "comment_id": 87499297, "body": "Oh and the symbol you may be referring to is the &#39;pipe&#39; &quot;|&quot; it&#39;s the shifted version of the &#39;\\&#39;-key"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1525818235, "post_id": 50240755, "comment_id": 87503763, "body": "<a href=\"http://stackoverflow.com/a/1099570/3820271\">How to debug dynamic SQL in VBA</a> -- You seem to be missing a space before <code>FROM</code>."}, {"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1525837482, "post_id": 50240755, "comment_id": 87507828, "body": "Replace single quotes by double quotes and use SQL debug technique mentioned by @Andre"}, {"owner": {"reputation": 1, "user_id": 9760679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71edb25e188b5719163f835bbc50d5f9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Lee", "link": "https://stackoverflow.com/users/9760679/mike-lee"}, "edited": false, "score": 0, "creation_date": 1525895001, "post_id": 50240755, "comment_id": 87539889, "body": "I&#39;m not sure if this helps, but this worked fine in the query builder, it wasn&#39;t until i put it in VBA that it started having problems, so all the joins and such are fine"}, {"owner": {"reputation": 1, "user_id": 9760679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71edb25e188b5719163f835bbc50d5f9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Lee", "link": "https://stackoverflow.com/users/9760679/mike-lee"}, "edited": false, "score": 0, "creation_date": 1525895053, "post_id": 50240755, "comment_id": 87539918, "body": "and it wasn&#39;t the missing space before FROM"}], "owner": {"reputation": 1, "user_id": 9760679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71edb25e188b5719163f835bbc50d5f9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Lee", "link": "https://stackoverflow.com/users/9760679/mike-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 280, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1525813345, "creation_date": 1525806606, "last_edit_date": 1525813345, "question_id": 50240755, "link": "https://stackoverflow.com/questions/50240755/run-time-error-2465-in-access-2016", "title": "run time error 2465 in access 2016", "body": "<p>So I have a bunch of tables all linked together someway or another, and I'm trying to make a report that lists all the items in a selected range of invoice numbers, and to begin the process, the User will click a button, and that button will open a pop up form with 3 fields, FirstInvoiceNumber, LastInvoiceNumber, and Client.  These fields than save what the user enters as globals which are then plugged into the SQL statement in the Report_Open Event. There was a syntax error, but after about half an hour I found and fixed it. but now, I'm getting this Run-time Error 2465, which says \"Microsoft Access can't find the field 'l1' (In front of the 1, its a symbol I don't know how to type, but it looks like a tall lowercase L) referred to in your expression.\"\nMaybe I'm just looking at this for too long, but the only \"1\" I can see, is where the SQL statement has the Initials field, and both of them are inside parenthesis, so I'm not sure whats wrong. Anyways, here is this ridiculous SQL\n(Note: I find it easier to read on one line and just scroll sideways rather than having a big chunk split onto multiple lines, so this SQL statement is fit onto only 2 lines, I'll put an extra paragraph space so it's easier to find it)</p>\n\n<pre><code>Me.RecordSource = \"SELECT Invoices.InvNo, \nInvoices.JobNo, \nInvoices.InvDate, \nInvoices.TimeTotal, \nInvoices.Tax, \nInvoices.POTotal, \nInvoices.SubTotal, \nInvoices.InvTotal, \nInvoices.DatePaid, \nInvoices.AmountPaid, \nInvoices.Terms, \nContacts.EMail, \nInvoices.Status, \n' &amp; 'Attn: ' &amp; [FirstName] &amp; ' ' &amp; [LastName] &amp; ' AS FullName, \nCompanies.CompanyFullName, \nCompanies.CompanyAbrv, \nContacts.Department, \n' &amp; [City] &amp; ', \n' &amp; [State] &amp; ' ' &amp; [Zipcode] &amp; ' AS AddressLine3, \nInvoices.ClientPONo, \nInvLineItems.LineItemNote, \nInvLineItems.Adjustments, \nInvLineItems.Status, \nInvLineItems.Cost, \n[Cost]+([Cost]*[Adjustments]) AS AAC, \n' &amp; [Contacts].[AddressLine1] &amp; ', \n' &amp; [Contacts].[AddressLine2] &amp; ' AS AddressLine1and2, \n' &amp; [Invoices].[InvNo] &amp; '-' &amp; [Invoices].[JobNo] &amp; ' AS InvNoandJobNo, \nLeft([Contacts].[FirstName], \n1) &amp; Left([Contacts].[LastName], \n1) AS Initials, \nJobs.JobTitle, \n&amp; ' &amp; [Jobs].[JobTitle] &amp; ' ' &amp; [Jobs].[ClientCode] &amp; ' AS Product, \nInvLineItems.Requester, \nCompanies.CompanyID' _\n&amp; 'FROM ((((Invoices \nLEFT JOIN (Contacts \nRIGHT JOIN Jobs ON Contacts.ContactID = Jobs.ContactID) ON Invoices.JobNo = Jobs.JobNo) \nLEFT JOIN InvLineItems ON Invoices.InvNo = InvLineItems.InvNo) \nLEFT JOIN PurchaseOrders ON Invoices.InvNo = PurchaseOrders.InvNo) \nLEFT JOIN POLineItems ON PurchaseOrders.PONo = POLineItems.PONo) \nLEFT JOIN Companies ON Jobs.CompanyID = Companies.CompanyID'\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 1, "creation_date": 1525805759, "post_id": 50240420, "comment_id": 87498407, "body": "Change <code>&quot;{frm_ics238Table]&quot;</code> to <code>&quot;[frm_ics238Table]&quot;</code>"}, {"owner": {"reputation": 143, "user_id": 5843565, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c4b121d71a31bfe3b971584c3876b7b9?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/5843565/jake"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1525805945, "post_id": 50240420, "comment_id": 87498516, "body": "@dbmitch Thank you for the catch. I have been stairing at this for pretty much the entire day. changed it over and get Run-Time Error &#39;6&#39;: Overflow"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1525806127, "post_id": 50240420, "comment_id": 87498601, "body": "You don&#39;t have an ending bracket around your <code>DLookup</code> function either. Perhaps you should split out individual logic and get each one working first before building the whole statement at once"}, {"owner": {"reputation": 143, "user_id": 5843565, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c4b121d71a31bfe3b971584c3876b7b9?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/5843565/jake"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1525806514, "post_id": 50240420, "comment_id": 87498812, "body": "@dbmitch I am pretty sure there is a ending bracket there are two (( at the beginning and two )) at the end. I cant see any others"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1525806614, "post_id": 50240420, "comment_id": 87498870, "body": "Ahhh - I see you&#39;re using multiple criteria. Try using <code>IsNull([checkoutDate])</code> instead and  making sure Text18 is showing a value"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1525806708, "post_id": 50240420, "comment_id": 87498917, "body": "Stupid question but I&#39;m assuming <code>frm_ics238Table</code> is actually a table name - you&#39;re using it as a Form name above?"}, {"owner": {"reputation": 143, "user_id": 5843565, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c4b121d71a31bfe3b971584c3876b7b9?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/5843565/jake"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1525806961, "post_id": 50240420, "comment_id": 87499018, "body": "@dbmitch I tried it out and the DLookup errors out. DLookup(&quot;[eventID]&quot;, &quot;[tbl_ics238Table]&quot;, isNull([checkoutDate])). Yes that&#39;s supposed to be the table but I accidentally changed it to the form name"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 1, "creation_date": 1525807132, "post_id": 50240420, "comment_id": 87499094, "body": "Why don&#39;t you post your updated code and error above - now it looks like you&#39;ve left out the double quotes on the criteria. Two errors have been corrected already in your one question"}], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 5843565, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c4b121d71a31bfe3b971584c3876b7b9?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/5843565/jake"}, "edited": false, "score": 0, "creation_date": 1525865864, "post_id": 50241703, "comment_id": 87522059, "body": "I appreciate the assistance and I tried what you suggested but it just gives me a run-time error code 2471. I will keep working on it. It looks like using the is null function isn&#39;t really feasible for DLookup"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 143, "user_id": 5843565, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c4b121d71a31bfe3b971584c3876b7b9?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/5843565/jake"}, "edited": false, "score": 0, "creation_date": 1525887012, "post_id": 50241703, "comment_id": 87535888, "body": "I edited the question to show that it does indeed work if code matches table design assumptions. To this point I haven&#39;t seen ANY of your code updates."}], "tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1525886948, "last_edit_date": 1525886948, "creation_date": 1525810829, "answer_id": 50241703, "question_id": 50240420, "link": "https://stackoverflow.com/questions/50240420/using-null-in-a-dlookup-criteria/50241703#50241703", "title": "Using Null in a DLookup Criteria", "body": "<p>From your original question which right now it doesn't look like you've edited it to indicate the updated code and errors, you had:</p>\n\n<pre><code>id = Me.Text18\nForms![frm_ics238Table].Refresh\n\nIf Not IsNull(DLookup(\"[eventID]\", \"[frm_ics238Table]\", \"[checkoutDate] is Null And employeeID = '\" &amp; Me.Text18 &amp; \"'\")) Then\n    MsgBox \"y\"\nEnd If\n</code></pre>\n\n<p>I think these might help:</p>\n\n<ol>\n<li><code>\"[frm_ics238Table]\"</code> should be table:<code>\"[tbl_ics238Table]\"</code></li>\n<li>ID appears to be declared as an integer yet you're using it as a\nstring. If employeeID is actually a numeric field remove the quotes\naround <code>employeeID = '\" &amp; Me.Text18 &amp; \"'\"</code> It should look like this <code>employeeID = \" &amp; ID &amp; \"</code></li>\n<li>You can also try using <code>IsNull([checkoutDate])</code> instead of\n<code>[checkoutDate] is Null</code></li>\n</ol>\n\n<p>SO it might look like:</p>\n\n<pre><code>If Not IsNull(DLookup(\"[eventID]\", \"[tbl_ics238Table]\", \"IsNull([checkoutDate]) And (employeeID = \" &amp; ID &amp; \")\")) Then\n    MsgBox \"y\"\nEnd If\n</code></pre>\n\n<p>Even better would be to put the criteria into a string variable so you could debug and test it first</p>\n\n<pre><code>Dim strCriteria as String\nstrCriteria = \"IsNull([checkoutDate]) And (employeeID = \" &amp; ID &amp; \")\"\nDebug.Print strCriteria\n\nIf Not IsNull(DLookup(\"[eventID]\", \"[tbl_ics238Table]\", strCriteria)) Then\n    MsgBox \"y\"\nEnd If\n</code></pre>\n\n<p><strong>EDIT: PROOF OF WORKING CODE:</strong></p>\n\n<p>Not that I don't believe you but I don't believe that it doesn't work if what you've described matches my assumptions. </p>\n\n<p>I tested successfully using assumptions that:</p>\n\n<ul>\n<li>eventID - number field</li>\n<li>checkoutDate - date/time field</li>\n<li>employeeID - number field</li>\n</ul>\n\n<p><strong>My sample data table</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/Y5qkw.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Y5qkw.jpg\" alt=\"table\"></a></p>\n\n<p>Then I put a command button on a form to test the code:</p>\n\n<pre><code>Private Sub Command8_Click()\n    Dim strCriteria As String\n    Dim ID As Integer\n\n    ID = 4\n\n    strCriteria = \"IsNull([checkoutDate]) And (employeeID = \" &amp; ID &amp; \")\"\n    Debug.Print strCriteria\n\n    If Not IsNull(DLookup(\"[eventID]\", \"[tbl_ics238Table]\", strCriteria)) Then\n        MsgBox \"y\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Finally - testing the button click resulted in:</p>\n\n<p><a href=\"https://i.stack.imgur.com/E95DZ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/E95DZ.jpg\" alt=\"Results\"></a></p>\n\n<blockquote>\n  <p>In conclusion - if you're still getting an error then you can update\n  your question with BOTH your code AND your table design.</p>\n</blockquote>\n"}], "owner": {"reputation": 143, "user_id": 5843565, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c4b121d71a31bfe3b971584c3876b7b9?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/5843565/jake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2971, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1525886948, "creation_date": 1525805347, "last_edit_date": 1525808243, "question_id": 50240420, "link": "https://stackoverflow.com/questions/50240420/using-null-in-a-dlookup-criteria", "title": "Using Null in a DLookup Criteria", "body": "<p>I am creating a database to manage the flow of people in and out of an incident system. My idea is to use the DLookup function to allow me to identify a null value in the checkout date. This would allow me to prevent someone from jumping incidents without signing out first.</p>\n\n<p>If it is possible I would like to get the EVENT ID and the COMMAND POST ID so I can create an error message to tell me the incident that is member is still attached to.</p>\n\n<pre><code>'***Section 1 - Ensure member is Checked out and DEMOBed from previous incidents\n'******Variables\n'*********Variable to hold the Member ID\nDim id As Integer\n'*********Variable to hold the checkout status\nDim checkout As String\n'*********Variable to hold the Event ID\nDim eventID As Integer\n\n\n'******Code Block 1 - Check for Null Values\nid = Me.Text18\nForms![frm_ics238Table].Refresh\n\nIf Not IsNull(DLookup(\"[eventID]\", \"[frm_ics238Table]\", \"[checkoutDate] is Null And employeeID = '\" &amp; Me.Text18 &amp; \"'\")) Then\n    MsgBox \"y\"\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9195495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f252d07254f0bef3bee2b4ceb97b4ab?s=128&d=identicon&r=PG&f=1", "display_name": "faiz s", "link": "https://stackoverflow.com/users/9195495/faiz-s"}, "edited": false, "score": 0, "creation_date": 1525878438, "post_id": 50252375, "comment_id": 87530983, "body": "oh perfect! That makes sense. Thanks"}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1525865653, "creation_date": 1525865653, "answer_id": 50252375, "question_id": 50240396, "link": "https://stackoverflow.com/questions/50240396/word-template-overwrite-bookmark-information/50252375#50252375", "title": "Word Template : Overwrite bookmark Information", "body": "<p>Writing to a bookmark (whether as a user or using code) deletes the bookmark - this is by-design. When working with VBA, however, you have a work-around not easily available to the user...</p>\n\n<p>If you first assign a <code>Range</code> object to the bookmark's Range, the text you assign to the Range can subsequently be bookmarked again. Since you write to numerous bookmarks, best to put these actions into a separate procedure, rather than repeat them throughout your code, as proposed below.</p>\n\n<p>Tip: You can save yourself some code if you put <code>REF</code> fields (cross-references) in for the second bookmarks, where you write the information twice.</p>\n\n<pre><code>Function WriteToBookmarkRetainBookmark(rng As Object, content As String)\n    Dim sBkmName As String\n\n    sBkmName = rng.Bookmarks(1).Name\n    rng.Text = content\n    rng.Document.Bookmarks.Add sBkmName, rng\nEnd Function\n\nPrivate Sub OKbut_Click()\n    Dim CompamyName As Range\n    Dim CompanyName2 As Range\n\n    Set CompanyName = ActiveDocument.Bookmarks(\"CName\").Range\n    Set CompanyName2 = ActiveDocument.Bookmarks(\"CName2\").Range\n    WriteToBookmarkRetainBookmark(CompanyName, Me.TextBox1.Value)\n    WriteToBookmarkRetainBookmark(CompanyName2, Me.TextBox1.Value)\n\n    Dim VendorName As Range\n    Set VendorName = ActiveDocument.Bookmarks(\"VName\").Range\n    WriteToBookmarkRetainBookmark(VendorName, Me.TextBox2.Value)\n\n    Dim ProjectName As Range\n    Dim ProjectName2 As Range\n    Set ProjectName = ActiveDocument.Bookmarks(\"PName\").Range\n    Set ProjectName2 = ActiveDocument.Bookmarks(\"PName2\").Range\n    WriteToBookmarkRetainBookmark(ProjectName, Me.TextBox3.Value)\n    WriteToBookmarkRetainBookmark(ProjectName2, Me.TextBox3.Value)\n\n    Dim ProjectCode As Range\n    Set ProjectCode = ActiveDocument.Bookmarks(\"PCode\").Range\n    WriteToBookmarkRetainBookmark(ProjectCode, Me.TextBox4.Value)\n\n    Me.Repaint\n    PInfo.Hide    \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9195495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f252d07254f0bef3bee2b4ceb97b4ab?s=128&d=identicon&r=PG&f=1", "display_name": "faiz s", "link": "https://stackoverflow.com/users/9195495/faiz-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 50252375, "answer_count": 1, "score": 1, "last_activity_date": 1593731192, "creation_date": 1525805266, "last_edit_date": 1593731192, "question_id": 50240396, "link": "https://stackoverflow.com/questions/50240396/word-template-overwrite-bookmark-information", "title": "Word Template : Overwrite bookmark Information", "body": "<p>I have a template, when opened opens up a user-form for specified data. But how can I delete the data inputted (bookmarks), if I want to rerun the macro to add new data. Currently it just adds on to whatever is filled.</p>\n\n<pre><code>Private Sub Cancelbut_Click()\n    PInfo.Hide\n\nEnd Sub\nPrivate Sub OKbut_Click()\n    Dim CompamyName As Range\n    Dim CompanyName2 As Range\n    Set CompanyName = ActiveDocument.Bookmarks(\"CName\").Range\n    Set CompanyName2 = ActiveDocument.Bookmarks(\"CName2\").Range\n    CompanyName.Text = Me.TextBox1.Value\n    CompanyName2.Text = Me.TextBox1.Value\n\n    Dim VendorName As Range\n    Set VendorName = ActiveDocument.Bookmarks(\"VName\").Range\n    VendorName.Text = Me.TextBox2.Value\n\n    Dim ProjectName As Range\n    Dim ProjectName2 As Range\n    Set ProjectName = ActiveDocument.Bookmarks(\"PName\").Range\n    Set ProjectName2 = ActiveDocument.Bookmarks(\"PName2\").Range\n    ProjectName.Text = Me.TextBox3.Value\n    ProjectName2.Text = Me.TextBox3.Value\n\n    Dim ProjectCode As Range\n    Set ProjectCode = ActiveDocument.Bookmarks(\"PCode\").Range\n    ProjectCode.Text = Me.TextBox4.Value\n\n    Me.Repaint\n    PInfo.Hide\n\nEnd Sub\n</code></pre>\n\n<p>How would someone go about clearing the existing data? Feel like this would help anyone trying to work with bookmarks in word. I have attempted to do it, but end up deleting the bookmarks. </p>\n\n<p>Appreciate the help!</p>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 742, "user_id": 4056395, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/dd905348fdc682796f2afb6f35bc8b6e?s=128&d=identicon&r=PG&f=1", "display_name": "Ted Fitzpatrick", "link": "https://stackoverflow.com/users/4056395/ted-fitzpatrick"}, "edited": false, "score": 0, "creation_date": 1525816203, "post_id": 50242644, "comment_id": 87503144, "body": "Hopefully not counting my chick&#39;ns ... now I need to make this work with presentations with no visible window when opened"}], "tags": [], "owner": {"reputation": 742, "user_id": 4056395, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/dd905348fdc682796f2afb6f35bc8b6e?s=128&d=identicon&r=PG&f=1", "display_name": "Ted Fitzpatrick", "link": "https://stackoverflow.com/users/4056395/ted-fitzpatrick"}, "is_accepted": false, "score": 0, "last_activity_date": 1525815690, "creation_date": 1525815690, "answer_id": 50242644, "question_id": 50240191, "link": "https://stackoverflow.com/questions/50240191/ppt-vba-close-an-item-in-the-presentations-collection/50242644#50242644", "title": "PPT VBA close an item in the Presentations collection", "body": "<p>Whew, got it working.\nHere's how I opened the PPTM that I want to close later:</p>\n\n<pre><code>Set TheNewlyOpenedTandemPresentation = Presentations.Open(TandemFileToLoadFilePath, msoFalse, msoFalse, msoTrue)  'filepath,readonly,untitled/ascopy, visiblewindow\n</code></pre>\n\n<p>Later, I loop backwards and just .Close </p>\n\n<pre><code>Dim ThePresentationCounter As Integer\n    For ThePresentationCounter = Presentations.Count To 1 Step -1\n        If StrComp(Presentations(ThePresentationCounter).Name, CurrentTandemFileName) = 0 Then\n            Presentations(ThePresentationCounter).Close\n        End If\n    Next\n</code></pre>\n"}], "owner": {"reputation": 742, "user_id": 4056395, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/dd905348fdc682796f2afb6f35bc8b6e?s=128&d=identicon&r=PG&f=1", "display_name": "Ted Fitzpatrick", "link": "https://stackoverflow.com/users/4056395/ted-fitzpatrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525815690, "creation_date": 1525804477, "question_id": 50240191, "link": "https://stackoverflow.com/questions/50240191/ppt-vba-close-an-item-in-the-presentations-collection", "title": "PPT VBA close an item in the Presentations collection", "body": "<p>I'm using Slides.InsertFromFile to insert slides from a separate PPTM into an open PPTM. This causes the source PPTM to be added to the Presentations collection. I'd like to remove it from the collection after the slide insertion. The following isn't removing the source PPTM from the collection, any suggestions?</p>\n\n<pre><code>With Presentations.Item(IndexOfSourcePPTM)\n                        .Saved = msoTrue \n                        .Close\n                    End With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8656444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e3a74c78fa421ec1e68afb5a50a6b99?s=128&d=identicon&r=PG&f=1", "display_name": "SDillon", "link": "https://stackoverflow.com/users/8656444/sdillon"}, "edited": false, "score": 0, "creation_date": 1525876460, "post_id": 50240303, "comment_id": 87529584, "body": "Thank you for the response Joseph.  I will try this out later today or tomorrow."}, {"owner": {"reputation": 11, "user_id": 8656444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e3a74c78fa421ec1e68afb5a50a6b99?s=128&d=identicon&r=PG&f=1", "display_name": "SDillon", "link": "https://stackoverflow.com/users/8656444/sdillon"}, "edited": false, "score": 0, "creation_date": 1525957322, "post_id": 50240303, "comment_id": 87563898, "body": "I&#39;m still playing around with this but haven&#39;t got it right yet.  It only grabs the first two columns that I&#39;m comparing and it dumps all of the uniques into the same column in the secondary worksheet."}, {"owner": {"reputation": 11, "user_id": 8656444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e3a74c78fa421ec1e68afb5a50a6b99?s=128&d=identicon&r=PG&f=1", "display_name": "SDillon", "link": "https://stackoverflow.com/users/8656444/sdillon"}, "edited": false, "score": 0, "creation_date": 1525959458, "post_id": 50240303, "comment_id": 87565186, "body": "Ok.  I modified it slightly so that it grabs all the data I want.  The only issue still there is that it puts everything in the same output column in the Summary sheet.  My goal is for the first time through the loop the &quot;New&quot; items get copied to column A in the Summary sheet and the &quot;Removed&quot; items get copied to column D.  The second time through the loop I&#39;d have A+6 (G) and D+6 (J) and so on."}], "tags": [], "owner": {"reputation": 4740, "user_id": 1148564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eQICm.jpg?s=128&g=1", "display_name": "Joseph", "link": "https://stackoverflow.com/users/1148564/joseph"}, "is_accepted": false, "score": 0, "last_activity_date": 1525805199, "last_edit_date": 1525805199, "creation_date": 1525804868, "answer_id": 50240303, "question_id": 50240162, "link": "https://stackoverflow.com/questions/50240162/excel-vba-index-match-change-array-range-each-time-through-loop/50240303#50240303", "title": "Excel VBA - Index/Match Change Array/Range each time through loop", "body": "<p>You could use a sub procedure and pass the <code>leftRange</code> and <code>rightRange</code> as arguments:</p>\n\n<pre><code>Public Sub DoStuff(ByRef leftRange As Range, ByRef rightRange As Range, ByRef summaryCells As Worksheet)\n  For Each rngCell In leftRange\n    If WorksheetFunction.CountIf(rightRange, rngCell) = 0 Then\n        summaryCells.Cells(Rows.Count, 1).End(xlUp).Offset(1) = rngCell\n    End If\n  Next\nEnd Sub\n</code></pre>\n\n<p>Then you just call it like:</p>\n\n<pre><code>Public Sub test()\n  ' A against B\n  Call DoStuff(Sheets(\"Internal_Data\").Range(\"A2:A200\"), Sheets(\"Internal_Data\").Range(\"B2:B200\"), Sheets(\"SummaryCells\"))\n\n  ' B against A\n  Call DoStuff(Sheets(\"Internal_Data\").Range(\"B2:B200\"), Sheets(\"Internal_Data\").Range(\"A2:A200\"), Sheets(\"SummaryCells\"))\n\n\n\n  ' do it with a loop\n  Dim ws As Worksheet\n\n  Set ws = Sheets(\"Internal_Data\")\n  Dim col As Long\n\n  For col = 1 To 4 Step 2\n    Call DoStuff(ws.Range(ws.Cells(2, col), ws.Cells(200, col)), ws.Range(ws.Cells(2, col + 1), ws.Cells(200, col + 1)), Sheets(\"SummaryCells\"))\n    Call DoStuff(ws.Range(ws.Cells(2, col + 1), ws.Cells(200, col + 1)), ws.Range(ws.Cells(2, col), ws.Cells(200, col)), Sheets(\"SummaryCells\"))\n  Next\nEnd Sub\n</code></pre>\n\n<p>Untested, but this is the basic idea.</p>\n"}], "owner": {"reputation": 11, "user_id": 8656444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e3a74c78fa421ec1e68afb5a50a6b99?s=128&d=identicon&r=PG&f=1", "display_name": "SDillon", "link": "https://stackoverflow.com/users/8656444/sdillon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525958078, "creation_date": 1525804339, "last_edit_date": 1531164843, "question_id": 50240162, "link": "https://stackoverflow.com/questions/50240162/excel-vba-index-match-change-array-range-each-time-through-loop", "title": "Excel VBA - Index/Match Change Array/Range each time through loop", "body": "<p>First off my apologies if this has been previously answered but I've been looking for about a day and couldn't find anything.</p>\n\n<p>Part of my macro will compare two columns (A and B) to get understand what has changed from one month to the next.</p>\n\n<p>First I will look at what is in A and not in B to determine what was added.</p>\n\n<pre><code>i = 3\nFor Each rngCell In Sheets(\"Data\").Range(\"A2:A200\")\n    If WorksheetFunction.CountIf(Sheets(\"Data\").Range(\"B2:B200\"), rngCell) = 0 Then\n        Sheets(\"Summary\").Cells(Rows.Count, 1).End(xlUp).Offset(1) = rngCell\n    End If\ni = i + 1\nNext\n</code></pre>\n\n<p>I will then look at what is in B and not in A to determine what was removed.</p>\n\n<pre><code>n = 3\nFor Each rngCell In Sheets(\"Data\").Range(\"B2:B200\")\n    If WorksheetFunction.CountIf(Sheets(\"Data\").Range(\"A2:A200\"), rngCell) = 0 Then\n        Sheets(\"Summary\").Cells(Rows.Count, 4).End(xlUp).Offset(1) = rngCell\n    End If\nn = n + 1\nNext\n</code></pre>\n\n<p>This works for me.  I then want to compare more columns (eg. C and D, E and F, G and H.....etc).  I would like to create a For Loop so I don't have to right these two set of instructions another 30 or more times.</p>\n\n<p>I'm stuck on how to pass a variable into the Range so that instead of A2:A200 I have something like Range(Cells(Integer, 2), Cells(Integer, 200)).</p>\n\n<p>I'd appreciate help if someone has an answer.</p>\n"}, {"tags": ["excel", "vbscript", "adodb", "vba"], "comments": [{"owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 0, "creation_date": 1525804074, "post_id": 50239909, "comment_id": 87497504, "body": "If \u201cThanks in advance\u201d is at the start of a question, that tells me you probably haven\u2019t read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> or understand what the purpose of <a href=\"https://stackoverflow.com\">Stack Overflow</a> is. Sorry if this sounds harsh, but people need to understand that SO isn\u2019t a help forum, which makes questions that begin \u201cThanks in advance\u201d too personally to belong here. You could try de-personalising the question with an <a href=\"https://stackoverflow.com/posts/50239909/edit\">edit</a> and just concentrate on the problem and avoid fluff in a way that you think will help others with a similar issue."}, {"owner": {"reputation": 33, "user_id": 8916735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c58efbcf9af4d6704928e0742b664ba?s=128&d=identicon&r=PG&f=1", "display_name": "chris", "link": "https://stackoverflow.com/users/8916735/chris"}, "reply_to_user": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 1, "creation_date": 1525804815, "post_id": 50239909, "comment_id": 87497917, "body": "Ok here goes..."}, {"owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 0, "creation_date": 1525804905, "post_id": 50239909, "comment_id": 87497961, "body": "Appreciate the attitude @chris, good luck. Will check in again."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 8916735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c58efbcf9af4d6704928e0742b664ba?s=128&d=identicon&r=PG&f=1", "display_name": "chris", "link": "https://stackoverflow.com/users/8916735/chris"}, "edited": false, "score": 0, "creation_date": 1525813899, "post_id": 50241925, "comment_id": 87502222, "body": "I also just realized something.  If I name the ranges in the spreadsheet I can use the input to point to that range.  Simple, Elegant, Efficient!"}, {"owner": {"reputation": 33, "user_id": 8916735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c58efbcf9af4d6704928e0742b664ba?s=128&d=identicon&r=PG&f=1", "display_name": "chris", "link": "https://stackoverflow.com/users/8916735/chris"}, "edited": false, "score": 0, "creation_date": 1525814169, "post_id": 50241925, "comment_id": 87502332, "body": "I might be able to do:"}, {"owner": {"reputation": 33, "user_id": 8916735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c58efbcf9af4d6704928e0742b664ba?s=128&d=identicon&r=PG&f=1", "display_name": "chris", "link": "https://stackoverflow.com/users/8916735/chris"}, "edited": false, "score": 0, "creation_date": 1525814243, "post_id": 50241925, "comment_id": 87502358, "body": "objRecordSet.Open &quot;SELECT * FROM [&quot; &amp; SheetFromInput &amp; &quot;]&quot;, objConnection"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "reply_to_user": {"reputation": 33, "user_id": 8916735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c58efbcf9af4d6704928e0742b664ba?s=128&d=identicon&r=PG&f=1", "display_name": "chris", "link": "https://stackoverflow.com/users/8916735/chris"}, "edited": false, "score": 0, "creation_date": 1525814417, "post_id": 50241925, "comment_id": 87502434, "body": "@chris you can&#39;t have just a numerical value for a named range but you could append it with something first and add the number after. ie myRange1, myRange2 ect..."}], "tags": [], "owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "is_accepted": true, "score": 2, "last_activity_date": 1525812207, "last_edit_date": 1525812207, "creation_date": 1525811873, "answer_id": 50241925, "question_id": 50239909, "link": "https://stackoverflow.com/questions/50239909/vbscript-adodb-connection-to-excel-variable-range/50241925#50241925", "title": "VBScript: ADODB Connection to Excel Variable Range", "body": "<p>If you opened the workbook then you could have used the offset function of the range object.  Then you could do something like</p>\n\n<pre><code>baseRange = Range(\"A1:H51\")\n\nIf SheetFromInput &gt; 1 Then\n    ShotRange = baseRange.Offset(0, (SheetFromInput - 1) * 8)\nElse\n    ShotRange = baseRange\nEnd If\n</code></pre>\n\n<p>but since you are doing a query then you need to create the function to get the alpha characters.  You do this by using the ascii values for A-Z:65-90. Dividing by 26 and starting at 64 since 1 = A and 64+1 is the aschii value for A.  </p>\n\n<p>*Note that this is not fully tested and could probably be done more efficiently</p>\n\n<pre><code>If SheetFromInput &gt; 1 Then\n    ShotRange = \"Shot_Graphics$\" &amp; getRangeAlpha((SheetFromInput - 1) * 8 + 1) &amp; \"1:\" &amp; getRangeAlpha((SheetFromInput - 1) * 8 + 8) &amp; \"51\"\nElse\n    ShotRange = \"Shot_Graphics$\" &amp; getRangeAlpha(1) &amp; \"1:\" &amp; getRangeAlpha(8) &amp; \"51\"\nEnd If\n\n\n\n\nFunction getRangeAlpha(val)\n'Ascii 65-90 A-Z\n'divide by 26\nDim numLetters\nDim numRemainingLetters\nDim letterRange\n\nnumLetters = val \\ 26\nnumRemainingLetters = val Mod 26\n'check to see if we are at ZZ (702)\n'we do this as 27 returns AA in this function.  This is the only known issue.\nIf numLetters = 27 Then\n    getRangeAlpha = \"ZZ\"\n    Exit Function\nEnd If\n'check to see if we have three letters\nIf numLetters &gt; 26 Then\n    Dim numThirdLetter\n    'get the value for the third letter (first in series)\n    numThirdLetter = numLetters \\ 26\n    'set the next letter to the remaining value\n    numLetters = numLetters Mod 26\n    'add the letter\n    letterRange = Chr(64 + numThirdLetter)\nEnd If\n\nIf numLetters &gt; 0 Then\n    letterRange = letterRange + Chr(64 + numLetters)\nEnd If\nIf numRemainingLetters &gt; 0 Then\n    letterRange = letterRange + Chr(64 + numRemainingLetters)\nEnd If\n\ngetRangeAlpha = letterRange\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8916735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c58efbcf9af4d6704928e0742b664ba?s=128&d=identicon&r=PG&f=1", "display_name": "chris", "link": "https://stackoverflow.com/users/8916735/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 50241925, "answer_count": 1, "score": 1, "last_activity_date": 1525812207, "creation_date": 1525803400, "last_edit_date": 1531164843, "question_id": 50239909, "link": "https://stackoverflow.com/questions/50239909/vbscript-adodb-connection-to-excel-variable-range", "title": "VBScript: ADODB Connection to Excel Variable Range", "body": "<p>I've got some working code here that I'm trying to improve with an integer to alphabet solution.  </p>\n\n<p>I have a massive Excel Spreadsheet that the user will address with ADODB to a specific Range based on their input (to reduce the recordset size).</p>\n\n<p>So, if the input is 1 the range is A1:H51 and if the input is 2, its offset by 8 fields.  </p>\n\n<p>Right now, as you can see below, I'm just doing 50 If Then Statements.  My question is how can I use a variable to set the range based on the input?</p>\n\n<p>Or is it good enough as is?  Seems complicated...</p>\n\n<pre><code>Dim SelectedSpreadsheetFromTxt\nDim fso\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    Set file = fso.OpenTextFile(\"C:\\ProgramData\\vizrt\\Trio\\GolfShotSheetSpreadsheetPath.txt\")\n    line = file.ReadLine\n    file.Close\n\nSelectedSpreadsheetFromTxt = line\n\nDim Message,Flag,Name,Score,Hole,Par,Shot,NullField\nDim objConnection, objRecordSet\n\n    set objConnection = CreateObject(\"ADODB.Connection\")\n    set objRecordSet = CreateObject(\"ADODB.Recordset\")\n\n    objConnection.Open \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp;_\n    \"Data Source=\" &amp; SelectedSpreadsheetFromTxt &amp; \";\" &amp;_\n    \"Extended Properties=\"\"Excel 12.0; HDR=Yes; IMEX=1\"\";\"\n\n'inputbox to ask for sheet number\nDim SheetFromInput\nSheetFromInput = InputBox(\"What Shot Sheet?\" &amp; vbNewLine &amp; \"Enter the Number: 1,2,3,4,5, etc...\",\"Shot Sheet\")\n\nDim ShotRange\nIf SheetFromInput = 1 Then\n    ShotRange = \"Shot_Graphics$A1:H51\" \nEnd If\nIf SheetFromInput = 2 Then\n    ShotRange = \"Shot_Graphics$I1:P51\"\nEnd If\nIf SheetFromInput = 3 Then\n    ShotRange = \"Shot_Graphics$Q1:X51\"\nEnd If\nIf SheetFromInput = 4 Then\n    ShotRange = \"Shot_Graphics$Y1:AF51\"\nEnd If\nIf SheetFromInput = 5 Then\n    ShotRange = \"Shot_Graphics$AG1:AN51\"\nEnd If\nIf SheetFromInput = 6 Then\n    ShotRange = \"Shot_Graphics$AO1:AV51\"\nEnd If\nIf SheetFromInput = 7 Then\n    ShotRange = \"Shot_Graphics$AW1:BD51\"\nEnd If\nIf SheetFromInput = 8 Then\n    ShotRange = \"Shot_Graphics$BE1:BL51\"\nEnd If\nIf SheetFromInput = 9 Then\n    ShotRange = \"Shot_Graphics$BM1:BT51\"\nEnd If\nIf SheetFromInput = 10 Then\n    ShotRange = \"Shot_Graphics$BU1:CB51\"\nEnd If\nIf SheetFromInput = 11 Then\n    ShotRange = \"Shot_Graphics$CC1:CJ51\"\nEnd If\nIf SheetFromInput = 12 Then\n    ShotRange = \"Shot_Graphics$CK1:CR51\"\nEnd If\nIf SheetFromInput = 13 Then\n    ShotRange = \"Shot_Graphics$CS1:CZ51\"\nEnd If\nIf SheetFromInput = 14 Then\n    ShotRange = \"Shot_Graphics$DA1:DH51\"\nEnd If\nIf SheetFromInput = 15 Then\n    ShotRange = \"Shot_Graphics$DI1:DP51\"\nEnd If\nIf SheetFromInput = 16 Then\n    ShotRange = \"Shot_Graphics$DQ1:DX51\"\nEnd If\nIf SheetFromInput = 17 Then\n    ShotRange = \"Shot_Graphics$DY1:EF51\"\nEnd If\nIf SheetFromInput = 18 Then\n    ShotRange = \"Shot_Graphics$EG1:EN51\"\nEnd If\nIf SheetFromInput = 19 Then\n    ShotRange = \"Shot_Graphics$EO1:EV51\"\nEnd If\nIf SheetFromInput = 20 Then\n    ShotRange = \"Shot_Graphics$EW1:FD51\"\nEnd If\nIf SheetFromInput = 21 Then\n    ShotRange = \"Shot_Graphics$FE1:FL51\"\nEnd If\nIf SheetFromInput = 22 Then\n    ShotRange = \"Shot_Graphics$FM1:FT51\"\nEnd If\nIf SheetFromInput = 23 Then\n    ShotRange = \"Shot_Graphics$FU1:GB51\"\nEnd If\nIf SheetFromInput = 24 Then\n    ShotRange = \"Shot_Graphics$GC1:GJ51\"\nEnd If\nIf SheetFromInput = 25 Then\n    ShotRange = \"Shot_Graphics$GK1:GR51\"\nEnd If\nIf SheetFromInput = 26 Then\n    ShotRange = \"Shot_Graphics$GS1:GZ51\"\nEnd If\nIf SheetFromInput = 27 Then\n    ShotRange = \"Shot_Graphics$HA1:HH51\"\nEnd If\nIf SheetFromInput = 28 Then\n    ShotRange = \"Shot_Graphics$HI1:HP51\"\nEnd If\nIf SheetFromInput = 29 Then\n    ShotRange = \"Shot_Graphics$HQ1:HX51\"\nEnd If\nIf SheetFromInput = 30 Then\n    ShotRange = \"Shot_Graphics$HY1:IF51\"\nEnd If\nIf SheetFromInput = 31 Then\n    ShotRange = \"Shot_Graphics$IG1:IN51\"\nEnd If\nIf SheetFromInput = 32 Then\n    ShotRange = \"Shot_Graphics$IO1:IV51\"\nEnd If\nIf SheetFromInput = 33 Then\n    ShotRange = \"Shot_Graphics$IW1:JD51\"\nEnd If\nIf SheetFromInput = 34 Then\n    ShotRange = \"Shot_Graphics$JE1:JL51\"\nEnd If\nIf SheetFromInput = 35 Then\n    ShotRange = \"Shot_Graphics$JM1:JT51\"\nEnd If\nIf SheetFromInput = 36 Then\n    ShotRange = \"Shot_Graphics$JU1:KB51\"\nEnd If\nIf SheetFromInput = 37 Then\n    ShotRange = \"Shot_Graphics$KC1:KJ51\"\nEnd If\nIf SheetFromInput = 38 Then\n    ShotRange = \"Shot_Graphics$KK1:KR51\"\nEnd If\nIf SheetFromInput = 39 Then\n    ShotRange = \"Shot_Graphics$KS1:KZ51\"\nEnd If\nIf SheetFromInput = 40 Then\n    ShotRange = \"Shot_Graphics$LA1:LH51\"\nEnd If\nIf SheetFromInput = 41 Then\n    ShotRange = \"Shot_Graphics$LI1:LP51\"\nEnd If\nIf SheetFromInput = 42 Then\n    ShotRange = \"Shot_Graphics$LQ1:LX51\"\nEnd If\nIf SheetFromInput = 43 Then\n    ShotRange = \"Shot_Graphics$LY1:MF51\"\nEnd If\nIf SheetFromInput = 44 Then\n    ShotRange = \"Shot_Graphics$MG1:MN51\"\nEnd If\nIf SheetFromInput = 45 Then\n    ShotRange = \"Shot_Graphics$MO1:MV51\"\nEnd If\nIf SheetFromInput = 46 Then\n    ShotRange = \"Shot_Graphics$MW1:ND51\"\nEnd If\nIf SheetFromInput = 47 Then\n    ShotRange = \"Shot_Graphics$NE1:NL51\"\nEnd If\nIf SheetFromInput = 48 Then\n    ShotRange = \"Shot_Graphics$NM1:NT51\"\nEnd If\nIf SheetFromInput = 49 Then\n    ShotRange = \"Shot_Graphics$NU1:OB51\"\nEnd If\nIf SheetFromInput = 50 Then\n    ShotRange = \"Shot_Graphics$OC1:OJ51\"\nEnd If\n\n        objRecordSet.Open \"SELECT * FROM [\" &amp; ShotRange &amp; \"]\", objConnection\n\n            MessageColumn = 0\n            FlagColumn = 1\n            NameColumn = 2\n            ScoreColumn = 3\n            HoleColumn = 4\n            ParColumn = 5\n            ShotColumn = 6\n            NullFieldColumn = 7\n\n    Do Until objRecordSet.EOF       \n            Message = objRecordSet.Fields.Item(0)\n            Flag = objRecordSet.Fields.Item(1)\n            Name = objRecordSet.Fields.Item(2)\n            Score = objRecordSet.Fields.Item(3)\n            Hole = objRecordSet.Fields.Item(4)\n            Par = objRecordSet.Fields.Item(5)\n            Shot = objRecordSet.Fields.Item(6)\n            NullField = objRecordSet.Fields.Item(7)\n\n                TrioCmd(\"page:read_template SHOT_STROKEPLAY-FULL_GOLF\")\n                TrioCmd(\"page:set_property 0100 \" &amp; Flag)\n                TrioCmd(\"page:set_property 0102 \" &amp; NullField)\n                TrioCmd(\"page:set_property 0140 \" &amp; Name)\n                TrioCmd(\"page:set_property 0150 \" &amp; Score)\n                TrioCmd(\"page:set_property 0210 \" &amp; Hole)\n                TrioCmd(\"page:set_property 0220 \" &amp; Par)\n                TrioCmd(\"page:set_property 0230 \" &amp; Shot)\n                TrioCmd(\"page:set_property 0320 \" &amp; NullField)\n                TrioCmd(\"page:set_property 0330 \" &amp; NullField)\n                TrioCmd(\"page:set_property 0410 \" &amp; NullField)\n                TrioCmd(\"page:set_property 0510 \" &amp; NullField)\n                TrioCmd(\"page:saveas \" &amp; Message)\n    objRecordSet.MoveNext\n    Loop\n\n    objRecordSet.Close\n    set objRecordSet = Nothing\n\n    objConnection.Close\n    set objConnection = Nothing\n</code></pre>\n"}, {"tags": ["vba", "email", "ms-access", "google-analytics"], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 9448003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95cafe76837d568943079a6aa2162b3b?s=128&d=identicon&r=PG&f=1", "display_name": "user9448003", "link": "https://stackoverflow.com/users/9448003/user9448003"}, "edited": false, "score": 0, "creation_date": 1525871783, "post_id": 50241310, "comment_id": 87526095, "body": "The thing with email tracking provider is that they usually want you to send an email through that provider however in my case it is a little more difficult because I am trying to send emails as many different people. For example if I have a list of patients, and I want to send out emails with the corresponding signature so that it appears that they are receiving these emails from their specific doctor. From what I am aware of these email tracking providers don&#39;t go that complex. My Access application is coded to do such."}, {"owner": {"reputation": 1658, "user_id": 1179388, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9cfd3393d39026fe60862a924f4127c1?s=128&d=identicon&r=PG", "display_name": "MichaelEvanchik", "link": "https://stackoverflow.com/users/1179388/michaelevanchik"}, "reply_to_user": {"reputation": 77, "user_id": 9448003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95cafe76837d568943079a6aa2162b3b?s=128&d=identicon&r=PG&f=1", "display_name": "user9448003", "link": "https://stackoverflow.com/users/9448003/user9448003"}, "edited": false, "score": 0, "creation_date": 1525874185, "post_id": 50241310, "comment_id": 87527951, "body": "Then your going to have to do with what i have stated.  You will have to have a web server that does nothing but has code that captures all the paramaters that i listed after the ? and code them to insert this information back into your database.  As for open, the image tag should work (fyi outlook thats on auto preview might be false positives), also some newer outlook blocks images, but i think the GET is still made."}], "tags": [], "owner": {"reputation": 1658, "user_id": 1179388, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9cfd3393d39026fe60862a924f4127c1?s=128&d=identicon&r=PG", "display_name": "MichaelEvanchik", "link": "https://stackoverflow.com/users/1179388/michaelevanchik"}, "is_accepted": false, "score": 0, "last_activity_date": 1525809074, "creation_date": 1525809074, "answer_id": 50241310, "question_id": 50239790, "link": "https://stackoverflow.com/questions/50239790/track-open-rate-of-outlook-emails-being-sent-through-ms-access/50241310#50241310", "title": "Track open rate of outlook emails being sent through MS Access?", "body": "<p>open rates are very hard to detect.  You have to use outside services to actually detect if your email was opened.  Your email will at least have to support html (not text only) to know if it was opened.  usually its a reference to in the body of an html email</p>\n\n<p>\n\n<pre><code> &lt;img src=\"http://yourdomain.com/file.jpg?campainid=52&amp;send_method=Access\" height=0px;width=0px;\"&gt;\n</code></pre>\n\n<p>JavaScript is usually out of the question in emails, but not as much in web mail.</p>\n\n<p>It would be best to use a email tracking provider, then to reinvent this wheel yourself, but you can try with my idea.</p>\n\n<p>There are many other methods out there using email tracking tools</p>\n"}], "owner": {"reputation": 77, "user_id": 9448003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95cafe76837d568943079a6aa2162b3b?s=128&d=identicon&r=PG&f=1", "display_name": "user9448003", "link": "https://stackoverflow.com/users/9448003/user9448003"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525809074, "creation_date": 1525802927, "last_edit_date": 1525808084, "question_id": 50239790, "link": "https://stackoverflow.com/questions/50239790/track-open-rate-of-outlook-emails-being-sent-through-ms-access", "title": "Track open rate of outlook emails being sent through MS Access?", "body": "<p>I have coded that I can send MS Outlook emails via MS Access. I was wondering if there is anyway to code tho check if these emails are being opened?</p>\n\n<p>Or is there another service I can link with this to track the analytics of the email I am sending out through MS Access?</p>\n\n<pre><code>\u2018Code to format email and set it to variable strHTML here\n\n\n\u2018code to send email\nWith cdomsg\n.To = emailstr\n.FROM = fromemailstr\n.subject = Forms!frmMain.txtSubject\n.HTMLBody = strHTML\n.Send\n\nEnd With\n    Set cdomsg = Nothing\n</code></pre>\n"}, {"tags": ["javascript", "html", "vba"], "comments": [{"owner": {"reputation": 71, "user_id": 9726125, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "gopala krishna", "link": "https://stackoverflow.com/users/9726125/gopala-krishna"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1525838273, "post_id": 50239719, "comment_id": 87508029, "body": "@QHarr I am afraid I can&#39;t share the URL.But the gist is this : I need to change the tag value of aria-selected to true.Thanks"}, {"owner": {"reputation": 71, "user_id": 9726125, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "gopala krishna", "link": "https://stackoverflow.com/users/9726125/gopala-krishna"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1527952705, "post_id": 50239719, "comment_id": 88326668, "body": "@QHarr Thanks for the response.I have edited the question.Is this helpful? Can you deduce something? Please help."}, {"owner": {"reputation": 71, "user_id": 9726125, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "gopala krishna", "link": "https://stackoverflow.com/users/9726125/gopala-krishna"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1527961586, "post_id": 50239719, "comment_id": 88329138, "body": "@QHarr Can you tell me what is that $URL , do I have to import some library for that , since it is throwing an error.Do I have to download Selenium?"}, {"owner": {"reputation": 71, "user_id": 9726125, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "gopala krishna", "link": "https://stackoverflow.com/users/9726125/gopala-krishna"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1527963222, "post_id": 50239719, "comment_id": 88329604, "body": "@QHarr Hey , I have edited the question as you told. I still don&#39;t have an idea what $URL is?"}, {"owner": {"reputation": 71, "user_id": 9726125, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "gopala krishna", "link": "https://stackoverflow.com/users/9726125/gopala-krishna"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1527963593, "post_id": 50239719, "comment_id": 88329703, "body": "@QHarr Yes, its the same URL that I used in the code.But I think you need access. I can give you my username and password , if you want to have a look."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1527963703, "post_id": 50239719, "comment_id": 88329743, "body": "Absolutely do not give people, including me, your login details. Bit like handing a stranger your wallet. Don&#39;t do it. That aside, I hadn&#39;t noticed your code, did you just edit it in? I will have a look."}, {"owner": {"reputation": 71, "user_id": 9726125, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "gopala krishna", "link": "https://stackoverflow.com/users/9726125/gopala-krishna"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1527964122, "post_id": 50239719, "comment_id": 88329879, "body": "@QHarr I have only one item .It&#39;s length is one.It&#39;s innerHTML is   &quot;   &lt;span class=&quot;DropdownArrowElement&quot;&gt;&lt;/span&gt; &quot;.It&#39;s innerText is empty string. And thanks for the upvote."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1527964252, "post_id": 50239719, "comment_id": 88329918, "body": "HTMLDoc.getElementsByClassName(&quot;DropdownArrow&quot;)(0).Click"}, {"owner": {"reputation": 71, "user_id": 9726125, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "gopala krishna", "link": "https://stackoverflow.com/users/9726125/gopala-krishna"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1527964300, "post_id": 50239719, "comment_id": 88329930, "body": "Do you have access to jazz server .You can create a free account if you want to.It&#39;s IBM&#39;s Rational team concert ALM"}, {"owner": {"reputation": 71, "user_id": 9726125, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "gopala krishna", "link": "https://stackoverflow.com/users/9726125/gopala-krishna"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1527964561, "post_id": 50239719, "comment_id": 88330017, "body": "@QHarr &#39;HTMLDoc.getElementsByClassName(&quot;DropdownArrow&quot;)(0).Click&#39; I tried this before asking the question on StackOverflow.Not happening :(. Can they disable the click of that button by script so that it can only be done manually?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1527965235, "post_id": 50239719, "comment_id": 88330236, "body": "So it seems like we have the right element selected...are you familiar with inspecting for potentially associated javascript functions?"}, {"owner": {"reputation": 71, "user_id": 9726125, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "gopala krishna", "link": "https://stackoverflow.com/users/9726125/gopala-krishna"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1527966611, "post_id": 50239719, "comment_id": 88330652, "body": "@QHarr Yes, we have selected the right element. No , I don&#39;t know how to look for the JS functions.When I saw the page source,the source file of javascript is around 1000 lines of code"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528003884, "post_id": 50239719, "comment_id": 88337234, "body": "It is possible to set DOM event listeners including break on click events using Chrome Dev tools (F12) - you can often use this to step through working out which, if any events, are linked to clicking a partic item. And then inspecting that event code for anything that can be targeted via VBA."}, {"owner": {"reputation": 71, "user_id": 9726125, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "gopala krishna", "link": "https://stackoverflow.com/users/9726125/gopala-krishna"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528041634, "post_id": 50239719, "comment_id": 88346394, "body": "@QHarr I did what you suggested , a bunch of functions are being called but I am not sure how it&#39;s going to help? Can I do something in VBA by fetching Xpath of the element? and then performing click function."}], "owner": {"reputation": 71, "user_id": 9726125, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "gopala krishna", "link": "https://stackoverflow.com/users/9726125/gopala-krishna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1527963512, "creation_date": 1525802655, "last_edit_date": 1527963512, "question_id": 50239719, "link": "https://stackoverflow.com/questions/50239719/edit-webpage-tags-using-vba", "title": "Edit Webpage tags using VBA", "body": "<p>I am trying to click a row of the table in webpage(it is IBM's JAZZ Server) using VBA\nIf I click on the row manually, the HTML code changes.(JavaScript).</p>\n\n<p>The HTML webpage contains before I click the row:</p>\n\n<pre><code>&lt;... class = \"DropDownButton\" ....&gt;\n</code></pre>\n\n<p>The HTML webpage contains after I click the row:</p>\n\n<pre><code>&lt;...class = \"DropDownButtonPressed\" ...&gt;\n</code></pre>\n\n<p>The class name changes.I can't share the URL of the webpage because you should have an account.I want to click on the drop down button.I am able to click a button in the webpage using click function(Since they are just buttons and not drop down button).\nThis is what the page looks like. I want to click on the highlighted drop down button.\n<a href=\"https://i.stack.imgur.com/SDkk8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SDkk8.png\" alt=\"Web Page\"></a></p>\n\n<p>Upon inspecting the webpage this is what you see :</p>\n\n<p><a href=\"https://i.stack.imgur.com/AUnTE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AUnTE.png\" alt=\"Highlighted is the drop down button\"></a></p>\n\n<p>Upon clicking the drop down this is how the web page changes:</p>\n\n<p><a href=\"https://i.stack.imgur.com/0LUo4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0LUo4.png\" alt=\"enter image description here\"></a></p>\n\n<p>Can anyone help me with this.Can anybody refer me to some resources or blogs where clicking on drop down button using VBA is discussed that would be helpful.Thanks a lot.</p>\n\n<p>My code:</p>\n\n<pre><code>Sub BrowseToSite()\n\nDim IE As New SHDocVw.InternetExplorer\nDim HTMLDoc As MSHTML.HTMLDocument\nDim HTMLIn As MSHTML.IHTMLElement\nDim HTMLButtons As MSHTML.IHTMLElementCollection\nDim HTMLButton As MSHTML.IHTMLElement\n'URL$\n\n\n'Set IE = New SHDocVw.InternetExplorer\n\nIE.Visible = True\n\nIE.Navigate \"https://jazz.net/jazz/web/projects/Jazz%20Collaborative%20ALM#action=com.ibm.team.workitem.newWorkItem&amp;type=defect&amp;ts=15279513017930&amp;tab=com.ibm.team.workitem.tab.links\"\n\nDo While IE.ReadyState &lt;&gt; READYSTATE_COMPLETE\n\nLoop\n\n'IE.Document.forms(\"searchform\").elements(\"search\").Value = \"Sachin\"\n\nSet HTMLDoc = IE.Document\n\nSet HTMLButtons = HTMLDoc.getElementsByClassName(\"DropdownArrow\")\n\nHTMLDoc.querySelector (\"span[dojoattachpoint=\"\"_dropdownArrow\"\"]\").Click // Nothing is hhappening\n\n\n\n'Tried also with\n    HTMLDoc.querySelector(\".HTMLButtons\").Click\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["windows", "vba", "registry", "preview", "explorer"], "comments": [{"owner": {"reputation": 131, "user_id": 645414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4d59710744648bd74c3ef7e117e6d2?s=128&d=identicon&r=PG", "display_name": "Tom the Toolman", "link": "https://stackoverflow.com/users/645414/tom-the-toolman"}, "edited": false, "score": 1, "creation_date": 1525999553, "post_id": 50238663, "comment_id": 87583235, "body": "The down-vote contributes nothing to the discussion. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 3826, "user_id": 374601, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/uL80U.jpg?s=128&g=1", "display_name": "Erty Seidohl", "link": "https://stackoverflow.com/users/374601/erty-seidohl"}, "edited": false, "score": 0, "creation_date": 1525813984, "post_id": 50239400, "comment_id": 87502254, "body": "While this answer is probably correct and useful, it is preferred if you include some explanation along with it to explain how it helps to solve the problem. This becomes especially useful in the future, if there is a change (possibly unrelated) that causes it to stop working and users need to understand how it once worked."}, {"owner": {"reputation": 131, "user_id": 645414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4d59710744648bd74c3ef7e117e6d2?s=128&d=identicon&r=PG", "display_name": "Tom the Toolman", "link": "https://stackoverflow.com/users/645414/tom-the-toolman"}, "edited": false, "score": 0, "creation_date": 1525999871, "post_id": 50239400, "comment_id": 87583308, "body": "This works if I rename files to .vba, but I&#39;d prefer to stick with the original, supported file extension and make it work correctly."}, {"owner": {"reputation": 3189, "user_id": 2855440, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/85a3bda48007f819c2c7249535882486?s=128&d=identicon&r=PG&f=1", "display_name": "Denis Anisimov", "link": "https://stackoverflow.com/users/2855440/denis-anisimov"}, "edited": false, "score": 0, "creation_date": 1526051184, "post_id": 50239400, "comment_id": 87607061, "body": "You can use any extension. Just replace ext in the sample."}, {"owner": {"reputation": 131, "user_id": 645414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4d59710744648bd74c3ef7e117e6d2?s=128&d=identicon&r=PG", "display_name": "Tom the Toolman", "link": "https://stackoverflow.com/users/645414/tom-the-toolman"}, "edited": false, "score": 0, "creation_date": 1526245591, "post_id": 50239400, "comment_id": 87657151, "body": "I searched for further information on the GUIDs used and now have a much better understanding of how this all works."}], "tags": [], "owner": {"reputation": 3189, "user_id": 2855440, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/85a3bda48007f819c2c7249535882486?s=128&d=identicon&r=PG&f=1", "display_name": "Denis Anisimov", "link": "https://stackoverflow.com/users/2855440/denis-anisimov"}, "is_accepted": true, "score": 1, "last_activity_date": 1526051126, "last_edit_date": 1526051126, "creation_date": 1525801256, "answer_id": 50239400, "question_id": 50238663, "link": "https://stackoverflow.com/questions/50238663/preview-vba-code-files-in-windows-7-explorer/50239400#50239400", "title": "Preview VBA code files in Windows 7 Explorer", "body": "<pre><code>Windows Registry Editor Version 5.00\n\n[HKEY_CLASSES_ROOT\\.ext]\n@=\"extfile\"\n\n[HKEY_CLASSES_ROOT\\extfile]\n@=\"ext file\"\n\n[HKEY_CLASSES_ROOT\\extfile\\shellex\\{8895b1c6-b41f-4c1c-a562-0d564250836f}]\n@=\"{1531d583-8375-4d3f-b5fb-d23bbd169f22}\"\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 645414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4d59710744648bd74c3ef7e117e6d2?s=128&d=identicon&r=PG", "display_name": "Tom the Toolman", "link": "https://stackoverflow.com/users/645414/tom-the-toolman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 50239400, "answer_count": 1, "score": 0, "last_activity_date": 1526051126, "creation_date": 1525798309, "question_id": 50238663, "link": "https://stackoverflow.com/questions/50238663/preview-vba-code-files-in-windows-7-explorer", "title": "Preview VBA code files in Windows 7 Explorer", "body": "<p>I just found out that Windows Explorer has a preview pane which can view different types of files. For example, my version came with \".txt\" and \".xlsx\" files enabled for previewing. This is really useful for looking at a directory full of text or spreadsheet files.</p>\n\n<p>I followed a procedure I found on the web to enable previewing other types of files as well, including \".log\" and \".list\", and code files like \".bas\", \".cls\", and \".frm\" (VBA). To do this, I just added the string item \"PerceivedType\" as \"text\" to the registry key for each type under Classes Root.</p>\n\n<p>Unfortunately, even though I configured \".bas\" in exactly the same fashion as the others, Explorer insists there's \"No preview available\". I carefully checked the registry settings and I'm certain there's no difference in the ones I've found that seem to be relevant. I also tried this on a Windows 10 machine with the same results.</p>\n\n<p>So I must be missing something.</p>\n\n<p>Any suggestions on where to look to fix this?</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 2471, "user_id": 9482070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rovzT.jpg?s=128&g=1", "display_name": "Daniel Marcus", "link": "https://stackoverflow.com/users/9482070/daniel-marcus"}, "edited": false, "score": 0, "creation_date": 1525798987, "post_id": 50238570, "comment_id": 87494914, "body": "Is &#39;lag&#39; supported? if so you can use that"}, {"owner": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "edited": false, "score": 0, "creation_date": 1525799422, "post_id": 50238570, "comment_id": 87495152, "body": "Maybe I am the only one, but I am more than a little confused as to what you&#39;re asking with this. Would you kindly post your VBA and/or SQL query that you&#39;ve tried?"}, {"owner": {"reputation": 11, "user_id": 9634514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16adda792c5cc241d10e59c8341a3578?s=128&d=identicon&r=PG&f=1", "display_name": "MultiA", "link": "https://stackoverflow.com/users/9634514/multia"}, "reply_to_user": {"reputation": 2471, "user_id": 9482070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rovzT.jpg?s=128&g=1", "display_name": "Daniel Marcus", "link": "https://stackoverflow.com/users/9482070/daniel-marcus"}, "edited": false, "score": 0, "creation_date": 1525872743, "post_id": 50238570, "comment_id": 87526820, "body": "@Daniel Marcus Thanks but looks like lag function is not available in ms access"}, {"owner": {"reputation": 11, "user_id": 9634514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16adda792c5cc241d10e59c8341a3578?s=128&d=identicon&r=PG&f=1", "display_name": "MultiA", "link": "https://stackoverflow.com/users/9634514/multia"}, "reply_to_user": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "edited": false, "score": 0, "creation_date": 1525874196, "post_id": 50238570, "comment_id": 87527965, "body": "@Jiggles32 Hi Jiggles, what i am trying to do is to get all the records that are different from previous record in any of fields."}, {"owner": {"reputation": 2471, "user_id": 9482070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rovzT.jpg?s=128&g=1", "display_name": "Daniel Marcus", "link": "https://stackoverflow.com/users/9482070/daniel-marcus"}, "edited": false, "score": 0, "creation_date": 1525876896, "post_id": 50238570, "comment_id": 87529950, "body": "Without lag I think this will be tough to accomplish"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9634514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16adda792c5cc241d10e59c8341a3578?s=128&d=identicon&r=PG&f=1", "display_name": "MultiA", "link": "https://stackoverflow.com/users/9634514/multia"}, "edited": false, "score": 0, "creation_date": 1525873322, "post_id": 50239567, "comment_id": 87527250, "body": "Thanks and sorry my example data was misleading, there actually are gaps in my real data. i have tried similar SQL by using sub query and Max() function, but since my real data contains 1 million records and 20 fields i found it very slow to use sub query."}], "tags": [], "owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "is_accepted": false, "score": 0, "last_activity_date": 1525802023, "creation_date": 1525802023, "answer_id": 50239567, "question_id": 50238570, "link": "https://stackoverflow.com/questions/50238570/partially-group-records-in-access/50239567#50239567", "title": "Partially group records in access", "body": "<p>If the dates are consecutive with no gaps -- as in your example data -- you an do:</p>\n\n<pre><code>select t.*\nfrom t left join\n     t tprev\n     on t.orderno = tprev.orderno and t.date = dateadd(\"d\", 1, tprev.date)\nwhere tprev.orderno is null or\n      (tprev.etd &lt;&gt; t.etd or tprev.destination &lt;&gt; t.destination);\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9634514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16adda792c5cc241d10e59c8341a3578?s=128&d=identicon&r=PG&f=1", "display_name": "MultiA", "link": "https://stackoverflow.com/users/9634514/multia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525802023, "creation_date": 1525797984, "last_edit_date": 1525798944, "question_id": 50238570, "link": "https://stackoverflow.com/questions/50238570/partially-group-records-in-access", "title": "Partially group records in access", "body": "<p>I have a raw data table storing daily order snapshot and i am working on it to group consecutive order records with same information to return a query that only show the changes of each order no. and the date of change for further analysis.</p>\n\n<p>The raw data is like below:</p>\n\n<pre><code>Order no.     Date      ETD     Destination&lt;br/&gt;\n      01    5/1/2018  7/09/2018     City A&lt;br/&gt;\n      01    5/2/2018  7/16/2018     City A&lt;br/&gt;\n      01    5/3/2018  7/16/2018     City A&lt;br/&gt;\n      01    5/4/2018  7/09/2018     City A&lt;br/&gt;\n      01    5/5/2018  7/09/2018     City A&lt;br/&gt;\n      01    5/6/2018  7/09/2018     City A&lt;br/&gt;\n</code></pre>\n\n<p>And i would like the result to be:</p>\n\n<pre><code>Order no.     Date      ETD     Destination&lt;br/&gt;\n      01    5/1/2018  7/09/2018     City A&lt;br/&gt;\n      01    5/2/2018  7/16/2018     City A&lt;br/&gt;\n      01    5/4/2018  7/09/2018     City A&lt;br/&gt;\n</code></pre>\n\n<p>My current approach is to use VBA to loop through the sorted data set one by one to compare each record with previous one and extract it to another table if it is different.</p>\n\n<p>Since there are too many records the performance is time costing and i would like to ask if there is any other better solution.</p>\n\n<p>I've tried to use sub-query to link with previous day's data for comparison and it seems to be much more slower.</p>\n\n<p>Thanks for all the supports.</p>\n"}, {"tags": ["excel", "vba", "class", "dictionary"], "answers": [{"comments": [{"owner": {"reputation": 504, "user_id": 4090638, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/UyFjM.png?s=128&g=1", "display_name": "Gotrekk", "link": "https://stackoverflow.com/users/4090638/gotrekk"}, "edited": false, "score": 0, "creation_date": 1525869344, "post_id": 50238601, "comment_id": 87524296, "body": "Once you get the solution, it&#39;s always like... oh, it was so easy! But i lost few hours trying (and failing) to figure this &quot;easy&quot; thing out! thanks a lot"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 504, "user_id": 4090638, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/UyFjM.png?s=128&g=1", "display_name": "Gotrekk", "link": "https://stackoverflow.com/users/4090638/gotrekk"}, "edited": false, "score": 0, "creation_date": 1525869391, "post_id": 50238601, "comment_id": 87524335, "body": "No worries. Totally been there!"}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 5, "last_activity_date": 1525798431, "last_edit_date": 1525798431, "creation_date": 1525798088, "answer_id": 50238601, "question_id": 50238546, "link": "https://stackoverflow.com/questions/50238546/excel-vba-class-in-a-dictionary/50238601#50238601", "title": "Excel vba class in a dictionary", "body": "<p>You must set your <code>oMat</code> variable to a new instance of the <code>cOgg</code> class after adding it so you have two instances of the class object in your dictionary.</p>\n\n<pre><code>sub pivo()\n    Dim oMat As New cOgg\n    Dim sosdb As New Dictionary\n    Set sosdb = Nothing\n\n    oMat.desc= \"unodesc\"\n    oMat.alt= 5\n    sosdb.Add \"uno\", oMat\n\n    Set oMat = New cOgg\n    oMat.desc= \"duedesc\"\n    oMat.alt= 10\n    sosdb.Add \"due\", oMat\n    Debug.Print (sosdb(\"uno\").alt)\n    Debug.Print (sosdb(\"due\").alt)\nend sub\n</code></pre>\n\n<p>If you don't do this then the <code>oMat</code> in the <code>\"Uno\"</code> entry is getting updated after it's being added to be 10. Then you add the same exact instance of <code>cOgg</code> held in <code>oMat</code> to the <code>\"due\"</code> entry of the dictionary. So both <code>\"uno\"</code> and <code>\"due\"</code> hold the same instance of the object, which are identical and have an <code>alt</code> of <code>10</code></p>\n"}], "owner": {"reputation": 504, "user_id": 4090638, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/UyFjM.png?s=128&g=1", "display_name": "Gotrekk", "link": "https://stackoverflow.com/users/4090638/gotrekk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 986, "favorite_count": 0, "accepted_answer_id": 50238601, "answer_count": 1, "score": 2, "last_activity_date": 1525798431, "creation_date": 1525797880, "question_id": 50238546, "link": "https://stackoverflow.com/questions/50238546/excel-vba-class-in-a-dictionary", "title": "Excel vba class in a dictionary", "body": "<p>I'm adding class items to a dictionary but i'm unable to get them back. Do i need to loop or what am I doing wrong?</p>\n\n<p>My class module \"cOgg\" has:</p>\n\n<pre><code>Public desc As String\nPublic alt As Single\n</code></pre>\n\n<p>and my sub has:</p>\n\n<pre><code>sub pivo()\nDim oMat As New cOgg\nDim sosdb As New Dictionary\nSet sosdb = Nothing\n\noMat.desc= \"unodesc\"\noMat.alt= 5\nsosdb.Add \"uno\", oMat\n\noMat.desc= \"duedesc\"\noMat.alt= 10\nsosdb.Add \"due\", oMat\nDebug.Print (sosdb(\"uno\").alt)\nDebug.Print (sosdb(\"due\").alt)\nend sub\n</code></pre>\n\n<p>If i run the sub, i get :</p>\n\n<pre><code>10\n10\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>5\n10\n</code></pre>\n\n<p>Any ideas?</p>\n\n<p>Regards</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 0, "creation_date": 1525796760, "post_id": 50238127, "comment_id": 87493715, "body": "Be more precise than just &quot;not working properly&quot;. Is there an error code and message, and if so, which line is causing the error?"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1526225833, "post_id": 50238127, "comment_id": 87651244, "body": "Remove both instances of <code>On Error Resume Next</code>. Edit the question to include any errors that are being hidden."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9759687, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-plwscth9swU/AAAAAAAAAAI/AAAAAAAAAIg/Gs88er2Wq8M/photo.jpg?sz=128", "display_name": "Shenal Salgado", "link": "https://stackoverflow.com/users/9759687/shenal-salgado"}, "edited": false, "score": 0, "creation_date": 1525802508, "post_id": 50238937, "comment_id": 87496645, "body": "Hi Olly, I have tried this way previously but kept getting the following error. &quot;Run time error &#39;1004&#39;: Method &#39;EnvelopeVisible&#39; of object&#39;_&#39;Workbook&#39; failed. I tried using your code exactly as is and got the same error. - Thanks for your response!"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "reply_to_user": {"reputation": 11, "user_id": 9759687, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-plwscth9swU/AAAAAAAAAAI/AAAAAAAAAIg/Gs88er2Wq8M/photo.jpg?sz=128", "display_name": "Shenal Salgado", "link": "https://stackoverflow.com/users/9759687/shenal-salgado"}, "edited": false, "score": 0, "creation_date": 1525803325, "post_id": 50238937, "comment_id": 87497052, "body": "Hard to answer, here is a good link on emailing from excel <a href=\"https://msdn.microsoft.com/en-us/library/office/aa203718%28v=office.11%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/&hellip;</a>"}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1525799312, "creation_date": 1525799312, "answer_id": 50238937, "question_id": 50238127, "link": "https://stackoverflow.com/questions/50238127/vba-code-excel-range-not-pasting-to-outlook-properly/50238937#50238937", "title": "VBA Code: Excel range not pasting to outlook properly", "body": "<p>In most cases, using MailEnvelope works really well in excel.</p>\n\n<p>Practice with this code, run it, then check your outlook sent box.</p>\n\n<pre><code>Sub EmAiLtoDave()\n'Working in Excel 2002-2013\n    Dim Sendrng As Range\n\n    On Error GoTo StopMacro\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    Set Sendrng = Range(\"A1:E26\")\n    Sendrng.Select\n    'Create the mail and send it\n    With Sendrng\n\n        ActiveWorkbook.EnvelopeVisible = True\n        With .Parent.MailEnvelope\n\n            ' Set the optional introduction field thats adds\n            ' some header text to the email body.\n            .Introduction = \"Hi\"\n\n            With .Item\n                .To = \"SomeBody@Somewhere.com\"\n                .CC = \"\"\n                .BCC = \"\"\n                .Subject = \"EOD SWAPTION CHECK: \" &amp; Range(\"A1\")\n                .Send\n            End With\n\n        End With\n    End With\n\nStopMacro:\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n    End With\n    ActiveWorkbook.EnvelopeVisible = False\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9759687, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-plwscth9swU/AAAAAAAAAAI/AAAAAAAAAIg/Gs88er2Wq8M/photo.jpg?sz=128", "display_name": "Shenal Salgado", "link": "https://stackoverflow.com/users/9759687/shenal-salgado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 207, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1592993790, "creation_date": 1525796298, "last_edit_date": 1592993790, "question_id": 50238127, "link": "https://stackoverflow.com/questions/50238127/vba-code-excel-range-not-pasting-to-outlook-properly", "title": "VBA Code: Excel range not pasting to outlook properly", "body": "<p>Below is my code to paste over a range to Outlook to send an email but it is not working properly. Please help. </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n'Created by Shenal Salgado\n    Dim xOutApp As Object\n    Dim xOutMail As Object\n    Dim xMailBody As String\n    Dim rng As Range\n    On Error Resume Next\n    Set xOutApp = CreateObject(\"Outlook.Application\")\n    Set xOutMail = xOutApp.CreateItem(0)\n    Set rng = sh_main.Range(\"A1:E26\")\n    xMailBody = sh_main.Range(\"A1:E26\")\n                  On Error Resume Next\n    With xOutMail\n        .To = \"xxxxxxxxxx\"\n        .Cc = \"\"\n        .BCC = \"\"\n        .Subject = \"EOD SWAPTION CHECK: \" &amp; sh_main.Range(\"A1\")\n        .Body = xMailBody\n        .Display\n    End With\n    On Error GoTo 0\n    Set xOutMail = Nothing\n    Set xOutApp = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "selenium", "web-scraping", "selenium-chromedriver"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1525805415, "post_id": 50238062, "comment_id": 87498216, "body": "See: <a href=\"https://stackoverflow.com/questions/36590274/selenium-how-to-wait-until-page-is-completely-loaded\" title=\"selenium how to wait until page is completely loaded\">stackoverflow.com/questions/36590274/&hellip;</a>. Looks like there are few methods you can try there."}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1525806595, "post_id": 50238062, "comment_id": 87498861, "body": "Thanks @Ryan Wildry for your comment. The thing is there are options for <code>explicit wait</code> when it comes to work with selenium in combination with other languages but in case of <code>vba</code> I doubt there is any. At least i could not find anywhere."}], "answers": [{"tags": [], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "is_accepted": true, "score": 0, "last_activity_date": 1525812081, "creation_date": 1525812081, "answer_id": 50241962, "question_id": 50238062, "link": "https://stackoverflow.com/questions/50238062/unable-to-check-for-availability-of-any-element-removing-hardcoded-delay/50241962#50241962", "title": "Unable to check for availability of any element removing hardcoded delay", "body": "<p>Seems to have found the solution already. There is <a href=\"https://github.com/florentbr/SeleniumBasic/issues/69\" rel=\"nofollow noreferrer\">the link</a> leading to github where <code>Florent B.</code> has provided an excellent solution as to how the script should wait until the desired element is available.</p>\n\n<p>This is how the script should be:</p>\n\n<pre><code>Sub SearchItem()\n\n    With New ChromeDriver\n        .get \"https://torrentz2.eu/\"\n        .FindElementByCss(\"#thesearchbox\", timeout:=10000).SendKeys \"Udemy\"  ''wait for the element upto 10 seconds\n        .FindElementByCss(\"#thesearchbutton\").Click\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 510, "favorite_count": 0, "accepted_answer_id": 50241962, "answer_count": 1, "score": 0, "last_activity_date": 1525812081, "creation_date": 1525796041, "question_id": 50238062, "link": "https://stackoverflow.com/questions/50238062/unable-to-check-for-availability-of-any-element-removing-hardcoded-delay", "title": "Unable to check for availability of any element removing hardcoded delay", "body": "<p>I've written a script in vba in association with selenium to initiate a search in some torrent site. My script is doing fine but the problem is I had to use <code>hardcoded delay</code> within my script to make it successful. What I wish to do now is check for the availability of desired element using some loop or any of that sort by kicking out hardcoded delay from my script. Any help on this will be highly appreciated.</p>\n\n<p>This is my attempt so far (working one):</p>\n\n<pre><code>Sub SearchItem()\n\n    With New ChromeDriver\n        .get \"https://torrentz2.eu/\"\n\n        Application.Wait Now + TimeValue(\"00:00:10\")  ''I wish to shake this hardcoded delay off\n        .FindElementByCss(\"#thesearchbox\").SendKeys (\"Udemy\")\n        .FindElementByCss(\"#thesearchbutton\").Click\n    End With\nEnd Sub\n</code></pre>\n\n<p>Reference to add:</p>\n\n<pre><code>Selenium Type Library\n</code></pre>\n"}, {"tags": ["excel", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1525797865, "post_id": 50237989, "comment_id": 87494338, "body": "I&#39;m voting to close this question as off-topic because this belongs on <a href=\"https://codereview.stackexchange.com/\">CodeReview</a>"}, {"owner": {"reputation": 7441, "user_id": 1575353, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rvz3i.png?s=128&g=1", "display_name": "S\u1d00\u1d0d On\u1d07\u1d0c\u1d00", "link": "https://stackoverflow.com/users/1575353/s%e1%b4%80%e1%b4%8d-on%e1%b4%87%e1%b4%8c%e1%b4%80"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1525797932, "post_id": 50237989, "comment_id": 87494383, "body": "@BruceWayne It is okay to recommend the OP post on CR but in the future, please don&#39;t use Code Review as a reason to close a question. Evaluate the request and use a reason like <i>too broad</i>, <i>primarily opinion-based</i>, etc. Then you can mention to the OP that it can be posted on Code Review if it is <a href=\"https://codereview.stackexchange.com/help/on-topic\">on-topic</a>. Please see the section <b>What you should not do</b> in <a href=\"https://codereview.meta.stackexchange.com/a/5778/120114\">this answer to <i>A guide to Code Review for Stack Overflow users</i></a>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 7441, "user_id": 1575353, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rvz3i.png?s=128&g=1", "display_name": "S\u1d00\u1d0d On\u1d07\u1d0c\u1d00", "link": "https://stackoverflow.com/users/1575353/s%e1%b4%80%e1%b4%8d-on%e1%b4%87%e1%b4%8c%e1%b4%80"}, "edited": false, "score": 1, "creation_date": 1525799643, "post_id": 50237989, "comment_id": 87495283, "body": "@SamOnela - So I can recommend they post there, and if OP does, then wouldn&#39;t that be duplicating posts on SE?  Is that okay, having same exact question on two SE networks?  But thanks for the link to the guide, I&#39;ll read through it."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1525806929, "post_id": 50237989, "comment_id": 87499007, "body": "Nothing wrong with that code...you&#39;re doing everything right, and this will be as fast as it gets. Can you tell us more about the calculated fields you&#39;re using? Are they written using DAX? (I.e. is this a PowerPivot PivotTable) Or are these the old-school Calculated Fields available under traditional PivotTables? Maybe you could add a screenshot of the calculated fields to your question."}, {"owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "edited": false, "score": 0, "creation_date": 1525809729, "post_id": 50237989, "comment_id": 87500444, "body": "This is the old school calculated field used in pivottables. Unfortunately I&#39;m not able to use PowerPivot for this report. The calculated field is fairly straight forward. In the source data, there is 1 field for Employee Hours and 1 field for Employee Injuries. The calculated field is: =(sum(Employee Injuries)*200000)/sum(Hours)"}, {"owner": {"reputation": 7441, "user_id": 1575353, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rvz3i.png?s=128&g=1", "display_name": "S\u1d00\u1d0d On\u1d07\u1d0c\u1d00", "link": "https://stackoverflow.com/users/1575353/s%e1%b4%80%e1%b4%8d-on%e1%b4%87%e1%b4%8c%e1%b4%80"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1525813933, "post_id": 50237989, "comment_id": 87502233, "body": "@BruceWayne Presuming there are no answers, the OP can remove the post on one site and post it on another site (albeit after a grace period for new users). If there are answers on the original post, then hopefully closing the question would suffice..."}], "owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 210, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1525795696, "creation_date": 1525795696, "last_edit_date": 1531161705, "question_id": 50237989, "link": "https://stackoverflow.com/questions/50237989/speeding-up-vba-code-that-sets-pivot-table-filters", "title": "Speeding up VBA Code that Sets Pivot Table Filters", "body": "<p>I've written out some VBA code that sets various filters onto pivottables. The problem I am experiencing is that it is extremely slow and bogs down my system heavily.</p>\n\n<p>I've tried implementing various things to speed up the code, but nothing really has that much of an effect. </p>\n\n<p>The reason I am doing it this way is the filters need to be dynamic and I am using multiple data sources, so just using a single slicer doesn't work in my case.</p>\n\n<p>Here is my code:</p>\n\n<pre><code> Private Sub Worksheet_Calculate()\n\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n    Application.Calculation = xlCalculationManual\n    Application.DisplayStatusBar = False\n    ActiveSheet.DisplayPageBreaks = False\n\n\n    Dim DivRef, RegRef, DistRef, ZoneRef As String\n    DivRef = Sheet5.Range(\"AH6\").Value\n    RegRef = Sheet5.Range(\"AH7\").Value\n    DistRef = Sheet5.Range(\"AH8\").Value\n    ZoneRef = Sheet5.Range(\"AN4\").Value\n\nWith Sheet5.PivotTables(\"PivotTable21\")\n    .ManualUpdate = True\n    .PivotFields(\"Division2\").CurrentPage = DivRef\n    .PivotFields(\"Region2\").CurrentPage = RegRef\n    .PivotFields(\"District2\").CurrentPage = DistRef\n    .ManualUpdate = False\nEnd With\n\n\nWith Sheet5.PivotTables(\"PivotTable9\")\n    .ManualUpdate = True\n    .PivotFields(\"Division2\").CurrentPage = DivRef\n    .PivotFields(\"Region2\").CurrentPage = RegRef\n    .PivotFields(\"District2\").CurrentPage = DistRef\n    .ManualUpdate = False\n  End With\n\n     Application.EnableEvents = True\n     Application.ScreenUpdating = True\n     Application.Calculation = xlCalculationAutomatic\n\n    End Sub\n</code></pre>\n\n<p>In reality, there are a number of pivottables that are being filtered, but for the sake of this post, I am only posting PivotTable21 and PivotTable9's filters, though it is all more or less the same code.</p>\n\n<p>I've been told that part of the problem might be that I am using calculated fields in my pivottables, and that may bog down some of the code as well.</p>\n\n<p>Does anyone have any tips for speeding this code up?</p>\n"}, {"tags": ["vba", "excel", "internet-explorer", "getelementbyid"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1525796970, "post_id": 50237951, "comment_id": 87493819, "body": "Looking at your limited code, if you don&#39;t match the URL, you will never create the IE object. If your IE object is not set, it will very likely throw that error. Can you put a breakpoint on that line and check if IE object is set and pointing to the wright IE session?"}, {"owner": {"reputation": 101, "user_id": 9755520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a166fc9e855ffbdff566f2bd18c7159?s=128&d=identicon&r=PG&f=1", "display_name": "MW982", "link": "https://stackoverflow.com/users/9755520/mw982"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1525798160, "post_id": 50237951, "comment_id": 87494515, "body": "Good question. I checked using      [ MsgBox URL &amp; Chr(10) &amp; my_url ] and verified that the URLs match exactly."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1525798656, "post_id": 50237951, "comment_id": 87494767, "body": "ok, but is the IE object set as expected?"}, {"owner": {"reputation": 101, "user_id": 9755520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a166fc9e855ffbdff566f2bd18c7159?s=128&d=identicon&r=PG&f=1", "display_name": "MW982", "link": "https://stackoverflow.com/users/9755520/mw982"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1525798769, "post_id": 50237951, "comment_id": 87494816, "body": "Also, I verified that IE is set to &quot;Internet Explorer&quot; (the correct session of it) after [ Set IE = objShell.Windows(X) ]."}, {"owner": {"reputation": 101, "user_id": 9755520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a166fc9e855ffbdff566f2bd18c7159?s=128&d=identicon&r=PG&f=1", "display_name": "MW982", "link": "https://stackoverflow.com/users/9755520/mw982"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1525801163, "post_id": 50237951, "comment_id": 87495979, "body": "I added a modified screenshot of the webpage if that&#39;s helpful at all."}], "answers": [{"tags": [], "owner": {"reputation": 101, "user_id": 9755520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a166fc9e855ffbdff566f2bd18c7159?s=128&d=identicon&r=PG&f=1", "display_name": "MW982", "link": "https://stackoverflow.com/users/9755520/mw982"}, "is_accepted": false, "score": 2, "last_activity_date": 1525821237, "creation_date": 1525821237, "answer_id": 50243427, "question_id": 50237951, "link": "https://stackoverflow.com/questions/50237951/vba-excel-ie-getelementbyid-not-working-runtime-error-424-object-required/50243427#50243427", "title": "VBA Excel - IE GetElementByID not working - Runtime error 424 Object Required", "body": "<p>I found the answer! I should have posted just a little bit more of the web browser code in the picture above and someone else would have found it hours ago. Here it is with the extra code:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ea7Ln.jpg\" rel=\"nofollow noreferrer\">Larger screenshot of HTML code from webpage</a></p>\n\n<p>The top-left corner of the screenshot shows the tagname \"iframe\" (which is new to me today). The objects I need are contained within this iframe object. Once I found this out, I found <a href=\"https://stackoverflow.com/questions/16699267/vba-ie-automation-read-iframe?utm_medium=organic&amp;utm_source=google_rich_qa&amp;utm_campaign=google_rich_qa\">this discussion</a> which helped me create this line of code:</p>\n\n<pre><code>Set objCollection = IE.Document.getElementsByTagName(\"iframe\")(1).contentDocument.getElementsByTagName(\"input\")\n</code></pre>\n\n<p>(The value of (1) is because I have two iframe objects and I am using the second one.)</p>\n\n<p>Once I have this, it is just a matter of looking for the object with the correct ID in the collection! </p>\n\n<p>I could dance for joy!</p>\n"}], "owner": {"reputation": 101, "user_id": 9755520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a166fc9e855ffbdff566f2bd18c7159?s=128&d=identicon&r=PG&f=1", "display_name": "MW982", "link": "https://stackoverflow.com/users/9755520/mw982"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2722, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1529333723, "creation_date": 1525795594, "last_edit_date": 1529333723, "question_id": 50237951, "link": "https://stackoverflow.com/questions/50237951/vba-excel-ie-getelementbyid-not-working-runtime-error-424-object-required", "title": "VBA Excel - IE GetElementByID not working - Runtime error 424 Object Required", "body": "<p>I'm having trouble getting Excel VBA (Office 2016) to control IE (version 11). I need to enter information into several fields in a form and click on a few radio buttons. I've identified the object IDs for all the fields I need to modify. My code is copied/modified from mature code that I wrote a few years ago to do similar things on another web site. Though it continues to work on the other website today, it isn't working here. Unfortunately, it is a proprietary website, so I can't share the link, but here is some of my code and a portion of the web page code:</p>\n\n<pre><code>Sample of my code:\nDim IE As Object, objShell As Object, objCollection As Object\n\n' Take control of the webpage:\n\n' Get the page url\nURL = \"---------\"\n\n' Find the correct instance of IE\nmarker = 0\nSet objShell = CreateObject(\"Shell.Application\")\nIE_count = objShell.Windows.Count\nFor X = 0 To (IE_count - 1)\n    On Error Resume Next\n    my_title = objShell.Windows(X).Document.Title\n    my_url = objShell.Windows(X).LocationURL\n    If IsEmpty(my_url) Then\n        my_url = objShell.Windows(X).Document.Location\n    End If\n\n    If my_url Like Left(URL, 45) &amp; \"*\" Then 'compare to find if the desired web page is already open\n        Set IE = objShell.Windows(X)\n        marker = 1\n        Exit For\n    Else\n    End If\nNext\nIf marker = 0 Then\n    MsgBox (\"Webpage not found. Please login manually.\")\n    Exit Sub\nEnd If\nOn Error GoTo -1\nOn Error GoTo 0\n' Wait if necessary\nDo Until (IE.ReadyState = 4 And Not IE.Busy)\n    DoEvents\n    Application.StatusBar = \"Waiting for Internet Explorer.\"\nLoop\nApplication.StatusBar = False\n\n' Set objCollection object\nSet objCollection = IE.Document.getElementByID(\"QSHAA5V0GH4LSAO2AI5R2M853SJ5AI\") \n' This is the actual ID of one of the fields I need to enter data into (see screenshot below)\n' The above line gives the familiar \"Runtime error 424 Object Required\" error.\n</code></pre>\n\n<h3>Screenshot of HTML code for webpage</h3>\n\n<p><img src=\"https://i.stack.imgur.com/8zYV3.jpg\" alt=\"Screenshot of HTML code for webpage\"></p>\n\n<p>Why would this work for one website and not another?</p>\n\n<p>As an additional note: when I use </p>\n\n<pre><code>Set objCollection = IE.Document.getElementsByClassName(\"Class\")\nMsgBox objCollection.Length\n</code></pre>\n\n<p>it sometimes results in one or more objects being collected, but usually results in zero. Once I have the object I need in the collector I'm good, but I'm not there yet.</p>\n\n<p>If you see a mistake I'm making, I would be very grateful to learn about it, as I'm very confused right now.</p>\n\n<p>I have the following libraries included:</p>\n\n<p>Visual Basic For Applications</p>\n\n<p>Microsoft Excel 16.0 Object Library</p>\n\n<p>OLE Automation</p>\n\n<p>Microsoft Office 16.0 Object Library</p>\n\n<p>Microsoft Forms 2.0 Object Library</p>\n\n<p>Microsoft ActiveX Data Objects 6.1 Library</p>\n\n<p>Microsoft Internet Controls</p>\n\n<p>Microsoft HTML Object Library</p>\n\n<p>***** Here is a (modified) screenshot of the webpage I am working with if that helps at all. *****</p>\n\n<p><img src=\"https://i.stack.imgur.com/wMJ0U.jpg\" alt=\"Webpage screenshot\"></p>\n\n<p>Looking at the screenshot, should I be looking for an object within an object? Do I need to find the parent object (the protruding form within the web page) before I can find the child object (field on the form)?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9759327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a61d3666d8bda947f276d8b40d6521d2?s=128&d=identicon&r=PG&f=1", "display_name": "Bla2eee", "link": "https://stackoverflow.com/users/9759327/bla2eee"}, "edited": false, "score": 1, "creation_date": 1525800105, "post_id": 50237976, "comment_id": 87495514, "body": "Thank you so much for your response, SJR. This is what I was looking for and works perfectly as my intended use. To your question regarding calling two procedures is my lack of knowledge on this subject, saw some guides/ tutorials online and hence came up with the code. Again, thanks for your help and swift response. Much appreciated."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 3, "user_id": 9759327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a61d3666d8bda947f276d8b40d6521d2?s=128&d=identicon&r=PG&f=1", "display_name": "Bla2eee", "link": "https://stackoverflow.com/users/9759327/bla2eee"}, "edited": false, "score": 0, "creation_date": 1525800655, "post_id": 50237976, "comment_id": 87495764, "body": "It&#39;s my pleasure."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1525795667, "creation_date": 1525795667, "answer_id": 50237976, "question_id": 50237852, "link": "https://stackoverflow.com/questions/50237852/excel-vba-auto-hide-unhide-rows-mulitiple-cell-selection/50237976#50237976", "title": "Excel VBA auto hide/ unhide rows - mulitiple cell selection", "body": "<p>I think you can simplify it thus, but I may not have fully understood your intentions as to hiding rows. If B1 is No, should rows 2 and 3 remain hidden irrespective of the value of B4?</p>\n\n<p>I'm not sure what the rng variable was intended to do but I don't think you need it and you can apply a general rule to hiding/showing.</p>\n\n<p>Also, why call two other procedures (you may have a good reason)?</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf Target.Address = \"$B$1\" Or Target.Address = \"$B$4\" Then\n    'Cells.EntireRow.Hidden = False\n    Select Case Target.Value\n        Case \"Yes\": Target.Offset(1).Resize(2).EntireRow.Hidden = False\n        Case \"No\": Target.Offset(1).Resize(2).EntireRow.Hidden = True\n    End Select\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1525798050, "post_id": 50238233, "comment_id": 87494452, "body": "Thanks. Good point about code indentation though. Your code is triggered whenever any cell is changed so I would suggest restricting it to B1 and B4."}, {"owner": {"reputation": 3, "user_id": 9759327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a61d3666d8bda947f276d8b40d6521d2?s=128&d=identicon&r=PG&f=1", "display_name": "Bla2eee", "link": "https://stackoverflow.com/users/9759327/bla2eee"}, "edited": false, "score": 0, "creation_date": 1525800660, "post_id": 50238233, "comment_id": 87495765, "body": "Thank rcriii. New to the coding world. I am QA engineer and doing this exercise to learn something new. Acknowledge about code indentation, will keep that in mind for future. Thanks for the other tips as well. Again, your code works perfectly as well and is more similar to the one i presented in my question above. Thanks for your help, appreciate it."}], "tags": [], "owner": {"reputation": 614, "user_id": 1072246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b7fe892ad6e2a6ee00ae845906e7053?s=128&d=identicon&r=PG", "display_name": "rcriii", "link": "https://stackoverflow.com/users/1072246/rcriii"}, "is_accepted": false, "score": 0, "last_activity_date": 1525796692, "creation_date": 1525796692, "answer_id": 50238233, "question_id": 50237852, "link": "https://stackoverflow.com/questions/50237852/excel-vba-auto-hide-unhide-rows-mulitiple-cell-selection/50238233#50238233", "title": "Excel VBA auto hide/ unhide rows - mulitiple cell selection", "body": "<p>The issue is in the line <code>Cells.EntireRow.Hidden = False</code>. When you change B1, that line first unhides everything (including rows 4 and 5), then decides whether to hide rows 2 and 3.</p>\n\n<p>The variable rng is never used.</p>\n\n<p>The following explicitly checks the relevant cells in each subroutine. However, if you have expensive calculations, then you might want to include the line <code>If Target.Address &lt;&gt; Range(\"B1\").Address Then Exit Sub</code> from your implementation.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Worksheet_Change_A Target\n    Worksheet_Change_B Target\nEnd Sub\nPrivate Sub Worksheet_Change_A(ByVal Target As Range)\n    Select Case Range(\"B1\").Value\n        Case \"Yes\": Range(\"2:3\").EntireRow.Hidden = False\n        Case \"No\": Range(\"2:3\").EntireRow.Hidden = True\n    End Select\nEnd Sub\nPrivate Sub Worksheet_Change_B(ByVal Target As Range)\n    Select Case Range(\"B4\").Value\n        Case \"Yes\": Range(\"5:6\").EntireRow.Hidden = False\n        Case \"No\": Range(\"5:6\").EntireRow.Hidden = True\n    End Select\nEnd Sub\n</code></pre>\n\n<p>I highly recommend indenting your code as I've shown, for readability. I used <code>Range(\"B4\").Value</code> to explicitly show that I am using the cell contents. Lastly, the VBA debugger is your friend for tracking down issues like this. Click on the line of code you are interested about (or just before it), then in the VBA menu click Debug->Toggle Breakpoint (or F9). Then run the macro and the debugger wil stop at that line of code. You can inspect variables by hovering over them, step through the code or out of the sub. Very useful in cases like yours where you are not sure what is causing the issue.</p>\n\n<p>Edit: SJRs solution is more elegant, in that it is more easily extensible if you want to add more ranges to hide.</p>\n"}], "owner": {"reputation": 3, "user_id": 9759327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a61d3666d8bda947f276d8b40d6521d2?s=128&d=identicon&r=PG&f=1", "display_name": "Bla2eee", "link": "https://stackoverflow.com/users/9759327/bla2eee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 920, "favorite_count": 0, "accepted_answer_id": 50237976, "answer_count": 2, "score": 0, "last_activity_date": 1525798268, "creation_date": 1525795222, "last_edit_date": 1531164843, "question_id": 50237852, "link": "https://stackoverflow.com/questions/50237852/excel-vba-auto-hide-unhide-rows-mulitiple-cell-selection", "title": "Excel VBA auto hide/ unhide rows - mulitiple cell selection", "body": "<p>I am trying to <strong>hide/unhide rows based on the list value</strong> selected in a cell (Yes/No).</p>\n\n<p>Scenario is that there are two drop-down lists (in Cell <code>B1</code> and <code>B4</code>), when the value of Cell <code>B1</code> is selected as <code>'No'</code>, then <code>rows 2 and 3</code> needs to be hidden else if value Yes is selected in <code>B1</code>, then <code>rows 2 and 3</code> to unhide. </p>\n\n<p>Similarly, when the value of Cell <code>B4</code> is selected as <code>'No'</code>, then <code>rows 5 and 6</code> needs to be hidden else if value Yes is selected in <code>B4</code>, then <code>rows 5 and 6</code> to unhide. </p>\n\n<p>I have a working code (as shown below) but when I select a different drop down selection (say I have selected b1 as No initially and then went to B4 to select No)  then my hidden rows dont remain hidden anymore and the rows are displayed (inspite of the selection being selected as No). </p>\n\n<p>My Code as follows.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Worksheet_Change_A Target\n    Worksheet_Change_B Target\nEnd Sub  \n\nPrivate Sub Worksheet_Change_A(ByVal Target As Range)\n    Dim rng As Range      \n    Set rng = Target.Parent.Range(\"B1\") \n    If Target.Address &lt;&gt; Range(\"B1\").Address Then \n        Exit Sub \n    Cells.EntireRow.Hidden = False\n    Select Case Range(\"B1\")   \n        Case \"Yes\": \n            Range(\"2:3\").EntireRow.Hidden = False\n        Case \"No\": \n            Range(\"2:3\").EntireRow.Hidden = True \n    End Select\nEnd Sub  \n\nPrivate Sub Worksheet_Change_B(ByVal Target As Range)\n    Dim rng As Range\n    Set rng = Target.Parent.Range(\"B4\") \n\n    If Target.Address &lt;&gt; Range(\"B4\").Address Then \n        Exit Sub\n    Cells.EntireRow.Hidden = False\n    Select Case Range(\"B4\")  \n        Case \"Yes\": Range(\"5:6\").EntireRow.Hidden = False\n        Case \"No\": Range(\"5:6\").EntireRow.Hidden = True\n    End Select\nEnd Sub\n</code></pre>\n\n<p>Please note that I am a beginner in coding and trying to grow as I learn. </p>\n\n<p>Your help is greatly appreciated. Please do let me know of you need any clarifications with respect to the scenario explained. </p>\n\n<p>Thanks. </p>\n"}]