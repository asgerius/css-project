[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5852, "user_id": 1690392, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/A3DKR.jpg?s=128&g=1", "display_name": "nutsch", "link": "https://stackoverflow.com/users/1690392/nutsch"}, "edited": false, "score": 0, "creation_date": 1433372702, "post_id": 30632266, "comment_id": 49330196, "body": "Use an <code>autofilter</code> and <code>specialcells(xlcelltypevisible)</code>"}, {"owner": {"reputation": 103, "user_id": 4971563, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DqnL5KA_M2c/AAAAAAAAAAI/AAAAAAAAADg/ik6eXshNVXA/photo.jpg?sz=128", "display_name": "Pfantastic", "link": "https://stackoverflow.com/users/4971563/pfantastic"}, "reply_to_user": {"reputation": 5852, "user_id": 1690392, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/A3DKR.jpg?s=128&g=1", "display_name": "nutsch", "link": "https://stackoverflow.com/users/1690392/nutsch"}, "edited": false, "score": 0, "creation_date": 1433431479, "post_id": 30632266, "comment_id": 49359519, "body": "Thanks all! I ended up using the combined solution of Nutsch and Dan. I hadn&#39;t even thought about using an array, and the autofilter is genius!  I&#39;m also planning on trying L42&#39;s solution to see if there is a noticable increase in performance with large files."}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1433454761, "post_id": 30632266, "comment_id": 49372411, "body": "Glad you got it working, L42&#39;s code is very good, the only thing I am not keen on is multiplying values, are you guaranteed that you will never get two values that give the same multiplied number? for a very basic example if you had 3 in Col A and 4 in Col C that would give a match the same as 2 in Col A and 6 in Col C. You would have no way to differentiate them."}, {"owner": {"reputation": 103, "user_id": 4971563, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DqnL5KA_M2c/AAAAAAAAAAI/AAAAAAAAADg/ik6eXshNVXA/photo.jpg?sz=128", "display_name": "Pfantastic", "link": "https://stackoverflow.com/users/4971563/pfantastic"}, "edited": false, "score": 0, "creation_date": 1433456344, "post_id": 30632266, "comment_id": 49373017, "body": "I really appreciate your help Dan - I was worried about the multiplication as well, which is why I gave your code a shot first. But there are only five facility numbers total and they are far enough apart that there is no chance in getting the same number when multiplying with the departments. But you&#39;re right, someone with more options (or numbers with fewer digits) in their columns might be better off trying to autofilter."}], "answers": [{"tags": [], "owner": {"reputation": 414, "user_id": 3750262, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/903190092/picture?type=large", "display_name": "Greg", "link": "https://stackoverflow.com/users/3750262/greg"}, "is_accepted": false, "score": 0, "last_activity_date": 1433425240, "last_edit_date": 1433425240, "creation_date": 1433372877, "answer_id": 30632371, "question_id": 30632266, "link": "https://stackoverflow.com/questions/30632266/vba-loop-and-inefficient-if-statements/30632371#30632371", "title": "VBA - Loop and Inefficient If Statements", "body": "<p>Interacting with Excel is relatively expensive. Try reading the entire dataset into memory, manipulating it there, and then writing the entire new dataset back.</p>\n\n<p>If the dataset if too big to fit into RAM, you could do this in pieces.</p>\n\n<pre><code>Dim Arr() As Variant\nArr = Range(\"A1:C100000\")\n\nFor i = 1 to 100000\n    If Arr(i, 1) = 10000 And Arr(i, 3) = 11040 Then\n    .\n    .\n    .\nNext\n\nRange(\"A1:C100000\") = Arr\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1433374184, "post_id": 30632408, "comment_id": 49330689, "body": "Great solution, hope you don&#39;t mind I poached your code and added to my solution"}], "tags": [], "owner": {"reputation": 5852, "user_id": 1690392, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/A3DKR.jpg?s=128&g=1", "display_name": "nutsch", "link": "https://stackoverflow.com/users/1690392/nutsch"}, "is_accepted": false, "score": 5, "last_activity_date": 1433373151, "creation_date": 1433373151, "answer_id": 30632408, "question_id": 30632266, "link": "https://stackoverflow.com/questions/30632266/vba-loop-and-inefficient-if-statements/30632408#30632408", "title": "VBA - Loop and Inefficient If Statements", "body": "<p>Here's how I would do it, using autofilter to replace blocks of lines at once and disabling the screen update to reduce processing time.</p>\n\n<pre><code>Dim lRow As Long\n\nlRow = Cells(Rows.Count, \"A\").End(xlUp).Row\n\napplication.screenupdating=false\n\nWith Range(\"A1:C\" &amp; lRow)\n    .AutoFilter\n\n    .AutoFilter Field:=3, Criteria1:=Array( _\n        \"11040\", \"11050\", \"11060\", \"11070\"), Operator:=xlFilterValues\n    .AutoFilter Field:=1, Criteria1:=\"10000\"\n    .Columns(3).Resize(.Rows.Count - 1).Offset(1).SpecialCells(xlCellTypeVisible).Value = 11000\n\n    .AutoFilter Field:=3, Criteria1:=\"10120\", Operator:=xlFilterValues\n    .AutoFilter Field:=1, Criteria1:=\"21000\"\n    .Columns(3).Resize(.Rows.Count - 1).Offset(1).SpecialCells(xlCellTypeVisible).Value = 10130\n\n    .AutoFilter Field:=3, Criteria1:=\"10160\", Operator:=xlFilterValues\n    .Columns(3).Resize(.Rows.Count - 1).Offset(1).SpecialCells(xlCellTypeVisible).Value = 10050\n\n    'etc., etc.\n\nEnd With\n\napplication.screenupdating=true\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 103, "user_id": 4971563, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DqnL5KA_M2c/AAAAAAAAAAI/AAAAAAAAADg/ik6eXshNVXA/photo.jpg?sz=128", "display_name": "Pfantastic", "link": "https://stackoverflow.com/users/4971563/pfantastic"}, "edited": false, "score": 0, "creation_date": 1433450520, "post_id": 30632520, "comment_id": 49370515, "body": "I&#39;ve edited my original post, is there any chance you can provide any additional clarification?"}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 1, "last_activity_date": 1433374134, "last_edit_date": 1433374134, "creation_date": 1433373826, "answer_id": 30632520, "question_id": 30632266, "link": "https://stackoverflow.com/questions/30632266/vba-loop-and-inefficient-if-statements/30632520#30632520", "title": "VBA - Loop and Inefficient If Statements", "body": "<p>Just playing around with the code here, this is the same as your code but shorter, Arrays are more manageable than big lists of ifs:</p>\n\n<pre><code>Sub dept_loop()\n    Dim i As Long, CellA As Variant, CellC As Variant, NewCellC As Variant\n    CellA = Array(10000, 10000, 10000, 10000, 10000, 21000, 21000, 22000, 22000, 22000, 22000, 22000, 22000, 22000, 22000, 22000, 23000, 23000, 23000, 23000, 23000, 23000, 23000)\n    CellB = Array(11040, 11404, 11050, 11060, 11070, 10120, 10160, 11910, 11915, 14800, 14820, 15700, 20420, 20440, 21190, 21195, 10760, 11030, 11360, 11370, 11600, 11620, 11660)\n    NewCellC = Array(11000, 11000, 11000, 11000, 11000, 10130, 10050, 10000, 10000, 14000, 10000, 20040, 20400, 20400, 21000, 21000, 10750, 14000, 11300, 10000, 11700, 11700, 11700)\n    For i = 1 To Cells(Rows.Count, \"A\").End(xlUp).Row\n        For X = LBound(CellA) To UBound(CellA)\n            If Cells(i, 1).text = CellA(X) And Cells(i, 3).text = CellC(X) Then\n                Cells(i, 3).Formula = NewCellC(X)\n                Exit For\n            End If\n        Next\n    Next\nEnd Sub\n</code></pre>\n\n<p>As for a better way to do this, I would probably lean towards a none VBA solution using a matrix on a hidden sheet and creating vlookups based on the concatenation of cell A and C. It would have to be in another column (ie it can't be self referential) but would that be a problem?</p>\n\n<p>Edit: Combined Nutsch's awesome idea with my Array code (Left old code above for completeness):</p>\n\n<pre><code>Sub dept_loop()\n    CellA As Variant, CellC As Variant, NewCellC As Variant\n    CellA = Array(10000, 10000, 10000, 10000, 10000, 21000, 21000, 22000, 22000, 22000, 22000, 22000, 22000, 22000, 22000, 22000, 23000, 23000, 23000, 23000, 23000, 23000, 23000)\n    CellB = Array(11040, 11404, 11050, 11060, 11070, 10120, 10160, 11910, 11915, 14800, 14820, 15700, 20420, 20440, 21190, 21195, 10760, 11030, 11360, 11370, 11600, 11620, 11660)\n    NewCellC = Array(11000, 11000, 11000, 11000, 11000, 10130, 10050, 10000, 10000, 14000, 10000, 20040, 20400, 20400, 21000, 21000, 10750, 14000, 11300, 10000, 11700, 11700, 11700)\n    Application.ScreenUpdating = False\n    With Range(\"A1:C\" &amp; Cells(Rows.Count, \"A\").End(xlUp).Row)\n        .AutoFilter\n        For X = LBound(CellA) To UBound(CellA)\n            .AutoFilter Field:=3, Criteria1:=CellC, Operator:=xlFilterValues\n            .AutoFilter Field:=1, Criteria1:=CellA\n            .Columns(3).Resize(.Rows.Count - 1).Offset(1).SpecialCells(xlCellTypeVisible).Value = NewCellC\n        Next\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": true, "score": 1, "last_activity_date": 1433379730, "last_edit_date": 1433379730, "creation_date": 1433377148, "answer_id": 30632961, "question_id": 30632266, "link": "https://stackoverflow.com/questions/30632266/vba-loop-and-inefficient-if-statements/30632961#30632961", "title": "VBA - Loop and Inefficient If Statements", "body": "<p>Try this:</p>\n\n<pre><code>Sub conscious()\n    Dim MulArr, ResArr, RngArr, pos\n    Dim i As Long, lrow As Long, x As Long\n\n    ' Multiply your value1 and value2\n    MulArr = Array(110400000, 114040000, 110500000, 110600000, 110700000, _\n                   212520000, 213360000, 262020000, 262130000, 325600000, _\n                   326040000, 345400000, 449240000, 449680000, 466180000, _\n                   466290000, 247480000, 253690000, 261280000, 261510000, _\n                   266800000, 267260000, 268180000)\n    ' Result array\n    ResArr = Array(11000, 11000, 11000, 11000, 11000, 10130, 10050, 10000, 10000, 14000, _\n                 10000, 20040, 20400, 20400, 21000, 21000, 10750, 14000, 11300, 10000, _\n                 11700, 11700, 11700)\n\n    With Sheets(\"Sheet1\") ' Try to be explicit always\n        lrow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n        RngArr = .Range(\"A1:C\" &amp; lrow) ' Use 2D array\n        For i = LBound(RngArr, 1) To UBound(RngArr, 1) ' Manipulate the array\n            x = RngArr(i, 1) * RngArr(i, 3): pos = Application.Match(x, MulArr, 0)\n            If Not IsError(pos) Then RngArr(i, 3) = Application.Index(ResArr, pos)\n        Next\n        .Range(\"A1:C\" &amp; lrow) = RngArr ' Return the array to Range\n    End With\nEnd Sub\n</code></pre>\n\n<p>First, you need to create a new array <code>MulArr</code> which is the multiplication of your values.<br>\nCreate a second array <code>ResArr</code> which contains your resulting values.<br>\nThen transfer your range value in a 2D array <code>RngArr</code> (it is automatic) and manipulate it.<br>\nAnd then finally, transfer it back to your range.<br>\nI have added comments in the actual code so it shouldn't be hard to follow.</p>\n\n<p><strong>Speed:</strong> This took 2.12 secs in my machine dealing with 100k data. I think it can rival the autofilter in terms of speed.</p>\n"}], "owner": {"reputation": 103, "user_id": 4971563, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DqnL5KA_M2c/AAAAAAAAAAI/AAAAAAAAADg/ik6eXshNVXA/photo.jpg?sz=128", "display_name": "Pfantastic", "link": "https://stackoverflow.com/users/4971563/pfantastic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 30632961, "answer_count": 4, "score": 3, "last_activity_date": 1433453435, "creation_date": 1433372291, "last_edit_date": 1433453435, "question_id": 30632266, "link": "https://stackoverflow.com/questions/30632266/vba-loop-and-inefficient-if-statements", "title": "VBA - Loop and Inefficient If Statements", "body": "<p>I have written VBA code that is passable, but it takes a long time and is difficult to upkeep. I use this to roll up several sub departments into a single department. Basically, I have two columns:</p>\n\n<p>\"A\" - contains 5 digit facility numbers</p>\n\n<p>\"C\" - contains 5 digit department numbers</p>\n\n<p>My code loops through each row and replaces department numbers if the facility and department match the condition:</p>\n\n<pre><code>Sub dept_loop()\n\n    Dim i As Long\n    Dim lRow As Long\n\nlRow = Cells(Rows.Count, \"A\").End(xlUp).Row\n\nFor i = 1 To lRow\n\n    If Cells(i, \"A\") = 10000 And Cells(i, \"C\") = 11040 Then\n        Cells(i, \"C\") = 11000\n    ElseIf Cells(i, \"A\") = 10000 And Cells(i, \"C\") = 11040 Then\n        Cells(i, \"C\") = 11000\n    ElseIf Cells(i, \"A\") = 10000 And Cells(i, \"C\") = 11050 Then\n        Cells(i, \"C\") = 11000\n    ElseIf Cells(i, \"A\") = 10000 And Cells(i, \"C\") = 11060 Then\n        Cells(i, \"C\") = 11000\n    ElseIf Cells(i, \"A\") = 10000 And Cells(i, \"C\") = 11070 Then\n        Cells(i, \"C\") = 11000\n    ElseIf Cells(i, \"A\") = 21000 And Cells(i, \"C\") = 10120 Then\n        Cells(i, \"C\") = 10130\n    ElseIf Cells(i, \"A\") = 21000 And Cells(i, \"C\") = 10160 Then\n        Cells(i, \"C\") = 10050\n    ElseIf Cells(i, \"A\") = 22000 And Cells(i, \"C\") = 11910 Then\n        Cells(i, \"C\") = 10000\n    ElseIf Cells(i, \"A\") = 22000 And Cells(i, \"C\") = 11915 Then\n        Cells(i, \"C\") = 10000\n    ElseIf Cells(i, \"A\") = 22000 And Cells(i, \"C\") = 14800 Then\n        Cells(i, \"C\") = 14000\n    ElseIf Cells(i, \"A\") = 22000 And Cells(i, \"C\") = 14820 Then\n        Cells(i, \"C\") = 10000\n    ElseIf Cells(i, \"A\") = 22000 And Cells(i, \"C\") = 15700 Then\n        Cells(i, \"C\") = 20040\n    ElseIf Cells(i, \"A\") = 22000 And Cells(i, \"C\") = 20420 Then\n        Cells(i, \"C\") = 20400\n    ElseIf Cells(i, \"A\") = 22000 And Cells(i, \"C\") = 20440 Then\n        Cells(i, \"C\") = 20400\n    ElseIf Cells(i, \"A\") = 22000 And Cells(i, \"C\") = 21190 Then\n        Cells(i, \"C\") = 21000\n    ElseIf Cells(i, \"A\") = 22000 And Cells(i, \"C\") = 21195 Then\n        Cells(i, \"C\") = 21000\n    ElseIf Cells(i, \"A\") = 23000 And Cells(i, \"C\") = 10760 Then\n        Cells(i, \"C\") = 10750\n    ElseIf Cells(i, \"A\") = 23000 And Cells(i, \"C\") = 11030 Then\n        Cells(i, \"C\") = 14000\n    ElseIf Cells(i, \"A\") = 23000 And Cells(i, \"C\") = 11360 Then\n        Cells(i, \"C\") = 11300\n    ElseIf Cells(i, \"A\") = 23000 And Cells(i, \"C\") = 11370 Then\n        Cells(i, \"C\") = 10000\n    ElseIf Cells(i, \"A\") = 23000 And Cells(i, \"C\") = 11600 Then\n        Cells(i, \"C\") = 11700\n    ElseIf Cells(i, \"A\") = 23000 And Cells(i, \"C\") = 11620 Then\n        Cells(i, \"C\") = 11700\n    ElseIf Cells(i, \"A\") = 23000 And Cells(i, \"C\") = 11660 Then\n        Cells(i, \"C\") = 11700\nEnd If\n\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>Is there a better way I could be doing this?\nI loop this through hundreds of thousands of records and it takes forever..</p>\n\n<p>EDIT*\nI've finally had a chance to build this out and give it a try. I've encountered an error that I cannot figure out. I'm getting a runtime error '424': Object required as soon as I get to the first .autofilter in the loop.</p>\n\n<p>@Nutsch or @Dan -- any ideas?</p>\n\n<p>Here is the new code I've written:</p>\n\n<p>Sub dept_loop()</p>\n\n<pre><code>Dim BU As Variant, Dept As Variant, NewDept As Variant\nDim lRow As Long, lColumn As Long\n\n'Array of facilities/business units (Roll From)\nBU = Array(10000, 10000, 10000, 10000, 10000, 21000, 21000, 22000, _\n           22000, 21000, 21000, 23000, 23000, 22000, 21000, 21000, _\n           21000, 22000, 24000, 21000, 21000, 24000, 21000, 21000, _\n           23000, 22000, 21000, 22000, 21000, 25000, 23000, 25000, _\n           22000, 22000, 22000, 24000, 24000, 23000, 23000, 22000, _\n           22000, 24000, 23000, 23000, 25000, 25000, 23000, 25000, _\n           24000, 23000, 23000, 25000, 25000, 25000, 24000, 24000, _\n           25000, 25000, 21000, 21000, 21000, 22000, 22000, 23000, _\n           23000, 22000, 24000, 24000, 25000, 25000, 21000, 21000, _\n           21000, 21000, 22000, 22000, 22000, 22000, 23000, 23000, _\n           22000, 22000, 23000, 23000, 23000, 21000, 24000, 24000, _\n           24000, 24000, 25000, 22000, 25000, 25000, 25000, 23000, _\n           24000, 25000, 22000, 21000, 22000, 23000, 24000, 25000, _\n           21000, 22000, 21000, 22000, 23000, 24000, 25000, 22000)\n\n'Array of departments (Roll From)\nDept = Array(11040, 11040, 11050, 11060, 11070, 10120, 10160, 10120, _\n             10160, 10760, 11030, 10120, 10160, 10760, 11360, 11370, _\n             11371, 11030, 10120, 11570, 11600, 10160, 11620, 11660, _\n             10760, 11360, 11910, 11370, 11915, 10120, 11030, 10160, _\n             11600, 11620, 11660, 10700, 10760, 11360, 11370, 11910, _\n             11915, 11030, 11600, 11620, 10700, 10701, 11660, 10760, _\n             11370, 11910, 11915, 11030, 11360, 11370, 11910, 11915, _\n             11910, 11915, 14800, 14820, 14840, 14800, 14820, 14800, _\n             14820, 15700, 14800, 14820, 14800, 14820, 20420, 20440, _\n             21190, 21195, 20420, 20440, 21190, 21195, 20420, 20440, _\n             21800, 21820, 21155, 21190, 21195, 23250, 20440, 21155, _\n             21190, 21195, 20440, 23250, 21155, 21190, 21195, 23250, _\n             23250, 23250, 26500, 28950, 28950, 28950, 28950, 28950, _\n             39011, 39011, 46100, 46100, 46100, 46100, 46100, 88220)\n\n'Array of new departments (Roll To)\nNewDept = Array(11000, 11000, 11000, 11000, 11000, 10130, 10050, 10130, _\n                10050, 10750, 14000, 10130, 10050, 10750, 11300, 10000, _\n                10130, 14000, 10130, 10000, 11700, 10050, 11700, 11700, _\n                10750, 11300, 10000, 10000, 10000, 10130, 14000, 10050, _\n                11700, 11700, 11700, 10000, 10750, 11300, 10000, 10000, _\n                10000, 14000, 11700, 11700, 10000, 10000, 11700, 10750, _\n                10000, 10000, 10000, 14000, 11300, 10000, 10000, 10000, _\n                10000, 10000, 14000, 10000, 10000, 14000, 10000, 14000, _\n                10000, 20040, 14000, 10000, 14000, 10000, 20400, 20400, _\n                21000, 21000, 20400, 20400, 21000, 21000, 20400, 20400, _\n                25040, 24400, 21150, 21000, 21000, 23200, 20420, 21150, _\n                21000, 21000, 20420, 23200, 21150, 21000, 21000, 23200, _\n                23200, 23200, 26700, 22000, 22000, 22000, 22000, 22000, _\n                39000, 39000, 10000, 10000, 10000, 10000, 10000, 10000)\n\n'Application.ScreenUpdating = False\n\nlRow = range(\"A\" &amp; Rows.Count).End(xlUp).Row\nlColumn = Cells(1, Columns.Count).End(xlToLeft).Column\n\nWith range(Cells(1, 1).Address, Cells(lRow, lColumn).Address).AutoFilter\n\n    For x = LBound(BU) To UBound(BU)\n        .AutoFilter Field:=3, Criteria1:=Dept, Operator:=xlFilterValues\n        .AutoFilter Field:=1, Criteria1:=BU\n        .AutoFilter.Columns(3).Resize(.Rows.Count - 1).Offset(1). _\n        SpecialCells(xlCellTypeVisible).Value = NewDept\n\n    Next\n\nEnd With\n</code></pre>\n\n<p>End Sub</p>\n\n<p>FINAL EDIT*\nI ended up getting my code to work, but I also tried L42's solution I found it was much faster than the autofiltering. L42's code is what I will end up using. Thanks!</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 0, "creation_date": 1433377545, "post_id": 30632174, "comment_id": 49331572, "body": "Compact &amp; Repair. Can you edit this field directly in the underlying table using the UI? If so, Search &amp; Replace <code>MemmonthlyIncome</code> with the name of the field in Table Design View."}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 4526197, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e752e7969ab15fcb1df21ae1e6544e2a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4526197/michael"}, "edited": false, "score": 0, "creation_date": 1433431839, "post_id": 30634484, "comment_id": 49359785, "body": "good catch.  However, still stops at this line:     If rs!MemmonthlyIncome * 12 &lt;= 30000 Or IsNull(rs!MemmonthlyIncome) Then      with error:3265 @Parfait"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 99, "user_id": 4526197, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e752e7969ab15fcb1df21ae1e6544e2a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4526197/michael"}, "edited": false, "score": 0, "creation_date": 1433468248, "post_id": 30634484, "comment_id": 49376589, "body": "Come to think of it too, <code>Is Null</code> would have outputted a different error. However, I just recreated your table and all worked. Check the field name carefully (three m&#39;s). Else, try <a href=\"http://stackoverflow.com/questions/3266542/how-does-one-decompile-and-recompile-a-database-application\">decompiling</a> the code or check for lingering <a href=\"http://www.techonthenet.com/access/tutorials/vbadebug/debug02.php\" rel=\"nofollow noreferrer\">breakpoints</a>."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 1, "last_activity_date": 1433388708, "creation_date": 1433388708, "answer_id": 30634484, "question_id": 30632174, "link": "https://stackoverflow.com/questions/30632174/why-isnt-ms-access-item-found-in-collection/30634484#30634484", "title": "Why isn&#39;t MS Access &quot;item found in collection?&quot;", "body": "<p>In VBA, there is no <code>Is Null</code> expression as there is in SQL. Change to <code>IsNull(rs!MemmonthlyIncome)</code>.</p>\n\n<p>Possibly, Null is being referenced in recordset collection and hence returning the error.</p>\n"}, {"comments": [{"owner": {"reputation": 99, "user_id": 4526197, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e752e7969ab15fcb1df21ae1e6544e2a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4526197/michael"}, "edited": false, "score": 0, "creation_date": 1435094694, "post_id": 31013356, "comment_id": 50054354, "body": "I added a screen shot of the &quot;design view&quot;...Also confirmed with the &quot;database documenter&quot; that the field is there...."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 99, "user_id": 4526197, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e752e7969ab15fcb1df21ae1e6544e2a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4526197/michael"}, "edited": false, "score": 0, "creation_date": 1435094951, "post_id": 31013356, "comment_id": 50054478, "body": "The field is named <code>MemmothlyIncome</code>, but you&#39;re asking for <code>rs!MemmonthlyIncome</code> ... those names are not the same ... the first includes 1 <code>n</code>, the second includes 2 <code>n</code> ... <code>moth</code> &lt;&gt; <code>month</code>"}, {"owner": {"reputation": 99, "user_id": 4526197, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e752e7969ab15fcb1df21ae1e6544e2a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4526197/michael"}, "edited": false, "score": 0, "creation_date": 1435096341, "post_id": 31013356, "comment_id": 50055098, "body": "You solved this issue...duuu...how many hours have I looked at those names and saw them the same...thank you!"}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 1, "last_activity_date": 1435093756, "last_edit_date": 1435093756, "creation_date": 1435092925, "answer_id": 31013356, "question_id": 30632174, "link": "https://stackoverflow.com/questions/30632174/why-isnt-ms-access-item-found-in-collection/31013356#31013356", "title": "Why isn&#39;t MS Access &quot;item found in collection?&quot;", "body": "<p>You get error #3265, <em>\"Item not found in this collection\"</em>, at <code>IsNull(!MemmonthlyIncome)</code> in this context ...</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set rs = db.OpenRecordset(\"tblGrantRptData\", dbOpenTable)\nWith rs\n    If IsNull(!MemmonthlyIncome) Then\n</code></pre>\n\n<p>That would happen if <em>tblGrantRptData</em> does not include a field named <em>MemmonthlyIncome</em>.  What you are seeing as the column heading in the table Datasheet View may be the field's <code>Caption</code> property.  You could check the field's <code>Name</code> and <code>Caption</code> properties in the table's Design View.  Or you could list the actual field names for your table in the Immediate window.  </p>\n\n<p>Here's an abbreviated list of the field names in my <em>Contacts</em> table:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>set db = currentdb\nfor each fld in db.TableDefs(\"Contacts\").Fields : ? fld.name : next\nID\nCompany\nLast Name\nFirst Name\n</code></pre>\n\n<p>You just added this screen capture of your table in Design View ...</p>\n\n<p><img src=\"https://i.stack.imgur.com/dsMwE.jpg\" alt=\"enter image description here\"></p>\n\n<p>Notice the field is named <em>MemmothlyIncome</em>, not <em>MemmonthlyIncome</em> (<em>moth</em> vs. <em>month</em>).  So it wasn't a <code>Name</code> vs. <code>Caption</code> difference after all; you simply tried to use a misspelled field name.  That spelling problem is also visible in the DataSheet View screen capture, but we didn't notice it there.</p>\n"}], "owner": {"reputation": 99, "user_id": 4526197, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e752e7969ab15fcb1df21ae1e6544e2a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4526197/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4819, "favorite_count": 0, "accepted_answer_id": 31013356, "answer_count": 2, "score": 0, "last_activity_date": 1435093756, "creation_date": 1433371767, "last_edit_date": 1435093246, "question_id": 30632174, "link": "https://stackoverflow.com/questions/30632174/why-isnt-ms-access-item-found-in-collection", "title": "Why isn&#39;t MS Access &quot;item found in collection?&quot;", "body": "<p>I have a non-linked table \"tblGrantRptData\" in which I am trying to modify field records for subsequent filtering and export to EXCEL. I have ensured that all field names are correctly spelled, yet I still get an Error 3265, Item not found in this collection.</p>\n\n<p>I have confirmed that MemmonthlyIncome is the correct spelling and is identified in the design as \"currency.\"  </p>\n\n<p><img src=\"https://i.stack.imgur.com/e2BXL.jpg\" alt=\"enter image description here\"></p>\n\n<p>here is the design veiw that appears to show the field name:</p>\n\n<p><img src=\"https://i.stack.imgur.com/dsMwE.jpg\" alt=\"enter image description here\"></p>\n\n<p>It stops at this line:\nIf IsNull (!MemmonthlyIncome) Then</p>\n\n<p>with the error 3265</p>\n\n<p>If I can get some help to resolve this, I would then like to store the range \"0-30\"....</p>\n\n<p>One suggestion below was to \u201cdecompile\" and \"recompile.\u201d   I have read that this may cause problems when the database is used on multiple workstations.  I have revised the code to just get to first base\u2026.Any suggestions?</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub cmdGenerateGrantRpt_Click()\n\n\n'now run the qqAll query - this generates the tblGrantRptData - then close the query\n\nDoCmd.SetWarnings False\nDoCmd.OpenQuery \"qqAll\", acViewNormal, acEdit\nDoCmd.Close acQuery, \"qqAll\"\nDoCmd.SetWarnings True\n\n'First set up the table: tblGrantRptData with the correct data in fields\nDim db As DAO.Database\nDim rs As DAO.Recordset\n\nSet db = CurrentDb\nSet rs = db.OpenRecordset(\"tblGrantRptData\", dbOpenTable)\n\n'Check to see if the recordset actually contains rows and fill in particular values\n\nWith rs\nIf .EOF And .BOF Then\nMsgBox \"There are no records in this time interval\"\nExit Sub\n\nElse\n    .MoveFirst\n    Do Until .EOF = True\n        'Replace the monthly income with income categories\n        If IsNull(!MemmonthlyIncome) Then\n        .Edit\n        !MemmonthlyIncome = \"0-30\"\n        .Update\n        End If\n    Loop\nEnd If\nEnd With\nrs.Close 'Close the recordset\nSet rs = Nothing 'Clean up\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 10018, "user_id": 1309356, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o45P6.png?s=128&g=1", "display_name": "cha", "link": "https://stackoverflow.com/users/1309356/cha"}, "edited": false, "score": 0, "creation_date": 1433371118, "post_id": 30631892, "comment_id": 49329523, "body": "Is <code>tblBldgComparePer</code> a linked table residing on an external SQL Server or Oracle database? Does it have an INSERT TRIGGER?"}, {"owner": {"reputation": 466, "user_id": 3042939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecacf924d1ecf259953e2a8f07afec25?s=128&d=identicon&r=PG&f=1", "display_name": "jbg", "link": "https://stackoverflow.com/users/3042939/jbg"}, "edited": false, "score": 0, "creation_date": 1433371613, "post_id": 30631892, "comment_id": 49329778, "body": "does tblBldgComparePer have a computed/virtual column?"}, {"owner": {"reputation": 176, "user_id": 4044346, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0f147f8766920927c8692df420c250f8?s=128&d=identicon&r=PG&f=1", "display_name": "hypetech", "link": "https://stackoverflow.com/users/4044346/hypetech"}, "edited": false, "score": 0, "creation_date": 1433371679, "post_id": 30631892, "comment_id": 49329806, "body": "No tblBldgComparePer is just a regular table in Access. And I&#39;m not exactly sure what those two are, but I don&#39;t think so. I would probably know what they are if it had one."}], "answers": [{"tags": [], "owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "is_accepted": true, "score": 2, "last_activity_date": 1433372638, "creation_date": 1433372638, "answer_id": 30632328, "question_id": 30631892, "link": "https://stackoverflow.com/questions/30631892/division-by-0-error-when-no-division-is-happening/30632328#30632328", "title": "Division by 0 Error when no division is happening", "body": "<p>It's likely happening in your <code>WHERE</code> clause:</p>\n\n<pre><code>WHERE (bc.CurUnits &lt;&gt; 0) AND \n      ((((Abs(([bc].[LYRAvgUnits]-[bc].[CurUnits])/[bc].[LYRAvgUnits]))&gt;\" &amp; PerDif &amp; \"))\n</code></pre>\n\n<p><code>AND</code> is not short-circuiting in SQL so the right-hand side is getting evaluated even if <code>bc.CurUnits</code> is <code>0</code>. </p>\n\n<p>I believe you can change it to an <code>IIF</code> as well:</p>\n\n<pre><code>WHERE (IIF(bc.CurUnits = 0 , 0, Abs(([bc].[LYRAvgUnits]-[bc].[CurUnits])/[bc].[LYRAvgUnits])&gt;\" &amp; PerDif &amp; \")\n</code></pre>\n"}], "owner": {"reputation": 176, "user_id": 4044346, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0f147f8766920927c8692df420c250f8?s=128&d=identicon&r=PG&f=1", "display_name": "hypetech", "link": "https://stackoverflow.com/users/4044346/hypetech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 30632328, "answer_count": 1, "score": 0, "last_activity_date": 1433372638, "creation_date": 1433370452, "last_edit_date": 1433371738, "question_id": 30631892, "link": "https://stackoverflow.com/questions/30631892/division-by-0-error-when-no-division-is-happening", "title": "Division by 0 Error when no division is happening", "body": "<p>I am running a simple insert query in vba </p>\n\n<pre><code>DoCmd.RunSQL \"INSERT INTO tblBldgComparePer ( Bldg, Utility, LYRAvgUnits, LYRAVGUNITDif, LYRUnits, LYRUNITDIF, PrevMonUnits, PMUNITDIF, CurrentUnits, AvgOfTotCost, LYRAVGCOSTDif, LYRTotCost, LYRCOSTDIF, PrevMonTotCost, PMCOSTDIF, CurrentTotCost ) SELECT qryBldgComparePer.Bldg, qryBldgComparePer.Utility, qryBldgComparePer.LYRAvgUnits, qryBldgComparePer.LYRAVGUNITDif, qryBldgComparePer.LYRUnits, qryBldgComparePer.LYRUNITDIF, qryBldgComparePer.PrevMonUnits, qryBldgComparePer.PrevMonUNITDif, qryBldgComparePer.CurUnits, qryBldgComparePer.LYRAVGTotCost, qryBldgComparePer.LYRAVGTotCostDif, qryBldgComparePer.LYRTotCost, qryBldgComparePer.LYRTotCostDIF, qryBldgComparePer.PrevMonTotCost, qryBldgComparePer.PrevMonTotCostDif, qryBldgComparePer.CurTotCost FROM qryBldgComparePer;\", False\n</code></pre>\n\n<p>However I am getting a divide by 0 error when I run this query. The query it is based on, <code>qryBldgComparePer</code> shows up just fine, and has no divide by 0 errors in it. There are possibilites where it could, but the fields where it could I put in an IIF statement if the denominator is 0 to just make the field = 0 instead. Is this somehow being bypassed when inserted, so that it is trying to divide by 0? I have looked online and have not found another case like this. Any help you guys can offer would be very appreciated. Thank you!</p>\n\n<p>This is all the code leading up to the error:</p>\n\n<pre><code>strSQL = \"SELECT bc.Bldg, bc.Utility, bc.LYRAVGUnits, IIF( bc.LYRAvgUnits = 0, NULL, Abs(([bc].[LYRAvgUnits]-[bc].[CurUnits])/[bc].[LYRAvgUnits])) AS [LYRAVGUNITDif], bc.LYRUnits, IIF( bc.LYRUnits = 0, NULL, Abs(([bc].[LYRUnits]-[bc].[CurUnits])/[bc].[LYRUnits])) AS [LYRUNITDif], bc.PrevMonUnits, IIF( bc.PrevMonUnits = 0, NULL, Abs(([bc].[PrevMonUnits]-[bc].[CurUnits])/[bc].[PrevMonUnits])) AS [PrevMonUNITDif], bc.CurUnits, bc.LYRAVGTotCost, IIF(bc.LYRAvgTotCost = 0, NULL, Abs(([bc].[LYRAvgTotCost]-[bc].[CurTotCost])/[bc].[LYRAvgTotCost])) AS [LYRAVGTotCostDif], bc.LYRTotCost, IIF(bc.LYRTotCost = 0, NULL, Abs(([bc].[LYRTotCost]-[bc].[CurTotCost])/[bc].[LYRTotCost])) AS [LYRTotCostDif], bc.PrevMonTotCost, IIF( bc.PrevMonTotCost = 0, NULL, Abs(([bc].[PrevMonTotCost]-[bc].[CurTotCost])/[bc].[PrevMonTotCost])) AS [PrevMonTotCostDif], bc.CurTotCost FROM qryBldgCompare AS bc \" &amp; _\n\"WHERE (bc.CurUnits &lt;&gt; 0) AND ((((Abs(([bc].[LYRAvgUnits]-[bc].[CurUnits])/[bc].[LYRAvgUnits]))&gt;\" &amp; PerDif &amp; \")) OR (((Abs(([bc].[LYRUnits]-[bc].[CurUnits])/[bc].[LYRUnits]))&gt;\" &amp; PerDif &amp; \")) OR (((Abs(([bc].[PrevMonUnits]-[bc].[CurUnits])/[bc].[PrevMonUnits]))&gt;\" &amp; PerDif &amp; \")) OR (((Abs(([bc].[LYRAvgTotCost]-[bc].[CurTotCost])/[bc].[LYRAvgTotCost]))&gt;\" &amp; PerDif &amp; \")) OR (((Abs(([bc].[LYRTotCost]-[bc].[CurTotCost])/[bc].[LYRTotCost]))&gt;\" &amp; PerDif &amp; \")) OR (((Abs(([bc].[PrevMonTotCost]-[bc].[CurTotCost])/[bc].[PrevMonTotCost]))&gt;\" &amp; PerDif &amp; \")));\"\nCurrentDb.QueryDefs(\"qryBldgComparePer\").SQL = strSQL\nDoCmd.RunSQL \"DELETE FROM tblBldgComparePer;\"\nDoCmd.RunSQL \"INSERT INTO tblBldgComparePer ( Bldg, Utility, LYRAvgUnits, LYRAVGUNITDif, LYRUnits, LYRUNITDIF, PrevMonUnits, PMUNITDIF, CurrentUnits, AvgOfTotCost, LYRAVGCOSTDif, LYRTotCost, LYRCOSTDIF, PrevMonTotCost, PMCOSTDIF, CurrentTotCost ) SELECT qryBldgComparePer.Bldg, qryBldgComparePer.Utility, qryBldgComparePer.LYRAvgUnits, qryBldgComparePer.LYRAVGUNITDif, qryBldgComparePer.LYRUnits, qryBldgComparePer.LYRUNITDIF, qryBldgComparePer.PrevMonUnits, qryBldgComparePer.PrevMonUNITDif, qryBldgComparePer.CurUnits, qryBldgComparePer.LYRAVGTotCost, qryBldgComparePer.LYRAVGTotCostDif, qryBldgComparePer.LYRTotCost, qryBldgComparePer.LYRTotCostDIF, qryBldgComparePer.PrevMonTotCost, qryBldgComparePer.PrevMonTotCostDif, qryBldgComparePer.CurTotCost FROM qryBldgComparePer;\", False\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 3, "creation_date": 1433370659, "post_id": 30631811, "comment_id": 49329348, "body": "Your larger array should be 2-dimensional as well:  <code>1st dimension = name</code>, <code>2nd dimension = this other array</code>.  Access values like <code>arr(0,1)(0,0)</code> where you first grab the array from the outside one and the dig into its indices.  Or better yet, use a <code>Dictionary</code> so that you can do the named lookup.  For that, <code>key = name</code> and <code>value = 2d array</code>.  <a href=\"http://stackoverflow.com/questions/915317/does-vba-have-dictionary-structure\" title=\"does vba have dictionary structure\">stackoverflow.com/questions/915317/&hellip;</a>"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433371892, "post_id": 30631811, "comment_id": 49329892, "body": "@Byron Adding that as answer providing simple samples would be great."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1433378427, "post_id": 30631811, "comment_id": 49331780, "body": "@L42, I have added an answer that goes over both approaches.  Thanks for the prompt."}], "answers": [{"comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1433401589, "post_id": 30633093, "comment_id": 49339093, "body": "Small point: <code>Redim</code> is only particular about what you can resize when used with <code>Preserve</code>."}], "tags": [], "owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "is_accepted": false, "score": 1, "last_activity_date": 1433427677, "last_edit_date": 1495535212, "creation_date": 1433378047, "answer_id": 30633093, "question_id": 30631811, "link": "https://stackoverflow.com/questions/30631811/filling-a-3d-array-with-2d-arrays-in-vba/30633093#30633093", "title": "Filling a 3D array with 2D arrays in VBA", "body": "<p>Here is an example of each approach: array of arrays or <code>Dictionary</code> of arrays.  The <strong>Dictionary approach is considerably easier</strong> than the array of arrays if what you want is keyed lookup of values.  There might be merits to the array of arrays in other cases.</p>\n\n<p>This is dummy code with no real purpose but to show a couple things: grabbing a single value and an array of values.  I am building a 2D array of values by grabbing some <code>Range</code> data which is easy and 2D.  From there I build up the arrays of these values and then put them into the relevant data structure.  Then I poke at the data structure to get some values out of it.</p>\n\n<p><strong>Array of Arrays approach</strong> is shown first (and outputs on the left of the picture).</p>\n\n<pre><code>Sub ArraysOfArrays()\n\n    Dim arrA() As Variant\n    Dim arrB() As Variant\n\n    'wire up a 2-D array\n    arrA = Range(\"B2:D4\").Value\n    arrB = Range(\"F2:H4\").Value\n\n    Dim arrCombo() As Variant\n    ReDim arrCombo(2, 1) As Variant\n\n    'name and give data\n    arrCombo(0, 0) = \"arrA\"\n    arrCombo(1, 0) = arrA\n\n    'add more elements\n    ReDim Preserve arrCombo(2, 2)\n\n    arrCombo(0, 1) = \"arrB\"\n    arrCombo(1, 1) = arrB\n\n    'output a single result\n    'cell(2,2) of arrA\n    Range(\"B6\") = arrCombo(1, 0)(2, 2)\n\n    Dim str_search As String\n    str_search = \"arrB\"\n\n    'iterate through and output arrB to cells\n    Dim i As Integer\n    For i = LBound(arrCombo, 1) To UBound(arrCombo, 1)\n        If arrCombo(0, i) = str_search Then\n            Range(\"B8\").Resize(3, 3).Value = arrCombo(1, i)\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Couple key points here:</p>\n\n<ul>\n<li>You can only expand the array using <code>ReDim</code>.  <code>ReDim</code> is very particular that you only <a href=\"https://stackoverflow.com/a/13184027/4288101\">change the last dimension of the array</a> when used with <code>Preserve</code>.  Since I need one of them to track the number of entries, I do that in the second index which is... unnatural.  If you know the size in advance, this painful step is skipped.</li>\n<li>My final array is a 2xN array where the 2 contains a name and a YxZ array of data.</li>\n<li>In order to find a given array in the mix, you have to iterate through them all.</li>\n</ul>\n\n<p><strong>Dictionary of Arrays</strong> is far less code and more elegant.  Be sure to add the reference <code>Tools-&gt;References</code> in the VBA editor to Microsoft Scripting Runtime.</p>\n\n<pre><code>Sub DictionaryOfArrays()\n\n    Dim dict As New Scripting.Dictionary\n\n    'wire up a 2-D array\n    arrA = Range(\"B2:D4\").Value\n    arrB = Range(\"F2:H4\").Value\n\n    dict.Add \"arrA\", arrA\n    dict.Add \"arrB\", arrB\n\n    'get a single value\n    Range(\"F6\") = dict(\"arrB\")(2, 2)\n\n    'get a array of values\n    Range(\"F8\").Resize(3, 3) = dict(\"arrA\")\n\nEnd Sub\n</code></pre>\n\n<p><strong>Picture of input data and results</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/ApX58.png\" alt=\"data and results\"></p>\n\n<p>Data to copy if you want it (paste in <code>B1</code>)</p>\n\n<pre><code>a               b       \n1   2   3       10  11  12\n4   5   6       13  14  15\n7   8   9       16  17  18\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 4971551, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153082372233051/picture?type=large", "display_name": "Rafael Rovirosa", "link": "https://stackoverflow.com/users/4971551/rafael-rovirosa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2298, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1433427677, "creation_date": 1433370085, "question_id": 30631811, "link": "https://stackoverflow.com/questions/30631811/filling-a-3d-array-with-2d-arrays-in-vba", "title": "Filling a 3D array with 2D arrays in VBA", "body": "<p>I have a set of data where each item has a 2D array of information corresponding to it. I'd like to create a 3D array where the first dimension is the item name and the second and third dimensions are taken up by the info corresponding to the item.</p>\n\n<p>I can read the data for each item into a 2D array, but I can't figure out how to get the 2D array read into the 3D array.</p>\n\n<p>I know the sizes of all the dimensions so I can create an array of fixed size before I begin the reading and writing process.</p>\n\n<p>I'd like to do this by looping only through the names of the items and not looping through every cell of every 2D array.</p>\n\n<p>It is easy to get the 2D arrays read in to an ArrayList but I want to be able to name the items and be able to read these back in to excel and it seems difficult to do with an ArrayList.</p>\n\n<p>The question is: how do I read a 2D selection from excel into a 3D fixed sized array in VBA?</p>\n"}, {"tags": ["vba", "email", "powershell", "outlook", "exchange-server"], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1433374505, "creation_date": 1433374505, "answer_id": 30632625, "question_id": 30631398, "link": "https://stackoverflow.com/questions/30631398/how-do-i-run-a-script-when-emails-are-added-to-a-shared-folder/30632625#30632625", "title": "How do I Run a Script When Emails are Added to a Shared Folder?", "body": "<p>Sure, Items.ItemAdd event will fire on the Items collection from that folder (MAPIFolder.Items). Make sure your keep Items variable in a global (class) variable to make sure its stays alive and hence able to raise events. </p>\n"}, {"tags": [], "owner": {"reputation": 843, "user_id": 4910940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe4081b83efaaefe18c5b5bd1fa50439?s=128&d=identicon&r=PG", "display_name": "bluuf", "link": "https://stackoverflow.com/users/4910940/bluuf"}, "is_accepted": true, "score": 0, "last_activity_date": 1433397391, "creation_date": 1433397391, "answer_id": 30635984, "question_id": 30631398, "link": "https://stackoverflow.com/questions/30631398/how-do-i-run-a-script-when-emails-are-added-to-a-shared-folder/30635984#30635984", "title": "How do I Run a Script When Emails are Added to a Shared Folder?", "body": "<p>If it's just a shared folder on the network (smb) you can use the filesystemwatcher class from the system.io namespace.\nIf it's  mailfolder in a mailbox then you can use an outlook com object.</p>\n"}], "owner": {"reputation": 13, "user_id": 4966524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb0d8278fd544c5f85086457c7d5b6fa?s=128&d=identicon&r=PG&f=1", "display_name": "Nick D", "link": "https://stackoverflow.com/users/4966524/nick-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 30635984, "answer_count": 2, "score": 0, "last_activity_date": 1433397391, "creation_date": 1433368166, "question_id": 30631398, "link": "https://stackoverflow.com/questions/30631398/how-do-i-run-a-script-when-emails-are-added-to-a-shared-folder", "title": "How do I Run a Script When Emails are Added to a Shared Folder?", "body": "<p>I am working with a group of people who are all using Outlook 2007 in combination with Exchange 2007.  Among us, we have shared folders on the network, and one of these folders will periodically receive emails that must be processed.  Is there a way to get Outlook to execute a script (VBA, PowerShell, what have you) whenever a new email is added to this folder?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "is_accepted": false, "score": 0, "last_activity_date": 1433368883, "last_edit_date": 1495542115, "creation_date": 1433368883, "answer_id": 30631569, "question_id": 30631352, "link": "https://stackoverflow.com/questions/30631352/paste-run-time-error-1004/30631569#30631569", "title": "Paste Run Time Error 1004", "body": "<p>When you <code>ShowAllData</code> (same as <code>Data-&gt;Clear</code> in the Filter section) you are emptying the clipboard and telling Excel to forget about the copied <code>Range</code>.  Do it outside of VBA to confirm if you want.  Excel loves to empty the clipboard when you edit a cell or do much of anything other than selecting.</p>\n\n<p>To fix, do the <code>Copy</code> after the <code>ShowAllData</code>.  In your case, you will have to <code>Select</code> the <code>Worksheet</code> back and forth.</p>\n\n<p>You should generally work to avoid using <code>Select</code> and <code>Activate</code> for your VBA.  <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">See this post for details.</a></p>\n\n<p>Here is the final code with the changes made:</p>\n\n<pre><code>Sub MoveData_Click()\n\n'Select the filtered alarm data and paste on the master spreadsheet\n\nSheets(\"2015 Master\").Select\nIf ActiveWorkbook.ActiveSheet.FilterMode Or ActiveWorkbook.ActiveSheet.AutoFilterMode Then\nActiveWorkbook.ActiveSheet.ShowAllData\nEnd If\n\nSheets(\"DailyGen\").Select\nActiveSheet.UsedRange.Offset(5, 0).SpecialCells _\n    (xlCellTypeVisible).Copy\n\nSheets(\"2015 Master\").Select\nRange(\"C4\").Select\nSelection.End(xlDown).Select\nActiveCell.Offset(1, -2).Range(\"A1\").Select\nActiveSheet.Paste\n\n 'Sort newest to oldest in the date column\n\nActiveWorkbook.Worksheets(\"2015 Master\").ListObjects(\"Table44\").Sort.SortFields.Clear\n    ActiveWorkbook.Worksheets(\"2015 Master\").ListObjects(\"Table44\").Sort.SortFields.Add _\n    Key:=Range(\"Table44[[#All],[Active Time]]\"), SortOn:=xlSortOnValues, Order _\n     :=xlDescending, DataOption:=xlSortNormal\nWith ActiveWorkbook.Worksheets(\"2015 Master\").ListObjects(\"Table44\").Sort\n   .Header = xlYes\n   .MatchCase = False\n   .Orientation = xlTopToBottom\n   .SortMethod = xlPinYin\n   .Apply\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4971486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d998acc6b0f60276dafa2158eb0b666?s=128&d=identicon&r=PG&f=1", "display_name": "M Shatek", "link": "https://stackoverflow.com/users/4971486/m-shatek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 204, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433372583, "creation_date": 1433368001, "last_edit_date": 1433372583, "question_id": 30631352, "link": "https://stackoverflow.com/questions/30631352/paste-run-time-error-1004", "title": "Paste Run Time Error 1004", "body": "<p>I am trying to copy a set of filtered data from one sheet to the bottom of another sheet. And my code works great except for the first time upon opening the file I get a:</p>\n\n<blockquote>\n  <p>Run Time error 1004</p>\n</blockquote>\n\n<p>If I quit the debugger and re-run the macro it works great.<br>\nHere is my code: noted where the problem occurs.</p>\n\n<pre><code>Sub MoveData_Click()\n    'Select the filtered alarm data and paste on the master spreadsheet\n    Sheets(\"DailyGen\").Select\n    ActiveSheet.UsedRange.Offset(5, 0).SpecialCells _\n        (xlCellTypeVisible).Copy\n\n    Sheets(\"2015 Master\").Select\n\n    If ActiveWorkbook.ActiveSheet.FilterMode _\n    Or ActiveWorkbook.ActiveSheet.AutoFilterMode Then\n        ActiveWorkbook.ActiveSheet.ShowAllData\n    End If\n\n    Range(\"C4\").Select\n    Selection.End(xlDown).Select\n    ActiveCell.Offset(1, -2).Range(\"A1\").Select\n    ActiveSheet.Paste '~~&gt; THIS IS WHERE IT ERRORS\n\n    'Sort newest to oldest in the date column\n\n    ActiveWorkbook.Worksheets(\"2015 Master\").ListObjects(\"Table44\").Sort.SortFields.Clear\n    ActiveWorkbook.Worksheets(\"2015 Master\").ListObjects(\"Table44\").Sort.SortFields.Add _\n        Key:=Range(\"Table44[[#All],[Active Time]]\"), _\n        SortOn:=xlSortOnValues, \n        Order:=xlDescending, DataOption:=xlSortNormal\n    With ActiveWorkbook.Worksheets(\"2015 Master\").ListObjects(\"Table44\").Sort\n       .Header = xlYes\n       .MatchCase = False\n       .Orientation = xlTopToBottom\n       .SortMethod = xlPinYin\n       .Apply\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "date"], "comments": [{"owner": {"reputation": 414, "user_id": 3750262, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/903190092/picture?type=large", "display_name": "Greg", "link": "https://stackoverflow.com/users/3750262/greg"}, "edited": false, "score": 2, "creation_date": 1433369488, "post_id": 30631244, "comment_id": 49328890, "body": "You&#39;d like us to fix code you&#39;re unwilling to locate?"}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1433381118, "post_id": 30631244, "comment_id": 49332442, "body": "Right click on the tab and choose &quot;View code&quot; then post it here (Edit your original message, don&#39;t put it in a comment)"}], "answers": [{"tags": [], "owner": {"reputation": 514, "user_id": 4967653, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jLy0eO8CT3E/AAAAAAAAAAI/AAAAAAAAAeQ/r1of1sWAlcw/photo.jpg?sz=128", "display_name": "keong kenshih", "link": "https://stackoverflow.com/users/4967653/keong-kenshih"}, "is_accepted": false, "score": 0, "last_activity_date": 1433380790, "creation_date": 1433380790, "answer_id": 30633443, "question_id": 30631244, "link": "https://stackoverflow.com/questions/30631244/excel-date-formatting-error/30633443#30633443", "title": "Excel date formatting error", "body": "<p><br> The code would be triggered when you do the changes at column V. You may find the code in the worksheet itself:<br>\n<img src=\"https://i.stack.imgur.com/yNdFe.png\" alt=\"worksheet code\">\n<br>it will clear the date if the column V contains no value.\n<br> By the way, the date is not getting smaller but it show the date of today in different format. you may check the date format by right click the cell and choose the format cells... option to look at it.</p>\n"}], "owner": {"reputation": 71, "user_id": 4967029, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f47b4666e7516b8b4342aaf02da5a64a?s=128&d=identicon&r=PG", "display_name": "Luis", "link": "https://stackoverflow.com/users/4967029/luis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1433703586, "creation_date": 1433367545, "last_edit_date": 1433703586, "question_id": 30631244, "link": "https://stackoverflow.com/questions/30631244/excel-date-formatting-error", "title": "Excel date formatting error", "body": "<p>I'm doing some work on an already done excel program, but I'm very rusty in this area or probably never had done something in this part, I'm very new in VBA so please don't judge me if it's a simple mistake or error the links are in the description.</p>\n\n<p>So I have problem where if I put the confirmation option, for example: in one cell press \"1\" in the product you have, and in another cell write \"S\" if you already have the product and it puts you a date of today in another cell.</p>\n\n<p>The problem is when I delete the info that I inserted, and reenter it the date deformats itself becoming smaller and the location on the cell changes too.</p>\n\n<p>I'm going to put the links because, like I said I'm rusty and I can't find where the code of this date comes.</p>\n\n<p><a href=\"http://www.docdroid.net/12dh4/master-atual-20155.xls.html\" rel=\"nofollow\">http://www.docdroid.net/12dh4/master-atual-20155.xls.html</a> -->This one is the Excel</p>\n\n<p><a href=\"http://www.docdroid.net/12dhj/errorphotos.pdf.html\" rel=\"nofollow\">http://www.docdroid.net/12dhj/errorphotos.pdf.html</a> --> photos showing error</p>\n\n<p>this is the code of one of the sheets the other ones are almost the same, If you guys see the photos it would help to understand the error itself.</p>\n\n<hr>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim rng1 As Range\nSet rng1 = Intersect(Range(\"v3:v500\"), Target)\nIf rng1 Is Nothing Then Exit Sub\n\nApplication.EnableEvents = False\n\n On Error Resume Next\n\n\n    If rng1.Value &lt;&gt; \"\" Then\n        rng1.Offset(0, 2).Value = Now()\n    Else\n        rng1.Offset(0, 2).Clear\n    End If\n\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<hr>\n"}, {"tags": ["javascript", "excel", "vba"], "comments": [{"owner": {"reputation": 5203, "user_id": 1760479, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/gFcMy.jpg?s=128&g=1", "display_name": "David Tansey", "link": "https://stackoverflow.com/users/1760479/david-tansey"}, "edited": false, "score": 1, "creation_date": 1433366769, "post_id": 30630970, "comment_id": 49327658, "body": "The following post may be helpful: <a href=\"http://stackoverflow.com/questions/27066963/scraping-data-from-website-using-vba\" title=\"scraping data from website using vba\">stackoverflow.com/questions/27066963/&hellip;</a>"}, {"owner": {"reputation": 806, "user_id": 1748734, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/4sXYk.jpg?s=128&g=1", "display_name": "Jaqx", "link": "https://stackoverflow.com/users/1748734/jaqx"}, "reply_to_user": {"reputation": 5203, "user_id": 1760479, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/gFcMy.jpg?s=128&g=1", "display_name": "David Tansey", "link": "https://stackoverflow.com/users/1760479/david-tansey"}, "edited": false, "score": 0, "creation_date": 1433367226, "post_id": 30630970, "comment_id": 49327880, "body": "@DavidTansey Thanks checking it out now"}], "answers": [{"comments": [{"owner": {"reputation": 806, "user_id": 1748734, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/4sXYk.jpg?s=128&g=1", "display_name": "Jaqx", "link": "https://stackoverflow.com/users/1748734/jaqx"}, "edited": false, "score": 0, "creation_date": 1434127087, "post_id": 30631219, "comment_id": 49664234, "body": "Thanks useful to know"}], "tags": [], "owner": {"reputation": 626, "user_id": 4760900, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-HImPwY2suoM/AAAAAAAAAAI/AAAAAAAAABI/EiWMAOBgoEM/photo.jpg?sz=128", "display_name": "icebird76", "link": "https://stackoverflow.com/users/4760900/icebird76"}, "is_accepted": false, "score": 0, "last_activity_date": 1433367498, "creation_date": 1433367498, "answer_id": 30631219, "question_id": 30630970, "link": "https://stackoverflow.com/questions/30630970/copy-and-paste-from-a-url-using-vba/30631219#30631219", "title": "Copy and Paste from a URL using VBA", "body": "<p>A very basic approach would be to use SendKeys. I'm not experienced in opening websites with Excel, but once you have it open, just use</p>\n\n<pre><code>Application.SendKeys \"^A\", True\nApplication.SendKeys \"^C\", True\n</code></pre>\n\n<p>and that will select everything in the website and copy it's contents. But I think it would be helpful to look at the link on the comment of your post.</p>\n"}], "owner": {"reputation": 806, "user_id": 1748734, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/4sXYk.jpg?s=128&g=1", "display_name": "Jaqx", "link": "https://stackoverflow.com/users/1748734/jaqx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 628, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433367498, "creation_date": 1433366426, "question_id": 30630970, "link": "https://stackoverflow.com/questions/30630970/copy-and-paste-from-a-url-using-vba", "title": "Copy and Paste from a URL using VBA", "body": "<p>I have a button that calls a sub DBA()</p>\n\n<p>I would like this sub to visit a particular URL (for example: <a href=\"https://index.db.com\" rel=\"nofollow\">https://index.db.com</a>) and copy all of the content and paste it into Application.Worksheets(\"DBA\").</p>\n\n<p>More specifically, I would ideally like to copy and paste the contents from a div that has an id=\"constituentstable\" in the URL's HTML</p>\n\n<p>Grateful for any guidance, thank you,</p>\n"}, {"tags": ["excel", "vba", "email", "outlook"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1433366250, "post_id": 30630767, "comment_id": 49327406, "body": "Excel VBA doesn&#39;t know the value of <code>olCC</code>. If you make the Outlook app visible and comment out the Send line you might be able to more easily figure out what&#39;s going wrong."}, {"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1433366465, "post_id": 30630767, "comment_id": 49327509, "body": "@Tim - Excel VBA would know the value of olCc if OP has set a reference to the Outlook Object Library."}, {"owner": {"reputation": 57, "user_id": 4638017, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vATYR.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4638017/michael"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1433366979, "post_id": 30630767, "comment_id": 49327756, "body": "@Tim Williams Thank you for your insight, I used apostrophes infront of the CC section and I was able to send the email. Is there any way I can set up a CC list within my current code that you are familiar with? Do I need to establish olCC in the &quot;Set..&quot; area?"}, {"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1433367328, "post_id": 30630767, "comment_id": 49327927, "body": "If you are using late binding, the numeric values for the named constants are olMailItem=0, olTo=1, olCC=2. Use the numeric values instead of the named constant."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1433367994, "post_id": 30630767, "comment_id": 49328220, "body": "@Michael - you can add <code>Const olTo = 1</code> and <code>Const olCC = 2</code> at the top of your Sub. Likewise for <code>olMailItem</code>"}, {"owner": {"reputation": 57, "user_id": 4638017, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vATYR.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4638017/michael"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1433368431, "post_id": 30630767, "comment_id": 49328414, "body": "@TimWilliams , ChipsLetten - Thank you both for the insight, I apologize, this is my first time using VBA with OutLook and I am not quite sure I am following how you work the numeric values into the code. After writing the Const olTo = 1 into the code, does the 1 get used later in the code?"}, {"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1433369134, "post_id": 30630767, "comment_id": 49328755, "body": "In your existing code you replace the Outlook constants with the numbers, so for <code>.Type = olCC</code> you change it to <code>.Type = 2 &#39; value for olCC</code>. I usually add a comment at the end of the line to remind me/others what the value 2 represents."}, {"owner": {"reputation": 57, "user_id": 4638017, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vATYR.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4638017/michael"}, "reply_to_user": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1433369399, "post_id": 30630767, "comment_id": 49328847, "body": "@ChipsLetten OK I see what you are saying, I did change to the numeric value and the CC portion works now! Thank you very much for your insight, if you post a formal answer I would love to give you and Tim the credit for answering my question."}], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 3, "last_activity_date": 1575376176, "last_edit_date": 1575376176, "creation_date": 1433367511, "answer_id": 30631227, "question_id": 30630767, "link": "https://stackoverflow.com/questions/30630767/sending-email-with-attachment-through-excel-vba/30631227#30631227", "title": "Sending Email With Attachment Through Excel VBA", "body": "<p>Make sure you reference the Outlook object library</p>\n\n<pre><code>Option Explicit\nSub CreateEmail()\n\n    Dim OlApp As Object\n    Dim OlMail As Object\n    Dim ToRecipient As Variant\n    Dim CcRecipient As Variant\n\n    Set OlApp = CreateObject(\"Outlook.Application\")\n    Set OlMail = OlApp.createitem(olmailitem)\n\n    For Each ToRecipient In Array(\"jon.doe@aol.com\")\n        OlMail.Recipients.Add ToRecipient\n    Next ToRecipient\n\n    For Each CcRecipient In Array(\"jon.doe@aol.com\")\n        With OlMail.Recipients.Add(CcRecipient)\n        .Type = olcc\n    End With\n    Next CcRecipient\n\n    'Fill in Subject field\n    OlMail.Subject = \"Open Payable Receivable\"\n\n\n    'Add the report as an attachment\n    OlMail.Attachments.Add (\"C:\\temp\\test1.xlsx.\")\n    OlMail.Display ' &lt;--for testing, to send use OlMail.Send\n\n    'OlMail.Send\n End Sub\n</code></pre>\n\n<p>to add multiple CcRecipient \n<code>In Array(\"jon.doe@aol.com\",\"jon.doe@aol.com\")</code></p>\n"}, {"comments": [{"owner": {"reputation": 3854, "user_id": 10607772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e478f2600848a3dc5238b7ffb2e148f6?s=128&d=identicon&r=PG", "display_name": "double-beep", "link": "https://stackoverflow.com/users/10607772/double-beep"}, "edited": false, "score": 0, "creation_date": 1589989694, "post_id": 61915787, "comment_id": 109513205, "body": "Welcome to Stack Overflow! While this code may solve the question, <a href=\"//meta.stackexchange.com/q/114762\">including an explanation</a> of how and why this solves the problem would really help to improve the quality of your post, and probably result in more up-votes. Remember that you are answering the question for readers in the future, not just the person asking now. Please <a href=\"https://stackoverflow.com/posts/61915787/edit\">edit</a> your answer to add explanations and give an indication of what limitations and assumptions apply. <a href=\"/review/late-answers/26181837\">From Review</a>"}], "tags": [], "owner": {"reputation": 1, "user_id": 13582746, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KIsLqaUa1KQ/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucmlPc-9eNVSG_5DT6n9tkUhyccM9Q/photo.jpg?sz=128", "display_name": "L J", "link": "https://stackoverflow.com/users/13582746/l-j"}, "is_accepted": false, "score": 0, "last_activity_date": 1590066289, "last_edit_date": 1590066289, "creation_date": 1589985249, "answer_id": 61915787, "question_id": 30630767, "link": "https://stackoverflow.com/questions/30630767/sending-email-with-attachment-through-excel-vba/61915787#61915787", "title": "Sending Email With Attachment Through Excel VBA", "body": "<pre><code>Sub AUTOGENERATEEMAIL()\n\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\n\nstrBody = \"&lt;FONT SIZE = 3&gt;Good day all, \" &amp; \"&lt;br&gt;\" &amp; \"&lt;br&gt;\" &amp; \"Please see attached.\" &amp; \"&lt;br&gt;\" &amp; \"&lt;br&gt;\" &amp; \"Pleasant Regards\"\n\nWith OutMail\n    .Display\n    .To = \"Roti@hotmail.com; sall@hotmail.com; mj@hotmail.com; \"\n    .CC = \"\"\n    .BCC = \"\"\n    .Subject = \"Finance\" &amp; path\n    .HTMLBody = strBody &amp; .HTMLBody\n    .Attachments.Add (\"\\\\Finance\\Company Shared Folders\\UserShares\\Finance Tool\\Finance Assistant Tools\\Finance.xlsb\")\n    .Display\n\nEnd With\n\nSet OutMail = Nothing\nSet OutApp = Nothing\n\nEnd Sub\n\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 4638017, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vATYR.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4638017/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12225, "favorite_count": 0, "accepted_answer_id": 30631227, "answer_count": 2, "score": 1, "last_activity_date": 1592695893, "creation_date": 1433365712, "last_edit_date": 1592695893, "question_id": 30630767, "link": "https://stackoverflow.com/questions/30630767/sending-email-with-attachment-through-excel-vba", "title": "Sending Email With Attachment Through Excel VBA", "body": "<p>I would like to email a report through Outlook from Excel.</p>\n\n<p>I am testing this with my own and coworkers' email address. I get an \"Undeliverable\" <strong><code>Error</code></strong>.</p>\n\n<p>The message says the recipient cannot be reached and suggests trying to send the email later. </p>\n\n<pre><code>Sub CreateEmail()\n\nDim OlApp As Object\nDim OlMail As Object\nDim ToRecipient As Variant\nDim CcRecipient As Variant\n\nSet OlApp = CreateObject(\"Outlook.Application\")\nSet OlMail = OlApp.createitem(olmailitem)\n\nFor Each ToRecipient In Array(\"jon.doe@aol.com\")\n    OlMail.Recipients.Add ToRecipient\nNext ToRecipient\n\nFor Each CcRecipient In Array(\"jon.doe@aol.com\")\n    With OlMail.Recipients.Add(CcRecipient)\n        .Type = olCC\n    End With\nNext CcRecipient\n\n'Fill in Subject field\nOlMail.Subject = \"Open Payable Receivable\"\n\n'Add the report as an attachment\nOlMail.Attachments.Add (\"C:\\OpenPayRecPrint2.pdf\")\n\n'Send Message\nOlMail.Send\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "search"], "comments": [{"owner": {"reputation": 219, "user_id": 4080394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RHAaZ.jpg?s=128&g=1", "display_name": "daytonrazorback", "link": "https://stackoverflow.com/users/4080394/daytonrazorback"}, "edited": false, "score": 2, "creation_date": 1433366531, "post_id": 30630716, "comment_id": 49327544, "body": "Can you post the code you have tried already?  This will help the community get you exactly what you need."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1433368810, "post_id": 30630716, "comment_id": 49328588, "body": "I&#39;m unclear on what you mean by <i>bold the characters in Worksheet 1 to the corresponding cell</i>. If you supplied some code (working or not), your intentions would be easier to grasp."}, {"owner": {"reputation": 387, "user_id": 4971376, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/480da9c324ce828f711b23012b78f0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Ron T", "link": "https://stackoverflow.com/users/4971376/ron-t"}, "reply_to_user": {"reputation": 219, "user_id": 4080394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RHAaZ.jpg?s=128&g=1", "display_name": "daytonrazorback", "link": "https://stackoverflow.com/users/4080394/daytonrazorback"}, "edited": false, "score": 0, "creation_date": 1433370431, "post_id": 30630716, "comment_id": 49329251, "body": "Thanks for letting me know @daytonrazorback I just posted the code that I have started."}, {"owner": {"reputation": 387, "user_id": 4971376, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/480da9c324ce828f711b23012b78f0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Ron T", "link": "https://stackoverflow.com/users/4971376/ron-t"}, "edited": false, "score": 0, "creation_date": 1433370523, "post_id": 30630716, "comment_id": 49329294, "body": "For example, Since Jack is founded in Worksheet 2 in the sentence &quot;Jack ate an apple.&quot; Jack in Worksheet 1 will be bolded. Hopefully this makes sense @Jeeped"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1433371347, "creation_date": 1433371347, "answer_id": 30632104, "question_id": 30630716, "link": "https://stackoverflow.com/questions/30630716/searching-and-matching-characters-between-2-columns-on-2-worksheets/30632104#30632104", "title": "Searching and matching characters between 2 columns on 2 worksheets", "body": "<p>Select all of column A on worksheet 1 with A1 as the <em>active cell</em>. Choose Home \u25ba Conditional Formatting \u25ba New Rule* and when the **New Formatting Rule* dialog appears, choose <em>Use a formula to determine which cells to format</em> then supply the following in the <em>Format values where this formula is true:</em> text box.</p>\n\n<pre><code> =isnumber(match(\"*\"&amp;A1&amp;\"*\", 'Worksheet 2'!A:A, 0))\n</code></pre>\n\n<p>Click <kbd>Format</kbd> and select <em>Bold</em> from the <em>Font</em> tab. Click <kbd>OK</kbd> once to accept the formatting and then <kbd>OK</kbd> again to create the new rule.</p>\n\n<p>I added a few non-matching names to <strong>Worksheet 1</strong> and topped up the formatting change with a bold blue font for these results.</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<img src=\"https://i.stack.imgur.com/ffzTT.png\" alt=\"cONDITIONAL fORMATTING WITH tEXT WITHIN tEXT\"></p>\n"}, {"comments": [{"owner": {"reputation": 487, "user_id": 4968719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5bDr7.jpg?s=128&g=1", "display_name": "Akif Patel - BRMS", "link": "https://stackoverflow.com/users/4968719/akif-patel-brms"}, "edited": false, "score": 0, "creation_date": 1433411498, "post_id": 30640606, "comment_id": 49345345, "body": "The code snippet is tested so go ahead test in your workbook. :)"}, {"owner": {"reputation": 387, "user_id": 4971376, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/480da9c324ce828f711b23012b78f0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Ron T", "link": "https://stackoverflow.com/users/4971376/ron-t"}, "edited": false, "score": 0, "creation_date": 1433455164, "post_id": 30640606, "comment_id": 49372561, "body": "Awesome, this is exactly what I am looking for! Thanks @Akif Patel"}, {"owner": {"reputation": 487, "user_id": 4968719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5bDr7.jpg?s=128&g=1", "display_name": "Akif Patel - BRMS", "link": "https://stackoverflow.com/users/4968719/akif-patel-brms"}, "reply_to_user": {"reputation": 387, "user_id": 4971376, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/480da9c324ce828f711b23012b78f0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Ron T", "link": "https://stackoverflow.com/users/4971376/ron-t"}, "edited": false, "score": 0, "creation_date": 1433471796, "post_id": 30640606, "comment_id": 49377483, "body": "if it has served your purpose, just vote for the answer so that other people with same need can use my solution."}], "tags": [], "owner": {"reputation": 487, "user_id": 4968719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5bDr7.jpg?s=128&g=1", "display_name": "Akif Patel - BRMS", "link": "https://stackoverflow.com/users/4968719/akif-patel-brms"}, "is_accepted": false, "score": 0, "last_activity_date": 1433411443, "creation_date": 1433411443, "answer_id": 30640606, "question_id": 30630716, "link": "https://stackoverflow.com/questions/30630716/searching-and-matching-characters-between-2-columns-on-2-worksheets/30640606#30640606", "title": "Searching and matching characters between 2 columns on 2 worksheets", "body": "<p>A simple macro would do the work for you. Suppose you have a Sheet with Names and another with Sentences. So here is a small code:</p>\n\n<pre><code>Sub HighlightFound()\nDim searchRange As Range\nSet searchRange = ActiveWorkbook.Sheets(\"Sentences\").Range(\"A:A\")\n\nActiveWorkbook.Sheets(\"Names\").Activate\nRange(\"A1\").Select\n\nDo While Not IsEmpty(ActiveCell)\n    If Not searchRange.Find(ActiveCell.FormulaR1C1, LookIn:=xlValues) Is Nothing Then\n        ActiveCell.Font.Bold = True\n    End If\n    ActiveCell.Offset(RowOffset:=1).Select\nLoop\n</code></pre>\n\n<p>End Sub</p>\n\n<p><strong>HAPPY VBA CODING!!!</strong></p>\n"}], "owner": {"reputation": 387, "user_id": 4971376, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/480da9c324ce828f711b23012b78f0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Ron T", "link": "https://stackoverflow.com/users/4971376/ron-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 30632104, "answer_count": 2, "score": 0, "last_activity_date": 1433411443, "creation_date": 1433365568, "last_edit_date": 1433371484, "question_id": 30630716, "link": "https://stackoverflow.com/questions/30630716/searching-and-matching-characters-between-2-columns-on-2-worksheets", "title": "Searching and matching characters between 2 columns on 2 worksheets", "body": "<p>I have 2 worksheets (Worksheet 1 &amp; Worksheet 2). I am trying to searching the characters in column A on Worksheet 1 and see if those characters exist in Column A on Worksheet 2. Please note that these characters are not fixed, so characters may be added, removed, or changed. If they exists in Worksheet 2, then I would bold the characters in Worksheet 1 to the corresponding cell.</p>\n\n<p><strong>Worksheet 1</strong></p>\n\n<p><em>Column A</em></p>\n\n<pre><code>Jack\nJames\nPeter\nAngel\n</code></pre>\n\n<p><strong>Worksheet 2</strong></p>\n\n<p><em>Column A</em></p>\n\n<pre><code>Jack ate an apple.\nPeter flies a kite.\nHenry wakes up for work.\nJames went to school.\n</code></pre>\n\n<p>My approach to this so far is using For loops and if-else statements. I was thinking about using InStr to find the characters within those sentence in Worksheet 2.</p>\n\n<pre><code>Dim StartNum As Integer\nDim EndNum As Integer\nDim rng1 As Range\nDim rng2 As Range\n\nEndNum =\n\nFor StartNum = 1 To EndNum\n    If rng1.Value = InStr(rng2.Value) Then _\n        rng1.font.Bold = True\nEnd If\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba", "sorting"], "comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433370184, "post_id": 30630691, "comment_id": 49329176, "body": "Couple notes: <b>1)</b> you may not get very far with this question since it has no code.  You might get a range of comments (mine included) but you will do better w/ code or a picture or examples.  <b>2)</b> there is no default <code>Sort</code>, but <a href=\"http://stackoverflow.com/a/152325/4288101\">others have provided code that will do</a>. <b>3)</b> give some serious thought to working your steps in &quot;normal&quot; Excel without VBA.  Excel is one of the best multidimensional arrays out there and it can sort, do math, and all other useful stuff.  From there you can automate Excel or port to VBA if needed."}, {"owner": {"reputation": 626, "user_id": 4760900, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-HImPwY2suoM/AAAAAAAAAAI/AAAAAAAAABI/EiWMAOBgoEM/photo.jpg?sz=128", "display_name": "icebird76", "link": "https://stackoverflow.com/users/4760900/icebird76"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433370919, "post_id": 30630691, "comment_id": 49329444, "body": "I agree that Excel is the best array. I should probably just use Excel and delete the data when I&#39;m done. And I&#39;m using Excel VBA so I can already mess around with Excel data with ease."}], "answers": [{"tags": [], "owner": {"reputation": 626, "user_id": 4760900, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-HImPwY2suoM/AAAAAAAAAAI/AAAAAAAAABI/EiWMAOBgoEM/photo.jpg?sz=128", "display_name": "icebird76", "link": "https://stackoverflow.com/users/4760900/icebird76"}, "is_accepted": true, "score": 0, "last_activity_date": 1436980944, "last_edit_date": 1436980944, "creation_date": 1433452140, "answer_id": 30654197, "question_id": 30630691, "link": "https://stackoverflow.com/questions/30630691/excel-vba-add-strings-to-a-list-and-sort-alphabetically-and-numerically/30654197#30654197", "title": "Excel VBA Add strings to a list, and sort alphabetically and numerically", "body": "<p>Thanks to Byron, I decided to use Excel for the list method and do the sorting. The reason I was avoiding using Excel sheets is because I wanted to reduce the amount of information on my sheet and just use a temporary list. But it is a lot easier and more friendly to use Excel for what it was made to do. Here is the code that reads a text file, extracts what I need, and sorts it. The other Sub uses a list from another text file to define which item in the list goes first, second, and so on.</p>\n\n<pre><code>Sub AUTOTOOLPATHretrieve()\nDim textline As String, ToolNumber As String, Comments As String, i As Long, GreenCount As Long, RoBCount As Long, GreenTools As String, RoBTools As String, GreenTool As Boolean, RoBTool As Boolean\n\nGreenCount = 0\nRoBCount = 0\nGreenTools = \"\"\nRoBTools = \"\"\nGreenTool = False\nRoBTool = False\n\nFor X = 1 To 8\nRange(\"I\" &amp; X) = \" \"\nNext\nRange(\"J31:J33\").ClearContents\nRange(\"Z1:AA50\").ClearContents\nOpen \"V:\\CNC DEPT\\ART CAM\\WILL B\\WILL PROGRAMS\\AUTOTOOLPATH.txt\" For Input As #1\nOn Error Resume Next\ni = 0\nSAVEDVAR = 0\nDo Until EOF(1)\nLine Input #1, textline\nDebug.Print (textline)\n\n'CHECK LINE FOR \":\" AND EXTRACT THAT LINE\nSelect Case Mid(textline, 1, (InStr(1, textline, \":\")) - 1)\n    Case \"Tool\"\n        Debug.Print (\"CONTAINS TOOL\")\n        ToolNumber = Mid(textline, 22, 2)\n        Select Case True\n            Case Mid(ToolNumber, 2, 1) &lt;&gt; \"]\"\n                ToolNumber = Mid(ToolNumber, 2)\n                Range(\"B2\").Value = \"GREEN\"\n                GreenCount = GreenCount + 1\n                GreenTool = True\n                Call GREENSTYLE\n            Case Mid(ToolNumber, 2, 1) = \"]\"\n                ToolNumber = Replace(ToolNumber, \"]\", \"\")\n                Range(\"B2\").Value = \"RED or BLUE\"\n                RoBCount = RoBCount + 1\n                RoBTool = True\n                Call RoBSTYLE\n        End Select\n        Select Case ToolNumber\n            Case 5\n                Range(\"J31\") = Mid(textline, 25, 6)\n            Case 6\n                Range(\"J32\") = Mid(textline, 25, 6)\n            Case 7\n                Range(\"J33\") = Mid(textline, 25, 6)\n        End Select\n\n        Range(\"I\" &amp; ToolNumber) = ToolNumber\n\n    Case \"Comments\"\n    i = i + 1\n        Debug.Print (\"CONTAINS COMMENTS\")\n        Comments = Mid(textline, 21)\n        Range(\"AA\" &amp; i).Value = ToolNumber &amp; \" \" &amp; Comments\n\n        Select Case True\n        Case GreenTool = True\n                GreenTools = GreenTools &amp; vbNewLine &amp; ToolNumber &amp; \" \" &amp; Comments\n                GreenTool = False\n        Case RoBTool = True\n                RoBTools = RoBTools &amp; vbNewLine &amp; ToolNumber &amp; \" \" &amp; Comments\n                RoBTool = False\n        End Select\n\n    Case \"Machining Time\"\n    Select Case i\n        Case Is = 0\n    Debug.Print (\"CONTAINS MACHINING TIME\")\n        cb = Mid(textline, 21)\n          Select Case cb\n          Case Left(cb, 2) = 0\nRange(\"E37\") = Mid(cb, 4, 2)\nRange(\"F37\") = Mid(cb, 7)\n          Case Else\nRange(\"E37\") = Mid(cb, 4, 2) + (Left(cb, 2) * 60)\nRange(\"F37\") = Mid(cb, 7)\n          End Select\n          End Select\nEnd Select\n\nSelect Case True\nCase i = 0 And Left(textline, 3) = \"V:\\\"\n    Debug.Print (Mid(textline, 21, 27))\n    Debug.Print (Mid(textline, 18, 11))\n    Debug.Print (Mid(textline, 35, 20))\n    Debug.Print (Mid(textline, 21, 13))\n    Select Case True\n        Case Mid(textline, 21, 27) = \"PRODUCTION PROGRAMS 9-05-07\"\n            Range(\"B33\") = \"PRODUCTION PROGRAMS\"\n        Case Mid(textline, 18, 11) = \"2_Customers\"\n            Range(\"B33\") = \"CUSTOMER FILE\"\n        Case Mid(textline, 35, 20) = \"REPLACEMENT PROGRAMS\"\n            Range(\"B33\") = \"REPLACEMENT PROGRAMS\"\n        Case Mid(textline, 21, 13) = \"CUSTOM SHEETS\"\n            Range(\"B33\") = \"CUSTOM SHEETS\"\n    End Select\n    SAVEDVAR = 1\nEnd Select\n\nSelect Case True\nCase i &gt; 0 And SAVEDVAR = 0\n            MsgBox \"NOTICE: File has not been saved. Please save the current ArtCam file to continue.\", vbOKOnly\n            Close #1\n            Exit Sub\nEnd Select\nLoop\nClose #1\n\n    Select Case True\n    Case GreenCount &lt;&gt; 0 And RoBCount &lt;&gt; 0\n        Select Case True\n            Case GreenCount &gt; RoBCount\n                MsgBox \"Error: Red and Blue machine tools are used in this program! The tools are: \" &amp; RoBTools &amp; vbNewLine &amp; \"Fix and try again.\", vbExclamation\n                Exit Sub\n            Case GreenCount &lt; RoBCount\n                MsgBox \"Error: Green machine tools are used in this program! The tools are: \" &amp; GreenTools &amp; vbNewLine &amp; \"Fix and try again.\", vbExclamation\n                Exit Sub\n        End Select\nEnd Select\n\nSleep (100)\nRange(\"AA1:AA50\").SORT _\nKey1:=Range(\"AA1\"), Order1:=xlAscending\nCall AUTOTOOLPATHcompare\nEnd Sub\nSub AUTOTOOLPATHcompare()\nDim textline As String, n As Long\nn = 1\nRange(\"Z1:Z50\").ClearContents\nOpen \"V:\\CNC DEPT\\ART CAM\\WILL B\\WILL PROGRAMS\\AUTOTOOLPATHorder.txt\" For Input As #1\nDo Until EOF(1)\nLine Input #1, textline\nDebug.Print (textline)\nFor X = 1 To 50\nSelect Case Range(\"AA\" &amp; X)\n    Case Is &lt;&gt; \"\"\nSelect Case textline\nCase Is = Range(\"AA\" &amp; X)\nRange(\"Z\" &amp; X) = n\nDebug.Print (n)\nn = n + 1\nEnd Select\nEnd Select\nNext\nLoop\nClose #1\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 626, "user_id": 4760900, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-HImPwY2suoM/AAAAAAAAAAI/AAAAAAAAABI/EiWMAOBgoEM/photo.jpg?sz=128", "display_name": "icebird76", "link": "https://stackoverflow.com/users/4760900/icebird76"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1446, "favorite_count": 0, "accepted_answer_id": 30654197, "answer_count": 1, "score": 1, "last_activity_date": 1594153318, "creation_date": 1433365473, "last_edit_date": 1594153318, "question_id": 30630691, "link": "https://stackoverflow.com/questions/30630691/excel-vba-add-strings-to-a-list-and-sort-alphabetically-and-numerically", "title": "Excel VBA Add strings to a list, and sort alphabetically and numerically", "body": "<p>Here are the goals for my latest project I'm working on. In a text file, there is information for different tools. </p>\n\n<ol>\n<li><p>Parse a text file and extract a number and a string. <strong>DONE.</strong> Although, in the final build, I need to to parse through the clipboard.</p></li>\n<li><p>Put these two items into a list of some sort. I have tried attempting to make a dynamic multi-dimensional array so the left would be tool number and the right would be the toolpath name. I couldn't get arrays to work, so I then tried collections. The problem with collections is that there is no sort function, which is what I need. I also learned about dictionaries, which sparked the idea that I may be missing something I could use. Are those three the only things available?</p></li>\n<li><p>Use a list that will determine which item from #2 should be used and determine what position in the list it is. Then use the information to do some tasks.</p></li>\n<li><p>Use the item from #3 and remove it from the #2 list.</p></li>\n<li><p>Repeat goal 2-4 until all items have been removed.</p></li>\n</ol>\n\n<p>So this is for CNC machining, when saving toolpaths. Normally, the user would organize the order of what tools should go first, second, etc., but I would like to do that all automatically. I know how to navigate the menu using VBA, I just need to figure out how to organize the information so Excel can do it all.</p>\n\n<p>My theory for step 3 is to use a collection in the main list, and search the collection from a term in the CorrectOrder collection. So if it finds it in the main list, I would take action. If not, it would continue down the CorrectOrder collection.</p>\n\n<p>So basically, I need ideas on what I should use for this: collections, arrays, dictionaries, or something else.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1433365240, "post_id": 30630524, "comment_id": 49326870, "body": "Can you show the code that you use to <i>save</i> the filename? The logic should be nearly identical."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 3, "creation_date": 1433365371, "post_id": 30630524, "comment_id": 49326958, "body": "Otherwise, we need more information. How should the application know <i>which</i> file to open? Does it always open the <i>most recent</i> file (i.e., the one produced &lt;= 7 days ago?"}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1433370250, "post_id": 30630524, "comment_id": 49329196, "body": "Using the 2 examples you gave, we know that &quot;06-03-15&quot;&gt;&quot;05-27-15&quot;. Loop through the filenames doing this comparison, if true then make the new file comparison the filename to open, the highest number will naturally bubble to the surface."}], "answers": [{"tags": [], "owner": {"reputation": 6859, "user_id": 2643172, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VMWUe.jpg?s=128&g=1", "display_name": "Mauricio Moraes", "link": "https://stackoverflow.com/users/2643172/mauricio-moraes"}, "is_accepted": false, "score": 0, "last_activity_date": 1433365362, "creation_date": 1433365362, "answer_id": 30630660, "question_id": 30630524, "link": "https://stackoverflow.com/questions/30630524/vba-code-to-open-a-changing-file-name/30630660#30630660", "title": "VBA code to open a changing file name", "body": "<p><a href=\"http://spreadsheetpage.com/index.php/tip/getting_a_list_of_file_names_using_vba/\" rel=\"nofollow\">This reference</a> has this function:</p>\n\n<pre><code>Function GetFileList(FileSpec As String) As Variant\n'   Returns an array of filenames that match FileSpec\n'   If no matching files are found, it returns False\n\n    Dim FileArray() As Variant\n    Dim FileCount As Integer\n    Dim FileName As String\n\n    On Error GoTo NoFilesFound\n\n    FileCount = 0\n    FileName = Dir(FileSpec)\n    If FileName = \"\" Then GoTo NoFilesFound\n\n'   Loop until no more matching files are found\n    Do While FileName &lt;&gt; \"\"\n        FileCount = FileCount + 1\n        ReDim Preserve FileArray(1 To FileCount)\n        FileArray(FileCount) = FileName\n        FileName = Dir()\n    Loop\n    GetFileList = FileArray\n    Exit Function\n\n'   Error handler\nNoFilesFound:\n    GetFileList = False\nEnd Function\n</code></pre>\n\n<p>Now you can do:</p>\n\n<pre><code>p = \"H:\\silly\\goose\\*.xlsm\"\nx = GetFileList(p)\n</code></pre>\n\n<p>And get the file you want</p>\n"}, {"comments": [{"owner": {"reputation": 444, "user_id": 4730778, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/698ec16b61164c94aee6a20da396f0f3?s=128&d=identicon&r=PG&f=1", "display_name": "Tawm", "link": "https://stackoverflow.com/users/4730778/tawm"}, "edited": false, "score": 0, "creation_date": 1433510879, "post_id": 30632602, "comment_id": 49397559, "body": "could you explain what this line means?: Format(Date - Weekday(Date) + 3, &quot;mm-dd-yy&quot;)       I removed your -1 because this macro should always be run on a Wednesday.  However, I still don&#39;t understand the Weekday(Date)+3"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 444, "user_id": 4730778, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/698ec16b61164c94aee6a20da396f0f3?s=128&d=identicon&r=PG&f=1", "display_name": "Tawm", "link": "https://stackoverflow.com/users/4730778/tawm"}, "edited": false, "score": 0, "creation_date": 1433543561, "post_id": 30632602, "comment_id": 49415232, "body": "@Tawm That simple gets the date of the <i>Wednesday</i> of the week so that you&#39;ll create a file out of it. So this week, it returns <i>6/3/2015</i> but running it next week will return <i>6/10/2013</i>. Now, if this is not what you need, revise your question accordingly and explain a bit more what you need."}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 2, "last_activity_date": 1433455583, "last_edit_date": 1433455583, "creation_date": 1433374313, "answer_id": 30632602, "question_id": 30630524, "link": "https://stackoverflow.com/questions/30630524/vba-code-to-open-a-changing-file-name/30632602#30632602", "title": "VBA code to open a changing file name", "body": "<p>What you need to do is re-construct your file name first.</p>\n\n<pre><code>Const fpath As String = \"H:\\silly\\goose\\\" ' your fixed folder\nDim fname As String\n\n' Below gives you the Wednesday of the week\nfname = Format(Date - (Weekday(Date) - 1) + 3, \"mm-dd-yy\") ' returns 06-03-15 if run today\nfname = \"Report \" &amp; fname &amp; \".xlsm\" ' returns Report 06-03-15.xlsm\nfname = fpath &amp; fname ' returns H:\\silly\\goose\\Report 06-03-15.xlsm\n</code></pre>\n\n<p>Then execute opening of the file:</p>\n\n<pre><code>Dim wb As Workbook\nSet wb = Workbooks.Open(fname)\nIf wb Is Nothing Then MsgBox \"File does not exist\": Exit Sub\n\n' Rest of your code goes here which works on wb Object\n</code></pre>\n"}], "owner": {"reputation": 444, "user_id": 4730778, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/698ec16b61164c94aee6a20da396f0f3?s=128&d=identicon&r=PG&f=1", "display_name": "Tawm", "link": "https://stackoverflow.com/users/4730778/tawm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10109, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1433455583, "creation_date": 1433364912, "last_edit_date": 1433373028, "question_id": 30630524, "link": "https://stackoverflow.com/questions/30630524/vba-code-to-open-a-changing-file-name", "title": "VBA code to open a changing file name", "body": "<p>I'm trying to figure out a line of code to open a file.\nThe path is constant, that is </p>\n\n<pre><code>\"H:\\silly\\goose\\*filename.xlsm*\"\n</code></pre>\n\n<p>However, this file name will change each time I try to run this macro.  This is because I will be using this macro to automate a report which I run weekly.  Each report is saved with the date in the title and all reports are kept in the same folder, meaning I can't just start naming them all the same.\nExamples:</p>\n\n<blockquote>\n  <p>H:\\silly\\goose\\Report 06-03-15.xlsm<br>\n  H:\\silly\\goose\\Report 05-27-15.xlsm</p>\n</blockquote>\n\n<p>The only helping piece of information is that this report is to be run every Wednesday.  Therefore, each filename will have a difference of 7 days.  I don't know if there is anything I can do with the <code>Date</code> method here, though.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 0, "creation_date": 1433364900, "post_id": 30630359, "comment_id": 49326664, "body": "Replace <code>DoCmd.Close</code> with <code>Me.Visible = False</code> instead."}], "answers": [{"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 1, "last_activity_date": 1433365301, "last_edit_date": 1433365301, "creation_date": 1433364963, "answer_id": 30630545, "question_id": 30630359, "link": "https://stackoverflow.com/questions/30630359/passing-values-from-one-form-to-another-in-access/30630545#30630545", "title": "Passing values from one form to another in Access", "body": "<p>After <code>OpenForm</code>, do <code>DoCmd.Close acForm, Me.Name</code> to close the current form --- the form whose code module contains your <em>ID_AfterUpdate</em> procedure.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub ID_AfterUpdate()\n    Dim id As String\n    id = Me.ComboBox\n    DoCmd.OpenForm \"Part II\", , , , , , id\n    DoCmd.Close acForm, Me.Name\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2222, "favorite_count": 0, "accepted_answer_id": 30630545, "answer_count": 1, "score": 1, "last_activity_date": 1433393470, "creation_date": 1433364408, "last_edit_date": 1433393470, "question_id": 30630359, "link": "https://stackoverflow.com/questions/30630359/passing-values-from-one-form-to-another-in-access", "title": "Passing values from one form to another in Access", "body": "<p>I have a popup form with a combobox that lets you select a value from the primary key of one of my tables.</p>\n\n<p>After I select a value, I want the popup form to close and for another form to open with the observation I selected in the first form populating the second form.</p>\n\n<p>This code does everything I want except close the first popup form:</p>\n\n<pre><code>Private sub ID_AfterUpdate()\nDim id as String\nid=Me.ComboBox\nDoCmd.OpenForm \"Part II\",,,,,,id\nend sub\n</code></pre>\n\n<p>This code does what I want except it doesn't close the popup form so I tried:</p>\n\n<pre><code>Private sub ID_AfterUpdate()\nDim id as String\nid=Me.ComboBox\nDoCmd.Close\nDoCmd.OpenForm \"Part II\",,,,,,id\nend sub\n</code></pre>\n\n<p>But now it doesn't work at all. I simply get \"Object doesn't support this property or method\".\nI also tried:</p>\n\n<pre><code>Private sub ID_AfterUpdate()\nDim id as String\nid=Me.ComboBox\nDoCmd.OpenForm \"Part II\",,,,,,id\nDoCmd.Close    \nend sub\n</code></pre>\n\n<p>But that doesn't work at all, doesn't open the second form or close the first form.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": false, "score": 0, "last_activity_date": 1433364762, "creation_date": 1433364762, "answer_id": 30630478, "question_id": 30630138, "link": "https://stackoverflow.com/questions/30630138/comparing-two-sets-of-data-one-is-rounded-to-7-decimals-places-and-the-other-to/30630478#30630478", "title": "Comparing two sets of data, one is rounded to 7 decimals places and the other to 8", "body": "<p>Something along the lines of:</p>\n\n<pre><code>IF Round(WorkSheets(\"name\").Range(\"BE\" &amp; cell.row - 1) , 7)\n</code></pre>\n\n<p>can be used to round of the cells with 8 decimal places down to seven. If perhaps you still don't match due to precision, you can round each of the cases down to 6 (or 5, or 4...) decimal places. This may possibly reduce precision, but will increase the number of matches.</p>\n"}, {"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 0, "last_activity_date": 1433379021, "creation_date": 1433379021, "answer_id": 30633223, "question_id": 30630138, "link": "https://stackoverflow.com/questions/30630138/comparing-two-sets-of-data-one-is-rounded-to-7-decimals-places-and-the-other-to/30633223#30633223", "title": "Comparing two sets of data, one is rounded to 7 decimals places and the other to 8", "body": "<p>Since you are testing for equity between two floating point numbers, you can kill two birds with one stone and use an epsilon comparison instead of testing equality:</p>\n\n<pre><code>Const Epsilon As Double = 0.00000001\n\n'...\n\nDim cell As Range\nDim value1 As Double, value2 As Double\nFor Each cell In Range(\"A3:A200\")\n    value1 = Worksheets(\"name1\").Range(\"BE\" &amp; cell.Row - 1)\n    value2 = Worksheets(\"name2\").Range(\"X\" &amp; cell.Row)\n    If condition1 And condition2 And condition3 And _\n    (value1 - value2 &lt; Epsilon) Then\n        'do code\n    Else\n        'do something\n    End If\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4971298, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YhLuXR3lcBs/AAAAAAAAAAI/AAAAAAAAAHc/R88FEe95MHI/photo.jpg?sz=128", "display_name": "Daniel Jebodh", "link": "https://stackoverflow.com/users/4971298/daniel-jebodh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1433685920, "creation_date": 1433363675, "last_edit_date": 1433685920, "question_id": 30630138, "link": "https://stackoverflow.com/questions/30630138/comparing-two-sets-of-data-one-is-rounded-to-7-decimals-places-and-the-other-to", "title": "Comparing two sets of data, one is rounded to 7 decimals places and the other to 8", "body": "<p>I am comparing two sets of data. I need help with a part of an <code>IF</code> statement. it looks something like this:</p>\n\n<pre><code>Sheets(\"sheet1\").Select\n\nDim cell As Range\n\nFor Each cell In Range(\"A3:A200\")\n    If [condition1] And [condition2] And [condition3] And _\n          Worksheets(\"name1\").Range(\"BE\" &amp; cell.row - 1) = Worksheets(\"name2\").Range\n          (\"X\" &amp; cell.Row) Then\n        [do code]\n    Else\n        [do something]\n    End If\n    ...\nNext\n</code></pre>\n\n<p>There are about 50 conditions. However <code>\"name1\"</code> sheet has 8 decimals places in <code>BE</code> and <code>\"name2\"</code> sheet has 7 in <code>X</code>. So it's failing. How can I round or fix this?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1433369898, "post_id": 30630131, "comment_id": 49329059, "body": "Ctrl+K to the code line and some spell/grammar"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4971286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d315198e94f84ce64cd0de9d1863643?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/4971286/dave"}, "edited": false, "score": 0, "creation_date": 1433538906, "post_id": 30631925, "comment_id": 49413588, "body": "Thanks for your suggestion.  That didn&#39;t help yet.  I may have a simpler problem.  I have noticed that RC[-1] used to return the value of that cell and now it just returns the cell; i.e. in my current example, rr is 23 and cc is 1  It is returning A23 rather than the value of that cell.  Also, when I run the macro the formulas are not being evaluated."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 1, "user_id": 4971286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d315198e94f84ce64cd0de9d1863643?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/4971286/dave"}, "edited": false, "score": 0, "creation_date": 1433539498, "post_id": 30631925, "comment_id": 49413836, "body": "Yes, that is exactly how the <a href=\"https://support.office.com/en-us/article/match-function-0600e189-9f3c-4e4f-98c1-943a0eb427ca\" rel=\"nofollow noreferrer\">MATCH function</a> works. It returns the row number of the match so the named range <i>Num</i> must closely duplicate column A. If you want to return a cell&#39;s value either from column A or another column use a <a href=\"https://support.office.com/en-us/article/index-function-0ee99cef-a811-4762-8cfb-a222dd31368a\" rel=\"nofollow noreferrer\">INDEX</a>/MATCH function pair or possibly <a href=\"https://support.office.com/en-us/article/vlookup-function-adceda66-30de-4f26-923b-7257939faa65\" rel=\"nofollow noreferrer\">VLOOKUP</a>."}, {"owner": {"reputation": 1, "user_id": 4971286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d315198e94f84ce64cd0de9d1863643?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/4971286/dave"}, "edited": false, "score": 0, "creation_date": 1433542281, "post_id": 30631925, "comment_id": 49414894, "body": "Thanks again.  I have noticed that the following formula works well: =MATCH(A22,Num,0) but that =MATCH(A23,Num,0) doesn&#39;t.  Both cells A22 and A23 are populated. ???"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 1, "user_id": 4971286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d315198e94f84ce64cd0de9d1863643?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/4971286/dave"}, "edited": false, "score": 0, "creation_date": 1433542620, "post_id": 30631925, "comment_id": 49414992, "body": "Perhaps <i>Num</i> only goes to row 22. At some point you are going to have to show some sample data and explain exactly how <i>Num</i> is defined."}, {"owner": {"reputation": 1, "user_id": 4971286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d315198e94f84ce64cd0de9d1863643?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/4971286/dave"}, "edited": false, "score": 0, "creation_date": 1433603641, "post_id": 30631925, "comment_id": 49428615, "body": "OK. I have two sheets in a workbook.  One is the inventory called INVENT and the other is supposed to be a list of sales from a show.  Column C in INVENT is the inventory number.  I just replaced Num with its value and the same thing occured in the show worksheeet.  =MATCH(A22,INVENT!$C:$C,0) works correctly and =MATCH(A23,INVENT!$C:$C,0) fails."}, {"owner": {"reputation": 1, "user_id": 4971286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d315198e94f84ce64cd0de9d1863643?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/4971286/dave"}, "edited": false, "score": 0, "creation_date": 1433605483, "post_id": 30631925, "comment_id": 49429131, "body": "I also just noticed that the macro works fine in a different show worksheet.  It seems this isn&#39;t exactly a VBA question anymore.  Something is weird with this sheet.  I tried copying it into a new sheet, but the same problem happened."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1433370583, "creation_date": 1433370583, "answer_id": 30631925, "question_id": 30630131, "link": "https://stackoverflow.com/questions/30630131/match-function-suddenly-stopped-working/30631925#30631925", "title": "MATCH function suddenly stopped working", "body": "<p>If you were trying to put a formula into the cell defined by row:=rr, column:=cc+1 then the code really should be,</p>\n\n<pre><code>Cells(rr, cc + 1).FORMULAR1C1 = \"=MATCH(RC[-1], Num, 0)\"\n</code></pre>\n\n<p>(sorry - all caps for emphasis) That formula would make use of a <em>Named Range</em> called <em>Num</em>. Check Formulas \u25ba Defined Names \u25ba Name Manager for its existence. It will refer to a single row or column of cells where the lookup for the value of one cell to the left is performed.</p>\n\n<p>If you try and put an <em>xlR1C1</em> style formula in as the .Value, it <em>may</em> be correctly interpreted by the worksheet overhead as a formula. However, without a defined <em>Num</em> range, this would produce the <code>#NAME?</code> error on the worksheet.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4971286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d315198e94f84ce64cd0de9d1863643?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/4971286/dave"}, "is_accepted": false, "score": 0, "last_activity_date": 1433621883, "creation_date": 1433621883, "answer_id": 30687191, "question_id": 30630131, "link": "https://stackoverflow.com/questions/30630131/match-function-suddenly-stopped-working/30687191#30687191", "title": "MATCH function suddenly stopped working", "body": "<p>The problem turned out to be a bad data entry in the worksheet I was trying to MATCH to.  I don't know why it didn't just return a FALSE value.  However, I have solved my problem thanks to the help from this site.\nThanks.</p>\n"}], "owner": {"reputation": 1, "user_id": 4971286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d315198e94f84ce64cd0de9d1863643?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/4971286/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 154, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1433621883, "creation_date": 1433363651, "last_edit_date": 1531164843, "question_id": 30630131, "link": "https://stackoverflow.com/questions/30630131/match-function-suddenly-stopped-working", "title": "MATCH function suddenly stopped working", "body": "<p>I wrote this VBA macro for Excel code many years ago and it has suddenly stopped working. I'm trying to find the row index in one sheet that exactly matches an entry in the current sheet. The line of code that has stopped working is:</p>\n\n<pre><code>Cells(rr, cc + 1).Value = \"=MATCH(RC[-1], Num, 0)\"\n</code></pre>\n\n<p>I'm not sure what <strong>Num</strong> is, since it isn't referenced anywhere in the macro earlier. In particular, I don't see how it references the worksheet i'm interested in.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1433366877, "post_id": 30630008, "comment_id": 49327712, "body": "What code do you have so far? You could use the <code>CurrentRegion</code> method of the <code>Range</code> object to get a reference to the block of data and then use the <code>Rows</code> property to get the number of rows. For example,  <code>numRows = Workbook(&quot;name_of_book.xlsm&quot;).Worksheets(&quot;sheet_name&quot;).Range&zwnj;&#8203;(&quot;A1&quot;).CurrentRegion&zwnj;&#8203;.Rows.Count</code>"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 4636887, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/256c05bba4cddf9877617a7c4f2ad82c?s=128&d=identicon&r=PG&f=1", "display_name": "xslyx", "link": "https://stackoverflow.com/users/4636887/xslyx"}, "edited": false, "score": 0, "creation_date": 1433791224, "post_id": 30632292, "comment_id": 49492263, "body": "This is perfect Paul, thank you.  I&#39;m not familiar with some of the syntax used such as IsError, Indirect(address(row()).  I&#39;m trying to learn them now."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 35, "user_id": 4636887, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/256c05bba4cddf9877617a7c4f2ad82c?s=128&d=identicon&r=PG&f=1", "display_name": "xslyx", "link": "https://stackoverflow.com/users/4636887/xslyx"}, "edited": false, "score": 0, "creation_date": 1433791884, "post_id": 30632292, "comment_id": 49492631, "body": "I&#39;m glad it helps. IsError is a VBA function (there is and Excel equivalent for it) and it returns True for these types of errors: &quot;#DIV/0!&quot;, &quot;#N/A&quot;, &quot;#NAME?&quot;, &quot;#NULL&quot;, &quot;#NUM!&quot;, &quot;#REF&quot;, &quot;#VALUE!&quot;"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 35, "user_id": 4636887, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/256c05bba4cddf9877617a7c4f2ad82c?s=128&d=identicon&r=PG&f=1", "display_name": "xslyx", "link": "https://stackoverflow.com/users/4636887/xslyx"}, "edited": false, "score": 0, "creation_date": 1433792098, "post_id": 30632292, "comment_id": 49492761, "body": "Normally I&#39;d avoid using &quot;INDIRECT&quot; because it&#39;s volatile - it forces recalculations and updates with every change. It works like this: if cell A1 has the value &quot;C3&quot;, then =INDIRECT(A1) will return the value in cell C3. If you have a lot of data (thousands of rows or more) we should probably use something else to concatenate the fields"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 1, "last_activity_date": 1433372445, "creation_date": 1433372445, "answer_id": 30632292, "question_id": 30630008, "link": "https://stackoverflow.com/questions/30630008/vba-count-rows-then-in-column-c-then-fill-columns-a-b-and-p-with-equations/30632292#30632292", "title": "VBA - Count Rows then in Column C then fill Columns A, B and P with Equations", "body": "<p>try this:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub fillRanges()\n\n    Dim ur As Range, hdr As Range, conCol As Variant, lRow As Long\n    Dim ownCol As Variant, comCol As Variant\n    Dim actCol As Variant, empCol As Variant\n\n    Set ur = Sheet1.UsedRange   ' minimal range\n    Set hdr = ur.Rows(1)        ' header row\n    lRow = ur.Rows.Count        ' last row\n\n    With Application\n        ownCol = .Match(\"Owner\", hdr, 0)\n        comCol = .Match(\"Comment\", hdr, 0)\n        actCol = .Match(\"Account\", hdr, 0)\n        empCol = .Match(\"Employee\", hdr, 0)\n        conCol = .Match(\"Concatenate\", hdr, 0)\n    End With\n\n    If Not IsError(ownCol) And _\n        Not IsError(comCol) And _\n        Not IsError(actCol) And _\n        Not IsError(empCol) And _\n        Not IsError(conCol) _\n    Then\n        With ur\n            .Range(.Cells(2, ownCol), .Cells(lRow, ownCol)) = \"INDEX-MATCH equation 1\"\n            .Range(.Cells(2, comCol), .Cells(lRow, comCol)) = \"INDEX-MATCH equation 2\"\n            .Range(.Cells(2, conCol), .Cells(lRow, conCol)).Formula = _\n                \"=INDIRECT(ADDRESS(ROW(),\" &amp; actCol &amp; \")) &amp; \"\" \"\" &amp; \" &amp; _\n                \" INDIRECT(ADDRESS(ROW(), \" &amp; empCol &amp; \"))\"\n        End With\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 4636887, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/256c05bba4cddf9877617a7c4f2ad82c?s=128&d=identicon&r=PG&f=1", "display_name": "xslyx", "link": "https://stackoverflow.com/users/4636887/xslyx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433372445, "creation_date": 1433363202, "last_edit_date": 1433364273, "question_id": 30630008, "link": "https://stackoverflow.com/questions/30630008/vba-count-rows-then-in-column-c-then-fill-columns-a-b-and-p-with-equations", "title": "VBA - Count Rows then in Column C then fill Columns A, B and P with Equations", "body": "<p>I have 5 columns.  Column C \"Account\" and column D \"Person\" are my data set. </p>\n\n<p>I want to use VBA to look at how many rows of data I have and then fill that number of rows in 1) Column E \"Concatenate\" with a concatenate of \"Account\" and \"Employee\" fill that number of rows in 2) columns A and B with an INDEX-MATCH equation I have.</p>\n\n<p>..I tried to draw out my columns below but it isn't formatting in the way I'd like it to be... sorry</p>\n\n<pre><code>Owner | Comment | Account | Employee | Concatenate\nJay   | Done    | JSMA1   | Sally    | JSMA1 Sally\nWill  | Not Done| KLLM4   | Jack     | KLLM4 Jack\nKen   | Done    | BM3R1   | Sam      | BM3R1 Sam\n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["arrays", "performance", "vba"], "comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1433363322, "post_id": 30629950, "comment_id": 49325840, "body": "Array of what? PLease, be more specific..."}, {"owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "reply_to_user": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1433363471, "post_id": 30629950, "comment_id": 49325920, "body": "Strings. Edited question."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433367351, "post_id": 30629950, "comment_id": 49327942, "body": "How will you determine that <code>ArrB</code> is populated?  Assuming you have a trick for that, you can always just set one equal to the other and it will update the reference: <code>ArrA = ArrB</code> is valid.  You are left with <b>1</b> array and two variables referring to it."}, {"owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "edited": false, "score": 0, "creation_date": 1433369560, "post_id": 30629950, "comment_id": 49328918, "body": "Sorry -- my bad. must be quittin&#39; time... should be <code>If ArrB(i) &lt;&gt; &quot;&quot;</code>"}], "owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1433369604, "creation_date": 1433363026, "last_edit_date": 1433369604, "question_id": 30629950, "link": "https://stackoverflow.com/questions/30629950/combining-same-sized-arrays-without-loop", "title": "Combining same-sized arrays without loop?", "body": "<p>In my VBA project, I have two arrays of strings, ArrA &amp; ArrB. They are identically sized. I would like to change ArrA such that if A = B if B is populated, and unchanged otherwise. In other words:</p>\n\n<p><code>If ArrB(i) &lt;&gt; \"\" Then ArrA(i) = ArrB(i)</code></p>\n\n<p>I could obviously just loop through <code>i = 0 to UBound(ArrA)</code>, but am looking to avoid a loop for performance reasons. Is there any other, better, way to accomplish this?</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "edited": false, "score": 0, "creation_date": 1433362425, "post_id": 30629491, "comment_id": 49325321, "body": "Comment on your code: <code>do ... Loop</code> around <code>for ... Next</code> is surely not necessary. Regarding your algorithm: Text to columns overwrite cells with the new data, so you just lose next columns when split the first one. To fix it you may copy first column to a new sheet, split there, then copy second column to the right of first one, split, and so on"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 4660232, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2cc310b8980ba78d8b6988854662cf45?s=128&d=identicon&r=PG&f=1", "display_name": "mccdo", "link": "https://stackoverflow.com/users/4660232/mccdo"}, "edited": false, "score": 0, "creation_date": 1433434151, "post_id": 30630129, "comment_id": 49361289, "body": "Thanks for the prompt answers. @Jeeped that solution nailed it."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1433363637, "creation_date": 1433363637, "answer_id": 30630129, "question_id": 30629491, "link": "https://stackoverflow.com/questions/30629491/formatting-excel-texttocolumn-using-access-vba/30630129#30630129", "title": "Formatting Excel texttocolumn using Access VBA", "body": "<p>Since you are using Access it would seem plausible that this is a contiguous block of data that may have blank cells but not pocketed <em>islands</em> of values separated by completely blank rows and/or columns. If this is the case, then the worksheet's <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196678.aspx\" rel=\"nofollow\">Range.CurrentRegion property</a> can be exploited to govern the cells to be processed.</p>\n\n<pre><code>Dim oExcel As Excel.Application, oWB As Workbook, oWS As Worksheet\nDim c As Long\n\nSet oExcel = New Excel.Application\nSet oWB = oExcel.Workbooks.Open(sPath)\nSet oWS = oWB.Sheets(1)\n\nWith oWS.Cells(1, 1).CurrentRegion\n    For c = 1 To .Columns.Count\n        With .Columns(c)\n            .TextToColumns Destination:=.Cells(1), DataType:=xlFixedWidth, FieldInfo:=Array(0, xlGeneralFormat)\n        End With\n    Next c\nEnd With\n</code></pre>\n\n<p>I prefer a <em>xlFixedWidth</em> approach while only supplying a single <em>FieldInfo</em> set of parameters.</p>\n"}], "owner": {"reputation": 55, "user_id": 4660232, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2cc310b8980ba78d8b6988854662cf45?s=128&d=identicon&r=PG&f=1", "display_name": "mccdo", "link": "https://stackoverflow.com/users/4660232/mccdo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "accepted_answer_id": 30630129, "answer_count": 1, "score": 0, "last_activity_date": 1594644361, "creation_date": 1433361490, "last_edit_date": 1594644361, "question_id": 30629491, "link": "https://stackoverflow.com/questions/30629491/formatting-excel-texttocolumn-using-access-vba", "title": "Formatting Excel texttocolumn using Access VBA", "body": "<p>I'm trying to convert all columns in an excel file using access VBA. I want to convert the columns from text to general format, using the TextToColumns function. </p>\n\n<p>The code that I'm trying to use is along these lines:</p>\n\n<pre><code>Dim oExcel As Excel.Application\nDim owb As Workbook\nDim oWS As Worksheet      \nDim rngS As Range\n\nSet oExcel = New Excel.Application\nSet owb = oExcel.Workbooks.Open(sPath)\nSet oWS = owb.Sheets(1)\nSet rngS = oWS.Columns\n\nDo While rngS &lt;&gt; \"\"\n\nFor Each rngS In oWS\n    rngS.TextToColumns rngS.Cells(1, 1), xlDelimited, xlDoubleQuote, False, True, False, False, False, False, xlGeneralFormat\n\nNext\n    Loop\n</code></pre>\n\n<p>I can use TexttoColumns for a single column but am having difficulty to get it to move across all columns in the spreadsheet. I know that this looks like badly concocted code so any help would be greatly appreciated!</p>\n"}, {"tags": ["excel", "vba", "global-variables"], "answers": [{"tags": [], "owner": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "is_accepted": false, "score": 0, "last_activity_date": 1433362572, "last_edit_date": 1433362572, "creation_date": 1433361705, "answer_id": 30629570, "question_id": 30629459, "link": "https://stackoverflow.com/questions/30629459/excel-vba-calling-global-variables-by-concatenated-name/30629570#30629570", "title": "Excel VBA - calling global variables by concatenated name", "body": "<p>I'm not aware of an \"indirect\" function in VBA, what you can do is to define a public array and store the values there, here you can get the values by index. As its not possible to define array constants in VBA you need to initialize your array before use (e.g. In the workbook's load event).</p>\n"}, {"comments": [{"owner": {"reputation": 119, "user_id": 4928171, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/cce087083a66a11c70bbf8c4d00b9b05?s=128&d=identicon&r=PG&f=1", "display_name": "metrazol", "link": "https://stackoverflow.com/users/4928171/metrazol"}, "edited": false, "score": 0, "creation_date": 1433363594, "post_id": 30629781, "comment_id": 49325987, "body": "That&#39;s an absolutely great suggestion - it might not work for me though. In my case, let&#39;s say in one workbook I have sheets like (off the top of my head, random stuff): &quot;People&quot;, &quot;Animals&quot;, &quot;Plants&quot;, whereas in the other workbook i&#39;ll have multiple related sheets to each one of those, like &quot;Data - People&quot;, &quot;Stuff - People&quot;, &quot;Whatever - People&quot;, and I even wanna add the prefix into the mix, activating &quot;People&quot; in one wbk, and then &quot;Data - People&quot; in the other."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 119, "user_id": 4928171, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/cce087083a66a11c70bbf8c4d00b9b05?s=128&d=identicon&r=PG&f=1", "display_name": "metrazol", "link": "https://stackoverflow.com/users/4928171/metrazol"}, "edited": false, "score": 0, "creation_date": 1433363807, "post_id": 30629781, "comment_id": 49326101, "body": "@metrazol  You can make the array elements anything you choose."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1433362449, "creation_date": 1433362449, "answer_id": 30629781, "question_id": 30629459, "link": "https://stackoverflow.com/questions/30629459/excel-vba-calling-global-variables-by-concatenated-name/30629781#30629781", "title": "Excel VBA - calling global variables by concatenated name", "body": "<p>Just use an array.  First run <strong>MAIN()</strong>, then run <strong>marine()</strong>:</p>\n\n<pre><code>Public WS(1 To 6) As String\n\nSub MAIN()\n   WS(1) = \"SheetNameA\"\n   WS(2) = \"SheetNameB\"\n   WS(3) = \"SheetNameC\"\n   WS(4) = \"SheetNameD\"\n   WS(5) = \"SheetNameE\"\n   WS(6) = \"SheetNameF\"\nEnd Sub\n\nSub marine()\n   For i = 1 To 6\n       Workbooks(\"Book1\").Sheets(WS(i)).Activate\n       [some more code doing stuff]\n   Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 4928171, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/cce087083a66a11c70bbf8c4d00b9b05?s=128&d=identicon&r=PG&f=1", "display_name": "metrazol", "link": "https://stackoverflow.com/users/4928171/metrazol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1433363038, "creation_date": 1433361389, "last_edit_date": 1433363038, "question_id": 30629459, "link": "https://stackoverflow.com/questions/30629459/excel-vba-calling-global-variables-by-concatenated-name", "title": "Excel VBA - calling global variables by concatenated name", "body": "<p>I have these</p>\n\n<pre><code>Public Const WS1 = \"SheetNameA\"\nPublic Const WS2 = \"SheetNameB\"\nPublic Const WS3 = \"SheetNameC\"\nPublic Const WS4 = \"SheetNameD\"\nPublic Const WS5 = \"SheetNameE\"\nPublic Const WS6 = \"SheetNameF\"\n</code></pre>\n\n<p>Where SheetNameA-B-C are the names of sheets in a workbook.\nAnd I would like to activate worksheets one after the other using a <code>For loop 1 to 6</code>like so:</p>\n\n<pre><code>For i = 1 to 6\n    Workbooks([wbkname]).Sheets(WS &amp; i).Activate\n    [some more code doing stuff]\nNext i\n</code></pre>\n\n<p>Now I know that doesn't work, I'm just trying to explain what I want.\nIs that possible? To call a public constant by a concatenated name (to make that public constant string the name of the sheet we're activating)?</p>\n\n<p>I hope that makes sense.</p>\n\n<p>Edit: On second thought, maybe I'll just do a <code>Select Case</code>, which I know is not pretty, but I think, will be fine for my purpose.</p>\n\n<pre><code>For i = 1 to 6\n    Select Case i\n        Case 1\n            somevariable = [name of one sheet]\n        Case 2\n            somevariable = [name of another sheet]\n        ....\n    End Select\n    Workbooks([wbkname]).Sheets(somevariable).Activate\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1281, "user_id": 2414900, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/HMnMw.jpg?s=128&g=1", "display_name": "Aaron Hellman", "link": "https://stackoverflow.com/users/2414900/aaron-hellman"}, "is_accepted": false, "score": 0, "last_activity_date": 1433362561, "creation_date": 1433362561, "answer_id": 30629826, "question_id": 30629287, "link": "https://stackoverflow.com/questions/30629287/create-a-macro-to-convert-upc-e-barcode-to-upc-a/30629826#30629826", "title": "Create a Macro to convert UPC E Barcode to UPC A", "body": "<p>I would recommend against using <code>ActiveCell</code> and instead use the iteration integer as a cell row. </p>\n\n<p>Like so: <code>Cells(i, 3).value2 = ...</code>, where i is the row number and 3 is the column number (since you are in column C). </p>\n\n<p>Then you can offset with <code>Cells(i,3).Offset(1,0).select</code>.</p>\n\n<p>This will also make the code run faster since you are not selecting each cell before you manipulate the data.</p>\n\n<p>Tip: If you want to iterate through rows and columns, you can do the following and not worry about what is selected and what is next:</p>\n\n<pre><code>For RowNum = 1 to 11\n    For ColNum = 1 to 11\n        Cells(RowNum, ColNum).value = \"\"\n    Next ColNum\nNext RowNum\n</code></pre>\n\n<p>-So this will run through 11 columns for each row for 11 rows!</p>\n"}], "owner": {"reputation": 1, "user_id": 4526006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78bcd05cfc89426375ee4eaba9245ccf?s=128&d=identicon&r=PG&f=1", "display_name": "Darryl", "link": "https://stackoverflow.com/users/4526006/darryl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 502, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433362561, "creation_date": 1433360797, "question_id": 30629287, "link": "https://stackoverflow.com/questions/30629287/create-a-macro-to-convert-upc-e-barcode-to-upc-a", "title": "Create a Macro to convert UPC E Barcode to UPC A", "body": "<p>My problem is that after the first loop oldupc is still referenced to A1 not off setting to A2, I created msgboxes to track progress in the loop. Do I need to Offset every Cell?  </p>\n\n<p>Sub ConvertUPCE()</p>\n\n<pre><code>Dim OldUPC As String\nDim NewUPC As String\nDim K As Double, i As Double\nDim L As Integer\n\nOldUPC = ActiveCell.Offset(0, -2).Value\nNewUPC = ActiveCell.Offset(0, 1).Value\nK = Cells(Rows.Count, \"A\").End(xlUp).Row\nL = ActiveCell.Value\n    MsgBox (K)\n'MsgBox OldUPC\n'MsgBox NewUPC\n'MsgBox L\n\nRange(\"c1\").Select\n\n For i = 1 To 11\n\n If (L &gt;= 0 And L &lt;= 3) Then\n      ActiveCell.Value2 = \"'\" &amp; Mid(OldUPC, 1, 1) &amp; Mid(OldUPC, 2, 2) &amp; Mid(OldUPC, 7, 1) &amp; \"0000\" &amp; Mid(OldUPC, 4, 3)\n      ActiveCell.Offset(1, 0).Select\n\n\n       ElseIf (L = 4) Then\n         ActiveCell.Value2 = \"'\" &amp; Mid(OldUPC, 1, 1) &amp; Mid(OldUPC, 2, 3) &amp; \"00000\" &amp; Mid(OldUPC, 5, 2)\n\n       ElseIf (L = 5) Then\n         ActiveCell.Value2 = \"'\" &amp; Mid(OldUPC, 1, 1) &amp; Mid(OldUPC, 2, 4) &amp; \"00000\" &amp; Mid(OldUPC, 6, 1)\n         ActiveCell.Offset(1, 0).Select\n\n       ElseIf (L &gt;= 6 And L &lt;= 9) Then\n         ActiveCell.Value2 = \"'\" &amp; Mid(OldUPC, 1, 1) &amp; Mid(OldUPC, 2, 5) &amp; \"0000\" &amp; Mid(OldUPC, 7, 1)\n         ActiveCell.Offset(1, 0).Select\n\n\n         Else: ActiveCell.Value = \"Not Vailid Check Digit\"\n\n      End If\n\n      'MsgBox OldUPC\n      MsgBox OldUPC\n\n Next i\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433366838, "post_id": 30629269, "comment_id": 49327694, "body": "Can you provide a picture of what you are trying to do?  <code>PrintTitleRows</code> must be given contiguous ranges.  Trying to repeat two rows not together (like <code>1:1 and 5:5</code>) is not allowed.  If you want to only show the last row, you would do better to use <code>Hidden=True</code> on the rows that you don&#39;t want printed."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433367142, "post_id": 30629269, "comment_id": 49327837, "body": "You could also set the print titles to the first row and then call <code>ExportAsFixedFormat</code> as <code>Range(row you want).Export...</code> instead of doing the whole <code>ActiveSheet</code>.  This will print with headers and only the <code>Range</code> (same as printing selection without actually selecting anything)."}, {"owner": {"reputation": 23, "user_id": 4966277, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XfqEi4FhIc0/AAAAAAAAAAI/AAAAAAAAAHI/ydTzzMGYhg0/photo.jpg?sz=128", "display_name": "Amy Snyder", "link": "https://stackoverflow.com/users/4966277/amy-snyder"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433453740, "post_id": 30629269, "comment_id": 49372038, "body": "I kind of figured it out? I basically made a new sheet and then did another copy/paste to that sheet. So it prints out only those, but still saves it on the &quot;big sheet&quot;"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433456187, "post_id": 30629269, "comment_id": 49372954, "body": "Sounds good.  If that&#39;s your answer then go ahead and add it below so we know this is resolved.  If you can show the code too that would be nice for the next person that comes on this."}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 4966277, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XfqEi4FhIc0/AAAAAAAAAAI/AAAAAAAAAHI/ydTzzMGYhg0/photo.jpg?sz=128", "display_name": "Amy Snyder", "link": "https://stackoverflow.com/users/4966277/amy-snyder"}, "is_accepted": true, "score": 0, "last_activity_date": 1435594467, "creation_date": 1435594467, "answer_id": 31120597, "question_id": 30629269, "link": "https://stackoverflow.com/questions/30629269/selecting-first-row-last-row-only-from-saved-file-to-print/31120597#31120597", "title": "Selecting first row/last row only from saved file to print", "body": "<p>Here's what worked (finally) I just Copied/pasted again.</p>\n\n<pre><code>Sub Save_History()\n</code></pre>\n\n<p><code>Sheets(\"Simple Calculation\").Select</code></p>\n\n<pre><code>Range(\"A2:I2\").Select\n\n    Selection.Copy\n\n        Sheets(\"New Media Report\").Select\n\n            Range(\"A1\").End(xlUp).Offset(1).Select\n\n                Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n</code></pre>\n\n<p><code>'copies data from calculation page\nSheets(\"Simple Calculation\").Select</code></p>\n\n<pre><code>Range(\"A2:I2\").Select\n\n    Selection.Copy\n\n        Sheets(\"Media History\").Select\n\n            Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Select\n\n                Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False Application.DisplayAlerts = False\n\n ' Check for year folder and create if needed\n</code></pre>\n\n<p><code>If Len(Dir(\"C:blah\\\" &amp; Year(Date), vbDirectory)) = 0 Then</code>\n    <code>MkDir \"C:blah\\\" &amp; Year(Date)</code>\n<code>End If</code></p>\n\n<p><code>' Check for month folder and create if needed</code>\n<code>If Len(Dir(\"C:blah\\\" &amp; Year(Date) &amp; \"\\\" &amp; MonthName(month(Date), False), vbDirectory)) = 0 Then\n    MkDir \"C:blah\\\" &amp; Year(Date) &amp; \"\\\" &amp; MonthName(month(Date), False)\nEnd If</code></p>\n\n<p><code>' Check for day folder and create if needed\nIf Len(Dir(\"C:blah\\\" &amp; Year(Date) &amp; \"\\\" &amp; MonthName(month(Date), False) &amp; \"\\\" &amp; Day(Date), vbDirectory)) = 0 Then\n    MkDir \"C:blah\\\" &amp; Year(Date) &amp; \"\\\" &amp; MonthName(month(Date), False) &amp; \"\\\" &amp; Day(Date)\nEnd If</code></p>\n\n<p><code>strFilePath = \"C:blah\\\" &amp; Year(Date) &amp; \"\\\" &amp; MonthName(month(Date), False) &amp; \"\\\" &amp; _\n              Format(Date, \"mm.dd.yy\") &amp; \"_\" &amp; Format(Time(), \"hh.mm.ssAM/PM\") &amp; \".pdf\"</code></p>\n\n<p><code>ActiveSheet.ExportAsFixedFormat Type:=x1TypePDF, Filename:=strFilePath, _\n                                Quality:=x1QualityStandard, IncludeDocProperties:=True, _</code>\n                               <code>IgnorePrintAreas:=False, OpenAfterPublish:=True _</code></p>\n\n<p><code>Application.DisplayAlerts = True</code></p>\n\n<p><code>' Popup Message\nMsgBox \"File Saved As:\" &amp; vbNewLine &amp; strFilePath</code></p>\n\n<p><code>End Sub</code></p>\n"}], "owner": {"reputation": 23, "user_id": 4966277, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XfqEi4FhIc0/AAAAAAAAAAI/AAAAAAAAAHI/ydTzzMGYhg0/photo.jpg?sz=128", "display_name": "Amy Snyder", "link": "https://stackoverflow.com/users/4966277/amy-snyder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 31120597, "answer_count": 1, "score": 0, "last_activity_date": 1435594467, "creation_date": 1433360704, "last_edit_date": 1435594012, "question_id": 30629269, "link": "https://stackoverflow.com/questions/30629269/selecting-first-row-last-row-only-from-saved-file-to-print", "title": "Selecting first row/last row only from saved file to print", "body": "<p>I've almost completed my code where I save data, export as pdf, all that jazz. I was wondering if there was a way to incorporate <code>[excel sheet].PageSetup.PrintTitleRows = \"$[firstrow]$[lastrow]\";</code> into my program. I'm not sure if this should be manipulated in some way. The first row holds all the units and the report saves data in each row, however, I only want the last row of data (new stuff), but with the unit row (row 1) as well. Here's my code, not entirely sure where it put it (proably near the end):</p>\n\n<pre><code>Sub Save_History()\n\n      'copies data from calculation page\nSheets(\"Simple Calculation\").Select\n\n    Range(\"A2:I2\").Select\n\n        Selection.Copy\n\n            Sheets(\"Media History\").Select\n\n                Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Select\n\n                    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False Application.DisplayAlerts = False`\n\n\n ' Check for year folder and create if needed\nIf Len(Dir(\"C:blah\\\" &amp; Year(Date), vbDirectory)) = 0 Then\n    MkDir \"C:blah\\\" &amp; Year(Date)\nEnd If\n\n\n ' Check for month folder and create if needed\nIf Len(Dir(\"C:blah\\\" &amp; Year(Date) &amp; \"\\\" &amp; MonthName(month(Date), False), vbDirectory)) = 0 Then\n    MkDir \"C:blah\\\" &amp; Year(Date) &amp; \"\\\" &amp; MonthName(month(Date), False)\nEnd If\n\n  ' Check for day folder and create if needed\nIf Len(Dir(\"C:blah\\\" &amp; Year(Date) &amp; \"\\\" &amp; MonthName(month(Date), False) &amp; \"\\\" &amp; Day(Date), vbDirectory)) = 0 Then\n    MkDir \"C:blah\\\" &amp; Year(Date) &amp; \"\\\" &amp; MonthName(month(Date), False) &amp; \"\\\" &amp; Day(Date)\nEnd If\n\n\nstrFilePath = \"C:blah\\\" &amp; Year(Date) &amp; \"\\\" &amp; MonthName(month(Date), False) &amp; \"\\\" &amp; _\n              Format(Date, \"mm.dd.yy\") &amp; \"_\" &amp; Format(Time(), \"hh.mm.ssAM/PM\") &amp; \".pdf\"\n\nActiveSheet.ExportAsFixedFormat Type:=x1TypePDF, Filename:=strFilePath, _\n                                Quality:=x1QualityStandard, IncludeDocProperties:=True, _\n                                IgnorePrintAreas:=False, OpenAfterPublish:=True _\n\n\nApplication.DisplayAlerts = True\n\n ' Popup Message\nMsgBox \"File Saved As:\" &amp; vbNewLine &amp; strFilePath\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "edited": false, "score": 1, "creation_date": 1433370896, "post_id": 30630455, "comment_id": 49329432, "body": "I agree that this answer should point the OP in the right direction. However, <code>Rows.Count</code> refers to the ActiveSheet rather than <code>newWS</code>. This will not cause problems per se since all sheets have the same number of rows, but it is sloppy. <code>Rows.Count</code> should be preceded by <code>newWS.</code>."}, {"owner": {"reputation": 219, "user_id": 4080394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RHAaZ.jpg?s=128&g=1", "display_name": "daytonrazorback", "link": "https://stackoverflow.com/users/4080394/daytonrazorback"}, "reply_to_user": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "edited": false, "score": 0, "creation_date": 1433430234, "post_id": 30630455, "comment_id": 49358590, "body": "Good catch Rachel Hettinger.  I have edited to reflect."}, {"owner": {"reputation": 43, "user_id": 4874754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T1GHh.jpg?s=128&g=1", "display_name": "Holly", "link": "https://stackoverflow.com/users/4874754/holly"}, "edited": false, "score": 0, "creation_date": 1433449641, "post_id": 30630455, "comment_id": 49370060, "body": "Thanks for the answer @daytonrazorback, works perfectly"}], "tags": [], "owner": {"reputation": 219, "user_id": 4080394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RHAaZ.jpg?s=128&g=1", "display_name": "daytonrazorback", "link": "https://stackoverflow.com/users/4080394/daytonrazorback"}, "is_accepted": true, "score": 2, "last_activity_date": 1433430181, "last_edit_date": 1433430181, "creation_date": 1433364679, "answer_id": 30630455, "question_id": 30629257, "link": "https://stackoverflow.com/questions/30629257/vba-macro-specifying-new-worksheet-for-data-generated/30630455#30630455", "title": "VBA macro - Specifying new worksheet for data generated", "body": "<p>The issue your are experiencing comes from the fact that you are putting the generated values at an offset of <code>Ws</code> which you have defined as the active sheet <code>Set Ws = ActiveSheet</code></p>\n\n<p>This is reflected here:</p>\n\n<pre><code>With Ws.Cells(Ws.Cells(Rows.Count, 1).End(xlUp).Row + 1, 1)\nFor k = 0 To nCol - 1 Step 1\n    .Offset(0, k).Value = Ws.Cells(i + 1, k + 1).Value\nNext k\n\n    .Offset(0, nCol).Value = DateSerial(Year(Ws.Cells(i + 1, nCol + 1).Value), Month(Ws.Cells(i + 1, nCol + 1).Value), Day(Ws.Cells(i + 1, nCol + 1).Value) + j)\nEnd With   \n</code></pre>\n\n<p>Instead of using the active sheet, define a new sheet to insert the values to and reference it in your <code>With</code> for example:</p>\n\n<pre><code>Dim newWS as worksheet\nSet newWS = Sheets(\"SheetName\")\n\nWith newWS.Cells(newWS.Cells(newWS.Rows.Count, 1).End(xlUp).Row + 1, 1)\n</code></pre>\n\n<p>This should put you on the right track.</p>\n"}], "owner": {"reputation": 43, "user_id": 4874754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T1GHh.jpg?s=128&g=1", "display_name": "Holly", "link": "https://stackoverflow.com/users/4874754/holly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 1, "accepted_answer_id": 30630455, "answer_count": 1, "score": 4, "last_activity_date": 1433430181, "creation_date": 1433360661, "last_edit_date": 1531164843, "question_id": 30629257, "link": "https://stackoverflow.com/questions/30629257/vba-macro-specifying-new-worksheet-for-data-generated", "title": "VBA macro - Specifying new worksheet for data generated", "body": "<p>At the moment I have a piece of code that can take start and end dates, and list all the dates in that date range.  This allows me to take the following table and split it down to individual dates.</p>\n\n<pre>|Name            | StartDate  | EndDate\n|Bob The builder | 20/05/2015 | 24/05/2015 \n|Tiny Tim        | 08/06/2015 | 09/06/2015\n|Dolly Parton    | 06/08/2015 | 08/08/2015\n</pre>\n\n<p>However at the moment it dumps the created data directly below the existing table like this:</p>\n\n<pre>|Name            | StartDate  | EndDate\n|Bob The builder | 20/05/2015 | 24/05/2015 \n|Tiny Tim        | 08/06/2015 | 09/06/2015\n|Dolly Parton    | 06/08/2015 | 08/08/2015\n|Bob The builder | 20/05/2015 | \n|Bob The builder | 21/05/2015 |\n|Bob The builder | 22/05/2015 | \n|Bob The builder | 23/05/2015 | \n|Bob The builder | 24/05/2015 | \n|Tiny Tim        | 08/06/2015 | \n|Tiny Tim        | 09/06/2015 | \n|Dolly Parton    | 06/08/2015 | \n|Dolly Parton    | 07/08/2015 |\n|Dolly Parton    | 08/08/2015 |\n</pre>\n\n<p>I've tried several ways of trying to get it to locate it on a new sheet and each time I muck about with the code it fails.  Please also note copying generated data won't work, as each time I run this macro the original table will have a different number of rows.  This is the code I've been using:</p>\n\n<pre><code>Sub SeparateDateRange()\n\nDim Ws As Worksheet\nDim nCol As Integer\n\n\nSet Ws = ActiveSheet\n\nnCol = 1 \n\nApplication.ScreenUpdating = False\n\n\nFor i = 1 To ActiveSheet.Cells(Rows.Count, nCol + 2).End(xlUp).Row - 1 Step 1 \n\n    For j = 0 To Ws.Cells(i + 1, nCol + 2).Value - Ws.Cells(i + 1, nCol + 1).Value Step 1 \n\n  With Ws.Cells(Ws.Cells(Rows.Count, 1).End(xlUp).Row + 1, 1)\n    For k = 0 To nCol - 1 Step 1\n        .Offset(0, k).Value = Ws.Cells(i + 1, k + 1).Value\n    Next k\n\n    .Offset(0, nCol).Value = DateSerial(Year(Ws.Cells(i + 1, nCol + 1).Value), Month(Ws.Cells(i + 1, nCol + 1).Value), Day(Ws.Cells(i + 1, nCol + 1).Value) + j)\n    End With\n\n    Next j\nNext i\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "is_accepted": false, "score": 0, "last_activity_date": 1433366413, "last_edit_date": 1495542115, "creation_date": 1433366413, "answer_id": 30630966, "question_id": 30629035, "link": "https://stackoverflow.com/questions/30629035/deleting-data-ranges-from-one-workbook-using-code-in-another-workbook/30630966#30630966", "title": "Deleting data ranges from one workbook using code in another workbook", "body": "<p>If <code>Select</code> works, then just replace it with <code>ClearContents</code> instead and delete the 2 lines under it that try to <code>Activate</code> and <code>Clear</code>.  I suspect the issue is <code>Activate</code> and that <code>O21</code> is being cleared but not the others.  You could also just delete the <code>Activate</code> line but I am trying to clean up an instance of <code>Select</code> that is not needed.</p>\n\n<pre><code>With xlApp.ActiveWorkbook.ActiveSheet\n    .Range(\"E36,E5,E7,E10,E13,E17,E39,J7:J11,J13:J20,J24:J29,J31:J33,J35,O21\").ClearContents\nEnd With\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>With xlApp.ActiveWorkbook.ActiveSheet\n    .Range(\"E36,E5,E7,E10,E13,E17,E39,J7:J11,J13:J20,J24:J29,J31:J33,J35,O21\").Select\n    .Range(\"O21\").Activate\n    xlApp.ActiveWorkbook.ActiveSheet.Selection.ClearContents\nEnd With\n</code></pre>\n\n<p>You could also compress the <code>With</code> and do it all on one line, but that is too wide for here so I didn't do it.</p>\n\n<p>You should also take a look at <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros/10717999#10717999\">this post about not using Select.</a></p>\n"}], "owner": {"reputation": 1, "user_id": 4971086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a45933cf717ff65a79b957732896311f?s=128&d=identicon&r=PG&f=1", "display_name": "Rob V", "link": "https://stackoverflow.com/users/4971086/rob-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433366413, "creation_date": 1433359972, "last_edit_date": 1531164843, "question_id": 30629035, "link": "https://stackoverflow.com/questions/30629035/deleting-data-ranges-from-one-workbook-using-code-in-another-workbook", "title": "Deleting data ranges from one workbook using code in another workbook", "body": "<p>I am having a heck of a time having code from one workbook (\"W1\") open another workbook (\"W2\") and perform deletions in W2.  When I run it, it selects the ranges in W2 but will not delete the selection.  I figured out I must be explict with naming W2 for the deletions, but I'm getting lost with it.  Any help would be very appreciated.</p>\n\n<p>My code is as follows:</p>\n\n<pre><code>Sub Clear_FM_Contents()\n\nDim f As FileDialog\nDim varfile As Variant\nDim path As Variant\n\n'Prompt the user to select the Excel File to Import\nSet f = Application.FileDialog(msoFileDialogFilePicker)\n\n'Error handling with file selector\nIf f.Show = False Then\n    MsgBox \"You clicked Cancel in the file dialog box.\"\n    End\nEnd If\n\n'Set the path of the User selected file\nFor Each varfile In f.SelectedItems\n    path = varfile\nNext\n\n'Create the Excel object\nDim xlApp As Excel.Application\nSet xlApp = CreateObject(\"Excel.Application\")\nxlApp.Visible = True\n\n'Open the selected Excel file\nxlApp.Workbooks.Open path, True, False\n\n'Clear all Template Inputs\nWith xlApp.ActiveWorkbook\n    .Sheets(\"Mrkt Data\").Select\n    With xlApp.ActiveWorkbook.ActiveSheet\n        .Range(\"E36,E5,E7,E10,E13,E17,E39,J7:J11,J13:J20,J24:J29,J31:J33,J35,O21\").Select\n        .Range(\"O21\").Activate\n        xlApp.ActiveWorkbook.ActiveSheet.Selection.ClearContents\n    End With\n    'Close the Excel File\n    ActiveWorkbook.Save\n    ActiveWorkbook.Close  \nEnd With\n'Close Excel\nxlApp.Quit\n'Eliminate the xl app object from memory\nSet xlApp = Nothing\n\nMsgBox \"Model Inputs Cleared\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "64-bit"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1433366966, "post_id": 30628817, "comment_id": 49327752, "body": "Found this. <a href=\"http://www.ozgrid.com/forum/showthread.php?t=174982\" rel=\"nofollow noreferrer\">ozgrid.com/forum/showthread.php?t=174982</a> Apparently, findwindow doesn&#39;t work because the password dialogbox is modal. Seems a timer is needed but not sure how to implement one :/"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1438276880, "post_id": 30628817, "comment_id": 51396040, "body": "<a href=\"http://stackoverflow.com/questions/16174469/unprotect-vbproject-from-vb-code/16176557#16176557\">Interesting Read</a> :P"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1438277340, "post_id": 30628817, "comment_id": 51396296, "body": "@SiddharthRout DUDE. I KNOW. That&#39;s where it all started. My link above  to the other question links to your site so I didn&#39;t link it again here XD"}], "answers": [{"tags": [], "owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "is_accepted": true, "score": 2, "last_activity_date": 1433867163, "creation_date": 1433867163, "answer_id": 30737739, "question_id": 30628817, "link": "https://stackoverflow.com/questions/30628817/findwindow-does-not-work-in-64bit-vba7/30737739#30737739", "title": "Findwindow does not work in 64bit VBA7", "body": "<p>Figured it out. The issue wasn't 64bit, it was a timing/focus issue.    </p>\n\n<pre><code>Sub unlockVBA(wb)\n\nIf wb.name = \"PERSONAL.XLSB\" Then Exit Sub\n\nApplication.VBE.MainWindow.Visible = True\n\nTimerID = SetTimer(0&amp;, 0&amp;, 500&amp;, AddressOf TimerProc)\n\nApplication.VBE.CommandBars(1).FindControl(ID:=2578, recursive:=True).Execute\n\nEnd Sub\n\nPublic Sub TimerProc(ByVal hwnd As LongPtr, ByVal wMsg As LongPtr, ByVal idEvent As LongPtr, ByVal dwTime As LongPtr)\n\nOn Error Resume Next\nKillTimer hwnd, TimerID\n\nMyPassword = \"password\"\n\nRet = FindWindow(vbNullString, \"VBAProject Password\")\nChildRet = FindWindowEx(Ret, ByVal 0&amp;, \"Edit\", vbNullString)\nIf ChildRet &lt;&gt; 0 Then\nCall SendMessage(ChildRet, WM_SETTEXT, False, ByVal MyPassword)\nDoEvents\nEnd If\n\nChildRet = FindWindowEx(Ret, ByVal 0&amp;, \"Button\", vbNullString)\n\nIf ChildRet &lt;&gt; 0 Then\n'MsgBox \"Button's Window Found\"\n\n'~~&gt; Get the caption of the child window\nstrBuff = String(GetWindowTextLength(ChildRet) + 1, Chr(0))\nGetWindowText ChildRet, strBuff, Len(strBuff)\nButCap = strBuff\n\n'~~&gt; Loop through all child windows\nDo While ChildRet &lt;&gt; 0\n    '~~&gt; Check if the caption has the word \"OK\"\n    If InStr(1, ButCap, \"OK\") Then\n    '~~&gt; If this is the button we are looking for then exit\n    OpenRet = ChildRet\n    Exit Do\n    End If\n\n    '~~&gt; Get the handle of the next child window\n    ChildRet = FindWindowEx(Ret, ChildRet, \"Button\", vbNullString)\n    '~~&gt; Get the caption of the child window\n    strBuff = String(GetWindowTextLength(ChildRet) + 1, Chr(0))\n    GetWindowText ChildRet, strBuff, Len(strBuff)\n    ButCap = strBuff\nLoop\n\nIf OpenRet &lt;&gt; 0 Then\n'~~&gt; Click the OK Button\nSendMessage ChildRet, BM_CLICK, 0, vbNullString\nElse\nMsgBox \"The Handle of OK Button was not found\"\nEnd If\nElse\nMsgBox \"Button's Window Not Found\"\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2767, "favorite_count": 0, "accepted_answer_id": 30737739, "answer_count": 1, "score": 4, "last_activity_date": 1433867163, "creation_date": 1433359287, "last_edit_date": 1495535061, "question_id": 30628817, "link": "https://stackoverflow.com/questions/30628817/findwindow-does-not-work-in-64bit-vba7", "title": "Findwindow does not work in 64bit VBA7", "body": "<p>The code presented at <a href=\"https://stackoverflow.com/questions/30508341/unlocking-password-protected-vba-project/30604345#30604345\">Unlocking Password Protected VBA project</a> works under 32 but not 64bit.\nSpecifically,</p>\n\n<pre><code>Ret = FindWindow(vbNullString, \"VBAProject Password\")\n</code></pre>\n\n<p>always return 0. I have tried</p>\n\n<pre><code>Ret = FindWindow(\"#32770\", \"VBAProject Password\")\n\nRet = FindWindow(\"XLMAIN\", \"VBAProject Password\")\n</code></pre>\n\n<p>None works. I have also tried the following APIs: setforegroundwindow, bringwindowtotop, setfocus, getactivewindow, getwindowthreadprocessid. Still failed so I don't think it's a focus issue. Perhaps it's timing? I tried using</p>\n\n<pre><code>SetTimer\n</code></pre>\n\n<p>but I am new to APIs so not sure how to implement that.</p>\n\n<p>I am calling this via the workbookopen app event inside my personal.xlsb I am trying to fill in password upon opening any workbook.</p>\n\n<pre><code>Private Sub AppEvent_WorkbookOpen(ByVal wb As Excel.Workbook)\n\nIf wb.VBProject.Protection &lt;&gt; 1 Then\nExit Sub\nEnd If\n\nCall unlockvba(wb)\n\nEnd Sub\n</code></pre>\n\n<p>Edit: I have set my declarations to PtrSafe and LongPtr where applicable.</p>\n"}, {"tags": ["vba", "excel", "button"], "comments": [{"owner": {"reputation": 3599, "user_id": 3383907, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c67c7344da32f3be91dcbda259ba6a89?s=128&d=identicon&r=PG", "display_name": "IMTheNachoMan", "link": "https://stackoverflow.com/users/3383907/imthenachoman"}, "edited": false, "score": 0, "creation_date": 1433359813, "post_id": 30628791, "comment_id": 49323813, "body": "If I understand correctly, you want to have a button in a worksheet in your Excel file that will run VBA/macro?"}, {"owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "reply_to_user": {"reputation": 3599, "user_id": 3383907, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c67c7344da32f3be91dcbda259ba6a89?s=128&d=identicon&r=PG", "display_name": "IMTheNachoMan", "link": "https://stackoverflow.com/users/3383907/imthenachoman"}, "edited": false, "score": 0, "creation_date": 1433361708, "post_id": 30628791, "comment_id": 49324885, "body": "Yes, I belive so. I&#39;m not supremely familiar with VBA that&#39;s why the hesitatoin. But yes, that sounds accurate"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1433362782, "post_id": 30628791, "comment_id": 49325551, "body": "Hi Taylor. Yes it is possible. <a href=\"http://www.techonthenet.com/excel/formulas/dir.php\" rel=\"nofollow noreferrer\">techonthenet.com/excel/formulas/dir.php</a> <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194819.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff194819.aspx</a> <a href=\"http://stackoverflow.com/questions/20212582/copy-range-from-one-sheet-to-another-vba\" title=\"copy range from one sheet to another vba\">stackoverflow.com/questions/20212582/&hellip;</a> To assign macro to a button add a button to your worksheet (Developer Tab -&gt; Insert) <a href=\"https://msdn.microsoft.com/en-us/library/bb608625.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/bb608625.aspx</a> right click on the button, select &quot;assign macro&quot; select your macro and click okay"}], "answers": [{"comments": [{"owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 0, "creation_date": 1433421364, "post_id": 30630057, "comment_id": 49351951, "body": "So I assign the code I have written to the button and the code you have typed up above to the...textbox insert?"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "reply_to_user": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 0, "creation_date": 1433515205, "post_id": 30630057, "comment_id": 49400763, "body": "If you want the TDS Search button to open one file, then you would want to use something like the example I provided. If you would like the TDS Search button to run your code, you might want to add something to your code that checks to see if the File: field is blank (If they don&#39;t enter a file and click your button, it runs your code - if they enter a file and click the button, you do a search for that file.) Is that what you&#39;re wondering? You can also add a second button if there are two distinct functions that you want to be able to run."}, {"owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 0, "creation_date": 1433515497, "post_id": 30630057, "comment_id": 49400975, "body": "My code currently opens every file in a folder (one by one), prints important info to columns 2, 3, and 4 and then prints the name of that specific file to column 1. I would like it so that I can type the file name into a textbox and it would search through the folder to open that specific file, and print the important info for just that file. I hope that I explained it better that time. Does that make sense? @user1274820"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "reply_to_user": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 0, "creation_date": 1433520729, "post_id": 30630057, "comment_id": 49404331, "body": "Yes, just replace your loop and code that goes through each file with a simple <code>Workbooks.Open PathName &amp; FileName</code> that only opens that single file, and then copy that data as you do in your original code. You can add your code to copy the necessary data between the Workbooks.Open and Workbooks.Close lines of code in the example I gave. I can&#39;t offer much more help without seeing the code you already have."}, {"owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 0, "creation_date": 1433521898, "post_id": 30630057, "comment_id": 49405020, "body": "I have updated the original question by adding my code and providing a better picture of what I&#39;m looking to do... I&#39;m not sure how I would create a button to attach a code to search for a file (and then perform a macro on that file) given what is typed into a textbox. Can you help me figure it out? @user1274820"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "reply_to_user": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 0, "creation_date": 1433774417, "post_id": 30630057, "comment_id": 49481656, "body": "Hi again Taylor, the example I provided does this. It opens the workbook, copies some data from it to the &quot;searching&quot; worksheet, and then closes it. The &quot;search&quot; for file is a simple <code>Dir(Path &amp; FileName)</code> command. This will return the name of the file if found or a blank string if not. If it is found, you open it using <code>Workbooks.Open(Path &amp; FileName).</code> Once it is open, you can reference it using <code>ActiveWorkbook</code> and you can access cells by using <code>ActiveWorkbook.Sheets(&quot;SheetNameHere&quot;).Range(&quot;RangeHere&quot;)</code>. I&#39;m not sure what other information you need."}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "reply_to_user": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 1, "creation_date": 1433774553, "post_id": 30630057, "comment_id": 49481774, "body": "If you need to run a macro that is stored in the open workbook, you can use <code>Application.Run</code>. <code>Set wb = Workbooks.Open(File)</code> Then: <code>wb.Application.Run &quot;MacroName&quot;</code>"}, {"owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 0, "creation_date": 1433775190, "post_id": 30630057, "comment_id": 49482294, "body": "Okay great! Would I create a textbox button and then a search button and input that  <code>Application. Run</code> <code>Set wb = Workbooks.Open(File)</code> <code>wb.Application.Run &quot;MacroName&quot;</code> code into...the code for the search button?"}, {"owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 0, "creation_date": 1433776560, "post_id": 30630057, "comment_id": 49483307, "body": "Okay wonderful I will try that out! Is it possible that instead of deciding on a Search Cell, I could insert a textbox (activex control) and make that my &quot;search cell&quot;? @user1274820"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "reply_to_user": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 1, "creation_date": 1433776773, "post_id": 30630057, "comment_id": 49483453, "body": "Yes: <a href=\"http://www.excel-easy.com/vba/examples/text-box.html\" rel=\"nofollow noreferrer\">excel-easy.com/vba/examples/text-box.html</a> <a href=\"http://stackoverflow.com/questions/14628997/activex-text-box-control-text-on-excel-worksheet\" title=\"activex text box control text on excel worksheet\">stackoverflow.com/questions/14628997/&hellip;</a>"}, {"owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 0, "creation_date": 1433777772, "post_id": 30630057, "comment_id": 49484226, "body": "That worked very well, thank you! Okay so this is my code now... it will print out the &quot;File not found!&quot; msgbox but it is not running the macro.. do you know what I am doing wrong? @user1274820  <a href=\"http://pastie.org/10229690\" rel=\"nofollow noreferrer\">pastie.org/10229690</a>"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "reply_to_user": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 0, "creation_date": 1433777957, "post_id": 30630057, "comment_id": 49484365, "body": "Use <code>TextBox1.Text</code> instead of just <code>TextBox1</code>. A few places to change: <code>If TextBox1 = &quot;&quot; Then</code> and <code>If Dir(TDS_PATH &amp; TextBox1) &lt;&gt; &quot;&quot; Then</code> should be <code>If TextBox1.Text = &quot;&quot; Then</code> and <code>If Dir(TDS_PATH &amp; TextBox1.Text) &lt;&gt; &quot;&quot; Then</code>"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "reply_to_user": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 0, "creation_date": 1433778365, "post_id": 30630057, "comment_id": 49484638, "body": "You can make sure you&#39;re getting the value correctly by using MsgBox(TextBox1.Text) - make sure it is correct"}, {"owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 0, "creation_date": 1433779137, "post_id": 30630057, "comment_id": 49485205, "body": "So when I was stepping through my code it goes to the line If Dir(TDS_PATH &amp; TextBox1.Text) &lt;&gt; &quot;&quot; Then and skips right to the else. Clearly that means it thinks the text box is empty when it is not, right? Do you know what I&#39;m doing wrong here?   <a href=\"http://pastie.org/10229718\" rel=\"nofollow noreferrer\">pastie.org/10229718</a> @user1274820"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "reply_to_user": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 0, "creation_date": 1433779389, "post_id": 30630057, "comment_id": 49485377, "body": "Your code looks okay - make sure you have the path correct - it needs to include the Entire Path &amp; the Name of the file. Again, your code looks correct - you need to make sure the extension is also in your input."}, {"owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 0, "creation_date": 1433779614, "post_id": 30630057, "comment_id": 49485521, "body": "This path `C:\\Users\\trembos\\Documents\\TDS\\progress` needs to include the name of the file? What I am trying to do is search through that folder &quot;progress&quot; for the file name that I type into the text box and have it run open the file and run my macro on it (or I can just retype the macro I&#39;d like to execute into that search button code"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "reply_to_user": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 0, "creation_date": 1433786660, "post_id": 30630057, "comment_id": 49489569, "body": "No, just the path should be in that variable. Your text box should ONLY CONTAIN the name of the file you are searching for. I notice in your code you use <code>TextBox1.Text = &quot;Enter File Name Here&quot;</code> and in your screenshot, it looks like you are adding the file name under that line. If your text box has anything else in it, it will get added to the path, so you will be searching for the file <code>C:\\Users\\trembos\\Documents\\TDS\\progress\\Enter File Name HereTDS-12389-j.xls</code> which obviously doesn&#39;t exist. Add the code to <code>MsgBox(TDS_Path &amp; TextBox1.Text)</code> so you can see which file it is looking for."}, {"owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 0, "creation_date": 1433787649, "post_id": 30630057, "comment_id": 49490122, "body": "Yes I have been troubleshooting and found that error. My problem now is trying to alter the working macro I had to tailor it for this specific textbox task. Since it is basically a new question, I have posted it here to keep everything cleaner <a href=\"http://stackoverflow.com/questions/30716302/vba-troubleshooting-code-for-macro-and-textbox\" title=\"vba troubleshooting code for macro and textbox\">stackoverflow.com/questions/30716302/&hellip;</a> @user1274820"}], "tags": [], "owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "is_accepted": true, "score": 2, "last_activity_date": 1433775880, "last_edit_date": 1433775880, "creation_date": 1433363353, "answer_id": 30630057, "question_id": 30628791, "link": "https://stackoverflow.com/questions/30628791/vba-possible-to-create-a-button-that-links-to-code/30630057#30630057", "title": "VBA - Possible to create a button that links to code?", "body": "<p>Here's a simple example:</p>\n\n<pre><code>'The directory containing the files\nConst TDS_PATH = \"C:\\Data\\TDS Search\\\"\n\nSub openFileCopyColumn()\n\n'Clear our list\nSheets(\"Sheet1\").Range(\"B6:D31\").Clear\n\n'Very basic input checking - you can always add more\nIf Sheets(\"Sheet1\").Range(\"C3\") = \"\" Then\n    MsgBox(\"Please enter a file to search for\")\n    Exit Sub\nEnd If\n\n'If the File we are searching for exists in the path\nIf Dir(TDS_PATH &amp; Sheets(\"Sheet1\").Range(\"C3\")) &lt;&gt; \"\" Then\n\n    'Disable screen updating for performance/aesthetics\n    Application.ScreenUpdating = False\n\n    'Open the workbook we searched for (ReadOnly)\n    Workbooks.Open TDS_PATH &amp; Sheets(\"Sheet1\").Range(\"C3\"), ReadOnly:=True\n\n    'Copy the range we are interested in\n    ActiveWorkbook.Sheets(\"Sheet1\").Range(\"A2:C16\").Copy ThisWorkbook.Sheets(\"Sheet1\").Range(\"B6\")\n\n    'Close the file\n    ActiveWorkbook.Close (False)\n\n    'Re-enable screen updating\n    Application.ScreenUpdating = True\n\nElse\n    'Let the user know if the file is not found\n    MsgBox(\"File not found!\")\nEnd If\nEnd Sub\n</code></pre>\n\n<p><strong>Sheet1 of the TDS Search Workbook:</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/8oxFm.png\" alt=\"TDS Search\"></p>\n\n<p><strong>Sheet1 of File Tools1.xlsx:</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/LBqyq.png\" alt=\"Tools\"></p>\n\n<p><strong>Create the button and Assign the Macro:</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/NSKZb.png\" alt=\"Button and Macro\"></p>\n\n<p><strong>Edit:</strong></p>\n\n<p>First, decide what your \"Search Cell\" will be.</p>\n\n<p>I chose <code>Range(\"C3\")</code> on <code>Sheet(\"Sheet1\")</code> arbitrarily in the example above, but yours can be any cell.</p>\n\n<p>Then, search for and open it using the code above (all of which goes in the macro that is assigned to the button - see the screenshots for how to assign a macro to a button).</p>\n\n<p>Instead of using the line:</p>\n\n<pre><code>'Copy the range we are interested in\nActiveWorkbook.Sheets(\"Sheet1\").Range(\"A2:C16\").Copy ThisWorkbook.Sheets(\"Sheet1\").Range(\"B6\")\n</code></pre>\n\n<p>If we want to run a macro that is stored in the newly opened workbook, we can use:</p>\n\n<pre><code>ActiveWorkbook.Application.Run \"MacroName\"\n</code></pre>\n\n<p>There's some more info here:</p>\n\n<p><a href=\"http://www.mrexcel.com/forum/excel-questions/51660-calling-macro-another-workbook.html\" rel=\"nofollow noreferrer\">http://www.mrexcel.com/forum/excel-questions/51660-calling-macro-another-workbook.html</a></p>\n"}], "owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1291, "favorite_count": 0, "accepted_answer_id": 30630057, "answer_count": 1, "score": 0, "last_activity_date": 1433775880, "creation_date": 1433359202, "last_edit_date": 1433521809, "question_id": 30628791, "link": "https://stackoverflow.com/questions/30628791/vba-possible-to-create-a-button-that-links-to-code", "title": "VBA - Possible to create a button that links to code?", "body": "<p>I have written the code for a program that outputs three columns of information as well as printing the file name. I typically run the program with 20 files in the folder so I don't overwhelm things with too much info, given there are over 2000 files.</p>\n\n<p>Is it possible to create a button that will output the same information but just for a single file name entry? I want to be able to type the file name in, hit search, and have it search through a folder of over 2000 files to output those three columns of info for just that particular file.</p>\n\n<p>Something that would look like this:\n<img src=\"https://i.stack.imgur.com/Db0oZ.png\" alt=\"enter image description here\"></p>\n\n<pre><code>Option Explicit\n\nSub LoopThroughDirectory()\n\n    Const ROW_HEADER As Long = 10\n\n    Dim objFSO As Object\n    Dim objFolder As Object\n    Dim objFile As Object\n    Dim MyFolder As String\n    Dim StartSht As Worksheet, ws As Worksheet\n    Dim WB As Workbook\n    Dim i As Integer\n    Dim LastRow As Integer, erow As Integer\n    Dim Height As Integer\n    Dim RowLast As Long\n    Dim f As String\n    Dim dict As Object\n    Dim hc As Range, hc1 As Range, hc2 As Range, hc3 As Range, d As Range\n\n    Set StartSht = Workbooks(\"masterfile.xlsm\").Sheets(\"Sheet1\")\n\n    'turn screen updating off - makes program faster\n    Application.ScreenUpdating = False\n    'Application.UpdateLinks = False\n\n    'location of the folder in which the desired TDS files are\n    MyFolder = \"C:\\Users\\trembos\\Documents\\TDS\\progress\\\"\n\n    'find the headers on the sheet\n    Set hc1 = HeaderCell(StartSht.Range(\"B1\"), \"HOLDER\")\n    Set hc2 = HeaderCell(StartSht.Range(\"C1\"), \"CUTTING TOOL\")\n\n    'create an instance of the FileSystemObject\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n    'get the folder object\n    Set objFolder = objFSO.GetFolder(MyFolder)\n    i = 2\n\n\n\n\n    'loop through directory file and print names\n'(1)\n    For Each objFile In objFolder.Files\n        If LCase(Right(objFile.Name, 3)) = \"xls\" Or LCase(Left(Right(objFile.Name, 4), 3)) = \"xls\" Then\n'(2)\n            'print file name to Column 1\n\n            'Open folder and file name, do not update links\n            Set WB = Workbooks.Open(fileName:=MyFolder &amp; objFile.Name, UpdateLinks:=0)\n            Set ws = WB.ActiveSheet\n\n\n'(3)\n                'find CUTTING TOOL on the source sheet\n                Set hc = HeaderCell(ws.Cells(ROW_HEADER, 1), \"CUTTING TOOL\")\n                If Not hc Is Nothing Then\n\n                    Set dict = GetUniques(hc.Offset(1, 0))\n                    If dict.count &gt; 0 Then\n                        Set d = StartSht.Cells(Rows.count, hc2.Column).End(xlUp).Offset(1, 0)\n                        'add the values to the masterfile, column 3\n                        d.Resize(dict.count, 1).Value = Application.Transpose(dict.keys)\n                    End If\n                Else\n                    'header not found on source worksheet\n                End If\n\n'(4)\n                'find HOLDER on the source sheet\n                Set hc3 = HeaderCell(ws.Cells(ROW_HEADER, 1), \"HOLDER\")\n                If Not hc3 Is Nothing Then\n\n                    Set dict = GetUniques(hc3.Offset(1, 0))\n                    If dict.count &gt; 0 Then\n                        Set d = StartSht.Cells(Rows.count, hc1.Column).End(xlUp).Offset(1, 0)\n                        'add the values to the master list, column 2\n                        d.Resize(dict.count, 1).Value = Application.Transpose(dict.keys)\n                    End If\n                Else\n                    'header not found on source worksheet\n                End If\n\n'(5)\n            With WB\n               'print TDS information\n                For Each ws In .Worksheets\n                        'print the file name to Column 1\n                        StartSht.Cells(i, 1) = objFile.Name\n                        'print TDS name from J1 cell to Column 4\n                        With ws\n                            .Range(\"J1\").Copy StartSht.Cells(i, 4)\n                        End With\n                        i = GetLastRowInSheet(StartSht) + 1\n                'move to next file\n                Next ws\n'(6)\n                'close, do not save any changes to the opened files\n                .Close SaveChanges:=False\n            End With\n        End If\n    'move to next file\n    Next objFile\n    'turn screen updating back on\n    Application.ScreenUpdating = True\n    ActiveWindow.ScrollRow = 1\n'(7)\nEnd Sub\n\n'(8)\n'get all unique column values starting at cell c\nFunction GetUniques(ch As Range) As Object\n    Dim dict As Object, rng As Range, c As Range, v\n    Set dict = CreateObject(\"scripting.dictionary\")\n    For Each c In ch.Parent.Range(ch, ch.Parent.Cells(Rows.count, ch.Column).End(xlUp)).Cells\n        v = Trim(c.Value)\n        If Len(v) &gt; 0 And Not dict.exists(v) Then\n            dict.Add v, \"\"\n        End If\n    Next c\n    Set GetUniques = dict\nEnd Function\n\n'(9)\n'find a header on a row: returns Nothing if not found\nFunction HeaderCell(rng As Range, sHeader As String) As Range\n    Dim rv As Range, c As Range\n    For Each c In rng.Parent.Range(rng, rng.Parent.Cells(rng.Row, Columns.count).End(xlToLeft)).Cells\n        If Trim(c.Value) = sHeader Then\n            Set rv = c\n            Exit For\n        End If\n    Next c\n    Set HeaderCell = rv\nEnd Function\n\n'(10)\nFunction GetLastRowInColumn(theWorksheet As Worksheet, col As String)\n    With theWorksheet\n        GetLastRowInColumn = .Range(col &amp; .Rows.count).End(xlUp).Row\n    End With\nEnd Function\n\n'(11)\nFunction GetLastRowInSheet(theWorksheet As Worksheet)\nDim ret\n    With theWorksheet\n        If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then\n            ret = .Cells.Find(What:=\"*\", _\n                          After:=.Range(\"A1\"), _\n                          Lookat:=xlPart, _\n                          LookIn:=xlFormulas, _\n                          SearchOrder:=xlByRows, _\n                          SearchDirection:=xlPrevious, _\n                          MatchCase:=False).Row\n        Else\n            ret = 1\n        End If\n    End With\n    GetLastRowInSheet = ret\nEnd Function\n</code></pre>\n"}, {"tags": ["sql", "vba", "excel", "ado"], "comments": [{"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1433388426, "post_id": 30628676, "comment_id": 49334109, "body": "Long term you might want to consider moving all of this into a database"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 4821539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff8fad5eddfabda4caab67a04909475f?s=128&d=identicon&r=PG&f=1", "display_name": "CraigM", "link": "https://stackoverflow.com/users/4821539/craigm"}, "edited": false, "score": 0, "creation_date": 1434465755, "post_id": 30634174, "comment_id": 49783225, "body": ".open   Runtime error &#39;3706&#39;: Provider cannot be found.   I am using this code; With objConnection     .Provider = &quot;Provider=Microsoft.ACE.OLEDB.12.0;&quot; &amp; _                                 &quot;Data Source=&quot; &amp; &quot;F:\\Temp04\\2015-06-16-00, BirdFeetPricing.xlsm&quot; &amp; &quot;;&quot; &amp; _                                 &quot;Extended Properties=&quot;&quot;Excel 12.0;HDR=Yes&quot;&quot;;&quot;     .ConnectionString = &quot;Data Source=&quot; &amp; ThisWorkbook.FullName &amp; &quot;;&quot; &amp; &quot;Extended Properties=Excel 12.0;&quot;      .Open End With"}, {"owner": {"reputation": 55, "user_id": 4821539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff8fad5eddfabda4caab67a04909475f?s=128&d=identicon&r=PG&f=1", "display_name": "CraigM", "link": "https://stackoverflow.com/users/4821539/craigm"}, "edited": false, "score": 0, "creation_date": 1434468660, "post_id": 30634174, "comment_id": 49785556, "body": "No 64 bit is not the problem.  I have used the ACE provider in the code previously in the same program.  I am missing something here but I do not know what."}, {"owner": {"reputation": 55, "user_id": 4821539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff8fad5eddfabda4caab67a04909475f?s=128&d=identicon&r=PG&f=1", "display_name": "CraigM", "link": "https://stackoverflow.com/users/4821539/craigm"}, "edited": false, "score": 0, "creation_date": 1434468899, "post_id": 30634174, "comment_id": 49785730, "body": "If I use the code exactly, I get &quot;Could Not FInd Instablle ISAM.&quot;          With MyConnection     .Provider = &quot;Microsoft.Jet.OLEDB.4.0&quot;     .ConnectionString = &quot;Data Source=&quot; &amp; ThisWorkbook.FullName &amp; &quot;;&quot; &amp; _         &quot;Extended Properties=Excel 8.0;&quot;     .Open End With"}, {"owner": {"reputation": 514, "user_id": 4967653, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jLy0eO8CT3E/AAAAAAAAAAI/AAAAAAAAAeQ/r1of1sWAlcw/photo.jpg?sz=128", "display_name": "keong kenshih", "link": "https://stackoverflow.com/users/4967653/keong-kenshih"}, "reply_to_user": {"reputation": 55, "user_id": 4821539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff8fad5eddfabda4caab67a04909475f?s=128&d=identicon&r=PG&f=1", "display_name": "CraigM", "link": "https://stackoverflow.com/users/4821539/craigm"}, "edited": false, "score": 0, "creation_date": 1434596766, "post_id": 30634174, "comment_id": 49849830, "body": "@CraigM did you create the table using <code>Insert</code> &gt; <code>Table</code> ? you can not simply enter table header and rows in the worksheets."}, {"owner": {"reputation": 55, "user_id": 4821539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff8fad5eddfabda4caab67a04909475f?s=128&d=identicon&r=PG&f=1", "display_name": "CraigM", "link": "https://stackoverflow.com/users/4821539/craigm"}, "edited": false, "score": 0, "creation_date": 1434715563, "post_id": 30634174, "comment_id": 49910178, "body": "No I did not use the Insert&gt;table method.  I did get the ACE connector working with the SQL statement: szSQL = &quot;SELECT * FROM [&quot; &amp; SourceSheet$ &amp; &quot;$&quot; &amp; SourceRange$ &amp; &quot;] WHERE price &lt;&gt; NULL ORDER BY &quot; &amp; TargetSortColumn &amp; &quot;;&quot;   I cannot explain why it started working but it is."}], "tags": [], "owner": {"reputation": 514, "user_id": 4967653, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jLy0eO8CT3E/AAAAAAAAAAI/AAAAAAAAAeQ/r1of1sWAlcw/photo.jpg?sz=128", "display_name": "keong kenshih", "link": "https://stackoverflow.com/users/4967653/keong-kenshih"}, "is_accepted": true, "score": 0, "last_activity_date": 1433386514, "creation_date": 1433386514, "answer_id": 30634174, "question_id": 30628676, "link": "https://stackoverflow.com/questions/30628676/using-sql-to-copy-data-from-worksheets-to-other-worksheets-in-the-same-workbook/30634174#30634174", "title": "Using SQL to copy data from worksheets to other worksheets in the same workbook?", "body": "<p>Below is the solution i created: <br>\nI got sheet1, sheet2 as described as below images:<br>\n<img src=\"https://i.stack.imgur.com/nY5DW.png\" alt=\"Sheet1\">\n<img src=\"https://i.stack.imgur.com/iGVjm.png\" alt=\"Sheet2\">\n<br>\nTo copy the by using the sql, the following code is been used: <br>\nNote: You need go to Tools > Reference > check Microsoft ActiveX Data Objects 2.8 Library and Microsoft Forms 2.0 Object Library</p>\n\n<pre><code>Sub SQLCopy()\n\n\nDim MyConnection As ADODB.Connection\nDim MyRecord As ADODB.Recordset\n\nSet MyConnection = New ADODB.Connection\nSet MyRecord = New ADODB.Recordset\n\n' This is the Excel 97-2003 connection string. It should also work with\n' Excel 2007 onwards worksheets as long as they have less than 65536\n' rows\nWith MyConnection\n    .Provider = \"Microsoft.Jet.OLEDB.4.0\"\n    .ConnectionString = \"Data Source=\" &amp; ThisWorkbook.FullName &amp; \";\" &amp; _\n        \"Extended Properties=Excel 8.0;\"\n    .Open\nEnd With\n\nMyRecord.Open \"SELECT [Sheet1$].[SKU],[SecondDATA] FROM [Sheet1$],[Sheet2$] WHERE \" &amp; _\n    \"[Sheet1$].[SKU]  = \" &amp; _\n    \"[Sheet2$].[SKU]\", MyConnection\n\nSheets(\"Sheet3\").Cells(2, 1).CopyFromRecordset MyRecord\n\nMyRecord.Close\nMyConnection.Close\n\nEnd Sub\n</code></pre>\n\n<p><br>\nThe following is the result at sheet 3 <br>\n<img src=\"https://i.stack.imgur.com/HYaUf.png\" alt=\"Sheet3\"></p>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 4821539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff8fad5eddfabda4caab67a04909475f?s=128&d=identicon&r=PG&f=1", "display_name": "CraigM", "link": "https://stackoverflow.com/users/4821539/craigm"}, "edited": false, "score": 0, "creation_date": 1434484266, "post_id": 30718207, "comment_id": 49794816, "body": "I am confused. I am running the exact code first offered by keong kenshih.   I am getting a strange error on the MyRecord statement below.  That error is: &quot;Arguments are of the wrong type, are out of acceptable range, or are in conflict with one another&quot;. I have gone as far as to create Sheet1, Sheet2, and Sheet3,  Sheets 1 &amp; 2 have data on them.  MyRecord.Open &quot;SELECT [Sheet1$].[SKU],[SecondDATA] FROM [Sheet1$],[Sheet2$] WHERE &quot; &amp; _     &quot;[Sheet1$].[SKU]&quot; = &quot;[Sheet2$].[SKU]&quot;, objConnection"}, {"owner": {"reputation": 55, "user_id": 4821539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff8fad5eddfabda4caab67a04909475f?s=128&d=identicon&r=PG&f=1", "display_name": "CraigM", "link": "https://stackoverflow.com/users/4821539/craigm"}, "edited": false, "score": 0, "creation_date": 1434488515, "post_id": 30718207, "comment_id": 49797226, "body": "I have changed my sheets to test your code.  I get an error &quot;No Value Given for one or more required parameters&quot;.  I am lost, I cannot find much documentation on SecondData.                                                            MyRecord.Open &quot;SELECT [Sheet1$].[SKU],[SecondDATA] FROM [Sheet1$],[Sheet2$] WHERE [Sheet1$].[SKU] = [Sheet2$].[SKU]&quot;, MyConnection"}], "tags": [], "owner": {"reputation": 55, "user_id": 4821539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff8fad5eddfabda4caab67a04909475f?s=128&d=identicon&r=PG&f=1", "display_name": "CraigM", "link": "https://stackoverflow.com/users/4821539/craigm"}, "is_accepted": false, "score": 0, "last_activity_date": 1433794295, "creation_date": 1433794295, "answer_id": 30718207, "question_id": 30628676, "link": "https://stackoverflow.com/questions/30628676/using-sql-to-copy-data-from-worksheets-to-other-worksheets-in-the-same-workbook/30718207#30718207", "title": "Using SQL to copy data from worksheets to other worksheets in the same workbook?", "body": "<p>Wonderful solution, keong kenshih!</p>\n\n<p>I was looking thru the Microsoft documendation and as I read it, it indicates that you cannot use SQL on open workbooks.</p>\n\n<p>Thanks for the proof of concept code.  I am going to incorporate it into my project in the next couple of days.  Should provide a big performance improvement.</p>\n\n<p>I will change from using the .jet provider to the .ace provider to be compatible with newer versions of Excel.</p>\n\n<p>Nick.McDermaid: I cannot move all the data into a database as the data is frequently updated in Excel.  I'm lucky the client even has Excel they are so backwards.  They have no concept of a database.  They are stuck in the 1970's with Yahoo.</p>\n\n<p>Thanks again for everyone's comments!</p>\n"}], "owner": {"reputation": 55, "user_id": 4821539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff8fad5eddfabda4caab67a04909475f?s=128&d=identicon&r=PG&f=1", "display_name": "CraigM", "link": "https://stackoverflow.com/users/4821539/craigm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3081, "favorite_count": 0, "accepted_answer_id": 30634174, "answer_count": 2, "score": 0, "last_activity_date": 1433794295, "creation_date": 1433358804, "last_edit_date": 1531164843, "question_id": 30628676, "link": "https://stackoverflow.com/questions/30628676/using-sql-to-copy-data-from-worksheets-to-other-worksheets-in-the-same-workbook", "title": "Using SQL to copy data from worksheets to other worksheets in the same workbook?", "body": "<p>I would like to use SQL to move data around from sheet to sheet within the same workbook.</p>\n\n<p>My sheets are large (width &amp; depth) and coping with VBA is slow.</p>\n\n<p>The scenario is that I have sheets 1 to 5.<br>\nI want to create sheet(6) with a column or two from sheets 1 -5.<br>\nThe index key is SKU and is common to all sheets. \nAll sheets are sorted by SKU to begin with.</p>\n\n<p>When I grab a column in Sheet(1) I can just put it in Sheet(6), Column A.\nWhen I grab a column in sheet(2) I need to be sure that each row's SKU matches and that the data from sheet(2) and is correctly placed in the next column for that SKU.  If data for that SKU is not available the corresponding cell is left EMPTY.  The data from each column is kept together in one selected column in the target worksheet.</p>\n\n<p>I am not certain how to set up the connection or recordset selections since we are working within the same workbook.  I cannot find this topic discussed anywhere.  Ensuring the SKU receives the correct data from all sheets seems a little daunting to me.</p>\n\n<p>I seem to remember something about not being able to establish ADO connections to open workbooks/sheets.  If that is the case I will create a separate workbook to extract the data to and manipulate there.</p>\n\n<p>I would really appreciate any guidance on this subject.  This is all new ground for me.</p>\n\n<p>Thanks, CraigM</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "answers": [{"tags": [], "owner": {"reputation": 534, "user_id": 2124401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d17789145d2f0d96018486259448ac7?s=128&d=identicon&r=PG", "display_name": "jlemley", "link": "https://stackoverflow.com/users/2124401/jlemley"}, "is_accepted": false, "score": 0, "last_activity_date": 1433365502, "creation_date": 1433365502, "answer_id": 30630702, "question_id": 30628660, "link": "https://stackoverflow.com/questions/30628660/data-transformation-and-transpose-in-excel/30630702#30630702", "title": "Data transformation and Transpose in Excel", "body": "<p>For varying amounts of data, a PivotTable works well. It will not give you exactly the format you are looking for, but changing the order is as simple as moving the fields around in the Values box. An added advantage is that it also provides totals for you automatically (if you want that).</p>\n\n<p>Of course, you could also build out a separate table that does a \"GETPIVOTDATA\" function to pull in and format the information how you like. The pivot just does the heavy lifting of aggregating the data for you, but it's not very flexible with how that data is displayed.</p>\n\n<p><strong>PivotTable Example:</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/PgUaj.jpg\" alt=\"PivotTable Example\"></p>\n\n<p><strong>PivotTable Fields:</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/UsSZn.jpg\" alt=\"PivotTable Fields\"></p>\n"}], "owner": {"reputation": 161, "user_id": 1854825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfaf069ec925a0fa1bd9648507e72ff8?s=128&d=identicon&r=PG", "display_name": "Prafulla Patil", "link": "https://stackoverflow.com/users/1854825/prafulla-patil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433456248, "creation_date": 1433358739, "last_edit_date": 1433456248, "question_id": 30628660, "link": "https://stackoverflow.com/questions/30628660/data-transformation-and-transpose-in-excel", "title": "Data transformation and Transpose in Excel", "body": "<p>looking for help on converting data from one format to another - </p>\n\n<p>If you want to see data in sheet is here - \n<a href=\"https://docs.google.com/spreadsheets/d/1yO90XjjN2c80ReYMIXTdS7e8SLb2NNMRNqiXbqR8J2k/edit?pli=1#gid=555602833\" rel=\"nofollow noreferrer\">https://docs.google.com/spreadsheets/d/1yO90XjjN2c80ReYMIXTdS7e8SLb2NNMRNqiXbqR8J2k/edit?pli=1#gid=555602833</a></p>\n\n<p>Note: I want to do this in MS Excel and not in google sheet.</p>\n\n<p><img src=\"https://i.stack.imgur.com/YMSSn.png\" alt=\"enter image description here\"></p>\n\n<p>Description - \n1. Transpose primary data set and organize data so that options are shown as columns.\n2. If there are multiple rows for same product and same option, need to sum it up and add as one row.\n3. If products are not available for certain option then we need to update that cell as 'NA'\n4. 'Primary set of data' may contain multiple rows, but it will have only 3 options at given point of time.\n5. Above 3 scenrios are just for explanation of this problem, I want to develop one table which is dynamic\n and changes are reflected as I make updates to data    </p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1433359125, "post_id": 30628600, "comment_id": 49323449, "body": "By the sounds of it you are just changing records based on the selected Combobox option.  When you open a form however it is automatically going to be viewing the first record.  Not entirely sure if that can be changed easily, but perhaps instead of fighting it you just make it so that the combobox reflects the proper name of the observation?"}], "answers": [{"tags": [], "owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "is_accepted": false, "score": 0, "last_activity_date": 1433359326, "creation_date": 1433359326, "answer_id": 30628830, "question_id": 30628600, "link": "https://stackoverflow.com/questions/30628600/controlling-form-with-combobox/30628830#30628830", "title": "Controlling form with Combobox", "body": "<p>As I had mentioned in my comment I think what you are trying to do could be fairly annoying to implement.  However if you just add something like this:</p>\n\n \n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Form_Load()\n    Me.Combobox1.Value = Nz(Me.ObservationName,\"\")\nEnd Sub\n</code></pre>\n\n<p>It would just make the Comboboxreflect the proper name of the observation that you are viewing. <code>ObservationName</code> is just what I assume is the field name that you use in the Combobox, and <code>Combobox1</code> would be replaced with the name of your Combobox. </p>\n"}, {"tags": [], "owner": {"reputation": 113, "user_id": 4953277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9de4fe92a4033e9721c64449533ec2e7?s=128&d=identicon&r=PG&f=1", "display_name": "Y2Que", "link": "https://stackoverflow.com/users/4953277/y2que"}, "is_accepted": false, "score": 1, "last_activity_date": 1433359657, "last_edit_date": 1433359657, "creation_date": 1433359341, "answer_id": 30628838, "question_id": 30628600, "link": "https://stackoverflow.com/questions/30628600/controlling-form-with-combobox/30628838#30628838", "title": "Controlling form with Combobox", "body": "<p>You could leave the subform <a href=\"https://msdn.microsoft.com/en-us/library/office/ff821093.aspx\" rel=\"nofollow\">Record Source</a> blank and in the combo box <code>AfterUpdate()</code> event, change the subform <a href=\"https://msdn.microsoft.com/en-us/library/office/ff821093.aspx\" rel=\"nofollow\">Record Source</a> and <a href=\"https://msdn.microsoft.com/en-us/library/office/ff191903.aspx\" rel=\"nofollow\">Requery</a> the subform.</p>\n\n<p>This can be a bit sloppy since form requeries are notorious for their unreliability. What I've done in the past is make the subform a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff845183.aspx\" rel=\"nofollow\">PopUp</a> and in <code>AfterUpdate()</code> of the combo box or on a button click, modify the Record Source and open the desired subform.</p>\n"}], "owner": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1433359657, "creation_date": 1433358548, "question_id": 30628600, "link": "https://stackoverflow.com/questions/30628600/controlling-form-with-combobox", "title": "Controlling form with Combobox", "body": "<p>I have a form with a combo box in the form header that populates the values in the form. I can select different values in the combo box that refer to observations in my table, and the form will filter so that I have all the data from the table for the observation I select in the combo box in the form. </p>\n\n<p>It works fine, however when I open the form, the form is populated with the first row in the table, even though the combobox is blank. How do I set up the form so that when the combobox in the header is blank then the form is blank, and the form only populates when I populate the combobox?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "edited": false, "score": 0, "creation_date": 1433358706, "post_id": 30628580, "comment_id": 49323209, "body": "I see what you are trying to do, and I see your code, but I don&#39;t see a specific problem or where you are getting stuck.  Please update with a specific question"}, {"owner": {"reputation": 491, "user_id": 4925420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a46e2bd849822edc3501d1f41079f607?s=128&d=identicon&r=PG&f=1", "display_name": "atame", "link": "https://stackoverflow.com/users/4925420/atame"}, "reply_to_user": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "edited": false, "score": 0, "creation_date": 1433359257, "post_id": 30628580, "comment_id": 49323512, "body": "@gtwebb hi hopefully that makes a bit more sense."}, {"owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "edited": false, "score": 0, "creation_date": 1433364876, "post_id": 30628580, "comment_id": 49326649, "body": "So your question is, everything works well but I don&#39;t know how to order it?  I would tie each one to a button if they all need to be run.  In you command click just run 3 normal macros (adjust values, copy cells, save worksheet) which you have already written."}, {"owner": {"reputation": 491, "user_id": 4925420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a46e2bd849822edc3501d1f41079f607?s=128&d=identicon&r=PG&f=1", "display_name": "atame", "link": "https://stackoverflow.com/users/4925420/atame"}, "reply_to_user": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "edited": false, "score": 0, "creation_date": 1433366875, "post_id": 30628580, "comment_id": 49327710, "body": "@gtwebb hi yes just not sure the best way to order it. Is there a better way to code it? Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 514, "user_id": 4967653, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jLy0eO8CT3E/AAAAAAAAAAI/AAAAAAAAAeQ/r1of1sWAlcw/photo.jpg?sz=128", "display_name": "keong kenshih", "link": "https://stackoverflow.com/users/4967653/keong-kenshih"}, "is_accepted": false, "score": 0, "last_activity_date": 1433388423, "creation_date": 1433388423, "answer_id": 30634436, "question_id": 30628580, "link": "https://stackoverflow.com/questions/30628580/excel-vbs-do-muliple-this-1-after-the-other-on-same-sheet/30634436#30634436", "title": "Excel VBS do Muliple this 1 after the other on same sheet", "body": "<p>I was thinking that are you asking a more professional and efficient way to code the code? If that was the case, perhaps I got few advises for you:</p>\n\n<ol>\n<li>Use <code>Option Explicit</code> in your code . This to make sure you declare the object before using it.</li>\n<li>Add <code>Application.ScreenUpdating =False</code> to enhance your macro performance.</li>\n<li>The copy macro you substitute it by writing the formula in the cell if you are going to copy the value into the same cells. E.g. you can code the cell(N42) with the formula <code>=N40</code> to copy the value automatically whe the cell(N40) updated. Indirectly, you will reduce the declaration of variables in your code. Therefore the performance will be increased.</li>\n<li><p>Normally, I will set the \"pattern\" : workbook.worksheet to a variable. E.g. </p>\n\n<pre><code>Dim MyWorkbook As Workbook\nDim MyWorksheet As Worksheet\nSet MyWorkbook = Workbooks(\"Book1.xlsm\")\nSet MyWorksheet = WorkbookTemplate.Sheets(\"WorksheetName\")\n</code></pre>\n\n<p>than only use them in performing the transaction/tasks</p></li>\n<li><p>Lastly, please use the meaningful variables to ease your future enhancement. If you are interesting to know more, you can read a book call \"Clean Code\"</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 491, "user_id": 4925420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a46e2bd849822edc3501d1f41079f607?s=128&d=identicon&r=PG&f=1", "display_name": "atame", "link": "https://stackoverflow.com/users/4925420/atame"}, "is_accepted": false, "score": 0, "last_activity_date": 1433406288, "creation_date": 1433406288, "answer_id": 30638671, "question_id": 30628580, "link": "https://stackoverflow.com/questions/30628580/excel-vbs-do-muliple-this-1-after-the-other-on-same-sheet/30638671#30638671", "title": "Excel VBS do Muliple this 1 after the other on same sheet", "body": "<p>this is what i have come up with, hopefully i have done everything correct.</p>\n\n<p>If you see a mistake or a better way of coding, then please let me know, i am always learning.</p>\n\n<pre><code>Private Sub CommandButton3_Click()\nDim aws As Worksheet\nDim MyPath As String, MyRange As Range, MyDate As Range\nDim rDate As Range, rDate2 As Range\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n        .CutCopyMode = False\n    End With\n\nSet aws = ActiveWorkbook.Sheets(\"SUB CON PAYMENT FORM\")\nSet MyRange = Sheets(\"SUB CON PAYMENT FORM\").Range(\"L3\")                    'Payment No\nSet MyDate = Sheets(\"SUB CON PAYMENT FORM\").Range(\"L7\")                     'Date \"MMMM YYYY\"\nSet rDate = ActiveSheet.Range(\"C7\")\nSet rDate2 = ActiveSheet.Range(\"L7\")\n\nMyPath = ActiveWorkbook.Path\n\nActiveWorkbook.Sheets(\"Details\").Rows(2 &amp; \":\" &amp; Sheets(\"Details\").Rows.Count).ClearContents 'This clears all data below the header in Details\nActiveWorkbook.Sheets(\"Global\").Rows(1 &amp; \":\" &amp; Sheets(\"Global\").Rows.Count).ClearContents   'This clears all data below in Global\n\nWith ActiveSheet\n    Range(\"L3\").Value = Range(\"L3\").Value + 1                               'Increases Payment No# by 1\n        rDate.Value = DateSerial(Year(rDate), Month(rDate) + 1, Day(29))    'Increases Date by 1 Month\n        rDate2.Value = DateSerial(Year(rDate), Month(rDate) + 1, 0)         'Increases Date by 1 Month\n            With aws\n            .Range(\"N40\").Copy                                              'Copies total to date Value\n            .Range(\"N42\").PasteSpecial xlValues                             'Pastes total to date Value to Total Last Payment\n                With aws\n                .Range(\"G49\").Copy                                          'Copies Total VAT to Date\n                .Range(\"G50\").PasteSpecial xlValues                         'Pastes Total VAT to Date into Last Payment\n                .Range(\"G36\").Copy                                          'Copies This Months Labour\n                .Range(\"G37\").PasteSpecial xlValues                         'Pastes This Months Laboue into Last Payment\n                End With\n                With aws\n                .Range(\"N12:N27\").Copy                                      'Copies CC Code Gross Value\n                .Range(\"J12:J27\").PasteSpecial xlValues                     'Pastes CC Code Gross Value into Previous\n                End With\n            End With\n    Range(\"A1\").Activate                                                    'Selects Cell A1\nEnd With\n\nThisWorkbook.SaveAs Filename:=MyPath &amp; \"\\\" &amp; \"Payment\" &amp; \" \" &amp; MyRange.Value &amp; \" \" &amp; MyDate.Text &amp; \".xlsm\" 'This saves a new document in our naming convention\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 491, "user_id": 4925420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a46e2bd849822edc3501d1f41079f607?s=128&d=identicon&r=PG&f=1", "display_name": "atame", "link": "https://stackoverflow.com/users/4925420/atame"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1433406288, "creation_date": 1433358486, "last_edit_date": 1433364252, "question_id": 30628580, "link": "https://stackoverflow.com/questions/30628580/excel-vbs-do-muliple-this-1-after-the-other-on-same-sheet", "title": "Excel VBS do Muliple this 1 after the other on same sheet", "body": "<p>I have a work book, that i need to create a button click for, that will get run evey month. I need it to do multiple procedures on the same sheet in a set order.</p>\n\n<p>So far below this is the code i have that does all the function. i need some help in ordereing it in the correct way so that it runs following the list, and maybe tidying if up and little if you know of a beeter way to code it.</p>\n\n<ol>\n<li>increase cell L3 value by 1</li>\n<li>add 1 month to the dates in cells C7 &amp; L7</li>\n<li>copy cell N40 and paste value into N42</li>\n<li>copy cell G36 and paste value into G37</li>\n<li>copy cell G49 and paste value into G50</li>\n<li>copy range N12:N27 and paste values into J12:J27</li>\n<li>saveas \"Payment <code>L3</code> <code>L7</code>.xlsm\"</li>\n</ol>\n\n<p>Here is the code I have so far.</p>\n\n<pre><code>    Private Sub CommandButton3_Click()\n         Dim mPay As Range\n         Dim mTarget As Range\n         Dim cisCurrent As Range\n         Dim cisTarget As Range\n         Dim taxCurrent As Range\n         Dim taxTarget As Range\n         Dim ttdCurrent As Range\n         Dim ttdTarget As Range\n         Dim TTD As String\n    'Define the ranges\n         Set ttdCurrent = ws.Range(\"N40\")\n          Set ttdTarget = ws.Range(\"N42\")\n         Set mPay = ws.Range(\"N12:N27\")\n          Set mTarget = ws.Range(\"J12:J27\")\n         Set cisCurrent = ws.Range(\"G36\")\n          Set cisTarget = ws.Range(\"G37\")\n         Set taxCurrent = ws.Range(\"G49\")\n          Set taxTarget = ws.Range(\"G50\")\n    'copy and paste special-add\n         ttdCurrent.Copy\n          ttdTarget.PasteSpecial xlValues\n         ttdCurrent.Copy\n          ttdTarget.PasteSpecial xlValues\n         mPay.Copy\n          mTarget.PasteSpecial xlValues\n         cisCurrent.Copy\n          cisTarget.PasteSpecial xlValues\n         taxCurrent.Copy\n          taxTarget.PasteSpecial xlValues\nEnd Sub\n</code></pre>\n\n<p>I have managed to come up with some code that cowrk sof rchanging the date, increaseing L3 by 1 and saving the document.</p>\n\n<p>Increase L3, and add 1 Month to Dates:</p>\n\n<pre><code>Private Sub CommandButton4_Click()\nDim rDate As Range\nDim rDate2 As Range\n\nSet rDate = ActiveSheet.Range(\"C7\")\nSet rDate2 = ActiveSheet.Range(\"L7\")\n\nWith ActiveSheet\n    Range(\"L3\").Value = Range(\"L3\").Value + 1\n    rDate.Value = DateAdd(\"m\", 1, rDate.Value)\n        rDate.Value = DateSerial(Year(rDate), Month(rDate) + 1, 0)\n    rDate2.Value = DateAdd(\"m\", 1, rDate2.Value)\n        rDate2.Value = DateSerial(Year(rDate), Month(rDate) + 1, 0)\n\nEnd With\nEnd Sub\n</code></pre>\n\n<p>This is the code for Saving AS:</p>\n\n<pre><code>Private Sub CommandButton6_Click()\nDim MyPath As String, MyRange As Range, MyDate As Range\n\nMyPath = ActiveWorkbook.Path\nSet MyDate = Sheets(\"SUB CON PAYMENT FORM\").Range(\"L7\")\nSet MyRange = Sheets(\"SUB CON PAYMENT FORM\").Range(\"L3\") 'with the name of a cell\nThisWorkbook.SaveAs Filename:=MyPath &amp; \"\\\" &amp; \"Payment\" &amp; \" \" &amp; MyRange.Value &amp; \" \" &amp; MyDate.Text &amp; \".xlsm\"\nEnd Sub\n</code></pre>\n\n<p>Any help you can provide will be greatly appreciated!!!!</p>\n"}, {"tags": ["xml", "vba", "ms-access"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1433359027, "post_id": 30628441, "comment_id": 49323387, "body": "See  <a href=\"http://en.wikipedia.org/wiki/XML_namespace\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/XML_namespace</a>  ... &quot;the namespace specification does not require nor suggest that the namespace URI be used to retrieve information; it is simply treated by an XML parser as a string.&quot;"}, {"owner": {"reputation": 11, "user_id": 4971029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ebda15f25641f51e9dfc43c661337d7?s=128&d=identicon&r=PG&f=1", "display_name": "Evan Patrick Theriault", "link": "https://stackoverflow.com/users/4971029/evan-patrick-theriault"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1433359658, "post_id": 30628441, "comment_id": 49323726, "body": "Ah I see. I understood it to mean that the XML was picking up all of the background XML code from the link, and then my code modified part of this code to remove the options button. This code still isn&#39;t working however, any idea what needs to be changed to make it work?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1433359751, "post_id": 30628441, "comment_id": 49323781, "body": "Sorry - not familiar with RibbonXML"}, {"owner": {"reputation": 11, "user_id": 4971029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ebda15f25641f51e9dfc43c661337d7?s=128&d=identicon&r=PG&f=1", "display_name": "Evan Patrick Theriault", "link": "https://stackoverflow.com/users/4971029/evan-patrick-theriault"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1433361784, "post_id": 30628441, "comment_id": 49324930, "body": "This is now resolved. I found the error in the XML after pouring through some of the background XML code reference files. Note that Access XML seems to be very picky about capital letters and syntax. The correct code is: &lt;customUI xmlns=&quot;<a href=\"http://schemas.microsoft.com/office/2009/07/customui\" rel=\"nofollow noreferrer\">schemas.microsoft.com/office/2009/07/customui</a>&quot;&gt;           &lt;ribbon startFromScratch=&quot;true&quot; /&gt;           &lt;backstage&gt;                &lt;button idMso=&quot;ApplicationOptionsDialog&quot; visible=&quot;false&quot;/&gt;           &lt;/backstage&gt; &lt;/customUI&gt;"}], "owner": {"reputation": 11, "user_id": 4971029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ebda15f25641f51e9dfc43c661337d7?s=128&d=identicon&r=PG&f=1", "display_name": "Evan Patrick Theriault", "link": "https://stackoverflow.com/users/4971029/evan-patrick-theriault"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1433357943, "creation_date": 1433357943, "question_id": 30628441, "link": "https://stackoverflow.com/questions/30628441/office-xml-link-no-longer-working", "title": "Office XML link no longer working", "body": "<p>I'm trying to use the relatively simple XML code in an Access database to disable the options button in the file menu. However, when I try to visit the website the xml references, the website shows up as not currently available. Anyone know a new reference website or a way around this? Code I'm using as a reference in the system table USysRibbons: </p>\n\n<pre><code>&lt;customUI xmlns=\"http://schemas.microsoft.com/office/2009/07/customui\"&gt;\n     &lt;ribbon startFromScratch=\"true\" /&gt;\n&lt;/customUI&gt;\n\n&lt;customUI xmlns=\"http://schemas.microsoft.com/office/2009/07/customui\"&gt;\n     &lt;ribbon startFromScratch=\"false\"&gt;&lt;/ribbon&gt;\n          &lt;backstage&gt;\n               &lt;button idMSO=\"ApplicationOptionsDialog\" visible=\"false\"/&gt;\n          &lt;/backstage&gt;\n&lt;/customUI&gt;\n</code></pre>\n"}, {"tags": ["xml", "excel", "vba", "xpath"], "answers": [{"tags": [], "owner": {"reputation": 137664, "user_id": 252228, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3ea75023c3c487f36257090d420b7c50?s=128&d=identicon&r=PG", "display_name": "Martin Honnen", "link": "https://stackoverflow.com/users/252228/martin-honnen"}, "is_accepted": false, "score": 0, "last_activity_date": 1433361391, "creation_date": 1433361391, "answer_id": 30629460, "question_id": 30628098, "link": "https://stackoverflow.com/questions/30628098/extract-last-item-in-node-list-using-xpath-last-function/30629460#30629460", "title": "Extract last item in node list using xpath last() function", "body": "<p>It sounds as if you are using an old version of MSXML where the default selection language is not XPath 1.0. So set</p>\n\n<pre><code>dom.setProperty \"SelectionLanguage\", \"XPath\"\n</code></pre>\n\n<p>to make sure you enable XPath before doing any <code>selectNodes</code> or <code>selectSingleNode</code> calls.</p>\n"}], "owner": {"reputation": 1, "user_id": 4969008, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-QTxedgEKeSE/AAAAAAAAAAI/AAAAAAAACyY/39jHraVW9mg/photo.jpg?sz=128", "display_name": "Gary", "link": "https://stackoverflow.com/users/4969008/gary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 731, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433361391, "creation_date": 1433356832, "question_id": 30628098, "link": "https://stackoverflow.com/questions/30628098/extract-last-item-in-node-list-using-xpath-last-function", "title": "Extract last item in node list using xpath last() function", "body": "<p>Using VBA in Excel 2007, MS XML reference (v6.0) and xpath I'm trying to extract a node list consisting of the last node in a set. The XML looks like this:</p>\n\n<pre><code>&lt;Routes&gt;\n  &lt;Route id=\"RT1\"&gt;\n    &lt;PrivateCode&gt;PBAO902:3&lt;/PrivateCode&gt;\n    &lt;Description&gt;City Centre, Corporation St - Hill Hook, Bishops Way&lt;/Description&gt;\n    &lt;RouteSectionRef&gt;RS1&lt;/RouteSectionRef&gt;\n    &lt;RouteSectionRef&gt;RS2&lt;/RouteSectionRef&gt;\n    &lt;RouteSectionRef&gt;RS3&lt;/RouteSectionRef&gt;\n    &lt;RouteSectionRef&gt;RS4&lt;/RouteSectionRef&gt;\n    &lt;RouteSectionRef&gt;RS5&lt;/RouteSectionRef&gt;\n  &lt;/Route&gt;\n  &lt;Route id=\"RT2\"&gt;\n    &lt;PrivateCode&gt;PBAO904:3&lt;/PrivateCode&gt;\n    &lt;Description&gt;City Centre, Corporation St - Falcon Lodge, Churchill Parade&lt;/Description&gt;\n    &lt;RouteSectionRef&gt;RS1&lt;/RouteSectionRef&gt;\n    &lt;RouteSectionRef&gt;RS2&lt;/RouteSectionRef&gt;\n    &lt;RouteSectionRef&gt;RS6&lt;/RouteSectionRef&gt;\n    &lt;RouteSectionRef&gt;RS7&lt;/RouteSectionRef&gt;\n  &lt;/Route&gt;\n  &lt;Route id=\"RT3\"&gt;\n    &lt;PrivateCode&gt;PBAO905:3&lt;/PrivateCode&gt;\n    &lt;Description&gt;City Centre, Corporation St - Roughley, Slade Road&lt;/Description&gt;\n    &lt;RouteSectionRef&gt;RS1&lt;/RouteSectionRef&gt;\n    &lt;RouteSectionRef&gt;RS2&lt;/RouteSectionRef&gt;\n    &lt;RouteSectionRef&gt;RS3&lt;/RouteSectionRef&gt;\n    &lt;RouteSectionRef&gt;RS4&lt;/RouteSectionRef&gt;\n    &lt;RouteSectionRef&gt;RS8&lt;/RouteSectionRef&gt;\n  &lt;/Route&gt;\n&lt;Routes&gt;\n</code></pre>\n\n<p>I want to extract, as a node list, the first RouteSectionRef in each Route (RS1, RS1, RS1) and, as a separate node list the last RouteSectionRef in each Route (RS5, RS7, RS8). I can extract the first using the following:</p>\n\n<pre><code>strPath = \"//Routes/Route/RouteSectionRef[0]\"\nSet dNL = dom.DocumentElement.SelectNodes(strPath)\nn = 0\nFor Each dN In dNL\n    n = n + 1\n    arrRouteDescriptions(n, 2) = dN.Text\nNext dN\n</code></pre>\n\n<p>I am using the following to extract the last:</p>\n\n<pre><code>strPath = \"//Routes/Route/RouteSectionRef[last()]\"\nSet dNL = dom.DocumentElement.SelectNodes(strPath)\nn = 0\nFor Each dN In dNL\n    n = n + 1\n    arrRouteDescriptions(n, 3) = dN.Text\nNext dN\n</code></pre>\n\n<p>but receive the following Run-time error:</p>\n\n<p>Unknown method\n//Routes/Route/RouteSectionRef[-->last()&lt;--]</p>\n\n<p>Could anyone point me in the right direction?</p>\n"}, {"tags": ["arrays", "vba", "vb6", "variant"], "comments": [{"owner": {"reputation": 9812, "user_id": 1345535, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/b62063f3b5bf78c24c71085aca077e2e?s=128&d=identicon&r=PG", "display_name": "David W", "link": "https://stackoverflow.com/users/1345535/david-w"}, "edited": false, "score": 0, "creation_date": 1433355380, "post_id": 30627636, "comment_id": 49321215, "body": "Your iteration variable i is never assigned nor incremented in that loop...was that just omitted?"}, {"owner": {"reputation": 301, "user_id": 557425, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/c84dc7bfdf482642142e9b804b66916a?s=128&d=identicon&r=PG", "display_name": "redned", "link": "https://stackoverflow.com/users/557425/redned"}, "reply_to_user": {"reputation": 9812, "user_id": 1345535, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/b62063f3b5bf78c24c71085aca077e2e?s=128&d=identicon&r=PG", "display_name": "David W", "link": "https://stackoverflow.com/users/1345535/david-w"}, "edited": false, "score": 1, "creation_date": 1433355754, "post_id": 30627636, "comment_id": 49321441, "body": "Apologies, I hand typed out the code as I am working on an isolated server. It is in code I am working on. I will edit question."}, {"owner": {"reputation": 9812, "user_id": 1345535, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/b62063f3b5bf78c24c71085aca077e2e?s=128&d=identicon&r=PG", "display_name": "David W", "link": "https://stackoverflow.com/users/1345535/david-w"}, "edited": false, "score": 0, "creation_date": 1433355791, "post_id": 30627636, "comment_id": 49321467, "body": "Continuing to review this, I don&#39;t see how the <code>until</code> loop code either <i>ever</i> executes or ever <i>stops</i> executing as posted given that loop variable i never changes. Wondering if something is omitted? Appreciate if you could review/verify the posted code..Thx!! :)"}, {"owner": {"reputation": 9812, "user_id": 1345535, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/b62063f3b5bf78c24c71085aca077e2e?s=128&d=identicon&r=PG", "display_name": "David W", "link": "https://stackoverflow.com/users/1345535/david-w"}, "edited": false, "score": 0, "creation_date": 1433355983, "post_id": 30627636, "comment_id": 49321573, "body": "Hmmm...I&#39;d probably at least try moving the declaration of &#39;i&#39; outside the loop, and explicitly setting it to 0."}], "answers": [{"tags": [], "owner": {"reputation": 9812, "user_id": 1345535, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/b62063f3b5bf78c24c71085aca077e2e?s=128&d=identicon&r=PG", "display_name": "David W", "link": "https://stackoverflow.com/users/1345535/david-w"}, "is_accepted": true, "score": 4, "last_activity_date": 1433356564, "last_edit_date": 1433356564, "creation_date": 1433356251, "answer_id": 30627934, "question_id": 30627636, "link": "https://stackoverflow.com/questions/30627636/compare-items-in-an-array-to-items-in-a-variant-in-vb6/30627934#30627934", "title": "Compare items in an Array to items in a Variant in VB6", "body": "<p>This really isn't a <code>Variant</code> problem, it's just a looping/control variable issue. </p>\n\n<p>Even though you have your DIM statement inside your main loop, VB does not treat that as a \"redeclaration\" and reset/reinitialize its value before your UNTIL loop. As a result, 'i' will increment to 1 and then retain its value between iterations of your outer loop, thus remaining stuck on the single value in batchArray and the iteration ceases.</p>\n\n<p>Move the declaration outside the loop, reset it to 0 before the <code>UNTIL</code> loop, and see if that solves your problem:</p>\n\n<pre><code>Dim i as Long\n\nFor x = 0 To UBound(fArray)\n    Dim m As Integer\n    i = 0\n    Do Until batcharray(0, i) = \"End\"\n        If (InStr(1, UCase(batcharray(1, i)), UCase(fArray(x))) &gt; 0) Then\n            LstAPens.ListItems.Add\n                With LstAPens.ListItems(m + 1)\n                 .SubItems(1) = batcharray(1, i) 'Tagname\n                End With\n                m = m + 1\n        End If\n        i=i+1\n    Loop\nNext x\n</code></pre>\n"}], "owner": {"reputation": 301, "user_id": 557425, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/c84dc7bfdf482642142e9b804b66916a?s=128&d=identicon&r=PG", "display_name": "redned", "link": "https://stackoverflow.com/users/557425/redned"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "accepted_answer_id": 30627934, "answer_count": 1, "score": 0, "last_activity_date": 1433356564, "creation_date": 1433355167, "last_edit_date": 1433355831, "question_id": 30627636, "link": "https://stackoverflow.com/questions/30627636/compare-items-in-an-array-to-items-in-a-variant-in-vb6", "title": "Compare items in an Array to items in a Variant in VB6", "body": "<p>I have a Variant in VB6 with thousands of Strings.</p>\n\n<p>I also have an array of fixed length.</p>\n\n<p>I need to compare the contents of each and add the ones that match to a list.</p>\n\n<pre><code>if array(i) = variant(1,i) then\n'add to list\nEnd if\n</code></pre>\n\n<p>I cannot figure out how to iterate over both properly in order to compare, as the method I use to iterate over the Variant() stops after going through each item. So it never checks to see if it any item is equal to i+1 in the array.</p>\n\n<pre><code>Private Sub dp_Click()\n    Dim fArray\n    fArray = Array(\"a\", \"b\", \"c\")\n\n    LstAPens.ListItems.Clear\n    LstUPens.ListItems.Clear\n\n    For x = 0 To UBound(fArray)\n        Dim i As Long,  m As Integer\n\n        'Do Until batcharray(0, i) = \"End\"\n        '   tmpArray(i) = UCase(batcharray(1, i))\n        'Loop\n\n        Do Until batcharray(0, i) = \"End\"\n            If (InStr(1, UCase(batcharray(1, i)), UCase(fArray(x))) &gt; 0) Then\n                LstAPens.ListItems.Add\n                    With LstAPens.ListItems(m + 1)\n                     .SubItems(1) = batcharray(1, i) 'Tagname\n                    End With\n                    m = m + 1\n            End If\n            i=i+1\n        Loop\n    Next x\nEnd Sub\n</code></pre>\n\n<p>I tried to convert the Variant to an array but it did not work.</p>\n\n<p>The only item that is found is the first one in the array, then the Variant is no longer iterated over as it reached the end.</p>\n\n<p>How can I iterate over the Variant called batchArray in this example, and compare it to the contents of an array? </p>\n"}, {"tags": ["excel", "vba", "macos"], "answers": [{"tags": [], "owner": {"reputation": 1396, "user_id": 1337635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pVMWU.png?s=128&g=1", "display_name": "joehanna", "link": "https://stackoverflow.com/users/1337635/joehanna"}, "is_accepted": false, "score": 0, "last_activity_date": 1435364930, "creation_date": 1435364930, "answer_id": 31083930, "question_id": 30627502, "link": "https://stackoverflow.com/questions/30627502/how-to-eliminate-modified-letters-and-dates-using-mac-and-windows/31083930#31083930", "title": "How to eliminate modified letters and dates using Mac and Windows", "body": "<p>Although I could not repeat your issue using VBA with the Swedish characters (mine came out fine), I could repeat your issue with the date.  It appears you have uncovered a bug in Excel Mac 2011 VBA!</p>\n\n<p>I can confirm that this bug does not exist in Excel Mac 2016 VBA.</p>\n"}], "owner": {"reputation": 11, "user_id": 4970149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63c3bed994b515f9d04b930bad6a2a07?s=128&d=identicon&r=PG&f=1", "display_name": "Aspen", "link": "https://stackoverflow.com/users/4970149/aspen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593758986, "creation_date": 1433354702, "last_edit_date": 1593758986, "question_id": 30627502, "link": "https://stackoverflow.com/questions/30627502/how-to-eliminate-modified-letters-and-dates-using-mac-and-windows", "title": "How to eliminate modified letters and dates using Mac and Windows", "body": "<p>I have vba for Excel running on Windows 7. The Excel document is stored on Dropbox.\nWhen the document is opened from a Mac and stored my national characters (Swedish \u00c5, \u00c4, \u00d6) are changed to other characters such as \"_\" and other non letter characters.</p>\n\n<p>I also have an ouput printing in Excel cells texts and dates. If the date is \"2015-06-03\" it comes out like that in Windows but from Mac the year is omitted. It becomes \"-06-03\".</p>\n\n<p>Can anyone tell me what to do make this work also in Mac?</p>\n"}, {"tags": ["excel", "logic", "vba"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1433355768, "post_id": 30627703, "comment_id": 49321452, "body": "Please <a href=\"https://stackoverflow.com/posts/30627703/edit\">edit</a> the title of your question to something meaningful. You&#39;ve included Excel and VBA in your tags, and they&#39;re not needed in the subject. Removing them leaves <i>coding question</i>, which of course is obvious (if you didn&#39;t have a coding question, you wouldn&#39;t be posting on a Q&amp;A site). Your question should describe the problem you&#39;re having or the question you&#39;re asking us to answer, in a way that will have meaning to future users here who find it in a search result. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4973865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a6b45ed8440709a1911852e398dc509?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4973865/david"}, "edited": false, "score": 0, "creation_date": 1433423705, "post_id": 30628045, "comment_id": 49353585, "body": "Okay I just needed to change j to i because I meant to loop through the rows not columns. I am now getting an error on:   &quot; T = Cells(i, j).Value &#39;test each cell &quot; saying runtime error 13, type mismatch. what could be causing this problem?"}], "tags": [], "owner": {"reputation": 2239, "user_id": 2501529, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5a02988d56793ff9794afab6d8d35af2?s=128&d=identicon&r=PG", "display_name": "Abe Gold", "link": "https://stackoverflow.com/users/2501529/abe-gold"}, "is_accepted": false, "score": 0, "last_activity_date": 1433356668, "creation_date": 1433356668, "answer_id": 30628045, "question_id": 30627703, "link": "https://stackoverflow.com/questions/30627703/conditional-cell-fill-code-to-apply-to-several-rows-with-different-conditions-fo/30628045#30628045", "title": "Conditional cell fill code to apply to several rows with different conditions for each row", "body": "<p>Move the following line down one line (It's before you assigned a value to J):</p>\n\n<pre><code>R = Cells(6, j).Value\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 116, "user_id": 4712035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f84b06a738d2bb6fefd72fb839f3e3e?s=128&d=identicon&r=PG&f=1", "display_name": "jbay", "link": "https://stackoverflow.com/users/4712035/jbay"}, "is_accepted": false, "score": 0, "last_activity_date": 1433356689, "creation_date": 1433356689, "answer_id": 30628057, "question_id": 30627703, "link": "https://stackoverflow.com/questions/30627703/conditional-cell-fill-code-to-apply-to-several-rows-with-different-conditions-fo/30628057#30628057", "title": "Conditional cell fill code to apply to several rows with different conditions for each row", "body": "<p>this doesn't need to use vba.  Just use conditional formatting. On the tabs, assuming you're using excel 2007 or above go to the home tab and select conditional formatting.  Select something from the options or you can select new rule.  From the pop up select \"use a formula to determine which cells to format\".  Enter the equation something like \"=if($a$3&lt;=a4+3,TRUE,False)\" then select the formatting you want.</p>\n"}], "migrated_from": {"other_site": {"aliases": ["http://programmer.stackexchange.com", "http://programmers.stackexchange.com"], "markdown_extensions": ["Prettify"], "launch_date": 1292524346, "open_beta_date": 1283972400, "closed_beta_date": 1283367600, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/softwareengineering/Img/apple-touch-icon@2.png", "twitter_account": "StackSoftEng", "favicon_url": "https://cdn.sstatic.net/Sites/softwareengineering/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/softwareengineering/Img/apple-touch-icon.png", "audience": "professionals, academics, and students working within the systems development life cycle", "site_url": "https://softwareengineering.stackexchange.com", "api_site_parameter": "softwareengineering", "logo_url": "https://cdn.sstatic.net/Sites/softwareengineering/Img/logo.png", "name": "Software Engineering", "site_type": "main_site"}, "on_date": 1433355395, "question_id": 285738}, "owner": {"reputation": 1, "user_id": 4973865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a6b45ed8440709a1911852e398dc509?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4973865/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1433358086, "creation_date": 1433354167, "last_edit_date": 1433358086, "question_id": 30627703, "link": "https://stackoverflow.com/questions/30627703/conditional-cell-fill-code-to-apply-to-several-rows-with-different-conditions-fo", "title": "Conditional cell fill code to apply to several rows with different conditions for each row", "body": "<p>I am trying to write a conditional cell fill code using VBA but am having some syntax issues. I realize there is a tab for this, but I need to apply the code to several different rows with different conditions for each row so code would be faster for my purposes. I am pretty new to VBA but I think I got the logic correct at least. </p>\n\n<p>Basically there is a lead column with the value that each value in the following columns needs to be tested against.</p>\n\n<pre><code>(TEST VALUE) | (VALUE TO BE TESTED)| (VALUE TO BE TESTED)...\n\n(TEST VALUE) | (VALUE TO BE TESTED)| (VALUE TO BE TESTED)...\n</code></pre>\n\n<p>If the value is greater then or less than the test value by 3 units the cell needs to turn red, otherwise it needs to be green.</p>\n\n<p>Here is what I did. I used a button macro but if there is a way to automatically do this without a button that'd be best. </p>\n\n<p>I keep getting <em>run time error \"1004\" ; application or object defined error</em> on line five. So basically I am using a nested set of for loops. The first loop selects the row and picks the test value for that row. Maybe I am assigning the variable wrong or I need to select the worksheet I am working in? The next part of the loop tests the following values in each row to see if they are inside or outside the specified range of the test value. Lastly the cell is colored based on this determination.</p>\n\n<p>CODE:</p>\n\n<pre><code>Private Sub CommandButton21_Click()\nDim i As Integer, j As Integer, T As Integer, R As Integer\n'T is the cell we want to test, R is the Integer we want to use to test T\nFor i = 6 To 132\nR = Cells(6, j).Value\nFor j = 4 To 1000 'loop through each column to test each cell (move to the right down selected row)\n  T = Cells(i, j).Value 'test each cell\n  If T &lt; (R - 3) Or T &gt; (R + 3) Then\n    Cells(i, j).Interior.ColorIndex = 4\nElse\n    Cells(i, j).Interior.ColorInex = 3\nEnd If\nNext j\nNext i\nEnd Sub\n</code></pre>\n\n<p>I also tried using the cell formula editor to apply this code but I don't believe you can change cell color this way:</p>\n\n<pre><code>\"=IF(OR(D6&lt;$C$6-3,D6&gt;$C$6+3),\"CHANGE COLOR TO RED\",\"CHANGE COLOR TO GREEN\"\"\n</code></pre>\n"}, {"tags": ["loops", "excel", "mkdir", "vba"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4966277, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XfqEi4FhIc0/AAAAAAAAAAI/AAAAAAAAAHI/ydTzzMGYhg0/photo.jpg?sz=128", "display_name": "Amy Snyder", "link": "https://stackoverflow.com/users/4966277/amy-snyder"}, "edited": false, "score": 0, "creation_date": 1433357408, "post_id": 30627316, "comment_id": 49322407, "body": "I&#39;m getting a 1004 with the <code>CreateBackup:=False</code> so I commented it out and got rid of the comma after <code>OpenAfterPublish:=True</code>  Other than that, it works perfect!!! Thank you so much for your help!"}], "tags": [], "owner": {"reputation": 113, "user_id": 4953277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9de4fe92a4033e9721c64449533ec2e7?s=128&d=identicon&r=PG&f=1", "display_name": "Y2Que", "link": "https://stackoverflow.com/users/4953277/y2que"}, "is_accepted": true, "score": 0, "last_activity_date": 1433355166, "last_edit_date": 1433355166, "creation_date": 1433354116, "answer_id": 30627316, "question_id": 30627048, "link": "https://stackoverflow.com/questions/30627048/create-new-folder-file-based-on-time-date/30627316#30627316", "title": "Create new folder/file based on time/date", "body": "<p>Try this:</p>\n\n<pre><code>\"C:blah\\\" &amp; Year(Date) &amp; \"\\\" &amp; MonthName(month(Date), False) &amp; \"\\\" &amp; _\n            Format(Now(), \"mm.dd.yy_hh.mm.ssAM/PM\") &amp; \".pdf\" )\n</code></pre>\n\n<p>Code should read:</p>\n\n<pre><code> ' Save File\nstrFilePath = \"C:blah\\\" &amp; Year(Date) &amp; \"\\\" &amp; MonthName(month(Date), False) &amp; \"\\\" &amp; _\n              Format(Now(), \"mm.dd.yy_hh.mm.ssAM/PM\") &amp; \".pdf\" )\n\n\nActiveSheet.ExportAsFixedFormat Type:=x1TypePDF, Filename:= strFilePath,  _\n                                Quality:=x1QualityStandard, IncludeDocProperties:=True, _\n                                IgnorePrintAreas:=False, OpenAfterPublish:=True, _\n                                CreateBackup:=False\n\nApplication.DisplayAlerts = True\n\n ' Popup Message\nMsgBox \"File Saved As:\" &amp; vbNewLine &amp; strFilePath \n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4966277, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XfqEi4FhIc0/AAAAAAAAAAI/AAAAAAAAAHI/ydTzzMGYhg0/photo.jpg?sz=128", "display_name": "Amy Snyder", "link": "https://stackoverflow.com/users/4966277/amy-snyder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2883, "favorite_count": 0, "accepted_answer_id": 30627316, "answer_count": 1, "score": 0, "last_activity_date": 1433355166, "creation_date": 1433353163, "last_edit_date": 1531164843, "question_id": 30627048, "link": "https://stackoverflow.com/questions/30627048/create-new-folder-file-based-on-time-date", "title": "Create new folder/file based on time/date", "body": "<p>so I'm trying to expand a program where it saves reports, exports them as a pdf, and saves. I've got it to where it can organize the pdf saves into folders by year, and then by month. The issue is, when it comes time for the loop to reach the <code>Day(Date)</code> portion of the code, which saves the file and makes a new folder, but when I try and save another report, it just overwrites the previous one. I've tried adding a <code>Time()</code> or <code>Now()</code> function in there, but it's spitting out errors 75 and 76. Please help.</p>\n\n<pre><code>Sub Date_Folder_Save()  \n\nApplication.DisplayAlerts = False   \n\n ' Check for year folder and create if needed\nIf Len(Dir(\"C:blah\\\" &amp; Year(Date), vbDirectory)) = 0 Then\n    MkDir \"C:blah\\\" &amp; Year(Date)\nEnd If\n\n\n ' Check for month folder and create if needed\nIf Len(Dir(\"C:blah\\\" &amp; Year(Date) &amp; \"\\\" &amp; MonthName(month(Date), False), vbDirectory)) = 0 Then\n    MkDir \"C:blah\\\" &amp; Year(Date) &amp; \"\\\" &amp; MonthName(month(Date), False)\nEnd If\n\n  ' Check for day folder and create if needed\nIf Len(Dir(\"C:blah\\\" &amp; Year(Date) &amp; \"\\\" &amp; MonthName(month(Date), False) &amp; \"\\\" &amp; Day(Date), vbDirectory)) = 0 Then\n    MkDir \"C:blah\\\" &amp; Year(Date) &amp; \"\\\" &amp; MonthName(month(Date), False) &amp; \"\\\" &amp; Day(Date)\nEnd If\n\n' Check for time\nIf Len(Dir(\"C:blah\\\" &amp; Year(Date) &amp; \"\\\" &amp; MonthName(month(Date), False) &amp; \"\\\" &amp; Day(Date) &amp; \"\\\" &amp; Now(), vbDirectory)) = 0 Then\n    MkDir \"C:blah\\\" &amp; Year(Date) &amp; \"\\\" &amp; MonthName(month(Date), False) &amp; \"\\\" &amp; Day(Date) &amp; \"\\\" &amp; Now()\nEnd If\n\n ' Save File\nActiveSheet.ExportAsFixedFormat Type:=x1TypePDF, Filename:= _\n\"C:blah\\\" &amp; Year(Date) &amp; \"\\\" &amp; MonthName(month(Date), False) &amp; \"\\\" &amp; Format(Date, \"mm.dd.yy\") &amp; \".pdf\" _\n, Quality:=x1QualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=True _\n, CreateBackup:=False\n\n\n\nApplication.DisplayAlerts = True\n\n ' Popup Message\nMsgBox \"File Saved As:\" &amp; vbNewLine &amp; \"blah\\\" &amp; Year(Date) &amp; _\n\"\\\" &amp; MonthName(month(Date), False) &amp; \"\\\" &amp; Format(Date, \"mm.dd.yy\") &amp; \".pdf\"\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4970731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8feaf0b3ff68c2e4be2340542bdedf8d?s=128&d=identicon&r=PG&f=1", "display_name": "stride1542", "link": "https://stackoverflow.com/users/4970731/stride1542"}, "edited": false, "score": 0, "creation_date": 1433447440, "post_id": 30628238, "comment_id": 49368881, "body": "Yeah - I ended up doing something similar by splitting the words by space and then running a remove duplicate macro. Then I merged them back together with a formula that kept the multiple word phrases within the same set of slashes. Thanks for the help!"}], "tags": [], "owner": {"reputation": 153, "user_id": 4847484, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ffbe465422ceecf17a59ba1d46a0e22b?s=128&d=identicon&r=PG&f=1", "display_name": "Federico Sanchez", "link": "https://stackoverflow.com/users/4847484/federico-sanchez"}, "is_accepted": false, "score": 0, "last_activity_date": 1433357269, "creation_date": 1433357269, "answer_id": 30628238, "question_id": 30626846, "link": "https://stackoverflow.com/questions/30626846/duplicate-removal-within-a-string-or-across-column-in-excel/30628238#30628238", "title": "Duplicate Removal Within a String or Across Column in Excel", "body": "<p>i m assuming you have everything on a single cell right?</p>\n\n<p>i would suggest you split them up, for example if a given path starts with \n/beverages/drinks/....</p>\n\n<p>you can replace spaces with nothing and then split the string by |, so then you can manipulate that array and build your paths. it would be better if at least you split the original string into 2 (the constant-->beverages-drinks; and the variable) and then adapt my codes to that.</p>\n\n<pre><code>Range(\"b1\") = Application.WorksheetFunction.Clean(Range(\"a1\"))\nRange(\"b1\") = Replace(Range(\"b1\").Value, \" \", \"\")\nyourarray = Split(Range(\"b1\").Value, \"|\")\n</code></pre>\n\n<p>let me know if it works or you have your data in a different way.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 4970731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8feaf0b3ff68c2e4be2340542bdedf8d?s=128&d=identicon&r=PG&f=1", "display_name": "stride1542", "link": "https://stackoverflow.com/users/4970731/stride1542"}, "edited": false, "score": 0, "creation_date": 1433447485, "post_id": 30629483, "comment_id": 49368902, "body": "I ended up splitting the words by space and then running a remove duplicate macro. Then I merged them back together with a formula that kept the multiple word phrases within the same set of slashes. Thanks for the help!"}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 0, "last_activity_date": 1433361441, "creation_date": 1433361441, "answer_id": 30629483, "question_id": 30626846, "link": "https://stackoverflow.com/questions/30626846/duplicate-removal-within-a-string-or-across-column-in-excel/30629483#30629483", "title": "Duplicate Removal Within a String or Across Column in Excel", "body": "<p>If each \"part\" is a single word, then you could do process each line and remove the duplicate words and extra spaces; then join the results with the slash.  However, if some of the \"parts\" consist of two words (e.g. <code>beverages | drinks | root beer</code>, then we need to rethink the algorithm.  As a minimum, you might need some kind of lookup table to find the multi-word parts.</p>\n\n<hr>\n\n<pre><code>Option Explicit\nSub CondenseURLParts()\n    Dim colParts As Collection\n    Dim colURLs As Collection\n    Dim vSrc As Variant, vRes() As Variant\n    Dim wsSrc As Worksheet, wsRes As Worksheet, rRes As Range\n    Dim I As Long, J As Long, K As Long\n    Dim V1 As Variant, V2 As Variant\n\n'Set source data and results worksheets and range\nSet wsSrc = Worksheets(\"Sheet1\")\nSet wsRes = Worksheets(\"Sheet1\")\n    Set rRes = wsRes.Cells(1, 2)\n\n'Get original data\nWith wsSrc\n    vSrc = Range(.Cells(1, 1), .Cells(.Rows.Count, \"A\").End(xlUp))\nEnd With\n\n'Process each line and collect unduplicated parts\nSet colURLs = New Collection\nFor I = 1 To UBound(vSrc)\n    V1 = Split(vSrc(I, 1), \"|\")\n    If UBound(V1) &lt;&gt; -1 Then\n        On Error Resume Next\n        Set colParts = New Collection\n            For J = 0 To UBound(V1)\n                V2 = Split(WorksheetFunction.Trim(V1(J)))\n                For K = 0 To UBound(V2)\n                    colParts.Add V2(K), CStr(V2(K))\n                Next K\n            Next J\n        On Error GoTo 0\n        colURLs.Add colParts\n    End If\nNext I\n\n'Create Results array\nReDim vRes(0 To colURLs.Count, 1 To 1)\nvRes(0, 1) = \"URL Parts\"\nFor I = 1 To UBound(vRes)\n    ReDim V1(1 To colURLs(I).Count)\n        For J = 1 To UBound(V1)\n            V1(J) = colURLs(I)(J)\n        Next J\n    vRes(I, 1) = \"/\" &amp; Join(V1, \"/\")\nNext I\n\n'Write the results\nSet rRes = rRes.Resize(UBound(vRes, 1) + 1, UBound(vRes, 2))\nWith rRes\n    .EntireColumn.Clear\n    .Value = vRes\n    With .Rows(1)\n        .Font.Bold = True\n        .HorizontalAlignment = xlCenter\n    End With\n    .EntireColumn.AutoFit\nEnd With\n\nEnd Sub\n</code></pre>\n\n<hr>\n"}], "owner": {"reputation": 1, "user_id": 4970731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8feaf0b3ff68c2e4be2340542bdedf8d?s=128&d=identicon&r=PG&f=1", "display_name": "stride1542", "link": "https://stackoverflow.com/users/4970731/stride1542"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1433361441, "creation_date": 1433352498, "last_edit_date": 1531161705, "question_id": 30626846, "link": "https://stackoverflow.com/questions/30626846/duplicate-removal-within-a-string-or-across-column-in-excel", "title": "Duplicate Removal Within a String or Across Column in Excel", "body": "<p>I'm writing a bunch of URLs and I'm trying to clean them up by removing duplicate words within a string. The problem is the words are separated by slashes and spaces (which will become dashes eventually), which is where I've hit a wall. Here is what the structure of the URL segments look like:</p>\n\n<pre>\nBeverages | Drinks      \nBeverages | Drinks |    Chocolate Drinks    \nBeverages | Drinks |    Chocolate Drinks |  Chocolate Milk\n\nBeverages | Drinks |    Coffee  \nBeverages | Drinks |    Coffee |    Iced Coffee\n</pre>\n\n<p>Ideally the URLs would be:</p>\n\n<pre>\n/beverages/drinks\n/beverages/drinks/chocolate\n/beverages/drinks/chocolate/milk (the second chocolate removed).\n\n/beverages/drinks/coffee\n/beverages/drinks/coffee/iced\n</pre>\n\n<p>The formula I used to combine the segments into urls was:</p>\n\n<pre><code>=LOWER(M1 &amp; IF(AND(M1&lt;&gt;\"\",N1 &amp; O1&lt;&gt;\"\"),\"/\",\"\")&amp; N1 &amp; IF(AND(N1&lt;&gt;\"\",O1 &amp; P1&lt;&gt;\"\"),\"/\",\"\") &amp; O1 &amp; IF(AND(O1&lt;&gt;\"\",P1&lt;&gt;\"\"),\"/\",\"\") &amp; P1)\n</code></pre>\n\n<p>Thanks in advance for any help!</p>\n"}, {"tags": ["python", "windows", "vba", "dll", "com"], "answers": [{"tags": [], "owner": {"reputation": 392, "user_id": 4570898, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh5.googleusercontent.com/-BSN--wU30Bk/AAAAAAAAAAI/AAAAAAAAAQA/YoFv-3ximqQ/photo.jpg?sz=128", "display_name": "Manipal King", "link": "https://stackoverflow.com/users/4570898/manipal-king"}, "is_accepted": true, "score": 0, "last_activity_date": 1433783277, "creation_date": 1433783277, "answer_id": 30715150, "question_id": 30626789, "link": "https://stackoverflow.com/questions/30626789/how-to-unregister-python-com-server/30715150#30715150", "title": "How to unregister Python COM server", "body": "<p>well the  -- unregister command works well for unregistering COM objects , but -- debug is more usable in this position , when someone wants to modify the code. Also if you keep getting the Old instance of the COM object just restart the programs , and it'll detect the new changed code.</p>\n\n<p>The -- debug command will produce results in the PythonWin Trace Collector Windows under Tools Menu.</p>\n"}], "owner": {"reputation": 392, "user_id": 4570898, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh5.googleusercontent.com/-BSN--wU30Bk/AAAAAAAAAAI/AAAAAAAAAQA/YoFv-3ximqQ/photo.jpg?sz=128", "display_name": "Manipal King", "link": "https://stackoverflow.com/users/4570898/manipal-king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 681, "favorite_count": 0, "accepted_answer_id": 30715150, "answer_count": 1, "score": 0, "last_activity_date": 1433783277, "creation_date": 1433352303, "last_edit_date": 1433447996, "question_id": 30626789, "link": "https://stackoverflow.com/questions/30626789/how-to-unregister-python-com-server", "title": "How to unregister Python COM server", "body": "<p>I'm developing a very simple COM server for educational purpose. I can get it to work but every time i have to change anything (code/logic) , i have to delete every instance of the COM Server Name in the regedit.exe under various headings till it disappears from the PythonWin >> Tools Menu >> Python COM Server Browser.</p>\n\n<p>I have tried the <strong>-- unregister</strong> command in the Command prompt , it says over there that the com server is unregistered but I can still see in the \"Python COM Server Browser\".</p>\n\n<p>Moreover, even after deleting all the instances of the COM server from the regedit.exe and re-registering the COM server brings me back to the OLD code instead of the new saved code which i want to run.(i.e new objects won't be detected, etc).</p>\n\n<p>So for each time I make a change, I have to register a new COM server in a new file with a new name. </p>\n\n<p>Can someone please tell me what I'm doing wrong ? Is there any easier way of doing this.  </p>\n"}, {"tags": ["vba", "excel", "format", "spaces"], "answers": [{"comments": [{"owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 0, "creation_date": 1433357096, "post_id": 30627948, "comment_id": 49322202, "body": "Could you explain this a bit more please? It looks like you added <code>nextRow</code> into the code ... but it is not defined anywhere so I get back errors @Abe Gold"}, {"owner": {"reputation": 2239, "user_id": 2501529, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5a02988d56793ff9794afab6d8d35af2?s=128&d=identicon&r=PG", "display_name": "Abe Gold", "link": "https://stackoverflow.com/users/2501529/abe-gold"}, "reply_to_user": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 0, "creation_date": 1433357289, "post_id": 30627948, "comment_id": 49322319, "body": "Dim it as Integer. The way you did it, you are using i as the row to put the file name. What I&#39;m doing is setting the next available row to a variable and using that to paste all the info, including the file name. If you do it that way, you don&#39;t have to keep on doing Range(&quot;B&quot; &amp; Rows.count).End(xlUp).Offset(1) the way you did it."}, {"owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 0, "creation_date": 1433357526, "post_id": 30627948, "comment_id": 49322486, "body": "Okay. The next error says that the line <code>Range(&quot;B&quot; &amp; nextRow).PasteSpecial</code> is : Method &#39;Range&#39; of object&#39;_Global&#39; failed meaning it is not an acceptable range. Would I not have to set what nextRow is equal to  as I did with LastRow in the line <code>LastRow = Cells(Rows.count, 1).End(xlUp).Row</code> ?"}, {"owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 0, "creation_date": 1433357838, "post_id": 30627948, "comment_id": 49322682, "body": "Also, not sure how to implement it but would an offset be faster or no? <i>such as <code>...(xlUp).offset(1,0).pastespecial</code></i>"}], "tags": [], "owner": {"reputation": 2239, "user_id": 2501529, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5a02988d56793ff9794afab6d8d35af2?s=128&d=identicon&r=PG", "display_name": "Abe Gold", "link": "https://stackoverflow.com/users/2501529/abe-gold"}, "is_accepted": false, "score": 0, "last_activity_date": 1433356324, "creation_date": 1433356324, "answer_id": 30627948, "question_id": 30626759, "link": "https://stackoverflow.com/questions/30626759/formatting-vba-adding-spaces-between-sections/30627948#30627948", "title": "Formatting VBA - adding spaces between sections", "body": "<pre><code>Option Explicit\n\nSub LoopThroughDirectory()\n\nDim objFSO As Object\nDim objFolder As Object\nDim objFile As Object\nDim MyFolder As String\nDim StartSht As Worksheet, ws As Worksheet\nDim WB As Workbook\nDim i As Integer\nDim LastRow As Integer, erow As Integer\nDim Height As Integer\n\n'turn screen updating off - makes program faster\n'Application.ScreenUpdating = False\n\n'location of the folder in which the desired TDS files are\nMyFolder = \"C:\\Users\\trembos\\Documents\\TDS\\progress\\\"\n\n'Set StartSht = ActiveSheet\nSet StartSht = Workbooks(\"masterfile.xlsm\").Sheets(\"Sheet1\")\n\n'create an instance of the FileSystemObject\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\n'get the folder object\nSet objFolder = objFSO.GetFolder(MyFolder)\ni = 1\n\n'loop through directory file and print names\nFor Each objFile In objFolder.Files\n    If LCase(Right(objFile.Name, 3)) = \"xls\" Or LCase(Left(Right(objFile.Name, 4), 3)) = \"xls\" Then\n        'print file name to Column 1\n        Workbooks.Open fileName:=MyFolder &amp; objFile.Name\n        Set WB = ActiveWorkbook\n        LastRow = Cells(Rows.count, 1).End(xlUp).Row\n        Range(Cells(11, 6), Cells(LastRow, 6)).Copy\n        StartSht.Activate\n    nextRow = Range(\"B\" &amp; Rows.count).End(xlUp) + 1\n        Range(\"B\" &amp; nextRow).PasteSpecial\n        WB.Activate\n\n        LastRow = Cells(Rows.count, 1).End(xlUp).Row\n        Range(Cells(11, 7), Cells(LastRow, 7)).Copy\n        StartSht.Activate\n        Range(\"C\" &amp; nextRow).PasteSpecial\n        WB.Activate\n\n        'print TOOLING DATA SHEET(TDS): values to Column 2\n        With WB\n            For Each ws In .Worksheets\n                StartSht.Cells(nextRow, 1) = objFile.Name\n                With ws\n                    .Range(\"J1\").Copy StartSht.Cells(nextRow, 4)\n                End With\n                i = i + 1\n            'move to next file\n            Next ws\n            'close, do not save any changes to the opened files\n            .Close SaveChanges:=False\n        End With\n    End If\n'move to next file\nNext objFile\n'turn screen updating back on\n'Application.ScreenUpdating = True\n</code></pre>\n\n<p>End Sub</p>\n"}, {"comments": [{"owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 0, "creation_date": 1433358583, "post_id": 30628302, "comment_id": 49323139, "body": "Okay... it used to print out 5 file names in column 1, around 30 lines of info in columns 2 and 3 (the 5 files info piled together), and 5 cells in column 4. Now it&#39;s overwriting something.. because it prints one name 3 lines down, 1 of the files column 2 and 3 info, and only 1 cell name in column 4..."}, {"owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 0, "creation_date": 1433422171, "post_id": 30628302, "comment_id": 49352498, "body": "okay, I change that and it will still not work correctly. now some of the file names are printing multiple times and their corresponding tools arent in the correct order anymore. the five files names print, then there are  10 spaces and six files (one repeat) prints, then there are 19 spaces and two of the same files print... the fourth column and the first column do at least seem to line up though.."}, {"owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 0, "creation_date": 1433432277, "post_id": 30628302, "comment_id": 49360058, "body": "Do you know how I should fix that? @dePatinkin"}, {"owner": {"reputation": 2039, "user_id": 3848861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhEKB.png?s=128&g=1", "display_name": "dePatinkin", "link": "https://stackoverflow.com/users/3848861/depatinkin"}, "reply_to_user": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "edited": false, "score": 0, "creation_date": 1433452296, "post_id": 30628302, "comment_id": 49371408, "body": "You calculated lRow for WB instead of StartSht. Maybe you should take my suggestion of using the full reference instead of Active and then you&#39;ll be aware of what you&#39;re doing. You should also debug your code and see that you are getting the right lRow value"}], "tags": [], "owner": {"reputation": 2039, "user_id": 3848861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhEKB.png?s=128&g=1", "display_name": "dePatinkin", "link": "https://stackoverflow.com/users/3848861/depatinkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1433453582, "last_edit_date": 1433453582, "creation_date": 1433357472, "answer_id": 30628302, "question_id": 30626759, "link": "https://stackoverflow.com/questions/30626759/formatting-vba-adding-spaces-between-sections/30628302#30628302", "title": "Formatting VBA - adding spaces between sections", "body": "<p>You need to use <code>Range(\"B\" &amp; Rows.count).End(xlUp).Row + 2</code> as your first row for all of the columns, because it's the last row of all the data, +2 rows for one space.</p>\n\n<p>Your paste statements should look something like this:</p>\n\n<pre><code>Dim lRow as Long\n...\nlRow = StartSht.Range(\"B\" &amp; Rows.count).End(xlUp).Row + 2\n...\nStartSht.Range(\"B\" &amp; lRow).PasteSpecial\n...\nStartSht.Range(\"C\" &amp; lRow).PasteSpecial\n...\ni = lRow\n...\n    StartSht.Cells(i, 1) = objFile.Name\n    ...\n    .Range(\"J1\").Copy StartSht.Cells(i, 4)\n    i = i + 1\n</code></pre>\n\n<p><strong>Addition</strong>: Calculate `lRow' for each new file, as the first row changes after the last file was added to the data.</p>\n\n<p>Also, it's a better practice to use the full reference. Instead of using <code>.Activate</code> use <code>StartSht.Range(\"C\" &amp; lRow).PasteSpecial</code>, and the same goes for <code>WB</code>. With WB also make sure the active sheet is the right one, the full reference <code>WB.Sheets([]).Range(...</code>.</p>\n"}], "owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1279, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1433453582, "creation_date": 1433352247, "last_edit_date": 1433355620, "question_id": 30626759, "link": "https://stackoverflow.com/questions/30626759/formatting-vba-adding-spaces-between-sections", "title": "Formatting VBA - adding spaces between sections", "body": "<p>I have this code which works well that loops through a folder, opens a file, prints the name of the file to Column 1 of my Masterfile(<em>the file with the code and where all of my final information will go</em>), prints 2 columns (<em>of varying length since I use End(xlUp) to get all of the info present in the column</em>) from the file into columns 2 and 3, and prints the cell J1 from the file to column 4 in the masterfile.</p>\n\n<p>My problem: There is only one name of the file, one J1 cell, but multiple entries in columns 2 and 3. I need to space it out so the name and J1 are printed in the top of each new entry. I have attached photos to explain what I mean. Columns 2 and 3 should be listed next to their corresponding file names (preferable with an extra space between each new file).</p>\n\n<p>(<em>I have color coded them only to show my meaning</em>)\nPicture 1: How it currenlty looks (all info just dumped into each column)\nPicture 2: How I want it to look (the file names spaced out so horizontally, all of the information corresponds to the same file)</p>\n\n<p>The code to output this data is also below. Thank you very much for any help/guidance you can give me!</p>\n\n<p>Picture 1:\n<img src=\"https://i.stack.imgur.com/3DsRI.png\" alt=\"Picture1\">\nPicture 2:</p>\n\n<h2><img src=\"https://i.stack.imgur.com/R6NBa.png\" alt=\"enter image description here\"></h2>\n\n<pre><code>Option Explicit\n\nSub LoopThroughDirectory()\n\n    Dim objFSO As Object\n    Dim objFolder As Object\n    Dim objFile As Object\n    Dim MyFolder As String\n    Dim StartSht As Worksheet, ws As Worksheet\n    Dim WB As Workbook\n    Dim i As Integer\n    Dim LastRow As Integer, erow As Integer\n    Dim Height As Integer\n\n    'turn screen updating off - makes program faster\n    'Application.ScreenUpdating = False\n\n    'location of the folder in which the desired TDS files are\n    MyFolder = \"C:\\Users\\trembos\\Documents\\TDS\\progress\\\"\n\n    'Set StartSht = ActiveSheet\n    Set StartSht = Workbooks(\"masterfile.xlsm\").Sheets(\"Sheet1\")\n\n    'create an instance of the FileSystemObject\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n    'get the folder object\n    Set objFolder = objFSO.GetFolder(MyFolder)\n    i = 1\n\n    'loop through directory file and print names\n    For Each objFile In objFolder.Files\n        If LCase(Right(objFile.Name, 3)) = \"xls\" Or LCase(Left(Right(objFile.Name, 4), 3)) = \"xls\" Then\n            'print file name to Column 1\n            Workbooks.Open fileName:=MyFolder &amp; objFile.Name\n            Set WB = ActiveWorkbook\n\n\n            'print \"HOLDER\" column\n            'Range(\"HOLDER\").AdvancedFilter Action:=xlFilterCopy, CriteriaRange:=WB.Range(Rows.count, 6).End(xlUp).Row, CopyToRange:=StartSht.Range(Rows.count, 2).End(xlUp).Row, Unique:=False\n\n            'WB.Range(\"F10:F25\").Value = StartSht.Range(\"C2:C17\").Value\n\n'            For i = 1 To 20\n'                ActiveSheet.Range(\"F10:F25\") = StartSht(\"Sheet1\").Range(\"C2:C17\")\n'            Next i\n\n'            Range(Rows.count, 6).End(xlUp).Row.Copy\n'            StartSht.Activate\n'            Range(Rows.count, 2).End(xlUp).Row.Select\n'            ActiveSheet.Paste\n'\n'            WB.Activate\n\n            LastRow = Cells(Rows.count, 1).End(xlUp).Row\n            Range(Cells(11, 6), Cells(LastRow, 6)).Copy\n            StartSht.Activate\n            Range(\"B\" &amp; Rows.count).End(xlUp).Offset(1).PasteSpecial\n            WB.Activate\n\n            LastRow = Cells(Rows.count, 1).End(xlUp).Row\n            Range(Cells(11, 7), Cells(LastRow, 7)).Copy\n            StartSht.Activate\n            Range(\"C\" &amp; Rows.count).End(xlUp).Offset(1).PasteSpecial\n            WB.Activate\n\n            'print TOOLING DATA SHEET(TDS): values to Column 2\n            With WB\n                For Each ws In .Worksheets\n                    StartSht.Cells(i + 1, 1) = objFile.Name\n                    With ws\n                        .Range(\"J1\").Copy StartSht.Cells(i + 1, 4)\n                    End With\n                    i = i + 1\n                'move to next file\n                Next ws\n                'close, do not save any changes to the opened files\n                .Close SaveChanges:=False\n            End With\n        End If\n    'move to next file\n    Next objFile\n    'turn screen updating back on\n    'Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 57, "user_id": 4719065, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MpjFC.jpg?s=128&g=1", "display_name": "Markus", "link": "https://stackoverflow.com/users/4719065/markus"}, "edited": false, "score": 0, "creation_date": 1436284973, "post_id": 30626467, "comment_id": 50541665, "body": "This question was poorly worded, please see the following post for a more adequately worded question with the proper solution. (It turned out to be extremely simple). <a href=\"http://stackoverflow.com/questions/30851007/vba-directory-referencing/30851530#30851530\" title=\"vba directory referencing\">stackoverflow.com/questions/30851007/vba-directory-referenci&zwnj;&#8203;ng/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 4719065, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MpjFC.jpg?s=128&g=1", "display_name": "Markus", "link": "https://stackoverflow.com/users/4719065/markus"}, "edited": false, "score": 0, "creation_date": 1433425786, "post_id": 30626915, "comment_id": 49355105, "body": "What I was going for was there to be only ONE directory that is chosen at startup and for there to be a simple: <i>Copy cells from the other workbook if not empy</i>"}, {"owner": {"reputation": 57, "user_id": 4719065, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MpjFC.jpg?s=128&g=1", "display_name": "Markus", "link": "https://stackoverflow.com/users/4719065/markus"}, "edited": false, "score": 0, "creation_date": 1436285728, "post_id": 30626915, "comment_id": 50542205, "body": "The following link shows what I was actually intending to accomplish. Sorry for the confusing post. <a href=\"http://stackoverflow.com/questions/30851007/vba-directory-referencing\">link</a>"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1433352740, "creation_date": 1433352740, "answer_id": 30626915, "question_id": 30626467, "link": "https://stackoverflow.com/questions/30626467/variable-directory-in-loop/30626915#30626915", "title": "Variable Directory in Loop", "body": "<p>It seems that you have a list of Excel workbooks together with their path(s) in column A.  You are going to have to open the workbook if you want to retrieve information from the cell(s) in that workbook.</p>\n\n<p>This generic framework should help you get started on a sub that loops through the values in the active workbook's active worksheet's column A, opens each file listed and transfers the value from A1 to the original workbook's column B.</p>\n\n<pre><code>Sub ref()\n    Dim wb0 As Workbook, wb1 As Workbook\n    Dim r As Long, lr As Long\n\n    Set wb0 = ActiveWorkbook\n\n    With wb0.Sheets(\"Sheet1\")\n        lr = .Cells(Rows.Count, 1).End(xlUp).Row\n        For r = 1 To lr\n            If Not IsEmpty(.Cells(r, 1)) Then\n                Set wb1 = Workbooks.Open(.Cells(r, 1).Value2)\n                .Cells(r, 2) = wb1.Sheets(\"Sheet1\").Cells(1, 1).Value\n                wb1.Close False\n            End If\n        Next r\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>You will have to expand on that for your own individual situation but I believe you should see the process as you loop through the workbooks listed in column A.</p>\n"}], "owner": {"reputation": 57, "user_id": 4719065, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MpjFC.jpg?s=128&g=1", "display_name": "Markus", "link": "https://stackoverflow.com/users/4719065/markus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 30626915, "answer_count": 1, "score": 0, "last_activity_date": 1433352740, "creation_date": 1433351342, "question_id": 30626467, "link": "https://stackoverflow.com/questions/30626467/variable-directory-in-loop", "title": "Variable Directory in Loop", "body": "<p>I'm trying to make a macro that allows the user to select a file (excel file) which then is used to copy down information to the active workbook from that selected file. I don't know how to include the file's variable directory into the code. Anyone got an idea?</p>\n\n<pre><code>Sub Ref()\n\n    Dim Path As String\n    Path = Application.GetOpenFilename\n\n    Dim r As Integer\n    r = 1\n\n        For r = 1 To 1000\n            If Not IsEmpty(Range(Path(Cells(r, 1)))) Then\n            Cells(r, 1) = Range(Path(Cells(r, 1)))\n            End If\n        Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "is_accepted": false, "score": 0, "last_activity_date": 1433351338, "creation_date": 1433351338, "answer_id": 30626465, "question_id": 30626010, "link": "https://stackoverflow.com/questions/30626010/searchfilters-and-code-execution-from-a-noob/30626465#30626465", "title": "SearchFilters and code execution: From a noob", "body": "<p>This is about operator precedence and how the computer combines your various <code>Or</code> and <code>And</code> statements. Try putting your new searchFilter inside a set of brackets. So, \n    <code>searchFilter = \"((\" &amp; \"[Event Name] ... [Remedy 2] Like '*\" &amp; searchString &amp; \"*'\" &amp; \"))\"</code></p>\n\n<p>This will make sure that your new tests get treated as a single unit with the result of that unit then added to the other tests using the <code>And</code> operator. </p>\n"}, {"tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": false, "score": 0, "last_activity_date": 1433351516, "creation_date": 1433351516, "answer_id": 30626539, "question_id": 30626010, "link": "https://stackoverflow.com/questions/30626010/searchfilters-and-code-execution-from-a-noob/30626539#30626539", "title": "SearchFilters and code execution: From a noob", "body": "<p>A filter on a form is essentially the WHERE clause of a SQL statement.</p>\n\n<p>The problem is that you are missing parentheses in your search string SQL.</p>\n\n<p>The code you are running is this:</p>\n\n<pre><code> Filter = ([Event Name] Like '*SEARCH*') \n       OR ([Event Submitted By] Like '*SEARCH*')\n       OR ([Organizational Business Unit] Like '*SEARCH*') \n       OR ([Business Line Impacted] Like '*SEARCH*')\n\n       ...\n\n       OR ([Remedy 2] Like '*SEARCH*')\n\n       AND ([Region] Like '*REGIONSEARCH*')\n       AND ([OpERA Create Date] Between #DATE1# AND #DATE2#)\n</code></pre>\n\n<p>What you intend to do is have all of the \"OR\" statements determined together and then also have the AND statements, but what the code is actually doing is this:</p>\n\n<pre><code> Filter =  ([Event Name] Like '*SEARCH*') \n       OR ([Event Submitted By] Like '*SEARCH*')\n       OR ([Organizational Business Unit] Like '*SEARCH*') \n       OR ([Business Line Impacted] Like '*SEARCH*')\n\n       ...\n\n       OR **(** ([Remedy 2] Like '*SEARCH*')\n\n       AND ([Region] Like '*REGIONSEARCH*')\n       AND ([OpERA Create Date] Between #DATE1# AND #DATE2#) **)**\n</code></pre>\n\n<p>Add the parentheses to the search string to get the appropriate filter:</p>\n\n<pre><code>   Filter = **(** ([Event Name] Like '*SEARCH*') \n       OR ([Event Submitted By] Like '*SEARCH*')\n       OR ([Organizational Business Unit] Like '*SEARCH*') \n       OR ([Business Line Impacted] Like '*SEARCH*')\n\n       ...\n\n       OR ([Remedy 2] Like '*SEARCH*') **)**\n\n       AND ([Region] Like '*REGIONSEARCH*')\n       AND ([OpERA Create Date] Between #DATE1# AND #DATE2#)\n</code></pre>\n\n<p>Surround the search clause in parentheses and this should fix the problem.</p>\n"}], "owner": {"reputation": 11, "user_id": 4930185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49b4e38e9cf8e621a03866e6e8f8eccc?s=128&d=identicon&r=PG&f=1", "display_name": "echelon99", "link": "https://stackoverflow.com/users/4930185/echelon99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1594644365, "creation_date": 1433349843, "last_edit_date": 1594644365, "question_id": 30626010, "link": "https://stackoverflow.com/questions/30626010/searchfilters-and-code-execution-from-a-noob", "title": "SearchFilters and code execution: From a noob", "body": "<p>I inherited the database from the guy who left, and have been trying to run maintenance and add functionality as required. I should say that when I stared this job 3 weeks ago, I had absolutely no coding experience, but have picked up things here and there. On to the problem: </p>\n\n<p>The main form has a table nested in there, and the filters were basically set up to filter out and play with the data in the table. I'll try and attach a picture on imugr and add the link (EDIT:<a href=\"http://imgur.com/nHUsCdX\" rel=\"nofollow\">http://imgur.com/nHUsCdX</a>)</p>\n\n<p>There are a number of filters and search boxes on the left side. This includes:</p>\n\n<ol>\n<li><p>A text search box (search through Column A)</p></li>\n<li><p>A Date search box</p></li>\n<li><p>Group Filter - searches in Group column, and filters out based on chosen value.</p></li>\n<li><p>Trending - a filter that basically fills up the Date Search Box (2) with pre-set dates for earnings quarters. </p></li>\n<li><p>Region Filter - works the same way as Group Filter (3), except search in the region column. </p></li>\n</ol>\n\n<p>The following lines of code more or less governs these filters and search boxes, i'll post it in its entirety. </p>\n\n<pre><code>Private Sub frmFieldPresets_AfterUpdate()\n\nDim fieldPreset As String\nSelect Case Me.frmFieldPresets\n\n    Case 1\n        fieldPreset = \"Audit\"\n        DoCmd.OpenForm \"frm_Fields\"\n        Call Forms.frm_Fields.cmd_De_SelectAllFields_Click\n        Forms.frm_Fields.chk_EN.Value = True\n        Forms.frm_Fields.chk_BLI.Value = True\n        Forms.frm_Fields.chk_AN.Value = True\n        Forms.frm_Fields.chk_EDD.Value = True\n        Forms.frm_Fields.chk_GIIC.Value = True\n        Forms.frm_Fields.chk_NILGIC.Value = True\n        Forms.frm_Fields.chk_RDTTO.Value = True\n        Forms.frm_Fields.chk_ESB.Value = True\n        Call Forms.frm_Fields.refreshFields\n        DoCmd.Close acForm, \"frm_Fields\"\n\n    Case 2\n        fieldPreset = \"CMRM\"\n        DoCmd.OpenForm \"frm_Fields\"\n        Call Forms.frm_Fields.cmd_De_SelectAllFields_Click\n        Forms.frm_Fields.chk_BLI.Value = True\n        Forms.frm_Fields.chk_AN.Value = True\n        Forms.frm_Fields.chk_OID.Value = True\n        Forms.frm_Fields.chk_EN.Value = True\n        Forms.frm_Fields.chk_GIIC.Value = True\n        Forms.frm_Fields.chk_NILGIC.Value = True\n        Forms.frm_Fields.chk_RDTTO.Value = True\n        Forms.frm_Fields.chk_EDD.Value = True\n        Call Forms.frm_Fields.refreshFields\n        DoCmd.Close acForm, \"frm_Fields\"\n\n    Case 3\n        fieldPreset = \"Finance\"\n        DoCmd.OpenForm \"frm_Fields\"\n        Call Forms.frm_Fields.cmd_De_SelectAllFields_Click\n        Forms.frm_Fields.chk_EN.Value = True\n        Forms.frm_Fields.chk_RDTTO.Value = True\n        Forms.frm_Fields.chk_BLI.Value = True\n        Forms.frm_Fields.chk_GIIC.Value = True\n        Forms.frm_Fields.chk_NILGIC.Value = True\n        Call Forms.frm_Fields.refreshFields\n        DoCmd.Close acForm, \"frm_Fields\"\n\n    Case 4\n        fieldPreset = \"TBM\"\n        DoCmd.OpenForm \"frm_Fields\"\n        Call Forms.frm_Fields.cmd_De_SelectAllFields_Click\n        Forms.frm_Fields.chk_EN.Value = True\n        Forms.frm_Fields.chk_BLI.Value = True\n        Forms.frm_Fields.chk_AN.Value = True\n        Forms.frm_Fields.chk_RDTTO.Value = True\n        Forms.frm_Fields.chk_GIIC.Value = True\n        Forms.frm_Fields.chk_NILGIC.Value = True\n        Forms.frm_Fields.chk_EDD.Value = True\n        Call Forms.frm_Fields.refreshFields\n        DoCmd.Close acForm, \"frm_Fields\"\n\n        Exit Sub\nEnd Select\n\nEnd Sub\n\nPrivate Sub frmRegions_AfterUpdate()\nCall refresh_Filters\n End Sub\n\n\nPrivate Function regionselection()\nSelect Case Me.frmRegions\n\n    Case 1\n        regionselection = \"Canada\"\n\n    Case 2\n        regionselection = \"USA\"\n\n    Case 3\n        regionselection = \"Singapore\"\n\n    Case 4\n        regionselection = \"Europe &amp; Asia Pacific\"\n\n    Case 5\n        regionselection = \"Global\"\n\nEnd Select\n\nEnd Function\n\nPrivate Sub frmTrendingQuarters_AfterUpdate()\n\n\nDim fieldPreset As String\nSelect Case Me.frmTrendingQuarters\n\n    Case 1\n        txtDate1.Value = \"11/1/2014\"\n        txtDate2.Value = \"1/31/2015\"\n        fieldPreset = \"Q1\"\n\n    Case 2\n        txtDate1.Value = \"2/1/2015\"\n        txtDate2.Value = \"4/30/2015\"\n        fieldPreset = \"Q2\"\n\n    Case 3\n        txtDate1.Value = \"5/1/2015\"\n        txtDate2.Value = \"7/31/2015\"\n        fieldPreset = \"Q3\"\n\n    Case 4\n        txtDate1.Value = \"8/1/2015\"\n        txtDate2.Value = \"10/30/2015\"\n        fieldPreset = \"Q4\"\n\n        Exit Sub\nEnd Select\n\nDoCmd.OpenForm \"frm_Fields\"\nCall Forms.frm_Fields.cmd_De_SelectAllFields_Click\nForms.frm_Fields.chk_OID.Value = True\nForms.frm_Fields.chk_EN.Value = True\nForms.frm_Fields.chk_FWCO.Value = True\nForms.frm_Fields.chk_Reg.Value = True\nForms.frm_Fields.chk_RC.Value = True\nForms.frm_Fields.chk_Rem1.Value = True\nForms.frm_Fields.chk_Rem2.Value = True\nForms.frm_Fields.chk_RDTTO.Value = True\nCall Forms.frm_Fields.refreshFields\nDoCmd.Close acForm, \"frm_Fields\"\n\nCall refresh_Filters\n\n\nEnd Sub\n\nPrivate Sub txtDate1_AfterUpdate()\nCall refresh_Filters\nEnd Sub\n\nPrivate Sub txtDate2_AfterUpdate()\nCall refresh_Filters\nEnd Sub\n\nPrivate Sub txtSearch_AfterUpdate()\nCall refresh_Filters\nEnd Sub\n\n\nPrivate Sub refresh_Filters()\n\n\nDim searchFilter, dateFilter, allFilter As String\nDim searchString, date1String, date2String As String\n\nMe.Refresh\n\nIf IsNull(Me.txtSearch) Then\n    searchString = \"*\"\nElse\n    searchString = Me.txtSearch\nEnd If\n\n\nIf IsNull(Me.txtDate1) Then\n    date1String = \"1/1/2000\"\nElse\n    date1String = Me.txtDate1\nEnd If\n\n\nIf IsNull(Me.txtDate2) Then\n    date2String = \"1/1/2020\"\nElse\n    date2String = Me.txtDate2\nEnd If\n\n\nsearchFilter = \"(\" &amp; \"[Event Name] Like '*\" &amp; searchString &amp; \"*'\" &amp; \")\"\nregionFilter = \"(\" &amp; \"[Region] Like '*\" &amp; regionselection &amp; \"*'\" &amp; \")\"\ndateFilter = \"(\" &amp; \"[OpERA Create Date] Between \" &amp; \"#\" &amp; date1String &amp; \"#\" &amp; \" AND \" &amp; \"#\" &amp; date2String &amp; \"#\" &amp; \")\"\nallFilter = searchFilter &amp; \" And \" &amp; dateFilter &amp; \" And \" &amp; regionFilter\n\n    Me.frm_ORE_All.Form.Filter = allFilter\n    Me.frm_ORE_All.Form.FilterOn = True\n\nEnd Sub\n</code></pre>\n\n<p>Now the part I need help with is the last few lines of code. At some point, I was told the parameters for textSearch, which was only looking in one column (Event Name), needed to be expanded to include additional columns. So the search would expand to look through more columns. So I changed the code for searchFilter, and added more columns to it. </p>\n\n<p>This is the UPDATED code, the last few lines. </p>\n\n<pre><code>'searchFilter = \"(\" &amp; \"[Event Name] Like '*\" &amp; searchString &amp; \"*'\" &amp; \")\"\nsearchFilter = \"(\" &amp; \"[Event Name] Like '*\" &amp; searchString &amp; \"*'\" &amp; \") OR (\" &amp; \"[Event Submitted By] Like '*\" &amp; searchString &amp; \"*'\" &amp; \") OR (\" &amp; \"[Organizational Business Unit] Like '*\" &amp; searchString &amp; \"*'\" &amp; \") OR (\" &amp; \"[Business Line Impacted] Like '*\" &amp; searchString &amp; \"*'\" &amp; \") OR (\" &amp; \"[Attester Name] Like '*\" &amp; searchString &amp; \"*'\" &amp; \") OR (\" &amp; \"[Comments] Like '*\" &amp; searchString &amp; \"*'\" &amp; \") OR (\" &amp; \"[Function Where Cause Occurred] Like '*\" &amp; searchString &amp; \"*'\" &amp; \") OR (\" &amp; \"[Root Cause] Like '*\" &amp; searchString &amp; \"*'\" &amp; \") OR (\" &amp; \"[Remedy 1] Like '*\" &amp; searchString &amp; \"*'\" &amp; \") OR (\" &amp; \"[Remedy 2] Like '*\" &amp; searchString &amp; \"*'\" &amp; \")\"\nregionFilter = \"(\" &amp; \"[Region] Like '*\" &amp; regionselection &amp; \"*'\" &amp; \")\"\ndateFilter = \"(\" &amp; \"[OpERA Create Date] Between \" &amp; \"#\" &amp; date1String &amp; \"#\" &amp; \" AND \" &amp; \"#\" &amp; date2String &amp; \"#\" &amp; \")\"\nallFilter = searchFilter &amp; \" And \" &amp; dateFilter &amp; \" And \" &amp; regionFilter\n\n\n    Me.frm_ORE_All.Form.Filter = allFilter\n    Me.frm_ORE_All.Form.FilterOn = True\n\nEnd Sub\n</code></pre>\n\n<p>Once I slot in this new line of code for searchFilter, and decommission the original one, it works perfectly. EXCEPT the other filters stop working for whatever reason. So while GroupFilters still work, Trending and RegionFilter stop working altogether. </p>\n\n<p>If I switch back in the original line of code, and decommission the new one, everything starts working fine again (except the fact that the textboxsearch goes back to searching through one column only). </p>\n\n<p>I'm sure it's just inefficiency in my code, or something glaringly obvious that you'll spot when I don't. Any tips? </p>\n"}, {"tags": ["excel", "date", "uppercase", "vba"], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 4067104, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QXvCu.jpg?s=128&g=1", "display_name": "JFro777", "link": "https://stackoverflow.com/users/4067104/jfro777"}, "edited": false, "score": 0, "creation_date": 1433359746, "post_id": 30626377, "comment_id": 49323776, "body": "Thank you @JerryT, I have one more question for you regarding this same code. I am also trying to strip out all spaces and I&#39;m using this:  <code>&#39;Remove unnecessary spaces     Selection.Replace What:=&quot; &quot;, Replacement:=&quot;&quot;, LookAt:=xlPart, _         SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _         ReplaceFormat:=False</code>  This is also causing the formating to do the same thing as the Capitalizing I was doing. Any idea how to resolve this issue?"}], "tags": [], "owner": {"reputation": 98, "user_id": 4966176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e6a3cb31f7c6d295b3f781d4c722d2d?s=128&d=identicon&r=PG&f=1", "display_name": "JerryT", "link": "https://stackoverflow.com/users/4966176/jerryt"}, "is_accepted": true, "score": 1, "last_activity_date": 1433350994, "creation_date": 1433350994, "answer_id": 30626377, "question_id": 30625920, "link": "https://stackoverflow.com/questions/30625920/vba-excel-prevent-excel-to-change-data-as-date-after-changing-all-cells-to-uppe/30626377#30626377", "title": "VBA Excel: Prevent Excel to change data as date after changing all cells to uppercase", "body": "<p>If you are keeping the Input Boxes you could add this line of code after your <code>MultiRange.Select</code> command</p>\n\n<pre><code>Selection.NumberFormat = \"@\"\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 4067104, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QXvCu.jpg?s=128&g=1", "display_name": "JFro777", "link": "https://stackoverflow.com/users/4067104/jfro777"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 30626377, "answer_count": 1, "score": 0, "last_activity_date": 1433350994, "creation_date": 1433349525, "last_edit_date": 1531164843, "question_id": 30625920, "link": "https://stackoverflow.com/questions/30625920/vba-excel-prevent-excel-to-change-data-as-date-after-changing-all-cells-to-uppe", "title": "VBA Excel: Prevent Excel to change data as date after changing all cells to uppercase", "body": "<p>I have the following code to capitalize all data in two specified ranges and then run some comparing code.\nThe issue is once it runs the capitalize code cells that contain something like <code>1-2</code> gets changed to <code>2-Jan</code>. I cannot apply <code>.NumberFormat = \"@\"</code> to the entire worksheet or that specific column because I am making the sheet dynamic and this data won't always be in the same column. Anyone know how to take care of this problem?</p>\n\n<pre><code>Dim rangeToUse As Range, singleArea As Range, cell1 As Range, cell2 As Range, rng As Range, rng2 As Range\nDim I As Integer, J As Integer\n\n'Set two range selections\nSet rng = Application.InputBox(\"Select First Range\", \"Obtain 1st Range Object\", Type:=8)\nSet rng2 = Application.InputBox(\"Select Second Range\", \"Obtain 2nd Range Object\", Type:=8)\nSet MultiRange = Union(rng, rng2)\nMultiRange.Select\n\nSet rangeToUse = Selection\nCells.Interior.ColorIndex = 0\nCells.Borders.LineStyle = xlNone\n\n'Capitalizes all cells in selected range\n'Turn off screen updating to increase performance\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n\n'Worksheets(\"Phase 3 xwire\").Range(rangeToUse).NumberFormat = \"@\"\n\n   'Convert all constants and text values to proper case\n   For Each LCell In Cells.SpecialCells(xlConstants, xlTextValues)\n      LCell.Formula = UCase(LCell.Formula)\n      Calculate\n   Next\n\nIf Selection.Areas.Count &lt;= 1 Then\n      MsgBox \"Please select more than one area.\"\n    Else\n        rangeToUse.Interior.ColorIndex = 0\n        For Each singleArea In rangeToUse.Areas\n            singleArea.BorderAround ColorIndex:=1, Weight:=xlMedium\n        Next singleArea\n        'Areas.count - 1 will avoid trying to compare\n        ' Area(count) to the non-existent area(count+1)\n        For I = 1 To rangeToUse.Areas.Count - 1\n            For Each cell1 In rangeToUse.Areas(I)\n                'I+1 gets you the NEXT area\n                Set cell2 = rangeToUse.Areas(I + 1).Cells(cell1.Row - 1, cell1.Column - 1)\n                 If IsEmpty(cell2.Value) Then\n                 GoTo Done\n                 Else\n                    If cell1.Value &lt;&gt; cell2.Value Then\n                        cell1.Interior.ColorIndex = 38\n                        cell2.Interior.ColorIndex = 38\n                    End If\n                 End If\n            Next cell1\n        Next I\nDone:\nEnd If\n'Turn screen updating back on\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "worksheet"], "answers": [{"tags": [], "owner": {"reputation": 98, "user_id": 4966176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e6a3cb31f7c6d295b3f781d4c722d2d?s=128&d=identicon&r=PG&f=1", "display_name": "JerryT", "link": "https://stackoverflow.com/users/4966176/jerryt"}, "is_accepted": false, "score": 1, "last_activity_date": 1433349425, "creation_date": 1433349425, "answer_id": 30625897, "question_id": 30625687, "link": "https://stackoverflow.com/questions/30625687/vba-check-excel-worksheet-name/30625897#30625897", "title": "VBA check excel worksheet name", "body": "<p>If the worksheet is the one displayed on the screen you could use something like this:</p>\n\n<pre><code>If ActiveSheet.Name = \"Name of Sheet\" then\n    *Code here\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1433351072, "creation_date": 1433351072, "answer_id": 30626402, "question_id": 30625687, "link": "https://stackoverflow.com/questions/30625687/vba-check-excel-worksheet-name/30626402#30626402", "title": "VBA check excel worksheet name", "body": "<p>You should get away from <em>not</em> explicitly specifying the worksheet (and workbook if more than one are open) when running macros. Specifying the worksheet is easy using a <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow\">With...End With statement</a>. Every range or cell reference belonging to the worksheet simply needs a period (aka <code>.</code> or <em>full-stop</em>) as a prefix to assign the worksheet as the parent. It is only when you want to reference a different worksheet that you need to specify a different parent worksheet; e.g. copying from one worksheet to another. That is easily taken care of with a variable <em>Set</em> to the worksheet object.</p>\n\n<p>Example:</p>\n\n<pre><code>dim ws2 as worksheet\nset ws2 = Sheets(\"Sheet2\")\nwith Sheets(\"Sheet1\")\n    .range(\"A2:D4).copy destination:=ws2.range(\"A2\")\n    'more operations on Sheet1 here using .Range and .Cells\nend with\n</code></pre>\n\n<p>With that said, if you want to determine which worksheet a cell reference like <code>Range(\"A1\")</code> belongs to at some point in your code, get the <a href=\"https://msdn.microsoft.com/en-us/library/office/aa224980(v=office.11).aspx\" rel=\"nofollow\">Range .Parent property</a> of any cell reference and you can determine the parent worksheet's <a href=\"https://msdn.microsoft.com/en-us/library/office/aa175750(v=office.11).aspx\" rel=\"nofollow\">.Name property</a> from that. The <em>External</em> parameter of the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837625.aspx\" rel=\"nofollow\">Address property</a> can also be used to pull out a string cell address with the workbook and worksheet but this would require some text manipulation to determine the worksheet name. </p>\n\n<p>Example:</p>\n\n<pre><code>debug.print Range(\"A1\").parent.name\ndebug.print Cells(1, 1).parent.name\ndebug.print Range(\"A1\").address(0, 0, external:=True)\ndebug.print Cells(1, 1).address(0, 0, external:=True)\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 4954188, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/10be752882a68e75e5a60cf2580def3c?s=128&d=identicon&r=PG&f=1", "display_name": "Rameen Rastan", "link": "https://stackoverflow.com/users/4954188/rameen-rastan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3442, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1433351072, "creation_date": 1433348802, "question_id": 30625687, "link": "https://stackoverflow.com/questions/30625687/vba-check-excel-worksheet-name", "title": "VBA check excel worksheet name", "body": "<p>How can I check the name of the worksheet or workbook that the VBA macro is being run inside? To use as a conditional statement, (if workbook/worksheet name = \" \", then ...).</p>\n"}, {"tags": ["vba", "email", "excel"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1433351094, "post_id": 30625570, "comment_id": 49318621, "body": "For copying the sheet to a new workbook, just use <code>ActiveSheet.Copy</code> withouth the <code>After:...</code> part. For more on CDO message sending, see this: <a href=\"http://rondebruin.nl/win/s1/cdo.htm\" rel=\"nofollow noreferrer\">http://rondebruin.nl/win/s1/cdo.htm</a> To add an attachment, you can use the <code>myMail.AddAttachment &quot;C:\\path...&quot;</code> method."}], "answers": [{"tags": [], "owner": {"reputation": 37, "user_id": 4793008, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b21c88dda0da9da3006d552e05c4cc44?s=128&d=identicon&r=PG&f=1", "display_name": "vdezign solution", "link": "https://stackoverflow.com/users/4793008/vdezign-solution"}, "is_accepted": false, "score": 0, "last_activity_date": 1433517610, "creation_date": 1433517610, "answer_id": 30670192, "question_id": 30625570, "link": "https://stackoverflow.com/questions/30625570/how-to-copy-excel-sheet-into-another-sheet-and-send-it-via-email/30670192#30670192", "title": "how to copy excel sheet into another sheet and send it via email", "body": "<p>After a long day of trouble i finally found the solution \nhere is the code which clone the worksheet and send it via gmail and \n is totally working on excel -2007 - 2010 - 2013 </p>\n\n<pre><code>      Sub Copy_Every_Sheet_To_New_Workbook()\n     'Working in 97-2013\n    Dim FileExtStr As String\n    Dim FileFormatNum As Long\n    Dim Sourcewb As Workbook\n    Dim Destwb As Workbook\n    Dim sh As Worksheet\n    Dim DateString As String\n    Dim FolderName As String\n    Dim Mail As New Message\n    Dim name As String\n    Dim Config As Configuration\n    Dim fileName As String\nSet Config = Mail.Configuration\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n        .Calculation = xlCalculationManual\n    End With\n\n    'Copy every sheet from the workbook with this macro\n    Set Sourcewb = ThisWorkbook\n\n    'Create new folder to save the new files in\n    DateString = Format(Now, \"yyyy-mm-dd hh-mm-ss\")\n    FolderName = Sourcewb.Path &amp; \"\\\" &amp; Sourcewb.name &amp; \" \" &amp; DateString\n    fileName = Sourcewb.name &amp; \" \" &amp; DateString\n    MkDir FolderName\n\n    'Copy every visible sheet to a new workbook\n    For Each sh In Sourcewb.Worksheets\n\n        'If the sheet is visible then copy it to a new workbook\n        If sh.Visible = -1 Then\n            sh.Copy\n\n            'Set Destwb to the new workbook\n            Set Destwb = ActiveWorkbook\n\n            'Determine the Excel version and file extension/format\n            With Destwb\n                If Val(Application.Version) &lt; 12 Then\n                    'You use Excel 97-2003\n                    FileExtStr = \".xls\": FileFormatNum = -4143\n                Else\n                    'You use Excel 2007-2013\n                    If Sourcewb.name = .name Then\n                        MsgBox \"Your answer is NO in the security dialog\"\n                        GoTo GoToNextSheet\n                    Else\n                        Select Case Sourcewb.FileFormat\n                        Case 51: FileExtStr = \".xlsx\": FileFormatNum = 51\n                        Case 52:\n                            If .HasVBProject Then\n                                FileExtStr = \".xlsm\": FileFormatNum = 52\n                            Else\n                                FileExtStr = \".xlsx\": FileFormatNum = 51\n                            End If\n                        Case 56: FileExtStr = \".xls\": FileFormatNum = 56\n                        Case Else: FileExtStr = \".xlsb\": FileFormatNum = 50\n                        End Select\n                    End If\n                End If\n            End With\n\n            'Change all cells in the worksheet to values if you want\n            If Destwb.Sheets(1).ProtectContents = False Then\n                With Destwb.Sheets(1).UsedRange\n                    .Cells.Copy\n                    .Cells.PasteSpecial xlPasteValues\n                    .Cells(1).Select\n                End With\n                Application.CutCopyMode = False\n            End If\n\n\n            'Save the new workbook and close it\n            With Destwb\n                .SaveAs FolderName _\n                      &amp; \"\\\" &amp; fileName &amp; FileExtStr, _\n                        FileFormat:=FileFormatNum\n                .Close False\n            End With\n\n\n\n        End If\nGoToNextSheet:\n    Next sh\n    MsgBox \"You can find the files in \" &amp; FolderName\nMsgBox FolderName &amp; \"\\\" &amp; ActiveSheet.name &amp; \".xlsm\"\nConfig(cdoSendUsingMethod) = cdoSendUsingPort\nConfig(cdoSMTPServer) = \"smtp.gmail.com\"\nConfig(cdoSMTPServerPort) = 465\nConfig(cdoSMTPAuthenticate) = cdoBasic\nConfig(cdoSMTPUseSSL) = True\nConfig(cdoSendUserName) = \"example@gmail.com\"\n\nConfig(cdoSendPassword) = \"password\"\nConfig.Fields.Update\n\nMail.To = \"example1@gmail.com\"\nMail.From = Config(cdoSendUserName)\nMail.Subject = \"hhhhhhhhhhhhh\"\nMail.AddAttachment FolderName &amp; \"\\\" &amp; fileName &amp; \".xlsm\"\nMail.HTMLBody = \"fffff\"\nMail.Send\n\nMsgBox \"sent \"\n\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n        .Calculation = xlCalculationAutomatic\n    End With  \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 4793008, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b21c88dda0da9da3006d552e05c4cc44?s=128&d=identicon&r=PG&f=1", "display_name": "vdezign solution", "link": "https://stackoverflow.com/users/4793008/vdezign-solution"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 801, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1433517610, "creation_date": 1433348415, "last_edit_date": 1433405549, "question_id": 30625570, "link": "https://stackoverflow.com/questions/30625570/how-to-copy-excel-sheet-into-another-sheet-and-send-it-via-email", "title": "how to copy excel sheet into another sheet and send it via email", "body": "<p>I am working on a project where user will fill the information and when click on a send button the exact file will be mailed to some other person with new name</p>\n\n<p>here is my code which works fine to send an email</p>\n\n<pre><code>    Sub send_email_via_Gmail()\nDim myMail As CDO.Message\n\nSet myMail = New CDO.Message\n\nmyMail.Configuration.Fields.Item(\"http://schemas.microsoft.com/cdo/configuration/smtpusessl\") = True\n\nmyMail.Configuration.Fields.Item(\"http://schemas.microsoft.com/cdo/configuration/smtpauthenticate\") = 1\n\nmyMail.Configuration.Fields.Item(\"http://schemas.microsoft.com/cdo/configuration/smtpserver\") = \"smtp.gmail.com\"\n\nmyMail.Configuration.Fields.Item(\"http://schemas.microsoft.com/cdo/configuration/smtpserverport\") = 465\n\nmyMail.Configuration.Fields.Item(\"http://schemas.microsoft.com/cdo/configuration/sendusing\") = 2\n\nmyMail.Configuration.Fields.Item(\"http://schemas.microsoft.com/cdo/configuration/sendusername\") = \"example@gmail.com\"\n\nmyMail.Configuration.Fields.Item(\"http://schemas.microsoft.com/cdo/configuration/sendpassword\") = \"password\"\n\nmyMail.Configuration.Fields.Update\n\nWith myMail\n.Subject = \"Test Email from Dr. Takyar\"\n.From = \"example@gmail.com\"\n.To = \"example1@gmail.com\"\n\n.TextBody = \"Good morning!\"\n\nEnd With\n\nmyMail.Send\nMsgBox (\"Mail has been sent\")\nSet myMail = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>and this is code which will make exact replica of existing sheet</p>\n\n<pre><code>   Sub Add_Sheet()\n    ActiveSheet.Copy After:=Worksheets(Worksheets.Count)\n    Worksheets(Worksheets.Count).Name = InputBox(\"New Name:\")\nEnd Sub\n</code></pre>\n\n<p>now my problem is how do i make new workbook instead of worksheet and send them via email </p>\n\n<p>Here is My code</p>\n\n<pre><code>Sub Add_Sheet()\n\nDim wb As Workbook\n    Set wb = Workbooks.add\n        ThisWorkbook.Sheets(\"Sheet1\").Copy before:=wb.Sheets(1)\n      ActiveWorkbook.SaveAs Filename:=\"C:\\Data\\SalesData1.xlsx\"\n       Workbooks(\"SalesData1.xlsx\").Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "edited": false, "score": 0, "creation_date": 1433347785, "post_id": 30625283, "comment_id": 49316674, "body": "What is the value of <code>hL.Value</code>? It should be a hyperlink like <code>&quot;http:&#47;&#47;www.google.com&quot;</code>"}, {"owner": {"reputation": 2039, "user_id": 3848861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhEKB.png?s=128&g=1", "display_name": "dePatinkin", "link": "https://stackoverflow.com/users/3848861/depatinkin"}, "edited": false, "score": 0, "creation_date": 1433348145, "post_id": 30625283, "comment_id": 49316889, "body": "If it&#39;s a folder path Excel might show a security warning &quot;location may be unsafe&quot;. Do you get any error or message?"}, {"owner": {"reputation": 283, "user_id": 4801586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PJcwl.png?s=128&g=1", "display_name": "314UnreadEmails", "link": "https://stackoverflow.com/users/4801586/314unreademails"}, "edited": false, "score": 0, "creation_date": 1433348678, "post_id": 30625283, "comment_id": 49317203, "body": "Try <code>For Each hL In Rng.Cells...</code>"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433350469, "post_id": 30625283, "comment_id": 49318250, "body": "What is the output of your code?  An error: &quot;address of this site is not valid&quot; or something else?  How do things look when you step through with the debugger?  There is no obvious reason your code would not work."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "reply_to_user": {"reputation": 283, "user_id": 4801586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PJcwl.png?s=128&g=1", "display_name": "314UnreadEmails", "link": "https://stackoverflow.com/users/4801586/314unreademails"}, "edited": false, "score": 0, "creation_date": 1433350546, "post_id": 30625283, "comment_id": 49318280, "body": "@314UnreadEmails, the given syntax is OK if <code>Rng</code> is a valid <code>Range</code> object (i.e. not <code>Nothing</code>).  You do not need to iterate <code>Cells</code> directly."}], "answers": [{"comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433350321, "post_id": 30625883, "comment_id": 49318169, "body": "Can you explain the why you think <code>Open</code> will work where <code>FollowHyperlink</code> does not?  A quick test on my end shows that <code>Open</code> will not follow a folder path whereas <code>FollowHyperlink</code> will (with a warning).  Also, if it does work, it needs to be <code>Workbooks.Open hL.Value</code> since you are not <code>Setting</code> a variable with that call."}, {"owner": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433350971, "post_id": 30625883, "comment_id": 49318547, "body": "I&#39;ve never really dabbled with FollowHyperlink, but assumed it was geared toward URLs? Workbooks.Open is the standard way I&#39;ve always used to open an excel workbook given a path... Yeah brackets are optional, agreed. I simply think it looks tidier..."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "reply_to_user": {"reputation": 1, "user_id": 4970465, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JakWWxbK1PE/AAAAAAAAAAI/AAAAAAAAAK0/jRP9waC4lC4/photo.jpg?sz=128", "display_name": "Agent_K", "link": "https://stackoverflow.com/users/4970465/agent-k"}, "edited": false, "score": 0, "creation_date": 1433354447, "post_id": 30625883, "comment_id": 49320662, "body": "@Agent_K, can you provide a sample of the text that is in those cells?  I am very surprised that a valid path to a workbook gets handled differently by the two methods."}], "tags": [], "owner": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "is_accepted": false, "score": 0, "last_activity_date": 1433349397, "creation_date": 1433349397, "answer_id": 30625883, "question_id": 30625283, "link": "https://stackoverflow.com/questions/30625283/open-hyperlink-vba/30625883#30625883", "title": "Open Hyperlink VBA", "body": "<p>Rather than using </p>\n\n<pre><code>ThisWorkbook.FollowHyperlink hL.Value\n</code></pre>\n\n<p>try</p>\n\n<pre><code>Workbooks.Open(hL.Value)\n</code></pre>\n\n<p>(Assuming you have the full paths combined with file name in your list.)</p>\n"}], "owner": {"reputation": 1, "user_id": 4970465, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JakWWxbK1PE/AAAAAAAAAAI/AAAAAAAAAK0/jRP9waC4lC4/photo.jpg?sz=128", "display_name": "Agent_K", "link": "https://stackoverflow.com/users/4970465/agent-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1502, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433349397, "creation_date": 1433347605, "last_edit_date": 1433347900, "question_id": 30625283, "link": "https://stackoverflow.com/questions/30625283/open-hyperlink-vba", "title": "Open Hyperlink VBA", "body": "<p><strong>Objective:</strong> open 4 excel workbooks from specific directory paths, which are listed in the \"macros\" tab, range \"C2:C5\"</p>\n\n<p><strong>Issue:</strong> I've recently started using VBA.  Code gets through testing until \"ThisWorkbook.FollowHyperlink hL.Value\"</p>\n\n<p><strong>Question:</strong> Where did I go wrong?</p>\n\n<p>Thanks for any comments</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Sub Update1()\n\n    Dim Sh As Worksheet\n    Dim Rng As Range\n    Dim hL As Range\n\n    Set Sh = Worksheets(\"macros\")\n    With Sh\n        Set Rng = .Range(\"C2:C\" &amp; .Cells(.Rows.Count, \"C\").End(xlUp).Row)\n    End With\n    For Each hL In Rng\n        ThisWorkbook.FollowHyperlink hL.Value\n    Next hL\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "powerpoint"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 2, "creation_date": 1433348652, "post_id": 30625244, "comment_id": 49317188, "body": "Welcome to SO! <b>1)</b> Remove <code>On Error Resume Next</code> - that will take any error message and throw it away as if it never happened. There&#39;s no telling what&#39;s going on with that in there. <b>2)</b> Is there something that you&#39;re expecting it to do that it&#39;s not? i.e. Is this functional code that you&#39;d like to make better, or is there something broken?  If there&#39;s something not working, you&#39;ll get a better response if you say <i>what</i> isn&#39;t working."}, {"owner": {"reputation": 260, "user_id": 4162534, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ej0su.jpg?s=128&g=1", "display_name": "Yogwhatup", "link": "https://stackoverflow.com/users/4162534/yogwhatup"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1433349635, "post_id": 30625244, "comment_id": 49317761, "body": "Thanks for the edits (looks nice).  The code isn&#39;t working as intended.  1)It does not populate the title on every slide. 2)It does not automatically stop when it reaches the last row in my worksheet.3.)It does not resize what is pasted in the ppt.  This is a edit from an existing code font floating around the internet.  All I can think of is a fixed loop, but that wouldnt do what I would want it to do."}, {"owner": {"reputation": 457, "user_id": 4515125, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh3.googleusercontent.com/-rCNR0REYrms/AAAAAAAAAAI/AAAAAAAAABA/doHrukMdDwA/photo.jpg?sz=128", "display_name": "Christine Ross", "link": "https://stackoverflow.com/users/4515125/christine-ross"}, "edited": false, "score": 0, "creation_date": 1433362277, "post_id": 30625244, "comment_id": 49325237, "body": "Since ppt 2003 the slides object has a method &quot;addslide&quot;, not &quot;add&quot;. I don&#39;t know what this chganges <a href=\"https://msdn.microsoft.com/EN-US/library/ff746586.aspx\" rel=\"nofollow noreferrer\">ppt Object Model</a>. When you use activesheet, activeworkbook, activewindow etc. make sure that you refer to the object you really want. A better way is to use the index or name (by the way you try to give all slides the same name). I would recommend instead of &quot;PowerPointApp.ActiveWindow.View.GotoSlide (1)&quot; to use &quot;Powerpointapp.slides(1)&quot;"}, {"owner": {"reputation": 260, "user_id": 4162534, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ej0su.jpg?s=128&g=1", "display_name": "Yogwhatup", "link": "https://stackoverflow.com/users/4162534/yogwhatup"}, "edited": false, "score": 0, "creation_date": 1433363737, "post_id": 30625244, "comment_id": 49326072, "body": "This code is just a rather lame attempt in showing what I am trying to do.  I just want to copy all the rows on one worksheet over to a powerpoint.  I want to continue to build on the slides until the data runs out.  Have been working on this all day and cannot figure it out :("}, {"owner": {"reputation": 457, "user_id": 4515125, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh3.googleusercontent.com/-rCNR0REYrms/AAAAAAAAAAI/AAAAAAAAABA/doHrukMdDwA/photo.jpg?sz=128", "display_name": "Christine Ross", "link": "https://stackoverflow.com/users/4515125/christine-ross"}, "edited": false, "score": 0, "creation_date": 1433417866, "post_id": 30625244, "comment_id": 49349659, "body": "@Yogwhatup; please use the @christineross, so I wil be informed about your response; What I don&#39;t understand: The Excel Range &quot;B1:K23&quot; should be placed on one  slide or divided over 6 slides? If Yes, it should be divided in chunks and you shouldn&#39;t copy it at once. If it should be done automatic you need a rule how split in chunks; line by line, named blocks or whatever. Unfortunately there is no macro recorder available in powerpoint. So I would recommend that you write down in plain language what you want to do step by step and then try to use vba"}, {"owner": {"reputation": 260, "user_id": 4162534, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ej0su.jpg?s=128&g=1", "display_name": "Yogwhatup", "link": "https://stackoverflow.com/users/4162534/yogwhatup"}, "reply_to_user": {"reputation": 457, "user_id": 4515125, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh3.googleusercontent.com/-rCNR0REYrms/AAAAAAAAAAI/AAAAAAAAABA/doHrukMdDwA/photo.jpg?sz=128", "display_name": "Christine Ross", "link": "https://stackoverflow.com/users/4515125/christine-ross"}, "edited": false, "score": 0, "creation_date": 1433425536, "post_id": 30625244, "comment_id": 49354921, "body": "@christineross All I am really trying to do is copy all of the rows in a worksheet over to a powerpoint.  I want to let the code run so it copies and pastes the rows into as many PPT slides as necessary, then stop."}, {"owner": {"reputation": 260, "user_id": 4162534, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ej0su.jpg?s=128&g=1", "display_name": "Yogwhatup", "link": "https://stackoverflow.com/users/4162534/yogwhatup"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1433425539, "post_id": 30625244, "comment_id": 49354922, "body": "@FreeMan have you seen this anywhere?  I cannot be the only one that has requested this, however I can&#39;t find the answer anywhere on the net."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1433426427, "post_id": 30625244, "comment_id": 49355558, "body": "I&#39;m am doing something similar, but I have a PPT slide that is manually set up to <code>LINK</code> to the XLS. I copy the slide, then update the link to point to where I want it. Not sure, though, exactly how this will work for you, since I&#39;m putting on predefined charts, not unknown numbers of rows of data. You may want to look into that, though. Unfortunately, MS, in their infinite wisdom, decided there was no need for a macro recorder in PPT, so it makes it vital to learn the docs/object model."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1433426534, "post_id": 30625244, "comment_id": 49355643, "body": "By <code>LINK</code> I mean: 1) copy in XLS, 2) in PPT, click Paste drop down, 3) Special, 4) Link (in PPT2010). This way you have a live link to your XLS sheet. Once there, the link source can be modified on what it points to. You&#39;d have to play with that to figure out how to make it point at a new set of rows."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1433433323, "post_id": 30625244, "comment_id": 49360748, "body": "This doesn&#39;t do exactly what you&#39;re after, but it may demonstrate a few techniques that&#39;ll help (disclaimer: PPTFAQ is my site, though the code in the example is from a few colleagues of mine, published there with their permission)  <a href=\"http://www.pptfaq.com/FAQ00892_Using_Excel_and_Access_data_in_PowerPoint_Tables_-by_Brian_Reilly_and_Naresh_Nichani-.htm\" rel=\"nofollow noreferrer\">pptfaq.com/&hellip;</a>"}, {"owner": {"reputation": 260, "user_id": 4162534, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ej0su.jpg?s=128&g=1", "display_name": "Yogwhatup", "link": "https://stackoverflow.com/users/4162534/yogwhatup"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1433437203, "post_id": 30625244, "comment_id": 49363104, "body": "@FreeMan Can you fwd any bit of code that may help?  Deadline is closing in on me and I have nothing for this portion of my code :(  I have gone to the end of the internet!  Nothing."}, {"owner": {"reputation": 260, "user_id": 4162534, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ej0su.jpg?s=128&g=1", "display_name": "Yogwhatup", "link": "https://stackoverflow.com/users/4162534/yogwhatup"}, "edited": false, "score": 0, "creation_date": 1433517146, "post_id": 30625244, "comment_id": 49402204, "body": "This was another suggestion, but I dont know how to incorporate! I suggest you post this question on an Excel forum as I unfortunately don&#39;t have the bandwidth to solve situational problems currently. Let&#39;s say you can fit 100 rows on a slide, I would suspect your logic would need to look something like this:  For x=1 to 3000/100  &#39;Create new slide  &#39;Loop through each row and paste over  For y = 1 to 100  Row(z).copy then paste  Next y  Next x  Hopefully, that helps give you a general direction. Good Luck!"}], "answers": [{"tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": true, "score": 0, "last_activity_date": 1433507658, "creation_date": 1433507658, "answer_id": 30666708, "question_id": 30625244, "link": "https://stackoverflow.com/questions/30625244/copy-and-paste-rows-from-excel-to-powerpoint/30666708#30666708", "title": "Copy and paste rows from Excel to Powerpoint", "body": "<p>As requested in comments, here is the code I use to copy a slide from a master PPT template to the report PPT.</p>\n\n<p>There is some extraneous code in there to provide status updates on the form we use to drive the process, as well as a debugging flag that I can toggle on/off at run time - these can both be removed.</p>\n\n<p><strong>This will serve as a starting point to finding the proper solution for your situation, and is not a complete answer to the question as asked.</strong></p>\n\n<pre><code>'I've chosen to declare these globally, though it's probably not the best way:\nDim PPTObj As PowerPoint.Application\nDim PPTMaster As PowerPoint.Presentation\nDim PPTClinic As PowerPoint.Presentation\n\n\nPrivate Sub InsertPPT(ByVal SlideName As String, ByVal StatusText As String)\n\nDim Shp As PowerPoint.Shape\nDim Top As Single\nDim Left As Single\nDim Height As Single\nDim width As Single\n\n\n  PPTMaster.Slides(SlideName).Copy\n  PPTClinic.Slides.Paste\n  Form_Master.ProcessStatus.Value = StatusText &amp; \" InsertPPT\"\n  With PPTClinic.Slides(PPTClinic.Slides.count)\n    If Debugging Then\n      .Select\n    End If\n    .Design = PPTMaster.Slides(SlideName).Design              'this ensures we get all the right formatting - only seems to be necessary 1 time, but we'll just do it on all\n    .ColorScheme = PPTMaster.Slides(SlideName).ColorScheme\n    .FollowMasterBackground = PPTMaster.Slides(SlideName).FollowMasterBackground\n    For Each Shp In .Shapes                                                 'loop through all the shapes on the slide\n      If Debugging Then\n'          .Select\n        Shp.Select\n      End If\n      Form_Master.ProcessStatus.Value = StatusText &amp; \" InsertPPT-\" &amp; Shp.Name\n      If Shp.Type = msoLinkedOLEObject Then                                 'when we find a linked one\n        ReLinkShape Shp, TempVars!NewXLName\n        'need to store off top, left, width, height\n        Top = Shp.Top\n        Left = Shp.Left\n        Height = Shp.Height\n        width = Shp.width\n        Shp.LinkFormat.Update                                               'and force the link to refresh\n        MySleep 2, \"S\"                                                      'hopefully, the 2 second pause will allow everything to update properly before moving on.\n        'then reset them here - they seem to change shape when I update them\n        Shp.LockAspectRatio = msoFalse\n        Shp.Top = Top\n        Shp.Left = Left\n        Shp.width = width\n        Shp.Height = Height\n      ElseIf Shp.Name = \"SlideName\" And Not Debugging Then                  'if it's the \"SlideName\" tag\n        Shp.Delete                                                          'delete it (unless we're debugging)\n      End If\n    Next\n  End With\n\n  Form_Master.ProcessStatus.Value = StatusText\n\nEnd Sub\n\nPrivate Sub ReLinkShape(ByRef Shp As PowerPoint.Shape, ByVal NewDestination As String)\n\n  Dim Link() As String\n  Dim link2() As String\n\n  If Shp.Type = msoLinkedOLEObject Then                                 'when we find a linked one\n    Link = Split(Shp.LinkFormat.SourceFullName, \"!\")                    'update the link to point to the new clinic spreadsheet instead of the master\n    If InStr(1, Link(2), \"]\") &gt; 0 Then\n      link2 = Split(Link(2), \"]\")\n      Link(2) = \"[\" &amp; TempVars!ClinicName &amp; \".xlsx]\" &amp; link2(1)\n    End If\n\n    Shp.LinkFormat.SourceFullName = NewDestination &amp; \"!\" &amp; Link(1) &amp; \"!\" &amp; Link(2)\n  End If\n\nEnd Sub\n\nPublic Sub MySleep(ByRef Unit As Double, ByRef UOM As String)\n\nDim Pause As Date\n\n  Pause = DateAdd(UOM, Unit, Now())\n  While Now &lt; Pause\n    DoEvents\n  Wend\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 260, "user_id": 4162534, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ej0su.jpg?s=128&g=1", "display_name": "Yogwhatup", "link": "https://stackoverflow.com/users/4162534/yogwhatup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1389, "favorite_count": 0, "accepted_answer_id": 30666708, "answer_count": 1, "score": 0, "last_activity_date": 1433507658, "creation_date": 1433347482, "last_edit_date": 1433348523, "question_id": 30625244, "link": "https://stackoverflow.com/questions/30625244/copy-and-paste-rows-from-excel-to-powerpoint", "title": "Copy and paste rows from Excel to Powerpoint", "body": "<p>Ok, here is what I am looking for (Im new, so be gentle):</p>\n\n<ul>\n<li>Copy and paste (default format) from excel to powerpoint (from just the one sheet)</li>\n<li>I can only fit so many rows in ppt - so after a slide fills, I want ppt to create a new slide</li>\n<li>Same title for each slide is fine!</li>\n<li>I only need columns B:K copied over</li>\n</ul>\n\n<p>That's it, however I am stuck :(  I know the below code is NOT the best way to write this and it contains errors in which I am sure will be easy to spot. I cannot find how to do this anywhere on the net. </p>\n\n<p>This is what I have so far:</p>\n\n<pre><code>Sub ExcelRangeToPowerPoint()\nDim rng As Excel.Range\nDim PowerPointApp As PowerPoint.Application\nDim myPresentation As PowerPoint.Presentation\nDim mySlide As PowerPoint.Slide\nDim myShapeRange As PowerPoint.Shape\nDim i As Integer\n\n'Create an Instance of PowerPoint\n  On Error Resume Next\n\n'Is PowerPoint already opened?\n  Set PowerPointApp = GetObject(class:=\"PowerPoint.Application\")\n\n'Clear the error between errors\n  Err.Clear\n\n'If PowerPoint is not already open then open PowerPoint\n  If PowerPointApp Is Nothing Then Set PowerPointApp = CreateObject(class:=\"PowerPoint.Application\")\n\n'Make PowerPoint Visible and Active\n  PowerPointApp.Visible = True\n  PowerPointApp.Activate\n\n'Create a New Presentation\n  Set myPresentation = PowerPointApp.Presentations.Add\n\n'Add a slide to the Presentation\n  Set mySlide = myPresentation.Slides.Add(1, ppLayoutTitleOnly)\n\n For i = 1 To 6\n  'need to set focus to slde 1\n   PowerPointApp.ActiveWindow.View.GotoSlide (1)\n\n  'Deletes Title\n  'mySlide.Shapes.Title.Delete\n\n  'builds new title\n  mySlide.Shapes.AddShape Type:=msoShapeRectangle, left:=9, Top:=6, Width:=702, Height:=30\n  mySlide.Shapes(mySlide.Shapes.Count).Line.Visible = msoTrue\n  mySlide.Shapes(mySlide.Shapes.Count).TextFrame.TextRange.Font.Size = 20\n  mySlide.Shapes(mySlide.Shapes.Count).TextFrame.TextRange.Font.Color.RGB = RGB(0, 0, 0)\n  mySlide.Shapes(mySlide.Shapes.Count).TextFrame.TextRange.ParagraphFormat.Alignment = ppAlignLeft\n  mySlide.Shapes(mySlide.Shapes.Count).TextFrame.TextRange.Text = \"Current Full Initiative Details \u2013 Branded Book as of \" &amp; Date\n  mySlide.Shapes(mySlide.Shapes.Count).Name = \"I am TITLE\"\n  mySlide.Shapes(mySlide.Shapes.Count).Line.ForeColor.RGB = RGB(0, 0, 0)\n  mySlide.Shapes(mySlide.Shapes.Count).Line.Weight = 1\n  mySlide.Shapes(mySlide.Shapes.Count).Fill.Visible = msoTrue\n  mySlide.Shapes(mySlide.Shapes.Count).Fill.ForeColor.RGB = RGB(255, 255, 255)\n\n  'Copy Range from Excel\n  Set rng = ActiveWorkbook.Worksheets(\"RAW\").Range(\"B1:K23\")\n\n  'Copy Excel Range\n  rng.Copy\n\n  'Paste to PowerPoint and position\n  PowerPointApp.ActiveWindow.View.PasteSpecial DataType:=ppPasteDefault\n\n  Set myShapeRange = mySlide.Shapes(mySlide.Shapes.Count)\n\n  'Set position:\n  myShapeRange.left = 10\n  myShapeRange.Top = 42\n  myShapeRange.Height = 492\n  myShapeRange.Width = 702\n\n  ActiveWorkbook.Sheets(\"RAW\").Rows(\"2:23\").Delete\n\n  Call myPresentation.Slides.Add(1, PpSlideLayout.ppLayoutTitleOnly)\n\n  'Clear The Clipboard\n  Application.CutCopyMode = False\n\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "fso"], "comments": [{"owner": {"reputation": 2595, "user_id": 3897316, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6cf468fea626f3aec65a199e2f67b309?s=128&d=identicon&r=PG&f=1", "display_name": "Degustaf", "link": "https://stackoverflow.com/users/3897316/degustaf"}, "edited": false, "score": 0, "creation_date": 1433347879, "post_id": 30625149, "comment_id": 49316740, "body": "Do you have some sort of error handler running that could suppress the error?"}, {"owner": {"reputation": 705, "user_id": 4163002, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/30e77d3fa90ca3c96cf94a3fca4614ee?s=128&d=identicon&r=PG&f=1", "display_name": "ZX9", "link": "https://stackoverflow.com/users/4163002/zx9"}, "reply_to_user": {"reputation": 2595, "user_id": 3897316, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6cf468fea626f3aec65a199e2f67b309?s=128&d=identicon&r=PG&f=1", "display_name": "Degustaf", "link": "https://stackoverflow.com/users/3897316/degustaf"}, "edited": false, "score": 0, "creation_date": 1433348015, "post_id": 30625149, "comment_id": 49316809, "body": "Good question! Unfortunately, it looks like I&#39;ve actually neglected to put in an error handler into that sub as of yet."}, {"owner": {"reputation": 2595, "user_id": 3897316, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6cf468fea626f3aec65a199e2f67b309?s=128&d=identicon&r=PG&f=1", "display_name": "Degustaf", "link": "https://stackoverflow.com/users/3897316/degustaf"}, "edited": false, "score": 0, "creation_date": 1433348101, "post_id": 30625149, "comment_id": 49316865, "body": "Error handlers do propagate.  So if you have one further up the call stack it could be catching this error."}, {"owner": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "edited": false, "score": 2, "creation_date": 1433348115, "post_id": 30625149, "comment_id": 49316873, "body": "so, is an error handler from a calling sub suppressing the error? remember that vba will go back up the calling tree until it finds an error handler to use. Only if there are no error handlers will it then produce an error. I would suggest putting <code>On Error Goto 0</code> in the routine to see if an error actually occurs"}, {"owner": {"reputation": 705, "user_id": 4163002, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/30e77d3fa90ca3c96cf94a3fca4614ee?s=128&d=identicon&r=PG&f=1", "display_name": "ZX9", "link": "https://stackoverflow.com/users/4163002/zx9"}, "edited": false, "score": 0, "creation_date": 1433424308, "post_id": 30625149, "comment_id": 49354023, "body": "I&#39;ve updated the question. <code>On Error Goto 0</code> does not provide an error."}], "answers": [{"tags": [], "owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "is_accepted": true, "score": 1, "last_activity_date": 1437682105, "last_edit_date": 1437682105, "creation_date": 1437598466, "answer_id": 31573808, "question_id": 30625149, "link": "https://stackoverflow.com/questions/30625149/deletefolder-method-of-filesystemobject-does-not-give-an-error-msdn-lied-to-me/31573808#31573808", "title": "DeleteFolder method of FileSystemObject Does Not Give an Error (MSDN lied to me)", "body": "<p>This behavior is not limited to .ZIP files (which is what Compressed Folders really are). What is interesting is that the <code>DeleteFile</code> method will not throw an error when attempting to delete an existing folder, and the <code>DeleteFolder</code> method does not error when attempting to delete an existing file. The only way I got the to error was by specifying a non-existent file/folder name.</p>\n\n<hr>\n\n<p>Yes, it appears MSDN is wrong. Try this:</p>\n\n<pre><code>Sub IO_Error()\n    Dim objFSO As FileSystemObject\n    Dim strTempDir As String\n\n    Set objFSO = New FileSystemObject\n    strTempDir = Environ(\"Temp\")\n    Debug.Print strTempDir &amp; \"\\IO Test\"\n    objFSO.CreateFolder strTempDir &amp; \"\\IO Test\"\n    objFSO.CreateTextFile strTempDir &amp; \"\\IO Test\\IO Test.txt\", True\n\n    objFSO.DeleteFolder strTempDir &amp; \"\\IO Test\\IO Test.txt\", True   'No errors\n    objFSO.DeleteFile strTempDir &amp; \"\\IO Test\", True                 'No errors\n    objFSO.DeleteFile strTempDir &amp; \"\\IO Test\\\", True                'File not found error\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 705, "user_id": 4163002, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/30e77d3fa90ca3c96cf94a3fca4614ee?s=128&d=identicon&r=PG&f=1", "display_name": "ZX9", "link": "https://stackoverflow.com/users/4163002/zx9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 808, "favorite_count": 0, "accepted_answer_id": 31573808, "answer_count": 1, "score": 2, "last_activity_date": 1439489027, "creation_date": 1433347193, "last_edit_date": 1439489027, "question_id": 30625149, "link": "https://stackoverflow.com/questions/30625149/deletefolder-method-of-filesystemobject-does-not-give-an-error-msdn-lied-to-me", "title": "DeleteFolder method of FileSystemObject Does Not Give an Error (MSDN lied to me)", "body": "<p>I have a couple folders on my desktop which I used temporarily for a macro. Now, I want to delete them. One is a .zip and one is a regular folder.</p>\n\n<pre><code>Set fso = CreateObject(\"scripting.filesystemobject\")\nfso.DeleteFolder unzipPath, True\n</code></pre>\n\n<p>The above code works without error. The non-.zip folder is deleted without issues. This, however, does not remove the file:</p>\n\n<pre><code>On Error GoTo 0\nfso.DeleteFolder zipPath, True\n</code></pre>\n\n<p>Contrary to the <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264112.aspx\" rel=\"nofollow\">MSDN documentation</a>, this does not create an error, either. After far too much time, I realized I simply needed to use <code>DeleteFile</code> for the .zip, <strong>since apparently a .zip is technically a file</strong>, rather than a folder. Then both items are deleted successfully.</p>\n\n<p>It works now, but I'm still a bit confused as to why using <code>DeleteFolder</code> did not produce an error, though. The aforementioned documentation specifies</p>\n\n<blockquote>\n  <p>An error occurs if no matching folders are found.</p>\n</blockquote>\n\n<p><strong>UPDATE</strong>: For the sake of testing, I created a standalone sub exclusively to test the <code>DeleteFolder</code> on a .zip. The .zip is unchanged; there is no error returned; the sub just ends.</p>\n\n<p>Just a curious soul wandering the realms of VBA...</p>\n"}, {"tags": ["vba", "excel", "combobox"], "comments": [{"owner": {"reputation": 1, "user_id": 4826732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ce059f813b1f38804cace40722b67c3?s=128&d=identicon&r=PG&f=1", "display_name": "automateit", "link": "https://stackoverflow.com/users/4826732/automateit"}, "edited": false, "score": 0, "creation_date": 1433346903, "post_id": 30625003, "comment_id": 49316100, "body": "I forgot to mention that the Userform is in a separate workbook from the files I want to run the VLookup on"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4826732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ce059f813b1f38804cace40722b67c3?s=128&d=identicon&r=PG&f=1", "display_name": "automateit", "link": "https://stackoverflow.com/users/4826732/automateit"}, "edited": false, "score": 0, "creation_date": 1433354965, "post_id": 30625186, "comment_id": 49320980, "body": "AnalystCave.com Thank you very much for responding. Do you understand what I am trying to do? What do you mean by I am looping through Action Codes but no using the Cell Variable. Essentially the Workbook from Combobox 2 is an upload template generated by the contract management system I am using to allow changes (price, rebates) to be made to the items. So I am trying to pull all the relevant data (Action Codes, Rebate Values, Rebate Type) into the template from the worksheet which is the Combobox3 value/selection."}], "tags": [], "owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "is_accepted": false, "score": 0, "last_activity_date": 1433347303, "creation_date": 1433347303, "answer_id": 30625186, "question_id": 30625003, "link": "https://stackoverflow.com/questions/30625003/vba-vlookup-between-two-workbooks/30625186#30625186", "title": "VBA: VLookup between two workbooks", "body": "<p>Not sure this is your issue but this piece of code does not make sense:</p>\n\n<pre><code>For Each Cell In ACD_ActionCode\n    ActionCode = Application.WorksheetFunction.VLookup(SCC, LookUp_Range, 17, False)\nNext Cell\n</code></pre>\n\n<p>You are looping through the Action Codes but not using the <code>Cell</code> variable</p>\n"}], "owner": {"reputation": 1, "user_id": 4826732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ce059f813b1f38804cace40722b67c3?s=128&d=identicon&r=PG&f=1", "display_name": "automateit", "link": "https://stackoverflow.com/users/4826732/automateit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1093, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1483980766, "creation_date": 1433346812, "last_edit_date": 1483980766, "question_id": 30625003, "link": "https://stackoverflow.com/questions/30625003/vba-vlookup-between-two-workbooks", "title": "VBA: VLookup between two workbooks", "body": "<p>I am wondering if someone can help me out. I created a Userform with 3 comboboxes. Combobox 1 and 2 list all open workbooks. Combobox 3 lists the worksheets from Combobox 2. I now want to run a Vlookup. The lookup values are the values (in this case product codes) in each cell beginning at D9 to the last cell with a value in Column D of the first Worksheet of Combobox2's. The lookup range will be (\"A5:S###\"[number of rows varies depending on the file]\"). \nThe Vlookup formula should be in the Column I of the first Worksheet of Combobox2's value starting at \"I9\" looping through each cell in I9 until all the Codes in D9 are looked up. \nI keep getting error the major one being \u201cRuntime-error '9'\u201d: Subscript out of range. Here is my code.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CancelButton_Click()\n    Stopped = True\n    Unload Me\nEnd Sub\n\nPrivate Sub ComboBox1_Change()\nDim ScheduleA As Workbook\nDim Termset As Worksheet\nSet ScheduleA = Workbooks(Me.ComboBox1.Value)\n  With Me.ComboBox3\n  For Each Termset In ScheduleA.Worksheets\n            .AddItem Termset.Name\n    Next Termset\n    End With\nEnd Sub\n\n\nPrivate Sub FillACDButton_Click()\n    Dim ACDRebateInfo As Worksheet\n    Dim lastRow As Long\n    Dim NewRebate As Single\n    Dim NewRebateType As String\n    Dim LookUp_Range As Range\n    Dim ActionCode As String\n    Dim ACD_NewRebate As Range\n    Dim ACD_NewRebateType As Range\n    Dim ACD_ActionCode As Range\n    Dim SCC As Range\n    Dim Cell As Range\n    Set ACDRebateInfo = Workbooks(Me.ComboBox2.Value).Worksheets(1)\n    Set ACD_NewRebate = ACDRebateInfo.Range(\"I9:I500\")\n    Set ACD_NewRebateType = ACDRebateInfo.Range(\"J9:J500\")\n    Set ACD_ActionCode = ACDRebateInfo.Range(\"B9:B500\")\n    Set LookUp_Range = Worksheets(Me.ComboBox3.Value).Range(\"A5:S400\")\n    Set SCC = ACDRebateInfo.Range(\"D9:D230\")\n    With ACDRebateInfo\n    For Each Cell In ACD_ActionCode\n    ActionCode = Application.WorksheetFunction.VLookup(SCC, LookUp_Range, 17, False)\n    Next Cell\n    End With\n    Unload Me\nEnd Sub\n\n\n\nPrivate Sub UserForm_Initialize()\n    Dim wkb As Workbook\n        For Each wkb In Application.Workbooks\n            Me.ComboBox1.AddItem wkb.Name\n            Me.ComboBox2.AddItem wkb.Name\n    Next wkb\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 153, "user_id": 4847484, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ffbe465422ceecf17a59ba1d46a0e22b?s=128&d=identicon&r=PG&f=1", "display_name": "Federico Sanchez", "link": "https://stackoverflow.com/users/4847484/federico-sanchez"}, "edited": false, "score": 0, "creation_date": 1433346643, "post_id": 30624743, "comment_id": 49315911, "body": "have you tried using the conditional formatting ?"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1433348356, "creation_date": 1433348356, "answer_id": 30625553, "question_id": 30624743, "link": "https://stackoverflow.com/questions/30624743/excel-how-do-i-return-a-color-in-a-cell-based-on-no-value-in-a-different-cell/30625553#30625553", "title": "Excel - How do I return a color in a cell based on no value in a different cell?", "body": "<p>Say we wanted cell <strong>B1</strong> to turn yellow if cell <strong>A1</strong> is empty.  We can use conditional formatting.  Here is a short macro to set that up:</p>\n\n<pre><code>Sub Macro2()\n    With Range(\"B1\")\n      .FormatConditions.Add Type:=xlExpression, Formula1:=\"=ISBLANK(A1)\"\n         .FormatConditions(.FormatConditions.Count).SetFirstPriority\n      With .FormatConditions(1).Interior\n          .PatternColorIndex = xlAutomatic\n          .Color = 65535\n          .TintAndShade = 0\n      End With\n      .FormatConditions(1).StopIfTrue = False\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 4624326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86628db42a413f96b777de4535065552?s=128&d=identicon&r=PG&f=1", "display_name": "shibboleth", "link": "https://stackoverflow.com/users/4624326/shibboleth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 30625553, "answer_count": 1, "score": 0, "last_activity_date": 1442277293, "creation_date": 1433346084, "last_edit_date": 1531161705, "question_id": 30624743, "link": "https://stackoverflow.com/questions/30624743/excel-how-do-i-return-a-color-in-a-cell-based-on-no-value-in-a-different-cell", "title": "Excel - How do I return a color in a cell based on no value in a different cell?", "body": "<p>I am trying to create a rule in Excel to change the color of one cell based on an empty value in a different cell on the same sheet.</p>\n\n<p>The basic premise is having the color change based on the tardiness of an assignment. Some of the assignments haven't been started yet, so they shouldn't be the same color has ones that are late or on time. I know it would be easiest to just add some value like \"NULL\" to the empty cells, but everyone on the team is used to the cells being empty so I'd prefer to leave it that way.</p>\n"}, {"tags": ["arrays", "vba", "excel", "copy"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1433348312, "post_id": 30624677, "comment_id": 49316985, "body": "It&#39;s not really clear what you&#39;re trying to do. Seems overcomplicated, that you would have a 5x nested <code>For</code> loop. Have you stepped through the code using F8 to manually walk through the process and see where it&#39;s diverging from your expectations? If not, that should be your very first step in debugging."}, {"owner": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "edited": false, "score": 0, "creation_date": 1433348975, "post_id": 30624677, "comment_id": 49317381, "body": "my answer <a href=\"http://stackoverflow.com/questions/14035772/how-to-assign-an-excel-range-to-a-2d-array/14060707#14060707\">here</a> should help you in copying a range to and from an array."}], "answers": [{"tags": [], "owner": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "is_accepted": false, "score": 0, "last_activity_date": 1433350267, "creation_date": 1433350267, "answer_id": 30626143, "question_id": 30624677, "link": "https://stackoverflow.com/questions/30624677/array-for-copying/30626143#30626143", "title": "Array for copying", "body": "<p>As Zemens mentioned, you've really overcomplicated this one! To copy across an array, you only need as many for loops as there are dimensions in the array. So two in this case! I've used some simple arithmetic to translate from the one sheet to the other. It might not be perfect but will hopefully get you started!</p>\n\n<pre><code>Dim intRowLoop As Integer, intColLoop As Integer\n\nFor intRowLoop = tostart To toend\n    For intColLoop = 1 To 2\n        Sheets(\"blad2\").Cells(intRowLoop, intColLoop).Value = _\n            Sheets(\"blad1\").Cells(12 + ((intRowLoop - tostart) * 2), fromW * 26).Value\n    Next intColLoop\nNext intRowLoop\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 113, "user_id": 4970358, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-K-1M6QrXyzM/AAAAAAAAAAI/AAAAAAAAACo/Y6JauTceIx4/photo.jpg?sz=128", "display_name": "Durielblood", "link": "https://stackoverflow.com/users/4970358/durielblood"}, "is_accepted": false, "score": 0, "last_activity_date": 1433786172, "creation_date": 1433786172, "answer_id": 30715933, "question_id": 30624677, "link": "https://stackoverflow.com/questions/30624677/array-for-copying/30715933#30715933", "title": "Array for copying", "body": "<p>In the end I went with;</p>\n\n<p>(the sheetnames are diffrent as the one above was a test to get it working)</p>\n\n<p>(yust took the important bit)</p>\n\n<pre><code>For ToH = tostart To toend Step 2\nFor ToW = 2 To 8 Step 6\n        Sheets(\"factuur2\").Cells(ToH, ToW).Value = _\n        Sheets(\"multiprijs\").Cells(FromH, FromW).Value\n    FromW = 28\nNext ToW\nFromH = FromH + 2\nToW = 2\nFromW = 5\nNext ToH\n</code></pre>\n\n<p>However the problem I have with this method is that the \"width\" variables here can only hold 2 values as is;</p>\n\n<pre><code>Width + something 'or\nWidth to something 'at a regular interval\n</code></pre>\n\n<p>What I would like, to make this future-proof is width; 1 , 3 , 5 , 19 , anything</p>\n\n<p>for both the from-and-to width</p>\n\n<p>Ty both for helping me get this right though :)</p>\n"}], "owner": {"reputation": 113, "user_id": 4970358, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-K-1M6QrXyzM/AAAAAAAAAAI/AAAAAAAAACo/Y6JauTceIx4/photo.jpg?sz=128", "display_name": "Durielblood", "link": "https://stackoverflow.com/users/4970358/durielblood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1453606223, "creation_date": 1433345871, "last_edit_date": 1531164843, "question_id": 30624677, "link": "https://stackoverflow.com/questions/30624677/array-for-copying", "title": "Array for copying", "body": "<p>I need to copy data, but since the amount of data that needs copying is going to be pretty large, and filled in by hand, I would like to do that by using a macro.</p>\n\n<p>I can't understand how Arrays work.</p>\n\n<p>This gives me the right amount of copies, but only of the very last cell I need copied.</p>\n\n<pre><code>Sub copyer()\n\nDim fromH As Integer    'fromheight\nDim fromW As Integer    'fromwidth\n\nDim toH As Integer      'to height\nDim toW As Integer      'to width\n\nDim counter As Integer\ncounter = Worksheets(\"blad1\").Range(\"D3\").Value 'amount of filled-in data lines to copy\n\nDim Times As Integer    'number of times to run the loop, depending on the filled in data\nTimes = counter + 1\n\nDim tostart As Integer  'location where to start placing the data\n                        'depending on how much data is already present\nDim toend As Integer    'location up to where to place\n\ntostart = Sheets(\"blad2\").Range(\"L1\").Value + 1 '(+2 if theres a header)\ntoend = tostart + counter\n\nDim Copy As Integer\n\nFor Copy = 1 To Times\nFor toH = tostart To toend\n    For toW = 1 To 2\n        For fromH = 12 To 22 Step 2\n            For fromW = 1 To 26 Step 25\n                Sheets(\"blad2\").Cells(toH, toW).Value = _\n                Sheets(\"blad1\").Cells(fromH, fromW).Value\n            Next fromW\n        Next fromH\n    Next toW\nNext toH\nNext Copy\n\n'this macro needs to copy the data\n\n'from blad1\n'from height 12 to 22 (steps of 2)(10 times)\n'from width 1 and 26 (not the cells inbetween)\n\n'to blad2\n'to height depending on the data present (dim tostart)'till height needed (steps of 1)\n'to width 1 and 2\n\n'blad1, D3 holds the input-datacounter\n'blad2, L1 holds the output-datacounter\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "replace", "find"], "comments": [{"owner": {"reputation": 1, "user_id": 4970372, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oMbXr7G0EYw/AAAAAAAAAAI/AAAAAAAAA0c/4raeJvg_dQQ/photo.jpg?sz=128", "display_name": "Everett Mccurdy", "link": "https://stackoverflow.com/users/4970372/everett-mccurdy"}, "edited": false, "score": 0, "creation_date": 1433345729, "post_id": 30624590, "comment_id": 49315258, "body": "I want the values &quot;Fixed Income Research Group&quot; to be replaced with &quot;SS FixedIncomeResearch&quot;  and &quot;Fixed Income Trading Group&quot; to be replaced with &quot;SS FixedIncomeTrading&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4970372, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oMbXr7G0EYw/AAAAAAAAAAI/AAAAAAAAA0c/4raeJvg_dQQ/photo.jpg?sz=128", "display_name": "Everett Mccurdy", "link": "https://stackoverflow.com/users/4970372/everett-mccurdy"}, "edited": false, "score": 0, "creation_date": 1433347825, "post_id": 30625245, "comment_id": 49316704, "body": "This looks great and appears to work but now when I hit CTRL+Q nothing happens.  It only runs when I click on Macros, select the macro and select RUN."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 1, "user_id": 4970372, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oMbXr7G0EYw/AAAAAAAAAAI/AAAAAAAAA0c/4raeJvg_dQQ/photo.jpg?sz=128", "display_name": "Everett Mccurdy", "link": "https://stackoverflow.com/users/4970372/everett-mccurdy"}, "edited": false, "score": 0, "creation_date": 1433348815, "post_id": 30625245, "comment_id": 49317290, "body": "OK so just reaffect the shortcut with another letter and then back again to Q, it might be enough! Is the rest ok? If it is please validate answer to mark your issue as solved."}, {"owner": {"reputation": 1, "user_id": 4970372, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oMbXr7G0EYw/AAAAAAAAAAI/AAAAAAAAA0c/4raeJvg_dQQ/photo.jpg?sz=128", "display_name": "Everett Mccurdy", "link": "https://stackoverflow.com/users/4970372/everett-mccurdy"}, "edited": false, "score": 0, "creation_date": 1433349244, "post_id": 30625245, "comment_id": 49317536, "body": "The rest works great but even after assigning another letter and saving, then going back and reassigning the letter to Q and saving it still doesnt work when I hit CTRL+q.  In fact, nothing happens, no errors nothing"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 1, "user_id": 4970372, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oMbXr7G0EYw/AAAAAAAAAAI/AAAAAAAAA0c/4raeJvg_dQQ/photo.jpg?sz=128", "display_name": "Everett Mccurdy", "link": "https://stackoverflow.com/users/4970372/everett-mccurdy"}, "edited": false, "score": 0, "creation_date": 1433349783, "post_id": 30625245, "comment_id": 49317841, "body": "To be sure just add <code>MsgBox &quot;this is running&quot;</code>  into your code and try again. If nothing happen, then your shortcut is dead, try to close and reopen Excel and otherwise Google has probably an Answer for you!"}, {"owner": {"reputation": 1, "user_id": 4970372, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oMbXr7G0EYw/AAAAAAAAAAI/AAAAAAAAA0c/4raeJvg_dQQ/photo.jpg?sz=128", "display_name": "Everett Mccurdy", "link": "https://stackoverflow.com/users/4970372/everett-mccurdy"}, "edited": false, "score": 0, "creation_date": 1433350144, "post_id": 30625245, "comment_id": 49318058, "body": "Where do I add MsgBox &quot;this is running&quot;? - also I closed and reopened excel and it still doesnt work - corretion, i mean it works when i click the macros button and &quot;run&quot; the macro but not when I click &quot;CTRL+q&quot; anymore"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 1, "user_id": 4970372, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oMbXr7G0EYw/AAAAAAAAAAI/AAAAAAAAA0c/4raeJvg_dQQ/photo.jpg?sz=128", "display_name": "Everett Mccurdy", "link": "https://stackoverflow.com/users/4970372/everett-mccurdy"}, "edited": false, "score": 0, "creation_date": 1433353879, "post_id": 30625245, "comment_id": 49320315, "body": "Place it in any line of your code it doesn&#39;t really matter, at the start would be OK. For the shortcut, no clue why it disappeared ..."}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1433347482, "creation_date": 1433347482, "answer_id": 30625245, "question_id": 30624590, "link": "https://stackoverflow.com/questions/30624590/excel-2010-macros/30625245#30625245", "title": "Excel 2010 Macros", "body": "<p>Here is your code (a bit more cleaner without the <code>.Select</code>) :</p>\n\n<pre><code>Sub Macro2()\n'\n' Macro2 Macro\n'\n' Keyboard Shortcut: Ctrl+q\n'\n    Range(\"E2:CL6\").Copy\n    Range(\"A11\").PasteSpecial Paste:=xlPasteAll, _\n                                Operation:=xlNone, _\n                                SkipBlanks:=False, _\n                                Transpose:=True\n\n    x = 1\n    Do While Cells(11, x) &lt;&gt; \"\"\n        Set Rng = Range(Cells(11, x), Cells(11, x).End(xlDown))\n        For Each cell In Rng\n            cell.Value = CStr(cell.Value &amp; \",\")\n            cell.Value = Replace(cell.Value, \"Fixed Income Research Group\", \"SS FixedIncomeResearch\")\n            cell.Value = Replace(cell.Value, \"Fixed Income Trading Group\", \"SS FixedIncomeTrading\")\n        Next\n        x = x + 1\n    Loop\n    Application.CutCopyMode = False\n    Columns(\"B:B\").Insert Shift:=xlToRight, _\n                            CopyOrigin:=xlFormatFromLeftOrAbove\n    Columns(\"B:B\").Insert Shift:=xlToRight, _\n                            CopyOrigin:=xlFormatFromLeftOrAbove\n\n    Cells.EntireColumn.AutoFit\n    Range(\"B1\").FormulaR1C1 = \"user id\"\n    Range(\"C1\").FormulaR1C1 = \"Pin\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4970372, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oMbXr7G0EYw/AAAAAAAAAAI/AAAAAAAAA0c/4raeJvg_dQQ/photo.jpg?sz=128", "display_name": "Everett Mccurdy", "link": "https://stackoverflow.com/users/4970372/everett-mccurdy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433347482, "creation_date": 1433345653, "last_edit_date": 1433346422, "question_id": 30624590, "link": "https://stackoverflow.com/questions/30624590/excel-2010-macros", "title": "Excel 2010 Macros", "body": "<p>I work with excel 2010 and have created a macro to copy a row of text data, transpose it into a column and then add commas after each value.  Now I want the same macro to also find a pre-determined value in the column and replace it with another pre-determined value.  Here is what I have so far...</p>\n\n<pre><code>Sub Macro2()\n'\n' Macro2 Macro\n'\n' Keyboard Shortcut: Ctrl+q\n'\n    Range(\"E2:CL6\").Select\n    Selection.Copy\n    Range(\"A11\").Select\n    Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n        False, Transpose:=True\n    x = 1\n    Do While Cells(11, x) &lt;&gt; \"\"\n        Cells(11, x).Select\n        Set Rng = Range(Selection, Selection.End(xlDown))\n        For Each cell In Rng\n         cell.Value = cell.Value + \",\"\n        Next\n        x = x + 1\n    Loop\n    Application.CutCopyMode = False\n    Columns(\"B:B\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    Cells.Select\n    Cells.EntireColumn.AutoFit\n    Range(\"B1\").Select\n    ActiveCell.FormulaR1C1 = \"user id\"\n    Range(\"C1\").Select\n    ActiveCell.FormulaR1C1 = \"Pin\"\n    Range(\"B2\").Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "textbox"], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 4642154, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ff60da4b8ac4053f625557903554972b?s=128&d=identicon&r=PG&f=1", "display_name": "HelloWor1d", "link": "https://stackoverflow.com/users/4642154/hellowor1d"}, "edited": false, "score": 0, "creation_date": 1433347721, "post_id": 30625116, "comment_id": 49316627, "body": "Is it correct to select the text box, go to view code, and paste this in? I tried your code above and it now just gives me the object required error... Thanks again @R3uK"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 63, "user_id": 4642154, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ff60da4b8ac4053f625557903554972b?s=128&d=identicon&r=PG&f=1", "display_name": "HelloWor1d", "link": "https://stackoverflow.com/users/4642154/hellowor1d"}, "edited": false, "score": 0, "creation_date": 1433348949, "post_id": 30625116, "comment_id": 49317368, "body": "So it isn&#39;t in a UserForm? It is an ActiveX control?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 63, "user_id": 4642154, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ff60da4b8ac4053f625557903554972b?s=128&d=identicon&r=PG&f=1", "display_name": "HelloWor1d", "link": "https://stackoverflow.com/users/4642154/hellowor1d"}, "edited": false, "score": 0, "creation_date": 1433349546, "post_id": 30625116, "comment_id": 49317712, "body": "It most probably is, so take a look at the edit and change <code>SheetName</code> to your actual Sheet&#39;s name and this should work"}, {"owner": {"reputation": 63, "user_id": 4642154, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ff60da4b8ac4053f625557903554972b?s=128&d=identicon&r=PG&f=1", "display_name": "HelloWor1d", "link": "https://stackoverflow.com/users/4642154/hellowor1d"}, "edited": false, "score": 0, "creation_date": 1433350678, "post_id": 30625116, "comment_id": 49318348, "body": "The first code that you gave me was working when I changed it to an active X control text box. However, I can&#39;t link the value from another cell with active X, so it would be best to make it work with a regular text box. With the new code, it says object doesn&#39;t support this property or method"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 63, "user_id": 4642154, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ff60da4b8ac4053f625557903554972b?s=128&d=identicon&r=PG&f=1", "display_name": "HelloWor1d", "link": "https://stackoverflow.com/users/4642154/hellowor1d"}, "edited": false, "score": 0, "creation_date": 1433407167, "post_id": 30625116, "comment_id": 49342332, "body": "Ok this must be working because the previous code where for the others kind of TextBox, so this is the one! :)"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1433407112, "last_edit_date": 1433407112, "creation_date": 1433347088, "answer_id": 30625116, "question_id": 30624544, "link": "https://stackoverflow.com/questions/30624544/excel-change-text-box-color-based-on-value/30625116#30625116", "title": "Excel change text box color based on value", "body": "<p>This should help you :</p>\n\n<pre><code>Private Sub TextBox1_Change()\n\n    With Sheets(\"Sheet3\").OLEObjects(\"TextBox1\").Object\n        Select Case .Value\n            Case Is = vbNullString 'same as \"\"\n                .BackColor = RGB(0, 0, 0)\n            Case Is = 1\n                .BackColor = RGB(255, 0, 0)\n            Case Is = 2\n                .BackColor = RGB(0, 255, 0)\n            Case Is = 3\n                .BackColor = RGB(0, 0, 255)\n            Case Else\n                .BackColor = RGB(126, 126, 126)\n        End Select\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 63, "user_id": 4642154, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ff60da4b8ac4053f625557903554972b?s=128&d=identicon&r=PG&f=1", "display_name": "HelloWor1d", "link": "https://stackoverflow.com/users/4642154/hellowor1d"}, "edited": false, "score": 0, "creation_date": 1433352036, "post_id": 30625559, "comment_id": 49319221, "body": "I have the text box named TextBox1 in the worksheet that I&#39;m trying to edit. Is there a way to get this to work with a regular text box instead of an active x control? I can&#39;t link the value to another worksheet with active x"}], "tags": [], "owner": {"reputation": 1, "user_id": 4970558, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/0f42b5e3d9999074da875415a1d43d66?s=128&d=identicon&r=PG", "display_name": "LockeGarmin", "link": "https://stackoverflow.com/users/4970558/lockegarmin"}, "is_accepted": false, "score": 0, "last_activity_date": 1433348372, "creation_date": 1433348372, "answer_id": 30625559, "question_id": 30624544, "link": "https://stackoverflow.com/questions/30624544/excel-change-text-box-color-based-on-value/30625559#30625559", "title": "Excel change text box color based on value", "body": "<p>You are getting an Object required error because you put your code in an object where Textbox1 doesn't exist. Put your code into either a userform or a worksheet where there is a Textbox named \"Textbox1\".</p>\n\n<p>To solve the \"If without End If\" issue change the following:</p>\n\n<pre><code>If TextBox1.Value = \"\" Or Not \"1\" Or Not \"2\" Or Not \"3\" Then _\n\nTextBox1.BackColor = RGB(0, 0, 0)\n</code></pre>\n\n<p>To this:</p>\n\n<pre><code>If TextBox1.Value = \"\" Or Not \"1\" Or Not \"2\" Or Not \"3\" Then _\nTextBox1.BackColor = RGB(0, 0, 0)\n</code></pre>\n\n<p>I would personally use a Select Case statement like the following, but what you have works other than that one line.</p>\n\n<pre><code>Private Sub TextBox1_Change()\n\n    Select Case TextBox1.Value\n        Case \"1\": TextBox1.BackColor = RGB(255, 0, 0)\n        Case \"2\": TextBox1.BackColor = RGB(0, 255, 0)\n        Case \"3\": TextBox1.BackColor = RGB(0, 0, 255)\n        Case Else: TextBox1.BackColor = RGB(255, 255, 255)\n    End Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 53, "user_id": 3643482, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a6dfec29d7341df83bad0eec5b137449?s=128&d=identicon&r=PG&f=1", "display_name": "Flaniganga", "link": "https://stackoverflow.com/users/3643482/flaniganga"}, "is_accepted": false, "score": 0, "last_activity_date": 1512986904, "creation_date": 1512986904, "answer_id": 47750473, "question_id": 30624544, "link": "https://stackoverflow.com/questions/30624544/excel-change-text-box-color-based-on-value/47750473#47750473", "title": "Excel change text box color based on value", "body": "<p>I am assuming that you are using a User form where you need the Textbox to change color based on the information in it.</p>\n\n<p>I am currently working on the same thing and I have come with the following solution: </p>\n\n<p>For UserForm1 with 4 textboxes listed 1 - 4</p>\n\n<pre><code>Private Sub Textbox1_Change()\n If TextBox1.Text = \"A\" Then\nTextBox1.BackColor = RGB(0, 32, 96)\n ElseIf TextBox1.Text = \"B\" Then\nTextBox1.BackColor = RGB(0, 112, 192)\n  ElseIf TextBox1.Text = \"C\" Then\nTextBox1.BackColor = RGB(189, 215, 238)\n  ElseIf TextBox1.Text = \"D\" Then\nTextBox1.BackColor = RGB(0, 176, 240)\nEnd If\nEnd Sub\n\nPrivate Sub Textbox2_Change()\n If TextBox2.Text = \"A\" Then\nTextBox2.BackColor = RGB(0, 32, 96)\nTextBox2.Font.Color = RGB(0, 0, 0)\n ElseIf TextBox2.Text = \"B\" Then\nTextBox2.BackColor = RGB(0, 112, 192)\n  ElseIf TextBox2.Text = \"C\" Then\nTextBox2.BackColor = RGB(189, 215, 238)\n  ElseIf TextBox2.Text = \"D\" Then\nTextBox2.BackColor = RGB(0, 176, 240)\nEnd If\nEnd Sub\n\nPrivate Sub Textbox3_Change()\n If TextBox3.Text = \"A\" Then\nTextBox3.BackColor = RGB(0, 32, 96)\n ElseIf TextBox3.Text = \"B\" Then\nTextBox3.BackColor = RGB(0, 112, 192)\n  ElseIf TextBox3.Text = \"C\" Then\nTextBox3.BackColor = RGB(189, 215, 238)\n  ElseIf TextBox3.Text = \"D\" Then\nTextBox3.BackColor = RGB(0, 176, 240)\n    End If\nEnd Sub\n\nPrivate Sub Textbox4_Change()\n If TextBox4.Text = \"A\" Then\nTextBox4.BackColor = RGB(0, 32, 96)\n ElseIf TextBox4.Text = \"B\" Then\nTextBox4.BackColor = RGB(0, 112, 192)\n  ElseIf TextBox4.Text = \"C\" Then\nTextBox4.BackColor = RGB(189, 215, 238)\n  ElseIf TextBox4.Text = \"D\" Then\nTextBox4.BackColor = RGB(0, 176, 240)\n    End If\nEnd Sub\n</code></pre>\n\n<p>The final result is as follows:</p>\n\n<p><a href=\"https://i.stack.imgur.com/6w2Q9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6w2Q9.png\" alt=\"Formatting example\"></a></p>\n"}], "owner": {"reputation": 63, "user_id": 4642154, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ff60da4b8ac4053f625557903554972b?s=128&d=identicon&r=PG&f=1", "display_name": "HelloWor1d", "link": "https://stackoverflow.com/users/4642154/hellowor1d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22265, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1617253605, "creation_date": 1433345534, "question_id": 30624544, "link": "https://stackoverflow.com/questions/30624544/excel-change-text-box-color-based-on-value", "title": "Excel change text box color based on value", "body": "<p>I need to change the background color of a text box based on the value in that box which is being retrieved from another page. As I am finding out, you cannot do conditional formatting with text boxes, so the only way is with VBA. I cannot for the life of me figure out how to set up the code to make this work. I tried opening the VBA viewer and using this code:</p>\n\n<pre><code>Private Sub TextBox1_Change()\n\nIf TextBox1.Value = \"\" Or Not \"1\" Or Not \"2\" Or Not \"3\" Then _\n\nTextBox1.BackColor = RGB(0, 0, 0)\n\nIf TextBox1.Value = \"1\" Then TextBox1.BackColor = RGB(255, 0, 0)\n\nIf TextBox1.Value = \"2\" Then TextBox1.BackColor = RGB(0, 255, 0)\n\nIf TextBox1.Value = \"3\" Then TextBox1.BackColor = RGB(0, 0, 255)\n\nEnd Sub\n</code></pre>\n\n<p>I get some error that says Object required and one that says block if without end if? I found the code on a forum and the user had success, so I know it should work. Thanks in advance </p>\n"}, {"tags": ["vba", "internet-explorer", "excel"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 1, "creation_date": 1433350602, "post_id": 30624518, "comment_id": 49318313, "body": "You appear to create two instances hence why one is left open.  you do an IE CreateObject, then IE GetObject.   you never close the first one"}], "answers": [{"tags": [], "owner": {"reputation": 221, "user_id": 3805157, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a102b975ffb57941db00cc4bffb571ba?s=128&d=identicon&r=PG&f=1", "display_name": "Access", "link": "https://stackoverflow.com/users/3805157/access"}, "is_accepted": true, "score": 9, "last_activity_date": 1433354772, "creation_date": 1433354772, "answer_id": 30627517, "question_id": 30624518, "link": "https://stackoverflow.com/questions/30624518/how-to-close-an-internet-explorer-instance-inside-an-excel-vba/30627517#30627517", "title": "How to close an Internet Explorer instance inside an Excel VBA", "body": "<p>As @Sorceri statet correct in the comments, I have created two instances.\nThe following Code quits the instance without problems.</p>\n\n<pre><code>Dim IE As Object\nSet IE = GetObject(\"new:{D5E8041D-920F-45e9-B8FB-B1DEB82C6E5E}\")\n' Do stuff...\n' Clean up\nIE.Quit\nSet IE = Nothing\n</code></pre>\n\n<p>Interesting about the above (wrong) code is, that he indeed opens 2 instances, but does not close either of them at the end.</p>\n"}], "owner": {"reputation": 221, "user_id": 3805157, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a102b975ffb57941db00cc4bffb571ba?s=128&d=identicon&r=PG&f=1", "display_name": "Access", "link": "https://stackoverflow.com/users/3805157/access"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49162, "favorite_count": 3, "accepted_answer_id": 30627517, "answer_count": 1, "score": 5, "last_activity_date": 1433689724, "creation_date": 1433345468, "last_edit_date": 1433689724, "question_id": 30624518, "link": "https://stackoverflow.com/questions/30624518/how-to-close-an-internet-explorer-instance-inside-an-excel-vba", "title": "How to close an Internet Explorer instance inside an Excel VBA", "body": "<p>I'm running an Excel VBA macro which opens a IE instance, extracts data from a URL and then is supposed to close the instance again.</p>\n\n<pre><code>Dim IE As Object\nSet IE = CreateObject(\"InternetExplorer.Application\")\nSet IE = GetObject(\"new:{D5E8041D-920F-45e9-B8FB-B1DEB82C6E5E}\")\n' Do stuff...\n' Clean up\nIE.Quit\nSet IE = Nothing\n</code></pre>\n\n<p>I looked up that method and it is supposed to close the IE instance. However that does not work for me. \nThe task manager confirms that the <code>iexplorer.exe</code> process is still running. If I run the macro several times a new instance is added and never closed.</p>\n\n<p>How can I make the macro properly close the instance?</p>\n\n<p>I'm using IE 8.0 and VBA 7.0 on this.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433349864, "post_id": 30624437, "comment_id": 49317887, "body": "Where do you want the output to go?  Right now you are creating a <code>QueryTable</code> in <code>wks</code> which is the <code>ActiveSheet</code> of <code>wkb</code> which is the file you just opened.  Do you want the output in the file that you are opening?  Next, if that is what you want, then <code>Destination:=Range(&quot;A1&quot;)</code> is determining the actual spot on that <code>Worksheet</code> where is starts the new table."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4736025"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433350748, "post_id": 30624437, "comment_id": 49318398, "body": "I am attempting to put the output in the new file I am opening. For each text file I open a new workbook is created and the data is posted to that new workbook. It is posting the data to the new workbook however it takes the original data from the text file and posts it in the first row right after the correctly imported data and I am a bit stumped as to why it is doing that. I could simply manually delete the row but I want to determine why it&#39;s happening to clean up the process."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433351185, "post_id": 30624437, "comment_id": 49318677, "body": "Your code is opening the text file <i>as a <code>Workbook</code></i> which is the same as going to <code>File-&gt;Open</code>.  The original data is there because <b>it was there when you started</b>.  If you truly want a <b>new</b> <code>Workbook</code> you need to explicitly create it with <code>Set wkb = Workbooks.Add</code> instead of your current line.  There is no need to <code>Open</code> the text file if you want to create a data connection to it; <code>Connection</code> handles all that."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4736025"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433351879, "post_id": 30624437, "comment_id": 49319114, "body": "Thanks Byron. I was stepping through my code and found that line was the issue. With that and your suggestion it looks like I am good."}], "answers": [{"tags": [], "owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "is_accepted": true, "score": 0, "last_activity_date": 1433352191, "creation_date": 1433352191, "answer_id": 30626747, "question_id": 30624437, "link": "https://stackoverflow.com/questions/30624437/importing-multiple-text-files-to-new-excel-work-books-with-excel-vba/30626747#30626747", "title": "Importing multiple text files to new excel work books with Excel VBA", "body": "<p>Your issue is the use of <code>Workbooks.Open</code> to get a new <code>Workbook</code>.  You are really opening the text file in the same way as going to <code>File-&gt;Open</code>.  If you want a <em>new</em> <code>Workbook</code> to dump the data, create it explicitly using <code>Set wkb = Workbooks.Add()</code> instead of your current call to <code>Workbooks.Open</code>.  You are seeing the file's data because you opened the file first.</p>\n\n<p><strong>Full code</strong></p>\n\n<pre><code>FilesToOpen = Application.GetOpenFilename _\n  (FileFilter:=\"Text Files (*.txt), *.txt\", _\n  MultiSelect:=True, Title:=\"Text Files to Open\")\n\n\n\nFor i = LBound(FilesToOpen) To UBound(FilesToOpen)\n    Set wkb = Workbooks.Add()\n    Set wks = wkb.ActiveSheet\n     With wks.QueryTables.Add(Connection:= _\n        \"TEXT;\" &amp; FilesToOpen(i), Destination:=Range(\"A1\"))\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .TextFilePromptOnRefresh = False\n        .RefreshStyle = xlInsertDeleteCells\n        .TextFilePlatform = 437\n        .TextFileStartRow = 1\n        .TextFileParseType = xlDelimited\n        .TextFileTextQualifier = xlTextQualifierDoubleQuote\n        .TextFileConsecutiveDelimiter = True\n        .TextFileTabDelimiter = False\n        .TextFileSemicolonDelimiter = True\n        .TextFileCommaDelimiter = False\n        .TextFileSpaceDelimiter = False\n        .TextFileColumnDataTypes = Array(2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, _\n        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)\n        .TextFileTrailingMinusNumbers = True\n        .Refresh BackgroundQuery:=False\n    End With\nNext i\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4736025"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 30626747, "answer_count": 1, "score": 0, "last_activity_date": 1433352191, "creation_date": 1433345276, "question_id": 30624437, "link": "https://stackoverflow.com/questions/30624437/importing-multiple-text-files-to-new-excel-work-books-with-excel-vba", "title": "Importing multiple text files to new excel work books with Excel VBA", "body": "<p>I have a script I put together to import multiple text files that are semi colon delimited in to new workbooks for each file that is selected. It is about 99% functional aside from the fact it seems to paste all of the data from the selected text files in a column after the correctly imported columns in the new workbook. I'm not entirely sure what part of the code is causing this to be pasted in to that particular row. Below is the main part of the code. Can anyone identify where the issue might be?</p>\n\n<p>Also I just want to say thanks to the community here. I have learned a lot by going through other posts on this forum.</p>\n\n<pre><code>FilesToOpen = Application.GetOpenFilename _\n  (FileFilter:=\"Text Files (*.txt), *.txt\", _\n  MultiSelect:=True, Title:=\"Text Files to Open\")\n\n\n\nFor i = LBound(FilesToOpen) To UBound(FilesToOpen)\n    Set wkb = Workbooks.Open(FilesToOpen(i))\n    Set wks = wkb.ActiveSheet\n     With wks.QueryTables.Add(Connection:= _\n        \"TEXT;\" &amp; FilesToOpen(i), Destination:=Range(\"A1\"))\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .TextFilePromptOnRefresh = False\n        .RefreshStyle = xlInsertDeleteCells\n        .TextFilePlatform = 437\n        .TextFileStartRow = 1\n        .TextFileParseType = xlDelimited\n        .TextFileTextQualifier = xlTextQualifierDoubleQuote\n        .TextFileConsecutiveDelimiter = True\n        .TextFileTabDelimiter = False\n        .TextFileSemicolonDelimiter = True\n        .TextFileCommaDelimiter = False\n        .TextFileSpaceDelimiter = False\n        .TextFileColumnDataTypes = Array(2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, _\n        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)\n        .TextFileTrailingMinusNumbers = True\n        .Refresh BackgroundQuery:=False\n    End With\nNext i\n</code></pre>\n"}, {"tags": ["vba", "error-handling", "ms-word"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1433344497, "post_id": 30623985, "comment_id": 49314237, "body": "Your error handlers are running whether or not there&#39;s an error. Can you try to make the code a little bit more realistic, just to make a clear question? Pro-tip: the more effort you put in your question, the more likely you are to get an answer with as much effort."}, {"owner": {"reputation": 87, "user_id": 4815261, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3f53a5ae2385631944717152a7adeb4c?s=128&d=identicon&r=PG&f=1", "display_name": "FormaInnova Cursos", "link": "https://stackoverflow.com/users/4815261/formainnova-cursos"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1433345052, "post_id": 30623985, "comment_id": 49314700, "body": "Well, sorry, inside all &quot;DO STUFF&quot; you may suppose there is a &quot;EXIT SUB&quot;. Sorry for the inconvenience"}, {"owner": {"reputation": 113, "user_id": 4571581, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-mELqc8FkCPQ/AAAAAAAAAAI/AAAAAAAAAAs/xTHvAmk3khg/photo.jpg?sz=128", "display_name": "Rub&#233;n P S", "link": "https://stackoverflow.com/users/4571581/rub%c3%a9n-p-s"}, "edited": false, "score": 0, "creation_date": 1433346031, "post_id": 30623985, "comment_id": 49315488, "body": "Why that overflow error?  P.D.: My first comment :)))))"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 113, "user_id": 4571581, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-mELqc8FkCPQ/AAAAAAAAAAI/AAAAAAAAAAs/xTHvAmk3khg/photo.jpg?sz=128", "display_name": "Rub&#233;n P S", "link": "https://stackoverflow.com/users/4571581/rub%c3%a9n-p-s"}, "edited": false, "score": 0, "creation_date": 1433346075, "post_id": 30623985, "comment_id": 49315522, "body": "@Rub&#233;nPS I put it in just to illustrate OP&#39;s intention of blowing things up in <code>Sub D</code>. Sorry if it muds things up, feel free to take it out."}, {"owner": {"reputation": 113, "user_id": 4571581, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-mELqc8FkCPQ/AAAAAAAAAAI/AAAAAAAAAAs/xTHvAmk3khg/photo.jpg?sz=128", "display_name": "Rub&#233;n P S", "link": "https://stackoverflow.com/users/4571581/rub%c3%a9n-p-s"}, "edited": false, "score": 0, "creation_date": 1433346117, "post_id": 30623985, "comment_id": 49315548, "body": "Not my post, I only wanted to know why is it there ^-^"}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 4815261, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3f53a5ae2385631944717152a7adeb4c?s=128&d=identicon&r=PG&f=1", "display_name": "FormaInnova Cursos", "link": "https://stackoverflow.com/users/4815261/formainnova-cursos"}, "edited": false, "score": 0, "creation_date": 1433486054, "post_id": 30625279, "comment_id": 49382066, "body": "So...the thing I need to do is this??   <code>Sub D()  On error goto errormsg.....Errormsg: Msgbox &quot;blablabla&quot;  Err.Raise Err.Number end sub</code>"}, {"owner": {"reputation": 113, "user_id": 4571581, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-mELqc8FkCPQ/AAAAAAAAAAI/AAAAAAAAAAs/xTHvAmk3khg/photo.jpg?sz=128", "display_name": "Rub&#233;n P S", "link": "https://stackoverflow.com/users/4571581/rub%c3%a9n-p-s"}, "edited": false, "score": 0, "creation_date": 1433486638, "post_id": 30625279, "comment_id": 49382346, "body": "@Mat&#39;s Mug But if you do that, won&#39;t it give you back the same error without handling before leaving D?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 113, "user_id": 4571581, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-mELqc8FkCPQ/AAAAAAAAAAI/AAAAAAAAAAs/xTHvAmk3khg/photo.jpg?sz=128", "display_name": "Rub&#233;n P S", "link": "https://stackoverflow.com/users/4571581/rub%c3%a9n-p-s"}, "edited": false, "score": 0, "creation_date": 1433505405, "post_id": 30625279, "comment_id": 49393725, "body": "@Rub&#233;nPS depends how important it is to know that the error originated in D, but yes, that&#39;s why I mention removing the handlers and catch everything in A."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1433347570, "creation_date": 1433347570, "answer_id": 30625279, "question_id": 30623985, "link": "https://stackoverflow.com/questions/30623985/vba-ms-word-nested-error-control/30625279#30625279", "title": "Vba Ms-Word Nested Error Control", "body": "<p><code>On Error GoTo [error-handler-label]</code> tells VBA to jump to the specified label whenever a runtime error occurs in a method. When you use error handlers, you're telling VBA \"it's all good, no need to blow everything up, I can handle it\". So when <code>Sub D</code> runs:</p>\n\n<blockquote>\n<pre><code>Sub D()\n    On Error GoTo errormsg  \n    '...\n    Err.Raise 6 'overflow error\n    '...\n    Exit Sub\nerrormsg:\n    MsgBox \"Error in D\",vbOKOnly,\"Warning\"\nEnd Sub\n</code></pre>\n</blockquote>\n\n<p>When execution reaches the line that throws an error, VBA jumps to the <code>errormsg</code> label and you should see the \"Error in D\" message. Then execution returns to the caller (<code>Sub B</code>) and, as far as the runtime is concerned, the error that was raised in D was taken care of (because you told it \"I'll handle it\" with that <code>On Error</code> statement), so execution resumes with the <code>Exit Sub</code> statement and returns to <code>Sub A</code> to run <code>Sub C</code>.</p>\n\n<p>If you want runtime errors to \"bubble up\", you either need to re-raise them in the error handling subroutine:</p>\n\n<pre><code>Err.Raise Err.Number 'per Err.Raise specs, current Err values are reused when only the Number parameter is specified\n</code></pre>\n\n<p>...Or you remove the handler in <code>Sub D</code> and decide to handle it higher up in the call stack. For example, if you remove all handlers <em>except</em> in <code>Sub A</code>, then you will see \"Error in A\" with the error message actually being that of the error that was raised in <code>Sub D</code> - unfortunately without any way of telling where in the call stack that error occurred, because VBA doesn't expose its call stack.</p>\n\n<p>Re-raising the error in every error handler should pop the follow messages, in that order:</p>\n\n<ul>\n<li>Error in D</li>\n<li>Error in B</li>\n<li>Error in A</li>\n<li>[and if you re-raise in A then VBA blows up here if A was your starting point]</li>\n</ul>\n"}], "owner": {"reputation": 87, "user_id": 4815261, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3f53a5ae2385631944717152a7adeb4c?s=128&d=identicon&r=PG&f=1", "display_name": "FormaInnova Cursos", "link": "https://stackoverflow.com/users/4815261/formainnova-cursos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 1, "accepted_answer_id": 30625279, "answer_count": 1, "score": 1, "last_activity_date": 1433347570, "creation_date": 1433344066, "last_edit_date": 1433345422, "question_id": 30623985, "link": "https://stackoverflow.com/questions/30623985/vba-ms-word-nested-error-control", "title": "Vba Ms-Word Nested Error Control", "body": "<p>I'm trying this time to handle errors between nested subs. For example:</p>\n\n<pre><code>Sub A()\n    On Error GoTo errormsg\n\n    Call B\n    Call C\n    Exit Sub\nerrormsg:\n    MsgBox \"Error in A\", vbOKOnly, \"Warning\"\nEnd Sub\n\nSub B()\n    On Error GoTo errormsg\n\n    Call D\n    Exit Sub\nerrormsg:\n    MsgBox \"Error in B\",vbOKOnly,\"Warning\"\nEnd Sub\n\nSub C()\n    On Error Goto errormsg\n\n    '...\n\n    Exit Sub\nerrormsg:\n    MsgBox \"Error in C\",vbOKOnly,\"Warning\"\nEnd Sub\n\nSub D()\n    On Error GoTo errormsg  \n    '...\n    Err.Raise 6 'overflow error\n    '...\n    Exit Sub\nerrormsg:\n    MsgBox \"Error in D\",vbOKOnly,\"Warning\"\nEnd Sub\n</code></pre>\n\n<p>Well, If there is an error when calling D from B(from A), ErrorD shows, but not ErrorB neither ErrorA. What am I doing/understanding wrong? </p>\n\n<p>Thanks a lot in advance</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "edited": false, "score": 0, "creation_date": 1433344396, "post_id": 30623898, "comment_id": 49314153, "body": "I&#39;ll be interested to see any answers to this. Only thing that jumps to mind is turning off alerts Application.DisplayAlerts = False before opening which might stop it jamming. or might not..."}, {"owner": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "edited": false, "score": 1, "creation_date": 1433345105, "post_id": 30623898, "comment_id": 49314742, "body": "You should be able to check by inspecting the <code>objfile.attributes</code>"}], "answers": [{"comments": [{"owner": {"reputation": 503, "user_id": 4970214, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6gTMV.jpg?s=128&g=1", "display_name": "Constuntine", "link": "https://stackoverflow.com/users/4970214/constuntine"}, "edited": false, "score": 0, "creation_date": 1433346535, "post_id": 30624628, "comment_id": 49315839, "body": "I have but it still will not get past the &quot;&#39;Open that might fail&quot; line. I know I don&#39;t have access to see that specific file, but for now I&#39;m just looking for a way to handle the error so that my code will run to completion."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 503, "user_id": 4970214, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6gTMV.jpg?s=128&g=1", "display_name": "Constuntine", "link": "https://stackoverflow.com/users/4970214/constuntine"}, "edited": false, "score": 0, "creation_date": 1433347558, "post_id": 30624628, "comment_id": 49316543, "body": "I do not understand.  This is the purpose of <code>On Error Resume Next</code> and it has never failed for me.  Are you being rejected by the Windows file access system or by something more exotic?"}, {"owner": {"reputation": 503, "user_id": 4970214, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6gTMV.jpg?s=128&g=1", "display_name": "Constuntine", "link": "https://stackoverflow.com/users/4970214/constuntine"}, "edited": false, "score": 0, "creation_date": 1433347727, "post_id": 30624628, "comment_id": 49316632, "body": "At this point, I think its the windows file access system. I think I need to speak with the admin, and try to get rights to access the files."}], "tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": true, "score": 2, "last_activity_date": 1433345743, "creation_date": 1433345743, "answer_id": 30624628, "question_id": 30623898, "link": "https://stackoverflow.com/questions/30623898/using-vba-in-excel-to-see-if-i-have-permission-to-open-the-file/30624628#30624628", "title": "Using VBA in Excel to see if I have permission to open the file", "body": "<p>Have you tried something like:</p>\n\n<pre><code>On Error Resume Next\n'Open that might fail\nOn Error GoTo 0\nIf Err.Number &gt; 0 Then\n  Call MsgBox(\"Open failed because \" &amp; Err.Description, vbOKOnly)\n  Exit Sub\nEnd If\n\n' If get here, file was opened successfully\n</code></pre>\n"}], "owner": {"reputation": 503, "user_id": 4970214, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6gTMV.jpg?s=128&g=1", "display_name": "Constuntine", "link": "https://stackoverflow.com/users/4970214/constuntine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1031, "favorite_count": 0, "accepted_answer_id": 30624628, "answer_count": 1, "score": 2, "last_activity_date": 1433345743, "creation_date": 1433343872, "question_id": 30623898, "link": "https://stackoverflow.com/questions/30623898/using-vba-in-excel-to-see-if-i-have-permission-to-open-the-file", "title": "Using VBA in Excel to see if I have permission to open the file", "body": "<p>I have a file in the system that is breaking my code. When I try to open the file via VBA or by simply opening the file through the file system, I get this error. \"You are not authorized to access this spreadsheet.\"</p>\n\n<p>I was wondering if there is a way to use VBA to check the file permissions before attempting to open the file.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 1281, "user_id": 2414900, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/HMnMw.jpg?s=128&g=1", "display_name": "Aaron Hellman", "link": "https://stackoverflow.com/users/2414900/aaron-hellman"}, "is_accepted": false, "score": 0, "last_activity_date": 1433363722, "creation_date": 1433363722, "answer_id": 30630152, "question_id": 30623735, "link": "https://stackoverflow.com/questions/30623735/vba-open-multiple-files-copy-data-from-files-to-mastersheet/30630152#30630152", "title": "VBA - Open multiple files, copy data from files to mastersheet", "body": "<p>Is the problem that you cannot copy the text from the opened sheets? </p>\n\n<p>To find the last row, I like to use: <code>LastRow = ActiveSheet.UsedRange.Rows.Count</code> which gives you the number of rows in use. </p>\n\n<p>Then with that, you can do: <code>Range(cells(10, 6), cells(LastRow, 7)).copy</code> and paste it into your master sheet. (In this case columns = 6 &amp; 7 for F &amp; G)</p>\n\n<p>This will copy all data, even the blank cells. If you do not want blanks, you can <code>Selection.PasteSpecial</code> with <code>SkipBlanks:True</code></p>\n"}], "owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2168, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433363722, "creation_date": 1433343461, "last_edit_date": 1433344344, "question_id": 30623735, "link": "https://stackoverflow.com/questions/30623735/vba-open-multiple-files-copy-data-from-files-to-mastersheet", "title": "VBA - Open multiple files, copy data from files to mastersheet", "body": "<p>I am opening many files in a folder and trying to copy data [from F10 to the end of column F (some rows may be blank) and from G10 to the end of column G (some rows may be blank)] from the files to one worksheet called \"masterfile\", in columns 2 and 3 respectively, under a header. I have been trying to research AdvancedFilter() and CopyRange() but cannot get it to work correctly. I am not experienced with VBA so I am having a hard time figuring out how to even correctly use them. Any advice?</p>\n\n<p>This code currently opens each file in a folder, prints the name of each file to the first column of the masterfile, and prints the information in cell J1 of the opened file down the 4th column of the masterfile. Any advice is greatly appreciated. I've been stuck for a week.</p>\n\n<pre><code>Option Explicit\n\nSub LoopThroughDirectory()\n\n    Dim objFSO As Object\n    Dim objFolder As Object\n    Dim objFile As Object\n    Dim MyFolder As String\n    Dim StartSht As Worksheet, ws As Worksheet\n    Dim WB As Workbook\n    Dim i As Integer\n    Dim LastRow As Integer, erow As Integer\n    Dim Height As Integer\n\n    'turn screen updating off - makes program faster\n    'Application.ScreenUpdating = False\n\n    'location of the folder in which the desired TDS files are\n    MyFolder = \"C:\\Users\\trembos\\Documents\\TDS\\progress\\\"\n\n    Set StartSht = ActiveSheet\n    Set StartSht = Workbooks(\"masterfile.xlsm\").Sheets(\"Sheet1\")\n\n    'create an instance of the FileSystemObject\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n    'get the folder object\n    Set objFolder = objFSO.GetFolder(MyFolder)\n    i = 1\n\n    'loop through directory file and print names\n    For Each objFile In objFolder.Files\n        If LCase(Right(objFile.Name, 3)) = \"xls\" Or LCase(Left(Right(objFile.Name, 4), 3)) = \"xls\" Then\n            'print file name to Column 1\n            Workbooks.Open fileName:=MyFolder &amp; objFile.Name\n            Set WB = ActiveWorkbook\n            'print TOOLING DATA SHEET(TDS): values to Column 2\n            With WB\n                For Each ws In .Worksheets\n                    StartSht.Cells(i + 1, 1) = objFile.Name\n                    With ws\n                        .Range(\"J1\").Copy StartSht.Cells(i + 1, 4)\n                    End With\n                    i = i + 1\n                'move to next file\n                Next ws\n                'close, do not save any changes to the opened files\n                .Close SaveChanges:=False\n            End With\n        End If\n    'move to next file\n    Next objFile\n    'turn screen updating back on\n    'Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433349453, "post_id": 30623688, "comment_id": 49317654, "body": "I would strongly advise using a Pivot Table if your goal is just aggregation and analysis.  Regarding why your code does not produce correct results, it is very difficult to determine since this is not a standard way of doing this, and I&#39;m confused what you expect to be in <code>Assembly(i)</code>.  If you really want VBA, you would do better with <code>AutoFilter</code> and counting visible cells."}], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 4974634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/999f2de9315593a4eb8e0abc3fdd08b8?s=128&d=identicon&r=PG&f=1", "display_name": "JoachimMun", "link": "https://stackoverflow.com/users/4974634/joachimmun"}, "is_accepted": false, "score": 0, "last_activity_date": 1433453077, "creation_date": 1433453077, "answer_id": 30654438, "question_id": 30623688, "link": "https://stackoverflow.com/questions/30623688/use-array-to-add-total-number-of-errors-per-department-in-excel-vba/30654438#30654438", "title": "Use array to add total number of errors per department in Excel VBA", "body": "<p>You can solve your problem easily without VBA. Just try the worksheet function SUMIF. Entering<br>\n<code>=SUMIF(D:D; D1; E:E)</code>\nin cell F1 and copying this formula into each cell in column F gives you the number of errors for the department in each row.</p>\n\n<p>Then you can copy rows D and F as values to a new worksheet and apply the \"remove duplicates\" feature to create the list of unique departments with their respective error counts.</p>\n"}, {"tags": [], "owner": {"reputation": 95, "user_id": 4293071, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e3692af0a02d4dfeaa3522c3b35e164e?s=128&d=identicon&r=PG&f=1", "display_name": "FruitUser", "link": "https://stackoverflow.com/users/4293071/fruituser"}, "is_accepted": true, "score": 0, "last_activity_date": 1433515896, "creation_date": 1433515896, "answer_id": 30669575, "question_id": 30623688, "link": "https://stackoverflow.com/questions/30623688/use-array-to-add-total-number-of-errors-per-department-in-excel-vba/30669575#30669575", "title": "Use array to add total number of errors per department in Excel VBA", "body": "<p>Got it; it was a lot simpler then I thought it'd be haha. Thanks anyways :)</p>\n\n<pre><code>Sub TotalErrors()\nDim Assembly As Single, CSR As Single, Customer As Single, Drums As Single\n' ... more departments\n\nDim i As Integer, RowCount As Integer\n\nRowCount = Range(\"D\" &amp; Rows.Count).End(xlUp).Row\n\nFor i = 1 To RowCount\n    If Range(\"D\" &amp; i).Value = \"Assembly\" Then\n        Assembly = Range(\"H2\").Value + Range(\"E\" &amp; i).Value\n        Range(\"H2\").Value = Assembly\n    ElseIf Range(\"D\" &amp; i).Value = \"CSR\" Then\n        CSR = Range(\"H3\").Value + Range(\"E\" &amp; i).Value\n        Range(\"H3\").Value = CSR\n    ElseIf Range(\"D\" &amp; i).Value = \"Customer\" Then\n        Customer = Range(\"H4\").Value + Range(\"E\" &amp; i).Value\n        Range(\"H4\").Value = Customer\n    ElseIf Range(\"D\" &amp; i).Value = \"Drums\" Then\n        Drums = Range(\"H5\").Value + Range(\"E\" &amp; i).Value\n        Range(\"H5\").Value = Drums\n' ... more departments\n    End If\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 4293071, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e3692af0a02d4dfeaa3522c3b35e164e?s=128&d=identicon&r=PG&f=1", "display_name": "FruitUser", "link": "https://stackoverflow.com/users/4293071/fruituser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 30669575, "answer_count": 2, "score": 0, "last_activity_date": 1433689659, "creation_date": 1433343371, "last_edit_date": 1433689659, "question_id": 30623688, "link": "https://stackoverflow.com/questions/30623688/use-array-to-add-total-number-of-errors-per-department-in-excel-vba", "title": "Use array to add total number of errors per department in Excel VBA", "body": "<p>I'm not sure how to explain this since the plan/idea is mostly in my head since I don't know how to execute it, but I'll try (comment with questions!):</p>\n\n<p>I have a sheet that lists which department of \"my\" company made an error, which type of error, and how many of that specific error in the department per fiscal month. (See attachment) <img src=\"https://i.stack.imgur.com/qsbjv.jpg\" alt=\"sample of the sheet\">. </p>\n\n<p>I would like to write a macro that would add up the total number of errors (column E) per department (column D) (month or type of error is not a factor in this macro). I've been experimenting with an array/For Next loop using vlookup to the number of entries, but to no avail since I don't have enough experience with arrays. Any ideas? Here's what I've started:</p>\n\n<pre><code>Option Explicit\nOption Base 1\nSub Total_Errors()\nDim Assembly() As Double, CSR() As Double\n'... more dept names\nDim i As Integer, RowCount As Integer\n\nRowCount = Range(\"D\" &amp; Rows.Count).End(xlUp).Row\n\nReDim Assembly(1 To RowCount) As Double, CSR(1 To RowCount) As Double \n' ... more redimmed dept names\n\nAssembly(i) = Application.WorksheetFunction.VLookup(\"Assembly\", Range(Range(\"D\" &amp; i + 1), Range(\"E\" &amp; RowCount)), 2, False)\n    Range(\"H2\").Value = Assembly(i)\n\nFor i = 2 To RowCount\n    Assembly(i) = Application.WorksheetFunction.VLookup(\"Assembly\", Range(Range(\"D\" &amp; i + 1), Range(\"E\" &amp; RowCount)), 2, False)\n    Range(\"H2\").Value = Assembly(i - 1) + Assembly(i)\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>Unfortunately, it will only do as I told it and only add the previous value to the current value :p funny how that works. Anyways, what i'd like to have happen with this code is that it will simply add a value to the previous value in the cell. The add method has seemed to be more involved that what I'm trying to do.\nAll suggestions welcome, and thanks in advance!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 447, "user_id": 4047422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45d74770311e0150280317207c5dc9c7?s=128&d=identicon&r=PG&f=1", "display_name": "Rob Cutmore", "link": "https://stackoverflow.com/users/4047422/rob-cutmore"}, "edited": false, "score": 0, "creation_date": 1433342696, "post_id": 30623217, "comment_id": 49312752, "body": "It looks like he&#39;s changing sFile in the loop: sFile = Left(sFile, 3). This will never allow sFile to be equal to an empty string though. At some point the loop will get stuck on the last 3 (or less) characters of the string."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4946547"}, "edited": false, "score": 0, "creation_date": 1433342716, "post_id": 30623217, "comment_id": 49312769, "body": "Ah sorry that&#39;s what I meant. Do you know how I can change it so it&#39;ll go to the next one?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4946547"}, "edited": false, "score": 0, "creation_date": 1433343030, "post_id": 30623217, "comment_id": 49313006, "body": "I changed it so I&#39;m not changing sFile (I think) and added sFile = Dir() after Next ws. Made these changes in the question. I&#39;m still getting the same result though, so I&#39;m not sure why it won&#39;t open the next file in the folder."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4946547"}, "edited": false, "score": 0, "creation_date": 1433343418, "post_id": 30623217, "comment_id": 49313341, "body": "It still isn&#39;t looping through the files"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4946547"}, "edited": false, "score": 0, "creation_date": 1433345396, "post_id": 30623217, "comment_id": 49314984, "body": "So it isn&#39;t stuck anymore but it is incorrectly matching and pasting data."}], "tags": [], "owner": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "is_accepted": false, "score": 1, "last_activity_date": 1433343023, "last_edit_date": 1495541639, "creation_date": 1433342270, "answer_id": 30623217, "question_id": 30622941, "link": "https://stackoverflow.com/questions/30622941/vba-stuck-in-nested-loop/30623217#30623217", "title": "VBA Stuck in nested loop", "body": "<p>I don't think there is a problem with your for each loop. Seems to me it will be getting stuck in the do while loop.</p>\n\n<p>You are not changing sFile anywhere in the loop so it will never break.</p>\n\n<pre><code>Do While sFile &lt;&gt; \"\"\n\nLoop\n</code></pre>\n\n<p>EDIT:</p>\n\n<pre><code>Sub LoopThroughFiles()\n    Dim MyObj As Object, MySource As Object, file As Variant\n    file = Dir(\"c:\\testfolder\\\")\n    While (file &lt;&gt; \"\")\n      'code here\n      file = Dir\n    Wend\nEnd Sub\n</code></pre>\n\n<p>From: <a href=\"https://stackoverflow.com/questions/10380312/loop-through-files-in-a-folder-using-vba\">Loop through files in a folder using VBA?</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4946547"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433344394, "creation_date": 1433341597, "last_edit_date": 1433344394, "question_id": 30622941, "link": "https://stackoverflow.com/questions/30622941/vba-stuck-in-nested-loop", "title": "VBA Stuck in nested loop", "body": "<p>I'm writing a code that compares the first few characters of a workbook (fromWB) name (tempName) with the name of a worksheet (sheetName). If they match, then the data from the file is copied into the worksheet (ws). I'm trying to get my code to iterate through the folder of files and through the workbook (fromWB) with multiple worksheets but the code is stuck in the do while loop (iterating through the worksheets), and I'm not sure how to fix it. It stops copying and pasting into the worksheet because tempName isn't changing since the code is not looping through the folder of files. I debugged the code and I'm not getting any errors. Any help would be appreciated!!</p>\n\n<p>EDIT: Would two nested For Each loops work?</p>\n\n<pre><code>Sub Import(Optional sPath As Variant)\nDim SelectFolder As FileDialog\nDim fromWB As Workbook\nDim toWB As Workbook\nDim ws As Worksheet\nDim fileName As String\nDim sheetName As String\nDim tempName As String\n\n\n'Application.ScreenUpdating = False\n'Application.DisplayAlerts = False\n'Application.EnableEvents = False\n\n'Retrieve Target Folder Path From User\nSet SelectFolder = Application.FileDialog(msoFileDialogFolderPicker)\n\nWith SelectFolder\n    .Title = \"Select a Folder\"\n    .AllowMultiSelect = False\n    If .Show &lt;&gt; -1 Then GoTo NextCode\n    sPath = .SelectedItems(1) &amp; \"\\\"\nEnd With\n\n'In Case of Cancel\nNextCode:\nsPath = sPath\nIf sPath = \"\" Then GoTo ResetSettings\n\nsFile = Dir(sPath &amp; \"*xlsx\")\nWorkbooks(\"Temp.xlsx\").Activate\nSet toWB = ActiveWorkbook\n\nDo While sFile &lt;&gt; \"\"\n    Set fromWB = Workbooks.Open(sPath &amp; sFile)\n    tempName = Left(sFile, 3)\n    Range(\"A1:B10\").Select\n    Selection.Copy\n\n    For Each ws In toWB.Worksheets\n        Windows(\"Temp.xlsx\").Activate\n        sheetName = ActiveSheet.Name\n        If sheetName = tempName Then\n            ws.Activate\n            Range(\"A4\").PasteSpecial xlPasteAllUsingSourceTheme\n        End If\n        ws.Activate\n    Next ws\nsFile = Dir()\nLoop\n\n\nResetSettings:\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 2, "creation_date": 1433341259, "post_id": 30622704, "comment_id": 49311645, "body": "What is your full code? and what line do you get the error on?"}, {"owner": {"reputation": 61, "user_id": 3020320, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/8a9e8797ff647bfb57a91a67e8345530?s=128&d=identicon&r=PG&f=1", "display_name": "user3020320", "link": "https://stackoverflow.com/users/3020320/user3020320"}, "reply_to_user": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1433341968, "post_id": 30622704, "comment_id": 49312185, "body": "The line that I get the error is the one above, If I manually open the workbook and skip this particular line while debugging the rest of my code works just fine. This particular line fails on different places on my code, the workbook launches but I still get a pop up and the script stops."}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 1, "creation_date": 1433344356, "post_id": 30622704, "comment_id": 49314116, "body": "Try <code>Dim wb as Workbook</code> and use <code>Set wb = Workbooks.Open(...</code>"}, {"owner": {"reputation": 61, "user_id": 3020320, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/8a9e8797ff647bfb57a91a67e8345530?s=128&d=identicon&r=PG&f=1", "display_name": "user3020320", "link": "https://stackoverflow.com/users/3020320/user3020320"}, "edited": false, "score": 0, "creation_date": 1433344911, "post_id": 30622704, "comment_id": 49314574, "body": "Thanks Matt! You have no idea how relieved I am."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "reply_to_user": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1433348738, "post_id": 30622704, "comment_id": 49317245, "body": "@MattCremeens, can you add that as an answer with a blurb about why you need to <code>Set</code> (or not use the <code>()</code> version of <code>Open</code>)?"}], "answers": [{"comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 1, "creation_date": 1433364344, "post_id": 30629244, "comment_id": 49326386, "body": "If you do not need the <code>Workbook</code> object, you can also just use <code>Workbooks.Open &quot;path to file&quot;</code> with no parentheses (and with no preceding <code>Dim</code> line).  This calls <code>Open</code> and discards the return, which is valid.  (So in OP&#39;s example, you could just remove the <code>()</code> and it would run.  OP probably got the <code>subscript out of range</code> error trying <code>Workbooks(&quot;path to file&quot;)</code>."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1502406984, "post_id": 30629244, "comment_id": 78209201, "body": "@ByronWall There is no issue with the <code>()</code> - a statement such as <code>abc = (&quot;xyz&quot;)</code> is equivalent to the statement <code>abc = &quot;xyz&quot;</code> and, in this case, <code>Workbooks.Open (strFilePath)</code> is equivalent to <code>Workbooks.Open strFilePath</code>."}], "tags": [], "owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "is_accepted": false, "score": 4, "last_activity_date": 1433360617, "creation_date": 1433360617, "answer_id": 30629244, "question_id": 30622704, "link": "https://stackoverflow.com/questions/30622704/workbook-opens-but-i-still-get-a-vba-subscript-out-of-range-error/30629244#30629244", "title": "Workbook opens but I still get a VBA Subscript out of range error", "body": "<p>If you want to use a workbook opened with vba, you need to <code>Set</code> a reference to it, like so </p>\n\n<pre><code>Dim wb as Workbook\nSet wb = Workbooks.Open(string of path and filename)\n</code></pre>\n\n<p>Then  you can go on referencing the <code>Workbook</code> object, <code>wb</code> and use its methods and refer to its properties.</p>\n"}], "owner": {"reputation": 61, "user_id": 3020320, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/8a9e8797ff647bfb57a91a67e8345530?s=128&d=identicon&r=PG&f=1", "display_name": "user3020320", "link": "https://stackoverflow.com/users/3020320/user3020320"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5527, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1609531758, "creation_date": 1433340931, "last_edit_date": 1433341347, "question_id": 30622704, "link": "https://stackoverflow.com/questions/30622704/workbook-opens-but-i-still-get-a-vba-subscript-out-of-range-error", "title": "Workbook opens but I still get a VBA Subscript out of range error", "body": "<p>I'm trying to open a workbook through my marco script and I have this error recurring everytime I try to open a workbook. The problem I'm facing is that when I use</p>\n\n<pre><code>Workbooks.Open (strFilePath)\n</code></pre>\n\n<p>where, </p>\n\n<pre><code>strFilePath = \"genericfilepath\\FileDuplicate.xlsx\"\n</code></pre>\n\n<p>The script launches the workbook but I still get a Subscript out of range error. I've also tried to turn of alerts by putting my code in between</p>\n\n<pre><code>Application.DisplayAlerts = False\n.\n.\nWorkbooks.Open (strFilePath)\n.\n.\nApplication.DisplayAlerts = True\n</code></pre>\n\n<p>I've also tried On Error Resume Next to no avail, the workbook launches but I still get a pop error msg.</p>\n"}, {"tags": ["excel", "vba", "loops", "keyword"], "comments": [{"owner": {"reputation": 2595, "user_id": 3897316, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6cf468fea626f3aec65a199e2f67b309?s=128&d=identicon&r=PG&f=1", "display_name": "Degustaf", "link": "https://stackoverflow.com/users/3897316/degustaf"}, "edited": false, "score": 1, "creation_date": 1433342909, "post_id": 30622661, "comment_id": 49312906, "body": "Have you tried stepping through with the debugger?  Where is it not doing what you expect?  Is it going through the loops appropriately? Is the conditional working appropriately?"}, {"owner": {"reputation": 2595, "user_id": 3897316, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6cf468fea626f3aec65a199e2f67b309?s=128&d=identicon&r=PG&f=1", "display_name": "Degustaf", "link": "https://stackoverflow.com/users/3897316/degustaf"}, "edited": false, "score": 2, "creation_date": 1433343907, "post_id": 30622661, "comment_id": 49313740, "body": "Don&#39;t put code into a comment.  It&#39;s virtually unreadable.  Edit it into your original question."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433348586, "post_id": 30622661, "comment_id": 49317141, "body": "Be aware when deleting rows.  It affects the indices.  <a href=\"http://stackoverflow.com/questions/30487368/vb-excel-deleting-rows-on-a-specified-value-being-in-a-cell/30491869#30491869\">This answer has a couple ways to deal with that.</a>.  This issue comes up regularly."}, {"owner": {"reputation": 712, "user_id": 3243922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mFTEb.jpg?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3243922/tom"}, "edited": false, "score": 0, "creation_date": 1433414220, "post_id": 30622661, "comment_id": 49347194, "body": "You may well be better of using the Worksheetfunction Match instead of the second do loop. Secondly you are better of starting at the bottom of your list because when you delete rows your counter(x) will no longer be correct. Finally you could use the CurrentRegion method one of the cells in the range to determine how many rows you need to loop through, this will also make a for next loop possible with step -1 and saves you the trouble of checking the value of the cell against an empty value."}, {"owner": {"reputation": 23, "user_id": 4969154, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-sw4Hob2aEN0/AAAAAAAAAAI/AAAAAAAAAB0/v8mlvu1YCi0/photo.jpg?sz=128", "display_name": "Michael Remsha", "link": "https://stackoverflow.com/users/4969154/michael-remsha"}, "edited": false, "score": 0, "creation_date": 1433414442, "post_id": 30622661, "comment_id": 49347326, "body": "Can you explain why it&#39;s not gonna works(counter(x) part). I&#39;ve tried multiple examples and it worked, but if you say it will cause trouble I better know now. Please and Thank you."}, {"owner": {"reputation": 23, "user_id": 4969154, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-sw4Hob2aEN0/AAAAAAAAAAI/AAAAAAAAAB0/v8mlvu1YCi0/photo.jpg?sz=128", "display_name": "Michael Remsha", "link": "https://stackoverflow.com/users/4969154/michael-remsha"}, "edited": false, "score": 0, "creation_date": 1433425602, "post_id": 30622661, "comment_id": 49354963, "body": "CurrentRegion wouldn&#39;t work as i&#39;m putting a button on second page to clear those exeptins."}], "owner": {"reputation": 23, "user_id": 4969154, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-sw4Hob2aEN0/AAAAAAAAAAI/AAAAAAAAAB0/v8mlvu1YCi0/photo.jpg?sz=128", "display_name": "Michael Remsha", "link": "https://stackoverflow.com/users/4969154/michael-remsha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 604, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1433427542, "creation_date": 1433340816, "last_edit_date": 1433427542, "question_id": 30622661, "link": "https://stackoverflow.com/questions/30622661/vba-macro-delete-the-row-with-keywords-from-the-column", "title": "VBA Macro, delete the row with keywords from the column", "body": "<p>I'm trying to write a macro for VBA that will go through one of the columns (say D), and compare names there with a list of exclusions that I will have on Sheet 2.  Then is needs to delete a row with matched word and move up the list, until entire list is clear of lines with those words.</p>\n\n<p>Here as far as I got but for some reason it doesn't do anything.</p>\n\n<pre><code>    Sub Delete_Exeptions()\n     x = 2\n     Do While ThisWorkbook.Sheets(\"List1\").Cells(x, 4) &lt;&gt; \"\"\n        i = 11\n        Do While ThisWorkbook.Sheets(\"List2\").Cells(i, 1) &lt;&gt; \"\"\n           If ThisWorkbook.Sheets(\"List1\").Cells(x, 4).Value = ThisWorkbook.Sheets(\"List2\").Cells(i, 1).Value Then ThisWorkbook.Sheets(\"List1\").Cells(x, 4).EntireRow.Delete\n           i = i + 1\n        Loop\n\n        x = x + 1\n     Loop\n</code></pre>\n\n<p>this one worked faily well if someone inerested:</p>\n\n<pre><code>Sub Delete_Exeptions()\n     x = 2\n    Do While ThisWorkbook.Sheets(\"List1\").Cells(x, 4) &lt;&gt; \"\"\n\n\n\n        i = 11\n        Do While ThisWorkbook.Sheets(\"List2\").Cells(i, 1) &lt;&gt; \"\"\n\n\n            If ThisWorkbook.Sheets(\"List1\").Cells(x, 4).Value &lt;&gt; ThisWorkbook.Sheets(\"List2\").Cells(i, 1).Value Then\n\n            Else: ThisWorkbook.Sheets(\"List1\").Cells(x, 4).EntireRow.Delete\n\n\n            End If\n            i = i + 1\n        Loop\n\n       x = x + 1\n    Loop\n\nEnd Sub\n</code></pre>\n\n<p>Well it's final eddit, I've changed as recomended so the first loop goes from last row to first, as I did bump into problem, when I had two exclusions in a row. But I've decided to not use other methods that were recomended instead(Match and CurentRegion) as they didnt really work for me. </p>\n\n<pre><code>Sub Test_Bottom_toup()\n\nDim str As String\nDim strArr() As String\nDim ws As Worksheet\nDim lRow As Long\n\nSet ws = ThisWorkbook.Sheets(\"List1\")\n\nWith ws\n    lRow = .Range(\"D\" &amp; .Rows.Count).End(xlUp).Row\nEnd With\n\nx = lRow\n    Do While x &lt;&gt; 1\n\n\n    str = ThisWorkbook.Sheets(\"List1\").Cells(x, 4)\n    strArr = Split(str, \" - \")\n    ' This one is for my data spesifically as I had a random number before actual name, which might not be on the list of exlusions.\n\n    i = 11\n\n     Do While ThisWorkbook.Sheets(\"List2\").Cells(i, 1) &lt;&gt; \"\"\n\n     If strArr(1) &lt;&gt; ThisWorkbook.Sheets(\"List2\").Cells(i, 1) Then\n\n     Else: ThisWorkbook.Sheets(\"List1\").Cells(x, 4).EntireRow.Delete\n\n\n     End If\n\n     i = i + 1\n     Loop\n\n    x = x - 1\n    Loop\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1433339185, "post_id": 30621785, "comment_id": 49310010, "body": "Why not just loop through the rows looking for &quot;nonpaid&quot; and placing that in the column, otherwise looking for the second non-blank and placing that in the column?"}, {"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1433339292, "post_id": 30621785, "comment_id": 49310090, "body": "May I ask why this needs to be done with VBA?"}, {"owner": {"reputation": 361, "user_id": 4914731, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-GQlW2FaTZcQ/AAAAAAAAAAI/AAAAAAAAAC4/di5KCJ4DOS4/photo.jpg?sz=128", "display_name": "Abdul Shiyas", "link": "https://stackoverflow.com/users/4914731/abdul-shiyas"}, "edited": false, "score": 0, "creation_date": 1433339367, "post_id": 30621785, "comment_id": 49310152, "body": "I tried all permutations and combinations. And I miss something. Can you pls write in coded form?"}, {"owner": {"reputation": 361, "user_id": 4914731, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-GQlW2FaTZcQ/AAAAAAAAAAI/AAAAAAAAAC4/di5KCJ4DOS4/photo.jpg?sz=128", "display_name": "Abdul Shiyas", "link": "https://stackoverflow.com/users/4914731/abdul-shiyas"}, "reply_to_user": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1433339473, "post_id": 30621785, "comment_id": 49310220, "body": "@chancea I have similarly 10-20 files and I have to do the same actions repeatedly. Also my vba program has some other actions too. Thats y"}, {"owner": {"reputation": 359, "user_id": 2809344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e631d68598f2f303d4dbefe8758efb67?s=128&d=identicon&r=PG", "display_name": "Clif", "link": "https://stackoverflow.com/users/2809344/clif"}, "edited": false, "score": 0, "creation_date": 1433339702, "post_id": 30621785, "comment_id": 49310396, "body": "Would there ever be a time when the &quot;is_paid&quot; column would say &quot;NonPaid&quot; and there be a &quot;job&quot; listed, say in the case of a volunteer?"}, {"owner": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "edited": false, "score": 0, "creation_date": 1433339742, "post_id": 30621785, "comment_id": 49310434, "body": "Same question as of chancea, why do you need VBA?? Besides the rules you described in your example you always get the rightmost value, please post other examples too if exist, or confirm if correct to get the rightmost data"}, {"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 2, "creation_date": 1433339892, "post_id": 30621785, "comment_id": 49310553, "body": "@AbdulShiyas Well I won&#39;t post this as an answer then but I was able to make that last column by just using <code>=INDEX(D3:I3,MATCH(&quot;*&quot;,D3:I3,-1))</code> and autofilling down.  Maybe we can utilize this within the <code>Application.Worksheetfunction</code> or <code>Evaluate</code> methods..."}, {"owner": {"reputation": 361, "user_id": 4914731, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-GQlW2FaTZcQ/AAAAAAAAAAI/AAAAAAAAAC4/di5KCJ4DOS4/photo.jpg?sz=128", "display_name": "Abdul Shiyas", "link": "https://stackoverflow.com/users/4914731/abdul-shiyas"}, "edited": false, "score": 0, "creation_date": 1433340050, "post_id": 30621785, "comment_id": 49310674, "body": "@cliff :) Good thought."}, {"owner": {"reputation": 359, "user_id": 2809344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e631d68598f2f303d4dbefe8758efb67?s=128&d=identicon&r=PG", "display_name": "Clif", "link": "https://stackoverflow.com/users/2809344/clif"}, "reply_to_user": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 1, "creation_date": 1433340582, "post_id": 30621785, "comment_id": 49311092, "body": "If that is a consideration, and assuming that you would still want the &quot;total&quot; to display &quot;NonPaid&quot;, then you could go with <code>=IF(OR(D3=&quot;NonPaid&quot;,F3=&quot;NonPaid&quot;,H3=&quot;NonPaid&quot;),&quot;NonPaid&quot;,E3&amp;&zwnj;&#8203;G3&amp;I3)</code> Otherwise @chancea &#39;s answer works great."}, {"owner": {"reputation": 361, "user_id": 4914731, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-GQlW2FaTZcQ/AAAAAAAAAAI/AAAAAAAAAC4/di5KCJ4DOS4/photo.jpg?sz=128", "display_name": "Abdul Shiyas", "link": "https://stackoverflow.com/users/4914731/abdul-shiyas"}, "reply_to_user": {"reputation": 359, "user_id": 2809344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e631d68598f2f303d4dbefe8758efb67?s=128&d=identicon&r=PG", "display_name": "Clif", "link": "https://stackoverflow.com/users/2809344/clif"}, "edited": false, "score": 0, "creation_date": 1433340893, "post_id": 30621785, "comment_id": 49311362, "body": "@Clif Instead of using column_reference D3,F3,H3 etc, we would like to use column name &quot;Is_Paid&quot; . Because in the real datasheet we cannot exactly mention the column_references (also error can happen if we edited the data set by adding/deleting a column before D3,F3,H3)."}], "answers": [{"comments": [{"owner": {"reputation": 361, "user_id": 4914731, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-GQlW2FaTZcQ/AAAAAAAAAAI/AAAAAAAAAC4/di5KCJ4DOS4/photo.jpg?sz=128", "display_name": "Abdul Shiyas", "link": "https://stackoverflow.com/users/4914731/abdul-shiyas"}, "edited": false, "score": 0, "creation_date": 1433401120, "post_id": 30623302, "comment_id": 49338807, "body": "Can I get this using vba ?"}, {"owner": {"reputation": 359, "user_id": 2809344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e631d68598f2f303d4dbefe8758efb67?s=128&d=identicon&r=PG", "display_name": "Clif", "link": "https://stackoverflow.com/users/2809344/clif"}, "reply_to_user": {"reputation": 361, "user_id": 4914731, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-GQlW2FaTZcQ/AAAAAAAAAAI/AAAAAAAAAC4/di5KCJ4DOS4/photo.jpg?sz=128", "display_name": "Abdul Shiyas", "link": "https://stackoverflow.com/users/4914731/abdul-shiyas"}, "edited": false, "score": 0, "creation_date": 1433420484, "post_id": 30623302, "comment_id": 49351352, "body": "Not sure about that, hopefully someone else will be able to comment on or answer that question."}], "tags": [], "owner": {"reputation": 359, "user_id": 2809344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e631d68598f2f303d4dbefe8758efb67?s=128&d=identicon&r=PG", "display_name": "Clif", "link": "https://stackoverflow.com/users/2809344/clif"}, "is_accepted": false, "score": 2, "last_activity_date": 1433342468, "creation_date": 1433342468, "answer_id": 30623302, "question_id": 30621785, "link": "https://stackoverflow.com/questions/30621785/excel-vba-merge-combine-columns-with-same-name/30623302#30623302", "title": "Excel VBA merge/combine columns with same name", "body": "<p>I imagine that someone can give you a better answer, however the best way I can think of to meet the criteria in your last comment is to set the data up as a table like so:<img src=\"https://i.stack.imgur.com/ZkjwY.jpg\" alt=\"enter image description here\"></p>\n\n<p>The formula for the \"Total\" column is: </p>\n\n<p><code>=IF(OR([@[is_paid]]=\"NonPaid\",[@[is_paid2]]=\"NonPaid\",[@[is_paid3]]=\"NonPaid\"),\"NonPaid\",[@Job]&amp;[@Job2]&amp;[@Job3])</code></p>\n"}, {"tags": [], "owner": {"reputation": 153, "user_id": 4847484, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ffbe465422ceecf17a59ba1d46a0e22b?s=128&d=identicon&r=PG&f=1", "display_name": "Federico Sanchez", "link": "https://stackoverflow.com/users/4847484/federico-sanchez"}, "is_accepted": false, "score": 2, "last_activity_date": 1433346262, "creation_date": 1433346262, "answer_id": 30624812, "question_id": 30621785, "link": "https://stackoverflow.com/questions/30621785/excel-vba-merge-combine-columns-with-same-name/30624812#30624812", "title": "Excel VBA merge/combine columns with same name", "body": "<p>i have a different formula but the idea is almost the same:</p>\n\n<p>your last column should have this formula</p>\n\n<pre><code>IF(ISERROR(MATCH(\"NonPaid\",$A2:$G2,0)),OFFSET(INDIRECT(ADDRESS(ROW($D2),MATCH(\"Paid\",$A2:$G2,0))),0,1),\"NonPaid\")\n</code></pre>\n\n<p>you need to adapt it to meet your columns, in my exampl my last column with data is G so that formula is on column H.</p>\n\n<p>i think you can also use it in vba using the range().formula = \"=......\" \nand then using the filldown for all your range</p>\n"}], "owner": {"reputation": 361, "user_id": 4914731, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-GQlW2FaTZcQ/AAAAAAAAAAI/AAAAAAAAAC4/di5KCJ4DOS4/photo.jpg?sz=128", "display_name": "Abdul Shiyas", "link": "https://stackoverflow.com/users/4914731/abdul-shiyas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1172, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1433346262, "creation_date": 1433338686, "question_id": 30621785, "link": "https://stackoverflow.com/questions/30621785/excel-vba-merge-combine-columns-with-same-name", "title": "Excel VBA merge/combine columns with same name", "body": "<p>My project work has an issue similar to the one described below.</p>\n\n<p>My dataset is like this\n<img src=\"https://i.stack.imgur.com/AJbtt.jpg\" alt=\"enter image description here\"></p>\n\n<p>What I want is like this (LAST COLUMN)\n<img src=\"https://i.stack.imgur.com/zQagY.jpg\" alt=\"enter image description here\"></p>\n\n<p>What I have is many columns of same name like \"Is_paid\", \"Job\". \nWhat I want is to create a new column \"Tot\", Which combines all these \"Is_Paid\" and \"Job\" in a special manner like,</p>\n\n<ol>\n<li>Combine all \"Is_Paid\" column into \"Is_Paid_total\"</li>\n<li><p>Combine all \"Job\" column into Job_total</p></li>\n<li><p>And the code format is (Not correct) </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim MyWorksheetLastColumn As Byte\n\nMyWorksheetLastColumn = Worksheets(1).Cells(1, Columns.Count).End(xlToLeft).Column\nWorksheets(1).Cells(1, MyWorksheetLastColumn + 1).Value = \"Tot_Employment\"\n\n\n\nDim rngTemp As Range\n\nSet rngTemp=Cells.Find(\"*\",SearchOrder:=xlByRows,SearchDirection:=xlPrevious)\n\nWith rngTemp\n\n\nFor Each cel In Range(Cells(1, 1), rngTemp)\n\n'****************MERGING STEPS**********************  \n\nIf cel.column(Is_Paid_total)=\"NonPaid\" then\n\n Tot=Is_Paid\n\n else Tot=Job_total\n</code></pre></li>\n</ol>\n\n<p>End If\nnext Cel\nEnd With\nEnd Sub</p>\n\n<p>Step 3 will be in a for loop </p>\n\n<p>I dont know how to merge/combine to get Is_Paid_Total and Job_Total. \nAlso I know the if statement I have written is wrong. Please help me to tackle this problem.</p>\n"}, {"tags": ["excel", "vba", "vbscript", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 25809, "user_id": 3148807, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/sYRik.jpg?s=128&g=1", "display_name": "Sagiv b.g", "link": "https://stackoverflow.com/users/3148807/sagiv-b-g"}, "edited": false, "score": 0, "creation_date": 1433352786, "post_id": 30624431, "comment_id": 49319652, "body": "works like a charm just a small note: if you run into the error &quot;ActiveX component can&#39;t create object: &#39;GetObject&#39;&quot; you should pass GetObject() with an empty string GetObject(&quot;&quot;,&quot;Excel.Application&quot;) see here : <a href=\"https://social.technet.microsoft.com/Forums/scriptcenter/en-US/4e45e0de-a480-4301-a618-a480175a44b9/microsoft-vbscript-runtime-error-activex-component-cant-create-object-getobject?forum=ITCG\" rel=\"nofollow noreferrer\">social.technet.microsoft.com/Forums/scriptcenter/en-US/&hellip;</a>"}], "tags": [], "owner": {"reputation": 12569, "user_id": 1316573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d1499fb08570f294d76e76da46cf3b89?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/1316573/daniel"}, "is_accepted": true, "score": 2, "last_activity_date": 1433346245, "last_edit_date": 1433346245, "creation_date": 1433345270, "answer_id": 30624431, "question_id": 30621682, "link": "https://stackoverflow.com/questions/30621682/run-application-commandbars-outside-excel-or-word/30624431#30624431", "title": "Run application.commandbars() outside excel or word", "body": "<p>You should be able to get an existing instance of the application in vbscript code like so:</p>\n\n<pre><code>Dim excelObj \nSet excelObj = GetObject(, \"Excel.Application\")\n</code></pre>\n\n<p>You can then call any application methods on that object:</p>\n\n<pre><code>excelObj.CommandBars(\"research\").Enabled = False\n</code></pre>\n\n<p>For Word, do the same as above but use \"Word.Application\".</p>\n\n<p>Note: <a href=\"https://msdn.microsoft.com/en-us/library/e9waz863%28v=vs.90%29.aspx\" rel=\"nofollow\">GetObject</a> will throw an error if no instance of the application is currently running. In that case use <a href=\"https://msdn.microsoft.com/en-us/library/7t9k08y5(v=vs.90).aspx\" rel=\"nofollow\">CreateObject</a> instead, with the same parameters.</p>\n"}], "owner": {"reputation": 25809, "user_id": 3148807, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/sYRik.jpg?s=128&g=1", "display_name": "Sagiv b.g", "link": "https://stackoverflow.com/users/3148807/sagiv-b-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 1, "accepted_answer_id": 30624431, "answer_count": 1, "score": 0, "last_activity_date": 1433346245, "creation_date": 1433338459, "last_edit_date": 1433339819, "question_id": 30621682, "link": "https://stackoverflow.com/questions/30621682/run-application-commandbars-outside-excel-or-word", "title": "Run application.commandbars() outside excel or word", "body": "<p>i'm trying to figure out a way to run a simple line of vba code like:</p>\n\n<pre><code>application.commandbars(\"research\").enabled = false\n</code></pre>\n\n<p>without opening excel or word (i would like to ref this line of code both for excel and word)</p>\n\n<p>i was thinking of creating a word / excel object in vbs but couldn't think of a way to use this line of code in the same context of the object.</p>\n"}, {"tags": ["excel", "vba", "vlookup"], "comments": [{"owner": {"reputation": 1273, "user_id": 2736419, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b236c8f17151e33cd521d9741307e17c?s=128&d=identicon&r=PG&f=1", "display_name": "Evan Frisch", "link": "https://stackoverflow.com/users/2736419/evan-frisch"}, "edited": false, "score": 1, "creation_date": 1433338481, "post_id": 30621508, "comment_id": 49309407, "body": "Can you show what you have tried?"}, {"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1433338608, "post_id": 30621508, "comment_id": 49309513, "body": "Try turning on the Macro Recorder, inserting the formula, and look at the resulting VBA."}, {"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 2, "creation_date": 1433340721, "post_id": 30621508, "comment_id": 49311204, "body": "But <a href=\"http://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">Why?</a>"}, {"owner": {"reputation": 12569, "user_id": 1316573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d1499fb08570f294d76e76da46cf3b89?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/1316573/daniel"}, "edited": false, "score": 1, "creation_date": 1433348556, "post_id": 30621508, "comment_id": 49317124, "body": "It&#39;s really unclear what you want, but you might just need some absolute references then copy paste: I.E. <code>if(A1 = &quot;&quot;, &quot;&quot;, Vlookup(A1, $K$1:$M$2000,3,false))</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1433541592, "post_id": 30621508, "comment_id": 49414665, "body": "Corrected code formatting and clarified title"}], "answers": [{"tags": [], "owner": {"reputation": 16, "user_id": 4966464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf78115e086a6372eaa8353b4866287?s=128&d=identicon&r=PG&f=1", "display_name": "Jlake0589", "link": "https://stackoverflow.com/users/4966464/jlake0589"}, "is_accepted": true, "score": 0, "last_activity_date": 1433348207, "creation_date": 1433348207, "answer_id": 30625500, "question_id": 30621508, "link": "https://stackoverflow.com/questions/30621508/applying-vlookup-function-with-if-statement-to-a-range/30625500#30625500", "title": "Applying VLOOKUP function with IF statement to a range", "body": "<p>Not sure why you'd want to do this, but you can easily make this function in VBA using the below code. The above function will actually be faster and more efficient in the workbook rather than making the below, but it is possible.</p>\n\n<p>Using the below function should now work in your file for cell B1. Then just copy and paste through B2:B15.</p>\n\n<p>=customVLOOKUP(A1,$K$1:$M$2000,3,FALSE)</p>\n\n<p>Note that the last two arguments are set to 3 and false by default, so =customVLOOKUP(A1,$K$1:$M$2000) will give the same result as above</p>\n\n<pre><code>Function customVLOOKUP(lookup As Range, lookupRng As Range, Optional lookupCol As Integer = 3, Optional lookupType As Boolean = False) As Variant\n\n' check to see if lookup value is empty string\n' if so return empty string to function and exit\n' otherwise, evaluate normal vlookup function\nIf lookup.Value = \"\" Then\n\n    customVLOOKUP = \"\"\n    Exit Function\n\nElse\n\n    customVLOOKUP = Application.WorksheetFunction.VLookup(lookup.Value2, lookupRng, lookupCol, lookupType)\n\nEnd If\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1433542498, "creation_date": 1433542498, "answer_id": 30676590, "question_id": 30621508, "link": "https://stackoverflow.com/questions/30621508/applying-vlookup-function-with-if-statement-to-a-range/30676590#30676590", "title": "Applying VLOOKUP function with IF statement to a range", "body": "<p>If you are looking to put that formula into B1:B15 and have all of the column A references adjust as the formula is filled down, you do not need to loop through the cells. Put the formula into the B1:B15 block of cells and the references to column A will adjust automatically.</p>\n\n<pre><code>with activesheet   '&lt;-reference this worksheet properly!\n    with .range(\"B1:B15\")\n        ' use this one\n        .formula = \"=if(len(A1), iferror(vlookup(A1, K:M, 3, false), \"\"\"\"), \"\"\"\")\"\n        ' or this one\n        .formulaR1C1 = \"=if(len(RC[-1]), iferror(vlookup(A1, C11:C13, 3, false), \"\"\"\"), \"\"\"\")\"\n    end with\nend with\n</code></pre>\n\n<p>Note that each of the pairs of double quotes from the original formula needs to be doubled up as they are quotes within a quoted string. I added an <a href=\"https://support.office.com/en-us/article/IFERROR-function-F59BACDC-78BD-4924-91DF-A869D0B08CD5\" rel=\"nofollow\">IFERROR function</a> to handle non-matches and changes the check on A1 from \"\" to the <a href=\"https://support.office.com/en-us/article/len-lenb-functions-6a149d3a-ba2e-4394-ad47-2eb083265a56\" rel=\"nofollow\">LEN function</a> to ease the double of quotes in the formula.</p>\n"}], "owner": {"reputation": 25, "user_id": 4969789, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155631250065553/picture?type=large", "display_name": "Shawna Baker", "link": "https://stackoverflow.com/users/4969789/shawna-baker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2663, "favorite_count": 0, "accepted_answer_id": 30625500, "answer_count": 2, "score": 0, "last_activity_date": 1433542498, "creation_date": 1433338033, "last_edit_date": 1433541592, "question_id": 30621508, "link": "https://stackoverflow.com/questions/30621508/applying-vlookup-function-with-if-statement-to-a-range", "title": "Applying VLOOKUP function with IF statement to a range", "body": "<p>I'm trying to write a VBA code that would be the equivalent of this excel function for a definite range of cells. </p>\n\n<pre><code>=if(A1=\"\", \"\", vlookup(A1, K1:M2000, 3, false))\n</code></pre>\n\n<p>I want to apply this for range(A1:A15) and insert the function in range (B1:B15) using VBA.</p>\n"}, {"tags": ["regex", "vba", "excel", "match"], "answers": [{"tags": [], "owner": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "is_accepted": false, "score": 0, "last_activity_date": 1433344009, "creation_date": 1433344009, "answer_id": 30623961, "question_id": 30621472, "link": "https://stackoverflow.com/questions/30621472/replace-text-in-column-with-code-from-another-sheet-in-text-partial-matches/30623961#30623961", "title": "Replace text in Column with code from another sheet in text partial matches", "body": "<p>I shouldn't really write the code from scratch for you, but I was bored...</p>\n\n<pre><code>Sub FindInString()\n\n    Dim rngCell_1 As Range\n    Dim rngCell_2 As Range\n\n    'loop through sheet 1\n    For Each rngCell_1 In Worksheets(1).Range(\"A1:A10\")\n        'loop through sheet 2\n        For Each rngCell_2 In Worksheets(2).Range(\"A1:A50\")\n            'if have found the range\n            If InStr(0, rngCell_2.Text, rngCell_1.Text) &lt;&gt; 0 Then\n                'change the value\n                rngCell_1.Value = rngCell_2.Value\n            End If\n        Next rngCell_2\n    Next rngCell_1\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4969807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd85ff326ba052e1728038c21b674dd7?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Griswold", "link": "https://stackoverflow.com/users/4969807/eric-griswold"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1433344009, "creation_date": 1433337941, "question_id": 30621472, "link": "https://stackoverflow.com/questions/30621472/replace-text-in-column-with-code-from-another-sheet-in-text-partial-matches", "title": "Replace text in Column with code from another sheet in text partial matches", "body": "<p>I am looking for a way to scan a column in a sheet and if the code matches with a longer version of the code on a separate sheet, replace the short code with the longer code. For example on sheet1 in column 1 rows 1-10 contain code \"ABCD\". Search sheet 2 column 1 and find \"Code_Type_ABCD\" and replace \"ABCD\" in sheet one with the value \"Code_Type_ABCD\" from sheet 2. There are 50 different codes on sheet 1 that will need to be searched for and replaced with values from sheet 2.</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "edited": false, "score": 0, "creation_date": 1433344166, "post_id": 30621103, "comment_id": 49313963, "body": "From reading it, I would have thought Vlookup should do what you need. What made you think otherwise?"}], "answers": [{"tags": [], "owner": {"reputation": 693, "user_id": 4908847, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Kjes0.jpg?s=128&g=1", "display_name": "szaman", "link": "https://stackoverflow.com/users/4908847/szaman"}, "is_accepted": true, "score": 1, "last_activity_date": 1433344899, "creation_date": 1433344899, "answer_id": 30624287, "question_id": 30621103, "link": "https://stackoverflow.com/questions/30621103/excel-vba-loop-column-and-copy-data/30624287#30624287", "title": "Excel VBA Loop column and copy data", "body": "<p>try this. note that you will need to have an empty column that will temporarly hold a mark if the value in the row has been found \u2014 in my example i used the \"I\" column, you will need to modify this if it's not empty.</p>\n\n<pre><code>Private Sub pasteValues()\nDim i, j, lastG, lastD As Long\n\n' find last row\nlastG = Sheets(\"Global\").Cells(Rows.Count, \"B\").End(xlUp).Row\nlastD = Sheets(\"Details\").Cells(Rows.Count, \"B\").End(xlUp).Row\n\n' loop over values in \"Global\"\nFor i = 1 To lastG\n    lookupVal = Sheets(\"Global\").Cells(i, \"B\") ' value to find\n\n    ' loop over values in \"details\"\n    For j = 1 To lastD\n        currVal = Sheets(\"Details\").Cells(j, \"B\")\n\n        If lookupVal = currVal Then\n            Sheets(\"Global\").Cells(i, \"O\") = Sheets(\"Details\").Cells(j, \"H\")\n            Sheets(\"Global\").Cells(i, \"P\") = Sheets(\"Details\").Cells(j, \"E\")\n            Sheets(\"Global\").Cells(i, \"Q\") = Sheets(\"Details\").Cells(j, \"D\")\n            ' mark the row\n            Sheets(\"Details\").Cells(j, \"I\") = \"marked\"\n\n        End If\n    Next j\nNext i\n\n' loop over rows in \"details\" and delete rows which have not been marked\nFor j = 1 To lastD\n    If Sheets(\"Details\").Cells(j, \"I\") &lt;&gt; \"marked\" Then\n        ' delete unmarked rows\n        Sheets(\"Details\").Cells(j, \"A\").EntireRow.Delete\n        If Sheets(\"Details\").Cells(j, \"B\") &lt;&gt; \"\" Then\n            j = j - 1 ' revert iterator so it doesn't skip rows\n        End If\n    Else:\n        ' remove the mark\n        Sheets(\"Details\").Cells(j, \"I\") = \"\"\n    End If\nNext j\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 491, "user_id": 4925420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a46e2bd849822edc3501d1f41079f607?s=128&d=identicon&r=PG&f=1", "display_name": "atame", "link": "https://stackoverflow.com/users/4925420/atame"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3165, "favorite_count": 0, "accepted_answer_id": 30624287, "answer_count": 1, "score": 0, "last_activity_date": 1433344899, "creation_date": 1433337013, "question_id": 30621103, "link": "https://stackoverflow.com/questions/30621103/excel-vba-loop-column-and-copy-data", "title": "Excel VBA Loop column and copy data", "body": "<p>I need some help with a bit of code i'm trying to write. I am not very experienced in VBA, I thought a VLookup is what i needed but after thinking about it. I think a Find loop with work even better.</p>\n\n<p>There will be a button click on sheet1. </p>\n\n<p>The code will need to do the following, in sheet \"Global\" use column B and search range, each row will have a different value, it will need to search the cell value row by row, in Sheet \"Details\"  if match found then copy the data from columns H, F &amp; E and paste into columns O, P &amp; Q in the Global sheet. H = O, E = P, D = Q. Loop through until first empty row.</p>\n\n<p>In the Details sheet, in column B if there was no data matching from Details then the row will get deleted. </p>\n\n<p><strong>For Example:</strong></p>\n\n<p>Global Before:\n<img src=\"https://i.stack.imgur.com/k79Zb.jpg\" alt=\"enter image description here\"></p>\n\n<p>Details Before:\n<img src=\"https://i.stack.imgur.com/0kmFu.jpg\" alt=\"enter image description here\"></p>\n\n<p><strong>After Code has run:</strong></p>\n\n<p>Global After:\n<img src=\"https://i.stack.imgur.com/YCwZ6.jpg\" alt=\"enter image description here\"></p>\n\n<p>Details After:\n<img src=\"https://i.stack.imgur.com/O3y6V.jpg\" alt=\"enter image description here\"></p>\n\n<p>Hopefully this explains it well enough, as you can seen it has found the matching data and copied it to the relevant rows, all non matching data has been deleted.</p>\n\n<p>I have no code at the moment because if i honest i have no idea where to start!!! All help is much appreciated!!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "edited": false, "score": 0, "creation_date": 1433337718, "post_id": 30620941, "comment_id": 49308762, "body": "Hi. SO is about helping with problems in your code, so why don&#39;t you share the bit of code you tried with us? By looking at the code and with you providing information about what went wrong, we&#39;ll be better able to help you."}, {"owner": {"reputation": 1, "user_id": 4061628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21a9c4837e855acbdca59eca835db225?s=128&d=identicon&r=PG&f=1", "display_name": "mercuryrsng", "link": "https://stackoverflow.com/users/4061628/mercuryrsng"}, "reply_to_user": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "edited": false, "score": 0, "creation_date": 1433338277, "post_id": 30620941, "comment_id": 49309251, "body": "Sorry about that, here is the code that I generated creating the simple macro.  Also, I have attached a link to a new image with row and column values......<a href=\"http://imgur.com/z2DtfaD\" rel=\"nofollow noreferrer\">imgur.com/z2DtfaD</a>  Sub Macro9() &#39; &#39; Macro9 Macro &#39; &#39; Keyboard Shortcut: Ctrl+q &#39;     Selection.Copy     Sheets.Add After:=Sheets(Sheets.Count)     ActiveSheet.Paste     Sheets(&quot;Schedule&quot;).Select     Range(&quot;G4&quot;).Select     Application.CutCopyMode = False     Selection.Copy     Sheets(&quot;Sheet1&quot;).Select     Range(&quot;B1&quot;).Select     ActiveSheet.Paste End Sub"}, {"owner": {"reputation": 1, "user_id": 4061628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21a9c4837e855acbdca59eca835db225?s=128&d=identicon&r=PG&f=1", "display_name": "mercuryrsng", "link": "https://stackoverflow.com/users/4061628/mercuryrsng"}, "reply_to_user": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "edited": false, "score": 0, "creation_date": 1433338311, "post_id": 30620941, "comment_id": 49309268, "body": "It is not formatting my code the way that I intended....."}, {"owner": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "edited": false, "score": 0, "creation_date": 1433338431, "post_id": 30620941, "comment_id": 49309370, "body": "You can edit your question and post your code there. But as there already is an answer, you can take this as a hint for future questions ;)"}, {"owner": {"reputation": 1, "user_id": 4061628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21a9c4837e855acbdca59eca835db225?s=128&d=identicon&r=PG&f=1", "display_name": "mercuryrsng", "link": "https://stackoverflow.com/users/4061628/mercuryrsng"}, "reply_to_user": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "edited": false, "score": 0, "creation_date": 1433338985, "post_id": 30620941, "comment_id": 49309828, "body": "Yes I see that now.  Thanks for the tip!  Working on the answer now."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4061628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21a9c4837e855acbdca59eca835db225?s=128&d=identicon&r=PG&f=1", "display_name": "mercuryrsng", "link": "https://stackoverflow.com/users/4061628/mercuryrsng"}, "edited": false, "score": 0, "creation_date": 1433338115, "post_id": 30621397, "comment_id": 49309096, "body": "Where do I put that code?  Again, I am a beginner at these advanced Excel techniques."}, {"owner": {"reputation": 37, "user_id": 4637650, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/266c5788f4188d4ca409d75ab6c8dd61?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/4637650/tony"}, "reply_to_user": {"reputation": 1, "user_id": 4061628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21a9c4837e855acbdca59eca835db225?s=128&d=identicon&r=PG&f=1", "display_name": "mercuryrsng", "link": "https://stackoverflow.com/users/4061628/mercuryrsng"}, "edited": false, "score": 0, "creation_date": 1433338414, "post_id": 30621397, "comment_id": 49309353, "body": "In a code module through your VBE. Do a quick web search on how to insert code in your macro-enabled project. There are tons of guides to show you how."}, {"owner": {"reputation": 1, "user_id": 4061628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21a9c4837e855acbdca59eca835db225?s=128&d=identicon&r=PG&f=1", "display_name": "mercuryrsng", "link": "https://stackoverflow.com/users/4061628/mercuryrsng"}, "edited": false, "score": 0, "creation_date": 1433338965, "post_id": 30621397, "comment_id": 49309800, "body": "OK I got that far.  Now, how do I run the code that I just inserted?"}, {"owner": {"reputation": 37, "user_id": 4637650, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/266c5788f4188d4ca409d75ab6c8dd61?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/4637650/tony"}, "reply_to_user": {"reputation": 1, "user_id": 4061628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21a9c4837e855acbdca59eca835db225?s=128&d=identicon&r=PG&f=1", "display_name": "mercuryrsng", "link": "https://stackoverflow.com/users/4061628/mercuryrsng"}, "edited": false, "score": 0, "creation_date": 1433339556, "post_id": 30621397, "comment_id": 49310285, "body": "Place your cursor anywhere within the procedure and hit F5."}, {"owner": {"reputation": 1, "user_id": 4061628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21a9c4837e855acbdca59eca835db225?s=128&d=identicon&r=PG&f=1", "display_name": "mercuryrsng", "link": "https://stackoverflow.com/users/4061628/mercuryrsng"}, "edited": false, "score": 0, "creation_date": 1433339825, "post_id": 30621397, "comment_id": 49310507, "body": "The current problem that I have is that I have no macros saved since I deleted the ones that weren&#39;t working. When I try to create a macro, &quot;create&quot; is greyed out.  The only option that I have is to record a macro."}], "tags": [], "owner": {"reputation": 37, "user_id": 4637650, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/266c5788f4188d4ca409d75ab6c8dd61?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/4637650/tony"}, "is_accepted": false, "score": 0, "last_activity_date": 1433337759, "creation_date": 1433337759, "answer_id": 30621397, "question_id": 30620941, "link": "https://stackoverflow.com/questions/30620941/create-an-excel-worksheet-based-on-specific-column-values/30621397#30621397", "title": "Create an Excel worksheet based on specific column values", "body": "<p>Try this:</p>\n\n<pre><code>Dim wks As Worksheet\nDim lstRow As ListRow\n\nFor Each lstRow In ThisWorkbook.Worksheets(\"Sheet1\").ListObjects(\"Table1\").ListRows\n    Set wks = ThisWorkbook.Worksheets.Add\n    wks.Name = lstRow.Range.Cells(, 1).Value\n    With wks\n        .Range(.Cells(1, 1), .Cells(1, lstRow.Range.Columns.Count)) = lstRow.Range.Value\n    End With\nNext\n\nSet wks = Nothing\n</code></pre>\n\n<p>Assumptions: </p>\n\n<ul>\n<li>Worksheet name where data resides is called Sheet1</li>\n<li>Table containing data is a ListObject (e.g., convert your data range into an Excel table)</li>\n<li>ListObject name is Table1</li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 4061628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21a9c4837e855acbdca59eca835db225?s=128&d=identicon&r=PG&f=1", "display_name": "mercuryrsng", "link": "https://stackoverflow.com/users/4061628/mercuryrsng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1307, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1433426290, "creation_date": 1433336659, "last_edit_date": 1433426290, "question_id": 30620941, "link": "https://stackoverflow.com/questions/30620941/create-an-excel-worksheet-based-on-specific-column-values", "title": "Create an Excel worksheet based on specific column values", "body": "<p>I am enclosing a <a href=\"http://imgur.com/k6JEE25\" rel=\"nofollow\">link</a> with a sample spreadsheet. </p>\n\n<p>What I would like to do is create multiple worksheets using the key column of \"Facility\", perhaps using a macro.  For example, I would like to create a new worksheet called <code>Houston</code> and fill the worksheet with the data specific to that row.  Some of the cells may end up in different locations in the new worksheet.  I need to do a separate worksheet for every value in \"Facility\".  The original that I am working on has 270 rows (270 facilities).</p>\n\n<p>Does anyone have any idea how to do something like this?  I am new to running and creating macros.  I did create a macro that didn't work right.</p>\n"}, {"tags": ["vba", "visio"], "comments": [{"owner": {"reputation": 448, "user_id": 4153614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/095f33d30e635ec361b40886041b9153?s=128&d=identicon&r=PG&f=1", "display_name": "kponz", "link": "https://stackoverflow.com/users/4153614/kponz"}, "edited": false, "score": 0, "creation_date": 1433336671, "post_id": 30620701, "comment_id": 49307874, "body": "Do you want to disable only certain cut/copy/paste, or is disabling all of them an option? Take a look at this example: <a href=\"http://www.vbaexpress.com/kb/getarticle.php?kb_id=373\" rel=\"nofollow noreferrer\">vbaexpress.com/kb/getarticle.php?kb_id=373</a>"}, {"owner": {"reputation": 139, "user_id": 2161432, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/95d599e9bcd6c937757d9cd66781a413?s=128&d=identicon&r=PG", "display_name": "M.Ford", "link": "https://stackoverflow.com/users/2161432/m-ford"}, "reply_to_user": {"reputation": 448, "user_id": 4153614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/095f33d30e635ec361b40886041b9153?s=128&d=identicon&r=PG&f=1", "display_name": "kponz", "link": "https://stackoverflow.com/users/4153614/kponz"}, "edited": false, "score": 0, "creation_date": 1433342973, "post_id": 30620701, "comment_id": 49312945, "body": "that was a great idea and would have work except that the application.OnKey doesn&#39;t work for Visio. The code is for Excel. I wish it would have worked, though. It would have been the solution."}], "answers": [{"tags": [], "owner": {"reputation": 139, "user_id": 2161432, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/95d599e9bcd6c937757d9cd66781a413?s=128&d=identicon&r=PG", "display_name": "M.Ford", "link": "https://stackoverflow.com/users/2161432/m-ford"}, "is_accepted": false, "score": 1, "last_activity_date": 1433355304, "creation_date": 1433355304, "answer_id": 30627672, "question_id": 30620701, "link": "https://stackoverflow.com/questions/30620701/visio-vba-copy-cut-paste-intercept/30627672#30627672", "title": "Visio VBA copy/cut/paste intercept", "body": "<p>Thanks all! I did find a solution and it was really elegant. I found the idea here and changed it to what I needed:</p>\n\n<p>Shape added event: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff767288.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff767288.aspx</a></p>\n\n<p>Here is what I came up with:</p>\n\n<pre><code>Private Sub Document_ShapeAdded(ByVal vsoShape As Visio.IVShape)\n    If vsoShape.CellExistsU(\"Prop.ShapeName\", 0) Then\n        vsoShape.CellsU(\"Prop.ShapeName\").Formula = Chr(34) &amp; \"ShapeName\" &amp; Chr(34)\n    End If\nEnd Sub\n</code></pre>\n\n<p>The interesting thing is that it doesn't fire if I add the shape via VBA. That is perfect for what I need but I would have thought that dropping a shape is adding a shape. I am only looking for one property because not all shapes on the stencils come from a database and for those objects, I don't need to do anything.</p>\n\n<p>It was not the solution that I expected but it works really well.</p>\n"}], "owner": {"reputation": 139, "user_id": 2161432, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/95d599e9bcd6c937757d9cd66781a413?s=128&d=identicon&r=PG", "display_name": "M.Ford", "link": "https://stackoverflow.com/users/2161432/m-ford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 658, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593554525, "creation_date": 1433335986, "last_edit_date": 1593554525, "question_id": 30620701, "link": "https://stackoverflow.com/questions/30620701/visio-vba-copy-cut-paste-intercept", "title": "Visio VBA copy/cut/paste intercept", "body": "<p>I have another challenge. Has anyone tried to intercept the copy/paste events? My goal is to prevent someone from cut/copy/paste a shape that is already on a sheet. If they drag it from a stencil, that is fine. I just can't have them duplicate an existing shape. To make this a bit harder, it is only the shape that I need to prevent. If the want to copy text, that is fine. </p>\n\n<p>We have a order type database that contains items that need to be dropped on a Visio sheet. I cannot use the shapeID because I need to be able to update the shape from the database and I can't write the ID back to the database as it is against security policy. The way that I am tying the two together is a property named shapeKey and that value is provided by the database at the time the shape is dropped.</p>\n\n<p>When a use needs to refresh the sheet from the database, I interate through the shapes, comparing the shapeKey in the shape and in the database. if there is a match, I do an update of the other properties. If there is no match, I want to delete the shape. if a user copies a shape, the shapeKey will also be duplicated and that causes problems. Lastly, they can add their own shapes from stencils and those shapes must be excluded from the delete process</p>\n\n<p>I have two options:</p>\n\n<ol>\n<li>Disable shape cut/copy/paste</li>\n<li>Intercept the copy/cut and when they paste, change a property so that I know that it was a user pasted shape. This is preferred because it is more user friendly</li>\n<li>I just thought if another way I that might work. Is there a way to lock the shapes to prevent the copy? If there is a lock, would that also lock the location? The user needs to be able to most the shapes around.</li>\n</ol>\n\n<p>I thought about capturing the event but I could not find the event codes to look for. I cannot install the Visio SDK which has the Event monitor. The monitor might have shown me the code. Here is some pseudo code as to what I think would be the flow.</p>\n\n<p>option 1</p>\n\n<pre><code>if select item is a shape then\n    msgbox \"shape copying verboten. please us the stencil\"\n    clear selected item\n</code></pre>\n\n<p>option 2</p>\n\n<pre><code>capture the paste event\n    if selected item is a shape then\n        vsoShape.Cells(\"Prop.ShapeKey\").Formula = Chr(34) &amp; \"protect\" &amp; Chr(34)\n</code></pre>\n\n<p>Layers might work. All the database controlled shapes can be on one layers and all the user shapes on another but I haven't worked with layers before. would that work? How can I be sure that any shape pasted goes onto the user layer?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1433335966, "post_id": 30620589, "comment_id": 49307305, "body": "What are the values of <code>n</code> and <code>i</code> when the error occurs?"}, {"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1433336068, "post_id": 30620589, "comment_id": 49307368, "body": "@Rory I dunno how to check those values :&#39;("}, {"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1433336232, "post_id": 30620589, "comment_id": 49307513, "body": "View --&gt; Immediate window; then in immediate window type ? &lt;variable&gt;  e.g. ? i and then click enter. Can I guess that the number in i is 162?"}, {"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "reply_to_user": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1433336484, "post_id": 30620589, "comment_id": 49307735, "body": "@99moorem Thanks. It really helps :)"}, {"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1433336559, "post_id": 30620589, "comment_id": 49307796, "body": "@Rory I got <code>n = 5000</code> and <code>i = 162</code>"}, {"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1433336606, "post_id": 30620589, "comment_id": 49307822, "body": "combin(5000,162) produces a number that is to big for a double to hold."}, {"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "reply_to_user": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1433336736, "post_id": 30620589, "comment_id": 49307917, "body": "@99moorem So what should I assign the variable <code>CB</code> then to handle the number C(5000,162)?"}, {"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1433337018, "post_id": 30620589, "comment_id": 49308138, "body": "It may be that the function Combin doesnt like that large of a value I am not sure - only say that as even in a worksheet it does not like it get #NUM!. Hopefully @Rory has an idea!"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1433337027, "post_id": 30620589, "comment_id": 49308144, "body": "You can&#39;t, I don&#39;t think. It wouldn&#39;t work in a cell either."}, {"owner": {"reputation": 1213, "user_id": 1354522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8936dc371fd2d9bdd770b47005646c62?s=128&d=identicon&r=PG", "display_name": "GELR", "link": "https://stackoverflow.com/users/1354522/gelr"}, "edited": false, "score": 2, "creation_date": 1433337134, "post_id": 30620589, "comment_id": 49308247, "body": "A quick search revealed an answer on this site: <a href=\"http://stackoverflow.com/questions/24875432/run-time-error-1004-unable-to-get-the-combin-property-of-the-worksheetfunctio\" title=\"run time error 1004 unable to get the combin property of the worksheetfunctio\">stackoverflow.com/questions/24875432/&hellip;</a>"}, {"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "reply_to_user": {"reputation": 1213, "user_id": 1354522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8936dc371fd2d9bdd770b47005646c62?s=128&d=identicon&r=PG", "display_name": "GELR", "link": "https://stackoverflow.com/users/1354522/gelr"}, "edited": false, "score": 0, "creation_date": 1433337907, "post_id": 30620589, "comment_id": 49308914, "body": "@GELR Thanks for the info"}], "answers": [{"tags": [], "owner": {"reputation": 106, "user_id": 5135721, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-g79q4RQxFOM/AAAAAAAAAAI/AAAAAAAABSk/LMMhL9NMT0M/photo.jpg?sz=128", "display_name": "n0v1c3", "link": "https://stackoverflow.com/users/5135721/n0v1c3"}, "is_accepted": false, "score": 1, "last_activity_date": 1437680094, "last_edit_date": 1437680094, "creation_date": 1437678940, "answer_id": 31596209, "question_id": 30620589, "link": "https://stackoverflow.com/questions/30620589/binomial-european-options-pricing-model/31596209#31596209", "title": "Binomial European Options Pricing Model", "body": "<p>You are getting an overflow error. If you check on a work sheet:</p>\n\n<pre><code>COMBIN(5000, 161) = 3.3E+307\nCOMBIN(5000, 162) = #NUM!\n\nCOMBIN(5000, 4838) = #NUM!\nCOMBIN(5000, 4839) = 3.3E+307\n</code></pre>\n\n<p>Remember that the number of combinations increases exponentially up until the halfway point in which it will start to go down at an inverse rate.</p>\n"}, {"tags": [], "owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "is_accepted": true, "score": 1, "last_activity_date": 1438041801, "creation_date": 1438041801, "answer_id": 31665365, "question_id": 30620589, "link": "https://stackoverflow.com/questions/30620589/binomial-european-options-pricing-model/31665365#31665365", "title": "Binomial European Options Pricing Model", "body": "<p>Is your equation for S correct? It seems like it should be:</p>\n\n<pre><code>S = M * CB * (p ^ i) ...\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>S = M * CB * (p ^ n) ...\n</code></pre>\n\n<p>If your equation is indeed wrong, then you can use BINOMDIST instead of COMBIN, because by definition:</p>\n\n<pre><code>Binom_Dist(i, n, p, False) = (p ^ i) * (1 - p) ^ (n - i) * Combin(n, i)\n</code></pre>\n\n<p>So your code would be:</p>\n\n<pre><code>S = M * WorksheetFunction.Binom_Dist(i, n, p, False)\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>CB = WorksheetFunction.Combin(n, i)\nS = M * CB * (p ^ n) * (1 - p) ^ (n - i)\n</code></pre>\n\n<p>BINOMDIST is not as sensitive to large n, i.</p>\n"}], "owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 872, "favorite_count": 0, "accepted_answer_id": 31665365, "answer_count": 2, "score": 4, "last_activity_date": 1438041801, "creation_date": 1433335713, "last_edit_date": 1433426189, "question_id": 30620589, "link": "https://stackoverflow.com/questions/30620589/binomial-european-options-pricing-model", "title": "Binomial European Options Pricing Model", "body": "<p>I created a program, using VBA, to calculate the European Call option price, as follows:</p>\n\n<pre><code>Private Sub CallPrice_Click()\nDim K As Single\nDim So As Single\nDim r As Single\nDim T As Single\nDim sigma As Single\nDim u As Single\nDim d As Single\nDim p As Single\nDim CP As Single\nDim M As Single\nDim S As Single\nDim CB As Double\nDim n As Integer\nDim i As Integer\n\nK = Cells(2, 2)\nSo = Cells(3, 2)\nr = Cells(4, 2)\nT = Cells(5, 2)\nsigma = Cells(6, 2)\nn = Cells(7, 2)\nu = Exp(sigma * Sqr(T / n))\nd = 1 / u\np = (Exp(r * T / n) - d) / (u - d)\nCP = 0\nFor i = 0 To n Step 1\n    M = WorksheetFunction.Max(So * (u ^ i) * d ^ (n - i) - K, 0)\n    CB = WorksheetFunction.Combin(n, i)\n    S = M * CB * (p ^ n) * (1 - p) ^ (n - i)\n    CP = CP + S\nNext i\nCells(9, 2) = CP / (1 + r) ^ n\nEnd Sub\n</code></pre>\n\n<p>Here is the layout of the spreadsheet:</p>\n\n<p><img src=\"https://i.stack.imgur.com/aSGRz.png\" alt=\"enter image description here\"></p>\n\n<p>When I ran the program, the error occurred.</p>\n\n<p><img src=\"https://i.stack.imgur.com/jWfA8.png\" alt=\"enter image description here\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/CAJ0R.png\" alt=\"enter image description here\"></p>\n\n<p>Could someone here explain what is wrong in my program and how to fix it?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 712, "user_id": 3243922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mFTEb.jpg?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3243922/tom"}, "edited": false, "score": 1, "creation_date": 1433339832, "post_id": 30620517, "comment_id": 49310511, "body": "The same thing would be using Set r = Range(&quot;1:1&quot;) which works by the way..."}], "answers": [{"comments": [{"owner": {"reputation": 70, "user_id": 4144557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31887b81eeb0945dad8704d6553fca80?s=128&d=identicon&r=PG", "display_name": "Meelan", "link": "https://stackoverflow.com/users/4144557/meelan"}, "edited": false, "score": 0, "creation_date": 1607508120, "post_id": 30620798, "comment_id": 115291975, "body": "Thank you @Rory"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 10, "last_activity_date": 1433336263, "creation_date": 1433336263, "answer_id": 30620798, "question_id": 30620517, "link": "https://stackoverflow.com/questions/30620517/syntax-to-define-an-entire-row-as-range/30620798#30620798", "title": "Syntax to Define an Entire Row as Range", "body": "<p>You can use:</p>\n\n<pre><code>   Set r = Rows(1).Cells\n</code></pre>\n\n<p>or just use:</p>\n\n<pre><code>   MsgBox r.Cells(1).Address &amp; vbCrLf &amp; r.Cells(2).Address\n</code></pre>\n\n<p>but note that accessing the Range (or Cells) property of a range using an index will never be restricted to that range alone.</p>\n"}, {"comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1433339770, "post_id": 30622055, "comment_id": 49310460, "body": "Why would the addresses be different? The count is counting either rows or cells, but the address always refers to the same range."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 1, "creation_date": 1433339854, "post_id": 30622055, "comment_id": 49310535, "body": "First, thank you for responding......I now understand that a single column can be either a <b>Column</b> Object or a <b>Range</b> Object......the addresses are the same, but the counts are different because there is only one Column, but many Cells."}], "tags": [], "owner": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "is_accepted": false, "score": 7, "last_activity_date": 1433339318, "creation_date": 1433339318, "answer_id": 30622055, "question_id": 30620517, "link": "https://stackoverflow.com/questions/30620517/syntax-to-define-an-entire-row-as-range/30622055#30622055", "title": "Syntax to Define an Entire Row as Range", "body": "<p>The row equivalent to </p>\n\n<pre><code>Set r = Range(\"A:A\")\n</code></pre>\n\n<p>would be </p>\n\n<pre><code>Set r = Range(\"1:1\")\n</code></pre>\n\n<p>I was curious and ran these tests building on Rory's answer.  Maybe someone else can explain the addresses being the same and the counts being different.</p>\n\n<pre><code>Sub test()\n    Debug.Print Me.Range(\"A:A\").Count '1048576\n    Debug.Print Me.Columns(1).Count '1\n    Debug.Print Me.Columns(1).Cells.Count '1048576\n\n    Debug.Print Me.Range(\"1:1\").Count '16384\n    Debug.Print Me.Rows(1).Count '1\n    Debug.Print Me.Rows(1).Cells.Count '16384\n\n    'interseting to me since the counts are different but the addresses are the same\n    Debug.Print Me.Range(\"1:1\").Address '$1:$1\n    Debug.Print Me.Rows(1).Address '$1:$1\n    Debug.Print Me.Rows(1).Cells.Address '$1:$1\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23047, "favorite_count": 0, "accepted_answer_id": 30620798, "answer_count": 2, "score": 5, "last_activity_date": 1593967377, "creation_date": 1433335540, "last_edit_date": 1593967377, "question_id": 30620517, "link": "https://stackoverflow.com/questions/30620517/syntax-to-define-an-entire-row-as-range", "title": "Syntax to Define an Entire Row as Range", "body": "<p>In Excel, I can define an <strong>entire column</strong> as a range and address individual cells in that range like:</p>\n\n<pre><code>Sub headache()\n   Dim r As Range\n   Set r = Range(\"A:A\")\n   MsgBox r(1).Address &amp; vbCrLf &amp; r(2).Address\nEnd Sub\n</code></pre>\n\n<p>If I try to do the same thing with an <strong>entire row</strong>:</p>\n\n<pre><code>Sub headache2()\n   Dim r As Range\n   Set r = Rows(1)\n   MsgBox r(1).Address &amp; vbCrLf &amp; r(2).Address\nEnd Sub\n</code></pre>\n\n<p>I do not get the individual cells in the range.  My workaround is:</p>\n\n<pre><code>Set r = Range(Cells(1, 1), Cells(1, Columns.Count))\n</code></pre>\n\n<p>I can't believe this is the simplest way to make the range...........any suggestions??</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 930, "user_id": 4600127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc7345ceed5fb91c40faebc880ae994?s=128&d=identicon&r=PG&f=1", "display_name": "Verzweifler", "link": "https://stackoverflow.com/users/4600127/verzweifler"}, "edited": false, "score": 2, "creation_date": 1433337116, "post_id": 30620337, "comment_id": 49308233, "body": "This holds especially true if you&#39;re also handling <code>Range</code> variables in your code, as you won&#39;t be confused if you, for example, are also copying Ranges. For more infos on .Text/.Value/.Value2 see <a href=\"http://stackoverflow.com/a/17363466/4600127\">this SO link</a>."}], "tags": [], "owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "is_accepted": true, "score": 1, "last_activity_date": 1433335095, "creation_date": 1433335095, "answer_id": 30620337, "question_id": 30620220, "link": "https://stackoverflow.com/questions/30620220/when-should-i-use-value-on-cells-in-vba/30620337#30620337", "title": "When should I use value() on cells() in vba?", "body": "<p>The default property of <code>Cells</code> in VBA is <code>Value</code>. There's no difference in using it vs not using it.</p>\n\n<p>I prefer to explicitly define the <code>Value</code> property though for the sake of debugging and helping others who may read my code in future as it is a clear indication of what the code is trying to achieve.</p>\n"}], "owner": {"reputation": 4045, "user_id": 689990, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/c9baee4e96ed5b21f3c0589418d4e73c?s=128&d=identicon&r=PG", "display_name": "egor7", "link": "https://stackoverflow.com/users/689990/egor7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 30620337, "answer_count": 1, "score": 0, "last_activity_date": 1594644373, "creation_date": 1433334802, "last_edit_date": 1594644373, "question_id": 30620220, "link": "https://stackoverflow.com/questions/30620220/when-should-i-use-value-on-cells-in-vba", "title": "When should I use value() on cells() in vba?", "body": "<p>I'm trying to read and set Excel cells values with <code>Cells(1,1)</code>. I was successful with reading this value. But I've seen code with <code>Cells(1,1).Value()</code>. So when should I use the notation itself: <code>Cells(1,1)</code> and notation with <code>.Value()</code> <code>(Text()/Value2())</code>?</p>\n"}, {"tags": ["vba", "outlook", "certificate", "outlook-2013"], "answers": [{"comments": [{"owner": {"reputation": 1258, "user_id": 4383152, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/152bf463f05774e13dec69c45832882b?s=128&d=identicon&r=PG&f=1", "display_name": "BerndGit", "link": "https://stackoverflow.com/users/4383152/berndgit"}, "edited": false, "score": 0, "creation_date": 1433342278, "post_id": 30620478, "comment_id": 49312434, "body": "This is equivalent the option (1), which i have tried. Unfortunatly this solution which seemed to be obvious was not working. Outlook deactivated the macros regardless of this option."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 1258, "user_id": 4383152, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/152bf463f05774e13dec69c45832882b?s=128&d=identicon&r=PG&f=1", "display_name": "BerndGit", "link": "https://stackoverflow.com/users/4383152/berndgit"}, "edited": false, "score": 0, "creation_date": 1433346849, "post_id": 30620478, "comment_id": 49316065, "body": "Did you try to restart Outlook after changing the Trust Center settings?"}, {"owner": {"reputation": 1258, "user_id": 4383152, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/152bf463f05774e13dec69c45832882b?s=128&d=identicon&r=PG&f=1", "display_name": "BerndGit", "link": "https://stackoverflow.com/users/4383152/berndgit"}, "edited": false, "score": 0, "creation_date": 1433745635, "post_id": 30620478, "comment_id": 49463096, "body": "Yes. I did even try a windows restart. I&#39;m currently suspecting a bug in Outlook and was hoping that there is a known workaround."}, {"owner": {"reputation": 470, "user_id": 3727308, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3a8b11c4319e25f04c5201a2e3e79d30?s=128&d=identicon&r=PG", "display_name": "ChaosFreak", "link": "https://stackoverflow.com/users/3727308/chaosfreak"}, "edited": false, "score": 0, "creation_date": 1511113415, "post_id": 30620478, "comment_id": 81712138, "body": "This is not true. You don&#39;t need to purchase a certificate. Self-signed certificates should work fine. I had this same problem and the solution here fixed it: <a href=\"https://social.technet.microsoft.com/Forums/en-US/07f0158c-085b-4031-93a1-c9d047cf855c/unable-to-sign-outlook-2010-vbaproject?forum=outlook\" rel=\"nofollow noreferrer\">social.technet.microsoft.com/Forums/en-US/&hellip;</a>.  The thread is long, but the gist of it is you need to manually save your VBA project after signing, and before exiting the VBA editor. Scroll down about 2/3rds of the way to the post by &quot;Diane Poremsky [MVP]&quot;."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1511781801, "post_id": 30620478, "comment_id": 81975210, "body": "Self-signed certificate is designed to work only on your machines. That&#39;s made for testing purposes mainly. There should be a third part which can confirm the code comes from a trusted vendor. See <a href=\"https://en.wikipedia.org/wiki/Digital_signature\" rel=\"nofollow noreferrer\">Digital signature</a> for more information."}, {"owner": {"reputation": 355, "user_id": 1259330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0JhSL.jpg?s=128&g=1", "display_name": "perfo", "link": "https://stackoverflow.com/users/1259330/perfo"}, "edited": false, "score": 0, "creation_date": 1523228263, "post_id": 30620478, "comment_id": 86460831, "body": "It also seems to be different for different versions of outlook. I have never had any problems with certificates until office 2016. The work around at the top of the thread worked for me."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": -2, "last_activity_date": 1433335453, "creation_date": 1433335453, "answer_id": 30620478, "question_id": 30619881, "link": "https://stackoverflow.com/questions/30619881/microsoft-outlook-2013-error-verify-vba-project-signature/30620478#30620478", "title": "Microsoft Outlook 2013: Error verify VBA project signature", "body": "<p>You need to change the Trust Center settings (run all macros, not only digitally signed) or purchase a valid certificate from a trusted authority. </p>\n"}, {"comments": [{"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1511781942, "post_id": 30735745, "comment_id": 81975284, "body": "That&#39;s because your project/code used a self-signed certificate. When you move the code on another machine you need to use a certificate from a trusted vendor which can confirm that. Self-signed certificates are used for testing mainly."}, {"owner": {"reputation": 1251, "user_id": 650264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fa52b1a2d80c5b6bdda406a710add4d?s=128&d=identicon&r=PG", "display_name": "tbc0", "link": "https://stackoverflow.com/users/650264/tbc0"}, "edited": false, "score": 0, "creation_date": 1532099392, "post_id": 30735745, "comment_id": 89861278, "body": "Worth noting that the reason I got into self-signing macros was so I could run with higher security, disabling unsigned macros. After setting macro security thus and starting Outlook as non-admin, I was prompted to trust M$ cert for VBA and to trust my self-signed cert. I did so, and <i>then</i> all was well."}], "tags": [], "owner": {"reputation": 1258, "user_id": 4383152, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/152bf463f05774e13dec69c45832882b?s=128&d=identicon&r=PG&f=1", "display_name": "BerndGit", "link": "https://stackoverflow.com/users/4383152/berndgit"}, "is_accepted": true, "score": 2, "last_activity_date": 1463564511, "last_edit_date": 1463564511, "creation_date": 1433861914, "answer_id": 30735745, "question_id": 30619881, "link": "https://stackoverflow.com/questions/30619881/microsoft-outlook-2013-error-verify-vba-project-signature/30735745#30735745", "title": "Microsoft Outlook 2013: Error verify VBA project signature", "body": "<p>Ok, I found the reason for my problem:</p>\n\n<p>(1) The Certificate <code>nameofmycert</code> by selfcert.exe was assigned to my VBA project. </p>\n\n<p>(2) However I didn't assign it to a trusted authority, like seen in: <a href=\"https://technet.microsoft.com/en-us/library/cc754841.aspx#BKMK_addlocal\" rel=\"nofollow\">https://technet.microsoft.com/en-us/library/cc754841.aspx#BKMK_addlocal</a></p>\n\n<p>(3) Outlook was set to allow all macros (not only digitally signed). Anyhow it found that my VBA project was certified, but was not sure if the cerification is correct, because of (2). Therefore it deactivated all macros.</p>\n\n<p>(4) In VBA/Tools / Dignital Signature it appeared: </p>\n\n<pre><code>Certificate name: [no certificate]\nSign as: nameofmycert\n</code></pre>\n\n<p>The remove-botton was deactivated.</p>\n\n<p><strong>Solution:</strong></p>\n\n<p>(1) VBA/Tools / Digital Signature</p>\n\n<p>(2) Click on <code>Choose ..</code> and select a cerificate. Then the remove-botton is activated. </p>\n\n<p>(3) Click on <code>Remove Certificate</code></p>\n\n<p>(4) Save VBA project</p>\n\n<p>(5) Restart Outlook</p>\n"}, {"comments": [{"owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "edited": false, "score": 0, "creation_date": 1573180237, "post_id": 47380003, "comment_id": 103806547, "body": "This resolve it for me, I had done everything correctly, but I basically had to go &quot;File, Save&quot; from VB Editor. I have a feeling this is related to me already having Macros existing before I started messing with certs, but I&#39;m not sure."}], "tags": [], "owner": {"reputation": 470, "user_id": 3727308, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3a8b11c4319e25f04c5201a2e3e79d30?s=128&d=identicon&r=PG", "display_name": "ChaosFreak", "link": "https://stackoverflow.com/users/3727308/chaosfreak"}, "is_accepted": false, "score": 1, "last_activity_date": 1511113605, "creation_date": 1511113605, "answer_id": 47380003, "question_id": 30619881, "link": "https://stackoverflow.com/questions/30619881/microsoft-outlook-2013-error-verify-vba-project-signature/47380003#47380003", "title": "Microsoft Outlook 2013: Error verify VBA project signature", "body": "<p>I had this same problem and the solution here fixed it: <a href=\"https://social.technet.microsoft.com/Forums/en-US/07f0158c-085b-4031-93a1-c9d047cf855c/unable-to-sign-outlook-2010-vbaproject?forum=outlook\" rel=\"nofollow noreferrer\">https://social.technet.microsoft.com/Forums/en-US/07f0158c-085b-4031-93a1-c9d047cf855c/unable-to-sign-outlook-2010-vbaproject?forum=outlook</a>.  The thread is long, but the gist of it is you need to manually save your VBA project after signing, and before exiting the VBA editor. Scroll down about 2/3rds of the way to the post by \"Diane Poremsky [MVP]\".</p>\n"}, {"comments": [{"owner": {"reputation": 2968, "user_id": 770065, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/08d6e27609509d372afd84348002a75e?s=128&d=identicon&r=PG", "display_name": "Darren Griffith", "link": "https://stackoverflow.com/users/770065/darren-griffith"}, "edited": false, "score": 0, "creation_date": 1531850715, "post_id": 48411874, "comment_id": 89747362, "body": "Additionally, I had to copy my macro code, delete the VBA project, close Outlook, delete the OTM file in the  %AppData%\\Microsoft\\Outlook  folder, reopen Outlook, create a new macro project, paste in the copied code, add the certificate, and voila!"}, {"owner": {"reputation": 321, "user_id": 3681759, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9f5d250fad7448b6ef7399ac7230c872?s=128&d=identicon&r=PG&f=1", "display_name": "novice", "link": "https://stackoverflow.com/users/3681759/novice"}, "edited": false, "score": 0, "creation_date": 1556031805, "post_id": 48411874, "comment_id": 98295042, "body": "works perfeclty, now you can change option in Outlook Trust Center to Notifications for digitally signed macros, all other macros disabled."}], "tags": [], "owner": {"reputation": 301, "user_id": 9259210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe973451a49dbfb3dd70cdcbc817deab?s=128&d=identicon&r=PG&f=1", "display_name": "adam", "link": "https://stackoverflow.com/users/9259210/adam"}, "is_accepted": false, "score": 8, "last_activity_date": 1516746494, "creation_date": 1516746494, "answer_id": 48411874, "question_id": 30619881, "link": "https://stackoverflow.com/questions/30619881/microsoft-outlook-2013-error-verify-vba-project-signature/48411874#48411874", "title": "Microsoft Outlook 2013: Error verify VBA project signature", "body": "<p>Having come across this just now, this is how I ultimately solved it (none of the other suggestions worked for me):</p>\n\n<ol>\n<li>Create a self cert \u2013 I called mine \u201cSelf Cert\u201d (generated from here in Office 2013 - C:\\Program Files (x86)\\Microsoft Office\\Office15\\SELFCERT.EXE)</li>\n<li>Run certmgr.crt from the start menu and copy \u201cSelf Cert\u201d from \u201cPersonal\\Certificates\u201d to the \u201cTrusted Root Certification Authorities\\Certificates\u201d folder</li>\n<li>Open Outlook.exe as Administrator</li>\n<li>Open VBA (i.e. Developer -> Visual Basic)</li>\n<li>Open your module containing the VBA code</li>\n<li>Select Tools -> Digital Signature -> Choose...</li>\n<li>Select OK to select \u201cSelf Cert\u201d (VB then shows the project as being signed with this certificate) then click OK again accept and close the window</li>\n<li>Click to save the macro in VBA \u2013 actually click the save button in VB (<em>bizarrely it breaks if you don\u2019t expressly save here</em>)</li>\n<li>Close VBA</li>\n<li>Close Outlook, and choose Yes to save the VBA project</li>\n<li>Restart Outlook.exe again as Administrator</li>\n<li>Either now, or after you go \u201cDeveloper -> Visual Basic\u201d again, a window should pop-up prompting you about the newly signed macro \u2013 I clicked remember and don\u2019t prompt again</li>\n<li>Macros should now work! I'm using them as part of an email rule and this now processes perfectly.</li>\n</ol>\n\n<p>I\u2019m not strictly sure you need to run Outlook as an administrator in the above, but it now works without being run as an administrator so I\u2019m happy.</p>\n\n<p>Thanks to this resource for getting this working for me! I've basically just updated, consolidated and expanded on answers given. <a href=\"https://social.technet.microsoft.com/Forums/en-US/07f0158c-085b-4031-93a1-c9d047cf855c/unable-to-sign-outlook-2010-vbaproject?forum=outlook\" rel=\"noreferrer\">https://social.technet.microsoft.com/Forums/en-US/07f0158c-085b-4031-93a1-c9d047cf855c/unable-to-sign-outlook-2010-vbaproject?forum=outlook</a></p>\n"}], "owner": {"reputation": 1258, "user_id": 4383152, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/152bf463f05774e13dec69c45832882b?s=128&d=identicon&r=PG&f=1", "display_name": "BerndGit", "link": "https://stackoverflow.com/users/4383152/berndgit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8561, "favorite_count": 1, "accepted_answer_id": 30735745, "answer_count": 4, "score": 8, "last_activity_date": 1592870842, "creation_date": 1433333880, "last_edit_date": 1592870842, "question_id": 30619881, "link": "https://stackoverflow.com/questions/30619881/microsoft-outlook-2013-error-verify-vba-project-signature", "title": "Microsoft Outlook 2013: Error verify VBA project signature", "body": "<p>After a computer reset I wanted to use my VBA Macros for Outlook 2013.</p>\n\n<p>In Outlook I get the error message: </p>\n\n<blockquote>\n  <p>\"An errror occured while attempting to verify the VBA project's signature. Macros will be disabled.\"</p>\n</blockquote>\n\n<p>Consequently the VBA editor states: </p>\n\n<blockquote>\n  <p>\"The macros in this project are disabled. [..]\"</p>\n</blockquote>\n\n<p>I have tried:</p>\n\n<ol>\n<li><p>Developer -> Macro Security -> (*) Enable all Macros (not only digitally signed) </p></li>\n<li><p>Define a certificate using  </p>\n\n<pre><code>C:\\Program Files (x86)\\Microsoft Office\\Office15\\selfcert.exe\n</code></pre></li>\n</ol>\n\n<p>Nothing worked. Any idea?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 161, "user_id": 4861962, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZoCGTjxDfKY/AAAAAAAAAAI/AAAAAAAAABI/XXNOub2rZuk/photo.jpg?sz=128", "display_name": "Bogdan Banciu", "link": "https://stackoverflow.com/users/4861962/bogdan-banciu"}, "edited": false, "score": 0, "creation_date": 1433330166, "post_id": 30618471, "comment_id": 49303043, "body": "Maybe post what you have so far so we can help you from there.. we do not have the complete context so it&#39;s very hard to answer"}, {"owner": {"reputation": 361, "user_id": 4914731, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-GQlW2FaTZcQ/AAAAAAAAAAI/AAAAAAAAAC4/di5KCJ4DOS4/photo.jpg?sz=128", "display_name": "Abdul Shiyas", "link": "https://stackoverflow.com/users/4914731/abdul-shiyas"}, "reply_to_user": {"reputation": 161, "user_id": 4861962, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZoCGTjxDfKY/AAAAAAAAAAI/AAAAAAAAABI/XXNOub2rZuk/photo.jpg?sz=128", "display_name": "Bogdan Banciu", "link": "https://stackoverflow.com/users/4861962/bogdan-banciu"}, "edited": false, "score": 0, "creation_date": 1433330572, "post_id": 30618471, "comment_id": 49303313, "body": "Okay. I will edit. I called the whole worksheet if cell.value=&quot;I am&quot; then cell.value=&quot;Gender&quot;;   The problem is &quot;employment&quot; column&#39;s name is also &quot;I am&quot;. So it also got changed into &quot;Gender&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 161, "user_id": 4861962, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZoCGTjxDfKY/AAAAAAAAAAI/AAAAAAAAABI/XXNOub2rZuk/photo.jpg?sz=128", "display_name": "Bogdan Banciu", "link": "https://stackoverflow.com/users/4861962/bogdan-banciu"}, "is_accepted": true, "score": 2, "last_activity_date": 1433330990, "creation_date": 1433330990, "answer_id": 30618842, "question_id": 30618471, "link": "https://stackoverflow.com/questions/30618471/change-the-column-name-of-only-first-occurance-in-excel-vba/30618842#30618842", "title": "Change the column name of only first occurance in excel vba", "body": "<p>From what I understand you want to change just 1 column so if that is correct then just do this</p>\n\n<pre><code>Dim hasChanged As Boolean\n\n'and now do your code with a small change\nhasChanged = False\nIf cell.Value = \"I am\" And hasChanged = False Then\n    cell.Value = \"Gender\"\n    hasChanged = True\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 361, "user_id": 4914731, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-GQlW2FaTZcQ/AAAAAAAAAAI/AAAAAAAAAC4/di5KCJ4DOS4/photo.jpg?sz=128", "display_name": "Abdul Shiyas", "link": "https://stackoverflow.com/users/4914731/abdul-shiyas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 30618842, "answer_count": 1, "score": 0, "last_activity_date": 1433330990, "creation_date": 1433329945, "last_edit_date": 1531164843, "question_id": 30618471, "link": "https://stackoverflow.com/questions/30618471/change-the-column-name-of-only-first-occurance-in-excel-vba", "title": "Change the column name of only first occurance in excel vba", "body": "<p>My dataset have manys columns with column names similar to </p>\n\n<p>ABC AAA SSD AAA VFD FDS AAA</p>\n\n<p>We have many columns with same name. Here it is AAA.</p>\n\n<p>I want to rename first AAA into \"FIRST\" and other AAAs as \"OTHERS\". Since first AAA can appear in any column number, we can't use the column reference(\"A\",\"B\") to refer it. </p>\n\n<p>Only if there is no-other-way, we can refer the column_reference.</p>\n\n<p>If I used IF statement, it will change all statements. So what can we do?</p>\n\n<p>I want this to be done in Excel VBA because I have to apply same sort of methods to similar workbooks. My program is almost over for a project and I got struck in this. Please help me.  </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1433330489, "post_id": 30618189, "comment_id": 49303253, "body": "You need to put WorkSite into apostrophes (<code>&quot;</code>) at least. Apart form that I am having some trouble deciphering what you are trying to do, may because I am not very familiar with with what TblRng etc. is. Hmm, and since you are using VBA anyway, is there some reason you are using <code>MATCH</code> instead of <code>FIND</code>?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1433330718, "post_id": 30618189, "comment_id": 49303412, "body": "What is the address of the <code>TblRng</code> range?"}, {"owner": {"reputation": 11, "user_id": 4923915, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jf6cvYk08io/AAAAAAAAAAI/AAAAAAAAOmk/ojn67mXuwKc/photo.jpg?sz=128", "display_name": "Dan", "link": "https://stackoverflow.com/users/4923915/dan"}, "edited": false, "score": 0, "creation_date": 1433333613, "post_id": 30618189, "comment_id": 49305501, "body": "The code cycles through several worksheets, the range is set to a listobjects table on the relevant sheet:  TblRng = Worksheets(WorkSite).Range(&quot;Tbl&quot; &amp; WorkSite)  I couldnt work out how to use FIND with multiple criteria across columns."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1433334614, "post_id": 30618189, "comment_id": 49306246, "body": "It seems that you are trying to match several items at once. Could you please <code>debug.print</code> <code>SheetString</code> &amp; <code>RangeString</code> variables in the immediate window and post here the result so we can see what values are actually passed to the match formula"}, {"owner": {"reputation": 11, "user_id": 4923915, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jf6cvYk08io/AAAAAAAAAAI/AAAAAAAAOmk/ojn67mXuwKc/photo.jpg?sz=128", "display_name": "Dan", "link": "https://stackoverflow.com/users/4923915/dan"}, "edited": false, "score": 0, "creation_date": 1433335753, "post_id": 30618189, "comment_id": 49307109, "body": "Even with WorkSite as &quot;Worksite&quot; SheetString I get a &quot;Subscript out of range&quot; err.  RangeString is as follows:      debug.Print RangeString &#39;[LBA-LogiCal_CC_150603.xlsm]TransportDefine&#39;!B4:B158&amp;&#39;[LBA-&zwnj;&#8203;LogiCal_CC_150603.xl&zwnj;&#8203;sm]TransportDefine&#39;!&zwnj;&#8203;C4:C158&amp;&#39;[LBA-LogiCa&zwnj;&#8203;l_CC_150603.xlsm]Tra&zwnj;&#8203;nsportDefine&#39;!D4:D15&zwnj;&#8203;8&amp;&#39;[LBA-LogiCal_CC_1&zwnj;&#8203;50603.xlsm]Transport&zwnj;&#8203;Define&#39;!E4:E158"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1433336642, "post_id": 30618189, "comment_id": 49307854, "body": "Replace <code>TblRng.Range(1,</code> with <code>TblRng.Cells(1,</code> in the <code>SheetString</code> formula"}, {"owner": {"reputation": 11, "user_id": 4923915, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jf6cvYk08io/AAAAAAAAAAI/AAAAAAAAOmk/ojn67mXuwKc/photo.jpg?sz=128", "display_name": "Dan", "link": "https://stackoverflow.com/users/4923915/dan"}, "edited": false, "score": 0, "creation_date": 1433338155, "post_id": 30618189, "comment_id": 49309141, "body": "Replaced to  <code>SheetString = Worksheets(&quot;WorkSite&quot;).Cells(&quot;E1&quot;).Address(False, False, , True) &amp; &quot;&amp;&quot; &amp; TblRng.Cells(1, j).Offset(-5, 0).Address(False, False, , True) &amp; &quot;&amp;&quot; &amp; TblRng.Cells(1, j).Offset(-6, 0).Address(False, False, , True) &amp; &quot;&amp;&quot; &amp; TblRng.Cells(1, j).Offset(-2, 0).Address(False, False, , True)</code>  but still get the &#39;Subscript out of range&#39; error."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1433338474, "post_id": 30618189, "comment_id": 49309404, "body": "You should have replaced only those who were like <code>TblRng.Range(1</code> not <code>.Range(&quot;E1&quot;)</code>. (see <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff838238.aspx</a>)"}, {"owner": {"reputation": 11, "user_id": 4923915, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jf6cvYk08io/AAAAAAAAAAI/AAAAAAAAOmk/ojn67mXuwKc/photo.jpg?sz=128", "display_name": "Dan", "link": "https://stackoverflow.com/users/4923915/dan"}, "edited": false, "score": 0, "creation_date": 1433339364, "post_id": 30618189, "comment_id": 49310150, "body": "Ok, that is working now and the code compiles:  RangeString  <code>&quot;&#39;[LBA-LogiCal_CC_150603.xlsm]TransportDefine&#39;!B4:B5&amp;&#39;[LBA-L&zwnj;&#8203;ogiCal_CC_150603.xls&zwnj;&#8203;m]TransportDefine&#39;!C&zwnj;&#8203;4:C5&amp;&#39;[LBA-LogiCal_C&zwnj;&#8203;C_150603.xlsm]Transp&zwnj;&#8203;ortDefine&#39;!D4:D5&amp;&#39;[L&zwnj;&#8203;BA-LogiCal_CC_150603&zwnj;&#8203;.xlsm]TransportDefin&zwnj;&#8203;e&#39;!E4:E5&quot;</code>  SheetString  <code>&quot;WS_LOTR&amp;&#39;[LBA-LogiCal_CC_150603.xlsm]WS_LOTR&#39;!X6&amp;&#39;[LBA-Logi&zwnj;&#8203;Cal_CC_150603.xlsm]W&zwnj;&#8203;S_LOTR&#39;!X5&amp;&#39;[LBA-Log&zwnj;&#8203;iCal_CC_150603.xlsm]&zwnj;&#8203;WS_LOTR&#39;!X9&quot;</code>"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1433343975, "post_id": 30618189, "comment_id": 49313809, "body": "What are: the value of <code>j</code> in <code>TblRng.Cells(1,j)</code> and the addresses of <code>TblRng</code> and <code>TblTrspt</code>"}, {"owner": {"reputation": 11, "user_id": 4923915, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jf6cvYk08io/AAAAAAAAAAI/AAAAAAAAOmk/ojn67mXuwKc/photo.jpg?sz=128", "display_name": "Dan", "link": "https://stackoverflow.com/users/4923915/dan"}, "edited": false, "score": 0, "creation_date": 1433344289, "post_id": 30618189, "comment_id": 49314055, "body": "After some further testing the Application.Evaluate was giving Error2015, the total length of the formula is over 300chars so I believe this is causing an error as application.match has a max 255 char limit.  When I paste the values of RangeString and SheetString into Match in a cell of the worksheet it works fine."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "reply_to_user": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1433347529, "post_id": 30618189, "comment_id": 49316528, "body": "@EEM and Dan, can you edit the question with all of the stuff that is in these comments (and then delete the comments)?  This question is impossible for anyone else to follow and defeats the purpose of a community Q&amp;A site.  It seems to be worth answering though."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1433347803, "post_id": 30618189, "comment_id": 49316688, "body": "Dan please let me know the value of J and the addresses of the ranges, so I can provide a full answer"}], "answers": [{"tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": false, "score": 0, "last_activity_date": 1433447963, "creation_date": 1433447963, "answer_id": 30653040, "question_id": 30618189, "link": "https://stackoverflow.com/questions/30618189/multiple-criteria-multiple-column-match/30653040#30653040", "title": "Multiple Criteria, Multiple Column Match", "body": "<p>Assuming that <code>WorkSite</code> is a <code>variable</code>, <code>TblRng</code> is a <code>Range</code> and <code>TblTrspt</code> is a <code>ListObject</code>; the following changes apply:</p>\n\n<ol>\n<li>To set <code>SheetString</code></li>\n</ol>\n\n<blockquote>\n  <p>Currently I cannot get this code to compile as I get\n  \"Application-defined object-defined error\" on the line to set\n  SheetString.</p>\n</blockquote>\n\n<p>Replaced <code>TblRng.Cells(1, j)</code> with <code>TblRng.Cells(1, j)</code> as <code>TblRng</code> is a <code>Range</code> not a <code>ListObject</code> as per:</p>\n\n<blockquote>\n  <p>TblRng = Worksheets(WorkSite).Range(\"Tbl\" &amp; WorkSite)</p>\n</blockquote>\n\n<pre><code>With TblRng.Cells(1, j)\n    SheetString = Worksheets(WorkSite).Range(\"E1\").Address(External:=1)\n    SheetString = SheetString &amp; Chr(38) &amp; .Offset(-5, 0).Address(External:=1)\n    SheetString = SheetString &amp; Chr(38) &amp; .Offset(-6, 0).Address(External:=1)\n    SheetString = SheetString &amp; Chr(38) &amp; .Offset(-2, 0).Address(External:=1)\nEnd With\n</code></pre>\n\n<p>Replaced <code>.Address(False, False, , True)</code> with <code>.Address(External:=1)</code> as only external references are needed. Whether <code>references</code> are or not \u201c<em>Absolute</em>\u201d only matters if the formula is going to be written in the worksheet and copied further.</p>\n\n<ol start=\"2\">\n<li>To set <code>RangeString</code></li>\n</ol>\n\n<p><code>With TblTrspt\n    RangeString = .ListColumns(1).Range.Address\n    RangeString = RangeString &amp; Chr(38) &amp; .ListColumns(2).Range.Address\n    RangeString = RangeString &amp; Chr(38) &amp; .ListColumns(3).Range.Address\n    RangeString = RangeString &amp; Chr(38) &amp; .ListColumns(4).Range.Address\nEnd With</code></p>\n\n<p>Replaced <code>.Address(False, False, , True)</code> with <code>.Address</code> in line with previous comment. Also in this case <code>External References</code> are not needed as the <code>Evaluate Method</code> is going to be applied to the <code>Worksheet</code> were the <code>ListObject</code> <code>TblTrspt</code> is located.</p>\n\n<ol start=\"3\">\n<li><p>To Apply the <code>Evaluate Method</code> to the worksheet were <code>TblTrspt</code> is located.</p>\n\n<pre><code>Eval = TblTrspt.Parent.Evaluate(\"MATCH(\" &amp; SheetString &amp; \",\" &amp; RangeString &amp; \",0)\")\n</code></pre></li>\n</ol>\n\n<p>Replaced <code>Application.Evaluate</code> with <code>TblTrspt.Parent.Evaluate</code>  </p>\n"}], "owner": {"reputation": 11, "user_id": 4923915, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jf6cvYk08io/AAAAAAAAAAI/AAAAAAAAOmk/ojn67mXuwKc/photo.jpg?sz=128", "display_name": "Dan", "link": "https://stackoverflow.com/users/4923915/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 243, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1433447963, "creation_date": 1433329215, "last_edit_date": 1495539820, "question_id": 30618189, "link": "https://stackoverflow.com/questions/30618189/multiple-criteria-multiple-column-match", "title": "Multiple Criteria, Multiple Column Match", "body": "<p>I am trying to code a multiple match to check if a record exists in a table before adding a new one. I've been trying to follow <a href=\"https://stackoverflow.com/questions/27790846/excel-vba-multiple-criteria-index-match\">this</a> example using 'Evaluate' and 'Match' to compare. I would rather use match than a loop as eventually the table could be pretty big.</p>\n\n<p>Here is what I have so far:</p>\n\n<pre><code>Rem SheetString = Worksheets(WorkSite).Range(\"E1\").Address(False, False, , True) &amp; \"&amp;\" &amp; TblRng.Range(1, j).Offset(-5, 0).Address(False, False, , True) &amp; \"&amp;\" &amp; TblRng.Range(1, j).Offset(-6, 0).Address(False, False, , True) &amp; \"&amp;\" &amp; TblRng.Range(1, j).Offset(-2, 0).Address(False, False, , True)\nSheetString = Worksheets(WorkSite).Range(\"E1\").Address(False, False, , True) &amp; \"&amp;\" &amp; _\n    TblRng.Range(1, j).Offset(-5, 0).Address(False, False, , True) &amp; \"&amp;\" &amp; _\n    TblRng.Range(1, j).Offset(-6, 0).Address(False, False, , True) &amp; \"&amp;\" &amp; _\n    TblRng.Range(1, j).Offset(-2, 0).Address(False, False, , True)\n\nRem RangeString = TblTrspt.ListColumns(1).Range.Address(False, False, , True) &amp; \"&amp;\" &amp; TblTrspt.ListColumns(2).Range.Address(False, False, , True) &amp; \"&amp;\" &amp; TblTrspt.ListColumns(3).Range.Address(False, False, , True) &amp; \"&amp;\" &amp; TblTrspt.ListColumns(4).Range.Address(False, False, , True)\nRangeString = TblTrspt.ListColumns(1).Range.Address(False, False, , True) &amp; \"&amp;\" &amp; _\n    TblTrspt.ListColumns(2).Range.Address(False, False, , True) &amp; \"&amp;\" &amp; _\n    TblTrspt.ListColumns(3).Range.Address(False, False, , True) &amp; \"&amp;\" &amp; _\n    TblTrspt.ListColumns(4).Range.Address(False, False, , True)\n\nEval = Application.Evaluate(\"MATCH(\" &amp; SheetString &amp; \",\" &amp; RangeString &amp; \",0)\")\n\nIf IsError(Eval) Then\n'add new item if not already in list\n</code></pre>\n\n<p><code>SheetString</code> is the criteria, <code>RangeString</code> is the table to be checked against. They need to be checked together as the combination may be unique but each field will be present several times.</p>\n\n<p>Currently I cannot get this code to compile as I get \"Application-defined object-defined error\" on the line to set <code>SheetString</code>.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1433330295, "post_id": 30618179, "comment_id": 49303114, "body": "Do you only get the message about enable content when you open files from the internet or your intranet (if it&#39;s poorly configured)?"}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 1, "creation_date": 1433331829, "post_id": 30618179, "comment_id": 49304201, "body": "I personally believe this question belongs to <code>Super User</code> as this has nothing to do with programming whatsoever."}, {"owner": {"reputation": 705, "user_id": 4163002, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/30e77d3fa90ca3c96cf94a3fca4614ee?s=128&d=identicon&r=PG&f=1", "display_name": "ZX9", "link": "https://stackoverflow.com/users/4163002/zx9"}, "reply_to_user": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1433333709, "post_id": 30618179, "comment_id": 49305570, "body": "@user3819867 I do believe this qualifies as relating to <a href=\"http://stackoverflow.com/help/on-topic\">&quot;software tools commonly used by programmers&quot;</a> in the context of vba. I do see what you&#39;re saying, though."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1433336088, "post_id": 30618179, "comment_id": 49307387, "body": "Added as a comment as tonester has given a better answer - you could open in safe mode by holding Ctrl while Excel opens, or by using the command line excel.exe /s."}], "answers": [{"comments": [{"owner": {"reputation": 930, "user_id": 4600127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc7345ceed5fb91c40faebc880ae994?s=128&d=identicon&r=PG&f=1", "display_name": "Verzweifler", "link": "https://stackoverflow.com/users/4600127/verzweifler"}, "edited": false, "score": 1, "creation_date": 1433331412, "post_id": 30618889, "comment_id": 49303912, "body": "The Trust Center also enables you to execute Macros always/never/only after asking - regardless of source location."}], "tags": [], "owner": {"reputation": 94, "user_id": 4961256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d547902f57218ed9a7c7af5acad0f13?s=128&d=identicon&r=PG&f=1", "display_name": "tonester640", "link": "https://stackoverflow.com/users/4961256/tonester640"}, "is_accepted": false, "score": 1, "last_activity_date": 1433331160, "creation_date": 1433331160, "answer_id": 30618889, "question_id": 30618179, "link": "https://stackoverflow.com/questions/30618179/disable-macro-in-open-workbook/30618889#30618889", "title": "Disable macro in open workbook", "body": "<p>If you have the VBE open, you will be prompted with a pop-up whether you want to enable macros. If it is not open, you will just have the yellow security bar (2007 and later).</p>\n\n<p>You can edit your trusted locations in File > Options > Trust Center > Trust Center Settings > Trusted Locations</p>\n\n<p>The only way to disable macros after enabling them is to restart Excel.</p>\n"}, {"tags": [], "owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "is_accepted": true, "score": 0, "last_activity_date": 1433331691, "creation_date": 1433331691, "answer_id": 30619084, "question_id": 30618179, "link": "https://stackoverflow.com/questions/30618179/disable-macro-in-open-workbook/30619084#30619084", "title": "Disable macro in open workbook", "body": "<p>I have no theoretical grounds to back this but I have just disabled macros on a <em>password protected</em> set of modules with the method below:</p>\n\n<ol>\n<li><code>Alt+F11</code> to open VBE</li>\n<li><code>Run</code> > <code>Design mode</code></li>\n</ol>\n\n<p>The header will now show <code>... [design]</code>.<br>\nTry triggering a known event-based macro to find out if it works.</p>\n"}], "owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1448, "favorite_count": 0, "accepted_answer_id": 30619084, "answer_count": 2, "score": 0, "last_activity_date": 1433331691, "creation_date": 1433329174, "question_id": 30618179, "link": "https://stackoverflow.com/questions/30618179/disable-macro-in-open-workbook", "title": "Disable macro in open workbook", "body": "<p>Sometimes when I open a workbook, Excel asks me if I want to enable content and macros. At this time I have the choice not to enable macros or not.</p>\n\n<p>But sometimes Excel considers a workbook trusted and I don't get this question. In these cases, when a workbook has been opened and macros have been enabled automatically, is there any way for me to disable macros in the workbook that is already open and running with macros?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 161, "user_id": 2491411, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/26bf79051611edd61923c9e29634560b?s=128&d=identicon&r=PG&f=1", "display_name": "PauliusM", "link": "https://stackoverflow.com/users/2491411/pauliusm"}, "edited": false, "score": 0, "creation_date": 1433331800, "post_id": 30618386, "comment_id": 49304180, "body": "Thank you for your answer, but the execution time is still the same"}, {"owner": {"reputation": 161, "user_id": 2491411, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/26bf79051611edd61923c9e29634560b?s=128&d=identicon&r=PG&f=1", "display_name": "PauliusM", "link": "https://stackoverflow.com/users/2491411/pauliusm"}, "edited": false, "score": 0, "creation_date": 1433332530, "post_id": 30618386, "comment_id": 49304722, "body": "cant see how this can solve a problem - i already tried to use ` Name OldName As NewName` and it takes the same time"}, {"owner": {"reputation": 161, "user_id": 4861962, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZoCGTjxDfKY/AAAAAAAAAAI/AAAAAAAAABI/XXNOub2rZuk/photo.jpg?sz=128", "display_name": "Bogdan Banciu", "link": "https://stackoverflow.com/users/4861962/bogdan-banciu"}, "reply_to_user": {"reputation": 161, "user_id": 2491411, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/26bf79051611edd61923c9e29634560b?s=128&d=identicon&r=PG&f=1", "display_name": "PauliusM", "link": "https://stackoverflow.com/users/2491411/pauliusm"}, "edited": false, "score": 0, "creation_date": 1433332621, "post_id": 30618386, "comment_id": 49304776, "body": "the if statement changed, it now uses Dir to check if the file exists, because i think the problem comes from checking the file rather then moving it"}, {"owner": {"reputation": 161, "user_id": 2491411, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/26bf79051611edd61923c9e29634560b?s=128&d=identicon&r=PG&f=1", "display_name": "PauliusM", "link": "https://stackoverflow.com/users/2491411/pauliusm"}, "edited": false, "score": 0, "creation_date": 1433333350, "post_id": 30618386, "comment_id": 49305322, "body": "I am quite sure that it;s because <code>source.Move (NewName)</code> Code runs smoothly if i disable this line"}], "tags": [], "owner": {"reputation": 161, "user_id": 4861962, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZoCGTjxDfKY/AAAAAAAAAAI/AAAAAAAAABI/XXNOub2rZuk/photo.jpg?sz=128", "display_name": "Bogdan Banciu", "link": "https://stackoverflow.com/users/4861962/bogdan-banciu"}, "is_accepted": false, "score": 0, "last_activity_date": 1433332120, "last_edit_date": 1433332120, "creation_date": 1433329713, "answer_id": 30618386, "question_id": 30617636, "link": "https://stackoverflow.com/questions/30617636/method-file-move-path-takes-too-long/30618386#30618386", "title": "Method File.Move (path) takes too long", "body": "<p>you can try this</p>\n\n<pre><code>If FSO.fileExists(OldName) Then ' FSO is fileSystemObject\n  Cells(1, 3).Value = \"Passed\"\n  Set source = FSO.getfile(OldName)\n  Name OldName As NewName\n</code></pre>\n\n<p>end if</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>ok then you can try this:</p>\n\n<pre><code>If Len(Dir(OldName)) = 0 Then\n    MsgBox \"File does not exist\"\nElse\n    Name OldName As NewName\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 161, "user_id": 2491411, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/26bf79051611edd61923c9e29634560b?s=128&d=identicon&r=PG&f=1", "display_name": "PauliusM", "link": "https://stackoverflow.com/users/2491411/pauliusm"}, "is_accepted": true, "score": 0, "last_activity_date": 1434079585, "creation_date": 1434079585, "answer_id": 30794847, "question_id": 30617636, "link": "https://stackoverflow.com/questions/30617636/method-file-move-path-takes-too-long/30794847#30794847", "title": "Method File.Move (path) takes too long", "body": "<p>So i still have no clue why it takes so long, but i found a workaround.</p>\n\n<p>I use this approach to copy files</p>\n\n<pre><code>Shell \"cmd.exe /S /C move \" &amp; oldName &amp; \" \" &amp; newName, windowStyle:=vbHide \n</code></pre>\n\n<p>this runs invisible command console that moves the file.\nVBA does not wait command line to finish and continues with other tasks.</p>\n"}], "owner": {"reputation": 161, "user_id": 2491411, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/26bf79051611edd61923c9e29634560b?s=128&d=identicon&r=PG&f=1", "display_name": "PauliusM", "link": "https://stackoverflow.com/users/2491411/pauliusm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 1, "accepted_answer_id": 30794847, "answer_count": 2, "score": 1, "last_activity_date": 1434079585, "creation_date": 1433327656, "last_edit_date": 1531164843, "question_id": 30617636, "link": "https://stackoverflow.com/questions/30617636/method-file-move-path-takes-too-long", "title": "Method File.Move (path) takes too long", "body": "<p>I have this part code in excell</p>\n\n<pre><code>  If FSO.fileExists(OldName) Then ' FSO is fileSystemObject\n      Cells(1, 3).Value = \"Passed\"\n      Set source = FSO.getfile(OldName)\n      source.Move (NewName)\n  end if\n</code></pre>\n\n<p>where <code>OldName</code> is somthing like \"C:\\doc\\file.txt\" \nand <code>NewName</code> is something like \"C:\\doc\\NewName\\file.txt\"</p>\n\n<p>Directory C:\\doc\\NewName contains ~20 000 txt files and line <code>source.Move (NewName)</code> takes about 4min to execute (file size 2kB, computer is really old...)<br>\nIf i use empty dir, code runs in a second.</p>\n\n<p>I am not allowed to use another dir, and i can't delete any files from it.</p>\n\n<p>Can anyone explain why it takes so long, and what is the options to reduce the time?</p>\n"}, {"tags": ["vba", "excel", "combobox"], "answers": [{"comments": [{"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1433328645, "post_id": 30617788, "comment_id": 49302002, "body": "In regards to the event firing. could you not just use application.enablevents=false ?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 1, "creation_date": 1433328791, "post_id": 30617788, "comment_id": 49302098, "body": "@99moorem No - it doesn&#39;t affect the events for controls. (well, it does affect some if the control is on a worksheet, but those events really belong to the container, not the control)"}, {"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1433328950, "post_id": 30617788, "comment_id": 49302222, "body": "@Rory Hmm learn something new every day, have to play around with it when I get time."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 2, "last_activity_date": 1433328138, "last_edit_date": 1495541667, "creation_date": 1433328138, "answer_id": 30617788, "question_id": 30617525, "link": "https://stackoverflow.com/questions/30617525/repopulate-a-combobox-itemlist-without-affecting-what-is-currently-written-insid/30617788#30617788", "title": "Repopulate a combobox itemlist without affecting what is currently written inside the combobox?", "body": "<blockquote>\n  <p>There are loops that I think might be unnecessary. Is is possible to remove all items without looping and adding multiple items without looping.</p>\n</blockquote>\n\n<p><code>ComboBox1.Clear</code> will remove all items without looping. For adding you can use <code>.List</code> after you create the loop to add items to the ComboBox.</p>\n\n<pre><code>Private Sub Sample()\n    Dim MyAr(1 To 5)\n\n    For i = 1 To 5\n        MyAr(i) = i\n    Next i\n\n    ComboBox1.List = MyAr\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>It triggers the Combobox1_change event</p>\n</blockquote>\n\n<p>To prevent the <code>Combobox1_change event</code>, you will have to use a boolean variable like <a href=\"https://stackoverflow.com/questions/30578093/vba-userform-with-multiples-textboxes-in-infinite-calculation-loop#comment49226676_30578093\">This</a></p>\n\n<blockquote>\n  <p>It changes the selected value of the combobox (before attempting to restore it)</p>\n</blockquote>\n\n<p>Store the value in a variable and then reset the combobox value if that value is part of the dropdown list</p>\n"}], "owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1433328138, "creation_date": 1433327368, "last_edit_date": 1433328072, "question_id": 30617525, "link": "https://stackoverflow.com/questions/30617525/repopulate-a-combobox-itemlist-without-affecting-what-is-currently-written-insid", "title": "Repopulate a combobox itemlist without affecting what is currently written inside the combobox?", "body": "<p>How can I repopulate a combobox itemlist without affecting what is currently written inside the combobox?</p>\n\n<p>I currently have code that looks kind of like:</p>\n\n<pre><code>Private Sub ComboBox1_DropButtonClick()\n    Dim v As Variant\n    Dim selText As String\n    selText = ComboBox1.selText\n\n    Dim i As Integer\n    For i = 0 To ComboBox1.ListCount - 1\n        ComboBox1.RemoveItem (0)\n    Next i\n\n    v = Call CreateList()\n    For i = 0 to Ubound(v)\n        ComboBox1.AddItem v(i)\n    Next v\n    If selText &lt;&gt; \"\" Then ComboBox1.Text = selText\nEnd Sub\n</code></pre>\n\n<p>I haven't worked with comboboxes before so there are probably better methods. The code above has several problems</p>\n\n<ul>\n<li>It changes the selected value of the combobox (before attempting to restore it)</li>\n<li>It triggers the Combobox1_change event</li>\n<li>There are loops that I think might be unnecessary. Is is possible to remove all items without looping and adding multiple items without looping. The items to be added are created from a string that has comma separated values.</li>\n</ul>\n\n<p>I would really appreciate help </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4965172"}, "edited": false, "score": 0, "creation_date": 1433327819, "post_id": 30617627, "comment_id": 49301465, "body": "This values are not real, i need a macro because i get new values every day and i work with a lot of data, so i need a work with a vba, would be easy do it every day with only  one key"}, {"owner": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "edited": false, "score": 1, "creation_date": 1433328660, "post_id": 30617627, "comment_id": 49302010, "body": "But if you set up the vlookups, and providing the user list doesn&#39;t change, they will automatically update everyday correctly after you put in the new values in the first sheet."}], "tags": [], "owner": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "is_accepted": false, "score": 2, "last_activity_date": 1433327629, "creation_date": 1433327629, "answer_id": 30617627, "question_id": 30617441, "link": "https://stackoverflow.com/questions/30617441/create-a-vba-macro-that-find-and-copy/30617627#30617627", "title": "Create a VBA macro that Find and Copy?", "body": "<p>If I understand what you're after, you should be able to do this with <a href=\"http://www.excel-easy.com/functions/lookup-reference-functions.html\" rel=\"nofollow\">VLOOKUPs</a> </p>\n\n<p>(No VBA necessary)</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4965172"}, "edited": false, "score": 0, "creation_date": 1433328773, "post_id": 30617839, "comment_id": 49302086, "body": "My real values are too big to do it with a fuction, can I show you the real excel and you can help me with it? Would be nice"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 1, "creation_date": 1433328836, "post_id": 30617839, "comment_id": 49302122, "body": "I very much doubt that you can set up a macro which works faster than native Excel functions for replicating values. At the very least the task you were trying to accomplish would have to be significantly more complicated than this. @GonzaloPaniagua"}], "tags": [], "owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "is_accepted": true, "score": 3, "last_activity_date": 1433328258, "creation_date": 1433328258, "answer_id": 30617839, "question_id": 30617441, "link": "https://stackoverflow.com/questions/30617441/create-a-vba-macro-that-find-and-copy/30617839#30617839", "title": "Create a VBA macro that Find and Copy?", "body": "<p>You don't need a macro for this, using the worksheetfunction <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194701.aspx\" rel=\"nofollow\"><code>VLOOKUP</code></a> is sufficient.</p>\n\n<p>As an example, if you have your headers in row 1 and users in column A, what you'd put into cell B2 (the number of kills for the first user) would be <code>=VLOOKUP($A2;Values!$A$2:$C$9;2;FALSE)</code> and C2 would be <code>=VLOOKUP($A2;Values!$A$2:$C$9;3;FALSE)</code>.</p>\n\n<p>The arguments for the function (which you can also find in the linked document) is:</p>\n\n<ul>\n<li>First, the value you're looking for, in your case whatever is in A2</li>\n<li>Next the array of values which you want to return a result from - <code>vlookup</code> will only look through the first column, but since you want to return results from the other columns we include columns A:C in the formula.</li>\n<li>What column in the range you search to return the result from for kills it is column 2, for deaths column 3.</li>\n<li>Finally whether you want to have an exact match (<code>false</code>) or if an approximate one is ok (<code>true</code>).</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 514, "user_id": 4967653, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jLy0eO8CT3E/AAAAAAAAAAI/AAAAAAAAAeQ/r1of1sWAlcw/photo.jpg?sz=128", "display_name": "keong kenshih", "link": "https://stackoverflow.com/users/4967653/keong-kenshih"}, "is_accepted": false, "score": 1, "last_activity_date": 1433329747, "creation_date": 1433329747, "answer_id": 30618397, "question_id": 30617441, "link": "https://stackoverflow.com/questions/30617441/create-a-vba-macro-that-find-and-copy/30618397#30618397", "title": "Create a VBA macro that Find and Copy?", "body": "<p><br>\nThe following source code solve your problem. <br><br></p>\n\n<pre><code>Option Explicit\n\nDim MyResultWorkbook As Workbook\nDim ValuesWorksheet As Worksheet\nDim SniperWorksheet As Worksheet\nDim ARsWorksheet As Worksheet\n\nSub CopyResult()\nSet MyResultWorkbook = ActiveWorkbook\nSet ValuesWorksheet = MyResultWorkbook.Sheets(\"Values\")\nSet SniperWorksheet = MyResultWorkbook.Sheets(\"Sniper\")\nSet ARsWorksheet = MyResultWorkbook.Sheets(\"Ars\")\n\nDim SniperLastRow As Long\nDim ARLastRow As Long\nDim RowPointer As Long\nDim ValuePointer As Long\n\nValuePointer = 2\n\n'Update the Sniper worksheets\nSniperLastRow = SniperWorksheet.Cells(SniperWorksheet.Rows.Count, \"A\").End(xlUp).Row\nFor RowPointer = 2 To SniperLastRow\n\nDo While (SniperWorksheet.Range(\"A\" &amp; RowPointer).Value &lt;&gt; ValuesWorksheet.Range(\"A\" &amp; ValuePointer).Value)\n    ValuePointer = ValuePointer + 1\nLoop\nSniperWorksheet.Range(\"A\" &amp; RowPointer).Offset(0, 1).Value = ValuesWorksheet.Range(\"A\" &amp; ValuePointer).Offset(0, 1).Value 'copy kill\nSniperWorksheet.Range(\"A\" &amp; RowPointer).Offset(0, 2).Value = ValuesWorksheet.Range(\"A\" &amp; ValuePointer).Offset(0, 2).Value 'copy death\nValuePointer = 2\nNext\n\n'Update the Ars worksheets\nARLastRow = ARsWorksheet.Cells(ARsWorksheet.Rows.Count, \"A\").End(xlUp).Row\nFor RowPointer = 2 To ARLastRow\n\nDo While (ARsWorksheet.Range(\"A\" &amp; RowPointer).Value &lt;&gt; ValuesWorksheet.Range(\"A\" &amp; ValuePointer).Value)\n    ValuePointer = ValuePointer + 1\nLoop\nARsWorksheet.Range(\"A\" &amp; RowPointer).Offset(0, 1).Value = ValuesWorksheet.Range(\"A\" &amp; ValuePointer).Offset(0, 1).Value 'copy kill\nARsWorksheet.Range(\"A\" &amp; RowPointer).Offset(0, 2).Value = ValuesWorksheet.Range(\"A\" &amp; ValuePointer).Offset(0, 2).Value 'copy death\nValuePointer = 2\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4965172"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 30617839, "answer_count": 3, "score": 0, "last_activity_date": 1433330043, "creation_date": 1433327130, "last_edit_date": 1433330043, "question_id": 30617441, "link": "https://stackoverflow.com/questions/30617441/create-a-vba-macro-that-find-and-copy", "title": "Create a VBA macro that Find and Copy?", "body": "<p>I need a little bit help with a macro of Excel.</p>\n\n<p>I need to create a macro that automatically find users and copy the values that i have in an other Sheet:</p>\n\n<p>I have one sheet with values that contains the Users and their Kills and Deaths, I create 3 sheets more (3 different groups of users), and I need that the macro copy values automatically finding the users and copying values.</p>\n\n<p><img src=\"https://i.stack.imgur.com/KSfMj.png\" alt=\"enter image description here\"></p>\n\n<p>Images to describe it better:</p>\n\n<p><img src=\"https://i.stack.imgur.com/8n9EE.png\" alt=\"enter image description here\"> </p>\n\n<p>----(Copy this values on)-----></p>\n\n<p><img src=\"https://i.stack.imgur.com/ZXplH.png\" alt=\"enter image description here\">\n<img src=\"https://i.stack.imgur.com/l9rSy.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1433327639, "post_id": 30617371, "comment_id": 49301336, "body": "are there any error messages? if so, what do they say?"}, {"owner": {"reputation": 17, "user_id": 3853116, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/12ed799745a948af8c77792b5fe3eb78?s=128&d=identicon&r=PG&f=1", "display_name": "mark", "link": "https://stackoverflow.com/users/3853116/mark"}, "reply_to_user": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1433328842, "post_id": 30617371, "comment_id": 49302133, "body": "I commented out the three if statements, the third has the syntax (not sure how to fix), but if I comment that out, each one pulls a report, just one has no data as it failed the if."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 3853116, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/12ed799745a948af8c77792b5fe3eb78?s=128&d=identicon&r=PG&f=1", "display_name": "mark", "link": "https://stackoverflow.com/users/3853116/mark"}, "edited": false, "score": 0, "creation_date": 1433340044, "post_id": 30619497, "comment_id": 49310670, "body": "I&#39;ve got individual queries set for the record source, the not showing issue was related to a filter set in the query. The code you did up here solved the problem. Thanks for your help."}], "tags": [], "owner": {"reputation": 113, "user_id": 4953277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9de4fe92a4033e9721c64449533ec2e7?s=128&d=identicon&r=PG&f=1", "display_name": "Y2Que", "link": "https://stackoverflow.com/users/4953277/y2que"}, "is_accepted": true, "score": 0, "last_activity_date": 1433332728, "creation_date": 1433332728, "answer_id": 30619497, "question_id": 30617371, "link": "https://stackoverflow.com/questions/30617371/manipulating-variable-and-retrieving-report/30619497#30619497", "title": "manipulating variable and retrieving report", "body": "<p><strong>Disclaimer:</strong> I'm no professional but hopefully I can help.</p>\n\n<p>I adjusted the definition of <code>strUser</code> by using a reference to referring to controls found <a href=\"http://access.mvps.org/access/forms/frm0031.htm\" rel=\"nofollow\">here</a>.</p>\n\n<p>Assuming there are only 3 types of users, I simply removed the last <code>if</code> statement. If it is not the 1st type, nor the 2nd type, it must be the 3rd type of user.</p>\n\n<p>Lastly, we should use <code>=</code> instead of <code>Like</code> in the conditions for the <code>if</code> statements.</p>\n\n<pre><code>Private Sub cmdPrintIndRep_Click()\n\nDim strUser As String\nstrUser = Forms!frmsupresults!subfrmUsrRes.Form!UserName\n\n    If Left(strUser, 2) = \"t8\" Or Left(strUser, 2) = \"T8\" Then\n        DoCmd.OpenReport \"FedInvest - ISSR Recertification Report\", acViewPreview\n    ElseIf Left(strUser, 2) = \"p9\" Or Left(strUser, 2) = \"P9\" Then\n        DoCmd.OpenReport \"Courts - ISSR Recertification Report\", acViewPreview\n    Else\n        DoCmd.OpenReport \"FedInvest - ISSR Internal Users Recertification Report\", _ \n                         acViewPreview\n    End If\nEnd Sub\n</code></pre>\n\n<p>As far as your reports being blank, what is their <a href=\"https://msdn.microsoft.com/en-us/library/office/ff821454.aspx\" rel=\"nofollow\">Record Source</a>?</p>\n"}], "owner": {"reputation": 17, "user_id": 3853116, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/12ed799745a948af8c77792b5fe3eb78?s=128&d=identicon&r=PG&f=1", "display_name": "mark", "link": "https://stackoverflow.com/users/3853116/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 30619497, "answer_count": 1, "score": 0, "last_activity_date": 1594644377, "creation_date": 1433326946, "last_edit_date": 1594644377, "question_id": 30617371, "link": "https://stackoverflow.com/questions/30617371/manipulating-variable-and-retrieving-report", "title": "manipulating variable and retrieving report", "body": "<p>I'm trying to work out a problem and need some help. I have 3 types of users (T8XXXXX, P9XXXXX and XXXXX) each of these users have different elements and as such has a different report. The top two if statements work, as far as opening the reports, one report is blank and the third fails all together. I'm not really sure how to solve this, and am hoping for some help from professionals. Any help is greatly appreciated!</p>\n\n<pre><code>Private Sub cmdPrintIndRep_Click()\nDim strUser As String\nstrUser = Forms.frmsupresults.subfrmUsrRes!UserName\n        If Left(strUser, 2) Like \"t8\" Then\n            DoCmd.OpenReport \"FedInvest - ISSR Recertification Report\", acViewPreview\n            ElseIf Left(strUser, 2) Like \"p9\" Then\n                DoCmd.OpenReport \"Courts - ISSR Recertification Report\", acViewPreview\n            Else Left(strUser, 2) not Like \"p9\" and not like \"t8\"\" Then\n                DoCmd.OpenReport \"FedInvest - ISSR Internal Users Recertification Report\", acViewPreview\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "pivot", "pivot-table"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1433328987, "post_id": 30617089, "comment_id": 49302241, "body": "Do you really want days 1-19 in each of the months for Jan-May, or do you want the whole of Jan-Apr and then the first 19 days of May?"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433347177, "post_id": 30617089, "comment_id": 49316281, "body": "It might be easier to loop through all the <code>PivotItems</code> in the <code>PivotField</code> and set <code>Visible=True&#47;False</code> to only those items meeting your needs: check <code>Name</code>."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433347249, "post_id": 30617089, "comment_id": 49316335, "body": "Also, are these all fields in the data or are you using the <code>Group Field</code> option on a date?  There are some oddities with how grouped items are named. You can expect difficulties trying to match the day names since they are formatted as <code>DAY-MON</code> or <code>dd-mmm</code>.  And, finally I think the months are set using <code>MON</code> or <code>mmm</code> format.  Of course, if these are your own items then that&#39;s all a moot point."}, {"owner": {"reputation": 1, "user_id": 4969039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea8e3e657140a40cc92e53a7343852f1?s=128&d=identicon&r=PG&f=1", "display_name": "Bernardo", "link": "https://stackoverflow.com/users/4969039/bernardo"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1433410833, "post_id": 30617089, "comment_id": 49344919, "body": "@Rory - yes I want days 1-19 in each of the months for Jan-May... Any ideas?"}, {"owner": {"reputation": 1, "user_id": 4969039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea8e3e657140a40cc92e53a7343852f1?s=128&d=identicon&r=PG&f=1", "display_name": "Bernardo", "link": "https://stackoverflow.com/users/4969039/bernardo"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1433410962, "post_id": 30617089, "comment_id": 49345005, "body": "@Byron Yeah I know that the pivot is strange. The field named &quot;Year Month Day&quot; but I&#39;m not able to use the conventional date format on it"}], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 0, "last_activity_date": 1433412692, "creation_date": 1433412692, "answer_id": 30641027, "question_id": 30617089, "link": "https://stackoverflow.com/questions/30617089/loop-through-pivot-table-dates-in-vba-2010/30641027#30641027", "title": "Loop through Pivot Table dates in VBA 2010", "body": "<p>I can't really test the final part, but you can build up the array like this:</p>\n\n<pre><code>Dim Mnths                 As Integer\nDim Days                  As Integer\nDim vDates(1 To 95)\n\nConst csDIMENSION         As String = \"[Dim Time].[Year Month Day].[Year].&amp;[2015].&amp;[\"\nFor Mnths = 1 To 5\n    For Days = 1 To 19\n        vDates((Mnths - 1) * 19 + Days) = csDIMENSION &amp; Mnths &amp; \"].&amp;[2015/\" &amp; Format$(Mnths, \"00\") &amp; \"/\" &amp; Format$(Days, \"00\") &amp; \"])\"\n    Next Days\nNext Mnths\nSheets(\"MtShhet\").PivotTables(\"MyPivotTable\").PivotFields(\"[Dim Time].[Year Month Day].[Date YYYYMMDD]\").VisibleItemsList = vDates\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4969039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea8e3e657140a40cc92e53a7343852f1?s=128&d=identicon&r=PG&f=1", "display_name": "Bernardo", "link": "https://stackoverflow.com/users/4969039/bernardo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 526, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433412692, "creation_date": 1433326218, "last_edit_date": 1433328029, "question_id": 30617089, "link": "https://stackoverflow.com/questions/30617089/loop-through-pivot-table-dates-in-vba-2010", "title": "Loop through Pivot Table dates in VBA 2010", "body": "<p>Having issues with this problem:\nI want to loop through Pivot Table date fields in VBA 2010 so that instead of writing:</p>\n\n<pre><code>ActiveSheet.PivotTables(\"MyPivotTable\").PivotFields( _\n\"[Dim Time].[Year Month Day].[Date YYYYMMDD]\").VisibleItemsList = Array( _\n\"[Dim Time].[Year Month Day].[Year].&amp;[2015].&amp;[01].&amp;[2015/01/01]\", _\n\"[Dim Time].[Year Month Day].[Year].&amp;[2015].&amp;[01].&amp;[2015/01/02]\", _\n   \"And so on......... until\"\n\"[Dim Time].[Year Month Day].[Year].&amp;[2015].&amp;[01].&amp;[2015/01/19]\")`\n</code></pre>\n\n<p>I will write something like</p>\n\n<pre><code>Dim Mnths As Integer\nDim Days As Integer\nFor Mnths = 1 To 5\n        For Days = 1 To 19\n            Sheets(\"MtShhet\").Select\n            ActiveSheet.PivotTables(\"MyPivotTable\").PivotFields( _\n                \"[Dim Time].[Year Month Day].[Date YYYYMMDD]\").VisibleItemsList = Array( _\n                \"[Dim Time].[Year Month Day].[Year].&amp;[2015].&amp;[\" &amp; Mnths &amp; \"].&amp;[2015/\" &amp; Mnths &amp; \"/\" &amp; Days &amp; \"])\"\n\n        Next Days\n    Next Mnths\n</code></pre>\n\n<p>I looked around, but most of explanations I saw display different forms of dates not an array as in this example. This weird expression for date as an array I got while recording the Macro. I guess it has something to do with the pivot table creators (not me).</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 0, "creation_date": 1433325636, "post_id": 30616598, "comment_id": 49299877, "body": "What have you done in VBA so far?"}, {"owner": {"reputation": 491, "user_id": 4925420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a46e2bd849822edc3501d1f41079f607?s=128&d=identicon&r=PG&f=1", "display_name": "atame", "link": "https://stackoverflow.com/users/4925420/atame"}, "reply_to_user": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 0, "creation_date": 1433325834, "post_id": 30616598, "comment_id": 49300008, "body": "@Sam Hi, i have nothing to the moment i don&#39;t know where to start, im still very new to VBA"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1433326343, "post_id": 30616598, "comment_id": 49300375, "body": "Try recording a macro and see what code do you come up with?"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1433326638, "post_id": 30616598, "comment_id": 49300614, "body": "<code>Application.VLOOKUP(lookup_value, table_array, column_index, range_lookup)</code>"}, {"owner": {"reputation": 491, "user_id": 4925420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a46e2bd849822edc3501d1f41079f607?s=128&d=identicon&r=PG&f=1", "display_name": "atame", "link": "https://stackoverflow.com/users/4925420/atame"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1433326655, "post_id": 30616598, "comment_id": 49300629, "body": "@SiddharthRout, this is the code it come out with, i need it loop through all rows.     Range(&quot;O1&quot;).Select     ActiveCell.FormulaR1C1 = &quot;=VLOOKUP(RC[-13],Details!C[-14]:C[-7],8,0)&quot;     Range(&quot;P1&quot;).Select     ActiveCell.FormulaR1C1 = &quot;=VLOOKUP(RC[-14],Details!C[-15]:C[-8],6,0)&quot;     Range(&quot;Q1&quot;).Select     ActiveCell.FormulaR1C1 = &quot;=VLOOKUP(RC[-15],Details!C[-16]:C[-9],5,0)&quot;     Range(&quot;Q2&quot;).Select"}, {"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 0, "creation_date": 1433326876, "post_id": 30616598, "comment_id": 49300797, "body": "Have a look at <a href=\"http://www.excelfunctions.net/VBA-Loops.html\" rel=\"nofollow noreferrer\">excelfunctions.net/VBA-Loops.html</a> I would use a for loop. You will need to create a variable to get the last cell range and use that as the end value for the for loop"}, {"owner": {"reputation": 491, "user_id": 4925420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a46e2bd849822edc3501d1f41079f607?s=128&d=identicon&r=PG&f=1", "display_name": "atame", "link": "https://stackoverflow.com/users/4925420/atame"}, "reply_to_user": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 0, "creation_date": 1433329323, "post_id": 30616598, "comment_id": 49302463, "body": "@Sam I have looked at the link and have looked through google for answers, but can not figure anything out. I have no idea how to do this! Please help!!! Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 491, "user_id": 4925420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a46e2bd849822edc3501d1f41079f607?s=128&d=identicon&r=PG&f=1", "display_name": "atame", "link": "https://stackoverflow.com/users/4925420/atame"}, "edited": false, "score": 0, "creation_date": 1433332798, "post_id": 30619362, "comment_id": 49304916, "body": "thanks for the answer, but i need it to happen on a button click. Basically the user will paste new data each month into Global and Details, when click a button that will do the VLookUps Automatically"}, {"owner": {"reputation": 514, "user_id": 4967653, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jLy0eO8CT3E/AAAAAAAAAAI/AAAAAAAAAeQ/r1of1sWAlcw/photo.jpg?sz=128", "display_name": "keong kenshih", "link": "https://stackoverflow.com/users/4967653/keong-kenshih"}, "reply_to_user": {"reputation": 491, "user_id": 4925420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a46e2bd849822edc3501d1f41079f607?s=128&d=identicon&r=PG&f=1", "display_name": "atame", "link": "https://stackoverflow.com/users/4925420/atame"}, "edited": false, "score": 0, "creation_date": 1433333207, "post_id": 30619362, "comment_id": 49305205, "body": "VLookup will be done automatically in the table after creating for the 1st time. In addition, if the user keep on pump in the data at details worksheet, the VLookup will auto generate the result at global worksheet. So we don&#39;t need have a button to create the VLookup formula again."}, {"owner": {"reputation": 491, "user_id": 4925420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a46e2bd849822edc3501d1f41079f607?s=128&d=identicon&r=PG&f=1", "display_name": "atame", "link": "https://stackoverflow.com/users/4925420/atame"}, "edited": false, "score": 0, "creation_date": 1433334291, "post_id": 30619362, "comment_id": 49306003, "body": "would it be easier to use a find loop, so find data in column b, then if match, copy columns H,F &amp; E to O, P &amp; Q"}, {"owner": {"reputation": 514, "user_id": 4967653, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jLy0eO8CT3E/AAAAAAAAAAI/AAAAAAAAAeQ/r1of1sWAlcw/photo.jpg?sz=128", "display_name": "keong kenshih", "link": "https://stackoverflow.com/users/4967653/keong-kenshih"}, "reply_to_user": {"reputation": 491, "user_id": 4925420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a46e2bd849822edc3501d1f41079f607?s=128&d=identicon&r=PG&f=1", "display_name": "atame", "link": "https://stackoverflow.com/users/4925420/atame"}, "edited": false, "score": 0, "creation_date": 1433378950, "post_id": 30619362, "comment_id": 49331935, "body": "VLookup already perform all the requirement you need, Let take this example Column P:=VLOOKUP([Column BA],Details!A:H,6,FALSE)  , It will search column BA at Details worksheet column A until H follow by copy the value of H at Details worksheet to column P if exactly match (set by FALSE) is found.So, for your case, you don&#39;t need write the macro but put the data in table(with headers) and put formula for the 1st data row. Here got more explanation about VLookup, hope it clear your doubts <a href=\"http://stackoverflow.com/questions/30617441/create-a-vba-macro-that-find-and-copy/30618397#30618397\">link</a>"}], "tags": [], "owner": {"reputation": 514, "user_id": 4967653, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jLy0eO8CT3E/AAAAAAAAAAI/AAAAAAAAAeQ/r1of1sWAlcw/photo.jpg?sz=128", "display_name": "keong kenshih", "link": "https://stackoverflow.com/users/4967653/keong-kenshih"}, "is_accepted": false, "score": 0, "last_activity_date": 1433332393, "creation_date": 1433332393, "answer_id": 30619362, "question_id": 30616598, "link": "https://stackoverflow.com/questions/30616598/vlookup-with-button-click/30619362#30619362", "title": "VLOOKUP with button click", "body": "<p><br>\nwhat I suggest is you put all the value in table will be more efficient (not simply enter in the excel cell), you need create the table by INSERT ->Table. It will look like this :\n <img src=\"https://i.stack.imgur.com/z41lo.png\" alt=\"global table\">\n<br> Do this also for the Details :<br>\n<img src=\"https://i.stack.imgur.com/lmESG.png\" alt=\"Details table\">\n<br> Back to global worksheet, just need enter 1 row of formula, the rest of the rows in the same column will have the same formula \"style\" \n<br>Column O :=VLOOKUP([Column BA],Table2[[#All],[Column1]:[Column8]],8,FALSE)\n<br>Column P :=VLOOKUP([Column BA],Details!A:H,6,FALSE)\n<br>Column Q :=VLOOKUP([Column BA],Details!A:H,5,FALSE)\n<br><br>\nTo remove the unwanted row, just filter out the blanks value in that columns will do.</p>\n"}], "owner": {"reputation": 491, "user_id": 4925420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a46e2bd849822edc3501d1f41079f607?s=128&d=identicon&r=PG&f=1", "display_name": "atame", "link": "https://stackoverflow.com/users/4925420/atame"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3266, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1433424239, "creation_date": 1433325010, "last_edit_date": 1433424239, "question_id": 30616598, "link": "https://stackoverflow.com/questions/30616598/vlookup-with-button-click", "title": "VLOOKUP with button click", "body": "<p>I'm trying to write some code for a button click to perform a VLOOKUP.</p>\n\n<p>Sheet1 = Payment Form, Sheet2 = Global, Sheet3 = Details</p>\n\n<p>Button will be on Sheet \"Payment Form\".</p>\n\n<p>This would be the code for Cells in Global Sheet,</p>\n\n<p>O1 = <code>=VLOOKUP(BA,Details!A:H,8,0)</code><br>\nP1 = <code>=VLOOKUP(BA,Details!A:H,6,0)</code><br>\nQ1 =<code>VLOOKUP(BA,Details!A:H,5,0)</code></p>\n\n<p>I need this to loop through all rows as the amount can change each month, if a match is found the perform the VlookUp, is no match is found, the delete the row from the Details Sheet.</p>\n\n<p>For Example: Global, Cell B1 = 27801. In Details match found, then do the above codes from Columns O, P &amp; Q.\nGlobal, B2 = 27802. In Details no matching record found, row deleted. Continue to row 3 &amp; 4 ......</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1433323372, "post_id": 30615841, "comment_id": 49298246, "body": "Try <code>Worksheets(&quot;New Name&quot;).Select</code>"}, {"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1433323375, "post_id": 30615841, "comment_id": 49298250, "body": "Tried the code here and works. You can probably loose Worksheets(2).select, it should already be the activesheet after copy, but that is not why it is not working for you."}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 3, "creation_date": 1433323592, "post_id": 30615841, "comment_id": 49298411, "body": "Do not use <code>Select</code> method! That&#39;s bad programming practice!"}, {"owner": {"reputation": 712, "user_id": 3243922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mFTEb.jpg?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3243922/tom"}, "edited": false, "score": 1, "creation_date": 1433323850, "post_id": 30615841, "comment_id": 49298594, "body": "I think you would be better off setting the added worksheet as a worksheet object in your code and working with that instead of depending on the activesheet. That way you do not even have to select a sheet to do something on it. (Set wks = Worksheets(Worksheets.Count) would do the trick after that you can do wks.Rows(&quot;1:20&quot;).Delete At the end of the procedure do not forget to release the worksheet with Set wks = nothing)"}, {"owner": {"reputation": 11, "user_id": 4968829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbec8df3dea0a928fc2ef34370214d21?s=128&d=identicon&r=PG&f=1", "display_name": "kingblackbeard", "link": "https://stackoverflow.com/users/4968829/kingblackbeard"}, "reply_to_user": {"reputation": 712, "user_id": 3243922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mFTEb.jpg?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3243922/tom"}, "edited": false, "score": 0, "creation_date": 1433325390, "post_id": 30615841, "comment_id": 49299691, "body": "@Tom Kinda new to VBA but, just out of curiosity, why do you have to release the worksheet?"}, {"owner": {"reputation": 712, "user_id": 3243922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mFTEb.jpg?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3243922/tom"}, "edited": false, "score": 0, "creation_date": 1433327439, "post_id": 30615841, "comment_id": 49301183, "body": "VBA is not very good at cleaning up. So the object reference may live on after the code has been completed. This may cause problems later on. In .NET applications there is something called the garbage collector that does the cleaning up for you. In VBA you do not NEED to do clean up yourself, but it is safer to do so."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4968829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbec8df3dea0a928fc2ef34370214d21?s=128&d=identicon&r=PG&f=1", "display_name": "kingblackbeard", "link": "https://stackoverflow.com/users/4968829/kingblackbeard"}, "edited": false, "score": 0, "creation_date": 1433325633, "post_id": 30616030, "comment_id": 49299869, "body": "That worked for the deleting of rows, but the column sorting is now giving me a 1004 Run-time error *** figured it out, I was running it in the worksheet itself and not a new module.... Thanks anyway!"}], "tags": [], "owner": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "is_accepted": false, "score": 1, "last_activity_date": 1433326172, "last_edit_date": 1433326172, "creation_date": 1433323647, "answer_id": 30616030, "question_id": 30615841, "link": "https://stackoverflow.com/questions/30615841/rows-delete-is-deleting-from-the-wrong-worksheet/30616030#30616030", "title": "Rows.Delete is deleting from the wrong worksheet", "body": "<p>Using Activate or Select or ActivateSheet to specify which instance of something you want is actually a confusing way to work in VBA. This is a great example of that. I'd suggest avoiding anything with 'active' or 'select' unless absolutely essential. There's very rarely a need for it.</p>\n\n<p>Try:</p>\n\n<pre><code>Worksheets(1).Copy After:=Worksheets(1)\nWorksheets(2).Name = \"New Name\"\nWorksheets(2).Rows(\"1:20\").Delete\nWorksheets(2).Columns(\"A:U\").Sort key1:=Range(\"K2\"), order1:=xlDescending, Header:=xlYes\n</code></pre>\n\n<p>EDIT:</p>\n\n<pre><code>Worksheets(2).Columns(\"A:U\").Sort key1:=Range(\"K2\"), order1:=xlDescending, Header:=xlYes\n</code></pre>\n\n<p>should be:</p>\n\n<pre><code>Worksheets(2).Columns(\"A:U\").Sort key1:=Worksheets(2).Range(\"K2\"), order1:=xlDescending, Header:=xlYes\n</code></pre>\n\n<p>(We didn't specify which sheet to choose K2 from)</p>\n"}], "owner": {"reputation": 11, "user_id": 4968829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbec8df3dea0a928fc2ef34370214d21?s=128&d=identicon&r=PG&f=1", "display_name": "kingblackbeard", "link": "https://stackoverflow.com/users/4968829/kingblackbeard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1433326172, "creation_date": 1433323174, "last_edit_date": 1433325906, "question_id": 30615841, "link": "https://stackoverflow.com/questions/30615841/rows-delete-is-deleting-from-the-wrong-worksheet", "title": "Rows.Delete is deleting from the wrong worksheet", "body": "<p>I have this code setup to copy the 1st sheet and rename it after the Sheet1. After that, it is supposed to select the new sheet, delete the first 20 rows on the new sheet, and sort by column K, also on the new sheet. And it is doing that, but it is doing it on the 1st worksheet instead. </p>\n\n<pre><code>Worksheets(1).Copy After:=Worksheets(1)\nActiveSheet.Name = \"New Name\"\nWorksheets(2).Select\nRows(\"1:20\").Delete\nColumns(\"A:U\").Sort key1:=Range(\"K2\"), order1:=xlDescending, Header:=xlYes\n</code></pre>\n\n<p>I have tried activating the worksheet several different ways, but none are really working. Thanks for the help!</p>\n\n<p><strong>* *</strong> figured it out, I was running it in the worksheet itself and not a new module.... Thanks for the help everyone! And no more using .select if I can avoid it!</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1433324493, "post_id": 30615357, "comment_id": 49299041, "body": "That is the main advantage (in your case disadvantage) of compiling a file to executable only. As no design changes can be made once it is compiled. I do not think even VBA can help in dropping reference once it is compiled."}], "answers": [{"comments": [{"owner": {"reputation": 198, "user_id": 2107580, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d7940c916f82b933f796dbc7a247fa6d?s=128&d=identicon&r=PG", "display_name": "Simon Sellick", "link": "https://stackoverflow.com/users/2107580/simon-sellick"}, "edited": false, "score": 0, "creation_date": 1433419606, "post_id": 30618942, "comment_id": 49350835, "body": "Thanks; I was correct - it should have been obvious really."}], "tags": [], "owner": {"reputation": 1561, "user_id": 4783374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ktbGv.jpg?s=128&g=1", "display_name": "PhilS", "link": "https://stackoverflow.com/users/4783374/phils"}, "is_accepted": true, "score": 3, "last_activity_date": 1433331309, "creation_date": 1433331309, "answer_id": 30618942, "question_id": 30615357, "link": "https://stackoverflow.com/questions/30615357/why-cant-i-remove-a-reference-from-an-access-2010-accdb-project/30618942#30618942", "title": "Why can&#39;t I remove a reference from an Access 2010 .accdb project?", "body": "<p>You cannot remove referenced library-databases from within the Project Explorer.</p>\n\n<p>Use the References-Dialog in the <strong>menu</strong> \"Tools\"-\"References\" within the VBA-Editor to remove the reference.</p>\n"}], "owner": {"reputation": 198, "user_id": 2107580, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d7940c916f82b933f796dbc7a247fa6d?s=128&d=identicon&r=PG", "display_name": "Simon Sellick", "link": "https://stackoverflow.com/users/2107580/simon-sellick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 597, "favorite_count": 0, "accepted_answer_id": 30618942, "answer_count": 1, "score": 0, "last_activity_date": 1594644382, "creation_date": 1433321957, "last_edit_date": 1594644382, "question_id": 30615357, "link": "https://stackoverflow.com/questions/30615357/why-cant-i-remove-a-reference-from-an-access-2010-accdb-project", "title": "Why can&#39;t I remove a reference from an Access 2010 .accdb project?", "body": "<p>Experimenting with shared modules in MS Access 2010, I want to remove a reference to a compiled database (.accde) containing the code module, but the 'remove' option is greyed out for both the module and the containing database in the project browser.  How can I drop the reference?  The code is in design mode, not debug.</p>\n\n<p>Apologies if this should be obvious.</p>\n"}, {"tags": ["excel", "vba", "search", "line"], "comments": [{"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1433320336, "post_id": 30614760, "comment_id": 49296136, "body": "What is in strSearchPhrase? and where is this set? If you produce the error and then type &quot;? strSearchPhrase&quot; into the immediate window what does that display?"}, {"owner": {"reputation": 155, "user_id": 4968648, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/8bb2f7933dec1fc3a31d67dbe1dbbf84?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Plich", "link": "https://stackoverflow.com/users/4968648/micha%c5%82-plich"}, "reply_to_user": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1433320714, "post_id": 30614760, "comment_id": 49296365, "body": "I forgot to put it into module, strSearchPhrase is just a text, which I&#39;m looking for, so it can be:      strSearchPhrase = &quot;Test string&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 746, "user_id": 4733869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f0b856d3215d1cbde059e0d411ab55?s=128&d=identicon&r=PG&f=1", "display_name": "Dawid", "link": "https://stackoverflow.com/users/4733869/dawid"}, "is_accepted": false, "score": 3, "last_activity_date": 1433324928, "last_edit_date": 1525816098, "creation_date": 1433324928, "answer_id": 30616555, "question_id": 30614760, "link": "https://stackoverflow.com/questions/30614760/searching-for-the-text-in-vba-code-in-which-line/30616555#30616555", "title": "Searching for the text in VBA code (in which line)", "body": "<p>Maybe change <code>Dim i As Integer</code> to <code>Dim i As Long</code> will resolve mismatch error?</p>\n\n<blockquote>\n  <p>The CodeModule object has a Find method that you can use to search for text within the code module. The Find method accepts ByRef Long parameters.</p>\n</blockquote>\n\n<p>source -> <a href=\"http://www.cpearson.com/excel/vbe.aspx\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/vbe.aspx</a></p>\n"}], "owner": {"reputation": 155, "user_id": 4968648, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/8bb2f7933dec1fc3a31d67dbe1dbbf84?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Plich", "link": "https://stackoverflow.com/users/4968648/micha%c5%82-plich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2681, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1433422762, "creation_date": 1433320234, "last_edit_date": 1433422762, "question_id": 30614760, "link": "https://stackoverflow.com/questions/30614760/searching-for-the-text-in-vba-code-in-which-line", "title": "Searching for the text in VBA code (in which line)", "body": "<p>I wonder how to search each line in VBA module and get the number of any line where text was found. I've figured out something like this:</p>\n\n<pre><code>Sub addProcedure()\n\nDim vbProj As VBIDE.VBProject\nDim vbComp As VBIDE.VBComponent\nDim vbCode As VBIDE.CodeModule\n\nDim strSearchPhrase As String\nDim strModuleName As String\nDim intLinesNr As Integer\nDim i As Integer\nDim intFoundLine As Integer\n\nstrModuleName = \"Test\"\n\nSet vbProj = ActiveWorkbook.VBProject\nSet vbComp = vbProj.VBComponents(strModuleName)\nSet vbCode = vbComp.CodeModule\n\nintLinesNr = vbCode.CountOfLines\n\n\nFor i = 1 To intLinesNr\n  If vbCode.Find(strSearchPhrase, i, 1, -1, -1) Then\n    intFoundLine = i\n    Exit For\n  End If\nNext i\n\nIf foundline &lt;&gt; 0 Then MsgBox \"Text found in \" &amp; intFoundLine &amp; \" line.\"\n\n\nSet vbComp = Nothing\nSet vbProj = Nothing\nSet vbCode = Nothing\nEnd Sub\n</code></pre>\n\n<p>And it returns Compile error: ByRef argument type mismatch in:</p>\n\n<pre><code>If vbCode.Find(strSearchPhrase, i, 1, -1, -1) Then\n</code></pre>\n\n<p>Any others ideas how to do that?</p>\n"}, {"tags": ["vba", "scripting", "formatting", "conditional"], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 4849894, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b57336596ffb2b49e0a14239635f8bc?s=128&d=identicon&r=PG&f=1", "display_name": "Witloofdc", "link": "https://stackoverflow.com/users/4849894/witloofdc"}, "edited": false, "score": 0, "creation_date": 1433322273, "post_id": 30615390, "comment_id": 49297473, "body": "Hi, thanks for this suggestion! Do I add this right after comyfromrecordset rs command?"}, {"owner": {"reputation": 81, "user_id": 4849894, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b57336596ffb2b49e0a14239635f8bc?s=128&d=identicon&r=PG&f=1", "display_name": "Witloofdc", "link": "https://stackoverflow.com/users/4849894/witloofdc"}, "edited": false, "score": 0, "creation_date": 1433322313, "post_id": 30615390, "comment_id": 49297497, "body": "Also, should I address activesheet with objExcel.activesheet or objWorkbook.activesheet?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 81, "user_id": 4849894, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b57336596ffb2b49e0a14239635f8bc?s=128&d=identicon&r=PG&f=1", "display_name": "Witloofdc", "link": "https://stackoverflow.com/users/4849894/witloofdc"}, "edited": false, "score": 0, "creation_date": 1433322710, "post_id": 30615390, "comment_id": 49297802, "body": "<code>objWorkbook.activesheet</code> or <code>objWorkbook.Sheets(&quot;SheetName_As_String&quot;)</code> for references. And yes place it after <code>baseSheet.Range(&quot;A2&quot;).CopyFromRecordset rs</code>. Btw is it normal that you copy it twice?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 81, "user_id": 4849894, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b57336596ffb2b49e0a14239635f8bc?s=128&d=identicon&r=PG&f=1", "display_name": "Witloofdc", "link": "https://stackoverflow.com/users/4849894/witloofdc"}, "edited": false, "score": 0, "creation_date": 1433322887, "post_id": 30615390, "comment_id": 49297909, "body": "And change <code>objExcel.Columns(&quot;A:J&quot;).Select     objExcel.selection.EntireColumn.AutoFit</code> to <code>objWorkBook.Columns(&quot;A:J&quot;).EntireColumn.AutoFit</code> it&#39;ll be more efficient as the <code>.Select</code> is really ressources-greedy"}, {"owner": {"reputation": 81, "user_id": 4849894, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b57336596ffb2b49e0a14239635f8bc?s=128&d=identicon&r=PG&f=1", "display_name": "Witloofdc", "link": "https://stackoverflow.com/users/4849894/witloofdc"}, "edited": false, "score": 0, "creation_date": 1433323153, "post_id": 30615390, "comment_id": 49298094, "body": "Thanks! Last problem: For i = 1 To .Cells(.Rows.count, &quot;J&quot;).End(xlUp).ROW -&gt; The xlUp variable is not defined, can I just declare this or is there another way of addressing this?"}, {"owner": {"reputation": 81, "user_id": 4849894, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b57336596ffb2b49e0a14239635f8bc?s=128&d=identicon&r=PG&f=1", "display_name": "Witloofdc", "link": "https://stackoverflow.com/users/4849894/witloofdc"}, "edited": false, "score": 0, "creation_date": 1433323362, "post_id": 30615390, "comment_id": 49298238, "body": "objWorkBook.Columns(&quot;A:J&quot;).EntireColumn.AutoFit gives runtime error &#39;438&#39;: Object doesnt support this property or method"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 81, "user_id": 4849894, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b57336596ffb2b49e0a14239635f8bc?s=128&d=identicon&r=PG&f=1", "display_name": "Witloofdc", "link": "https://stackoverflow.com/users/4849894/witloofdc"}, "edited": false, "score": 0, "creation_date": 1433324073, "post_id": 30615390, "comment_id": 49298743, "body": "My bad, I forgot the <b>sheet reference</b> in the middle : <code>Application.Workbook.Sheet.Range</code> . For <code>Const xlUp = -4162 (&amp;HFFFFEFBE)</code>, you can try the numerical values. I think that you haven&#39;t a constant numbers of rows, so you still need something to calculate your last row for the loop, maybe with <code>fldcount</code> can be reuse?"}, {"owner": {"reputation": 81, "user_id": 4849894, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b57336596ffb2b49e0a14239635f8bc?s=128&d=identicon&r=PG&f=1", "display_name": "Witloofdc", "link": "https://stackoverflow.com/users/4849894/witloofdc"}, "edited": false, "score": 0, "creation_date": 1433325054, "post_id": 30615390, "comment_id": 49299427, "body": "the problem now is that the xlSolid and xlAutomatic aren&#39;t defined, + I suddenly get a &#39;end with without with&#39; error"}, {"owner": {"reputation": 81, "user_id": 4849894, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b57336596ffb2b49e0a14239635f8bc?s=128&d=identicon&r=PG&f=1", "display_name": "Witloofdc", "link": "https://stackoverflow.com/users/4849894/witloofdc"}, "edited": false, "score": 0, "creation_date": 1433325611, "post_id": 30615390, "comment_id": 49299859, "body": "Hi, conditional formatting works! Thanks a lot! Last, and I mean last question, can you write out the right line for &quot;objWorkBook.Columns(&quot;A:J&quot;).EntireColumn.AutoFit&quot; please? Last thing that doesn&#39;t work, everything else is working awesomely! Thanks again."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 81, "user_id": 4849894, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b57336596ffb2b49e0a14239635f8bc?s=128&d=identicon&r=PG&f=1", "display_name": "Witloofdc", "link": "https://stackoverflow.com/users/4849894/witloofdc"}, "edited": false, "score": 0, "creation_date": 1433327080, "post_id": 30615390, "comment_id": 49300940, "body": "Change it to &quot;objWorkBook.Sheets(&quot; SheetName-As-String&quot;).Columns(&quot;A:J&quot;).EntireColumn.AutoFit&quot; and replace SheetName-As-String by the name of your sheet (probably Sheet1)"}, {"owner": {"reputation": 81, "user_id": 4849894, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b57336596ffb2b49e0a14239635f8bc?s=128&d=identicon&r=PG&f=1", "display_name": "Witloofdc", "link": "https://stackoverflow.com/users/4849894/witloofdc"}, "edited": false, "score": 0, "creation_date": 1433329731, "post_id": 30615390, "comment_id": 49302739, "body": "Hi, I get a &#39;type mismatch&#39; error, run-time error &#39;13&#39;, sheet1 can&#39;t be used but I used &#39;basesheet&#39; since I declared that as &#39;Set baseSheet = objWorkbook.worksheets(1)&#39;, is this wrong reasoning? Or should I just declare sheet1 and use that? Thanks again, you&#39;ve been a great help!"}, {"owner": {"reputation": 81, "user_id": 4849894, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b57336596ffb2b49e0a14239635f8bc?s=128&d=identicon&r=PG&f=1", "display_name": "Witloofdc", "link": "https://stackoverflow.com/users/4849894/witloofdc"}, "edited": false, "score": 0, "creation_date": 1433329785, "post_id": 30615390, "comment_id": 49302775, "body": "If I use &quot;objWorkbook.Sheets(&quot;basesheet&quot;).Columns(&quot;A:J&quot;).EntireColumn&zwnj;&#8203;.AutoFit&quot; I get the error &#39;subscript out of range&#39;"}, {"owner": {"reputation": 81, "user_id": 4849894, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b57336596ffb2b49e0a14239635f8bc?s=128&d=identicon&r=PG&f=1", "display_name": "Witloofdc", "link": "https://stackoverflow.com/users/4849894/witloofdc"}, "edited": false, "score": 0, "creation_date": 1433330455, "post_id": 30615390, "comment_id": 49303226, "body": "IT WORKS thank you so much, I had to put sheet1 between parenthesis, thanks for  your help"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 81, "user_id": 4849894, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b57336596ffb2b49e0a14239635f8bc?s=128&d=identicon&r=PG&f=1", "display_name": "Witloofdc", "link": "https://stackoverflow.com/users/4849894/witloofdc"}, "edited": false, "score": 0, "creation_date": 1433333601, "post_id": 30615390, "comment_id": 49305494, "body": "My bad, I forgot that you had define <code>BaseSheet</code>, and as it is an object (so with included references) you can use it like this : <code>BaseSheet.Columns(&quot;A:J&quot;).EntireColumn.AutoFit</code>. The solution with parenthesis uses an index (integer) or the name of the object (string). Glad I could help! ;)"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 0, "last_activity_date": 1433322022, "creation_date": 1433322022, "answer_id": 30615390, "question_id": 30614756, "link": "https://stackoverflow.com/questions/30614756/conditional-formatting-vba-scripting-not-in-excel/30615390#30615390", "title": "Conditional formatting VBA scripting (not IN excel)", "body": "<p>Something like this might help you :</p>\n\n<pre><code>With ActiveSheet\n    For i = 1 To .Cells(.Rows.Count, \"J\").End(xlUp).Row\n        If InStr(1, .Cells(i, \"J\"), \"400 - 700\") &lt;= 0 Then\n        Else\n            .Cells(i, \"J\").Interior.Pattern = xlSolid\n            .Cells(i, \"J\").Interior.PatternColorIndex = xlAutomatic\n            .Cells(i, \"J\").Interior.Color = 65535\n        End If\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 4849894, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b57336596ffb2b49e0a14239635f8bc?s=128&d=identicon&r=PG&f=1", "display_name": "Witloofdc", "link": "https://stackoverflow.com/users/4849894/witloofdc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 30615390, "answer_count": 1, "score": 1, "last_activity_date": 1445242296, "creation_date": 1433320221, "last_edit_date": 1445242296, "question_id": 30614756, "link": "https://stackoverflow.com/questions/30614756/conditional-formatting-vba-scripting-not-in-excel", "title": "Conditional formatting VBA scripting (not IN excel)", "body": "<p>I've been developing a script that runs through a Txtfile, retrieves certain references, stores these refs in a variable in the form of <code>('ref1','ref2','ref3',...)</code> so that after retrieving these refs I can query our database to retrieve 10 columns from the database.</p>\n\n<p>I add this result to an Excel file, like this: </p>\n\n<pre><code>If rs.BOF = False Or rs.EOF = False Then\n    Set objExcel = CreateObject(\"Excel.Application\")\n    Set objWorkbook = objExcel.workbooks.Add()\n    Set baseSheet = objWorkbook.worksheets(1)\n\n    fldcount = rs.Fields.count\n    For icol = 0 To fldcount - 1\n        baseSheet.Cells(1, icol + 1).VALUE = rs.Fields(icol).Name\n    Next\n    baseSheet.Range(baseSheet.Cells(1, 1), baseSheet.Cells(1, rs.Fields.count)).Font.Bold = True\n    baseSheet.Range(\"A2\").CopyFromRecordset rs\n    objExcel.ActiveWindow.Zoom = 70\n    objExcel.Columns(\"A:J\").Select\n    objExcel.selection.EntireColumn.AutoFit\n    baseSheet.Range(\"A2\").CopyFromRecordset rs\n    objExcel.Visible = True\nElse\n    MsgBox (\"Geen speciale gevallen\")\n    Exit Function\nEnd If\nSet objExcel = Nothing\nSet objWorkbook = Nothing\nSet baseSheet = Nothing\n</code></pre>\n\n<p>My question : <strong>Can I run through objExcel column \"J\" and test for a value (<code>if instr(contents of column \"J\", \"400 - 700\") &gt; 0 Then</code> backgroundcolor for that cell = yellow)</strong>? </p>\n\n<p>I can't disclose the other parts of the code since they are lengthy and might reveal where I work etc. </p>\n\n<p>To be clear this is not in Excel, it is in an attachmate reflection IBM terminal.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 514, "user_id": 4967653, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jLy0eO8CT3E/AAAAAAAAAAI/AAAAAAAAAeQ/r1of1sWAlcw/photo.jpg?sz=128", "display_name": "keong kenshih", "link": "https://stackoverflow.com/users/4967653/keong-kenshih"}, "is_accepted": false, "score": 0, "last_activity_date": 1433323233, "creation_date": 1433323233, "answer_id": 30615866, "question_id": 30614336, "link": "https://stackoverflow.com/questions/30614336/copy-data-to-another-selected-sheet-using-command-button/30615866#30615866", "title": "Copy data to another selected sheet using Command Button", "body": "<p><br>\nI assuming this is the \"Form\" worksheet look like<br>\n<img src=\"https://i.stack.imgur.com/R40j5.png\" alt=\"Form worksheet\">\n<br> and the \"subject\" worksheet look like the following:<br>\n<img src=\"https://i.stack.imgur.com/AjtcM.png\" alt=\"subject worksheet\">\n<br> when the button is click , the result is copied to the corresponding subject worksheet: <br>\n<img src=\"https://i.stack.imgur.com/HGWBB.png\" alt=\"Result copied\"> <br>\nThe following is the source code for the button: <br><br></p>\n\n<pre><code>Option Explicit\nDim ResultWorkbook As Workbook\nDim FormWorksheet As Worksheet\nDim SubjectWorksheet As Worksheet\nDim ListRange As Range\n\nSub CopyResult()\n\nDim LastRow As Long\nDim CurrentRow As Long\n\nSet ResultWorkbook = Workbooks(ActiveWorkbook.Name)\nSet FormWorksheet = ResultWorkbook.Sheets(\"Form\")\nSet SubjectWorksheet = ResultWorkbook.Sheets(FormWorksheet.Range(\"D4\").Value)\nSet ListRange = FormWorksheet.Range(\"D7:M7\")\n\nApplication.ScreenUpdating = False\n\nLastRow = SubjectWorksheet.Cells(Rows.Count, \"B\").End(xlUp).Row\n\nFor CurrentRow = 4 To LastRow\n    If SubjectWorksheet.Range(\"B\" &amp; CurrentRow).Value = FormWorksheet.Range(\"D2\").Value Then\n        SubjectWorksheet.Range(\"C\" &amp; CurrentRow &amp; \":L\" &amp; CurrentRow).Value = ListRange.Value\n    End If\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4967920, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Sfy46GdRlsI/AAAAAAAAAAI/AAAAAAAAABU/KPPjEUJJheQ/photo.jpg?sz=128", "display_name": "Andreas M M", "link": "https://stackoverflow.com/users/4967920/andreas-m-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1388, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1433323233, "creation_date": 1433318980, "last_edit_date": 1531164843, "question_id": 30614336, "link": "https://stackoverflow.com/questions/30614336/copy-data-to-another-selected-sheet-using-command-button", "title": "Copy data to another selected sheet using Command Button", "body": "<p>Sir, I have a problem in excell.\nI have a file in excell consist of several sheet.\nIn sheet \"Student\", there is a list name of students in range of cells (b2:b21) and also a list of their subject in range (d2:d5).</p>\n\n<p>In sheet \"Form\", there are form to input result of their test in range (D7:M7), a cell for name of student (D2) and a cell for their subject (D4). (D2) and (D4) is a drop down list and source from \"Student\" sheet.</p>\n\n<p>I also created several subject sheets</p>\n\n<p>I want to copy data from \"Form\" sheet range (D7:M7) to \"Math\" sheet or \"Physic\" sheet or etc range (C4:L23), depend on what is selected in cell (D2) and (D4).\nI also add activex control command button \"Submit\". So, when I klik \"Submit\" button, data in \"Form\" sheet range (D7:M7), copied to another sheet in range (C4:L23).\nI need vba code to program \"Submit\" command button in order to make the proces done.</p>\n"}, {"tags": ["html", "vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530307298, "post_id": 30614050, "comment_id": 89206155, "body": "No HTML, no URL, no code.....Not <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}], "answers": [{"tags": [], "owner": {"reputation": 640, "user_id": 4934536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-FH3r_zUz8aI/AAAAAAAAAAI/AAAAAAAAAg4/jLT4QUBRzi0/photo.jpg?sz=128", "display_name": "Kurt Ludikovsky", "link": "https://stackoverflow.com/users/4934536/kurt-ludikovsky"}, "is_accepted": false, "score": 0, "last_activity_date": 1433318724, "creation_date": 1433318724, "answer_id": 30614255, "question_id": 30614050, "link": "https://stackoverflow.com/questions/30614050/pulling-a-value-on-a-known-line-in-the-html-source-into-an-excel-spreadsheet/30614255#30614255", "title": "Pulling a value on a known line in the HTML source into an Excel spreadsheet", "body": "<p>Try using <a href=\"https://www.google.at/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;cad=rja&amp;uact=8&amp;ved=0CCMQFjAA&amp;url=http%3A%2F%2Fcode.google.com%2Fp%2Fselenium-vba%2F&amp;ei=QbRuVYH9Ksn9UPfwgvgH&amp;usg=AFQjCNGdbIx_-fCzI3G0sM_YAiAMtb_IdQ&amp;sig2=_lAT4FdhnPwn0SX199I9yg\" rel=\"nofollow\">Selenium-vba</a> which is the VBA implementation of Selenium.</p>\n\n<p>Selenium allows you perfom automated tests in various languages (mainly Java) and has a developing tool for Firefox.</p>\n\n<p>There are currently some problems with selenium-vba and Firefox (just to aviod that you spend to much time with this current issue) but you can run the test/routines also with Chrome.</p>\n"}], "owner": {"reputation": 11, "user_id": 4968462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bed7307b25a45a5f40a47367ea8f69c?s=128&d=identicon&r=PG&f=1", "display_name": "kmix", "link": "https://stackoverflow.com/users/4968462/kmix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1433422584, "creation_date": 1433318066, "last_edit_date": 1433422584, "question_id": 30614050, "link": "https://stackoverflow.com/questions/30614050/pulling-a-value-on-a-known-line-in-the-html-source-into-an-excel-spreadsheet", "title": "Pulling a value on a known line in the HTML source into an Excel spreadsheet", "body": "<p>I have a series of order numbers, and I want to add their status into an Excel spreadsheet, which will update as that status changes.  </p>\n\n<p>I have set up the spreadsheet, and I have created a formula that adds hyperlinks to the orders on my site in a separate column, so I have a correct URL for every instance. These hyperlinks lead to an overview page for the particular order, on which page there is an order status.  Unfortunately the status isn't a separate HTML table, so I can't just use the web query tool.  I know where that status can be found within the source code, and that location remains constant across all orders.  I'm looking for a way to pull in this data that would allow it to refresh hourly, and allow me to easily repeat the process for several hundred orders.  </p>\n\n<p>Can anyone shed some light?</p>\n"}, {"tags": ["vba", "text"], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 4042342, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/22YhK.jpg?s=128&g=1", "display_name": "White", "link": "https://stackoverflow.com/users/4042342/white"}, "is_accepted": false, "score": 2, "last_activity_date": 1433318369, "last_edit_date": 1433318369, "creation_date": 1433317410, "answer_id": 30613842, "question_id": 30613841, "link": "https://stackoverflow.com/questions/30613841/how-to-do-a-tabulation-char-in-vba/30613842#30613842", "title": "How to do a tabulation char in VBA?", "body": "<p>You have to use <code>vbTab</code></p>\n\n<blockquote>\n  <p>MsgBox \"blabla\" + vbTab + \"blabla\"</p>\n</blockquote>\n\n<p>You can also use: <code>Chr(9)</code> which directly correspond to the tabulation char in the ASCII table.\nI.E. : \"reverse\" of <code>Chr()</code> is <code>Asc()</code></p>\n"}], "owner": {"reputation": 81, "user_id": 4042342, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/22YhK.jpg?s=128&g=1", "display_name": "White", "link": "https://stackoverflow.com/users/4042342/white"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1658, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433318369, "creation_date": 1433317410, "question_id": 30613841, "link": "https://stackoverflow.com/questions/30613841/how-to-do-a-tabulation-char-in-vba", "title": "How to do a tabulation char in VBA?", "body": "<p>If you want to make a tabulation for a message box or to write in a file.</p>\n\n<p>To write in a file:</p>\n\n<pre><code>&gt; 'file \n&gt; Dim FSO As New FileSystemObject 'FSO \n&gt; Dim File_DBC 'file to write\n&gt; \n&gt; File_DBC=\"\" 'complete path\n&gt; \n&gt; Set File_DBC = FSO.OpenTextFile(File_DBC, ForWriting, True,TristateUseDefault) 'open \n&gt; Data File_DBC.WriteLine 'test'\n</code></pre>\n"}, {"tags": ["excel", "outlook", "vba"], "answers": [{"comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1433320721, "post_id": 30613698, "comment_id": 49296370, "body": "I would prefer this method. provided it is slightly modified :)"}, {"owner": {"reputation": 2275, "user_id": 2040286, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38346fd1ac7ec2130b6644fa44acb88c?s=128&d=identicon&r=PG", "display_name": "Paresh J", "link": "https://stackoverflow.com/users/2040286/paresh-j"}, "edited": false, "score": 0, "creation_date": 1433322825, "post_id": 30613698, "comment_id": 49297878, "body": "Yes you are right Siddharth! Need to trim the subject and add Ucase in order to avoid inconsistency of data. Answer is updated now."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1433323059, "post_id": 30613698, "comment_id": 49298032, "body": "++ now it makes sense :)"}], "tags": [], "owner": {"reputation": 2275, "user_id": 2040286, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38346fd1ac7ec2130b6644fa44acb88c?s=128&d=identicon&r=PG", "display_name": "Paresh J", "link": "https://stackoverflow.com/users/2040286/paresh-j"}, "is_accepted": false, "score": 3, "last_activity_date": 1433322746, "last_edit_date": 1433322746, "creation_date": 1433317026, "answer_id": 30613698, "question_id": 30613626, "link": "https://stackoverflow.com/questions/30613626/if-email-subject-line-starts-with-certain-values-then-do-something/30613698#30613698", "title": "If email subject line starts with certain values then do something", "body": "<p>You can simply use VBA <code>LEFT</code> function here:</p>\n\n<pre><code>If UCASE(LEFT(TRIM(mail.Subject), 3)) = \"VEH\" OR UCASE(LEFT(TRIM(mail.Subject), 3)) = \"MAT\" Then\n\n'' DO something here\n\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 145, "user_id": 4786410, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/969158327194824aae3a978ae5271bef?s=128&d=identicon&r=PG&f=1", "display_name": "redd", "link": "https://stackoverflow.com/users/4786410/redd"}, "edited": false, "score": 0, "creation_date": 1433318969, "post_id": 30613715, "comment_id": 49295260, "body": "Works perfectly. Thank you!"}], "tags": [], "owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "is_accepted": true, "score": 1, "last_activity_date": 1433317078, "creation_date": 1433317078, "answer_id": 30613715, "question_id": 30613626, "link": "https://stackoverflow.com/questions/30613626/if-email-subject-line-starts-with-certain-values-then-do-something/30613715#30613715", "title": "If email subject line starts with certain values then do something", "body": "<p>The correct syntax for your <code>If</code> statement is:</p>\n\n<pre><code>If (mail.Subject Like \"VEH*\") Or (mail.Subject Like \"MAT*\") Then  \n</code></pre>\n\n<p>The brackets are optional (<code>Like</code> operator has higher precedence than <code>Or</code>), but it's easier to read.   </p>\n"}, {"comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 3, "creation_date": 1433341805, "post_id": 30614904, "comment_id": 49312068, "body": "@Downvoter: Care for a comment? Maybe I will get to learn something from you? If it is that you just don&#39;t like my face then it is ok... Don&#39;t bother... I can&#39;t help you there much :P"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 2, "last_activity_date": 1433321556, "last_edit_date": 1433321556, "creation_date": 1433320643, "answer_id": 30614904, "question_id": 30613626, "link": "https://stackoverflow.com/questions/30613626/if-email-subject-line-starts-with-certain-values-then-do-something/30614904#30614904", "title": "If email subject line starts with certain values then do something", "body": "<p>If the emails are from different users then I wouldn't recommend using <code>Like</code> in such a scenario. If it is machine generated with fixed Subject then it makes sense.</p>\n\n<p><strong>Reason</strong>: <code>Like/Left</code> is case sensitive</p>\n\n<p><strong>Example</strong>:</p>\n\n<pre><code>Sub Sample()\n    Dim s As String\n\n    s = \"vehicle\"\n\n    If s Like \"VEH*\" Then\n        MsgBox \"Found a match\"\n    Else\n        MsgBox \"didn't find a match\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Sub Sample()\n    Dim s As String\n\n    s = \"vehicle\"\n\n    If Left(s, 3) = \"VEH\" Then\n        MsgBox \"Found a match\"\n    Else\n        MsgBox \"didn't find a match\"\n    End If\nEnd Sub\n</code></pre>\n\n<p><strong>Alternative</strong></p>\n\n<p>For a search which is not case sensitive for example <code>Vehicle</code>, <code>vehicle</code>, <code>VeHiCle</code>, modify what @PareshJ posted.</p>\n\n<pre><code>Sub Sample()\n    Dim subj As String\n\n    subj = \"   Vehicle Number XYZ\"\n\n    If UCase(Left(Trim(subj), 3)) = \"VEH\" Then\n        MsgBox \"Found a match\"\n    Else\n        MsgBox \"didn't find a match\"\n    End If\nEnd Sub\n</code></pre>\n\n<p><code>Trim</code> trims the leading and trailing spaces and <code>Ucase</code> converts a string into uppercase.</p>\n\n<p><strong>Edit</strong></p>\n\n<p>If you still want to use <code>Like</code> then you may want to use this</p>\n\n<pre><code>Option Compare Text '&lt;~~ For case insensitive\n\nSub Sample()\n    Dim subj As String\n\n    subj = \"   Vehicle Number XYZ\"\n\n    If Trim(subj) Like \"VEH*\" Then\n        MsgBox \"Found a match\"\n    Else\n        MsgBox \"didn't find a match\"\n    End If\nEnd Sub\n</code></pre>\n\n<p><strong>Caution:</strong> <code>Option Compare Text</code> will also affect any other comparisons in the code.</p>\n"}], "owner": {"reputation": 145, "user_id": 4786410, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/969158327194824aae3a978ae5271bef?s=128&d=identicon&r=PG&f=1", "display_name": "redd", "link": "https://stackoverflow.com/users/4786410/redd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 796, "favorite_count": 0, "accepted_answer_id": 30613715, "answer_count": 3, "score": 2, "last_activity_date": 1433322746, "creation_date": 1433316815, "last_edit_date": 1531161705, "question_id": 30613626, "link": "https://stackoverflow.com/questions/30613626/if-email-subject-line-starts-with-certain-values-then-do-something", "title": "If email subject line starts with certain values then do something", "body": "<p>What is wrong with this line of code? Throws up Run-time error '13', Type mis-match.</p>\n\n<pre><code>Dim mail As Outlook.MailItem\n\nIf mail.Subject Like \"VEH\" &amp; \"*\" Or \"MAT\" &amp; \"*\" Then\n</code></pre>\n\n<p>Trying to say if the subject of the email starts with \"VEH\" or \"MAT\", then do something.</p>\n"}, {"tags": ["vba", "excel", "combobox"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1433316157, "post_id": 30613279, "comment_id": 49293552, "body": "Are you talking about the ActiveX control or the one in UserForm? My guess is ActiveX"}], "answers": [{"tags": [], "owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "is_accepted": true, "score": 2, "last_activity_date": 1433345529, "creation_date": 1433345529, "answer_id": 30624542, "question_id": 30613279, "link": "https://stackoverflow.com/questions/30613279/difference-between-combobox-properties-seltext-and-text/30624542#30624542", "title": "Difference between Combobox properties SelText and Text?", "body": "<p>The difference is really given in the name (<strong>Sel</strong>Text vs. Text) where <strong>Sel</strong> stands for <code>Selected</code>.  One is used to return or modify the selected text (i.e. <code>SelText</code>) and the other is used to return or modify the entire text (i.e. <code>Text</code>).</p>\n\n<p>If no text is selected in the ComboBox then they return and modify the same value.</p>\n\n<p>I suspect you want to use <code>Text</code> unless you are specifically interested in the selected text.</p>\n\n<p>This appears to be consistent for an ActiveX control on a <code>Worksheet</code> or for a control on a User Form.</p>\n"}], "owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2304, "favorite_count": 0, "accepted_answer_id": 30624542, "answer_count": 1, "score": 1, "last_activity_date": 1433345529, "creation_date": 1433315794, "question_id": 30613279, "link": "https://stackoverflow.com/questions/30613279/difference-between-combobox-properties-seltext-and-text", "title": "Difference between Combobox properties SelText and Text?", "body": "<p>I don't quite understand the differences between the combobox properties <code>SelText</code> and <code>Text</code>.</p>\n\n<p>If I want to send the content of a combobox as a parameter to another procedure, should I send <code>.text</code> or <code>.selText</code>?</p>\n\n<p>If I want to make enter text into a combobox using a macro, should I write the text in <code>.selText</code> or <code>.Text</code>?</p>\n"}, {"tags": ["vba", "excel", "activex"], "comments": [{"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1433316052, "post_id": 30613031, "comment_id": 49293484, "body": "Please consider using <code>ListFillRange</code> property of ComboBox. If you set it to <code>BudgetDropdown</code>, the list should populate automatically."}, {"owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "reply_to_user": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1433317454, "post_id": 30613031, "comment_id": 49294342, "body": "That sounds like a great idea. However, ComboBox1.ListFillRange = wConfig.Range(&quot;BudgetDropdown&quot;) throws an error saying &quot;Type mismatch&quot;"}, {"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1433317666, "post_id": 30613031, "comment_id": 49294467, "body": "You should use <code>ComboBox1.ListFillRange = &quot;BudgetDropdown&quot;</code>, or simply set it in property editor to <code>BudgetDropdown</code>. Just make sure the name is defined with workbook scope or it&#39;s in the same worksheet."}, {"owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "reply_to_user": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1433319662, "post_id": 30613031, "comment_id": 49295694, "body": "Great, that works and is a solution to my problem. Thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "edited": false, "score": 0, "creation_date": 1433320629, "post_id": 30614706, "comment_id": 49296314, "body": "There seems to be a downside with this. Every time a value is changed on the worksheet, the Combobox1_change event triggers. <a href=\"http://www.mrexcel.com/forum/excel-questions/603076-combobox-change-event-triggers-value-change-worksheet.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a>"}, {"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "reply_to_user": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "edited": false, "score": 0, "creation_date": 1433320804, "post_id": 30614706, "comment_id": 49296433, "body": "@user1283776 what is your definition of <code>BudgetDropdown</code> - is it volatile as in the linked thread?"}, {"owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "edited": false, "score": 0, "creation_date": 1433321090, "post_id": 30614706, "comment_id": 49296630, "body": "It&#39;s a named range in Excel consisting of offset and counta functions. Maybe a better solution for me would be to remove all items for the combobox and then readd them like I was doing? But in my original code I have the problem that.clear seems to not only remove all items but also changes the value/text of the combobox which I don&#39;t want it to do. Is it possible to remove all items while leaving the value/text that is written in the combobox unaffected"}, {"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "reply_to_user": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "edited": false, "score": 0, "creation_date": 1433321577, "post_id": 30614706, "comment_id": 49296962, "body": "I would start with replacing <code>OFFSET</code> volatile ranges, with construction like <code>=$A$1:INDEX($A:$A,COUNTA($A:$A))</code> - this should eliminate unwanted change events."}, {"owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "edited": false, "score": 0, "creation_date": 1433328058, "post_id": 30614706, "comment_id": 49301618, "body": "I like the formula that you suggested and will use it in other situations in the future. But even with the new formula, combobox1_change isl triggered by some actions in the workbook. I can&#39;t use this solution for my intended purpose. I still appreciate you help and ideas!"}, {"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "reply_to_user": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "edited": false, "score": 0, "creation_date": 1433328258, "post_id": 30614706, "comment_id": 49301738, "body": "@user1283776 OK, can you edit the question and describe in greater detail what is the purpose of this combobox, and what exactly does the Change event handler do? It would be great, if you could create a sample workbook to demonstrate current design and the issues."}, {"owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "edited": false, "score": 0, "creation_date": 1433329295, "post_id": 30614706, "comment_id": 49302441, "body": "I created a similar question here: <a href=\"http://stackoverflow.com/questions/30617525/repopulate-a-combobox-itemlist-without-affecting-what-is-currently-written-insid/30617788#30617788\" title=\"repopulate a combobox itemlist without affecting what is currently written insid\">stackoverflow.com/questions/30617525/&hellip;</a> which would solve this problem for me. It would be great if you know an answer to that as well."}, {"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "reply_to_user": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "edited": false, "score": 0, "creation_date": 1433329586, "post_id": 30614706, "comment_id": 49302654, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/79521/discussion-between-user3964075-and-user1283776\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "is_accepted": true, "score": 1, "last_activity_date": 1433320072, "creation_date": 1433320072, "answer_id": 30614706, "question_id": 30613031, "link": "https://stackoverflow.com/questions/30613031/sometimes-the-activex-combobox-only-shows-one-row-why/30614706#30614706", "title": "Sometimes the ActiveX Combobox only shows one row, why?", "body": "<p>To automatically populate combobox with data from named range, set it's <code>ListFillRange</code> property to the name of the range. </p>\n\n<p>You can do it at runtime:</p>\n\n<pre><code>ComboBox1.ListFillRange = \"BudgetDropdown\"\n</code></pre>\n\n<p>Or by setting it to <code>BudgetDropdown</code> in properties window.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8292123, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/97435e8c5afe5321e01afaa33c9951a6?s=128&d=identicon&r=PG", "display_name": "Evil Blue Monkey", "link": "https://stackoverflow.com/users/8292123/evil-blue-monkey"}, "is_accepted": false, "score": 0, "last_activity_date": 1499809816, "last_edit_date": 1499809816, "creation_date": 1499807602, "answer_id": 45044552, "question_id": 30613031, "link": "https://stackoverflow.com/questions/30613031/sometimes-the-activex-combobox-only-shows-one-row-why/45044552#45044552", "title": "Sometimes the ActiveX Combobox only shows one row, why?", "body": "<p>Don't know exactly why, but basically when you open a just-cleared-combobox it shows up only 1 lane because it \"thinks\" it is empty even if you have just refilled it. To trick it, you have to remove all the rows 1 by 1 till you reach your ListCount value (the number of rows your combobox will display). Then you can add all the new rows and after that you can delete the previously omitted rows. In my case i could not use the ListFillRange because my list was \"embended\" in several cells; so i had to extract it. Something like this:</p>\n\n<pre><code>Private Sub Combobox3_GotFocus()\n\nDim RngRange01 As Range 'Single cell where my row is \"embended\"\nDim IntCounter01 As Integer 'A counter\nDim BlnCheck as Boolean 'A boolean to remember me if it's the Combobox was empty before i\n'focused it\n\nIntCounter01 = ComboBox3.ListCount 'Set the counter equal to ListCount\n\n'I check if the combobox is already filled or not and modify the BlnCheck\nBlnCheck = True\nIf ComboBox3.ListCount = 0 Then BlnCheck = False\n\n'In this For-Next i remove all the rows till i reach the ListRows\nFor IntCounter01 = IntCounter01 To ComboBox3.ListRows + 1 Step -1\n    ComboBox3.RemoveItem IntCounter01 - 1\nNext IntCounter01\n\n'Set the range (it's a named list with titles located in another sheet)\nSet RngRange01 = Sheets(\"MySheet1\").Cells(2, Sheets(\"MySheet1\").Range(\"MyList\").Column)\n\n\nDo Until RngRange01.Value = \"\" 'Cover the whole list\n\n    'This If is to select the right data to insert (originally it was more complicated\n    'so i've cut it for this explanation)\n    If RngRange01.Offset(0, 1).Value &lt;&gt; RngRange01.Offset(-1, 1).Value Then\n        ComboBox3.AddItem RngRange01.Offset(0, 1).Value\n    End If\n\n    Set RngRange01 = RngRange01.Offset(1, 0) 'Next cell of the list\nLoop\n\n'Now we can remove the rows of the combobox we didn't remove previously (if the combobox \n'wasn't empty already)\nIf BlnCheck = True then\n    For IntCounter01 = ComboBox3.ListRows To 1 Step -1\n        ComboBox3.RemoveItem IntCounter01 - 1\n    Next IntCounter01\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>So far it will work only after the really first time you focus the combobox. Still annoying! To completely remove (trick) the bug you have to add some lanes to the combobox before you focus it; perhaps when you open the workbook like this:</p>\n\n<pre><code>Private Sub Workbook_Open()\n\nDim IntCounter01 As Integer 'A counter\n\nIntCounter01 = 1 'Set the counter\n\n'In this For-Next we add a lane till we reach the ListRows\nFor IntCounter01 = IntCounter01 To Sheets(\"MySheet2\").ComboBox3.ListRows\n    Sheets(\"MySheet2\").ComboBox3.AddItem \"\"\nNext IntCounter01\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3206, "favorite_count": 0, "accepted_answer_id": 30614706, "answer_count": 2, "score": 0, "last_activity_date": 1499809816, "creation_date": 1433314927, "last_edit_date": 1433422275, "question_id": 30613031, "link": "https://stackoverflow.com/questions/30613031/sometimes-the-activex-combobox-only-shows-one-row-why", "title": "Sometimes the ActiveX Combobox only shows one row, why?", "body": "<p>It seems that when I first click on the combobox and then click on the arrow, all items are displayed.</p>\n\n<p>While if I click on the arrow without clicking on the combobox before, only one item is displayed and I can click on scroll buttons to see the other items.</p>\n\n<p>Why does this happen?</p>\n\n<p>Here is the macro I am using to populate the combobox with items</p>\n\n<pre><code>Private Sub ComboBox1_GotFocus()\n    Dim c As Range\n    Dim selText As String\n    selText = ComboBox1.selText\n    ComboBox1.Clear\n    For Each c In wConfig.Range(\"BudgetDropdown\").Cells\n        ComboBox1.AddItem c.Value\n    Next c\n    ComboBox1.selText = selText\nEnd Sub\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/Pfz0tm.png\" alt=\"enter image description here\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/uztV7m.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["vba", "connection", "ms-word", "mailmerge"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1433309108, "post_id": 30611380, "comment_id": 49289743, "body": "you code looks okay, are getting error?"}, {"owner": {"reputation": 89, "user_id": 4813666, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/feca56754c39a37b23ba282a09b54790?s=128&d=identicon&r=PG&f=1", "display_name": "Jean", "link": "https://stackoverflow.com/users/4813666/jean"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1433309370, "post_id": 30611380, "comment_id": 49289853, "body": "yes, after few loops (one time after 15 loops, another time 166 loops) i get error <code>The microsoft Access database engine cannot open or write to the file &quot;. It is already exclusively by another user, or you need permission to view and write its data.</code>"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1433309708, "post_id": 30611380, "comment_id": 49289999, "body": "is the file on a shared network?"}, {"owner": {"reputation": 89, "user_id": 4813666, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/feca56754c39a37b23ba282a09b54790?s=128&d=identicon&r=PG&f=1", "display_name": "Jean", "link": "https://stackoverflow.com/users/4813666/jean"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1433310299, "post_id": 30611380, "comment_id": 49290255, "body": "No I have this folder with the files on my desktop. Do you know this problem? Is it problem with the macro?"}, {"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1433311703, "post_id": 30611380, "comment_id": 49290892, "body": "is it possible that anyone except you is using your database while you run the macro? does anyone has access to it?"}, {"owner": {"reputation": 89, "user_id": 4813666, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/feca56754c39a37b23ba282a09b54790?s=128&d=identicon&r=PG&f=1", "display_name": "Jean", "link": "https://stackoverflow.com/users/4813666/jean"}, "edited": false, "score": 0, "creation_date": 1433312354, "post_id": 30611380, "comment_id": 49291245, "body": "I dont have database in Microsoft Access. My data source is the excel file and nobody have access to this data. But if I change in <code>Data Link Properties</code> provider to <code>OLE DB Provider for Microsoft Directory Services</code> so it runs. So i mean that if I change the connection setting in macro it should will run."}], "owner": {"reputation": 89, "user_id": 4813666, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/feca56754c39a37b23ba282a09b54790?s=128&d=identicon&r=PG&f=1", "display_name": "Jean", "link": "https://stackoverflow.com/users/4813666/jean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 423, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1433330096, "creation_date": 1433308689, "last_edit_date": 1433330096, "question_id": 30611380, "link": "https://stackoverflow.com/questions/30611380/mailmerge-connection-settings-vba", "title": "Mailmerge - connection settings vba", "body": "<p>I have some problem with my mailmerge macro in this part:</p>\n\n<pre><code>wdocSource.Mailmerge.OpenDataSource _\n    Name:=strWorkbookName, _\n    AddToRecentFiles:=False, _\n    Revert:=False, _\n    Format:=wdOpenFormatAuto, _\n    Connection:=\"Data Source=\" &amp; strWorkbookName &amp; \";Mode=Read\", _\n    SQLStatement:=\"SELECT * FROM `Mailing$`\"\n</code></pre>\n\n<p>Can somebody help me change the <code>connection</code> settings? I am try many ways but always dont run correctly.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1433294672, "post_id": 30609264, "comment_id": 49285904, "body": "Why vba? This is easily done with a formula. Show what code you have and explain where you are stuck."}, {"owner": {"reputation": 361, "user_id": 4914731, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-GQlW2FaTZcQ/AAAAAAAAAAI/AAAAAAAAAC4/di5KCJ4DOS4/photo.jpg?sz=128", "display_name": "Abdul Shiyas", "link": "https://stackoverflow.com/users/4914731/abdul-shiyas"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1433296043, "post_id": 30609264, "comment_id": 49286232, "body": "Actually, I am dealing with 10 similar files. Most of the work are done in Excel-VBA till now."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1433297856, "post_id": 30609264, "comment_id": 49286710, "body": "Again, show the code you have so far. Show where you are stuck. Edit your post and add the code."}, {"owner": {"reputation": 361, "user_id": 4914731, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-GQlW2FaTZcQ/AAAAAAAAAAI/AAAAAAAAAC4/di5KCJ4DOS4/photo.jpg?sz=128", "display_name": "Abdul Shiyas", "link": "https://stackoverflow.com/users/4914731/abdul-shiyas"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1433298196, "post_id": 30609264, "comment_id": 49286771, "body": "I am editing the existing spreadsheets. I want to add a new column with the condition similar to  if category starts with &#39;A&#39; then RESULT=&quot;PASS&quot; if category starts with &#39;B&#39; then RESULT=&quot;FAIL&quot;."}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1433299304, "post_id": 30609264, "comment_id": 49287062, "body": "What if it doesn&#39;t start with either?"}], "answers": [{"comments": [{"owner": {"reputation": 361, "user_id": 4914731, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-GQlW2FaTZcQ/AAAAAAAAAAI/AAAAAAAAAC4/di5KCJ4DOS4/photo.jpg?sz=128", "display_name": "Abdul Shiyas", "link": "https://stackoverflow.com/users/4914731/abdul-shiyas"}, "edited": false, "score": 0, "creation_date": 1433297518, "post_id": 30609561, "comment_id": 49286619, "body": "Thank you very much. But when I tried, it didn&#39;t work. Also, how to add the column name for the new column we created?"}, {"owner": {"reputation": 467, "user_id": 4942702, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d1c7d7bae3dd32bcb1b43ff53f6d2339?s=128&d=identicon&r=PG&f=1", "display_name": "Nishank", "link": "https://stackoverflow.com/users/4942702/nishank"}, "reply_to_user": {"reputation": 361, "user_id": 4914731, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-GQlW2FaTZcQ/AAAAAAAAAAI/AAAAAAAAAC4/di5KCJ4DOS4/photo.jpg?sz=128", "display_name": "Abdul Shiyas", "link": "https://stackoverflow.com/users/4914731/abdul-shiyas"}, "edited": false, "score": 1, "creation_date": 1433297970, "post_id": 30609561, "comment_id": 49286729, "body": "firs activate worksheet and then try the code, i wrote it here , just check if there are any bugs in the code. The format is correct i didnt wrote in vba. To give the value just write this Range(your destination cell).value = &quot;your title name&quot;"}, {"owner": {"reputation": 467, "user_id": 4942702, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d1c7d7bae3dd32bcb1b43ff53f6d2339?s=128&d=identicon&r=PG&f=1", "display_name": "Nishank", "link": "https://stackoverflow.com/users/4942702/nishank"}, "reply_to_user": {"reputation": 361, "user_id": 4914731, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-GQlW2FaTZcQ/AAAAAAAAAAI/AAAAAAAAAC4/di5KCJ4DOS4/photo.jpg?sz=128", "display_name": "Abdul Shiyas", "link": "https://stackoverflow.com/users/4914731/abdul-shiyas"}, "edited": false, "score": 1, "creation_date": 1433298191, "post_id": 30609561, "comment_id": 49286769, "body": "if you are creating a new column, use .End(xlToRight) and write in the last column"}, {"owner": {"reputation": 361, "user_id": 4914731, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-GQlW2FaTZcQ/AAAAAAAAAAI/AAAAAAAAAC4/di5KCJ4DOS4/photo.jpg?sz=128", "display_name": "Abdul Shiyas", "link": "https://stackoverflow.com/users/4914731/abdul-shiyas"}, "edited": false, "score": 0, "creation_date": 1433298542, "post_id": 30609561, "comment_id": 49286872, "body": "Yes. I am creating a new column. The problem with naming that column using &quot;Range(your destination cell).value = &quot;your title name&quot; &quot; is I don&#39;t know my destination cell&#39;s address in prior. Because some files have 10 columns, others have 13,14 etc columns. I want to insert a column in the end and Give it a specified name."}, {"owner": {"reputation": 467, "user_id": 4942702, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d1c7d7bae3dd32bcb1b43ff53f6d2339?s=128&d=identicon&r=PG&f=1", "display_name": "Nishank", "link": "https://stackoverflow.com/users/4942702/nishank"}, "reply_to_user": {"reputation": 361, "user_id": 4914731, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-GQlW2FaTZcQ/AAAAAAAAAAI/AAAAAAAAAC4/di5KCJ4DOS4/photo.jpg?sz=128", "display_name": "Abdul Shiyas", "link": "https://stackoverflow.com/users/4914731/abdul-shiyas"}, "edited": false, "score": 0, "creation_date": 1433298632, "post_id": 30609561, "comment_id": 49286895, "body": "Hey select the top cell of header part and use xltoright and find the empty column and then give a value to it"}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 2, "creation_date": 1433298840, "post_id": 30609561, "comment_id": 49286949, "body": "Don&#39;t use XLDown or XLRight, it will give false results when it encounters blanks, always come from the bottom up or from the right to the left eg: Range(&quot;A&quot; &amp; Rows.count).end(xlup).row will give you the REAL last row, Range(&quot;A1&quot;).end(xldown).row gives you the first blank"}], "tags": [], "owner": {"reputation": 467, "user_id": 4942702, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d1c7d7bae3dd32bcb1b43ff53f6d2339?s=128&d=identicon&r=PG&f=1", "display_name": "Nishank", "link": "https://stackoverflow.com/users/4942702/nishank"}, "is_accepted": false, "score": 2, "last_activity_date": 1433315119, "last_edit_date": 1433315119, "creation_date": 1433296540, "answer_id": 30609561, "question_id": 30609264, "link": "https://stackoverflow.com/questions/30609264/inserting-a-column-in-the-end-in-excel-vba/30609561#30609561", "title": "Inserting a column in the end in excel vba", "body": "<p>you need to use for loop to read the code like this </p>\n\n<pre><code>Sub main()\n\n\nDim i, n As Integer\nRange(\"A1\").Select\n\nWorksheets(\"Sheet1\").Activate\n\n    n = ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nRange(\"A2\").Select\n\nFor i = 2 To n\n\nCurrentcell = Cells(i, 1).Value\n\nIf Left(Currentcell, 1) = \"a\" Then\n\nCells(i, 4).Value = \"true\"\n\n\nElseIf Left(Currentcell, 1) = \"b\" Then\n\nCells(i, 4).Value = \"false\"\n\n\n\nElse\n\nEnd If\n\nNext i\nEnd Sub\n</code></pre>\n\n<p>First take the value of the cell where you want to start and store it in a string, then check whether it is starting with a or b. Then store the value you required in the required cell and continue this till you find the empty cell. Because of that reason i took an integer which counts the range using exceldown.</p>\n\n<p>Iam sorry there was some bug, you can now try like this it will work.</p>\n"}, {"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 1, "last_activity_date": 1433305893, "last_edit_date": 1433305893, "creation_date": 1433298620, "answer_id": 30609837, "question_id": 30609264, "link": "https://stackoverflow.com/questions/30609264/inserting-a-column-in-the-end-in-excel-vba/30609837#30609837", "title": "Inserting a column in the end in excel vba", "body": "<p>I would go without the loop and take advantage of Excel's inbuilt IF formula:</p>\n\n<pre><code>Sub StartsWithA()\n    Cells(1, Columns.Count).End(xlToLeft).Offset(1, 1).Resize(Range(\"A\" &amp; Rows.Count).End(xlUp).Row - 1, 1) = \"=IF(UPPER(LEFT(A2,1))=\"\"A\"\",\"\"pass\"\",\"\"fail\"\")\"\n    Cells(1, Columns.Count).End(xlToLeft).Offset(0, 1).Formula = \"Result\"\n    activesheet.calculate 'In case your calcs are set to manual\n    Cells(1, Columns.Count).End(xlToLeft).Offset(0, 0).Resize(Range(\"A\" &amp; Rows.Count).End(xlUp).Row, 1).Copy\n    Cells(1, Columns.Count).End(xlToLeft).Offset(0, 0).Resize(Range(\"A\" &amp; Rows.Count).End(xlUp).Row, 1).PasteSpecial xlPasteValues\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 2, "creation_date": 1433304143, "post_id": 30609871, "comment_id": 49288191, "body": "Whilst this is well structured code (except the for next indent) here are the reasons I think it is not the correct answer: (1) Try and run this on a dataset with more than 255 rows, Dimming as a Byte restricts this, they should be Longs. (2) This uses a loop when one is not needed (Take a look at my answer for how to avoid this), Loops take time. (3) Too many variable when they are not needed ie MyWorksheetLastRow is used once so why put it in a variable? (4) No need to complicate things with InStr when Left will suffice. Why not just use If Left(MyWorksheet.Cells(MyRowPointer, 1),1)=&quot;A&quot; then"}, {"owner": {"reputation": 671, "user_id": 2527301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beff722d35f0a85f1150880ba432fd0?s=128&d=identicon&r=PG", "display_name": "Aleksey F.", "link": "https://stackoverflow.com/users/2527301/aleksey-f"}, "edited": false, "score": 2, "creation_date": 1433304585, "post_id": 30609871, "comment_id": 49288294, "body": "Assigning values in a cell-by-cell manner is slow. Creating an array of array of one variant and then assigning it to the value of the target range will speed up the process significantly. Instead of <code>MyWorksheet.Cells(1, Columns.Count).End(xlToLeft).Column</code>the <code>UsedRange</code> property of the <code>Worksheet</code> sould be used."}, {"owner": {"reputation": 2191, "user_id": 2591194, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/X4Fbs.jpg?s=128&g=1", "display_name": "Moritz Schmitz v. H&#252;lst", "link": "https://stackoverflow.com/users/2591194/moritz-schmitz-v-h%c3%bclst"}, "edited": false, "score": 0, "creation_date": 1433319051, "post_id": 30609871, "comment_id": 49295307, "body": "Do not <code>Dim</code> last rows as Byte. There is absolutely no reason to do that and as Dan Danoghue mentioned might lead to errors."}], "tags": [], "owner": {"reputation": 514, "user_id": 4967653, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jLy0eO8CT3E/AAAAAAAAAAI/AAAAAAAAAeQ/r1of1sWAlcw/photo.jpg?sz=128", "display_name": "keong kenshih", "link": "https://stackoverflow.com/users/4967653/keong-kenshih"}, "is_accepted": true, "score": 1, "last_activity_date": 1433320519, "last_edit_date": 1433320519, "creation_date": 1433298862, "answer_id": 30609871, "question_id": 30609264, "link": "https://stackoverflow.com/questions/30609264/inserting-a-column-in-the-end-in-excel-vba/30609871#30609871", "title": "Inserting a column in the end in excel vba", "body": "<p>I am not sure the \"files\" you mentioned were workbooks or worksheets?\nAnyway,I try with the following code and it worked fine. Hope it help in solving your problem.</p>\n\n<pre><code>Option Explicit\nDim MyWorkbook As Workbook\nDim MyWorksheet As Worksheet\n\nSub AddLastColumn()\nSet MyWorkbook = Workbooks(ActiveWorkbook.Name)\nSet MyWorksheet = MyWorkbook.Sheets(\"WorksheetName\")\n\nDim MyWorksheetLastRow As Long\nDim MyWorksheetLastColumn As Long\nDim MyRowPointer As Long\n\nMyWorksheetLastColumn = MyWorksheet.Cells(1, Columns.Count).End(xlToLeft).Column\nMyWorksheet.Cells(1, MyWorksheetLastColumn + 1).Value = \"Result\"\n\nMyWorksheetLastRow = MyWorksheet.Cells(Rows.Count, \"A\").End(xlUp).Row\n\nFor MyRowPointer = 2 To MyWorksheetLastRow\n\nIf InStr(1, MyWorksheet.Cells(MyRowPointer, 1), \"A\") = 1 Then\n    MyWorksheet.Cells(MyRowPointer, MyWorksheetLastColumn + 1).Value = \"PASS\"\nElse\n    MyWorksheet.Cells(MyRowPointer, MyWorksheetLastColumn + 1).Value = \"FAIL\"\nEnd If\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 361, "user_id": 4914731, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-GQlW2FaTZcQ/AAAAAAAAAAI/AAAAAAAAAC4/di5KCJ4DOS4/photo.jpg?sz=128", "display_name": "Abdul Shiyas", "link": "https://stackoverflow.com/users/4914731/abdul-shiyas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6418, "favorite_count": 0, "accepted_answer_id": 30609871, "answer_count": 3, "score": 1, "last_activity_date": 1433320519, "creation_date": 1433294408, "last_edit_date": 1531164843, "question_id": 30609264, "link": "https://stackoverflow.com/questions/30609264/inserting-a-column-in-the-end-in-excel-vba", "title": "Inserting a column in the end in excel vba", "body": "<p>My dataset looks like this </p>\n\n<p><img src=\"https://i.stack.imgur.com/60ji9.jpg\" alt=\"enter image description here\"></p>\n\n<p>Category    dummy1  dummy2</p>\n\n<p>Aan<br>\nAbd<br>\nBad<br>\nBoy<br>\nAbcd        </p>\n\n<p>I want to insert a column names \"RESULT\" in the end, with conditions\nif category starts with a then RESULT=\"PASS\"\nif category starts with b then RESULT=\"FAIL\"</p>\n\n<p>ie, my final output should be like this</p>\n\n<p><img src=\"https://i.stack.imgur.com/DdvS6.jpg\" alt=\"enter image description here\"></p>\n\n<p>How can I do this in excel-vba. Please help me. </p>\n\n<p>I am editing the existing spreadsheets.</p>\n\n<pre><code>Dim rngTemp As Range\nSet rngTemp = Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious)\n\nFor Each cel In Range(Cells(1, 1), rngTemp)\nIf cel.Value = \"I currently live in\" Then\ncel.Value = \"Current_Domicile\"\nElseIf cel.Value = \"I am interested in purchasing\" Then\ncel.Value = \"Type_of_Property\"\nElseIf cel.Value = \"I am interested in purchasing\" Then\ncel.Value = \"Wait_Time\"\nElseIf cel.Value = \"The reason that I am not buying a house right away is because I am:\" Then\ncel.Value = \"Reason_for_Wait\"\nEnd If\nNext Cel\n</code></pre>\n\n<p>I want to add a new column with the conditions above.</p>\n"}, {"tags": ["sql", "ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1433295441, "post_id": 30608724, "comment_id": 49286085, "body": "Check whether the field contains an empty string: <code>WHERE Len(workername) = 0</code>"}], "answers": [{"comments": [{"owner": {"reputation": 233, "user_id": 4413332, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/a476c5d8fddd24df8a25460d83efd04d?s=128&d=identicon&r=PG&f=1", "display_name": "Lilly", "link": "https://stackoverflow.com/users/4413332/lilly"}, "edited": false, "score": 0, "creation_date": 1433292137, "post_id": 30608888, "comment_id": 49285256, "body": "For some odd reason an <code>Expr1:IsNull([workername])</code> but workername is literally in the drop down as an option and the code worked for the 900+ other records so it&#39;s very odd."}, {"owner": {"reputation": 340, "user_id": 3455239, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5hzc.jpg?s=128&g=1", "display_name": "Prime03", "link": "https://stackoverflow.com/users/3455239/prime03"}, "reply_to_user": {"reputation": 233, "user_id": 4413332, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/a476c5d8fddd24df8a25460d83efd04d?s=128&d=identicon&r=PG&f=1", "display_name": "Lilly", "link": "https://stackoverflow.com/users/4413332/lilly"}, "edited": false, "score": 0, "creation_date": 1433292746, "post_id": 30608888, "comment_id": 49285409, "body": "Don&#39;t you just love Access :)"}], "tags": [], "owner": {"reputation": 340, "user_id": 3455239, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5hzc.jpg?s=128&g=1", "display_name": "Prime03", "link": "https://stackoverflow.com/users/3455239/prime03"}, "is_accepted": false, "score": 0, "last_activity_date": 1433291690, "creation_date": 1433291690, "answer_id": 30608888, "question_id": 30608724, "link": "https://stackoverflow.com/questions/30608724/sql-null-statement-not-working-ms-access/30608888#30608888", "title": "SQL Null statement not working MS Access", "body": "<p>That query looks valid, so I would question whether the column is actually null.</p>\n\n<p>You could try the following to find out for sure</p>\n\n<pre><code>SELECT \n    IntakeID, \n    caseid, \n    [Program], \n    [language] ,\n    ISNULL(workername)\nFROM Intake \n  ORDER BY ISNULL(workername) ASC\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 233, "user_id": 4413332, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/a476c5d8fddd24df8a25460d83efd04d?s=128&d=identicon&r=PG&f=1", "display_name": "Lilly", "link": "https://stackoverflow.com/users/4413332/lilly"}, "edited": false, "score": 0, "creation_date": 1433302018, "post_id": 30610139, "comment_id": 49287713, "body": "EVERYONE should literally up vote this!!! I have looked EVERYWHERE for this issue and this was the only one that worked!"}], "tags": [], "owner": {"reputation": 6993, "user_id": 2706726, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/WRwat.jpg?s=128&g=1", "display_name": "Sachu", "link": "https://stackoverflow.com/users/2706726/sachu"}, "is_accepted": true, "score": 2, "last_activity_date": 1433300677, "creation_date": 1433300677, "answer_id": 30610139, "question_id": 30608724, "link": "https://stackoverflow.com/questions/30608724/sql-null-statement-not-working-ms-access/30610139#30610139", "title": "SQL Null statement not working MS Access", "body": "<p>Try this code..Here first it will replace null value to <code>''</code> using <code>Nz</code> and if not null it will trim the value to make sure there is no space and check  is it equal to <code>''</code> means empty..hope it will help</p>\n\n<pre><code>\"SELECT IntakeID, \ncaseid, \n[Program], \n[language] \nFROM\nIntake WHERE  LTRIM(RTRIM(Nz(workername, ''))) = ''\"\n</code></pre>\n"}], "owner": {"reputation": 233, "user_id": 4413332, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/a476c5d8fddd24df8a25460d83efd04d?s=128&d=identicon&r=PG&f=1", "display_name": "Lilly", "link": "https://stackoverflow.com/users/4413332/lilly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 728, "favorite_count": 0, "accepted_answer_id": 30610139, "answer_count": 2, "score": 1, "last_activity_date": 1594656268, "creation_date": 1433290532, "last_edit_date": 1594656268, "question_id": 30608724, "link": "https://stackoverflow.com/questions/30608724/sql-null-statement-not-working-ms-access", "title": "SQL Null statement not working MS Access", "body": "<p>So I'm not really sure what is going on here but in my database I have a table that has 1000 records and 36 of them have [workername] empty. I was trying to run this SQL to select the unassigned, empty [workername] records to assign but nothing populates when I put the code in query design and view mode. I genuinely have no idea why this is not working.</p>\n\n<pre><code>strSQL = \"SELECT IntakeID, \n                 caseid, \n                 [Program], \n                 [language] \n          FROM Intake \n          WHERE workername Is Null\"\n     Set rs = db.OpenRecordset(strSQL, dbOpenDynaset)\n</code></pre>\n"}, {"tags": ["sql", "excel", "ado", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1433291998, "post_id": 30608692, "comment_id": 49285221, "body": "Comment out your <code>On Error Goto...</code> - what error message do you get when you run your code?  Would also help to update your question to show your full code."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 4821539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff8fad5eddfabda4caab67a04909475f?s=128&d=identicon&r=PG&f=1", "display_name": "CraigM", "link": "https://stackoverflow.com/users/4821539/craigm"}, "edited": false, "score": 0, "creation_date": 1433350396, "post_id": 30626152, "comment_id": 49318211, "body": "THANKS for everyone&#39;s help.  I was really confused, it cost me a few hours of sleep.  Your input led me to create a bunch of vba code to test my hypostasis\u2019s and to an appropriate solution.               Thanks again to all of you!  Craigm"}], "tags": [], "owner": {"reputation": 55, "user_id": 4821539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff8fad5eddfabda4caab67a04909475f?s=128&d=identicon&r=PG&f=1", "display_name": "CraigM", "link": "https://stackoverflow.com/users/4821539/craigm"}, "is_accepted": true, "score": 1, "last_activity_date": 1500221069, "last_edit_date": 1500221069, "creation_date": 1433350305, "answer_id": 30626152, "question_id": 30608692, "link": "https://stackoverflow.com/questions/30608692/excel-adob-sql-recordsets-order-by-works-on-one-xlsx-file-but-not-on-others/30626152#30626152", "title": "Excel ADOB SQL Recordsets, ORDER BY works on one xlsx file but not on others?", "body": "<p>I got it, but I don't know why, perhaps NULL cells crash the <code>ORDER BY</code> clause?</p>\n\n<p>I added a <code>WHERE</code> clause that removed the rows that the column <code>code &lt;&gt; NULL</code> I could then use the <code>ORDER BY</code> code clause without difficulty.</p>\n\n<pre><code>mySQL = \"SELECT * FROM [\" &amp; SourceSheet$ &amp; \"$\" &amp; SourceRange$ &amp; \"]\n         WHERE code &lt;&gt; NULL\n         ORDER BY code;\n</code></pre>\n\n<p>That solved the issue.  I do not understand why <code>ORDER</code> is not working in my case with EMPTY values.  I simply expected them to be at the top of the sort order.</p>\n\n<p>The <code>WHERE</code> clause is blindingly fast as compared to the VBA equivalent.</p>\n\n<p>Anyway, By using the <code>WHERE</code> clause the SQL works most excellency!  The little grey cells are now at peace.</p>\n\n<p>Craigm</p>\n"}], "owner": {"reputation": 55, "user_id": 4821539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff8fad5eddfabda4caab67a04909475f?s=128&d=identicon&r=PG&f=1", "display_name": "CraigM", "link": "https://stackoverflow.com/users/4821539/craigm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1224, "favorite_count": 1, "accepted_answer_id": 30626152, "answer_count": 1, "score": 1, "last_activity_date": 1500221179, "creation_date": 1433290318, "last_edit_date": 1531161705, "question_id": 30608692, "link": "https://stackoverflow.com/questions/30608692/excel-adob-sql-recordsets-order-by-works-on-one-xlsx-file-but-not-on-others", "title": "Excel ADOB SQL Recordsets, ORDER BY works on one xlsx file but not on others?", "body": "<p>Why does ORDER BY work on some xlsx files and not on others?</p>\n\n<p>I build SQL statements (using ADOB) to move data from closed workbooks (I need the speed and would like to use SQL to sort the data) into my active workbook.  Below are the two strings I use and both work perfectly for their associated files.</p>\n\n<pre><code>   mySQL = \"SELECT * FROM [\" &amp; SourceSheet$ &amp; \"$\" &amp; SourceRange$ &amp; \"] ORDER BY \" &amp; TargetSortColumn &amp; \";\"   'This works for my data dictionary.\n\n   mySQL = \"SELECT * FROM [\" &amp; SourceSheet$ &amp; \"$\" &amp; SourceRange$ &amp; \"];\"                                     'This works for the Cost File.\n</code></pre>\n\n<p>I cannot find any fundamental differences between the two files.  I am simply trying to copy a worksheet from each closed workbook into my current workbook and sort it with ORDER BY.  </p>\n\n<p>I always jump to my error trap, when using ORDER BY on my cost file.  When I hit the second statement below It triggers the error trap.</p>\n\n<pre><code>Set Con = CreateObject(\"ADODB.Connection\")\nSet Data = CreateObject(\"ADODB.Recordset\")\n</code></pre>\n\n<p>I have used the debugger to check and the parameters passed into this procedure are correct for each file.  I pass in all strings and use the strings to build the SQL statements so there is no mismatch there.</p>\n\n<p>I have opened both files and resaved them to ensure their is no basic problem with the files.  I am using Excel 2010.</p>\n\n<p>The worksheets in both files have their correct names passed into the subroutine correctly.</p>\n\n<p>Both worksheets have data starting at cell(1,1).</p>\n\n<p>Remember the two SQL statements work correctly for their respective files.</p>\n\n<p>Why can I NOT use ORDER BY on some files?  </p>\n\n<p>I have agitated the little grey cells most vigorously on this problem, any guidance would be greatly appreciated.</p>\n"}, {"tags": ["vba", "excel", "save"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1433291557, "post_id": 30608572, "comment_id": 49285105, "body": "change <code>xlBook.Close False</code> to <code>xlBook.Close</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4210717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a056f471663a5677fb654780fa43f98?s=128&d=identicon&r=PG&f=1", "display_name": "Duffleberry", "link": "https://stackoverflow.com/users/4210717/duffleberry"}, "edited": false, "score": 0, "creation_date": 1433316939, "post_id": 30608799, "comment_id": 49294041, "body": "Because it&#39;s not &#39;actual movement&#39; of that macro I&#39;m interested in, but being able to 1) open excel  2) run macro 3) save process what I was interested in. The actual macro I need to use for this process is rather big. If I can do it with a small macro, I should be able to do this process with a small macro. I will give this macro a shot :)"}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 2, "last_activity_date": 1433290947, "creation_date": 1433290947, "answer_id": 30608799, "question_id": 30608572, "link": "https://stackoverflow.com/questions/30608572/open-an-excel-file-run-a-macro-save-it-overwrite/30608799#30608799", "title": "Open an Excel file, run a macro, save it (overwrite)", "body": "<p>Out of curiosity why a macro in Excel? If you are controlling Excel via the object, why not have the macro code in there also?</p>\n\n<pre><code>Dim xlApp, xlBook\n\nSet xlApp = CreateObject(\"Excel.Application\")\nxlApp.DisplayAlerts = False\n\nSet xlBook = xlApp.Workbooks.Open(\"C:\\test\\test.xlsm\", 0, True) \n\nxlbook.Sheets(\"Sheet2\").Range(\"A1:A10\").Cut\nxlbook.Sheets(\"Sheet2\").Previous.Select\nxlbook.Range(\"A2\").Paste\nxlbook.Save\nxlBook.Close False\nset xlBook = Nothing\n\nxlApp.Quit\nSet xlApp = Nothing\n\nWScript.Echo \"Upload is Finished\"\nWScript.Quit\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1433293020, "post_id": 30608863, "comment_id": 49285491, "body": "OP is saving right before closing, I do this also as I have run into problems when saving on close before. I can&#39;t remember the specifics but it was throwing up another question I found that saving it before allowed me to pass in the params it required to suppress the question."}, {"owner": {"reputation": 1, "user_id": 4210717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a056f471663a5677fb654780fa43f98?s=128&d=identicon&r=PG&f=1", "display_name": "Duffleberry", "link": "https://stackoverflow.com/users/4210717/duffleberry"}, "edited": false, "score": 0, "creation_date": 1433317131, "post_id": 30608863, "comment_id": 49294147, "body": "The xlBook.Close SaveChanges:=True returns an error when I run the script.   I get an &#39;expected statement&#39; error if I replace xlbook.close with xlbook.close SaveChanges:=True :("}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 2, "last_activity_date": 1433291478, "creation_date": 1433291478, "answer_id": 30608863, "question_id": 30608572, "link": "https://stackoverflow.com/questions/30608572/open-an-excel-file-run-a-macro-save-it-overwrite/30608863#30608863", "title": "Open an Excel file, run a macro, save it (overwrite)", "body": "<pre><code>xlBook.Close False \n</code></pre>\n\n<p>means \"close and don't save changes\".  Maybe you want</p>\n\n<pre><code>xlBook.Close SaveChanges:=True\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4210717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a056f471663a5677fb654780fa43f98?s=128&d=identicon&r=PG&f=1", "display_name": "Duffleberry", "link": "https://stackoverflow.com/users/4210717/duffleberry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2699, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1433301519, "creation_date": 1433289565, "last_edit_date": 1433290741, "question_id": 30608572, "link": "https://stackoverflow.com/questions/30608572/open-an-excel-file-run-a-macro-save-it-overwrite", "title": "Open an Excel file, run a macro, save it (overwrite)", "body": "<p>I'm currently trying to create a .vbs which </p>\n\n<ol>\n<li>opens Excel</li>\n<li>runs macro</li>\n<li>saves it with new information</li>\n<li>quits</li>\n</ol>\n\n<p>This is what I have so far:</p>\n\n<pre><code>Dim xlApp, xlBook\n\nSet xlApp = CreateObject(\"Excel.Application\")\nxlApp.DisplayAlerts = False\n\nSet xlBook = xlApp.Workbooks.Open(\"C:\\test\\test.xlsm\", 0, True) \n\nxlApp.Run \"test\"\nxlbook.Save\nxlBook.Close False\nset xlBook = Nothing\n\nxlApp.Quit\nSet xlApp = Nothing\n\nWScript.Echo \"Upload is Finished\"\nWScript.Quit\n</code></pre>\n\n<p>I get the 'Upload is finished', but the macro is not saved. What am I doing wrong?</p>\n\n<p>The macro is simply putting something from one worksheet to another:</p>\n\n<pre><code>Sub test()\n'\n' test Macro\n'\n    Sheets(\"Sheet2\").Select\n    Range(\"A1:A10\").Select\n    Range(\"A10\").Activate\n    Selection.Cut\n    ActiveSheet.Previous.Select\n    Selection.End(xlToLeft).Select\n    Range(\"A2\").Select\n    ActiveSheet.Paste\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1433289047, "post_id": 30608332, "comment_id": 49284408, "body": "i am not getting any errors but try adding <code>Option Explicit</code> on top of your code and <code>Dim x As Integer</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1433289178, "post_id": 30608332, "comment_id": 49284447, "body": "You seem to have two worksheets you&#39;re working with, but you don&#39;t qualify any of your calls to <code>Range()</code> or <code>Cells()</code>, so it&#39;s difficult to tell what&#39;s expected from the code...  Without any qualifying worksheet reference (e.g. <code>Ath.Range(...)</code> or <code>Ath.Cells(...)</code>) you&#39;re referring to whatever happens to be the Active sheet, which makes for unreliable code."}, {"owner": {"reputation": 187, "user_id": 4495174, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f4d37f89eb7a16cfd1a2c364919f5985?s=128&d=identicon&r=PG&f=1", "display_name": "dom176", "link": "https://stackoverflow.com/users/4495174/dom176"}, "edited": false, "score": 0, "creation_date": 1433343540, "post_id": 30608332, "comment_id": 49313455, "body": "Yes I&#39;ve been rewriting that part numerous times so I didn&#39;t add the sheet reference just attempting to get it to work. Originally there is one in there, and will be one in there at the end"}, {"owner": {"reputation": 187, "user_id": 4495174, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f4d37f89eb7a16cfd1a2c364919f5985?s=128&d=identicon&r=PG&f=1", "display_name": "dom176", "link": "https://stackoverflow.com/users/4495174/dom176"}, "edited": false, "score": 0, "creation_date": 1433344280, "post_id": 30608332, "comment_id": 49314046, "body": "Edited with specific ranges"}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 2, "creation_date": 1433804087, "post_id": 30608332, "comment_id": 49498169, "body": "Run it and let it crash, hit debug and bring up the immediate window (ctrl-G) paste this and press enter: debug.print ath.Range(&quot;D2: D&quot; &amp; lastath).address then paste this and press enter debug.print ath.Range(ath.Cells(2, x), ath.Cells(lastath, x)).address then post the results here for me. If it spits an error tell me which line spits the error, probably the last one"}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 2, "creation_date": 1433804449, "post_id": 30608332, "comment_id": 49498262, "body": "Also, a little bit of sample data would make it a LOT easier to fix this for you."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1433830413, "post_id": 30608332, "comment_id": 49505619, "body": "At the moment when the error occures, check what value is in variable <code>lastath</code>, what value is in <code>x</code> and what is the value you try to copy to the range <code>&quot;D2:D &amp; lastath&quot;</code> and you should find the reason of the error. Note: When <code>Range</code> or <code>Columns</code> is used without an object qualifier, then it is a shortcut for <code>ActiveSheet.Range&#47;Columns</code>."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1433851645, "post_id": 30608332, "comment_id": 49519188, "body": "@DanDonoghue : Data sample would be useless here, the fix is just <code>Range.Value = Range.Value</code>. See my answer below"}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "edited": false, "score": 0, "creation_date": 1434005252, "post_id": 30608332, "comment_id": 49597695, "body": "A complete statement of the problem (useful for people wanting to help) includes specification of the error you get."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1434029696, "post_id": 30608332, "comment_id": 49614629, "body": "@R3uK <code>Range(&quot;A1&quot;).Value = Range(&quot;B1&quot;).Value</code> is equivalent with <code>Range(&quot;A1&quot;) = Range(&quot;B1&quot;)</code> because <code>Value</code> is the default property of <code>Range</code>. IMO data sample would help."}], "answers": [{"comments": [{"owner": {"reputation": 187, "user_id": 4495174, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f4d37f89eb7a16cfd1a2c364919f5985?s=128&d=identicon&r=PG&f=1", "display_name": "dom176", "link": "https://stackoverflow.com/users/4495174/dom176"}, "edited": false, "score": 0, "creation_date": 1433343998, "post_id": 30608607, "comment_id": 49313826, "body": "Your code worked identical to mine, though much more efficient. I am still drawing an error in the same spot.. <code>Range(&quot;D2:D&quot; &amp; lastath) = Range(Cells(2, X), Cells(lastath, X))</code>"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1433799664, "post_id": 30608607, "comment_id": 49496585, "body": "Do you have errors in the cells you are trying to copy? (Like <code>#N&#47;A</code> or formulas that have returned errors?). If so, these need to be handled appropriately (either ignore the errors using <code>On Error Resume Next</code> and <code>On Error Return 0</code> wrappers or check each cell for <code>IsError</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 187, "user_id": 4495174, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f4d37f89eb7a16cfd1a2c364919f5985?s=128&d=identicon&r=PG&f=1", "display_name": "dom176", "link": "https://stackoverflow.com/users/4495174/dom176"}, "edited": false, "score": 0, "creation_date": 1434007374, "post_id": 30608607, "comment_id": 49598909, "body": "@dom176 - <code>Range</code> and <code>Cells</code> have no defined parent worksheet."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1434087332, "post_id": 30608607, "comment_id": 49640904, "body": "@Jeeped yes that is correct, but let me to be a little bit more precise: when <code>Range</code> or <code>Columns</code> is used without an object qualifier, then it is a shortcut for <code>ActiveSheet.Range&#47;Columns</code>. So range and cells alway have &#39;parent&#39; worksheet because thay can&#39;t exist as such &#39;in air&#39;. But when this properties are used without such &#39;parent&#39; qualifier, then they are considered to belong to the sheet which is active at that moment. Active sheet is the &#39;parent&#39; sheet in such case."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 2, "creation_date": 1434090544, "post_id": 30608607, "comment_id": 49642198, "body": "@dee - Yes, all that&#39;s true. EXCEPT good practise dictates that we never <i>infer</i> a parent but rather we explicitly define a parent to everything we use as references. While I may be guilty of overusing the <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow noreferrer\">With...End With statement</a> at times, it has not been used once in the above code snippet. See <a href=\"http://stackoverflow.com/questions/30786984/vba-sort-macro-not-working/30787885\">dog&#39;s breakfast</a> and all the trouble the user is having because it wasn&#39;t written properly to start and they are reluctant to correct it now beyond bandaids."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1434096007, "post_id": 30608607, "comment_id": 49644975, "body": "@Jeeped the dog had good breakfast :-). Yes that is right, With-End With is good clue how to use it and so one won&#39;t forget to include the expected &#39;parent&#39; and do not use the implicit one."}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 2, "last_activity_date": 1433290230, "last_edit_date": 1433290230, "creation_date": 1433289816, "answer_id": 30608607, "question_id": 30608332, "link": "https://stackoverflow.com/questions/30608332/copying-a-variable-based-range-of-cells-to-another-range/30608607#30608607", "title": "Copying a variable based range of cells to another Range", "body": "<p>Take out the space after the :</p>\n\n<p>I have also chopped your code down, Dimmed X and removed the selects for you:</p>\n\n<pre><code>Sub Mapping()\n\nDim Map As Worksheet, Ath As Worksheet, lastmap As Long, lastath As Long, X As Long, Clastath As Long\nSet Ath = Sheets(\"Athena Greek God\")\nSet Map = Sheets(\"Mapping\")\nlastmap = Map.Cells(Rows.Count, \"D\").End(xlUp).Row\nlastath = Ath.Cells(Rows.Count, \"A\").End(xlUp).Row\n\nColumns(\"A:D\").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\nRange(\"A1:D1\") = Array(\"EDITED\", \"EDITED 2\", \"EDITED 3\", \"EDITED 4\")\nColumns(\"A:D\").AutoFit\nWith Range(\"A1:D\" &amp; lastath).Interior\n    .Pattern = xlSolid\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorDark1\n    .TintAndShade = -0.149998474074526\n    .PatternTintAndShade = 0\nEnd With\n\nClastath = Ath.Cells(1, Columns.Count).End(xlToLeft).Column\n\nFor X = Clastath To 1 Step -1\n    If Cells(1, X) = \"The Principals Book\" Then\n        Range(\"D2:D\" &amp; lastath) = Range(Cells(2, X), Cells(lastath, X))\n    End If\nNext\nEnd Sub\n</code></pre>\n\n<p>Edit: Also dimmed Clastath as long</p>\n"}, {"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 4, "last_activity_date": 1434455216, "last_edit_date": 1434455216, "creation_date": 1433851526, "answer_id": 30731549, "question_id": 30608332, "link": "https://stackoverflow.com/questions/30608332/copying-a-variable-based-range-of-cells-to-another-range/30731549#30731549", "title": "Copying a variable based range of cells to another Range", "body": "<p>You should <strong>use <code>.Value</code> or <code>.Value2</code> to transfer data between to ranges</strong> like this :</p>\n\n<pre><code>Ath.Range(\"D2: D\" &amp; LastAth).Value2 = Ath.Range(Ath.Cells(2, x), Ath.Cells(LastAth, x)).Value2\n</code></pre>\n\n<p>The <strong>main difference between these two</strong> is : </p>\n\n<ol>\n<li><code>.Value2</code> gives you the underlying value of the cell (unformatted data)</li>\n<li><code>.Value</code> gives you the formatted value of the cell</li>\n</ol>\n\n<p>For more details, take a look at <a href=\"https://fastexcel.wordpress.com/2011/11/30/text-vs-value-vs-value2-slow-text-and-how-to-avoid-it/\" rel=\"nofollow\">Charles William's blog here.</a></p>\n\n<hr>\n\n<p><strong>As you seem to be working on two sheets</strong> (not on the \"mapping\" one in the code you gave, if I got that right. If not just change <code>Ath.</code> to <code>Map.</code> where it need to be), <strong>don't forget to use the references</strong> you created (I added them everywhere, even before <code>Rows.Count</code> and <code>Columns.Count</code> to avoid errors if you open an old document on a new Excel version)</p>\n\n<p>I got rid of the <code>Select</code>s and shorten code where I could, but I let the \"Mapping\" sheet as I guessed you'll use it later in your code.</p>\n\n<p>Also don't forget to free your abject variables like this, when you won't use it afterwards : </p>\n\n<pre><code>Set Ath = Nothing\nSet Map = Nothing\n</code></pre>\n\n<hr>\n\n<hr>\n\n<p>Here is <strong>your code corrected, cleaned and tested</strong> :</p>\n\n<pre><code>Sub Mapping()\n\nDim Map As Worksheet, _\n    Ath As Worksheet, _\n    LastAth As Long, _\n    LastMap As Long, _\n    CLastAth As Long, _\n    x As Integer\n\n\nSet Ath = Sheets(\"Athena Greek God\")\nSet Map = Sheets(\"Mapping\")\nLastMap = Map.Cells(Map.Rows.Count, \"D\").End(xlUp).Row\nLastAth = Ath.Cells(Ath.Rows.Count, \"A\").End(xlUp).Row\n\nAth.Columns(\"A:D\").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\nAth.Range(\"A1:D1\").Value = Array(\"EDITED\", \"EDITED 2\", \"EDITED 3\", \"EDITED 4\")\nAth.Columns(\"A:D\").AutoFit\n\nWith Ath.Range(\"A1:D\" &amp; LastAth).Interior\n    .Pattern = xlSolid\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorDark1\n    .TintAndShade = -0.149998474074526\n    .PatternTintAndShade = 0\nEnd With\n\n\nCLastAth = Ath.Cells(1, Ath.Columns.Count).End(xlToLeft).Column\n\nFor x = CLastAth To 1 Step -1\n    If Ath.Cells(1, x) &lt;&gt; \"The Principals Book\" Then\n    Else\n        Ath.Range(\"D2: D\" &amp; LastAth).Value = Ath.Range(Ath.Cells(2, x), Ath.Cells(LastAth, x)).Value\n    End If\nNext x\n\nSet Ath = Nothing\nSet Map = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": false, "score": 1, "last_activity_date": 1433854892, "last_edit_date": 1433854892, "creation_date": 1433852741, "answer_id": 30732003, "question_id": 30608332, "link": "https://stackoverflow.com/questions/30608332/copying-a-variable-based-range-of-cells-to-another-range/30732003#30732003", "title": "Copying a variable based range of cells to another Range", "body": "<p>Actually, it is not really evident what this code should achieve, tell you why:\nTwo worksheets are defined but only one of them is used, also It's not clear to which worksheet the code is to be applied. As it stand now, the code is applied to whatever worksheet is active.</p>\n\n<p>See the code below with adjustments and comments.\nThe code assumes the procedure should be apply to the Ath worksheet (change as needed)</p>\n\n<p>Although the changes are explained, do let me know of any questions you might have about.</p>\n\n<pre><code>Option Explicit\nOption Base 1\n\nSub Mapping()\nRem Worksheet \"Map\" is only used to obtain lastmap which is never used\nRem Therefore theese line are commented as they do not play any role in the procedure\n'Dim Map As Worksheet\n'Dim lastmap As Long\n'Set Map = Sheets(\"Mapping\")\n'lastmap = Map.Cells(Rows.Count, \"D\").End(xlUp).Row ' NOT USED?\n\nRem Set array with titles - easy to maintain, and use to command all further intructions avoiding hard codding\nDim aTitles As Variant\naTitles = [{\"EDITED\",\"EDITED 2\",\"EDITED 3\",\"EDITED 4\"}]\n\nDim Ath As Worksheet\nDim lastath As Long\nDim Clastath As Integer\nDim X As Integer\n\n    Set Ath = Sheets(\"Athena Greek God\")\n\n    Rem It's not clear to which worksheet the code is to be applied?\n    Rem Actually it is applied to whatever worksheet is active\n    Rem This code assumes the procedure should be apply to the Ath worksheet\n    With Ath '(change as needed)\n        lastath = .Cells(Rows.Count, 1).End(xlUp).Row\n        .Cells(1).Resize(, UBound(aTitles)).EntireColumn.Insert     'Using Titles array to insert required number of columns\n        With Range(.Cells(1, 1), .Cells(lastath, UBound(aTitles)))  'Working with the range to be updated\n            .Rows(1).Value = aTitles\n            .Columns.AutoFit\n            .Interior.Color = RGB(217, 217, 217)                    'Simplify method to set color\n\n            Clastath = .Cells(1, Columns.Count).End(xlToLeft).Column\n\n            Rem Use \"Step -1\" if you have more than one cell with value = \"The Principals Book\"\n            Rem and you whant to catch the last occurrence. Otherwise no need to use it.\n            Rem For X = Clastath To 1 Step -1 '(change if needed as per comment above)\n            For X = 1 To Clastath\n                If .Cells(1, X).Value = \"The Principals Book\" Then\n                    Rem Old line, left only to show changes (.Value and .Value2)\n                    Rem Ath.Range(\"D2: D\" &amp; lastath).Value = Ath.Range(Ath.Cells(2, X), Ath.Cells(lastath, X)).Value2\n                    Ath.Range(\"D2: D\" &amp; lastath).Value = Ath.Range(Ath.Cells(2, X), Ath.Cells(lastath, X)).Value2\n                    .Columns(4).Value = .Columns(1).Offset(0, X - 1).Value2\n                    Exit For    'Exit For...Next after achieving its goal\n\n    End If: Next: End With: End With\n\n    Ath.Activate 'Only used to show\\move to the worksheet updated\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "is_accepted": false, "score": 1, "last_activity_date": 1434022853, "last_edit_date": 1495540697, "creation_date": 1434006442, "answer_id": 30773903, "question_id": 30608332, "link": "https://stackoverflow.com/questions/30608332/copying-a-variable-based-range-of-cells-to-another-range/30773903#30773903", "title": "Copying a variable based range of cells to another Range", "body": "<p>Your code deserves several comments. To begin with, you have to solve your problem (see point 1).\nIn addition, several points can reduce the chances of error upon modification, and improve efficiency.</p>\n\n<ol>\n<li><p><strong>Use other methods for copying <code>Range</code>s</strong>.<br>\nYou have to specify what you want to copy (data, formulas, number formats, etc.) to decide which method to use.</p>\n\n<ul>\n<li><p>Copy only data.</p>\n\n<pre><code>Ath.Range(\"D2:D\" &amp; lastath).Value2 = Ath.Range(Ath.Cells(2, x), Ath.Cells(lastath, x)).Value2\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Ath.Range(Ath.Cells(2, x), Ath.Cells(lastath, x)).Copy\nAth.Range(\"D2:D\" &amp; lastath).PasteSpecial xlPasteValues\n</code></pre></li>\n<li><p>Copy (part or all of) number formats. See <a href=\"https://stackoverflow.com/questions/17359835/what-is-the-difference-between-text-value-and-value2\">this</a>.</p>\n\n<pre><code>Ath.Range(\"D2:D\" &amp; lastath).Value = Ath.Range(Ath.Cells(2, x), Ath.Cells(lastath, x)).Value\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Ath.Range(Ath.Cells(2, x), Ath.Cells(lastath, x)).Copy\nAth.Range(\"D2:D\" &amp; lastath).PasteSpecial xlPasteValuesAndNumberFormats\n</code></pre></li>\n<li><p>Copy formulas.</p>\n\n<pre><code>Ath.Range(Ath.Cells(2, x), Ath.Cells(lastath, x)).Copy\nAth.Range(\"D2:D\" &amp; lastath).PasteSpecial xlPasteFormulas  ' or xlPasteFormulasAndNumberFormats\n</code></pre></li>\n<li><p>Copy all.</p>\n\n<pre><code>Ath.Range(Ath.Cells(2, x), Ath.Cells(lastath, x)).Copy\nAth.Range(\"D2:D\" &amp; lastath).PasteSpecial xlPasteAll\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Ath.Range(Ath.Cells(2, x), Ath.Cells(lastath, x)).Copy Destination:=Ath.Range(\"D2:D\" &amp; lastath)\n</code></pre></li>\n</ul></li>\n<li><p><strong>Fully qualify your <code>Range</code>s</strong>.<br>\nThis issue shows up once and again (e.g., <a href=\"https://stackoverflow.com/a/20605401/2707864\">this</a>).<br>\n<em>What does this mean?</em> Do not use <code>Cells</code>, <code>Range</code>, <code>Rows</code> or <code>Columns</code> without specifying which <code>Worksheet</code> they belong to, unless you specifically want to do that (and even in that case, explicitly using <code>ActiveSheet</code> improves readability and reduces the chances of errors, similar to using <code>Option Explicit</code>).\nFor instance,</p>\n\n<pre><code>lastath = Ath.Cells(Rows.Count, \"A\").End(xlUp).Row\n</code></pre>\n\n<p>will take <code>Rows.Count</code> from the <code>ActiveSheet</code>, which might not be <code>Ath</code>. You likely do not want that.\nThe correct form is</p>\n\n<pre><code>lastath = Ath.Cells(Ath.Rows.Count, \"A\").End(xlUp).Row\n</code></pre>\n\n<p>Fix all other code.\n<em>Note</em>: in this case, code continues execution and the mistake may go unnoticed, as it produces a valid result. In other cases, code without fully qualified <code>Range</code>s will throw an error (e.g., with something like <code>sheet1.Range(Cells(...</code>, when <code>sheet1</code> is not the <code>ActiveSheet</code>).</p></li>\n<li><p><strong>Your code seems inefficient</strong>.<br>\nYou might be copying data many times into the same <code>Range</code>. It is better to find the leftmost cell in row 1, containing <code>\"The Principals Book\"</code>, and copy the range for that column into <code>Range(\"D2:D\" &amp; lastath)</code>. Use</p>\n\n<pre><code>Dim x As Long\nFor x = 1 To Clastath\n    If Ath.Cells(1, x) = \"The Principals Book\" Then\n        Ath.Range(\"D2:D\" &amp; lastath).Value2 = Ath.Range(Ath.Cells(2, x), Ath.Cells(lastath, x)).Value2   ' or alternatives above\n        Exit For\n    End If\nNext\n</code></pre></li>\n<li><p><strong>It is not clear in which <code>Worksheet</code> you want columns inserted</strong>.<br>\nIt seems to be <code>Ath</code>. The other <code>Worksheet</code> is not used.</p></li>\n<li><p><strong>You can insert many columns at once. You can also enter data into a range at once</strong>.</p>\n\n<pre><code>Ath.Columns(\"A:D\").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\nAth.Range(\"A1:D1\").Value = Array(\"EDITED\", \"EDITED 2\", \"EDITED 3\", \"EDITED 4\")\n</code></pre></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 5007129, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8sBhcMP-PBw/AAAAAAAAAAI/AAAAAAAAAGY/Bh4z9lKalpw/photo.jpg?sz=128", "display_name": "Rocky Patterson II", "link": "https://stackoverflow.com/users/5007129/rocky-patterson-ii"}, "is_accepted": false, "score": 1, "last_activity_date": 1434383722, "last_edit_date": 1434383722, "creation_date": 1434233631, "answer_id": 30824090, "question_id": 30608332, "link": "https://stackoverflow.com/questions/30608332/copying-a-variable-based-range-of-cells-to-another-range/30824090#30824090", "title": "Copying a variable based range of cells to another Range", "body": "<p>1.Remove the space in your string  address: \nBefore:</p>\n\n<pre><code>ath.Range(\"D2: D\" &amp; lastath))\n</code></pre>\n\n<p>After:</p>\n\n<pre><code>ath.Range(\"D2:D\" &amp; lastath))\n</code></pre>\n\n<p>2a. If you only want to copy the values, then use .value at the end of your range references:\nBefore:</p>\n\n<pre><code>ath.Range(\"D2:D\" &amp; lastath).value = ath.Range(ath.Cells(2, x), ath.Cells(lastath, x)) \n</code></pre>\n\n<p>After:</p>\n\n<pre><code>ath.Range(\"D2:D\" &amp; lastath).value = ath.Range(ath.Cells(2, x).value, ath.Cells(lastath, x).value).value\n</code></pre>\n\n<p>2b. If you want values and formats then use .copy (destination):\nBefore:</p>\n\n<pre><code>ath.Range(\"D2:D\" &amp; lastath).value = ath.Range(ath.Cells(2, x), ath.Cells(lastath, x)) \n</code></pre>\n\n<p>After:</p>\n\n<pre><code>ath.Range(\"D2:D\" &amp; lastath).copy(ath.Range(ath.Cells(2, x).value, ath.Cells(lastath, x).value))\n</code></pre>\n\n<p>Also, you should always reference the worksheet of a references range (e.g. <code>ws.range(\"A1\").value</code>). You might also consider using a worksheet's .codename rather then .name if this isn't just a quick an dirty project.</p>\n"}], "owner": {"reputation": 187, "user_id": 4495174, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f4d37f89eb7a16cfd1a2c364919f5985?s=128&d=identicon&r=PG&f=1", "display_name": "dom176", "link": "https://stackoverflow.com/users/4495174/dom176"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1184, "favorite_count": 0, "accepted_answer_id": 30731549, "answer_count": 5, "score": 1, "last_activity_date": 1434455216, "creation_date": 1433288068, "last_edit_date": 1433344134, "question_id": 30608332, "link": "https://stackoverflow.com/questions/30608332/copying-a-variable-based-range-of-cells-to-another-range", "title": "Copying a variable based range of cells to another Range", "body": "<p>Hello from my code it should be evident what I am trying to do at this point. I am attempting to copy a range of cells from a static portion of a worksheet to a created column but I keep running into an error on a certain part of the formula I'm hoping that someone here has either a solution to the error, or a better method of taking one range of cells that can be static and bringing to a hard a reference point</p>\n\n<pre><code>Sub Mapping()\n\nDim Map As Worksheet\nDim Ath As Worksheet\nDim lastmap As Long\nDim lastath As Long\nSet Ath = Sheets(\"Athena Greek God\")\nSet Map = Sheets(\"Mapping\")\nlastmap = Map.Cells(Rows.Count, \"D\").End(xlUp).Row\nlastath = Ath.Cells(Rows.Count, \"A\").End(xlUp).Row\n\n\n\nColumns(\"A:A\").Select\nSelection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\nSelection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\nSelection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\nSelection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n\nRange(\"A1\") = \"EDITED\"\nRange(\"B1\") = \"EDITED 2\"\nRange(\"C1\") = \"EDITED 3\"\nRange(\"D1\") = \"EDITED 4\"\nColumns(\"A:D\").AutoFit\nRange(\"A1:D\" &amp; lastath).Select\nWith Selection.Interior\n    .Pattern = xlSolid\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorDark1\n    .TintAndShade = -0.149998474074526\n    .PatternTintAndShade = 0\nEnd With\n\nClastath = Ath.Cells(1, Columns.Count).End(xlToLeft).Column\n\nFor x = Clastath To 1 Step -1\nIf ath.Cells(1, x) = \"The Principals Book\" Then\n    ath.Range(\"D2: D\" &amp; lastath) = ath.Range(ath.Cells(2, x), ath.Cells(lastath, x))\nEnd If\nNext\nEnd Sub\n</code></pre>\n\n<p>Error occurs here:</p>\n\n<pre><code>ath.Range(\"D2: D\" &amp; lastath) = ath.Range(ath.Cells(2, x), ath.Cells(lastath, x))\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 1, "creation_date": 1433320554, "post_id": 30608082, "comment_id": 49296259, "body": "how about simple goto last record?  DoCmd.GoToRecord acActiveDataObject, , acLast"}, {"owner": {"reputation": 139, "user_id": 4959141, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b05c815623bc26de18ee83d3dd35936c?s=128&d=identicon&r=PG&f=1", "display_name": "B.Cap", "link": "https://stackoverflow.com/users/4959141/b-cap"}, "reply_to_user": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1433371511, "post_id": 30608082, "comment_id": 49329716, "body": "Great, that&#39;s what I was missing - if you would like to post as an answer will gladly accept. This took me to the next to last record added so I inserted &#39;Forms!MainForm.Requery&#39;  before it and then it went to last record - thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 4959141, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b05c815623bc26de18ee83d3dd35936c?s=128&d=identicon&r=PG&f=1", "display_name": "B.Cap", "link": "https://stackoverflow.com/users/4959141/b-cap"}, "edited": false, "score": 0, "creation_date": 1433372028, "post_id": 30620434, "comment_id": 49329947, "body": "Thanks, as you noted the DoCmd.... did work but the form still needed a refresh as you went on to indicate. I tried the &#39;set me.recordset = me.recordset&#39; to refresh but did not work as I needed. Ended up using &quot;requery&quot; method as noted in comments above -- thanks for the help."}], "tags": [], "owner": {"reputation": 11, "user_id": 4901206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57c0a50efd2499a2677499661e651a4a?s=128&d=identicon&r=PG&f=1", "display_name": "ikervb", "link": "https://stackoverflow.com/users/4901206/ikervb"}, "is_accepted": false, "score": 0, "last_activity_date": 1433335312, "creation_date": 1433335312, "answer_id": 30620434, "question_id": 30608082, "link": "https://stackoverflow.com/questions/30608082/access-set-unbound-form-to-current-record/30620434#30620434", "title": "Access Set Unbound Form to Current Record", "body": "<p>it should work, because the <code>addnew</code> method does not require <code>movelast</code> action. you can try refreshing the form with <code>set me.recordset = me.recordset</code></p>\n"}, {"comments": [{"owner": {"reputation": 139, "user_id": 4959141, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b05c815623bc26de18ee83d3dd35936c?s=128&d=identicon&r=PG&f=1", "display_name": "B.Cap", "link": "https://stackoverflow.com/users/4959141/b-cap"}, "edited": false, "score": 1, "creation_date": 1433449910, "post_id": 30638054, "comment_id": 49370209, "body": "Thanks! see previous comment"}], "tags": [], "owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "is_accepted": true, "score": 0, "last_activity_date": 1433404446, "creation_date": 1433404446, "answer_id": 30638054, "question_id": 30608082, "link": "https://stackoverflow.com/questions/30608082/access-set-unbound-form-to-current-record/30638054#30638054", "title": "Access Set Unbound Form to Current Record", "body": "<p>as per your trial. simply perform a DoCmd.GoToRecord acActiveDataObject, , acLast after a me.requery to update the recordset. </p>\n"}], "owner": {"reputation": 139, "user_id": 4959141, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b05c815623bc26de18ee83d3dd35936c?s=128&d=identicon&r=PG&f=1", "display_name": "B.Cap", "link": "https://stackoverflow.com/users/4959141/b-cap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 670, "favorite_count": 0, "accepted_answer_id": 30638054, "answer_count": 2, "score": 0, "last_activity_date": 1433404446, "creation_date": 1433286382, "last_edit_date": 1433372503, "question_id": 30608082, "link": "https://stackoverflow.com/questions/30608082/access-set-unbound-form-to-current-record", "title": "Access Set Unbound Form to Current Record", "body": "<p>First post so hoping this makes some sense. I\u2019m adding data to tables from unbound text boxes using a command button and the .AddNew method. The form itself is still bound at this point. FYI, I\u2019m using unbound boxes as the UI needed for junction tbls was not an option. I\u2019m able to add the data to the tables without a problem. The issue is that after adding a record, the form\u2019s current record stays on the same record as before the addition but I want it to be on the new record. I\u2019m using \u201crst.Bookmark = rst.LastModified\u201d to set the cursor to the new record in the table and seems to work as I can return values for the new record ... but this does not affect the form. I\u2019ve tried working with \u201cRequery\u201d and \u201cCurrentRecord\u201d but neither resolves the issue. </p>\n\n<p>In summary, after adding a new record to a table I want the form\u2019s current record to reference this new record. For example, if I am on record 12 in the form and add a new record bringing the total records to 25 -- I want the form to be on record \"25 of 25\" not on \"12 of 25\". Can you tell me how to do this? Thanks for your help!</p>\n\n<pre><code>    With rst\n\n    .AddNew\n        !Event = Forms!MainForm!Event\n        !DonorName = Forms!MainForm!DonorName\n        !EnvNo = Forms!MainForm!EnvNo\n    .Update\n\n    .MoveLast\n    .MoveFirst\n\n  End With\n\nrst.Bookmark = rst.LastModified\n\n''' Record count total - show on form - confirmed/same as Access Navigation display\nForms!MainForm!txtTotalRec.Value = rst.RecordCount\n\n''' Current Record - show on form - confirmed/same as Access Navigation display\nlngCurrent = Forms!MainForm.CurrentRecord\nForms!MainForm!txtCurrRec.Value = lngCurrent\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 735, "user_id": 4619569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEDZ7.jpg?s=128&g=1", "display_name": "nicolaus-hee", "link": "https://stackoverflow.com/users/4619569/nicolaus-hee"}, "edited": false, "score": 0, "creation_date": 1433292885, "post_id": 30607251, "comment_id": 49285453, "body": "Welcome to SO. Please post your code (and possibly screenshots) so we can help you review it. You can add your code via the &quot;edit&quot; link next to your question. And please read: <a href=\"http://meta.stackoverflow.com/questions/260648/stack-overflow-question-checklist\">Stack Overflow question checklist</a>. Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 467, "user_id": 4942702, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d1c7d7bae3dd32bcb1b43ff53f6d2339?s=128&d=identicon&r=PG&f=1", "display_name": "Nishank", "link": "https://stackoverflow.com/users/4942702/nishank"}, "is_accepted": false, "score": 0, "last_activity_date": 1433296944, "creation_date": 1433296944, "answer_id": 30609614, "question_id": 30607251, "link": "https://stackoverflow.com/questions/30607251/how-to-add-item-to-a-combobox-on-button-click/30609614#30609614", "title": "how to add item to a combobox on button click?", "body": "<p>Be specific with your question and always post the relevant code, so that  it will become easy to solve it for others. </p>\n\n<p>If you want to see the data while executing the userform, just write the required data in userform_activate or Initialize. before executing it will take the values and shows up in the combobox.</p>\n\n<p>the input which you are taking from the worksheet just write those values in another worksheet so that whenever you open the workbook the values will not get erased.</p>\n"}, {"tags": [], "owner": {"reputation": 671, "user_id": 2527301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beff722d35f0a85f1150880ba432fd0?s=128&d=identicon&r=PG", "display_name": "Aleksey F.", "link": "https://stackoverflow.com/users/2527301/aleksey-f"}, "is_accepted": false, "score": 1, "last_activity_date": 1433302248, "last_edit_date": 1433302248, "creation_date": 1433301485, "answer_id": 30610243, "question_id": 30607251, "link": "https://stackoverflow.com/questions/30607251/how-to-add-item-to-a-combobox-on-button-click/30610243#30610243", "title": "how to add item to a combobox on button click?", "body": "<ol>\n<li>Create a workbook and save as xlsm.</li>\n<li>On the first worksheet define user name as follows:\nName: <code>dn_cmb_items</code>\nRange: <code>=\"\"</code></li>\n<li>Using the developer ribbon add an Excel (not ActiveX) combobox onto the Worksheet1 and set its list-by-range to <code>dn_cmb_items</code></li>\n<li>Open VBA editor and add a user form to the workbook, name it as <code>frm_add_cmb_item</code> and set <code>ShowModal</code> to <code>False</code>.</li>\n<li>Drop a text box to the form and name it <code>tb_item_text</code>.</li>\n<li>Drop a button to the form, name it <code>cmb_add</code> and from its context menu choose <code>View code</code>. This creates the <code>click</code> event handler.</li>\n<li>Implement the handler as follows:</li>\n</ol>\n\n<pre>\n    Private Sub cmb_add_Click()\n      Dim v_r As Range, v_n As Name\n      Set v_n = Names(\"dn_cmb_items\")\n      If v_n.Value = \"=\"\"\"\"\" Then\n        v_n.Value = \"=\" & Worksheets(1).Name & \"!$A$1:$A$1\"\n        v_n.RefersToRange.Value = tb_item_text.Text\n      Else\n        Set v_r = v_n.RefersToRange\n        Set v_r = v_r.Cells(v_r.Rows.Count + 1, 1)\n        v_r.Value = tb_item_text.Text\n        v_n.Value = \"=\" & Worksheets(1).Name & \"!$A$1:\" & v_r.Address(True, True)\n      End If\n    End Sub\n</pre>\n\n<ol start=\"8\">\n<li>Drop onto the workshet a button, then create/set a macros in the workbook. Implement the created macros with the code <code>frm_add_cmb_item.Show</code>.</li>\n<li>In the VBA Editor from the <code>Debug</code> menu choose <code>Compile</code>. Then save the VBAProject as well as the workbook. That's all for the coding.</li>\n<li>Switch to the worksheet, show the form.</li>\n<li>Now when you enter some to the textbox, then click the <code>cmb_add</code> button, a new item will be added to the <code>A</code> column at the end thus changing the value of <code>dn_cmb_items</code> assigned to the combobox on the worksheet.\nSee the screenshorts attached:</li>\n</ol>\n\n<p>Initial state:\n<img src=\"https://i.stack.imgur.com/hfQCa.png\" alt=\"Initial state\"></p>\n\n<p><code>1</code> added:\n<img src=\"https://i.stack.imgur.com/aZyeL.png\" alt=\"Add 1\"></p>\n\n<p><code>2</code> added:\n<img src=\"https://i.stack.imgur.com/Dme3R.png\" alt=\"Add 2\"></p>\n\n<p>PS\nI have the ready workbook with all the code. Where should I upload it?</p>\n"}], "owner": {"reputation": 11, "user_id": 3122928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/593nK.jpg?s=128&g=1", "display_name": "user3122928", "link": "https://stackoverflow.com/users/3122928/user3122928"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1146, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1434018457, "creation_date": 1433281891, "last_edit_date": 1531164843, "question_id": 30607251, "link": "https://stackoverflow.com/questions/30607251/how-to-add-item-to-a-combobox-on-button-click", "title": "how to add item to a combobox on button click?", "body": "<p>I want to add item to a combobox found in excel worksheet from text box which is located in the user form When button is clicked.i see the value added to combobox but it will become empty when I close and reopens  the workbook.can any one help me handling this?</p>\n\n<p>Thank u for you're fast response first</p>\n\n<p>thank you both for your feedback and correction.let me make more clear my concern</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1433284165, "post_id": 30607103, "comment_id": 49283080, "body": "Why wouldn&#39;t you retain the original value on the &#39;mirror&#39; and use the &#39;mirrored&#39; cell&#39;s comment to show the edit? Alternately, use the comment to retain the original. As it stands, your question could be answered by deleting the &#39;mirror&#39; worksheet on every edit and recopying the original."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4797139, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-aJlGBZHr4TI/AAAAAAAAAAI/AAAAAAAAAFs/DKMca__EI-4/photo.jpg?sz=128", "display_name": "Namaro", "link": "https://stackoverflow.com/users/4797139/namaro"}, "edited": false, "score": 0, "creation_date": 1433433608, "post_id": 30611359, "comment_id": 49360951, "body": "Thank you, now they can&#39;t add more rows or Columns to the sheet; great vba code it works really nice, not too great to identified where they made the changes(unless you open it twice) , but I found a workaround not too great as something automatic as a vba code, but if I take last report and current report and compared then in a 3 sheet with an =IF function then i&#39;m able to track where they changed, but not the user who changed in which is what I would like."}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 1, "last_activity_date": 1500221550, "last_edit_date": 1500221550, "creation_date": 1433308600, "answer_id": 30611359, "question_id": 30607103, "link": "https://stackoverflow.com/questions/30607103/linking-an-excel-sheet-to-another-in-the-same-workbook-using-vba/30611359#30611359", "title": "Linking an Excel Sheet to another in the same workbook using VBA", "body": "<p>Not sure if keeping a duplicate of the sheet is the easiest way: what if users insert new rows or columns (thousands) or cells within existing data, or charts, etc</p>\n\n<p>I'd suggest keeping a log of changes similar to this</p>\n\n<ul>\n<li>Given a WorkBook with 2 sheets (Sheet1 and Sheet2)</li>\n<li>Sheet1 contains the data</li>\n<li>Sheet2 will contain a log with 4 columns: Date, User Name, Cell, New Value</li>\n</ul>\n\n<p>then Sheet1 will contain this VBA code:</p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPrivate logLine As Long\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    If Target.CountLarge &lt; 1000 Then    ' don't log deletion of all cells on Sheet1\n\n        Dim editedCell As String\n\n        ' get the clean cell address (\"A1\" instead of \"$A$1\")\n        editedCell = Target.Address(RowAbsolute:=False, ColumnAbsolute:=False)\n\n        With Sheet2     ' generate all log lines on Sheet2\n\n            logLine = logLine + 1   ' move to the next row on Sheet2\n\n            ' Column 1: Date and Time\n            .Cells(logLine, 1).Value2 = Format(Now, \"ddd mmm dd, yyyy hh:mm:ss\")\n\n            ' Column 2: User Name\n            .Cells(logLine, 2).Value2 = Application.UserName\n\n            ' Column 3: link to the edited cell, also showing the cell itself\n            .Hyperlinks.Add _\n                Anchor:=.Cells(logLine, 3), _\n                Address:=vbNullString, _\n                SubAddress:=\"Sheet1!\" &amp; editedCell, _\n                TextToDisplay:=editedCell\n\n            ' Column 4: the new value\n            .Cells(logLine, 4).Value2 = Target.Value2\n        End With\n    End If\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>On Sheet2 you'll have the 4 columns:</p>\n\n<pre><code>        Date-Time          User Nane   Cell    New Value\nWed Jun 03, 2015 01:07:43   User1       A1      Test 1\nWed Jun 03, 2015 01:07:48   User2       B3      Test 3\nWed Jun 03, 2015 01:07:52   User5       D2      Test 7\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 4797139, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-aJlGBZHr4TI/AAAAAAAAAAI/AAAAAAAAAFs/DKMca__EI-4/photo.jpg?sz=128", "display_name": "Namaro", "link": "https://stackoverflow.com/users/4797139/namaro"}, "edited": false, "score": 0, "creation_date": 1433433610, "post_id": 30612935, "comment_id": 49360952, "body": "Thanks, great suggestion, but I was looking more into a vba standpoint, since I want it to be very automatic and less work for the admin who is going to manage this file, also it isn&#39;t really easy to track where they made the changes unless you open that file twice(in Read mode) and validate the data in it."}], "tags": [], "owner": {"reputation": 104, "user_id": 2132992, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/70286dcb42281043dd345a7b064bcf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Tango_Mike", "link": "https://stackoverflow.com/users/2132992/tango-mike"}, "is_accepted": false, "score": 0, "last_activity_date": 1433314631, "creation_date": 1433314631, "answer_id": 30612935, "question_id": 30607103, "link": "https://stackoverflow.com/questions/30607103/linking-an-excel-sheet-to-another-in-the-same-workbook-using-vba/30612935#30612935", "title": "Linking an Excel Sheet to another in the same workbook using VBA", "body": "<p>Why do you need to have a VBA code in the first place? You could simply use the already built-in feature of tracking changes in Excel (Review - Changes - Track Changes). Once users make their changes, save and close the workbook; you could just go to the \"Highlight Changes\" line within the \"Track Changes\" feature and select \"List changes on a new sheet\". This will create a new sheet and will show all the necessary info (action number, date, time, who, change, sheet, range, new value, old value, etc). </p>\n"}], "owner": {"reputation": 1, "user_id": 4797139, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-aJlGBZHr4TI/AAAAAAAAAAI/AAAAAAAAAFs/DKMca__EI-4/photo.jpg?sz=128", "display_name": "Namaro", "link": "https://stackoverflow.com/users/4797139/namaro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1500221550, "creation_date": 1433281248, "question_id": 30607103, "link": "https://stackoverflow.com/questions/30607103/linking-an-excel-sheet-to-another-in-the-same-workbook-using-vba", "title": "Linking an Excel Sheet to another in the same workbook using VBA", "body": "<p>I'm trying to keep track of what is been done in my workbook, so I would like to have a copy of the sheet with comments added to it with date of change and user that changed it(don't really care what they change but I want to know what cells they change with dates and username), yes I know you can use copy and paste it as link, but the VBA script that I have right now doesn't recognize the changes made in the original sheet Code Below:</p>\n\n<pre><code>    Private Sub Worksheet_Change(ByVal Target As Excel.range)\n'If Target.Column &lt;&gt; 1 Then Exit Sub\nDim ccc As range\nDim comment As String\nApplication.ScreenUpdating = False\nApplication.Calculation = xlManual\n\ncomment = (\"Cell Last Edited: \") &amp; Now &amp; (\" by \") &amp; Application.UserName\nTarget.ClearComments\n    For Each ccc In Target\n    range(ccc.Address).AddComment comment\n    Next ccc\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlAutomatic\nEnd Sub\n</code></pre>\n\n<p>In which works really nice, Now to be clear I want script that copies the original sheet to another one and if someone make change then copy or  modified the copy sheet and add the comment with date and username   </p>\n\n<p>Any suggestion would be great and thanks in advance :D</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1433282378, "last_edit_date": 1433282378, "creation_date": 1433281371, "answer_id": 30607129, "question_id": 30606821, "link": "https://stackoverflow.com/questions/30606821/lookup-value-in-same-column-on-multiple-worksheets/30607129#30607129", "title": "Lookup Value in Same Column on Multiple Worksheets", "body": "<p>Store the desired worksheet names in an array and loop through them.</p>\n\n<pre><code>Sub CopyRowsFlyer()\n    Dim bottomB As Long, b As Long, x As Long\n    Dim w As Long, vWSs As Variant\n    vWSs = Array(\"Bakery\", \"Floral\", \"Grocery\")\n\n    x = 1\n    For w = LBound(vWSs) To UBound(vWSs)\n        With Worksheets(vWSs(w))\n            bottomB = .Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n            For b = 3 To bottomB\n                If LCase(.Cells(b, \"B\").Value) = \"flyer\" Then\n                    .Rows(b).EntireRow.Copy Worksheets(\"sheet1\").Range(\"A\" &amp; x)\n                    x = x + 1\n                End If\n            Next b\n        End With\n    Next w\n\nEnd Sub\n</code></pre>\n\n<p>While this method of looping through the cells in each worksheet's column B is considered inefficient compared to other methods like the <a href=\"https://msdn.microsoft.com/en-us/library/office/aa195730(v=office.11).aspx\" rel=\"nofollow\">.Range.Find method</a>, it will not make a lot of difference on smaller sets of data. If you have a large number of rows on each worksheet to examine, you may wish to explore other more direct avenues of retrieving the information.</p>\n"}, {"tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": false, "score": 1, "last_activity_date": 1433281477, "last_edit_date": 1433281477, "creation_date": 1433281420, "answer_id": 30607141, "question_id": 30606821, "link": "https://stackoverflow.com/questions/30606821/lookup-value-in-same-column-on-multiple-worksheets/30607141#30607141", "title": "Lookup Value in Same Column on Multiple Worksheets", "body": "<p>You just want to loop through the three sheets you want.  Try this:</p>\n\n<pre><code> Sub CopyRowsFlyer()\n 'This looks in the Bakery tab and moves everything that has \"Flyer\" in     column B to Sheet 1\n   Dim bottomB As Integer\n   Dim x As Integer\n   Dim SheetsArray() As Variant\n   Dim ws As WorkSheet\n   Dim i As Integer       \n\n   SheetsArray = Array(\"Bakery\", \"Sheet2Name\", \"Sheet3Name\")\n   For i = LBound(SheetsArray) To UBound(SheetsArray)\n        Set ws = Sheets(SheetsArray(i))\n        bottomB = ws.Range(\"B\" &amp; Rows.Count).End(xlUp).Row: x = 1\n\n        Dim c As Range\n        For Each c In ws.Range(\"B3:B\" &amp; bottomB)\n              If c.Value = \"Flyer\" Then\n                    c.EntireRow.Copy Worksheets(\"sheet1\").Range(\"A\" &amp; x)\n                    x = x + 1\n              End If\n        Next c\n   Next i\n End Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 219, "user_id": 4080394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RHAaZ.jpg?s=128&g=1", "display_name": "daytonrazorback", "link": "https://stackoverflow.com/users/4080394/daytonrazorback"}, "is_accepted": false, "score": 1, "last_activity_date": 1433281902, "creation_date": 1433281902, "answer_id": 30607253, "question_id": 30606821, "link": "https://stackoverflow.com/questions/30606821/lookup-value-in-same-column-on-multiple-worksheets/30607253#30607253", "title": "Lookup Value in Same Column on Multiple Worksheets", "body": "<p>You can substitute an element of a string array for the ID in Sheets.</p>\n\n<p>Here is your code modified to reflect.</p>\n\n<pre><code>Sub CopyRowsFlyer()\n  Dim bottomB As Integer\n  Dim x As Integer\n  Dim sheetName(1 to 3) As String, i as Integer\n  sheetName(1) = \"Bakery\"\n  sheetName(2) = \"Floral\"\n  sheetName(3) = \"Grocery\"\n  x=1\n  For i = 1 to 3\n    bottomB = Sheets(sheetName(i)).Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n\n    Dim c As Range\n    For Each c In Sheets(sheetName(i)).Range(\"B3:B\" &amp; bottomB)\n        If c.Value = \"Flyer\" Then\n            c.EntireRow.Copy Worksheets(\"sheet1\").Range(\"A\" &amp; x)\n            x = x + 1\n        End If\n    Next c\n  Next i\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 442, "user_id": 2497009, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yaHZR.png?s=128&g=1", "display_name": "usncahill", "link": "https://stackoverflow.com/users/2497009/usncahill"}, "edited": false, "score": 0, "creation_date": 1433282747, "post_id": 30607328, "comment_id": 49282586, "body": "Fixed to skip the first two rows."}, {"owner": {"reputation": 45, "user_id": 4842613, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SSydno9E0O0/AAAAAAAAAAI/AAAAAAAABbY/xDgin8ojpAI/photo.jpg?sz=128", "display_name": "Matt Peharda", "link": "https://stackoverflow.com/users/4842613/matt-peharda"}, "edited": false, "score": 0, "creation_date": 1433340296, "post_id": 30607328, "comment_id": 49310861, "body": "Thanks! This is the only one that worked as planned. The others worked, but as it moved from worksheet to worksheet, it would write over the previously found rows in Sheet 1. For example, if there were 7 rows found in the bakery tab with &quot;Flyer&quot; in column B (and those rows were copied to Sheet 1), and 3 rows found/copied in the Floral tab, then Sheet one would only contain 7 rows total. The first 3 rows were the rows from Floral and the bottom 4 were from Bakery."}, {"owner": {"reputation": 442, "user_id": 2497009, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yaHZR.png?s=128&g=1", "display_name": "usncahill", "link": "https://stackoverflow.com/users/2497009/usncahill"}, "reply_to_user": {"reputation": 45, "user_id": 4842613, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SSydno9E0O0/AAAAAAAAAAI/AAAAAAAABbY/xDgin8ojpAI/photo.jpg?sz=128", "display_name": "Matt Peharda", "link": "https://stackoverflow.com/users/4842613/matt-peharda"}, "edited": false, "score": 0, "creation_date": 1433371838, "post_id": 30607328, "comment_id": 49329869, "body": "Your welcome! The key to keeping the row placement is your idea!; the <code>x = x + 1</code>. I just built some stuff around it :)"}, {"owner": {"reputation": 45, "user_id": 4842613, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SSydno9E0O0/AAAAAAAAAAI/AAAAAAAABbY/xDgin8ojpAI/photo.jpg?sz=128", "display_name": "Matt Peharda", "link": "https://stackoverflow.com/users/4842613/matt-peharda"}, "edited": false, "score": 0, "creation_date": 1441205677, "post_id": 30607328, "comment_id": 52585890, "body": "This code had been working great, but when someone rolled the workbook over to a new month, the error message box &quot;Run-time error 9: Subscript out of range&quot; keeps coming up. I&#39;ve made sure everything is named appropriately (tab, spelling of promotions, etc), but can not figure out a solution to this error."}], "tags": [], "owner": {"reputation": 442, "user_id": 2497009, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yaHZR.png?s=128&g=1", "display_name": "usncahill", "link": "https://stackoverflow.com/users/2497009/usncahill"}, "is_accepted": true, "score": 1, "last_activity_date": 1433282728, "last_edit_date": 1433282728, "creation_date": 1433282264, "answer_id": 30607328, "question_id": 30606821, "link": "https://stackoverflow.com/questions/30606821/lookup-value-in-same-column-on-multiple-worksheets/30607328#30607328", "title": "Lookup Value in Same Column on Multiple Worksheets", "body": "<p>Similar to other solutions posted. Pretty simple. Replaces bounding for range checking. Fewest variables. No mid-execution dimensioning.</p>\n\n<pre><code>Sub CopyRowsFlyer()\n  Dim strSh As Variant, c As Range, x As Integer\n  x = 1\n\n  For Each strSh In Array(\"Bakery\", \"Floral\", \"Grocery\")\n    For Each c In Worksheets(strSh).Range(\"B:B\")\n      If c = \"\" and c.Row &gt; 2 Then\n        Exit For\n      ElseIf c = \"Flyer\" and c.Row &gt; 2 Then\n        c.EntireRow.Copy Worksheets(\"Sheet1\").Range(\"A\" &amp; x)\n        x = x + 1\n      End If\n    Next\n  Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 4842613, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SSydno9E0O0/AAAAAAAAAAI/AAAAAAAABbY/xDgin8ojpAI/photo.jpg?sz=128", "display_name": "Matt Peharda", "link": "https://stackoverflow.com/users/4842613/matt-peharda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 644, "favorite_count": 0, "accepted_answer_id": 30607328, "answer_count": 4, "score": 2, "last_activity_date": 1433282728, "creation_date": 1433280042, "last_edit_date": 1433280307, "question_id": 30606821, "link": "https://stackoverflow.com/questions/30606821/lookup-value-in-same-column-on-multiple-worksheets", "title": "Lookup Value in Same Column on Multiple Worksheets", "body": "<p>In column B on three (Bakery, Floral, Grocery) of the five sheets in my workbook, I want to find rows that have the word <code>Flyer</code> in column B. There will be multiple rows in each worksheet that have the word <code>Flyer</code> in column B. When it finds the word <code>Flyer</code>, it will paste the entire row into Sheet1.</p>\n\n<p>I go this to work on one tab, but want the same code to search all three tabs (but NOT all five ... this is the issue) and paste all of the rows with the word <code>Flyer</code> in column B into Sheet1.</p>\n\n<p>My code (works, but only on the Bakery tab):</p>\n\n<pre><code>Sub CopyRowsFlyer()\n'This looks in the Bakery tab and moves everything that has \"Flyer\" in     column B to Sheet 1\n  Dim bottomB As Integer\n  Dim x As Integer\n  bottomB = Sheets(\"Bakery\").Range(\"B\" &amp; Rows.Count).End(xlUp).Row: x = 1\n\n  Dim c As Range\n  For Each c In Sheets(\"Bakery\").Range(\"B3:B\" &amp; bottomB)\n    If c.Value = \"Flyer\" Then\n        c.EntireRow.Copy Worksheets(\"sheet1\").Range(\"A\" &amp; x)\n        x = x + 1\n    End If\n  Next c\nEnd Sub\n</code></pre>\n"}]