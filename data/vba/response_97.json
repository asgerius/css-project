[{"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1479342896, "post_id": 40644483, "comment_id": 68521538, "body": "For a little extra info, when you <i>don&#39;t</i> qualify a range (<code>Range()</code>,<code>Cells()</code>,<code>Rows()</code>,<code>Columns()</code>, etc.) with the spreadsheet, VBA will assume you want that run on whatever the <code>ActiveSheet</code> is.  OP, you&#39;re getting an error, because the <code>Sheets(&quot;Search&quot;)</code> is the active sheet, but you&#39;re using <code>Sheets(&quot;Database&quot;)</code> to &#39;introduce&#39; the range, and that conflicts."}], "tags": [], "owner": {"reputation": 2094, "user_id": 5508728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P3gtR.jpg?s=128&g=1", "display_name": "jeff carey", "link": "https://stackoverflow.com/users/5508728/jeff-carey"}, "is_accepted": true, "score": 3, "last_activity_date": 1479340665, "creation_date": 1479340665, "answer_id": 40644483, "question_id": 40644339, "link": "https://stackoverflow.com/questions/40644339/copy-values-from-a-sheet-to-another-sheet-with-if-statement-in-vba/40644483#40644483", "title": "Copy values from a sheet to another sheet with IF Statement in VBA", "body": "<p>The problem is with this line:</p>\n\n<pre><code>Sheets(\"Database\").Range(Cells(i, 1), Cells(i, 9)).Copy\n</code></pre>\n\n<p>When you run it from the Search spreadsheet, it interprets \"Cells\" to mean Cells from \"Search\". Use this instead:</p>\n\n<pre><code>    With Sheets(\"Database\")\n        .Range(.Cells(i, 1), .Cells(i, 9)).Copy\n    End With\n</code></pre>\n"}], "owner": {"reputation": 731, "user_id": 7170188, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/710cf6e1876c352c31e53fe5a4986993?s=128&d=identicon&r=PG&f=1", "display_name": "franciscofcosta", "link": "https://stackoverflow.com/users/7170188/franciscofcosta"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1879, "favorite_count": 0, "closed_date": 1479347995, "accepted_answer_id": 40644483, "answer_count": 1, "score": 0, "last_activity_date": 1479340665, "creation_date": 1479339889, "question_id": 40644339, "link": "https://stackoverflow.com/questions/40644339/copy-values-from-a-sheet-to-another-sheet-with-if-statement-in-vba", "closed_reason": "Duplicate", "title": "Copy values from a sheet to another sheet with IF Statement in VBA", "body": "<p>I am using Excel 2010 to write a VBA script where I want to copy values from one sheet (\"Database\") to another sheet (\"Search\") given that a certain criteria, fulfilled by an IF Statement, is verified.</p>\n\n<p>I've created a module where I've written the following code:</p>\n\n<pre><code>  Sub searchdatabase()\n\n'1. declare variables\n'2. clear old search results\n'3. Find records that match criteria and paste them\n\nDim country As String\nDim category As String\nDim subcategory As String\nDim finalrow As Integer\nDim i As Integer 'row counter\n\nSheets(\"Search\").Range(\"E11:P1000\").ClearContents 'E11:P1000 e o range de celulas que ele vai apagar antes de correr o script. Se quiser mudar ou adicionar headers, tenho de mudar este range tambem.\n\ncountry = Sheets(\"Search\").Range(\"E5\").Value\nfinalrow = Sheets(\"Database\").Range(\"A200000\").End(xlUp).Row\n\nFor i = 2 To finalrow\n    If Sheets(\"Database\").Cells(i, 1) = country Then\n        Sheets(\"Database\").Range(Cells(i, 1), Cells(i, 9)).Copy\n        Sheets(\"Search\").Range(\"E600\").End(xlUp).Offset(1, 0).PasteSpecial xlPasteFormulasAndNumberFormats\n\n        End If\n\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>In the IF Statement, I have referenced that I want to see if the variable 'Country' matches the Cells in the \"Database\" sheet and, if so, copy it to the \"Search\" sheet. But the code seems not to be working, returning error</p>\n\n<pre><code>Run-time error '1004':\nApplication-defined or object-defined error\n</code></pre>\n\n<p>In order to solve the issue I have tried to change the code and reference different sheets but the error seems to be related to this still.</p>\n\n<p>What am I doing wrong?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["vba", "excel", "excel-addins"], "answers": [{"tags": [], "owner": {"reputation": 275, "user_id": 5051940, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/xkuaO.jpg?s=128&g=1", "display_name": "Jim Fischer", "link": "https://stackoverflow.com/users/5051940/jim-fischer"}, "is_accepted": false, "score": 1, "last_activity_date": 1588652583, "last_edit_date": 1588652583, "creation_date": 1479339205, "answer_id": 40644227, "question_id": 40644107, "link": "https://stackoverflow.com/questions/40644107/excel-vba-function-name-resolution-add-in-vs-local-module/40644227#40644227", "title": "Excel VBA function name resolution, add-in vs local module", "body": "<p>Answer 2) Given the macro-enabled worksheet's file name is 'k.xlsm', function name resolution can be enforced within a worksheet cell by prefixing the function invocation '=Z()' with the file name (or full path to) of the macro-enabled workbook:</p>\n\n<pre><code>='k.xlsm'!Z()\n</code></pre>\n\n<p><hr>\n<strong>:: EDIT 1 ::</strong></p>\n\n<p>To call a macro <code>routine_name</code> that is defined within a macro-enabled Excel add-in file (e.g., <code>MyAddin.xlam</code>), ensure the add-in file is added and enabled (see note 1.1) and then <a href=\"https://stackoverflow.com/a/35248933/5051940\">see @RAK_da_Pira's answer</a> to the question <a href=\"https://stackoverflow.com/q/2814116/5051940\"><em>running a macro from an add-in</em></a> posted to Stack Overflow.  The important bit is this: within the calling workbook one must expressly enable the add-in module as an available reference; otherwise, the calling workbook cannot call the routines in the add-in module.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Call MyAddin!routine_name(args)\n</code></pre>\n\n<p>Note 1.1.&emsp;Excel: File > Options > Add-ins > Manage: Excel Add-ins > Go...</p>\n"}], "owner": {"reputation": 275, "user_id": 5051940, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/xkuaO.jpg?s=128&g=1", "display_name": "Jim Fischer", "link": "https://stackoverflow.com/users/5051940/jim-fischer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1588652583, "creation_date": 1479338566, "last_edit_date": 1567739627, "question_id": 40644107, "link": "https://stackoverflow.com/questions/40644107/excel-vba-function-name-resolution-add-in-vs-local-module", "title": "Excel VBA function name resolution, add-in vs local module", "body": "<p>Consider the following situation. I have an Excel add-in named 'X' with a module named 'Y' containing a function named 'Z'. The add-in 'X' is enabled within Excel via File > Options > Add-Ins ...</p>\n\n<p>I open a macro-enabled Excel workbook that contains its own module named 'A' that contains a function named 'Z'. (I'll call this the 'local' version of function 'Z'.)</p>\n\n<p>Question 1) If I invoke function 'Z' from a worksheet cell '=Z()', which function 'Z' does excel invoke by default? The add-in 'Z' or the local 'Z'? (If someone can point me to a document that does a good job of describing name scope and name resolution within Excel VBA, that'd be appreciated.)</p>\n\n<p>Question 2) Within a worksheet cell is there any syntax I can use to explicitly invoke one or the other function 'Z' (i.e., the \"local\" Z or the add-in \"Z\")?</p>\n\n<p>Question 3) Within the macro-enabled workbook, when a worksheet cell invokes function '=Z()' Excel invokes the add-in version of 'Z' by default. If I \"break the link\" to the add-in version of 'Z' (Excel RIBBON bar > DATA tab > CONNECTIONS gallery > EDIT LINKS button), Excel breaks all of the worksheet cells that invoke '=Z()' => '#NAME?'. Is there any way to have Excel break the link to the add-in 'Z' and instead invoke instead the local 'Z' without breaking all of the worksheet cells that invoke '=Z()'?</p>\n"}, {"tags": ["vba", "excel", "google-earth", "google-earth-plugin", "activexobject"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1479340898, "post_id": 40644083, "comment_id": 68520967, "body": "<code>CreateObject</code> is a late bound call, so you shouldn&#39;t expect to find it in your references.  Is the .dll registered?"}, {"owner": {"reputation": 370, "user_id": 4279200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/20501e5969d1e1d0fcaa74fef1fa1634?s=128&d=identicon&r=PG&f=1", "display_name": "ELW", "link": "https://stackoverflow.com/users/4279200/elw"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1479341967, "post_id": 40644083, "comment_id": 68521303, "body": "Thanks...  I am not sure how to check if the .dll is registered, or even what .dll it needs to work."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1479342371, "post_id": 40644083, "comment_id": 68521421, "body": "Open up regedit.exe and search for &quot;GoogleEarth.ApplicationGE&quot;. If it isn&#39;t there, that&#39;s the issue - I&#39;m not familiar with the library, so I&#39;m not sure what .dll you&#39;d need to register. You can do a registry search on a machine it works on to find it.  There should be a key somewhere for InprocServer32 that has the .dll path for the ActiveX server."}], "owner": {"reputation": 370, "user_id": 4279200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/20501e5969d1e1d0fcaa74fef1fa1634?s=128&d=identicon&r=PG&f=1", "display_name": "ELW", "link": "https://stackoverflow.com/users/4279200/elw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 640, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479338443, "creation_date": 1479338443, "question_id": 40644083, "link": "https://stackoverflow.com/questions/40644083/vba-error-429-with-google-earth-pro", "title": "VBA Error 429 with Google Earth Pro", "body": "<p>I have a macro to map data in Google Earth written by a coworker who can run it with no issue.  When I run it, it freezes on:</p>\n\n<pre><code>Set GEI = CreateObject(\"GoogleEarth.ApplicationGE\")\n</code></pre>\n\n<p>and throws up Run-time error '429': ActiveX component can't create object.  (None of the code above this would pertain to the problem, but I can post if needed.)</p>\n\n<p>We thought it must be a reference library issue from searching, but we both have the same reference libraries checked:<br>\n - Visual Basic For Applications<br>\n - Microsoft Excel 14.0 Object Library<br>\n - OLE Automation<br>\n - Microsoft Office 14.0 Object Library  </p>\n\n<p>I also tracked down and checked Earth 1.0 Type Library but the same error occurred.  </p>\n\n<p>From searching, I have not been able to figure out what file or where to get it.  Does anyone know what I can do to fix this?  Thanks.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1479335888, "post_id": 40643609, "comment_id": 68519302, "body": "If the path is in the file to open, how do you open it to see which folder to look into for the file?  vb.net, vba and excel-vba are not the same thing and have different answers so fix the tags"}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "reply_to_user": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1479336391, "post_id": 40643609, "comment_id": 68519514, "body": "Please ignore all answers except the last one from the offered duplicate post. <code>ThisWorkbook</code> is way more preferable than <code>ActiveWorkbook</code> which can be changed unexpectedly. Since the code provided by OP references and xls file I assume that OP is inquiring about VBA though I agree with @Plutonix that tags should be reviewed and edited."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1479337030, "post_id": 40643609, "comment_id": 68519752, "body": "@nbayly whether to use <code>ThisWorkbook</code> or <code>ActiveWorkbook</code> or some other means of obtaining a workbook reference entirely depends on the requirements.  Both are appropriate under certain circumstances."}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1479338504, "post_id": 40643609, "comment_id": 68520248, "body": "@chrisneilsen Yes, it is appropriate to use ActiveWorkbook when you want to reference the active workbook that has the focus. But when its to reference the same workbook that the code is hosted on ThisWorkbook is preferable. Even when working with other workbooks rather than use ActiveWorkbook I would favor using variables to point specifically to a Workbook. Can you detail an example where ActiveWorkbook is preferable?"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1479340377, "post_id": 40643609, "comment_id": 68520802, "body": "@nbayly <i>when should you use <code>ActiveWorkbook</code>?</i> when you want to reference the active book. <i>when should you use <code>ThisWorkbook</code>?</i> when you want to reference the book containing the code.  <i>when should you use some other method?</i> when neither of the above apply.  pretty obvious really..."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1479342556, "post_id": 40643609, "comment_id": 68521468, "body": "@nbayly - Even using <code>ThisWorkbook</code> can be problematic.  That&#39;s just the default code name for the object - you can name it <code>FooWorkbook</code> if you feel like it."}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1479398287, "post_id": 40643609, "comment_id": 68550158, "body": "@chrisneilsen Yes, pretty obvious your evident sarcasm aside. Except the one case where it&#39;s not clear... where you want to reference the active workbook that also contains the code. My only comment was in these cases where ThisWorkbook is preferable to ActiveWorkbook because the focus of the application can change while running in ways hard to predict while coding (ie. user interaction). Do you disagree? What other method do you suggest that isn&#39;t hardcoding the file when neither of these apply?"}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1479398490, "post_id": 40643609, "comment_id": 68550313, "body": "@Comintern Ok... can you show me how to set <code>FooWorkbook</code> to the relevant workbook without hardcoding the file or using some version of a default code name for the object?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1479398972, "post_id": 40643609, "comment_id": 68550662, "body": "@nbayly - Depends on what you have to work with.  In the context of the linked question, <code>sheet.Parent</code> where <code>sheet</code> is a Worksheet object. If you have a <code>Range</code>, it would be <code>rng.Parent.Parent</code>."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7170022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16c2f62723fd16f23b0ae6629120515a?s=128&d=identicon&r=PG&f=1", "display_name": "Learner", "link": "https://stackoverflow.com/users/7170022/learner"}, "edited": false, "score": 0, "creation_date": 1479347516, "post_id": 40643650, "comment_id": 68522802, "body": "Awesome :) U guys rock!"}], "tags": [], "owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "is_accepted": true, "score": 2, "last_activity_date": 1479336050, "creation_date": 1479336050, "answer_id": 40643650, "question_id": 40643609, "link": "https://stackoverflow.com/questions/40643609/remove-hard-coding-of-file-path-in-excel-while-calling-the-other-workbook/40643650#40643650", "title": "Remove Hard coding of &#39;file path&#39; in Excel while calling the other workbook", "body": "<p>You can extract the current file path using the method:</p>\n\n<pre><code>strFileDir = ThisWorkbook.Path\n</code></pre>\n\n<p>Regards,</p>\n"}], "owner": {"reputation": 13, "user_id": 7170022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16c2f62723fd16f23b0ae6629120515a?s=128&d=identicon&r=PG&f=1", "display_name": "Learner", "link": "https://stackoverflow.com/users/7170022/learner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1108, "favorite_count": 0, "closed_date": 1479336744, "accepted_answer_id": 40643650, "answer_count": 1, "score": 0, "last_activity_date": 1489096671, "creation_date": 1479335743, "last_edit_date": 1489096671, "question_id": 40643609, "link": "https://stackoverflow.com/questions/40643609/remove-hard-coding-of-file-path-in-excel-while-calling-the-other-workbook", "closed_reason": "Duplicate", "title": "Remove Hard coding of &#39;file path&#39; in Excel while calling the other workbook", "body": "<p>I'm new to the VB coding so please help me. </p>\n\n<p>I have an Excel where in the code the filename is hard coded with the file path. File name stays the same every time but the path does changes from time to time so, is there a way that we can say define the file path to look into the current directory that the calling workbook is in?</p>\n\n<p>If not at worst I think we have to give the path in one of the excel columns and refer it in the code. Current code as follows:</p>\n\n<p>Workbooks.Open Filename:= _\n        \"C:\\XXX\\YYY\\ZZZ\\Called_Workbook.xls\"</p>\n\n<p>Any help is highly appreciated.\nThanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 392, "user_id": 4888843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef82d1015fe3787231add5f346bcb5b?s=128&d=identicon&r=PG&f=1", "display_name": "Hrothgar", "link": "https://stackoverflow.com/users/4888843/hrothgar"}, "edited": false, "score": 0, "creation_date": 1479337244, "post_id": 40643525, "comment_id": 68519836, "body": "What do you mean by clunky text manipulation?  Does that include using functions such as search and replace?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1479341907, "post_id": 40643525, "comment_id": 68521288, "body": "Why do you need to access the arguments from another function?  I&#39;m guessing there&#39;s a cleaner way to do this - like caching them in <code>MyFunction</code>."}], "answers": [{"tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": true, "score": 2, "last_activity_date": 1479337688, "creation_date": 1479337688, "answer_id": 40643945, "question_id": 40643525, "link": "https://stackoverflow.com/questions/40643525/how-do-i-read-the-arguments-from-a-formula-in-vba/40643945#40643945", "title": "How do I read the arguments from a formula in VBA?", "body": "<p>If all of your arguments are Ranges, you can use the <code>Precedents</code> property to get at the arguments.</p>\n\n<p>If that's not the case, I'm afraid text manipulation is what you've got. If you're only trying to parse a particular function (instead of any function), it's not that bad.</p>\n\n<pre><code>Function MyFunc(ar1, ar2)\n\n    MyFunc = 1\n\nEnd Function\n\nPublic Sub ReadMyFunc(rng As Range)\n\n    Dim vaArgs As Variant\n\n    vaArgs = Split(Split(Left(rng.Formula, Len(rng.Formula) - 1), \"MyFunc(\")(1), \",\")\n\n    Debug.Print \"First arg is: \" &amp; vaArgs(0) &amp; vbNewLine &amp; \"Second arg is: \" &amp; vaArgs(1)\n\nEnd Sub\n</code></pre>\n\n<p>The result from the immediate window</p>\n\n<pre><code>?activecell.Formula\n=MyFunc(A1,\"1\")\nreadmyfunc activecell\nFirst arg is: A1\nSecond arg is: \"1\"\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 5443708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/64xZJ.jpg?s=128&g=1", "display_name": "NamSandStorm", "link": "https://stackoverflow.com/users/5443708/namsandstorm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 850, "favorite_count": 1, "accepted_answer_id": 40643945, "answer_count": 1, "score": 1, "last_activity_date": 1479337688, "creation_date": 1479335398, "last_edit_date": 1531164843, "question_id": 40643525, "link": "https://stackoverflow.com/questions/40643525/how-do-i-read-the-arguments-from-a-formula-in-vba", "title": "How do I read the arguments from a formula in VBA?", "body": "<p>Say I have the following function:</p>\n\n<blockquote>\n  <p>function MyFunction(A as string, Optional B as integer) as string</p>\n</blockquote>\n\n<p>to call this function in cell A1:</p>\n\n<blockquote>\n  <p>=MyFunction(\"Hello\",\"15\")</p>\n</blockquote>\n\n<p>I want to access the arguments of this function from another routine by reading the contents of the cell at A1:</p>\n\n<blockquote>\n  <p>Range(\"A1\").Formula </p>\n</blockquote>\n\n<p>This however returns the entire formula with arguments as a string as the formula was entered in the cell. Is there a way to easily extract the arguments (\"Hello\" and 15)?I am trying to avoid the clunky text manipulation route.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "edited": false, "score": 2, "creation_date": 1479354357, "post_id": 40643249, "comment_id": 68524370, "body": "what&#39;s the value in the variable &quot;finalPDFName&quot; ? Is the the file extension correct ?"}, {"owner": {"reputation": 585, "user_id": 3216810, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/da8ba75a9d7a5581ace535e9d9474d0a?s=128&d=identicon&r=PG&f=1", "display_name": "Rivers31334", "link": "https://stackoverflow.com/users/3216810/rivers31334"}, "reply_to_user": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "edited": false, "score": 1, "creation_date": 1479392530, "post_id": 40643249, "comment_id": 68545747, "body": "Thanks for pointing out. You were correct on file extension."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5930691"}, "edited": false, "score": 0, "creation_date": 1551805239, "post_id": 40668792, "comment_id": 96770914, "body": "Sorry to necro - could you explain further how you fixed this? Where did you add the correct file extension?"}], "tags": [], "owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "is_accepted": false, "score": 2, "last_activity_date": 1479438984, "creation_date": 1479438984, "answer_id": 40668792, "question_id": 40643249, "link": "https://stackoverflow.com/questions/40643249/error-when-saving-file-using-exportasfixedformat/40668792#40668792", "title": "Error when saving file using .ExportAsFixedFormat", "body": "<p>Answer: Correct File extension to be provided.</p>\n"}], "owner": {"reputation": 585, "user_id": 3216810, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/da8ba75a9d7a5581ace535e9d9474d0a?s=128&d=identicon&r=PG&f=1", "display_name": "Rivers31334", "link": "https://stackoverflow.com/users/3216810/rivers31334"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 783, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1479438984, "creation_date": 1479334124, "last_edit_date": 1531164843, "question_id": 40643249, "link": "https://stackoverflow.com/questions/40643249/error-when-saving-file-using-exportasfixedformat", "title": "Error when saving file using .ExportAsFixedFormat", "body": "<p>I have run a macro which generates a sheet that I want to save as a PDF.  When I run the method below, I get the error telling me my document was not saved (<code>Run=time error '-2147024773 (8007007b)': Document not saved</code>. </p>\n\n<p>I beleive it may be the filename that I am trying to give it...but unsure.  Happy to provide any further information.</p>\n\n<p>All variables are publicly declared </p>\n\n<pre><code>Public Sub toPDF()\n\n    PDFName = \"Pinger Report_\" &amp; Format(Now, \"dd/mm/yyyy hh:mm:ss\")\n    sumPDFSheet.Cells(5, 4).Value = Format(Now, \"dd/mm/yyyy hh:mm:ss\")\n\n    finalPDFName = PDFPath &amp; PDFName\n\n    'create borders around failed devices range on pdfsheet\n        With sumPDFSheet.Range(sumPDFSheet.Cells(24, 3), sumPDFSheet.Cells(k - 1, 5)).Borders\n    .LineStyle = xlContinuous\n    End With\n\n    'creates heading rows for each page in the pdf and centers correctly\n    sumPDFSheet.PageSetup.PrintTitleRows = sumPDFSheet.Rows(1).Address\n    sumPDFSheet.PageSetup.CenterVertically = False\n    sumPDFSheet.PageSetup.CenterHorizontally = True\n\n    'method call to format columns\n    allColumns\n\n    'save as pdf to correct folder with correct name\n    With sumPDFSheet\n        .ExportAsFixedFormat Type:=xlTypePDF, Filename:=finalPDFName, openafterpublish:=False 'ERRRORRRRRRRRRERRRR\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 2, "creation_date": 1479333869, "post_id": 40643081, "comment_id": 68518432, "body": "ActiveWorkbook.Path tells you the current location of a workbook.  You could use an open workbook event to check its value."}, {"owner": {"reputation": 392, "user_id": 4888843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef82d1015fe3787231add5f346bcb5b?s=128&d=identicon&r=PG&f=1", "display_name": "Hrothgar", "link": "https://stackoverflow.com/users/4888843/hrothgar"}, "edited": false, "score": 1, "creation_date": 1479337352, "post_id": 40643081, "comment_id": 68519881, "body": "maybe use ThisWorkBook.path instead, in case the workbook is opened but not active (perhaps by another macro?)"}], "owner": {"reputation": 51, "user_id": 2533406, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ab549a42e21ae6d92e2fb87e90e4042a?s=128&d=identicon&r=PG", "display_name": "user2533406", "link": "https://stackoverflow.com/users/2533406/user2533406"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 18, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479333353, "creation_date": 1479333353, "last_edit_date": 1531164843, "question_id": 40643081, "link": "https://stackoverflow.com/questions/40643081/running-vba-script-based-off-of-file-location", "title": "Running VBA script based off of file location", "body": "<p>Users at my workplace do not always grab the latest network copy of an excel sheet. Sometimes they will grab a read-only copy and save it locally to their desktop. </p>\n\n<p>I'd like to know if it's possible to write an on-open visual basic script that determines if the active workbook's current save location isn't the original location I specify and perform actions based off of the result. </p>\n"}, {"tags": ["excel", "vba", "macros"], "comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1479332145, "post_id": 40642700, "comment_id": 68517590, "body": "&quot;JobCol_Master&quot; is a subrange of the &quot;MasterData&quot; range? Why scope it as a subrange in your for in any case?"}, {"owner": {"reputation": 189, "user_id": 2898478, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/0bd93104ed087aecac701ad3fc80c268?s=128&d=identicon&r=PG&f=1", "display_name": "DigitalSea", "link": "https://stackoverflow.com/users/2898478/digitalsea"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1479333792, "post_id": 40642700, "comment_id": 68518391, "body": "Thank you for taking a look. I managed to get it working."}], "answers": [{"comments": [{"owner": {"reputation": 756, "user_id": 6549541, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/YsVtB.jpg?s=128&g=1", "display_name": "atclaus", "link": "https://stackoverflow.com/users/6549541/atclaus"}, "edited": false, "score": 0, "creation_date": 1479333004, "post_id": 40642859, "comment_id": 68517991, "body": "In general, stepping through your code with <code>F8</code> will help you get to the point of failure faster."}], "tags": [], "owner": {"reputation": 756, "user_id": 6549541, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/YsVtB.jpg?s=128&g=1", "display_name": "atclaus", "link": "https://stackoverflow.com/users/6549541/atclaus"}, "is_accepted": false, "score": 3, "last_activity_date": 1479332423, "creation_date": 1479332423, "answer_id": 40642859, "question_id": 40642700, "link": "https://stackoverflow.com/questions/40642700/changing-value-based-on-matching-value-on-different-worksheet/40642859#40642859", "title": "Changing value based on matching value on different worksheet", "body": "<p>Your line <code>For Each cell In .Range(\"JobCol_Master\")</code> is trying to refer to sub range of MasterData range which I do not believe exists. Either use MasterData as  a workbook reference, or specify the JobCol_Master explicitly.</p>\n"}, {"tags": [], "owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "is_accepted": false, "score": 2, "last_activity_date": 1479332701, "creation_date": 1479332701, "answer_id": 40642922, "question_id": 40642700, "link": "https://stackoverflow.com/questions/40642700/changing-value-based-on-matching-value-on-different-worksheet/40642922#40642922", "title": "Changing value based on matching value on different worksheet", "body": "<p>agree with @atclaus above, change to the following: </p>\n\n<pre><code>If Txt &lt;&gt; \"\" Then\n    With sheets(\"Jobs\")\n        For Each cell In .Range(\"JobCol_Master\")\n            'If job# matches textbox and if job# is to correct region then...\n            If cell.Text = Txt And Cells(cell.row, 4).Value = \"ID\" Then\n              Cells(cell.row, 11).Value = \"Test\"\n              Exit Sub\n                If cell.Text &lt;&gt; Txt Then\n                    Exit Sub\n                End If\n            End If\n        Next cell\n    End With\n End If\n</code></pre>\n\n<p>let us know how you get on :)</p>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 3, "last_activity_date": 1479334075, "last_edit_date": 1479334075, "creation_date": 1479333275, "answer_id": 40643066, "question_id": 40642700, "link": "https://stackoverflow.com/questions/40642700/changing-value-based-on-matching-value-on-different-worksheet/40643066#40643066", "title": "Changing value based on matching value on different worksheet", "body": "<p>I guess you're mostly after this code:</p>\n\n<pre><code>Option Explicit\n\nSub CloseJob()\n    Dim cell As Range\n    Dim Txt As String\n\n    On Error GoTo errHndl\n\n    With ThisWorkbook\n        Txt = .Worksheets(\"ID\").TextBoxID.Text\n        If Txt &lt;&gt; \"\" Then\n            With .Worksheets(\"Jobs\")\n                For Each cell In .Range(\"JobCol_Master\")\n                    'If job# matches textbox and if job# is to correct region then...\n                    If cell.Text = Txt And .Cells(cell.row, 4).Value = \"ID\" Then\n                        .Cells(cell.row, 11).Value = \"Test\"\n                        Exit Sub '&lt;-- remove it if you want to \"mark\" all job# matches in 'JobCol_Master' named range\n                    End If\n                Next cell\n            End With\n        End If\n    End With\n    MsgBox \"Job not found.\"\n\n    Exit Sub\nerrHndl:\n        MsgBox \"Error happened while working on: \" + vbCrLf + _\n            vbCrLf + vbCrLf + \"Error \" + _\n            Str(Err.number) + \": \" + Err.Description, vbCritical + vbOKOnly, \"Error\"\nEnd Sub\n</code></pre>\n\n<p>while it's not clear to me the role of the <em>macro button ... on worksheet(\"ID\").</em>: if that macro is supposed to be called via that button only, then your <code>ActiveSheet</code> will always be \"ID\" worksheet</p>\n"}], "owner": {"reputation": 189, "user_id": 2898478, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/0bd93104ed087aecac701ad3fc80c268?s=128&d=identicon&r=PG&f=1", "display_name": "DigitalSea", "link": "https://stackoverflow.com/users/2898478/digitalsea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 40643066, "answer_count": 3, "score": 1, "last_activity_date": 1479334075, "creation_date": 1479331827, "question_id": 40642700, "link": "https://stackoverflow.com/questions/40642700/changing-value-based-on-matching-value-on-different-worksheet", "title": "Changing value based on matching value on different worksheet", "body": "<p>This code only works properly when I'm on the worksheet(\"Jobs\") sheet where the Master Data is. The textbox and macro button is on worksheet(\"ID\"). When I run the code when I'm on worksheet(\"ID\"), I only get the MsgBox message and code ends. It doesn't update the value when conditions are true. Can someone please look over code to see what the problem is? Having trouble figuring this out.</p>\n\n<p>Thank you.</p>\n\n<pre><code>Option Explicit\n\nSub CloseJob()\n\nDim MasterData As Range\nDim sourceID As Range\nDim cell As Range, row As Range, JobCol As Range\nDim Txt As String\n\nOn Error GoTo errHndl\nTxt = ThisWorkbook.Worksheets(\"ID\").TextBoxID.Text\nSet MasterData = ThisWorkbook.Worksheets(\"Jobs\").Range(\"MasterData\")\n\nIf Txt &lt;&gt; \"\" Then\n    With MasterData\n        For Each cell In .Range(\"JobCol_Master\")\n            'If job# matches textbox and if job# is to correct region then...\n            If cell.Text = Txt And Cells(cell.row, 4).Value = \"ID\" Then\n              Cells(cell.row, 11).Value = \"Test\"\n              Exit Sub\n                If cell.Text &lt;&gt; Txt Then\n                    Exit Sub\n                End If\n            End If\n        Next cell\n    End With\n End If\n\nMsgBox \"Job not found.\"\n\nExit Sub\nerrHndl:\n    MsgBox \"Error happened while working on: \" + vbCrLf + _\n        vbCrLf + vbCrLf + \"Error \" + _\n        Str(Err.Number) + \": \" + Err.Description, vbCritical + vbOKOnly, \"Error\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1479333420, "post_id": 40642643, "comment_id": 68518197, "body": "Which event are you using?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1479334940, "post_id": 40642643, "comment_id": 68518911, "body": "Have in mind, that a <i>form/subform</i> opens in this sequence: <i>subform-form-subform</i> = 3 steps. Thus, the subform is opened, closed, then the form is opened, and finally the subform is opened again."}, {"owner": {"reputation": 1, "user_id": 6197557, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7ZznfqGJNyk/AAAAAAAAAAI/AAAAAAAAACY/C5i4DUBuvhU/photo.jpg?sz=128", "display_name": "Luke Silburn", "link": "https://stackoverflow.com/users/6197557/luke-silburn"}, "edited": false, "score": 0, "creation_date": 1479373181, "post_id": 40642643, "comment_id": 68532305, "body": "Thanks for your feedback@Fionnuala"}, {"owner": {"reputation": 1, "user_id": 6197557, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7ZznfqGJNyk/AAAAAAAAAAI/AAAAAAAAACY/C5i4DUBuvhU/photo.jpg?sz=128", "display_name": "Luke Silburn", "link": "https://stackoverflow.com/users/6197557/luke-silburn"}, "reply_to_user": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1479373760, "post_id": 40642643, "comment_id": 68532647, "body": "@Fionnuala: The code blocks I posted are in the &#39;On Enter&#39; event handlers for two combo-box controls on the parent form."}, {"owner": {"reputation": 1, "user_id": 6197557, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7ZznfqGJNyk/AAAAAAAAAAI/AAAAAAAAACY/C5i4DUBuvhU/photo.jpg?sz=128", "display_name": "Luke Silburn", "link": "https://stackoverflow.com/users/6197557/luke-silburn"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1479373775, "post_id": 40642643, "comment_id": 68532655, "body": "@Gustav: OK thanks for the background. That suggests that for my first example the subform is not being opened the second time for some reason. Does that sound like a reasonable hypothesis?"}, {"owner": {"reputation": 1, "user_id": 6197557, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7ZznfqGJNyk/AAAAAAAAAAI/AAAAAAAAACY/C5i4DUBuvhU/photo.jpg?sz=128", "display_name": "Luke Silburn", "link": "https://stackoverflow.com/users/6197557/luke-silburn"}, "reply_to_user": {"reputation": 4508, "user_id": 5177604, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3f8d9d1b1e5cd8c23552b2b6e1f9f8f0?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Fuller", "link": "https://stackoverflow.com/users/5177604/tom-fuller"}, "edited": false, "score": 0, "creation_date": 1479373856, "post_id": 40642643, "comment_id": 68532720, "body": "@Tom: Thanks for the code reformatting. :)"}, {"owner": {"reputation": 1, "user_id": 6197557, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7ZznfqGJNyk/AAAAAAAAAAI/AAAAAAAAACY/C5i4DUBuvhU/photo.jpg?sz=128", "display_name": "Luke Silburn", "link": "https://stackoverflow.com/users/6197557/luke-silburn"}, "edited": false, "score": 0, "creation_date": 1479377108, "post_id": 40642643, "comment_id": 68535136, "body": "Solution has been found. I&#39;ve edited the original question to reflect the answer.   Kudos to my colleague Colin, who spotted the problem in about 30 seconds when I ran it past him..."}], "owner": {"reputation": 1, "user_id": 6197557, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7ZznfqGJNyk/AAAAAAAAAAI/AAAAAAAAACY/C5i4DUBuvhU/photo.jpg?sz=128", "display_name": "Luke Silburn", "link": "https://stackoverflow.com/users/6197557/luke-silburn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 988, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594641029, "creation_date": 1479331593, "last_edit_date": 1594641029, "question_id": 40642643, "link": "https://stackoverflow.com/questions/40642643/error-2467-when-i-try-to-refer-a-subform-controls-form-property-in-vba", "title": "error 2467 when I try to refer a subform control&#39;s .Form property in vba", "body": "<p>ETA: I ran it past a colleague and he pointed out where the problem was. Answer at the bottom.</p>\n<p>I have a parent form setup with some invisible subform controls. Each subform control is linked to a different subform at design-time, then I have some code on the parent which flies each of the subform controls to the relevant position and makes it visible for the user to do some work with it.</p>\n<p>Here's one block of code that does this:</p>\n<pre><code>    Set Me.childRegion_MVC.Form.Recordset = rs2\n    Me.childRegion_MVC.Form.cmdClearAll.Enabled = intCount &gt; 0\n    Me.childRegion_MVC.Form.cmdSetAll.Enabled = intCount &lt; rs.RecordCount\n\n    'Position the subform under the relevant combo box  &lt;===== requires tailoring\n    Me.childRegion_MVC.Left = Me.cboRegion.Left\n    Me.childRegion_MVC.Top = Me.cboRegion.Top + Me.cboRegion.Height\n    Me.childRegion_MVC.Width = Me.cboRegion.Width\n    Me.childRegion_MVC.Height = cintTWIPS_CM * 4.5 ' height needs to be set in twips\n\n    Call Me.childRegion_MVC.Form.InitRegion   ' Ensures the subform's recordset is open and binds the subform controls\n    Me.childRegion_MVC.Visible = True\n    Me.childRegion_MVC.SetFocus\n</code></pre>\n<p>and here's another:</p>\n<pre><code>    Set Me.childBusiness_MVC.Form.Recordset = rs2\n    Me.childBusiness_MVC.Form.cmdClearAll.Enabled = intCount &gt; 0\n    Me.childBusiness_MVC.Form.cmdSetAll.Enabled = intCount &lt; rs.RecordCount\n\n    'Position the subform under the relevant combo box  &lt;===== requires tailoring\n    Me.childBusiness_MVC.Left = Me.cboBusiness.Left\n    Me.childBusiness_MVC.Top = Me.cboBusiness.Top + Me.cboBusiness.Height\n    Me.childBusiness_MVC.Width = Me.cboBusiness.Width\n    Me.childBusiness_MVC.Height = cintTWIPS_CM * 4.5 ' height needs to be set in twips\n\n    Call Me.childBusiness_MVC.Form.InitBusiness   ' Ensures the subform's recordset is open and bind the subform controls\n    Me.childBusiness_MVC.Visible = True\n    Me.childBusiness_MVC.SetFocus\n</code></pre>\n<p>My problem is that the first code block throws error 2467 (&quot;the expression you entered refers to an object that is closed or does not exist.&quot;) on the very first line at run-time (where I'm setting the Recordset using a preprepared recordset object (rs2)), whereas the second block does not.</p>\n<p>Looking at the debug window, the .Form property of the child control doesn't exist in the first case; whereas it's there in the second - so that's the proximate cause of the error, but I can't figure out <em>why</em> that form object isn't there for the first example:</p>\n<ul>\n<li>rs2 is being prepped/opened in the same way in both cases</li>\n<li>both subform controls (<code>childRegion_MVC</code> and <code>childBusiness_MVC</code>) have the same properties set in design mode</li>\n<li>both source objects (<code>subfrmRegion_MVC</code> and <code>subfrmBusiness_MVC</code> respectively) exist in the database</li>\n<li>I have compact/repaired and decompiled the database to purge any corruption issues that might have crept in.</li>\n</ul>\n<p>But <code>childRegion_MVC</code> still breaks my form when I try to use it.</p>\n<p>Can anyone suggest what might be going on here? I am utterly stumped.</p>\n<h3>+++The Solution+++</h3>\n<p>It turns out that problem was a broken recordsource on the problematic subform.</p>\n<p>This caused the subform to have an empty recordset when it was opened as part of the parent form startup and thus it promptly closed - meaning that there was no form available when my code tried to reference it later on.</p>\n"}, {"tags": ["excel", "vbscript", "vba"], "comments": [{"owner": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "edited": false, "score": 0, "creation_date": 1479332998, "post_id": 40642623, "comment_id": 68517985, "body": "I am unable to reproduce. Try to comment the lines <code>oWB.save</code> and <code>oWB.Application.Quit</code> and add <code>excel.Visible = True</code>. See if the file opens for you"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6017774"}, "edited": false, "score": 1, "creation_date": 1479334781, "post_id": 40642623, "comment_id": 68518829, "body": "PS This is an EXCEL error not a VBScript error."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6811411"}, "edited": false, "score": 0, "creation_date": 1479344562, "post_id": 40642623, "comment_id": 68522004, "body": "&#39;Should there really be a <b>USER</b> named <code>My Folder</code> I&#39;m in doubt."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1479378416, "post_id": 40642623, "comment_id": 68536089, "body": "@Noodles &lt;begin rant&gt;Who would have thought to tag a question in VBScript with <a href=\"http://meta.stackoverflow.com/questions/300056/synonymize-very-bad-amalgam-tags-excel-vba-access-vba-word-vba-powerp\">a tag containing a different language</a>?&lt;/ end rant&gt;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6017774"}, "reply_to_user": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 1, "creation_date": 1479379103, "post_id": 40642623, "comment_id": 68536570, "body": "@ZevSpitz They are just COM objects. Tag should Excel-Object, not Excel-vba as it VBA is irrelevant to using Excel. If calling API functions in VB then code looks very similar to C programs doing the same thing. Likewise any COM program looks similar as they call the exact same objects."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1479379408, "post_id": 40642623, "comment_id": 68536770, "body": "@Noodles You don&#39;t have to convince me. Upvote on that proposal if you think it&#39;s a valid solution to the problem."}, {"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1479380736, "post_id": 40642623, "comment_id": 68537634, "body": "I suspect that the error comes from a macro in <code>file.xlsm</code>. That&#39;s why I added the tag <a href=\"https://stackoverflow.com/questions/tagged/excel-vba\">excel-vba</a>."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "reply_to_user": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1479383220, "post_id": 40642623, "comment_id": 68539268, "body": "@AnsgarWiechers Digressing -- The error appears to be happening in the call to the <code>Open</code> method on the <code>Worksheets</code> collection. If the error had nothing to do with the VBA in <code>file.xlsm</code>, how would you have tagged this question -- Is <a href=\"https://stackoverflow.com/questions/tagged/excel\">excel</a> too broad? Is <a href=\"https://stackoverflow.com/questions/tagged/excel-vba\">excel-vba</a> not relevant in this context (VBScript)?"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1479384327, "post_id": 40642623, "comment_id": 68539948, "body": "1) Are you getting the same error (<i>There is no file extension in &#39;C:\\Users\\My &#39;.</i>) when you try the second and third variants in your question? (2) Can you open the file by hand?"}, {"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "reply_to_user": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1479384739, "post_id": 40642623, "comment_id": 68540219, "body": "@ZevSpitz Like I said: I suspect that the error actually comes from a macro in <code>file.xlsm</code> (it&#39;s definitely not a VBScript error message). That&#39;s why I added the VBA tag. I could have added the Excel tag as well, but didn&#39;t feel the need. If you disagree: just edit the tags."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "reply_to_user": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1479385063, "post_id": 40642623, "comment_id": 68540432, "body": "@AnsgarWiechers Not disagreeing; asking a theoretical question."}, {"owner": {"reputation": 63, "user_id": 4462912, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/1a4995ae9cff3f035b3198c8700b1525?s=128&d=identicon&r=PG&f=1", "display_name": "Ken", "link": "https://stackoverflow.com/users/4462912/ken"}, "edited": false, "score": 0, "creation_date": 1479394066, "post_id": 40642623, "comment_id": 68546900, "body": "Thanks for the input everyone. I don&#39;t suspect it to be the excel file because I am able to open the excel file manually, but i will see if there is an issue with it. Also, when i use this same vb script on a different computer with a folder name that does not contain a space, it works fine and is able to open the excel file without any issues. The only time it doesn&#39;t work is when there is a space in a folder for the file path."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1479403726, "post_id": 40642623, "comment_id": 68553759, "body": "So, based on your update, what happens when you run this vbscript file manually. Do you have the same issue, or is it only when this vbscript is run through taskscheduler?"}, {"owner": {"reputation": 63, "user_id": 4462912, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/1a4995ae9cff3f035b3198c8700b1525?s=128&d=identicon&r=PG&f=1", "display_name": "Ken", "link": "https://stackoverflow.com/users/4462912/ken"}, "edited": false, "score": 0, "creation_date": 1479408571, "post_id": 40642623, "comment_id": 68556548, "body": "Yes it works now. It was task scheduler. I guess it uses a space character as a delimiter. I fixed the issue by simply putting the file path in quotes. Thank you all for your help"}], "owner": {"reputation": 63, "user_id": 4462912, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/1a4995ae9cff3f035b3198c8700b1525?s=128&d=identicon&r=PG&f=1", "display_name": "Ken", "link": "https://stackoverflow.com/users/4462912/ken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479398708, "creation_date": 1479331528, "last_edit_date": 1531164843, "question_id": 40642623, "link": "https://stackoverflow.com/questions/40642623/script-throws-error-for-folders-with-space-in-them", "title": "Script throws error for folders with space in them", "body": "<p>I have a .vbs file that opens and launches an Excel file. The issue is that it errors when it reaches a space in my folder path.</p>\n\n<p>The code is:</p>\n\n<pre><code>Dim excel, oWB\n\nSet excel = CreateObject(\"Excel.Application\")\n\nSet oWB = excel.Workbooks.Open(\"C:\\Users\\My Folder\\Desktop\\file.xlsm\")\noWB.save\n\noWB.Application.Quit\n</code></pre>\n\n<p>I recieve the error</p>\n\n<blockquote>\n  <p>There is no file extension in 'C:\\Users\\My '.</p>\n</blockquote>\n\n<p>I've tried</p>\n\n<pre><code> Set oWB = excel.Workbooks.Open(Chr(34) &amp; \"C:\\Users\\My Folder\\Desktop\\file.xlsm\" &amp; Chr(34))\n</code></pre>\n\n<p>and</p>\n\n<pre><code>Set oWB = excel.Workbooks.Open(\"\"\"C:\\Users\\My Folder\\Desktop\\file.xlsm\"\"\")\n</code></pre>\n\n<p>as suggested from other forums.</p>\n\n<p>UPDATE:</p>\n\n<p>So I am convinced that the error is coming from the \"Task Scheduler\" and not the vb script. I tried changing the file path name in the vb script, but the error was the same even though I changed it completely. Then I realized that under \"actions > start a program > add arguments (optional)\" in the \"Task Scheduler\", I was calling the same file path to launch the vb script. I don't think the \"Task Scheduler\" registers space characters in folder names for some reason.</p>\n\n<p>I use Task Scheduler to run the vbscript early in the morning before I come into the office so that it runs multiple excel files with automatted macros that launch.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 2, "creation_date": 1479330743, "post_id": 40642336, "comment_id": 68516875, "body": "Hello and welcome to StackOverflow. Please take some time to read the help page, especially the sections named <a href=\"http://stackoverflow.com/help/on-topic\">&quot;What topics can I ask about here?&quot;</a> and <a href=\"http://stackoverflow.com/help/dont-ask\">&quot;What types of questions should I avoid asking?&quot;</a>. And more importantly, please read <a href=\"http://meta.stackexchange.com/q/156810/204922\">the Stack Overflow question checklist</a>. You might also want to learn about <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Examples</a>.  And include the code you are trying to work through...so people can help."}, {"owner": {"reputation": 392, "user_id": 4888843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef82d1015fe3787231add5f346bcb5b?s=128&d=identicon&r=PG&f=1", "display_name": "Hrothgar", "link": "https://stackoverflow.com/users/4888843/hrothgar"}, "edited": false, "score": 0, "creation_date": 1479338129, "post_id": 40642336, "comment_id": 68520132, "body": "Not an easy task you&#39;ve set for yourself as your first VBA program :)  As Rdster says, you need to do some work on it before we can help you, but I will give you some pointers.  First, record some macros and then use the editor to see how they work.  Play around a bit.  Second, you need to set a reference to Word in the Tools&gt;References section of your project, so you can manipulate a word document.  Third, you need to either select the cells you want one at time and paste them into the word document text, or copy them as a range and paste them (maybe as a table?).  Play around a bit more :)"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7169738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79b35424bdd1c24ca3525fc57336a450?s=128&d=identicon&r=PG&f=1", "display_name": "xAgni", "link": "https://stackoverflow.com/users/7169738/xagni"}, "edited": false, "score": 0, "creation_date": 1479398028, "post_id": 40645480, "comment_id": 68549959, "body": "it worked! The only dilemma I&#39;m facing is that I have specific cells, E5, N5 and P5 as a different font and I want to copy the same font onto the word document as well. I tried Range.Font.Name and other functions but it isn&#39;t working. Any ideas? Also, how would you make the cluster of InsertAfter loop until the final row (i.e., row 1 to 500)?  <code>FinalRow = Cells(Rows.Count, 1).End(xlUp).Row</code>"}, {"owner": {"reputation": 11, "user_id": 7169738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79b35424bdd1c24ca3525fc57336a450?s=128&d=identicon&r=PG&f=1", "display_name": "xAgni", "link": "https://stackoverflow.com/users/7169738/xagni"}, "edited": false, "score": 0, "creation_date": 1479401005, "post_id": 40645480, "comment_id": 68552041, "body": "<code>For lRow = 5 To 387      Wordrng.InsertAfter (sh.Range(&quot;A&quot; &amp; lRow)) &amp; vbCrLf          Wordrng.InsertAfter (sh.Range(&quot;E&quot; &amp; lRow)) &amp; &quot; &quot;     Wordrng.InsertAfter (sh.Range(&quot;K&quot; &amp; lRow)) &amp; &quot; &quot;     Wordrng.InsertAfter (sh.Range(&quot;L&quot; &amp; lRow)) &amp; vbCrLf          Wordrng.InsertAfter (sh.Range(&quot;N&quot; &amp; lRow)) &amp; &quot; &quot;  Next lRow</code> I got it to parse through all my rows! How do I change font for one specific cell in word? @Hrothgar"}, {"owner": {"reputation": 392, "user_id": 4888843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef82d1015fe3787231add5f346bcb5b?s=128&d=identicon&r=PG&f=1", "display_name": "Hrothgar", "link": "https://stackoverflow.com/users/4888843/hrothgar"}, "reply_to_user": {"reputation": 11, "user_id": 7169738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79b35424bdd1c24ca3525fc57336a450?s=128&d=identicon&r=PG&f=1", "display_name": "xAgni", "link": "https://stackoverflow.com/users/7169738/xagni"}, "edited": false, "score": 0, "creation_date": 1479416949, "post_id": 40645480, "comment_id": 68561223, "body": "Hmm, I&#39;ll have a look at that.  One thing to try, while I&#39;m doing other things, is to record a word macro and see how it does it.  Then you can transfer that code over to your excel sheet and modify it to suit."}, {"owner": {"reputation": 11, "user_id": 7169738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79b35424bdd1c24ca3525fc57336a450?s=128&d=identicon&r=PG&f=1", "display_name": "xAgni", "link": "https://stackoverflow.com/users/7169738/xagni"}, "edited": false, "score": 0, "creation_date": 1479420289, "post_id": 40645480, "comment_id": 68562936, "body": "I added an update to my code, check it out @Hrothgar"}, {"owner": {"reputation": 392, "user_id": 4888843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef82d1015fe3787231add5f346bcb5b?s=128&d=identicon&r=PG&f=1", "display_name": "Hrothgar", "link": "https://stackoverflow.com/users/4888843/hrothgar"}, "reply_to_user": {"reputation": 11, "user_id": 7169738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79b35424bdd1c24ca3525fc57336a450?s=128&d=identicon&r=PG&f=1", "display_name": "xAgni", "link": "https://stackoverflow.com/users/7169738/xagni"}, "edited": false, "score": 0, "creation_date": 1479501484, "post_id": 40645480, "comment_id": 68601712, "body": "yeah, now you&#39;re cooking with gas!  Keep on tweaking.  You could grab the font face and size from the spreadsheet cell, and copy them in the word range too. Text colour, bold, etc.  You should be able to duplicate virtually any formatting from one to the other.  One other thing.  Try to be sure to dimension all your variables before you use them.  It prevents errors due to misspellings if nothing else.  Put &quot;Option Explicit&quot; up before the first sub and then compile, and you&#39;ll get a warning for every variable that isn&#39;t declared.  I should have done that in my example, sorry.  Added."}, {"owner": {"reputation": 11, "user_id": 7169738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79b35424bdd1c24ca3525fc57336a450?s=128&d=identicon&r=PG&f=1", "display_name": "xAgni", "link": "https://stackoverflow.com/users/7169738/xagni"}, "edited": false, "score": 0, "creation_date": 1479506064, "post_id": 40645480, "comment_id": 68603659, "body": "Might be a beginner question, but how do you grab the font face and size from the spreadsheet during the WordRng.InsertAfter. Thank you for the advice with &quot;Option Explicit&quot;! I&#39;ve added Update 2, please have a look. it is throwing back an error: I&#39;m getting this error: &quot;Object doesn&#39;t support this property or method&quot; for &quot;selStart = Selection.Start&quot;."}, {"owner": {"reputation": 392, "user_id": 4888843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef82d1015fe3787231add5f346bcb5b?s=128&d=identicon&r=PG&f=1", "display_name": "Hrothgar", "link": "https://stackoverflow.com/users/4888843/hrothgar"}, "reply_to_user": {"reputation": 11, "user_id": 7169738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79b35424bdd1c24ca3525fc57336a450?s=128&d=identicon&r=PG&f=1", "display_name": "xAgni", "link": "https://stackoverflow.com/users/7169738/xagni"}, "edited": false, "score": 0, "creation_date": 1479523644, "post_id": 40645480, "comment_id": 68607676, "body": "I think it&#39;s the selection.start part that is wrong.  Not sure what selection is at this point.  Instead, try selStart = wordrng.start maybe?  Also, for capturing cell formats, you can use properties such as sh.range (&quot;E5&quot;).Font.Name, .Font.FontStyle, and .Font.Size to capture the font details from the spreadsheet.  Here&#39;s a trick I use a lot:  after you set a variable that you&#39;re interested in, put a stop command.  When the code stops there, you can use the watches window to examine that variable, and you will see all of the properties of that object.  Then you&#39;ll know the structure of it."}, {"owner": {"reputation": 11, "user_id": 7169738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79b35424bdd1c24ca3525fc57336a450?s=128&d=identicon&r=PG&f=1", "display_name": "xAgni", "link": "https://stackoverflow.com/users/7169738/xagni"}, "edited": false, "score": 0, "creation_date": 1479743675, "post_id": 40645480, "comment_id": 68675480, "body": "Thanks for the input. The only issue is that sh.range&quot;E5&quot; only changes the cell properties in excel and not the word document (when it&#39;s copied over). Any way I can change it after the cell has been copied over? When I copy the excel cell, I want to retain all its properties. `       Wordrng.InsertAfter (sh.Range(&quot;E&quot; &amp; lRow).Font.Name = &quot;Calibri&quot;) &amp; &quot; &quot;` says &quot;False&quot; when copied over. I changed to Wordrng.Start and it doesn&#39;t change the right characters to the proper font. <code>With WordDoc.Range(lenOfDate, lenOfDate + lenOfE + 1)</code> This is confusing.. I&#39;d appreciate anymore advice!  @Hrothgar"}, {"owner": {"reputation": 392, "user_id": 4888843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef82d1015fe3787231add5f346bcb5b?s=128&d=identicon&r=PG&f=1", "display_name": "Hrothgar", "link": "https://stackoverflow.com/users/4888843/hrothgar"}, "reply_to_user": {"reputation": 11, "user_id": 7169738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79b35424bdd1c24ca3525fc57336a450?s=128&d=identicon&r=PG&f=1", "display_name": "xAgni", "link": "https://stackoverflow.com/users/7169738/xagni"}, "edited": false, "score": 0, "creation_date": 1480011929, "post_id": 40645480, "comment_id": 68807614, "body": "oh.  What I meant was, after you copy over the value of E5, you can copy the format by getting the font, etc from the worksheet, and setting the same font in the word document.  so myfont = sh.range (&quot;E5&quot;).font.name:  wrdrange(start, stop).font.name = myfont, or something like that.  You&#39;ll have to fight with the wrdrange part to get the exact range you want."}], "tags": [], "owner": {"reputation": 392, "user_id": 4888843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef82d1015fe3787231add5f346bcb5b?s=128&d=identicon&r=PG&f=1", "display_name": "Hrothgar", "link": "https://stackoverflow.com/users/4888843/hrothgar"}, "is_accepted": false, "score": 0, "last_activity_date": 1479501562, "last_edit_date": 1479501562, "creation_date": 1479347756, "answer_id": 40645480, "question_id": 40642336, "link": "https://stackoverflow.com/questions/40642336/microsoft-excel-copy-cells-to-word/40645480#40645480", "title": "Microsoft Excel Copy Cells to Word", "body": "<p>OK, I found this intriguing, so I went ahead and worked on it.  I don't usually work with VBA in Word, so it's probably pretty primitive, but it's a place for you to start.  Remember, you must add Word to the references in the Excel VB editor.</p>\n\n<pre><code>Option Explicit\nSub Make_Word_Doc()\nDim rng As Range\nDim sh As Worksheet\nDim WordDoc As Word.Document\nDim WordApp As Word.Application\nDim Wordrng As Word.Range\n\nSet sh = ActiveSheet\n\nSet WordApp = CreateObject(\"Word.Application\")\nWordApp.Visible = True\nSet WordDoc = WordApp.Documents.Add\nSet Wordrng = WordDoc.Range(Start:=0)\n\nWordrng.InsertBefore (\"\") 'seems to be needed to establish wordrng in the document.\n'after each insertion, Wordrng includes the new text\n\n'work on these commands to place the text where you want it.\nWordrng.InsertAfter (sh.Range(\"A5\")) &amp; vbCrLf\nWordrng.InsertAfter (sh.Range(\"E5\")) &amp; \" \"\nWordrng.InsertAfter (sh.Range(\"K5\")) &amp; \"  \"\nWordrng.InsertAfter (sh.Range(\"L5\")) &amp; vbCrLf\nWordrng.InsertAfter (sh.Range(\"N5\")) &amp; vbTab\nWordrng.InsertAfter (sh.Range(\"P5\")) &amp; vbTab\nWordrng.InsertAfter (sh.Range(\"T5\")) &amp; vbTab\nWordrng.InsertAfter (sh.Range(\"U5\")) &amp; vbCrLf\n\nStop 'take this out when you're done playing around\n\nWordDoc.Close False ' this will close the file without saveing.  handy for testing\nWordApp.Quit\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7169738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79b35424bdd1c24ca3525fc57336a450?s=128&d=identicon&r=PG&f=1", "display_name": "xAgni", "link": "https://stackoverflow.com/users/7169738/xagni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1536667016, "creation_date": 1479330458, "last_edit_date": 1536667016, "question_id": 40642336, "link": "https://stackoverflow.com/questions/40642336/microsoft-excel-copy-cells-to-word", "title": "Microsoft Excel Copy Cells to Word", "body": "<p>I'm trying to copy excel cells into a word document - just the content and not the formatting. For example, I want to copy these cells: A5 (which is a date format) as the first line, cells (E5, K5, L5) in the line after and cells (N5, P5, T5, U5) as the last line in word. I want to do the same for the next row up to the last row where data is available. </p>\n\n<p>For example, in word, I want the content from the excel cells in this format:</p>\n\n<pre><code>A5\nE5 K5 L5\nN5 P5 T5 U5\n\nA6\nE6 K6 L6\nN6 P6 T6 U6\n\n[...]\n</code></pre>\n\n<p>Update:</p>\n\n<p>I've been able to pull everything from excel to word. However, the font needs to be changed for specific cells. I'm parsing to find the length of the cell and modifying that portion to change to a different text, but it isn't working, and I'm completely lost.</p>\n\n<pre><code>Sub Convert_to_Word()\n\nDim rng As Range\nDim sh As Worksheet\nDim WordDoc As Word.Document\nDim WordApp As Word.Application\nDim Wordrng As Word.Range\nDim lRow As Long\n\n'WordDoc.Content.Style = (\"No Spacing\")\n\nSet sh = ActiveSheet\n\nSet WordApp = CreateObject(\"Word.Application\")\nWordApp.Visible = True\nSet WordDoc = WordApp.Documents.Add\nSet Wordrng = WordDoc.Range(Start:=0)\n\n' Find Last Row of Data\nFinalRow = Cells(Rows.Count, 1).End(xlUp).Row\n\n' Needed to establish wordrng in doc\nWordrng.InsertBefore (\"\")\n\nBase = 0\nc = 0\n\n' After each insertion, Wordrng includes the new text\n' Copying Content Over\nFor lRow = 5 To FinalRow\n\n    lenOfE = Len(sh.Range(\"E\" &amp; lRow))\n    lenOfDate = Len(sh.Range(\"A\" &amp; lRow))\n\n    Wordrng.InsertAfter (sh.Range(\"A\" &amp; lRow)) &amp; vbCrLf\n\n    Wordrng.InsertAfter (sh.Range(\"E\" &amp; lRow)) &amp; \" \"\n\n    Set WordrngofE = WordDoc.Range(Start:=Base + lenOfDate + 1, End:=Base + lenOfDate + 1 + lenOfE)\n    WordrngofE.Font.Name = \"Calibri\"\n\n    Wordrng.InsertAfter (sh.Range(\"K\" &amp; lRow)) &amp; \" \"\n    Wordrng.InsertAfter (sh.Range(\"L\" &amp; lRow)) &amp; vbCrLf\n\n    Wordrng.InsertAfter (sh.Range(\"N\" &amp; lRow)) &amp; \" \"\n    Wordrng.InsertAfter (sh.Range(\"P\" &amp; lRow)) &amp; \" \"\n    Wordrng.InsertAfter (sh.Range(\"T\" &amp; lRow)) &amp; \" \"\n    Wordrng.InsertAfter (sh.Range(\"U\" &amp; lRow)) &amp; \" \"\n    Wordrng.InsertAfter (sh.Range(\"V\" &amp; lRow)) &amp; vbCrLf\n\n    c = c + lenOfDate\n    Base = WordDoc.Range.ComputeStatistics(wdStatisticCharacters) + (14 * (lRow - 4)) + c '+ (lenOfDate * (lRow - 4))\n\nNext lRow\n\nEnd Sub\n</code></pre>\n\n<p>The \"Base + lenOfDate + 1\" is to account for an index error. The (14 * (lRow - 4)) doesn't make any logical sense, I added it to compensate the fact that characters after the cell I want to change is being modified instead.</p>\n\n<p>Update 2:</p>\n\n<p>So I decided not to take the approach from Update 1. Instead, I'm trying a different method, however it is throwing back an error: \"Object doesn't support this property or method\" for \"selStart = Selection.Start\". </p>\n\n<p>Ref: <a href=\"https://stackoverflow.com/questions/21975012\">Excel VBA: setting font style and size while adding text to MS-Word</a></p>\n\n<pre><code>Sub Convert_to_Word()\n\nDim rng As Range\nDim sh As Worksheet\nDim WordDoc As Word.Document\nDim WordApp As Word.Application\nDim Wordrng As Word.Range\nDim lRow As Long\n\nDim selStart As Long\n\nSet sh = ActiveSheet\nSet WordApp = CreateObject(\"Word.Application\")\n\nWordApp.Visible = True\nSet WordDoc = WordApp.Documents.Add\nSet Wordrng = WordDoc.Range(Start:=0)\n\n' Find Last Row of Data\nFinalRow = Cells(Rows.Count, 1).End(xlUp).Row\n\n' Establish WordRng in Doc\nWordrng.InsertBefore (\"\")\n\n    'Wordrng.Font.Name = \"Arial\"\n    'Wordrng.Font.Size = 7\n    'Wordrng.Font.ColorIndex = wdBlack\n\n    ' After each insertion, Wordrng includes the new text\n    ' Copying Content Over\n    For lRow = 5 To FinalRow\n\n        lenOfE = Len(sh.Range(\"E\" &amp; lRow))\n        lenOfDate = Len(sh.Range(\"A\" &amp; lRow))\n        selStart = Selection.Start\n\n        Wordrng.InsertAfter (sh.Range(\"A\" &amp; lRow)) &amp; vbCrLf\n\n        'Wordrng.InsertAfter (sh.Range(\"E\" &amp; lRow)) &amp; \" \"\n\n        WordDoc.Range(selStart).InsertAfter (sh.Range(\"E\" &amp; lRow)) &amp; \" \"\n        With WordDoc.Range(selStart, selStart + lenOfE)\n            .Font.Name = \"Times New Roman\"\n            .Font.Size = 15\n        End With\n\n        ' TRIAL\n        '--- Remove selection. This will move the cursor at end of selected word\n        'Selection.MoveRight Unit:=wdCharacter, Count:=1\n\n        '--- Select the inserted word\n        'Selection.MoveRight Unit:=wdCharacter, Count:=Len(sh.Range(\"E\" &amp; lRow)), Extend:=wdExtend\n        'Selection.Font.Name = \"Calibri\"\n        'Selection.Font.Size = 7\n\n        Wordrng.InsertAfter (sh.Range(\"K\" &amp; lRow)) &amp; \" \"\n        Wordrng.InsertAfter (sh.Range(\"L\" &amp; lRow)) &amp; \" \"\n        Wordrng.InsertAfter (sh.Range(\"V\" &amp; lRow)) &amp; vbCrLf\n\n    Next lRow\n\nWordApp.Quit\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "button"], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 3564778, "user_type": "registered", "accept_rate": 53, "profile_image": "https://graph.facebook.com/541386339/picture?type=large", "display_name": "ViggieSmalls", "link": "https://stackoverflow.com/users/3564778/viggiesmalls"}, "edited": false, "score": 0, "creation_date": 1479339192, "post_id": 40642166, "comment_id": 68520489, "body": "So the worksheet code successfully copies over, but every time I click the button, it keeps referring to the the &quot;master&quot; macro. I&#39;ve tried specifying the macro the sheet macro (i.e. sheet1.macro) but it keeps pointing to the directory of the &quot;master file&quot; macro. Any way to force it to refer to the sheet macro?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 73, "user_id": 3564778, "user_type": "registered", "accept_rate": 53, "profile_image": "https://graph.facebook.com/541386339/picture?type=large", "display_name": "ViggieSmalls", "link": "https://stackoverflow.com/users/3564778/viggiesmalls"}, "edited": false, "score": 1, "creation_date": 1479364703, "post_id": 40642166, "comment_id": 68527781, "body": "So it&#39;s not an <code>ActiveX</code> button but a <code>Form</code> one. In this case just redifine its <code>OnAction</code> property as per <a href=\"https://www.thespreadsheetguru.com/blog/correcting-shape-assigned-macro-links-after-copying-worksheet-vba\" rel=\"nofollow noreferrer\">This link</a>"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 2, "last_activity_date": 1479329866, "creation_date": 1479329866, "answer_id": 40642166, "question_id": 40641825, "link": "https://stackoverflow.com/questions/40641825/creating-a-button-with-macro-on-a-different-workbook/40642166#40642166", "title": "Creating a button with macro on a different workbook", "body": "<p>I'd go like this:</p>\n\n<ul>\n<li><p>have your \"master\" workbook with a template worksheet whit both an ActiveX button and its corresponding code in its code pane</p>\n\n<p>say its name is \"TemplateSheetWithButtonAndCode\"</p></li>\n<li><p>in your macro use</p>\n\n<pre><code>Worksheets(\"TemplateSheetWithButtonAndCode\").Copy \nActiveWorkbook.SaveAs \"c:\\MyFolder\\MyWorkbooK\"\n</code></pre></li>\n</ul>\n\n<p>this will generate a new workbook with a copy of your \"template\" worksheet as its only worksheet, along with necessary code to have the button work</p>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1479330627, "post_id": 40642226, "comment_id": 68516821, "body": "which is quite what I answered... As the elder said &quot;repetita juvant&quot;"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1479330065, "creation_date": 1479330065, "answer_id": 40642226, "question_id": 40641825, "link": "https://stackoverflow.com/questions/40641825/creating-a-button-with-macro-on-a-different-workbook/40642226#40642226", "title": "Creating a button with macro on a different workbook", "body": "<p>Place the button on a template worksheet.  Place the button's associated macro in that worksheet's code area.</p>\n\n<p>If you export the worksheet to another workbook, you will also be exporting the button and the macro.</p>\n"}], "owner": {"reputation": 73, "user_id": 3564778, "user_type": "registered", "accept_rate": 53, "profile_image": "https://graph.facebook.com/541386339/picture?type=large", "display_name": "ViggieSmalls", "link": "https://stackoverflow.com/users/3564778/viggiesmalls"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1008, "favorite_count": 0, "accepted_answer_id": 40642166, "answer_count": 2, "score": 1, "last_activity_date": 1479330065, "creation_date": 1479328602, "last_edit_date": 1479329416, "question_id": 40641825, "link": "https://stackoverflow.com/questions/40641825/creating-a-button-with-macro-on-a-different-workbook", "title": "Creating a button with macro on a different workbook", "body": "<p>I currently have a macro which creates another workbook and adds a button to it. I've assigned a macro to the button, but I believe I still need the master workbook to actually run the macro.</p>\n\n<p>Is there a way to have the macro run on the new workbook without referring to the master workbook? In other words, is it possible to programmatically add a button to a new workbook with a macro and have it be independent of the original workbook?</p>\n\n<p>Thanks in advance! </p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 2, "last_activity_date": 1479330317, "creation_date": 1479330317, "answer_id": 40642298, "question_id": 40641753, "link": "https://stackoverflow.com/questions/40641753/using-vba-in-outlook-how-can-i-convert-an-excel-range-to-a-table/40642298#40642298", "title": "Using VBA in Outlook, how can I convert an Excel range to a table?", "body": "<p>This is because in Excel you already have a sheet open. The ActiveSheet is the default when you just stick <code>Range(\"somerange\")</code> without specifying which sheet, workbook, or excel application object that range exists in. In outlook there is no such thing as <code>activesheet</code> and so it has no idea what you mean by that range. </p>\n\n<p>You'll have to be more explicit:</p>\n\n<pre><code>Dim excApp As Excel.Application\nSet excApp = GetObject(, \"Excel.Application\")  \nDim excWB as Object\nSet excWB = excApp.Workbooks.Add  \nexcApp.ListObjects.Add(xlSrcRange, excWB.sheets(\"sheet1\").Range(\"A1:D10\"), , xlYes).Name = \"myTable\"\n</code></pre>\n\n<p>Or something along those lines</p>\n\n<p>In short, an excel application has workbooks, workbooks have sheets, and sheets have ranges. </p>\n"}], "owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 276, "favorite_count": 0, "accepted_answer_id": 40642298, "answer_count": 1, "score": 1, "last_activity_date": 1593415225, "creation_date": 1479328335, "last_edit_date": 1593415225, "question_id": 40641753, "link": "https://stackoverflow.com/questions/40641753/using-vba-in-outlook-how-can-i-convert-an-excel-range-to-a-table", "title": "Using VBA in Outlook, how can I convert an Excel range to a table?", "body": "<p>I am trying to convert an Excel range to a table using a VBA script run from Outlook.</p>\n\n<p>This worked when run from Excel but not from Outlook:</p>\n\n<pre><code>ListObjects.Add(xlSrcRange, Range(\"A1:D10\"), , xlYes).Name = \"myTable\"\n</code></pre>\n\n<p>I tried this next code in Outlook but it failed:</p>\n\n<pre><code>Dim excApp As Excel.Application\nSet excApp = GetObject(, \"Excel.Application\")    \nexcApp.ListObjects.Add(xlSrcRange, Range(\"A1:D10\"), , xlYes).Name = \"myTable\"\n</code></pre>\n\n<p>This code threw run-time error '1004' Method 'Range' of object '_Global' failed.</p>\n\n<p>I want to know how to make the code work, but I also want to understand why my code failed so that I can learn from it.  I appreciate any suggestions.  Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "edited": false, "score": 0, "creation_date": 1479328466, "post_id": 40641646, "comment_id": 68515607, "body": "Can you remove the <code>On Error GoTo nextIt</code> and check for errors?"}, {"owner": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "edited": false, "score": 1, "creation_date": 1479328814, "post_id": 40641646, "comment_id": 68515820, "body": "What are you expecting to get with <code>sSourceFile = PDFPath &amp; Dir(PDFPath &amp; &quot;*.pdf&quot;)</code>? Because if you print out the <code>sSourceFile</code> it will only return <code>&quot;D:\\####\\Pinging Program\\Active Report\\&quot;</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "edited": false, "score": 2, "creation_date": 1479345100, "post_id": 40641646, "comment_id": 68522156, "body": "@VictorMoraes - <code>sSourceFile = PDFPath &amp; Dir(PDFPath &amp; &quot;*.pdf&quot;)</code> would set <code>sSourceFile</code> to the name (including path) of the first <code>.pdf</code> file found within the <code>PDFPath</code> directory.  (If there are <b>no</b> <code>.pdf</code> files in that directory then it will just return the same value as <code>PDFPath</code>, but if there is at least one <code>.pdf</code> file in that directory it will return what is expected.)"}, {"owner": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1479378836, "post_id": 40641646, "comment_id": 68536371, "body": "@YowE3K It turns out that, as pointed by nbayly, I was also missing the trailing back slash in my testing, hence my faulty result. I just learned something new today, so thank you for that :)"}, {"owner": {"reputation": 585, "user_id": 3216810, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/da8ba75a9d7a5581ace535e9d9474d0a?s=128&d=identicon&r=PG&f=1", "display_name": "Rivers31334", "link": "https://stackoverflow.com/users/3216810/rivers31334"}, "edited": false, "score": 0, "creation_date": 1479392636, "post_id": 40641646, "comment_id": 68545832, "body": "YIkes, thank you to all. <code>sSourceFile</code> was incorrect and the `` was missing.  Thank you to all. For error handling, how do you all put those in in the building process? Do you leave them for the end of the developing process?"}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1479398836, "post_id": 40641646, "comment_id": 68550557, "body": "@Rivers31334 not sure I understand your question about error handling. In the case of your code above you told the application to put all the errors in a box (nextIt) but then you did nothing with the box. Usually you would want it to error out and be able to debug. This gives you the opportunity to step through your code and review what values your variables are getting. You can also add breakpoints that pause execution of your code and then you can either step through (F8), add watches, etc. Hope this helps."}], "answers": [{"tags": [], "owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "is_accepted": true, "score": 2, "last_activity_date": 1479334511, "creation_date": 1479334511, "answer_id": 40643326, "question_id": 40641646, "link": "https://stackoverflow.com/questions/40641646/moving-generated-pdf-to-new-folder-on-network-drive/40643326#40643326", "title": "Moving generated PDF to new folder on network drive", "body": "<p>Your destination folder is missing the final slash. Also as a suggestion for the future the error would have been a lot easier to understand if you weren't bypassing error handling as Victor had suggested. Your code would look like:</p>\n\n<pre><code>Public Sub transferFile()\n\n\nSet fileSystemObject = CreateObject(\"Scripting.FileSystemObject\")\nPDFPath = \"C:\\test\\Active Report\\\"\npastPDFPath = \"C:\\test\\Past Reports\"\nsSourceFile = PDFPath &amp; Dir(PDFPath &amp; \"*.pdf\")\nsDestinationFile = \"C:\\test\\Past Reports\\\"\n\n'move file\nIf Dir(sSourceFile) &lt;&gt; \"\" Then\n    fileSystemObject.moveFile sSourceFile, sDestinationFile\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>I have tested it and it worked as expected. Regards,</p>\n"}], "owner": {"reputation": 585, "user_id": 3216810, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/da8ba75a9d7a5581ace535e9d9474d0a?s=128&d=identicon&r=PG&f=1", "display_name": "Rivers31334", "link": "https://stackoverflow.com/users/3216810/rivers31334"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 40643326, "answer_count": 1, "score": 0, "last_activity_date": 1479334511, "creation_date": 1479327946, "question_id": 40641646, "link": "https://stackoverflow.com/questions/40641646/moving-generated-pdf-to-new-folder-on-network-drive", "title": "Moving generated PDF to new folder on network drive", "body": "<p>I have a macro that executes and creates a PDF file. Each time the macro is run, a PDF is generated.  I would like to move the last version of the report (run three times per day) to a folder titles 'Past Reports'.  I have been playing around with the script below but it does not work for me.  The Active Report folder only contains the most recent PDF created.</p>\n\n<p>Can anyone offer help?  Happy to add more info if needed.</p>\n\n<pre><code>Public Sub transferFile()\nOn Error GoTo nextIt\n\nSet fileSystemObject = CreateObject(\"Scripting.FileSystemObject\")\nPDFPath = \"D:\\####\\Pinging Program\\Active Report\\\"\npastPDFPath = \"D:\\####\\Pinging Program\\Past Reports\" \nsSourceFile = PDFPath &amp; Dir(PDFPath &amp; \"*.pdf\")\nsDestinationFile = \"D:\\####\\Pinging Program\\Past Reports\"  \n\n'move file\nIf Dir(sSourceFile) &lt;&gt; \"\" Then\n    fileSystemObject.moveFile sSourceFile, sDestinationFile\nEnd If\n\nnextIt:\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "edited": false, "score": 1, "creation_date": 1479327782, "post_id": 40641110, "comment_id": 68515194, "body": "Hello. Check <a href=\"http://stackoverflow.com/questions/67835/deleting-a-file-in-vba\">this answer</a> and see if it helps"}, {"owner": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "edited": false, "score": 0, "creation_date": 1479329254, "post_id": 40641110, "comment_id": 68516062, "body": "Please update your question and post the code there"}, {"owner": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "edited": false, "score": 0, "creation_date": 1479330157, "post_id": 40641110, "comment_id": 68516569, "body": "I am not familiar with VBA for Word, but by debugging the code I noticed that in the line <code>ActiveDocument.Close</code> you are actually closing the document which is running the macro, therefore the <code>Kill sTempFilePath</code> is never executed"}, {"owner": {"reputation": 23, "user_id": 4597944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40ec1080d7316bb3c3b22d64ea781017?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/4597944/mike"}, "reply_to_user": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "edited": false, "score": 0, "creation_date": 1479330402, "post_id": 40641110, "comment_id": 68516691, "body": "That absolutely makes sense! Any thoughts on how I should go about it then? If I move the Kill above it I get an access denied error (in use)."}, {"owner": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "edited": false, "score": 0, "creation_date": 1479332214, "post_id": 40641110, "comment_id": 68517617, "body": "See my answer, although user3598756 has also provided an alternative solution"}], "answers": [{"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 1, "last_activity_date": 1479331976, "creation_date": 1479331976, "answer_id": 40642739, "question_id": 40641110, "link": "https://stackoverflow.com/questions/40641110/delete-document-after-attaching-to-email/40642739#40642739", "title": "Delete document after attaching to email", "body": "<p>use <code>FileSytemObject()</code> object to make a copy of the wanted file and finally delete it</p>\n\n<p>here's an example with a late binding</p>\n\n<pre><code>Public Sub SubmitButton_Click()\n    Dim sTempFilePath   As String\n\n    sTempFilePath = (\"C:\\temp\\test.doc\")\n\n    With CreateObject(\"Scripting.FileSystemObject\") '&lt;--| instantiate a running instance of 'FileSystemObject' object\n        .CopyFile ActiveDocument.FullName, sTempFilePath '&lt;--| copy active document into a new file\n    End With\n\n    '....code to process sTempFilePath\n\n    Kill sTempFilePath '&lt;--| and finally... kill it!\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 4597944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40ec1080d7316bb3c3b22d64ea781017?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/4597944/mike"}, "edited": false, "score": 1, "creation_date": 1479332506, "post_id": 40642767, "comment_id": 68517753, "body": "Thanks guys! I&#39;m going to dig into it again tomorrow and I&#39;ll be sure to post the results."}, {"owner": {"reputation": 23, "user_id": 4597944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40ec1080d7316bb3c3b22d64ea781017?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/4597944/mike"}, "edited": false, "score": 1, "creation_date": 1479397277, "post_id": 40642767, "comment_id": 68549417, "body": "Victor, THANK YOU. That worked perfect. Even better is that it doesn&#39;t close the original so a user can fill it out a couple times without reopening. Awesome. I was wondering though, how hard would it be to rename the attachment and subject line to &quot;Application For Leave Form - First Last&quot; (as in, their first and last name as filled out in the Word form)? The first and last name is put in a &quot;Rich Text Content Control&quot; in Word."}, {"owner": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "reply_to_user": {"reputation": 23, "user_id": 4597944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40ec1080d7316bb3c3b22d64ea781017?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/4597944/mike"}, "edited": false, "score": 0, "creation_date": 1479411920, "post_id": 40642767, "comment_id": 68558500, "body": "I&#39;m glad the solution worked out for you. As I mentioned before, I don&#39;t know much about VBA for Word, but I think you can have a start on what you need in <a href=\"https://msdn.microsoft.com/en-us/library/office/ff836891.aspx\" rel=\"nofollow noreferrer\">here</a>, in <a href=\"http://stackoverflow.com/questions/29524537/extract-data-from-content-controls-in-word-to-excel\">here</a> and in <a href=\"http://stackoverflow.com/questions/10823874/with-a-word-contentcontrol-datepicker-how-do-i-get-the-value\">here</a>. If you have issues after that, I&#39;d post another question with the new issue. Happy coding :)"}], "tags": [], "owner": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "is_accepted": true, "score": 1, "last_activity_date": 1479332099, "creation_date": 1479332099, "answer_id": 40642767, "question_id": 40641110, "link": "https://stackoverflow.com/questions/40641110/delete-document-after-attaching-to-email/40642767#40642767", "title": "Delete document after attaching to email", "body": "<p>You can add a new document as a copy to the current document and save that copy to the desired location. Then, once you close the file, you are closing the newly created file and can successfully delete it.\nThis worked for me and hopefully will work for you.  </p>\n\n<p>See the code for your snippet:  </p>\n\n<pre><code>Dim Doc             As Document\nDim sTempFilePath   As String\n\nsTempFilePath = (\"C:\\temp\\test.doc\")\n\n'the next line copies the active document\nApplication.Documents.Add ActiveDocument.FullName\n\nActiveDocument.SaveAs FileName:=\"C:\\temp\\test.doc\"\n\nActiveDocument.Close\n\nKill sTempFilePath\n</code></pre>\n\n<p>Applying this to your working code, you would have this:</p>\n\n<pre><code>Public Sub SubmitButton_Click()\nDim OL              As Object\nDim EmailItem       As Object\n'Dim Doc             As Document   'not needed\nDim sTempFilePath   As String\n\nApplication.ScreenUpdating = False\nsTempFilePath = (\"C:\\temp\\test.doc\")\n\nSet OL = CreateObject(\"Outlook.Application\")\nSet EmailItem = OL.CreateItem(olMailItem)\n'Set Doc = ActiveDocument ' not needed\nApplication.Documents.Add ActiveDocument.FullName\nActiveDocument.SaveAs FileName:=\"C:\\temp\\test.doc\"\nWith EmailItem\n    .Subject = \"Application For Leave Form\"\n    .To = \"email@email.com\"\n    .Attachments.Add sTempFilePath\n    .Send\nEnd With\n\nApplication.ScreenUpdating = True\nSet OL = Nothing\nSet EmailItem = Nothing\n'Set Doc = Nothing\nActiveDocument.Close\nKill sTempFilePath\n\nEnd Sub\n</code></pre>\n\n<p>Reference: <a href=\"http://www.vbaexpress.com/kb/getarticle.php?kb_id=961\" rel=\"nofollow noreferrer\">http://www.vbaexpress.com/kb/getarticle.php?kb_id=961</a></p>\n"}], "owner": {"reputation": 23, "user_id": 4597944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40ec1080d7316bb3c3b22d64ea781017?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/4597944/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1092, "favorite_count": 0, "accepted_answer_id": 40642767, "answer_count": 2, "score": 2, "last_activity_date": 1502715696, "creation_date": 1479326042, "last_edit_date": 1502715696, "question_id": 40641110, "link": "https://stackoverflow.com/questions/40641110/delete-document-after-attaching-to-email", "title": "Delete document after attaching to email", "body": "<p>Newbie here. I've created a Macro-enabled word document with a Submit button. The document is read-only, so what I'm trying to do is have it save a temp file, attach the temp file, then delete it. Simple enough, right? Everything works except it won't delete. Attached is the code for the Submit button. Please help! Thanks.</p>\n\n<pre><code>Public Sub SubmitButton_Click()\nDim OL              As Object\nDim EmailItem       As Object\nDim Doc             As Document\nDim sTempFilePath   As String\n\nApplication.ScreenUpdating = False\nsTempFilePath = (\"C:\\temp\\test.doc\")\n\nSet OL = CreateObject(\"Outlook.Application\")\nSet EmailItem = OL.CreateItem(olMailItem)\nSet Doc = ActiveDocument\nActiveDocument.SaveAs FileName:=\"C:\\temp\\test.doc\"\nWith EmailItem\n    .Subject = \"Application For Leave Form\"\n    .To = \"email@email.com\"\n    .Attachments.Add sTempFilePath\n    .Send\nEnd With\n\nApplication.ScreenUpdating = True\nSet OL = Nothing\nSet EmailItem = Nothing\nSet Doc = Nothing\nActiveDocument.Close\nKill sTempFilePath\n\nEnd Sub\n</code></pre>\n\n<p>For simplicity I took out a lot of the code, and it's still not deleting the file. What's wrong with this?    </p>\n\n<pre><code>Public Sub SubmitButton_Click()\nDim Doc             As Document\nDim sTempFilePath   As String\n\nsTempFilePath = (\"C:\\temp\\test.doc\")\n\nSet Doc = ActiveDocument\n\nActiveDocument.SaveAs FileName:=\"C:\\temp\\test.doc\"\n\nActiveDocument.Close\n\nKill sTempFilePath\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1479327297, "post_id": 40641454, "comment_id": 68514902, "body": "Nice work! You can mark your own answer as &quot;Accepted&quot;, too :)"}, {"owner": {"reputation": 181, "user_id": 4383965, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/779509cf6b9ea0864f7db1caec4405b8?s=128&d=identicon&r=PG&f=1", "display_name": "NoobProgrammer", "link": "https://stackoverflow.com/users/4383965/noobprogrammer"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1479327433, "post_id": 40641454, "comment_id": 68514979, "body": "@DavidZemens hahaha yeah, most of the credit goes to you though through my other post. you helped me figure out the keyword I needed to type in google to search. Did not know what &quot;ProgID&quot; was or that was a thing. As my name suggests, I am a noob programmer :P"}], "tags": [], "owner": {"reputation": 181, "user_id": 4383965, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/779509cf6b9ea0864f7db1caec4405b8?s=128&d=identicon&r=PG&f=1", "display_name": "NoobProgrammer", "link": "https://stackoverflow.com/users/4383965/noobprogrammer"}, "is_accepted": true, "score": 2, "last_activity_date": 1479327204, "creation_date": 1479327204, "answer_id": 40641454, "question_id": 40641092, "link": "https://stackoverflow.com/questions/40641092/excel-vba-create-acropdf-programmatically/40641454#40641454", "title": "Excel VBA Create AcroPDF Programmatically", "body": "<p>Found the answer on a random Korean website while searching on Google. Did not understand anything so I looked for key English words and the ProgID is \"AcroPDF.PDF.1\"</p>\n"}], "owner": {"reputation": 181, "user_id": 4383965, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/779509cf6b9ea0864f7db1caec4405b8?s=128&d=identicon&r=PG&f=1", "display_name": "NoobProgrammer", "link": "https://stackoverflow.com/users/4383965/noobprogrammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 501, "favorite_count": 0, "accepted_answer_id": 40641454, "answer_count": 1, "score": 0, "last_activity_date": 1479327390, "creation_date": 1479325980, "last_edit_date": 1479327390, "question_id": 40641092, "link": "https://stackoverflow.com/questions/40641092/excel-vba-create-acropdf-programmatically", "title": "Excel VBA Create AcroPDF Programmatically", "body": "<p>Currently I have a form with a single button and the following code:</p>\n\n<pre><code>Dim ctrl As CommandButton\n\nPrivate Sub CommandButton1_Click()\n\nSet ctrl = Me.Controls.Add(bstrProgID:=\"Forms.commandbutton.1\", Name:=\"CommandButton1\", Visible:=True)\n\nEnd Sub\n</code></pre>\n\n<p>instead of creating a command button, I want to create an AcroPDF control. AcroPDF can be found under the \"Additional Control\" option. I have found that each individual control has its own ProgID, but the list only shows common controls like command buttons and labels, etc. Not able to find AcroPDF ProgID Can anyone help?</p>\n\n<p>Thanks :)</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11, "user_id": 6640482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6bfa07182d1edfe21b53e489e3e8901?s=128&d=identicon&r=PG&f=1", "display_name": "Joe B", "link": "https://stackoverflow.com/users/6640482/joe-b"}, "edited": false, "score": 0, "creation_date": 1479323998, "post_id": 40640415, "comment_id": 68513060, "body": "I have just changed the section of code:      Format(Now(), &quot;yyyymmdd&quot;) to     &quot;TEST&quot;  and it worked- I have looked in the file location and removed all files that are there, placing the date code back in the I get the same error. Is there a chance a phantom file exists that I cant see?"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1479324547, "post_id": 40640415, "comment_id": 68513378, "body": "Since you just proved you have permissions to write to the directory (using your &quot;Report_TEST&quot; filename), the problem is more likely that you&#39;re forcing an extension of <code>.xls</code> when the <code>FileFormat:=53</code> is for a macro-enabled workbook (extension <code>.xlsm</code>)."}, {"owner": {"reputation": 11, "user_id": 6640482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6bfa07182d1edfe21b53e489e3e8901?s=128&d=identicon&r=PG&f=1", "display_name": "Joe B", "link": "https://stackoverflow.com/users/6640482/joe-b"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1479327673, "post_id": 40640415, "comment_id": 68515139, "body": "I am getting the same error with format 56 though?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6640482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6bfa07182d1edfe21b53e489e3e8901?s=128&d=identicon&r=PG&f=1", "display_name": "Joe B", "link": "https://stackoverflow.com/users/6640482/joe-b"}, "edited": false, "score": 0, "creation_date": 1479326463, "post_id": 40641002, "comment_id": 68514439, "body": "Thanks for the reply, 53 works with &quot;TEST&quot; and . I tried 56 and still no luck. I think there is a phantom file hanging out somewhere that i cant see. I think I need to Write in on &quot;On Error&quot; add &quot;1&quot; to the end of the file name, on that error add &quot;2&quot;, etc."}], "tags": [], "owner": {"reputation": 1, "user_id": 6348667, "user_type": "registered", "profile_image": "https://graph.facebook.com/1198251140231246/picture?type=large", "display_name": "Lauren Tan", "link": "https://stackoverflow.com/users/6348667/lauren-tan"}, "is_accepted": false, "score": 0, "last_activity_date": 1479325646, "creation_date": 1479325646, "answer_id": 40641002, "question_id": 40640415, "link": "https://stackoverflow.com/questions/40640415/suddenly-getting-an-error-in-my-excel-vba-when-saving-as-xls-fileformat-53/40641002#40641002", "title": "Suddenly Getting an Error in my Excel VBA- when Saving as .xls FileFormat:=53", "body": "<p>I think to save as \".xls\", FileFormat should be 56\n<a href=\"http://www.rondebruin.nl/win/s5/win001.htm\" rel=\"nofollow noreferrer\">http://www.rondebruin.nl/win/s5/win001.htm</a></p>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1479332577, "creation_date": 1479332577, "answer_id": 40642901, "question_id": 40640415, "link": "https://stackoverflow.com/questions/40640415/suddenly-getting-an-error-in-my-excel-vba-when-saving-as-xls-fileformat-53/40642901#40642901", "title": "Suddenly Getting an Error in my Excel VBA- when Saving as .xls FileFormat:=53", "body": "<p>What you can do is to use the macro recorder for this. This is what mine produces:</p>\n\n<pre><code>ChDir \"C:\\Users\\gropc\\Desktop\"\nActiveWorkbook.SaveAs Filename:=\"C:\\Users\\uname\\Desktop\\Book1.xlsx\", _\n    FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\n</code></pre>\n\n<p>The format should be taken into account.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 6640482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6bfa07182d1edfe21b53e489e3e8901?s=128&d=identicon&r=PG&f=1", "display_name": "Joe B", "link": "https://stackoverflow.com/users/6640482/joe-b"}, "edited": false, "score": 0, "creation_date": 1479334153, "post_id": 40643230, "comment_id": 68518556, "body": "That looks like what I need, I&#39;ll give this a go- Many Thanks!"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1479334035, "creation_date": 1479334035, "answer_id": 40643230, "question_id": 40640415, "link": "https://stackoverflow.com/questions/40640415/suddenly-getting-an-error-in-my-excel-vba-when-saving-as-xls-fileformat-53/40643230#40643230", "title": "Suddenly Getting an Error in my Excel VBA- when Saving as .xls FileFormat:=53", "body": "<p>if it's a hidden file issue you could exploit <code>FileSystemObject</code> object and loop until you find a \"free\" file name</p>\n\n<p>so your code line could become the following:</p>\n\n<pre><code>.SaveAs fileName:=GetFreeFileName(\"\\\\MY\\File\\Path\\Report_\" &amp; Format(Now(), \"yyyymmdd\"), \".xls\")\n</code></pre>\n\n<p>which uses the following function:</p>\n\n<pre><code>Function GetFreeFileName(fileName As String, fileExt As String)\n    Dim iFile As Long\n\n    With CreateObject(\"FileSystemObject\")\n        Do While .FileExists(fileName &amp; fileExt)\n            iFile = iFile + 1\n            fileName = fileName &amp; \"-\" &amp; iFile\n        Loop\n    End With\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6640482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6bfa07182d1edfe21b53e489e3e8901?s=128&d=identicon&r=PG&f=1", "display_name": "Joe B", "link": "https://stackoverflow.com/users/6640482/joe-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1230, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1479334035, "creation_date": 1479323589, "question_id": 40640415, "link": "https://stackoverflow.com/questions/40640415/suddenly-getting-an-error-in-my-excel-vba-when-saving-as-xls-fileformat-53", "title": "Suddenly Getting an Error in my Excel VBA- when Saving as .xls FileFormat:=53", "body": "<p>This code has been working for months, and today it is throwing the error:</p>\n\n<p>Run-Time Error '1004'\nMethod 'SaveAs' of Object '_Workbook' failed</p>\n\n<p>The line of code causing the error is:</p>\n\n<pre><code>        '~~&gt;. Save the file\n        .SaveAs Filename:=\"\\\\MY\\File\\Path\\Report_\" &amp; Format(Now(), \"yyyymmdd\") &amp; \".xls\", FileFormat:=53\n</code></pre>\n\n<p>I dont know what has changed here for this suddenly not to work, any ideas?</p>\n\n<p>I am running MS Excel 2016, Version 1609</p>\n\n<p>There is no file in that location with the same name.</p>\n\n<p>I want to save as an .xls in case anyone we send this to has an older version of Excel, I could change it to an .xlsx and rewrite the code a bit but I am curious why all of the sudden this errored out?</p>\n\n<p>Thanks for looking.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1479337575, "post_id": 40640115, "comment_id": 68519958, "body": "Can&#39;t you use something like <a href=\"http://stackoverflow.com/questions/29913191/save-as-an-excel-file-embedded-in-another-excel-file\">this</a>? Copy-paste is gooey anyway."}, {"owner": {"reputation": 11, "user_id": 7169277, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153816676520989/picture?type=large", "display_name": "Michael Noble", "link": "https://stackoverflow.com/users/7169277/michael-noble"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1479469567, "post_id": 40640115, "comment_id": 68582456, "body": "@vacip Thanks for the suggestion, but it doesn&#39;t work as when you have activated the PDF, there is no way to control the object - e.g. the obj.Object.SaveCopyAs is not a method for this type of object.  That is why I am trying to find any way to take the PDF file and save it to disk. I know it will have additional wrapper text in there as part of the embedding process by Excel, but I know how to strip this out via a hex editor. But, I just can&#39;t get the file out to disk in the first place."}], "owner": {"reputation": 11, "user_id": 7169277, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153816676520989/picture?type=large", "display_name": "Michael Noble", "link": "https://stackoverflow.com/users/7169277/michael-noble"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 324, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1539325571, "creation_date": 1479322566, "last_edit_date": 1479333541, "question_id": 40640115, "link": "https://stackoverflow.com/questions/40640115/shell-application-paste-method-does-not-create-a-file-in-the-target-folder", "title": "Shell.Application paste method does not create a file in the target folder", "body": "<p>I've seen a few incarnations of the code I've copied below (from this site actually) and just cannot understand why, after the \"Paste\" instruction, no file is created in the \"Temp\" folder. No error is thrown.</p>\n\n<pre><code>For Each Sh In Sheet1.OLEObjects\n  If InStr(1, Sh.Name, \"Object\", 1) Then\n   Sh.Copy\n   ' this code paste Embedded Object to folder\n   CreateObject(\"Shell.Application\").Namespace(\"C:\\Temp\\\").Self.InvokeVerb \"Paste\"\n  End If\n Next Sh\n</code></pre>\n\n<p>The code is running in Excel and is to save embedded PDF files to disk.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1668, "user_id": 5019691, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93494c08d9bc6418d7a02846a51c5299?s=128&d=identicon&r=PG&f=1", "display_name": "aLearningLady", "link": "https://stackoverflow.com/users/5019691/alearninglady"}, "edited": false, "score": 0, "creation_date": 1479322955, "post_id": 40640060, "comment_id": 68512473, "body": "Thanks @tjb1. Unfortunately, now I&#39;m getting a run-time error: PasteSpecial method of Range class failed"}], "tags": [], "owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "is_accepted": false, "score": 1, "last_activity_date": 1479322383, "creation_date": 1479322383, "answer_id": 40640060, "question_id": 40640000, "link": "https://stackoverflow.com/questions/40640000/range-paste-object-doesnt-support-this-property-or-method/40640060#40640060", "title": "Range.Paste - Object doesn&#39;t support this property or method", "body": "<p>Change it to <code>y.Sheets(\"DTR\").[a1].PasteSpecial</code></p>\n\n<p><code>Paste</code> does not work on ranges, to paste a range you have to use <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839476(v=office.15).aspx\" rel=\"nofollow noreferrer\">PasteSpecial</a>.  I believe by default it does everything but you can specify quite a bit, see <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837425.aspx\" rel=\"nofollow noreferrer\">here</a> </p>\n"}, {"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 3, "creation_date": 1479326005, "post_id": 40640273, "comment_id": 68514166, "body": "Quick note, if you are just copying/pasting values, an alternative that avoids copy/paste is to just set he two ranges equal to each other: <code>Range([destination range]).value = Range([origin range]).value</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1479326805, "post_id": 40640273, "comment_id": 68514650, "body": "@BruceWayne ...with an asterisk: <code>Range</code> implicitly referring to the active workbook, for it to work when the <i>destination</i> workbook isn&#39;t the <i>source</i> workbook, the <code>Range</code> calls need to be fully-qualified with a <code>Worksheet</code> reference. Well at least the <i>destination</i> range in this case."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1479328095, "post_id": 40640273, "comment_id": 68515370, "body": "@Mat&#39;sMug - yes, great call especially when he&#39;s copying from sheet to sheet, I forgot to mention that. Thanks for catching!  So, more specifically, it should be  <code>y.Sheets(&quot;DTR&quot;).[a1].Value = x.Sheets(1).Range(&quot;A1&quot;).Value</code>."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 3, "last_activity_date": 1479323098, "creation_date": 1479323098, "answer_id": 40640273, "question_id": 40640000, "link": "https://stackoverflow.com/questions/40640000/range-paste-object-doesnt-support-this-property-or-method/40640273#40640273", "title": "Range.Paste - Object doesn&#39;t support this property or method", "body": "<p>You can <code>Copy</code> and <code>Paste</code> <code>Ranges</code> between sheets (and workbooks) using 1 line of code, just replace your code with the line below:</p>\n\n<pre><code>x.Sheets(1).Range(\"A1\").CurrentRegion.Copy y.Sheets(\"DTR\").[a1] \n</code></pre>\n\n<p>If you want to use the <code>PasteSpecial</code> method, you got to do it in 2 lines, but you need to add a parameter after the <code>PasteSpecial</code> , like <code>xlValues</code>, etc.</p>\n\n<pre><code>x.Sheets(1).Range(\"A1\").CurrentRegion.Copy\ny.Sheets(\"DTR\").[a1].PasteSpecial xlValues\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": false, "score": 2, "last_activity_date": 1479343513, "last_edit_date": 1479343513, "creation_date": 1479323743, "answer_id": 40640456, "question_id": 40640000, "link": "https://stackoverflow.com/questions/40640000/range-paste-object-doesnt-support-this-property-or-method/40640456#40640456", "title": "Range.Paste - Object doesn&#39;t support this property or method", "body": "<p>The problem with your original code was two-fold.</p>\n\n<ol>\n<li><p>The <code>Cells.Delete</code> statement appeared <em>after</em> the copy, but a delete action clears the clipboard.</p></li>\n<li><p>The Paste method is a member of the Sheet object, not the Range object.</p></li>\n</ol>\n\n<p>Adjusting your code, that becomes:</p>\n\n<pre><code>y.Sheets(\"DTR\").Cells.Delete\nx.Sheets(1).Range(\"A1\").CurrentRegion.Copy\ny.Sheets(\"DTR\").Paste y.Sheets(\"DTR\").[a1]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 17, "last_activity_date": 1479324839, "creation_date": 1479324839, "answer_id": 40640771, "question_id": 40640000, "link": "https://stackoverflow.com/questions/40640000/range-paste-object-doesnt-support-this-property-or-method/40640771#40640771", "title": "Range.Paste - Object doesn&#39;t support this property or method", "body": "<p>Other answers have provided ways to make it work, but don't explain what's going on.</p>\n\n<pre><code>y.Sheets(\"DTR\")\n</code></pre>\n\n<p>That should really be <code>y.Worksheets(\"DTR\")</code>, because the <code>Sheets</code> collection can contain non-worksheet items, such as charts for example.</p>\n\n<p>Regardless, both the <code>Sheets</code> and the <code>Worksheets</code> collections' <code>Item</code> property (which is the <em>default property</em> of any collection type) yields an <code>Object</code>, which makes every chained member call that follows, a late-bound call.</p>\n\n<p>And you don't get <em>IntelliSense</em> on late-bound calls, since these calls get resolved at run-time, by definition: you can call <em>anything</em> on an <code>Object</code>, and the code will happily compile:</p>\n\n<pre><code>Sub Test()\n    Debug.Print ThisWorkbook.Worksheets(1).Whatever\nEnd Sub\n</code></pre>\n\n<p>Same as:</p>\n\n<pre><code>Sub Test()\n    Debug.Print ThisWorkbook.Worksheets.Item(1).Whatever\nEnd Sub\n</code></pre>\n\n<p>At run-time, if VBA can't find the <code>Whatever</code> member on the retrieved object's interface, it raises run-time error 438, \"Object doesn't support this property or method\".</p>\n\n<p>Late-binding is powerful and very useful, but it also incurs overhead that you don't necessarily <em>need</em>.</p>\n\n<p>Instead of working off an <code>Object</code>, you can <em>cast</em> the returned object reference to a specific type when you know what that type is - in this case we <em>know</em> we're dealing with a <code>Worksheet</code> object:</p>\n\n<pre><code>Dim target As Worksheet\nSet target = y.Worksheets(\"DTR\")\n</code></pre>\n\n<p>Now that you have an <em>early-bound</em> <code>Worksheet</code> object reference, <em>IntelliSense</em> can guide you:</p>\n\n<p><a href=\"https://i.stack.imgur.com/OsTMe.png\"><img src=\"https://i.stack.imgur.com/OsTMe.png\" alt=\"IntelliSense dropdown listing members of a Worksheet object\"></a></p>\n\n<p>And if you try to call a bogus member (e.g. <code>target.Whatever</code>), you'll get a compile-time error instead of a run-time error.</p>\n\n<p><a href=\"https://i.stack.imgur.com/4VJxL.png\"><img src=\"https://i.stack.imgur.com/4VJxL.png\" alt=\"compile error: member or data member not found\"></a></p>\n\n<p>When you do this:</p>\n\n<pre><code>target.[A1].Paste\n</code></pre>\n\n<p>You're using late-binding again, to retrieve the <code>A1</code> range. Instead, call the <code>Worksheet.Range</code> property getter to retrieve an early-bound <code>Range</code> object - and from there you'll see that when you type <code>.paste</code> there is no such thing as a <code>Paste</code> method in a <code>Range</code> object:</p>\n\n<p><a href=\"https://i.stack.imgur.com/cVU4F.png\"><img src=\"https://i.stack.imgur.com/cVU4F.png\" alt=\"autocompletion for Range.PasteSpecial\"></a></p>\n\n<p>And you get autocompletion and tooltips for everything as you type it:</p>\n\n<p><a href=\"https://i.stack.imgur.com/evfOr.png\"><img src=\"https://i.stack.imgur.com/evfOr.png\" alt=\"XLPasteType enum members listed for first parameter of Range.PasteSpecial method\"></a></p>\n"}], "owner": {"reputation": 1668, "user_id": 5019691, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93494c08d9bc6418d7a02846a51c5299?s=128&d=identicon&r=PG&f=1", "display_name": "aLearningLady", "link": "https://stackoverflow.com/users/5019691/alearninglady"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11955, "favorite_count": 2, "accepted_answer_id": 40640771, "answer_count": 4, "score": 4, "last_activity_date": 1479343513, "creation_date": 1479322199, "last_edit_date": 1479324309, "question_id": 40640000, "link": "https://stackoverflow.com/questions/40640000/range-paste-object-doesnt-support-this-property-or-method", "title": "Range.Paste - Object doesn&#39;t support this property or method", "body": "<p>I've got a very simple procedure that copies a range from one workbook and pastes it into another; the issue is, I'm getting the error in the title on the <code>paste</code> line. </p>\n\n<p>Below is the code:</p>\n\n<pre><code>Sub copypasta()\nDim x As Workbook\nDim y As Workbook\n\nSet x = ActiveWorkbook\nSet y = Workbooks.Open(\"F:\\Target\\FTB\\FTB.xlsx\")\n\nx.Sheets(1).Range(\"A1\").CurrentRegion.Copy\n\ny.Sheets(\"DTR\").Cells.Delete '&lt;~~~No Error Here...?\ny.Sheets(\"DTR\").[a1].Paste   '&lt;~~~Error Here\n</code></pre>\n\n<p>I thought it was strange that the deletion works fine, but paste does not. </p>\n\n<p>It seems that I may be missing some fundamentals of the paste method - could someone please explain what I'm missing here?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 189, "user_id": 2898478, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/0bd93104ed087aecac701ad3fc80c268?s=128&d=identicon&r=PG&f=1", "display_name": "DigitalSea", "link": "https://stackoverflow.com/users/2898478/digitalsea"}, "edited": false, "score": 0, "creation_date": 1479325254, "post_id": 40640408, "comment_id": 68513746, "body": "One problem. It places the value &quot;Test&quot; in the row below the matched column. I can countered this by putting a -1 .Cells(cell.row - 1, 11).Value = &quot;Test&quot;, but this negates the match rule and working within that matched row."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 189, "user_id": 2898478, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/0bd93104ed087aecac701ad3fc80c268?s=128&d=identicon&r=PG&f=1", "display_name": "DigitalSea", "link": "https://stackoverflow.com/users/2898478/digitalsea"}, "edited": false, "score": 0, "creation_date": 1479326690, "post_id": 40640408, "comment_id": 68514578, "body": "sorry but I don&#39;t get you: what do you mean by  <i>&quot;row below the matched column&quot;</i>? A row cannot be <i>below</i> a column ... If you give more info I could try and help you. BTW, as long as your <i>original</i> issue is concerned  (<i>&quot;I am getting a type mismatch error on line Range(Cells(cell, 11)).Value = &quot;Test&quot;&quot;</i>) my answer solved it so please mark answer as accepted. thank you!"}, {"owner": {"reputation": 189, "user_id": 2898478, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/0bd93104ed087aecac701ad3fc80c268?s=128&d=identicon&r=PG&f=1", "display_name": "DigitalSea", "link": "https://stackoverflow.com/users/2898478/digitalsea"}, "edited": false, "score": 0, "creation_date": 1479327938, "post_id": 40640408, "comment_id": 68515293, "body": "Sorry, it seems to be working, after I rewrote it in a new module. See updated code above. My false statement is causing me issues. I accepted your answer. Thank you."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1479323542, "creation_date": 1479323542, "answer_id": 40640408, "question_id": 40639930, "link": "https://stackoverflow.com/questions/40639930/change-cell-values-if-a-match-is-found/40640408#40640408", "title": "Change cell values if a match is found", "body": "<p>Change</p>\n\n<pre><code>      Range(Cells(cell, 11)).Value = \"Test\"\n</code></pre>\n\n<p>To</p>\n\n<pre><code>      .Cells(cell.Row,11).Value = \"Test\"\n</code></pre>\n"}], "owner": {"reputation": 189, "user_id": 2898478, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/0bd93104ed087aecac701ad3fc80c268?s=128&d=identicon&r=PG&f=1", "display_name": "DigitalSea", "link": "https://stackoverflow.com/users/2898478/digitalsea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 742, "favorite_count": 1, "accepted_answer_id": 40640408, "answer_count": 1, "score": 1, "last_activity_date": 1479328735, "creation_date": 1479321996, "last_edit_date": 1479328735, "question_id": 40639930, "link": "https://stackoverflow.com/questions/40639930/change-cell-values-if-a-match-is-found", "title": "Change cell values if a match is found", "body": "<p>I have a worksheet that has a textbox with a button that will be assigned to a macro. In this workbook there is another worksheet that holds the master data in a table. The textbox will have a job#. What I'm trying to do is lookup the job# in the job# column (column B/named range: \"JobCol_Master\") in the master table, and if a match is found, then in that row, verify a value based on what's in column D. If true, then change cell values in particular columns in that row.</p>\n\n<p>I am getting a type mismatch error on line <code>Range(Cells(cell, 11)).Value = \"Test\"</code>. I am also getting an error when values don't match. </p>\n\n<p>I appreciate any guidance anyone can give me.</p>\n\n<pre><code>Option Explicit\n\nSub IDCloseJob()\n\nDim ws As Worksheet\nDim MasterData As Range\nDim sourceID As Range\nDim cell As Range, row As Range, JobCol As Range\nDim Txt As String\n\nTxt = ThisWorkbook.Worksheets(\"ID\").TextBoxID.Text\nSet MasterData = ThisWorkbook.Worksheets(\"Jobs\").Range(\"MasterData\")\n\n\nIf Txt &lt;&gt; \"\" Then\n    With MasterData\n        For Each cell In .Range(\"JobCol_Master\")\n            'If job# matches textbox and if job# has value equal to \"ID\" in Column D then...\n            If cell.Text = Txt Then\n              Cells(cell.row, 11).Value = \"Test\"\n            Else\n              MsgBox \"Job# not found.\"\n            End If\n        Next cell\n    End With\n End If\n\nEnd Sub\n</code></pre>\n\n<p>Updated Code:</p>\n\n<pre><code>Sub IDCloseJob()\n\nDim MasterData As Range\nDim sourceID As Range\nDim cell As Range, row As Range, JobCol As Range\nDim Txt As String\n\nTxt = ThisWorkbook.Worksheets(\"ID\").TextBoxID.Text\nSet MasterData = ThisWorkbook.Worksheets(\"Jobs\").Range(\"MasterData\")\n\n\nIf Txt &lt;&gt; \"\" Then\n    With MasterData\n        For Each cell In .Range(\"JobCol_Master\")\n            'If job# matches textbox and if job# has value equal to \"ID\" in Column D then...\n            If cell.Text = Txt Then\n              Cells(cell.row, 11).Value = \"Test\"\n            Else\n              MsgBox \"Job not found.\"\n              Exit Sub\n            End If\n        Next cell\n    End With\n End If\nEnd Sub\n</code></pre>\n\n<p>The above code if true doesn't complete the true statement <code>Cells(cell.row, 11).Value = \"Test\"</code>. It bring up the <code>MsgBox</code> then exits the sub. Not sure why...code looks right. If I leave out the false statement it completes my true statement.</p>\n"}, {"tags": ["php", "excel", "csv", "phpexcel", "vba"], "comments": [{"owner": {"reputation": 96, "user_id": 7055168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d909cc33b5c7b53e1a355479787bd331?s=128&d=identicon&r=PG&f=1", "display_name": "Wiebe", "link": "https://stackoverflow.com/users/7055168/wiebe"}, "edited": false, "score": 0, "creation_date": 1479322628, "post_id": 40639907, "comment_id": 68512293, "body": "Excel has standard functionality to open csv files. You cannot add a VBA macro to a csv file, but you can open a csv file in Excel from a VBA script. It seems like you already know this, so what exactly are you missing?"}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1479322674, "post_id": 40639907, "comment_id": 68512313, "body": "I&#39;m not exaclty clear on what you need to do. Is it correct that you need to import a csv to your macro enabled excelfile? That is easily done with a macro on the excelfile."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "reply_to_user": {"reputation": 96, "user_id": 7055168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d909cc33b5c7b53e1a355479787bd331?s=128&d=identicon&r=PG&f=1", "display_name": "Wiebe", "link": "https://stackoverflow.com/users/7055168/wiebe"}, "edited": false, "score": 0, "creation_date": 1479322922, "post_id": 40639907, "comment_id": 68512459, "body": "@Wiebe You can actually run a vba script on a csv file. All you need to do is create a add-in macro that runs each time you run Excel, then in the code you just look at the filename and extension if .csv -&gt; continue code else exit the code."}, {"owner": {"reputation": 505, "user_id": 5331601, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8716ac4afcb2c348604fdd644e28b8cf?s=128&d=identicon&r=PG&f=1", "display_name": "MortiestMorty", "link": "https://stackoverflow.com/users/5331601/mortiestmorty"}, "edited": false, "score": 0, "creation_date": 1479339173, "post_id": 40639907, "comment_id": 68520483, "body": "Sorry, I thought I mentioned it. I can&#39;t import all of the data in the csv file. Unfortunately, I have to pick and choose what data I import and I have to be able to place it where I want in Inventory Master."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1479363667, "post_id": 40639907, "comment_id": 68527349, "body": "Why can&#39;t you import all?"}], "answers": [{"tags": [], "owner": {"reputation": 956, "user_id": 3496240, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e51d489805223fae1ef929503256e073?s=128&d=identicon&r=PG&f=1", "display_name": "gemmo", "link": "https://stackoverflow.com/users/3496240/gemmo"}, "is_accepted": true, "score": 0, "last_activity_date": 1479694306, "creation_date": 1479694306, "answer_id": 40711815, "question_id": 40639907, "link": "https://stackoverflow.com/questions/40639907/best-way-to-import-data-to-macro-enabled-excel-file/40711815#40711815", "title": "Best way to import data to macro enabled excel file", "body": "<p>I think you need to do it in stages. Any database manipulation usually goes through a staging table. A temporary table which you manipulate before copying it to the final table. </p>\n\n<p>Andreas suggested you import the entire file into excel. Run your filters through the file in excel before copying it to the Inventory Master. </p>\n\n<p>You can then dispose of the temporary file.</p>\n"}], "owner": {"reputation": 505, "user_id": 5331601, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8716ac4afcb2c348604fdd644e28b8cf?s=128&d=identicon&r=PG&f=1", "display_name": "MortiestMorty", "link": "https://stackoverflow.com/users/5331601/mortiestmorty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 608, "favorite_count": 0, "accepted_answer_id": 40711815, "answer_count": 1, "score": 0, "last_activity_date": 1479694306, "creation_date": 1479321942, "last_edit_date": 1531161705, "question_id": 40639907, "link": "https://stackoverflow.com/questions/40639907/best-way-to-import-data-to-macro-enabled-excel-file", "title": "Best way to import data to macro enabled excel file", "body": "<p>I've already done a lot of the leg work here and I've assumed that I was going to do it this one way, but I'm not sure that it will work now. I have created an inventory system for my business using excel and it has a number of Macros (VBA scripts) - let's call it Inventory Master. I'm trying to keep track of all of my inventory across all of the different selling mediums (Amazon, eBay, personal store). </p>\n\n<p>I've created a PHP script to pull sales data from Amazon and convert the XML date (request data from Amazon) into two separate csv files - for those who care, the way Amazon's API works, I have to make one request to pull of Sales Order IDs for that day and then another request using the Sales Order ID to get the actual order information. </p>\n\n<p>THE PROBLEM is that I'm not sure what the best way to import the data that I need from the two files, into my inventory master. Also, I have to be able to filter the data that I want to import and place it into the appropriate columns in the Inventory Master. </p>\n\n<p>I was going to create an VBA script to import the files, but I'm sure if I can manipulate the data this way, since the import data is a csv and doesn't have macros enabled. I'm sure I could still find a way, but I was then thinking that I might just be able to do all of this via PHP, but the only PHPExcel library I see doesn't work in xlsm formats. </p>\n\n<p>This is where I turn to the internet. Can anyone think of a better way to import this data?</p>\n"}, {"tags": ["ms-access", "vba", "distinct-values"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 4660232, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2cc310b8980ba78d8b6988854662cf45?s=128&d=identicon&r=PG&f=1", "display_name": "mccdo", "link": "https://stackoverflow.com/users/4660232/mccdo"}, "edited": false, "score": 0, "creation_date": 1479324386, "post_id": 40640209, "comment_id": 68513286, "body": "Thanks for the feedback @Gustav. However, I moved the rs.movenext to where you suggest but it still returns just the 1st value in each field?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 55, "user_id": 4660232, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2cc310b8980ba78d8b6988854662cf45?s=128&d=identicon&r=PG&f=1", "display_name": "mccdo", "link": "https://stackoverflow.com/users/4660232/mccdo"}, "edited": false, "score": 0, "creation_date": 1479327729, "post_id": 40640209, "comment_id": 68515165, "body": "Yes. I don&#39;t know what you are trying to do, but for each fld you just open rs1 but don&#39;t loop it, so it will never move."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1479322880, "creation_date": 1479322880, "answer_id": 40640209, "question_id": 40639674, "link": "https://stackoverflow.com/questions/40639674/find-distinct-set-of-values-using-access-vba/40640209#40640209", "title": "Find distinct set of values using Access VBA", "body": "<p>MoveNext is inside the field loop, so:</p>\n\n<pre><code>For Each tbl In CurrentDb.TableDefs\n\n    If tbl.Name = rs(\"Table_Name\") Then\n    Debug.Print tbl.Name\n\n        For Each fld In tbl.Fields\n            If fld.Name = rs(\"Field_Name\") Then\n            Debug.Print fld.Name\n\n                Set rs1 = CurrentDb.OpenRecordset(\"SELECT DISTINCT \" &amp; tbl.Name &amp; \".Source_System, \" &amp; tbl.Name &amp; \".\" &amp; fld.Name &amp; \" FROM \" &amp; tbl.Name)\n                Debug.Print rs1(0), rs1(1)\n\n            End If\n        Next\n     End If\nNext\nrs.MoveNext\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 4660232, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2cc310b8980ba78d8b6988854662cf45?s=128&d=identicon&r=PG&f=1", "display_name": "mccdo", "link": "https://stackoverflow.com/users/4660232/mccdo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 671, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1594641037, "creation_date": 1479321125, "last_edit_date": 1594641037, "question_id": 40639674, "link": "https://stackoverflow.com/questions/40639674/find-distinct-set-of-values-using-access-vba", "title": "Find distinct set of values using Access VBA", "body": "<p>I want to find the distinct list of values from a collection of certain fields across a number of tables in MS Access. However, my VBA code only returns the first value from every field (and not the full collection of distinct values in each field). Please see below:</p>\n\n<pre><code>Sub GetDistinctValues()\n\n    Dim tbl As DAO.TableDef\n    Dim fld As DAO.Field\n    Dim rs As DAO.Recordset\n    Dim rs1 As DAO.Recordset\n\n    Set rs = CurrentDb.OpenRecordset(\"Fields_To_Examine\")\n\n    Do While Not rs.EOF\n    For Each tbl In CurrentDb.TableDefs\n\n        If tbl.Name = rs(\"Table_Name\") Then\n        Debug.Print tbl.Name\n\n            For Each fld In tbl.Fields\n                If fld.Name = rs(\"Field_Name\") Then\n                Debug.Print fld.Name\n\n                    Set rs1 = CurrentDb.OpenRecordset(\"SELECT DISTINCT \" &amp; tbl.Name &amp; \".Source_System, \" &amp; tbl.Name &amp; \".\" &amp; fld.Name &amp; \" FROM \" &amp; tbl.Name)\n                    Debug.Print rs1(0), rs1(1)\n\n                    rs.MoveNext\n\n                End If\n            Next\n         End If\n    Next\n    Loop\n\n    rs.Close\n    rs1.Close\n\n    Set rs = Nothing\n    Set rs1 = Nothing\n\n    End Sub\n</code></pre>\n\n<p>Any suggestions on where I am going wrong?</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 336, "user_id": 7428364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bFsRs.jpg?s=128&g=1", "display_name": "TheSilkCode", "link": "https://stackoverflow.com/users/7428364/thesilkcode"}, "is_accepted": false, "score": 0, "last_activity_date": 1484995502, "creation_date": 1484995502, "answer_id": 41778399, "question_id": 40639436, "link": "https://stackoverflow.com/questions/40639436/excel-query-from-access-accdb-file-on-password-protected-site/41778399#41778399", "title": "Excel Query from access.accdb file on password-protected site", "body": "<p>Connecting to password protected Access DBs via VBA is tricky- I've found that the syntax suggested by Microsoft doesn't even work... I've gotten DAO connections to work with password protected DBs, see code below- hopefully you can fiddle the same syntax to work with ADO, or just switch all together:</p>\n\n<pre><code>Public Sub sampleCode()\nDim db As DAO.Database\nDim dbPath As String\nDim aQuery As String\nDim pword As String\nDim rs As DAO.Recordset\n\ndbPath = ThisWorkbook.Path &amp; \"\\testBASE1.accdb\"\npword = \"password\"\naQuery = \"SELECT Header1 FROM Table1 WHERE ID = 4\"\n\nSet db = Access.DBEngine.Workspaces(0).OpenDatabase(dbPath, True, False, \";PWD=\" &amp; pword)\nSet rs = db.Execute(aQuery)\nrs.MoveFirst\nMsgBox rs.Fields(0)\nEnd Sub\n</code></pre>\n\n<p>Hope this helps,\nTheSilkCode</p>\n"}], "owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 859, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1484995502, "creation_date": 1479320375, "question_id": 40639436, "link": "https://stackoverflow.com/questions/40639436/excel-query-from-access-accdb-file-on-password-protected-site", "title": "Excel Query from access.accdb file on password-protected site", "body": "<p>So, I can download an .accdb file from a sharepoint site within our company, using a POST request and an MSXML2.ServerHTTP60 object, supplying the intranet password etc. all within Excel VBA. Cool!</p>\n\n<p>With that downloaded file I can run queries against it using code like this:</p>\n\n<pre><code>Dim connXXX As ADODB.Connection\nDim aQuery As String\nDim p As String\nDim res As Object\nDim connStr As String\n    p = ThisWorkbook.Path &amp; \"\\testBASE1.accdb\"\n    connStr = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; p\n    aQuery = \"SELECT Header1 FROM Table1 WHERE ID = 4\"\nSet connXXX = New ADODB.Connection\n    connXXX.Open connStr\n\nSet res = connXXX.Execute(aQuery)\nMsgBox res.Fields(0)\n</code></pre>\n\n<p>What I REALLY want to do though is cut out downloading the file altogether, so I can run a query against the .accdb file that's hosted on the intranet.</p>\n\n<p>I've been trying a few variations on this code using .connectionString or putting in \"URL=\" instead of datasource... all to no avail; I can't figure out where I'd put the intranet username/password... please help! I always get my errors around the connXXX.open part of the code.</p>\n\n<p>1) Is this even possible and\n2) How?!</p>\n\n<p>Broken code:</p>\n\n<pre><code>'ppp = \"http://the_intranet_address_and_filename_with_extension\"\n'ppp = \"URL=http://the_intranet_address_and_filename_with_extension\"\n    '' I've tried both above\n\nconnStr = \"Provider=Microsoft.ACE.OLEDB.12.0;\"\naQuery = \"SELECT Header1 FROM Table1 WHERE ID = 4\"\nconnStrBig = connStr &amp; \"Data Source=\" &amp; ppp\n\nconnXXX.Provider = connStr\nconnXXX.ConnectionString = ppp\nconnXXX.Open\n</code></pre>\n"}, {"tags": ["excel", "charts", "vba"], "answers": [{"tags": [], "owner": {"reputation": 654, "user_id": 5037442, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/75199ed4754399c03e62267158d9445b?s=128&d=identicon&r=PG&f=1", "display_name": "click here", "link": "https://stackoverflow.com/users/5037442/click-here"}, "is_accepted": true, "score": 2, "last_activity_date": 1479319874, "creation_date": 1479319874, "answer_id": 40639285, "question_id": 40638770, "link": "https://stackoverflow.com/questions/40638770/changing-export-of-jpeg-image-from-sheet-to-chart-name/40639285#40639285", "title": "Changing export of jpeg image from sheet to chart name", "body": "<p>Change <code>sht.Name</code> to <code>cht.Chart.ChartTitle.Text</code></p>\n"}], "owner": {"reputation": 27, "user_id": 7141729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b413113dbe7ec0e71546f126bfdffc4?s=128&d=identicon&r=PG&f=1", "display_name": "CorBoy", "link": "https://stackoverflow.com/users/7141729/corboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 40639285, "answer_count": 1, "score": 1, "last_activity_date": 1479320002, "creation_date": 1479318100, "last_edit_date": 1531164843, "question_id": 40638770, "link": "https://stackoverflow.com/questions/40638770/changing-export-of-jpeg-image-from-sheet-to-chart-name", "title": "Changing export of jpeg image from sheet to chart name", "body": "<p>I have found a code in VBA that exports all of the charts in a workbook into a specified folder. It saves using the sheet name, but I would like it save using the chart name instead. </p>\n\n<p>I tried </p>\n\n<pre><code>cht.Chart.Export \"C:\\Users\\----\\Desktop\\ExcelCharts\\\" &amp; Range(\"A1\").Value &amp; \".jpg\", \"JPG\"\n</code></pre>\n\n<p>This code produced only one file, but had the name I wanted</p>\n\n<pre><code>cht.Chart.Export \"C:\\Users\\----\\Desktop\\ExcelCharts\\\" &amp; cht.Name &amp; \".jpg\", \"JPG\"\n</code></pre>\n\n<p>This code produced image 1 and image 10, while my charts are named Hydralaz 20 in sheet 1 and Hydralaz 10 in sheet 2.</p>\n\n<p>The following is the script that successfully exports all charts in a workbook. </p>\n\n<pre><code>Sub Test()\n\nDim sht As Worksheet, cht As ChartObject\nDim x As Integer\n\n    For Each sht In ActiveWorkbook.Sheets\n        x = 1\n        For Each cht In sht.ChartObjects\n            cht.Chart.Export \"C:\\Users\\----\\Desktop\\ExcelCharts\\\" &amp; sht.Name &amp; \".jpg\", \"JPG\"\n            x = x + 1\n        Next cht\n\n    Next sht\n\nEnd Sub\n</code></pre>\n\n<p>Thank you for your help!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 2, "creation_date": 1479318489, "post_id": 40638758, "comment_id": 68509927, "body": "Why don&#39;t you just assign the transpose of the one range to the other? Also, since your code refers to some mysterious <code>AnotherMacro</code> -- how can anybody say what the problem is? The code that you show is unproblematic (though needlessly verbose)."}, {"owner": {"reputation": 652, "user_id": 5153347, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh5.googleusercontent.com/-V7Fp90OBgN0/AAAAAAAAAAI/AAAAAAAAa-Q/lRAC00QPdfI/photo.jpg?sz=128", "display_name": "Zediiiii", "link": "https://stackoverflow.com/users/5153347/zediiiii"}, "edited": false, "score": 0, "creation_date": 1479318638, "post_id": 40638758, "comment_id": 68510026, "body": "Have you checked the called function as well? Depending on how large your sheet is and the version of excel (x64 or x86), you could be running against the 2 GB RAM limit. You might also consider using a relative address for the cells so you don&#39;t have to type so much code, ie, Range(Cells(1, 1), Cells(5, 3)) is A1:C5 and allows looping over both row and column. The transpose is a simpler solution if that&#39;s what you are trying to do."}, {"owner": {"reputation": 37, "user_id": 7082735, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/764236e966798d69a9f26fbcfde92892?s=128&d=identicon&r=PG&f=1", "display_name": "JBB", "link": "https://stackoverflow.com/users/7082735/jbb"}, "edited": false, "score": 0, "creation_date": 1479841967, "post_id": 40638758, "comment_id": 68725565, "body": "hi Zediiiii , Thank you for the comment! It&#39;s running on 32 bit Excel, and it&#39;s 39 KB. So the size probably isn&#39;t the issue? Could you think of another reason?"}, {"owner": {"reputation": 37, "user_id": 7082735, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/764236e966798d69a9f26fbcfde92892?s=128&d=identicon&r=PG&f=1", "display_name": "JBB", "link": "https://stackoverflow.com/users/7082735/jbb"}, "edited": false, "score": 0, "creation_date": 1479843775, "post_id": 40638758, "comment_id": 68726477, "body": "So I tried it a few more times. The original Excel model works, and the macro also works. But whenever I saved as a new copy, it would crash when I open and enable macro. Thanks !"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 7082735, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/764236e966798d69a9f26fbcfde92892?s=128&d=identicon&r=PG&f=1", "display_name": "JBB", "link": "https://stackoverflow.com/users/7082735/jbb"}, "edited": false, "score": 0, "creation_date": 1479322140, "post_id": 40639028, "comment_id": 68511996, "body": "Thank you for your help! AnotherMacro should be ok; it has been in the Excel model for a long time now. It seems to work better when I run the macro in the original model. But once I save another copy of the model with the macro, it tends to crash easily. The file is 39,000 KB, maybe that&#39;s why?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 37, "user_id": 7082735, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/764236e966798d69a9f26fbcfde92892?s=128&d=identicon&r=PG&f=1", "display_name": "JBB", "link": "https://stackoverflow.com/users/7082735/jbb"}, "edited": false, "score": 0, "creation_date": 1479327417, "post_id": 40639028, "comment_id": 68514970, "body": "It&#39;s impossible to say whether that&#39;s the cause, but 39MB is pretty large."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1479318957, "creation_date": 1479318957, "answer_id": 40639028, "question_id": 40638758, "link": "https://stackoverflow.com/questions/40638758/excel-crashing-after-adding-macro/40639028#40639028", "title": "Excel crashing after adding Macro", "body": "<p>As John notes your code could be more concise:</p>\n\n<pre><code>Sub PlanRelativityTesting()\n    With Sheets(\"Sheet1\")\n        For i = 8 To 9\n            .Range(\"D11\").Value = .Range(\"G\" &amp; i).Value\n            AnotherMacro\n            .Range(\"H\" &amp; i).Resize(1, 12).Value = _\n            Application.Transpose(Sheets(\"Sheet2\").Range(\"AE20\").Resize(12, 1).Value)\n        Next i\n        .Select\n    End With\nEnd Sub\n</code></pre>\n\n<p>The actual issue though is more likely to be in <code>AnotherMacro</code></p>\n"}], "owner": {"reputation": 37, "user_id": 7082735, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/764236e966798d69a9f26fbcfde92892?s=128&d=identicon&r=PG&f=1", "display_name": "JBB", "link": "https://stackoverflow.com/users/7082735/jbb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 40639028, "answer_count": 1, "score": 0, "last_activity_date": 1507720326, "creation_date": 1479318067, "last_edit_date": 1507720326, "question_id": 40638758, "link": "https://stackoverflow.com/questions/40638758/excel-crashing-after-adding-macro", "title": "Excel crashing after adding Macro", "body": "<p>I added a simple Macro to my Excel, but it seems to make my Excel crash a lot. Does anyone know why? </p>\n\n<p>Here's the macro:</p>\n\n<pre><code>Sub PlanRelativityTesting()\nWith Sheets(\"Sheet1\")\nFor i = 8 To 9\n.Range(\"D11\").value = .Range(\"G\" &amp; i).value          \nCall AnotherMacro  \nSheets(\"Sheet2\").Select    \n        .Range(\"H\" &amp; i).value = Sheets(\"Sheet2\").Range(\"AE20\").value\n        .Range(\"I\" &amp; i).value = Sheets(\"Sheet2\").Range(\"AE21\").value\n        .Range(\"J\" &amp; i).value = Sheets(\"Sheet2\").Range(\"AE22\").value\n        .Range(\"K\" &amp; i).value = Sheets(\"Sheet2\").Range(\"AE23\").value\n        .Range(\"L\" &amp; i).value = Sheets(\"Sheet2\").Range(\"AE24\").value\n        .Range(\"M\" &amp; i).value = Sheets(\"Sheet2\").Range(\"AE25\").value\n        .Range(\"N\" &amp; i).value = Sheets(\"Sheet2\").Range(\"AE26\").value\n        .Range(\"O\" &amp; i).value = Sheets(\"Sheet2\").Range(\"AE27\").value\n        .Range(\"P\" &amp; i).value = Sheets(\"Sheet2\").Range(\"AE28\").value\n        .Range(\"Q\" &amp; i).value = Sheets(\"Sheet2\").Range(\"AE29\").value\n        .Range(\"R\" &amp; i).value = Sheets(\"Sheet2\").Range(\"AE30\").value\n        .Range(\"S\" &amp; i).value = Sheets(\"Sheet2\").Range(\"AE31\").value\nNext i       \n.Select   \nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "filter", "autofilter"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 7158105, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/91fe23dc63898e32b90fbd561badc2aa?s=128&d=identicon&r=PG&f=1", "display_name": "thegreataus", "link": "https://stackoverflow.com/users/7158105/thegreataus"}, "edited": false, "score": 0, "creation_date": 1479324095, "post_id": 40638762, "comment_id": 68513119, "body": "Thanks!  When I try that, it says I get a &quot;run time error &#39;424&#39;: Object required&quot; and in debug mode it highlights the &quot;.autofiltermode = False&quot; line..."}, {"owner": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "reply_to_user": {"reputation": 29, "user_id": 7158105, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/91fe23dc63898e32b90fbd561badc2aa?s=128&d=identicon&r=PG&f=1", "display_name": "thegreataus", "link": "https://stackoverflow.com/users/7158105/thegreataus"}, "edited": false, "score": 0, "creation_date": 1479324443, "post_id": 40638762, "comment_id": 68513319, "body": "That hasn&#39;t changed from your original code... Has the nickname Sheet3 changed by any chance? What if you refer to the sheet by name instead..."}, {"owner": {"reputation": 29, "user_id": 7158105, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/91fe23dc63898e32b90fbd561badc2aa?s=128&d=identicon&r=PG&f=1", "display_name": "thegreataus", "link": "https://stackoverflow.com/users/7158105/thegreataus"}, "edited": false, "score": 0, "creation_date": 1479327210, "post_id": 40638762, "comment_id": 68514850, "body": "Ah, yes.  I was using a slightly modified copy with only one sheet to experiment with new code.  That cleaned that up...but not, when I have data in a3 and d3 and run the macro, the screen flashes, brings up a little data for a bit, but then it returns nothing..."}, {"owner": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "reply_to_user": {"reputation": 29, "user_id": 7158105, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/91fe23dc63898e32b90fbd561badc2aa?s=128&d=identicon&r=PG&f=1", "display_name": "thegreataus", "link": "https://stackoverflow.com/users/7158105/thegreataus"}, "edited": false, "score": 0, "creation_date": 1479334626, "post_id": 40638762, "comment_id": 68518761, "body": "Are there definitely rows in the the data that match row 3 exactly? Because that is what the filters are now checking for, so will hide everything else. (That is what you meant by cells A3:J3 being the criteria yes?)"}, {"owner": {"reputation": 29, "user_id": 7158105, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/91fe23dc63898e32b90fbd561badc2aa?s=128&d=identicon&r=PG&f=1", "display_name": "thegreataus", "link": "https://stackoverflow.com/users/7158105/thegreataus"}, "edited": false, "score": 0, "creation_date": 1479336102, "post_id": 40638762, "comment_id": 68519384, "body": "Ah, ok, I may not have been as clear as I probably should have been.  Ideally, each cell in A3:J3 will be some form of a search criteria.  I won&#39;t need all of them filled in order to return results...for example, if only the A cell is filled, which is a &#39;Type of Product&#39;, only that exact Type will be returned.  Then, if you go to G3 and put in what city, it will return the Type of Product in the respective city, with more and more search criteria in each cell.  Right now, does it require each of the cells to be filled out in order for it to return results?"}, {"owner": {"reputation": 29, "user_id": 7158105, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/91fe23dc63898e32b90fbd561badc2aa?s=128&d=identicon&r=PG&f=1", "display_name": "thegreataus", "link": "https://stackoverflow.com/users/7158105/thegreataus"}, "edited": false, "score": 0, "creation_date": 1479396177, "post_id": 40638762, "comment_id": 68548558, "body": "Holy moly, that works like a charm.  May I ask where you learned all this??  I would like to be able to do some of this on my own...I&#39;ve been learning python and I see a lot of similarity with the different If/Then statements, indentation, etc, so I think I&#39;m on the right path.  Thank you so much though bobajob!"}, {"owner": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "reply_to_user": {"reputation": 29, "user_id": 7158105, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/91fe23dc63898e32b90fbd561badc2aa?s=128&d=identicon&r=PG&f=1", "display_name": "thegreataus", "link": "https://stackoverflow.com/users/7158105/thegreataus"}, "edited": false, "score": 0, "creation_date": 1479398591, "post_id": 40638762, "comment_id": 68550388, "body": "Glad it helped. As for how I learned this - a bit of logic and lots of googling! I&#39;m sure you&#39;ll pick it up soon enough."}, {"owner": {"reputation": 29, "user_id": 7158105, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/91fe23dc63898e32b90fbd561badc2aa?s=128&d=identicon&r=PG&f=1", "display_name": "thegreataus", "link": "https://stackoverflow.com/users/7158105/thegreataus"}, "edited": false, "score": 0, "creation_date": 1479399175, "post_id": 40638762, "comment_id": 68550808, "body": "Haha, I guess.  I&#39;m probably going to post a slightly related question to the solution you just provided, but it adds a bit of a twist into the search function I need, involving dates and trying to do all the above filter functions, but also throwing in pulling in products manufactured in between two dates."}, {"owner": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "reply_to_user": {"reputation": 29, "user_id": 7158105, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/91fe23dc63898e32b90fbd561badc2aa?s=128&d=identicon&r=PG&f=1", "display_name": "thegreataus", "link": "https://stackoverflow.com/users/7158105/thegreataus"}, "edited": false, "score": 0, "creation_date": 1479399572, "post_id": 40638762, "comment_id": 68551076, "body": "Sure, though as always, have a stab at it yourself first. This site should really be a last resort after all your efforts (including much googling) have failed."}, {"owner": {"reputation": 29, "user_id": 7158105, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/91fe23dc63898e32b90fbd561badc2aa?s=128&d=identicon&r=PG&f=1", "display_name": "thegreataus", "link": "https://stackoverflow.com/users/7158105/thegreataus"}, "edited": false, "score": 0, "creation_date": 1479400218, "post_id": 40638762, "comment_id": 68551489, "body": "I agree.  I&#39;ve searched for a ton of this stuff and I&#39;m failing to link more complicated search functions together.  I&#39;ve been able to do small individual searches in autofilter, but connecting them all together has been challenging. The date search function throws in a huge monkey wrench :-/"}], "tags": [], "owner": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "is_accepted": true, "score": 0, "last_activity_date": 1479376621, "last_edit_date": 1479376621, "creation_date": 1479318087, "answer_id": 40638762, "question_id": 40638429, "link": "https://stackoverflow.com/questions/40638429/creating-a-multiple-field-search-function-in-excel-vba/40638762#40638762", "title": "Creating a multiple field search function in excel VBA", "body": "<p>For the function to work if either A3 or D3 are not empty, then you can concatenate the two cells and compare that to vbNullString.</p>\n\n<p>For the multiple filters, you can use a loop to set them all.</p>\n\n<p>eg:</p>\n\n<pre><code>Sub FilterTo1Criteria()\n    Dim i As Long\n    With Sheet3\n    If Range(\"A3\") &amp; Range(\"D3\") &lt;&gt; vbNullString Then\n            .AutoFilterMode = False\n            .Range(\"A6:J1015\").AutoFilter\n            For i = 1 To 10\n                .Range(\"A6:J1015\").AutoFilter Field:=i, Criteria1:=Cells(3, i)\n            Next i\n        Else\n            Selection.AutoFilter\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<p><strong>Edit:</strong> </p>\n\n<p>It looks like you wanted to set the filters as the criteria cells were filled, rather than all at once. Try this instead:</p>\n\n<pre><code>Sub FilterTo1Criteria()\n    Dim i As Long\n    With Sheet3\n        .AutoFilterMode = False\n        .Range(\"A6:J1015\").AutoFilter\n        For i = 1 To 10\n            If .Cells(3, i) &lt;&gt; vbNullString Then\n                .Range(\"A6:J1015\").AutoFilter Field:=i, Criteria1:=.Cells(3, i)\n            End If\n        Next i\n    End With\nEnd Sub\n</code></pre>\n\n<p>and for the new worksheet change sub:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Range(\"$A$3:$J$3\")) Is Nothing Then\n        Application.EnableEvents = False\n        FilterTo1Criteria\n        Application.EnableEvents = True\n    End If\nEnd Sub\n</code></pre>\n\n<p>This will add or remove filters as you add or remove criteria (row 3).</p>\n"}], "owner": {"reputation": 29, "user_id": 7158105, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/91fe23dc63898e32b90fbd561badc2aa?s=128&d=identicon&r=PG&f=1", "display_name": "thegreataus", "link": "https://stackoverflow.com/users/7158105/thegreataus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 327, "favorite_count": 0, "accepted_answer_id": 40638762, "answer_count": 1, "score": 1, "last_activity_date": 1479376621, "creation_date": 1479317051, "last_edit_date": 1479317406, "question_id": 40638429, "link": "https://stackoverflow.com/questions/40638429/creating-a-multiple-field-search-function-in-excel-vba", "title": "Creating a multiple field search function in excel VBA", "body": "<p>I need to build a linked search function in VBA that also auto-updates after you enter data into the given search fields. I have been able to do this successfully with the following sections of code:</p>\n\n<p>Autofilter search - in a standard module</p>\n\n<p>Code:</p>\n\n<pre><code>Sub FilterTo1Criteria()\nWith Sheet3\n    If Range(\"A3\") &lt;&gt; vbNullString Then\n        .AutoFilterMode = False\n        .Range(\"A6:J1015\").AutoFilter\n        .Range(\"A6:J1015\").AutoFilter Field:=1, Criteria1:=Range(\"A3\")\n    Else\n        Selection.AutoFilter\n    End If\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Sheet change/auto-update - This is in a worksheet module</p>\n\n<p>Code:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Address = \"$A$3\" Then\n        Application.EnableEvents = False\n        FilterTo1Criteria\n        Application.EnableEvents = True\n    End If\nEnd Sub\n</code></pre>\n\n<p>However, within the sheet change page, I need cells A3:J3 to be the criteria, but I also need the auto search function to work if only A3 and D3 are filled in, or if just A3 is filled in (D3 is blank), or if just D3 is filled in (A3 is blank), but I'm having issues trying to compound the code to get this effect. How much more complicated will I have to make it? Are there some examples that someone is aware of that I can look at to glean some information from? It's hard to find any...</p>\n\n<p>A slicer with a pivot table is a potential way to go, but I think some people downstream are using Excel 2003 and I don't think the slicer works back that far.  </p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["excel", "macros", "vba"], "comments": [{"owner": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "edited": false, "score": 0, "creation_date": 1479317031, "post_id": 40638193, "comment_id": 68509060, "body": "For the <b>Specific Problem</b>, have you tried <code>Set worksh = Sheets(Range(&quot;B6&quot;).Value)</code>...?"}], "answers": [{"tags": [], "owner": {"reputation": 315, "user_id": 5822096, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d5ab014cd7c3b58fa8eb2098837aa537?s=128&d=identicon&r=PG&f=1", "display_name": "Tianna Wrona", "link": "https://stackoverflow.com/users/5822096/tianna-wrona"}, "is_accepted": false, "score": 1, "last_activity_date": 1479317102, "creation_date": 1479317102, "answer_id": 40638451, "question_id": 40638193, "link": "https://stackoverflow.com/questions/40638193/vba-excel-defining-a-workbook-and-worksheet-variable-value-from-cell/40638451#40638451", "title": "VBA Excel - Defining a workbook and worksheet variable value from cell", "body": "<p>Try this, it worked for me (as long as the value in the cell is the name of the sheet):</p>\n\n<pre><code>Set worksh = Sheets(Range(\"B6\").Value)\n</code></pre>\n\n<p>The reason why </p>\n\n<pre><code> Set worksh = Range(\"B6\").Value\n</code></pre>\n\n<p>did not work is because now worksh is attempting to be set as a variant. You still need to define it as being a sheet by putting that word and that pair of parenthesis you see in my solution. :)</p>\n"}], "owner": {"reputation": 1, "user_id": 7168616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb36dafa621fdddc381bb55e5f8e270a?s=128&d=identicon&r=PG&f=1", "display_name": "Lee Rosario", "link": "https://stackoverflow.com/users/7168616/lee-rosario"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 964, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479325300, "creation_date": 1479316262, "last_edit_date": 1531164843, "question_id": 40638193, "link": "https://stackoverflow.com/questions/40638193/vba-excel-defining-a-workbook-and-worksheet-variable-value-from-cell", "title": "VBA Excel - Defining a workbook and worksheet variable value from cell", "body": "<p>I have searched for this all day but have not been able to work it out, so hopefully y'all can help :)</p>\n\n<p><strong>Objective:</strong>\nFor a specified sheet in a separate workbook (from which this code is ran), for a list of row numbers in column O, the script should run and highlight all of the corresponding row numbers yellow.</p>\n\n<p><strong>Context:</strong>\nI'm an auditor so we often have to pick random samples from Excel workbooks, with 1000s of rows and then highlight a random selection manually. I'd like to automate this procedure.</p>\n\n<p><strong>Specific problem:</strong>\nHave my loop working and highlighting yellow, but cannot seem to get the variables for the 'target location' for which I want the code to run to work. When I hard-code \"Sheet2\", then it works on Sheet 2. But even if I try just using a cell value as a variable, and in that cell putting \"Sheet2\", it just won't work. I've tried many more ways than what I've included below, but I just tidied up the current code and pasted below.</p>\n\n<p><strong>Details for end deliverable</strong> (all following inputs are in a single-sheet WB, sheet name is called 'Random':\n - User enters a folder location in cell A5\n - User enters a folder location in cell A6\n - User enters a sheet name in cell A7\n - User pastes list of numbers for highlighting into column O\n - The user should then hit 'Highlight samples' button for which the code should then highlight all the row numbers in column O yellow for the target worksheet in target workbook.</p>\n\n<p><strong>Code</strong> (modified from another post):</p>\n\n<pre><code>Sub sample()\n    Dim i As Long, workbk As Workbook, worksh As Worksheet  \n\n    On Error GoTo Whoa\n\n    Application.ScreenUpdating = False\n\n\n    Set worksh = Sheets(\"Sheet2\") 'Hard-coded, this works\n\n    'Set worksh = Range(\"B6\").Value 'Doesn't work\n    'Set worksh = Sheets(Range(\"pickupsheetname\")) 'Doesn't work\n\n\n    With Sheets(\"RandomList\")\n        For i = 1 To 30\n            If Not Len(Trim(.Range(\"O\" &amp; i).Value)) = 0 And _\n            IsNumeric(.Range(\"O\" &amp; i).Value) Then _\n                 worksh.Rows(.Range(\"O\" &amp; i).Value).Interior.ColorIndex = 6 '&lt;~~ Yellow\n        Next i\n    End With\n\nLetsContinue:\n    Application.ScreenUpdating = True\n    Exit Sub\nWhoa:\n    MsgBox Err.Description\n    Resume LetsContinue\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "macros"], "answers": [{"tags": [], "owner": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "is_accepted": true, "score": 1, "last_activity_date": 1479315795, "last_edit_date": 1479315795, "creation_date": 1479314865, "answer_id": 40637690, "question_id": 40637496, "link": "https://stackoverflow.com/questions/40637496/excel-macro-to-if-contains-else/40637690#40637690", "title": "Excel macro to if contains else", "body": "<p>If you just need to trim off the first and last character, then you can use the length of the string in the function parameters:</p>\n\n<pre><code>Worksheets(\"Sheet2\").Cells(TargetRow, targetcolumn + 2).Value = mid(Worksheets(\"Data\").Cells(1, SourceColumn).Value, 2, Len(Worksheets(\"Data\").Cells(1, SourceColumn).Value) - 2)\n</code></pre>\n\n<p>which will work for any length string.</p>\n"}], "owner": {"reputation": 55, "user_id": 2747356, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/869bd51d1814005be4334dff4694a16c?s=128&d=identicon&r=PG&f=1", "display_name": "user2747356", "link": "https://stackoverflow.com/users/2747356/user2747356"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 40637690, "answer_count": 1, "score": 0, "last_activity_date": 1479315795, "creation_date": 1479314340, "question_id": 40637496, "link": "https://stackoverflow.com/questions/40637496/excel-macro-to-if-contains-else", "title": "Excel macro to if contains else", "body": "<p>I have a excel macro to transform columns from one sheet to the new sheet. </p>\n\n<pre><code>Sub Macro1()\n'\n' Macro1 Macro\n'\n\n'\nSheets.Add.Name = \"Sheet2\"\nWorksheets(\"Sheet2\").Cells(1, 1).Value = \"Column A\"\nWorksheets(\"Sheet2\").Cells(1, 2).Value = \"Column B\"\nWorksheets(\"Sheet2\").Cells(1, 3).Value = \"Column C\"\nWorksheets(\"Sheet2\").Cells(1, 4).Value = \"Column D\"\n\nWorksheets(\"data\").Activate\nSourceColumn = 2\nSourceRow = 2\nCells(SourceRow, 1).Activate\nTargetRow = SourceRow\ntargetcolumn = 1\nbatchValue = InputBox(\"Enter value for Batch ID column\")\n\nWhile Cells(1, SourceColumn).Value &lt;&gt; \"\"\n\nWhile ActiveCell.Value &lt;&gt; \"\"\nWorksheets(\"Sheet2\").Cells(TargetRow, 1).Value = batchValue\nWorksheets(\"Sheet2\").Cells(TargetRow, targetcolumn + 1).Value = ActiveCell.Value\nWorksheets(\"Sheet2\").Cells(TargetRow, targetcolumn + 2).Value = Worksheets(\"Data\").Cells(1, SourceColumn).Value\nWorksheets(\"Sheet2\").Cells(TargetRow, targetcolumn + 3).Value = Worksheets(\"Data\").Cells(SourceRow, SourceColumn).Value\nSourceRow = SourceRow + 1\ntargetcolumn = 1\nTargetRow = TargetRow + 1\nCells(SourceRow, 1).Activate\nWend\nSourceColumn = SourceColumn + 1\nSourceRow = 2\nCells(SourceRow, 1).Activate\n\nWend\nWith Worksheets(\"Sheet2\").Sort\n.SetRange Range(Cells(2, 1), Cells(TargetRow, 3))\n        .Header = xlNo\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\nEnd With\n\n\nEnd Sub\n</code></pre>\n\n<p>This works fine but I need to trim parenthesis from \"Column C\" \nIn the While statement, I could successfully trim parenthesis by using mid function by updating the code like below. </p>\n\n<pre><code>Worksheets(\"Sheet2\").Cells(TargetRow, targetcolumn + 2).Value = mid(Worksheets(\"Data\").Cells(1, SourceColumn).Value, 2, 36)\n</code></pre>\n\n<p>But what I found out was that there are some values that has different length which requires.... </p>\n\n<pre><code>mid(Worksheets(\"Data\").Cells(1, SourceColumn).Value, 2, 10)\n</code></pre>\n\n<p>So I need to insert.. </p>\n\n<blockquote>\n  <p>if Column C contains the word \"parent\" then mid ([Column C], 2,10)\n  else mid([Column C],2,36)</p>\n</blockquote>\n\n<p>What will be the easiest way to complete this job? </p>\n\n<p>Thank you!</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1479320069, "creation_date": 1479320069, "answer_id": 40639349, "question_id": 40637421, "link": "https://stackoverflow.com/questions/40637421/listbox-not-showing-in-subform-query-access-2010/40639349#40639349", "title": "Listbox not showing in subform query (Access 2010)", "body": "<p>Drag and drop the fields into the form in design view, and the lookup will follow. Well, <em>usually</em>.</p>\n\n<p>If not, you must change the textbox on the form to a combobox and recreate the settings from the query.</p>\n"}], "owner": {"reputation": 1, "user_id": 7168634, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ppweh54I_YA/AAAAAAAAAAI/AAAAAAAADyg/6jqM_ILf4SM/photo.jpg?sz=128", "display_name": "Jeff Heine", "link": "https://stackoverflow.com/users/7168634/jeff-heine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594023052, "creation_date": 1479314133, "last_edit_date": 1594023052, "question_id": 40637421, "link": "https://stackoverflow.com/questions/40637421/listbox-not-showing-in-subform-query-access-2010", "title": "Listbox not showing in subform query (Access 2010)", "body": "<p>I have a subform that is linked to a query. The query has several fields that are listboxes linked to other queries. The listboxes work as expected in the query itself, but once I use the query in a datasheet subform, the listbox functionality goes away and I am unable to pick from the dropdowns.</p>\n\n<p>Please help!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1479314081, "post_id": 40637196, "comment_id": 68507001, "body": "What you have can produce dupes, so you need to run a dictionary alongside to hold the numbers you&#39;ve selected and repack if selected.  280 out of 280 can be slow narrowing down, the last few, but say 280 of 1000 should be fine"}, {"owner": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "edited": false, "score": 0, "creation_date": 1479314419, "post_id": 40637196, "comment_id": 68507242, "body": "What are you expecting to happen? Authorlist is being populated but not used for anything. Putting <code>Debug.Print Join(Authorlist, &quot;OR&quot;)</code> just before <code>End Sub</code> seems to print out what you want..."}, {"owner": {"reputation": 1, "user_id": 7168538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a144fdddbddced9b884bc5023d911741?s=128&d=identicon&r=PG&f=1", "display_name": "Corrado_", "link": "https://stackoverflow.com/users/7168538/corrado"}, "reply_to_user": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "edited": false, "score": 0, "creation_date": 1479314945, "post_id": 40637196, "comment_id": 68507635, "body": "@bobajob Thanks. I&#39;m new to VBA and finding the syntax very confusing, so not sure what i was expecting. Is it possible to put Authorlist back into the sheet using Join(Authorlist, &quot;OR&quot;) ?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7168538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a144fdddbddced9b884bc5023d911741?s=128&d=identicon&r=PG&f=1", "display_name": "Corrado_", "link": "https://stackoverflow.com/users/7168538/corrado"}, "edited": false, "score": 0, "creation_date": 1479316628, "post_id": 40638014, "comment_id": 68508795, "body": "This is perfect, thank you. I also want to loop this process for the entire author but I will have a go at this myself. Thanks again"}], "tags": [], "owner": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "is_accepted": false, "score": 0, "last_activity_date": 1479315770, "creation_date": 1479315770, "answer_id": 40638014, "question_id": 40637196, "link": "https://stackoverflow.com/questions/40637196/vba-to-extract-names-from-a-list-at-random-isnt-working/40638014#40638014", "title": "VBA to extract names from a list at random isn&#39;t working", "body": "<p>From your comments, you seem to want to concatenate the array of strings, then put it back into excel. This, put just before the <code>End Sub</code>, will put it into cell B1 for example:</p>\n\n<pre><code>ThisWorkbook.Worksheets(\"Sheet1\").Range(\"B1\").Value = Join(Authorlist, \"OR\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1479542679, "post_id": 40639774, "comment_id": 68611009, "body": "@Corrado_, did you get through it?"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 1, "last_activity_date": 1479321480, "creation_date": 1479321480, "answer_id": 40639774, "question_id": 40637196, "link": "https://stackoverflow.com/questions/40637196/vba-to-extract-names-from-a-list-at-random-isnt-working/40639774#40639774", "title": "VBA to extract names from a list at random isn&#39;t working", "body": "<p>this function picks <code>nItemsToPick</code> random elements up from <code>arr</code> array and returns them into an array:</p>\n\n<pre><code>Function PickNRandomElementsFromArray(arr As Variant, nItemsToPick As Long) As Variant\n    Dim arrSize As Long\n    Dim i As Long, iPick As Long\n    Dim temp As String\n\n    arrSize = UBound(arr) '&lt;--| count the values as the array size\n    If nItemsToPick &gt; arrSize Then nItemsToPick = arrSize '&lt;--| the items to be picked cannot exceed array size\n    For i = 1 To nItemsToPick\n        iPick = Int((arrSize - (i - 1)) * Rnd + 1) + (i - 1) '&lt;--| pick a random number between 'i' and 'arrSize'\n\n        ' swap array elements in slots 'i' and 'iPick'\n        temp = arr(iPick)\n        arr(iPick) = arr(i)\n        arr(i) = temp\n    Next i\n    ReDim Preserve arr(1 To nItemsToPick) '&lt;--| resize the array to first picked items\n    PickNRandomElementsFromArray = arr '&lt;--| return the array\nEnd Function\n</code></pre>\n\n<p>which you can exploit as follows:</p>\n\n<pre><code>Option Explicit\n\nSub Authors()\n    Dim Authors As Variant, AuthorsList As Variant\n\n    With ThisWorkbook.Worksheets(\"Sheet\") '&lt;--| reference your relevant worksheet\n        Authors = Application.Transpose(.Range(\"A2\", .Cells(.rows.count, 1).End(xlUp)).Value) '&lt;--| fill 'Authors' array with its column \"A\" values from row 2 down to its last not empty one\n        AuthorsList = PickNRandomElementsFromArray(Authors, 280) '&lt;--| fill 'AuthorsList' array with a selection of 280 random elements of 'Authors'\n        .Range(\"B1\").Value = Join(AuthorsList, \" OR \") '&lt;--| fill cell \"B1\" with a string build by concatenating 'AuthorsList' values delimited with \" OR \"\n    End With\nEnd Sub\n</code></pre>\n\n<p>that can be quite contracted (and made as much less readable) to:</p>\n\n<pre><code>Sub Authors()\n    With ThisWorkbook.Worksheets(\"Sheet\") '&lt;--| reference your relevant worksheet\n        .Range(\"B1\").Value = Join(PickNRandomElementsFromArray(Application.Transpose(.Range(\"A2\", .Cells(.rows.count, 1).End(xlUp)).Value), 280), \" OR \")\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 2, "last_activity_date": 1479323739, "last_edit_date": 1479323739, "creation_date": 1479323422, "answer_id": 40640373, "question_id": 40637196, "link": "https://stackoverflow.com/questions/40637196/vba-to-extract-names-from-a-list-at-random-isnt-working/40640373#40640373", "title": "VBA to extract names from a list at random isn&#39;t working", "body": "<p>Using the below code</p>\n\n<pre><code>Sub PickSample(intSampleSize As Integer, intPicks As Integer)\n    Dim arr() As String\nDim intCounter As Integer\n\nReDim arr(intPicks)\n\nFor intCounter = 0 To UBound(arr)\n    arr(intCounter) = CStr(Int((intSampleSize - (i - 1)) * Rnd + 1) + (i - 1))\nNext intCounter\n\nDebug.Print Join(arr(), \",\")\n\nEnd Sub\n</code></pre>\n\n<p>I ran this on the following, PickSample(10,5) and got the following, showing the duplicate possibilities, this will become less as the difference between picks and samples increases.</p>\n\n<pre><code>9,9,6,10,10,2\n5,3,6,7,2,3\n10,4,5,8,0,6\n9,8,4,10,9,0\n0,8,8,7,0,4\n7,5,6,3,3,8\n</code></pre>\n\n<p>If your selection is 280, but the data set is only 300, dupes still arise</p>\n\n<p><code>PickSample 300,280 \n228,**92**,248,216,269,66,**107**,166,**107**,61,174,189,41,18,190,252,192,127,56,149,292,231,114,145,164,202,11,194,270,102,35,128,232,**107**,124,225,131,216,152,52,83,26,294,85,186,**92**,256,96,239,52,90,21,148,136,179,9,95,40,98,228,188,290,249,166,182,57,271,95,180,179,230,215,206,228,77,165,153,170,84,125,105,292,156,175,139,9,113,41,196,46,59,112,28,185,211,132,126,101,210,64,13,266,13,138,222,227,247,63,141,261,249,123,139,105,75,242,163,162,188,26,214,77,17,82,289,98,194,109,111,98,64,63,127,185,72,206,177,181,23,13,46,74,120,175,86,251,270,158,116,0,75,49,194,295,93,72,264,39,171,182,183,208,255,29,118,247,80,204,119,251,130,251,65,220,270,65,295,290,262,157,195,137,47,193,184,257,110,15,152,16,112,135,89,291,3,195,184,160,8,215,94,295,87,109,96,106,70,178,211,80,173,173,298,280,75,243,231,122,189,148,150,40,291,53,177,205,32,195,222,234,129,24,150,172,17,124,35,43,94,298,181,82,125,141,19,137,131,284,82,52,152,103,154,119,78,20,192,109,164,265,127,178,114,17,32,43,43,228,79,41,12,208,254,155,240,296,157,20,188,99,83\n4,50,49,153,122,31,83,193,255,149,56,269,112,97,232,65,134,71,264,183,112,117,259,176,280,155,99,261,77,78,53,104,0,223,253,83,211,121,244,223,131,23,123,102,213,93,240,45,178,287,73,282,34,296,190,180,271,173,73,258,22,132,228,73,113,119,158,81,174,63,23,269,33,196,271,69,285,254,132,148,231,251,115,58,98,124,45,186,29,61,208,151,55,298,141,1,128,86,226,268,247,53,32,3,45,113,56,294,262,175,219,43,77,8,249,235,238,100,135,167,241,169,61,62,109,172,103,158,128,172,15,164,62,289,280,298,252,123,242,297,77,52,209,5,102,208,33,33,87,120,168,93,88,243,93,113,120,253,123,218,198,122,286,194,155,67,175,225,137,272,85,200,267,84,110,4,88,296,229,174,182,80,152,238,258,28,163,125,22,135,210,150,122,284,296,178,160,185,26,55,85,5,45,126,165,168,235,12,122,17,93,181,155,179,99,273,231,173,129,220,49,17,73,228,286,103,205,238,10,239,145,62,181,273,284,196,4,199,290,2,287,22,88,175,243,12,16,169,94,124,153,220,135,97,22,123,172,229,174,196,243,125,239,217,208,219,57,232,21,74,286,246,66,55,71,278,77,77,215,200,232\n209,294,73,160,32,300,203,4,173,30,31,240,85,13,89,114,90,285,294,120,83,48,49,194,123,124,214,98,190,62,55,175,24,137,272,78,236,114,87,276,190,188,128,29,168,209,275,251,6,163,275,129,204,151,154,139,106,121,81,16,73,294,18,117,109,147,46,142,77,189,163,47,282,197,152,117,32,235,138,226,179,250,5,63,22,31,99,38,0,161,197,163,249,24,57,204,136,107,45,212,279,159,26,228,120,139,148,62,99,28,177,51,279,29,133,82,262,225,82,202,77,27,9,97,237,89,70,144,76,102,13,145,62,260,177,227,279,99,163,24,190,123,289,34,277,186,104,44,144,66,299,39,8,103,164,277,162,122,255,248,202,217,300,102,149,124,209,53,127,163,245,162,128,153,68,186,147,204,266,111,91,88,45,159,67,175,109,263,143,57,205,224,184,235,48,243,60,287,19,18,238,114,139,35,34,52,14,215,160,168,65,140,224,226,120,271,224,26,191,214,4,129,120,82,296,241,209,125,221,83,107,130,284,36,194,104,31,55,23,130,288,163,148,292,65,114,119,84,151,41,155,290,167,273,197,132,208,19,227,210,149,46,67,98,236,15,155,227,241,97,292,242,203,272,263,125,37,287,239,209,120</code></p>\n\n<p>Using a dictionary to handle the dupes, using this code</p>\n\n<pre><code>Sub PickSample(intSampleSize As Integer, intPicks As Integer)\n\nDim dicPicked As New Scripting.Dictionary\nDim arr() As String\nDim intCounter As Integer\nDim intPicked As Integer\nReDim arr(intPicks)\n\nFor intCounter = 0 To UBound(arr)\nRetryPick:\n    intPicked = CStr(Int((intSampleSize - (i - 1)) * Rnd + 1) + (i - 1))\n    If dicPicked.Exists(CStr(intPicked)) Then\n        GoTo RetryPick\n    Else\n        dicPicked.Add CStr(intPicked), 1\n        arr(intCounter) = intPicked\n    End If\nNext intCounter\n\nDebug.Print Join(arr(), \",\")\n\ndicPicked.RemoveAll\nSet dicPicked = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Gives results, hopefully dupe free</p>\n\n<p><code>PickSample 300,280\n203,125,69,114,26,208,39,219,36,174,220,113,24,74,104,282,128,112,223,205,200,147,44,143,152,162,157,300,70,54,108,177,13,276,153,91,7,168,89,145,127,12,16,257,187,229,61,213,117,214,254,171,59,242,23,51,224,52,185,165,193,189,21,296,63,173,160,280,190,232,235,141,256,56,87,98,32,5,267,195,77,120,197,82,288,68,57,136,132,182,122,15,47,48,261,96,110,258,49,105,155,86,186,97,225,80,264,140,11,46,199,230,275,19,34,83,222,66,116,294,298,259,292,271,272,84,115,101,124,43,183,71,289,291,25,188,55,158,150,216,243,92,58,0,290,148,255,149,250,167,27,233,228,265,9,299,65,283,62,88,207,240,109,179,161,178,268,278,175,139,237,234,169,297,269,281,184,262,270,164,202,279,253,295,196,212,8,274,159,75,172,163,130,38,154,73,99,247,249,263,273,67,40,20,221,138,14,33,218,286,227,251,94,166,209,156,211,37,137,90,131,111,107,2,215,85,146,100,293,204,231,285,79,53,126,60,239,260,248,78,4,217,29,64,121,226,201,210,45,206,134,17,1,192,246,3,35,191,236,93,28,41,244,287,129,277,142,118,6,81,18,135,181,241,180,103,50,252,31,95,30\n44,278,132,10,232,56,146,193,284,276,236,155,79,117,102,61,119,200,229,131,138,133,235,173,204,34,7,98,3,202,167,143,130,30,126,206,13,262,221,166,174,298,111,116,39,288,263,76,47,170,89,268,154,253,52,91,217,148,12,22,83,33,77,264,85,214,55,127,279,251,101,86,230,35,172,59,198,62,286,296,220,29,191,242,271,5,54,84,297,158,38,270,231,107,95,110,57,129,9,273,53,269,68,4,234,228,211,207,70,153,151,194,179,128,169,63,142,109,145,58,186,24,245,60,87,0,17,246,225,222,218,184,258,26,161,226,247,31,144,178,223,122,88,124,137,210,293,94,99,213,190,281,80,72,104,40,6,123,290,259,254,45,78,66,227,289,261,141,65,135,8,274,69,257,203,168,196,42,248,67,73,125,37,11,287,181,92,291,238,108,212,1,118,28,216,244,164,249,240,150,46,74,277,36,189,188,255,224,195,260,15,175,267,280,49,180,27,165,50,113,243,201,237,149,205,156,199,292,136,48,71,75,285,41,81,239,209,185,266,160,176,152,171,163,100,2,32,183,16,97,19,294,187,20,282,272,157,182,121,140,106,112,265,295,51,21,256,64,241,114,162,90,252,115,25,82,103,23,299,120,197\n57,241,105,1,247,289,284,72,89,68,101,225,295,242,290,5,291,217,267,87,62,80,24,106,103,38,285,197,286,300,151,222,219,254,201,113,195,245,243,15,179,98,145,192,74,118,142,109,70,58,11,4,154,277,129,115,250,202,293,163,181,168,288,268,281,112,79,49,60,175,236,23,266,186,59,167,190,187,41,228,174,157,48,231,165,253,227,171,66,176,135,238,120,258,19,110,194,164,131,296,91,206,159,255,8,189,124,148,114,13,75,121,95,272,119,214,50,117,279,213,205,133,96,196,137,173,246,218,233,77,27,264,141,184,193,263,102,83,244,210,78,127,36,63,188,42,0,152,198,271,169,298,207,111,3,158,182,282,30,226,199,17,273,297,191,166,46,144,252,55,25,26,200,86,162,237,211,299,212,287,161,12,40,45,69,216,54,125,71,47,132,93,22,20,76,126,51,262,107,229,234,257,2,39,278,235,84,37,280,208,153,251,67,136,104,28,221,149,248,276,170,140,14,269,180,16,108,34,94,43,92,52,204,65,134,85,183,7,146,143,97,270,64,259,139,160,260,223,32,81,177,33,178,185,90,292,9,232,209,265,10,88,283,147,123,99,261,240,6,138,274,122,61,203,249,155,256,44,294,116,35</code></p>\n"}], "owner": {"reputation": 1, "user_id": 7168538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a144fdddbddced9b884bc5023d911741?s=128&d=identicon&r=PG&f=1", "display_name": "Corrado_", "link": "https://stackoverflow.com/users/7168538/corrado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1479323739, "creation_date": 1479313463, "last_edit_date": 1479314116, "question_id": 40637196, "link": "https://stackoverflow.com/questions/40637196/vba-to-extract-names-from-a-list-at-random-isnt-working", "title": "VBA to extract names from a list at random isn&#39;t working", "body": "<p>I want to randomly extract 280 names from a list (dynamic range) of thousands of authors, then concatenate them into 1 string with each name separated by OR.</p>\n\n<p>So far I'm stuck at the first part. When I run the following code, nothing happens. Can anyone explain why? Thanks.</p>\n\n<pre><code>Sub Authors()\n\nDim InputRange As Range\nDim AuthorCount As Long\nDim AuthorRange As Excel.Range\n\nSet InputRange = Range(\"A:A\")\nAuthorCount = Application.WorksheetFunction.CountA(InputRange) - 1\n\nSet AuthorRange = ThisWorkbook.Worksheets(\"Sheet\").Range(\"A2:A\" &amp; AuthorCount)\n\nConst nItemsToPick As Long = 280\n\nDim Authorlist As Variant\nDim i As Long\n\nReDim Authorlist(1 To nItemsToPick)\nFor i = 1 To nItemsToPick\n    Authorlist(i) = AuthorRange.Cells(Int(AuthorCount * Rnd + 1), 1)\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "is_accepted": false, "score": 1, "last_activity_date": 1479313550, "creation_date": 1479313550, "answer_id": 40637226, "question_id": 40637165, "link": "https://stackoverflow.com/questions/40637165/vba-when-no-value-is-found-first-row-is-deleted/40637226#40637226", "title": "VBA: When no value is found, first row is deleted", "body": "<p>Put in a test..</p>\n\n<pre><code>lastRow = ws.Range(\"L\" &amp; ws.Rows.Count).End(xlUp).Row\nIf lastRow = 1 Then\n  Set rng = ws.Range(\"L1:L\" &amp; lastRow)\n\n  With rng\n    .AutoFilter Field:=1, Criteria1:=\"&lt;&gt;*2550*\"\n    .Offset(1, 0).SpecialCells(xlCellTypeVisible).EntireRow.Delete\n  End With\n\n  ws.AutoFilterMode = False\nEnd If\n</code></pre>\n\n<p>If lastRow returns the top row, it won't do the rest.</p>\n"}, {"tags": [], "owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "is_accepted": true, "score": 1, "last_activity_date": 1479315092, "last_edit_date": 1479315092, "creation_date": 1479314010, "answer_id": 40637382, "question_id": 40637165, "link": "https://stackoverflow.com/questions/40637165/vba-when-no-value-is-found-first-row-is-deleted/40637382#40637382", "title": "VBA: When no value is found, first row is deleted", "body": "<p>Another solution is to use the Max function in your last row declaration.  Something like:</p>\n\n<pre><code>lastRow = Application.Max(2,ws.Range(\"L\" &amp; ws.Rows.Count).End(xlUp).Row)\n</code></pre>\n\n<p>Allows you to skip some nesting and IF statements.  </p>\n"}], "owner": {"reputation": 1668, "user_id": 5019691, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93494c08d9bc6418d7a02846a51c5299?s=128&d=identicon&r=PG&f=1", "display_name": "aLearningLady", "link": "https://stackoverflow.com/users/5019691/alearninglady"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 40637382, "answer_count": 2, "score": 1, "last_activity_date": 1479315092, "creation_date": 1479313369, "question_id": 40637165, "link": "https://stackoverflow.com/questions/40637165/vba-when-no-value-is-found-first-row-is-deleted", "title": "VBA: When no value is found, first row is deleted", "body": "<p>I have some code that deletes every row that doesn't contain a key string (in this case \"2550\"). The issue is, if I run the script twice by mistake, it will delete the top row in the worksheet. </p>\n\n<p>See the code below: </p>\n\n<pre><code>Dim ws As Worksheet\nDim rng As Range\nDim lastRow As Long\n\nSet ws = ActiveWorkbook.Sheets(1)\n\nlastRow = ws.Range(\"L\" &amp; ws.Rows.Count).End(xlUp).Row\n\nSet rng = ws.Range(\"L1:L\" &amp; lastRow)\n\nWith rng\n    .AutoFilter Field:=1, Criteria1:=\"&lt;&gt;*2550*\"\n    .Offset(1, 0).SpecialCells(xlCellTypeVisible).EntireRow.Delete\nEnd With\n\nws.AutoFilterMode = False\n</code></pre>\n\n<p>I thought that if there was no row with that key, the AutoFilter would show nothing and therefore nothing should be deleted, but it appears that that is not the case. Could anyone explain why that may be?</p>\n"}, {"tags": ["vba", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 2866, "user_id": 2584786, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KbRVX.jpg?s=128&g=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/2584786/neo"}, "edited": false, "score": 1, "creation_date": 1503941817, "post_id": 45924439, "comment_id": 78807544, "body": "Might I suggest you add some context to your code only answer?"}, {"owner": {"reputation": 75, "user_id": 7441775, "user_type": "registered", "profile_image": "https://graph.facebook.com/1734963146517457/picture?type=large", "display_name": "Thiago Villa", "link": "https://stackoverflow.com/users/7441775/thiago-villa"}, "reply_to_user": {"reputation": 2866, "user_id": 2584786, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KbRVX.jpg?s=128&g=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/2584786/neo"}, "edited": false, "score": 0, "creation_date": 1506197738, "post_id": 45924439, "comment_id": 79725952, "body": "Hum yes sure, but I&#39;m not sure what context you mean. I think it&#39;s self explanatory considering the presented problem"}], "tags": [], "owner": {"reputation": 75, "user_id": 7441775, "user_type": "registered", "profile_image": "https://graph.facebook.com/1734963146517457/picture?type=large", "display_name": "Thiago Villa", "link": "https://stackoverflow.com/users/7441775/thiago-villa"}, "is_accepted": false, "score": 0, "last_activity_date": 1503941344, "creation_date": 1503941344, "answer_id": 45924439, "question_id": 40637066, "link": "https://stackoverflow.com/questions/40637066/how-to-set-all-of-columns-width-in-best-fit-in-vba-access-2010/45924439#45924439", "title": "How to set ALL of columns width in &quot;Best fit&quot; in VBA Access 2010", "body": "<pre><code>Dim f As Object\nSet f = Forms![Contacts]\n' Or Set f = Me.Form\n\nDim c As Control\nFor Each c In f.Controls\n\n    With c\n\n        ' If textbox\n        If .ControlType = acTextBox Then\n\n            ' Adjust to best fit width\n            .ColumnWidth = -2\n        End If\n    End With\nNext c\n\nSet c = Nothing\nSet f = Nothing\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 6329908, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JeqIQ.jpg?s=128&g=1", "display_name": "Kasra", "link": "https://stackoverflow.com/users/6329908/kasra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2559, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1550087690, "creation_date": 1479313043, "last_edit_date": 1550087690, "question_id": 40637066, "link": "https://stackoverflow.com/questions/40637066/how-to-set-all-of-columns-width-in-best-fit-in-vba-access-2010", "title": "How to set ALL of columns width in &quot;Best fit&quot; in VBA Access 2010", "body": "<p>I know for set the column width in best fit for a field with \"Title\" name the below code works:</p>\n\n<pre><code>Private Sub Form_Load()\n\nForms![Contacts]![Title].ColumnWidth = -2\n\nEnd sub\n</code></pre>\n\n<p>is there any solution for ALL columns in datasheet view into one or two lines VBA Code?</p>\n\n<p>Many Thanks ...</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 323, "user_id": 5171347, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10207648253115301/picture?type=large", "display_name": "Gary Dorman", "link": "https://stackoverflow.com/users/5171347/gary-dorman"}, "edited": false, "score": 0, "creation_date": 1479313888, "post_id": 40637112, "comment_id": 68506863, "body": "Hello. I can but I know the code works because i&#39;ve used it before. I&#39;m just making improvements to my macro I have for work."}, {"owner": {"reputation": 1602, "user_id": 5682919, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4rC18.png?s=128&g=1", "display_name": "jsanchezs", "link": "https://stackoverflow.com/users/5682919/jsanchezs"}, "reply_to_user": {"reputation": 323, "user_id": 5171347, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10207648253115301/picture?type=large", "display_name": "Gary Dorman", "link": "https://stackoverflow.com/users/5171347/gary-dorman"}, "edited": false, "score": 0, "creation_date": 1479313974, "post_id": 40637112, "comment_id": 68506923, "body": "@GaryDorman I see, did you put it inside the loop after it opens every file ?, did it show any errors ?"}, {"owner": {"reputation": 323, "user_id": 5171347, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10207648253115301/picture?type=large", "display_name": "Gary Dorman", "link": "https://stackoverflow.com/users/5171347/gary-dorman"}, "edited": false, "score": 0, "creation_date": 1479314022, "post_id": 40637112, "comment_id": 68506961, "body": "Hello. Yes i put it inside the loop and it didn&#39;t show any errors."}, {"owner": {"reputation": 1602, "user_id": 5682919, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4rC18.png?s=128&g=1", "display_name": "jsanchezs", "link": "https://stackoverflow.com/users/5682919/jsanchezs"}, "reply_to_user": {"reputation": 323, "user_id": 5171347, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10207648253115301/picture?type=large", "display_name": "Gary Dorman", "link": "https://stackoverflow.com/users/5171347/gary-dorman"}, "edited": false, "score": 0, "creation_date": 1479314091, "post_id": 40637112, "comment_id": 68507007, "body": "@GaryDorman and you did it after it opened file ?, it&#39;s &quot;save as...&quot; still available ?"}, {"owner": {"reputation": 323, "user_id": 5171347, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10207648253115301/picture?type=large", "display_name": "Gary Dorman", "link": "https://stackoverflow.com/users/5171347/gary-dorman"}, "edited": false, "score": 0, "creation_date": 1479314334, "post_id": 40637112, "comment_id": 68507170, "body": "Yes I placed the code right before I did a save on the file to keep my other changes. I also tried just using the first line you gave me as I don&#39;t want to disable save. Just save as."}, {"owner": {"reputation": 323, "user_id": 5171347, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10207648253115301/picture?type=large", "display_name": "Gary Dorman", "link": "https://stackoverflow.com/users/5171347/gary-dorman"}, "edited": false, "score": 0, "creation_date": 1479314501, "post_id": 40637112, "comment_id": 68507306, "body": "Both Save and Save as were still available."}, {"owner": {"reputation": 1602, "user_id": 5682919, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4rC18.png?s=128&g=1", "display_name": "jsanchezs", "link": "https://stackoverflow.com/users/5682919/jsanchezs"}, "reply_to_user": {"reputation": 323, "user_id": 5171347, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10207648253115301/picture?type=large", "display_name": "Gary Dorman", "link": "https://stackoverflow.com/users/5171347/gary-dorman"}, "edited": false, "score": 0, "creation_date": 1479314604, "post_id": 40637112, "comment_id": 68507380, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/128277/discussion-between-jsanchezs-and-gary-dorman\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 1602, "user_id": 5682919, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4rC18.png?s=128&g=1", "display_name": "jsanchezs", "link": "https://stackoverflow.com/users/5682919/jsanchezs"}, "is_accepted": false, "score": 1, "last_activity_date": 1479313185, "creation_date": 1479313185, "answer_id": 40637112, "question_id": 40636989, "link": "https://stackoverflow.com/questions/40636989/disable-save-as-in-a-batch-of-excel-files/40637112#40637112", "title": "Disable Save As In A Batch Of Excel Files", "body": "<p>Using application object. You just add this lines to the code that loops in every file or workbook so it disable \"save as\" for each one :</p>\n\n<pre><code>Application.CommandBars(\"Worksheet Menu Bar\").Controls(\"File\").Controls(\"Save As...\").Enabled = False \nApplication.CommandBars(\"Worksheet Menu Bar\").Controls(\"File\").Controls(\"Save\").Enabled = False \n</code></pre>\n\n<p>Tell me how it goes.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 7117944, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6b358e34ee1a3ad44353c2e119aebc87?s=128&d=identicon&r=PG&f=1", "display_name": "Dokat", "link": "https://stackoverflow.com/users/7117944/dokat"}, "is_accepted": false, "score": 0, "last_activity_date": 1483416128, "last_edit_date": 1483416128, "creation_date": 1483412819, "answer_id": 41435859, "question_id": 40636989, "link": "https://stackoverflow.com/questions/40636989/disable-save-as-in-a-batch-of-excel-files/41435859#41435859", "title": "Disable Save As In A Batch Of Excel Files", "body": "<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\n    MsgBox \"You can't save this workbook!\"\n    Cancel = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 323, "user_id": 5171347, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10207648253115301/picture?type=large", "display_name": "Gary Dorman", "link": "https://stackoverflow.com/users/5171347/gary-dorman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1492128622, "creation_date": 1479312828, "last_edit_date": 1492128622, "question_id": 40636989, "link": "https://stackoverflow.com/questions/40636989/disable-save-as-in-a-batch-of-excel-files", "title": "Disable Save As In A Batch Of Excel Files", "body": "<p>I've been researching how to disable \"Save As\" in Excel and it seems possible. I have a macro that loops through a bunch of Excel files making changes. In that macro I would like to disable \"Save As\" for all of the files. Is this possible?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1479312707, "post_id": 40636871, "comment_id": 68506046, "body": "You can edit it from a regular workbook if it is installed."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1479313250, "post_id": 40636871, "comment_id": 68506437, "body": "Looks like your add-in isn&#39;t loaded..."}, {"owner": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1479366218, "post_id": 40636871, "comment_id": 68528530, "body": "@Mat&#39;sMug  It seems like it only gets loaded as soon as I click a button that is using the addin"}], "owner": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479366553, "creation_date": 1479312549, "last_edit_date": 1479366553, "question_id": 40636871, "link": "https://stackoverflow.com/questions/40636871/how-to-make-addin-show-up-in-project-explorer", "title": "How to make addin show up in project explorer", "body": "<p>I made my own excel addin, however when I open it \"normal.xlam\" it does not load in the vba editor. How can I make it show up? I would like to edit it:)</p>\n\n<p><a href=\"https://i.stack.imgur.com/xkYaC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xkYaC.png\" alt=\"enter image description here\"></a></p>\n\n<p>The addin is added the normal way:\n<a href=\"https://i.stack.imgur.com/AEOTT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AEOTT.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "memory", "optimization"], "comments": [{"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1479312287, "post_id": 40636533, "comment_id": 68505718, "body": "I would also add at the end of your macro <code>Application.CutCopyMode=False</code> to clear the clipboard."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1479318665, "post_id": 40636533, "comment_id": 68510049, "body": "<a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">Avoid using <code>.Select</code></a>, that can cause slow downs and errant behavior if you&#39;re not careful"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 7167804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e49c25555a738dc381b27cbe16bc0e9?s=128&d=identicon&r=PG&f=1", "display_name": "C_Harris", "link": "https://stackoverflow.com/users/7167804/c-harris"}, "edited": false, "score": 0, "creation_date": 1479314074, "post_id": 40637212, "comment_id": 68506996, "body": "I will give this a go! Only reason why I did not try this previously is that different sheets sometimes require multiple filter criterion and the information gets pasted in different places. The code you pasted above would paste the information into the master report in a vertical list which is fine but I am unsure how to solve the different number of filter criterion issue"}, {"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "reply_to_user": {"reputation": 15, "user_id": 7167804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e49c25555a738dc381b27cbe16bc0e9?s=128&d=identicon&r=PG&f=1", "display_name": "C_Harris", "link": "https://stackoverflow.com/users/7167804/c-harris"}, "edited": false, "score": 0, "creation_date": 1479314278, "post_id": 40637212, "comment_id": 68507128, "body": "If that is the case you can just define a different filter criteria depending on the sheet name <code>If arrSht = &quot;NCR&#39;s&quot; Then PartNumberWildCard = *something for this sheet*</code>"}, {"owner": {"reputation": 15, "user_id": 7167804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e49c25555a738dc381b27cbe16bc0e9?s=128&d=identicon&r=PG&f=1", "display_name": "C_Harris", "link": "https://stackoverflow.com/users/7167804/c-harris"}, "edited": false, "score": 0, "creation_date": 1479314813, "post_id": 40637212, "comment_id": 68507550, "body": "It isnt that the partnumber changes, its that the defined fields for the autofiltering change. For example in NCR i only filter in field 2, but in PO&#39;s I filter in field 2 &amp; 3"}, {"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "reply_to_user": {"reputation": 15, "user_id": 7167804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e49c25555a738dc381b27cbe16bc0e9?s=128&d=identicon&r=PG&f=1", "display_name": "C_Harris", "link": "https://stackoverflow.com/users/7167804/c-harris"}, "edited": false, "score": 0, "creation_date": 1479389062, "post_id": 40637212, "comment_id": 68543119, "body": "You can modify that clip to be for your fields instead of the PartNumberWildCard"}], "tags": [], "owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "is_accepted": false, "score": 2, "last_activity_date": 1479314000, "last_edit_date": 1479314000, "creation_date": 1479313503, "answer_id": 40637212, "question_id": 40636533, "link": "https://stackoverflow.com/questions/40636533/macro-running-out-of-memory-when-run-twice/40637212#40637212", "title": "Macro Running Out Of Memory When Run Twice", "body": "<p>There are a couple of tips to speed up your macro and make it use less memory (less selecting, copying pasting). For a start it would be better to loop through your sheets rather than one long script for every one.</p>\n\n<pre><code>Dim arrShts As Variant, arrSht As Variant\narrShts = Array(\"NCR's\", \"CR's\", \"PO's\")\nFor Each arrSht In arrShts\n    Worksheets(arrSht).Activate\n    'rest of your code'\nNext arrSht\n</code></pre>\n\n<p>In the array add any other sheets you need to run the script on</p>\n\n<p>Declaring variables is recommended also:</p>\n\n<pre><code>Dim masterws As Worksheet\nSet masterws = Sheets(\"Master Report\")\n\nmasterws.Activate\nmasterws.Range(\"A1\").Formula = PartNumber\n</code></pre>\n\n<p>I haven't been able to do this 100% accurately, but you could limit your code  down to something like the following</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\nCancel = True\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\nColumn = Target.Column\nRow = Target.Row\n\nPartNumber = Cells(Row, 2).Value 'capture target part number for filtering\nPartDesc = Cells(Row, 7).Value 'capture target part description\nPartNumberWildCard = \"*\" &amp; PartNumber &amp; \"*\" 'add wildcards to allow for additional terms\n\nDim arrShts As Variant, arrSht As Variant, lastrw As Integer\nDim masterws As Worksheet\nSet masterws = Sheets(\"Master Report\")\n\nmasterws.Cells.Clear 'clear old master report\narrShts = Array(\"NCR's\", \"CR's\", \"PO's\")\n\nFor Each arrSht In arrShts\n    Worksheets(arrSht).Activate\n    lastrw = Sheets(arrSht).Range(\"K\" &amp; Rows.Count).End(xlUp).Row\n    With Worksheets(arrSht) 'filter NCR sheet\n        On Error Resume Next\n        ActiveSheet.ShowAllData 'remove any previous filters\n        On Error GoTo 0\n        .Range(\"A1\").AutoFilter Field:=2, Criteria1:=PartNumberWildCard\n    End With\n\n    Range(Cells(3, 1), Cells(lastrw, 11)).Copy\n    lastRow = Sheets(\"Master Report\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    masterws.Activate\n    masterws.Range(\"A1\").Formula = PartNumber\n    masterws.Range(\"D1\").Formula = PartDesc 'Print part no. &amp; description at top of master report\n    masterws.Range(\"A\" &amp; lastRow).PasteSpecial xlPasteValues\n    masterws.Range(\"A\" &amp; lastRow - 1 &amp; \":H\" &amp; lastRow - 1).Select\n    Call Merge\n    ActiveCell.FormulaR1C1 = arrSht\n    Application.CutCopyMode = False\nNext arrSht\n\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>This is in no way complete, and will edit as I find bits, but a good place to start to reduce the strain of your macro.</p>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 7167804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e49c25555a738dc381b27cbe16bc0e9?s=128&d=identicon&r=PG&f=1", "display_name": "C_Harris", "link": "https://stackoverflow.com/users/7167804/c-harris"}, "edited": false, "score": 0, "creation_date": 1479392038, "post_id": 40638347, "comment_id": 68545377, "body": "Hi, this seemed to work great! I dont quite understand whats going on in the FilterandPaste sub. It doesnt paste my headers into the master report. Also how would I modify it so that it would search for the part number in the PO&#39;s sheet in field 2 or 3?"}, {"owner": {"reputation": 15, "user_id": 7167804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e49c25555a738dc381b27cbe16bc0e9?s=128&d=identicon&r=PG&f=1", "display_name": "C_Harris", "link": "https://stackoverflow.com/users/7167804/c-harris"}, "edited": false, "score": 0, "creation_date": 1479392322, "post_id": 40638347, "comment_id": 68545596, "body": "I figured out how to include headers but am still unsure as to this section of the code:   <code>If Application.WorksheetFunction.Subtotal(103, .Resize(, 1)) &gt; 1 Then                 .Resize(.Rows.Count - 1).SpecialCells(XlCellType.xlCellTypeVisible).Copy Destination:=targetCell                 With targetCell.Offset(-1).Resize(, .Columns.Count)</code>"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1479316760, "creation_date": 1479316760, "answer_id": 40638347, "question_id": 40636533, "link": "https://stackoverflow.com/questions/40636533/macro-running-out-of-memory-when-run-twice/40638347#40638347", "title": "Macro Running Out Of Memory When Run Twice", "body": "<p>try this refactoring of your code</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, cancel As Boolean)\n    Dim iRow As Long\n    Dim PartNumber As String, PartDesc As String, PartNumberWildCard As String\n    Dim masterSht As Worksheet\n\n    Set masterSht = Worksheets(\"Master Report\")\n\n    cancel = True\n    iRow = Target.Row\n\n    PartNumber = Cells(iRow, 2).Value 'capture target part number for filtering\n    PartDesc = Cells(iRow, 7).Value 'capture target part description\n    PartNumberWildCard = \"*\" &amp; PartNumber &amp; \"*\" 'add wildcards to allow for additional terms\n\n    'clear old master report and write headers\n    With masterSht\n        .Cells.ClearContents\n        .Cells.UnMerge\n        .Range(\"A1\").Value = PartNumber\n        .Range(\"D1\").Value = PartDesc 'Print part no. &amp; description at top of master report\n\n        FilterAndPaste \"NCR's\", \"K1\", 2, PartNumberWildCard, .Range(\"A4\")\n\n        FilterAndPaste \"CR's\", \"F1\", 3, PartNumberWildCard, .Range(\"P4\")\n\n        FilterAndPaste \"PO's\", \"H1\", 2, PartNumberWildCard, .Cells(rows.count, \"A\").End(xlUp).Offset(3)\n    End With\nEnd Sub\n\n\nSub FilterAndPaste(shtName As String, lastHeaderAddress As String, fieldToFilter As Long, criteria As String, targetCell As Range)\n    With Worksheets(shtName)\n        .AutoFilterMode = False 'remove any previous filters\n        With .Range(lastHeaderAddress, .Cells(.rows.count, 1).End(xlUp))\n            .AutoFilter Field:=fieldToFilter, Criteria1:=criteria\n            If Application.WorksheetFunction.Subtotal(103, .Resize(, 1)) &gt; 1 Then\n                .Resize(.rows.count - 1).Offset(1).SpecialCells(XlCellType.xlCellTypeVisible).Copy Destination:=targetCell\n                With targetCell.Offset(-1).Resize(, .Columns.count)\n                    Merge .Cells\n                    .Value = shtName\n                End With\n            End If\n        End With\n    End With\nEnd Sub\n\nPrivate Sub Merge(rng As Range)\n    With rng\n        .HorizontalAlignment = xlCenter\n        .VerticalAlignment = xlBottom\n        .Merge\n    End With\nEnd Sub\n</code></pre>\n\n<p>should it work for you, as it did in my tests, then I can add you some info, if you care about</p>\n"}], "owner": {"reputation": 15, "user_id": 7167804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e49c25555a738dc381b27cbe16bc0e9?s=128&d=identicon&r=PG&f=1", "display_name": "C_Harris", "link": "https://stackoverflow.com/users/7167804/c-harris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 671, "favorite_count": 0, "accepted_answer_id": 40638347, "answer_count": 2, "score": 1, "last_activity_date": 1479316760, "creation_date": 1479311741, "question_id": 40636533, "link": "https://stackoverflow.com/questions/40636533/macro-running-out-of-memory-when-run-twice", "title": "Macro Running Out Of Memory When Run Twice", "body": "<p>I am new to this forum but have been reading a large number of posts recently as I am currently self teaching VBA for use at work!</p>\n\n<p>I currently am having an issue with a bit of code that I have created. The aim of the code is to autofilter multiple sheets depending on a cell value that is double clicked on, it then copies these filtered results to another \"Master Report\" sheet. The issue is that it runs perfectly fine once, after which if I try to run it again or any of my other macro's within the workbook an error pops up asking me to close things to free up memory!</p>\n\n<p>I have tried running the macro once, saving and closing the workbook (to clear anything that might be cached), re-opening and running and yet the same error persists. I also tried changing my .select prompts with .activate as suggested by:</p>\n\n<p><a href=\"http://www.mrexcel.com/forum/excel-questions/475218-how-avoid-running-out-memory-while-running-visual-basic-applications.html\" rel=\"nofollow noreferrer\">How to avoid running out of memory when running VBA </a></p>\n\n<p>but that seemed to break my code... then again I may have just implemented it wrong as I am a bit of a VBA noob  Can anyone help me optimize my code to prevent this?</p>\n\n<p>my code is as below:</p>\n\n<pre><code>Private Sub Merge()\nWith Selection\n        .HorizontalAlignment = xlCenter\n        .VerticalAlignment = xlBottom\n    End With\n    Selection.Merge\nEnd Sub\n\n-------------------------------------------------------------------------------------------------------------------------------------------------------\n\nPrivate Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n    Cancel = True\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\nSheets(\"Master Report\").Cells.Delete 'clear old master report\nColumn = Target.Column\nRow = Target.Row\n\n'this automatically filters information for a single part and creates a new master report with summary information\nPartNumber = Cells(Row, 2).Value 'capture target part number for filtering\nPartDesc = Cells(Row, 7).Value 'capture target part description\nPartNumberWildCard = \"*\" &amp; PartNumber &amp; \"*\" 'add wildcards to allow for additional terms\n    With Worksheets(\"NCR's\") 'filter NCR sheet\n        .Select\n        On Error Resume Next\n        ActiveSheet.ShowAllData 'remove any previous filters\n        On Error GoTo 0\n        .Range(\"A1\").AutoFilter Field:=2, Criteria1:=PartNumberWildCard\n    End With\nSheets(\"NCR's\").Select\nSheets(\"NCR's\").Range(\"A3:K3\").Select\nSheets(\"NCR's\").Range(Selection, Selection.End(xlDown)).Select 'select NCR filtered summary info\nSelection.Copy\nSheets(\"Master Report\").Select\nSheets(\"Master Report\").Range(\"A1\").Formula = PartNumber\nSheets(\"Master Report\").Range(\"D1\").Formula = PartDesc 'Print part no. &amp; description at top of master report\nSheets(\"Master Report\").Range(\"A4\").Select\nActiveSheet.Paste 'paste filtered NCR info into master report\nSheets(\"Master Report\").Range(\"A3:K3\").Select\nCall Merge\nActiveCell.FormulaR1C1 = \"NCR's\"\n\nWith Worksheets(\"CR's\") 'filter CR sheet\n        .Select\n        On Error Resume Next\n        ActiveSheet.ShowAllData 'remove any previous filters\n        On Error GoTo 0\n        .Range(\"A1\").AutoFilter Field:=3, Criteria1:=PartNumberWildCard\n    End With\nSheets(\"CR's\").Select\nSheets(\"CR's\").Range(\"A7:F7\").Select\nSheets(\"CR's\").Range(Selection, Selection.End(xlDown)).Select\nSelection.Copy\nSheets(\"Master Report\").Select\nSheets(\"Master Report\").Range(\"P4\").Select\nActiveSheet.Paste\nSheets(\"Master Report\").Range(\"RP3:U3\").Select\nCall Merge\nActiveCell.FormulaR1C1 = \"CR's\"\n\nWith Worksheets(\"PO's\") 'filter PO sheet\n        .Select\n        On Error Resume Next\n        ActiveSheet.ShowAllData 'remove any previous filters\n        On Error GoTo 0\n        .Range(\"A1\").AutoFilter Field:=2, Criteria1:=PartNumberWildCard\n    End With\nSheets(\"PO's\").Select\nSheets(\"PO's\").Range(\"A3:H3\").Select\nSheets(\"PO's\").Range(Selection, Selection.End(xlDown)).Select\nSelection.Copy\nSheets(\"Master Report\").Select\nlastRow = Sheets(\"Master Report\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nlastRow = lastRow + 3\nSheets(\"Master Report\").Range(\"A\" &amp; lastRow).Select\nActiveSheet.Paste\nSheets(\"Master Report\").Range(\"A\" &amp; lastRow - 1 &amp; \":H\" &amp; lastRow - 1).Select\nCall Merge\nActiveCell.FormulaR1C1 = \"PO's\"\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>Another piece of info that may help is that I tried removing the last of the three filter/copy/paste routines, this allowed me to run the code about 3 times before running into the same memory error. Also the Debugger always gets stuck on the command to clear the master report at the beginning of the macro</p>\n\n<pre><code>Sheets(\"Master Report\").Cells.Delete 'clear old master report\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 192, "user_id": 7042797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85fcda9c59b304092899595847c28287?s=128&d=identicon&r=PG&f=1", "display_name": "Nulled", "link": "https://stackoverflow.com/users/7042797/nulled"}, "is_accepted": false, "score": 0, "last_activity_date": 1479312525, "creation_date": 1479312525, "answer_id": 40636860, "question_id": 40636170, "link": "https://stackoverflow.com/questions/40636170/word-vba-help-insert-carriage-return-after-images/40636860#40636860", "title": "Word VBA help- Insert carriage return after images", "body": "<p>An awful solution, but I thought I'd post it anyway:</p>\n\n<p>I added a button to the document which I want to perform the action on. I then assigned the following macro to the button:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim pic As InlineShape\n\n\nFor Each pic In ActiveDocument.InlineShapes\n    pic.Select\n    Selection.EscapeKey\n    SendKeys \"{down}\"\n    Selection.Text = Chr(13)\nNext\n\nEnd Sub\n</code></pre>\n\n<p>This selects each image, escapes the selection. Moves to the next line with a keypress (though, I'm sure this can be done 'programmatically') and then inserts a carriage return.</p>\n\n<p>Please treat this as an idea, i'm sure the method above can break in many, many ways.</p>\n"}, {"tags": [], "owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "is_accepted": false, "score": 0, "last_activity_date": 1479313251, "last_edit_date": 1479313251, "creation_date": 1479312590, "answer_id": 40636890, "question_id": 40636170, "link": "https://stackoverflow.com/questions/40636170/word-vba-help-insert-carriage-return-after-images/40636890#40636890", "title": "Word VBA help- Insert carriage return after images", "body": "<p>Instead of adding one or several carriage return after images, consider the following:</p>\n\n<ol>\n<li><p>define a style in your document, similar to the ones normally used for headings (see the image below) that has the attributes you want for your <code>InlineShapes</code>, or their paragraphs more precisely. For example</p>\n\n<ul>\n<li>centered</li>\n<li>with a 18pt spacing below the \"paragraph\"</li>\n</ul></li>\n<li><p>save your style as <code>yourStyleFormat</code></p></li>\n<li><p>adjust your code in a similar fashion</p>\n\n<pre><code>Dim pic As Word.InlineShape\n\nFor Each pic In ActiveDocument.InlineShapes\n    With pic\n        .LockAspectRatio = msoFalse\n        .Height = InchesToPoints(3.33)\n        .Width = InchesToPoints(4.44)\n        .Select\n        Selection.Style = ActiveDocument.Styles(\"yourStyleFormat\")\n    End With\nNext\n</code></pre></li>\n</ol>\n\n<p>Pros: </p>\n\n<ul>\n<li>this doesn't add empty rows to your document, which is a no-no</li>\n<li>you can edit the general layout of all your pictures by simply editing the style</li>\n</ul>\n\n<p>Cons:</p>\n\n<ul>\n<li>Using <code>Select</code> is ugly. I used it since I couldnt figure out how to apply a <code>.Style</code> to a <code>InlineShape</code>. Therefore, I tread the picture as paragraph by selecting it first. Im sure there's a more elegant way to access the images parent-paragraph.</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/zoFiq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zoFiq.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 7168323, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/883f11bfbb15188bdb552562a0076d42?s=128&d=identicon&r=PG&f=1", "display_name": "marc cerone", "link": "https://stackoverflow.com/users/7168323/marc-cerone"}, "edited": false, "score": 0, "creation_date": 1479499427, "post_id": 40650428, "comment_id": 68600810, "body": "Thank you everyone."}], "tags": [], "owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "is_accepted": true, "score": 0, "last_activity_date": 1479373002, "creation_date": 1479373002, "answer_id": 40650428, "question_id": 40636170, "link": "https://stackoverflow.com/questions/40636170/word-vba-help-insert-carriage-return-after-images/40650428#40650428", "title": "Word VBA help- Insert carriage return after images", "body": "<p>An InlineShape has a Range object that represents its location in the document. Working with this we can improve on Martin's answer with the following:</p>\n\n<pre><code>Dim pic As Word.InlineShape\n\nFor Each pic In ActiveDocument.InlineShapes\n    With pic\n        .LockAspectRatio = msoFalse\n        .Height = InchesToPoints(3.33)\n        .Width = InchesToPoints(4.44)\n        .Range.Style = \"Your Style Name\"\n    End With\nNext\n</code></pre>\n\n<p>Or if you really need to add the extra paragraph:</p>\n\n<pre><code>For Each pic In ActiveDocument.InlineShapes\n    With pic\n        .LockAspectRatio = msoFalse\n        .Height = InchesToPoints(3.33)\n        .Width = InchesToPoints(4.44)\n        .Range.InsertAfter Chr(13)\n    End With\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1508845500, "post_id": 46909219, "comment_id": 80765894, "body": "Thank you for this code snippet, which might provide some limited, immediate help.  A proper explanation <a href=\"//meta.stackexchange.com/q/114762\">would greatly improve</a> its long-term value by showing <i>why</i> this is a good solution to the problem, and would make it more useful to future readers with other, similar questions.  Please <a href=\"https://stackoverflow.com/posts/46909219/edit\">edit</a> your answer to add some explanation, including the assumptions you&#39;ve made."}], "tags": [], "owner": {"reputation": 91, "user_id": 1274477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc3665ae10bd93a77dd344c9bce8b323?s=128&d=identicon&r=PG", "display_name": "Tomal", "link": "https://stackoverflow.com/users/1274477/tomal"}, "is_accepted": false, "score": 0, "last_activity_date": 1508844008, "creation_date": 1508844008, "answer_id": 46909219, "question_id": 40636170, "link": "https://stackoverflow.com/questions/40636170/word-vba-help-insert-carriage-return-after-images/46909219#46909219", "title": "Word VBA help- Insert carriage return after images", "body": "<p>Hope this wil help someone special<br></p>\n\n<pre><code>Sub rezize_center_newline()\n\nDim i As Long\nDim shpIn As InlineShape, shp As Shape\n\nWith ActiveDocument\n    For i = 1 To .InlineShapes.Count\n        With .InlineShapes(i)\n            .Height = InchesToPoints(4)\n            .Width = InchesToPoints(5.32)\n            .Range.InsertAfter Chr(13)\n        End With\n    Next i\n    For Each shpIn In ActiveDocument.InlineShapes\n        shpIn.Select\n        Selection.ParagraphFormat.Alignment = wdAlignParagraphCenter\n    Next shpIn\n    For Each shp In ActiveDocument.Shapes\n        shp.Select\n        Selection.ParagraphFormat.Alignment = wdAlignParagraphCenter\n    Next shp\nEnd With\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5682030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111c7ac72334f6828fa56976992f88df?s=128&d=identicon&r=PG&f=1", "display_name": "gdusil", "link": "https://stackoverflow.com/users/5682030/gdusil"}, "is_accepted": false, "score": 0, "last_activity_date": 1530692753, "creation_date": 1530692753, "answer_id": 51169078, "question_id": 40636170, "link": "https://stackoverflow.com/questions/40636170/word-vba-help-insert-carriage-return-after-images/51169078#51169078", "title": "Word VBA help- Insert carriage return after images", "body": "<p>I just created this macro, and it which works quite well. I repeated the content many times, so that it would do the search and replace on many images. Hope it's useful:</p>\n\n<pre><code>Sub Macro1()\n'\n' Macro1 Macro\n'\n'\n    Selection.Find.ClearFormatting\n    With Selection.Find\n    .Text = \"^g\"\n    .Replacement.Text = \"\"\n    .Forward = True\n    .Wrap = wdFindContinue\n    .Format = False\n    .MatchCase = False\n    .MatchWholeWord = False\n    .MatchWildcards = False\n    .MatchSoundsLike = False\n    .MatchAllWordForms = False\n    End With\nSelection.Find.Execute\nSelection.MoveRight Unit:=wdCharacter, Count:=1\nSelection.TypeParagraph\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 7168323, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/883f11bfbb15188bdb552562a0076d42?s=128&d=identicon&r=PG&f=1", "display_name": "marc cerone", "link": "https://stackoverflow.com/users/7168323/marc-cerone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1929, "favorite_count": 0, "accepted_answer_id": 40650428, "answer_count": 5, "score": 1, "last_activity_date": 1530692753, "creation_date": 1479310779, "last_edit_date": 1479323461, "question_id": 40636170, "link": "https://stackoverflow.com/questions/40636170/word-vba-help-insert-carriage-return-after-images", "title": "Word VBA help- Insert carriage return after images", "body": "<p>I have a bunch of images in a Word doc that I am using the following script to resize.  Is there a way for me to insert a carriage return after each image?  I would ideally need double spacing after each image.  I am using the script below to resize the images.  </p>\n\n<pre><code>Sub ResizePhotos()\n    Dim pic As InlineShape\n\n    For Each pic In ActiveDocument.InlineShapes\n        With pic\n            .LockAspectRatio = msoFalse\n                .Height = InchesToPoints(3.33)\n                .Width = InchesToPoints(4.44)\n        End With\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1479310423, "post_id": 40636000, "comment_id": 68504403, "body": "cint(NumberOfCopies)&gt;=11"}, {"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1479310569, "post_id": 40636000, "comment_id": 68504506, "body": "When I run it the way you have it, it evaluates correctly.  Entering 1 in the input box moves past the if statement as &quot;1&quot; &lt; &quot;11&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 423, "user_id": 6696730, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9739bd34a651dd139cc0e7061dbff95d?s=128&d=identicon&r=PG&f=1", "display_name": "K Pekosh", "link": "https://stackoverflow.com/users/6696730/k-pekosh"}, "is_accepted": false, "score": 2, "last_activity_date": 1479318322, "last_edit_date": 1479318322, "creation_date": 1479310629, "answer_id": 40636125, "question_id": 40636000, "link": "https://stackoverflow.com/questions/40636000/excel-inputbox-how-many-copies-to-print-with-max-number/40636125#40636125", "title": "Excel inputbox how many copies to print with max number", "body": "<p>Putting numbers in quotation marks turns them into a String. Since you want the user to input a number, you should make the following changes:</p>\n\n<pre><code>    Dim NumberOfCopies As Int\nNumberOfCopies = Application.InputBox(\"How many copies do you want to print Must enter 0-10\", Type:=1)\n\nIf NumberofCopies &gt;= 11 Then\n...\n\nIf NumberOfCopies = 0 or NumberOfCopies = \"\" Then\n...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 472, "user_id": 4105679, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b378f63f5898183a8cdbb1f8e17a1b95?s=128&d=identicon&r=PG&f=1", "display_name": "luke", "link": "https://stackoverflow.com/users/4105679/luke"}, "edited": false, "score": 1, "creation_date": 1479314171, "post_id": 40636237, "comment_id": 68507055, "body": "I removed the quotation marks on <code>If NumberOfCopies &gt;= &quot;11&quot; Then</code>   and chanced <code>If NumberOfCopies = &quot;False&quot; Or NumberOfCopies = &quot;0&quot; Then</code>   to <code>If NumberOfCopies = &quot;False&quot; Or NumberOfCopies = &quot;0&quot; Or NumberOfCopies = &quot;&quot; Then</code> so if user clicks ok when input box is empty it does the same thing as entering 0. and it seems to work thanks."}], "tags": [], "owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "is_accepted": true, "score": 2, "last_activity_date": 1479310986, "creation_date": 1479310986, "answer_id": 40636237, "question_id": 40636000, "link": "https://stackoverflow.com/questions/40636000/excel-inputbox-how-many-copies-to-print-with-max-number/40636237#40636237", "title": "Excel inputbox how many copies to print with max number", "body": "<p>Still need to test for the user hitting Cancel...This worked for me when hitting Cancel, or typing in 0, 1, or 11</p>\n\n<pre><code>Prints:\nDim NumberOfCopies As String\nNumberOfCopies = Application.InputBox(\"How many copies do you want to print? Must enter 0-10\", Type:=2)\n\nIf NumberOfCopies = \"False\" Or NumberOfCopies = \"0\" Then\n  'If user hits Cancel, NumberofCopies will be \"False\"\nElse\n  If NumberOfCopies &gt;= \"11\" Then\n    MsgBox \"Max to print is 10 copies\"\n    GoTo Prints\n  Else\n    ActiveSheet.PrintOut Copies:=NumberOfCopies\n  End If\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "is_accepted": false, "score": 1, "last_activity_date": 1479315362, "creation_date": 1479315362, "answer_id": 40637870, "question_id": 40636000, "link": "https://stackoverflow.com/questions/40636000/excel-inputbox-how-many-copies-to-print-with-max-number/40637870#40637870", "title": "Excel inputbox how many copies to print with max number", "body": "<p><code>Type:=2</code> is actually for Text type. You are working with numbers, so you should set it as <code>Type:=1</code>. With that, if the user enters anything that is not a number, it will automatically pop up a message \"Number is not valid\" (no scripting effort required for that).  </p>\n\n<p>You should also avoid using Position labels whenever you can. Your code could be easily scripted with <code>Do...While</code> loops.  </p>\n\n<p>As already pointed out, when working with numbers, do not use them enclosed in double quotes, or VBA will treat them as String (which is not what you want).  </p>\n\n<p>@Rdster brought a good point for when user hits \"Cancel\" button. When that occurs, the value of your variable will be \"False\"(a String), so you should look for that either.</p>\n\n<p>With all of that being said, I believe your code would work better like this:</p>\n\n<pre><code>'ASKS HOW MANY COPIES TO PRINT\nDim NumberOfCopies As String\nDo\n    NumberOfCopies = Application.InputBox(\"How many copies do you want to print? Must enter 0-10\", Type:=1)\n    If NumberOfCopies = \"False\" Then Exit Sub   ' If user clicks on Cancel button\n    If NumberOfCopies &gt; 10 Then\n        MsgBox \"Max to print is 10 copies\"\n    End If\nLoop While NumberOfCopies &gt; 10    'although producing the same result, it is cleaner to compare with 10, than to &gt;=11\n\n'Avoid leaving blank conditions. Work with what you have.\n'Everything that doesn't match your conditions will be skipped anyways.\nIf NumberOfCopies &gt; 0 And NumberOfCopies &lt; 10 Then\n    ActiveSheet.PrintOut copies:=NumberOfCopies\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 472, "user_id": 4105679, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b378f63f5898183a8cdbb1f8e17a1b95?s=128&d=identicon&r=PG&f=1", "display_name": "luke", "link": "https://stackoverflow.com/users/4105679/luke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 806, "favorite_count": 0, "accepted_answer_id": 40636237, "answer_count": 3, "score": 2, "last_activity_date": 1479318322, "creation_date": 1479310270, "question_id": 40636000, "link": "https://stackoverflow.com/questions/40636000/excel-inputbox-how-many-copies-to-print-with-max-number", "title": "Excel inputbox how many copies to print with max number", "body": "<p>I need a inputbox to ask how many copies to print with a max number allowed to be enter.</p>\n\n<p>I have the below code but which works but if i enter more than \"1\" it triggers the<br>\n<code>If NumberOfCopies &gt;= \"11\" Then</code> and if i click the cancel button it also triggers the same thing</p>\n\n<pre><code>'ASKS HOW MANY COPIES TO PRINT\nPRINTS:\nDim NumberOfCopies As String\nNumberOfCopies = Application.InputBox(\"How many copies do you want to print? Must enter 0-10\", Type:=2)\n\nIf NumberOfCopies &gt;= \"11\" Then\nMsgBox \"Max to print is 10 copies\"\nGoTo PRINTS\nEnd If\n\nIf NumberOfCopies = \"0\" Or NumberOfCopies = \"\" Then\n'do not print\nElse\nActiveSheet.PrintOut Copies:=NumberOfCopies\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "reply_to_user": {"reputation": 67, "user_id": 6770993, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/XHGV2.jpg?s=128&g=1", "display_name": "mrkrister", "link": "https://stackoverflow.com/users/6770993/mrkrister"}, "edited": false, "score": 0, "creation_date": 1479372385, "post_id": 40637732, "comment_id": 68531839, "body": "That is a separate question and frankly you are asking SO to write code for you. Can you show what exactly you have tried to achieve this?"}], "tags": [], "owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "is_accepted": false, "score": 0, "last_activity_date": 1479314990, "creation_date": 1479314990, "answer_id": 40637732, "question_id": 40635867, "link": "https://stackoverflow.com/questions/40635867/update-import-image-with-user-input/40637732#40637732", "title": "Update/import image with user input", "body": "<p>Try this code</p>\n\n<pre><code>Sub OpenImg()\n    Dim strFile\n    strFile = Application.GetOpenFilename(Title:=\"Selct an image\", FileFilter:=\"Picture Files (*.gif;*.jpg;*.jpeg;*.bmp),*.gif;*.jpg;*.jpeg;*.bmp\", MultiSelect:=False)\n    If strFile = False Then\n        MsgBox \"No file selected.\", vbExclamation, \"Meh!\"\n        Exit Sub\n    Else\n        ActiveSheet.Pictures.Insert(strFile).Select\n        With Selection.ShapeRange\n            .LockAspectRatio = msoTrue\n            .Width = ThisWorkbook.Application.Width - 75\n        End With\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 6770993, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/XHGV2.jpg?s=128&g=1", "display_name": "mrkrister", "link": "https://stackoverflow.com/users/6770993/mrkrister"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479314990, "creation_date": 1479309889, "last_edit_date": 1531164843, "question_id": 40635867, "link": "https://stackoverflow.com/questions/40635867/update-import-image-with-user-input", "title": "Update/import image with user input", "body": "<p>I want the user to simply, with a button, select a picture from his or hers computer without having to resize or move it.\nInstead of the path maybe an \"import image dialog\" or what it\u00b4s called.\nThe picture size ratio should be locked but still fit the page in width. </p>\n\n<p>I\u00b4ve tried to modify this whithout any progress.</p>\n\n<p><code>ActiveSheet.Shapes.Range(Array(\"Rectangle 1\")).Select\n    With Selection.ShapeRange.Fill\n        .Visible = msoTrue\n        .UserPicture \"C:\\...\"\n        .TextureTile = msoFalse\n        .RotateWithObject = msoTrue\n    End With</code></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1479311700, "post_id": 40635849, "comment_id": 68505300, "body": "All you&#39;re doing is coloring cells? You could do this with conditional formatting  <code>=AND(A$7&lt;&gt;&quot;Z&quot;,A7=&quot;V&quot;)</code>  Why does this have to be VBA?"}, {"owner": {"reputation": 864, "user_id": 408041, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1facd2cbcb9021b5a740593940e1ae78?s=128&d=identicon&r=PG", "display_name": "user408041", "link": "https://stackoverflow.com/users/408041/user408041"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1479311877, "post_id": 40635849, "comment_id": 68505423, "body": "Several people use it and formatting is then also copied. With Vba it might be a bit more fool proof."}], "answers": [{"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1479312086, "post_id": 40636249, "comment_id": 68505562, "body": "this will only look in row 7, not every 7th row, like row 14, 21, so you need to add a loop to it...."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1479312125, "post_id": 40636249, "comment_id": 68505590, "body": "@ShaiRado I don&#39;t think OP wants to look in every 7th row, only needs to look at row 7."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1479312157, "post_id": 40636249, "comment_id": 68505625, "body": "@tigeravatar in that case, I went too far with my code below :)"}], "tags": [], "owner": {"reputation": 16, "user_id": 7070633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713a1c8ea9547c528548aaa5694d5bd8?s=128&d=identicon&r=PG&f=1", "display_name": "JoseS", "link": "https://stackoverflow.com/users/7070633/joses"}, "is_accepted": true, "score": 0, "last_activity_date": 1479311019, "creation_date": 1479311019, "answer_id": 40636249, "question_id": 40635849, "link": "https://stackoverflow.com/questions/40635849/excel-vba-exclude-column/40636249#40636249", "title": "Excel VBA Exclude column", "body": "<p>I think this is what you are looking for:</p>\n\n<pre><code>If Not Cell(7, CurCell.Column).Value = \"Z\" Then\n  'Your code\nEnd If\n</code></pre>\n\n<p>This statement should check the cell in the row 7 and the column of CurCell is not Z</p>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1479311454, "creation_date": 1479311454, "answer_id": 40636427, "question_id": 40635849, "link": "https://stackoverflow.com/questions/40635849/excel-vba-exclude-column/40636427#40636427", "title": "Excel VBA Exclude column", "body": "<p>If I understood you correctly, you want to exclude all rows that are weekends, and have \"Z\", so basically you are looking to find every 7th row. You could use something like the code below:</p>\n\n<pre><code>Option Explicit\n\nSub TestEverySevenRow()\n\nDim CurCell As Range\n\nFor Each CurCell In ActiveWorkbook.ActiveSheet.Range(\"A7:G41, J7:NI41\")\n\n    ' current row is divided by 7, therefore it's a weekend\n    If CurCell.Row Mod 7 = 0 Then\n\n        ' for debug purpose only\n        CurCell.Value = \"Current Row divided by 7\"\n\n        ' the rest of your code goes here\n\n    End If\n\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 864, "user_id": 408041, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1facd2cbcb9021b5a740593940e1ae78?s=128&d=identicon&r=PG", "display_name": "user408041", "link": "https://stackoverflow.com/users/408041/user408041"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 811, "favorite_count": 0, "accepted_answer_id": 40636249, "answer_count": 2, "score": 0, "last_activity_date": 1479311454, "creation_date": 1479309819, "last_edit_date": 1531161705, "question_id": 40635849, "link": "https://stackoverflow.com/questions/40635849/excel-vba-exclude-column", "title": "Excel VBA Exclude column", "body": "<p>I have a planning scheme in excel with VBA. In the sheet I have all the days. I look for a code and color the cell. But I would like to exclude the weekends coded with 'z' in the file. \nI have this now:</p>\n\n<pre><code>  Dim CurCell As Object\n  For Each CurCell In ActiveWorkbook.ActiveSheet.Range(\"A7:G41, J7:NI41\")\n\n        If UCase(CurCell.Value) = \"V\" Then\n            CurCell.Interior.Color = RGB(0, 204, 0)         ' V\n End If   \n\n  Next\n</code></pre>\n\n<p>But this works on all the cells. \nI would like to do something like: </p>\n\n<pre><code>if Not CurCell.Rows(7) = Z Then\n</code></pre>\n\n<p>And then check for V. So that if CurCell is at row i and column j, I check if column j at row 7 contains a z.   But I don't know how to do this. \nI could exclude all the columns but that are 52 columns..</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1602, "user_id": 5682919, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4rC18.png?s=128&g=1", "display_name": "jsanchezs", "link": "https://stackoverflow.com/users/5682919/jsanchezs"}, "edited": false, "score": 0, "creation_date": 1479312882, "post_id": 40635784, "comment_id": 68506161, "body": "Do you need to run the same sql insertion in that sub or create a different record with that data in another table ?"}, {"owner": {"reputation": 193, "user_id": 5695578, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/akgRP.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/5695578/chris"}, "reply_to_user": {"reputation": 1602, "user_id": 5682919, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4rC18.png?s=128&g=1", "display_name": "jsanchezs", "link": "https://stackoverflow.com/users/5682919/jsanchezs"}, "edited": false, "score": 0, "creation_date": 1479326501, "post_id": 40635784, "comment_id": 68514461, "body": "The SQL inserts are all going to one table."}, {"owner": {"reputation": 1602, "user_id": 5682919, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4rC18.png?s=128&g=1", "display_name": "jsanchezs", "link": "https://stackoverflow.com/users/5682919/jsanchezs"}, "edited": false, "score": 0, "creation_date": 1479333648, "post_id": 40635784, "comment_id": 68518312, "body": "I know, what i mean is that if you need to run this same code everytime user clicks another sheet"}], "answers": [{"comments": [{"owner": {"reputation": 193, "user_id": 5695578, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/akgRP.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/5695578/chris"}, "edited": false, "score": 0, "creation_date": 1479327725, "post_id": 40636177, "comment_id": 68515162, "body": "Is there a way to add this to my existing code where the current worksheet open is inserted to my SQL table?"}, {"owner": {"reputation": 192, "user_id": 7042797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85fcda9c59b304092899595847c28287?s=128&d=identicon&r=PG&f=1", "display_name": "Nulled", "link": "https://stackoverflow.com/users/7042797/nulled"}, "reply_to_user": {"reputation": 193, "user_id": 5695578, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/akgRP.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/5695578/chris"}, "edited": false, "score": 0, "creation_date": 1479374056, "post_id": 40636177, "comment_id": 68532872, "body": "<code>Application.ActiveSheet.Name</code> returns the name of the current <b>active</b> worksheet. You could add a field to your database for the worksheet name and when your sub <code>UpdateTable()</code> is ran; insert <code>Application.ActiveSheet.Name</code>"}, {"owner": {"reputation": 192, "user_id": 7042797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85fcda9c59b304092899595847c28287?s=128&d=identicon&r=PG&f=1", "display_name": "Nulled", "link": "https://stackoverflow.com/users/7042797/nulled"}, "reply_to_user": {"reputation": 193, "user_id": 5695578, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/akgRP.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/5695578/chris"}, "edited": false, "score": 0, "creation_date": 1479374400, "post_id": 40636177, "comment_id": 68533142, "body": "I&#39;m not too sure how peer reviewing works, however, I edited your question to show an example of the above. Every time the code is run the active worksheet is inserted into your database along with the username, computer name and timestamp."}], "tags": [], "owner": {"reputation": 192, "user_id": 7042797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85fcda9c59b304092899595847c28287?s=128&d=identicon&r=PG&f=1", "display_name": "Nulled", "link": "https://stackoverflow.com/users/7042797/nulled"}, "is_accepted": false, "score": 0, "last_activity_date": 1479310809, "creation_date": 1479310809, "answer_id": 40636177, "question_id": 40635784, "link": "https://stackoverflow.com/questions/40635784/how-do-i-determine-timestamp-when-each-excel-sheet-is-selected/40636177#40636177", "title": "How do I determine timestamp when each excel sheet is selected", "body": "<p>I'm not too sure if I'm oversimplifying this but from what I understand:</p>\n\n<p>Add the <code>UpdateTable()</code> sub to a Module. Add a <code>Worksheet_Activate()</code> event to each worksheet you want to run <code>UpdateTable()</code>.</p>\n\n<p>When the worksheet is selected the <code>UpdateTable()</code> sub will run, which will add the username, computer name and timestamp to your database. It may be worth adding the worksheet name (if you're looking to run this across multiple worksheets)</p>\n\n<p>Therefore, when a worksheet is selected you could add the <code>Application.ActiveSheet.Name</code> and any other values (timestamp, user, etc) to the database.</p>\n"}], "owner": {"reputation": 193, "user_id": 5695578, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/akgRP.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/5695578/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1479310809, "creation_date": 1479309608, "question_id": 40635784, "link": "https://stackoverflow.com/questions/40635784/how-do-i-determine-timestamp-when-each-excel-sheet-is-selected", "title": "How do I determine timestamp when each excel sheet is selected", "body": "<p>My code I've written so far takes the username, computername and current datetime and writes it to a SQL table. What I want to do is capture when different sheets are selected and the timestamp associated with each. </p>\n\n<pre><code>Sub UpdateTable()\n\nDim cnn As ADODB.Connection\nDim uSQL As String\nDim strText As String\nDim strDate As Date\nDim strUsername As String\nDim strComputerName As Variant\n\nstrUsername = Environ(\"username\")\nstrComputerName = Environ(\"Computername\")\nstrDate = Now\n\nSet cnn = New Connection\ncnnstr = \"Provider=SQLOLEDB; \" &amp; _\n        \"Data Source=icl-analive; \" &amp; _\n        \"Initial Catalog=DW_ALL;\" &amp; _\n        \"User ID=dw_all_readonlyuser;\" &amp; _\n        \"Trusted_Connection=Yes;\"\n\ncnn.Open cnnstr\n\nuSQL = \"INSERT INTO Audit (UN,CN,DT) VALUES ('\" &amp; strUsername &amp; \"','\" &amp;  strComputerName &amp; \"','\" &amp; strDate &amp; \"');\" ''\n\nDebug.Print uSQL\n\ncnn.Execute uSQL\ncnn.Close\nSet cnn = Nothing\nExit Sub\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1479310006, "post_id": 40635634, "comment_id": 68504092, "body": "Tip: instead of <code>If .Show &lt;&gt; -1 Then GoTo NextCode</code>, you could do <code>If .Show = -1 Then Exit Sub</code> and avoid <code>GoTo</code> and the line label."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 7128770, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/8e6292870f82eef0aa108354c89eaff3?s=128&d=identicon&r=PG&f=1", "display_name": "Bhushan K", "link": "https://stackoverflow.com/users/7128770/bhushan-k"}, "edited": false, "score": 0, "creation_date": 1479332106, "post_id": 40636187, "comment_id": 68517566, "body": "How do I name the file using the information I collect from user in a form and time stamp and save the csv in a folder of choice?"}], "tags": [], "owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "is_accepted": false, "score": 0, "last_activity_date": 1479368562, "last_edit_date": 1479368562, "creation_date": 1479310821, "answer_id": 40636187, "question_id": 40635634, "link": "https://stackoverflow.com/questions/40635634/how-to-save-a-given-range-in-excel-as-csv/40636187#40636187", "title": "How to save a given range in excel as csv?", "body": "<p>That's a rather playful approach. Maybe not too practical, I also suspect this to be rather slow with large amounts of data.</p>\n\n<p>However: if you make use of recordsets in other parts of your routine, this might be worth looking into. </p>\n\n<pre><code>Option Explicit\n\nSub ExportRange()\n\n    Dim mytxt As String\n    Dim fld As Object\n\n    With GetRecordset(ThisWorkbook.Sheets(2).UsedRange)\n\n        For Each fld In .Fields\n            mytxt = mytxt &amp; fld.Name &amp; \";\"\n        Next fld\n\n        mytxt = mytxt &amp; vbNewLine\n\n        While Not .EOF\n            For Each fld In .Fields\n                mytxt = mytxt &amp; fld.Value &amp; \";\"\n            Next fld\n            mytxt = mytxt &amp; vbNewLine\n            .movenext\n        Wend\n\n        Debug.Print mytxt\n\n    End With\n\n    Open ThisWorkbook.Path &amp; \"\\test.csv\" For Binary Access Write As #1\n        Put #1, , mytxt\n    Close #1\n\nEnd Sub\n</code></pre>\n\n<p>It utilizes this function for reading ranges (<code>.UsedRange</code> in my example) into recordsets, without having to define ADODB-references and setting up a DB-Connection:</p>\n\n<pre><code>Function GetRecordset(rng As Range) As Object\n    'https://usefulgyaan.wordpress.com/2013/07/11/vba-trick-of-the-week-range-to-recordset-without-making-connection/\n\n    Dim xlXML As Object\n    Dim rst As Object\n\n    Set rst = CreateObject(\"ADODB.Recordset\")\n    Set xlXML = CreateObject(\"MSXML2.DOMDocument\")\n    xlXML.LoadXML rng.Value(xlRangeValueMSPersistXML)\n\n    rst.Open xlXML\n    Set GetRecordset = rst\nEnd Function\n</code></pre>\n\n<p>Edit:</p>\n\n<p><code>Open ThisWorkbook.Path &amp; \"\\test.csv\" For Binary Access Write As #1</code> creates the file (if it doesnt exist) and opens it.</p>\n\n<p>Obviously, you can use something like\n<code>MyPath &amp; \"\\test' &amp; format(now, \"yyyymmdd_hhmmss\") &amp; \".csv\"</code>\ninstead to use a File with timestamp in the folder you picked with the FolderPicker</p>\n"}], "owner": {"reputation": 37, "user_id": 7128770, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/8e6292870f82eef0aa108354c89eaff3?s=128&d=identicon&r=PG&f=1", "display_name": "Bhushan K", "link": "https://stackoverflow.com/users/7128770/bhushan-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 410, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1479368562, "creation_date": 1479309186, "question_id": 40635634, "link": "https://stackoverflow.com/questions/40635634/how-to-save-a-given-range-in-excel-as-csv", "title": "How to save a given range in excel as csv?", "body": "<p>I have data in excel columns and I want to extract first 7 columns and save it in another csv file. The file name would be in a particular format basis the information I collect from user using a form and other details such as time-stamp.</p>\n\n<p>I am using the following code: </p>\n\n<pre><code>With Application.FileDialog(msoFileDialogFolderPicker)\n    .Title = \"Select a Folder\"\n    .AllowMultiSelect = False\n    .InitialFileName = \"\" '&lt;~~ The start folder path for the file picker.\n    If .Show &lt;&gt; -1 Then GoTo NextCode\n    MyPath = .SelectedItems(1) &amp; \"\\\"\nEnd With\n\nNextCode:\n\n    With ActiveWorkbook\n        .SaveAs Filename:=MyPath &amp; MyFileName, FileFormat:=xlCSV, CreateBackup:=False\n        Application.DisplayAlerts = False\n        ThisWorkbook.CheckCompatibility = False\n       .Close False\n    End With\n</code></pre>\n\n<p>But this writes all the columns in the output CSV and also closes the open xls (which I don't want to close). </p>\n"}, {"tags": ["arrays", "excel", "vba", "performance", "populate"], "comments": [{"owner": {"reputation": 38606, "user_id": 23771, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NeuGc.jpg?s=128&g=1", "display_name": "Mike Dunlavey", "link": "https://stackoverflow.com/users/23771/mike-dunlavey"}, "edited": false, "score": 0, "creation_date": 1479568410, "post_id": 40635622, "comment_id": 68618219, "body": "It&#39;s really hard to understand your question, but performance of loops is the last thing you should worry about."}], "answers": [{"tags": [], "owner": {"reputation": 1661, "user_id": 7168098, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10211116238159507/picture?type=large", "display_name": "JFerro", "link": "https://stackoverflow.com/users/7168098/jferro"}, "is_accepted": false, "score": 0, "last_activity_date": 1496818774, "last_edit_date": 1496818774, "creation_date": 1496817394, "answer_id": 44405217, "question_id": 40635622, "link": "https://stackoverflow.com/questions/40635622/populate-an-array-without-a-loop/44405217#44405217", "title": "Populate an array without a loop", "body": "<p>I found the answer.</p>\n\n<pre><code>dim myRange as range\ndim myArray() as variant\nmyRange = range(cells(2,3),cells(10,15))\nredeem myArray(1 to 20,1 to 20)\nmyArray=myRange\n</code></pre>\n\n<p>It's always much faster to work with variables and arrays than with cells values.</p>\n"}], "owner": {"reputation": 1661, "user_id": 7168098, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10211116238159507/picture?type=large", "display_name": "JFerro", "link": "https://stackoverflow.com/users/7168098/jferro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1532, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574719253, "creation_date": 1479309155, "last_edit_date": 1574719253, "question_id": 40635622, "link": "https://stackoverflow.com/questions/40635622/populate-an-array-without-a-loop", "title": "Populate an array without a loop", "body": "<p>I am trying to <strong>avoid the use of loops for populating arrays</strong> since they take a lot of time when managing a lot of data.</p>\n\n<p>Apparently as well, that is possible and easy in VBA but often results in problems.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>sub populate()\n'put the whole column in an array\nDim AppArray() As Variant\nDim AppRange As Range\n'calculate the last row of the column 1 of sheets\nDim LstRow As Integer\nLstRow = Sheets(\"whole\").Cells(Sheets(\"whole\").Rows.Count, \"A\").End(xlUp).row\n'here I calculate the range that I want to pass to the array\nSet AppRange = Sheets(\"whole\").Range(Cells(1, 1), Cells(LstRow, 1))\nMsgBox (\"apprange \" &amp; AppRange.Address)\n'i dont know if I need to redim or not\nReDim AppArray(1 To LstRow)\n'here comes the point. populate the array with the values of the range\nAppArray = AppRange.Value\nEnd Sub\n</code></pre>\n\n<p>This does not work. I also tried <code>application.tranpose(AppRange.Value)</code>.</p>\n\n<p>I used:</p>\n\n<pre><code>For i = 1 To LstRow\nDebug.Print AppArray(i)\nNext\n</code></pre>\n\n<p>and an error appears, so somehow there is no <code>AppArray(1)</code>.</p>\n\n<p>I would be very happy if you can comment on that. More than just arranging the code suggest even other pages (links) to populate arrays with values of ranges when these ranges are not known in advance.</p>\n\n<p>If the case is that looping is very time consuming and that arrays can be populated straight away, I don't understand why 99% of the pages referring to arrays use a loop (or nested loop) to populate an array.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1479309264, "post_id": 40635437, "comment_id": 68503535, "body": "Can you add after <code>LR = ...</code> the following code <code>MsgBox LR</code> and report what its calculating for that variable?"}, {"owner": {"reputation": 31, "user_id": 6835996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d084d58d7a8d906791beaf50c3cd69fe?s=128&d=identicon&r=PG&f=1", "display_name": "FonR", "link": "https://stackoverflow.com/users/6835996/fonr"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1479309392, "post_id": 40635437, "comment_id": 68503629, "body": "Says row 4, which is the correct line for the paste. Well after the offset is used."}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1479309452, "post_id": 40635437, "comment_id": 68503681, "body": "What sheet is the Command button in?"}], "answers": [{"comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1479309582, "post_id": 40635683, "comment_id": 68503785, "body": "I was going in the same direction in that it sounds like OP is not scoping his ranges correctly and when clicking the command button its setting a different default scope than what is expected."}, {"owner": {"reputation": 31, "user_id": 6835996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d084d58d7a8d906791beaf50c3cd69fe?s=128&d=identicon&r=PG&f=1", "display_name": "FonR", "link": "https://stackoverflow.com/users/6835996/fonr"}, "edited": false, "score": 0, "creation_date": 1479309620, "post_id": 40635683, "comment_id": 68503812, "body": "Ah, I needed to specify the sheet, I&#39;m an idiot. Thanks for the help lol. Cheers"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 3, "last_activity_date": 1479309303, "creation_date": 1479309303, "answer_id": 40635683, "question_id": 40635437, "link": "https://stackoverflow.com/questions/40635437/stepping-running-through-code-works-however-using-command-button-does-not-fun/40635683#40635683", "title": "Stepping &amp; Running through code works. However using command button does not function properly", "body": "<p>When you execute:</p>\n\n<pre><code>         LR = Range(\"T\" &amp; Rows.Count).End(xlUp).Row\n</code></pre>\n\n<p>You should tell VBA whether to use <em>Sheets(\"Table\")</em> or <em>Sheets(\"HAA\")</em></p>\n\n<p>same with:</p>\n\n<pre><code> If Range(\"A1\").Value &lt;&gt; \"Notes\" Then\n If Range(\"A1\").Value = \"Notes\" Then\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6835996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d084d58d7a8d906791beaf50c3cd69fe?s=128&d=identicon&r=PG&f=1", "display_name": "FonR", "link": "https://stackoverflow.com/users/6835996/fonr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 40635683, "answer_count": 1, "score": 0, "last_activity_date": 1479309303, "creation_date": 1479308665, "question_id": 40635437, "link": "https://stackoverflow.com/questions/40635437/stepping-running-through-code-works-however-using-command-button-does-not-fun", "title": "Stepping &amp; Running through code works. However using command button does not function properly", "body": "<p>Stepping through the code or using the Run Sub/UserForm button, the code functions as intended. However, when I use the Command button (which has the macro assigned to) the code pastes the data over the pre-existing data instead of apending.</p>\n\n<pre><code>Sub Testing()\n\n    Application.ScreenUpdating = False\n\n    Dim tt As Range\n    Dim tt2 As Range\n    Dim LR As Long\n\n    Set tt = ThisWorkbook.Sheets(\"Table\").UsedRange\n    Set tt2 = ThisWorkbook.Sheets(\"HAA\").UsedRange\n\n    LR = Range(\"T\" &amp; Rows.Count).End(xlUp).Row\n\n    tt.AutoFilter\n    tt.AutoFilter 12, \"already associated\"\n\n    If Range(\"A1\").Value &lt;&gt; \"Notes\" Then\n        tt.Copy\n        tt2.Range(\"B1\").PasteSpecial xlPasteValues\n        tt2.Range(\"A1\").Value = \"Notes\"\n    Else\n        If Range(\"A1\").Value = \"Notes\" Then\n            tt.Offset(1, 0).Copy\n            With tt2\n                .Range(\"A\" &amp; LR).Offset(1, 1).PasteSpecial xlPasteValues\n            End With\n        End If\n    End If\n\n    With tt2\n        .AutoFilter\n        .Columns.AutoFit\n        .AutoFilter\n    End With\n\n    With tt2.Font\n        .Name = \"Arial\"\n        .Size = 8\n    End With\n\n    Application.ScreenUpdating = True\n\n    Sheets(\"HAA\").Activate\n\n End Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access", "insert-update"], "comments": [{"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1479311662, "post_id": 40635382, "comment_id": 68505269, "body": "You need to post some code or sql."}, {"owner": {"reputation": 89, "user_id": 6720589, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/064a617b7850c15883e31b404a29c724?s=128&d=identicon&r=PG&f=1", "display_name": "Toli", "link": "https://stackoverflow.com/users/6720589/toli"}, "reply_to_user": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1479324097, "post_id": 40635382, "comment_id": 68513122, "body": "Hi. I added my code which is giving an error."}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1479333276, "post_id": 40635382, "comment_id": 68518143, "body": "It works for me. You have not shown the full situation. This may give you some clues <a href=\"http://stackoverflow.com/questions/170578/operation-must-use-an-updatable-query-error-3073-microsoft-access\" title=\"operation must use an updatable query error 3073 microsoft access\">stackoverflow.com/questions/170578/&hellip;</a>"}, {"owner": {"reputation": 89, "user_id": 6720589, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/064a617b7850c15883e31b404a29c724?s=128&d=identicon&r=PG&f=1", "display_name": "Toli", "link": "https://stackoverflow.com/users/6720589/toli"}, "reply_to_user": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1479377376, "post_id": 40635382, "comment_id": 68535322, "body": "I am not sure what I have to show more. Maybe, my select query &quot;tbl_Update&quot; has a &quot;WHERE&quot; clause, is this the case? (as I somehow understood from the link you sent me). But the query is working perfectly. If so, i would much appreciate if you could tell me how to solve it."}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 6720589, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/064a617b7850c15883e31b404a29c724?s=128&d=identicon&r=PG&f=1", "display_name": "Toli", "link": "https://stackoverflow.com/users/6720589/toli"}, "edited": false, "score": 0, "creation_date": 1479378960, "post_id": 40652310, "comment_id": 68536463, "body": "The DB file is in SharePoint, and I have a read-write access to it. The error 3037 is occuring maybe with type of the query. Because I tried it without &quot;Where&quot; Clause, the code working fine, but I have to put this clause as my criteria."}], "tags": [], "owner": {"reputation": 599, "user_id": 2659342, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4b57617779720ced0a3aaff527507490?s=128&d=identicon&r=PG", "display_name": "Poonam", "link": "https://stackoverflow.com/users/2659342/poonam"}, "is_accepted": false, "score": 0, "last_activity_date": 1479378228, "creation_date": 1479378228, "answer_id": 40652310, "question_id": 40635382, "link": "https://stackoverflow.com/questions/40635382/insert-value-from-one-table-to-another-by-pressing-a-button/40652310#40652310", "title": "Insert value from one table to another by pressing a button", "body": "<pre><code>One quite likely reason is that the user running the program doesn't have read-write access to the database file, especially if it is located in program files folder.\n\nSo check the directory and file permissions and modify them if needed. You can also consider changing the location of the database file to another, more easily accessible folder.\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 6720589, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/064a617b7850c15883e31b404a29c724?s=128&d=identicon&r=PG&f=1", "display_name": "Toli", "link": "https://stackoverflow.com/users/6720589/toli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593984170, "creation_date": 1479308536, "last_edit_date": 1593984170, "question_id": 40635382, "link": "https://stackoverflow.com/questions/40635382/insert-value-from-one-table-to-another-by-pressing-a-button", "title": "Insert value from one table to another by pressing a button", "body": "<p>I have a select query called \"tbl_Update\" and a table called \"tbl_A\" in Access DB. I would like to press on on a button, which makes the following: \nlooks in fields \"KW\" and when they match (in this example below, the value \"2016.45\" are matching), then insert the value of \"tbl_update.CA041073p\" into \"tbl_A.CA041073p\". Seems to be very easy, but getting always Errors to do it. Any simple solutions how to do it? Thanks!    </p>\n\n<p>My code is the following and it is giving me the Error 3037:</p>\n\n<pre><code>Public Function Update()\n\n DoCmd.RunSQL \"Update tbl_A INNER JOIN tbl_Update \" &amp; _ \n \"ON tbl_A.KW = tbl_Update.KW \" &amp; _ \n \"SET tbl_A.CA041073p = [tbl_Update].[CA041073p] \"\n\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/wxQ1K.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wxQ1K.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1479310669, "post_id": 40635352, "comment_id": 68504575, "body": "you are looking for <code>1&#47;1&#47;2016</code>, and <code>11&#47;1&#47;2016</code> contains it (starting at the second character)."}, {"owner": {"reputation": 313, "user_id": 7163759, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Lw4Ay.jpg?s=128&g=1", "display_name": "SalvadorVayshun", "link": "https://stackoverflow.com/users/7163759/salvadorvayshun"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1479313028, "post_id": 40635352, "comment_id": 68506266, "body": "Oh wow... So even though I&#39;m using <code>DateSerial</code>, it&#39;s still looking for the closest thing containing the value of &quot;1/1/2016&quot;, regardless of if the date is an exact match or not? It&#39;s almost like <code>.Find</code> is treating the <code>DateSerial</code> output like a string."}], "answers": [{"tags": [], "owner": {"reputation": 313, "user_id": 7163759, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Lw4Ay.jpg?s=128&g=1", "display_name": "SalvadorVayshun", "link": "https://stackoverflow.com/users/7163759/salvadorvayshun"}, "is_accepted": true, "score": 0, "last_activity_date": 1480108080, "creation_date": 1480108080, "answer_id": 40812299, "question_id": 40635352, "link": "https://stackoverflow.com/questions/40635352/dateserial-not-outputting-expected-date/40812299#40812299", "title": "DateSerial Not Outputting Expected Date", "body": "<p>Per Vincent G's comment, the issue was that I was searching for <code>\"1/1/2016\"</code> and <code>\"11/1/2016\"</code> contained that string. It seems to be treating the date as a string, regardless of the <code>DateSerial</code> option. Was able to resolve the issue once I fully understood it. Thank you, Vincent G!</p>\n"}], "owner": {"reputation": 313, "user_id": 7163759, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Lw4Ay.jpg?s=128&g=1", "display_name": "SalvadorVayshun", "link": "https://stackoverflow.com/users/7163759/salvadorvayshun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 40812299, "answer_count": 1, "score": 0, "last_activity_date": 1480108080, "creation_date": 1479308447, "last_edit_date": 1479312900, "question_id": 40635352, "link": "https://stackoverflow.com/questions/40635352/dateserial-not-outputting-expected-date", "title": "DateSerial Not Outputting Expected Date", "body": "<p>I have a bit of VBA code that uses <code>DateSerial</code>, but it is not outputting the suspected results. I was hoping for a bit of an explanation as to why, as I was not expecting the results at all.</p>\n\n<p>My code looks like this:</p>\n\n<pre><code> Set rngTestDate = ThisWorkbook.Worksheets(\"Sheet11\").Range(\"A:A\").Find(DateSerial(Year(TheDate1), 1, 1))\n</code></pre>\n\n<p>And the output looks like this:</p>\n\n<pre><code>?rngTestDate\n11/1/2016 \n?Year(TheDate1)\n2016 \n?DateSerial(Year(TheDate1),1,1)\n1/1/2016 \n</code></pre>\n\n<p>Using the immediate window, <code>Sheet11</code> does not have January 1, 2016 in it; however, it does have January 4, 2016 and also November 1, 2016. I was fully expecting the <code>.Find</code> method to look for 1/1/2016 and if it wasn't found, to be set to <code>Nothing</code>. If it didn't do that, at least find the next available date.<br>\nWhy does the <code>.Find</code> method find November 1, 2016 over January 4, 2016 when it is given the above <code>DateSerial</code> value? Or I guess the better question is: if 1/1/2016 is not found, why does it not set to <code>Nothing</code>?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1479308704, "post_id": 40635305, "comment_id": 68503141, "body": "what is the reference to <code>With .Cells(5, 1)</code> ? what is the previous <code>With</code> you have in your code ? Otherwise, if you use <code>With Sheets(&quot;Sheet1&quot;).Cells(5, 1)</code> for instance, it works fine"}, {"owner": {"reputation": 423, "user_id": 6696730, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9739bd34a651dd139cc0e7061dbff95d?s=128&d=identicon&r=PG&f=1", "display_name": "K Pekosh", "link": "https://stackoverflow.com/users/6696730/k-pekosh"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1479308853, "post_id": 40635305, "comment_id": 68503240, "body": "the full chain is:  <code>With ActiveWorkbook        With .ActiveSheet               With .Cells(5,1)</code>"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1479308963, "post_id": 40635305, "comment_id": 68503321, "body": "I&#39;m skeptical that you didn&#39;t make any inadvertent changes to the code. Compile errors don&#39;t change dynamically. It would help if you gave more context. The answer almost certainly lies with code that you haven&#39;t shown."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 2, "creation_date": 1479309084, "post_id": 40635305, "comment_id": 68503419, "body": "@KPekosh coding tip, try allways setting your <code>Worksheet</code> objects. Like <code>Dim Sht as Worksheet</code>, the set it <code>Set Sht = ThisWorkbook.Sheets(&quot;Sheet1&quot;)</code> , and then just use <code>With Sht.Cells(5, 1)</code>"}, {"owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "edited": false, "score": 0, "creation_date": 1479309132, "post_id": 40635305, "comment_id": 68503448, "body": "By no means an answer, but maybe this can help you pinpoint the problem: <b>i.</b> can you rule out any typos in variable names (did you use <code>Option Explicit</code>)  <b>ii.</b> is there any chance there&#39;s a problem with <code>.Cells(5, 1)</code> (not assigned to a specific worksheet in a specific workbook, like <code>ThisWorkbook.Sheets(1).Cells(5, 1)</code>"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 2, "creation_date": 1479309299, "post_id": 40635305, "comment_id": 68503567, "body": "Look at your 4th line, you are using <code>Year</code> as your variable, <code>Dim Year As Integer</code>"}, {"owner": {"reputation": 423, "user_id": 6696730, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9739bd34a651dd139cc0e7061dbff95d?s=128&d=identicon&r=PG&f=1", "display_name": "K Pekosh", "link": "https://stackoverflow.com/users/6696730/k-pekosh"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1479309355, "post_id": 40635305, "comment_id": 68503602, "body": "@ShaiRado Thank you, I know I should be doing that. I actually have commented out code in that allows this macro to loop through a multitude of these reports, and in that code I have set my Workbook and will be using .Sheets(1), but I have this current setup to test the code and see if I can get the actual meat of the macro to work."}], "answers": [{"comments": [{"owner": {"reputation": 1000, "user_id": 718960, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/3ff758466bce995a03dbc8c2a5249906?s=128&d=identicon&r=PG", "display_name": "theking2", "link": "https://stackoverflow.com/users/718960/theking2"}, "edited": false, "score": 0, "creation_date": 1593594963, "post_id": 40635818, "comment_id": 110833276, "body": "In your defense: VBA should never have you declare a variable with the same name a system function. Certainly not with Option Explicit."}], "tags": [], "owner": {"reputation": 423, "user_id": 6696730, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9739bd34a651dd139cc0e7061dbff95d?s=128&d=identicon&r=PG&f=1", "display_name": "K Pekosh", "link": "https://stackoverflow.com/users/6696730/k-pekosh"}, "is_accepted": true, "score": 3, "last_activity_date": 1479309738, "creation_date": 1479309738, "answer_id": 40635818, "question_id": 40635305, "link": "https://stackoverflow.com/questions/40635305/expected-array-error-when-calling-year-function-in-vba/40635818#40635818", "title": "Expected Array Error when calling Year() function in VBA", "body": "<p>@ShaiRado pointed out that I had set a variable with the name of 'Year'. I am aware that declaring variables with the same name as functions is a big no no; I just had a mental lapse. Changing the variable declaration fixed my problem. Thanks @ShaiRado.</p>\n"}], "owner": {"reputation": 423, "user_id": 6696730, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9739bd34a651dd139cc0e7061dbff95d?s=128&d=identicon&r=PG&f=1", "display_name": "K Pekosh", "link": "https://stackoverflow.com/users/6696730/k-pekosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3591, "favorite_count": 0, "accepted_answer_id": 40635818, "answer_count": 1, "score": 0, "last_activity_date": 1479309738, "creation_date": 1479308308, "last_edit_date": 1479309622, "question_id": 40635305, "link": "https://stackoverflow.com/questions/40635305/expected-array-error-when-calling-year-function-in-vba", "title": "Expected Array Error when calling Year() function in VBA", "body": "<p>Edit 2: THIS HAS BEEN RESOLVED. I made the mistake of declaring a variable with the name 'Year'...</p>\n\n<p>I am trying to get a cell to contain a copyright in a series of reports I deliver, and since the copyright changes with the year, I want to call the Year function to give me the current year so I don't have to update the macro every January. My code in question looks like this:</p>\n\n<pre><code>With .Cells(5, 1)\n            .Value = Chr(169) &amp; \" \" &amp; Year(Date) &amp; \" NCH Marketing Services, Inc\"\n            .Font.Bold = False\n            .Font.Name = \"Arial\"\n            .Font.Size = 11\n        End With\n</code></pre>\n\n<p>When I execute this code, I get the error message \"Compile Error: Expected Array\". The odd thing is, I have tried to run this macro on three separate occasions, and it did not compile the first or third times, but the second time, it ran just fine. I have not made any edits to the code, and I have looked online for syntax/usage of the Year function, and I cannot figure out why this is working sometimes. Is there a way I can implement this in a more reliable fashion?</p>\n\n<p>Edit: Below is the full code</p>\n\n<pre><code>Option Explicit\nSub RGA_Format_Reports()\n\nApplication.ScreenUpdating = False\n\nDim Year As Integer\nDim Quarter As Integer\n\nDim FolderPath As String\nDim FileName As String\nDim WorkBk As Workbook\n\nDim iRows As Integer\nDim iCols As Integer\n\nDim shpTitle As Shape\nDim shpLogo As Shape\n\n\n'Quarter = InputBox(\"Please enter the quarter number for which the reports are being run.\")\n\n'Year = InputBox(\"Please enter the year for which the reports are being run.\")\n\n'FolderPath = \"G:\\Analytical Services\\Internal Client Requests\\NRS\\Scheduled\\\" &amp; Year &amp; \"\\Quarterly RGA Store Alert Reports\\\" &amp; Year &amp; \" Q\" &amp; Quarter &amp; \"\\\"\n\n'FolderPath = \"G:\\Analytical Services\\General Team Folders\\Kyle\\Macro Tests\\RGA Reports\\\"\n\n'FileName = Dir(FolderPath &amp; \"*.xl*\")\n\n'DoWhile FileName &lt;&gt; \"\"\n\n    'Set WorkBk = Workbooks.Open(FolderPath &amp; FileName)\n        'With WorkBk\n\nWith ActiveWorkbook\n\n        With .ActiveSheet\n\n            iRows = .UsedRange.Rows.Count\n            iCols = .UsedRange.Columns.Count\n\n            .Rows.AutoFit\n            .Columns.AutoFit\n\n            .Columns(1).ColumnWidth = 30\n\n\n            ActiveWindow.FreezePanes = False\n            .Range(\"A9\").Select\n            ActiveWindow.FreezePanes = True\n\n            With .Range(.Cells(iRows - 2, 1), .Cells(iRows, 1))\n                .WrapText = False\n                .Font.Name = \"Arial\"\n                .Font.Size = 10\n            End With\n\n\n            With .PageSetup\n                .TopMargin = Application.InchesToPoints(0.25)\n                .BottomMargin = Application.InchesToPoints(0.25)\n                .LeftMargin = Application.InchesToPoints(0.25)\n                .RightMargin = Application.InchesToPoints(0.25)\n                .CenterHorizontally = True\n                .Zoom = False\n                .Orientation = xlLandscape\n                .FitToPagesWide = 1\n                .FitToPagesTall = False\n                .PrintTitleRows = \"$1:$8\"\n            End With\n\n\n            .Range(.Cells(9, 3), .Cells(iRows, 3)).HorizontalAlignment = xlRight\n            .Range(.Cells(iRows - 4, 1), .Cells(iRows - 4, iCols)).Font.Bold = True\n            .Range(.Cells(iRows - 4, 1), .Cells(iRows - 4, iCols)).Interior.Color = RGB(238, 236, 225)\n\n\n            With .Range(.Cells(7, 9), .Cells(7, 12))\n                .Merge\n                .HorizontalAlignment = xlCenter\n                .Font.Bold = True\n                .Font.Name = \"Arial\"\n                .Font.Size = 10\n                .Interior.Color = RGB(238, 236, 225)\n\n                With .Borders(xlEdgeTop)\n                    .LineStyle = xlContinuous\n                    .Weight = xlThick\n                End With\n\n                With .Borders(xlEdgeBottom)\n                    .LineStyle = xlContinuous\n                    .Weight = xlThick\n                End With\n\n                With .Borders(xlEdgeLeft)\n                    .LineStyle = xlContinuous\n                    .Weight = xlThick\n                End With\n\n                With .Borders(xlEdgeRight)\n                    .LineStyle = xlContinuous\n                    .Weight = xlThick\n                End With\n\n                .Value = \"Total Billed\"\n            End With\n\n\n            With .Range(.Cells(7, 13), .Cells(7, 19))\n                .Merge\n                .HorizontalAlignment = xlCenter\n                .Font.Bold = True\n                .Font.Name = \"Arial\"\n                .Font.Size = 10\n                .Interior.Color = RGB(238, 236, 225)\n\n                With .Borders(xlEdgeTop)\n                    .LineStyle = xlContinuous\n                    .Weight = xlThick\n                End With\n\n                With .Borders(xlEdgeBottom)\n                    .LineStyle = xlContinuous\n                    .Weight = xlThick\n                End With\n\n                With .Borders(xlEdgeLeft)\n                    .LineStyle = xlContinuous\n                    .Weight = xlThick\n                End With\n\n                With .Borders(xlEdgeRight)\n                    .LineStyle = xlContinuous\n                    .Weight = xlThick\n                End With\n\n                .Value = \"Total Adjustments\"\n            End With\n\n\n            With .Range(.Cells(8, 1), .Cells(iRows - 4, 8))\n                With .Borders(xlEdgeTop)\n                    .LineStyle = xlContinuous\n                    .Weight = xlThick\n                End With\n\n                With .Borders(xlEdgeBottom)\n                    .LineStyle = xlContinuous\n                    .Weight = xlThick\n                End With\n\n                With .Borders(xlEdgeLeft)\n                    .LineStyle = xlContinuous\n                    .Weight = xlThick\n                End With\n\n                With .Borders(xlEdgeRight)\n                    .LineStyle = xlContinuous\n                    .Weight = xlThick\n                End With\n            End With\n\n\n            With .Range(.Cells(7, 9), .Cells(iRows - 4, 12))\n                With .Borders(xlEdgeTop)\n                    .LineStyle = xlContinuous\n                    .Weight = xlThick\n                End With\n\n                With .Borders(xlEdgeBottom)\n                    .LineStyle = xlContinuous\n                    .Weight = xlThick\n                End With\n\n                With .Borders(xlEdgeLeft)\n                    .LineStyle = xlContinuous\n                    .Weight = xlThick\n                End With\n\n                With .Borders(xlEdgeRight)\n                    .LineStyle = xlContinuous\n                    .Weight = xlThick\n                End With\n            End With\n\n\n            With .Range(.Cells(7, 13), .Cells(iRows - 4, 19))\n                With .Borders(xlEdgeTop)\n                    .LineStyle = xlContinuous\n                    .Weight = xlThick\n                End With\n\n                With .Borders(xlEdgeBottom)\n                    .LineStyle = xlContinuous\n                    .Weight = xlThick\n                End With\n\n                With .Borders(xlEdgeLeft)\n                    .LineStyle = xlContinuous\n                    .Weight = xlThick\n                End With\n\n                With .Borders(xlEdgeRight)\n                    .LineStyle = xlContinuous\n                    .Weight = xlThick\n                End With\n\n            End With\n\n            If .Cells(9, 4) = 0 Then\n                Columns(\"D:E\").Delete\n            End If\n\n            For iRows = 1 To 4\n                .Cells(iRows, 1).Font.Bold = True\n                .Cells(iRows, 1).Font.Name = \"Arial\"\n                If iRows = 1 Then\n                    .Cells(iRows, 1).Font.Size = 14\n                Else\n                    .Cells(iRows, 1).Font.Size = 12\n                End If\n            Next iRows\n\n            With .Cells(5, 1)\n                .Value = Chr(169) &amp; \" \" &amp; Year(Date) &amp; \" NCH Marketing Services, Inc\"\n                .Font.Bold = False\n                .Font.Name = \"Arial\"\n                .Font.Size = 11\n            End With\n\n            .Columns(\"A\").ColumnWidth = 200\n\n            .Range(Cells(1, 1), Cells(5, 1)).WrapText = False\n\n            .Range(Cells(1, 1), Cells(5, 1)).Copy\n            .Range(\"B1\").Select\n            Application.Wait (Now + TimeValue(\"00:00:01\"))\n            .Pictures.Paste.Select\n            .Range(Cells(1, 1), Cells(5, 1)).ClearContents\n            .Columns(\"A\").AutoFit\n            .Range(\"A1\").Select\n\n            Set shpTitle = .Shapes(\"Picture 1\")\n            With shpTitle\n                .Name = \"Title Picture\"\n                .Placement = xlFreeFloating\n            End With\n\n            Set shpLogo = .Shapes.AddPicture(\"G:\\Analytical Services\\AS Tools\\AS Templates\\NCH Logo.png\", False, True, 1, 1, 60, 67)\n            With shpLogo\n                .Name = \"Logo Picture\"\n                .Placement = xlFreeFloating\n            End With\n\n            With shpTitle\n                .Left = 67\n            End With\n\n\n            .Columns(\"A\").ColumnWidth = 30\n\n\n\n        End With\n\nEnd With\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 7141747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cab7dba55795f5df06af679091a772f5?s=128&d=identicon&r=PG&f=1", "display_name": "Nik", "link": "https://stackoverflow.com/users/7141747/nik"}, "edited": false, "score": 0, "creation_date": 1479308323, "post_id": 40635193, "comment_id": 68502845, "body": "Looks like that solution is creating a syntax error. I&#39;ve changed it to the following (As you advised) <code>me!DC = dlookup(&quot;DCName&quot;,&quot;PC&quot;, &quot;PCArea = &#39;&quot; &amp; me.Combo472 &amp; &quot;&#39;&quot;</code> @geeFlo"}, {"owner": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "reply_to_user": {"reputation": 41, "user_id": 7141747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cab7dba55795f5df06af679091a772f5?s=128&d=identicon&r=PG&f=1", "display_name": "Nik", "link": "https://stackoverflow.com/users/7141747/nik"}, "edited": false, "score": 0, "creation_date": 1479308557, "post_id": 40635193, "comment_id": 68503018, "body": "Is it a zip code or postal?  If it&#39;s numeric, then get rid of the single quotes in the PCArea string.   Also make sure the me!DC statement is referencing the fieldname on the form you are updating."}, {"owner": {"reputation": 41, "user_id": 7141747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cab7dba55795f5df06af679091a772f5?s=128&d=identicon&r=PG&f=1", "display_name": "Nik", "link": "https://stackoverflow.com/users/7141747/nik"}, "edited": false, "score": 0, "creation_date": 1479308766, "post_id": 40635193, "comment_id": 68503175, "body": "it&#39;s a postal code so it&#39;s Alphanumeric. The DC Statement? Are you referring to the me!DC = Dlookup part? It&#39;s aimed at a form called &quot;CU/DC view&quot; but given this is already on the form does that matter?"}, {"owner": {"reputation": 41, "user_id": 7141747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cab7dba55795f5df06af679091a772f5?s=128&d=identicon&r=PG&f=1", "display_name": "Nik", "link": "https://stackoverflow.com/users/7141747/nik"}, "edited": false, "score": 0, "creation_date": 1479308921, "post_id": 40635193, "comment_id": 68503288, "body": "<code>Private Sub Combo472_AfterUpdate() Me!DC = DLookup(&quot;DCName&quot;, &quot;PC&quot;, &quot;PCArea = &#39;&quot; &amp; Me.Combo472 &amp; &quot;&#39;&quot;) End Sub</code> Is how it is currently looking. When I run it not it&#39;s asking me to input something into the Data.DC field... which almost feels mad given that&#39;s what it&#39;s job is!"}, {"owner": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "reply_to_user": {"reputation": 41, "user_id": 7141747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cab7dba55795f5df06af679091a772f5?s=128&d=identicon&r=PG&f=1", "display_name": "Nik", "link": "https://stackoverflow.com/users/7141747/nik"}, "edited": false, "score": 0, "creation_date": 1479309497, "post_id": 40635193, "comment_id": 68503720, "body": "and the PC table contains both the DCNAME and corresponding PCArea fields right?   My guess is that Combo472 might be returning the index of that field.  Check to see if it contains more than just the one column for the PCArea.  If not, then you may need to specify the &quot;.column(1)&quot; or whatever column is not the index (0)."}, {"owner": {"reputation": 41, "user_id": 7141747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cab7dba55795f5df06af679091a772f5?s=128&d=identicon&r=PG&f=1", "display_name": "Nik", "link": "https://stackoverflow.com/users/7141747/nik"}, "edited": false, "score": 0, "creation_date": 1479309807, "post_id": 40635193, "comment_id": 68503957, "body": "Yup it does. It&#39;s got <code>(ID, PCArea, Town, DCarea, DCName). On &quot;Row Source&quot;</code> I&#39;ve got the following... <code>SELECT [PC].[ID], [PC].[PCArea] FROM PC ORDER BY [PCArea];</code> as the drop down. So I can&#39;t fathom where the heck it isn&#39;t working. Unless it&#39;s because the dropdown doesn&#39;t have the DCName in there? Just the Postcode? @geeFlo"}, {"owner": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "reply_to_user": {"reputation": 41, "user_id": 7141747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cab7dba55795f5df06af679091a772f5?s=128&d=identicon&r=PG&f=1", "display_name": "Nik", "link": "https://stackoverflow.com/users/7141747/nik"}, "edited": false, "score": 0, "creation_date": 1479310291, "post_id": 40635193, "comment_id": 68504298, "body": "You don&#39;t need DCname in there.  In fact you can even get rid of PC.id from that dropdown.  All you need is one single bound field - PCArea."}, {"owner": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "reply_to_user": {"reputation": 41, "user_id": 7141747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cab7dba55795f5df06af679091a772f5?s=128&d=identicon&r=PG&f=1", "display_name": "Nik", "link": "https://stackoverflow.com/users/7141747/nik"}, "edited": false, "score": 0, "creation_date": 1479310350, "post_id": 40635193, "comment_id": 68504353, "body": "Or just make the PCArea column the bound column in your properties for the dropdown."}, {"owner": {"reputation": 41, "user_id": 7141747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cab7dba55795f5df06af679091a772f5?s=128&d=identicon&r=PG&f=1", "display_name": "Nik", "link": "https://stackoverflow.com/users/7141747/nik"}, "edited": false, "score": 0, "creation_date": 1479310528, "post_id": 40635193, "comment_id": 68504479, "body": "IT WORKS. Thanks dude. Turns out is was the binding column that was causing issues. Sorry for being a stupid, thanks for your help. Have a nice day."}, {"owner": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "reply_to_user": {"reputation": 41, "user_id": 7141747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cab7dba55795f5df06af679091a772f5?s=128&d=identicon&r=PG&f=1", "display_name": "Nik", "link": "https://stackoverflow.com/users/7141747/nik"}, "edited": false, "score": 0, "creation_date": 1479311203, "post_id": 40635193, "comment_id": 68504937, "body": "No prob.  We&#39;ve all been there."}], "tags": [], "owner": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "is_accepted": true, "score": 1, "last_activity_date": 1479308025, "creation_date": 1479308025, "answer_id": 40635193, "question_id": 40635066, "link": "https://stackoverflow.com/questions/40635066/access-2016-form-auto-populate-based-on-another-field/40635193#40635193", "title": "Access 2016 Form auto-populate based on another field", "body": "<p>Replace {PCAreaDropDown} with name of your dropdown box, and all you really need is the one field in there.  It looks like you threw at least 10 columns (9+1) based on your example.</p>\n\n<pre><code>me!DC = dlookup(\"DCName\",\"PC\", \"PCArea = '\" &amp; me!PcAreaDropDown &amp; \"'\"\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 7141747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cab7dba55795f5df06af679091a772f5?s=128&d=identicon&r=PG&f=1", "display_name": "Nik", "link": "https://stackoverflow.com/users/7141747/nik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2814, "favorite_count": 0, "accepted_answer_id": 40635193, "answer_count": 1, "score": 0, "last_activity_date": 1479308025, "creation_date": 1479307619, "question_id": 40635066, "link": "https://stackoverflow.com/questions/40635066/access-2016-form-auto-populate-based-on-another-field", "title": "Access 2016 Form auto-populate based on another field", "body": "<p>I've got two  tables that contain the following.</p>\n\n<p><strong>Table Name: Enquiries</strong></p>\n\n<ul>\n<li><p>ID</p></li>\n<li><p>Username</p></li>\n<li><p>Date of Raising</p></li>\n<li><p>Time of Escalation</p></li>\n<li><p>Invoice</p></li>\n<li><p>Repeat Contact</p></li>\n<li><p>Query Type </p></li>\n<li><p>Context of Query</p></li>\n<li><p>DC</p></li>\n</ul>\n\n<p><strong>Table Name: PC</strong></p>\n\n<ul>\n<li><p>PCID</p></li>\n<li><p>PCarea</p></li>\n<li><p>Town</p></li>\n<li><p>DCArea</p></li>\n<li><p>DCName</p></li>\n</ul>\n\n<p>I currently have a Form setup with the above fields all selected. I have PCArea setup as a drop down as the field has 2000+ records (Postcodes). What I want is when a person updates this field/drop down/combo box for Access to lookup the PCArea and find out what the DCName is relevant to this and then populate the DC field in \"Enquiries\" and show on the form but I can't fathom how to do it.</p>\n\n<p>I know it's VBA related but I can't seem to get the format right?</p>\n\n<pre><code>Private Sub Combo472_AfterUpdate()\n\nMe.PCArea = Me.Data.Column(9)\n\nEnd Sub\n</code></pre>\n\n<p>Sure didn't work! Any help would be great.</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 45516, "user_id": 838807, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/372d495ca83f81cfadb782894ee41b17?s=128&d=identicon&r=PG", "display_name": "musefan", "link": "https://stackoverflow.com/users/838807/musefan"}, "edited": false, "score": 0, "creation_date": 1479307577, "post_id": 40635022, "comment_id": 68502336, "body": "Perhaps you should post this on <a href=\"https://superuser.com\">Super User</a>"}, {"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1479308919, "post_id": 40635022, "comment_id": 68503287, "body": "Use a conditional formatting rule <code>=AND($A1=$D1, $B1=$E1)</code> , select the applied range as <code>A1:D*insert number here*</code>."}, {"owner": {"reputation": 505, "user_id": 6204844, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pK6Ih.jpg?s=128&g=1", "display_name": "Clusks", "link": "https://stackoverflow.com/users/6204844/clusks"}, "reply_to_user": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1479309165, "post_id": 40635022, "comment_id": 68503477, "body": "@TimWilkinson I was going to suggest something similar, but is this possible with Excel 2010, as OP has listed this in the tags? This <a href=\"https://support.office.com/en-gb/article/Use-a-formula-to-apply-conditional-formatting-fed60dfa-1d3f-4e13-9ecb-f1951ff89d7f\" rel=\"nofollow noreferrer\">doc</a> says this feature is only available in Excel 2013/16."}, {"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "reply_to_user": {"reputation": 505, "user_id": 6204844, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pK6Ih.jpg?s=128&g=1", "display_name": "Clusks", "link": "https://stackoverflow.com/users/6204844/clusks"}, "edited": false, "score": 0, "creation_date": 1479309466, "post_id": 40635022, "comment_id": 68503691, "body": "@Clusks yes it works in 2010, also works in 2007. Never owned 2003 to test."}, {"owner": {"reputation": 875, "user_id": 3612914, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/26500b9a2376eaf42a510a6c137ffe43?s=128&d=identicon&r=PG&f=1", "display_name": "sam", "link": "https://stackoverflow.com/users/3612914/sam"}, "reply_to_user": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1479309637, "post_id": 40635022, "comment_id": 68503821, "body": "@Tim <code>A1:D*insert number here*</code> D range will change dynamic here.How do i specify that number"}, {"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1479309695, "post_id": 40635022, "comment_id": 68503865, "body": "@sam its only conditional formatting so make <code>*insert number here*</code> something along the lines of 1048576"}, {"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1479309743, "post_id": 40635022, "comment_id": 68503904, "body": "Be wary when you change a range of a conditional formatting excel sometimes likes to mess with your formula, so you often have write the formula, set the range, go fix the formula, never worked out why it does this."}], "answers": [{"tags": [], "owner": {"reputation": 315, "user_id": 5822096, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d5ab014cd7c3b58fa8eb2098837aa537?s=128&d=identicon&r=PG&f=1", "display_name": "Tianna Wrona", "link": "https://stackoverflow.com/users/5822096/tianna-wrona"}, "is_accepted": true, "score": 0, "last_activity_date": 1479311035, "creation_date": 1479311035, "answer_id": 40636256, "question_id": 40635022, "link": "https://stackoverflow.com/questions/40635022/how-to-color-code-cells-with-condition/40636256#40636256", "title": "How to color code cells with condition", "body": "<p>Press Alt+F11. This brings you to where you want to put your VBA code. Press Insert, then insert a Module. Open the module.</p>\n\n<p>Type this:</p>\n\n<pre><code>Option Explicit 'not necessary but good practice to make sure you define all variables\n\nPublic Sub highlightCells()\n\n    Dim i As Long\n    Dim sht As Worksheet\n    Set sht = ThisWorkbook.Worksheets(\"Sheet1\")\n    Dim lastrow As Long\n\n    'finds your last row, helps keep it dynamic\n    lastrow = sht.Cells(sht.Rows.Count, \"A\").End(xlUp).Row\n\n    For i = 1 To lastrow\n        If (Cells(i, 1).Value = Cells(i, 3).Value) And (Cells(i, 2).Value = Cells(i, 4).Value) Then\n            Cells(i, 2).Interior.Color = RGB(178, 255, 102) 'green\n            Cells(i, 4).Interior.Color = RGB(178, 255, 102)\n        Else\n            Cells(i, 2).Interior.Color = RGB(255, 178, 102) 'orange\n            Cells(i, 4).Interior.Color = RGB(255, 178, 102)\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>Then, while your cursor is anywhere between \"Public Sub\" and \"End Sub\" press F5. This will run the code so you can make sure it's what you're looking for. Next, I will explain how to make it a button on your sheet...</p>\n\n<p>Go to your excel spreadsheet. In the Developer tab, go to insert, under Active X Click CommandButton. Draw the CommandButton wherever you want it on your sheet.  Double click the button you just drew. Inside the code that appears automatically, type </p>\n\n<pre><code>Module1.highlightCells\n</code></pre>\n\n<p>Go back to your Excel sheet, in the Developer tab, Click \"Design Mode\". This will enable/disable design mode, allowing you to use your button which should work now.</p>\n\n<p>Also, keep in mind that I skipped over certain things that are considered \"good practice\", like renaming objects and such. If you need help with that too please let me know. One more thing, I chose the type of green and orange we used myself but if you'd like to change it you can use the RGB (Red, Green, Blue) codes found here: <a href=\"http://www.rapidtables.com/web/color/RGB_Color.htm\" rel=\"nofollow noreferrer\">http://www.rapidtables.com/web/color/RGB_Color.htm</a></p>\n"}, {"tags": [], "owner": {"reputation": 1322, "user_id": 4709540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n0mOY.jpg?s=128&g=1", "display_name": "Karpak", "link": "https://stackoverflow.com/users/4709540/karpak"}, "is_accepted": false, "score": 0, "last_activity_date": 1479345570, "last_edit_date": 1479345570, "creation_date": 1479313843, "answer_id": 40637324, "question_id": 40635022, "link": "https://stackoverflow.com/questions/40635022/how-to-color-code-cells-with-condition/40637324#40637324", "title": "How to color code cells with condition", "body": "<p>You can do this with the normal conditional formula itself. Perform the following steps.</p>\n\n<ol>\n<li>Click on D, which selects column D</li>\n<li>Then Click on B, which selects column B.</li>\n<li>Ensure that the current cell or Default is B1</li>\n<li>Click on Conditional formatting options, in that select \"Manage Rules\"</li>\n<li>In Conditional formatting rule manage window, click on New Rule button</li>\n<li>In the new formatting Rule window. select Use a formula to determine which cells to format</li>\n<li>Enter =OR($D1&lt;>$B1,$A1&lt;>$C1) in the Format values where this formula is true edit box</li>\n<li>Select the Orange color and click ok</li>\n<li>Do the step through 5 through 8 using the =AND($D1=$B1,$A1=$C1) formula and the Green color.</li>\n<li>Step 3 is critical, once you ensure that will be considered as relative cell and it will be applicable to all cells.</li>\n</ol>\n"}], "owner": {"reputation": 875, "user_id": 3612914, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/26500b9a2376eaf42a510a6c137ffe43?s=128&d=identicon&r=PG&f=1", "display_name": "sam", "link": "https://stackoverflow.com/users/3612914/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 40636256, "answer_count": 2, "score": 1, "last_activity_date": 1479345570, "creation_date": 1479307496, "question_id": 40635022, "link": "https://stackoverflow.com/questions/40635022/how-to-color-code-cells-with-condition", "title": "How to color code cells with condition", "body": "<p>I have data in the excel like below</p>\n\n<pre><code>  A   B     C     D\nsam  9.8    sam   1\nkev  0.1    kev   0.1\nashl 2      ashl  2\nkris 5.5    kris  3\n</code></pre>\n\n<p>I'm trying to color code B,D if for eg:A1=C1 and B1=D1 then color B1,D1 green else orange.I tried below formula to get 0 or 1 depends on true or false in column E. How do i proceed color code in VBA because my range will change dynamically</p>\n\n<pre><code>=IF(AND(A1=D1,B1=E1),0,1)\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1479308306, "post_id": 40634934, "comment_id": 68502834, "body": "Why not simply <code>datevalue(fieldnamehere+30)</code> rather than all that complication?"}, {"owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "reply_to_user": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1479308437, "post_id": 40634934, "comment_id": 68502925, "body": "I tried that and get a #TYPE! error"}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1479308512, "post_id": 40634934, "comment_id": 68502988, "body": "What is the data type of the field?"}, {"owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "reply_to_user": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1479308602, "post_id": 40634934, "comment_id": 68503062, "body": "Its set to date/time"}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1479309010, "post_id": 40634934, "comment_id": 68503358, "body": "Is the field / column a reserved name? Have you got null values in the field?"}, {"owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "reply_to_user": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1479309115, "post_id": 40634934, "comment_id": 68503440, "body": "Its called OpenedDate - Every cell has a date in them"}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1479309277, "post_id": 40634934, "comment_id": 68503548, "body": "If you type in the immediate window <code>?datevalue(now()+30)</code> does it work?"}, {"owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "reply_to_user": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1479309360, "post_id": 40634934, "comment_id": 68503608, "body": "hmmm, yeah works. Shows todays date"}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "reply_to_user": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "edited": false, "score": 0, "creation_date": 1479309390, "post_id": 40634934, "comment_id": 68503626, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/128273/discussion-between-fionnuala-and-david\">continue this discussion in chat</a>."}, {"owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "reply_to_user": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1479309450, "post_id": 40634934, "comment_id": 68503674, "body": "Just realised the excel document it gets copied in from has the cell as a customer format of: dd/mm/yyyy hh:mm:ss   - Im guessing this is causing the issue?"}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1479309524, "post_id": 40634934, "comment_id": 68503746, "body": "Seems likely, but we have reached the discussion limit for commets :)"}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1479320633, "creation_date": 1479320633, "answer_id": 40639510, "question_id": 40634934, "link": "https://stackoverflow.com/questions/40634934/date-time-formatting-in-access-textbox/40639510#40639510", "title": "Date/Time formatting in access textbox", "body": "<p>It sounds like your date field is linked as text. So convert to Date:</p>\n\n<pre><code>=DateValue([OpenedDate])\n</code></pre>\n\n<p>and for the +30 date:</p>\n\n<pre><code>=DateAdd(\"d\",30,DateValue([OpenedDate]))\n</code></pre>\n\n<p>However, there is no way that:</p>\n\n<pre><code>? DateValue(Now() + 30)\n</code></pre>\n\n<p>can show today's date. It will show 30 days ahead of today.</p>\n"}], "owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1551, "favorite_count": 0, "accepted_answer_id": 40639510, "answer_count": 1, "score": 1, "last_activity_date": 1479320633, "creation_date": 1479307250, "question_id": 40634934, "link": "https://stackoverflow.com/questions/40634934/date-time-formatting-in-access-textbox", "title": "Date/Time formatting in access textbox", "body": "<p>I have an issue, and believe its simple to resolve but cant work out how.</p>\n\n<p>My table, which has showing both date &amp; time can not be amended because that is how I receive my data.</p>\n\n<p>Ive changed the format in the table design to short date and it shows fine, it hides the time.</p>\n\n<p>I also changed the textbox that displays the date to short date but its still showing both the date and time, why?</p>\n\n<p>Primarily, I have another textbox that I want to calculate the table date + 30, my expression used is:</p>\n\n<pre><code>=[text5]+30\n</code></pre>\n\n<p>The textbox is displayed blank.</p>\n\n<p>Any help? </p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1479306937, "post_id": 40634690, "comment_id": 68501875, "body": "<a href=\"http://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\" title=\"how to use regular expressions regex in microsoft excel both in cell and loops\">stackoverflow.com/questions/22542834/&hellip;</a>  then sculpt your regex to look for &quot;Response Code&quot;"}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1479307552, "post_id": 40634690, "comment_id": 68502311, "body": "to add on to Dougs comment, the regex would look something like: <code>(Response Code:?.\\d+)</code> if I&#39;m not completely off."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5173957"}, "edited": false, "score": 0, "creation_date": 1479366316, "post_id": 40635322, "comment_id": 68528578, "body": "Thanks a lot you made my day :) .. can you please explain me                      Cells(i, 1).Value = Replace(textline, &quot;Response Code:-&quot;, &quot;&quot;) this line in your code ????"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1479308347, "creation_date": 1479308347, "answer_id": 40635322, "question_id": 40634690, "link": "https://stackoverflow.com/questions/40634690/need-to-fetch-particular-string-from-text-file-into-excel-sheet/40635322#40635322", "title": "Need to fetch particular string from text file into Excel sheet", "body": "<p>Small mods to your code:</p>\n\n<pre><code>Sub dural()\n    Dim myFile As String\n    Dim text As String\n    Dim textline As String\n    Dim i As Long\n\n    myFile = \"C:\\TestFolder\\test.log\"\n    Close #1\n    Open myFile For Input As #1\n\n    i = 1\n    Do Until EOF(1)\n        Line Input #1, textline\n        If InStr(textline, \"Response Code:-\") &gt; 0 Then\n            Cells(i, 1).Value = Replace(textline, \"Response Code:-\", \"\")\n            i = i + 1\n        End If\n    Loop\n    Close #1\nEnd Sub\n</code></pre>\n\n<p>produce:</p>\n\n<p><a href=\"https://i.stack.imgur.com/diSA8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/diSA8.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5173957"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 777, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480544338, "creation_date": 1479306617, "last_edit_date": 1480544338, "question_id": 40634690, "link": "https://stackoverflow.com/questions/40634690/need-to-fetch-particular-string-from-text-file-into-excel-sheet", "title": "Need to fetch particular string from text file into Excel sheet", "body": "<p>I need to find a key value pair from text file and paste it in Excel column</p>\n\n<p>There are multiple occurrence of the key value pair till end of file</p>\n\n<ul>\n<li>Key = Response Code which is constant </li>\n<li>Value = not constant changes every time </li>\n</ul>\n\n<p>Example:</p>\n\n<p>Text file :</p>\n\n<pre><code>Username : admin \nOld password : qqqq\nNew password : 1111\nSecurity question : 1\nSecurity answer : Mom\n\nResponse Code: -500\n\nOperation Completed\n\nResponse Code: -100\n....\nResponse Code: -202\n....\n....\n</code></pre>\n\n<p>My code :</p>\n\n<pre><code>    Dim myFile As String\n    Dim text As String\n    Dim textline As String\n    Dim x As Integer\n\n    myFile = \"C:\\test\\test.log\"\n    Open myFile For Input As #1\n    Do Until EOF(1)\n      Line Input #1, textline\n      text = text &amp; textline\n    Loop\n    Close #1\n    x = InStr(text, \"Response code\")\n    Range(\"A1\").Value = Mid(text, x + 15, 3)\n</code></pre>\n\n<p><strong>Note</strong>: I am getting only the first occurrence i.e Response Code:-500 \nI want loop that will find all occurrence till end of file and paste that content in Excel sheet column A1.</p>\n"}, {"tags": ["vba", "excel", "email"], "answers": [{"comments": [{"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1479305749, "post_id": 40634256, "comment_id": 68500984, "body": "You need to use the <code>Recipients</code> property which is a collection. <code>.Recipients.Add xxxxxx</code> for each recipient."}], "tags": [], "owner": {"reputation": 21, "user_id": 7167891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e369c4030b019d35d503e42d61888f40?s=128&d=identicon&r=PG", "display_name": "Jacky White", "link": "https://stackoverflow.com/users/7167891/jacky-white"}, "is_accepted": false, "score": 2, "last_activity_date": 1479305375, "creation_date": 1479305375, "answer_id": 40634256, "question_id": 40634094, "link": "https://stackoverflow.com/questions/40634094/sending-email-to-multiple-recipients-vba/40634256#40634256", "title": "sending email to multiple recipients vba", "body": "<p>I think you just overwrite the \"to\" value with the latest recipient.\nYou need to append the recipients by using a semicolon as separator.</p>\n"}, {"tags": [], "owner": {"reputation": 360, "user_id": 6151782, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wEMNXXhy3P8/AAAAAAAAAAI/AAAAAAAAd8U/7U1yCmL5XJI/photo.jpg?sz=128", "display_name": "Kumar Sourav", "link": "https://stackoverflow.com/users/6151782/kumar-sourav"}, "is_accepted": false, "score": 3, "last_activity_date": 1507730390, "last_edit_date": 1507730390, "creation_date": 1479305758, "answer_id": 40634394, "question_id": 40634094, "link": "https://stackoverflow.com/questions/40634094/sending-email-to-multiple-recipients-vba/40634394#40634394", "title": "sending email to multiple recipients vba", "body": "<p>The code should be :</p>\n\n<pre><code>With OutMail\n        .to = \"nagarjun.balarama@accenture.com;nagarjun.b@bp.com;nagarjungupta@yahoo.com;nagarjunguptab@gmail.com\"\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = \"BID RESPONSE\"\n        .Body = \"THIS IS AN AUTOMATIC MAIL SENT THROUGH MACROS.\" &amp; vbNewLine &amp; \"   \" &amp; vbNewLine &amp; \"Hi Team,\" &amp; vbNewLine &amp; \"   \" &amp; vbNewLine &amp; \"Attached is the bid response for the day.\" &amp; vbNewLine &amp; \"   \" &amp; vbNewLine &amp; \"Thanks &amp; Regards,\" &amp; vbNewLine &amp; \"Nagarjun B\"\n        .Attachments.Add ActiveWorkbook.FullName\n        'You can add other files also like this\n        '.Attachments.Add (\"C:\\test.txt\")\n        .Send   'or use .Display\n    End With\n    On Error GoTo 0\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1440, "user_id": 8108679, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/abOaf.jpg?s=128&g=1", "display_name": "ChrisM", "link": "https://stackoverflow.com/users/8108679/chrism"}, "edited": false, "score": 0, "creation_date": 1507727106, "post_id": 40634465, "comment_id": 80325504, "body": "Why do you need the <code>&quot; &amp; &quot;;&quot; &amp; &quot;</code> in the <code>&quot;nagarjun.balarama@accenture.com&quot; &amp; &quot;;&quot; &amp; &quot;nagarjun.b@bp.com&quot;</code> ? Surely the <code>&quot; &amp; &quot;;&quot; &amp; &quot;</code> is redundant as all of it is text, you might as well write it <code>&quot;nagarjun.balarama@accenture.com;nagarjun.b@bp.com&quot;</code>"}, {"owner": {"reputation": 495, "user_id": 6330670, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXmfw.jpg?s=128&g=1", "display_name": "M.S. Arun", "link": "https://stackoverflow.com/users/6330670/m-s-arun"}, "reply_to_user": {"reputation": 1440, "user_id": 8108679, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/abOaf.jpg?s=128&g=1", "display_name": "ChrisM", "link": "https://stackoverflow.com/users/8108679/chrism"}, "edited": false, "score": 0, "creation_date": 1507735905, "post_id": 40634465, "comment_id": 80332065, "body": "we need to use &amp; &quot;;&quot; &amp; in-between email id&#39;s.This is the standard format for excel, so id&#39;s will club together in &quot;To&quot; address."}, {"owner": {"reputation": 1440, "user_id": 8108679, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/abOaf.jpg?s=128&g=1", "display_name": "ChrisM", "link": "https://stackoverflow.com/users/8108679/chrism"}, "edited": false, "score": 0, "creation_date": 1507737045, "post_id": 40634465, "comment_id": 80332843, "body": "It isn&#39;t needed. If you remove the <code>&quot; &amp; &quot;;&quot; &amp; &quot;</code> it will work exactly the same. The &amp; is just to join the strings together which you don&#39;t need as all of it is a text string. You just need the two &quot; to enclose the entire string."}], "tags": [], "owner": {"reputation": 495, "user_id": 6330670, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXmfw.jpg?s=128&g=1", "display_name": "M.S. Arun", "link": "https://stackoverflow.com/users/6330670/m-s-arun"}, "is_accepted": false, "score": 1, "last_activity_date": 1507726251, "last_edit_date": 1507726251, "creation_date": 1479305942, "answer_id": 40634465, "question_id": 40634094, "link": "https://stackoverflow.com/questions/40634094/sending-email-to-multiple-recipients-vba/40634465#40634465", "title": "sending email to multiple recipients vba", "body": "<p>Please use ; (semi-colon) like below,</p>\n\n<pre><code>.to = \"nagarjun.balarama@accenture.com\" &amp; \";\" &amp; \"nagarjun.b@bp.com\" &amp; \";\" &amp; \"nagarjungupta@yahoo.com\" &amp; \";\" &amp; \"nagarjunguptab@gmail.com\"\n</code></pre>\n\n<p>or </p>\n\n<p>You can also declare the emails ID's in a separate sheet and refer the cell value.</p>\n\n<pre><code>.to = Join(Application.Transpose(Worksheets(\"Sheet1\").Range(\"A1:A4\").Value), \";\")\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7065441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63d0ec3cec7bdbd490359b568d433703?s=128&d=identicon&r=PG", "display_name": "Nagarjun", "link": "https://stackoverflow.com/users/7065441/nagarjun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7474, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1507730390, "creation_date": 1479304909, "last_edit_date": 1479305604, "question_id": 40634094, "link": "https://stackoverflow.com/questions/40634094/sending-email-to-multiple-recipients-vba", "title": "sending email to multiple recipients vba", "body": "<p>I am trying to send one mail to multiple receipients but I am able to send it to only the last person. Please help me to solve the problem.</p>\n\n<p>Here is the program I have:</p>\n\n<pre><code>Sub Mail_Sending_WholWorkbook_Attachment()\n'\n' Mail_Sending_WholWorkbook_Attachment Macro\n' This Macro is used to send the Bidresponse of the day as an attachment to the whole team with cc to santosh\n'\n' Keyboard Shortcut: Ctrl+Shift+B\n'\n'Working in Excel 2000-2016\n'This example send the last saved version of the Activeworkbook\n'For Tips see: http://www.rondebruin.nl/win/winmail/Outlook/tips.htm\n    Dim OutApp As Object\n    Dim OutMail As Object\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n\n    On Error Resume Next\n    With OutMail\n        .to = \"nagarjun.balarama@accenture.com\"\n        .to = \"nagarjun.b@bp.com\"\n        .to = \"nagarjungupta@yahoo.com\"\n        .to = \"nagarjunguptab@gmail.com\"\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = \"BID RESPONSE\"\n        .Body = \"THIS IS AN AUTOMATIC MAIL SENT THROUGH MACROS.\" &amp; vbNewLine &amp; \"   \" &amp; vbNewLine &amp; \"Hi Team,\" &amp; vbNewLine &amp; \"   \" &amp; vbNewLine &amp; \"Attached is the bid response for the day.\" &amp; vbNewLine &amp; \"   \" &amp; vbNewLine &amp; \"Thanks &amp; Regards,\" &amp; vbNewLine &amp; \"Nagarjun B\"\n        .Attachments.Add ActiveWorkbook.FullName\n        'You can add other files also like this\n        '.Attachments.Add (\"C:\\test.txt\")\n        .Send   'or use .Display\n    End With\n    On Error GoTo 0\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "edited": false, "score": 0, "creation_date": 1479303309, "post_id": 40633265, "comment_id": 68499332, "body": "Did the error only occur after you added &quot;To copy value C&quot;?"}, {"owner": {"reputation": 91, "user_id": 5041299, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/31tK6.jpg?s=128&g=1", "display_name": "Verd&#39;O", "link": "https://stackoverflow.com/users/5041299/verdo"}, "reply_to_user": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "edited": false, "score": 0, "creation_date": 1479303356, "post_id": 40633265, "comment_id": 68499367, "body": "the first code works when I don&#39;t try to add my value C"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1479304176, "post_id": 40633265, "comment_id": 68499943, "body": "Can you provide a download link for the workbook?  If not I&#39;m going to have to see more code to determine the problem."}, {"owner": {"reputation": 91, "user_id": 5041299, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/31tK6.jpg?s=128&g=1", "display_name": "Verd&#39;O", "link": "https://stackoverflow.com/users/5041299/verdo"}, "edited": false, "score": 0, "creation_date": 1479304343, "post_id": 40633265, "comment_id": 68500044, "body": "i&#39;ll edit, thank you for your time"}, {"owner": {"reputation": 91, "user_id": 5041299, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/31tK6.jpg?s=128&g=1", "display_name": "Verd&#39;O", "link": "https://stackoverflow.com/users/5041299/verdo"}, "edited": false, "score": 0, "creation_date": 1479304921, "post_id": 40633265, "comment_id": 68500452, "body": "It&#39;s a 1 hour meeting, can&#39;t post it before, sorry had no choice"}, {"owner": {"reputation": 91, "user_id": 5041299, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/31tK6.jpg?s=128&g=1", "display_name": "Verd&#39;O", "link": "https://stackoverflow.com/users/5041299/verdo"}, "edited": false, "score": 0, "creation_date": 1479308012, "post_id": 40633265, "comment_id": 68502609, "body": "updated with the link"}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 5041299, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/31tK6.jpg?s=128&g=1", "display_name": "Verd&#39;O", "link": "https://stackoverflow.com/users/5041299/verdo"}, "edited": false, "score": 0, "creation_date": 1479304327, "post_id": 40633861, "comment_id": 68500034, "body": "I tried it but forgot to change it and it did not work (first thing it tried xD), i&#39;ll edit"}, {"owner": {"reputation": 91, "user_id": 5041299, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/31tK6.jpg?s=128&g=1", "display_name": "Verd&#39;O", "link": "https://stackoverflow.com/users/5041299/verdo"}, "edited": false, "score": 0, "creation_date": 1479304715, "post_id": 40633861, "comment_id": 68500301, "body": "I&#39;ll post it after my meeting"}], "tags": [], "owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "is_accepted": false, "score": 1, "last_activity_date": 1479304234, "creation_date": 1479304234, "answer_id": 40633861, "question_id": 40633265, "link": "https://stackoverflow.com/questions/40633265/usage-of-empty-in-array/40633861#40633861", "title": "usage of &quot;empty&quot; in Array()", "body": "<p>Does this work for you? It looks like you forgot to update the last one when you copied it.</p>\n\n<pre><code>aProducts(lRow) = Array(\"Id Product\", \"Value A\", \"Value B\", \"Value C\")\n\n'To copy value A\naProducts(lRow) = Array(.Cells(aPos(1)).Value2, .Cells(aPos(2)).Value2, Empty, Empty)\n\n'To copy value B\naProducts(lRow) = Array(.Cells(aPos(1)).Value2, Empty, .Cells(aPos(3)).Value2, Empty)\n\n'To copy value C\naProducts(lRow) = Array(.Cells(aPos(1)).Value2, Empty, Empty, .Cells(aPos(4)).Value2)\n</code></pre>\n\n<p>I also think you wanted to update <code>.Cells(aPos(4)).Value2)</code> to have a <code>4</code> instead of a <code>3</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 91, "user_id": 5041299, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/31tK6.jpg?s=128&g=1", "display_name": "Verd&#39;O", "link": "https://stackoverflow.com/users/5041299/verdo"}, "edited": false, "score": 0, "creation_date": 1479304690, "post_id": 40633936, "comment_id": 68500284, "body": "I&#39;ll try it after my meeting"}, {"owner": {"reputation": 91, "user_id": 5041299, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/31tK6.jpg?s=128&g=1", "display_name": "Verd&#39;O", "link": "https://stackoverflow.com/users/5041299/verdo"}, "edited": false, "score": 0, "creation_date": 1479305110, "post_id": 40633936, "comment_id": 68500583, "body": "By the way, why should I try this? What&#39;s the point of this piece of code?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 91, "user_id": 5041299, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/31tK6.jpg?s=128&g=1", "display_name": "Verd&#39;O", "link": "https://stackoverflow.com/users/5041299/verdo"}, "edited": false, "score": 0, "creation_date": 1479305132, "post_id": 40633936, "comment_id": 68500597, "body": "Showing how <code>Empty</code> looks like in the array."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 4, "creation_date": 1479305156, "post_id": 40633936, "comment_id": 68500621, "body": "Essentially, <code>Empty</code> is the initial / default value for any new array. You could also just issue the <code>Stop</code> after <code>Dim arr_var(2)</code> and you&#39;d see that you&#39;ve got an array of three elements all of which are <code>Empty</code>. So, by using <code>Empty</code> you are &quot;resetting&quot; the array to it&#39;s initial emptiness."}, {"owner": {"reputation": 91, "user_id": 5041299, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/31tK6.jpg?s=128&g=1", "display_name": "Verd&#39;O", "link": "https://stackoverflow.com/users/5041299/verdo"}, "edited": false, "score": 1, "creation_date": 1479305181, "post_id": 40633936, "comment_id": 68500636, "body": "Oh right, didn&#39;t see the screenshot on mobile version thank you again, I&#39;ll be back in an hour :/"}, {"owner": {"reputation": 91, "user_id": 5041299, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/31tK6.jpg?s=128&g=1", "display_name": "Verd&#39;O", "link": "https://stackoverflow.com/users/5041299/verdo"}, "edited": false, "score": 1, "creation_date": 1479310334, "post_id": 40633936, "comment_id": 68504337, "body": "Thanks to your help, i found my mistake: i forgot to delete <code>ReDim Preserve aProducts(lRow)</code> that I forgot between my B and C values. Thanks for your tips, and have a great day @Vityata ! ;)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1479310442, "post_id": 40633936, "comment_id": 68504418, "body": "Welcome :) Its almost night at my place :)"}, {"owner": {"reputation": 91, "user_id": 5041299, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/31tK6.jpg?s=128&g=1", "display_name": "Verd&#39;O", "link": "https://stackoverflow.com/users/5041299/verdo"}, "edited": false, "score": 1, "creation_date": 1479310493, "post_id": 40633936, "comment_id": 68504454, "body": "Also have a great &quot;almost night&quot; :)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1479310668, "post_id": 40633936, "comment_id": 68504574, "body": "Thanks, have a great day/night as well :)"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 3, "last_activity_date": 1479304454, "creation_date": 1479304454, "answer_id": 40633936, "question_id": 40633265, "link": "https://stackoverflow.com/questions/40633265/usage-of-empty-in-array/40633936#40633936", "title": "usage of &quot;empty&quot; in Array()", "body": "<p>Write the following:</p>\n\n<pre><code>Option Explicit\n\nSub TestMe()\n\n    Dim arr_var     As Variant\n\n    arr_var = Array(Empty, Empty, 5)\n    Stop\nEnd Sub\n</code></pre>\n\n<p>Then run it. Click with mouse over <code>arr_var</code>, press Shift + F2 and you will see this:\n\"Leer\" means \"Empty\" in German.\n<a href=\"https://i.stack.imgur.com/QXVzB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QXVzB.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 91, "user_id": 5041299, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/31tK6.jpg?s=128&g=1", "display_name": "Verd&#39;O", "link": "https://stackoverflow.com/users/5041299/verdo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 2, "accepted_answer_id": 40633936, "answer_count": 2, "score": 2, "last_activity_date": 1479310530, "creation_date": 1479302527, "last_edit_date": 1479310530, "question_id": 40633265, "link": "https://stackoverflow.com/questions/40633265/usage-of-empty-in-array", "title": "usage of &quot;empty&quot; in Array()", "body": "<pre><code>aProducts(lRow) = Array(\"Id Product\", \"Value A\", \"Value B\")\n\n'To copy value A\naProducts(lRow) = Array(.Cells(aPos(1)).Value2, .Cells(aPos(2)).Value2, Empty)\n\n'To copy value B\naProducts(lRow) = Array(.Cells(aPos(1)).Value2, Empty, .Cells(aPos(3)).Value2)\n</code></pre>\n\n<p>Hi guys,</p>\n\n<p>I use this piece of code in a loop to copy some values and their ID, but anyway, now I'd like to understand the usage of \"Empty\" in this code in order to add more value.</p>\n\n<p>I tried:</p>\n\n<pre><code>aProducts(lRow) = Array(\"Id Product\", \"Value A\", \"Value B\", \"Value C\")\n\n'To copy value A\naProducts(lRow) = Array(.Cells(aPos(1)).Value2, .Cells(aPos(2)).Value2, Empty)\n\n'To copy value B\naProducts(lRow) = Array(.Cells(aPos(1)).Value2, Empty, .Cells(aPos(3)).Value2)\n\n'To copy value C\naProducts(lRow) = Array(.Cells(aPos(1)).Value2, Empty, Empty, .Cells(aPos(4)).Value2)\n</code></pre>\n\n<p>\"Execusiion error 9\"</p>\n\n<p>Thanks in advance and sorry for my approximate english :/</p>\n\n<p><strong>EDIT 1</strong></p>\n\n<p>you can get the file here : <a href=\"https://drive.google.com/file/d/0B5DpGwPWsIfbWWlJRDAzZldYek0/view?usp=sharing\" rel=\"nofollow noreferrer\">https://drive.google.com/file/d/0B5DpGwPWsIfbWWlJRDAzZldYek0/view?usp=sharing</a></p>\n\n<p><strong>EDIT 2</strong></p>\n\n<p>Thanks to all of you, I just found that i've forgot to remove </p>\n\n<pre><code>ReDim Preserve aProducts(lRow)\n</code></pre>\n"}, {"tags": ["vba", "excel", "sharepoint"], "comments": [{"owner": {"reputation": 5088, "user_id": 2399571, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/S42Qt.png?s=128&g=1", "display_name": "Alec.", "link": "https://stackoverflow.com/users/2399571/alec"}, "edited": false, "score": 0, "creation_date": 1479302423, "post_id": 40633016, "comment_id": 68498723, "body": "You need to at least make some sort of attempt, then post here on what you are stuck with."}, {"owner": {"reputation": 11, "user_id": 7167568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a7f8c63231b6f5c440fb0cd54c9d07d?s=128&d=identicon&r=PG&f=1", "display_name": "webkilla", "link": "https://stackoverflow.com/users/7167568/webkilla"}, "reply_to_user": {"reputation": 5088, "user_id": 2399571, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/S42Qt.png?s=128&g=1", "display_name": "Alec.", "link": "https://stackoverflow.com/users/2399571/alec"}, "edited": false, "score": 0, "creation_date": 1479302906, "post_id": 40633016, "comment_id": 68499055, "body": "That&#39;s the issue - I have no clue what kind of commands I&#39;m supposed to start with here.  I know how to wrangle your usual run of the mill excel VBA, to set up buttons, open and close forms, you know: Basic stuff.  If I knew what kind of commands I was looking for - I wouldn&#39;t be asking for them - you must forgive me if that comes off as haughty or ignorant"}, {"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1479305395, "post_id": 40633016, "comment_id": 68500768, "body": "Perhaps try this <a href=\"http://stackoverflow.com/questions/7876178/importing-excel-spreadsheet-data-into-another-excel-spreadsheet-containing-vba\" title=\"importing excel spreadsheet data into another excel spreadsheet containing vba\">stackoverflow.com/questions/7876178/&hellip;</a> ...or Googling more, there is tons of information about pulling data into a worksheet.  Look at the code that comes up, and then Google commands you aren&#39;t familiar with to see if it is what you need...you know the way that everyone has to do it.  SO is not a code writing service, so you likely won&#39;t get the exact code you want here either."}], "answers": [{"tags": [], "owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "is_accepted": false, "score": 0, "last_activity_date": 1479305134, "creation_date": 1479305134, "answer_id": 40634160, "question_id": 40633016, "link": "https://stackoverflow.com/questions/40633016/importing-sharepoint-data-to-excell-via-an-existing-connection-through-vba/40634160#40634160", "title": "Importing sharepoint data to excell via an existing connection through VBA", "body": "<p>Once the data connection has been made, just have <code>ActiveWorkbook.RefreshAll</code> assigned when the workbook opens. </p>\n\n<p>You do need to show some research effort or attempted coding in future questions though (even if it's wrong) as this is not a free coding service (i let you off this time as the answer is a one liner ^^).</p>\n"}], "owner": {"reputation": 11, "user_id": 7167568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a7f8c63231b6f5c440fb0cd54c9d07d?s=128&d=identicon&r=PG&f=1", "display_name": "webkilla", "link": "https://stackoverflow.com/users/7167568/webkilla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 236, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479305134, "creation_date": 1479301856, "last_edit_date": 1531164843, "question_id": 40633016, "link": "https://stackoverflow.com/questions/40633016/importing-sharepoint-data-to-excell-via-an-existing-connection-through-vba", "title": "Importing sharepoint data to excell via an existing connection through VBA", "body": "<p>first time poster here</p>\n\n<p>I am looking for a specific VBA solution and I just can't seem to google my way to the exact code I need - thus, I come here</p>\n\n<p>I have an excel sheet with an existing connection to a sharepoint database. It calls this connection \"toolbase\"</p>\n\n<p>I need code so that when this sheet loads up it fills its second sheet with a dump from that connection as if I pressed the Existing Connection > Connect > import table button. Its the only known connection to the sheet.</p>\n\n<p>That's it - and for the love of my feeble VBA skills then I can't find the code for this. My boss just wants a list that refreshes itself every time the file loads. I know where to put the code - I just don't what to write.</p>\n\n<p>Can someone help me out?</p>\n\n<p>EDIT:</p>\n\n<p>The closest I could find to what I think I need is something akin to this: <a href=\"https://support.microsoft.com/en-us/kb/306125\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-us/kb/306125</a></p>\n\n<p>but that seems to be talking about extracting records - I need the whole table</p>\n"}, {"tags": ["vba", "macros", "catia"], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1479311140, "creation_date": 1479311140, "answer_id": 40636298, "question_id": 40632325, "link": "https://stackoverflow.com/questions/40632325/vba-macros-for-catia-works-on-one-computer-and-doesnt-work-on-another/40636298#40636298", "title": "VBA macros for CATIA works on one computer, and doesn&#39;t work on another", "body": "<p>Just a random guess:</p>\n\n<p>Go to VBE>Tools>References</p>\n\n<p>and compare the values from both computers. They should be identical.\nCompare these checkboxes:</p>\n\n<p><a href=\"https://i.stack.imgur.com/6E8Ha.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6E8Ha.png\" alt=\"enter image description here\"></a></p>\n\n<p>If they are different, make sure to make them identical to the PC that works.</p>\n"}, {"comments": [{"owner": {"reputation": 373, "user_id": 3656916, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/500881123/picture?type=large", "display_name": "AntonZi", "link": "https://stackoverflow.com/users/3656916/antonzi"}, "edited": false, "score": 0, "creation_date": 1481799288, "post_id": 40845166, "comment_id": 69525537, "body": "That&#39;s correct. One of my collegues in the other office suggested that. I&#39;ve rewritten the macro and it works"}], "tags": [], "owner": {"reputation": 821, "user_id": 6937632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a1554053245e86d609b83f201aa6bf8?s=128&d=identicon&r=PG&f=1", "display_name": "C R Johnson", "link": "https://stackoverflow.com/users/6937632/c-r-johnson"}, "is_accepted": true, "score": 1, "last_activity_date": 1480338648, "creation_date": 1480338648, "answer_id": 40845166, "question_id": 40632325, "link": "https://stackoverflow.com/questions/40632325/vba-macros-for-catia-works-on-one-computer-and-doesnt-work-on-another/40845166#40845166", "title": "VBA macros for CATIA works on one computer, and doesn&#39;t work on another", "body": "<p>Perhaps at your site you have Hybrid Design enabled, and at the other site they do not. </p>\n\n<p>With Hybrid Design enabled, you would be able to add points to a Body. Not so if it is not enabled and you would get no error from your code. </p>\n\n<p>The setting is under Tools->Options->Infrastructure->Part Infrastructure->Part Document Tab->Enable hybrid design inside part bodies and bodies. </p>\n\n<p>For unexplained reasons, hybrid design being enabled is the default. However I do not recommend using it.</p>\n\n<p>If you just want to make your code work in both places then use a Geometrical Set to aggregate your points instead of the main body.</p>\n\n<pre><code>Dim pointsBody as HybridBody\nSet pointsBody = oPart.HybridBodies.Add\npointsBody.Name = \"Points_Body\"\n\n...\n\nFor i = 0 To Nmlp\n    Set ohSPointCoord(i) = ohSFactory.AddNewPointCoord(XM(i), YM(i), ZM(i))\n    pointsBody.AppendHybridShape ohSPointCoord(i)\nNext i\n</code></pre>\n"}], "owner": {"reputation": 373, "user_id": 3656916, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/500881123/picture?type=large", "display_name": "AntonZi", "link": "https://stackoverflow.com/users/3656916/antonzi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1482, "favorite_count": 0, "accepted_answer_id": 40845166, "answer_count": 2, "score": 0, "last_activity_date": 1480338648, "creation_date": 1479299708, "question_id": 40632325, "link": "https://stackoverflow.com/questions/40632325/vba-macros-for-catia-works-on-one-computer-and-doesnt-work-on-another", "title": "VBA macros for CATIA works on one computer, and doesn&#39;t work on another", "body": "<p>I have a CATIA macro in VBA, that draws points by coordinates (from arrays).\nIt works on my computer (Catia V5-R2014 and on my neigbours - two versions V5-R2014 and R21).\nBut it doesn't work for colleges in a different city (they have version R21).\nBasically, my macro reads input data from file, calculates coordinates, writes them in out-file, and then draws these points.\nAll steps except the last one work on either computer/version.\nBut at the last step \"their\" Catia just doesn't plot anything, w/o any errors.</p>\n\n<p>So the Subruotine for the last step is:</p>\n\n<pre><code>Sub PlotGeometry()\n' Nmlp - number of points\nDim i As Integer\n\nDim oPartDocument As Document\nDim ohSPointCoord() As HybridShapePointCoord\nDim ohSPoints As HybridShapePointCoord\nDim bodies1 As Bodies\nDim body1 As Body\n\nReDim ohSPointCoord(0 To Nmlp)\n\nSet oPartDocument = CATIA.Documents.Add(\"Part\")\nSet oPart = oPartDocument.Part\nSet oPartBody = oPart.MainBody\nSet oPlaneYZ = oPart.CreateReferenceFromGeometry(oPart.OriginElements.PlaneYZ)\n' -- Draw Points\nDim ohSFactory As HybridShapeFactory\nSet ohSFactory = oPart.HybridShapeFactory\n\nFor i = 0 To Nmlp\n    Set ohSPointCoord(i) = ohSFactory.AddNewPointCoord(XM(i), YM(i), ZM(i))\n    oPartBody.InsertHybridShape ohSPointCoord(i)\nNext i\n\noPart.Update\n\nEnd Sub\n</code></pre>\n\n<p>What can it be? </p>\n"}, {"tags": ["vba", "excel", "macros", "oledb", "oledbconnection"], "comments": [{"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 1, "creation_date": 1479299726, "post_id": 40632284, "comment_id": 68497055, "body": "check on <a href=\"http://www.connectionstrings.com\" rel=\"nofollow noreferrer\">www.connectionstrings.com</a> which works for ADODB but should work for Excel connections, too."}, {"owner": {"reputation": 145, "user_id": 6821241, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/ugKRa.jpg?s=128&g=1", "display_name": "Martin Router King", "link": "https://stackoverflow.com/users/6821241/martin-router-king"}, "reply_to_user": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1479300410, "post_id": 40632284, "comment_id": 68497498, "body": "Thank you. Which of all these examples do you think should I use to implement it in my VBA macro?"}, {"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1479300868, "post_id": 40632284, "comment_id": 68497803, "body": "on the front page search for provider, and next search for the scenario which is closest to your situation."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1479302502, "post_id": 40632284, "comment_id": 68498772, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/38744688/vba-macro-save-sql-query-in-a-csv-file\">VBA macro save SQL query in a csv file</a>"}, {"owner": {"reputation": 145, "user_id": 6821241, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/ugKRa.jpg?s=128&g=1", "display_name": "Martin Router King", "link": "https://stackoverflow.com/users/6821241/martin-router-king"}, "edited": false, "score": 0, "creation_date": 1479304318, "post_id": 40632284, "comment_id": 68500031, "body": "Thank you to both of you for your help and scuse me for the duplicate. I couldn&#39;t find any related post before."}], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 6821241, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/ugKRa.jpg?s=128&g=1", "display_name": "Martin Router King", "link": "https://stackoverflow.com/users/6821241/martin-router-king"}, "edited": false, "score": 0, "creation_date": 1479368802, "post_id": 40636569, "comment_id": 68529864, "body": "Thank you for your answer. This look like what I am looking for... The problem is that the codes that I find don&#39;t create the connection properly, and I can&#39;t figure out where should I add this line... Could you show me the link from where you got this line so that I can fit it."}, {"owner": {"reputation": 315, "user_id": 5822096, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d5ab014cd7c3b58fa8eb2098837aa537?s=128&d=identicon&r=PG&f=1", "display_name": "Tianna Wrona", "link": "https://stackoverflow.com/users/5822096/tianna-wrona"}, "reply_to_user": {"reputation": 145, "user_id": 6821241, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/ugKRa.jpg?s=128&g=1", "display_name": "Martin Router King", "link": "https://stackoverflow.com/users/6821241/martin-router-king"}, "edited": false, "score": 0, "creation_date": 1479418304, "post_id": 40636569, "comment_id": 68561921, "body": "I actually did not get this from a link. What I usually do is put all my connection strings in their own module. Then when I want to open them I simply use"}, {"owner": {"reputation": 315, "user_id": 5822096, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d5ab014cd7c3b58fa8eb2098837aa537?s=128&d=identicon&r=PG&f=1", "display_name": "Tianna Wrona", "link": "https://stackoverflow.com/users/5822096/tianna-wrona"}, "reply_to_user": {"reputation": 145, "user_id": 6821241, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/ugKRa.jpg?s=128&g=1", "display_name": "Martin Router King", "link": "https://stackoverflow.com/users/6821241/martin-router-king"}, "edited": false, "score": 0, "creation_date": 1479418376, "post_id": 40636569, "comment_id": 68561958, "body": "Can&#39;t figure out how to edit the comment so I&#39;ll just continue. I simply use &quot;con.Open nameOfModule.pathName&quot; and that works just fine. Our way of keeping all our strings in one location."}, {"owner": {"reputation": 145, "user_id": 6821241, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/ugKRa.jpg?s=128&g=1", "display_name": "Martin Router King", "link": "https://stackoverflow.com/users/6821241/martin-router-king"}, "edited": false, "score": 1, "creation_date": 1479456687, "post_id": 40636569, "comment_id": 68574497, "body": "Oh! That sounds interesting. I only have one connection that I want to use. Please tell me if I am right or not... In order to be able to run this, do I need to have created the connection file before? There is not any way to create this connection file from VBA? As my experience it seems that if I don&#39;t have the connection file created  Conn.Open will show an error (invalid connection...)"}], "tags": [], "owner": {"reputation": 315, "user_id": 5822096, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d5ab014cd7c3b58fa8eb2098837aa537?s=128&d=identicon&r=PG&f=1", "display_name": "Tianna Wrona", "link": "https://stackoverflow.com/users/5822096/tianna-wrona"}, "is_accepted": false, "score": 0, "last_activity_date": 1479311830, "creation_date": 1479311830, "answer_id": 40636569, "question_id": 40632284, "link": "https://stackoverflow.com/questions/40632284/vba-create-a-connection-to-a-oledb-with-user-id-and-password/40636569#40636569", "title": "VBA: Create a connection to a OLEDB with user ID and Password", "body": "<p>Is this what you are trying to do? This works for me. Just keep in mind you have to switch out the right fields.</p>\n\n<pre><code>Public Const pathName As String = \"Driver={Microsoft ODBC for Oracle};\" &amp; _\n                            \"SERVER=serverName;UID=usernameHere;PWD=passwordHere\"\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 6821241, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/ugKRa.jpg?s=128&g=1", "display_name": "Martin Router King", "link": "https://stackoverflow.com/users/6821241/martin-router-king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 716, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479311830, "creation_date": 1479299579, "question_id": 40632284, "link": "https://stackoverflow.com/questions/40632284/vba-create-a-connection-to-a-oledb-with-user-id-and-password", "title": "VBA: Create a connection to a OLEDB with user ID and Password", "body": "<p>I have created some macros to do some SQL queries into the data-base. My problem comes when I try to create a macro to define the connection. Macro recorder doesn't give any answer and none of the posts I have seen on the internet seem to help me. I need a macro to define the IP of the server and to give the user and password credentials.</p>\n\n<p>Do any of you have any idea or can send a link to a webpage that explain how this can be achieved?</p>\n\n<p>Thank you very much!</p>\n"}, {"tags": ["database", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 6192744, "user_type": "registered", "accept_rate": 17, "profile_image": "https://lh6.googleusercontent.com/-_XHW2a6QCvU/AAAAAAAAAAI/AAAAAAAABNI/vDDPf8ZWAGU/photo.jpg?sz=128", "display_name": "Manouchehr Tizkhan", "link": "https://stackoverflow.com/users/6192744/manouchehr-tizkhan"}, "edited": false, "score": 0, "creation_date": 1479300165, "post_id": 40632263, "comment_id": 68497317, "body": "can i do it with vba code and Such as the above codes insert record to table B?"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 1, "last_activity_date": 1479299535, "creation_date": 1479299535, "answer_id": 40632263, "question_id": 40632092, "link": "https://stackoverflow.com/questions/40632092/insert-ms-access-form-data-into-another-access-table/40632263#40632263", "title": "Insert MS Access form data into another Access table", "body": "<p><a href=\"https://support.office.com/en-us/article/Import-or-link-to-data-in-another-Access-database-095ab408-89c7-45b3-aac2-58036e45fcf6#bm3\" rel=\"nofollow noreferrer\"><strong>Link</strong></a> TableB from DB2 into DB1.</p>\n\n<p>The linked table can be used (for most use cases) like a local table, your code works without changes, except perhaps the table name.</p>\n"}, {"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 3, "last_activity_date": 1479305221, "creation_date": 1479305221, "answer_id": 40634193, "question_id": 40632092, "link": "https://stackoverflow.com/questions/40632092/insert-ms-access-form-data-into-another-access-table/40634193#40634193", "title": "Insert MS Access form data into another Access table", "body": "<p>Simply switch out the <em>CurrentDb</em> object and point to networked database file:</p>\n\n<pre><code>Dim db As Database\nDim rst As Recordset \n\nSet db = OpenDatabase(\"C:\\Path\\To\\Database.accdb\")\nSet rst = db.OpenRecordset(\"Tbl_Requests\") \n\nWith rst \n   .AddNew \n   .Fields(\"IDLeave\") = Me.Text_IDLeave.Value \n   .Fields(\"PersonalCode\") = Me.Text_CP.Value \n   .Fields(\"FullName\") = Me.Text_FullName.Value \n   .Fields(\"RequestDate\") = Me.Text_RequestDate.Value \n   .Fields(\"Section\") = Me.Text_Section.Value \n   .Fields(\"SuperName\") = Me.Text_SuperName.Value \n   .Fields(\"LeaveRemained\") = Me.Text_LeaveRemained.Value \n   .Fields(\"Des\") = Me.Text_Des.Value \n   .Fields(\"LeaveDate\") = Me.Combo_LeaveDate.Value \n   .Fields(\"Email\") = Me.Text_Email.Value \n   .Update \nEnd With\n\nrst.Close\ndb.Close\n\nSet rst = Nothing\nSet db = Nothing\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 6192744, "user_type": "registered", "accept_rate": 17, "profile_image": "https://lh6.googleusercontent.com/-_XHW2a6QCvU/AAAAAAAAAAI/AAAAAAAABNI/vDDPf8ZWAGU/photo.jpg?sz=128", "display_name": "Manouchehr Tizkhan", "link": "https://stackoverflow.com/users/6192744/manouchehr-tizkhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1479306844, "creation_date": 1479298939, "last_edit_date": 1479306844, "question_id": 40632092, "link": "https://stackoverflow.com/questions/40632092/insert-ms-access-form-data-into-another-access-table", "title": "Insert MS Access form data into another Access table", "body": "<p>I have 2 Access database files. Database no. 1 is in my computer and database no. 2 is in the network shared folder.</p>\n\n<p>I create a form in database 1 (in my computer) that inserts form data to table \"Tbl_Requests\" with following VBA code:</p>\n\n<pre><code>Dim rst As Recordset\nSet rst = CurrentDb.OpenRecordset(\"Tbl_Requests\")\nWith rst\n.AddNew\n.Fields(\"IDLeave\") = Me.Text_IDLeave.Value\n.Fields(\"PersonalCode\") = Me.Text_CP.Value\n.Fields(\"FullName\") = Me.Text_FullName.Value\n.Fields(\"RequestDate\") = Me.Text_RequestDate.Value\n.Fields(\"Section\") = Me.Text_Section.Value\n.Fields(\"SuperName\") = Me.Text_SuperName.Value\n.Fields(\"LeaveRemained\") = Me.Text_LeaveRemained.Value\n.Fields(\"Des\") = Me.Text_Des.Value\n.Fields(\"LeaveDate\") = Me.Combo_LeaveDate.Value\n.Fields(\"Email\") = Me.Text_Email.Value\n.Update\nEnd With\n</code></pre>\n\n<p>Now I want save the same data form to another table in database 2 that is in the network. How can I do this?</p>\n\n<p><img src=\"https://i.stack.imgur.com/d1KsL.jpg\" alt=\"Picture Of Question\"></p>\n"}, {"tags": ["windows", "vba"], "answers": [{"comments": [{"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "edited": false, "score": 0, "creation_date": 1479304569, "post_id": 40633523, "comment_id": 68500208, "body": "Yes it works, it seems so obvious actually ! The weird thing is that it doesn&#39;t close all of them at once. I mean that I have to run this code a few times before reaching the right number, but that&#39;s just a small detail. Thanks man !"}, {"owner": {"reputation": 192, "user_id": 7042797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85fcda9c59b304092899595847c28287?s=128&d=identicon&r=PG&f=1", "display_name": "Nulled", "link": "https://stackoverflow.com/users/7042797/nulled"}, "reply_to_user": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "edited": false, "score": 0, "creation_date": 1479306334, "post_id": 40633523, "comment_id": 68501426, "body": "You could try something along the lines of this:      <code>While Now() &lt; Time + 0.00005         While SH.Count &lt;&gt; 0             For Each IE In SH                 If IE.Visible = False Then                     IE.Quit                 End If             Next         Wend     Wend</code>  This will run the script for five seconds or until <code>sh.count = 0.</code>"}, {"owner": {"reputation": 192, "user_id": 7042797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85fcda9c59b304092899595847c28287?s=128&d=identicon&r=PG&f=1", "display_name": "Nulled", "link": "https://stackoverflow.com/users/7042797/nulled"}, "reply_to_user": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "edited": false, "score": 0, "creation_date": 1479306552, "post_id": 40633523, "comment_id": 68501593, "body": "Though, bear in mind VBA doesn&#39;t support multi-threading and therefore the five seconds will need to pass before you do anything else. Just mentioned it as food for thought. Happy to help."}], "tags": [], "owner": {"reputation": 192, "user_id": 7042797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85fcda9c59b304092899595847c28287?s=128&d=identicon&r=PG&f=1", "display_name": "Nulled", "link": "https://stackoverflow.com/users/7042797/nulled"}, "is_accepted": true, "score": 1, "last_activity_date": 1479303261, "creation_date": 1479303261, "answer_id": 40633523, "question_id": 40631708, "link": "https://stackoverflow.com/questions/40631708/quit-all-hidden-invisible-windows/40633523#40633523", "title": "Quit all hidden/invisible windows", "body": "<p>I created a couple of hidden internet explorer windows and did a before and after count of the open internet explorer windows and the below code seems to work:</p>\n\n<pre><code>Public Sub CLOSE_HIDDEN_IE()\n\n    Dim IE As SHDocVw.InternetExplorer\n    Dim SH As SHDocVw.ShellWindows\n\n    Set SH = New SHDocVw.ShellWindows\n\n    For Each IE In SH\n    If IE.Visible = False Then\n        IE.Quit\n     End If\n    Next\n\n    Set IE = Nothing\n    Set SH = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>The code loops through the open internet explorer window and closes the ones which aren't visible.</p>\n\n<p>Happy to help if you need anything.</p>\n"}], "owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 278, "favorite_count": 0, "accepted_answer_id": 40633523, "answer_count": 1, "score": 1, "last_activity_date": 1479303261, "creation_date": 1479297767, "question_id": 40631708, "link": "https://stackoverflow.com/questions/40631708/quit-all-hidden-invisible-windows", "title": "Quit all hidden/invisible windows", "body": "<p>Sometimes I use the command <code>ie.visible = False</code> which hides the window even though it still exists.</p>\n\n<p>How can I close all the hidden windows ?</p>\n\n<p>My actual solution is to log out from my computer's session and log in again...there is probably a better way to do this.</p>\n\n<p>I tried <code>Set ie = Nothing</code> or <code>ie.Quit</code> but it doesn't affect the hidden windows since when I count them with  </p>\n\n<pre><code>Set objShell = CreateObject(\"Shell.Application\")\n    IE_count = objShell.Windows.Count\n</code></pre>\n\n<p>they are still there.</p>\n\n<p>Any ideas on how to do this?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 3, "creation_date": 1479297331, "post_id": 40631370, "comment_id": 68495514, "body": "Nothing is built-in (AFAIK) but it should be straightforward to write a macro that opens a userform which displays the various properties of the selected cell (or at least the ones that  you are interested in), and which can edit those properties. Sounds like a good project. If you have any problems writing the code, post another question which shows your attempt and discusses the problem."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1479298670, "post_id": 40631370, "comment_id": 68496345, "body": "@JohnColeman .................interesting idea..............."}], "answers": [{"comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1479299702, "post_id": 40631780, "comment_id": 68497038, "body": "This might be what OP had in mind, although it would certainly be nice to have a drop-down menu that would give you everything in one place."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1479300197, "post_id": 40631780, "comment_id": 68497338, "body": "@JohnColeman  It would be a neat project.........easy to start........lot of effort to complete."}, {"owner": {"reputation": 145, "user_id": 5443708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/64xZJ.jpg?s=128&g=1", "display_name": "NamSandStorm", "link": "https://stackoverflow.com/users/5443708/namsandstorm"}, "edited": false, "score": 0, "creation_date": 1479310538, "post_id": 40631780, "comment_id": 68504485, "body": "I meant this to be in the format as we are used from VBA, i.e one long list with collapsible sections. This is a floating box which remains open the whole time, the benefit being that you can quickly check and get an overview of all data, how it is stored."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 3, "last_activity_date": 1479297965, "creation_date": 1479297965, "answer_id": 40631780, "question_id": 40631370, "link": "https://stackoverflow.com/questions/40631370/is-there-a-way-to-use-the-properties-window-also-for-cells-in-excel/40631780#40631780", "title": "Is there a way to use the &quot;Properties&quot; Window also for cells in Excel?", "body": "<p>The <strong>content</strong> is displayed in the Formula Bar.  The <strong>formatting</strong> can be displayed by touching:  <kbd>Ctrl</kbd>+<kbd>1</kbd>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/kgiZM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kgiZM.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is <strong>not</strong> a complete set of Properties. <em>(Comments are displayed by mouseover,etc.)</em></p>\n"}], "owner": {"reputation": 145, "user_id": 5443708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/64xZJ.jpg?s=128&g=1", "display_name": "NamSandStorm", "link": "https://stackoverflow.com/users/5443708/namsandstorm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1479334749, "creation_date": 1479296841, "last_edit_date": 1531161705, "question_id": 40631370, "link": "https://stackoverflow.com/questions/40631370/is-there-a-way-to-use-the-properties-window-also-for-cells-in-excel", "title": "Is there a way to use the &quot;Properties&quot; Window also for cells in Excel?", "body": "<p>I am curious whether I can get a properties window for cells select in Excel. With \"properties window\" I mean the same on the Developer interface uses for properties of entities in VBA. I use AutoCAD a lot and have gotten used to being able to see and edit all attributes of an entity through the properties window. It would be quite handy if I had all info of a cell available in Excel too.</p>\n"}, {"tags": ["excel", "vba", "popup", "msgbox"], "comments": [{"owner": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1479297234, "post_id": 40631009, "comment_id": 68495448, "body": "You can call a popup in one line: <code>CreateObject(&quot;WScript.Shell&quot;).popup &quot;This is a message&quot;, 1, &quot;This is a header&quot;, 0 + 64  &#39;</code> It only gets complicated if you&#39;re trying to capture a response, which I don&#39;t think you want if <code>Wait</code> = 1 second"}, {"owner": {"reputation": 1355, "user_id": 5767535, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2b5578a1e21b5ca9e23593e13ac95306?s=128&d=identicon&r=PG&f=1", "display_name": "Daneel Olivaw", "link": "https://stackoverflow.com/users/5767535/daneel-olivaw"}, "reply_to_user": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1479298478, "post_id": 40631009, "comment_id": 68496216, "body": "Thank you for the tip. However, this does not solve the original issue, the popup stays open. I have updated the original post."}, {"owner": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1479304198, "post_id": 40631009, "comment_id": 68499962, "body": "That second bit of code works for me. The box appears, then auto closes a second later."}, {"owner": {"reputation": 2146, "user_id": 1539189, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/1d143d8e21c38971dbf030c374af9b15?s=128&d=identicon&r=PG&f=1", "display_name": "Robert J.", "link": "https://stackoverflow.com/users/1539189/robert-j"}, "edited": false, "score": 0, "creation_date": 1479306204, "post_id": 40631009, "comment_id": 68501337, "body": "What OS are you on? I am using Windows 7 and it works according to expectations"}, {"owner": {"reputation": 1355, "user_id": 5767535, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2b5578a1e21b5ca9e23593e13ac95306?s=128&d=identicon&r=PG&f=1", "display_name": "Daneel Olivaw", "link": "https://stackoverflow.com/users/5767535/daneel-olivaw"}, "edited": false, "score": 0, "creation_date": 1479306558, "post_id": 40631009, "comment_id": 68501596, "body": "Windows 7 also."}, {"owner": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1479309161, "post_id": 40631009, "comment_id": 68503471, "body": "Hmm, your code, the Edit#1 and the Edit#2 code <b>all</b> work for me - <code>Windows 7</code> <code>Excel 2010</code>"}], "answers": [{"comments": [{"owner": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1479304478, "post_id": 40632186, "comment_id": 68500144, "body": "I get a runtime <code>error 424: object required</code> when I try that code."}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "reply_to_user": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1479304652, "post_id": 40632186, "comment_id": 68500262, "body": "Sorry I was using your original code, it works with those <code>Dim</code>&#39;s"}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1479306135, "post_id": 40632186, "comment_id": 68501275, "body": "Weird, do you still get the error with the <code>Dim</code>&#39;s in or is the <code>.Popup</code> just not closing?"}, {"owner": {"reputation": 1355, "user_id": 5767535, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2b5578a1e21b5ca9e23593e13ac95306?s=128&d=identicon&r=PG&f=1", "display_name": "Daneel Olivaw", "link": "https://stackoverflow.com/users/5767535/daneel-olivaw"}, "edited": false, "score": 0, "creation_date": 1479306505, "post_id": 40632186, "comment_id": 68501545, "body": "I don&#39;t have any error, the popup is displayed but never closes."}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1479307384, "post_id": 40632186, "comment_id": 68502185, "body": "Only other thing I could think of is that I have a reference turned on that you don&#39;t, but the other answer should work. Apart from internet controls which are 100% not relevant to this all I have on is: <code>Visual Basic For Applications</code>, <code>Microsoft Excel 14.0 Object Library</code>, <code>OLE Automation</code>, <code>Microsoft Office 14.0 Object Library</code>. Alas I can&#39;t differentiate between them. I&#39;ve just turned them on at some point when I&#39;ve needed to."}, {"owner": {"reputation": 1355, "user_id": 5767535, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2b5578a1e21b5ca9e23593e13ac95306?s=128&d=identicon&r=PG&f=1", "display_name": "Daneel Olivaw", "link": "https://stackoverflow.com/users/5767535/daneel-olivaw"}, "edited": false, "score": 0, "creation_date": 1479381885, "post_id": 40632186, "comment_id": 68538418, "body": "I have the same references turned on - except I have version 15.0 instead of 14.0, but I have tested the code in another computer with version 15.0 and it works."}], "tags": [], "owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "is_accepted": false, "score": 0, "last_activity_date": 1479299205, "creation_date": 1479299205, "answer_id": 40632186, "question_id": 40631009, "link": "https://stackoverflow.com/questions/40631009/display-popup-for-a-time-period-in-excel/40632186#40632186", "title": "Display popup for a time period in Excel", "body": "<p>You're just missing the <code>Select Case</code>:</p>\n\n<pre><code>WaitTime = 1\nSelect Case TemporalBox = WScriptShell.Popup(\"The message box will close in 1 second.\", _\nWaitTime, \"File processed\")\n    Case 1, -1\nEnd Select\n</code></pre>\n\n<p>I tested and it works...</p>\n"}, {"comments": [{"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1479307026, "post_id": 40634508, "comment_id": 68501933, "body": "I was thinking of going down the <code>Application.OnTime</code> route once I&#39;d finished my report that I&#39;m working on... Well played sir."}], "tags": [], "owner": {"reputation": 2146, "user_id": 1539189, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/1d143d8e21c38971dbf030c374af9b15?s=128&d=identicon&r=PG&f=1", "display_name": "Robert J.", "link": "https://stackoverflow.com/users/1539189/robert-j"}, "is_accepted": false, "score": 2, "last_activity_date": 1479306776, "last_edit_date": 1479306776, "creation_date": 1479306053, "answer_id": 40634508, "question_id": 40631009, "link": "https://stackoverflow.com/questions/40631009/display-popup-for-a-time-period-in-excel/40634508#40634508", "title": "Display popup for a time period in Excel", "body": "<p>Another approach (if your would not work at all).</p>\n\n<p>Create a new userform named <strong>frm_Popup</strong> and add a label there named <strong>lbl_Message</strong>. Add the following void to userform code:  </p>\n\n<pre><code>Public Sub StartProcess(iTime As Integer)\n    Me.lbl_Message.Caption = \"The message box will close in \" &amp; iTime &amp; \" second(s).\"\nEnd Sub\n</code></pre>\n\n<p>then in your module:</p>\n\n<pre><code>Sub ShowMessage()\n    Dim iTimeToWait As Integer\n        iTimeToWait = 2\n\n    With frm_Popup\n        .Show False\n        Call .StartProcess(iTimeToWait)\n    End With\n\n    Application.OnTime Now + TimeValue(\"00:00:\" &amp; iTimeToWait), \"HidePopup\"\nEnd Sub\n\nPrivate Sub HidePopup()\n    Unload frm_Popup\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1381, "user_id": 6908282, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sV0sfeGuIwQ/AAAAAAAAAAI/AAAAAAAAPvk/7xDwhLEI5BU/photo.jpg?sz=128", "display_name": "Gangula", "link": "https://stackoverflow.com/users/6908282/gangula"}, "edited": false, "score": 0, "creation_date": 1547198858, "post_id": 40659702, "comment_id": 95118345, "body": "Can we make this a Yes/No message box? And automatically make it press no after PauseTime if Yes is not pressed"}], "tags": [], "owner": {"reputation": 1355, "user_id": 5767535, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2b5578a1e21b5ca9e23593e13ac95306?s=128&d=identicon&r=PG&f=1", "display_name": "Daneel Olivaw", "link": "https://stackoverflow.com/users/5767535/daneel-olivaw"}, "is_accepted": true, "score": 2, "last_activity_date": 1479398930, "last_edit_date": 1495542283, "creation_date": 1479398930, "answer_id": 40659702, "question_id": 40631009, "link": "https://stackoverflow.com/questions/40631009/display-popup-for-a-time-period-in-excel/40659702#40659702", "title": "Display popup for a time period in Excel", "body": "<p>I finally found a very simple solution - credits to @Orphid, see his answer in the following <a href=\"https://stackoverflow.com/questions/31141775/infobox-popup-refuses-to-close-on-timer-expiration\">thread</a>. </p>\n\n<p>I did not solve the specific issue related to my original code, but I managed to create a PopUp that closes after a specified period of time. The code is the following:</p>\n\n<pre><code>Sub subClosingPopUp(PauseTime As Integer, Message As String, Title As String)\n\nDim WScriptShell As Object\nDim ConfigString As String\n\nSet WScriptShell = CreateObject(\"WScript.Shell\")\nConfigString = \"mshta.exe vbscript:close(CreateObject(\"\"WScript.Shell\"\").\" &amp; _\n               \"Popup(\"\"\" &amp; Message &amp; \"\"\",\" &amp; PauseTime &amp; \",\"\"\" &amp; Title &amp; \"\"\"))\"\n\nWScriptShell.Run ConfigString\n\nEnd Sub\n</code></pre>\n\n<p>This works just fine.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12729517, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/7c74ed811f0056a6180db57a74cfe3ef?s=128&d=identicon&r=PG", "display_name": "Akshay Jadhav", "link": "https://stackoverflow.com/users/12729517/akshay-jadhav"}, "is_accepted": false, "score": -1, "last_activity_date": 1579263522, "last_edit_date": 1579263522, "creation_date": 1579242776, "answer_id": 59782281, "question_id": 40631009, "link": "https://stackoverflow.com/questions/40631009/display-popup-for-a-time-period-in-excel/59782281#59782281", "title": "Display popup for a time period in Excel", "body": "<p>The following code works for me:</p>\n\n<pre><code>Sub TimeBasedPopUp()\n\nDim WaitTime As Integer\n\nWaitTime = 1\nSelect Case CreateObject(\"WScript.Shell\").Popup(\"The message box will close in 1 second.\",_\nWaitTime, \"MS Excel\")\nCase 1, -1\n</code></pre>\n\n<p>End Select</p>\n\n<p>End Sub</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14894250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2c197669658cb4a4bb6de7be918b4d?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/14894250/anthony"}, "is_accepted": false, "score": 0, "last_activity_date": 1609057632, "last_edit_date": 1609057632, "creation_date": 1609033746, "answer_id": 65462281, "question_id": 40631009, "link": "https://stackoverflow.com/questions/40631009/display-popup-for-a-time-period-in-excel/65462281#65462281", "title": "Display popup for a time period in Excel", "body": "<p>Below code work for me, I added a <code>2-sec</code> delay before the popup message appears. After <code>4-sec</code> it auto disappear. I learn it from Mr. Dinesh Kumar Takyar. He added a <code>5-sec</code> delay b4 popup appears. His youtube link\n<a href=\"https://www.youtube.com/watch?v=x1nmqVRrq-Q&amp;list=PLwC8syx0i_6nHjAogOm9m4oGBq40YHkXV&amp;index=4\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=x1nmqVRrq-Q&amp;list=PLwC8syx0i_6nHjAogOm9m4oGBq40YHkXV&amp;index=4</a>\nI think the key issue is you need a delay for the popup timer to work. Maybe the Excel application needs to run for a while b4 the popup appears.</p>\n<hr />\n<pre><code>Option Explicit\n\nConst PopUpTime As Integer = 4\n</code></pre>\n<pre><code>Sub ShellMessageBox()\n\nDim MsgBoxWithTimer As Integer\n\nMsgBoxWithTimer=CreateObject(&quot;WScript.Shell&quot;).Popup(&quot;Put your message here&quot;, PopUpTime, _\n&quot;Notice!&quot;, 0)\n\nEnd Sub\n</code></pre>\n<pre><code>Sub startTimer()\nApplication.OnTime Now + TimeValue(&quot;00:00:02&quot;), &quot;ShellMessageBox&quot;\nEnd Sub\n</code></pre>\n<pre><code>Private Sub Workbook_Open()\n\nstartTimer\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1355, "user_id": 5767535, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2b5578a1e21b5ca9e23593e13ac95306?s=128&d=identicon&r=PG&f=1", "display_name": "Daneel Olivaw", "link": "https://stackoverflow.com/users/5767535/daneel-olivaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16389, "favorite_count": 0, "accepted_answer_id": 40659702, "answer_count": 5, "score": 1, "last_activity_date": 1609057632, "creation_date": 1479295785, "last_edit_date": 1582819635, "question_id": 40631009, "link": "https://stackoverflow.com/questions/40631009/display-popup-for-a-time-period-in-excel", "title": "Display popup for a time period in Excel", "body": "<p>I am trying to generate a popup that closes after a given <code>WaitTime</code> in seconds.</p>\n\n<p>I consulted <a href=\"http://www.tushar-mehta.com/publish_train/xl_vba_cases/1023_display_message_for_a_specific_duration.shtml\" rel=\"nofollow noreferrer\">this</a> link and <a href=\"https://msdn.microsoft.com/en-us/library/x83z1d9f(v=vs.84).aspx\" rel=\"nofollow noreferrer\">this</a> link.</p>\n\n<p>I tried to apply the method from \"<a href=\"https://stackoverflow.com/questions/19008288/vba-excel-macro-message-box-auto-close\">VBA Excel macro message box auto close</a>\"; my code is the following:</p>\n\n<pre><code>Sub TestSubroutine()\n\nDim TemporalBox As Integer\nDim WaitTime As Integer\nDim WScriptShell As Object\n\nSet WScriptShell = CreateObject(\"WScript.Shell\")\n\nWaitTime = 1\nTemporalBox = WScriptShell.Popup(\"The message box will close in 1 second.\", _\nWaitTime, \"File processed\")\n\nEnd Sub\n</code></pre>\n\n<p>The popup is displayed but it never closes after one second.</p>\n\n<hr>\n\n<p><strong>Edit #1</strong></p>\n\n<p>Based on @Skip Intro comment, I have updated the code:</p>\n\n<pre><code>Sub TestSubroutine()\n\nDim WaitTime As Integer\n\nWaitTime = 1\nCreateObject(\"WScript.Shell\").Popup \"The message box will close in 1 second.\", _\nWaitTime, \"File processed\"\n\nEnd Sub\n</code></pre>\n\n<p>However this does not solve the original issue, the popup does not close after 1 second.</p>\n\n<p><strong>Edit #2</strong></p>\n\n<p>This is the code suggested by @Glitch_Doctor, however it still doesn't work:</p>\n\n<pre><code>Sub TestSubroutine()\n\nDim TemporalBox As Integer\nDim WaitTime As Integer\nDim WScriptShell As Object\nDim test\n\nSet WScriptShell = CreateObject(\"WScript.Shell\")\n\nWaitTime = 1\nSelect Case TemporalBox = WScriptShell.Popup(\"The message box will close in 1 second.\", _\nWaitTime, \"File processed\")\n    Case 1, -1\nEnd Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["c++", "excel", "vba"], "comments": [{"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1479299391, "post_id": 40630971, "comment_id": 68496839, "body": "What exactly is the problem? You speak of some code that crashes Excel - is it some VBA code, or is it the C++ code that causes the crash?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1479305797, "post_id": 40630971, "comment_id": 68501016, "body": "Does Excel log an exception in the Windows error log? Note that it&#39;s also much more common to return an HRESULT and pass the SAFEARRAY as an out parameter."}, {"owner": {"reputation": 63, "user_id": 4804204, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1ac0def7eba7575e777b2f6101e715de?s=128&d=identicon&r=PG&f=1", "display_name": "maurizio nard&#242;", "link": "https://stackoverflow.com/users/4804204/maurizio-nard%c3%b2"}, "edited": false, "score": 0, "creation_date": 1479311730, "post_id": 40630971, "comment_id": 68505319, "body": "Dim x() As Double, y() As Double     x = mat([A1:C3])    &#39; reads the range: fine     y = mat(x)     &#39; crashes"}], "owner": {"reputation": 63, "user_id": 4804204, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1ac0def7eba7575e777b2f6101e715de?s=128&d=identicon&r=PG&f=1", "display_name": "maurizio nard&#242;", "link": "https://stackoverflow.com/users/4804204/maurizio-nard%c3%b2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 235, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479295649, "creation_date": 1479295649, "question_id": 40630971, "link": "https://stackoverflow.com/questions/40630971/extract-lpsafearray-from-a-variant", "title": "Extract LPSAFEARRAY from a VARIANT", "body": "<p>I'm writing a dll in C/C++ to be used from vba, dealing with array of doubles. In vba an array of doubles is internally mapped to an LPSAFEARRAY structure, and this can be passed to C++ as such. But it is also possible to pass it in a Variant argument: arguably the LPSAFEARRAY is wrapped inside the Variant argument.\nAs also a Excel range can be passed in a Variant, I'm writing a C++ function  taking as argument a VARIANT and producing an LPSAFEARRAY, for further processing in C++. My attempt, function mat(), without any checking, is:</p>\n\n<pre><code>VARIANT getdata(VARIANT &amp; ExcelArray) {\n    VARIANT dvout;  EXCEPINFO excep; DISPPARAMS dispparams; unsigned int uiArgErr; DISPID dispidValue;\n    LPOLESTR XName = L\"Value2\";\n    ExcelArray.pdispVal-&gt;GetIDsOfNames(IID_NULL, &amp;XName, 1, LOCALE_SYSTEM_DEFAULT, &amp;dispidValue);\n    dispparams.cArgs = 0;\n    dispparams.cNamedArgs = 0;\n    ExcelArray.pdispVal-&gt;Invoke(dispidValue, IID_NULL, LOCALE_SYSTEM_DEFAULT, DISPATCH_PROPERTYGET, &amp;dispparams, &amp;dvout, &amp;excep, &amp;uiArgErr);\n    ExcelArray.pdispVal-&gt;Release();\n    return dvout;\n}\n\ninline LPSAFEARRAY getarray (VARIANT const &amp;var) {\n    // Extract the array (differs if it came in by reference)\n    if (var.vt &amp; VT_BYREF)\n        return * var.pparray;\n    else\n        return var.parray;\n}\n\nxll_LPSAFEARRAY mat (VARIANT &amp; src) {\n    if (src.vt == VT_DISPATCH)      // if range, convert it\n        src = getdata(src);\n    if (src.vt == VT_R8) {      // a single value\n        vbMatrix&lt;double&gt;  A(1, 1);\n        A[1] = src.dblVal;\n        return A;\n    }\n    else if ((src.vt &amp; VT_VARIANT) != 0) {\n        vbMatrix&lt;VARIANT&gt; v(&amp;src.parray);\n        vbMatrix&lt;double&gt;  A(v.rows, v.cols);\n        for (int j = 1; j &lt;= v.cols; j++)\n            for (int i = 1; i &lt;= v.rows; i++)\n                A(i, j) = v(i, j).dblVal;\n        return A;\n    }\n    else {\n        LPSAFEARRAY a = getarray(src);\n        return a;\n    }\n}\n</code></pre>\n\n<p>Where in vba mat is declared as</p>\n\n<pre><code>Declare PtrSafe Function mat Lib \"lib.dll\" (v) As Double()\n</code></pre>\n\n<p>Now, the range conversion part works (i.e., passing a range everything is fine). But the simplest part, the last two rows, called when the argument is an array of double, just crashes Excel. This runs me crazy, as a reference to the underlying LPSAFEARRAY MUST be inside the Variant. For example, in vba this works:</p>\n\n<pre><code>Dim x() As Double, y() as Double, v as Variant\nx = mat([A])    ' array of doubles\nv = x           ' out in a Variant\ny = v           ' copy to another array of double (= MAKES A COPY)\n</code></pre>\n\n<p>Of course the same would be possible in C++, but I need a reference to the original array, not a copy of it. \nAny solution appreciated.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 7166894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d48074449e3d0e4e9402b333a1151c78?s=128&d=identicon&r=PG&f=1", "display_name": "ela", "link": "https://stackoverflow.com/users/7166894/ela"}, "edited": false, "score": 0, "creation_date": 1480829529, "post_id": 40632948, "comment_id": 69121051, "body": "Thanks for the answer...now I m quite clear on this."}], "tags": [], "owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "is_accepted": false, "score": 0, "last_activity_date": 1479303177, "last_edit_date": 1479303177, "creation_date": 1479301617, "answer_id": 40632948, "question_id": 40630920, "link": "https://stackoverflow.com/questions/40630920/macro-to-paste-values-from-first-cell-to-all-blank-cells-below-till-end-of-row/40632948#40632948", "title": "Macro to paste values from first cell to all blank cells below till end of row", "body": "<p>I think this is what your looking for.  It put's <code>=Today()</code> in all visible cells after filtering using the same range as the autofilter (<code>K5:K819</code>) then replaces the formula with the value.</p>\n\n<p>Looks to me like the rest of your code is unnecessary and you should be able to use just what is below.</p>\n\n<pre><code>ActiveSheet.Range(\"$A$5:$N$819\").AutoFilter Field:=10, Criteria1:=Array(\"DANGER\", \"END\", \"STOCKOUT\"), Operator:=xlFilterValues\nActiveSheet.Range(\"$A$5:$N$819\").AutoFilter Field:=11, Criteria1:=\"=END\", Operator:=xlOr, Criteria2:=\"=\"\nRange(\"K5:K819\").SpecialCells(xlCellTypeVisible).Formula = \"=Today()\"\nRange(\"K5:K819\").SpecialCells(xlCellTypeVisible).Value = Range(\"K5:K819\").SpecialCells(xlCellTypeVisible).Value\n</code></pre>\n\n<p>It's also quite easy to make this dynamic if you have a column that you know will always have a value by doing the following...</p>\n\n<pre><code>Dim LastRow As Long\n\nLastRow = Cells(Rows.Count, \"J\").End(xlUp).Row\n\nActiveSheet.Range(\"$A$5:$N\" &amp; LastRow).AutoFilter Field:=10, Criteria1:=Array(\"DANGER\", \"END\", \"STOCKOUT\"), Operator:=xlFilterValues\nActiveSheet.Range(\"$A$5:$N\" &amp; LastRow).AutoFilter Field:=11, Criteria1:=\"=END\", Operator:=xlOr, Criteria2:=\"=\"\nRange(\"K5:K\" &amp; LastRow).SpecialCells(xlCellTypeVisible).Formula = \"=Today()\"\nRange(\"K5:K\" &amp; LastRow).SpecialCells(xlCellTypeVisible).Value = Range(\"K6:K\" &amp; LastRow).SpecialCells(xlCellTypeVisible).Value\n\nActiveSheet.Range(\"$A$5:$N\" &amp; LastRow).AutoFilter\n</code></pre>\n\n<p>The above code finds the last row with data (in this case it's searching column J) and then uses that to filter the data and then I just added some code to remove the filter.  The last row search must be done on a column that you're sure will always have data.  If it's incorrect change the <code>J</code> in <code>LastRow = Cells(Rows.Count, \"J\").End(xlUp).Row</code> the column you want.</p>\n"}], "owner": {"reputation": 9, "user_id": 7166894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d48074449e3d0e4e9402b333a1151c78?s=128&d=identicon&r=PG&f=1", "display_name": "ela", "link": "https://stackoverflow.com/users/7166894/ela"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 428, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479303177, "creation_date": 1479295479, "last_edit_date": 1531164843, "question_id": 40630920, "link": "https://stackoverflow.com/questions/40630920/macro-to-paste-values-from-first-cell-to-all-blank-cells-below-till-end-of-row", "title": "Macro to paste values from first cell to all blank cells below till end of row", "body": "<p>filtering 3 criterias from coumn1,\nfiltering blank cells corresponding to column 1 result,\nI am trying to apply TODAY formula and paste as values in selected blanks only\nbut its applying on full range(k7:k818) pls help me to recover from this.</p>\n\n<pre><code>Range(\"K5\").Select\n        Selection.AutoFilter\n        Range(\"K5\").Select\n        ActiveSheet.Range(\"$A$5:$N$819\").AutoFilter Field:=10, Criteria1:=Array( \"DANGER\", \"END\", \"STOCKOUT\"), Operator:=xlFilterValues \n        ActiveSheet.Range(\"$A$5:$N$819\").AutoFilter Field:=11, Criteria1:=\"=END\", _\n            Operator:=xlOr, Criteria2:=\"=\" \n        Range(\"K6\").Select\n        ActiveCell.FormulaR1C1 = \"=TODAY()\"  (formula is \"=TODAY\")\n        Range(\"K6\").Select\n        Selection.Copy\n        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n            :=False, Transpose:=False\n        Application.CutCopyMode = False\n        Selection.Copy\n        Range(\"K7\").Select\n        Range(Selection, Selection.End(xlDown)).Select_\n\n        Range(\"K7:K818\").Select   \n       Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n            :=False, Transpose:=False\n        Application.CutCopyMode = False\n</code></pre>\n"}, {"tags": ["vba", "excel", "crash"], "comments": [{"owner": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "edited": false, "score": 1, "creation_date": 1479295308, "post_id": 40630757, "comment_id": 68494273, "body": "Hi and welcome to Stack Overflow. Did you try to debug your code to find the line where it is crashing? If so, can you point us out to where it is? Thanks"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1479296005, "post_id": 40630757, "comment_id": 68494669, "body": "What is the error message? Where does it crash?"}], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1479542725, "post_id": 40632246, "comment_id": 68611018, "body": "@ZackJoubert , did you get through it?"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1479299444, "creation_date": 1479299444, "answer_id": 40632246, "question_id": 40630757, "link": "https://stackoverflow.com/questions/40630757/excel-vba-code-causing-crash-unknown-reason/40632246#40632246", "title": "Excel VBA code causing crash - Unknown reason", "body": "<p>maybe simplifying the code could get you closer to the crashing issue</p>\n\n<p>If I correctly get it, your code could boil down to:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)               \n    With Worksheets(CStr(Cells(Target.Row, 2).Value))\n        With .Range(\"J6\", .Range(\"J6\").End(xlDown))\n            Worksheets(\"Summary\").Range(\"J6\").Resize(.rows.count).Value = .Value\n        End With\n    End With\n\n    With Range(\"D5:H16\")\n        If WorksheetFunction.CountA(.Cells) &gt; 0 Then\n            ActiveSheet.Unprotect\n            .Locked = True\n            Intersect(.Cells, Target.EntireColumn).Locked = False\n            ActiveSheet.Protect\n        End If\n    End With\n End Sub\n</code></pre>\n\n<p>to which I'd add the following issues:</p>\n\n<ul>\n<li><p><code>Target</code> size issue</p>\n\n<p>It seems to me you're assuming that <code>Target</code> is always 1 cell <code>range</code>, since you're using:</p>\n\n<pre><code>   Target.Column\n   Target.Row\n</code></pre>\n\n<p>which would return the row and column index of a one-cell <code>range</code> as well as of the up leftmost cell of a multi cells <code>range</code></p>\n\n<p>if you actually want to process a 1 cell <code>range</code> as <code>Target</code> then you must add the following line at the beginning of your sub</p>\n\n<pre><code>If Target.count &gt; 1 Then Exit Sub\n</code></pre>\n\n<p>otherwise be informed that your code would virtually <em>collapse</em> <code>Target</code> to its up leftmost cell</p></li>\n</ul>\n\n<p>2) <code>ThisWorkbook</code> issue </p>\n\n<p>this issue applies if the macro you're starting off from resides in a different workbook than the one the worksheet your're coding <code>Change</code> event handler belongs to</p>\n\n<p>let's say:</p>\n\n<ul>\n<li><p>your <em>main</em> \"KickOff\" macro resides in some \"MyStartingWorkbook\" workbook</p></li>\n<li><p>when you run it, it'll affect the content of \"dataSheet\" worksheet of \"MyDataWorkbook\" workbook</p></li>\n<li><p>your <code>Worksheet_Change()</code> event handler applies to this latter worksheet (i.e. \"dataSheet\" worksheet of \"MyDataWorkbook\" workbook)</p></li>\n</ul>\n\n<p>then</p>\n\n<ul>\n<li><p>at \"KickOff\" macro starting, <code>ThisWorkbook</code> points to \"MyStartingWorkbook\" workbook</p></li>\n<li><p>but as soon as the macro changes the content of \"dataSheet\" worksheet of \"MyDataWorkbook\" workbook, the <code>Worksheet_Change()</code> event handler of this latter is fired and <code>ThisWorkbook</code> switches to \"MyDataWorkbook\" workbook</p>\n\n<p>which may not be what you want, if <code>\"Summary\"</code> and <code>sheet</code> worksheets are to belong to \"MyStartingWorkbook\" workbook</p></li>\n</ul>\n"}], "owner": {"reputation": 550, "user_id": 7167076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0aa42102c4b8017788df3ed27b6917b1?s=128&d=identicon&r=PG&f=1", "display_name": "Zack Joubert", "link": "https://stackoverflow.com/users/7167076/zack-joubert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 373, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479299444, "creation_date": 1479294945, "question_id": 40630757, "link": "https://stackoverflow.com/questions/40630757/excel-vba-code-causing-crash-unknown-reason", "title": "Excel VBA code causing crash - Unknown reason", "body": "<p>Could anyone please tell me why the following code would cause an Excel 2010 crash:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As range)\nDim r As range\nDim r1 As range\nDim c As range\nDim i As Long\nDim j As Long\nDim rows As Long\nDim count As Long\nDim sheet As String\nDim sh As Worksheet\nDim range1 As range\nDim range2 As range\n\nIf WorksheetFunction.CountA(range(\"D5:H16\")) &lt;= 0 Then\n    ActiveSheet.Unprotect\nEnd If\n\nSet c = Target\n\nFor i = 4 To 8\n    For j = 5 To 16\n        If Not i = Target.Column Then\n            If r Is Nothing Then\n                Set r = ActiveSheet.Cells(j, i)\n            Else\n                Set r = Application.Union(r, ActiveSheet.Cells(j, i))\n            End If\n        Else\n            If r1 Is Nothing Then\n                Set r1 = ActiveSheet.Cells(j, i)\n            Else\n                Set r1 = Application.Union(r1, ActiveSheet.Cells(j, i))\n            End If\n        End If\n    Next\nNext\nrows = Target.row\n\nsheet = CStr(ActiveSheet.Cells(rows, 2).Value)\nSet sh = ThisWorkbook.Sheets(sheet)\nMsgBox (sh.Name)\ncount = sh.range(\"J6\").End(xlDown).row\nMsgBox (count)\nSet range1 = ThisWorkbook.Worksheets(\"Summary\").range(\"J6:J\" &amp; count)\nSet range2 = ThisWorkbook.Worksheets(sheet).range(\"J6:J\" &amp; count)\nrange1 = range2.Value\n\nIf WorksheetFunction.CountA(range(\"D5:H16\")) &lt;= 0 Then\n    ActiveSheet.Unprotect\nElse\n    ActiveSheet.Unprotect\n    r1.Cells.Locked = False\n    r.Cells.Locked = True\n    ActiveSheet.Protect\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>What I'm trying to do is to allow a user to select multiple options in a matrix which will then display a list of equipment based on the matrix selection</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba", "dynamic"], "comments": [{"owner": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "edited": false, "score": 0, "creation_date": 1479294184, "post_id": 40629812, "comment_id": 68493559, "body": "Hello. Yes, it is possible to do all that. You can create a button in your worksheet and assign it to a macro that will do all of that that you want."}, {"owner": {"reputation": 45, "user_id": 4465319, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/63fbcf01a7b2ee3ae3c7bbb2d8c3b13e?s=128&d=identicon&r=PG&f=1", "display_name": "NoTeefy", "link": "https://stackoverflow.com/users/4465319/noteefy"}, "reply_to_user": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "edited": false, "score": 0, "creation_date": 1479294358, "post_id": 40629812, "comment_id": 68493673, "body": "And how should I proceed? Which topics are relevant for this? VBA loop through sets, assign macro to key and format elements in VBA?"}, {"owner": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "edited": false, "score": 1, "creation_date": 1479294625, "post_id": 40629812, "comment_id": 68493856, "body": "As far as I understand, you want to work with <a href=\"https://www.google.com.br/webhp?sourceid=chrome-instant&amp;ion=1&amp;espv=2&amp;ie=UTF-8#q=vba+do+while\" rel=\"nofollow noreferrer\"><code>Do While</code> loops</a> for your job, also you want to <a href=\"https://www.google.com.br/webhp?sourceid=chrome-instant&amp;ion=1&amp;espv=2&amp;ie=UTF-8#q=vba%20work%20with%20worksheets\" rel=\"nofollow noreferrer\">Work with Worksheets</a> and <a href=\"https://www.google.com.br/webhp?sourceid=chrome-instant&amp;ion=1&amp;espv=2&amp;ie=UTF-8#q=excel+assign+macro+to+button\" rel=\"nofollow noreferrer\">Assign a Macro to a button</a>. So I think you have a start with those links :)"}, {"owner": {"reputation": 45, "user_id": 4465319, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/63fbcf01a7b2ee3ae3c7bbb2d8c3b13e?s=128&d=identicon&r=PG&f=1", "display_name": "NoTeefy", "link": "https://stackoverflow.com/users/4465319/noteefy"}, "reply_to_user": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "edited": false, "score": 0, "creation_date": 1481110685, "post_id": 40629812, "comment_id": 69240036, "body": "@VictorMoraes Just wanted to inform you that I&#39;ve achieved what I desired. Thanks for the useful links :)"}, {"owner": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "edited": false, "score": 1, "creation_date": 1481116696, "post_id": 40629812, "comment_id": 69244046, "body": "I&#39;m very happy to know that. Thanks for the feedback"}], "owner": {"reputation": 45, "user_id": 4465319, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/63fbcf01a7b2ee3ae3c7bbb2d8c3b13e?s=128&d=identicon&r=PG&f=1", "display_name": "NoTeefy", "link": "https://stackoverflow.com/users/4465319/noteefy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479292309, "creation_date": 1479292309, "question_id": 40629812, "link": "https://stackoverflow.com/questions/40629812/excel-2013-vba-loop-through-set-of-data-and-apply-my-code-to-another-sheet", "title": "Excel 2013 VBA - Loop through set of data and apply my code to another sheet", "body": "<p>I stumbled across the following problem: I have a sheet with my data. It should be dynamic so every user can add as much rows as he wants with the same value formats. Example given:\n<a href=\"https://i.stack.imgur.com/BXIkl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BXIkl.png\" alt=\"The user can add as much subjects as he wants\"></a></p>\n\n<p>As you can see the user can add as much subjects as he wants\nNow I want to build the other sheet with the grades dynamically with it's own formats and looks.\nIt should look like this (without the grades obviously, only the template)\n<a href=\"https://i.stack.imgur.com/ELmiG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ELmiG.png\" alt=\"those are the subjects that get builded dynamically\"></a></p>\n\n<p>My question is: Is this possible with VBA? I didn't do much in Excel with it but my programmer in me tells me that it should be an easy thing to do: Loop through the first sheet and read out which subjects and teacher the user inserted. Now go to the second sheet and insert the subjects with its formats dynamically.\nAnd how can I let the user trigger that build? Is there a possibility to add my function to a button? Thanks for any help &amp; ideas.</p>\n"}, {"tags": ["ms-access", "vba", "ms-office", "ms-access-2016"], "comments": [{"owner": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "edited": false, "score": 0, "creation_date": 1479294353, "post_id": 40629774, "comment_id": 68493671, "body": "Hi. I&#39;ve find <a href=\"http://www.vbaexpress.com/forum/archive/index.php/t-13726.html\" rel=\"nofollow noreferrer\">this solution for Excel</a> that might be helpful to you, if you adapt it to Access"}, {"owner": {"reputation": 19, "user_id": 7068062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/add6f95a42e0a01dcc16d271f56ffa05?s=128&d=identicon&r=PG&f=1", "display_name": "bm00", "link": "https://stackoverflow.com/users/7068062/bm00"}, "reply_to_user": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "edited": false, "score": 0, "creation_date": 1480499401, "post_id": 40629774, "comment_id": 68984158, "body": "I&#39;ll give a look, thanks!"}], "owner": {"reputation": 19, "user_id": 7068062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/add6f95a42e0a01dcc16d271f56ffa05?s=128&d=identicon&r=PG&f=1", "display_name": "bm00", "link": "https://stackoverflow.com/users/7068062/bm00"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 137, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479292385, "creation_date": 1479292194, "last_edit_date": 1479292385, "question_id": 40629774, "link": "https://stackoverflow.com/questions/40629774/using-hidden-files-with-vba", "title": "Using hidden files with VBA", "body": "<p>My MS Access database has to use some files but if I hide them, it throws Error 75 (\"Path/File access error\"). </p>\n\n<p>How can I specify in the part of the code where I write the path to these files, that they are hidden?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1479291740, "post_id": 40629434, "comment_id": 68491871, "body": "show how you are filling <code>FBList</code>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1479291781, "post_id": 40629434, "comment_id": 68491902, "body": "Just curious - have you used index with arrays? I thought it only works with ranges - <a href=\"https://support.office.com/en-us/article/INDEX-function-a5dcf0dd-996d-40a4-a822-b56b061328bd\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1479291972, "post_id": 40629434, "comment_id": 68492037, "body": "@Vityata <a href=\"https://usefulgyaan.wordpress.com/2013/06/12/vba-trick-of-the-week-slicing-an-array-without-loop-application-index/\" rel=\"nofollow noreferrer\">Have a look at this</a>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1479292049, "post_id": 40629434, "comment_id": 68492093, "body": "Hi, I looked it. varArray is a range there. And is it in your case?"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1479293124, "post_id": 40629434, "comment_id": 68492852, "body": "@Vityata Have a look at my update. I&#39;ve added proof that you can use it with arrays"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1479293790, "post_id": 40629434, "comment_id": 68493312, "body": "Well, the only thing I can say is - can you put a stop before <code>Application.WorksheetFunction.Index(tmp, 19, 0)</code> and check what do you have in tmp? Is it array? How does it look like? Is 0 allowed? (Because in the index formula in excel, you are forced to start from 1."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1479293912, "post_id": 40629434, "comment_id": 68493386, "body": "@Vityata The Array gets populated correctly. I&#39;ve stopped it the line before and checked the values and they&#39;re there. I&#39;ve also used <code>typename(tmp)</code> and it returns <code>variant()</code>. I was wondering about base 0 working as well, so I forced base 1 with the array and I still got the same error"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1479295149, "post_id": 40629434, "comment_id": 68494180, "body": "Can you create a minimal, complete, verifiable example (<a href=\"http://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a> )? Since you populate this dictionary of arrays from some unspecified database, no one but you can reproduce what you see."}, {"owner": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "edited": false, "score": 0, "creation_date": 1479297585, "post_id": 40629434, "comment_id": 68495676, "body": "Is the problem with the <code>Index</code> or the <code>Join</code>? ie, what info do you get when you put a watch on <code>Application.WorksheetFunction.Index(tmp, 19, 0)</code>?"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "edited": false, "score": 0, "creation_date": 1479297668, "post_id": 40629434, "comment_id": 68495726, "body": "@bobajob It&#39;s from the index, I&#39;ve tried splitting it into two rows as well. John Coleman - I&#39;m just trying to build a better example"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1479297967, "post_id": 40629434, "comment_id": 68495919, "body": "Are you sure <code>tmp</code> isn&#39;t empty?"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1479298002, "post_id": 40629434, "comment_id": 68495946, "body": "100% I can print it to sheet"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1479300711, "post_id": 40629434, "comment_id": 68497704, "body": "@JohnColeman I&#39;ve added an example file to my question. with an example data output of what comes from the datasource"}], "answers": [{"tags": [], "owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "is_accepted": true, "score": 0, "last_activity_date": 1480284198, "creation_date": 1480284198, "answer_id": 40834450, "question_id": 40629434, "link": "https://stackoverflow.com/questions/40629434/type-mismatch-when-trying-to-slice-a-multidimensional-array/40834450#40834450", "title": "Type mismatch when trying to slice a multidimensional array", "body": "<p>Error happens because <code>Application.WorksheetFunction.Index</code> is limited to 255 characters and your array's values sometimes exceed it.</p>\n\n<p>Exactly as <code>Application.Transpose(vArray)</code> which I used to put in my code, it is a convenient solution, but 65536 row limit and 255 character limit make it unreliable, now I only use a custom function for transposition.</p>\n"}], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 518, "favorite_count": 0, "accepted_answer_id": 40834450, "answer_count": 1, "score": 4, "last_activity_date": 1480284198, "creation_date": 1479291301, "last_edit_date": 1531164843, "question_id": 40629434, "link": "https://stackoverflow.com/questions/40629434/type-mismatch-when-trying-to-slice-a-multidimensional-array", "title": "Type mismatch when trying to slice a multidimensional array", "body": "<p>I've got an array which is stored in a dictionary it's bounds are from (0 to 29 and 0 to 7) and stores a mixture of strings and integers.</p>\n\n<p>I'm trying to get one column of it without looping however every time I do I get a type mismatch error.</p>\n\n<p>I've seen that there is a limit on the size of an array that you can use with application.index but it is no way near that limit.</p>\n\n<pre><code>Dim tmp As Variant\n\n' Get Array from Public Dictionary\ntmp = FBList(214)\n\n' Output a string of values from one column of array\nDebug.Print Join(Application.WorksheetFunction.Index(tmp, 19, 0), \",\")\n</code></pre>\n\n<p>I always get type mismatch on the last line. I have successfully used this with other arrays but not this time.</p>\n\n<p><a href=\"https://www.dropbox.com/s/imle59brj1yprg1/ArraySlicingExample.xlsm?dl=0\" rel=\"nofollow noreferrer\">Example File</a></p>\n\n<blockquote>\n  <p><strong><em>Update: Populating FBList</em></strong></p>\n\n<pre><code>Dim i As Integer, j As Integer, NoCol As Integer, si As Integer, sKey As Integer\n\nSet cn = Nothing\n\nWith FBList\n    .RemoveAll\n    .CompareMode = TextCompare\nEnd With\nWith FBMap\n    .RemoveAll\n    .CompareMode = TextCompare\nEnd With\n\nIf UserList.Count = 0 Or ThisUser = \"\" Then Call UserDL\n\nCall ConnecttoDB\nSet cmd = New ADODB.Command: Set rs = New ADODB.Recordset\n\nWith cmd\n    .CommandTimeout = 120\n    .ActiveConnection = cn\n    .CommandText = \"CSLL.Reports\"\n    .CommandType = adCmdStoredProc\n    .Parameters.refresh\n    .Parameters(\"@Alias\").value = ThisUser\n    On Error GoTo NoConnection\n    Set rs = .Execute\n    On Error GoTo 0\nEnd With\n\nWith rs\n    For i = 0 To .Fields.Count - 1\n        If i = 0 Then\n            FBMap.Add .Fields.Item(0).Name, \"Key\"\n        Else\n            FBMap.Add .Fields.Item(i).Name, i - 1\n        End If\n    Next i\n\n    NoCol = .Fields.Count - 2\n\n    If Not .BOF And Not .EOF Then\n        .MoveLast\n        .MoveFirst\n            While (Not .EOF)\n                    With FBList\n                        ReDim UStemp(0 To NoCol, 0) As Variant\n                        sKey = rs(\"ID\")\n                        If Not .Exists(sKey) Then\n                            For i = 1 To NoCol + 1\n                                UStemp(i - 1, 0) = rs(i)\n                            Next i\n                            .Add sKey, UStemp\n                        ElseIf .Exists(sKey) = True Then\n                            si = UBound(FBList(sKey), 2)\n                            ReDim UStemp(0 To NoCol, 0 To si + 1)\n                            For j = 0 To si + 1\n                                If j &lt;= si Then\n                                    For i = 0 To NoCol\n                                        UStemp(i, j) = .Item(sKey)(i, j)\n                                    Next i\n                                ElseIf j &gt; si Then\n                                    For i = 0 To NoCol\n                                        UStemp(i, j) = rs(i + 1)\n                                    Next i\n                                End If\n                            Next j\n                            .Remove sKey\n                            .Add sKey, UStemp\n                        End If\n                    End With\n                .MoveNext\n            Wend\n        .MoveFirst\n    End If\nEnd With\n\nSet cmd = Nothing: Set rs = Nothing: Set cn = Nothing\n</code></pre>\n  \n  <p>-------- @Vityata Please look at this:</p>\n\n<pre><code>Option Explicit\nPublic Sub ProofOfSlicingWithArray()\n    Dim tmp(1 To 10, 1 To 10) As Variant\n    Dim i As Long, j As Long\n\n    ' Populate multi-dimensional array\n    For i = 1 To 10\n        For j = 1 To 10\n            tmp(i, j) = Int((999 - 100 + 1) * Rnd + 100)\n        Next j\n    Next i\n\n    Debug.Print Join(Application.Index(tmp, 5, 0), \",\")\n\nEnd Sub\n</code></pre>\n</blockquote>\n"}, {"tags": ["vba", "date"], "comments": [{"owner": {"reputation": 878, "user_id": 1509300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MiEeo.png?s=128&g=1", "display_name": "SBF", "link": "https://stackoverflow.com/users/1509300/sbf"}, "edited": false, "score": 0, "creation_date": 1479289264, "post_id": 40628431, "comment_id": 68490261, "body": "Why not using a <a href=\"http://stackoverflow.com/questions/13409653/how-to-add-date-picker-to-vba-userform\">date picker?</a>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1479289354, "post_id": 40628431, "comment_id": 68490307, "body": "Write 04/12/16 and it would appear correctly?"}, {"owner": {"reputation": 41, "user_id": 7155840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30e2466a3136c3746b66f9f3ec792493?s=128&d=identicon&r=PG&f=1", "display_name": "CBooth", "link": "https://stackoverflow.com/users/7155840/cbooth"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1479296259, "post_id": 40628431, "comment_id": 68494823, "body": "@Vityata unfortunately that doesnt work."}, {"owner": {"reputation": 41, "user_id": 7155840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30e2466a3136c3746b66f9f3ec792493?s=128&d=identicon&r=PG&f=1", "display_name": "CBooth", "link": "https://stackoverflow.com/users/7155840/cbooth"}, "reply_to_user": {"reputation": 878, "user_id": 1509300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MiEeo.png?s=128&g=1", "display_name": "SBF", "link": "https://stackoverflow.com/users/1509300/sbf"}, "edited": false, "score": 0, "creation_date": 1479296327, "post_id": 40628431, "comment_id": 68494870, "body": "@SBF I am unable to download things as it is a work project, and it would be breaking policy"}], "answers": [{"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1479303176, "post_id": 40631680, "comment_id": 68499246, "body": "Might be worth replacing <code>2016</code> in your DateSerial with <code>Year(Date())</code> to keep the current year."}, {"owner": {"reputation": 2146, "user_id": 1539189, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/1d143d8e21c38971dbf030c374af9b15?s=128&d=identicon&r=PG&f=1", "display_name": "Robert J.", "link": "https://stackoverflow.com/users/1539189/robert-j"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1479305852, "post_id": 40631680, "comment_id": 68501056, "body": "of course, but that&#39;s the reason why i said that it&#39;s just a demo :)"}, {"owner": {"reputation": 41, "user_id": 7155840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30e2466a3136c3746b66f9f3ec792493?s=128&d=identicon&r=PG&f=1", "display_name": "CBooth", "link": "https://stackoverflow.com/users/7155840/cbooth"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1479373448, "post_id": 40631680, "comment_id": 68532452, "body": "Unfortunately not having any luck with that either @DarrenBartrup-Cook - proving a frustrating task.."}], "tags": [], "owner": {"reputation": 2146, "user_id": 1539189, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/1d143d8e21c38971dbf030c374af9b15?s=128&d=identicon&r=PG&f=1", "display_name": "Robert J.", "link": "https://stackoverflow.com/users/1539189/robert-j"}, "is_accepted": false, "score": 0, "last_activity_date": 1479297667, "creation_date": 1479297667, "answer_id": 40631680, "question_id": 40628431, "link": "https://stackoverflow.com/questions/40628431/vba-date-stays-as-american/40631680#40631680", "title": "VBA Date stays as American", "body": "<p>According to my tests, <code>InputBox</code> returns a <code>string</code>. What I would do, is write the following function (just demo, no error handling in this code):</p>\n\n<pre><code>Private Function ParseDate(sInput As String) As Date\n    Dim sTmp() As String\n    sTmp = Split(sInput, \"/\")\n\n    ParseDate = DateTime.DateSerial(2016, sTmp(1), sTmp(0))\nEnd Function\n</code></pre>\n\n<p>and then simply call it like this:</p>\n\n<pre><code> Dim sResult As String\n sResult = InputBox(\"Enter the first date (Monday) of the week you wish to view, in the format DD/MM\")\n Range(\"H2\").Value = ParseDate(sResult)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7360917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd80d9ec262c19247a673d20bee45335?s=128&d=identicon&r=PG", "display_name": "Ken Ince", "link": "https://stackoverflow.com/users/7360917/ken-ince"}, "is_accepted": false, "score": 0, "last_activity_date": 1483202402, "last_edit_date": 1483202402, "creation_date": 1483201394, "answer_id": 41410013, "question_id": 40628431, "link": "https://stackoverflow.com/questions/40628431/vba-date-stays-as-american/41410013#41410013", "title": "VBA Date stays as American", "body": "<p>This macro, which asks for the date to be printed at the head of an attendance register works for dd/mm/yy or dd/mm in the 21st century.  Could easily be adapted to include 20th cent</p>\n\n<pre><code>Sub Print_Register()\n'\n' Print_Register Macro\nDim MeetingDate, Answer\n\n    Sheets(\"Register\").Select\n    Range(\"A1\").Select\nGetDate:\n    MeetingDate = DateValue(InputBox(\"Enter the date of the meeting.\" &amp; Chr(13) &amp; _\n    \"Note Format\" &amp; Chr(13) &amp; \"Format DD/MM/YY or DD/MM\", \"Meeting Date\", , 10000, 10000))\n    If MeetingDate = \"\" Then GoTo TheEnd\n    If MeetingDate &lt; 36526 Then MeetingDate = MeetingDate + 36525 'If no yy add year 2000\n    Range(\"Current_Meeting_Date\") = MeetingDate\n    Answer = MsgBox(\"Date OK?\", 3)\n    If Answer = 2 Then GoTo TheEnd\n    If Answer = 7 Then GoTo GetDate\n    ExecuteExcel4Macro \"PRINT(1,,,1,,,,,,,,2,,,TRUE,,FALSE)\"\nTheEnd:\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 7155840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30e2466a3136c3746b66f9f3ec792493?s=128&d=identicon&r=PG&f=1", "display_name": "CBooth", "link": "https://stackoverflow.com/users/7155840/cbooth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1483202402, "creation_date": 1479288718, "question_id": 40628431, "link": "https://stackoverflow.com/questions/40628431/vba-date-stays-as-american", "title": "VBA Date stays as American", "body": "<p>I am relatively new to VBA, and I need some help on a code I have been writing. Currently, it looks like this:</p>\n\n<pre><code>Sub RoundedRectangle1_Click()\nSelection.NumberFormat = \"dd mmm yy\"\nRange(\"H2\").ClearContents\n Dim Date1 As ValueChange\nRange(\"H2\").Value = InputBox(\"Enter the first date (Monday) of the week you wish to view, in the format DD/MM\")\nEnd Sub\n</code></pre>\n\n<p>As you can see, I have a pop-up box for the user to manually enter the date, but for some reason, once this is entered it keeps providing an answer in the US format, for instance if I type in 04/12, this will appear as \"12 Apr 16\", rather than \"04 Dec 16\"</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 201, "user_id": 7104146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc96571ea0cc8da0263342a8a3d02c64?s=128&d=identicon&r=PG&f=1", "display_name": "Mladen Savic", "link": "https://stackoverflow.com/users/7104146/mladen-savic"}, "edited": false, "score": 2, "creation_date": 1479288216, "post_id": 40628182, "comment_id": 68489589, "body": "do you have to use VBA? If not, you could do it with SUMIFS formula."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1479288304, "post_id": 40628182, "comment_id": 68489647, "body": "or the old fashioned pivot :)"}, {"owner": {"reputation": 3194, "user_id": 4991677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7dabe78477c4b3697c3284fb556b1eca?s=128&d=identicon&r=PG&f=1", "display_name": "FDavidov", "link": "https://stackoverflow.com/users/4991677/fdavidov"}, "edited": false, "score": 1, "creation_date": 1479289173, "post_id": 40628182, "comment_id": 68490204, "body": "Along with VLOOKUP..."}], "answers": [{"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1479292749, "creation_date": 1479292749, "answer_id": 40629976, "question_id": 40628182, "link": "https://stackoverflow.com/questions/40628182/find-multiple-values/40629976#40629976", "title": "Find multiple values", "body": "<p>you could use this function:</p>\n\n<pre><code>Function GetSum(nomClient As String)\n    With Worksheets(\"secondSheetName\") '&lt;--| change \"secondSheetName\" to your actual second sheet name\n        GetSum = WorksheetFunction.SumIf(.Columns(1), nomClient, .Columns(2)) '&lt;--| change (1) and (2) to your actual correspondent \"client\" and \"Amount\" columns index in your second sheet\n    End With\nEnd Function\n</code></pre>\n\n<p>to be exploited as follows</p>\n\n<pre><code>nomClient = Worksheets(\"firstSheetName\").Range(\"B\" &amp; i).Value ''&lt;--| change \"firstSheetName\" to your actual first sheet name\n\nMsgBox GetSum(nomClient)\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7166551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8af4fa103bd946080d4e28c35278c39?s=128&d=identicon&r=PG&f=1", "display_name": "gtgt", "link": "https://stackoverflow.com/users/7166551/gtgt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 40629976, "answer_count": 1, "score": 1, "last_activity_date": 1479292749, "creation_date": 1479288066, "question_id": 40628182, "link": "https://stackoverflow.com/questions/40628182/find-multiple-values", "title": "Find multiple values", "body": "<p>I have a first sheet</p>\n\n<pre><code>client  ca\n11112   3\n11133   445\n33333   6\n333 666\n</code></pre>\n\n<p>And a second sheet </p>\n\n<pre><code>client  Amount \n11112   12\n11133   22222\n33333   456\n333 234\n11112   44\n11112   78666\n11133   6649\n11133   43438\n</code></pre>\n\n<p>I need to find client code in the sheet2 and add sum(Amount) in sheet 1 </p>\n\n<p>What I have try </p>\n\n<pre><code> nomClient = Range(\"B\" &amp; i).Value\nSet cel = Cells.Find(What:=nomClient, After:=ActiveCell, LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)\n</code></pre>\n\n<p>My problen is Find can't do a sum , how to modify it ?</p>\n\n<p>Many thanks in advance </p>\n"}, {"tags": ["excel", "datepicker", "copy-paste", "vba"], "comments": [{"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1479288259, "post_id": 40628002, "comment_id": 68489620, "body": "it seems you save them as xlsx. There&#39;s your problem! In a xlsx file you can not have macros. Make sure the code saves the files as xlsm."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1479288323, "post_id": 40628002, "comment_id": 68489663, "body": "And I must say, very well written question. You did not leave anything out as far as I can see."}, {"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1479308782, "post_id": 40628002, "comment_id": 68503185, "body": "This might help, <a href=\"http://stackoverflow.com/a/24701884/2521004\">How to copy code from worksheet to worksheet</a> (not module) example"}, {"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "reply_to_user": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1479309016, "post_id": 40628002, "comment_id": 68503366, "body": "@PortlandRunner: Thank you so much for the help. Took the code and tried to run but Compile error: User-defined type not defined. on line &#39;Dim CodeCopy As VBIDE.CodeModule&#39;"}, {"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 1, "creation_date": 1479310158, "post_id": 40628002, "comment_id": 68504194, "body": "I think you&#39;ll need to add a reference to &quot;Microsoft Visual Basic for Applications Extensibility 5.3&quot; for VBIDE to work (haven&#39;t tested).  From editor, Tools -&gt; References, select this box and click Add"}, {"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "reply_to_user": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1479311180, "post_id": 40628002, "comment_id": 68504924, "body": "@PortlandRunner: Thank you for the reference tip. It helped but The bug is now happening on line &#39;Set CodeCopy = ActiveWorkbook.VBProject.VBComponents(&quot;Template&quot;).CodeModule&zwnj;&#8203;&#39; can I change the references to avoid this bug? Thanks again for the help"}, {"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 1, "creation_date": 1479313240, "post_id": 40628002, "comment_id": 68506425, "body": "In Excel 2007, click the Developer item on the main Ribbon and then click the Macro Security item in the Code panel. In that dialog, choose Macro Settings and check the Trust access to the VBA project object model.  Found this <a href=\"http://www.cpearson.com/excel/vbe.aspx\" rel=\"nofollow noreferrer\">info here</a> and tested to make sure it worked :-)"}, {"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1479378715, "post_id": 40628002, "comment_id": 68536302, "body": "All Right Portland Runner. RESULT!! :-) Thank you so much for the help. Much respect from Dublin. How do I give you some points on this bad boy let me know."}], "answers": [{"comments": [{"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1479293138, "post_id": 40628412, "comment_id": 68492865, "body": "Thank you for the compliment. Unfortunately adding fileformat:=52 did not work. I don&#39;t think coping the master will work either I need to actually put the Calendar Form and the Code into each new Workbook. Possible I know but some serious VBA skills needed. :-) Thank you again for the support it is greatly appreciated."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "reply_to_user": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1479293629, "post_id": 40628412, "comment_id": 68493190, "body": "I have never copied vba from one file to another using vba. But here seems to be a  code that may work, have not tested it. <a href=\"http://www.exceltip.com/modules-class-modules-in-vba/copy-modules-from-one-workbook-to-another-using-vba-in-microsoft-excel.html\" rel=\"nofollow noreferrer\">exceltip.com/modules-class-modules-in-vba/&hellip;</a>"}, {"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1479294427, "post_id": 40628412, "comment_id": 68493718, "body": "Thank you again for the help. It is greatly appreciated. There are good examples of copying a Module from one workbook to another but unfortunately my code is not in a module and I am not sure but cannot be in a module. It is in the actual sheet. if you find something that can transfer code in a sheet and not in a module please forward to me. :-) again thank you for the support"}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "reply_to_user": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1479299515, "post_id": 40628412, "comment_id": 68496925, "body": "I see that now. The code is in Sheet1 (?). Again... My advice is to save the original file as a new copy and manipulate the copy. It&#39;s not hard to do. You just need to point the code towards the other file. So in your master file you write for example <code>wb2.range(&quot;A1&quot;).value</code> instead of just <code>range()</code>"}], "tags": [], "owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "is_accepted": false, "score": 0, "last_activity_date": 1479288666, "creation_date": 1479288666, "answer_id": 40628412, "question_id": 40628002, "link": "https://stackoverflow.com/questions/40628002/copy-vba-code-for-date-picker-from-original-sheet-to-copied-workbooks/40628412#40628412", "title": "Copy VBA code for Date picker from Original sheet to Copied Workbooks", "body": "<p>I think the problem is in this line of code:</p>\n\n<pre><code>wb.SaveAs Filename:=\"C:\\Users\\CONNELLP\\Desktop\\Claire Macro\\CRO Countries\\\" &amp; rCountry.Value2 '&lt;--... saves the workbook after the country\n</code></pre>\n\n<p>This saves the file in a standard format, xlsx. Which means no macros.<br>\nIf you try to replace it with this:  </p>\n\n<pre><code>wb.SaveAs Filename:=\"C:\\Users\\CONNELLP\\Desktop\\Claire Macro\\CRO Countries\\\" &amp; rCountry.Value2, fileformat:=52 \n</code></pre>\n\n<p>Then the files should be in xlsm in the folder. </p>\n\n<p>EDIT: Now I noticed that you wrote that the macro opens a new workbook that it copies the data to.<br>\nThat probably means that the fileformat is not the problem.<br>\nIs there any way that you can change the macro to copy \"itself\" and then edit the copied version to whatever you need?<br>\nI think, while your solution is correct for just data, but with passing along vba it makes it harder.  </p>\n\n<p>I recommend that you try to copy the master workbook instead of opening a new one.</p>\n"}], "owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1434, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1502201762, "creation_date": 1479287448, "last_edit_date": 1531161705, "question_id": 40628002, "link": "https://stackoverflow.com/questions/40628002/copy-vba-code-for-date-picker-from-original-sheet-to-copied-workbooks", "title": "Copy VBA code for Date picker from Original sheet to Copied Workbooks", "body": "<p>I hope you can help. I have a piece of code. Essentially what it does is, it opens a dialog box that allows a user to select an excel sheet, then it goes out to the country column (11) filters it, then copies and pastes that country into a new workbook, names the new workbook after that country then repeats the action for the next country, then it saves and closes each Workbook.</p>\n\n<p>It also emails the workbook</p>\n\n<p>My issue is this;</p>\n\n<p>I have a date picker in Column P on the original workbook and it works perfectly. See Picture 1.</p>\n\n<p>But the date picker code is not in a module it is on the Original Workbook in a sheet called \"Template\" See picture 2.</p>\n\n<p>What I would like to happen is when the code runs for the filtering and copying and pasting of countries is for the Date Picker to be available in the copied workbooks. \nIs this possible? at the moment it just remains in the original. </p>\n\n<p>Pic 1 \n<a href=\"https://i.stack.imgur.com/fleKR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fleKR.png\" alt=\"enter image description here\"></a></p>\n\n<p>Pic 2\n<a href=\"https://i.stack.imgur.com/EfnVB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EfnVB.png\" alt=\"enter image description here\"></a></p>\n\n<p>Pic 3 Copied Workbooks form Original based on Column 11 saved in a different location \n<a href=\"https://i.stack.imgur.com/xnCh2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xnCh2.png\" alt=\"enter image description here\"></a></p>\n\n<p>Pic 4\nCopied Workbook No Date Picker \n<a href=\"https://i.stack.imgur.com/EHhle.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EHhle.png\" alt=\"enter image description here\"></a></p>\n\n<p>As always any help would be greatly appreciated My Code is below </p>\n\n<p>Date Picker Code </p>\n\n<pre><code>Option Explicit\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n     'check cells for desired format to trigger the calendarfrm.show routine\n     'otherwise exit the sub\n    Dim DateFormats, DF\n    DateFormats = Array(\"m/d/yy;@\", \"mm/dd/yyyy\")\n    For Each DF In DateFormats\n        If DF = Target.NumberFormat Then\n            If CalendarFrm.HelpLabel.Caption &lt;&gt; \"\" Then\n                CalendarFrm.Height = 191 + CalendarFrm.HelpLabel.Height\n            Else: CalendarFrm.Height = 191\n                CalendarFrm.Show\n            End If\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>The Large piece of code that filters, copies, pastes, formats and emails </p>\n\n<pre><code>Sub Open_Workbook_Dialog()\n\nDim my_FileName As Variant\nDim my_Workbook As Workbook\n\n  MsgBox \"Pick your CRO file\" '&lt;--| txt box for prompt to pick a file\n\n  my_FileName = Application.GetOpenFilename(FileFilter:=\"Excel Files,*.xl*;*.xm*\") '&lt;--| Opens the file window to allow selection\n\n  If my_FileName &lt;&gt; False Then\n    Set my_Workbook = Workbooks.Open(Filename:=my_FileName)\n\n    Call TestThis '&lt;--|Calls the code that highlights blank cell in A,B and C yellow\n\n    Call Worksheet_Change '&lt;--|Calls the code that highlights duplicate values in column X\n\n    Call Filter(my_Workbook) '&lt;--|Calls the Filter Code and executes\n\n  End If\nEnd Sub\n\nPublic Sub Filter(my_Workbook As Workbook)\n  Dim rCountry As Range, helpCol As Range\n  Dim wb As Workbook\n  Dim ws As Worksheet\n  With my_Workbook.Sheets(1) '&lt;--| refer to data worksheet\n    With .UsedRange\n      Set helpCol = .Resize(1, 1).Offset(, .Columns.Count) '&lt;--| get a \"helper\" column just at the right of used range, it'll be used to store unique country names in\n    End With\n\n   With .Range(\"A1:Y\" &amp; .Cells(.Rows.Count, 1).End(xlUp).Row) '&lt;--| refer to its columns \"A:Y\" from row 1 to last non empty row of column \"A\"\n            .Columns(11).AdvancedFilter Action:=xlFilterCopy, CopyToRange:=helpCol, Unique:=True '&lt;-- call AdvancedFilter on 11th column of the referenced range and store its unique values in \"helper\" column\n            Set helpCol = Range(helpCol.Offset(1), helpCol.End(xlDown)) '&lt;--| set range with unique names in (skip header row)\n            For Each rCountry In helpCol '&lt;--| iterate over unique country names range (skip header row)\n                .AutoFilter 11, rCountry.Value2 '&lt;--| filter data on country field (11th column) with current unique country name\n                If Application.WorksheetFunction.Subtotal(103, .Cells.Resize(, 1)) &gt; 1 Then '&lt;--| if any cell other than header ones has been filtered...\n                    Set wb = Application.Workbooks.Add '&lt;--... add new Workbook\n                        wb.SaveAs Filename:=\"C:\\Users\\CONNELLP\\Desktop\\Claire Macro\\CRO Countries\\\" &amp; rCountry.Value2 '&lt;--... saves the workbook after the country\n                            .SpecialCells(xlCellTypeVisible).Copy wb.Sheets(1).Range(\"A1\")\n                               ActiveSheet.Name = rCountry.Value2  '&lt;--... rename it\n                           .SpecialCells(xlCellTypeVisible).Copy ActiveSheet.Range(\"A1\") 'copy data for country under header\n                           Sheets(1).Range(\"A1:Y1\").WrapText = False 'Takes the wrap text off\n                           ActiveWindow.Zoom = 55 'Zooms out the window\n                         Sheets(1).UsedRange.Columns.AutoFit 'Autofits the column\n                    ActiveWorkbook.Save '&lt;--... saves and closes workbook\n                    If ActiveSheet.Name = \"Belgium\" Then '&lt;--... sends email to certain email based on active worksheet name\n                    Call Mail_workbook_Outlook_1 '&lt;--... calls the email sub routine\n                    End If\n                    If ActiveSheet.Name = \"Bulgaria\" Then\n                    Call Mail_workbook_Outlook_2\n                    End If\n                    If ActiveSheet.Name = \"Croatia\" Then\n                    Call Mail_workbook_Outlook_3\n                    End If\n                    If ActiveSheet.Name = \"Czech Republic\" Then\n                    Call Mail_workbook_Outlook_1\n                    End If\n                    'ElseIf ActiveSheet.Name &lt;&gt; \"Belgium\" Then\n                    'Call Mail_workbook_Outlook_2\n                    'End If\n                    wb.Close SaveChanges:=True '&lt;--... saves and closes workbook\n                End If\n            Next\n        End With\n        .AutoFilterMode = False '&lt;--| remove autofilter and show all rows back\n    End With\n    helpCol.Offset(-1).End(xlDown).Clear '&lt;--| clear helper column (header included)\nEnd Sub\n\nPublic Sub TestThis()\nDim wks As Worksheet\n\nSet wks = ActiveWorkbook.Sheets(1)\n\nWith wks\n.AutoFilterMode = False\n.Range(\"A:K\").AutoFilter Field:=11, Criteria1:=\"&lt;&gt;\", Operator:=xlFilterValues\n.Range(\"A:C\").SpecialCells(xlCellTypeBlanks).Interior.Color = 65535\n.AutoFilterMode = False\nEnd With\nEnd Sub\n\nPublic Sub Mail_workbook_Outlook_1()\n'Working in Excel 2000-2016\n'This example send the last saved version of the Activeworkbook\n'For Tips see: http://www.rondebruin.nl/win/winmail/Outlook/tips.htm\n    Dim OutApp As Object\n    Dim OutMail As Object\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n\n    On Error Resume Next\n    With OutMail\n        .to = \"philip.connell@merck.com\"\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = \"This is the Subject line\"\n        .Body = \"This should work for Belgium and Czech Republic\"\n        .Attachments.Add ActiveWorkbook.FullName\n        'You can add other files also like this\n        '.Attachments.Add (\"C:\\test.txt\")\n        .Send   'or use .Display\n    End With\n    On Error GoTo 0\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\nEnd Sub\n\nPublic Sub Mail_workbook_Outlook_2()\n'Working in Excel 2000-2016\n'This example send the last saved version of the Activeworkbook\n'For Tips see: http://www.rondebruin.nl/win/winmail/Outlook/tips.htm\n    Dim OutApp As Object\n    Dim OutMail As Object\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n\n    On Error Resume Next\n    With OutMail\n        .to = \"Philip.Connell@merck.com\"\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = \"This is the Subject line\"\n        .Body = \"Bulgaria\"\n        .Attachments.Add ActiveWorkbook.FullName\n        'You can add other files also like this\n        '.Attachments.Add (\"C:\\test.txt\")\n        .Send   'or use .Display\n    End With\n    On Error GoTo 0\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\nEnd Sub\nPublic Sub Mail_workbook_Outlook_3()\n'Working in Excel 2000-2016\n'This example send the last saved version of the Activeworkbook\n'For Tips see: http://www.rondebruin.nl/win/winmail/Outlook/tips.htm\n    Dim OutApp As Object\n    Dim OutMail As Object\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n\n    On Error Resume Next\n    With OutMail\n        .to = \"Philip.Connell@merck.com\"\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = \"This is the Subject line\"\n        .Body = \"Croatia Only\"\n        .Attachments.Add ActiveWorkbook.FullName\n        'You can add other files also like this\n        '.Attachments.Add (\"C:\\test.txt\")\n        .Send   'or use .Display\n    End With\n    On Error GoTo 0\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\nEnd Sub\nPublic Sub Worksheet_Change()\n'If Target.Row = 1 Then Exit Sub             ' IF ITS A HEADER, DO NOTHING.\n\n    On Error GoTo ErrHandler\n    Application.ScreenUpdating = False\n\n    Dim myDataRng As Range\n    Dim cell As Range\n\n    ' WE WILL SET THE RANGE (SECOND COLUMN).\n    Set myDataRng = Range(\"X1:X\" &amp; Cells(Rows.Count, \"X\").End(xlUp).Row)\n\n    For Each cell In myDataRng\n        cell.Offset(0, 0).Font.Color = vbBlack          ' DEFAULT COLOR.\n\n        ' LOCATE DUPLICATE VALUE(S) IN THE SPECIFIED RANGE OF DATA.\n        If Application.Evaluate(\"COUNTIF(\" &amp; myDataRng.Address &amp; \",\" &amp; cell.Address &amp; \")\") &gt; 1 Then\n            cell.Offset(0, 0).Font.Color = vbRed        ' CHANGE FORE COLOR TO RED.\n        End If\n    Next cell\n\n    Set myDataRng = Nothing\nErrHandler:\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1479294154, "post_id": 40627678, "comment_id": 68493543, "body": "What if the address is 221b? (well, you did use Baker Street, so though I&#39;d best use the famous house number).  That won&#39;t come back as numeric."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 7145110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf37f4c417ab931346d82ec9b9948f0d?s=128&d=identicon&r=PG&f=1", "display_name": "GreySaxon", "link": "https://stackoverflow.com/users/7145110/greysaxon"}, "edited": false, "score": 0, "creation_date": 1479314193, "post_id": 40629933, "comment_id": 68507070, "body": "Thank you for your advice and amended code pointing me in the right direction."}], "tags": [], "owner": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "is_accepted": true, "score": 0, "last_activity_date": 1479294659, "last_edit_date": 1479294659, "creation_date": 1479292638, "answer_id": 40629933, "question_id": 40627678, "link": "https://stackoverflow.com/questions/40627678/concatenate-address-lines-optimisation-and-best-practice/40629933#40629933", "title": "Concatenate address lines - optimisation and best practice", "body": "<p>The first thing I note about this is that you have <code>Application.ScreenUpdating = False</code> without an <code>Application.ScreenUpdating = True</code> at the end, which would be considered bad practice. </p>\n\n<p>However the fact that you felt it necessary to put <code>Application.ScreenUpdating = False</code> in at all is a hint to a big optimisation possibility. </p>\n\n<p>It will (almost) always be faster to do your processing in vba rather than in excel. In this case, that would mean reading the two columns into a vba array, manipulating it in the same way, and reading them back out to excel. </p>\n\n<p><code>Activesheet.UsedRange</code> is also slightly lax in updating itself, so you may want to use something along the lines of <code>Cells(Rows.Count, 1).End(xlUp).Row</code> instead.</p>\n\n<p>For example, this should be a faster version of your code:</p>\n\n<pre><code>Option Explicit\n\nSub concatenateAddressLines()\n    Dim firstUsedColumnNumber As Long\n    firstUsedColumnNumber = ThisWorkbook.ActiveSheet.Range(\"1:1\").Find(\"Add1\").Column\n    Dim lastRowNumber As Long\n    lastRowNumber = Cells(Rows.Count, firstUsedColumnNumber).End(xlUp).Row\n    Dim inputRange As Range\n    Set inputRange = Range(Cells(2, firstUsedColumnNumber), Cells(lastRowNumber, firstUsedColumnNumber + 1))\n    Dim data() As Variant\n    data = inputRange\n    Dim i As Long\n    For i = LBound(data) To UBound(data)\n        If IsNumeric(data(i, 1)) Then\n            data(i, 1) = data(i, 1) &amp; \" \" &amp; data(i, 2)\n            data(i, 2) = \"\"\n        End If\n    Next i\n    inputRange.Value = data\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 7145110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf37f4c417ab931346d82ec9b9948f0d?s=128&d=identicon&r=PG&f=1", "display_name": "GreySaxon", "link": "https://stackoverflow.com/users/7145110/greysaxon"}, "edited": false, "score": 0, "creation_date": 1479314266, "post_id": 40630832, "comment_id": 68507120, "body": "Thank you for the additional advice re array, plenty for me to learn!"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 1, "last_activity_date": 1479296339, "last_edit_date": 1479296339, "creation_date": 1479295186, "answer_id": 40630832, "question_id": 40627678, "link": "https://stackoverflow.com/questions/40627678/concatenate-address-lines-optimisation-and-best-practice/40630832#40630832", "title": "Concatenate address lines - optimisation and best practice", "body": "<p>Using bobajobs suggestion for an array (as it is quicker):</p>\n\n<pre><code>Public Sub ConcatenateAddressLines()\n\n    Dim rAdd1 As Range\n    Dim lLastRow As Long\n    Dim vValues As Variant\n    Dim lCounter As Long\n\n    'Identify the sheet you're using.  All ranges/cells that start with . will reference this sheet.\n    'Google \"With End With VBA\"\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        'Find remembers the last settings used, so best to be specific.\n        Set rAdd1 = .Range(\"1:1\").Find(What:=\"Add1\", _\n                                       After:=.Range(\"A1\"), _\n                                       LookIn:=xlValues, _\n                                       SearchDirection:=xlNext)\n        'Only continue if Add1 is found.\n        'An error occurs if you add .Column to the end of the FIND statement  \n        'and nothing is found.\n        If Not rAdd1 Is Nothing Then\n            'Find the last row in the Add1 column.\n            lLastRow = .Cells(Rows.Count, rAdd1.Column).End(xlUp).Row\n            If lLastRow &gt; 1 Then\n                'Put the range values into an array.\n                vValues = .Range(.Cells(2, rAdd1.Column), .Cells(lLastRow, rAdd1.Column + 1))\n\n                'Loop through the array and place numeric values and streets in first dimension.\n                For lCounter = LBound(vValues) To UBound(vValues)\n                    If IsNumeric(vValues(lCounter, 1)) Then\n                        vValues(lCounter, 1) = vValues(lCounter, 1) &amp; \" \" &amp; vValues(lCounter, 2)\n                    End If\n                Next lCounter\n\n                'Place the values back on the worksheet.\n                rAdd1.Offset(1).Resize(UBound(vValues, 1), UBound(vValues, 2)).Value = vValues\n            End If\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "is_accepted": false, "score": 0, "last_activity_date": 1479321754, "creation_date": 1479321754, "answer_id": 40639857, "question_id": 40627678, "link": "https://stackoverflow.com/questions/40627678/concatenate-address-lines-optimisation-and-best-practice/40639857#40639857", "title": "Concatenate address lines - optimisation and best practice", "body": "<p>Another alternative is to use an autofilter to find numeric rows then enumerate through these rows. This should be quicker than checking each row with IsNumeric()</p>\n\n<pre><code>Sub ConcatenateAddress()\n    On Error GoTo ExitSub\n    Application.ScreenUpdating = False\n\n    Dim wsSrc As Worksheet: Set wsSrc = ActiveSheet\n    Dim Add1 As Range: Set Add1 = wsSrc.UsedRange.Find(\"Add1\", , xlValues, xlWhole)\n\n    If Not Add1 Is Nothing Then\n        Dim Col1 As Long: Col1 = Add1.Column\n        Dim LastRow As Long: LastRow = wsSrc.Columns(Col1).Find(\"*\", SearchDirection:=xlPrevious).Row\n        Dim LastCol As Long: LastCol = wsSrc.UsedRange.Find(\"*\", SearchOrder:=xlByColumns, SearchDirection:=xlPrevious).Column\n\n        Range(Add1, Cells(LastRow, LastCol)).AutoFilter Field:=1, Criteria1:=\"&gt;0\", Operator:=xlAnd\n        With Range(Cells(Add1.Row + 1, Add1.Column), Cells(LastRow, LastCol))\n            For Each Rw In .SpecialCells(xlCellTypeVisible).Rows\n                Cells(Rw.Row, Col1) = Cells(Rw.Row, Col1) &amp; \" \" &amp; Cells(Rw.Row, Col1 + 1)\n                Cells(Rw.Row, Col1 + 1) = \"\"\n            Next Rw\n        End With\n        Range(Add1, Cells(LastRow, LastCol)).AutoFilter\n    End If\n\nExitSub:\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 7145110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf37f4c417ab931346d82ec9b9948f0d?s=128&d=identicon&r=PG&f=1", "display_name": "GreySaxon", "link": "https://stackoverflow.com/users/7145110/greysaxon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 40629933, "answer_count": 3, "score": 1, "last_activity_date": 1479321754, "creation_date": 1479286503, "last_edit_date": 1531164843, "question_id": 40627678, "link": "https://stackoverflow.com/questions/40627678/concatenate-address-lines-optimisation-and-best-practice", "title": "Concatenate address lines - optimisation and best practice", "body": "<p>I have written the following code to look at a list of addresses. Where address line one (Add1) is a building number on its own it is concatenated with address line two (Add2). For example:</p>\n\n<p><strong>Add1</strong> \"10\",  <strong>Add2</strong> \"Baker Street\"</p>\n\n<p>Becomes:</p>\n\n<p><strong>Add1</strong> \"10 Baker Street\", <strong>Add2</strong> \"\"</p>\n\n<pre><code>Sub concatenateAddressLines()\n\nApplication.ScreenUpdating = False\n\n    Dim lastRowNumber As Long\n    lastRowNumber = ActiveSheet.UsedRange.Rows.Count\n    Dim currentRowNumber As Long\n    currentRowNumber = 0\n\n    Range(\"1:1\").Find(\"Add1\").Select\n    ActiveCell.Offset(RowOffset:=1).Activate\n\nDo Until currentRowNumber = lastRowNumber - 1\n\n\n    If IsNumeric(ActiveCell.Value) Then\n        ActiveCell.Value = ActiveCell.Value &amp; \" \" &amp; ActiveCell.Offset(0, 1).Value\n        ActiveCell.Offset(0, 1).Value = \"\"\n        ActiveCell.Offset(RowOffset:=1).Activate\n        currentRowNumber = currentRowNumber + 1\n    Else\n        ActiveCell.Offset(RowOffset:=1).Activate\n        currentRowNumber = currentRowNumber + 1\n    End If\n\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>(Address line one is always named Add1, but the actual column it is in changes for each file.)</p>\n\n<p>I am new to VBA, but I am aware that I should be avoiding using <em>Select</em> and <em>Activate</em>. If anyone can give me some advice on how to improve this code in terms of best practice and/or optimisation it would be much appreciated. </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1479287105, "post_id": 40627798, "comment_id": 68488888, "body": "&quot;,&quot; or &quot;;&quot; is a setting in the regional settings. Basically it depends on your language"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2506641"}, "edited": false, "score": 0, "creation_date": 1479287199, "post_id": 40627798, "comment_id": 68488957, "body": "Excel separators depend on language... Example, using danish LP in excel, then it&#39;s necessary to separate with semi colon, since comma is already used for decimal separation, instead of like in english as a thousand separator."}, {"owner": {"reputation": 499, "user_id": 7160536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b7c2e2c668ace472a1b0abc47f4421?s=128&d=identicon&r=PG&f=1", "display_name": "ClintB", "link": "https://stackoverflow.com/users/7160536/clintb"}, "edited": false, "score": 0, "creation_date": 1479287326, "post_id": 40627798, "comment_id": 68489046, "body": "Learn something new every day!"}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 1, "creation_date": 1479287406, "post_id": 40627798, "comment_id": 68489096, "body": "Well you are not wrong @ClintB. When you set a formula through VBA you need to use <code>,</code>. If you want to use your local separators, you need to use <code>.FormulaLocal</code>."}, {"owner": {"reputation": 196, "user_id": 3623441, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bf478a27375c1f70408e6b3a5042d2a3?s=128&d=identicon&r=PG&f=1", "display_name": "ArnoldasM", "link": "https://stackoverflow.com/users/3623441/arnoldasm"}, "edited": false, "score": 0, "creation_date": 1479287427, "post_id": 40627798, "comment_id": 68489111, "body": "Thank you, this helped me."}], "tags": [], "owner": {"reputation": 499, "user_id": 7160536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b7c2e2c668ace472a1b0abc47f4421?s=128&d=identicon&r=PG&f=1", "display_name": "ClintB", "link": "https://stackoverflow.com/users/7160536/clintb"}, "is_accepted": true, "score": 3, "last_activity_date": 1479286879, "creation_date": 1479286879, "answer_id": 40627798, "question_id": 40627510, "link": "https://stackoverflow.com/questions/40627510/excel-vba-removes-equal-sign-from-formula/40627798#40627798", "title": "Excel VBA removes equal sign from formula", "body": "<p>You have \";\" in your formula instead of \",\". Perhaps because your formula is erroring its removing it.</p>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1479289129, "creation_date": 1479289129, "answer_id": 40628569, "question_id": 40627510, "link": "https://stackoverflow.com/questions/40627510/excel-vba-removes-equal-sign-from-formula/40628569#40628569", "title": "Excel VBA removes equal sign from formula", "body": "<p>if you are coding like this in Excel, it is a good idea to be aware of the following:</p>\n\n<pre><code>?application.PathSeparator\n?application.DecimalSeparator\n?Application.International(xlFormula)\n</code></pre>\n\n<p>Write them in the immediate window of the VB Editor, to see your results. Then you may use them in VBA code, which would work lets say both in Germany and in the USA.</p>\n"}], "owner": {"reputation": 196, "user_id": 3623441, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bf478a27375c1f70408e6b3a5042d2a3?s=128&d=identicon&r=PG&f=1", "display_name": "ArnoldasM", "link": "https://stackoverflow.com/users/3623441/arnoldasm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 962, "favorite_count": 0, "accepted_answer_id": 40627798, "answer_count": 2, "score": 3, "last_activity_date": 1479289129, "creation_date": 1479285899, "last_edit_date": 1479286706, "question_id": 40627510, "link": "https://stackoverflow.com/questions/40627510/excel-vba-removes-equal-sign-from-formula", "title": "Excel VBA removes equal sign from formula", "body": "<p>I have an issue with vba code. I don't know why, but it removes equal sign in front of formula... Maybe anyone knows how to fix it?</p>\n\n<p><a href=\"https://i.stack.imgur.com/shShu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/shShu.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here  is full source code of Excel Sheet:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim c As Range\n    For Each c In Target.Cells\n        If Not Intersect(c, Range(\"X:AI\")) Is Nothing Then\n            If c &gt; Range(\"H\" &amp; c.Row).Value Or c &lt; Range(\"G\" &amp; c.Row).Value Then\n                c.Font.ColorIndex = 3\n            ElseIf c &lt;= Range(\"H\" &amp; c.Row).Value And c &gt;= Range(\"G\" &amp; c.Row).Value Then\n                c.Font.ColorIndex = 10\n            End If\n\n\n            Dim frml1 As String\n            Dim frml2 As String\n            frml1 = \"LARGE(X\" &amp; c.Row &amp; \":AI\" &amp; c.Row &amp; \";1)\"\n            frml2 = \"SMALL(X\" &amp; c.Row &amp; \":AI\" &amp; c.Row &amp; \";1)\"\n            Range(\"AK\" &amp; c.Row).Value = \"=AVERAGE(X\" &amp; c.Row &amp; \":AI\" &amp; c.Row &amp; \")\"\n            Range(\"AJ\" &amp; c.Row).Value = \"=\" &amp; frml1 &amp; \" - \" &amp; frml2\n        ElseIf Not Intersect(c, Range(\"AL:AM\")) Is Nothing Then\n            If c &gt; Range(\"K\" &amp; c.Row).Value Or c &lt; Range(\"J\" &amp; c.Row).Value Then\n                c.Font.ColorIndex = 3\n            ElseIf c &lt;= Range(\"K\" &amp; c.Row).Value And c &gt;= Range(\"J\" &amp; c.Row).Value Then\n                c.Font.ColorIndex = 10\n            End If\n        ...\n        ElseIf Not Intersect(c, Range(\"AU:AU\")) Is Nothing Then\n            If c &gt; Range(\"Q\" &amp; c.Row).Value Or c &lt; Range(\"P\" &amp; c.Row).Value Then\n                c.Font.ColorIndex = 3\n            ElseIf c &lt;= Range(\"Q\" &amp; c.Row).Value And c &gt;= Range(\"P\" &amp; c.Row).Value Then\n                c.Font.ColorIndex = 10\n            End If\n        ElseIf Not Intersect(c, Range(\"AY:AY\")) Is Nothing Then\n            If c &gt; Range(\"T\" &amp; c.Row).Value Or c &lt; Range(\"S\" &amp; c.Row).Value Then\n                c.Font.ColorIndex = 3\n            ElseIf c &lt;= Range(\"T\" &amp; c.Row).Value And c &gt;= Range(\"S\" &amp; c.Row).Value Then\n                c.Font.ColorIndex = 10\n            End If\n        End If\n    Next c\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1479310754, "post_id": 40627247, "comment_id": 68504636, "body": "I think the parameter box is popping up because the query has a [parameter]  --- you can change this to reference a cell and then just change that cell."}, {"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1479313090, "post_id": 40627247, "comment_id": 68506315, "body": "After going through the trouble of editing the paramter from the connections box, I see that the option for &quot;use this value/reference for future refreshes&quot; --- just type =&quot;E$5$&quot; or whatever cell you want in that box and click &quot;use this value/reference for future refreshes&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 839, "user_id": 4743096, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/650dbef799a7d9f23a6e5a77a0a2cc27?s=128&d=identicon&r=PG&f=1", "display_name": "James D", "link": "https://stackoverflow.com/users/4743096/james-d"}, "edited": false, "score": 0, "creation_date": 1479366314, "post_id": 40637025, "comment_id": 68528574, "body": "You sir, are a legend. Thank you very much for the easy and detailed solution!"}], "tags": [], "owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "is_accepted": true, "score": 2, "last_activity_date": 1479312926, "creation_date": 1479312926, "answer_id": 40637025, "question_id": 40627247, "link": "https://stackoverflow.com/questions/40627247/vba-excel-workbook-refreshall-with-parameter-afterwards/40637025#40637025", "title": "VBA excel Workbook RefreshAll with parameter afterwards", "body": "<p>It's possible that someone put a user input parameter into the query. \nIf we look at an example workbook connection, such as below, we can click \"Properties\" and explore the query.\n<a href=\"https://i.stack.imgur.com/VH3LJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VH3LJ.png\" alt=\"WB Connections\"></a></p>\n\n<p>Example of parameter being requested for this example:\n<a href=\"https://i.stack.imgur.com/1sQwW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1sQwW.png\" alt=\"date parameter box\"></a></p>\n\n<p>Under connection properties \"Definition\" tab we can define where to find the parameters. Click \"parameters\".</p>\n\n<p><a href=\"https://i.stack.imgur.com/us528.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/us528.png\" alt=\"Connection Properties Edit Parameters\"></a></p>\n\n<p>And then we change \"date\" to \"Get value from cell\" (I prefer the refresh automatically on change option too):</p>\n\n<p><a href=\"https://i.stack.imgur.com/uksiH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uksiH.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 839, "user_id": 4743096, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/650dbef799a7d9f23a6e5a77a0a2cc27?s=128&d=identicon&r=PG&f=1", "display_name": "James D", "link": "https://stackoverflow.com/users/4743096/james-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 515, "favorite_count": 0, "accepted_answer_id": 40637025, "answer_count": 1, "score": 1, "last_activity_date": 1479312926, "creation_date": 1479284966, "question_id": 40627247, "link": "https://stackoverflow.com/questions/40627247/vba-excel-workbook-refreshall-with-parameter-afterwards", "title": "VBA excel Workbook RefreshAll with parameter afterwards", "body": "<p>I'm trying to update an excelsheet by using the RefreshAll method, problem is that afterwards the sheet asks me for a date before it can update.<a href=\"https://i.stack.imgur.com/TnzV7.png\" rel=\"nofollow noreferrer\">The parameter box picture (in dutch)</a></p>\n\n<p>I don't have any rights on the server so I can't change anything there, only in the excel file itself.</p>\n\n<p>I was hoping not having to use the sendkeys class, but at this moment I don't really know another solution? </p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7166257, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d0c19439f1a98ad3d874b31900e21cac?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/7166257/mark"}, "edited": false, "score": 0, "creation_date": 1479371436, "post_id": 40627281, "comment_id": 68531336, "body": "hi i have made some changes in the question have a look thnks @Mladen"}], "tags": [], "owner": {"reputation": 201, "user_id": 7104146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc96571ea0cc8da0263342a8a3d02c64?s=128&d=identicon&r=PG&f=1", "display_name": "Mladen Savic", "link": "https://stackoverflow.com/users/7104146/mladen-savic"}, "is_accepted": false, "score": 0, "last_activity_date": 1479285103, "creation_date": 1479285103, "answer_id": 40627281, "question_id": 40627106, "link": "https://stackoverflow.com/questions/40627106/look-for-column-heading-and-sum-up/40627281#40627281", "title": "look for Column heading and sum up", "body": "<p>First you have to format your data as table (select the data -> Menu Insert -> Table). Then you rename your table, for example Table1. Let's say one of the columns you want to sum on the sheet2 is called ColumnName.\nOn the sheet 2 you write a formula </p>\n\n<pre><code>=SUM(Table1[ColumnName])\n</code></pre>\n\n<p>The result will be what you are after.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 7166257, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d0c19439f1a98ad3d874b31900e21cac?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/7166257/mark"}, "edited": false, "score": 0, "creation_date": 1479371707, "post_id": 40633102, "comment_id": 68531479, "body": "hii, @SawanGarg Thanks for the help, i have modified my question to provide more infos ,have a look thnks"}], "tags": [], "owner": {"reputation": 1, "user_id": 7167625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4329b3d9718f6999ec0ac6ee5bba0a4e?s=128&d=identicon&r=PG", "display_name": "Sawan Garg", "link": "https://stackoverflow.com/users/7167625/sawan-garg"}, "is_accepted": false, "score": 0, "last_activity_date": 1479302406, "last_edit_date": 1479302406, "creation_date": 1479302079, "answer_id": 40633102, "question_id": 40627106, "link": "https://stackoverflow.com/questions/40627106/look-for-column-heading-and-sum-up/40633102#40633102", "title": "look for Column heading and sum up", "body": "<p>You should try it by SUMIFS(). Syntax will be </p>\n\n<pre><code>=SUMIFS(AgeRange from sheet1,NameRange Sheet1, Name cell Sheet2, PlaceRangeSh1, Place Cell Sh2)\n</code></pre>\n\n<p>Tell me if requires further help.</p>\n"}], "owner": {"reputation": 3, "user_id": 7166257, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d0c19439f1a98ad3d874b31900e21cac?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/7166257/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1507036974, "creation_date": 1479284465, "last_edit_date": 1507036974, "question_id": 40627106, "link": "https://stackoverflow.com/questions/40627106/look-for-column-heading-and-sum-up", "title": "look for Column heading and sum up", "body": "<p>I have been working with a excel file with a lot of data, which is arranged in 2 sheets.</p>\n\n<p>I would like to get data from sheet 1 to sheet 2 with reference to the column headings.\nFor example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/8B8y2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8B8y2.png\" alt=\"table\"></a></p>\n\n<p>So if I want to find the sum of function 1 person A with criteria 1, the command have to go and find the heading \"sum of function 1\" in sheet 1 and choose the data that are only under criteria 1 and sum it up in sheet 2 cell D5. (By using column heading reference instead of cell reference). \nThe table range is A2 : U80.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1479284448, "post_id": 40626963, "comment_id": 68487381, "body": "Is the first screen shot, 5 columns or 1?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1479284829, "post_id": 40626963, "comment_id": 68487579, "body": "If the screen shot is multiple columns, you could use, an array formula, like <code>=MAX(IFERROR(SEARCH(A1,$A$2:$E$2),0),COLUMN($A$2:$E$2))</code> where A1=&quot;Name&quot; and A:E is the data as in the below screen shot, that gives the column index of the data, wildcards could also be used :)"}, {"owner": {"reputation": 101, "user_id": 6247310, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1172793449438858/picture?type=large", "display_name": "Muhammad Irfan Ali", "link": "https://stackoverflow.com/users/6247310/muhammad-irfan-ali"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1479320220, "post_id": 40626963, "comment_id": 68510997, "body": "Thanks alot Nathan for the valuable input . Really appreciate it. A different perspective."}], "answers": [{"tags": [], "owner": {"reputation": 1322, "user_id": 4709540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n0mOY.jpg?s=128&g=1", "display_name": "Karpak", "link": "https://stackoverflow.com/users/4709540/karpak"}, "is_accepted": true, "score": 0, "last_activity_date": 1479284810, "creation_date": 1479284810, "answer_id": 40627197, "question_id": 40626963, "link": "https://stackoverflow.com/questions/40626963/arrange-excel-cell-row-data-under-relevant-columns/40627197#40627197", "title": "Arrange Excel Cell Row Data under relevant columns", "body": "<p>Match with wildcard should work. Try with </p>\n\n<pre><code>=MATCH(\"Name:*\",1:1,0)\n=MATCH(\"College:*\",1:1,0)\n=MATCH(\"Address:*\",1:1,0)\n=MATCH(\"City:*\",1:1,0)\n=MATCH(\"School:*\",1:1,0)\n</code></pre>\n\n<p>The above works for row 1. If you want to make it for row two replace 1:1 with 2:2 or if you want a specific cells, use A2:E2 etc.</p>\n"}], "owner": {"reputation": 101, "user_id": 6247310, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1172793449438858/picture?type=large", "display_name": "Muhammad Irfan Ali", "link": "https://stackoverflow.com/users/6247310/muhammad-irfan-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 40627197, "answer_count": 1, "score": 0, "last_activity_date": 1481449610, "creation_date": 1479283916, "last_edit_date": 1481449610, "question_id": 40626963, "link": "https://stackoverflow.com/questions/40626963/arrange-excel-cell-row-data-under-relevant-columns", "title": "Arrange Excel Cell Row Data under relevant columns", "body": "<p>I have a large file of excel data where row data is not present under the relevant columns.</p>\n\n<pre><code>         Name      City       School            College         Address\n        City:abc  Name:abc    College:abc   Address:abc     School: abc\n        City:abc  College:abc Name:abc      School: abc     Address:abc\n</code></pre>\n\n<p>I have hundreds of such rows.<br>\nWhat I want is something like this :</p>\n\n<pre><code>Name        City        School       College            Address\nName:abc    City:abc    School:abc   College:abc        Address:abc\nName:abc    City:abc    School:abc   College:abc        Address:abc\n</code></pre>\n\n<p>I have identifiers before semicolon (:) in cell, but can't seem to match it to the column.</p>\n\n<p>I have tried <code>MATCH()</code> Function for identifiers like School etc. but it can't work because Exact Match (Third field of MATCH() Function) won't work, other options can cause errors. Also <code>Filter()</code> doesn't seem to work either.<br>\nKindly help me with an approach that can automate this. Can a formula be made for this or VBA code can work ? \nI don't want to do so much manual work.</p>\n\n<p>THANKS</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>ANSWER:</p>\n\n<p>Thanks Karpak for the answer. I just came up with the following solution before visiting your post.</p>\n\n<p>For others, who are facing a similar problem, try this:</p>\n\n<pre><code>=INDEX(range, MATCH(\"SearcItem\"&amp;\"*\",Range,0), 1)\n</code></pre>\n\n<p>This will return the value of the cell after matching it up.</p>\n\n<p>Happy Coding :)</p>\n"}, {"tags": ["sql", "vba", "excel", "ms-access"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1479285692, "post_id": 40626942, "comment_id": 68488077, "body": "Does Tabelle1 contain Feld4 (s/sheet and table)?  It would be <code>INSERT INTO Tabelle1 SELECT Feld4 FROM [Tabelle1$] IN .....</code> then <code>WHERE (Feld1+Feld2)=Feld4</code>"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1479286824, "post_id": 40626942, "comment_id": 68488714, "body": "I think I misunderstood.  You&#39;ll need <code>UPDATE</code> look at <a href=\"http://www.w3schools.com/sql/sql_update.asp\" rel=\"nofollow noreferrer\">w3schools.com/sql/sql_update.asp</a>"}], "answers": [{"tags": [], "owner": {"reputation": 472, "user_id": 6899593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/000e1cc8d4874fb425a2508604baac39?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamad", "link": "https://stackoverflow.com/users/6899593/mohamad"}, "is_accepted": false, "score": 0, "last_activity_date": 1479309532, "creation_date": 1479309532, "answer_id": 40635766, "question_id": 40626942, "link": "https://stackoverflow.com/questions/40626942/i-want-to-insert-data-from-an-excel-into-an-access-mdb-this-works-already-late/40635766#40635766", "title": "I want to insert data from an Excel into an Access mdb (this works already) later I want to update rows in the mdb with new information", "body": "<p>The following query is based on the fact that when Feld1 = Feld2, then Feld4 takes the value of Feld3.</p>\n\n<pre><code>update Tabelle1 set Feld4 = Feld3 where Feld1=Feld2;\n</code></pre>\n\n<p>Hope this can help!</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7166147, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZUv-9jp6oa0/AAAAAAAAAAI/AAAAAAAAHOY/cf1ydv0ClZg/photo.jpg?sz=128", "display_name": "Purplelama", "link": "https://stackoverflow.com/users/7166147/purplelama"}, "is_accepted": false, "score": 0, "last_activity_date": 1479330180, "creation_date": 1479330180, "answer_id": 40642257, "question_id": 40626942, "link": "https://stackoverflow.com/questions/40626942/i-want-to-insert-data-from-an-excel-into-an-access-mdb-this-works-already-late/40642257#40642257", "title": "I want to insert data from an Excel into an Access mdb (this works already) later I want to update rows in the mdb with new information", "body": "<p>Ok, thank's for the inputs. With those inputs I found a way to do what I want. To make it easier I defined variables first and I also found the right way to write the syntax ;-)</p>\n\n<p>This is what I came up with:</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n\n  Dim objRS As Object\n  Set objRS = CreateObject(\"ADODB.Recordset\")\n\n  Dim Feld1 As Long\n  Dim Feld2 As Long\n  Dim Feld3 As Long\n  Dim Feld4 As String\n  Feld4 = Worksheets(\"Tabelle1\").Cells(3, \"D\").Value\n  MsgBox Feld4\n  Feld1 = Worksheets(\"Tabelle1\").Cells(3, \"A\").Value\n  Feld2 = Worksheets(\"Tabelle1\").Cells(3, \"B\").Value\n\n  objRS.Open \"UPDATE Tabelle1 SET Feld4=\"\"\" &amp; Feld4 &amp; \"\"\" WHERE Feld1=\"\"\" &amp; Feld1 &amp; \"\"\" AND Feld2=\"\"\" &amp; Feld2 &amp; \"\"\"\", _\n      \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" &amp; \"C:\\Users\\icean\\Google Drive\\MyDocuments\\AWA\\ExcelToAccess.mdb\"\n\n  Set objRS = Nothing\n\n\nEnd Sub\n</code></pre>\n\n<p>Of course, this is all just a \"proof of concept\". The real Excel and database I will amend tomorrow, but that's how it's going to work.</p>\n"}], "owner": {"reputation": 1, "user_id": 7166147, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZUv-9jp6oa0/AAAAAAAAAAI/AAAAAAAAHOY/cf1ydv0ClZg/photo.jpg?sz=128", "display_name": "Purplelama", "link": "https://stackoverflow.com/users/7166147/purplelama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 287, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1479330180, "creation_date": 1479283833, "last_edit_date": 1479301865, "question_id": 40626942, "link": "https://stackoverflow.com/questions/40626942/i-want-to-insert-data-from-an-excel-into-an-access-mdb-this-works-already-late", "title": "I want to insert data from an Excel into an Access mdb (this works already) later I want to update rows in the mdb with new information", "body": "<p>I have an Excel file with four columns which are named Feld1, Feld2, Feld3, Feld4.</p>\n\n<p>Excel table example:<br>\n<a href=\"https://i.stack.imgur.com/4VHX0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4VHX0.png\" alt=\"Excel table example\"></a></p>\n\n<p>Now I want to send this data (only Feld1,Feld2Feld3) via a button to an Access mdb which I can do with the following code:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n  Dim objRS As Object\n  Set objRS = CreateObject(\"ADODB.Recordset\")\n  objRS.Open \"INSERT INTO Tabelle1 SELECT Feld1,Feld2,Feld3 FROM [Tabelle1$] IN '\" &amp; ThisWorkbook.FullName &amp; \"' 'Excel 8.0;'\", _\n      \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" &amp; \"c:\\ExcelToAccess.mdb\"\n  Set objRS = Nothing\nEnd Sub\n</code></pre>\n\n<p>This works so far without any problems.</p>\n\n<p>Now, I want to add the information in column \"Feld4\" (think of \"Feld4\" getting the data entered at a later time) later with an UPDATE sql, but unfortunately I have no idea about syntax etc., I just can't get it to work.</p>\n\n<p>Basically the UPDATE sql should look WHERE Feld1+Feld2 match together and then update Feld4 in that same row. </p>\n"}, {"tags": ["c#", "vba", "iis", "shared-memory", "named-pipes"], "comments": [{"owner": {"reputation": 76, "user_id": 5488982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daa6e859758bc57b7febd1d94bdd85bd?s=128&d=identicon&r=PG&f=1", "display_name": "Ben W", "link": "https://stackoverflow.com/users/5488982/ben-w"}, "edited": false, "score": 0, "creation_date": 1479291238, "post_id": 40626693, "comment_id": 68491553, "body": "Using Named Pipes etc is overkill for this. Let IIS do what it does best and serve HTTP requests. Search &quot;vba http request&quot;"}, {"owner": {"reputation": 6332, "user_id": 862175, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/224600de77c90bae03d68d48e491555d?s=128&d=identicon&r=PG", "display_name": "Murtuza Kabul", "link": "https://stackoverflow.com/users/862175/murtuza-kabul"}, "reply_to_user": {"reputation": 76, "user_id": 5488982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daa6e859758bc57b7febd1d94bdd85bd?s=128&d=identicon&r=PG&f=1", "display_name": "Ben W", "link": "https://stackoverflow.com/users/5488982/ben-w"}, "edited": false, "score": 0, "creation_date": 1479386344, "post_id": 40626693, "comment_id": 68541283, "body": "Cannot be done. IIS serves a real time web application using websockets. HTTP request is absolutely impractical for this purpose. The objective here is, get all the changes to excel sheet and pass it over to all connected clients using websocket."}], "owner": {"reputation": 6332, "user_id": 862175, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/224600de77c90bae03d68d48e491555d?s=128&d=identicon&r=PG", "display_name": "Murtuza Kabul", "link": "https://stackoverflow.com/users/862175/murtuza-kabul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 153, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479282791, "creation_date": 1479282791, "question_id": 40626693, "link": "https://stackoverflow.com/questions/40626693/communication-between-web-application-and-office-vba", "title": "communication between web application and office vba", "body": "<p>I have a specific requirement to communicate between Microsoft office document and IIS web application. Essentially, I want to send all the changes done to an excel worksheet cell to IIS.</p>\n\n<p>Currently, my solution is to use a proxy application which accepts TCP/IP connection from VBA using Winsock control which in turn communicates with IIS. I am looking for a way to directly communicate with IIS from VBA itself.</p>\n\n<p>Some of the options I researched are Named Pipes and Shared memory. However, I could not find any practical example or comprehensive document on either of them. My question is, what is the best way to have a one way communication (i.e. from VBA to IIS) ? </p>\n\n<p>Please also suggest if any code example exists to do so.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 55, "user_id": 3370485, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/8de0de0a7945e53a6463399702eab893?s=128&d=identicon&r=PG&f=1", "display_name": "Sandesh Jadhav M", "link": "https://stackoverflow.com/users/3370485/sandesh-jadhav-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1480345029, "creation_date": 1480345029, "answer_id": 40847267, "question_id": 40626375, "link": "https://stackoverflow.com/questions/40626375/convert-an-excel-range-into-image-without-copy-and-paste/40847267#40847267", "title": "Convert an excel range into image without copy and paste", "body": "<p>Found a solution, might not directly solve this.  I have created another instance of windows log in and run this Marco at regular intervals in that instance.</p>\n\n<p>This way we have two different clip boards that will not conflict.</p>\n"}], "owner": {"reputation": 55, "user_id": 3370485, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/8de0de0a7945e53a6463399702eab893?s=128&d=identicon&r=PG&f=1", "display_name": "Sandesh Jadhav M", "link": "https://stackoverflow.com/users/3370485/sandesh-jadhav-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1480345029, "creation_date": 1479281594, "last_edit_date": 1531164843, "question_id": 40626375, "link": "https://stackoverflow.com/questions/40626375/convert-an-excel-range-into-image-without-copy-and-paste", "title": "Convert an excel range into image without copy and paste", "body": "<p>I am looking for a solution were a given excel range can be converted to an image without copy and paste or without putting anything in clipboard.</p>\n\n<p>The reason for this is because the VBA code will be running in the background and the user will continue their regular work.  So when they do any copy and paste activity happens 'oRange.CopyPicture xlScreen, xlPicture' code hits an error.</p>\n\n<p>The tool will run every 60 seconds.</p>\n\n<p>I have checked a lot of web portals to find an answer, but most of them are limited to 'CopyPicture'.  One webpage example given below.</p>\n\n<p><a href=\"http://vbadud.blogspot.com/2010/06/how-to-save-excel-range-as-image-using.html\" rel=\"nofollow noreferrer\">http://vbadud.blogspot.com/2010/06/how-to-save-excel-range-as-image-using.html</a></p>\n\n<p>Can someone please help me.</p>\n"}, {"tags": ["excel", "vba", "increment"], "comments": [{"owner": {"reputation": 1508, "user_id": 7074889, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/o8vth.jpg?s=128&g=1", "display_name": "bzimor", "link": "https://stackoverflow.com/users/7074889/bzimor"}, "edited": false, "score": 0, "creation_date": 1479281789, "post_id": 40626342, "comment_id": 68486205, "body": "Please provide your worksheet screenshot to clearly understand your question"}, {"owner": {"reputation": 7, "user_id": 7166050, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211299303618787/picture?type=large", "display_name": "Murgo", "link": "https://stackoverflow.com/users/7166050/murgo"}, "reply_to_user": {"reputation": 1508, "user_id": 7074889, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/o8vth.jpg?s=128&g=1", "display_name": "bzimor", "link": "https://stackoverflow.com/users/7074889/bzimor"}, "edited": false, "score": 0, "creation_date": 1479282371, "post_id": 40626342, "comment_id": 68486504, "body": "<a href=\"http://imgur.com/a/H1TgP\" rel=\"nofollow noreferrer\">imgur.com/a/H1TgP</a>"}, {"owner": {"reputation": 109, "user_id": 4853118, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/40a1d8458573a99489d7763f42faf7e2?s=128&d=identicon&r=PG&f=1", "display_name": "reef", "link": "https://stackoverflow.com/users/4853118/reef"}, "edited": false, "score": 0, "creation_date": 1479282901, "post_id": 40626342, "comment_id": 68486693, "body": "You&#39;ll probably have to create a function that will check the max IP range you can go to. Wouldn&#39;t you also have to increment by more than just 1 sometimes? Seems to be a bit more complex than just adding 1 like you have for columns F &amp; H"}, {"owner": {"reputation": 7, "user_id": 7166050, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211299303618787/picture?type=large", "display_name": "Murgo", "link": "https://stackoverflow.com/users/7166050/murgo"}, "edited": false, "score": 0, "creation_date": 1479291157, "post_id": 40626342, "comment_id": 68491496, "body": "Actually this one just has to increment by 8, but thats a continuous factor for the entire thing, so I had in mind to just fix that myself after seeing how its done overall."}], "answers": [{"comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1479284714, "post_id": 40627020, "comment_id": 68487505, "body": "Why using a global variable?"}, {"owner": {"reputation": 7, "user_id": 7166050, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211299303618787/picture?type=large", "display_name": "Murgo", "link": "https://stackoverflow.com/users/7166050/murgo"}, "edited": false, "score": 0, "creation_date": 1479285950, "post_id": 40627020, "comment_id": 68488219, "body": "this is a great start, but it kinda gets ruined when the IP reachers 255, as instead of being 255 it should increment the next octet by 1 instead. Any possible addition to counter that problem?"}], "tags": [], "owner": {"reputation": 1508, "user_id": 7074889, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/o8vth.jpg?s=128&g=1", "display_name": "bzimor", "link": "https://stackoverflow.com/users/7074889/bzimor"}, "is_accepted": false, "score": 0, "last_activity_date": 1479291382, "last_edit_date": 1479291382, "creation_date": 1479284141, "answer_id": 40627020, "question_id": 40626342, "link": "https://stackoverflow.com/questions/40626342/how-to-increment-an-ip-address-based-on-a-former-line/40627020#40627020", "title": "How to increment an IP address based on a former line?", "body": "<p>CHANGED!</p>\n\n<p>Put this function:</p>\n\n<pre><code>Function getNextIp(getIp As String) As String\nDim numArr As Variant\nnumArr = Split(getIp, \".\")\nIf numArr(3) = 255 Then\n    If numArr(2) = 255 Then\n        If numArr(1) = 255 Then\n            getNextIp = (numArr(0) + 1) &amp; \".\" &amp; \"1\" &amp; \".\" &amp; \"1\" &amp; \".\" &amp; \"1\"\n        Else\n            getNextIp = numArr(0) &amp; \".\" &amp; (numArr(1) + 1) &amp; \".\" &amp; \"1\" &amp; \".\" &amp; \"1\"\n        End If\n    Else\n            getNextIp = numArr(0) &amp; \".\" &amp; numArr(1) &amp; \".\" &amp; (numArr(2) + 1) &amp; \".\" &amp; \"1\"\n    End If\nElse\n            getNextIp = numArr(0) &amp; \".\" &amp; numArr(1) &amp; \".\" &amp; numArr(2) &amp; \".\" &amp; (numArr(3) + 1)\nEnd If\nEnd Function\n</code></pre>\n\n<p>After that your code will be like this:</p>\n\n<pre><code>Dim IpText As String\nSub newloc()\n   Range(\"A2\").EntireRow.Insert\n   Range(\"D2\").Value = \"Odense C\"\n   Range(\"F2\").Formula = \"=F3 + 1\"\n   IpText = Range(\"G3\").Value\n   Range(\"G2\").Value = getNextIp(IpText)\n   Range(\"H2\").Formula = \"=H3 + 1\"\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7, "user_id": 7166050, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211299303618787/picture?type=large", "display_name": "Murgo", "link": "https://stackoverflow.com/users/7166050/murgo"}, "edited": false, "score": 0, "creation_date": 1479286122, "post_id": 40627322, "comment_id": 68488325, "body": "This looked very promising, but it might just be my lack of VB knowledge, but it only generates a runtime error 13 &quot;type mismatch&quot; I&#39;m betting its a simple mistake on my behalf. I just put the function outside of the sub in the start of the module nad the added the range(&quot;G2&quot;) line inside the sub"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 7, "user_id": 7166050, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211299303618787/picture?type=large", "display_name": "Murgo", "link": "https://stackoverflow.com/users/7166050/murgo"}, "edited": false, "score": 0, "creation_date": 1479286505, "post_id": 40627322, "comment_id": 68488545, "body": "1) put the whole Function code (from <code>Function GetNextIPAddress(baseIP As String) As String</code> to <code>End Function</code>, these included) in any module and outside any other Function or Sub 2) use it in any other Sub code by means of such statements as <code>someRange.Value = GetNextIPAddress(someOtherRange.Value)</code>, where both <code>someRange</code> and <code>someOtherRange</code> must be valid range references"}, {"owner": {"reputation": 7, "user_id": 7166050, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211299303618787/picture?type=large", "display_name": "Murgo", "link": "https://stackoverflow.com/users/7166050/murgo"}, "edited": false, "score": 0, "creation_date": 1479288772, "post_id": 40627322, "comment_id": 68489953, "body": "Well it works now but same problem as with @bzimor &#39;s post it does not increment the next octet after 254. I need some help here for the max number to be 254, and then it will increment the next octet instead of just keep going up in the last octet."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 7, "user_id": 7166050, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211299303618787/picture?type=large", "display_name": "Murgo", "link": "https://stackoverflow.com/users/7166050/murgo"}, "edited": false, "score": 0, "creation_date": 1479289983, "post_id": 40627322, "comment_id": 68490706, "body": "Well, then as per this site rules you should mark answer as accepted, since it solved your <i>original</i> question, that didn&#39;t mention any &quot;254&quot; issue. Anyhow see edited post. But remember, accept/don&#39;t accept answers if they do/don&#39;t solve your question as you <i>originally</i> posted it. While should new issues arise (quite common), make a new post"}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1479290746, "post_id": 40627322, "comment_id": 68491217, "body": "@user3598756 He did say IP. It&#39;s common knowledge that IPs run in the 1-&gt;255 range (don&#39;t know why he want&#39;s 254). And please link to those rules."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1479291408, "post_id": 40627322, "comment_id": 68491661, "body": "@Andreas, maybe it&#39;s a &quot;common knowledge&quot; of yours but not of mine, since I don&#39;t deal with nor bother IP&#39;s. To avoid issues about what could be of &quot;common knowledge&quot;, question must be clear. Anyhow I had edited my post as well"}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1479291769, "post_id": 40627322, "comment_id": 68491894, "body": "@user3598756 OK. Common knowledge or not, don&#39;t get all grumpy about it. I&#39;d say that most of the times you need to correct something on an answer due to incomplete questions. Still waiting for that link."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1479293162, "post_id": 40627322, "comment_id": 68492878, "body": "@Andreas, without even knowing what &quot;grumpy&quot; means  I can say I&#39;m not getting it! As you saw I gave that advice and at the same time I updated my code to follow the new need. As for the link, I&#39;ve read it once and then seen it reminded around here many times: I guess that <a href=\"http://stackoverflow.com/tour\">taking a tour</a> would do"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1479289802, "last_edit_date": 1479289802, "creation_date": 1479285279, "answer_id": 40627322, "question_id": 40626342, "link": "https://stackoverflow.com/questions/40626342/how-to-increment-an-ip-address-based-on-a-former-line/40627322#40627322", "title": "How to increment an IP address based on a former line?", "body": "<p><strong>edited</strong> after OP?s further specifications</p>\n\n<p>you may want to use this function:</p>\n\n<pre><code>Optiion Explicit\n\nFunction GetNextIPAddress(baseIP As String) As String\n    Dim numbersArr As Variant\n    Dim iPos As Long, iNum As Long\n\n    numbersArr = Split(baseIP, \".\") '&lt;--| get all numbers delimited by a \".\" from passed string into an array\n    For iNum = UBound(numbersArr) To 0 Step -1\n        If numbersArr(iNum) &lt;&gt; \"254\" Then Exit For\n    Next iNum\n\n    If iNum = -1 Then\n        GetNextIPAddress = \"Error\"\n    Else\n        iPos = InStrRev(baseIP, numbersArr(iNum))\n        GetNextIPAddress = Left(baseIP, iPos - 1) &amp; numbersArr(iNum) + 1 &amp; Right(baseIP, Len(baseIP) - (iPos + Len(numbersArr(iNum))) + 1)\n    End If\nEnd Function\n</code></pre>\n\n<p>to be exploited in your mnain code as follows</p>\n\n<pre><code>Range(\"G2\").Value = GetNextIPAddress(Range(\"G3\").Value)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "is_accepted": true, "score": 0, "last_activity_date": 1479291024, "last_edit_date": 1479291024, "creation_date": 1479290615, "answer_id": 40629164, "question_id": 40626342, "link": "https://stackoverflow.com/questions/40626342/how-to-increment-an-ip-address-based-on-a-former-line/40629164#40629164", "title": "How to increment an IP address based on a former line?", "body": "<p>Try this one. It counts up to 254 and then does \"+1\" on the next.</p>\n\n<pre><code>Sub newloc()\n    Range(\"A2\").EntireRow.Insert\n    Range(\"D2\").Value = \"Odense C\"\n    Range(\"F2\").Formula = \"=F3 + 1\"\n    Range(\"H2\").Formula = \"=H3 + 1\"\n\n    Arr = Split(Range(\"G3\").Value, \".\")\n    If Arr(3) = 254 Then\n        Arr(3) = 1\n        If Arr(2) &lt; 254 Then\n            Arr(2) = Arr(2) + 1\n        Else\n            Arr(2) = 1\n            If Arr(1) &lt; 254 Then\n                Arr(1) = Arr(1) + 1\n            Else\n                Arr(1) = 1\n                If Arr(0) &lt; 254 Then\n                    Arr(0) = Arr(0) + 1\n                Else\n                    MsgBox \"Error! No more IP's available\"\n                End If\n            End If\n        End If\n    Else\n        Arr(3) = Arr(3) + 1\n    End If\n\n    Range(\"G2\").Value = Join(Arr, \".\")\n\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/5b2re.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5b2re.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>In the image above I have edited the cells to simulate a larger range.</p>\n"}], "owner": {"reputation": 7, "user_id": 7166050, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211299303618787/picture?type=large", "display_name": "Murgo", "link": "https://stackoverflow.com/users/7166050/murgo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 733, "favorite_count": 0, "accepted_answer_id": 40629164, "answer_count": 3, "score": 0, "last_activity_date": 1479291765, "creation_date": 1479281478, "last_edit_date": 1479291765, "question_id": 40626342, "link": "https://stackoverflow.com/questions/40626342/how-to-increment-an-ip-address-based-on-a-former-line", "title": "How to increment an IP address based on a former line?", "body": "<p>First of all I'm a total VBA scrub. I am learning since we use a lot of excel at work, and usually the sheets are just basic with no smarts to them whatsoever. I am trying to make a simple macro which creates a new row at the top of the sheet and then fills it with some blanks and some informations based on the earlier lines. So far it has been going fine, but I am now at a point where I want it to fill in the next IP in line, which it should read from the former line. This is my code so far, and I'm struggling on what to fill in after Range(\"G2\").Value = in order to make it increment the IP fround in G3.</p>\n\n<pre><code>Sub newloc()\nRange(\"A2\").EntireRow.Insert\nRange(\"D2\").Value = \"Odense C\"\nRange(\"F2\").Formula = \"=F3 + 1\"\nRange(\"G2\").Value =\nRange(\"H2\").Formula = \"=H3 + 1\"\n\nEnd Sub\n</code></pre>\n\n<p>As you can see the code is super simple, and as I don't understand much about VBA scripting yet, please come with nice and simple answers. Preferably something I can copy paste, and then explanations to the functions so I can understand why it suddenly works.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1479281806, "post_id": 40626334, "comment_id": 68486213, "body": "Does the code produce an error? If so, where? What is the actual website (I&#39;m assuming www.sample.com is not it)?  Given that it works on some websites but not on one specific other one, means that website might be set up differently..."}, {"owner": {"reputation": 139, "user_id": 6354197, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a567a09d6c27f9bcf8332bd45e3101fc?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6354197/david"}, "reply_to_user": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1479283479, "post_id": 40626334, "comment_id": 68486951, "body": "Yes it does gives me an error &quot;Run Time Error - 424 Object required&quot; and this happens in this step (IE.document.all(&quot;ocsid&quot;).Value = &quot;xx&quot;) !!! I am sorry the website is confidential I will not be in a position to share it !!! Yes this website is designed differently, the other websites will have &quot;ID&quot; or &quot;Class&quot; in the Tags but this doe not !!! so I am stuck !!!"}, {"owner": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1479304585, "post_id": 40626334, "comment_id": 68500216, "body": "Without being able to test against the actual site, any advice would just be clutching at straws."}, {"owner": {"reputation": 139, "user_id": 6354197, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a567a09d6c27f9bcf8332bd45e3101fc?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6354197/david"}, "edited": false, "score": 0, "creation_date": 1479362155, "post_id": 40626334, "comment_id": 68526740, "body": "Thanks for your reply !! As i said i cannot share the address see if this is helpful, i have pasted the page source code of the login area in the original post !!"}], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 6354197, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a567a09d6c27f9bcf8332bd45e3101fc?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6354197/david"}, "edited": false, "score": 0, "creation_date": 1479361543, "post_id": 40642162, "comment_id": 68526522, "body": "Thanks for your reply !! however i am getting an error at this code &quot;IE.document.getElementsByName(&quot;OCS Id&quot;)(0).Value = &quot;xx&quot;&quot; the error is &quot;Run time error - 91&quot; Object variable or with block variable not set&quot;  Also i understand that with out the actually URL it is hard to give an answer !!!"}, {"owner": {"reputation": 138, "user_id": 6282600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9927175bb90e6374a146ab9e598d6c3?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas", "link": "https://stackoverflow.com/users/6282600/lukas"}, "reply_to_user": {"reputation": 139, "user_id": 6354197, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a567a09d6c27f9bcf8332bd45e3101fc?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6354197/david"}, "edited": false, "score": 0, "creation_date": 1479362924, "post_id": 40642162, "comment_id": 68527035, "body": "Have you added the &quot;Microsoft HTML Object Library&quot;-reference to your VBA Project?"}, {"owner": {"reputation": 139, "user_id": 6354197, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a567a09d6c27f9bcf8332bd45e3101fc?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6354197/david"}, "edited": false, "score": 0, "creation_date": 1479364209, "post_id": 40642162, "comment_id": 68527564, "body": "Actually I have not !! but even after adding it and other 2 options which are &quot;Microsoft Internet Controls&quot; and &quot;Microsoft Forms 2.0 Object Library&quot; and then saved and reopened and tried to use the code but still i am getting the error at this code (IE.document.getElementsByName(&quot;ocid&quot;)(0).Value = &quot;xx&quot;) as &quot;Run time error - 91&quot; Object variable or with block variable not set&quot; !!!"}, {"owner": {"reputation": 139, "user_id": 6354197, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a567a09d6c27f9bcf8332bd45e3101fc?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6354197/david"}, "edited": false, "score": 0, "creation_date": 1479364242, "post_id": 40642162, "comment_id": 68527577, "body": "Also an another question do i have to add &quot;Microsoft HTML Object Library&quot;, &quot;Microsoft Internet Controls&quot; and &quot;Microsoft Forms 2.0 Object Library&quot; in every excel i work ??? I am totally new to VBA, sorry to ask you so many questions !!!"}, {"owner": {"reputation": 138, "user_id": 6282600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9927175bb90e6374a146ab9e598d6c3?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas", "link": "https://stackoverflow.com/users/6282600/lukas"}, "reply_to_user": {"reputation": 139, "user_id": 6354197, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a567a09d6c27f9bcf8332bd45e3101fc?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6354197/david"}, "edited": false, "score": 0, "creation_date": 1479388889, "post_id": 40642162, "comment_id": 68542989, "body": "I tested your code and got an error because IE and doc haven&#39;t been initialized. With the initialized values the code is working fine on my PC with Excel 2010 and IE11. It even works without the Microsoft HTML Library. In General, afaik,  if you need to add a library you have to do that once for the Project. If you open the same file on another PC, the library is still there."}, {"owner": {"reputation": 138, "user_id": 6282600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9927175bb90e6374a146ab9e598d6c3?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas", "link": "https://stackoverflow.com/users/6282600/lukas"}, "reply_to_user": {"reputation": 139, "user_id": 6354197, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a567a09d6c27f9bcf8332bd45e3101fc?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6354197/david"}, "edited": false, "score": 0, "creation_date": 1479389133, "post_id": 40642162, "comment_id": 68543166, "body": "Clarification: I haven&#39;t tested your code but the code that I entered in my answer."}, {"owner": {"reputation": 139, "user_id": 6354197, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a567a09d6c27f9bcf8332bd45e3101fc?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6354197/david"}, "edited": false, "score": 0, "creation_date": 1479459628, "post_id": 40642162, "comment_id": 68575963, "body": "Hi Lukas, !!! Thanks for your valuable reply and i respect your efforts !!! However it does not seem to work for me when i copied your code and executed it, i am also using WIN 8,  Excel 2007 and IE 10. I know i must be doing something wrong kindly assist me!! i am getting error on this  line  (doc.GetElementsByName(&quot;ocsid&quot;)(0).Value = &quot;xx&quot;) which says &quot;Object variable or with block variable not set&quot;"}, {"owner": {"reputation": 138, "user_id": 6282600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9927175bb90e6374a146ab9e598d6c3?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas", "link": "https://stackoverflow.com/users/6282600/lukas"}, "reply_to_user": {"reputation": 139, "user_id": 6354197, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a567a09d6c27f9bcf8332bd45e3101fc?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6354197/david"}, "edited": false, "score": 0, "creation_date": 1479489009, "post_id": 40642162, "comment_id": 68595318, "body": "Can you maybe share at least the structure of the website (only the tags with classes, ids and other attributes)? Without that I am afraid I cannot help further."}, {"owner": {"reputation": 139, "user_id": 6354197, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a567a09d6c27f9bcf8332bd45e3101fc?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6354197/david"}, "edited": false, "score": 0, "creation_date": 1479708952, "post_id": 40642162, "comment_id": 68655400, "body": "(Please see my actually post (at the end))"}, {"owner": {"reputation": 138, "user_id": 6282600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9927175bb90e6374a146ab9e598d6c3?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas", "link": "https://stackoverflow.com/users/6282600/lukas"}, "reply_to_user": {"reputation": 139, "user_id": 6354197, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a567a09d6c27f9bcf8332bd45e3101fc?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6354197/david"}, "edited": false, "score": 0, "creation_date": 1479741992, "post_id": 40642162, "comment_id": 68674344, "body": "I&#39;m afraid I cannot help you with this. Regarding .jsp maybe this post helps you (even though it is refered to another error-message):<a href=\"http://stackoverflow.com/questions/36747051/submitting-a-java-script-form-for-jsp-site-through-vba\" title=\"submitting a java script form for jsp site through vba\">stackoverflow.com/questions/36747051/&hellip;</a>"}], "tags": [], "owner": {"reputation": 138, "user_id": 6282600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9927175bb90e6374a146ab9e598d6c3?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas", "link": "https://stackoverflow.com/users/6282600/lukas"}, "is_accepted": false, "score": 1, "last_activity_date": 1479389021, "last_edit_date": 1479389021, "creation_date": 1479329842, "answer_id": 40642162, "question_id": 40626334, "link": "https://stackoverflow.com/questions/40626334/vba-how-to-enter-username-password-and-click-the-submit-button-in-webpage/40642162#40642162", "title": "VBA - How to enter username, password and click the submit button in webpage", "body": "<p>Not sure if it is OK to post this as an answer but what about selecting the input fields by name using <code>getElementsByName</code>?</p>\n\n<pre><code>Sub login()\n    Dim IE As Object\n    Dim doc As Object\n    Set IE = CreateObject(\"InternetExplorer.application\")\n    IE.AddressBar = 0\n    IE.StatusBar = 0\n    IE.Toolbar = 0\n    IE.Visible = True\n    IE.navigate \"www.sample.com\"\n    Do Until Not IE.busy: DoEvents: Loop\n    Set doc = IE.document\n    Do While doc.ReadyState &lt;&gt; \"complete\": DoEvents: Loop\n    doc.GetElementsByName(\"ocsid\")(0).Value = \"xx\"\n    doc.GetElementsByName(\"password\")(0).Value = \"xx\"\n    doc.GetElementsByName(\"Submit\")(0).Click\nEnd Sub\n</code></pre>\n\n<p>Tested with this html file:</p>\n\n<pre><code>&lt;input size=\"15\" type=\"text\" maxlength=\"10\" name=\"ocsid\"&gt;\n&lt;input size=\"15\" type=\"password\" maxlength=\"8\" name=\"password\"&gt;\n&lt;input type=\"submit\" name=\"Submit\" value=\"Submit\" onclick=\"alert('it works')\"&gt;\n</code></pre>\n"}], "owner": {"reputation": 139, "user_id": 6354197, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a567a09d6c27f9bcf8332bd45e3101fc?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6354197/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5284, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479709003, "creation_date": 1479281441, "last_edit_date": 1531164843, "question_id": 40626334, "link": "https://stackoverflow.com/questions/40626334/vba-how-to-enter-username-password-and-click-the-submit-button-in-webpage", "title": "VBA - How to enter username, password and click the submit button in webpage", "body": "<p>Hi I am new to VBA and I am trying to automatically login into a webpage using VBA and I was successful for few websites but for this particular webpage I am unable to do it   </p>\n\n<p>Below is my VBA code : </p>\n\n<pre><code>Sub login ()\n    Set IE = CreateObject(\"InternetExplorer.application\")\n    IE.AddressBar = 0\n    IE.StatusBar = 0\n    IE.Toolbar = 0\n    IE.Visible = True\n    IE.navigate \"www.sample.com\"\n    Do Until Not IE.busy: DoEvents: Loop\n    Set doc = IE.document\n    Do While doc.ReadyState &lt;&gt; \"complete\": DoEvents: Loop\n    IE.document.all(\"ocsid\").Value = \"xx\"\n    IE.document.all(\"password\").Value = \"yy\"\n    IE.document.all(\"Submit\").Click\nEnd Sub\n</code></pre>\n\n<p>Here is the HTML code of the login area which i copied from the web page</p>\n\n<pre><code>    &lt;/TR&gt;\n    &lt;TR&gt;\n    &lt;TD width=\"165\"&gt;&lt;FONT FACE=\"Arial, Helvetica\" SIZE=2&gt;&lt;b&gt;OCS Id:&lt;/b&gt;&lt;/FONT&gt;&lt;/TD&gt;\n    &lt;TD align=\"center\" width=\"95\"&gt;&lt;INPUT size=\"15\" type=\"text\" maxlength=\"10\" name=\"ocsid\"&gt;&lt;/TD&gt;\n     &lt;/TR&gt;\n     &lt;TR&gt;\n     &lt;TD width=\"165\"&gt;&lt;FONT FACE=\"Arial, Helvetica\" SIZE=2&gt;&lt;b&gt;OCS Password&lt;/b&gt;&lt;/FONT&gt;:&lt;/TD&gt;\n     &lt;TD align=\"center\" width=\"95\"&gt;&lt;INPUT size=\"15\" type=\"password\" maxlength=\"8\" name=\"password\"&gt;&lt;/TD&gt;\n     &lt;/TR&gt;\n     &lt;TR&gt;\n     &lt;TD width=\"165\"&gt;&lt;FONT FACE=\"Arial, Helvetica\" SIZE=2&gt;&lt;b&gt;X500 Id:&lt;/b&gt;&lt;/FONT&gt;&lt;/TD&gt;\n     &lt;TD align=\"center\" width=\"95\"&gt;&lt;INPUT size=\"15\" type=\"text\" maxlength=\"10\" name=\"x500id\"&gt;&lt;/TD&gt;\n     &lt;/TR&gt;\n\n    &lt;TR&gt;\n    &lt;TD height=\"15\" width=\"165\"&gt;&lt;/TD&gt;\n    &lt;TD width=\"95\"&gt;&lt;/TD&gt;\n    &lt;/TR&gt;\n    &lt;TR&gt;\n    &lt;TD align=\"center\" width=\"165\" colspan=\"2\"&gt;&lt;INPUT type=\"checkbox\" name=\"changePasswordBox\"  onclick=\"changePassword2();\" /&gt;\n    &lt;FONT FACE=\"Arial, Helvetica\" SIZE=2&gt;&lt;b&gt;Change Password&lt;/b&gt;&lt;/FONT&gt;&lt;/TD&gt;\n    &lt;/TR&gt;                    \n    &lt;/TABLE&gt;\n    &lt;div id=\"HideArea\" &gt;\n    &lt;TABLE width=\"287\"&gt;\n    &lt;TR&gt;\n    &lt;TD width=\"165\"&gt;&lt;FONT FACE=\"Arial, Helvetica\" SIZE=2&gt;&lt;b&gt;New Password:&lt;/b&gt;&lt;/FONT&gt;&lt;/TD&gt;\n    &lt;TD align=\"center\" width=\"95\"&gt;&lt;INPUT size=\"15\" type=\"password\" maxlength=\"8\" name=\"newpassword\"&gt;&lt;/TD&gt;\n    &lt;/TR&gt;\n\n&lt;TR&gt;\n&lt;TD width=\"165\"&gt;&lt;FONT FACE=\"Arial, Helvetica\" SIZE=2&gt;&lt;b&gt;Verify New Password:&lt;/b&gt;&lt;/FONT&gt;&lt;/TD&gt;\n&lt;TD align=\"center\" width=\"95\"&gt;&lt;INPUT size=\"15\" type=\"password\" maxlength=\"8\" name=\"VERIFY_NEW_PWD\" &gt;&lt;/TD&gt;\n&lt;/TR&gt;\n&lt;TR&gt;\n&lt;/TABLE&gt;\n&lt;/div&gt;    \n&lt;TABLE width=\"287\"&gt;\n&lt;TR&gt;\n&lt;TD height=\"15\" width=\"165\"&gt;&lt;/TD&gt;\n&lt;TD width=\"95\"&gt;&lt;/TD&gt;\n&lt;/TR&gt;\n&lt;TR&gt;\n&lt;TD colspan=\"2\" align=\"center\"&gt;&lt;input type=\"submit\" name=\"Submit\" value=\"Submit\" onclick=\"if (top.frames[0] &amp;&amp; top.frames[0].animate) top.frames[0].animate.start();\" style=\"width: 60px\"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;\n&lt;INPUT style=\"width: 60px\" type=\"button\" name=\"Reset\" value=\"Reset\" onClick=\"resetPage();\"&gt;&lt;/TD&gt;\n&lt;/TR&gt;\n</code></pre>\n\n<p>I hope this will help you to answer my question !!</p>\n\n<p>Comments :-\n I am so sorry !! I do not understand what you are asking for ? But i just found out something, when i do a right click on the page using chrome it gives an extra option as \"View Frame Source\", normally all other website which i successfully automated the above process will have only one option as \"View page source\" using which i will find the \"ID\" and \"Tags\" and so on ....  And when i click the \"View page source\" option I do not see any \"ID\" and \"Tags\" instead I have only links which end with .jsp format and when i click the link it takes me to the part of the webpage (like login area) (Legal Notice and Privacy Policy).... I am not sure whether this will help you or not !! But i am truly sorry and I Thank you a lot, for your work !!!!</p>\n"}, {"tags": ["vba", "excel", "arraylist", "runtime-error"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1479279379, "post_id": 40625618, "comment_id": 68485006, "body": "What are the bit level (32 or 64 bit) of the OS and of Excel on the non-working computer, and how do they compare to a PC where there&#39;s no error?  Also compare your .NET install versions across the two machines."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1479279445, "post_id": 40625618, "comment_id": 68485038, "body": "Out of the very issue of your question, you may benefit from placing  <code>Option Explicit</code> statement at the very top of your module to spot every typo: like <code>If sijaint1 = vanhasijaintitieto Then</code> that, maybe, should be <code>If sijainti1 = vanhasijaintitieto Then</code>"}, {"owner": {"reputation": 1407, "user_id": 5835002, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mnMDz.jpg?s=128&g=1", "display_name": "SendETHToThisAddress", "link": "https://stackoverflow.com/users/5835002/sendethtothisaddress"}, "edited": false, "score": 0, "creation_date": 1586941439, "post_id": 40625618, "comment_id": 108310977, "body": "I was getting this error when trying to add an item to my ArrayList"}], "answers": [{"comments": [{"owner": {"reputation": 1407, "user_id": 5835002, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mnMDz.jpg?s=128&g=1", "display_name": "SendETHToThisAddress", "link": "https://stackoverflow.com/users/5835002/sendethtothisaddress"}, "edited": false, "score": 0, "creation_date": 1586942365, "post_id": 56430192, "comment_id": 108311446, "body": "Thanks Dan! I found this was the solution for me as well. This is indeed 1 of the first Google search results for this problem! I had to do another Google search to find out how to install the .NET 3.5 framework and found it. I&#39;ve suggested an appendage to your solution to include those instructions as well so it&#39;s all in 1 place."}, {"owner": {"reputation": 17098, "user_id": 220986, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/40c33b2416f1f0f93497b1f639e7b15f?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisWue", "link": "https://stackoverflow.com/users/220986/chriswue"}, "edited": false, "score": 2, "creation_date": 1592854049, "post_id": 56430192, "comment_id": 110568826, "body": "It seems somewhat insane that one has to install .net 3.5 for this purpose even though <code>ArrayList</code> has never been removed from any .NET framework."}], "tags": [], "owner": {"reputation": 364, "user_id": 2996966, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4c97c88bd17542f361c9f0a5e2356bc?s=128&d=identicon&r=PG&f=1", "display_name": "Dan White", "link": "https://stackoverflow.com/users/2996966/dan-white"}, "is_accepted": true, "score": 7, "last_activity_date": 1586960390, "last_edit_date": 1586960390, "creation_date": 1559574858, "answer_id": 56430192, "question_id": 40625618, "link": "https://stackoverflow.com/questions/40625618/automation-error-2146232576-80131700-on-creating-an-array/56430192#56430192", "title": "automation error -2146232576 (80131700) on creating an array", "body": "<p>I am answering a question that is two and a half years old, but took me way too long to find an answer for this elsewhere, and this still appears near the top of google's results for this issue.</p>\n\n<p>My solution was to install .NET 3.5 even though I had .NET 4.0 installed on my machine. You specifically need the 3.5 version to use <code>System.Collections.ArrayList</code>. Install 3.5 and then close down excel completely and try again.</p>\n\n<p>Here is how to add the library to a PC:</p>\n\n<ol>\n<li>Search for \"turn windows features on or off\". Select the option when it comes up. </li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/t4SmX.jpg\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/t4SmX.jpg\" alt=\"step 1\"></a></p>\n\n<ol start=\"2\">\n<li>Select/check the box for .NET Framework 3.5 (you don't necessarily need to expand and check off the child items). </li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/eMLf4.jpg\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/eMLf4.jpg\" alt=\"step 2\"></a></p>\n\n<ol start=\"3\">\n<li>Let Windows download and install the required files. </li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/OKHNi.jpg\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/OKHNi.jpg\" alt=\"step 3\"></a></p>\n\n<p>Don't forget to close and reopen Excel (or whatever application you're using).</p>\n"}], "owner": {"reputation": 137, "user_id": 5568140, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a1fad6aea9c3b86c3f26c30a1f3a076d?s=128&d=identicon&r=PG&f=1", "display_name": "Joonas", "link": "https://stackoverflow.com/users/5568140/joonas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3954, "favorite_count": 0, "accepted_answer_id": 56430192, "answer_count": 1, "score": 5, "last_activity_date": 1586960390, "creation_date": 1479278472, "last_edit_date": 1531164843, "question_id": 40625618, "link": "https://stackoverflow.com/questions/40625618/automation-error-2146232576-80131700-on-creating-an-array", "title": "automation error -2146232576 (80131700) on creating an array", "body": "<p>I have a macro that's working on one computer just fine, however when I try to run it on another computer I get the following error:</p>\n\n<p>Run-time error '-2146232576 (80131700)'\nAutomation error</p>\n\n<p>Here's the code:</p>\n\n<pre><code>Sub Kaivuri()\nDim i As Long\nDim arvoKohta As Integer\nDim etuKohta As Integer\nDim sukuKohta As Integer\nDim yritysKohta As Integer\nDim tulosMaara As Integer\nDim ws As Worksheet\nDim hakuSana As String\nDim arvo As String\nDim etunimiLista As Object\nDim sukunimiLista As Object\nDim riviLista As Object\nDim kaupunkiLista As Object\nDim lisarivit As Integer\n\nSet kaupunkiLista = CreateObject(\"System.Collections.ArrayList\")\nSet riviLista = CreateObject(\"System.Collections.ArrayList\")\nSet etunimiLista = CreateObject(\"System.Collections.ArrayList\")\nSet sukunimiLista = CreateObject(\"System.Collections.ArrayList\")\n\nSet browserIE = CreateObject(\"InternetExplorer.Application\")\nbrowserIE.Top = 0\nbrowserIE.Left = 800\nbrowserIE.Width = 800\nbrowserIE.Height = 1200\nbrowserIE.Visible = True\n\nSet ws = ThisWorkbook.Worksheets(\"etsint\u00e4\")\ni = 174958\netuKohta = 1\nsukuKohta = 2\nyritysKohta = 5\narvoKohta = 20\n\nbrowserIE.navigate (\"https://www.linkedin.com/sales/search?    facet=G&amp;count=25&amp;start=0&amp;updateHistory=true&amp;searchHistoryId=4444924553\")\nDo While browserIE.ReadyState &lt;&gt; 4 And browserIE.Busy: DoEvents: Loop\nApplication.Wait (Now + TimeValue(\"0:00:5\"))\n\nbrowserIE.document.getelementsbyclassname(\"facet G\") (0).getelementsbyclassname(\"plus-icon-container\")(0).getelementsbyclassname(\"small-icon\")(0).Click\nbrowserIE.document.getelementbyid(\"G-input\").Value = \"Finland\"\n'Application.SendKeys (\"~ (tilde)\")\n'Application.Wait (Now + TimeValue(\"0:00:1\"))\n\nr = 0\nDo While i &lt;= 175000\nIf r = 100 Then\n    ActiveWorkbook.Save\n    r = 0\nEnd If\nlisarivit = 0\nkaupunkiLista.Add (Cells(i, 8).Value)\nriviLista.Add (i)\netunimiLista.Add (Cells(i, etuKohta).Value)\nsukunimiLista.Add (Cells(i, sukuKohta).Value)\n\nDebug.Print i\n'Debug.Print Cells(i + 1, yritysKohta).Value\n\nIf Cells(i, yritysKohta).Value &lt;&gt; Cells(i + 1, yritysKohta).Value Then\n    hakuSana = Cells(i, yritysKohta).Value\n\n    browserIE.document.getelementsbyclassname(\"facet CC\")(0).getelementsbyclassname(\"plus-icon-container\")(0).Click\n    browserIE.document.getelementbyid(\"CC-input\").Value = hakuSana\n    'Application.SendKeys (\"~ (tilde)\")\n    'Application.Wait (Now + TimeValue(\"0:00:1\"))\n\n    tulosMaara = browserIE.document.getelementsbyclassname(\"spotlight-result-count\")(0).innertext\n\n    If tulosMaara &lt;&gt; 0 Then\n\n            p = 1\n\n            Do While p &lt;= tulosMaara\n                l = 0\n\n                Do While l &lt;= 24 And p &lt;= tulosMaara\n                    nimi = browserIE.document.getelementsbyclassname(\"result loading member\")(l).getelementsbyclassname(\"name-and-badge-container\")(0).getelementsbyclassname(\"name\")(0).innertext\n                    Debug.Print nimi\n                    Debug.Print \"t: \" &amp; tulosMaara &amp; \" p: \" &amp; p\n                    If nimi &lt;&gt; \"LinkedIn Member\" Then\n                        etunimi = Left(nimi, InStr(nimi, \" \") - 1)\n                        sukunimi = Right(nimi, (Len(nimi) - InStr(nimi, \" \")))\n\n\n                        onko = True\n                        h = 0\n                        pituus = sukunimiLista.Count\n                        Do While h &lt; pituus\n                            If etunimi = etunimiLista(h) And sukunimi = sukunimiLista(h) Then\n                                onko = False\n                                Exit Do\n                            End If\n                            h = h + 1\n                        Loop\n\n                        If onko = True Then\n\n                                arvo = browserIE.document.getelementsbyclassname(\"result loading member\")(l).getelementsbyclassname(\"info\")(0).getelementsbyclassname(\"info-value\")(0).innertext\n                                Debug.Print arvo\n                                e = 0\n                                Do While browserIE.document.getelementsbyclassname(\"result loading member\")(l).getelementsbyclassname(\"info\")(0).getelementsbyclassname(\"info-label\")(e).innertext &lt;&gt; \"Location: \"\n                                    e = e + 1\n                                Loop\n\n                                Sijainti = browserIE.document.getelementsbyclassname(\"result loading member\")(l).getelementsbyclassname(\"info\")(0).getelementsbyclassname(\"info-value\")(e).innertext\n                                Debug.Print Sijainti\n                                If InStr(Sijainti, \" Area,\") &lt;&gt; 0 Then\n                                    Sijainti = Left(Sijainti, InStr(Sijainti, \" Area,\") - 1)\n                                End If\n                                Debug.Print Sijainti\n                                ' rivin lis\u00e4ys ja v\u00e4rj\u00e4ys\n                                f = riviLista(0)\n                                Rows(f).Select\n\n                                Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n                                With Selection.Interior\n                                    .Pattern = xlSolid\n                                    .PatternColorIndex = xlAutomatic\n                                    .Color = 65535\n                                    .TintAndShade = 0\n                                    .PatternTintAndShade = 0\n                                End With\n\n                                i = i + 1\n                                lisarivit = lisarivit + 1\n\n\n                                Cells(f, 8).Value = Sijainti\n\n\n                                If Sijainti = \"Helsinki\" Then\n                                    h = 0\n                                    Do While h &lt; kaupunkiLista.Count\n                                        If kaupunkiLista(h) = \"Espoo\" Or kaupunkiLista(h) = \"ESPOO\" Or kaupunkiLista(h) = \"Helsinki\" Or kaupunkiLista(h) = \"HELSINKI\" Or kaupunkiLista(h) = \"VANTAA\" Or kaupunkiLista(h) = \"Vantaa\" Then\n                                            Cells(f, 6).Value = Cells(riviLista(h) + lisarivit, 6).Value\n                                            Cells(f, 7).Value = Cells(riviLista(h) + lisarivit, 7).Value\n                                            Cells(f, 8).Value = Cells(riviLista(h) + lisarivit, 8).Value\n                                            Cells(f, 9).Value = Cells(riviLista(h) + lisarivit, 9).Value\n                                            Cells(f, 10).Value = Cells(riviLista(h) + lisarivit, 10).Value\n                                            Rows(f).Select\n                                            With Selection.Interior\n                                                .Pattern = xlSolid\n                                                .PatternColorIndex = xlAutomatic\n                                                .Color = 5287936\n                                                .TintAndShade = 0\n                                                .PatternTintAndShade = 0\n                                            End With\n                                            Exit Do\n                                        End If\n                                        h = h + 1\n                                    Loop\n\n                                Else\n                                    h = 0\n                                    sijainti1 = LCase(Sijainti)\n                                    Do While h &lt; kaupunkiLista.Count\n                                        vanhasijaintitieto = LCase(kaupunkiLista(h))\n                                        If sijaint1 = vanhasijaintitieto Then\n                                            Cells(f, 6).Value = Cells(riviLista(h) + 1, 6).Value\n                                            Cells(f, 7).Value = Cells(riviLista(h) + 1, 7).Value\n                                            Cells(f, 8).Value = Cells(riviLista(h) + 1, 8).Value\n                                            Cells(f, 9).Value = Cells(riviLista(h) + 1, 9).Value\n                                            Cells(f, 10).Value = Cells(riviLista(h) + 1, 10).Value\n                                            Rows(f).Select\n                                            With Selection.Interior\n                                                .Pattern = xlSolid\n                                                .PatternColorIndex = xlAutomatic\n                                                .Color = 5287936\n                                                .TintAndShade = 0\n                                                .PatternTintAndShade = 0\n                                            End With\n                                            Exit Do\n                                        End If\n                                        h = h + 1\n                                    Loop\n                                End If\n                                Debug.Print arvo\n                                If InStr(arvo, \" at \") &lt;&gt; 0 Then\n                                    arvo = Left(arvo, InStr(arvo, \" at \") - 1)\n                                End If\n\n                                Cells(f, etuKohta).Value = etunimi\n                                Cells(f, sukuKohta).Value = sukunimi\n                                domain = Right(Cells(f + 1, 3).Value, Len(Cells(f + 1, 3).Value) - InStr(Cells(f + 1, 3).Value, \"@\") + 1)\n                                Cells(f, 3).Value = etunimi &amp; \".\" &amp; sukunimi &amp; domain\n                                Cells(f, 4).Value = \"notBlocked\"\n                                Cells(f, 5).Value = Cells(f + 1, 5).Value\n                                Cells(f, 11).Value = Cells(f + 1, 11).Value\n                                Cells(f, 12).Value = Cells(f + 1, 12).Value\n                                Cells(f, 13).Value = Cells(f + 1, 13).Value\n                                Cells(f, 14).Value = Cells(f + 1, 14).Value\n                                Cells(f, 15).Value = Cells(f + 1, 15).Value\n                                Cells(f, 16).Value = Cells(f + 1, 16).Value\n                                Cells(f, 17).Value = Cells(f + 1, 17).Value\n                                Cells(f, 18).Value = Cells(f + 1, 18).Value\n                                Cells(f, 20).Value = arvo\n                                arvo = \"\"\n                        End If\n                    End If\n                    Debug.Print \"lopussa: \" &amp; p &amp; \" : \" &amp; tulosMaara\n                    l = l + 1\n                    p = p + 1\n                    If p = tulosMaara + 1 Then Exit Do\n                Loop\n\n                If p = tulosMaara + 1 Then Exit Do\n                On Error Resume Next\n                browserIE.document.getelementsbyclassname(\"next-pagination page-link\")(0).getelementsbyclassname(\"artdeco-icon\")(0).Click\n                Do While browserIE.ReadyState &lt;&gt; 4 And browserIE.Busy: DoEvents: Loop\n                Application.Wait (Now + TimeValue(\"0:00:4\"))\n                On Error GoTo 0\n\n            Loop\n\n    End If\n\n\nriviLista.Clear\nkaupunkiLista.Clear\netunimiLista.Clear\nsukunimiLista.Clear\nbrowserIE.document.getelementsbyclassname(\"facet CC\")    (0).getelementsbyclassname(\"dismiss-selection\")(0).Click\nEnd If\n\ni = i + 1\n\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>The error appears on line 16:</p>\n\n<pre><code>Set kaupunkiLista = CreateObject(\"System.Collections.ArrayList\")\n</code></pre>\n\n<p>Any idea why this happens?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1479278318, "post_id": 40625427, "comment_id": 68484543, "body": "What is the problem though? What <b>specifically</b> is preventing you from coding this?"}, {"owner": {"reputation": 3, "user_id": 7165796, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153998136577681/picture?type=large", "display_name": "Mailin", "link": "https://stackoverflow.com/users/7165796/mailin"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1479320098, "post_id": 40625427, "comment_id": 68510930, "body": "Ignorance. Only a 1 week &#39;veteran&#39; of Excel VBA and not knowing the proper term/technique I am in need of makes my searches fruitless."}, {"owner": {"reputation": 3, "user_id": 7165796, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153998136577681/picture?type=large", "display_name": "Mailin", "link": "https://stackoverflow.com/users/7165796/mailin"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1479322694, "post_id": 40625427, "comment_id": 68512328, "body": "I am glad to do the code, if you or someone could guide me in the direction of the type of code needed to accomplish the above request."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1479327695, "post_id": 40625427, "comment_id": 68515150, "body": "For Row 19, you say that&#39;s &quot;already entered&quot;, but &quot;Checkpoint&quot; is on row 16, not row 18, so that doesn&#39;t fit with your &quot;check the row above Signalized Intersection&quot; test...."}, {"owner": {"reputation": 3, "user_id": 7165796, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153998136577681/picture?type=large", "display_name": "Mailin", "link": "https://stackoverflow.com/users/7165796/mailin"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1479328100, "post_id": 40625427, "comment_id": 68515373, "body": "Say Spreadsheet 1 was created by the program being used, the engineer did NOT have to &#39;press the button on recording app&#39; for the recording sample. So there will be NO &quot;Checkpoints&quot; entered into row G.   I NEED the a &quot;Checkpoint&quot; reference in order to calculate data, even if the &quot;Checkpoint&quot; being directly above &quot;Signalized Intersection&quot; is an arbitrary number."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1479328402, "post_id": 40625427, "comment_id": 68515560, "body": "OK then question becomes &quot;how far above &#39;Signalized Intersection&#39; do we look for &#39;Checkpoint&#39; &quot; ?  Up to the previous &#39;Signalized Intersection&#39;  ?"}, {"owner": {"reputation": 3, "user_id": 7165796, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153998136577681/picture?type=large", "display_name": "Mailin", "link": "https://stackoverflow.com/users/7165796/mailin"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1479328488, "post_id": 40625427, "comment_id": 68515618, "body": "Say Spreadsheet 2 was created by the program being used, the engineer DID have to &quot;press the button on recording app&quot; for this recording sample. So now there WILL be a &quot;Checkpoint&quot; entered into row G.  He only pressed that button once though, that happened at row 16 but the &quot;Signalized Intersection&quot; happened a few seconds/minutes later. So there is a gap between the two.  Since there was no button pressed for the first two &quot;Signalized Intersection&quot; data points, I need to code in the missing &quot;Checkpoints&quot;."}, {"owner": {"reputation": 3, "user_id": 7165796, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153998136577681/picture?type=large", "display_name": "Mailin", "link": "https://stackoverflow.com/users/7165796/mailin"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1479328857, "post_id": 40625427, "comment_id": 68515845, "body": "It is always changing and there is no set limit to where a &quot;Checkpoint&quot; will reside within each &quot;Signalized Intersection&quot; datapoint.  When &quot;Checkpoint&quot; is added in manually/macro it will ALWAYS be directly above &quot;Signalized Checkpoint.&quot; When the engineer instructs the program of a &quot;Checkpoint&quot; it will be entered between whatever &quot;Signalized Intersection&quot; data point is falls under.  If the engineer instructs 3 &quot;Checkpoints&quot; then no &quot;Checkpoints&quot; would need to be added."}, {"owner": {"reputation": 3, "user_id": 7165796, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153998136577681/picture?type=large", "display_name": "Mailin", "link": "https://stackoverflow.com/users/7165796/mailin"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1479329854, "post_id": 40625427, "comment_id": 68516407, "body": "1: ScreenShot - Two Data Points I Manually Entered    <a href=\"https://postimg.org/image/if2x0d78z/\" rel=\"nofollow noreferrer\">link</a>      2: ScreenShot - One Checkpoint Engineer Entered VIA data recording app   <a href=\"https://postimg.org/image/8t9ck2g37/\" rel=\"nofollow noreferrer\">link</a>      3: ScreenShot - After my current macro is ran (with above data added)   <a href=\"https://postimg.org/image/8rzeqne9f/\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1479332963, "post_id": 40625427, "comment_id": 68517974, "body": "Are those two items the only text which will be present in that column, or could there be other content?"}, {"owner": {"reputation": 3, "user_id": 7165796, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153998136577681/picture?type=large", "display_name": "Mailin", "link": "https://stackoverflow.com/users/7165796/mailin"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1479336710, "post_id": 40625427, "comment_id": 68519629, "body": "@TimWilliams <a href=\"https://postimg.org/image/8rzeqne9f/\" rel=\"nofollow noreferrer\">link</a> - That is the total text that will be in column G."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1479337068, "post_id": 40625427, "comment_id": 68519761, "body": "In that case see my answer below"}, {"owner": {"reputation": 3, "user_id": 7165796, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153998136577681/picture?type=large", "display_name": "Mailin", "link": "https://stackoverflow.com/users/7165796/mailin"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1479337354, "post_id": 40625427, "comment_id": 68519882, "body": "@TimWilliams Tested, verified, and added into my existing code. Worked fantastic! Thanks much for your help."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1479334810, "creation_date": 1479334810, "answer_id": 40643401, "question_id": 40625427, "link": "https://stackoverflow.com/questions/40625427/searching-specific-column-for-text-then-adding-text-above-if-not-present/40643401#40643401", "title": "Searching Specific Column For Text - Then Adding Text Above IF Not Present", "body": "<p>Something like this:</p>\n\n<pre><code>Const VAL_SIG As String = \"Signalized Intersection\"\nConst VAL_CHECK As String = \"Checkpoint\"\n\nDim bSig As Boolean, bCheck As Boolean, c As Range\nDim n As Long, sht As Worksheet\n\nSet sht = ActiveSheet\nSet c = sht.Range(\"G8\")\n\nDo While Application.CountA(c.EntireRow) &gt; 0\n    If c.Value = VAL_CHECK Then\n        bCheck = True\n    ElseIf c.Value = VAL_SIG Then\n        If Not bCheck Then c.Offset(-1, 0) = VAL_CHECK\n        bCheck = False\n        n = n + 1\n        If n = 3 Then Exit Do 'only expecting 3\n    End If\n    Set c = c.Offset(1, 0)\nLoop\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7165796, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153998136577681/picture?type=large", "display_name": "Mailin", "link": "https://stackoverflow.com/users/7165796/mailin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 40643401, "answer_count": 1, "score": 0, "last_activity_date": 1479334810, "creation_date": 1479277659, "last_edit_date": 1479278218, "question_id": 40625427, "link": "https://stackoverflow.com/questions/40625427/searching-specific-column-for-text-then-adding-text-above-if-not-present", "title": "Searching Specific Column For Text - Then Adding Text Above IF Not Present", "body": "<p>Depending on what the engineer experienced, they would press a button on their data recording application that would AUTOMATICALLY ENTER \"Checkpoint\" into the spreadsheet.</p>\n\n<p>If that button was not pressed, there will be NO \"Checkpoint\" placed and the cells will remain empty.</p>\n\n<p>In order to Calculate/finish my macro, I need to figure out how to add \"Checkpoint\" above the word \"Signalized Intersection\" BUT ONLY if \"Checkpoint\" already doesn't exist above the word \"Signalized Intersection\"</p>\n\n<p>IMPORTANT NOTES: There will be ONLY THREE (3) \"Signalized Intersections\" on spreadsheet.</p>\n\n<p>They are always in column G but never in the same row.</p>\n\n<p>Some sheets will have NO \"Checkpoints\" at all, some will have TWO (2) \"Checkpoints\" etc.</p>\n\n<p>There should ALWAYS be 3 Checkpoints in total (automatic or manually added) with 3 \"Signalized Intersection\" in total (aways automatically added)</p>\n\n<p>EXAMPLE\nG<br>\n1<br>\n2<br>\n3 (NEED MACRO TO FIND THE SIGNALIZED INTERSECTION BELOW, MOVE 1 CELL ABOVE TO THIS SELECTION - THEN CHANGE VALUE TO \"Checkpoint\")<br>\n4 Signalized Intersection<br>\n5<br>\n6<br>\n7<br>\n8<br>\n9<br>\n10<br>\n11 (THEN SEARCH AGAIN AND FIND THE SIGNALIZED INTERSECTION BELOW, MOVE 1 CELL ABOVE TO THIS SELECTION - THEN CHANGE VALUE TO \"Checkpoint\")<br>\n12 Signalized Intersection<br>\n13<br>\n14<br>\n15<br>\n16 Checkpoint 'Automatically Entered From Engineer' - (SINCE THIS ONE WAS ALREADY ENTERED, DISREGARD AND SHUT OFF.)<br>\n17<br>\n18<br>\n19 Signalized Intersection<br>\n20<br></p>\n\n<p>Sorry for the lengthiness, if this isn't clear enough... I will take some screenshots to help clarify.</p>\n\n<p>I have code written for other elements, so I will be adding this new code to it.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1479278421, "post_id": 40625285, "comment_id": 68484586, "body": "Which line triggers the error?"}, {"owner": {"reputation": 45, "user_id": 5253651, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fb83bc4723abdb6404ab2d6c356f9c6f?s=128&d=identicon&r=PG&f=1", "display_name": "KeatonYoung", "link": "https://stackoverflow.com/users/5253651/keatonyoung"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1479283417, "post_id": 40625285, "comment_id": 68486925, "body": "The Call addtolist(selectionlist, list selected) line is highlighted.  I just needed to add MSForms to the beginning."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 5253651, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fb83bc4723abdb6404ab2d6c356f9c6f?s=128&d=identicon&r=PG&f=1", "display_name": "KeatonYoung", "link": "https://stackoverflow.com/users/5253651/keatonyoung"}, "edited": false, "score": 0, "creation_date": 1479283371, "post_id": 40625975, "comment_id": 68486908, "body": "This solved the issue. Thinking back, I saw this in one example online, but it didn&#39;t stick out and I didn&#39;t try it. Thank you! By the way, why do I need to declare MSForms? What makes me have to do that?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 45, "user_id": 5253651, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fb83bc4723abdb6404ab2d6c356f9c6f?s=128&d=identicon&r=PG&f=1", "display_name": "KeatonYoung", "link": "https://stackoverflow.com/users/5253651/keatonyoung"}, "edited": false, "score": 0, "creation_date": 1479284666, "post_id": 40625975, "comment_id": 68487483, "body": "You are welcome. These links (<a href=\"http://wellsr.com/vba/2016/excel/complete-guide-to-excel-vba-form-control-listboxes/\" rel=\"nofollow noreferrer\">link1</a>, <a href=\"https://social.msdn.microsoft.com/Forums/en-US/2519bdf4-e516-4c02-80f7-b5364e6ee0e6/quirk-in-passing-a-combobox-and-listbox-as-a-parameter?forum=exceldev\" rel=\"nofollow noreferrer\">link2</a>)  could help you in understandng the differences. Finally since I solved your question you may want to mark answer as accepted. thank you!"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1479279978, "creation_date": 1479279978, "answer_id": 40625975, "question_id": 40625285, "link": "https://stackoverflow.com/questions/40625285/calling-function-with-listboxes/40625975#40625975", "title": "Calling Function with ListBoxes", "body": "<p>from the code and the error you <em>expose</em>, I'd say you have to change the declaration of your function arguments type to <code>MSForms.ListBox</code>:</p>\n\n<pre><code>Function addtolist(selectionlist As MSForms.ListBox, listselected As MSForms.ListBox)\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 5253651, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fb83bc4723abdb6404ab2d6c356f9c6f?s=128&d=identicon&r=PG&f=1", "display_name": "KeatonYoung", "link": "https://stackoverflow.com/users/5253651/keatonyoung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 508, "favorite_count": 0, "accepted_answer_id": 40625975, "answer_count": 1, "score": 0, "last_activity_date": 1479279978, "creation_date": 1479277029, "last_edit_date": 1531164843, "question_id": 40625285, "link": "https://stackoverflow.com/questions/40625285/calling-function-with-listboxes", "title": "Calling Function with ListBoxes", "body": "<p>I have created a function take two list boxes, take one value from one list box and add that value to another. I placed the function in my Module. Here is the \ncode.</p>\n\n<p>Here is the function:</p>\n\n<pre><code>Function addtolist(selectionlist As ListBox, listselected As ListBox)\n\nFor i = 0 To selectionlist.ListCount - 1\n    If selectionlist.selected(i) = True Then\n        listselected.AddItem selectionlist.List(i)\n\n    End If\n\nNext i\n\nFor i = selectionlist.ListCount - 1 To 0 Step -1\n    If selectionlist.selected(i) = True Then\n        selectionlist.RemoveItem i\n\n    End If\n\nNext i\nEnd Function\n</code></pre>\n\n<p>In the private sub, a button click, I am doing the following:</p>\n\n<pre><code>Call addtolist(selectionlist, listselected)\n</code></pre>\n\n<p>I keep getting Run Time Error '13' Type mismatch. </p>\n\n<p>Please help!</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "is_accepted": true, "score": 1, "last_activity_date": 1479288176, "creation_date": 1479288176, "answer_id": 40628224, "question_id": 40624340, "link": "https://stackoverflow.com/questions/40624340/using-sum-query-to-update-table/40628224#40628224", "title": "Using SUM query to update table", "body": "<p>The query is not updateable if it contains any aggregate function in query or in any of subqueries. As a workaround you can try to use domain functions instead of aggregate - in your case DSum or use temporary table with results of subquery with <code>Sum</code></p>\n"}], "owner": {"reputation": 235, "user_id": 4592859, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/83b0eda24d07ac5c129e0b52b2737fbb?s=128&d=identicon&r=PG&f=1", "display_name": "YellowLarry", "link": "https://stackoverflow.com/users/4592859/yellowlarry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 40628224, "answer_count": 1, "score": 2, "last_activity_date": 1479288176, "creation_date": 1479272142, "question_id": 40624340, "link": "https://stackoverflow.com/questions/40624340/using-sum-query-to-update-table", "title": "Using SUM query to update table", "body": "<p>I am using Access 2013 VBA.  I want to update sum quantity from tblSoldMonthRecord to tbl_POPLan. </p>\n\n<p>Error message is \"Operation must use an uneatable query.\" for below code.</p>\n\n<pre><code>str = \"UPDATE tbl_POPLan INNER JOIN \" &amp; _\n            \"(SELECT Item, SUM(Qty) AS SumQty FROM tblSoldMonthRecord GROUP BY Item) AS A ON \" &amp; _\n        \"tbl_POPLan.Item = A.Item  \" &amp; _\n        \"SET tbl_POPLan.M0 = A.SumQty \"\n\nDoCmd.RunSQL str\n</code></pre>\n\n<p>If I remove SUM from SQL, it works.</p>\n\n<pre><code>str = \"UPDATE tbl_POPLan INNER JOIN \" &amp; _\n            \"(SELECT Item, Qty AS SumQty FROM tblSoldMonthRecord) AS A ON \" &amp; _\n        \"tbl_POPLan.Item = A.Item  \" &amp; _\n        \"SET tbl_POPLan.M0 = A.SumQty \"\n</code></pre>\n\n<p>How can I update sum  value to another table by RunSQL?</p>\n"}, {"tags": ["sql", "sql-server", "vba", "types"], "comments": [{"owner": {"reputation": 10018, "user_id": 1309356, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o45P6.png?s=128&g=1", "display_name": "cha", "link": "https://stackoverflow.com/users/1309356/cha"}, "edited": false, "score": 2, "creation_date": 1479272002, "post_id": 40624262, "comment_id": 68482318, "body": "Is this your real <code>sa</code> password?"}, {"owner": {"reputation": 279739, "user_id": 16076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D29fm.jpg?s=128&g=1", "display_name": "Mitch Wheat", "link": "https://stackoverflow.com/users/16076/mitch-wheat"}, "edited": false, "score": 2, "creation_date": 1479272133, "post_id": 40624262, "comment_id": 68482351, "body": "Don&#39;t use the &#39;sa&#39; user. Period."}, {"owner": {"reputation": 2709, "user_id": 5552667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80ab93af25a6711aced7ee104a7e2ed6?s=128&d=identicon&r=PG&f=1", "display_name": "ZLK", "link": "https://stackoverflow.com/users/5552667/zlk"}, "edited": false, "score": 0, "creation_date": 1479276748, "post_id": 40624262, "comment_id": 68483931, "body": "Try using DATEFORMAT DMY;"}, {"owner": {"reputation": 3194, "user_id": 4991677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7dabe78477c4b3697c3284fb556b1eca?s=128&d=identicon&r=PG&f=1", "display_name": "FDavidov", "link": "https://stackoverflow.com/users/4991677/fdavidov"}, "edited": false, "score": 0, "creation_date": 1479283215, "post_id": 40624262, "comment_id": 68486830, "body": "Format your date column as YYYY-MM-DD and pass it as string."}, {"owner": {"reputation": 11, "user_id": 6934436, "user_type": "registered", "profile_image": "https://graph.facebook.com/1370857039613516/picture?type=large", "display_name": "Manuel Alejandro Balanza Vzque", "link": "https://stackoverflow.com/users/6934436/manuel-alejandro-balanza-vzque"}, "edited": false, "score": 0, "creation_date": 1479307974, "post_id": 40624262, "comment_id": 68502588, "body": "I try in custom and text field. Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 6934436, "user_type": "registered", "profile_image": "https://graph.facebook.com/1370857039613516/picture?type=large", "display_name": "Manuel Alejandro Balanza Vzque", "link": "https://stackoverflow.com/users/6934436/manuel-alejandro-balanza-vzque"}, "is_accepted": false, "score": 0, "last_activity_date": 1479308754, "creation_date": 1479308754, "answer_id": 40635468, "question_id": 40624262, "link": "https://stackoverflow.com/questions/40624262/date-datatype-conversion-error-when-import-from-excel-to-sql-server/40635468#40635468", "title": "Date datatype conversion error when import from Excel to SQL Server", "body": "<p>I can Fix whith this.</p>\n\n<p>Original Code:</p>\n\n<pre><code>conn.Execute \"insert into one_rep_sap_temp  (ACCOUNT, DOC_TYPE, BILL_DOC, REFERENCE, STATUS_PAYMENT, INV_CON, OSALES_FOUR, INV_REF, DOC_NUM, GL, DOC_DATE, DUE_DATE, DOC_CURRENCY, DOC_AMNT, LOC_AMNT, PAY_TERM, POST_K, LINE_N) values ('\" &amp; ACCOUNT &amp; \"', '\" &amp; DOC_TYPE &amp; \"', '\" &amp; BILL_DOC &amp; \"', '\" &amp; REFERENCE &amp; \"', '\" &amp; STATUS_PAYMENT &amp; \"', '\" &amp; INV_CON &amp; \"', '\" &amp; OSALES_FOUR &amp; \"', '\" &amp; INV_REF &amp; \"', '\" &amp; DOC_NUM &amp; \"', '\" &amp; GL &amp; \"', '\" &amp; DOC_DATE &amp; \"', '\" &amp; DUE_DATE &amp; \"', '\" &amp; DOC_CURRENCY &amp; \"', '\" &amp; DOC_AMNT &amp; \"', '\" &amp; LOC_AMNT &amp; \"', '\" &amp; PAY_TERM &amp; \"', '\" &amp; POST_K &amp; \"', '\" &amp; LINE_N &amp; \"')\"\n</code></pre>\n\n<p>New Code:</p>\n\n<pre><code>conn.Execute \"insert into one_rep_sap_temp  (ACCOUNT, DOC_TYPE, BILL_DOC, REFERENCE, STATUS_PAYMENT, INV_CON, OSALES_FOUR, INV_REF, DOC_NUM, GL, DOC_DATE, DUE_DATE, DOC_CURRENCY, DOC_AMNT, LOC_AMNT, PAY_TERM, POST_K, LINE_N) values ('\" &amp; ACCOUNT &amp; \"', '\" &amp; DOC_TYPE &amp; \"', '\" &amp; BILL_DOC &amp; \"', '\" &amp; REFERENCE &amp; \"', '\" &amp; STATUS_PAYMENT &amp; \"', '\" &amp; INV_CON &amp; \"', '\" &amp; OSALES_FOUR &amp; \"', '\" &amp; INV_REF &amp; \"', '\" &amp; DOC_NUM &amp; \"', '\" &amp; GL &amp; \"', '\" &amp; Format(DOC_DATE, \"YYYY-MM-DD\") &amp; \"', '\" &amp; Format(DUE_DATE, \"YYYY-MM-DD\") &amp; \"', '\" &amp; DOC_CURRENCY &amp; \"', '\" &amp; DOC_AMNT &amp; \"', '\" &amp; LOC_AMNT &amp; \"', '\" &amp; PAY_TERM &amp; \"', '\" &amp; POST_K &amp; \"', '\" &amp; LINE_N &amp; \"')\"\n</code></pre>\n\n<p>The fix is this</p>\n\n<p>Format(DOC_DATE, \"YYYY-MM-DD\")</p>\n\n<p>Thank's for your help with this issue. \n:D</p>\n"}], "owner": {"reputation": 11, "user_id": 6934436, "user_type": "registered", "profile_image": "https://graph.facebook.com/1370857039613516/picture?type=large", "display_name": "Manuel Alejandro Balanza Vzque", "link": "https://stackoverflow.com/users/6934436/manuel-alejandro-balanza-vzque"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 572, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1479308754, "creation_date": 1479271683, "last_edit_date": 1479308198, "question_id": 40624262, "link": "https://stackoverflow.com/questions/40624262/date-datatype-conversion-error-when-import-from-excel-to-sql-server", "title": "Date datatype conversion error when import from Excel to SQL Server", "body": "<p>I need help with this case. I need to import a table from Excel to SQL Server, I have two columns of type DATE.</p>\n\n<p>The problem is when run the macro, show the following message </p>\n\n<blockquote>\n  <p>Conversion failed when conversing date and/or time from character String</p>\n</blockquote>\n\n<p>The table in Excel contains the date in this format <code>dd/mm/YYYY</code> and the SQL Server column is of <code>DATE</code> datatype. Please I need help to fix this issue. Thanks for your support.</p>\n\n<p>Attach the CODE in VBA</p>\n\n<pre><code>  'Create Conection for MySQL Database in AR_TELCEL\nDim conn As New ADODB.Connection\nconn.CommandTimeout = 0\n'Define Data Types to Cells for Upload a SQL Database\nDim iRowNo As Long\nDim CUST_ID As Long, DOC_TYPE As String, BILL_DOC As Long, REFERENCE As String, STATUS_PAYMENT As String, INV_CON As String, OSALES_FOUR As String, INV_REF As String, DOC_NUM As Long, GL As Long, DOC_DATE As Date, DUE_DATE As Date, DOC_CURRENCY As String, DOC_AMNT As Currency, LOC_AMNT As Currency, PAY_TERM As String, POST_K As String, LINE_N As Long\n\n\n\n    With Sheets(\"I. One Report Sap\")\n\n        '_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n        'Connect with MSSQL PCC AR_TELCEL Database\n        '_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\n        conn.Open \"Provider=SQLOLEDB;Data Source=146.250.36.68,1433;Initial Catalog=AR_TELCEL;User Id=user;Password=Password;\"\n\n        'Omitimos la linea de encabezados\n        iRowNo = 10\n\n        'Loop until empty cell in CustomerId\n        Do Until .Cells(iRowNo, 1) = \"\"\n            ACCOUNT = .Cells(iRowNo, 1)\n            DOC_TYPE = .Cells(iRowNo, 2)\n            BILL_DOC = .Cells(iRowNo, 3)\n            REFERENCE = .Cells(iRowNo, 4)\n            STATUS_PAYMENT = .Cells(iRowNo, 5)\n            INV_CON = .Cells(iRowNo, 6)\n            ORDER_SALES = .Cells(iRowNo, 7)\n            INV_REF = .Cells(iRowNo, 8)\n            DOC_NUM = .Cells(iRowNo, 9)\n            GL = .Cells(iRowNo, 10)\n            DOC_DATE = .Cells(iRowNo, 11)\n            DUE_DATE = .Cells(iRowNo, 12)\n            DOC_CURRENCY = .Cells(iRowNo, 13)\n            DOC_AMNT = .Cells(iRowNo, 14)\n            LOC_AMNT = .Cells(iRowNo, 15)\n            PAY_TERM = .Cells(iRowNo, 16)\n            POST_K = .Cells(iRowNo, 17)\n            LINE_N = .Cells(iRowNo, 18)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 7164444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/443d263b7efefc9d93fd2749cff03940?s=128&d=identicon&r=PG&f=1", "display_name": "Arich", "link": "https://stackoverflow.com/users/7164444/arich"}, "edited": false, "score": 0, "creation_date": 1479325935, "post_id": 40624827, "comment_id": 68514117, "body": "Im not sure that I phrased my question correctly. Within column J there are many values that I do not need."}, {"owner": {"reputation": 9, "user_id": 7164444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/443d263b7efefc9d93fd2749cff03940?s=128&d=identicon&r=PG&f=1", "display_name": "Arich", "link": "https://stackoverflow.com/users/7164444/arich"}, "edited": false, "score": 0, "creation_date": 1479326523, "post_id": 40624827, "comment_id": 68514472, "body": "How do I add multiple values to this line? If Cell.Value = &quot;ABCDEFG&quot; Then"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 9, "user_id": 7164444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/443d263b7efefc9d93fd2749cff03940?s=128&d=identicon&r=PG&f=1", "display_name": "Arich", "link": "https://stackoverflow.com/users/7164444/arich"}, "edited": false, "score": 0, "creation_date": 1479327576, "post_id": 40624827, "comment_id": 68515073, "body": "See my added comment.  If that doesn&#39;t clear things up then maybe I&#39;ve completely misunderstood your question."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1479327544, "last_edit_date": 1479327544, "creation_date": 1479274884, "answer_id": 40624827, "question_id": 40623684, "link": "https://stackoverflow.com/questions/40623684/looking-to-add-150-values-to-search-for-within-this-statement-if-cell-value/40624827#40624827", "title": "Looking to add 150 values to search for within this statement::: If Cell.Value = &quot;5&quot; Then", "body": "<p>Example using Match()</p>\n\n<pre><code>Sub Tester()\n\n    Dim c As Range, rngTest As Range, rngList As Range\n\n    Set rngList = ThisWorkbook.Sheets(\"list\").Range(\"A1:A150\")\n\n    Set rngTest = Application.Intersect(Sheets(1).Range(\"J:J\"), Sheets(1).UsedRange)\n\n    If Not rngTest Is Nothing Then        \n       For Each c In rngTest\n            'Does the value in c match any of the values in the\n            '   list on sheet \"list\" range A1:A150 ?\n            'If Yes (Match does not return an error) then copy that row\n            If Not IsError(Application.Match(c.Value, rngList, 0)) Then\n                c.EntireRow.Copy Sheets(\"Sheet2\").Cells(c.Row, 1)\n            End If\n        Next\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 7164444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/443d263b7efefc9d93fd2749cff03940?s=128&d=identicon&r=PG&f=1", "display_name": "Arich", "link": "https://stackoverflow.com/users/7164444/arich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479327544, "creation_date": 1479267811, "last_edit_date": 1531164843, "question_id": 40623684, "link": "https://stackoverflow.com/questions/40623684/looking-to-add-150-values-to-search-for-within-this-statement-if-cell-value", "title": "Looking to add 150 values to search for within this statement::: If Cell.Value = &quot;5&quot; Then", "body": "<p>I have a mountain of data I need to harvest based on a list of values that could be found within column J. With the 150 or so qualifying values I would like the entire row copied to another sheet within the work book. \nThis below gets me close but not sure how to add 150 or so values to find:</p>\n\n<pre><code> For Each Cell In Sheets(1).Range(\"J:J\")`enter code here`\nIf Cell.Value = \"ABCDEFG\" Then\n    matchRow = Cell.Row\n    Rows(matchRow &amp; \":\" &amp; matchRow).Select\n    Selection.Copy\n\n    Sheets(\"Sheet2\").Select\n    ActiveSheet.Rows(matchRow).Select\n    ActiveSheet.Paste\n    Sheets(\"Sheet1\").Select\nEnd If\nNext\n</code></pre>\n"}, {"tags": ["vba", "ms-word", "macros"], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 3643039, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FC63i.png?s=128&g=1", "display_name": "Tao", "link": "https://stackoverflow.com/users/3643039/tao"}, "is_accepted": false, "score": 1, "last_activity_date": 1479422033, "creation_date": 1479422033, "answer_id": 40666278, "question_id": 40623521, "link": "https://stackoverflow.com/questions/40623521/word-security-warning-not-prompted-macro-not-run-before-checking-vbe-altf11/40666278#40666278", "title": "Word security warning not prompted, macro not run before checking VBE (Alt+F11)", "body": "<p>It turns out the .docm file has been edited and saved in Word for <strong>Mac OS</strong>, for some bizarre reason the event trigger disappeared, but when you open VBE (Alt+F11), it comes back, hope this helps with someone with same problem.</p>\n"}], "owner": {"reputation": 41, "user_id": 3643039, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FC63i.png?s=128&g=1", "display_name": "Tao", "link": "https://stackoverflow.com/users/3643039/tao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479422033, "creation_date": 1479266409, "last_edit_date": 1479295645, "question_id": 40623521, "link": "https://stackoverflow.com/questions/40623521/word-security-warning-not-prompted-macro-not-run-before-checking-vbe-altf11", "title": "Word security warning not prompted, macro not run before checking VBE (Alt+F11)", "body": "<p>This MS Word document with macro in int (<code>.docm</code>), there are a couple of content controls and some macro behind them. </p>\n\n<p>The issue is: when opened directly for the first time, no security warning is prompted (the 'Showing the Message Bar' option is turned on, and Macro settings is 'Disable all macros <strong>with</strong> notifications' in Trust Center), the macro will not fire as supposed to, but when I open VBE using <code>Alt</code>+<code>F11</code> without doing nothing else and come back to the document, macros work fine.</p>\n\n<p>Any idea how this possible?</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 405, "user_id": 190314, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9546df6508c5aacdbcfff7d7b141ec54?s=128&d=identicon&r=PG", "display_name": "Jared", "link": "https://stackoverflow.com/users/190314/jared"}, "is_accepted": true, "score": 1, "last_activity_date": 1479330384, "creation_date": 1479330384, "answer_id": 40642318, "question_id": 40623098, "link": "https://stackoverflow.com/questions/40623098/how-to-set-scrolltop-on-each-tab-in-a-multipage-userform/40642318#40642318", "title": "How to set scrollTop on each tab in a Multipage UserForm?", "body": "<p>Found the answer.</p>\n\n<p>Word VBA has a multipage function you can use to determine when a user enters a new page/tab.</p>\n\n<p>For example:<br>\n<code>Private Sub MultiPage1_Change()\n  Me.ScrollTop = 0\n End Sub</code></p>\n\n<p>You would add this to your UserForm module.</p>\n"}], "owner": {"reputation": 405, "user_id": 190314, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9546df6508c5aacdbcfff7d7b141ec54?s=128&d=identicon&r=PG", "display_name": "Jared", "link": "https://stackoverflow.com/users/190314/jared"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1009, "favorite_count": 0, "accepted_answer_id": 40642318, "answer_count": 1, "score": 0, "last_activity_date": 1479330384, "creation_date": 1479263301, "question_id": 40623098, "link": "https://stackoverflow.com/questions/40623098/how-to-set-scrolltop-on-each-tab-in-a-multipage-userform", "title": "How to set scrollTop on each tab in a Multipage UserForm?", "body": "<p>I've figured out how to set the ScrollTop in <code>UserForm_Initialize()</code> however I can't work out how you can set an event on each time a user flicks between a tab/page in a Multipage.</p>\n\n<p>Does MS Word  VBA not have a similar function to <code>UserForm_Initialize()</code> or <code>UserForm_Activate()</code> for when a tab/page is changed?</p>\n\n<p>My issue is even though I have ScrollTop = 0 in <code>UserForm_Initialize()</code>, when the user swaps to a new tab/page the focus is changed to focus on the top control (textbox) and the ScrollTop is no longer 0. So I need to reset it.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 4250405, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b5a14253a206c98e212e046e555a5493?s=128&d=identicon&r=PG&f=1", "display_name": "Jamie Sutton", "link": "https://stackoverflow.com/users/4250405/jamie-sutton"}, "edited": false, "score": 0, "creation_date": 1479263713, "post_id": 40623118, "comment_id": 68480250, "body": "You, my friend are an absolute star!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 153, "user_id": 4250405, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b5a14253a206c98e212e046e555a5493?s=128&d=identicon&r=PG&f=1", "display_name": "Jamie Sutton", "link": "https://stackoverflow.com/users/4250405/jamie-sutton"}, "edited": false, "score": 0, "creation_date": 1479263984, "post_id": 40623118, "comment_id": 68480310, "body": "Thanks.  I learned about EnableEvents the hard way myself.,.lol"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 3, "last_activity_date": 1479263460, "creation_date": 1479263460, "answer_id": 40623118, "question_id": 40622987, "link": "https://stackoverflow.com/questions/40622987/vba-validation-is-crashing-my-workbook/40623118#40623118", "title": "VBA Validation is crashing my workbook", "body": "<p>Before changing values on the ActiveSheet using the <code>Worksheet_Change</code> you need to turn off the events.  This prevents the <code>Worksheet_Change</code> from triggering again and possibly causing an infinite loop.  Make sure that you turn them back on before the event exits.  </p>\n\n<p>It is good practice to add an error handler so that if something does go wrong Events will automatically be turned back on.  </p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    On Error GoTo ResumeEvents\n    Application.EnableEvents = False\n\n    '----{Code}------\nResumeEvents:\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 4250405, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b5a14253a206c98e212e046e555a5493?s=128&d=identicon&r=PG&f=1", "display_name": "Jamie Sutton", "link": "https://stackoverflow.com/users/4250405/jamie-sutton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 40623118, "answer_count": 1, "score": 1, "last_activity_date": 1479263460, "creation_date": 1479262489, "question_id": 40622987, "link": "https://stackoverflow.com/questions/40622987/vba-validation-is-crashing-my-workbook", "title": "VBA Validation is crashing my workbook", "body": "<p>I have VBA code to alter validation on a cell dependant on the option selected.</p>\n\n<pre><code>Sub Worksheet_Change(ByVal Target As Range)\n    Dim ws As Worksheet\n    Set ws = Sheets(\"lkup\")\n\n    Dim VariationList As Variant\n    VariationList = Application.Transpose(ws.Range(\"Resource_List\"))\n    For i = LBound(VariationList) To UBound(VariationList)\n\n    Next i\n        If Target = Range(\"B15\") Then\n        If InStr(1, Range(\"B15\"), \"Resource\") &gt; 0 Then\n            With Range(\"D15\").Validation\n                .Delete\n                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _\n                    Operator:=xlEqual, Formula1:=Join(VariationList, \",\")\n                .IgnoreBlank = True\n                .InCellDropdown = True\n                .InputTitle = \"\"\n                .ErrorTitle = \"\"\n                .InputMessage = \"\"\n                .ErrorMessage = \"\"\n                .ShowInput = True\n                .ShowError = True\n            End With\n        ElseIf InStr(1, Range(\"B15\"), \"Fixed Asset\") &gt; 0 Then\n            Range(\"D15\").Validation.Delete\n            Range(\"D15\").ClearContents\n            With Range(\"D15\").Validation\n                .Delete\n                .Add Type:=xlValidateWholeNumber, AlertStyle:=xlValidAlertStop, _\n                    Operator:=xlBetween, Formula1:=\"100000\", Formula2:=\"999999\"\n                .IgnoreBlank = True\n                .InCellDropdown = True\n                .InputTitle = \"\"\n                .ErrorTitle = \"Oopps\"\n                .InputMessage = \"\"\n                .ErrorMessage = \"Your fixed asset number can only be 6 numbers\"\n                .ShowInput = True\n                .ShowError = True\n            End With\n        Else\n            Range(\"D15\").ClearContents\n            Range(\"D15\").Validation.Delete\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>It <em>works</em> while the workbook is open. It functions fine, no errors or anything. However, when I save and reopen the workbook, it gives me the following:</p>\n\n<blockquote>\n  <p>We found a problem with some content in 'Invoice.xlsm'. Do you want us\n  to try to recover as much as we can? If you trust the source of this\n  workbook, click Yes.</p>\n</blockquote>\n\n<p>It then opens the workbook, strips all my formatting and removes the VBA.</p>\n\n<p>I've tried Googling but haven't been able to translate that to what I've got.</p>\n\n<p>Cheers,</p>\n"}, {"tags": ["vba", "excel", "function", "named-parameters"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7102421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5b834b4b4b75f2473ac2980ce1602d0?s=128&d=identicon&r=PG&f=1", "display_name": "ManbyRiver", "link": "https://stackoverflow.com/users/7102421/manbyriver"}, "edited": false, "score": 0, "creation_date": 1479266984, "post_id": 40623096, "comment_id": 68481035, "body": "Thanks @teylyn.  I assume that this requires a definition of &quot;MyRange&quot;? I think I have seen that this requires some code to do so earlier in the sub routine but I am not confident about that.  Could you please point me in the right direction so that I can complete that part as well?"}, {"owner": {"reputation": 13, "user_id": 7102421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5b834b4b4b75f2473ac2980ce1602d0?s=128&d=identicon&r=PG&f=1", "display_name": "ManbyRiver", "link": "https://stackoverflow.com/users/7102421/manbyriver"}, "edited": false, "score": 0, "creation_date": 1479267743, "post_id": 40623096, "comment_id": 68481218, "body": "In thinking it through further, is it that &#39;MyRange&#39; is replaced with the range name already defined?  Also, do I simply use this code to replace the current code and add &#39; = &quot;CLV 7&quot; at the end?  So the new code would look like this:      Debug.Print Intersect(Rows(ActiveCell.Row), Range(&quot;BusinessStudies&quot;)).Value = &quot;CLV7&quot;  Edit:  I tried this just now and it doesn&#39;t work.  Could you suggest any other adjustments or alternatives?"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 13, "user_id": 7102421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5b834b4b4b75f2473ac2980ce1602d0?s=128&d=identicon&r=PG&f=1", "display_name": "ManbyRiver", "link": "https://stackoverflow.com/users/7102421/manbyriver"}, "edited": false, "score": 0, "creation_date": 1479268323, "post_id": 40623096, "comment_id": 68481365, "body": "Yes. You can easily apply this to your situation. <code>Intersect(Rows(ActiveCell.Row), Range(&quot;BusinessStudies&quot;)).Value = &quot;whatever&quot;</code>. You would need to replace &quot;whatever&quot; with whatever you want in the cell. I edited my post."}, {"owner": {"reputation": 13, "user_id": 7102421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5b834b4b4b75f2473ac2980ce1602d0?s=128&d=identicon&r=PG&f=1", "display_name": "ManbyRiver", "link": "https://stackoverflow.com/users/7102421/manbyriver"}, "edited": false, "score": 0, "creation_date": 1479268564, "post_id": 40623096, "comment_id": 68481424, "body": "You little ripper (Not sure where you&#39;re from but if not from Australia that&#39;s Aussie Slang for That works beautifully - Thanks heaps!).  The perfect and most simple solution!"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 13, "user_id": 7102421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5b834b4b4b75f2473ac2980ce1602d0?s=128&d=identicon&r=PG&f=1", "display_name": "ManbyRiver", "link": "https://stackoverflow.com/users/7102421/manbyriver"}, "edited": false, "score": 0, "creation_date": 1479286490, "post_id": 40623096, "comment_id": 68488538, "body": "Kiwi. Thanks for the feedback."}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": true, "score": 0, "last_activity_date": 1479268386, "last_edit_date": 1479268386, "creation_date": 1479263250, "answer_id": 40623096, "question_id": 40622830, "link": "https://stackoverflow.com/questions/40622830/set-value-of-cell-relative-to-active-cell-within-single-column-named-range/40623096#40623096", "title": "Set Value of Cell, relative to active cell, within single column named range", "body": "<p>try the Intersect() function in VBA</p>\n\n<pre><code>Debug.Print Intersect(Rows(ActiveCell.Row), Range(\"MyRange\")).Value\n</code></pre>\n\n<p>Edit: apply to your situation, assuming that you want the string \"CLV 7\" to go into the cell:</p>\n\n<pre><code>Intersect(Rows(ActiveCell.Row), Range(\"BusinessStudies\")).Value = \"CLV 7\"\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7102421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5b834b4b4b75f2473ac2980ce1602d0?s=128&d=identicon&r=PG&f=1", "display_name": "ManbyRiver", "link": "https://stackoverflow.com/users/7102421/manbyriver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1582, "favorite_count": 0, "accepted_answer_id": 40623096, "answer_count": 1, "score": 0, "last_activity_date": 1570548618, "creation_date": 1479261482, "last_edit_date": 1570548618, "question_id": 40622830, "link": "https://stackoverflow.com/questions/40622830/set-value-of-cell-relative-to-active-cell-within-single-column-named-range", "title": "Set Value of Cell, relative to active cell, within single column named range", "body": "<p>I have written the following code as part of a larger sub-routine to set the value of a cell, relative to the active cell, when a particular selection has been made within the active cell.</p>\n\n<pre><code>ActiveCell.Offset(0, 5).Value = \"CLV 7\"\n</code></pre>\n\n<p>While this works, I may have need in the future to add columns into my worksheet and this presents a problem, due to the change of location of the cell that requires its value to be set, and by association the need to rewrite the code each time a new column is added.</p>\n\n<p>In considering this variable, I researched and as a result, defined a range name for each column that requires values to be set within it.  I thought that I would then be able to determine the variable &amp; relocatable intersect point between the active row and the named range column and define it as the cell that requires the value to be set.</p>\n\n<p>After this I researched ways to define this variable intersection and attempted to set the following alternate code:</p>\n\n<pre><code>ActiveCell.Offset(0, 0).Range(\"BusinessStudies\").Value = CLV 7\n</code></pre>\n\n<p>in the hope that it would do the trick, but unfortunately it does not.  I have looked at other posts and cannot see how to adjust it with any success as I can't see any similar requests.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "edited": false, "score": 0, "creation_date": 1479326147, "post_id": 40624198, "comment_id": 68514252, "body": "I actually needed GetObject instead of CreateObject.  Your solution works!"}, {"owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "edited": false, "score": 1, "creation_date": 1479326350, "post_id": 40624198, "comment_id": 68514376, "body": "You actually don&#39;t need to use <code>Select</code>.  Check out <a href=\"http://stackoverflow.com/questions/34094445\">excel vba freeze pane without select</a>. <code>Dim excApp As Excel.Application Set excApp = GetObject(, &quot;Excel.Application&quot;) With excApp.ActiveWindow     .SplitRow = 3     .FreezePanes = True End With</code>"}, {"owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "reply_to_user": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "edited": false, "score": 1, "creation_date": 1479338443, "post_id": 40624198, "comment_id": 68520228, "body": "That&#39;s great.  I learned something today; thanks.  I&#39;ve incorporated your feedback into the answer."}], "tags": [], "owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "is_accepted": true, "score": 4, "last_activity_date": 1479338417, "last_edit_date": 1479338417, "creation_date": 1479271249, "answer_id": 40624198, "question_id": 40622798, "link": "https://stackoverflow.com/questions/40622798/from-vba-in-outlook-how-do-i-freeze-panes-in-excel/40624198#40624198", "title": "From VBA in Outlook, how do I freeze panes in Excel?", "body": "<p>With freeze panes, it's actually relative to the cursor position, so this is one of the few places where <code>.Select</code> is actually necessary.</p>\n\n<p>This code should do what you seek:</p>\n\n<pre><code>Dim excApp As Excel.Application\nSet excApp = GetObject(, \"Excel.Application\")\n\nexcApp.ActiveWorkbook.ActiveSheet.Range(\"2:2\").Select\nexcApp.ActiveWindow.FreezePanes = True\n</code></pre>\n\n<p>It presupposes Excel is already open.</p>\n\n<p>-- EDIT --</p>\n\n<p>Per @ChrisB, there is a way to do this without the dreaded <code>.Select</code>:</p>\n\n<pre><code>With excApp.ActiveWindow\n    .SplitRow = 3\n    .FreezePanes = True\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 159, "user_id": 8048399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab78e93b5c199d020e469808857b58aa?s=128&d=identicon&r=PG", "display_name": "Aranxo", "link": "https://stackoverflow.com/users/8048399/aranxo"}, "is_accepted": false, "score": 0, "last_activity_date": 1567719705, "creation_date": 1567719705, "answer_id": 57813307, "question_id": 40622798, "link": "https://stackoverflow.com/questions/40622798/from-vba-in-outlook-how-do-i-freeze-panes-in-excel/57813307#57813307", "title": "From VBA in Outlook, how do I freeze panes in Excel?", "body": "<p>Here is another one. Its a Function which you can also use outside from Excel, e.g. from Access or Outlook:</p>\n\n<pre><code>Public Sub FreezeHeader(Sheet As Excel.Worksheet, _\n                        Optional Rows As Long = 1, _\n                        Optional Columns As Long = 0)\n    If Sheet Is Nothing Then Exit Sub\n\n    Sheet.Activate      ' must be the active sheet!\n    With Sheet.Parent.Windows(1)\n        If .FreezePanes Then .FreezePanes = False ' always delete the old freeze\n\n        .SplitColumn = Columns\n        .SplitRow = Rows\n\n        If Rows &gt; 0 Or Columns &gt; 0 Then .FreezePanes = True\n    End With\nEnd Sub\n</code></pre>\n\n<p>And now use it like this:</p>\n\n<pre><code>Dim EXL As Excel.Application\nDim Book As Excel.Workbook\nDim Sheet As Excel.Worksheet\n\nSet EXL = New Excel.Application\nSet Book = EXL.Workbooks.Open(\"YourFilename.xlsx\")\nSet Sheet = Book.Sheets(1)\n\nFreezeHeader Sheet       ' Freezes first row (the usual case)\nFreezeHeader Sheet, 2    ' Freezes first two rows\nFreezeHeader Sheet, 0, 1 ' Freezes first column\nFreezeHeader Sheet, 0    ' Unfreezes all\n</code></pre>\n"}], "owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1260, "favorite_count": 0, "accepted_answer_id": 40624198, "answer_count": 2, "score": 2, "last_activity_date": 1592900140, "creation_date": 1479261223, "last_edit_date": 1592900140, "question_id": 40622798, "link": "https://stackoverflow.com/questions/40622798/from-vba-in-outlook-how-do-i-freeze-panes-in-excel", "title": "From VBA in Outlook, how do I freeze panes in Excel?", "body": "<p>I am writing a VBA macro in Outlook that references an Excel workbook and makes changes to that workbook.  I want to freeze panes (not \"Split\") just below row 1.</p>\n\n<p>Here's the code I tried:</p>\n\n<pre><code>With Excel.ActiveWindow\n    .SplitColumn = 0\n    .SplitRow = 3\n    .FreezePanes = True\nEnd With\n</code></pre>\n\n<p>...and...</p>\n\n<pre><code>Dim excApp As Object\nSet excApp = CreateObject(\"Excel.Application\")\n\nWith excApp.ActiveWindow\n    .SplitColumn = 0\n    .SplitRow = 3\n    .FreezePanes = True\nEnd With\n</code></pre>\n\n<p>Both threw run-time error 91 at the line <code>.SplitColumn = 0</code>.</p>\n\n<p>I appreciate any help or pointers.  Thanks!</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1479260641, "post_id": 40622681, "comment_id": 68479423, "body": "<code>Application.EnableEvents = False</code> at the start, then <code>Application.EnableEvents = True</code> when you&#39;re done."}, {"owner": {"reputation": 1774, "user_id": 3861449, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fc5cffc01b789b8262766e32eddbcfd7?s=128&d=identicon&r=PG&f=1", "display_name": "zephyr", "link": "https://stackoverflow.com/users/3861449/zephyr"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1479260823, "post_id": 40622681, "comment_id": 68479469, "body": "@Comintern Perfect thank you! If you supply a full answer I&#39;ll accept. The nature of this problem made it somewhat hard to google."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1479260904, "post_id": 40622681, "comment_id": 68479482, "body": "Nah, pretty sure it&#39;s already on SO somewhere.  Just too lazy to find it.  ;-)"}], "owner": {"reputation": 1774, "user_id": 3861449, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fc5cffc01b789b8262766e32eddbcfd7?s=128&d=identicon&r=PG&f=1", "display_name": "zephyr", "link": "https://stackoverflow.com/users/3861449/zephyr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "closed_date": 1479304286, "answer_count": 0, "score": 0, "last_activity_date": 1479260867, "creation_date": 1479260436, "last_edit_date": 1479260867, "question_id": 40622681, "link": "https://stackoverflow.com/questions/40622681/circular-referencing-cell-changes-in-excel-vba-macro", "closed_reason": "Duplicate", "title": "Circular-referencing cell changes in Excel VBA macro", "body": "<p>In the image below, you can see that I have three cells. What I want to have happen is that if I update the value in either D3 or D4, then D4 or D3 updates respectively. I have code below which attempts to do this. The issue I'm seeing though, is that if I update D3, the macro executes, updating D4, which registers as a change, causing the macro to execute and updating D3, causing the macro to execute ... ad nauseam. How can I break out of this?</p>\n\n<p><a href=\"https://i.stack.imgur.com/d08Ob.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/d08Ob.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Target.Cells(1, 1).Column = 4 And Target.Cells(1, 1).Row = 3 Then\n        Cells(4, 4).Value = Cells(2, 4).Value * Cells(3, 4).Value\n    ElseIf Target.Cells(1, 1).Column = 4 And Target.Cells(1, 1).Row = 4 Then\n        Cells(3, 4).Value = Cells(4, 4).Value / Cells(2, 4).Value\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1479259437, "post_id": 40622541, "comment_id": 68479107, "body": "Use <code>Environ$(&quot;USERPROFILE&quot;)</code>."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1479277443, "post_id": 40622541, "comment_id": 68484201, "body": "<a href=\"http://www.ammara.com/access_image_faq/get_mdb_database_path.html\" rel=\"nofollow noreferrer\">ammara.com/access_image_faq/get_mdb_database_path.html</a>"}, {"owner": {"reputation": 33, "user_id": 7162853, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/eafd29dc32484325e771e913389b4c83?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/7162853/dennis"}, "edited": false, "score": 0, "creation_date": 1479309583, "post_id": 40622541, "comment_id": 68503786, "body": "Set xlWkb = xlApp.Workbooks.Open(Environs$(&quot;USERPROFILE&quot;) &amp; &quot;\\Dropbox\\Trk_Insp_1204_10_08_2016.xlsx&quot;)   I get Sub or function not defined, centered around the Environs$   I&#39;m not sure how to use this function, I&#39;ve done some searching and can&#39;t seem to find the specific help I need."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1479316625, "post_id": 40622541, "comment_id": 68508791, "body": "If your Excel file is located in the same folder as your Access DB then you can use the information at the link I posted"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "is_accepted": false, "score": 0, "last_activity_date": 1492526508, "creation_date": 1492526508, "answer_id": 43475270, "question_id": 40622541, "link": "https://stackoverflow.com/questions/40622541/open-an-excel-file-on-export-access-vba/43475270#43475270", "title": "open an excel file on export access vba", "body": "<p>Please make a simple test sub and test:</p>\n\n<pre><code>Sub EnvTest()\n Dim S as String\n\n S = Environ(\"USERPROFILE\") &amp; \"\\Dropbox\\Trk_Insp_1204_10_08_2016.xlsx\"\n Debug.Print S\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7162853, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/eafd29dc32484325e771e913389b4c83?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/7162853/dennis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593956180, "creation_date": 1479259198, "last_edit_date": 1593956180, "question_id": 40622541, "link": "https://stackoverflow.com/questions/40622541/open-an-excel-file-on-export-access-vba", "title": "open an excel file on export access vba", "body": "<p>Set wbTarget1 = xl.Workbooks.Open(\"C:\\Users\\Owner\\Dropbox\\Trk_Insp_1204_10_08_2016.xlsx\")</p>\n\n<p>The location is different on the other machines, ie the owner is different. Can I use current.path?  Can I use wild cards or </p>\n\n<p>~\\Trk_Insp_1204_10_08_2016.xlsx</p>\n\n<p>I saw a reference that mentioned you can truncate the path if the excel file resided in the current directory the access DB was located.</p>\n\n<p>Dennis</p>\n"}, {"tags": ["c", "vba", "dll", "struct", "type-conversion"], "answers": [{"comments": [{"owner": {"reputation": 6319, "user_id": 3754432, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/dcf9ff1192f75be8c4b94b025019d4c2?s=128&d=identicon&r=PG&f=1", "display_name": "Ronan Paix&#227;o", "link": "https://stackoverflow.com/users/3754432/ronan-paix%c3%a3o"}, "edited": false, "score": 0, "creation_date": 1479256088, "post_id": 40622015, "comment_id": 68478271, "body": "Thanks for that! The syntax doesn&#39;t make any sense, but since it is like that... And looking at your code also reminded me to actually initialize the struct and use arr.result instead of the return value (can&#39;t believe I forgot those!). The return value is still wrong, but that&#39;s another problem. Thanks!"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 6319, "user_id": 3754432, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/dcf9ff1192f75be8c4b94b025019d4c2?s=128&d=identicon&r=PG&f=1", "display_name": "Ronan Paix&#227;o", "link": "https://stackoverflow.com/users/3754432/ronan-paix%c3%a3o"}, "edited": false, "score": 1, "creation_date": 1479256211, "post_id": 40622015, "comment_id": 68478310, "body": "@RonanPaix&#227;o - No, it doesn&#39;t make any sense - welcome to the wonderful world of VBA off by one errors."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 2, "last_activity_date": 1479255396, "creation_date": 1479255396, "answer_id": 40622015, "question_id": 40621859, "link": "https://stackoverflow.com/questions/40621859/how-do-i-build-a-type-to-pass-to-a-dll-function-that-takes-a-pointer-to-a-struct/40622015#40622015", "title": "How do I build a Type to pass to a DLL function that takes a pointer to a struct with an array inside?", "body": "<p>The VBA declaration should be:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Type CStruct_t\n    arr(9) As Double\n    anotherParam As Double\n    result As Double\nEnd Type\n</code></pre>\n\n<p>The number in the array declaration in VBA is the upper bound (base 0) of the array, <strong><em>not</em></strong> the number of elements like in C.  In VBA, <code>arr(10) As Double</code> is equivalent to <code>double arr[11];</code> in C. </p>\n\n<p>Obligatory demo code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Bounds()\n    Dim foo As CStruct_t, i As Long\n    For i = LBound(foo.arr) To UBound(foo.arr)\n        Debug.Print i\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 6319, "user_id": 3754432, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/dcf9ff1192f75be8c4b94b025019d4c2?s=128&d=identicon&r=PG&f=1", "display_name": "Ronan Paix&#227;o", "link": "https://stackoverflow.com/users/3754432/ronan-paix%c3%a3o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 40622015, "answer_count": 1, "score": 0, "last_activity_date": 1479256238, "creation_date": 1479254403, "last_edit_date": 1479256238, "question_id": 40621859, "link": "https://stackoverflow.com/questions/40621859/how-do-i-build-a-type-to-pass-to-a-dll-function-that-takes-a-pointer-to-a-struct", "title": "How do I build a Type to pass to a DLL function that takes a pointer to a struct with an array inside?", "body": "<p>I have a C DLL that defines a struct and a function that takes a pointer to it:</p>\n\n<p><strong>header:</strong></p>\n\n<pre><code>typedef struct {\n    double arr[10];\n    double anotherParam;\n    double result;\n} CStruct_t;\n\nint __stdcall CFunction(CStruct_t * c_struct);\n</code></pre>\n\n<p><strong>source:</strong></p>\n\n<pre><code>int __stdcall CFunction(CStruct_t * c_struct) {\n    double sum = 0.0;\n    for (int i = 0; i &lt; 10; ++i) {\n        sum += c_struct-&gt;arr[i];\n    }\n    c_struct-&gt;result = sum * c_struct-&gt;anotherParam;\n}\n</code></pre>\n\n<p>I can properly use the DLL in C in something like:</p>\n\n<pre><code>CStruct_t my_struct = {{0,1,2,3,4,5,6,7,8,9}, 2, 0};\nCFunction(&amp;my_struct);\nprintf(\"Result = %f \", my_struct.result);\n</code></pre>\n\n<p>However, I want to use it inside Excel. As such, I tried this in VBA:</p>\n\n<pre><code>Private Declare Function CFunction Lib \"cstruct.dll\" (ByRef c_struct As CStruct_t) As Long\n\nType CStruct_t\n    arr(10) As Double\n    anotherParam As Double\n    result As Double\nEnd Type\n\nSub TryCStruct()\n    Dim prev_path As String\n    prev_path = CurDir\n    ChDir ThisWorkbook.Path\n    Dim cs As CStruct_t\n    For i = LBound(cs.arr) To UBound(cs.arr)\n        cs.arr(i) = i\n    Next\n    cs.anotherParam = 2\n    MsgBox \"Retval =\" &amp; CFunction(cs)\n    MsgBox \"Result = \" &amp; cs.result\n    ChDir prev_path\nEnd Sub\n</code></pre>\n\n<p>But despite working, it returns incorrect results (42988244 instead of 90). I presume this is because VBA arrays are SAFEARRAYs instead of fixed-size ones like C, but <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264224.aspx\" rel=\"nofollow noreferrer\">this page</a> makes me think that fixed-size arrays should be fixed in memory too.</p>\n\n<p>Anyway, I've seen examples of passing the pointer to the data in the array, but I couldn't find anything on using a mixed type.</p>\n\n<p>Is there any way to correctly allocate the memory in VBA and pass the struct pointer to the DLL or must I somehow either manage it all in C or declare each array element as a member of the struct and forget easy indexing in VBA?</p>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7066370, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wpiu7.jpg?s=128&g=1", "display_name": "OmarProh", "link": "https://stackoverflow.com/users/7066370/omarproh"}, "edited": false, "score": 0, "creation_date": 1479252989, "post_id": 40621594, "comment_id": 68477284, "body": "jajaja, by seconds you answers first"}], "tags": [], "owner": {"reputation": 11, "user_id": 7066370, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wpiu7.jpg?s=128&g=1", "display_name": "OmarProh", "link": "https://stackoverflow.com/users/7066370/omarproh"}, "is_accepted": false, "score": 0, "last_activity_date": 1479252757, "creation_date": 1479252757, "answer_id": 40621594, "question_id": 40621565, "link": "https://stackoverflow.com/questions/40621565/how-to-make-a-button-that-can-only-be-clicked-once/40621594#40621594", "title": "How to make a button that can only be clicked once", "body": "<pre><code>Public Class Form1\nPrivate Sub Button1_Click(sender As Object, e As EventArgs)\n   'Do what you need to do here, and then \n   Button1.Enabled = false\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6971, "user_id": 1017257, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/b640b32b365965eec77f8508ce3a9b30?s=128&d=identicon&r=PG", "display_name": "Drew Chapin", "link": "https://stackoverflow.com/users/1017257/drew-chapin"}, "is_accepted": true, "score": 2, "last_activity_date": 1479254661, "last_edit_date": 1479254661, "creation_date": 1479252768, "answer_id": 40621596, "question_id": 40621565, "link": "https://stackoverflow.com/questions/40621565/how-to-make-a-button-that-can-only-be-clicked-once/40621596#40621596", "title": "How to make a button that can only be clicked once", "body": "<p>Disable the button after they click on it. Then they will not be able to click on it anymore, but it will remain visible. Make sure to disable the button first, especially if your event code is multi-threaded. Otherwise, it may provide the user an opportunity to click on the button again before you want them to. </p>\n\n<pre><code>Public Class Form1\n    Private Sub Button1_Click(sender As Object, e As EventArgs)\n        Button1.Enabled = False\n        ' Do something\n    End Sub\nEnd Class\n</code></pre>\n\n<p>Another approach if you don't want to disable the button would be to set a global (preferably private) variable to keep track of it. </p>\n\n<pre><code>Public Class Form1\n    Private button1Clicked As Boolean = False\n    Private Sub Button1_Click(sender As Object, e As EventArgs)\n        If button1Clicked Then\n           ' Optionally inform user they've already clicked on it.\n           MessageBox.Show(\"You've already clicked on the button.\")\n        Else\n            button1Clicked = True\n            ' Do something\n        End If\n    End Sub\nEnd Class\n</code></pre>\n\n<p>Or you could use the <code>Tag</code> property.</p>\n\n<pre><code>Private Sub Button1_Click(sender As Object, e As EventArgs)\n    If Button1.Tag = True Then \n       ' Optionally inform user they've already clicked on it.\n       MessageBox.Show(\"You've already clicked on the button.\")\n    Else\n        Button1.Tag = True\n        ' Do something\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7164733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86b2f40ecbdaa4c147d143573c2856a6?s=128&d=identicon&r=PG&f=1", "display_name": "Mintzeh", "link": "https://stackoverflow.com/users/7164733/mintzeh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1451, "favorite_count": 0, "accepted_answer_id": 40621596, "answer_count": 2, "score": -2, "last_activity_date": 1479254661, "creation_date": 1479252629, "last_edit_date": 1479253379, "question_id": 40621565, "link": "https://stackoverflow.com/questions/40621565/how-to-make-a-button-that-can-only-be-clicked-once", "title": "How to make a button that can only be clicked once", "body": "<p>In visual basic I'm trying to make a button that can only be clicked once, I want to be able to see the button, its just I want it so you can only click it once.</p>\n\n<p>This is my code so far:</p>\n\n<pre><code>Public Class Form1\n    Private Sub Button1_Click(sender As Object, e As EventArgs)\n\n    End Sub\nEnd Class\n</code></pre>\n"}, {"tags": ["excel", "variables", "random", "macros", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1479309806, "post_id": 40621420, "comment_id": 68503955, "body": "<i>keeps throwing up an error.</i>  What error, on what line?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1479309851, "post_id": 40621420, "comment_id": 68503992, "body": "<i>I would like to manualy open the random workbook store it&#39;s name in a variable. Then have the macro open the template file, create a new tab(called neededInfo) in the templateFile, switch back to the manually opened file, select range(&quot;A1:B4&quot;), then copy that to the new sheet in the templateFile.</i> This seems like about 5 or 6 different problems, maybe try breaking it down and solving each individual step so it will not seem as overwhelming."}, {"owner": {"reputation": 85, "user_id": 4528918, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/767965513293486/picture?type=large", "display_name": "Todd Coplien", "link": "https://stackoverflow.com/users/4528918/todd-coplien"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1479335736, "post_id": 40621420, "comment_id": 68519249, "body": "sorry about that! i suppose it would be nice to know where the error was. I got it fixed now, but thank you! and i believe the error was coming up at Set templateFile = ActiveWorkbook. I&#39;ll update it when i get a chance to confirm."}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 4528918, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/767965513293486/picture?type=large", "display_name": "Todd Coplien", "link": "https://stackoverflow.com/users/4528918/todd-coplien"}, "edited": false, "score": 0, "creation_date": 1479336317, "post_id": 40635987, "comment_id": 68519477, "body": "Thank you very much for the help! I got a chance to look at again and figured it out. I&#39;ll post the solution that I got above! Yours worked too though so thank you!"}], "tags": [], "owner": {"reputation": 1018, "user_id": 6706734, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89cf86a3fd50974771d8041b8f13e5b0?s=128&d=identicon&r=PG&f=1", "display_name": "J_Lard", "link": "https://stackoverflow.com/users/6706734/j-lard"}, "is_accepted": true, "score": 2, "last_activity_date": 1479310237, "creation_date": 1479310237, "answer_id": 40635987, "question_id": 40621420, "link": "https://stackoverflow.com/questions/40621420/vba-copy-and-paste-between-template-worksheet-and-variable-worksheet/40635987#40635987", "title": "VBA Copy and Paste Between Template Worksheet and Variable Worksheet", "body": "<p>Your code is fairly close but there are a few issues. First, don't create a variable with its type as the name. Change <code>Dim workBook As Workbook</code> to something like <code>Dim bk As Workbook</code>.</p>\n\n<p>Next you have the statement <code>Set templateFile = \"20161115 SMARTnet Template.xlsx\"</code>. This is effectively trying to set a workbook to a string. Instead change this to <code>Set templateFile = Workbooks(\"20161115 SMARTnet Template\")</code>. Or better yet change this to:</p>\n\n<pre><code>Dim tempStr as String\ntempStr = \"20161115 SMARTnet Template\"\nSet templatefile = Workbooks(tempStr)\n</code></pre>\n\n<p>I'm not entirely sure what you're trying to accomplish with the next few lines of code. It looks like you're adding a new tab to the <code>templatefile</code> workbook. Instead of activating the workbook, just use this <code>Set tempSheet = templatefile.Worksheets.Add(after:=ActiveSheet)</code> and then rename this new sheet to \"neededInfo\".</p>\n\n<p>Next, you set the <code>workingFile</code> variable to the active sheet which in this case will be the <code>neededInfo</code> sheet. I'm assuming that this isn't your intention. You will need to define the <code>workingSheet</code> variable before you add the new worksheet.</p>\n\n<p>The new code could look something like this:</p>\n\n<pre><code>Sub Macro3()\n\n    Dim templatefile As Workbook\n    Dim workingSheet As Worksheet ' only sheet in CSCC Quote\n    Dim tempSheet As Worksheet ' created sheet in CSCC Quote to hold temp data\n    Dim tempStr As String\n\n    Application.ScreenUpdating = False\n\n    ' Set template file name\n    tempStr = \"20161115 SMARTnet Template\"\n    Set templatefile = Workbooks(tempStr)\n    Set workingSheet = ActiveSheet\n    Set tempSheet = Worksheets.Add(after:=ActiveSheet)\n\n    tempSheet.Name = \"neededInfo\"\n\n    workingSheet.Range(\"A1:B4\").Copy\n\n    tempSheet.Range(\"A5\").PasteSpecial xlPasteValues\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>I think this is what you were trying to accomplish. If not, this should be a good start for you.</p>\n\n<p>Good luck!</p>\n"}], "owner": {"reputation": 85, "user_id": 4528918, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/767965513293486/picture?type=large", "display_name": "Todd Coplien", "link": "https://stackoverflow.com/users/4528918/todd-coplien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1392, "favorite_count": 0, "accepted_answer_id": 40635987, "answer_count": 1, "score": 2, "last_activity_date": 1479336377, "creation_date": 1479251749, "last_edit_date": 1531161705, "question_id": 40621420, "link": "https://stackoverflow.com/questions/40621420/vba-copy-and-paste-between-template-worksheet-and-variable-worksheet", "title": "VBA Copy and Paste Between Template Worksheet and Variable Worksheet", "body": "<p>I've edited this post to show that I have done some research on this. Some of the code below was captured during a \"Record Macro\" session. I just can't figure out how to change the workbook names that it records into variables. Any help is greatly appreciated!</p>\n\n<p>I'm trying to copy and paste some data between two worksheets. One is a template and will always have the same name and the other varies depending on which one I open. The code I have now keeps throwing up an error. My current code is below! Any help would be greatly appreciated! I would like to manualy open the random workbook store it's name in a variable. Then have the macro open the template file, create a new tab(called neededInfo) in the templateFile, switch back to the manually opened file, select range(\"A1:B4\"), then copy that to the new sheet in the templateFile. Let me know if there is a better way! I'm super new to this! </p>\n\n<pre><code>Sub Macro3()\n\nDim templateFile As Workbook ' template macro workbook; will always have same filename\nDim workingFile As String ' current working CSCC Quote download\nDim workingSheet As Worksheet ' only sheet in CSCC Quote\nDim tempSheet As Worksheet ' created sheet in CSCC Quote to hold temp data\nDim fileName As String\nDim wrkBook As Workbook\nDim nRow As Long\nDim neededInfo As Long\nDim neededRange As Range\n\nApplication.ScreenUpdating = False\n\n' Set template file name\nSet templateFile = \"20161115 SMARTnet Template.xlsx\"\n\nSet templateFile = ActiveWorkbook\ntemplateFile.Active\nSet tempSheet = Worksheets.Add(after:=ActiveSheet)\ntempSheet.Name = \"neededInfo\"\nworkingFile = ActiveSheet.Name\nRange(\"A1:B4\").Select\nSelection.Copy\ntemplateSheet.Activate\nRange(\"A5\").Select\nActiveSheet.Paste\nworkingFile.Activate\n\nEnd Sub\n</code></pre>\n\n<p>My Solution:</p>\n\n<pre><code>Sub Macro3()\n\nDim tPlate As Workbook ' template macro\nDim wrkngFile As Workbook ' current working CSCC Quote download\nDim wrkngSheet As Worksheet ' only sheet in CSCC Quote\nDim tSheet As Worksheet ' created sheet in template file to hold temp data\nDim fileName As String\nDim tPath As String, tFile As String ' template path location and template file\nDim nRow As Long\nDim neededInfo As Long\nDim neededRange As Range\n\nApplication.ScreenUpdating = False\n\ntPath = \"C:\\Users\\tcoplien\\Desktop\\SMARTnet\\\"\ntFile = tPath &amp; \"20161115 SMARTnet Template.xlsx\"\n\nSet wrkngFile = ActiveWorkbook\nRange(\"A1:B4\").Select\nSelection.Copy\n\n' Open template file and save name as variable\nSet tPlate = Workbooks.Open(tFile)\n\nSet tSheet = Worksheets.Add(After:=ActiveSheet)\ntSheet.Name = \"neededInfo\"\n\ntSheet.Range(\"A5\").PasteSpecial xlPasteValues\n\nwrkngFile.Activate\nRange(\"A1\").Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "frame", "userform"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1479250621, "post_id": 40620920, "comment_id": 68476577, "body": "Cast your <code>ctl</code> to a <code>Frame</code>, I&#39;m pretty sure it has a <code>Controls</code> collection of its own."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1479251635, "post_id": 40620920, "comment_id": 68476908, "body": "Why not add the image in the <code>newFrame</code> loop?"}, {"owner": {"reputation": 588, "user_id": 7049751, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6b0e27ce4e8c20a20d34e793f4e4636?s=128&d=identicon&r=PG&f=1", "display_name": "Sphinx", "link": "https://stackoverflow.com/users/7049751/sphinx"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1479285425, "post_id": 40620920, "comment_id": 68487940, "body": "It should be  <code>newFrame.Controls.Add(&quot;forms.image.1&quot;, &quot;Img&quot; &amp; i)</code> I tought I&#39;ve tested it that way but apparently I was wrong"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10283645, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/c6a7bc0dd1523fec0c6aed7afd58d828?s=128&d=identicon&r=PG", "display_name": "The.Silent.Flautist", "link": "https://stackoverflow.com/users/10283645/the-silent-flautist"}, "is_accepted": false, "score": 0, "last_activity_date": 1535453267, "last_edit_date": 1535453267, "creation_date": 1535444982, "answer_id": 52053388, "question_id": 40620920, "link": "https://stackoverflow.com/questions/40620920/vba-userform-dynamic-add-frames-and-populate-with-images/52053388#52053388", "title": "VBA userform dynamic add frames and populate with images", "body": "<p>You don't need the \"Me\"</p>\n\n<p>directly use </p>\n\n<pre><code>Set newImg = ctl.controls.add (\"Forms.image.1\", \"Img\" &amp; i, true)\n</code></pre>\n"}], "owner": {"reputation": 588, "user_id": 7049751, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6b0e27ce4e8c20a20d34e793f4e4636?s=128&d=identicon&r=PG&f=1", "display_name": "Sphinx", "link": "https://stackoverflow.com/users/7049751/sphinx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3717, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1535453267, "creation_date": 1479249186, "question_id": 40620920, "link": "https://stackoverflow.com/questions/40620920/vba-userform-dynamic-add-frames-and-populate-with-images", "title": "VBA userform dynamic add frames and populate with images", "body": "<p>What i want to do is on some event, let's say combobox change i want to add frames to userform and populate them with images </p>\n\n<p>simplified wersion looks like this </p>\n\n<pre><code>Dim i As Integer\nDim newFrame As MSForms.Frame\nDim topPos As Integer\nDim leftPos As Integer\nDim ctl As Control\nDim newImg As MSForms.Image\n\nleftPos = 15\ntopPos = 15\n\nFor i = 1 To 10\n    Set newFrame = Me.Controls.Add(\"forms.frame.1\", \"Fra\" &amp; i)\n    With newFrame\n        .Top = topPos\n        .Left = leftPos\n        .Width = 150\n        .Height = 20\n    End With\n\n    topPos = newFrame.Top + newFrame.Height + 10\nNext i\n\ni = 1\n\nFor Each ctl In Me.Controls\n    If TypeName(ctl) = \"Frame\" Then\n            Set newImg = Me??????.Controls.Add(\"forms.image.1\", \"Img\" &amp; i) \n'don't know how to put frame name between me! and  .controls\n            With newImg\n                .Left = i * 2\n                .Width = 30\n                .BackColor = RGB(1, 255, 1)\n            End With\n        i = i + 1\n    End If\nNext\n</code></pre>\n\n<p>don't know how to put frame name between me! and  .controls</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7164514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca6e30c2ed8606f519b9993e5717db95?s=128&d=identicon&r=PG&f=1", "display_name": "mplh2008", "link": "https://stackoverflow.com/users/7164514/mplh2008"}, "edited": false, "score": 0, "creation_date": 1479253688, "post_id": 40621480, "comment_id": 68477524, "body": "Thank you for your response. I will try this tomorrow and see if this is works within the shell ()."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 13, "user_id": 7164514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca6e30c2ed8606f519b9993e5717db95?s=128&d=identicon&r=PG&f=1", "display_name": "mplh2008", "link": "https://stackoverflow.com/users/7164514/mplh2008"}, "edited": false, "score": 1, "creation_date": 1479254820, "post_id": 40621480, "comment_id": 68477884, "body": "@mplh2008 - there is no difference between string concatenations &quot;within the shell&quot; and anywhere else - all you are doing is creating a single string, and then that is being passed as a parameter to the shell.  For ease of debugging, you may like to make it two commands - <code>commandString = &quot;notepad.exe &quot;&quot;\\\\&quot; &amp; ToolID &amp; &quot;\\C:\\&quot; &amp; FileName &amp; &quot;&quot;&quot;&quot;</code> and <code>vPID = Shell(commandString, vbNormalFocus)</code>."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 13, "user_id": 7164514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca6e30c2ed8606f519b9993e5717db95?s=128&d=identicon&r=PG&f=1", "display_name": "mplh2008", "link": "https://stackoverflow.com/users/7164514/mplh2008"}, "edited": false, "score": 0, "creation_date": 1479267517, "post_id": 40621480, "comment_id": 68481144, "body": "@mplh2008 glad it&#39;s working! I would take YowE3k&#39;s suggestion into consideration as it would make it look a little more &quot;clean&quot; and help when troubleshooting."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 0, "last_activity_date": 1479255275, "last_edit_date": 1479255275, "creation_date": 1479252081, "answer_id": 40621480, "question_id": 40620817, "link": "https://stackoverflow.com/questions/40620817/vba-how-do-i-pass-a-variable-into-a-network-file-path/40621480#40621480", "title": "VBA - How do I pass a variable into a network file path", "body": "<p>I'm not quite sure how <code>Shell()</code> works, but generally, you have to \"break out\" the part where your variables will go.  It should be something like this:</p>\n\n<pre><code>vPID = Shell(\"notepad.exe \"\"\\\\\" &amp; ToolID &amp; \"\\C:\\\" &amp; FileName &amp; \"\"\"\", vbNormalFocus)\n</code></pre>\n\n<p>Similar to how if you want variables in a sentence like \"This sentence has [var1] spaces in it. That's [var2]\" would be:</p>\n\n<pre><code>myString = \"This sentence has \" &amp; var1 &amp; \" spaces in it. That's \" &amp; var2\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7164514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca6e30c2ed8606f519b9993e5717db95?s=128&d=identicon&r=PG&f=1", "display_name": "mplh2008", "link": "https://stackoverflow.com/users/7164514/mplh2008"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1772, "favorite_count": 0, "accepted_answer_id": 40621480, "answer_count": 1, "score": -2, "last_activity_date": 1479255275, "creation_date": 1479248664, "last_edit_date": 1479251184, "question_id": 40620817, "link": "https://stackoverflow.com/questions/40620817/vba-how-do-i-pass-a-variable-into-a-network-file-path", "title": "VBA - How do I pass a variable into a network file path", "body": "<p>I am very new to VBA and honestly do not know what I am doing. </p>\n\n<p>Problem:\nI need a macro to go to a file networks path based on an user's input. But I do not know if it is possible to pass two variables into a Network path. Or if there is some other way to do this. </p>\n\n<p>Ex) The user would choose the FileName they want and the IP Address of where that file is located in the Master Excel sheet from a drop down list. There are many types of files and IP Addresses, so I do not want to hard code them all into the macro. </p>\n\n<p>Currently all I have is the below hard code that states the actual location (IP Address) and FileName.</p>\n\n<pre><code>Dim vPID As Variant      vPID = Shell(\"notepad.exe \"\"\\\\105.xxx.xx.xx\\C:\\FileName\"\"\", vbNormalFocus)\n</code></pre>\n\n<p>Can someone point me to a good resource that I can research? I have been searching online for hours and cannot find anything that directly relates to what I want to do.</p>\n\n<p>I tried the below, but the network path cannot be found due to how I incorrectly inserted the variables. </p>\n\n<p>Note: The file that will be opened is in XML format that will be opened in notepad and not converted to .xls.</p>\n\n<p>Note: ToolID references an IP Address in the cell range \"G6\"\nFileName references a cell range in \"I3\"</p>\n\n<pre><code>Dim ToolID As String\nDim FileName As String\nDim vPID As Variant\nDim GetFile As Workbook\n\nSet GetFile = ThisWorkbook\nFileName = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"G6\").Value\nToolID = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"I3\").Value\n\nvPID = Shell(\"notepad.exe \"\"\\\\ToolID\\C:\\FileName\"\"\", vbNormalFocus)\n</code></pre>\n"}, {"tags": ["vba", "ms-publisher"], "comments": [{"owner": {"reputation": 816, "user_id": 5143876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f1aaff08162453b0791065c9a44b14?s=128&d=identicon&r=PG&f=1", "display_name": "Jbjstam", "link": "https://stackoverflow.com/users/5143876/jbjstam"}, "edited": false, "score": 0, "creation_date": 1479801522, "post_id": 40620289, "comment_id": 68698846, "body": "Are you looking for something more insightful than &quot;looks like a bug&quot;? ;)"}, {"owner": {"reputation": 816, "user_id": 5143876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f1aaff08162453b0791065c9a44b14?s=128&d=identicon&r=PG&f=1", "display_name": "Jbjstam", "link": "https://stackoverflow.com/users/5143876/jbjstam"}, "edited": false, "score": 0, "creation_date": 1479807109, "post_id": 40620289, "comment_id": 68702235, "body": "You&#39;d need to figure out a way to obtain the correct Hwnd first (.ActiveWindow can refer to the VBE editor), but you could use SetForegroundWindow and  SendKeys &quot;%JL1&quot;, True"}], "answers": [{"tags": [], "owner": {"reputation": 816, "user_id": 5143876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f1aaff08162453b0791065c9a44b14?s=128&d=identicon&r=PG&f=1", "display_name": "Jbjstam", "link": "https://stackoverflow.com/users/5143876/jbjstam"}, "is_accepted": false, "score": 0, "last_activity_date": 1479996017, "creation_date": 1479996017, "answer_id": 40788327, "question_id": 40620289, "link": "https://stackoverflow.com/questions/40620289/publisher-vba-vertical-text-alignment-property-not-applying/40788327#40788327", "title": "Publisher VBA Vertical Text Alignment property not applying", "body": "<p>Seems like you found a bug. Here's an attempt at a workaround..</p>\n\n<pre><code>#If Win64 Then\n    Private Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As LongPtr)\n#Else\n    Private Declare Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds as Long) 'For 32 Bit Systems\n#End If\n\nSub Centralize(oCellRange As CellRange)\n    oCellRange.Select\n    Sleep 500\n    Application.ActiveDocument.ActiveWindow.Activate\n    SendKeys \"%JL1\", True\nEnd Sub\n\nSub Test()\n    Dim oCellRange As CellRange\n    Set oCellRange = Application.ActiveDocument.Pages(1).Shapes(1).Table.Cells(1, 1, 2, 2)\n    Call Centralize(oCellRange)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 1429231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed6a2179078401ebf041069d9e1b98e3?s=128&d=identicon&r=PG", "display_name": "KBerstene", "link": "https://stackoverflow.com/users/1429231/kberstene"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 295, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1479996017, "creation_date": 1479246449, "question_id": 40620289, "link": "https://stackoverflow.com/questions/40620289/publisher-vba-vertical-text-alignment-property-not-applying", "title": "Publisher VBA Vertical Text Alignment property not applying", "body": "<p>I'm trying to create a table and center the text within vertically.  When I create the table, I fill the cell with text and apply the alignment:</p>\n\n<pre><code>Dim pg As Page\nDim tbl As Shape\n\nSet pg = ActiveDocument.ActiveView.ActivePage\n\nSet tbl = pg.Shapes.AddTable(1, 1, InchesToPoints(3), InchesToPoints(5), InchesToPoints(2), InchesToPoints(1))\n\nWith tbl.Table.Rows(1).Cells(1)\n    .TextRange.Text = \"Hello, World!\"\n    .VerticalTextAlignment = pbVerticalTextAlignmentCenter\nEnd With\n</code></pre>\n\n<p>However, the text doesn't vertically align properly.  When I look in the Cell Properties tab under \"Format Table,\" I see it is set to \"Middle\" vertical alignment already, but will only apply this once I hit \"OK\" (If I hit cancel, nothing changes).</p>\n\n<p>It doesn't matter if I change the text before or after the alignment is applied.  Anyone have any ideas on why this is happening?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1479245737, "post_id": 40620052, "comment_id": 68474439, "body": "<code>Teens_2015</code> is not a valid method of the <code>Worksheets</code> object.  You can&#39;t chain variables like that.  Remove the Worksheets from in front of it so that it&#39;s just <code>Teens_2015.Formula = &quot;=SUM(AI2:AK2)&quot;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "is_accepted": false, "score": 0, "last_activity_date": 1479245811, "creation_date": 1479245811, "answer_id": 40620106, "question_id": 40620052, "link": "https://stackoverflow.com/questions/40620052/set-formula-for-defined-range-in-excel-vba/40620106#40620106", "title": "Set formula for defined range in Excel VBA", "body": "<p><code>Range(\"RM_2015\").Offset(, -1).Formula = \"=SUM(AI2:AK2)\"</code></p>\n"}, {"tags": [], "owner": {"reputation": 63, "user_id": 1429231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed6a2179078401ebf041069d9e1b98e3?s=128&d=identicon&r=PG", "display_name": "KBerstene", "link": "https://stackoverflow.com/users/1429231/kberstene"}, "is_accepted": false, "score": 0, "last_activity_date": 1479246900, "creation_date": 1479246900, "answer_id": 40620418, "question_id": 40620052, "link": "https://stackoverflow.com/questions/40620052/set-formula-for-defined-range-in-excel-vba/40620418#40620418", "title": "Set formula for defined range in Excel VBA", "body": "<p>It's \"Worksheets(5)\" that doesn't support the \"Teens_2015\" method.  If you remove \"Worksheets(5)\" and just refer directly to the variable you set, it works fine:</p>\n\n<pre><code>Set Teens_2015 = Range(\"RM_2015\").Offset(, -1)\nTeens_2015.Formula = \"=SUM(AI2:AK2)\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1479249039, "creation_date": 1479249039, "answer_id": 40620894, "question_id": 40620052, "link": "https://stackoverflow.com/questions/40620052/set-formula-for-defined-range-in-excel-vba/40620894#40620894", "title": "Set formula for defined range in Excel VBA", "body": "<p>It would be better to fully qualify the range object and then use that, otherwise you create a conflict by trying to use a range from the active sheet as belonging to another sheet: presumably you want Teens_2015 to refer to sheet 5 rather than the active sheet.</p>\n\n<pre><code>Set Teens_2015 = Worksheets(5).Range(\"RM_2015\").Offset(, -1)\nTeens_2015.Formula = \"=SUM(AI2:AK2)\"\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7164347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0459f37a06b6415d38e26a7ee8a80362?s=128&d=identicon&r=PG&f=1", "display_name": "Will Clein", "link": "https://stackoverflow.com/users/7164347/will-clein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 457, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1479249039, "creation_date": 1479245606, "question_id": 40620052, "link": "https://stackoverflow.com/questions/40620052/set-formula-for-defined-range-in-excel-vba", "title": "Set formula for defined range in Excel VBA", "body": "<p>I'm trying to apply a formula to an entire defined range as follows:</p>\n\n<pre><code>    Set Teens_2015 = Range(\"RM_2015\").Offset(, -1)\n        Worksheets(5).Teens_2015.Formula = \"=SUM(AI2:AK2)\"\n</code></pre>\n\n<p>Where RM_2015 is a named range in my workbook. I get the following error when I run this:</p>\n\n<pre><code>    Runtime error'438':\n    Object doesn't support this property or method\n</code></pre>\n\n<p>Can someone clue me in as to what I'm doing wrong here?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "userform"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1479246851, "post_id": 40620007, "comment_id": 68474984, "body": "The index is determined by the order of items in the container, by the container - not by the items."}, {"owner": {"reputation": 70, "user_id": 4271055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f8ef2fbc2eb2ab742b6bacfb3d2c0c9?s=128&d=identicon&r=PG&f=1", "display_name": "bbadgett", "link": "https://stackoverflow.com/users/4271055/bbadgett"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1479249821, "post_id": 40620007, "comment_id": 68476307, "body": "I know, but is there a way to find out which order the container has placed the items?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1479249849, "post_id": 40620007, "comment_id": 68476315, "body": "Iterate the container and find out?"}], "owner": {"reputation": 70, "user_id": 4271055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f8ef2fbc2eb2ab742b6bacfb3d2c0c9?s=128&d=identicon&r=PG&f=1", "display_name": "bbadgett", "link": "https://stackoverflow.com/users/4271055/bbadgett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 185, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1479245417, "creation_date": 1479245417, "question_id": 40620007, "link": "https://stackoverflow.com/questions/40620007/determine-the-index-of-userforms-in-the-collection", "title": "Determine the Index of UserForms in the Collection", "body": "<p>I am working on a VBA \"application\" that I did not initially write.  The application uses a couple of different UserForms. The original coder referenced the individual userforms by referencing their position in the UserForms() collection.  Ex <code>UserForms(MainFormID)</code> where <code>Integer MainFormID</code> is <code>0</code></p>\n\n<p>However, I recently made a change that added another UserForm. However, (I'm thinking) this changed the index values of some of the other forms, so lines like <code>UserForms(MainFormID).SomeControl.SomeMethod</code> are throwing errors. Even weirder, this only seems to happen after I run the app once; It runs perfectly fine the first time.</p>\n\n<p>Instead of hard coding <code>MainFormID = 0</code> and <code>LinkFormID = 1</code>, I'd like to the program to determine the index of the forms based on their keys (names).</p>\n\n<p>Is there something like <code>LinkFormID = UserForms(\"LinkForm\").index</code>?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1479244980, "post_id": 40619879, "comment_id": 68474062, "body": "<code>Any ideas?</code> is too broad for this forum.  Stack Overflow is not a code for me site.  Please post any code you have tried and explain specifically what is in error so we can help you overcome that specific error."}, {"owner": {"reputation": 3, "user_id": 7158482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af9957173e5a40af68a0ddac9e065ebc?s=128&d=identicon&r=PG&f=1", "display_name": "KGHicks", "link": "https://stackoverflow.com/users/7158482/kghicks"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1479329704, "post_id": 40619879, "comment_id": 68516315, "body": "@ScottCraner  - I apologize. I am relatively new to using excel to manipulate large data sets. For future posts, I will post my efforts first."}], "answers": [{"tags": [], "owner": {"reputation": 472, "user_id": 6899593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/000e1cc8d4874fb425a2508604baac39?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamad", "link": "https://stackoverflow.com/users/6899593/mohamad"}, "is_accepted": true, "score": 0, "last_activity_date": 1479294605, "last_edit_date": 1479294605, "creation_date": 1479293518, "answer_id": 40630257, "question_id": 40619879, "link": "https://stackoverflow.com/questions/40619879/combine-multiple-rows-into-one-row-excel/40630257#40630257", "title": "Combine multiple rows into one row - Excel", "body": "<p>I took care to develop a VBA code, I do not know your level in Excel .. I also took care to make the code as simple as possible.\nIn this code (below) :\nSheets1 is the sheet where the data is presented and read.\nSheet2 is the sheet where the data is written.\nRowsColsTransformer() is the procedure to run.</p>\n\n<p>'VBA:</p>\n\n<pre><code>Sub RowsColsTransformer()\nDim CurrentLine As Integer\nDim CurrentLine2 As Integer\nDim CurrentCols2 As Integer\nDim Max As Integer\n\nCurrentLine2 = 2\nCurrentCols2 = 1\nMax = 10 ' -- Number of lines in the sheet where data will be read.\nFor CurrentLine = 2 To Max\n    Sheets(2).Cells(CurrentLine2, CurrentCols2) = Sheets(1).Cells(CurrentLine, 1)\n    CurrentCols2 = CurrentCols2 + 1\n    Sheets(2).Cells(CurrentLine2, CurrentCols2) = Sheets(1).Cells(CurrentLine, 2)\n    CurrentCols2 = CurrentCols2 + 1\n    Sheets(2).Cells(CurrentLine2, CurrentCols2) = Sheets(1).Cells(CurrentLine, 3)\n    CurrentCols2 = CurrentCols2 + 1\n    Sheets(2).Cells(CurrentLine2, CurrentCols2) = Sheets(1).Cells(CurrentLine, 4)\n    CurrentCols2 = CurrentCols2 + 1\n    Sheets(2).Cells(CurrentLine2, CurrentCols2) = Sheets(1).Cells(CurrentLine, 5)\n    CurrentCols2 = CurrentCols2 + 1\n    Sheets(2).Cells(CurrentLine2, CurrentCols2) = Sheets(1).Cells(CurrentLine, 6)\n    CurrentCols2 = CurrentCols2 + 1\n    Sheets(2).Cells(CurrentLine2, CurrentCols2) = Sheets(1).Cells(CurrentLine, 7)\n    CurrentCols2 = CurrentCols2 + 1\n    Sheets(2).Cells(CurrentLine2, CurrentCols2) = Sheets(1).Cells(CurrentLine, 8)\n    CurrentCols2 = CurrentCols2 + 1\n    '-- Reintialize Line and Column\n    If CurrentLine Mod 4 = 1 And CurrentLine &gt; 1 Then\n        CurrentLine2 = CurrentLine2 + 1\n        CurrentCols2 = 1\n    End If\nNext CurrentLine\nEnd Sub\n</code></pre>\n\n<p>Holp this can help.</p>\n"}], "owner": {"reputation": 3, "user_id": 7158482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af9957173e5a40af68a0ddac9e065ebc?s=128&d=identicon&r=PG&f=1", "display_name": "KGHicks", "link": "https://stackoverflow.com/users/7158482/kghicks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1703, "favorite_count": 0, "accepted_answer_id": 40630257, "answer_count": 1, "score": -3, "last_activity_date": 1479294605, "creation_date": 1479244852, "last_edit_date": 1531161705, "question_id": 40619879, "link": "https://stackoverflow.com/questions/40619879/combine-multiple-rows-into-one-row-excel", "title": "Combine multiple rows into one row - Excel", "body": "<p>I need help finding a way to combine multiple rows into one row in excel.</p>\n\n<p>For example, I have 8 columns (A - H) of data in rows 1 - 4 and 5 - 8 (Table 1). I need a method to move all columns of rows 2 - 4 to columns I - AF of row 1 and all columns of rows 4 - 8 to columns I - AF of row 5 (Table 2). The resulting blank rows are not necessary either. In reality, I need to apply this method multiple times. Any ideas? </p>\n\n<pre><code>Table 1\n    A   B   C   D   E   F   G   H\n1   1   2   3   4   5   6   7   8\n2   9   10  11  12  13  14  15  16\n3   17  18  19  20  21  22  23  24\n4   25  26  27  28  29  30  31  32\n5   1   2   3   4   5   6   7   8\n6   9   10  11  12  13  14  15  16\n7   17  18  19  20  21  22  23  24\n8   25  26  27  28  29  30  31  32\n\nTable 2\n    A   B   C   D   E   F   G   H   I   \u2026   AD  AE  AF\n1   1   2   3   4   5   6   7   8   9   \u2026   30  31  32\n2                                                   \n3                                                   \n4                                                   \n5   1   2   3   4   5   6   7   8   9   \u2026   30  31  32\n6                                                   \n7                                                   \n8                                                   \n</code></pre>\n"}]