[{"tags": ["vba", "recordset"], "comments": [{"owner": {"reputation": 1, "user_id": 12055587, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mATpefiijOysYhW2Aoe3Jb1cPbs1hxZWLfYmzZo=k-s128", "display_name": "Sanjay Karmkar", "link": "https://stackoverflow.com/users/12055587/sanjay-karmkar"}, "edited": false, "score": 0, "creation_date": 1568244923, "post_id": 57897977, "comment_id": 102216820, "body": "When I am executing this codes I am getting an error &quot;Data Type mismatch in criterion expression&quot;"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1568246606, "post_id": 57897977, "comment_id": 102217120, "body": "Query only return one row?  As you are new to access, start with the usual bound form. Add your sql (omit the where part) to the forms record  source and bind the fcontrols to the fields/control source). Using Agodb on forms is mastery. VBA Integers are limited to -32768 to 32767 (16bit/2bytes), what ,may exced recordcount. Use Long instead."}, {"owner": {"reputation": 1, "user_id": 12055587, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mATpefiijOysYhW2Aoe3Jb1cPbs1hxZWLfYmzZo=k-s128", "display_name": "Sanjay Karmkar", "link": "https://stackoverflow.com/users/12055587/sanjay-karmkar"}, "reply_to_user": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1568299091, "post_id": 57897977, "comment_id": 102238009, "body": "Thanks for reply, Will implement the advise and post"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1568245147, "creation_date": 1568245147, "answer_id": 57898007, "question_id": 57897977, "link": "https://stackoverflow.com/questions/57897977/recordset-data-is-not-populated-in-txt-field/57898007#57898007", "title": "recordset data is not populated in txt field", "body": "<pre><code>...(((dtblAccount.[ACCOUNT_NO])='AcNo'))\"\n</code></pre>\n\n<p>should be </p>\n\n<pre><code>...(((dtblAccount.[ACCOUNT_NO])=\" &amp; AcNo &amp; \"))\"\n</code></pre>\n\n<p>assuming ACCOUNT_NO is a numeric field.</p>\n\n<p>You're also not populating AcNo - it will have the default value of zero.</p>\n"}], "owner": {"reputation": 1, "user_id": 12055587, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mATpefiijOysYhW2Aoe3Jb1cPbs1hxZWLfYmzZo=k-s128", "display_name": "Sanjay Karmkar", "link": "https://stackoverflow.com/users/12055587/sanjay-karmkar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568245147, "creation_date": 1568244795, "question_id": 57897977, "link": "https://stackoverflow.com/questions/57897977/recordset-data-is-not-populated-in-txt-field", "title": "recordset data is not populated in txt field", "body": "<p>I am new to Access and VBA trying to explore. I have a form where there is two text boxes(txtAc &amp; txtFirstName), I want data to be populated in txtFirstName on the basis of SQL query based on parameter of txtAc. I tried to achieve the same by recordset. Please review my code below: -</p>\n\n<pre><code> Private Sub txtCust_Click()\n Dim cnn As ADODB.Connection\n Dim strSQL As String\n Dim rst As ADODB.Recordset\n Set cnn = CurrentProject.Connection\n Dim i As Integer\n Dim Records As Integer\n Dim AcN As Double\n Dim AcNo As Double\n AcN = Forms!dfrmAccount!txtAc.Value\n AcN = AcNo\n strSQL = \"SELECT dtblCustomer.[FIRST_N], dtblAccount.[ACCOUNT_NO] FROM \n dtblAccount INNER JOIN dtblCustomer ON dtblAccount.[CUSTOMER_ID] = \n dtblCustomer.[CUSTOMER_ID] WHERE (((dtblAccount.[ACCOUNT_NO])='AcNo'))\"\n Set rst = New ADODB.Recordset\n rst.CursorLocation = adUseClient\n rst.Open strSQL, cnn\n Records = rst.RecordCount\n Debug.Print rst.RecordCount\n For i = 1 To Records\n Me.txtFirstName.Value = rst.Fields!FIRST_N\n Debug.Print rst.Fields!FIRST_N\n rst.MoveNext\n Next i\n '' Clean up\nrst.CLOSE\nSet rst = Nothing\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance. Plz somebody help.</p>\n"}, {"tags": ["vba", "timestamp", "exe", "digital-signature"], "comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 3, "creation_date": 1568243220, "post_id": 57897780, "comment_id": 102216463, "body": "Welcome to SO! Please take the <a href=\"https://stackoverflow.com/tour\">tour</a> and read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>. That shows you that one of the first actions is to put your questions title to your favourite search engine. Keep in mind that you are able to use command-line tools in vba."}, {"owner": {"reputation": 1, "user_id": 12055452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bd1783d039f00668f1b421fa7ef6204?s=128&d=identicon&r=PG&f=1", "display_name": "hikihey", "link": "https://stackoverflow.com/users/12055452/hikihey"}, "reply_to_user": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1568574026, "post_id": 57897780, "comment_id": 102307752, "body": "@ComputerVersteher Thanks and yup, I&#39;ve googled it multiple times in various forms before I posted this question, but couldn&#39;t find anything about merely retrieving the date itself (in vba at least).  The results I&#39;ve seen seem to be mostly creating signatures which seems to involve an internet connection, which I don&#39;t need and I was thinking I wouldn&#39;t need that just to get the date itself.  I was trying to avoid external applications to extract it, but it sounds like you&#39;re saying that I need to use signtool.  Thank you."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1568618398, "post_id": 57897780, "comment_id": 102316339, "body": "<a href=\"https://docs.microsoft.com/en-us/sysinternals/downloads/sigcheck\" rel=\"nofollow noreferrer\">Sigcheck</a> is in top 5 of my search results on your topic."}, {"owner": {"reputation": 1, "user_id": 12055452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bd1783d039f00668f1b421fa7ef6204?s=128&d=identicon&r=PG&f=1", "display_name": "hikihey", "link": "https://stackoverflow.com/users/12055452/hikihey"}, "reply_to_user": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1568753956, "post_id": 57897780, "comment_id": 102373086, "body": "@ComputerVersteher Thanks.  Sorry, I meant I had been searching for ways to do it without downloading other applications.  Signtool is also a command-line tool I saw in most of my searches that I mentioned in the topic, so sorry for assuming that&#39;s the one you were talking about. I wanted to avoid using it if I could, but it&#39;s sounding like there&#39;s not really any way other than using an external application, which is really the answer to my initial question.  Sigcheck looks like it would be easier to use than signtool though, so I&#39;ll probably end up going with that.  Thanks again for the help."}], "owner": {"reputation": 1, "user_id": 12055452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bd1783d039f00668f1b421fa7ef6204?s=128&d=identicon&r=PG&f=1", "display_name": "hikihey", "link": "https://stackoverflow.com/users/12055452/hikihey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568242783, "creation_date": 1568242783, "question_id": 57897780, "link": "https://stackoverflow.com/questions/57897780/retrieve-timestamp-from-digital-signature-in-exe-file-using-vba", "title": "Retrieve timestamp from digital signature in exe file using vba", "body": "<p>Is it possible to retrieve the timestamp date from a digital signature in an exe file using only vba?  I don't need to edit anything in the signature or file.  I just need to use that date in my code.  </p>\n\n<p>I've tried to find similar examples but can only find ones about actually signing files, not simply retrieving the timestamp date.  I've read about the signtool.exe and the signedcode object using the capicom dll, but I can't find any examples using these in vba to get the date.  I thought I read somewhere that capicom was discontinued too so not sure if I've been looking in the right place or not.  Do I have to somehow incorporate signtool into my code or is there a library I can reference that can retrieve that date?</p>\n\n<p>Sorry I don't have any code.  I have no idea how to start, if it's even possible to do this with just vba.  Thank you in advance and sorry for the lack of knowledge on my part.</p>\n"}, {"tags": ["vba", "powerpoint", "powerpoint2016"], "comments": [{"owner": {"reputation": 45, "user_id": 9207113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86c7c884586a33358b8cbbf983d017c1?s=128&d=identicon&r=PG&f=1", "display_name": "pptbot", "link": "https://stackoverflow.com/users/9207113/pptbot"}, "edited": false, "score": 0, "creation_date": 1568913074, "post_id": 57897653, "comment_id": 102435650, "body": "Any advice? or this is not possible with vba?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 12155078, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBzsHGVT9xn5RuZzwPoiTNoWtisDgHx_195y0fsig=k-s128", "display_name": "Vladyslav Sorokin", "link": "https://stackoverflow.com/users/12155078/vladyslav-sorokin"}, "is_accepted": false, "score": 0, "last_activity_date": 1570050120, "last_edit_date": 1570050120, "creation_date": 1570034964, "answer_id": 58205912, "question_id": 57897653, "link": "https://stackoverflow.com/questions/57897653/vba-to-scale-slide-size-to-ppt-standard-43-maximize/58205912#58205912", "title": "VBA to scale slide size to PPT Standard 4:3 Maximize", "body": "<p>I did it once in C# with:</p>\n\n<pre><code>pptPresentation.PageSetup.SlideSize = PpSlideSizeType.ppSlideSizeOnScreen;\n</code></pre>\n\n<p>And do scale it to the full slide size, just create a new <code>CustomLayout</code> which is equal to your Presentation and set your Shape Sizes equal to the CustomLayout.</p>\n\n<pre><code>CustomLayout customLayout = pptPresenation.SlideMaster.CustomLayouts[PpSlideLayout.ppLayoutText]\nshape.Height = customLayout.Height;\nshape.Width = customLayout.Width;\n</code></pre>\n\n<p>I did it a long time ago. I hope it helps.</p>\n"}], "owner": {"reputation": 45, "user_id": 9207113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86c7c884586a33358b8cbbf983d017c1?s=128&d=identicon&r=PG&f=1", "display_name": "pptbot", "link": "https://stackoverflow.com/users/9207113/pptbot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 686, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1583835373, "creation_date": 1568241559, "last_edit_date": 1583835373, "question_id": 57897653, "link": "https://stackoverflow.com/questions/57897653/vba-to-scale-slide-size-to-ppt-standard-43-maximize", "title": "VBA to scale slide size to PPT Standard 4:3 Maximize", "body": "<p>I want to resize my PowerPoint slide size to Standard (4:3) Maximize. I have the code to automatic resized to 4:3, but it defaults to Ensure Fit. How could I change the code to scale the Slide Size to 4:3 Maximize and not Ensure Fit? I've tried looking all over the internet and didn't see a solution. </p>\n\n<p>This is the code I have so far. Thank you in advance!</p>\n\n<pre><code>Public Sub StandardMaximize()\n\nDim PPPres As Presentation\nApplication.ActivePresentation.PageSetup.SlideSize = ppSlideSizeCustom\nSet PPPres = Application.ActivePresentation\n\nWith PPPres.PageSetup\n.SlideSize = ppSlideSizeCustom\n.SlideWidth = 10 * 72\n.SlideHeight = 7.5 * 72\n.FirstSlideNumber = 1\n.SlideOrientation = msoOrientationHorizontal\n.NotesOrientation = msoOrientationVertical\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1568238439, "post_id": 57897186, "comment_id": 102215386, "body": "because you set <code>j</code> based on one sheet and add one to it no matter to what sheet it is pasted, you will get blank lines on all the sheets."}, {"owner": {"reputation": 13, "user_id": 8630012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c2e64fd33b0a6b16ef290502203bd4e?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Nilges", "link": "https://stackoverflow.com/users/8630012/dave-nilges"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1568239106, "post_id": 57897186, "comment_id": 102215526, "body": "I attached my current results in the question @ScottCraner"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1568239354, "post_id": 57897186, "comment_id": 102215578, "body": "While those are pretty pictures they do not mean anything to us without some more context.  what is wrong with those pictures?"}, {"owner": {"reputation": 290, "user_id": 6387947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68bd3078f0f802c7e8769ecfd63878d8?s=128&d=identicon&r=PG&f=1", "display_name": "scenography", "link": "https://stackoverflow.com/users/6387947/scenography"}, "edited": false, "score": 1, "creation_date": 1568241246, "post_id": 57897186, "comment_id": 102216033, "body": "In your code, j is the row number of a blank row on &quot;Pole Change Out.&quot; I think the code needs different variables for the other sheets, &quot;Midspan Poles&quot; and &quot;Anchor Replacement.&quot;"}, {"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1568258447, "post_id": 57897186, "comment_id": 102219283, "body": "In your ScreenCaptures of &quot;Make-Ready&quot; sheet, there is no &quot;Pole Change-Out&quot;, &quot;New Midspan Poles&quot; or &quot;Yes&quot; value, so, what it is supposed that you are expecting from this loop? If it can not find the value, it can not copy it."}], "answers": [{"tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 0, "last_activity_date": 1568304070, "creation_date": 1568304070, "answer_id": 57910585, "question_id": 57897186, "link": "https://stackoverflow.com/questions/57897186/copy-and-pasting-all-values-from-one-sheet-to-another/57910585#57910585", "title": "Copy and pasting all values from one sheet to another", "body": "<p>As @scottCraner and the others pointed out. You are trying to use the first empty cell variable from one sheet on the other two sheets. The update to your code will automatically update the first blank cell for each sheet. </p>\n\n<pre><code>Sub copy_paste_based_on_cell_interior_rgb()\nDim LastRow As Long\n\nDim i As Long ', j As Long\n\n'Find the last used row in a Column: column A in this example\n With Worksheets(\"Make-Ready\")\n  LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n End With\n\n'first row number where you need to paste values in Sheet1'\n'With Worksheets(\"Pole Change Out\")\n'  j = .Cells(.Rows.Count, \"A\").End(xlUp).Row + 1\n'End With\n\nFor i = 1 To LastRow\n   With Worksheets(\"Make-Ready\")\n       If .Cells(i, 27).Value = \"Pole Change-Out\" Then\n           .Rows(i).Copy Destination:=Worksheets(\"Pole Change Out\").Cells(Rows.Count, 1).End(xlUp).Offset(1)\n\n           'j = j + 1\n       ElseIf .Cells(i, 27).Value = \"New Midspan Pole\" Then\n           .Rows(i).Copy Destination:=Worksheets(\"Midspan Poles\").Cells(Rows.Count, 1).End(xlUp).Offset(1)\n\n           'j = j + 1\n       ElseIf .Cells(i, 104).Value = \"Yes\" Then\n           .Rows(i).Copy Destination:=Worksheets(\"Anchor Replacement\").Cells(Rows.Count, 1).End(xlUp).Offset(1)\n\n           'j = j + 1\n       End If\n   End With\n   Next i\n\n   End Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8630012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c2e64fd33b0a6b16ef290502203bd4e?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Nilges", "link": "https://stackoverflow.com/users/8630012/dave-nilges"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568304070, "creation_date": 1568238247, "last_edit_date": 1568238982, "question_id": 57897186, "link": "https://stackoverflow.com/questions/57897186/copy-and-pasting-all-values-from-one-sheet-to-another", "title": "Copy and pasting all values from one sheet to another", "body": "<p>I have a macro that creates a sheet full of data. I recently added new sheets so that unique values can go into each one. For example if a row contains \"Pole Change Out\" then that entire row is copy and pasted into the \"Pole Change Out\" sheet. there are 4 different sheets. My problem is, since some values are determined by a formula in vba, some values are not moving into the new sheet. </p>\n\n<pre><code>Sub copy_paste_based_on_cell_interior_rgb()\nDim LastRow As Long\n\nDim i As Long, j As Long\n\n'Find the last used row in a Column: column A in this example\n With Worksheets(\"Make-Ready\")\n  LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n End With\n\n'first row number where you need to paste values in Sheet1'\nWith Worksheets(\"Pole Change Out\")\n  j = .Cells(.Rows.Count, \"A\").End(xlUp).Row + 1\nEnd With\n\nFor i = 1 To LastRow\n   With Worksheets(\"Make-Ready\")\n       If .Cells(i, 27).Value = \"Pole Change-Out\" Then\n           .Rows(i).Copy Destination:=Worksheets(\"Pole Change Out\").Range(\"A\" &amp; j)\n           j = j + 1\n       ElseIf .Cells(i, 27).Value = \"New Midspan Pole\" Then\n           .Rows(i).Copy Destination:=Worksheets(\"Midspan Poles\").Range(\"A\" &amp; j)\n           j = j + 1\n       ElseIf .Cells(i, 104).Value = \"Yes\" Then\n           .Rows(i).Copy Destination:=Worksheets(\"Anchor Replacement\").Range(\"A\" &amp; j)\n           j = j + 1\n       End If\n   End With\n   Next i\n\n   End Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/zR66U.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zR66U.png\" alt=\"Current Output\"></a>\n<a href=\"https://i.stack.imgur.com/ck0Ke.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ck0Ke.png\" alt=\"What It is in &quot;Make-Ready&quot; that needs to be replicated in &quot;Pole Change Out&quot;\"></a></p>\n"}, {"tags": ["excel", "vba", "memory-leaks"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1568238489, "post_id": 57897101, "comment_id": 102215397, "body": "First thing to do is to avoid <code>As New</code>, which makes an auto-instantiated object - if you added <code>Debug.Print a Is Nothing</code> under <code>Set a = Nothing</code>, you would find that it prints <code>False</code>"}, {"owner": {"reputation": 115, "user_id": 11783976, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GOumVGrWC94/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcXz0t5EB0hecsxE6d7KDN-wFLX6g/photo.jpg?sz=128", "display_name": "Dam Gal", "link": "https://stackoverflow.com/users/11783976/dam-gal"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1568238953, "post_id": 57897101, "comment_id": 102215494, "body": "The question is why does referencing from SQLSettings to settings prevent termination of settings class... why all subclasses don&#39;t get terminated?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1568238965, "post_id": 57897101, "comment_id": 102215496, "body": "See answer below"}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 11783976, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GOumVGrWC94/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcXz0t5EB0hecsxE6d7KDN-wFLX6g/photo.jpg?sz=128", "display_name": "Dam Gal", "link": "https://stackoverflow.com/users/11783976/dam-gal"}, "edited": false, "score": 0, "creation_date": 1568240721, "post_id": 57897286, "comment_id": 102215907, "body": "I see. So basically I should make subroutines that brake references before removing objects..."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 115, "user_id": 11783976, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GOumVGrWC94/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcXz0t5EB0hecsxE6d7KDN-wFLX6g/photo.jpg?sz=128", "display_name": "Dam Gal", "link": "https://stackoverflow.com/users/11783976/dam-gal"}, "edited": false, "score": 0, "creation_date": 1568240835, "post_id": 57897286, "comment_id": 102215928, "body": "@DamGal yup. Could be just the parent exposing a <code>Teardown</code> method that iterates all children and invokes their own <code>Teardown</code> method (recursively, if that&#39;s a tree structure)."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 6, "last_activity_date": 1568239498, "last_edit_date": 1568239498, "creation_date": 1568238881, "answer_id": 57897286, "question_id": 57897101, "link": "https://stackoverflow.com/questions/57897101/how-to-terminate-a-class-with-reference-to-parent/57897286#57897286", "title": "How to terminate a class with reference to parent?", "body": "<p>There is no garbage collector, VBA is reference-counted, not garbage-collected.</p>\n\n<p>If an object has >0 references, it doesn't get terminated. As a consequence, if one or more child objects are referencing a parent object, nulling the parent won't destroy any objects.</p>\n\n<p>Also not helping, <code>Dim...As New</code> creates <a href=\"http://rubberduckvba.com/Inspections/Details/SelfAssignedDeclaration\" rel=\"nofollow noreferrer\">auto-instantiated objects</a> - you'll want to frantically avoid that.</p>\n\n<p>Hard to tell where to plug it with so little code shown, but basically you need the child objects to explicitly <code>Set Parent = Nothing</code> at one point or another, <strong>before</strong> you try nulling the parent object.</p>\n\n<p>If you're feeling adventurous you could side-step the issue using <a href=\"https://rubberduckvba.wordpress.com/2018/09/11/lazy-object-weak-reference/\" rel=\"nofollow noreferrer\">WeakReferences</a> (disclaimer: I wrote that article), but that may be a bit unstable or crash-prone.</p>\n"}], "owner": {"reputation": 115, "user_id": 11783976, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GOumVGrWC94/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcXz0t5EB0hecsxE6d7KDN-wFLX6g/photo.jpg?sz=128", "display_name": "Dam Gal", "link": "https://stackoverflow.com/users/11783976/dam-gal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 57897286, "answer_count": 1, "score": 2, "last_activity_date": 1568253816, "creation_date": 1568237712, "last_edit_date": 1568253816, "question_id": 57897101, "link": "https://stackoverflow.com/questions/57897101/how-to-terminate-a-class-with-reference-to-parent", "title": "How to terminate a class with reference to parent?", "body": "<p>I've found out that class doesn't flush itself if you have a reference to parent within.\nFor example something like this:</p>\n\n<pre><code>Private Sub test()\n    Dim a As New settings\n    Dim b As New Collection\n    b.Add a\n    Set a = Nothing\nEnd Sub\n</code></pre>\n\n<p>And in class 'settings':</p>\n\n<pre><code>Private SQLSettings As New settingsserver\nPrivate Sub Class_Initialize()\n    Me.SQLSettings.Initialize Parent:=Me\n    MsgBox \"init\"\nEnd Sub\nPrivate Sub Class_Terminate()\n    MsgBox \"terminate\"\nEnd Sub\n</code></pre>\n\n<p>So basically if I remove Parent:=Me it will terminate settings class, but if I leave it, it will stay in garbage collector. Why is that? The class has a subclass with reference to that class so shouldn't it flush whole package? How can can you flush a class automatically with reference to a parent class?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1568258846, "post_id": 57896620, "comment_id": 102219347, "body": "Where did you define CurrentEditRange and CurrentCell?"}, {"owner": {"reputation": 1, "user_id": 4392210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35aec8110e0f6b7bf67450a5a8df6a5a?s=128&d=identicon&r=PG&f=1", "display_name": "Jolnar Industries", "link": "https://stackoverflow.com/users/4392210/jolnar-industries"}, "reply_to_user": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1568299722, "post_id": 57896620, "comment_id": 102238397, "body": "I defined them implicitly in the For loops."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1568388592, "post_id": 57896620, "comment_id": 102270504, "body": "@JolnarIndustries Picky, but should it read <code>For Each CurrentCell In DataTable.Cells</code> instead?  (I <i>believe</i> that <code>.Cells</code> is the implicit default, but you can also have <code>.Rows</code>, <code>.Columns</code>, <code>.Areas</code>, et cetera)  More to the point, should you be using <code>ThisWorkbook</code> instead of <code>ActiveWorkbook</code>?  And you only need 1 <code>If</code> statement: <code>If CurrentCell.Value = &quot;&quot; OR CurrentCell.Value = &quot;0&quot; Then</code>"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1568388947, "post_id": 57896620, "comment_id": 102270693, "body": "Is the Worksheet actually Protected if you run this code?  If you step through line-by-line with F8, does it do anything unexpected?"}, {"owner": {"reputation": 1, "user_id": 4392210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35aec8110e0f6b7bf67450a5a8df6a5a?s=128&d=identicon&r=PG&f=1", "display_name": "Jolnar Industries", "link": "https://stackoverflow.com/users/4392210/jolnar-industries"}, "edited": false, "score": 0, "creation_date": 1568408821, "post_id": 57896620, "comment_id": 102278103, "body": "Everything outside the table is protected just fine.  I haven&#39;t tried going through step by step"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4392210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35aec8110e0f6b7bf67450a5a8df6a5a?s=128&d=identicon&r=PG&f=1", "display_name": "Jolnar Industries", "link": "https://stackoverflow.com/users/4392210/jolnar-industries"}, "edited": false, "score": 0, "creation_date": 1568288016, "post_id": 57903016, "comment_id": 102231504, "body": "So maybe just add Set NewEditRange = Range($A$1) or something like that after the Dim?"}, {"owner": {"reputation": 33, "user_id": 8990305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24116a27ce87469c443cb6c917070add?s=128&d=identicon&r=PG&f=1", "display_name": "YeOldHinnerk", "link": "https://stackoverflow.com/users/8990305/yeoldhinnerk"}, "reply_to_user": {"reputation": 1, "user_id": 4392210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35aec8110e0f6b7bf67450a5a8df6a5a?s=128&d=identicon&r=PG&f=1", "display_name": "Jolnar Industries", "link": "https://stackoverflow.com/users/4392210/jolnar-industries"}, "edited": false, "score": 0, "creation_date": 1568632374, "post_id": 57903016, "comment_id": 102323180, "body": "Set NewEditRange = Nothing"}, {"owner": {"reputation": 33, "user_id": 8990305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24116a27ce87469c443cb6c917070add?s=128&d=identicon&r=PG&f=1", "display_name": "YeOldHinnerk", "link": "https://stackoverflow.com/users/8990305/yeoldhinnerk"}, "reply_to_user": {"reputation": 1, "user_id": 4392210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35aec8110e0f6b7bf67450a5a8df6a5a?s=128&d=identicon&r=PG&f=1", "display_name": "Jolnar Industries", "link": "https://stackoverflow.com/users/4392210/jolnar-industries"}, "edited": false, "score": 0, "creation_date": 1568632418, "post_id": 57903016, "comment_id": 102323206, "body": "Ups, too hastily: Of course then you Need to distinguish `if NewEditRange is nothing then ... else ... end if."}], "tags": [], "owner": {"reputation": 33, "user_id": 8990305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24116a27ce87469c443cb6c917070add?s=128&d=identicon&r=PG&f=1", "display_name": "YeOldHinnerk", "link": "https://stackoverflow.com/users/8990305/yeoldhinnerk"}, "is_accepted": false, "score": 0, "last_activity_date": 1568278000, "creation_date": 1568278000, "answer_id": 57903016, "question_id": 57896620, "link": "https://stackoverflow.com/questions/57896620/trouble-with-vba-designed-to-prevent-cells-with-values-from-being-edited-upon-sa/57903016#57903016", "title": "Trouble with VBA designed to prevent cells with values from being edited upon save", "body": "<p>You should always use `Option Explicit\nI have some doubt that Application.Union works on NewEditRange if it is still nothing. You should initialize it and may have to split the case of NewEditRange being nothing or not.</p>\n\n<p>(Can't comment due to rep)</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4392210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35aec8110e0f6b7bf67450a5a8df6a5a?s=128&d=identicon&r=PG&f=1", "display_name": "Jolnar Industries", "link": "https://stackoverflow.com/users/4392210/jolnar-industries"}, "is_accepted": true, "score": 0, "last_activity_date": 1569680471, "creation_date": 1569680471, "answer_id": 58147226, "question_id": 57896620, "link": "https://stackoverflow.com/questions/57896620/trouble-with-vba-designed-to-prevent-cells-with-values-from-being-edited-upon-sa/58147226#58147226", "title": "Trouble with VBA designed to prevent cells with values from being edited upon save", "body": "<p>Okay, so it turns out the problem is that you can't protect cells in tables.  Period.  If you are interested in them adding this feature, go to <a href=\"https://excel.uservoice.com/forums/304921-excel-for-windows-desktop-application/suggestions/16452913-get-tables-working-on-protected-sheets-add-rows\" rel=\"nofollow noreferrer\">https://excel.uservoice.com/forums/304921-excel-for-windows-desktop-application/suggestions/16452913-get-tables-working-on-protected-sheets-add-rows</a> and vote.</p>\n"}], "owner": {"reputation": 1, "user_id": 4392210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35aec8110e0f6b7bf67450a5a8df6a5a?s=128&d=identicon&r=PG&f=1", "display_name": "Jolnar Industries", "link": "https://stackoverflow.com/users/4392210/jolnar-industries"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 58147226, "answer_count": 2, "score": 0, "last_activity_date": 1569680471, "creation_date": 1568234923, "last_edit_date": 1568388040, "question_id": 57896620, "link": "https://stackoverflow.com/questions/57896620/trouble-with-vba-designed-to-prevent-cells-with-values-from-being-edited-upon-sa", "title": "Trouble with VBA designed to prevent cells with values from being edited upon save", "body": "<p>I am working on a table in a spreadsheet that multiple users will be editing.  We have had problems with people pasting over other entries accidentally or moving half of a row up several columns.  I want to protect every cell with values in it, or alternatively allow every cell without values to be edited.</p>\n\n<p>I have tried making the whole table editable, then locking the cells with values in it.  This seemed to do nothing, as I was able to edit values anyway.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n    Dim NewEditRange As Range\n    Dim ThisSheet As Worksheet\n    Dim DataTable As Range\n    Dim CurrentEditRange As AllowEditRange\n    Dim CurrentCell As Range\n    Set ThisSheet = ActiveWorkbook.Worksheets(\"Data\")\n    Set DataTable = ThisSheet.Range(\"Table1\")\n    Set NewEditRange = ThisSheet.Range(\"$A$1\")\n    ThisSheet.Unprotect\n    For Each CurrentEditRange In ThisSheet.Protection.AllowEditRanges\n        CurrentEditRange.Delete\n    Next\n    For Each CurrentCell In DataTable\n        If CurrentCell.Value = \"\" Then\n            Set NewEditRange = Application.Union(NewEditRange, CurrentCell)\n        End If\n        If CurrentCell.Value = \"0\" Then\n            Set NewEditRange = Application.Union(NewEditRange, CurrentCell)\n        End If\n    Next\n    ThisSheet.Protection.AllowEditRanges.Add Title:=\"New Edit Range\", Range:=NewEditRange\n    ThisSheet.Protect\nEnd Sub\n</code></pre>\n\n<p>I expect this to unlock the sheet, delete all AllowEditRange objects, then add every blank cell in the table to the NewEditRange, then make a new AllowEditRange containing NewEditRange, then protect the sheet.\nInstead it makes an AllowEditRange with the cells through row 14 or so, and I can still edit cells that are not in that range.</p>\n"}, {"tags": ["vba", "ms-access", "windows-server-2019"], "comments": [{"owner": {"reputation": 15, "user_id": 10811077, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-sBVaKlxEbUY/AAAAAAAAAAI/AAAAAAAANtk/RaQb8IsM2z8/photo.jpg?sz=128", "display_name": "Bj&#246;rn Brorsson", "link": "https://stackoverflow.com/users/10811077/bj%c3%b6rn-brorsson"}, "edited": false, "score": 0, "creation_date": 1568233749, "post_id": 57896341, "comment_id": 102213928, "body": "At this point, I&#39;m not sure if there is something wrong with my VBA scripts, file ownership (the user trying to run the file has full rights to the entire catalog that it runs in) or the office setup. What frustrates me is that I can run it perfectly from my own PC, but I can&#39;t have that running stuff in the middle of the night for 6 hours straight. The server is running anyway and is used for this kind of thing and common file areas and that&#39;s it."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1568234990, "post_id": 57896341, "comment_id": 102214341, "body": "FWIW running any Office application headless isn&#39;t a supported or recommended scenario. Any random <code>MsgBox</code>, application alert, or run-time error could silently halt execution, and no one would know until it&#39;s too late. Consider setting up and migrating the Access back-end (it&#39;s got a back-end, right?) to an actual database server (e.g. SQL Server Express, free) with SQL Agent jobs instead."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1568235175, "post_id": 57896341, "comment_id": 102214407, "body": "What login is the scheduled task running under? Does that login have access to all the network locations it needs to do its thing?"}, {"owner": {"reputation": 15, "user_id": 10811077, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-sBVaKlxEbUY/AAAAAAAAAAI/AAAAAAAANtk/RaQb8IsM2z8/photo.jpg?sz=128", "display_name": "Bj&#246;rn Brorsson", "link": "https://stackoverflow.com/users/10811077/bj%c3%b6rn-brorsson"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1568235543, "post_id": 57896341, "comment_id": 102214550, "body": "Unfortunately, there is no access back end. This is built by someone who left the company 5+ years ago and is so deeply integrated in the daily workings of half the company that it&#39;s scary. They do fetch some data from the Oracle database we have that runs the main web application, others from a csv that gets put on the file server, some from other access files that is run manually weekly (also automated but can&#39;t run), but this is for the behind the scenes workings of managing the data we get before importing it into the Oracle database, and generating some statistics. It&#39;s a clusterfuck..."}, {"owner": {"reputation": 15, "user_id": 10811077, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-sBVaKlxEbUY/AAAAAAAAAAI/AAAAAAAANtk/RaQb8IsM2z8/photo.jpg?sz=128", "display_name": "Bj&#246;rn Brorsson", "link": "https://stackoverflow.com/users/10811077/bj%c3%b6rn-brorsson"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1568235635, "post_id": 57896341, "comment_id": 102214585, "body": "It&#39;s running off a service account that has full access to the whole disk that it&#39;s running things on. But I get the same (lack of) errors when running it from my AD admin account login, just by opening the access file."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1568236291, "post_id": 57896341, "comment_id": 102214780, "body": "That isn&#39;t much to go on... try implementing some logging?"}, {"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 3, "creation_date": 1568236785, "post_id": 57896341, "comment_id": 102214931, "body": "As mentioned, headless automation of any Office application simply isn&#39;t a supported scenario. I think that it would be more productive to migrate them to a platform that supports the headless automation. As a short term solution, you could consider using a commercial product such as FMS&#39; Total Agent or a third party task scheduler. I&#39;ve found that Windows Task Scheduler finds plenty to be desired and isn&#39;t very reliable. We&#39;ve used <a href=\"https://www.splinterware.com/products/scheduler.html\" rel=\"nofollow noreferrer\">this product</a> for different applications and it works much better than Windows&#39; scheduler."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 2, "creation_date": 1568236797, "post_id": 57896341, "comment_id": 102214936, "body": "We obviously need to know what the database actually does (forms, queries, reports, modules, etc.) and see some code. Check if you have read/write permission to location on server which Access needs if it creates folders, exports files, etc. Possibly error handling suppresses errors, <code>On Resume Next</code> or <code>Goto</code>. You need to carefully test the local version and remote version for every step of process. As of now, this question is too broad."}, {"owner": {"reputation": 15, "user_id": 10811077, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-sBVaKlxEbUY/AAAAAAAAAAI/AAAAAAAANtk/RaQb8IsM2z8/photo.jpg?sz=128", "display_name": "Bj&#246;rn Brorsson", "link": "https://stackoverflow.com/users/10811077/bj%c3%b6rn-brorsson"}, "edited": false, "score": 0, "creation_date": 1568237428, "post_id": 57896341, "comment_id": 102215127, "body": "The behavior is the same for all 3 automated access files. The first uses data from a file that gets generated from the web application daily (csv) as well as ODBC connected tables from our Oracle database. It essentially creates a few tables in the access file with data from those tables and files. This was done by a button press on a form, but I&#39;ve changed it to trigger on file enter. Upon finishing up, it compacts the file and closes access."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "reply_to_user": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 0, "creation_date": 1568237631, "post_id": 57896341, "comment_id": 102215181, "body": "@this, just migrate, left handed ;) If code is not too crappy, it can work reliable (of course not recommebed). All errors need to be trapped and instead of Msgboxes log to a file or a table. I have a sync to Google Cal running every 5 mins (form timer) and can rely on that (most times). @ Bj&#246;rn: any infos in win event logs (especially Office Alerts)? Runtime or full Office on server? Same bitness? Check references."}, {"owner": {"reputation": 15, "user_id": 10811077, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-sBVaKlxEbUY/AAAAAAAAAAI/AAAAAAAANtk/RaQb8IsM2z8/photo.jpg?sz=128", "display_name": "Bj&#246;rn Brorsson", "link": "https://stackoverflow.com/users/10811077/bj%c3%b6rn-brorsson"}, "reply_to_user": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1568237841, "post_id": 57896341, "comment_id": 102215232, "body": "@computerVersteher no, the event log just states access opened. There is nothing to indicate that it even tried to open the files I tell it to. The office on the server is full office, 64-bit, just like on my PC."}, {"owner": {"reputation": 15, "user_id": 10811077, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-sBVaKlxEbUY/AAAAAAAAAAI/AAAAAAAANtk/RaQb8IsM2z8/photo.jpg?sz=128", "display_name": "Bj&#246;rn Brorsson", "link": "https://stackoverflow.com/users/10811077/bj%c3%b6rn-brorsson"}, "edited": false, "score": 0, "creation_date": 1568237864, "post_id": 57896341, "comment_id": 102215238, "body": "Following on my previous reply; The second one fetches the data from the first one and some additional data from the ODBC Oracle DB and is then used as the database for another access file. A third one uses another csv and some ODBC Oracle DB tables to generate 5 Excel files with statistics."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1568238189, "post_id": 57896341, "comment_id": 102215330, "body": "&quot;the event log just states access opened&quot; - implement some trace logging in the VBA code to write to the event log and see what&#39;s stalling, or at least what the last successful operation was."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1568238255, "post_id": 57896341, "comment_id": 102215346, "body": "You know<code>Applications and Services Logs &gt; Microsoft &gt; Microsoft Office Alerts</code>?DB complies? ODBC with DSN? Running DB in normal window mode doesn&#39;t show errors?"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1568239027, "post_id": 57896341, "comment_id": 102215512, "body": "You tried your personal frontend on server (copy there) as compacting on xlose may corrupt db. Any non temptaty data dtoref im zhaz dbs? if not omit compact on close, just have a share with script, that copies a fresh db to exec path and starts it. That can also be used to have the actual version, afrer an update. What about patch status on server? Any updates installed since it went worse? Any Mapped drives missing on server?"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "reply_to_user": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 0, "creation_date": 1568307010, "post_id": 57896341, "comment_id": 102242019, "body": "@this now we can focus on a better solution. Any suggestions what to use. I first thouhjt on VBSxrpt, but it seems to <a href=\"https://docs.microsoft.com/en-us/previous-versions//30593abb(v=vs.85)?redirectedfrom=MSDN\" rel=\"nofollow noreferrer\">lack some essentials like error handling</a>. At the monent I think of a<code>Powershell-Script or</code>should we better create a<code>C#-Service</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1568306453, "post_id": 57909062, "comment_id": 102241804, "body": "Servers and updates have a special relationship. Can you post what updates where missing? DB creates csv mainly? What size, as the execution time seems ridiculously long. Done by sql or vba?"}, {"owner": {"reputation": 15, "user_id": 10811077, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-sBVaKlxEbUY/AAAAAAAAAAI/AAAAAAAANtk/RaQb8IsM2z8/photo.jpg?sz=128", "display_name": "Bj&#246;rn Brorsson", "link": "https://stackoverflow.com/users/10811077/bj%c3%b6rn-brorsson"}, "reply_to_user": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1568666150, "post_id": 57909062, "comment_id": 102339172, "body": "Unfortunately, no. I&#39;m not the admin for the server."}, {"owner": {"reputation": 15, "user_id": 10811077, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-sBVaKlxEbUY/AAAAAAAAAAI/AAAAAAAANtk/RaQb8IsM2z8/photo.jpg?sz=128", "display_name": "Bj&#246;rn Brorsson", "link": "https://stackoverflow.com/users/10811077/bj%c3%b6rn-brorsson"}, "reply_to_user": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1568666252, "post_id": 57909062, "comment_id": 102339215, "body": "The DB has to calculate stats of about 2 million products, then exporting those stats in a few different ways to one CSV and four Excel-docs. Done by VBA running sql scripts, mainly. Not even sure why we do it in Access to begin with... :p"}], "tags": [], "owner": {"reputation": 15, "user_id": 10811077, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-sBVaKlxEbUY/AAAAAAAAAAI/AAAAAAAANtk/RaQb8IsM2z8/photo.jpg?sz=128", "display_name": "Bj&#246;rn Brorsson", "link": "https://stackoverflow.com/users/10811077/bj%c3%b6rn-brorsson"}, "is_accepted": true, "score": 0, "last_activity_date": 1568298946, "creation_date": 1568298946, "answer_id": 57909062, "question_id": 57896341, "link": "https://stackoverflow.com/questions/57896341/cant-open-access-database-file-on-our-windows-server-but-locally-is-no-problem/57909062#57909062", "title": "Can&#39;t open Access database file on our Windows Server, but locally is no problem", "body": "<p>In a strange tun of events, it appears to be working now. Found that Office hadn't installed all updates. Did that and it began to work....</p>\n"}], "owner": {"reputation": 15, "user_id": 10811077, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-sBVaKlxEbUY/AAAAAAAAAAI/AAAAAAAANtk/RaQb8IsM2z8/photo.jpg?sz=128", "display_name": "Bj&#246;rn Brorsson", "link": "https://stackoverflow.com/users/10811077/bj%c3%b6rn-brorsson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 231, "favorite_count": 0, "closed_date": 1600199493, "accepted_answer_id": 57909062, "answer_count": 1, "score": 0, "last_activity_date": 1568298946, "creation_date": 1568233538, "last_edit_date": 1568234201, "question_id": 57896341, "link": "https://stackoverflow.com/questions/57896341/cant-open-access-database-file-on-our-windows-server-but-locally-is-no-problem", "closed_reason": "Not suitable for this site", "title": "Can&#39;t open Access database file on our Windows Server, but locally is no problem", "body": "<p>I've automated some old access files at work. (What previously was clicking a button in a form, waiting an hour, repeat 4 times, is now running it all one go on open, then closing and compacting the database).</p>\n\n<p>The files are stored on a shared drive that is locally on the server that we try to run them on.</p>\n\n<p>I can run the files on my PC, both while on the network and through VPN. I cannot, however, run them on the server. When i open them, access starts up and shows the getting started-view and nothing happens.</p>\n\n<p>When running them through a scheduled task, as intended (they take a few hours, so the idea is to run them during the night on the server), I just end up with a locked access file and a process with no GUI for access that further hinders removal of the lock file. After a weekend, I have 9 processes and all the files have locks and nothing is run.</p>\n\n<p>The weird part is that I get no error messages. Furthermore, just a few weeks ago, when I was building them, I could run them, but they'd only perform half of the VBA scripts (it's exporting a couple of CSVs for example, and they didn't generate new ones, when run on the server, but keep working fine from my PC). Then, after a week off from work, the above stated behavior began instead.</p>\n\n<p>At this point, I've probably spent a whole work week troubleshooting this and gotten nowhere. Any help is appreciated. Haven't found anything from google searches that matches this behavior...</p>\n"}, {"tags": ["excel", "vba", "vlookup"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1568234252, "post_id": 57896329, "comment_id": 102214069, "body": "The macro that opens the file can easily get the filename, then insert VLOOKUPs using said filename as required."}, {"owner": {"reputation": 1, "user_id": 11411132, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-__B6prRb9jw/AAAAAAAAAAI/AAAAAAAAI_k/D15xD0aX6DE/photo.jpg?sz=128", "display_name": "J I", "link": "https://stackoverflow.com/users/11411132/j-i"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1568234424, "post_id": 57896329, "comment_id": 102214122, "body": "Which was a thought that I had, but I had no success inputting it into the vlookup formula."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 2, "creation_date": 1568234474, "post_id": 57896329, "comment_id": 102214147, "body": "Then please edit your question to include the code you have so we can see where the problem is"}], "answers": [{"tags": [], "owner": {"reputation": 302, "user_id": 11958215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9htzU.jpg?s=128&g=1", "display_name": "Breno Teodoro", "link": "https://stackoverflow.com/users/11958215/breno-teodoro"}, "is_accepted": false, "score": 0, "last_activity_date": 1568238127, "creation_date": 1568238127, "answer_id": 57897165, "question_id": 57896329, "link": "https://stackoverflow.com/questions/57896329/vba-formula-that-automatically-changes-the-date-for-a-filename-when-using-a-vloo/57897165#57897165", "title": "VBA formula that automatically changes the date for a filename when using a vlookup", "body": "<p>I found <a href=\"https://stackoverflow.com/questions/31414106/get-list-of-excel-files-in-a-folder-using-vba\">here</a> a code done by Coder375 that returns an array of available names in a given folder. It goes like this:</p>\n\n<pre><code>Function listfiles(ByVal sPath As String)\n\n    Dim vaArray     As Variant\n    Dim i           As Integer\n    Dim oFile       As Object\n    Dim oFSO        As Object\n    Dim oFolder     As Object\n    Dim oFiles      As Object\n\n    Set oFSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set oFolder = oFSO.GetFolder(sPath)\n    Set oFiles = oFolder.Files\n\n    If oFiles.Count = 0 Then Exit Function\n\n    ReDim vaArray(1 To oFiles.Count)\n    i = 1\n    For Each oFile In oFiles\n        vaArray(i) = oFile.Name\n        i = i + 1\n    Next\n\n    listfiles = vaArray\n\nEnd Function\n</code></pre>\n\n<p>With that, it's fairly simple to achieve what you need. Just iterate through each entry in the array, and evaluate the name, according to the structure you've brought up. I came up with the below:</p>\n\n<ul>\n<li><p>Function to determine the last date from array:</p>\n\n<pre><code>Function LastEntry(ByVal myArray As Variant)\nDim element As Variant\nDim reference, timeReference As String\nDim myDate, mostRecentDate, myTime, mostRecentTime As Date\n\nFor Each element In myArray\n    reference = CStr(element)\n\n    myDate = CDate(Mid(reference, 11, 10))\n\n    If mostRecentDate Is Null Then mostRecentDate = myDate\n    Else\n        If DateDiff(\"d\", mostRecentDate, myDate) &lt; 0 Then\n            mostRecentDate = myDate\n\n            timeReference = ConvertTime(Mid(reference, 22, 4))\n            myTime = CDate(timeReference)\n            If mostRecentTime Is Null Then mostRecentTime = myTime\n            Else\n                If DateDiff(\"h\", mostRecentTime, myTime) &lt; 0 Then\n                    mostRecentTime = myTime\n                End If\n            End If\n        End If\n    End If\nNext element\nLastEntry = CStr(mostRecentDate) &amp; \" \" &amp; CStr(mostRecentTime)\nEnd Function\n</code></pre></li>\n<li><p>Function to return the corrected string from time value found on name:</p>\n\n<pre><code>Function ConvertTime(ByVal myString As String)\n\nDim hour, amPm, concatenated As String\n\nhour = Left(myString, 2)\n\nSelect Case hour\n    Case \"00\", \"01\", \"02\", \"03\", \"04\", \"05\", \"06\", \"07\", \"08\", \"09\", \"10\", \"11\", \"24\"\n        amPm = \"AM\"\n        concatenated = hour\n    Case \"12\"\n        amPm = \"PM\"\n        concatenated = hour\n    Case \"13\"\n        amPm = \"PM\"\n        concatenated = \"01\"\n    Case \"14\"\n        amPm = \"PM\"\n        concatenated = \"02\"\n    Case \"15\"\n        amPm = \"PM\"\n        concatenated = \"03\"\n    Case \"16\"\n        amPm = \"PM\"\n        concatenated = \"04\"\n    Case \"17\"\n        amPm = \"PM\"\n        concatenated = \"05\"\n    Case \"18\"\n        amPm = \"PM\"\n        concatenated = \"06\"\n    Case \"19\"\n        amPm = \"PM\"\n        concatenated = \"07\"\n    Case \"20\"\n        amPm = \"PM\"\n        concatenated = \"08\"\n    Case \"21\"\n        amPm = \"PM\"\n        concatenated = \"09\"\n    Case \"22\"\n        amPm = \"PM\"\n        concatenated = \"10\"\n    Case \"23\"\n        amPm = \"PM\"\n        concatenated = \"11\"\nEnd Select\nconcatenated = concatenated &amp; \":\" &amp; Right(myString, 2) &amp; \" \" &amp; amPm\nConvertTime = concatenated\nEnd Function\n</code></pre></li>\n</ul>\n\n<p>I think this can help you address the issue you have. I couldn't find time to test my second snippet, but I reckon it will work as an acceptable reference for you to build your solution.</p>\n"}], "owner": {"reputation": 1, "user_id": 11411132, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-__B6prRb9jw/AAAAAAAAAAI/AAAAAAAAI_k/D15xD0aX6DE/photo.jpg?sz=128", "display_name": "J I", "link": "https://stackoverflow.com/users/11411132/j-i"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1568238127, "creation_date": 1568233463, "question_id": 57896329, "link": "https://stackoverflow.com/questions/57896329/vba-formula-that-automatically-changes-the-date-for-a-filename-when-using-a-vloo", "title": "VBA formula that automatically changes the date for a filename when using a vlookup", "body": "<p>A new workbook is created each day (sometimes multiple times a day) with a name for example, \"Inventory 09-01-2019 0330.xlsm. The date and time (0330 for 3:30) changes every time the file is created. I have found VBA to open the most recently created file (<a href=\"http://www.xl-central.com/open-the-latest-file-in-a-folder.html\" rel=\"nofollow noreferrer\">http://www.xl-central.com/open-the-latest-file-in-a-folder.html</a>) but I am having a hard time finding any code that will do that same type of search for the most recent name in a VBA vlookup. \nThere is a good suggestion her for how to use indirect in a normal vlookup (<a href=\"https://stackoverflow.com/questions/52339282/excel-formula-that-automatically-changes-the-date-for-a-filename-when-using-a-vl\">Excel formula that automatically changes the date for a filename when using a vlookup</a>) however I just do not have the knowledge or ability to get this into VBA. Still learning VBA at the moment and this is just too complicated to me. </p>\n\n<p>I want to be able to run the macro, have it open the most recent file in a folder, then activate the vlookup that finds that opened/named file, to pull in data from the same sheet/column into the new workbook being created. Example: New workbook sheet \"Agents\" contains a blank column for \"Comments\". I want to vlookup the \"Comments\" from the \"Agents\" sheet, in the most recently created workbook in the folder.\nI would include examples of what I have tried so far but I fear they are so far off, its just not worth it. \nThank you.</p>\n"}, {"tags": ["excel", "vba", "outlook", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 12054982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d50119cf7cb3cc3320a3ae99611f821?s=128&d=identicon&r=PG&f=1", "display_name": "Skynet", "link": "https://stackoverflow.com/users/12054982/skynet"}, "edited": false, "score": 0, "creation_date": 1568260932, "post_id": 57897771, "comment_id": 102219783, "body": "Thanks for helping Tim.  Your method is working great, is there any way to modify your code to keep the signature at the bottom of the outlook message?  That was an added issue I was experiencing with mine as well as your code."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 15, "user_id": 12054982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d50119cf7cb3cc3320a3ae99611f821?s=128&d=identicon&r=PG&f=1", "display_name": "Skynet", "link": "https://stackoverflow.com/users/12054982/skynet"}, "edited": false, "score": 0, "creation_date": 1568262337, "post_id": 57897771, "comment_id": 102220106, "body": "I&#39;m sure that&#39;s possible but I don&#39;t have outlook here to test with."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 15, "user_id": 12054982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d50119cf7cb3cc3320a3ae99611f821?s=128&d=identicon&r=PG&f=1", "display_name": "Skynet", "link": "https://stackoverflow.com/users/12054982/skynet"}, "edited": false, "score": 0, "creation_date": 1568629508, "post_id": 57897771, "comment_id": 102321728, "body": "@Skynet Look at and test the <code>Selection.MoveUp</code>, and <code>Selection.MoveEnd</code> methods of the Word object model. One or both of those should help you change where the content is being pasted."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1568242705, "creation_date": 1568242705, "answer_id": 57897771, "question_id": 57896028, "link": "https://stackoverflow.com/questions/57896028/how-to-paste-multiple-table-ranges-into-outlook-body-using-word-editor-as-image/57897771#57897771", "title": "How to paste multiple table ranges into Outlook body using Word Editor (As Images)", "body": "<p>This works for me:</p>\n\n<pre><code>Sub SendEmail()\n\n    Dim olApp As Outlook.Application\n    Dim olEmail As Outlook.MailItem\n    Dim olInsp As Outlook.Inspector\n    Dim wdDoc As Word.Document\n    Dim strGreeting As String\n\n    strGreeting = \"Dear Someone,\" &amp; vbNewLine\n\n    Set olApp = New Outlook.Application\n    Set olEmail = olApp.CreateItem(olMailItem)\n\n    With olEmail\n        .BodyFormat = olFormatRichText\n        .display\n\n        .To = \"Someone@tester.com\"\n        .Subject = \"Report\"\n\n        Set olInsp = .GetInspector\n        Set wdDoc = olInsp.WordEditor\n\n        wdDoc.Range.InsertBefore strGreeting\n\n        wdDoc.Range.InsertAfter vbCrLf\n\n        Range(\"A1:D10\").Copy\n        PasteAtEnd wdDoc\n\n        wdDoc.Range.InsertAfter vbCrLf &amp; vbCrLf\n\n        Range(\"A12:D20\").Copy\n        PasteAtEnd wdDoc\n\n    End With\n\nEnd Sub\n\n'paste from clipboard to the end of the document\nSub PasteAtEnd(doc As Word.Document)\n    With doc\n        .Content.Select\n        .Application.Selection.Collapse (wdCollapseEnd)\n        .Application.Selection.PasteAndFormat wdChartPicture\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 12054982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d50119cf7cb3cc3320a3ae99611f821?s=128&d=identicon&r=PG&f=1", "display_name": "Skynet", "link": "https://stackoverflow.com/users/12054982/skynet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 805, "favorite_count": 0, "accepted_answer_id": 57897771, "answer_count": 1, "score": 0, "last_activity_date": 1568634979, "creation_date": 1568232030, "last_edit_date": 1568634979, "question_id": 57896028, "link": "https://stackoverflow.com/questions/57896028/how-to-paste-multiple-table-ranges-into-outlook-body-using-word-editor-as-image", "title": "How to paste multiple table ranges into Outlook body using Word Editor (As Images)", "body": "<p>I can paste one excel range into outlook (as an image) with no issue but when it comes to pasting multiple ranges into the body of outlook (on separate lines) I run into formatting issues.</p>\n\n<p>I am trying to paste one range, insert a \"line break\", then paste another range, and so-on.  I've tried various methods of separating the images but nothing is working.  The images paste successfully but only on one line, which makes everything out of alignment.</p>\n\n<pre><code>Sub SendEmail()\n\n    Dim olApp As Outlook.Application\n    Dim olEmail As Outlook.MailItem\n    Dim olInsp As Outlook.Inspector\n    Dim wdDoc As Word.document\n    Dim strGreeting As String\n\n    strGreeting = \"Dear Someone,\" &amp; vbNewLine\n\n    Set olApp = New Outlook.Application\n    Set olEmail = olApp.CreateItem(olMailItem)\n\n    With olEmail\n        .BodyFormat = olFormatRichText\n        .display\n\n        .To = \"Someone@tester.com\"\n        .Subject = \"Report\"\n\n        Set olInsp = .GetInspector\n        Set wdDoc = olInsp.WordEditor\n\n        wdDoc.Range.InsertBefore strGreeting\n\n\n        ' This is where I am having problems:\n        ' The tables are pasting into the document out of order (not a huge problem) but...\n        ' the images paste on ONE single line, I need the images to paste on a new line so they\n        ' format vertically along the body of the email.\n\n        'Range #1 one to copy/paste into outlook body\n        Range(\"W2:AB40\").Copy\n        wdDoc.Range(Len(strGreeting) &amp; vbCrLf, Len(strGreeting)).PasteAndFormat wdChartPicture\n        wdDoc.Range.InsertAfter vbCrLf\n\n        'Range #2 one to copy/paste into outlook body\n        Range(\"E2:I26\").Copy\n        wdDoc.Range(Len(strGreeting) &amp; vbCrLf, Len(strGreeting)).PasteAndFormat wdChartPicture\n        wdDoc.Range.InsertAfter vbCrLf\n\n        'Range #3 one to copy/paste into outlook body\n        Range(\"N38:V50\").Copy\n        wdDoc.Range(Len(strGreeting) &amp; vbCrLf, Len(strGreeting)).PasteAndFormat wdChartPicture\n        wdDoc.Range.InsertAfter vbCrLf\n\n        'Range #4 one to copy/paste into outlook body\n        If shtWash.Range(\"SHIFT_GROUP\") = \"DAYS\" Then\n            Range(\"N2:V18\").Copy\n        Else\n            Range(\"N2:V36\").Copy\n        End If\n        wdDoc.Range(Len(strGreeting) &amp; vbCrLf, Len(strGreeting)).PasteAndFormat wdChartPicture\n        wdDoc.Range.InsertAfter vbCrLf\n\n        'Range #5 one to copy/paste into outlook body\n        Range(\"E28:I34\").Copy\n        wdDoc.Range(Len(strGreeting) &amp; vbCrLf, Len(strGreeting)).PasteAndFormat wdChartPicture\n        wdDoc.Range.InsertAfter vbCrLf\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1568289245, "post_id": 57895991, "comment_id": 102232161, "body": "This is unclear. How do you define a match and what does it mean to sum them? Summing numbers makes sense but you explicitly talk about <i>text</i> or numbers. How is text to be summed?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 12054997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac16dc3d29b03993d48b771fd8b9d156?s=128&d=identicon&r=PG&f=1", "display_name": "HajHN", "link": "https://stackoverflow.com/users/12054997/hajhn"}, "is_accepted": false, "score": 0, "last_activity_date": 1568374564, "creation_date": 1568374564, "answer_id": 57922929, "question_id": 57895991, "link": "https://stackoverflow.com/questions/57895991/how-to-compare-columns-that-have-variable-text-in-excel-across-all-variables-num/57922929#57922929", "title": "How to compare columns that have variable text in Excel across all variables number of sheets then sum the matchs?", "body": "<p>If the text overall the workbook is matched will count how many have matched and then sum them up. \nI can use two-cells (if match =1 ) them sum the ones which will give me the total. </p>\n"}], "owner": {"reputation": 1, "user_id": 12054997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac16dc3d29b03993d48b771fd8b9d156?s=128&d=identicon&r=PG&f=1", "display_name": "HajHN", "link": "https://stackoverflow.com/users/12054997/hajhn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568374564, "creation_date": 1568231794, "last_edit_date": 1568301762, "question_id": 57895991, "link": "https://stackoverflow.com/questions/57895991/how-to-compare-columns-that-have-variable-text-in-excel-across-all-variables-num", "title": "How to compare columns that have variable text in Excel across all variables number of sheets then sum the matchs?", "body": "<p>I have created VBA code which can run across all the sheets in a workbook, and it doesn't matter how many sheets there are. The code will run correctly whether there is 3 sheets or 100 sheets. What I'm trying to work out is how to compare columns that have variable text and numbers across all sheets (regardless of how many sheets there are), and then sum the matched ones?</p>\n\n<pre><code>Dim x As Long\n\nSheets.Select\n' Then code which will go across all sheets \n\n'' Or the following code which will go across all sheets except the main master sheet \n\n    For x = 1 To ThisWorkbook.Sheets.Count\n        If Sheets(x).Name &lt;&gt; \"Main Master Sheet\" Then Sheets(x).Select Replace:=False\n    Next x\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 1, "creation_date": 1568233100, "post_id": 57895943, "comment_id": 102213718, "body": "how do you want to store cells address ?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1568247434, "post_id": 57895943, "comment_id": 102217282, "body": "Is your code too slow?  Have you tried suspending screenupdating and calculation while you run the loop?"}, {"owner": {"reputation": 335, "user_id": 285673, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5d95afb9ef54c12547b631a7267e0d84?s=128&d=identicon&r=PG", "display_name": "JK0124", "link": "https://stackoverflow.com/users/285673/jk0124"}, "edited": false, "score": 0, "creation_date": 1568256834, "post_id": 57895943, "comment_id": 102219005, "body": "I will update it to suspend screen updating!"}, {"owner": {"reputation": 335, "user_id": 285673, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5d95afb9ef54c12547b631a7267e0d84?s=128&d=identicon&r=PG", "display_name": "JK0124", "link": "https://stackoverflow.com/users/285673/jk0124"}, "edited": false, "score": 0, "creation_date": 1568256891, "post_id": 57895943, "comment_id": 102219012, "body": "I&#39;m open to storing the cell address in whatever way helps."}], "answers": [{"comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1568247185, "post_id": 57896687, "comment_id": 102217233, "body": "<code>Application.Match</code> does not raise an error of no match is found - that only happens if you use <code>Application.WorksheetFunction.Match</code>."}, {"owner": {"reputation": 335, "user_id": 285673, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5d95afb9ef54c12547b631a7267e0d84?s=128&d=identicon&r=PG", "display_name": "JK0124", "link": "https://stackoverflow.com/users/285673/jk0124"}, "edited": false, "score": 0, "creation_date": 1568262034, "post_id": 57896687, "comment_id": 102220028, "body": "Even when I try to use: Cells(r, 7).Value = &quot;Yes. Row &quot; &amp; rng.Cells.Row  The value keeps returning 1.  Is this because of the Application.math formula I&#39;m using?"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 335, "user_id": 285673, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5d95afb9ef54c12547b631a7267e0d84?s=128&d=identicon&r=PG", "display_name": "JK0124", "link": "https://stackoverflow.com/users/285673/jk0124"}, "edited": false, "score": 1, "creation_date": 1568291845, "post_id": 57896687, "comment_id": 102233653, "body": "@JK0124 In your case, <code>rng</code> refers to the entire range that you are looking up. The <code>Application.Match</code> function returns the row number of the match. For that reason, I recommended storing the result of <code>Application.Match</code> into a variable that you can use after the fact. In my code above, I stored that number in <code>rowMatch</code>. So you can call `Cells(r, 7).value = &quot;Yes. Row &quot; &amp; rowMatch."}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1568292111, "post_id": 57896687, "comment_id": 102233805, "body": "@TimWilliams The example I posted throws an error when attempting to store the result of the <code>Application.Match</code> into a variable dimensioned as a long, and this can throw an error. Per his post, he wants to store the row number corresponding to the match. To do so, he should store the result of the function in a variable, at which point he can use it as both the predicate in his conditional as well the row number where needed. Is there a better or more efficient way to manage this?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1568300101, "post_id": 57896687, "comment_id": 102238647, "body": "sorry I totally mis-read the question...  Was assuming OP just wanted the code to run more quickly."}, {"owner": {"reputation": 335, "user_id": 285673, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5d95afb9ef54c12547b631a7267e0d84?s=128&d=identicon&r=PG", "display_name": "JK0124", "link": "https://stackoverflow.com/users/285673/jk0124"}, "edited": false, "score": 0, "creation_date": 1568302229, "post_id": 57896687, "comment_id": 102239851, "body": "You&#39;re right, I was able to get it using:   rowMatch = Application.Match(Cells(r, 1).Value, rng, 0) Cells(r, 7).Value = &quot;Yes - Row &quot; &amp; rowMatch  Thank you!!!"}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": true, "score": 0, "last_activity_date": 1568235305, "creation_date": 1568235305, "answer_id": 57896687, "question_id": 57895943, "link": "https://stackoverflow.com/questions/57895943/get-row-for-matching-value/57896687#57896687", "title": "Get Row for Matching Value", "body": "<p>The call to <code>Application.Match(...)</code> returns the row number. It can also return an error, so we have to store it to a variable (with error checking), and then use it as needed.</p>\n\n<pre><code>Dim rowMatch as Long\n...\n...\nOn Error Resume Next\nrowMatch = Application.Match(Cells(r, 1).Value, rng, 0)\n\nIf err.Number &lt;&gt; 0 then\n    rowMatch = 0\n    Err.Clear\nEnd if \n\n'Use rowMatch as needed\n</code></pre>\n"}], "owner": {"reputation": 335, "user_id": 285673, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5d95afb9ef54c12547b631a7267e0d84?s=128&d=identicon&r=PG", "display_name": "JK0124", "link": "https://stackoverflow.com/users/285673/jk0124"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 57896687, "answer_count": 1, "score": -1, "last_activity_date": 1568235305, "creation_date": 1568231539, "last_edit_date": 1568232967, "question_id": 57895943, "link": "https://stackoverflow.com/questions/57895943/get-row-for-matching-value", "title": "Get Row for Matching Value", "body": "<p>I have a VBA code which is running to get the matching values from one worksheet (WorksheetA) to another worksheet (WorksheetB).  I would like to identify which cell the matching value was found in.  Is there a efficient way to get this information since the code will be traversing through ~10k rows?</p>\n\n<p>The current working code is below: </p>\n\n<pre><code>Sub ChkRcd()\n\n    Dim r, lastRow, colCaseID As Long\n    Dim rng As Range\n    Dim strColName As String\n    Dim caseIDCol As String 'Case ID Col Name In WorksheetB\n    r = 2\n\n    Sheets(\"WorksheetA\").Select\n    lastRow = getLastRow\n\n    colCaseID = FindColHeaderWText(\"WorksheetB\", \"ExternalDataReference\")\n    strColName = Col_Letter(colCaseID)\n    Set rng = Worksheets(\"WorksheetB\").Columns(colCaseID)\n\n    Sheets(\"WorksheetA\").Select\n    Range(\"G2\").Select\n\n    For r = 2 To lastRow\n        If Not IsError(Application.Match(Cells(r, 1).Value, rng, 0)) Then\n        'Do stuff when the match is found\n            Cells(r, 7).Value = \"Yes - Row \" 'Show Row Number here\n        Else:\n            Cells(r, 7).Value = \"No\"\n            'Highlights the rows with no match\n            Rows(r &amp; \":\" &amp; r).Select\n            With Selection.Interior\n                .Pattern = xlSolid\n                .PatternColorIndex = xlAutomatic\n                .ThemeColor = xlThemeColorAccent4\n                .TintAndShade = 0.599993896298105\n                .PatternTintAndShade = 0\n            End With\n        End If\n    Next r\n\n    Range(\"A1\").Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1568230298, "post_id": 57895601, "comment_id": 102212722, "body": "See if adding <code>DoEvents</code> before the <code>Loop</code> token makes PPT more responsive."}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 3, "creation_date": 1568230355, "post_id": 57895601, "comment_id": 102212751, "body": "The problem with the code is that it introduces an infinite loop. The <code>Do While ... </code> condition will always be true if there is a parenthesis, whether or not there is a space after it. So, even when you replace &quot;(&quot; with &quot;( &quot;, the function call to <code>InStr(shpText.Text, &quot;(&quot;) &gt; 0</code> will return true."}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 11710036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdac7783cf18ba2a36d275c4147ef846?s=128&d=identicon&r=PG&f=1", "display_name": "Curiosity_Bug", "link": "https://stackoverflow.com/users/11710036/curiosity-bug"}, "edited": false, "score": 0, "creation_date": 1568294607, "post_id": 57896256, "comment_id": 102235256, "body": "Thank you. I am not familiar with the regular expression yet and I need to study on &quot;VBScript_RegExp_55.RegExp&quot; used. What does &quot;$1 $2&quot; mean? This will be helpful in future."}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": false, "score": 0, "last_activity_date": 1568233120, "creation_date": 1568233120, "answer_id": 57896256, "question_id": 57895601, "link": "https://stackoverflow.com/questions/57895601/removing-and-adding-spaces-before-and-after-the-parenthesis-special-character-by/57896256#57896256", "title": "Removing and adding spaces before and after the parenthesis special character by using VBA", "body": "<p>I posted a comment under your main post detailing <em>why</em> your code didn't work. The below code uses a regular expression to replace all opening parenthesis without a trailing space to an opening parenthesis with a trailing space. </p>\n\n<p>Write back if you need additional help.</p>\n\n<pre><code>Function FindAndReplace(testString As String, oSource As TextRange)\n    Dim oReg As VBScript_RegExp_55.RegExp\n\n    'Set oSource = ActivePresentation.Slides(1).Shapes(2).TextFrame.TextRange\n\n    Set oReg = New VBScript_RegExp_55.RegExp\n\n    With oReg\n        .Global = True\n        .Multiline = False\n        .IgnoreCase = True\n        .Pattern = \"(\\()([^\\s]+?)\"  'Checks for an opening parenthesis with no following space\n    End With\n\n    If oReg.Test(testString) Then\n        oSource.Text = oReg.Replace(testString, \"$1 $2\")\n    End If\nEnd Function\n\nSub ReplaceSpaces()\n    Dim sld As Slide\n    Dim shp As Shape\n    Dim shpText As TextRange\n\n\n    For Each sld In ActivePresentation.Slides\n        For Each shp In sld.Shapes\n            If shp.HasTextFrame Then\n                Set shpText = shp.TextFrame.TextRange\n\n                FindAndReplace shpText.Text, shpText\n\n            End If\n       Next shp\n     Next sld\n End Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 69, "user_id": 11710036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdac7783cf18ba2a36d275c4147ef846?s=128&d=identicon&r=PG&f=1", "display_name": "Curiosity_Bug", "link": "https://stackoverflow.com/users/11710036/curiosity-bug"}, "edited": false, "score": 0, "creation_date": 1568294331, "post_id": 57902937, "comment_id": 102235101, "body": "Now I will customize this to include different punctuation rules. Thank you."}], "tags": [], "owner": {"reputation": 18, "user_id": 6022590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8502e0f816f23c8f20d6bcd4d122261?s=128&d=identicon&r=PG&f=1", "display_name": "roka", "link": "https://stackoverflow.com/users/6022590/roka"}, "is_accepted": true, "score": 0, "last_activity_date": 1568277710, "creation_date": 1568277710, "answer_id": 57902937, "question_id": 57895601, "link": "https://stackoverflow.com/questions/57895601/removing-and-adding-spaces-before-and-after-the-parenthesis-special-character-by/57902937#57902937", "title": "Removing and adding spaces before and after the parenthesis special character by using VBA", "body": "<p>Here is a solution that does not use regex as that can be complicated if you need to support MAC.<br>\nFirst it ensures that ( has a space before and ) a space after.<br>\nThen it removes excess spaces before ( and after ).<br>\nFinally any space after ( or before ) is removed.</p>\n\n<pre><code>Sub ReplaceSpaces()\nDim sld As Slide\nDim shp As Shape\nDim shpText As TextRange\n\n\nFor Each sld In ActivePresentation.Slides\n    For Each shp In sld.Shapes\n        If shp.HasTextFrame Then\n            Set shpText = shp.TextFrame.TextRange\n\n            shpText.Replace FindWhat:=\"(\", ReplaceWhat:=\" (\"\n            shpText.Replace FindWhat:=\")\", ReplaceWhat:=\") \"\n            Do While InStr(shpText.Text, \"  (\") &gt; 0\n                shpText.Replace FindWhat:=\"  (\", ReplaceWhat:=\" (\"\n            Loop\n            Do While InStr(shpText.Text, \"( \") &gt; 0\n                shpText.Replace FindWhat:=\"( \", ReplaceWhat:=\"(\"\n            Loop\n            Do While InStr(shpText.Text, \")  \") &gt; 0\n                shpText.Replace FindWhat:=\")  \", ReplaceWhat:=\") \"\n            Loop\n            Do While InStr(shpText.Text, \" )\") &gt; 0\n                shpText.Replace FindWhat:=\" )\", ReplaceWhat:=\")\"\n            Loop\n\n        End If\n   Next shp\n Next sld\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 11710036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdac7783cf18ba2a36d275c4147ef846?s=128&d=identicon&r=PG&f=1", "display_name": "Curiosity_Bug", "link": "https://stackoverflow.com/users/11710036/curiosity-bug"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 57902937, "answer_count": 2, "score": 0, "last_activity_date": 1587157735, "creation_date": 1568229745, "last_edit_date": 1587157735, "question_id": 57895601, "link": "https://stackoverflow.com/questions/57895601/removing-and-adding-spaces-before-and-after-the-parenthesis-special-character-by", "title": "Removing and adding spaces before and after the parenthesis special character by using VBA", "body": "<p>I am trying to check for punctuation rule of parenthesis in text. My aim is to achieve the following: </p>\n\n<ol>\n<li>Space before open parenthesis and after closed parenthesis</li>\n<li>No space after open parenthesis and before parenthesis</li>\n</ol>\n\n<p>If text already follows above conditions then ignore either adding or removing spaces.</p>\n\n<p>I tried following code which finds \"( \" and replaces it with \" (\" i.e. space before opening parenthesis. When I run this, PowerPoint stops responding.</p>\n\n<p>Though there are many similar questions, I couldn't find a solution which uses VBA.</p>\n\n<pre><code>Sub ReplaceSpaces()\nDim sld As Slide\nDim shp As Shape\nDim shpText As TextRange\n\nFor Each sld In ActivePresentation.Slides\n    For Each shp In sld.Shapes\n        If shp.HasTextFrame Then\n            Set shpText = shp.TextFrame.TextRange\n\n            Do While InStr(shpText.Text, \"(\") &gt; 0\n                shpText.Replace FindWhat:=\"( \", ReplaceWhat:=\" (\"\n                shpText.Replace FindWhat:=\" )\", ReplaceWhat:=\") \"\n            Loop\n\n        End If\n    Next shp\nNext sld\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 1, "creation_date": 1568230919, "post_id": 57895521, "comment_id": 102212963, "body": "try: Worksheets(&quot;Control Panel&quot;).OLEObjects(&quot;ComboBox1&quot;).Object.Value = &quot;Choosing Region&quot;"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 2, "creation_date": 1568231531, "post_id": 57895521, "comment_id": 102213181, "body": "@EvR that will work, but it&#39;s still late-bound code that&#39;s prone to error 438. Best work with declared types and avoid unnecessary late binding."}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1568231485, "last_edit_date": 1568231485, "creation_date": 1568230948, "answer_id": 57895811, "question_id": 57895521, "link": "https://stackoverflow.com/questions/57895521/clearing-activex-dropdown-boxes-error-438/57895811#57895811", "title": "Clearing ActiveX dropdown boxes Error 438", "body": "<p>Everything after <code>Worksheets(...)</code> is late-bound, because <code>Worksheets</code> yields an <code>Object</code>: you're essentially coding blindfolded. Help the compiler by telling it what interface you mean to work with - in this case, <code>Worksheet</code>:</p>\n\n<pre><code>Dim ctrlPanelSheet As Worksheet\nSet ctrlPanelSheet = ActiveWorkbook.Worksheets(\"Control Panel\")\n</code></pre>\n\n<p>Now member calls against <code>ctrlPanelSheet</code> will be compile-time validated, and you'll get IntelliSense/member-completion on its member calls.</p>\n\n<p>That said, <code>ControlFormat</code> is a member of the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.shape.controlformat\" rel=\"nofollow noreferrer\"><code>Shape</code></a> class, but you're invoking it against a <code>ShapeRange</code> object. When you make a [late-bound] member call against an object, for a member that doesn't exist on that object, you get run-time error 438.</p>\n\n<p>But you don't need a <code>ShapeRange</code> when you're only working with a single control...</p>\n\n<pre><code>ctrlPanelSheet.Shapes(\"ComboBox1\").ControlFormat.Value = \"...\"\n</code></pre>\n\n<p>Now, doing that will raise a <em>type mismatch</em> error - <code>ComboBox1</code> looks much more like an ActiveX control than a <em>form control</em> (that would default to something like <code>Drop Down 1</code>) - you want to get that <code>MSForms.ComboBox</code> object, and you can get it from the sheet's <code>OLEObjects</code> collection:</p>\n\n<pre><code>Dim oleBox1 As OLEObject\nSet oleBox1 = ctrlPanelSheet.OLEObjects(\"ComboBox1\")\n</code></pre>\n\n<p>The OLEObject is wrapping your <code>MSForms.ComboBox</code> control:</p>\n\n<pre><code>Dim box1 As MSForms.ComboBox\nSet box1 = oleBox1.Object\n</code></pre>\n\n<p>And now that you have a <code>MSForms.ComboBox</code> object, you can do everything you could normally do with a <code>MSForms.ComboBox</code> object - all with compile-time validation:</p>\n\n<pre><code>box1.Value = \"Test\"\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 9730643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad80f61dee66e6efdfd9fb49469e02cf?s=128&d=identicon&r=PG&f=1", "display_name": "user9730643", "link": "https://stackoverflow.com/users/9730643/user9730643"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 57895811, "answer_count": 1, "score": 0, "last_activity_date": 1568231485, "creation_date": 1568229330, "last_edit_date": 1568230587, "question_id": 57895521, "link": "https://stackoverflow.com/questions/57895521/clearing-activex-dropdown-boxes-error-438", "title": "Clearing ActiveX dropdown boxes Error 438", "body": "<p>I have a script that populates two ActiveX drop down menus. I have a reset button what when pressed runs a macro that populated the value field of the drop down menus. I have included the macro that is triggered when the reset button is pressed below.</p>\n\n<pre><code>Sub UnhideAll()\n\nApplication.ScreenUpdating = False\n    Worksheets(\"Control Panel\").Shapes.Range(Array(\"ComboBox1\")).ControlFormat.Value = \"Choosing Region\"\n    Worksheets(\"Control Panel\").Shapes.Range(Array(\"ComboBox2\")).ControlFormat.Value = \"Choosing Office\"\n    Worksheets(\"Global\").Columns.EntireColumn.Hidden = False\n    Worksheets(\"Global\").Rows.EntireRow.Hidden = False\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\nEnd Sub\n\n</code></pre>\n\n<p>I keep getting Run time error 438 Object doesn't support this property or method.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568228826, "post_id": 57895303, "comment_id": 102212114, "body": "One option could be to <code>Application.Evaluate</code> a 3-d LARGE formula to get the values, and then a <code>Find</code> to figure out what tab they are from."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1568229792, "post_id": 57895303, "comment_id": 102212527, "body": "<a href=\"https://support.office.com/en-gb/article/create-a-3-d-reference-to-the-same-cell-range-on-multiple-worksheets-40ca91ff-9dcb-4ad1-99d2-787d0bc888b6\" rel=\"nofollow noreferrer\">Large does not support 3D references</a>"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1568229867, "post_id": 57895303, "comment_id": 102212557, "body": "@chrisneilsen works for me in Excel 2016, tested using <code>=LARGE(Sheet1:Sheet5!7:7,1)</code>. <code>Evaluate</code> then worked as well."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568230013, "post_id": 57895303, "comment_id": 102212618, "body": "@bigben that&#39;s interesting.  Guess it&#39;s not the first time MS documentation has let us down"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568230052, "post_id": 57895303, "comment_id": 102212634, "body": "Yep, completely agree. Looks like <code>SMALL</code> is missing as well."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 3536226, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2ca2f5525ce46b5072aa482244350004?s=128&d=identicon&r=PG&f=1", "display_name": "user3536226", "link": "https://stackoverflow.com/users/3536226/user3536226"}, "edited": false, "score": 0, "creation_date": 1568280522, "post_id": 57895718, "comment_id": 102227406, "body": "instead of displaying to <code>Worksheets(&quot;Sheet20&quot;).Range(&quot;A15&quot;).Resize(5, 2).Value = MaxArr</code> to display in to a MsgBox?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 41, "user_id": 3536226, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2ca2f5525ce46b5072aa482244350004?s=128&d=identicon&r=PG&f=1", "display_name": "user3536226", "link": "https://stackoverflow.com/users/3536226/user3536226"}, "edited": false, "score": 0, "creation_date": 1568295059, "post_id": 57895718, "comment_id": 102235525, "body": "@user3536226 loop through the array and concatenate a text string of the output in the format you want.  Then message box the string."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1568231929, "last_edit_date": 1568231929, "creation_date": 1568230343, "answer_id": 57895718, "question_id": 57895303, "link": "https://stackoverflow.com/questions/57895303/find-highest-number-across-row-across-all-workbook/57895718#57895718", "title": "Find highest number across row across all workbook", "body": "<p>This will iterate the sheets and return the top five numbers and their respective sheets.</p>\n\n<pre><code>Sub ShowMinMax()\n\n    Dim MaxArr(1 To 5, 1 To 2) As Variant\n    Dim ws As Worksheet\n    For Each ws In ThisWorkbook.Worksheets\n        Dim lstColumn As Long\n        lstColumn = ws.Cells(10, ws.Columns.Count).End(xlToLeft).Column\n\n        Dim rowArr As Variant\n        rowArr = ws.Range(ws.Cells(10, 1), ws.Cells(10, lstColumn)).Value\n        Dim i As Long\n        For i = 1 To lstColumn\n            If Not IsEmpty(rowArr) Then\n            If IsNumeric(rowArr(1, i)) Then\n                Dim j As Long\n                For j = 1 To 5\n                    If rowArr(1, i) &gt; MaxArr(j, 2) Then\n                        Dim k As Long\n                        For k = 5 To j + 1 Step -1\n                            MaxArr(k, 2) = MaxArr(k - 1, 2)\n                            MaxArr(k, 1) = MaxArr(k - 1, 1)\n                        Next k\n                        MaxArr(j, 2) = rowArr(1, i)\n                        MaxArr(j, 1) = ws.Name\n                        Exit For\n                    End If\n                Next j\n            End If\n            End If\n        Next i\n    Next ws\n\n    'Change line below to the correct output range        \n    Worksheets(\"Sheet20\").Range(\"A15\").Resize(5, 2).Value = MaxArr\n\n\nEnd Sub\n</code></pre>\n\n<p>This is what I got after running the above:</p>\n\n<p><a href=\"https://i.stack.imgur.com/nMmPR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nMmPR.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 41, "user_id": 3536226, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2ca2f5525ce46b5072aa482244350004?s=128&d=identicon&r=PG&f=1", "display_name": "user3536226", "link": "https://stackoverflow.com/users/3536226/user3536226"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 57895718, "answer_count": 1, "score": 0, "last_activity_date": 1568231929, "creation_date": 1568228259, "last_edit_date": 1568228370, "question_id": 57895303, "link": "https://stackoverflow.com/questions/57895303/find-highest-number-across-row-across-all-workbook", "title": "Find highest number across row across all workbook", "body": "<p>Find the top 5 highest number (value) on determined row (i.e. row 10) across all tabs in the workbook. Return the \"name of the tab\" and the value. </p>\n\n<pre><code>Sub ShowMinMax()\n    Dim vMax\n\n        vMax = Application.WorksheetFunction.Max(Rows(\"10\"))\n\n    MsgBox \"Maximum = \" &amp; vMax, vbInformation, \"GetMax Values\"\nEnd Sub\n</code></pre>\n\n<p>Expected result should be:\n\"Name of the tab\" maxValue1\n\"Name of the tab\" maxValue2\n...\n\"Name of the tab\" maxValue5</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 457, "user_id": 11832197, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-U8ZO6LVb3x8/AAAAAAAAAAI/AAAAAAAAAWg/8gxyuHZSKdA/photo.jpg?sz=128", "display_name": "Antonio Santos", "link": "https://stackoverflow.com/users/11832197/antonio-santos"}, "edited": false, "score": 0, "creation_date": 1568289983, "post_id": 57896014, "comment_id": 102232604, "body": "Hello @Dorian! I tried it, but it now gives me rows containing dates out of the range typed on B7 and B8, curiously. I am playing around with the data format to check where the root cause might be... Any idea as to where I should be headed? Thanks!"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "reply_to_user": {"reputation": 457, "user_id": 11832197, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-U8ZO6LVb3x8/AAAAAAAAAAI/AAAAAAAAAWg/8gxyuHZSKdA/photo.jpg?sz=128", "display_name": "Antonio Santos", "link": "https://stackoverflow.com/users/11832197/antonio-santos"}, "edited": false, "score": 0, "creation_date": 1568291284, "post_id": 57896014, "comment_id": 102233332, "body": "@AntonioSantos try to debug.print date as long format and see if vba read the date as excepted"}, {"owner": {"reputation": 457, "user_id": 11832197, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-U8ZO6LVb3x8/AAAAAAAAAAI/AAAAAAAAAWg/8gxyuHZSKdA/photo.jpg?sz=128", "display_name": "Antonio Santos", "link": "https://stackoverflow.com/users/11832197/antonio-santos"}, "edited": false, "score": 0, "creation_date": 1568306714, "post_id": 57896014, "comment_id": 102241903, "body": "I believe I will have to accept mine as the solution, since excluding the conversions si what solved the issue. Don&#39;t you think? :)"}, {"owner": {"reputation": 457, "user_id": 11832197, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-U8ZO6LVb3x8/AAAAAAAAAAI/AAAAAAAAAWg/8gxyuHZSKdA/photo.jpg?sz=128", "display_name": "Antonio Santos", "link": "https://stackoverflow.com/users/11832197/antonio-santos"}, "edited": false, "score": 0, "creation_date": 1568320939, "post_id": 57896014, "comment_id": 102247352, "body": "Pouvez-vous mettre le commentaire que j&#39;ai fait s&#251;r la conversi&#243;n que n&#39;est pas necessaire, s&#39;il vous pla&#238;t? Cheers!"}], "tags": [], "owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "is_accepted": true, "score": 0, "last_activity_date": 1568322108, "last_edit_date": 1568322108, "creation_date": 1568231953, "answer_id": 57896014, "question_id": 57895018, "link": "https://stackoverflow.com/questions/57895018/autofilter-between-dates-in-a-column-another-criteria-not-populating-destinati/57896014#57896014", "title": "Autofilter between dates in a column + another criteria not populating destination", "body": "<p>You need to convert your date in <code>double</code> <strong>to avoid</strong> this kind of error : <code>Autofilter()</code> works with <em>universal</em> format <code>yyyy-mm-dd</code>. Here your format is quite different so VBA miss interpret your dates (2 january would be read as 1 february for example)</p>\n\n<pre><code>Criteria1:= \"&gt;=\" &amp; CDbl(fromDate), Operator:=xlAnd, Criteria2:=\"&lt;=\" &amp; CDbl(toDate)\n</code></pre>\n\n<p>So your code would be :</p>\n\n<pre><code>Sub SelectDataBetweenTwoDates()\n    'declare variables\n    Dim fromDate, toDate As Date\n    Dim MyResults As Worksheet, MyData As Worksheet, MyDates As Worksheet\n\n    Set MyResults = Worksheets(\"Relat\u00f3rio de Comiss\u00e3o\")\n    Set MyData = Worksheets(\"BI_Comissoes\")\n    Set MyDates = Worksheets(\"Relat\u00f3rio de Comiss\u00e3o\")\n\n    'clear previous results\n    'MyResults.Cells.Clear\n\n    'attribute date values to variables\n    fromDate = MyDates.Range(\"B7\").Value\n    toDate = MyDates.Range(\"B8\").Value\n    Vendedor = MyResults.Range(\"B5\").Value\n\n   '**THIS** is the part I commented out, since these are declared as Date, thus compatible with the data I'm trying to filter. Then, there was no need to convert it to string for filtering purposes. \n    'convert to text format to allow filtering\n    'fromDate = Format(fromDate, \"dd-mmm-yyyy\")\n    'toDate = Format(toDate, \"dd-mmm-yyyy\")\n\n    'clear previous filtered data\n    With MyResults\n    'If fromDate = \"\" Or toDate = \"\" Then\n        'MsgBox \"Informar o per\u00edodo!\"\n        'Exit Sub\n    'Else: Resume\n    On Error Resume Next\n    Err.Number = 0\n    .Range(\"A$17:$K$20000\").Select\n    Intersect(Selection, _\n        Selection.SpecialCells(xlCellTypeConstants, 23)).ClearContents\n    End With\n\n    With MyData\n    'removes autofilter\n            If .FilterMode Then .ShowAllData\n\n    'filter the data based on selected date values\n    lastrow = Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n            .Range(\"$B$2:$B$\" &amp; lastrow).AutoFilter Field:=2, Criteria1:= _\n                \"&gt;=\" &amp; CDbl(fromDate), Operator:=xlAnd, Criteria2:=\"&lt;=\" &amp; CDbl(toDate)\n            .Range(\"G$2:G\" &amp; lastrow).AutoFilter Field:=7, Criteria1:=Vendedor\n\n    'copy the filtered data\n            .Range(\"$B$2:$B$30000\").SpecialCells(xlCellTypeVisible).Copy\n            MyResults.Range(\"A17\").PasteSpecial _\n            Paste:=xlPasteValuesAndNumberFormats, Operation:=xlNone, _\n            SkipBlanks:=False, Transpose:=False\n\n    End With\n\n    'Informs the user, incase nothing has been parsed into the results table\n    If MyResults.Range(\"A17\").Value = \"\" Then\n        MsgBox \"N\u00e3o h\u00e1 comiss\u00e3o neste per\u00edodo.\"\n    End If\n\n    'brings selection to the main cell\n    MyResults.Activate\n    MyResults.Range(\"B5\").Select\n\n    End Sub\n</code></pre>\n\n<p>Don't hesitate to leave me feedbacks so I can improve my answer if needed.</p>\n\n<p>Maybe read <a href=\"http://www.oaltd.co.uk/ExcelProgRef/Ch22/ProgRefCh22.htm\" rel=\"nofollow noreferrer\">this</a> can help you to avoid those kind of error.</p>\n\n<p>Kindest regards</p>\n"}, {"tags": [], "owner": {"reputation": 457, "user_id": 11832197, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-U8ZO6LVb3x8/AAAAAAAAAAI/AAAAAAAAAWg/8gxyuHZSKdA/photo.jpg?sz=128", "display_name": "Antonio Santos", "link": "https://stackoverflow.com/users/11832197/antonio-santos"}, "is_accepted": false, "score": 0, "last_activity_date": 1568293100, "creation_date": 1568293100, "answer_id": 57907294, "question_id": 57895018, "link": "https://stackoverflow.com/questions/57895018/autofilter-between-dates-in-a-column-another-criteria-not-populating-destinati/57907294#57907294", "title": "Autofilter between dates in a column + another criteria not populating destination", "body": "<p>At the end, here is how I've solved it, in case anyone runs into this kind of issue:</p>\n\n<pre><code>Sub SelectDataBetweenTwoDates()\n\n'declare variables\n    Dim fromDate, toDate As Date\n    Dim MyResults As Worksheet, MyData As Worksheet, MyDates As Worksheet\n\n    Set MyResults = Worksheets(\"Relat\u00f3rio de Comiss\u00e3o\")\n    Set MyData = Worksheets(\"BI_Comissoes\")\n    Set MyDates = Worksheets(\"Relat\u00f3rio de Comiss\u00e3o\")\n\n'attribute date values to variables\n    fromDate = MyDates.Range(\"B7\").Value\n    toDate = MyDates.Range(\"B8\").Value\n    Vendedor = MyResults.Range(\"B5\").Value\n\n'**THIS** is the part I commented out, since these are declared as Date, thus compatible with the data I'm trying to filter. Then, there was no need to convert it to string for filtering purposes.    \n'convert to text format to allow filtering\n    'fromDate = Format(fromDate, \"dd/mm/yyyy\")\n    'toDate = Format(toDate, \"dd/mm/yyyy\")\n    'MsgBox fromDate\n\n    'clear previous filtered data\n   With MyResults\n    If fromDate = 0 Or toDate = 0 Then\n        MsgBox \"Informar o per\u00edodo!\"\n        Exit Sub\n    Else\n    On Error Resume Next\n    Err.Number = 0\n    .Range(\"A$17:$K$20000\").Select\n    Intersect(Selection, _\n        Selection.SpecialCells(xlCellTypeConstants, 23)).ClearContents\n    End If\n    End With\n\n    With MyData\n    'removes autofilter\n            If .FilterMode Then .ShowAllData\n\n    'filter the data based on selected date values\n    lastrow = Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n            .Range(\"$B$2:$B$\" &amp; lastrow).AutoFilter Field:=2, Criteria1:= _\n                \"&gt;=\" &amp; CDbl(fromDate), Operator:=xlAnd, Criteria2:=\"&lt;=\" &amp; CDbl(toDate)\n            .Range(\"G$2:G\" &amp; lastrow).AutoFilter Field:=7, Criteria1:=Vendedor\n</code></pre>\n"}], "owner": {"reputation": 457, "user_id": 11832197, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-U8ZO6LVb3x8/AAAAAAAAAAI/AAAAAAAAAWg/8gxyuHZSKdA/photo.jpg?sz=128", "display_name": "Antonio Santos", "link": "https://stackoverflow.com/users/11832197/antonio-santos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 57896014, "answer_count": 2, "score": 0, "last_activity_date": 1568322108, "creation_date": 1568227054, "last_edit_date": 1568256177, "question_id": 57895018, "link": "https://stackoverflow.com/questions/57895018/autofilter-between-dates-in-a-column-another-criteria-not-populating-destinati", "title": "Autofilter between dates in a column + another criteria not populating destination", "body": "<p>I have a data table (Sheet named BI_Comissoes), where I got Date Column and a Salesman Column. Then, I got the destination sheet, which serves as a report to be populated based on a date range entered on B7 and B8 and the salesman's name entered on B5.\nOnce run the code, destination sheet doesn't get populated, but the data sheet gets filtered normally. \nThe code was working before, but I guess I messed with it somewhere and my neurons seem to be burned out, as I can't find out where the problem is. </p>\n\n<p>I've tried many date formats, but nothing seems to work. For your information, the date on Data Table comes as dd/mm/yyyy.</p>\n\n<pre><code>Sub SelectDataBetweenTwoDates()\n    'declare variables\n    Dim fromDate, toDate As Date\n    Dim MyResults As Worksheet, MyData As Worksheet, MyDates As Worksheet\n\n    Set MyResults = Worksheets(\"Relat\u00f3rio de Comiss\u00e3o\")\n    Set MyData = Worksheets(\"BI_Comissoes\")\n    Set MyDates = Worksheets(\"Relat\u00f3rio de Comiss\u00e3o\")\n\n    'clear previous results\n    'MyResults.Cells.Clear\n\n    'attribute date values to variables\n    fromDate = MyDates.Range(\"B7\").Value\n    toDate = MyDates.Range(\"B8\").Value\n    Vendedor = MyResults.Range(\"B5\").Value\n\n    'convert to text format to allow filtering\n    fromDate = Format(fromDate, \"dd-mmm-yyyy\")\n    toDate = Format(toDate, \"dd-mmm-yyyy\")\n\n    'clear previous filtered data\n    With MyResults\n    'If fromDate = \"\" Or toDate = \"\" Then\n        'MsgBox \"Informar o per\u00edodo!\"\n        'Exit Sub\n    'Else: Resume\n    On Error Resume Next\n    Err.Number = 0\n    .Range(\"A$17:$K$20000\").Select\n    Intersect(Selection, _\n        Selection.SpecialCells(xlCellTypeConstants, 23)).ClearContents\n    End With\n\n    With MyData\n    'removes autofilter\n            If .FilterMode Then .ShowAllData\n\n    'filter the data based on selected date values\n    lastrow = Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n            .Range(\"$B$2:$B$\" &amp; lastrow).AutoFilter Field:=2, Criteria1:= _\n                \"&gt;=\" &amp; fromDate, Operator:=xlAnd, Criteria2:=\"&lt;=\" &amp; toDate\n            .Range(\"G$2:G\" &amp; lastrow).AutoFilter Field:=7, Criteria1:=Vendedor\n\n    'copy the filtered data\n            .Range(\"$B$2:$B$30000\").SpecialCells(xlCellTypeVisible).Copy\n            MyResults.Range(\"A17\").PasteSpecial _\n            Paste:=xlPasteValuesAndNumberFormats, Operation:=xlNone, _\n            SkipBlanks:=False, Transpose:=False\n\n    End With\n\n    'Informs the user, incase nothing has been parsed into the results table\n    If MyResults.Range(\"A17\").Value = \"\" Then\n        MsgBox \"N\u00e3o h\u00e1 comiss\u00e3o neste per\u00edodo.\"\n    End If\n\n    'brings selection to the main cell\n    MyResults.Activate\n    MyResults.Range(\"B5\").Select\n\n    End Sub\n</code></pre>\n\n<p>The purpose is to have A17:K populated based on the date range and salesman entered.</p>\n\n<p>Any help is greatly appreciated.</p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1568226585, "post_id": 57894715, "comment_id": 102211100, "body": "If you generate the new textrange objects from the clipboard (i.e. clipboard-copy from source, then paste), you&#39;ll get a deep-copy..."}, {"owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "edited": false, "score": 1, "creation_date": 1568241942, "post_id": 57894715, "comment_id": 102216194, "body": "That&#39;s not a best practice, since you&#39;re piling local formatting on local formatting. Future users of this deck will have a better experience if you format the <b>Slide Master</b> and <b>Slide Layouts</b> with your preferred format, then <b>Reset</b> each slide to update the appearance to the layout."}, {"owner": {"reputation": 26, "user_id": 8495584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e3ba4657029ec6919b07cd58b69f5b2?s=128&d=identicon&r=PG&f=1", "display_name": "B. Baker", "link": "https://stackoverflow.com/users/8495584/b-baker"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1568258123, "post_id": 57894715, "comment_id": 102219223, "body": "@MathieuGuindon Thank you for the info. Unfortunately I think I might be in an unsupported fringe case because I am trying to copy to a BulletFormat2 object, not a TextRange or TextRange2."}, {"owner": {"reputation": 26, "user_id": 8495584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e3ba4657029ec6919b07cd58b69f5b2?s=128&d=identicon&r=PG&f=1", "display_name": "B. Baker", "link": "https://stackoverflow.com/users/8495584/b-baker"}, "reply_to_user": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "edited": false, "score": 0, "creation_date": 1568258685, "post_id": 57894715, "comment_id": 102219319, "body": "@JohnKorchok Thank you for raising that concern. Local formatting isn&#39;t a huge  concern because the application is for prepping documents for import into a computer-assisted translation program, not for making robust templates or presentations that last beyond their single use. Nevertheless your point is a good one because the route I was on would put a bunch of formatting info inside the bullet"}], "answers": [{"tags": [], "owner": {"reputation": 96, "user_id": 11839085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34b2bc472a9a6b17616b5d44d92be675?s=128&d=identicon&r=PG&f=1", "display_name": "egerz", "link": "https://stackoverflow.com/users/11839085/egerz"}, "is_accepted": false, "score": 0, "last_activity_date": 1568469025, "creation_date": 1568469025, "answer_id": 57936137, "question_id": 57894715, "link": "https://stackoverflow.com/questions/57894715/is-there-a-way-to-copy-font-formatting-from-one-font2-to-another/57936137#57936137", "title": "Is there a way to copy font formatting from one Font2 to another?", "body": "<p>Here is my extremely brute force way of dealing with a similar issue, which covers a case where I needed to copy all formatting from one shape to another with the exact same text:</p>\n\n<pre><code>Sub copyAllTextFormatting(oShp As Shape, tShp As Shape)\n\nDebug.Print \"IN_copyAllTextFormatting\"\nOn Error GoTo Errhandler\n\nDim tmpRange As TextRange\nDim tmpRange2 As TextRange2\n\n\n\nDim i As Integer\nDim j As Integer\n\n\nIf oShp.HasTextFrame Then\n    If oShp.TextFrame.HasText Then\n        Set tmpRange = tShp.TextFrame.TextRange\n        Set tmpRange2 = tShp.TextFrame2.TextRange\n\n        With oShp.TextFrame\n            .MarginBottom = tShp.TextFrame.MarginBottom\n            .MarginLeft = tShp.TextFrame.MarginLeft\n            .MarginRight = tShp.TextFrame.MarginRight\n            .MarginTop = tShp.TextFrame.MarginTop\n            .Orientation = tShp.TextFrame.Orientation\n            .VerticalAnchor = tShp.TextFrame.VerticalAnchor\n            .WordWrap = tShp.TextFrame.WordWrap\n        End With\n\n        For j = 1 To tmpRange.Paragraphs.Count\n\n            With oShp.TextFrame2.TextRange.Paragraphs(j).ParagraphFormat\n                If tmpRange.Paragraphs(j).ParagraphFormat.Bullet = msoTrue Then\n                    .Bullet.visible = tmpRange2.Paragraphs(j).ParagraphFormat.Bullet.visible\n                    .Bullet.Character = tmpRange2.Paragraphs(j).ParagraphFormat.Bullet.Character\n                    .Bullet.Font.Name = tmpRange2.Paragraphs(j).ParagraphFormat.Bullet.Font.Name\n                    .Bullet.Font.Bold = tmpRange2.Paragraphs(j).ParagraphFormat.Bullet.Font.Bold\n                    .Bullet.Font.Size = tmpRange2.Paragraphs(j).ParagraphFormat.Bullet.Font.Size\n                    .Bullet.UseTextColor = tmpRange2.Paragraphs(j).ParagraphFormat.Bullet.UseTextColor\n                    .Bullet.RelativeSize = tmpRange2.Paragraphs(j).ParagraphFormat.Bullet.RelativeSize\n                    If tmpRange2.Paragraphs(j).ParagraphFormat.Bullet.Type = msoBulletNumbered Then\n                        .Bullet.StartValue = tmpRange.Paragraphs(j).ParagraphFormat.Bullet.StartValue\n                        .Bullet.Style = tmpRange2.Paragraphs(j).ParagraphFormat.Bullet.Style\n                        .Bullet.Type = tmpRange2.Paragraphs(j).ParagraphFormat.Bullet.Type\n                    End If\n                Else\n                    .Bullet.visible = msoFalse\n                End If\n\n                .Alignment = tmpRange2.Paragraphs(j).ParagraphFormat.Alignment\n                .BaseLineAlignment = tmpRange2.Paragraphs(j).ParagraphFormat.BaseLineAlignment\n                .HangingPunctuation = tmpRange2.Paragraphs(j).ParagraphFormat.HangingPunctuation\n                .TextDirection = tmpRange2.Paragraphs(j).ParagraphFormat.TextDirection\n                .WordWrap = tmpRange2.Paragraphs(j).ParagraphFormat.WordWrap\n                .IndentLevel = tmpRange2.Paragraphs(j).ParagraphFormat.IndentLevel\n                .LineRuleAfter = tmpRange2.Paragraphs(j).ParagraphFormat.LineRuleAfter\n                .LineRuleBefore = tmpRange2.Paragraphs(j).ParagraphFormat.LineRuleBefore\n                .LineRuleWithin = tmpRange2.Paragraphs(j).ParagraphFormat.LineRuleWithin\n                .SpaceAfter = tmpRange2.Paragraphs(j).ParagraphFormat.SpaceAfter\n                .SpaceBefore = tmpRange2.Paragraphs(j).ParagraphFormat.SpaceBefore\n                .SpaceWithin = tmpRange2.Paragraphs(j).ParagraphFormat.SpaceWithin\n                .LeftIndent = tmpRange2.Paragraphs(j).ParagraphFormat.LeftIndent\n                .FirstLineIndent = tmpRange2.Paragraphs(j).ParagraphFormat.FirstLineIndent\n            End With\n        Next\n\n        For i = 1 To tmpRange.Words.Count\n            With oShp.TextFrame.TextRange.Words(i)\n                .Font.Name = tmpRange.Words(i).Font.Name\n                .Font.Size = tmpRange.Words(i).Font.Size\n                If tmpRange.Words(i).Font.Color.Type = msoColorTypeScheme Then\n                    .Font.Color.ObjectThemeColor = tmpRange.Words(i).Font.Color.ObjectThemeColor\n                ElseIf tmpRange.Words(i).Font.Color.Type = msoColorTypeRGB Then\n                    .Font.Color.RGB = tmpRange.Words(i).Font.Color.RGB\n                ElseIf tmpRange.Words(i).Font.Color.Type = msoColorTypeMixed Then\n                    For j = 1 To tmpRange.Words(i).Characters.Count\n                        If tmpRange.Words(i).Characters(j).Font.Color.Type = msoColorTypeScheme Then\n                            .Characters(j).Font.Color.ObjectThemeColor = tmpRange.Words(i).Characters(j).Font.Color.ObjectThemeColor\n                        Else\n                            .Characters(j).Font.Color.RGB = tmpRange.Words(i).Characters(j).Font.Color.RGB\n                        End If\n                    Next\n                End If\n                .Font.Bold = tmpRange.Words(i).Font.Bold\n                .Font.Italic = tmpRange.Words(i).Font.Italic\n                .Font.Underline = tmpRange.Words(i).Font.Underline\n                .Font.Subscript = tmpRange.Words(i).Font.Subscript\n                .Font.Superscript = tmpRange.Words(i).Font.Superscript\n            End With\n        Next\n\n    End If\nEnd If\n\nExit Sub\n\nErrhandler:\nDebug.Print \"Error: \" &amp; Err.Description\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 26, "user_id": 8495584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e3ba4657029ec6919b07cd58b69f5b2?s=128&d=identicon&r=PG&f=1", "display_name": "B. Baker", "link": "https://stackoverflow.com/users/8495584/b-baker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1583835416, "creation_date": 1568225707, "last_edit_date": 1583835416, "question_id": 57894715, "link": "https://stackoverflow.com/questions/57894715/is-there-a-way-to-copy-font-formatting-from-one-font2-to-another", "title": "Is there a way to copy font formatting from one Font2 to another?", "body": "<p>I'm writing a PowerPoint VBA macro to change typed bullet characters at the start of the line (like \"\u30fb\" typed in as part of the paragraph text) to bullet-lists (i.e. bullets as part of the paragraph formatting). I want the bullets in the list to look exactly like the bullets did as typed characters, meaning that I need to copy all the formatting information inside <code>TextRange2.Characters(1).Font</code> for the bullet character as typed text to <code>TextRange2.ParagraphFormat.Bullet.Font</code> for the new bullet as a feature of the paragraph formatting. Is there a quick way to do a deep copy like this?</p>\n\n<p>From what I gather, I may need to make a bunch of helper <code>Sub</code>s to do a deep copy of all the <code>Font2</code> properties. (I know I can't just do <code>Set TextRange2.ParagraphFormat.Bullet.Font = TextRange2.Characters(1).Font</code> because the <code>TextRange2.ParagraphFormat.Bullet.Font</code> property is read-only.)</p>\n\n<p>Here are some but not all of the helper <code>Sub</code>s I would need if I follow this route.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub CopyFont2(destination As Font2, source As Font2)\nPublic Sub CopyFillFormat(destination As FillFormat, source As FillFormat)\nPublic Sub CopyGlowFormat(destination As GlowFormat, source As GlowFormat)\nPublic Sub CopyColorFormat(destination As ColorFormat, source As ColorFormat)\nPublic Sub CopyLineFormat(destination As ColorFormat, source As ColorFormat)\n</code></pre>\n\n<p>I haven't started writing any of these except for <code>CopyFont2</code> and <code>CopyFillFormat</code>, and I would rather avoid writing all these if I can. Is there a simpler way to do a deep copy on built-in objects this? Or is there an alternative way to copy font formatting that I'm missing?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1651, "user_id": 635822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fd51a3c79639c315af5864adc731298?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/635822/jason"}, "edited": false, "score": 3, "creation_date": 1568222676, "post_id": 57894001, "comment_id": 102209524, "body": "Do you mind sharing the code?"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1568263611, "post_id": 57894001, "comment_id": 102220401, "body": "Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>  then search for your error msg (include keyword collection)!"}, {"owner": {"reputation": 1, "user_id": 12054386, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-7aux8JOaj9c/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd9KxOVKhA40NaZZW8GSwQqUTXFSQ/photo.jpg?sz=128", "display_name": "deepak kumar", "link": "https://stackoverflow.com/users/12054386/deepak-kumar"}, "edited": false, "score": 0, "creation_date": 1568281262, "post_id": 57894001, "comment_id": 102227824, "body": "Public Property Get extraparam(index As Integer) As Collection      Set extraparam = extraparams(index)   End Property    Public Property Get extra_params() As Collection()       If IsEmpty(extraparams) Then           extra_params = Collection       Else           extra_params = extraparams       End If        End Property    Public Property Let extraparam(index As Integer, MyValue As Collection)       ReDim Preserve extraparams(index)       Set extraparams(index) = MyValue   End Property"}], "owner": {"reputation": 1, "user_id": 12054386, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-7aux8JOaj9c/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd9KxOVKhA40NaZZW8GSwQqUTXFSQ/photo.jpg?sz=128", "display_name": "deepak kumar", "link": "https://stackoverflow.com/users/12054386/deepak-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568281695, "creation_date": 1568222386, "last_edit_date": 1568281695, "question_id": 57894001, "link": "https://stackoverflow.com/questions/57894001/unable-to-run-excel-vba-code-on-citrix-on-excel-2013", "title": "Unable to Run Excel VBA code on citrix on excel 2013", "body": "<p>I have VBA code which is working on Windows machine on VM, but same code giving error in citrix environment, both excel version are same 2013. \nI have a \"collection\" object which is giving error, \"invalid procedure call or argument\", any help much apricated. </p>\n\n<p>I make sync of all properties on both environment excel.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 5, "creation_date": 1568222260, "post_id": 57893938, "comment_id": 102209334, "body": "Use a pivot table."}, {"owner": {"reputation": 369, "user_id": 5620644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70050e5c09ce3171441cb1f0edc3bfd?s=128&d=identicon&r=PG&f=1", "display_name": "Andras", "link": "https://stackoverflow.com/users/5620644/andras"}, "edited": false, "score": 0, "creation_date": 1568225560, "post_id": 57893938, "comment_id": 102210656, "body": "Did you mean statistics of only Column A, or all columns used?"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1568376350, "post_id": 57893938, "comment_id": 102264285, "body": "Did you at least try my <a href=\"https://stackoverflow.com/a/57895049/11167163\">answer</a> or an other one ?"}], "answers": [{"comments": [{"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1568228645, "post_id": 57895264, "comment_id": 102212023, "body": "You are using <code>dictionary</code> As I Said in my answer but your code will <b>be less efficient</b> due to the browse of the same array 2 times ... So this can be slow if there is a huge dictionary"}, {"owner": {"reputation": 51, "user_id": 11521350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29844bf32155fbcd7566d4eaa1342521?s=128&d=identicon&r=PG&f=1", "display_name": "mattJ", "link": "https://stackoverflow.com/users/11521350/mattj"}, "reply_to_user": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1568229083, "post_id": 57895264, "comment_id": 102212224, "body": "I didn&#39;t see your answer. Sorry. Yeah i agree but for huge dict it&#39;s better to use db."}], "tags": [], "owner": {"reputation": 51, "user_id": 11521350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29844bf32155fbcd7566d4eaa1342521?s=128&d=identicon&r=PG&f=1", "display_name": "mattJ", "link": "https://stackoverflow.com/users/11521350/mattj"}, "is_accepted": false, "score": 0, "last_activity_date": 1568228451, "last_edit_date": 1568228451, "creation_date": 1568228093, "answer_id": 57895264, "question_id": 57893938, "link": "https://stackoverflow.com/questions/57893938/count-the-number-of-times-a-value-appears-in-a-column-and-return-that-value-to-a/57895264#57895264", "title": "Count the number of times a value appears in a column and return that value to a different worksheet", "body": "<p>Try code below. I think it works good. I filled up only column \"A\". If you have more data then change rng or 1 in dict(arr(i, <strong>1</strong>)) to correct column in range.</p>\n\n<p>Add References - Microsoft Scripting Runtime.</p>\n\n<pre><code>Sub count_unique()\n    Dim dict As Scripting.Dictionary\n    Dim arr() As Variant\n    Dim i As Long\n    Dim rng As Range\n\n    Set dict = New Scripting.Dictionary\n    Set rng = Range(\"A1\").CurrentRegion\n    arr = rng.Value\n\n    For i = LBound(arr, 1) To UBound(arr, 1) '1 means rows, 2 - columns\n        dict(arr(i, 1)) = 0\n    Next\n\n    arr = dict.keys()\n\n    For i = LBound(arr) To UBound(arr)\n        count_key = Application.WorksheetFunction.CountIf(rng, arr(i))\n        Debug.Print arr(i), count_key\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 641, "user_id": 4037170, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b377de247501ccb94ad5aebaf49f6aa9?s=128&d=identicon&r=PG&f=1", "display_name": "dimitris", "link": "https://stackoverflow.com/users/4037170/dimitris"}, "is_accepted": false, "score": 0, "last_activity_date": 1568267195, "last_edit_date": 1568267195, "creation_date": 1568229345, "answer_id": 57895528, "question_id": 57893938, "link": "https://stackoverflow.com/questions/57893938/count-the-number-of-times-a-value-appears-in-a-column-and-return-that-value-to-a/57895528#57895528", "title": "Count the number of times a value appears in a column and return that value to a different worksheet", "body": "<p>Try this. It worked for me.</p>\n\n<pre><code>Sub CountValues()\nDim ws1 as Worksheet, ws2 as Worksheet\nDim i As Long, lMaxRow As Long, lTemp As Long\n    Set ws1 = ThisWorkbook.Worksheets(1) 'assumes that data is in first column of first worksheet.\n    Set ws2 = ThisWorkbook.Worksheets(2) 'change this to the desired output worksheet.\n'find last used row in column A.\n    lMaxRow = ws1.Cells(ws1.Rows.Count, 1).End(xlUp).Row\n'copy original data in a temporary column that has no data (eg.:AA).\n    ws1.Range(\"A1:A\" &amp; lMaxRow).Copy ws1.Range(\"AA1:AA\" &amp; lMaxRow)\n'remove duplicates from the temporary column.\n    ws1.Range(\"AA1:AA\" &amp; lMaxRow).RemoveDuplicates Columns:=1, Header:=xlNo\n'count unique values in temporary column AA.\n    lTemp = ws1.Cells(ws1.Rows.Count, 27).End(xlUp).Row\n'count each unique value.\n    For i = 1 To lTemp\n        ws2.Range(\"A\" &amp; i) = ws1.Range(\"AA\" &amp; i)\n        ws2.Range(\"B\" &amp; i) = Application.WorksheetFunction.CountIf(ws1.Range(\"A1:A\" &amp; lMaxRow), ws1.Range(\"AA\" &amp; i))\n    Next\n'clear temporary column\n    ws1.Range(\"AA1:AA\" &amp; lMaxRow).ClearContents\n'at this point this code outputs in worksheet2 the unique values in column A and the count in column B.\n    Set ws1 = Nothing\n    Set ws2 = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11803068"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 165, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1568267195, "creation_date": 1568222112, "last_edit_date": 1568222161, "question_id": 57893938, "link": "https://stackoverflow.com/questions/57893938/count-the-number-of-times-a-value-appears-in-a-column-and-return-that-value-to-a", "title": "Count the number of times a value appears in a column and return that value to a different worksheet", "body": "<p>I would like to consolidate my current script to be more dynamic. I am trying to count the number of times a unique value appears in a column. I want it to be dynamic regardless of the amount of unique items. There could be 5,6 or however many different values in this column. I would like to find out how many times each unique value is in the column and return it to a different worksheet.</p>\n\n<p>Here is how I complete this as of now. </p>\n\n<pre><code>Dim Total As Range\nSet Total = ws.Range(\"B2\")\nTotal.Value = Application.WorksheetFunction.CountIf(Worksheets(\"Sheet1\").Column(\"A\"), \"Apple\")\n</code></pre>\n\n<p>But this is a script adapted to fit a fixed, not dynamic, set of a data. I would like to look for any unique value and count how many times it appears. Any thoughts?</p>\n"}, {"tags": ["sql-server", "excel", "vba"], "comments": [{"owner": {"reputation": 453, "user_id": 3499391, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/7DtDw.jpg?s=128&g=1", "display_name": "junketsu", "link": "https://stackoverflow.com/users/3499391/junketsu"}, "edited": false, "score": 0, "creation_date": 1568227049, "post_id": 57893841, "comment_id": 102211307, "body": "why dont you convert the file to .csv and use BULK INSERT to insert the data INTO SQL Server? Or that is NOT an option for you."}, {"owner": {"reputation": 25, "user_id": 5697809, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206250393193667/picture?type=large", "display_name": "DickTaid81", "link": "https://stackoverflow.com/users/5697809/dicktaid81"}, "reply_to_user": {"reputation": 453, "user_id": 3499391, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/7DtDw.jpg?s=128&g=1", "display_name": "junketsu", "link": "https://stackoverflow.com/users/3499391/junketsu"}, "edited": false, "score": 0, "creation_date": 1568360826, "post_id": 57893841, "comment_id": 102256664, "body": "Hi. The issue with BULK INSERT is that the insert vba will be used by multiple users in our organization and our security settings on local computers stops this. So unfortunately this is not an option in this case. But I will use it I can bend the rules for myself."}, {"owner": {"reputation": 453, "user_id": 3499391, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/7DtDw.jpg?s=128&g=1", "display_name": "junketsu", "link": "https://stackoverflow.com/users/3499391/junketsu"}, "edited": false, "score": 0, "creation_date": 1568384727, "post_id": 57893841, "comment_id": 102268473, "body": "if your org has MS Teams why not collab through there and send you e.o.b. Final files from each dept/user/etc . And you can convert it to CSV and upload to server. Strd etl lags apply. Data will be available am hrs or before business starts next day."}], "answers": [{"comments": [{"owner": {"reputation": 119223, "user_id": 5070879, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/7534153a9cc70ad4e20680d6ca1b09ff?s=128&d=identicon&r=PG&f=1", "display_name": "Lukasz Szozda", "link": "https://stackoverflow.com/users/5070879/lukasz-szozda"}, "edited": false, "score": 1, "creation_date": 1568223391, "post_id": 57894093, "comment_id": 102209817, "body": "I think you should at least add a warning about possible SQL Injection and usage of parametrized query."}, {"owner": {"reputation": 916, "user_id": 4887664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZDjRP.jpg?s=128&g=1", "display_name": "Jonathan Larouche", "link": "https://stackoverflow.com/users/4887664/jonathan-larouche"}, "edited": false, "score": 0, "creation_date": 1568226733, "post_id": 57894093, "comment_id": 102211168, "body": "We have done this in the past, doing 1000 X single row INSERT will take a very long time. You must try as possible to split into batches, 50 records/time, using the SQL Statement like this &#39;INSERT INTO TABLE (COLDEFS..) VALUES (ROW1...),(ROW2...)...(ROW50)&#39;"}, {"owner": {"reputation": 49085, "user_id": 7297700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7650f380e0e3b8415ba9afaadf70906?s=128&d=identicon&r=PG&f=1", "display_name": "David Browne - Microsoft", "link": "https://stackoverflow.com/users/7297700/david-browne-microsoft"}, "edited": false, "score": 0, "creation_date": 1568226963, "post_id": 57894093, "comment_id": 102211274, "body": "1000 single-row inserts should take just a few seconds, with the transaction and a SQL Server on your local network."}], "tags": [], "owner": {"reputation": 49085, "user_id": 7297700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7650f380e0e3b8415ba9afaadf70906?s=128&d=identicon&r=PG&f=1", "display_name": "David Browne - Microsoft", "link": "https://stackoverflow.com/users/7297700/david-browne-microsoft"}, "is_accepted": false, "score": 0, "last_activity_date": 1568224106, "last_edit_date": 1568224106, "creation_date": 1568222786, "answer_id": 57894093, "question_id": 57893841, "link": "https://stackoverflow.com/questions/57893841/excel-vba-inserting-1000-rows-at-a-time-to-sql-server/57894093#57894093", "title": "Excel VBA - Inserting 1000 rows at a time to sql server", "body": "<blockquote>\n  <p>To improve the speed of the import I want to import 1.000 rows at a time. How can I modify the code to insert 1.000 rows for each excecution?</p>\n</blockquote>\n\n<p>Lots of ways, but none easy from VBA.  Start by just using a transaction, or loading into a temp table.  The way you're currently doing it requires the log file to be flushed after each insert, which is probably most of your elapsed time.  Something like:</p>\n\n<pre><code>    conn.Execute \"begin transaction\"\n\n    'Loop until empty cell in CustomerId\n    Do Until .Cells(iRowNo, 1) = \"\"\n        sCustomerId = .Cells(iRowNo, 1)\n        sFirstName = .Cells(iRowNo, 2)\n        sLastName = .Cells(iRowNo, 3)\n\n        'Generate and execute sql statement to import the excel rows to SQL Server table\n\n        '... set parameter values \n\n        conn.Execute \"insert into dbo.CustomersStage (CustomerId, FirstName, LastName) values (@CustomerId, @FirstName, @LastName)\"\n\n\n\n        iRowNo = iRowNo + 1\n    Loop\n\n    conn.Execute \"commit transaction\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 5697809, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206250393193667/picture?type=large", "display_name": "DickTaid81", "link": "https://stackoverflow.com/users/5697809/dicktaid81"}, "edited": false, "score": 0, "creation_date": 1568360913, "post_id": 57915698, "comment_id": 102256702, "body": "Unfortenately our local security settings stops this option. Otherwise it would have been a good solution."}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "reply_to_user": {"reputation": 25, "user_id": 5697809, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206250393193667/picture?type=large", "display_name": "DickTaid81", "link": "https://stackoverflow.com/users/5697809/dicktaid81"}, "edited": false, "score": 0, "creation_date": 1568378758, "post_id": 57915698, "comment_id": 102265363, "body": "I just updated my original post.  Looping through the record set will NOT be faster.  There is no point in doing this task in chunks of 1000.  That&#39;s only for VERY large data loads where everything can&#39;t be stored in memory in one go."}, {"owner": {"reputation": 975, "user_id": 520691, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d70d844946b5623cf0fcac2640b2665d?s=128&d=identicon&r=PG", "display_name": "Andrew Jens", "link": "https://stackoverflow.com/users/520691/andrew-jens"}, "edited": false, "score": 0, "creation_date": 1611898311, "post_id": 57915698, "comment_id": 116603176, "body": "Thanks for you first example. I had to make the insert something more like: INSERT INTO [odbc;Driver={SQL Server};Server=Your_Server_Name;Database=Northwind].[TBL]"}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 1, "last_activity_date": 1568378631, "last_edit_date": 1568378631, "creation_date": 1568331821, "answer_id": 57915698, "question_id": 57893841, "link": "https://stackoverflow.com/questions/57893841/excel-vba-inserting-1000-rows-at-a-time-to-sql-server/57915698#57915698", "title": "Excel VBA - Inserting 1000 rows at a time to sql server", "body": "<p>Great point!  Bulk Insert is the fastest option out there.  You can use Excel for this, of course, but that's a very, very, very sub-optimal solution.  If you just want to get it done quickly, and easily, save the Excel file as a CSV file, and run the code below.</p>\n\n<pre><code>BULK\nINSERT listcustomer\nFROM 'c:\\your_file.csv'\nWITH\n(\nFIELDTERMINATOR = ',',\nROWTERMINATOR = '\\n'\n)\nGO\n</code></pre>\n\n<p>If Bulk Insert is not an option for you, consider the two solutions below.</p>\n\n<p>Either.</p>\n\n<pre><code>Sub UpdateTable()\n\n    Dim cnn As Object\n    Dim wbkOpen As Workbook\n    Dim objfl As Variant\n    Dim rngName As Range\n    Workbooks.Open \"C:\\Users\\Excel\\Desktop\\Excel_to_SQL_Server.xls\"\n    Set wbkOpen = ActiveWorkbook\n    Sheets(\"Sheet1\").Select\n    Set rngName = Range(Range(\"A1\"), Range(\"A1\").End(xlToLeft).End(xlDown))\n    rngName.Name = \"TempRange\"\n    strFileName = wbkOpen.FullName\n    Set cnn = CreateObject(\"ADODB.Connection\")\n    cnn.Open \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; strFileName &amp; \";Extended Properties=\"\"Excel 12.0 Xml;HDR=Yes\"\";\"\n    nSQL = \"INSERT INTO [odbc;Driver={SQL Server};Server=Your_Server_Name;Database=[Northwind].[dbo].[TBL]]\"\n    nJOIN = \" SELECT * from [TempRange]\"\n    cnn.Execute nSQL &amp; nJOIN\n    MsgBox \"Uploaded Successfully\"\n    wbkOpen.Close\n    Set wbkOpen = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Or.</p>\n\n<pre><code>Sub InsertInto()\n\n'Declare some variables\nDim cnn As adodb.Connection\nDim cmd As adodb.Command\nDim strSQL As String\n\n'Create a new Connection object\nSet cnn = New adodb.Connection\n\n'Set the connection string\ncnn.ConnectionString = \"Your_Server_Name;Database=Northwind;Trusted_Connection=True;\"\n\n'Create a new Command object\nSet cmd = New adodb.Command\n\n'Open the connection\ncnn.Open\n'Associate the command with the connection\ncmd.ActiveConnection = cnn\n\n'Tell the Command we are giving it a bit of SQL to run, not a stored procedure\ncmd.CommandType = adCmdText\n\n'Create the SQL\nstrSQL = \"UPDATE TBL SET JOIN_DT = 2013-01-13 WHERE EMPID = 2\"\n\n'Pass the SQL to the Command object\ncmd.CommandText = strSQL\n\n'Open the Connection to the database\ncnn.Open\n\n'Execute the bit of SQL to update the database\ncmd.Execute\n\n'Close the connection again\ncnn.Close\n\n'Remove the objects\nSet cmd = Nothing\nSet cnn = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5697809, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206250393193667/picture?type=large", "display_name": "DickTaid81", "link": "https://stackoverflow.com/users/5697809/dicktaid81"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1930, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1596608878, "creation_date": 1568221560, "last_edit_date": 1568281629, "question_id": 57893841, "link": "https://stackoverflow.com/questions/57893841/excel-vba-inserting-1000-rows-at-a-time-to-sql-server", "title": "Excel VBA - Inserting 1000 rows at a time to sql server", "body": "<p>I'm using the VBA code below to import data from my Excel table to SQL server. The code is inserting one row at a time and my tables contains thousands of rows.</p>\n\n<p>To improve the speed of the import I want to import 1.000 rows at a time. How can I modify the code to insert 1.000 rows for each excecution?</p>\n\n<p>I am not very skilled within VBA and found the code on this URL: <a href=\"http://tomaslind.net/2013/12/26/export-data-excel-to-sql-server/\" rel=\"nofollow noreferrer\">http://tomaslind.net/2013/12/26/export-data-excel-to-sql-server/</a></p>\n\n<pre><code>Sub Button1_Click()\n\n    Dim conn As New ADODB.Connection\n    Dim iRowNo As Integer\n    Dim sCustomerId, sFirstName, sLastName As String\n\n    With Sheets(\"Sheet1\")\n\n        'Open a connection to SQL Server\n        conn.Open \"Provider=SQLOLEDB;Data Source=MSI\\SQL2016;Initial Catalog=ExcelDemo;Integrated Security=SSPI;\"\n\n        'Skip the header row\n        iRowNo = 2\n\n        'Loop until empty cell in CustomerId\n        Do Until .Cells(iRowNo, 1) = \"\"\n            sCustomerId = .Cells(iRowNo, 1)\n            sFirstName = .Cells(iRowNo, 2)\n            sLastName = .Cells(iRowNo, 3)\n\n            'Generate and execute sql statement to import the excel rows to SQL Server table\n            conn.Execute \"insert into dbo.CustomersStage (CustomerId, FirstName, LastName) values ('\" &amp; sCustomerId &amp; \"', '\" &amp; sFirstName &amp; \"', '\" &amp; sLastName &amp; \"')\"\n\n            iRowNo = iRowNo + 1\n        Loop\n\n        conn.Execute \"EXEC dbo.MergeCustomers\"\n\n        MsgBox \"Customers imported.\"\n\n        conn.Close\n        Set conn = Nothing\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1568224652, "post_id": 57893558, "comment_id": 102210321, "body": "You could use a dictionary."}], "answers": [{"comments": [{"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "edited": false, "score": 0, "creation_date": 1568289733, "post_id": 57895818, "comment_id": 102232463, "body": "Many thanks for the answer. Just a couple of question: Is there any difference (in this case) in using Early vs. Late binding for the dictionary object? For the property procedure,what is the difference between Get and Let in this case?"}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "reply_to_user": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "edited": false, "score": 1, "creation_date": 1568290096, "post_id": 57895818, "comment_id": 102232662, "body": "It is generally a good idea to use early binding if you can, the reference would be Microsoft Scripting Runtime. Get allows you to pull the value from the class, let or set if it was an object allows you to place the value into the class."}, {"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "edited": false, "score": 0, "creation_date": 1568290385, "post_id": 57895818, "comment_id": 102232827, "body": "Thank you, I will take a look at the reference. One last thing: I am trying to run it, and am getting a &quot;User defined obj not defined&quot; at the <code>Dim dataobj As cls_issuedata</code>, is it because I am placing the call module on the wrong place?"}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "reply_to_user": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "edited": false, "score": 1, "creation_date": 1568290474, "post_id": 57895818, "comment_id": 102232889, "body": "ohh place the class code into a class module and name the module cls_issuedata."}], "tags": [], "owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "is_accepted": true, "score": 1, "last_activity_date": 1568230965, "creation_date": 1568230965, "answer_id": 57895818, "question_id": 57893558, "link": "https://stackoverflow.com/questions/57893558/sum-of-values-inside-an-array-if-identifier-is-identical/57895818#57895818", "title": "Sum of values inside an array if identifier is identical", "body": "<p>This uses a dictionary and a class. All the comparisons are done in the class. It creates a new sheet with the data so you can see what it is doing before you erase your data.</p>\n\n<p>Here is the module:</p>\n\n<pre><code>Option Explicit\n\nSub test()\nDim typedict As Object\nDim ws As Worksheet\nDim iter As Long\nDim lr As Long\nDim i As Long\nDim dataobj As cls_issuedata\nDim key As Variant\n\nSet ws = ThisWorkbook.Sheets(\"Sheet1\")\nSet typedict = CreateObject(\"Scripting.Dictionary\")\nWith ws\n    lr = .Cells(.Rows.Count, 1).End(xlUp).Row\n    For i = 2 To lr\n        If Not typedict.exists(.Cells(i, 2).Value) Then ' New Values\n            Set dataobj = New cls_issuedata\n            dataobj.name = .Cells(i, 1).Value\n            dataobj.val = .Cells(i, 3).Value\n            dataobj.clevel1 = .Cells(i, 4).Value\n            dataobj.plevel1 = .Cells(i, 5).Value\n            dataobj.clevel2 = .Cells(i, 6).Value\n            dataobj.plevel2 = .Cells(i, 7).Value\n            typedict.Add .Cells(i, 2).Value, dataobj\n        Else 'Potential Overwriting of Old Values\n            typedict(.Cells(i, 2).Value).name = .Cells(i, 1).Value\n            typedict(.Cells(i, 2).Value).val = .Cells(i, 3).Value\n            typedict(.Cells(i, 2).Value).clevel1 = .Cells(i, 4).Value\n            typedict(.Cells(i, 2).Value).plevel1 = .Cells(i, 5).Value\n            typedict(.Cells(i, 2).Value).clevel2 = .Cells(i, 6).Value\n            typedict(.Cells(i, 2).Value).plevel2 = .Cells(i, 7).Value\n        End If\n    Next\nEnd With\n\nSet ws = ThisWorkbook.Worksheets.Add\nWith ws ' New Sheet\n    .name = \"NEW\"\n    i = 2\n    For Each key In typedict.keys 'Get IDs\n        .Cells(i, 1).Value = typedict(key).name\n        .Cells(i, 2).Value = key\n        .Cells(i, 3).Value = typedict(key).val\n        .Cells(i, 4).Value = typedict(key).clevel1\n        .Cells(i, 5).Value = typedict(key).plevel1\n        .Cells(i, 6).Value = typedict(key).clevel2\n        .Cells(i, 7).Value = typedict(key).plevel2\n        i = i + 1\n    Next\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>And here is the class module, I named it cls_issuedata:</p>\n\n<pre><code>Option Explicit\nPrivate pname As String\nPrivate pval As Long\nPrivate pclevel1 As Long\nPrivate pplevel1 As Long\nPrivate pclevel2 As Long\nPrivate pplevel2 As Long\n\nPublic Property Get name() As String\n    name = pname\nEnd Property\n\nPublic Property Let name(lname As String)\n    If pname = \"\" Then\n        pname = lname\n    End If\n\nEnd Property\n\nPublic Property Get clevel1() As String\n    clevel1 = pclevel1\nEnd Property\n\nPublic Property Let clevel1(lclevel1 As String)\n    If Not lclevel1 = \"\" Then\n        If lclevel1 &gt; pclevel1 Then\n            pclevel1 = lclevel1\n        End If\n    End If\nEnd Property\n\nPublic Property Get plevel1() As String\n    plevel1 = pplevel1\nEnd Property\n\nPublic Property Let plevel1(lplevel1 As String)\n    If Not lplevel1 = \"\" Then\n        If lplevel1 &gt; pplevel1 Then\n            pplevel1 = lplevel1\n        End If\n    End If\nEnd Property\n\nPublic Property Get clevel2() As String\n    clevel2 = pclevel2\nEnd Property\n\nPublic Property Let clevel2(lclevel2 As String)\n    If Not lclevel2 = \"\" Then\n        If lclevel2 &gt; pclevel2 Then\n            pclevel2 = lclevel2\n        End If\n    End If\nEnd Property\n\nPublic Property Get plevel2() As String\n    plevel2 = pplevel2\nEnd Property\n\nPublic Property Let plevel2(lplevel2 As String)\n    If Not lplevel2 = \"\" Then\n        If lplevel2 &gt; pplevel2 Then\n            pplevel2 = lplevel2\n        End If\n    End If\nEnd Property\n\nPublic Property Get val() As Long\n    val = pval\nEnd Property\n\nPublic Property Let val(lval As Long)\n    If pval = 0 Then\n        pval = lval\n    Else\n        pval = pval + lval\n    End If\nEnd Property\n\nPublic Sub initialize()\n    pname = \"\"\n    pval = 0\n    pclevel1 = 0\n    pplevel1 = 0\n    pclevel2 = 0\n    pplevel2 = 0\n    pchrval = 0\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 57895818, "answer_count": 1, "score": 1, "last_activity_date": 1568281617, "creation_date": 1568220258, "last_edit_date": 1568281617, "question_id": 57893558, "link": "https://stackoverflow.com/questions/57893558/sum-of-values-inside-an-array-if-identifier-is-identical", "title": "Sum of values inside an array if identifier is identical", "body": "<p><strong>Scenario:</strong> I am trying to build a sub that:\n - Gets data from a worksheet\n - Sums values of a column if the id is the same\n - Check the last columns for a value decrease (from previous to current) and retrieve the one that changed the most\n - Delete duplicate columns</p>\n\n<p><strong>Data:</strong></p>\n\n<pre><code>+----------+---------+-------+----------------+-----------------+----------------+-----------------+\n| Name1    | ID1     | Value | Current Level1 | Previous Level1 | Current Level2 | Previous Level2 |\n+----------+---------+-------+----------------+-----------------+----------------+-----------------+\n| Issue 1  | IDTYPE1 | 100   | 9              | 10              | 9              | 11              |\n+----------+---------+-------+----------------+-----------------+----------------+-----------------+\n| Issue 2  | IDTYPE2 | 500   | 10             | 14              | 8              | 14              |\n+----------+---------+-------+----------------+-----------------+----------------+-----------------+\n| Issue 2  | IDTYPE2 | 244   | 9              | 14              | 9              | 14              |\n+----------+---------+-------+----------------+-----------------+----------------+-----------------+\n| Issue 2a | IDTYPE2 | 378   |                |                 | 9              | 14              |\n+----------+---------+-------+----------------+-----------------+----------------+-----------------+\n| Issue 3a | IDTYPE3 | 343   | 3              | 9               |                |                 |\n+----------+---------+-------+----------------+-----------------+----------------+-----------------+\n| Issue 3  | IDTYPE3 | 127   | 5              | 4               | 4              | 5               |\n+----------+---------+-------+----------------+-----------------+----------------+-----------------+\n| Issue 4s | IDTYPE4 | 213   |                |                 | 4              | 5               |\n+----------+---------+-------+----------------+-----------------+----------------+-----------------+\n| Issue 4a | IDTYPE4 | 241   | 3              | 5               | 4              | 5               |\n+----------+---------+-------+----------------+-----------------+----------------+-----------------+\n</code></pre>\n\n<p><strong>Output:</strong> In theory the output will have the same columns, but duplicate IDs would be aggregated into a single row. And the data for the \"Level\" columns, would be, for that single row, the lowest value available in the \"Current1\" (irrespective of each row), aggregated with the lowest level of \"Current2\" (each associated with their respective \"Previous\". The name column is to have the first name for that ID that appeared (for \"IDTYPE4\" it would be \"Issue 4s\").</p>\n\n<p>Output example:</p>\n\n<pre><code>+----------+---------+-------+----------------+-----------------+----------------+-----------------+\n| Name1    | ID1     | Value | Current Level1 | Previous Level1 | Current Level2 | Previous Level2 |\n+----------+---------+-------+----------------+-----------------+----------------+-----------------+\n| Issue 1  | IDTYPE1 | 100   | 9              | 10              | 9              | 11              |\n+----------+---------+-------+----------------+-----------------+----------------+-----------------+\n| Issue 2  | IDTYPE2 | 1122  | 9              | 14              | 8              | 14              |\n+----------+---------+-------+----------------+-----------------+----------------+-----------------+\n| Issue 3  | IDTYPE3 | 470   | 3              | 9               | 4              | 5               |\n+----------+---------+-------+----------------+-----------------+----------------+-----------------+\n| Issue 4s | IDTYPE4 | 454   | 3              | 5               | 4              | 5               |\n+----------+---------+-------+----------------+-----------------+----------------+-----------------+\n</code></pre>\n\n<p><strong>Question:</strong> I am trying to do this in form a loop inside an array, as per the code below. But I cannot think of a way to sum up the values if the IDs are the same and still account for the change in \"Level\". Is there an easier way to do this?</p>\n\n<p><strong>Obs.</strong> I tried the SumIf function, but could not properly place it inside the loop.</p>\n\n<p><strong>Code so far:</strong></p>\n\n<pre><code>Dim procdupArray  as Variant\nDim loopvar1 as Integer\nDim w as Workbook\nDim valueSum as Long\nSet w = ThisWorkbook\nprocdupArray = w.Worksheets(\"Sheet1\").UsedRange\nFor loopvar1 = 2 To UBound(procdupArray, 1) - 1\n    If procdupArray(loopvar1, 2) &lt;&gt; procdupArray(loopvar1 + 1, 2) Then\n        w.Worksheets(\"Sheet2\").Cells(loopvar1, 1) = procdupArray(loopvar1, 1)\n        w.Worksheets(\"Sheet2\").Cells(loopvar1, 2) = procdupArray(loopvar1, 2)\n        w.Worksheets(\"Sheet2\").Cells(loopvar1, 3) = procdupArray(loopvar1, 3)\n        w.Worksheets(\"Sheet2\").Cells(loopvar1, 4) = procdupArray(loopvar1, 4)\n        w.Worksheets(\"Sheet2\").Cells(loopvar1, 5) = procdupArray(loopvar1, 5)\n        w.Worksheets(\"Sheet2\").Cells(loopvar1, 5) = procdupArray(loopvar1, 5)\n        w.Worksheets(\"Sheet2\").Cells(loopvar1, 5) = procdupArray(loopvar1, 5)\n\n    Else\n        valueSum = procdupArray(loopvar1, 7) + procdupArray(loopvar1 + 1, 7)\n        If procdupArray(loopvar1, 4) &lt; procdupArray(loopvar1 + 1, 4) then\n            w.Worksheets(\"Sheet2\").Cells(loopvar1, 4) = procdupArray(loopvar1, 4)\n        End if\n        If procdupArray(loopvar1, 5) &lt; procdupArray(loopvar1, 5) then\n            w.Worksheets(\"Sheet2\").Cells(loopvar1, 5) = procdupArray(loopvar1, 5)\n        End if\n        If procdupArray(loopvar1, 6) &lt; procdupArray(loopvar1, 6) then\n            w.Worksheets(\"Sheet2\").Cells(loopvar1, 6) = procdupArray(loopvar1, 6)\n        End if\n        If procdupArray(loopvar1, 6) &lt; procdupArray(loopvar1, 6) then\n            w.Worksheets(\"Sheet2\").Cells(loopvar1, 6) = procdupArray(loopvar1, 6)\n        End if\n     End if\nNext loopvar1 \n</code></pre>\n\n<p><strong>Obs2:</strong> Another Problem is that this does not properly take into account if there are more than two rows for the same ID.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 4, "creation_date": 1568220550, "post_id": 57893426, "comment_id": 102208604, "body": "NO, they are alphabetical."}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 4, "creation_date": 1568222023, "post_id": 57893426, "comment_id": 102209227, "body": "Everything in intellisense is alphabetical"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1568222196, "post_id": 57893426, "comment_id": 102209306, "body": "The order of the members in IntelliSense / autocomplete list is irrelevant... type &quot;w&quot; for white, &quot;b&quot; for black..."}, {"owner": {"reputation": 361, "user_id": 11738627, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sVrcM144Qb8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdf8GVfYBMmDcu1kPwkGrFSZUDOVQ/photo.jpg?sz=128", "display_name": "6diegodiego9", "link": "https://stackoverflow.com/users/11738627/6diegodiego9"}, "edited": false, "score": 0, "creation_date": 1568227423, "post_id": 57893426, "comment_id": 102211442, "body": "Mathieu, the order is not irrelevant: if you type &quot;colors.&quot; and then the TAB key it writes the first element (black).  I&#39;d prefer to put the most used one first for writing it faster."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1569435131, "post_id": 57893426, "comment_id": 102599659, "body": "Sorry, didn&#39;t get that ping (use @ to ping someone!) - it <i>is</i> irrelevant. <code>colors.w</code> completes to <code>colors.white</code>, <code>colors.b</code> completes to <code>colors.black</code>. Ctrl+Space is your friend, not just TAB."}], "answers": [{"comments": [{"owner": {"reputation": 361, "user_id": 11738627, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sVrcM144Qb8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdf8GVfYBMmDcu1kPwkGrFSZUDOVQ/photo.jpg?sz=128", "display_name": "6diegodiego9", "link": "https://stackoverflow.com/users/11738627/6diegodiego9"}, "edited": false, "score": 0, "creation_date": 1568227488, "post_id": 57894889, "comment_id": 102211475, "body": "I&#39;d consider this as best answer if there isn&#39;t a better one"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "reply_to_user": {"reputation": 361, "user_id": 11738627, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sVrcM144Qb8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdf8GVfYBMmDcu1kPwkGrFSZUDOVQ/photo.jpg?sz=128", "display_name": "6diegodiego9", "link": "https://stackoverflow.com/users/11738627/6diegodiego9"}, "edited": false, "score": 0, "creation_date": 1568229112, "post_id": 57894889, "comment_id": 102212235, "body": "Intellisense alphabetizes everything.  All we can do is write workarounds."}], "tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": true, "score": 2, "last_activity_date": 1568226455, "creation_date": 1568226455, "answer_id": 57894889, "question_id": 57893426, "link": "https://stackoverflow.com/questions/57893426/intellisense-and-enums/57894889#57894889", "title": "IntelliSense and enums", "body": "<p>You could prefix the values to create you custom list order.</p>\n\n<p><a href=\"https://i.stack.imgur.com/yBHts.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yBHts.png\" alt=\"Screenshot\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 361, "user_id": 11738627, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sVrcM144Qb8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdf8GVfYBMmDcu1kPwkGrFSZUDOVQ/photo.jpg?sz=128", "display_name": "6diegodiego9", "link": "https://stackoverflow.com/users/11738627/6diegodiego9"}, "edited": false, "score": 0, "creation_date": 1570197185, "post_id": 58104456, "comment_id": 102848355, "body": "if I write &quot;colors.b&quot;, both TAB or Ctrl+Space has the same effect of completing with &quot;lack&quot;."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 361, "user_id": 11738627, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sVrcM144Qb8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdf8GVfYBMmDcu1kPwkGrFSZUDOVQ/photo.jpg?sz=128", "display_name": "6diegodiego9", "link": "https://stackoverflow.com/users/11738627/6diegodiego9"}, "edited": false, "score": 0, "creation_date": 1570197489, "post_id": 58104456, "comment_id": 102848494, "body": "@6diegodiego9 no. it only has the same effect because there&#39;s only one enum member that starts with a <code>B</code>. If you had <code>Black</code>, <code>Blue</code>, and <code>Brown</code>, TAB completes with the alphabetically-first item; and Ctrl+Space just brings up the completion list."}, {"owner": {"reputation": 361, "user_id": 11738627, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sVrcM144Qb8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdf8GVfYBMmDcu1kPwkGrFSZUDOVQ/photo.jpg?sz=128", "display_name": "6diegodiego9", "link": "https://stackoverflow.com/users/11738627/6diegodiego9"}, "edited": false, "score": 0, "creation_date": 1570197652, "post_id": 58104456, "comment_id": 102848580, "body": "I can&#39;t reproduce it.  I added &quot;Blue&quot; and while TAB completes it with the first, Ctrl+Space has no effect at all, being the completion list already visible"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 361, "user_id": 11738627, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sVrcM144Qb8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdf8GVfYBMmDcu1kPwkGrFSZUDOVQ/photo.jpg?sz=128", "display_name": "6diegodiego9", "link": "https://stackoverflow.com/users/11738627/6diegodiego9"}, "edited": false, "score": 0, "creation_date": 1570197799, "post_id": 58104456, "comment_id": 102848656, "body": "Regardless, the point is that a poorly-tooled IDE isn&#39;t a valid excuse for butchering your code with such ugly and confusing work-arounds. You write the code once, and then read it many times over - the split-second you &quot;waste&quot; picking the correct identifier isn&#39;t worth the multiple split-seconds you, future you, and future maintainers are going to waste making sense of a useless prefixing scheme. If you really like prefixes, know that COM-compliant enum member names start with a 2/3-letter lowercase preffix that acts as a namespace; that&#39;s why we have <code>vbXxxxx</code> and <code>msoXxxxx</code> and <code>xlXxxxx</code>."}, {"owner": {"reputation": 361, "user_id": 11738627, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sVrcM144Qb8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdf8GVfYBMmDcu1kPwkGrFSZUDOVQ/photo.jpg?sz=128", "display_name": "6diegodiego9", "link": "https://stackoverflow.com/users/11738627/6diegodiego9"}, "edited": false, "score": 0, "creation_date": 1570197885, "post_id": 58104456, "comment_id": 102848698, "body": "Anyway, the speed advantage of TAB over Ctrl+Space is that you can just write &quot;colors.&quot; and complete it with the first option in the list.  Furthermore, another advantage with controlling what&#39;s the first value in the list is, (by prefixing,) is in having a default/most-used value shown first in the list.  I understand your point that prefixing could distract when reading but as I&#39;m the only programmer looking at my scripts, I believe that my ratio of importance is &gt;50% writing and &lt;50% reading..."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 361, "user_id": 11738627, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sVrcM144Qb8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdf8GVfYBMmDcu1kPwkGrFSZUDOVQ/photo.jpg?sz=128", "display_name": "6diegodiego9", "link": "https://stackoverflow.com/users/11738627/6diegodiego9"}, "edited": false, "score": 0, "creation_date": 1570198190, "post_id": 58104456, "comment_id": 102848845, "body": "You do your thing, I give up. FWIW I&#39;m the only person looking at my code too, as is the vast majority of anyone writing VBA code. The IDE and its [lack of] tooling should have zero impact on how you name things. I&#39;ll ping you here when <a href=\"http://www.github.com/rubberduck-vba/Rubberduck\" rel=\"nofollow noreferrer\">Rubberduck</a> implements intellisense enhancements that make your prefixing scheme completely useless."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 0, "last_activity_date": 1569435750, "creation_date": 1569435750, "answer_id": 58104456, "question_id": 57893426, "link": "https://stackoverflow.com/questions/57893426/intellisense-and-enums/58104456#58104456", "title": "IntelliSense and enums", "body": "<blockquote>\n  <p><em>if you type \"colors.\" and then the TAB key it writes the first element (black). I'd prefer to put the most used one first for writing it faster.</em></p>\n</blockquote>\n\n<p>Don't use <kbd>TAB</kbd> for completion then. Type <code>colors.b</code> then hit <kbd>Ctrl</kbd>+<kbd>Space</kbd>, and it'll either complete to <code>Black</code> (if it's the only member that begins with a B) or moves the autocompletion list selection to <code>Black</code> (or whichever alphabetically comes first), given you also have <code>Blue</code>, and <code>Brown</code>.</p>\n\n<p>Using prefixes merely to control the sort order of members in the IDE's autocompletion list is a rather arbitrary reason for not using clear identifier names and resorting to funky prefixing schemes.</p>\n\n<p>You're not writing code for it to be merely executed. You're reading code for it to be <em>read</em>, and maintained.</p>\n\n<p>\"It helps me type faster\" is actively harmful if your successor has to squint and stop and think and try to make sense of your prefixing scheme - it's distracting, and slows down <em>reading</em> the code.</p>\n\n<p>Programming is <em>at a minimum</em>, 80% reading, <em>not</em> writing. Learn to type faster instead of making <em>reading</em> harder than it needs to be.</p>\n"}], "owner": {"reputation": 361, "user_id": 11738627, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sVrcM144Qb8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdf8GVfYBMmDcu1kPwkGrFSZUDOVQ/photo.jpg?sz=128", "display_name": "6diegodiego9", "link": "https://stackoverflow.com/users/11738627/6diegodiego9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 57894889, "answer_count": 2, "score": 0, "last_activity_date": 1569435750, "creation_date": 1568219690, "last_edit_date": 1568226839, "question_id": 57893426, "link": "https://stackoverflow.com/questions/57893426/intellisense-and-enums", "title": "IntelliSense and enums", "body": "<p>Consider this enum:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Enum colors\n    white = 0\n    black = 1\nEnd Enum\n</code></pre>\n\n<p><br>\nIntelliSense shows black and then white while I'd prefer to see white and then black.<br>\nI don't care about the numbers.</p>\n\n<p>Is there a way to customize the enum sequence of the items shown by IntelliSense?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4893344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22e44dd53b9b0b42fbff790e937eda7f?s=128&d=identicon&r=PG&f=1", "display_name": "Mohit", "link": "https://stackoverflow.com/users/4893344/mohit"}, "edited": false, "score": 0, "creation_date": 1568288842, "post_id": 57894342, "comment_id": 102231937, "body": "thanks for the response -  still cant understand why work with 2010- also, I have tried loading class first and then other sheet where cls is referenced.  But still fails?"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1568224008, "creation_date": 1568224008, "answer_id": 57894342, "question_id": 57893286, "link": "https://stackoverflow.com/questions/57893286/clas-variable-declaration-not-working-to-with-dynamic-class-loading-in-vba/57894342#57894342", "title": "Clas variable declaration not working to with dynamic class loading in VBA,", "body": "<p>You can't early-bind to something that's only going to exist at run-time, <em>by definition</em> - there's no way that could have worked:</p>\n\n<blockquote>\n<pre><code>Public Myclassone As cls_one\n</code></pre>\n</blockquote>\n\n<p>If <code>cls_one</code> doesn't exist at compile-time, then the module can't be compiled.</p>\n\n<blockquote>\n  <p><em>this piece of code works fine with 2010</em></p>\n</blockquote>\n\n<p>No. This piece of code works fine if it's not in any execution path that involves the module declaring a public variable of a type that doesn't exist... regardless of what version the host application is (this behavior is purely VBA, nothing to do with Excel).</p>\n\n<p>That's kind of a hack though: a VBA project will not compile (through Debug -> Compile), but will happily run anyway if the entry point doesn't involve loading the module: that's because of the <em>somewhat-interpreted</em> nature of VBA.</p>\n\n<p>Proof:</p>\n\n<p><strong>Module1</strong></p>\n\n<pre><code>Option Explicit\nPublic foo As Something '&lt;~ undefined, won't compile\n</code></pre>\n\n<p><strong>Module2</strong></p>\n\n<pre><code>Option Explicit\n\nPublic Sub Test()\n    Debug.Print \"I can run even if the project doesn't compile!\"\nEnd Sub\n</code></pre>\n\n<p>You can run <code>Module2.Test</code> regardless of whether the project compiles, because <code>Module1</code> isn't in the picture at all. Now change <code>Module2.Test</code> to this:</p>\n\n<pre><code>Public Sub Test()\n    foo.DoStuff '&lt;~ expect fireworks\nEnd Sub\n</code></pre>\n\n<p>When I ran this, Excel just outright crashed.</p>\n\n<p>So the bottom line is this: you <em>can</em> reference a non-existing class in a module. The project won't be compilable, but if no code references the non-existing class then the project will be executable anyway, and the non-compilable module can then be executed in another execution context (i.e. from a separate entry point), after the class is added.</p>\n\n<p>I would not recommend using non-compilable code for anything remotely important though, since doing that takes away the only compile-time validation you have in the VBE for your code - consider reviewing <a href=\"http://www.rubberduckvba.com/\" rel=\"nofollow noreferrer\">Rubberduck</a> inspections in that case (several inspections flag run-time error situations statically).</p>\n\n<p>A better, more viable solution would be to reconsider the dependency chain and the overall approach.</p>\n"}], "owner": {"reputation": 25, "user_id": 4893344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22e44dd53b9b0b42fbff790e937eda7f?s=128&d=identicon&r=PG&f=1", "display_name": "Mohit", "link": "https://stackoverflow.com/users/4893344/mohit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568224008, "creation_date": 1568219139, "last_edit_date": 1568222378, "question_id": 57893286, "link": "https://stackoverflow.com/questions/57893286/clas-variable-declaration-not-working-to-with-dynamic-class-loading-in-vba", "title": "Clas variable declaration not working to with dynamic class loading in VBA,", "body": "<p>Any help with dynamically loading of classes /variables in VBA? </p>\n\n<p>I have an excel sheet and other few dependent sheets, depending on the requirement, on click of a button I am loading other sheets.</p>\n\n<p>Say Main workbook -> Loads <code>sheet1.xlam</code> and related classes ( cls_one.cls) on click of button.</p>\n\n<p>I am using below code to load <code>sheet1.xlam and  cls_one.cls</code></p>\n\n<p>Step 1: <code>Load Main.xlsm</code></p>\n\n<p>Step 2 load - <code>sheet1.xlsm</code></p>\n\n<pre><code>    Set addedWs = ActiveWorkbook.Sheets.Add(Type:=path,             after:=ActiveWorkbook.Sheets(ActiveWorkbook.Sheets.count))\n</code></pre>\n\n<p>Step 3: Load <code>Cls_one.cls</code> dynamically using the below method.</p>\n\n<pre><code>    Public Function InsertClass(ByRef oWB As Workbook, ByVal className As String, ByVal filePath As String, Optional bUAT As Boolean = False) As Boolean\n\n    On Error GoTo Errhandler\n\n    oWB.VBProject.VBComponents.Import filePath\n    InsertClass = True\n\n    Exit Function\nErrhandler:\n    If err &lt;&gt; 0 Then\n        If Not bUAT Then\n            MsgBox (err.Description)\n        End If\n        err.Clear\n    End If\n    InsertClass = False\nEnd Function\n</code></pre>\n\n<p>Above code works fine, however, I have a reference to <code>cls_one</code> in <code>sheet1.xlsm</code> which never works, on loading or give error Undefined object error. </p>\n\n<p><code>Public Myclassone As cls_one</code> </p>\n\n<p>this variable declaration is in <code>sheet1.xlsm</code>.</p>\n\n<p>I tried flipping steps loading class first and <code>sheet1.xlam</code> next, but still getting the same error with Excel 2013, this piece of code works fine with 2010.</p>\n\n<p>Trying to understand what is the best way to reference dynamically loaded classes in forms or other classes? </p>\n\n<p>Also, I tried changing error preferences in tools -> Options -> Break on Unhandledexception.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 7, "last_activity_date": 1568227515, "last_edit_date": 1568227515, "creation_date": 1568219051, "answer_id": 57893272, "question_id": 57893155, "link": "https://stackoverflow.com/questions/57893155/excel-vba-how-to-write-column-name-with-commercial-at-in-it/57893272#57893272", "title": "Excel VBA: How to write column name with commercial at &quot;@&quot; in it", "body": "<p>You can do it like this:</p>\n\n<pre><code>s = ActiveSheet.listobjects(\"myTable\").listcolumns(\"active @ mail\").Range.Column\n</code></pre>\n\n<p>See also <a href=\"https://support.office.com/en-us/article/using-structured-references-with-excel-tables-f5ed2452-2337-4f71-bed3-c8ae6d2b276e\" rel=\"nofollow noreferrer\">https://support.office.com/en-us/article/using-structured-references-with-excel-tables-f5ed2452-2337-4f71-bed3-c8ae6d2b276e</a>  for how to escape special characters</p>\n\n<p>So:</p>\n\n<pre><code>s = ActiveSheet.Range(\"myTable[active '@ mail]\").Column\n</code></pre>\n\n<p>will also work.</p>\n\n<p><code>@</code> has a special meaning in structured references, so you can't use it in a column name without escaping it with <code>'</code> (a single quote)</p>\n"}], "owner": {"reputation": 1168, "user_id": 9235421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afc6f04ea4fa5b8303e2e3897ac1d0ef?s=128&d=identicon&r=PG&f=1", "display_name": "Zababa", "link": "https://stackoverflow.com/users/9235421/zababa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 57893272, "answer_count": 1, "score": 3, "last_activity_date": 1568229394, "creation_date": 1568218517, "question_id": 57893155, "link": "https://stackoverflow.com/questions/57893155/excel-vba-how-to-write-column-name-with-commercial-at-in-it", "title": "Excel VBA: How to write column name with commercial at &quot;@&quot; in it", "body": "<p>I am trying to find out how I should deal with a named column in <code>myTable</code> which contains a commercial at (<code>@</code>) in its name, e.g. <code>active @ mail</code>. This code is supposed to print the column number in the Immediate output window:</p>\n\n<pre><code>Sub teststring()\n    Dim s As String\n    s = ActiveSheet.Range(\"myTable[active @ mail]\").Column\n    Debug.Print s\nEnd Sub\n</code></pre>\n\n<p>but it fails. Using <code>.Range(\"myTable[active\" &amp; Chr(64) \"&amp; mail]\")</code> fails as well.</p>\n"}, {"tags": ["excel", "vba", "copy-paste", "transpose"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1568219774, "post_id": 57893121, "comment_id": 102208259, "body": "Can you show the loop?  I assume you have an if in there or you would just transpose the whole range at once."}, {"owner": {"reputation": 1, "user_id": 11907919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a7815439b1420fc45c0708b34ada6b1?s=128&d=identicon&r=PG&f=1", "display_name": "dinodan", "link": "https://stackoverflow.com/users/11907919/dinodan"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1568220793, "post_id": 57893121, "comment_id": 102208731, "body": "The code is pretty sizeable, and pretty ugly its something i picked up from m predecessor.  but i will add it to the above."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1568221046, "post_id": 57893121, "comment_id": 102208829, "body": "Then create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that shows the issue so we can show you a better method.  But to speed it up the rule of thumb is to load everything in a variant array and loop that filling another variant array, then output that array in bulk to the worksheet."}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1568251776, "post_id": 57893121, "comment_id": 102218089, "body": "Since the code could not be tested and is heavily dependent on the actual data, it is difficult to foresee any method to speed up its operation. However since it search (loop) for each values corresponding to each <code>CFUnit</code> and <code>CFScenNum</code> and assuming 100 Ks of rows involved in that search. these search times could be reduced considerably by using LastRow and <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.find\" rel=\"nofollow noreferrer\">Range. Find method</a>. However before attempting the same may please check if considerable share of total time involved is consumed by these searches."}], "owner": {"reputation": 1, "user_id": 11907919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a7815439b1420fc45c0708b34ada6b1?s=128&d=identicon&r=PG&f=1", "display_name": "dinodan", "link": "https://stackoverflow.com/users/11907919/dinodan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568281610, "creation_date": 1568218401, "last_edit_date": 1568281610, "question_id": 57893121, "link": "https://stackoverflow.com/questions/57893121/how-to-bypass-the-clipboard-while-transposing", "title": "How to bypass the Clipboard while transposing", "body": "<p>I am trying to speed up code that copies a lot of data amount a lot of spreadsheets.  The problem is that I need to copy a range that goes down a row to a range that goes down a column.</p>\n\n<p>I have tried setting the ranges equal to each other, which doesn't work.  I also set the calculation setting to manual. That sped it up some but not as much as I wanted.</p>\n\n<p>This is the current code that I have in the macro</p>\n\n<p><code>CFFile.Sheets(CFTabName).Range(\"B\" &amp; RowIndex &amp; \":CW\" &amp; RowIndex).Copy</code></p>\n\n<p><code>SubmissionFile.Sheets(TargScenTabName).Range(ColumnIndex &amp; \"4\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=True</code></p>\n\n<p>I have tried this code</p>\n\n<pre><code>SubmissionFile.Sheets(TargScenTabName).Range(ColumnIndex &amp; \"4\").Value = CFFile.Sheets(CFTabName).Range(\"B\" &amp; RowIndex &amp; \":CW\" &amp; RowIndex).Value\n</code></pre>\n\n<p>No error, but it takes about 2.5 minutes per file to complete.</p>\n\n<p>Here is the giant ugly code that it is a part of</p>\n\n<pre><code>`Sub TranInsRiskCF()\n\nDim StartTime, EndTime As Double\nStartTime = Now()\nApplication.ScreenUpdating = False\n\nConst BOB_INDICATOR = \".xlsx\"\nConst DOLE_INDICATOR = \".xlsm\"\n\nDim FileName As String\nDim TargTemplatePath As String\nDim CFFolderPath As String\nDim SubmissionFolderPath As String\nDim CFFilePath As String\nDim CFUnit As String\nDim CFDate As String\nDim CFIdentifier As String\nDim CFBOBOrDogTag As String\nDim TargScenTabName As String\nDim CFTabName As String\nDim ColumnIndex As String\n\nDim UnitRow As Integer\nDim ScenRow As Integer\nDim TabNameRow As Integer\nDim RowIndex As Integer\nDim CFScenNum As Integer\n\nDim SubmissionFile As Workbook\nDim CFFile As Workbook\nDim ThisBook As Workbook\nDim SubmissionName As String\n\nSet ThisBook = ActiveWorkbook\nThisBook.Sheets(\"Control\").Activate\n\n'Store Path Information\n\nFileName = Range(\"B5\").Value\nTargTemplatePath = Range(\"B6\").Value\nCFFolderPath = Range(\"B7\").Value\nSubmissionFolderPath = Range(\"B8\").Value\n\n'Start Unit Processing\n\nUnitRow = 12\n\nDo While Range(\"A\" &amp; UnitRow).Value &lt;&gt; \"\"\n\n    CFUnit = Right(Range(\"A\" &amp; UnitRow).Value, 3)\n    CFDate = Range(\"B\" &amp; UnitRow).Value\n    Sheets(\"Tables\").Activate\n\n\n    RowIndex = 2\n    Do While (Range(\"A\" &amp; RowIndex).Value &lt;&gt; CFUnit)\n        RowIndex = RowIndex + 1\n    Loop\n\n    CFIdentifier = Range(\"B\" &amp; RowIndex).Value\n    CFBOBorDOGTag  = Range(\"E\" &amp; RowIndex).Value\n\n    If CFBOBorDOGTag  = BOB_INDICATOR Then\n        If Left(CFUnit, 2) = \"00\" Then\n            CFFilePath = CFFolderPath &amp; \"\\\" &amp; \"CF_ILB_0\" &amp; Right(CFUnit, 1) &amp; \"T_\" &amp; CFIdentifier &amp; \"_\" &amp; CFDate &amp; CFBOBorDOGTag \n        ElseIf Left(CFUnit, 1) = \"0\" Then\n            CFFilePath = CFFolderPath &amp; \"\\\" &amp; \"CF_ILB_\" &amp; Right(CFUnit, 2) &amp; \"T_\" &amp; CFIdentifier &amp; \"_\" &amp; CFDate &amp; CFBOBorDOGTag \n        Else\n            CFFilePath = CFFolderPath &amp; \"\\\" &amp; \"CF_ILB_\" &amp; CFUnit &amp; \"T_\" &amp; CFIdentifier &amp; \"_\" &amp; CFDate &amp; CFBOBorDOGTag \n        End If\n\n    ElseIf CFBOBorDOGTag  = DOLE_INDICATOR Then\n        If Left(CFUnit, 2) = \"00\" Then\n            CFFilePath = CFFolderPath &amp; \"\\\" &amp; \"CF_ILB_0\" &amp; Right(CFUnit, 1) &amp; \"T_\" &amp; CFIdentifier &amp; \"_\" &amp; CFDate &amp; CFBOBorDOGTag \n        ElseIf Left(CFUnit, 1) = \"0\" Then\n            CFFilePath = CFFolderPath &amp; \"\\\" &amp; \"CF_ILB_\" &amp; Right(CFUnit, 2) &amp; \"T_\" &amp; CFIdentifier &amp; \"_\" &amp; CFDate &amp; CFBOBorDOGTag \n        Else\n            CFFilePath = CFFolderPath &amp; \"\\\" &amp; \"CF_ILB_\" &amp; CFUnit &amp; \"T_\" &amp; CFIdentifier &amp; \"_\" &amp; CFDate &amp; CFBOBorDOGTag \n        End If\n    End If\n\n   If Len(Dir(SubmissionFolderPath &amp; \"\\\" &amp; FileName &amp; \"ILB \" &amp; CFUnit &amp; \".xlsm\")) = 0 Then\n        Set SubmissionFile = Workbooks.Open(TargTemplatePath, , ReadOnly:=False)\n        SubmissionName = \"IRM_CF_201906_Template.xlsm\"\n    Else\n        Set SubmissionFile = Workbooks.Open(SubmissionFolderPath &amp; \"\\\" &amp; FileName &amp; \"ILB \" &amp; CFUnit &amp; \".xlsm\", ReadOnly:=False)\n        SubmissionName = FileName &amp; \"ILB \" &amp; CFUnit &amp; \".xlsm\"\n\n    End If\n\n    Set CFFile = Workbooks.Open(CFFilePath, , ReadOnly:=True)\n\n    Application.Calculation = xlCalculationManual\n\n    'Start Scenario Processing\n\n    ThisBook.Sheets(\"Control\").Activate\n\n    ScenRow = 12\n\n\n    Do While Range(\"D\" &amp; ScenRow).Value &lt;&gt; \"\"\n        TargScenTabName = Range(\"E\" &amp; ScenRow).Value\n        CFScenNum = Range(\"D\" &amp; ScenRow).Value\n        CFFile.Sheets(\"Market Risk CFs Output\").Activate\n\n        RowIndex = 3\n        Do While (Range(\"A\" &amp; RowIndex).Value &lt;&gt; CFScenNum)\n            RowIndex = RowIndex + 1\n        Loop\n\n        ThisBook.Sheets(\"Control\").Activate\n\n        TabNameRow = 12\n\n\n            SubmissionFile.Unprotect Password:=\"cashflow1\"\n            SubmissionFile.Sheets(TargScenTabName).Visible = True\n            SubmissionFile.Sheets(TargScenTabName).Unprotect Password:=\"cashflow1\"\n\n\n        Do While Range(\"G\" &amp; TabNameRow).Value &lt;&gt; \"\"\n            CFTabName = Range(\"G\" &amp; TabNameRow).Value\n            ColumnIndex = Range(\"H\" &amp; TabNameRow).Value\n            CFFile.Sheets(CFTabName).Range(\"B\" &amp; RowIndex &amp; \":CW\" &amp; RowIndex).Copy\n\n            'SubmissionFile.Sheets(TargScenTabName).Range(ColumnIndex &amp; \"4\").Value = CFFile.Sheets(CFTabName).Range(\"B\" &amp; RowIndex &amp; \":CW\" &amp; RowIndex).Value\n\n            SubmissionFile.Sheets(TargScenTabName).Range(ColumnIndex &amp; \"4\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=True\n\n            TabNameRow = TabNameRow + 1\n        Loop\n\n        ScenRow = ScenRow + 1\n\n\n    Loop\n\n    With SubmissionFile\n        .Sheets(TargScenTabName).Protect Password:=\"cashflow1\"\n        .Sheets(TargScenTabName).Visible = False\n    End With\n\n    SubmissionFile.Sheets(\"Inputs\").Activate\n    Range(\"C5\").Value = \"Individual Life - Actuary\"\n    Range(\"C6\").Value = \"ILB \" &amp; CFUnit\n\n    ActiveWorkbook.RefreshAll\n\n    'Application.Run \"'\" &amp; SubmissionName &amp; \"'\" &amp; \"!ThisWorkbook.unhidethesheet\"\n    SubmissionFile.Protect Password:=\"cashflow1\"\n\n    Application.DisplayAlerts = False\n    SubmissionFile.SaveAs (SubmissionFolderPath &amp; \"\\\" &amp; FileName &amp; \"ILB \" &amp; CFUnit)\n    SubmissionFile.Close\n    Application.DisplayAlerts = True\n\n    CFFile.Close False\n\n'    SubmissionFile.Close\n\n    UnitRow = UnitRow + 1\n\nApplication.ScreenUpdating = False\n\n\nLoop\n\nEndTime = Now()\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationAutomatic\n\nMsgBox \"Cash Flows Transferred.\" &amp; vbCrLf &amp; vbCrLf &amp; _\n       \"Run Time: \" &amp; Format(StartTime - EndTime, \"hh:mm:ss\")\n\nEnd Sub`\n</code></pre>\n"}, {"tags": ["vba", "internet-explorer"], "comments": [{"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1568218904, "post_id": 57893038, "comment_id": 102207883, "body": "Are you sure a field with this name exists on the specified page? If you browse to the page with a browser, can you see it in the browser&#39;s developer tools?"}, {"owner": {"reputation": 11442, "user_id": 11610186, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HKHsybo6y0o/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdY2OjHwdlmaUkMBZsmKiCkkybzQw/mo/photo.jpg?sz=128", "display_name": "Grzegorz Skibinski", "link": "https://stackoverflow.com/users/11610186/grzegorz-skibinski"}, "edited": false, "score": 0, "creation_date": 1568219204, "post_id": 57893038, "comment_id": 102208022, "body": "Try what you get from <code>IE.document.getElementsByName(&quot;Field id per the inspect element&quot;)</code> - it returns empty array as per your code."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1568228906, "post_id": 57893038, "comment_id": 102212153, "body": "We need to see the url and/or the html in question. You can share the relevant html using snippet tool via <a href=\"https://stackoverflow.com/posts/57893038/edit\">edit</a>."}, {"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 0, "creation_date": 1568251162, "post_id": 57893038, "comment_id": 102217955, "body": "Based on your code, you are trying to use HTML element ID to search the element by it&#39;s tag name. if you already have an ID than try to search an element using it&#39;s ID like IE.document.getElementByID(&quot;Field id per the inspect element&quot;).Value = Prop Let us know in which HTML element you are trying to set the value. Also inform us, which version of IE and which OS you are using for making this test may help to narrow down the issue."}, {"owner": {"reputation": 11, "user_id": 11505798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/285fc844382d3adccc704d8e44c58d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed", "link": "https://stackoverflow.com/users/11505798/ahmed"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1568284131, "post_id": 57893038, "comment_id": 102229455, "body": "@QHarr here you go, I made the changes as requested."}, {"owner": {"reputation": 11, "user_id": 11505798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/285fc844382d3adccc704d8e44c58d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed", "link": "https://stackoverflow.com/users/11505798/ahmed"}, "reply_to_user": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 0, "creation_date": 1568285518, "post_id": 57893038, "comment_id": 102230158, "body": "@Deepak-MSFT I searched the element by its ID and not by tag name. the element I tried using is &quot;PropLookup:Lookup&quot; which I got from the developer tools. I use IE11 on Windows 10."}, {"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 0, "creation_date": 1568699606, "post_id": 57893038, "comment_id": 102346419, "body": "If you see your code than you can notice that you are using Getelementsbyname and you are trying pass an ID of the element. Is the site address correct which you are using in your original post? I try to check it and find that it is not exist on the internet. Please try to check it. If it is correct than try to provide your HTML code. We will try to make a test with it to check for the issue."}], "owner": {"reputation": 11, "user_id": 11505798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/285fc844382d3adccc704d8e44c58d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed", "link": "https://stackoverflow.com/users/11505798/ahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568284082, "creation_date": 1568218043, "last_edit_date": 1568284082, "question_id": 57893038, "link": "https://stackoverflow.com/questions/57893038/ie-automation-run-time-error-91-excel-vba", "title": "IE Automation Run-time Error &#39;91&#39; - Excel VBA", "body": "<p>I want to run a report in IE and for that, I need to update an element field. </p>\n\n<p>I used <code>IE.document.getElementsByName(\"Field id per the inspect element\")(0).Value = Prop</code> which I usually do, but VBA is throwing an error stating \"object variable or with block not set in vba\".</p>\n\n<p>I have other codes where I used the same to update the element fields without any error.</p>\n\n<pre><code>Option Explicit    \nPublic IE As InternetExplorer\n\nSub Test()    \nDim Prop As String\n\nProp = \"._rpt1^._ibp\"\n\nSet IE = Nothing\nSet IE = CreateObject(\"internetexplorer.application\")\nIE.Visible = True\nIE.navigate \"https://www.yardipcu.com/44812lennarsso/pages/menu.aspx?sMenuSet=len_iData_int\"\nDo While IE.readyState &lt;&gt; 4 Or IE.Busy: DoEvents: Loop\nDo While IE.readyState &lt;&gt; 4 Or IE.Busy: DoEvents: Loop\n\nIE.document.getElementsByName(\"PropLookup:Lookup\")(0).Value = Prop\n'here I receive the error\nIE.document.forms(0).submit\n\nEnd sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "ms-access-forms"], "comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1568217652, "post_id": 57892637, "comment_id": 102207237, "body": "You tried what? Show your effort. Maybe an image is exceptionally usefull (from the populated form). Add recordsource bound/unbound fieldsand the dlookup  to question. And read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and related."}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1568217807, "post_id": 57892637, "comment_id": 102207313, "body": "Your answer is here: <a href=\"https://stackoverflow.com/a/14944351/78522\">stackoverflow.com/a/14944351/78522</a>"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1568220086, "post_id": 57892637, "comment_id": 102208399, "body": "Every entry means a continuous-form? ID field is bound?"}, {"owner": {"reputation": 5, "user_id": 9361716, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Malik Sahab", "link": "https://stackoverflow.com/users/9361716/malik-sahab"}, "edited": false, "score": 0, "creation_date": 1568220202, "post_id": 57892637, "comment_id": 102208457, "body": "Don&#39;t know anything. I&#39;ve edited the question and added an image link. can you please Help?"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1568221204, "post_id": 57892637, "comment_id": 102208907, "body": "That won&#39;t work, as you don&#39;t refer to the control<code>CustomerID</code>, yout criteria looks is &quot;CustomerID=CustomerID&quot;, what gets true, so first value of query is displayed. You have to refer to the crontrol by ommiting the double-quotes from last CustomerID.<code>&quot;CustomerID=&quot; &amp; CustomerID</code>, what gets<code>CustomerID=2</code> for your image."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "reply_to_user": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1568221506, "post_id": 57892637, "comment_id": 102209024, "body": "But you can use<code>=ComboBox.Colunm(1)</code>like @PatrickHonorez suggested. If you don&#39;t know what a coninuous-form or a bound control is, query the web, as they are important"}, {"owner": {"reputation": 5, "user_id": 9361716, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Malik Sahab", "link": "https://stackoverflow.com/users/9361716/malik-sahab"}, "reply_to_user": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1568226061, "post_id": 57892637, "comment_id": 102210861, "body": "@ComputerVersteher  and Patrick Honorez thank you brother.  You guys  made a very difficult thing easy for me. ComboxName.Column(1) worked."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1568226586, "post_id": 57892637, "comment_id": 102211101, "body": "You&#39;re welcome! Don&#39;r forget to vote (arrow up) for Patricks answer. Keep in mind to delete your thank you comments after they are received (like above). If you update your questiom (add final solution to end and <a href=\"https://stackoverflow.com/editing-help\">improve formatting</a> ),it gets my vote ."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 9361716, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Malik Sahab", "link": "https://stackoverflow.com/users/9361716/malik-sahab"}, "edited": false, "score": 0, "creation_date": 1568219053, "post_id": 57893064, "comment_id": 102207946, "body": "Doesn&#39;t work. The expression Builder turns Combox.Column(2) into [Combox].[Column](2)"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "reply_to_user": {"reputation": 5, "user_id": 9361716, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Malik Sahab", "link": "https://stackoverflow.com/users/9361716/malik-sahab"}, "edited": false, "score": 1, "creation_date": 1568219890, "post_id": 57893064, "comment_id": 102208302, "body": "@MalikSahab should be<code>ComboBox.Column(1)</code>as columns are zero-based (first column is .Column(0)). The addition of square-brackets is ok, but not needed if no specialchars or reserved names used(like ComboBox)."}, {"owner": {"reputation": 5, "user_id": 9361716, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Malik Sahab", "link": "https://stackoverflow.com/users/9361716/malik-sahab"}, "edited": false, "score": 1, "creation_date": 1568226143, "post_id": 57893064, "comment_id": 102210905, "body": "@Patrick Honorez thank you. May God make your life easier as you made mine."}], "tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": true, "score": 1, "last_activity_date": 1568218556, "last_edit_date": 1568218556, "creation_date": 1568218144, "answer_id": 57893064, "question_id": 57892637, "link": "https://stackoverflow.com/questions/57892637/how-to-see-name-when-i-enter-an-id-in-access-form/57893064#57893064", "title": "How to see name when I enter an id in access form", "body": "<p>Use a combo box to enter the customerId.<br>\nThen create a text box for the customerName, that links to the customerId combo, as explained <a href=\"https://stackoverflow.com/a/14944351/78522\">here</a>.<br>\nThe trick is to properly set the properties of the combo:<br>\n<code>RowSource Type</code>: Table/Query<br>\n<code>Source</code>: <code>SELECT CustomerID, CompanyName FROM tblCustomers</code><br>\n<code>Bound column</code>: 1<br>\n<code>Column count</code>: 2<br>\n<code>Limit to List</code>: Yes<br>\n<code>Column widths</code>: 3;0  'second column will be hidden</p>\n"}, {"tags": [], "owner": {"reputation": 868, "user_id": 1321707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e64dedac8fa02cae04b5c29e520925d?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/1321707/john"}, "is_accepted": false, "score": 0, "last_activity_date": 1568221004, "creation_date": 1568221004, "answer_id": 57893726, "question_id": 57892637, "link": "https://stackoverflow.com/questions/57892637/how-to-see-name-when-i-enter-an-id-in-access-form/57893726#57893726", "title": "How to see name when I enter an id in access form", "body": "<p>You don't need Dlookups or whatever ..just correctly designed ComboBox<br>\n<strong>RowSource</strong> = SELECT CustomerID,CustName CustFath From Customers<br>\n<strong>Bound column</strong>: 1<br>\n<strong>Column count</strong>: 3<br>\n<strong>Column width</strong> : 0;4;4<br>\nYou won't see the ID ..but Customer Name will be nicely displayed.</p>\n"}], "owner": {"reputation": 5, "user_id": 9361716, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Malik Sahab", "link": "https://stackoverflow.com/users/9361716/malik-sahab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 822, "favorite_count": 0, "accepted_answer_id": 57893064, "answer_count": 2, "score": 0, "last_activity_date": 1594636225, "creation_date": 1568216632, "last_edit_date": 1594636225, "question_id": 57892637, "link": "https://stackoverflow.com/questions/57892637/how-to-see-name-when-i-enter-an-id-in-access-form", "title": "How to see name when I enter an id in access form", "body": "<p>I have a Form where I Enter <strong>CustomerID</strong> in a combo box. This box has Two Columns CustomerID and CustName.</p>\n\n<p>the CustName and CustFather reside in another query.</p>\n\n<p>is there a way to show the CustName and CustFather everytime i enter CustomerID in the form?</p>\n\n<p>The CustomerID is entered in a form and not in the same table as CustName and CustFather.</p>\n\n<p>Tried DLookup but it just looks only the first time and then shows that same value everytime i open the form or update it. the dlookup is shown as:</p>\n\n<pre><code>=DLookUp(\"CustName\",\"qryForRecovery\",\"CustomerID =\" &amp; \"CustomerID\")\n</code></pre>\n\n<p>is there a way i can show the CustName everytime i update the CustomerID field?</p>\n\n<p>This is the link to the snapshot of my recovery form. \n<a href=\"https://i.stack.imgur.com/YzuxK.png\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/YzuxK.png</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11803068"}, "reply_to_user": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1568215593, "post_id": 57892185, "comment_id": 102206126, "body": "I&#39;m a scrub when it comes to stack overflow"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11803068"}, "reply_to_user": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1568215604, "post_id": 57892185, "comment_id": 102206140, "body": "I ask tough questions"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1568215720, "post_id": 57892185, "comment_id": 102206195, "body": "Maybe, but I saw you received tough answers from highly valuable members."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1568215801, "post_id": 57892185, "comment_id": 102206236, "body": "Is your Column Titles in row 2?  if not you need to include them in the ranges."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11803068"}, "edited": false, "score": 0, "creation_date": 1568216030, "post_id": 57892185, "comment_id": 102206394, "body": "I made the column titles first in another sheet, now I am trying to extract unique values from the other sheet"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1568216120, "post_id": 57892185, "comment_id": 102206436, "body": "You still need to include them in the ranges."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1568216241, "post_id": 57892185, "comment_id": 102206497, "body": "BTW, did you see that I added vba to my answer on your last question?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11803068"}, "edited": false, "score": 0, "creation_date": 1568216304, "post_id": 57892185, "comment_id": 102206535, "body": "Yes I did see that. It is just way beyond my scope of VB. I appreciate it."}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1568217479, "post_id": 57892185, "comment_id": 102207133, "body": "@user11803068 Once you try my answer don&#39;t hesitate to leave me feedbacks if needed so I can improve it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11803068"}, "edited": false, "score": 0, "creation_date": 1568217581, "post_id": 57892185, "comment_id": 102207189, "body": "I did leave some feedback underneath the answer"}], "owner": {"user_type": "does_not_exist", "display_name": "user11803068"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568281599, "creation_date": 1568214931, "last_edit_date": 1568281599, "question_id": 57892185, "link": "https://stackoverflow.com/questions/57892185/extract-unique-values-from-a-column-in-one-sheet-and-place-them-in-another-sheet", "title": "Extract unique values from a column in one sheet and place them in another sheet", "body": "<p>I have a list of strings in a column. I would like to take the unique values from this column and place them in another worksheet. I tried this but can't seem to get it to work. </p>\n\n<pre><code>Worksheets(\"Sheet1\").Range(\"A2:A1048576\").AdvancedFilter Action:=xlFilterCopy, CopyToRange:=Worksheets(\"Sheet2\").Range(\"A2\"), Unique:=True\n</code></pre>\n\n<p>The \":=\" gives me an error each time.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1568215686, "post_id": 57892170, "comment_id": 102206175, "body": "You inserted only one vbLf, the second after change, before weeks is missing."}, {"owner": {"reputation": 1168, "user_id": 9235421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afc6f04ea4fa5b8303e2e3897ac1d0ef?s=128&d=identicon&r=PG&f=1", "display_name": "Zababa", "link": "https://stackoverflow.com/users/9235421/zababa"}, "reply_to_user": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1568215782, "post_id": 57892170, "comment_id": 102206230, "body": "Thanks, I have corrected it, but now it throws the error 1004"}, {"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 1, "creation_date": 1568215783, "post_id": 57892170, "comment_id": 102206231, "body": "Regarding Debug.Print: You can write it e.g. after the line <code>Sub test()</code>, and you will see the output in the Immediate Window (in the VB Editor press Ctrl + G to get into this window)."}, {"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 1, "creation_date": 1568215883, "post_id": 57892170, "comment_id": 102206293, "body": "Most probably, the reference is now correct, however, you cannot hide individual cells, only whole rows or columns, so you should insert .EntireRow or .EntireColumn before .Hidden."}, {"owner": {"reputation": 1168, "user_id": 9235421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afc6f04ea4fa5b8303e2e3897ac1d0ef?s=128&d=identicon&r=PG&f=1", "display_name": "Zababa", "link": "https://stackoverflow.com/users/9235421/zababa"}, "reply_to_user": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1568215905, "post_id": 57892170, "comment_id": 102206310, "body": "Thanks. I did not nave teh immediate window enabled. But there I see just the pretty output with newlines and all. Taht did not tell me what to write into the Range(...)"}, {"owner": {"reputation": 1168, "user_id": 9235421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afc6f04ea4fa5b8303e2e3897ac1d0ef?s=128&d=identicon&r=PG&f=1", "display_name": "Zababa", "link": "https://stackoverflow.com/users/9235421/zababa"}, "reply_to_user": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1568215979, "post_id": 57892170, "comment_id": 102206368, "body": "Thanks! That was it. <code>.Range(&quot;Ticketliste[last           &quot; &amp; vbLf &amp; &quot;change       &quot; &amp; vbLf &amp; &quot;(weeks)   ]&quot;).EntireColumn.Hidden = True</code> works perfectly!"}], "answers": [{"tags": [], "owner": {"reputation": 1168, "user_id": 9235421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afc6f04ea4fa5b8303e2e3897ac1d0ef?s=128&d=identicon&r=PG&f=1", "display_name": "Zababa", "link": "https://stackoverflow.com/users/9235421/zababa"}, "is_accepted": true, "score": 0, "last_activity_date": 1568216156, "creation_date": 1568216156, "answer_id": 57892510, "question_id": 57892170, "link": "https://stackoverflow.com/questions/57892170/refer-to-table-column-name-that-includes-newlines-and-trailing-spaces/57892510#57892510", "title": "Refer to table column name that includes newlines and trailing spaces", "body": "<p><a href=\"https://stackoverflow.com/users/6306782/z32a7ul\">z32a7ul</a> has answered in his comment:</p>\n\n<p>you cannot hide individual cells, only whole rows or columns, so you should insert .EntireRow or .EntireColumn before .Hidden.</p>\n"}], "owner": {"reputation": 1168, "user_id": 9235421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afc6f04ea4fa5b8303e2e3897ac1d0ef?s=128&d=identicon&r=PG&f=1", "display_name": "Zababa", "link": "https://stackoverflow.com/users/9235421/zababa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 57892510, "answer_count": 1, "score": 0, "last_activity_date": 1568262330, "creation_date": 1568214873, "last_edit_date": 1568262330, "question_id": 57892170, "link": "https://stackoverflow.com/questions/57892170/refer-to-table-column-name-that-includes-newlines-and-trailing-spaces", "title": "Refer to table column name that includes newlines and trailing spaces", "body": "<p>This is a followup question of <a href=\"https://stackoverflow.com/questions/46941828/how-do-i-reference-an-excel-listobject-table-column-if-the-column-name-has-line\">this question</a>. My question is that I have a table with a column named:</p>\n\n<pre><code>last\u02fd\u02fd\u02fd\u02fd\u02fd\u02fd\u02fd\u02fd\u02fd\u02fd\u02fd\nchange\u02fd\u02fd\u02fd\u02fd\u02fd\u02fd\u02fd\n(weeks)\u02fd\u02fd\u02fd\n</code></pre>\n\n<p>Where \u02fd is a common space and there are two line breaks. (Don't hurt me, it wasn't me who created this column name.)</p>\n\n<p>I am trying to do things with this column, e.g.</p>\n\n<pre><code>Sub test()\n    With ActiveSheet\n        .Range(\"myTable[last           \" &amp; vbLf &amp; \"change       \" &amp; vbLf &amp; \"(weeks)   ]\").Hidden = True\n    End With\nEnd Sub\n</code></pre>\n\n<p>which fails for some reason. Having read the <a href=\"https://stackoverflow.com/questions/46941828/how-do-i-reference-an-excel-listobject-table-column-if-the-column-name-has-line\">related question</a>, somebody commented to try <code>Debug.Print ActiveCell.Value</code> to see what the actual cell content is, but I have no idea where to put this code and where I would see the output. When I make a small Sub out of it and run it on the active cell, nothing happens:</p>\n\n<pre><code>Sub cellvalue()\n    Debug.Print ActiveCell.Value\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "excel", "vba", "outlook", "ms-word"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568215439, "post_id": 57892116, "comment_id": 102206026, "body": "I have never experienced this issue. Can you share the exact string that you are using for &quot;.HTMLBody&quot;"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1568291632, "post_id": 57892116, "comment_id": 102233534, "body": "Word does not format centered by default. Formatting in Word is controlled by <i>styles</i>. It sounds as if the Normal style in the template being applied to the email has been change to be centered. I&#39;m not an Outlook expert, so am not really sure how to find and edit this template, I just remember there is (since a few Office versions) a separate one for emails. Researching that might get you a step further if no Outlook people jump in here. Or ask about how to find it in an end-user forum."}, {"owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "edited": false, "score": 0, "creation_date": 1568300643, "post_id": 57892116, "comment_id": 102238972, "body": "The template that controls styling in Outlook is NormalEmail.dotm. Typically it can be found in C:\\Users\\&lt;UserName&gt;\\AppData\\Roaming\\Microsoft\\Templates. To edit this template 1) close Outlook, 2) open the template in Word, 3) save the changes to the template, 4) open Outlook and create a new message. The changes you make will not be applied to existing messages or drafts."}, {"owner": {"reputation": 1, "user_id": 6157536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83f1f8fc5bbf33844802f0be023ed855?s=128&d=identicon&r=PG&f=1", "display_name": "Merrill Preska-Steinberg", "link": "https://stackoverflow.com/users/6157536/merrill-preska-steinberg"}, "edited": false, "score": 0, "creation_date": 1568308868, "post_id": 57892116, "comment_id": 102242789, "body": "As an example, if you use <code>.HTMLBody = &quot;&lt;html&gt;&lt;body&gt;&lt;p align=&quot;&quot;left&quot;&quot;&gt;here is some text that will be auto centered&lt;&#47;p&gt;&lt;&#47;body&gt;&lt;&#47;html&gt;&quot;</code> then, at least in my Outlook (and if you&#39;re computer is slow), you can actually see that the email will start out left aligned and then the text will be centered. Another thing to note is that if you don&#39;t call .Display and instead just call .Send the email will be formatted properly. Another thing is that if you create a template, add some right or left aligned text, then call <code>.CreateItemFromTemplate(myTemplte)</code>  then <code>.Display</code>, Outlook will center the text."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6157536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83f1f8fc5bbf33844802f0be023ed855?s=128&d=identicon&r=PG&f=1", "display_name": "Merrill Preska-Steinberg", "link": "https://stackoverflow.com/users/6157536/merrill-preska-steinberg"}, "edited": false, "score": 0, "creation_date": 1568308403, "post_id": 57892308, "comment_id": 102242618, "body": "While I was trying to get this to work there was actual HTML in the HTMLBody. I didn&#39;t put any in the question itself because I had tried many different things and I wasn&#39;t able to get any of them to work, and there is no necessity to use HTML for this particular part of the email. Align=&quot;left&quot; was one of the first things I tried. As I said, the only thing that came close to working was using a left aligned table, but extra newlines were added after that, so that wasn&#39;t great either."}], "tags": [], "owner": {"reputation": 330, "user_id": 4623938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d520308e65c227205f7d5c388a7c9327?s=128&d=identicon&r=PG", "display_name": "Doug WB", "link": "https://stackoverflow.com/users/4623938/doug-wb"}, "is_accepted": false, "score": 0, "last_activity_date": 1568313339, "last_edit_date": 1568313339, "creation_date": 1568215347, "answer_id": 57892308, "question_id": 57892116, "link": "https://stackoverflow.com/questions/57892116/outlook-word-autoformats-vba-generated-email/57892308#57892308", "title": "Outlook/Word Autoformats VBA Generated Email", "body": "<p>Your .HTMLBody doesn't actually contain any HTML currently.  HTML emails are parsed differently by various rendering engines, so the actual subset of HTML you can use across the board can be a case of trial-and-error to determine.</p>\n\n<p>But for something like a simple left-align, it shouldn't be too involved.</p>\n\n<p>Perhaps something like:</p>\n\n<p><code>.HTMLBody = \"&lt;html&gt;&lt;body&gt;&lt;p align=\"left\"&gt;here is some text that will be auto centered&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;\"</code></p>\n\n<p>I guess my point is, the centering isn't coming from your code, except possibly by omission.  The lack of formatting markup is leaving it to the rendering engine to decide how best to display it.</p>\n\n<p>Based on your subsequent comment, I'd suggest sticking with tables (they're generally the most reliable way to format HTML emails in my experience) but you may need to add some Outlook-specific CSS in your document HEAD to sort out the extra spacing:</p>\n\n<pre>\n/* Stop Outlook from adding extra spacing to tables. */\n\n    table,\n    td {\n        mso-table-lspace: 0pt !important;\n        mso-table-rspace: 0pt !important;\n    }\n</pre>\n\n<p>If that's helpful, you can find the above (and further tips) at <a href=\"https://www.contactmonkey.com/blog/outlook-rendering-issues\" rel=\"nofollow noreferrer\">ContactMonkey</a></p>\n"}], "owner": {"reputation": 1, "user_id": 6157536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83f1f8fc5bbf33844802f0be023ed855?s=128&d=identicon&r=PG&f=1", "display_name": "Merrill Preska-Steinberg", "link": "https://stackoverflow.com/users/6157536/merrill-preska-steinberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568313339, "creation_date": 1568214662, "last_edit_date": 1568291480, "question_id": 57892116, "link": "https://stackoverflow.com/questions/57892116/outlook-word-autoformats-vba-generated-email", "title": "Outlook/Word Autoformats VBA Generated Email", "body": "<p>I am trying to generate and then preview an email using an Excel macro. Essentially, I am creating a new <code>MailItem</code> with <code>CreateItem(0)</code>, setting the <code>HTMLBody</code> property, then calling <code>myemail.Display</code>. <code>myemail.Display</code> opens up the email in Outlook's inspector, which, AFAIK, first runs the email through some sort of Microsoft Word parser, which strips much of the formatting. If instead of calling <code>myemail.Display</code> I just call <code>myemail.Send</code>, the email is formatted properly, but in this use case we really want to be able to preview the email first.</p>\n\n<p>The particular formatting that is being stripped is that all left-aligned text is being centered. It's not a huge deal, but it would be good if I could understand this behavior. Some potential solutions/answers could include:\n1. How to format the HTML so that Word doesn't strip the formatting\n2. How to turn off the Word parser engine entirely\n3. How to turn off Word auto centering of text</p>\n\n<p>The most promising thing I tried was making a left aligned table, however Outlook/Word added an extra ugly two empty lines after the table. Many solutions look mostly good, but the whole point of formatting/previewing this is because the email is being sent out to important people so I want it to look as good as possible. </p>\n\n<p>Here is an example where Outlook/Word will auto center this text</p>\n\n<pre><code>Set OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\n\nWith OutMail\n   .To = \"someemail@email.com\"\n   .BCC = \"\"\n   .Subject = \"a subjhect\"\n   .SentOnBehalfOfName = \"anotheremail@email.com\"\n   .HTMLBody = \"here is some text that will be auto centered\"\n   .Display\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "list", "ms-access", "combobox", "ms-access-2010"], "comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 1, "creation_date": 1568215233, "post_id": 57891995, "comment_id": 102205903, "body": "Please take the <a href=\"https://stackoverflow.com/tour\">tour</a> and read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>, then improve your question (edit) with own effort. E.g read the related section (at right site of page ). . Another hint: your task is called &#39;search as you type&#39;. Query the web for that (with leading ms access),"}], "answers": [{"comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1568218919, "post_id": 57892928, "comment_id": 102207889, "body": "+1 for Len-pattern! Additionally you should add <a href=\"http://www.cpearson.com/Excel/DeclaringVariables.aspx\" rel=\"nofollow noreferrer\">Option Explicit</a>. Instead of<code>&quot;&quot;</code>I prefer<code>vbNullString</code>.because it is typo-safe.  Code should be indented, single-line<code>If</code>staements are hard to read and <a href=\"https://stackoverflow.com/editing-help#syntax-highlighting\">syntax-highlighting</a> is far easier with <a href=\"https://stackoverflow.com/editing-help#code\">code-fences</a>"}], "tags": [], "owner": {"reputation": 868, "user_id": 1321707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e64dedac8fa02cae04b5c29e520925d?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/1321707/john"}, "is_accepted": false, "score": 2, "last_activity_date": 1568219693, "last_edit_date": 1568219693, "creation_date": 1568217698, "answer_id": 57892928, "question_id": 57891995, "link": "https://stackoverflow.com/questions/57891995/how-to-limit-a-drop-down-list-in-a-combo-box-to-only-show-the-values-that-includ/57892928#57892928", "title": "How to limit a drop down list in a combo box to only show the values that include the letters that the user typed?", "body": "<p>Well a solution would be :<br>\nPut this on the top of your VBA..just under Option ...  </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim comboboxOriginal As String  \n</code></pre>\n\n<p>Put this code in the Change Event</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub cboFilterAsType_Change()\nIf Len(Nz(comboboxOriginal, \"\")) = 0 Then \n    comboboxOriginal = Me.cboFilterAsType.RowSource\nEnd If\nIf Len(Me.cboFilterAsType.Text) &gt; 1 Then\n    Me.cboFilterAsType.SelStart = Len(Me.cboFilterAsType.Text)\n    Me.cboFilterAsType.RowSource = Replace(comboboxOriginal, \";\", \"\") &amp; \" WHERE SOMEFIELD like \"\"*\" &amp; Me.cboFilterAsType.Text &amp; \"*\"\"\"\n    DoCmd.RunCommand acCmdSaveRecord\n    Me.cboFilterAsType.Requery\n    Me.cboFilterAsType.Dropdown\nEnd If\nEnd Sub\n</code></pre>\n\n<p>TO clear the filtering</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub cboFilterAsType_DblClick(Cancel As Integer)\nIf Len(Nz(comboboxOriginal, \"\")) &gt; 0 Then \n    Me.cboFilterAsType.RowSource = comboboxOriginal\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Take a note that the RowSource should be something simple like SELECT SomeID From ATable</p>\n"}], "owner": {"reputation": 39, "user_id": 10918880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ac0884d458e07e76a2d055b05cbf76d?s=128&d=identicon&r=PG&f=1", "display_name": "SharonIsKaren", "link": "https://stackoverflow.com/users/10918880/sharoniskaren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 680, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594449551, "creation_date": 1568214246, "last_edit_date": 1594449551, "question_id": 57891995, "link": "https://stackoverflow.com/questions/57891995/how-to-limit-a-drop-down-list-in-a-combo-box-to-only-show-the-values-that-includ", "title": "How to limit a drop down list in a combo box to only show the values that include the letters that the user typed?", "body": "<p>I am using Access 2010 database. I have a combo box that gives me a full list of equipment numbers (they have letters and numbers i.e.: sdp1234). </p>\n\n<p>To try to speed up the database I was told to limit the drop down lists in combo boxes.</p>\n\n<p>Currently, users can start typing the equipment # and an item from the list will be highlighted matching with their typed characters.</p>\n\n<p>I want the users to be able to type \"12\" and the list show should have only the values between \"sdp1200\" and \"sdp1299\". Or even just all the items that have \"12\" inside.</p>\n\n<p>I am not sure if this is done in VBA or in the properties tab for the combo box.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 6, "creation_date": 1568214260, "post_id": 57891883, "comment_id": 102205371, "body": "<code>i &lt; reviewersCount &amp; i &lt; 12</code> should be <code>i &lt; reviewersCount And i &lt; 12</code>  in vba <code>&amp;</code> and <code>And</code> are not the same thing."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 5, "creation_date": 1568214408, "post_id": 57891883, "comment_id": 102205454, "body": "You never reset the value of <code>i</code>"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1568216494, "post_id": 57891883, "comment_id": 102206657, "body": "Surely there&#39;s an easier way to set this up... Also, what is <code>n</code>?"}], "owner": {"reputation": 21, "user_id": 12042173, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAKUJxs2CXm9HLSOhNcFCI1g9aA2cYUmiJHQ1rnMA=k-s128", "display_name": "Blatt Krist&#243;f", "link": "https://stackoverflow.com/users/12042173/blatt-krist%c3%b3f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568214166, "creation_date": 1568213897, "last_edit_date": 1568214166, "question_id": 57891883, "link": "https://stackoverflow.com/questions/57891883/please-revise-my-code-in-which-out-of-range-issue-appears", "title": "Please revise my code, in which Out of range issue appears", "body": "<p>I am trying to generate a form and fill it up with data from another xlsx. However when I loop through string array by Do While method, it gives out of range Error.</p>\n\n<p>Checked \"i\" increment variable start, however it is not limited from beyond. Somehow it may get out of range.</p>\n\n<pre><code>Dim innerReviewers() As String: Dim split_ETO_reviewers() As String: Dim split_KGO_reviewers() As String: Dim split_PGO_reviewers() As String: Dim split_NUO_reviewers() As String\n    Dim split_AMO_reviewers() As String: Dim split_VSKO_reviewers() As String: Dim split_VIO_reviewers() As String: Dim split_ABO_reviewers() As String: Dim split_ITO_reviewers() As String\n    Dim split_UIG_reviewers() As String: Dim split_ENBO_reviewers() As String: Dim split_LETO_reviewers() As String: Dim split_Non_ERBE_reviewers() As String: Dim split_ERBE_reviewers() As String\n    innerReviewers() = Split(reviewers(n), \",\")\n    split_ETO_reviewers() = Split(ETO_reviewers(n), \",\")\n    split_KGO_reviewers() = Split(KGO_reviewers(n), \",\")\n    split_PGO_reviewers() = Split(PGO_reviewers(n), \",\")\n    split_NUO_reviewers() = Split(NUO_reviewers(n), \",\")\n    split_AMO_reviewers() = Split(AMO_reviewers(n), \",\")\n    split_VSKO_reviewers() = Split(VSKO_reviewers(n), \",\")\n    split_VIO_reviewers() = Split(VIO_reviewers(n), \",\")\n    split_ABO_reviewers() = Split(ABO_reviewers(n), \",\")\n    split_ITO_reviewers() = Split(ITO_reviewers(n), \",\")\n    split_UIG_reviewers() = Split(UIG_reviewers(n), \",\")\n    split_ENBO_reviewers() = Split(ENBO_reviewers(n), \",\")\n    split_LETO_reviewers() = Split(LETO_reviewers(n), \",\")\n    split_Non_ERBE_reviewers() = Split(Non_ERBE_reviewers(n), \",\")\n    split_ERBE_reviewers() = Split(ERBE_reviewers(n), \",\")\n    reviewersCount = 0\n    If Len(Join(innerReviewers)) &gt; 0 &amp; Len(Join(split_ETO_reviewers)) &gt; 0 &amp; Len(Join(split_KGO_reviewers)) &gt; 0 &amp; Len(Join(split_PGO_reviewers)) &gt; 0 &amp; Len(Join(split_NUO_reviewers)) &gt; 0 &amp; Len(Join(split_AMO_reviewers)) &gt; 0 &amp; Len(Join(split_VSKO_reviewers)) &gt; 0 &amp; Len(Join(split_VIO_reviewers)) &gt; 0 &amp; Len(Join(split_ABO_reviewers)) &gt; 0 &amp; Len(Join(split_ITO_reviewers)) &gt; 0 Then\n        MsgBox \"The current document (\" &amp; docCode(n) &amp; \") has not been reviewed by colleques! (Archiving function of list of non-reviewed docs is not ready.)\", vbOKOnly, \"Warning for lacking reviewers!\"\n        Dim non_reviewed_docs As Object\n        Dim archive As String\n        archive = \"C:\\Users\\C3642\\Desktop\\FU5504-NY-01\\Non_reviewed_documents_list.xlsx\"\n        Set non_reviewed_docs = xlApp.Workbooks.Open(archive, True)\n        With non_reviewed_docs.Worksheet(1)\n            .Cells(n + 1, 1).Value = docCode(n)\n        End With\n        non_reviewed_docs.Close SaveChanges:=True\n    End If\n    With outXl.Worksheets(1)\n        reviewersCount = UBound(innerReviewers) - LBound(innerReviewers) + 1\n        Dim i As Integer\n        i = 0\n        Do While (i &lt; reviewersCount &amp; i &lt; 12)\n            .Cells(16 + i, 4).Value = innerReviewers(i + 1)\n            i = i + 1\n        Loop\n        reviewersCount = reviewersCount + UBound(split_ETO_reviewers) - LBound(split_ETO_reviewers) + 1\n            Do While (i &lt; (12 - reviewersCount))\n            .Cells(16 + i, 4).Value = ETO_reviewers(i + 1)\n            i = i + 1\n        Loop\n        reviewersCount = reviewersCount + UBound(split_KGO_reviewers) - LBound(split_KGO_reviewers) + 1\n        Do While (i &lt; (12 - reviewersCount))\n            .Cells(16 + i, 4).Value = KGO_reviewers(i + 1)\n            i = i + 1\n        Loop\n        reviewersCount = reviewersCount + UBound(split_PGO_reviewers) - LBound(split_PGO_reviewers) + 1\n        Do While (i &lt; (12 - reviewersCount))\n            .Cells(16 + i, 4).Value = PGO_reviewers(i + 1)\n            i = i + 1\n        Loop\n        reviewersCount = reviewersCount + UBound(split_NUO_reviewers) - LBound(split_NUO_reviewers) + 1\n        Do While (i &lt; (12 - reviewersCount))\n            .Cells(16 + i, 4).Value = NUO_reviewers(i + 1)\n            i = i + 1\n        Loop\n        reviewersCount = reviewersCount + UBound(split_AMO_reviewers) - LBound(split_AMO_reviewers) + 1\n        Do While (i &lt; (12 - reviewersCount))\n            .Cells(16 + i, 4).Value = AMO_reviewers(i + 1)\n            i = i + 1\n        Loop\n        reviewersCount = reviewersCount + UBound(split_VSKO_reviewers) - LBound(split_VSKO_reviewers) + 1\n        Do While (i &lt; (12 - reviewersCount))\n            .Cells(16 + i, 4).Value = VSKO_reviewers(i + 1)\n            i = i + 1\n        Loop\n        reviewersCount = reviewersCount + UBound(split_VIO_reviewers) - LBound(split_VIO_reviewers) + 1\n        Do While (i &lt; (12 - reviewersCount))\n            .Cells(16 + i, 4).Value = VIO_reviewers(i + 1)\n            i = i + 1\n        Loop\n        reviewersCount = reviewersCount + UBound(split_ABO_reviewers) - LBound(split_ABO_reviewers) + 1\n        Do While (i &lt; (12 - reviewersCount))\n            .Cells(16 + i, 4).Value = ABO_reviewers(i + 1)\n            i = i + 1\n        Loop\n        reviewersCount = reviewersCount + UBound(split_ITO_reviewers) - LBound(split_ITO_reviewers) + 1\n        Do While (i &lt; (12 - reviewersCount))\n            .Cells(16 + i, 4).Value = ITO_reviewers(i + 1)\n            i = i + 1\n        Loop\n        reviewersCount = reviewersCount + UBound(split_UIG_reviewers) - LBound(split_UIG_reviewers) + 1\n        Do While (i &lt; (12 - reviewersCount))\n            .Cells(16 + i, 4).Value = UIG_reviewers(i + 1)\n            i = i + 1\n        Loop\n        reviewersCount = reviewersCount + UBound(split_ENBO_reviewers) - LBound(split_ENBO_reviewers) + 1\n        Do While (i &lt; (12 - reviewersCount))\n            .Cells(16 + i, 4).Value = ENBO_reviewers(i + 1)\n            i = i + 1\n        Loop\n        reviewersCount = reviewersCount + UBound(split_LETO_reviewers) - LBound(split_LETO_reviewers) + 1\n        Do While (i &lt; (12 - reviewersCount))\n            .Cells(16 + i, 4).Value = LETO_reviewers(i + 1)\n            i = i + 1\n        Loop\n        'reviewersCount = reviewersCount + UBound(split_Non_ERBE_reviewers) - LBound(split_Non_ERBE_reviewers) + 1\n        'Do While (i &lt; (12 - reviewersCount))\n        '   .Cells(16 + i, 4).Value = Non_ERBE_reviewers(i)\n        '     i = i + 1\n        'Loop\n        'reviewersCount = reviewersCount + UBound(split_ERBE_reviewers) - LBound(split_ERBE_reviewers) + 1\n        'Do While (i &lt; (12 - reviewersCount))\n        '   .Cells(16 + i, 4).Value = ERBE_reviewers(i)\n        '     i = i + 1\n        'Loop\n    End With\n    Dim concatenatedfileName As String\n    concatenatedfileName = docResponsible(n) &amp; \"_\" &amp; docCode(n) &amp; \".xlsx\"\n    outXl.SaveAs Filename:=concatenatedfileName, FileFormat:=51\n    outXl.Close SaveChanges:=True\n</code></pre>\n\n<p>I expect i variable in routine \".Cells(16 + i, 4).Value = innerReviewers(i + 1)\" remainnig below 12, but for the first loop, when it reaches i=7, gives the error.</p>\n"}, {"tags": ["excel", "vba", "week-number"], "answers": [{"comments": [{"owner": {"reputation": 403, "user_id": 12030025, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CzwJD.jpg?s=128&g=1", "display_name": "ChangeWorld", "link": "https://stackoverflow.com/users/12030025/changeworld"}, "edited": false, "score": 1, "creation_date": 1568213375, "post_id": 57891672, "comment_id": 102204856, "body": "Yeah this one returnes the proper array. Flawless answer."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 403, "user_id": 12030025, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CzwJD.jpg?s=128&g=1", "display_name": "ChangeWorld", "link": "https://stackoverflow.com/users/12030025/changeworld"}, "edited": false, "score": 0, "creation_date": 1568213506, "post_id": 57891672, "comment_id": 102204939, "body": "Note that on your question 2-2-2020 with vbMonday is actually week 5, so the 6 in your desired output should be excluded!"}, {"owner": {"reputation": 403, "user_id": 12030025, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CzwJD.jpg?s=128&g=1", "display_name": "ChangeWorld", "link": "https://stackoverflow.com/users/12030025/changeworld"}, "edited": false, "score": 0, "creation_date": 1568213706, "post_id": 57891672, "comment_id": 102205051, "body": "Ah, sorry was cheking code, and thought I wrote <b>03/02/2020</b>, I will update it right away! thanks"}, {"owner": {"reputation": 403, "user_id": 12030025, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CzwJD.jpg?s=128&g=1", "display_name": "ChangeWorld", "link": "https://stackoverflow.com/users/12030025/changeworld"}, "edited": false, "score": 0, "creation_date": 1568213801, "post_id": 57891672, "comment_id": 102205101, "body": "You should update your answer too, because week 6 should be excluded! :)"}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 3, "last_activity_date": 1568213852, "last_edit_date": 1568213852, "creation_date": 1568213139, "answer_id": 57891672, "question_id": 57891537, "link": "https://stackoverflow.com/questions/57891537/how-to-fill-an-array-of-week-numbers-that-restarts-at-week-1-after-week-52/57891672#57891672", "title": "How to fill an array of week numbers that restarts at week 1 after week 52?", "body": "<p>This answer will be based on our discussion and is very closely related to both <a href=\"https://stackoverflow.com/q/57865283/9758194\">this</a> question on weeknumbers and <a href=\"https://stackoverflow.com/q/57872845/9758194\">this</a> one on months.</p>\n\n<p>The problem here is that the timespan crosses over into a new year. Therefor I'll adapt my answer on the months to fit my answer on the week's question:</p>\n\n<p>So please try:</p>\n\n<p><a href=\"https://i.stack.imgur.com/bLKvL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bLKvL.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub Test()\n\nDim StartD As Long, EndD As Long, EndW As Long\nDim arr As Variant\n\nWith Sheets(\"Foglio1\")\n    StartD = .Cells(1, 2).Value - Application.Weekday(.Cells(1, 2).Value, 2)\n    EndD = .Cells(2, 2).Value - Application.Weekday(.Cells(2, 2).Value, 2) + 7\n    EndW = DateDiff(\"ww\", StartD, EndD)\n    arr = Application.Transpose(.Evaluate(\"WEEKNUM(\" &amp; StartD &amp; \"+(ROW(1:\" &amp; EndW &amp; \")*7),2)\"))\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Which will return an array of <code>48, 49, 50, 51, 52, 1, 2, 3, 4, 5, 6</code>.</p>\n\n<p>It was a little difficult to work with <code>DateDiff</code> in this case as sometimes it wouldn't take whole weeks between dates depending how many days in a week are still left. However, looking at the first days of a week will tackle that.</p>\n\n<p>Hope this answers your question.</p>\n"}], "owner": {"reputation": 403, "user_id": 12030025, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CzwJD.jpg?s=128&g=1", "display_name": "ChangeWorld", "link": "https://stackoverflow.com/users/12030025/changeworld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 57891672, "answer_count": 1, "score": 0, "last_activity_date": 1604670834, "creation_date": 1568212616, "last_edit_date": 1604670834, "question_id": 57891537, "link": "https://stackoverflow.com/questions/57891537/how-to-fill-an-array-of-week-numbers-that-restarts-at-week-1-after-week-52", "title": "How to fill an array of week numbers that restarts at week 1 after week 52?", "body": "<p>In <strong>Cell B2: Start Date</strong> and <strong>Cell B3: End Date</strong></p>\n<p>Example: <br>\nB2 --&gt; 01/12/2019 <br>\nB3 --&gt; 03/02/2020</p>\n<p><a href=\"https://i.stack.imgur.com/RaJs6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RaJs6.png\" alt=\"enter image description here\" /></a></p>\n<p>My code</p>\n<pre><code>    With ThisWorkbook.Sheets(&quot;Foglio1&quot;) 'remember to fully qualify your ranges, including the workbook\n        StartDate = .Range(&quot;B2&quot;)\n        EndDate = .Range(&quot;B3&quot;)\n    End With\n\n    Dim StrtD As Long, EndD As Long\n    Dim provaprova As Integer\n\n    With Sheets(&quot;Foglio1&quot;)\n        StrtD = Application.WeekNum(StartDate, 2)\n        provaprova = DateDiff(&quot;w&quot;, StartDate, EndDate)\n        EndD = StrtD + provaprova\n        arr = .Evaluate(&quot;COLUMN(&quot; &amp; .Cells(1, StrtD).Address &amp; &quot;:&quot; &amp; .Cells(1, EndD).Address &amp; &quot;)&quot;)\n</code></pre>\n<p>My output: <strong>arr(48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58)</strong><br />\nI would like: <strong>arr(48,  49, 50, 51, 52, 1, 2, 3, 4, 5)</strong></p>\n<p>Since the year <strong>has 52 weeks</strong>, I would like <strong>week 1</strong> after <strong>week 52</strong>.</p>\n"}, {"tags": ["vba", "events", "charts"], "answers": [{"tags": [], "owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "is_accepted": false, "score": 0, "last_activity_date": 1568244443, "creation_date": 1568244443, "answer_id": 57897937, "question_id": 57891378, "link": "https://stackoverflow.com/questions/57891378/catching-event-when-selecting-multiple-charts-in-a-worksheet/57897937#57897937", "title": "Catching event when selecting multiple charts in a worksheet", "body": "<p>I don't think there's a event handler for changing the selection of multiple charts, because it looks like Excel goes in Edit Mode after selecting more than one chart.</p>\n\n<p>You could (as a workaround and when it suits your purpose) ad a few lines of code to make sure there's only 1 chart activated/selected.</p>\n\n<p>Change your EventChart_Deactivate as follows; (setting the visible property to False and back to True deselects it)</p>\n\n<pre><code>   Private Sub EventChart_Deactivate()\n    ActiveSheet.ChartObjects(EventChart.Parent.Name).Visible = False\n    ActiveSheet.ChartObjects(EventChart.Parent.Name).Visible = True\n    ufEvents.Update \"Deactivated chart \" &amp; EventChart.Parent.Name\n    If Not ActiveChart Is Nothing Then ActiveSheet.ChartObjects(ActiveChart.Parent.Name).Activate \n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10268566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca044c20038b30cd6ca6b6b8131dfbb6?s=128&d=identicon&r=PG&f=1", "display_name": "sky_pablo", "link": "https://stackoverflow.com/users/10268566/sky-pablo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568244443, "creation_date": 1568212039, "question_id": 57891378, "link": "https://stackoverflow.com/questions/57891378/catching-event-when-selecting-multiple-charts-in-a-worksheet", "title": "Catching event when selecting multiple charts in a worksheet", "body": "<p>I want to catch the event when selecting several charts in a worksheet. Is their an event handler to achieve this in Excel VBA? </p>\n\n<p>I have managed to catch events on application level with the class <em>AppEvents</em> and for all the charts in a worksheets with the class <em>ChartEvents</em>.\nThe events catcher is started with <em>AppEventsStart</em> which opens the form <em>ufEvents</em>. The form displays the selected object name or selected range address and logs all events in a listbox. The event catcher is ended with <em>AppEventsEnd</em> or by closing the form.</p>\n\n<p>Code Module <strong>mEvents</strong></p>\n\n<pre><code>Public App As AppEvents\nPublic Cht As New ChartEvents\nPublic Chts() As New ChartEvents\n\n'*** Application *********************\n\n'*** Activate Application event catcher\nPublic Sub AppEventsStart()\n    Set App = New AppEvents\n    ChartEventsStart\n    Load ufEvents\n    ufEvents.Show vbModeless\nEnd Sub\n\n'*** Deactivate Application event catcher\nPublic Sub AppEventsEnd()\n    Set App = Nothing\n    ChartEventsEnd\n    Unload ufEvents\nEnd Sub\n\n'*** Charts *********************\n\n'*** Activate Chart event catcher\nSub ChartEventsStart()\n    Application.EnableEvents = True\n\n    Dim chtObj As ChartObject\n    Dim i As Integer\n\n    'only initialize when there are charts in sheet\n    If ActiveSheet.ChartObjects.Count &gt; 0 Then\n        ReDim Chts(ActiveSheet.ChartObjects.Count - 1)\n\n        i = 0\n        For Each chtObj In ActiveSheet.ChartObjects            \n            Set Chts(i).EventChart = chtObj.Chart\n            i = i + 1\n        Next chtObj\n    End If\nEnd Sub\n\n'*** Deactivate Chart event catcher\nSub ChartEventsEnd()\n    Dim i As Integer\n\n    'single chart in sheet\n    On Error Resume Next\n    Set Cht.EventChart = Nothing\n\n    'multiple charts in sheet\n    For i = 0 To UBound(Chts)        \n        Set Chts(i).EventChart = Nothing\n    Next i\n    On Error GoTo 0\nEnd Sub\n</code></pre>\n\n<p>Class <strong>AppEvents</strong></p>\n\n<pre><code>Private WithEvents EventApp As Excel.Application\n\n'*** Starting application event catcher\nPrivate Sub Class_Initialize()\n    Set EventApp = ActiveWorkbook.Application\nEnd Sub\n\n'*** When activating a sheet\nPrivate Sub EventApp_SheetActivate(ByVal sh As Object)\n    ChartEventsStart\n    ufEvents.Update \"Activated sheet \" &amp; sh.Name\nEnd Sub\n\n'*** When deactivating a sheet\nPrivate Sub EventApp_SheetDeactivate(ByVal sh As Object)\n    ChartEventsEnd\n    ufEvents.Update \"Dectivated sheet \" &amp; sh.Name\nEnd Sub\n\n'*** When changing tha range selection in a sheet\nPrivate Sub EventApp_SheetSelectionChange(ByVal sh As Object, ByVal Target As Range)\n    ufEvents.Update \"Changed selection in sheet \" &amp; sh.Name\nEnd Sub\n\n'*** When changing the content in a sheet\nPrivate Sub EventApp_SheetChange(ByVal sh As Object, ByVal Target As Range)\n    ufEvents.Update \"Changed sheet \" &amp; sh.Name\nEnd Sub\n</code></pre>\n\n<p>Class <strong>ChartEvents</strong></p>\n\n<pre><code>Public WithEvents EventChart As Chart\n\n'*** When activating a chart\nPrivate Sub EventChart_Activate()\n    ufEvents.Update \"Activated chart \" &amp; ActiveChart.Parent.Name\nEnd Sub\n\n'*** When deactivating a chart\nPrivate Sub EventChart_Deactivate()\n    ufEvents.Update \"Deactivated chart \" &amp; EventChart.Parent.Name\nEnd Sub\n\n'*** When clicking the mouse on a chart\nPrivate Sub EventChart_MouseDown(ByVal Button As Long, ByVal Shift As Long, ByVal x As Long, ByVal y As Long)\n    ufEvents.Update \"Mouse down on chart \" &amp; EventChart.Parent.Name\nEnd Sub\n\n'*** When changing the selection in a chart\nPrivate Sub EventChart_Select(ByVal ElementID As Long, ByVal Arg1 As Long, ByVal Arg2 As Long)\n    ufEvents.Update \"Changed selection in chart \" &amp; ActiveChart.Parent.Name\nEnd Sub\n\n</code></pre>\n\n<p>Userform <strong>ufEvents</strong></p>\n\n<pre><code>'*** Update form with last event and and selected object name\nPublic Sub Update(Optional ByVal lastEvent As String = vbNullString)\n\n    'add and last event in listbox and select it\n    If lastEvent &lt;&gt; vbNullString Then\n        lbxLog.AddItem lastEvent\n        lbxLog.ListIndex = lbxLog.ListCount - 1\n    End If\n\n    'display selected range address\n    If TypeName(Selection) = \"Range\" Then\n        txtSelection.Value = \"Range \" &amp; Selection.Address\n\n    'display selected object name\n    Else\n        txtSelection.Value = TypeName(Selection)\n    End If\nEnd Sub\n\n'*** End event catcher when closing form\nPrivate Sub UserForm_Terminate()\n    AppEventsEnd\nEnd Sub\n</code></pre>\n\n<p>When several charts are selected the statement <em>TypeName(Selection)</em> returns <strong>DrawingObjects</strong>, thus I know when I have selected multiple charts.</p>\n\n<p>I expected <em>_Activate</em> or <em>_MouseDown</em> to execute, when selecting at least one more chart with <strong>Ctrl</strong> and <strong>Left mouse click</strong>. This does not happen. In fact, no event is caught anymore when at least two charts are selected.</p>\n\n<p>I have tried to create a class similar to ChartEvents for e.g. shapes with </p>\n\n<pre><code>Public WithEvents obj As Shape\n</code></pre>\n\n<p>Unfortunately this does not work.</p>\n\n<p>Is there an event handler in Excel VBA to catch, when changing the selection of multiple charts?</p>\n\n<p>Thanks in advance for your support!\nImmanuel</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1568213901, "post_id": 57891345, "comment_id": 102205165, "body": "Nothing was recorded, because nothing actually happened - this is similar to changing the border width or color without actually drawing any borders, or toggling bold or italic without actually typing anything anywhere: as far as the worksheet is concerned, nothing happened. Your best bet is probably to locate the command you want to execute (you&#39;ll have to find it in <code>Application.CommandBars</code>), and execute it - if the command isn&#39;t in any <code>CommandBar</code>, your only shot might be to use <code>Application.SendKeys</code> to send the hotkey for the command you want to run."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1568214042, "post_id": 57891345, "comment_id": 102205262, "body": "...where is that <i>pen tool</i> command, exactly?"}, {"owner": {"reputation": 99, "user_id": 11890257, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WPUCCfI6R34/AAAAAAAAAAI/AAAAAAAAAGA/XSXgTWUhWEs/photo.jpg?sz=128", "display_name": "r z", "link": "https://stackoverflow.com/users/11890257/r-z"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1568214149, "post_id": 57891345, "comment_id": 102205318, "body": "The pen tool(s) is located under the Draw ribbon. You have to add-in the Draw ribbon in similar fashion to adding in the Developer Ribbon."}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 1, "creation_date": 1568214482, "post_id": 57891345, "comment_id": 102205500, "body": "As far As i know the recorder does not record this"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1568214498, "post_id": 57891345, "comment_id": 102205513, "body": "I have all Ribbon tabs shown, none of them is &quot;Draw&quot;, and the only thing I can find that remotely resembles &quot;pen&quot; is &quot;Pens&quot;, under &quot;Ink Tools&quot;, which would be a contextual Ribbon tab only shown when the current <code>Selection</code> makes sense for it. What version are you using?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1568214705, "post_id": 57891345, "comment_id": 102205634, "body": "@MathieuGuindon: That is available in 356 / off 2019 :)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568214813, "post_id": 57891345, "comment_id": 102205698, "body": "@SiddharthRout gah, I should have known, I have it at home... anyway I&#39;d try to locate the <code>CommandBarButton</code> for it if it exists, and run its <code>Execute</code> method once found. Failing that, <code>SendKeys</code> seems the only remaining option."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1568214887, "post_id": 57891345, "comment_id": 102205728, "body": "@MathieuGuindon: I was thinking the same LOL. Unfortunately I do not have 2016 (365 Pro) or 2019 at the moment..."}], "owner": {"reputation": 99, "user_id": 11890257, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WPUCCfI6R34/AAAAAAAAAAI/AAAAAAAAAGA/XSXgTWUhWEs/photo.jpg?sz=128", "display_name": "r z", "link": "https://stackoverflow.com/users/11890257/r-z"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 247, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1568211940, "creation_date": 1568211940, "question_id": 57891345, "link": "https://stackoverflow.com/questions/57891345/use-excel-vba-command-to-enable-drawpen-tool", "title": "Use Excel VBA command to enable Draw&gt;Pen tool", "body": "<p>I have a drawing that needs to be marked up in Sheet1. Originally, this was done by using a command button which creates a circle Shape. I'd instead like to use the Pen tool under the Draw ribbon to allow customization of the shape. Essentially, I would like a command button that, once pressed, enables the pen feature. </p>\n\n<p>I've already researched forums all around. I've also tried recording a macro but that doesn't work either. </p>\n\n<pre><code> Sub Macro1()\n 'My attempt at recording a macro for adding a rentangle.\n     ActiveSheet.Shapes.AddShape(msoShapeRectangle, 407.25, 77.25, 28.5, 27.75). _\n    Select\n End Sub\n\n Sub pen()\n 'My attempt at recording a macro which enables the pen feature. Nothing gets recorded.\n ' pen Macro\n '\n End Sub\n</code></pre>\n\n<p>No errors, just no drawing pen enabled/selected.</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 12053486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/177615f31f4455fbeee7f836928ab0b1?s=128&d=identicon&r=PG&f=1", "display_name": "Drac", "link": "https://stackoverflow.com/users/12053486/drac"}, "edited": false, "score": 0, "creation_date": 1568214440, "post_id": 57891905, "comment_id": 102205477, "body": "Oke i went with { If IsNull(DLookup(&quot;[jobnumber]&quot;, &quot;[courier]&quot;, &quot;[jobnumber]= &quot; &amp; Quote &amp; &quot;&#39;&quot;)) Then MsgBox &quot;its not in there&quot; Else MsgBox &quot;its in there&quot; End If } however now i get the syntaxerror 3075 in Query expression [Jobnumber]=480010013.  now I think I am one step closer cause the number is the actuall number from the Settings table."}, {"owner": {"reputation": 15, "user_id": 12053486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/177615f31f4455fbeee7f836928ab0b1?s=128&d=identicon&r=PG&f=1", "display_name": "Drac", "link": "https://stackoverflow.com/users/12053486/drac"}, "edited": false, "score": 0, "creation_date": 1568214697, "post_id": 57891905, "comment_id": 102205628, "body": "problem is its still not working. none of the msgboxes get triggered"}, {"owner": {"reputation": 15, "user_id": 12053486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/177615f31f4455fbeee7f836928ab0b1?s=128&d=identicon&r=PG&f=1", "display_name": "Drac", "link": "https://stackoverflow.com/users/12053486/drac"}, "edited": false, "score": 0, "creation_date": 1568215862, "post_id": 57891905, "comment_id": 102206277, "body": "Got it to work ! ofcourse with your help. here is the end result."}, {"owner": {"reputation": 15, "user_id": 12053486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/177615f31f4455fbeee7f836928ab0b1?s=128&d=identicon&r=PG&f=1", "display_name": "Drac", "link": "https://stackoverflow.com/users/12053486/drac"}, "edited": false, "score": 1, "creation_date": 1568215865, "post_id": 57891905, "comment_id": 102206281, "body": "If DLookup(&quot;jobnumber&quot;, &quot;courier&quot;, &quot;jobnumber =  &#39;&quot; &amp; Quote &amp; &quot;&#39;&quot;) &gt; 0 Then MsgBox &quot;its in there&quot; Else MsgBox &quot;its not in there&quot;"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "reply_to_user": {"reputation": 15, "user_id": 12053486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/177615f31f4455fbeee7f836928ab0b1?s=128&d=identicon&r=PG&f=1", "display_name": "Drac", "link": "https://stackoverflow.com/users/12053486/drac"}, "edited": false, "score": 0, "creation_date": 1568222450, "post_id": 57891905, "comment_id": 102209422, "body": "@Drac and what about jobnumber &lt;= 0, You can use<code>DCount</code>instead of <code>DLookUp</code>, but your problem is jobnumber not being a number. Confuse yourself;)"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 0, "last_activity_date": 1568213968, "creation_date": 1568213968, "answer_id": 57891905, "question_id": 57891321, "link": "https://stackoverflow.com/questions/57891321/ms-access-vba-access-dlookup-error-3464-cant-get-code-to-run/57891905#57891905", "title": "ms-access vba-access Dlookup error 3464 cant get code to run", "body": "<p>Try with:</p>\n\n<pre><code>If IsNull(DLookup(\"[jobnumber]\", \"[courier]\", \"[jobnumber]= \" &amp; Quote &amp; \"\") Then \n   MsgBox \"its not in there\" \nElse \n   MsgBox \"its in there\"\nEnd If\n</code></pre>\n\n<p>If <em>Jobnumber</em> is text, then:</p>\n\n<pre><code>If IsNull(DLookup(\"[jobnumber]\", \"[courier]\", \"[jobnumber]= '\" &amp; Quote &amp; \"'\") Then \n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 12053486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/177615f31f4455fbeee7f836928ab0b1?s=128&d=identicon&r=PG&f=1", "display_name": "Drac", "link": "https://stackoverflow.com/users/12053486/drac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 57891905, "answer_count": 1, "score": 1, "last_activity_date": 1594449585, "creation_date": 1568211855, "last_edit_date": 1594449585, "question_id": 57891321, "link": "https://stackoverflow.com/questions/57891321/ms-access-vba-access-dlookup-error-3464-cant-get-code-to-run", "title": "ms-access vba-access Dlookup error 3464 cant get code to run", "body": "<p>I am trying to make sure that a value from one single record table does not excist in another table.</p>\n\n<p>I have one table with a single record called Settings.\nI have a second table holding Unique ID's (jobnumber) called Courier.</p>\n\n<p>I am trying to make sure that the value Quotenumber in the table Settings does not excist in Jobnumber in the table Courier before moving on with the code. \nto test this I created the following.</p>\n\n<pre><code>Private Sub Knop0_Click()\nDim db As Database\nDim Mytable As Recordset\n\nSet db = CurrentDb()\nSet Mytable = db.OpenRecordset(\"settings\")\nSet Quote = Mytable!Quotenumber\n\nIf DLookup(\"[jobnumber]\", \"[courier]\", \"[jobnumber]= \" &amp; Quote) &gt; 0 Then MsgBox \"its in there\" Else MsgBox \"its not in there\"\n\n\nEnd Sub\n</code></pre>\n\n<p>when running the code i get Error 3464.\nI found the problem is with \"Quote\" and tried to use a couple of Dim to fix this but I just cant get it to work.</p>\n\n<p>Mind my experience with VBA is low and for every line of code i write i have to do extensive research. I have verry little knowledge of how DIM exactly works.</p>\n"}, {"tags": ["vba", "winapi", "integer", "long-integer"], "comments": [{"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1568215965, "post_id": 57891281, "comment_id": 102206356, "body": "More recent discussion: <a href=\"https://stackoverflow.com/questions/26717148/integer-vs-long-confusion\" title=\"integer vs long confusion\">stackoverflow.com/questions/26717148/integer-vs-long-confusi&zwnj;&#8203;on</a>"}, {"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1568217292, "post_id": 57891281, "comment_id": 102207035, "body": "According to GSerg in the link above the whole &quot;Integer is stored as Long&quot; thing may actually be wrong, even though it is written in the MS Docs that is referenced in your SO-Link (<a href=\"https://docs.microsoft.com/en-us/previous-versions/office/developer/office2000/aa164506(v=office.10)?redirectedfrom=MSDN\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/previous-versions/office/developer&zwnj;&#8203;/&hellip;</a>)"}], "answers": [{"tags": [], "owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "is_accepted": false, "score": 0, "last_activity_date": 1568212757, "last_edit_date": 1568212757, "creation_date": 1568212008, "answer_id": 57891366, "question_id": 57891281, "link": "https://stackoverflow.com/questions/57891281/correct-declaration-of-dword-in-vba/57891366#57891366", "title": "Correct declaration of DWord in VBA", "body": "<p>Your user defined type is 4 bytes is size, because <code>Integer</code> is 2 bytes in size.</p>\n\n<p>You can check this for yourself:</p>\n\n<pre><code>Dim dw as DWORD\nDim size as Integer\nsize = LenB(dw)\n</code></pre>\n"}], "owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 409, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568212757, "creation_date": 1568211731, "question_id": 57891281, "link": "https://stackoverflow.com/questions/57891281/correct-declaration-of-dword-in-vba", "title": "Correct declaration of DWord in VBA", "body": "<p>I'm using an API function which returns a <code>DWORD</code></p>\n\n<p>Because I want intellisense on the <code>LoWord</code> and <code>HiWord</code>, rather than using a <code>Long</code>:</p>\n\n<pre><code>Declare Sub myAPI(ByRef outVariable As Long)\n</code></pre>\n\n<p>...as suggested in <a href=\"https://codingdomain.com/visualbasic/win32api/datatypes/\" rel=\"nofollow noreferrer\">this list</a> of WinAPI -> VBA datatype conversions, I'm using a type:</p>\n\n<pre><code>Public Type DWORD 'same size as Long, but intellisense on members is nice\n    '@Ignore IntegerDataType\n    LoWord As Integer\n    '@Ignore IntegerDataType\n    HiWord As Integer\nEnd Type\n\nDeclare Sub myAPI(ByRef outVariable As DWORD)\n</code></pre>\n\n<p>However RubberDuck's <a href=\"http://rubberduckvba.com/Inspections/Details/IntegerDataType\" rel=\"nofollow noreferrer\">IntegerDataType</a> inspection reminded me that on 32 bit systems <a href=\"https://stackoverflow.com/a/26409520/6609896\">VBA converts 2-byte <code>Integer</code>s to 4-byte <code>Long</code>s internally</a>, so I'm wondering whether my DWORD declaration is really 4 consecutive bytes as expected, or 8.</p>\n\n<p>I'm not familiar enough with pointers and bits &amp; bytes to picture in my head what's going on, but I imagine the API somehow knows to fill only the lower half of each part, as I've been getting the results I expect (I think) from the API.</p>\n"}, {"tags": ["excel", "vba", "formula", "with-statement"], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 10424194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4P2iT.jpg?s=128&g=1", "display_name": "zepeu", "link": "https://stackoverflow.com/users/10424194/zepeu"}, "edited": false, "score": 0, "creation_date": 1568279142, "post_id": 57891564, "comment_id": 102226678, "body": "Thank&#39;s for your reply, so, you mean the <code>.Cells</code> depends on the actually selected cell? Or just the range in which it is working? if I use your last line, but just before do a <code>Worksheets().Range(&quot;B15&quot;).Activate</code>, the result of your line will be <code>B15</code>?"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1568212689, "creation_date": 1568212689, "answer_id": 57891564, "question_id": 57891056, "link": "https://stackoverflow.com/questions/57891056/different-ways-of-writing-the-same-formula-give-different-results/57891564#57891564", "title": "Different ways of writing the same formula give different results?", "body": "<p>Yes since you are using the <code>.Cells</code> in the formula it is appending that onto the with:</p>\n\n<p>First:</p>\n\n<pre><code>Worksheets(YearToFill).Cells(PosStartLine + (TPINb * 3) - 1, PosStartColumn + (ActiveColumn - 1) * NbRepairCodes + NbRepairCodes - 1).Address(False, False) \n</code></pre>\n\n<p>Second:</p>\n\n<pre><code>Worksheets(YearToFill).Cells(PosStartLine + (TPINb * 3) - 3, PosStartColumn + (ActiveColumn - 1)).Cells(PosStartLine + (TPINb * 3) - 1, PosStartColumn + (ActiveColumn - 1) * NbRepairCodes + NbRepairCodes - 1).Address(False, False) \n</code></pre>\n\n<p>Cells is relative to the parent:</p>\n\n<blockquote>\n  <p><code>Worksheets().Cells()</code></p>\n</blockquote>\n\n<p>Is relative to <code>A1</code></p>\n\n<p>But</p>\n\n<blockquote>\n  <p><code>Worksheets().Range(\"B10:B20\").Cells(1,1).Address(0,0)</code></p>\n</blockquote>\n\n<p>Will return <code>B10</code> not <code>A1</code> thus offsetting the address.</p>\n"}], "owner": {"reputation": 99, "user_id": 10424194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4P2iT.jpg?s=128&g=1", "display_name": "zepeu", "link": "https://stackoverflow.com/users/10424194/zepeu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 57891564, "answer_count": 1, "score": 0, "last_activity_date": 1568212689, "creation_date": 1568211037, "question_id": 57891056, "link": "https://stackoverflow.com/questions/57891056/different-ways-of-writing-the-same-formula-give-different-results", "title": "Different ways of writing the same formula give different results?", "body": "<p>I'm back with this formula I don't fully understand (but better than last time ;) <a href=\"https://stackoverflow.com/questions/57727825/how-to-add-a-dollar-sign-to-a-complex-formula\">How to add a Dollar $ sign to a complex formula?</a> ) and edited it to use it somewhere else...</p>\n\n<p>My question is simple, I take the exact same formula, but depending on how I write it in the \"with\", it don't give the same result :(</p>\n\n<p>My goal was to make a nice big \"with\" having the formula inserted in the cell, but also formatting the cell (color etc.)</p>\n\n<p>I have these 2 ways of writing it :</p>\n\n<p>the first one gives me the result I intend : <code>=AVERAGE('C Labour Rate'!c6:g6)</code> </p>\n\n<p>and the second gives : <code>=AVERAGE('C Labour Rate'!E9:I9)</code></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>With Worksheets(YearToFill) \n            .Cells(PosStartLine + (TPINb * 3) - 3, PosStartColumn + (ActiveColumn - 1)).Formula = \"=AVERAGE('\" &amp; LabourSheet &amp; \"'!\" &amp; .Cells(PosStartLine + (TPINb * 3) - 1, PosStartColumn + (ActiveColumn - 1) * NbRepairCodes) _\n            .Address(False, False) &amp; \":\" &amp; .Cells(PosStartLine + (TPINb * 3) - 1, PosStartColumn + (ActiveColumn - 1) * NbRepairCodes + NbRepairCodes - 1).Address(False, False) &amp; \")\"\n        End With\n</code></pre>\n\n<p>(this one gives <code>=AVERAGE('C Labour Rate'!C6:G6)</code> )</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>With Worksheets(YearToFill).Cells(PosStartLine + (TPINb * 3) - 3, PosStartColumn + (ActiveColumn - 1)) 'Formula for the average occurences of the TPI in Europe\n            .Formula = \"=AVERAGE('\" &amp; LabourSheet &amp; \"'!\" &amp; .Cells(PosStartLine + (TPINb * 3) - 1, PosStartColumn + (ActiveColumn - 1) * NbRepairCodes) _\n            .Address(False, False) &amp; \":\" &amp; .Cells(PosStartLine + (TPINb * 3) - 1, PosStartColumn + (ActiveColumn - 1) * NbRepairCodes + NbRepairCodes - 1).Address(False, False) &amp; \")\"\n        End With\n</code></pre>\n\n<p>(This second one gives <code>=AVERAGE('C Labour Rate'!E9:I9)</code> )</p>\n\n<p>What is happening in there? \nI even tried with the 2 formulas written down one after the other, and checking the result by running the code in step by step mode, it clearly don't have the same result...</p>\n\n<p>I guess it's the \".cells\" that makes the problems, but why? There is no \"offset\" or other function depending on the active cell...</p>\n\n<p>I don't understand, and I didn't find help on the internet, mostly because I don't know how to search for that :'(</p>\n\n<p>Thank's by advance for your help ! :)</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11, "user_id": 12053326, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCHVxadfeoSMcXfWPY4DKDqaJLAhu121Z4eirMwbg=k-s128", "display_name": "Horbaniuc Vlad", "link": "https://stackoverflow.com/users/12053326/horbaniuc-vlad"}, "edited": false, "score": 0, "creation_date": 1568215208, "post_id": 57891013, "comment_id": 102205883, "body": "Hello, I solved it. It was a stupid thing.     For iCounter = 2 To lc &#39;WorksheetFunction.CountA(Columns(1))      com.Activate             If Cells(iCounter, 6).Value = &quot;x&quot; Then"}], "owner": {"reputation": 11, "user_id": 12053326, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCHVxadfeoSMcXfWPY4DKDqaJLAhu121Z4eirMwbg=k-s128", "display_name": "Horbaniuc Vlad", "link": "https://stackoverflow.com/users/12053326/horbaniuc-vlad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1568281595, "creation_date": 1568210917, "last_edit_date": 1568281595, "question_id": 57891013, "link": "https://stackoverflow.com/questions/57891013/loop-stops-after-reaching-email-send-line-without-any-error", "title": "Loop stops after reaching Email.send line without any error", "body": "<p>I made a code, to send multiple emails based on a manual selection.\nMy problem is that when I'm reaching the .send email, the code does not go to the next \"For\" value. It sends the email, the loop stops, and the code starts from the beginning without following my For instruction anymore.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Sub MailTenders()\n' add ref - tool -&gt; references - &gt; Microsoft Outlook XX.X Object Library\n    Dim olApp As Outlook.Application\n\n\n    Dim Email As Outlook.MailItem\n\n\n' add ref - tool -&gt; references - &gt; Microsoft Word XX.X Object Library\n    Dim wdDoc As Word.Document '&lt;=========\n\n\n    Dim tempWB As Workbook\n    Set tempWB = ActiveWorkbook\n    Dim sht As Excel.Worksheet\n    Set sht = tempWB.Sheets(\"Email\")\n\n    Dim rng As Range\n    Set rng = sht.Range(\"A1:N22\").SpecialCells(xlCellTypeVisible)\n        'rng.Copy\n\n    Dim reg As Excel.Worksheet\n    Dim com As Excel.Worksheet\n    Dim edata As Excel.Worksheet\n    Dim lstrow As Range\n    Dim lastr_nr As Long\n    Dim lastc_nr As Long\n\n    Set reg = tempWB.Sheets(\"Register\")\n    Set com = tempWB.Sheets(\"Companies\")\n    Set edata = tempWB.Sheets(\"Email Data\")\n\n    Dim iCounter As Integer\n    Dim usermail As String\n    Dim compny As String\n    Dim atchm As String\n    Dim emailrng As Range, cl As Range\n    Dim sto As String\n    Dim lc As Integer\n\n\n    com.Activate\n    lc = Application.CountA(com.Range(\"A:A\"))\n\n    For iCounter = 2 To lc 'WorksheetFunction.CountA(Columns(1))\n            If Cells(iCounter, 6).Value = \"x\" Then\n\n    Set olApp = New Outlook.Application\n    Set Email = olApp.CreateItem(0)\n    Set wdDoc = Email.GetInspector.WordEditor\n\n    usermail = Cells(iCounter, 5).Value\n    compny = Cells(iCounter, 2).Value\n    atchm = Cells(iCounter, 4).Value\n\n                reg.Activate\n                Range(\"A1\").Select\n                Selection.End(xlDown).Select\n                Set lstrow = ActiveCell \n                lastr_nr = ActiveCell.Row   \n                Range(\"a\" &amp; lastr_nr + 1).Value = Range(\"a\" &amp; lastr_nr) + 1\n                Range(\"b\" &amp; lastr_nr + 1).Select\n                ActiveCell.FormulaR1C1 = \"=NOW()\"\n                ActiveCell.Copy\n                ActiveCell.PasteSpecial (xlPasteValues)\n                Range(\"c\" &amp; lastr_nr + 1).Value = compny\n                Range(\"d\" &amp; lastr_nr + 1).Value = atchm\n\n                edata.Activate\n                Range(\"B9\").Select\n                Set emailrng = Range(Selection, Selection.End(xlToRight))\n                lastc_nr = ActiveCell.Column\n                sto = \"\"\n                For Each cl In emailrng\n                sto = sto &amp; \";\" &amp; cl.Value\n                Next\n                sto = Mid(sto, 2)\n\n                com.Activate\n\n\n\n\n    rng.Copy\n\n        With Email\n        .To = usermail\n        .CC = sto\n        .Subject = \"Cerere oferta pentru proiectul \" &amp; edata.Range(\"B1\").Value\n        wdDoc.Range.PasteAndFormat Type:=wdFormatOriginalFormatting\n'        .Display\n        .Attachments.Add \"c:\\Users\\HorbaniucVla\\OneDrive - Strabag BRVZ GmbH\\BL 2019\\CJV Vintu - Simeria\\14. Tenders\\02. CP\\Atasamente\\\" &amp; atchm &amp; \".zip\"\n        .SaveAs \"c:\\Users\\HorbaniucVla\\OneDrive - Strabag BRVZ GmbH\\BL 2019\\CJV Vintu - Simeria\\14. Tenders\\02. CP\\Offers Sent\\\" &amp; edata.Range(\"b10\") &amp; \".msg\", OlSaveAsType.olMsg\n        .send '!!!Here the code stops after sending the first email !!!\n        End With\n\n     reg.Activate\n     Range(\"e\" &amp; lastr_nr + 1).Select\n     Range(\"e\" &amp; lastr_nr + 1).Hyperlinks.Add Anchor:=Selection, Address:=\"c:\\Users\\HorbaniucVla\\OneDrive - Strabag BRVZ GmbH\\BL 2019\\CJV Vintu - Simeria\\14. Tenders\\02. CP\\Offers Sent\\\" &amp; edata.Range(\"b10\") &amp; \".msg\", TextToDisplay:=\"draft email link\"\n     Range(\"f\" &amp; lastr_nr + 1).Select\n     Range(\"e\" &amp; lastr_nr + 1).Hyperlinks.Add Anchor:=Selection, Address:=\"c:\\Users\\HorbaniucVla\\OneDrive - Strabag BRVZ GmbH\\BL 2019\\CJV Vintu - Simeria\\14. Tenders\\02. CP\\Atasamente\\\" &amp; atchm &amp; \".zip\", TextToDisplay:=\"attachement link\"\n    End If\n    Next iCounter\n\nEnd Sub\n</code></pre>\n\n<p>For a better understanding, I also made a GIF with the code step into which unfortunately it is bigger than 2mb and I will share <a href=\"https://www.dropbox.com/s/g3hdkcdppbq4t4m/2019-09-11_16-54-08.gif?dl=0\" rel=\"nofollow noreferrer\">via dropbox</a>.\nThe GIF is animated, but I noticed is not working without download.</p>\n"}, {"tags": ["vba", "vb.net", "visual-studio", "datagridview", "autocomplete"], "comments": [{"owner": {"reputation": 1428, "user_id": 3260548, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/8uqgR.png?s=128&g=1", "display_name": "Oak_3260548", "link": "https://stackoverflow.com/users/3260548/oak-3260548"}, "edited": false, "score": 0, "creation_date": 1568214925, "post_id": 57890815, "comment_id": 102205758, "body": "I&#39;ve just tested few scenarios and I was unsuccessfull. The function to move to the next cell was easy, but it all ends up on the fact that <code>EditingControlShowing</code> eats up the <code>Enter</code> key and won&#39;t pass it to i.e. further <code>KeyDown</code>, which I hooked up. It works with all keys but <code>Enter</code>, doh. Of course, one way is to use <code>TAB</code> key instead :-). But that&#39;s not an anwer to your question..."}, {"owner": {"reputation": 1732, "user_id": 11982798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99629abfd4d6ce4b3702d84cf1a1eef0?s=128&d=identicon&r=PG&f=1", "display_name": "user11982798", "link": "https://stackoverflow.com/users/11982798/user11982798"}, "edited": false, "score": 0, "creation_date": 1568241842, "post_id": 57890815, "comment_id": 102216169, "body": "In my scenario, I make autocomplete by myself, by using event of textchange, keydown and keypress, I directly find just top 1 of record each time to I change my text in cell."}, {"owner": {"reputation": 1732, "user_id": 11982798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99629abfd4d6ce4b3702d84cf1a1eef0?s=128&d=identicon&r=PG&f=1", "display_name": "user11982798", "link": "https://stackoverflow.com/users/11982798/user11982798"}, "edited": false, "score": 0, "creation_date": 1568243416, "post_id": 57890815, "comment_id": 102216514, "body": "In another schenario, autoText declaration is put generally withevents, end then use previewkeyevent of autotext to run code of If e.KeyCode = Keys.Enter Then,  DataGridView1.EndEdit(), do validation, and last time set pos of cell, example: DataGridView1.CurrentCell = DataGridView1.Item(1, 0),  End If"}], "answers": [{"tags": [], "owner": {"reputation": 1428, "user_id": 3260548, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/8uqgR.png?s=128&g=1", "display_name": "Oak_3260548", "link": "https://stackoverflow.com/users/3260548/oak-3260548"}, "is_accepted": false, "score": 0, "last_activity_date": 1568217167, "last_edit_date": 1568217167, "creation_date": 1568215552, "answer_id": 57892358, "question_id": 57890815, "link": "https://stackoverflow.com/questions/57890815/how-to-make-datagridview-move-to-next-cell-instead-of-next-row-after-autocomplet/57892358#57892358", "title": "How to make DataGridView move to next cell instead of next row after AutoComplete string selection made VB.net?", "body": "<p>I've tested few scenarios and found out, that the <code>Enter</code> key wouldn't work (all but <code>Enter</code> works). I found <a href=\"https://social.msdn.microsoft.com/Forums/en-US/20ac423e-8ad4-4281-a8ca-e37d5380d3df/datagridview-event-to-handle-enter-key?forum=winforms\" rel=\"nofollow noreferrer\">this answer on MSDN</a>:</p>\n\n<blockquote>\n  <p>For the enter key, ProcessDataGridViewKey will return true meaning that it has handled the key so you won't get a KeyDown event for it.</p>\n  \n  <p>If you override ProcessDataGridViewKey and handle the enter key making it return false, you will get the key events you are expecting.</p>\n</blockquote>\n\n<pre><code>{\n Keys key = (e.KeyCode &amp; Keys::KeyCode); //removes control, alt modifiers\n  if(key == Keys.Enter)\n {\n   //Still do the default processing for enter so it will move down to the next row\n   Base.ProcessDataGridViewKey(e);\n   return false; //say we have *not* handled the key\n }\n else\n {\n   return Base.ProcessDataGridViewKey(e);\n }\n}\n</code></pre>\n\n<p>The above code is in C#, obvously.</p>\n\n<p>The move function then may look like this (tested only VB.NET version bellow and only with other keys than <code>Enter</code>):</p>\n\n<pre><code>Private Sub DataGridView1_EditingControlShowing(sender As Object, e As DataGridViewEditingControlShowingEventArgs) Handles DataGridView1.EditingControlShowing\n    If IsNothing(TryCast(e.Control, DataGridViewTextBoxEditingControl)) = False Then\n        Dim tb As DataGridViewTextBoxEditingControl = e.Control\n        AddHandler e.Control.KeyDown, AddressOf DataGridView1_Keydown\n    End If\nEnd Sub\n\nPrivate Sub DataGridView1_Keydown(sender As Object, e As KeyEventArgs) ' Handles DataGridView1.KeyDown\n    Dim dgv As DataGridView = DataGridView1\n    Dim tb As TextBox = CType(sender, TextBox)\n    If e.KeyCode = Keys.Enter Then\n        e.SuppressKeyPress = True\n        dgv.EndEdit()\n        If IsNothing(dgv.CurrentCell) = False Then\n            Dim cc As DataGridViewCell = dgv.CurrentCell\n            If cc.ColumnIndex &lt; dgv.Columns.Count - 2 Then ' if there's a cell to the right of the current one\n                dgv.CurrentCell = dgv.Rows(cc.RowIndex).Cells(cc.ColumnIndex + 1)\n            ElseIf cc.RowIndex &lt; dgv.Rows.Count - 1 Then   ' if there's a row bellow\n                dgv.CurrentCell = dgv.Rows(cc.RowIndex + 1).Cells(0)\n            Else\n                ' do nothing, stay where you are\n            End If\n            dgv.CurrentCell.Selected = True\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 12053377, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zHQ3P.jpg?s=128&g=1", "display_name": "CShep878", "link": "https://stackoverflow.com/users/12053377/cshep878"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 174, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1568217167, "creation_date": 1568210295, "question_id": 57890815, "link": "https://stackoverflow.com/questions/57890815/how-to-make-datagridview-move-to-next-cell-instead-of-next-row-after-autocomplet", "title": "How to make DataGridView move to next cell instead of next row after AutoComplete string selection made VB.net?", "body": "<p>I have a DataGridView where some of the cells only allow values from an AutoCompleteStringCollection. When I enter the cell and begin to type a value, a drop-down window appears with viable options. If I finish typing it out and hit enter or tab, I go to the next cell. However, if I start typing and then select an option from the drop-down menu, it moves one row down in the same column. I\u2019d like it to move to the next cell/next column SAME row after selecting from the drop-down box. Any idea how I go about doing this. Thanks in advance for your help!!</p>\n\n<pre><code>Private Sub getData(ByVal DataCol As AutoCompleteStringCollection)\n    Dim comm As SqlCommand\n    Dim adapt As New SqlDataAdapter\n    Dim ds As New DataSet\n\n    Dim sql As String = \"SELECT DISTINCT ValueOption From HR.dbo.RecruitVal WHERE ColumnName = 'Source'\"\n\n    Try\n\n        If SqlConn.State = ConnectionState.Broken Then SqlConn.Close()\n        If SqlConn.State = ConnectionState.Closed Then SqlConn.Open()\n\n        comm = New SqlCommand(sql, SqlConn)\n        adapt.SelectCommand = comm\n        adapt.Fill(ds)\n        adapt.Dispose()\n        comm.Dispose()\n        For Each row As DataRow In ds.Tables(0).Rows\n            DataCol.Add(row(0).ToString())\n        Next\n    Catch ex As Exception\n        MessageBox.Show(\"Error\")\n    End Try\n\nEnd Sub\n\n\nPrivate Sub RAppSrc(sender As Object, e As DataGridViewEditingControlShowingEventArgs) Handles RAppGrid.EditingControlShowing\n    Dim titleText As String = RAppGrid.Columns(RAppGrid.CurrentCell.ColumnIndex).HeaderText\n    If titleText.Equals(\"Source\") Then\n        Dim autoText As TextBox = TryCast(e.Control, TextBox)\n        If autoText IsNot Nothing Then\n            autoText.AutoCompleteMode = AutoCompleteMode.SuggestAppend\n            autoText.AutoCompleteSource = AutoCompleteSource.CustomSource\n            Dim dataCol As New AutoCompleteStringCollection()\n            getData(dataCol)\n            autoText.AutoCompleteCustomSource = dataCol\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>Cell - Validating  </p>\n\n<pre><code>    If (appCol.Name = \"Source\") Then\n        Dim sql As String = \" SELECT 1 FROM Hr.dbo.RecruitVal WHERE ColumnName = 'Source'AND ValueOption = @Source \"\n        Dim sql2 As String = \"SELECT DISTINCT ValueOption from HR.dbo.RecruitVal WHERE ColumnName = 'Source' \"\n        Dim com As New SqlCommand(sql, SqlConn)\n        Dim com2 As New SqlCommand(sql2, SqlConn)\n        Dim reader As SqlDataReader\n        Dim val As String\n        Dim val2 As String\n        com.Parameters.Add(\"@Source\", SqlDbType.VarChar).Value = e.FormattedValue\n        val = com.ExecuteScalar()\n        reader = com2.ExecuteReader()\n        If reader.HasRows Then\n            While reader.Read()\n                val2 += reader.GetValue(0) &amp; \",\" &amp; Space(3)\n            End While\n        End If\n        If String.IsNullOrEmpty(e.FormattedValue) Then\n            'Do Nothing\n        ElseIf val = Nothing Then\n            MessageBox.Show(\" Please Enter a valid Source Option\" &amp; vbCrLf &amp; vbCrLf &amp; \"Valid Options are as Follows:\" &amp; vbCrLf &amp; vbCrLf + val2.ToString(), \"VALIDATION ERROR\", MessageBoxButtons.OK, MessageBoxIcon.Error)\n            RAppGrid.EndEdit()\n        End If\n    End If\n</code></pre>\n\n<p>\n</p>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1568211452, "post_id": 57890359, "comment_id": 102203743, "body": "Does your range contain empty cells ?"}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 1, "creation_date": 1568218158, "post_id": 57890359, "comment_id": 102207509, "body": "What are the dimensions of <code>StrArray</code>? In your code it is treated as 1-D <code>StrArray(i)</code> and 2-D <code>StrArray(1, i)</code>."}], "owner": {"reputation": 1, "user_id": 12053257, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBsCMh26JcOAFm3J2UIzg2wBOaxhu44dE9wvF7s=k-s128", "display_name": "Julien Nunes Goncalves", "link": "https://stackoverflow.com/users/12053257/julien-nunes-goncalves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568220719, "creation_date": 1568208594, "last_edit_date": 1568220719, "question_id": 57890359, "link": "https://stackoverflow.com/questions/57890359/userform-being-initialized-unexpectedly-in-the-middle-of-a-button-click-sub", "title": "UserForm being initialized unexpectedly in the middle of a button_click() sub", "body": "<p>I have a basic UserForm which allows the user to add values to a list in a range. In the middle of a button_click() private sub, the userform \"crashes\" and goes to the the Private Sub UserForm_Initialize().</p>\n\n<p>The error occurs in the following loop:</p>\n\n<pre><code>i = 0\n\nFor Each Cell In Range(\"GHKDelegates\")\n    Cell.Value = StrArray(i) 'this is where the error occurs\n    If Str = \"\" Then\n        Str = StrArray(i)\n        i = i + 1\n    Else\n        Str = Str &amp; vbCrLf &amp; StrArray(1, i)\n        i = i + 1\n    End If\nNext Cell\n</code></pre>\n\n<p>No error message is shown, hence the confusion as to why  this is happening.</p>\n"}, {"tags": ["vba", "events", "combobox"], "comments": [{"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 0, "creation_date": 1568206912, "post_id": 57889376, "comment_id": 102201130, "body": "What is the issue you&#39;re having?"}, {"owner": {"reputation": 19, "user_id": 11164553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3d653a749abf365db92cc2a84d4c22c?s=128&d=identicon&r=PG&f=1", "display_name": "SuperMan", "link": "https://stackoverflow.com/users/11164553/superman"}, "reply_to_user": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 0, "creation_date": 1568208810, "post_id": 57889376, "comment_id": 102202249, "body": "When I select a value in ComboBox 1, I want ComboBox 2 to be populated dynamically (No click used) @Brian M Stafford"}, {"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 1, "creation_date": 1568209128, "post_id": 57889376, "comment_id": 102202438, "body": "Try putting your code into <code>ComboBox3_Change</code>."}, {"owner": {"reputation": 19, "user_id": 11164553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3d653a749abf365db92cc2a84d4c22c?s=128&d=identicon&r=PG&f=1", "display_name": "SuperMan", "link": "https://stackoverflow.com/users/11164553/superman"}, "reply_to_user": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 0, "creation_date": 1568211074, "post_id": 57889376, "comment_id": 102203536, "body": "I did what u said, and it works @Brian M Stafford"}], "answers": [{"comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1568242664, "post_id": 57890370, "comment_id": 102216354, "body": "Don&#39;t you think that call looks ugly? Especially on Subs. Just use<code>PopulateCombo4 .ComboBox3.value</code>.Force OP to use some naming pattern except the auto-generated e.g. <code>ComboView</code>, <code>ComboPeriod</code>,<code>ComboYear</code>.Use <code>Select Case</code>if you have to tell appart several conditions on a value, and I would build the combo itemd by a for ... loop (and<code>MonthName(n,False)</code>). You know <a href=\"https://github.com/rubberduck-vba/Rubberduck/\" rel=\"nofollow noreferrer\">RubberduckVBA</a>? That will suggest other optimizations too (and the other features and the <a href=\"https://rubberduckvba.wordpress.com/2019/07/08/about-class-modules/\" rel=\"nofollow noreferrer\">blog</a>)"}], "tags": [], "owner": {"reputation": 103, "user_id": 11467339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d518f6c521ab7629fc0b0b9236b9cc?s=128&d=identicon&r=PG&f=1", "display_name": "Palinnalip", "link": "https://stackoverflow.com/users/11467339/palinnalip"}, "is_accepted": false, "score": 0, "last_activity_date": 1568208643, "creation_date": 1568208643, "answer_id": 57890370, "question_id": 57889376, "link": "https://stackoverflow.com/questions/57889376/how-to-trigger-event-in-one-combobox-when-value-selected-in-another-combobox/57890370#57890370", "title": "How to trigger event in one ComboBox when value selected in another ComboBox?", "body": "<ol>\n<li>I'd break it up into two functions, easier to maintain.</li>\n<li>you can use arrays to make code smaller</li>\n<li>My code assumes ComboBox3 contains the filter and combo4 is what needs to be populated. I think you may have mixed those two up above.</li>\n</ol>\n\n<pre><code>Private Sub ComboBox3_Change()\n\n    with thisworkbook.worksheets(\"Summary\")\n        call PopulateCombo4(.ComboBox3.value)\n    end with\n\nend sub\n</code></pre>\n\n<pre><code>Private Sub PopulateCombo4(val as string)\n\n    thisworkbook.worksheets(\"Summary\").combobox4.clear\n\n    dim arr() as string\n    if val = \"QUARTERLY\" then\n        arr = split(\"Q1,Q2,Q3,Q4\")\n    Elseif val = \"WEEKLY\" then\n        '....[same as above with W1,W2....]\n    end if            \n\n    dim s as string\n    for each s in arr\n        thisworkbook.worksheets(\"Summary\").combobox4.additem s\n    next\n\nend sub\n\n</code></pre>\n\n<p>Let me know if you have any follow up Qs. going to meeting.</p>\n"}], "owner": {"reputation": 19, "user_id": 11164553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3d653a749abf365db92cc2a84d4c22c?s=128&d=identicon&r=PG&f=1", "display_name": "SuperMan", "link": "https://stackoverflow.com/users/11164553/superman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568237699, "creation_date": 1568205449, "last_edit_date": 1568237699, "question_id": 57889376, "link": "https://stackoverflow.com/questions/57889376/how-to-trigger-event-in-one-combobox-when-value-selected-in-another-combobox", "title": "How to trigger event in one ComboBox when value selected in another ComboBox?", "body": "<p>I have a ComboBox \"select the view\" which contains (WEEK, MONTH, QUARTER and ALL). I would like when the first ComboBox is selected for example : \"WEEK\", the second ComboBox \"select the period\" will be populated without a click button with \"W1,W2,....W52\" or if we select \"QUARTER\" will be populated with \"Q1,Q2,Q3,Q4\" etc. </p>\n\n<p><a href=\"https://i.stack.imgur.com/XthhH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XthhH.png\" alt=\"Form View\"></a></p>\n\n<p>I tried the code below but it didn't work quite well. </p>\n\n<pre><code>Private Sub ComboBox4_Change()\n\nDim index As Integer\n\nWith Sheets(\"SUMMARY\")\nindex = .ComboBox3.ListIndex\n    .ComboBox4.Clear\n\n    With .ComboBox4\n        Select Case index\n            Case Is = 0\n                .AddItem \"W1\"\n                .AddItem \"W2\"\n                .AddItem \"W3\"\n                .AddItem \"W4\"\n                .AddItem \"W5\"\n                .AddItem \"W6\"\n                .AddItem \"W7\"\n                .AddItem \"W8\"\n                .AddItem \"W9\"\n                .AddItem \"W10\"\n                .AddItem \"W11\"\n                .AddItem \"W12\"\n                .AddItem \"W13\"\n                .AddItem \"W14\"\n                .AddItem \"W15\"\n                .AddItem \"W16\"\n                .AddItem \"W17\"\n                .AddItem \"W18\"\n                .AddItem \"W19\"\n                .AddItem \"W20\"\n                .AddItem \"W21\"\n                .AddItem \"W22\"\n                .AddItem \"W23\"\n                .AddItem \"W24\"\n                .AddItem \"W25\"\n                .AddItem \"W26\"\n                .AddItem \"W27\"\n                .AddItem \"W28\"\n                .AddItem \"W29\"\n                .AddItem \"W30\"\n                .AddItem \"W31\"\n                .AddItem \"W32\"\n                .AddItem \"W33\"\n                .AddItem \"W34\"\n                .AddItem \"W35\"\n                .AddItem \"W36\"\n                .AddItem \"W37\"\n                .AddItem \"W38\"\n                .AddItem \"W39\"\n                .AddItem \"W40\"\n                .AddItem \"W41\"\n                .AddItem \"W42\"\n                .AddItem \"W43\"\n                .AddItem \"W44\"\n                .AddItem \"W45\"\n                .AddItem \"W46\"\n                .AddItem \"W47\"\n                .AddItem \"W48\"\n                .AddItem \"W49\"\n                .AddItem \"W50\"\n                .AddItem \"W51\"\n                .AddItem \"W52\"\n\n            Case Is = 1\n                .AddItem \"JANUARY\"\n                .AddItem \"FEBRUARY\"\n                .AddItem \"MARCH\"\n                .AddItem \"APRIL\"\n                .AddItem \"MAY\"\n                .AddItem \"JUNE\"\n                .AddItem \"JULY\"\n                .AddItem \"AUGUST\"\n                .AddItem \"SEPTEMBER\"\n                .AddItem \"OCTOBER\"\n                .AddItem \"NOVEMBER\"\n                .AddItem \"DECEMBER\"\n\n            Case Is = 2\n                .AddItem \"Q1\"\n                .AddItem \"Q2\"\n                .AddItem \"Q3\"\n                .AddItem \"Q4\"\n            Case Is = 3\n                .AddItem \"ALL\"\n        End Select\n    End With\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 5, "creation_date": 1568206022, "post_id": 57889073, "comment_id": 102200596, "body": "<code>DoCmd.TransferText AcTextTransdertype:=acExportDelim, Specificationname:=&quot;bah&quot;, TableName:=&quot;average&quot;, Filename:=&quot;C:\\Users\\Me\\Desktop\\Folderx\\export.csv&quot;, HasFieldNames:=True</code> Get rid of the parenthesis you aren&#39;t returning anything to a variable."}, {"owner": {"reputation": 350, "user_id": 6444557, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh6.googleusercontent.com/-h_y6yzKOSHg/AAAAAAAAAAI/AAAAAAAAAAA/t43cjwS-Y6g/photo.jpg?sz=128", "display_name": "Elliott Addi", "link": "https://stackoverflow.com/users/6444557/elliott-addi"}, "edited": false, "score": 1, "creation_date": 1568210241, "post_id": 57889073, "comment_id": 102203078, "body": "Another method would be to manually extract it - with right click on the table you wish to export &gt; text file. If the extract needs to be repeated, you can save the export step and retrieve it on the &quot;external data&quot; tab &gt; &quot;Saved exports&quot; button. Saved exports can also be called with vba with <code>DoCmd.RunSavedImportExport SavedImportExportName:=aName</code>"}], "owner": {"reputation": 109, "user_id": 9643356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49466631764d01008df6f46ed1223929?s=128&d=identicon&r=PG&f=1", "display_name": "S&#225;tiro", "link": "https://stackoverflow.com/users/9643356/s%c3%a1tiro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594449594, "creation_date": 1568204542, "last_edit_date": 1594449594, "question_id": 57889073, "link": "https://stackoverflow.com/questions/57889073/how-to-transfer-access-table-to-a-csv-file", "title": "How to transfer access table to a CSV file?", "body": "<p>I have a syntax error with code below, although I have created a specification name I can't export my access table to a CSV file. </p>\n\n<p>Can you help me find what I'm doing wrong, please?</p>\n\n<pre><code>DoCmd.TransferText(AcTextTransdertype:= acExportDelim, \nSpecificationname:=\"bah\" , TableName:=\"average\", \nFileName:=\"C:\\Users\\Me\\Desktop\\Folderx\\export.csv\", \nHasFieldNames:=True)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1568204784, "post_id": 57888884, "comment_id": 102199877, "body": "Out of interest, is there a reason you&#39;re using case select rather than a simple if-statement, since you&#39;re only checking for one argument? Not sure if that has any influence on the speed but it seems a bit excessive in this case."}, {"owner": {"reputation": 15, "user_id": 6735475, "user_type": "registered", "profile_image": "https://graph.facebook.com/1137034939687830/picture?type=large", "display_name": "Ivans Nozdra\u010devs", "link": "https://stackoverflow.com/users/6735475/ivans-nozdra%c4%8devs"}, "reply_to_user": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1568205898, "post_id": 57888884, "comment_id": 102200530, "body": "Hello. Yes, it also seemed to me, that Select/Case is a bit too complicated for one check. The reason was to keep the code the same, if I will be scaling this to another set of data (with more checks to perform)."}, {"owner": {"reputation": 15, "user_id": 6735475, "user_type": "registered", "profile_image": "https://graph.facebook.com/1137034939687830/picture?type=large", "display_name": "Ivans Nozdra\u010devs", "link": "https://stackoverflow.com/users/6735475/ivans-nozdra%c4%8devs"}, "reply_to_user": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1568209205, "post_id": 57888884, "comment_id": 102202488, "body": "Following up to the comments below, I shall CLEAR the row, rather than DELETE it row-by-row and then sort the entire dataset."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 6735475, "user_type": "registered", "profile_image": "https://graph.facebook.com/1137034939687830/picture?type=large", "display_name": "Ivans Nozdra\u010devs", "link": "https://stackoverflow.com/users/6735475/ivans-nozdra%c4%8devs"}, "edited": false, "score": 0, "creation_date": 1568206099, "post_id": 57889278, "comment_id": 102200642, "body": "Thank you for your reply. The columns contain numeric values &gt;=0 and blanks. Though about this also, but for the sake of time saving, considered creating new set of data a liability. I&#39;ll try to see, how the code works. Thanks again."}], "tags": [], "owner": {"reputation": 356, "user_id": 9635098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a781d7fd3cacab5fbc08554bc8dfb759?s=128&d=identicon&r=PG&f=1", "display_name": "Beek", "link": "https://stackoverflow.com/users/9635098/beek"}, "is_accepted": true, "score": 1, "last_activity_date": 1568205646, "last_edit_date": 1568205646, "creation_date": 1568205165, "answer_id": 57889278, "question_id": 57888884, "link": "https://stackoverflow.com/questions/57888884/how-to-delete-rows-from-table-based-on-parameter-check-by-formula/57889278#57889278", "title": "How to delete rows from table, based on parameter check by formula?", "body": "<p>Having to go through it line for line isn't the fast way to do this. You would be better off with a temporary helper column which calculates the sum. You can then filter the range on this column and delete all rows that match your criteria at once. So something like this. (assuming Column H is empty)</p>\n\n<pre><code>Dim currentRow As Integer\nDim rowCheck As Long\nDim ws As Worksheet\nDim lastRow as integer\n\nSet ws = ActiveSheet\n\nlastRow = ws.UsedRange.Rows.Count\n\nws.range(\"h2\").formula = \"=sum(e2:g2)\"\n\nws.range(\"h2\").autofill destination:= ws.range(\"h2:h\" &amp; lastRow)\n\nws.range(\"a1:h1\").autofilter field:=8, criteria1:=\"0\"\n\nws.range(\"a2:h\" &amp; lastRow).SpecialCells(xlCellTypeVisible).entirerow.delete\nws.autofiltermode = false\n\nws.range(\"h1:h\" &amp; lastRow).clearcontents\n\nset ws = Nothing\n\n</code></pre>\n\n<p>Edit: You could also filter columns E, F, and G on 0 but that only works if all values are 0 or positive. Doing it the way I suggested gives you more control, because you can easily adjust the formula you put in cell H2.</p>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 6735475, "user_type": "registered", "profile_image": "https://graph.facebook.com/1137034939687830/picture?type=large", "display_name": "Ivans Nozdra\u010devs", "link": "https://stackoverflow.com/users/6735475/ivans-nozdra%c4%8devs"}, "edited": false, "score": 0, "creation_date": 1568206203, "post_id": 57889317, "comment_id": 102200709, "body": "Thank you for your reply. I thought about it also, just could not manage to find the way to select the columns properly. maybe something in the code, that followed (for the purposes of clean question, I have cut the irrelevant lines, containing formatting etc.)"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1568207123, "post_id": 57889317, "comment_id": 102201274, "body": "Omitting the use of <code>.select</code> negates the need for screenupdating to be turned off. You can do <code>Rows(Delete_Row_List).Delete</code> directly. <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">Using select should be done sparingly</a> as it invites user error."}, {"owner": {"reputation": 41, "user_id": 11641222, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155633646765675/picture?type=large", "display_name": "Carl Kirstein", "link": "https://stackoverflow.com/users/11641222/carl-kirstein"}, "reply_to_user": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1568207482, "post_id": 57889317, "comment_id": 102201473, "body": "thank @Plutian I made the edit. You are right, just left the bad coding there in my haste \ud83d\ude01"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1568207603, "post_id": 57889317, "comment_id": 102201547, "body": "No worries. It has been pointed out in my own answers a few times, so I&#39;m just passing on the Karma so we can all learn."}], "tags": [], "owner": {"reputation": 41, "user_id": 11641222, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155633646765675/picture?type=large", "display_name": "Carl Kirstein", "link": "https://stackoverflow.com/users/11641222/carl-kirstein"}, "is_accepted": false, "score": 1, "last_activity_date": 1568207416, "last_edit_date": 1568207416, "creation_date": 1568205272, "answer_id": 57889317, "question_id": 57888884, "link": "https://stackoverflow.com/questions/57888884/how-to-delete-rows-from-table-based-on-parameter-check-by-formula/57889317#57889317", "title": "How to delete rows from table, based on parameter check by formula?", "body": "<p>It will be much faster to find all the rows that you want to delete, select all the rows, and delete them in one go, instead of doing it row by row. </p>\n\n<p>let's say you found you wanted to delete rows 35, 37, 39, and 40 then the code will be something like</p>\n\n<pre><code>for each row in row_to_evaluate\n    delete_row = evaluate(row)\n    if delete_row = True then Delete_Row_List = Delete_Row_List &amp; \",\" &amp; row\nnext\n\n'Example: Delete_Row_List = \"35,37,39,40\"\nRows(Delete_Row_List).Delete Shift:=xlUp\n</code></pre>\n\n<p>also remember application.screenupdating = False before you run the code and application.screenupdating = True after you run it for a bit better performance.</p>\n\n<p>hope it helps</p>\n\n<p>EDIT:\nAh I see an answer before mine basically recommended the same</p>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 6735475, "user_type": "registered", "profile_image": "https://graph.facebook.com/1137034939687830/picture?type=large", "display_name": "Ivans Nozdra\u010devs", "link": "https://stackoverflow.com/users/6735475/ivans-nozdra%c4%8devs"}, "edited": false, "score": 1, "creation_date": 1568266799, "post_id": 57900015, "comment_id": 102221262, "body": "Thank you for the update. I have tried different approaches, however the fastest one was from Mr. Beek (create checksum column &gt; populate it &gt; apply autofilter &gt; filter out &#39;0&#39; &gt; delete rows &gt; delete checksum column)."}], "tags": [], "owner": {"reputation": 41, "user_id": 11641222, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155633646765675/picture?type=large", "display_name": "Carl Kirstein", "link": "https://stackoverflow.com/users/11641222/carl-kirstein"}, "is_accepted": false, "score": 0, "last_activity_date": 1568264613, "creation_date": 1568264613, "answer_id": 57900015, "question_id": 57888884, "link": "https://stackoverflow.com/questions/57888884/how-to-delete-rows-from-table-based-on-parameter-check-by-formula/57900015#57900015", "title": "How to delete rows from table, based on parameter check by formula?", "body": "<p>It just occurred to me to speed up your code substantially. I assumed that you have to use the delete rows capability, but it will actually be much faster to do the following (note this is pseudo code, panel beat to work for you):</p>\n\n<pre><code>with thisworkbook.worksheets(\"Sheet1\")\n    redim New_Sheet(1 to nr_rows, 1 to nr_columns) as variant\n    Old_Sheet = .range(.cells(1,1),.cells(nr_rows,nr_columns)\n    'keep the headers\n    for col = 1 to nr_columns\n         New_Sheet(1,col) = Old_Sheet(1,col)\n    next col\n    k = 1\n    for row = 2 to nr_rows 'start at 2 to protect the headers\n        keep_row = evaluate_row(row,Old_sheet) 'this function must evaluate the row. return True if you want to keep the row, return false if you want to delete it\n        if keep_row then \n            k = k+1\n            for col = 1 to nr_col\n                New_sheet(k,col) = Old_Sheet(row,col)\n            next col\n     next row\n     .range(.cells(1,1),.cells(nr_rows,nr_columns) = New_Sheet\n\nend with\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 6735475, "user_type": "registered", "profile_image": "https://graph.facebook.com/1137034939687830/picture?type=large", "display_name": "Ivans Nozdra\u010devs", "link": "https://stackoverflow.com/users/6735475/ivans-nozdra%c4%8devs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 57889278, "answer_count": 3, "score": 0, "last_activity_date": 1568264613, "creation_date": 1568203986, "question_id": 57888884, "link": "https://stackoverflow.com/questions/57888884/how-to-delete-rows-from-table-based-on-parameter-check-by-formula", "title": "How to delete rows from table, based on parameter check by formula?", "body": "<p>I want to delete entire rows of data, if the formula matches the set value.</p>\n\n<p>I am running a check (example: sum of three columns = 0?) through a set of 17K records. The code takes around 20 minutes to complete.</p>\n\n<pre><code>Dim currentRow As Integer\nDim rowCheck As Long\nDim ws As Worksheet\n\nSet ws = ActiveSheet\n\nFor currentRow = ws.UsedRange.Rows.Count To 2 Step -1\n    rowCheck = Application.WorksheetFunction.Sum(Cells(currentRow, 5), Cells(currentRow, 6), Cells(currentRow, 7))\n\n    Select Case rowCheck\n        Case 0\n            ws.Rows(currentRow).Delete ' it takes around 20 minutes to complete with 17K records to run through\n        Case Else\n    End Select\nNext\n\nSet ws = Nothing\n</code></pre>\n\n<p>The code is working, however, it seems, I am doing something wrong, as I believe the code should work so much faster with given set of data (only 17K records).</p>\n\n<p>Is there a way to optimize the deletion line?</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 1, "creation_date": 1568204907, "post_id": 57888544, "comment_id": 102199966, "body": "Increase the column count in the listbox/combox, or set the columnwidth of the first column to something larger than zero."}, {"owner": {"reputation": 33, "user_id": 10481171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46ff1724a969acc9f6c80839f612aaa0?s=128&d=identicon&r=PG&f=1", "display_name": "daveyvdweide", "link": "https://stackoverflow.com/users/10481171/daveyvdweide"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 1, "creation_date": 1568207992, "post_id": 57888544, "comment_id": 102201784, "body": "Thanks!! I feel so stupid for having the columnwidth on 0..."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1568229582, "post_id": 57888544, "comment_id": 102212431, "body": "Is this combobox/listbox used for data entry? Why is Brand_ID not included as first field in SELECT?  Are you not saving Brand_ID as foreign key? If this is setting RowSource of a combo or list box, why reference to Recordset? Is this VBA or VB?"}, {"owner": {"reputation": 33, "user_id": 10481171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46ff1724a969acc9f6c80839f612aaa0?s=128&d=identicon&r=PG&f=1", "display_name": "daveyvdweide", "link": "https://stackoverflow.com/users/10481171/daveyvdweide"}, "edited": false, "score": 0, "creation_date": 1568283583, "post_id": 57888544, "comment_id": 102229145, "body": "My program is designed in a way that if an user inputs a license plate number into the designated textbox it&#39;ll select the brand_name, car_model, etc. After everything is selected I display it in a textbox with Row source type set to Table/query. Brand_ID is the foreign key but I don&#39;t want to display that onto the screen so I don&#39;t select it.  It&#39;s VBA in Office 365 Acces"}], "owner": {"reputation": 33, "user_id": 10481171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46ff1724a969acc9f6c80839f612aaa0?s=128&d=identicon&r=PG&f=1", "display_name": "daveyvdweide", "link": "https://stackoverflow.com/users/10481171/daveyvdweide"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594449603, "creation_date": 1568202727, "last_edit_date": 1594449603, "question_id": 57888544, "link": "https://stackoverflow.com/questions/57888544/information-from-a-foreign-table-wont-display-in-a-textbox", "title": "Information from a foreign table won&#39;t display in a textbox", "body": "<p>Information from a foreign table won't display while running my SQL statement in VBA.</p>\n\n<pre><code>Dim licenseplate As String\nDim stmt As String\nDim db As DAO.Database\nDim results As DAO.Recordset\n\nlicenseplate = Text0\n\nstmt = \"SELECT Brand.Brand_name, Car.Car_model, Car.Car_color, Car.Car_buildyear, Car.Car_licenseplate \" &amp; _\n            \"FROM Brand INNER JOIN Car ON Brand.[Brand_ID] = Car.[Brand_ID] \" &amp; _\n            \"WHERE (((Car.Car_licenseplate)= \"\"\" &amp; licenseplate &amp; \"\"\"))\"\n\n\nSet db = CurrentDb\n\nSet results = db.OpenRecordset(stmt)\nSet Me.[Tekst131].Recordset = results\n</code></pre>\n\n<p>I expect it to show me the Brand name, Car model, Car color, Car buildyear and Car license plate.</p>\n\n<p>The actual output only shows Car model, Car color, Car buildyear and Car license plate.</p>\n\n<p>It won't output any error.</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 369, "user_id": 5620644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70050e5c09ce3171441cb1f0edc3bfd?s=128&d=identicon&r=PG&f=1", "display_name": "Andras", "link": "https://stackoverflow.com/users/5620644/andras"}, "edited": false, "score": 0, "creation_date": 1568202860, "post_id": 57888417, "comment_id": 102198814, "body": "Did yo umean it doesn&#39;t get past <code>Sheets(&quot;Files List&quot;).Range(&quot;FIleIndex&quot;).value = i</code> ?"}, {"owner": {"reputation": 369, "user_id": 5620644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70050e5c09ce3171441cb1f0edc3bfd?s=128&d=identicon&r=PG&f=1", "display_name": "Andras", "link": "https://stackoverflow.com/users/5620644/andras"}, "edited": false, "score": 0, "creation_date": 1568203413, "post_id": 57888417, "comment_id": 102199105, "body": "Is this all the code? because some things just don&#39;t make sense... Do you have  Tables (Named Ranges) called: <code>oldFile</code>, <code>FIleIndex</code>, <code>fileindex2</code>, <code>curfile</code> ?"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1568203710, "post_id": 57888417, "comment_id": 102199263, "body": "As far as I can see all you do with i (the iteration number of your loop) is write it away on the &quot;File list&quot; tab. It then never gets called again, so the loop has no way of knowing in which iteration it is, and will repeat the same exact first loop until it has counted to 50."}, {"owner": {"reputation": 369, "user_id": 5620644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70050e5c09ce3171441cb1f0edc3bfd?s=128&d=identicon&r=PG&f=1", "display_name": "Andras", "link": "https://stackoverflow.com/users/5620644/andras"}, "edited": false, "score": 0, "creation_date": 1568203759, "post_id": 57888417, "comment_id": 102199280, "body": "Whenever you are assigning a Range to a Variable, that line of code has to start by <code>Set</code>, so for example very early on <code>oldfile = Sheets(&quot;Files List&quot;).Range(&quot;oldFile&quot;)</code> should be <code>Set oldfile = Sheets(&quot;Files List&quot;).Range(&quot;oldFile&quot;)</code>, and all the other Range assignment should have Set in front of the Reference Variable."}, {"owner": {"reputation": 1, "user_id": 12052366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9011aec0ae1a34e95ed653f66297654d?s=128&d=identicon&r=PG&f=1", "display_name": "Rob ", "link": "https://stackoverflow.com/users/12052366/rob"}, "edited": false, "score": 0, "creation_date": 1568204661, "post_id": 57888417, "comment_id": 102199781, "body": "Yeah sorry, oldFile, FIleIndex, fileindex2, curfile are cell references within &quot;Files List&quot;. FIleIndex is the number of the the file link down the list, and fileindex2 is the corresponding file link. oldfile is intitially the first file link in the files list, and curfile initially the second link. As it goes through the For loop, the oldfile should become the second link (the then current file) and curfile becomes the next one along, so the third file link in the first instance and so on"}, {"owner": {"reputation": 1, "user_id": 12052366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9011aec0ae1a34e95ed653f66297654d?s=128&d=identicon&r=PG&f=1", "display_name": "Rob ", "link": "https://stackoverflow.com/users/12052366/rob"}, "edited": false, "score": 0, "creation_date": 1568205394, "post_id": 57888417, "comment_id": 102200261, "body": "The FIleIndex also changes the curfile to be the current file link i.e. fileindex2 and curfile will be the same file link."}, {"owner": {"reputation": 1, "user_id": 12052366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9011aec0ae1a34e95ed653f66297654d?s=128&d=identicon&r=PG&f=1", "display_name": "Rob ", "link": "https://stackoverflow.com/users/12052366/rob"}, "edited": false, "score": 0, "creation_date": 1568207407, "post_id": 57888417, "comment_id": 102201430, "body": "Additionally they are all Variants, hence why no Set for the oldfile."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12052366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9011aec0ae1a34e95ed653f66297654d?s=128&d=identicon&r=PG&f=1", "display_name": "Rob ", "link": "https://stackoverflow.com/users/12052366/rob"}, "edited": false, "score": 0, "creation_date": 1568215323, "post_id": 57888641, "comment_id": 102205968, "body": "Is XML_table referring to my &quot;XML Format&quot; sheet?"}, {"owner": {"reputation": 41, "user_id": 11641222, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155633646765675/picture?type=large", "display_name": "Carl Kirstein", "link": "https://stackoverflow.com/users/11641222/carl-kirstein"}, "reply_to_user": {"reputation": 1, "user_id": 12052366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9011aec0ae1a34e95ed653f66297654d?s=128&d=identicon&r=PG&f=1", "display_name": "Rob ", "link": "https://stackoverflow.com/users/12052366/rob"}, "edited": false, "score": 0, "creation_date": 1568229153, "post_id": 57888641, "comment_id": 102212264, "body": "Yes. XML_table is just a name for the range that you want to evaluate"}, {"owner": {"reputation": 1, "user_id": 12052366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9011aec0ae1a34e95ed653f66297654d?s=128&d=identicon&r=PG&f=1", "display_name": "Rob ", "link": "https://stackoverflow.com/users/12052366/rob"}, "edited": false, "score": 0, "creation_date": 1568302003, "post_id": 57888641, "comment_id": 102239723, "body": "I believe the main issue is regarding the find and replace, more specifically strfnd and strRplc"}, {"owner": {"reputation": 1, "user_id": 12052366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9011aec0ae1a34e95ed653f66297654d?s=128&d=identicon&r=PG&f=1", "display_name": "Rob ", "link": "https://stackoverflow.com/users/12052366/rob"}, "edited": false, "score": 0, "creation_date": 1568364190, "post_id": 57888641, "comment_id": 102258204, "body": "Nope, currently working on a separate module which focuses just on the link swap using the find and replace, will definitely consider it though! Appreciate the help."}, {"owner": {"reputation": 1, "user_id": 12052366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9011aec0ae1a34e95ed653f66297654d?s=128&d=identicon&r=PG&f=1", "display_name": "Rob ", "link": "https://stackoverflow.com/users/12052366/rob"}, "edited": false, "score": 0, "creation_date": 1568364459, "post_id": 57888641, "comment_id": 102258319, "body": "How would you construct the 2nd and 3rd arguments in a loop, because the new text becomes the old text then the next one on the list becomes the new text etc. Do they have to be specific bits of text or can you reference cells like in the 1st argument?"}, {"owner": {"reputation": 41, "user_id": 11641222, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155633646765675/picture?type=large", "display_name": "Carl Kirstein", "link": "https://stackoverflow.com/users/11641222/carl-kirstein"}, "reply_to_user": {"reputation": 1, "user_id": 12052366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9011aec0ae1a34e95ed653f66297654d?s=128&d=identicon&r=PG&f=1", "display_name": "Rob ", "link": "https://stackoverflow.com/users/12052366/rob"}, "edited": false, "score": 0, "creation_date": 1568386632, "post_id": 57888641, "comment_id": 102269474, "body": "Hi Rob. Not quite sure what youre asking. Substitute replaces portions of text. If you run substitute(&quot;apples&quot;,&quot;app&quot;,&quot;bang&quot;) you should get &quot;bangles&quot;. So in the code i had above use the substitute function in the place of the replace_str holder i had there. You can pass XML_table(i,j) to substitute() to reassign the value."}, {"owner": {"reputation": 1, "user_id": 12052366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9011aec0ae1a34e95ed653f66297654d?s=128&d=identicon&r=PG&f=1", "display_name": "Rob ", "link": "https://stackoverflow.com/users/12052366/rob"}, "edited": false, "score": 0, "creation_date": 1568622951, "post_id": 57888641, "comment_id": 102318344, "body": "I&#39;m running a loop, and in the &quot;curfile&quot; and &quot;oldfile&quot; cells, the text (file links) changes as each iteration of the loop runs, so I&#39;m not sure it would work"}], "tags": [], "owner": {"reputation": 41, "user_id": 11641222, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155633646765675/picture?type=large", "display_name": "Carl Kirstein", "link": "https://stackoverflow.com/users/11641222/carl-kirstein"}, "is_accepted": false, "score": 0, "last_activity_date": 1568203048, "creation_date": 1568203048, "answer_id": 57888641, "question_id": 57888417, "link": "https://stackoverflow.com/questions/57888417/vba-find-and-replace-within-a-for-loop-not-replacing-as-expected/57888641#57888641", "title": "VBA Find and Replace within a For loop not replacing as expected", "body": "<p>sorry if I cannot spend a lot of time answering your problem in detail. Trying to work though loads of cells in Excel in various workbooks generally gave me a lot of issues. Especially if you have macros running on worksheet events. The best advice I can give is that you get the full range from the old worksheet, process it with VBA, and then put it back into the new worksheet. It will also speed up your macro by orders of magnitude.</p>\n\n<p>the process will then look a bit like this:</p>\n\n<pre><code>XML_table = thisWorkbook.range()\n\nfor i = 1 to nr_rows\n   for j = 1 to nr_columns\n      XML_table(i,j) = replace_str(XML_table(i,j))\n    next j\nnext i\n\nthatWorkbook.range() = XML_table\n</code></pre>\n\n<p>good luck, hope the quick advice helped a bit</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 12052366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9011aec0ae1a34e95ed653f66297654d?s=128&d=identicon&r=PG&f=1", "display_name": "Rob ", "link": "https://stackoverflow.com/users/12052366/rob"}, "edited": false, "score": 0, "creation_date": 1568205562, "post_id": 57888898, "comment_id": 102200356, "body": "Cell E3 is the curfile cell (I&#39;ve recently referenced in the comments section above), so as the loop runs, the file link in the cell changes to the current file in the loop."}, {"owner": {"reputation": 1, "user_id": 12052366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9011aec0ae1a34e95ed653f66297654d?s=128&d=identicon&r=PG&f=1", "display_name": "Rob ", "link": "https://stackoverflow.com/users/12052366/rob"}, "edited": false, "score": 0, "creation_date": 1568207566, "post_id": 57888898, "comment_id": 102201517, "body": "That&#39;s my bad for not putting enough of the relevant info"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "reply_to_user": {"reputation": 1, "user_id": 12052366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9011aec0ae1a34e95ed653f66297654d?s=128&d=identicon&r=PG&f=1", "display_name": "Rob ", "link": "https://stackoverflow.com/users/12052366/rob"}, "edited": false, "score": 0, "creation_date": 1568208046, "post_id": 57888898, "comment_id": 102201812, "body": "In that case my answer would be irrelevant, apologies for that. I&#39;ll delete it in a moment. As for the actual problem, I&#39;m afraid you have me at a loss as well."}, {"owner": {"reputation": 1, "user_id": 12052366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9011aec0ae1a34e95ed653f66297654d?s=128&d=identicon&r=PG&f=1", "display_name": "Rob ", "link": "https://stackoverflow.com/users/12052366/rob"}, "edited": false, "score": 0, "creation_date": 1568208444, "post_id": 57888898, "comment_id": 102202030, "body": "No worries, I definitely did not make it clear. Thanks for trying to help, much appreciated!"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "reply_to_user": {"reputation": 1, "user_id": 12052366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9011aec0ae1a34e95ed653f66297654d?s=128&d=identicon&r=PG&f=1", "display_name": "Rob ", "link": "https://stackoverflow.com/users/12052366/rob"}, "edited": false, "score": 0, "creation_date": 1568209026, "post_id": 57888898, "comment_id": 102202380, "body": "Perhaps you could get an answer quicker with a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal, reproducible example</a>. As I tried running it for myself and got stuck trying to recreate your whole file. Trying to do so is also a great way to narrow down the problem and debug for yourself as well."}, {"owner": {"reputation": 1, "user_id": 12052366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9011aec0ae1a34e95ed653f66297654d?s=128&d=identicon&r=PG&f=1", "display_name": "Rob ", "link": "https://stackoverflow.com/users/12052366/rob"}, "edited": false, "score": 0, "creation_date": 1568212912, "post_id": 57888898, "comment_id": 102204610, "body": "I&#39;m struggling to see how I can do that unfortunately"}], "tags": [], "owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "is_accepted": false, "score": 0, "last_activity_date": 1568204022, "creation_date": 1568204022, "answer_id": 57888898, "question_id": 57888417, "link": "https://stackoverflow.com/questions/57888417/vba-find-and-replace-within-a-for-loop-not-replacing-as-expected/57888898#57888898", "title": "VBA Find and Replace within a For loop not replacing as expected", "body": "<p>If I interpret this correctly (which is kind of tough since you use a lot of named ranges which I have no way of knowing where they link to) you do not account for iterations of your loop. You write away the iteration number on tab \"Files list\" and that's it. This means since you use absolute references for everything, it will repeat all steps exactly as you wrote them for the first iteration, never progressing. You need to feed <code>i</code> back into your loop as a row number to advance to the second row like so:</p>\n\n<pre><code>filelink = ThisWorkbook.Sheets(\"Files List\").Range(\"E\" &amp; i)\n</code></pre>\n\n<p>Which from <code>i = 3</code> to <code>i = 50</code> actually loops through rows 3 to 50 in your \"Files list\" sheet, rather than taking \"E3\" every time.</p>\n"}], "owner": {"reputation": 1, "user_id": 12052366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9011aec0ae1a34e95ed653f66297654d?s=128&d=identicon&r=PG&f=1", "display_name": "Rob ", "link": "https://stackoverflow.com/users/12052366/rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1568204022, "creation_date": 1568202263, "question_id": 57888417, "link": "https://stackoverflow.com/questions/57888417/vba-find-and-replace-within-a-for-loop-not-replacing-as-expected", "title": "VBA Find and Replace within a For loop not replacing as expected", "body": "<p>I'm taking Excel worksheets and putting them into XML format, to then import to SQL. I have a worksheet of a list of file links, called \"Files List\". The code opens up the necessary sheet within the file links and puts the data into a sheet called \"XML format\", which is suitable to then import to SQL. The issue is that the Find and Replace within the loop of transferring the data does run, but not seem to get passed the first \"Files List\" reference.  </p>\n\n<pre><code>Sub LinkFile()\nApplication.ScreenUpdating = False\n\n\nThisWorkbook.Sheets(\"Files List\").Activate\n\noldfile = Sheets(\"Files List\").Range(\"oldFile\")\n\nDebug.Print oldfile\nstrfnd = oldfile\nSet db1 = connect_sql_server()\n\nstrfnd = Format_link(oldfile)\nDebug.Print strfnd\n\nFor i = 3 To 50\n\nSheets(\"Files List\").Range(\"FIleIndex\").value = i\n\nfilelink = Sheets(\"Files List\").Range(\"fileindex2\")\n\ncurfile = ThisWorkbook.Sheets(\"Files List\").Range(\"curfile\")\n\nSet wkbkNew = Workbooks.Open(filelink)\nThisWorkbook.Sheets(\"XML Format\").Range(\"B3\") = ActiveWorkbook.Name\nDebug.Print (ThisWorkbook.Sheets(\"XML Format\").Range(\"B3\"))\n\nSet wbsheet = wkbkNew.Sheets(\"Calculations\")\n\n    filelink = ThisWorkbook.Sheets(\"Files List\").Range(\"E3\")\n\n\n    strRplc = filelink\n    Debug.Print (strRplc)\n    Set sht = ThisWorkbook.Sheets(\"XML Format\")\n    Application.Volatile\n\n    ActiveWorkbook.Close SaveChanges:=False\n\n    Application.Volatile\n\n     sht.Cells.Replace What:=strfnd, Replacement:=strRplc, _\n         LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, _\n         SearchFormat:=False, ReplaceFormat:=False\n\n        strfnd = strRplc\n        Debug.Print (strfnd)\n\n    ThisWorkbook.Sheets(\"XML Format\").Activate\n    strxml = concatenate_xml()\n    Debug.Print (strxml)\n     'this imports data into sql server\n     WriteDB strxml, db1\n\nstrfnd = strRplc\ncontinue:\nNext i\n\ndb1.Close\nEnd Sub\n</code></pre>\n\n<p>Say the loop is set as i=2 to 2. The expected result is that in the \"XML Format\" sheet, the data should be from the second files link in \"Files List\". The actual output is that the data is always from the first files link, the original \"oldfile\". The only thing that works as expected is the file name, \"ActiveWorkbook.Name\".</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 0, "creation_date": 1568202025, "post_id": 57888234, "comment_id": 102198375, "body": "You could try formatting the date you pass to <code>IsDate</code> like you do in the first part."}, {"owner": {"reputation": 33, "user_id": 12014262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9a0393b311c70b9dbaba79b45e87b2a?s=128&d=identicon&r=PG&f=1", "display_name": "newtovba", "link": "https://stackoverflow.com/users/12014262/newtovba"}, "reply_to_user": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 0, "creation_date": 1568202241, "post_id": 57888234, "comment_id": 102198496, "body": "I&#39;ll consider that as a last resort, but my question is that if the messagebox can know how to take rRng (1,j) and format it into a date, doesn&#39;t Excel already know that rRange(1,j) is a date?"}, {"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1568202750, "post_id": 57888234, "comment_id": 102198762, "body": "Did you try to define rRange as Range?"}, {"owner": {"reputation": 33, "user_id": 12014262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9a0393b311c70b9dbaba79b45e87b2a?s=128&d=identicon&r=PG&f=1", "display_name": "newtovba", "link": "https://stackoverflow.com/users/12014262/newtovba"}, "edited": false, "score": 0, "creation_date": 1568203070, "post_id": 57888234, "comment_id": 102198917, "body": "Ah yes sorry i did do that in my original code - I rewrote some code here for clarity&#39;s sake and mistyped it. rRange is indeed a Range"}, {"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 1, "creation_date": 1568203374, "post_id": 57888234, "comment_id": 102199074, "body": "@newtovba It knows to format it as a date because you told it to do so."}, {"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1568203725, "post_id": 57888234, "comment_id": 102199267, "body": "I tried your code and it works... the only issue is, maybe, the oldDate value"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1568203925, "post_id": 57888234, "comment_id": 102199364, "body": "Your debug does not include the <i>unformatted</i> value that you are trying to <code>IsDate</code>.  For example, <code>IsDate(43719)</code> is <code>False</code>, but <code>IsDate(&quot;2019&#47;09&#47;11&quot;)</code>, <code>IsDate(&quot;2019-09-11&quot;)</code>, <code>IsDate(&quot;11 9 2019&quot;)</code> and <code>IsDate(&quot;Sep 11 19&quot;)</code> are all <code>True</code>.  However, all of those will <code>Format</code> to <code>&quot;2019&#47;09&#47;11&quot;</code> if you tell them to."}, {"owner": {"reputation": 33, "user_id": 12014262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9a0393b311c70b9dbaba79b45e87b2a?s=128&d=identicon&r=PG&f=1", "display_name": "newtovba", "link": "https://stackoverflow.com/users/12014262/newtovba"}, "edited": false, "score": 0, "creation_date": 1568204244, "post_id": 57888234, "comment_id": 102199529, "body": "Hmm. The underlying value is indeed something like 43719 but I&#39;ve formatted the cells as &quot;Sunday&quot; , &quot;Monday&quot; etc based off the cell value using the number format in &#39;regular&#39; excel"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1568207421, "post_id": 57888234, "comment_id": 102201440, "body": "@newtovba format your excel range as date format then your <code>ISDATE</code> will work"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1568208415, "post_id": 57888234, "comment_id": 102202017, "body": "If your date values are <a href=\"https://superuser.com/q/299437/52365\">indeed dates</a> and not just text with applied Date formatting, then <code>IsDate</code> should certainly work. <code>IsDate(r)</code> is the same as <code>IsDate(r.Value)</code>. <code>IsDate(r.Value2)</code> is always going to be False because the very point of Value2 is to not give out a Date."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1568217353, "post_id": 57888234, "comment_id": 102207063, "body": "@newtovba If you do <code>MsgBox rRange(1, j).Value</code>, do you get 43719 (<code>IsDate(43719)=False</code>), &quot;11/09/2019&quot; (<code>IsDate(&quot;11&#47;09&#47;2019&quot;)=True</code>) or &quot;Wednesday&quot; (<code>IsDate(&quot;Wednesday&quot;)=False</code>)"}, {"owner": {"reputation": 33, "user_id": 12014262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9a0393b311c70b9dbaba79b45e87b2a?s=128&d=identicon&r=PG&f=1", "display_name": "newtovba", "link": "https://stackoverflow.com/users/12014262/newtovba"}, "reply_to_user": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 0, "creation_date": 1568222389, "post_id": 57888234, "comment_id": 102209397, "body": "Chronocidal for Msgbox rRange(1,j).value, I get 43719. No wonder it&#39;s throwing &quot;False&quot; - weird that Excel can convert 43719 to a date but if you do IsDate, it only recognizes it as a number  GSerg Got it.  @BrianMStafford Looks like you&#39;re right - IsDate(Format(rRange(1, j), &quot;yyyy/mm/dd&quot;)) returns true. Will mark as a plus 1"}], "owner": {"reputation": 33, "user_id": 12014262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9a0393b311c70b9dbaba79b45e87b2a?s=128&d=identicon&r=PG&f=1", "display_name": "newtovba", "link": "https://stackoverflow.com/users/12014262/newtovba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568203121, "creation_date": 1568201579, "last_edit_date": 1568203121, "question_id": 57888234, "link": "https://stackoverflow.com/questions/57888234/how-can-i-make-isdate-work-correctly-its-currently-returning-false-for-values", "title": "how can I make IsDate work correctly? It&#39;s currently returning false for values that are dates", "body": "<p>There is a named range of cells that contains text and dates, and I'm trying to find the first column of the first date.</p>\n\n<p>The IsDate function isn't working for cells that are dates even though the first part of the message box correctly formats it as a date (see code below).</p>\n\n<p>I've tried using:</p>\n\n<ul>\n<li>isDate(rRange(1,j))</li>\n<li>isDate(rRange(1,j).value)</li>\n<li>isDate(rRange(1,j).value2)</li>\n</ul>\n\n<p>but none of them are returning true for cells that are dates</p>\n\n<pre><code> Dim oldDate as Variant\n 'EDIT: clarified that rRange is indeed set as a Range\n Dim rRange as Range\n Dim colValueOfnumDaysInOldMonth as Integer\n Dim numDaysinOldMonth as Integer\n\n '\"HolidaySchedule\" is a named range on Sheet3 for cells $C$6:$AJ$90\n Set rRange = Sheet3.Range(\"HolidaySchedule\")\n\n 'rRange(\"s1\") contains a valid date\n oldDate=rRange(\"s1\")\n\n 'numDaysInOldMonth correctly gives the # days in the oldDate's month\n numDaysInOldMonth = Day(DateSerial(Year(oldDate), Month(oldDate) + 1, 1) - 1)\n\n    For j = 1 To rRange.Columns.Count\n       'Using this MsgBox to test the values\n        MsgBox Format(rRange(1, j), \"yyyy/mm/dd\") &amp; \" : \" &amp; IsDate(rRange(1, j).Value)\n        If IsDate(rRange(1, j).Value) Then\n            colValueOfnumDaysInOldMonth = j + numDaysInOldMonth - 1\n            'MsgBox \"Last day of old month: \" &amp; Format(rRange(1, colValueOfnumDaysInOldMonth), \"yyyy/mm/dd\")\n            Exit For\n        End If\n    Next\n</code></pre>\n\n<p>The first 5 messageboxes show:</p>\n\n<p>Name : False</p>\n\n<p>Position: False</p>\n\n<p>2019/09/01 : False</p>\n\n<p>2019/09/02 : False</p>\n\n<p>2019/09/03 : False</p>\n"}, {"tags": ["excel", "vba", "copy", "do-while", "paste"], "comments": [{"owner": {"reputation": 598, "user_id": 8256073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/110fcab852ac4ad3e33858c1db6c9dce?s=128&d=identicon&r=PG&f=1", "display_name": "gaback", "link": "https://stackoverflow.com/users/8256073/gaback"}, "edited": false, "score": 0, "creation_date": 1568202002, "post_id": 57888212, "comment_id": 102198361, "body": "put this code&#39;s line under <code>With wshtDest</code>: <code>lastRow = .Cells(wshtDest.Rows.Count, 1).End(xlUp).Offset(lastRow).row + 1</code>.  You always got &#39;A2&#39; because you didn&#39;t update your <code>lastRow</code> after paste"}, {"owner": {"reputation": 25, "user_id": 12052609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4058c701a20f2898b6a46dcf1bae4e3e?s=128&d=identicon&r=PG&f=1", "display_name": "unbeknownst", "link": "https://stackoverflow.com/users/12052609/unbeknownst"}, "reply_to_user": {"reputation": 598, "user_id": 8256073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/110fcab852ac4ad3e33858c1db6c9dce?s=128&d=identicon&r=PG&f=1", "display_name": "gaback", "link": "https://stackoverflow.com/users/8256073/gaback"}, "edited": false, "score": 0, "creation_date": 1568203053, "post_id": 57888212, "comment_id": 102198908, "body": "Thanks @gaback - that sorted it, however the lastRow code also needed tweeking to:  <code>lastRow = .Cells(wshtDest.Rows.Count, 1).End(xlUp).Offset(1).row</code>  --- otherwise it never went back to the end of the model&#39;s data :)"}, {"owner": {"reputation": 1681, "user_id": 3288004, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/drlmj.jpg?s=128&g=1", "display_name": "Tiago Duque", "link": "https://stackoverflow.com/users/3288004/tiago-duque"}, "edited": false, "score": 0, "creation_date": 1568203064, "post_id": 57888212, "comment_id": 102198915, "body": "Welcome to Stack Overflow! You did a nice job in compiling your question. I&#39;d just advise you to always make efforts to have your question clear at the end. What you need has to be clearly seen at first glance."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 12052609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4058c701a20f2898b6a46dcf1bae4e3e?s=128&d=identicon&r=PG&f=1", "display_name": "unbeknownst", "link": "https://stackoverflow.com/users/12052609/unbeknownst"}, "edited": false, "score": 0, "creation_date": 1568202399, "post_id": 57888404, "comment_id": 102198572, "body": "oh my lord...i didn&#39;t even think of that!! I was using debug.print lastRow to see what it did, but as it was working fine when i opened a single spreadsheet, it wasn&#39;t make sense! I will run with code with the lastRow inside the loop and see if that helps. <i>brb</i>"}, {"owner": {"reputation": 25, "user_id": 12052609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4058c701a20f2898b6a46dcf1bae4e3e?s=128&d=identicon&r=PG&f=1", "display_name": "unbeknownst", "link": "https://stackoverflow.com/users/12052609/unbeknownst"}, "edited": false, "score": 0, "creation_date": 1568202588, "post_id": 57888404, "comment_id": 102198678, "body": "after some trial and error this worked like a charm! Please note that the correct answer is slightly different from your answer @beek - see below is the correct answer :) &lt;!-- language: lang-none --&gt;     <code>For Each copied_rng In Selection         lastRow = wshtDest.Cells(wshtDest.Rows.Count, 1).End(xlUp).Offset(1).row         With wshtDest         .Activate         .Cells(lastRow, 1).Select         .PasteSpecial         &#39;End With&#39;     Next copied_rng</code>"}, {"owner": {"reputation": 356, "user_id": 9635098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a781d7fd3cacab5fbc08554bc8dfb759?s=128&d=identicon&r=PG&f=1", "display_name": "Beek", "link": "https://stackoverflow.com/users/9635098/beek"}, "reply_to_user": {"reputation": 25, "user_id": 12052609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4058c701a20f2898b6a46dcf1bae4e3e?s=128&d=identicon&r=PG&f=1", "display_name": "unbeknownst", "link": "https://stackoverflow.com/users/12052609/unbeknownst"}, "edited": false, "score": 0, "creation_date": 1568203425, "post_id": 57888404, "comment_id": 102199111, "body": "I think both would do the trick. Yours finds the last row and uses and offset of 1 row, mine finds the last row and adds 1 to the rownumber. But anyway, glad I could help."}, {"owner": {"reputation": 25, "user_id": 12052609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4058c701a20f2898b6a46dcf1bae4e3e?s=128&d=identicon&r=PG&f=1", "display_name": "unbeknownst", "link": "https://stackoverflow.com/users/12052609/unbeknownst"}, "edited": false, "score": 0, "creation_date": 1568203613, "post_id": 57888404, "comment_id": 102199213, "body": "Oh apologies! thats what I get for speed reading! I didn&#39;t realise you took out the <code>offset(lastRow)</code> part from my original code."}], "tags": [], "owner": {"reputation": 356, "user_id": 9635098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a781d7fd3cacab5fbc08554bc8dfb759?s=128&d=identicon&r=PG&f=1", "display_name": "Beek", "link": "https://stackoverflow.com/users/9635098/beek"}, "is_accepted": true, "score": 0, "last_activity_date": 1568202224, "creation_date": 1568202224, "answer_id": 57888404, "question_id": 57888212, "link": "https://stackoverflow.com/questions/57888212/excel-vba-completing-another-loop-operation-within-a-do-while-loop/57888404#57888404", "title": "Excel VBA - Completing another Loop Operation within a Do-While Loop", "body": "<p>I think the problem is that you define <code>lastrow</code> outside of the loop. This means that it gets filled 1 time (probably as row 2), and never updated. You would have to recalculate it for each iteration of your for loop. </p>\n\n<p>So something like this:</p>\n\n<pre><code>    For Each copied_rng In Selection\n        lastRow = wshtDest.Cells(wshtDest.Rows.Count, 1).End(xlUp).row + 1\n        With wshtDest\n        .Activate\n        .Cells(lastRow, 1).Select\n        .PasteSpecial\n        End With\n    Next copied_rng\n</code></pre>\n\n<p>Since you said you were still learning; there is a way to check whether your variables are filled with the values you would expect. You could step through your code using F8 and track them in the Watch window: <a href=\"https://bettersolutions.com/vba/debugging/watch-window.htm\" rel=\"nofollow noreferrer\">https://bettersolutions.com/vba/debugging/watch-window.htm</a></p>\n\n<p>Hope that helps.</p>\n"}], "owner": {"reputation": 25, "user_id": 12052609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4058c701a20f2898b6a46dcf1bae4e3e?s=128&d=identicon&r=PG&f=1", "display_name": "unbeknownst", "link": "https://stackoverflow.com/users/12052609/unbeknownst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 57888404, "answer_count": 1, "score": 1, "last_activity_date": 1568214169, "creation_date": 1568201510, "last_edit_date": 1568214169, "question_id": 57888212, "link": "https://stackoverflow.com/questions/57888212/excel-vba-completing-another-loop-operation-within-a-do-while-loop", "title": "Excel VBA - Completing another Loop Operation within a Do-While Loop", "body": "<p>I'm currently learning VBA on my own from both trial and error, the macro recorder, and from reading/researching online. In most cases I'm able to find a work around to fill in the gaps. But in this case, I'm struggling a bit.</p>\n\n<p>My issue is that my within my do-while loop, which opens (variable named workbooks), I need to then select a variable rowed, but static columned data set, then paste it into a model with a specified sheet. </p>\n\n<p>I would like each workbook which is opened to run through the following steps:</p>\n\n<ol>\n<li>find the last empty row of the active/opened workbook</li>\n<li>copy that data</li>\n<li>find the last empty row of the models specified sheet.</li>\n</ol>\n\n<p>The issue is with the above step 3. While I have asked the code to find the last row, it seems to be \"ignoring\" this and pasting the data at A2 in the model.</p>\n\n<p>What I've tried</p>\n\n<ol>\n<li>I would like to avoid the used.range option as my source data each have headers on all workbooks, in previous testing I was unable to get the same range with used.range as I could with lastRow, lastColumn options.</li>\n<li>using a byref, so that I could call the copied data - but i'm stuggling to understand how to use that even after reading up on it. </li>\n<li><p>using wbSource and wbDest with specified ranges within the loop, I would like to avoid this unless it can be explained or a sample provided as to how this can be used in a loop as again I've been unable to get this to work.</p>\n\n<pre><code>Sub GetAllFileNames()\n\nDim Folder As String\nDim FullFileName As String\nDim FileStart As String\nDim wbThis, wbSource As Workbook\nDim lastRow As Long\nDim wshtDest As Worksheet\n\nSet wbThis = ThisWorkbook\nSet wshtDest = wbThis.Sheets(\"Report\")\nlastRow = wshtDest.Cells(wshtDest.Rows.Count, 1).End(xlUp).Offset(lastRow).row + 1\n'rlastRow = ReportSht.Cells(ReportSht.Rows.Count, 1).End(xlUp).Offset(lastRow).row\n\nFolder = Sheet1.Range(\"C7\") &amp; \"\\\"\n\nFileStart = \"D1*\"\nFullFileName = Dir(Folder &amp; FileStart)\n\nOn Error Resume Next\nDo While FullFileName &lt;&gt; \"\"\n\n    Workbooks.Open Folder &amp; FullFileName\n    Call source_rng\n    For Each copied_rng In Selection\n        With wshtDest\n        .Activate\n        .Cells(lastRow, 1).Select\n        .PasteSpecial\n        End With\n    Next copied_rng\n'    wshtDest.Range(\"A\" &amp; rlastRow).Offset(1).Select\n    Debug.Print lastRow\n    Debug.Print FullFileName\n    FullFileName = Dir() ' moves to next file\n    DoEvents     'Ensure Workbook has opened before moving on to next line of code\n    Application.CutCopyMode = False\nLoop\n\nEnd Sub\n\n\nSub source_rng()\n\nDim sht As Worksheet\nDim lastRow, lastColumn As Long\nDim StartCell, copied_rng As Range\n\nSet sht = ActiveSheet\nSet StartCell = Range(\"A2\")\n\n'Find Last Row and Column\n  lastRow = sht.Cells(sht.Rows.Count, StartCell.Column).End(xlUp).row\n  lastColumn = sht.Cells(StartCell.row, sht.Columns.Count).End(xlToLeft).Column\n\n'Select Range\nsht.Range(StartCell, sht.Cells(lastRow, lastColumn)).Copy\n\nEnd Sub\n</code></pre></li>\n</ol>\n\n<p>Currently, the above code does not produce any errors, however when the loop is removed and 1 spreadsheet is opened and copy and pasted into the model, the lastRow lookup in the model works perfectly. </p>\n\n<p>However, when the loop is put into place, each opened workbook's data is copied at A2 in the model, where it should find the next empty row and paste the source data at that point.</p>\n"}, {"tags": ["vba", "ms-access", "oledb", "dao"], "comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 2, "creation_date": 1568206048, "post_id": 57888016, "comment_id": 102200612, "body": "how did you try ? Piece of code ? Can you show it ?"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1568206298, "post_id": 57888016, "comment_id": 102200749, "body": "what about this ? <a href=\"https://stackoverflow.com/a/54269372/78522\">stackoverflow.com/a/54269372/78522</a>"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1568206727, "post_id": 57888016, "comment_id": 102201016, "body": "Is Access installed on the client machine ? ADO ?"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1568210875, "post_id": 57888016, "comment_id": 102203427, "body": "Catia bitness x64? Have Office and Catia the same bitness or mess with <a href=\"https://social.msdn.microsoft.com/Forums/Account/Login?ReturnUrl=https%3a%2f%2fsocial.msdn.microsoft.com%3a443%2fForums%2fen-US%2fabf34eea-1029-429a-b88e-4671bffcee76%2fwhy-cant-32-and-64-bit-access-database-engine-aceoledb-dataproviders-coexist%3fforum%3dadodotnetdataproviders%26prof%3drequired\" rel=\"nofollow noreferrer\">Why can&#39;t 32 and 64 bit Access Database Engine (ACE/OLEDB Dataproviders) coexist</a>"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 2, "creation_date": 1568268098, "post_id": 57888016, "comment_id": 102221700, "body": "Please don&#39;t ask a question without explaining what you tried and what error you got."}, {"owner": {"reputation": 13, "user_id": 11739605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbac7ef8f2e495f3cd248a939ed5d1c7?s=128&d=identicon&r=PG&f=1", "display_name": "MaxVR", "link": "https://stackoverflow.com/users/11739605/maxvr"}, "edited": false, "score": 0, "creation_date": 1568279932, "post_id": 57888016, "comment_id": 102227085, "body": "Thanks for the suggestions, I&#39;ll remember them next time I ask a question.  Access is installed (so is Office). I think CATIA is 64bit, which is probably the problem. That means it is impossible to connect to the database?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11739605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbac7ef8f2e495f3cd248a939ed5d1c7?s=128&d=identicon&r=PG&f=1", "display_name": "MaxVR", "link": "https://stackoverflow.com/users/11739605/maxvr"}, "edited": false, "score": 0, "creation_date": 1568279307, "post_id": 57889742, "comment_id": 102226759, "body": "Thanks a lot for the help!  Unfortunately I get the following error, further confirming the 32/64bit problem:  [Microsoft][ODBC Driver Manager] Data source name not found and no default driver specified"}], "tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 0, "last_activity_date": 1568206666, "creation_date": 1568206666, "answer_id": 57889742, "question_id": 57888016, "link": "https://stackoverflow.com/questions/57888016/cant-connect-to-access-db-neither-with-oledb-dao-etc/57889742#57889742", "title": "Can&#39;t connect to Access DB, neither with OleDB, DAO, etc", "body": "<p>I tried from Excel with the following code (<a href=\"https://stackoverflow.com/a/54269372/78522\">source</a>), it works like a charm.  </p>\n\n<pre><code>Sub test()\n    Dim cnn As ADODB.Connection 'Requieres reference to the Microsoft\n    Dim rs As ADODB.Recordset   'ActiveX Data Objects Library\n\n    Set cnn = CreateObject(\"adodb.Connection\")\n    cnn.Open \"DRIVER={Microsoft Access Driver (*.mdb, *.accdb)};DBQ=C:\\Users\\someFolder\\myDb.accdb;\"\n    Set rs = cnn.Execute(\"SELECT * FROM versions\")\n    While Not rs.EOF\n      Debug.Print rs(1), rs(2), rs(3)\n      rs.MoveNext\n    Wend\n    rs.Close\nEnd Sub\n</code></pre>\n\n<p>if that doesn't work, the client PC may <a href=\"https://support.microsoft.com/en-us/help/168335/info-using-activex-data-objects-ado-via-visual-basic\" rel=\"nofollow noreferrer\">lack a piece of software</a> ?</p>\n"}], "owner": {"reputation": 13, "user_id": 11739605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbac7ef8f2e495f3cd248a939ed5d1c7?s=128&d=identicon&r=PG&f=1", "display_name": "MaxVR", "link": "https://stackoverflow.com/users/11739605/maxvr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1568267453, "creation_date": 1568200886, "last_edit_date": 1568267453, "question_id": 57888016, "link": "https://stackoverflow.com/questions/57888016/cant-connect-to-access-db-neither-with-oledb-dao-etc", "title": "Can&#39;t connect to Access DB, neither with OleDB, DAO, etc", "body": "<p>I want to read and write data from a CATIA macro to and from an Access DataBase. I've got Windows 10 and Office 2013 on it (64bit Windows).</p>\n\n<p>Unfortunately I can't connect to that Access DataBase from VBA. (From VB.NET works fine)</p>\n\n<p>I tried it all:</p>\n\n<p>Various connection strings (JET.4.0, ACE.12.0) etc with ADODB\n-> Error that Provider cant be found</p>\n\n<p>Connection via DAO\n-> Various other errors</p>\n\n<p>Any idea why I cant connect?</p>\n\n<p>I referenced all DLLs possible to reference, etc.</p>\n\n<p>Only idea I have that theres a problem with Access 2013 32bit and the 64 bit Windows?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1568200037, "post_id": 57887649, "comment_id": 102197385, "body": "Can you upload a Screen Capture?"}, {"owner": {"reputation": 25, "user_id": 12036684, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDUUr_lCfHiCihPdgpdgSDeKhPKc1EbhWSsa0xjFw=k-s128", "display_name": "Gan Cy", "link": "https://stackoverflow.com/users/12036684/gan-cy"}, "reply_to_user": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1568201083, "post_id": 57887649, "comment_id": 102197850, "body": "Hi David, thanks for replying. I have uploaded 2 screen capture of my excel. thanks"}, {"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1568201425, "post_id": 57887649, "comment_id": 102198049, "body": "Did you try <code>SUMIFS</code>? Just make a search for the items by <code>VLOOKUP</code> and the quantities by <code>SUMIFS</code>"}, {"owner": {"reputation": 25, "user_id": 12036684, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDUUr_lCfHiCihPdgpdgSDeKhPKc1EbhWSsa0xjFw=k-s128", "display_name": "Gan Cy", "link": "https://stackoverflow.com/users/12036684/gan-cy"}, "reply_to_user": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1568210778, "post_id": 57887649, "comment_id": 102203382, "body": "Thanks for the suggestion, I will try. But I think SUMIFS don&#39;t do much because I need to separate each line even when they are same ID and same categories?"}], "owner": {"reputation": 25, "user_id": 12036684, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDUUr_lCfHiCihPdgpdgSDeKhPKc1EbhWSsa0xjFw=k-s128", "display_name": "Gan Cy", "link": "https://stackoverflow.com/users/12036684/gan-cy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568201050, "creation_date": 1568199578, "last_edit_date": 1568201050, "question_id": 57887649, "link": "https://stackoverflow.com/questions/57887649/to-lookup-multiple-conditions-in-different-sheet-and-show-all-result-in-column-b", "title": "To lookup multiple conditions in different sheet and show all result in column by column- possible to do it with excel formula or vba is required?", "body": "<p>need some help on my excel production report. </p>\n\n<p>I want to Lookup for the <strong>daily unique ID</strong>, <strong>gram</strong> and <strong>pieces</strong> from <strong>Sheet 1</strong> into <strong>Sheet 2</strong>.</p>\n\n<p>The daily unique ID consists of up to <strong>5 categories</strong>. </p>\n\n<p>Each day, there could be up to a <strong>maximum of 3 unique ID produced</strong> with each one having different categories (some have 2 same categories with different grams and pieces. It need to be shown in a separate column in Sheet 2), grams and pieces.</p>\n\n<p>I came out with an excel formula but it only works IF there is only one daily unique ID per day. If there is more than one unique ID, this formula fails as it only captures the first one. </p>\n\n<p>Please see my formula below</p>\n\n<p>I2:I100 is the gram in Sheet 1</p>\n\n<p>E2:E100 is the \"unique code-category\" in Sheet 1</p>\n\n<p>D11 is the unique code in Sheet 2</p>\n\n<p>P11 is the type of categories</p>\n\n<p><code>{=IFERROR(INDEX('A'!$I$2:$I$100,SMALL(IF(($D$11&amp;\"-\"&amp;$P$11)='A'!$E$2:$E$100,MATCH(ROW('A'!$E$2:$E$100),ROW('A'!$E$2:$E$100)),\"\"),ROWS($A$1:$A1))),\"\")}</code></p>\n\n<p>Is there a way I could capture everything? </p>\n\n<p>Can I do it with excel formula or a VBA is required? </p>\n\n<p>I have tried many different formulas but nothing came out right, please help :(</p>\n\n<p>Please let me know if my explanation isn't clear. Thanks.</p>\n\n<p><a href=\"https://i.stack.imgur.com/KpDbc.png\" rel=\"nofollow noreferrer\">Sheet 1</a>\n<a href=\"https://i.stack.imgur.com/5hrLi.png\" rel=\"nofollow noreferrer\">Sheet 2 (Final Report)</a></p>\n"}, {"tags": ["excel", "vba", "worksheet-function", "worksheet"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1568201131, "post_id": 57887549, "comment_id": 102197880, "body": "The error itself is quite logical as per <a href=\"https://docs.microsoft.com/en-us/office/troubleshoot/excel/external-references-data-validation-fails\" rel=\"nofollow noreferrer\">this</a> documentation."}], "answers": [{"tags": [], "owner": {"reputation": 44, "user_id": 12009993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e6d97f3f34bfdf2601ba26e6d3da555?s=128&d=identicon&r=PG&f=1", "display_name": "Gh3ttoKinG.", "link": "https://stackoverflow.com/users/12009993/gh3ttoking"}, "is_accepted": false, "score": 1, "last_activity_date": 1568203002, "creation_date": 1568203002, "answer_id": 57888623, "question_id": 57887549, "link": "https://stackoverflow.com/questions/57887549/run-time-error-1004-when-im-referring-to-a-range-that-is-not-named/57888623#57888623", "title": "Run-time error &#39;1004&#39; when I&#39;m referring to a range that is not named", "body": "<p>As JvdV wrote in the comments it's because you can't use data validation where the list reference to another workbook, at least not in a simple way.</p>\n\n<p><a href=\"https://i.stack.imgur.com/b1c5S.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/b1c5S.png\" alt=\"external reference in Data Validation not possible\"></a></p>\n\n<p>You can circument it by adding a named range to your writeable workbook with this formula (assuming <code>Cost_Center</code> is in column C)</p>\n\n<pre><code>=IF(Sheet1!H6=\"PIDTID\",OFFSET('[20190812_WP_and_CostCenters_Responsible.xls]Projects responsibles'!$B:$B,0,0),OFFSET('[20190812_WP_and_CostCenters_Responsible.xls]Projects responsibles'!$C:$C,0,0))\n</code></pre>\n\n<p>And then use this named range in your data validation / macro.\nDownside is that the source workbook has to open for the dropdown menu to work</p>\n"}, {"comments": [{"owner": {"reputation": 418, "user_id": 6106932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1fe6348cb3a1f3b9a7afd420777c587a?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad Iordache", "link": "https://stackoverflow.com/users/6106932/vlad-iordache"}, "edited": false, "score": 0, "creation_date": 1568622960, "post_id": 57888972, "comment_id": 102318349, "body": "Thank you for this, it was very helpful, and it even helps me further, with some issues I had no idea how get around. However, I&#39;m experiencing a new problem I didn&#39;s have at first: <code>COUNTA</code> returns the value 983237 unless the file I&#39;m reading is opened. Do you have any idea why does that happen?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 418, "user_id": 6106932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1fe6348cb3a1f3b9a7afd420777c587a?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad Iordache", "link": "https://stackoverflow.com/users/6106932/vlad-iordache"}, "edited": false, "score": 1, "creation_date": 1568636219, "post_id": 57888972, "comment_id": 102325156, "body": "@VladIordache, I included another option, which might work for you? If that doesn&#39;t help, you might have values in your column actually. Maybe even spaces or formula output being &quot;&quot;?"}, {"owner": {"reputation": 418, "user_id": 6106932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1fe6348cb3a1f3b9a7afd420777c587a?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad Iordache", "link": "https://stackoverflow.com/users/6106932/vlad-iordache"}, "edited": false, "score": 0, "creation_date": 1568707527, "post_id": 57888972, "comment_id": 102349976, "body": "Thank you sir, it works perfectly now. I did not have values, because the output was correct when the file was opened. The behaviour was the same for <code>COUNTA</code>, <code>COUNTIF</code>, <code>SUMPRODUCT</code>, even the difference between <code>ROWS</code> and <code>COUNTBLANK</code>. But your solution with <code>MATCH</code> was exactly what I needed, thank you again. However, I would still like to know what&#39;s with that strange number"}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 1, "last_activity_date": 1568635928, "last_edit_date": 1568635928, "creation_date": 1568204250, "answer_id": 57888972, "question_id": 57887549, "link": "https://stackoverflow.com/questions/57887549/run-time-error-1004-when-im-referring-to-a-range-that-is-not-named/57888972#57888972", "title": "Run-time error &#39;1004&#39; when I&#39;m referring to a range that is not named", "body": "<blockquote>\n  <p><em>\"Is there a way to get rid of the error, or another way by which I can refer to cells in sheets of other workbooks without naming them? I would also like to work without having to open the source file. Thank you!\"</em></p>\n</blockquote>\n\n<p>Let me give it a go :)</p>\n\n<p>As per <a href=\"https://docs.microsoft.com/en-us/office/troubleshoot/excel/external-references-data-validation-fails\" rel=\"nofollow noreferrer\">this</a> documentation, you cannot use referces to another workbook (without a named range). And certainly not in a closed workbook. Refer to @Gh3ttoKinG his answer for that :).</p>\n\n<p>So this might be done much smarter but to do this <strong>without opening</strong> a workbook I thought about using <code>ExecuteExcel4Macro</code>. With a little help from <a href=\"https://stackoverflow.com/a/9261915/9758194\">this</a> answer by @SiddharthRout, we can start pulling in information from the closed workbook:</p>\n\n<pre><code>Sub Test()\n\nDim wbPath As String, wbName As String\nDim wsName As String, cellRef As String\nDim Ret As String\nDim lr As Long\nDim arr() As String\n\nwbPath = \"C:\\Users\\....\\SO\\\"\nwbName = \"SO.xlsx\"\nwsName = \"Sheet1\"\n\n'Get the last row from B column, notice we need R1C1 notation for Excel4Macro\nlr = ExecuteExcel4Macro(\"COUNTA('\" &amp; wbPath &amp; \"[\" &amp; wbName &amp; \"]\" &amp; wsName &amp; \"'!C2)\")\n\n'Let's use an array to fill our validation list with later on\nReDim arr(1 To lr)\nFor x = 1 To lr\n    arr(x) = ExecuteExcel4Macro(\"'\" &amp; wbPath &amp; \"[\" &amp; wbName &amp; \"]\" &amp; wsName &amp; \"'!R\" &amp; x &amp; \"C2\")\nNext x\n\n'Join the array together to make a string which will be accepted in the validation list\nWith Range(\"I6\").Validation\n    .Delete\n    .Add Type:=xlValidateList, Formula1:=Join(arr, \",\")\n    .IgnoreBlank = True\n    .InCellDropdown = True\n    .InputTitle = \"\"\n    .ErrorTitle = \"\"\n    .InputMessage = \"\"\n    .ErrorMessage = \"\"\n    .ShowInput = True\n    .ShowError = True\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>There are some things I would try to \"smoothen\" as for example <code>COUNTA</code> is not the best to get the <code>lr</code> variable, plus there might be a way to pull a complete range into the <code>arr()</code> variable at once.</p>\n\n<p>However, this might spark some creative ideas ;)</p>\n\n<hr>\n\n<p><strong>EDIT</strong></p>\n\n<p>Another way to retrieve the last row on string data could be to use <code>MATCH</code> like so:</p>\n\n<pre><code>lr = ExecuteExcel4Macro(\"MATCH(\"\"zzz\"\",'\" &amp; wbPath &amp; \"[\" &amp; wbName &amp; \"]\" &amp; wsName &amp; \"'!C2)\")\n</code></pre>\n"}], "owner": {"reputation": 418, "user_id": 6106932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1fe6348cb3a1f3b9a7afd420777c587a?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad Iordache", "link": "https://stackoverflow.com/users/6106932/vlad-iordache"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 0, "accepted_answer_id": 57888972, "answer_count": 2, "score": 2, "last_activity_date": 1568635928, "creation_date": 1568199216, "last_edit_date": 1568199396, "question_id": 57887549, "link": "https://stackoverflow.com/questions/57887549/run-time-error-1004-when-im-referring-to-a-range-that-is-not-named", "title": "Run-time error &#39;1004&#39; when I&#39;m referring to a range that is not named", "body": "<p>I'm trying to put a dropdown menu in an Excel worksheet, with options from another worksheet, in another workbook. I'm using VBA because <strong>I want to customize those options, based on another dropdown menu</strong>. I managed to do it by naming the range in the source sheet, but that file is read-only so I can't save the name to automate the process. So I tried to use only the column name in the reference (like $B:$B, I only need the B column), but when I run the macro it stops with Run-time error 1004.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim KeyCells As Range\n    Set KeyCells = Range(\"H6\")\n\n    If Not Application.Intersect(KeyCells, Range(Target.Address)) Is Nothing Then\n        Call main\n    End If\nEnd Sub\n\nPrivate Sub main()\n    reason = Range(\"H6\").Value\n    List = \"\"\n\n    If reason = \"Project ID/Task ID\" Then\n        List = \"=PIDTID\"\n    Else\n        List = \"=Cost_Center\"\n    End If\n\n    With Range(\"I6\").Validation\n        .Delete\n        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _\n            Operator:=xlBetween, Formula1:=List\n        .IgnoreBlank = True\n        .InCellDropdown = True\n        .InputTitle = \"\"\n        .ErrorTitle = \"\"\n        .InputMessage = \"\"\n        .ErrorMessage = \"\"\n        .ShowInput = True\n        .ShowError = True\n    End With\nEnd Sub\n</code></pre>\n\n<p>This is my macro, as you can see, <code>main()</code> is called when H6 is changed, because that is where my other dropdown menu is. Then, based on the value from that cell, List gets assigned a value equal to the defined name that refers to the range in the other worksheet.</p>\n\n<p>As an example, if PIDTID name is equal to <code>='[20190812_WP_and_CostCenters_Responsible.xls]Projects responsibles'!WBSName</code>, the script works. Note that WBSName is the name given to column B in the source sheet. </p>\n\n<p>If I set PIDTID to <code>='[20190812_WP_and_CostCenters_Responsible.xls]Projects responsibles'!$B:$B</code> I will get the error on line </p>\n\n<p><code>.Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _\nOperator:=xlBetween, Formula1:=List</code></p>\n\n<p><code>Cost_Center</code> name acts the same.</p>\n\n<p>I want to mention that these tests were done having the source file opened. If I tried with it being closed, I would get the same error.</p>\n\n<p>Is there a way to get rid of the error, or another way by which I can refer to cells in sheets of other workbooks without naming them? I would also like to work without having to open the source file. Thank you!</p>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 361, "user_id": 11738627, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sVrcM144Qb8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdf8GVfYBMmDcu1kPwkGrFSZUDOVQ/photo.jpg?sz=128", "display_name": "6diegodiego9", "link": "https://stackoverflow.com/users/11738627/6diegodiego9"}, "is_accepted": true, "score": 0, "last_activity_date": 1570287100, "creation_date": 1570287100, "answer_id": 58249429, "question_id": 57887046, "link": "https://stackoverflow.com/questions/57887046/microsoft-internet-controls-reference-sometimes-requires-re-assignation/58249429#58249429", "title": "&quot;Microsoft Internet Controls&quot; reference sometimes requires re-assignation", "body": "<p>I solved adding a call to this sub from ThisWorkbook:<br></p>\n\n<pre><code>Sub Readd_Reference_Microsoft_Internet_Controls()\n    Const fullpath = \"C:\\Windows\\SysWOW64\\ieframe.dll\"\n    ActiveWorkbook.VBProject.References.Remove GetReferenceFromPath(fullpath)\n\n    ThisWorkbook.VBProject.References.AddFromFile fullpath\n    'ActiveWorkbook.VBProject.References.AddFromGuid \"{EAB22AC0-30C1-11CF-A7EB-0000C05BAE0B}\", 0, 0 'Microsoft Internet Controls\nEnd Sub\n\nPrivate Function GetReferenceFromPath(ByVal strSearchFullPath As String) As Object\n    Dim oFs As FileSystemObject, oReferenceS As References, oReference As Reference, sRefFileName As String\n\n    Set oFs = New FileSystemObject\n\n    Dim sSearchFileName As String\n    sSearchFileName = oFs.GetFileName(strSearchFullPath)\n    Set oReferenceS = ActiveWorkbook.VBProject.References\n    For Each oReference In oReferenceS\n        sRefFileName = oFs.GetFileName(oReference.fullpath)\n        If StrComp(sSearchFileName, sRefFileName, vbTextCompare) = 0 Then ' se uguale\n            Set GetReferenceFromPath = oReference\n            Exit Function\n        End If\n    Next\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 361, "user_id": 11738627, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sVrcM144Qb8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdf8GVfYBMmDcu1kPwkGrFSZUDOVQ/photo.jpg?sz=128", "display_name": "6diegodiego9", "link": "https://stackoverflow.com/users/11738627/6diegodiego9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 58249429, "answer_count": 1, "score": 0, "last_activity_date": 1570287100, "creation_date": 1568197353, "last_edit_date": 1568198404, "question_id": 57887046, "link": "https://stackoverflow.com/questions/57887046/microsoft-internet-controls-reference-sometimes-requires-re-assignation", "title": "&quot;Microsoft Internet Controls&quot; reference sometimes requires re-assignation", "body": "<p>Every once in a while, on my same PC or on new PC with the same Windows (7) version and Excel (2010) version, when I try my usual Excel file with a VBA using \"Microsoft Internet Controls\" reference, debug incorrectly fails with a \"Compile error: can't assign to array\".<br>\nI found that the problem is immediately fixed by just re-assigning the \"Microsoft Internet Controls\" (uncheck-OK, then again check-OK).\nNote: its path is \"C:\\Windows\\SysWOW64\\ieframe.dll\".</p>\n\n<p>It's like if my functions which use that \"Microsoft Internet Controls\" library, and I designed to return an array, stop to work because the link to \"Microsoft Internet Controls\" gets corrupted(??!).</p>\n\n<p>I'm really lost on this.<br>\nAny ideas about how this problem can be fixed?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1568198285, "post_id": 57886618, "comment_id": 102196452, "body": "Event <code>Worksheet_Activate</code> executes when you activate that specific sheet, so it becomes the ActiveSheet, and your <code>Func</code> will execute on ActiveSheet, unless in the code of <code>Func</code> there is something that changes the active sheet."}, {"owner": {"reputation": 598, "user_id": 8256073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/110fcab852ac4ad3e33858c1db6c9dce?s=128&d=identicon&r=PG&f=1", "display_name": "gaback", "link": "https://stackoverflow.com/users/8256073/gaback"}, "edited": false, "score": 0, "creation_date": 1568199174, "post_id": 57886618, "comment_id": 102196932, "body": "When you assign <code>worksheet</code> in vba-code, use <code>activesheet</code>"}, {"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1568199900, "post_id": 57886618, "comment_id": 102197302, "body": "You can click on your sheet (right button), choose the View Code option and introduce the code you want to execute when you choose this WorkSheet. Is it ok for you?"}], "answers": [{"tags": [], "owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "is_accepted": false, "score": 0, "last_activity_date": 1568204615, "last_edit_date": 1568204615, "creation_date": 1568203930, "answer_id": 57888866, "question_id": 57886618, "link": "https://stackoverflow.com/questions/57886618/how-do-i-change-the-code-in-a-sheet-by-applying-a-module/57888866#57888866", "title": "how do I change the code in a sheet by applying a module", "body": "<p>You need to add the following codes to your Add-In, it is important to add them to the right module (as indicated by the comments in the code).</p>\n\n<pre><code>' ThisWorkbook\n\nOption Explicit\n\nPrivate Sub Workbook_Open()\n    InitializeMyEventHandler ThisWorkbook.Application\nEnd Sub\n\n\n' modMyEventHandler\n\nOption Explicit\n\nPublic g_mehHandler As clsMyEventHandler\n\nPublic Sub InitializeMyEventHandler(eapApplication As Application)\n    Set g_mehHandler = New clsMyEventHandler\n    Set g_mehHandler.eapApplication = eapApplication\nEnd Sub\n\n\n' clsMyEventHandler\n\nOption Explicit\n\nPublic WithEvents eapApplication As Application\n\nPrivate Sub eapApplication_SheetActivate(ByVal Sh As Object)\n    If TypeName(Sh) = \"Worksheet\" Then\n        Dim ewsSheet As Worksheet: Set ewsSheet = Sh\n        Debug.Print \"Worksheet activated. Workbook: \" &amp; ewsSheet.Parent.Name &amp; \", Worksheet: \" &amp; ewsSheet.Name\n    End If\nEnd Sub\n</code></pre>\n\n<p>The first part in the Add-In's ThisWorkbook module makes sure that our event handler class will be initialized each time the Add-In is loaded (when a new Excel Application is opened).</p>\n\n<p>The second part is a normal public module, which is capable of holding global public objects, in our case an object of class clsMyEventHandler. At initialization g_mehHandler will be set to a new instance of clsMyEventHandler, and its member, eapApplication will be assigned to the Application object received from the Add-In's Workbook_Open function.</p>\n\n<p>The third part must be added as a class module. It has a variable that is declared with WithEvents, this means that any time an event (e.g. activation of a new sheet) happens, the appropriate functions of this class module will be called. If a SheetActivate event is fired in eapApplication, then eapApplication_SheetActivate function of this class will be called. The function is selected based on its name (object name + underscore + event name). After you declared eapApplication (<code>Public WithEvents eapApplication As Application</code>), you will be able to select eapApplication from the ComboBox above the VBA code, which usually contains the word (General). If you selected eapApplication there, you will be able to select events to which you want to react from the ComboBox next to it.</p>\n"}], "owner": {"reputation": 7, "user_id": 11611239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/883238a762a53a6157a1b96a6ed103c6?s=128&d=identicon&r=PG&f=1", "display_name": "ashrek", "link": "https://stackoverflow.com/users/11611239/ashrek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568260239, "creation_date": 1568195818, "last_edit_date": 1568260239, "question_id": 57886618, "link": "https://stackoverflow.com/questions/57886618/how-do-i-change-the-code-in-a-sheet-by-applying-a-module", "title": "how do I change the code in a sheet by applying a module", "body": "<p>I made a module that I want to be a plugin. My issue is I want it to rerun every time I open the sheet and only the sheet I activated it on.</p>\n\n<p>I found a solution on how to do it by using the  </p>\n\n<pre><code>Private Sub Worksheet_Activate()\n     Call Func\nEnd sub\n</code></pre>\n\n<p>inside the sheet, I applied the macro to. How can I make it apply this code snipped to the currently active sheet when automatically when I activate the macro.</p>\n\n<p>Basically, when I use my plugin while I am on sheet x I want it to apply</p>\n\n<pre><code>Private Sub Worksheet_Activate()\n     Call Func\nEnd sub\n</code></pre>\n\n<p>this function to that specific sheet and that specific sheet only</p>\n\n<p>Just to clarify better.</p>\n\n<p>I want to sit on the sheet that has NO VBA code associated,</p>\n\n<p>activate my add-in</p>\n\n<p>and have a predefined code-block run in the context of the activated sheet.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 1, "creation_date": 1568198361, "post_id": 57886496, "comment_id": 102196490, "body": "Welcome to SO. I think it will helpful if you could post a data example (the input you got and the expected output)"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1568200679, "post_id": 57886496, "comment_id": 102197678, "body": "Rather share a file that reproduces the problem, but has sensitive information removed.  Or post a sample of Text that can be copy/pasted into a worksheet to do the same thing. A screenshot of data is virtually useless for doing proper troubleshooting unless it is very brief. It cannot be copy/pasted into a worksheet. Having to manually enter the data is discouraging to those who might assist you. To make the data useful edit your question to post it as text, perhaps using this <a href=\"http://www.tablesgenerator.com/markdown_tables\" rel=\"nofollow noreferrer\">Markdown Tables Generator</a>"}], "owner": {"reputation": 1, "user_id": 12052103, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAgGzlKq9ikdKJBBteHa8CvMOcBYp-HelqZRSDhzw=k-s128", "display_name": "yassmine idrissi", "link": "https://stackoverflow.com/users/12052103/yassmine-idrissi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1578958714, "creation_date": 1568195421, "last_edit_date": 1578958714, "question_id": 57886496, "link": "https://stackoverflow.com/questions/57886496/my-code-doesnt-return-the-expected-value-vba", "title": "My code doesn&#39;t return the expected value (VBA)", "body": "<p>I want to get volumes that are in a sheet called volumes, and in this sheet I have many volumes from 2019 to 2026, and this for many projects in rows.</p>\n\n<p>I want to get the volume by comparing each cell in Column C of the sheet <code>Loaded_Plan</code> to each row in column C in the sheet <code>Volumes</code>. I've tried to make a column Y in <code>Loaded_Plan</code> sheet for this but it doesn't work. Below is the code :</p>\n\n<pre><code>Dim rngProject Set rngProject = wsVolumes.Range(wsVolumes.Cells(5, \"B\"), wsVolumes.Cells(wsVolumes.Rows.Count, \"B\").End(xlUp)) 'Dim rngVolume Set rngVolume = wsVolumes.Range(wsVolumes.Cells(5, \"B\"), wsVolumes.Cells(wsVolumes.Rows.Count, \"V\").End(xlUp))\n\nFor Each cell In rngProject\n\n    wsLoaded_Plan.Cells(cell.Row, cell.Column + 23).Value = Application.VLookup(cell, wsLoaded_Plan.Range(\"C:C\"), 1, False)\n    ' Ne copie colle que cette ligne d'apr\u00e8s\n    wsLoaded_Plan.Cells(cell.Row, cell.Column + 8).Value = Application.VLookup(wsLoaded_Plan.Cells(cell.Row, cell.Column + 23).Value, rngVolume, 4, False)\n    wsLoaded_Plan.Cells(cell.Row, cell.Column + 10).Value = Application.VLookup(wsLoaded_Plan.Cells(cell.Row, cell.Column + 23).Value, rngVolume, 5, False)\n    wsLoaded_Plan.Cells(cell.Row, cell.Column + 12).Value = Application.VLookup(wsLoaded_Plan.Cells(cell.Row, cell.Column + 23).Value, rngVolume, 6, False)\n    wsLoaded_Plan.Cells(cell.Row, cell.Column + 14).Value = Application.VLookup(wsLoaded_Plan.Cells(cell.Row, cell.Column + 23).Value, rngVolume, 7, False)\n    wsLoaded_Plan.Cells(cell.Row, cell.Column + 16).Value = Application.VLookup(wsLoaded_Plan.Cells(cell.Row, cell.Column + 23).Value, rngVolume, 8, False)\n    wsLoaded_Plan.Cells(cell.Row, cell.Column + 20).Value = Application.VLookup(wsLoaded_Plan.Cells(cell.Row, cell.Column + 23).Value, rngVolume, 9, False)\n    wsLoaded_Plan.Cells(cell.Row, cell.Column + 22).Value = Application.VLookup(wsLoaded_Plan.Cells(cell.Row, cell.Column + 23).Value, rngVolume, 10, False)\n Next cell\n\nDim rngProject\n    Set rngProject = wsVolumes.Range(wsVolumes.Cells(5, \"B\"), wsVolumes.Cells(wsVolumes.Rows.Count, \"B\").End(xlUp))\n    Dim rngVolume\n    Set rngVolume = wsVolumes.Range(wsVolumes.Cells(5, \"B\"), wsVolumes.Cells(wsVolumes.Rows.Count, \"V\").End(xlUp))\n\n    For Each cell In rngProject\n\n        wsLoaded_Plan.Cells(cell.Row, cell.Column + 23).Value = Application.VLookup(cell, wsLoaded_Plan.Range(\"C:C\"), 1, False)\n        ' Ne copie colle que cette ligne d'apr\u00e8s\n        wsLoaded_Plan.Cells(cell.Row, cell.Column + 8).Value = Application.VLookup(wsLoaded_Plan.Cells(cell.Row, cell.Column + 23).Value, rngVolume, 4, False)\n        wsLoaded_Plan.Cells(cell.Row, cell.Column + 10).Value = Application.VLookup(wsLoaded_Plan.Cells(cell.Row, cell.Column + 23).Value, rngVolume, 5, False)\n        wsLoaded_Plan.Cells(cell.Row, cell.Column + 12).Value = Application.VLookup(wsLoaded_Plan.Cells(cell.Row, cell.Column + 23).Value, rngVolume, 6, False)\n        wsLoaded_Plan.Cells(cell.Row, cell.Column + 14).Value = Application.VLookup(wsLoaded_Plan.Cells(cell.Row, cell.Column + 23).Value, rngVolume, 7, False)\n        wsLoaded_Plan.Cells(cell.Row, cell.Column + 16).Value = Application.VLookup(wsLoaded_Plan.Cells(cell.Row, cell.Column + 23).Value, rngVolume, 8, False)\n        wsLoaded_Plan.Cells(cell.Row, cell.Column + 20).Value = Application.VLookup(wsLoaded_Plan.Cells(cell.Row, cell.Column + 23).Value, rngVolume, 9, False)\n        wsLoaded_Plan.Cells(cell.Row, cell.Column + 22).Value = Application.VLookup(wsLoaded_Plan.Cells(cell.Row, cell.Column + 23).Value, rngVolume, 10, False)\n     Next cell\n\n End\n\nEnd Sub\n</code></pre>\n\n<p>I am expecting to get the volumes from sheet <code>Volumes</code> from columns : F,G,H,I,J,K,L,M, to the sheet <code>Loaded_Plan</code> in columns I,K,M,O,Q,S,U,W, with respect to the project in rows. What I want is two volumes: one for 2019 and the other for 2020 (but it is not done in the suitable row, the matching between projects is not correct).</p>\n\n<p><a href=\"https://audencia0-my.sharepoint.com/:x:/g/personal/yasmine_idrissi_audencia_com/EZrWrJXHtWZNhDVQl1rd04IBs6BwU_1M778P1dtUE-wFpQ?e=G9qg1q\" rel=\"nofollow noreferrer\">Excel document</a>.</p>\n"}, {"tags": ["excel", "vba", "excel-2013", "regedit"], "answers": [{"tags": [], "owner": {"reputation": 3387, "user_id": 6248219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcdde87fb76a1bd9d3e079895abfbea7?s=128&d=identicon&r=PG&f=1", "display_name": "Louis", "link": "https://stackoverflow.com/users/6248219/louis"}, "is_accepted": false, "score": 4, "last_activity_date": 1568192656, "creation_date": 1568192656, "answer_id": 57885665, "question_id": 57885323, "link": "https://stackoverflow.com/questions/57885323/open-windows-registry-editor-from-excel/57885665#57885665", "title": "Open Windows Registry Editor from excel", "body": "<p>By default, <code>regedit.exe</code> do not allow opening itself with a specified key. If you only need to read a key value, you can use VBA <code>Windows Scripting Feature</code> to do it:</p>\n\n<pre><code>Dim myWS As Object\nDim i_RegKey As String\n'Change this with your Registry Key\ni_RegKey = \"HKEY_USERS\\S-1-5-18\\Control Panel\\Accessibility\\HighContrast\\Flags\"\n\nOn Error Resume Next\n'Access Windows scripting\nSet myWS = CreateObject(\"WScript.Shell\")\n'Read key from registry\nRegKeyRead = myWS.RegRead(i_RegKey)\n'Do something with this value\n</code></pre>\n\n<p>Otherwise, if you need to read it with <code>regedit.exe</code>, you can download a Microsoft tool called <code>regjump.exe</code> and setting it to jump to your specified key. More info on how to do that <a href=\"https://superuser.com/questions/115854/open-registry-directly-to-a-given-key\">here</a>.</p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 250, "user_id": 8247997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33206a33b56aaf9b9e01d1760419094c?s=128&d=identicon&r=PG&f=1", "display_name": "Somanna", "link": "https://stackoverflow.com/users/8247997/somanna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568193294, "creation_date": 1568191312, "last_edit_date": 1568193294, "question_id": 57885323, "link": "https://stackoverflow.com/questions/57885323/open-windows-registry-editor-from-excel", "title": "Open Windows Registry Editor from excel", "body": "<p>I want to open the default registry editor with a specific registry key opened when I click on a command button in a excel worksheet. Is there anyway I can do it?<br>\nThanks. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1568191277, "post_id": 57885239, "comment_id": 102192928, "body": "You might benefit from reading  <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12051783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d352d6a95a5a115f72576a1ad31ae1b?s=128&d=identicon&r=PG&f=1", "display_name": "Catherine", "link": "https://stackoverflow.com/users/12051783/catherine"}, "edited": false, "score": 0, "creation_date": 1568194152, "post_id": 57885908, "comment_id": 102194363, "body": "@Reh  thank you for your help. I will definitely go through the info mentioned in the link."}, {"owner": {"reputation": 3, "user_id": 12051783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d352d6a95a5a115f72576a1ad31ae1b?s=128&d=identicon&r=PG&f=1", "display_name": "Catherine", "link": "https://stackoverflow.com/users/12051783/catherine"}, "edited": false, "score": 0, "creation_date": 1568194264, "post_id": 57885908, "comment_id": 102194413, "body": "David, thank you for the reply! The code definitely looks much better and professional. However there still is the same problem. e.g. if I put something in the row 90 and 91 - the 94:101 appear. But if I delete e.g. 90 (91 stays so 94:101 should stay as well) - 94:101 are hidden again..."}, {"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "reply_to_user": {"reputation": 3, "user_id": 12051783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d352d6a95a5a115f72576a1ad31ae1b?s=128&d=identicon&r=PG&f=1", "display_name": "Catherine", "link": "https://stackoverflow.com/users/12051783/catherine"}, "edited": false, "score": 0, "creation_date": 1568195197, "post_id": 57885908, "comment_id": 102194874, "body": "OK. As per your condition, as soon as one of the values on B90, B91 or B92 is &quot;&quot;, then everything will be hidden. So the problem is the code. What do you want exactly? If all the cells have a value, it will work, if one have no value (&quot;&quot;), then enerything will be hidden. That is your intention?"}, {"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "reply_to_user": {"reputation": 3, "user_id": 12051783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d352d6a95a5a115f72576a1ad31ae1b?s=128&d=identicon&r=PG&f=1", "display_name": "Catherine", "link": "https://stackoverflow.com/users/12051783/catherine"}, "edited": false, "score": 0, "creation_date": 1568195303, "post_id": 57885908, "comment_id": 102194933, "body": "Is there any order? I mean, if B90 is &quot;&quot; but B91 and/or B92 have any value, then everything should be shown?"}, {"owner": {"reputation": 3, "user_id": 12051783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d352d6a95a5a115f72576a1ad31ae1b?s=128&d=identicon&r=PG&f=1", "display_name": "Catherine", "link": "https://stackoverflow.com/users/12051783/catherine"}, "edited": false, "score": 0, "creation_date": 1568195542, "post_id": 57885908, "comment_id": 102195069, "body": "I want it to work as following: if at least one of B90, B91 or B92 is not &quot;&quot; -&gt; 94:101 appear. If all of them are empty -&gt; 94:101 are hidden."}, {"owner": {"reputation": 3, "user_id": 12051783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d352d6a95a5a115f72576a1ad31ae1b?s=128&d=identicon&r=PG&f=1", "display_name": "Catherine", "link": "https://stackoverflow.com/users/12051783/catherine"}, "edited": false, "score": 0, "creation_date": 1568196637, "post_id": 57885908, "comment_id": 102195658, "body": "So using your code version I&#39;ve modified it like this - <code>Private Sub Worksheet_Change(ByVal Target As Range)     If (Target.Column = 2) And ((Target.Row = 90) Or _                        (Target.Row = 91) Or (Target.Row = 92)) Then         If Target.Value = &quot;x&quot; Then             Application.Rows(&quot;94:101&quot;).Select             Application.Selection.EntireRow.Hidden = False             Else: [94:101].EntireRow.Hidden = True         End If     End If End Sub</code>"}], "tags": [], "owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "is_accepted": false, "score": 0, "last_activity_date": 1568199255, "last_edit_date": 1568199255, "creation_date": 1568193514, "answer_id": 57885908, "question_id": 57885239, "link": "https://stackoverflow.com/questions/57885239/how-to-unhide-rows-based-on-any-of-several-criteria/57885908#57885908", "title": "How to unhide rows based on ANY of several criteria?", "body": "<p>Check @PEH comment first.\nFollowing your philosophy, try this one:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)    \n\nWith WorkSheets(1)\n    If (.Range(\"B90\").Value2 &lt;&gt; \"\") Or (.Range(\"B91\").Value2 &lt;&gt; \"\") Or _\n                       (.Range(\"B92\").Value2 &lt;&gt; \"\") Then    \n        If Target.Value = \"\" Then    \n            .Rows(\"94:101\").EntireRow.Hidden = True    \n        Else\n            .Rows(\"94:101\").EntireRow.Hidden = False    \n        End If    \n    End If  \nEnd With  \nEnd Sub\n</code></pre>\n\n<p>Just custom the WorkSheets(1) to your WorkBook.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 12051783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d352d6a95a5a115f72576a1ad31ae1b?s=128&d=identicon&r=PG&f=1", "display_name": "Catherine", "link": "https://stackoverflow.com/users/12051783/catherine"}, "edited": false, "score": 0, "creation_date": 1568199843, "post_id": 57886749, "comment_id": 102197269, "body": "I have adjusted it to my table - changed Target.Row to Target.Column and vice versa - and it worked great. Thank you very much!"}], "tags": [], "owner": {"reputation": 641, "user_id": 4037170, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b377de247501ccb94ad5aebaf49f6aa9?s=128&d=identicon&r=PG&f=1", "display_name": "dimitris", "link": "https://stackoverflow.com/users/4037170/dimitris"}, "is_accepted": true, "score": 0, "last_activity_date": 1568199546, "last_edit_date": 1568199546, "creation_date": 1568196242, "answer_id": 57886749, "question_id": 57885239, "link": "https://stackoverflow.com/questions/57885239/how-to-unhide-rows-based-on-any-of-several-criteria/57886749#57886749", "title": "How to unhide rows based on ANY of several criteria?", "body": "<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Row = 2 And (Target.Column = 90 Or Target.Column = 91 Or Target.Column = 92) Then\n        If Range(\"B90\") = \"\" And Range(\"B91\") = \"\" And Range(\"B92\") = \"\" Then\n            Range(\"A94:A101\").EntireRow.Hidden = True\n        Else\n            Range(\"A94:A101\").EntireRow.Hidden = False\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12051783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d352d6a95a5a115f72576a1ad31ae1b?s=128&d=identicon&r=PG&f=1", "display_name": "Catherine", "link": "https://stackoverflow.com/users/12051783/catherine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 57886749, "answer_count": 2, "score": 0, "last_activity_date": 1584342735, "creation_date": 1568190935, "last_edit_date": 1584342735, "question_id": 57885239, "link": "https://stackoverflow.com/questions/57885239/how-to-unhide-rows-based-on-any-of-several-criteria", "title": "How to unhide rows based on ANY of several criteria?", "body": "<p>An IF function checks whether the cells in any of the rows in the chosen column of the table is filled in, e.g. Column 1, row 1, 2 and 3 - if any of the cells is filled in - additional rows are unhidden.</p>\n\n<p>The function works when the table is getting filled in but only until something gets deleted from it.</p>\n\n<p>e.g. if the table has all the rows 1, 2 and 3 in column 1 filled in - additional rows appear. If I delete one of the cells values e.g. column 1 row 1 - the additional row hides again. The criteria for it to be unhidden is still there, rows 2 and 3 are still filled in.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)    \n    If Target.Column = 2 And Target.Row = 90 Then    \n        If Target.Value = \"\" Then    \n            Application.Rows(\"94:101\").Select   \n            Application.Selection.EntireRow.Hidden = True    \n            Else: [94:101].EntireRow.Hidden = False    \n        End If    \n    End If\n\n    If Target.Column = 2 And Target.Row = 91 Then    \n        If Target.Value = \"\" Then    \n            Application.Rows(\"94:101\").Select    \n            Application.Selection.EntireRow.Hidden = True    \n            Else: [94:101].EntireRow.Hidden = False    \n        End If    \n    End If\n\n    If Target.Column = 2 And Target.Row = 92 Then    \n        If Target.Value = \"\" Then    \n            Application.Rows(\"94:101\").Select    \n            Application.Selection.EntireRow.Hidden = True    \n            Else: [94:101].EntireRow.Hidden = False    \n        End If    \n    End If    \nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "windows-10", "windows-defender"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1568193934, "post_id": 57885185, "comment_id": 102194246, "body": "You say it runs faster if you turn off defender. Does it also run faster if you define a exception for your folder/files in defender (instead of turning it off)?"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1568194110, "post_id": 57885185, "comment_id": 102194335, "body": "I&#39;ve had similar issues. To get round it I had to remove/rewrite all references to any <code>*32</code> libraries. Windows Defender flags all of these whether they are actual code or even just commented."}, {"owner": {"reputation": 69, "user_id": 10590721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/559005918db1f4720919a48b89e8ec3c?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/10590721/john-doe"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1568201890, "post_id": 57885185, "comment_id": 102198292, "body": "@P\u1d07\u029c I didn&#39;t try that though I tried putting the file itself and/or the Excel-Application itself on the exception list without any success."}, {"owner": {"reputation": 69, "user_id": 10590721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/559005918db1f4720919a48b89e8ec3c?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/10590721/john-doe"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1568201938, "post_id": 57885185, "comment_id": 102198316, "body": "@Tom Somehow glad to hear I&#39;m not the only one. But you didn&#39;t find any way around that except not using API-calls, did you?"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1568204428, "post_id": 57885185, "comment_id": 102199641, "body": "@JohnDoe I found alternate ways using WMI or shell calls - You may benefit from reading this paper <a href=\"http://blog.sevagas.com/IMG/pdf/bypass_windows_defender_attack_surface_reduction.pdf\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 69, "user_id": 10590721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/559005918db1f4720919a48b89e8ec3c?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/10590721/john-doe"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1568268733, "post_id": 57885185, "comment_id": 102221894, "body": "@Tom thank you, I will have a look at that paper!"}, {"owner": {"reputation": 69, "user_id": 10590721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/559005918db1f4720919a48b89e8ec3c?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/10590721/john-doe"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1568706511, "post_id": 57885185, "comment_id": 102349433, "body": "@Tom I read the paper now and it is quite interesting! Though unfortunately it is not of any help because Windows Defender is just slowing down the code execution, there is nothing actually blocked by ASR related to the API calls."}], "owner": {"reputation": 69, "user_id": 10590721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/559005918db1f4720919a48b89e8ec3c?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/10590721/john-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 589, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1614339639, "creation_date": 1568190769, "last_edit_date": 1568194712, "question_id": 57885185, "link": "https://stackoverflow.com/questions/57885185/windows-defender-extremly-slowing-down-macro-only-on-windows-10", "title": "Windows Defender extremly slowing down Macro only on Windows 10", "body": "<p>I wrote a large VBA program which, in a nutshell, calculates the energy need of buildings. It would be way to much code to post here but firstly it reads a configuration file for each building, then loads some heat load profiles from the disk and then dynamically calculates for 35040 quarter hours which heat producers generates what amount of heat.</p>\n\n<p>On Windows 7 with Windows Defender it just runs smooth and fine, no matter what Excel Version (2007, 2010, 2013, 365 tested).</p>\n\n<p>Now, if I'm running the same code on my computer with Windows 10 and Windows Defender (Excel 365), it is slower by an incredible amount (factor 1000 or so it feels). And strangely, everything is way slower, it is not a certain procedure or event. Loading the files and profiles from the disk takes forever, but calculating the energy needs in the loop (where nothing is transferred from/to the drive) is way slower aswell. The GUI isn't refreshing at all and the whole application just seems frozen. </p>\n\n<p>At the same time MsMpEng.exe is on full load, suggesting Windows Defender has a problem. And surprise, having turned off Windows Defender, everything runs fine.</p>\n\n<p>Now, because there are so many classes/modules/etc. it is hard to say, what may be the problem and I can't upload the code. But at least I have a suspicion. Every class has a Parent Property, implemented as depicted  <a href=\"https://rubberduckvba.wordpress.com/2018/09/11/lazy-object-weak-reference/\" rel=\"nofollow noreferrer\">here</a>.\nThe parent property is called very often and all over the code so the extreme slow down would make sense if there was a problem with the CopyMemory-API/Function. </p>\n\n<p><strong>Update 1</strong>:\nI removed the CopyMemory-Function and replaced all the Parents with Circular References. This is no long term solution, but it solved part of the problem. When I wait long enough the calculation starts at some point and is as fast as it's supposed to be. So the problem could be related to API-Functions in general because I use quite a lot for the GUI, namely</p>\n\n<pre><code>Public Declare PtrSafe Function GetDC Lib \"user32\" (ByVal hWnd As LongPtr) As LongPtr\n\nPublic Declare PtrSafe Function GetDeviceCaps Lib \"Gdi32\" (ByVal hDC As LongPtr, ByVal _\n    nIndex As Long) As Long\n\nPublic Declare PtrSafe Function ReleaseDC Lib \"user32\" (ByVal hWnd As LongPtr, ByVal _\n    hDC As LongPtr) As Long\n\nPublic Declare PtrSafe Function GetSystemMetrics32 Lib \"user32\" _\n    Alias \"GetSystemMetrics\" (ByVal nIndex As Long) As Long\n\nPublic Declare PtrSafe Function SetWindowPos Lib \"user32\" _\n        (ByVal hWnd As LongPtr, ByVal hWndInsertAfter As LongPtr, _\n        ByVal X As Long, ByVal Y As Long, ByVal cx As Long, _\n        ByVal cy As Long, ByVal wFlags As Long) As Long\n\nPublic Declare PtrSafe Function DrawMenuBar Lib \"user32\" (ByVal hWnd As LongPtr) As Long\n\nPublic Declare PtrSafe Function FindWindow Lib \"user32\" Alias \"FindWindowA\" _\n    (ByVal lpClassName As String, ByVal lpWindowName As String) As Long\n\nPublic Declare PtrSafe Function SendMessage Lib \"user32\" Alias \"SendMessageA\" _\n    (ByVal hWnd As LongPtr, ByVal wMsg As Long, ByVal wParam As LongPtr, lParam As Any) As LongPtr\n\nPublic Declare PtrSafe Sub ReleaseCapture Lib \"user32\" ()\n\nPublic Declare PtrSafe Function ExtractIcon Lib \"shell32.dll\" Alias \"ExtractIconA\" _\n    (ByVal hInst As LongPtr, ByVal lpszExeFileName As String, ByVal nIconIndex As Long) As LongPtr\n\nPublic Declare PtrSafe Function GetActiveWindow32 Lib \"user32\" Alias \"GetActiveWindow\" () As Integer\n\n#If Win64 Then\n    Public Declare PtrSafe Function GetWindowLongPtr Lib \"user32\" Alias \"GetWindowLongPtrA\" _\n        (ByVal hWnd As LongPtr, ByVal nIndex As Long) As LongPtr\n    Public Declare PtrSafe Function SetWindowLongPtr Lib \"user32\" Alias \"SetWindowLongPtrA\" _\n        (ByVal hWnd As LongPtr, ByVal nIndex As Long, ByVal dwNewLong As LongPtr) As LongPtr\n#Else\n    Private Declare PtrSafe Function GetWindowLongPtr Lib \"user32\" Alias \"GetWindowLongA\" _\n        (ByVal hWnd As LongPtr, ByVal nIndex As Long) As LongPtr\n    Private Declare PtrSafe Function SetWindowLongPtr Lib \"user32\" Alias \"SetWindowLongA\" _\n        (ByVal hWnd As LongPtr, ByVal nIndex As Long, ByVal dwNewLong As LongPtr) As LongPtr\n#End If\n</code></pre>\n\n<p><strong>Update 2</strong> (which makes the topic in a way solved):</p>\n\n<p>The reason for the loading-part of the program took so long is because I used the <a href=\"https://github.com/VBA-tools/VBA-JSON/blob/master/JsonConverter.bas\" rel=\"nofollow noreferrer\">JSON-Converter</a>. And as it turns out there was a <a href=\"https://github.com/VBA-tools/VBA-JSON/issues/96\" rel=\"nofollow noreferrer\">similar problem</a>. Since I updated the module and removed every other API-Call everything runs fine and smooth. So it is definitly caused by the API-Calls though I don't know why there aren't that many other people complaining about the huge performance issues. And now I can't tweak the GUI in the way I wan't to and I don't really know how to implement the parent property properly.</p>\n"}, {"tags": ["excel", "vba", "inheritance"], "comments": [{"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1568190749, "post_id": 57884975, "comment_id": 102192680, "body": "There is no inheritance in VBA. Use Composition instead... <a href=\"https://stackoverflow.com/a/31861832/10223558\">stackoverflow.com/a/31861832/10223558</a>  Unfortunately there isn&#39;t really a better solution, the OOP-Capabilites of VBA are quite limited in this regard.  You already pointed this out in your question, I&#39;ll leave the comment for the link."}, {"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 1, "creation_date": 1568190936, "post_id": 57884975, "comment_id": 102192754, "body": "The third solution is fine, but you&#39;ll loose the advantage of using an Interface and could just as well leave it out."}, {"owner": {"reputation": 334, "user_id": 2874210, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wefCB.gif?s=128&g=1", "display_name": "Jonas Glesaaen", "link": "https://stackoverflow.com/users/2874210/jonas-glesaaen"}, "reply_to_user": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1568191253, "post_id": 57884975, "comment_id": 102192914, "body": "@L8n I guess my thinking is that in certain situations although VBA doesn&#39;t do OOP, if I was able to mimic it just enough I would get away with creating 1 class instead of 2, meaning that I would have less code to worry about and less things to name when composition doesn&#39;t really give me anything extra. Also, what do you mean I loose the advantage of using an Interface? I can still pass the object to anything that expects an <code>IGreeter</code> and use it like a regular interface."}, {"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1568191639, "post_id": 57884975, "comment_id": 102193098, "body": "Since you will be refering to the child class directly you won&#39;t be able to exchange the object at runtime. If you want to reuse code (and only keep it in one place) you have to use composition."}, {"owner": {"reputation": 334, "user_id": 2874210, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wefCB.gif?s=128&g=1", "display_name": "Jonas Glesaaen", "link": "https://stackoverflow.com/users/2874210/jonas-glesaaen"}, "reply_to_user": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1568192165, "post_id": 57884975, "comment_id": 102193369, "body": "That is a good point, I don&#39;t do much runtime polymorphism, I mostly use it for code organisation. E.g. having two objects that provide the same base interface should implement the same interface so that I can write code for their generic behaviour which the two can share and code for their specific behaviour which the two cannot share."}, {"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1568192479, "post_id": 57884975, "comment_id": 102193518, "body": "What I do sometimes is use the TypeOf Function to determine what kind of &quot;Child&quot; the object which implements an interface is. Then use a select case, assign declare it as the actual child object and do something with it."}, {"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1568192659, "post_id": 57884975, "comment_id": 102193608, "body": "But to come back to your question, case 3 is ok and works. just be aware that you are not using the interface as intended..."}, {"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1568192969, "post_id": 57884975, "comment_id": 102193794, "body": "I often use a GenericFoo class that Implements IFoo then. Then I write classes that encapsulate GenericFoo but themselves also implement IFoo, which can then be &quot;forwarded&quot; to the GenericFoo or be implemented in a different way. To use the child-class functions I then use a select Case with TypeOf   (<a href=\"https://stackoverflow.com/a/1301977/10223558\">stackoverflow.com/a/1301977/10223558</a>) to determine what to do with the object..."}, {"owner": {"reputation": 334, "user_id": 2874210, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wefCB.gif?s=128&g=1", "display_name": "Jonas Glesaaen", "link": "https://stackoverflow.com/users/2874210/jonas-glesaaen"}, "reply_to_user": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1568193267, "post_id": 57884975, "comment_id": 102193946, "body": "@L8n Thanks a lot for your insight. I agree that I am trying to get inheritance in a language where there is no inheritance by using interfaces in unintended ways. I will try to keep that in mind when I develop further and see if I can use composition more often and leave the interfaces to their intended use."}, {"owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "edited": false, "score": 0, "creation_date": 1568208122, "post_id": 57884975, "comment_id": 102201855, "body": "First declare <code>Dim MyGreeter As IGreeter</code>, and then <code>Set MyGreeter = New PoliteGreeter</code>.  Then you can use <code>MyGreeter.Greet</code>."}], "owner": {"reputation": 334, "user_id": 2874210, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wefCB.gif?s=128&g=1", "display_name": "Jonas Glesaaen", "link": "https://stackoverflow.com/users/2874210/jonas-glesaaen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568189972, "creation_date": 1568189972, "question_id": 57884975, "link": "https://stackoverflow.com/questions/57884975/expose-parents-method-in-instance-of-a-child-class-in-vba", "title": "Expose parent&#39;s method in instance of a child class in VBA", "body": "<p>Trying to do inheritance in VBA I sometimes encounter the issue of having an instance of a child class and needing to call a function from the parent's class that the child overrides.</p>\n\n<p>Quick example:</p>\n\n<p>In <code>IGreeter.cls</code></p>\n\n<pre><code>Public Sub Greet()\nEnd Sub\n</code></pre>\n\n<p>In <code>PoliteGreeter.cls</code></p>\n\n<pre><code>Implements IGreeter\n\nPrivate Sub IGreeter_Greet()\n  Debug.Print \"Good morning\"\nEnd Sub\n</code></pre>\n\n<p>In <code>Main.bas</code></p>\n\n<pre><code>Public Sub RunGreeter()\n\n  Dim MyGreeter As PoliteGreeter\n  Set MyGreeter = New PoliteGreeter\n\n  MyGreeter.Greet ' Doesn't work, function not defined\n\nEnd Sub\n</code></pre>\n\n<p>There are of course easy ways to solve the issue for this example, two ways I see are:</p>\n\n<ol>\n<li>Define <code>MyGreeter</code> as an instance of <code>IGreeter</code> instead.</li>\n<li>Make the override function public and call <code>IGreeter_Greet</code> directly.</li>\n</ol>\n\n<p>Neither of these solutions are very good. For the first one, if I had additional functionality in <code>PoliteGreeter</code> that I wanted to access I would need two variables to accessed its full scope of functions. The second solution is both ugly and seems very very wrong, specially since VBE by default makes the definition private.</p>\n\n<p>There is however a third solution that I see and that is to add <code>Greet</code> also as a public method of <code>PoliteGreeter</code> as following</p>\n\n<pre><code>Implements IGreeter\n\nPublic Sub Greet()\n  IGreeter_Greet\nEnd Sub\n\nPrivate Sub IGreeter_Greet()\n  Debug.Print \"Good morning\"\nEnd Sub\n</code></pre>\n\n<p>A fourth solution would be to do the first one and solve my concern with additional functionality through composition instead as VBA doesn't actually do inheritance. However my question is whether this third method is safe, if it shadows something, if there are caveats, and if there are other better standard solutions to this kind of problem.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1568189667, "post_id": 57884830, "comment_id": 102192077, "body": "@eirikdaude That has nothing to do with the colon."}], "answers": [{"tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 0, "last_activity_date": 1568190269, "last_edit_date": 1568190269, "creation_date": 1568189863, "answer_id": 57884947, "question_id": 57884830, "link": "https://stackoverflow.com/questions/57884830/vba-colon-statement-delimiter-how-does-it-exactly-work/57884947#57884947", "title": "VBA colon &quot;:&quot; statement delimiter. How does it exactly work?", "body": "<p>Colon <code>:</code> allows you to put 2 or more instructions on the same line.<br>\n<code>Then</code> has 2 syntaxes:  </p>\n\n<pre><code>If expression Then instruction  'case a\n</code></pre>\n\n<p>or</p>\n\n<pre><code>If expression Then              'case b\n   somecode\n'optional Else / ElseIf\nEnd If\n</code></pre>\n\n<p>It seems for your observations that <code>Then</code>needs to be the last instruction in the row to fall into case b.   </p>\n\n<p>i find <code>:</code> more useful in 2 situations:  </p>\n\n<p>With <code>Select Case</code>  </p>\n\n<pre><code>Select Case x\n   Case 1: DoThis\n   Case 2: DoThat\nEnd Select  \n</code></pre>\n\n<p>With <code>Dim</code> (if you don't require all Dims to be at the top of procedure)  </p>\n\n<pre><code>   Dim Somevalue as long: SomeValue = 3\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 361, "user_id": 11738627, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sVrcM144Qb8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdf8GVfYBMmDcu1kPwkGrFSZUDOVQ/photo.jpg?sz=128", "display_name": "6diegodiego9", "link": "https://stackoverflow.com/users/11738627/6diegodiego9"}, "edited": false, "score": 0, "creation_date": 1568191213, "post_id": 57884970, "comment_id": 102192890, "body": "Thanks Nick!  &quot;denotes the end of a valid VBA statement&quot; is the definition that I&#39;ll keep in my mind since now, replacing the fallacious &quot;new line&quot;"}, {"owner": {"reputation": 361, "user_id": 11738627, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sVrcM144Qb8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdf8GVfYBMmDcu1kPwkGrFSZUDOVQ/photo.jpg?sz=128", "display_name": "6diegodiego9", "link": "https://stackoverflow.com/users/11738627/6diegodiego9"}, "edited": false, "score": 0, "creation_date": 1568191256, "post_id": 57884970, "comment_id": 102192915, "body": "I can also see that &quot;If 1 = 2 Then: MsgBox &quot;impossible&quot;: Else: MsgBox &quot;OK&quot;&quot; works, and any removing any of its colons works too"}], "tags": [], "owner": {"reputation": 2465, "user_id": 2570277, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0483cce5f2ea53671a36477fed79898b?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2570277/nick"}, "is_accepted": true, "score": 0, "last_activity_date": 1568189938, "creation_date": 1568189938, "answer_id": 57884970, "question_id": 57884830, "link": "https://stackoverflow.com/questions/57884830/vba-colon-statement-delimiter-how-does-it-exactly-work/57884970#57884970", "title": "VBA colon &quot;:&quot; statement delimiter. How does it exactly work?", "body": "<p>The colon allows you to write a statement on one line, and denotes the end of a valid VBA statement. </p>\n\n<p>However, some colons can be omitted ( or added automatically by the VBA editor ) depending on the occurrence of any <code>else</code> statements. The <code>End if</code> can also be omitted in some cases</p>\n\n<p>For instance, your one line statement would run if it was written as:</p>\n\n<p><code>If 1 = 2 Then MsgBox \"impossible\" Else: MsgBox \"OK\"</code></p>\n\n<p>Note the absence of the <code>End if</code>. Your 2 line statement is syntactically wrong and will throw an error.</p>\n"}, {"comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1568233197, "post_id": 57885038, "comment_id": 102213759, "body": "I didn&#39;t know about the possibility of Else in a single line form. Thanks"}], "tags": [], "owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "is_accepted": false, "score": 1, "last_activity_date": 1568190207, "last_edit_date": 1592644375, "creation_date": 1568190207, "answer_id": 57885038, "question_id": 57884830, "link": "https://stackoverflow.com/questions/57884830/vba-colon-statement-delimiter-how-does-it-exactly-work/57885038#57885038", "title": "VBA colon &quot;:&quot; statement delimiter. How does it exactly work?", "body": "<p>The colon is not a replacement for the new line.<br />\nIt allows you to put several statements on one line, but this still counts as one line for the purpose of grammar.</p>\n<p>The <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/ifthenelse-statement#remarks\" rel=\"nofollow noreferrer\">documentation</a> specifically shows the use of colon with <code>If</code>:</p>\n<blockquote>\n<p>With the single-line form, it is possible to have multiple statements executed as the result of an <code>If...Then</code> decision. All statements must be on the same line and separated by colons, as in the following statement:</p>\n<pre><code>If A &gt; 10 Then A = A + 1 : B = B + A : C = C + B\n</code></pre>\n</blockquote>\n<p>Where &quot;<a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/ifthenelse-statement#syntax\" rel=\"nofollow noreferrer\">single-line form</a>&quot; is</p>\n<blockquote>\n<pre><code>If condition Then [ statements ] [ Else elsestatements ]\n</code></pre>\n</blockquote>\n<p>as opposed to the multi-line form</p>\n<blockquote>\n<pre><code>If condition Then\n    [ statements ]\n[ ElseIf condition-n Then\n    [ elseifstatements ]]\n[ Else\n    [ elsestatements ]]\nEnd If\n</code></pre>\n</blockquote>\n<p>You put several statement on one line, but you still use the single-line form of the <code>If</code> statement, without the <code>End If</code>.</p>\n"}], "owner": {"reputation": 361, "user_id": 11738627, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sVrcM144Qb8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdf8GVfYBMmDcu1kPwkGrFSZUDOVQ/photo.jpg?sz=128", "display_name": "6diegodiego9", "link": "https://stackoverflow.com/users/11738627/6diegodiego9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 57884970, "answer_count": 3, "score": 2, "last_activity_date": 1568190269, "creation_date": 1568189471, "question_id": 57884830, "link": "https://stackoverflow.com/questions/57884830/vba-colon-statement-delimiter-how-does-it-exactly-work", "title": "VBA colon &quot;:&quot; statement delimiter. How does it exactly work?", "body": "<p>What exactly does the colon \":\" (statement delimiter) do in VBA?</p>\n\n<p>\":\" meant as a \"newline\" fails to explain this behavior:<br><br></p>\n\n<p>This 3-lines code compiles successfully:</p>\n\n<pre><code>If 1 = 2 Then\n    MsgBox \"impossible\"\nElse: MsgBox \"OK\": End If\n</code></pre>\n\n<p><br>\nThis 2-lines version fails with \"Compile error: Else without If\":</p>\n\n<pre><code>If 1 = 2 Then: MsgBox \"impossible\"\nElse: MsgBox \"OK\": End If\n</code></pre>\n\n<p><br>\nThis 1-line version fails with \"Compile error: End If without block If\":</p>\n\n<pre><code>If 1 = 2 Then: MsgBox \"impossible\": Else: MsgBox \"OK\": End If\n</code></pre>\n\n<p><br>\nSo, how the meaning of \":\" be exactly described, compatibly with these behavior?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 1, "creation_date": 1568189099, "post_id": 57884480, "comment_id": 102191794, "body": "You already have a code that works, so just go for the new range. What is the question?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1568191477, "post_id": 57884480, "comment_id": 102193031, "body": "Note that you use <code>On Error Resume Next</code> wrong. This line hides <b>all</b> error messages until <code>End Sub</code> but the errors still occur. You just cannot see their messages. Remove this line and fix your errors or implement a proper error handling (VBA Error Handling \u2013 A Complete Guide](<a href=\"https://excelmacromastery.com/vba-error-handling\" rel=\"nofollow noreferrer\">excelmacromastery.com/vba-error-handling</a>)). Otherwise the result of your code is pretty much unpredictable."}, {"owner": {"reputation": 1, "user_id": 12051636, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xM8s7sQ1oPI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd52cxDaMec62zHA7psorNcOwyeRw/photo.jpg?sz=128", "display_name": "M K", "link": "https://stackoverflow.com/users/12051636/m-k"}, "edited": false, "score": 0, "creation_date": 1568192524, "post_id": 57884480, "comment_id": 102193544, "body": "Thanks for your reply David and Peh, my question was how do I add additional code so that I can further create more sheets from the STAFF sheet column E same way as the sheet Scan. I can&#39;t figure this out as I am a novice."}], "owner": {"reputation": 1, "user_id": 12051636, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xM8s7sQ1oPI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd52cxDaMec62zHA7psorNcOwyeRw/photo.jpg?sz=128", "display_name": "M K", "link": "https://stackoverflow.com/users/12051636/m-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 18, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568191341, "creation_date": 1568188209, "last_edit_date": 1568191341, "question_id": 57884480, "link": "https://stackoverflow.com/questions/57884480/transferring-each-column-to-one-worksheet-and-then-further-from-another-sheet-in", "title": "Transferring each column to one worksheet and then further from another sheet in same workbook", "body": "<p>I am using a macro which creates different worksheets on the basis of a data in column of first worksheet. This works absolutely fine as in Image 1.\n<a href=\"https://i.stack.imgur.com/95o4B.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/95o4B.png\" alt=\"enter image description here\"></a></p>\n\n<p>So running the existing macro creates different sheets from 1st sheet called Scan.\nNext I would like to create separate sheets in same way from sheet named STAFF in the same workbook using column E. \n<a href=\"https://i.stack.imgur.com/5w4i4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5w4i4.png\" alt=\"enter image description here\"></a></p>\n\n<p>The code I am using currently is </p>\n\n<pre><code>Sub parse_data()\n    Dim lr As Long\n    Dim ws As Worksheet\n    Dim vcol, i As Integer\n    Dim icol As Long\n    Dim myarr As Variant\n    Dim title As String\n    Dim titlerow As Integer\n\n    Application.ScreenUpdating = False\n    vcol = 4\n    Set ws = Sheets(\"Scan\")\n    lr = ws.Cells(ws.Rows.Count, vcol).End(xlUp).Row\n    title = \"A1:F1\"\n    titlerow = ws.Range(title).Cells(1).Row\n    icol = ws.Columns.Count\n    ws.Cells(1, icol) = \"Unique\"\n\n    For i = 2 To lr\n        On Error Resume Next\n        If ws.Cells(i, vcol) &lt;&gt; \"\" And Application.WorksheetFunction.Match(ws.Cells(i, vcol), ws.Columns(icol), 0) = 0 Then\n            ws.Cells(ws.Rows.Count, icol).End(xlUp).Offset(1) = ws.Cells(i, vcol)\n        End If\n    Next\n\n    myarr = Application.WorksheetFunction.Transpose(ws.Columns(icol).SpecialCells(xlCellTypeConstants))\n    ws.Columns(icol).Clear\n\n    For i = 2 To UBound(myarr)\n        ws.Range(title).AutoFilter field:=vcol, Criteria1:=myarr(i) &amp; \"\"\n        If Not Evaluate(\"=ISREF('\" &amp; myarr(i) &amp; \"'!A1)\") Then\n            Sheets.Add(after:=Worksheets(Worksheets.Count)).Name = myarr(i) &amp; \"\"\n        Else\n            Sheets(myarr(i) &amp; \"\").Move after:=Worksheets(Worksheets.Count)\n        End If\n        ws.Range(\"A\" &amp; titlerow &amp; \":A\" &amp; lr).EntireRow.Copy Sheets(myarr(i) &amp; \"\").Range(\"A1\")\n        Sheets(myarr(i) &amp; \"\").Columns.AutoFit\n    Next\n\n    ws.AutoFilterMode = False\n    ws.Activate\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>I would really appreciate any help with above.</p>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1568190632, "post_id": 57883920, "comment_id": 102192614, "body": "Add <code>Option Explicit</code> at top of your module and try to compile. (You should <b>NEVER</b> work without <code>Option Explicit</code> )"}, {"owner": {"reputation": 180, "user_id": 11924880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0be9ba7b62c9993a37d6ff2eeb5297cd?s=128&d=identicon&r=PG&f=1", "display_name": "cd-6", "link": "https://stackoverflow.com/users/11924880/cd-6"}, "reply_to_user": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 1, "creation_date": 1568190975, "post_id": 57883920, "comment_id": 102192774, "body": "Hey @PatrickHonorez I do have it at the top just copied it from Sub()."}], "answers": [{"comments": [{"owner": {"reputation": 180, "user_id": 11924880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0be9ba7b62c9993a37d6ff2eeb5297cd?s=128&d=identicon&r=PG&f=1", "display_name": "cd-6", "link": "https://stackoverflow.com/users/11924880/cd-6"}, "edited": false, "score": 0, "creation_date": 1568189086, "post_id": 57884348, "comment_id": 102191779, "body": "It just provides the MsgBox of &#39;Done&#39; if I put the rngSearch inside the loop"}, {"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "reply_to_user": {"reputation": 180, "user_id": 11924880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0be9ba7b62c9993a37d6ff2eeb5297cd?s=128&d=identicon&r=PG&f=1", "display_name": "cd-6", "link": "https://stackoverflow.com/users/11924880/cd-6"}, "edited": false, "score": 0, "creation_date": 1568189388, "post_id": 57884348, "comment_id": 102191931, "body": "rngSearch is moving with the loop. Msgbox is popping up because code ends his work. How can I help You? What is wrong with code? What is not working?"}, {"owner": {"reputation": 180, "user_id": 11924880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0be9ba7b62c9993a37d6ff2eeb5297cd?s=128&d=identicon&r=PG&f=1", "display_name": "cd-6", "link": "https://stackoverflow.com/users/11924880/cd-6"}, "edited": false, "score": 0, "creation_date": 1568189682, "post_id": 57884348, "comment_id": 102192088, "body": "Its not copying any of the cells across into the other sheet if they don&#39;t match."}, {"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "reply_to_user": {"reputation": 180, "user_id": 11924880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0be9ba7b62c9993a37d6ff2eeb5297cd?s=128&d=identicon&r=PG&f=1", "display_name": "cd-6", "link": "https://stackoverflow.com/users/11924880/cd-6"}, "edited": false, "score": 0, "creation_date": 1568190571, "post_id": 57884348, "comment_id": 102192579, "body": "Ok, try now, I edited those loops adding to cells connection to &#39;s&#39; sheet"}, {"owner": {"reputation": 180, "user_id": 11924880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0be9ba7b62c9993a37d6ff2eeb5297cd?s=128&d=identicon&r=PG&f=1", "display_name": "cd-6", "link": "https://stackoverflow.com/users/11924880/cd-6"}, "edited": false, "score": 0, "creation_date": 1568190923, "post_id": 57884348, "comment_id": 102192746, "body": "It didn&#39;t really work. The original code worked at finding values that didn&#39;t match when comparing the Unique ID in column B and comparing it to the range the problem is moving the range it is looking it. The range only stays in the first 6 columns but it needs to step as well"}, {"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "reply_to_user": {"reputation": 180, "user_id": 11924880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0be9ba7b62c9993a37d6ff2eeb5297cd?s=128&d=identicon&r=PG&f=1", "display_name": "cd-6", "link": "https://stackoverflow.com/users/11924880/cd-6"}, "edited": false, "score": 0, "creation_date": 1568191250, "post_id": 57884348, "comment_id": 102192910, "body": "Range You copy or range you are searching?"}, {"owner": {"reputation": 180, "user_id": 11924880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0be9ba7b62c9993a37d6ff2eeb5297cd?s=128&d=identicon&r=PG&f=1", "display_name": "cd-6", "link": "https://stackoverflow.com/users/11924880/cd-6"}, "edited": false, "score": 0, "creation_date": 1568191603, "post_id": 57884348, "comment_id": 102193084, "body": "Its the range I am searching. After it finishes looping the first 6 columns it moves over to the next 6 columns successfully, but then it starts copying all of the values to the new sheet because it must be comparing it to the old column still."}, {"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "reply_to_user": {"reputation": 180, "user_id": 11924880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0be9ba7b62c9993a37d6ff2eeb5297cd?s=128&d=identicon&r=PG&f=1", "display_name": "cd-6", "link": "https://stackoverflow.com/users/11924880/cd-6"}, "edited": false, "score": 0, "creation_date": 1568191780, "post_id": 57884348, "comment_id": 102193173, "body": "Your code is not copying after moving over 6 columns. Your code is copying values row after row if it met condition. I don&#39;t get your point."}, {"owner": {"reputation": 180, "user_id": 11924880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0be9ba7b62c9993a37d6ff2eeb5297cd?s=128&d=identicon&r=PG&f=1", "display_name": "cd-6", "link": "https://stackoverflow.com/users/11924880/cd-6"}, "edited": false, "score": 0, "creation_date": 1568191931, "post_id": 57884348, "comment_id": 102193240, "body": "My code looks at a cell value and then see&#39;s whether it exists in any of the 5 cells to the right in the same row. If that cell value does exist in the range it moves on, if it doesn&#39;t it copies that range of 6 cells into a new sheet.   The problem is after finishing looking in the first block of 6 columns it doesn&#39;t start looking for the new cell value which would be 6 columns to the right, it still looks in the first column"}, {"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "reply_to_user": {"reputation": 180, "user_id": 11924880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0be9ba7b62c9993a37d6ff2eeb5297cd?s=128&d=identicon&r=PG&f=1", "display_name": "cd-6", "link": "https://stackoverflow.com/users/11924880/cd-6"}, "edited": false, "score": 0, "creation_date": 1568192611, "post_id": 57884348, "comment_id": 102193584, "body": "Edited again post. Set rngSearch = .Range(.Cells(i, j), .Cells(i, j+5)) &lt;--- this is moving in loop, 6 columns to the right every &#39;j&#39; loop. Now, have you tried putting my loops into your code?"}, {"owner": {"reputation": 180, "user_id": 11924880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0be9ba7b62c9993a37d6ff2eeb5297cd?s=128&d=identicon&r=PG&f=1", "display_name": "cd-6", "link": "https://stackoverflow.com/users/11924880/cd-6"}, "edited": false, "score": 0, "creation_date": 1568193296, "post_id": 57884348, "comment_id": 102193963, "body": "Thanks for your help but that didn&#39;t work either. I&#39;ve tried all of your suggestions but it&#39;s not exactly helping. I think its the uniqueID variable which needs to move across also"}, {"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "reply_to_user": {"reputation": 180, "user_id": 11924880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0be9ba7b62c9993a37d6ff2eeb5297cd?s=128&d=identicon&r=PG&f=1", "display_name": "cd-6", "link": "https://stackoverflow.com/users/11924880/cd-6"}, "edited": false, "score": 0, "creation_date": 1568193589, "post_id": 57884348, "comment_id": 102194078, "body": "But uniqueId = .Cells(i, 2 + j - 1).Value is also moving. &#39;j&#39; at first iteration is 1, 2nd 1+6, 3rd 1+6+6. So uniqueId (column index) --&gt; 2, 8, 14 etc"}], "tags": [], "owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "is_accepted": false, "score": 0, "last_activity_date": 1568192525, "last_edit_date": 1568192525, "creation_date": 1568187637, "answer_id": 57884348, "question_id": 57883920, "link": "https://stackoverflow.com/questions/57883920/how-to-get-variable-to-move-with-loop-function-excel/57884348#57884348", "title": "How to get variable to move with loop function excel?", "body": "<p>I think your rngSeachOne is declared as the rngSearch should, but put that inside loop.</p>\n\n<pre><code>Set rngSearch = s.Range(s.Cells(i, j), s.Cells(i, j+5))\n</code></pre>\n\n<p>If I think good that loops should look like:</p>\n\n<pre><code>Set s = thisworkbook.Sheets(\"Data\")\nWith s\n    For j = 1 To finalcolumn Step 6\n        For i = 2 To finalrow\n            uniqueId = .Cells(i, 2 + j - 1).Value\n\n            Set rngSearch = .Range(.Cells(i, j), .Cells(i, j+5))\n\n            Set rngFound = rngSearch.Find(What:=uniqueId, LookIn:=xlValues, LookAt:=xlWhole)\n                If rngFound Is Nothing Then\n                    .Range(.Cells(i, 1 + j - 1), .Cells(i, 6 + j - 1)).Copy\n                    Sheets(\"DataValidation\").Range(\"A1048575\").End(xlUp). _\n                                   offset(1, 0).PasteSpecial xlPasteFormulasAndNumberFormats\n                End If\n        Next i\n    Next j\nEnd with\n</code></pre>\n"}], "owner": {"reputation": 180, "user_id": 11924880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0be9ba7b62c9993a37d6ff2eeb5297cd?s=128&d=identicon&r=PG&f=1", "display_name": "cd-6", "link": "https://stackoverflow.com/users/11924880/cd-6"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568192525, "creation_date": 1568185932, "question_id": 57883920, "link": "https://stackoverflow.com/questions/57883920/how-to-get-variable-to-move-with-loop-function-excel", "title": "How to get variable to move with loop function excel?", "body": "<p>I have a loop which moves down rows and then moves over columns. It compares Column A,B,C with D,E,F for any differences, if there are it copies it to a new sheet. </p>\n\n<p>The loop works with moving across columns as the finalrow variable is reached but I am having difficulty setting up the rngSearch variable to move with the loop, </p>\n\n<pre><code>Sub finddata()\n\nDim s As Worksheet\nDim uniqueId As String\nDim finalrow As Long\nDim i As Long\nDim j As Long\nDim rngSearch As Range\nDim rngFound As Range\nDim finalcolumn As Long\n'Dim rngSearchOne As Range\n\nApplication.ScreenUpdating = True\n\nuniqueId = Sheets(\"Data\").Range(\"B2\").Value\nfinalrow = Sheets(\"Data\").Range(\"G100000\").End(xlUp).Row\nfinalcolumn = Sheets(\"Data\").Range(\"XFD1\").End(xlToLeft).Column\n\nSet s = Sheets(\"Data\")\nSet rngSearch = s.Range(s.Cells(2, 5), s.Cells(finalrow, 5))\nSet rngSearchOne = s.Range(s.Cells(i, j), s.Cells(finalrow, finalcolumn))\n\n\nFor j = 1 To finalcolumn Step 6\n    For i = 2 To finalrow\n        uniqueId = s.Cells(i, 2 + j - 1).Value\n        Set rngFound = rngSearch.Find(What:=uniqueId, LookIn:=xlValues, LookAt:=xlWhole)\n            If rngFound Is Nothing Then\n                s.Range(Cells(i, 1 + j - 1), Cells(i, 6 + j - 1)).Copy\n                Sheets(\"DataValidation\").Range(\"A1048575\").End(xlUp). _\n                               offset(1, 0).PasteSpecial xlPasteFormulasAndNumberFormats\n            End If\n    Next i\nNext j\n\n\nMsgBox \"Done\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "range"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1568184651, "post_id": 57883532, "comment_id": 102189687, "body": "You might want to prefix all calls to <code>Range</code> with <code>ws.</code>. And you are missing a <code>Set</code>: <code>Set rng = ... </code>"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1568184774, "post_id": 57883532, "comment_id": 102189743, "body": "BTW, avoid using <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">Select</a> Here they aren&#39;t even useful."}, {"owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 0, "creation_date": 1568184841, "post_id": 57883532, "comment_id": 102189775, "body": "You could use: Range(&quot;$A$1&quot;).CurrentRegion instead of rng in ListObjects.add"}, {"owner": {"reputation": 2714, "user_id": 843458, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/e600bfa3509ddea2d693514cbe11bbdb?s=128&d=identicon&r=PG", "display_name": "Matthias Pospiech", "link": "https://stackoverflow.com/users/843458/matthias-pospiech"}, "edited": false, "score": 0, "creation_date": 1568186332, "post_id": 57883532, "comment_id": 102190452, "body": "Select is only for debugging. I do not intend to use it."}, {"owner": {"reputation": 2714, "user_id": 843458, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/e600bfa3509ddea2d693514cbe11bbdb?s=128&d=identicon&r=PG", "display_name": "Matthias Pospiech", "link": "https://stackoverflow.com/users/843458/matthias-pospiech"}, "edited": false, "score": 0, "creation_date": 1568186620, "post_id": 57883532, "comment_id": 102190587, "body": "I updated the code but it still fails.@EvR: How reliable is CurrentRegion ?"}, {"owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 0, "creation_date": 1568191832, "post_id": 57883532, "comment_id": 102193193, "body": "Code below as answer, works on my system. As long there&#39;s an empty column right and a empty row under your range for your Table, currentregion will work"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1568193850, "post_id": 57883532, "comment_id": 102194215, "body": "<code>rngCol</code> and  <code>rngRow</code> are two diagonally opposed corners of your range, you can just use <code>Set rng = ws.Range(rngCol, rngRow)</code> to define the final range."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1568193959, "post_id": 57883532, "comment_id": 102194258, "body": "and your code failed because it&#39;s either <code>ws.Range(rngRow, rngCol)</code> or <code>ws.Cells(rngRow.Row, rngCol.Column)</code>. Range takes Ranges as argument, while Cells takes indexes."}], "answers": [{"tags": [], "owner": {"reputation": 752, "user_id": 9538700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf60807a4c8210fb503d2f875a3299cd?s=128&d=identicon&r=PG", "display_name": "horst", "link": "https://stackoverflow.com/users/9538700/horst"}, "is_accepted": false, "score": 1, "last_activity_date": 1568188510, "creation_date": 1568188510, "answer_id": 57884572, "question_id": 57883532, "link": "https://stackoverflow.com/questions/57883532/vba-select-range-for-table/57884572#57884572", "title": "vba select range for table", "body": "<pre><code>Set rng = ws.Range(ws.Range(\"A1\"), ws.Range(rngRow.Column, rngCol.row))\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>Set rng = ws.Range(ws.Range(\"A1\"), ws.Cells(rngCol.row, rngRow.Column))\n</code></pre>\n\n<p>or simply</p>\n\n<pre><code>Set rng = ws.Range(ws.Range(\"A1\"), ws.Range(rngCol, rngRow))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "is_accepted": true, "score": 1, "last_activity_date": 1568191705, "creation_date": 1568191705, "answer_id": 57885426, "question_id": 57883532, "link": "https://stackoverflow.com/questions/57883532/vba-select-range-for-table/57885426#57885426", "title": "vba select range for table", "body": "<p>Try:(as long Tabelle1 doesnot excist)</p>\n\n<pre><code>Dim ws As Worksheet\n    Set ws = ThisWorkbook.Sheets(outsheet)\n    ws.ListObjects.Add(xlSrcRange, Range(\"$A$1\").CurrentRegion, , xlYes).Name = \"Tabelle1\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "is_accepted": false, "score": 0, "last_activity_date": 1568211293, "creation_date": 1568211293, "answer_id": 57891137, "question_id": 57883532, "link": "https://stackoverflow.com/questions/57883532/vba-select-range-for-table/57891137#57891137", "title": "vba select range for table", "body": "<p>Why not use <code>UsedRange</code>?</p>\n\n<pre><code>Sub rangeselect()\n\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Sheets(\"sheet1\")\n\n    Dim rng As Range\n    Set rng = ws.UsedRange\n    rng.Select\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2714, "user_id": 843458, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/e600bfa3509ddea2d693514cbe11bbdb?s=128&d=identicon&r=PG", "display_name": "Matthias Pospiech", "link": "https://stackoverflow.com/users/843458/matthias-pospiech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 57885426, "answer_count": 3, "score": 2, "last_activity_date": 1568213536, "creation_date": 1568184415, "last_edit_date": 1568213536, "question_id": 57883532, "link": "https://stackoverflow.com/questions/57883532/vba-select-range-for-table", "title": "vba select range for table", "body": "<p>I want to select the range for a table.\nFor this, I am looking at the last row and column and want to select everything from the first cell to the combination row and column.</p>\n\n<pre><code>    Set ws = ThisWorkbook.Sheets(outsheet)\n    Dim rngRow As Range\n\n    Set rngRow = ws.Range(\"A1\").End(xlToRight)\n    rngRow.Select\n\n    Dim rngCol As Range\n    Set rngCol = ws.Range(\"A1\").End(xlDown)\n    rngCol.Select\n\n    Dim rng As Range\n    Set rng = ws.Range(ws.Range(\"A1\"), ws.Range(rngRow.Column, rngCol.row))\n</code></pre>\n\n<p>However, the code fails in the last line with \"range failed\".\nWhat is wrong, or is there a better approach?</p>\n\n<p>After this, I want to call </p>\n\n<pre><code>    ws.ListObjects.Add(xlSrcRange, rng, , xlYes).Name = \"Tabelle1\"\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1568185161, "post_id": 57883497, "comment_id": 102189928, "body": "What do you mean with selected ones? Actual selected column on the sheet? Or are they always the same? If the latter, pls tell us which columns need to stay visible."}, {"owner": {"reputation": 1168, "user_id": 9235421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afc6f04ea4fa5b8303e2e3897ac1d0ef?s=128&d=identicon&r=PG&f=1", "display_name": "Zababa", "link": "https://stackoverflow.com/users/9235421/zababa"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1568185265, "post_id": 57883497, "comment_id": 102189986, "body": "They are not selected in the literal sense. I mean chosen ones. There is no active selection in the sheet. I want to hide everything except, say columns named &quot;Email&quot;, &quot;User&quot;, &quot;Country&quot;, etc."}], "answers": [{"comments": [{"owner": {"reputation": 1168, "user_id": 9235421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afc6f04ea4fa5b8303e2e3897ac1d0ef?s=128&d=identicon&r=PG&f=1", "display_name": "Zababa", "link": "https://stackoverflow.com/users/9235421/zababa"}, "edited": false, "score": 0, "creation_date": 1568187203, "post_id": 57883854, "comment_id": 102190857, "body": "I don&#39;t like this solution much because here you use again some absolute column letters (&quot;A:BB&quot;) which was exactly what I&#39;m trying to avoid. As mentioned, column in the tabe come and go, or get rearranged."}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "reply_to_user": {"reputation": 1168, "user_id": 9235421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afc6f04ea4fa5b8303e2e3897ac1d0ef?s=128&d=identicon&r=PG&f=1", "display_name": "Zababa", "link": "https://stackoverflow.com/users/9235421/zababa"}, "edited": false, "score": 0, "creation_date": 1568187391, "post_id": 57883854, "comment_id": 102190945, "body": "I was afraid you would say that. Therefore @JvdV solution is much more elegant. Mine could be updated to hide everything, but it would need a bunch of nested <code>if</code> statements to unhide the ones you want. I&#39;ll update my answer but I&#39;ll admit it is inferior."}], "tags": [], "owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "is_accepted": false, "score": 0, "last_activity_date": 1568188754, "last_edit_date": 1568188754, "creation_date": 1568185729, "answer_id": 57883854, "question_id": 57883497, "link": "https://stackoverflow.com/questions/57883497/hide-all-columns-in-an-excel-table-except-a-few-chosen-ones/57883854#57883854", "title": "Hide all columns in an Excel table except a few chosen ones", "body": "<p>The required can be done easily with the following loop:</p>\n\n<pre><code>Sub hide()\nSub hide()\nDim column As Range\nDim Lastcolumn As Long\nLastcolumn = ActiveSheet.Cells(1, Columns.Count).End(xlToLeft).column\nFor Each column In ActiveSheet.Range(ActiveSheet.Cells(1, 1), ActiveSheet.Cells(1, Lastcolumn))\nIf column = \"Unhide\" Or column = \"Unhide also\" Then\ncolumn.EntireColumn.Hidden = False\nElse\ncolumn.EntireColumn.Hidden = True\nEnd If\nNext\nEnd Sub\n</code></pre>\n\n<p>For every column you would like not to be hidden you add another <code>or</code> statement with an updated name.</p>\n\n<p><em>Edited to negate the use of absolute columns and just use used range of columns instead.</em></p>\n"}, {"tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 1, "last_activity_date": 1568186111, "creation_date": 1568186111, "answer_id": 57883964, "question_id": 57883497, "link": "https://stackoverflow.com/questions/57883497/hide-all-columns-in-an-excel-table-except-a-few-chosen-ones/57883964#57883964", "title": "Hide all columns in an Excel table except a few chosen ones", "body": "<p>So based on your edited question I think you looking for:</p>\n\n<pre><code>Sub Check()\n\nWith ThisWorkbook.Sheets(\"Sheet1\") 'Change accordingly\n    .Range(\"myTable\").EntireColumn.Hidden = True\n    .Range(\"myTable[Email]\").EntireColumn.Hidden = False\n    .Range(\"myTable[User]\").EntireColumn.Hidden = False\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1168, "user_id": 9235421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afc6f04ea4fa5b8303e2e3897ac1d0ef?s=128&d=identicon&r=PG&f=1", "display_name": "Zababa", "link": "https://stackoverflow.com/users/9235421/zababa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 539, "favorite_count": 0, "accepted_answer_id": 57883964, "answer_count": 2, "score": 0, "last_activity_date": 1568188754, "creation_date": 1568184281, "last_edit_date": 1568186286, "question_id": 57883497, "link": "https://stackoverflow.com/questions/57883497/hide-all-columns-in-an-excel-table-except-a-few-chosen-ones", "title": "Hide all columns in an Excel table except a few chosen ones", "body": "<p>I have an Excel table <code>ActiveSheet.ListObjects(\"myTable\")</code>. How can I hide all its columns except for the more interesting ones? Curretly my code was generated by recording a macro:</p>\n\n<pre><code>Columns(\"A:C\").Hidden = True\nColumns(\"F:G\").Hidden = True\nColumns(\"I:U\").Hidden = True\nColumns(\"W:X\").Hidden = True\nColumns(\"AA:AI\").Hidden = True\nColumns(\"AK:CQ\").Hidden = True\n</code></pre>\n\n<p>Because the less important columns come and go or get rearranged, I'd like to refer to the columns by name rather than column letter. Something along the lines of:</p>\n\n<pre><code>ActiveSheet.ListObjects(\"myTable\").ListColumns(\"#All\").Hidden = True\nActiveSheet.ListObjects(\"myTable\").ListColumns(\"Email\").Hidden = False\nActiveSheet.ListObjects(\"myTable\").ListColumns(\"User\").Hidden = False\n...\n</code></pre>\n"}, {"tags": ["excel", "vba", "selenium", "selenium-webdriver", "csrf"], "comments": [{"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1568192074, "post_id": 57882859, "comment_id": 102193314, "body": "Please... Any code?"}, {"owner": {"reputation": 1, "user_id": 12051171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99bddbe4f731f5d200dd3b711c3883ff?s=128&d=identicon&r=PG&f=1", "display_name": "David Victor", "link": "https://stackoverflow.com/users/12051171/david-victor"}, "reply_to_user": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1568228008, "post_id": 57882859, "comment_id": 102211698, "body": "I added the code."}], "answers": [{"tags": [], "owner": {"reputation": 116545, "user_id": 7429447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5a25589e600c8ae89717c14e51a6754b?s=128&d=identicon&r=PG&f=1", "display_name": "DebanjanB", "link": "https://stackoverflow.com/users/7429447/debanjanb"}, "is_accepted": false, "score": 0, "last_activity_date": 1568194773, "creation_date": 1568194773, "answer_id": 57886261, "question_id": 57882859, "link": "https://stackoverflow.com/questions/57882859/the-action-you-have-requested-is-not-allowed-error-when-clicking-on-the-connec/57886261#57886261", "title": "&quot;The action you have requested is not allowed&quot; error when clicking on the Connect button using Selenium through VBA", "body": "<p>This error message...</p>\n\n<pre><code>The action you have requested is not allowed.\n</code></pre>\n\n<p>...is the result of a <a href=\"https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)\" rel=\"nofollow noreferrer\">Cross-Site Request Forgery (CSRF)</a> error.</p>\n\n<p>A bit more about the relevant <a href=\"https://www.w3schools.com/js/js_htmldom.asp\" rel=\"nofollow noreferrer\">HTML DOM</a> and your code trials would have helped us to debug the issue in a better way. However, this error is mainly observed when an end user forcefully executes unwanted actions on a web application in which they're currently authenticated. CSRF attacks specifically target state-changing requests, not theft of data, since the attacker has no way to see the response to the forged request.</p>\n\n<p>However, this issue can occur in either of the following cases:</p>\n\n<ul>\n<li><p>The config file of the <em>Application Server</em> (config.php) contains the following:</p>\n\n<pre><code>$config['csrf_protection'] = TRUE;\n</code></pre>\n\n<ul>\n<li><p>Solution would be to configure:</p>\n\n<pre><code>$config['csrf_protection'] = FALSE;\n</code></pre></li>\n</ul></li>\n<li><p>The config file of the <em>Application Server</em> contains the following when using HTTP:</p>\n\n<pre><code>$config['cookie_secure'] = TRUE;\n</code></pre>\n\n<ul>\n<li><p>Solution would be to configure:</p>\n\n<pre><code>$config['cookie_secure'] = FALSE;\n</code></pre></li>\n</ul></li>\n<li><p>Another approach would be to whitelist the URI as explained in <a href=\"https://codeigniter.com/user_guide/libraries/security.html#cross-site-request-forgery-csrf\" rel=\"nofollow noreferrer\">CSRF User Guide</a>:</p>\n\n<pre><code>$config['csrf_exclude_uris'] = array('api/person/add');\n</code></pre></li>\n</ul>\n\n<p>Finally, as a thumb rule whenever you intend to invoke <code>click()</code> always induce a <em>waiter</em> for the <em>elementToBeClickable</em></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12051171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99bddbe4f731f5d200dd3b711c3883ff?s=128&d=identicon&r=PG&f=1", "display_name": "David Victor", "link": "https://stackoverflow.com/users/12051171/david-victor"}, "is_accepted": false, "score": 0, "last_activity_date": 1568227880, "creation_date": 1568227880, "answer_id": 57895204, "question_id": 57882859, "link": "https://stackoverflow.com/questions/57882859/the-action-you-have-requested-is-not-allowed-error-when-clicking-on-the-connec/57895204#57895204", "title": "&quot;The action you have requested is not allowed&quot; error when clicking on the Connect button using Selenium through VBA", "body": "<p>Thank you for your response.\nThis is the code:</p>\n\n<p>Sub eoriginal_macro()</p>\n\n<p>Dim bot As New WebDriver, myproducts As WebElements, posts As WebElements, myproduct As WebElement, post As WebElement, i As Integer, productnum As String, clicknum As Integer, mysheet As Worksheet</p>\n\n<p>bot.Start \"chrome\", \"<a href=\"https://eoriginal.ro\" rel=\"nofollow noreferrer\">https://eoriginal.ro</a>\"\nbot.Window.Maximize</p>\n\n<p>bot.Get \"/login\"\nbot.Wait 6000</p>\n\n<p>bot.FindElementByName(\"username\").SendKeys (\"username\")\nbot.FindElementByName(\"password\").SendKeys (\"password\")</p>\n\n<p>bot.Wait 2000</p>\n\n<p>Set posts = bot.FindElementsByName(\"username\")</p>\n\n<pre><code>For Each post In posts\n\npost.FindElementByXPath(\"//button[contains(@class,'btn-primary')]\").Click\n\nNext\n</code></pre>\n\n<p>MsgBox \"complete\"</p>\n\n<p>bot.Quit</p>\n\n<p>End Sub</p>\n\n<p>The buton is clickable fromthe beginning.</p>\n"}], "owner": {"reputation": 1, "user_id": 12051171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99bddbe4f731f5d200dd3b711c3883ff?s=128&d=identicon&r=PG&f=1", "display_name": "David Victor", "link": "https://stackoverflow.com/users/12051171/david-victor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1568227880, "creation_date": 1568180892, "last_edit_date": 1568194724, "question_id": 57882859, "link": "https://stackoverflow.com/questions/57882859/the-action-you-have-requested-is-not-allowed-error-when-clicking-on-the-connec", "title": "&quot;The action you have requested is not allowed&quot; error when clicking on the Connect button using Selenium through VBA", "body": "<p>I automated a login access to a site, with Selenium in Excel vba, and after i successfully fill the <em>username</em> and the <em>password</em>, when i click  on <em>Connect</em> button the page is sending this error: \"the action you have requested is not allowed\". </p>\n\n<p>Is there a way to eliminate this error ?</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568188968, "post_id": 57882397, "comment_id": 102191721, "body": "With <code>Set objTable = objDoc.Tables(1)</code> you are not creating a new table. You are working with an existing one.  To add tables you will have to use <code>.Tables.Add</code>. Do a research on Google on how to add a table in word vba and then use that code in Excel with relevant modifications"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568189098, "post_id": 57882397, "comment_id": 102191791, "body": "Here is one <a href=\"https://excel-macro.tutorialhorizon.com/vba-excel-add-table-and-fill-data-to-the-word-document/\" rel=\"nofollow noreferrer\">example</a>"}, {"owner": {"reputation": 1, "user_id": 12051055, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDUIBZUdUyGRCdR1y24Q2P352ckCriQjM4D86ChBA=k-s128", "display_name": "VIRENDRAPAL SINGH SISODIA", "link": "https://stackoverflow.com/users/12051055/virendrapal-singh-sisodia"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568192630, "post_id": 57882397, "comment_id": 102193599, "body": "I have done in the same way which you have provided in the example. But it is values are getting overridden in same table."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568197289, "post_id": 57882397, "comment_id": 102195963, "body": "What you are doing is adding the table outside the loop. Add the table inside the loop and then work with that. Also instead of <code>objDoc.Tables.Add objRange, intNoOfRows, intNoOfColumns</code> use <code>Set objTable = objDoc.Tables.Add(ObjRange, intRows, intColumns)</code> And then work with the <code>objTable</code> :)"}, {"owner": {"reputation": 1, "user_id": 12051055, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDUIBZUdUyGRCdR1y24Q2P352ckCriQjM4D86ChBA=k-s128", "display_name": "VIRENDRAPAL SINGH SISODIA", "link": "https://stackoverflow.com/users/12051055/virendrapal-singh-sisodia"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568197828, "post_id": 57882397, "comment_id": 102196223, "body": "Code is working and 2 tables are created but second table is created withing the first one. Any specific function to break the line and create new table in new line?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568198191, "post_id": 57882397, "comment_id": 102196406, "body": "<b>[Hint]</b> That is happening because of <code>ObjRange</code> in <code>Set objTable = objDoc.Tables.Add(ObjRange, intRows, intColumns)</code> Give it a try and we will take it from there..."}, {"owner": {"reputation": 1, "user_id": 12051055, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDUIBZUdUyGRCdR1y24Q2P352ckCriQjM4D86ChBA=k-s128", "display_name": "VIRENDRAPAL SINGH SISODIA", "link": "https://stackoverflow.com/users/12051055/virendrapal-singh-sisodia"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568199748, "post_id": 57882397, "comment_id": 102197213, "body": "Bro, I tried ObjRange.Move to move cursor to next line but isn&#39;t working. Please help."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568200720, "post_id": 57882397, "comment_id": 102197701, "body": "I can give you the code in one go but that will not help you learn. Do a search in Google on how to insert a table after a table."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568200748, "post_id": 57882397, "comment_id": 102197718, "body": "Try something like <code>vba insert paragraph after table in word</code> in Google."}, {"owner": {"reputation": 1, "user_id": 12051055, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDUIBZUdUyGRCdR1y24Q2P352ckCriQjM4D86ChBA=k-s128", "display_name": "VIRENDRAPAL SINGH SISODIA", "link": "https://stackoverflow.com/users/12051055/virendrapal-singh-sisodia"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568204743, "post_id": 57882397, "comment_id": 102199835, "body": "No luck buddy......tried many times but not able to do."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568209086, "post_id": 57882397, "comment_id": 102202410, "body": "After the table is created inside the loop, insert a para <code>objDoc.Range.InsertParagraphAfter</code>  and then reset the selection <code>Set ObjRange = objDoc.Range(objDoc.Content.End - 1)</code>. These 2 lines will go before <code>Wend</code>"}, {"owner": {"reputation": 1, "user_id": 12051055, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDUIBZUdUyGRCdR1y24Q2P352ckCriQjM4D86ChBA=k-s128", "display_name": "VIRENDRAPAL SINGH SISODIA", "link": "https://stackoverflow.com/users/12051055/virendrapal-singh-sisodia"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568263887, "post_id": 57882397, "comment_id": 102220470, "body": "Thanks a lot buddy.....it was really helpful guiding through. Again thank you very much."}, {"owner": {"reputation": 1, "user_id": 12051055, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDUIBZUdUyGRCdR1y24Q2P352ckCriQjM4D86ChBA=k-s128", "display_name": "VIRENDRAPAL SINGH SISODIA", "link": "https://stackoverflow.com/users/12051055/virendrapal-singh-sisodia"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568631966, "post_id": 57882397, "comment_id": 102323008, "body": "Hi Sid, I am trying to save a word document through excel VBA but it is asking to select the classifier. Can we select the classifier before save it or we can force save without selecting classifier."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568633852, "post_id": 57882397, "comment_id": 102323910, "body": "<code>select the classifier</code> Sorry I do not understand..."}, {"owner": {"reputation": 1, "user_id": 12051055, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDUIBZUdUyGRCdR1y24Q2P352ckCriQjM4D86ChBA=k-s128", "display_name": "VIRENDRAPAL SINGH SISODIA", "link": "https://stackoverflow.com/users/12051055/virendrapal-singh-sisodia"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568636005, "post_id": 57882397, "comment_id": 102325065, "body": "There are some document classifier like Public, Internal, Confidential and External etc. Before saving the doc we need to choose that for each file that what kind of file is this, public, internal or any other like that."}], "owner": {"reputation": 1, "user_id": 12051055, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDUIBZUdUyGRCdR1y24Q2P352ckCriQjM4D86ChBA=k-s128", "display_name": "VIRENDRAPAL SINGH SISODIA", "link": "https://stackoverflow.com/users/12051055/virendrapal-singh-sisodia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568225074, "creation_date": 1568178072, "last_edit_date": 1568225074, "question_id": 57882397, "link": "https://stackoverflow.com/questions/57882397/need-to-add-multiple-table-to-word-document", "title": "Need to add multiple table to word document", "body": "<p>I need to add multiple table from the excel macros to a word document.</p>\n\n<p>I have tries it with the object <code>Set objTable = objDoc.Tables(1)</code> via loop but it is overriding the content of existing table with new data.</p>\n\n<pre><code>Sub btnrun_Click()\n    Dim objWord As Object\n    Dim objDoc As Object\n    Dim ObjSelection\n    Dim ObjRange\n    Dim objTable\n    Dim intRows, intColumns, defVal, x\n    Dim y As Integer\n\n    Set objWord = CreateObject(\"Word.Application\")\n    Set objDoc = objWord.Documents.Add\n    objWord.Visible = True\n    Set ObjSelection = objWord.Selection\n\n    intRows = 8\n    intColumns = 2\n    defVal = 7\n    x = 8\n    y = 1\n\n    Set ObjRange = ObjSelection.Range\n    objDoc.Tables.Add ObjRange, intRows, intColumns\n\n    While (Not IsEmpty(Worksheets(\"Sheet1\").Range(\"A\" &amp; x)))\n        Set objTable = objDoc.Tables(1)\n        objTable.Borders.Enable = True\n        objTable.Columns(1).Width = 150\n        objTable.Columns(2).Width = 300\n\n    For i = 1 To 1\n        For j = 1 To 1\n            objTable.cell(j, i).Range.Text = Worksheets(\"Sheet1\").Range(\"A\" &amp; defVal)\n            objTable.cell(j, 2).Range.Text = Worksheets(\"Sheet1\").Range(\"A\" &amp; x)\n            objTable.cell(j + 1, i).Range.Text = Worksheets(\"Sheet1\").Range(\"B\" &amp; \n    defVal)\n            objTable.cell(j + 1, 2).Range.Text = Worksheets(\"Sheet1\").Range(\"B\" &amp; x)\n            objTable.cell(j + 5, i).Range.Text = \"Fircosoft UI\"\n            objTable.cell(j + 6, i).Range.Text = \"Cognos UI\"\n            objTable.cell(j + 7, i).Range.Text = \"Database Result\"\n        Next       \n    Next\n\n    x = x + 1                           \n    Wend\n\n    objDoc.SaveAs (\"D:\\PassLogs\")\n    objWord.Quit\n\n    Set objWord = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Currently the values are getting overridden but I want them to add in a new table every time.</p>\n"}, {"tags": ["excel", "vba", "outlook", "range"], "answers": [{"tags": [], "owner": {"reputation": 356, "user_id": 9635098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a781d7fd3cacab5fbc08554bc8dfb759?s=128&d=identicon&r=PG&f=1", "display_name": "Beek", "link": "https://stackoverflow.com/users/9635098/beek"}, "is_accepted": false, "score": 0, "last_activity_date": 1568190850, "last_edit_date": 1568190850, "creation_date": 1568190468, "answer_id": 57885097, "question_id": 57881972, "link": "https://stackoverflow.com/questions/57881972/paste-two-ranges-from-two-different-workbooks-into-an-outlook-mail-body/57885097#57885097", "title": "Paste two ranges from two different workbooks into an Outlook mail body", "body": "<p>The problem you're having comes from the fact that you close <code>wkb2</code> before you convert <code>rng2</code> to html. When you get to the <code>RangetoHTML(rng2)</code> line, <code>rng2</code> is no longer available, if <code>wkb2</code> is closed.</p>\n\n<p>So you should convert <code>rng2</code> to html and store it in a variable before you close <code>wkb2</code>. \nYou could do something like this:</p>\n\n<pre><code>    If rng2 Is Nothing Then\n        MsgBox \"The selection is not a range or the sheet is protected. \" &amp; _\n           vbNewLine &amp; \"Please correct and try again.\", vbOKOnly\n        wkb2.Close\n        Exit Sub\n    Else\n        Dim HtmlRng2 as string\n        HtmlRng2 = RangeToHtml(rng2)\n    End If\n</code></pre>\n\n<p>And you would change </p>\n\n<pre><code>.HTMLBody = StrBody1 &amp; RangetoHTML(rng) &amp; \" \" &amp; RangetoHTML(rng2) &amp; StrBody2\n</code></pre>\n\n<p>to</p>\n\n<pre><code>.HTMLBody = StrBody1 &amp; RangetoHTML(rng) &amp; \" \" &amp; HtmlRng2 &amp; StrBody2\n</code></pre>\n\n<p>Otherwise you would have to keep <code>wkb2</code> open until after you've filled your email <code>htmlbody</code> with the ranges.</p>\n"}], "owner": {"reputation": 21, "user_id": 10944221, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Wz9047-HgFI/AAAAAAAAAAI/AAAAAAAAACM/OAbAkxXr63I/photo.jpg?sz=128", "display_name": "sayan chakraborty", "link": "https://stackoverflow.com/users/10944221/sayan-chakraborty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 148, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1586740566, "creation_date": 1568174613, "last_edit_date": 1586740566, "question_id": 57881972, "link": "https://stackoverflow.com/questions/57881972/paste-two-ranges-from-two-different-workbooks-into-an-outlook-mail-body", "title": "Paste two ranges from two different workbooks into an Outlook mail body", "body": "<p>I have to paste two selected ranges, from two different workbooks into a mail body.</p>\n\n<p>The first workbook is the parent workbook where the macro is located. We select a range from there, the second workbook is opened via the macro and a range is selected.</p>\n\n<p>Both the ranges are to be pasted in Outlook mail body.</p>\n\n<p>I tried the below macro along with the rangetohtml function.</p>\n\n<pre><code>Sub Mail_Selection_Range_Outlook_Body()\n' You need to use this module with the RangetoHTML subroutine.\n' Works in Excel 2000, Excel 2002, Excel 2003, Excel 2007, Excel 2010, Outlook 2000, Outlook 2002, Outlook 2003, Outlook 2007, and Outlook 2010.\n    Dim rng As Range\n    Dim rng2 As Range\n    Dim OutApp As Object\n    Dim OutMail As Object\n\n    Set Parent_wkb = ThisWorkbook\n    cnt_row = Parent_wkb.Worksheets(\"1Summary - All\").Cells(Rows.Count, 1).End(xlUp).Row\n    cnt_col = Parent_wkb.Worksheets(\"1Summary - All\").Cells(3, Columns.Count).End(xlToLeft).Column\n    l1 = cnt_row + 7\n    last_box = cnt_col - 2\n    last_box_Ltr = Evaluate(\"substitute(address(1, \" &amp; last_box &amp; \", 4), \"\"1\"\", \"\"\"\")\")\n\n    r1 = \"B2:\" &amp; last_box_Ltr &amp; l1\n\n    hide1 = cnt_col - 10\n    hide1_cell = Evaluate(\"substitute(address(1, \" &amp; hide1 &amp; \", 4), \"\"1\"\", \"\"\"\")\")\n    hide2 = cnt_col - 11\n    hide2_cell = Evaluate(\"substitute(address(1, \" &amp; hide2 &amp; \", 4), \"\"1\"\", \"\"\"\")\")\n\n     Worksheets(\"1Summary - All\").Columns(hide2_cell &amp; \":\" &amp; hide1_cell).Select\n    Selection.EntireColumn.Hidden = True\n\n    Set rng = Nothing\n    On Error Resume Next\n    ' Only send the visible cells in the selection.\n    Set rng = Worksheets(\"1Summary - All\").Range(r1).SpecialCells(xlCellTypeVisible)\n    ' You can also use a range with the following statement.\n    ' Set rng = Sheets(\"YourSheet\").Range(\"D4:D12\").SpecialCells(xlCellTypeVisible)\n    On Error GoTo 0\n\n    If rng Is Nothing Then\n        MsgBox \"The selection is not a range or the sheet is protected. \" &amp; _\n               vbNewLine &amp; \"Please correct and try again.\", vbOKOnly\n        Exit Sub\n    End If\n\n    With Application\n        .EnableEvents = False\n        .ScreenUpdating = False\n    End With\n\n    Set rng_dt = Worksheets(\"1Summary - All\").Range(\"AGQ2\")\n    dt = rng_dt.Cells(1, 1).Value\n    dt_formatted1 = Format(dt, \"dd-MMMM-yyyy\")\n    dt_formatted2 = Format(dt, \"dd MMMM yyyy\")\n    ' folder = Mid(dt, 2, 4)            \n\n    'open the global variable file to get the acu file name along with the file name to be attached \n\n    'Attach_xcl - an excel workbook to be attached (working fine)\n    'body_xcl - another excel workbook, from where I have to select the range\n    'both the workbook names along with their path are stored in this global variable file(working fine)\n\n    Set wkb1 = Workbooks.Open(Filename:=\"\\\\vfpnbrgspr0\\LESR_Phase2_R_RPA\\Sayan\\Global_Variable_Singapore.xlsx\")\n    Set rng_xcl1 = wkb1.Worksheets(\"Global_Variable\").Range(\"B17\")\n    Attach_xcl = rng_xcl1.Cells(1, 1).Value\n    Set rng_xcl2 = wkb1.Worksheets(\"Global_Variable\").Range(\"B18\")\n    Body_xcl = rng_xcl2.Cells(1, 1).Value\n    ActiveWorkbook.Close\n\n    'open the acu limit(Body_xcl) file for second table for mail body\n    Set wkb2 = Workbooks.Open(Filename:=Body_xcl)\n\n    Set rng2 = Nothing\n    On Error Resume Next\n    ' Only send the visible cells in the selection.\n    Set rng2 = wkb2.Worksheets(\"Biz Breakdown\").Range(\"body\").SpecialCells(xlCellTypeVisible)\n    ' You can also use a range with the following statement.\n    ' Set rng = Sheets(\"YourSheet\").Range(\"D4:D12\").SpecialCells(xlCellTypeVisible)\n    On Error GoTo 0\n\n    If rng2 Is Nothing Then\n        MsgBox \"The selection is not a range or the sheet is protected. \" &amp; _\n               vbNewLine &amp; \"Please correct and try again.\", vbOKOnly\n        wkb2.Close\n        Exit Sub\n    End If\n\n    With Application\n        .EnableEvents = False\n        .ScreenUpdating = False\n    End With\n    wkb2.Close\n\n    '------------------------------PREPARE THE MAIL TO BE SENT---------------------------------------------'\n    Dim StrBody1 As String\n    ' Build the string that you want to add.\n    StrBody1 = \"Dear All,\" &amp; \"&lt;br&gt;&lt;br&gt;\" &amp; _\n               \"This is confidential.\" &amp; \"&lt;br&gt;&lt;br&gt;&lt;br&gt;\"\n\n    Dim StrBody2 As String\n    ' Build the string that you want to add.\n    StrBody2 = \" \" &amp; \"&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;\" &amp; _\n               \"Thanks,\" &amp; \"&lt;br&gt;\" &amp; _\n               \"user\" &amp; \"&lt;br&gt;\"\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n\n    On Error Resume Next\n    With OutMail\n       ' .To = \"xxxx\"\n        .To = \"xxxx\"\n        .CC = \"xxxx\"\n        .BCC = \"xxxx\"\n        .Subject = \"This is confidential\" &amp; dt_formatted2\n\n  'THE LINE BELOW IS NOT WORKING, IF I WORK WITH 'rng' ITS WORKING FINE, WHEN I ADD THE SECOND 'rng2' THE BODY OF THE MAIL IS BLANK\n\n        .HTMLBody = StrBody1 &amp; RangetoHTML(rng) &amp; \" \" &amp; RangetoHTML(rng2) &amp; StrBody2\n        '.HTMLBody = RangetoHTML(rng2) &amp; StrBody2\n        .Attachments.Add (Attach_xcl)\n        ' In place of the following statement, you can use \".Display\" to\n        ' display the e-mail message.\n        .Send\n    End With\n    On Error GoTo 0\n\n    With Application\n        .EnableEvents = True\n        .ScreenUpdating = True\n    End With\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\n\n    Worksheets(\"1Summary - All\").Columns(hide2_cell &amp; \":\" &amp; hide2_cell).Select\n    Selection.EntireColumn.Hidden = False\n    Worksheets(\"1Summary - All\").Columns(hide1_cell &amp; \":\" &amp; hide1_cell).Select\n    Selection.EntireColumn.Hidden = False\n\nEnd Sub\n\nFunction RangetoHTML(rng As Range)\n' Works in Excel 2000, Excel 2002, Excel 2003, Excel 2007, Excel 2010, Outlook 2000, Outlook 2002, Outlook 2003, Outlook 2007, and Outlook 2010.\n    Dim fso As Object\n    Dim ts As Object\n    Dim TempFile As String\n    Dim TempWB As Workbook\n\n    TempFile = Environ$(\"temp\") &amp; \"/\" &amp; Format(Now, \"dd-mm-yy h-mm-ss\") &amp; \".htm\"\n\n    ' Copy the range and create a workbook to receive the data.\n    rng.Copy\n    Set TempWB = Workbooks.Add(1)\n    With TempWB.Sheets(1)\n        .Cells(1).PasteSpecial Paste:=8\n        .Cells(1).PasteSpecial xlPasteValues, , False, False\n        .Cells(1).PasteSpecial xlPasteFormats, , False, False\n        .Cells(1).Select\n        Application.CutCopyMode = False\n        On Error Resume Next\n        .DrawingObjects.Visible = True\n        .DrawingObjects.Delete\n        On Error GoTo 0\n    End With\n\n    ' Publish the sheet to an .htm file.\n    With TempWB.PublishObjects.Add( _\n         SourceType:=xlSourceRange, _\n         Filename:=TempFile, _\n         Sheet:=TempWB.Sheets(1).Name, _\n         Source:=TempWB.Sheets(1).UsedRange.Address, _\n         HtmlType:=xlHtmlStatic)\n        .Publish (True)\n    End With\n\n    ' Read all data from the .htm file into the RangetoHTML subroutine.\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    Set ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)\n    RangetoHTML = ts.ReadAll\n    ts.Close\n    RangetoHTML = Replace(RangetoHTML, \"align=center x:publishsource=\", _\n                          \"align=left x:publishsource=\")\n\n    ' Close TempWB.\n    TempWB.Close savechanges:=False\n\n    ' Delete the htm file.\n    Kill TempFile\n\n    Set ts = Nothing\n    Set fso = Nothing\n    Set TempWB = Nothing\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 6002, "user_id": 356887, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kmXlh.gif?s=128&g=1", "display_name": "xdhmoore", "link": "https://stackoverflow.com/users/356887/xdhmoore"}, "edited": false, "score": 0, "creation_date": 1568234193, "post_id": 57881951, "comment_id": 102214047, "body": "Other options - refresh the pane? refresh the mail item?"}], "answers": [{"comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1568266409, "post_id": 57900042, "comment_id": 102221117, "body": ",Maybe <a href=\"https://stackoverflow.com/a/29850273/9439330\">How do i capture the text in the Instant Search box in Outlook 2010 in vba</a>  fits your needs or you have to create a form with a control that provides events."}], "tags": [], "owner": {"reputation": 6002, "user_id": 356887, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kmXlh.gif?s=128&g=1", "display_name": "xdhmoore", "link": "https://stackoverflow.com/users/356887/xdhmoore"}, "is_accepted": false, "score": 0, "last_activity_date": 1568264810, "creation_date": 1568264810, "answer_id": 57900042, "question_id": 57881951, "link": "https://stackoverflow.com/questions/57881951/refresh-search-results/57900042#57900042", "title": "Refresh search results", "body": "<p>Well, I solved it by saving the current search string to a global variable every time I do a search in my macros. Then I use that global variable later on to \"refresh\" the search. But this only works if my current search was set by a macro. If I manually search for something, this doesn't update the global variable and thus doesn't work properly.</p>\n\n<p>This fits my usage 80% of the time, but it would be nice to have something better.</p>\n"}], "owner": {"reputation": 6002, "user_id": 356887, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kmXlh.gif?s=128&g=1", "display_name": "xdhmoore", "link": "https://stackoverflow.com/users/356887/xdhmoore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1586740596, "creation_date": 1568174392, "last_edit_date": 1586740596, "question_id": 57881951, "link": "https://stackoverflow.com/questions/57881951/refresh-search-results", "title": "Refresh search results", "body": "<p>I have an Outlook VBA macro that archives a mail item intelligently according to the archive folder of that account. However, sometimes when it archives an item, the item does not immediately disappear from the search results. It remains selected and the preview pane displays an error. I think I may be able to solve this by refreshing the search results. I am looking for either:</p>\n\n<ol>\n<li><p>A <code>search.Refresh()</code> function/sub/thingy to refresh the search results.</p></li>\n<li><p>Access to the current search text in order to refresh the results </p></li>\n</ol>\n\n<p>like so:</p>\n\n<pre><code>'Get the current search text. Is this possible?\ntxtSearch = myOlApp.ActiveExplorer.GetMeTheCurrentSearchTextScotty\n'Search for nothing\nmyOlApp.ActiveExplorer.Search \"\", olSearchScopeAllFolders    \n'Restore search\nmyOlApp.ActiveExplorer.Search txtSearch, olSearchScopeAllFolders \n</code></pre>\n\n<p>Is it possible to refresh the search?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1568183552, "creation_date": 1568183552, "answer_id": 57883339, "question_id": 57881873, "link": "https://stackoverflow.com/questions/57881873/even-after-entering-password-in-command-line-still-prompting-for-password/57883339#57883339", "title": "Even after entering password in command line , still prompting for password", "body": "<p>Note that the <code>Password</code> parameter in <code>Workbooks.Open</code> is just the password you need to open/view the file, it has nothing to do with the protection of the workbook/worksheet. If the workbook/worksheet is protected then you probably still need to use the \u2026</p>\n\n<ul>\n<li><a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbook.unprotect\" rel=\"nofollow noreferrer\">Workbook.Unprotect method</a> to unprotect the workbook</li>\n<li><a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.unprotect\" rel=\"nofollow noreferrer\">Worksheet.Unprotect method</a> to unprotect the worksheet</li>\n</ul>\n\n<p>Also note that if you can open your file for viewing without entering a password, then you must not specify the <code>Password</code> parameter in <code>Workbooks.Open</code> (or it will keep asking for the correct password which is actually none).</p>\n\n<p>Further improvements:</p>\n\n<ol>\n<li>I recommend to stay away from <code>ActiveSheet</code></li>\n<li>Use <code>Option Explicit</code> to force proper variable declaration and set your opened worksheet to a variable so you can use it later for further actions relying on this workbook.</li>\n<li>If you turn off <code>.DisplayAlerts = False</code> then you should reactivate it later or it will stay off until Excel is closed.</li>\n<li>You don't need to loop to check if the file <code>scenarios.xlsx</code> exists</li>\n</ol>\n\n<p>So I think it should look something like this:</p>\n\n<pre><code>Option Explicit\n\nPrivate Const PASSWD As String = \"yourpasswordhere\" 'define your password only once\n\nPublic Sub GetSheets()\n'Updated by Extendoffice 2019/2/20\n    Dim Path As String\n    Path = \"D:\\My Path\\\"\n\n    Dim Filename As String\n    Filename = Dir(Path &amp; \"scenarios.xlsx\") 'check if file exists\n\n    If Filename &lt;&gt; vbNullString\n        Application.AskToUpdateLinks = False\n        Application.DisplayAlerts = False 'comment out this line for Debugging (or you don't see if something goes wrong\n\n        Dim wbScenarios As Workbook\n        Set wbScenarios = Workbooks.Open(Filename:=Path &amp; Filename, ReadOnly:=True)\n\n        Application.AskToUpdateLinks = True\n\n        'unprotect workbook and/or worksheet (test which one you need or if you need both)\n        wbScenarios.Unprotect Password:=PASSWD 'defined on top of the module\n        wbScenarios.Worksheets(\"Data\").Unprotect Password:=PASSWD 'defined on top of the module\n\n        wbScenarios.Worksheets(\"Data\").Copy After:=ThisWorkbook.Sheets(1)\n        wbScenarios.Close SaveChanges:=False\n\n        'if you insert after sheet 1 then your inserted sheet is Sheets(2)\n        If ThisWorkbook.Sheets(2).AutoFilterMode Then\n            ThisWorkbook.Sheets(2).AutoFilterMode = False\n        End If\n    End If\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 4675346, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/941d7a6d4d66f593107f6a53cd0be200?s=128&d=identicon&r=PG&f=1", "display_name": "Rajyalakshmi Gangisetty", "link": "https://stackoverflow.com/users/4675346/rajyalakshmi-gangisetty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568183552, "creation_date": 1568173822, "last_edit_date": 1568182136, "question_id": 57881873, "link": "https://stackoverflow.com/questions/57881873/even-after-entering-password-in-command-line-still-prompting-for-password", "title": "Even after entering password in command line , still prompting for password", "body": "<p>I am trying to copy data from a password protected sheet to another workbook where in i have to merge multiple sheets, the workbook that i am trying to copy is password protected , </p>\n\n<p>so i entered the password as well in syntax of opening the file but still it is prompting the same , i tried Rewritepassword syntax as well but still again it is prompting </p>\n\n<pre><code>Sub GetSheets()\n'Updated by Extendoffice 2019/2/20\n    Path = \"D:\\My Path\\\"\n    Filename = Dir(Path &amp; \"*.xlsx\")\n    Do While Filename &lt;&gt; \"\"\n     If (Filename = \"scenarios.xlsx\") Then\n        Application.AskToUpdateLinks = False\n        Application.DisplayAlerts = False\n        Workbooks.Open Filename:=Path &amp; Filename, Password:=\"*****\", \n                  WriteResPassword:=\"****\", ReadOnly:=True\n        Application.AskToUpdateLinks = True\n        Sheets(\"Data\").Copy After:=ThisWorkbook.Sheets(1)\n        Workbooks(Filename).Close\n        If ActiveSheet.AutoFilterMode Then\n            ActiveSheet.AutoFilterMode = False\n        End If\n     End If\n     Filename = Dir()\n    Loop\nEnd Sub\n\n\nThe password to unlock workbook is same as the other passwords that are popping up\n</code></pre>\n"}, {"tags": ["sql", "vba", "sql-update"], "comments": [{"owner": {"reputation": 11494, "user_id": 6429072, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gh4b0.png?s=128&g=1", "display_name": "Ed Bangga", "link": "https://stackoverflow.com/users/6429072/ed-bangga"}, "edited": false, "score": 2, "creation_date": 1568173724, "post_id": 57881843, "comment_id": 102186545, "body": "what&#39;s your NCR db length?"}, {"owner": {"reputation": 111, "user_id": 11239550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d14a95c1c80b75bc4b8c94d1357da051?s=128&d=identicon&r=PG&f=1", "display_name": "TimG", "link": "https://stackoverflow.com/users/11239550/timg"}, "reply_to_user": {"reputation": 11494, "user_id": 6429072, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gh4b0.png?s=128&g=1", "display_name": "Ed Bangga", "link": "https://stackoverflow.com/users/6429072/ed-bangga"}, "edited": false, "score": 0, "creation_date": 1568174141, "post_id": 57881843, "comment_id": 102186612, "body": "It was 1.. that makes so much more sense. Thanks! I&#39;m just surprised since it was short text and I didn&#39;t think it ever went to 1 as the field length. Is there an easy way to update all short text fields to have max size for short text? I&#39;m trying to think of the possible downsides of doing that, but I don&#39;t really know if there are any."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1568181800, "post_id": 57881843, "comment_id": 102188660, "body": "Updating all fields should be a new question. Downsides: if you limit to a size smaller than 255, you can  never exceed that (e.g. city name with 200 chars ), even not by accident."}], "answers": [{"tags": [], "owner": {"reputation": 11494, "user_id": 6429072, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gh4b0.png?s=128&g=1", "display_name": "Ed Bangga", "link": "https://stackoverflow.com/users/6429072/ed-bangga"}, "is_accepted": false, "score": 2, "last_activity_date": 1568178155, "creation_date": 1568178155, "answer_id": 57882407, "question_id": 57881843, "link": "https://stackoverflow.com/questions/57881843/update-query-only-updating-data-with-first-letter-of-new-value/57882407#57882407", "title": "Update query only updating data with first letter of new value", "body": "<p>Text field size of your column \"<code>NCR\"</code> should not be equal to 1 if you want to store more than 1 characters.</p>\n\n<p><a href=\"https://i.stack.imgur.com/yyTT4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yyTT4.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 111, "user_id": 11239550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d14a95c1c80b75bc4b8c94d1357da051?s=128&d=identicon&r=PG&f=1", "display_name": "TimG", "link": "https://stackoverflow.com/users/11239550/timg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1568178155, "creation_date": 1568173550, "last_edit_date": 1568173642, "question_id": 57881843, "link": "https://stackoverflow.com/questions/57881843/update-query-only-updating-data-with-first-letter-of-new-value", "title": "Update query only updating data with first letter of new value", "body": "<p>In an Access Database, I'm trying to run an update query that fixes Y/N's to be Yes and No. This is done via VBA.</p>\n\n<p>I've checked the query I wrote in VBA by putting it in the query editor, I get similar results. </p>\n\n<p>In VBA, I run the following command</p>\n\n<pre><code>db.Execute \"Update tblChecks Set NCR = 'No' where NCR = ' ' or NCR is null\"\n</code></pre>\n\n<p>This updates all blank and null records to \"N\" rather than \"No\"</p>\n\n<p>No error messages are produced, the query runs, but it's only taking the first letter of anything I put in the Set criteria. I've tested this with other criteria such as \"Yes\" and \"Test\" and I get \"Y\" and \"T\" respectively in those rows.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568173704, "post_id": 57881800, "comment_id": 102186540, "body": "<code>3 consecutive empty rows</code> or <code>3 consecutive empty Cells say in Col A</code>?"}, {"owner": {"reputation": 1837, "user_id": 11901732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiNDt.jpg?s=128&g=1", "display_name": "nilsinelabore", "link": "https://stackoverflow.com/users/11901732/nilsinelabore"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568173739, "post_id": 57881800, "comment_id": 102186546, "body": "Hi @SiddharthRout it&#39;s 3 consecutive empty rows in one <code>Col A</code>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568173878, "post_id": 57881800, "comment_id": 102186574, "body": "Let me rephrase. Do you want to check if the complete row is empty (for example <code>A1:XFD1</code> in Excel 2007+) or just <code>A1</code>?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568173943, "post_id": 57881800, "comment_id": 102186585, "body": "So in first example you compare <code>A1:XFD1</code> with <code>A2:XFD2</code> and so on. In the 2nd you compare <code>A1</code> with <code>A2</code> and so on..."}, {"owner": {"reputation": 1837, "user_id": 11901732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiNDt.jpg?s=128&g=1", "display_name": "nilsinelabore", "link": "https://stackoverflow.com/users/11901732/nilsinelabore"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568173967, "post_id": 57881800, "comment_id": 102186590, "body": "I want to check for just single cell <code>A1</code> at a time, then for the whole column <code>A</code>"}, {"owner": {"reputation": 1837, "user_id": 11901732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiNDt.jpg?s=128&g=1", "display_name": "nilsinelabore", "link": "https://stackoverflow.com/users/11901732/nilsinelabore"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568174179, "post_id": 57881800, "comment_id": 102186618, "body": "@SiddharthRout So basically I suspect that there are 3 consecutive empty rows in a column <code>Col A</code>, but I would like to check where are they"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568174634, "post_id": 57881800, "comment_id": 102186722, "body": "I posted an answer. You may have to refresh the page to see it."}, {"owner": {"reputation": 1837, "user_id": 11901732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiNDt.jpg?s=128&g=1", "display_name": "nilsinelabore", "link": "https://stackoverflow.com/users/11901732/nilsinelabore"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568179212, "post_id": 57881800, "comment_id": 102187816, "body": "@SiddharthRout Thank you so much for your answer. I tried to run the code but nothing happened. Please see the edited question for the screenshot."}], "answers": [{"comments": [{"owner": {"reputation": 1837, "user_id": 11901732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiNDt.jpg?s=128&g=1", "display_name": "nilsinelabore", "link": "https://stackoverflow.com/users/11901732/nilsinelabore"}, "edited": false, "score": 0, "creation_date": 1568187706, "post_id": 57883431, "comment_id": 102191094, "body": "Hi @jvdV, thanks for your answer. I managed to run the code for a sample of data but somehow I couldn&#39;t do it for the entire data. I am thinking maybe the dataset is too big?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 1837, "user_id": 11901732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiNDt.jpg?s=128&g=1", "display_name": "nilsinelabore", "link": "https://stackoverflow.com/users/11901732/nilsinelabore"}, "edited": false, "score": 0, "creation_date": 1568187915, "post_id": 57883431, "comment_id": 102191212, "body": "Well, @Harper, it depends what you meant with &quot;Somehow I couldn&#39;t do it for the entire data&quot;. Does it throw an error? Or does it just not produce the result you are after? Notice the code looks at truely empty cells, not cells that are actually holding <code>&quot;&quot;</code> through formula."}, {"owner": {"reputation": 1837, "user_id": 11901732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiNDt.jpg?s=128&g=1", "display_name": "nilsinelabore", "link": "https://stackoverflow.com/users/11901732/nilsinelabore"}, "edited": false, "score": 0, "creation_date": 1568188263, "post_id": 57883431, "comment_id": 102191379, "body": "By that  mean there&#39;s nothing in the output after running the code. Yes I am sure the cells are actually empty."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 1837, "user_id": 11901732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiNDt.jpg?s=128&g=1", "display_name": "nilsinelabore", "link": "https://stackoverflow.com/users/11901732/nilsinelabore"}, "edited": false, "score": 0, "creation_date": 1568188373, "post_id": 57883431, "comment_id": 102191422, "body": "@Harper, It&#39;s hard to believe the code runs without throwing an error nor output when cells are truely empty. Few more things I can think of, make sure to reference the correct sheet and workbook when you run the code, and again make sure there are no trailing/leading spaces or any other unseen characters in the cells. No matter how large my data, the code worked. You might want to include a screenshot of how your data looks too in your question. Maybe there are some leads there."}, {"owner": {"reputation": 1837, "user_id": 11901732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiNDt.jpg?s=128&g=1", "display_name": "nilsinelabore", "link": "https://stackoverflow.com/users/11901732/nilsinelabore"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568188849, "post_id": 57883431, "comment_id": 102191660, "body": "Okay maybe the problem lies with me but thank you guys I learnt a lot from both your contributions @Siddharth Rout"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 1837, "user_id": 11901732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiNDt.jpg?s=128&g=1", "display_name": "nilsinelabore", "link": "https://stackoverflow.com/users/11901732/nilsinelabore"}, "edited": false, "score": 0, "creation_date": 1568189118, "post_id": 57883431, "comment_id": 102191806, "body": "@Harper, how do you pull in your data? It could be tab delimited data, which is still a character in your cell you just won&#39;t see, but the cell just aint empty. Try replacing some of the cells that you feel should be empty with truely empty cells from even beyond your data set and re-run the code. Otherwise I&#39;m out of ideas for now ;)"}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 2, "last_activity_date": 1568188781, "last_edit_date": 1568188781, "creation_date": 1568183994, "answer_id": 57883431, "question_id": 57881800, "link": "https://stackoverflow.com/questions/57881800/how-to-detect-3-consecutive-empty-rows-in-excel/57883431#57883431", "title": "How to detect 3 consecutive empty rows in excel", "body": "<p>I don't know if it would ever be the case, but this will detect if gaps are even bigger than 3 rows too.</p>\n\n<pre><code>Sub Test()\n\nDim lr As Long, x As Long\nDim rng1 As Range, rng2 As Range\nDim arr As Variant\n\nWith ThisWorkbook.Sheets(\"Sheet1\") 'Change accordingly\n    lr = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    Set rng1 = .Range(\"A2:A\" &amp; lr)\n    If Application.WorksheetFunction.CountA(rng1) &lt;&gt; rng1.Cells.Count Then\n        Set rng2 = Intersect(rng1, rng1.SpecialCells(xlCellTypeBlanks))\n        arr = Split(rng2.Address, \",\")\n        For x = LBound(arr) To UBound(arr)\n            If .Range(arr(x)).Cells.Count &gt; 2 Then\n                Debug.Print arr(x)\n            End If\n        Next x\n    End If\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1837, "user_id": 11901732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiNDt.jpg?s=128&g=1", "display_name": "nilsinelabore", "link": "https://stackoverflow.com/users/11901732/nilsinelabore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 57883431, "answer_count": 1, "score": 0, "last_activity_date": 1568188781, "creation_date": 1568173210, "last_edit_date": 1568179293, "question_id": 57881800, "link": "https://stackoverflow.com/questions/57881800/how-to-detect-3-consecutive-empty-rows-in-excel", "title": "How to detect 3 consecutive empty rows in excel", "body": "<p>I am new to VBA so sorry for the silly question.  </p>\n\n<p>I would like to detect if there are 3 consecutive empty rows in a column. I am aware that I could probably do 2 consecutive empty rows using code below:</p>\n\n<pre><code>While (lastCell &lt;&gt; \"\") Or (curCell &lt;&gt; \"\")\n    lastCell = curCell\n    ActiveCell.Offset(1, 0).Select\n    curCell = ActiveCell\nWend\n</code></pre>\n\n<p>Is there a way to do 3 rows? Thank you so much.</p>\n\n<p>Tried to run the code but nothing happened <a href=\"https://i.stack.imgur.com/nTFLK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nTFLK.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1568162061, "post_id": 57879301, "comment_id": 102183783, "body": "Perhaps give the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.end\" rel=\"nofollow noreferrer\"><code>Range.End</code></a> documentation a read - you need to specify the direction. Also - <code>Range(&quot;A&quot;)</code>, <code>Range(&quot;B&quot;)</code> and so on are problematic, unless those are named ranges."}, {"owner": {"reputation": 13, "user_id": 9291412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df490dd90b53c5e4d5de411a6687a373?s=128&d=identicon&r=PG&f=1", "display_name": "NewCoder0422", "link": "https://stackoverflow.com/users/9291412/newcoder0422"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568220403, "post_id": 57879301, "comment_id": 102208539, "body": "I read the documentation and also changed the code in reference to the documentation, but I am still getting an error. Range &quot;A&quot; &amp; &quot;B&quot; is in reference to the other sheet where I want the destination of the data to end up at. SO &quot;A&quot; and &quot;B&quot; are referring to the columns! I really appreciate the reply though. Do you have any other thoughts? Or maybe possibly any suggestions on changing the code in general."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568227456, "post_id": 57879301, "comment_id": 102211459, "body": "You need to add the direction: <code>.End(xlDown)</code> for example. For the other issue, you need a row reference: <code>Range(&quot;A&quot; &amp; iRow)</code>."}, {"owner": {"reputation": 13, "user_id": 9291412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df490dd90b53c5e4d5de411a6687a373?s=128&d=identicon&r=PG&f=1", "display_name": "NewCoder0422", "link": "https://stackoverflow.com/users/9291412/newcoder0422"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568494929, "post_id": 57879301, "comment_id": 102293845, "body": "Still having an issue with the data not being transferred over to other &quot;Sheet&quot;. I have updated the code up above as follows. Im sure you are right though, I think the destination could be the problem. I will look further into it."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568497731, "post_id": 57879301, "comment_id": 102294297, "body": "<code>xlDown</code>, not <code>x1Down</code>. It&#39;s the letter <code>l</code>, not the number <code>1</code>."}, {"owner": {"reputation": 13, "user_id": 9291412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df490dd90b53c5e4d5de411a6687a373?s=128&d=identicon&r=PG&f=1", "display_name": "NewCoder0422", "link": "https://stackoverflow.com/users/9291412/newcoder0422"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568741576, "post_id": 57879301, "comment_id": 102368031, "body": "awesome!! It works, thank you!!"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568741703, "post_id": 57879301, "comment_id": 102368090, "body": "You&#39;re welcome. This is a common confusion, even though <code>xl</code> -&gt; <code>Excel</code> but many confuse the <code>l</code> and <code>1</code>. Oh well..."}], "owner": {"reputation": 13, "user_id": 9291412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df490dd90b53c5e4d5de411a6687a373?s=128&d=identicon&r=PG&f=1", "display_name": "NewCoder0422", "link": "https://stackoverflow.com/users/9291412/newcoder0422"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568494860, "creation_date": 1568157943, "last_edit_date": 1568494860, "question_id": 57879301, "link": "https://stackoverflow.com/questions/57879301/how-to-fix-runtime-error-1004-on-cmbsave-click-button-along-with-help-transfe", "title": "How to fix &quot;Runtime error 1004 on cmbSave_Click button&quot;, along with help transferring data from macros to data sheets", "body": "<p>I am building a macro based spreadsheet to transfer inputted data to another sheet labeled \"data\". Im only getting a runtime error 1004 when I click on the cmbSave_Click() button. I feel the issue is with my line of code being \"iRow = Sheets(\"Data\").Range(\"A40\").End.Row + 1\", but I am not sure. Im still trying to learn excel VBA. </p>\n\n<p>I have tried debugging the code and also tried commenting code to try to come up with a solution. </p>\n\n<pre><code>Private Sub cmbSave_Click()\n\nApplication.ScreenUpdating = True\n\nDim iRow As Long\n\niRow = Sheets(\"Data\").Range(\"A50\").End(x1down).Row + 1\n\nIf ValidateForm = True Then\n\nWith ThisWorkbook.Sheets(\"Data\")\n\n   .Range(\"A\" &amp; iRow).Value = iRow - 1\n   .Range(\"B\" &amp; iRow).Value = txtName.Value\n   .Range(\"C\" &amp; iRow).Value = txtScholar.Value\n   .Range(\"D\" &amp; iRow).Value = txtDate.Value\n   .Range(\"E\" &amp; iRow).Value = txtSession.Value\n   .Range(\"F\" &amp; iRow).Value = cmbReason.Text\n   .Range(\"G\" &amp; iRow).Value = txtComments.Value\n\nEnd With\n\nCall Reset\n\nElse\n\nApplication.ScreenUpdating = True\n\nExit Sub\n\n   End If\n\n     Application.ScreenUpdating = True\n</code></pre>\n\n<p>Data should be able to input and save onto the other \"data\" sheet</p>\n"}, {"tags": ["excel", "vba", "userform", "date-formatting"], "comments": [{"owner": {"reputation": 1205, "user_id": 8578580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a063b2c15a5847791ed1e0007d04b8c0?s=128&d=identicon&r=PG&f=1", "display_name": "TechnoDabbler", "link": "https://stackoverflow.com/users/8578580/technodabbler"}, "edited": false, "score": 0, "creation_date": 1568172080, "post_id": 57879243, "comment_id": 102186272, "body": "More info is needed, but the textbox should show the format per the regional date settings. I assume the cell format isn&#39;t overridden with the different locale (location) value? If you use the month and day functions on the date, does it show the month and day values you would expect?"}], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 0, "last_activity_date": 1568175882, "creation_date": 1568175882, "answer_id": 57882131, "question_id": 57879243, "link": "https://stackoverflow.com/questions/57879243/populate-userform-textbox-with-date-taken-from-cell-in-dd-mm-yyyy-format/57882131#57882131", "title": "Populate userform textbox with date taken from cell in &#39;dd/MM/yyyy&#39; format", "body": "<p>Computer's system date setting decides how <code>DateValue</code> outputs a date. You may want to read about <a href=\"https://support.office.com/en-us/article/datevalue-function-df8b07d4-7761-4a93-bc33-b7471bbff252\" rel=\"nofollow noreferrer\">DATEVALUE function</a> </p>\n\n<p>To show the result in a specific format, use the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/format-function-visual-basic-for-applications\" rel=\"nofollow noreferrer\">Format Function</a></p>\n\n<p>Is this what you are trying?</p>\n\n<pre><code>Text_checkin = Format(DateValue(Sheets(\"Data\").Range(\"Data_St\").Offset(Trgt, 3).Value), \"DD/MM/YYYY\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12022052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d7f3048fd7fcf5034b940fb8d17d729?s=128&d=identicon&r=PG&f=1", "display_name": "entropia_gr", "link": "https://stackoverflow.com/users/12022052/entropia-gr"}, "is_accepted": false, "score": 0, "last_activity_date": 1568280761, "creation_date": 1568280761, "answer_id": 57903769, "question_id": 57879243, "link": "https://stackoverflow.com/questions/57879243/populate-userform-textbox-with-date-taken-from-cell-in-dd-mm-yyyy-format/57903769#57903769", "title": "Populate userform textbox with date taken from cell in &#39;dd/MM/yyyy&#39; format", "body": "<p>Thanks,\nIt seems that it works for me:\n<code>Text_checkin = DateValue(Sheets(\"Data\").Range(\"Data_St\").Offset(Trgt, 3).Text)</code>\nThe System's regional date settings was set to English (UK) dd/MM/yyyy all the time.</p>\n"}], "owner": {"reputation": 1, "user_id": 12022052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d7f3048fd7fcf5034b940fb8d17d729?s=128&d=identicon&r=PG&f=1", "display_name": "entropia_gr", "link": "https://stackoverflow.com/users/12022052/entropia-gr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 231, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1568280761, "creation_date": 1568157334, "last_edit_date": 1568184559, "question_id": 57879243, "link": "https://stackoverflow.com/questions/57879243/populate-userform-textbox-with-date-taken-from-cell-in-dd-mm-yyyy-format", "title": "Populate userform textbox with date taken from cell in &#39;dd/MM/yyyy&#39; format", "body": "<p>I want to fill a userform textbox with a date taken from a cell. The date in the cell is in 'dd/MM/yyyy' but the date drawn from this cell into the textbox comes always as 'MM/dd/yyyy'. Any suggestions would be highly appreciated as I have been wasting tons of hours on that issue.</p>\n\n<pre><code>Text_checkin = DateValue(Sheets(\"Data\").Range(\"Data_St\").Offset(Trgt, 3).Value)\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-2016"], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 7114770, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ed6bd8b2b439e3160072b374dafa2a79?s=128&d=identicon&r=PG&f=1", "display_name": "dotsent12", "link": "https://stackoverflow.com/users/7114770/dotsent12"}, "edited": false, "score": 0, "creation_date": 1568208573, "post_id": 57879630, "comment_id": 102202104, "body": "Thanks Tim. Unfortuantely that reports an error &quot;Application-defined or object-defined error&quot;."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 121, "user_id": 7114770, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ed6bd8b2b439e3160072b374dafa2a79?s=128&d=identicon&r=PG&f=1", "display_name": "dotsent12", "link": "https://stackoverflow.com/users/7114770/dotsent12"}, "edited": false, "score": 0, "creation_date": 1568213584, "post_id": 57879630, "comment_id": 102204985, "body": "on which line ?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 121, "user_id": 7114770, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ed6bd8b2b439e3160072b374dafa2a79?s=128&d=identicon&r=PG&f=1", "display_name": "dotsent12", "link": "https://stackoverflow.com/users/7114770/dotsent12"}, "edited": false, "score": 0, "creation_date": 1568241047, "post_id": 57879630, "comment_id": 102215983, "body": "Tested - works for me provided &quot;Trans_log&quot; is the same shape as the new table row."}, {"owner": {"reputation": 121, "user_id": 7114770, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ed6bd8b2b439e3160072b374dafa2a79?s=128&d=identicon&r=PG&f=1", "display_name": "dotsent12", "link": "https://stackoverflow.com/users/7114770/dotsent12"}, "edited": false, "score": 0, "creation_date": 1568328489, "post_id": 57879630, "comment_id": 102249322, "body": "Hi again! Got past the initial error - I was not launching from the same sheet, so adjusting &quot;With ActiveSheet&quot; into &quot;With Sheets(2)&quot; fixed it.  Still, a problem persist which you probably also hint at. &quot;Trans_log&quot; is a range of 2 columns (as is Table &quot;Log&quot; - so the data itself fits), however I&#39;m trying to add multiple rows at the same time and was expecting the table to expand as needed. The code does not report any errors anymore, however only adds the 1st row from &quot;Trans_log&quot; range into Table &quot;Log&quot;."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1568329783, "last_edit_date": 1568329783, "creation_date": 1568161696, "answer_id": 57879630, "question_id": 57879084, "link": "https://stackoverflow.com/questions/57879084/copy-from-one-listobject-to-another-vba/57879630#57879630", "title": "Copy from one ListObject to another VBA", "body": "<p>You can do something like this - directly assign the values instead of copy/paste</p>\n\n<pre><code>Sub Copy()\n\n    Dim newrow As ListRow\n    With ActiveSheet\n        Set newrow = .ListObjects(\"Log\").ListRows.Add()\n        newrow.Range.Value = .Range(\"Trans_log\").Value \n    End With\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT</strong>: for copying multiple rows</p>\n\n<pre><code>Sub Copy()\n    Dim rw As Range\n    Dim newrow As ListRow\n    Dim lst As ListObject, sht As Worksheet\n\n    Set sht = Sheets(1)\n    Set lst = sht.ListObjects(\"Log\")\n\n    'loop over rows in named range\n    For Each rw In sht.Range(\"Trans_log\").Rows\n        'only copy rows with data\n        If Application.CountA(rw) &gt; 0 Then\n            Set newrow = lst.ListRows.Add()\n            newrow.Range.Value = rw.Value\n        End If\n    Next rw\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 7114770, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ed6bd8b2b439e3160072b374dafa2a79?s=128&d=identicon&r=PG&f=1", "display_name": "dotsent12", "link": "https://stackoverflow.com/users/7114770/dotsent12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 348, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568329783, "creation_date": 1568155745, "last_edit_date": 1568184553, "question_id": 57879084, "link": "https://stackoverflow.com/questions/57879084/copy-from-one-listobject-to-another-vba", "title": "Copy from one ListObject to another VBA", "body": "<p>More a question of writing nice VBA code here, since it technically works. I have a simple task - I need to copy data from one ListObject (2 columns from  4-column table) and add it to the end of another 2-column table (and have the Excel table autoexpand).</p>\n\n<p>I created Range <strong>Trans_log</strong>, for addressing those 2 columns I need to copy. I'm targeting the newly created ListRow through <strong>newrow</strong>, in order not to accidentially paste data somewhere in the middle of the table.</p>\n\n<p>However is there a neater way to do this, instead of using <em>With</em>, <em>.Activate</em> and <em>ActiveCell</em> ?</p>\n\n<pre><code>Sub Copy()\n\nDim newrow As ListRow\nSet newrow = ActiveSheet.ListObjects(\"Log\").ListRows.Add\n\nActiveSheet.Range(\"Trans_log\").Copy\n\nWith newrow\n\n.Range(1).Activate\nActiveCell.PasteSpecial xlPasteValues\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 10914715, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218496357669287/picture?type=large", "display_name": "Jake West", "link": "https://stackoverflow.com/users/10914715/jake-west"}, "edited": false, "score": 0, "creation_date": 1568213557, "post_id": 57882515, "comment_id": 102204968, "body": "Thanks for the response! I get a &quot;The requested member of the collection does not exist.&quot; error message when I don&#39;t have a bookmark set. Do you know why that would be?"}, {"owner": {"reputation": 99, "user_id": 10914715, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218496357669287/picture?type=large", "display_name": "Jake West", "link": "https://stackoverflow.com/users/10914715/jake-west"}, "edited": false, "score": 0, "creation_date": 1568213957, "post_id": 57882515, "comment_id": 102205198, "body": "Or in the case you mention above where you check if there is a bookmark, it just skips over the IF statement. How do I get it to read the default bookmark?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 99, "user_id": 10914715, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218496357669287/picture?type=large", "display_name": "Jake West", "link": "https://stackoverflow.com/users/10914715/jake-west"}, "edited": false, "score": 0, "creation_date": 1568215262, "post_id": 57882515, "comment_id": 102205925, "body": "Is there a chance something has removed the default names from the form fields / document? Maybe you first need to build a &quot;loop&quot; macro that goes through the form fields of the text input type and assign them names (just use a counter with some text) @JakeWest"}, {"owner": {"reputation": 99, "user_id": 10914715, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218496357669287/picture?type=large", "display_name": "Jake West", "link": "https://stackoverflow.com/users/10914715/jake-west"}, "edited": false, "score": 0, "creation_date": 1568218360, "post_id": 57882515, "comment_id": 102207591, "body": "I think I will have to take that approach. Thanks for your help!"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 99, "user_id": 10914715, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218496357669287/picture?type=large", "display_name": "Jake West", "link": "https://stackoverflow.com/users/10914715/jake-west"}, "edited": false, "score": 0, "creation_date": 1568403518, "post_id": 57882515, "comment_id": 102276442, "body": "I&#39;ve added information and code on how to to this, @JakeWest"}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1568403493, "last_edit_date": 1568403493, "creation_date": 1568178953, "answer_id": 57882515, "question_id": 57878989, "link": "https://stackoverflow.com/questions/57878989/how-to-change-the-text-of-a-form-field-text-box-on-entry-of-that-text-box/57882515#57882515", "title": "How to change the text of a form field text box on entry of that text box", "body": "<p>Every form field has a bookmark and a name, by default. They're generated by Word when the form field is inserted and the names for text fields follow the pattern Text1, Text2, and so on.</p>\n\n<p>While <code>Selection</code> doesn't return the form field when an \"On Enter\" macro is triggered it does return the bookmark. Through that, it's possible to get the bookmark name and from there access the form field. So:</p>\n\n<pre><code>Sub WriteValueToFormFieldOnEnter()\n    Dim bkm As Word.Bookmark\n    Dim ffldName As String, ffld As Word.FormField\n\n    If Selection.Bookmarks.Count &gt; 0 Then\n        Set bkm = Selection.Bookmarks(1)\n        ffldName = bkm.Name\n        Set ffld = ActiveDocument.FormFields(ffldName)\n        ffld.result = \"New\"\n    End If    \nEnd Sub\n</code></pre>\n\n<p>Note: If the form fields have no bookmark name because they were copied/pasted within the same document, then names have to be assigned to the form fields. (Bookmark names must be unique within a document, which is why this happens.) The following code loops the formfields in a document and assigns those with no name a name.</p>\n\n<p>While the Language Reference for <code>FormField.Name</code> states</p>\n\n<blockquote>\n  <p>Returns a String that represents the result of the specified form field. Read/write.</p>\n</blockquote>\n\n<p>writing to this property causes an error (at least in Word 2010 and newer, perhaps also in older versions). So it's necessary to work with the Word UI's Form Field Properties dialog box.</p>\n\n<pre><code>Sub NameUnnamedFormFields()\n    Dim ffld As Word.FormField\n    Dim rng As Word.Range\n    Dim tbCounter As Long, cbCounter As Long, ddCounter As Long\n\n    tbCounter = 1: cbCounter = 1: ddCounter = 1\n    For Each ffld In ActiveDocument.FormFields\n        If Len(ffld.Name) = 0 Then\n            ffld.Select\n            With Application.Dialogs(wdDialogFormFieldOptions)\n                Select Case ffld.Type\n                    Case wdFieldFormTextInput\n                        .Name = \"myText\" &amp; CStr(tbCounter)\n                        tbCounter = tbCounter + 1\n                    Case wdFieldFormCheckBox\n                        .Name = \"myCheckBox\" &amp; CStr(cbCounter)\n                        cbCounter = cbCounter + 1\n                    Case wdFieldFormDropDown\n                        .Name = \"myDropDown\" &amp; CStr(ddCounter)\n                        ddCounter = ddCounter + 1\n                    Case Else\n                        MsgBox \"Unknown form field type.\"\n                End Select\n                .Execute\n            End With\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 10914715, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218496357669287/picture?type=large", "display_name": "Jake West", "link": "https://stackoverflow.com/users/10914715/jake-west"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 328, "favorite_count": 0, "accepted_answer_id": 57882515, "answer_count": 1, "score": 0, "last_activity_date": 1582096018, "creation_date": 1568154993, "last_edit_date": 1582096018, "question_id": 57878989, "link": "https://stackoverflow.com/questions/57878989/how-to-change-the-text-of-a-form-field-text-box-on-entry-of-that-text-box", "title": "How to change the text of a form field text box on entry of that text box", "body": "<p>I am trying to change the text of a form field text box when it is entered into. I selected to run a macro on entry, but I can't seem to change it dynamically for all my fields using that macro. There are hundreds of fields which are removed and added dynamically, so setting a bookmark for every one of them is not an option as specified in this question answer <a href=\"https://stackoverflow.com/questions/35093978/ms-word-document-form-check-value-of-text-form-field-on-exit\">MS Word Document Form - Check Value of Text Form Field on Exit</a></p>\n\n<p>Is there any way to access the form field on entry so I can change it when they enter it?</p>\n\n<p>I have tried changing it by bookmark, but again this isn't an option for me:</p>\n\n<pre><code>ActiveDocument.FormFields(Selection.Bookmarks(1).Name).Result = \"my value\"\n</code></pre>\n\n<p>I have tried Selection.FormFields(1)...etc but it does not let me access this on entry. Any other ways?</p>\n\n<p>I am wanting to access the form field on entry to change the value, but cannot figure out how to do it!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": true, "score": 1, "last_activity_date": 1568154649, "creation_date": 1568154649, "answer_id": 57878951, "question_id": 57878612, "link": "https://stackoverflow.com/questions/57878612/code-to-protect-workbook-ignores-exceptions-and-range/57878951#57878951", "title": "Code to protect workbook ignores exceptions and range", "body": "<p>Your code fails for me on the first command already because of wrong syntax. </p>\n\n<p>The parameters for the ActiveSheet.Protect command should not be placed on different rows as separate commands They need to be parameters of the main command. </p>\n\n<p>If you need help with the syntax, you can start the macro recorder, protect the sheet, tick all the boxes, then stop the macro recorder. That will give you the syntax for the options you want, except for the password. You will find that the parameters are all in one statement, and you can add the password parameter like</p>\n\n<pre><code>ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True, _\n    AllowInsertingColumns:=True, AllowInsertingRows:=True, AllowFiltering:= True, _\n    Password:=\"Psswrd\"\n</code></pre>\n\n<p>Unless you specify a parameter as <code>True</code>, it will default to <code>False</code>, so you only need to list the items that you want to be TRUE.</p>\n\n<p>Also, by default, all cells are locked. You need to explicitly unlock the cells that you want to keep editable after the sheet is protected.</p>\n"}], "owner": {"reputation": 41, "user_id": 7327273, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/066fd24f1e95c444248860a779962eab?s=128&d=identicon&r=PG&f=1", "display_name": "user7327273", "link": "https://stackoverflow.com/users/7327273/user7327273"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 57878951, "answer_count": 1, "score": 1, "last_activity_date": 1568184548, "creation_date": 1568151995, "last_edit_date": 1568184548, "question_id": 57878612, "link": "https://stackoverflow.com/questions/57878612/code-to-protect-workbook-ignores-exceptions-and-range", "title": "Code to protect workbook ignores exceptions and range", "body": "<p>I have created some VBA code using snippets online with the aim of locking down a worksheet so that the header column cannot be edited, nor any rows or columns being inserted or deleted. However the main data needs to be editable and for ease of use by the end user, filtering and sorting needs to be possible. However, the code just creates a completely locked workbook- no editing, sorting, or filtering is possible.</p>\n\n<pre><code>    Rows(1).Locked = True\n    ActiveSheet.Protect Password:=\"Psswrd\"\n    ActiveSheet.Protect Contents:=False\n    AllowInsertingColumns = False\n    AllowInsertingRows = False\n    AllowSorting = True\n    AllowFiltering = True\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1568168187, "post_id": 57878535, "comment_id": 102185658, "body": "Show code that declares and sets r and n and rs variables. Step debug - are variables getting values? I tested code and concatenation works. <code>.Value</code> is not necessary. Is this code behind Access?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1568174605, "post_id": 57878535, "comment_id": 102186716, "body": "Anchor is a &quot;range or shape&quot; - <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.hyperlinks.add\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/excel.hyperlinks.add</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "edited": false, "score": 1, "creation_date": 1568206178, "post_id": 57883952, "comment_id": 102200697, "body": "Gustav, thanks for the tip.  Works just as expected."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1568186071, "creation_date": 1568186071, "answer_id": 57883952, "question_id": 57878535, "link": "https://stackoverflow.com/questions/57878535/add-hyperlink-to-xls-cell-via-variable/57883952#57883952", "title": "Add Hyperlink to XLS Cell (via variable)", "body": "<p>Define the <em>Range</em> object and go like this:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Function SetLink()\n\n    Dim wks1    As Excel.Worksheet\n    Dim Anchor  As Excel.Range\n\n    Dim r       As Long\n\n    r = 9   ' Example.\n\n    Set wks1 = ThisWorkbook.Worksheets(1)\n    Set Anchor = wks1.Cells(r, 1)\n\n    With wks1\n       .Hyperlinks.Add Anchor:=Anchor, _\n       Address:=\"https://example.microsoft.com\", _\n       TextToDisplay:=\"Microsoft\"\n    End With\n\n    Set Anchor = Nothing\n    Set wks1 = Nothing\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 57883952, "answer_count": 1, "score": 0, "last_activity_date": 1594449616, "creation_date": 1568151488, "last_edit_date": 1594449616, "question_id": 57878535, "link": "https://stackoverflow.com/questions/57878535/add-hyperlink-to-xls-cell-via-variable", "title": "Add Hyperlink to XLS Cell (via variable)", "body": "<p>I am trying to create a hyperlink in XLS (from an MSAccess recordset) using a variable to reference the desired cell and value but I am struggling with syntax.</p>\n\n<p>From MS site, the following works as expected:</p>\n\n<pre><code>With wks1\n   .Hyperlinks.Add Anchor:=.Range(\"a5\"), _\n   Address:=\"https://example.microsoft.com\", _\n   TextToDisplay:=\"Microsoft\"\nEnd With\n</code></pre>\n\n<p>I can write into the desired cell using variables and recordset values as follows:</p>\n\n<pre><code>wks1.Range(\"B\" &amp; r).Value = rs(\"Name\" &amp; n).Value\n\n(where r = XLS cell, i.e., \"B4\", n = rs member, i.e., \"Name5\")\n</code></pre>\n\n<p>When I attempt to Add a hyperlink using the variable approach, it fails (Type Mismatch):</p>\n\n<pre><code>With wks1\n   .Hyperlinks.Add Anchor:=.Range(\"B\" &amp; r).value, _\n   Address:=\"https://example.microsoft.com\", _\n   TextToDisplay:= rs(\"Name\" &amp; n).Value\nEnd With\n</code></pre>\n\n<p>Any suggestions to accomplish this task?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1568151750, "post_id": 57878529, "comment_id": 102181803, "body": "1) What line is throwing the error? 2) Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> -- there are a mass of undeclared variables in your code, including ones whose initialization lies in code that you have not shown. Your code lacks the context required to answer your question (in any way other than a lucky guess)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1568151752, "post_id": 57878529, "comment_id": 102181804, "body": "declare <code>one</code> and <code>two</code> as double."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1568151899, "post_id": 57878529, "comment_id": 102181853, "body": "And make sure the data does not have any strings or errors as those will cause your error."}, {"owner": {"reputation": 3, "user_id": 12049016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac717df86975eb3a04cdc4d7cfecc528?s=128&d=identicon&r=PG&f=1", "display_name": "TheMailOfWork", "link": "https://stackoverflow.com/users/12049016/themailofwork"}, "edited": false, "score": 0, "creation_date": 1568152241, "post_id": 57878529, "comment_id": 102181949, "body": "The error appears on the attempt at subtracting both. I tried declaring one and two as integer but that did not work,"}, {"owner": {"reputation": 3, "user_id": 12049016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac717df86975eb3a04cdc4d7cfecc528?s=128&d=identicon&r=PG&f=1", "display_name": "TheMailOfWork", "link": "https://stackoverflow.com/users/12049016/themailofwork"}, "edited": false, "score": 0, "creation_date": 1568152258, "post_id": 57878529, "comment_id": 102181955, "body": "And pas. is a shortcut for a worksheet."}, {"owner": {"reputation": 3, "user_id": 12049016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac717df86975eb3a04cdc4d7cfecc528?s=128&d=identicon&r=PG&f=1", "display_name": "TheMailOfWork", "link": "https://stackoverflow.com/users/12049016/themailofwork"}, "edited": false, "score": 0, "creation_date": 1568152348, "post_id": 57878529, "comment_id": 102181977, "body": "The commented code is the attempts at other ways for the subtracting. I also attempted to change where i would &quot;save&quot; the subtract. No result."}, {"owner": {"reputation": 3, "user_id": 12049016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac717df86975eb3a04cdc4d7cfecc528?s=128&d=identicon&r=PG&f=1", "display_name": "TheMailOfWork", "link": "https://stackoverflow.com/users/12049016/themailofwork"}, "edited": false, "score": 0, "creation_date": 1568152489, "post_id": 57878529, "comment_id": 102182017, "body": "The code attempts to subtract 2 hours. And place it in an empty cell"}, {"owner": {"reputation": 3, "user_id": 12049016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac717df86975eb3a04cdc4d7cfecc528?s=128&d=identicon&r=PG&f=1", "display_name": "TheMailOfWork", "link": "https://stackoverflow.com/users/12049016/themailofwork"}, "edited": false, "score": 0, "creation_date": 1568152803, "post_id": 57878529, "comment_id": 102182091, "body": "Error shows at: &quot;Cells(q, w) = Cells(e, i).Value - Cells(e, r).Value&quot;"}, {"owner": {"reputation": 3, "user_id": 12049016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac717df86975eb3a04cdc4d7cfecc528?s=128&d=identicon&r=PG&f=1", "display_name": "TheMailOfWork", "link": "https://stackoverflow.com/users/12049016/themailofwork"}, "edited": false, "score": 0, "creation_date": 1568153021, "post_id": 57878529, "comment_id": 102182154, "body": "Tried the &quot;Double&quot; suggestion. No result."}, {"owner": {"reputation": 3, "user_id": 12049016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac717df86975eb3a04cdc4d7cfecc528?s=128&d=identicon&r=PG&f=1", "display_name": "TheMailOfWork", "link": "https://stackoverflow.com/users/12049016/themailofwork"}, "edited": false, "score": 0, "creation_date": 1568153073, "post_id": 57878529, "comment_id": 102182164, "body": "Edited the code, it is now a reproducible example."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1568153797, "post_id": 57878529, "comment_id": 102182323, "body": "Are you sure the data is truly a time and not a string that looks like a time?  Try changing the number format to general, do you get a decimal number?"}, {"owner": {"reputation": 3, "user_id": 12049016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac717df86975eb3a04cdc4d7cfecc528?s=128&d=identicon&r=PG&f=1", "display_name": "TheMailOfWork", "link": "https://stackoverflow.com/users/12049016/themailofwork"}, "edited": false, "score": 0, "creation_date": 1568154669, "post_id": 57878529, "comment_id": 102182501, "body": "It is a time, saved as text in a worksheet, and placed inside another worksheet as an &quot;hour&quot; format.   And now it is a subtract of two hours from within the same worksheet."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1568154956, "post_id": 57878529, "comment_id": 102182564, "body": "<code>saved as text</code>. There you have it. If you change the format of the cell to General, does it show as a number?"}, {"owner": {"reputation": 3, "user_id": 12049016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac717df86975eb3a04cdc4d7cfecc528?s=128&d=identicon&r=PG&f=1", "display_name": "TheMailOfWork", "link": "https://stackoverflow.com/users/12049016/themailofwork"}, "edited": false, "score": 0, "creation_date": 1568155450, "post_id": 57878529, "comment_id": 102182652, "body": "Well, in the 1st worksheet is &quot;text&quot;, but it shows as an Hour.   Then, i copy it to the 2nd worksheet, with the hour format.                         When i attempt the subtract: the popup shows &quot;error 13 mismatch&quot;.      The thing that keeps me busy...... I try the same code elsewhere.... and it Works.  I try in the main work code... And it doesn&#39;t. Do i have to clear the values? even tho i reasign values to them?"}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1568155787, "post_id": 57878529, "comment_id": 102182716, "body": "Lesson one.. always use <code>Option Explicit</code> &amp; Compile your code!"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1568156143, "post_id": 57878529, "comment_id": 102182790, "body": "&quot;elsewhere&quot; the data may be really time values. Again, what happens when you format the cells as &quot;General&quot;? If they don&#39;t change to decimal numbers, they are TEXT and you need to convert them to real time values if you want to do maths with them."}, {"owner": {"reputation": 3, "user_id": 12049016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac717df86975eb3a04cdc4d7cfecc528?s=128&d=identicon&r=PG&f=1", "display_name": "TheMailOfWork", "link": "https://stackoverflow.com/users/12049016/themailofwork"}, "edited": false, "score": 0, "creation_date": 1568157187, "post_id": 57878529, "comment_id": 102182984, "body": "Oh....... I change it to general, nothing happens. Value &quot;05:35&quot; remains the same. It is a text. DEM.   How can i convert them to time values? Without messing with the &quot;hour&quot; format on the cells?  The place where i paste them is in Hour format. Does that change the text value to hour? Or does it remain in Text? Still can&#39;t do math."}, {"owner": {"reputation": 3, "user_id": 12049016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac717df86975eb3a04cdc4d7cfecc528?s=128&d=identicon&r=PG&f=1", "display_name": "TheMailOfWork", "link": "https://stackoverflow.com/users/12049016/themailofwork"}, "edited": false, "score": 0, "creation_date": 1568159324, "post_id": 57878529, "comment_id": 102183359, "body": "Thanks for the help every1. It worked! Had to change the values to &quot;number&quot;. And refrain from recycling variables."}], "answers": [{"tags": [], "owner": {"reputation": 178, "user_id": 2046179, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NKM4P.jpg?s=128&g=1", "display_name": "T4roy", "link": "https://stackoverflow.com/users/2046179/t4roy"}, "is_accepted": true, "score": 0, "last_activity_date": 1568171078, "creation_date": 1568171078, "answer_id": 57881536, "question_id": 57878529, "link": "https://stackoverflow.com/questions/57878529/excel-vba-mismatch/57881536#57881536", "title": "Excel VBA Mismatch", "body": "<p>Why not use a formula? Cells are formatted using 24hr time \"HHmm\" however A1 &amp; B1 data is as per below.</p>\n\n<p>A1 = <code>1:30:00 PM</code> displayed as <code>1330</code></p>\n\n<p>B1 = <code>2:55:00 PM</code> displayed as <code>1455</code></p>\n\n<p>Formula for C1 <code>=IF(OR(A1=\"\",B1=\"\"),0,B1-A1)</code> result displayed as <code>0125</code></p>\n"}], "owner": {"reputation": 3, "user_id": 12049016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac717df86975eb3a04cdc4d7cfecc528?s=128&d=identicon&r=PG&f=1", "display_name": "TheMailOfWork", "link": "https://stackoverflow.com/users/12049016/themailofwork"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 57881536, "answer_count": 1, "score": 0, "last_activity_date": 1568171078, "creation_date": 1568151451, "last_edit_date": 1568152638, "question_id": 57878529, "link": "https://stackoverflow.com/questions/57878529/excel-vba-mismatch", "title": "Excel VBA Mismatch", "body": "<p>Good evening. As the title implies: I require help with an Excel macro, that determines if there's anything in 2 cells, then in a third one the result of their subtract.<br>\nI tried fiddling with the data and cell type. No results.\nUsing: [h]:mm;@  and the data in the cells are \"Time\" in 24H Format.</p>\n\n<pre><code> Dim e As Integer\n Dim r As Integer\n Dim w As Integer\n Dim i As Integer\n Dim q As Integer\n Dim one As String\n Dim two As String\n Dim k as long \n\n q = 3\n w = 5\n e = 3\n r = 3\n i = 4\n\n   For k = 1 To 7\n       one = Cells(e, r).Value\n       two = Cells(e, i).Value\n       If Cells(e, r).Value &gt; 0 And Cells(e, i).Value &gt; 0 Then\n           Cells(q, w) = Cells(e, i).Value - Cells(e, r).Value\n           'pas.Cells(q, w) = two - one\n           'Range(q, w) = Cells(e, i).Value - Cells(e, r).Value\n       else\n           cells(q,w) = 0\n       end if\n   next k\n\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": false, "score": 0, "last_activity_date": 1568153304, "creation_date": 1568153304, "answer_id": 57878777, "question_id": 57878493, "link": "https://stackoverflow.com/questions/57878493/microsoft-access-user-log-of-form-open/57878777#57878777", "title": "Microsoft Access user log of form open", "body": "<p>This will get you the Windows Username:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Environ(\"username\")\n</code></pre>\n\n<p>This will get you the Date &amp; Time:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Now()\n</code></pre>\n\n<p>I would suggest defining a function in a Public Module such as:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function winuser() As String\n    winuser = Environ(\"username\")\nEnd Function\n</code></pre>\n\n<p>And then using the following SQL to insert records into your log table:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>insert into log ([username], [timestamp]) values (winuser(), now())\n</code></pre>\n\n<p>Change <code>log</code>, <code>username</code> &amp; <code>timestamp</code> to the names of your table &amp; fields.</p>\n\n<p>This SQL could then be executed as part of the <code>On Open</code> event for the form.</p>\n"}, {"tags": [], "owner": {"reputation": 2906, "user_id": 7658533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NT8m2.png?s=128&g=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/7658533/unhandled-exception"}, "is_accepted": false, "score": 0, "last_activity_date": 1568181722, "last_edit_date": 1568181722, "creation_date": 1568180623, "answer_id": 57882800, "question_id": 57878493, "link": "https://stackoverflow.com/questions/57878493/microsoft-access-user-log-of-form-open/57882800#57882800", "title": "Microsoft Access user log of form open", "body": "<p>As an addendum for Lee Macs answer:</p>\n\n<p>For security reasons you should use </p>\n\n<pre><code>CreateObject(\"Wscript.Network\").UserName\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>Environ(\"username\")\n</code></pre>\n\n<p>to retrieve to current logged in Windows user because the environment variable <code>username</code> can easily be overwritten (means someone could pretend a different user).</p>\n\n<p>Alternatively, if you prefer, you also can use the Windows API:</p>\n\n<pre><code>Private Declare PtrSafe Function GetUserName Lib \"advapi32.dll\" Alias \"GetUserNameA\" (ByVal lpBuffer As String, nSize As Long) As Long\n\nPublic Function GetWindowsUserName() As String\n    Dim buffer As String * 255\n\n    Dim result As Long\n    result = GetUserName(buffer, 255)\n\n    If result &gt; 0 Then _\n        GetWindowsUserName = Left(buffer, InStr(buffer, Chr(0)) - 1)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11699461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e60ff3ec322b3e2c765dcfae07197772?s=128&d=identicon&r=PG&f=1", "display_name": "CMW", "link": "https://stackoverflow.com/users/11699461/cmw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 141, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1568181722, "creation_date": 1568151241, "question_id": 57878493, "link": "https://stackoverflow.com/questions/57878493/microsoft-access-user-log-of-form-open", "title": "Microsoft Access user log of form open", "body": "<p>I have a Microsoft access database with sql backend. I need a log of windows users with date and time who successfully open a form. I prefer to have the data recorded to a linked sql server table. Is there anyway to achieve this?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1568156574, "post_id": 57878472, "comment_id": 102182885, "body": "Use <code>FSO</code> to create a folder if it doesn&#39;t exist then you can save to the location. Check out <a href=\"https://stackoverflow.com/questions/16909365/check-if-folder-is-there-if-not-create-it-on-current-user-logged-in-vbs\" title=\"check if folder is there if not create it on current user logged in vbs\">stackoverflow.com/questions/16909365/&hellip;</a>"}, {"owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "edited": false, "score": 0, "creation_date": 1568183281, "post_id": 57878472, "comment_id": 102189152, "body": "Sending keystrokes is a dirty hack, there has got to be a better way."}], "owner": {"reputation": 1, "user_id": 12048901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aff2d998092c3c415d0d7cd21f637005?s=128&d=identicon&r=PG&f=1", "display_name": "MarcM", "link": "https://stackoverflow.com/users/12048901/marcm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 15, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568151149, "creation_date": 1568151149, "question_id": 57878472, "link": "https://stackoverflow.com/questions/57878472/creating-a-folder-after-macro-clears-my-clipboard", "title": "Creating a Folder After Macro Clears my Clipboard", "body": "<p>When I paste after running my code, there is nothing in the Clipboard to paste.</p>\n\n<ol>\n<li>Some code concatenates two cell values into a string.</li>\n<li>That string goes to a Data object which is copied to the clipboard</li>\n<li>The next bit of code opens a folder in a Windows Explorer window. I want to manually create the folder (CRTL+SHIFT+N) and paste the string as the name of the folder.</li>\n</ol>\n\n<p>When I use F8 to step through the code, I can confirm that the value is copying to the clipboard properly.</p>\n\n<p>But when I run the code with F5 and manually create the folder, there is nothing there to paste.</p>\n\n<p>I am suspecting that there is something about the (CRTL+SHIFT+N) keystroke that clears the clipboard.</p>\n\n<pre><code>'Looking at the Sheet Name For The Hyperlink Lookup Later\nIf ActiveSheet.Name = \"Submittals\" Then\nDim SubName As String\nDim SubFldr As New MSForms.DataObject\nLinkType = \"Submittal Location\"\n\n'Joining the Cell Values to a string\nSubName = Cells(Application.ActiveCell.Row, 2).Value &amp; \" \" &amp; Cells(Application.ActiveCell.Row, 3).Value\nMsgBox SubName\nSubFldr.SetText Text:=SubName\nSubFldr.PutInClipboard\n\n'Looks up link address from elsewhere in the subroutine and stores it to a variable\nLink = Application.WorksheetFunction.VLookup(Project, Range(\"Project_Table\"), _\n    Application.WorksheetFunction.Match(LinkType, Range(\"Project_Table_Header\"), 0) _\n    , False)\n\n'Opens the Explorer window\nActiveWorkbook.FollowHyperlink Address:=Link\n</code></pre>\n\n<p>It's at this point that I want to manually create a folder (CRTL+SHIFT+N) and paste the SubFldr value that should be in the clipboard.</p>\n\n<p>If I paste in Notepad or else where before creating the folder, the value is there, and I can reuse it.</p>\n\n<p>If I make the folder and then paste (my ultimate goal), there is nothing to paste.</p>\n\n<p>It's likely obvious from my code that I know just enough to get myself into trouble. There are more efficient ways to do what I'm trying to do</p>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 15, "user_id": 11634103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4412e9da8a26162d8fdde6d8e25066e?s=128&d=identicon&r=PG&f=1", "display_name": "jay", "link": "https://stackoverflow.com/users/11634103/jay"}, "is_accepted": false, "score": 0, "last_activity_date": 1568157728, "creation_date": 1568157728, "answer_id": 57879283, "question_id": 57878451, "link": "https://stackoverflow.com/questions/57878451/how-can-i-use-a-range-in-vba-where-the-last-cell-row-is-in-another-cell/57879283#57879283", "title": "How can I use a range in VBA where the last cell row is in another cell?", "body": "<p>I found the answer myself, in case it can be of any use by someone here it is :</p>\n\n<pre><code>Dim numrows As Long\nnumrows = Range(\"AQ1\")\nRange(\"A3:AK\" &amp; numrows).Calculate\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11634103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4412e9da8a26162d8fdde6d8e25066e?s=128&d=identicon&r=PG&f=1", "display_name": "jay", "link": "https://stackoverflow.com/users/11634103/jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 18, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571318620, "creation_date": 1568151025, "last_edit_date": 1571318620, "question_id": 57878451, "link": "https://stackoverflow.com/questions/57878451/how-can-i-use-a-range-in-vba-where-the-last-cell-row-is-in-another-cell", "title": "How can I use a range in VBA where the last cell row is in another cell?", "body": "<p>I am trying to make a button in Excel that calculates a given range (with automatic calculation turned off).</p>\n\n<p>I would normally use this except that I would like the row number of the second cell used to define the range to be pulled from a cell. (in this case the \"50\" would be in another cell).</p>\n\n<p>Range(\"a3:ak50\").Calculate</p>\n\n<p>I dont know where to start !</p>\n\n<p>Range(\"a3:ak50\").Calculate</p>\n"}, {"tags": ["excel", "vba", "copy", "paste"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1568183632, "post_id": 57878436, "comment_id": 102189316, "body": "You might benefit from reading  <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>."}], "answers": [{"tags": [], "owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "is_accepted": false, "score": 0, "last_activity_date": 1568208870, "last_edit_date": 1568208870, "creation_date": 1568157574, "answer_id": 57879275, "question_id": 57878436, "link": "https://stackoverflow.com/questions/57878436/vba-copy-and-pasting-2-rows-down/57879275#57879275", "title": "VBA Copy and Pasting 2 Rows Down", "body": "<p>You can completely avoid using <code>select</code> in order to achieve your goal. In the following code, <code>Source</code> is the range of your table, <code>LastRow</code> finds the last row of your table and <code>DestRng</code> is the destination where you want a copy of your table. Hope this helps!</p>\n\n<pre><code>Sub Macro2()\n'\n' Macro2 Macro\n'\n' Keyboard Shortcut: Ctrl+g\n'\n    Dim TblRng As Range\n    Set TblRng = Range(\"C2:G6\")\n    TblRng.ClearContents\n\n    Dim Source As Range\n    Set Source = Worksheets(\"Sheet2\").Range((\"A2\"), Range(\"G2\").End(xlDown))\n    Source.Copy\n\n    Dim LastRow As Long\n    LastRow = Cells(Rows.Count, \"G\").End(xlUp).Row\n\n    Dim DestRng As Range\n    Set DestRng = Source(LastRow + 1, \"A\")\n    DestRng.PasteSpecial xlPasteAll\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12048997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9576ea199b9e6433a3c3b452719cc69d?s=128&d=identicon&r=PG&f=1", "display_name": "user12048997", "link": "https://stackoverflow.com/users/12048997/user12048997"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568208870, "creation_date": 1568150929, "last_edit_date": 1568183619, "question_id": 57878436, "link": "https://stackoverflow.com/questions/57878436/vba-copy-and-pasting-2-rows-down", "title": "VBA Copy and Pasting 2 Rows Down", "body": "<p>I've only just come across VBA so I'm a complete novice. Essentially I'm currently automating a form that requires writing out the questions, potential answers, instructions, etc. for developers on a spreadsheet. I've created a basic template table so all the questions are structured the same. I want to copy and paste this table (clearing the contents and taking off the number of the question) and paste it 2 rows down from the bottom of the last table. </p>\n\n<p>The code works fine if I just wanted to copy and paste the table directly below the first but I can't go any further than that. I'm not sure how to write that I want it to find the last filled in row and paste the table 2 rows below.</p>\n\n<pre><code>Sub Macro2()\n'\n' Macro2 Macro\n'\n' Keyboard Shortcut: Ctrl+g\n'\n    Range(\"C2:G6\").Select\n    Selection.ClearContents\n\n    Range(\"A2\").Select\n    ActiveCell.FormulaR1C1 = \"C\"\n\n    Range(\"A2:G6\").Select\n    Selection.Copy\n\n    Range(\"A8\").Select\n    ActiveSheet.Paste\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 380, "user_id": 11104095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cc0018af5fc00eb65eaae5dcf4473e6?s=128&d=identicon&r=PG&f=1", "display_name": "K753", "link": "https://stackoverflow.com/users/11104095/k753"}, "edited": false, "score": 0, "creation_date": 1568150750, "post_id": 57878226, "comment_id": 102181480, "body": "Thank you for the advice. It worked but I had to modify it to look like this: DoCmd.OpenForm &quot;frm_InvoiceInfo&quot;, acNormal, , &quot;[Invoice#] = &quot; &amp; &quot;&quot;&quot;&quot; &amp; Me.txtInvNum &amp; &quot;&quot;&quot;&quot;"}], "tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": true, "score": 0, "last_activity_date": 1568149662, "creation_date": 1568149662, "answer_id": 57878226, "question_id": 57878079, "link": "https://stackoverflow.com/questions/57878079/how-to-fix-this-data-type-mismatch-error/57878226#57878226", "title": "How to fix this data type mismatch error?", "body": "<p>If, as you state, your fields are all text values, you should enclose the criteria with single or double quotes, e.g.:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>DoCmd.OpenForm \"frm_InvoiceInfo\", acNormal, , \"[Invoice#] = '\" &amp; Me.txtInvNum &amp; \"'\"\n</code></pre>\n\n<p>Or:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>DoCmd.OpenForm \"frm_InvoiceInfo\", acNormal, , \"[Invoice#] = \"\"\" &amp; Me.txtInvNum &amp; \"\"\"\"\n</code></pre>\n"}], "owner": {"reputation": 380, "user_id": 11104095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cc0018af5fc00eb65eaae5dcf4473e6?s=128&d=identicon&r=PG&f=1", "display_name": "K753", "link": "https://stackoverflow.com/users/11104095/k753"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 231, "favorite_count": 0, "accepted_answer_id": 57878226, "answer_count": 1, "score": 0, "last_activity_date": 1594449642, "creation_date": 1568148785, "last_edit_date": 1594449642, "question_id": 57878079, "link": "https://stackoverflow.com/questions/57878079/how-to-fix-this-data-type-mismatch-error", "title": "How to fix this data type mismatch error?", "body": "<p>I am setting up a database and one of my OpenForm commands is giving a data type mismatch error for the criteria expression. All of the fields involved are formatted as text so I don't know what's causing the error.</p>\n\n<p>I have tried changing the data types of the fields but it hasn't solved the issue.</p>\n\n<pre><code> DoCmd.OpenForm \"frm_InvoiceInfo\", acNormal, , \"[Invoice#] = \" &amp; Me.txtInvNum\n</code></pre>\n\n<p>When txtInvNum is clicked then it should open frm_InvoiceInfo and set the Invoice# field to equal the clicked value.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 3, "creation_date": 1568148097, "post_id": 57877911, "comment_id": 102180674, "body": "I believe <code>Property Get GetSharedFolders()</code> needs to be like <code>Property Get GetSharedFolders() As String</code> for example"}, {"owner": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1568148767, "post_id": 57877911, "comment_id": 102180884, "body": "Nope, that&#39;s not the reason. I&#39;ve updated the code in first message with comment where exception is thrown."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 1, "creation_date": 1568149386, "post_id": 57877911, "comment_id": 102181099, "body": "You have a property let not a sub so the syntax should be e.SetSharedFolders = s"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1568149560, "post_id": 57877911, "comment_id": 102181155, "body": "And that&#39;s not really a property so just make it a sub..."}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1568178021, "post_id": 57877911, "comment_id": 102187467, "body": "My answer updated."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1568189265, "post_id": 57877911, "comment_id": 102191875, "body": "Improve naming by removing Get/Set praefix, the clue of a property is same name for Getter/Setter(Letter). Be aware of <a href=\"http://rubberduckvba.com/Inspections/Details/SelfAssignedDeclaration\" rel=\"nofollow noreferrer\">SelfAssignedDeclaration</a> and you can add default values at<code>Class_Initialize</code>. As Getter gets collection, Setter should set it. For adding a folder create a method<code>Add</code>"}], "answers": [{"comments": [{"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1568153105, "post_id": 57878390, "comment_id": 102182168, "body": "If the OP changes the definition of sharedfolders to variant rather than string then the array statement will work as expected.   The line &#39;e.SetSharedFolders (s)&#39; will work fine if it is changed to e.SetSharedFolders =(s) because the Method SetSharedFolders is a let property not a sub.  There are other errors but these two changes will make the code run."}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "reply_to_user": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1568178063, "post_id": 57878390, "comment_id": 102187478, "body": "@Freeflow: Yes, obvious now that you point that out! I have updated my answer, thanks."}, {"owner": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "edited": false, "score": 0, "creation_date": 1568185357, "post_id": 57878390, "comment_id": 102190023, "body": "Thanks AJD! I&#39;ve missed exactly this thing: <code>The line &#39;e.SetSharedFolders (s)&#39; will work fine if it is changed to e.SetSharedFolders =(s) because the Method SetSharedFolders is a let property not a sub.&quot;</code>"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "reply_to_user": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "edited": false, "score": 0, "creation_date": 1568189547, "post_id": 57878390, "comment_id": 102192008, "body": "@VitaliyPrushak be careful with <a href=\"https://riptutorial.com/vba/example/24427/byref\" rel=\"nofollow noreferrer\">parentheses in procedure calls</a>"}], "tags": [], "owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "is_accepted": true, "score": 1, "last_activity_date": 1568177899, "last_edit_date": 1568177899, "creation_date": 1568150669, "answer_id": 57878390, "question_id": 57877911, "link": "https://stackoverflow.com/questions/57877911/class-constructor-confusion-wrong-number-of-arguments-or-invalid-property-assi/57878390#57878390", "title": "Class constructor confusion - wrong number of arguments or invalid property assignment", "body": "<p>Initially I thought the problem lies in this code:</p>\n\n<pre><code>   i = UBound(sharedFolders)\n\n        i = UBound(sharedFolders)\n        ReDim Preserve sharedFolders(i)\n        sharedFolders(i) = CStr(val)\n</code></pre>\n\n<p><code>i</code> is set twice to the same value, and then the <code>sharedFolders</code> is <code>reDim</code>med to the same value it was before! Also, there is some trickery happening with the use of <code>ix</code> within a 0-based array.</p>\n\n<p>But the problem is most likely how you have declared your variables.</p>\n\n<pre><code>For Each s In a\n    e.SetSharedFolders (s) 'Here comes exception\nNext\n</code></pre>\n\n<p><code>s</code> is a Variant, and <code>a</code> is a Variant. At this point VBA is trying to guess how to handle a <code>For Each</code> loop with two Variants. And then the improper call is made. The correct syntax is:</p>\n\n<pre><code>    e.SetSharedFolders s '&lt;-- no parenthesis\n</code></pre>\n\n<p>There are plenty of posts on StackOverflow explaining how to call routines and what the impact of the evaluating parenthesis are!</p>\n\n<p>However, at this point we are only assuming it is passing in a single element of the array - it could be passing the full array itself (albeit unlikely).</p>\n\n<p>And the third factor - </p>\n\n<pre><code>Public Property Let SetSharedFolders(val As String)\n</code></pre>\n\n<p>The parameter <code>val</code> is being passed <code>ByRef</code> and should be passed <code>ByVal</code>. This also has unintended side effects as I found out (<a href=\"https://stackoverflow.com/questions/57766436/type-mismatch-trying-to-set-data-in-an-object-in-a-collection\">Type mismatch trying to set data in an object in a collection</a>).</p>\n\n<pre><code>Public Property Let SetSharedFolders(ByVal val As String)\n</code></pre>\n\n<p>All in all you have the perfect storm of ambiguity driving to an unknown result.</p>\n\n<p>The answer here is to strongly type your variables. This removes about two layers of ambiguity and areas where errors can happen. In addition, this will slightly improve code execution.</p>\n\n<p>Another aspect is to understand when you should pass something <code>ByVal</code> and when to use the default (preferably explicitly) <code>ByRef</code>.</p>\n\n<p>And a final gratuitous hint: Use a Collection instead of an Array. Your code you have implies a Collection will be more efficient and easier to manage.</p>\n\n<h2>Addendum</h2>\n\n<p>(thanks to @FreeFlow):</p>\n\n<p>If the OP changes the definition of <code>sharedfolders</code> to <code>Variant</code> rather than <code>String()</code> then the array statement will work as expected. </p>\n\n<p>The line <code>e.SetSharedFolders (s)</code> will work fine if it is changed to <code>e.SetSharedFolders = s</code> because the method <code>SetSharedFolders</code> is a <code>Let Property</code> not a <code>Sub</code>. There are other errors but these two changes will make the code run.</p>\n"}], "owner": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 57878390, "answer_count": 1, "score": 0, "last_activity_date": 1568187371, "creation_date": 1568147742, "last_edit_date": 1568187371, "question_id": 57877911, "link": "https://stackoverflow.com/questions/57877911/class-constructor-confusion-wrong-number-of-arguments-or-invalid-property-assi", "title": "Class constructor confusion - wrong number of arguments or invalid property assignment", "body": "<p>I'm having a class module with some data:</p>\n\n<pre><code>Private sharedFolders() As String\n\nPublic Property Let SetSharedFolders(val As String)\n    Dim i As Integer\n\n    sharedFolders = Array(\"folder one\", \"folder two\")\n\n    i = UBound(sharedFolders)\n\n    i = UBound(sharedFolders)\n    ReDim Preserve sharedFolders(i)\n    sharedFolders(i) = CStr(val)\n\nEnd Property\n\nProperty Get GetSharedFolders()\n    GetSharedFolders = sharedFolders()\nEnd Property\n</code></pre>\n\n<p>And I want to add something to this property from other module like this:</p>\n\n<pre><code>Sub PrepareData()\n\n    Dim e\n    Dim s\n    Dim a(2) As String\n\n    Set e = New Entry\n\n    a(0) = \"add one\"\n    a(1) = \"add two\"\n\n    For Each s In a\n        e.SetSharedFolders (s) 'Here comes exception\n    Next\n\n    For Each s In e.GetSharedFolders\n        Debug.Print s\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>But I receive an \"wrong number of arguments or invalid property assignment vba\" exception... Can anyone assist?</p>\n\n<p><strong>Addendum</strong></p>\n\n<p>Thanks to @AJD and @Freeflow to pointing out a mistake and idea to make it easier. Decided to make as like below.</p>\n\n<p>Class Module:</p>\n\n<pre><code>Private sharedFolders As New Collection\n\nPublic Property Let SetSharedFolders(val As String)\n\nIf sharedFolders.Count = 0 Then ' if empty fill with some preset data and add new item\n    sharedFolders.Add \"folder 1\"\n    sharedFolders.Add \"folder 2\"\n    sharedFolders.Add CStr(val)\nElse\n    sharedFolders.Add CStr(val)\nEnd If\n\nEnd Property \n\nProperty Get GetSharedFolders() As Collection\n\nSet GetSharedFolders = sharedFolders\n\nEnd Property\n</code></pre>\n\n<p>and regular module:</p>\n\n<pre><code>Sub AddData()\n\nDim e As New Entry ' creating an instance of a class\nDim s As Variant ' variable to loop through collection\nDim a(1) As String 'some array with data to insert\n\na(0) = \"add one\"\na(1) = \"add two\"\n\nFor Each s In a\n     e.SetSharedFolders = s\nNext\n\nFor Each s In e.GetSharedFolders\n    Debug.Print s\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 563, "user_id": 3493984, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iI51g.jpg?s=128&g=1", "display_name": "LadyCygnus", "link": "https://stackoverflow.com/users/3493984/ladycygnus"}, "is_accepted": false, "score": 0, "last_activity_date": 1569251813, "creation_date": 1569251813, "answer_id": 58065482, "question_id": 57877886, "link": "https://stackoverflow.com/questions/57877886/word-macro-insert-paragraph-with-specific-styles/58065482#58065482", "title": "Word Macro - Insert Paragraph with Specific Styles", "body": "<p>Here is the solution:</p>\n\n<pre><code>Dim BoxStart As Integer\nDim Para As Word.Paragraph\n\nBoxStart = 0\n\nFor Each Para In ActiveDocument.Paragraphs\n    If Para.Format.Style = \"BoxParagraph\" And BoxStart = 0 Then\n        BoxStart = 1\n\n        ' Insert Box Title with tags before start of answer boxes\n        ' Insert paragraph before current paragraph\n        Para.Range.InsertParagraphBefore\n\n        ' Select current paragraph\n        Para.Range.Select\n        ' Move to previous paragraph\n        Selection.MoveUp Unit:=wdParagraph, Count:=1\n        Selection.MoveEnd Unit:=wdCharacter, Count:=-1\n\n        ' format previous pararaph\n        Selection.Paragraphs.Format.Style = \"BoxTitle\"\n\n        ' Testing the flag works correctly\n        ' Debug.Print BoxStart  \n        ' Debug.Print Para.Range.Text\n    ElseIf Para.Format.Style = \"BoxNote\" Then\n        BoxStart = 0\n        ' Debug.Print BoxStart\n    End If\n\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 563, "user_id": 3493984, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iI51g.jpg?s=128&g=1", "display_name": "LadyCygnus", "link": "https://stackoverflow.com/users/3493984/ladycygnus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 243, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1582096089, "creation_date": 1568147622, "last_edit_date": 1582096089, "question_id": 57877886, "link": "https://stackoverflow.com/questions/57877886/word-macro-insert-paragraph-with-specific-styles", "title": "Word Macro - Insert Paragraph with Specific Styles", "body": "<p>My word document template has several local styles that, combined, make a box (boxPara, boxNote, boxTitle, etc). Unfortunately all my boxes are missing the boxTitle paragraphs. My goal is to have a macro that looks for the first boxPara and adds in a blank boxTitle before it - then looks for the boxNote (last item in the box) to reset.</p>\n\n<p>Problem is I'm having difficulty styling the paragraph. The closest I've come is styling the current paragraph wrong, inserting the new paragraph, then re-styling the current paragraph correctly. This seems rather...wrong. And I'd also like to be able to set the text of the inserted paragraph.</p>\n\n<pre><code>Sub addTag()\n\nDim BoxStart As Integer\nDim Para As Word.Paragraph\n\nBoxStart = 0\n\nFor Each Para In ActiveDocument.Paragraphs\n    If Para.Format.Style = \"BoxParagraph\" And BoxStart = 0 Then\n        BoxStart = 1\n        ' Selection.Paragraphs(1).Range.InsertParagraphBefore\n\n        Para.Format.Style = \"BoxTitle\"\n        Para.Range.InsertParagraph\n        Para.Format.Style = \"BoxParagraph\"\n\n        ' Testing the flag works correctly\n        ' Debug.Print BoxStart  \n        ' Debug.Print Para.Range.Text\n    ElseIf Para.Format.Style = \"BoxNote\" Then\n        BoxStart = 0\n        ' Debug.Print BoxStart\n    End If\n\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1568147197, "post_id": 57877671, "comment_id": 102180362, "body": "Haven&#39;t had an extensive read but just a quick search. Would <a href=\"https://stackoverflow.com/q/38666154/9758194\">this</a> help you out?"}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 1, "creation_date": 1568154479, "post_id": 57877671, "comment_id": 102182453, "body": "Method 2 is on the right track. However what you should do is store the range value for the items in the word document (i.,e. you will have an array or word.ranges.  Then for each cell in the table you do a word.range.copy and then into the excel cell you paste the formatted text from the clipboard."}, {"owner": {"reputation": 11, "user_id": 12048705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fb88a2734be43d6104b3276217bf136?s=128&d=identicon&r=PG&f=1", "display_name": "excelshir", "link": "https://stackoverflow.com/users/12048705/excelshir"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1568247258, "post_id": 57877671, "comment_id": 102217246, "body": "Thanks for the repsponses @JvdV but unfortunately I&#39;ve already checked that post and it did not address my issue."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 12048705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fb88a2734be43d6104b3276217bf136?s=128&d=identicon&r=PG&f=1", "display_name": "excelshir", "link": "https://stackoverflow.com/users/12048705/excelshir"}, "edited": false, "score": 0, "creation_date": 1568247466, "post_id": 57879034, "comment_id": 102217290, "body": "Thanks the reply @Freeflow but unfortunately I tried this and it didn&#39;t seem to work. The result was a series of pasted pictures in my Excel spreadsheet. I think I may have found a workaround solution though. I will post as soon as I have a chance. Thanks for your help!"}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "reply_to_user": {"reputation": 11, "user_id": 12048705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fb88a2734be43d6104b3276217bf136?s=128&d=identicon&r=PG&f=1", "display_name": "excelshir", "link": "https://stackoverflow.com/users/12048705/excelshir"}, "edited": false, "score": 0, "creation_date": 1568271493, "post_id": 57879034, "comment_id": 102222942, "body": "You might also try  &#39;.PasteSpecial Format:=&quot;HTML&quot;, Link:=False, DisplayAsIcon:=   False&#39; . This keeps the formatting but puts one paragraph per cell."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "reply_to_user": {"reputation": 11, "user_id": 12048705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fb88a2734be43d6104b3276217bf136?s=128&d=identicon&r=PG&f=1", "display_name": "excelshir", "link": "https://stackoverflow.com/users/12048705/excelshir"}, "edited": false, "score": 0, "creation_date": 1568271845, "post_id": 57879034, "comment_id": 102223097, "body": "You might be better pasting links from your excel into Word."}, {"owner": {"reputation": 11, "user_id": 12048705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fb88a2734be43d6104b3276217bf136?s=128&d=identicon&r=PG&f=1", "display_name": "excelshir", "link": "https://stackoverflow.com/users/12048705/excelshir"}, "edited": false, "score": 0, "creation_date": 1568307766, "post_id": 57879034, "comment_id": 102242341, "body": "Interesting approach @Freeflow, but I need the paragraphs to stay in the same cell, and not be distributed one paragraph per cell (creating more rows in the spreadsheet). I also need to copy from Word to Excel, and not the other way around. Unless you are suggesting some other workaround for pasting links?"}], "tags": [], "owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "is_accepted": false, "score": 0, "last_activity_date": 1568155319, "creation_date": 1568155319, "answer_id": 57879034, "question_id": 57877671, "link": "https://stackoverflow.com/questions/57877671/how-to-copy-table-from-word-to-excel-while-preserving-formatting/57879034#57879034", "title": "How to copy table from Word to Excel while preserving formatting", "body": "<p>Following on from my comment, the following might work.  I can't test as I don't have your source data</p>\n\n<pre><code>Sub Method02_Array()\n\nDim r As Integer\nDim c As Intege\n\nFor r = 1 To 10\n    For c = 1 To 10\n        ActiveDocument.Tables(1).Cell(r + 1, c).Range.Copy\n        ActiveWorkbook.Sheets(1).Cells(r, c).Range.PasteSpecial operation:=xlPasteSpecialOperationNone, Paste:=xlPasteAll\n    Next c\nNext r\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14256685, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/8d7c548d934a4f9157b762f8b6074a71?s=128&d=identicon&r=PG", "display_name": "Sharon", "link": "https://stackoverflow.com/users/14256685/sharon"}, "is_accepted": false, "score": 0, "last_activity_date": 1600168356, "last_edit_date": 1600168356, "creation_date": 1599768085, "answer_id": 63836896, "question_id": 57877671, "link": "https://stackoverflow.com/questions/57877671/how-to-copy-table-from-word-to-excel-while-preserving-formatting/63836896#63836896", "title": "How to copy table from Word to Excel while preserving formatting", "body": "<p>For pasting multiple lines from Word or a pdf into a single cell in Excel - click on the cell, press F2, then paste the text. That keeps it all in one cell. However it does not keep the formatting including colors and strikeouts</p>\n"}], "owner": {"reputation": 11, "user_id": 12048705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fb88a2734be43d6104b3276217bf136?s=128&d=identicon&r=PG&f=1", "display_name": "excelshir", "link": "https://stackoverflow.com/users/12048705/excelshir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 598, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1600168356, "creation_date": 1568146581, "last_edit_date": 1582096034, "question_id": 57877671, "link": "https://stackoverflow.com/questions/57877671/how-to-copy-table-from-word-to-excel-while-preserving-formatting", "title": "How to copy table from Word to Excel while preserving formatting", "body": "<p>I've been coding VBA for many years but this one is a real head-scratcher.</p>\n\n<p><strong>The task is simple</strong> - Copy data from a table from Microsoft Word to Microsoft Excel.</p>\n\n<p><strong>The challenge:</strong> Maintain the formatting of the data from Word, which includes bulleted lists and multiple paragraphs. More specifically, I need to include all that formatted text from a cell from the Word table inside a single cell in the corresponding Excel table.</p>\n\n<p>Solutions I've already tried and specifically where I got stuck:</p>\n\n<hr>\n\n<p><strong>METHOD 01:</strong> Select the entire table in Word, select a single cell in Excel, and paste.</p>\n\n<pre><code>Sub Method01_CopyAndPaste()\n\nActiveDocument.Tables(1).Select\nDocuments(1).ActiveWindow.Selection.Copy\nCells(1, 1).Select\nActiveSheet.Paste\n\nEnd Sub\n</code></pre>\n\n<p><strong>PROBLEM WITH METHOD 01:</strong> Excel creates multiple rows and merged cells whenever there are multiple paragraphs in the Word Table.</p>\n\n<hr>\n\n<p><strong>METHOD 02:</strong> Loop through the Word table, and assign all the contents to a Array (variant). Then loop through the Excel table and assign the values from the Array into the table.</p>\n\n<pre><code>Sub Method02_Array()\n\nDim r As Integer\nDim c As Integer\nDim AryTblData(1 To 10, 1 To 10) As Variant\n\n'Loop through the 10x10 Source table and assign all values to 2 dimensional array\nFor r = 1 To 10\n    For c = 1 To 10\n        AryTblData(r, c) = ActiveDocument.Tables(1).Cell(r + 1, c)\n    Next c\nNext r\n\n'Paste the array values into the activesheet starting at cell(1,1)\nFor r = 1 To 10\n    For c = 1 To 10\n        Cells(r, c) = WorksheetFunction.Clean(AryTblData(r, c))\n    Next c\nNext r\n\nEnd Sub\n</code></pre>\n\n<p>PROBLEM WITH METHOD 02: The formatting is not preserved. Specifically, the bullet points do not appear in the Excel table.</p>\n\n<hr>\n\n<p><strong>METHOD 03:</strong> Use Application.Sendkeys to simulate the process of manually going to one cell of the Word table, copying it, going to the corresponding cell in the Excel table, pasting it, pressing {TAB} to go to the next cell, and then repeating this process for the total number of cells in the table.</p>\n\n<pre><code>Sub Method03_Sendkeys()\n\nDim r As Integer\nDim c As Integer\n\n'Loop through the 3x3 Source table and simulate sending keys to copy and paste, cell by cell\nFor r = 1 To 3\n    For c = 1 To 3\n\n        'Activate Microsoft Word window\n        AppActivate (\"word\"), True\n\n        'Select the appropriate cell in the Word table (based on the For Loop)\n        ActiveDocument.Tables(1).Cell(r, c).Select\n\n        'In Word, copy the selection\n        Application.SendKeys \"^c\", True\n\n        'Activate Microsoft Excel window\n            'Note: I'm not sure why AppActivate (\"excel\") does not work, but\n            'for some reason Application.caption works for me.\n        AppActivate Application.Caption, True\n\n        'Select the appropriate cell in the active Excel worksheet (based on the For Loop)\n        Cells(r, c).Select\n\n        'In Excel, edit cell contents\n        Application.SendKeys \"{F2}\", True\n\n        'In Excel, Paste\n        Application.SendKeys \"^v\", True\n\n        'In Excel, Save changes to cell and move 1 cell to the right\n        Application.SendKeys \"{TAB}\", True\n\n    Next c\nNext r\n\nEnd Sub\n</code></pre>\n\n<p><strong>PROBLEM WITH METHOD 03:</strong> It works with only 1 cell, but as soon as I attempt to get more than one cell copied and pasted over, the result is the same data over and over again across multiple cells.</p>\n\n<hr>\n\n<p><strong>QUESTION:</strong> Is this task even possible to achieve in VBA? I'd love to find a simple and elegant solution, but at this point I would settle for something that WORKS.</p>\n\n<p>Thanks so much for your help!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1568148875, "post_id": 57877640, "comment_id": 102180920, "body": "So are you looking to insert the <code>msoShapeRightArrow</code> and <code>msoShapeLeftArrow</code> on each worksheet in your workbook through VBA on the same position with predefined measurements and assign a macro to them that will activate the sheet before/after?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1568149127, "post_id": 57877640, "comment_id": 102181006, "body": "You can avoid the use of <code>Selection</code> by capturing the result of <code>Shapes.AddConnector</code> (and removing <code>.Select</code>) into a local object variable, or heck the <code>With</code> block could even own it: <code>With Item_Estimate_Sheet.Shapes.AddConnector(...)</code>"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1568149131, "post_id": 57877640, "comment_id": 102181009, "body": "More or less yes.  I have some code that will create a worksheet for every item selected in a list.  As that sheet gets created I was going to add the arrow shape."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1568149214, "post_id": 57877640, "comment_id": 102181035, "body": "@MathieuGuindon  I thought I had tried it with the with and got an error...been doing a lot of editing so I will have to go back and double check that iteration and see if it was nothing else causing issues."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1568149303, "post_id": 57877640, "comment_id": 102181061, "body": "Removing the <code>.Select</code> is key though"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1568150341, "post_id": 57877640, "comment_id": 102181372, "body": "The correct syntax (I think) would be to set a shape object which you can then access it&#39;s properties like : <code>Set shp = Item_Estimate_Sheet.Shapes.AddShape(msoShapeRightArrow, 859.5, 35.25, 25.5, 19.5)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1568159941, "post_id": 57878569, "comment_id": 102183455, "body": "JvdV you have the gist of what I am after.  I was chunking my code together from different sources.  What you are showing here reads a heck of a lot nicer and also has the next step for me built of linking the shape to some code in a sub.  I&#39;ll try it out when I am back at work tomorrow and have some free time."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568171443, "post_id": 57878569, "comment_id": 102186149, "body": "++ Nice one :) I do this slightly <a href=\"https://prnt.sc/p4j3sr\" rel=\"nofollow noreferrer\">differently</a> :D"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568208602, "post_id": 57878569, "comment_id": 102202121, "body": "@SiddharthRout Nice screen shot...are those graphics built into Excel or are they a custom graphic?  We were discussing how a graphic can be much easier/quicker to interpret than a bunch of buttons with text on them that need reading."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1568208701, "post_id": 57878569, "comment_id": 102202179, "body": "@ForwardEd Custome Graphics downloaded from web and the entire &quot;menu shape&quot; is stored in a settings sheet. So basically, no need to create it again and again. Just copy it when the new worksheet is created."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1568209824, "post_id": 57878569, "comment_id": 102202842, "body": "I would go with <code>&quot;Previous&quot;</code> instead of <code>&quot;Last&quot;</code>, but otherwise, I concur. Nice answer"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568210471, "post_id": 57878569, "comment_id": 102203217, "body": "@SiddharthRout  I just want to toss your description back in my own words to make sure I have the understanding correct.  The graphic(s) (3 separate buttons or 1 big button?) are placed in a worksheet that is stored in the file and probably hidden.  When the buttons need to be added to a worksheet, they are simply referenced from that storage sheet using some modified code that does something similar to add shape?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1568211245, "post_id": 57878569, "comment_id": 102203625, "body": "@ForwardEd: The 3 buttons and the rectangle are a group. They already are connected to the relevant macros. They are placed in a hidden sheet. When a new sheet is added, I simply copy the shape(group) and paste it in the new sheet. As simple as that. Let me know if you want me to post an answer. (Obviously it doesn&#39;t answer your question but can be an alternative)"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568211515, "post_id": 57878569, "comment_id": 102203775, "body": "@SiddharthRout would love to see it as an alternative if you don&#39;t mind.  Even if I do not use it directly, I am sure I will learn a new technique or two.  May even be helpful to some futr user that stumbles on this Q."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568211754, "post_id": 57878569, "comment_id": 102203901, "body": "@SiddharthRout No rush.  I just had a stack of CAD drawings dumped on my desk so I will be busy with actual work related stuff for a good chunk of the dat now.  Wont get back to tinkering with coding for 4 hours or more."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 1, "creation_date": 1568212553, "post_id": 57878569, "comment_id": 102204385, "body": "@JvdV Because I am inserting the Navigation arrows as the sheet is created, I am dropping the for each loop.  Thank you for including that as FOR EACH for whatever reason tends to be a stumbling block for me and I avoid using it.  I was not familiar with the VBA Array(&quot;Last&quot;,&quot;Next&quot;)  So I definitely learned something new there and I can see this being useful on some other things I have done.  Especially for initializing an array it a known setup.  I have decided to leave your code a a standalone sub which I will call from the INSEert SHEET routine and I will just pass it the SHT and ref cells."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1568213586, "post_id": 57878569, "comment_id": 102204986, "body": "@ForwardEd, that seems to me like a very nice way to implement things! Well done :)"}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 4, "last_activity_date": 1568152085, "last_edit_date": 1568152085, "creation_date": 1568151756, "answer_id": 57878569, "question_id": 57877640, "link": "https://stackoverflow.com/questions/57877640/adding-basic-shape-left-right-arrow-as-a-clickable-previous-next-button/57878569#57878569", "title": "Adding Basic shape left/right arrow as a clickable previous/next button", "body": "<p>I'll put this up, but I'm quite unsure what exactly your aim is with the <code>.Line</code> property of the <code>.ShapeRange</code> object. So my take on this is to just insert some arrows, assign them a <code>.Name</code> and <code>.OnAction</code> while further on I grouped them to assign more common properties like <code>.Fill</code>.</p>\n\n<p>Obviously it's a draft but you might be able to get some understanding how (I think) it's done.</p>\n\n<pre><code>Sub InsertArrows()\n\nDim rngL As Range, rngR As Range\nDim shpL As Shape, shpR As Shape\n\nFor Each sht In ThisWorkbook.Sheets\n    Set rngL = sht.Range(\"B2\")\n    Set rngR = sht.Range(\"C2\")\n\n    Set shpL = sht.Shapes.AddShape(msoShapeLeftArrow, rngL.Left, rngL.Top, rngL.Width, rngL.Height)\n    With shpL\n        .Name = \"Last\"\n        .OnAction = \"LastSheet\"\n    End With\n\n    Set shpR = sht.Shapes.AddShape(msoShapeRightArrow, rngR.Left, rngR.Top, rngR.Width, rngR.Height)\n    With shpR\n        .Name = \"Next\"\n        .OnAction = \"NextSheet\"\n    End With\n\n    Set shpRng = sht.Shapes.Range(Array(\"Last\", \"Next\"))\n    With shpRng\n        .Fill.ForeColor.RGB = RGB(255, 0, 0)\n        .Line.ForeColor.RGB = RGB(255, 0, 0)\n        'More common properties.....\n    End With\nNext sht\n\nEnd Sub\n\nSub LastSheet()\n    'Some code to get to the last sheet \nEnd Sub\n\nSub NextSheet()\n    'Some code to get to the next sheet \nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/iq2wl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iq2wl.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1568218032, "post_id": 57891721, "comment_id": 102207432, "body": "Thank you for the detailed explanation.  Its a nice easy read to follow.  I have not had a chance to play with it yet.  I have not looked into the previous/next routines yet as I was thinking I would need to make some adjustments as I was guessing +1/-1 to the index would not work in my case.  I had not considered hidden sheets so thanks for putting that on my radar.  In my case sheet can be added a any time, but they get sorted alphabetically.  Meaning the 17th sheet to be created may wind up being the 3rd sheet in the tabs list."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1568218159, "post_id": 57891721, "comment_id": 102207510, "body": "I was assuming the worksheet index was the same as list on the left when you are in the VBA editor.  oh and to top it off, I have an exception list for the sort routine so about 3-4 sheets are not included in the sort and are locked as first few sheets and last few sheets.  Fun stuff to wrap my head around when I have time to sit down and think about it."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1568227260, "post_id": 57891721, "comment_id": 102211381, "body": "Good news...apparently my understanding of sheet index number and the way they are displayed in the project menu are completely different.  Life just become easier!  Again thanks for showing me this approach."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1568426196, "post_id": 57891721, "comment_id": 102280869, "body": "What is the purpose of the DoEvents line after adjusting the position of the shape?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1568437360, "post_id": 57891721, "comment_id": 102281998, "body": "Just giving Excel time. Usually it would not be required here but becuase the <code>.Activate</code> I wanted Excel to finish whatever it is doing."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 4, "last_activity_date": 1568213314, "creation_date": 1568213314, "answer_id": 57891721, "question_id": 57877640, "link": "https://stackoverflow.com/questions/57877640/adding-basic-shape-left-right-arrow-as-a-clickable-previous-next-button/57891721#57891721", "title": "Adding Basic shape left/right arrow as a clickable previous/next button", "body": "<p><strong>Note</strong>: As mentioned in the comments this is not an answer but on OPs request, I am posting this alternative.</p>\n\n<p>For demonstration purpose I have two sheets in a workbook. One is called <strong>HOME</strong> and the other is called <strong>SETTINGS</strong>. <em>Link to Sample File is given at the end of the post</em></p>\n\n<p>I have downloaded 3 shapes from the web. Feel free to choose any other images.</p>\n\n<ol>\n<li><a href=\"https://www.kissclipart.com/home-button-html-clipart-button-computer-icons-cli-2ecg51/\" rel=\"nofollow noreferrer\">Home Button</a></li>\n<li><a href=\"https://pixabay.com/vectors/arrow-button-navigation-right-blue-30330/\" rel=\"nofollow noreferrer\">Next Button</a></li>\n<li><a href=\"https://imgbin.com/png/ExRunE8z/arrow-button-computer-icons-png\" rel=\"nofollow noreferrer\">Back Button</a></li>\n</ol>\n\n<p>Paste this code in a module</p>\n\n<pre><code>Option Explicit\n\nDim thisSheetCount As Long\nDim nextSheetCount As Long\nDim totSheetCount As Long\n\nSub InsertNewSheet()\n    Dim ws As Worksheet\n    Dim wsSettings As Worksheet\n    Dim shpOrig As Shape, shpN As Shape\n\n    Set wsSettings = Sheet1\n    Set shpOrig = wsSettings.Shapes(\"MyMenu\")\n\n    Set ws = ThisWorkbook.Sheets.Add(After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))\n\n    shpOrig.Copy\n    ws.Paste\n\n    Set shpN = ws.Shapes(1)\n    With shpN\n        .Top = shpOrig.Top\n        .Left = shpOrig.Left\n    End With\n    DoEvents\n    [A1].Activate\nEnd Sub\n\nSub NextSheet()\n    thisSheetCount = ActiveSheet.Index\n    totSheetCount = ThisWorkbook.Sheets.Count\n\n    nextSheetCount = thisSheetCount + 1\n\n    If nextSheetCount &gt; totSheetCount Then\n        MsgBox \"No more sheets\"\n        Exit Sub\n    End If\n\n    Do While nextSheetCount &lt;= totSheetCount\n        If ThisWorkbook.Sheets(nextSheetCount).Visible = False Then\n            nextSheetCount = nextSheetCount + 1\n        Else\n            ThisWorkbook.Sheets(nextSheetCount).Activate\n            Exit Do\n        End If\n\n        If nextSheetCount &gt; totSheetCount Then\n            MsgBox \"No more visible sheets found\"\n        End If\n    Loop\nEnd Sub\n\nSub PrevSheet()\n    thisSheetCount = ActiveSheet.Index\n    nextSheetCount = thisSheetCount - 1\n\n    If nextSheetCount &lt; 1 Then\n        MsgBox \"No more sheets\"\n        Exit Sub\n    End If\n\n    Do While nextSheetCount &gt;= 1\n        If ThisWorkbook.Sheets(nextSheetCount).Visible = False Then\n            nextSheetCount = nextSheetCount - 1\n        Else\n            ThisWorkbook.Sheets(nextSheetCount).Activate\n            Exit Do\n        End If\n\n        If nextSheetCount &lt; 1 Then\n            MsgBox \"No more visible sheets found\"\n        End If\n    Loop\nEnd Sub\n\nSub HomeSheet()\n    ThisWorkbook.Sheets(\"Home\").Visible = True\n    ThisWorkbook.Sheets(\"Home\").Activate\nEnd Sub\n</code></pre>\n\n<p>Next I insert a rectangle shape in <strong>SETTINGS</strong> sheet. Then I insert the 3 shapes and resize them as shown below</p>\n\n<p><a href=\"https://i.stack.imgur.com/UPh8g.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UPh8g.png\" alt=\"enter image description here\"></a></p>\n\n<p>Right click on the <strong>previous</strong> button and click on <em>Assign Macro</em>. Connect it to <code>Sub PrevSheet()</code>. Similarly, connect <strong>next</strong> button to <code>Sub NextSheet()</code> and finally connect <strong>home</strong> button to <code>Sub HomeSheet()</code></p>\n\n<p>Next, group the Shapes. Call them <strong>MyMenu</strong> or whatever you want. I will use <strong>MyMenu</strong> for demonstration purpose.</p>\n\n<p>Next Copy the shape and paste it in the <strong>HOME</strong> Sheet. Ungroup the shape and delete the <strong>previous</strong> and the <strong>home</strong> button. <strong>HOME</strong> sheet is supposed to be the left most sheet and should always remain visible.</p>\n\n<p>Insert a button in the <strong>HOME</strong> sheet and let's call it \"Insert New Sheet\". Assign <code>Sub InsertNewSheet()</code> to this button.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Li2QH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Li2QH.png\" alt=\"enter image description here\"></a></p>\n\n<p>Hide the <strong>SETTINGS</strong> Sheet and we are done.</p>\n\n<p>To test it simply click on the <code>Insert New Sheet</code> button.</p>\n\n<p>One thing that I would like to point out regarding the <strong>Next</strong> and the <strong>Previous</strong> button code is that, it has been tweaked to work only for visible workssheets. For example: Insert 4 worksheets and hide the 3rd one. Go to the 2nd sheet and click on next button. See what happens. Also check what happens when you click on the next button in the last worksheet.</p>\n\n<p><strong>Screenshot in action</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/CmUzZ.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CmUzZ.gif\" alt=\"enter image description here\"></a></p>\n\n<p>Sample File can be downloaded from <a href=\"https://www.dropbox.com/s/1u9njlyupbwt39r/Shapes%20Menu%20Example.xlsm?dl=0\" rel=\"nofollow noreferrer\">HERE</a></p>\n"}], "owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 616, "favorite_count": 1, "accepted_answer_id": 57878569, "answer_count": 2, "score": 3, "last_activity_date": 1568213314, "creation_date": 1568146465, "last_edit_date": 1568150131, "question_id": 57877640, "link": "https://stackoverflow.com/questions/57877640/adding-basic-shape-left-right-arrow-as-a-clickable-previous-next-button", "title": "Adding Basic shape left/right arrow as a clickable previous/next button", "body": "<p>I am looking at writing a little bit of VBA code that will change displayed worksheet to the previous or next sheet in the order of the tabs.</p>\n\n<p>I found <a href=\"https://stackoverflow.com/questions/39376995/excel-vba-insert-arrow-macro\">this stackoverflow question</a> which talks about adding an arrow, but its more like a leader arrow (red in the picture).</p>\n\n<p><a href=\"https://i.stack.imgur.com/SwdxP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SwdxP.png\" alt=\"example 1\"></a></p>\n\n<p>I want to add the LEFT or RIGHT arrow from the Insert ribbon -> illustrations section -> Shapes drop down:</p>\n\n<p><a href=\"https://i.stack.imgur.com/whOwf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/whOwf.png\" alt=\"example 2\"></a></p>\n\n<p>The snipit of code I am using is:</p>\n\n<pre><code>Dim l As Long\nDim t As Long\n\nl = Range(\"O3\").Left\nt = Range(\"Q3\").Top\n\nItem_Estimate_Sheet.Shapes.AddConnector(msoConnectorStraight, t + 89.25, l + 89.25, l, t).Select\n\nWith Selection\n    With .ShapeRange.Line\n        .EndArrowheadStyle = msoArrowheadOpen\n        .Visible = msoTrue\n        .ForeColor.RGB = RGB(255, 0, 0)\n        .Transparency = 0\n        .Weight = 1.5\n    End With\nEnd With\n</code></pre>\n\n<p>What I am hoping to add is something that looks like the following which I added manually:</p>\n\n<p><a href=\"https://i.stack.imgur.com/FqVzk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FqVzk.png\" alt=\"example 3\"></a></p>\n\n<p>Part B</p>\n\n<p>Avoiding use of select.  I hear on here time and time again that select is to be avoided and its not required.  I tried removing select and when I did this, it caused an error.  A .something seems to be required at the the end of the add shape line.  Is there a better way to do this?  </p>\n\n<p>Part C: Is there a way to get the dimensions/ properties of the shape you inserted other than recording a macro at the time of insertion?  (and damn why did I not remember to record a macro)</p>\n\n<p><strong><em>UPDATE:</em></strong></p>\n\n<p>so I recorded a macro and edited my code as follow:</p>\n\n<pre><code>Item_Estimate_Sheet.Shapes.AddShape(msoShapeRightArrow, 859.5, 35.25, 25.5, 19.5).Select\n\nWith Selection\n    With .ShapeRange.Line\n        .Name = \"NEXT\"\n        .Top = Range(\"S3\").Top\n        .Left = Range(\"S3\").Left\n        .Width = Range(\"Q3\").Width * 2\n        .Height = Range(\"Q3\").Height * 2\n    End With\nEnd With\n</code></pre>\n\n<p>when I got rid of the select as follows it threw an error..something about not acceptable method:</p>\n\n<pre><code>With Item_Estimate_Sheet.Shapes.AddShape(msoShapeRightArrow, 859.5, 35.25, 25.5, 19.5)\n\n    With .ShapeRange.Line\n        .Name = \"NEXT\"\n        .Top = Range(\"S3\").Top\n        .Left = Range(\"S3\").Left\n        .Width = Range(\"Q3\").Width * 2\n        .Height = Range(\"Q3\").Height * 2\n    End With\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1568143294, "post_id": 57877007, "comment_id": 102178796, "body": "The limit of FormulaArray is 255 characters."}, {"owner": {"reputation": 1044, "user_id": 10068520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f18bb002969dd5d8e5cd6ed739e5f917?s=128&d=identicon&r=PG&f=1", "display_name": "OverflowStacker", "link": "https://stackoverflow.com/users/10068520/overflowstacker"}, "edited": false, "score": 0, "creation_date": 1568178357, "post_id": 57877007, "comment_id": 102187557, "body": "The first formula has over 400 characters"}], "answers": [{"tags": [], "owner": {"reputation": 1044, "user_id": 10068520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f18bb002969dd5d8e5cd6ed739e5f917?s=128&d=identicon&r=PG&f=1", "display_name": "OverflowStacker", "link": "https://stackoverflow.com/users/10068520/overflowstacker"}, "is_accepted": false, "score": 0, "last_activity_date": 1568180759, "last_edit_date": 1568180759, "creation_date": 1568178970, "answer_id": 57882519, "question_id": 57877007, "link": "https://stackoverflow.com/questions/57877007/array-formula-not-working-in-vba-recorded-macro/57882519#57882519", "title": "Array Formula Not Working in VBA - Recorded Macro", "body": "<p>As @Scott Craner alread mentioned, there is a limit of 255 character for a formula array in vba.</p>\n\n<p>You should set </p>\n\n<pre><code>Application.DisplayAlerts = False\nApplication.Calculation = xlManual\n</code></pre>\n\n<p>at start and </p>\n\n<pre><code>Application.DisplayAlerts = True\nApplication.Calculation = xlAutomatic\n</code></pre>\n\n<p>at the end.</p>\n\n<p>You need to set dummy-strings for parts of the formula array (<code>'CA Tax Spreadsheet'!</code> -> <code>xx</code>) and write this edited formula-array to a cell. Afterwards you use the worksheet function (!!!) replace (<code>cell.replace</code>) to replace the dummy-strings with their original values.</p>\n\n<p>This way you can circumvent the 255 character limitation of formula array in vba.</p>\n"}], "owner": {"reputation": 21, "user_id": 11875801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23f4d0d7a38d7c101331a21c2dfdfc83?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/11875801/jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 451, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568184522, "creation_date": 1568143137, "last_edit_date": 1568184522, "question_id": 57877007, "link": "https://stackoverflow.com/questions/57877007/array-formula-not-working-in-vba-recorded-macro", "title": "Array Formula Not Working in VBA - Recorded Macro", "body": "<p>I am attempting to speed up a spreadsheet with a lot of array formulas by recording a macro and applying the formula to those cells, then copy and paste as values. I get the \"Run-time error 1004: Unable to set the FormulaArray proprety of the Range Class\".</p>\n\n<p>I am trying to do a reconciliation between two sets of data: Sheet\"CA Tax Spreadsheet\" and \"XSP Events\". I am using an array formula to search for the information in columns C and D together in CA Tax Spreadsheet tab in the XSP Events tab and vice versa. I then want to list all the information that doesn't match. I then use another array formula to list all of the exceptions while skipping blanks (i then use this information to grab information from other columns to display nicely on another sheet). This means there are four columns with array formulas: FORMULA 1 COLUMN A - showing the items in CA Tax Spreadsheet that aren't in XSP Events, FORMULA 2 COLUMN B- showing the items in XSP Events that aren't in CA Tax Spreadsheet, FORMULA 3 COLUMN C - showing all the items missing in XSP Events without blanks and FORMULA 4 COLUMN D - showing all the items missing in CA Tax Spreadsheet without blanks. These formulas all get dragged down to row 1000, which slows down the spreadsheet drastically. There are also formulas on SHEET1 which perform an INDEX MATCH on the information provided in COLUMNS C/D, grabbing information from columns C-F in CA Tax Spreadsheet and XSP Events. Because of this I tried to record a macro and apply the formulas this way, then copy and paste the values to try and speed it up. The macro crashes on FORMULA 1. I do not have much experience with Macros nor arrays so if there is a better way to speed up what I am doing please let me know. </p>\n\n<pre><code>Sub Macro_TEST1()\n'\n' Macro_TEST1 Macro\n'\n\n'\n    Sheets(\"Calculations\").Activate\n    Range(\"A2:A1000\").FormulaArray = _\n        \"=IF(OR((AND(('CA Tax Spreadsheet'!RC[5]=\"\"M\"\"),('CA Tax Spreadsheet'!RC[8]&lt;TODAY()))),(AND(('CA Tax Spreadsheet'!RC[5]=\"\"V\"\"),('CA Tax Spreadsheet'!RC[7]&lt;TODAY()),ISNUMBER('CA Tax Spreadsheet'!RC[7]))),('CA Tax Spreadsheet'!RC[6]=\"\"ADR Foreign Tax\"\")),\"\"\"\",IF((ISNUMBER(INDEX('XSP Events'!C:C[13],MATCH(1,((TEXT('CA Tax Spreadsheet'!RC[2],0))='XSP Events'!C[2])*('CA T\" &amp; _\n        \"ax Spreadsheet'!RC[3]='XSP Events'!C[3]),0),1))),\"\"\"\",'CA Tax Spreadsheet'!RC[3]))\" &amp; _\n        \"\"\n    Range(\"B2:B1000\").FormulaArray = _\n        \"=IF(ISNUMBER((INDEX('CA Tax Spreadsheet'!C1:C10,MATCH(1,((VALUE('XSP Events'!RC[1]))='CA Tax Spreadsheet'!C[1])*('XSP Events'!RC[2]='CA Tax Spreadsheet'!C[2]),0),1))),\"\"\"\",IF('XSP Events'!RC[2]=\"\"\"\",\"\"\"\",'XSP Events'!RC[2]))\"\n    Range(\"C2:C1000\").FormulaArray = _\n        \"=IFERROR(INDEX(C1, SMALL(IF(LEN(C1)=0,\"\"\"\", ROW(C1)-MIN(ROW(C1))+1), ROW(RC[-2]))),\"\"\"\")\"\n    Range(\"D2:D1000\").FormulaArray = _\n        \"=IFERROR(INDEX(C2, SMALL(IF(LEN(C2)=0,\"\"\"\", ROW(C2)-MIN(ROW(C2))+1), ROW(RC[-3]))),\"\"\"\")\"\n    Sheets(\"Reconciliation\").Activate\n    Range(\"A6:E1000\").FormulaR1C1 = _\n        \"=IF(Calculations!R[-4]C3=\"\"\"\",\"\"\"\",INDEX('CA Tax Spreadsheet'!C[2],MATCH(Calculations!R[-4]C3,'CA Tax Spreadsheet'!C4,0)))\"\n    Range(\"H6:1000\").FormulaR1C1 = _\n        \"=IF(Calculations!R[-4]C4=\"\"\"\",\"\"\"\",INDEX('XSP Events'!C[-5],MATCH(Calculations!R[-4]C4,'XSP Events'!C4,0)))\"\n    With ActiveSheet.UsedRange\n        .Value = .Value\n    End With\nEnd Sub\n</code></pre>\n\n<p>The macro crashes here:</p>\n\n<pre><code>Range(\"A2:A1000\").FormulaArray = _\n        \"=IF(OR((AND(('CA Tax Spreadsheet'!RC[5]=\"\"M\"\"),('CA Tax Spreadsheet'!RC[8]&lt;TODAY()))),(AND(('CA Tax Spreadsheet'!RC[5]=\"\"V\"\"),('CA Tax Spreadsheet'!RC[7]&lt;TODAY()),ISNUMBER('CA Tax Spreadsheet'!RC[7]))),('CA Tax Spreadsheet'!RC[6]=\"\"ADR Foreign Tax\"\")),\"\"\"\",IF((ISNUMBER(INDEX('XSP Events'!C:C[13],MATCH(1,((TEXT('CA Tax Spreadsheet'!RC[2],0))='XSP Events'!C[2])*('CA T\" &amp; _\n        \"ax Spreadsheet'!RC[3]='XSP Events'!C[3]),0),1))),\"\"\"\",'CA Tax Spreadsheet'!RC[3]))\" &amp; _\n        \"\"\n</code></pre>\n\n<p>I've tried applying it separately or just to 1 cell and it still does not apply. The other formulas are applied without issue.</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9399127, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UySiKCCOGKM/AAAAAAAAAAI/AAAAAAAAACY/LjjRkePBECk/photo.jpg?sz=128", "display_name": "Aimee", "link": "https://stackoverflow.com/users/9399127/aimee"}, "edited": false, "score": 0, "creation_date": 1568195582, "post_id": 57877997, "comment_id": 102195092, "body": "I thought I had put all of my code in but it is not showing. The rows being added need to loop also until every row has a blank row under it. The number of rows vary depending on the PPT they were exported from. So some have 42 rows and some have 50 plus rows. Thanks"}, {"owner": {"reputation": 3, "user_id": 9399127, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UySiKCCOGKM/AAAAAAAAAAI/AAAAAAAAACY/LjjRkePBECk/photo.jpg?sz=128", "display_name": "Aimee", "link": "https://stackoverflow.com/users/9399127/aimee"}, "edited": false, "score": 0, "creation_date": 1568204280, "post_id": 57877997, "comment_id": 102199550, "body": "I checked the code and the first row works properly with the thumbnail in row 1, column 2 and the text in row 2, column 2. But  in Row 3, column 2 (should have a thumbnail) is blank. The text did move to Row 4, Column 2."}, {"owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "reply_to_user": {"reputation": 3, "user_id": 9399127, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UySiKCCOGKM/AAAAAAAAAAI/AAAAAAAAACY/LjjRkePBECk/photo.jpg?sz=128", "display_name": "Aimee", "link": "https://stackoverflow.com/users/9399127/aimee"}, "edited": false, "score": 0, "creation_date": 1568222130, "post_id": 57877997, "comment_id": 102209281, "body": "Sorry, your comments are more confusing then enlightening. Your original question was how to create a <i>loop</i>. Feel free to modify the code I posted to meet your specific needs."}, {"owner": {"reputation": 3, "user_id": 9399127, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UySiKCCOGKM/AAAAAAAAAAI/AAAAAAAAACY/LjjRkePBECk/photo.jpg?sz=128", "display_name": "Aimee", "link": "https://stackoverflow.com/users/9399127/aimee"}, "edited": false, "score": 0, "creation_date": 1568223803, "post_id": 57877997, "comment_id": 102209985, "body": "I appreciate your help. sorry for being confusing. I tried modifying the code. It worked but it also deleted the items I didn&#39;t want deleted. This is what I had  - Row 1, column 2 has a thumbnail image in it. Row 1, column 3 has text in it. I was trying to cut Row 1, column 3 (text) and paste the text in Row 2, column 2."}, {"owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "reply_to_user": {"reputation": 3, "user_id": 9399127, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UySiKCCOGKM/AAAAAAAAAAI/AAAAAAAAACY/LjjRkePBECk/photo.jpg?sz=128", "display_name": "Aimee", "link": "https://stackoverflow.com/users/9399127/aimee"}, "edited": false, "score": 0, "creation_date": 1568226097, "post_id": 57877997, "comment_id": 102210880, "body": "I modified the VBA to add <i>Step 2</i> in the For loop. Then it will just work on every second row."}], "tags": [], "owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "is_accepted": true, "score": 0, "last_activity_date": 1568226037, "last_edit_date": 1568226037, "creation_date": 1568148217, "answer_id": 57877997, "question_id": 57876603, "link": "https://stackoverflow.com/questions/57876603/is-there-a-way-to-create-a-loop-that-adds-rows-to-a-table-and-moving-content-fro/57877997#57877997", "title": "Is there a way to create a loop that adds rows to a table and moving content from one cell to another?", "body": "<p>Where possible, try to use the Range object instead of Selection. It's faster and more reliable. Cut and Paste is also slow and only needed if there is local formatting that needs to be preserved. With statements can also speed up your code and eliminate redundant code.</p>\n\n<pre><code>Sub MoveTableContent()\n  With Documents(\"TableMoveData.docm\").Tables(1)\n    .Rows.Add BeforeRow:=.Rows(8)\n    .Rows.Add BeforeRow:=.Rows(10)\n    For x = 1 To .Rows.Count Step 2\n      .Cell(Row:=x + 1, Column:=2).Range.Text = .Cell(Row:=x, Column:=3).Range.Text\n      .Cell(Row:=x, Column:=3).Range.Text = \"\"\n    Next x\n  End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9399127, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UySiKCCOGKM/AAAAAAAAAAI/AAAAAAAAACY/LjjRkePBECk/photo.jpg?sz=128", "display_name": "Aimee", "link": "https://stackoverflow.com/users/9399127/aimee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 57877997, "answer_count": 1, "score": 0, "last_activity_date": 1568226037, "creation_date": 1568140938, "last_edit_date": 1568141707, "question_id": 57876603, "link": "https://stackoverflow.com/questions/57876603/is-there-a-way-to-create-a-loop-that-adds-rows-to-a-table-and-moving-content-fro", "title": "Is there a way to create a loop that adds rows to a table and moving content from one cell to another?", "body": "<p>I am creating storyboards from PowerPoint. I export the PowerPoint into a word document that creates a table with the notes in the column next to the thumbnail of the slide. I need the notes under the thumbnail. My solution is to add a row under Row 1 and move the content from Row 1, Column 3 to Row 2, Column 2.</p>\n\n<p>The code I have works fine but a loop would be better instead of typing in every row to add and every cell to cut and paste.</p>\n\n<pre><code>Documents(\"Slide 1.docm\").Tables(1).Rows(7).Select\nSelection.InsertRowsBelow 1\n\nDocuments(\"Slide 1.docm\").Tables(1).Rows(9).Select\nSelection.InsertRowsBelow 1\n\nDocuments(\"Slide 1.docm\").Tables(1).Cell(Row:=1, Column:=3).Select\nSelection.Cut\nDocuments(\"Slide 1.docm\").Tables(1).Cell(Row:=2, Column:=2).Select\nSelection.Paste\n\nDocuments(\"Slide 1.docm\").Tables(1).Cell(Row:=3, Column:=3).Select\n   Selection.Cut\nDocuments(\"Slide 1.docm\").Tables(1).Cell(Row:=4, Column:=2).Select\nSelection.Paste\n\nDocuments(\"Slide 1.docm\").Tables(1).Cell(Row:=5, Column:=3).Select\n   Selection.Cut\nDocuments(\"Slide 1.docm\").Tables(1).Cell(Row:=6, Column:=2).Select\nSelection.Paste\n\nDocuments(\"Slide 1.docm\").Tables(1).Cell(Row:=7, Column:=3).Select\n   Selection.Cut\nDocuments(\"Slide 1.docm\").Tables(1).Cell(Row:=8, Column:=2).Select\nSelection.Paste\n\nDocuments(\"Slide 1.docm\").Tables(1).Cell(Row:=9, Column:=3).Select\n   Selection.Cut\nDocuments(\"Slide 1.docm\").Tables(1).Cell(Row:=10, Column:=2).Select\nSelection.Paste\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 1, "creation_date": 1568140852, "post_id": 57876423, "comment_id": 102177880, "body": "You should also disable events with <code>Application.EnableEvents = False</code>, then re-enable at the end of the sub."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 2, "creation_date": 1568141655, "post_id": 57876423, "comment_id": 102178161, "body": "Is there a reason to select anything? See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">this</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1568144310, "post_id": 57876423, "comment_id": 102179210, "body": "Don&#39;t <code>Select</code> stuff, the <code>Selection</code> won&#39;t be flying around =)"}, {"owner": {"reputation": 11, "user_id": 12048376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcfed9fd59e3d3c7c28385d5c5ce3fbb?s=128&d=identicon&r=PG&f=1", "display_name": "nojoxanor", "link": "https://stackoverflow.com/users/12048376/nojoxanor"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1568154028, "post_id": 57876423, "comment_id": 102182368, "body": "@cybernetic.nomad the reason to &quot;select nothing&quot; is to get out the focus (selection) from the cell that should behave as a button (not allowing changes, etc..)"}, {"owner": {"reputation": 11, "user_id": 12048376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcfed9fd59e3d3c7c28385d5c5ce3fbb?s=128&d=identicon&r=PG&f=1", "display_name": "nojoxanor", "link": "https://stackoverflow.com/users/12048376/nojoxanor"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1568154057, "post_id": 57876423, "comment_id": 102182372, "body": "@PeterT, thanks, but this do not avoid the flying around"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 1, "creation_date": 1568204879, "post_id": 57876423, "comment_id": 102199947, "body": "We&#39;re having a difficult time understanding what your real issue is without a clearer explanation of the purpose of the form and the workflow you&#39;re trying to establish. A small reproducible example to illustrate what you mean would be perfect. The advice you&#39;ll get in response will be much closer to a real solution for you."}, {"owner": {"reputation": 11, "user_id": 12048376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcfed9fd59e3d3c7c28385d5c5ce3fbb?s=128&d=identicon&r=PG&f=1", "display_name": "nojoxanor", "link": "https://stackoverflow.com/users/12048376/nojoxanor"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1568218263, "post_id": 57876423, "comment_id": 102207552, "body": "@PeterT, thanks, I edit with a simulation and a little explanation"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1568219124, "post_id": 57876423, "comment_id": 102207981, "body": "@nojoxanor You haven&#39;t really explained anything. You keep saying that you <i>have to</i> select, but it&#39;s not clear why. You don&#39;t need to select anything at the beginning of a macro, but you can capture the pre-existing <code>Selection</code> in a Range variable as the user input. You don&#39;t need to select anything in the middle of a macro at all. You may need to select your A1 in the end of the macro if it is your requirement to have this cell selected at the end, but then it is only one <code>Select</code> call."}, {"owner": {"reputation": 11, "user_id": 12048376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcfed9fd59e3d3c7c28385d5c5ce3fbb?s=128&d=identicon&r=PG&f=1", "display_name": "nojoxanor", "link": "https://stackoverflow.com/users/12048376/nojoxanor"}, "edited": false, "score": 0, "creation_date": 1568222381, "post_id": 57876423, "comment_id": 102209392, "body": "@nojoxanor, I have to allow the user select cells so I can capture &quot;what he want to do&quot; (and allow to write in the red cells) ,      I use the select &quot;back to A1&quot; to allow, for example, click twice on the PLUS sign, or to take out the selection after chose a option."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1568226867, "post_id": 57876423, "comment_id": 102211234, "body": "Your design looks like you&#39;re not using any form controls; all your controls exist as regular cells and you process the user actions when certain cells are selected. Is this correct?  If that is correct, then I&#39;m puzzled by the &quot;flying selection&quot; rectangle. Without any controls on the worksheet, the only selections available should be of one or more cells -- therefore the selection rectangle should ONLY show as a border around cells. Yours is clearly floating above the worksheet. This can only really happen if you&#39;re using form controls. What controls are you using?"}, {"owner": {"reputation": 11, "user_id": 12048376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcfed9fd59e3d3c7c28385d5c5ce3fbb?s=128&d=identicon&r=PG&f=1", "display_name": "nojoxanor", "link": "https://stackoverflow.com/users/12048376/nojoxanor"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1568227236, "post_id": 57876423, "comment_id": 102211372, "body": "@PeterT, yes, indeed I only used basic-cells, and program them (there is hundrers and adding real-controls will be a pain), and get the by selection change"}, {"owner": {"reputation": 11, "user_id": 12048376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcfed9fd59e3d3c7c28385d5c5ce3fbb?s=128&d=identicon&r=PG&f=1", "display_name": "nojoxanor", "link": "https://stackoverflow.com/users/12048376/nojoxanor"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1568227298, "post_id": 57876423, "comment_id": 102211395, "body": "@PeterT, I was happy getting the selection box (printsecreen) as it was flying from A1 to the click on &quot;Send Questionaire&quot;  [thanks for the edit and pasting the picture]"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1568227886, "post_id": 57876423, "comment_id": 102211626, "body": "At this point, I think we&#39;ll have to see more code in your <code>Worksheet_SelectionChange</code> routine in order to figure out why the <code>Application.ScreenUpdating</code> is not solving your problem."}, {"owner": {"reputation": 11, "user_id": 12048376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcfed9fd59e3d3c7c28385d5c5ce3fbb?s=128&d=identicon&r=PG&f=1", "display_name": "nojoxanor", "link": "https://stackoverflow.com/users/12048376/nojoxanor"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1568228472, "post_id": 57876423, "comment_id": 102211928, "body": "@PeterT, I do not have the code yet, I am just planning. Application.ScreenUpdating does not hide the &quot;flying animation&quot;, It helps a lot for the colouring, cells updates, calculations  etc..."}, {"owner": {"reputation": 11, "user_id": 12048376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcfed9fd59e3d3c7c28385d5c5ce3fbb?s=128&d=identicon&r=PG&f=1", "display_name": "nojoxanor", "link": "https://stackoverflow.com/users/12048376/nojoxanor"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1568228524, "post_id": 57876423, "comment_id": 102211956, "body": "@PeterT, my only issue, is with the flying animation, back and forth, if I do not want the focus to keep in the selected cell bu the user"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 12048376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcfed9fd59e3d3c7c28385d5c5ce3fbb?s=128&d=identicon&r=PG&f=1", "display_name": "nojoxanor", "link": "https://stackoverflow.com/users/12048376/nojoxanor"}, "edited": false, "score": 0, "creation_date": 1568153844, "post_id": 57878253, "comment_id": 102182337, "body": "Hi,  thanks for the Application.EnableEvents = False but behiviour keeps the same"}, {"owner": {"reputation": 11, "user_id": 12048376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcfed9fd59e3d3c7c28385d5c5ce3fbb?s=128&d=identicon&r=PG&f=1", "display_name": "nojoxanor", "link": "https://stackoverflow.com/users/12048376/nojoxanor"}, "edited": false, "score": 0, "creation_date": 1568153910, "post_id": 57878253, "comment_id": 102182346, "body": "and sorry I need to &quot;select&quot;, as I need to allow users to click on some cells (free-text edits) and on others that will look like buttons (but I do not want to left selection on those)"}, {"owner": {"reputation": 11, "user_id": 12048376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcfed9fd59e3d3c7c28385d5c5ce3fbb?s=128&d=identicon&r=PG&f=1", "display_name": "nojoxanor", "link": "https://stackoverflow.com/users/12048376/nojoxanor"}, "edited": false, "score": 0, "creation_date": 1568154156, "post_id": 57878253, "comment_id": 102182400, "body": "Can I get the &quot;selected cell&quot; before the selection occurs in some way?  ( i am thinking like Java events)"}], "tags": [], "owner": {"reputation": 26, "user_id": 8430983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3e91b3004f02564fb645ca21028961d?s=128&d=identicon&r=PG&f=1", "display_name": "Mateusz_G", "link": "https://stackoverflow.com/users/8430983/mateusz-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1568149805, "creation_date": 1568149805, "answer_id": 57878253, "question_id": 57876423, "link": "https://stackoverflow.com/questions/57876423/excel-how-can-i-hide-the-selection-box-flying-around/57878253#57878253", "title": "Excel: How can I hide the Selection Box flying around?", "body": "<p>Maybe this is not the answer that you have been waiting for, but as Mathieu mentioned in his comment, please try to avoid using Selection.</p>\n\n<p>It does make things slower and often causes errors (in example try selecting cell from hidden sheet). Instead just do something with the range that you define with your if statements directly. Every property of Cell or Range can be accessed directly.</p>\n\n<p>Hope it helps.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 12048376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcfed9fd59e3d3c7c28385d5c5ce3fbb?s=128&d=identicon&r=PG&f=1", "display_name": "nojoxanor", "link": "https://stackoverflow.com/users/12048376/nojoxanor"}, "edited": false, "score": 1, "creation_date": 1568222217, "post_id": 57893446, "comment_id": 102209321, "body": "thanks, thats help, still do not solve my problem, but something helps"}], "tags": [], "owner": {"reputation": 364, "user_id": 7396038, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4aedcdf7a0a92da7a96d9bc21f692545?s=128&d=identicon&r=PG&f=1", "display_name": "pGrnd2", "link": "https://stackoverflow.com/users/7396038/pgrnd2"}, "is_accepted": false, "score": 0, "last_activity_date": 1568219774, "creation_date": 1568219774, "answer_id": 57893446, "question_id": 57876423, "link": "https://stackoverflow.com/questions/57876423/excel-how-can-i-hide-the-selection-box-flying-around/57893446#57893446", "title": "Excel: How can I hide the Selection Box flying around?", "body": "<p>Not sure how you can achieve you \"flying select box\" problem, but at least you could add this code, so opening/closing groups are available on protected sheets:</p>\n\n<pre><code>'Password Protect Current Sheet\nActiveSheet.Protect Password:=\"Add_here_your_password\", UserInterfaceOnly:=True\n\n'Enable Group Collapse/Expand Capabilities\nActiveSheet.EnableOutlining = True\n</code></pre>\n\n<p>How about trying to remove the \"back to A1\" as much as possible? </p>\n\n<p>Maybe do it only on absolutely necessary, or move back to the changed value (the 33 in your example), or to the question title (in your multi-option example)</p>\n"}], "owner": {"reputation": 11, "user_id": 12048376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcfed9fd59e3d3c7c28385d5c5ce3fbb?s=128&d=identicon&r=PG&f=1", "display_name": "nojoxanor", "link": "https://stackoverflow.com/users/12048376/nojoxanor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 165, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1568224465, "creation_date": 1568140054, "last_edit_date": 1568224465, "question_id": 57876423, "link": "https://stackoverflow.com/questions/57876423/excel-how-can-i-hide-the-selection-box-flying-around", "title": "Excel: How can I hide the Selection Box flying around?", "body": "<p>I have the following code to simulate some cells behave like buttons</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n   'Application.ScreenUpdating = False\n   If Target.Cells.Count = 1 Then\n       '~~~~~~ pseudocode ~~~~~~\n       If {select cell is one of the chose ones}\n            {do some stuff}\n       End If\n       '~~~~~~ pseudocode ~~~~~~\n   End If\n\n   Range(\"A1\").Select\n   'Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>It doesn't matter whereas I use the ScreenUpdating code, the \"Selection box\" is flying around from A1 to the selected cell and back and it make the sheet much slower.</p>\n\n<p><strong>Can this flying (animation) selection box be stoped?</strong></p>\n\n<p>So far I have found this, not possible to hide, but noting about the flying efect:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/44160665/hide-the-cell-selection-box-in-excel\">Hide the cell selection box in Excel</a></p>\n\n<hr>\n\n<p>Edit:</p>\n\n<p>I need (I think so) edit capabilities on the sheet, therefore the option of not changing selection cell is not applicable. Due to:</p>\n\n<ul>\n<li><p>most of the sheet is informative, and should be available for copy (not edited)</p></li>\n<li><p>some cells are input forms (free text thing), selection as usual</p></li>\n<li><p>some cells should behave like buttons (plus/minus for a numeric value, sclaes, simple stuff, but thousand of then, so much easier do/maintain by code), and user must not edit them</p></li>\n<li><p>grouping should be available, (so that's complicate protecting the sheet)</p></li>\n</ul>\n\n<p>I am not closed to the option : Range(\"A1\").Select after each (most) of user interaction, but no other method comes into mind to me now.</p>\n\n<hr>\n\n<p>An example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/XiC0X.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XiC0X.png\" alt=\"enter image description here\"></a></p>\n\n<p>I know some would say: \"you should make this out from excel\", and I agree with you, but this is a mandatory thing, I do not have the power to raise this question</p>\n\n<ul>\n<li><p>As you can see, I got the \"flying selection\" that I try to get rid off</p></li>\n<li><p>cell A1 is already hodden, that will do most of the trick </p></li>\n<li><p>final version sure will go with hidden gridlines and headlines</p></li>\n<li><p>rows groups exist, and are important, so no protection possible</p></li>\n<li><p>all the functionality, I can do easy with vba, just problem with the animation</p></li>\n</ul>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11, "user_id": 11909189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9d56e8305ad1453e98fa48f64c66bb8?s=128&d=identicon&r=PG&f=1", "display_name": "bear21", "link": "https://stackoverflow.com/users/11909189/bear21"}, "edited": false, "score": 0, "creation_date": 1568140022, "post_id": 57876314, "comment_id": 102177515, "body": "@MarkS. Kind of my thinking, but just the task i was given"}, {"owner": {"reputation": 1052, "user_id": 11820046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73032e9cdf06875fff17231806ccfee7?s=128&d=identicon&r=PG&f=1", "display_name": "Mark S.", "link": "https://stackoverflow.com/users/11820046/mark-s"}, "edited": false, "score": 1, "creation_date": 1568140043, "post_id": 57876314, "comment_id": 102177525, "body": "This is a <a href=\"https://stackoverflow.com/questions/57808548/coloring-a-cell-based-on-the-text-of-another-cell/57808640#57808640\">duplicate question</a>"}, {"owner": {"reputation": 1052, "user_id": 11820046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73032e9cdf06875fff17231806ccfee7?s=128&d=identicon&r=PG&f=1", "display_name": "Mark S.", "link": "https://stackoverflow.com/users/11820046/mark-s"}, "edited": false, "score": 1, "creation_date": 1568140093, "post_id": 57876314, "comment_id": 102177554, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/57808548/coloring-a-cell-based-on-the-text-of-another-cell\">Coloring a cell based on the text of another cell</a>"}, {"owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "reply_to_user": {"reputation": 1052, "user_id": 11820046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73032e9cdf06875fff17231806ccfee7?s=128&d=identicon&r=PG&f=1", "display_name": "Mark S.", "link": "https://stackoverflow.com/users/11820046/mark-s"}, "edited": false, "score": 0, "creation_date": 1568140881, "post_id": 57876314, "comment_id": 102177890, "body": "@MarkS. it&#39;s not a &quot;possible&quot; duplicate, it&#39;s the exact same question. bear21 asked that one as well, apparently he didn&#39;t like your answer."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1568142876, "post_id": 57876314, "comment_id": 102178650, "body": "Can you show more of your code.  And please explain <code>I basically am trying to write something in formula format</code> are you trying to do this through a UDF called from the sheet?"}, {"owner": {"reputation": 1052, "user_id": 11820046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73032e9cdf06875fff17231806ccfee7?s=128&d=identicon&r=PG&f=1", "display_name": "Mark S.", "link": "https://stackoverflow.com/users/11820046/mark-s"}, "reply_to_user": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1568144871, "post_id": 57876314, "comment_id": 102179424, "body": "@MilesFett the second one was system generated from the flag."}], "answers": [{"tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 0, "last_activity_date": 1568144903, "creation_date": 1568144903, "answer_id": 57877355, "question_id": 57876314, "link": "https://stackoverflow.com/questions/57876314/conditional-formatting-changing-cell-color-based-on-another-cells-text/57877355#57877355", "title": "Conditional Formatting - Changing cell color based on another cells text", "body": "<p>I think that your issue is you have not set the <code>lastrow</code>, you also need to identify the workbook and sheet references.  </p>\n\n<pre><code>Dim cel As Range, lastrow As Long\n\nlastrow = ThisWorkbook.Sheets(\"Sheet1\").UsedRange.Rows.Count 'sets the number of used rows\n\n    'loop through each cell in Col27 from row 14 to the lastrow + 12 \n    For Each cel In ThisWorkbook.Sheets(\"Sheet1\").Range(\"AA14:AA\" &amp; lastrow + 12)             \n        If cel.Value = \"Simple\" Then 'test cell value for condition\n            cel.Offset(, -26).Interior.ColorIndex = 5 'if condition is met then offset to first cell in row and color\n        End If\n    Next cel 'loop to next cell\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11909189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9d56e8305ad1453e98fa48f64c66bb8?s=128&d=identicon&r=PG&f=1", "display_name": "bear21", "link": "https://stackoverflow.com/users/11909189/bear21"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568184484, "creation_date": 1568139584, "last_edit_date": 1568184484, "question_id": 57876314, "link": "https://stackoverflow.com/questions/57876314/conditional-formatting-changing-cell-color-based-on-another-cells-text", "title": "Conditional Formatting - Changing cell color based on another cells text", "body": "<p>Currently trying to debug my code. I want the first cell of the row to change a specific color based on the text in a cell in the same row. The text that is conditional is based in a drop-down list that the user manually inputs when the macro gets done running. </p>\n\n<pre><code>    For polerow = 14 To lastrow + 12\n        If Cells(polerow, 27).Value = \"Simple\" Then\n            Cells(polerow, 1).Interior.ColorIndex = 5\n            '.Cells(PoleRow,1).Interior.Colorindex = 5\n        End If\n    Next\n</code></pre>\n\n<p>I basically am trying to write something in formula format. The text that is conditional is \"Simple\". Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 1, "creation_date": 1568140306, "post_id": 57876297, "comment_id": 102177657, "body": "<a href=\"https://stackoverflow.com/questions/40441436/function-with-multiple-parameters\">This</a> may help."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1568140588, "post_id": 57876297, "comment_id": 102177768, "body": "@MilesFett ah yes, I came across <code>paramarray</code> once when Tim Williams mentioned it... it was not light reading XD"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 1, "creation_date": 1568141035, "post_id": 57876297, "comment_id": 102177932, "body": "@MilesFett nevermind, <code>typename</code> may be what I need, thanks! Edit: I still will repeat lots of code though?"}], "answers": [{"comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1568141453, "post_id": 57876643, "comment_id": 102178080, "body": "<code>enum</code> is not a bad idea. I guess I could call a function within a function. Something worth exploring thanks!"}], "tags": [], "owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "is_accepted": false, "score": 1, "last_activity_date": 1568141162, "creation_date": 1568141162, "answer_id": 57876643, "question_id": 57876297, "link": "https://stackoverflow.com/questions/57876297/function-to-handle-various-conditionsarguments/57876643#57876643", "title": "Function to handle various conditions(arguments)", "body": "<p>I'm not sure it's going to save a lot of typing, but if you want to manipulate a testing condition without having to rewrite it all the time, you could create a <code>Compare</code> function that takes the type of comparison as an argument.</p>\n\n<p>You could have a new type that you define as follow at the top of the module</p>\n\n<pre><code>Enum ComparisonType\n  vbEquality = 1\n  vbBigger = 2\n  vbSmaller = 4\nEnd Enum\n</code></pre>\n\n<p>And then the function could look like this</p>\n\n<pre><code>Function Compare(ByVal lhs As Variant, ByVal rhs As Variant, ComparisonType As ComparisonType) As Boolean\n\n    If ComparisonType = vbEquality Then\n\n        If lhs = rhs Then\n            Compare = True\n        End If\n\n    ElseIf ComparisonType = vbBigger Then\n\n        If lhs &gt; rhs Then\n            Compare = True\n        End If\n\n    ElseIf ComparisonType = vbSmaller Then\n\n        If lhs &lt; rhs Then\n            Compare = True\n        End If\n\n    End If\n\nEnd Function\n</code></pre>\n\n<p>And since the different comparisons have a different values (powers of two in this case), you could use a method that calculates the type of comparison you want based on different conditions that are being combined into a single number.</p>\n"}, {"tags": [], "owner": {"reputation": 644, "user_id": 8671209, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212727830903077/picture?type=large", "display_name": "Thomas Ludewig", "link": "https://stackoverflow.com/users/8671209/thomas-ludewig"}, "is_accepted": false, "score": 0, "last_activity_date": 1568141812, "creation_date": 1568141812, "answer_id": 57876768, "question_id": 57876297, "link": "https://stackoverflow.com/questions/57876297/function-to-handle-various-conditionsarguments/57876768#57876768", "title": "Function to handle various conditions(arguments)", "body": "<p>You will not really get rid of the case thing until you decide to put everything in variants. but you can ease your life dramatically :)</p>\n\n<pre><code>     dim n1  as long \n     n1=  UBound(arrSource,1) 'dimension 1\n     dim n2 as long \n     n2  UBound(arrSource,2) 'dimension '2\n\n     For i = 1 to n1\n     For j = 1 to n2\n\n     var data=arrSource(i,j)\n\n\n     'now you could convert everyting to string or variant \n      VT= VarType(data) \n\n                Select Case  VT\n\n                    Case vbDouble\n\n                         dim d as double \n                         d=cdbl(data)     'or \n                         dim v as variant \n                         v=data\n\n\n                    Case vbString  '8\n\n                    Case vbEmpty    '0\n\n                    Case vbNull  '1\n\n                    Case vbInteger    '2\n\n                    Case vbLong    '3\n\n                    Case vbSingle    '4\n\n                    Case vbDouble  '5\n\n                    Case vbCurrency  '6\n\n                    Case vbDate  '7\n\n                    Case vbObject    '9\n\n                    Case vbError    '10\n\n                    Case vbBoolean    '11\n\n                    Case vbVariant    '12\n\n                    Case vbDataObject    '13\n\n                    Case vbDecimal    '14\n\n                    Case vbByte    '15\n\n                    Case Else\n\n                End Select\n\n     now do your calculations with the single data element\n     'and convert it back if you want \n     Select Case  VT'w know already what was data before\n\n                    Case vbDouble\n                       data=cdbl(v)\n                    Case vbString  '8\n\n                    Case vbEmpty    '0\n\n                    Case vbNull  '1\n\n                    Case vbInteger    '2\n\n                    Case vbLong    '3\n\n                    Case vbSingle    '4\n\n                    Case vbDouble  '5\n\n                    Case vbCurrency  '6\n\n                    Case vbDate  '7\n\n                    Case vbObject    '9\n\n                    Case vbError    '10\n\n                    Case vbBoolean    '11\n\n                    Case vbVariant    '12\n\n                    Case vbDataObject    '13\n\n                    Case vbDecimal    '14\n\n                    Case vbByte    '15\n\n                    Case Else\n\n                End Select\n\n\n\n     next\n     next \n</code></pre>\n\n<p>And for sure both select trees you could develop to functions</p>\n\n<pre><code>          function convertback(data,vt) as variant\n               select case(vt)\n                    Case vbDouble\n\n                       data=cdbl(v)\n\n                    Case vbString  '8\n\n                    Case vbEmpty    '0\n\n                    Case vbNull  '1\n\n                    Case vbInteger    '2\n\n                    Case vbLong    '3\n\n                    Case vbSingle    '4\n\n                    Case vbDouble  '5\n\n                    Case vbCurrency  '6\n\n                    Case vbDate  '7\n\n                    Case vbObject    '9\n\n                    Case vbError    '10\n\n                    Case vbBoolean    '11\n\n                    Case vbVariant    '12\n\n                    Case vbDataObject    '13\n\n                    Case vbDecimal    '14\n\n                    Case vbByte    '15\n\n                    Case Else\n\n                End Select\n            convertback= data\n            end function\n</code></pre>\n\n<p>Hope this helps a bit</p>\n"}], "owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1568141812, "creation_date": 1568139491, "last_edit_date": 1568139975, "question_id": 57876297, "link": "https://stackoverflow.com/questions/57876297/function-to-handle-various-conditionsarguments", "title": "Function to handle various conditions(arguments)", "body": "<p>I have rows of data that I need to segregate based on different criteria. I am trying to write one function to capture all the conditions but not sure how to architect it. My first thought is using a case statement perhaps? That still repeats a lot of code.</p>\n\n<pre><code>Sub stackoverflow()\n'first criteria is string\nhold = \"Yes\"\narrTarget = populate(hold)\nwsHold.Range(\"A2\").Resize(UBound(arrTarget), UBound(arrTarget, 2)) = arrTarget\n\n'second criteria is date\ndueDate = InputBox(\"Enter cut off date for check run\" &amp; vbCrLf &amp; \"date entered is inclusive\" &amp; vbCrLf &amp; \"(any format works?)\")\narrTarget = populate(dueDate)\nwsNext.Range(\"A2\").Resize(UBound(arrTarget), UBound(arrTarget, 2)) = arrTarget\n\n\nEnd Sub\n\nFunction populate(arg As Variant) As Variant\n\nDim wsSource As Worksheet\nDim lastRow As Long\nDim arrSource As Variant\nDim arrReturn As Variant\n\nSet wsSource = ActiveWorkbook.Worksheets(\"Sheet1\")\n\nWith wsSource\n\nlastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\narrSource = .Range(\"A2:L\" &amp; lastRow) 'store source range into source array\n\nSelect Case arg 'some puesdo code to follow\ncase string\n    For i = 1 To UBound(arrSource)\n        If arrSource(i, 9) = arg Then\n            k = k + 1\n        End If\n    Next\n\n    ReDim arrReturn(1 To k, 1 To UBound(arrSource, 2))\n\n    k = 0\n\n    For i = 1 To UBound(arrSource)\n        If arrSource(i, 9) = arg Then\n            k = k + 1\n            For j = 1 To UBound(arrSource, 2)\n                arrReturn(k, j) = arrSource(i, j)\n            Next\n        End If\n    Next\n\n'if it's date, we want to test if greater than date\nCase Date\n    For i = 1 To UBound(arrSource)\n        If DateValue(arrSource(i, 9)) &gt; DateValue(arg) Then\n            k = k + 1\n        End If\n    Next\n\nso on and so forth...\n\nEnd With\n\npopulate = arrReturn\n\nEnd Function\n</code></pre>\n\n<p>Basically, how can I manipulate <code>If arrSource(i, 9) = arg Then</code> based on condition? Sometimes I want <code>=</code>, sometimes <code>&gt;</code>.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1568141026, "post_id": 57876017, "comment_id": 102177931, "body": "Consider creating a &quot;helper&quot; column (that could be far off the normal use area, or even on a separate sheet). Each cell in the helper column would then strip the leading characters to leave you with just the numbers <code>=RIGHT(A1,LEN(A1)-2)</code>. Then have your sub use the <code>Max</code> function on that helper column."}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 11890257, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WPUCCfI6R34/AAAAAAAAAAI/AAAAAAAAAGA/XSXgTWUhWEs/photo.jpg?sz=128", "display_name": "r z", "link": "https://stackoverflow.com/users/11890257/r-z"}, "edited": false, "score": 0, "creation_date": 1568293946, "post_id": 57906216, "comment_id": 102234871, "body": "Wonderful answer chillin, thank you! In response to your third bullet, the Max MT### can appear in different rows of column F, so choosing the last row may not actually give the maximum value of column F. Maybe I could filter it to all rows in col F with values other that &quot;&quot;"}, {"owner": {"reputation": 99, "user_id": 11890257, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WPUCCfI6R34/AAAAAAAAAAI/AAAAAAAAAGA/XSXgTWUhWEs/photo.jpg?sz=128", "display_name": "r z", "link": "https://stackoverflow.com/users/11890257/r-z"}, "edited": false, "score": 0, "creation_date": 1568294939, "post_id": 57906216, "comment_id": 102235450, "body": "Update: It works like a charm.  You are correct that it is kindof sluggish, I might adjust the size of the Range being entered into the &quot;CustomMax&quot; Function. The MT### Serial Numbers are based on actual parts being produced. Based on production, I don&#39;t see the MT### eclipsing MT50000 for the next 30 years."}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "reply_to_user": {"reputation": 99, "user_id": 11890257, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WPUCCfI6R34/AAAAAAAAAAI/AAAAAAAAAGA/XSXgTWUhWEs/photo.jpg?sz=128", "display_name": "r z", "link": "https://stackoverflow.com/users/11890257/r-z"}, "edited": false, "score": 1, "creation_date": 1568296088, "post_id": 57906216, "comment_id": 102236176, "body": "Great, no problem. #1 If I recall correctly <code>Application.Max</code> (used above) is relatively slow (maybe it does a lot of checks against input) and it might be ~80 times faster to create a custom function in its place -- which returns the larger of two numbers. #2 When I said detecting the last row, I didn&#39;t mean that the largest <code>MT###</code> is in the last row. I meant if the last used row in column F is cell <code>F10000</code> (for example), then maybe pass <code>F1:F10000</code> instead of <code>F:F</code> to the function -- as the former will process ~1 million fewer cells (depending on Excel version), which helps performance."}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "reply_to_user": {"reputation": 99, "user_id": 11890257, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WPUCCfI6R34/AAAAAAAAAAI/AAAAAAAAAGA/XSXgTWUhWEs/photo.jpg?sz=128", "display_name": "r z", "link": "https://stackoverflow.com/users/11890257/r-z"}, "edited": false, "score": 1, "creation_date": 1568296246, "post_id": 57906216, "comment_id": 102236275, "body": "If you find performance to be too sluggish, I can try to implement the two points in my comment (to improve performance). Up to you."}, {"owner": {"reputation": 99, "user_id": 11890257, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WPUCCfI6R34/AAAAAAAAAAI/AAAAAAAAAGA/XSXgTWUhWEs/photo.jpg?sz=128", "display_name": "r z", "link": "https://stackoverflow.com/users/11890257/r-z"}, "edited": false, "score": 0, "creation_date": 1568300177, "post_id": 57906216, "comment_id": 102238686, "body": "Ok gotcha. I changed it from F:F to  F7:F25000, which is a far larger range than I anticipate we will need. It runs fast as I need it. By the time we hit MT25000, either the orders of parts will have ceased, a new part will be ordered thus new serials, or a new software will be available."}], "tags": [], "owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "is_accepted": true, "score": 1, "last_activity_date": 1568289407, "creation_date": 1568289407, "answer_id": 57906216, "question_id": 57876017, "link": "https://stackoverflow.com/questions/57876017/using-function-maxrange-with-mixed-characters-letters-and-numbers/57906216#57906216", "title": "Using Function MaxRange with mixed characters (letters and numbers)", "body": "<p>You could try something like below.</p>\n\n<pre><code>Option Explicit\n\nPrivate Function CustomMax(ByVal someRange As Range, Optional ByVal Prefix As String = \"MT\") As Long\n    Debug.Assert someRange.Cells.CountLarge &gt; 1\n    Debug.Assert someRange.Areas.Count = 1\n\n    Dim inputArray As Variant\n    inputArray = someRange.Value\n\n    Dim lengthOfPrefix As Long\n    lengthOfPrefix = Len(Prefix)\n\n    Dim serialStartsAt As Long\n    serialStartsAt = lengthOfPrefix + 1\n\n    ' Assumes inputArray is 2-dimensional\n    Dim rowIndex As Long\n    For rowIndex = LBound(inputArray, 1) To UBound(inputArray, 1)\n\n        If Not IsError(inputArray(rowIndex, 1)) Then\n\n            Dim Stringified As String\n            Stringified = CStr(inputArray(rowIndex, 1))\n\n            If StrComp(Prefix, Left$(Stringified, lengthOfPrefix), vbBinaryCompare) = 0 Then\n                Dim serialParsed As String\n                serialParsed = Mid$(Stringified, serialStartsAt)\n\n                If IsNumeric(serialParsed) Then\n                    Dim maxThusFar As Long\n                    maxThusFar = Application.Max(maxThusFar, CLng(serialParsed)) ' Whole numbers only assumed\n                End If\n            End If\n        End If\n    Next rowIndex\n\n    CustomMax = maxThusFar\n\nEnd Function\n</code></pre>\n\n<p>I haven't seen your worksheet, but based on your code, you might just be able to swap this line in your code:</p>\n\n<pre><code>LastSerial = Application.WorksheetFunction.Max(Range(\"F:F\"))\n</code></pre>\n\n<p>with:</p>\n\n<pre><code>LastSerial = CustomMax(Range(\"F:F\"))\n</code></pre>\n\n<ul>\n<li>Also, I think the <code>CustomMax</code> function will return a 0 (by default) if there are no MT### values. To change this behaviour, you could change its return type to something else (e.g. <code>Variant</code>).</li>\n<li>The function does a few checks (for errors, for prefix, for numeric serial, etc) -- which may or may not make sense depending on the contents of the range.</li>\n<li>You might want to detect the last row instead of passing the entire column to the function (as the function attempts to read the entire range into an array). Otherwise, performance may suffer or you may receive memory-related errors.</li>\n<li>Function needs a better name than <code>CustomMax</code>.</li>\n</ul>\n"}], "owner": {"reputation": 99, "user_id": 11890257, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WPUCCfI6R34/AAAAAAAAAAI/AAAAAAAAAGA/XSXgTWUhWEs/photo.jpg?sz=128", "display_name": "r z", "link": "https://stackoverflow.com/users/11890257/r-z"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 57906216, "answer_count": 1, "score": 0, "last_activity_date": 1568289407, "creation_date": 1568138049, "question_id": 57876017, "link": "https://stackoverflow.com/questions/57876017/using-function-maxrange-with-mixed-characters-letters-and-numbers", "title": "Using Function MaxRange with mixed characters (letters and numbers)", "body": "<p>I would like to find the maximum number value of a column, but each value in that column starts with letter characters (MT###). After the maximum is found, my variable 'LastSerial' is assigned to it, the column autofills with increasing values, a new maximum is found within the column, and rinse and repeat within this loop. </p>\n\n<pre><code>Private Sub ButtonOK_Click()\n\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim SerialList As Range\n    Dim j As Long\n    Dim lv As Variant\n    Set wb = ActiveWorkbook\n    Set ws = ActiveWorkbook.Worksheets(\"Sheet1\")\n    Dim strFind As Variant\n    Dim todaysDate As String\n    Dim LastSerial As Long 'latest serial number already in log\n    todaysDate = ws.Range(\"L3\")\n\n\n'Takes what values were added to the Scrap List Box within the userform finds them in B column of Sheet1, and udpates their same-row Scrap Date and     Scrap Initials fields. Then finds next available\n'serial number (casting) and adds an equal number of values present in the                         ListBox2 to the serial number list count.\nWith ws\n    For j = 0 To Me.ListBox2.ListCount - 1\n        'LastSerial is largest value found in F column\n        LastSerial = Application.WorksheetFunction.Max(Range(\"F:F\"))\n        lv = Me.ListBox2.List(j)\n        Set SerialList = ws.Range(\"B:B\").Find(What:=lv, LookAt:=xlWhole)\n            If Not SerialList Is Nothing Then\n                If LastSerial = \"0\" Or IsNull(LastSerial) Then\n                    MsgBox \"Error: Serial Log has a missing entry or no previous serial numbers.)\"\n                    Exit Sub\n                Else\n                    ws.Cells(SerialList.Row, \"E\").Value = todaysDate\n                    ws.Cells(SerialList.Row, \"F\").Value = \"MT\" &amp; LastSerial + 1\n                    ws.Cells(SerialList.Row, \"G\").Value = TextBox3\n                    ws.Cells(SerialList.Row, \"H\").Value = TextBox4\n                    ws.Cells(SerialList.Row, \"I\").Value = TBInitials\n                End If\n            End If\n    Next j\n    MsgBox \"Serial Numbers successfully added.\"\nEnd With\n\nApplication.ScreenUpdating = True\n\nUnload Me\nEnd Sub\n</code></pre>\n\n<p>Results: the code cannot find the last serial because MT### isn't a number, but I don't know which function to use to split the MT from the number and evaluate only the number. I thought about using the LEFT or RIGHT function but I'm not sure how to implement that inside of the MAX function.</p>\n"}, {"tags": ["mysql", "vba", "spring-boot", "ms-access"], "comments": [{"owner": {"reputation": 44067, "user_id": 3470178, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/655943089/picture?type=large", "display_name": "Juan Carlos Oropeza", "link": "https://stackoverflow.com/users/3470178/juan-carlos-oropeza"}, "edited": false, "score": 7, "creation_date": 1568137416, "post_id": 57875886, "comment_id": 102176484, "body": "Tables aren&#39;t order sets. What today is the last row, can be different next second based on how the db bring the data. You can&#39;t say what is the last row unless you use <code>ORDER BY</code>, Do you have an ID to tell you what is the last row?"}, {"owner": {"reputation": 568, "user_id": 8147680, "user_type": "registered", "profile_image": "https://graph.facebook.com/1495266583868736/picture?type=large", "display_name": "Nitin Nanda", "link": "https://stackoverflow.com/users/8147680/nitin-nanda"}, "reply_to_user": {"reputation": 44067, "user_id": 3470178, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/655943089/picture?type=large", "display_name": "Juan Carlos Oropeza", "link": "https://stackoverflow.com/users/3470178/juan-carlos-oropeza"}, "edited": false, "score": 0, "creation_date": 1568138272, "post_id": 57875886, "comment_id": 102176845, "body": "Apparantly not at this point. The query &quot;qry_doc_date&quot; that I mentioned further includes multiple sub-query in hierarchy that ultimately drops down to a table &quot;tbl_voyage&quot; that has an ID and this column arrivalDate. Should I bring that ID here ? Also, a doubt, Do you mean that I might get different results every time I run this query ?"}, {"owner": {"reputation": 16278, "user_id": 4421474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b931f645dc56015b93aeaa5e20d0b5f7?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4421474/alex"}, "edited": false, "score": 2, "creation_date": 1568138601, "post_id": 57875886, "comment_id": 102176964, "body": "why not just <code>Select MAX(qry_doc_dates.arrival_date)</code>?"}, {"owner": {"reputation": 568, "user_id": 8147680, "user_type": "registered", "profile_image": "https://graph.facebook.com/1495266583868736/picture?type=large", "display_name": "Nitin Nanda", "link": "https://stackoverflow.com/users/8147680/nitin-nanda"}, "reply_to_user": {"reputation": 16278, "user_id": 4421474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b931f645dc56015b93aeaa5e20d0b5f7?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4421474/alex"}, "edited": false, "score": 0, "creation_date": 1568138855, "post_id": 57875886, "comment_id": 102177066, "body": "@Alex Just tried this. It also returns the same result."}, {"owner": {"reputation": 16278, "user_id": 4421474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b931f645dc56015b93aeaa5e20d0b5f7?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4421474/alex"}, "edited": false, "score": 1, "creation_date": 1568139031, "post_id": 57875886, "comment_id": 102177140, "body": "That is impossible, untill you have some invisible characters somewhere in strings"}, {"owner": {"reputation": 568, "user_id": 8147680, "user_type": "registered", "profile_image": "https://graph.facebook.com/1495266583868736/picture?type=large", "display_name": "Nitin Nanda", "link": "https://stackoverflow.com/users/8147680/nitin-nanda"}, "edited": false, "score": 0, "creation_date": 1568139601, "post_id": 57875886, "comment_id": 102177364, "body": "By same result, I mean the MAX date value from the list of dates."}, {"owner": {"reputation": 44067, "user_id": 3470178, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/655943089/picture?type=large", "display_name": "Juan Carlos Oropeza", "link": "https://stackoverflow.com/users/3470178/juan-carlos-oropeza"}, "edited": false, "score": 0, "creation_date": 1568142684, "post_id": 57875886, "comment_id": 102178574, "body": "<code>But I need &quot;2019-05-22&quot;</code> Why you need that 22? What not 20 give us some context on what are you trying to do. btw you also have two 22 on that data."}, {"owner": {"reputation": 568, "user_id": 8147680, "user_type": "registered", "profile_image": "https://graph.facebook.com/1495266583868736/picture?type=large", "display_name": "Nitin Nanda", "link": "https://stackoverflow.com/users/8147680/nitin-nanda"}, "edited": false, "score": 0, "creation_date": 1568143097, "post_id": 57875886, "comment_id": 102178734, "body": "I need this date because the VBA query I am trying to convert to mysql query has the <code>DLast</code> function which selects the last row from the returned values. I have mentioned that query in the EDIT 1. I have the list of dates returned but I am stuck at trying to understand what <code>DLast</code> wants (the last row as much as I have understood) and thats why I am trying to get the last returned row. The two same dates you mentioned are the part of the legacy database."}], "answers": [{"comments": [{"owner": {"reputation": 568, "user_id": 8147680, "user_type": "registered", "profile_image": "https://graph.facebook.com/1495266583868736/picture?type=large", "display_name": "Nitin Nanda", "link": "https://stackoverflow.com/users/8147680/nitin-nanda"}, "edited": false, "score": 0, "creation_date": 1568139410, "post_id": 57876182, "comment_id": 102177302, "body": "You are correct. I think I mis-understood what the VBA query wants me to return. I have edited my question. Please have a look again."}], "tags": [], "owner": {"reputation": 29517, "user_id": 6436191, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ecxRK.png?s=128&g=1", "display_name": "The Impaler", "link": "https://stackoverflow.com/users/6436191/the-impaler"}, "is_accepted": false, "score": 3, "last_activity_date": 1568138978, "creation_date": 1568138978, "answer_id": 57876182, "question_id": 57875886, "link": "https://stackoverflow.com/questions/57875886/select-last-row-from-a-mysql-query/57876182#57876182", "title": "Select last row from a MySQL query", "body": "<p>Your question doesn't make too much sense according to the SQL standard. In the absense of an <code>ORDER BY</code> clause the database engine is free to return the rows in <em>any</em> order. This order may even change over time.</p>\n\n<p><strong>So essentially you are requesting the \"last random row\" the query returns</strong>. If this is the case, why don't you get the \"first random row\"? It doesn't make any difference, does it?</p>\n\n<p>The only way of getting the last random row is to get them all and discard all of them except for the last one. </p>\n\n<p>Now, if you just need <strong>one random row</strong>, I would suggest you just get the first random row, and problem solved.</p>\n"}, {"comments": [{"owner": {"reputation": 568, "user_id": 8147680, "user_type": "registered", "profile_image": "https://graph.facebook.com/1495266583868736/picture?type=large", "display_name": "Nitin Nanda", "link": "https://stackoverflow.com/users/8147680/nitin-nanda"}, "edited": false, "score": 0, "creation_date": 1568312116, "post_id": 57878303, "comment_id": 102244086, "body": "I believe this DLast function is added to the code because one entry was made somewhere in the corresponding table just before executing this function. This date is being retrieved to set it to another function. This is how the other developer did the code. I have confirmed that the last entry of date is required and I understand that it will become obsolete just after making another entry in that table."}], "tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": false, "score": 2, "last_activity_date": 1568150142, "creation_date": 1568150142, "answer_id": 57878303, "question_id": 57875886, "link": "https://stackoverflow.com/questions/57875886/select-last-row-from-a-mysql-query/57878303#57878303", "title": "Select last row from a MySQL query", "body": "<p>In response to the additional information from your edit:</p>\n\n<blockquote>\n  <p>EDIT 1: I am trying to convert this VBA query to MYSQL.</p>\n\n<pre><code>DLast(\"arrival_date\", \"qry_doc_date\", \"[package_id] = \" &amp; Me!lstPackage)\n</code></pre>\n  \n  <p>I suppose I misunderstood what the VBA query wants to return. Another\n  issue is I do not have means to run this VBA query and check the\n  result myself.</p>\n</blockquote>\n\n<p>Unless your dataset <code>qry_doc_date</code> is ordered by means of an <code>order by</code> clause, the <code>DFirst</code> or <code>DLast</code> domain aggregate functions will return essentially a random record.</p>\n\n<p>This is stated in the <a href=\"https://support.office.com/en-gb/article/dfirst-dlast-functions-adb06169-bf49-4f80-bf04-1e4b5a48a8a7\" rel=\"nofollow noreferrer\">MS Access Documentation</a> for these two functions:</p>\n\n<blockquote>\n  <p>You can use the <code>DFirst</code> and <code>DLast</code> functions <strong>to return a random record</strong> from a particular field in a table or query when you simply need any value from that field.</p>\n  \n  <p><strong>[ ... ]</strong></p>\n  \n  <p>If you want to return the first or last record in a set of records (a domain), <strong>you should create a query sorted as either ascending or descending</strong> and set the TopValues property to 1. For more information, see the TopValues property topic. From a Visual Basic for Applications (VBA) module, you can also create an ADO Recordset object and use the MoveFirst or MoveLast method to return the first or last record in a set of records.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 568, "user_id": 8147680, "user_type": "registered", "profile_image": "https://graph.facebook.com/1495266583868736/picture?type=large", "display_name": "Nitin Nanda", "link": "https://stackoverflow.com/users/8147680/nitin-nanda"}, "edited": false, "score": 1, "creation_date": 1568312172, "post_id": 57884113, "comment_id": 102244109, "body": "I think your answer will produce the required result that I need. I will try this in a day or two and update here marking it as the answer. Thanks"}, {"owner": {"reputation": 568, "user_id": 8147680, "user_type": "registered", "profile_image": "https://graph.facebook.com/1495266583868736/picture?type=large", "display_name": "Nitin Nanda", "link": "https://stackoverflow.com/users/8147680/nitin-nanda"}, "edited": false, "score": 0, "creation_date": 1568820757, "post_id": 57884113, "comment_id": 102399069, "body": "It worked. Thanks. Please upvote the question if you feel it was useful enough as many people didn&#39;t know about this row_number() function in mysql 8.0"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 568, "user_id": 8147680, "user_type": "registered", "profile_image": "https://graph.facebook.com/1495266583868736/picture?type=large", "display_name": "Nitin Nanda", "link": "https://stackoverflow.com/users/8147680/nitin-nanda"}, "edited": false, "score": 1, "creation_date": 1568820906, "post_id": 57884113, "comment_id": 102399157, "body": "Great! Thanks for the feedback."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1568186715, "creation_date": 1568186715, "answer_id": 57884113, "question_id": 57875886, "link": "https://stackoverflow.com/questions/57875886/select-last-row-from-a-mysql-query/57884113#57884113", "title": "Select last row from a MySQL query", "body": "<p>What you need is to in <em>qry_doc_date</em> to include a <a href=\"http://www.mysqltutorial.org/mysql-row_number/\" rel=\"nofollow noreferrer\">sequential row number</a>.</p>\n\n<p>Then you can use something like this:</p>\n\n<pre><code>ORDER BY qry_doc_dates.row_number DESC LIMIT 1\n</code></pre>\n"}], "owner": {"reputation": 568, "user_id": 8147680, "user_type": "registered", "profile_image": "https://graph.facebook.com/1495266583868736/picture?type=large", "display_name": "Nitin Nanda", "link": "https://stackoverflow.com/users/8147680/nitin-nanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 0, "accepted_answer_id": 57884113, "answer_count": 3, "score": 0, "last_activity_date": 1594449679, "creation_date": 1568137282, "last_edit_date": 1594449679, "question_id": 57875886, "link": "https://stackoverflow.com/questions/57875886/select-last-row-from-a-mysql-query", "title": "Select last row from a MySQL query", "body": "<p>I have a query that returns some dates which are not in any order. I need to select the last row from the sub query. The problem is all the solutions I can find online uses something like</p>\n\n<pre><code>ORDER BY qry_doc_dates.arrival_date DESC LIMIT 1\n\nSelect qry_doc_dates.arrival_date \nFROM (qry_doc_date) AS qry_doc_dates \nORDER BY qry_doc_dates.arrival_date DESC \nLIMIT 1\n</code></pre>\n\n<p>which will not serve my purpose because it first orders the dates as DESC(or ASC). </p>\n\n<p>Suppose the qry_doc_date returns :</p>\n\n<pre><code>\"2019-05-27\",\n\"2019-05-13\",\n\"2019-05-20\",\n\"2019-05-22\",\n\"2019-07-12\",\n\"2019-05-22\",\n\"2019-07-16\",\n\"2019-05-22\"\n</code></pre>\n\n<p>As we can see that the returned values are not in order. If I use</p>\n\n<pre><code>ORDER BY qry_doc_dates.arrival_date DESC LIMIT 1\n</code></pre>\n\n<p>then it returns \"2019-07-16\" But I need \"2019-05-22\" which is the last row.</p>\n\n<p>EDIT 1:\nI am trying to convert this VBA query to MYSQL. </p>\n\n<pre><code>DLast(\"arrival_date\", \"qry_doc_date\", \"[package_id] = \" &amp; Me!lstPackage)\n</code></pre>\n\n<p>I suppose I misunderstood what the VBA query wants to return. Another issue is I do not have means to run this VBA query and check the result myself.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1568138107, "post_id": 57875395, "comment_id": 102176783, "body": "I tested code and works perfect for me."}, {"owner": {"reputation": 39, "user_id": 11198694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4dff216cea93ce8764919d2899e2f4d?s=128&d=identicon&r=PG&f=1", "display_name": "Rats", "link": "https://stackoverflow.com/users/11198694/rats"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1568141950, "post_id": 57875395, "comment_id": 102178292, "body": "@HansUp the message returned when I remove On error resume next is runtime 2046 &quot;deleterecord isn&#39;t available now&quot;."}, {"owner": {"reputation": 39, "user_id": 11198694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4dff216cea93ce8764919d2899e2f4d?s=128&d=identicon&r=PG&f=1", "display_name": "Rats", "link": "https://stackoverflow.com/users/11198694/rats"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1568143626, "post_id": 57875395, "comment_id": 102178927, "body": "@HansUp its a query based upon a table, but when I looked at the source in the properties box it wasn&#39;t defined. it was empty, could that be a factor?"}, {"owner": {"reputation": 39, "user_id": 11198694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4dff216cea93ce8764919d2899e2f4d?s=128&d=identicon&r=PG&f=1", "display_name": "Rats", "link": "https://stackoverflow.com/users/11198694/rats"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1568143688, "post_id": 57875395, "comment_id": 102178960, "body": "@HansUp, the form is used to edit existing purchase orders, or in some cases delete them.. It is the parent table to 1 or 2 child tables as well."}, {"owner": {"reputation": 39, "user_id": 11198694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4dff216cea93ce8764919d2899e2f4d?s=128&d=identicon&r=PG&f=1", "display_name": "Rats", "link": "https://stackoverflow.com/users/11198694/rats"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1568144114, "post_id": 57875395, "comment_id": 102179136, "body": "@HansUp, yes I can successfully edit from this form. That&#39;s part of my confusion. I didn&#39;t write the code but I don&#39;t see anything changing it&#39;s source at run time. However the edits go directly to the child tables and the delete would affect the parent table."}, {"owner": {"reputation": 39, "user_id": 11198694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4dff216cea93ce8764919d2899e2f4d?s=128&d=identicon&r=PG&f=1", "display_name": "Rats", "link": "https://stackoverflow.com/users/11198694/rats"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1568144442, "post_id": 57875395, "comment_id": 102179258, "body": "@HansUp, upon a closer look I am seeing that some of the data when this form is populated comes from other tables, I see 3 different sources."}, {"owner": {"reputation": 39, "user_id": 11198694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4dff216cea93ce8764919d2899e2f4d?s=128&d=identicon&r=PG&f=1", "display_name": "Rats", "link": "https://stackoverflow.com/users/11198694/rats"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1568144556, "post_id": 57875395, "comment_id": 102179298, "body": "@HansUp, I think you&#39;ve hit on it there. As I just figured out there are more sources for the information than the parent table. I&#39;m going to take a look at the referential integrity settings on these relationships.  Thanks, I&#39;ll let you know if that was it."}, {"owner": {"reputation": 39, "user_id": 11198694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4dff216cea93ce8764919d2899e2f4d?s=128&d=identicon&r=PG&f=1", "display_name": "Rats", "link": "https://stackoverflow.com/users/11198694/rats"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1568145002, "post_id": 57875395, "comment_id": 102179485, "body": "@HansUp, OK, the form is split, there are 3 tables feeding the data. The editing which works applies to a child table but the delete would apply to the parent and referential integrity is fully enforced. I guess my next question is do I have to rewrite this to allow the delete command to apply to the parent table [PurchaseOrders] directly?"}, {"owner": {"reputation": 39, "user_id": 11198694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4dff216cea93ce8764919d2899e2f4d?s=128&d=identicon&r=PG&f=1", "display_name": "Rats", "link": "https://stackoverflow.com/users/11198694/rats"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1568145522, "post_id": 57875395, "comment_id": 102179689, "body": "@HansUp, yes it allows me to delete"}, {"owner": {"reputation": 39, "user_id": 11198694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4dff216cea93ce8764919d2899e2f4d?s=128&d=identicon&r=PG&f=1", "display_name": "Rats", "link": "https://stackoverflow.com/users/11198694/rats"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1568146027, "post_id": 57875395, "comment_id": 102179889, "body": "@HansUp that would be ideal, unfortunately he no longer works here. It fell to me and I am still learning as I go. It seems logical to me that if I can target the delete command to the right table using some code that should do the trick. Am I on the right track with that line of thinking?"}, {"owner": {"reputation": 39, "user_id": 11198694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4dff216cea93ce8764919d2899e2f4d?s=128&d=identicon&r=PG&f=1", "display_name": "Rats", "link": "https://stackoverflow.com/users/11198694/rats"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1568146535, "post_id": 57875395, "comment_id": 102180090, "body": "@HansUp, I gotta wrap it up for today, it&#39;s been a long one. I can shoot out the file tomorrow with a link. Thanks"}, {"owner": {"reputation": 39, "user_id": 11198694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4dff216cea93ce8764919d2899e2f4d?s=128&d=identicon&r=PG&f=1", "display_name": "Rats", "link": "https://stackoverflow.com/users/11198694/rats"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1568805698, "post_id": 57875395, "comment_id": 102390182, "body": "@HansUp, I didn&#39;t mean to just disappear, I had a few other issues to deal with. I got permission to post a stripped down version of the database to get some help with it but I created some additional issues I haven&#39;t had time to deal with so I haven&#39;t moved any further on it."}, {"owner": {"reputation": 39, "user_id": 11198694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4dff216cea93ce8764919d2899e2f4d?s=128&d=identicon&r=PG&f=1", "display_name": "Rats", "link": "https://stackoverflow.com/users/11198694/rats"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1571146366, "post_id": 57875395, "comment_id": 103137398, "body": "@HansUp, Thanks for the help. I have been asked to remove the delete button from the form so all the problems I was having have been solved so to speak. I appreciate the help none the less"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 11198694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4dff216cea93ce8764919d2899e2f4d?s=128&d=identicon&r=PG&f=1", "display_name": "Rats", "link": "https://stackoverflow.com/users/11198694/rats"}, "edited": false, "score": 0, "creation_date": 1568810388, "post_id": 57929664, "comment_id": 102392815, "body": "thanks for the bit of code there. It does show the problem in a message box as you said unfortunately I am no closer to solving my issue. The message is something I already discovered as I stepped through and followed the suggestions given to me in the thread above."}, {"owner": {"reputation": 39, "user_id": 11198694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4dff216cea93ce8764919d2899e2f4d?s=128&d=identicon&r=PG&f=1", "display_name": "Rats", "link": "https://stackoverflow.com/users/11198694/rats"}, "edited": false, "score": 0, "creation_date": 1568811167, "post_id": 57929664, "comment_id": 102393238, "body": "the message box show error code 2046. DeleteRecord not available right now"}, {"owner": {"reputation": 61, "user_id": 12059378, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAvmd6SUVRsDo_5eGedpXGjcDlTBj5QKxRt3OXgXQ=k-s128", "display_name": "Leftii", "link": "https://stackoverflow.com/users/12059378/leftii"}, "reply_to_user": {"reputation": 39, "user_id": 11198694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4dff216cea93ce8764919d2899e2f4d?s=128&d=identicon&r=PG&f=1", "display_name": "Rats", "link": "https://stackoverflow.com/users/11198694/rats"}, "edited": false, "score": 0, "creation_date": 1568822417, "post_id": 57929664, "comment_id": 102400013, "body": "No problem. Is there any possibility that on your form the toolbar has been disabled? Also, has the data on the record been edited at all? I believe both of these things can cause this issue."}, {"owner": {"reputation": 39, "user_id": 11198694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4dff216cea93ce8764919d2899e2f4d?s=128&d=identicon&r=PG&f=1", "display_name": "Rats", "link": "https://stackoverflow.com/users/11198694/rats"}, "edited": false, "score": 0, "creation_date": 1568904499, "post_id": 57929664, "comment_id": 102431459, "body": "The navigation buttons and record selectors are both disabled but I did try to enable them to see if that changed the results and it did not. As far as the data goes the error message is the same whether it&#39;s dirty or clean"}, {"owner": {"reputation": 61, "user_id": 12059378, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAvmd6SUVRsDo_5eGedpXGjcDlTBj5QKxRt3OXgXQ=k-s128", "display_name": "Leftii", "link": "https://stackoverflow.com/users/12059378/leftii"}, "reply_to_user": {"reputation": 39, "user_id": 11198694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4dff216cea93ce8764919d2899e2f4d?s=128&d=identicon&r=PG&f=1", "display_name": "Rats", "link": "https://stackoverflow.com/users/11198694/rats"}, "edited": false, "score": 0, "creation_date": 1568906067, "post_id": 57929664, "comment_id": 102432377, "body": "Interesting. Could you try getting the ID of the current record, then use that to delete it directly with a query? Like: <code>CurrentDb.Execute(&quot;DELETE * FROM PurchaseOrders WHERE PurchaseOrders.ID = &quot; &amp; currentRecordId &amp; &quot;;&quot;)</code>"}, {"owner": {"reputation": 39, "user_id": 11198694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4dff216cea93ce8764919d2899e2f4d?s=128&d=identicon&r=PG&f=1", "display_name": "Rats", "link": "https://stackoverflow.com/users/11198694/rats"}, "edited": false, "score": 0, "creation_date": 1568912599, "post_id": 57929664, "comment_id": 102435435, "body": "I just tried this &#39;CurrentDb.Execute (&quot;DELETE * FROM PurchaseOrders WHERE [PurchaseOrders].[PONum] = &quot; &amp; Me.txtPO &amp; &quot;;&quot;)&#39; with no luck. I get a data mismatch error"}, {"owner": {"reputation": 61, "user_id": 12059378, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAvmd6SUVRsDo_5eGedpXGjcDlTBj5QKxRt3OXgXQ=k-s128", "display_name": "Leftii", "link": "https://stackoverflow.com/users/12059378/leftii"}, "reply_to_user": {"reputation": 39, "user_id": 11198694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4dff216cea93ce8764919d2899e2f4d?s=128&d=identicon&r=PG&f=1", "display_name": "Rats", "link": "https://stackoverflow.com/users/11198694/rats"}, "edited": false, "score": 0, "creation_date": 1568913620, "post_id": 57929664, "comment_id": 102435860, "body": "In your DB what is the data type of PONum? If it is a string you&#39;ll need to add single quotes to your query: <code>CurrentDb.Execute (&quot;DELETE * FROM PurchaseOrders WHERE [PurchaseOrders].[PONum] = &#39;&quot; &amp; Me.txtPO &amp; &quot;&#39;;&quot;)</code> around <code>&quot; &amp; Me.txtPO &amp; &quot;</code>"}, {"owner": {"reputation": 61, "user_id": 12059378, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAvmd6SUVRsDo_5eGedpXGjcDlTBj5QKxRt3OXgXQ=k-s128", "display_name": "Leftii", "link": "https://stackoverflow.com/users/12059378/leftii"}, "reply_to_user": {"reputation": 39, "user_id": 11198694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4dff216cea93ce8764919d2899e2f4d?s=128&d=identicon&r=PG&f=1", "display_name": "Rats", "link": "https://stackoverflow.com/users/11198694/rats"}, "edited": false, "score": 0, "creation_date": 1569253130, "post_id": 57929664, "comment_id": 102527915, "body": "Any luck, Rats?"}, {"owner": {"reputation": 39, "user_id": 11198694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4dff216cea93ce8764919d2899e2f4d?s=128&d=identicon&r=PG&f=1", "display_name": "Rats", "link": "https://stackoverflow.com/users/11198694/rats"}, "edited": false, "score": 0, "creation_date": 1570015417, "post_id": 57929664, "comment_id": 102778863, "body": "Not so far, however my manager at this point has asked me to consider taking this delete button off the form and making the deletion of this item (a P.O.) something that is done only by admin anyhow. Not sure which direction it will ultimately go yet."}, {"owner": {"reputation": 39, "user_id": 11198694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4dff216cea93ce8764919d2899e2f4d?s=128&d=identicon&r=PG&f=1", "display_name": "Rats", "link": "https://stackoverflow.com/users/11198694/rats"}, "edited": false, "score": 0, "creation_date": 1571146478, "post_id": 57929664, "comment_id": 103137468, "body": "It&#39;s official. No more delete button but I appreciate your help on what I was trying to achieve"}], "tags": [], "owner": {"reputation": 61, "user_id": 12059378, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAvmd6SUVRsDo_5eGedpXGjcDlTBj5QKxRt3OXgXQ=k-s128", "display_name": "Leftii", "link": "https://stackoverflow.com/users/12059378/leftii"}, "is_accepted": false, "score": 0, "last_activity_date": 1568409367, "last_edit_date": 1568409367, "creation_date": 1568404637, "answer_id": 57929664, "question_id": 57875395, "link": "https://stackoverflow.com/questions/57875395/how-to-display-and-fix-find-the-actual-error-being-registered/57929664#57929664", "title": "How to display and fix find the actual error being registered", "body": "<p>This should catch the error, display the error number as well as the error description in a dialog box. You can also add any error handling you need into errorReceived as well. Good luck!</p>\n\n<pre><code>Private Sub DeleteRecord_Click()\n    On Error GoTo errorReceived\n    If MsgBox(Prompt:=\"Are you sure?\", Buttons:=vbYesNo, title:=\"Delete\") = vbYes Then\n        DoCmd.RunCommand acCmdDeleteRecord\n    If Err.Number = 0 Then\n        MsgBox Prompt:=\"Deleted\", Buttons:=vbOKOnly, title:=\"Deleted\"\n    Else\n        MsgBox Prompt:=\"There is no record to delete.\", Buttons:=vbOKOnly, title:=\"Error\"\n    End If\n    Else\n        MsgBox Prompt:=\"Cancelled\", Buttons:=vbOKOnly, title:=\"Canceled\"\n    End If\n    Exit Sub\n\n    errorReceived:\n        MsgBox \"Error #\" &amp; Err.Number &amp; vbCr &amp; Err.Description\n        'Add error handling here\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 11198694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4dff216cea93ce8764919d2899e2f4d?s=128&d=identicon&r=PG&f=1", "display_name": "Rats", "link": "https://stackoverflow.com/users/11198694/rats"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594449663, "creation_date": 1568135036, "last_edit_date": 1594449663, "question_id": 57875395, "link": "https://stackoverflow.com/questions/57875395/how-to-display-and-fix-find-the-actual-error-being-registered", "title": "How to display and fix find the actual error being registered", "body": "<p>I have a simple delete button code on a form to delete records in a table. When the button is clicked it throws the message that there is no record to delete</p>\n\n<p>The form is set to allow edits, additions, and deletions. </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub DeleteRecord_Click()\n    If MsgBox(Prompt:=\"Are you sure?\", Buttons:=vbYesNo, title:=\"Delete\") = vbYes Then\n        On Error Resume Next\n            DoCmd.RunCommand acCmdDeleteRecord\n        If Err.Number = 0 Then\n            MsgBox Prompt:=\"Deleted\", Buttons:=vbOKOnly, title:=\"Deleted\"\n        Else\n            MsgBox Prompt:=\"There is no record to delete.\", Buttons:=vbOKOnly, title:=\"Error\"\n        End If\n    Else\n        MsgBox Prompt:=\"Cancelled\", Buttons:=vbOKOnly, title:=\"Canceled\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>I expected the record to be deleted but the message says no record exists, If I refresh the record does indeed still exist. I am not sure where my error is here.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1568134631, "post_id": 57875132, "comment_id": 102175451, "body": "In general, you want to [avoid using Activate and select](how-to-avoid-using-select-in-excel-vba) in your code. It&#39;s also a good idea to specify the worksheet for all the ranges in your code"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1568135391, "post_id": 57875132, "comment_id": 102175763, "body": "What is the value of <code>lrSell</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 12020403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61ea5f8905726ff1d134eeaa9406c999?s=128&d=identicon&r=PG&f=1", "display_name": "signup4stuffmatt", "link": "https://stackoverflow.com/users/12020403/signup4stuffmatt"}, "edited": false, "score": 0, "creation_date": 1568135938, "post_id": 57875457, "comment_id": 102175937, "body": "Thank you for helping me clean up my code but I&#39;m still receiving the same issue  ``` MonthlySales.Range(&quot;A2:CG2&quot;).AutoFill Destination:=MonthlySales.Range(&quot;A3:CG&quot; &amp; (lrSell - 2)) ```"}, {"owner": {"reputation": 21, "user_id": 12020403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61ea5f8905726ff1d134eeaa9406c999?s=128&d=identicon&r=PG&f=1", "display_name": "signup4stuffmatt", "link": "https://stackoverflow.com/users/12020403/signup4stuffmatt"}, "edited": false, "score": 0, "creation_date": 1568136022, "post_id": 57875457, "comment_id": 102175975, "body": "FYI, the current value for lrSell is 1478"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 21, "user_id": 12020403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61ea5f8905726ff1d134eeaa9406c999?s=128&d=identicon&r=PG&f=1", "display_name": "signup4stuffmatt", "link": "https://stackoverflow.com/users/12020403/signup4stuffmatt"}, "edited": false, "score": 0, "creation_date": 1568137096, "post_id": 57875457, "comment_id": 102176365, "body": "@signup4stuffmatt try including row 2 in your destination range"}, {"owner": {"reputation": 21, "user_id": 12020403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61ea5f8905726ff1d134eeaa9406c999?s=128&d=identicon&r=PG&f=1", "display_name": "signup4stuffmatt", "link": "https://stackoverflow.com/users/12020403/signup4stuffmatt"}, "edited": false, "score": 1, "creation_date": 1568137542, "post_id": 57875457, "comment_id": 102176548, "body": "That was it... Insane how one number breaks everything.. Thank you for your help"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 0, "last_activity_date": 1568137109, "last_edit_date": 1568137109, "creation_date": 1568135349, "answer_id": 57875457, "question_id": 57875132, "link": "https://stackoverflow.com/questions/57875132/select-method-of-range-class-failed-after-selecting-worksheet/57875457#57875457", "title": "Select method of Range class failed after selecting worksheet", "body": "<p>Don't <code>Activate</code> sheets to make unqualified member calls work.</p>\n\n<blockquote>\n<pre><code>SellData.Activate\nlrSell = Cells(Rows.Count, \"H:H\").End(xlUp).Row\n</code></pre>\n</blockquote>\n\n<p>Qualify the member calls instead.</p>\n\n<pre><code>lrSell = SellData.Cells(SellData.Rows.Count, \"H\").End(xlUp).Row\n</code></pre>\n\n<p>Same here:</p>\n\n<blockquote>\n<pre><code>Dim MonthlySales As Worksheet\nSet MonthlySales = Transactions.Sheets(\"Monthly Sales\")\nMonthlySales.Activate\nMonthlySales.Range(\"A2:CG2\").AutoFill Destination:=Range(\"A3:CG\" &amp; (lrSell - 2))\n</code></pre>\n</blockquote>\n\n<p>Use explicit qualifiers - <code>Range</code> (or <code>Cells</code>) used without a qualifier is almost always a bug waiting to happen.</p>\n\n<pre><code>Dim MonthlySales As Worksheet\nSet MonthlySales = Transactions.Sheets(\"Monthly Sales\")\nMonthlySales.Range(\"A2:CG2\").AutoFill Destination:=MonthlySales.Range(\"A2:CG\" &amp; (lrSell - 2))\n</code></pre>\n\n<p>Note that this will throw error 1004 if <code>lrSell - 2</code> is zero or negative. Best assert that it isn't the case:</p>\n\n<pre><code>lrSell = SellData.Cells(SellData.Rows.Count, \"H\").End(xlUp).Row\nDebug.Assert lrSell &gt; 2 ' we're subtracting 2 later, so this must be 3+\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 12020403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61ea5f8905726ff1d134eeaa9406c999?s=128&d=identicon&r=PG&f=1", "display_name": "signup4stuffmatt", "link": "https://stackoverflow.com/users/12020403/signup4stuffmatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 57875457, "answer_count": 1, "score": 0, "last_activity_date": 1568137109, "creation_date": 1568133915, "last_edit_date": 1568134525, "question_id": 57875132, "link": "https://stackoverflow.com/questions/57875132/select-method-of-range-class-failed-after-selecting-worksheet", "title": "Select method of Range class failed after selecting worksheet", "body": "<p>I'm trying to use autofill to populate a worksheet with the same number of rows as another worksheet. I'm getting the \"AutoFill method of Range class failed\" error message. It's not able to find the range that I want to start from. </p>\n\n<p>I searched a few other questions like this and they suggested placing it in a module (Which was already the case for me) or activating the worksheet before trying to autofill the data. Neither worked so far</p>\n\n<pre><code>    'Working between 2 workbookss\n    Dim Transactions As Workbook\n    Set Transactions = ActiveWorkbook\n\n    'Sells\n    Dim SellData As Worksheet\n    Set SellData = Transactions.Sheets(\"SellData\")\n\n    Dim lrSell As Long\n    SellData.Activate\n    lrSell = Cells(Rows.Count, \"H:H\").End(xlUp).Row\n\n    Dim MonthlySales As Worksheet\n    Set MonthlySales = Transactions.Sheets(\"Monthly Sales\")\n    MonthlySales.Activate\n    MonthlySales.Range(\"A2:CG2\").AutoFill Destination:=Range(\"A3:CG\" &amp; (lrSell - 2))\n    'Error happens on last line MonthlySales.Range(\"A2:CG2\")\n</code></pre>\n\n<p>I also tried</p>\n\n<pre><code>    MonthlySales.Activate\n    MonthlySales.Range(\"A2:CG2\").Select              'This is where the error would come up\n    Selection.AutoFill Destination:=Range(\"A3:CG\" &amp; (lrSell - 2))\n</code></pre>\n\n<p>In the end, Sell data and Monthly sales should have the same row number. The reason for all of this is to reformat the data.</p>\n"}, {"tags": ["excel", "vba", "number-formatting"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1568132360, "post_id": 57874713, "comment_id": 102174371, "body": "<code>Worksheets(...).Range(...).Value = Worksheets(...).Range(...).Text</code> may work"}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1568133181, "creation_date": 1568133181, "answer_id": 57874962, "question_id": 57874713, "link": "https://stackoverflow.com/questions/57874713/how-to-convert-a-custom-cell-to-value-with-the-words-in-custom-in-excel/57874962#57874962", "title": "How to convert a custom cell to value with the words in custom in excel", "body": "<p>A cell's <code>NumberFormat</code> dictates its <em>string representation</em> - but doesn't affect its <em>value</em>.</p>\n\n<p>In order to make the number-formatted string representation the value itself, you can assign the cell's <code>Value</code> to its <code>Text</code> property:</p>\n\n<pre><code>theCell.Value = theCell.Text\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12047864, "user_type": "registered", "profile_image": "https://graph.facebook.com/2733734469972890/picture?type=large", "display_name": "Nhan Huynh", "link": "https://stackoverflow.com/users/12047864/nhan-huynh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568133181, "creation_date": 1568132240, "last_edit_date": 1568133045, "question_id": 57874713, "link": "https://stackoverflow.com/questions/57874713/how-to-convert-a-custom-cell-to-value-with-the-words-in-custom-in-excel", "title": "How to convert a custom cell to value with the words in custom in excel", "body": "<p>My cell has custom (  #,##0 \"PCS\"   ) and true value is just a number but i want to convert it to real value which is combined number and \"PCS\" for copying purpose. I have tried many idea but still not found the solution for this. please help if there're any function, script or code to do this. truly need your all help. Thank youu</p>\n\n<p>Expected to check all sheet if any custom like that and change to real value.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1568133246, "post_id": 57874672, "comment_id": 102174784, "body": "Possiblyy a standard row delete issue where you should loop from the bottom to the top. Try: For i = wkbook.Worksheets(&quot;T&quot;).Range(&quot;TEAMS&quot;).Rows.Count To 1 Step -1"}], "answers": [{"comments": [{"owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "edited": false, "score": 0, "creation_date": 1568135421, "post_id": 57875258, "comment_id": 102175773, "body": "I&#39;m assuming that it should be <code>Table.ListRows</code>, no?"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1568135437, "last_edit_date": 1568135437, "creation_date": 1568134464, "answer_id": 57875258, "question_id": 57874672, "link": "https://stackoverflow.com/questions/57874672/delete-excel-table-row-using-vba/57875258#57875258", "title": "Delete Excel Table row using VBA", "body": "<p>You're in a <code>ListObject</code>/table - use the <code>ListObject</code> API.</p>\n\n<pre><code>Dim table As ListObject\nSet table = wkbook.Worksheets.ListObjects(\"TEAMS\")\n\nDim colIndex As Long\nSet colIndex = table.ListColumns(\"D\").Index\n\nDim toDelete As Range\n\nDim currentRow As ListRow\nFor Each currentRow In table.ListRows\n    If currentRow.Range.Cells(ColumnIndex:=colIndex).Value &lt;&gt; department Then\n        If toDelete Is Nothing Then\n            Set toDelete = currentRow.Range\n        Else\n            Set toDelete = Application.Union(toDelete, currentRow.Range)\n    End If\nNext\n\nIf Not toDelete Is Nothing Then toDelete.Delete\n</code></pre>\n\n<p>Pretty similar to <a href=\"https://stackoverflow.com/a/57530306/1188513\">this answer</a>.</p>\n"}], "owner": {"reputation": 2347, "user_id": 3905832, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/ee3a70b9947104f3b4b6f1cb9c8c6d20?s=128&d=identicon&r=PG&f=1", "display_name": "Kraal", "link": "https://stackoverflow.com/users/3905832/kraal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 57875258, "answer_count": 1, "score": 1, "last_activity_date": 1568135437, "creation_date": 1568132094, "last_edit_date": 1568132593, "question_id": 57874672, "link": "https://stackoverflow.com/questions/57874672/delete-excel-table-row-using-vba", "title": "Delete Excel Table row using VBA", "body": "<p>I'm trying to delete the lines of a <code>TEAMS</code> Table when the <code>Value2</code> of column <code>D</code> does not match a variable <code>department</code> (String). I'm able to detect the rows I want to delete, but the delete method causes a \"<code>delete method of range class failed</code>\" error.</p>\n\n<p>Here is a simplified code snippet.</p>\n\n<pre><code>Dim i As Integer\nFor i = 1 To wkbook.Worksheets(\"T\").Range(\"TEAMS\").Rows.Count\n  With wkbook.Worksheets(\"T\").Range(\"TEAMS[D]\")(i)\n    If .Value2 &lt;&gt; department Then\n      .EntireRow.Delete\n    End If\n  End With\nNext i\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2126, "user_id": 3076048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6400b93631ba00051f21c5e158f1ed34?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Balhoff", "link": "https://stackoverflow.com/users/3076048/mark-balhoff"}, "edited": false, "score": 2, "creation_date": 1568131752, "post_id": 57874507, "comment_id": 102174067, "body": "Are you getting an error? Is it not doing what you expect?"}, {"owner": {"reputation": 1, "user_id": 12047743, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDrFKO0nBQHbbl52nxI5U0vTZ3OKGxqL9jGCOiqmg=k-s128", "display_name": "Khans Idrees", "link": "https://stackoverflow.com/users/12047743/khans-idrees"}, "reply_to_user": {"reputation": 2126, "user_id": 3076048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6400b93631ba00051f21c5e158f1ed34?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Balhoff", "link": "https://stackoverflow.com/users/3076048/mark-balhoff"}, "edited": false, "score": 0, "creation_date": 1568134632, "post_id": 57874507, "comment_id": 102175452, "body": "its copying 1 row extra."}, {"owner": {"reputation": 1, "user_id": 12047743, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDrFKO0nBQHbbl52nxI5U0vTZ3OKGxqL9jGCOiqmg=k-s128", "display_name": "Khans Idrees", "link": "https://stackoverflow.com/users/12047743/khans-idrees"}, "reply_to_user": {"reputation": 2126, "user_id": 3076048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6400b93631ba00051f21c5e158f1ed34?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Balhoff", "link": "https://stackoverflow.com/users/3076048/mark-balhoff"}, "edited": false, "score": 0, "creation_date": 1568134799, "post_id": 57874507, "comment_id": 102175526, "body": "<a href=\"https://i.postimg.cc/zvntm4vn/Untitled.jpg\" rel=\"nofollow noreferrer\">i.postimg.cc/zvntm4vn/Untitled.jpg</a>"}, {"owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1568137096, "post_id": 57874507, "comment_id": 102176364, "body": "What is your desired outcome?"}, {"owner": {"reputation": 1, "user_id": 12047743, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDrFKO0nBQHbbl52nxI5U0vTZ3OKGxqL9jGCOiqmg=k-s128", "display_name": "Khans Idrees", "link": "https://stackoverflow.com/users/12047743/khans-idrees"}, "edited": false, "score": 0, "creation_date": 1568175076, "post_id": 57874507, "comment_id": 102186811, "body": "extra row should not copy"}], "answers": [{"tags": [], "owner": {"reputation": 44, "user_id": 12009993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e6d97f3f34bfdf2601ba26e6d3da555?s=128&d=identicon&r=PG&f=1", "display_name": "Gh3ttoKinG.", "link": "https://stackoverflow.com/users/12009993/gh3ttoking"}, "is_accepted": false, "score": 0, "last_activity_date": 1568186191, "creation_date": 1568186191, "answer_id": 57883979, "question_id": 57874507, "link": "https://stackoverflow.com/questions/57874507/paste-data-to-adjacent-cell-if-cell-has-value/57883979#57883979", "title": "paste data to adjacent cell if cell has value", "body": "<p>It copy an extra row because you start the comparing at row 7 but start inserting at row 8.\nJust change the Range in rng from A7 to A8</p>\n\n<pre><code>Dim rng As Range\nDim lastRow As Long\nDim cell As Range\n\nlastRow = Cells(Rows.Count, 1).End(xlUp).Row\nSet rng = Range(\"A8:A\" &amp; lastRow + 1)\nFor Each cell In rng\n    If cell.Value &lt;&gt; \"\" Then\n        Range(\"H7:M7\").Select\n           Selection.Copy\n           Cells(Rows.Count, \"H\").End(xlUp).Offset(1, 0).PasteSpecial (xlPasteValues)\n           Application.CutCopyMode = False\n    End If\nNext cell\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12047743, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDrFKO0nBQHbbl52nxI5U0vTZ3OKGxqL9jGCOiqmg=k-s128", "display_name": "Khans Idrees", "link": "https://stackoverflow.com/users/12047743/khans-idrees"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1568186191, "creation_date": 1568131410, "last_edit_date": 1568184449, "question_id": 57874507, "link": "https://stackoverflow.com/questions/57874507/paste-data-to-adjacent-cell-if-cell-has-value", "title": "paste data to adjacent cell if cell has value", "body": "<p><a href=\"https://i.postimg.cc/fRR8SnG2/Untitled.jpg\" rel=\"nofollow noreferrer\">https://i.postimg.cc/fRR8SnG2/Untitled.jpg</a></p>\n\n<pre><code>Dim rng As Range\nDim lastRow As Long\nDim cell As Range\n\nlastRow = Cells(Rows.Count, 1).End(xlUp).Row\nSet rng = Range(\"A7:A\" &amp; lastRow + 1)\nFor Each cell In rng\n    If cell.Value &lt;&gt; \"\" Then\n        Range(\"H7:M7\").Select\n           Selection.Copy\n           Cells(Rows.Count, \"H\").End(xlUp).Offset(1, 0).PasteSpecial (xlPasteValues)\n           Application.CutCopyMode = False\n    End If\nNext cell\n</code></pre>\n\n<p>it is copying one row below were data is not present in g column</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "is_accepted": true, "score": 2, "last_activity_date": 1568132012, "creation_date": 1568132012, "answer_id": 57874650, "question_id": 57874411, "link": "https://stackoverflow.com/questions/57874411/rename-an-excel-table-column-using-vba/57874650#57874650", "title": "Rename an Excel table column using VBA", "body": "<p>How about</p>\n\n<pre><code>ActiveWorkbook.Sheets(\"Resources\").ListObjects(\"RESOURCES\").ListColumns(\"Column name\").Name = \"New column name\"\n</code></pre>\n\n<p>Hope that helps</p>\n"}], "owner": {"reputation": 2347, "user_id": 3905832, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/ee3a70b9947104f3b4b6f1cb9c8c6d20?s=128&d=identicon&r=PG&f=1", "display_name": "Kraal", "link": "https://stackoverflow.com/users/3905832/kraal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 57874650, "answer_count": 1, "score": 0, "last_activity_date": 1568184438, "creation_date": 1568131026, "last_edit_date": 1568184438, "question_id": 57874411, "link": "https://stackoverflow.com/questions/57874411/rename-an-excel-table-column-using-vba", "title": "Rename an Excel table column using VBA", "body": "<p>On a Sheet named \"Resources\", I have a table named RESOURCES that has a column named \"Column name\". How can I rename this column using VBA ?</p>\n\n<p>I tried the following but it results in an error : <code>ActiveWorkbook.Sheets(\"Resources\").Range(\"RESOURCES[[#Headers];[Column Name]]\").Value = \"New name\"</code></p>\n\n<p>Thank you</p>\n"}, {"tags": ["excel", "vba", "focus"], "comments": [{"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 2, "creation_date": 1568130833, "post_id": 57874318, "comment_id": 102173575, "body": "Can You show some more code? Have You tried to put ThisWorkbook.Activate?"}, {"owner": {"reputation": 1164, "user_id": 2175534, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8495695328eb312bdd894387e0675c9c?s=128&d=identicon&r=PG", "display_name": "Bob", "link": "https://stackoverflow.com/users/2175534/bob"}, "edited": false, "score": 0, "creation_date": 1568131054, "post_id": 57874318, "comment_id": 102173705, "body": "I do not have adobe pro. I had a version of the tool that used pro, but had to make another version since my friend doesn&#39;t have it."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 2, "creation_date": 1568131395, "post_id": 57874318, "comment_id": 102173880, "body": "<a href=\"https://stackoverflow.com/questions/46932069/appactivate-works-in-excel-2007-but-not-in-2010\">One Possible reason</a>"}, {"owner": {"reputation": 1164, "user_id": 2175534, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8495695328eb312bdd894387e0675c9c?s=128&d=identicon&r=PG", "display_name": "Bob", "link": "https://stackoverflow.com/users/2175534/bob"}, "reply_to_user": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 0, "creation_date": 1568131900, "post_id": 57874318, "comment_id": 102174145, "body": "@Teamothy yes, it runs, but the Msgbox doesn&#39;t pop up. See Edit"}, {"owner": {"reputation": 1164, "user_id": 2175534, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8495695328eb312bdd894387e0675c9c?s=128&d=identicon&r=PG", "display_name": "Bob", "link": "https://stackoverflow.com/users/2175534/bob"}, "edited": false, "score": 0, "creation_date": 1568134466, "post_id": 57874318, "comment_id": 102175388, "body": "Nothing I seem to do will make it so the MsgBox pops up automatically. The user has to click on the Excel screen for the box to pop up"}, {"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1568136832, "post_id": 57874318, "comment_id": 102176277, "body": "So, have you tried <code>AppActivate Title:=ThisWorkbook.Application.Caption</code> (as suggested in the link Siddharth Rout pointed to) ?"}, {"owner": {"reputation": 1164, "user_id": 2175534, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8495695328eb312bdd894387e0675c9c?s=128&d=identicon&r=PG", "display_name": "Bob", "link": "https://stackoverflow.com/users/2175534/bob"}, "reply_to_user": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1568138086, "post_id": 57874318, "comment_id": 102176777, "body": "@Decimalturn yes and it throws an error"}, {"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1568138253, "post_id": 57874318, "comment_id": 102176839, "body": "<code>Invalid procedure call or argument</code> ? Or another one?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568169240, "post_id": 57874318, "comment_id": 102185823, "body": "Try ading <code>Doevents</code> before the msgbox? If this doesn&#39;t work then we will use APIs to find the window and bring it to foreground"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568169649, "post_id": 57874318, "comment_id": 102185886, "body": "<code>ThisWorkbook.Activate</code> and <code>AppActivate ThisWorkbook.Name</code> should have worked. I would like to see the complete code if that is possible. Let me know by using the &quot;@&quot; sign and then my name so that I can get notified..."}], "answers": [{"tags": [], "owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "is_accepted": false, "score": 0, "last_activity_date": 1568366593, "creation_date": 1568366593, "answer_id": 57920810, "question_id": 57874318, "link": "https://stackoverflow.com/questions/57874318/vba-refocus-excel-workbook/57920810#57920810", "title": "VBA: Refocus Excel Workbook", "body": "<p>I know this is not exactly a solution to your problem, but if none of the ideas from the comments helped (activate and whatnot), consider using mshta.exe instead of msgbox:</p>\n\n<pre><code>Title = \"title\"\nMessageText = \"msg\"\nPauseTimeSeconds = 0\n\nCreateObject(\"WScript.Shell\").Run \"mshta.exe vbscript:close(CreateObject(\"\"WScript.Shell\"\").\" &amp; \"Popup(\"\"\" &amp; MessageText &amp; \"\"\",\" &amp; PauseTimeSeconds &amp; \",\"\"\" &amp; Title &amp; \"\"\"))\"\n</code></pre>\n\n<p>It won't re-focus on excel but should display your msg on top of other windows, which is what you want I believe. Please note the code will continue to execute whether user clicks ok or not. <code>PauseTimeSeconds</code> will close the window after certain amount of seconds, or leave it open if set to 0.</p>\n"}], "owner": {"reputation": 1164, "user_id": 2175534, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8495695328eb312bdd894387e0675c9c?s=128&d=identicon&r=PG", "display_name": "Bob", "link": "https://stackoverflow.com/users/2175534/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568366593, "creation_date": 1568130652, "last_edit_date": 1568138044, "question_id": 57874318, "link": "https://stackoverflow.com/questions/57874318/vba-refocus-excel-workbook", "title": "VBA: Refocus Excel Workbook", "body": "<p>I wrote a program to take Excel data in an Excel spreadsheet and put it in a PDF form. The program opens the PDF form, fills in the data, and then saves and closes the PDF. It then refocuses to the Excel Workbook. It works fine on my laptop, but when I handed it off to a friend a run-time error of <code>Invalid procedure call or argument</code> showed up on...</p>\n\n<p><code>AppActivate ThisWorkbook.Name</code></p>\n\n<p>I'm wondering why this worked for me, but not my friend. I'm also wondering if there is another way to bring the focus back to the Excel Workbook. Thanks!</p>\n\n<p>Edit: I want it to refocus to Excel to show a Msgbox being popped up indicating that the tool has done it's job.</p>\n\n<pre><code>ThisWorkbook.Activate\nMsgBox \"Job Completed!\"\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 1, "user_id": 12047755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b40797da9a1908111dd91cfcae98db25?s=128&d=identicon&r=PG&f=1", "display_name": "Scout495", "link": "https://stackoverflow.com/users/12047755/scout495"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1568163068, "post_id": 57874303, "comment_id": 102183941, "body": "Hi @CindyMeister. Sorry, I didn&#39;t see the edit option earlier. I&#39;ve corrected this. I did manage to set a loop using the basic code: &quot;Dim x As Integer&quot;, &quot;For x = 1 To 40&quot;, and &quot;Next x&quot;. The issue is that I would rather not have to change the maximum &quot;x&quot; to match the number of fields to be inserted each time. That&#39;s why a &quot;Do If&quot; loop would be better."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1568182969, "post_id": 57874303, "comment_id": 102189039, "body": "Scout, please do try the code again and report <i>exactly</i> how it&#39;s not working. I see nothing, right off-hand, that would cause the error message you sort-of-think-you-saw. What I do see is that a <code>Selection.Find.Execute</code> is needed <i>before</i> the <code>Do While</code> line, otherwise this will evaluate to <code>False</code> so the loop won&#39;t run; and then put <code>Selection.Find.Execute</code> just before the <code>Loop</code> line. <b><i>OR</i></b> put the evaluation at the end of the loop (<code>Loop While Selection.Find.Found</code>). Then you should no longer need the <code>If...End If</code> lines"}, {"owner": {"reputation": 1, "user_id": 12047755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b40797da9a1908111dd91cfcae98db25?s=128&d=identicon&r=PG&f=1", "display_name": "Scout495", "link": "https://stackoverflow.com/users/12047755/scout495"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1568250498, "post_id": 57874303, "comment_id": 102217816, "body": "@CindyMeister, you are fantastic! I did retry the original macro and it error out, but didn&#39;t do anything either. I took your advice and moved the Selection.Find.Execute before the Do While line and then another Selection.Find.Execute just before the Loop. The macro now runs perfectly! THANK YOU!"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 12047755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b40797da9a1908111dd91cfcae98db25?s=128&d=identicon&r=PG&f=1", "display_name": "Scout495", "link": "https://stackoverflow.com/users/12047755/scout495"}, "is_accepted": true, "score": 0, "last_activity_date": 1574362529, "last_edit_date": 1574362529, "creation_date": 1568251759, "answer_id": 57898625, "question_id": 57874303, "link": "https://stackoverflow.com/questions/57874303/loop-until-search-term-is-not-found/57898625#57898625", "title": "Loop until search term is not found", "body": "<p>I moved the <code>Selection.Find.Execute</code> before the Do While line and then added another <code>Selection.Find.Execute</code> just before the End IF and Loop.</p>\n\n<pre><code>Sub InsertFields()\n'\n' InsertFields Macro\n' Inserts all fields associated with an \"INCLUDETEXT\" link.\n' Selection.Find.ClearFormatting\n    With Selection.Find\n        .Text = \"INCLUDETEXT\"\n        .Replacement.Text = \"\"\n        .Forward = True\n        .Wrap = wdFindContinue\n        .Format = False\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n    End With\n    Selection.Find.Execute\n    Do While Selection.Find.Found = True\n    If Selection.Find.Found Then\n    Selection.MoveLeft Unit:=wdCharacter, Count:=1\n    Selection.MoveDown Unit:=wdParagraph, Count:=1, Extend:=wdExtend\n    Selection.MoveLeft Unit:=wdCharacter, Count:=1, Extend:=wdExtend\n    Selection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, _\n        PreserveFormatting:=False\n    Selection.Fields.Update\n    Selection.Find.Execute\n    End If\n    Loop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12047755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b40797da9a1908111dd91cfcae98db25?s=128&d=identicon&r=PG&f=1", "display_name": "Scout495", "link": "https://stackoverflow.com/users/12047755/scout495"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 0, "accepted_answer_id": 57898625, "answer_count": 1, "score": 0, "last_activity_date": 1574416878, "creation_date": 1568130609, "last_edit_date": 1574416878, "question_id": 57874303, "link": "https://stackoverflow.com/questions/57874303/loop-until-search-term-is-not-found", "title": "Loop until search term is not found", "body": "<p>I've recorded a macro to, find a specific search term \"INCLUDETEXT\" in a large document, highlight the text associated with that search term, convert the highlighted text to a field code, and then update the new field code.</p>\n\n<p>I need to loop the macro until the \"INCLUDETEXT\" term is not found. </p>\n\n<p>I've tried to repeat the code 50 times, but ended up with odd nested field codes on the last instance of the \"INCLUDETEXT\" term.</p>\n\n<pre><code>Sub InsertFields()\n'\n' InsertFields Macro\n' Inserts field codes associated with an \"INCLUDETEXT\" link.\n'\n    Selection.Find.ClearFormatting\n    With Selection.Find\n        .Text = \"INCLUDETEXT\"\n        .Replacement.Text = \"\"\n        .Forward = True\n        .Wrap = wdFindContinue\n        .Format = False\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n    End With\n    Selection.Find.Execute\n    Selection.MoveLeft Unit:=wdCharacter, Count:=1\n    Selection.MoveDown Unit:=wdParagraph, Count:=1, Extend:=wdExtend\n    Selection.MoveLeft Unit:=wdCharacter, Count:=1, Extend:=wdExtend\n    Selection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, _\n        PreserveFormatting:=False\n    Selection.Fields.Update\nEnd Sub\n</code></pre>\n\n<p>The macro works on each single instance of the search term. I would like to find and update all \"INCLUDETEXT\" terms.</p>\n\n<p>I have looked at <a href=\"https://stackoverflow.com/questions/13465709/repeating-microsoft-word-vba-until-no-search-results-found\">Repeating Microsoft Word VBA until no search results found</a>, but could not figure out how to adapt my macro to fit.</p>\n\n<p>My failed attempt at a \"Do If\" loop. I believe the specific error was an \"End If\" without an \"If\": </p>\n\n<pre><code>Sub InsertFields()\n'\n' InsertFields Macro\n' Inserts all fields associated with an \"INCLUDETEXT\" link.\n' Selection.Find.ClearFormatting\n    With Selection.Find\n        .Text = \"INCLUDETEXT\"\n        .Replacement.Text = \"\"\n        .Forward = True\n        .Wrap = wdFindContinue\n        .Format = False\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n    End With\n    Do While Selection.Find.Found = True\n    Selection.Find.Execute\n    If Selection.Find.Found Then\n    Selection.MoveLeft Unit:=wdCharacter, Count:=1\n    Selection.MoveDown Unit:=wdParagraph, Count:=1, Extend:=wdExtend\n    Selection.MoveLeft Unit:=wdCharacter, Count:=1, Extend:=wdExtend\n    Selection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, _\n        PreserveFormatting:=False\n    Selection.Fields.Update\n    End If\n    Loop\nEnd Sub\n</code></pre>\n"}]