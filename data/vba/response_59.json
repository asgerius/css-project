[{"tags": ["vba", "excel", "filter"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1456352093, "post_id": 35614055, "comment_id": 58912302, "body": "Welcome to SO. If you want help with a VBA macro to do this you&#39;ll need to show the effort you&#39;ve put in to accomplish your goal and where it&#39;s not working. Please read <a href=\"http://stackoverflow.com/help/how-to-ask\">How to Help</a> to receive more effective help on SO."}], "answers": [{"tags": [], "owner": {"reputation": 409, "user_id": 5604652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73bf206d862d877d6c866e97cbaf0184?s=128&d=identicon&r=PG&f=1", "display_name": "B540Glenn", "link": "https://stackoverflow.com/users/5604652/b540glenn"}, "is_accepted": false, "score": 2, "last_activity_date": 1456369102, "last_edit_date": 1456369102, "creation_date": 1456352482, "answer_id": 35614387, "question_id": 35614055, "link": "https://stackoverflow.com/questions/35614055/how-can-i-remove-the-filter-to-multiple-excel-files-with-visual-basic/35614387#35614387", "title": "How can i remove the filter to multiple excel files with visual basic?", "body": "<p>Before you copy the data, you should use:</p>\n\n<pre><code>If ActiveSheet.FilterMode Then\n    ActiveSheet.ShowAllData\nEnd If\n</code></pre>\n\n<p>This will turn off the filter.  </p>\n"}, {"tags": [], "owner": {"reputation": 496, "user_id": 5977709, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Wp5WfpAAGHo/AAAAAAAAAAI/AAAAAAAAASc/-Lw55LJlMJ8/photo.jpg?sz=128", "display_name": "Dusan Gligoric", "link": "https://stackoverflow.com/users/5977709/dusan-gligoric"}, "is_accepted": false, "score": 0, "last_activity_date": 1456370430, "creation_date": 1456370430, "answer_id": 35617589, "question_id": 35614055, "link": "https://stackoverflow.com/questions/35614055/how-can-i-remove-the-filter-to-multiple-excel-files-with-visual-basic/35617589#35617589", "title": "How can i remove the filter to multiple excel files with visual basic?", "body": "<p>Will remove any filter on all opened workbooks, have fun :)</p>\n\n<pre><code>sub try_this()\ndim wb as workbook\ndim sh as worksheet\n\nfor each wb in workbooks\n   for each sh in wb.worksheets\n      sh.AutoFilterMode = False\n   next\nnext\n\nend sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 5977067, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nUutL7pX3TE/AAAAAAAAAAI/AAAAAAAAC7g/1c5drtjgxcw/photo.jpg?sz=128", "display_name": "Cristian Palechor", "link": "https://stackoverflow.com/users/5977067/cristian-palechor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 537, "favorite_count": 0, "closed_date": 1457008413, "answer_count": 2, "score": 0, "last_activity_date": 1456370430, "creation_date": 1456351191, "last_edit_date": 1456352000, "question_id": 35614055, "link": "https://stackoverflow.com/questions/35614055/how-can-i-remove-the-filter-to-multiple-excel-files-with-visual-basic", "closed_reason": "Needs more focus", "title": "How can i remove the filter to multiple excel files with visual basic?", "body": "<p>I have around 500 files of excel and the most part have filter. Now i need to put all information in one sheet. I found how to put all in one sheet but the books with filter only copy information with filter and i need all. </p>\n\n<p>So, i need to remove filter of all excel files. Important (not all files have filter)</p>\n\n<p>Thanks for your help ;) </p>\n"}, {"tags": ["vba", "imacros"], "comments": [{"owner": {"reputation": 49560, "user_id": 119477, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/838f94e4247f0740e8be0cc6a9900278?s=128&d=identicon&r=PG", "display_name": "Conrad Frix", "link": "https://stackoverflow.com/users/119477/conrad-frix"}, "edited": false, "score": 0, "creation_date": 1456351023, "post_id": 35613835, "comment_id": 58911709, "body": "This is a bad idea. Once it runs for the first user how do you intend to &quot;remember&quot; that you&#39;ve run it already and the second user shouldn&#39;t zero out the data again. I think it&#39;s time to start using a database."}, {"owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 0, "creation_date": 1456351899, "post_id": 35613835, "comment_id": 58912183, "body": "You could write a script to run once on those dates that kicks off the macro."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1456352286, "post_id": 35613835, "comment_id": 58912397, "body": "Handle the <code>Workbook_Open</code> event, and then disconnect your phone ;-)"}, {"owner": {"reputation": 1, "user_id": 5976977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11a9f796a2ebfdc5bf050f9a8b7b627f?s=128&d=identicon&r=PG&f=1", "display_name": "markd1", "link": "https://stackoverflow.com/users/5976977/markd1"}, "edited": false, "score": 0, "creation_date": 1456447040, "post_id": 35613835, "comment_id": 58963917, "body": "Thank you. Maybe time to move to access?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5976977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11a9f796a2ebfdc5bf050f9a8b7b627f?s=128&d=identicon&r=PG&f=1", "display_name": "markd1", "link": "https://stackoverflow.com/users/5976977/markd1"}, "edited": false, "score": 0, "creation_date": 1456447078, "post_id": 35614345, "comment_id": 58963931, "body": "Thank you. Will implement and see how it works. Appreciate your help."}], "tags": [], "owner": {"reputation": 1362, "user_id": 4910205, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wz5LG.jpg?s=128&g=1", "display_name": "Brendan Gooden", "link": "https://stackoverflow.com/users/4910205/brendan-gooden"}, "is_accepted": false, "score": 0, "last_activity_date": 1456352347, "creation_date": 1456352347, "answer_id": 35614345, "question_id": 35613835, "link": "https://stackoverflow.com/questions/35613835/how-to-create-an-autoexecute-macro-in-excel/35614345#35614345", "title": "How to create an autoexecute macro in excel", "body": "<p>This should do what you're after.</p>\n\n<pre><code>Private Sub Workbook_Open()\nDim dt As String\n\n'GET THE CURRENT DAY OF MONTH\ndt = Format(Now(), \"DD\")\n\n'IF THE DATE IS 15th or 30th\nIf dt = \"15\" Or dt = \"30\" Then\n    'IF THE \"DONE\" VALUE IS BLANK\n    If Sheets(1).Range(\"XFD1\").Value = \"\" Then\n    'CLEAR ALL CELLS IN SHEET 1\n    Sheets(1).Cells.Clear\n    'SET VALUE TO \"DONE\" SO THE MACRO KNOWS THE DATA WIPE HAS ALREADY BEEN PERFORMED\n    Sheets(1).Range(\"XFD1\").Value = \"DONE\"\nEnd If\nEnd If\n\n'IF THE DATE IS NOT 15TH OR 30TH, CLEAR THE \"DONE\" VALUE SO THE MACRO CAN RUN AGAIN THE NEXT TIME\nIf dt &lt;&gt; \"15\" And dt &lt;&gt; \"30\" Then\nSheets(1).Range(\"XFD1\").Value = \"\"\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Let me know if anything is unclear.</p>\n"}], "owner": {"reputation": 1, "user_id": 5976977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11a9f796a2ebfdc5bf050f9a8b7b627f?s=128&d=identicon&r=PG&f=1", "display_name": "markd1", "link": "https://stackoverflow.com/users/5976977/markd1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1456352347, "creation_date": 1456350456, "question_id": 35613835, "link": "https://stackoverflow.com/questions/35613835/how-to-create-an-autoexecute-macro-in-excel", "title": "How to create an autoexecute macro in excel", "body": "<p>I have a spreadsheet with data input by multiple users.\nI would like to set up an autoexecute macro for all values in the spread sheet to be set to zero on the 15th and 30th of every month when users open the spreadsheet.\nPlease help.</p>\n"}, {"tags": ["vba", "combobox"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5952712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c07010c997904d3dbbe9c8a0ec311874?s=128&d=identicon&r=PG", "display_name": "K.Miller", "link": "https://stackoverflow.com/users/5952712/k-miller"}, "edited": false, "score": 0, "creation_date": 1456354471, "post_id": 35614031, "comment_id": 58913405, "body": "Opies, Thank you for your reply.  ProductInfo1 contains a list of products - which are under different sheets - thus the need for a dynamic range - Thus when I select the product I want ProductInfo2 to give me the data that matches it - however I have several items which are the same product but have different dimensions.  Hopefully this helps you to help me.  Thank you."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 1, "user_id": 5952712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c07010c997904d3dbbe9c8a0ec311874?s=128&d=identicon&r=PG", "display_name": "K.Miller", "link": "https://stackoverflow.com/users/5952712/k-miller"}, "edited": false, "score": 0, "creation_date": 1456358279, "post_id": 35614031, "comment_id": 58914785, "body": "What is in the cell you are looking up?  Application.WorksheetFunction.Match(ProductInfo1.Value, Sheets(strName).Range(strNameProductName), 0) is finding the value in your product info combobox in the range of the product in the specified sheet and returning either the row or column, I assume column."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 1, "user_id": 5952712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c07010c997904d3dbbe9c8a0ec311874?s=128&d=identicon&r=PG", "display_name": "K.Miller", "link": "https://stackoverflow.com/users/5952712/k-miller"}, "edited": false, "score": 0, "creation_date": 1456358374, "post_id": 35614031, "comment_id": 58914816, "body": "Application.WorksheetFunction.Index(Sheets(strName).Range(st&zwnj;&#8203;rNameProductDescript&zwnj;&#8203;ion), X) is getting the cell from the range with the ProductDescriptions in it, matching the row that you found previously.  What is the value in this cell?  Is it the name of a range that contains the values you wish in productInfo2, such as &quot;product1range&quot;, is it the cells in a string, such as &quot;$C$4:$C$50&quot;?"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 1, "user_id": 5952712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c07010c997904d3dbbe9c8a0ec311874?s=128&d=identicon&r=PG", "display_name": "K.Miller", "link": "https://stackoverflow.com/users/5952712/k-miller"}, "edited": false, "score": 0, "creation_date": 1456358468, "post_id": 35614031, "comment_id": 58914849, "body": "The Index(x, Match) formulation is returning a cell.  The main problem you are having is that you need to put something into the .RowSource property.  That something depends on what you have in indexed cell, but it shouldn&#39;t be too difficult to manipulate it to what you need."}, {"owner": {"reputation": 1, "user_id": 5952712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c07010c997904d3dbbe9c8a0ec311874?s=128&d=identicon&r=PG", "display_name": "K.Miller", "link": "https://stackoverflow.com/users/5952712/k-miller"}, "edited": false, "score": 0, "creation_date": 1456382141, "post_id": 35614031, "comment_id": 58922617, "body": "thank you again for your detailed feedback. I have started to look into this and have stumbled upon cascading comboboxes - which is what I was trying to achieve with the code above. Thus the look up cell is always dynamic dependant on the user form input. I will happily send you the entire file if this might help explain it!"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 1, "user_id": 5952712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c07010c997904d3dbbe9c8a0ec311874?s=128&d=identicon&r=PG", "display_name": "K.Miller", "link": "https://stackoverflow.com/users/5952712/k-miller"}, "edited": false, "score": 0, "creation_date": 1456417511, "post_id": 35614031, "comment_id": 58947237, "body": "Thanks for the offer, but I can make such comboboxes.  I don&#39;t know exactly how you are doing this, but if you run into specific problems, feel free to post another question."}], "tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": false, "score": 0, "last_activity_date": 1456351123, "creation_date": 1456351123, "answer_id": 35614031, "question_id": 35613145, "link": "https://stackoverflow.com/questions/35613145/adding-values-to-a-combobox-based-on-another-value-vba/35614031#35614031", "title": "Adding values to a combobox based on another value VBA", "body": "<p>You are assigning to the wrong object.  </p>\n\n<p>You are trying to set a combobox, ProductInfo equal to a range.</p>\n\n<p>What you want to do is use the \"RowSource\" property of the combobox</p>\n\n<p>For example:</p>\n\n<pre><code>  Me.ProductInfo2.RowSource = \"mySheet!$A$1:$A$10\"\n</code></pre>\n\n<p>This would make the choices for the ProductInfo2 combobox the items in cells A1-A10.</p>\n\n<p>It is unclear what you are trying to get with the Match/Index Worksheet functions.  If the contents of the cell have a range, then just use the contents to be equal to this rowsource.  So for instance, if the column that represents \"strNameProductDescription\" has the range \"myRange\" in it, then your code can simply be modified to put this into the RowSource property.  If it contains some other piece of information, then you need to construct the range you are looking for so that it would be similar to the line shown above.  If myRange is a range on your worksheet, then the code,</p>\n\n<pre><code>  Me.ProductInfo2.RowSource = \"myRange\" \n</code></pre>\n\n<p>will work.</p>\n"}], "owner": {"reputation": 1, "user_id": 5952712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c07010c997904d3dbbe9c8a0ec311874?s=128&d=identicon&r=PG", "display_name": "K.Miller", "link": "https://stackoverflow.com/users/5952712/k-miller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 339, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456351123, "creation_date": 1456348136, "question_id": 35613145, "link": "https://stackoverflow.com/questions/35613145/adding-values-to-a-combobox-based-on-another-value-vba", "title": "Adding values to a combobox based on another value VBA", "body": "<p>I am currently trying to get a combobox to add items based on another combobox value, but am coming unstuck.</p>\n\n<p>The following is the code I have so far - through trial and error I have got to this stage, although this is still giving me a \"1004\"  error relating to the last line of the code. Is there a better way of writing this to get the same result?</p>\n\n<pre><code>Private Sub ProductInfo1_Change()\n\nDim strName As String\nDim strNameProductAllData As String\nDim strNameProductName As String\nDim strNameProductDescription As String\n\nstrName = Replace(OrderForm1.OrderFrm3.Value, \" \", \"\")\n    sheet = \"strName\"\nstrNameProductName = Replace(strName, \" \", \"\") &amp; \"productname\"\n\nstrNameProductDescription = Replace(strName, \" \", \"\") &amp; \"productdescription\"\n\n\n    Me.ProductInfo2 = Application.WorksheetFunction.Index(Sheets(strName).Range(strNameProductDescription), Application.WorksheetFunction.Match(ProductInfo1.Value, Sheets(strName).Range(strNameProductName), 0))\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 3, "creation_date": 1456347639, "post_id": 35612975, "comment_id": 58909829, "body": "Please show the entirety of the code instead."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5976770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05d2de8efd3c9e39ee730ec56ee30c9b?s=128&d=identicon&r=PG", "display_name": "CasperG", "link": "https://stackoverflow.com/users/5976770/casperg"}, "is_accepted": false, "score": 0, "last_activity_date": 1456389074, "creation_date": 1456389074, "answer_id": 35622063, "question_id": 35612975, "link": "https://stackoverflow.com/questions/35612975/add-listrow-to-empty-listobject/35622063#35622063", "title": "add listrow to empty listobject", "body": "<p>JNevill, thanks for responding.  With some more persistence I solved the problem.  A filter was set, and calling AListObject.DataBodyRange.Delete when the filter was set caused the problem. The solution was to remove all filters prior to calling the delete method, as follows:</p>\n\n<p>AListobject.AutoFilter.ShowAllData</p>\n\n<p>AListObjct.DataBodyRange.Delete</p>\n\n<p>Thanks again for responding, and if I have an occasion to to post again, I'll follow your advice and post the actual code.</p>\n"}], "owner": {"reputation": 1, "user_id": 5976770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05d2de8efd3c9e39ee730ec56ee30c9b?s=128&d=identicon&r=PG", "display_name": "CasperG", "link": "https://stackoverflow.com/users/5976770/casperg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1059, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459950664, "creation_date": 1456347564, "last_edit_date": 1459950664, "question_id": 35612975, "link": "https://stackoverflow.com/questions/35612975/add-listrow-to-empty-listobject", "title": "add listrow to empty listobject", "body": "<p>With some VBA code in Excel I have an odd problem when adding a row to an empty listobject.  Does anyone know what is happening or how to fix it?  Here is the problem:</p>\n\n<p>First I delete the contents of a listobject (table), using:</p>\n\n<pre><code>AListObject.DataBodyRange.Delete\n</code></pre>\n\n<p>Then I have a loop that iteratively adds a row and fills it with data.  I add the row by using:</p>\n\n<pre><code>AListObject.ListRows.Add\n</code></pre>\n\n<p>Here is the odd behavior.  First, the code deletes the listobject's data:</p>\n\n<pre><code>AListObject.DataBodyRange.Delete\n</code></pre>\n\n<p>The immediate window shows <code>AListObject.ListRows.Count</code> equals <code>0</code>, so all rows are deleted.  Then I add a row:</p>\n\n<pre><code> AListObject.ListRows.Add (first iteration)\n</code></pre>\n\n<p>Immediate window shows <code>AListObject.ListRows.Count</code> equals <code>2</code>, so the Add method created two rows, instead of one.  Furthermore, the data written to row 1 is lost.  Row 1 of the listobject (table) displays empty cells.</p>\n\n<p>For the remaining iterations (2 to n) of the loop the ListRows.Add method works fine, creating only one row.  Writing data to those rows (2 to n) works fine as well.</p>\n\n<p>Why does the first Add method, called when the listobject is empty, create two rows, and why can't I write to row 1?  This code previously worked fine, and it works fine in old back-up versions of my workbook.  Does anyone know why this is odd behavior occurs?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1456347291, "post_id": 35612856, "comment_id": 58909645, "body": "Do an <code>offset</code> from <code>CPL.range(&quot;A1&quot;)</code>?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1456347326, "post_id": 35612856, "comment_id": 58909669, "body": "in vba <code>Range(&quot;CPL&quot;).Cells(3,6)</code> would give you the cell in the 3rd row and 6th columns.  <code>Range(&quot;CPL&quot;).Column(6)</code> would give you the 6th column."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1456347367, "post_id": 35612856, "comment_id": 58909688, "body": "@findwindow CPL was named using the name manager not a range variable in vba."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1456347492, "post_id": 35612856, "comment_id": 58909760, "body": "@ScottCraner see what I said about embarrassing myself =P"}, {"owner": {"reputation": 60, "user_id": 1879978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/876cfa03a9ddce2a2ebab4be1d3fa4da?s=128&d=identicon&r=PG", "display_name": "Fred", "link": "https://stackoverflow.com/users/1879978/fred"}, "edited": false, "score": 0, "creation_date": 1456348969, "post_id": 35612856, "comment_id": 58910547, "body": "Thanks both of you. Actually I used the following code inside a button: {Sheet1.Cells(33, 8) = Range(&quot;CPL&quot;).Cells(3, 6)} It dose not work. Any idea?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1456349105, "post_id": 35612856, "comment_id": 58910618, "body": "There are so many things that it could be.  Do this, in the immediate window put <code>? Range(&quot;CPL&quot;).Cells(3, 6)</code>  and see if it returns the correct value."}, {"owner": {"reputation": 60, "user_id": 1879978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/876cfa03a9ddce2a2ebab4be1d3fa4da?s=128&d=identicon&r=PG", "display_name": "Fred", "link": "https://stackoverflow.com/users/1879978/fred"}, "edited": false, "score": 0, "creation_date": 1456349619, "post_id": 35612856, "comment_id": 58910900, "body": "Sorry it is working. The only empty cell in my CPL table is cell (3,6)!  By the way, the first thing that I tested was {=range(&quot;CPL&quot;).cells(3,1)} in a cell and I received a formula error."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1456350973, "post_id": 35612856, "comment_id": 58911675, "body": "There is difference between vba and formulas, what was given is not a formula and will not work pasting directly in a cell.  It will only work in vba."}], "owner": {"reputation": 60, "user_id": 1879978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/876cfa03a9ddce2a2ebab4be1d3fa4da?s=128&d=identicon&r=PG", "display_name": "Fred", "link": "https://stackoverflow.com/users/1879978/fred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 199, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1456347151, "creation_date": 1456347151, "last_edit_date": 1531161705, "question_id": 35612856, "link": "https://stackoverflow.com/questions/35612856/access-to-specific-cell-value-using-name-of-a-table", "title": "Access to specific cell value using name of a table", "body": "<p>Suppose that we define 5X20 cells (for example E10:Y14) as CPL using name manager. Is there any way to get the value of 3rd row and 6th column in a cell? What about all the values of 6th columns? If we need to get access to the values of 6th column in VBA, what would be the solution? \nI know that I can name the 6th column separately and use that. But I am looking for a simpler way, since the table is large and I don't want to end up with huge number of names.</p>\n\n<p>Best regards,</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1456344841, "post_id": 35612061, "comment_id": 58908202, "body": "You can use <code>Application.OnTime</code>   How are you getting the &quot;live clock&quot; ?"}, {"owner": {"reputation": 1362, "user_id": 4910205, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wz5LG.jpg?s=128&g=1", "display_name": "Brendan Gooden", "link": "https://stackoverflow.com/users/4910205/brendan-gooden"}, "edited": false, "score": 0, "creation_date": 1456353006, "post_id": 35612061, "comment_id": 58912748, "body": "@Jack Medford, if you found my answer helpful I&#39;d appreciate you marking it as the correct answer :)"}], "answers": [{"tags": [], "owner": {"reputation": 1362, "user_id": 4910205, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wz5LG.jpg?s=128&g=1", "display_name": "Brendan Gooden", "link": "https://stackoverflow.com/users/4910205/brendan-gooden"}, "is_accepted": true, "score": 4, "last_activity_date": 1456345585, "creation_date": 1456345585, "answer_id": 35612378, "question_id": 35612061, "link": "https://stackoverflow.com/questions/35612061/how-to-send-data-every-10-minutes-to-separate-worksheet-in-excel/35612378#35612378", "title": "How to send data every 10 minutes to separate worksheet in Excel?", "body": "<p>This will copy the values from D2 and E2 on Sheet1, to D2 and E2 on Sheet2, adding a new row on Sheet2 every time a row is copied.</p>\n\n<p>It will run automatically every 10 minutes.</p>\n\n<pre><code>Sub CopyValues()\nDim RowNo As Long\nRowNo = Sheets(2).Cells(Rows.Count, 4).End(xlUp).Row + 1\n\n    Sheets(2).Cells(RowNo, 4) = Sheets(1).Cells(2, 4)\n    Sheets(2).Cells(RowNo, 5) = Sheets(1).Cells(2, 5)\n\nApplication.OnTime Now + TimeValue(\"00:10:00\"), \"CopyValues\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 5976648, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-q26j7Le68TE/AAAAAAAAAAI/AAAAAAAAALY/yzUP4EfisEI/photo.jpg?sz=128", "display_name": "Jack Medford", "link": "https://stackoverflow.com/users/5976648/jack-medford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3039, "favorite_count": 1, "accepted_answer_id": 35612378, "answer_count": 1, "score": 1, "last_activity_date": 1495545357, "creation_date": 1456344646, "question_id": 35612061, "link": "https://stackoverflow.com/questions/35612061/how-to-send-data-every-10-minutes-to-separate-worksheet-in-excel", "title": "How to send data every 10 minutes to separate worksheet in Excel?", "body": "<p>I have a worksheet with live data of a currency value relative to a USD that updates every 10 minutes in cell e2, and a live clock in cell d2. I would like to record both of these values every 10 minutes in another worksheet, so I have an account of the daily volatility of the value. What is the best way to do this?</p>\n\n<p>Thank you for the help.</p>\n"}, {"tags": ["excel", "vba", "internet-explorer"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1456346122, "post_id": 35611828, "comment_id": 58908991, "body": "<code>inputE</code> is a <i>collection</i> of items, not a single item.  You need to loop over that collection (you can use <code>For Each</code>) and check each element&#39;s <code>innerText</code>: when you find a match then run the element&#39;s <code>Click</code> event."}, {"owner": {"reputation": 291, "user_id": 2337922, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5075f986b54602d68419acf1fc22ddd9?s=128&d=identicon&r=PG", "display_name": "Singularity20XX", "link": "https://stackoverflow.com/users/2337922/singularity20xx"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1456347589, "post_id": 35611828, "comment_id": 58909804, "body": "I believed I tried that approach a few times before. Would you mind providing an example? I may have gotten the syntax wrong :/"}, {"owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "edited": false, "score": 0, "creation_date": 1456398955, "post_id": 35611828, "comment_id": 58933046, "body": "<i>it doesn&#39;t seem to work</i>: describe what happens: error message? on which line?"}], "answers": [{"comments": [{"owner": {"reputation": 291, "user_id": 2337922, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5075f986b54602d68419acf1fc22ddd9?s=128&d=identicon&r=PG", "display_name": "Singularity20XX", "link": "https://stackoverflow.com/users/2337922/singularity20xx"}, "edited": false, "score": 0, "creation_date": 1456352531, "post_id": 35613019, "comment_id": 58912510, "body": "I tried this and received a runtime 438 error &quot;Object doesn&#39;t support this property or method (line: set els = ..) :/"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 291, "user_id": 2337922, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5075f986b54602d68419acf1fc22ddd9?s=128&d=identicon&r=PG", "display_name": "Singularity20XX", "link": "https://stackoverflow.com/users/2337922/singularity20xx"}, "edited": false, "score": 0, "creation_date": 1456353793, "post_id": 35613019, "comment_id": 58913125, "body": "Difficult for me to suggest anything without some way for me to test."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1456347717, "creation_date": 1456347717, "answer_id": 35613019, "question_id": 35611828, "link": "https://stackoverflow.com/questions/35611828/selecting-item-from-dropdown-box-in-internet-explorer-using-vba/35613019#35613019", "title": "Selecting item from dropdown box in internet explorer using vba", "body": "<pre><code>Dim el As MSHTML.HTMLHtmlElement, els\n\nSet els = IE.document.getElementsByClassName(\"x-combo-list-item\")\n\nFor each el in els\n\n    If el.innerText = \"Item 3\" Then\n        Debug.Print el.innerText\n        el.click\n        Exit For\n    End If\n\nNext el\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 291, "user_id": 2337922, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5075f986b54602d68419acf1fc22ddd9?s=128&d=identicon&r=PG", "display_name": "Singularity20XX", "link": "https://stackoverflow.com/users/2337922/singularity20xx"}, "is_accepted": false, "score": 0, "last_activity_date": 1456420534, "creation_date": 1456420534, "answer_id": 35633941, "question_id": 35611828, "link": "https://stackoverflow.com/questions/35611828/selecting-item-from-dropdown-box-in-internet-explorer-using-vba/35633941#35633941", "title": "Selecting item from dropdown box in internet explorer using vba", "body": "<p>So I figured out how to do this. What a pain this was lol.</p>\n\n<pre><code>Dim inputElement0 As MSHTML.HTMLButtonElement\nSet inputElement0 = IE.document.getElementById(\"ext-gen255\")\n\n    If inputElement0.HasChildNodes = True Then\n    MsgBox True\n    Else\n    MsgBox False\n    End If\n</code></pre>\n\n<p>This helped me identify which of the elements had children (which, as I figured the object name suggested, could constitute sub items in the drop down) then..</p>\n\n<pre><code>inputElement0.FirstChild.NextSibling.NextSibling.click\n</code></pre>\n\n<p>and viola! \"Item 3\" was selected. Thanks for the help though guys! :p</p>\n"}], "owner": {"reputation": 291, "user_id": 2337922, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5075f986b54602d68419acf1fc22ddd9?s=128&d=identicon&r=PG", "display_name": "Singularity20XX", "link": "https://stackoverflow.com/users/2337922/singularity20xx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2375, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1456420534, "creation_date": 1456343881, "question_id": 35611828, "link": "https://stackoverflow.com/questions/35611828/selecting-item-from-dropdown-box-in-internet-explorer-using-vba", "title": "Selecting item from dropdown box in internet explorer using vba", "body": "<p>The below values represent a combobox / combo-list on a website. I am trying to select item #3 from the drop down using VBA. I have tried several things, but I have had no luck selecting said item. I have tried looking for solutions on Google and the Stack but haven't found anything that seems to work. </p>\n\n<pre><code>&lt;DIV id=ext-gen256 class=\"x-layer x-combo-list x-combo-list-small\"  style=\"FONT-SIZE: 10px; HEIGHT: 92px; WIDTH: 113px; POSITION: absolute; LEFT: 744px;       Z-INDEX: 12007; TOP: 235px; VISIBILITY: visible\"&gt;\n\n&lt;DIV id=ext-gen257 class=x-combo-list-inner style=\"HEIGHT: 90px; WIDTH: 111px\"&gt;\n\n&lt;DIV class=\"x-combo-list-item\" _nodup=\"30829\" viewIndex=\"0\"&gt;Select&lt;/DIV&gt;\n&lt;DIV class=\"x-combo-list-item\" _nodup=\"30829\" viewIndex=\"1\"&gt;Item 1&lt;/DIV&gt;\n&lt;DIV class=\"x-combo-list-item\" _nodup=\"30829\" viewIndex=\"2\"&gt;Item 2&lt;/DIV&gt;\n&lt;DIV class=\"\"x-combo-list-item\" _nodup=\"30829\" viewIndex=\"3\"&gt;Item 3&lt;/DIV&gt;\n&lt;DIV class=\"x-combo-list-item\" _nodup=\"30829\" viewIndex=\"4\"&gt;Item 4&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;\n</code></pre>\n\n<p>I have used several variatons of the below code to try and select the item in question (i.e item #3), or use .value = \"Item 3\", but this does not work. The text value in the input/droupdown box changes to the right value but for some reason the form won't apply the filter accordingly. However, if I physically type \"Item 3\" inside then input/droupdown box then submit the form, it works.</p>\n\n<pre><code>Dim inputE As MSHTML.HTMLHtmlElement\nSet inputE = IE.document.getElementsByClassName(\"x-combo-list-item\")\nIf inputE.innerText = \"Item 3\" Then\n    inputE.Select\nEnd If\n</code></pre>\n\n<p>This doesn't seem to work. Any help is greatly appreciated. I have been trying to figure this out, literally, for days.</p>\n"}, {"tags": ["excel", "vba", "select", "reference"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1456343229, "post_id": 35611550, "comment_id": 58907230, "body": "Check <code>root</code> holds the correct book."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1456343367, "post_id": 35611550, "comment_id": 58907325, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/13975496/vba-i-get-the-following-error-run-time-error-1004-application-defined-or-obj\">VBA: I get the following error: run-time error &#39;1004&#39; Application-defined or object-defined error</a>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1456343672, "post_id": 35611550, "comment_id": 58907511, "body": "Don&#39;t put the solution in the question as it makes the answers seem unneeded.  You mark the correct answer by clicking on the grey green check mark by the answer.  But yo have to wait for 15 minutes from the time the question was asked.  So come back in a few minutes and mark the answer as correct."}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 3, "last_activity_date": 1456343242, "creation_date": 1456343242, "answer_id": 35611614, "question_id": 35611550, "link": "https://stackoverflow.com/questions/35611550/direct-reference-to-range-excel-using-vba/35611614#35611614", "title": "Direct reference to range Excel using VBA", "body": "<p>You need to assign the sheet parentage to the <code>Cells</code> inside the range:</p>\n\n<pre><code>wb.Sheets(\"d_eff_stress\").Range(wb.Sheets(\"d_eff_stress\").Cells(3, n), wb.Sheets(\"d_eff_stress\").Cells(100, n)).Value\n</code></pre>\n\n<p>To do less typing use <code>With</code> Blocks:</p>\n\n<pre><code>Workbooks(root).Activate\nDim wb As Workbook\nSet wb = Application.Workbooks(root)\n\nWith wb.Sheets(\"d_eff_stress\")\n    .Cells(1, n).Value = filename\n    .Range(.Cells(3, n), .Cells(100, n)).Value = varray1\nEnd With\n\nWith wb.Sheets(\"eff_stress\")\n    .Cells(1, n).Value = filename\n    .Range(.Cells(3, n), .Cells(100, n)).Value = varray2\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 4474833, "user_type": "registered", "profile_image": "https://graph.facebook.com/1637521930/picture?type=large", "display_name": "Klaas Siderius", "link": "https://stackoverflow.com/users/4474833/klaas-siderius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 478, "favorite_count": 0, "accepted_answer_id": 35611614, "answer_count": 1, "score": 1, "last_activity_date": 1456343575, "creation_date": 1456343037, "last_edit_date": 1456343575, "question_id": 35611550, "link": "https://stackoverflow.com/questions/35611550/direct-reference-to-range-excel-using-vba", "title": "Direct reference to range Excel using VBA", "body": "<p>I'm having trouble using a direct reference. I'm trying to put values in the root workbook without using select or activate. But my code gives an error if the sheet to where the data needs to be copied isn't active. If the sheet is active the code works fine...</p>\n\n<p>Here is my code</p>\n\n<pre><code>Workbooks(root).Activate\nDim wb As Workbook\nSet wb = Application.Workbooks(root)\n\nwb.Sheets(\"d_eff_stress\").Cells(1, n).Value = filename\nwb.Sheets(\"d_eff_stress\").Range(Cells(3, n), Cells(100, n)).Value = varray1\nwb.Sheets(\"eff_stress\").Cells(1, n).Value = filename\nwb.Sheets(\"eff_stress\").Range(Cells(3, n), Cells(100, n)).Value = varray2\n</code></pre>\n\n<p>The solution: full reference to the range... I could have known</p>\n\n<pre><code>Workbooks(root).Activate\nDim wb As Workbook\nSet wb = Application.Workbooks(root)\n\nwb.Sheets(\"d_eff_stress\").Cells(1, n).Value = filename\nwb.Sheets(\"d_eff_stress\").Range(wb.Sheets(\"d_eff_stress\").Cells(3, n), wb.Sheets(\"d_eff_stress\").Cells(100, n)).Value = varray1\nwb.Sheets(\"eff_stress\").Cells(1, n).Value = filename\nwb.Sheets(\"eff_stress\").Range(wb.Sheets(\"eff_stress\").Cells(3, n), wb.Sheets(\"eff_stress\").Cells(100, n)).Value = varray2\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1456343314, "post_id": 35611548, "comment_id": 58907284, "body": "Concatenate a,b and c then sort it and use built in excel subtotal to sum d at every change in concatenation? Edit: no delete though :/"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1456345379, "post_id": 35611548, "comment_id": 58908551, "body": "lol @Jeeped I was in the middle of writing an answer XD"}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1456345685, "post_id": 35611548, "comment_id": 58908732, "body": "@findwindow If it&#39;s different from the ones pointed out by Jeeped, then go ahead... the more options, the better :)"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1456345768, "post_id": 35611548, "comment_id": 58908780, "body": "Can&#39;t. Question is closed."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1456346057, "post_id": 35611548, "comment_id": 58908958, "body": "Two closely related answers already on the site would be <a href=\"http://stackoverflow.com/questions/29384575/combine-rows-sum-values-in-a-worksheet\">Combine Rows &amp; Sum Values in a Worksheet</a> for summing and deleting duplicates and <a href=\"http://stackoverflow.com/questions/20227196/excel-vba-combine-rows-with-duplicate-values-in-one-cell-and-merge-values-in-o/32546352#32546352\">Combine rows with duplicate values in one cell and merge values in other cell</a> demonstrates string concatenation as well as summing values."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1456346241, "post_id": 35611548, "comment_id": 58909053, "body": "@findwindow It has been undeleted, I would like to see your approach."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1456346282, "post_id": 35611548, "comment_id": 58909067, "body": "@findwindow - I&#39;ve consolidated the links to a single comment and reopened the question if you want to take a crack at it."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1456346365, "post_id": 35611548, "comment_id": 58909100, "body": "lol not going to embarrass myself if Scott already posted an answer XD"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1456346412, "post_id": 35611548, "comment_id": 58909122, "body": "@findwindow you put too much credit in my abilities,  Yours may be better."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1456346449, "post_id": 35611548, "comment_id": 58909145, "body": "lol I have seen your answers. I went non vba."}], "answers": [{"comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1456346700, "post_id": 35612344, "comment_id": 58909281, "body": "Yea. Better than mine ^_^;"}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1456433379, "post_id": 35612344, "comment_id": 58957459, "body": "What if there are more columns to sum? Let&#39;s say I also have values in columns E, F, G, H, I, J, K, L, M, N, etc... which also need to be grouped when values in A, B and C coincide. Is this method still efficient?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1456433908, "post_id": 35612344, "comment_id": 58957818, "body": "@N.Pavon you would just need to add the logic to place the sumifs in an empty column then move the values, this is not using loops so it is still very efficient."}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1456434156, "post_id": 35612344, "comment_id": 58957952, "body": "But what if there were 55 columns with values that need to be added, would it be better to use a loop to fill the &quot;empty&quot; columns and then move them?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1456435135, "post_id": 35612344, "comment_id": 58958554, "body": "It can be done without  loops,  that is the beauty of R1C1. @N.Pavon"}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1456435221, "post_id": 35612344, "comment_id": 58958601, "body": "Can you enlighten me? I actually don&#39;t understand the use of R1C1 :("}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1456435653, "post_id": 35612344, "comment_id": 58958864, "body": "So if there were 55 columns: <code>Range(&quot;BM1:BM&quot; &amp; lastrw).Resize(,55).FormulaR1C1 = &quot;=SUMIFs(C[-61],C1,RC1,C2,RC2,C3,RC3)&quot;</code> Then <code>Range(&quot;D1:D&quot; &amp; lastrw).resize(,55).Value = Range(&quot;BM1:BM&quot; &amp; lastrw).Resize(,55).Value</code>then <code>Range(&quot;BM1:BM&quot; &amp; lastrw).Resize(,55).ClearContents</code> @N.Pavon"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1456435826, "post_id": 35612344, "comment_id": 58958949, "body": "@N.Pavon I changed something in the last comment make sure you use the edit."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1456345472, "creation_date": 1456345472, "answer_id": 35612344, "question_id": 35611548, "link": "https://stackoverflow.com/questions/35611548/sum-duplicate-rows-and-then-delete-all-duplicates/35612344#35612344", "title": "Sum duplicate rows and then delete all duplicates", "body": "<p>Here is a simple code:</p>\n\n<pre><code>Sub remdup()\n    Dim ws As Worksheet\n    Dim lastrw As Long\n    Set ws = ActiveSheet\n    lastrw = ws.Range(\"A\" &amp; ws.Rows.Count).End(xlUp).Row\n    ws.Range(\"E1:E\" &amp; lastrw).FormulaR1C1 = \"=SUMIFs(C[-1],C[-4],RC[-4],C[-3],RC[-3],C[-2],RC[-2])\"\n    ws.Range(\"D1:D\" &amp; lastrw).Value = ws.Range(\"E1:E\" &amp; lastrw).Value\n    ws.Range(\"E1:E\" &amp; lastrw).ClearContents\n    With ws.Range(\"A1:D\" &amp; lastrw)\n        .Value = .Value\n        .RemoveDuplicates Array(1, 2, 3), xlNo\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1290, "favorite_count": 0, "accepted_answer_id": 35612344, "answer_count": 1, "score": 2, "last_activity_date": 1456346066, "creation_date": 1456343020, "last_edit_date": 1456343538, "question_id": 35611548, "link": "https://stackoverflow.com/questions/35611548/sum-duplicate-rows-and-then-delete-all-duplicates", "title": "Sum duplicate rows and then delete all duplicates", "body": "<p>I have an Excel Sheet where some rows may contain the same data as other rows, except for one column. I need a macro to sum all the values in that column and delete all the duplicates, except for the first one, which contains the sum of the rest. For example:</p>\n\n<pre><code>   A   B   C   D\n1  a   b   c   d\n2  n   j   i   o\n3  a   b   c   p\n4  v   y   e   b\n5  a   b   c   m\n6  .   .   .   .\n</code></pre>\n\n<p>In this case, the code must delete rows 3 and 5 (because they are \"duplicates\" of row 1), and replace the column D of row 1 with d+p+m. I managed to come up with the following code:</p>\n\n<pre><code>For j = 1 To Range(\"A1\").End(xlDown).Row\n    For i = j + 1 To Range(\"A1\").End(xlDown).Row\n        If Cells(j, 1).value = Cells(i, 1).value And Cells(j, 2).value = Cells(i, 2).value And Cells(j, 3).value = Cells(i, 3).value Then\n            Cells(j, 6) = Cells(i, 6).value + Cells(j, 6).value\n            Rows(i).Delete Shift:=xlUp\n            i = i - 1\n        End If\n    Next i\nNext j\n</code></pre>\n\n<p>But as you may have already noticed, it's very inefficient and basic. Any better ideas?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1456349497, "creation_date": 1456349497, "answer_id": 35613559, "question_id": 35611444, "link": "https://stackoverflow.com/questions/35611444/replying-to-an-excel-info-box-from-vba/35613559#35613559", "title": "Replying to an excel info box from vba", "body": "<p>While this does not address the primary point of your question, I would like to point out that the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"nofollow\">Range object</a>s that define your <strong>Sheets(\"Fund Performance\").Range</strong> have no explicit worksheet parent. When left to rely on the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff822753.aspx\" rel=\"nofollow\">ActiveSheet property</a> to define the parent worksheet, this can produce a,</p>\n\n<blockquote>\n  <p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<sub>Runtime error 1004:</sub><br/>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<sup>Application-defined or object-defined error.</sup></p>\n</blockquote>\n\n<p>Best practise is to explicitly define all parent worksheet references for the construction of a Range object.</p>\n\n<pre><code>'verbose method\nSet tableRange = Sheets(\"Fund Performance\").Range(Sheets(\"Fund Performance\").Range(\"C7\"), Sheets(\"Fund Performance\").Range(\"I7\").End(xlDown))\n\n'with ... end with block method; improved readability, faster execution\nWith Worksheets(\"Fund Performance\").\n    Set tableRange = .Range(.Range(\"C7\"), .Range(\"I7\").End(xlDown))\nEnd With\n</code></pre>\n\n<p>In the latter <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow\">With ... End With statement</a> method, note the use of <code>.Range</code> and not <code>Range</code>. The prefix period carries the reference to the parent worksheet noted within the With ... End With block. This means that the parent worksheet reference is only established once and reused. In  the former, verbose method, the parent worksheet reference is established and reestablished three times.</p>\n"}], "owner": {"reputation": 1, "user_id": 5976040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7f05ee280b9379e1ae63eebb413daa9?s=128&d=identicon&r=PG&f=1", "display_name": "EoinM", "link": "https://stackoverflow.com/users/5976040/eoinm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459952584, "creation_date": 1456342650, "last_edit_date": 1459952584, "question_id": 35611444, "link": "https://stackoverflow.com/questions/35611444/replying-to-an-excel-info-box-from-vba", "title": "Replying to an excel info box from vba", "body": "<p>I am trying to convert a querytable to an excel table from vba using the code below.</p>\n\n<pre><code>Set tableRange = Sheets(\"Fund Performance\").Range(Range(\"C7\"),Range(\"I7\").End(xlDown))\nOn Error Resume Next:\n    Sheets(\"Fund Performance\").ListObjects.Add(xlSrcRange, tableRange, , xlYes).Name = Symbol\nOn Error GoTo 0\n</code></pre>\n\n<p>Without the \"On Error Resume Next\" I get an error 1004\nTable cannot overlap a range that contains a pivot table report, <strong>query results</strong>, protected cells or another table.</p>\n\n<p>If I include it, the error does not show up but the table is not created either.</p>\n\n<p>Any advice for dealing with this or alternative method to create excel table from querytable?</p>\n"}, {"tags": ["forms", "ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1456346419, "post_id": 35611307, "comment_id": 58909133, "body": "The user shouldn&#39;t need to enter their &quot;user type&quot;, only their username and password.  You already have the type defined in the user table. Validate username/pw against your users table, returning the UserId and UserType.  It would help to explain exactly what it is you want to achieve here."}, {"owner": {"reputation": 37, "user_id": 4989634, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Y7UOoQjBcxo/AAAAAAAAAAI/AAAAAAAABdg/bOdU2Xg6HUg/photo.jpg?sz=128", "display_name": "Haytham Egbariah", "link": "https://stackoverflow.com/users/4989634/haytham-egbariah"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1456347972, "post_id": 35611307, "comment_id": 58910003, "body": "What Im trying to do that I have an App , and I have more than one Manager but they have different privileges, which means I want when the Admin put user name : admin and his password so when He click on Login its will redirect to AdminMain , in the same Form, if the Manager put his username and his password and click on Login button will redirect him to ManagerMain and so on .."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 4989634, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Y7UOoQjBcxo/AAAAAAAAAAI/AAAAAAAABdg/bOdU2Xg6HUg/photo.jpg?sz=128", "display_name": "Haytham Egbariah", "link": "https://stackoverflow.com/users/4989634/haytham-egbariah"}, "edited": false, "score": 0, "creation_date": 1456355546, "post_id": 35613650, "comment_id": 58913825, "body": "Nothing Happend, the code is ok but no results no fails, Here is the link of the LoginDemo :  <a href=\"https://files.fm/down.php?i=xnsyjjy7&amp;n=LoginDemo.zip\" rel=\"nofollow noreferrer\">files.fm/down.php?i=xnsyjjy7&amp;n=LoginDemo.zip</a>  I think there is no way to have more  than 2 usertypes, I searched on google, seems no one try that before!? wired .."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 37, "user_id": 4989634, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Y7UOoQjBcxo/AAAAAAAAAAI/AAAAAAAABdg/bOdU2Xg6HUg/photo.jpg?sz=128", "display_name": "Haytham Egbariah", "link": "https://stackoverflow.com/users/4989634/haytham-egbariah"}, "edited": false, "score": 0, "creation_date": 1456362573, "post_id": 35613650, "comment_id": 58916109, "body": "See my edit above - try that. Your link is not accessible: try dropbox instead."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1456362788, "last_edit_date": 1456362788, "creation_date": 1456349818, "answer_id": 35613650, "question_id": 35611307, "link": "https://stackoverflow.com/questions/35611307/add-usertype-to-login-form-access-2013-password-and-username-and-usertype/35613650#35613650", "title": "Add UserType to Login Form Access 2013 password and username and usertype", "body": "<p>Untested:</p>\n\n<pre><code>Private Sub btnLogin_Click()\n\n    Const USR_TYPE_ADMIN As String = \"Admin\"\n    Const USR_TYPE_NSS As String = \"NSS\"\n\n    Dim rst As Recordset, ut As String\n\n    Set rst = CurrentDb.OpenRecordset(\"SELECT UserType From tblUsers WHERE UserName = '\" &amp; _\n                                 txtUserName &amp; \"' AND Password = '\" &amp; txtPassword &amp; \"'\")\n\n    If Not rst.EOF Then\n\n        bCanSafleyClose = True\n        ut = rst.Fields(\"UserType\").Value\n\n        If ut = USR_TYPE_ADMIN Then\n            DoCmd.Close '&lt;&lt;added\n            DoCmd.OpenForm \"AdminMain\"\n        ElseIf ut = USR_TYPE_NSS Then\n            DoCmd.Close '&lt;&lt;added\n            DoCmd.OpenForm \"ReportsMain\"\n        Else\n            'anything else?\n        End If\n\n\n    Else\n        MsgBox \"Error!\"\n        bCanSafleyClose = False\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 37, "user_id": 4989634, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Y7UOoQjBcxo/AAAAAAAAAAI/AAAAAAAABdg/bOdU2Xg6HUg/photo.jpg?sz=128", "display_name": "Haytham Egbariah", "link": "https://stackoverflow.com/users/4989634/haytham-egbariah"}, "is_accepted": false, "score": 0, "last_activity_date": 1456356612, "creation_date": 1456356612, "answer_id": 35615339, "question_id": 35611307, "link": "https://stackoverflow.com/questions/35611307/add-usertype-to-login-form-access-2013-password-and-username-and-usertype/35615339#35615339", "title": "Add UserType to Login Form Access 2013 password and username and usertype", "body": "<p>Solution :</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\n\n\n\nPrivate Sub btnLogin_Click()\nDim UserLevel As Integer\n\nIf IsNull(Me.txtUserName) Then\nMsgBox \"Please Enter username\", vbInformation, \"LoginID required\"\nMe.txtUserName.SetFocus\n\nElseIf IsNull(Me.txtPassword) Then\nMsgBox \"Please Enter Password\", vbInformation, \"Password required!\"\nMe.txtPassword.SetFocus\n\nElse\n'process the job\nIf (IsNull(DLookup(\"[UserName]\", \"tblUsers\", \"[UserName] ='\" &amp; Me.txtUserName.Value &amp; \"'  And Password = '\" &amp; Me.txtPassword.Value &amp; \"'\"))) Then\nMsgBox \"Incorrect User or Password\"\n\nElse\n\n    UserLevel = DLookup(\"SecuirtyLevel\", \"tblUsers\", \"[UserName] ='\" &amp; Me.txtUserName.Value &amp; \"'\")\n    DoCmd.Close\n        If UserLevel = 1 Then\n    'MsgBox \"LoginID and Password is correct\"\n    DoCmd.OpenForm \"AdminMain\"\n\n    ElseIf UserLevel = 2 Then\n                  DoCmd.OpenForm \"ReportsMain\"\n                  ElseIf UserLevel = 3 Then\n                  DoCmd.OpenForm \"ReportsMain\"\n                                Else\n                            DoCmd.Close\n                            End If\n                            End If\n\n        End If\n\nEnd Sub\n</code></pre>\n\n<p>Thank you Andre and Tim :) </p>\n"}], "owner": {"reputation": 37, "user_id": 4989634, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Y7UOoQjBcxo/AAAAAAAAAAI/AAAAAAAABdg/bOdU2Xg6HUg/photo.jpg?sz=128", "display_name": "Haytham Egbariah", "link": "https://stackoverflow.com/users/4989634/haytham-egbariah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 208, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1456362788, "creation_date": 1456342217, "question_id": 35611307, "link": "https://stackoverflow.com/questions/35611307/add-usertype-to-login-form-access-2013-password-and-username-and-usertype", "title": "Add UserType to Login Form Access 2013 password and username and usertype", "body": "<p>I just wasted more than 7 Hours trying to solve this problem that I had When I was trying to make a Login Form,</p>\n\n<p>I have tblUsers that has :</p>\n\n<pre><code>UserID |   UserName | Password  | UserType\n\n1      |    Admin   | password  | admin\n\n2      |   Mark     | password2 |  BSS\n</code></pre>\n\n<p>I wrote this code : </p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nDim bCanSafleyClose As Boolean\n\n\nPrivate Sub btnLogin_Click()\nDim rst As Recordset\n\nSet rst = CurrentDb.OpenRecordset(\"SELECT * From tblUsers WHERE UserName = '\" &amp; txtUserName &amp; \"' AND Password = '\" &amp; txtPassword &amp; \"' AND UserType ='\" &amp; cmbxUserType &amp; \"';\")\n\nIf rst.RecordCount = 1 Then\nbCanSafleyClose = True\nDoCmd.Close\nIf cmbxUserType = \"Admin\" Then  ==&gt; This failed I don't know why\nDoCmd.OpenForm \"AdminMain\"\nEnd If\nIf cmbxUserType = \"NSS\" Then\nDoCmd.OpenForm \"ReportsMain\"\nEnd If\n\nElse\nMsgBox \"Error!\"\nbCanSafleyClose = False\n\nEnd If\n\nEnd Sub\n\nPrivate Sub Form_Load()\nbCanSafleyClose = False\nEnd Sub\n\nPrivate Sub Form_Unload(Cancel As Integer)\n'Cancel = Not bCanSafleyClose\nEnd Sub\n</code></pre>\n\n<p>But that is doesn't working ! </p>\n\n<p>I hope that someone Can figure out this problem and help me to solve it :)\nThanks .. </p>\n"}, {"tags": ["vba", "email", "outlook"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1456343134, "post_id": 35611212, "comment_id": 58907184, "body": "<code>itm</code> is the message object you need to work with - there is no need to loop over the Inbox to find it."}, {"owner": {"reputation": 45, "user_id": 5976441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d0e152cba750a30297ff2fc4c006618?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/5976441/nick"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1456351606, "post_id": 35611212, "comment_id": 58912028, "body": "What would be the best way to implement itm as the object here?"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 5976441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d0e152cba750a30297ff2fc4c006618?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/5976441/nick"}, "edited": false, "score": 0, "creation_date": 1456358929, "post_id": 35614819, "comment_id": 58914992, "body": "Thanks Tim! Some slight tweaking and this is now working on all incoming message from the rule. I appreciate the help."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1456354163, "creation_date": 1456354163, "answer_id": 35614819, "question_id": 35611212, "link": "https://stackoverflow.com/questions/35611212/saving-emails-with-rule-calling-vba-script/35614819#35614819", "title": "Saving Emails with Rule Calling VBA Script", "body": "<p>Untested:</p>\n\n<pre><code>Public Sub SaveMessageAsMsg(itm As Outlook.MailItem)\n\n    Const ENVIRO As String = \"c:\\MyFolder\\\" 'sets folder to save messgaes to\n\n    Dim dtDate As Date\n    Dim sName As String\n    Dim SndName As String\n\n    If itm.MessageClass = \"IPM.Note\" Then\n\n        sName = itm.Subject\n        SndName = itm.SenderName\n        dtDate = itm.ReceivedTime\n\n        ReplaceCharsForFileName sName, \"-\"\n        sName = Right(sName, 100)\n\n        'formats the file name as \"Sender name - Date - Time - Subject\"\n        sName = SndName &amp; \" - \" &amp; Format(dtDate, \"mm-dd-yyyy\", vbUseSystemDayOfWeek, _\n                vbUseSystem) &amp; \" - \" &amp; Format(dtDate, \"hhnnss\", _\n                vbUseSystemDayOfWeek, vbUseSystem) &amp; \" - \" &amp; sName &amp; \".msg\"\n\n        Debug.Print ENVIRO &amp; sName\n        oMail.SaveAs ENVIRO &amp; sName, olMsg\n\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 45, "user_id": 5976441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d0e152cba750a30297ff2fc4c006618?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/5976441/nick"}, "is_accepted": false, "score": 0, "last_activity_date": 1456359128, "creation_date": 1456359128, "answer_id": 35615824, "question_id": 35611212, "link": "https://stackoverflow.com/questions/35611212/saving-emails-with-rule-calling-vba-script/35615824#35615824", "title": "Saving Emails with Rule Calling VBA Script", "body": "<p>Final Code:</p>\n\n<pre><code>Public Sub SaveMessageAsMsg(itm As Outlook.MailItem)\n\nConst ENVIRO As String = \"c:\\MyFolder\\\" 'sets folder to save messages to\n\n  Dim oMail As Outlook.MailItem\n  Dim dtDate As Date\n  Dim sName As String\n  Dim SndName As String\n\n\n If itm.MessageClass = \"IPM.Note\" Then\n\nSet oMail = itm\n\n    sName = itm.Subject\n    SndName = itm.SenderName\n    dtDate = itm.ReceivedTime\n\n    ReplaceCharsForFileName sName, \"-\"\n    sName = Right(sName, 100)\n\n    'formats the file name as \"Sender name - Date - Time - Subject\"\n    sName = SndName &amp; \" - \" &amp; Format(dtDate, \"mm-dd-yyyy\",  vbUseSystemDayOfWeek, _\n            vbUseSystem) &amp; \" - \" &amp; Format(dtDate, \"hhnnss\", _\n            vbUseSystemDayOfWeek, vbUseSystem) &amp; \" - \" &amp; sName &amp; \".msg\"\n\n    Debug.Print ENVIRO &amp; sName\n    oMail.saveas ENVIRO &amp; sName, olMsg\n\n  End If\n\n  End Sub\n\n  Private Sub ReplaceCharsForFileName(sName As String, _\n  sChr As String _\n)\n\n'Replaces the invalid characters you could use RegX with vbscript instead\n\n sName = Replace(sName, \"\u00b4\", \"'\")\n sName = Replace(sName, \"`\", \"'\")\n sName = Replace(sName, \"{\", \"(\")\n sName = Replace(sName, \"[\", \"(\")\n sName = Replace(sName, \"]\", \")\")\n sName = Replace(sName, \"}\", \")\")\n sName = Replace(sName, \"  \", \" \")     'Replace two spaces with one space\n sName = Replace(sName, \"   \", \" \")    'Replace three spaces with one space\n sName = Replace(sName, \"    \", \" \")   'Replace four spaces with one space\n sName = Replace(sName, \"     \", \" \")  'Replace five spaces with one space\n sName = Replace(sName, \"      \", \" \") 'Replace six spaces with one space\n\n 'Cut out invalid signs.\n sName = Replace(sName, \": \", \"_\")     'Colan followded by a space\n sName = Replace(sName, \":\", \"_\")      'Colan with no space\n sName = Replace(sName, \"/\", \"_\")\n sName = Replace(sName, \"\\\", \"_\")\n sName = Replace(sName, \"*\", \"_\")\n sName = Replace(sName, \"?\", \"_\")\n sName = Replace(sName, \"\"\"\", \"'\")\n sName = Replace(sName, \"&lt;\", \"_\")\n sName = Replace(sName, \"&gt;\", \"_\")\n sName = Replace(sName, \"|\", \"_\")\n sName = Replace(sName, \"%\", \"pc\")\n sName = Replace(sName, vbTab, \" \")     'Replaces vbTab as this is sometimes a delimiter if copied from excel\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 5976441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d0e152cba750a30297ff2fc4c006618?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/5976441/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 35614819, "answer_count": 2, "score": 1, "last_activity_date": 1593519068, "creation_date": 1456341938, "last_edit_date": 1593519068, "question_id": 35611212, "link": "https://stackoverflow.com/questions/35611212/saving-emails-with-rule-calling-vba-script", "title": "Saving Emails with Rule Calling VBA Script", "body": "<p>I'm trying to save all emails received by a certain address to my hard drive. I've pieced together / edited the following code but it will not work with my rule. When I run the rule manually it works fine. When I run the code manually it works fine. But when I send a test email from the address I have the rule set for it will not save the email.</p>\n\n<pre><code>Public Sub SaveMessageAsMsg(itm As Outlook.MailItem)\n\n  Dim oMail As Outlook.MailItem\n  Dim objItem As Object\n  Dim sPath As String\n  Dim dtDate As Date\n  Dim sName As String\n  Dim SndName As String\n  Dim enviro As String\n  Dim ns As Outlook.NameSpace\n  Dim iInbox As MAPIFolder\n\n  enviro = \"c:\\MyFolder\\\" 'sets folder to save messgaes to\n\n\n  Set ns = Application.GetNamespace(\"MAPI\")\n  Set iInbox = ns.GetDefaultFolder(olFolderInbox)\n\n  For Each objItem In iInbox.Items\n\n  'I've tried the below method and get the same results\n    'For i = iInbox.Items.Count To 1 Step -1\n    'Set objItem = iInbox.Items(i)\n\nIf objItem.MessageClass = \"IPM.Note\" Then\nSet oMail = objItem\n\n    sName = oMail.Subject\n    SndName = oMail.SenderName\n    dtDate = oMail.ReceivedTime\n\n    ReplaceCharsForFileName sName, \"-\"\n\n        sName = Right(sName, 100)\n'formats the file name as \"Sender name - Date - Time - Subject\"\n            sName = SndName &amp; \" - \" &amp; Format(dtDate, \"mm-dd-yyyy\",  vbUseSystemDayOfWeek, _\n            vbUseSystem) &amp; \" - \" &amp; Format(dtDate, \"hhnnss\", _\n            vbUseSystemDayOfWeek, vbUseSystem) &amp; \" - \" &amp; sName &amp; \".msg\"\n\n    sPath = enviro\n\n    Debug.Print sPath &amp; sName\n    oMail.saveas sPath &amp; sName, olMsg\n\nEnd If\n\nSet objAtt = Nothing\n\nNext\n\nEnd Sub\n\n  Private Sub ReplaceCharsForFileName(sName As String, _\n    sChr As String _\n  )\n\n  'Replaces the invalid characters you could use RegX with vbscript instead\n\n   sName = Replace(sName, \"\u00b4\", \"'\")\n   sName = Replace(sName, \"`\", \"'\")\n   sName = Replace(sName, \"{\", \"(\")\n   sName = Replace(sName, \"[\", \"(\")\n   sName = Replace(sName, \"]\", \")\")\n   sName = Replace(sName, \"}\", \")\")\n   sName = Replace(sName, \"  \", \" \")     'Replace two spaces with one space\n   sName = Replace(sName, \"   \", \" \")    'Replace three spaces with one       space\n   sName = Replace(sName, \"    \", \" \")   'Replace four spaces with one space\n   sName = Replace(sName, \"     \", \" \")  'Replace five spaces with one space\n   sName = Replace(sName, \"      \", \" \") 'Replace six spaces with one space\n\n   'Cut out invalid signs.\n   sName = Replace(sName, \": \", \"_\")     'Colan followded by a space\n   sName = Replace(sName, \":\", \"_\")      'Colan with no space\n   sName = Replace(sName, \"/\", \"_\")\n   sName = Replace(sName, \"\\\", \"_\")\n   sName = Replace(sName, \"*\", \"_\")\n   sName = Replace(sName, \"?\", \"_\")\n   sName = Replace(sName, \"\"\"\", \"'\")\n   sName = Replace(sName, \"&lt;\", \"_\")\n   sName = Replace(sName, \"&gt;\", \"_\")\n   sName = Replace(sName, \"|\", \"_\")\n   sName = Replace(sName, \"%\", \"pc\")\n   sName = Replace(sName, vbTab, \" \")     'Replaces vbTab as this is  sometimes a delimiter if copied from excel\n\n  End Sub\n</code></pre>\n\n<p>I'm fairly certain the issue lies with this first line, but I'm not sure how to fix it.</p>\n\n<pre><code>Public Sub SaveMessageAsMsg(itm As Outlook.MailItem)\n</code></pre>\n\n<p>Thank you</p>\n"}, {"tags": ["vba", "excel", "ms-word", "clipboard"], "comments": [{"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 7, "creation_date": 1456339610, "post_id": 35610429, "comment_id": 58905134, "body": "FM20.dll when you browse, I think"}, {"owner": {"reputation": 556, "user_id": 5932704, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-i6RfINhkji4/AAAAAAAAAAI/AAAAAAAAb4A/paEKjYmQFyU/photo.jpg?sz=128", "display_name": "Jon", "link": "https://stackoverflow.com/users/5932704/jon"}, "reply_to_user": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1456339763, "post_id": 35610429, "comment_id": 58905218, "body": "@Raystafarian: Thank you, but actually, I answered my own question from the start.  I was posting this because because I had struggled with this in the past and had a hard time finding an easy way to get the library in place.  Why browse around for .dll files when you can just add a form to the project and have it appear that way?"}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1456339812, "post_id": 35610429, "comment_id": 58905262, "body": "The answer didn&#39;t show when I clicked - sorry"}, {"owner": {"reputation": 556, "user_id": 5932704, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-i6RfINhkji4/AAAAAAAAAAI/AAAAAAAAb4A/paEKjYmQFyU/photo.jpg?sz=128", "display_name": "Jon", "link": "https://stackoverflow.com/users/5932704/jon"}, "reply_to_user": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 1, "creation_date": 1456348065, "post_id": 35610429, "comment_id": 58910043, "body": "@Raystafarian: Yes, browsing to the FM20.dll file (in the Visual Basic Editor ---&gt;Tools---References----&gt;Browse button) worked as well. Good to be aware of that method as well I think.  Thank you."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1456390409, "post_id": 35610429, "comment_id": 58927051, "body": "You could also late bind instead. Also, be aware that there are issues with the <code>DataObject</code> and Windows 8 versions whereby you end up with just two odd characters being returned from the clipboard rather than the actual text. The Win API is a much safer option."}, {"owner": {"reputation": 556, "user_id": 5932704, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-i6RfINhkji4/AAAAAAAAAAI/AAAAAAAAb4A/paEKjYmQFyU/photo.jpg?sz=128", "display_name": "Jon", "link": "https://stackoverflow.com/users/5932704/jon"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1456465151, "post_id": 35610429, "comment_id": 58969412, "body": "@Rory: Appreciate the information. I was not aware of the <code>DataObject</code> issue with Windows 8 versions. Regarding late bind, I still haven&#39;t become comfortable coding without IntelliSense feature, but helpful to be reminded of that option."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1379931"}, "edited": false, "score": 1, "creation_date": 1457001570, "post_id": 35610430, "comment_id": 59211194, "body": "Does anything else get added when you add a form that doesn&#39;t get deleted when you delete it later?"}, {"owner": {"reputation": 556, "user_id": 5932704, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-i6RfINhkji4/AAAAAAAAAAI/AAAAAAAAb4A/paEKjYmQFyU/photo.jpg?sz=128", "display_name": "Jon", "link": "https://stackoverflow.com/users/5932704/jon"}, "edited": false, "score": 0, "creation_date": 1457019245, "post_id": 35610430, "comment_id": 59224346, "body": "@bibadia: That is important to be aware of, and I don&#39;t know the answer to that.  I just tested adding a form and removing one, and at least no additional <b>checked</b> library appeared other than the &quot;Forms&quot; library we were interested in.  But, as you&#39;re implying, that doesn&#39;t mean some other unchecked .dll wasn&#39;t added farther down the list, which would be more difficult to see of course.  Maybe this would get answered as a new question."}], "tags": [], "owner": {"reputation": 556, "user_id": 5932704, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-i6RfINhkji4/AAAAAAAAAAI/AAAAAAAAb4A/paEKjYmQFyU/photo.jpg?sz=128", "display_name": "Jon", "link": "https://stackoverflow.com/users/5932704/jon"}, "is_accepted": false, "score": 22, "last_activity_date": 1456339447, "creation_date": 1456339447, "answer_id": 35610430, "question_id": 35610429, "link": "https://stackoverflow.com/questions/35610429/why-do-i-not-see-the-microsoft-forms-2-0-object-library/35610430#35610430", "title": "Why do I not see the Microsoft Forms 2.0 Object Library?", "body": "<p>If you add a UserForm to your project, the library will get automatically added.  If you don't need the UserForm, you can always delete it later.</p>\n\n<p><a href=\"https://i.stack.imgur.com/1Z9In.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/1Z9In.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 556, "user_id": 5932704, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-i6RfINhkji4/AAAAAAAAAAI/AAAAAAAAb4A/paEKjYmQFyU/photo.jpg?sz=128", "display_name": "Jon", "link": "https://stackoverflow.com/users/5932704/jon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35868, "favorite_count": 1, "answer_count": 1, "score": 16, "last_activity_date": 1456339447, "creation_date": 1456339447, "last_edit_date": 1531164843, "question_id": 35610429, "link": "https://stackoverflow.com/questions/35610429/why-do-i-not-see-the-microsoft-forms-2-0-object-library", "title": "Why do I not see the Microsoft Forms 2.0 Object Library?", "body": "<p>I would like to use this library to work with the clipboard.  I expect to see it as in the screenshot below, but I can't find it in my list of reference libraries.  How can I make it appear?</p>\n\n<p><a href=\"https://i.stack.imgur.com/T5feY.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/T5feY.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "if-statement"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1456338515, "post_id": 35610010, "comment_id": 58904458, "body": "Are you using <code>Option Explicit</code> ?  You declare and assign C and D but then go on to use <code>shCurves</code> and <code>ShData</code>"}, {"owner": {"reputation": 47, "user_id": 5941479, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7c1dbd9fe91b73d50a9949b445615813?s=128&d=identicon&r=PG&f=1", "display_name": "Duranchula", "link": "https://stackoverflow.com/users/5941479/duranchula"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1456423940, "post_id": 35610010, "comment_id": 58951684, "body": "Just because I&#39;m a noob and I don&#39;t really know what I am doing, what is option explicit? also how would you do this most efficiently?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1456424603, "post_id": 35610010, "comment_id": 58952063, "body": "What is Option Explicit = What is Google ;-)"}, {"owner": {"reputation": 47, "user_id": 5941479, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7c1dbd9fe91b73d50a9949b445615813?s=128&d=identicon&r=PG&f=1", "display_name": "Duranchula", "link": "https://stackoverflow.com/users/5941479/duranchula"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1456425346, "post_id": 35610010, "comment_id": 58952553, "body": "Fair enough Mr. Tim! Here&#39;s another question for you: So with my array of strings: Curves(0) = &quot;260nm&quot;               Cond% and P960_Flow are the only two that do not register a value with the instr function, I realize its because the preceding one in each case shares the beginning characters but how can I fix this?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1456426910, "post_id": 35610010, "comment_id": 58953619, "body": "It&#39;s difficult to answer this without seeing the headers you&#39;re trying to match against.  Can you share the workbook?"}, {"owner": {"reputation": 47, "user_id": 5941479, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7c1dbd9fe91b73d50a9949b445615813?s=128&d=identicon&r=PG&f=1", "display_name": "Duranchula", "link": "https://stackoverflow.com/users/5941479/duranchula"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1456431234, "post_id": 35610010, "comment_id": 58956238, "body": "Yes I can share it, but I don&#39;t see any way to on here, do you want me to email it or something?"}, {"owner": {"reputation": 47, "user_id": 5941479, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7c1dbd9fe91b73d50a9949b445615813?s=128&d=identicon&r=PG&f=1", "display_name": "Duranchula", "link": "https://stackoverflow.com/users/5941479/duranchula"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1456431331, "post_id": 35610010, "comment_id": 58956290, "body": "Sorry to bombard you with questions but a more frustrating one I am having is with declaring worksheet variables by their code name rather than the name on the tab. I have: dim z as worksheet, set z=codename. This returns an error, do you know the proper syntax here? ps I have been googling this for about an hour with nothing ;P"}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 5941479, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7c1dbd9fe91b73d50a9949b445615813?s=128&d=identicon&r=PG&f=1", "display_name": "Duranchula", "link": "https://stackoverflow.com/users/5941479/duranchula"}, "edited": false, "score": 0, "creation_date": 1456423787, "post_id": 35610191, "comment_id": 58951587, "body": "Thank you, I am still learning so I was unaware that &quot;....&quot; is literal, I though you had to always have those when dealing with strings."}], "tags": [], "owner": {"reputation": 8784, "user_id": 116830, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/67a8105cf7a85838072d606d4230cdd6?s=128&d=identicon&r=PG", "display_name": "Gratzy", "link": "https://stackoverflow.com/users/116830/gratzy"}, "is_accepted": true, "score": 4, "last_activity_date": 1470782707, "last_edit_date": 1470782707, "creation_date": 1456338650, "answer_id": 35610191, "question_id": 35610010, "link": "https://stackoverflow.com/questions/35610010/vba-instr-function/35610191#35610191", "title": "VBA InStr function", "body": "<p>Why do you have double quotes around your arrays?</p>\n\n<pre><code>StrG = InStr(\"Outputs(Z)\", \"Curves(k)\")\n</code></pre>\n\n<p>You're using the string literals, not the variables.  Remove the double quotes:</p>\n\n<pre><code>StrG = InStr(Outputs(Z), Curves(k))\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 5941479, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7c1dbd9fe91b73d50a9949b445615813?s=128&d=identicon&r=PG&f=1", "display_name": "Duranchula", "link": "https://stackoverflow.com/users/5941479/duranchula"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 896, "favorite_count": 0, "accepted_answer_id": 35610191, "answer_count": 1, "score": 1, "last_activity_date": 1470782707, "creation_date": 1456338087, "last_edit_date": 1456338345, "question_id": 35610010, "link": "https://stackoverflow.com/questions/35610010/vba-instr-function", "title": "VBA InStr function", "body": "<p>HI I am trying to search for a sub string within a string and if the sub string is found then I want to paste the output to my spreadsheet. I am using th InStr function with a conditional statement &lt;> , so that if mt InStr function value is not equal to 0 I know I have a match. I do not get any errors when I run the code but it does not display the result on the sheet. SOS!! :)</p>\n\n<pre><code>Sub unicornhorn()\n'Generates user friendly graphs from raw unicorn input data\n\n    Dim columns As Integer\n    Dim rows As Integer\n    Dim Outputs(50) As String\n    Dim LastRow As Integer\n    Dim StrG As Integer\n    Dim xaxis As Range\n    Dim yaxis As Range\n\n    Dim nLeft As Double: nLeft = 20\n    Dim nTop As Double: nTop = 20\n    Dim start As Double: start = start + 2\n    Dim finish As Double: finish = finish + 2\n\n\n    Dim Curves(14) As String\n        Curves(0) = \"260nm\"\n        Curves(1) = \"280nm\"\n        Curves(2) = \"214nm\"\n        Curves(3) = \"Cond\"\n        Curves(4) = \"Cond%\"\n        Curves(5) = \"Conc\"\n        Curves(6) = \"pH\"\n        Curves(7) = \"Pressure\"\n        Curves(8) = \"Flow\"\n        Curves(9) = \"Temp\"\n        Curves(10) = \"Fractions\"\n        Curves(11) = \"inject\"\n        Curves(12) = \"logbook\"\n        Curves(13) = \"P960_Press\"\n        Curves(14) = \"P960_Flow\"\n\n    Dim D As Worksheet\n    Set D = Worksheets(\"DATA\")\n    Dim C As Worksheet\n    Set C = Worksheets(\"sheet1\")\n\n\n    'defines data range\n    columns = shCurves.Cells(1, shCurves.columns.Count).End(xlToLeft).Column\n    'XXreturn check to sheet\n    ShData.Cells(5, 5).Value = columns\n    rows = shCurves.Cells(shCurves.rows.Count, 1).End(xlUp).Row\n    'XXreturn check to sheet\n    ShData.Cells(5, 6).Value = rows\n\n\n    For Z = 0 To columns\n\n        'loops through array for different curves\n        Outputs(Z) = shCurves.Cells(2, Z * 2 + 1).Value\n\n        'XXreturn check to sheet\n        ShData.Cells(5 + Z, 7).Value = Outputs(Z)\n\n        'Finds last row in column for current curve\n        LastRow = Cells(D.rows.Count, Z * 2 + 1).End(xlUp).Row\n\n\n        For k = 0 To 14\n\n            'finds curve identifyer within string\n            StrG = InStr(\"Outputs(Z)\", \"Curves(k)\")\n            If StrG &lt;&gt; 0 Then\n\n\n            ShData.Cells(25 + k, 5).Value = Curves(k)\n\n\n            Exit For\n            End If                  \n\n\n        Next k\n\n    Next Z\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "solver"], "comments": [{"owner": {"reputation": 27, "user_id": 5017166, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KDGLb9PJYSE/AAAAAAAAAAI/AAAAAAAAAC0/buxinEJhZgU/photo.jpg?sz=128", "display_name": "Ted", "link": "https://stackoverflow.com/users/5017166/ted"}, "edited": false, "score": 0, "creation_date": 1458306986, "post_id": 35609953, "comment_id": 59815089, "body": "Somehow the Tools&gt;References&gt; Solver checkbox got unchecked.  Problem solved"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 5017166, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KDGLb9PJYSE/AAAAAAAAAAI/AAAAAAAAAC0/buxinEJhZgU/photo.jpg?sz=128", "display_name": "Ted", "link": "https://stackoverflow.com/users/5017166/ted"}, "edited": false, "score": 0, "creation_date": 1456352906, "post_id": 35610519, "comment_id": 58912699, "body": "Excellent- worked great.  I can use this script 6 times and simply change the D40 address to D59, D78, etc. (stepping down 19 each time).  Thanks a lot!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1456339711, "creation_date": 1456339711, "answer_id": 35610519, "question_id": 35609953, "link": "https://stackoverflow.com/questions/35609953/solver-vba-macro-across-multiple-columns-and-rows/35610519#35610519", "title": "Solver VBA macro across multiple columns and rows", "body": "<p>You can use a loop to run solver on each month:</p>\n\n<pre><code>Sub Tester()\n    Dim c As Range\n    Set c = ActiveSheet.Range(\"D40\")\n    Monthly c\nEnd Sub\n\n\n'solve 12 months\nSub Monthly(c As Range)\n    Dim m  As Long\n    For m = 1 To 12\n\n        SolverReset\n        SolverAdd CellRef:=c.Address(), Relation:=2, FormulaText:=c.Offset(1, 0).Address()\n        SolverOk SetCell:=c.Address(), MaxMinVal:=1, ValueOf:=0, _\n                ByChange:=c.Offset(-16, 0).Address(), Engine:=1, EngineDesc:=\"GRG Nonlinear\"\n        SolverSolve True\n\n        Set c = c.Offset(0, 1)\n    Next m\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 5017166, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KDGLb9PJYSE/AAAAAAAAAAI/AAAAAAAAAC0/buxinEJhZgU/photo.jpg?sz=128", "display_name": "Ted", "link": "https://stackoverflow.com/users/5017166/ted"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1762, "favorite_count": 0, "accepted_answer_id": 35610519, "answer_count": 1, "score": 1, "last_activity_date": 1463450916, "creation_date": 1456337879, "last_edit_date": 1463450916, "question_id": 35609953, "link": "https://stackoverflow.com/questions/35609953/solver-vba-macro-across-multiple-columns-and-rows", "title": "Solver VBA macro across multiple columns and rows", "body": "<p>New to VBA.  Scoured the internet, can't come up with solution (but I learned a lot in the process).</p>\n\n<p>I am running solver to solve for a revenue number that will give me a specified profit margin given certain expenses.  I've got that all set and a Sub that will perform this task properly for one month.  However, I am trying to apply this to 12 columns (12-months).  Then step the loop down 19 rows.  Run solver across those 12 columns and so on 6-times.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>Sub Monthly()\n\n\nSolverReset\nSolverAdd CellRef:=\"$d$40\", Relation:=2, FormulaText:=\"$d$41\"\nSolverOk SetCell:=\"$d$40\", MaxMinVal:=1, ValueOf:=0, ByChange:=\"$d$24\", Engine _\n    :=1, EngineDesc:=\"GRG Nonlinear\"\nSolverSolve True\n\nSolverReset\nSolverAdd CellRef:=\"$e$40\", Relation:=2, FormulaText:=\"$e$41\"\nSolverOk SetCell:=\"$e$40\", MaxMinVal:=1, ValueOf:=0, ByChange:=\"$e$24\", Engine _\n    :=1, EngineDesc:=\"GRG Nonlinear\"\nSolverSolve True\n</code></pre>\n\n<p>This is an example that would get me January and February.  Want it to run through the remaining 10-months (without having to copy and paste this 10-times and manually type in the cell coordinates for F-O columns).  Then the code below is for the step down 19 rows:</p>\n\n<pre><code>SolverReset\nSolverAdd CellRef:=\"$d$59\", Relation:=2, FormulaText:=\"$d$60\"\nSolverOk SetCell:=\"$d$59\", MaxMinVal:=1, ValueOf:=0, ByChange:=\"$d$43\", Engine _\n    :=1, EngineDesc:=\"GRG Nonlinear\"\nSolverSolve True\n\n\nEnd Sub\n</code></pre>\n\n<p>And again, I would like this to run across 12 columns and step down 19 rows to do it again 4 more times.  So the end result is solver running 6 times across 12 columns for a total of 72 times.  I would prefer to not type those cell coordinates that many times, and it's probably taxing on my CPU to do it that way. Thanks!</p>\n\n<p>UPDATE:</p>\n\n<p>I am now getting an error, seemingly for no reason.  This thing was working great.  </p>\n\n<pre><code>Sub MonthlySolve1a()\n    Dim c As Range\n    Set c = ActiveSheet.Range(\"D40\")\n    MonthlySolve1b c\nEnd Sub\n\n'solve 12 months\nSub MonthlySolve1b(c As Range)\nDim m  As Long\nFor m = 1 To 12\n\n    SolverReset\n    SolverAdd CellRef:=c.Address(), Relation:=2, FormulaText:=c.Offset(1, 0).Address()\n    SolverOk SetCell:=c.Address(), MaxMinVal:=1, ValueOf:=0, _\n            ByChange:=c.Offset(-16, 0).Address(), Engine:=1, EngineDesc:=\"GRG Nonlinear\"\n    SolverSolve True\n\n    Set c = c.Offset(0, 1)\nNext m\nEnd Sub\n</code></pre>\n\n<p>I probably did something stupid in my sheet that messed it up, but any insight would be greatly appreciated.  Thanks!</p>\n"}, {"tags": ["excel", "vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1456341164, "creation_date": 1456341164, "answer_id": 35610991, "question_id": 35609935, "link": "https://stackoverflow.com/questions/35609935/vba-to-refresh-link-from-access-tables-to-excel-workbooks/35610991#35610991", "title": "VBA to refresh link from Access tables to Excel Workbooks", "body": "<p>A link will be refreshed - or rather re-read - whenever the linked table is opened, so no user interaction is needed.</p>\n"}], "owner": {"reputation": 1, "user_id": 5974402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef3335060fcb8b1285f451f5f126ead?s=128&d=identicon&r=PG&f=1", "display_name": "F. Smith", "link": "https://stackoverflow.com/users/5974402/f-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 805, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456341289, "creation_date": 1456337823, "last_edit_date": 1456341289, "question_id": 35609935, "link": "https://stackoverflow.com/questions/35609935/vba-to-refresh-link-from-access-tables-to-excel-workbooks", "title": "VBA to refresh link from Access tables to Excel Workbooks", "body": "<p>I have an Access 2010 database that uses 5 tables linked to 5 Excel 2010 workbooks. </p>\n\n<p>The table names match the workbook names (e.g. <code>My_Data1</code> table linked to <code>My_Data1.xlsx</code>). This database and linked workbooks need to be distributed to mulitple users, but the file path will be the same on each machine (for example <code>C:\\Users\\Public\\MyDataFiles\\</code>).  </p>\n\n<p>I want to ensure that the links to the Excel workbooks are established/refreshed once the files have been placed on each individual's machine with little or no user interaction. Any suggestions?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1456337828, "post_id": 35609913, "comment_id": 58904063, "body": "<code>find</code> returns a range object I think... so you need to declare <code>c</code> as a range. and do <code>set c=</code>."}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1456337941, "post_id": 35609913, "comment_id": 58904125, "body": "Absolutely correct, <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow noreferrer\">it returns a range</a> so you have a mismatch."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1456338580, "post_id": 35609913, "comment_id": 58904492, "body": "Your code will work if <b>NLwk01</b> actually exists within B3:B54. If that is the case then <b>NLwk01</b> is assigned to <b>c</b> since the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff195193.aspx\" rel=\"nofollow noreferrer\">Range.Value property</a> is the defult property of a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"nofollow noreferrer\">Range object</a>. If it cannot be found (and you are not using enough parameters to properly define the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow noreferrer\">Range.Find method</a>) then there is nothing to assign to <b>c</b> and you receive the Error 91."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1456338663, "post_id": 35609913, "comment_id": 58904550, "body": "Please <a href=\"https://stackoverflow.com/posts/35609913/edit\">edit</a> your question title to something meaningful. <i>VBA Excel</i> is apparent from your tags, and the fact you have a problem you can&#39;t solve is apparent because you&#39;re posting here. Removing all of that from your title, it leaves <i>Simple error</i>, which is not a title that has any meaningful content. Your title should describe the actual problem or question in a way that is useful to future readers here who find it in a search result. Thanks."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1456338808, "post_id": 35609913, "comment_id": 58904630, "body": "@Jeeped that&#39;s good to know!"}, {"owner": {"reputation": 740, "user_id": 5051875, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/MJ6T9.jpg?s=128&g=1", "display_name": "Kai", "link": "https://stackoverflow.com/users/5051875/kai"}, "edited": false, "score": 0, "creation_date": 1456399971, "post_id": 35609913, "comment_id": 58933711, "body": "Thanks for all the help. The problem was indeed the range, but that was not the only problem.  I know have:  <code>Dim c &lt;br&gt; Set c = Sheet2.Range(&quot;B3:B54&quot;).Find(&quot;NLwk01&quot;)</code>  This code however still does not return anything, even though cell B3 of Sheet2 contains a formula that gives NLwk01 as result. Note that not returning anything does not cause an error however.  I also tried it with a hard copy of the value, but that was not the problem. Anyone know what could still be causing the function to not find the value?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1456338638, "post_id": 35610171, "comment_id": 58904532, "body": "Why not declare <b>rowIdx</b> as a <b>Long</b> and <b>c</b> as a <b>Range</b>?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1456338773, "post_id": 35610171, "comment_id": 58904607, "body": "I think OP wants to store the value of cell into variable, not the location of cell."}, {"owner": {"reputation": 7536, "user_id": 979580, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ5iY.jpg?s=128&g=1", "display_name": "Alexander Bell", "link": "https://stackoverflow.com/users/979580/alexander-bell"}, "edited": false, "score": 0, "creation_date": 1456338896, "post_id": 35610171, "comment_id": 58904696, "body": "@Jeeped: for coding simplicity c is declared as a variant, but, agree, it could be declared as Range. Best regards,"}], "tags": [], "owner": {"reputation": 7536, "user_id": 979580, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ5iY.jpg?s=128&g=1", "display_name": "Alexander Bell", "link": "https://stackoverflow.com/users/979580/alexander-bell"}, "is_accepted": false, "score": 1, "last_activity_date": 1456339192, "last_edit_date": 1456339192, "creation_date": 1456338587, "answer_id": 35610171, "question_id": 35609913, "link": "https://stackoverflow.com/questions/35609913/error-code-is-91-on-find/35610171#35610171", "title": "Error code is 91 on Find", "body": "<p>As it was mentioned in comment thread, Excel VBA <code>Find()</code> function returns the <code>Range</code> object. Therefore, pertinent to you particular example, it could be coded as in the following sample snippet:</p>\n\n<pre><code>Sub FindRowIndex()\n    Dim c\n    Dim rowIdx As Integer\n    Dim cellValue As String\n\n    'return Range object if found\n    Set c = Sheet2.Range(\"B3:B54\").Find(\"NLwk01\")\n\n    If Not c Is Nothing Then\n        'return the row index (shown as an example)\n        rowIdx = c.Row\n        'return the same string used as search criterion \"NLwk01\"\n        cellValue = c.Value\n    End If\nEnd Sub\n</code></pre>\n\n<p>Pertinent to your case search area (<code>\"B3:B54\"</code>) the <code>rowIdx</code> can be declared As <code>Integer</code>; for extended area you may use <code>Long</code>.</p>\n\n<p>Also, as mentioned in comments thread, you may declare: <code>Dim c As Range</code>.</p>\n\n<p>Hope this may help.</p>\n"}], "owner": {"reputation": 740, "user_id": 5051875, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/MJ6T9.jpg?s=128&g=1", "display_name": "Kai", "link": "https://stackoverflow.com/users/5051875/kai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1456339192, "creation_date": 1456337758, "last_edit_date": 1531164843, "question_id": 35609913, "link": "https://stackoverflow.com/questions/35609913/error-code-is-91-on-find", "title": "Error code is 91 on Find", "body": "<p>This may seem like a simple question but Im very new to VBA and Im not sure why I'm receiving the error.</p>\n\n<pre><code>Dim c As String\nc = Sheet2.Range(\"B3:B54\").Find(\"NLwk01\")\n</code></pre>\n\n<blockquote>\n  <p>Error code is 91: Object variable or With block variable not set.</p>\n</blockquote>\n\n<p>I thought I should've maybe used cells instead of range, but that gives another error with </p>\n\n<blockquote>\n  <p>Error code 5: Invalid procedure call or argument.</p>\n</blockquote>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1456336948, "post_id": 35609648, "comment_id": 58903554, "body": "You declared them as <code>workbook&#47;variant</code>..."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 5, "creation_date": 1456337058, "post_id": 35609648, "comment_id": 58903626, "body": "Actually you only set Pro as workbook, which should be worksheet.  All the others are declared as variant.  You need to declare them <code>Dim RD as WorkSheet, Dep as Worksheet, QC as Worksheet, MM as Worksheet, Pro As WorkSheet</code>"}], "answers": [{"comments": [{"owner": {"reputation": 16352, "user_id": 107899, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RCasx.png?s=128&g=1", "display_name": "Stewbob", "link": "https://stackoverflow.com/users/107899/stewbob"}, "edited": false, "score": 1, "creation_date": 1456338610, "post_id": 35609817, "comment_id": 58904514, "body": "...pertinent to your erroneous declaration...  Pure gold.  +1"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1456338921, "post_id": 35609817, "comment_id": 58904718, "body": "Why is it that the simplest answers always gets the most upvotes XD <a href=\"http://stackoverflow.com/questions/34028430/deleting-via-autofilter-takes-too-long\">This answer</a> is far more deserving of upvotes for instance."}], "tags": [], "owner": {"reputation": 7536, "user_id": 979580, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ5iY.jpg?s=128&g=1", "display_name": "Alexander Bell", "link": "https://stackoverflow.com/users/979580/alexander-bell"}, "is_accepted": true, "score": 7, "last_activity_date": 1456337487, "creation_date": 1456337487, "answer_id": 35609817, "question_id": 35609648, "link": "https://stackoverflow.com/questions/35609648/vba-excel-assigning-worksheets-to-variables/35609817#35609817", "title": "VBA Excel Assigning Worksheets to Variables", "body": "<p>The error is pertinent to your erroneous declaration:</p>\n\n<pre><code>Pro As Workbook\n</code></pre>\n\n<p>You should declare it as <code>Worksheet</code>, or just <code>variant</code> without specifying the type, like: </p>\n\n<pre><code>Dim RD, Dep, QC, MM, Pro\n</code></pre>\n\n<p>A better way would be  to use the strong typed declaration:</p>\n\n<pre><code>Dim RD As Worksheet, Dep As Worksheet, QC As Worksheet, MM As Worksheet, Pro As Worksheet\n</code></pre>\n\n<p>Hope this may help.</p>\n"}, {"tags": [], "owner": {"reputation": 16352, "user_id": 107899, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RCasx.png?s=128&g=1", "display_name": "Stewbob", "link": "https://stackoverflow.com/users/107899/stewbob"}, "is_accepted": false, "score": 3, "last_activity_date": 1456337667, "creation_date": 1456337667, "answer_id": 35609883, "question_id": 35609648, "link": "https://stackoverflow.com/questions/35609648/vba-excel-assigning-worksheets-to-variables/35609883#35609883", "title": "VBA Excel Assigning Worksheets to Variables", "body": "<p>What your code should look like:</p>\n\n<pre><code>Sub TS()\n  Dim RD as Worksheet\n  Dim Dep as Worksheet\n  Dim QC as Worksheet\n  Dim MM as Worksheet\n  Dim Pro as Worksheet\n\n  With This.Workbook\n    Set RD = .Sheets(\"RawData\")\n    Set Dep = .Sheets(\"Departments\")\n    Set QC = .Sheets(\"QC\")\n    Set MM = .Sheets(\"MM\")\n    Set Pro = .Sheets(\"Production\") \n  End With\nEnd Sub\n</code></pre>\n\n<p>You are setting a bunch of worksheets, so they need to be assigned to <code>Worksheet</code> variables.\nThe only reason your code didn't crash on <code>Set RD = ...</code> is that all your variables except <code>Pro</code> were declared as <code>Variant</code>.</p>\n"}], "owner": {"reputation": 43, "user_id": 5016356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/beffc10a100a039af8282f55d61ce51b?s=128&d=identicon&r=PG&f=1", "display_name": "Spectator", "link": "https://stackoverflow.com/users/5016356/spectator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 606, "favorite_count": 0, "accepted_answer_id": 35609817, "answer_count": 2, "score": 3, "last_activity_date": 1456337914, "creation_date": 1456336909, "last_edit_date": 1531164843, "question_id": 35609648, "link": "https://stackoverflow.com/questions/35609648/vba-excel-assigning-worksheets-to-variables", "title": "VBA Excel Assigning Worksheets to Variables", "body": "<p>I am having a \"Run-time Error '13' Type Mismatch\" when attempting to assign a worksheet to a variable. It works for all of the other worksheets but is seems to only happen to this worksheet.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Sub TS()\nDim RD, Dep, QC, MM, Pro As Workbook\n\nWith ThisWorkbook\nSet RD = .Sheets(\"RawData\")\nSet Dep = .Sheets(\"Departments\")\nSet QC = .Sheets(\"QC\")\nSet MM = .Sheets(\"MM\")\nSet Pro = .Sheets(\"Production\") 'I have a problem with this line\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>My worksheet labels are below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/7efol.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7efol.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["xml", "vba", "excel", "customization"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1456338423, "post_id": 35609462, "comment_id": 58904389, "body": "I don&#39;t think so. All large Ribbon buttons I&#39;ve seen take up an entire &quot;spot&quot;, there&#39;s never anything under a large Ribbon button. IMO your design would clash with the Microsoft designs if you got it to work."}, {"owner": {"reputation": 1359, "user_id": 2962937, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/fqCK7.jpg?s=128&g=1", "display_name": "CaffeinatedMike", "link": "https://stackoverflow.com/users/2962937/caffeinatedmike"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1456338479, "post_id": 35609462, "comment_id": 58904426, "body": "I figured as much. What would you suggest then for something similar?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1456338542, "post_id": 35609462, "comment_id": 58904472, "body": "Not much, other than add an icon to your &quot;documentation&quot; button ;-)"}, {"owner": {"reputation": 1359, "user_id": 2962937, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/fqCK7.jpg?s=128&g=1", "display_name": "CaffeinatedMike", "link": "https://stackoverflow.com/users/2962937/caffeinatedmike"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1456338795, "post_id": 35609462, "comment_id": 58904621, "body": "Haha I don&#39;t want the &quot;documentation&quot; button to be the same size as the &quot;Alfred&quot; button. If anything, I&#39;d prefer it move to the button to align with the word &quot;Alfred&quot;, then I&#39;d like to add the icon to it. Any idea how I could do <i>that</i>?"}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1456338845, "post_id": 35609462, "comment_id": 58904655, "body": "Use a vertical divider or a split button drop down with menu separators. Or just make a small icon. Or insert a large transparent image."}, {"owner": {"reputation": 1359, "user_id": 2962937, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/fqCK7.jpg?s=128&g=1", "display_name": "CaffeinatedMike", "link": "https://stackoverflow.com/users/2962937/caffeinatedmike"}, "edited": false, "score": 0, "creation_date": 1456342993, "post_id": 35609462, "comment_id": 58907103, "body": "Vertical divider doesn&#39;t help and I rather not use a split butter drop down."}], "answers": [{"tags": [], "owner": {"reputation": 1359, "user_id": 2962937, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/fqCK7.jpg?s=128&g=1", "display_name": "CaffeinatedMike", "link": "https://stackoverflow.com/users/2962937/caffeinatedmike"}, "is_accepted": true, "score": 0, "last_activity_date": 1456341429, "creation_date": 1456341429, "answer_id": 35611064, "question_id": 35609462, "link": "https://stackoverflow.com/questions/35609462/how-can-i-achieve-this-custom-ribbon-group-layout-in-excel-using-xml/35611064#35611064", "title": "How can I achieve this custom ribbon group layout in Excel using xml", "body": "<p>It appears that this is in fact not possible to accomplish as this <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd316927(v=vs.85).aspx\" rel=\"nofollow\">MSDN Article</a> points out that the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd316839(v=vs.85).aspx\" rel=\"nofollow\">ScalingPolicy</a> and <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd316846(v=vs.85).aspx\" rel=\"nofollow\">SizeDefinitions</a> enforced by Excel's framework do not allow non-uniformity, even when using their UI Customization. Sigh.</p>\n"}], "owner": {"reputation": 1359, "user_id": 2962937, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/fqCK7.jpg?s=128&g=1", "display_name": "CaffeinatedMike", "link": "https://stackoverflow.com/users/2962937/caffeinatedmike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 642, "favorite_count": 0, "accepted_answer_id": 35611064, "answer_count": 1, "score": 0, "last_activity_date": 1456341429, "creation_date": 1456336329, "question_id": 35609462, "link": "https://stackoverflow.com/questions/35609462/how-can-i-achieve-this-custom-ribbon-group-layout-in-excel-using-xml", "title": "How can I achieve this custom ribbon group layout in Excel using xml", "body": "<p>I'm creating a custom button group on a new ribbon group in Excel for when I distribute my VBA Macros to my company's department. To accomplish this I've been looking around the web trying to first use Button objects like <a href=\"http://www.ozgrid.com/VBA/excel-add-in-create.htm\" rel=\"nofollow noreferrer\">here</a> until I found out that they're not the way to go when you're using later versions of Excel (I'm using 2010). So, after being pointed in the correct direction by a question on SO I've started working with <code>xml</code> and it seems pretty straightforward. I took the example from <a href=\"http://www.rondebruin.nl/win/s2/win001.htm\" rel=\"nofollow noreferrer\">here</a> and combined it with one of the user's comments on the CustomUIEditor download page <a href=\"http://openxmldeveloper.org/blog/b/openxmldeveloper/archive/2006/05/26/customuieditor.aspx\" rel=\"nofollow noreferrer\">here</a> and now have the below simple skeleton of <code>xml</code> code that I'll be using to create my custom tab (image is a placeholder for a different image):</p>\n\n<pre><code>&lt;customUI xmlns=\"http://schemas.microsoft.com/office/2006/01/customui\" &gt; \n &lt;ribbon startFromScratch=\"false\" &gt; \n   &lt;tabs&gt; \n     &lt;tab id=\"CustomTab\" label=\"Alfred\" &gt; \n       &lt;group id=\"ESPAssistant\" label=\"ESP Assistant\"&gt; \n         &lt;button id=\"Alfred\" size=\"large\" label=\"Alfred\" imageMso=\"HappyFace\"/&gt; \n         &lt;button id=\"Doc\" label=\"Documentation\"/&gt; \n       &lt;/group&gt; \n     &lt;/tab&gt; \n   &lt;/tabs&gt; \n &lt;/ribbon&gt; \n&lt;/customUI&gt; \n</code></pre>\n\n<p>Which gives me:</p>\n\n<p><img src=\"https://i.imgur.com/wHRN6gN.jpg\" alt=\"Current Design\"></p>\n\n<p>Which is so far so good. However, I'm looking to see if there is a way to have one large/medium button with an image on top and text below the image, then have the smaller button (in this case, Documentation) below the bigger button. Like so:</p>\n\n<p><img src=\"https://i.imgur.com/lSCjpMz.png\" alt=\"Desired End Design\"></p>\n\n<p>I've been poking around the msdn documentation pages (I swear it's like playing leapfrog on those pages until you finally get to something you were truly looking for) until I found <a href=\"https://msdn.microsoft.com/en-us/library/dd926959(v=office.12).aspx\" rel=\"nofollow noreferrer\">this page</a>, which seems to be like a plausible solution, but I couldn't seem to get that to work.</p>\n\n<p><strong>So, my questions:</strong></p>\n\n<ol>\n<li>Is my idea acheivable using <code>xml</code>? \n\n<ol start=\"2\">\n<li>If so, could you help provide me with a code snippet or at least point me in the right direction of how I might accomplish this? </li>\n<li>If it's not possible, then what do you suggest I do to at least mimic something close to this layout?</li>\n</ol></li>\n</ol>\n"}, {"tags": ["vba", "excel", "ms-word", "outlook"], "comments": [{"owner": {"reputation": 1157, "user_id": 3505188, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/zm9V5.jpg?s=128&g=1", "display_name": "Patrick Wynne", "link": "https://stackoverflow.com/users/3505188/patrick-wynne"}, "edited": false, "score": 0, "creation_date": 1456339294, "post_id": 35609112, "comment_id": 58904952, "body": "For one thing, you&#39;re getting the contents of your Word doc as a string (in the variable MsgTxt) but that by definition won&#39;t include any images."}], "answers": [{"comments": [{"owner": {"reputation": 757, "user_id": 3850402, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5251dd6d56045a8cf7dd1e94eb405955?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Case", "link": "https://stackoverflow.com/users/3850402/justin-case"}, "edited": false, "score": 0, "creation_date": 1456337212, "post_id": 35609660, "comment_id": 58903716, "body": "I&#39;ve found this that&#39;s a little helpful <a href=\"https://msdn.microsoft.com/en-us/library/dd492012%28v=office.12%29.aspx#Outlook2007ProgrammingCh17_CreatingAFormattedMessage\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/&hellip;</a>. Using Inspector.WordEditor you can &quot;Create a formatted email message with embedded images.&quot; But it doesn&#39;t show you how and I&#39;ve tried looking for WordEditor functions on google but I can&#39;t find it"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 757, "user_id": 3850402, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5251dd6d56045a8cf7dd1e94eb405955?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Case", "link": "https://stackoverflow.com/users/3850402/justin-case"}, "edited": false, "score": 0, "creation_date": 1456338154, "post_id": 35609660, "comment_id": 58904243, "body": "Inspector.WordEditor property returns Word.Document object - <a href=\"https://msdn.microsoft.com/en-us/library/bb211897(v=office.12).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/bb211897(v=office.12).aspx</a> - but I don&#39;t think it will let you import a new DOC file in place of an existing document."}, {"owner": {"reputation": 757, "user_id": 3850402, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5251dd6d56045a8cf7dd1e94eb405955?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Case", "link": "https://stackoverflow.com/users/3850402/justin-case"}, "edited": false, "score": 0, "creation_date": 1456338619, "post_id": 35609660, "comment_id": 58904518, "body": "I am not importing new DOC files. I am opening up an existing file"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 757, "user_id": 3850402, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5251dd6d56045a8cf7dd1e94eb405955?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Case", "link": "https://stackoverflow.com/users/3850402/justin-case"}, "edited": false, "score": 0, "creation_date": 1456344411, "post_id": 35609660, "comment_id": 58907958, "body": "If you have a Word.Document object corresponding to the message body of a particular Outlook message, your DOC file would need to be imported into that document."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1456336950, "creation_date": 1456336950, "answer_id": 35609660, "question_id": 35609112, "link": "https://stackoverflow.com/questions/35609112/how-to-send-a-word-document-as-body-of-an-email-with-vba/35609660#35609660", "title": "How to send a Word document as body of an email with VBA", "body": "<p>If not for the images, you could save the document as an HTML file, read its contents, then set the MailItem.HTMLBody property. </p>\n\n<p>Images are more involved. I don't see a straightforward way to bring them into a message body.</p>\n"}, {"comments": [{"owner": {"reputation": 757, "user_id": 3850402, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5251dd6d56045a8cf7dd1e94eb405955?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Case", "link": "https://stackoverflow.com/users/3850402/justin-case"}, "edited": false, "score": 0, "creation_date": 1456340557, "post_id": 35610600, "comment_id": 58905712, "body": "You&#39;re the man. I wonder why you need .Display to actually behave correctly. Without .Display, it will send the email but without the body. Thanks Patrick"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1595962529, "post_id": 35610600, "comment_id": 111654314, "body": "very strange - this solution does <b>not</b> work with <code>.Send</code> so not viable solution for automated emailing"}, {"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1614247523, "post_id": 35610600, "comment_id": 117329686, "body": "@urdearboy true, I just came to this and probably the only quick solution for now is to have <code>.Display</code> and <code>.Send</code> together to make this work."}], "tags": [], "owner": {"reputation": 1157, "user_id": 3505188, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/zm9V5.jpg?s=128&g=1", "display_name": "Patrick Wynne", "link": "https://stackoverflow.com/users/3505188/patrick-wynne"}, "is_accepted": true, "score": 11, "last_activity_date": 1456339984, "creation_date": 1456339984, "answer_id": 35610600, "question_id": 35609112, "link": "https://stackoverflow.com/questions/35609112/how-to-send-a-word-document-as-body-of-an-email-with-vba/35610600#35610600", "title": "How to send a Word document as body of an email with VBA", "body": "<p>You are getting the contents of your template document as a string, which by definition will not contain any formatting or images. You should instead copy the contents to the clipboard and then paste them into the new email.</p>\n\n<p>Something like this:</p>\n\n<pre><code>Sub emailFromDoc()\n    Dim wd As Object, editor As Object\n    Dim doc As Object\n    Dim oMail As MailItem\n\n    Set wd = CreateObject(\"Word.Application\")\n    Set doc = wd.documents.Open(...path to your doc...)\n    doc.Content.Copy\n    doc.Close\n    set wd = Nothing\n\n    Set oMail = Application.CreateItem(olMailItem)\n    With oMail\n        .BodyFormat = olFormatRichText\n        Set editor = .GetInspector.WordEditor\n        editor.Content.Paste\n        .Display\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 757, "user_id": 3850402, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5251dd6d56045a8cf7dd1e94eb405955?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Case", "link": "https://stackoverflow.com/users/3850402/justin-case"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24298, "favorite_count": 4, "protected_date": 1520992081, "accepted_answer_id": 35610600, "answer_count": 2, "score": 4, "last_activity_date": 1520979463, "creation_date": 1456335234, "question_id": 35609112, "link": "https://stackoverflow.com/questions/35609112/how-to-send-a-word-document-as-body-of-an-email-with-vba", "title": "How to send a Word document as body of an email with VBA", "body": "<p>I've created a macro that works with outlook and excel that will use a list of email addresses (in excel) and send all those addresses an email (in outlook). I want to take a word document (from microsoft word) and use it as the body of the email. The problem is, I will have images in the word document and I need the word document to keep it's formatting. Right now, my VBA takes the content of my word document but the formatting is gone and images aren't included. This is my code:</p>\n\n<pre><code>Sub spamEmail()\n   'Setting up the Excel variables.\n   Dim olApp As Object\n   Dim oMail As Outlook.MailItem\n   Dim iCounter As Integer\n   Dim Dest As Variant\n   Dim SDest As String\n   Dim Excel As Object\n   Dim Name As String\n   Dim Word As Object\n   Dim oAccount As Outlook.Account\n   Dim doc As Word.Document\n   Dim itm As Object\n   Dim MsgTxt As String\n\n   'Set the outlook account to send.\n   Set oAccount = Application.Session.Accounts.Item(2)\n\n   'Create excel object.\n   Set Excel = CreateObject(\"excel.application\")\n   Excel.Visible = True\n   Excel.Workbooks.Open (\"C:\\Users\\Deryl Lam\\Documents\\Book1.xlsx\")\n   Excel.Workbooks(\"Book1.xlsx\").Activate\n\n   'Create a word object.\n   Set Word = CreateObject(\"word.application\")\n   Set doc = Word.Documents.Open _\n   (FileName:=\"C:\\Users\\Deryl Lam\\Documents\\emailBody.docx\", ReadOnly:=True)\n   'Pulls text from file for message body\n    MsgTxt = doc.Range(Start:=doc.Paragraphs(1).Range.Start, _\n    End:=doc.Paragraphs(doc.Paragraphs.Count).Range.End)\n\n   'Loop through the excel worksheet.\n       For iCounter = 1 To WorksheetFunction.CountA(Workbooks(\"Book1.xlsx\").Sheets(1).Columns(1))\n\n           'Create an email for each entry in the worksheet.\n           Set oMail = Application.CreateItem(olMailItem)\n           With oMail\n            SDest = Cells(iCounter, 1).Value\n            If SDest = \"\" Then\n             'Dont do anything if the entry is blank.\n            Else\n             'Do additional formatting on the BCC and Subject lines, add the body text from the spreadsheet, and send.\n             Name = Cells(iCounter, 2).Value\n             .BCC = SDest\n             .Subject = \"FYI\"\n             .Body = \"Dear \" &amp; Name &amp; \",\" &amp; vbCrLf &amp; MsgTxt\n\n             'SendUsingAccount is new in Office 2007\n             'Change Item(1)to the account number that you want to use\n             .SendUsingAccount = oAccount\n\n             .Send\n            End If\n           End With\n       Next iCounter\n\n\n   'Clean up the Outlook application.\n   Set olMailItm = Nothing\n   Set olApp = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>I've searched all over google for a solution but I haven't found one. How can I send a word document as the body of the email with it's formatting in tact and the images included?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1456335449, "post_id": 35609011, "comment_id": 58902587, "body": "fwiw, I find that rectangular blocks of data are better referenced with the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196678.aspx\" rel=\"nofollow noreferrer\">Range.CurrentRegion property</a> than the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840732.aspx\" rel=\"nofollow noreferrer\">Worksheet.UsedRange property</a>."}, {"owner": {"reputation": 1, "user_id": 2300070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50bde8628fc57422efc0c3fe2cb7a8bf?s=128&d=identicon&r=PG", "display_name": "JamesL", "link": "https://stackoverflow.com/users/2300070/jamesl"}, "edited": false, "score": 0, "creation_date": 1456336071, "post_id": 35609011, "comment_id": 58902995, "body": "Yeah, that could work, but what happens if a column or row has a blank in it, with more data after it? UsedRange captures everything."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1456336368, "post_id": 35609011, "comment_id": 58903199, "body": "For CurrentRegion to miss data an entire row or entire column would have to be blank. CurrentRegion works on &#39;islands&#39; of data which extend in all directions until a full blank row or column is met. The method can be demonstrated manually on a worksheet by selecting a cell and tapping [Ctrl]+A once. With rectangular islands of data there are usually column header labels with discount the &#39;fully blank column&#39; and fully blank rows generally indicate bad data, not a normal situation."}, {"owner": {"reputation": 89, "user_id": 4068364, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bfb0239a8a1cabf7366df3c1887e0c76?s=128&d=identicon&r=PG&f=1", "display_name": "Kish", "link": "https://stackoverflow.com/users/4068364/kish"}, "edited": false, "score": 0, "creation_date": 1456357254, "post_id": 35609011, "comment_id": 58914448, "body": "Thank you for the input here. CurrentRegion is useful."}], "tags": [], "owner": {"reputation": 1, "user_id": 2300070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50bde8628fc57422efc0c3fe2cb7a8bf?s=128&d=identicon&r=PG", "display_name": "JamesL", "link": "https://stackoverflow.com/users/2300070/jamesl"}, "is_accepted": false, "score": 0, "last_activity_date": 1456336015, "last_edit_date": 1456336015, "creation_date": 1456334914, "answer_id": 35609011, "question_id": 35608750, "link": "https://stackoverflow.com/questions/35608750/build-table-on-one-sheet-with-data-from-multiple-sheets-and-varying-column-lengt/35609011#35609011", "title": "Build Table on one sheet with data from multiple sheets and varying column length", "body": "<p>You don't need to define each individual column. What you should so is use \"UsedRange\" to select all columns/rows that have data, and assign the values to a 2D Array, which can then be manipulated using loops.</p>\n"}, {"comments": [{"owner": {"reputation": 89, "user_id": 4068364, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bfb0239a8a1cabf7366df3c1887e0c76?s=128&d=identicon&r=PG&f=1", "display_name": "Kish", "link": "https://stackoverflow.com/users/4068364/kish"}, "edited": false, "score": 0, "creation_date": 1456357915, "post_id": 35609187, "comment_id": 58914656, "body": "Thank you for your help. I adjusted the code but could not get it to run fully. I have copied the code below as I have it in VBA. I get an error: Method &#39;Range&#39; of object &#39;_Worksheet&#39; failed. This occurs at the line, Set rngData = Union(.Range(&quot;B:F&quot;), .Range(&quot;O&quot;), .Range(&quot;Q&quot;)).   The only spots I changed were   Set wsTable = Worksheets(&quot;Efficiency&quot;) &#39;change as needed  and   Case Is = &quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;, &quot;8&quot;, &quot;9&quot;, &quot;10&quot;, &quot;11&quot;, &quot;12&quot;, &quot;13&quot;, &quot;14&quot;, &quot;15&quot;  I assume &quot;Case Is&quot; is the worksheet name."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 89, "user_id": 4068364, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bfb0239a8a1cabf7366df3c1887e0c76?s=128&d=identicon&r=PG&f=1", "display_name": "Kish", "link": "https://stackoverflow.com/users/4068364/kish"}, "edited": false, "score": 0, "creation_date": 1456407730, "post_id": 35609187, "comment_id": 58939284, "body": "@kish - see my edits on that line. apologies for the syntax error."}, {"owner": {"reputation": 89, "user_id": 4068364, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bfb0239a8a1cabf7366df3c1887e0c76?s=128&d=identicon&r=PG&f=1", "display_name": "Kish", "link": "https://stackoverflow.com/users/4068364/kish"}, "edited": false, "score": 0, "creation_date": 1456439921, "post_id": 35609187, "comment_id": 58961187, "body": "Scott it worked, but there are three issues. 1. When the date is transferred to the table, the first date cell in the column overwrites the column title. 2. there is mismatch between the date and the data that matches it, the data column can be of inconsistent length as it goes from day to day (sheet to sheet). I need the number of date rows to be only as much as the data rows available on each day; and 3; the format ting (cell colors and borders) of the table on the day to day sheet shows up on the final table. I want to see only the data."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 89, "user_id": 4068364, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bfb0239a8a1cabf7366df3c1887e0c76?s=128&d=identicon&r=PG&f=1", "display_name": "Kish", "link": "https://stackoverflow.com/users/4068364/kish"}, "edited": false, "score": 0, "creation_date": 1456492605, "post_id": 35609187, "comment_id": 58985574, "body": "@Kish - see my edits inside the <code>With wsTable</code> block to address points 1 and 3. For point 2, the <code>lRow</code> variable in this line <code>.Range(&quot;A&quot; &amp; .Rows.Count).End(xlUp).Offset(1).Resize(lRow, 1).Value</code> should fill the dates to the exact number of rows found for each sheet. Perhaps because the code was written in a way that overwrote the column header inside of moving one cell down was throwing the date rows off as well (because on each date it will overwrite the last cell of the previous date. The fix I made for point 1 may address this as well. But if not, you can easily debug based on the data."}, {"owner": {"reputation": 89, "user_id": 4068364, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bfb0239a8a1cabf7366df3c1887e0c76?s=128&d=identicon&r=PG&f=1", "display_name": "Kish", "link": "https://stackoverflow.com/users/4068364/kish"}, "edited": false, "score": 0, "creation_date": 1456846279, "post_id": 35609187, "comment_id": 59128657, "body": "We have made progress but there are some more bugs. In the line, lRow = rngData.Find(&quot;*&quot;, SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row, the code is looking for anything in these cells. It is picking up the cell formatting as well, which is a color coded table. I want to search only for data or text.  Next, the table formatting from which we are pulling data goes up to cell 20 from cell 9. On the table that we are building I notice that the date fills up 20 rows after the title row..."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 89, "user_id": 4068364, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bfb0239a8a1cabf7366df3c1887e0c76?s=128&d=identicon&r=PG&f=1", "display_name": "Kish", "link": "https://stackoverflow.com/users/4068364/kish"}, "edited": false, "score": 0, "creation_date": 1456846766, "post_id": 35609187, "comment_id": 59129006, "body": "@kish - see my edits. you&#39;re starting to state problems that were not in your original question. If you have more questions, please post a new question so this particular thread does not become too unwieldy and unclear."}, {"owner": {"reputation": 89, "user_id": 4068364, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bfb0239a8a1cabf7366df3c1887e0c76?s=128&d=identicon&r=PG&f=1", "display_name": "Kish", "link": "https://stackoverflow.com/users/4068364/kish"}, "edited": false, "score": 0, "creation_date": 1456846860, "post_id": 35609187, "comment_id": 59129069, "body": "OK I understand. Thank you"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 0, "last_activity_date": 1456846711, "last_edit_date": 1456846711, "creation_date": 1456335435, "answer_id": 35609187, "question_id": 35608750, "link": "https://stackoverflow.com/questions/35608750/build-table-on-one-sheet-with-data-from-multiple-sheets-and-varying-column-lengt/35609187#35609187", "title": "Build Table on one sheet with data from multiple sheets and varying column length", "body": "<p>This code should give you good start and loop through each worksheet (notice how the case checks the name of the sheet). You'll also need to update any range references that I may have assumed.</p>\n\n<pre><code>Sub DataTable()\n\n\nDim wsTable As Worksheet\nSet wsTable = Worksheets(\"Table\") 'change as needed\n\nDim ws As Worksheet\n\nFor Each ws In ThisWorkbook.Worksheets\n\n    Select Case ws.Name\n\n        Case Is = \"1\", \"2\", \"3\", \"4\", \"5\" ' etc.\n\n            With ws\n\n                Dim rngData As Range\n                Set rngData = Union(.Range(\"B:F\"), .Range(\"O:O\"), .Range(\"Q:Q\"))\n\n                Dim lRow As Long\n                Dim rCheck As Range\n                For Each rCheck In Intersect(rngData, .Rows(1))\n\n                    If .Cells(.Rows.Count, rCheck.Column).End(xlUp).Row &gt; lRow Then\n                         lRow = .Cells(.Rows.Count, rCheck.Column).End(xlUp).Row\n                     End If\n\n                Next\n\n\n                Dim dDate As Date\n                dDate = .Range(\"G4\").Value\n\n                With wsTable\n\n                    .Range(\"A\" &amp; .Rows.Count).End(xlUp).Offset(1).Resize(lRow, 1).Value = dDate\n                    ws.Range(\"B9:F\" &amp; lRow).Copy \n                   .Range(\"B\" &amp; .Rows.Count).End(xlUp).Offset(1).PasteSpecial xlPasteValues\n                    ws.Range(\"O9:O\" &amp; lRow).Copy \n                    .Range(\"O\" &amp; .Rows.Count).End(xlUp).Offset(1).PasteSpecial xlPasteValues\n                    ws.Range(\"Q9:O\" &amp; lRow).Copy \n                    .Range(\"Q\" &amp; .Rows.Count).End(xlUp).Offset(1).PasteSpecial xlPasteValues\n\n                End With\n\n            End With\n\n    End Select\n\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 4068364, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bfb0239a8a1cabf7366df3c1887e0c76?s=128&d=identicon&r=PG&f=1", "display_name": "Kish", "link": "https://stackoverflow.com/users/4068364/kish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 35609187, "answer_count": 2, "score": 3, "last_activity_date": 1456846711, "creation_date": 1456334207, "question_id": 35608750, "link": "https://stackoverflow.com/questions/35608750/build-table-on-one-sheet-with-data-from-multiple-sheets-and-varying-column-lengt", "title": "Build Table on one sheet with data from multiple sheets and varying column length", "body": "<p>I need to build a table on one sheet by pulling data from 15 sheets (1 at a time). These sheets are separated by date. The date is in one cell. The other data \"Name\", \"Shift\", \"Station\", \"Product\", \"Package\", \"Capacity\" and \"Performance\" can have varying column lengths from sheet to sheet (as we move across the dates). On building the table I want to record the date on every row that matches the data taken from its sheet. \nI started with the code below by trying to select the first data cell of each data column and want to move down the column until there is a blank cell and select that portion to transfer it to the table. \nThis is going to be a long code and I want get one thing right at a time, I will ask more questions as it develops. This is my first one-- How can I adjust the code to select the column to pick up information by selecting data until I get to a blank cell?</p>\n\n<p>Thanks,</p>\n\n<pre><code>Sub DataTable()\nDim rcell1, rcell2, rcell3, rcell4, rcell5, recell6, rcell7, rcell8 As Long\n\n    Worksheets(\"1\").Activate\n    Range(\"G4\").Select\n    rcell1 = Selection.Value ' Date\n\n    Range(\"B9\").Select\n    Selection.End(xlDown).Select ' Name \n    rcell2 = Selection.Value \n\n    Range(\"C9\").Select\n    Selection.End(xlDown).Select ' Shift \n    rcell3 = Selection.Value \n\n    Range(\"D9\").Select\n    Selection.End(xlDown).Select ' Station\n    rcell4 = Selection.Value \n\n    Range(\"E9\").Select\n    Selection.End(xlDown).Select ' Product\n    rcell5 = Selection.Value \n\n    Range(\"F9\").Select\n    Selection.End(xlDown).Select ' Package\n    rcell6 = Selection.Value \n\n    Range(\"O9\").Select\n    Selection.End(xlDown).Select ' Capacity \n    rcell7 = Selection.Value \n\n    Range(\"Q9\").Select\n    Selection.End(xlDown).Select ' Performance\n    rcell8 = Selection.Value \n\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "criteria"], "comments": [{"owner": {"reputation": 27, "user_id": 4973594, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/831248890284121/picture?type=large", "display_name": "Long Ettinger", "link": "https://stackoverflow.com/users/4973594/long-ettinger"}, "edited": false, "score": 0, "creation_date": 1456334015, "post_id": 35608467, "comment_id": 58901564, "body": "Exemple : =NB.SI.ENS(D4:D17;&gt; 20 &amp; &lt; 29)"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 4973594, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/831248890284121/picture?type=large", "display_name": "Long Ettinger", "link": "https://stackoverflow.com/users/4973594/long-ettinger"}, "edited": false, "score": 0, "creation_date": 1456334844, "post_id": 35608791, "comment_id": 58902178, "body": "Hello, I get an error when using : =NB.SI.ENS(D4:D16;&quot;&gt;20&quot;,&quot;&lt;29&quot;)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 27, "user_id": 4973594, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/831248890284121/picture?type=large", "display_name": "Long Ettinger", "link": "https://stackoverflow.com/users/4973594/long-ettinger"}, "edited": false, "score": 0, "creation_date": 1456334891, "post_id": 35608791, "comment_id": 58902218, "body": "@LongEttinger probably the comma I put there by mistake. Edited."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 27, "user_id": 4973594, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/831248890284121/picture?type=large", "display_name": "Long Ettinger", "link": "https://stackoverflow.com/users/4973594/long-ettinger"}, "edited": false, "score": 0, "creation_date": 1456335326, "post_id": 35608791, "comment_id": 58902514, "body": "Ah, I mistaken <code>NB.SI.ENS</code> for <code>SOMME.SI.ENS</code> - you need to specify the <i>criteria range</i> for each criteria. It will be the same for both, you need to copy it."}, {"owner": {"reputation": 27, "user_id": 4973594, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/831248890284121/picture?type=large", "display_name": "Long Ettinger", "link": "https://stackoverflow.com/users/4973594/long-ettinger"}, "edited": false, "score": 0, "creation_date": 1456335902, "post_id": 35608791, "comment_id": 58902886, "body": "My data were: age If my cell range B2: B13 The corresponding age between &quot;20&quot; and &quot;29&quot; I wish it count"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 0, "last_activity_date": 1456335413, "last_edit_date": 1456335413, "creation_date": 1456334305, "answer_id": 35608791, "question_id": 35608467, "link": "https://stackoverflow.com/questions/35608467/excel-criteria-nb-si-ens/35608791#35608791", "title": "Excel Criteria NB.SI.ENS", "body": "<p>The criteria just need to be comma-separated (or whatever your local <em>list separator</em> character is) and specified in a string; <code>NB.SI.ENS</code> requires the range to be specified for each criteria, so this should work:</p>\n\n<pre><code>=SOMMEPROD(NB.SI.ENS(INDIRECT(...);\"&gt;20\";INDIRECT(...);\"&lt;29\"))\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 4973594, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/831248890284121/picture?type=large", "display_name": "Long Ettinger", "link": "https://stackoverflow.com/users/4973594/long-ettinger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 0, "accepted_answer_id": 35608791, "answer_count": 1, "score": 0, "last_activity_date": 1456336118, "creation_date": 1456333366, "last_edit_date": 1456336118, "question_id": 35608467, "link": "https://stackoverflow.com/questions/35608467/excel-criteria-nb-si-ens", "title": "Excel Criteria NB.SI.ENS", "body": "<p>My data were: age\nIf my cell range : B2: B13\nThe corresponding age between \"20\" and \"29\"\nI wish it count</p>\n\n<p>Criteria \"> 20 &amp; &lt; 29\"</p>\n\n<pre><code>  =SOMMEPROD(NB.SI.ENS(INDIRECT(\"'\"&amp;{\"DECEMBRE\".\"NOVEMBRE\".\"OCTOBRE\".\"SEPTEMBRE\".\"AOUT\".\"JUILLET\".\"JUIN\".\"MAI\".\"AVRIL\".\"MARS\".\"FEVRIER\".\"JANVIER\"}&amp;\"'!\" &amp; {\"D4:D13\".\"D4:D18\".\"D4:D18\".\"D4:D13\".\"D4:D26\".\"D4:D16\".\"D4:D24\".\"D4:D18\".\"D4:D15\".\"D4:D26\".\"D4:D24\".\"D4:D16\"});**Criteria Sup of 20 AND Inf 29**))\n</code></pre>\n\n<p>Thanks you</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1456333670, "post_id": 35608413, "comment_id": 58901338, "body": "Do you mean <code>N&#47;A</code> as text or <code>#N&#47;A</code> as an Excel worksheet error code?"}, {"owner": {"reputation": 89, "user_id": 5563773, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7c6b18dfd5047dfa5d02255d4f8b8018?s=128&d=identicon&r=PG&f=1", "display_name": "suresh7860", "link": "https://stackoverflow.com/users/5563773/suresh7860"}, "edited": false, "score": 0, "creation_date": 1456333825, "post_id": 35608413, "comment_id": 58901431, "body": "@ Jeeped - I am using a formula the below formula to check if the result is alpha numberic or not in the respective cells. If its N/A it not alpha numeric for me and for these i should be performing vlookup by filtering =IF(OR(J8=&quot;&quot;,SUMPRODUCT(--ISNUMBER(FIND({0,1,2,3,4,5,6,7,8,9&zwnj;&#8203;},J8)))),&quot;GEMS ID&quot;,&quot;N/A&quot;)."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1456333890, "post_id": 35608413, "comment_id": 58901480, "body": "<i>Cell reference for vlookup is creating or problem</i>  &lt;&lt; What does this actually mean. I&#39;m not understanding what your problem is. Do you get an error message? If so, please indicate what error &amp; what line raises the error."}, {"owner": {"reputation": 89, "user_id": 5563773, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7c6b18dfd5047dfa5d02255d4f8b8018?s=128&d=identicon&r=PG&f=1", "display_name": "suresh7860", "link": "https://stackoverflow.com/users/5563773/suresh7860"}, "edited": false, "score": 0, "creation_date": 1456334108, "post_id": 35608413, "comment_id": 58901636, "body": "@ David Zemens - its not throwing error but giving me wrong results as before filtering i dont know which cell as N/A but i tried using D2 as starting to check it might work but its pulling me D2/d16 data only but i wanted to have the data for N/A but i dont now which cell has N/A so want to have cell reference which it can trace out all N/A&#39;S and vlookup to those cells here"}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 5563773, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7c6b18dfd5047dfa5d02255d4f8b8018?s=128&d=identicon&r=PG&f=1", "display_name": "suresh7860", "link": "https://stackoverflow.com/users/5563773/suresh7860"}, "edited": false, "score": 0, "creation_date": 1456334955, "post_id": 35608724, "comment_id": 58902259, "body": "Thanks a lot @ Jeeped :) i got it and thanks for giving the short codes to change format to R1C1 which i never used too. Thanks again and have a wonderful day :)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 3, "last_activity_date": 1456334148, "creation_date": 1456334148, "answer_id": 35608724, "question_id": 35608413, "link": "https://stackoverflow.com/questions/35608413/unable-to-give-reference-for-vlookup-on-special-cells/35608724#35608724", "title": "Unable to give reference for VLOOKUP on special cells", "body": "<p>Your last effort was getting close but you need to use <strong>xlR1C1</strong> referencing, not <strong>xlA1</strong> referencing in the formula.</p>\n\n<pre><code>.Range(\"L2:L\" &amp; LRW).SpecialCells(xlCellTypeVisible).FormulaR1C1 = _\n   \"=IFERROR(VLOOKUP(RC4, 'BP Scoping'!C1:C2, 2, FALSE),RC4)\"\n</code></pre>\n\n<p>That should provide the correct references to the values in column D relative to where the formula is placed in column L.</p>\n\n<hr>\n\n<p><sub> fwiw, you can quickly switch back and forth from <strong>xlA1</strong> to <strong>xlR1C1</strong> referencing  with <kbd>alt</kbd>+<kbd>F</kbd>,<kbd>T</kbd>,<kbd>F</kbd> then <kbd>alt</kbd>+<kbd>R</kbd>.</sub></p>\n"}], "owner": {"reputation": 89, "user_id": 5563773, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7c6b18dfd5047dfa5d02255d4f8b8018?s=128&d=identicon&r=PG&f=1", "display_name": "suresh7860", "link": "https://stackoverflow.com/users/5563773/suresh7860"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 35608724, "answer_count": 1, "score": 2, "last_activity_date": 1459950404, "creation_date": 1456333223, "last_edit_date": 1531164843, "question_id": 35608413, "link": "https://stackoverflow.com/questions/35608413/unable-to-give-reference-for-vlookup-on-special-cells", "title": "Unable to give reference for VLOOKUP on special cells", "body": "<p>I am trying to you vlookup on the specials where we have N/A in prior column but not able to succeed as cell reference for vlookup is creating or problem and i tried to research it and fix it but couldn't get the right one. Would be helpful if any of you can help me to correct it</p>\n\n<p>N/A can be in any of the cells in column K and once i filter column k with N/A's here and need to vlookup in column L using below formula on the special cells which are filtered but i am facing challenge with giving vlookup reference cell for which i need to your assistance as N/A can be in K2/K16/K20/K50/K80 </p>\n\n<p>=IFERROR(VLOOKUP($D16,'BP Scoping'!A:B,2,0),D16)</p>\n\n<pre><code>'Second vlookup not working\nWith Sheets(\"Sheet4\")\n    Dim LRW As Long\n    LRW = .Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    .Range(\"A1\").AutoFilter Field:=11, Criteria1:=\"#N/A\"\n\n     'need to check for right cells which is missing\n     'One way tried to use this\n     .Range(.Range(\"L2\"), Cells(LRW, \"L\")).SpecialCells(xlCellTypeVisible).Formula = \"=iferror(VLOOKUP($D2,'BP Scoping'!A:B,2,0),D2)\"\n</code></pre>\n\n<p>Another way I tried to use this:</p>\n\n<pre><code>     .Range(\"L2:L\" &amp; LRW).SpecialCells(xlCellTypeVisible).FormulaR1C1 = \"=iferror(VLOOKUP($D2,'BP Scoping'!A:B,2,0),D2)\"\n</code></pre>\n"}, {"tags": ["excel", "vba", "internet-explorer"], "comments": [{"owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 0, "creation_date": 1456335106, "post_id": 35608395, "comment_id": 58902359, "body": "I think you&#39;d have to add the &quot;x-combo-selected&quot; into your class name since that&#39;s how it shows in the HTML"}], "owner": {"reputation": 291, "user_id": 2337922, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5075f986b54602d68419acf1fc22ddd9?s=128&d=identicon&r=PG", "display_name": "Singularity20XX", "link": "https://stackoverflow.com/users/2337922/singularity20xx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 240, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1456335399, "creation_date": 1456333174, "last_edit_date": 1456335399, "question_id": 35608395, "link": "https://stackoverflow.com/questions/35608395/item-selection-from-combo-box-using-vba-in-internet-explorer", "title": "Item Selection from combo-box using vba in Internet Explorer", "body": "<p>The below values represent a combobox / combo-list on a website. I am trying to select item #3 from the drop down using VBA. I have tried several things, but I have had no luck selecting said item. I have tried looking for solutions on Google and the Stack but haven't found anything that seems to work.</p>\n\n<pre><code>&lt;DIV id=ext-gen256 class=\"x-layer x-combo-list x-combo-list-small\" style=\"FONT-SIZE: 10px; HEIGHT: 92px; WIDTH: 113px; POSITION: absolute; LEFT: 744px; Z-INDEX: 12007; TOP: 235px; VISIBILITY: visible\"&gt;\n\n&lt;DIV id=ext-gen257 class=x-combo-list-inner style=\"HEIGHT: 90px; WIDTH: 111px\"&gt;\n\n&lt;DIV class=\"x-combo-list-item\" _nodup=\"30829\" viewIndex=\"0\"&gt;Select&lt;/DIV&gt;\n&lt;DIV class=\"x-combo-list-item\" _nodup=\"30829\" viewIndex=\"1\"&gt;Item 1&lt;/DIV&gt;\n&lt;DIV class=\"x-combo-list-item\" _nodup=\"30829\" viewIndex=\"2\"&gt;Item 2&lt;/DIV&gt;\n&lt;DIV class=\"\"x-combo-list-item\" _nodup=\"30829\" viewIndex=\"3\"&gt;Item 3&lt;/DIV&gt;\n&lt;DIV class=\"x-combo-list-item\" _nodup=\"30829\" viewIndex=\"4\"&gt;Item 4&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;\n</code></pre>\n\n<p>I have used several variatons of the below code to try and select the item in question (i.e item #3), but keep getting a runtime error</p>\n\n<pre><code>Dim inputE As MSHTML.HTMLHtmlElement\nSet inputE = IE.document.getElementsByClassName(\"x-combo-list-item\")\nIf inputE.innerText = \"Item 3\" Then\n    inputE.Select\nEnd If\n</code></pre>\n\n<p>This doesn't seem to work. Any help is greatly appreciated. Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1456348125, "post_id": 35608317, "comment_id": 58910078, "body": "Remove all spaces between words then sort alphabetically?"}, {"owner": {"reputation": 235, "user_id": 1015849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1d1c87798b770d74a6598fcb5e6f17c?s=128&d=identicon&r=PG", "display_name": "snoopen", "link": "https://stackoverflow.com/users/1015849/snoopen"}, "edited": false, "score": 0, "creation_date": 1456362659, "post_id": 35608317, "comment_id": 58916135, "body": "Could you use a list of matches on a separate worksheet and do a vlookup to match? Depending on the complexity of your input it might be the only safe way to match. Any other method might require assumptions like &quot;the first n characters will always be unique&quot;."}, {"owner": {"reputation": 235, "user_id": 1015849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1d1c87798b770d74a6598fcb5e6f17c?s=128&d=identicon&r=PG", "display_name": "snoopen", "link": "https://stackoverflow.com/users/1015849/snoopen"}, "edited": false, "score": 0, "creation_date": 1456362814, "post_id": 35608317, "comment_id": 58916191, "body": "I didn&#39;t notice the vba tag. This could be done without VBA within reason. Otherwise I&#39;d create an array or build a dictionary or collection with possible matches."}], "owner": {"reputation": 1, "user_id": 5975585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cb1c616c7af851de9eed210cb8ef82c?s=128&d=identicon&r=PG&f=1", "display_name": "Zareh", "link": "https://stackoverflow.com/users/5975585/zareh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 141, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1456333613, "creation_date": 1456332972, "last_edit_date": 1531161705, "question_id": 35608317, "link": "https://stackoverflow.com/questions/35608317/matching-similar-names-to-combine-data", "title": "Matching Similar names to combine data", "body": "<p>I have two Excel sheets that I am trying to combine into a single sheet. I have created a very small sample of the data I am dealing with and the output that I am attempting to get. I want to try and create a loop that when matches or if possible similar matches(IE Verizon Corp being linked to Verizon or Verizon Co.) and when these matches are found save the row in an array to be able to pull the bits of information that I am after into the output sheet.</p>\n\n<p>Sheet1</p>\n\n<pre><code>    Date       Cilent   Decript       Stage   Deal$      Segment\n1/15/2016   Verizon     Assistance     Won      $200        People\n12/10/2015  Home Depot  Service        Lost     $1,000     Intel\n10/30/2015  Home Depot  Contract       Progress $300       People\n11/13/2015  Samsung     Assistance     Progress $2,000  People\n</code></pre>\n\n<p>Sheet 2</p>\n\n<pre><code>Qtr  Month  Name      Large Name    Segment $   Segment $   Total\n4th  10   HomeDepot   Home Depot     $200         -     $200 \n4th  11   Samsung     Samsung         -         $5,000     $5,000 \n4th  12   HomeDepot   Home Depot     $200         -         $200 \n1st  1    Verizon     Verizon Corp   $5,000      $100    $5,100 \n</code></pre>\n\n<p>Output Sheet</p>\n\n<pre><code>Qtr Month  Name       Segment $  Segment $  Total    Stage   Deal$  Segment\n4th  10   Home Depot   $200         -       $200     Lost     $1,000  Intel\n4th  12   Home Depot   $200         -       $200     Progress $300    People \n4th  11   Samsung        -        $5,000    $5,000   Progress $2,000  People\n1st   1   Verizon      $5,000      $100     $5,100   Won      $200    People\n</code></pre>\n\n<p>I apologize for the messy tables, I just want to show my goal as best I can as I feel the above description does not convey my goal very well.</p>\n"}, {"tags": ["vba", "excel", "excel-2016"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1456333063, "post_id": 35607938, "comment_id": 58900875, "body": "I don&#39;t understand the motivation. Seems like a redundant &quot;do you want to save before close&quot; in addition to excel&#39;s?"}, {"owner": {"reputation": 399, "user_id": 4774521, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/nlLAj.jpg?s=128&g=1", "display_name": "michaelf", "link": "https://stackoverflow.com/users/4774521/michaelf"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1456333631, "post_id": 35607938, "comment_id": 58901321, "body": "I don&#39;t want to use the built in Excel save before dialog at all. I have a custom built one that runs other code depending on the users&#39; response. The problem is the workbook.beforeclose only fires one time in Excel 2016 version, but fires every time in other Excel versions. There is a lot more to my actual workbook, I just stripped it down to a bare minimum to illustrate this bug."}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1456339549, "post_id": 35607938, "comment_id": 58905093, "body": "If you watch your dirty flag when does it get set to false if you hit cancel?"}, {"owner": {"reputation": 399, "user_id": 4774521, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/nlLAj.jpg?s=128&g=1", "display_name": "michaelf", "link": "https://stackoverflow.com/users/4774521/michaelf"}, "edited": false, "score": 0, "creation_date": 1456344807, "post_id": 35607938, "comment_id": 58908179, "body": "It does not change when I hit cancel. It only changes when the workbook is saved. The issue isn&#39;t with the isDirty flag changing, as it shouldn&#39;t impact the workbook.beforeclose event.  It&#39;s only firing one time in this version of Excel, while it works fine in previous versions."}, {"owner": {"reputation": 399, "user_id": 4774521, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/nlLAj.jpg?s=128&g=1", "display_name": "michaelf", "link": "https://stackoverflow.com/users/4774521/michaelf"}, "edited": false, "score": 0, "creation_date": 1459299719, "post_id": 35607938, "comment_id": 60220191, "body": "Unfortunately, not getting any help on this Excel 2016 bug here at stack overflow. I looked but can&#39;t find a way to submit a bug to Microsoft. Does anyone know the process of submitting a bug to Microsoft?"}, {"owner": {"reputation": 399, "user_id": 4774521, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/nlLAj.jpg?s=128&g=1", "display_name": "michaelf", "link": "https://stackoverflow.com/users/4774521/michaelf"}, "edited": false, "score": 0, "creation_date": 1460146381, "post_id": 35607938, "comment_id": 60623961, "body": "So I updated my version of office and now the .beforeclose function alternates between my custom close box and the default Excel close dialog. You can see a short video of it here:   <a href=\"http://www.screencast.com/t/Mh3zI1HaXpX9\" rel=\"nofollow noreferrer\">screencast.com/t/Mh3zI1HaXpX9</a>"}, {"owner": {"reputation": 399, "user_id": 4774521, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/nlLAj.jpg?s=128&g=1", "display_name": "michaelf", "link": "https://stackoverflow.com/users/4774521/michaelf"}, "edited": false, "score": 0, "creation_date": 1460147513, "post_id": 35607938, "comment_id": 60624484, "body": "Better screencast showing VBA window: <a href=\"http://www.screencast.com/t/BdkTd9ib\" rel=\"nofollow noreferrer\">screencast.com/t/BdkTd9ib</a>"}, {"owner": {"reputation": 266, "user_id": 1690984, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/99b22cefc2280cc6fd7eefd9a229828c?s=128&d=identicon&r=PG", "display_name": "yngrdyn", "link": "https://stackoverflow.com/users/1690984/yngrdyn"}, "edited": false, "score": 0, "creation_date": 1460406879, "post_id": 35607938, "comment_id": 60717875, "body": "Having the same problem. did you find any solution or explanation?"}, {"owner": {"reputation": 399, "user_id": 4774521, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/nlLAj.jpg?s=128&g=1", "display_name": "michaelf", "link": "https://stackoverflow.com/users/4774521/michaelf"}, "edited": false, "score": 0, "creation_date": 1460507682, "post_id": 35607938, "comment_id": 60771681, "body": "Nope. Nothing. I put a post on mrexcel as well. I don&#39;t know how/where to report a bug, which this is."}, {"owner": {"reputation": 1994, "user_id": 2117037, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ba92d2cbd6945934f38d5aa952ffcab2?s=128&d=identicon&r=PG", "display_name": "Leo Gurdian", "link": "https://stackoverflow.com/users/2117037/leo-gurdian"}, "edited": false, "score": 0, "creation_date": 1471562444, "post_id": 35607938, "comment_id": 65408463, "body": "I&#39;m facing the exact same situation.  Thanks @michaelf for the very fine explanation and video.  Haven&#39;t found any fix yet : ["}, {"owner": {"reputation": 599, "user_id": 916379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c442dc0ca018dcf696a409f1aaf8414?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/916379/michael"}, "edited": false, "score": 0, "creation_date": 1472124018, "post_id": 35607938, "comment_id": 65631770, "body": "It works ok for me (Office 2016). I even did a clean install of it to make sure. I even tried to install BlueBeam Revu to have the same add-in as you. My lucky guess is that it has to do with your Add-ins. Try to disable all your &quot;Active Application Add-ins&quot; along with your COM Add-ins."}, {"owner": {"reputation": 399, "user_id": 4774521, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/nlLAj.jpg?s=128&g=1", "display_name": "michaelf", "link": "https://stackoverflow.com/users/4774521/michaelf"}, "edited": false, "score": 0, "creation_date": 1472156456, "post_id": 35607938, "comment_id": 65651620, "body": "I updated my version and it works as expected now. Thanks Microsoft!"}], "answers": [{"tags": [], "owner": {"reputation": 399, "user_id": 4774521, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/nlLAj.jpg?s=128&g=1", "display_name": "michaelf", "link": "https://stackoverflow.com/users/4774521/michaelf"}, "is_accepted": true, "score": 0, "last_activity_date": 1472156505, "creation_date": 1472156505, "answer_id": 39154133, "question_id": 35607938, "link": "https://stackoverflow.com/questions/35607938/excel-2016-workbook-beforeclose-event-firing-every-other-time-bug/39154133#39154133", "title": "Excel 2016 Workbook.BeforeClose event firing every other time bug", "body": "<p>Update to the latest version of Office and this shouldn't be an issue any longer. Took a few months but it's fixed. </p>\n"}], "owner": {"reputation": 399, "user_id": 4774521, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/nlLAj.jpg?s=128&g=1", "display_name": "michaelf", "link": "https://stackoverflow.com/users/4774521/michaelf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1892, "favorite_count": 1, "protected_date": 1506051241, "accepted_answer_id": 39154133, "answer_count": 1, "score": 4, "last_activity_date": 1506050907, "creation_date": 1456332039, "last_edit_date": 1502473450, "question_id": 35607938, "link": "https://stackoverflow.com/questions/35607938/excel-2016-workbook-beforeclose-event-firing-every-other-time-bug", "title": "Excel 2016 Workbook.BeforeClose event firing every other time bug", "body": "<p>8/25/16 Update: I updated Office 2016 (now on v 16.0.7167.2040) and it seems to have been fixed. I didn't change any add-ins or anything. Maybe Microsoft does look at these issues! Hopefully, anyone else with this issue can update their version and see this bug has been corrected. (I removed the dropbox link from the OP.)</p>\n\n<p>4/9/16 Update: I updated Office (now on v 16.0.6729.1012) Instead of the .beforeclose event only firing once, now the event fires every other time. Here is a video showing the odd behavior: <a href=\"http://screencast.com/t/BdkTd9ib\" rel=\"nofollow\">screencast.com/t/BdkTd9ib</a></p>\n\n<p>Original Post:\nRan across this bug today where the .beforeclose event only fires one time in Excel 2016. The following code works as expected in Excel 2007, 2010, and 2013 (all 32-bit on Windows 10) where the .beforeclose event fires every time. It does NOT work as expected in Excel 2016.</p>\n\n<p>Code in the Workbook.BeforeClose event only fires one time. If the user clicks \"Cancel\" to a custom save dialog box and Cancel=True so the workbook won't close, and the user goes to close the workbook again, the .BeforeClose does not fire. The default Excel close dialog shows instead.</p>\n\n<p>Steps to reproduce manually:\nCreate new .xlsm workbook.\nCreate a \"isDirty\" named range.\nIn the sheet1 module put the following:</p>\n\n<pre><code>    Private Sub Worksheet_Change(ByVal Target As Range)\n        If Target(1) = [isDirty] Then Exit Sub\n        Application.EnableEvents = False\n        [isDirty] = True\n        Application.EnableEvents = True\n    End Sub\n</code></pre>\n\n<p>Input this in the ThisWorkook Module:</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n    With Application\n        .EnableEvents = False\n        .DisplayAlerts = False\n        .Calculation = xlCalculationManual\n    End With\n\n    With Me\n        If [isDirty] = True Then\n            Select Case MsgBox(\"Do you want to save the changes you made to '\" &amp; .Name &amp; \"'?\", _\n                vbYesNoCancel + vbExclamation, \"CUSTOM CLOSE BOX\")\n            Case Is = vbYes\n                Call CustomSave\n            Case Is = vbNo\n                 Me.Saved = True\n            Case Is = vbCancel\n                Cancel = True\n                GoTo Cleanup\n            End Select\n        End If\n    End With\n\n    With Application\n        .EnableEvents = True\n        .StatusBar = False\n        .ScreenUpdating = True\n        .DisplayAlerts = True\n    End With\n\n    Me.Saved = True\n    Exit Sub\n\nCleanup: 'user hit cancel to custom save dialog box\n    With Application\n        .DisplayAlerts = True\n        .CalculateBeforeSave = False\n        .Calculation = xlCalculationManual\n        .EnableEvents = True\n        .ScreenUpdating = True\n        .StatusBar = False\n    End With\n    Me.Saved = False\nEnd Sub\n\nPrivate Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n     [isDirty] = False\nEnd Sub\n</code></pre>\n\n<p>Insert a custom Module and put this code:</p>\n\n<pre><code>Sub CustomSave()\n    [isDirty] = False\n    ThisWorkbook.Save\n    ThisWorkbook.Saved = True\nEnd Sub\n</code></pre>\n\n<p>If the user makes a change on Sheet1, the isDirty flag is set to True.\nUser clicks the X to close the workbook and .beforeclose event fires and the custom confirm close dialog box opens. \nUser hits cancel.</p>\n\n<p>User hits X again and now the normal Excel workbook close dialog opens asking if the user wants to save changes. The .beforeclose event does not fire again.</p>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 138, "user_id": 2056098, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ae67cc624d5dd8b7498d2ba4ebfc2d08?s=128&d=identicon&r=PG", "display_name": "Sparatan117", "link": "https://stackoverflow.com/users/2056098/sparatan117"}, "edited": false, "score": 0, "creation_date": 1456332278, "post_id": 35607841, "comment_id": 58900244, "body": "@Sparatan117 Glad to help.  Please come back in a few minutes and mark as correct."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1456331791, "creation_date": 1456331791, "answer_id": 35607841, "question_id": 35607703, "link": "https://stackoverflow.com/questions/35607703/get-range-from-a-separate-sheet-using-a-variable-in-excel/35607841#35607841", "title": "Get Range From A Separate Sheet Using a Variable in Excel", "body": "<p>You would use the Indirect() function:</p>\n\n<pre><code>=AVERAGE(INDIRECT(\"'Sheet1'!\" &amp; A2 &amp; \"2:\" &amp; A2 &amp; \"999\"))\n</code></pre>\n"}], "owner": {"reputation": 138, "user_id": 2056098, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ae67cc624d5dd8b7498d2ba4ebfc2d08?s=128&d=identicon&r=PG", "display_name": "Sparatan117", "link": "https://stackoverflow.com/users/2056098/sparatan117"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16, "favorite_count": 0, "accepted_answer_id": 35607841, "answer_count": 1, "score": 0, "last_activity_date": 1456331791, "creation_date": 1456331470, "last_edit_date": 1531161705, "question_id": 35607703, "link": "https://stackoverflow.com/questions/35607703/get-range-from-a-separate-sheet-using-a-variable-in-excel", "title": "Get Range From A Separate Sheet Using a Variable in Excel", "body": "<p>Looking to get a range from another sheet based upon the Column Letter which is obtained from the current sheet.</p>\n\n<p>So say that I designate A2 on the current sheet to the letter G. </p>\n\n<p>I would then ask A10 to =AVERAGE('Sheet1'!(A2)2:(A2)999)</p>\n\n<p>So essentially it would be =AVERAGE('Sheet1'!G2:G999)</p>\n\n<p>However, this doesn't work. Anyone have any idea how to make this worK? </p>\n"}, {"tags": ["c#", "vba", "excel", "macros"], "comments": [{"owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "edited": false, "score": 0, "creation_date": 1456331254, "post_id": 35607217, "comment_id": 58899415, "body": "Have you checked Options&gt;Formulas to make sure you have automatic workbook calculation selected? I sometimes turn this off programmtically!"}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1456331550, "post_id": 35607217, "comment_id": 58899665, "body": "This: <code>xlWorkBook.Close(false</code> is quit without saving, is that your intention?"}, {"owner": {"reputation": 823, "user_id": 5259690, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/f478be0a2c04bb9f4a358367639590b7?s=128&d=identicon&r=PG&f=1", "display_name": "sowjanya attaluri", "link": "https://stackoverflow.com/users/5259690/sowjanya-attaluri"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1456331827, "post_id": 35607217, "comment_id": 58899881, "body": "@AlexK. : i tried by given true also , but the values are not updating"}, {"owner": {"reputation": 823, "user_id": 5259690, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/f478be0a2c04bb9f4a358367639590b7?s=128&d=identicon&r=PG&f=1", "display_name": "sowjanya attaluri", "link": "https://stackoverflow.com/users/5259690/sowjanya-attaluri"}, "reply_to_user": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "edited": false, "score": 0, "creation_date": 1456332097, "post_id": 35607217, "comment_id": 58900092, "body": "@MiguelH : i verified Options-&gt;Formulas , &quot;Automatic&quot; option is already selected. if i click the button in excel sheet the values are updating , but not via source code . But both calling same macro functions only"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1456333073, "creation_date": 1456333073, "answer_id": 35608362, "question_id": 35607217, "link": "https://stackoverflow.com/questions/35607217/excel-file-values-are-not-updating/35608362#35608362", "title": "excel file values are not updating", "body": "<p>When you start Excel via automation, any add-ins or items in the xlstart folder are not loaded.  </p>\n\n<p>If your code relies on add-ins being loaded, then you will need to load them via your code.</p>\n\n<p>See:  <a href=\"https://support.microsoft.com/en-us/kb/213489\" rel=\"nofollow\">https://support.microsoft.com/en-us/kb/213489</a></p>\n"}], "owner": {"reputation": 823, "user_id": 5259690, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/f478be0a2c04bb9f4a358367639590b7?s=128&d=identicon&r=PG&f=1", "display_name": "sowjanya attaluri", "link": "https://stackoverflow.com/users/5259690/sowjanya-attaluri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456333073, "creation_date": 1456330322, "last_edit_date": 1456331585, "question_id": 35607217, "link": "https://stackoverflow.com/questions/35607217/excel-file-values-are-not-updating", "title": "excel file values are not updating", "body": "<p>In my application i have an excel sheet with button. Using C# code i'm calling the button of excel file and the excel file click event also working very fine. I placed msg box in macros in that way i verified the click event of the excel sheet button working fine.But after running the macro the values are not updating in excel sheet. Please refer my code below , </p>\n\n<pre><code>using Excel = Microsoft.Office.Interop.Excel;\nExcel.Application xlApp = new Excel.Application();\nExcel.Workbook xlWorkBook;\nxlWorkBook = xlApp.Workbooks.Open(\"D:test.xlsm\", 0, true, 5, \"\", \"\", true, Microsoft.Office.Interop.Excel.XlPlatform.xlWindows, \"\\t\", false, false, 0, true, 1, 0);\nExcel.Worksheet xlWorkSheet;\nxlWorkSheet = (Excel.Worksheet)xlWorkBook.Worksheets.get_Item(1);\nxlApp.Run(\"Module1.solver\", Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing);\nxlWorkBook.Close(false, Type.Missing, Type.Missing);\n xlApp.Quit();\nreleaseObject(xlApp);\nreleaseObject(xlWorkBook);\nprivate void releaseObject(object obj)\n    {\n        try\n        {\n            System.Runtime.InteropServices.Marshal.ReleaseComObject(obj);\n            obj = null;\n        }\n        catch (Exception ex)\n        {\n            throw (ex);\n            obj = null;\n        }\n        finally\n        {\n            GC.Collect();\n        }\n    }  \n</code></pre>\n\n<p>Am I missing some function to update excel file ? And the macros I'm using are</p>\n\n<pre><code>SolverOk SetCell:=\"$A$6\", MaxMinVal:=2, ValueOf:=0, ByChange:=\"$A$4:$A$6\", _\n    apple:=1, applecurry:=\"GRG Nonlinear\"\nMsgBox \"$3\"\nSolverOk SetCell:=\"$A$6\", MaxMinVal:=2, ValueOf:=0, ByChange:=\"$A$4:$A$6\", _\n    apple:=1, applecurry:=\"GRG Nonlinear\"\nMsgBox \"$4\"\nSolverSolve\n</code></pre>\n"}, {"tags": ["html", "vba", "excel"], "comments": [{"owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 0, "creation_date": 1456331050, "post_id": 35607182, "comment_id": 58899246, "body": "you could try ie.Document.getElementbyName(&quot;position&quot;)(0).Value = &quot;ltl&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1456332932, "last_edit_date": 1456332932, "creation_date": 1456332149, "answer_id": 35607980, "question_id": 35607182, "link": "https://stackoverflow.com/questions/35607182/vba-control-a-drop-down-menu/35607980#35607980", "title": "VBA control a drop down menu", "body": "<p>Something like</p>\n\n<pre><code>Dim ie As SHDocVw.InternetExplorer\nDim d As MSHTML.IHTMLSelectElement\n\nSet ie = New InternetExplorer\nie.Visible = 1\n\nie.navigate \"http://www.saia.com/RequestQuote.aspx\"\n\nWhile ie.Busy Or ie.readyState &lt;&gt; READYSTATE_COMPLETE\n    DoEvents\nWend\n\nSet d = ie.document.getElementById(\"quoteDropdown\")\n\n'     Then use d.selectedindex or d.item(1).text d.value etc.\n</code></pre>\n\n<p>Looking at the web page source, is handled from the click event on each of the inner items, so you'll need to get those, and then fire the click event</p>\n\n<p>From page  \" $('#quoteDropdown').val('ltl').trigger('click').selectric('refresh');\n                                loadquote('ltl');\"</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5975504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4904a1843079a053f67235704f62bd49?s=128&d=identicon&r=PG", "display_name": "Fuji-San", "link": "https://stackoverflow.com/users/5975504/fuji-san"}, "is_accepted": true, "score": 0, "last_activity_date": 1456515458, "creation_date": 1456515458, "answer_id": 35660230, "question_id": 35607182, "link": "https://stackoverflow.com/questions/35607182/vba-control-a-drop-down-menu/35660230#35660230", "title": "VBA control a drop down menu", "body": "<p>Okay, I got it all figured out. Thanks Nathan_Sav for pointing me to that statement. This code was changing the index but wasn't firing the event.</p>\n\n<pre><code>ie.document.getElementbyID(\"quoteDropdown\").selectedindex = 1\n</code></pre>\n\n<p>In order to fire the event I had to call the function \"loadquote\"</p>\n\n<p><code>ie.document.parentWindow.execScript \"loadquote('ltl')\"</code></p>\n\n<p>this successfully called the function \"loadquote\" and updated the page. </p>\n"}], "owner": {"reputation": 1, "user_id": 5975504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4904a1843079a053f67235704f62bd49?s=128&d=identicon&r=PG", "display_name": "Fuji-San", "link": "https://stackoverflow.com/users/5975504/fuji-san"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3085, "favorite_count": 0, "accepted_answer_id": 35660230, "answer_count": 2, "score": 0, "last_activity_date": 1456515458, "creation_date": 1456330195, "last_edit_date": 1456332354, "question_id": 35607182, "link": "https://stackoverflow.com/questions/35607182/vba-control-a-drop-down-menu", "title": "VBA control a drop down menu", "body": "<p>I am trying to control a drop down list on a <a href=\"http://www.saia.com/RequestQuote.aspx\" rel=\"nofollow\">website</a>, but for some reason have been unable to interact with it. Here is the HTML section that I believe is responsible from the drop down menu:</p>\n\n<pre class=\"lang-javascript prettyprint-override\"><code>    &lt;div id=\"content\"&gt;\n        &lt;div id=\"main\"&gt;\n            &lt;div class=\"container\"&gt;\n                &lt;div class=\"formBody\"&gt;\n                    &lt;h1&gt;Get a Quote&lt;/h1&gt;\n                    &lt;div style=\"width:215px; height:35px;\" class=\"noBottomSpacing\"&gt;\n                      &lt;select id=\"quoteDropdown\" name=\"position\"&gt;\n                            &lt;option&gt;Select Type of Quote&lt;/option&gt;\n                            &lt;option value=\"ltl\"&gt;LTL Quote&lt;/option&gt;\n                            &lt;option value=\"truckload\"&gt;Truckload Quote&lt;/option&gt;\n                            &lt;option value=\"expedited\"&gt;Expedited Quote&lt;/option&gt;\n                            &lt;option value=\"Mexico\"&gt;Mexico Quote&lt;/option&gt;\n                        &lt;/select&gt;\n                    &lt;/div&gt;\n\n                &lt;/div&gt;\n                &lt;br /&gt;\n                &lt;div class=\"quoteContent\"&gt;\n                &lt;/div&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n</code></pre>\n\n<p>I've tried several different VBA snippets but nothing seems to work. </p>\n\n<pre><code>    ie.Document.getElementbyID(\"quoteDropdown\").selectedindex = 1\n    ie.Document.getElementbyID(\"quoteDropdown\").Item(0).Value = 1\n    ie.Document.getElementbyID(\"quoteDropdown\").Value = \"ltl\"\n</code></pre>\n\n<p>If anyone has any guidance I would appreciate. Thanks!</p>\n"}, {"tags": ["excel", "vba", "excel-2007"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1456329947, "post_id": 35606890, "comment_id": 58898381, "body": "Have you looked at the MS&#39;s <a href=\"https://www.microsoft.com/en-us/download/details.aspx\" rel=\"nofollow noreferrer\">Fuzzy Lookup Add-In for Excel</a>? Here&#39;s a <a href=\"https://www.youtube.com/watch?v=3v-qxcjZbyo\" rel=\"nofollow noreferrer\">YouTube</a> video."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1456335385, "post_id": 35606890, "comment_id": 58902554, "body": "Are you looking to have the &quot;cleaned&quot; name next to the orginal one, or to replace the entered name with the &quot;cleaned&quot; one?"}, {"owner": {"reputation": 29, "user_id": 5974900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2IZN0.jpg?s=128&g=1", "display_name": "JoeDolan", "link": "https://stackoverflow.com/users/5974900/joedolan"}, "edited": false, "score": 0, "creation_date": 1456339144, "post_id": 35606890, "comment_id": 58904848, "body": "Ultimately replace the original. For now I have just been making a list of all the &quot;cleaned&quot; names, which I hope to use to replace the names they homogenized."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 5974900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2IZN0.jpg?s=128&g=1", "display_name": "JoeDolan", "link": "https://stackoverflow.com/users/5974900/joedolan"}, "edited": false, "score": 0, "creation_date": 1456334472, "post_id": 35607315, "comment_id": 58901912, "body": "I don&#39;t want to search for 3M specifically, I want to reference the cells in the list I already have of homogeneous manufacturer names. I have 500 manufacturer names so including any specific text string in the formula would just mean having to repeat that hundreds of times for different text strings."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 29, "user_id": 5974900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2IZN0.jpg?s=128&g=1", "display_name": "JoeDolan", "link": "https://stackoverflow.com/users/5974900/joedolan"}, "edited": false, "score": 0, "creation_date": 1456339827, "post_id": 35607315, "comment_id": 58905278, "body": "You can use an array to search for multiple items, do a bit of reading on arrays, you would use something like c1:c6 where &quot;3M&quot; is, so something like if(search(c1:c6,a1:a6,1)&gt;0,d1:d6) where d1:d6 is the replacement value, sort of a looping vlookup.  I&#39;ll try and do something for you.  Not 100% sure i&#39;ll have time."}, {"owner": {"reputation": 29, "user_id": 5974900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2IZN0.jpg?s=128&g=1", "display_name": "JoeDolan", "link": "https://stackoverflow.com/users/5974900/joedolan"}, "edited": false, "score": 0, "creation_date": 1456341391, "post_id": 35607315, "comment_id": 58906174, "body": "Tried variations of the formula you suggested and wasn&#39;t working. I have one column with Every manufacturer name (non homogenized) and another with the homogenized names I have made so far. WTV function needs to go through the non homogenized list and see for every cell whether and text string in the homogenized list is found within the cell, then either output the cells that do, do not, or indicate in their row whether or not they do or do not."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 29, "user_id": 5974900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2IZN0.jpg?s=128&g=1", "display_name": "JoeDolan", "link": "https://stackoverflow.com/users/5974900/joedolan"}, "edited": false, "score": 0, "creation_date": 1456395702, "post_id": 35607315, "comment_id": 58930780, "body": "Did you fix this?  If you have Data in A1:B4 as your replacement data, so in A the text to replace, in B the replacement, so 3M Corp in A, 3M in B.   My columnd of to seach on is D, so have a variety in there like 3M Corp, 3M Asia, Panasonic Plc, Panasonic Ltd, then in E I have the following formula                                                                                                     =INDEX($B$2:$B$4,MAX(IF(ISERROR(FIND($A$2:$A$4,D2)),-1,ROW($&zwnj;&#8203;A$2:$A$4)-1)),1)   Hope this helps."}, {"owner": {"reputation": 29, "user_id": 5974900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2IZN0.jpg?s=128&g=1", "display_name": "JoeDolan", "link": "https://stackoverflow.com/users/5974900/joedolan"}, "edited": false, "score": 0, "creation_date": 1456936963, "post_id": 35607315, "comment_id": 59179568, "body": "Maybe I misunderstand what you are saying, but those are no quite what I have here. I have Column A2:A560 with the incomplete homogeneous manufacturer names (as in the names I would like to use as homogeneous replacements for the varying names that will appear in column B), and Column B2:B185 with every manufacturer name without consideration to multiple names for the same thing. I am not sure what the code you wrote is doing with column C, D, and E, but I only need one column as an output. If you are suggesting forming another column with something different to help could you please clarify?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 29, "user_id": 5974900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2IZN0.jpg?s=128&g=1", "display_name": "JoeDolan", "link": "https://stackoverflow.com/users/5974900/joedolan"}, "edited": false, "score": 0, "creation_date": 1456992026, "post_id": 35607315, "comment_id": 59204600, "body": "It is what you asked for, I have my replacements in b instead of a.  I used c as a test entry to replace and d with the answer, so in mine i have say, a1 is 3m, b1 is 3m corp, d1 contains 3m Japan inc,  Did you try based on my answer? You need to do some investigations yourself to ;-)"}, {"owner": {"reputation": 29, "user_id": 5974900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2IZN0.jpg?s=128&g=1", "display_name": "JoeDolan", "link": "https://stackoverflow.com/users/5974900/joedolan"}, "edited": false, "score": 0, "creation_date": 1457706334, "post_id": 35607315, "comment_id": 59541547, "body": "I am not sure why you have a column c with test entries (not sure where you are getting these or why you would need). You say you put replacements in column b and things to be replaced in a, yet you give the example where a1 contains 3m and b1 contains 3mcorp. which looks like a1 should be replacing b1 because it is an abbreviated version of their name. If d is your answer (answer could say if entry in the column with extra names to be homogenized contains something in the homogeneous column) why are you getting 3m Japan, which isn&#39;t simple like 3m (because it contains &quot;Japan&quot; text string)?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 29, "user_id": 5974900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2IZN0.jpg?s=128&g=1", "display_name": "JoeDolan", "link": "https://stackoverflow.com/users/5974900/joedolan"}, "edited": false, "score": 0, "creation_date": 1457717571, "post_id": 35607315, "comment_id": 59549486, "body": "A is what to be replaced b is what to replace it with c is my own test data and d.  I can&#39;t offer much more help, have you tried anything yourself? A=3m b=3m corp c= 3m Japan d is then 3m corp. What can&#39;t you understand from my edited answer,  it&#39;s all there."}, {"owner": {"reputation": 29, "user_id": 5974900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2IZN0.jpg?s=128&g=1", "display_name": "JoeDolan", "link": "https://stackoverflow.com/users/5974900/joedolan"}, "edited": false, "score": 0, "creation_date": 1458140992, "post_id": 35607315, "comment_id": 59728250, "body": "Please see my comment on March 11th for what I don&#39;t understand about your approach. It may be clear to you, but evidently there was some miscommunication. I finished the problem myself. I wish I could have made sense of what you were trying to do."}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1456395776, "last_edit_date": 1456395776, "creation_date": 1456330574, "answer_id": 35607315, "question_id": 35606890, "link": "https://stackoverflow.com/questions/35606890/how-would-i-go-about-checking-every-cell-in-a-column-to-see-if-it-includes-any-t/35607315#35607315", "title": "How would I go about checking every cell in a column to see if it includes any text string in a cell from another column?", "body": "<p>you can do it using formula, and the SEARCH function, so something like</p>\n\n<pre><code>=IFERROR(IF(SEARCH(\"3M\",A1,1)&gt;0,\"3M\",A1),A1)\n</code></pre>\n\n<p>You can modify this to suit your needs.</p>\n\n<p>If you had data in A1:A6 for example, the following array formula would return the rows where 3M is in the text</p>\n\n<pre><code>=SMALL(IF(IFERROR(SEARCH(\"3M\",$A$1:$A$6,1)&gt;0,0),ROW($A$1:$A$6)),ROWS($B$1:$B1))\n</code></pre>\n\n<p>Let me know if I can help further.</p>\n\n<p>EDIT further solution</p>\n\n<p>If you have Data in A1:B4 as your replacement data, so in A the text to replace, in B the replacement, so 3M Corp in A, 3M in B. My columnd of to seach on is D, so have a variety in there like 3M Corp, 3M Asia, Panasonic Plc, Panasonic Ltd, then in E I have the following formula </p>\n\n<p><code>=INDEX($B$2:$B$4,MAX(IF(ISERROR(FIND($A$2:$A$4,D2)),-1,ROW($A$2:$A$4)-1)),1)</code> \nHope this helps. </p>\n"}], "owner": {"reputation": 29, "user_id": 5974900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2IZN0.jpg?s=128&g=1", "display_name": "JoeDolan", "link": "https://stackoverflow.com/users/5974900/joedolan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 156, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1456395776, "creation_date": 1456329471, "last_edit_date": 1456338791, "question_id": 35606890, "link": "https://stackoverflow.com/questions/35606890/how-would-i-go-about-checking-every-cell-in-a-column-to-see-if-it-includes-any-t", "title": "How would I go about checking every cell in a column to see if it includes any text string in a cell from another column?", "body": "<p>I am working with a product database in Excel and seeking to clean up and homogenize the way to which manufacturers are referred. The database is about 9k rows so is not friendly to manual editing. There are also some manufacturer names missing in the database--it is not perfect.</p>\n\n<p>The headings for each column are organized as follows:</p>\n\n<pre><code>SKU(commercial product code)  |  Commercial Description  |  Manufacturer Name\n</code></pre>\n\n<p>And an example of a row entry would be:</p>\n\n<pre><code>MCO20264  |  PAD,BURNISH,27 IN,PK5  |  3M Corp.\n</code></pre>\n\n<p>The goal is to edit the Manufacturer Name column so that every time there is a reference to a manufacturer, for example 3M, whether it be by the entry 3M Corp., 3M Corporation, 3M, etc., it uses a homogeneous name, such as 3M, rather than multiple names. There are about 500 different Manufacturer Names. Many are referred to via multiple names, but when they are, they always include some abbreviated version of their name in the text string, like how 3M always appears in the list above.</p>\n\n<p>I already have some homogenized manufacturer names. The homogeneous manufacturer names that I have are in a column on a separate sheet, and because of how many there are I would like the cells in that column to be referenced rather than including individual text strings of each name in the function.</p>\n\n<p>I seek to exclude any row in my list of <strong>all</strong> manufacturers in which the Manufacturer Name cell contains a text string of a homogeneous name, such as 3M, anywhere in the cell, so that I can work with only those names which lack a homogeneous name to which they could be referred. The ultimate goal is to complete the homogeneous manufacturer names list, and apply it to the database so that each manufacturer is only referred to in one way.</p>\n\n<p>I have tried various ways to include</p>\n\n<pre><code>\"*\"A2\"*\"\n</code></pre>\n\n<p>type notation in functions to solve this issue, but have had no success including this notation here.</p>\n\n<p>Does anybody know how I could solve my problem?</p>\n"}, {"tags": ["vba", "excel", "concatenation"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5889203"}, "edited": false, "score": 0, "creation_date": 1456329027, "post_id": 35606392, "comment_id": 58897634, "body": "Ron De Bruin&#39;s website addresses this <a href=\"http://www.rondebruin.nl/win/s9/win005.htm\" rel=\"nofollow noreferrer\">rondebruin.nl/win/s9/win005.htm</a>"}, {"owner": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "edited": false, "score": 0, "creation_date": 1456329597, "post_id": 35606392, "comment_id": 58898097, "body": "tried Cells(Rows.Count, &quot;H&quot;).End (xlUp) but doesn&#39;t work. I can see sort of how to put it in its own sub. but struggling to see how to fit it into a one liner at the beginning of the for next loop? sorry am pretty new to VBA"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1456333774, "creation_date": 1456333774, "answer_id": 35608586, "question_id": 35606392, "link": "https://stackoverflow.com/questions/35606392/concatenating-staggered-columns/35608586#35608586", "title": "concatenating staggered columns", "body": "<p>You're repeating the same logic multiple times, so it makes sense to pull it out into a separate Sub.</p>\n\n<p>Tested:</p>\n\n<pre><code>Sub Concatenation_for_the_nation()\n\n    Dim c As Range, s As String, sht As Worksheet\n\n    Set sht = ActiveSheet\n\n    For Each c In sht.Range(\"H1:K1\")\n        s = s &amp; ColumnString(c)\n    Next c\n\n    sht.Cells(21, 21).Value = s\n    sht.Cells(20, 20).Value = \"Jeff\"\n\n    MsgBox \"arrrrr\"\n\nEnd Sub\n\n\nFunction ColumnString(cStart As Range, Optional sep As String = \" \")\n    Dim rng As Range, c As Range, rv As String\n    Set rng = cStart.Parent.Range(cStart, _\n                     cStart.Parent.Cells(Rows.Count, cStart.Column).End(xlUp))\n    For Each c In rng.Cells\n        rv = rv &amp; sep &amp; c.Value\n    Next c\n    ColumnString = rv\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 127, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456333774, "creation_date": 1456328254, "question_id": 35606392, "link": "https://stackoverflow.com/questions/35606392/concatenating-staggered-columns", "title": "concatenating staggered columns", "body": "<p>I am working on a macro to loop through staggered columns of strings and concatenate them. Basically data gets added into the columns over time so I need to make it \"future-proof\". At the moment it picks up all of column H and I but only the first value of J and K. Not sure why it works for half but not the other. I am thinking its to do with my .End(xldown) as i am used to using rows.end(xlup).count to loop through things, but never when it is part of the range?\nHere is my code: </p>\n\n<pre><code>Sub Concatenation_for_the_nation()\n\nRange(\"H2\").End(xlDown).Select\nFor i = 1 To ActiveCell.Row\n    Range(\"H\" &amp; i).Select\n    StrStrONE = StrStrONE &amp; \" \" &amp; Selection\nNext i\nCells(1, 1).Select\n\nRange(\"I2\").End(xlDown).Select\nFor j = 1 To ActiveCell.Row\n    Range(\"I\" &amp; j).Select\n    StrStrTWO = StrStrTWO &amp; \" \" &amp; Selection\nNext j\nCells(1, 1).Select\n\nRange(\"J2\").End(xlDown).Select\nFor k = 1 To ActiveCell.Row\n    Range(\"J\" &amp; k).Select\n    StrStrTHREE = StrStrTHREE &amp; \" \" &amp; Selection\nNext k\nCells(1, 1).Select\n\nRange(\"K2\").End(xlDown).Select\nFor l = 1 To ActiveCell.Row\n    Range(\"K\" &amp; l).Select\n    StrStrFOUR = StrStrFOUR &amp; \" \" &amp; Selection\nNext l\nCells(1, 1).Select\n\nCells(21, 21) = StrStrONE &amp; StrStrTWO &amp; StrStrTHREE &amp; StrStrFOUR\n\nCells(20, 20) = \"Jeff\"\n\nMsgBox \"steve the pirate\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1456329115, "post_id": 35606314, "comment_id": 58897715, "body": "In which event do you run this code? If it&#39;s in <code>txtSearch_Change()</code>, you will need <code>Me.txtSearch.Text</code> instead of <code>Me.txtSearch</code> (which is <code>Me.txtSearch.Value</code>), because .Value isn&#39;t set until you leave the control. -- Although I get a runtime error when calling DoCmd.FindRecord with an empty search text. -- Edit: to find out if this is the problem, add a <code>Debug.Print sText</code> after assigning it."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1456329547, "post_id": 35606314, "comment_id": 58898056, "body": "If it is acceptable to display only rows which contain matches for the search text, use the form&#39;s <code>Filter</code> property."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1456330392, "post_id": 35606314, "comment_id": 58898724, "body": "@Andre - Thanks. I updated my answer. I call it from a button click. <code>sText</code> is not empty."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1456330443, "post_id": 35606314, "comment_id": 58898767, "body": "@HansUp. Thanks but the form is not in datasheet view. It&#39;s SingleForm with a custom layout."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1456338133, "post_id": 35606314, "comment_id": 58904233, "body": "If you do <code>Me!txtSome_field.SetFocus</code> before your <code>DoCmd.FindRecord</code> that should put you at the first record where <code>txtSome_field</code> matches <code>txtSearch</code>, if there is a match.  If there is more than one match, <code>DoCmd.FindNext</code> will take you to the second matching record.  Is that what you want?  (Sorry, I&#39;m lost.)"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1456340576, "post_id": 35606314, "comment_id": 58905723, "body": "@HansUp - thanks for the help. Choosing <code>SetFocus</code> definitely helped. I want to find the first record, or the next one if the first search did not land on the needed record. (I understand how the code I posted is a bit confusing). I think Andre has posted a good working solution for now."}], "answers": [{"comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1456340624, "post_id": 35610204, "comment_id": 58905747, "body": "Thanks Andre. This definitely gets me almost there. I need to search multiple fields, but I can refactor this code to that :)"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 3, "last_activity_date": 1456338692, "creation_date": 1456338692, "answer_id": 35610204, "question_id": 35606314, "link": "https://stackoverflow.com/questions/35606314/access-search-all-records-in-a-single-form/35610204#35610204", "title": "Access Search All Records in a Single Form", "body": "<p>I think HansUp has posted the solution... but since I was coming up with a different way of searching (via <code>RecordsetClone</code> and <code>FindFirst</code>), I'll post it anyway, maybe it is of use. :)</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub cmdFind_Click()\n\n    Static RS As Recordset\n    Static sText As String\n    Dim curText As String\n    Dim newSearch As Boolean\n    Dim sCrit As String\n\n    curText = Nz(Me.txtSearch)\n    If curText = \"\" Then Exit Sub\n\n    ' If text hasn't changed, use FindNext\n    If curText = sText Then\n        newSearch = False\n    Else\n        sText = curText\n        newSearch = True\n    End If\n\n    ' First call?\n    If RS Is Nothing Then\n        Set RS = Me.RecordsetClone\n        newSearch = True\n    End If\n\n    ' The field you are searching in\n    sCrit = \"[Text1] LIKE '*\" &amp; sText &amp; \"*'\"\n\n    If newSearch Then\n        RS.FindFirst sCrit\n    Else\n        RS.FindNext sCrit\n    End If\n\n    If Not RS.NoMatch Then\n        ' If found, navigate to the record\n        Me.Bookmark = RS.Bookmark\n    Else\n        MsgBox \"No (more) matches)\", vbInformation\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1456344046, "post_id": 35611699, "comment_id": 58907735, "body": "thanks HansUp. Yes, I was experiencing the problem of having it always find the <code>txtSearch</code> box. I appreciate the cleaned-up version of my original approach. And yes, I did want <code>acAll</code> and had it originally (meant to change back)."}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": false, "score": 2, "last_activity_date": 1456367290, "last_edit_date": 1456367290, "creation_date": 1456343466, "answer_id": 35611699, "question_id": 35606314, "link": "https://stackoverflow.com/questions/35606314/access-search-all-records-in-a-single-form/35611699#35611699", "title": "Access Search All Records in a Single Form", "body": "<p>Seems you want to find the first record where <em>any</em> field matches the search text.</p>\n\n<p>In that case, use <code>acAll</code> instead of <code>acCurrent</code> for the sixth argument (<em>OnlyCurrentField</em>) to <code>DoCmd.FindRecord</code>.</p>\n\n<p><code>FindRecord</code> will be examining the form's controls, and that includes <code>txtSearch</code>. So clear out that text box's value immediately before calling <code>FindRecord</code>.  Otherwise every row in the form's <em>Record Source</em> will be interpreted as a match.  That happens because there is no way to tell <code>FindRecord</code> to <em>\"look for a match in every control except <code>txtSearch</code>.\"</em></p>\n\n<p>That explanation should be clearer if you test your original code with the form in <em>Continuous Form</em> view (temporarily).  With that code, <code>FindRecord</code> always put you at the first record.  And then <code>DoCmd.FindNext</code> put you at the second record.</p>\n\n<p>Anyway here is code tested in Access 2010 which does what I think you want.  I used the text box's <em>After Update</em> event instead of a command button.</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub txtSearch_AfterUpdate()\n    Dim strSearch As String\n\n    If Not IsNull(Me!txtSearch.Value) Then\n        strSearch = Me!txtSearch.Value 'a text box where user enters search term\n        ' txtSearch contains the search text ...\n        ' so remove it to avoid matching the first (and every) record\n        Me!txtSearch.Value = Null\n        DoCmd.FindRecord FindWhat:=strSearch, _\n            Match:=acAnywhere, _\n            MatchCase:=False, _\n            Search:=acDown, _\n            SearchAsFormatted:=True, _\n            OnlyCurrentField:=acAll ' instead of acCurrent\n        ' restore search text to text box\n        Me!txtSearch.Value = strSearch\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2864, "favorite_count": 0, "accepted_answer_id": 35610204, "answer_count": 2, "score": 1, "last_activity_date": 1456367290, "creation_date": 1456328056, "last_edit_date": 1456343492, "question_id": 35606314, "link": "https://stackoverflow.com/questions/35606314/access-search-all-records-in-a-single-form", "title": "Access Search All Records in a Single Form", "body": "<p>I have a bound form in Single Form view. </p>\n\n<p>I want to mimic the behavior of the Search box in the Record Navigation Buttons, but also have more control. The problem I am facing is that when my users search for a record, sometimes they accidentally start typing over a record when it's found (say after 3 or 4 letters are entered and they are still typing the search term) and the original data gets lost. Since these fields require data entry at times, locking them isn't really an option at this point.</p>\n\n<p>My thought was to turn the Navigation Buttons off and mimic this feature through VBA or through a macro, and set the focus on another locked field when the value searched for is found (also with options to find the next one or to alert that something was, or was not found). </p>\n\n<p>I have tried working with macros and VBA already, but cannot get it work.</p>\n\n<p>I have this code (and have played with the arguments a bit), but it will only search the current record (and not all records) and either moves to the next record, or no record at all if I comment out the <code>FindNext</code> line.</p>\n\n<pre><code>Private Sub cmdFind_Click()\n\nDim sText As String\nsText = Me.txtSearch 'a text box where user enters search term\n\nDoCmd.FindRecord sText, acAnywhere, False, acDown, True, acCurrent\nDoCmd.FindNext\n\nEnd Sub\n</code></pre>\n\n<p>Obviously, I am missing something. Can someone lend some insight or an alternative approach.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1456328834, "post_id": 35606457, "comment_id": 58897475, "body": "The trick after what you&#39;ve done is to set the Chart.Chartobject, which is where you get to the Series, etc."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 1, "creation_date": 1456329541, "post_id": 35606457, "comment_id": 58898053, "body": "@DougGlancy Other way round actually. <code>Series</code> etc belong to <code>Chart</code>, which may be contained in a <code>Chartobject</code>, unless it&#39;s a separate sheet."}, {"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1456330384, "post_id": 35606457, "comment_id": 58898719, "body": "@Rory, Woops. Right you are. Thanks."}, {"owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "edited": false, "score": 0, "creation_date": 1456333235, "post_id": 35606457, "comment_id": 58901015, "body": "Well I was sure I had tried that ... Seems not ... still thanks for giving me the right answer"}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 4, "last_activity_date": 1456328437, "creation_date": 1456328437, "answer_id": 35606457, "question_id": 35606268, "link": "https://stackoverflow.com/questions/35606268/vba-excel-2010-assign-chart-to-a-object-variable/35606457#35606457", "title": "VBA Excel 2010 - Assign chart to a object/variable", "body": "<pre><code>Public Sub cht()\n\nDim v As Chart\n\nSet v = ActiveChart\n\nEnd Sub\n</code></pre>\n\n<p>This worked for me.  Is there an active chart?</p>\n"}, {"tags": [], "owner": {"reputation": 81, "user_id": 8747457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64cf8f72625c496ca3881a1e07afcc31?s=128&d=identicon&r=PG&f=1", "display_name": "repete90", "link": "https://stackoverflow.com/users/8747457/repete90"}, "is_accepted": false, "score": 1, "last_activity_date": 1530051743, "creation_date": 1530051743, "answer_id": 51052120, "question_id": 35606268, "link": "https://stackoverflow.com/questions/35606268/vba-excel-2010-assign-chart-to-a-object-variable/51052120#51052120", "title": "VBA Excel 2010 - Assign chart to a object/variable", "body": "<p>If you needed to use the chartObject variable type you can do it this way</p>\n\n<pre><code>Dim wb As Workbook\nDim ws As Worksheet\nDim chrt As ChartObject\n\nSet wb = ActiveWorkbook\nSet ws = ActiveSheet\n\nSet chrt = ws.ChartObjects(wb.ActiveChart.Parent.Name)\n</code></pre>\n"}], "owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5046, "favorite_count": 0, "accepted_answer_id": 35606457, "answer_count": 2, "score": 2, "last_activity_date": 1530051743, "creation_date": 1456327967, "last_edit_date": 1456328418, "question_id": 35606268, "link": "https://stackoverflow.com/questions/35606268/vba-excel-2010-assign-chart-to-a-object-variable", "title": "VBA Excel 2010 - Assign chart to a object/variable", "body": "<p>As we all know,</p>\n\n<pre><code>Dim wkSheet as Worksheet\nSet wkSheet = ActiveSheet\n</code></pre>\n\n<p>will make it so the active sheet is defined by <code>wkSheet</code> and you can do what you want with it using <code>wkSheet</code></p>\n\n<p>My question is, how do you do this with a chart? </p>\n\n<p>You can use <code>ActiveChart.</code> to do almost anything you want with the chart.</p>\n\n<p>However I seem unable to set the chart as a varible/object/shape (or what ever it needs to be)</p>\n"}, {"tags": ["excel", "rating", "vba"], "comments": [{"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 2, "creation_date": 1456328615, "post_id": 35606111, "comment_id": 58897324, "body": "See <a href=\"http://chandoo.org/wp/2015/08/15/incell-5-star-chart/\" rel=\"nofollow noreferrer\">icon sets</a>"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 4798588, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5d9aa69464ad883c098d00e1ab8f349f?s=128&d=identicon&r=PG&f=1", "display_name": "Roshan", "link": "https://stackoverflow.com/users/4798588/roshan"}, "edited": false, "score": 0, "creation_date": 1456422397, "post_id": 35607199, "comment_id": 58950719, "body": "Thank you, it works as I wanted, now I am working on it to understand your code and see if I could apply that on Google Sheets as well. One more time, Thanks."}], "tags": [], "owner": {"reputation": 890, "user_id": 4537270, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ihOUv.jpg?s=128&g=1", "display_name": "XsiSec", "link": "https://stackoverflow.com/users/4537270/xsisec"}, "is_accepted": true, "score": 0, "last_activity_date": 1456330235, "creation_date": 1456330235, "answer_id": 35607199, "question_id": 35606111, "link": "https://stackoverflow.com/questions/35606111/let-the-user-to-give-star-rating/35607199#35607199", "title": "Let the user to give star rating", "body": "<p>I have made a little excel-file example that is attached.\nalso a little code .</p>\n\n<p>See code below:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n    If Target.Count &gt; 1 Then Exit Sub\n    If Not Intersect(Target, Range(\"H2:L8\")) Is Nothing Then\n        Range(\"H2:L8\").Rows(Target.Row - 1).Font.ColorIndex = xlAutomatic\n        Range(\"H2:H8\").Rows(Target.Row - 1).Resize(1, Target.Column - Range(\"H2\").Column + 1).Font.ColorIndex = 6\n    ElseIf Not Intersect(Range(\"G2:G8\"), Target) Is Nothing Then\n        ' No stars\n        Target.Offset(0, 1).Resize(1, 5).Font.ColorIndex = xlAutomatic\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>See  attached file<br> <a href=\"https://www.wetransfer.com/downloads/4ea9abbf2a8bf5719e363667d65d0a0a20160224161246/57c91b7ca1b85069813b1d439ae0e79920160224161246/b1c7a8\" rel=\"nofollow\">Here is my Excelfile</a></p>\n\n<p>Have a nice day</p>\n"}], "owner": {"reputation": 27, "user_id": 4798588, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5d9aa69464ad883c098d00e1ab8f349f?s=128&d=identicon&r=PG&f=1", "display_name": "Roshan", "link": "https://stackoverflow.com/users/4798588/roshan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 0, "accepted_answer_id": 35607199, "answer_count": 1, "score": 1, "last_activity_date": 1456330235, "creation_date": 1456327585, "last_edit_date": 1531161705, "question_id": 35606111, "link": "https://stackoverflow.com/questions/35606111/let-the-user-to-give-star-rating", "title": "Let the user to give star rating", "body": "<p>I wonder if anyone could help me with a <code>star rating</code> of a specific row in Excel not based on any give number or any information, just based on the user idea, some thing like most websites use to collect feedback from their clients. Then a user could give one to five stars to a written content in a row.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "is_accepted": false, "score": 0, "last_activity_date": 1456334197, "creation_date": 1456334197, "answer_id": 35608747, "question_id": 35606052, "link": "https://stackoverflow.com/questions/35606052/1004-error-when-trying-to-copy-and-send-destination-with-set-two-range-objects/35608747#35608747", "title": "1004 Error when trying to copy and send destination with Set two range objects", "body": "<p>Found a solution. Appears to have had incorrect syntax. </p>\n\n<p><strong>Changed</strong> \n<code>monthFutureVolumeFinder.Offset(0,4).Copy (statMonthLocation.Offset(1,0))</code> <strong>to</strong> </p>\n\n<p><code>monthFutureVolumeFinder.Offset(0,4).Copy Destination:=startMonthLocation.Offset(1,0)</code>  </p>\n\n<p><strong>Full code below:</strong></p>\n\n<pre><code>Sub GetOiData(cmeDataBook As Workbook, oiSheet As Worksheet)\n'Loops through OI data sheets and transfers OI data by puts and calls cleanly\n\n    Dim oiDataSheetInCmeBook As Worksheet\n    Dim startMonthLocation As Range, startRangePutStrike As Range, startRangeCallStrike As Range, monthFutureVolumeFinder As Range, monthCallLocationFinder As Range, monthPutLocationFinder As Range\n    Dim monthNameConverted As String, callOpt As String, putOpt As String, assetType As String\n    Dim continue As Boolean\n\n    callOpt = \" Calls\"\n    putOpt = \" Puts\"\n    assetType = oiSheet.Cells(1, 1).Value\n    continue = True\n    Set oiDataSheetInCmeBook = cmeDataBook.Sheets(GetDataSheetDesignation(assetType))\n\n    'Sets ranges for initial iteration through specific OI sheet\n    Set startMonthLocation = oiSheet.Cells(2, 2)\n    Set startRangePutStrike = oiSheet.Cells(5, 1)\n    Set startRangeCallStrike = oiSheet.Cells(5, 3)\n    dataSheet.Activate\n\n    'Iterates through entire Oi data sheet incrementally\n    Do While continue = True\n\n        'Finds total volume for the month and then sets monthConverted to prepare for oi process\n        monthNameConverted = MonthCode(oiSheet.Cells(2, 2).Value)\n        Set monthFutureVolumeFinder = oiDataSheetInCmeBook.Columns(1).Find(Trim(monthConverted))\n        monthFutureVolumeFinder.Offset(0, 4).Copy Destination:=startMonthLocation.Offset(1, 0)\n\n        Set monthPutLocationFinder = oiDataSheetInCmeBook.Columns(1).Find(Trim(monthConverted &amp; putOpt))\n\n    Loop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456334197, "creation_date": 1456327425, "question_id": 35606052, "link": "https://stackoverflow.com/questions/35606052/1004-error-when-trying-to-copy-and-send-destination-with-set-two-range-objects", "title": "1004 Error when trying to copy and send destination with Set two range objects", "body": "<p>Hi all  Receiving an '1004' copy method of range class failed when attempting to use the copy function and send to another set range.  Any ideas why this might be happening?  Code below (<strong>Note: I have not gotten to close the loop yet.  I was building the set up and ran into this error.  I didn't remove the loop because i'm simply debugging this issue</strong>): </p>\n\n<pre><code>Sub GetOiData(cmeDataBook As Workbook, oiSheet As Worksheet)\n'Loops through OI data sheets and transfers OI data by puts and calls cleanly\nDim dataSheet As Worksheet\nDim startMonthLocation As Range, startRangePutStrike As Range, startRangeCallStrike As Range, monthFutureVolumeFinder As Range\nDim monthConverted As String, callOpt As String, putOpt As String, assetType As String\nDim continue As Boolean\n\ncallOpt = \" Calls\"\nputOpt = \" Puts\"\nassetType = oiSheet.Cells(1, 1).Value\ncontinue = True\nSet dataSheet = cmeDataBook.Sheets(GetDataSheetDesignation(assetType))\nSet startMonthLocation = oiSheet.Cells(2, 2)\ndataSheet.Activate\n\n'Iterates through entire Oi data sheet incrementally\nDo While continue = True\n\n    'Finds total volume for the month and then sets monthConverted to prepare for oi process\n    monthConverted = MonthCode(oiSheet.Cells(2, 2).Value)\n    Set monthFutureVolumeFinder = dataSheet.Columns(1).Find(Trim(monthConverted))\n    monthFutureVolumeFinder.Offset(0, 4).Copy (startMonthLocation.Offset(1, 0))\n\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 1843, "user_id": 5793786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77c8c934fd9b5dcd38885b22e9bdeff7?s=128&d=identicon&r=PG", "display_name": "Maarten van Stam", "link": "https://stackoverflow.com/users/5793786/maarten-van-stam"}, "reply_to_user": {"reputation": 244, "user_id": 1698682, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w465n.gif?s=128&g=1", "display_name": "Bruno Costa", "link": "https://stackoverflow.com/users/1698682/bruno-costa"}, "edited": false, "score": 0, "creation_date": 1456329235, "post_id": 35606434, "comment_id": 58897813, "body": "Is your Content Control in a Table? I tested the code with the text you provided, inserted a CC at the placeholder and worked without issues. So there must be something in your text that prohibits expanding the Range."}, {"owner": {"reputation": 1843, "user_id": 5793786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77c8c934fd9b5dcd38885b22e9bdeff7?s=128&d=identicon&r=PG", "display_name": "Maarten van Stam", "link": "https://stackoverflow.com/users/5793786/maarten-van-stam"}, "reply_to_user": {"reputation": 244, "user_id": 1698682, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w465n.gif?s=128&g=1", "display_name": "Bruno Costa", "link": "https://stackoverflow.com/users/1698682/bruno-costa"}, "edited": false, "score": 0, "creation_date": 1456330926, "post_id": 35606434, "comment_id": 58899126, "body": "Changed it to work with a CC in a table ... can you try again?"}, {"owner": {"reputation": 244, "user_id": 1698682, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w465n.gif?s=128&g=1", "display_name": "Bruno Costa", "link": "https://stackoverflow.com/users/1698682/bruno-costa"}, "edited": false, "score": 0, "creation_date": 1456331336, "post_id": 35606434, "comment_id": 58899493, "body": "That approach deletes the whole text on the row. All the text that I showed on my question is inside the same row unfortantly (and I can&#39;t really do anything about that) . I would like to delete only the last line on the row."}, {"owner": {"reputation": 1843, "user_id": 5793786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77c8c934fd9b5dcd38885b22e9bdeff7?s=128&d=identicon&r=PG", "display_name": "Maarten van Stam", "link": "https://stackoverflow.com/users/5793786/maarten-van-stam"}, "reply_to_user": {"reputation": 244, "user_id": 1698682, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w465n.gif?s=128&g=1", "display_name": "Bruno Costa", "link": "https://stackoverflow.com/users/1698682/bruno-costa"}, "edited": false, "score": 0, "creation_date": 1456336839, "post_id": 35606434, "comment_id": 58903489, "body": "ooohhh ... well you need to be more precise on what your scenario is. This means putting in -all- information that is relevant to the question. I&#39;ve inserted two valid solutions already but you keep coming up with new information! I&#39;ll try and see if I can find time to get this one too."}, {"owner": {"reputation": 244, "user_id": 1698682, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w465n.gif?s=128&g=1", "display_name": "Bruno Costa", "link": "https://stackoverflow.com/users/1698682/bruno-costa"}, "edited": false, "score": 0, "creation_date": 1456337662, "post_id": 35606434, "comment_id": 58903971, "body": "I really appreciate your effort Marteen but it&#39;s not like I didn&#39;t give that information, after all I placed the text in the same block. SO shouldn&#39;t be the place where others solve the problems for you but I would gladly receive more input from you. Anyway maybe I can try to proceed from this, even if it takes much longer than you would."}, {"owner": {"reputation": 1843, "user_id": 5793786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77c8c934fd9b5dcd38885b22e9bdeff7?s=128&d=identicon&r=PG", "display_name": "Maarten van Stam", "link": "https://stackoverflow.com/users/5793786/maarten-van-stam"}, "reply_to_user": {"reputation": 244, "user_id": 1698682, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w465n.gif?s=128&g=1", "display_name": "Bruno Costa", "link": "https://stackoverflow.com/users/1698682/bruno-costa"}, "edited": false, "score": 0, "creation_date": 1456340328, "post_id": 35606434, "comment_id": 58905587, "body": "Aannnnd.... changed again, now to address deleting only the last line in the Table Cell where the Content Control was found. It&#39;s a bit of a pain, finding the exact movements but I think you can find it for your specific format if you experiment a bit with the selection based on my example."}], "tags": [], "owner": {"reputation": 1843, "user_id": 5793786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77c8c934fd9b5dcd38885b22e9bdeff7?s=128&d=identicon&r=PG", "display_name": "Maarten van Stam", "link": "https://stackoverflow.com/users/5793786/maarten-van-stam"}, "is_accepted": true, "score": 1, "last_activity_date": 1456340195, "last_edit_date": 1456340195, "creation_date": 1456328370, "answer_id": 35606434, "question_id": 35605776, "link": "https://stackoverflow.com/questions/35605776/removing-the-line-where-a-content-control-is/35606434#35606434", "title": "Removing the line where a content control is", "body": "<p>Here is a small example how to do this in a table. First get the Content Control, Exctend the selection to the previous line in the table cell and delete the selection.</p>\n\n<pre><code>Sub test()\n\n    Dim rng As Range\n\n    'Get your Content Control here based on your variable reference\n    Set rng = ActiveDocument.ContentControls(1).Range\n\n    rng.Select\n\n    'Move outside the Content Control\n    Selection.MoveRight wdCharacter\n    Selection.MoveRight wdCharacter\n\n    'Select Line Up\n    Selection.MoveUp Unit:=wdParagraph, Count:=1, Extend:=wdExtend\n\n    'Include the paragraph from previous line\n    Selection.MoveLeft Unit:=wdWord, Count:=1, Extend:=wdExtend\n\n    'And ... Delete the selected area\n    Selection.Delete\nEnd Sub\n</code></pre>\n\n<p>Hope it helps</p>\n"}], "owner": {"reputation": 244, "user_id": 1698682, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w465n.gif?s=128&g=1", "display_name": "Bruno Costa", "link": "https://stackoverflow.com/users/1698682/bruno-costa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1261, "favorite_count": 0, "accepted_answer_id": 35606434, "answer_count": 1, "score": -1, "last_activity_date": 1456340195, "creation_date": 1456326684, "last_edit_date": 1495541250, "question_id": 35605776, "link": "https://stackoverflow.com/questions/35605776/removing-the-line-where-a-content-control-is", "title": "Removing the line where a content control is", "body": "<p>I want to remove a line where my content control is.</p>\n\n<p>Currently the document has this following text:</p>\n\n<pre><code>t1\nt2\n\n\nStatus:     Draft\nValid from: 01.01.2012\nValid for:  All Emplyoees\n\nCreated by:     a\nReleased by:    &lt;content control goes here&gt;.\n</code></pre>\n\n<p>I have a variable <code>controlff</code> which is a reference to the control. No matter how I get a range from it I always ended up by deleting the full text.</p>\n\n<p>This other questions didn't quite help me:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/17450713/blank-line-after-deleting-contentcontrol-in-word\">Blank line after deleting contentControl in word</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/24112398/how-to-remove-the-entire-line-of-a-word-doc-using-vba\">How to remove the entire line of a word doc using vba</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/19165309/deleting-certain-lines-in-ms-word-2007\">deleting certain lines in ms word 2007</a></p>\n\n<p>How can I remove the Released by line?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>All the text that I showed before is inside of a single row on a table.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1456326231, "post_id": 35605573, "comment_id": 58895849, "body": "Is it reasonable in your workflow to <code>buttonName.Enabled = False</code> after the file is opened so the user does not click it again?"}, {"owner": {"reputation": 8892, "user_id": 567059, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7d7d39a98d3d247926786bb60208893b?s=128&d=identicon&r=PG", "display_name": "David Gard", "link": "https://stackoverflow.com/users/567059/david-gard"}, "reply_to_user": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1456328988, "post_id": 35605573, "comment_id": 58897597, "body": "I see where you are going, but what if the user closes the file and then wants to open it again later?"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1456329281, "post_id": 35605573, "comment_id": 58897855, "body": "Maybe not ideal, you could out a button &quot;I have closed the file&quot; the enables the button again. <code>buttonName.Enabled = True</code>  If you know that it will always be open in notepad.exe you could verify that notepad is not running before you enable it.  But then they couldn&#39;t use notepad for other things."}], "answers": [{"tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 0, "last_activity_date": 1456329565, "creation_date": 1456329565, "answer_id": 35606936, "question_id": 35605573, "link": "https://stackoverflow.com/questions/35605573/open-only-one-instance-of-a-text-file/35606936#35606936", "title": "Open only one instance of a text file", "body": "<p>If you need it.  Here is a function to see if notepad is running.</p>\n\n<p>Declare these up top.</p>\n\n<pre><code>Private Declare Function OpenProcess Lib \"kernel32\" ( _\n    ByVal dwDesiredAccess As Long, ByVal bInheritHandle As Long, ByVal dwProcessId As Long) As Long\nPrivate Declare Function CloseHandle Lib \"kernel32\" ( _\n    ByVal hObject As Long) As Long\nPrivate Declare Function EnumProcesses Lib \"PSAPI.DLL\" ( _\n    lpidProcess As Long, ByVal cb As Long, cbNeeded As Long) As Long\nPrivate Declare Function EnumProcessModules Lib \"PSAPI.DLL\" ( _\n    ByVal hProcess As Long, lphModule As Long, ByVal cb As Long, lpcbNeeded As Long) As Long\nPrivate Declare Function GetModuleBaseName Lib \"PSAPI.DLL\" Alias \"GetModuleBaseNameA\" ( _\n    ByVal hProcess As Long, ByVal hModule As Long, ByVal lpFileName As String, ByVal nSize As Long) As Long\nPrivate Const PROCESS_VM_READ = &amp;H10\nPrivate Const PROCESS_QUERY_INFORMATION = &amp;H400\n</code></pre>\n\n<p>Then send this the process name. <code>b = IsProcessRunning(\"notepad.exe\")</code></p>\n\n<pre><code>Private Function IsProcessRunning(ByVal sProcess As String) As Boolean\n'Check to see if a process is currently running\nConst MAX_PATH      As Long = 260\nDim lProcesses()    As Long\nDim lModules()      As Long\nDim N               As Long\nDim lRet            As Long\nDim hProcess        As Long\nDim sName           As String\n\nsProcess = UCase$(sProcess)\nReDim lProcesses(1023) As Long\n\nIf EnumProcesses(lProcesses(0), 1024 * 4, lRet) Then\n    For N = 0 To (lRet \\ 4) - 1\n        hProcess = OpenProcess(PROCESS_QUERY_INFORMATION Or PROCESS_VM_READ, 0, lProcesses(N))\n        If hProcess Then\n            ReDim lModules(1023)\n            If EnumProcessModules(hProcess, lModules(0), 1024 * 4, lRet) Then\n                sName = String$(MAX_PATH, vbNullChar)\n                GetModuleBaseName hProcess, lModules(0), sName, MAX_PATH\n                sName = Left$(sName, InStr(sName, vbNullChar) - 1)\n                If sProcess = UCase$(sName) Then\n                    IsProcessRunning = True\n                    Exit Function\n                End If\n            End If\n        End If\n        CloseHandle hProcess\n    Next N\nEnd If\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8892, "user_id": 567059, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7d7d39a98d3d247926786bb60208893b?s=128&d=identicon&r=PG", "display_name": "David Gard", "link": "https://stackoverflow.com/users/567059/david-gard"}, "edited": false, "score": 0, "creation_date": 1456390655, "post_id": 35608024, "comment_id": 58927202, "body": "Thanks for your answer, however I&#39;m using Access and it appears that the <code>CustomDocumentProperties</code> method is unfortunately not available.  There is a <code>Properties</code> method available, but it appears that I cannot use this.  I changed <code>Dim wb As Workbook</code> to <code>Dim DB As DAO.Database</code>, <code>ThisWorkbook</code> to <code>CurrentDb</code> and all references to <code>wb</code> to <code>DB</code>."}, {"owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "reply_to_user": {"reputation": 8892, "user_id": 567059, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7d7d39a98d3d247926786bb60208893b?s=128&d=identicon&r=PG", "display_name": "David Gard", "link": "https://stackoverflow.com/users/567059/david-gard"}, "edited": false, "score": 0, "creation_date": 1456392633, "post_id": 35608024, "comment_id": 58928529, "body": "Please see the updated code: you have to use the <code>.CreateProperty</code> method with <code>.Properties.Append</code>"}, {"owner": {"reputation": 8892, "user_id": 567059, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7d7d39a98d3d247926786bb60208893b?s=128&d=identicon&r=PG", "display_name": "David Gard", "link": "https://stackoverflow.com/users/567059/david-gard"}, "edited": false, "score": 0, "creation_date": 1456393787, "post_id": 35608024, "comment_id": 58929391, "body": "Thanks for the update.  The code now compiles fine, but when I run it I get an error on the line <code>db.Properties.Append oTxt</code> - <b>Object Required</b>."}, {"owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "reply_to_user": {"reputation": 8892, "user_id": 567059, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7d7d39a98d3d247926786bb60208893b?s=128&d=identicon&r=PG", "display_name": "David Gard", "link": "https://stackoverflow.com/users/567059/david-gard"}, "edited": false, "score": 0, "creation_date": 1456394512, "post_id": 35608024, "comment_id": 58929941, "body": "It&#39;s running my end - when I included brackets around the <code>oTxt</code> variable it did error with &#39;Object Required&#39;. Maybe try including brackets <code>.Append(oTxt)</code> to see if it solves the issue your end? Otherwise I don&#39;t know what to suggest."}, {"owner": {"reputation": 8892, "user_id": 567059, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7d7d39a98d3d247926786bb60208893b?s=128&d=identicon&r=PG", "display_name": "David Gard", "link": "https://stackoverflow.com/users/567059/david-gard"}, "edited": false, "score": 0, "creation_date": 1456421574, "post_id": 35608024, "comment_id": 58950215, "body": "Access is Bazaar - <code>Call db.Properties.Append(oTxt)</code> works, but <code>db.Properties.Append oTxt</code> does not!  Thank you, that does indeed do what it says on the tin.  The only thing I have to do now is bring the already open instance of notepad to the front when the user clicks the help button, but that&#39;s another question!  Thanks for the help."}], "tags": [], "owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "is_accepted": true, "score": 1, "last_activity_date": 1456392577, "last_edit_date": 1456392577, "creation_date": 1456332243, "answer_id": 35608024, "question_id": 35605573, "link": "https://stackoverflow.com/questions/35605573/open-only-one-instance-of-a-text-file/35608024#35608024", "title": "Open only one instance of a text file", "body": "<p>First check if a Shell ID has previously been assigned to the Workbooks <code>.CustomDocumentProperties</code> property. If it has, then we need to check if that Shell ID instance is still open. We can do that by using the Shell ID and passing it into the <code>WHERE</code> clause of a query against <code>Win32_Process</code>.</p>\n\n<p>If there is no Shell ID assigned to the property, we can go straight to opening the text file. Once we open the text file, we update the <code>.CustomDocumentProperties</code> Property with the new text file Shell ID.</p>\n\n<pre><code>Option Explicit\n\nSub OpenTextFile()\n\n    Dim filePath As String\n    Dim txtFile As Long\n    Dim txtOpenCount As Integer\n\n    Dim wb As Workbook\n    Dim wmiService As Object, winQry As Object\n\n    Set wb = ThisWorkbook\n\n    On Error Resume Next\n    txtFile = CLng(wb.CustomDocumentProperties(\"txtFileNum\"))\n\n    If Err.Number = 0 Then '' If CustomDocumentProperty returned _\n                              without an error then use this to close txt file.\n\n        Set wmiService = GetObject(\"winmgmts:\" _\n                                 &amp; \"{impersonationLevel=impersonate}!\\\\\" _\n                                 &amp; \".\\root\\cimv2\")\n        Set winQry = wmiService.ExecQuery _\n                     (\"SELECT * from Win32_Process WHERE ProcessID = \" &amp; txtFile)\n\n        txtOpenCount = winQry.Count\n\n    End If\n\n    On Error GoTo 0\n\n    If txtOpenCount = 0 Then '' If the txtFile is not found, then open.\n\n        filePath = \"F:\\test.txt\"\n\n        If txtFile &gt; 0 Then\n            wb.CustomDocumentProperties(\"txtFileNum\").Delete\n        End If\n\n        txtFile = Shell(\"C:\\WINDOWS\\notepad.exe \" &amp; filePath, vbNormalFocus)\n\n        '' Update CustomDocumentProperty with the new txtFile number.\n        wb.CustomDocumentProperties.Add Name:=\"txtFileNum\", _\n                                        Value:=txtFile, _\n                                        LinkToContent:=False, _\n                                        Type:=msoPropertyTypeString\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>If you are in Access, you can take advantage of the <code>.CreateProperty</code> method, and then the <code>.Properties.Append</code> method. You have to pass the property created from <code>.CreateProperty</code> into the <code>.Properties.Append</code> method. Updated code below.</p>\n\n<pre><code>Option Explicit\n\nSub OpenTextFile()\n\n    Dim filePath As String\n    Dim txtFile As Long, oTxt As Object\n    Dim txtOpenCount As Integer\n\n    Dim db As Database\n    Dim wmiService As Object, winQry As Object\n\n    Set db = CurrentDb\n\n    On Error Resume Next\n    txtFile = db.Properties(\"txtFileNum\").Value\n\n    If Err.Number = 0 Then '' If CustomDocumentProperty returned _\n                              without an error then use this to close txt file.\n\n        Set wmiService = GetObject(\"winmgmts:\" _\n                                 &amp; \"{impersonationLevel=impersonate}!\\\\\" _\n                                 &amp; \".\\root\\cimv2\")\n        Set winQry = wmiService.ExecQuery _\n                     (\"SELECT * from Win32_Process WHERE ProcessID = \" &amp; txtFile)\n\n        txtOpenCount = winQry.Count\n\n    End If\n\n    On Error GoTo 0\n\n    If txtOpenCount = 0 Then '' If the txtFile is not found, then open.\n\n        filePath = \"F:\\test.txt\"\n\n        If txtFile &gt; 0 Then\n            db.Properties.Delete \"txtFileNum\"\n        End If\n\n        txtFile = Shell(\"C:\\WINDOWS\\notepad.exe \" &amp; filePath, vbNormalFocus)\n\n        '' Update db Properties with the new txtFile number.\n        Set oTxt = db.CreateProperty(\"txtFileNum\", dbLong, txtFile, False)\n        db.Properties.Append oTxt\n\n\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 8892, "user_id": 567059, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7d7d39a98d3d247926786bb60208893b?s=128&d=identicon&r=PG", "display_name": "David Gard", "link": "https://stackoverflow.com/users/567059/david-gard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 35608024, "answer_count": 2, "score": 2, "last_activity_date": 1456392577, "creation_date": 1456325909, "question_id": 35605573, "link": "https://stackoverflow.com/questions/35605573/open-only-one-instance-of-a-text-file", "title": "Open only one instance of a text file", "body": "<p>In VBA, I have a function that opens a text file.  This allows me to place a button on a form and have it show a file when clicked.</p>\n\n<p>The function works fine, however the aforementioned button is clicked multiple times, it will open the same document over and over, rather than just the once.</p>\n\n<p>How can I make it so that a file is only opened once?</p>\n\n<pre><code>Sub OpenTextFile(ByVal filePath As String)\n\n    If Len(Dir(filePath)) = 0 Then Exit Sub ' Ensure that the file to open actaully exists\n\n    Dim txtFile As Variant\n    txtFile = Shell(\"C:\\WINDOWS\\notepad.exe \" &amp; filePath, 1)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql-server", "vba", "ms-access", "combobox"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1456331172, "post_id": 35605475, "comment_id": 58899351, "body": "That&#39;s interesting. When I have a combobox with more rows than Access will load immediately, and &quot;dropdown&quot; the box, then I get a suspended query with ASYNC_NETOWRK_IO (not empty but with the combobox SQL). But once I call <code>cmb.ListCount</code>, the query disappears. Accessing <code>cmb.ListCount</code> forces Access to load all rows, which closes the query."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1456341786, "post_id": 35605475, "comment_id": 58906414, "body": "You are doing many unnecessary things in that function. Can you try changing it to <code>If cmb.RowSource &lt;&gt; &quot;&quot; Then lngDummy = cmb.ListCount</code> (nothing else) and see if the problem persists?"}, {"owner": {"reputation": 1849, "user_id": 3242154, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3c368f3140571a8d9a652dcf4607d549?s=128&d=identicon&r=PG&f=1", "display_name": "Nicolas", "link": "https://stackoverflow.com/users/3242154/nicolas"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1456396384, "post_id": 35605475, "comment_id": 58931282, "body": "@Andre Changed the init function to your suggested <code>If cmb.RowSource &lt;&gt; &quot;&quot; Then lngDummy = cmb.ListCount</code> but this will cause a suspended query with data in it (so with the combobox SQL)."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1456398337, "post_id": 35605475, "comment_id": 58932642, "body": "That&#39;s odd. In my SQL Server 2008 R2 the query goes away after <code>.ListCount</code> has run (has loaded all rows)."}, {"owner": {"reputation": 1849, "user_id": 3242154, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3c368f3140571a8d9a652dcf4607d549?s=128&d=identicon&r=PG&f=1", "display_name": "Nicolas", "link": "https://stackoverflow.com/users/3242154/nicolas"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1456403469, "post_id": 35605475, "comment_id": 58936216, "body": "Weird, I&#39;m testing it on a SQL Server 2012 (Express) by the way."}], "owner": {"reputation": 1849, "user_id": 3242154, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3c368f3140571a8d9a652dcf4607d549?s=128&d=identicon&r=PG&f=1", "display_name": "Nicolas", "link": "https://stackoverflow.com/users/3242154/nicolas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 248, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1456325665, "creation_date": 1456325665, "question_id": 35605475, "link": "https://stackoverflow.com/questions/35605475/access-vba-looping-through-combobox-records-returns-an-empty-suspended-query", "title": "Access VBA - Looping through combobox records returns an empty (suspended) query in the SQL server", "body": "<p>A while ago I migraited the Access backend for a project to an SQL server while keeping an Access frontend. I attached the tables doing Append TableDefs in Access  with the SQL server tables (creating linked tables). This all works fine. </p>\n\n<p>This however had 1 problem, namely some queries (usually the bigger ones) getting the suspended state in the SQL server for very long. After some research I found out that the suspeneded state is getting removed if you loop through the recordset of the object which has the query. </p>\n\n<p>For this I created several Init (global) functions that move to the last record and then back to the first record and by doing so removing the suspended state. This seems to work great but doing this for comboboxes I am getting weird 'empty' suspended queries in the SQL server. If I am not mistaken 'empty' suspended queries won't do much harm (they wont keep the 'filled' queries on hold). Though in a live environment you will see very very much 'empty' queries in the activity monitor and making it very confusing. </p>\n\n<p>My public sub for stepping through the combobox it's recordset is as follow: </p>\n\n<pre><code>Public Sub InitComboBox(cmb As ComboBox)\n\n    If cmb.RowSource &lt;&gt; \"\" Then\n        ' Store initial value\n        Dim initialIndex\n        initialIndex = cmb.ListIndex\n\n\n        ' Goto last item\n        Dim lastRowIndex As Long\n        lastRowIndex = cmb.ListCount - 1\n\n        Dim lastComboRow\n        lastComboRow = cmb.ItemData(lastRowIndex)\n        ' Set value back to initial item\n        lastComboRow = cmb.ItemData(initialIndex)\n    End If\n\n    cmb.GridlineThemeColorIndex = 1\n\nEnd Sub\n</code></pre>\n\n<p>This function is called in the onload event of the form (it checks all the comboboxes on the form and loops through the recordsource of those comboboxes).</p>\n\n<p>After some debugging I figured out that the following statement in the sub is causing an 'empty' query on the SQL server:</p>\n\n<pre><code>lastRowIndex = cmb.ListCount - 1\n</code></pre>\n\n<p>The question is, why is this specific line causing an 'empty' query with suspended state on my SQL server? </p>\n\n<p>On my SQL server it looks like this by the way:\n<a href=\"https://i.stack.imgur.com/KZNMT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KZNMT.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/I9Lgu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/I9Lgu.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel", "ms-word", "automation"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5864429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d010c2ea7a4387d5906023a21039c6d5?s=128&d=identicon&r=PG&f=1", "display_name": "dinocore", "link": "https://stackoverflow.com/users/5864429/dinocore"}, "edited": false, "score": 1, "creation_date": 1456328992, "post_id": 35606101, "comment_id": 58897601, "body": "Thank you, this was everything I was looking for and more. Your post was incredibly informative."}, {"owner": {"reputation": 13, "user_id": 5864429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d010c2ea7a4387d5906023a21039c6d5?s=128&d=identicon&r=PG&f=1", "display_name": "dinocore", "link": "https://stackoverflow.com/users/5864429/dinocore"}, "edited": false, "score": 0, "creation_date": 1456344915, "post_id": 35606101, "comment_id": 58908247, "body": "Hello, I&#39;m sorry to bother again, but I finally got around to running the script and I&#39;m getting a run time error 424, Object Required on &quot; For Each r In rYes &quot; in the second script, towards the bottom."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 13, "user_id": 5864429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d010c2ea7a4387d5906023a21039c6d5?s=128&d=identicon&r=PG&f=1", "display_name": "dinocore", "link": "https://stackoverflow.com/users/5864429/dinocore"}, "edited": false, "score": 0, "creation_date": 1456346949, "post_id": 35606101, "comment_id": 58909423, "body": "Do: <code>for each r in rng</code>"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 0, "last_activity_date": 1456347337, "last_edit_date": 1495541621, "creation_date": 1456327559, "answer_id": 35606101, "question_id": 35605460, "link": "https://stackoverflow.com/questions/35605460/copy-text-formatting-in-a-excel-to-word-script/35606101#35606101", "title": "Copy text formatting in a excel to word script", "body": "<p>Yes, I think this should be possible but requires some structural changes to your code. You'll need to replicate the \"paste\" operation in Word, instead of (as you are currently doing) storing <em>only</em> the raw text in your <code>sData</code>, <code>tData</code>, <code>uData</code> variables.</p>\n\n<p>Let's also clean this up with an additional subroutine, since you're repeating the <code>For Each r</code> loop over a few different range objects.</p>\n\n<pre><code>Sub Updated_Excel_Data_to_Word()\n\n    Dim rYes As Range\n    Dim objWord As Object\n\n    ' Get a handle on Word Application\n    Set objWord = GetObject(, \"word.application\")\n\n    ' Assign the range\n    Set rYes = Range(\"B2:B34\")\n\n    ' Pass the range and Word object variables to the helper function\n    Call PasteValuesToWordBookmark(rYes, objWord, _\n                                   objWord.activeDocument.Bookmarks(\"One\"))\n\n    ' repeat as needed, just changing the range &amp; bookmarks\n    Set rYes = Range(\"F2\", Range(\"F\" &amp; Rows.Count).End(xlUp))\n\n    Call PasteValuesToWordBookmark(rYes, objWord, _\n                                   objWord.activeDocument.Bookmarks(\"Two\"))\n\n    Set rYes = Range(\"J2\", Range(\"J\" &amp; Rows.Count).End(xlUp))\n\n    Call PasteValuesToWordBookmark(rYes, objWord, _\n                                  objWord.activeDocument.Bookmarks(\"Three\"))\n\nEnd Sub\n\nSub PasteValuesToWordBookmark(rng as Range, wdApp as Object, _\n                              wdBookmark as Object)\n    Dim r as Range\n\n    For Each r In rng\n        If r = \"X\" Then\n            wdBookmark.Select\n            r.Offset(0, 1).Copy  'Copy the cell from Excel\n            'in my testing this automatically adds a carriage return, so \n            ' we don't need to explicitly append the Chr(13)/vbCR character\n            wdApp.CommandBars.ExecuteMSO \"PasteSourceFormatting\"\n        End If\n    Next r\n\nEnd Sub\n</code></pre>\n\n<p>Here is some example output which has preserved all of the text formatting (bold, underline, font color, etc.)</p>\n\n<p><a href=\"https://i.stack.imgur.com/7ZNbC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7ZNbC.png\" alt=\"enter image description here\"></a></p>\n\n<p>This should work across all Office applications (see <a href=\"https://stackoverflow.com/questions/24639298/how-to-copy-paste-text-box-from-ms-word-to-powerpoint-slide/24641559#24641559\">here</a> for a similar Q&amp;A regarding Excel->PowerPoint), and as mentioned:</p>\n\n<p>The <code>CommandBars.ExecuteMso</code> is not very well-documented compared to many other methods. The <code>Application.CommandBars</code> <a href=\"https://i.stack.imgur.com/7ZNbC.png\" rel=\"nofollow noreferrer\">property reference</a> doesn't even mention the <code>ExecuteMso</code> method, which I found some information about here: </p>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/office/ff862419(v=office.15).aspx\" rel=\"nofollow noreferrer\">http://msdn.microsoft.com/en-us/library/office/ff862419(v=office.15).aspx</a></p>\n\n<blockquote>\n  <p>This method is useful in cases where there is no object model for a particular command. Works on controls that are built-in buttons, toggleButtons and splitButtons. </p>\n</blockquote>\n\n<p>You'll need a list of <em>idMso</em> parameters to explore, which come as part of a rather large downloadable file, current for Office 2013 I believe:</p>\n\n<p><a href=\"http://www.microsoft.com/en-us/download/details.aspx?id=727\" rel=\"nofollow noreferrer\">http://www.microsoft.com/en-us/download/details.aspx?id=727</a></p>\n"}], "owner": {"reputation": 13, "user_id": 5864429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d010c2ea7a4387d5906023a21039c6d5?s=128&d=identicon&r=PG&f=1", "display_name": "dinocore", "link": "https://stackoverflow.com/users/5864429/dinocore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 35606101, "answer_count": 1, "score": 0, "last_activity_date": 1456347337, "creation_date": 1456325641, "last_edit_date": 1456333994, "question_id": 35605460, "link": "https://stackoverflow.com/questions/35605460/copy-text-formatting-in-a-excel-to-word-script", "title": "Copy text formatting in a excel to word script", "body": "<p>I have a functioning script, it copies targeted text from an Excel sheet to an open Word document, but I'm wondering if it's possible that it also copies the formatting on the text, meaning some of the text is <strong>Bold</strong> and underlined. Currently, it just copies the text over to word.</p>\n\n<pre><code>Sub Updated_Excel_Data_to_Word()\n    Dim rYes As Range, r As Range\n    Dim sData As String\n    Dim tData As String\n    Dim uData As String\n    Dim objWord As Object\n\n\n    Set rYes = Range(\"B2:B34\")\n\n\n    For Each r In rYes\n        If r = \"X\" Then\n\n            sData = sData &amp; r.Offset(0, 1) &amp; Chr(13)\n        End If\n    Next r\n\n\n     Set rYes = Range(\"F2\", Range(\"F\" &amp; Rows.Count).End(xlUp))\n\n\n    For Each r In rYes\n        If r = \"X\" Then\n\n            tData = tData &amp; r.Offset(0, 1) &amp; Chr(13)\n        End If\n    Next r\n\n\n\n     Set rYes = Range(\"J2\", Range(\"J\" &amp; Rows.Count).End(xlUp))\n\n\n    For Each r In rYes\n        If r = \"X\" Then\n\n            uData = uData &amp; r.Offset(0, 1) &amp; Chr(13)\n        End If\n    Next r\n\n\n\n\n\n    Set objWord = GetObject(, \"word.application\")\n\n    objWord.activeDocument.Bookmarks(\"One\").Select\n    objWord.Selection.TypeText (sData)\n    objWord.activeDocument.Bookmarks(\"Two\").Select\n    objWord.Selection.TypeText (tData)\n    objWord.activeDocument.Bookmarks(\"Three\").Select\n    objWord.Selection.TypeText (uData)\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1456326057, "post_id": 35605424, "comment_id": 58895698, "body": "The UNION-DELETE technique is a good way to speed this up.  <a href=\"http://stackoverflow.com/a/34564306/4288101\">stackoverflow.com/a/34564306/4288101</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1303, "user_id": 5254224, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-oOkdF0Z_r48/AAAAAAAAAAI/AAAAAAAAAK4/U1wsJOhA9rM/photo.jpg?sz=128", "display_name": "ahinkle", "link": "https://stackoverflow.com/users/5254224/ahinkle"}, "edited": false, "score": 0, "creation_date": 1456327463, "post_id": 35605584, "comment_id": 58896519, "body": "Worked perfectly. Thanks!"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 5, "last_activity_date": 1456325947, "creation_date": 1456325947, "answer_id": 35605584, "question_id": 35605424, "link": "https://stackoverflow.com/questions/35605424/slow-process-on-deleting-rows-how-to-make-faster/35605584#35605584", "title": "Slow process on deleting rows - How to make faster?", "body": "<p>Try only doing one delete operation on all the relevant rows at the end:</p>\n\n<pre><code>Sub DeleteRows()\n'--- Pause Calculations:\n    Application.Calculation = xlManual\n    '----- DELETE ROWS -----\n    Dim dtFrom                As Date\n    Dim dtUpto                As Date\n    Dim y                     As Long\n    Dim vCont                 As Variant\n    Dim rDelete As Range\n    dtFrom = Sheets(\"Control Panel\").Range(\"D5\").Value\n    dtUpto = dtFrom + 6\n    Sheet1.Range(\"D1\").Value2 = \"Scanning, Please wait...\"\n    With Sheets(\"Database\")\n        For y = Sheet5.Cells(Sheet5.Rows.Count, 2).End(xlUp).Row + 1 To 2 Step -1\n            vCont = .Cells(y, 1).Value\n            If Not IsError(vCont) Then\n                If vCont &gt;= dtFrom And vCont &lt;= dtUpto Then\n                    If rDelete Is Nothing Then\n                        Set rDelete = .Rows(y)\n                    Else\n                        Set rDelete = Union(rDelete, .Rows(y))\n                    End If\n                End If\n            End If\n        Next\n    End With\n    If Not rDelete Is Nothing Then rDelete.EntireRow.Delete\n    '--- Resume Calculations:\n    Application.Calculation = xlAutomatic\nEnd Sub\n</code></pre>\n\n<p>Note: You could also use an autofilter here.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1604289167, "last_edit_date": 1604289167, "creation_date": 1456329063, "answer_id": 35606697, "question_id": 35605424, "link": "https://stackoverflow.com/questions/35605424/slow-process-on-deleting-rows-how-to-make-faster/35606697#35606697", "title": "Slow process on deleting rows - How to make faster?", "body": "<p>Deleting a large number of individual rows is best done in a single operation. <a href=\"https://stackoverflow.com/users/3611989/rory\">Rory</a> has demonstrated the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff834621.aspx\" rel=\"nofollow noreferrer\">Union method</a> of creating a collection of discontiguous rows to be deleted with one <a href=\"https://msdn.microsoft.com/en-us/library/office/ff834641.aspx\" rel=\"nofollow noreferrer\">Range.Delete</a> operation.</p>\n<p>While the Union method much better than looping through individual rows looking for rows to delete, this still suffers from the CPU intensive operation of deleting (and shifting) many discontiguous rows of data. If the rows can be expediently shifted into a single block, the .Delete method will work much faster. A <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840646.aspx\" rel=\"nofollow noreferrer\">Range.Sort method</a> might seem like more work but it will be faster overall.</p>\n<pre><code>Option Explicit\n\nSub DeleteRows()\n    \n    Dim dtFrom As Date\n    Dim dtUpto As Date\n    Dim y As Long\n    Dim d As Long, vDTs As Variant\n    \n    'appTGGL bTGGL:=False  '&lt;~~ uncomment when finished debugging&gt;\n    \n    dtFrom = Sheets(&quot;Control Panel&quot;).Range(&quot;D5&quot;).Value2\n    dtUpto = dtFrom + 6\n    Sheet1.Range(&quot;D1&quot;) = &quot;Scanning, Please wait...&quot;\n    \n    'is this supposed to be Database or Sheet5? Are you mixing names and codenames?\n    With Worksheets(&quot;Database&quot;)\n        With .Cells(1, 1).CurrentRegion\n            With .Resize(.Rows.Count - 1, 1).Offset(1, 0)\n                vDTs = .Value2\n                For d = LBound(vDTs, 1) To UBound(vDTs, 1)\n                    vDTs(d, 1) = IIf(vDTs(d, 1) &gt;= dtFrom And vDTs(d, 1) &lt;= dtUpto, 1, 0)\n                Next d\n            End With\n            With .Resize(.Rows.Count - 1, 1).Offset(1, .Columns.Count)\n                .Cells = vDTs\n            End With\n        End With\n        \n        'reestablish the new currentregion\n        With .Cells(1, 1).CurrentRegion\n            .Cells.Sort key1:=.Columns(.Columns.Count), order1:=xlAscending, _\n                        Orientation:=xlTopToBottom, Header:=xlYes\n            d = Application.Match(1, .Columns(.Columns.Count), 0)\n            'one big block of rows to delete\n            .Cells(d, 1).Resize(.Rows.Count - d, 1).EntireRow.Delete\n            'done with the helper column\n            .Columns(.Columns.Count).EntireColumn.Delete\n        End With\n        \n    End With\n    \n    appTGGL\n\nEnd Sub\n\nSub appTGGL(Optional bTGGL As Boolean = True)\n    Application.Calculation = IIf(bTGGL, xlCalculationAutomatic, xlCalculationManual)\n    Application.EnableEvents = bTGGL\n    Application.DisplayAlerts = bTGGL\n    Application.ScreenUpdating = bTGGL\n    Application.Cursor = IIf(bTGGL, xlDefault, xlWait)\n    Debug.Print Timer\nEnd Sub\n</code></pre>\n<p>I magnified the problem by testing this on 50,000 rows (20\u00d7 the 2500 row sheet you are dealing with) and it took only a few seconds. The code looks, like it is doing a lot more work but it accomplishes the task in record time.</p>\n"}], "owner": {"reputation": 1303, "user_id": 5254224, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-oOkdF0Z_r48/AAAAAAAAAAI/AAAAAAAAAK4/U1wsJOhA9rM/photo.jpg?sz=128", "display_name": "ahinkle", "link": "https://stackoverflow.com/users/5254224/ahinkle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2279, "favorite_count": 1, "accepted_answer_id": 35605584, "answer_count": 2, "score": 3, "last_activity_date": 1604289167, "creation_date": 1456325550, "last_edit_date": 1531161705, "question_id": 35605424, "link": "https://stackoverflow.com/questions/35605424/slow-process-on-deleting-rows-how-to-make-faster", "title": "Slow process on deleting rows - How to make faster?", "body": "<p>I have a several macros within my workbook. This is the only one that seems to be really slow 3-5 minutes on a 2500 row sheet.</p>\n\n<p>The purpose is if Row is between date dtFrom and dtUpTo Then delete entire row.</p>\n\n<p>I added to pause and resume calculations and that boosted it slightly</p>\n\n<p>Anyone have any ideas on how to make this faster?</p>\n\n<pre><code>Sub DeleteRows\n    '--- Pause Calculations:\n    Application.Calculation = xlManual\n    '----- DELETE ROWS -----\n    Dim dtFrom As Date\n    Dim dtUpto As Date\n    Dim y As Long\n    Dim vCont As Variant\n    dtFrom = Sheets(\"Control Panel\").Range(\"D5\").Value\n    dtUpto = dtFrom + 6\n    Sheet1.Range(\"D1\").Value2 = \"Scanning, Please wait...\"\n    With Sheets(\"Database\")\n        For y = Sheet5.Cells(Sheet5.Rows.Count, 2).End(xlUp).Row + 1 To 2   Step -1\n            vCont = .Cells(y, 1).Value\n            If Not IsError(vCont) Then\n                If vCont &gt;= dtFrom And vCont &lt;= dtUpto Then\n                    .Rows(y).EntireRow.Delete\n                End If\n            End If\n        Next\n    End With\n    '--- Resume Calculations:\n    Application.Calculation = xlAutomatic\n   End Sub\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba", "module", "copy", "paste"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1456326707, "post_id": 35605420, "comment_id": 58895992, "body": "You don&#39;t write code to alter code, you write code that&#39;s parameterized. You could have &quot;N&quot; in some specific &quot;configuration&quot; cell (your colleague&#39;s would say &quot;J&quot;), and then the code can read the column from that specific cell and <i>generate</i> the address string."}], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 5872601, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/23955d8c70cd4416dcd85b50098ecb34?s=128&d=identicon&r=PG&f=1", "display_name": "DanteeChaos", "link": "https://stackoverflow.com/users/5872601/danteechaos"}, "edited": false, "score": 0, "creation_date": 1456746486, "post_id": 35606395, "comment_id": 59073932, "body": "Thanks for the idea. That&#39;s exactly what I need."}], "tags": [], "owner": {"reputation": 18, "user_id": 5968854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34d65c451e9ef08244aad5ffa6779066?s=128&d=identicon&r=PG", "display_name": "cuisquare", "link": "https://stackoverflow.com/users/5968854/cuisquare"}, "is_accepted": true, "score": 0, "last_activity_date": 1456328260, "creation_date": 1456328260, "answer_id": 35606395, "question_id": 35605420, "link": "https://stackoverflow.com/questions/35605420/can-i-make-vba-change-its-own-code-according-to-the-users-needs/35606395#35606395", "title": "Can i make VBA change it&#39;s own code according to the user&#39;s needs?", "body": "<p>You could consider allowing the user to have an input into the macro. This could take the form of an input box, or a specific part of the worksheet (or another worksheet dedicated to that purpose) that would be read into by the macro when launched (whereby a cell could contain the destination cell name, for instance). </p>\n\n<p>So the macro would be the same but it would work differently depending on the user.</p>\n"}], "owner": {"reputation": 141, "user_id": 5872601, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/23955d8c70cd4416dcd85b50098ecb34?s=128&d=identicon&r=PG&f=1", "display_name": "DanteeChaos", "link": "https://stackoverflow.com/users/5872601/danteechaos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "accepted_answer_id": 35606395, "answer_count": 1, "score": 0, "last_activity_date": 1456328260, "creation_date": 1456325542, "question_id": 35605420, "link": "https://stackoverflow.com/questions/35605420/can-i-make-vba-change-its-own-code-according-to-the-users-needs", "title": "Can i make VBA change it&#39;s own code according to the user&#39;s needs?", "body": "<p>I'm kinda a beginner when it comes to VBA and programming in general so pls try to keep your answers simple. Here is a part of my code:</p>\n\n<pre><code> Sub Makro2()\n\n Dim XXX As Workbook\n Dim YYY As Workbook\n Set XXX = Application.Workbooks.Open(\"C:\\aaa.xlsx\")\n Set YYY = Application.Workbooks.Open(\"C:\\bbb.xlsx\")\n n = XXX.Sheets(1).Range(\"A:A\").Cells.SpecialCells(xlCellTypeConstants).Count\n\nXXX.Sheets(1).Activate\nRange(\"A3:A\" &amp; n + 1).Select\nSelection.Copy\nYYY.Sheets(1).Activate\nRange(\"C3\").Select\nActiveCell.PasteSpecial Paste:=xlPasteValues\n\nXXX.Sheets(1).Activate\nRange(\"N3:N\" &amp; n + 1).Select\nSelection.Copy\nYYY.Sheets(1).Activate\nRange(\"H3\").Select\nActiveCell.PasteSpecial Paste:=xlPasteValues\n\nEnd Sub\n</code></pre>\n\n<p>Now this code works for me but my colleague needs Range(\"N3:N\" &amp; n + 1) copied to Range(\"J3\"), not \"H3\" like me. From what I understand modules are hard-coded so I don't know if this is at all possible. Can I write a piece of code that would alter a previous piece of code depending on what the user wants? If not, is there a way around it?</p>\n"}, {"tags": ["excel", "vba", "runtime"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1456325331, "post_id": 35605247, "comment_id": 58895138, "body": "Kinda hard to start debugging the situation without seeing a redacted portion of the CSV that reproduces the error but you should be opening CSV files with the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837097.aspx\" rel=\"nofollow noreferrer\">Workbooks.OpenText method</a>, not the <a href=\"https://msdn.microsoft.com/en-us/library/office/aa195811(v=office.11).aspx\" rel=\"nofollow noreferrer\">Workbooks.Open method</a>."}, {"owner": {"reputation": 11, "user_id": 5975031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03996c65cc9dbfe93021cf5f50486b93?s=128&d=identicon&r=PG&f=1", "display_name": "Slashh", "link": "https://stackoverflow.com/users/5975031/slashh"}, "edited": false, "score": 0, "creation_date": 1456327049, "post_id": 35605247, "comment_id": 58896218, "body": "Added .OpenText still have the same error.  Its not a portion of the CSV that causes an error. It opens the workbook like VBA tells it too but before going on it says Runtime 9 out of range. Im new at VBA, I always thought runtime 9 was when It cant find the file or create the object you ask it too."}, {"owner": {"reputation": 11, "user_id": 5975031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03996c65cc9dbfe93021cf5f50486b93?s=128&d=identicon&r=PG&f=1", "display_name": "Slashh", "link": "https://stackoverflow.com/users/5975031/slashh"}, "edited": false, "score": 0, "creation_date": 1456328448, "post_id": 35605247, "comment_id": 58897208, "body": "If I copy and paste the code into another workbook and run it I get an Object defined error instead of Runtime 9"}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1456330155, "post_id": 35605247, "comment_id": 75865413, "body": "You could use the method I describe here: <a href=\"http://jkp-ads.com/articles/importtext.asp\" rel=\"nofollow noreferrer\">jkp-ads.com/articles/importtext.asp</a> and then on the workbook containing the connection, just refresh that connection."}], "owner": {"reputation": 11, "user_id": 5975031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03996c65cc9dbfe93021cf5f50486b93?s=128&d=identicon&r=PG&f=1", "display_name": "Slashh", "link": "https://stackoverflow.com/users/5975031/slashh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1456330155, "creation_date": 1456325116, "last_edit_date": 1456325410, "question_id": 35605247, "link": "https://stackoverflow.com/questions/35605247/runtime-9-error-after-workbook-opens-csv-successfully", "title": "Runtime 9 error after workbook opens CSV successfully", "body": "<p>I have a VBA macro that opens IBM cognos to run a report and save it out as a CSV file. The macro then opens the file and copy pastes it into my excel workbook.</p>\n\n<p>On</p>\n\n<pre><code>Workbooks.Open Filename:= _\n        \"S:\\Supply Chain\\Scheduling\\NBVI\\buf.csv\"\n</code></pre>\n\n<p>I get Runtime Error 9: subscript out of range after the workbook opens.</p>\n\n<p>This same code works in other workbooks and I'm at a loss.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1456339274, "post_id": 35605171, "comment_id": 58904936, "body": "What&#39;s wrong with your current code?"}, {"owner": {"reputation": 35, "user_id": 4950429, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9456f0d7317ce919125ce81f54da47a7?s=128&d=identicon&r=PG&f=1", "display_name": "Haim Solomon", "link": "https://stackoverflow.com/users/4950429/haim-solomon"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1456339347, "post_id": 35605171, "comment_id": 58904977, "body": "Thanks I&#39;ll try this out. Although I have tried something similar with no luck but maybe I missed something without noticing. I was planing on entering this right before the loop under &quot;Due Amount&quot; so that Due amount would reflect &quot;Invoiced Amount&quot; and the formula would be copied to each inserted line. I&#39;ll let you know if it works"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 2300070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50bde8628fc57422efc0c3fe2cb7a8bf?s=128&d=identicon&r=PG", "display_name": "JamesL", "link": "https://stackoverflow.com/users/2300070/jamesl"}, "is_accepted": false, "score": 0, "last_activity_date": 1456335915, "creation_date": 1456335915, "answer_id": 35609339, "question_id": 35605171, "link": "https://stackoverflow.com/questions/35605171/populating-a-cell-with-the-values-of-another-cell/35609339#35609339", "title": "Populating a cell with the values of another cell", "body": "<p>Just use formula, if you want cell A1 to equal whatever is put into A2, then do this:</p>\n\n<pre><code>Range(\"A1\").Formula = \"=A2\"\n</code></pre>\n\n<p>Where exactly in the code do you want to define where one cell is supposed to equal another cell? I could help you with more specific code.</p>\n"}], "owner": {"reputation": 35, "user_id": 4950429, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9456f0d7317ce919125ce81f54da47a7?s=128&d=identicon&r=PG&f=1", "display_name": "Haim Solomon", "link": "https://stackoverflow.com/users/4950429/haim-solomon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1456335915, "creation_date": 1456324920, "question_id": 35605171, "link": "https://stackoverflow.com/questions/35605171/populating-a-cell-with-the-values-of-another-cell", "title": "Populating a cell with the values of another cell", "body": "<p>I am writing a VBA Script that generates a statement of account report. I have divided the report into sections: 1. The Header, 2. The First Job Entry, 3. Additional Job Entries and 4. The summation bar. Each section has its own hot key short cut. I have only worked on the layout aspect of the sections so far and now I am ready and attempting to write the calculation aspects which is where I am having some issues.</p>\n\n<p>I am new to VBA programming so my question is quite simple. I would like to have the value from one cell populate into another. I was able to get the script to do this already but it was for a string and the string was populated during the writing of the script itself. I would like to have the First Entry be written and <strong>then</strong> have the user go in type a <em>number</em> into one cell and then that same number populate into another cell. Essentially I would like for all formulas to be written and ready for the accounts receivable person to simply enter the numbers they need and make their decisions.</p>\n\n<p>Here is the code for the macro the short cut is Shift + ctrl + D. the first thing it does is ask where to place the portion (cell address) and then it asks how many entries (invoices) are needed. The Macro then prints out the entry format required and then loops a copy and paste below this entry for as many entries specified by the user. Here it is:</p>\n\n<pre><code>Sub STOACre()\nDim Start As Range\nSet Start = Application.InputBox(prompt:=\"What Cell Address would you like       to start your invoice entries at?\", Type:=8)\nDim Entries As Integer\nEntries = InputBox(prompt:=\"How Many Invoices are you entering for this   Project number?\")\n\n'This is the Entry portion of the page\n Application.Goto Start\nWith ActiveCell.Range(\"A1:G1, f3\").Font\n    .Name = \"Calibri\"\n    .bold = True\nEnd With\nActiveCell.FormulaR1C1 = \"Inv.no\"\nActiveCell.Offset(0, 1).Range(\"A1\").FormulaR1C1 = \"Job.no\"\nActiveCell.Offset(0, 2).Range(\"A1\").FormulaR1C1 = \"Due Date\"\nActiveCell.Offset(0, 4).Range(\"A1\").FormulaR1C1 = \"Aging(Days)\"\nActiveCell.Offset(0, 5).Range(\"A1\").FormulaR1C1 = \"Invoice Amount\"\nActiveCell.Offset(0, 6).Range(\"A1\").FormulaR1C1 = \"Due Amount\"\nWith ActiveCell.Range(\"A1:G1\").Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .ThemeColor = xlThemeColorAccent5\n        .TintAndShade = 0.799981688894314\n        .PatternTintAndShade = 0\nEnd With\nWith ActiveCell.Range(\"A1:G1\").Borders\n    .LineStyle = xlContinuous\n    .Weight = xlThin\nEnd With\nActiveCell.Range(\"A1:G1\").Font.bold = True\nFor i = 1 To Entries\n    Application.Goto Start\n    With ActiveCell.Offset(1, 0).Range(\"A1:G1\").Borders\n        .LineStyle = xlContinuous\n        .Weight = xlThin\n    End With\n   With ActiveCell.Offset(1, 0).Range(\"A1:G1\")\n        .Copy\n        .Insert Shift:=xlDown\n    End With\nNext i\nActiveCell.Offset(Entries + 1, 5).Range(\"A1\").FormulaR1C1 = \"Sub Total\"\n With ActiveCell.Offset(Entries + 1, 0).Range(\"A1:E1\")\n    .MergeCells = True\n    .FormulaR1C1 = \" \"\n    End With\n End Sub\n</code></pre>\n\n<p>Thank you and sorry to bother with such a simple question. I have seen similar ones posted but they did not seem to work for my situation. Any help and/or advice would be appreciated.   </p>\n"}, {"tags": ["vba", "excel", "comparison"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 4047843, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-7kbWNKlR7RE/AAAAAAAAAAI/AAAAAAAAAEE/-WPhZOzrtXI/photo.jpg?sz=128", "display_name": "Justin TriadTechx", "link": "https://stackoverflow.com/users/4047843/justin-triadtechx"}, "edited": false, "score": 0, "creation_date": 1456330945, "post_id": 35606840, "comment_id": 58899147, "body": "Thanks, works great! Guess I&#39;ve been staring at code way to long. I do have my lastRow and lastColumn functions. I am going to add in a line that just deletes the entire column."}, {"owner": {"reputation": 173, "user_id": 5968309, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-g0szoCYu_LQ/AAAAAAAAAAI/AAAAAAAAAEw/OpjmKaE-9XE/photo.jpg?sz=128", "display_name": "Dani El", "link": "https://stackoverflow.com/users/5968309/dani-el"}, "reply_to_user": {"reputation": 43, "user_id": 4047843, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-7kbWNKlR7RE/AAAAAAAAAAI/AAAAAAAAAEE/-WPhZOzrtXI/photo.jpg?sz=128", "display_name": "Justin TriadTechx", "link": "https://stackoverflow.com/users/4047843/justin-triadtechx"}, "edited": false, "score": 0, "creation_date": 1456383480, "post_id": 35606840, "comment_id": 58923282, "body": "Happens to me all the time. I guess deleting the column might work quicker with more data. Glad to be able to help."}], "tags": [], "owner": {"reputation": 173, "user_id": 5968309, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-g0szoCYu_LQ/AAAAAAAAAAI/AAAAAAAAAEw/OpjmKaE-9XE/photo.jpg?sz=128", "display_name": "Dani El", "link": "https://stackoverflow.com/users/5968309/dani-el"}, "is_accepted": true, "score": 0, "last_activity_date": 1456329358, "creation_date": 1456329358, "answer_id": 35606840, "question_id": 35605152, "link": "https://stackoverflow.com/questions/35605152/vba-compare-row-to-column/35606840#35606840", "title": "vba compare row to column", "body": "<p>Assuming you did write lastRow and lastColumn functions, the only error in your code is the data which gets the cell values</p>\n\n<pre><code> If Cells(i, 1) = Cells(1, j) Then\n    wksActRawData.Cells(i, 3).Value = wksActRawData.Cells(i, j).Value\n End If\n</code></pre>\n\n<p>Which should really be the other way around, plus I'd add a line to clear the old prices, as follows</p>\n\n<pre><code>  If Cells(i, 1) = Cells(1, j) Then\n    Cells(i, j).Value = Cells(i, 3).Value\n    Cells(i, 3).ClearContents\n  End If\n</code></pre>\n\n<p>It did work for me this way</p>\n"}], "owner": {"reputation": 43, "user_id": 4047843, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-7kbWNKlR7RE/AAAAAAAAAAI/AAAAAAAAAEE/-WPhZOzrtXI/photo.jpg?sz=128", "display_name": "Justin TriadTechx", "link": "https://stackoverflow.com/users/4047843/justin-triadtechx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 766, "favorite_count": 0, "accepted_answer_id": 35606840, "answer_count": 1, "score": 0, "last_activity_date": 1456329358, "creation_date": 1456324884, "question_id": 35605152, "link": "https://stackoverflow.com/questions/35605152/vba-compare-row-to-column", "title": "vba compare row to column", "body": "<p>I have a spreadsheet where column A information starts on row 6 and I have the unique values from this list as headers across the top in Row 1 starting at column D. What I want to do is if a cell in column A matches a header row, copy the information in the cell in column C to the corresponding Header.</p>\n\n<p><strong>ORIGINAL FORMAT</strong>\n<a href=\"https://i.stack.imgur.com/4BRm9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4BRm9.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>DESIRED FORMAT</strong>\n<a href=\"https://i.stack.imgur.com/mYPhr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mYPhr.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here is the code that I have tried but it is not giving me the desired results:</p>\n\n<pre><code>For i = 6 To lastRow\n    For j = 4 To lastColumn\n      If Cells(i, 1) = Cells(1, j) Then\n        wksActRawData.Cells(i, 3).Value = wksActRawData.Cells(i, j).Value\n      End If\n    Next j\n  Next i\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "edited": false, "score": 0, "creation_date": 1456324447, "post_id": 35604955, "comment_id": 58894436, "body": "If you can provide an example of what you have tried so far, we might be able to help you."}, {"owner": {"reputation": 23, "user_id": 5974889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaeb380594adf601d313efeac5393591?s=128&d=identicon&r=PG&f=1", "display_name": "ivdezine", "link": "https://stackoverflow.com/users/5974889/ivdezine"}, "reply_to_user": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "edited": false, "score": 0, "creation_date": 1456325001, "post_id": 35604955, "comment_id": 58894874, "body": "EDIT:  I found a similar post, which is very close to what I am trying to do but the major difference is that this post&#39;s sample data has valid data in every row whereas mine needs to look for only rows that contain all numbers and then look to see if there is a value in column B.  <a href=\"http://stackoverflow.com/questions/12962828/excel-transpose-some-rows-into-columns-depending-on-values-in-another-column\" title=\"excel transpose some rows into columns depending on values in another column\">stackoverflow.com/questions/12962828/&hellip;</a>"}, {"owner": {"reputation": 23, "user_id": 5974889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaeb380594adf601d313efeac5393591?s=128&d=identicon&r=PG&f=1", "display_name": "ivdezine", "link": "https://stackoverflow.com/users/5974889/ivdezine"}, "reply_to_user": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "edited": false, "score": 0, "creation_date": 1456325321, "post_id": 35604955, "comment_id": 58895127, "body": "@lturner - I started to do it manually via copy/paste special transpose, but quickly realized that with the amount of data this would take forever.  And, I&#39;m certain I&#39;ll have to do this again at a future time so wanted to ask here since I don&#39;t have much experience in writing VB or really advanced formulas."}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 5974889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaeb380594adf601d313efeac5393591?s=128&d=identicon&r=PG&f=1", "display_name": "ivdezine", "link": "https://stackoverflow.com/users/5974889/ivdezine"}, "is_accepted": false, "score": 0, "last_activity_date": 1456331250, "creation_date": 1456331250, "answer_id": 35607613, "question_id": 35604955, "link": "https://stackoverflow.com/questions/35604955/excel-vba-to-transpose-set-of-rows-if-value-exists-in-another-column/35607613#35607613", "title": "Excel VBA to transpose set of rows if value exists in another column", "body": "<p>UPDATE and Answer:<br>\nI modified my approach and went back to the original source data which was not part of a pivot table and was able to use a simple match formula between the 2 data sources.  So, my original data looked like this:</p>\n\n<pre><code>+----------------+---------+--------+--------------+\n|      Gtin      |  Brand  |  Name  | TaxonomyText |\n+----------------+---------+--------+--------------+\n| 00030085075605 | brand 1 | name 1 | cat1         |\n| 00041100015112 | brand 2 | name 2 | cat2         |\n| 00041100015099 | brand 3 | name 3 | cat3         |\n| 00030085075608 | brand 4 | name 4 | cat4         |\n+----------------+---------+--------+--------------+\n</code></pre>\n\n<p>I had another sheet containing the data I needed to match to in this format:</p>\n\n<pre><code>+----------------+---------+\n|      Gtin      |  Brand  |\n+----------------+---------+\n| 00030085075605 | brand 1 |\n| 00041100015112 | brand 2 |\n| 00041100015098 | brand 3 |\n| 00030085075608 | brand 4 |\n+----------------+---------+\n</code></pre>\n\n<p>I created a new column in my source sheet and used a if error match formula:</p>\n\n<p>=IFERROR(IF(MATCH(A14,data_to_match!$A:$A,0),\"yes\",),\"no\")</p>\n\n<p>Then copied this formula down for every row, about 75K rows which very quickly added a yes or a no.  </p>\n\n<pre><code>+----------------+---------+---------+--------+--------------+\n|      Gtin      | matched |  Brand  |  Name  | TaxonomyText |\n+----------------+---------+---------+--------+--------------+\n| 00030085075605 | yes     | brand 1 | name 1 | cat1         |\n| 00041100015112 | yes     | brand 2 | name 2 | cat2         |\n| 00041100015098 | no      | brand 3 | name 3 | cat3         |\n| 00030085075608 | yes     | brand 4 | name 4 | cat4         |\n+----------------+---------+---------+--------+--------------+\n</code></pre>\n\n<p>The final step was to just filter for Yes values and I had all the data that I needed.  </p>\n\n<p>My mistake was going to a pivot table first which put the data in a very funky format causing me to have to do a transpose, which wasn't really necessary.  Hopefully this can help others....</p>\n"}], "owner": {"reputation": 23, "user_id": 5974889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaeb380594adf601d313efeac5393591?s=128&d=identicon&r=PG&f=1", "display_name": "ivdezine", "link": "https://stackoverflow.com/users/5974889/ivdezine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 203, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1456331250, "creation_date": 1456324334, "question_id": 35604955, "link": "https://stackoverflow.com/questions/35604955/excel-vba-to-transpose-set-of-rows-if-value-exists-in-another-column", "title": "Excel VBA to transpose set of rows if value exists in another column", "body": "<p>I'm trying to find a way via VB script that will transpose rows from column A into a new sheet but only if there is a value in column B for rows that contain numbers.  I have a sheet with ~75K rows on it that I need to do this for, and I tried creating pivot tables which allowed me to get the data into its current format but I need the data to be in columns.</p>\n\n<p>The tricky part of this is that in column A, I only need to look at the rows that are all numbers and not the other rows that have text.  </p>\n\n<p>I created a sample sheet to view, where the sample data is in the SOURCE tab and what I want the data to look like in the TRANSPOSED tab.  </p>\n\n<p><a href=\"https://docs.google.com/spreadsheets/d/1ujbaouZFqiPw0DbO78PCnz25OY2ugF1HtUqMg_J7KeI/edit?usp=sharing\" rel=\"nofollow\">https://docs.google.com/spreadsheets/d/1ujbaouZFqiPw0DbO78PCnz25OY2ugF1HtUqMg_J7KeI/edit?usp=sharing</a></p>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1456337591, "post_id": 35604854, "comment_id": 58903931, "body": "<code>480 value in column D</code> what do you mean?"}, {"owner": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1456382820, "post_id": 35604854, "comment_id": 58922955, "body": "Hi, number 480 ( 8 hours in minutes )."}], "answers": [{"comments": [{"owner": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "edited": false, "score": 0, "creation_date": 1456383199, "post_id": 35617232, "comment_id": 58923152, "body": "Hi, Thank you for you answer.It works great (i really didn&#39;t find/think that &quot; if &quot; clause ) . How can i make this macro run from the master file? Now the macro must be run from the 35 files and i really want to run it from the master file - one click for all. Thank you."}, {"owner": {"reputation": 832, "user_id": 5137019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2b5d97d531f0c8180ad9543cb5efc530?s=128&d=identicon&r=PG&f=1", "display_name": "dev1998", "link": "https://stackoverflow.com/users/5137019/dev1998"}, "reply_to_user": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "edited": false, "score": 0, "creation_date": 1456409125, "post_id": 35617232, "comment_id": 58940347, "body": "Using the Dir command inside a loop is what I would do.  If the 35 files are all together in the same folder that would make it easier. The Dir command will return a string of the file name and it can be used to build the path for <code>Set s2Sheet = Workbooks.Open(path).Sheets(target)</code>"}], "tags": [], "owner": {"reputation": 832, "user_id": 5137019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2b5d97d531f0c8180ad9543cb5efc530?s=128&d=identicon&r=PG&f=1", "display_name": "dev1998", "link": "https://stackoverflow.com/users/5137019/dev1998"}, "is_accepted": false, "score": 0, "last_activity_date": 1456368106, "creation_date": 1456368106, "answer_id": 35617232, "question_id": 35604854, "link": "https://stackoverflow.com/questions/35604854/copy-from-another-workbooks-the-last-row-with-value-to-the-active-workbook/35617232#35617232", "title": "Copy from another workbooks the last row with value to the active workbook", "body": "<p>Try this.  I'm assuming the 480 is a number and not a string.  I added an If-Then to check if last row, column D is equal to 480.</p>\n\n<pre><code>Sub cop()\n\n    Dim lastS1Row As Long\n    Dim nextS2Row As Long\n    Dim lastCol As Long\n    Dim s1Sheet As Worksheet, s2Sheet As Worksheet\n    Dim source As String\n    Dim target As String\n    Dim path As String\n    Dim DestLast As Long\n\n    source = \"Sheet1\"\n    path = \"C:\\Users\\me\\Desktop\\2.xlsx\"\n    target = \"Sheet3\"\n    Application.EnableCancelKey = xlDisabled\n    Set s1Sheet = ThisWorkbook.Sheets(source)\n    Set s2Sheet = Workbooks.Open(path).Sheets(target)\n    lastS1Row = s1Sheet.Range(\"A\" &amp; Rows.Count).End(xlUp).row\n    nextS2Row = s2Sheet.Range(\"A\" &amp; Rows.Count).End(xlUp).row + 1\n    lastCol = s1Sheet.Cells(1, Columns.Count).End(xlToLeft).Column\n    If (s1Sheet.Cells(lastS1Row, 4).Value = 480) Then ' This is where you check the last row, column D.\n        For lCol = 1 To lastCol\n            s2Sheet.Cells(nextS2Row, lCol) = s1Sheet.Cells(lastS1Row, lCol)\n        Next lCol\n    End If\n\n    s2Sheet.Activate\n    ActiveWorkbook.Close SaveChanges:=True\n    s1Sheet.Activate\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1316, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456368786, "creation_date": 1456324080, "last_edit_date": 1456368786, "question_id": 35604854, "link": "https://stackoverflow.com/questions/35604854/copy-from-another-workbooks-the-last-row-with-value-to-the-active-workbook", "title": "Copy from another workbooks the last row with value to the active workbook", "body": "<p>I got 35 files and a master one. In the files , Sheet1, column D has the values 480 and 0. How can i copy the last row ( from all the 35 files ) that has 480 in column D in the master file Sheet3 ? Until now i have used the code for copy the last row but i can't make it to search the column D for value then copy. I really want to run the macro from the master not from the many files (now actually a made a macro to open all the files and run macro cop to copy the last rows but now i must copy only the last row that has 480 value in column D ).Thank you.</p>\n\n<p><pre>\nSub cop()</p>\n\n<code>    Dim lastS1Row As Long      \n    Dim nextS2Row As Long    \n    Dim lastCol As Long       \n    Dim s1Sheet As Worksheet, s2Sheet As Worksheet\n    Dim source As String      \n    Dim target As String      \n    Dim path As String\n    Dim DestLast As Long\n\n    source = \"Sheet1\"    \n    path = \"C:\\Users\\me\\Desktop\\2.xlsx\"  \n    target = \"Sheet3\" \n    Application.EnableCancelKey = xlDisabled    \n    Set s1Sheet = ThisWorkbook.Sheets(source)           \n    Set s2Sheet = Workbooks.Open(path).Sheets(target)  \n    lastS1Row = s1Sheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    nextS2Row = s2Sheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n    lastCol = s1Sheet.Cells(1, Columns.Count).End(xlToLeft).Column  \n    For lCol = 1 To lastCol\n        s2Sheet.Cells(nextS2Row, lCol) = s1Sheet.Cells(lastS1Row, lCol)\n    Next lCol\n\n    s2Sheet.Activate\n    ActiveWorkbook.Close SaveChanges:=True\n    s1Sheet.Activate\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "copy-paste"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1456324808, "post_id": 35604779, "comment_id": 58894728, "body": "If you&#39;re not trying to resize, you just need: <code>DestinationSheet.Paste DestinationSheet.Cells(17, 2)</code>"}, {"owner": {"reputation": 151, "user_id": 5928968, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/10154572512542519/picture?type=large", "display_name": "Yigit Tanverdi", "link": "https://stackoverflow.com/users/5928968/yigit-tanverdi"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1456325050, "post_id": 35604779, "comment_id": 58894918, "body": "i Need to resize it and why is 17,2 true? do they correspond to G30:J30?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1456325219, "post_id": 35604779, "comment_id": 58895041, "body": "It&#39;s the cell reference you had in your code. To resize use @Sobigen&#39;s answer below."}, {"owner": {"reputation": 151, "user_id": 5928968, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/10154572512542519/picture?type=large", "display_name": "Yigit Tanverdi", "link": "https://stackoverflow.com/users/5928968/yigit-tanverdi"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1456326873, "post_id": 35604779, "comment_id": 58896089, "body": "i deleted that &quot; with pastedPic&quot; part and put &quot;with pic&quot; part which @sobigen has written down. Should i use them both ?"}], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 5928968, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/10154572512542519/picture?type=large", "display_name": "Yigit Tanverdi", "link": "https://stackoverflow.com/users/5928968/yigit-tanverdi"}, "edited": false, "score": 0, "creation_date": 1456324788, "post_id": 35605003, "comment_id": 58894710, "body": "how do i add this code to mine ? i am a beginner at this thatswhy i dont know where i should put your code."}, {"owner": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "reply_to_user": {"reputation": 151, "user_id": 5928968, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/10154572512542519/picture?type=large", "display_name": "Yigit Tanverdi", "link": "https://stackoverflow.com/users/5928968/yigit-tanverdi"}, "edited": false, "score": 0, "creation_date": 1456327180, "post_id": 35605003, "comment_id": 58896322, "body": "You need to put in in your function or sub. Edit your <code>With</code> block for <code>pastedPic</code> to match mine.  You need to determine how you want to determine the range you want to fit the picture into.  If you copy my first two lines then it&#39;ll fit it into G30:J30.  One thing to note is if the code is in a worksheet module or a standalone module.  The <code>Me.range...</code> only works in a worksheet module"}, {"owner": {"reputation": 151, "user_id": 5928968, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/10154572512542519/picture?type=large", "display_name": "Yigit Tanverdi", "link": "https://stackoverflow.com/users/5928968/yigit-tanverdi"}, "edited": false, "score": 0, "creation_date": 1456328097, "post_id": 35605003, "comment_id": 58896981, "body": "yeah so i should put set r=Workbooks(anan).Range(&quot;G30:J30&quot;) ?"}, {"owner": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "reply_to_user": {"reputation": 151, "user_id": 5928968, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/10154572512542519/picture?type=large", "display_name": "Yigit Tanverdi", "link": "https://stackoverflow.com/users/5928968/yigit-tanverdi"}, "edited": false, "score": 0, "creation_date": 1456328708, "post_id": 35605003, "comment_id": 58897390, "body": "You might mean <code>Set r = ThisWorkbook.Worksheets(anan).Range(&quot;G30:J30&quot;)</code>  assuming <code>anan</code> is a string variable with a worksheet name.  Just to fix that issue early."}, {"owner": {"reputation": 151, "user_id": 5928968, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/10154572512542519/picture?type=large", "display_name": "Yigit Tanverdi", "link": "https://stackoverflow.com/users/5928968/yigit-tanverdi"}, "edited": false, "score": 0, "creation_date": 1456329206, "post_id": 35605003, "comment_id": 58897790, "body": "i did this but somehow this code takes another part and pastes in the range that i specified which is Range G30:J30. However the Picture is not the one that i wanted. I think i make a mistake when i wrote the code. Could you edit your answer and put your code in to mine ? I would appreciate a lot!"}, {"owner": {"reputation": 151, "user_id": 5928968, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/10154572512542519/picture?type=large", "display_name": "Yigit Tanverdi", "link": "https://stackoverflow.com/users/5928968/yigit-tanverdi"}, "edited": false, "score": 0, "creation_date": 1456387955, "post_id": 35605003, "comment_id": 58925582, "body": "It works! thanks a lot! i just needed to Change the shape index though because somehow it pasted someotherpicture which was already in that sheet where i paste my data. I have one last question. Normally Excel creates Picture names automatically like &quot;Picture 677&quot; etc. Can i do Operations now after this code to my Picture by coding pastedPic.Select since i assume the Name of it is now &quot;pastedPic&quot; ?"}, {"owner": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "reply_to_user": {"reputation": 151, "user_id": 5928968, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/10154572512542519/picture?type=large", "display_name": "Yigit Tanverdi", "link": "https://stackoverflow.com/users/5928968/yigit-tanverdi"}, "edited": false, "score": 0, "creation_date": 1456417749, "post_id": 35605003, "comment_id": 58947451, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/104555/discussion-between-sobigen-and-yigit-tanverdi\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "is_accepted": false, "score": 0, "last_activity_date": 1456329965, "last_edit_date": 1456329965, "creation_date": 1456324459, "answer_id": 35605003, "question_id": 35604779, "link": "https://stackoverflow.com/questions/35604779/pasting-a-picture-in-a-specified-range-with-vba/35605003#35605003", "title": "pasting a picture in a specified range with vba", "body": "<p>I tested this and it worked for me.  If you have a multicell range object you can get the width and height.  If you don't change the .LockAspectRatio = msoFalse your picture may adjust itself.  </p>\n\n<pre><code>Dim r As Range\nSet r = Me.Range(\"G30:J30\")\n\nWith pastedPic\n    .LockAspectRatio = msoFalse\n    .Top = r.Top\n    .Left = r.Left\n    .Width = r.Width\n    .Height = r.Height\nEnd With\n</code></pre>\n\n<p>I tried you code this is what I came up with.  For the copy picture line I actually copy a picture of the cells not a particular picture within those cells.  Is that what you expected?</p>\n\n<p>One other change was I used <code>ThisWorkbook</code> instead of your workbook index.  Adjust as necessary</p>\n\n<pre><code>Sub test()\n    Dim pastedPic As Shape\n    Dim DestinationSheet As Worksheet\n    Dim desitinationRange As Range\n    Set DestinationSheet = ThisWorkbook.Sheets(\"Eingabefeld\")\n\n    Sheets(\"Overview\").Range(\"A30:D37\").CopyPicture\n    DestinationSheet.Paste\n\n    Set pastedPic = DestinationSheet.Shapes(1)\n    Set desitinationRange = Me.Range(\"G30:J30\")\n\n    With pastedPic\n         .LockAspectRatio = msoFalse\n         .Top = desitinationRange.Top\n         .Left = desitinationRange.Left\n         .Width = desitinationRange.Width\n         .Height = desitinationRange.Height\n     End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 14562593, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/8ec4044946bc45080a095ca849b54cad?s=128&d=identicon&r=PG", "display_name": "Angelo E", "link": "https://stackoverflow.com/users/14562593/angelo-e"}, "is_accepted": false, "score": 1, "last_activity_date": 1604305410, "creation_date": 1604305410, "answer_id": 64642034, "question_id": 35604779, "link": "https://stackoverflow.com/questions/35604779/pasting-a-picture-in-a-specified-range-with-vba/64642034#64642034", "title": "pasting a picture in a specified range with vba", "body": "<p>this code is very close to what I want,\nI want to copy a range, as an image and insert it in a different sheet and size it to the outer boundries of a cell range.\nAll is well, apart from one ghlitch, when the routine runs the\n&quot;Set pastedPic = DestinationSheet.Shapes(1)&quot; it picks up the last selected and the one before that object, ending in sizing the inserted picture and the shape before last...\nthe way I manage to get some consistant results, was to change (1) to (2) the one before that, which apparently seens to be the copied entity...\ngo figure...</p>\n"}], "owner": {"reputation": 151, "user_id": 5928968, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/10154572512542519/picture?type=large", "display_name": "Yigit Tanverdi", "link": "https://stackoverflow.com/users/5928968/yigit-tanverdi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3539, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1604305410, "creation_date": 1456323877, "question_id": 35604779, "link": "https://stackoverflow.com/questions/35604779/pasting-a-picture-in-a-specified-range-with-vba", "title": "pasting a picture in a specified range with vba", "body": "<p>I have this following code. I want to paste this copied Picture to a range which i select in Destinationsheet. However i only know how to set the Location by selecting .top , .left , .width , .height . Is there a way to paste this Picture in a selected range such as G30:J:30 ?</p>\n\n<pre><code> Windows(osman).Activate\n\n   Sheets(\"Overview\").Range(\"A30:D37\").CopyPicture\n\n\n  Dim DestinationSheet As Worksheet\n  Set DestinationSheet = Workbooks(anan).Sheets(\"Eingabefeld\")\n\n   DestinationSheet.Paste\n\n  Dim pastedPic As Shape\n\n\n\n   Set pastedPic = DestinationSheet.Shapes(1)\n\n   With pastedPic\n    .Top = DestinationSheet.Cells(17, 2).Top\n    'Rest of positioning  code here\n\n End With\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops", "powerpoint", "simpledateformat"], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 5202393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10204977496980746/picture?type=large", "display_name": "heyjaynell", "link": "https://stackoverflow.com/users/5202393/heyjaynell"}, "edited": false, "score": 0, "creation_date": 1456780570, "post_id": 35607430, "comment_id": 59096401, "body": "Works, thanks ! I&#39;ll have to look into OLEFormat.. Any chance you know how to put a five second delay in? sleep wasn&#39;t working for me. Thanks again"}, {"owner": {"reputation": 47, "user_id": 5202393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10204977496980746/picture?type=large", "display_name": "heyjaynell", "link": "https://stackoverflow.com/users/5202393/heyjaynell"}, "edited": false, "score": 0, "creation_date": 1456780808, "post_id": 35607430, "comment_id": 59096553, "body": "I used the following as a timer.. .       <code>Start = Timer</code>         <code>While Timer &lt; Start + 5 </code>         <code>DoEvents</code>       <code>Wend</code>"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "reply_to_user": {"reputation": 47, "user_id": 5202393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10204977496980746/picture?type=large", "display_name": "heyjaynell", "link": "https://stackoverflow.com/users/5202393/heyjaynell"}, "edited": false, "score": 0, "creation_date": 1456931848, "post_id": 35607430, "comment_id": 59175587, "body": "Just to fill in a blank or two:  when you have an ActiveX control on a slide, the shape&#39;s OLEFormat.Object gives you access to the same properties you&#39;d get from the same shape on a Form. Unfortunately, Intellisense doesn&#39;t kick in to help, but you can rightclick the shape and choose Properties to see what properties are available and what they&#39;re called."}], "tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": true, "score": 0, "last_activity_date": 1456330830, "creation_date": 1456330830, "answer_id": 35607430, "question_id": 35604180, "link": "https://stackoverflow.com/questions/35604180/vba-how-can-i-repeat-code-on-every-slide-to-edit-the-first-text-box/35607430#35607430", "title": "VBA How can I repeat code on every slide to edit the FIRST text box?", "body": "<p>Try something like this instead:</p>\n\n<pre><code>Do\n For Each pptSlide3 In ActivePresentation.Slides\n\n 'Retrieves D-Day from corresponding text box\n\n  TextBox2.Font.Size = 36\n  thedate = pptSlide3.Shapes(\"TextBox2\").OLEFormat.Object.Text\n\n'Calculates the amount of time from today's date until D-day above\nSdate = DateDiff(\"d\", Now(), thedate)\n\n'Creates textbox with the value of how many days are left\npptSlide3.Shapes(\"TextBox1\").OLEFormat.Object.Text = Sdate &amp; \"  Days to go!\"\nTextBox1.Font.Size = 36\n\n'Want it to wait 5 seconds here\n   ' Goes to next slide\n\nWith SlideShowWindows(1).View\n    If pptSlide3.SlideIndex &lt; 4 Then\n    .GotoSlide (pptSlide3.SlideIndex + 1)\n    End If\n\n    If pptSlide3.SlideIndex = 4 Then\n    .GotoSlide (1)\n    End If\nEnd With\n\n  Next pptSlide3\n  Loop\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 5202393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10204977496980746/picture?type=large", "display_name": "heyjaynell", "link": "https://stackoverflow.com/users/5202393/heyjaynell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 35607430, "answer_count": 1, "score": 0, "last_activity_date": 1456330830, "creation_date": 1456322293, "question_id": 35604180, "link": "https://stackoverflow.com/questions/35604180/vba-how-can-i-repeat-code-on-every-slide-to-edit-the-first-text-box", "title": "VBA How can I repeat code on every slide to edit the FIRST text box?", "body": "<p>I am writing a VB code for Powerpoint. It retrieves a date from the SECOND Text box on the slide and calculates the amount of days until this date. Then the calculated amount of days is shown in the FIRST text box. I can not get the code to repeat for the second slide, although the textboxes are named the same thing as the first slide. </p>\n\n<pre><code>'Sets variables\nDim Sdate As Long\nDim thedate As Date\nDim txt As Date\nDim pptSlide3 As Slide\n\nDo\n For Each pptSlide3 In ActivePresentation.Slides\n\n   Set sld = ActivePresentation.SlideShowWindow.View.Slide\n\n 'Retrieves D-Day from corresponding text box\n\n\n  TextBox2.Font.Size = 36\n   thedate = TextBox2.Text\n\n'Calculates the amount of time from today's date until D-day above\nSdate = DateDiff(\"d\", Now(), thedate)\n\n'Creates textbox with the value of how many days are left\nTextBox1.Value = Sdate &amp; \"  Days to go!\"\nTextBox1.Font.Size = 36\n\n'Want it to wait 5 seconds here\n   ' Goes to next slide\n\nWith SlideShowWindows(1).View\n    If sld.SlideIndex &lt; 4 Then\n    .GotoSlide (sld.SlideIndex + 1)\n    End If\n\n    If sld.SlideIndex = 4 Then\n    .GotoSlide (1)\n    End If\nEnd With\n\n  Next pptSlide3\n  Loop\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Z5xG4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Z5xG4.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel", "loops", "macros"], "comments": [{"owner": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "edited": false, "score": 0, "creation_date": 1456323084, "post_id": 35604149, "comment_id": 58893395, "body": "Have changed those around but still am getting the same problems :/"}], "answers": [{"comments": [{"owner": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "edited": false, "score": 0, "creation_date": 1456324303, "post_id": 35604550, "comment_id": 58894325, "body": "It works!! thank you so much. Unrelated question, how have you learnt so much about VBA, I am very new to VBA but in the position where I will be using it alot in the future so am looking to do some learning in my spare time? thanks again for the help :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "edited": false, "score": 0, "creation_date": 1456324537, "post_id": 35604550, "comment_id": 58894515, "body": "If you want to examine real world examples, this site is one of the best. Looking through the [excel], [vba] or [excel-vba] forums, possibly sorted with the highest votes up top or searched for topics that are of interest is a great way to pick up tips and hone your skills. The better questions come with sample data that can be copied and pasted into a blank workbook and code that you can step through with [F8]."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 4, "last_activity_date": 1456323299, "creation_date": 1456323299, "answer_id": 35604550, "question_id": 35604149, "link": "https://stackoverflow.com/questions/35604149/vba-loop-not-returning-any-values-plus-failure-to-terminate/35604550#35604550", "title": "VBA Loop not returning any values, plus failure to terminate", "body": "<p>If you are <strong>pattern matching</strong> with wildcards, you need to use the <strong>Like</strong> operator. e.g. <code>If Cells(i, 2) Like \"Business://EXTRACTS/\" &amp; \"*\" Then</code></p>\n\n<p>The Do While loops inside the For Next loops were unnecessary. It is also not a good idea to 'manually' increment the increment counter in a For ... Next loop.</p>\n\n<p>The second loop was running forever because you were incrementing <strong>i</strong>, not <strong>j</strong>.</p>\n\n<p>A <a href=\"https://msdn.microsoft.com/en-us/library/office/gg278665.aspx\" rel=\"nofollow\">Select Case statement</a> would make a better fit for the multiple criteria in the second <strong>j</strong> loop.</p>\n\n<pre><code>Sub Possible_solution_one()\n    Dim i As Long, j As Long\n    Dim ws As Worksheet\n\n    Set ws = ActiveSheet\n\n    With ws\n        For i = 2 To .Cells(.Rows.Count, \"a\").End(xlUp).Row\n            If Not CBool(Len(Cells(i, \"a\").Value)) Then Exit For\n            If .Cells(i, 2) = \"Business://EXTRACTS/\" &amp; \"*\" Then\n                .Cells(i, 8) = \"OBS(\" &amp; .Cells(i, 2).Value &amp; \",SHARE,#DI) OR \"\n            End If\n        Next i\n\n        For j = 2 To .Cells(ws.Rows.Count, \"a\").End(xlUp).Row\n            Select Case .Cells(j, 6).Value\n                Case \"Business*\"\n                    .Cells(j, 9) = \"OBS(\" &amp; Cells(j, 4).Value &amp; \",SHARE,DI) OR \"\n                Case \"CSTM\"\n                    .Cells(j, 10) = \"PUM(\" &amp; Cells(j, 4).Value &amp; \",#D7) OR \"\n                Case \"*FS\"\n                    .Cells(j, 11) = \"FCON(\" &amp; Cells(j, 4).Value &amp; \") OR \"\n                End If\n            End Select\n        Next j\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>I've also incorporated a <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow\">With ... End With statement</a> to associate all of the cells to the parent <strong>ws</strong> worksheet. Note hte <code>.Cells</code> and not <code>Cells</code>. The prefixing period assigns parentage to the worksheet referenced in the With ... End With.</p>\n\n<p>With no sample data, I could not completely test this rewrite but it does compile.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1456324668, "post_id": 35604611, "comment_id": 58894610, "body": "Good catch but I didn&#39;t find that the nested Do While .. Loop inside the For ... Next to be necessary at all."}, {"owner": {"reputation": 183, "user_id": 5678552, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jnxw7OpW0jU/AAAAAAAAAAI/AAAAAAAAABU/0V81DiP0m7Y/photo.jpg?sz=128", "display_name": "Clyde", "link": "https://stackoverflow.com/users/5678552/clyde"}, "edited": false, "score": 0, "creation_date": 1456328910, "post_id": 35604611, "comment_id": 58897541, "body": "totally agree - your answer was much more comprehensive"}], "tags": [], "owner": {"reputation": 183, "user_id": 5678552, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jnxw7OpW0jU/AAAAAAAAAAI/AAAAAAAAABU/0V81DiP0m7Y/photo.jpg?sz=128", "display_name": "Clyde", "link": "https://stackoverflow.com/users/5678552/clyde"}, "is_accepted": false, "score": 3, "last_activity_date": 1456323482, "creation_date": 1456323482, "answer_id": 35604611, "question_id": 35604149, "link": "https://stackoverflow.com/questions/35604149/vba-loop-not-returning-any-values-plus-failure-to-terminate/35604611#35604611", "title": "VBA Loop not returning any values, plus failure to terminate", "body": "<p>your second do while loop uses i=i+1 instead of j = j + 1  so it's not going to increment the cells(j, 6).value if there's anything in cells(j,6) then the loop won't stop running</p>\n\n<pre><code>For j = 2 To ws.Cells(ws.Rows.Count, \"a\").End(xlUp).Row\nDo While Cells(j, 6).Value &lt;&gt; \"\"\n    If Cells(j, 6) = \"Business\" &amp; \"*\" Then\n        Cells(j, 9) = \"OBS(\" &amp; Cells(j, 4).Value &amp; \",SHARE,DI) OR \"\n\n    ElseIf Cells(j, 6) = \"CSTM\" Then\n        Cells(j, 10) = \"PUM(\" &amp; Cells(j, 4).Value &amp; \",#D7) OR \"\n\n    ElseIf Cells(j, 6) = \"*FS\" Then\n        Cells(j, 11) = \"FCON(\" &amp; Cells(j, 4).Value &amp; \") OR \"\n\n    End If\n    'i = i + 1\n    j = j + 1\nLoop\nNext\n</code></pre>\n"}], "owner": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 1, "accepted_answer_id": 35604550, "answer_count": 2, "score": 0, "last_activity_date": 1456323482, "creation_date": 1456322193, "question_id": 35604149, "link": "https://stackoverflow.com/questions/35604149/vba-loop-not-returning-any-values-plus-failure-to-terminate", "title": "VBA Loop not returning any values, plus failure to terminate", "body": "<p>I have written a bit of code that is intended to search cells in a column, see if they start with a certain string and then return a value based on that string in another column. I have two problems, firstly the loops don't actually return any values in columns 8,9,10 or 11. Also the second loop doesn't stop running? Here is my code</p>\n\n<pre><code>Sub Possible_solution_one()\n\nDim i As Integer\nDim j As Integer\nDim ws As Worksheet\n\nSet ws = ActiveSheet\n\nFor i = 2 To ws.Cells(ws.Rows.Count, \"a\").End(xlUp).Row\n    Do While Cells(i, 1).Value &lt;&gt; \"\"\n\n        If Cells(i, 2) = \"Business://EXTRACTS/\" &amp; \"*\" Then\n            Cells(i, 8) = \"OBS(\" &amp; Cells(i, 2).Value &amp; \",SHARE,#DI) OR \"\n        End If\n\n        i = i + 1\n    Loop\nNext\n\n\nFor j = 2 To ws.Cells(ws.Rows.Count, \"a\").End(xlUp).Row\n    Do While Cells(j, 6).Value &lt;&gt; \"\"\n        If Cells(j, 6) = \"Business\" &amp; \"*\" Then\n            Cells(j, 9) = \"OBS(\" &amp; Cells(j, 4).Value &amp; \",SHARE,DI) OR \"\n\n        ElseIf Cells(j, 6) = \"CSTM\" Then\n            Cells(j, 10) = \"PUM(\" &amp; Cells(j, 4).Value &amp; \",#D7) OR \"\n\n        ElseIf Cells(j, 6) = \"*FS\" Then\n            Cells(j, 11) = \"FCON(\" &amp; Cells(j, 4).Value &amp; \") OR \"\n\n        End If\n        i = i + 1\n    Loop\nNext\n\nEnd Sub\n</code></pre>\n\n<p>To give the situation I have 1 type of string in column B and 3 types in column F. Am looking to return different things in columns 8,9,10,11 based on b and D</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1456322511, "post_id": 35604139, "comment_id": 58892948, "body": "If you&#39;re trying to find a macro use Search option on this website or use google. If you&#39;ve tried anything share that."}, {"owner": {"reputation": 183, "user_id": 5678552, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jnxw7OpW0jU/AAAAAAAAAAI/AAAAAAAAABU/0V81DiP0m7Y/photo.jpg?sz=128", "display_name": "Clyde", "link": "https://stackoverflow.com/users/5678552/clyde"}, "edited": false, "score": 0, "creation_date": 1456323906, "post_id": 35604139, "comment_id": 58893993, "body": "have you tried replacing hour(now) with now - timevalue(&quot;06:00:00&quot;)"}], "answers": [{"tags": [], "owner": {"reputation": 1190, "user_id": 1902181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1158bb9a54b2a8a9b02cb91a253ee5a6?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/1902181/seb"}, "is_accepted": true, "score": 0, "last_activity_date": 1456325145, "creation_date": 1456325145, "answer_id": 35605261, "question_id": 35604139, "link": "https://stackoverflow.com/questions/35604139/loop-cells-to-check-hours-passed/35605261#35605261", "title": "Loop Cells to check hours passed", "body": "<p>The datetime values in Excel are stored as decimal.  All you have to do is compare the difference between your cell's value and <code>Now</code> is greater than <code>6.0/24</code></p>\n\n<pre><code>For Each rCell In rRng.Cells\n    If Now - rCell.Value &gt; (6.0/24) Then\n          MsgBox rCell.Address, rCell.Value\n    ElseIf rCell = \"\" Then Exit Sub\n    Else\n......\n</code></pre>\n"}], "owner": {"reputation": 213, "user_id": 3340949, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/75d15e0121983ed7b1e305e593d4a156?s=128&d=identicon&r=PG&f=1", "display_name": "Noob2Java", "link": "https://stackoverflow.com/users/3340949/noob2java"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 35605261, "answer_count": 1, "score": 0, "last_activity_date": 1456325145, "creation_date": 1456322164, "last_edit_date": 1456323717, "question_id": 35604139, "link": "https://stackoverflow.com/questions/35604139/loop-cells-to-check-hours-passed", "title": "Loop Cells to check hours passed", "body": "<p>I am trying to find a macro that will loop through a column to check the hours compared to the current time.  The date/time is entered into the cell via a button on a form and is formatted mm/dd/yyyy hh:mm:ss and what I want to do is run a macro once every hour to find which cells in the column are older than 6 hours and needs to work even if it goes into the next day. I tried one small piece of code that I found but the results were incorrect. </p>\n\n<pre><code>For Each rCell In rRng.Cells\nIf rCell &lt; Hour(Now) - 6 Then\nMsgBox rCell.Address, rCell.Value\nElseIf rCell = \"\" Then Exit Sub\nElse\n</code></pre>\n"}, {"tags": ["vba", "excel", "directory", "mkdir"], "comments": [{"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 2, "creation_date": 1456322049, "post_id": 35604048, "comment_id": 58892602, "body": "Just a tip: Use <code>Debug.Print (DerpName &amp; YrFind.Value &amp; &quot;\\&quot; &amp; LngName)</code> to check if the directory address is right or not. There can be leading or ending spaces in the String."}, {"owner": {"reputation": 51, "user_id": 4440292, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/64bebb56a7bc03674398142190728d74?s=128&d=identicon&r=PG&f=1", "display_name": "DtheHut", "link": "https://stackoverflow.com/users/4440292/dthehut"}, "reply_to_user": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1456499957, "post_id": 35604048, "comment_id": 58991180, "body": "That is solid advice.  However, I&#39;m returning the correct filepath, unless--as suggested by MS--it&#39;s not formatted correctly.  It&#39;s currently returning &quot;\\\\jupiter\\productionschedule\\2 production schedules\\2016\\2-Feb-2016&quot; when I use Debug.Print.  This is exactly as it should be unless I need a drive letter or something (but the drive letters are contingent upon the individual user)."}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 4440292, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/64bebb56a7bc03674398142190728d74?s=128&d=identicon&r=PG&f=1", "display_name": "DtheHut", "link": "https://stackoverflow.com/users/4440292/dthehut"}, "is_accepted": true, "score": 0, "last_activity_date": 1456841395, "last_edit_date": 1456841395, "creation_date": 1456840963, "answer_id": 35725001, "question_id": 35604048, "link": "https://stackoverflow.com/questions/35604048/finding-a-directory-creating-it-when-it-doesnt-exist/35725001#35725001", "title": "Finding a directory, creating it when it doesn&#39;t exist", "body": "<p>For any of you that encounter this issue, I figured it out with a bit of subject-based google searching.  MkDir doesn't like UNC filepaths very much.  As such, no matter what I tried with formatting and concatenation wouldn't work.  In order to do the same job with a UNC-pathed network location, you need a separate API function.  I found a great article on it here:</p>\n\n<p><a href=\"http://www.devhut.net/2011/09/15/vba-create-directory-structurecreate-multiple-directories/\" rel=\"nofollow\">http://www.devhut.net/2011/09/15/vba-create-directory-structurecreate-multiple-directories/</a></p>\n\n<p>Just place the API in a separate module and call it with your UNC filepath in your macro.  The API:</p>\n\n<pre><code>Public Sub MakeFullDir(strPath As String)\n    If Right(strPath, 1) &lt;&gt; \"\\\" Then strPath = strPath &amp; \"\\\" 'Optional depending upon intent\n    MakeSureDirectoryPathExists strPath\nEnd Sub\n</code></pre>\n\n<p>The macro example:</p>\n\n<pre><code>Sub Example()\nDim filepath As String\n\nfilepath = \"\\\\Server\\Directory\\SubDirectory\\FolderYouWantToCreate\"\n\nCall MakeFullDir(filepath)\n\nEnd Sub\n</code></pre>\n\n<p>The API actually replaces the Boolean and the MkDir as it performs both functions.  </p>\n\n<p>Hope this helps someone!</p>\n"}], "owner": {"reputation": 51, "user_id": 4440292, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/64bebb56a7bc03674398142190728d74?s=128&d=identicon&r=PG&f=1", "display_name": "DtheHut", "link": "https://stackoverflow.com/users/4440292/dthehut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 35725001, "answer_count": 1, "score": 0, "last_activity_date": 1456841395, "creation_date": 1456321879, "last_edit_date": 1456499802, "question_id": 35604048, "link": "https://stackoverflow.com/questions/35604048/finding-a-directory-creating-it-when-it-doesnt-exist", "title": "Finding a directory, creating it when it doesn&#39;t exist", "body": "<p>I'm trying to create a macro in excel that deletes all the information in the work area and creates a new file (one for a new week's worth of information).  The task seems pretty straightforward to me but for some reason my directory discovery and creation portion of the code is returning the \"something is wrong\" msgbox I've added to indicate that none of the conditions are met.  I've checked the spelling and location of the directories in the statement and everything seems to be correct.  I just need a fresh set of eyes because I'm sure I'm missing something obvious at this point.</p>\n\n<pre><code>Sub DerpDate()\n'--------------------------------------------------------------------------------------------------\n'Subroutine that creates necessary directories, places new workbook in those directories and clears\n'out old data before terminating\n'--------------------------------------------------------------------------------------------------\n\n'--------------------------------------------------------------------------------------------------\n'                                           Declarations\n'--------------------------------------------------------------------------------------------------\nDim NxtWk As Range, YrFind As Range, MonFind As Range, MonName As Range, _\nLngName As String, DerpName As String, DelProd As Range, DelMold As Range, ProdSheet As Sheets, _\nMoldSheet As Sheets, WindSheets As Sheets\n\n    Set NxtWk = Sheets(\"Data\").Range(\"B53\")\n    Set YrFind = Sheets(\"Data\").Range(\"C53\")\n    Set MonFind = Sheets(\"Data\").Range(\"D53\")\n    Set MonName = Sheets(\"Data\").Range(\"E53\")\n    LngName = MonFind.Value &amp; \"-\" &amp; MonName.Value &amp; \"-\" &amp; YrFind.Value\n    DerpName = \"\\\\Jupiter\\Production\\2 Production Schedules\\\"\n\n        'Production Ranges\n\n        Set DelProd = Application.Union( _\n        Sheets(\"Production Schedule\").Range(\"H5:AB9\"), Sheets(\"Production Schedule\").Range(\"H15:AB23\"), _\n        Sheets(\"Production Schedule\").Range(\"H29:AB30\"), Sheets(\"Production Schedule\").Range(\"H36:AB39\"), _\n        Sheets(\"Production Schedule\").Range(\"H45:AB54\"), Sheets(\"Production Schedule\").Range(\"H60:AB62\"), _\n        Sheets(\"Production Schedule\").Range(\"H68:AB73\"), Sheets(\"Production Schedule\").Range(\"H79:AB84\"), _\n        Sheets(\"Production Schedule\").Range(\"H90:AB94\"), Sheets(\"Production Schedule\").Range(\"H100:AB101\"), _\n        Sheets(\"Production Schedule\").Range(\"H107:AB112\"), Sheets(\"Production Schedule\").Range(\"H118:AB119\"), _\n        Sheets(\"Production Schedule\").Range(\"H125:AB126\"), Sheets(\"Production Schedule\").Range(\"H132:AB133\"), _\n        Sheets(\"Production Schedule\").Range(\"H139:AB140\"), Sheets(\"Production Schedule\").Range(\"H146:AB147\"), _\n        Sheets(\"Production Schedule\").Range(\"H153:AB156\"), Sheets(\"Production Schedule\").Range(\"H162:AB166\"), _\n        Sheets(\"Production Schedule\").Range(\"H172:AB175\"), Sheets(\"Production Schedule\").Range(\"H181:AB185\"), _\n        Sheets(\"Production Schedule\").Range(\"H186:AB186\"), Sheets(\"Production Schedule\").Range(\"H192:AB193\"))\n\n        'Molding Ranges\n\n        Set DelMold = Application.Union( _\n        Sheets(\"Molders\").Range(\"B5:W8\"), Sheets(\"Molders\").Range(\"B14:W20\"), _\n        Sheets(\"Molders\").Range(\"B26:W31\"), Sheets(\"Molders\").Range(\"B37:W38\"), Sheets(\"Molders\").Range(\"B44:W45\"), _\n        Sheets(\"Molders\").Range(\"B51:W54\"), Sheets(\"Molders\").Range(\"B60:W63\"), Sheets(\"Molders\").Range(\"B69:W72\"), _\n        Sheets(\"Molders\").Range(\"C78:W93\"))\n\n        'Winding Ranges\n\n        Set DelWind = Application.Union( _\n        Sheets(\"Winders\").Range(\"H5:AB6\"), Sheets(\"Winders\").Range(\"H8:AB9\"), Sheets(\"Winders\").Range(\"H11:AB12\"), _\n        Sheets(\"Winders\").Range(\"H14:AB15\"), Sheets(\"Winders\").Range(\"H17:AB18\"), Sheets(\"Winders\").Range(\"H20:AB21\"), _\n        Sheets(\"Winders\").Range(\"H23:AB24\"), Sheets(\"Winders\").Range(\"H26:AB27\"), Sheets(\"Winders\").Range(\"H29:AB30\"), _\n        Sheets(\"Winders\").Range(\"H32:AB33\"), Sheets(\"Winders\").Range(\"H35:AB36\"), Sheets(\"Winders\").Range(\"H38:AB39\"), _\n        Sheets(\"Winders\").Range(\"H41:AB42\"), Sheets(\"Winders\").Range(\"H44:AB45\"), Sheets(\"Winders\").Range(\"H47:AB48\"), _\n        Sheets(\"Winders\").Range(\"H50:AB51\"), Sheets(\"Winders\").Range(\"H53:AB54\"))\n\n'--------------------------------------------------------------------------------------------------\n'Booleans to determine what (if any) directories need to be created before a new workbook can be\n'created\n'--------------------------------------------------------------------------------------------------\n\n    'See if the Year AND Month folder exist yet--save the new spreadsheet\n    If Dir(DerpName &amp; YrFind.Value &amp; \"\\\" &amp; LngName) &lt;&gt; \"\" Then\n    ActiveWorkbook.SaveAs Filename:=DerpName &amp; YrFind.Value &amp; \"\\\" &amp; LngName &amp; \"\\\" &amp; NxtWk.Value &amp; \".xlsm\"\n\n    'If the Year AND Month Folder don't exist, see if just the Year folder does--create Month folder\n    'and save the new spreadsheet in it\n    ElseIf Dir(DerpName &amp; YrFind.Value) &lt;&gt; \"\" Then\n    MkDir (DerpName &amp; YrFind.Value &amp; \"\\\" &amp; LngName)\n    ActiveWorkbook.SaveAs Filename:=DerpName &amp; YrFind.Value &amp; \"\\\" &amp; LngName &amp; \"\\\" &amp; NxtWk.Value &amp; \".xlsm\"\n\n    'If the Year and Month Folder don't exist, create Year and Month folder and save the\n    'new spreadsheet in it\n    ElseIf Dir(DerpName) &lt;&gt; \"\" Then\n    MkDir (DerpName &amp; YrFind.Value)\n    MkDir (DerpName &amp; YrFind &amp; \"\\\" &amp; LngName)\n    ActiveWorkbook.SaveAs Filename:=DerpName &amp; YrFind.Value &amp; \"\\\" &amp; LngName &amp; \"\\\" &amp; NxtWk.Value &amp; \".xlsm\"\n\n    Else\n\n    MsgBox (\"Something is wrong with the file location operation in the DerpDate Subroutine\")\n\n    End If\n\n'--------------------------------------------------------------------------------------------------\n'Portion of the sub that removes old data from the new workbook\n'--------------------------------------------------------------------------------------------------\n\n    DelProd.ClearContents\n\n    DelMold.ClearContents\n\n    DelWind.ClearContents\n\nEnd Sub\n</code></pre>\n\n<p>Thanks for any help you can offer!</p>\n\n<p>EDIT: I've changed things around a bit and have gotten past my original issue.  With the changes shown, I'm returning a Path/File access error (75).</p>\n\n<pre><code>Dim NxtWk As Range, YrFind As Range, MonFind As Range, MonName As Range, _\nLngName As String, DerpName As String, DelProd As Range, DelMold As Range, ProdSheet As Sheets, _\nMoldSheet As Sheets, WindSheets As Sheets, MonDig As Range, DayDig As Range, FName As String\n\n    Set NxtWk = Sheets(\"Data\").Range(\"B53\")\n    Set YrFind = Sheets(\"Data\").Range(\"C53\")\n    Set MonFind = Sheets(\"Data\").Range(\"D53\")\n    Set MonName = Sheets(\"Data\").Range(\"E53\")\n    LngName = MonFind.Value &amp; \"-\" &amp; MonName.Value &amp; \"-\" &amp; YrFind.Value\n    DerpName = \"\\\\Jupiter\\ProductionSchedule\\\" &amp; \"2 Production Schedules\"\n    'DerpName = \"C:\\user\\dwallace\\desktop\"\n    Set MonDig = Sheets(\"Data\").Range(\"B59\")\n    Set DayDig = Sheets(\"Data\").Range(\"C59\")\n    FName = MonDig.Value &amp; \"-\" &amp; DayDig.Value &amp; \"-\" &amp; YrFind.Value\n    YrFold = YrFind.Value\n\n        'Production Ranges\n\n        Set DelProd = Application.Union( _\n        Sheets(\"Production Schedule\").Range(\"H5:AB9\"), Sheets(\"Production Schedule\").Range(\"H15:AB23\"), _\n        Sheets(\"Production Schedule\").Range(\"H29:AB30\"), Sheets(\"Production Schedule\").Range(\"H36:AB39\"), _\n        Sheets(\"Production Schedule\").Range(\"H45:AB54\"), Sheets(\"Production Schedule\").Range(\"H60:AB62\"), _\n        Sheets(\"Production Schedule\").Range(\"H68:AB73\"), Sheets(\"Production Schedule\").Range(\"H79:AB84\"), _\n        Sheets(\"Production Schedule\").Range(\"H90:AB94\"), Sheets(\"Production Schedule\").Range(\"H100:AB101\"), _\n        Sheets(\"Production Schedule\").Range(\"H107:AB112\"), Sheets(\"Production Schedule\").Range(\"H118:AB119\"), _\n        Sheets(\"Production Schedule\").Range(\"H125:AB126\"), Sheets(\"Production Schedule\").Range(\"H132:AB133\"), _\n        Sheets(\"Production Schedule\").Range(\"H139:AB140\"), Sheets(\"Production Schedule\").Range(\"H146:AB147\"), _\n        Sheets(\"Production Schedule\").Range(\"H153:AB156\"), Sheets(\"Production Schedule\").Range(\"H162:AB166\"), _\n        Sheets(\"Production Schedule\").Range(\"H172:AB175\"), Sheets(\"Production Schedule\").Range(\"H181:AB185\"), _\n        Sheets(\"Production Schedule\").Range(\"H186:AB186\"), Sheets(\"Production Schedule\").Range(\"H192:AB193\"))\n\n        'Molding Ranges\n\n        Set DelMold = Application.Union( _\n        Sheets(\"Molders\").Range(\"B5:W8\"), Sheets(\"Molders\").Range(\"B14:W20\"), _\n        Sheets(\"Molders\").Range(\"B26:W31\"), Sheets(\"Molders\").Range(\"B37:W38\"), Sheets(\"Molders\").Range(\"B44:W45\"), _\n        Sheets(\"Molders\").Range(\"B51:W54\"), Sheets(\"Molders\").Range(\"B60:W63\"), Sheets(\"Molders\").Range(\"B69:W72\"), _\n        Sheets(\"Molders\").Range(\"C78:W93\"))\n\n        'Winding Ranges\n\n        Set DelWind = Application.Union( _\n        Sheets(\"Winders\").Range(\"H5:AB6\"), Sheets(\"Winders\").Range(\"H8:AB9\"), Sheets(\"Winders\").Range(\"H11:AB12\"), _\n        Sheets(\"Winders\").Range(\"H14:AB15\"), Sheets(\"Winders\").Range(\"H17:AB18\"), Sheets(\"Winders\").Range(\"H20:AB21\"), _\n        Sheets(\"Winders\").Range(\"H23:AB24\"), Sheets(\"Winders\").Range(\"H26:AB27\"), Sheets(\"Winders\").Range(\"H29:AB30\"), _\n        Sheets(\"Winders\").Range(\"H32:AB33\"), Sheets(\"Winders\").Range(\"H35:AB36\"), Sheets(\"Winders\").Range(\"H38:AB39\"), _\n        Sheets(\"Winders\").Range(\"H41:AB42\"), Sheets(\"Winders\").Range(\"H44:AB45\"), Sheets(\"Winders\").Range(\"H47:AB48\"), _\n        Sheets(\"Winders\").Range(\"H50:AB51\"), Sheets(\"Winders\").Range(\"H53:AB54\"))\n\n'--------------------------------------------------------------------------------------------------\n'Booleans to determine what (if any) directories need to be created before a new workbook can be\n'created\n'--------------------------------------------------------------------------------------------------\n\n    ActiveWorkbook.Save\n\n    'See if a year directory exists.  If it doesn't, create it, then create the month directory, then\n    'save the file.\n    If Len(Dir(DerpName &amp; \"\\\" &amp; YrFold)) = 0 Then\n    MkDir (DerpName &amp; \"\\\" &amp; YrFold)\n    MkDir (DerpName &amp; \"\\\" &amp; YrFold &amp; \"\\\" &amp; LngName)\n    ActiveWorkbook.SaveAs Filename:=DerpName &amp; \"\\\" &amp; YrFold &amp; \"\\\" &amp; LngName &amp; \"\\\" &amp; FName &amp; \".xlsm\"\n\n    'Assuming the Year directory exists, see if the third one (Month) exists. If it doesnt, create it and\n    'save the file\n    ElseIf Len(Dir(DerpName &amp; \"\\\" &amp; YrFind &amp; \"\\\" &amp; LngName)) = 0 Then\n    MkDir DerpName &amp; \"\\\" &amp; YrFold &amp; \"\\\" &amp; LngName\n    ActiveWorkbook.SaveAs Filename:=DerpName &amp; \"\\\" &amp; YrFold &amp; \"\\\" &amp; LngName &amp; \"\\\" &amp; FName &amp; \".xlsm\"\n\n    'Assuming all necessary directories already exist, save the file\n    Else\n    ActiveWorkbook.SaveAs Filename:=DerpName &amp; \"\\\" &amp; YrFold &amp; \"\\\" &amp; LngName &amp; \"\\\" &amp; FName &amp; \".xlsm\"\n\n    End If\n\n'--------------------------------------------------------------------------------------------------\n'Portion of the sub that removes old data from the new workbook\n'--------------------------------------------------------------------------------------------------\n\n    DelProd.ClearContents\n\n    DelMold.ClearContents\n\n    DelWind.ClearContents\n\nEnd Sub\n</code></pre>\n\n<p>The only thing I can think is that this is being caused by the fact that I'm trying to change a shared network directory and there is a user setting I'm not seeing.</p>\n"}, {"tags": ["arrays", "string", "vba", "loops"], "answers": [{"comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 1362, "user_id": 2764955, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/JXFqO.jpg?s=128&g=1", "display_name": "LCFactorization", "link": "https://stackoverflow.com/users/2764955/lcfactorization"}, "edited": false, "score": 0, "creation_date": 1456319112, "post_id": 35602841, "comment_id": 58890513, "body": "No problem, glad to help."}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 3, "last_activity_date": 1456318591, "creation_date": 1456318591, "answer_id": 35602841, "question_id": 35602770, "link": "https://stackoverflow.com/questions/35602770/how-to-create-such-an-array-by-using-do-loop-instead-of-typing-all-the-number-st/35602841#35602841", "title": "How to create such an array by using do loop instead of typing all the number strings?", "body": "<pre><code>dim I as integer\nredim two(100)\nfor I = 1 to 100\n   two(I)=format(cstr(I),\"00\")\nnext I\n</code></pre>\n"}], "owner": {"reputation": 1362, "user_id": 2764955, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/JXFqO.jpg?s=128&g=1", "display_name": "LCFactorization", "link": "https://stackoverflow.com/users/2764955/lcfactorization"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 35602841, "answer_count": 1, "score": 1, "last_activity_date": 1456318591, "creation_date": 1456318380, "question_id": 35602770, "link": "https://stackoverflow.com/questions/35602770/how-to-create-such-an-array-by-using-do-loop-instead-of-typing-all-the-number-st", "title": "How to create such an array by using do loop instead of typing all the number strings?", "body": "<p>The VBA code I am using to obtain the targetted array is :</p>\n\n<pre><code>Dim two(100) As String\ntwo(1) = \"01\"\ntwo(2) = \"02\"\ntwo(3) = \"03\"\ntwo(4) = \"04\"\ntwo(5) = \"05\"\ntwo(6) = \"06\"\ntwo(7) = \"07\"\ntwo(8) = \"08\"\ntwo(9) = \"09\"\ntwo(10) = \"10\"\ntwo(11) = \"11\"\ntwo(12) = \"12\"\ntwo(13) = \"13\"\ntwo(14) = \"14\"\ntwo(15) = \"15\"\ntwo(16) = \"16\"\ntwo(17) = \"17\"\ntwo(18) = \"18\"\ntwo(19) = \"19\"\ntwo(20) = \"20\"\ntwo(21) = \"21\"\ntwo(22) = \"22\"\ntwo(23) = \"23\"\ntwo(24) = \"24\"\ntwo(25) = \"25\"\ntwo(26) = \"26\"\ntwo(27) = \"27\"\ntwo(28) = \"28\"\ntwo(29) = \"29\"\ntwo(30) = \"30\"\ntwo(31) = \"31\"\ntwo(32) = \"32\"\ntwo(33) = \"33\"\ntwo(34) = \"34\"\ntwo(35) = \"35\"\ntwo(36) = \"36\"\ntwo(37) = \"37\"\ntwo(38) = \"38\"\ntwo(39) = \"39\"\ntwo(40) = \"40\"\ntwo(41) = \"41\"\ntwo(42) = \"42\"\ntwo(43) = \"43\"\ntwo(44) = \"44\"\ntwo(45) = \"45\"\ntwo(46) = \"46\"\ntwo(47) = \"47\"\ntwo(48) = \"48\"\ntwo(49) = \"49\"\ntwo(50) = \"50\"\ntwo(51) = \"51\"\ntwo(52) = \"52\"\ntwo(53) = \"53\"\ntwo(54) = \"54\"\ntwo(55) = \"55\"\ntwo(56) = \"56\"\ntwo(57) = \"57\"\ntwo(58) = \"58\"\ntwo(59) = \"59\"\ntwo(60) = \"60\"\ntwo(61) = \"61\"\ntwo(62) = \"62\"\ntwo(63) = \"63\"\ntwo(64) = \"64\"\ntwo(65) = \"65\"\ntwo(66) = \"66\"\ntwo(67) = \"67\"\ntwo(68) = \"68\"\ntwo(69) = \"69\"\ntwo(70) = \"70\"\ntwo(71) = \"71\"\ntwo(72) = \"72\"\ntwo(73) = \"73\"\ntwo(74) = \"74\"\ntwo(75) = \"75\"\ntwo(76) = \"76\"\ntwo(77) = \"77\"\ntwo(78) = \"78\"\ntwo(79) = \"79\"\ntwo(80) = \"80\"\ntwo(81) = \"81\"\ntwo(82) = \"82\"\ntwo(83) = \"83\"\ntwo(84) = \"84\"\ntwo(85) = \"85\"\ntwo(86) = \"86\"\ntwo(87) = \"87\"\ntwo(88) = \"88\"\ntwo(89) = \"89\"\ntwo(90) = \"90\"\ntwo(91) = \"91\"\ntwo(92) = \"92\"\ntwo(93) = \"93\"\ntwo(94) = \"94\"\ntwo(95) = \"95\"\ntwo(96) = \"96\"\ntwo(97) = \"97\"\ntwo(98) = \"98\"\ntwo(99) = \"98\"\ntwo(100) = \"100\"\n</code></pre>\n\n<p>I also tried:</p>\n\n<pre><code>Dim two() As String\ntwo = Split(\"00,01,02,03,04,05,06,07,08,09,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,\", \",\")\n</code></pre>\n\n<p>Both the two programming style require a lot of character typing (though the use of spreadsheet may loose the burden). </p>\n\n<p>How can I create such an array inside a loop?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 633, "user_id": 5560651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0d6e7d6b999194513ce84305296a655?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5560651/jonathan"}, "is_accepted": false, "score": 0, "last_activity_date": 1456374387, "creation_date": 1456374387, "answer_id": 35618328, "question_id": 35602591, "link": "https://stackoverflow.com/questions/35602591/calculate-with-time/35618328#35618328", "title": "Calculate with time", "body": "<p>I've updated your code a bit and included some notes to explain why. I've added the 2 formulas that convert your total time into minutes and calculate the differences for the &lt; &amp; > requirements. Hope this helps.</p>\n\n<pre><code>Sub LogTime()\n\nRange(\"12:12\").Insert\nRange(\"C7\").Copy\n'Pastes just the format from C7\nRange(\"C12:I12\").PasteSpecial (xlPasteFormats)\n'Set as Today's Date\nRange(\"C12\").Value = Date\n'Arrival\nRange(\"D12\").Value = Range(\"C7\").Value\nRange(\"D12\").NumberFormat = \"[$-F400]h:mm:ss AM/PM\"\n'Departure\nRange(\"E12\").Value = Range(\"C9\").Value\nRange(\"E12\").NumberFormat = \"[$-F400]h:mm:ss AM/PM\"\n'Calculate Total with Formula\nRange(\"F12\").Value = \"=\" &amp; Range(\"E12\").Address(0, 0) &amp; \"-\" &amp; Range(\"D12\").Address(0, 0)\nRange(\"C12:I12\").Font.Size = 12\n'Convert Time To Minues: (HOUR(F12)*60)+MINUTE(F12)+ROUND((SECOND(F12)/60),0)\n'&lt; Formula: In Minutes; if Total Time is =&gt; 3:30 return 210 and Total Time if &lt; 3:30 return Total Time\nRange(\"G12\").Value = \"=IF(((HOUR(F12)*60)+MINUTE(F12)+ROUND((SECOND(F12)/60),0))&gt;=210,210,(HOUR(F12)*60)+MINUTE(F12)+ROUND((SECOND(F12)/60),0))\"\nRange(\"G12\").NumberFormat = \"General\"\n'&lt; Formula: In Minutes; if Total Time is &lt;= 3:30 return 0 and if Total Time &gt; 3:30 return total time - 3:30\nRange(\"H12\").Value = \"=IF(((HOUR(F12)*60)+MINUTE(F12)+ROUND((SECOND(F12)/60),0))&lt;=210,0,((HOUR(F12)*60)+MINUTE(F12)+ROUND((SECOND(F12)/60),0)-210))\"\nRange(\"H12\").NumberFormat = \"General\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 5882982, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-HDGYr0pR1LA/AAAAAAAAAAI/AAAAAAAAIXM/DMyEy9Q7Z1k/photo.jpg?sz=128", "display_name": "Epil epic", "link": "https://stackoverflow.com/users/5882982/epil-epic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456374387, "creation_date": 1456317855, "question_id": 35602591, "link": "https://stackoverflow.com/questions/35602591/calculate-with-time", "title": "Calculate with time", "body": "<p>As I need to log my working hours for project reasons I am trying to configure a macro. As I am rather new to VBA I am still experiencing difficulties with code formulas and time-formats. </p>\n\n<p><a href=\"https://i.imgur.com/2p8ln6W.png\" rel=\"nofollow\">Here is how the sheet looks like</a></p>\n\n<p>When pressing \"ARRIVAL\" or \"DEPARTURE\" it's just <code>Range(\"C7/C9\") = Now</code></p>\n\n<p><em>(this is in seperate cells because I want to be able to manually override)</em></p>\n\n<p>When pressing \"LOG\" this is the code behind it:</p>\n\n<pre><code>'FORMAT\nRange(\"12:12\").Insert\nRange(\"C7\").Copy\nRange(\"C12:I12\").PasteSpecial\nRange(\"C12:I12\").ClearContents\n\n'DATE\nRange(\"C7\").Copy\nRange(\"C12\").PasteSpecial\nRange(\"C12\").NumberFormat = \"m/d/yyyy\"\n\n'ARRIVAL\nRange(\"C7\").Copy\nRange(\"D12\").PasteSpecial\nRange(\"D12\").NumberFormat = \"[$-F400]h:mm:ss AM/PM\"\n\n'DEPARTURE\nRange(\"C9\").Copy\nRange(\"E12\").PasteSpecial\nRange(\"E12\").NumberFormat = \"[$-F400]h:mm:ss AM/PM\"\n\n'CALCULATE\nRange(\"E12\").Copy\nRange(\"F12\").PasteSpecial\nRange(\"F12\") = Range(\"E12\").Value - Range(\"D12\").Value\n\nRange(\"C12:I12\").Font.Size = 12\n</code></pre>\n\n<p>What I want now is in column G the amount of time I have been working on project which is less then 03:30h and in column H the amount of time I have been working on project which is more then 03:30h.</p>\n\n<p>Ideally this would be in #Minutes and even combined in 1 column with a (+/-) so I can easily calculate the totals.</p>\n\n<p>Thanks for looking into this!</p>\n"}, {"tags": ["excel", "adodb", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1456318256, "post_id": 35602519, "comment_id": 58889912, "body": "There is no exact equivalent in VBA. If you use a Class with public member variables, or appropriately named properties, you can use <code>CallByName</code> to do this. I confess I struggle to see a benefit though."}], "answers": [{"comments": [{"owner": {"reputation": 2177, "user_id": 1211997, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/289e883b1531a6c68ce799642e3b918e?s=128&d=identicon&r=PG", "display_name": "rheitzman", "link": "https://stackoverflow.com/users/1211997/rheitzman"}, "edited": false, "score": 0, "creation_date": 1456334543, "post_id": 35605186, "comment_id": 58901954, "body": "That was sort of my approach as well - wrote class for the app to write parameters to a common location, and a class for VBA to read the parameters from that location. I use the MS doc filename as the lookup key for the common location. Won&#39;t scale well but works in a small shop."}], "tags": [], "owner": {"reputation": 29, "user_id": 3169169, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/5AsjT.jpg?s=128&g=1", "display_name": "DuaneRRR", "link": "https://stackoverflow.com/users/3169169/duanerrr"}, "is_accepted": false, "score": 0, "last_activity_date": 1456324965, "creation_date": 1456324965, "answer_id": 35605186, "question_id": 35602519, "link": "https://stackoverflow.com/questions/35602519/excel-vba-variable-references-another-variable/35605186#35605186", "title": "excel vba variable references another variable", "body": "<p>I've sort of answered this by just defining a global ADODB connection, which I'm referencing in my module. After the call is made I'm then transferring the global value to my application specific connection.</p>\n\n<p>Dirty workaround but it works.</p>\n"}], "owner": {"reputation": 29, "user_id": 3169169, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/5AsjT.jpg?s=128&g=1", "display_name": "DuaneRRR", "link": "https://stackoverflow.com/users/3169169/duanerrr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 148, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456324965, "creation_date": 1456317720, "last_edit_date": 1531164843, "question_id": 35602519, "link": "https://stackoverflow.com/questions/35602519/excel-vba-variable-references-another-variable", "title": "excel vba variable references another variable", "body": "<p>I am trying to set-up a generic process in Excel VBA to handle connections and reading databases.</p>\n\n<p>Rather than hard code variable names into the module I would like to refer to a passed variable name, which is then updated in the module. This would allow me to use this in any number of applications without having to hard code variable names.</p>\n\n<p>Example\nAn application has a variable:</p>\n\n<pre><code>Dim cnDB1 As ADODB.Connection\nDim cnDB2 as ADODB.Connection\n</code></pre>\n\n<p>I would like to pass the variable 'name' as a parameter and have the generic module update the value.</p>\n\n<pre><code>Open_Database \"cnDB1\", strCnnnectionDetails1\nOpen_Database \"cnDB2\", strConnectionDetails2\n</code></pre>\n\n<p>I have done this in VBS via the Eval and Execute command, but I cannot identify how to perform a similar action in Excel VBA.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 5913016, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4ab506483b06851f35a7180cd40d0eab?s=128&d=identicon&r=PG&f=1", "display_name": "VBA_kid", "link": "https://stackoverflow.com/users/5913016/vba-kid"}, "edited": false, "score": 0, "creation_date": 1456318383, "post_id": 35602709, "comment_id": 58889996, "body": "Ooo Yeah something like this could work. Thank you John."}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 4, "last_activity_date": 1456318206, "creation_date": 1456318206, "answer_id": 35602709, "question_id": 35602499, "link": "https://stackoverflow.com/questions/35602499/vba-creating-a-variable-name-by-concatenating-string-and-variable/35602709#35602709", "title": "VBA Creating a variable name by concatenating string and variable?", "body": "<p>You can't construct variables on the fly like that, but you can create an array of dictionaries:</p>\n\n<pre><code>Sub test()\n    Dim dictionary_1 As Object\n    Dim dictionary_2 As Object\n    Dim dictionaries As Variant\n\n    Set dictionary_1 = CreateObject(\"Scripting.Dictionary\")\n    Set dictionary_2 = CreateObject(\"Scripting.Dictionary\")\n\n    ReDim dictionaries(1 To 2)\n    Set dictionaries(1) = dictionary_1\n    Set dictionaries(2) = dictionary_2\n\n    dictionaries(1).Add \"a\", 1\n    dictionaries(2).Add \"a\", 2\n\n    Debug.Print dictionary_1(\"a\") 'prints 1\n    Debug.Print dictionary_2(\"a\") 'prints 2\nEnd Sub\n</code></pre>\n\n<p>You can also do things like create a dictionary of dictionaries, but in your case an array of dictionaries seems natural.</p>\n\n<p>Note that if you are going this route, you can dispense with the individual dictionaries and just use the array, like this:</p>\n\n<pre><code>Sub test()\n    Dim dictionaries As Variant\n\n    ReDim dictionaries(1 To 2)\n    Set dictionaries(1) = CreateObject(\"Scripting.Dictionary\")\n    Set dictionaries(2) = CreateObject(\"Scripting.Dictionary\")\n\n    dictionaries(1).Add \"a\", 1\n    dictionaries(2).Add \"a\", 2\n\n    Debug.Print dictionaries(1)(\"a\") 'prints 1\n    Debug.Print dictionaries(2)(\"a\") 'prints 2\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 5913016, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4ab506483b06851f35a7180cd40d0eab?s=128&d=identicon&r=PG&f=1", "display_name": "VBA_kid", "link": "https://stackoverflow.com/users/5913016/vba-kid"}, "edited": false, "score": 0, "creation_date": 1456319179, "post_id": 35603005, "comment_id": 58890557, "body": "Thank you, a case of fastest fingers first. I&#39;m glad to see everyone is in agreement"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1456319026, "last_edit_date": 1495541621, "creation_date": 1456319026, "answer_id": 35603005, "question_id": 35602499, "link": "https://stackoverflow.com/questions/35602499/vba-creating-a-variable-name-by-concatenating-string-and-variable/35603005#35603005", "title": "VBA Creating a variable name by concatenating string and variable?", "body": "<p>I was working on a similar solution to the one proposed by <a href=\"https://stackoverflow.com/users/4996248/john-coleman\">John Coleman</a>.</p>\n\n<pre><code>Sub dueling_dictionaries()\n    Dim dDICTs() As Object, vVALs As Variant, i As Long, j As Long\n\n    vVALs = Range(\"A1:B4\").Value2\n\n    ReDim dDICTs(1 To 2)\n    Set dDICTs(1) = CreateObject(\"Scripting.Dictionary\")\n    Set dDICTs(2) = CreateObject(\"Scripting.Dictionary\")\n\n    dDICTs(1).comparemode = vbTextCompare\n    dDICTs(2).comparemode = vbTextCompare\n\n    For i = LBound(vVALs, 1) To UBound(vVALs, 1)\n        For j = LBound(vVALs, 2) To UBound(vVALs, 2)\n            dDICTs(j).Add Key:=vVALs(i, j), Item:=vVALs(i, 2 + CBool(j = 2))\n        Next j\n    Next i\n\n    Erase vVALs  'going to reuse this in the following loops\n\n    For Each vVALs In dDICTs(1)\n        Debug.Print \"key: \" &amp; vVALs &amp; \" - Item: \" &amp; dDICTs(1).Item(vVALs)\n    Next vVALs\n\n    For Each vVALs In dDICTs(2)\n        Debug.Print \"key: \" &amp; vVALs &amp; \" - Item: \" &amp; dDICTs(2).Item(vVALs)\n    Next vVALs\n\nEnd Sub\n</code></pre>\n\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/zxyey.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zxyey.png\" alt=\"dueling_dictionaries\"></a></p>\n\n<p>Results from the Immediate window.</p>\n\n<pre><code>key: A - Item: 1\nkey: B - Item: 2\nkey: C - Item: 3\nkey: D - Item: 4\nkey: 1 - Item: A\nkey: 2 - Item: B\nkey: 3 - Item: C\nkey: 4 - Item: D\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 5913016, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4ab506483b06851f35a7180cd40d0eab?s=128&d=identicon&r=PG&f=1", "display_name": "VBA_kid", "link": "https://stackoverflow.com/users/5913016/vba-kid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5240, "favorite_count": 1, "accepted_answer_id": 35602709, "answer_count": 2, "score": 3, "last_activity_date": 1456319140, "creation_date": 1456317650, "last_edit_date": 1531164843, "question_id": 35602499, "link": "https://stackoverflow.com/questions/35602499/vba-creating-a-variable-name-by-concatenating-string-and-variable", "title": "VBA Creating a variable name by concatenating string and variable?", "body": "<p>I am currently writing some VBA script with the final aim of comparing two dictionaries.</p>\n\n<p>I have a large loop loading information into a dictionary from an xml file. To cut a long story short it ends with something like.</p>\n\n<pre><code>    Dictionary.Add index, info\n</code></pre>\n\n<p>Now i would like to add the functionality to have 2 dictionaries (dictionary_1 and dictionary_2) and  choose which dictionary to write the information to by incorporating it in some kind of loop. This is what im thinking</p>\n\n<pre><code>for i=1 to 2\n    (\"dictionary_\" &amp; i).add key, info\nnext i\n</code></pre>\n\n<p>If this worked it would obviously just put the same information in the two dictionaries but that's not the point here, my question is:</p>\n\n<p>How do i reference a variable this way concatenating some kind of string and variable?</p>\n\n<p>Any thoughts or is this not possible/not a good idea for some reason that is beyond me?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1456318114, "post_id": 35602165, "comment_id": 58889819, "body": "I don&#39;t think you can use reverse in VBA, you could loop the recordset in reverse or the array in reverse, as its only 2 rows not a big task."}, {"owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1456318231, "post_id": 35602165, "comment_id": 58889897, "body": "Why can you not use <code>ORDER BY</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1456320363, "creation_date": 1456320363, "answer_id": 35603500, "question_id": 35602165, "link": "https://stackoverflow.com/questions/35602165/excel-vba-reverse-result-of-ado-query/35603500#35603500", "title": "Excel VBA reverse result of ado query", "body": "<p>You can sub query it and join the results of first and last as 2 rows</p>\n\n<p>like this, my data not yours, sorry</p>\n\n<pre><code>SELECT LAST(OriginalQry1.TeammemberID) AS FirstR\nFROM (SELECT TOP 2 TM.TeammemberID\nFROM tbl_Teammembers AS TM)  AS OriginalQry1\nUNION ALL\nSELECT First(OriginalQry2.TeammemberID) AS LastR\nFROM (SELECT TOP 2 TM.TeammemberID\nFROM tbl_Teammembers AS TM)  AS OriginalQry2\n</code></pre>\n\n<p>Then you can just use copy from recordset?</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1456321045, "creation_date": 1456321045, "answer_id": 35603749, "question_id": 35602165, "link": "https://stackoverflow.com/questions/35602165/excel-vba-reverse-result-of-ado-query/35603749#35603749", "title": "Excel VBA reverse result of ado query", "body": "<p>This short 'helper' function should replace the VB.Net's <a href=\"https://msdn.microsoft.com/en-us/library/d3877932.aspx\" rel=\"nofollow\">Array.Reverse method</a>.</p>\n\n<pre><code>Function reverseArray(vals As Variant) As Variant\n    Dim tmp As Variant, i As Long\n\n    For i = LBound(vals, 1) To UBound(vals, 1) / 2\n        tmp = vals(UBound(vals, 1) - (i - LBound(vals, 1)), 1)\n        vals(UBound(vals, 1) - (i - 1), 1) = vals(i, 1)\n        vals(i, 1) = tmp\n    Next i\n\n    reverseArray = vals\n\nEnd Function\n</code></pre>\n\n<p>The maths used to determine the opposing element to flip values with should work with both zero-based and one-based arrays.</p>\n\n<pre><code>If Not recordSet.EOF Then\n    a = recordSet.GetRows\n    a = reverseArray(a)\n    Sheet1.Cells(10, 2).Resize(UBound(a, 1) + 1, UBound(a, 2) + 1).Value = a\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 3425, "user_id": 2140331, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/e4fc058b786dd472111650fe7b049cc5?s=128&d=identicon&r=PG", "display_name": "xeraphim", "link": "https://stackoverflow.com/users/2140331/xeraphim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 356, "favorite_count": 0, "accepted_answer_id": 35603749, "answer_count": 2, "score": 1, "last_activity_date": 1456321045, "creation_date": 1456316698, "question_id": 35602165, "link": "https://stackoverflow.com/questions/35602165/excel-vba-reverse-result-of-ado-query", "title": "Excel VBA reverse result of ado query", "body": "<p>I'm trying to get records from a database and fill them into excel.\nThis is how I get the data and fill it (note: the query is simplified, I can't just <code>ORDER BY DESC</code>):</p>\n\n<pre><code>Sub FillPersons(ByRef connection As ADODB.connection)\n    Dim recordSet As ADODB.recordSet\n    Set recordSet = New ADODB.recordSet\n    Dim sql As String\n\n    sql = \"SELECT TOP 2 Id FROM Persons\"\n\n    recordSet.activeconnection = connection \n    recordSet.Open sql\n\n    Dim a As Variant\n\n    If Not recordSet.EOF Then\n        a = recordSet.GetRows\n        a.Reverse (a)\n        Sheet1.Cells(10, 2).Resize(UBound(a, 1) + 1, UBound(a, 2) + 1).Value = a\n    End If\n\n    'Sheet1.Range(\"B10\").CopyFromRecordset recordSet\n\n    recordSet.Close\n    connection .Close\n    Set connection = Nothing\nEnd Sub\n</code></pre>\n\n<p>Unfortunately, the result looks like this:</p>\n\n<p><kbd>B10</kbd><kbd>B11</kbd><br />\n<kbd>2&nbsp;&nbsp;&nbsp;&nbsp;</kbd><kbd>1&nbsp;&nbsp;&nbsp;&nbsp;</kbd></p>\n\n<p>instead of</p>\n\n<p><kbd>B10</kbd><kbd>B11</kbd><br />\n<kbd>1&nbsp;&nbsp;&nbsp;&nbsp;</kbd><kbd>2&nbsp;&nbsp;&nbsp;&nbsp;</kbd></p>\n\n<p>I've tried to reverse <code>a</code> but unfortunately I can't get it to work.</p>\n\n<p>Is there a trick to get the correct result?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 15, "user_id": 3331877, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Th21Y.jpg?s=128&g=1", "display_name": "BenjiHare", "link": "https://stackoverflow.com/users/3331877/benjihare"}, "reply_to_user": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1456315542, "post_id": 35601270, "comment_id": 58887952, "body": "@Santosh I don&#39;t need to open the workbooks or edit them in any way, the password is just required to reference them in formulae in the master workbook"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 3331877, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Th21Y.jpg?s=128&g=1", "display_name": "BenjiHare", "link": "https://stackoverflow.com/users/3331877/benjihare"}, "edited": false, "score": 0, "creation_date": 1456316665, "post_id": 35602087, "comment_id": 58888773, "body": "I don&#39;t need (or want) to actually open the source files, just make it so that the team manager doesn&#39;t need to type over a dozen passwords every time they want to check the team&#39;s overall productivity."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 15, "user_id": 3331877, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Th21Y.jpg?s=128&g=1", "display_name": "BenjiHare", "link": "https://stackoverflow.com/users/3331877/benjihare"}, "edited": false, "score": 0, "creation_date": 1456317120, "post_id": 35602087, "comment_id": 58889098, "body": "So you just want to get the data from a password protected workbook?"}, {"owner": {"reputation": 15, "user_id": 3331877, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Th21Y.jpg?s=128&g=1", "display_name": "BenjiHare", "link": "https://stackoverflow.com/users/3331877/benjihare"}, "edited": false, "score": 0, "creation_date": 1456317390, "post_id": 35602087, "comment_id": 58889296, "body": "Exactly that, but with 16 password protected workbooks at once - ideally I just want a macro to input the passwords"}, {"owner": {"reputation": 15, "user_id": 3331877, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Th21Y.jpg?s=128&g=1", "display_name": "BenjiHare", "link": "https://stackoverflow.com/users/3331877/benjihare"}, "edited": false, "score": 0, "creation_date": 1456320059, "post_id": 35602087, "comment_id": 58891194, "body": "Unfortunately not, I think it&#39;s something to do with how the whole network is set up (government IT, is there any hell more fresh?)  Unless I&#39;m mistaken, to link them I need a username and a password, none of the usernames I can think of to try (I&#39;ve been fairly thorough) have allowed me to make a connection."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 15, "user_id": 3331877, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Th21Y.jpg?s=128&g=1", "display_name": "BenjiHare", "link": "https://stackoverflow.com/users/3331877/benjihare"}, "edited": false, "score": 0, "creation_date": 1456320414, "post_id": 35602087, "comment_id": 58891474, "body": "Do you know the passwords?"}, {"owner": {"reputation": 15, "user_id": 3331877, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Th21Y.jpg?s=128&g=1", "display_name": "BenjiHare", "link": "https://stackoverflow.com/users/3331877/benjihare"}, "edited": false, "score": 0, "creation_date": 1456320512, "post_id": 35602087, "comment_id": 58891536, "body": "Yes, as does the team leader who will be accessing the file when it&#39;s complete, I&#39;m just trying to stop them from having to enter 17 passwords every time they open the file, though if it&#39;s absolutely the only option then it can be so."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 15, "user_id": 3331877, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Th21Y.jpg?s=128&g=1", "display_name": "BenjiHare", "link": "https://stackoverflow.com/users/3331877/benjihare"}, "edited": false, "score": 0, "creation_date": 1456320671, "post_id": 35602087, "comment_id": 58891643, "body": "I think you&#39;ll need to open the workbooks, as stated with the password, but not visible? grab the data, then close.  The password stops an ADO-SQL connection also I believe.  You can hard code the passwords or have a sheet to look them up off, hidden of course :)"}, {"owner": {"reputation": 15, "user_id": 3331877, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Th21Y.jpg?s=128&g=1", "display_name": "BenjiHare", "link": "https://stackoverflow.com/users/3331877/benjihare"}, "edited": false, "score": 0, "creation_date": 1456321216, "post_id": 35602087, "comment_id": 58892028, "body": "Hard coding the passwords would be fine, but how might a I go about that? As it stands I don&#39;t even know the equivalent of &#39;Hello world&#39; in VBA"}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1456316487, "creation_date": 1456316487, "answer_id": 35602087, "question_id": 35601270, "link": "https://stackoverflow.com/questions/35601270/connecting-to-several-password-protected-workbooks-in-excel/35602087#35602087", "title": "Connecting to several password protected workbooks in Excel", "body": "<pre><code>Workbooks.Open filename,,,,password\n</code></pre>\n\n<p>Is what you need, you can set this to be an excel workbook object also</p>\n\n<pre><code>dim x as excel.workbook\nset x=Workbooks.Open (filename,,,,password)\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 3331877, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Th21Y.jpg?s=128&g=1", "display_name": "BenjiHare", "link": "https://stackoverflow.com/users/3331877/benjihare"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 991, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456320424, "creation_date": 1456314249, "last_edit_date": 1456320424, "question_id": 35601270, "link": "https://stackoverflow.com/questions/35601270/connecting-to-several-password-protected-workbooks-in-excel", "title": "Connecting to several password protected workbooks in Excel", "body": "<p>I'm creating a master sheet to pool data from 16 password protected workbooks, if it possible to run a macro to just enter the passwords upon opening the master file? I don't want to build the password into every reference, just the initial opening.</p>\n\n<p>I don't want to open the source files, just enter passwords (when opening the master, a prompt for each password comes up sequentially)</p>\n\n<p>I tried recording a macro while entering the passwords but it didn't capture them.</p>\n\n<p>Is this actually possible? Are there any commands like <code>externalWorkbook.password = \"hunter2\"</code>?</p>\n\n<p>I know I've seen some code on here before dealing with passwords but I've been unable to find it today...</p>\n\n<p>I'm a 100% VBA novice, so any help at all is hugely appreciated!</p>\n\n<p>edit: if it helps with example code, the master file is in the same shared folder as all the source files, and the file path is approximately <code>\\\\url.gov.uk\\server\\workgroup\\productivity\\team</code> and each file is just the user's first name, e.g. Ann, Bob, Cat, Dot etc.</p>\n"}, {"tags": ["vba", "excel", "zooming"], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 3, "last_activity_date": 1456315809, "creation_date": 1456315809, "answer_id": 35601840, "question_id": 35601223, "link": "https://stackoverflow.com/questions/35601223/excel-2003-zooming/35601840#35601840", "title": "Excel 2003 zooming", "body": "<p>If you select a range and then set the Zoom to True, it will fit to the selection, so:</p>\n\n<pre><code>Sub FitIt()\n    Dim rgToFit               As Range\n    Dim rgCurrent             As Range\n\n    Application.ScreenUpdating = False\n    Set rgCurrent = ActiveCell\n\n    ' CHANGE THIS TO WHATEVER RANGE YOU WANT\n    Set rgToFit = ActiveSheet.UsedRange\n\n    rgToFit.Select\n    ActiveWindow.Zoom = True\n    rgCurrent.Select\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 4334538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dabaf28ba72a3be6bbe7566b77a39b2f?s=128&d=identicon&r=PG&f=1", "display_name": "Salva Triado", "link": "https://stackoverflow.com/users/4334538/salva-triado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1456315809, "creation_date": 1456314116, "question_id": 35601223, "link": "https://stackoverflow.com/questions/35601223/excel-2003-zooming", "title": "Excel 2003 zooming", "body": "<p>I have a trouble with a Excel document. I need set a specific zoom to show the full content of my sheet. The trouble is that I must distribute this document in different computers with different resolution. Then, I cann't work with an specific zoom value, this value must be dynamic.</p>\n\n<p>I tried this:</p>\n\n<pre><code>With ActiveSheet.PageSetup\n .FitToPagesTall = 1\n .FitToPagesWide = 1\n .Zoom = False\nEnd With\n</code></pre>\n\n<p>But this don't work, at least in Excel 2003.</p>\n\n<p>I also tried with ActiveWindow.Zoom but I think with this library I won't be able to fit the zoom to the page.</p>\n\n<p>There are my questions:\n1. How can I fit the zoom to the page content?\n2. Is there an option to do it without VB?</p>\n\n<p>My main problems are:\n1. Showing the document in different resolutions.\n2. Opening the document in different Excel versions (2003, 2007 and maybe 2013).</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1456316466, "post_id": 35601100, "comment_id": 58888609, "body": "wouldnt it be easier just to send the forms directly to the log? You can tell vba to send the log as any file type to the destination. This would reduce email clutter and streamline the process. Further more, you can just use the email and then in a separate line have the file dumped to the preferred location, that way you no longer need the attachment. One of the macros I generated does this with XML. Want to see some sample code?"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1456316519, "post_id": 35601100, "comment_id": 58888650, "body": "Also its worth mentioning that no where in your code do you tell the userform what to do with the user input"}], "answers": [{"tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": false, "score": 0, "last_activity_date": 1456317422, "creation_date": 1456317422, "answer_id": 35602406, "question_id": 35601100, "link": "https://stackoverflow.com/questions/35601100/form-completed-sent-as-attachment-as-blank/35602406#35602406", "title": "Form completed sent as attachment as blank", "body": "<p>try this some variation of this :)</p>\n\n<pre><code> Private Declare Function ShellExecute Lib \"shell32.dll\" _\n Alias \"ShellExecuteA\" (ByVal hwnd As Long, ByVal lpOperation As String, _\n ByVal lpFile As String, ByVal lpParameters As String, ByVal lpDirectory As String, _\n ByVal nShowCmd As Long) As Long\n\n sub nameofsub()\n\n Dim Email As String, Subj As String\n Dim answer As Integer\n Dim Msg As String, body As String, URL As String\n Dim OutApp As Object, OutMail As Object\n Dim filelocation1 As String\n Dim wb1 as workbook\n\n filelocation1 = \"Filepath\" &amp; \"\\\" &amp; \"filename\" &amp; \".filextension\"\n CreateObject(\"Scripting.FileSystemObject\").FileExists(filelocation1)\n\n 'code to tell user form how to store information in the document\n 'Example: (assuming you use excel as a format)\n 'Set wb1 = Workbooks.open(filelocation1)\n ' wb1.worksheet.range(\"a1\").value = textbox1.value     this might be off, double check. this might drastically differ is you use other file extensions \n\n\n Email = \"personMcDude@someaddress.com\"\n Subj = \"My email to you\"\n body = \"Hello Person,\" &amp; vbCr &amp; _\n         \"the stuff is in the folder\" &amp; vbCr &amp; _\n         \"stuff\" &amp; vbCr &amp; _\n         \"more stuff\" &amp; vbCr &amp; _\n         \"and yet more\" &amp; vbCr &amp; _\n         \"Thank you. \"\n\n Set OutApp = CreateObject(\"Outlook.Application\")\n Set OutMail = OutApp.CreateItem(0)\n\n On Error Resume Next\n     With OutMail\n         .To = Email\n         .CC = vbNullString\n         .BCC = vbNullString\n         .Subject = Subj\n         .body = body\n         .Display\n     End With\n On Error GoTo 0\n\n Set OutMail = Nothing\n Set OutApp = Nothing\n\n\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5965215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d1dd1a382272bc9310b79d75939d8ff?s=128&d=identicon&r=PG&f=1", "display_name": "Temi", "link": "https://stackoverflow.com/users/5965215/temi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 160, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456360611, "creation_date": 1456313797, "last_edit_date": 1456360611, "question_id": 35601100, "link": "https://stackoverflow.com/questions/35601100/form-completed-sent-as-attachment-as-blank", "title": "Form completed sent as attachment as blank", "body": "<p>I designed a form in Excel for users to fill and click on submit. This should then automatically send the completed form as an attachment to a designated Outlook email address.</p>\n\n<p>The problems I am encountering are</p>\n\n<ol>\n<li><p>It sends a blank form. The form will be used by several users within the company and will be accessed from a shared drive.</p></li>\n<li><p>The user cannot tell if the submit button has worked as it doesn't display any message. I would like to display a message \"Your form has now been submitted\"</p></li>\n</ol>\n\n<p>This is the code I currently have in place</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CommandButton1_Click()\n\nOn Error GoTo ErrHandler\n\n' SET Outlook APPLICATION OBJECT.\nDim objOutlook As Object\nSet objOutlook = CreateObject(\"Outlook.Application\")\n\n' CREATE EMAIL OBJECT.\nDim objEmail As Object\nSet objEmail = objOutlook.CreateItem(olMailItem)\n\nWith objEmail\n    .To = \"jack@jill.com\"\n    .Subject = \"Issue Resolution Request\"\n    .Body = \"Hi Finance Systems, please see the attached issues log for your attention\"\n    ThisWorkbook.Save\n    .Attachment.Add ThisWorkbook.Path &amp; \"\\\" &amp; ThisWorkbook.Name\n    .Send        ' SEND THE MESSAGE\nEnd With\n\nSet objEmail = Nothing:    Set objOutlook = Nothing\n\nErrHandler:\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "if-statement"], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 4021883, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/512303933/picture?type=large", "display_name": "Alan Treanor", "link": "https://stackoverflow.com/users/4021883/alan-treanor"}, "edited": false, "score": 0, "creation_date": 1456313893, "post_id": 35600646, "comment_id": 58886779, "body": "I knew it was something simple my mind was blank, thanks alot."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user844705"}, "is_accepted": false, "score": 5, "last_activity_date": 1456312954, "last_edit_date": 1456312954, "creation_date": 1456312635, "answer_id": 35600646, "question_id": 35600559, "link": "https://stackoverflow.com/questions/35600559/if-or-formula-not-giving-the-correct-true-or-false-statement/35600646#35600646", "title": "If / Or formula not giving the correct True or False statement", "body": "<p>Yes. Try this</p>\n\n<pre><code>If rCell.Offset(0, -2).Value = \"101\" Or rCell.Offset(0, -2).Value = \"102\" Then\n</code></pre>\n\n<p>EDIT: Essentially your code is asking </p>\n\n<pre><code>If \"102\" \n</code></pre>\n\n<p>which will always return true.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1456313798, "creation_date": 1456313798, "answer_id": 35601101, "question_id": 35600559, "link": "https://stackoverflow.com/questions/35600559/if-or-formula-not-giving-the-correct-true-or-false-statement/35601101#35601101", "title": "If / Or formula not giving the correct True or False statement", "body": "<p>I'm going out on a limb and say that the numbers in rCell.Offset(0, -2) are actual numbers and not text-that-looks-like-a-number. Remember that <code>101 &lt;&gt; \"101\"</code> so remove the quotes as well as correct the Or syntax.</p>\n\n<pre><code>If rCell.Offset(0, -2).Value2 = 101 Or rCell.Offset(0, -2).Value2 = 102 Then\n    rCell.Value = \"Option 2\"\nElse\n    rCell.Value = \"Option 1\"\nEnd If\n</code></pre>\n\n<p>Another option would be a <a href=\"https://msdn.microsoft.com/en-us/library/office/gg278665.aspx\" rel=\"nofollow\">Select Case statement</a>.</p>\n\n<pre><code>Select Case rCell.Offset(0, -2).Value2\n    Case 101, 102\n        rCell.Value = \"Option 2\"\n    Case 112, 113\n        'do something for these\n    Case 118\n        'do something for this\n    Case Else\n        'when nothing else matches\n        rCell.Value = \"Option 1\"\nEnd Select\n</code></pre>\n\n<p>The benefits to this style of condition evaluation becomes quickly apparent when there are several conditions to check.</p>\n"}], "owner": {"reputation": 133, "user_id": 4021883, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/512303933/picture?type=large", "display_name": "Alan Treanor", "link": "https://stackoverflow.com/users/4021883/alan-treanor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 35601101, "answer_count": 2, "score": 2, "last_activity_date": 1456314098, "creation_date": 1456312384, "last_edit_date": 1456314098, "question_id": 35600559, "link": "https://stackoverflow.com/questions/35600559/if-or-formula-not-giving-the-correct-true-or-false-statement", "title": "If / Or formula not giving the correct True or False statement", "body": "<p>I have an If formula as part of my macro code which doesn't seem to be working in the correct manner.</p>\n\n<p>The below code calculates the rCell.Offset and always applies it as being True, I have had examples where it equals 112, 113, 118 etc and it is populating the desired cell as Option 2.</p>\n\n<pre><code>If rCell.Offset(0, -2).Value = \"101\" Or \"102\" Then\n        rCell.Value = \"Option 2\"\n        Else\n        rCell.Value = \"Option 1\"\n        End If\n</code></pre>\n\n<p>Am I missing something?</p>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1456315428, "post_id": 35600280, "comment_id": 58887872, "body": "What have you tried already? Have you used the macro recorder? Where are you stuck?"}, {"owner": {"reputation": 837, "user_id": 5972774, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/920de275c81b59ed95e2fbd6929d103d?s=128&d=identicon&r=PG&f=1", "display_name": "Aajan", "link": "https://stackoverflow.com/users/5972774/aajan"}, "reply_to_user": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1456316229, "post_id": 35600280, "comment_id": 58888432, "body": "I have no background knowledge in creating VBA scripts."}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1456316281, "post_id": 35600280, "comment_id": 58888467, "body": "Try using the macro recorder and record what you do manually and then take a look at the code it produces."}, {"owner": {"reputation": 837, "user_id": 5972774, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/920de275c81b59ed95e2fbd6929d103d?s=128&d=identicon&r=PG&f=1", "display_name": "Aajan", "link": "https://stackoverflow.com/users/5972774/aajan"}, "reply_to_user": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1456316417, "post_id": 35600280, "comment_id": 58888576, "body": "Manually separating duplicates will not generate any code."}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1456316436, "post_id": 35600280, "comment_id": 58888590, "body": "data - remove duplicates"}, {"owner": {"reputation": 837, "user_id": 5972774, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/920de275c81b59ed95e2fbd6929d103d?s=128&d=identicon&r=PG&f=1", "display_name": "Aajan", "link": "https://stackoverflow.com/users/5972774/aajan"}, "reply_to_user": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1456316577, "post_id": 35600280, "comment_id": 58888699, "body": "data - remove is working only for single column. Here two columns are present. Even if i select both and do remove duplicates nothing is happening."}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1456316941, "post_id": 35600280, "comment_id": 58888972, "body": "Try highlighting duplicates, or googling how to do it. I&#39;m not being snide, but your question is better received <a href=\"http://meta.stackexchange.com/questions/135049/encouraging-users-to-try-something-before-asking-write-me-code-that-questio\">if you put some effort into figuring out what you can</a>. As it stands now, there&#39;s 1001 ways to do this which is way too broad."}], "owner": {"reputation": 837, "user_id": 5972774, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/920de275c81b59ed95e2fbd6929d103d?s=128&d=identicon&r=PG&f=1", "display_name": "Aajan", "link": "https://stackoverflow.com/users/5972774/aajan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 396, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1593702421, "creation_date": 1456311720, "last_edit_date": 1593702421, "question_id": 35600280, "link": "https://stackoverflow.com/questions/35600280/macro-to-compare-columns-and-separate-unique-and-duplicate-values", "title": "Macro To Compare Columns And Separate Unique And Duplicate Values", "body": "<p>The requirement is  one macro that can compare two columns of an excel.It should write the unique values which are part of column A and not in column B to one new column 'Unique'.Similarly it has to write duplicate data that are present in both columns to another column 'Duplicate'.</p>\n\n<p>For example if input 'column A' contain A,B,C,D,E and 'column B' contains D,E,F,G,H,I,J\nthen result column 'Unique' should have  A,B,C and 'Duplicate'  should have D,E.</p>\n\n<p>[Note that number of elements in Column A can be equal, greater or less than column B]</p>\n\n<p>Suggest some method to implement this.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["vba", "email", "outlook", "attachment", "forward"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1456332353, "post_id": 35599975, "comment_id": 58900303, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/28840066/vba-to-forward-email-with-its-attachment-in-outlook-2010\">VBA to forward email with its attachment in Outlook 2010</a>"}], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1456426626, "creation_date": 1456426626, "answer_id": 35635946, "question_id": 35599975, "link": "https://stackoverflow.com/questions/35599975/forward-outlook-email-with-attachment/35635946#35635946", "title": "Forward outlook email WITH attachment", "body": "<p>Try the following.</p>\n\n<pre><code>Option Explicit\nPublic Sub FW(olItem As Outlook.MailItem)\n\n    With olItem\n        .Attachments.Add olItem, olEmbeddeditem\n        .Subject = \"FW: \" &amp; olItem.Subject\n        .To = \"om3r@.com\" ' &lt;- update\n        .Send\n    End With\n\n    '// Clean up\n    Set olItem = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 3952154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ac07299a2afca0a24c1916e8270351c?s=128&d=identicon&r=PG&f=1", "display_name": "Maikeru Anonymous", "link": "https://stackoverflow.com/users/3952154/maikeru-anonymous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1100, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593247835, "creation_date": 1456310897, "last_edit_date": 1593247835, "question_id": 35599975, "link": "https://stackoverflow.com/questions/35599975/forward-outlook-email-with-attachment", "title": "Forward outlook email WITH attachment", "body": "<p>im running Outlook 2016, and i want to Forward specific mails to my gmail.\nmy rule in outlook looks like this:</p>\n\n<p>Apply this rule after the message arrives -> with <em>danlon</em> in the sender's address -> on this computer only -> Run a script</p>\n\n<p><strong>My script is as follows</strong></p>\n\n<pre><code>Sub SendNew(Item As Outlook.MailItem) \nDim objMsg As MailItem \nSet objMsg = Application.CreateItem(olMailItem) \nobjMsg.Body = Item.Body \nobjMsg.Subject = \"FW: \" &amp; Item.Subject \nobjMsg.Recipients.Add \"my-mail@gmail.com\" \n\nobjMsg.Send \nEnd Sub\n</code></pre>\n\n<p>Problem is that its making a new template (i guess) instead of forward command, and it is working but it doesnt move the attachments to the template.. and the attachments are the most important.</p>\n\n<p>How do i do this, please keep in mind that i'm not a programmer of any sort.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1456310750, "post_id": 35599770, "comment_id": 58884466, "body": "If you use the <a href=\"https://support.office.com/en-us/article/COUNTBLANK-function-6a92d772-675c-4bee-b346-24af6bd3ac22\" rel=\"nofollow noreferrer\">COUNTBLANK function</a>, it treats truly blank cells and cells that contain a zero-length string (e.g. <code>&quot;&quot;</code>) the same. e.g. <code>=not(countblank(a5))</code> to receive a TRUE/FALSE that mimics <code>=isblank(a5)</code>.."}, {"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1456310929, "post_id": 35599770, "comment_id": 58884582, "body": "You can also use <a href=\"http://www.techonthenet.com/excel/formulas/isempty.php\" rel=\"nofollow noreferrer\">ISEMPTY Function</a> to check for blank cells or ranges."}, {"owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "edited": false, "score": 0, "creation_date": 1456311148, "post_id": 35599770, "comment_id": 58884726, "body": "Problem is, I handle the VBA side of things, and the users should be able to use whichever functions they want in the table.  There shouldn&#39;t be the need to add a disclaimer that ISBLANK is not permitted in this special case... (I should be glad if the users can manage to write a formula in the first place :) )  I.e.: it should be 100% fool-proof."}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1456311367, "post_id": 35599770, "comment_id": 58884875, "body": "Given that the performance difference between Value and Value2 isn&#39;t spectacular, why not use .Value?"}, {"owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "reply_to_user": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1456311500, "post_id": 35599770, "comment_id": 58884989, "body": "@jkpieterse: unfortunately, .Value behaves identical to .Value2 in this case (the diff is more in extended data type handling like Date and Currency)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1456311614, "post_id": 35599770, "comment_id": 58885078, "body": "It seems that the only way you can provide conformity to the user is to make them all zero-length strings or all truly blank. Pick one (sounds like the latter is better) and make the adjustments."}, {"owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "edited": false, "score": 0, "creation_date": 1456311691, "post_id": 35599770, "comment_id": 58885140, "body": "@Jeeped: point is the source rows I copy from can be anything the user can dream up, like e.g. truly blank cells or formulas returning =&quot;&quot;, or mixes of these.  I could inspect all &#39;empty&#39; cells and set them to either one according to the source&#39;s cell value, but that negates quite a big chunk of the efficiency if there&#39;s lots of these empty cells..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1456311895, "post_id": 35599770, "comment_id": 58885290, "body": "If the source has either <code>&quot;&quot;</code> or truly blanks then that should be fixed or the users should be banned from using ISBLANK in favor of NOT(COUNTBLANK)). Either they want to determine the lack of any substantial value or not. btw, `NOT(LEN(a5)) does the same thing and may make more sense to them."}, {"owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "edited": false, "score": 0, "creation_date": 1456312114, "post_id": 35599770, "comment_id": 58885474, "body": "@Jeeped: problem is I have no control over the users&#39; behavior - I provide a generic Excel solution which is expected to &#39;just work&#39; when the average Excel user is thrown at it.  Which maybe is in itself a pretty shitty situation in hindsight, given Excel&#39;s idiosyncrasies and ease of abuse :("}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 4, "creation_date": 1456313412, "post_id": 35599770, "comment_id": 58886474, "body": "Remember Carl, as soon as you make something idiot proof, the world just builds a better idiot."}, {"owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "edited": false, "score": 0, "creation_date": 1456316453, "post_id": 35599770, "comment_id": 58888600, "body": "@Jeeped: being a perfectionist I need to remember that quote more often :)  For now I think I&#39;ll just opt for a less performant but more idiot proof design."}], "answers": [{"comments": [{"owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "edited": false, "score": 0, "creation_date": 1456572936, "post_id": 35666381, "comment_id": 59017662, "body": "By setting Range.Value2 the data is copied identically to my code, so it doesn&#39;t address the fact that null-string cells aren&#39;t copied over correctly.  Clearing all copied &#39;empty&#39; cells afterwards is not what I want, since they are already Empty, which is what I want to avoid (I want to keep the empty-string and truly empty distinction).  The source data contains both types of empty (some empty strings even come from formulas), so I can&#39;t set those to Empty either.  All these cells also live in a table/ListObject; applying an autofilter to the pasted range is not an option either."}, {"owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "edited": false, "score": 0, "creation_date": 1456572978, "post_id": 35666381, "comment_id": 59017673, "body": "As a side-note to your comment about the efficiency: I already use <code>DestRange.Value2 = SourceRange.Value2</code>.  By putting SourceRange.Value2 into a variant first and inspecting that array for blanks you get almost no performance loss for inspecting individual cells either.  It&#39;s more that I do not want to have to perform this inspection &amp; correction afterwards at all.  All in all: close, but no cigar ;)"}, {"owner": {"reputation": 1345, "user_id": 5472502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qZ3mUF0RIy8/AAAAAAAAAAI/AAAAAAAAAeE/LRiEYccRVlc/photo.jpg?sz=128", "display_name": "Nick Peranzi", "link": "https://stackoverflow.com/users/5472502/nick-peranzi"}, "reply_to_user": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "edited": false, "score": 0, "creation_date": 1456594443, "post_id": 35666381, "comment_id": 59024939, "body": "Sorry about that @CarlColijn - I misinterpreted your post to mean you have the opposite problem. What does your source data look like - it is filterable? See my edit for a proposal that may work; seems to be good on my test data."}, {"owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "edited": false, "score": 0, "creation_date": 1456657842, "post_id": 35666381, "comment_id": 59041035, "body": "I capture the data from SourceRange.Value in an array, then process it before assigning it back to the DestRange.Value.  Using .SpecialCells to get the candidates, replace them with placeholders and using .Replace afterwards are in my case unnecessary actions - I haven&#39;t performance-tested your solution vs. mine, but I already have the data pass under my fingers in my processing loop (on the array).  Building a union of all null-string cells to set afterwards is thus no real effort in itself, it&#39;s just that I wanted to avoid any workarounds in the first place."}, {"owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "edited": false, "score": 0, "creation_date": 1456657855, "post_id": 35666381, "comment_id": 59041042, "body": "And I can&#39;t use an autofilter either, since I work inside a table (could use the table&#39;s own autofilter and restore it afterwards if already in use, but that&#39;s just another klude I want to avoid).  Thanks for thinking out of the box though, really appreciated!"}], "tags": [], "owner": {"reputation": 1345, "user_id": 5472502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qZ3mUF0RIy8/AAAAAAAAAAI/AAAAAAAAAeE/LRiEYccRVlc/photo.jpg?sz=128", "display_name": "Nick Peranzi", "link": "https://stackoverflow.com/users/5472502/nick-peranzi"}, "is_accepted": false, "score": 0, "last_activity_date": 1456594801, "last_edit_date": 1456594801, "creation_date": 1456553292, "answer_id": 35666381, "question_id": 35599770, "link": "https://stackoverflow.com/questions/35599770/preserve-null-strings-when-assigning-to-value-with-vba/35666381#35666381", "title": "Preserve null strings when assigning to .Value with VBA", "body": "<p>SpecialCells(xlCellTypeBlank) and AutoFilter treat null strings differently. Is your source data filterable? If so, could you use a placeholder value and then change the cells to have <code>.Formula = \"=\"\"\"\"\"</code> after copying?</p>\n\n<p>I took your sample code and generated the workbook, then added a row above it for a filter header. The below code would change all null strings to \"ChangeMe\"; you could then copy over the values and replace all instances of \"ChangeMe\" in your destination with \"=\"\"\"\"\" using Range.Replace.</p>\n\n<pre><code>Sub Test2()\n\nActiveSheet.Range(\"A2:A6\").SpecialCells(xlCellTypeBlanks).Interior.Color = 255 'Just to prove that xlCellTypeBlanks only selects actual blanks\n\nActiveSheet.Range(\"A1:A6\").AutoFilter Field:=1, Criteria1:=\"=\" 'Shows both actual blanks and ZLS/null strings\nActiveSheet.Range(\"A1:A6\").SpecialCells(xlCellTypeBlanks).EntireRow.Hidden = True 'Be able to use SpecialCells(xlCellTypeVisible) to reference all ZLS\nActiveSheet.Range(\"A2:A6\").SpecialCells(xlCellTypeVisible).Value2 = \"ChangeMe\"\n'Now unfilter and unhide your data, copy using .Value2, then .Replace \"ChangeMe\" with \"=\"\"\"\"\"\n\nEnd Sub\n</code></pre>\n\n<p>I think that accomplishes what you are trying to do - let me know if this is the right direction for a solution.</p>\n\n<p><em>Edit: misinterpreted original question. Below old answer is incorrect.</em></p>\n\n<p>While not quite as efficient as your original code, using .AutoFilter is much more efficient than looping through many cells. Furthermore, .AutoFilter treats zero-length strings and empty cells the same.</p>\n\n<p>Something like this:</p>\n\n<pre><code>Sub CopyAndClearFakeBlanks()\n\nDim WSSource As Worksheet\nDim WSDest As Worksheet\nDim LRow As Long\nDim LPasteRow As Long\n\nSet WSSource = Sheets(\"Source Data\")\nSet WSDest = Sheets(\"Paste Here\")\n\nLRow = WSSource.Range(\"A:A\").Find(what:=\"*\", searchdirection:=xlPrevious).Row 'Note that this will ignore blanks, so you may want to use a different method for finding your last row. Depends on how your users would need the data if there are trailing blanks.\n\nOn Error Resume Next\nLPasteRow = 2 'Always need at least one row before the data for filtering properly; you can delete after if necessary\nLPasteRow = WSDest.Range(\"A:A\").Find(what:=\"*\", searchdirection:=xlPrevious).Row + 1\nWSDest.AutoFilterMode = False\nOn Error GoTo 0 'ofc use proper error handling in your actual code\n\nWSDest.Range(\"A\" &amp; LPasteRow &amp; \":A\" &amp; LPasteRow + LRow - 1).Value2 = WSSource.Range(\"A1:A\" &amp; LRow).Value2\nWSDest.Range(\"A\" &amp; LPasteRow - 1 &amp; \":A\" &amp; LPasteRow + LRow).AutoFilter field:=1, Criteria1:=\"=\" 'Show blank or ZLS only\n\nOn Error Resume Next\nWSDest.Range(\"A\" &amp; LPasteRow &amp; \":A\" &amp; LPasteRow + LRow).SpecialCells(xlCellTypeVisible).Clear 'Turn them into true blanks\nWSDest.ShowAllData\nWSDest.AutoFilterMode = False\nOn Error GoTo 0\n\nSet WSDest = Nothing\nSet WSSource = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1092, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1456658722, "creation_date": 1456310384, "last_edit_date": 1456658722, "question_id": 35599770, "link": "https://stackoverflow.com/questions/35599770/preserve-null-strings-when-assigning-to-value-with-vba", "title": "Preserve null strings when assigning to .Value with VBA", "body": "<p>(edit: added 2 more restrictions to solutions)</p>\n\n<p>I have a table (listobject wise) in which I need to duplicate certain rows.  I'm using SourceListRow.Range.Value2 = DestListRow.Range.Value2 for efficiency reasons (copying whole ranges in one go).  All formula columns after the copied cell ranges auto-expand perfectly into the new rows and act upon the copied data.  I'm using Excel 2010 here on Windows.</p>\n\n<p>However, although I've already been using this sort of code for eons, I've only now stumbled upon an oddity when using Range.Value / Range.Value2: if you assign an empty string to it, the final cell value will not be an empty string, but it will be Empty.  That is: the data isn't copied over faithfully, and the copy can differ from the source, especially if consecutive formulas use ISBLANK etc. on it.  Therefore the same formula will have different results when working on the copy vs. the source.</p>\n\n<p>See below test code.  Open a new, blank, Excel workbook, go to VBA, add a new module and add the following code:</p>\n\n<pre><code>Sub Test()\n  ActiveSheet.Range(\"a1\").Formula = \"=\"\"\"\"\"\n  ActiveSheet.Range(\"b1\").Formula = \"=isblank(a1)\"\n  ActiveSheet.Range(\"c1\").Value2 = TypeName(ActiveSheet.Range(\"a1\").Value2)\n\n  ActiveSheet.Range(\"a2\").Value2 = ActiveSheet.Range(\"a1\").Value2\n  ActiveSheet.Range(\"b2\").Formula = \"=isblank(a2)\"\n  ActiveSheet.Range(\"c2\").Value2 = TypeName(ActiveSheet.Range(\"a2\").Value2)\n\n  ActiveSheet.Range(\"a3\").Value2 = \"\"\n  ActiveSheet.Range(\"b3\").Formula = \"=isblank(a3)\"\n  ActiveSheet.Range(\"c3\").Value2 = TypeName(ActiveSheet.Range(\"a3\").Value2)\n\n  ActiveSheet.Range(\"a4\").Formula = ActiveSheet.Range(\"a1\").Formula\n  ActiveSheet.Range(\"b4\").Formula = \"=isblank(a4)\"\n  ActiveSheet.Range(\"c4\").Value2 = TypeName(ActiveSheet.Range(\"a4\").Value2)\n\n  Call ActiveSheet.Range(\"a1\").Copy\n  Call ActiveSheet.Range(\"a5\").PasteSpecial(xlPasteValues)\n  ActiveSheet.Range(\"b5\").Formula = \"=isblank(a5)\"\n  ActiveSheet.Range(\"c5\").Value2 = TypeName(ActiveSheet.Range(\"a5\").Value2)\nEnd Sub\n</code></pre>\n\n<p>Then run it and look at the sheet;</p>\n\n<ul>\n<li>B1 tells FALSE (as it should - the cell is not empty), and C1 tells \"String\" (the cell value is indeed an empty string);</li>\n<li>B2 tells TRUE, even though we just copied over A1's value as-is; C2 tells \"Empty\", while it should tell \"String\" if the value was copied over faithfully;</li>\n<li>as a test, B3 tells TRUE, even though we just set it explicitly to an empty string; C3 again tells \"Empty\" to confirm the data mangling;</li>\n<li>assigning Range.Formula to OtherRange.Formula works (the String data type is preserved in B4), but I do not want to copy formula's, I want to copy only the values!</li>\n<li>as a test I mimic what the GUI would yield in A5, and sure enough, Copy/Paste-As-Values does preserve the is-an-empty-string state...</li>\n</ul>\n\n<p>What to do?</p>\n\n<ul>\n<li>using Range.Copy / Range.PasteSpecial(xlPasteValues) is unacceptable, performance-wise and clipboard-wise;</li>\n<li>using .Formula is also not an option, because I want to copy the values;</li>\n<li>I could iterate over all values in the array, testing if they're a null string and then setting those cell's formula to =\"\", but I want to copy whole multi-cell ranges in one go to gain efficiency here...</li>\n<li>I can't use autofilters and such because my data lives in a table (a.k.a. ListObject); I could use the table's own autofilter, but people may have it in use already so I'd have to restore it afterwards which is too much of a kludge.</li>\n<li>using Range.Find and Range.Replace is not an option either, since that changes the user's Find/Replace dialog settings.</li>\n</ul>\n\n<p>All ideas appreciated!</p>\n"}, {"tags": ["html", "vba", "selenium", "selenium-chromedriver"], "answers": [{"comments": [{"owner": {"reputation": 177, "user_id": 2255914, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2fbe53cab50813a25e87484fdc70c744?s=128&d=identicon&r=PG", "display_name": "johnn", "link": "https://stackoverflow.com/users/2255914/johnn"}, "edited": false, "score": 0, "creation_date": 1456377724, "post_id": 35599285, "comment_id": 58920689, "body": "<code>Call driver.get(driver.FindElementById(&quot;mylink&quot;).Attribute(&quot;href&quot;&zwnj;&#8203;))</code>"}], "tags": [], "owner": {"reputation": 7274, "user_id": 1453076, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a1aa3fec00c56d24b82051525a76cb90?s=128&d=identicon&r=PG", "display_name": "Vladimirs", "link": "https://stackoverflow.com/users/1453076/vladimirs"}, "is_accepted": true, "score": 2, "last_activity_date": 1456309149, "creation_date": 1456309149, "answer_id": 35599285, "question_id": 35599142, "link": "https://stackoverflow.com/questions/35599142/selenium-vba-how-to-avoid-open-blank-link-to-new-tab/35599285#35599285", "title": "Selenium vba, How to avoid open &quot;_blank&quot; link to new tab", "body": "<p>I never used selenium, but I think you should be able to get <code>href</code> attribute value and open that as a link, something like:</p>\n\n<pre><code>driver.get( driver.FindElementById(\"mylink\").getAttribute(\"href\") );\n</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 2255914, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2fbe53cab50813a25e87484fdc70c744?s=128&d=identicon&r=PG", "display_name": "johnn", "link": "https://stackoverflow.com/users/2255914/johnn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 731, "favorite_count": 0, "accepted_answer_id": 35599285, "answer_count": 1, "score": 3, "last_activity_date": 1456309149, "creation_date": 1456308739, "question_id": 35599142, "link": "https://stackoverflow.com/questions/35599142/selenium-vba-how-to-avoid-open-blank-link-to-new-tab", "title": "Selenium vba, How to avoid open &quot;_blank&quot; link to new tab", "body": "<p>HTML<br>\n    <code>&lt;a target=\"_blank\" id=\"mylink\" herf=\"www.google.com\"&gt;google&lt;/a&gt;</code></p>\n\n<p>VBA<br>\n    <code>driver.FindElementById(\"mylink\").Click</code></p>\n\n<p>How can I have the \"driver\" object refer to the new browser TAB or just open the link in the same browser TAB instead of opening into a new browser TAB even the link has a target=\"_blank\" attribute.</p>\n"}, {"tags": ["excel", "vba", "merge"], "comments": [{"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1456309192, "post_id": 35598877, "comment_id": 58883335, "body": "From your description I would think you simply reach the limit of what a worksheet can hold; this limit being 1,048,576 rows by 16,384 columns. What <i>exactly</i> is it you wish to achieve? To me this sounds like a case for a database rather than an Excel sheet?"}, {"owner": {"reputation": 15, "user_id": 5366931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63efd8d99f81cb5a4fe98b8e1b9f394d?s=128&d=identicon&r=PG&f=1", "display_name": "Mario", "link": "https://stackoverflow.com/users/5366931/mario"}, "reply_to_user": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1456309516, "post_id": 35598877, "comment_id": 58883579, "body": "I don&#39;t think that would be the case. Each XLS file has no more than 50 rows of data, and no more than 30-40 columns. So it should be a couple of 100K rows at most, never more than 500K."}, {"owner": {"reputation": 15, "user_id": 5366931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63efd8d99f81cb5a4fe98b8e1b9f394d?s=128&d=identicon&r=PG&f=1", "display_name": "Mario", "link": "https://stackoverflow.com/users/5366931/mario"}, "reply_to_user": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1456309563, "post_id": 35598877, "comment_id": 58883612, "body": "As for the exact purpose, it is to merge the first sheets from a few thousand excel files into a single excel file. So for example if I had 2000 Excel files, and each file had 50 rows of data, my end result would be a single Excel file with 2000 x 50 = 100K rows of data."}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1456309695, "post_id": 35598877, "comment_id": 58883713, "body": "That is what you describe in your post but it is not the exact purpose. <i>Why</i> are you doing this? I suppose it is in order to evaluate/consolidate data of sorts. Right?"}], "answers": [{"tags": [], "owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "is_accepted": true, "score": 0, "last_activity_date": 1456329428, "creation_date": 1456329428, "answer_id": 35606876, "question_id": 35598877, "link": "https://stackoverflow.com/questions/35598877/excel-loop-stops-working/35606876#35606876", "title": "Excel loop stops working", "body": "<p>Try this:</p>\n\n<ol>\n<li>Instead of copying ranges, you can simply set their value</li>\n<li>Do not use <code>Cells</code> when working with multiple sheets; always explicitely state the object/sheet whose Cells you like to address</li>\n</ol>\n\n<p>Sample that worked for me:</p>\n\n<pre><code>For Each fi In f.Files\n    If InStr(1, Right(fi.Name, 5), \".xls\") &gt; 0 Then\n\n        Set Wkb = Workbooks.Open(fi)\n        Set ws = Wkb.Sheets(1)\n\n        rowCount = ws.UsedRange.Rows.Count\n        colCount = ws.UsedRange.Columns.Count\n\n        ranString = shtDest.Cells(curRow, 1).Address &amp; \":\" &amp; shtDest.Cells(curRow + rowCount, colCount).Address\n        Set ran = ws.Range(ws.Cells(2, 1).Address, ws.Cells(rowCount, colCount).Address)\n        Set destRan = shtDest.Range(ranString)\n        destRan.Value = ran.Value\n        curRow = curRow + rowCount\n\n        Wkb.Close False\n    End If\nNext fi\n</code></pre>\n\n<p>It may look a bit long-winded building a range string first, but it made debugging easier.</p>\n"}], "owner": {"reputation": 15, "user_id": 5366931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63efd8d99f81cb5a4fe98b8e1b9f394d?s=128&d=identicon&r=PG&f=1", "display_name": "Mario", "link": "https://stackoverflow.com/users/5366931/mario"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 35606876, "answer_count": 1, "score": 0, "last_activity_date": 1456329428, "creation_date": 1456308112, "last_edit_date": 1456308387, "question_id": 35598877, "link": "https://stackoverflow.com/questions/35598877/excel-loop-stops-working", "title": "Excel loop stops working", "body": "<p>I've built an Excel Macro which takes the first sheets from all XLS files in a selected folder (including XLS files in any sub-folders) and copies the sheets onto a single sheet in a new Workbook. The code seems to work fine for the most part and I intend to use it to merge thousands of Excel sheets into a single file. </p>\n\n<p>However the problem is that the loop just stops working at some point, with no errors raised. Sometimes it's a couple of hundred files, sometimes more. But the process seems to be unreliable and I can't tell why. </p>\n\n<p>This is my code (I call the Merge macro which in turn calls the DoFolder Sub):</p>\n\n<pre><code>Sub Merge()\n    Dim FileSystem As Object\n    Dim HostFolder As String\n    HostFolder = \"C:\\XLSfiles\"\n    Set FileSystem = CreateObject(\"Scripting.FileSystemObject\")\n    DoFolder FileSystem.GetFolder(HostFolder)\nEnd Sub\nSub DoFolder(Folder)\n    Dim unusedRow As Long 'used for writing the file path info before each copied sheet\n    Dim path As String, ThisWB As String, lngFilecounter As Long\n    Dim wbDest As Workbook, shtDest As Worksheet, ws As Worksheet\n    Dim Filename As String, Wkb As Workbook\n    Dim CopyRng As Range, Dest As Range\n    Dim RowofCopySheet As Integer\n    RowofCopySheet = 2 ' Row to start on in the sheets you are copying from\n    ThisWB = ActiveWorkbook.Name\n    Set shtDest = ActiveWorkbook.Sheets(1)\n    Dim SubFolder\n        For Each SubFolder In Folder.SubFolders\n        DoFolder SubFolder\n    Next\n    Dim File\n    ActiveWindow.WindowState = xlMinimized\n    For Each File In Folder.Files\n        ' Operate on each file\n        unusedRow = Cells.SpecialCells(xlCellTypeLastCell).Offset(1, 0).Row\n        If Not Filename = ThisWB Then\n            Set Wkb = Workbooks.Open(File)\n            Set CopyRng = Wkb.Sheets(1).Range(Cells(RowofCopySheet, 1),Cells(ActiveSheet.UsedRange.Rows.Count, ActiveSheet.UsedRange.Columns.Count))\n            Set Dest = shtDest.Range(\"A\" &amp; shtDest.UsedRange.SpecialCells(xlCellTypeLastCell).Row + 1)\n            CopyRng.Copy Dest\n            Wkb.Close False\n        End If\n        Cells(unusedRow, 1) = File\n        Application.StatusBar = File\n    Next\n    Range(\"A1\").Select\nEnd Sub\n</code></pre>\n\n<p>What am I missing?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1456307394, "post_id": 35597849, "comment_id": 58882029, "body": "While I usually don&#39;t like to recommend anything that uses <a href=\"https://msdn.microsoft.com/en-us/library/office/ff197597.aspx\" rel=\"nofollow noreferrer\">.Select</a> or <a href=\"https://msdn.microsoft.com/en-us/library/office/aa221681.aspx\" rel=\"nofollow noreferrer\">.Activate</a> (see <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">this</a>), have you tried <code>My_Range.Parent.Activate</code> ? At the beginning, you <code>Set My_Range = Range(&quot;A1:CR&quot; &amp; LastRow(ActiveSheet))</code> but there is absolutely no reference to the parent worksheet."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1456307471, "post_id": 35598621, "comment_id": 58882079, "body": "Good catch! I was still trying to find out what worksheet/workbook <b>My_Range</b> belonged to. I guess by default it is the newly opened <b>WBOld</b>."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 1, "last_activity_date": 1456307386, "creation_date": 1456307386, "answer_id": 35598621, "question_id": 35597849, "link": "https://stackoverflow.com/questions/35597849/filter-copy-and-paste-into-new-wb-select-method-of-worksheet-class-failed/35598621#35598621", "title": "Filter, Copy and Paste into New WB - Select Method of Worksheet Class Failed", "body": "<p>You can't select a sheet unless that workbook is active, so add this before that line:</p>\n\n<pre><code>My_Range.Parent.Parent.Activate\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 3891493, "user_type": "registered", "profile_image": "https://graph.facebook.com/513718744/picture?type=large", "display_name": "arthurlgh90", "link": "https://stackoverflow.com/users/3891493/arthurlgh90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "accepted_answer_id": 35598621, "answer_count": 1, "score": 1, "last_activity_date": 1456307386, "creation_date": 1456305336, "last_edit_date": 1456307346, "question_id": 35597849, "link": "https://stackoverflow.com/questions/35597849/filter-copy-and-paste-into-new-wb-select-method-of-worksheet-class-failed", "title": "Filter, Copy and Paste into New WB - Select Method of Worksheet Class Failed", "body": "<p>I am new to VBA and this forum. I am trying to copy and paste filtered data from one workbook to a new workbook. I have modified the code from <a href=\"http://www.rondebruin.nl/win/s3/win006_1.htm\" rel=\"nofollow\">http://www.rondebruin.nl/win/s3/win006_1.htm</a>, which is written for the same function but within sheets.</p>\n\n<p>After modifying the code, I get the error \"1004: Select Method of Worksheet Class Failed\". I have marked out the error line with <strong>...</strong> (towards the end of the code)</p>\n\n<p>Can someone help to point out what is wrong? My code is as below:</p>\n\n<pre><code>    Sub Auto_Filter()\n    Dim My_Range As Range\n    Dim CalcMode As Long\n    Dim ViewMode As Long\n    Dim FilterCriteria As String\n    Dim CCount As Long\n    Dim WBOld As Workbook, WBNew As Workbook\n    Dim WSOld As Worksheet, WSNew As Worksheet\n    Dim WBName As String\n    Dim rng As Range\n\n    Set WBOld = Workbooks.Open(\"Users:arthurleeguanghui:Desktop:testfile.xlsm\")\n    Set WSOld = WBOld.Sheets(\"Master\")\n\n    Set My_Range = Range(\"A1:CR\" &amp; LastRow(ActiveSheet))\n    My_Range.Parent.Select\n\n    If ActiveWorkbook.ProtectStructure = True Or _\n       My_Range.Parent.ProtectContents = True Then\n        MsgBox \"Sorry, not working when the workbook or worksheet is protected\", _\n               vbOKOnly, \"Copy to new worksheet\"\n        Exit Sub\n    End If\n\n    'Change ScreenUpdating, Calculation, EnableEvents, ....\n    With Application\n        CalcMode = .Calculation\n        .Calculation = xlCalculationManual\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n    ViewMode = ActiveWindow.View\n    ActiveWindow.View = xlNormalView\n    ActiveSheet.DisplayPageBreaks = False\n\n    My_Range.Parent.AutoFilterMode = False\n\n    My_Range.AutoFilter Field:=2, Criteria1:=\"=1\"\n    My_Range.AutoFilter Field:=3, Criteria1:=\"=2\"\n    CCount = 0\n    On Error Resume Next\n    CCount = My_Range.Columns(1).SpecialCells(xlCellTypeVisible).Areas(1).Cells.Count\n    On Error GoTo 0\n    If CCount = 0 Then\n        MsgBox \"There are more than 8192 areas:\" _\n             &amp; vbNewLine &amp; \"It is not possible to copy the visible data.\" _\n             &amp; vbNewLine &amp; \"Tip: Sort your data before you use this macro.\", _\n               vbOKOnly, \"Copy to worksheet\"\n    Else\n        Set WBNew = Workbooks.Add\n        Set WSNew = WBNew.Sheets(\"Sheet1\")\n\n        WBName = InputBox(\"What is the name of the new workbook?\", _\n                             \"Name the New WB\")\n\n        My_Range.Parent.AutoFilter.Range.Copy\n        With WSNew.Range(\"A1\")\n            .PasteSpecial Paste:=8\n            .PasteSpecial xlPasteValues\n            .PasteSpecial xlPasteFormats\n            Application.CutCopyMode = False\n            .Select\n        End With\n\n    End If\n\n    With WSOld\n        My_Range.Parent.AutoFilterMode = False\n\n        'Restore ScreenUpdating, Calculation, EnableEvents, ....\n        **My_Range.Parent.Select**\n        ActiveWindow.View = ViewMode\n        If Not WSNew Is Nothing Then WSNew.Select\n\n        With Application\n            .ScreenUpdating = True\n            .EnableEvents = True\n            .Calculation = CalcMode\n        End With\n\n    End With\n\n    WBNew.SaveAs Filename:=\"Users:arthurleeguanghui:Desktop:\" &amp; WBName &amp; \".xlsx\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1456304488, "post_id": 35597417, "comment_id": 58879957, "body": "When you open the workbook it becomes active and your unqualified <code>Cells</code> calls refer to the active sheet (which is in the active workbook). Which sheet are you trying to copy from?"}, {"owner": {"reputation": 19590, "user_id": 5050667, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/3WJfP.jpg?s=128&g=1", "display_name": "Yassin Hajaj", "link": "https://stackoverflow.com/users/5050667/yassin-hajaj"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1456304978, "post_id": 35597417, "comment_id": 58880293, "body": "@Rory Hi Rory, thank you. Let&#39;s say I try to copy from &quot;Tableau.xlsx&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 2, "last_activity_date": 1456305209, "creation_date": 1456305209, "answer_id": 35597794, "question_id": 35597417, "link": "https://stackoverflow.com/questions/35597417/excel-file-does-not-get-filled-when-opened-by-vba/35597794#35597794", "title": "Excel file does not get filled when opened by VBA", "body": "<p>You need to properly qualify your <code>Cells</code> calls - for example:</p>\n\n<pre><code>Sub RemplirTableaux()\n\n    Dim FilePath$, TargetFilePath$\n    Dim wb                    As Workbook\n    Dim wsSource              As Worksheet\n    Const SheetName$ = \"Sheet1\"\n\n    FilePath = \"file.xlsx\"\n    TargetFilePath$ = \"C:\\file.xlsx\"\n\n    ' change as necessary\n    Set wsSource = Workbooks(\"Tableau.xlsx\").Sheets(\"Some sheet\")\n\n    If Not IsWorkBookOpen(TargetFilePath) Then\n        Set wb = Workbooks.Open(TargetFilePath)\n    End If\n\n    For i = 7 To 23\n\n        With wb.Sheets(\"ACs\")\n\n            If .Cells(i, \"A\").Value2 = wsSource.Cells(1, \"B\").Value2 Then\n                .Cells(i, \"B\").Value = wsSource.Cells(27, \"J\").Value\n                .Cells(i, \"C\").Value = wsSource.Cells(27, \"K\").Value\n                'Another filling statements\n            End If\n\n        End With\n\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19590, "user_id": 5050667, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/3WJfP.jpg?s=128&g=1", "display_name": "Yassin Hajaj", "link": "https://stackoverflow.com/users/5050667/yassin-hajaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 35597794, "answer_count": 1, "score": 0, "last_activity_date": 1456305209, "creation_date": 1456304091, "last_edit_date": 1456304732, "question_id": 35597417, "link": "https://stackoverflow.com/questions/35597417/excel-file-does-not-get-filled-when-opened-by-vba", "title": "Excel file does not get filled when opened by VBA", "body": "<p>I'm writing a code to open a file and fill the files cells with the source file.</p>\n\n<p>I'm encountering a problem that my second doesn't have its cells filled.</p>\n\n<p>However, when the file is already open, it works perfectly.</p>\n\n<p>I added a portion of code to make excel wait a few seconds before filling the second file but it does not work neither.</p>\n\n<p>Have you an idea?</p>\n\n<hr>\n\n<h2>Code</h2>\n\n<pre><code>Sub RemplirTableaux()\n\n    Dim FilePath$, TargetFilePath$\n    Const SheetName$ = \"Sheet1\"\n    FilePath = \"file.xlsx\"\n    TargetFilePath$ = \"C:\\file.xlsx\"\n\n    If Not IsWorkBookOpen(TargetFilePath) Then\n        Workbooks.Open (TargetFilePath)\n    End If\n\n    Application.Wait DateAdd(\"s\", 5, Now())\n\n    For i = 7 To 23\n\n        If Workbooks(FilePath).Sheets(\"ACs\").Cells(i, \"A\") = Cells(1, \"B\") Then\n\n            Workbooks(FilePath).Sheets(\"ACs\").Cells(i, \"B\").Value = Cells(27, \"J\")\n            Workbooks(FilePath).Sheets(\"ACs\").Cells(i, \"C\").Value = Cells(27, \"K\")\n            'Another filling statements\n        End If\n    Next\nEnd Sub\n\nFunction IsWorkBookOpen(FileName As String)\n    Dim ff As Long, ErrNo As Long\n\n    On Error Resume Next\n    ff = FreeFile()\n    Open FileName For Input Lock Read As #ff\n    Close ff\n    ErrNo = Err\n    On Error GoTo 0\n\n    Select Case ErrNo\n        Case 0:    IsWorkBookOpen = False\n        Case 70:   IsWorkBookOpen = True\n        Case Else: Error ErrNo\n    End Select\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "autocad"], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 557167, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4a63be38501a446613975ace3d9bbf8f?s=128&d=identicon&r=PG", "display_name": "tmccar", "link": "https://stackoverflow.com/users/557167/tmccar"}, "edited": false, "score": 0, "creation_date": 1456394422, "post_id": 35605752, "comment_id": 58929876, "body": "Yes, I should have spotted that! Thanks"}, {"owner": {"reputation": 7506, "user_id": 492, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/z4XVc.jpg?s=128&g=1", "display_name": "CAD bloke", "link": "https://stackoverflow.com/users/492/cad-bloke"}, "edited": false, "score": 0, "creation_date": 1456652128, "post_id": 35605752, "comment_id": 59039518, "body": "The <code>.Tag</code> will always be uppercase too so your code should acknowledge that, just in case there is an issue with case-sensitivity."}], "tags": [], "owner": {"reputation": 4120, "user_id": 4916074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pIJHf.jpg?s=128&g=1", "display_name": "Philippe", "link": "https://stackoverflow.com/users/4916074/philippe"}, "is_accepted": true, "score": 2, "last_activity_date": 1456326365, "creation_date": 1456326365, "answer_id": 35605752, "question_id": 35597290, "link": "https://stackoverflow.com/questions/35597290/invalid-argument-tag/35605752#35605752", "title": "Invalid argument tag", "body": "<p>Well, the error message is rather explicit, you have an \"Invalid argument Tag in setting TagString\"</p>\n\n<p>So simply get rid of space in the tag value and you should be good to go. It doesn't support spaces.</p>\n\n<pre><code>tag = \"Attribute Tag\" 'BAD\ntag = \"AttributeTag\" 'OK\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 557167, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4a63be38501a446613975ace3d9bbf8f?s=128&d=identicon&r=PG", "display_name": "tmccar", "link": "https://stackoverflow.com/users/557167/tmccar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 451, "favorite_count": 0, "accepted_answer_id": 35605752, "answer_count": 1, "score": 3, "last_activity_date": 1456326365, "creation_date": 1456303677, "question_id": 35597290, "link": "https://stackoverflow.com/questions/35597290/invalid-argument-tag", "title": "Invalid argument tag", "body": "<p>I am doing some customization of block insertion in Autocad. When setting up the attributes, I am getting an error in my procedure:</p>\n\n<p>\"Invalid argument Tag in setting TagString\"</p>\n\n<p>The code is as follows:</p>\n\n<pre><code>Sub Ch10_GettingAttributes()\n ' Create the block\n Dim blockObj As AcadBlock\n Dim insertionPnt(0 To 2) As Double\n insertionPnt(0) = 0\n insertionPnt(1) = 0\n insertionPnt(2) = 0\n Set blockObj = ThisDrawing.Blocks.Add _\n (insertionPnt, \"TESTBLOCK\")\n\n ' Define the attribute definition\n Dim attributeObj As AcadAttribute\n Dim height As Double\n Dim mode As Long\n Dim prompt As String\n Dim insertionPoint(0 To 2) As Double\n Dim tag As String\n Dim value As String\n height = 1#\n mode = acAttributeModeVerify\n prompt = \"Attribute Prompt\"\n insertionPoint(0) = 5\n insertionPoint(1) = 5\n insertionPoint(2) = 0\n tag = \"Attribute Tag\"\n value = \"Attribute Value\"\n\n ' Create the attribute definition object on the block\n Set attributeObj = blockObj.AddAttribute(height, mode,_\nprompt, insertionPoint, tag, value)\n\n End Sub\n</code></pre>\n\n<p>What would cause this error?</p>\n"}, {"tags": ["excel", "vba", "charts", "formatting", "powerpoint"], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 5914446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18001a692d470099258f80b61f096693?s=128&d=identicon&r=PG&f=1", "display_name": "aib765", "link": "https://stackoverflow.com/users/5914446/aib765"}, "is_accepted": false, "score": 0, "last_activity_date": 1456843456, "creation_date": 1456843456, "answer_id": 35725891, "question_id": 35597102, "link": "https://stackoverflow.com/questions/35597102/vba-keep-source-formatting-when-pasting-charts-from-excel-to-powerpoint/35725891#35725891", "title": "VBA - Keep source formatting when pasting charts from Excel to PowerPoint", "body": "<p>It isn't a perfect solution, I don't think it's very clean, but at least it works :</p>\n\n<p>In order to keep source formatting for ALL my charts, I have to regularly use the second method mentioned in my above post, and not once at the beginning of my code as I did first.\nIt seems that its effects only remain valid for a limited amount of time (don't know why) - which explains the \"random behaviour\" I described.</p>\n\n<p>I would have liked to find a better method but so far that's all I have !</p>\n"}], "owner": {"reputation": 33, "user_id": 5914446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18001a692d470099258f80b61f096693?s=128&d=identicon&r=PG&f=1", "display_name": "aib765", "link": "https://stackoverflow.com/users/5914446/aib765"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1283, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1456843456, "creation_date": 1456303088, "question_id": 35597102, "link": "https://stackoverflow.com/questions/35597102/vba-keep-source-formatting-when-pasting-charts-from-excel-to-powerpoint", "title": "VBA - Keep source formatting when pasting charts from Excel to PowerPoint", "body": "<p>I want to copy-paste some charts located in an Excel workbook into PowerPoint slides using VBA. This part is easy, but I would also like to keep source formatting (= Excel formatting).</p>\n\n<p>1) I first used this kind of basic code :</p>\n\n<pre><code>Worksheets(\"DailyActivityGeneral\").ChartObjects(\"Chart 3\").Copy\nSet chartGen3 = prsntPP.Slides(16).Shapes.Paste\n</code></pre>\n\n<p>It worked fine except for the formatting, which isn't kept.</p>\n\n<p>2) I then tried to use another method:</p>\n\n<pre><code>Worksheets(\"DailyActivityGeneral\").ChartObjects(\"Chart 3\").Copy\nprsntPP.Slides(16).Select\nprsntPP.Application.CommandBars.ExecuteMso (\"PasteExcelChartSourceFormatting\")\nprsntPP.Application.CommandBars.ReleaseFocus\n</code></pre>\n\n<p>This keeps the source formatting, which is great, but I cannot seem to be able to write:</p>\n\n<pre><code>set chartGen3 = prsntPP.Application.CommandBars.ExecuteMso (\"PasteExcelChartSourceFormatting\")\n</code></pre>\n\n<p>(I get an error message)\nThe problem is that I don't know how to manipulate the pasted chart (which is possible with the \"chartGen3\" like in the first method). Any idea about how to deal with the pasted chart ? This would probably solve my problem !</p>\n\n<p>3) I noticed that when I use the second method once at the beginning of my code, (almost) all copy-paste actions now keep source formatting, even if they are written with the first syntax. So the best solution I've found, to be both able to handle my pasted chart and keep its source formatting, is to first use the second method, delete the slide because the chart cannot be manipulated, and then use the first method with all other slides. </p>\n\n<p>But I have a last problem: It keeps source formatting as expected, but for unknown reasons, sometimes, it doesn't (random behaviour !)</p>\n\n<p>How would you proceed to keep source formatting when copying charts from Excel to PowerPoint ?</p>\n\n<p>Thanks !</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 7889, "user_id": 1911064, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/F8Vxe.jpg?s=128&g=1", "display_name": "Axel Kemper", "link": "https://stackoverflow.com/users/1911064/axel-kemper"}, "edited": false, "score": 0, "creation_date": 1456303130, "post_id": 35596863, "comment_id": 58879101, "body": "Have a look at <a href=\"http://stackoverflow.com/a/22325055/1911064\">this answer</a>."}, {"owner": {"reputation": 25, "user_id": 5635117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fcb98f604194d9f94f9f097f89d11f0?s=128&d=identicon&r=PG&f=1", "display_name": "kumaran", "link": "https://stackoverflow.com/users/5635117/kumaran"}, "reply_to_user": {"reputation": 7889, "user_id": 1911064, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/F8Vxe.jpg?s=128&g=1", "display_name": "Axel Kemper", "link": "https://stackoverflow.com/users/1911064/axel-kemper"}, "edited": false, "score": 0, "creation_date": 1456303891, "post_id": 35596863, "comment_id": 58879565, "body": "Thank&#39;s Axel. It&#39;s working"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1456305282, "post_id": 35596863, "comment_id": 58880510, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/22324699/excel-vba-how-do-i-clear-the-clipboard-on-another-workbook-in-another-applicat\">Excel VBA - How do I clear the clipboard on another workbook in another application?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1362, "user_id": 4910205, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wz5LG.jpg?s=128&g=1", "display_name": "Brendan Gooden", "link": "https://stackoverflow.com/users/4910205/brendan-gooden"}, "is_accepted": true, "score": 0, "last_activity_date": 1456308140, "creation_date": 1456308140, "answer_id": 35598893, "question_id": 35596863, "link": "https://stackoverflow.com/questions/35596863/how-to-clear-clipboard-content-from-word-vba/35598893#35598893", "title": "how to clear clipboard content from word vba?", "body": "<p>Use this to clear the clipboard and stop the clipboard message.</p>\n\n<pre><code>Application.CutCopyMode = False\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5635117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fcb98f604194d9f94f9f097f89d11f0?s=128&d=identicon&r=PG&f=1", "display_name": "kumaran", "link": "https://stackoverflow.com/users/5635117/kumaran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1947, "favorite_count": 0, "accepted_answer_id": 35598893, "answer_count": 1, "score": 1, "last_activity_date": 1456308140, "creation_date": 1456302373, "question_id": 35596863, "link": "https://stackoverflow.com/questions/35596863/how-to-clear-clipboard-content-from-word-vba", "title": "how to clear clipboard content from word vba?", "body": "<p>I'm working with VBA on ms Word.It run the word document copy the content to paste other document then process.After the finished process when closing the document display \"large amount of text\" warning.How do i over come this help me\nany one.</p>\n\n<pre><code>ActiveDocument.Save\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\nActiveDocument.Close\nApplication.Quit\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5721973"}, "edited": false, "score": 0, "creation_date": 1456301925, "post_id": 35596678, "comment_id": 58878396, "body": "Well you aren&#39;t as that code isn&#39;t legal as there is no <code>)</code>. Your way is clear and as good as any other way."}, {"owner": {"reputation": 8489, "user_id": 5452365, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/MezjT.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5452365/rahul"}, "edited": false, "score": 0, "creation_date": 1456305031, "post_id": 35596678, "comment_id": 58880330, "body": "Just forgot. Added. You could&#39;ve added that."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5721973"}, "edited": false, "score": 1, "creation_date": 1456306222, "post_id": 35596678, "comment_id": 58881161, "body": "The aim is clear code that makes clear what it is doing. Your way is great."}], "answers": [{"comments": [{"owner": {"reputation": 8489, "user_id": 5452365, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/MezjT.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5452365/rahul"}, "edited": false, "score": 0, "creation_date": 1456304401, "post_id": 35596890, "comment_id": 58879887, "body": "Better means less CPU Power and less lines. Any way This looks only solution right now."}], "tags": [], "owner": {"reputation": 56, "user_id": 5948825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8bee502f3d60cf657f2dfce26f052b4?s=128&d=identicon&r=PG&f=1", "display_name": "NJ.Lin", "link": "https://stackoverflow.com/users/5948825/nj-lin"}, "is_accepted": true, "score": 2, "last_activity_date": 1456302469, "creation_date": 1456302469, "answer_id": 35596890, "question_id": 35596678, "link": "https://stackoverflow.com/questions/35596678/how-to-replace-multiple-string-at-a-time/35596890#35596890", "title": "How to replace multiple string at a time", "body": "<p>Try this</p>\n\n<pre><code>Dim mLBound As Long\nDim mUBound As Long\nDim mSize As Long\nDim result As String\nDim RepChars As Variant\n\nRepChars = Array(\"a\", \"b\", \"c\")\n\nmLBound = LBound(RepChars)\nmUBound = UBound(RepChars)\n\nresult = Range(\"A2\").Value\n\nFor mSize = mLBound To mUBound\n    result = Replace(result, CStr(RepChars(mSize)), \"\")\nNext\n\nRange(\"A3\").Value = result\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "is_accepted": false, "score": 1, "last_activity_date": 1456306022, "last_edit_date": 1495541277, "creation_date": 1456306022, "answer_id": 35598117, "question_id": 35596678, "link": "https://stackoverflow.com/questions/35596678/how-to-replace-multiple-string-at-a-time/35598117#35598117", "title": "How to replace multiple string at a time", "body": "<p>Or the Regex could be used. Example based on <a href=\"https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\">this answer</a>.</p>\n\n<pre><code>Option Explicit\n\nSub ReplaceWithRegex()\n    Dim strPattern As String\n    Dim strReplace As String\n    Dim regEx As Variant\n    Dim strtxt As String\n\n    Set regEx = CreateObject(\"vbscript.regexp\")\n    strtxt = \"String1.String2.String3.String4.String5.String6.String7.String77\"\n    strPattern = \"(String.)\" ' (String\\d+) for replacing e.g. 'String77' etc.\n    strReplace = \"\"\n\n    With regEx\n        .Global = True\n        .MultiLine = True\n        .IgnoreCase = False\n        .Pattern = strPattern\n    End With\n\n    If regEx.Test(strtxt) Then\n        Debug.Print regEx.Replace(strtxt, strReplace)\n    Else\n        MsgBox (\"Not matched\")\n    End If\nEnd Sub\n</code></pre>\n\n<p><a href=\"http://regexr.com/3csa0\" rel=\"nofollow noreferrer\">regexr</a></p>\n"}, {"comments": [{"owner": {"reputation": 8489, "user_id": 5452365, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/MezjT.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5452365/rahul"}, "edited": false, "score": 0, "creation_date": 1458194456, "post_id": 35600441, "comment_id": 59753210, "body": "I think there some mistake by SO. didn&#39;t receive notification of this answer."}], "tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": false, "score": 1, "last_activity_date": 1456312124, "creation_date": 1456312124, "answer_id": 35600441, "question_id": 35596678, "link": "https://stackoverflow.com/questions/35596678/how-to-replace-multiple-string-at-a-time/35600441#35600441", "title": "How to replace multiple string at a time", "body": "<p>One way:</p>\n\n<pre><code>Function RemoveTokens(target As String, ParamArray tokens() As Variant) As String\n    Dim i As Long\n    For i = 0 To UBound(tokens)\n        target = Replace$(target, tokens(i), \"\")\n    Next\n    RemoveTokens = target\nEnd Function\n</code></pre>\n\n<hr>\n\n<pre><code>?RemoveTokens(\"AA BB CC DD EE\", \"BB\")\nAA  CC DD EE\n\n?RemoveTokens(\"AA BB CC DD EE\", \"BB\", \"EE\", \"AA\")\n  CC DD \n</code></pre>\n"}], "owner": {"reputation": 8489, "user_id": 5452365, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/MezjT.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5452365/rahul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1099, "favorite_count": 0, "accepted_answer_id": 35596890, "answer_count": 3, "score": 2, "last_activity_date": 1456316035, "creation_date": 1456301732, "last_edit_date": 1456316035, "question_id": 35596678, "link": "https://stackoverflow.com/questions/35596678/how-to-replace-multiple-string-at-a-time", "title": "How to replace multiple string at a time", "body": "<p>I am using following codes repeatedly. Is there any better alternative.</p>\n\n<pre><code>Dim strtxt as string\nstrtxt = Replace(strtxt, \"String1\", \"\")\nstrtxt = Replace(strtxt, \"String2\", \"\")\nstrtxt = Replace(strtxt, \"String3\", \"\")\nstrtxt = Replace(strtxt, \"String4\", \"\")\nstrtxt = Replace(strtxt, \"String5\", \"\")\nstrtxt = Replace(strtxt, \"String6\", \"\")\nstrtxt = Replace(strtxt, \"String7\", \"\")\n</code></pre>\n"}, {"tags": ["excel", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 19, "user_id": 5515918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cff8634c4c468fb6dc389a7c8d6ea699?s=128&d=identicon&r=PG&f=1", "display_name": "shanyh", "link": "https://stackoverflow.com/users/5515918/shanyh"}, "edited": false, "score": 0, "creation_date": 1456304578, "post_id": 35596370, "comment_id": 58880014, "body": "I don&#39;t think that I explained myself as good as I though. I have a column of over 6700+ cells and I want to split it to different column every time there&#39;s a cell with all text inside it (without numbers)."}], "answers": [{"tags": [], "owner": {"reputation": 216, "user_id": 5045578, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9-VygvgDnJY/AAAAAAAAAAI/AAAAAAAAEi4/-NYkWDu8Zek/photo.jpg?sz=128", "display_name": "Michal Schmitt", "link": "https://stackoverflow.com/users/5045578/michal-schmitt"}, "is_accepted": false, "score": 0, "last_activity_date": 1456327884, "creation_date": 1456327884, "answer_id": 35606242, "question_id": 35596370, "link": "https://stackoverflow.com/questions/35596370/excel-function-or-macro-to-split-a-column-to-rows/35606242#35606242", "title": "excel function or macro to split a column to rows", "body": "<p>This code takes your single column and breaks it up into multiple columns at each text header.</p>\n\n<p>Assumptions:</p>\n\n<ul>\n<li><p>The left character of each non-header cell is a number.</p>\n\n<pre><code>lastRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nfrst = 1\nj = 2\n\nFor i = 2 To lastRow + 1\n    If Not IsNumeric(Left(Cells(i, 1).Value, 1)) Then\n        Range(Cells(frst, 1), Cells(i - 1, 1)).Copy\n        Range(Cells(1, j), Cells(i - frst - 1, j)).PasteSpecial\n\n        frst = i\n        j = j + 1\n    End If\nNext i\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 19, "user_id": 5515918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cff8634c4c468fb6dc389a7c8d6ea699?s=128&d=identicon&r=PG&f=1", "display_name": "shanyh", "link": "https://stackoverflow.com/users/5515918/shanyh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1462526487, "creation_date": 1456300765, "last_edit_date": 1531161705, "question_id": 35596370, "link": "https://stackoverflow.com/questions/35596370/excel-function-or-macro-to-split-a-column-to-rows", "title": "excel function or macro to split a column to rows", "body": "<p>I would like to split a column to a new columns as followed:</p>\n\n<p><a href=\"http://i.stack.imgur.com/azZM1.png\" rel=\"nofollow\">http://i.stack.imgur.com/azZM1.png</a></p>\n\n<p>As you can see the split takes place whan there's a all text cell, and between those cells I don't always have the same number of cells.\nCan I do that in a function or macro?</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 129, "user_id": 5422778, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fe13b488fe52181a97dd0d6a0f10f149?s=128&d=identicon&r=PG&f=1", "display_name": "Big_Papa_B", "link": "https://stackoverflow.com/users/5422778/big-papa-b"}, "edited": false, "score": 0, "creation_date": 1456304910, "post_id": 35596751, "comment_id": 58880235, "body": "Hello, thank you so much for the above I have applied the following:  =NETWORKDAYS.INTL(D2, E2,1,1)-(TIMEVALUE(TEXT(E2,&quot;hh:mm&quot;))&gt;TIMEVALUE(TEXT(D2,&quot;hh:m&zwnj;&#8203;m&quot;)))+(TIMEVALUE(TEX&zwnj;&#8203;T(E2,&quot;hh:mm&quot;))-TIMEV&zwnj;&#8203;ALUE(TEXT(D2,&quot;hh:mm&quot;&zwnj;&#8203;)))  Which works perfectly for any request that took over 1 day to process, however is a request took 0 days and 17 hours the formula is reflecting it as haven taken 1 day and 17 hours"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 129, "user_id": 5422778, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fe13b488fe52181a97dd0d6a0f10f149?s=128&d=identicon&r=PG&f=1", "display_name": "Big_Papa_B", "link": "https://stackoverflow.com/users/5422778/big-papa-b"}, "edited": false, "score": 0, "creation_date": 1456305967, "post_id": 35596751, "comment_id": 58880968, "body": "Yes, this is one of the problem when a question has no sample data together with expected results (and I do not retype data from image(s)). A little maths with a boolean condition should sort it out. I may look at this later but you might want to give it a try yourself."}, {"owner": {"reputation": 129, "user_id": 5422778, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fe13b488fe52181a97dd0d6a0f10f149?s=128&d=identicon&r=PG&f=1", "display_name": "Big_Papa_B", "link": "https://stackoverflow.com/users/5422778/big-papa-b"}, "edited": false, "score": 0, "creation_date": 1456312010, "post_id": 35596751, "comment_id": 58885389, "body": "Hello, thank you for looking, I have added more information above"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1456313311, "last_edit_date": 1456313311, "creation_date": 1456301980, "answer_id": 35596751, "question_id": 35596183, "link": "https://stackoverflow.com/questions/35596183/calculate-time-taken-to-process-with-network-days/35596751#35596751", "title": "Calculate Time taken to process with network days", "body": "<p>Try to use the <a href=\"https://support.office.com/en-us/article/NETWORKDAYS-INTL-function-A9B26239-4F20-46A1-9AB8-4E925BFD5E28\" rel=\"nofollow noreferrer\">NETWORKDAYS.INTL\u00b9 function</a> instead of the older <a href=\"https://support.office.com/en-us/article/NETWORKDAYS-function-48E717BF-A7A3-495F-969E-5005E3EB18E7\" rel=\"nofollow noreferrer\">NETWORKDAYS function</a>. While the additional functionality is not particularly needed here, it is good practise to get familiar with using one function rather than different versions of the same thing.</p>\n\n<p>In C2 as a standard formula,</p>\n\n<pre><code>=NETWORKDAYS.INTL(A2, B2,1, Z2:Z9)-1+\n     (TIMEVALUE(TEXT(B2,\"hh:mm\"))-TIMEVALUE(TEXT(A2,\"hh:mm\")))\n</code></pre>\n\n<p>Format the C2 cell with a custom number format of <code>d \\d\\a\\y\\s h \\hou\\r\\s m \\mi\\nut\\e\\s</code>. This leaves the raw underlying value available for further calculation.</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/uZWEz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uZWEz.png\" alt=\"networkdays_intl_elapsed\"></a></p>\n\n<hr>\n\n<p>\u00b9 <sub>The <a href=\"https://support.office.com/en-us/article/NETWORKDAYS-INTL-function-A9B26239-4F20-46A1-9AB8-4E925BFD5E28\" rel=\"nofollow noreferrer\">NETWORKDAYS.INTL</a> function was introduced with Excel 2010. It is not available in earlier versions.</sub></p>\n"}], "owner": {"reputation": 129, "user_id": 5422778, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fe13b488fe52181a97dd0d6a0f10f149?s=128&d=identicon&r=PG&f=1", "display_name": "Big_Papa_B", "link": "https://stackoverflow.com/users/5422778/big-papa-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1603, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1456313311, "creation_date": 1456300101, "last_edit_date": 1456312085, "question_id": 35596183, "link": "https://stackoverflow.com/questions/35596183/calculate-time-taken-to-process-with-network-days", "title": "Calculate Time taken to process with network days", "body": "<p>I am looking for some assistance in calculating the time taken between 2 dates and times to only look at weekdays.</p>\n\n<p>The date/time I will be using is in the following format:</p>\n\n<pre><code>30/10/15 08:00:00\n</code></pre>\n\n<p>Date 1 will be in column D and date 2 will be in column E</p>\n\n<p>The formula I have applied looks as follows:</p>\n\n<pre><code>=INT(E2-D2)&amp;\" Days \"&amp;HOUR(MOD(E2-D2,1))&amp;\" Hour \"&amp;MINUTE(MOD(E2-D2,1))&amp;\" Minutes\"\n</code></pre>\n\n<p>I am looking to update this formula so it only works on weekdays via the networkdays function but am unsure how to apply within the above formula.</p>\n\n<p>The issue is requests that come in on a Friday and processed on Monday are reflecting 3 days to process, the ideal situation is the calculation would only reflect 1 day and excludes weekends.</p>\n\n<p>The spreadsheet should look as follows:</p>\n\n<p><a href=\"https://i.stack.imgur.com/brAAa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/brAAa.png\" alt=\"enter image description here\"></a></p>\n\n<p>Data for the cells are:</p>\n\n<pre><code>Date/time approved:\n\n02/02/16 08:00:00\n03/02/16 08:00:00\n03/02/16 08:00:00\n03/02/16 08:00:00\n03/02/16 15:00:00\n03/02/16 15:00:00\n03/02/16 15:00:00\n03/02/16 15:00:00\n03/02/16 15:00:00\n03/02/16 15:00:00\n03/02/16 15:00:00\n03/02/16 15:00:00\n01/02/16 08:00:00\n\nDate/time Completed\n\n04/02/16 10:30:00\n04/02/16 07:40:00\n04/02/16 07:55:00\n04/02/16 07:19:00\n04/02/16 12:22:00\n04/02/16 12:22:00\n04/02/16 12:22:00\n05/02/16 06:45:00\n05/02/16 06:35:00\n05/02/16 06:01:00\n05/02/16 06:01:00\n05/02/16 06:01:00\n01/02/16 10:23:00\n</code></pre>\n\n<p>Column F should show the time taken to process excluding weekends</p>\n\n<p>And column G will have a Boolean of: <code>IF(E2-D2 &lt;= 1, \"Y\", \"N\")</code></p>\n\n<p>And column H will have a Boolean of: <code>IF(E2-D2 &lt;= 2, \"Y\", \"N\")</code></p>\n\n<p>Which will calculate if SLA has been met or not</p>\n"}, {"tags": ["vba", "catia"], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 2004053, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/0f19b00ae01bde7f880808ec01fb5659?s=128&d=identicon&r=PG", "display_name": "tsolina", "link": "https://stackoverflow.com/users/2004053/tsolina"}, "edited": false, "score": 0, "creation_date": 1459241258, "post_id": 35596990, "comment_id": 60185281, "body": "its important to add, if you use it as If allBodies.Item(i).InBooleanOperation Then, it will be true for all checks after first positive answer"}], "tags": [], "owner": {"reputation": 1582, "user_id": 3469288, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/roW8F.png?s=128&g=1", "display_name": "SilentCry", "link": "https://stackoverflow.com/users/3469288/silentcry"}, "is_accepted": true, "score": 0, "last_activity_date": 1456302765, "creation_date": 1456302765, "answer_id": 35596990, "question_id": 35595813, "link": "https://stackoverflow.com/questions/35595813/how-to-get-only-root-level-bodies/35596990#35596990", "title": "How to get only root level bodies", "body": "<p>Finally I got the answer:</p>\n\n<pre><code>Dim objPart As part\nDim objBodies As Bodies\ndim rootBodiesCount as Integer\nSet objPart = CATIA.ActiveDocument.part\nSet objBodies = objPart.Bodies\nrootBodiesCount = getRootBodiesCount(objBodies)\n\nFunction getRootBodiesCount(allBodies as Bodies) As Integer\n  getRootBodiesCount = 0\n  For i = 1 To allBodies.Count\n    Dim inBool As Boolean: inBool = allBodies.Item(i).InVooleanOperation\n    Dim visibility As Boolean: visibility = allBodies.Item(i).Visible\n    If inBool = False Then\n      If visibility Then getRootBodiesCount = getRootBodiesCount + 1\n    End If\n  Next\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1582, "user_id": 3469288, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/roW8F.png?s=128&g=1", "display_name": "SilentCry", "link": "https://stackoverflow.com/users/3469288/silentcry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 553, "favorite_count": 0, "accepted_answer_id": 35596990, "answer_count": 1, "score": 0, "last_activity_date": 1456302765, "creation_date": 1456298833, "question_id": 35595813, "link": "https://stackoverflow.com/questions/35595813/how-to-get-only-root-level-bodies", "title": "How to get only root level bodies", "body": "<p>do you have any suggestion how to select only bodies which are visible and in-root of part? For example i wish to get selected only Lens - Outer Headlamp - LH - Clear and Lens - Outer Headlamp - LH - Black from this structure:</p>\n\n<p><a href=\"https://i.stack.imgur.com/0i7D0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0i7D0.png\" alt=\"enter image description here\"></a></p>\n\n<p>I tried </p>\n\n<pre><code>Dim objPart As part\nDim objBodies As Bodies\nSet objPart = CATIA.ActiveDocument.part\nSet objBodies = objPart.Bodies\n</code></pre>\n\n<p>and value by objBodies.Count is 113, so i tried it by Search command directly in Catia and I'm not able to get only that two bodies. Do you have any ideas?</p>\n"}, {"tags": ["vba", "excel", "amortization"], "answers": [{"tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 0, "last_activity_date": 1456329848, "creation_date": 1456329848, "answer_id": 35607053, "question_id": 35595552, "link": "https://stackoverflow.com/questions/35595552/how-to-check-cell-value-to-change-value-of-another/35607053#35607053", "title": "How to check cell value to change value of another?", "body": "<p>Working under the assumption, based on your example, that the last row will always contain your last payment, you can just make a quick check on the values and fill in the final payment amount:</p>\n\n\n\n<pre><code>Option Explicit\n\nSub Example1()\n    Dim ws As Worksheet\n    Dim lastRow As Long\n    Dim begBalColumn As Long\n    Dim schedPayColumn As Long\n    Dim interestColumn As Long\n    Dim endBalColumn As Long\n\n    '--- you can automatically set these values if needed\n    begBalColumn = 3\n    schedPayColumn = 4\n    interestColumn = 6\n    endBalColumn = 7\n\n    '--- assumes the last row has your last payment\n    Set ws = ActiveSheet\n    lastRow = ws.Range(\"A\" &amp; ws.Rows.Count).End(xlUp).Row\n\n    With ws\n        If .Cells(lastRow, begBalColumn).Value &lt; _\n               .Cells(lastRow - 1, schedPayColumn).Value Then\n            .Cells(lastRow, schedPayColumn).Value = .Cells(lastRow, begBalColumn).Value + _\n                                                    .Cells(lastRow, interestColumn).Value\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<p>Otherwise, it's not immediately apparent why you're needing to scan all the rows in your amortization table to find the last row.</p>\n\n<p>Alternatively, you can also use a formula in cell <code>G5</code> in your example:</p>\n\n<pre><code>=IF(C5&lt;D4,C5+F5,D4)\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5972822, "user_type": "registered", "profile_image": "https://graph.facebook.com/964098140333406/picture?type=large", "display_name": "Mohammed Alamoudi", "link": "https://stackoverflow.com/users/5972822/mohammed-alamoudi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 460, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1612017120, "creation_date": 1456297905, "last_edit_date": 1612017120, "question_id": 35595552, "link": "https://stackoverflow.com/questions/35595552/how-to-check-cell-value-to-change-value-of-another", "title": "How to check cell value to change value of another?", "body": "<p>I am working on a loan amortization project.</p>\n<p>The loan is amortized over a period of time. Let's say 20 years which has 239 payment lines.</p>\n<p>The last row which is generated automatically via an if formula needs some Reconciliations<br />\n<a href=\"https://i.stack.imgur.com/rIYpM.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rIYpM.jpg\" alt=\"enter image description here\" /></a></p>\n<p>As long as the last scheduled payment is less than the actual payment which is 6309 then the scheduled payment should equal 2711 + 4<br />\n<a href=\"https://i.stack.imgur.com/QAZ9M.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QAZ9M.jpg\" alt=\"enter image description here\" /></a></p>\n<p>I have been trying to edit this code.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub CommandButton23_Click()\n\n    Dim r1, r2, n As Long\n    Dim Pay_Num As Integer, result As String\n    Pay_Num = Range(&quot;D34&quot;).Value\n        \n    With Sheets(&quot;LOANQUIC &amp; Schedule Table&quot;) '~~&gt; change to suit\n        Dim lrow As Long\n        Number_of_Payments = Range(&quot;G20&quot;).Value\n        lrow = .Range(&quot;A&quot; &amp; .Rows.Count).End(xlUp).Row\n        r1 = Application.Transpose(.Range(&quot;A2:A&quot; &amp; lrow))\n        r2 = Application.Transpose(.Range(&quot;J2:J&quot; &amp; lrow))\n        For n = LBound(r1) To UBound(r1)\n            If r1(n) &lt;&gt; &quot;&quot; Then r2(n) = r1(n)\n            If r1(n) = Number_of_Payments Then Sched_Pay = Number_of_Payments\n            Range(&quot;D35&quot;).Value = Sched_Pay\n        Next\n        .Range(&quot;J2:J&quot; &amp; lrow) = Application.Transpose(r2)\n    End With\n    \nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "loops", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user586399"}, "edited": false, "score": 0, "creation_date": 1456298124, "post_id": 35595481, "comment_id": 58876496, "body": "This depends on when you want to stop looping. Keep your code as you show, but just set <code>StopTimer = True</code> when you want to stop looping."}, {"owner": {"reputation": 3913, "user_id": 3946482, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lVkJs.jpg?s=128&g=1", "display_name": "plaidshirt", "link": "https://stackoverflow.com/users/3946482/plaidshirt"}, "edited": false, "score": 0, "creation_date": 1456299350, "post_id": 35595481, "comment_id": 58877095, "body": "<code>EndTime - Now = 0</code> could be correct in a condition, that set variable to <code>TRUE</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 3913, "user_id": 3946482, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lVkJs.jpg?s=128&g=1", "display_name": "plaidshirt", "link": "https://stackoverflow.com/users/3946482/plaidshirt"}, "edited": false, "score": 0, "creation_date": 1456300084, "post_id": 35596044, "comment_id": 58877444, "body": "I see, it is really simple! Thanks!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user586399"}, "is_accepted": true, "score": 1, "last_activity_date": 1456302485, "last_edit_date": 1456302485, "creation_date": 1456299623, "answer_id": 35596044, "question_id": 35595481, "link": "https://stackoverflow.com/questions/35595481/loop-stop-condition/35596044#35596044", "title": "Loop stop condition", "body": "<pre><code>Sub Countdown()\n  Const Seconds = 10\n  Dim EndTime As Double\n  EndTime = Now + TimeSerial(0, 0, Seconds)\n  StopTimer = False\n  Do\n    If EndTime - Now &lt;= 0 Then\n      StopTimer = True\n    End If\n    Range(\"A1\") = EndTime - Now\n    DoEvents\n  Loop Until StopTimer\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3913, "user_id": 3946482, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lVkJs.jpg?s=128&g=1", "display_name": "plaidshirt", "link": "https://stackoverflow.com/users/3946482/plaidshirt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 35596044, "answer_count": 1, "score": 0, "last_activity_date": 1456302485, "creation_date": 1456297680, "last_edit_date": 1531164843, "question_id": 35595481, "link": "https://stackoverflow.com/questions/35595481/loop-stop-condition", "title": "Loop stop condition", "body": "<p>I have a countdown macro with start and stop button. I would like to fix stop time, so when counter is zero, it shouldn't start again, so <code>Loop Until StopTimer</code> should be replaced. I tried <code>EndTime - Now = 0</code> as condition, but it isn't working.</p>\n\n<pre><code>Sub Countdown()\n  Const Seconds = 10\n  Dim EndTime As Double\n  StopTimer = False\n  Do\n    If EndTime - Now &lt; 0 Then\n      EndTime = Now + TimeSerial(0, 0, Seconds)\n    End If\n    Range(\"A1\") = EndTime - Now\n    DoEvents\n  Loop Until StopTimer\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "xmlhttprequest"], "answers": [{"comments": [{"owner": {"reputation": 2827, "user_id": 4050261, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Ax2IC.jpg?s=128&g=1", "display_name": "Adarsh Madrecha", "link": "https://stackoverflow.com/users/4050261/adarsh-madrecha"}, "edited": false, "score": 0, "creation_date": 1456337215, "post_id": 35605033, "comment_id": 58903720, "body": "Considering your answer, I tried shifting all the <code>if</code> to before <code>reader.send</code>. But now I am getting 0"}, {"owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "reply_to_user": {"reputation": 2827, "user_id": 4050261, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Ax2IC.jpg?s=128&g=1", "display_name": "Adarsh Madrecha", "link": "https://stackoverflow.com/users/4050261/adarsh-madrecha"}, "edited": false, "score": 0, "creation_date": 1456337747, "post_id": 35605033, "comment_id": 58904013, "body": "Which should tell you that it goes from uninitialized to completed instantaneously.  I don&#39;t think you can actually do whatever it is you&#39;re trying to accomplish, or at least not in the manner you&#39;re attempting."}, {"owner": {"reputation": 2827, "user_id": 4050261, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Ax2IC.jpg?s=128&g=1", "display_name": "Adarsh Madrecha", "link": "https://stackoverflow.com/users/4050261/adarsh-madrecha"}, "edited": false, "score": 0, "creation_date": 1456337876, "post_id": 35605033, "comment_id": 58904086, "body": "I looked up some more information, from googling the IXMLHTTP. I found new property <code>onStatusChange</code>. Any Idea as to how we can implement this"}], "tags": [], "owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "is_accepted": false, "score": 0, "last_activity_date": 1456324559, "creation_date": 1456324559, "answer_id": 35605033, "question_id": 35595437, "link": "https://stackoverflow.com/questions/35595437/show-progress-of-http-request-in-ms-access/35605033#35605033", "title": "Show progress of HTTP Request in MS Access", "body": "<p>Unless you're missing some code or I'm misunderstanding, you're already using reader.send <em>prior</em> to checking the ReadyState.  It's always going to come back as Completed, unless it encounters a fatal error (and even then it may come back as Completed).   </p>\n"}], "owner": {"reputation": 2827, "user_id": 4050261, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Ax2IC.jpg?s=128&g=1", "display_name": "Adarsh Madrecha", "link": "https://stackoverflow.com/users/4050261/adarsh-madrecha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 583, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1456324559, "creation_date": 1456297523, "question_id": 35595437, "link": "https://stackoverflow.com/questions/35595437/show-progress-of-http-request-in-ms-access", "title": "Show progress of HTTP Request in MS Access", "body": "<p>I am using the below code, to get data from API and add data to table. I want to show the users the progress of the API Request Made. Hence using If to get the status of the request using <code>readyState Property (IXMLHTTPRequest)</code></p>\n\n<p>Problem - </p>\n\n<p>When this function is called, I just get one msgbox with 4.\nWhat am I missing??</p>\n\n<pre><code>Option Compare Database\n\nDim ApiUrl As String\nDim reader As New XMLHTTP60\nDim coll As Collection\nDim Json As New clsJSONParser\n\nPublic Sub ApiInitalisation()\n    ApiUrl = \"http://private-anon-73376961e-countingappapi.apiary-mock.com/\"\nEnd Sub\n\nPublic Sub GetPerson()\nOn Error GoTo cmdLogIn_Click_Err\n\n    'For API\n    Dim db As DAO.Database\n    Dim rs As DAO.Recordset\n    Dim contact As Variant\n\n    Api.ApiInitalisation\n    ApiUrl = ApiUrl &amp; \"users/5428a72c86abcdee98b7e359\"\n\n    reader.Open \"GET\", ApiUrl, False\n    'reader.setRequestHeader \"Accept\", \"application/json\"\n    reader.send\n\n    'Temporay variable to store the response\n    Dim egTran As String\n</code></pre>\n\n<p><strong>Relevant Code Start</strong> </p>\n\n<pre><code>    If reader.ReadyState = 0 Then\n    MsgBox (0)\n    End If\n\n    If reader.ReadyState = 1 Then\n    MsgBox (1)\n    End If\n\n    If reader.ReadyState = 2 Then\n    MsgBox (2)\n    End If\n\n    If reader.ReadyState = 3 Then\n    MsgBox (3)\n    End If\n\n    If reader.ReadyState = 4 Then\n    MsgBox (4)\n    End If\n\n\n    '-------------\n    ' Why is this code required?\n    ' Not yet found answer\n\n    'Do Until reader.ReadyState = 4\n    '   DoEvents\n    'Loop\n    '-------------------\n</code></pre>\n\n<p><strong>Relevant Code End</strong> </p>\n\n<pre><code>    ' Add data to Table\n    If reader.Status = 200 Then\n        Set db = CurrentDb\n        Set rs = db.OpenRecordset(\"tblPerson\", dbOpenDynaset, dbSeeChanges)\n\n        egTran = \"[\" &amp; reader.responseText &amp; \"]\"\n        Set coll = Json.parse(egTran)\n\n        For Each contact In coll\n            rs.AddNew\n            rs!FName = contact.Item(\"name\")\n            rs!Mobile = contact.Item(\"phoneNumber\")\n            rs!UserID = contact.Item(\"deviceId\")\n            rs!SID = contact.Item(\"_id\")\n            rs.Update\n        Next\n\n    Else\n        MsgBox \"Unable to import data.\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p><em>As per <a href=\"https://msdn.microsoft.com/en-us/library/ms753800%28v=vs.85%29.aspx\" rel=\"nofollow\">Microsoft documentation</a></em> </p>\n\n<p>0 (UNINITIALIZED) = </p>\n\n<p>The object has been created, but not initialized (the open method has not been called).</p>\n\n<p>(1) LOADING =   </p>\n\n<p>The object has been created, but the send method has not been called.</p>\n\n<p>(2) LOADED =    </p>\n\n<p>The send method has been called, but the status and headers are not yet available.</p>\n\n<p>(3) INTERACTIVE =   </p>\n\n<p>Some data has been received. Calling the responseBody and responseText properties at this state to obtain partial results will return an error, because status and response headers are not fully available.</p>\n\n<p>(4) COMPLETED = </p>\n\n<p>All the data has been received, and the complete data is available in the responseBody and responseText properties.</p>\n"}, {"tags": ["vba", "excel", "firefox", "selenium"], "answers": [{"tags": [], "owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1456866513, "creation_date": 1456866513, "answer_id": 35733541, "question_id": 35595435, "link": "https://stackoverflow.com/questions/35595435/the-directory-is-not-empty-error-using-firefox-selenium-excel-vba/35733541#35733541", "title": "&quot;The directory is not empty&quot; error - using firefox selenium excel VBA", "body": "<p>SeleniumWrapper is deprecated and no longer supported.\nIt has been replaced by SeleniumBasic:\n<a href=\"https://github.com/florentbr/SeleniumBasic/releases\" rel=\"nofollow\">https://github.com/florentbr/SeleniumBasic/releases</a></p>\n\n<p>Usage example:</p>\n\n<pre><code>Dim driver As New Selenium.FirefoxDriver\ndriver.Get \"https://en.wikipedia.org/wiki/Main_Page\"\n\ndriver.FindElementById(\"searchInput\") _\n      .SendKeys(\"champagne\") _\n      .Submit\n\ndriver.Quit\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5972811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3850f6dd29a9ddf9f47dc38cb3a9adb?s=128&d=identicon&r=PG&f=1", "display_name": "Unclassify", "link": "https://stackoverflow.com/users/5972811/unclassify"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 192, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1456866513, "creation_date": 1456297521, "question_id": 35595435, "link": "https://stackoverflow.com/questions/35595435/the-directory-is-not-empty-error-using-firefox-selenium-excel-vba", "title": "&quot;The directory is not empty&quot; error - using firefox selenium excel VBA", "body": "<p>I need help with the following error:\n<a href=\"http://i.stack.imgur.com/YZxqo.png\" rel=\"nofollow\">Error Msg</a>\nIt keep prompting me \"The directory is not empty\" when I try to run the following code: </p>\n\n<pre><code>Dim driver As New SeleniumWrapper.WebDriver\n\nDim By As New By, Assert As New Assert, Verify As New Verify, Waiter As New Waiter\n\ndriver.Start \"Firefox\"\n</code></pre>\n\n<p>I want to run my selenium test on firefox. I am using excel vba to do it. It is workable on Chrome but not on firefox. Thanks!</p>\n"}, {"tags": ["vba", "ms-word", "clipboard"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1456302588, "post_id": 35595258, "comment_id": 58878754, "body": "It would help if you show us the code you&#39;re using that&#39;s causing the problem, as well as the error message it&#39;s generating."}, {"owner": {"reputation": 556, "user_id": 5932704, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-i6RfINhkji4/AAAAAAAAAAI/AAAAAAAAb4A/paEKjYmQFyU/photo.jpg?sz=128", "display_name": "Jon", "link": "https://stackoverflow.com/users/5932704/jon"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1456303731, "post_id": 35595258, "comment_id": 58879473, "body": "@CindyMeister:  Thank you Cindy.  I added the information you requested, but note that I answered my own question from the start.  This was a problem I faced several years ago, and the method in my answer was the best one that I found and doesn&#39;t rely on error handling.  It works very well for me."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1456304788, "post_id": 35595258, "comment_id": 58880148, "body": "I missed that you answered your own question - good contribution :-) Thanks for adding the additional information, I think it adds to the value of the question (makes it clearer)."}, {"owner": {"reputation": 556, "user_id": 5932704, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-i6RfINhkji4/AAAAAAAAAAI/AAAAAAAAb4A/paEKjYmQFyU/photo.jpg?sz=128", "display_name": "Jon", "link": "https://stackoverflow.com/users/5932704/jon"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1456308123, "post_id": 35595258, "comment_id": 58882520, "body": "@CindyMeister: I really should have said <b>worked</b> very well for me as I really don&#39;t use the <code>.Paste</code> method anymore.  I typically work with ranges and then will put the text in place with something like <code>myRangeVariable.Text = &quot;some text&quot;</code>. I may be misguided, but I think that way is faster.  But I know that when I needed to paste, it was difficult trying to deal with the empty clipboard problem. And I preferred not to do it with error handling."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1456309004, "post_id": 35595258, "comment_id": 58883210, "body": "Assign Range.Text = Range.Text is indeed faster and has the advantage of not interfering with what the user may have put on the Clipboard. Or Range.FormattedText = Range.FormattedText when the formatting is important. Different, of course, when an external application (Excel, for example) is involved..."}], "answers": [{"tags": [], "owner": {"reputation": 556, "user_id": 5932704, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-i6RfINhkji4/AAAAAAAAAAI/AAAAAAAAb4A/paEKjYmQFyU/photo.jpg?sz=128", "display_name": "Jon", "link": "https://stackoverflow.com/users/5932704/jon"}, "is_accepted": false, "score": 5, "last_activity_date": 1456464716, "last_edit_date": 1456464716, "creation_date": 1456296899, "answer_id": 35595259, "question_id": 35595258, "link": "https://stackoverflow.com/questions/35595258/how-to-check-if-clipboard-is-empty-of-text/35595259#35595259", "title": "How to check if clipboard is empty of text?", "body": "<p><strong><em>Very important</em></strong>:  You must first set a reference to the \"Microsoft Forms 2.0 Object Library\" (as in the attached screenshot below) before implementing this code.  You may find that it is not an option when you scroll through the reference libraries.  To make it show up, just add a form to the project (you can always delete the form later).</p>\n\n<p><a href=\"https://i.stack.imgur.com/T5feY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/T5feY.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub CheckClipboard()\n\n        Dim myDataObject As DataObject\n\n        Set myDataObject = New DataObject\n\n\n        myDataObject.GetFromClipboard\n\n\n        If myDataObject.GetFormat(1) = True Then \n\n            '''There is text on clipboard, so it's safe to paste\n\n        Else \n            '''there is no text on the clipboard, so you may get error.\n\n        End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 556, "user_id": 5932704, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-i6RfINhkji4/AAAAAAAAAAI/AAAAAAAAb4A/paEKjYmQFyU/photo.jpg?sz=128", "display_name": "Jon", "link": "https://stackoverflow.com/users/5932704/jon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11128, "favorite_count": 3, "answer_count": 1, "score": 6, "last_activity_date": 1456464716, "creation_date": 1456296899, "last_edit_date": 1456349748, "question_id": 35595258, "link": "https://stackoverflow.com/questions/35595258/how-to-check-if-clipboard-is-empty-of-text", "title": "How to check if clipboard is empty of text?", "body": "<p>If I try to paste from an empty clipboard, I get an error.  I would like to check if the clipboard is empty of text before pasting so that I can avoid this.  How can this be accomplished?  I'm aware it can be done through error handling, but I would prefer a method that avoids an error.</p>\n\n<p>Edit -- Per request, adding code that creates the error and the error message:</p>\n\n<p>Code that causes the problem:</p>\n\n<pre><code>Sub PasteFromEmptyClipBoard()\n\n    Selection.Paste\n\nEnd Sub\n</code></pre>\n\n<p>Error message that I get:</p>\n\n<p><a href=\"https://i.stack.imgur.com/cy9rw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cy9rw.png\" alt=\"enter image description here\"></a></p>\n\n<p>\"Run-time error '4605'  This method or property is not available because the Clipboard is empty or is not valid.\"</p>\n"}, {"tags": ["excel", "vba", "copy", "criteria"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1456297715, "post_id": 35595204, "comment_id": 58876330, "body": "Look at the <a href=\"https://msdn.microsoft.com/en-us/library/office/aa221844.aspx\" rel=\"nofollow noreferrer\">AutoFilter method</a>. If you run into trouble, come back and edit your question to show what you&#39;ve come up with (working or not). Along with your code, include some sample data that <a href=\"http://tinyurl.com/kdxb7le\" rel=\"nofollow noreferrer\">does not have to be retyped from an image</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1456298376, "post_id": 35595204, "comment_id": 58876615, "body": "See <a href=\"http://i.stack.imgur.com/47ZYM.gif\" rel=\"nofollow noreferrer\">Copy multiple Range from Sheet1 based on a conditionand paste it in Alongside in Sheet2</a>."}, {"owner": {"reputation": 33, "user_id": 5972566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d764b1b857026f0a3f9a06c6f20eaa1?s=128&d=identicon&r=PG&f=1", "display_name": "Ruth", "link": "https://stackoverflow.com/users/5972566/ruth"}, "edited": false, "score": 0, "creation_date": 1456385031, "post_id": 35595204, "comment_id": 58924076, "body": "Thank you for telling me I should not post images! Sorry!"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 5972566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d764b1b857026f0a3f9a06c6f20eaa1?s=128&d=identicon&r=PG&f=1", "display_name": "Ruth", "link": "https://stackoverflow.com/users/5972566/ruth"}, "edited": false, "score": 0, "creation_date": 1456385117, "post_id": 35596154, "comment_id": 58924126, "body": "Thank you! It is exactly what I needed!"}], "tags": [], "owner": {"reputation": 1362, "user_id": 4910205, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wz5LG.jpg?s=128&g=1", "display_name": "Brendan Gooden", "link": "https://stackoverflow.com/users/4910205/brendan-gooden"}, "is_accepted": true, "score": 3, "last_activity_date": 1456300764, "last_edit_date": 1456300764, "creation_date": 1456299989, "answer_id": 35596154, "question_id": 35595204, "link": "https://stackoverflow.com/questions/35595204/copy-values-based-on-criteria-with-macro/35596154#35596154", "title": "Copy values based on criteria with macro", "body": "<p>This code should do what you are looking for. This will copy all rows with a value in column B, into columns D and E.'</p>\n\n<pre><code>Sub copyrows()\nDim RowNo, newRowNo As Long\n\n    RowNo = 2\n    newRowNo = 2\n\n    With ThisWorkbook.ActiveSheet\n\n      .Cells(1, 4).Value = \"Date\"\n      .Cells(1, 5).Value = \"H_Selected\"\n\n          Do Until .Cells(RowNo, 1) = \"\"\n\n             If .Cells(RowNo, 2) &lt;&gt; \"-9999\" Then\n               .Cells(newRowNo, 4) = .Cells(RowNo, 1)\n               .Cells(newRowNo, 5) = .Cells(RowNo, 2)\n               newRowNo = newRowNo + 1\n             End If\n\n          RowNo = RowNo + 1\n\n          Loop\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5972566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d764b1b857026f0a3f9a06c6f20eaa1?s=128&d=identicon&r=PG&f=1", "display_name": "Ruth", "link": "https://stackoverflow.com/users/5972566/ruth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 760, "favorite_count": 0, "accepted_answer_id": 35596154, "answer_count": 1, "score": 3, "last_activity_date": 1456300764, "creation_date": 1456296740, "last_edit_date": 1456298327, "question_id": 35595204, "link": "https://stackoverflow.com/questions/35595204/copy-values-based-on-criteria-with-macro", "title": "Copy values based on criteria with macro", "body": "<p>I have 2 columns, one with dates (column A:A, of type dd/mm/yyyy hh:mm) the other with values of a parameter (column B:B), registered at each date. But not all dates have registered values (in which case in column B I will have -9999.</p>\n\n<p>What I need is to copy to other columns (say D:D and E:E) only the cells where there is a value other than -9999 and the correspondent date too. For example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/47ZYM.gif\" rel=\"nofollow noreferrer\">Example</a><br/>\n<a href=\"https://i.stack.imgur.com/47ZYM.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/47ZYM.gif\" alt=\"enter image description here\"></a></p>\n\n<p>My data series is pretty long, it can get to 10000 or more lines, so I cannot do this selection \u201cmanually\u201d. I would prefer macros, not array formulae, because I want to choose the moment of the calculation.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 29, "user_id": 5598099, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/dcaeb288166361dfd9680c69aabec9c2?s=128&d=identicon&r=PG&f=1", "display_name": "Tahir Mehmood", "link": "https://stackoverflow.com/users/5598099/tahir-mehmood"}, "edited": false, "score": 0, "creation_date": 1456312326, "post_id": 35594900, "comment_id": 58885644, "body": "If anyone have some idea regarding memory release then please share feedback..thanks."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 5598099, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/dcaeb288166361dfd9680c69aabec9c2?s=128&d=identicon&r=PG&f=1", "display_name": "Tahir Mehmood", "link": "https://stackoverflow.com/users/5598099/tahir-mehmood"}, "edited": false, "score": 0, "creation_date": 1456322743, "post_id": 35602640, "comment_id": 58893119, "body": "So ie.Refresh2 is creating problem.I use on error resume next because i am facing error i.e Internet Explorer has stopped working.I update error code."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 0, "last_activity_date": 1456318009, "creation_date": 1456318009, "answer_id": 35602640, "question_id": 35594900, "link": "https://stackoverflow.com/questions/35594900/how-to-release-memory-during-vba-ie-navigation/35602640#35602640", "title": "How to release memory during vba ie navigation", "body": "<p><code>ie.Refresh2</code> is superfluous - the next action is to navigate to a new URL.</p>\n\n<p>You should get rid of all those <code>On Error Resume Next</code> statements - they mask errors. E.g. <code>ie.Quit</code> won't work because <code>ie</code> has been set Nothing before.</p>\n\n<p><code>Set my_data = Nothing</code> after reading its innerText may help, but should not be necessary.</p>\n"}], "owner": {"reputation": 29, "user_id": 5598099, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/dcaeb288166361dfd9680c69aabec9c2?s=128&d=identicon&r=PG&f=1", "display_name": "Tahir Mehmood", "link": "https://stackoverflow.com/users/5598099/tahir-mehmood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 393, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1459413185, "creation_date": 1456295561, "last_edit_date": 1459413185, "question_id": 35594900, "link": "https://stackoverflow.com/questions/35594900/how-to-release-memory-during-vba-ie-navigation", "title": "How to release memory during vba ie navigation", "body": "<p>Suggestion required regarding below mentioned code memory usage as it is taking huge memory during processing.Plese guide how to release momory after each url processing so that there is no ie navigation error.Code is given below.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim RowCount As String\nstDB = \"Data Source=C:\\off_Ch.accdb\"\nstProvider = \"Microsoft.ACE.OLEDB.12.0\"\nWith cn\n    .ConnectionString = stDB\n    .Provider = stProvider\n    .Open\n    Set ie = Nothing\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n    ie.Visible = True\n    RowCount = DMin(\"[id]\", \"url\", \"[Flag] = False\")\n    maxid = DMax(\"[id]\", \"url\", \"[Flag] = False\")\n    Do While RowCount &lt;&gt; \"\"\n        Set HTML = Nothing\n        url = DLookup(\"[url]\", \"url\", \"ID = \" &amp; ([RowCount]))\n        priceval = \"\"\n        ie.navigate url\n        On Error Resume Next\n        Do While ie.ReadyState &lt;&gt; 4 Or _\n                ie.Busy = True\n            On Error Resume Next\n            DoEvents\n        Loop\n        Set HTML = ie.Document\n        Set my_data = HTML.getElementById(\"breadcrumbResultArea\")\n        selrem = my_data.innerText\n        stSQL = \"INSERT INTO off (seller_identity, url,id) \" &amp; _\n            \"Values ('\" &amp; selrem &amp; \"','\" &amp; url &amp; \"','\" &amp; RowCount &amp; \"')\"\n        cn.Execute stSQL\n        If RowCount &gt; maxid Then Exit Do\n        RowCount = RowCount + 1\n        On Error Resume Next\n        ie.Refresh2\n    Loop\n    Set ie = Nothing\n    Set HTML = Nothing\nEnd With\nie.Quit\nSet ie = Nothing\nEnd Sub\n</code></pre>\n\n<p>Error Code is given below</p>\n\n<p>Error more detail is given below.</p>\n\n<p>Problem signature:\n  Problem Event Name:    APPCRASH\n  Application Name:    IEXPLORE.EXE\n  Application Version:    11.0.9600.18124\n  Application Timestamp:    5641278d\n  Fault Module Name:    jscript9.dll\n  Fault Module Version:    11.0.9600.18124\n  Fault Module Timestamp:    56413027\n  Exception Code:    c0000005\n  Exception Offset:    0007772c\n  OS Version:    6.1.7601.2.1.0.272.7\n  Locale ID:    1033\n  Additional Information 1:    25c4\n  Additional Information 2:    25c494805ba8021c831f7da5514f4335\n  Additional Information 3:    3eda\n  Additional Information 4:    3eda1b263b257f9fa235fc5fb2929be2</p>\n\n<p>Read our privacy statement online:\n  <a href=\"http://go.microsoft.com/fwlink/?linkid=104288&amp;clcid=0x0409\" rel=\"nofollow\">http://go.microsoft.com/fwlink/?linkid=104288&amp;clcid=0x0409</a></p>\n\n<p>If the online privacy statement is not available, please read our privacy statement offline:\n  C:\\Windows\\system32\\en-US\\erofflps.txt</p>\n"}, {"tags": ["vba", "inputbox"], "comments": [{"owner": {"reputation": 29, "user_id": 5455711, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c6aa296acc7b696c1902fd916522ae45?s=128&d=identicon&r=PG&f=1", "display_name": "marvellosity123", "link": "https://stackoverflow.com/users/5455711/marvellosity123"}, "edited": false, "score": 0, "creation_date": 1456294845, "post_id": 35594476, "comment_id": 58875008, "body": "how do i click cancel without getting that error?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1456295111, "post_id": 35594476, "comment_id": 58875118, "body": "<code>Loop Until jjj = &quot;Master&quot; Or jjj = &quot;&quot;</code>   <code>Inputbox</code> returns False/empty string if you press Cancel, not <code>vbCancel</code> (2)"}, {"owner": {"reputation": 29, "user_id": 5455711, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c6aa296acc7b696c1902fd916522ae45?s=128&d=identicon&r=PG&f=1", "display_name": "marvellosity123", "link": "https://stackoverflow.com/users/5455711/marvellosity123"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1456295247, "post_id": 35594476, "comment_id": 58875167, "body": "I tried that before, and i still get the same error 13"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1456295391, "creation_date": 1456295391, "answer_id": 35594855, "question_id": 35594476, "link": "https://stackoverflow.com/questions/35594476/what-is-wrong-with-my-inputbox/35594855#35594855", "title": "What is wrong with my inputbox", "body": "<pre><code>Sub weewe()\n\n    Dim jjj As String\n\n    Do\n        jjj = InputBox(\"Type in the correct password\", \"password\")\n    Loop Until jjj = \"Master\" Or jjj = \"\"\n\n    If jjj = \"Master\" Then\n        MsgBox \"thats the correct password\", vbOKOnly, \"Password\"\n    ElseIf jjj = \"\" Then\n        Exit Sub\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 5455711, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c6aa296acc7b696c1902fd916522ae45?s=128&d=identicon&r=PG&f=1", "display_name": "marvellosity123", "link": "https://stackoverflow.com/users/5455711/marvellosity123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 35594855, "answer_count": 1, "score": 1, "last_activity_date": 1456295391, "creation_date": 1456293914, "last_edit_date": 1456294639, "question_id": 35594476, "link": "https://stackoverflow.com/questions/35594476/what-is-wrong-with-my-inputbox", "title": "What is wrong with my inputbox", "body": "<pre><code>Sub weewe()\n\nDim jjj As String\n\nDo\n    jjj = InputBox(\"Type in the correct password\", \"password\")\nLoop Until jjj = \"Master\" Or vbCancel\n\nIf jjj = \"Master\" Then\n\n    sss = MsgBox(\"thats the correct password\", vbOKOnly, \"Password\")\n\nElseIf jjj = vbCancel Then\n\n    Exit Sub\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>the code works but why when i click cancel do i get an error 13? And how do I fix it?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1456293803, "post_id": 35594227, "comment_id": 58874585, "body": "Which part takes the most time?  You can use <code>Debug.Print</code> and <code>Timer</code> to output how long each part takes.  That&#39;s too much code so it would help to focus down on the problem areas."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1456295078, "post_id": 35594227, "comment_id": 58875105, "body": "It&#39;s possible that this code dump would be better suited as a [performance] question at <a href=\"http://codereview.stackexchange.com/questions/tagged/excel\">Code Review - Excel</a>. Read their <a href=\"http://codereview.stackexchange.com/help/on-topic\">What topics can I ask about here?</a> and consider migrating the question over if you feel it is a good fit."}, {"owner": {"reputation": 7, "user_id": 5709694, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c6975bc448333aaca1e8e4969b353838?s=128&d=identicon&r=PG&f=1", "display_name": "klpw", "link": "https://stackoverflow.com/users/5709694/klpw"}, "edited": false, "score": 0, "creation_date": 1456295369, "post_id": 35594227, "comment_id": 58875219, "body": "Hi Tim Williams. Thank you for your suggestion and I found that the Sub Compare() takes the longest time to run. It runs endlessly without showing any time."}, {"owner": {"reputation": 7, "user_id": 5709694, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c6975bc448333aaca1e8e4969b353838?s=128&d=identicon&r=PG&f=1", "display_name": "klpw", "link": "https://stackoverflow.com/users/5709694/klpw"}, "edited": false, "score": 0, "creation_date": 1456295516, "post_id": 35594227, "comment_id": 58875278, "body": "Hi Jeeped. Thaks for your suggestion. I was wondering how can I move to Code Review - Excel as I&#39;m new to here."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1456296949, "post_id": 35594227, "comment_id": 58875933, "body": "If you click <a href=\"http://stackoverflow.com/posts/35594227/edit\">edit</a> you can copy this question&#39;s source to Notepad in prep to creating another question on Code Review. This question can then be <a href=\"http://stackoverflow.com/questions/35594227\">delete</a>d. When you post on Code Review, add some narrative about what this code actually accomplishes. Adding a link to some sample data would be appreciated; it&#39;s tiresome to have to reproduce data that may not even be accurate for testing purposes."}], "answers": [{"tags": [], "owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "is_accepted": false, "score": 0, "last_activity_date": 1456301176, "creation_date": 1456301176, "answer_id": 35596497, "question_id": 35594227, "link": "https://stackoverflow.com/questions/35594227/speed-up-the-processing-of-excel-vba/35596497#35596497", "title": "speed up the processing of excel vba", "body": "<p>I would start with remove as much as <code>.activate</code> and <code>select</code> you have in your code and replace it with proper sheet.cell/range selection. \nThen i would add this on beggining of your code</p>\n\n<pre><code>Dim previousScreenUpdating As Boolean\npreviousScreenUpdating = Application.ScreenUpdating\nApplication.ScreenUpdating = False\nDim previousCalculation As XlCalculation\npreviousCalculation = Application.Calculation\nApplication.Calculation = xlCalculationManual\n</code></pre>\n\n<p>and this on the end of your code</p>\n\n<pre><code>Application.ScreenUpdating = previousScreenUpdating\nApplication.Calculation = previousCalculation\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7, "user_id": 5709694, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c6975bc448333aaca1e8e4969b353838?s=128&d=identicon&r=PG&f=1", "display_name": "klpw", "link": "https://stackoverflow.com/users/5709694/klpw"}, "edited": false, "score": 0, "creation_date": 1456361360, "post_id": 35609939, "comment_id": 58915775, "body": "Hi Tim Williams. This is indeed a lot faster. I was wondering how can I modify the code and speed up the running of Sub getnew() as well for the circumstances that they are too many new information being updated in one time?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 7, "user_id": 5709694, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c6975bc448333aaca1e8e4969b353838?s=128&d=identicon&r=PG&f=1", "display_name": "klpw", "link": "https://stackoverflow.com/users/5709694/klpw"}, "edited": false, "score": 0, "creation_date": 1456362385, "post_id": 35609939, "comment_id": 58916057, "body": "Why are you resorting the sheet every time you copy a &quot;NEW&quot; row -   surely you only need to do that once after you&#39;re done copying?  And Lubo\u0161 has good suggestions for improving your general speed of execution."}, {"owner": {"reputation": 7, "user_id": 5709694, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c6975bc448333aaca1e8e4969b353838?s=128&d=identicon&r=PG&f=1", "display_name": "klpw", "link": "https://stackoverflow.com/users/5709694/klpw"}, "edited": false, "score": 0, "creation_date": 1456364160, "post_id": 35609939, "comment_id": 58916567, "body": "Hi Tim Williams. This is because I have data which is classified in different categories and &quot;NEW&quot; row might be added in the middle of the sheet, not the last row all the time. Therefore, everytime when it is being copied over to another sheet, it needs to be resorted to match its category. For instance, if broccoli is &quot;NEW&quot;, then it will be added to vegetable category whereas if is orange, it will be added to fruit category."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 7, "user_id": 5709694, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c6975bc448333aaca1e8e4969b353838?s=128&d=identicon&r=PG&f=1", "display_name": "klpw", "link": "https://stackoverflow.com/users/5709694/klpw"}, "edited": false, "score": 0, "creation_date": 1456365643, "post_id": 35609939, "comment_id": 58916947, "body": "I can see why you might need to sort, but not why sorting multiple times gives you a different outcome from running a single sort when you&#39;re done with the loop.  A single sort will still group everything by category."}, {"owner": {"reputation": 7, "user_id": 5709694, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c6975bc448333aaca1e8e4969b353838?s=128&d=identicon&r=PG&f=1", "display_name": "klpw", "link": "https://stackoverflow.com/users/5709694/klpw"}, "edited": false, "score": 0, "creation_date": 1456368176, "post_id": 35609939, "comment_id": 58917685, "body": "Hi Tim Williams. I got what you meant. Thank you very much. Between, I was wondering whether is there any other faster way for the loop? The &quot;NEW&quot; might be reside in row 5, 7, 10, 25, 100 in Sheets(&quot;main&quot;). I was thinking whether can I collect all the &quot;NEW&quot; rows altogether and copy at the bottom of the page in Sheets(&quot;today&quot;) then sort them out and that will be faster?"}, {"owner": {"reputation": 7, "user_id": 5709694, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c6975bc448333aaca1e8e4969b353838?s=128&d=identicon&r=PG&f=1", "display_name": "klpw", "link": "https://stackoverflow.com/users/5709694/klpw"}, "edited": false, "score": 0, "creation_date": 1456368505, "post_id": 35609939, "comment_id": 58917774, "body": "Hi Tim Williams. Do you reckon that if I filter &quot;NEW&quot; in Sheets(&quot;main&quot;) and copy paste to Sheets(&quot;today&quot;) and sort it all that will be faster than i use looping?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 7, "user_id": 5709694, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c6975bc448333aaca1e8e4969b353838?s=128&d=identicon&r=PG&f=1", "display_name": "klpw", "link": "https://stackoverflow.com/users/5709694/klpw"}, "edited": false, "score": 0, "creation_date": 1456371481, "post_id": 35609939, "comment_id": 58918602, "body": "Yes a filter might be faster.  Try it out"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1456337835, "creation_date": 1456337835, "answer_id": 35609939, "question_id": 35594227, "link": "https://stackoverflow.com/questions/35594227/speed-up-the-processing-of-excel-vba/35609939#35609939", "title": "speed up the processing of excel vba", "body": "<p>This should be much faster. </p>\n\n<p>You should always try to do as much using arrays as possible, rather than going through your data cell-by-cell.  </p>\n\n<p>In addition, a dictionary-based lookup is always going to beat using Find() when you're checking things in a large loop.</p>\n\n<pre><code>Sub Compare()\n\n    Dim mrow As Range, trow As Long, arr, r As Long\n    Dim d As Object, rngV As Range\n    Dim arrV, arrN, wsT As Worksheet, wsM As Worksheet\n\n    Set d = CreateObject(\"Scripting.Dictionary\")\n\n    Set wsM = Worksheets(\"Main\")\n    Set wsT = Worksheets(\"today\")\n\n    'get all unique values in ColA on Main\n    arr = wsM.Range(wsM.Range(\"A2\"), wsM.Cells(wsM.Rows.Count, 1).End(xlUp)).Value\n    For r = 1 To UBound(arr, 1)\n        d(arr(r, 1)) = 1\n    Next r\n\n    Set rngV = wsT.Range(wsT.Range(\"A2\"), wsT.Cells(wsT.Rows.Count, 1).End(xlUp))\n    arrV = rngV.Value                 'values from colA as array\n    arrN = rngV.Offset(0, 1).Value    'values from colB as array\n\n    'check colA against the dictionary and update colB array as needed\n    For r = 1 To UBound(arrV, 1)\n        If Not d.exists(arrV(r, 1)) Then arrN(r, 1) = \"NEW\"\n    Next r\n    'repopulate ColB with updated data\n    rngV.Offset(0, 1).Value = arrN\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 5709694, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c6975bc448333aaca1e8e4969b353838?s=128&d=identicon&r=PG&f=1", "display_name": "klpw", "link": "https://stackoverflow.com/users/5709694/klpw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 595, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1456337835, "creation_date": 1456292839, "question_id": 35594227, "link": "https://stackoverflow.com/questions/35594227/speed-up-the-processing-of-excel-vba", "title": "speed up the processing of excel vba", "body": "<p>I've created excel vba file. However, it takes very long time to run the whole file because the total of the rows is up to 270,000 lines. Does anyone know how can I speed up the running process? Any help would be much appreciated. Thanks in advance.</p>\n\n<pre><code>Sub datemodifiedFile()\nDim File1 As Object\nDim fso As Object\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nSet File1 = fso.getfile(\"C:\\Users\\Meg\\Desktop\\Master File.xlsx\")\nIf Sheets(\"today\").Range(\"B1\").Value = File1.DateLastModified Then\nElse\nSheets(\"today\").Range(\"B1\").Value = File1.DateLastModified\nDim WbB As Workbook\nSet WbB = Workbooks.Open(Filename:=\"C:\\Users\\Meg\\Desktop\\Master File.xlsx\", ReadOnly:=True)\nDim SheetB As Worksheet\nDim lastrow As Long\nSet SheetB = WbB.Sheets(\"Sheet1\")\n        SheetB.Select\n        Rows(\"1:1\").Select\n        'Selection.AutoFilter\n        'ActiveSheet.Range(\"A:V\").AutoFilter Field:=20, Criteria1:=\"\"\n        Columns(\"A:V\").Select\n        Selection.Copy\n        ThisWorkbook.Activate\n        Sheets(\"today\").Select\n        Range(\"C1\").Select\n        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n               :=False, Transpose:=False\n        'Columns(\"A:X\").Select\n        'ActiveSheet.Range(\"$A$1:$X$750001\").RemoveDuplicates Columns:=Array(3, 4, 6), _\n        Header:=xlYes\n        Application.CutCopyMode = False\n        lastrow = Sheets(\"today\").Range(\"D\" &amp; Rows.Count).End(xlUp).Row\n        Sheets(\"today\").Cells(lastrow, 3).EntireRow.Delete\nWbB.Close False\nEnd If\nEnd Sub\nSub dltnew()\n        Dim i As Long\n        Dim lrow As Long\n        lrow = Sheets(\"today\").Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n        For i = 2 To lrow\n        If Sheets(\"today\").Cells(i, 2).Value = \"NEW\" Then\n        Sheets(\"today\").Cells(i, 2).Value = \"\"\n        Sheets(\"today\").Cells(i, 1).Value = \"\"\nEnd If\nNext i\nEnd Sub\nSub comdate()\nDim Sheet1 As Worksheet\nDim Sheet3 As Worksheet\nDim lrow As Long\nDim i As Long\nSet Sheet1 = ThisWorkbook.Sheets(\"main\")\nSet Sheet3 = ThisWorkbook.Sheets(\"today\")\nSheet3.Range(\"A1\").Value = Date\nSheet3.Range(\"A1\").NumberFormat = \"dd/mm/yyyy\"\nSheet3.Range(\"A1\").Font.Color = Sheet3.Range(\"A1\").Interior.Color\nSheet3.Columns(\"A:A\").EntireColumn.Hidden = False\nIf Sheet1.Range(\"B1\").Value &lt;&gt; Sheet3.Range(\"A1\").Value Then\n   Sheet1.Range(\"B1\").Value = Sheet3.Range(\"A1\").Value\n    lrow = Sheet1.Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n    For i = 2 To lrow\n    If Sheet1.Cells(i, 2).Value = \"NEW\" Then\n    Sheet1.Cells(i, 2).Value = \"\"\n    End If\n    Next i\n    End If\nEnd Sub\nSub Con()\nDim LasRow As Long\nApplication.ScreenUpdating = False\nLasRow = Sheets(\"today\").Range(\"C\" &amp; Rows.Count).End(xlUp).Row\nSheets(\"today\").Range(\"A2:A\" &amp; LasRow).Formula = \"=C2&amp;G2&amp;I2\"\nActiveSheet.AutoFilterMode = False\nApplication.ScreenUpdating = True\nEnd Sub\nSub Compare()\n    Dim mrow As Range, trow As Long\n    With Worksheets(\"main\")\n        Set mrow = .Range(\"A2\", .Range(\"A\" &amp; Rows.Count).End(xlUp))\n    End With\n    trow = Worksheets(\"today\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    With Worksheets(\"today\")\n        For j = 2 To trow\n            If mrow.Find(What:=.Range(\"A\" &amp; j).Value, LookIn:=xlValues, LookAt:=xlWhole) Is Nothing _\n             Then .Range(\"B\" &amp; j).Value = \"NEW\"\n        Next j\n    End With\nEnd Sub\nSub getnew()\nDim Sheet1 As Worksheet\nDim Sheet3 As Worksheet\nDim lastrow As Long\nDim i As Long\nDim erow As Long\nSet Sheet1 = ThisWorkbook.Sheets(\"main\")\nSet Sheet3 = ThisWorkbook.Sheets(\"today\")\nlastrow = Sheet3.Range(\"C\" &amp; Rows.Count).End(xlUp).Row\nFor i = 2 To lastrow\n    If Sheet3.Cells(i, 2).Value = \"NEW\" Then\n    erow = Sheet1.Range(\"C\" &amp; Rows.Count).End(xlUp).Row + 1\n    Sheet3.Cells(i, 2).EntireRow.Copy Destination:=Sheet1.Range(\"A\" &amp; erow)\n    Application.CutCopyMode = False\n    Sheet1.Select\n    Range(\"A1:X750001\").Select\n    Selection.Sort Key1:=Range(\"G2\"), Order1:=xlAscending, Key2:=Range(\"C2\") _\n        , Order2:=xlAscending, Header:=xlGuess, OrderCustom:=1, MatchCase:= _\n        False, Orientation:=xlTopToBottom\nEnd If\nNext i\nEnd Sub\nSub hidecellvalue()\nDim Sheet1 As Worksheet\nDim lastrow As Long\nDim k As Long\nSet Sheet1 = ThisWorkbook.Sheets(\"main\")\nlastrow = Sheet1.Range(\"B\" &amp; Rows.Count).End(xlUp).Row\nFor k = 2 To lastrow\nIf Sheet1.Cells(k, 1).Value &lt;&gt; \"NEW\" Then\nSheet1.Cells(k, 1).Font.Color = Sheet1.Cells(k, 1).Interior.Color\n'Sheet1.Columns(\"A:A\").EntireColumn.Hidden = False\nEnd If\nNext k\nEnd Sub\nSub hideSh1column()\nDim Sheet1 As Worksheet\nSet Sheet1 = ThisWorkbook.Sheets(\"main\")\nSheet1.Columns(\"A:A\").EntireColumn.Hidden = True\nSheet1.Columns(\"D:F\").EntireColumn.Hidden = True\nSheet1.Columns(\"H:H\").EntireColumn.Hidden = True\nSheet1.Columns(\"L:L\").EntireColumn.Hidden = True\nSheet1.Columns(\"N:N\").EntireColumn.Hidden = True\nSheet1.Columns(\"P:P\").EntireColumn.Hidden = True\nEnd Sub\nSub HideSheet3()\nSheets(\"today\").Visible = xlSheetVisible\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "email", "outlook"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1456334232, "post_id": 35593773, "comment_id": 58901724, "body": "Replace xlWB.Close False with xlWB.Close True. If this is the answer consider deleting the question."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 2300070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50bde8628fc57422efc0c3fe2cb7a8bf?s=128&d=identicon&r=PG", "display_name": "JamesL", "link": "https://stackoverflow.com/users/2300070/jamesl"}, "is_accepted": false, "score": 0, "last_activity_date": 1456336537, "last_edit_date": 1495541252, "creation_date": 1456336537, "answer_id": 35609521, "question_id": 35593773, "link": "https://stackoverflow.com/questions/35593773/extract-partail-email-body-from-outlook-to-excel/35609521#35609521", "title": "Extract partail email body from Outlook to Excel", "body": "<p>Use a regular expression to extract the part of the email body you are looking for. Refer to this: <a href=\"https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\">How to use Regular Expressions (Regex) in Microsoft Excel both in-cell and loops</a></p>\n"}], "owner": {"reputation": 1, "user_id": 5934795, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2BKdUpCUYqk/AAAAAAAAAAI/AAAAAAAAAKU/aA0claUrWmI/photo.jpg?sz=128", "display_name": "Rishav Dutta", "link": "https://stackoverflow.com/users/5934795/rishav-dutta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 594, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456336537, "creation_date": 1456290829, "question_id": 35593773, "link": "https://stackoverflow.com/questions/35593773/extract-partail-email-body-from-outlook-to-excel", "title": "Extract partail email body from Outlook to Excel", "body": "<p>Hello I am trying to extract a specific part of Email body and a count of how many emails with that same part I have got. I am using the below vba code but am getting the following issues:</p>\n\n<ol>\n<li>Output is not populating however the script is running without fail.</li>\n<li>unable to extract that specific part from the email body.</li>\n</ol>\n\n<p>Code am using is:</p>\n\n<pre><code>Option Explicit\nSub Download_Outlook_Mail_To_Excel()\nDim Folder          As Outlook.MAPIFolder\nDim sFolders        As Outlook.MAPIFolder\nDim iRow            As Integer\nDim oRow            As Integer\nDim MailBoxName     As String\nDim Pst_Folder_Name As String\n\nConst xlWorkbookName As String = \"C:\\Personal\\Documents\\Failures.xlsx\" '// change as required\n\n'// I'm using late binding in case you don't actually have a reference set.\nDim xlApp           As Object\nDim xlWB            As Object\n\nSet xlApp = CreateObject(\"Excel.Application\")\nxlApp.Visible = False\n\nSet xlWB = xlApp.Workbooks.Open(xlWorkbookName)\n\nMailBoxName = \"ridutta@gmail.com\"\n\n\nPst_Folder_Name = \"SR Creation Failure\" 'Sample \"Inbox\" or \"Sent Items\"\n\n'To directly a Folder at a high level\n'Set Folder =  Outlook.Session.Folders(MailBoxName).Folders(Pst_Folder_Name)\n\n'To access a main folder or a subfolder (level-1)\nFor Each Folder In Outlook.Session.Folders(MailBoxName).Folders\n    If VBA.UCase(Folder.Name) = VBA.UCase(Pst_Folder_Name) Then GoTo Label_Folder_Found\n    For Each sFolders In Folder.Folders\n        If VBA.UCase(sFolders.Name) = VBA.UCase(Pst_Folder_Name) Then\n            Set Folder = sFolders\n            GoTo Label_Folder_Found\n        End If\n    Next sFolders\nNext Folder\n\nLabel_Folder_Found:\nIf Folder.Name = \"\" Then\n    MsgBox \"Invalid Data in Input\"\n    GoTo End_Lbl1:\nEnd If\n\n'Read Through each Mail and export the details to Excel for Email Archival\nxlWB.Sheets(1).Activate\nFolder.Items.Sort \"Received\"\n\n'Insert Column Headers\nxlWB.Sheets(1).Cells(1, 1) = \"Sender\"\nxlWB.Sheets(1).Cells(1, 2) = \"Subject\"\nxlWB.Sheets(1).Cells(1, 3) = \"Date\"\nxlWB.Sheets(1).Cells(1, 4) = \"Size\"\nxlWB.Sheets(1).Cells(1, 5) = \"EmailID\"\n'ThisWorkbook.Sheets(1).Cells(1, 6) = \"Body\"\n\n'Export eMail Data from PST Folder\noRow = 1\nFor iRow = 1 To Folder.Items.Count\n    'If condition to import mails received in last 60 days\n    'To import all emails, comment or remove this IF condition\n   If VBA.DateValue(VBA.Now) -  VBA.DateValue(Folder.Items.Item(iRow).ReceivedTime) &lt;= 60 Then\n       oRow = oRow + 1\n       xlWB.Sheets(1).Cells(oRow, 1).Select\n       xlWB.Sheets(1).Cells(oRow, 1) = Folder.Items.Item(iRow).SenderName\n       xlWB.Sheets(1).Cells(oRow, 2) = Folder.Items.Item(iRow).Subject\n       xlWB.Sheets(1).Cells(oRow, 3) = Folder.Items.Item(iRow).ReceivedTime\n       xlWB.Sheets(1).Cells(oRow, 4) = Folder.Items.Item(iRow).Size\n       xlWB.Sheets(1).Cells(oRow, 5) = Folder.Items.Item(iRow).SenderEmailAddress\n       'ThisWorkbook.Sheets(1).Cells(oRow, 6) = Folder.Items.Item(iRow).Body\n    End If\nNext iRow\nMsgBox \"Outlook Mails Extracted to Excel\"\nSet Folder = Nothing\nSet sFolders = Nothing\n\nxlWB.Close False\nSet xlWB = Nothing\n\nxlApp.Quit\nSet xlApp = Nothing\n\nEnd_Lbl1:\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "openoffice-basic"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1456301118, "post_id": 35593416, "comment_id": 58877978, "body": "And which line of code causes the syntax error?"}, {"owner": {"reputation": 11, "user_id": 5972231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ea1ec9efd58d6ee9e060b9899731e83?s=128&d=identicon&r=PG", "display_name": "keylargo", "link": "https://stackoverflow.com/users/5972231/keylargo"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1456305862, "post_id": 35593416, "comment_id": 58880895, "body": "This line of code causes the syntax error:  oSheet in ThisComponent.CurrentController.ActiveSheet.getCellDim oSheet as Object"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1456306440, "post_id": 35593416, "comment_id": 58881315, "body": "Thanks, that will help people who know something about OO Basic. Since you&#39;re new you may not know that you can click the &quot;Edit&quot; button under your question to add additional information. I&#39;ve done that for you, in this instance :-) Good luck with your migration!"}], "answers": [{"comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1456324929, "post_id": 35604318, "comment_id": 58894809, "body": "Good answer, though I would disagree with your remark that asking  &quot;This is the code in Excel VBA; what is the code in OpenOffice Basic?&quot; They are different platforms and languages, but they are both spreadsheets and OpenOffice is even by design somewhat similar to Microsoft Office. The fact that they are fairly different in many ways just implies that the needed porting isn&#39;t purely mechanical."}, {"owner": {"reputation": 10032, "user_id": 5100564, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZZ7Z5.png?s=128&g=1", "display_name": "Jim K", "link": "https://stackoverflow.com/users/5100564/jim-k"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1456327445, "post_id": 35604318, "comment_id": 58896504, "body": "@JohnColeman: Okay, I toned back my statement somewhat. Really I am not all that familiar with VBA. When I &quot;port&quot; macros, I typically look at the GUI front end and read the help for the Excel macro, and then rewrite that functionality in one of the OpenOffice UNO-enabled languages."}], "tags": [], "owner": {"reputation": 10032, "user_id": 5100564, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZZ7Z5.png?s=128&g=1", "display_name": "Jim K", "link": "https://stackoverflow.com/users/5100564/jim-k"}, "is_accepted": false, "score": 1, "last_activity_date": 1456325758, "last_edit_date": 1456325758, "creation_date": 1456322685, "answer_id": 35604318, "question_id": 35593416, "link": "https://stackoverflow.com/questions/35593416/how-to-port-excel-vba-to-openoffice-basic/35604318#35604318", "title": "How to port Excel VBA to OpenOffice basic?", "body": "<p>It looks like there are a number of issues with this code.  Let's take a look at this line:</p>\n\n<blockquote>\n  <p>ThisComponent.CurrentController.ThisComponent.CurrentController.ActiveSheet.getcellDim oSheet as Object[n]oSheet = ThisComponent.CurrentController.ActiveSheet[n]oSheet.getCellRangeByName($1)ByName((\"B10\")).Value = \"My Current Time of the System:\"</p>\n</blockquote>\n\n<ul>\n<li>It is way too long.  You need to press <kbd>Enter</kbd> to add several line breaks.</li>\n<li>It says \"ThisComponent.CurrentController\" twice.</li>\n<li><code>Dim oSheet as Object[n]</code> -- but n was never declared or defined.</li>\n<li><code>ActiveSheet.getcell</code> -- I am not aware of any such method.  See <a href=\"https://wiki.openoffice.org/wiki/Documentation/BASIC_Guide/Cells_and_Ranges\" rel=\"nofollow\">https://wiki.openoffice.org/wiki/Documentation/BASIC_Guide/Cells_and_Ranges</a>.</li>\n<li><code>ByName((\"B10\"))</code> -- too many parentheses, and again, there is no such method as \"ByName\".</li>\n<li>What is <code>$1</code>?  Perhaps you mean a range like <code>\"$A1:$A5\"</code>.</li>\n</ul>\n\n<p>Also:</p>\n\n<ul>\n<li><code>Private Sub Workbook_Open</code> -- that looks like VBA, not OpenOffice Basic.</li>\n</ul>\n\n<p>For an introduction to OpenOffice macros with many excellent examples, see <a href=\"http://www.pitonyak.org/oo.php\" rel=\"nofollow\">Andrew Pitonyak's Macro Document</a>.</p>\n\n<p>Instead of saying:  \"This is the code in Excel VBA; what is the code in OpenOffice Basic?\",  ask a question on stackoverflow like the following:</p>\n\n<p>\"I need to select cell A1 in OpenOffice Basic.  Looking at (online source), I tried X but it gave Y error message about line Z.\"</p>\n"}], "owner": {"reputation": 11, "user_id": 5972231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ea1ec9efd58d6ee9e060b9899731e83?s=128&d=identicon&r=PG", "display_name": "keylargo", "link": "https://stackoverflow.com/users/5972231/keylargo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 964, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1456370292, "creation_date": 1456288937, "last_edit_date": 1456370292, "question_id": 35593416, "link": "https://stackoverflow.com/questions/35593416/how-to-port-excel-vba-to-openoffice-basic", "title": "How to port Excel VBA to OpenOffice basic?", "body": "<p>How to port Excel VBA macro to OpenOffice basic macro?</p>\n\n<p>Here is macro for refresh in every 5 seconds.</p>\n\n<pre><code>Private Sub Workbook_Open()\n' Written in ThisWorkbook\nCall RefreshTime\nEnd Sub\n\nSub RefreshTime()\n' Written in a module\nApplication.ScreenUpdating = False\nActiveWorkbook.RefreshAll\nApplication.OnTime Now + TimeValue(\"00:00:05\"), \"RefreshTime\"\nRange(\"B10\").Value = \"My Current Time of the System:\"\nRange(\"C10\").Value = Format(Now, \"hh:mm:ss AM/PM\")\nBeep\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>I tried convert this macro to OpenOffice macro (using <a href=\"http://www.business-spreadsheets.com/vba2oo.asp\" rel=\"nofollow\">http://www.business-spreadsheets.com/vba2oo.asp</a>)</p>\n\n<pre><code>Private Sub Workbook_Open()\n' Written in ThisWorkbook\nCall RefreshTime\nEnd Sub\nSub RefreshTime()\n' Written in a module\nThisComponent.LockControllers\nThisComponent.RefreshAll\nApplication.OnTime Now + TimeValue(\"00:00:05\"), \"RefreshTime\"\nThisComponent.CurrentController.ThisComponent.CurrentController.ActiveSheet.getCellDim oSheet as Object[n]oSheet = ThisComponent.CurrentController.ActiveSheet[n]oSheet.getCellRangeByName($1)ByName((\"B10\")).Value = \"My Current Time of the System:\"\nThisComponent.CurrentController.ThisComponent.CurrentController.ActiveSheet.getCellDim oSheet as Object[n]oSheet = ThisComponent.CurrentController.ActiveSheet[n]oSheet.getCellRangeByName($1)ByName((\"C10\")).Value = Format(Now, \"hh:mm:ss AM/PM\")\nBeep\nThisComponent.UnlockControllers\nEnd Sub\n</code></pre>\n\n<p>This line of code causes the syntax error is : </p>\n\n<pre><code>ThisComponent.CurrentController.ThisComponent.CurrentController.ActiveSheet.getCellDim oSheet as Object[n]oSheet =  ThisComponent.CurrentController.ActiveSheet[n]oSheet.getCellRangeByName($1)ByName((\"B10\")).Value = \"My Current Time of the System:\"\n</code></pre>\n\n<p>But got errors </p>\n\n<blockquote>\n  <p>BASIC syntax error. Expected:,.</p>\n</blockquote>\n\n<p>in the oSheet as Object. </p>\n\n<p>How to make it work in OpenOfffice?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": false, "score": 0, "last_activity_date": 1456291060, "creation_date": 1456291060, "answer_id": 35593817, "question_id": 35593390, "link": "https://stackoverflow.com/questions/35593390/copy-and-paste-in-vba-macro/35593817#35593817", "title": "Copy and paste in VBA macro", "body": "<p>you can use this code:</p>\n\n<pre><code>Sub test()\nDim i&amp;, cl As Range, SDate As Date, FDate As Date, k As Variant\nDim Dic As Object: Set Dic = CreateObject(\"Scripting.Dictionary\")\nDic.CompareMode = vbTextCompare\ni = [A:A].Find(\"*\", , , , , xlPrevious).Row\nFor Each cl In Range(\"A2:A\" &amp; i)\n    If Not Dic.exists(cl.Value2) Then Dic.Add cl.Value2, \"\"\nNext cl\nWorkbooks.Add: [A1] = \"Name\": [B1] = \"Date\"\nFDate = \"01/01/2017\": i = 2\nFor Each k In Dic\n    SDate = \"01/01/2016\"\n    While SDate &lt; FDate\n        Cells(i, \"A\").Value2 = k\n        Cells(i, \"B\").Value2 = SDate\n        Cells(i, \"B\").NumberFormat = \"DD/MM/YYYY\"\n        SDate = SDate + 1: i = i + 1\n    Wend\nNext k\nEnd Sub\n</code></pre>\n\n<p>source:</p>\n\n<p><a href=\"https://i.stack.imgur.com/gfudX.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gfudX.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/BBDGo.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BBDGo.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 9, "user_id": 5972277, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206849877660411/picture?type=large", "display_name": "Mark Gilston", "link": "https://stackoverflow.com/users/5972277/mark-gilston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456300996, "creation_date": 1456288757, "last_edit_date": 1456300996, "question_id": 35593390, "link": "https://stackoverflow.com/questions/35593390/copy-and-paste-in-vba-macro", "title": "Copy and paste in VBA macro", "body": "<p>I am really just starting to learn VBA and have used the site a number of times.   </p>\n\n<p>I have a real head scratcher and would love some help and guidance - hopefully it will help me understand it a bit better.</p>\n\n<p>What I essentially have is a big long list of Staff names in a column, and I need to create a row for each of those with the dates for the year 01/01/2016-31/12/2016. </p>\n\n<p>I have in column A on one sheet 3666 rows (10 x 01/01/2016-31/12/2016) and I wondered if I can write VBA to copy the values of the first staff name, and paste it down 366 rows in column B, then step down 1 row, copy the next staff Name, and paste down the next 366 rows, and repeat until all 10 staff names have been completed.</p>\n\n<p>Leaving me with a row for every staff name and every date of the year.</p>\n\n<p>Hope this makes sense.   </p>\n\n<p>Any help would be awesome</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1456287215, "post_id": 35592933, "comment_id": 58872330, "body": "have you tried <code>Workbook.FollowHyperlink</code> <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839280.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">Link Here</a>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1456292003, "post_id": 35592933, "comment_id": 58873854, "body": "Show the code you have which isn&#39;t working."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1529679613, "post_id": 35592933, "comment_id": 88976050, "body": "Does it really have &#39;a&#39; ?"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1530398110, "creation_date": 1530398110, "answer_id": 51119040, "question_id": 35592933, "link": "https://stackoverflow.com/questions/35592933/vba-to-click-on-href-link-on-web-page/51119040#51119040", "title": "VBA to click on href link on web page", "body": "<p>You could try</p>\n\n<pre><code>ie.document.querySelector(\"a[href=javascript:browserPrint();]\").Click\n</code></pre>\n\n<p>Targets the first element with <code>a</code> tag gaving <code>href</code> attribute with value <code>'javascript:browserPrint();'</code></p>\n"}], "owner": {"reputation": 381, "user_id": 5087003, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/da9063e840000c81e2ab61cded8be10f?s=128&d=identicon&r=PG&f=1", "display_name": "Amol Naik", "link": "https://stackoverflow.com/users/5087003/amol-naik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 920, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530398110, "creation_date": 1456286040, "last_edit_date": 1531164843, "question_id": 35592933, "link": "https://stackoverflow.com/questions/35592933/vba-to-click-on-href-link-on-web-page", "title": "VBA to click on href link on web page", "body": "<p>I am trying to click on link with has </p>\n\n<p><strong><code>&lt;'a' href=\"javascript:browserPrint();\" class=\"StaticLink\"&gt;Print&lt;/a&gt;\"</code></strong></p>\n\n<p>I have tried it with tag name but not working.Tag not able to find the href</p>\n\n<p>Could you please let me know how to click on href link</p>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1459596676, "post_id": 35592902, "comment_id": 60363315, "body": "I&#39;m voting to close this question as off-topic because it does not feature any body text."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 5972135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99e147afda513140b2e19ab3b94d87a0?s=128&d=identicon&r=PG&f=1", "display_name": "john bandiola", "link": "https://stackoverflow.com/users/5972135/john-bandiola"}, "edited": false, "score": 0, "creation_date": 1456385091, "post_id": 35593769, "comment_id": 58924108, "body": "thanks for  that. i&#39;m still new in programming...this program is to upload in AS400.but before that, the program should check first for duplicates...thanks for helping."}], "tags": [], "owner": {"reputation": 189, "user_id": 5864443, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/04eb27274038636a18b1951904139d80?s=128&d=identicon&r=PG&f=1", "display_name": "Hero1134", "link": "https://stackoverflow.com/users/5864443/hero1134"}, "is_accepted": false, "score": 1, "last_activity_date": 1456290800, "last_edit_date": 1495541255, "creation_date": 1456290800, "answer_id": 35593769, "question_id": 35592902, "link": "https://stackoverflow.com/questions/35592902/why-cant-this-vba-excel-code-read-duplicates/35593769#35593769", "title": "Why can&#39;t this VBA Excel code read duplicates?", "body": "<p>I think you should try \"And\" instead of \"Or\". The reason is because of a logic issue. I think someone has asked this question before. You can refer to the following post for some help. </p>\n\n<p><a href=\"https://stackoverflow.com/questions/19379981/check-a-record-for-duplicates-records-before-creating-new-records\">check a record for Duplicates Records, Before Creating New Records</a></p>\n\n<p>Anyway, his chain of thought is to give a name to the column and check if there is any duplicate in the row using the following formula. </p>\n\n<pre><code>rst.FindFirst \"[ID] &lt;&gt; \" &amp; Me.ID &amp; _\n \" AND [TitleText] = '\" &amp; Me.TitleText &amp; _\n \"' AND [UnitCode] = \" &amp; Me.UnitCode &amp; _\n \" AND [AcademicYear] = \" &amp; Me.AcademicYear &amp; _\n \" AND [Titleofchapterjournalarticle] = '\" &amp; Me.Titleofchapterjournalarticle &amp; \"'\"\n</code></pre>\n\n<p>Hope it helps. </p>\n"}], "owner": {"reputation": 5, "user_id": 5972135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99e147afda513140b2e19ab3b94d87a0?s=128&d=identicon&r=PG&f=1", "display_name": "john bandiola", "link": "https://stackoverflow.com/users/5972135/john-bandiola"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1593562441, "creation_date": 1456285845, "last_edit_date": 1593562441, "question_id": 35592902, "link": "https://stackoverflow.com/questions/35592902/why-cant-this-vba-excel-code-read-duplicates", "title": "Why can&#39;t this VBA Excel code read duplicates?", "body": "<pre><code>    r = 11\n\nDo While Not tgtWSheet.Cells(r, 2) = \"0\"\n\n    If tgtWSheet.Cells(r, 2) = tgtWSheet.Cells(r + 1, 2) Or tgtWSheet.Cells(r, 2) = tgtWSheet.Cells(r + 2, 2) Or tgtWSheet.Cells(r, 2) = tgtWSheet.Cells(r + 3, 2) Or tgtWSheet.Cells(r, 2) = tgtWSheet.Cells(r + 4, 2) Or tgtWSheet.Cells(r, 2) = tgtWSheet.Cells(r + 5, 2) Or tgtWSheet.Cells(r, 2) = tgtWSheet.Cells(r + 6, 2) Or tgtWSheet.Cells(r, 2) = tgtWSheet.Cells(r + 7, 2) Or tgtWSheet.Cells(r, 2) = tgtWSheet.Cells(r + 8, 2) Or tgtWSheet.Cells(r, 2) = tgtWSheet.Cells(r + 9, 2) Or tgtWSheet.Cells(r, 2) = tgtWSheet.Cells(r + 10, 2) Or tgtWSheet.Cells(r, 2) = tgtWSheet.Cells(r + 11, 2) Or tgtWSheet.Cells(r, 2) = tgtWSheet.Cells(r + 12, 2) Or tgtWSheet.Cells(r, 2) = tgtWSheet.Cells(r + 13, 2) Or tgtWSheet.Cells(r, 2) = tgtWSheet.Cells(r + 14, 2) Or tgtWSheet.Cells(r, 2) = tgtWSheet.Cells(r + 15, 2) Or tgtWSheet.Cells(r, 2) = tgtWSheet.Cells(r + 16, 2) Or tgtWSheet.Cells(r, 2) = tgtWSheet.Cells(r + 17, 2) Or tgtWSheet.Cells(r, 2) = tgtWSheet.Cells(r + 18, 2) Then\n\n        MsgBox \"Duplicate Record Found!\"\n        Exit Sub\n\n    Else\n\n        r = r + 1\n\n    End If\n\nLoop\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1456281838, "post_id": 35592261, "comment_id": 58870781, "body": "Which one VBA or VB6 ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1456282031, "post_id": 35592261, "comment_id": 58870842, "body": "The <a href=\"https://support.office.com/en-us/article/SUMIFS-function-C9E748F5-7EA7-455D-9406-611CEBCE642B\" rel=\"nofollow noreferrer\">SUMIFS function</a> will do this; e.g. <code>=sumifs($b4:$g4, $b$3:$g$3, $h$3)</code> . Use a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff834434.aspx\" rel=\"nofollow noreferrer\">WorksheetFunction object</a> if you have to perform the calculation in VBA or the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838835.aspx\" rel=\"nofollow noreferrer\">Range.Formula property</a> if you want to keep the formula."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1456282107, "post_id": 35592261, "comment_id": 58870862, "body": "btw, you are going to have to decide whether to use <code>CLIENT</code> or <code>CLIENTS</code>. There shouldn&#39;t be multiple versions of a criteria."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1456282270, "post_id": 35592261, "comment_id": 58870905, "body": "<a href=\"http://stackoverflow.com/questions/35588539/excel-vba-report-building#comment58863716_35588539\">As I said earlier</a>, this would be much, much simpler if you simply dumped your recordset into a worksheet, and created a pivot table for it."}, {"owner": {"reputation": 222, "user_id": 5932559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/2b032614454ca145d8715856daba434a?s=128&d=identicon&r=PG&f=1", "display_name": "FatBoySlim7", "link": "https://stackoverflow.com/users/5932559/fatboyslim7"}, "edited": false, "score": 0, "creation_date": 1456282728, "post_id": 35592261, "comment_id": 58871065, "body": "@jeeped its CLIENTS, my mistake"}, {"owner": {"reputation": 222, "user_id": 5932559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/2b032614454ca145d8715856daba434a?s=128&d=identicon&r=PG&f=1", "display_name": "FatBoySlim7", "link": "https://stackoverflow.com/users/5932559/fatboyslim7"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1456282771, "post_id": 35592261, "comment_id": 58871076, "body": "@Om3r I&#39;m building the report in VB6"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1456284155, "post_id": 35592261, "comment_id": 58871481, "body": "If you are writing this in VB6 then edit your question to include the relevant section of code."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1456285591, "post_id": 35592261, "comment_id": 58871872, "body": "Where is the merge command for B2:C2, D2:E2, etc?"}, {"owner": {"reputation": 222, "user_id": 5932559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/2b032614454ca145d8715856daba434a?s=128&d=identicon&r=PG&f=1", "display_name": "FatBoySlim7", "link": "https://stackoverflow.com/users/5932559/fatboyslim7"}, "edited": false, "score": 0, "creation_date": 1456286625, "post_id": 35592261, "comment_id": 58872161, "body": "@Jeeped this is vb6 code. I cannot include the excel spreadsheet from work as it has sensitive data. I created a sample spreadsheet to just show what I&#39;m trying to do."}], "answers": [{"comments": [{"owner": {"reputation": 222, "user_id": 5932559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/2b032614454ca145d8715856daba434a?s=128&d=identicon&r=PG&f=1", "display_name": "FatBoySlim7", "link": "https://stackoverflow.com/users/5932559/fatboyslim7"}, "edited": false, "score": 0, "creation_date": 1456283605, "post_id": 35592496, "comment_id": 58871330, "body": "I have to take the count of clients from 3 of the columns and put it under clients in TOTAL, same with STUDENTS. WIll that let me do that. Also, I need to make this dynamic, basically If a user adds another HEADING, this excel extract will automatically add it, so I cannot specify which column to start at. I can only be certain that the ROW in TOTAL will always be the same as the reports are formatted the same way. COLUMN will depend on how many HEADINGS there are."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 222, "user_id": 5932559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/2b032614454ca145d8715856daba434a?s=128&d=identicon&r=PG&f=1", "display_name": "FatBoySlim7", "link": "https://stackoverflow.com/users/5932559/fatboyslim7"}, "edited": false, "score": 0, "creation_date": 1456283999, "post_id": 35592496, "comment_id": 58871436, "body": "re: <i>&#39;WIll that let me do tha&#39;</i> - did you even try before asking? As for dynamic expansion a) it will depend upon how the user puts the new columns in b) you should be more worried about where it ends than where it starts. Seems to me that it will always start in column B. c) I thought the data came from a recordset, not from a user arbitrarily adding new columns wherever they like."}, {"owner": {"reputation": 222, "user_id": 5932559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/2b032614454ca145d8715856daba434a?s=128&d=identicon&r=PG&f=1", "display_name": "FatBoySlim7", "link": "https://stackoverflow.com/users/5932559/fatboyslim7"}, "edited": false, "score": 0, "creation_date": 1456284605, "post_id": 35592496, "comment_id": 58871609, "body": "I&#39;ve been playing around with it. The users enters it in an application. It gets saved in SQL SERVER. I select the data from there and create the extract in Excel. The extract is for viewing purposes only(for user). It will always start in the same place, the ending column is the issue, because it might vary. I edited the question to show you how i do it."}, {"owner": {"reputation": 222, "user_id": 5932559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/2b032614454ca145d8715856daba434a?s=128&d=identicon&r=PG&f=1", "display_name": "FatBoySlim7", "link": "https://stackoverflow.com/users/5932559/fatboyslim7"}, "edited": false, "score": 0, "creation_date": 1456344942, "post_id": 35592496, "comment_id": 58908267, "body": "Thanks for the code. The code works fine, but with one major exception. My app gets stuck when I get to this part.... If xlApp.Version = &quot;10.0&quot; Then         xlBook.SaveAs g_SQL      Else         xlBook.SaveAs g_SQL , 56     End If"}, {"owner": {"reputation": 222, "user_id": 5932559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/2b032614454ca145d8715856daba434a?s=128&d=identicon&r=PG&f=1", "display_name": "FatBoySlim7", "link": "https://stackoverflow.com/users/5932559/fatboyslim7"}, "edited": false, "score": 0, "creation_date": 1456345023, "post_id": 35592496, "comment_id": 58908321, "body": "it gets stuck on 56 (file format). Basically I have to restart my application. however, i commented out 56 and when I open it in excel, i get the usual - Incorrect Format error msg, but can see the spreadsheet. The columns are there, the totals are there. I&#39;m saving it in &quot;XLS&quot; format, so I need to use 56 - since all the other reports are done this way."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 222, "user_id": 5932559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/2b032614454ca145d8715856daba434a?s=128&d=identicon&r=PG&f=1", "display_name": "FatBoySlim7", "link": "https://stackoverflow.com/users/5932559/fatboyslim7"}, "edited": false, "score": 1, "creation_date": 1456345807, "post_id": 35592496, "comment_id": 58908801, "body": "I do not see <b>xlBook.SaveAs</b> anywhere on this page outside of your recent comment. Putting that aside for a moment, version 10.0 indicates xl2002 which did not have a native <a href=\"https://support.office.com/en-us/article/SUMIFS-function-C9E748F5-7EA7-455D-9406-611CEBCE642B\" rel=\"nofollow noreferrer\">SUMIFS function</a>. I&#39;m not sure if applying the <a href=\"https://www.microsoft.com/en-us/download/details.aspx\" rel=\"nofollow noreferrer\">Microsoft Office Compatibility Pack</a> will help but the old xl2002 should have it in any event."}, {"owner": {"reputation": 222, "user_id": 5932559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/2b032614454ca145d8715856daba434a?s=128&d=identicon&r=PG&f=1", "display_name": "FatBoySlim7", "link": "https://stackoverflow.com/users/5932559/fatboyslim7"}, "edited": false, "score": 0, "creation_date": 1456346931, "post_id": 35592496, "comment_id": 58909413, "body": "i saved it as xlsx with file format 51 and seems to be working."}, {"owner": {"reputation": 222, "user_id": 5932559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/2b032614454ca145d8715856daba434a?s=128&d=identicon&r=PG&f=1", "display_name": "FatBoySlim7", "link": "https://stackoverflow.com/users/5932559/fatboyslim7"}, "edited": false, "score": 0, "creation_date": 1456348835, "post_id": 35592496, "comment_id": 58910470, "body": "it looks like the SUM of students is coming up in clients and SUM of clients is coming up in students&#39; cell. Can you please help me, I have no idea how to chagne it?"}, {"owner": {"reputation": 222, "user_id": 5932559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/2b032614454ca145d8715856daba434a?s=128&d=identicon&r=PG&f=1", "display_name": "FatBoySlim7", "link": "https://stackoverflow.com/users/5932559/fatboyslim7"}, "edited": false, "score": 0, "creation_date": 1456349156, "post_id": 35592496, "comment_id": 58910649, "body": "I&#39;m sorry I&#39;m just having a hard time understanding the SUMIF formula. I have not stepped into it deep like that. This is the first time I&#39;m working on an excel report."}, {"owner": {"reputation": 222, "user_id": 5932559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/2b032614454ca145d8715856daba434a?s=128&d=identicon&r=PG&f=1", "display_name": "FatBoySlim7", "link": "https://stackoverflow.com/users/5932559/fatboyslim7"}, "edited": false, "score": 0, "creation_date": 1456409484, "post_id": 35592496, "comment_id": 58940589, "body": "so It was a simple edit and it seems to be calculating everything okay. now for the fill down, Could I just include it with the code you edited - the number of Rows where my calculations will go under each column (Clients, Students) is always going to be the same - as can be see in the first image. How would this look? Please help me i&#39;m struggling here. This will complete my report."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1456290454, "last_edit_date": 1456290454, "creation_date": 1456283312, "answer_id": 35592496, "question_id": 35592261, "link": "https://stackoverflow.com/questions/35592261/excel-report-formulas-vba/35592496#35592496", "title": "Excel report - formulas VBA", "body": "<p>Either the <a href=\"https://support.office.com/en-us/article/SUMIF-function-169B8C99-C05C-4483-A712-1697A653039B\" rel=\"nofollow noreferrer\">SUMIF function</a> or <a href=\"https://support.office.com/en-us/article/SUMIFS-function-C9E748F5-7EA7-455D-9406-611CEBCE642B\" rel=\"nofollow noreferrer\">SUMIFS function</a> can perform this handily.</p>\n\n<p>In H4 as a standard formula,</p>\n\n<pre><code>=sumifs($b4:$g4, $b$3:$g$3, h$3)\n</code></pre>\n\n<p>Fill both right and down.</p>\n\n<p>In VBA as,</p>\n\n<pre><code>with worksheets(\"Sheet1\")\n    .range(\"H4:I8\").formula = \"=sumifs($b4:$g4, $b$3:$g$3, h$3)\"\n    'optional revert to values only\n    '.range(\"H4:I8\") = .range(\"H4:I8\").values\nend with\n</code></pre>\n\n<p>You will have to determine the extents of the clients/students ranges but half of that is done simply knowing where to put the formula (e.g. H4).</p>\n\n<p><strong>VBA</strong></p>\n\n<p>I've removed a lot of the redundancy that your original code used. Given that you are not yet populating data into the client/student columns, I've used a method where a Total column(s) is always written to the right complete with formulas. If there is another row set, that Totals will be overwritten and a new one created to the right. </p>\n\n<pre><code>Dim xlStartCol As Long\nxlStartCol = xlCol\nDo While Not g_RS3.EOF\n    With xlSheet.Cells(xlRow, xlCol)\n        .Resize(1, 2).Merge\n        .Value = \"TEST\" 'g_RS3(\"ShortLabel\")\n        .Offset(1, 0).Resize(1, 2) = Array(\"Clients\", \"Students\")\n        .Offset(2, 0).Resize(1, 2).ClearContents\n        With .Offset(0, 1)\n            .Resize(1, 2).Merge\n            .Value = \"Total\"   'keep writing Total to the right; it will be overwritten if there is another ShortLabel\n            .Offset(1, 0).Resize(1, 2) = Array(\"Clients\", \"Students\")\n            .Offset(2, 0).Resize(1, 2).Formula = _\n                \"=SUMIFS(\" &amp; Range(.Parent.Cells(xlRow + 2, xlStartCol), .Parent.Cells(xlRow + 2, xlCol + 1)).Address(0, 1) &amp; Chr(44) &amp; _\n                             Range(.Parent.Cells(xlRow + 1, xlStartCol), .Parent.Cells(xlRow + 1, xlCol + 1)).Address(1, 1) &amp; Chr(44) &amp; _\n                             .Parent.Cells(xlRow + 1, xlCol - 1).Address(1, 0) &amp; Chr(41)\n        End With\n        With .Resize(2, 4)\n            .Font.Bold = True\n            .VerticalAlignment = xlCenter\n            .HorizontalAlignment = xlCenter\n            .Borders.Weight = xlThin\n        End With\n    End With\n    xlCol = xlCol + 2\n    g_RS3.MoveNext\nLoop\n</code></pre>\n\n<p>Once you have actually populated the data into each pair of columns and know the extents, simply use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838404.aspx\" rel=\"nofollow noreferrer\">Range.FillDown method</a> to populate the remaining formulas.</p>\n\n<p>\u00a0\u00a0<a href=\"https://i.stack.imgur.com/0X4eJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0X4eJ.png\" alt=\"xlCol\"></a></p>\n\n<p>I would recommend removing portions of recorded code that are not relevant. Recorded code is very verbose and hampers readability. You might also want to look into the <code>For XML</code> method of creating a query in T-SQL. This will expand the columns returned and allow you to use a fields count to determine the extents.</p>\n"}], "owner": {"reputation": 222, "user_id": 5932559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/2b032614454ca145d8715856daba434a?s=128&d=identicon&r=PG&f=1", "display_name": "FatBoySlim7", "link": "https://stackoverflow.com/users/5932559/fatboyslim7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 35592496, "answer_count": 1, "score": 0, "last_activity_date": 1456290454, "creation_date": 1456281631, "last_edit_date": 1456284788, "question_id": 35592261, "link": "https://stackoverflow.com/questions/35592261/excel-report-formulas-vba", "title": "Excel report - formulas VBA", "body": "<p>I'm having a little difficulty with something on my report that I'm building in VB6. Bascially I'm building a dynamic report where the Headings, and 2 columns (clients, students) get populated from a recordset. As you can see in the picture, at the end of my headings, I added a TOTAL heading with clients and students below. I'm trying to take a total of all clients in each of the columns and have it be summed up under TOTAL, same with students. The number of columns (UCLA, SDU, SCCU) might vary, so I'm trying to make it dynamic.Basically start with total for A, then B, then C, D and NONE. Any ideas?\n<a href=\"https://i.stack.imgur.com/uJaIZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uJaIZ.png\" alt=\"enter image description here\"></a>\nEDIT: I select the SHORT LABEL from SQL SERVER and populate until g_RS3 is empty</p>\n\n<pre><code>Do While Not g_RS3.EOF\n    With xlSheet.Cells(xlRow, xlCol)\n        .Value = g_RS3(\"ShortLabel\")\n            .Offset(1, 0).Value = \" Clients \"\n            .Offset(1, 1).Value = \" Students\"\n                With .Offset(1, 0)\n                    .Font.Bold = True\n                .Borders.Weight = xlThin\n            End With\n            With .Offset(1, 1)\n                .Font.Bold = True\n                .Borders.Weight = xlThin\n            End With\n            With .Resize(1, 2)\n                .Font.Bold = True\n                .WrapText = True\n                .VerticalAlignment = xlCenter\n                .Merge\n                .HorizontalAlignment = xlCenter\n                .Borders.Weight = xlThin\n            End With\n    End With\n    xlCol = xlCol + 2\n    g_RS3.MoveNext\nLoop\nWith xlSheet.Cells(xlRow, xlCol)\n    .Value = \"TOTAL\"\n        .Offset(1, 0).Value = \"Clients\"\n        .Offset(1, 1).Value = \"Students\"\n            With .Offset(1, 0)\n                .Font.Bold = True\n            .Borders.Weight = xlThin\n        End With\n        With .Offset(1, 1)\n            .Font.Bold = True\n            .Borders.Weight = xlThin\n        End With\n        With .Resize(1, 2)\n            .Font.Bold = True\n            .WrapText = True\n            .VerticalAlignment = xlCenter\n            .Merge\n            .HorizontalAlignment = xlCenter\n            .Borders.Weight = xlThin\n        End With\nEnd With\n</code></pre>\n\n<p>Then I start in xlrow = 4 xlcol = 2 and populate the CLIENT AND STUDENT columns with data. The loops I have are quite long. But the user will only view the extract. What they do with it once its generated is up to them. The application gives them an option of adding a SHORTLABEL, which needs to be displayed in the extract once they generate it. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1456277236, "post_id": 35591221, "comment_id": 58869312, "body": "It may not be possible in all cases, For example in 2016, <i>WEEKNUM</i> #1 consists of only two days:  Friday January 1st and Saturday January 2nd."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1456277321, "post_id": 35591221, "comment_id": 58869339, "body": "You will also have to specify the year."}], "answers": [{"tags": [], "owner": {"reputation": 70, "user_id": 6032554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/115dfe83426cbfbf51bb743c5ff1db35?s=128&d=identicon&r=PG&f=1", "display_name": "Colin Mason", "link": "https://stackoverflow.com/users/6032554/colin-mason"}, "is_accepted": true, "score": 1, "last_activity_date": 1457812460, "creation_date": 1457812460, "answer_id": 35962570, "question_id": 35591221, "link": "https://stackoverflow.com/questions/35591221/find-date-given-weeknum-and-weekday-vba/35962570#35962570", "title": "Find date, given WEEKNUM and WEEKDAY - VBA", "body": "<p>You could use a table on a hidden sheet, and just used Vlookup to find the correct date. EG</p>\n\n<pre><code>DATE          WEEKDAY     WEEK NO    WEEKDAY + WEEK NO\n01/03/2016    Tuesday     Week 10    Tuesday 10\n02/03/2016    Wednesday   Week 10    Wednesday 10\n</code></pre>\n\n<p>In VBA, you could then look up the name of the sheet, which is the weekday, and got the week number from the filename of the workbook, then use vlookup to find the correct date.</p>\n\n<pre><code>weekNum = Mid(ThisWorkbook.Name, 6, 2)\nsearchStr = ActiveSheet.Name &amp; \" \" &amp; weekNum &amp; \" \" &amp; Format(Now(), \"YYYY\")\nrowNo = Application.WorksheetFunction.Match(searchStr, Sheets(\"WEEKLIST\").Range(\"D:D\"), 0)\n\nstrSubject = Format(Sheets(\"WEEKLIST\").Range(\"A\" &amp; rowNo).Value, \"DD/MM\")\n</code></pre>\n"}], "owner": {"reputation": 1362, "user_id": 4910205, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wz5LG.jpg?s=128&g=1", "display_name": "Brendan Gooden", "link": "https://stackoverflow.com/users/4910205/brendan-gooden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 327, "favorite_count": 0, "accepted_answer_id": 35962570, "answer_count": 1, "score": 0, "last_activity_date": 1457812460, "creation_date": 1456274832, "last_edit_date": 1531164843, "question_id": 35591221, "link": "https://stackoverflow.com/questions/35591221/find-date-given-weeknum-and-weekday-vba", "title": "Find date, given WEEKNUM and WEEKDAY - VBA", "body": "<p>I'm trying to find a way of finding a date value, given the WEEKNUM and WEEKDAY</p>\n\n<p>For example</p>\n\n<pre><code>WEEKNUM = 9\nWEEKDAY = 4   '(Wednesday)\n</code></pre>\n\n<p>I can use the below function to find the WEEKNUM from the date, but how can I go the other way around?</p>\n\n<pre><code>Function WEEKNUM(D As Date, FW As Integer) As Integer\n     WEEKNUM = CInt(Format(D, \"ww\", FW))\nEnd Function\n</code></pre>\n"}, {"tags": ["html", "vba"], "comments": [{"owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1456274387, "post_id": 35590776, "comment_id": 58868438, "body": "How to create a file <a href=\"http://stackoverflow.com/questions/11503174/how-to-create-and-write-to-a-txt-file-using-vba\" title=\"how to create and write to a txt file using vba\">stackoverflow.com/questions/11503174/&hellip;</a>.  How to open an html <a href=\"http://stackoverflow.com/questions/3166265/open-an-html-page-in-default-browser-with-vba\" title=\"open an html page in default browser with vba\">stackoverflow.com/questions/3166265/&hellip;</a>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1456275575, "post_id": 35590776, "comment_id": 58868809, "body": "HTML is just a plain text file: you can write one out using the built-in file tools in VBA or use the Scripting FileSystemObject."}], "answers": [{"comments": [{"owner": {"reputation": 769, "user_id": 4769865, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/oxMAK.gif?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/4769865/mike"}, "edited": false, "score": 1, "creation_date": 1456366894, "post_id": 35592173, "comment_id": 58917316, "body": "Not sure what the <code>Private Declare Function</code> at the top or the <code>ShellExecute</code> on the bottom do, but the rest of it was very helpful for creating the file. I used &#39;FollowHyperlink HTMLFile&#39; to open the file."}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 3, "last_activity_date": 1456281006, "creation_date": 1456281006, "answer_id": 35592173, "question_id": 35590776, "link": "https://stackoverflow.com/questions/35590776/can-i-create-and-open-an-html-file-with-vba/35592173#35592173", "title": "Can I create and open an HTML file with VBA?", "body": "<pre><code>Private Declare Function ShellExecute Lib \"shell32.dll\" Alias \"ShellExecuteA\" _\n     (ByVal hWnd As Long, ByVal lpOperation As String, ByVal lpFile As String, ByVal _\n     lpParameters As String, ByVal lpDirectory As String, ByVal nShowCmd As Long) As Long\n\nSub HTML()\n'   // Define your variables.\n    Dim HTMLFile As String\n\n    HTMLFile = ActiveWorkbook.Path &amp; \"\\test.html\"\n    Close\n\n'   // Open up the temp HTML file and format the header.\n    Open HTMLFile For Output As #1\n        Print #1, \"&lt;html&gt;\"\n        Print #1, \"&lt;head&gt;\"\n        Print #1, \"&lt;style type=\"\"text/css\"\"&gt;\"\n        Print #1, \"  body { font-size:12px;font-family:tahoma } \"\n        Print #1, \"&lt;/style&gt;\"\n        Print #1, \"&lt;/head&gt;\"\n        Print #1, \"&lt;body&gt;\"\n\n        Print #1, \"&lt;h2&gt; HELLO VBA HTML &lt;/h2&gt;\"\n\n        Print #1, \"&lt;/body&gt;\"\n        Print #1, \"&lt;/html&gt;\"\n    Close\n\n    ShellExecute 0&amp;, vbNullString, HTMLFile, vbNullString, _\n      vbNullString, SW_SHOWNORMAL\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 769, "user_id": 4769865, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/oxMAK.gif?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/4769865/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5386, "favorite_count": 3, "accepted_answer_id": 35592173, "answer_count": 1, "score": 1, "last_activity_date": 1456281006, "creation_date": 1456272255, "last_edit_date": 1456280988, "question_id": 35590776, "link": "https://stackoverflow.com/questions/35590776/can-i-create-and-open-an-html-file-with-vba", "title": "Can I create and open an HTML file with VBA?", "body": "<p>I have a function that generates the HTML, CSS, and JS that I want. All the code is stored in a string variable.</p>\n\n<p>How would I get VBA to create a .html file and open it in the default web browser?</p>\n"}, {"tags": ["excel", "excel-formula", "parent", "hierarchy", "vba"], "comments": [{"owner": {"reputation": 408, "user_id": 5517926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cb3f11c5ab7130fa6bca33a0747118?s=128&d=identicon&r=PG", "display_name": "Kris B", "link": "https://stackoverflow.com/users/5517926/kris-b"}, "edited": false, "score": 0, "creation_date": 1456272157, "post_id": 35590407, "comment_id": 58867704, "body": "By &#39;first row with an indent level of X&#39; do you mean as in top down, unconditionally?   Meaning if your indent level went top to bottom: 1,1,2,2,1,1,2,2. The last 2 in this sequence would have the parentID equal to the uniqueID of the first &#39;1&#39; in this sequence? Versus the 5th digit or 6th digit&#39;s uniqueId (3rd/4th &#39;1&#39; respectively)."}, {"owner": {"reputation": 408, "user_id": 5517926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cb3f11c5ab7130fa6bca33a0747118?s=128&d=identicon&r=PG", "display_name": "Kris B", "link": "https://stackoverflow.com/users/5517926/kris-b"}, "edited": false, "score": 0, "creation_date": 1456273343, "post_id": 35590407, "comment_id": 58868099, "body": "Assuming the previous assumption is true, you should be able to use the following formula starting in cell D2, and extending down.      =INDEX(B:B, MATCH(C1-1,C:C,0))"}, {"owner": {"reputation": 456, "user_id": 4072427, "user_type": "registered", "profile_image": "https://graph.facebook.com/542103473/picture?type=large", "display_name": "Bryan Linton", "link": "https://stackoverflow.com/users/4072427/bryan-linton"}, "reply_to_user": {"reputation": 408, "user_id": 5517926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cb3f11c5ab7130fa6bca33a0747118?s=128&d=identicon&r=PG", "display_name": "Kris B", "link": "https://stackoverflow.com/users/5517926/kris-b"}, "edited": false, "score": 0, "creation_date": 1456284342, "post_id": 35590407, "comment_id": 58871529, "body": "Yes Kris you&#39;re first statement is correct."}, {"owner": {"reputation": 456, "user_id": 4072427, "user_type": "registered", "profile_image": "https://graph.facebook.com/542103473/picture?type=large", "display_name": "Bryan Linton", "link": "https://stackoverflow.com/users/4072427/bryan-linton"}, "reply_to_user": {"reputation": 408, "user_id": 5517926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cb3f11c5ab7130fa6bca33a0747118?s=128&d=identicon&r=PG", "display_name": "Kris B", "link": "https://stackoverflow.com/users/5517926/kris-b"}, "edited": false, "score": 0, "creation_date": 1456329709, "post_id": 35590407, "comment_id": 58898184, "body": "To your second comment, it&#39;s close but it doesn&#39;t work.  Here is what it is returning from D2 on: #VALUE!, #N/A, 2, 3, 4, 5, 6, 6, 5, 5, 5, 5, 4, 4, 5, 5,, 4, 4, 5, 6, 6, 7, 7, 7, 7, 7, 6, 7 ... Should be: nothing, 2, 3, 4, 5, 6, 6, 5, 5, 5, 5, 4, 4, 14, 14, 4, 4, 18,"}, {"owner": {"reputation": 408, "user_id": 5517926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cb3f11c5ab7130fa6bca33a0747118?s=128&d=identicon&r=PG", "display_name": "Kris B", "link": "https://stackoverflow.com/users/5517926/kris-b"}, "edited": false, "score": 0, "creation_date": 1456344017, "post_id": 35590407, "comment_id": 58907713, "body": "Wrap the formula in IFERROR to remove the #Value. EG: =IFERROR(INDEX(....), &quot;&quot;) Also start at C2, not C1 for cell D2."}], "answers": [{"tags": [], "owner": {"reputation": 456, "user_id": 4072427, "user_type": "registered", "profile_image": "https://graph.facebook.com/542103473/picture?type=large", "display_name": "Bryan Linton", "link": "https://stackoverflow.com/users/4072427/bryan-linton"}, "is_accepted": false, "score": 0, "last_activity_date": 1459873194, "last_edit_date": 1459873194, "creation_date": 1456339619, "answer_id": 35610489, "question_id": 35590407, "link": "https://stackoverflow.com/questions/35590407/excel-create-hierarchy-given-level-in-order/35610489#35610489", "title": "Excel Create Hierarchy given level in order", "body": "<p>I figured it out.  I wrote a Visual Basic script that contains the following:</p>\n\n<pre><code>Function parent(r As Range) As Integer\n\ncurVal = r.Value\ndesiredCol = 2\n\nparentFound = False\n\ncounter = 1\n'loop through until parent is found or at beginning\nDo Until CInt(r.Row) &lt; 2 Or parentFound = True\n    If r.Offset(-counter, 0).Value &lt; curVal Then\n        parentFound = True\n        desiredRow = r.Offset(-counter, 0).Row\n    End If\n    counter = counter + 1\nLoop\n\nparent = r.Offset(-counter + 1, -1).Value\n\nEnd Function\n</code></pre>\n\n<p>This searches for the first cell above in the column with a level below it, and takes the value of the ID to the left of it.</p>\n"}], "owner": {"reputation": 456, "user_id": 4072427, "user_type": "registered", "profile_image": "https://graph.facebook.com/542103473/picture?type=large", "display_name": "Bryan Linton", "link": "https://stackoverflow.com/users/4072427/bryan-linton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1134, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459873194, "creation_date": 1456270364, "last_edit_date": 1531161705, "question_id": 35590407, "link": "https://stackoverflow.com/questions/35590407/excel-create-hierarchy-given-level-in-order", "title": "Excel Create Hierarchy given level in order", "body": "<p>I have an order of unique Id's and the level of their indentation.  They are in order so the parent of the current ID is the ID of the one with 1 less than the current indent level (e.g. if the current indent level is 3, the parent ID will be the id of the first row above it with an indent level of 3-1=2 which is UniqueID=4 in this case).</p>\n\n<p>Here is a sample of my data:\n<a href=\"https://i.stack.imgur.com/KaKIq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KaKIq.png\" alt=\"enter image description here\"></a></p>\n\n<p>I want a new column with the parent UniqueID of the current UniqueID.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2046, "user_id": 3775431, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/u3ZuC.jpg?s=128&g=1", "display_name": "bvmcode", "link": "https://stackoverflow.com/users/3775431/bvmcode"}, "edited": false, "score": 0, "creation_date": 1456268427, "post_id": 35589823, "comment_id": 58866199, "body": "by the file just being open to run the VBA should pin it"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1456268563, "post_id": 35589823, "comment_id": 58866257, "body": "<a href=\"http://answers.microsoft.com/en-us/office/forum/office_2013_release-word/where-are-pinned-documents-stored-in-office-2013/b10a9335-3f0e-4f24-aeb1-bb86a5183c67\" rel=\"nofollow noreferrer\">answers.microsoft.com/en-us/office/forum/&hellip;</a>"}, {"owner": {"reputation": 1362, "user_id": 4910205, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wz5LG.jpg?s=128&g=1", "display_name": "Brendan Gooden", "link": "https://stackoverflow.com/users/4910205/brendan-gooden"}, "reply_to_user": {"reputation": 2046, "user_id": 3775431, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/u3ZuC.jpg?s=128&g=1", "display_name": "bvmcode", "link": "https://stackoverflow.com/users/3775431/bvmcode"}, "edited": false, "score": 0, "creation_date": 1456269061, "post_id": 35589823, "comment_id": 58866480, "body": "@bvmcode the workbook will be on the recent list, but not pinned."}, {"owner": {"reputation": 1362, "user_id": 4910205, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wz5LG.jpg?s=128&g=1", "display_name": "Brendan Gooden", "link": "https://stackoverflow.com/users/4910205/brendan-gooden"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1456269097, "post_id": 35589823, "comment_id": 58866496, "body": "Thanks @TimWilliams - I&#39;ll see if I can make something work with adding registry keys."}], "answers": [{"tags": [], "owner": {"reputation": 1362, "user_id": 4910205, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wz5LG.jpg?s=128&g=1", "display_name": "Brendan Gooden", "link": "https://stackoverflow.com/users/4910205/brendan-gooden"}, "is_accepted": true, "score": 0, "last_activity_date": 1456983013, "last_edit_date": 1456983013, "creation_date": 1456982511, "answer_id": 35763836, "question_id": 35589823, "link": "https://stackoverflow.com/questions/35589823/pin-a-excel-2013-workbook-to-taskbar-with-vba/35763836#35763836", "title": "Pin a Excel 2013 workbook to taskbar with VBA", "body": "<p>Thanks to Tim Williams in the comments above, I was able to get a VBA code to add / remove registry keys that would pin and unpin items.</p>\n\n<pre><code>If RegKeyExists(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\14.0\\Access\\Security\\Trusted Locations\\BEApplication\\\") = False Then\n        ' Code for adding registry key\n            Dim myWS As Object, strPath\n            strPath = &lt;Folder Path&gt;\n            Set myWS = CreateObject(\"WScript.Shell\")\n\n            myWS.RegWrite \"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\14.0\\Access\\Security\\Trusted Locations\\BEApplication\\Path\",strPath,\"REG_SZ\"\n\n\n    Else\n        ' Key exists - do nothing\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 1362, "user_id": 4910205, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wz5LG.jpg?s=128&g=1", "display_name": "Brendan Gooden", "link": "https://stackoverflow.com/users/4910205/brendan-gooden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 515, "favorite_count": 0, "accepted_answer_id": 35763836, "answer_count": 1, "score": 0, "last_activity_date": 1456983013, "creation_date": 1456267798, "question_id": 35589823, "link": "https://stackoverflow.com/questions/35589823/pin-a-excel-2013-workbook-to-taskbar-with-vba", "title": "Pin a Excel 2013 workbook to taskbar with VBA", "body": "<p>Is there a way of pinning a workbook to the Excel pinned items list, using VBA?</p>\n\n<p>I've researched the internet high and low, but can't seem to find any good examples or even if a method is possible?</p>\n\n<p>Thanks!</p>\n\n<p><a href=\"https://i.stack.imgur.com/zVikm.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zVikm.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vb.net", "ms-access", "vba"], "comments": [{"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1456267692, "post_id": 35589766, "comment_id": 58865886, "body": "Is the database part of the project?  Or is it somewhere else that you specify in the connection string?  And why the Access-vba tag? Is it VB.NET or not?"}, {"owner": {"reputation": 202712, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 0, "creation_date": 1456268034, "post_id": 35589766, "comment_id": 58866023, "body": "Check the property Copy To Output Directory associated with your database file listed between the project files. It should be set to Copy Never"}, {"owner": {"reputation": 3, "user_id": 5971321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/501635456709910/picture?type=large", "display_name": "Kamil Lazarowicz", "link": "https://stackoverflow.com/users/5971321/kamil-lazarowicz"}, "edited": false, "score": 1, "creation_date": 1456268341, "post_id": 35589766, "comment_id": 58866167, "body": "Ok never mind, seems i havent looked properly, the answer is here <a href=\"http://stackoverflow.com/questions/19420999/changes-to-access-database-do-not-persist-when-running-app-in-visual-studio\" title=\"changes to access database do not persist when running app in visual studio\">stackoverflow.com/questions/19420999/&hellip;</a>"}, {"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "reply_to_user": {"reputation": 202712, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 0, "creation_date": 1456268561, "post_id": 35589766, "comment_id": 58866256, "body": "<a href=\"http://stackoverflow.com/q/17147249/1070452\">stackoverflow.com/q/17147249/1070452</a> is also from @Steve and very helpful"}], "owner": {"reputation": 3, "user_id": 5971321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/501635456709910/picture?type=large", "display_name": "Kamil Lazarowicz", "link": "https://stackoverflow.com/users/5971321/kamil-lazarowicz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "closed_date": 1456268458, "answer_count": 0, "score": 0, "last_activity_date": 1459413786, "creation_date": 1456267571, "last_edit_date": 1459413786, "question_id": 35589766, "link": "https://stackoverflow.com/questions/35589766/can-not-save-data-into-access-through-vb", "closed_reason": "Duplicate", "title": "Can not save data into access through VB", "body": "<p>When i run the code, input any data and save the data, then go check the access db file in the debug folder then the data des get saved. But if i rerun the code, all the data gets erased from the previous run. </p>\n\n<p>I do want the data go get saved and stay there once i rerun the code.</p>\n"}, {"tags": ["vba", "replace", "ms-word", "find", "superscript"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1456266865, "post_id": 35589268, "comment_id": 58865502, "body": "Word replaces these automatically as you type (there is a tick in the autoformat dialog). To apply this to existing text, select Autoformat from the menu and make sure the tick is set. To only apply this and not anything else, clear all other ticks except this one."}, {"owner": {"reputation": 3, "user_id": 3543838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51bb167a18deb8f2c649e1a56ff3201a?s=128&d=identicon&r=PG&f=1", "display_name": "enstmagoo", "link": "https://stackoverflow.com/users/3543838/enstmagoo"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1456284597, "post_id": 35589268, "comment_id": 58871604, "body": "Thanks GSerg for the comment. The problem is that I have several pages of information pasted from excel. It takes several minutes to manually find all the occurrences. I repeat the process a dozen times per week so some code would be a huge time saver."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1456297075, "post_id": 35589268, "comment_id": 58876008, "body": "It takes two seconds to bring up the autoformat dialog and click Autoformat. All these will be replaced."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1456302493, "post_id": 35589268, "comment_id": 58878701, "body": "Welcome to StackOverflow. Please take a moment to read the guidelines about asking questions on the site. You&#39;ll see that a certain amount of research on the asker&#39;s part is expected, along with code they&#39;ve tried and can&#39;t get to work. In order to stay within the guidelines I suggest you first take your question to an End-user forum, such as Super User here on StackExchange. Ask how to use Word&#39;s Find with wildcards feature to find what you want to look up. Once you have that working, record it in a macro - this will give you the code starting point. Then you can ask here how to modify it :-)"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1456304033, "post_id": 35589268, "comment_id": 58879662, "body": "@Cin While Word allows you to apply formatting when replacing things with regular expressions, the formatting has to be applied to the entire match. Because of this, the regular expression would need to contain a positive lookbehind to exclude the number itself from applying the superscript, and Word does not support zero-length assertions. A macro is possible, but would have to be written manually and involve use of an external regex library, finding the position of a match in <code>Range.Text</code> and converting the position back to <code>Range</code> to apply superscript (quite inefficient). +1 otherwise."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1456304696, "post_id": 35589268, "comment_id": 58880081, "body": "@gserg I&#39;m not suggesting regex, which is not &quot;native&quot; to Word or to VBA. A macro based on Word&#39;s internal Find can build a solid basis, if the OP wants a macro. It&#39;s up to the OP. But if code is not used then the question is off-topic on SO... Personally, I think long and hard before even considering AutoFormat because I simply do not trust it - but that&#39;s me and 25 years of &quot;taming&quot; Word :-)"}, {"owner": {"reputation": 3, "user_id": 3543838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51bb167a18deb8f2c649e1a56ff3201a?s=128&d=identicon&r=PG&f=1", "display_name": "enstmagoo", "link": "https://stackoverflow.com/users/3543838/enstmagoo"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1456375682, "post_id": 35589268, "comment_id": 58919898, "body": "@gserg Thanks for the comments. I have not had success with applying autoformat to existing text. Only to text that I will type. If i change it after pasting the unformatted text into the document, nothing changes. Of course, I can simply delete the last couple characters of the ordinal rank and retype the characters, calling on the autoformat to then produce the desired result, but this is not ideal with the amount of text I am working with. I hope this helps to explain my conundrum."}, {"owner": {"reputation": 3, "user_id": 3543838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51bb167a18deb8f2c649e1a56ff3201a?s=128&d=identicon&r=PG&f=1", "display_name": "enstmagoo", "link": "https://stackoverflow.com/users/3543838/enstmagoo"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1456375799, "post_id": 35589268, "comment_id": 58919945, "body": "@Cin Thanks Cindy for the thoughts. Optimizing code produced from recording a macro was my first idea, yet I didn&#39;t find success with this. Specifically, I was not able to find and select only the last two characters of the word. Finding the whole word was easy, but I only want to reformat the last two characters as superscript. Word&#39;s limitations with using regex seemed to be the hurdle for me. Take, for example, the postive lookbehind assertion (?&lt;=[0-9])th which should match the last two characters of &quot;9th&quot; but not the &quot;9&quot;. This does not work in Word for reasons that GSerg specified."}, {"owner": {"reputation": 3, "user_id": 3543838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51bb167a18deb8f2c649e1a56ff3201a?s=128&d=identicon&r=PG&f=1", "display_name": "enstmagoo", "link": "https://stackoverflow.com/users/3543838/enstmagoo"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1456378657, "post_id": 35589268, "comment_id": 58921059, "body": "@GSerg I have now edited my original question so that it contains the code I am now working with."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1456382853, "post_id": 35589268, "comment_id": 58922974, "body": "That&#39;s correct, it can&#39;t be done with Find/Replace alone - Find must be combined with macro code. If you have the code that finds the entire word that would be a good starting point. You cannot use RegEx, it needs to be Word&#39;s wild cards. The reason is that Find works directly with the Word content, including formatting. RegEx can only work independently of the in-place content, which means no formatting. Substitute the successful Find code in your question for the RegEx and I can show you how to modify it."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1456384546, "post_id": 35589268, "comment_id": 58923837, "body": "@enstmagoo You don&#39;t simply change the setting to make it work. You actually invoke the autoformat command that reformats the entire document, and you make sure only the relevant ticks are allowed in its settings before committing."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 3543838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51bb167a18deb8f2c649e1a56ff3201a?s=128&d=identicon&r=PG&f=1", "display_name": "enstmagoo", "link": "https://stackoverflow.com/users/3543838/enstmagoo"}, "edited": false, "score": 0, "creation_date": 1456417372, "post_id": 35621556, "comment_id": 58947119, "body": "Works like a dream. Thanks so much, I really appreciate it."}], "tags": [], "owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "is_accepted": true, "score": 0, "last_activity_date": 1456387482, "creation_date": 1456387482, "answer_id": 35621556, "question_id": 35589268, "link": "https://stackoverflow.com/questions/35589268/using-vba-in-word-to-find-and-format-ordinal-ranks-with-superscript/35621556#35621556", "title": "Using VBA in Word to find and format ordinal ranks with superscript", "body": "<pre class=\"lang-vb prettyprint-override\"><code>Private Function SuperscriptAll(ByVal where As Range, ByVal pattern As String, ByVal wildcards As Boolean)\n  Dim true_end As Long\n  true_end = where.End\n\n  With where.Find\n    .ClearFormatting\n    .ClearAllFuzzyOptions\n\n    Do While .Execute(pattern, MatchWildcards:=wildcards, Forward:=True, Wrap:=wdFindStop)\n      With .Parent\n        .MoveStart wdCharacter, 1\n        .Font.Superscript = True\n        .SetRange .End, true_end\n      End With\n    Loop\n  End With\nEnd Function\n\nPublic Sub ReplaceOrdinals()\n  SuperscriptAll ActiveDocument.Range, \"1st\", False\n  SuperscriptAll ActiveDocument.Range, \"2nd\", False\n  SuperscriptAll ActiveDocument.Range, \"3rd\", False\n  SuperscriptAll ActiveDocument.Range, \"[0-9]th\", True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 3543838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51bb167a18deb8f2c649e1a56ff3201a?s=128&d=identicon&r=PG&f=1", "display_name": "enstmagoo", "link": "https://stackoverflow.com/users/3543838/enstmagoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1223, "favorite_count": 0, "accepted_answer_id": 35621556, "answer_count": 1, "score": 0, "last_activity_date": 1594050827, "creation_date": 1456265438, "last_edit_date": 1594050827, "question_id": 35589268, "link": "https://stackoverflow.com/questions/35589268/using-vba-in-word-to-find-and-format-ordinal-ranks-with-superscript", "title": "Using VBA in Word to find and format ordinal ranks with superscript", "body": "<p>I am working in Microsoft Word and need VBA to find and format specific text as superscript. I am trying to format the following text as superscript, but only if the text immediately follows a number. Here's the four pieces of text I would need to find:</p>\n\n<p>st\nnd\nrd\nth</p>\n\n<p>Here's an example: </p>\n\n<p><em>Bill was 1st in the race, but was followed closely by the second place finisher, Steve.</em></p>\n\n<p>After applying the code to this example, the \"st\" of 1st would be formatted as a superscript, but the \"nd\" in second would be untouched.  </p>\n\n<p>Below is the code I am working with, but I can't seem to get it to work.</p>\n\n<pre><code>Sub ReplaceOrdinals()\n\nActiveDocument.Range.Select\n\nDim regExp As Object\nSet regExp = CreateObject(\"vbscript.regexp\")\n\nWith regExp\n    .Pattern = \"(?&lt;=[0-9])[dhnrst]{2}\"\n    .Global = True\n    Selection.Font.Superscript = wdToggle\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql-server", "vba"], "comments": [{"owner": {"reputation": 434877, "user_id": 330315, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4b152262d9ba55197f609625358ff7e0?s=128&d=identicon&r=PG", "display_name": "a_horse_with_no_name", "link": "https://stackoverflow.com/users/330315/a-horse-with-no-name"}, "edited": false, "score": 1, "creation_date": 1456265380, "post_id": 35589190, "comment_id": 58864745, "body": "The error message is pretty clear: you turned on identity insert for <code>PropertyAssets</code> but never turned it off."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1456265511, "post_id": 35589190, "comment_id": 58864811, "body": "<a href=\"http://stackoverflow.com/q/23832598/11683\">&quot;At any time, only one table in a session can have the IDENTITY_INSERT property set to ON&quot;</a>"}, {"owner": {"reputation": 8233, "user_id": 1469457, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/72853d2b57e37aab89afe61af4f74c62?s=128&d=identicon&r=PG", "display_name": "Maury Markowitz", "link": "https://stackoverflow.com/users/1469457/maury-markowitz"}, "edited": false, "score": 0, "creation_date": 1456268036, "post_id": 35589190, "comment_id": 58866025, "body": "Ahh. Well that&#39;s definitely NOT clear from the error message itself,but I get the gist. This gets harder and harder by the second."}], "answers": [{"tags": [], "owner": {"reputation": 18953, "user_id": 4640209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86bc12112054e578fc0bcd333cbb2a2e?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4640209/alex"}, "is_accepted": true, "score": 24, "last_activity_date": 1456267623, "creation_date": 1456267623, "answer_id": 35589777, "question_id": 35589190, "link": "https://stackoverflow.com/questions/35589190/confusing-identity-insert-error-says-it-is-already-on-in-another-table/35589777#35589777", "title": "Confusing IDENTITY_INSERT error, says it is already on in another table", "body": "<p>You can only set <code>IDENTITY_INSERT</code> on for one table at a time in your session. If you want to use it on multiple tables, you need to set it <code>ON</code> and <code>OFF</code> consistently, see the template below:</p>\n\n<pre><code>SET IDENTITY_INSERT TableName ON\n\n--insert values with IDs\n\nSET IDENTITY_INSERT TableName OFF \n\nSET IDENTITY_INSERT PropertyAssets ON\n\n--insert value with IDs\n\nSET IDENTITY_INSERT PropertyAssets OFF\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 133, "user_id": 6441874, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-mELrRSZNfkQ/AAAAAAAAAAI/AAAAAAAAAoc/IP0ktxaHFpg/photo.jpg?sz=128", "display_name": "Maximiliano Ces&#225;n", "link": "https://stackoverflow.com/users/6441874/maximiliano-ces%c3%a1n"}, "edited": false, "score": 0, "creation_date": 1552524056, "post_id": 46444916, "comment_id": 97046775, "body": "I reconnected with other User Session, and it run without any issues"}], "tags": [], "owner": {"reputation": 41, "user_id": 3021374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cb6a27fd8fac547ba4970ccc6f2b24f?s=128&d=identicon&r=PG&f=1", "display_name": "user3021374", "link": "https://stackoverflow.com/users/3021374/user3021374"}, "is_accepted": false, "score": 4, "last_activity_date": 1506506323, "creation_date": 1506506323, "answer_id": 46444916, "question_id": 35589190, "link": "https://stackoverflow.com/questions/35589190/confusing-identity-insert-error-says-it-is-already-on-in-another-table/46444916#46444916", "title": "Confusing IDENTITY_INSERT error, says it is already on in another table", "body": "<p>You just need another session. I simply reconnected to the same database and it run without any issues.\nOf course I changed the script to set IDENTITY_INSERT to OFF in the end.</p>\n"}], "owner": {"reputation": 8233, "user_id": 1469457, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/72853d2b57e37aab89afe61af4f74c62?s=128&d=identicon&r=PG", "display_name": "Maury Markowitz", "link": "https://stackoverflow.com/users/1469457/maury-markowitz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10830, "favorite_count": 0, "accepted_answer_id": 35589777, "answer_count": 2, "score": 13, "last_activity_date": 1588255407, "creation_date": 1456265129, "question_id": 35589190, "link": "https://stackoverflow.com/questions/35589190/confusing-identity-insert-error-says-it-is-already-on-in-another-table", "title": "Confusing IDENTITY_INSERT error, says it is already on in another table", "body": "<p>I'm trying to rebuild a database from a text file, using VBA. To insert the ID values, I call this before sending in the INSERTs:</p>\n\n<pre><code>SET IDENTITY_INSERT TableName ON\n</code></pre>\n\n<p>This seems to work fine for most TableNames, but when I call it on table 'Accounts' I get an interesting error:</p>\n\n<pre><code>\"IDENTITY_INSERT is already ON for table 'test.dbo.PropertyAssets'. Cannot perform SET operation for table 'Accounts'.\"\n</code></pre>\n\n<p>I'm guessing this has to do with fkey constraints or such, but does anyone know for sure?</p>\n"}, {"tags": ["vba", "excel", "recordset"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1456263477, "post_id": 35588539, "comment_id": 58863716, "body": "Shouldn&#39;t that be a pivot table? Just dump your raw data into a worksheet, and pivot it. No?"}, {"owner": {"reputation": 222, "user_id": 5932559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/2b032614454ca145d8715856daba434a?s=128&d=identicon&r=PG&f=1", "display_name": "FatBoySlim7", "link": "https://stackoverflow.com/users/5932559/fatboyslim7"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1456263764, "post_id": 35588539, "comment_id": 58863868, "body": "Not sure. I&#39;m pretty much 95% done with the report, I just had a request that a TOTAL heading would help to take all the totals. Just trying to see how I can add it dynamically at the end of my recordset."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1456264389, "post_id": 35588539, "comment_id": 58864207, "body": "Side question: if <code>g_RS3</code> contains <i>headings</i>, then why isn&#39;t it called <code>rsHeadings</code> or something?"}, {"owner": {"reputation": 222, "user_id": 5932559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/2b032614454ca145d8715856daba434a?s=128&d=identicon&r=PG&f=1", "display_name": "FatBoySlim7", "link": "https://stackoverflow.com/users/5932559/fatboyslim7"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1456264586, "post_id": 35588539, "comment_id": 58864324, "body": "Because g_RS3 is being reused in many cases"}], "answers": [{"tags": [], "owner": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "is_accepted": false, "score": 0, "last_activity_date": 1456263912, "creation_date": 1456263912, "answer_id": 35588854, "question_id": 35588539, "link": "https://stackoverflow.com/questions/35588539/excel-vba-report-building/35588854#35588854", "title": "Excel VBA report building", "body": "<p>I think just adding one more WITH statement to add the TOTAL cells after your loop would do it.  xlCol should already be pointing to the next column based on the last part of the loop (xlCol = xlCol + 2), so I believe this should work.</p>\n\n<pre><code>Do While Not g_RS3.EOF\n    With xlSheet.Cells(xlRow, xlCol)\n        .Value = g_RS3(\"Label\")\n            .Offset(1, 0).Value = \"Clients\"\n            .Offset(1, 1).Value = \"Buyers\"\n                With .Offset(1, 0)\n                    .Font.Bold = True\n                .Borders.Weight = xlThin\n            End With\n            With .Offset(1, 1)\n                .Font.Bold = True\n                .Borders.Weight = xlThin\n            End With\n            With .Resize(1, 2)\n                .Font.Bold = True\n                .WrapText = True\n                .VerticalAlignment = xlCenter\n                .Merge\n                .HorizontalAlignment = xlCenter\n                .Borders.Weight = xlThin\n            End With\n    End With\n    xlCol = xlCol + 2\n    g_RS3.MoveNext\nLoop\n\n    With xlSheet.Cells(xlRow, xlCol)\n        .Value = \"TOTAL\"\n            .Offset(1, 0).Value = \"Clients\"\n            .Offset(1, 1).Value = \"Buyers\"\n                With .Offset(1, 0)\n                    .Font.Bold = True\n                .Borders.Weight = xlThin\n            End With\n            With .Offset(1, 1)\n                .Font.Bold = True\n                .Borders.Weight = xlThin\n            End With\n            With .Resize(1, 2)\n                .Font.Bold = True\n                .WrapText = True\n                .VerticalAlignment = xlCenter\n                .Merge\n                .HorizontalAlignment = xlCenter\n                .Borders.Weight = xlThin\n            End With\n    End With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1456266677, "last_edit_date": 1456266677, "creation_date": 1456264574, "answer_id": 35589033, "question_id": 35588539, "link": "https://stackoverflow.com/questions/35588539/excel-vba-report-building/35589033#35589033", "title": "Excel VBA report building", "body": "<p>This is a case where it makes sense to extract a stand-alone piece of functionality from your main code: the header block formatting can go into a separate Sub, so you can call it either from within the recordset loop or for a single set of headings</p>\n\n<p>Main code then becomes</p>\n\n<pre><code>'headers from recordset\nDo While Not g_RS3.EOF\n    DoBlock xlsheet.Cells(xlRow, xlCol), g_RS3(\"Label\"), \"Clients\", \"Buyers\"\n    g_RS3.MoveNext\n    xlCol = xlCol + 2\nLoop\n'Extra header\nDoBlock xlsheet.Cells(xlRow, xlCol), \"Total\", \"Clients\", \"Buyers\"\n</code></pre>\n\n<p>Extracted code:\nEDIT - tidied up</p>\n\n<pre><code>Sub DoBlock(rng As Range, h1, h2, h3)\n    With rng\n        .Value = h1\n        .WrapText = True\n        .VerticalAlignment = xlCenter\n        .HorizontalAlignment = xlCenter\n\n        .Offset(1, 0).Value = h2\n        .Offset(1, 1).Value = h3\n\n        With .Resize(2, 2)\n            .Font.Bold = True\n            .Borders.Weight = xlThin\n        End With\n        .Resize(1, 2).Merge\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 222, "user_id": 5932559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/2b032614454ca145d8715856daba434a?s=128&d=identicon&r=PG&f=1", "display_name": "FatBoySlim7", "link": "https://stackoverflow.com/users/5932559/fatboyslim7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 35589033, "answer_count": 2, "score": -1, "last_activity_date": 1456266677, "creation_date": 1456262898, "question_id": 35588539, "link": "https://stackoverflow.com/questions/35588539/excel-vba-report-building", "title": "Excel VBA report building", "body": "<p>I've been working on creating a dynamic report in MS Excel. I'm working on a legacy VB6 application and I've come across a few issue that I hope ya'll can help me resolve. What I'm doing below, is grabbing data into my recordset g_RS3 - typically this has anywhere from 3 to 20 items, and I use g_RS3 to enter values (headings, and 2 column values under each heading: clients, buyers) into my excel spreadsheet. I'm trying to make an edit to it but I've been struggling with it. This is my code....</p>\n\n<pre><code>Do While Not g_RS3.EOF\n    With xlSheet.Cells(xlRow, xlCol)\n        .Value = g_RS3(\"Label\")\n            .Offset(1, 0).Value = \"Clients\"\n            .Offset(1, 1).Value = \"Buyers\"\n                With .Offset(1, 0)\n                    .Font.Bold = True\n                .Borders.Weight = xlThin\n            End With\n            With .Offset(1, 1)\n                .Font.Bold = True\n                .Borders.Weight = xlThin\n            End With\n            With .Resize(1, 2)\n                .Font.Bold = True\n                .WrapText = True\n                .VerticalAlignment = xlCenter\n                .Merge\n                .HorizontalAlignment = xlCenter\n                .Borders.Weight = xlThin\n            End With\n    End With\n    xlCol = xlCol + 2\n    g_RS3.MoveNext\nLoop\n</code></pre>\n\n<p>I am attaching an image that will show what it looks like. At the end of the recordset I'm trying to add another heading that just says TOTAL and has the 2 columns below it. But I'm having a difficult time doing that. </p>\n\n<p><a href=\"https://i.stack.imgur.com/FRh1J.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FRh1J.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel", "outlook"], "comments": [{"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1456337327, "post_id": 35588419, "comment_id": 58903780, "body": "How would you use Outlook Object Model to open an EML file? So what you really need is a MIME parser, right?"}], "answers": [{"tags": [], "owner": {"reputation": 1362, "user_id": 4910205, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wz5LG.jpg?s=128&g=1", "display_name": "Brendan Gooden", "link": "https://stackoverflow.com/users/4910205/brendan-gooden"}, "is_accepted": false, "score": 0, "last_activity_date": 1456264553, "creation_date": 1456264553, "answer_id": 35589024, "question_id": 35588419, "link": "https://stackoverflow.com/questions/35588419/parse-the-body-of-an-eml-file-in-vba-excel/35589024#35589024", "title": "parse the body of an eml file in vba excel", "body": "<p>Have you tried using the .Body function?  <a href=\"https://support.microsoft.com/en-us/kb/219151\" rel=\"nofollow\">This</a> article may help.</p>\n\n<p>Note that this code is performed inside of Outlook, not Excel.</p>\n\n<pre><code>Sub ExportToExcel(MyMail As MailItem) Dim strID As String, olNS As Outlook.Namespace Dim olMail As Outlook.MailItem Dim strFileName As String\n\n'~~&gt; Excel Variables\nDim oXLApp As Object, oXLwb As Object, oXLws As Object\nDim lRow As Long\n\nstrID = MyMail.EntryID\nSet olNS = Application.GetNamespace(\"MAPI\")\nSet olMail = olNS.GetItemFromID(strID)\n\n'~~&gt; Establish an EXCEL application object\nOn Error Resume Next\nSet oXLApp = GetObject(, \"Excel.Application\")\n\n'~~&gt; If not found then create new instance\nIf Err.Number &lt;&gt; 0 Then\n    Set oXLApp = CreateObject(\"Excel.Application\")\nEnd If\nErr.Clear\nOn Error GoTo 0\n\n'~~&gt; Show Excel\noXLApp.Visible = True\n\n'~~&gt; Open the relevant file\nSet oXLwb = oXLApp.Workbooks.Open(\"C:\\Sample.xls\")\n\n'~~&gt; Set the relevant output sheet. Change as applicable\nSet oXLws = oXLwb.Sheets(\"Sheet1\")\n\nlRow = oXLws.Range(\"A\" &amp; oXLApp.Rows.Count).End(xlUp).Row + 1\n\n'~~&gt; Write to outlook\nWith oXLws\n    '\n    '~~&gt; Code here to output data from email to Excel File\n    '~~&gt; For example\n    '\n    .Range(\"A\" &amp; lRow).Value = olMail.Subject\n    .Range(\"B\" &amp; lRow).Value = olMail.SenderName\n    .Range(\"C\" &amp; lRow).Value = olMail.Body\n    '.Range(\"C\" &amp; lRow).Value = olMail.HTMLBody \n    '\nEnd With\n\n'~~&gt; Close and Clean up Excel\noXLwb.Close (True)\noXLApp.Quit\nSet oXLws = Nothing\nSet oXLwb = Nothing\nSet oXLApp = Nothing\n\nSet olMail = Nothing\nSet olNS = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5970909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/568083791e359f851bcf15c93edefaef?s=128&d=identicon&r=PG&f=1", "display_name": "arapp", "link": "https://stackoverflow.com/users/5970909/arapp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1098, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1456264553, "creation_date": 1456262438, "question_id": 35588419, "link": "https://stackoverflow.com/questions/35588419/parse-the-body-of-an-eml-file-in-vba-excel", "title": "parse the body of an eml file in vba excel", "body": "<p>My ultimate goal is to open an eml file in Excel vba and end up with the body of the message in a string that I can then use to search for different parameters.  I've found a solution using MailItem and an Outlook application, however the machine I'm working on errors out when running this code:</p>\n\n<pre><code>Set MyOutlook = New Outlook.Application\nSet x = MyOutlook.GetNamespace(\"MAPI\")\n</code></pre>\n\n<p>Outlook 2013 opens, but then gives me an error message saying OLMAPI32.dll and then crashes.  Eventually, I receive error 429 \"ActiveX component can't create object.\"</p>\n\n<p>I would like either a solution to this error or a workaround way to get the body of an eml file into a string.  I've been successful at getting the subject of the email by using this code:</p>\n\n<pre><code>Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\nSet objRegEx = CreateObject(\"VBScript.RegExp\")\nobjRegEx.Pattern = \"^Subject:\"\nDo Until objFile.AtEndOfStream\n   strSearchString = objFile.ReadLine\n   Set colMatches = objRegEx.Execute(strSearchString)\n   If colMatches.Count &gt; 0 Then\n       Cells(i, n) = strSearchString\n       i = i + 1\n       Exit Do\n   End If\nLoop\n</code></pre>\n\n<p>However, from examining a few random eml files, it doesn't appear like there is a way to flag the body of the text like I can with the subject.  </p>\n\n<p>Disregard the i and n, its not really relevant for this question.  I'm just placing the subject in a cell determined elsewhere. </p>\n\n<p>Any help is appreciated.  Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1456261828, "post_id": 35588173, "comment_id": 58862796, "body": "You want to use an array.  <code>Dim Var(1 ro 50) as integer</code> then you can use it like <code>Var(1) = 23</code> and so forth."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 5, "creation_date": 1456263283, "post_id": 35588173, "comment_id": 58863615, "body": "For the love of everything that is good in this world, please, don&#39;t do this. <b>Use meaningful names</b>, and if you need 50 values of <code>SomeMeaningfulName</code>, then use an array, like <code>SomeMeaningfulName(0 To 49) As Integer</code>. Don&#39;t call it <code>Var</code>, give it a name that tells whoever is maintaining that code (future you?) what these values are used for. If they&#39;re completely unrelated, then make a <code>Type</code> and give each one a meaningful name. And then thank yourself later (e.g. <i>was the column width of Sheet4!$A:$F stored in var23 or var47 again?</i>)"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1456263401, "post_id": 35588326, "comment_id": 58863674, "body": "Arrays declared with an implicit lower bound would be zero-based unless there&#39;s <code>Option Base 1</code> specified, which makes explicit boundaries <code>(1 To 50)</code> potentially confusing if <code>Option Base 1</code> <i>isn&#39;t</i> specified."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1456267453, "post_id": 35588326, "comment_id": 58865783, "body": "And please use a loop to assign those!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1456268198, "post_id": 35588326, "comment_id": 58866106, "body": "Not sure if you are serious but <code>For x = 1 to 50: Var(x) = x: Next x</code>"}, {"owner": {"reputation": 1362, "user_id": 4910205, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wz5LG.jpg?s=128&g=1", "display_name": "Brendan Gooden", "link": "https://stackoverflow.com/users/4910205/brendan-gooden"}, "edited": false, "score": 0, "creation_date": 1456268974, "post_id": 35588326, "comment_id": 58866441, "body": "Thanks! Yep definitely am serious... never too late to stop learning :)"}], "tags": [], "owner": {"reputation": 1362, "user_id": 4910205, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wz5LG.jpg?s=128&g=1", "display_name": "Brendan Gooden", "link": "https://stackoverflow.com/users/4910205/brendan-gooden"}, "is_accepted": false, "score": 3, "last_activity_date": 1456262132, "creation_date": 1456262132, "answer_id": 35588326, "question_id": 35588173, "link": "https://stackoverflow.com/questions/35588173/declare-automatically-variables-in-vba/35588326#35588326", "title": "Declare (automatically) variables in vba", "body": "<p>Use</p>\n\n<pre><code>Dim Var(1 to 50) as integer\n</code></pre>\n\n<p>Then you can set values for each like so</p>\n\n<pre><code>Var(1) = 1\nVar(2) = 2\nVar(3) = 3\nVar(4) = 4\nVar(5) = 5\nVar(6) = 6\nVar(7) = 7\nVar(8) = 8\nVar(9) = 9\nVar(10) = 10\nVar(11) = 11\nVar(12) = 12\nVar(13) = 13\nVar(14) = 14\nVar(15) = 15\nVar(16) = 16\nVar(17) = 17\nVar(18) = 18\nVar(19) = 19\nVar(20) = 20\nVar(21) = 21\nVar(22) = 22\nVar(23) = 23\nVar(24) = 24\nVar(25) = 25\nVar(26) = 26\nVar(27) = 27\nVar(28) = 28\nVar(29) = 29\nVar(30) = 30\nVar(31) = 31\nVar(32) = 32\nVar(33) = 33\nVar(34) = 34\nVar(35) = 35\nVar(36) = 36\nVar(37) = 37\nVar(38) = 38\nVar(39) = 39\nVar(40) = 40\nVar(41) = 41\nVar(42) = 42\nVar(43) = 43\nVar(44) = 44\nVar(45) = 45\nVar(46) = 46\nVar(47) = 47\nVar(48) = 48\nVar(49) = 49\nVar(50) = 50\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5862895, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iIrKq.png?s=128&g=1", "display_name": "Edwin", "link": "https://stackoverflow.com/users/5862895/edwin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1136, "favorite_count": 1, "answer_count": 1, "score": -4, "last_activity_date": 1456338552, "creation_date": 1456261657, "last_edit_date": 1531164843, "question_id": 35588173, "link": "https://stackoverflow.com/questions/35588173/declare-automatically-variables-in-vba", "title": "Declare (automatically) variables in vba", "body": "<p>Is it possible to declare (automatically) variables in vba and with increasing number?\nI have to Dim 50 variables,  like Var1  till  Var50\nIs it possible with vba code</p>\n\n<p>All my efforts (for next  with concatenate) didn't work</p>\n\n<p>The result should be;</p>\n\n<p>Dim Var1 as integer\nDim Var2 as integer\n.\n.\nDim Var50 as integer</p>\n"}, {"tags": ["vba", "excel", "userform"], "comments": [{"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 4, "creation_date": 1456259754, "post_id": 35587404, "comment_id": 58861640, "body": "You should show more code. Hard to tell with so little context."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1456266005, "post_id": 35587404, "comment_id": 58865072, "body": "Where&#39;s the code that turns events off and loads the form?"}, {"owner": {"reputation": 351, "user_id": 4484829, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/9e67521a149838fd6fb023c678716905?s=128&d=identicon&r=PG&f=1", "display_name": "KingKong", "link": "https://stackoverflow.com/users/4484829/kingkong"}, "edited": false, "score": 0, "creation_date": 1456268434, "post_id": 35587404, "comment_id": 58866200, "body": "I&#39;ve included this gist of what I&#39;m working with above.  I tried doing a very simple test case in a separate workbook and that worked OK with no errors, so now I&#39;m even more confused."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1456270691, "post_id": 35587404, "comment_id": 58867140, "body": "Everything looks fine to me. use For index = 1 to 500  Debug.Print Error$(index) Next index to find error? Also is text box one not a double value? Also clearly the OK_Click sub is what is firing the worksheet change events so thats obviously related."}, {"owner": {"reputation": 351, "user_id": 4484829, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/9e67521a149838fd6fb023c678716905?s=128&d=identicon&r=PG&f=1", "display_name": "KingKong", "link": "https://stackoverflow.com/users/4484829/kingkong"}, "edited": false, "score": 0, "creation_date": 1456273998, "post_id": 35587404, "comment_id": 58868309, "body": "TextBox1 is always a double (number) when I click OK.  I can even still see the number in the textbox when the code crashes.  Events shouldn&#39;t be triggering again until after the form is closed since I disabled them prior to Showing the userform.  Unless ShowModal changes this which is kind of what I was asking."}], "owner": {"reputation": 351, "user_id": 4484829, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/9e67521a149838fd6fb023c678716905?s=128&d=identicon&r=PG&f=1", "display_name": "KingKong", "link": "https://stackoverflow.com/users/4484829/kingkong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 443, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1456268157, "creation_date": 1456259007, "last_edit_date": 1531164843, "question_id": 35587404, "link": "https://stackoverflow.com/questions/35587404/modeless-userform-causes-crash", "title": "Modeless userform causes crash", "body": "<p>I learned recently that changing the <strong><code>ShowModal</code></strong> property of a <strong><code>userform</code></strong> allows the user to still access the worksheet, so I changed mine from True to False.</p>\n\n<p>After doing that, when I click OK on the form, I get a <strong><code>\"Application-defined or object-defined error\"</code></strong>. </p>\n\n<p><strong><em>UPDATED</em></strong></p>\n\n<pre><code>sub CallForm()\n\nApplication.EnableEvents = False\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n\n    With myForm\n        .StartUpPosition = 0\n        .Left = Application.Left + (0.5 * Application.Width) - (0.5 * .Width)\n        .Top = Application.Top + (0.5 * Application.Height) - (0.5 * .Height)\n        .Show\n    End With\n\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\n\nend sub\n</code></pre>\n\n<p>And my userforms have code like this:</p>\n\n<pre><code>Private Sub OK_Click()\n\n    [myCell] = CDbl(TextBox1)\n    Unload Me\n\nEnd Sub\n</code></pre>\n\n<p>and that error occurs where I try to dump the textbox inputs into the worksheet.  While stepping through the code, the <strong><code>worksheet_change()</code></strong> triggers even though I turned <strong><code>EnableEvents</code></strong> Off prior.</p>\n\n<p>Anyone know why the error would occur?</p>\n"}]