[{"tags": ["excel", "vba", "excel-formula", "sum", "sumifs"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 4175744, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9f5e0b8f7449c3b6dfb23ba9aec2f598?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/4175744/adam"}, "edited": false, "score": 0, "creation_date": 1445471738, "post_id": 33271216, "comment_id": 54343456, "body": "Thank you for the reply, i need to add this to an existing report unfortunately"}, {"owner": {"reputation": 53, "user_id": 4175744, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9f5e0b8f7449c3b6dfb23ba9aec2f598?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/4175744/adam"}, "edited": false, "score": 0, "creation_date": 1445474071, "post_id": 33271216, "comment_id": 54344035, "body": "I have a &quot;total&quot; row and would like to added above it in a sub total row"}], "tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 0, "last_activity_date": 1445471783, "last_edit_date": 1445471783, "creation_date": 1445471637, "answer_id": 33271216, "question_id": 33271111, "link": "https://stackoverflow.com/questions/33271111/sumifs-on-filtered-data/33271216#33271216", "title": "SUMIFS on filtered data?", "body": "<p>Seems much the easiest way is with a PivotTable: <code>Group (B)</code> for FILTERS, <code>Store # (A)</code> for ROWS and Sum of <code>Sales (C)</code> for VALUES, then filter <code>Group (B)</code> to select 'Flowers` and filter rows to suit.</p>\n"}], "owner": {"reputation": 53, "user_id": 4175744, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9f5e0b8f7449c3b6dfb23ba9aec2f598?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/4175744/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1580, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1445471783, "creation_date": 1445470927, "last_edit_date": 1445471235, "question_id": 33271111, "link": "https://stackoverflow.com/questions/33271111/sumifs-on-filtered-data", "title": "SUMIFS on filtered data?", "body": "<p>I am looking for a way to do a SUMIFS that uses a filtered list. I would like to:</p>\n\n<ul>\n<li>Grab all the sales from Sheet \"Sales\" where Group = \"Flowers\", AND</li>\n<li>Store # on Sheet \"Sales\" matches the Filtered Store # list on sheet\" Report</li>\n</ul>\n\n<p>The following code will work only when there is no filter on the Store #'s:</p>\n\n<p><code>=SUMIFS(Sales!C:C,Sales!B:B,\"=FLOWERS\",Sales!A:A,Report!A:A)</code></p>\n\n<p><strong>Sheet 1 Name = Report</strong></p>\n\n<pre><code>   Row (filtered)      Store # (A)     \n====================|==============|\n|       21          |      13      |\n|       36          |      28      |   \n|       81          |      75      |   \n|       84          |      78      | \n</code></pre>\n\n<p><strong>Sheet 2 Name = Sales</strong></p>\n\n<pre><code>Store # (A)    Group (B)      Sales (C)    \n===========|==============|=============|\n|   21     |   Flowers    |     $100    |\n|   36     |   Flowers    |     $200    |   \n|   81     |    Bread     |     $500    |   \n|   1      |   Flowers    |     $600    | \n|   3      |   Flowers    |     $100    |\n|   36     |    Bread     |     $200    |   \n|   8      |    Bread     |     $100    |   \n|   84     |   Flowers    |     $300    | \n</code></pre>\n\n<p>Is there any way for me to accomplish this? So if when the filtered list changes, the total figure changes, similar to that of a subtotal.</p>\n"}, {"tags": ["vba", "date"], "comments": [{"owner": {"reputation": 29, "user_id": 5455711, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c6aa296acc7b696c1902fd916522ae45?s=128&d=identicon&r=PG&f=1", "display_name": "marvellosity123", "link": "https://stackoverflow.com/users/5455711/marvellosity123"}, "edited": false, "score": 0, "creation_date": 1445470619, "post_id": 33271006, "comment_id": 54343110, "body": "that doesnt stop it from listing only saturday for the weekday."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 5455711, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c6aa296acc7b696c1902fd916522ae45?s=128&d=identicon&r=PG&f=1", "display_name": "marvellosity123", "link": "https://stackoverflow.com/users/5455711/marvellosity123"}, "edited": false, "score": 0, "creation_date": 1445474290, "post_id": 33271290, "comment_id": 54344084, "body": "that was all I needed to do???? instead of having the name of the function all I needed to was have the actual function. darn ive got lots to learn"}], "tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": true, "score": 2, "last_activity_date": 1445472246, "creation_date": 1445472246, "answer_id": 33271290, "question_id": 33271006, "link": "https://stackoverflow.com/questions/33271006/find-month-names-withing-for-loop/33271290#33271290", "title": "find month names withing for loop", "body": "<p>this line <code>olweekdayname = WeekdayName(Weekday(dates))</code> must be inside of the loop, otherwise <code>olweekdayname</code> will not be changed, so your updated code is below, tested, works fine.</p>\n\n<pre><code>Sub netprofit()\n    Dim dates As Date\n    Dim count As Integer\n    dates = DateSerial(2014, 9, 1)\n    For count = 2 To 366\n        Select Case Weekday(dates)\n        Case 1, 7\n            Range(\"B\" &amp; count) = 0\n            Range(\"C\" &amp; count) = 0\n            Range(\"D\" &amp; count) = 0\n            Range(\"E\" &amp; count) = WeekdayName(Weekday(dates))\n            Range(\"F\" &amp; count) = MonthName(Month(dates))\n        Case Else\n            Range(\"C\" &amp; count) = Int((100 - 0 + 1) * Rnd + 0)\n            Range(\"D\" &amp; count) = Range(\"B\" &amp; count) - Range(\"C\" &amp; count)\n            Range(\"A\" &amp; count) = dates\n            Range(\"E\" &amp; count) = WeekdayName(Weekday(dates))\n            Range(\"F\" &amp; count) = MonthName(Month(dates))\n        End Select\n        dates = dates + 1\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 5455711, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c6aa296acc7b696c1902fd916522ae45?s=128&d=identicon&r=PG&f=1", "display_name": "marvellosity123", "link": "https://stackoverflow.com/users/5455711/marvellosity123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 33271290, "answer_count": 1, "score": 1, "last_activity_date": 1445472246, "creation_date": 1445470303, "last_edit_date": 1445471795, "question_id": 33271006, "link": "https://stackoverflow.com/questions/33271006/find-month-names-withing-for-loop", "title": "find month names withing for loop", "body": "<p>It returns only saturday, for the dates it was simple because I only needed to add a plus 1 but how to i get it to loop from 1 to 7? Also how about for the months names as well </p>\n\n<pre><code>Sub netprofit()\n\nDim dates As Date\nDim count As Integer\n\nDim olweekdayname As String\n\nolweekdayname = WeekdayName(Weekday(dates))\n\ndates = DateSerial(2014, 9, 1)\nFor count = 2 To 366\n\nSelect Case Weekday(dates)\n\nCase 1, 7\n\n    Range(\"B\" &amp; count) = 0\n\n    Range(\"C\" &amp; count) = 0\n\n    Range(\"D\" &amp; count) = 0\n    Range(\"E\" &amp; count) = olweekdayname\n\n\nCase Else\n    Range(\"C\" &amp; count) = Int((100 - 0 + 1) * Rnd + 0)\n    Range(\"D\" &amp; count) = Range(\"B\" &amp; count) - Range(\"C\" &amp; count)\n    Range(\"A\" &amp; count) = dates\n    Range(\"E\" &amp; count) = olweekdayname\n\nEnd Select\ndates = dates + 1\n\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "for-loop", "foreach"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1445470039, "post_id": 33270806, "comment_id": 54342925, "body": "You don&#39;t need the <code>.cell</code>  just <code>Q.Value</code>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1445471824, "post_id": 33270806, "comment_id": 54343478, "body": "Same with <code>F.Cell.value</code>, you don&#39;t need the <code>.Cell</code>  This is because VB will treat <code>F</code> as a range, (i.e. Range(&quot;A1&quot;), then Range(&quot;A2&quot;), as it iterates).  Therefore you don&#39;t need <code>.Cell</code>."}], "answers": [{"tags": [], "owner": {"reputation": 859, "user_id": 2666502, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/zGVE6.gif?s=128&g=1", "display_name": "mtholen", "link": "https://stackoverflow.com/users/2666502/mtholen"}, "is_accepted": true, "score": 0, "last_activity_date": 1445471811, "creation_date": 1445471811, "answer_id": 33271230, "question_id": 33270806, "link": "https://stackoverflow.com/questions/33270806/how-does-one-properly-write-the-following-nested-for-each-loops/33271230#33271230", "title": "How does one properly write the following nested For Each loops?", "body": "<p>GD Liamwilt,</p>\n\n<p>AS per @Scott Cramer's answer.</p>\n\n<p>Try this:</p>\n\n<pre><code>Sub t()\n\nDim F As Range\nDim Q As Range\n\nFor Each F In Range(\"A1:C1\").Cells\n    For Each Q In Range(\"A2:C2\").Cells\n        If Q.Value &lt;= (F.Value + 1.2) Then\n            F.Offset(1, 0).Value = Q.Value\n            Exit For\n        End If\n    Next Q\nNext F\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 123, "user_id": 3892903, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6dadb7ae03280bf6cc5936da793445b6?s=128&d=identicon&r=PG&f=1", "display_name": "zzz", "link": "https://stackoverflow.com/users/3892903/zzz"}, "edited": false, "score": 0, "creation_date": 1445635043, "post_id": 33271418, "comment_id": 54422052, "body": "so, what we have so far seems to be working, but only to a point. first, i should explain that my rows of data do not just extend from A to D, but instead EG to IB. i also wish to compare &quot;EG1:IB1&quot; to each row individually down to and including &quot;EG48:IB48&quot; (47 comparisons). the principals are the same, but just required for a larger set. when I run your code, it sorts correspondents well for the first 4 or 5 cells, but then proceeds to erase large swaths of data thereafter and, toward the end, mismatch the number sets by a large margin. do you know why this might be happening? ty!"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 123, "user_id": 3892903, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6dadb7ae03280bf6cc5936da793445b6?s=128&d=identicon&r=PG&f=1", "display_name": "zzz", "link": "https://stackoverflow.com/users/3892903/zzz"}, "edited": false, "score": 0, "creation_date": 1445647097, "post_id": 33271418, "comment_id": 54425473, "body": "The answer illustrates the approach to the inital challange and works for the sample data you posted. Now you&#39;ll have to extrapolate and make it fit your requirements. You&#39;ll need to dynamically find the last row and column with data. If you&#39;re not sure how to do it, please accept one of the answers for this question, and open a new question to providing the test data in a link to a file so others will be able to guide you or adjust the code"}, {"owner": {"reputation": 123, "user_id": 3892903, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6dadb7ae03280bf6cc5936da793445b6?s=128&d=identicon&r=PG&f=1", "display_name": "zzz", "link": "https://stackoverflow.com/users/3892903/zzz"}, "edited": false, "score": 0, "creation_date": 1445808140, "post_id": 33271418, "comment_id": 54467092, "body": "I will take further action. However, on the topic of your response, might you know what it is within your code that does not allow the program to function as desired beyond the first 5 to 8 cells per row? I do not wish to run the program once for the entire sheet. I do want to run it once per each row combination. A dynamic search for the last cell with data may be necessary, but if you have accounted for cells possibly being set to nothing, and specified the row range to be searched, why might it be deleting a great deal of the cells&#39; data beyond the first 5 to 8 rows? Just curious."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 123, "user_id": 3892903, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6dadb7ae03280bf6cc5936da793445b6?s=128&d=identicon&r=PG&f=1", "display_name": "zzz", "link": "https://stackoverflow.com/users/3892903/zzz"}, "edited": false, "score": 0, "creation_date": 1445814200, "post_id": 33271418, "comment_id": 54468861, "body": "I&#39;d have to test it using the same data - if you provide a file it can be implemented so that it will sort each row from EG2:IB2 to EG48:IB48 based on the values in cells EG1:IB1"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 1, "last_activity_date": 1445473134, "creation_date": 1445473134, "answer_id": 33271418, "question_id": 33270806, "link": "https://stackoverflow.com/questions/33270806/how-does-one-properly-write-the-following-nested-for-each-loops/33271418#33271418", "title": "How does one properly write the following nested For Each loops?", "body": "<p>The comments and previous answer show you how to fix the Run-time error</p>\n\n<p>To get the end result you can use code like this:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub hSort()\n    Dim row1 As Range, c1 As Range, cr1 As Double\n    Dim row2 As Range, c2 As Range, cr2 As Double\n    Dim tmp As Variant\n\n    With Worksheets(\"Sheet1\")\n        Set row1 = .Range(\"A1:D1\")\n        Set row2 = .Range(\"A2:D2\")\n        For Each c1 In row1\n            For Each c2 In row2\n                If IsNumeric(c1) And IsNumeric(c2) And c2.Column &lt;&gt; c1.Column Then\n                    cr1 = Round(c1, 1)\n                    cr2 = Round(c2, 1)\n                    If cr2 &lt;= cr1 + 1.2 And cr2 &gt;= cr1 - 1.2 Then\n                        tmp = row2.Cells(, c1.Column)\n                        row2.Cells(, c1.Column) = c2\n                        c2 = tmp\n                        Exit For\n                    End If\n                End If\n            Next\n        Next\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Row1    68.39817    70.79805    73.1977\nRow2                73.68835    68.88472\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/cifi9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cifi9.png\" alt=\"hSort\"></a></p>\n"}], "owner": {"reputation": 123, "user_id": 3892903, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6dadb7ae03280bf6cc5936da793445b6?s=128&d=identicon&r=PG&f=1", "display_name": "zzz", "link": "https://stackoverflow.com/users/3892903/zzz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 33271230, "answer_count": 2, "score": 0, "last_activity_date": 1445473134, "creation_date": 1445469176, "question_id": 33270806, "link": "https://stackoverflow.com/questions/33270806/how-does-one-properly-write-the-following-nested-for-each-loops", "title": "How does one properly write the following nested For Each loops?", "body": "<p>So, I have a data sorting problem. Essentially, I must sort the cells of row 2 beneath their approximate values in row 1. </p>\n\n<p>The data will often appear as this: </p>\n\n<p><a href=\"https://i.stack.imgur.com/sYjvl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sYjvl.png\" alt=\"Mismatched\"></a></p>\n\n<p>But I require the data of Row2 to be sorted beneath its Row1 counterpart in approximate value (within 1.2 of it), like this: </p>\n\n<p><a href=\"https://i.stack.imgur.com/qpEFx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qpEFx.png\" alt=\"Sorted\"></a></p>\n\n<p>I believed the best way to accomplish this was to create a nested set of For Each loops, as written below:</p>\n\n<pre><code>Dim F As Range\nDim Q As Range\n\nFor Each F In Range(\"A1:C1\")\n    For Each Q In Range(\"A2:C2\")\n        If Q.Cell.Value &lt;= (F.Cell.Value + 1.2) Then\n            F.Offset(1, 0).Value = Q.Cell.Value\n            Exit For\n        End If\n    Next Q\nNext F\n</code></pre>\n\n<p>This has proven challenging, though. The intent was to iteratively check the values of Row1, as I have, and, if a value with the necessary criteria was found in Row2, place it beneath its correspondent in Row1. </p>\n\n<p>The code has halted, however, due to a \"Run-time error '438': Object doesn't support this property or method\".</p>\n\n<p>How can the code be properly written so as to avoid such or similar errors?</p>\n\n<p>Thank you much! And if you have any suggestions for improvement, feel free to advise.</p>\n\n<p>Best,</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "edited": false, "score": 0, "creation_date": 1445511503, "post_id": 33272534, "comment_id": 54359149, "body": "00 is not the only type, there are around 60 different types so the value can not be hardcoded in."}], "tags": [], "owner": {"reputation": 474, "user_id": 5060720, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/56fc8ec996b9fe62716185a2ba353693?s=128&d=identicon&r=PG&f=1", "display_name": "Emi", "link": "https://stackoverflow.com/users/5060720/emi"}, "is_accepted": false, "score": 1, "last_activity_date": 1445481740, "creation_date": 1445481740, "answer_id": 33272534, "question_id": 33270454, "link": "https://stackoverflow.com/questions/33270454/query-select-value-if-available-otherwise-use-specified-value/33272534#33272534", "title": "Query - Select value if available, otherwise use specified value", "body": "<p>May be Changing to this will help. </p>\n\n<pre><code>IIf(Forms!Input!ctype.value = \"00\", Forms!Input!ctype,\"XX\")\n</code></pre>\n"}], "owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1445481740, "creation_date": 1445467100, "question_id": 33270454, "link": "https://stackoverflow.com/questions/33270454/query-select-value-if-available-otherwise-use-specified-value", "title": "Query - Select value if available, otherwise use specified value", "body": "<p>This is my current table ( <a href=\"https://db.tt/1UVjhHCw\" rel=\"nofollow\">https://db.tt/1UVjhHCw</a> ) and the form ( <a href=\"https://db.tt/sNzqnEL6\" rel=\"nofollow\">https://db.tt/sNzqnEL6</a> ) and when I enter 00 as the type in the form, I want it to return only records that have 00.  If I enter 01 as the type, I want it to return only the records that have XX.  00 and 01 are not constants, there are around 60 different types in the real database.  </p>\n\n<p>I've tried using this <code>SELECT PrintList.KEY, PrintList.Family, PrintList.Type, PrintList.Class, PrintList.Shape FROM PrintList WHERE (((PrintList.Family)=Forms!Input!cfamily) And ((PrintList.Type)=IIf((PrintList.Type)=Forms!Input!ctype, Forms!Input!ctype,\"XX\")));</code> but it is returning 00 and XX records when the type is set as 00 ( <a href=\"https://db.tt/3RznlRpe\" rel=\"nofollow\">https://db.tt/3RznlRpe</a> ), if the type is XX it only returns records with XX and 01 returns just XX so it seems like if the value is 00 it is doing both but I'm not sure why.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 171, "user_id": 1731551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d680690f1e99f62be249c270f588c?s=128&d=identicon&r=PG", "display_name": "therak", "link": "https://stackoverflow.com/users/1731551/therak"}, "edited": false, "score": 0, "creation_date": 1445495273, "post_id": 33269632, "comment_id": 54349841, "body": "don&#39;t know if i got you right, but is your message text really in Column B in each row, or is it only in B2?"}, {"owner": {"reputation": 2528, "user_id": 4668368, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/70b77439d7ee9bb7410105b7bc912afb?s=128&d=identicon&r=PG&f=1", "display_name": "justaguy", "link": "https://stackoverflow.com/users/4668368/justaguy"}, "reply_to_user": {"reputation": 171, "user_id": 1731551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d680690f1e99f62be249c270f588c?s=128&d=identicon&r=PG", "display_name": "therak", "link": "https://stackoverflow.com/users/1731551/therak"}, "edited": false, "score": 0, "creation_date": 1445515912, "post_id": 33269632, "comment_id": 54361746, "body": "The date, which comes after the &#39;For&#39; is in B2, the comment on the next line comes from either C2 or D2. The data will always come from these cells. So even if there are 10 email addresses B2 and either C2 or D2 will be used. Depending on the &#39;x&#39; determines the comment used. Thank you :)."}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1445464207, "post_id": 33269704, "comment_id": 54340880, "body": "Both are valid. The OP&#39;s method of getting the range of used cells in column A works, instead of going down till it finds an empty cell it starts at the bottom and comes up till it finds a cell that is filled.  The second, the default of the range is <code>cells</code> and does not need to be stated."}], "tags": [], "owner": {"reputation": 1078, "user_id": 3124273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d5afe2c849c7123fd07f6ad1349bd2?s=128&d=identicon&r=PG&f=1", "display_name": "cronos2546", "link": "https://stackoverflow.com/users/3124273/cronos2546"}, "is_accepted": false, "score": 0, "last_activity_date": 1445463379, "creation_date": 1445463379, "answer_id": 33269704, "question_id": 33269632, "link": "https://stackoverflow.com/questions/33269632/excel-email-vba-works-for-one-recipient-not-all/33269704#33269704", "title": "excel email VBA works for one recipient not all", "body": "<pre><code>.Range(\"A2\", .Range(\"A\" &amp; .Rows.Count).End(xlUp)\n</code></pre>\n\n<p>Shouldn't this be </p>\n\n<pre><code> .Range(\"A2\", .Range(\"A2\").End(xlDown).Address)\n</code></pre>\n\n<p>And then</p>\n\n<pre><code>For Each c In Rng\n</code></pre>\n\n<p>Shouldn't this be Rng.Cells?</p>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1445523427, "creation_date": 1445523427, "answer_id": 33283254, "question_id": 33269632, "link": "https://stackoverflow.com/questions/33269632/excel-email-vba-works-for-one-recipient-not-all/33283254#33283254", "title": "excel email VBA works for one recipient not all", "body": "<p>As per your comment: <code>So even if there are 10 email addresses B2 and either C2 or D2 will be used</code> you need to change the code slightly.</p>\n\n<p>Currently you are grabbing the cell on the same row as the email address.  So if the email address is A4, you are trying to use B4,C1,D1....</p>\n\n<p>Change that part of the code to this:</p>\n\n<pre><code>    Msg = \"For \" &amp; ws.Cells(2, 2) &amp; Chr(14) &amp; Chr(14)\n    For i = 3 To 14\n        If LCase(WS.Cells(c.Row, i)) = \"x\" Then\n            Msg = Msg &amp; \"   -\" &amp; WS.Cells(2, i) &amp; Chr(14)\n        End If\n    Next\n</code></pre>\n"}], "owner": {"reputation": 2528, "user_id": 4668368, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/70b77439d7ee9bb7410105b7bc912afb?s=128&d=identicon&r=PG&f=1", "display_name": "justaguy", "link": "https://stackoverflow.com/users/4668368/justaguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 33283254, "answer_count": 2, "score": 0, "last_activity_date": 1445523427, "creation_date": 1445463098, "last_edit_date": 1531164843, "question_id": 33269632, "link": "https://stackoverflow.com/questions/33269632/excel-email-vba-works-for-one-recipient-not-all", "title": "excel email VBA works for one recipient not all", "body": "<p>The <code>VBA</code> below will send an email to multiple users, however only the first recipient gets a correct email.  So, if there are 10 address's in column A, then address 1 will get the correct email, all others get the word <code>For</code> and nothing else.  I'm not sure how to fix it, but think it is the offset?  Thank you :).</p>\n\n<p><strong>Correct Email</strong> in parenthesis is where the data is pulled from</p>\n\n<pre><code>**For 10/21/2015** ( Msg = \"For \" &amp; c.Offset(, 1) &amp; Chr(14) &amp; Chr(14)\n\n**-There are no issues to report in the HLA &amp; Molecular Diagnostics Laboratory.** (   For i = 3 To 14\n            If LCase(WS.Cells(c.Row, i)) = \"x\" Then\n                Msg = Msg &amp; \"   -\" &amp; WS.Cells(1, i) &amp; Chr(14)\n            End If\n        Next)\n</code></pre>\n\n<p><strong>VB</strong></p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim WS As Worksheet, Rng As Range, c As Range\nDim OutApp As Object, OutMail As Object\nDim Msg As String, Addr As String, FName As String, i As Long\nDim obj As Object\nDim MyFile As String, MyFileCopy As String\n\n'define path\nMyFileCopy = \"L:\\NGS\\HLA LAB\\total quality management\\QC &amp; QA\\DOSE reports\\DOSE reporting form Attachment.xlsx\"\n\n'create a separate sheet2 to mail out\nSheets(2).Copy\nSet wkb = ActiveWorkbook\nWith wkb\n    .SaveAs MyFileCopy\n    .Close True\nEnd With\n\n' create connection, check condition, send email\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet WS = ThisWorkbook.Sheets(\"Email\")\nWith WS\n    Set Rng = .Range(\"A2\", .Range(\"A\" &amp; .Rows.Count).End(xlUp))\nEnd With\n\n For Each c In Rng\n\n        Msg = \"For \" &amp; c.Offset(, 1) &amp; Chr(14) &amp; Chr(14)\n        For i = 3 To 14\n            If LCase(WS.Cells(c.Row, i)) = \"x\" Then\n                Msg = Msg &amp; \"   -\" &amp; WS.Cells(1, i) &amp; Chr(14)\n            End If\n        Next\n\n        Set OutMail = OutApp.CreateItem(0)\n\n        With OutMail\n            .To = c.Offset(, 0)\n            .CC = \"\"\n            .BCC = \"\"\n            .Subject = \"Daily Operational Safety Briefing\"\n            .Body = Msg\n            If LCase(c.Offset(, 3)) = \"x\" Then .Attachments.Add MyFileCopy, 1\n            .Send\n        End With\n\nNext c\n\n'confirm message sent and delete copy\nMsgBox \"The data has been emailed sucessfully.\", vbInformation\nKill MyFileCopy\n\nSet OutMail = Nothing\nSet OutApp = Nothing\n\n' Exit and do not save\nApplication.Quit\nThisWorkbook.Close SaveChanges:=False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1445463188, "post_id": 33269552, "comment_id": 54340401, "body": "Hmm maybe a workaround where you ask user for saveas name via an inputbox then do something like <code>activeworkbook.saveas filename:= [inputboxvariable] &amp; &quot;_extract&quot; then activeworkbook.close</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1445463311, "creation_date": 1445463311, "answer_id": 33269694, "question_id": 33269552, "link": "https://stackoverflow.com/questions/33269552/intercept-workbook-save-event-and-append-string-to-end-of-workbook-filename/33269694#33269694", "title": "Intercept workbook save event and append string to end of workbook filename", "body": "<p>Put this in your sub</p>\n\n<pre><code>Dim myFileName As String\nmyFileName = ActiveWorkbook.FullName\nActiveWorkbook.SaveAs Filename:=Split(myFileName, \".\")(0) &amp; \"test.\" &amp; Split(myFileName, \".\")(1)\n</code></pre>\n\n<p>Change the \"test.\" to anything you want but make sure it ends with a \".\"</p>\n"}, {"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 1, "last_activity_date": 1445466075, "creation_date": 1445466075, "answer_id": 33270260, "question_id": 33269552, "link": "https://stackoverflow.com/questions/33269552/intercept-workbook-save-event-and-append-string-to-end-of-workbook-filename/33270260#33270260", "title": "Intercept workbook save event and append string to end of workbook filename", "body": "<p>You can intercept the event from within ThisWorkbook module:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\n    Const CUSTOM_NAME As String = \"_extract\"\n\n    Dim fn As String\n\n    fn = Me.Name\n    If InStr(fn, \".\") &gt; 0 Then fn = Left(fn, InStrRev(fn, \".\") - 1)\n\n    Cancel = Not Right(fn, Len(CUSTOM_NAME)) = CUSTOM_NAME\n\n    If Cancel Then\n        Application.EnableEvents = False\n        'Application.DisplayAlerts = False\n        Me.SaveAs Me.Name &amp; \"_extract\" &amp; Right(Me.Name, InStrRev(Me.Name, \".\") - 1)\n        'Application.DisplayAlerts = True\n        Application.EnableEvents = True\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9405, "user_id": 701346, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ACosU.jpg?s=128&g=1", "display_name": "oscilatingcretin", "link": "https://stackoverflow.com/users/701346/oscilatingcretin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 441, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1445466075, "creation_date": 1445462774, "last_edit_date": 1531164843, "question_id": 33269552, "link": "https://stackoverflow.com/questions/33269552/intercept-workbook-save-event-and-append-string-to-end-of-workbook-filename", "title": "Intercept workbook save event and append string to end of workbook filename", "body": "<p>I know how to intercept a workbook's save event by doing this at module level:</p>\n\n<pre><code>Dim WithEvents app As Application\n\nPrivate Sub app_WorkbookBeforeSave(ByVal Wb As Workbook, ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\n\nEnd Sub\n</code></pre>\n\n<p>What I'd like to do is append a string to the end of the actual filename.  For example, if I save with the name <code>Sales.xls</code>, I would like to automatically be able to add <code>_extract</code> to the end so that the name is <code>Sales_extract.xls</code>, but I can't figure out how to do it.</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1445461984, "post_id": 33268873, "comment_id": 54339753, "body": "Do you want to send the latest (per your title) or the original (per your text)? How are you getting <code>myitem</code>?"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1445466223, "post_id": 33268873, "comment_id": 54341712, "body": "There may be lots of false positive. What if subject is like &quot;My team scored Very <b>Hi</b>gh last week&quot;?"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1445493023, "post_id": 33268873, "comment_id": 54348972, "body": "have you tried <code>.Body = &quot;Hey,there&quot; &amp; vbNewLine &amp; myitem.Forward</code>"}, {"owner": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "reply_to_user": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1445519558, "post_id": 33268873, "comment_id": 54364065, "body": "@DickKusleika I am looping all the emails in my inbox and that&#39;s how get myitem. Thanks."}, {"owner": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1445519642, "post_id": 33268873, "comment_id": 54364107, "body": "@PatricK I used &quot;Hi&quot; to just make it simple, in reality it&#39;s much more bigger Subject line. Thanks for pointing out though."}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1445520222, "post_id": 33268873, "comment_id": 54364464, "body": "Show the loop. You may just be looping in the wrong direction."}, {"owner": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1445520926, "post_id": 33268873, "comment_id": 54364932, "body": "@Om3r That just adds the subject line starting with &quot;FW:&quot; in the email and  does not get the entire body."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1445521376, "post_id": 33268873, "comment_id": 54365253, "body": "Add to the existing body: <code>.Body =  &quot;Hey, there&quot; &amp; vbCrLF &amp; .Body</code>"}, {"owner": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1445521851, "post_id": 33268873, "comment_id": 54365558, "body": "@DavidZemens Thanks! that works, I tried and found that the format changes in to plain text, do you know if that can be corrected?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1445522193, "post_id": 33268873, "comment_id": 54365803, "body": "Yes, either using the <code>HTMLBody</code> or by getting a handle on the <code>myitem.Forward.Inspector</code> which exposes an MS Word-like object which would allow you to manipulate the &quot;rich text&quot; body."}], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 2, "last_activity_date": 1445536833, "creation_date": 1445536833, "answer_id": 33287599, "question_id": 33268873, "link": "https://stackoverflow.com/questions/33268873/vba-doesnt-forward-the-latest-message-in-the-conversation/33287599#33287599", "title": "Vba doesn&#39;t forward the latest message in the conversation", "body": "<p>If you need to preserve the existing message you should to insert your text before the existing property value (in case of plain text emails). </p>\n\n<pre><code>  .Body = \"Hey,there\" + .Body\n</code></pre>\n\n<p>Or inject your HTML markup into the <code>&lt;body&gt;</code> element to keep the HTML markup well-formed. </p>\n\n<p>The Outlook object model provides three main ways for working with item bodies:</p>\n\n<ol>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ff865304(v=office.15).aspx\" rel=\"nofollow\">Body</a> -  a string representing the clear-text body of the Outlook item. </li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ff868941(v=office.15).aspx\" rel=\"nofollow\">HTMLBody</a> - a string representing the HTML body of the specified item.</li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ff868196(v=office.15).aspx\" rel=\"nofollow\">Word editor</a> - the Microsoft Word Document Object Model of the message being displayed. The WordEditor property of the Inspector class returns an instance of the Document class from the Word object model which you can use to set up the message body.</li>\n</ol>\n\n<p>You can read more about all these ways in the <a href=\"https://msdn.microsoft.com/en-us/library/dd492012%28v=office.12%29.aspx\" rel=\"nofollow\">Chapter 17: Working with Item Bodies</a>. It us up to you which way is to choose to customize the message body.</p>\n"}], "owner": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1592871907, "creation_date": 1445460190, "last_edit_date": 1592871907, "question_id": 33268873, "link": "https://stackoverflow.com/questions/33268873/vba-doesnt-forward-the-latest-message-in-the-conversation", "title": "Vba doesn&#39;t forward the latest message in the conversation", "body": "<pre><code>Set myNameSpace = myOlApp.GetNamespace(\"MAPI\")\nSet myInbox = myNameSpace.GetDefaultFolder(olFolderInbox)\nSet myitems = myInbox.Items\n\nFor Each myitem In myitems\n    If myitem.Class = olMail Then\n        If InStr(1, myitem.Subject, \"Hi\") &gt; 0 Then\n            If myitem.Sender.GetExchangeUser.PrimarySmtpAddress = \"xyz@abc.com\" Then\n                With myitem.Forward\n                    .Recipients.Add \"pqr@abc.com\"\n                    .CC = \"xyz@abc.com\"\n                    .Body = \"Hey,there\"\n                    .Send\n                End With\n            End if\n        End if\n    End if\nNext myitem\n</code></pre>\n\n<p>Basically if I got the <strong>last email with subject line</strong> as <strong>\"Hi\"</strong> from <strong>xyz</strong> then I want to <strong>forward</strong> it to <strong>pqr</strong> and <strong>CC xyz</strong> . Everthing works fine but the forwarded message is not the original one but it just composes a new email. I always want to add something while forwarding an email in addition to what I received from <strong>xyz</strong>. Can anyone help please. Thanks.</p>\n\n<p>Edit:- If I put a display command immediately after <strong>With myitem.Forward</strong> it shows the entire thread but it disappears and turns in to a new email once I add the recipient and the body. Also I think that it can interpret <strong>.body</strong> as the entire new body and I should find something which will add to existing body.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1445458962, "post_id": 33268493, "comment_id": 54338112, "body": "Those workbooks will need to be open to be searched. Or, those workbooks could, on closing, save a separate .CSV file which contains your data that Excel could open and search. Or, you could protect the worksheets in the source files so that no one can insert rows."}, {"owner": {"reputation": 65, "user_id": 5473166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d067c262e661bb37ada67c7f9fc5e525?s=128&d=identicon&r=PG&f=1", "display_name": "bidout", "link": "https://stackoverflow.com/users/5473166/bidout"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1445459261, "post_id": 33268493, "comment_id": 54338288, "body": "Obviously, going forward, some basic improvements in data-recording can be made. The question was more addressing data that has been recorded in the past. This data-reporting system has been in place since 2002, so at this point, it is very hard to query all of that data. Thanks for the quick reply though"}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1445462164, "post_id": 33268493, "comment_id": 54339844, "body": "Can you use ExecuteExcel4Macro to bring in a slightly larger range than what was requested and use Find on that to narrow down the particular cell?"}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 5446655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a82a74858fc7f09ac8d31f49caa496d?s=128&d=identicon&r=PG&f=1", "display_name": "Jess-eye-ca", "link": "https://stackoverflow.com/users/5446655/jess-eye-ca"}, "is_accepted": true, "score": 1, "last_activity_date": 1445462245, "creation_date": 1445462245, "answer_id": 33269416, "question_id": 33268493, "link": "https://stackoverflow.com/questions/33268493/use-vba-find-function-or-analogy-in-an-unopened-spreasheet/33269416#33269416", "title": "Use VBA FIND() function (or analogy) in an unopened spreasheet", "body": "<p>When I am unable to use FIND(), I use a loop to check values.\nYou can use RC notation and an x and y variable to loop through the data in the sheet. Then check for your key words. Once the key word is found, calculate an offset for the data.</p>\n\n<p>Note: It takes about 1 second to check 500 cells so I would try to keep the range you loop through small.</p>\n\n<pre><code>sub test()\nDim x As Integer, y As Integer\nDim myfile As String\nDim myvalue As Variant\n\n\nFor x = 1 To 10\nFor y = 1 To 50\n    myfile = \"'C:\\Users\\jmgri798\\Documents\\GRMRS\\Temp\\[Test Data.xlsx]Sheet1'!r\" &amp; x &amp; \"c\" &amp; y\n    myvalue = ExecuteExcel4Macro(myfile)\n    If myvalue = \"DEF\" Then\n        myfile = \"'C:\\Users\\jmgri798\\Documents\\GRMRS\\Temp\\[Test Data.xlsx]Sheet1'!r\" &amp; x &amp; \"c\" &amp; y + 1\n        myvalue = ExecuteExcel4Macro(myfile)\n        Sheet1.Range(\"b2\") = myvalue\n    End If\nNext y\nNext x\nend sub\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 5473166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d067c262e661bb37ada67c7f9fc5e525?s=128&d=identicon&r=PG&f=1", "display_name": "bidout", "link": "https://stackoverflow.com/users/5473166/bidout"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 33269416, "answer_count": 1, "score": 3, "last_activity_date": 1445462245, "creation_date": 1445458795, "last_edit_date": 1531164843, "question_id": 33268493, "link": "https://stackoverflow.com/questions/33268493/use-vba-find-function-or-analogy-in-an-unopened-spreasheet", "title": "Use VBA FIND() function (or analogy) in an unopened spreasheet", "body": "<p><strong>What I am trying to do:</strong></p>\n\n<p>Create a data query userform using VBA that will allow a user to query daily data. This would usually be a very simple project, but is only necessary because a sufficient database for this data has not been built. Currently, a separate spreadsheet is saved every day onto a shared drive. Built into the title of each spreadsheet is the date. (Ex: \"H:SharedDrive/DataSheets/2May2012.xls\"). In each spreadsheet is a variety of data recorded each day; each piece of data has a category that is constant from day-to-day (these category names are locked for editing). </p>\n\n<p><strong>My Original Approach</strong></p>\n\n<p>I created a simple userform that allows a user to enter the date range of the desired query and the <em>spreadsheet address</em> of the desired data. After several trials, I found that actually opening every spreadsheet and copy and pasting data into a new sheet was quite lengthy, especially if the user is querying over a time-span of years. I then began to use \"ExecuteExcel4Macro()\" to query the data from each spreadsheet without actually opening each individually. This worked great and perfectly accomplished what I needed.</p>\n\n<p><strong>The Problem</strong></p>\n\n<p>It turns out that those who enter the data into these spreadsheets on a day-to-day basis have not retained a uniform format for data entry over time. Often, a new row or column is added into the spreadsheet before saving the filled-out template to the shared drive. Therefore, just because the address of a particular piece of data has been \"H69\" for the past two months does not mean that the format was not changed two months ago and that same piece of data was previously housed in cell \"H72\". This presents an obvious problem for my program. </p>\n\n<p><strong>What I have Tried</strong></p>\n\n<p>I have tried to use the actual category names to query a piece of data. These category names never change over time. For example, the user records pressure and temperature in cells labeled \"pressure\" and \"temperature\" in the column to the left of the data-entry cells. The address of the recorded data is not constant over time, but the words \"pressure\" and \"temperature\" cannot be changed. The easiest way I know to retrieve the address of a piece of data within a spreadsheet is the Find() function. However, as far as I have been able to find, this function only works on a sheet in an open workbook. Which brings me back to my original problem, which is longer query times associated with opening individual spreadsheets (too long to be an effective tool). </p>\n\n<p>Is there an analogy to the Find() function that works for unopened workbooks?</p>\n"}, {"tags": ["arrays", "vba", "function", "excel"], "comments": [{"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1445458476, "post_id": 33268253, "comment_id": 54337859, "body": "It&#39;s honestly kind of a mess. If you are going to return more than one variable from the function then you are better off converting it to a Sub instead of a Function. The parameters to the function are strange. Why is the first one passed ByVal? What variable data type do you expect cA and cB are (because they are variants), while cC is defined as a Double. Let&#39;s start with those questions..."}, {"owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "edited": false, "score": 1, "creation_date": 1445458994, "post_id": 33268253, "comment_id": 54338131, "body": "a_AR is the name of the function, so if it is to be assigned a value, a_AR must equal something.  My guess is that instead of <code>Returned_Array = a_AR</code> you probably mean to say <code>a_AR = aAR</code> and maybe get rid of Returned_Array altogether."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1445459031, "post_id": 33268253, "comment_id": 54338152, "body": "You&#39;re using both <code>aAr</code> and <code>a_AR</code> - you need the latter to return the data as the result of the function."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1445459187, "post_id": 33268253, "comment_id": 54338246, "body": "Yes, yes. But OP wants to return three arrays and only two are possible with the code as is (I guess)..."}, {"owner": {"reputation": 1256, "user_id": 3128069, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/4cdd27382d73700ac43edb0becdc1a7b?s=128&d=identicon&r=PG&f=1", "display_name": "phillipsK", "link": "https://stackoverflow.com/users/3128069/phillipsk"}, "reply_to_user": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "edited": false, "score": 0, "creation_date": 1445460936, "post_id": 33268253, "comment_id": 54339182, "body": "@Demetri that worked but I need to pass Returned Array within the function argument as this parameter allows me to return three array, I can only return one without this declaration?"}], "answers": [{"comments": [{"owner": {"reputation": 1256, "user_id": 3128069, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/4cdd27382d73700ac43edb0becdc1a7b?s=128&d=identicon&r=PG&f=1", "display_name": "phillipsK", "link": "https://stackoverflow.com/users/3128069/phillipsk"}, "edited": false, "score": 0, "creation_date": 1445465523, "post_id": 33270042, "comment_id": 54341426, "body": "did you change anything other than <code>a_AR = aAR</code> ?"}, {"owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "reply_to_user": {"reputation": 1256, "user_id": 3128069, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/4cdd27382d73700ac43edb0becdc1a7b?s=128&d=identicon&r=PG&f=1", "display_name": "phillipsK", "link": "https://stackoverflow.com/users/3128069/phillipsk"}, "edited": false, "score": 1, "creation_date": 1445536385, "post_id": 33270042, "comment_id": 54374999, "body": "Yes, I eliminated the &quot;Returned_Array&quot;, and just set each of the three variables equal to the function one at a time.  I am not sure if that is what you are trying to do, but I assumed that you wanted the value of Array 1 to go to Returned_Array_NR, Array 2 to go to Returned_Array_CNR, and so on.  So for each variable, I just set it equal to the function.  If this is not quite right, I hope it gives you some ideas as to what you can try."}], "tags": [], "owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "is_accepted": true, "score": 2, "last_activity_date": 1445464902, "creation_date": 1445464902, "answer_id": 33270042, "question_id": 33268253, "link": "https://stackoverflow.com/questions/33268253/why-isnt-this-function-returning-an-array-with-data/33270042#33270042", "title": "Why isn&#39;t this function returning an array with data?", "body": "<p>Perhaps you're looking for something like this?</p>\n\n<pre><code>Public Function a_AR(ByVal cA, cB, ByVal cC As Double, cName As String, Optional cD As Double) As Variant()\n\nLr = Range(\"A65000\").End(xlUp).Row\nReDim aAR(1 To Lr, 1 To 4)\nFor r = 2 To Lr\n    cRow = cRow + 1\n    aAR(cRow, 1) = Sheets(1).Cells(r, cA) 'Fund Number\n    aAR(cRow, 2) = Sheets(1).Cells(r, cB) 'class\n    'Debug.Print aAR(cRow, 2) 'debugging\n    If cName = \"Net Assets\" Then\n        aAR(cRow, 3) = Sheets(1).Cells(r, cD) / Sheets(1).Cells(r, cC) 'TNA\n        Else\n        aAR(cRow, 3) = Sheets(1).Cells(r, cC)\n    End If\nNext r\na_AR = aAR\n\nEnd Function\nSub Refactored_Macro()\n    'CNR array\n    Returned_Array_NR = ImportCNR_w_Paramaters(\"B2\", \"Entity ID\", \"Share Class\", \"Exchange Rate\", \"Net Assets\")\n    'Nav rec array\n    Returned_Array_CNR = ImportCNR_w_Paramaters(\"B3\", \"ENTITY_ID\", \"LEDGER_ITEMS\", \"BALANCE_CHANGE\")\n    'Relationship array\n    Returned_Array_Rel = ImportCNR_w_Paramaters(\"B4\", \"Hedge Entity Id\", \"Entity ID\", \"Share Class\")\nEnd Sub \n</code></pre>\n"}], "owner": {"reputation": 1256, "user_id": 3128069, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/4cdd27382d73700ac43edb0becdc1a7b?s=128&d=identicon&r=PG&f=1", "display_name": "phillipsK", "link": "https://stackoverflow.com/users/3128069/phillipsk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 33270042, "answer_count": 1, "score": 0, "last_activity_date": 1445464902, "creation_date": 1445457941, "last_edit_date": 1445458441, "question_id": 33268253, "link": "https://stackoverflow.com/questions/33268253/why-isnt-this-function-returning-an-array-with-data", "title": "Why isn&#39;t this function returning an array with data?", "body": "<p>Why is this function not returning any data after passing through my sub procedure?  </p>\n\n<p>The three arrays needed are <code>Returned_Array_CNR</code>, <code>Returned_Array_NR</code>, <code>Returned_Array_Rel As Variant</code>.  </p>\n\n<p>Did I execute a return statement correctly with <code>Returned_Array = a_AR</code>?  </p>\n\n<p>I aim to return three separate arrays with this function and I wish to title them through the Returned_Array parameter defined in the function header.  </p>\n\n<p>I pass this variable in the function's argument - am I doing this correctly?</p>\n\n<pre><code>    Public Function a_AR(ByVal cA, cB, ByVal cC As Double, cName As String, Returned_Array As Variant, Optional cD As Double) As Variant()\n        Lr = Range(\"A65000\").End(xlUp).row\n        ReDim aAR(1 To Lr, 1 To 4)\n        ReDim Returned_Array(1 To Lr, 1 To 4)\n              For r = 2 To Lr\n             cRow = cRow + 1\n             aAR(cRow, 1) = Sheets(1).Cells(r, cA) 'Fund Number\n             aAR(cRow, 2) = Sheets(1).Cells(r, cB) 'class\n             'Debug.Print aAR(cRow, 2) 'debugging\n            If cName = \"Net Assets\" Then\n                aAR(cRow, 3) = Sheets(1).Cells(r, cD) / Sheets(1).Cells(r, cC) 'TNA\n            Else\n                aAR(cRow, 3) = Sheets(1).Cells(r, cC)\n            End If\n         Next r\n\n        Returned_Array = a_AR\n\n    End Function\n\n\n    Sub Refactored_Macro()\n\n    'CNR array\n    ImportCNR_w_Paramaters \"B2\", \"Entity ID\", \"Share Class\", \"Exchange Rate\", Returned_Array_NR, \"Net Assets\"\n    'Nav rec array\n    ImportCNR_w_Paramaters \"B3\", \"ENTITY_ID\", \"LEDGER_ITEMS\", \"BALANCE_CHANGE\", Returned_Array_CNR\n    'Relationship array\n    ImportCNR_w_Paramaters \"B4\", \"Hedge Entity Id\", \"Entity ID\", \"Share Class\", Returned_Array_Rel\n\n    End Sub\n\n    Sub ImportCNR_w_Paramaters(cell As String, cName1, cName2, cName3 As String, Returned_Array2 As Variant, Optional cName4 As String)\n\n    MyPath = Range(cell)                                'Defines cell that contains path to source that have been saved down\n    Workbooks.Open (MyPath)                             'Opens workbook that have been saved down\n    Set tempbook = ActiveWorkbook                       'Names  workbook for future closing\n    'LR = Range(\"A65000\").End(xlUp).row                  'finds last row in edits\n\n\n\n    'ReDim aAR(1 To LR, 1 To 4)\n    cRow = 0\n     cName = cName1\n     cA = Cells.Find(What:=UCase(cName), After:=ActiveCell, LookIn:=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext).Column\n     cName = cName2\n     cB = Cells.Find(What:=UCase(cName), After:=ActiveCell, LookIn:=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext).Column\n     cName = cName3\n     cC = Cells.Find(What:=UCase(cName), After:=ActiveCell, LookIn:=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext).Column\n     cName = cName4\n     cD = Cells.Find(What:=UCase(cName), After:=ActiveCell, LookIn:=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext).Column\n\n    '      For r = 2 To LR\n    '         cRow = cRow + 1\n    '         'a_AR(cRow,r,cA,cB,cC,cD,cName)\n\n                a_Array = a_AR(cA, cB, cC, cName, Returned_Array2, cD)\n\n    '\n    '        aAR(cRow, 1) = Sheets(1).Cells(r, cA) 'Fund Number\n    '        aAR(cRow, 2) = Sheets(1).Cells(r, cB) 'class\n    '        aAR(cRow, 3) = Sheets(1).Cells(r, cD) / Sheets(1).Cells(r, cC) 'TNA\n    '\n    '     Next r\n\n\n    tempbook.Close\n\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "performance", "vba"], "comments": [{"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1445457587, "post_id": 33268121, "comment_id": 54337387, "body": "Can you live with formatting the entire columns to the same font size? I&#39;ve found that this is often faster... even in Excel 2007"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1445459632, "post_id": 33268121, "comment_id": 54338501, "body": "In Office 2007, if you select that range and change the font via the Menu (or Font preferences), does it also take that long? Or just when you try it with VBA?"}, {"owner": {"reputation": 590, "user_id": 2250595, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/74f417b7aa939eaad4b1afb301487ad4?s=128&d=identicon&r=PG", "display_name": "mauek unak", "link": "https://stackoverflow.com/users/2250595/mauek-unak"}, "reply_to_user": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1445460040, "post_id": 33268121, "comment_id": 54338709, "body": "@Excel Hero - it takes about same time (20,437s / 21s)"}, {"owner": {"reputation": 590, "user_id": 2250595, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/74f417b7aa939eaad4b1afb301487ad4?s=128&d=identicon&r=PG", "display_name": "mauek unak", "link": "https://stackoverflow.com/users/2250595/mauek-unak"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1445460044, "post_id": 33268121, "comment_id": 54338712, "body": "@BruceWayne - it takes even more time when changing font size via Excel menu, because in macro I disable screenupdating, etc ..."}, {"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1445460147, "post_id": 33268121, "comment_id": 54338780, "body": "do you really need to set the size for all 20,000 rows or is it &quot;a range so large I don&#39;t have to worry about it&quot;?  If it&#39;s the latter, you may be better off   just formatting the rows you have data rather than n number of rows w/ no data."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1445460236, "post_id": 33268121, "comment_id": 54338817, "body": "Also, try formatting the entire worksheet and see how long that takes."}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1445460243, "post_id": 33268713, "comment_id": 54338819, "body": "Why turn <code>CutCopyMode</code> back on after turning it to false?  If you left it <code>False</code>, would it cause issues with using copy later on?"}, {"owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1445460643, "post_id": 33268713, "comment_id": 54339022, "body": "@BruceWayne  correct., Application.CutCopyMode = True is not required for this program."}, {"owner": {"reputation": 590, "user_id": 2250595, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/74f417b7aa939eaad4b1afb301487ad4?s=128&d=identicon&r=PG", "display_name": "mauek unak", "link": "https://stackoverflow.com/users/2250595/mauek-unak"}, "edited": false, "score": 0, "creation_date": 1445460703, "post_id": 33268713, "comment_id": 54339052, "body": "Well, your solutions is quickiest. <code>Range(&quot;A1:Z20000&quot;).Font.Size = 9</code> takes 20,437 seconds, <code>For i = 1 To 26: Columns(i).Font.Size = 10: Next i</code> takes 21 seconds, your approach takes 0,359 seconds, I don&#39;t really understand why (as it is working with formatting in general, not just font size), but it works the best :) at least for Office 2007"}, {"owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "reply_to_user": {"reputation": 590, "user_id": 2250595, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/74f417b7aa939eaad4b1afb301487ad4?s=128&d=identicon&r=PG", "display_name": "mauek unak", "link": "https://stackoverflow.com/users/2250595/mauek-unak"}, "edited": false, "score": 0, "creation_date": 1445460830, "post_id": 33268713, "comment_id": 54339121, "body": "@user2250595 Welcome. The approach is similar to format painter button."}], "tags": [], "owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "is_accepted": true, "score": 1, "last_activity_date": 1445459660, "creation_date": 1445459660, "answer_id": 33268713, "question_id": 33268121, "link": "https://stackoverflow.com/questions/33268121/font-formatting-performance-in-excel-2007/33268713#33268713", "title": "Font formatting performance in Excel 2007", "body": "<p>Try this method for your requirement</p>\n\n<pre><code>Sub testformat()\n\nRange(\"A1\").Font.Size = 9\n\nRange(\"A1\").Copy\n\nRange(\"A1:Z20000\").PasteSpecial xlPasteFormats\n\nApplication.CutCopyMode = False\nApplication.CutCopyMode = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 590, "user_id": 2250595, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/74f417b7aa939eaad4b1afb301487ad4?s=128&d=identicon&r=PG", "display_name": "mauek unak", "link": "https://stackoverflow.com/users/2250595/mauek-unak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 33268713, "answer_count": 1, "score": 1, "last_activity_date": 1445459782, "creation_date": 1445457428, "last_edit_date": 1445459782, "question_id": 33268121, "link": "https://stackoverflow.com/questions/33268121/font-formatting-performance-in-excel-2007", "title": "Font formatting performance in Excel 2007", "body": "<p>I have macro which sets font for whole range to size 9:</p>\n\n<pre><code>Range(\"A1:Z20000\").Font.Size = 9\n</code></pre>\n\n<p>When I run it on Excel 2010 or 2013 it takes approximately 1 second to process (there's almost no formatting on range). But when I run it on Excel 2007 it takes 15+ seconds to process this single line of code. I couldn't find any article regarding this, but obviously MS fixed it in newer versions of Office (Excel).  </p>\n\n<p>Is there a way to set font size for a big range (500,000+ cells) in Office 2007 without killing performance?</p>\n"}, {"tags": ["vba", "excel", "if-statement", "reference"], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 4649520, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10153280580379574/picture?type=large", "display_name": "Mike Jack", "link": "https://stackoverflow.com/users/4649520/mike-jack"}, "edited": false, "score": 0, "creation_date": 1445457311, "post_id": 33267956, "comment_id": 54337257, "body": "So it will go before my Prescrub code, where I call each individual code?  I ask because then I would have to manually choose to run the Sub Prescrub() correct?"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 49, "user_id": 4649520, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10153280580379574/picture?type=large", "display_name": "Mike Jack", "link": "https://stackoverflow.com/users/4649520/mike-jack"}, "edited": false, "score": 0, "creation_date": 1445457684, "post_id": 33267956, "comment_id": 54337435, "body": "It will go before anything else, but it should not change how you run Prescrub() or anything else."}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": true, "score": 1, "last_activity_date": 1445456809, "creation_date": 1445456809, "answer_id": 33267956, "question_id": 33267816, "link": "https://stackoverflow.com/questions/33267816/reference-a-statement-from-one-subroutine-in-another/33267956#33267956", "title": "Reference a statement from one subroutine in another", "body": "<p>At the top of the code module, before the first procedure, enter this line:</p>\n\n<pre><code>Private Augbox As Long\n</code></pre>\n\n<p>Now make sure that you do NOT define <code>Augbox</code> again with any Dim statement in the procedures.</p>\n\n<p>That's it.</p>\n\n<p>The value of <code>Augbox</code> will now be shared between all procedures of the module.</p>\n"}], "owner": {"reputation": 49, "user_id": 4649520, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10153280580379574/picture?type=large", "display_name": "Mike Jack", "link": "https://stackoverflow.com/users/4649520/mike-jack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 33267956, "answer_count": 1, "score": 1, "last_activity_date": 1445463423, "creation_date": 1445456382, "last_edit_date": 1445463423, "question_id": 33267816, "link": "https://stackoverflow.com/questions/33267816/reference-a-statement-from-one-subroutine-in-another", "title": "Reference a statement from one subroutine in another", "body": "<p>I have code that I broke into multiple pieces that run in order.  I start with a Message Box that asks <strong>\"Are you entering data for August\"</strong>. If the answer is 'yes' it runs a series of codes, but now that my code is too long I'm unable to continue that series of code for the month of August.  I'm trying to make the change in code seamless.  When the new code begins I could have it ask again \"what month are you entering data for\" but if possible I'd like not to.  Ideally I want the first line of my new code to be \"If you answered Yes to the initial question in code one then proceed\".</p>\n\n<p>Here's where I call all the code:</p>\n\n<pre><code>Sub PreScrub()\nCall Tabs\nCall AUGSUMMCEND\nCall AugNUR\nEnd Sub\n</code></pre>\n\n<p>The first code is just formatting, so I'll skip that.  Here's the beginning of my second code where I prompt for the month:</p>\n\n<pre><code>Augbox = MsgBox(\"Are you entering Prescrub for August?\", vbYesNo + vbQuestion)\nIf Augbox = vbYes Then\n\nFor i = 1 To recvarSumm.Rows.Count\n    For j = 1 To recvarSumm.Rows.Count\nIf recvarSumm.Cells(i, j).Value = \"Aetna\" Then\n    recvarSummvalues.Cells(i, j).Range(\"A1:C1\").Copy\n    wsYTDSUMM.Columns(1).Find(\"Aetna\").Offset(9, 1).PasteSpecial\nEnd If\n    Next j\nNext i\n</code></pre>\n\n<p>The code carries on from there for a long time.  Then I want the beginning of my <code>AugNur</code> code to say \"If Augbox from AUGSUMMCEND is 'yes' then continue\".  </p>\n\n<p>Is that possible?</p>\n"}, {"tags": ["excel", "vba", "split", "multiple-columns"], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1445456943, "creation_date": 1445456943, "answer_id": 33267995, "question_id": 33267500, "link": "https://stackoverflow.com/questions/33267500/split-text-in-cells-at-line-breaks-into-rows-for-multiple-columns/33267995#33267995", "title": "Split text in cells at line breaks into rows, for multiple columns", "body": "<p>Just building on what was done in your linked answer:</p>\n\n<pre><code>Sub JustDoIt2()\n    'working for active sheet\n    'copy to the end of sheets collection\n    ActiveSheet.Copy after:=Sheets(Sheets.Count)\n    Dim tmpArr As Variant\n    Dim Cell As Range\n    For Each Cell In Range(\"A2\", Range(\"A2\").End(xltoright).End(xlDown)) \n        If InStr(1, Cell, Chr(10)) &lt;&gt; 0 Then\n            tmpArr = Split(Cell, Chr(10))\n            If Cell.Offset(1) &lt;&gt; Cell Then\n                Cell.EntireRow.Copy\n                Cell.Offset(1, 0).Resize(UBound(tmpArr), 1). _\n                    EntireRow.Insert xlShiftDown\n            End If\n            Cell.Resize(UBound(tmpArr) + 1, 1) = Application.Transpose(tmpArr)\n        End If\n    Next\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 5472914, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/10205303802534072/picture?type=large", "display_name": "Xinxin Li", "link": "https://stackoverflow.com/users/5472914/xinxin-li"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1188, "favorite_count": 1, "accepted_answer_id": 33267995, "answer_count": 1, "score": 1, "last_activity_date": 1445456943, "creation_date": 1445455172, "last_edit_date": 1495542677, "question_id": 33267500, "link": "https://stackoverflow.com/questions/33267500/split-text-in-cells-at-line-breaks-into-rows-for-multiple-columns", "title": "Split text in cells at line breaks into rows, for multiple columns", "body": "<p>My question is an extension to this, <a href=\"https://stackoverflow.com/questions/19851951/microsoft-excel-split-text-in-cells-at-line-breaks\">Split text in cells at line breaks</a>, where, I need to split text in cells with line break into separate rows, NOT only for just one column, but for multiple columns.</p>\n\n<p>A <a href=\"https://i.stack.imgur.com/ozQuS.gif\" rel=\"nofollow noreferrer\">screenshot of my data</a>:\n<a href=\"https://i.stack.imgur.com/ozQuS.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ozQuS.gif\" alt=\"screenshot of my data\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 421, "user_id": 5024658, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-md8UhJRxd_g/AAAAAAAAAAI/AAAAAAAAhyg/igUflaP6DH4/photo.jpg?sz=128", "display_name": "Liss", "link": "https://stackoverflow.com/users/5024658/liss"}, "edited": false, "score": 1, "creation_date": 1445454595, "post_id": 33267206, "comment_id": 54335814, "body": "It&#39;s because of your line break.  Why not just wrap the text instead? <code>Sheets(&quot;sheet_name&quot;).Cells(1, 1).WrapText = True</code>"}, {"owner": {"reputation": 3148, "user_id": 1016567, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aI7P1.png?s=128&g=1", "display_name": "laylarenee", "link": "https://stackoverflow.com/users/1016567/laylarenee"}, "edited": false, "score": 0, "creation_date": 1445455323, "post_id": 33267206, "comment_id": 54336214, "body": "When you &quot;save as text&quot;, the quotes are inserted to indicate the <code>Cell Value</code> wraps onto multiple lines. What do you prefer to happen?"}, {"owner": {"reputation": 3148, "user_id": 1016567, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aI7P1.png?s=128&g=1", "display_name": "laylarenee", "link": "https://stackoverflow.com/users/1016567/laylarenee"}, "edited": false, "score": 0, "creation_date": 1445455384, "post_id": 33267206, "comment_id": 54336243, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/11501531/saving-a-excel-file-into-txt-format-without-quotes\">Saving a Excel File into .txt format without quotes</a>"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 3148, "user_id": 1016567, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aI7P1.png?s=128&g=1", "display_name": "laylarenee", "link": "https://stackoverflow.com/users/1016567/laylarenee"}, "edited": false, "score": 0, "creation_date": 1445455754, "post_id": 33267206, "comment_id": 54336443, "body": "@laylarenee I don&#39;t think it is a duplicate of that.  That is saving the file.  This is adding a value with a new line, then even if you just copy the cell contents and paste it to a text file it adds the double quotes."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1445456972, "post_id": 33267206, "comment_id": 54337088, "body": "That has nothing to do with your code though. Your code is fine. If you wrote in a cell, manually: <code>Hello &lt;Alt+Enter&gt; Dear</code> and copy and pasted that into a text file you would get quotes."}, {"owner": {"reputation": 3148, "user_id": 1016567, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aI7P1.png?s=128&g=1", "display_name": "laylarenee", "link": "https://stackoverflow.com/users/1016567/laylarenee"}, "edited": false, "score": 0, "creation_date": 1445457759, "post_id": 33267206, "comment_id": 54337476, "body": "The quotation marks are being added when you &quot;save as text file&quot;. I think that article is relevant."}], "owner": {"reputation": 19, "user_id": 5472956, "user_type": "registered", "profile_image": "https://graph.facebook.com/1083475305004215/picture?type=large", "display_name": "Shadab Khan", "link": "https://stackoverflow.com/users/5472956/shadab-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 163, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1445454138, "creation_date": 1445454138, "last_edit_date": 1531164843, "question_id": 33267206, "link": "https://stackoverflow.com/questions/33267206/double-quotes-issue-in-vba-vbnewline", "title": "Double Quotes issue in VBA vbNewLine", "body": "<p>Code :</p>\n\n<pre><code>var1 = \"Hello\"\nvar2 = \"Dear\"\nvar3 = var1 &amp; vbNewLine &amp; var2\n\nSheets(\"sheet_name\").Cells(1, 1).Value = var3\n</code></pre>\n\n<p>If we take cell value in text file it looks like..</p>\n\n<p>\"Hello\nDear\"</p>\n\n<p>I do not want double quotes surrounding the text.Could anyone suggest me for this issue.</p>\n"}, {"tags": ["vba", "excel", "ambiguity"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1445453873, "post_id": 33266984, "comment_id": 54335438, "body": "<i>All procedures in a code module must have a unique name.</i>  Give them different names? Otherwise, it&#39;s hard to say how to &quot;fix&quot; them unless you can say what you mean by &quot;they don&#39;t work&quot;.  You have two procedures taht look very similar, while you could <i>combine</i> them, it&#39;s not clear that is your actual intent."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1445454309, "post_id": 33266984, "comment_id": 54335686, "body": "@DavidZemens In this case I disagree. It is very clear. They are both THE SAME event procedure of a worksheet."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1445454737, "post_id": 33266984, "comment_id": 54335894, "body": "It is not immediately/explicitly clear whether they <i>ought</i> to be combined, because the &quot;second&quot; procedure completely redefines the <code>HotArea</code> range, and implicitly because &quot;but putting them together only the top piece works.&quot; which would seem to imply that something about the second piece &quot;doesn&#39;t work&quot; (whatever that means) when they are &quot;combined&quot;. @ExcelHero"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1445454966, "post_id": 33266984, "comment_id": 54336006, "body": "I&#39;m not going to debug them. The question is why the error is happening. I&#39;ve answered that and given a hint as to how to get both procedures to run in response to the event. OP needs to take it from there..."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 5411256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88b620da97bd10d5dbb01c8f69eef9d8?s=128&d=identicon&r=PG&f=1", "display_name": "C. Cons", "link": "https://stackoverflow.com/users/5411256/c-cons"}, "edited": false, "score": 0, "creation_date": 1446055147, "post_id": 33267069, "comment_id": 54587976, "body": "Thank you. That resolved my issue. I appreciate it. @ExcelHero"}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": true, "score": 2, "last_activity_date": 1445453675, "creation_date": 1445453675, "answer_id": 33267069, "question_id": 33266984, "link": "https://stackoverflow.com/questions/33266984/ambiguous-name-detected/33267069#33267069", "title": "&quot;Ambiguous Name Detected&quot;", "body": "<p>All procedures in a code module must have a unique name.</p>\n\n<p>Here, I have taken the code from inside the 2nd instance of the procedure and appended it to the bottom of the first:</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n    Dim HotArea As Range\n\n    Set HotArea = Range(\"C17,C21,C25,C29,C33,C42,C46,C50,C54,C58,C67,C71,C75,C83,C87,C91,C100,M17\")\n    Set HotArea = Union(HotArea, Range(\"M21,M25,M29,M33,M42,M46,M55,M59,M69,M73,M82,M86,W17,W21,W25,W29,AG17,AG21,AG25,AG34\"))\n    Set HotArea = Union(HotArea, Range(\"AG38,AG42,AG51,AG55,AG59,AG68,AG72,AG81,AG85,AG89,AG98,AG102,AG106,AG110,AG114,AQ17\"))\n    Set HotArea = Union(HotArea, Range(\"AQ21,AQ30,AQ34,AQ43,AQ47,AQ51,AQ60,AQ64,BA17,BA21,BA25,BA29,BA33,BA37,BA46,BA50,BA54\"))\n    Set HotArea = Union(HotArea, Range(\"BA58,BA62,BA71,BA75,BA79,BA89,BA93\"))\n\n    If Not Intersect(Target, HotArea) Is Nothing Then\n    Select Case Target.Item(1)\n    Case \"\"\n        Target = \"P1\"\n        Target.Interior.ColorIndex = 3\n    Case \"P1\"\n        Target = \"P2\"\n        Target.Interior.ColorIndex = 6\n    Case \"P2\"\n        Target = \"P3\"\n        Target.Interior.ColorIndex = 50\n    Case \"P3\"\n        Target = \"P4\"\n        Target.Interior.ColorIndex = 23\n    Case Else\n        Target = \"\"\n        Target.Interior.ColorIndex = xlNone\n    End Select\n    Cancel = True\n    End If\n\n\n\n    Set HotArea = Range(\"C19,C23,C27,C31,C35,C44,C48,C52,C56,C60,C69,C73,C77,C85,C89,C93,C102,M19\")\n    Set HotArea = Union(HotArea, Range(\"M23,M27,M31,M35,M44,M48,M57,M61,M71,M75,M84,M88,W19,W23,W27,W31,AG19,AG23,AG27,AG36\"))\n    Set HotArea = Union(HotArea, Range(\"AG40,AG44,AG53,AG57,AG61,AG70,AG74,AG83,AG87,AG91,AG100,AG104,AG108,AG112,AG116,AQ19\"))\n    Set HotArea = Union(HotArea, Range(\"AQ23,AQ32,AQ36,AQ45,AQ49,AQ53,AQ62,AQ66,BA19,BA23,BA27,BA31,BA35,BA39,BA48,BA52,BA56\"))\n    Set HotArea = Union(HotArea, Range(\"BA60,BA64,BA73,BA77,BA81,BA91,BA95\"))\n\n    If Not Intersect(Target, HotArea) Is Nothing Then\n\n        'If the target cell is clear\n        If Target.Interior.ColorIndex = xlNone Then\n        'Then change the background to the specified color\n        Target.Interior.ColorIndex = 4\n\n    'But if the target cell is already the specified color\n        ElseIf Target.Interior.ColorIndex = 4 Then\n\n        'Then change the background to the specified color\n        Target.Interior.ColorIndex = 6\n\n       'But if the target cell is already the specified color\n        ElseIf Target.Interior.ColorIndex = 6 Then\n\n        'Then change the background to the specified color\n        Target.Interior.ColorIndex = 3\n\n        'But if the target cell is already the specified color\n        ElseIf Target.Interior.ColorIndex = 3 Then\n\n        'Then change the background to the specified color\n        Target.Interior.ColorIndex = 5\n\n        'But if the target cell is already the specified color\n        ElseIf Target.Interior.ColorIndex = 5 Then\n\n        'Then change the background to the specified color\n        Target.Interior.ColorIndex = x1None\n    End If\n    Cancel = True\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 5411256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88b620da97bd10d5dbb01c8f69eef9d8?s=128&d=identicon&r=PG&f=1", "display_name": "C. Cons", "link": "https://stackoverflow.com/users/5411256/c-cons"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1065, "favorite_count": 0, "accepted_answer_id": 33267069, "answer_count": 1, "score": 0, "last_activity_date": 1445453719, "creation_date": 1445453418, "last_edit_date": 1445453719, "question_id": 33266984, "link": "https://stackoverflow.com/questions/33266984/ambiguous-name-detected", "title": "&quot;Ambiguous Name Detected&quot;", "body": "<p>I am currently having issues with having the second sub section work. I had an error:  </p>\n\n<blockquote>\n  <p>Ambigious name detected:Worksheet_BeforeDoubleClick  </p>\n</blockquote>\n\n<p>I tried changing the second name but the code still didn't work. Both Subs work individually but putting them together only the top piece works.</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\nDim HotArea As Range\n\nSet HotArea = Range(\"C17,C21,C25,C29,C33,C42,C46,C50,C54,C58,C67,C71,C75,C83,C87,C91,C100,M17\")\nSet HotArea = Union(HotArea, Range(\"M21,M25,M29,M33,M42,M46,M55,M59,M69,M73,M82,M86,W17,W21,W25,W29,AG17,AG21,AG25,AG34\"))\nSet HotArea = Union(HotArea, Range(\"AG38,AG42,AG51,AG55,AG59,AG68,AG72,AG81,AG85,AG89,AG98,AG102,AG106,AG110,AG114,AQ17\"))\nSet HotArea = Union(HotArea, Range(\"AQ21,AQ30,AQ34,AQ43,AQ47,AQ51,AQ60,AQ64,BA17,BA21,BA25,BA29,BA33,BA37,BA46,BA50,BA54\"))\nSet HotArea = Union(HotArea, Range(\"BA58,BA62,BA71,BA75,BA79,BA89,BA93\"))\n\nIf Not Intersect(Target, HotArea) Is Nothing Then\nSelect Case Target.Item(1)\nCase \"\"\n    Target = \"P1\"\n    Target.Interior.ColorIndex = 3\nCase \"P1\"\n    Target = \"P2\"\n    Target.Interior.ColorIndex = 6\nCase \"P2\"\n    Target = \"P3\"\n    Target.Interior.ColorIndex = 50\nCase \"P3\"\n    Target = \"P4\"\n    Target.Interior.ColorIndex = 23\nCase Else\n    Target = \"\"\n    Target.Interior.ColorIndex = xlNone\nEnd Select\nCancel = True\nEnd If\nEnd Sub\n\nPrivate Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\nDim HotArea As Range\n\nSet HotArea = Range(\"C19,C23,C27,C31,C35,C44,C48,C52,C56,C60,C69,C73,C77,C85,C89,C93,C102,M19\")\nSet HotArea = Union(HotArea, Range(\"M23,M27,M31,M35,M44,M48,M57,M61,M71,M75,M84,M88,W19,W23,W27,W31,AG19,AG23,AG27,AG36\"))\nSet HotArea = Union(HotArea, Range(\"AG40,AG44,AG53,AG57,AG61,AG70,AG74,AG83,AG87,AG91,AG100,AG104,AG108,AG112,AG116,AQ19\"))\nSet HotArea = Union(HotArea, Range(\"AQ23,AQ32,AQ36,AQ45,AQ49,AQ53,AQ62,AQ66,BA19,BA23,BA27,BA31,BA35,BA39,BA48,BA52,BA56\"))\nSet HotArea = Union(HotArea, Range(\"BA60,BA64,BA73,BA77,BA81,BA91,BA95\"))\n\nIf Not Intersect(Target, HotArea) Is Nothing Then\n\n    'If the target cell is clear\n    If Target.Interior.ColorIndex = xlNone Then\n    'Then change the background to the specified color\n    Target.Interior.ColorIndex = 4\n\n'But if the target cell is already the specified color\n    ElseIf Target.Interior.ColorIndex = 4 Then\n\n    'Then change the background to the specified color\n    Target.Interior.ColorIndex = 6\n\n   'But if the target cell is already the specified color\n    ElseIf Target.Interior.ColorIndex = 6 Then\n\n    'Then change the background to the specified color\n    Target.Interior.ColorIndex = 3\n\n    'But if the target cell is already the specified color\n    ElseIf Target.Interior.ColorIndex = 3 Then\n\n    'Then change the background to the specified color\n    Target.Interior.ColorIndex = 5\n\n    'But if the target cell is already the specified color\n    ElseIf Target.Interior.ColorIndex = 5 Then\n\n    'Then change the background to the specified color\n    Target.Interior.ColorIndex = x1None\nEnd If\nCancel = True\nEnd If\nEnd Sub  \n</code></pre>\n\n<p>How do I change the name so that both will work?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2076, "user_id": 2860193, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0793dc8385ef6af35cebe31c1ecc10ba?s=128&d=identicon&r=PG&f=1", "display_name": "deathismyfriend", "link": "https://stackoverflow.com/users/2860193/deathismyfriend"}, "edited": false, "score": 1, "creation_date": 1445453521, "post_id": 33266961, "comment_id": 54335203, "body": "This is not a please code this for me site. This site is for fixing broken code. Please provide code that you have tried."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1445453522, "post_id": 33266961, "comment_id": 54335205, "body": "I feel like this question gets asked once a week XD"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1445455127, "post_id": 33266961, "comment_id": 54336106, "body": "The following website might be able to get you started if you want to code it yourself: <a href=\"http://www.homeandlearn.org/\" rel=\"nofollow noreferrer\">homeandlearn.org</a>. Otherwise, you can hire someone to code it for you here: <a href=\"http://careers.stackoverflow.com/employer\">careers.stackoverflow.com/employer</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "is_accepted": true, "score": 0, "last_activity_date": 1445456319, "creation_date": 1445456319, "answer_id": 33267798, "question_id": 33266961, "link": "https://stackoverflow.com/questions/33266961/vba-copy-the-range-in-some-cells-and-appear-them-into-other-sheet/33267798#33267798", "title": "VBA - copy the range in some cells and appear them into other sheet", "body": "<p>I am just posting my code. Hope @Jonathan will learn it. </p>\n\n<pre><code>Sub CopyC()\n\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim sheet1lastrow As Long\n    Dim lastrow As Long\n\n    Set wb = ThisWorkbook\n    Set ws = wb.Worksheets(\"sheet1\")\n\n    lastrow = ActiveSheet.Range(\"E\" &amp; Rows.Count).End(xlUp).Row\n    sheet1lastrow = ws.Range(\"E\" &amp; Rows.Count).End(xlUp).Row\n\n\n\n    For i = 1 To lastrow\n        If Right(ActiveSheet.Cells(i, 5).Value, 5) = \"(UK)\" Then\n            ActiveSheet.Range(Cells(i, 2), Cells(i, 5)).Copy\n            ws.Cells(sheet1lastrow + 1, 2).PasteSpecial xlValues\n            Application.CutCopyMode = False\n            Application.CutCopyMode = True\n        End If\n    Next\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 5457151, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2c62a9d3b0881d5f60adf5cb2f6e795?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5457151/jonathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 0, "accepted_answer_id": 33267798, "answer_count": 1, "score": 0, "last_activity_date": 1445456319, "creation_date": 1445453336, "last_edit_date": 1531164843, "question_id": 33266961, "link": "https://stackoverflow.com/questions/33266961/vba-copy-the-range-in-some-cells-and-appear-them-into-other-sheet", "title": "VBA - copy the range in some cells and appear them into other sheet", "body": "<p>I want a code that doing the following:\nif the last 5 characters of the text value in the cell  in column E is \u201c(UK)\u201d then the macro copies the range consisting of 4 cells in columns B,C,D,E in the same row and pastes below the last non-empty row in the worksheet \u201cSheet 1\u201d in the same columns (so all ranges B-E with \u201c(UK)\u201d must be transferred to the sheet \u201cSheet1\u201d);</p>\n"}, {"tags": ["excel", "sendkeys", "vba"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1445454462, "post_id": 33266859, "comment_id": 54335754, "body": "The code works for me,...."}, {"owner": {"reputation": 11, "user_id": 5153721, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0P6GSCJYrQQ/AAAAAAAAAAI/AAAAAAAAIAE/A19PjyLE2-A/photo.jpg?sz=128", "display_name": "Nitin Srivastava", "link": "https://stackoverflow.com/users/5153721/nitin-srivastava"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1445455052, "post_id": 33266859, "comment_id": 54336062, "body": "Any settings that I can modify in my excel application to make it work. Which excel version are you using?"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1445456006, "post_id": 33266859, "comment_id": 54336579, "body": "xl&#39;10... I just copied your code,pasted into a module and clicked run."}, {"owner": {"reputation": 11, "user_id": 5153721, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0P6GSCJYrQQ/AAAAAAAAAAI/AAAAAAAAIAE/A19PjyLE2-A/photo.jpg?sz=128", "display_name": "Nitin Srivastava", "link": "https://stackoverflow.com/users/5153721/nitin-srivastava"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1445456701, "post_id": 33266859, "comment_id": 54336946, "body": "It doesn&#39;t on xl2007.. :("}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1445457648, "post_id": 33266859, "comment_id": 54337412, "body": "How is it not working? Any errors?"}, {"owner": {"reputation": 11, "user_id": 5153721, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0P6GSCJYrQQ/AAAAAAAAAAI/AAAAAAAAIAE/A19PjyLE2-A/photo.jpg?sz=128", "display_name": "Nitin Srivastava", "link": "https://stackoverflow.com/users/5153721/nitin-srivastava"}, "edited": false, "score": 0, "creation_date": 1445457990, "post_id": 33266859, "comment_id": 54337598, "body": "It doesn&#39;t picks any data on clipboard and destination cell ( cell G7 ) has &quot;marching ants &quot; animation, as if I&#39;m trying to copy from E7 rather G7."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1445460566, "post_id": 33266859, "comment_id": 54338969, "body": "Are you not trying to copy from E7? You would still get the &quot;marching ants &quot; because CutCopyMode hasn&#39;t been set to false. What do you have in E7?"}, {"owner": {"reputation": 11, "user_id": 5153721, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0P6GSCJYrQQ/AAAAAAAAAAI/AAAAAAAAIAE/A19PjyLE2-A/photo.jpg?sz=128", "display_name": "Nitin Srivastava", "link": "https://stackoverflow.com/users/5153721/nitin-srivastava"}, "edited": false, "score": 0, "creation_date": 1445461386, "post_id": 33266859, "comment_id": 54339440, "body": "i edit my comment- It doesn&#39;t picks any data on clipboard and destination cell ( cell G7 ) has &quot;marching ants &quot; animation, as if I&#39;m trying to copy from G7 rather E7"}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1445462335, "creation_date": 1445462335, "answer_id": 33269447, "question_id": 33266859, "link": "https://stackoverflow.com/questions/33266859/vba-copypastecode-with-sendkeys/33269447#33269447", "title": "VBA - CopyPasteCode with Sendkeys", "body": "<p>Using sendKeys is fecal at best.  I assume you are starting the code from the code window,  and because of this, the commands are trying to refer to that window.  Excel needs to be activated to receive the commands.</p>\n\n<pre><code>Sub cpypaste()\nAppActivate Application.Caption 'Activates the window.\nRange(\"E7\").Select\n\nSendKeys String:=\"^c\", Wait:=True\n\nApplication.Wait (Now + TimeValue(\"00:00:01\"))' this line I belive is not needed, with the wait as true.\nRange(\"G7\").Select\nSendKeys String:=\"^v\", Wait:=True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5153721, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0P6GSCJYrQQ/AAAAAAAAAAI/AAAAAAAAIAE/A19PjyLE2-A/photo.jpg?sz=128", "display_name": "Nitin Srivastava", "link": "https://stackoverflow.com/users/5153721/nitin-srivastava"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1321, "favorite_count": 0, "accepted_answer_id": 33269447, "answer_count": 1, "score": 0, "last_activity_date": 1445462335, "creation_date": 1445452906, "last_edit_date": 1531164843, "question_id": 33266859, "link": "https://stackoverflow.com/questions/33266859/vba-copypastecode-with-sendkeys", "title": "VBA - CopyPasteCode with Sendkeys", "body": "<p>I'm using IDE in a excel workbook and trying to do the below code.</p>\n\n<pre><code>Sub cpypaste()    \n    Range(\"E7\").Select    \n    SendKeys (\"^c\"), True    \n    Application.Wait (Now + TimeValue(\"00:00:01\"))    \n    Range(\"G7\").Select        \n    SendKeys (\"^v\"), True    \nEnd Sub\n</code></pre>\n\n<p>Not that I do not know alternate ways of doing it, but just curious why this is not working. I've tried running this code with keyboard shortcut and cmdbutton as well.\nAny help will be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 1, "creation_date": 1445451828, "post_id": 33266533, "comment_id": 54334259, "body": "The workbook needs to be open for macros to run."}, {"owner": {"reputation": 30756, "user_id": 5389997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d227900a17ca5c34bad6d2b27122c7f?s=128&d=identicon&r=PG&f=1", "display_name": "Shadow", "link": "https://stackoverflow.com/users/5389997/shadow"}, "edited": false, "score": 1, "creation_date": 1445452184, "post_id": 33266533, "comment_id": 54334426, "body": "Needs to be open, but need not be active, though."}, {"owner": {"reputation": 292, "user_id": 5108803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccc75474d048b57670d91c52180d78f0?s=128&d=identicon&r=PG&f=1", "display_name": "User15", "link": "https://stackoverflow.com/users/5108803/user15"}, "edited": false, "score": 1, "creation_date": 1445452265, "post_id": 33266533, "comment_id": 54334474, "body": "You could schedule a Task (in windows) to open the workbook."}], "answers": [{"tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": false, "score": 0, "last_activity_date": 1445460764, "creation_date": 1445460764, "answer_id": 33269015, "question_id": 33266533, "link": "https://stackoverflow.com/questions/33266533/is-there-any-way-to-run-macros-in-background/33269015#33269015", "title": "Is there any way to run macros in background?", "body": "<p>You could disable screen updating and minimize the excel file to allow a macro to \"run in the background\" but the excel file must be open.</p>\n"}], "owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1061, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1445460764, "creation_date": 1445451755, "last_edit_date": 1445452780, "question_id": 33266533, "link": "https://stackoverflow.com/questions/33266533/is-there-any-way-to-run-macros-in-background", "title": "Is there any way to run macros in background?", "body": "<p>Is there a way by which VBA can be running in the background i.e. even when the workbook is not active but the machine is on?</p>\n"}, {"tags": ["excel", "sas", "http-post", "vba"], "comments": [{"owner": {"reputation": 5208, "user_id": 3369544, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/960368e0a7e4b3ab0662e57b405058f3?s=128&d=identicon&r=PG&f=1", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3369544/quentin"}, "edited": false, "score": 1, "creation_date": 1445541589, "post_id": 33266532, "comment_id": 54377831, "body": "I&#39;m lost.  You want to programmatically upload a file from your PC to the stored process server.  Why do you want to do this via HTTP?  Couldn&#39;t you just SFTP or similar?  If you&#39;re making a web app for user to upload files and process them, then yes with HTTP the user would need to click through the process.  Unless you want to get into scripting your browser with something like <a href=\"http://imacros.net/overview\" rel=\"nofollow noreferrer\">imacros.net/overview</a>."}, {"owner": {"reputation": 11421, "user_id": 66696, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8432e47991364671c37d83af91231e55?s=128&d=identicon&r=PG", "display_name": "Allan Bowe", "link": "https://stackoverflow.com/users/66696/allan-bowe"}, "reply_to_user": {"reputation": 5208, "user_id": 3369544, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/960368e0a7e4b3ab0662e57b405058f3?s=128&d=identicon&r=PG&f=1", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3369544/quentin"}, "edited": false, "score": 0, "creation_date": 1445596973, "post_id": 33266532, "comment_id": 54399647, "body": "I&#39;ve built a data editor in excel, and need to send the records back to the SAS server.  I was indeed looking to script the browser, but without any local installs.  I think your are right, my only real option is to use SFTP (would need to set this up).  Would this prevent other users from viewing the files though?"}, {"owner": {"reputation": 5208, "user_id": 3369544, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/960368e0a7e4b3ab0662e57b405058f3?s=128&d=identicon&r=PG&f=1", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3369544/quentin"}, "edited": false, "score": 0, "creation_date": 1445613196, "post_id": 33266532, "comment_id": 54410392, "body": "It would depend on the permissions on your server, and where you put the files."}, {"owner": {"reputation": 8247, "user_id": 214994, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e3e91979c0412d33b1c0f9d5476f2d36?s=128&d=identicon&r=PG", "display_name": "Robert Penridge", "link": "https://stackoverflow.com/users/214994/robert-penridge"}, "edited": false, "score": 1, "creation_date": 1445905667, "post_id": 33266532, "comment_id": 54511653, "body": "I think what you want is possible.  I just recently finished some code using jQuery/AJAX that would take a programmatically created data, and upload it to a SAS/Intrnet server (equivalent of the STP I believe) in a way that was compatible with the details on page 145 here ( <a href=\"https://support.sas.com/documentation/cdl/en/dispatch/62562/PDF/default/dispatch.pdf\" rel=\"nofollow noreferrer\">support.sas.com/documentation/cdl/en/dispatch/62562/PDF/defa&zwnj;&#8203;ult/&hellip;</a> ).  If you are familiar with javascript you could have excel call some javascript instead of VBA. Alternatively there may be a way to do the equivalent using the Internet explorer automation object and VBA."}, {"owner": {"reputation": 8247, "user_id": 214994, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e3e91979c0412d33b1c0f9d5476f2d36?s=128&d=identicon&r=PG", "display_name": "Robert Penridge", "link": "https://stackoverflow.com/users/214994/robert-penridge"}, "edited": false, "score": 0, "creation_date": 1445905759, "post_id": 33266532, "comment_id": 54511680, "body": "And for what it is worth, I don&#39;t see how the STP could tell the difference between a programmatically generated HTTP request and a regular HTML <code>&lt;input type=&quot;file&quot;&gt;</code> approach.  It should all look the same to the server..."}, {"owner": {"reputation": 11421, "user_id": 66696, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8432e47991364671c37d83af91231e55?s=128&d=identicon&r=PG", "display_name": "Allan Bowe", "link": "https://stackoverflow.com/users/66696/allan-bowe"}, "edited": false, "score": 0, "creation_date": 1446048239, "post_id": 33266532, "comment_id": 54583143, "body": "Gonna rebuild the whole thing in the browser now..  But this does look like the way forward."}], "answers": [{"comments": [{"owner": {"reputation": 11421, "user_id": 66696, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8432e47991364671c37d83af91231e55?s=128&d=identicon&r=PG", "display_name": "Allan Bowe", "link": "https://stackoverflow.com/users/66696/allan-bowe"}, "edited": false, "score": 0, "creation_date": 1445522890, "post_id": 33280826, "comment_id": 54366270, "body": "The _ACTION=BACKGROUND option allows the STP to run asynchronously (in the background).  My question is about passing a file to an STP - so this precedes the running of the STP itself.  Agreed though,  am not convinced it is possible to do what I want either!"}, {"owner": {"reputation": 61, "user_id": 5460410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e678a90d299eb74646fe499161cae579?s=128&d=identicon&r=PG&f=1", "display_name": "JimL", "link": "https://stackoverflow.com/users/5460410/jiml"}, "reply_to_user": {"reputation": 11421, "user_id": 66696, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8432e47991364671c37d83af91231e55?s=128&d=identicon&r=PG", "display_name": "Allan Bowe", "link": "https://stackoverflow.com/users/66696/allan-bowe"}, "edited": false, "score": 0, "creation_date": 1445537166, "post_id": 33280826, "comment_id": 54375439, "body": "I read your post again and I think I have a better idea of what you need to do.  sorry, but I know very little about VBA, so I can&#39;t help you there.  I think that AMO could help if you are able to install it on the clients.  I&#39;d guess that you know this, but in case there&#39;s any confusion, the SAS Add-in does not put a full SAS install on the client, just the pieces necessary to communicate w/the server.  It&#39;s not too big of an install.  I wish I could be more help."}, {"owner": {"reputation": 11421, "user_id": 66696, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8432e47991364671c37d83af91231e55?s=128&d=identicon&r=PG", "display_name": "Allan Bowe", "link": "https://stackoverflow.com/users/66696/allan-bowe"}, "edited": false, "score": 0, "creation_date": 1445596779, "post_id": 33280826, "comment_id": 54399537, "body": "The issues we have with AMO is that we currently have 2 (and soon 3) versions of SAS to consider (which means different sets of VBA references), plus different versions of excel in use.  Also, it&#39;s very slow! Thanks though"}], "tags": [], "owner": {"reputation": 61, "user_id": 5460410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e678a90d299eb74646fe499161cae579?s=128&d=identicon&r=PG&f=1", "display_name": "JimL", "link": "https://stackoverflow.com/users/5460410/jiml"}, "is_accepted": false, "score": 0, "last_activity_date": 1445516141, "creation_date": 1445516141, "answer_id": 33280826, "question_id": 33266532, "link": "https://stackoverflow.com/questions/33266532/loading-files-to-sas-stored-process-server-using-vba/33280826#33280826", "title": "Loading files to SAS Stored Process server using VBA", "body": "<p>I don't really know if it is possible to do what you want, but I did see this and wonder if background mode would make a difference.</p>\n\n<p><a href=\"http://support.sas.com/kb/39/114.html\" rel=\"nofollow\">http://support.sas.com/kb/39/114.html</a></p>\n"}], "owner": {"reputation": 11421, "user_id": 66696, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8432e47991364671c37d83af91231e55?s=128&d=identicon&r=PG", "display_name": "Allan Bowe", "link": "https://stackoverflow.com/users/66696/allan-bowe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 160, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1445596635, "creation_date": 1445451752, "last_edit_date": 1531164843, "question_id": 33266532, "link": "https://stackoverflow.com/questions/33266532/loading-files-to-sas-stored-process-server-using-vba", "title": "Loading files to SAS Stored Process server using VBA", "body": "<p>Is there a way of (programmatically) sending files directly to the STP server via HTTP?  It appears that the <a href=\"http://support.sas.com/documentation/cdl/en/stpug/61271/PDF/default/stpug.pdf\" rel=\"nofollow\">documented</a> approach (using <code>&lt;input type=\"file\"&gt;</code>) cannot be used in an automated fashion, due to an explicit browser restriction designed to prevent spamming of web servers.</p>\n\n<p>I don't wish to use the IOM (although we have AMO licensed) as this creates a dependency on a local SAS installation.</p>\n\n<p>The current approach involves writing out to a shared directory and then calling an STP via a <a href=\"http://bi-notes.com/2013/02/sas-stored-processes-querying-a-stored-process-from-excel-without-the-add-in/\" rel=\"nofollow\">web query</a> - which then lifts and drops the data to a non-shared location.</p>\n\n<p>The issue is that the data is then in the wider corporate domain for those few seconds..  Would be much tidier to upload directly to SAS!</p>\n\n<p>Is it possible though?  Without third party software (just vanilla excel VBA)?</p>\n"}, {"tags": ["excel", "vba", "triggers"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1445452313, "post_id": 33266396, "comment_id": 54334499, "body": "Can you not use conditional formatting?"}, {"owner": {"reputation": 53, "user_id": 5380661, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/17c36aa45a0a711bb16e2f63300382fe?s=128&d=identicon&r=PG&f=1", "display_name": "RG1of2", "link": "https://stackoverflow.com/users/5380661/rg1of2"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1445613631, "post_id": 33266396, "comment_id": 54410702, "body": "@ScottCraner hey can you help me out? I&#39;m not sure why newjenn&#39;s code isn&#39;t working and he&#39;s not responding. Thanks, I appreciate it"}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1445454663, "post_id": 33267071, "comment_id": 54335848, "body": "Look at the remarks on the page you provided, this will not fire.  The OP says that the cells contain formula and are not changed manually. It needs to be the calculate event"}, {"owner": {"reputation": 53, "user_id": 5380661, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/17c36aa45a0a711bb16e2f63300382fe?s=128&d=identicon&r=PG&f=1", "display_name": "RG1of2", "link": "https://stackoverflow.com/users/5380661/rg1of2"}, "edited": false, "score": 0, "creation_date": 1445524309, "post_id": 33267071, "comment_id": 54367251, "body": "@newjenn in your screenshot you have the code pasted in module 3 instead of sheet1 code, was that an accident? I am supposed to paste this in the sheet code where I want it to operate right? Not save it as a module"}, {"owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "edited": false, "score": 0, "creation_date": 1445524475, "post_id": 33267071, "comment_id": 54367374, "body": "You need to paste in sheet1 not in module"}, {"owner": {"reputation": 53, "user_id": 5380661, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/17c36aa45a0a711bb16e2f63300382fe?s=128&d=identicon&r=PG&f=1", "display_name": "RG1of2", "link": "https://stackoverflow.com/users/5380661/rg1of2"}, "edited": false, "score": 0, "creation_date": 1445611648, "post_id": 33267071, "comment_id": 54409224, "body": "@newjenn it is not working. When new data is entered into the sheets this sheet is linked to and its cell values are recalculated, the macro doesn&#39;t seem to run.  To clarify, I need this subroutine to be activated anytime a change is made to 2 spreadsheets in my workbook. The only time they change is when the spreadsheets they are linked to (via formulas) are changed.   What I did was paste the above code into the code sheet for both sheets I want the macro to run in. Is there anything I missed?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 53, "user_id": 5380661, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/17c36aa45a0a711bb16e2f63300382fe?s=128&d=identicon&r=PG&f=1", "display_name": "RG1of2", "link": "https://stackoverflow.com/users/5380661/rg1of2"}, "edited": false, "score": 0, "creation_date": 1445613894, "post_id": 33267071, "comment_id": 54410864, "body": "@RG1of2 change the top line to <code>Private Sub Worksheet_Calculate()</code>  The line that newjenn gave goes in the <code>ThisWorkbook</code> object.  So, in the sheet object like he explained it needs to be named different."}, {"owner": {"reputation": 53, "user_id": 5380661, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/17c36aa45a0a711bb16e2f63300382fe?s=128&d=identicon&r=PG&f=1", "display_name": "RG1of2", "link": "https://stackoverflow.com/users/5380661/rg1of2"}, "edited": false, "score": 0, "creation_date": 1445624138, "post_id": 33267071, "comment_id": 54416638, "body": "It worked! Thanks newjenn and scott, you guys are awesome"}], "tags": [], "owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "is_accepted": true, "score": 1, "last_activity_date": 1445454825, "last_edit_date": 1445454825, "creation_date": 1445453677, "answer_id": 33267071, "question_id": 33266396, "link": "https://stackoverflow.com/questions/33266396/how-to-trigger-macro-if-a-range-of-cells-containing-formulas-linked-to-other-she/33267071#33267071", "title": "How to trigger macro if a range of cells containing formulas linked to other sheets output a different value", "body": "<p>You can use \"Private Sub Workbook_SheetCalculate(ByVal Sh As Object)\" subroutine to perform change function. Paste the below code in the Microsoft excel object-->sheetname place. Look into the attached picture too</p>\n\n<p>Private Sub Workbook_SheetCalculate(ByVal Sh As Object)</p>\n\n<pre><code>    Dim i As Integer, j As Integer\n\nFor i = 5 To 27\n    If i Mod 2 &lt;&gt; 0 Then\n\n        For j = 2 To 16\n\n        'Debug.Print Cells(i, j)\n\n            If Cells(i, j).Value = 0 Then\n                Cells(i, j).Interior.Color = RGB(146, 208, 80) 'light green fill\n                Cells(i, j).Font.Color = RGB(0, 176, 80) 'dark green font\n\n            ElseIf (Cells(2, 1).Value - Cells(i, 1).Value) &gt; 60 And Cells(i, j).Value &gt; 0 Then\n                Cells(i, j).Interior.Color = RGB(255, 0, 0) 'red fill\n                Cells(i, j).Font.Color = RGB(255, 255, 0) 'yellow font\n\n            ElseIf (Cells(2, 1).Value - Cells(i, 1).Value) &gt; 52 And Cells(i, j).Value &gt; 0 Then\n                Cells(i, j).Interior.Color = RGB(255, 192, 0) 'orange fill, black font\n\n            ElseIf (Cells(2, 1).Value - Cells(i, 1).Value) &gt; 45 And Cells(i, j).Value &gt; 0 Then\n                Cells(i, j).Interior.Color = RGB(255, 255, 0) 'yellow fill, black font\n            End If\n\n        Next j\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>You can also look into link for your reference<a href=\"https://i.stack.imgur.com/i1tem.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/i1tem.jpg\" alt=\"enter image description here\"></a> \n<a href=\"https://msdn.microsoft.com/en-us/library/office/ff839775.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff839775.aspx</a></p>\n"}], "owner": {"reputation": 53, "user_id": 5380661, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/17c36aa45a0a711bb16e2f63300382fe?s=128&d=identicon&r=PG&f=1", "display_name": "RG1of2", "link": "https://stackoverflow.com/users/5380661/rg1of2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 33267071, "answer_count": 1, "score": 1, "last_activity_date": 1445454825, "creation_date": 1445451220, "last_edit_date": 1445453813, "question_id": 33266396, "link": "https://stackoverflow.com/questions/33266396/how-to-trigger-macro-if-a-range-of-cells-containing-formulas-linked-to-other-she", "title": "How to trigger macro if a range of cells containing formulas linked to other sheets output a different value", "body": "<p>I am running the following macro to apply conditional formatting on a range of cells. What I want is the macro to be triggered anytime those cell values change. The cell values are not changed manually (i.e. they aren't selected by a user and changed), they change automatically because they contain formulas linked to cells in other spreadsheets.</p>\n\n<p>What is the most efficient of doing this?</p>\n\n<pre><code>  Sub TestSub3()\n\n    Dim i As Integer, j As Integer\n\nFor i = 5 To 27\n    If i Mod 2 &lt;&gt; 0 Then\n\n        For j = 2 To 16\n            If Cells(i, j) = 0 Then\n                Cells(i, j).Interior.Color = RGB(146, 208, 80) 'light green fill\n                Cells(i, j).Font.Color = RGB(0, 176, 80) 'dark green font\n\n            ElseIf Cells(2, 1) - Cells(i, 1) &gt; 60 And Cells(i, j) &gt; 0 Then\n                Cells(i, j).Interior.Color = RGB(255, 0, 0) 'red fill\n                Cells(i, j).Font.Color = RGB(255, 255, 0) 'yellow font\n\n            ElseIf Cells(2, 1) - Cells(i, 1) &gt; 52 And Cells(i, j) &gt; 0 Then\n                Cells(i, j).Interior.Color = RGB(255, 192, 0) 'orange fill, black font\n\n            ElseIf Cells(2, 1) - Cells(i, 1) &gt; 45 And Cells(i, j) &gt; 0 Then\n                Cells(i, j).Interior.Color = RGB(255, 255, 0) 'yellow fill, black font\n            End If\n\n        Next j\n\n    End If\n\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1445451416, "post_id": 33266385, "comment_id": 54334039, "body": "Okay.  Have you tried anything? Can you show us?"}], "answers": [{"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 2, "last_activity_date": 1445454043, "last_edit_date": 1445454043, "creation_date": 1445451933, "answer_id": 33266585, "question_id": 33266385, "link": "https://stackoverflow.com/questions/33266385/make-a-sheet-act-like-a-button/33266585#33266585", "title": "Make a sheet act like a button", "body": "<p>You can create a public variable <code>CurrentSheet</code>, initialize it to <code>ActiveSheet</code> in the Workbook_Open event and then in the workbook's <code>SheetActivate</code> event either update the value of <code>CurrentSheet</code> or switch back to the previous current sheet and show the user form. Something like (in the <code>Workbook</code> code sheet):</p>\n\n<pre><code>Public CurrentSheet As Worksheet\n\nPrivate Sub Workbook_Open()\n    Set CurrentSheet = ActiveSheet\nEnd Sub\n\nPrivate Sub Workbook_SheetActivate(ByVal Sh As Object)\n    If Sh.Name = \"Administrator\" Then\n        CurrentSheet.Activate\n        UserForm1.Show\n    Else\n        Set CurrentSheet = Sh\n    End If\nEnd Sub\n</code></pre>\n\n<p>On Edit: To be safe you can also add the following code. This adds a layer of protection if something causes your project to reset after the <code>Workbook_Open</code> event. In the original code I was able to generate a crash when I purposely reset the project before activating Administrator.</p>\n\n<pre><code>Private Sub Workbook_SheetDeactivate(ByVal Sh As Object)\n    Set CurrentSheet = Sh\nEnd Sub\n</code></pre>\n\n<p>This might render the code in <code>Workbook_Open</code> redundant, but personally I would keep it in since I don't like the idea of having uninitialized global variables, even if they will be initialized before I use them. Also -- if the workbook opens <em>in</em> Administrator (which might be some error condition) this will guarantee that <code>CurrentSheet</code> has a value.</p>\n"}], "owner": {"reputation": 163, "user_id": 4611636, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/CApZY.png?s=128&g=1", "display_name": "Iluvpresident", "link": "https://stackoverflow.com/users/4611636/iluvpresident"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 33266585, "answer_count": 1, "score": 1, "last_activity_date": 1445454043, "creation_date": 1445451186, "question_id": 33266385, "link": "https://stackoverflow.com/questions/33266385/make-a-sheet-act-like-a-button", "title": "Make a sheet act like a button", "body": "<p>I want the sheet <code>Administrator</code> to act like a button but I don't want to go to the actual sheet. </p>\n\n<p>It should open up an UserForm and stay on the active sheet if click on <code>Administrator</code>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/uhjzT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uhjzT.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "button", "module", "vba"], "answers": [{"comments": [{"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1445451766, "post_id": 33266232, "comment_id": 54334230, "body": "Change this line: <code>With WKB</code> to <code>With WBK</code> otherwise the code will not produce the expected results."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1445451980, "post_id": 33266232, "comment_id": 54334326, "body": "Thanks for the catch @EEM. I fixed it."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1445464985, "last_edit_date": 1445464985, "creation_date": 1445450605, "answer_id": 33266232, "question_id": 33265617, "link": "https://stackoverflow.com/questions/33265617/copy-worksheet-code-and-button-to-a-new-file/33266232#33266232", "title": "copy worksheet, code and button to a new file", "body": "<p>Your problem stems from the fact that you are not qualifying your workbooks correctly. Using <code>ThisWorkbook</code> will <strong>always</strong> signify the workbook running the code. Using <code>ActiveWorkbook</code> will <strong>always</strong> signify the workbook that is active at that moment in the codes execution. While there are perfectly legitimate times and places to use this, its generally a <strong>bad</strong> practice to do so, especially <code>ActiveWorkbook</code> (and <code>ActiveSheet</code> for that matter).</p>\n\n<p>I have refactored your code with full comments to illustrate this, as well as cleaned up some other syntax related stuff that was in there.</p>\n\n<pre><code>Sub Workbook_Open()\n\nConst MODULE_NAME    As String = \"DataValidityCheck\"         ' Name of the module to transfer\nConst TEMPFILE       As String = \"c:\\DataValidityCheck.bas\" ' temp textfile\n\n'qualify main workbook\nDim wbkMain As Workbook\nSet wbkMain = ThisWorkbook\n'export desired module\nWith wbkMain\n\n    .VBProject.VBComponents(MODULE_NAME).Export TEMPFILE\n\n    'copy out sheets\n    .Sheets(Array(\"Sheet1\", \"Sheet2\")).Copy\n\nEnd With\n\n'qualify new workbook\nDim WBK As Workbook\nSet WBK = ActiveWorkbook 'this is one of only a few times its required to use 'ActiveWorkbook'\n\n'work directly with new workbook\nWith WBK\n\n    'Copy Module to New Workbook\n    .VBProject.VBComponents.Import TEMPFILE\n    Kill TEMPFILE\n\n    'delete bad names\n    Dim nm As Name\n    For Each nm In .Names\n        If InStr(1, nm.RefersTo, \"#REF!\") Then nm.Delete\n    Next\n\n    'Delete every shape in the Shapes collection\n    With .Sheets(1) 'change to 2 if you need sheet 2\n\n        Dim myshape As Shape\n        For Each myshape In .Shapes 'change to 2 if you need sheet 2\n            myshape.Delete\n        Next myshape\n\n        .Buttons.Add(2538, 4.5, 71.25, 14.25).Select\n\n        With Selection 'should really set this to a variable as well, but I didn't feel like looking the right syntax\n            .Caption = \"Validate Data\" 'change the name of the button accordingly\n            .OnAction = \"msg\" 'Workbook_Open if need be\n        End With\n\n    End With\n\n    'finally save the new workbook\n    Dim filename4 As String, strFilename4 As String\n    strFilename4 = \"\\Work Data \" &amp; Format(Now(), \"ddmmyy hhmmss\")\n    filename4 = ActiveWorkbook.Path &amp; strFilename4 &amp; \".xlsm\"\n\n    .SaveAs Filename:=filename4, FileFormat:=xlOpenXMLWorkbookMacroEnabled, Password:=\"\", WriteResPassword:=\"\", ReadOnlyRecommended:=False _\n        , CreateBackup:=False\n\n    .Close True 'don't need since you just saved, but why not\n\nEnd With\n\nApplication.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5472656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/137e22042afa071bbe418ce03ead4e55?s=128&d=identicon&r=PG&f=1", "display_name": "Mitesh Shah", "link": "https://stackoverflow.com/users/5472656/mitesh-shah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 667, "favorite_count": 0, "accepted_answer_id": 33266232, "answer_count": 1, "score": 2, "last_activity_date": 1445464985, "creation_date": 1445448457, "last_edit_date": 1531164843, "question_id": 33265617, "link": "https://stackoverflow.com/questions/33265617/copy-worksheet-code-and-button-to-a-new-file", "title": "copy worksheet, code and button to a new file", "body": "<p>I have created some codes and one of my requirement is to copy certain sheets, modules and buttons to refer those modules to a new workbook. </p>\n\n<p>I am facing two problems:</p>\n\n<p>1) While trying various things I am able to copy worksheets and module. However, the problem is when I copy module buttons to new worksheet, it still refers to the original file and not the new file which has been created.</p>\n\n<p>2) When the button delete command runs it deletes buttons from existing workbook  and inserts a new button in existing workbook.</p>\n\n<p>I can understand that somewhere I am not getting back to original file but not able to make out where and how to go to new file to execute the code.</p>\n\n<p>The code for copying file, modules and buttons is as listed below.</p>\n\n<pre><code>Sub Workbook_Open()\n\nDim filename4 As String:\nstrFilename4 = \"\\Work Data \" &amp; Format(Now(), \"ddmmyy hhmmss\")\nfilename4 = ActiveWorkbook.Path &amp; strFilename4 &amp; \".xlsm\"\n\nDim nm As Name\nDim ws As Worksheet\n    Sheets(Array(\"Sheet1\", \"Sheet2\")).Copy\n        For Each nm In ActiveWorkbook.Names\n          If InStr(1, nm.RefersTo, \"#REF!\") &gt; 0 Then\n            Debug.Print nm.Name &amp; \": deleted\"\n            nm.Delete\n          End If\n        Next nm\n\nActiveWorkbook.SaveAs filename:=filename4, FileFormat:=xlOpenXMLWorkbookMacroEnabled, Password:=\"\", WriteResPassword:=\"\", ReadOnlyRecommended:=False _\n, CreateBackup:=False\nActiveWorkbook.Close\n\nConst MODULE_NAME    As String = \"DataValidityCheck\"         ' Name of the module to transfer\nConst TEMPFILE       As String = \"c:\\DataValidityCheck.bas\" ' temp textfile\nDim WBK As Workbook\nSet WBK = Workbooks.Open(filename4)\n\n'Copy Module to New Workbook\n   On Error Resume Next\n   Set WBK = Workbooks(filename4)\n   ThisWorkbook.VBProject.VBComponents(MODULE_NAME).Export TEMPFILE\n   WBK.VBProject.VBComponents.Import TEMPFILE\n   Kill TEMPFILE\n\n'Delete every shape in the Shapes collection\n    Dim myshape As Shape\n    For Each myshape In ActiveSheet.Shapes\n        myshape.Delete\n    Next myshape\n\n    ThisWorkbook.ActiveSheet.Buttons.Add(2538, 4.5, 71.25, 14.25).Select\n\n    With btn\n        .Caption = \"Validate Data\" 'change the name of the button accordingly\n        .OnAction = \"msg\"\n    End With\n    Selection.OnAction = \"Workbook_Open\"\n ActiveWorkbook.Close SaveChanges:=True\n\nEnd If\nApplication.CutCopyMode = False\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1445448177, "creation_date": 1445448177, "answer_id": 33265540, "question_id": 33265503, "link": "https://stackoverflow.com/questions/33265503/transposing-a-table-to-multiple-columns/33265540#33265540", "title": "&quot;Transposing&quot; a table to multiple columns", "body": "<p>change this: <code>Do While colBase &lt; lastCol</code> to this:</p>\n\n<pre><code>Do While colBase &lt;= lastCol\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 4276332, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1252422897/picture?type=large", "display_name": "Angie Li", "link": "https://stackoverflow.com/users/4276332/angie-li"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 33265540, "answer_count": 1, "score": 2, "last_activity_date": 1445448177, "creation_date": 1445448042, "question_id": 33265503, "link": "https://stackoverflow.com/questions/33265503/transposing-a-table-to-multiple-columns", "title": "&quot;Transposing&quot; a table to multiple columns", "body": "<p>I have a table looks like this:</p>\n\n<pre><code>+---+---+---+---+---+---+\n|   | a | b | c | d | e |\n+---+---+---+---+---+---+\n| f | 1 | 3 | 3 | 2 | 2 |\n| g | 3 | 1 | 3 | 2 | 1 |\n| h | 3 | 3 | 1 | 3 | 3 |\n| i | 2 | 2 | 3 | 1 | 2 |\n| j | 2 | 1 | 3 | 2 | 1 |\n+---+---+---+---+---+---+\n</code></pre>\n\n<p>And I want it to be like this:</p>\n\n<pre><code>+---+---+---+\n| a | f | 1 |\n| a | g | 3 |\n| a | h | 3 |\n| a | i | 2 |\n| a | j | 2 |\n| b | f | 3 |\n| b | g | 1 |\n| b | h | 3 |\n| b | i | 2 |\n| b | j | 1 |\n| c | f | 3 |\n| c | g | 3 |\n| c | h | 1 |\n| c | i | 3 |\n| c | j | 3 |\n| d | f | 2 |\n| d | g | 2 |\n| d | h | 3 |\n| d | i | 1 |\n| d | j | 2 |\n| e | f | 2 |\n| e | g | 1 |\n| e | h | 3 |\n| e | i | 2 |\n| e | j | 1 |\n+---+---+---+\n</code></pre>\n\n<p>I'm using this macro:</p>\n\n<pre><code>   Sub ColumnCopy()\n\nSheets(\"test\").Cells.Clear\n\nDim tRow As Long\nDim source As String\nDim target As String\n\n    source = \"test1\"       'Set your source sheet here\n    target = \"test\"       'Set the Target sheet name\n\n    'tRow = 2                'Define the start row of the target sheet\n\n    'Get Last Row and Column\n    lastRow = Sheets(source).Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    lastCol = Sheets(source).Cells(1, Columns.Count).End(xlToLeft).Column\n\n    tRow = 2\n    colBase = 2\n    Do While colBase &lt; lastCol\n        For iRow = 2 To lastRow\n\n            Sheets(target).Cells(tRow, 1) = Sheets(source).Cells(1, colBase)\n            Sheets(target).Cells(tRow, 2) = Sheets(source).Cells(iRow, 1)\n            Sheets(target).Cells(tRow, 3) = Sheets(source).Cells(iRow, colBase)\n\n            tRow = tRow + 1\n        Next iRow\n        colBase = colBase + 1\n    Loop\nEnd Sub\n</code></pre>\n\n<p>But i'm getting result missing the \"column e\":</p>\n\n<pre><code>+---+---+---+\n| a | f | 1 |\n| a | g | 3 |\n| a | h | 3 |\n| a | i | 2 |\n| a | j | 2 |\n| b | f | 3 |\n| b | g | 1 |\n| b | h | 3 |\n| b | i | 2 |\n| b | j | 1 |\n| c | f | 3 |\n| c | g | 3 |\n| c | h | 1 |\n| c | i | 3 |\n| c | j | 3 |\n| d | f | 2 |\n| d | g | 2 |\n| d | h | 3 |\n| d | i | 1 |\n| d | j | 2 |\n+---+---+---+\n</code></pre>\n\n<p>I can't find what's causing this issue. I'm really new to excel macro.\nThanks for the help!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1445451404, "post_id": 33265234, "comment_id": 54334032, "body": "I am not 100% clear on what you are asking: do you want to the macro to look at column C instead of column D to decide whether or not include the attachment? or in addition to column D? what does this mean * is it possible to prevent the attachment from being viewed/opened?*"}, {"owner": {"reputation": 2528, "user_id": 4668368, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/70b77439d7ee9bb7410105b7bc912afb?s=128&d=identicon&r=PG&f=1", "display_name": "justaguy", "link": "https://stackoverflow.com/users/4668368/justaguy"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1445462327, "post_id": 33265234, "comment_id": 54339930, "body": "I am going to mark this as solved as I do not think this is worth trying to fix.     The VB works as is except for one thing which I will post.  Thank you :)."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1445465143, "post_id": 33265234, "comment_id": 54341278, "body": "changing the title to have <code>[SOLVED]</code> will not do anything to mark it solved. Having an answer that is given marked as the correct answer is the only way to solve it. If you end up posting your own answer, you can mark that. Otherwise, others will never know the solution. Lastly, I think it can be an easy fix, once I fully understand what you want."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1446563883, "post_id": 33265234, "comment_id": 54788699, "body": "Change <code>If LCase(c.Offset(, 3)) = &quot;x&quot;</code> to <code>If LCase(c.Offset(, 2)) = &quot;x&quot;</code>..."}], "owner": {"reputation": 2528, "user_id": 4668368, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/70b77439d7ee9bb7410105b7bc912afb?s=128&d=identicon&r=PG&f=1", "display_name": "justaguy", "link": "https://stackoverflow.com/users/4668368/justaguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1446563307, "creation_date": 1445447095, "last_edit_date": 1531164843, "question_id": 33265234, "link": "https://stackoverflow.com/questions/33265234/do-not-view-attachment-is-cell-d2-is-not-marked", "title": "do not view attachment is cell D2 is not marked", "body": "<p>The VB below only sends an attachment if cell D2 is marked with an \"x\".  I can not seem to figure out how not to load or view the attachment if C2 is marked with an \"x\".  Currently the VB runs and if C2 is marked with an \"x\" the user sees the attachment but it is not added to the email, is it possible to prevent the attachment from being viewed/opened?  Thank you :).</p>\n\n<p><strong>VB</strong></p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim WS As Worksheet, Rng As Range, c As Range\nDim OutApp As Object, OutMail As Object\nDim Msg As String, Addr As String, FName As String, i As Long\nDim obj As Object\nDim MyFile As String, MyFileCopy As String\n\n'define path\nMyFileCopy = \"L:\\NGS\\HLA LAB\\total quality management\\QC &amp; QA\\DOSE reports\\DOSE reporting form Attachment.xlsx\"\n\n'create a separate sheet2 to mail out\nSheets(2).Copy\nSet wkb = ActiveWorkbook\nWith wkb\n    .SaveAs MyFileCopy\n    .Close True\nEnd With\n\n' create connection, check condition, send email\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet WS = ThisWorkbook.Sheets(\"Email\")\nSet Rng = WS.Range(\"A2\", WS.Range(\"A\" &amp; Rows.Count).End(xlUp))\n\n For Each c In Rng\n\n        Msg = \"For \" &amp; c.Offset(, 1) &amp; Chr(14) &amp; Chr(14)\n        For i = 3 To 14\n            If LCase(WS.Cells(c.Row, i)) = \"x\" Then\n                Msg = Msg &amp; \"   -\" &amp; WS.Cells(1, i) &amp; Chr(14)\n            End If\n        Next\n\n        Set OutMail = OutApp.CreateItem(0)\n\n        With OutMail\n            .To = c.Offset(, 0)\n            .CC = \"\"\n            .BCC = \"\"\n            .Subject = \"Daily Operational Safety Briefing\"\n            .Body = Msg\n            If LCase(c.Offset(, 3)) = \"x\" Then .Attachments.Add MyFileCopy, 1\n            .Send\n        End With\n\nNext c\n\n'confirm message sent and delete copy\nMsgBox \"The data has been emailed sucessfully.\", vbInformation\nKill MyFileCopy\n\nSet OutMail = Nothing\nSet OutApp = Nothing\n\n' Exit and do not save\nApplication.Quit\nThisWorkbook.Close SaveChanges:=False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "userform"], "answers": [{"comments": [{"owner": {"reputation": 8750, "user_id": 45084, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/23bf7f3caa0269ec36ae928757bfb932?s=128&d=identicon&r=PG", "display_name": "Tmdean", "link": "https://stackoverflow.com/users/45084/tmdean"}, "edited": false, "score": 0, "creation_date": 1445447422, "post_id": 33265231, "comment_id": 54331742, "body": "CLng() or CDbl() are probably what you want to use in this situation."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1445447090, "creation_date": 1445447090, "answer_id": 33265231, "question_id": 33265168, "link": "https://stackoverflow.com/questions/33265168/using-commas-within-textbox/33265231#33265231", "title": "Using commas within textbox", "body": "<p>That is because <strong>VAL()</strong> stops at the first comma.  See <em>VBA Help</em></p>\n"}], "owner": {"reputation": 95, "user_id": 5344302, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/af508996124898d0a86e19c443e0f726?s=128&d=identicon&r=PG&f=1", "display_name": "redcase", "link": "https://stackoverflow.com/users/5344302/redcase"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1445447249, "creation_date": 1445446881, "last_edit_date": 1445447249, "question_id": 33265168, "link": "https://stackoverflow.com/questions/33265168/using-commas-within-textbox", "title": "Using commas within textbox", "body": "<p>If I use the following code for my textbox, when I enter the number <code>1,000,000</code> and submit it with my command button it shows up in Range(\"F1IMPG1\") as <code>1</code>.</p>\n\n<pre><code>Range(\"F1IMPG1\").Value = Val(txtF1IMP1.Value)\n</code></pre>\n\n<p>If I don't use commas it shows up correctly as <code>1,000,000</code>.</p>\n\n<p>Anybody know why this might be?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 1, "creation_date": 1445447017, "post_id": 33265140, "comment_id": 54331507, "body": "Have you tried renaming the problem combobox on the 2nd worksheet?"}, {"owner": {"reputation": 3734, "user_id": 2921363, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/5caeedd7806ff7242659106e06d3f2a9?s=128&d=identicon&r=PG&f=1", "display_name": "bsapaka", "link": "https://stackoverflow.com/users/2921363/bsapaka"}, "edited": false, "score": 0, "creation_date": 1445447163, "post_id": 33265140, "comment_id": 54331579, "body": "the most recent Excel version(s) have only 1 sheet upon opening (not 3 like the earlier versions) so you will get an error referencing the non-existent sheet"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 3734, "user_id": 2921363, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/5caeedd7806ff7242659106e06d3f2a9?s=128&d=identicon&r=PG&f=1", "display_name": "bsapaka", "link": "https://stackoverflow.com/users/2921363/bsapaka"}, "edited": false, "score": 0, "creation_date": 1445447241, "post_id": 33265140, "comment_id": 54331623, "body": "@bsapaka assuming the workbook <i>already has two sheets</i>... anyways that would raise a Subscript Out of Range error, not a 32809 error :)"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1445447245, "post_id": 33265140, "comment_id": 54331626, "body": "<a href=\"http://stackoverflow.com/questions/27591879/suddenly-several-vba-macro-errors-mostly-32809\" title=\"suddenly several vba macro errors mostly 32809\">stackoverflow.com/questions/27591879/&hellip;</a>"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1445447256, "post_id": 33265140, "comment_id": 54331632, "body": "<a href=\"http://stackoverflow.com/questions/19861288/excel-vba-run-time-error-32809-trying-to-understand-it\" title=\"excel vba run time error 32809 trying to understand it\">stackoverflow.com/questions/19861288/&hellip;</a>"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1445447291, "post_id": 33265140, "comment_id": 54331658, "body": "Sheet(s) or workbook may have become corrupted. That seems to be the consensus around this error number."}, {"owner": {"reputation": 1, "user_id": 5472549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc1a94114d236beffb581b4dbcc7d564?s=128&d=identicon&r=PG", "display_name": "Blake Roth", "link": "https://stackoverflow.com/users/5472549/blake-roth"}, "edited": false, "score": 0, "creation_date": 1445451106, "post_id": 33265140, "comment_id": 54333856, "body": "I would like to add that if I comment out the lines Worksheets(1).OLEObjects(&quot;ComboBox21&quot;).ListFillRange = &quot;impacts&quot; Worksheets(2).OLEObjects(&quot;ComboBox21&quot;).ListFillRange = &quot;yesnoo&quot; I get the error now that &quot;Can&#39;t exit design mode because control &#39; dattimepicker21&#39; cannot be created"}, {"owner": {"reputation": 1, "user_id": 5472549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc1a94114d236beffb581b4dbcc7d564?s=128&d=identicon&r=PG", "display_name": "Blake Roth", "link": "https://stackoverflow.com/users/5472549/blake-roth"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1445455314, "post_id": 33265140, "comment_id": 54336207, "body": "I have 7 sheets in the workbook. What would the steps be if the workbook got corrupted? And if corrupted why would it work perfectly fine on most computers? @DavidZemens"}, {"owner": {"reputation": 12472, "user_id": 4850, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/GOfnj.jpg?s=128&g=1", "display_name": "Andr&#233; Chalella", "link": "https://stackoverflow.com/users/4850/andr%c3%a9-chalella"}, "edited": false, "score": 1, "creation_date": 1445455558, "post_id": 33265140, "comment_id": 54336335, "body": "Unfortunately, Excel is often really that unpredictable. Trying to recreate the workbook from scratch (as tough as it may be) is crucial to find out if there&#39;s a real problem or if the file just got corrupted along the way somehow."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1445456860, "post_id": 33265140, "comment_id": 54337025, "body": "What happens if you do <code>Worksheets(2).OLEObjects(&quot;ComboBox22&quot;).ListFillRange = &quot;yesnoo&quot;</code>?  You&#39;re going to have to open the file, skip/ignore the errors, make the change to the code, save &amp; close &amp; reopen."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1445457578, "post_id": 33265140, "comment_id": 54337383, "body": "See this also, which seems very much similar to your problem: <a href=\"http://superuser.com/questions/874349/excel-runtime-error-32809-corrupt-workbooks\" title=\"excel runtime error 32809 corrupt workbooks\">superuser.com/questions/874349/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5472549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc1a94114d236beffb581b4dbcc7d564?s=128&d=identicon&r=PG", "display_name": "Blake Roth", "link": "https://stackoverflow.com/users/5472549/blake-roth"}, "is_accepted": false, "score": 0, "last_activity_date": 1445537632, "creation_date": 1445537632, "answer_id": 33287865, "question_id": 33265140, "link": "https://stackoverflow.com/questions/33265140/excel-macro-opens-with-run-time-error-32809/33287865#33287865", "title": "Excel Macro opens with run time error 32809", "body": "<p>I found and fixed the problem, the machines that were not working were missing MSCOMCT2.OCX </p>\n\n<p><a href=\"http://answers.microsoft.com/en-us/office/forum/office_2013_release-excel/date-picker-dropdown-in-excel-2013/71decdcd-6cc6-4a70-b1ab-20294a2a315a\" rel=\"nofollow\">http://answers.microsoft.com/en-us/office/forum/office_2013_release-excel/date-picker-dropdown-in-excel-2013/71decdcd-6cc6-4a70-b1ab-20294a2a315a</a></p>\n"}], "owner": {"reputation": 1, "user_id": 5472549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc1a94114d236beffb581b4dbcc7d564?s=128&d=identicon&r=PG", "display_name": "Blake Roth", "link": "https://stackoverflow.com/users/5472549/blake-roth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1513, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1445537632, "creation_date": 1445446808, "last_edit_date": 1445455389, "question_id": 33265140, "link": "https://stackoverflow.com/questions/33265140/excel-macro-opens-with-run-time-error-32809", "title": "Excel Macro opens with run time error 32809", "body": "<p>I have an Excel Macro Enabled workbook that I created on Excel 2013.  The workbook's macros work well with my computer but does not work on some other computers even if they are using Excel 2013. Works on 7/10 computers I tried both on windows 7 and 8. When I send it to someone's computer that does not work this is what happens:</p>\n\n<p>They open the workbook and once the user clicks \"enable content\" the workbook errors out \"run time error '32809': Application-defined or object-defined error\"</p>\n\n<p>debug shows it getting stuck on 2nd line of code below:</p>\n\n<pre><code>private sub workbook open()\nWorksheets(1).OLEObjects(\"ComboBox21\").ListFillRange = \"impacts\"\n**Worksheets(2).OLEObjects(\"ComboBox21\").ListFillRange = \"yesnoo\"** This line errors\n</code></pre>\n\n<p>if I comment out these two lines, the workbook will open but the combobox21 on worksheet(2) gets renamed to combobox22 and does not work but the first combobox on worksheet(1) loads and functions fine. </p>\n\n<p>I would like to add that if I comment out the lines </p>\n\n<pre><code>Worksheets(1).OLEObjects(\"ComboBox21\").ListFillRange = \"impacts\"\nWorksheets(2).OLEObjects(\"ComboBox21\").ListFillRange = \"yesnoo\" \n</code></pre>\n\n<p>I get the error now that \"Can't exit design mode because control ' dattimepicker21' cannot be created</p>\n"}, {"tags": ["excel", "combobox", "textbox", "vba"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1445446863, "post_id": 33265022, "comment_id": 54331403, "body": "To start with you don&#39;t need the <code>&amp; &quot;&quot;</code>  You can just do `If TextBox1.Value = &quot;&quot; Or"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1445447973, "post_id": 33265022, "comment_id": 54332018, "body": "do you care about the other boxes anymore? or just the 4 you referenced?"}], "answers": [{"tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 0, "last_activity_date": 1445447882, "last_edit_date": 1495541681, "creation_date": 1445447225, "answer_id": 33265265, "question_id": 33265022, "link": "https://stackoverflow.com/questions/33265022/vba-function-for-checking-empty-combobox-or-textbox-with-complex-condition/33265265#33265265", "title": "VBA function for checking empty combobox or textbox with complex condition", "body": "<p>From what I understand you want to return true if any two items have a value.</p>\n\n<p>Basically you will want <code>If (item1 &lt;&gt; \"\" And item2 &lt;&gt; \"\") Or (item3 &lt;&gt;\"\" And item4 &lt;&gt; \"\") Then</code></p>\n\n<p>You can try something like this:</p>\n\n<pre><code>If (TextBox1.Value &lt;&gt; \"\" And ComboBox1.Value &lt;&gt; \"\") Or _\n   (AAX.Value &lt;&gt; \"\" And AAY.Value &lt;&gt; \"\") Or _\n   (ComboBox2.Value &lt;&gt; \"\" And ComboBox3.Value &lt;&gt; \"\") Or _ \n   (RB.Value &lt;&gt; \"\" And MFC.Value &lt;&gt; \"\") Or _\n   (MCC.Value &lt;&gt; \"\" And LB.Value &lt;&gt; \"\") Or _  \n   (TB.Value &lt;&gt; \"\" And BB.Value &lt;&gt; \"\") Then\n        ret = False\n\n    Else\n        ret = True\n\nEnd If\n</code></pre>\n\n<p>If you want to return true if <strong>ANY</strong> two have a value you will need a different approach. Let me know and I can provide that if it is that case.</p>\n\n<p>Make note that an items <code>.Value</code> property may differ from its <code>.Text</code> property.\n<a href=\"https://stackoverflow.com/questions/17359835/what-is-the-difference-between-text-value-and-value2\">What is the difference between .text, .value, and .value2?</a></p>\n"}, {"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1445448818, "creation_date": 1445448818, "answer_id": 33265722, "question_id": 33265022, "link": "https://stackoverflow.com/questions/33265022/vba-function-for-checking-empty-combobox-or-textbox-with-complex-condition/33265722#33265722", "title": "VBA function for checking empty combobox or textbox with complex condition", "body": "<p>I made the assumption from what you wrote that you would like to say (in pseudo code): </p>\n\n<blockquote>\n  <p>If (TextBox1 and ComboBox1 have values) <strong>OR</strong> (AAX and AAY have\n  values) <strong>AND</strong> all the rest of the boxes have values then return\n  True, otherwise return False.</p>\n</blockquote>\n\n<p>This code will get you there:</p>\n\n<pre><code>Function validate() As Boolean\n\n    Dim ret As Boolean\n\n    If (Len(TextBox1.Value) &lt;&gt; 0 And Len(ComboBox1.Value) &lt;&gt; 0) _\n        Or (Len(AAX.Value) &lt;&gt; 0 And Len(AAY.Value) &lt;&gt; 0) _\n        And Len(ComboBox2.Value) &lt;&gt; 0 And Len(ComboBox3.Value) &lt;&gt; 0 _\n        And Len(RB.Value) &lt;&gt; 0 And Len(MFC.Value) = 0 _\n        And Len(MCC.Value) &lt;&gt; 0 And Len(LB.Value) &lt;&gt; 0 _\n        And Len(TB.Value) &lt;&gt; 0 And Len(BB.Value) &lt;&gt; 0 _\n        And Len(ComboBox4.Value) &lt;&gt; 0 Then\n\n        ret = True\n\n    Else\n\n        ret = False\n\n    End If\n\n    validate = ret\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5399330, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101806288091178/picture?type=large", "display_name": "Josh Linden Levy", "link": "https://stackoverflow.com/users/5399330/josh-linden-levy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2201, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1445448818, "creation_date": 1445446411, "last_edit_date": 1531164843, "question_id": 33265022, "link": "https://stackoverflow.com/questions/33265022/vba-function-for-checking-empty-combobox-or-textbox-with-complex-condition", "title": "VBA function for checking empty combobox or textbox with complex condition", "body": "<p>This is my first time asking a question here, so I hope I am not missing or ignoring any of the posting rules. </p>\n\n<p>Here is my qustion: I have a function that checks through a series of entry boxes, in this case comboboxes and textboxes to see that the user has entered a value. Basically it checks <code>If (TextBox.value &amp; \"\") = \"\"</code> and returns False if it finds any of them.</p>\n\n<p>I would like to modify this code so that it returns true if I have values in Textbox1 and Combobox1, or if I have values in  AAX and AAY. I only need two of the four to make my calculation. I've tried replacing the Or functions with And functions but it doesn't seem to change the functionality of the code.</p>\n\n<p>Thanks in advance for any help!</p>\n\n<p>Code for the function:</p>\n\n<pre><code>Function validate() As Boolean\n\n    Dim ret As Boolean\n\n    If (TextBox1.Value &amp; \"\") = \"\" Or (ComboBox1.Value &amp; \"\") = \"\" Or (AAX.Value &amp; \"\") = \"\" Or (AAY.Value &amp; \"\") = \"\" Or (ComboBox2.Value &amp; \"\") = \"\" _\n        Or (ComboBox3.Value &amp; \"\") = \"\" Or (RB.Value &amp; \"\") = \"\" Or (MFC.Value &amp; \"\") = \"\" Or (MCC.Value &amp; \"\") = \"\" Or (LB.Value &amp; \"\") = \"\" _\n        Or (TB.Value &amp; \"\") = \"\" Or (BB.Value &amp; \"\") = \"\" Or (ComboBox4.Value &amp; \"\") = \"\" _\n        Then\n            ret = False\n\n        Else\n            ret = True\n\n    End If\n\n    validate = ret\n\nEnd Function\n</code></pre>\n\n<p>Code that calls the function:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    If Not validate() Then\n       MsgBox \"Fill all required fields, please\"\n       Cancel = True\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2003"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1445445788, "post_id": 33264758, "comment_id": 54330774, "body": "Multi-step operation usually points to loading a value into a variable that can&#39;t take it.  But I see no issue with what you are doing.  It works for me.  Maybe problem is specific to the 2003 version of Access."}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1445445848, "post_id": 33264758, "comment_id": 54330809, "body": "Try doing all the replaces on the text variable. Then at the end set XMLValueDecode = Text"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1445446121, "post_id": 33264758, "comment_id": 54330992, "body": "Does <code>Call Prompt()</code> compile in Access 2003 VBA?  Access 2010 complains <i>&quot;Sub or Function not defined&quot;</i>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1445446483, "post_id": 33264758, "comment_id": 54331187, "body": "How are you calling the function?"}, {"owner": {"reputation": 6712, "user_id": 122139, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e24cd8afa32a0e16b095a5348f6b772b?s=128&d=identicon&r=PG", "display_name": "Smandoli", "link": "https://stackoverflow.com/users/122139/smandoli"}, "edited": false, "score": 0, "creation_date": 1445446863, "post_id": 33264758, "comment_id": 54331404, "body": "There is plenty to do reducing and simplifying this function in order to isolate the error.  Also, setting <code>.Value</code> from a function while also trying to apply <code>RTrim()</code> is definitely out of order."}, {"owner": {"reputation": 1564, "user_id": 3250318, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/EFWrn.jpg?s=128&g=1", "display_name": "Adam Heeg", "link": "https://stackoverflow.com/users/3250318/adam-heeg"}, "edited": false, "score": 0, "creation_date": 1445447776, "post_id": 33264758, "comment_id": 54331922, "body": "I added the calling code and edited the Trim out of the assignment line.  I&#39;m still getting the same error."}, {"owner": {"reputation": 9587, "user_id": 747965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2fzty.jpg?s=128&g=1", "display_name": "Glenn Ferrie", "link": "https://stackoverflow.com/users/747965/glenn-ferrie"}, "edited": false, "score": 0, "creation_date": 1445448332, "post_id": 33264758, "comment_id": 54332235, "body": "I&#39;ve seen this error when the value you are trying to save into a field is longer than the size the field can contain, or if there is a data type mismatch, but likely it is length."}, {"owner": {"reputation": 6712, "user_id": 122139, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e24cd8afa32a0e16b095a5348f6b772b?s=128&d=identicon&r=PG", "display_name": "Smandoli", "link": "https://stackoverflow.com/users/122139/smandoli"}, "edited": false, "score": 0, "creation_date": 1445448499, "post_id": 33264758, "comment_id": 54332334, "body": "To test that, use <code>Debug.Print XMLValueDecode(CurNodeValue)</code> instead of assigning to the field.  Then check the result in the Immediate Window."}, {"owner": {"reputation": 1564, "user_id": 3250318, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/EFWrn.jpg?s=128&g=1", "display_name": "Adam Heeg", "link": "https://stackoverflow.com/users/3250318/adam-heeg"}, "edited": false, "score": 0, "creation_date": 1445448673, "post_id": 33264758, "comment_id": 54332432, "body": "input string has a length of 462.  The field is declared with a size of 500.  How about adVarChar?  I&#39;ll google that now."}, {"owner": {"reputation": 1564, "user_id": 3250318, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/EFWrn.jpg?s=128&g=1", "display_name": "Adam Heeg", "link": "https://stackoverflow.com/users/3250318/adam-heeg"}, "edited": false, "score": 0, "creation_date": 1445449266, "post_id": 33264758, "comment_id": 54332804, "body": "with an empty , , it was an error.  With 500 back in it (and 1000) and the adLongVarChar it threw the same error."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1445449834, "post_id": 33264758, "comment_id": 54333146, "body": "Sorry, that was a wild guess and it was wrong.  But I&#39;ve now tested your original <code>ADORecordset.Fields.Append</code>, and mine later accepts a 462 character string without complaint.  We may need to see more context showing how you create and use that recordset."}, {"owner": {"reputation": 1564, "user_id": 3250318, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/EFWrn.jpg?s=128&g=1", "display_name": "Adam Heeg", "link": "https://stackoverflow.com/users/3250318/adam-heeg"}, "edited": false, "score": 0, "creation_date": 1445452751, "post_id": 33264758, "comment_id": 54334756, "body": "my only guess is the ? is a problem.  I changed the type to a adVarWChar  based on this post: <a href=\"http://stackoverflow.com/questions/536358/are-there-restricted-characters-in-ado-varchars\" title=\"are there restricted characters in ado varchars\">stackoverflow.com/questions/536358/&hellip;</a>  I don&#39;t know why that worked, but it seems to have.  If you know why please post and I&#39;ll mark it as answered."}], "answers": [{"comments": [{"owner": {"reputation": 26, "user_id": 4170766, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/annbU.jpg?s=128&g=1", "display_name": "phantombread", "link": "https://stackoverflow.com/users/4170766/phantombread"}, "edited": false, "score": 0, "creation_date": 1445454415, "post_id": 33267193, "comment_id": 54335729, "body": "If that first thing is happening, you should be able to assign it by using <code>CStr(curNodeName)</code> in both the append and assignment line."}, {"owner": {"reputation": 26, "user_id": 4170766, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/annbU.jpg?s=128&g=1", "display_name": "phantombread", "link": "https://stackoverflow.com/users/4170766/phantombread"}, "edited": false, "score": 0, "creation_date": 1445455348, "post_id": 33267193, "comment_id": 54336225, "body": "It strikes me that it shouldn&#39;t really be possible because one of the rules of XML is that no tag can start with a number. Still, if it&#39;s typed as variant or something, an explicit conversion might work out for you."}, {"owner": {"reputation": 1564, "user_id": 3250318, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/EFWrn.jpg?s=128&g=1", "display_name": "Adam Heeg", "link": "https://stackoverflow.com/users/3250318/adam-heeg"}, "edited": false, "score": 0, "creation_date": 1445458778, "post_id": 33267193, "comment_id": 54338014, "body": "CurNodeName value is SubText.  There must be some critical difference between adVarChar type and adVarWChar  that the text being set responded differently to."}], "tags": [], "owner": {"reputation": 26, "user_id": 4170766, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/annbU.jpg?s=128&g=1", "display_name": "phantombread", "link": "https://stackoverflow.com/users/4170766/phantombread"}, "is_accepted": false, "score": 0, "last_activity_date": 1445454531, "last_edit_date": 1445454531, "creation_date": 1445454102, "answer_id": 33267193, "question_id": 33264758, "link": "https://stackoverflow.com/questions/33264758/why-is-assigning-a-value-to-a-field-in-adorecordset-throwing-an-error/33267193#33267193", "title": "Why is Assigning a value to a field in ADORecordset throwing an error?", "body": "<p>Have you checked <code>curNodeName</code> for type? If you've passed a numerical type to append, it might be converting it to string implicitly when naming the field to avoid indexing errors, if that's the case, (and you are inadvertently trying to assign that string to the value of a field with an index that is not currently in the collection,) you might be throwing that multi error because you'd be trying to assign a string of a length longer than the default length to a field with an index way outside the current collection (either of which error alone might throw a specific exception, but depending on the way the parser is handling those terms, it might evaluate each side of the assignment for validity before trying to assign an error code.)</p>\n\n<p>What I'm wondering is if you've debug.printed (or just counted, depending on collection size) the field names and indices as matched pairs and tried assigning the string to your field by index instead of name?</p>\n"}, {"tags": [], "owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "is_accepted": true, "score": 2, "last_activity_date": 1445732215, "creation_date": 1445732215, "answer_id": 33324763, "question_id": 33264758, "link": "https://stackoverflow.com/questions/33264758/why-is-assigning-a-value-to-a-field-in-adorecordset-throwing-an-error/33324763#33324763", "title": "Why is Assigning a value to a field in ADORecordset throwing an error?", "body": "<p><em>(From a comment to another answer:)</em></p>\n\n<blockquote>\n  <p>There must be some critical difference between adVarChar type and adVarWChar that the text being set responded differently to.</p>\n</blockquote>\n\n<p>It was many versions ago (Access 2000, and the release of Jet 4.0) that <code>Text</code> and <code>Memo</code> fields in Access were upgraded to handle Unicode. From that point forward, <code>Text</code> fields and parameters needed to be referenced as <code>adVarWChar</code> (with a maximum length of 255), while <code>Memo</code> fields and parameters needed to be referenced as <code>adVarWChar</code> or <code>adLongVarWChar</code> (with a theoretical size limit of approximately 1 billion characters). </p>\n\n<p>It is unclear why the code in the question would work for some strings and not others, but certainly using the correct (\"W\") data type would be a prerequisite.</p>\n"}], "owner": {"reputation": 1564, "user_id": 3250318, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/EFWrn.jpg?s=128&g=1", "display_name": "Adam Heeg", "link": "https://stackoverflow.com/users/3250318/adam-heeg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 33324763, "answer_count": 2, "score": 0, "last_activity_date": 1594643379, "creation_date": 1445445510, "last_edit_date": 1594643379, "question_id": 33264758, "link": "https://stackoverflow.com/questions/33264758/why-is-assigning-a-value-to-a-field-in-adorecordset-throwing-an-error", "title": "Why is Assigning a value to a field in ADORecordset throwing an error?", "body": "<p>So i'm testing sample code and I pasted some online text into a field and i'm getting an error and I have no clue why.  Here is the entire method which is throwing the error:</p>\n\n<blockquote>\n  <p>EDIT the error is coming from the assignment.  However, there is no\n  error thrown on any number of other input strings.</p>\n</blockquote>\n\n<pre><code>   CurNodeName = RTrim(CurNodeName)\n\n   ADORecordset.Fields.Append CurNodeName, adVarChar, 500, adFldMayBeNull\n\n    tempString = XMLValueDecode(CurNodeValue)\n    ADORecordset.Fields(CurNodeName).Value = tempString\n</code></pre>\n\n<p>...</p>\n\n<p>Here is the string which is being passed into the method:</p>\n\n<blockquote>\n  <p>Most of the methods of the DoCmd object have arguments ? some are\n  required, while others are optional. If you omit optional arguments,\n  the arguments assume the default values for the particular method. For\n  example, the OpenForm method uses seven arguments, but only the first\n  argument, FormName, is required. The following example shows how you\n  can open the Employees form in the current database. Only employees\n  with the title Sales Representative are included.</p>\n</blockquote>\n\n<p>Here is the exact error description:</p>\n\n<blockquote>\n  <p>Multiple-step operation generated errors. Check each status value.</p>\n</blockquote>\n\n<p>That is the whole story, and i just don't understand it.  Can you tell me why this error is happening?</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "edited": false, "score": 0, "creation_date": 1445450498, "post_id": 33264725, "comment_id": 54333515, "body": "<a href=\"http://stackoverflow.com/questions/31075100/catching-error-message-from-sql-server-in-vba-in-excel\">This question</a> is sort of along the same lines."}, {"owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "edited": false, "score": 0, "creation_date": 1445450570, "post_id": 33264725, "comment_id": 54333559, "body": "Also, take a look <a href=\"http://www.sqlservercentral.com/Forums/Topic300275-131-1.aspx\" rel=\"nofollow noreferrer\">here</a> as well."}], "owner": {"reputation": 45, "user_id": 1955977, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/021eefcffdf6eaa507a56b4245e3be4d?s=128&d=identicon&r=PG&f=1", "display_name": "AmberHart28", "link": "https://stackoverflow.com/users/1955977/amberhart28"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1445445370, "creation_date": 1445445370, "question_id": 33264725, "link": "https://stackoverflow.com/questions/33264725/return-messages-from-sql-file-run-from-ms-access-vba", "title": "Return messages from .sql file run from MS Access VBA", "body": "<p>We have an access application, which runs SQL statements using something like this snippet below. Does anyone know if it is possible to retrieve anything that comes up in the messages tab, if the script was run straight in SQL Management Studio? So, print statements and errors?</p>\n\n<pre><code>DoCmd.SetWarnings False\nDoCmd.OpenQuery \"ScriptHere\"\nDoCmd.SetWarnings True\n</code></pre>\n"}, {"tags": ["arrays", "vba", "text-files"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1445450609, "post_id": 33264662, "comment_id": 54333575, "body": "Where does the error occur? We need more information. Have you tried debugging it yourself yet?"}, {"owner": {"reputation": 64, "user_id": 5402899, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b401b1a00867ef32c79e5d8c3006baff?s=128&d=identicon&r=PG&f=1", "display_name": "JoeJoe", "link": "https://stackoverflow.com/users/5402899/joejoe"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1445451546, "post_id": 33264662, "comment_id": 54334115, "body": "Error occurs in this line: <b>Preserve DataArray(Rw, Cl)  &#39;&lt;-- here is the alert of Run-Time Error 9</b> and yes,. I did try to solve this but I also cannot reach it."}], "answers": [{"tags": [], "owner": {"reputation": 30756, "user_id": 5389997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d227900a17ca5c34bad6d2b27122c7f?s=128&d=identicon&r=PG&f=1", "display_name": "Shadow", "link": "https://stackoverflow.com/users/5389997/shadow"}, "is_accepted": false, "score": 0, "last_activity_date": 1445452012, "creation_date": 1445452012, "answer_id": 33266605, "question_id": 33264662, "link": "https://stackoverflow.com/questions/33264662/storing-validated-data-extracted-from-text-file-into-variable/33266605#33266605", "title": "Storing validated data extracted from text file into variable", "body": "<p>The problem is with redim preserve, since it can only change the bounds of the last dimension, not the first, see <a href=\"https://msdn.microsoft.com/EN-US/library/office/gg251578.aspx\" rel=\"nofollow\">redim - VBA language reference</a>.</p>\n\n<p>The other problem you may have later if the number of elements within a row is different row by row and you resize the upper bound of the 2nd dimension of the actual row to a number, that is less than the element count in the previous rows, since you will drop values.</p>\n\n<p>I would use a 1 dimansional dynamic array to host the data, where each element would be a dynamic array itself.</p>\n\n<pre><code>Dim DataArray()\n...\nReDim DataArray(Ubound(LineArray))\n\nFor x = LBound(LineArray) To UBound(LineArray)\n  If Module1.TEXTCOUNTER(LineArray(x), \":\") &gt;= 30 Then\n    'split up line of text by delimiter\n    DataArray(x) = Split(LineArray(x), Delimiter)\n  End If\nNext x\n</code></pre>\n\n<p>To access an element use DataArray(x)(y) syntax, not DataArray(x,y).</p>\n"}], "owner": {"reputation": 64, "user_id": 5402899, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b401b1a00867ef32c79e5d8c3006baff?s=128&d=identicon&r=PG&f=1", "display_name": "JoeJoe", "link": "https://stackoverflow.com/users/5402899/joejoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1445452012, "creation_date": 1445445164, "question_id": 33264662, "link": "https://stackoverflow.com/questions/33264662/storing-validated-data-extracted-from-text-file-into-variable", "title": "Storing validated data extracted from text file into variable", "body": "<p>I'm trying to store specific lines from a text file into a variable first validating each line and then splitting each valid line into columns in a bi-dimensional dynamic array . I have this code:</p>\n\n<pre><code>Option Explicit\nSub GetMaterialFromText()\nDim Delimiter As String\nDim TextFile As Integer\nDim FilePath As String\nDim FileContent As String\nDim LineArray() As String\nDim DataArray() As String\nDim TempArray() As String\nDim Rw As Integer, Cl As Integer, x As Integer, y As Integer\n'inputs\nDelimiter = \":\"\nFilePath = \"C:\\Users\\jlopez\\Desktop\\2018\\material.txt\"\nRw = 0\n'open the text file in a read state\nTextFile = FreeFile\nOpen FilePath For Input As TextFile\n'store file content iside a variable\n FileContent = Input(LOF(TextFile), TextFile)\n 'close text file\nClose TextFile\n'separate out lines of data\nLineArray() = Split(FileContent, vbCrLf)\n\n'read data into an array variable\nFor x = LBound(LineArray) To UBound(LineArray)\nIf Module1.TEXTCOUNTER(LineArray(x), \":\") &gt;= 30 Then\n'split up line of text by delimiter\nTempArray = Split(LineArray(x), Delimiter)\n'determine how many columns are needed\nCl = UBound(TempArray)\n're-adjust array bundaries\nReDim Preserve DataArray(Rw, Cl)  '&lt;-- here is the alert of Run-Time Error 9\n'load line of data into array variable\nFor y = LBound(TempArray) To UBound(TempArray)\nDataArray(Rw, y) = TempArray(y)\nNext y\nEnd If\n'new line\nRw = Rw + 1\nNext x\n\nEnd Sub\n</code></pre>\n\n<p>UDF TEXTCOUNTER code is this:</p>\n\n<pre><code>Function TEXTCOUNTER(Text As String, ToCount As String) As Integer\nApplication.Volatile\nWith Application.WorksheetFunction\nTEXTCOUNTER = Len(Text) - Len(.Substitute(Text, ToCount, \"\"))\nEnd With\nEnd Function\n</code></pre>\n\n<p>but I received a Run-Time error '9', I think it's caused by the dynamic arrays but I don't know how to make it run correctly, can somebody help me?</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1445444965, "post_id": 33264488, "comment_id": 54330231, "body": "Why do you have <code>OutApp</code> and <code>myOlApp</code>?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1445445089, "post_id": 33264488, "comment_id": 54330322, "body": "I may be wrong but don&#39;t you need to use the <code>Set</code> with the line on which you are getting the error?"}, {"owner": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1445445100, "post_id": 33264488, "comment_id": 54330332, "body": "@DavidZemens I corrected that, but that&#39;s not the reason for the error. I forgot to edit when I posted but the error still remains. Thanks for pointing out though."}, {"owner": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1445445176, "post_id": 33264488, "comment_id": 54330383, "body": "@ScottCraner Thanks!. I totally made a fool of myself not using the Set for the object."}], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 1, "last_activity_date": 1445445060, "creation_date": 1445445060, "answer_id": 33264630, "question_id": 33264488, "link": "https://stackoverflow.com/questions/33264488/error-in-sending-email-through-vba/33264630#33264630", "title": "Error in Sending Email through VBA", "body": "<p><code>composeitem</code> is an object, so you need to use the <code>Set</code> keyword when assigning to it.</p>\n\n<p>I also note you have redundantly included two object variables for the Outlook Application.  Fix it:</p>\n\n<pre><code>Dim myOlApp As New Outlook.Application\nDim composeitem As Outlook.MailItem\n\n'  This isn't needed: --&gt; Set OutApp = CreateObject(\"Outlook.Application\")\nSet composeitem = myOlApp.CreateItem(0)\nWith composeitem\n    .To = \"abc.xyz@gmail.com\"\n    .Subject = \"ABC meeting\"\n    .Body = \"Meeting at 5\"\n    .Send   \n    '.Display  you can't display a message that's already been sent\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 420, "user_id": 5423764, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/daf8ba645547240462b5036013c2a682?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Weber", "link": "https://stackoverflow.com/users/5423764/alex-weber"}, "is_accepted": true, "score": 3, "last_activity_date": 1445445108, "creation_date": 1445445108, "answer_id": 33264648, "question_id": 33264488, "link": "https://stackoverflow.com/questions/33264488/error-in-sending-email-through-vba/33264648#33264648", "title": "Error in Sending Email through VBA", "body": "<p>Looks like you're missing a <strong>set</strong> in your <strong>CreateItem(0)</strong> line. Change that line to the following:</p>\n\n<pre><code>Set composeitem = myOlApp.CreateItem(0)\n</code></pre>\n\n<p>Additionally, your <strong>.Display</strong> will throw an error because the email message is deleted after you run the <strong>.Send</strong> command. I would suggest moving the lines around to prevent this.</p>\n"}], "owner": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 493, "favorite_count": 0, "accepted_answer_id": 33264648, "answer_count": 2, "score": 1, "last_activity_date": 1593003656, "creation_date": 1445444629, "last_edit_date": 1593003656, "question_id": 33264488, "link": "https://stackoverflow.com/questions/33264488/error-in-sending-email-through-vba", "title": "Error in Sending Email through VBA", "body": "<pre><code>Dim myOlApp As New Outlook.Application\nDim composeitem As Outlook.MailItem\n\nSet myOlApp = CreateObject(\"Outlook.Application\")\ncomposeitem = myOlApp.CreateItem(0)\nWith composeitem\n    .To = \"abc.xyz@gmail.com\"\n    .Subject = \"ABC meeting\"\n    .Body = \"Meeting at 5\"\n    .Send   \n    .Display\nEnd With\n</code></pre>\n\n<p>The <strong>error</strong> VBA is throwing is that <strong>\" Object Variable or With block Variable not Set\"</strong>  I have marked all the required references and get error on the <strong>CreateItem(0)</strong> line. Thanks in advance.</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 5471665, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/661183577357600/picture?type=large", "display_name": "Ralf", "link": "https://stackoverflow.com/users/5471665/ralf"}, "edited": false, "score": 0, "creation_date": 1445508272, "post_id": 33268725, "comment_id": 54357226, "body": "Thanks a lot! After some changes and tweeks it does precisely what I am after. You definitely pushed me in the right direction!"}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": true, "score": 0, "last_activity_date": 1445459689, "creation_date": 1445459689, "answer_id": 33268725, "question_id": 33264390, "link": "https://stackoverflow.com/questions/33264390/outlook-vba-move-mail-in-subfolder-which-hods-mail-of-same-subject/33268725#33268725", "title": "Outlook VBA move mail in subfolder which hods mail of same subject", "body": "<p>You can use the <a href=\"https://msdn.microsoft.com/en-us/library/bb219884.aspx\" rel=\"nofollow\">AdvancedSearch</a> method of the Application class which performs a search based on a specified DAV Searching and Locating (DASL) search string. You can read more about that method in the <a href=\"https://www.add-in-express.com/creating-addins-blog/2012/05/31/outlook-search-csharp-vbnet/\" rel=\"nofollow\">Advanced search in Outlook programmatically: C#, VB.NET</a> article. So, you can find items with the same subject and then get their <code>Parent</code> property value which stands for the folder where they are stored.  </p>\n\n<pre><code> Public blnSearchComp As Boolean\n\n Private Sub Application_AdvancedSearchComplete(ByVal SearchObject As Search)\n  Debug.Print \"The AdvancedSearchComplete Event fired\"\n  If SearchObject.Tag = \"Test\" Then\n    m_SearchComplete = True\n  End If\n End Sub\n\n Sub TestAdvancedSearchComplete()\n  Dim sch As Outlook.Search\n  Dim rsts As Outlook.Results\n  Dim i As Integer\n  blnSearchComp = False\n  Const strF As String = \"urn:schemas:mailheader:subject = 'Test'\"\n  Const strS As String = \"Inbox\"   \n  Set sch = Application.AdvancedSearch(strS, strF, \u201cTest\u201d) \n  While blnSearchComp = False\n    DoEvents\n  Wend \n  Set rsts = sch.Results\n  For i = 1 To rsts.Count\n    Debug.Print rsts.Item(i).SenderName\n  Next\n End Sub\n</code></pre>\n\n<blockquote>\n  <p>Is there a specific smart way to do the same on other events like for example \"SentMails\"?</p>\n</blockquote>\n\n<p>You may consider handling the ItemSend event of the Application class which is fired whenever an Microsoft Outlook item is sent, either by the user through an Inspector (before the inspector is closed, but after the user clicks the Send button) or when the Send method for an Outlook item. In the event handler you can set the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff868473.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">SaveSentMessageFolder</a> property which allows to set a Folder object that represents the folder in which a copy of the e-mail message will be saved after being sent.</p>\n"}], "owner": {"reputation": 9, "user_id": 5471665, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/661183577357600/picture?type=large", "display_name": "Ralf", "link": "https://stackoverflow.com/users/5471665/ralf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "accepted_answer_id": 33268725, "answer_count": 1, "score": 0, "last_activity_date": 1445459689, "creation_date": 1445444321, "question_id": 33264390, "link": "https://stackoverflow.com/questions/33264390/outlook-vba-move-mail-in-subfolder-which-hods-mail-of-same-subject", "title": "Outlook VBA move mail in subfolder which hods mail of same subject", "body": "<p>I'd like to do the following:</p>\n\n<p>On the event of receiving a new mail the subject of the mail should be checked and if the same subject exists already in any subfolder the mail shall be moved to that same subfolder. In case the same mail can't be found it shall remain in the normal inbox folder. \nThe target folder as such has no logical connection to the mail, so it is not called like the mail or the mail sender or something like that. It is only the folder which holds one or mails with the same subject.</p>\n\n<p>I managed - by browsing through this forum - to identify the event, the subject of the mail and to perform the actual move. \nWhat I did not manage is:</p>\n\n<p><i>1. to create a search logic to find already existing mails with the same   subject in any folder </i></p>\n\n<p><i>2.to return the found folder to use it as the target destination.</i></p>\n\n<p>This is how it looks up till now and it manages to show a message...</p>\n\n<pre><code>Private WithEvents Items As Outlook.Items\n\nPrivate Sub Application_Startup()\n     Dim olApp As Outlook.Application\n     Dim objNS As Outlook.NameSpace\n     Set olApp = Outlook.Application\n     Set objNS = olApp.GetNamespace(\"MAPI\")\n     Set Items = objNS.GetDefaultFolder(olFolderInbox).Items\nEnd Sub\n\nPrivate Sub Items_ItemAdd(ByVal Item As Object)\n    On Error GoTo ErrorHandler\n    Dim Msg As Outlook.MailItem\n    Dim MoveToFolder As Outlook.MAPIFolder\n    If TypeName(Item) = \"MailItem\" Then\n     Set Msg = Item\n\n     MsgBox \"Here the folder must be found for '\" &amp; Msg.Subject &amp; \"'.\"\n\n     'Msg.Move MoveToFolder\n    End If\n    ProgramExit:\n    Exit Sub\nErrorHandler:\n  MsgBox Err.Number &amp; \" - \" &amp; Err.Description\n  Resume ProgramExit\nEnd Sub\n</code></pre>\n\n<p>On top: Is there a specific smart way to do the same on other events like for example \"SentMails\"?</p>\n\n<p>Thanks a lot for any support.</p>\n\n<p>Ralf</p>\n"}, {"tags": ["vba", "unicode", "encoding", "utf-8", "ms-word"], "comments": [{"owner": {"reputation": 378, "user_id": 4931852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6f0fb9da93c595d1bc467fe75caf101?s=128&d=identicon&r=PG", "display_name": "Julian Moore", "link": "https://stackoverflow.com/users/4931852/julian-moore"}, "reply_to_user": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1445449523, "post_id": 33264314, "comment_id": 54332957, "body": "@Deduplicator  Explanation of the edit would be helpful.   And for whoever it may have been, a down-vote without comment is at best discourteous; it is also not at all helpful. Please explain yourself or undo the vote."}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1445450234, "post_id": 33264314, "comment_id": 54333365, "body": "When the summary is that obvious, I normally don&#39;t write it, but ok, here it is: &quot;Corrected tags, removed fluff&quot;."}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1445450617, "post_id": 33264314, "comment_id": 54333583, "body": "Regarding discourtesy on the part of the downvoter: If he voted according to the posts value (as he sees it), that&#39;s commendable. And if he didn&#39;t see enough use in trying to help you improve your post, that&#39;s acceptable though regrettable, not discourteousy involved. Just because he helps everyone by evaluating posts does not mean he is in any way obligated to help even more, or help you personally (go on <a href=\"https://meta.stackoverflow.com\">Meta Stack Overflow</a> if you want to debate that, but <i>please</i> first research the topic). (As an aside, accusing him of discourtesy is <i>very</i> discourteous.)"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1445451125, "post_id": 33264314, "comment_id": 54333864, "body": "I&#39;m not sure if this is the problem, especially since you don&#39;t explain how special symbols are inserted in the text, but... Many of the symbols Word inserts are not Unicode, but &quot;normal&quot; characgter codes formatted with a different font, such as WingDings. You need to make sure the symbols giving you problems are truly unicode characters for that symbol."}, {"owner": {"reputation": 378, "user_id": 4931852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6f0fb9da93c595d1bc467fe75caf101?s=128&d=identicon&r=PG", "display_name": "Julian Moore", "link": "https://stackoverflow.com/users/4931852/julian-moore"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1445451414, "post_id": 33264314, "comment_id": 54334038, "body": "@CindyMeister Thanks for considering the question. I believe my comment about double-checking by using the Word Unicode insertion facility addresses your point. I will also edit the question to clarify the insertion method used."}, {"owner": {"reputation": 378, "user_id": 4931852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6f0fb9da93c595d1bc467fe75caf101?s=128&d=identicon&r=PG", "display_name": "Julian Moore", "link": "https://stackoverflow.com/users/4931852/julian-moore"}, "reply_to_user": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1445451649, "post_id": 33264314, "comment_id": 54334159, "body": "@Deduplicator Yep, sure could have a good argument about the natures of help and courtesy, but I didn&#39;t come here for a good argument ;)"}], "answers": [{"comments": [{"owner": {"reputation": 378, "user_id": 4931852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6f0fb9da93c595d1bc467fe75caf101?s=128&d=identicon&r=PG", "display_name": "Julian Moore", "link": "https://stackoverflow.com/users/4931852/julian-moore"}, "edited": false, "score": 0, "creation_date": 1445505421, "post_id": 33271529, "comment_id": 54355370, "body": "Thank you for that. I had also recorded a macro (which is where I found the 65001 encoding option too, I think) and compared it to my written version, which was effectively the same apart from the encoding value (msoEncodingUTF8). I am glad your Chinese text is OK, but I also had other off-code page text save correctly so that is not necessarily inconsistent with the same issue. Can you get a TM symbol in your text file using the same approach?"}, {"owner": {"reputation": 131156, "user_id": 235698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjvlE.png?s=128&g=1", "display_name": "Mark Tolonen", "link": "https://stackoverflow.com/users/235698/mark-tolonen"}, "reply_to_user": {"reputation": 378, "user_id": 4931852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6f0fb9da93c595d1bc467fe75caf101?s=128&d=identicon&r=PG", "display_name": "Julian Moore", "link": "https://stackoverflow.com/users/4931852/julian-moore"}, "edited": false, "score": 0, "creation_date": 1445524939, "post_id": 33271529, "comment_id": 54367704, "body": "@JulianMoore, Yes, if I used the original long macro.  It turns out you also need <code>AllowSubstitutions:=False</code>.  Updated answer."}, {"owner": {"reputation": 378, "user_id": 4931852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6f0fb9da93c595d1bc467fe75caf101?s=128&d=identicon&r=PG", "display_name": "Julian Moore", "link": "https://stackoverflow.com/users/4931852/julian-moore"}, "edited": false, "score": 0, "creation_date": 1445594732, "post_id": 33271529, "comment_id": 54398363, "body": "Thank you! It never occurred to me to consider that. I have confirmed that it does indeed work the same for me. It&#39;s a very strange labelling &amp; prioritisation of settings: since UTF8 supports the character, why would I need to &quot;allow&quot; substitutions?? Regardless, the issue is now resolved - thanks again,"}], "tags": [], "owner": {"reputation": 131156, "user_id": 235698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjvlE.png?s=128&g=1", "display_name": "Mark Tolonen", "link": "https://stackoverflow.com/users/235698/mark-tolonen"}, "is_accepted": true, "score": 1, "last_activity_date": 1445524968, "last_edit_date": 1445524968, "creation_date": 1445473916, "answer_id": 33271529, "question_id": 33264314, "link": "https://stackoverflow.com/questions/33264314/utf8-encoding-failure-writing-text-file-from-word-vba/33271529#33271529", "title": "UTF8 encoding failure writing text file from Word VBA", "body": "<p>I recorded a macro to save some some Chinese text that is clearly unsupported in the default code page on my system, which was <code>Windows-1252</code>.  I saved in <code>.txt</code> format and it asked for the encoding, which I selected <code>UTF-8</code>.  Here is the result:</p>\n\n<pre><code>ActiveDocument.SaveAs2 FileName:=\"The.txt\", FileFormat:=wdFormatText, _\n    LockComments:=False, Password:=\"\", AddToRecentFiles:=True, WritePassword _\n    :=\"\", ReadOnlyRecommended:=False, EmbedTrueTypeFonts:=False, _\n    SaveNativePictureFormat:=False, SaveFormsData:=False, SaveAsAOCELetter:= _\n    False, Encoding:=65001, InsertLineBreaks:=False, AllowSubstitutions:= _\n    False, LineEnding:=wdCRLF, CompatibilityMode:=0\n</code></pre>\n\n<p>It did save the file correctly in UTF-8.  I edited the macro down to the following minimal code and it still worked.</p>\n\n<pre><code>ActiveDocument.SaveAs2 FileName:=\"test.txt\", FileFormat:=wdFormatText, _\n    AllowSubstitutions:=False, Encoding:=65001\n</code></pre>\n"}], "owner": {"reputation": 378, "user_id": 4931852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6f0fb9da93c595d1bc467fe75caf101?s=128&d=identicon&r=PG", "display_name": "Julian Moore", "link": "https://stackoverflow.com/users/4931852/julian-moore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1404, "favorite_count": 0, "accepted_answer_id": 33271529, "answer_count": 1, "score": 0, "last_activity_date": 1445524968, "creation_date": 1445444065, "last_edit_date": 1445505132, "question_id": 33264314, "link": "https://stackoverflow.com/questions/33264314/utf8-encoding-failure-writing-text-file-from-word-vba", "title": "UTF8 encoding failure writing text file from Word VBA", "body": "<p>I am using MS Word to edit text that I convert to structured HTML using VBA.</p>\n\n<p>The text is written out using document.saveas2 with encoding:=msoEncodingUTF8.</p>\n\n<p>Today I found that the Trademark Symbol [Edit: inserted using the Insert Symbol capability; Insert Tab, Symbols group, Symbol button] was appearing in the text files as \"(tm)\".</p>\n\n<p>Having discovered that encoding:=65001 should also produce UTF8, I tried it - and in one case it seemed to work, but the result was not reproducible.</p>\n\n<p>I also learned that being older than Unicode, Word might use a private code page for certain characters, so I also entered the unicode code directly followed by alt-X; the TM symbol appeared correctly but still failed to be written to the text file.</p>\n\n<p>Whilst I have been able to work around the problem by replacing TM with the HTML \"&amp; trade ;\" (extra spaces to prevent it getting rendered as the symbol!), I am concerned about the potential for other encoding failures.</p>\n\n<p><strong>Can anyone shed any light on the cause(s) of this issue or offer an effective resolution/mitigation?</strong></p>\n\n<p>System config: Word 2010; Windows 7 64 bit.</p>\n"}, {"tags": ["excel", "vba", "for-loop"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1445442593, "post_id": 33263658, "comment_id": 54328765, "body": "Use cells(row,column).address(False,False).  column can be a number."}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1445442625, "post_id": 33263658, "comment_id": 54328787, "body": "You might want to look into creating named ranges.  You can do separate ones or it will allow noncontiguous ranges also."}, {"owner": {"reputation": 957, "user_id": 2820289, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/4eec9f1586150444590497403571d65f?s=128&d=identicon&r=PG&f=1", "display_name": "Helen", "link": "https://stackoverflow.com/users/2820289/helen"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1445505331, "post_id": 33263658, "comment_id": 54355294, "body": "Thank you both for commenting. @ScottCraner I have never heard of this before, but I&#39;ll try and look into it."}], "answers": [{"comments": [{"owner": {"reputation": 957, "user_id": 2820289, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/4eec9f1586150444590497403571d65f?s=128&d=identicon&r=PG&f=1", "display_name": "Helen", "link": "https://stackoverflow.com/users/2820289/helen"}, "edited": false, "score": 0, "creation_date": 1445497214, "post_id": 33264105, "comment_id": 54350715, "body": "Thank you! Very nice! I am completely new to VBA, I just have to ask: Could you explain the syntax: <i>Dim i&amp;, j&amp;, area$, k As Range, r As Range</i> ?"}, {"owner": {"reputation": 957, "user_id": 2820289, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/4eec9f1586150444590497403571d65f?s=128&d=identicon&r=PG&f=1", "display_name": "Helen", "link": "https://stackoverflow.com/users/2820289/helen"}, "edited": false, "score": 0, "creation_date": 1445508432, "post_id": 33264105, "comment_id": 54357317, "body": "One last question, I want to use the range <i>k</i> from your code to protect an area using <i>ActiveSheet.Protection.AllowEditRanges.Add Title:=&quot;protect&quot;, Range:=Range( _        &quot;F7:G8,I7:J8,L7:M8,F10:G11,I10:J11, L10:M11&quot;)</i>, but I cannot seem to replace the string <i>&quot;F7:G8,I7:J8,L7:M8,F10:G11,I10:J11, L10:M11&quot;</i> in the code with k. That is, <i>&quot;Range:=k&quot;</i> does not work. How do I do this?"}, {"owner": {"reputation": 957, "user_id": 2820289, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/4eec9f1586150444590497403571d65f?s=128&d=identicon&r=PG&f=1", "display_name": "Helen", "link": "https://stackoverflow.com/users/2820289/helen"}, "edited": false, "score": 0, "creation_date": 1445517327, "post_id": 33264105, "comment_id": 54362697, "body": "I made a new question <a href=\"http://stackoverflow.com/questions/33281166/vba-protection-alloweditranges-with-dynamic-range\">link</a>"}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": true, "score": 1, "last_activity_date": 1445443496, "creation_date": 1445443496, "answer_id": 33264105, "question_id": 33263658, "link": "https://stackoverflow.com/questions/33263658/marking-an-area-with-a-double-for-loop/33264105#33264105", "title": "Marking an area with a double &#39;For&#39; loop", "body": "<p>Please try this:</p>\n\n<pre><code>Sub ErosRam()\n    Dim i&amp;, j&amp;, area$, k As Range, r As Range\n\n    Const COL_PERIOD = 3\n    Const ROW_PERIOD = 3\n    Const REPS_HORIZONTAL = 3\n    Const REPS_VERTICAL = 2\n\n    Set r = [f7:g8]\n    Set k = r\n\n    For i = 0 To REPS_VERTICAL - 1\n        For j = 0 To REPS_HORIZONTAL - 1\n            Set k = Union(k, r.Offset(i * ROW_PERIOD, j * COL_PERIOD))\n        Next\n    Next\n\n    area = k.Address(0, 0)\n    MsgBox area   \nEnd Sub\n</code></pre>\n\n<p>You can edit the <code>Const</code> lines at the top to change the period and the number of repetitions.</p>\n"}], "owner": {"reputation": 957, "user_id": 2820289, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/4eec9f1586150444590497403571d65f?s=128&d=identicon&r=PG&f=1", "display_name": "Helen", "link": "https://stackoverflow.com/users/2820289/helen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 33264105, "answer_count": 1, "score": 0, "last_activity_date": 1445443888, "creation_date": 1445442282, "last_edit_date": 1445443888, "question_id": 33263658, "link": "https://stackoverflow.com/questions/33263658/marking-an-area-with-a-double-for-loop", "title": "Marking an area with a double &#39;For&#39; loop", "body": "<p>I am trying to do the following: I want to store different areas (marked in yellow) in a string. The first yellow area is F7:G8, second is I7:J8 and so on, such that the string becomes: \"F7:G8,I7:J8,L7:M8,F10:G11,I10:J11, L10:M11\".</p>\n\n<p><a href=\"https://i.stack.imgur.com/jlcj8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jlcj8.png\" alt=\"enter image description here\"></a></p>\n\n<p>So in this example I have three areas to the right, and two down. The number of areas to the right and downwards may vary, therefore I want to make a code where I only have to specify how many areas to the right and downwards. Note that the first area always is F7:G8, so this I can use as a reference. Now, how many columns one skips before next area might vary, and also how many rows one skips before next area might vary. So this I need to take into account.</p>\n\n<p>I have the following VBA code:</p>\n\n<pre><code>Sub test()\n'\n' test Makro\n'\n\n'\n\nDim i As Integer, j As Integer\nk = 2 'areas downwards'\nl = 3 'areas rightwards'\n\nDim area As String\nLet area = \"F7:G8\" 'first area, always the same'\n\nDim Upper_letter As String\nLet Upper_letter = \"F\"\n\nDim Upper_nr As String\nLet Upper_nr = \"7\"\n\nDim Lower_letter As String\nLet Lower_letter = \"G\"\n\nDim Lower_nr As String\nLet Lower_nr = \"8\"\n\nFor i = 1 To k\n\n    For j = 1 To l\n\n        area = area &amp; \",\" &amp; Upper_letter &amp; Upper_nr \":\" &amp; Lower_letter &amp; Lower_number\n    'How do I add 3 letters to both Upper_letter and Lower_letter after each iteration of j?'\n\n    Next j\n\n   upper_nr = upper_nr + 3 'after each iteration of i, add 3'\n   lower_nr = lower_nr + 3 'after each iteration of i, add 3'\n\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>So I fail to see how I can add letters, in the innermost loop. </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 357, "user_id": 627813, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9dfe30d22a6a2c04f01e09866ce6d5be?s=128&d=identicon&r=PG", "display_name": "Tom Winchester", "link": "https://stackoverflow.com/users/627813/tom-winchester"}, "edited": false, "score": 1, "creation_date": 1445442313, "post_id": 33263528, "comment_id": 54328562, "body": "Holy. Crap.  IT&#39;S NOT EVEN MONDAY!!! This one&#39;s going on the fridge.  Thanks for that :)"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 357, "user_id": 627813, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9dfe30d22a6a2c04f01e09866ce6d5be?s=128&d=identicon&r=PG", "display_name": "Tom Winchester", "link": "https://stackoverflow.com/users/627813/tom-winchester"}, "edited": false, "score": 0, "creation_date": 1445442509, "post_id": 33263528, "comment_id": 54328700, "body": "It happens to even the best..   After hours i once posted a question where i was setting something to itself and couldn&#39;t figure out what was wrong."}], "tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": true, "score": 4, "last_activity_date": 1445441895, "creation_date": 1445441895, "answer_id": 33263528, "question_id": 33263473, "link": "https://stackoverflow.com/questions/33263473/error-using-range-fomula-for-subtotal/33263528#33263528", "title": "Error using Range.Fomula for SUBTOTAL", "body": "<p>You have formula spelled wrong..</p>\n\n<p>change</p>\n\n<pre><code>wsOutputData.Range(\"E1\").Fomula = \"=SUBTOTAL(9,E3:E\" &amp; lngOutputLastRow &amp; \")\"\n</code></pre>\n\n<p>to </p>\n\n<pre><code>wsOutputData.Range(\"E1\").Formula = \"=SUBTOTAL(9,E3:E\" &amp; lngOutputLastRow &amp; \")\" \n</code></pre>\n\n<p>Sometimes you have one of those days :)</p>\n"}], "owner": {"reputation": 357, "user_id": 627813, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9dfe30d22a6a2c04f01e09866ce6d5be?s=128&d=identicon&r=PG", "display_name": "Tom Winchester", "link": "https://stackoverflow.com/users/627813/tom-winchester"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 33263528, "answer_count": 1, "score": 0, "last_activity_date": 1445444873, "creation_date": 1445441716, "last_edit_date": 1445444873, "question_id": 33263473, "link": "https://stackoverflow.com/questions/33263473/error-using-range-fomula-for-subtotal", "title": "Error using Range.Fomula for SUBTOTAL", "body": "<p>I have a function that opens and closes multiple data sources and performs a comparison between the two.  All of that is working as intended. Now, I'm trying to add a subtotal cell at the top of one of the columns so that other users can filter the output data.  Here's the relevant snippet of the code:</p>\n\n<p><code>wsOutputData.Range(\"E1\").Fomula = \"=SUBTOTAL(9,E3:E\" &amp; lngOutputLastRow &amp; \")\"</code></p>\n\n<p>When the procedure gets to this line, I get the following error:</p>\n\n<blockquote>\n  <p>Run-time error '438': Object doesn't support this property or method</p>\n</blockquote>\n\n<p>I've double and triple-checked that all of my variables are defined (<code>wsOutputData</code> is a Worksheet that works in the line immediately above it, and <code>lngOutputLastRow</code> is a Long variable that's currently evaluated to <code>25,841</code>).  </p>\n\n<p>Am I using the <code>Range.Formula</code> property incorrectly?</p>\n\n<p>Edit: See selected answer below...spelling is hard.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1445442322, "post_id": 33263099, "comment_id": 54328568, "body": "By the way, you do not need the extra set of parentheses around the expression."}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1445441661, "post_id": 33263229, "comment_id": 54328122, "body": "Do you force the <code>Cells()</code> to a string, because <code>Cells(teller,5).Value</code> may not be a string, and this forces it to be a string so <code>LCase()</code> works?  Do you get errors if you just left it <code>If LCase(Cells(teller, 5).Value) ...</code>?"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1445442069, "post_id": 33263229, "comment_id": 54328380, "body": "No. OP says he is comparing two strings and trying to ignore case. Quick way is to force both strings to either upper or lower case and compare the results. If either is numeric, it will be cast to a string and then the LCase$() works on the string, which of course does nothing to numeral characters."}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": false, "score": 5, "last_activity_date": 1445441030, "creation_date": 1445441030, "answer_id": 33263229, "question_id": 33263099, "link": "https://stackoverflow.com/questions/33263099/case-insensitive-string-comparison/33263229#33263229", "title": "Case-Insensitive String Comparison", "body": "<p>Please try:</p>\n\n<pre><code>If LCase$(Cells(teller, 5).Value) = LCase$(Me.txtGebruikersnaam) Then\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 211, "user_id": 363784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cb56a8878cf05a456fc017286caecc2?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/363784/ben"}, "is_accepted": false, "score": 4, "last_activity_date": 1445453939, "creation_date": 1445453939, "answer_id": 33267149, "question_id": 33263099, "link": "https://stackoverflow.com/questions/33263099/case-insensitive-string-comparison/33267149#33267149", "title": "Case-Insensitive String Comparison", "body": "<p>You actually have a subtle bug in your usage of StrComp.</p>\n\n<p>The code in the original post states:  </p>\n\n<pre><code>If (StrComp(Cells(teller, 5).Value = Me.txtGebruikersnaam, vbTextCompare) = 0) Then\n</code></pre>\n\n<p>The problem is that you have a typo, and meant to write:  </p>\n\n<pre><code>If StrComp(Cells(teller, 5).Value, Me.txtGebruikersnaam, vbTextCompare) = 0 Then\n</code></pre>\n\n<p>The subtlety is that <code>Cells(teller, 5).Value = Me.txtGebruikersnaam</code> will evaluate to <code>False/0</code> unless you have a perfect case sensitive match, and then get compared to <code>vbTextCompare</code>, which is a predefined constant with value 1.</p>\n\n<p>Try it with a comma rather than an equals.</p>\n\n<p>PS: Also removing extra brackets as pointed out by Excel Hero.</p>\n"}], "owner": {"reputation": 163, "user_id": 4611636, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/CApZY.png?s=128&g=1", "display_name": "Iluvpresident", "link": "https://stackoverflow.com/users/4611636/iluvpresident"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1034, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1445453939, "creation_date": 1445440628, "last_edit_date": 1445446131, "question_id": 33263099, "link": "https://stackoverflow.com/questions/33263099/case-insensitive-string-comparison", "title": "Case-Insensitive String Comparison", "body": "<p>I'm trying to find a way to show the MsgBox if those two strings are equal but doesn't look at upper- or lowercase.</p>\n\n<pre><code>For teller = 1 To 51\nIf Cells(teller, 5).Value = Me.txtGebruikersnaam Then\n    MsgBox (\"Deze Gebruiker bestaat al!\")\n    Exit Sub\n    Else\nEnd If\nNext\n</code></pre>\n\n<p>I tried to use:</p>\n\n<pre><code>If (StrComp(Cells(teller, 5).Value = Me.txtGebruikersnaam, vbTextCompare) = 0) Then\n</code></pre>\n\n<p>but it didn't work.</p>\n"}, {"tags": ["vba", "excel", "solver"], "comments": [{"owner": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "edited": false, "score": 0, "creation_date": 1445443799, "post_id": 33262875, "comment_id": 54329560, "body": "what&#39;s the value of <code>i</code> when it fails?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1445443877, "post_id": 33262875, "comment_id": 54329613, "body": "<code>ByChange:=&quot;$AE$:$AF$&quot; &amp; i</code> - are you sure this is correct ?  Maybe it should be <code>ByChange:=&quot;$AE$&quot; &amp; i &amp; &quot;:$AF$&quot; &amp; i</code>  Also I think you need to Reset solver after each iteration."}], "answers": [{"comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1445446698, "post_id": 33264896, "comment_id": 54331313, "body": "I am tempted to downvote this answer... how does this help the OP when they clearly have several different arguments for <code>Relation</code> and <code>FormulaText</code>?"}, {"owner": {"reputation": 313, "user_id": 4275816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/91Zq4.gif?s=128&g=1", "display_name": "shg", "link": "https://stackoverflow.com/users/4275816/shg"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1445449345, "post_id": 33264896, "comment_id": 54332851, "body": "My apologies to hanna. I though she was applying the different constraints to the same cell. Edited above."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1445451043, "post_id": 33264896, "comment_id": 54333824, "body": "If you change all your <code>1</code> row references to <code>i</code>, I think it would be perfect (qualifying that statement with the fact that I have barely coded the solver function)."}, {"owner": {"reputation": 313, "user_id": 4275816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/91Zq4.gif?s=128&g=1", "display_name": "shg", "link": "https://stackoverflow.com/users/4275816/shg"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1445451326, "post_id": 33264896, "comment_id": 54333989, "body": "The Rows(i) statement establishes the reference row used by the .Range references."}, {"owner": {"reputation": 1, "user_id": 5472142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f9ea8862dfdf408a6ce2684597eb5df?s=128&d=identicon&r=PG", "display_name": "hanna", "link": "https://stackoverflow.com/users/5472142/hanna"}, "edited": false, "score": 0, "creation_date": 1445521302, "post_id": 33264896, "comment_id": 54365203, "body": "After a first test this worked just fine, thank you!"}], "tags": [], "owner": {"reputation": 313, "user_id": 4275816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/91Zq4.gif?s=128&g=1", "display_name": "shg", "link": "https://stackoverflow.com/users/4275816/shg"}, "is_accepted": true, "score": 0, "last_activity_date": 1445449439, "last_edit_date": 1445449439, "creation_date": 1445445958, "answer_id": 33264896, "question_id": 33262875, "link": "https://stackoverflow.com/questions/33262875/applying-solver-to-various-rowsa/33264896#33264896", "title": "Applying Solver to various rowsa", "body": "<p>Maybe this is all you need, hanna:</p>\n\n<pre><code>Sub hanna()\n  Dim i As Long\n\n  For i = 7 To 310\n    SolverReset\n\n    With Rows(i)\n      SolverOk SetCell:=.Range(\"AA1\").Address, _\n               MaxMinVal:=2, _\n               ByChange:=.Range(\"AE1:AF1\").Address, _\n               Engine:=1\n      SolverAdd CellRef:=.Range(\"AA1\").Address, Relation:=1, FormulaText:=\"-0.000001\"\n      SolverAdd CellRef:=.Range(\"AB1\").Address, Relation:=3, FormulaText:=\"0.000001\"\n      SolverAdd CellRef:=.Range(\"AC1\").Address, Relation:=1, FormulaText:=\"-0.000001\"\n      SolverAdd CellRef:=.Range(\"AD1\").Address, Relation:=3, FormulaText:=\"0.000001\"\n      SolverAdd CellRef:=.Range(\"AE1\").Address, Relation:=1, FormulaText:=\"1\"\n      SolverAdd CellRef:=.Range(\"AF1\").Address, Relation:=1, FormulaText:=\"1.5\"\n      SolverSolve UserFinish:=True\n    End With\n  Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5472142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f9ea8862dfdf408a6ce2684597eb5df?s=128&d=identicon&r=PG", "display_name": "hanna", "link": "https://stackoverflow.com/users/5472142/hanna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 1, "accepted_answer_id": 33264896, "answer_count": 1, "score": -1, "last_activity_date": 1445449439, "creation_date": 1445439993, "last_edit_date": 1445440213, "question_id": 33262875, "link": "https://stackoverflow.com/questions/33262875/applying-solver-to-various-rowsa", "title": "Applying Solver to various rowsa", "body": "<p>I would like to know how I can get code to perform a solver operation on various rows (300 rows). There is one target variable, and several constraints, and two variables that should be optimized. Using the below command, I get an error that the problem is too big for Solver, which can only be a mistake in the syntax. This is my syntax:</p>\n\n<pre><code>Dim i As Long\nFor i = 7 To 310\n\nSolverOk SetCell:=\"$AA$\" &amp; i, MaxMinVal:=2, ValueOf:=0, ByChange:=\"$AE$:$AF$\" &amp; i, _\n    Engine:=1, EngineDesc:=\"GRG Nonlinear\"\nSolverAdd CellRef:=\"$AA$\" &amp; i, Relation:=1, FormulaText:=\"-0.000001\"\nSolverOk SetCell:=\"$AA$\" &amp; i, MaxMinVal:=2, ValueOf:=0, ByChange:=\"$AE$:$AF$\" &amp; i, _\n    Engine:=1, EngineDesc:=\"GRG Nonlinear\"\nSolverAdd CellRef:=\"$AB$\" &amp; i, Relation:=3, FormulaText:=\"0.000001\"\nSolverOk SetCell:=\"$AA$\" &amp; i, MaxMinVal:=2, ValueOf:=0, ByChange:=\"$AE$:$AF$\" &amp; i, _\n    Engine:=1, EngineDesc:=\"GRG Nonlinear\"\nSolverAdd CellRef:=\"$AC$\" &amp; i, Relation:=1, FormulaText:=\"-0.000001\"\nSolverOk SetCell:=\"$AA$\" &amp; i, MaxMinVal:=2, ValueOf:=0, ByChange:=\"$AE$:$AF$\" &amp; i, _\n    Engine:=1, EngineDesc:=\"GRG Nonlinear\"\nSolverAdd CellRef:=\"$AD$\" &amp; i, Relation:=3, FormulaText:=\"0.000001\"\nSolverOk SetCell:=\"$AA$\" &amp; i, MaxMinVal:=2, ValueOf:=0, ByChange:=\"$AE$:$AF$\" &amp; i, _\n    Engine:=1, EngineDesc:=\"GRG Nonlinear\"\nSolverAdd CellRef:=\"$AE$\" &amp; i, Relation:=3, FormulaText:=\"0\"\nSolverOk SetCell:=\"$AA$\" &amp; i, MaxMinVal:=2, ValueOf:=0, ByChange:=\"$AE$:$AF$\" &amp; i, _\n    Engine:=1, EngineDesc:=\"GRG Nonlinear\"\nSolverAdd CellRef:=\"$AF$\" &amp; i, Relation:=3, FormulaText:=\"0\"\nSolverOk SetCell:=\"$AA$\" &amp; i, MaxMinVal:=2, ValueOf:=0, ByChange:=\"$AE$:$AF$\" &amp; i, _\n    Engine:=1, EngineDesc:=\"GRG Nonlinear\"\nSolverAdd CellRef:=\"$AE$\" &amp; i, Relation:=1, FormulaText:=\"1\"\nSolverOk SetCell:=\"$AA$\" &amp; i, MaxMinVal:=2, ValueOf:=0, ByChange:=\"$AE$:$AF$\" &amp; i, _\n    Engine:=1, EngineDesc:=\"GRG Nonlinear\"\nSolverAdd CellRef:=\"$AF$\" &amp; i, Relation:=1, FormulaText:=\"1.5\"\nSolverOk SetCell:=\"$AA$\" &amp; i, MaxMinVal:=2, ValueOf:=0, ByChange:=\"$AE$:$AF$\" &amp; i, _\n    Engine:=1, EngineDesc:=\"GRG Nonlinear\"\nSolverOptions MaxTime:=0, Iterations:=1000000, Precision:=0.000001, Convergence _\n    :=0.0001, StepThru:=True, Scaling:=True, AssumeNonNeg:=True, Derivatives:=1\nSolverOptions PopulationSize:=100, RandomSeed:=0, MutationRate:=0.075, Multistart _\n    :=False, RequireBounds:=False, MaxSubproblems:=0, MaxIntegerSols:=0, _\n    IntTolerance:=1, SolveWithout:=False, MaxTimeNoImp:=30\n   SolverSolve\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "ado"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1445439659, "post_id": 33262745, "comment_id": 54326633, "body": "What line does the error happen on?"}, {"owner": {"reputation": 603, "user_id": 4696968, "user_type": "registered", "accept_rate": 72, "profile_image": "https://lh4.googleusercontent.com/-tRHmNa_ORBc/AAAAAAAAAAI/AAAAAAAAAAw/r4xL4efuyOs/photo.jpg?sz=128", "display_name": "owner", "link": "https://stackoverflow.com/users/4696968/owner"}, "reply_to_user": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1445439776, "post_id": 33262745, "comment_id": 54326712, "body": "@MatthewD: at <code>adoCN.Execute sSQL</code>. thanks."}], "answers": [{"comments": [{"owner": {"reputation": 603, "user_id": 4696968, "user_type": "registered", "accept_rate": 72, "profile_image": "https://lh4.googleusercontent.com/-tRHmNa_ORBc/AAAAAAAAAAI/AAAAAAAAAAw/r4xL4efuyOs/photo.jpg?sz=128", "display_name": "owner", "link": "https://stackoverflow.com/users/4696968/owner"}, "edited": false, "score": 0, "creation_date": 1445440409, "post_id": 33262813, "comment_id": 54327208, "body": "cheers. i now end up with <code>[Microsoft][ODBC Driver Manager] data source name not found and no default driver specified</code>. Do i need to update in <code>sConnString</code> the provider from <code>sqloledb</code> to <code>odbc</code>? thx"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 603, "user_id": 4696968, "user_type": "registered", "accept_rate": 72, "profile_image": "https://lh4.googleusercontent.com/-tRHmNa_ORBc/AAAAAAAAAAI/AAAAAAAAAAw/r4xL4efuyOs/photo.jpg?sz=128", "display_name": "owner", "link": "https://stackoverflow.com/users/4696968/owner"}, "edited": false, "score": 0, "creation_date": 1445440528, "post_id": 33262813, "comment_id": 54327291, "body": "Yeah, you will need to get your connection string built correctly.  What are you connecting to? Access, Oracle, etc."}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 603, "user_id": 4696968, "user_type": "registered", "accept_rate": 72, "profile_image": "https://lh4.googleusercontent.com/-tRHmNa_ORBc/AAAAAAAAAAI/AAAAAAAAAAw/r4xL4efuyOs/photo.jpg?sz=128", "display_name": "owner", "link": "https://stackoverflow.com/users/4696968/owner"}, "edited": false, "score": 0, "creation_date": 1445440823, "post_id": 33262813, "comment_id": 54327501, "body": "See <a href=\"http://stackoverflow.com/questions/18313899/vba-new-database-connection\" title=\"vba new database connection\">stackoverflow.com/questions/18313899/&hellip;</a>  Looks like the format is sConnString = &quot;Driver={SQL Server};Server=; Database=; UID=; PWD=&quot;  Fill in the blanks with your server, database, uid and pwd"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 603, "user_id": 4696968, "user_type": "registered", "accept_rate": 72, "profile_image": "https://lh4.googleusercontent.com/-tRHmNa_ORBc/AAAAAAAAAAI/AAAAAAAAAAw/r4xL4efuyOs/photo.jpg?sz=128", "display_name": "owner", "link": "https://stackoverflow.com/users/4696968/owner"}, "edited": false, "score": 0, "creation_date": 1445441148, "post_id": 33262813, "comment_id": 54327734, "body": "Look here for more info on the connection params.  <a href=\"http://www.mrexcel.com/forum/excel-questions/617788-visual-basic-applications-connect-sql-server.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a>"}, {"owner": {"reputation": 603, "user_id": 4696968, "user_type": "registered", "accept_rate": 72, "profile_image": "https://lh4.googleusercontent.com/-tRHmNa_ORBc/AAAAAAAAAAI/AAAAAAAAAAw/r4xL4efuyOs/photo.jpg?sz=128", "display_name": "owner", "link": "https://stackoverflow.com/users/4696968/owner"}, "edited": false, "score": 0, "creation_date": 1445441532, "post_id": 33262813, "comment_id": 54328021, "body": "same odbc error with suggested <code>sConnString = &quot;Driver={SQL Server};Server=; Database=; UID=; PWD=&quot;</code>. will do more research on vba-odbc, as in matlab i am usually setting up easly my connexion string with <code>conn = database(&#39;odbcname&#39;, &#39;UID&#39;, &#39;PWD&#39;)</code>. cheers."}], "tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 3, "last_activity_date": 1445439824, "creation_date": 1445439824, "answer_id": 33262813, "question_id": 33262745, "link": "https://stackoverflow.com/questions/33262745/adodb-connection-in-vba-operation-not-allowed-when-object-is-closed/33262813#33262813", "title": "ADODB.Connection in vba: operation not allowed when object is closed", "body": "<p>You need to open the connection before you can use it.</p>\n\n<pre><code>sConnString = \"Provider=sqloledb;Server=xxx;User Id=xxx;Password=xxx\"\nSet adoCN = CreateObject(\"ADODB.Connection\")\nadoCN.Open\n</code></pre>\n"}], "owner": {"reputation": 603, "user_id": 4696968, "user_type": "registered", "accept_rate": 72, "profile_image": "https://lh4.googleusercontent.com/-tRHmNa_ORBc/AAAAAAAAAAI/AAAAAAAAAAw/r4xL4efuyOs/photo.jpg?sz=128", "display_name": "owner", "link": "https://stackoverflow.com/users/4696968/owner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1565, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1445439824, "creation_date": 1445439625, "last_edit_date": 1531164843, "question_id": 33262745, "link": "https://stackoverflow.com/questions/33262745/adodb-connection-in-vba-operation-not-allowed-when-object-is-closed", "title": "ADODB.Connection in vba: operation not allowed when object is closed", "body": "<p>I am finalizing a vba macro, and wonder if someone could assist with the following error message:</p>\n\n<pre><code>run-time error '3704'\noperation is not allowed when the object is closed\n</code></pre>\n\n<p>Code:</p>\n\n<p>================================</p>\n\n<pre><code>Sub upload()\n'\n' upload Macro\n'\nDim adoCN As ADODB.Connection\nDim sConnString As String\nDim sSQL As String\nDim lRow As Long\nDim i As Integer\n\nsConnString = \"Provider=sqloledb;Server=xxx;User Id=xxx;Password=xxx\"\nSet adoCN = CreateObject(\"ADODB.Connection\")\nSheets(\"sql\").Activate\nRange(Cells(1, 1), Cells(1, 1).End(xlDown)).Select\nlRow = Selection.Rows.Count\nFor i = 2 To lRow\nsSQL = \"INSERT INTO tblData (ISN, Date, Px_last) \" &amp; _\n        \" VALUES (\" &amp; _\n        \"'\" &amp; Cells(i, 1) &amp; \"', \" &amp; _\n        \"'\" &amp; Cells(i, 2) &amp; \"', \" &amp; _\n        \"'\" &amp; Cells(i, 3) &amp; \"')\"\nadoCN.Execute sSQL\nNext i\nadoCN.Close\nSet adoCN = Nothing\nEnd Sub\n</code></pre>\n\n<p>Best,</p>\n"}, {"tags": ["vba", "excel", "excel-addins"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1445440294, "post_id": 33262675, "comment_id": 54327117, "body": "VBA doesn&#39;t use a <code>return</code> statement. Is this VBA, or something different language like VB.NET?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1445440379, "post_id": 33262675, "comment_id": 54327184, "body": "<i>if they try to send to one they don&#39;t have access to it will respond with unauthorized</i> -- will the <b>API return an error in this case</b> (i.e., an error result from the XML response?) or are you trying to control this solely through the Add-In?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1445440659, "post_id": 33262675, "comment_id": 54327379, "body": "The short answer is that Yes, Add-ins <b>can</b> communicate with one another (i.e., a function in Add_In_1 can call a function in Add_In_2, and using the Extensibility library you could probably even do some pretty tricky stuff, but realistically this looks like a problem for a managed code solution especially if you anticipate the need to add many more functions, routes, etc., in the future)"}, {"owner": {"reputation": 112, "user_id": 5200994, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4158aba18be472c19fe35e35495aa9c0?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Dermody-Lawrence", "link": "https://stackoverflow.com/users/5200994/christopher-dermody-lawrence"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1445441192, "post_id": 33262675, "comment_id": 54327761, "body": "@DavidZemens Yes the XML will contain an error message and i have a custom function that splits the XML, If the xml contains the error it will return that as a string if not it will return the answer.  Is there not a way of adding a reference to a specific add in at the top like &#39;using or Imports similar to the way in .net? or am i a dreamer"}], "answers": [{"comments": [{"owner": {"reputation": 112, "user_id": 5200994, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4158aba18be472c19fe35e35495aa9c0?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Dermody-Lawrence", "link": "https://stackoverflow.com/users/5200994/christopher-dermody-lawrence"}, "edited": false, "score": 0, "creation_date": 1445441921, "post_id": 33263445, "comment_id": 54328276, "body": "Thank you very much, I assume i could just add an on error to this and &quot;output please install MainAddIn.xlam&quot;, what sort of error handling/ response does it have?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 112, "user_id": 5200994, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4158aba18be472c19fe35e35495aa9c0?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Dermody-Lawrence", "link": "https://stackoverflow.com/users/5200994/christopher-dermody-lawrence"}, "edited": false, "score": 1, "creation_date": 1445442420, "post_id": 33263445, "comment_id": 54328622, "body": "You could do that except I&#39;m not sure what would happen if error occurs in the MainAddIn, it seems probably better to do a check against the active Add-Ins instead (see additional helper function I added in the answer)"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 1, "last_activity_date": 1445442963, "last_edit_date": 1445442963, "creation_date": 1445441654, "answer_id": 33263445, "question_id": 33262675, "link": "https://stackoverflow.com/questions/33262675/can-add-ins-communicate-connecting-add-ins-add-in-dependency/33263445#33263445", "title": "Can add-ins Communicate? Connecting Add-ins / Add-in Dependency", "body": "<blockquote>\n  <p><strong>is a way of having an add in for each function that Connects to the main communication add in?</strong></p>\n</blockquote>\n\n<p>Assuming <code>CalculateSomething</code> is in one Add-In, and your other function <code>PostApiXmlToXml</code> is in Module1 of a separate Add-in (let's just call it \"MainAddIn.xlam\" which is already installed on the user's machine)</p>\n\n<pre><code>Function CalculateSomething(x as double, y as double, z as double) as double\n    Xml = \"&lt;x&gt;\" + x + \"&lt;/x&gt;\" &amp;_\n           \"&lt;y&gt;\" + y + \"&lt;/y&gt;\" &amp;_\n           \"\"  \"\"       \"\" \"\" \n    route = \"www.api.com/api/controller/func\"\n    CalculateSomething = _\n        Application.Run(\"MainAddIn!Module1.PostApiXmlToXml\", xml, route)\nEnd Function\n</code></pre>\n\n<p><strong>Note</strong> you need to specify the VBProject and Module by name in the <code>Run</code> statement.</p>\n\n<p>To check whether the addin is installed you could use a function like this:</p>\n\n<pre><code>Function IsAddInInstalled(name$) As boolean\nDim a\nDim ret as Boolean\nFor each a in Application.AddIns\n    if (a.Name = name) then\n        ret = True\n        Exit For\n    End If\nNext\n\nIf not ret Then MsgBox \"Please install \" &amp; name\nIsAddInInstalled = ret\nEnd Function\n</code></pre>\n\n<p>Deciding <em>where</em> to call this function is another story. Of course you could call it within each procedure in your Dependent add-in, but probably it would be better to put it in the Workbook_Open procedure, just once:</p>\n\n<pre><code>Sub Workbook_Open()\n    Call IsAddInInstalled(\"MainAddIn.xlam\")\nEnd Sub\n</code></pre>\n\n<p>This way, every time the user opens Excel, it will check for the availability of the \"main\" add-in, and raise a message box if it is not available.</p>\n"}], "owner": {"reputation": 112, "user_id": 5200994, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4158aba18be472c19fe35e35495aa9c0?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Dermody-Lawrence", "link": "https://stackoverflow.com/users/5200994/christopher-dermody-lawrence"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 33263445, "answer_count": 1, "score": 1, "last_activity_date": 1445442963, "creation_date": 1445439390, "last_edit_date": 1445441425, "question_id": 33262675, "link": "https://stackoverflow.com/questions/33262675/can-add-ins-communicate-connecting-add-ins-add-in-dependency", "title": "Can add-ins Communicate? Connecting Add-ins / Add-in Dependency", "body": "<p><strong>Can Add-ins communicate?</strong></p>\n\n<p>I have an Excel add in that communicates with an API. In that add-in it can take in the XML packaged data as a string and the route of the API as a URL/I as a string then POSTs it data:</p>\n\n<pre><code>Function PostApiXmlToXml(XML as String, URL as String) as String\n   'Post to Url that XML data\n   'PostApiXmlToXml = the XML response\nEnd Function\n</code></pre>\n\n<p>The problem is that there are many different routes and functions needed. And not all users need/are authorized to use all Routes.</p>\n\n<p>I either just give everyone access to every function but if they try to send to one they don't have access to it will respond with unauthorized.</p>\n\n<p><strong>Or there is a way of having an add in for each function that Connects to the main communication add in?</strong></p>\n\n<p>e.g. this separate add-in has a function that is dependent on the first:</p>\n\n<pre><code>Function CalculateSomething(x as double, y as double, z as double) as double\n    Xml = \"&lt;x&gt;\" + x + \"&lt;/x&gt;\" &amp;_\n           \"&lt;y&gt;\" + y + \"&lt;/y&gt;\" &amp;_\n           \"\"  \"\"       \"\" \"\" \n    route = \"www.api.com/api/controller/func\"\n    CalculateSomething = PostApiXmlToXml(xml,route)\nEnd Function\n</code></pre>\n\n<p>Main problem is that users can opt in to new functions whenever they want, so I want to make it as easy as possible for the user to just download another add-in that will give them access. There's also many more functions to be added in the future.  </p>\n\n<p>Is it possible or am I going about this all the wrong way?</p>\n\n<p>Would people recommend going down the VSTO route?(no experience in that whatsoever)</p>\n"}, {"tags": ["vba", "ms-office", "powerpoint", "ribbon"], "comments": [{"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1445528029, "post_id": 33262567, "comment_id": 54370046, "body": "Normally, XML ribbon customizations in a PPTM file are only visible when that file is open and has focus.  If the XML ribbon customizations are in an add-in (ie. PPAM) that&#39;s loaded, the customizations will be present for any open file.  Where are your customizations (and are you in fact using XML or are you creating command bars)?"}, {"owner": {"reputation": 3277, "user_id": 222236, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/aecf6a277d8903d29a0f7a3b01c245ea?s=128&d=identicon&r=PG", "display_name": "Cilvic", "link": "https://stackoverflow.com/users/222236/cilvic"}, "reply_to_user": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1445624552, "post_id": 33262567, "comment_id": 54416816, "body": "It sounds like @harry is using the Quick Access Toolbar. You should post your comment as answer @steve!"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4749321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2333665fe79569d21a1c77fdef7af649?s=128&d=identicon&r=PG&f=1", "display_name": "harry", "link": "https://stackoverflow.com/users/4749321/harry"}, "edited": false, "score": 0, "creation_date": 1445847728, "post_id": 33322054, "comment_id": 54478202, "body": "Thanks for your answer. I was using the built-in customization feature. I have never used XML ribbon but I will look into it."}, {"owner": {"reputation": 1, "user_id": 4749321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2333665fe79569d21a1c77fdef7af649?s=128&d=identicon&r=PG&f=1", "display_name": "harry", "link": "https://stackoverflow.com/users/4749321/harry"}, "edited": false, "score": 0, "creation_date": 1446030563, "post_id": 33322054, "comment_id": 54570617, "body": "I used Visual Studio Pro to create the add in with XML code. <code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;customUI xmlns=&quot;schemas.microsoft.com&#47;office&#47;2009&#47;07&#47;customui&quot;; onLoad=&quot;Ribbon_Load&quot;&gt;  &lt;ribbon&gt;  &lt;tabs&gt;  &lt;tab idMso=&quot;TabHome&quot;&gt; &lt;group id=&quot;MyGroup&quot; label=&quot;Tasks&quot;&gt;  &lt;button id=&quot;taskButton&quot; label =&quot;Task Form&quot; idMso =&quot;PlayMacro&quot; onAction=&quot;Task_Form&quot;&#47;&gt;  &lt;&#47;group&gt;  &lt;&#47;tab&gt; &lt;&#47;tabs&gt;  &lt;&#47;ribbon&gt;  &lt;&#47;customUI&gt;</code>  How do I add this to the PPTM as you first suggested? Thanks Again"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "reply_to_user": {"reputation": 1, "user_id": 4749321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2333665fe79569d21a1c77fdef7af649?s=128&d=identicon&r=PG&f=1", "display_name": "harry", "link": "https://stackoverflow.com/users/4749321/harry"}, "edited": false, "score": 0, "creation_date": 1446047927, "post_id": 33322054, "comment_id": 54582911, "body": "Google this (w/o the quotes):  &quot;custom ui editor for microsoft office&quot;  and you&#39;ll get a link to a page with a simple tool for adding the XML to your PPTM and also links to some other How-To articles."}], "tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1445712865, "creation_date": 1445712865, "answer_id": 33322054, "question_id": 33262567, "link": "https://stackoverflow.com/questions/33262567/keep-changes-to-office-ribbon-local-to-file/33322054#33322054", "title": "Keep changes to office ribbon local to file?", "body": "<p>XML ribbon customizations in a PPTM file are only visible when that file is open and has focus. It sounds like this is what you'd want to do ... store the VBA and RibbonX code in the file you want to work with.</p>\n\n<p>If the XML ribbon customizations are in an add-in (ie. PPAM) that's loaded, the customizations will be present for any open file. </p>\n\n<p>@Cilvic has a good point (thanks!).  If you're adding customizations to the Ribbon or QAT via the built-in customization feature, these will also be there whenever PPT is open. You can't make them appear only when a certain file is open.</p>\n\n<p>Where are your customizations (and are you in fact using XML or are you creating command bars)?</p>\n"}], "owner": {"reputation": 1, "user_id": 4749321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2333665fe79569d21a1c77fdef7af649?s=128&d=identicon&r=PG&f=1", "display_name": "harry", "link": "https://stackoverflow.com/users/4749321/harry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1445712865, "creation_date": 1445439092, "question_id": 33262567, "link": "https://stackoverflow.com/questions/33262567/keep-changes-to-office-ribbon-local-to-file", "title": "Keep changes to office ribbon local to file?", "body": "<p>I have a presentation that needs to be regularly updated. To facilitate this quickly I have written a simple form in VBA which I would like to be accessible from the ribbon (or via a button in editor mode). \nHowever I do not want the button in the ribbon to be visible in other Power point documents. \nIs it possible to stop customizations from being applied globally? </p>\n\n<p>Thanks in advance </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1445438622, "post_id": 33262033, "comment_id": 54325772, "body": "It&#39;s just that <code>txtOutput.text</code> is not a path to a file, add just before <code>MsgBox txtOutput.text</code> to check it&#39;s value! ;)"}, {"owner": {"reputation": 1, "user_id": 5471958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d6b31ec1c139f1792e132e855a76cd6?s=128&d=identicon&r=PG&f=1", "display_name": "Mahir.A", "link": "https://stackoverflow.com/users/5471958/mahir-a"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1445438960, "post_id": 33262033, "comment_id": 54326059, "body": "Thanks for replying but I don&#39;t think I understood you. I added <code>MsgBox txtOutput.text</code> after <code>Dim countx as Integer</code> and the file path popped up. Is that what you meant?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1445439642, "post_id": 33262033, "comment_id": 54326614, "body": "Did the file path <i>only</i> display? Or did the file path <b>and</b> file name pop-up? The <code>Workbooks</code> object needs both the path and name to open, and at least the name to reference other objects within it once its opened (i.e. <code>Worksheets</code>)"}, {"owner": {"reputation": 1, "user_id": 5471958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d6b31ec1c139f1792e132e855a76cd6?s=128&d=identicon&r=PG&f=1", "display_name": "Mahir.A", "link": "https://stackoverflow.com/users/5471958/mahir-a"}, "edited": false, "score": 0, "creation_date": 1445439671, "post_id": 33262033, "comment_id": 54326643, "body": "I get the same error for every line that has something similar; such as <code>countx = Workbooks(txtFilePath.Text).Worksheets.Count</code>. <code>Call</code> won&#39;t work for something like this"}, {"owner": {"reputation": 1, "user_id": 5471958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d6b31ec1c139f1792e132e855a76cd6?s=128&d=identicon&r=PG&f=1", "display_name": "Mahir.A", "link": "https://stackoverflow.com/users/5471958/mahir-a"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1445439791, "post_id": 33262033, "comment_id": 54326726, "body": "@ScottHoltzman The entire path showed up. Like C:\\\\Users\\.....\\filename.xlsx is what appears"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1445439996, "post_id": 33262033, "comment_id": 54326876, "body": "This may seem stupid, but try passing the textbox text into a string variable and then using that variable to reference in the <code>Workbook</code> methods."}, {"owner": {"reputation": 1, "user_id": 5471958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d6b31ec1c139f1792e132e855a76cd6?s=128&d=identicon&r=PG&f=1", "display_name": "Mahir.A", "link": "https://stackoverflow.com/users/5471958/mahir-a"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1445440894, "post_id": 33262033, "comment_id": 54327562, "body": "@ScottHoltzman I still get the same error"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1445441042, "post_id": 33262033, "comment_id": 54327665, "body": "is there a workbook with the name in that location? Does the path even exist as written? Also remove the <code>()</code> from the &#39;Workbook.Open` line. They are only needed when you are setting the <code>Workbook.Open</code> to a variable."}, {"owner": {"reputation": 1, "user_id": 5471958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d6b31ec1c139f1792e132e855a76cd6?s=128&d=identicon&r=PG&f=1", "display_name": "Mahir.A", "link": "https://stackoverflow.com/users/5471958/mahir-a"}, "edited": false, "score": 0, "creation_date": 1445441415, "post_id": 33262033, "comment_id": 54327921, "body": "Both workbooks exist in the path. When I reference the files directly in my code (running off a macro directly in the file rather than a userform) everything works perfectly."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1445442140, "post_id": 33262033, "comment_id": 54328432, "body": "Did you take the parenthesis out of the <code>Workbooks.Open</code> line (not sure if you saw my last comment, but I edited it to reflect that."}, {"owner": {"reputation": 1, "user_id": 5471958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d6b31ec1c139f1792e132e855a76cd6?s=128&d=identicon&r=PG&f=1", "display_name": "Mahir.A", "link": "https://stackoverflow.com/users/5471958/mahir-a"}, "edited": false, "score": 0, "creation_date": 1445442489, "post_id": 33262033, "comment_id": 54328683, "body": "Yeah I made that change, thanks. That line is fine but the line that gets an error is  <code>countx = Workbooks(txtFilePath.Text).Worksheets.Count</code>"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1445443046, "post_id": 33262033, "comment_id": 54329058, "body": "is the workbook <code>txtFilePath.Text</code> open? If not, you need to open it. If it is open, is the <code>txtFilePath.Text</code> the full path? Or just the workbook name? If it&#39;s the full path, manipulate the string to just get the workbook name and see if that works. It should."}, {"owner": {"reputation": 1, "user_id": 5471958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d6b31ec1c139f1792e132e855a76cd6?s=128&d=identicon&r=PG&f=1", "display_name": "Mahir.A", "link": "https://stackoverflow.com/users/5471958/mahir-a"}, "edited": false, "score": 0, "creation_date": 1445448484, "post_id": 33262033, "comment_id": 54332327, "body": "Yeah that seems to have worked. Just having some issues with the picture not pasting to the book. Thanks guys!"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5471958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d6b31ec1c139f1792e132e855a76cd6?s=128&d=identicon&r=PG&f=1", "display_name": "Mahir.A", "link": "https://stackoverflow.com/users/5471958/mahir-a"}, "edited": false, "score": 0, "creation_date": 1445442819, "post_id": 33263751, "comment_id": 54328926, "body": "Thanks for your answer, but I&#39;m not having problems with the files existing. I have already confirmed that the paths are copying over correctly. Thanks again though!!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5412293"}, "reply_to_user": {"reputation": 1, "user_id": 5471958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d6b31ec1c139f1792e132e855a76cd6?s=128&d=identicon&r=PG&f=1", "display_name": "Mahir.A", "link": "https://stackoverflow.com/users/5471958/mahir-a"}, "edited": false, "score": 0, "creation_date": 1445443079, "post_id": 33263751, "comment_id": 54329076, "body": "H i Mahir, Look at my comment about : Workbooks.Open (txtOutput.Text)"}, {"owner": {"reputation": 1, "user_id": 5471958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d6b31ec1c139f1792e132e855a76cd6?s=128&d=identicon&r=PG&f=1", "display_name": "Mahir.A", "link": "https://stackoverflow.com/users/5471958/mahir-a"}, "edited": false, "score": 0, "creation_date": 1445443243, "post_id": 33263751, "comment_id": 54329186, "body": "Yeah I saw that, the change was suggested to me by another person. Thanks though!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5412293"}, "is_accepted": false, "score": 0, "last_activity_date": 1445442540, "creation_date": 1445442540, "answer_id": 33263751, "question_id": 33262033, "link": "https://stackoverflow.com/questions/33262033/reference-file-path-from-text-box-vba/33263751#33263751", "title": "reference file path from text box vba", "body": "<p>Usually this error is because you are trying to use an object that does not exits.</p>\n\n<p>Also if you are not setting a workbook to a variable you do not need to add \"()\" </p>\n\n<p>So the line </p>\n\n<pre><code>Workbooks.Open (txtOutput.Text) \n</code></pre>\n\n<p>Should be </p>\n\n<pre><code>Workbooks.Open txtOutput.Text\n</code></pre>\n\n<p>I cleaned your code a little bit</p>\n\n<pre><code>Private Sub cmdRun_Click()\n\n    Dim countx As Integer\n    Dim wbOpened As Workbook\n    Dim strFilePath As String\n\n    'Initialize the variables\n    countx = Workbooks(txtFilePath.Text).Worksheets.Count\n    strFilePath = txtOutput.Text\n\n    ' Make sure that the file exits\n    If DoesFileExist(strFilePath) Then\n        ' Open the workbook and assign it to the variable\n        Set wbOpened = Workbooks.Open(strFilePath)\n\n        For I = 1 To countx\n            Workbooks(txtFilePath.Text).Worksheets(I).Range(txtRange.Text).CopyPicture xlScreen, xlBitmap\n            Workbooks(txtFilePath.Text).Worksheets(I).Paste\n            Destination = wbOpened.Worksheets(\"Sheet1\").Cells(30 * I + 1, \"A\")\n        Next I\n\n        wbOpened.Worksheets(\"Sheet1\").Pictures.Select\n        Selection.ShapeRange.ScaleWidth 0.4, msoFalse, msoScaleFromTopLeft\n    Else\n        MsgBox \"The file\"\"\" &amp; strFilePath &amp; \"\"\" could not be found\"\n    End If\n\nEnd Sub\n\n'Function to check if the file exists.\nPrivate Function DoesFileExist(ByVal strPath As String) As Boolean\n    DoesFileExist = (Dir$(strPath, vbNormal) &lt;&gt; vbNullString)\nEnd Function\n</code></pre>\n\n<p>I hope this helps :)\nThanks</p>\n"}], "owner": {"reputation": 1, "user_id": 5471958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d6b31ec1c139f1792e132e855a76cd6?s=128&d=identicon&r=PG&f=1", "display_name": "Mahir.A", "link": "https://stackoverflow.com/users/5471958/mahir-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1178, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1445442540, "creation_date": 1445437659, "last_edit_date": 1445438483, "question_id": 33262033, "link": "https://stackoverflow.com/questions/33262033/reference-file-path-from-text-box-vba", "title": "reference file path from text box vba", "body": "<p>I am trying to reference the file path of an excel book that is in a text box in my code. </p>\n\n<p>Below is what I tried but I get an error saying </p>\n\n<blockquote>\n  <p>\"subscript out of range\". </p>\n</blockquote>\n\n<p>The problem I'm having is with lines such as <code>Workbooks.Open (txtOutput.text)</code></p>\n\n<pre><code>Private Sub cmdRun_Click() \n Dim countx As Integer \ncountx = Workbooks(txtFilePath.Text).Worksheets.Count\nWorkbooks.Open (txtOutput.Text) \nFor I = 1 To countx\n\nWorkbooks(txtFilePath.Text).Worksheets(I).range(txtRange.Text).CopyPicture xlScreen, xlBitmap\nWorkbooks(txtFilePath.Text).Worksheets(I).Paste\nDestination = Workbooks(txtOutput.Text).Worksheets(\"Sheet1\").Cells(30 * I + 1, \"A\") \nNext I \nWorkbooks(txtOutput.Text).Worksheets(\"Sheet1\").Pictures.Select Selection.ShapeRange.ScaleWidth 0.4, msoFalse, msoScaleFromTopLeft \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1445437804, "post_id": 33262000, "comment_id": 54325171, "body": "Instead of using Worksheets(&quot;Sheet1&quot;) you should use ActiveSheet Propery to know more visit <a href=\"https://msdn.microsoft.com/en-us/library/office/ff822753.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">here</a>"}], "answers": [{"comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 35, "user_id": 5457151, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2c62a9d3b0881d5f60adf5cb2f6e795?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5457151/jonathan"}, "edited": false, "score": 1, "creation_date": 1445438019, "post_id": 33262049, "comment_id": 54325323, "body": "Did you change  <code>XXX.Name</code> =  to <code>sheetXXX.Name =</code> in the third line?"}, {"owner": {"reputation": 35, "user_id": 5457151, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2c62a9d3b0881d5f60adf5cb2f6e795?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5457151/jonathan"}, "edited": false, "score": 0, "creation_date": 1445438081, "post_id": 33262049, "comment_id": 54325364, "body": "It is not the active worksheet, so we have to use ActiveWorkbook.Sheets(&quot;sheetXXX&quot;) But unfortunately, it is not work eihter :/"}, {"owner": {"reputation": 35, "user_id": 5457151, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2c62a9d3b0881d5f60adf5cb2f6e795?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5457151/jonathan"}, "edited": false, "score": 0, "creation_date": 1445438247, "post_id": 33262049, "comment_id": 54325504, "body": "if I change XXX.Name = to sheetXXX.Name = in the third line, the sheet will be rename to the value of B5 instead of sheet &amp; the value of B5. For example if B5=2015,  the sheet have to be rename as sheet2015"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 35, "user_id": 5457151, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2c62a9d3b0881d5f60adf5cb2f6e795?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5457151/jonathan"}, "edited": false, "score": 0, "creation_date": 1445438368, "post_id": 33262049, "comment_id": 54325605, "body": "See edit to my answer.  You can add the word sheet in front of the value.  = &quot;Sheet&quot; &amp; Worksheets(&quot;Sheet1&quot;).Range(&quot;B5&quot;).Value"}], "tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": true, "score": 1, "last_activity_date": 1445438288, "last_edit_date": 1445438288, "creation_date": 1445437708, "answer_id": 33262049, "question_id": 33262000, "link": "https://stackoverflow.com/questions/33262000/vba-rename-sheet-based-on-cell-value/33262049#33262049", "title": "VBA rename sheet based on cell value", "body": "<p>You have to set the object = to the actual worksheet to be renamed.</p>\n\n<pre><code>Sub tabname()\n    Dim sheetXXX As Worksheet\n    Set sheetXXX = ActiveWorkbook.Sheets(\"sheetXXX\")\n    sheetXXX.Name = \"Sheet\" &amp; Worksheets(\"Sheet1\").Range(\"B5\").Value\nEnd Sub\n</code></pre>\n\n<p>If sheetXXX is meant to be the active worksheet you would do this.</p>\n\n<pre><code>Sub tabname()\n    Dim sheetXXX As Worksheet\n    Set sheetXXX = ActiveWorkbook.Activesheet\n    sheetXXX.Name = \"Sheet\" &amp; Worksheets(\"Sheet1\").Range(\"B5\").Value\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 5457151, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2c62a9d3b0881d5f60adf5cb2f6e795?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5457151/jonathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16943, "favorite_count": 1, "accepted_answer_id": 33262049, "answer_count": 1, "score": 1, "last_activity_date": 1445438288, "creation_date": 1445437595, "last_edit_date": 1531164843, "question_id": 33262000, "link": "https://stackoverflow.com/questions/33262000/vba-rename-sheet-based-on-cell-value", "title": "VBA rename sheet based on cell value", "body": "<p>I want a VBA code that rename my sheetXXX, where XXX is the value in the cell B5 in \u201cSheet1\u201d sheet. The macro should work for any value in B5.</p>\n\n<p>I tried the following code:</p>\n\n<pre><code>Sub tabname()\n    Dim sheetXXX As Worksheet\n    XXX.Name = Worksheets(\"Sheet1\").Range(\"B5\").Value\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "dictionary", "data-structures", "treemap"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1445445355, "post_id": 33261665, "comment_id": 54330508, "body": "Are you asking if there is a way to implement trees in VBA without using dictionaries? If so, there is a nice book, &quot;VBA Developer&#39;s Hanbook&quot; by Getz and Gilbert (out of print but easily purchased  used through Amazon) which has a chapter devoted to implementing dynamic data structures using classes. The book is a treasure-trove of VBA knowledge and definitely worth picking up (whether or not it turns out to be useful for your specific question)."}, {"owner": {"reputation": 73, "user_id": 5169445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d8e7ef7ceae74fc3cb2a9ad91dc006?s=128&d=identicon&r=PG&f=1", "display_name": "ga56mor", "link": "https://stackoverflow.com/users/5169445/ga56mor"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1445517984, "post_id": 33261665, "comment_id": 54363082, "body": "My question is if there is already a implement tree object in VBA and if not what is the best way to implement one. Thanks for the tip !"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1445518798, "post_id": 33261665, "comment_id": 54363578, "body": "VBA is a fairly old language and doesn&#39;t come equipped with many built-in data structures. Collections can be used somewhat like dynamic arrays and you already know about dictionaries. Other than that, it is pretty much roll your own. You don&#39;t need classes to use dictionaries as trees, although I suspect that using dictionaries of dictionaries of dictionaries ... is not the most memory-efficient way to store data."}], "owner": {"reputation": 73, "user_id": 5169445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d8e7ef7ceae74fc3cb2a9ad91dc006?s=128&d=identicon&r=PG&f=1", "display_name": "ga56mor", "link": "https://stackoverflow.com/users/5169445/ga56mor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 531, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1445436735, "creation_date": 1445436735, "question_id": 33261665, "link": "https://stackoverflow.com/questions/33261665/tree-map-equivalent-in-vba", "title": "Tree map equivalent in VBA", "body": "<p>I would like to know if there is a build-in tree map object in VBA beside the binary one.</p>\n\n<p>Right now I am using 4 nested Dictionaries (from the scripting DLL),\neach one declared in separated classes.</p>\n\n<pre><code>Classe A\nPrivate dicA As Dictionary\n'can do stuff with dicA\n'dicA contains String as Key and Class B object as Value\n\nClasse B\n\nPrivate dicB As Dictionary\n'can do stuff with dicB\n''dicB contains String as Key and Class C object as Value\n\nClasse C\n\nPrivate dicC As Dictionary\n'can do stuff with dicB\n''dicC contains String as Key and Class D object as Value\n\nClasse D\n\nPrivate dicD As Dictionary\n'can do stuff with dicD\n'dicD contains String as Key and String as Value\n</code></pre>\n\n<p>To sum up, Classe D objects are child node from Class C objects, Class C objects are child node of Class B objects, ect...</p>\n\n<p>I would just like to know if there is a better way to get this sort of datastructure in VBA.</p>\n\n<p>thanks in advance.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 505, "user_id": 4983280, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1cdfa48482a093d4c9855b274aa98dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Mark harris", "link": "https://stackoverflow.com/users/4983280/mark-harris"}, "edited": false, "score": 0, "creation_date": 1445438791, "post_id": 33262411, "comment_id": 54325904, "body": "thanks for your suggestion, however I tried this and it doesn&#39;t seem to do anything?"}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "reply_to_user": {"reputation": 505, "user_id": 4983280, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1cdfa48482a093d4c9855b274aa98dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Mark harris", "link": "https://stackoverflow.com/users/4983280/mark-harris"}, "edited": false, "score": 1, "creation_date": 1445438869, "post_id": 33262411, "comment_id": 54325980, "body": "I tested it on my machine and it worked fine. What do you mean it didn&#39;t do anything? Was olMail Nothing? Did you get an error? Is there an open email? Did it have &quot;test&quot; in the subject?"}, {"owner": {"reputation": 505, "user_id": 4983280, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1cdfa48482a093d4c9855b274aa98dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Mark harris", "link": "https://stackoverflow.com/users/4983280/mark-harris"}, "edited": false, "score": 0, "creation_date": 1445438964, "post_id": 33262411, "comment_id": 54326063, "body": "The code doesn&#39;t appear to do anything, there&#39;s no error, nothing happens physically. The email has test in the subject title, and the email may not necessarily be open hence why i need any code to work of selected email rather than opened email. Are you sure this code can be executed from excel? as I am attempting to execute the code from excel"}, {"owner": {"reputation": 505, "user_id": 4983280, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1cdfa48482a093d4c9855b274aa98dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Mark harris", "link": "https://stackoverflow.com/users/4983280/mark-harris"}, "edited": false, "score": 0, "creation_date": 1445439095, "post_id": 33262411, "comment_id": 54326159, "body": "Ok apologies, I see that the code does work once the user opens the email. however, is there a way to make this code work based on the email being selected? as my user may not always open their email?"}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "reply_to_user": {"reputation": 505, "user_id": 4983280, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1cdfa48482a093d4c9855b274aa98dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Mark harris", "link": "https://stackoverflow.com/users/4983280/mark-harris"}, "edited": false, "score": 0, "creation_date": 1445440184, "post_id": 33262411, "comment_id": 54327008, "body": "Ok, I didn&#39;t read your question carefully enough. I&#39;ve adjusted the code to look for an open email or a selected email."}], "tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": true, "score": 3, "last_activity_date": 1445440129, "last_edit_date": 1445440129, "creation_date": 1445438660, "answer_id": 33262411, "question_id": 33261598, "link": "https://stackoverflow.com/questions/33261598/display-email-body-of-selected-email-in-outlook-as-a-message-box-in-excel/33262411#33262411", "title": "display email body of selected email in outlook as a message box in excel?", "body": "<p>You can use the <code>Application.ActiveInsepctor</code> property to get the opened email or use the <code>Application.ActiveExplorer</code> property to get a selected, but unopened, email</p>\n\n<pre><code>Sub GetFromInbox()\n\n    Dim olApp As Outlook.Application\n    Dim olMail As Outlook.MailItem\n\n    Set olApp = New Outlook.Application\n\n    'If it's not an MailItem or there's no\n    'ActiveInspector, error is ignored\n    On Error Resume Next\n        Set olMail = olApp.ActiveInspector.CurrentItem\n    On Error GoTo 0\n\n    'If nothing is open, see if a MailItem is selected\n    If olMail Is Nothing Then\n        On Error Resume Next\n            Set olMail = olApp.ActiveExplorer.Selection.Item(1)\n        On Error GoTo 0\n    End If\n\n    If Not olMail Is Nothing Then\n        If InStr(olMail.Subject, \"Test\") &gt; 0 Then\n            MsgBox olMail.Body\n        Else\n            MsgBox \"Selected/active email does not have correct subject\"\n        End If\n    Else\n        MsgBox \"Active item is not an email or no email selected\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>First, it looks for the active, opened item. If that's not an email, then it looks at the first selected item in whatever \"Explorer\" is active. If that's not an email, then it gives you a message.</p>\n\n<p>If the open, active item is an email, it uses that and tests the subject. In that case it doesn't look at any selected items. Only if there's nothing open or the open item is not a Mailitem (like it's a CalendarItem), does it look at what's selected.</p>\n\n<p>If you're in, say, the calendar, then that's the active explorer and it's likely that any selection is not a MailItem. It also doesn't care if you're in the Inbox of another folder. It only cares if the first item selected is a MailItem. You could check <code>olapp.ActiveExplorer.CurrentFolder</code> to make sure you're in the Inbox if that's important to you.</p>\n\n<p>You can have Items in your mail folders that are not MailItems. If it's not a MailItem that's selected, then you'll get a message.</p>\n\n<p>Finally, you can select any number of items in your Inbox. This only looks at the first items selected. If you want to process all the items, you can look through them using <code>.Selection.Count</code> and <code>.Selection.Item(i)</code> to process each one in turn.</p>\n"}], "owner": {"reputation": 505, "user_id": 4983280, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1cdfa48482a093d4c9855b274aa98dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Mark harris", "link": "https://stackoverflow.com/users/4983280/mark-harris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3057, "favorite_count": 0, "accepted_answer_id": 33262411, "answer_count": 1, "score": 2, "last_activity_date": 1445440129, "creation_date": 1445436570, "question_id": 33261598, "link": "https://stackoverflow.com/questions/33261598/display-email-body-of-selected-email-in-outlook-as-a-message-box-in-excel", "title": "display email body of selected email in outlook as a message box in excel?", "body": "<p>I am using excel 2010 and have created the following vba code which finds emails which contain the word test in their subject heading and then in excel it shows a message box with the body of that email:</p>\n\n<pre><code>Sub GetFromInbox()\n\n    Dim olApp As Outlook.Application\n    Dim olNs As Outlook.Namespace\n    Dim olFldr As Outlook.MAPIFolder\n    Dim olItms As Outlook.Items\n    Dim olMail As Variant\n    Dim i As Long\n\n    Set olApp = New Outlook.Application\n    Set olNs = olApp.GetNamespace(\"MAPI\")\n    Set olFldr = olNs.GetDefaultFolder(olFolderInbox)\n    Set olItms = olFldr.Items\n    Set objItem = olApp.ActiveExplorer.Selection.Item(1)\n\n\n    olItms.Sort \"Subject\"\n\n    i = 1\n\n    For Each olMail In olItms\n     If InStr(olMail.Subject, \"Test\") &gt; 0 Then\n            MsgBox olMail.Body\n            i = i + 1\n        End If\n    Next olMail\n\n    Set olFldr = Nothing\n    Set olNs = Nothing\n    Set olApp = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>My ultimate aim here is to add more if conditions to the code, so that only the currently selected email or opened email in outlook has its email body displayed in my excel message box</p>\n\n<p>An example of this is say we have several emails with the subject \"test\" as it currently stands the code will show the body of all these emails which have the subject \"test\" one after another in a different message box.</p>\n\n<p>But there should only ever be one message box displayed for the currently selected/opened email in outlook if that emails subject is \"test\".</p>\n\n<p>Please can someone show me how I can do this? </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": true, "score": 2, "last_activity_date": 1445436724, "last_edit_date": 1445436724, "creation_date": 1445436404, "answer_id": 33261541, "question_id": 33261441, "link": "https://stackoverflow.com/questions/33261441/how-to-detect-when-optional-byref-parameter-was-not-passed/33261541#33261541", "title": "How to detect when optional ByRef parameter was not passed", "body": "<p>Try <code>is nothing</code></p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim ws As Excel.Worksheet\n    Set ws = ActiveWorkbook.Sheets(\"sheet1\")\n\n    'Call the sub both ways.\n    SetValue \"a\"\n    SetValue \"a\", ws\nEnd sub\n\nPublic Sub SetValue(Key As String, Optional ByRef ws As Worksheet)\n    If ws Is Nothing Then\n        'We got a sheet\n        MsgBox \"We got no sheet\"\n    End If\n\n    If Not ws Is Nothing Then\n        'We got a sheet\n        MsgBox ws.name\n        MsgBox \"We got a sheet\"\n    End If\nEnd sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1445613038, "post_id": 33263922, "comment_id": 54410295, "body": "+1 because this answer is better, cannot work with a ws empty later on. I usualy set it by default to <code>activesheet</code> for sub&#39;s/functions supposed to work anywhere."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5412293"}, "reply_to_user": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1445613346, "post_id": 33263922, "comment_id": 54410510, "body": "Same here Patrick I always set my optional sheet to Activesheet and I ensure it works everywhere."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5412293"}, "is_accepted": false, "score": 1, "last_activity_date": 1445442991, "creation_date": 1445442991, "answer_id": 33263922, "question_id": 33261441, "link": "https://stackoverflow.com/questions/33261441/how-to-detect-when-optional-byref-parameter-was-not-passed/33263922#33263922", "title": "How to detect when optional ByRef parameter was not passed", "body": "<p>The construction Is Nothing will work. I use it in all my parameters. </p>\n\n<pre><code>Public Sub SetValue(ByRef Key As String, _\n                    Optional ByRef ws As Worksheet = Nothing)\n\n    'Make sure we have the object\n    If ws Is Nothing Then\n        Set ws = ThisWorkbook.Sheets(SheetName)\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Hope this helps. :) </p>\n"}], "owner": {"reputation": 27294, "user_id": 535967, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/02c46fb58177c19c7a1b57f670bddbd1?s=128&d=identicon&r=PG", "display_name": "lisovaccaro", "link": "https://stackoverflow.com/users/535967/lisovaccaro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1286, "favorite_count": 0, "accepted_answer_id": 33261541, "answer_count": 2, "score": 1, "last_activity_date": 1445442991, "creation_date": 1445436155, "question_id": 33261441, "link": "https://stackoverflow.com/questions/33261441/how-to-detect-when-optional-byref-parameter-was-not-passed", "title": "How to detect when optional ByRef parameter was not passed", "body": "<p>I'm trying to detect whether an opational parameter was passed but for some reason all the usual functions (IsMissing()/IsEmpty()/IsNull()) always return false.</p>\n\n<p>This is what I'm trying:</p>\n\n<pre><code>Public Sub SetValue(Key As String, Optional ByRef ws As Worksheet)\n    If IsMissing(ws) Or IsEmpty(ws) Or IsNull(ws) Then\n        ws = ThisWorkbook.Sheets(SheetName)\n    End If\n</code></pre>\n\n<p>I also tried setting the ws to Nothing or Null but the result was the same:</p>\n\n<pre><code>Public Sub SetValue(Key As String, Optional ByRef ws As Worksheet = Nothing)\n    If IsMissing(ws) Or IsEmpty(ws) Or IsNull(ws) Then\n        ws = ThisWorkbook.Sheets(SheetName)\n    End If\n</code></pre>\n\n<p>Any idea why this might be happenning?</p>\n"}, {"tags": ["c#", "asp.net", "vba", "reporting-services", "ssrs-2008-r2"], "answers": [{"comments": [{"owner": {"reputation": 653, "user_id": 3581526, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/31lGf.png?s=128&g=1", "display_name": "Nickso", "link": "https://stackoverflow.com/users/3581526/nickso"}, "edited": false, "score": 0, "creation_date": 1445438102, "post_id": 33261923, "comment_id": 54325383, "body": "For that to work I would have to do the following: <code>=IIF(IsNothing(Lookup(Fields!Student.Value,Fields!Student.Va&zwnj;&#8203;lue,Fields!Student.V&zwnj;&#8203;alue,&quot;Dataset1&quot;))=Fa&zwnj;&#8203;lse,&quot;0&quot;,&quot;1&quot;)</code>  As IsNothing returns a boolean, but is not exactly what Im looking for.   Remember, the lookup will compare rows that exist on each Dataset. What I want to do is to put a 0 in that expression if the row does not exist for that Student"}, {"owner": {"reputation": 653, "user_id": 3581526, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/31lGf.png?s=128&g=1", "display_name": "Nickso", "link": "https://stackoverflow.com/users/3581526/nickso"}, "edited": false, "score": 0, "creation_date": 1445443594, "post_id": 33261923, "comment_id": 54329414, "body": "I forgot to mention this have a group, so the lookup should be outside this group to work"}, {"owner": {"reputation": 653, "user_id": 3581526, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/31lGf.png?s=128&g=1", "display_name": "Nickso", "link": "https://stackoverflow.com/users/3581526/nickso"}, "edited": false, "score": 0, "creation_date": 1445448869, "post_id": 33261923, "comment_id": 54332563, "body": "Do you know if it is possible to pass the value of a field to a variable in my custom code?"}, {"owner": {"reputation": 3811, "user_id": 201021, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/Nh4FP.png?s=128&g=1", "display_name": "Mike D.", "link": "https://stackoverflow.com/users/201021/mike-d"}, "reply_to_user": {"reputation": 653, "user_id": 3581526, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/31lGf.png?s=128&g=1", "display_name": "Nickso", "link": "https://stackoverflow.com/users/3581526/nickso"}, "edited": false, "score": 0, "creation_date": 1445480131, "post_id": 33261923, "comment_id": 54345618, "body": "You shouldn&#39;t need to use custom code, but you can pass field values to custom functions. (That would be a separate SO question though.) See my update with the walk-through of how the lookup function works. I think the bit you&#39;re missing is that both tables need to come from DataSet1 because it has all of the rows you&#39;re looking for in DataSet2. You use the Lookup function from Table2 to find if the row exists or not and display the data you&#39;re looking for."}], "tags": [], "owner": {"reputation": 3811, "user_id": 201021, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/Nh4FP.png?s=128&g=1", "display_name": "Mike D.", "link": "https://stackoverflow.com/users/201021/mike-d"}, "is_accepted": true, "score": 2, "last_activity_date": 1445480035, "last_edit_date": 1445480035, "creation_date": 1445437369, "answer_id": 33261923, "question_id": 33261382, "link": "https://stackoverflow.com/questions/33261382/expression-that-compares-two-datasets-with-different-amount-of-rows/33261923#33261923", "title": "Expression that compares two Datasets with different amount of rows", "body": "<p>The <code>Lookup()</code> function returns <code>Nothing</code> if there is no match. It shouldn't give you an error, but you can check for nothing and return 0 in that case. I think you're just comparing against the wrong thing in your <code>IIF</code> expression.</p>\n\n<pre><code>=IIF(\n    IsNothing(Lookup(Fields!Student.Value, Fields!Student.Value, Fields!Student.Value, \"Dataset1\")),\n    0,\n    Lookup(Fields!Student.Value, Fields!Student.Value, Fields!Student.Value, \"Dataset1\")\n)\n</code></pre>\n\n<p>Unless you really want to only show a 1 when the lookup works. In which case:</p>\n\n<pre><code>=IIF(\n    IsNothing(Lookup(Fields!Student.Value, Fields!Student.Value, Fields!Student.Value, \"Dataset1\")),\n    0,\n    1\n)\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <h2>Return</h2>\n  \n  <p>Returns a Variant, or Nothing if there is no match.</p>\n</blockquote>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/ee210531.aspx\" rel=\"nofollow noreferrer\">Lookup Function (Report Builder and SSRS)</a></p>\n\n<hr>\n\n<h2>Walk-through</h2>\n\n<p>I'm going to do this a bit differently than what exactly you're trying to accomplish so you can see what is going on with the lookup function.</p>\n\n<p>First I've created two simple data sets that each contain a list of IDs and labels. The second data set is only a subset of the first (some rows are missing but all rows in DataSet2 exist in DataSet1).</p>\n\n<p><strong>DataSet1</strong></p>\n\n<pre><code> id  |  label\n-----+-----------\n  1  |  Student1-a\n  2  |  Student2-a\n  3  |  Student3-a\n  4  |  Student4-a\n...\n 25  |  Student25-a\n</code></pre>\n\n<p><strong>DataSet2</strong></p>\n\n<pre><code> id  |  label\n-----+-----------\n  1  |  Student1-b\n  5  |  Student5-b\n 10  |  Student10-b\n 12  |  Student12-b\n...\n 25  |  Student25-b\n</code></pre>\n\n<p>Then I create two tablix on the report. Both of the tablix have the datasource set to <strong>DataSet1</strong> because that contains the rows I will be checking DataSet2 for using the lookup.</p>\n\n<p><a href=\"https://i.stack.imgur.com/5zVSA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5zVSA.png\" alt=\"tablix datasource configuration\"></a></p>\n\n<p>I set the first tablix to just display the ID and label in the two columns. The second tablix displays the ID (from DataSet1) and uses an expression to look that ID up in DataSet2 and display a 0 if it doesn't exist and show the label from dataset2 if it does.</p>\n\n<p><a href=\"https://i.stack.imgur.com/h6Plp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/h6Plp.png\" alt=\"tablix layout configuration\"></a></p>\n\n<p>The expression I've used is:</p>\n\n<pre><code>=IIF(\n    IsNothing(Lookup(Fields!id.Value, Fields!id.Value, Fields!label.Value, \"DataSet2\")),\n    0,\n    Lookup(Fields!id.Value, Fields!id.Value, Fields!label.Value, \"DataSet2\")\n)\n</code></pre>\n\n<p>The output I get is this, notice how all of the rows appear in the second tablix (because it is fed with the dataset that contains all of the rows) but the <code>label</code> column shows a 0 when the row doesn't exist in dataset2.</p>\n\n<p><a href=\"https://i.stack.imgur.com/oIaEG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oIaEG.png\" alt=\"output of tablixes\"></a></p>\n"}], "owner": {"reputation": 653, "user_id": 3581526, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/31lGf.png?s=128&g=1", "display_name": "Nickso", "link": "https://stackoverflow.com/users/3581526/nickso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1044, "favorite_count": 0, "accepted_answer_id": 33261923, "answer_count": 1, "score": 1, "last_activity_date": 1445480035, "creation_date": 1445435995, "last_edit_date": 1445439378, "question_id": 33261382, "link": "https://stackoverflow.com/questions/33261382/expression-that-compares-two-datasets-with-different-amount-of-rows", "title": "Expression that compares two Datasets with different amount of rows", "body": "<p>I have two Datasets,</p>\n\n<p>These two Datasets have different amount of rows.</p>\n\n<p>I have two Tablix. Each Tablix point to these two different Datasets</p>\n\n<p>In one column I want to compare both DataSets row by row.</p>\n\n<p>So the Idea of what I want is this:\n<a href=\"https://i.stack.imgur.com/y19FY.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/y19FY.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>These are my two Tablix with my Datasets, as you can see Student number 10,15 and 23 does not exist on Dataset2.</p>\n\n<p>When this happens I want to write a 0.</p>\n\n<p>If I use a Lookup expression it will give me an error as it compares the rows that exists for each Datasets:</p>\n\n<pre><code>=IIF(Fields!Student.Value &lt;&gt; Lookup(Fields!Student.Value,Fields!Student.Value,Fields!Student.Value,\"Dataset1\"),\"0\",\"1\")\n</code></pre>\n\n<p>That expression will give me an error.</p>\n\n<p>The idea (I think) is to persist the Student 21 and compare for each student on Dataset 1 and when they are equal write 1 and 0 while they are not equal but for each row.</p>\n\n<p>I cant touch the Datasets, I mean the queries.</p>\n\n<p>Let me know if you need more info.</p>\n\n<p>EDIT:\nTo give you more info, what I want to do is to replicate what my code behind in my web application does in the Data Layer:</p>\n\n<pre><code>            ReportsDataSet.MyDatasetRow drSchool = (ReportsDataSet.MyDatasetRow)repDset.MyDataset.Rows[0];\n            string Student = drSchool.Student;\n            bool firstone = true;\n            bool hayApproved = false;\n            bool hayNotApproved = false;\n            bool hayNeedMoreStudy = false;\n            bool hayFail = false;\n            bool hayG5 = false;\n            bool hayNC = false;\n\n            if (repDset.MyDataset.Rows.Count &gt; 0)\n            {\n                int Count = repDset.MyDataset.Rows.Count;\n\n                for (int i = 0; i &lt; Count; i++)\n                {\n                    ReportsDataSet.MyDatasetRow dr = (ReportsDataSet.MyDatasetRow)repDset.MyDataset.Rows[i];\n\n                    if (dr.tipo.Trim() == \"TOTAL\" &amp;&amp; firstone)\n                    {\n                        Student = dr.Student;\n                        firstone = false;\n\n                        switch (dr.categoria.Trim())\n                        {\n                            case \"Approved\":\n                                hayApproved = true;\n                                break;\n                            case \"NotApproved\":\n                                hayNotApproved = true;\n                                break;\n                            case \"NeedMoreStudy\":\n                                hayNeedMoreStudy = true;\n                                break;\n                            case \"Fail\":\n                                hayFail = true;\n                                break;\n                            case \"G5\":\n                                hayG5 = true;\n                                break;\n                            case \"N/C\":\n                                hayNC = true;\n                                break;\n                        }\n                    }\n                    else\n                    {\n                        if (dr.tipo.Trim() == \"TOTAL\" &amp;&amp; dr.Student == Student)\n                        {\n                            switch (dr.categoria.Trim())\n                            {\n                                case \"Approved\":\n                                    hayApproved = true;\n                                    break;\n                                case \"NotApproved\":\n                                    hayNotApproved = true;\n                                    break;\n                                case \"NeedMoreStudy\":\n                                    hayNeedMoreStudy = true;\n                                    break;\n                                case \"Fail\":\n                                    hayFail = true;\n                                    break;\n                                case \"G5\":\n                                    hayG5 = true;\n                                    break;\n                                case \"N/C\":\n                                    hayNC = true;\n                                    break;\n                            }\n                        }\n                    }\n\n                    if (dr.Student != Student || i == (Count-1) )\n                    {\n                        if (!hayApproved)\n                        {\n                            repDset.MyDataset.AddMyDatasetRow(Student, \"Approved\", \"TOTAL\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\");\n                            Alreadyfilled++;\n                        }\n\n                        if (!hayNotApproved)\n                        {\n                            repDset.MyDataset.AddMyDatasetRow(Student, \"NotApproved\", \"TOTAL\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\");\n                            Alreadyfilled++;\n                        }\n\n                        if (!hayNeedMoreStudy)\n                        {\n                            repDset.MyDataset.AddMyDatasetRow(Student, \"NeedMoreStudy\", \"TOTAL\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\");\n                            Alreadyfilled++;\n                        }\n\n                        if (!hayFail)\n                        {\n                            repDset.MyDataset.AddMyDatasetRow(Student, \"Fail\", \"TOTAL\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\");\n                            Alreadyfilled++;\n                        }\n\n                        if (!hayG5)\n                        {\n                            repDset.MyDataset.AddMyDatasetRow(Student, \"G5\", \"TOTAL\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\");\n                            Alreadyfilled++;\n                        }\n\n                        if (!hayNC)\n                        {\n                            repDset.MyDataset.AddMyDatasetRow(Student, \"N/C\", \"TOTAL\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\");\n                            Alreadyfilled++;\n                        }\n\n                        if (!hayApproved &amp;&amp; !hayNotApproved &amp;&amp; !hayNeedMoreStudy &amp;&amp; !hayFail &amp;&amp; !hayG5 &amp;&amp; !hayNC)\n                        {\n                            repDset.MyDataset.AddMyDatasetRow(Student, \"TOTAL\", \"TOTAL\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\");\n                            Alreadyfilled++;\n                        }\n\n                        repDset.MyDataset.AcceptChanges();\n\n                        hayApproved = false;\n                        hayNotApproved = false;\n                        hayNeedMoreStudy = false;\n                        hayFail = false;\n                        hayG5 = false;\n                        hayNC = false;\n                        firstone = true;\n\n                        if (i != (Count - 1))\n                        {\n                            Student = dr.Student;\n                            i--;\n                        }\n                    }\n                }\n            }\n</code></pre>\n\n<p>EDIT 2:</p>\n\n<p>Let me give you more Info:\n<a href=\"https://i.stack.imgur.com/Cqnxx.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Cqnxx.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/OjRxY.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OjRxY.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/V8FRR.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/V8FRR.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>As you can see in the last image, Student 11, 16 etc does not exist on Dataset 2 in those cases I have to put \"0\".\nBut what Im doing with Lookup is comparing 21 with 11,21 with 11 again,22 with 11 and so on. And thats not the point, the point is to put 0 for each time the Student that exists in Dataset1 does not in Dataset2.</p>\n\n<p>It should be something like, I save the value of the Student in Dataset 2 and compare for each Student on Dataset1, when they are not equal, put 0 when they are equal, put 1. </p>\n\n<p>A Function maybe? save all the students of Dataset1 on a list and Students of Dataset2 on another lists and compare them on a foreach inside a custom code?</p>\n"}, {"tags": ["excel", "web-scraping", "html-tableextract", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1445435202, "post_id": 33260734, "comment_id": 54323095, "body": "<a href=\"http://www.jpsoftwaretech.com/an-exploration-of-ie-browser-methods-part-ii/\" rel=\"nofollow noreferrer\">JPs IE Automation Tips</a> have helped tremendously in exploring how to scrape data from webpages in VBA. There is code in there to loop through elements which you can then use <code>debug.print</code> to figure out which one you need."}, {"owner": {"reputation": 306, "user_id": 1308367, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/02ccc9e3fbc87fcb34e048149b88d208?s=128&d=identicon&r=PG", "display_name": "Rick Henderson", "link": "https://stackoverflow.com/users/1308367/rick-henderson"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1456025124, "post_id": 33260734, "comment_id": 58753226, "body": "@ScottHoltzman The link you provide no longer works. Is there another source for it?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 306, "user_id": 1308367, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/02ccc9e3fbc87fcb34e048149b88d208?s=128&d=identicon&r=PG", "display_name": "Rick Henderson", "link": "https://stackoverflow.com/users/1308367/rick-henderson"}, "edited": false, "score": 0, "creation_date": 1456148593, "post_id": 33260734, "comment_id": 58798278, "body": "@RickHenderson - Yes, that website has been taken down. There are plenty of resources on the web if you search a bit."}], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 0, "last_activity_date": 1445436343, "creation_date": 1445436343, "answer_id": 33261524, "question_id": 33260734, "link": "https://stackoverflow.com/questions/33260734/vba-web-scraping/33261524#33261524", "title": "VBA web scraping", "body": "<p>I was able to do some trial and error and to get the correct reference this way:</p>\n\n<pre><code>Dim eTR As Object, cTR As Object, I as Integer 'I used object, because I did late binding\nSet cTR = Doc.getElementsByTagName(\"tr\")\n\ni = 0\n\nFor Each eTR In cTR\n\n    If Left(eTR.innerText, 3) = \"Com\" Then\n\n        Debug.Print \"(\" &amp; i; \"): \" &amp; eTR.innerText\n\n    End If\n\n    i = i + 1\n\nNext\n</code></pre>\n\n<p>The immediate window then displayed</p>\n\n<blockquote>\n  <p>(308): Common Stocks ... (a bunch of space) ...\n  $5,941$5,877$5,773$3,779</p>\n</blockquote>\n\n<p>I then tested this statement:</p>\n\n<pre><code>sd = Doc.getElementsByTagName(\"tr\")(308).innerText\nDebug.Print sd\n</code></pre>\n\n<p>And got the same result.</p>\n"}], "owner": {"reputation": 33, "user_id": 5471571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b75b07441617dffdb54a2ff7594b66c8?s=128&d=identicon&r=PG&f=1", "display_name": "Default001", "link": "https://stackoverflow.com/users/5471571/default001"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 342, "favorite_count": 0, "accepted_answer_id": 33261524, "answer_count": 1, "score": 0, "last_activity_date": 1445436343, "creation_date": 1445434356, "last_edit_date": 1531164843, "question_id": 33260734, "link": "https://stackoverflow.com/questions/33260734/vba-web-scraping", "title": "VBA web scraping", "body": "<p>I am trying to get a row of data from this table on this website: <a href=\"http://www.nasdaq.com/symbol/neog/financials?query=balance-sheet\" rel=\"nofollow\">http://www.nasdaq.com/symbol/neog/financials?query=balance-sheet</a> </p>\n\n<p>Now I can manage to get the \"total liabilities\" row using the </p>\n\n<pre><code>doc.getelementsbyclassname(\"net\")(3).innertext \n</code></pre>\n\n<p>but I cannot figure out how to get any other rows of data such as common stock. </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Target.Row = Range(\"bscode\").Row And _\nTarget.Column = Range(\"bscode\").Column Then\nDim IE As New InternetExplorer\nIE.Visible = True\nIE.navigate \"http://www.nasdaq.com/symbol/\" &amp; Range(\"bscode\").Value &amp; \"/financials?query=balance-sheet&amp;data=quarterly\"\n\nDo\n DoEvents\n\nLoop Until IE.readyState = READYSTATE_COMPLETE\n\nDim Doc As HTMLDocument\nSet Doc = IE.document\nDim sD As String\nsD = Doc.getElementsByTagName(\"tr\")(8).innerText\n\nMsgBox sD\n\nDim aD As Variant\naD = Split(sD, \"$\")\nRange(\"bs\").Value = aD(1)\nRange(\"ba\").Value = aD(2)\nRange(\"bb\").Value = aD(3)\nRange(\"bc\").Value = aD(4)\n\nEnd If\nEnd Sub\n</code></pre>\n\n<p>If it helps, I have the HTML source and the tr highlighted that I want to grab.</p>\n\n<p><a href=\"http://i.stack.imgur.com/5fjqI.jpg\" rel=\"nofollow\">screenshot of HTML code</a> </p>\n\n<p>The issue is the method of finding the table row data. Could someone please explain to me how to get other rows of data? It would be much appreciated ! </p>\n"}, {"tags": ["excel", "vba", "csv", "parameter-passing"], "comments": [{"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1445434457, "post_id": 33260604, "comment_id": 54322561, "body": "Can you show us the code you are trying?"}, {"owner": {"reputation": 1, "user_id": 5471618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9q4Jp.png?s=128&g=1", "display_name": "Dashboarder", "link": "https://stackoverflow.com/users/5471618/dashboarder"}, "reply_to_user": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1445440643, "post_id": 33260604, "comment_id": 54327366, "body": "How do I add the code in?"}, {"owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1445440654, "post_id": 33260604, "comment_id": 54327375, "body": "Maybe some sample filenames and data to demonstrate the issue.  I was following you for a good while there but then got lost.  Regading adding code, just edit your question and post the code (and hopefully some DATA)"}, {"owner": {"reputation": 1, "user_id": 5471618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9q4Jp.png?s=128&g=1", "display_name": "Dashboarder", "link": "https://stackoverflow.com/users/5471618/dashboarder"}, "edited": false, "score": 0, "creation_date": 1445441534, "post_id": 33260604, "comment_id": 54328024, "body": "How do I append a spreadsheet with the data?"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1445442059, "post_id": 33260604, "comment_id": 54328370, "body": "You may want to start by reading this: <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\" title=\"how to avoid using select in excel vba macros\">stackoverflow.com/questions/10714251/&hellip;</a>. I can&#39;t tell for sure, but it likely has something to do with all the <code>.Select</code> and <code>.Activate</code> in the code."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1445444600, "post_id": 33260604, "comment_id": 54330047, "body": "Which workbooks are Sheet1 and Sheet2 in ?"}, {"owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1445445344, "post_id": 33260604, "comment_id": 54330496, "body": "Are you married to doing in this in Excel/VBA?  It seems like you are using Excel as a means to do stuff with the content, but since they are all CSV I, for one, would be more inclined to use other tools that might be better suited to manage these tasks.  Can you store the data in a database?  Even something like SQLite might yield huge benefits, or you can go to more robust tools like SQL Server Express or MySQL."}, {"owner": {"reputation": 1, "user_id": 5471618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9q4Jp.png?s=128&g=1", "display_name": "Dashboarder", "link": "https://stackoverflow.com/users/5471618/dashboarder"}, "edited": false, "score": 0, "creation_date": 1445445348, "post_id": 33260604, "comment_id": 54330498, "body": "They are in the same Workbook: Sheet1 is the raw .csv data, Sheet2 is the destination for the amended columns."}, {"owner": {"reputation": 1, "user_id": 5471618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9q4Jp.png?s=128&g=1", "display_name": "Dashboarder", "link": "https://stackoverflow.com/users/5471618/dashboarder"}, "reply_to_user": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1445445550, "post_id": 33260604, "comment_id": 54330632, "body": "@Hambone, For the time being, this is what we have.  The final table is pivotted in many ways for reporting on the parameters, and has been used as the single source of data for many subsequent reports.  The maintenance information (pre and post sample) is tracked within as are a number of operational parameters that are manipulated in Excel (charting oil pressures etc).  There may indeed be better ways, but these units will be with us for another 10 years, and the data goes back to 2008 in the file."}, {"owner": {"reputation": 1, "user_id": 5471618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9q4Jp.png?s=128&g=1", "display_name": "Dashboarder", "link": "https://stackoverflow.com/users/5471618/dashboarder"}, "edited": false, "score": 0, "creation_date": 1445445667, "post_id": 33260604, "comment_id": 54330696, "body": "Am I not passing the correct information for the file?  Insomuch as I can open it with the file name, do I need to pass the path with it in order to address the sheets?"}, {"owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1445445740, "post_id": 33260604, "comment_id": 54330748, "body": "Dashboarder -- I hear you loud and clear, but it&#39;s not an either-or.  Once in an RDBMS, the data is easily mined and reported out via MS Query, which is built into Excel, and I think you will marvel at the increased visibility/flexibility/capability you have once in a database.  I understand the resistance, but I think if you were to successfully go down this path you would kick yourself for not doing it sooner"}, {"owner": {"reputation": 1, "user_id": 5471618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9q4Jp.png?s=128&g=1", "display_name": "Dashboarder", "link": "https://stackoverflow.com/users/5471618/dashboarder"}, "reply_to_user": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1445527359, "post_id": 33260604, "comment_id": 54369545, "body": "@Hambone.  Thanks for the encouragement, and I agree, and it may be the way to go.  But, right now the objective is get the report working again to meet the mandate for monthly reports (behind by a couple of months).  Then I can add it to the list of things to do.  Sadly, the reality is we are just jumping from the fire to the frying pan and back again, and development time is at a premium."}, {"owner": {"reputation": 1, "user_id": 5471618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9q4Jp.png?s=128&g=1", "display_name": "Dashboarder", "link": "https://stackoverflow.com/users/5471618/dashboarder"}, "reply_to_user": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1464723082, "post_id": 33260604, "comment_id": 62596975, "body": "@Hambone, I have again been denied access to acquire the applications or training to import and process this information as a Database.  I am constrained to use Excel as the limited database that it is.  I concur there are many things I could do with SQL.  The real issue remains however that the data is dynamic over time and there is much work to be done just monitoring and fixing defects (iferror statements everywhere) when they show up."}, {"owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1470193638, "post_id": 33260604, "comment_id": 64843203, "body": "That&#39;s crazy, man...  there are tools out there that do the heavy lifting for you, and they are FREE.  And they integrate with Excel beautifully.  You really like this employer, right?  Yes, you can do this in Excel/VBA.  I&#39;m sure of it.  It just seems like a monumental task for what a DB does out of the box.  Again, I know it&#39;s out of your hands, but I have to shake my head.  One last stab...  SQLite?  Your management doesn&#39;t even have to know."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5471618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9q4Jp.png?s=128&g=1", "display_name": "Dashboarder", "link": "https://stackoverflow.com/users/5471618/dashboarder"}, "edited": false, "score": 0, "creation_date": 1445452571, "post_id": 33264716, "comment_id": 54334658, "body": "Thank you Tim, your code is indeed elegant, and efficient, but the issue I added in my answer remains.  The Sheet2.Range(&quot;...&quot;) steps fail in the execution, as they are Sheets specified outside of the Workbook that is running the VBA code."}, {"owner": {"reputation": 1, "user_id": 5471618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9q4Jp.png?s=128&g=1", "display_name": "Dashboarder", "link": "https://stackoverflow.com/users/5471618/dashboarder"}, "edited": false, "score": 0, "creation_date": 1445452932, "post_id": 33264716, "comment_id": 54334876, "body": "It is infuriating, as I can see the sheet CodeName in the properties page, and it appears just like every other Workbook.  I will experiment with the other Worksheet call protocols.  The advantage of the first sheet in the CSV is that it is the name of the file &quot;bookname&quot;, and then the added sheet becomes &quot;Sheet1&quot;.  Perhaps there is hope yet!"}, {"owner": {"reputation": 1, "user_id": 5471618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9q4Jp.png?s=128&g=1", "display_name": "Dashboarder", "link": "https://stackoverflow.com/users/5471618/dashboarder"}, "edited": false, "score": 0, "creation_date": 1445527405, "post_id": 33264716, "comment_id": 54369581, "body": "Success!!!   Changed the sheet references to: wbSrc.Sheets(booknamelesscsv) for the &quot;.csv&quot; file data opening Sheet (Sheet1), and to wbSrc.Sheets(&quot;Sheet1&quot;).Range(&quot;A1&quot;) for the compilation sheet (Sheet2).  Copy and paste away, reformat, and then copy the result to the master workbook, close file, and on to the next."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1445457029, "last_edit_date": 1445457029, "creation_date": 1445445342, "answer_id": 33264716, "question_id": 33260604, "link": "https://stackoverflow.com/questions/33260604/how-do-i-keep-track-of-worksheets-and-workbooks-as-they-pass-between-subroutines/33264716#33264716", "title": "How do I keep track of worksheets and workbooks as they pass between subroutines when .Activation is not working?", "body": "<p>Here's how your code looks \"cleaned up\" - notice there's no need to select/activate anything, and you can use variables to refer to workbooks and worksheets etc.  </p>\n\n<p><strong>EDIT:</strong> completed but untested</p>\n\n<pre><code>Sub CopyPasteOAP(bookname)\n\n    Dim wbMaster As Workbook, wsMaster As Worksheet\n    Dim wbSrc As Workbook, wsSrc As Worksheet, wsNew As Worksheet\n    Dim f As Range, rcopy As Range\n\n    Set wbMaster = ThisWorkbook\n    Set wsMaster = wbMaster.Sheets(1)\n\n    Set wbSrc = Workbooks(bookname)\n    Set wsSrc = wbSrc.Worksheets(1)\n    Set wsNew = wbSrc.Worksheets.Add(after:=wbSrc.Worksheets(1))\n\n    With wsSrc\n        .Range(.Range(\"G1\"), .Range(\"G1\").End(xlDown)).Copy wsNew.Range(\"A1\") 'Date Column\n        .Range(.Range(\"B1\"), .Range(\"B1\").End(xlDown)).Copy wsNew.Range(\"B1\") 'Unit Column\n        .Range(.Range(\"H1\"), .Range(\"H1\").End(xlDown)).Copy wsNew.Range(\"G1\") 'Severity Column\n        .Range(.Range(\"BL1\"), .Range(\"BL1\").End(xlDown)).Copy wsNew.Range(\"M1\") 'Fuel in Oil\n        .Range(.Range(\"BP1\"), .Range(\"BP1\").End(xlDown)).Copy wsNew.Range(\"N1\") 'Coolant in Oil\n    End With\n\n    wsNew.Range(\"C2:C50\").Value = \"OAP\" 'Enter in OAP\n\n    FindAndCopy wsSrc, \"Lab Comments\", wsNew.Range(\"D1\") 'Fault Description = Lab Comments\n    FindAndCopy wsSrc, \"Lab Recommendations\", wsNew.Range(\"L1\") 'Notes = Lab Recommendations\n\n    Set rcopy = wsNew.Range(wsNew.Range(\"A2\"), wsNew.Range(\"A2\").End(xlToRight))\n    Set rcopy = wsNew.Range(rcopy, rcopy.End(xlDown))\n\n    With rcopy.Font\n        .ColorIndex = xlAutomatic\n        .TintAndShade = 0\n    End With\n\n    'copy to first empty row\n    rcopy.Copy wsMaster.Cells(Rows.Count, 2).End(xlUp).Offset(1, 0)\n\n    wbSrc.Close False\n\n\nEnd Sub\n\n\n'utliity sub: find and copy a column if it exists\nSub FindAndCopy(sht As Worksheet, hdr As String, rngDest As Range)\n    Dim f As Range\n    Set f = sht.Cells.Find(What:=hdr, LookIn:=xlValues, LookAt:=xlPart, _\n                  SearchDirection:=xlNext, MatchCase:=False)\n\n    If Not f Is Nothing Then\n        sht.Range(f, f.End(xlDown)).Copy rngDest\n    Else\n        MsgBox hdr &amp; \" not found!\", vbExclamation\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5471618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9q4Jp.png?s=128&g=1", "display_name": "Dashboarder", "link": "https://stackoverflow.com/users/5471618/dashboarder"}, "is_accepted": false, "score": 0, "last_activity_date": 1445527943, "last_edit_date": 1445527943, "creation_date": 1445452078, "answer_id": 33266624, "question_id": 33260604, "link": "https://stackoverflow.com/questions/33260604/how-do-i-keep-track-of-worksheets-and-workbooks-as-they-pass-between-subroutines/33266624#33266624", "title": "How do I keep track of worksheets and workbooks as they pass between subroutines when .Activation is not working?", "body": "<p>After a little more reading, I discovered that I was not allowed to use the CodeName property between Workbooks.  It works within a Workbook to access the Worksheets, but not to activate and select a Worksheet that is outside the Workbook that the VBA code resides in.</p>\n\n<p>I will explore the other options that have been presented, but this at least helps me to stop pulling my hair out trying to figure out what works in one Workbook will not work in another.  Learning the hard way - a lesson I will not soon forget!</p>\n\n<p>Success!!!</p>\n\n<p>Taking the optimized code from Tim, adapted for the .csv case of the first sheet being named the Workbook name.  Dropped the .csv, and then referenced each by the sheet \"name\".  Works perfectly.  Props to Tim for the optimization hints which also allowed for some speed improvements.</p>\n\n<p>Truncated the Workbook Name so it would match the name of the sheet (Sheet1)<p>\n      booknamelesscsv = Left(bookname, Len(bookname) - 4)</p>\n\n<p>Started Routine (referencing the named sheet)<p>\n      With wbSrc.Sheets(booknamelesscsv)</p>\n\n<p>Copied the data from the named sheet to the new sheet \"Sheet1\" (Sheet2)<p>\n     .Range(.Range(\"G1\"), .Range(\"G1\").End(xlDown)).Copy    wbSrc.Sheets(\"Sheet1\").Range(\"A1\")</p>\n\n<p>All is now working.  Data imported, formulas formulating, reports reporting.</p>\n\n<p>Thank you.</p>\n"}], "owner": {"reputation": 1, "user_id": 5471618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9q4Jp.png?s=128&g=1", "display_name": "Dashboarder", "link": "https://stackoverflow.com/users/5471618/dashboarder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1445527943, "creation_date": 1445434023, "last_edit_date": 1445446227, "question_id": 33260604, "link": "https://stackoverflow.com/questions/33260604/how-do-i-keep-track-of-worksheets-and-workbooks-as-they-pass-between-subroutines", "title": "How do I keep track of worksheets and workbooks as they pass between subroutines when .Activation is not working?", "body": "<p>Background:</p>\n\n<p>Daily oil analysis reports from the lab come in and are stripped from e-mails into a folder.  Saved in a folder by date, each sample dispatch may be between 1 and 20 samples, not every date, but any time of the day.  The <code>*.csv</code> files are stored in a dated folder, and the files are saved with their date and time.  That part I have deconstructed from the VBA script I inherited.</p>\n\n<p>These files are ignored until the end month (there is a parallel <code>.pdf</code> report that we use for immediate action for the results), when they are rolled up into a monthly / continuous report for longer term trend analysis (each engine sampled only shows up once every two months or so).  Problem appears that the lab has changed the <code>.csv</code> report.  </p>\n\n<p>The original script took columns that appeared in regular well defined (as in fixed columns).  The new report has dynamic columns (as in: if no data for any sample, no column).  Worse, they have changed the order of the columns when they do present.  The automated roll up report, which used to walk through each dated folder, extract each file, and append it to the master workbook has ceased to have meaning with the garbage data.</p>\n\n<p>The easy solution, I feel, is to rebuild the data in each sample file, by rebuilding and reformatting the columns in a new sheet (searching for the column header, error capture if not present, copy and paste, reformat / do unit conversions etc.), and then copying that new sheet into the master, save and close the file, and repeat with the next one.</p>\n\n<p>The issue I have is that when I pass file names, to the subroutine that opens the new file, every sheet that gets added is in the master file, and the subsequent cut an paste operations are failing (subscripts out of range, or my favorite 400).  I am calling every book by the dated name, and every page by the Sheet designation, but the looped repeated activations have me getting lost.</p>\n\n<p>I think I am referencing the sheets incorrectly based on the passed names.  There must be an easier way.  All other examples seem to have fixed names (if only life were that simple).</p>\n\n<p>Update 1: \nForgot to mention that I prototyped the spreadsheet build in one of the files, and then tried to transfer it into here as a sub-routine.  Fell apart there.  I have cleaned up much of the inherited code and economized the spaghetti, but this is my first attempt at manipulating another worksheet in another workbook from within the original calling one.  Again, most examples used fixed names, which are not an option here.</p>\n\n<pre><code>Sub CopyPasteOAP(bookname)\n\n    Dim datarow As Long\n\n    'Grabs index of last data entered to prevent overwrite\n    ThisWorkbook.Activate\n    Sheet1.Range(\"B2\").Activate\n    Range(\"B2\").End(xlDown).Select\n    datarow = ActiveCell.Row\n\n    'Restructures the Data Columns into a new worksheet for copying\n    Workbooks(bookname).Activate\n    Worksheet.Add\n\n    'Date Column\n    Sheet1.Range(\"G1\").Select\n        Range(Selection, Selection.End(xlDown)).Select\n        Selection.Copy\n    Sheets.Select Sheet2\n        Range(\"A1\").Select\n        ActiveSheet.Paste\n    'Unit Column\n    Sheets.Select Sheet1\n        Range(\"B1\").Select\n        Range(Selection, Selection.End(xlDown)).Select\n        Selection.Copy\n    Sheets.Select Sheet2\n        Range(\"B1\").Select\n        ActiveSheet.Paste\n    'Enter in OAP\n    Sheets.Select Sheet2\n        Range(\"C1\").Select\n        ActiveCell.FormulaR1C1 = \"OAP\"\n        Selection.Copy\n        Range(\"C2:C50\").Select\n        ActiveSheet.Paste\n    'Fault Description = Lab Comments\n    Sheets.Select Sheet1\n        Cells.Find(What:=\"Lab Comments\", After:=ActiveCell, LookIn:=xlFormulas, _\n            LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n            MatchCase:=False, SearchFormat:=False).Activate\n        Range(Selection, Selection.End(xlDown)).Select\n        Selection.Copy\n    Sheets.Select Sheet2\n        Range(\"D1\").Select\n        ActiveSheet.Paste\n    'Severity Column\n    Sheets.Select Sheet1\n        Range(\"H1\").Select\n        Range(Selection, Selection.End(xlDown)).Select\n        Selection.Copy\n    Sheets.Select Sheet2\n        Range(\"G1\").Select\n        ActiveSheet.Paste\n    'Notes = Lab Recommendations\n    Sheets.Select Sheet1\n        Cells.Find(What:=\"Lab Recommendations\", After:=ActiveCell, LookIn:=xlFormulas, _\n            LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n            MatchCase:=False, SearchFormat:=False).Activate\n        Range(Selection, Selection.End(xlDown)).Select\n        Selection.Copy\n    Sheets.Select Sheet2\n        Range(\"L1\").Select\n        ActiveSheet.Paste\n    'Fuel in Oil\n    Sheets.Select Sheet1\n        Range(\"BL1\").Select\n        Range(Selection, Selection.End(xlDown)).Select\n        Selection.Copy\n    Sheets.Select Sheet2\n        Range(\"M1\").Select\n        ActiveSheet.Paste\n    'Coolant in Oil\n    Sheets.Select Sheet1\n        Range(\"BP1\").Select\n        Range(Selection, Selection.End(xlDown)).Select\n        Selection.Copy\n    Sheets.Select Sheet2\n        Range(\"N1\").Select\n        ActiveSheet.Paste\n    Sheets.Select Sheet1\n\n    'Copies from the new sheet\n    'Application.Workbooks(bookname).Activate\n    Sheets.Select Sheet1\n    Range(\"A2\").Select\n    Range(Selection, Selection.End(xlToRight)).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Copy\n\n    'Pastes to the master copy\n    Application.ThisWorkbook.Activate\n    Sheet1.Range(\"A\" &amp; datarow + 1).Select\n\n    'Paste Special, Match Destination Format\n    Selection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _\n        SkipBlanks:=False, Transpose:=False\n\n    'Adjusts Font (otherwise new is all neon green)\n    With Selection.Font\n        .ColorIndex = xlAutomatic\n        .TintAndShade = 0\n    End With\n\n    'Clears Clipboard because the prompt is annoying\n    Application.CutCopyMode = False\n\n    Application.Workbooks(bookname).Activate\n    ActiveWorkbook.Close False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops", "for-loop"], "comments": [{"owner": {"reputation": 22785, "user_id": 3215948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mRU0y.jpg?s=128&g=1", "display_name": "Racil Hilan", "link": "https://stackoverflow.com/users/3215948/racil-hilan"}, "edited": false, "score": 2, "creation_date": 1445433343, "post_id": 33260267, "comment_id": 54321773, "body": "What error are you getting? Do you not have to declare those variables? I mean <code>Dim Y As Integer</code> and <code>Dim X As Integer</code>?"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 22785, "user_id": 3215948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mRU0y.jpg?s=128&g=1", "display_name": "Racil Hilan", "link": "https://stackoverflow.com/users/3215948/racil-hilan"}, "edited": false, "score": 2, "creation_date": 1445433681, "post_id": 33260267, "comment_id": 54322017, "body": "If you are using <code>Option Explicit</code> which you should be, then you do need to declare them.  But @Racil Hilan asked the more important question.  What error are you getting?"}], "answers": [{"comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1445433917, "post_id": 33260413, "comment_id": 54322183, "body": "its worth noting that you may need to declare your variables as type <code>Long</code>. You declared <code>target</code> as <code>Long</code> which is great, especially if the row is greater than ~32,000 (see this:<a href=\"http://stackoverflow.com/questions/10558540/vba-macro-crashes-after-32000-rows\" title=\"vba macro crashes after 32000 rows\">stackoverflow.com/questions/10558540/&hellip;</a>). You will get an <code>Overflow</code> error if the X or Y is too high of a number for an <code>Integer</code> type."}, {"owner": {"reputation": 73, "user_id": 5169445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d8e7ef7ceae74fc3cb2a9ad91dc006?s=128&d=identicon&r=PG&f=1", "display_name": "ga56mor", "link": "https://stackoverflow.com/users/5169445/ga56mor"}, "edited": false, "score": 0, "creation_date": 1445434025, "post_id": 33260413, "comment_id": 54322266, "body": "I though it wasn&#39;t worth mentioning, but for anyone interested : <a href=\"http://stackoverflow.com/questions/26409117/why-use-integer-instead-of-long\" title=\"why use integer instead of long\">stackoverflow.com/questions/26409117/&hellip;</a> , true there is no value in declaring variable as integer, but habits are hard to break =)"}], "tags": [], "owner": {"reputation": 73, "user_id": 5169445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d8e7ef7ceae74fc3cb2a9ad91dc006?s=128&d=identicon&r=PG&f=1", "display_name": "ga56mor", "link": "https://stackoverflow.com/users/5169445/ga56mor"}, "is_accepted": true, "score": 1, "last_activity_date": 1445433716, "last_edit_date": 1445433716, "creation_date": 1445433436, "answer_id": 33260413, "question_id": 33260267, "link": "https://stackoverflow.com/questions/33260267/for-loop-code-compile-errors/33260413#33260413", "title": "For loop code (Compile errors)", "body": "<p>declare your variable as following above your code snippet:</p>\n\n<pre><code>Dim X as Integer\nDim Y as Integer\n</code></pre>\n\n<p>You may also want do activate the workbook where you copy your range before you copy the range, at the next iteration it will copy the Range(\"K\" &amp; X+1) from the Workbook PtchFile </p>\n\n<p>cheers.</p>\n"}], "owner": {"reputation": 321, "user_id": 4915723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b8417efa4b79cbcf3463d38ccfedb7b5?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Bailey", "link": "https://stackoverflow.com/users/4915723/sean-bailey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 33260413, "answer_count": 1, "score": 1, "last_activity_date": 1445433716, "creation_date": 1445433039, "last_edit_date": 1531164843, "question_id": 33260267, "link": "https://stackoverflow.com/questions/33260267/for-loop-code-compile-errors", "title": "For loop code (Compile errors)", "body": "<p>I am doing a simple loop code where I want Y to equal 10 and each time it goes through the loop to +1 i.e. 10,11,12,13</p>\n\n<p>However I am getting compile errors on the variables X and Y if anyone could let me know why this is occuring it would be much appreciated. </p>\n\n<pre><code>Dim targetrow As Long\ntargetrow = ActiveSheet.Range(\"Total\").Offset(-2, 0).Row\n\nY = 10\nFor X = 19 To targetrow Step 1\nIf Range(\"K\" &amp; X) &lt;&gt; \"\" Then\n\nRange(\"K\" &amp; X).Copy\nWorkbooks(PtchFile).Activate\nRange(\"G\" &amp; Y).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n:=False, Transpose:=False\n\nY = Y + 1\nX = X + 1\nElse\nEnd If\nNext X\n</code></pre>\n"}, {"tags": ["sql-server", "vba", "adodb"], "comments": [{"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 1, "creation_date": 1445431863, "post_id": 33259664, "comment_id": 54320653, "body": "There may be some kind of error in the SQL statement. Check the details of the <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251525.aspx\" rel=\"nofollow noreferrer\">Err</a> object within  the <code>CloseConnection</code> label."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 1, "creation_date": 1445432339, "post_id": 33259664, "comment_id": 54321011, "body": "Also keep in mind that you are concatenating a string without any spaces whatsoever. You&#39;ll end up with syntax like this: <code>BEGINDECLARE</code> and <code>DATETIMESELECT</code>."}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 1, "creation_date": 1445432406, "post_id": 33259664, "comment_id": 54321059, "body": "You have <code>on error GoTo CloseConnection</code>, so no error will be reported. Only use error handling if you are going to actually do something with remove the line and discover the real error. Also learn to use the debugger and step through your code."}, {"owner": {"reputation": 5821, "user_id": 3394255, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/1munp.jpg?s=128&g=1", "display_name": "Dave.Gugg", "link": "https://stackoverflow.com/users/3394255/dave-gugg"}, "edited": false, "score": 1, "creation_date": 1445433725, "post_id": 33259664, "comment_id": 54322045, "body": "Try printing your SQL string - you&#39;re missing spaces between words!"}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 1, "creation_date": 1445434554, "post_id": 33259664, "comment_id": 54322616, "body": "And why are you using a while loop for this? There is no need for a while loop to insert data. You should use a set based approach instead."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1445434696, "post_id": 33259664, "comment_id": 54322716, "body": "An unrelated suggestion: Since VBA doesn&#39;t support multiline strings, use the line-continuation character to separate the concatenation into multiple lines. For an example, see <a href=\"http://stackoverflow.com/a/17676050/111794\">here</a>. Alternatively, you could use the <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264844.aspx\" rel=\"nofollow noreferrer\">Array</a> and <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264098.aspx\" rel=\"nofollow noreferrer\">Join</a> functions together with the <code>_</code>: <code>sql = Join(Array(&quot;SELECT *&quot;, _ &quot;FROM tbl1&quot;), vbcrlf)</code> and you won&#39;t have to worry about spaces between the lines."}], "answers": [{"comments": [{"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1445438200, "post_id": 33261428, "comment_id": 54325465, "body": "In general you are correct about SQL injection, but in this specific case there is no danger because the <code>Year</code> variable is typed as an integer. You might want to refine this to <i>concatenating SQL and user string input</i>."}, {"owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "reply_to_user": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1445439345, "post_id": 33261428, "comment_id": 54326356, "body": "@Zev I know, but code tends to get copied and used as a basis for custom extension. Code that sits on StackOverflow doubly so. I said &quot;as a matter of principle&quot; not without reason. Not ever building SQL from concatenating variable input of any kind, user-supplied or not, no exceptions, is a useful habit to get into."}, {"owner": {"reputation": 19, "user_id": 5471454, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/667b899810025cff3b9a86b68077adac?s=128&d=identicon&r=PG&f=1", "display_name": "WvdW", "link": "https://stackoverflow.com/users/5471454/wvdw"}, "edited": false, "score": 0, "creation_date": 1445513892, "post_id": 33261428, "comment_id": 54360539, "body": "@Tomalak Thank you for the help and thanks to the rest of the guys. Reason for me using the while loop because it the only way I can get the month incremented for me to get the first weekday of each month. And the other problem that I kept getting if the query ran was because of the counts in the SQL so added SET NOCOUNT ON and made the whole query a sp."}, {"owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "edited": false, "score": 0, "creation_date": 1445516721, "post_id": 33261428, "comment_id": 54362285, "body": "What&#39;s wrong with using a date range? Why would you loop over every date between X and Y when you simply can insert all records between X and Y in one step?"}], "tags": [], "owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "is_accepted": true, "score": 0, "last_activity_date": 1445436108, "creation_date": 1445436108, "answer_id": 33261428, "question_id": 33259664, "link": "https://stackoverflow.com/questions/33259664/vba-query-returning-no-values/33261428#33261428", "title": "VBA Query returning no values", "body": "<p>You made two mistakes in SQL string construction:</p>\n\n<ul>\n<li>you forgot about the newlines</li>\n<li>you intermix SQL and variables</li>\n</ul>\n\n<p>The first one is easy to fix. I prefer the following approach to create multi-line strings in VBA:</p>\n\n<pre><code>str = Join(Array( _\n    \"line\", _\n    \"line\", _\n    \"line\" _\n), vbNewLine)\n</code></pre>\n\n<p>The second mistake is the main reason for SQL injection vulnerabilities and as a matter of principle you should absolutely never use string concatenation to build variable SQL.</p>\n\n<p>The <code>ADODB.Command</code> object exists for this. It takes a fixed string with <code>?</code> placeholders and separate query parameters. It will combine query and parameters in a such a way that you won't ever need to worry about escaping and have type safety at the same time.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nDim conn As New ADODB.Connection\n\nSub ConnectSqlServer()\n    Dim Server_Name As String\n    Dim Database_Name As String\n    Dim User_ID As String\n    Dim Password As String\n\n    Server_Name = \"******\" ' Enter your server name here\n    Database_Name = \"******\" ' Enter your database name here\n    User_ID = \"*****\" ' enter your user ID here\n    Password = \"*****\" ' Enter your password here\n\n    conn.ConnectionString = \"Provider=SQLNCLI10;Server=\" &amp; Server_Name &amp; \";Database=\" &amp; Database_Name &amp; \";Uid=\" &amp; User_ID &amp; \";Pwd=\" &amp; Password &amp; \";\"\n    conn.Open\nEnd Sub\n\nSub FillSheet()\n    Dim year As Integer\n\n    If conn.State &lt;&gt; adStateOpen Then ConnectSqlServer()\n\n    year = Application.InputBox(\"Enter the Year of choice ?\", Type:=1)\n\n    If year &gt; 0 Then\n        Sheets(\"Sheet3\").Range(\"D4:O4\").CopyFromRecordset GetYear(year)\n    End If\nEnd Sub\n\nFunction GetYear(year As Integer) As ADODB.Recordset\n    ' TODO add a check for \"conn Is Nothing\"\n    ' TODO add a check for \"conn.State &lt;&gt; adStateOpen\"\n    With New ADODB.Command\n        Set .ActiveConnection = conn\n        .ActiveConnection.CursorLocation = adUseClient\n\n        .CommandType = adCmdText\n        .CommandText = Join(Array( _\n            \"DECLARE @Test TABLE (\", _\n                \"ID INT IDENTITY(1, 1),\", _\n                \"Value Float\", _\n            \")\", _\n            \"DECLARE @year INT\", _\n            \"DECLARE @InputDate DATETIME\", _\n            \"DECLARE @MonthStartDate DATETIME\", _\n            \"SET year = ?\", _\n            \"SET @InputDate = CAST(@year + '-01-01' AS DATETIME)\", _\n            \"WHILE @InputDate &lt;= CAST(@year + '-12-01' AS DATETIME)\", _\n            \"BEGIN\", _\n                \"SELECT @MonthStartDate = CAST(DATEADD(dd, - DATEPART(dd, @InputDate) + 1, @InputDate)AS DATETIME)\", _\n                \"INSERT INTO @Test\", _\n                \"SELECT MAX([Value])*2 FROM DataLog2\", _\n                \"WHERE DateAdd(HOUR,2,TimestampUTC) &gt;= @MonthStartDate AND DateAdd(HOUR,2,TimestampUTC) &lt; DATEADD(DAY,1,@MonthStartDate) AND SourceID = 26 AND quantityid = 129\", _\n                \"SET @InputDate = DATEADD(MONTH, 1, @InputDate)\", _\n            \"END\", _\n            \"SELECT Value FROM @Test\" _\n        ), vbNewLine)\n\n        .Parameters.Append .CreateParameter(Type:=adInteger, Value:=year)\n\n        Set GetYear = .Execute ' .Execute() will always return an adLockReadOnly|adOpenForwardOnly RS\n    End With\nEnd Function\n</code></pre>\n\n<p>P.S.: @SeanLange's comment is correct, your SQL should not contain a while loop for the INSERT. You should modify it into a set-based statement.</p>\n"}], "owner": {"reputation": 19, "user_id": 5471454, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/667b899810025cff3b9a86b68077adac?s=128&d=identicon&r=PG&f=1", "display_name": "WvdW", "link": "https://stackoverflow.com/users/5471454/wvdw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 548, "favorite_count": 0, "accepted_answer_id": 33261428, "answer_count": 1, "score": 0, "last_activity_date": 1445436108, "creation_date": 1445431433, "last_edit_date": 1445433776, "question_id": 33259664, "link": "https://stackoverflow.com/questions/33259664/vba-query-returning-no-values", "title": "VBA Query returning no values", "body": "<p>I am trying to connect to an SQL Server and pull certain data with a certain date range, so that the user just adds the year they want to pull and it will get all the data for that year.</p>\n\n<p>The query works in SQL, but as soon as I add it to VBA it pulls nothing. Can someone please help or explain to me why?</p>\n\n<p>At the moment I can connect to the database and my data record works because if I use a smaller query it works fine. </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub ADOExcelSQLServer()\n\n    Dim conn As ADODB.Connection\n\n    Dim Server_Name As String\n    Dim Database_Name As String\n    Dim User_ID As String\n    Dim Password As String\n\n    Dim Data As ADODB.Recordset\n\n    Server_Name = \"******\" ' Enter your server name here\n    Database_Name = \"******\" ' Enter your database name here\n    User_ID = \"*****\" ' enter your user ID here\n    Password = \"*****\" ' Enter your password here\n\n    Set conn = New ADODB.Connection\n    Set Data = New ADODB.Recordset\n\n    conn.ConnectionString = \"Provider=SQLNCLI10;Server=\" &amp; Server_Name &amp; \";Database=\" &amp; Database_Name &amp; \";Uid=\" &amp; User_ID &amp; \";Pwd=\" &amp; Password &amp; \";\"\n\n    conn.Open\n\n    On Error GoTo CloseConnection\n\n    With Data\n    .ActiveConnection = conn\n    .Source = GetYearString\n    .LockType = adLockReadOnly\n    .CursorType = adOpenForwardOnly\n    .Open\n    End With\n\n    Sheets(\"Sheet3\").Range(\"D4:O4\").CopyFromRecordset Data\n\n    On Error GoTo 0\n\n    Data.Close\n\nCloseConnection:\n    conn.Close\n\nEnd Sub\n\nFunction GetYearString() As String\n    Dim Year As Integer\n    Dim SQLString As String\n    Year = Application.InputBox(\"Enter the Year of choice ?\", Type:=1)\n    SQLString = \"DECLARE @Test TABLE\"\n    SQLString = SQLString &amp; \"(\"\n    SQLString = SQLString &amp; \"ID INT IDENTITY(1,1),\"\n    SQLString = SQLString &amp; \"Value Float\"\n    SQLString = SQLString &amp; \")\"\n    SQLString = SQLString &amp; \"DECLARE @InputDate DATETIME\"\n    SQLString = SQLString &amp; \"SET @InputDate = '\" &amp; Year &amp; \"-01-01'\"\n    SQLString = SQLString &amp; \"WHILE @InputDate &lt;= CAST('\" &amp; Year &amp; \"-12-01' AS DATETIME)\"\n    SQLString = SQLString &amp; \"BEGIN\"\n    SQLString = SQLString &amp; \"DECLARE @MonthStartDate DATETIME\"\n    SQLString = SQLString &amp; \"SELECT @MonthStartDate = CAST(DATEADD(dd, - DATEPART(dd, @InputDate) + 1, @InputDate)AS DATETIME)\"\n    SQLString = SQLString &amp; \"INSERT INTO @Test\"\n    SQLString = SQLString &amp; \"SELECT MAX([Value])*2 FROM DataLog2\"\n    SQLString = SQLString &amp; \"WHERE DateAdd(HOUR,2,TimestampUTC) &gt;= @MonthStartDate AND DateAdd(HOUR,2,TimestampUTC) &lt; DATEADD(DAY,1,@MonthStartDate) AND SourceID = 26 AND quantityid = 129\"\n    SQLString = SQLString &amp; \"SET @InputDate = DATEADD(MONTH, 1, @InputDate)\"\n    SQLString = SQLString &amp; \"End\"\n    SQLString = SQLString &amp; \"SELECT Value FROM @Test\"\n    GetYearString = SQLString\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "for-loop", "countif"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1445431010, "post_id": 33259475, "comment_id": 54319985, "body": "Why not just fill your COUNTIF formula down? It only takes a double-click."}, {"owner": {"reputation": 421, "user_id": 5024658, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-md8UhJRxd_g/AAAAAAAAAAI/AAAAAAAAhyg/igUflaP6DH4/photo.jpg?sz=128", "display_name": "Liss", "link": "https://stackoverflow.com/users/5024658/liss"}, "edited": false, "score": 0, "creation_date": 1445432395, "post_id": 33259475, "comment_id": 54321050, "body": "You might want to research this if you need the formula inserted for some reason:  <a href=\"http://stackoverflow.com/questions/7172222/insert-countif-formula-when-you-have-variable-holding-the-value\">link</a>"}, {"owner": {"reputation": 11, "user_id": 4949854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a2ae70befc04afcf2c4d08422ea0208?s=128&d=identicon&r=PG&f=1", "display_name": "Robert John Kennedy", "link": "https://stackoverflow.com/users/4949854/robert-john-kennedy"}, "edited": false, "score": 0, "creation_date": 1445570115, "post_id": 33259475, "comment_id": 54388193, "body": "RORY, you&#39;ve got it, simple enough for me! Sorry for those who spent time to code out a solution... I saw something like <a href=\"http://www.excel-easy.com/vba/loop.html\" rel=\"nofollow noreferrer\">this</a>, I figured the language would be a bit more intuitive. SO, in retrospect Excel is intuitive enough in design to increase the count if to the next row when I apply the count if function to multiple rows in a column. Hence =COUNTIF(D:D,D2) after Control entered, I&#39;m on mac, for multiple rows would itterate the D2 to D3 D4 D5 and so on.   CHEERS!"}], "answers": [{"tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 1, "last_activity_date": 1445433522, "last_edit_date": 1445433522, "creation_date": 1445432057, "answer_id": 33259892, "question_id": 33259475, "link": "https://stackoverflow.com/questions/33259475/countif-in-for-loop/33259892#33259892", "title": "COUNTIF() in &#39;For&#39; loop", "body": "<p>Use Application.WorksheetFunction.CountIf() in your loop.</p>\n\n<pre><code>Private Sub doloop()\n\n    Dim lastRow   As Long\n    Dim d         As Double\n    Dim r         As Range\n    Dim WS        As Excel.Worksheet\n    Dim strValue  As String\n    Dim lRow      As Long\n\n    'Build your worksheet object\n    Set WS = ActiveWorkbook.Sheets(\"sheet1\")\n\n    'Get the last used row in column A\n    lastRow = WS.Cells(WS.Rows.count, \"D\").End(xlUp).Row\n\n    'Build your range object to be searched\n    Set r = WS.Range(\"D1:D\" &amp; lastRow)\n\n    lRow = 1\n    WS.Activate\n\n    'Loop through the rows and do the search\n    Do While lRow &lt;= lastRow\n\n        'First, get the value we will search for from the current row\n        strValue = WS.Range(\"D\" &amp; lRow).Value\n\n        'Return the count from the CountIf() worksheet function\n        d = Application.worksheetFunction.CountIf(r, strValue)\n\n        'Write that value to the current row\n        WS.Range(\"H\" &amp; lRow).Value = d\n\n    lRow = lRow + 1\n    Loop\n\nEnd Sub\n</code></pre>\n\n<p>I believe you are trying to write the value to the cell, that is what the above does. FYI, if you want to put a formula into the cell, here is how that is done. Use this in place of <code>WS.Range(\"H\" &amp; lRow).Value = d</code></p>\n\n<pre><code>WS.Range(\"H\" &amp; lRow).Formula = \"=CountIf(D:D, D\" &amp; lRow &amp; \")\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3044, "user_id": 3546415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2LyTD.png?s=128&g=1", "display_name": "u8it", "link": "https://stackoverflow.com/users/3546415/u8it"}, "is_accepted": false, "score": 0, "last_activity_date": 1445451467, "last_edit_date": 1445451467, "creation_date": 1445451005, "answer_id": 33266341, "question_id": 33259475, "link": "https://stackoverflow.com/questions/33259475/countif-in-for-loop/33266341#33266341", "title": "COUNTIF() in &#39;For&#39; loop", "body": "<p>Sounds like you may want to look into using tables in Excel and capitalizing on their features like filtering and equation autofill.  You may also be interested in using a PivotTable to do something very similar to what you're describing.</p>\n\n<p>If you really want to go about this the programmatic way, I think the solution Matt gives answers your question about how to do this using CountIf. There's a big detriment to using CountIf though, in that it's not very computationally efficient. I don't think the code Matt posted will really be practical for processing the 100K rows mentioned in the OP (Application.ScreenUpdating = false would help some).  Here's an alternative method that's a lot more efficient, but less intuitive, so you'll have to decide what suites your needs and what you feel conformable with. </p>\n\n<pre><code>Sub CountOccurances()\n    'Define Input and Output Ranges\n    'The best way to do this may very from case to case,\n    'So it should be addressed seperately\n    'Right now we'll assume current sheet rows 1-100K as OP specifies\n    Dim RInput, ROutput As Range\n    Set RInput = Range(\"D1:D100000\")\n    Set ROutput = Range(\"E1:E100000\")\n\n    'Define array for housing and processing range values\n    Dim A() As Variant\n    ReDim A(1 To RInput.Rows.Count, 0)\n    'Use Value2 as quicker more accurate value\n    A = RInput.Value2\n\n    'Create dictionary object\n    Set d = CreateObject(\"Scripting.Dictionary\")\n\n    'Loop through array, adding new values and counting values as you go\n    For i = 1 To UBound(A)\n        If d.Exists(A(i, 1)) Then\n            d(A(i, 1)) = d(A(i, 1)) + 1\n        Else\n            d.Add A(i, 1), 1\n        End If\n    Next\n\n    'Overwrite original array values with count of that value\n    For i = 1 To UBound(A)\n        A(i, 1) = d(A(i, 1))\n    Next\n\n    'Write resulting array to output range\n    ROutput = A\nEnd Sub\n</code></pre>\n\n<p>You can also modify this to include the removal of replicates you mentioned. </p>\n\n<pre><code>Sub CountOccurances_PrintOnce()\n    'Define Input and Output Ranges\n    'The best way to do this may very from case to case,\n    'So it should be addressed seperately\n    'Right now we'll assume current sheet rows 1-100K as OP specifies\n    Dim RInput, ROutput As Range\n    Set RInput = Range(\"D1:D100000\")\n    Set ROutput = Range(\"F1:F9\")\n\n    'Define array for housing and processing range values\n    Dim A() As Variant\n    ReDim A(1 To RInput.Rows.Count, 0)\n    'Use Value2 as quicker more accurate value\n    A = RInput.Value2\n\n    'Create dictionary object\n    Set d = CreateObject(\"Scripting.Dictionary\")\n\n    'Loop through array, adding new values and counting values as you go\n    For i = 1 To UBound(A)\n        If d.Exists(A(i, 1)) Then\n            d(A(i, 1)) = d(A(i, 1)) + 1\n        Else\n            d.Add A(i, 1), 1\n        End If\n    Next\n\n\n    'Print results to VBA's immediate window\n    Dim sum As Double\n    For Each K In d.Keys\n        Debug.Print K &amp; \": \" &amp; d(K)\n        sum = sum + d(K)\n    Next\n    Debug.Print \"Total: \" &amp; sum\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4949854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a2ae70befc04afcf2c4d08422ea0208?s=128&d=identicon&r=PG&f=1", "display_name": "Robert John Kennedy", "link": "https://stackoverflow.com/users/4949854/robert-john-kennedy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8190, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1579388500, "creation_date": 1445430905, "last_edit_date": 1445431170, "question_id": 33259475, "link": "https://stackoverflow.com/questions/33259475/countif-in-for-loop", "title": "COUNTIF() in &#39;For&#39; loop", "body": "<p>I have a column with nearly 100k and am trying to determine how many times a value occurs repeatedly in that column. I can do it row by row currently, but this is menial as a programmer, through something like =COUNTIF(D:D,D2). Yet that only returns D2 matches in column D.</p>\n\n<p>I need to iterate through all values of D returning countif, therefore revealing all of the values repetitions in the column. I can remove duplicates later! So I have a dev. button a basic sub, or function (man this is new to me) and something along the lines of the most basic for loop ever. Just getting caught up on how to implement the COUNTIF() to to the loop properly. </p>\n\n<p>Right now I'm looking at:</p>\n\n<pre><code>Sub doloop()\n\nDim i As Integer\ni = 1\n\nDo While i &lt; D.Length\n    Cells(i, 8).Value =CountIf(D:D,D[i])\n    i = i + 1\nLoop\nEnd Sub\n</code></pre>\n\n<p>That code is incorrect obviously but it is where I'm at and may help for anyone more familiar with other languages.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1445431105, "post_id": 33259349, "comment_id": 54320051, "body": "Is it always the same word?"}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 5440357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k2F0O.png?s=128&g=1", "display_name": "Steven Pyle", "link": "https://stackoverflow.com/users/5440357/steven-pyle"}, "is_accepted": false, "score": 0, "last_activity_date": 1445432407, "creation_date": 1445432407, "answer_id": 33260020, "question_id": 33259349, "link": "https://stackoverflow.com/questions/33259349/convert-a-specific-word-within-a-string-to-uppercase/33260020#33260020", "title": "Convert a specific word within a string to uppercase", "body": "<p>You could use VBA's Replace function to switch out part of a string as an uppercase value.  For example:</p>\n\n<p><code>Dim text As String</code></p>\n\n<p><code>text = \"All current sewer pipe is owned by hrsd and not the city.\"</code></p>\n\n<p><code>text = Replace(text, \"hrsd\", UCase(\"hrsd\"))</code></p>\n"}, {"tags": [], "owner": {"reputation": 2090, "user_id": 3230456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86b80866ac0d8165eabbf5679353633?s=128&d=identicon&r=PG&f=1", "display_name": "codersl", "link": "https://stackoverflow.com/users/3230456/codersl"}, "is_accepted": false, "score": 0, "last_activity_date": 1445432972, "creation_date": 1445432972, "answer_id": 33260249, "question_id": 33259349, "link": "https://stackoverflow.com/questions/33259349/convert-a-specific-word-within-a-string-to-uppercase/33260249#33260249", "title": "Convert a specific word within a string to uppercase", "body": "<p>Or just use the <code>Range.Replace</code> method.</p>\n\n<pre><code>Range(\"H2:H3000\").Replace What:=\"hrsd\", Replacement:=\"HRSD\", LookAt:=xlPart\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 5446655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a82a74858fc7f09ac8d31f49caa496d?s=128&d=identicon&r=PG&f=1", "display_name": "Jess-eye-ca", "link": "https://stackoverflow.com/users/5446655/jess-eye-ca"}, "is_accepted": false, "score": 0, "last_activity_date": 1445444791, "creation_date": 1445444791, "answer_id": 33264537, "question_id": 33259349, "link": "https://stackoverflow.com/questions/33259349/convert-a-specific-word-within-a-string-to-uppercase/33264537#33264537", "title": "Convert a specific word within a string to uppercase", "body": "<p>A non-macro solution is to use the Auto Correct to change hrsd to HRSD. This would fix the problem every time the abbreviation comes up.</p>\n\n<ol>\n<li>Navigate to Options>Proofing>Auto Correct Options</li>\n<li>Under \"Replace\" type hrsd and under \"With\" type HRSD, then click\nAdd</li>\n</ol>\n\n<p>Note: auto-correct is computer specific so it will fix the workbook on your computer. But if someone wanted to do the same operation on their computer they would need to change their settings.</p>\n"}], "owner": {"reputation": 1, "user_id": 5471460, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kkFSo.jpg?s=128&g=1", "display_name": "kscottr181", "link": "https://stackoverflow.com/users/5471460/kscottr181"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1445444791, "creation_date": 1445430540, "last_edit_date": 1531161705, "question_id": 33259349, "link": "https://stackoverflow.com/questions/33259349/convert-a-specific-word-within-a-string-to-uppercase", "title": "Convert a specific word within a string to uppercase", "body": "<p>I am using Excel 2010 and need a macro that changes a specific word in a string to Uppercase. e.g. in \"All current sewer pipe is owned by hrsd and not the city.\" <code>hrsd</code> needs to be uppercase <code>HRSD</code>.</p>\n\n<p>The following macro works great for single words, but not for a string:</p>\n\n<pre><code>If Target.Cells.Count &gt; 1 Or Target.HasFormula Then Exit Sub\n\nOn Error Resume Next\nIf Not Intersect(Target, Range(\"H2:H3000\")) Is Nothing Then\n    Application.EnableEvents = False\n    Target = UCase(Target)\n    Application.EnableEvents = True\nEnd If\nOn Error GoTo 0\n</code></pre>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1445430767, "post_id": 33259296, "comment_id": 54319847, "body": "If you&#39;re filtering there should always be one row visible - the header row. You can use that to test if there&#39;s more than one row visible - then resize to 1 row fewer and offset by 1 before copying."}, {"owner": {"reputation": 4321, "user_id": 2377949, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/7s8BI.jpg?s=128&g=1", "display_name": "ruedi", "link": "https://stackoverflow.com/users/2377949/ruedi"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1445431360, "post_id": 33259296, "comment_id": 54320247, "body": "Hi! Unfortunately I have no header row, since the filter is so complex that I programmed it without using the .Sort function."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1445431492, "post_id": 33259296, "comment_id": 54320362, "body": "Then it&#39;s not a filter, it&#39;s a load of manually hidden rows. Filters always require a header row. In that case your code should be able to determine how many rows it left unhidden. What&#39;s the problem with <code>On Error</code>?"}, {"owner": {"reputation": 4321, "user_id": 2377949, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/7s8BI.jpg?s=128&g=1", "display_name": "ruedi", "link": "https://stackoverflow.com/users/2377949/ruedi"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1445432045, "post_id": 33259296, "comment_id": 54320799, "body": "How can I determine how many rows are left unhidden? If rngStart.Rows.SpecialCells(xlCellTypeVisible).Count = 0  still gives me the error mentioned above. I tried to avoide the On Error since I do not want to jump around in the code and just need a value to check. Bust I just wrote a function that does this for me with an error on."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1445432145, "post_id": 33259296, "comment_id": 54320857, "body": "Use <code>On Error Resume Next</code>, assign the visible cells to a <code>Range</code> variable, then <code>On Error Goto 0</code> and then test if the range is <code>Nothing</code>. Since you haven&#39;t posted the code that hid the rows, it&#39;s hard to suggest another way."}], "answers": [{"tags": [], "owner": {"reputation": 4321, "user_id": 2377949, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/7s8BI.jpg?s=128&g=1", "display_name": "ruedi", "link": "https://stackoverflow.com/users/2377949/ruedi"}, "is_accepted": false, "score": 6, "last_activity_date": 1445432547, "last_edit_date": 1445432547, "creation_date": 1445432140, "answer_id": 33259925, "question_id": 33259296, "link": "https://stackoverflow.com/questions/33259296/handle-no-cells-were-found-error-when-filtered-range-is-empty/33259925#33259925", "title": "Handle &quot;No cells were found&quot; error when filtered range is empty", "body": "<p>I stored the solution into a function. Here I use an error on mechamism. </p>\n\n<pre><code>Function errorCatchEmptyFilter(ByRef rngstart As Range) As Boolean\n\nerrorCatchEmptyFilter = False\n\n'here I get an error if there are no cells\n    On Error GoTo hell\n    Set rngFiltered = rngstart.SpecialCells(xlCellTypeVisible)\n\nExit function\n\nhell:\nerrorCatchEmptyFilter = True\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 590, "user_id": 2250595, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/74f417b7aa939eaad4b1afb301487ad4?s=128&d=identicon&r=PG", "display_name": "mauek unak", "link": "https://stackoverflow.com/users/2250595/mauek-unak"}, "is_accepted": false, "score": 1, "last_activity_date": 1445432350, "creation_date": 1445432350, "answer_id": 33259997, "question_id": 33259296, "link": "https://stackoverflow.com/questions/33259296/handle-no-cells-were-found-error-when-filtered-range-is-empty/33259997#33259997", "title": "Handle &quot;No cells were found&quot; error when filtered range is empty", "body": "<p>What I do is I am counting filtered rows :</p>\n\n<pre><code>Sheets(\"Sheet1\").Range(\"A2:Z2\").AutoFilter\nSheets(\"Sheet1\").Range(\"A2:Z2\").AutoFilter Field:=1, Criteria1:=filter1\nIf Sheets(\"Sheet1\").AutoFilter.Range.Columns(4).SpecialCells(xlCellTypeVisible).Count &gt; 1 Then\n</code></pre>\n\n<p>you can change number of column to suits your needs</p>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 10, "last_activity_date": 1445445557, "creation_date": 1445445557, "answer_id": 33264772, "question_id": 33259296, "link": "https://stackoverflow.com/questions/33259296/handle-no-cells-were-found-error-when-filtered-range-is-empty/33264772#33264772", "title": "Handle &quot;No cells were found&quot; error when filtered range is empty", "body": "<pre><code>On Error Resume Next\nSet rngFiltered = rngStart.SpecialCells(xlCellTypeVisible)\nOn Error Goto 0\n\nIf not rngFiltered is Nothing then\n    rngFiltered.Copy\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25, "user_id": 8910598, "user_type": "registered", "profile_image": "https://graph.facebook.com/2092254007670057/picture?type=large", "display_name": "Tomek S", "link": "https://stackoverflow.com/users/8910598/tomek-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1566478401, "last_edit_date": 1566478401, "creation_date": 1566477132, "answer_id": 57609420, "question_id": 33259296, "link": "https://stackoverflow.com/questions/33259296/handle-no-cells-were-found-error-when-filtered-range-is-empty/57609420#57609420", "title": "Handle &quot;No cells were found&quot; error when filtered range is empty", "body": "<p>Got the same problem, but for filtering named table, solved it this way*:</p>\n\n<ol>\n<li>instead of applying several filters, I've added a column at the end of the table, with a formula that would return true for the rows I wanted to have filtered in, false for filtered out.</li>\n<li>Then, I've applied one filter for that true value and added a cell that would count all <code>true</code> values in that column</li>\n<li>in vba, firstly reapply filter for the table then if that counter is greater than 0 do <code>.SpecialCells(xlCellTypeVisible).Copy</code>, else skip to next step (i was doing that in a loop)</li>\n</ol>\n\n<p>*I know that this question is from 2015, but I've ended here in 2019 googling similar problem so I'm leaving my solution.</p>\n"}], "owner": {"reputation": 4321, "user_id": 2377949, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/7s8BI.jpg?s=128&g=1", "display_name": "ruedi", "link": "https://stackoverflow.com/users/2377949/ruedi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22555, "favorite_count": 3, "accepted_answer_id": 33264772, "answer_count": 4, "score": 5, "last_activity_date": 1598636790, "creation_date": 1445430371, "last_edit_date": 1569132513, "question_id": 33259296, "link": "https://stackoverflow.com/questions/33259296/handle-no-cells-were-found-error-when-filtered-range-is-empty", "title": "Handle &quot;No cells were found&quot; error when filtered range is empty", "body": "<p>I do some filtering on a range and copy that filtered range with</p>\n\n<pre><code>myRange.SpecialCells(xlCellTypeVisible).Copy\n</code></pre>\n\n<p>As soon as the filter filters all cases I get</p>\n\n<blockquote>\n  <p>Error 1004 No cells were found</p>\n</blockquote>\n\n<p>I am looking for a way to check (without an <code>On Error</code>) if the filtered range is empty.</p>\n\n<p>I already tried to set a range with <code>lastRow = .Cells(.Rows.Count, ColumnName).End(xlUp).Row</code> and check <code>if lastRow &gt; 0</code> but with this way I also count the filtered (or hidden) row contents. </p>\n\n<p>I also tried</p>\n\n<pre><code>Sub test()\n    Dim rngStart As Range\n    Dim rngFiltered As Range\n\n    Set rngStart = Sheets(1).Range(\"A1:A6\")\n    Set rngFiltered = rngStart.SpecialCells(xlCellTypeVisible).Select\n\n    If rngFiltered.Rows.Count = 0 Then\n        MsgBox (\"No Cases\")\n    Else\n        MsgBox (\"Found Cases\")\n    End If\nEnd Sub\n</code></pre>\n\n<p>But here I get the error \"No cells found\" in the <code>Set rngFiltered</code> line as well.</p>\n\n<p>I have no header row, since the filter is so complex that I programmed it without using the <code>.Sort</code> function</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1445437187, "post_id": 33258483, "comment_id": 54324685, "body": "Your link that gets added to the page - is that in a format that you could just scan those links, then compare to what&#39;s in the folder, and then add anything that&#39;s not a match?"}], "answers": [{"tags": [], "owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "is_accepted": false, "score": 0, "last_activity_date": 1445437211, "creation_date": 1445437211, "answer_id": 33261861, "question_id": 33258483, "link": "https://stackoverflow.com/questions/33258483/add-only-new-hyperlinks-and-order-according-to-filedatetime/33261861#33261861", "title": "Add only new hyperlinks and order according to FileDateTime", "body": "<p>Perhaps something like this will work (or it may give some ideas):</p>\n\n<pre><code>Sub Hyperlink()\n\nDim objFSO As Object, objFolder As Object, objFile As Object, ObjRange As Range\n\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\nSet objFolder = objFSO.GetFolder(\"S:\\Promigen Orders\")\n\nFor Each objFile In objFolder.Files\n\n    ' Find the Object in your list, if it exists.\n    Set ObjRange = Nothing\n    On Error Resume Next\n    Set ObjRange = Range(\"A:A\").Find(What:=objFile.Name, LookIn:=xlValues, LookAt:=xlWhole)\n    On Error GoTo 0\n\n    ' If it does not exist, add it to the list, at the end &amp; create the hyperlink.\n    If ObjRange Is Nothing Then\n        ' The reason I have so many .End(xlDown)'s is because I can't be sure if you have titles or not, and this may effect where the \"last\" cell is\n        Set ObjRange = Range(\"A1\").End(xlDown).End(xlDown).End(xlDown).End(xlUp).Offset(1)\n        ActiveSheet.Hyperlinks.Add Anchor:=ObjRange, Address:=objFile.Path, TextToDisplay:=objFile.Name\n    End If\n\n    ' In either case, update the file date time value.\n    ObjRange.Offset(0, 1).Value = FileDateTime(objFile)\n\nNext objFile\n\n' Sort by Modified Date\nWith ActiveSheet.Sort\n    .SortFields.Clear\n    .SortFields.Add Key:=Range(\"B:B\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n    .SetRange Range(\"A:B\"): .Header = xlYes: .MatchCase = False: .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin: .Apply\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 235, "user_id": 4990837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10152990063981295/picture?type=large", "display_name": "Gray Meiring", "link": "https://stackoverflow.com/users/4990837/gray-meiring"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1445437211, "creation_date": 1445427958, "last_edit_date": 1445429152, "question_id": 33258483, "link": "https://stackoverflow.com/questions/33258483/add-only-new-hyperlinks-and-order-according-to-filedatetime", "title": "Add only new hyperlinks and order according to FileDateTime", "body": "<p>I have the following VBA code:</p>\n\n<pre><code>Sub Hyperlink()\nDim objFSO As Object, objFolder As Object, objFile As Object\nDim i As Integer\n\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\nSet objFolder = objFSO.GetFolder(\"S:\\Promigen Orders\")\ni = 1\n\nFor Each objFile In objFolder.Files\n\nRange(Cells(i + 1, 1), Cells(i + 1, 1)).Select\n\nActiveSheet.Hyperlinks.Add Anchor:=Selection, Address:= _\nobjFile.Path, TextToDisplay:=objFile.Name\n\nRange(Cells(i + 1, 2), Cells(i + 1, 2)) = FileDateTime(objFile)\n\ni = i + 1\nNext objFile\nEnd Sub\n</code></pre>\n\n<p>The code works fine, it locates the folder needed, creates a list down of hyperlinks to that file and then next to each hyperlink it also shows that file's last date modified. </p>\n\n<p>My issue is that every time I run the code, it updates from scratch. What I want it to do is only add NEW files (files that have been placed into the folder after the last time I ran the code). I also want the links to always be in the order of last date modified (oldest to newest down).</p>\n\n<p>In other words, it must only add hyperlinks of files not already on my Excel sheet.</p>\n\n<p>How can my code be edited to perform this?</p>\n"}, {"tags": ["vba", "date"], "answers": [{"tags": [], "owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "is_accepted": false, "score": 0, "last_activity_date": 1445446860, "last_edit_date": 1445446860, "creation_date": 1445446199, "answer_id": 33264954, "question_id": 33258375, "link": "https://stackoverflow.com/questions/33258375/issues-handling-with-dates-in-different-systems-at-vba/33264954#33264954", "title": "Issues handling with dates in different systems at VBA", "body": "<p>If you are using macro,</p>\n\n<p>Use \"Cdate\" to convert values to date. it will convert  different date formats into similar date format. \nIt can be used for comparing two different format dates\nFor Example.</p>\n\n<pre><code>Function MyDate(rng As String)\n  MyDate = CDate(rng)\nEnd Function\n</code></pre>\n\n<p>In excel formula, You can use \"Datevalue\" formula to convert different date formats to similar date format.</p>\n\n<p>Use the below link to read it more</p>\n\n<p><a href=\"http://www.extendoffice.com/documents/excel/1143-excel-convert-number-to-date.html\" rel=\"nofollow\">http://www.extendoffice.com/documents/excel/1143-excel-convert-number-to-date.html</a></p>\n"}], "owner": {"reputation": 741, "user_id": 2682736, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/cabi5.png?s=128&g=1", "display_name": "AndroidDev", "link": "https://stackoverflow.com/users/2682736/androiddev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1445446860, "creation_date": 1445427607, "question_id": 33258375, "link": "https://stackoverflow.com/questions/33258375/issues-handling-with-dates-in-different-systems-at-vba", "title": "Issues handling with dates in different systems at VBA", "body": "<p>I wonder if anyone can give me some guidance concerning dates.</p>\n\n<p>I am working on this form that contains a date in a textbox and spinbutton that adds/subtracts a day from this date.</p>\n\n<p>In my system, the current date format is dd/mm/yyyy. But I noticed that if user has another format, the spin button will not work properly.</p>\n\n<p>My questions</p>\n\n<ol>\n<li><p>Is there any windows api that gets user`s system date format? What about a windows api that changes this format?</p></li>\n<li><p>What is the best way to work on a solution for dates (I have been having lots of troubles when it comes to dates, not just in this application)</p></li>\n<li><p>Any advices regarding dates at different systems will be appreciated.</p></li>\n</ol>\n\n<p>Thank you all</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 224, "user_id": 3383525, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/bINgE.jpg?s=128&g=1", "display_name": "SpaceSteak", "link": "https://stackoverflow.com/users/3383525/spacesteak"}, "edited": false, "score": 0, "creation_date": 1445428135, "post_id": 33258319, "comment_id": 54318117, "body": "Instead of selecting the entire column, you can select A2:BX where X is an int representing the last row. You can setup X with the xlUp function."}, {"owner": {"reputation": 3985, "user_id": 2123120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c507ec2653264e13a83334d21666140d?s=128&d=identicon&r=PG", "display_name": "PriceCheaperton", "link": "https://stackoverflow.com/users/2123120/pricecheaperton"}, "edited": false, "score": 0, "creation_date": 1445431656, "post_id": 33258319, "comment_id": 54320500, "body": "it should be a automated process."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1445428278, "creation_date": 1445428278, "answer_id": 33258571, "question_id": 33258319, "link": "https://stackoverflow.com/questions/33258319/switch-data-from-a-column-to-another-without-swapping-the-headings/33258571#33258571", "title": "Switch data from a column to another without swapping the headings", "body": "<p>Skip the header row</p>\n\n<pre><code>Sub dural()\n   Dim A2 As Range, B2 As Range\n   Set A2 = Range(\"A2:A\" &amp; Rows.Count)\n   Set B2 = Range(\"B2:B\" &amp; Rows.Count)\n\n   v = A2\n   A2.Value = B2.Value\n   B2 = v\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3985, "user_id": 2123120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c507ec2653264e13a83334d21666140d?s=128&d=identicon&r=PG", "display_name": "PriceCheaperton", "link": "https://stackoverflow.com/users/2123120/pricecheaperton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 367, "favorite_count": 0, "accepted_answer_id": 33258571, "answer_count": 1, "score": 1, "last_activity_date": 1445428358, "creation_date": 1445427419, "last_edit_date": 1445428358, "question_id": 33258319, "link": "https://stackoverflow.com/questions/33258319/switch-data-from-a-column-to-another-without-swapping-the-headings", "title": "Switch data from a column to another without swapping the headings", "body": "<p>How do I create an Excel macro to switch the data from a column to another? But I don't want to swap the headings.</p>\n\n<p>Code:</p>\n\n<pre><code>Sub myCode()\nDim r1 As Range\nDim r2 As Range\nDim v As Variant\nSet r1 = Columns(\"A:B\")\nSet r2 = Columns(\"B:B\")\nv = r1.Value\nr1.Value = r2.Value\nr2.Value = v\nEnd Sub\n</code></pre>\n\n<p>My problem is that it swaps the headings too. I just need the data swapped.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "edited": false, "score": 0, "creation_date": 1445427437, "post_id": 33258174, "comment_id": 54317661, "body": "Please provide the sourcecode you tried so far. Imo you should switch to Access if you want to handle this with MS-Office. If it&#39;s a larger database set up a relational database system (Oracle, MSSQL, etc.)"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "edited": false, "score": 0, "creation_date": 1445431470, "post_id": 33258174, "comment_id": 54320346, "body": "@psychicebola Access IS a relational database program. The others you list are servers."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1445435137, "last_edit_date": 1445435137, "creation_date": 1445430540, "answer_id": 33259351, "question_id": 33258174, "link": "https://stackoverflow.com/questions/33258174/code-to-generate-unique-id-with-the-prefix/33259351#33259351", "title": "Code to generate unique ID with the prefix", "body": "<p>There are a variety of ways.  Say you store your customer names in column <strong>A</strong> of some sheet starting in cell <strong>A2</strong>.  Each time you add a customer, add their name to the column <strong>A</strong> list.  To assign a unique customer ID, in cell <strong>B2</strong> enter:</p>\n\n<pre><code>=IF(A2=\"\",\"\",\"CTR\" &amp; ROW()-1)\n</code></pre>\n\n<p>and copy down:</p>\n\n<p><a href=\"https://i.stack.imgur.com/nEvtW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nEvtW.png\" alt=\"enter image description here\"></a></p>\n\n<p>If you want code to make the new ID, then:</p>\n\n<pre><code>Sub dural()\n   Dim LastId As String, NewId As String\n   Dim N As Long\n\n   N = Cells(Rows.Count, \"B\").End(xlUp).Row\n   LastId = Cells(N, \"B\").Value\n   NewId = \"CTW\" &amp; CLng(Mid(LastId, 4)) + 1\n   MsgBox NewId\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/0M1pK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0M1pK.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 77, "user_id": 4768600, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d2a65f7a22db523ca8fbd651be01e011?s=128&d=identicon&r=PG&f=1", "display_name": "Salman Khan", "link": "https://stackoverflow.com/users/4768600/salman-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3614, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1445435137, "creation_date": 1445426998, "last_edit_date": 1445429506, "question_id": 33258174, "link": "https://stackoverflow.com/questions/33258174/code-to-generate-unique-id-with-the-prefix", "title": "Code to generate unique ID with the prefix", "body": "<p>Kindly help me in generating a unique ID with a prefix. I am developing a small project in Excel for storing customers database. I have a UserForm with the text fields in it. I want a code which will generate a unique ID each time when I add a new customer profile with a prefix, say <code>CTR</code>.</p>\n"}, {"tags": ["arrays", "vba", "match"], "comments": [{"owner": {"reputation": 613, "user_id": 2213887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U44UC.png?s=128&g=1", "display_name": "Hugues Paquet Blanchette", "link": "https://stackoverflow.com/users/2213887/hugues-paquet-blanchette"}, "edited": false, "score": 0, "creation_date": 1445430105, "post_id": 33257568, "comment_id": 54319430, "body": "Add: Option Explicit, it will show you than (Inputsheet.Name, DeleteMe.Name &amp; ContactListSheet.Name) need to be declared."}, {"owner": {"reputation": 143, "user_id": 4288062, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/88928ecaf192be3c161243187a4af318?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Koefoed", "link": "https://stackoverflow.com/users/4288062/sebastian-koefoed"}, "reply_to_user": {"reputation": 613, "user_id": 2213887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U44UC.png?s=128&g=1", "display_name": "Hugues Paquet Blanchette", "link": "https://stackoverflow.com/users/2213887/hugues-paquet-blanchette"}, "edited": false, "score": 0, "creation_date": 1445430832, "post_id": 33257568, "comment_id": 54319887, "body": "Option Explicit is already on. Not declaring the sheet names have not given me any issues earlier. I do something wrong with: FirstCurrentArray(1, ColumnCounter).Value"}], "answers": [{"tags": [], "owner": {"reputation": 131, "user_id": 2004053, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/0f19b00ae01bde7f880808ec01fb5659?s=128&d=identicon&r=PG", "display_name": "tsolina", "link": "https://stackoverflow.com/users/2004053/tsolina"}, "is_accepted": false, "score": 0, "last_activity_date": 1445906638, "creation_date": 1445906638, "answer_id": 33358107, "question_id": 33257568, "link": "https://stackoverflow.com/questions/33257568/vba-match-function-with-array/33358107#33358107", "title": "VBA Match Function with Array", "body": "<p>why simple arrayCounters are variants instead longs?</p>\n"}], "owner": {"reputation": 143, "user_id": 4288062, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/88928ecaf192be3c161243187a4af318?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Koefoed", "link": "https://stackoverflow.com/users/4288062/sebastian-koefoed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 218, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1445906638, "creation_date": 1445425168, "last_edit_date": 1445426845, "question_id": 33257568, "link": "https://stackoverflow.com/questions/33257568/vba-match-function-with-array", "title": "VBA Match Function with Array", "body": "<p>when running below code I get \"Object Required\" error on the last line in the code. I cant really figure out why.</p>\n\n<pre><code>Dim FirstCurrentRange As Range\nDim FirstRowCounter As Long\nDim FirstArrayCounter As Variant\nDim FirstCurrentArray() As Variant\n\nDim ColumnCounter As Long\nDim ArrayCounter As Variant\nDim CurrentArray() As Variant\nDim SiteNameMatch As Long\n\nSet FirstCurrentRange = ThisWorkbook.Worksheets(InputSheet.Name).ListObjects(\"DataTable\").Range\nFirstArrayCounter = 0\n\nFor FirstRowCounter = 2 To FirstCurrentRange.Rows.Count\n    FirstArrayCounter = FirstArrayCounter + 1\n    ReDim Preserve FirstCurrentArray(1, FirstArrayCounter)\n    FirstCurrentArray(1, FirstArrayCounter) = FirstCurrentRange(FirstRowCounter, 4).Value\nNext FirstRowCounter\n\nThisWorkbook.Worksheets(DeleteMe.Name).Range(\"A1:A\" &amp; FirstArrayCounter).Value = Application.WorksheetFunction.Transpose(FirstCurrentArray)\n\nReDim Preserve CurrentArray(2, FirstArrayCounter)\nArrayCounter = 0\n\nFor ColumnCounter = LBound(FirstCurrentArray, 2) To UBound(FirstCurrentArray, 2)\n\nSiteNameMatch = Application.WorksheetFunction.Match(FirstCurrentArray(1, ColumnCounter).Value, ThisWorkbook.Worksheets(ContactListSheet.Name).ListObjects(\"ContactTable\").ListColumns(\"Site\").DataBodyRange, 0)\n</code></pre>\n"}, {"tags": ["excel", "vba", "email", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1445458333, "creation_date": 1445458333, "answer_id": 33268371, "question_id": 33257433, "link": "https://stackoverflow.com/questions/33257433/get-id-number-from-open-active-outlook-email-window-find-it-in-excel-and-take-u/33268371#33268371", "title": "Get ID number from open/active Outlook email/window, find it in Excel and take user to row containing value", "body": "<p>The <code>objItem</code> object represents the selected item in Outlook. If it is not null, then you may look for the ID in the message body. The Outlook object model provides three main ways for working with item bodies:</p>\n\n<ol>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ff865304(v=office.15).aspx\" rel=\"nofollow\">Body</a> -  a string representing the clear-text body of the Outlook item. </li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ff868941(v=office.15).aspx\" rel=\"nofollow\">HTMLBody</a> - a string representing the HTML body of the specified item.</li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ff868196(v=office.15).aspx\" rel=\"nofollow\">Word editor</a> - the Microsoft Word Document Object Model of the message being displayed. The WordEditor property of the Inspector class returns an instance of the Document class from the Word object model which you can use to set up the message body.</li>\n</ol>\n\n<p>You can read more about all these ways in the <a href=\"https://msdn.microsoft.com/en-us/library/dd492012%28v=office.12%29.aspx\" rel=\"nofollow\">Chapter 17: Working with Item Bodies</a>. It us up to you which way is to choose to find the ID.</p>\n\n<p>Then you can automate Excel for opening the mentioned in the mail item file and navigating the line specified in the email. See <a href=\"https://support.microsoft.com/en-us/kb/219151\" rel=\"nofollow\">How to automate Microsoft Excel from Visual Basic</a> for more information. </p>\n\n<p>Finally, you may find the following articles helpful:</p>\n\n<ul>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ee814736%28v=office.14%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">Getting Started with VBA in Outlook 2010</a></li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ee814737%28v=office.14%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">Getting Started with VBA in Excel 2010</a></li>\n</ul>\n"}], "owner": {"reputation": 505, "user_id": 4983280, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1cdfa48482a093d4c9855b274aa98dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Mark harris", "link": "https://stackoverflow.com/users/4983280/mark-harris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 511, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1445458333, "creation_date": 1445424807, "last_edit_date": 1445425461, "question_id": 33257433, "link": "https://stackoverflow.com/questions/33257433/get-id-number-from-open-active-outlook-email-window-find-it-in-excel-and-take-u", "title": "Get ID number from open/active Outlook email/window, find it in Excel and take user to row containing value", "body": "<p>I am including a URL to my spreadsheet in an email like so:</p>\n\n<p>Email:</p>\n\n<pre><code>This is some text\nID: 4\n\nUrl: C:\\mySpreadhseet.xls\n</code></pre>\n\n<p>My spreadsheet:</p>\n\n<pre><code>Row 1    Column A         Column B\nRow 2     ID               \nRow 3     1\nRow 4     2\nRow 5     3\nRow 6     4\n</code></pre>\n\n<p>The user can click the URL in the email which will open my spreadsheet and, on a workbook open event using VBA, I want to add a code which will scan the opened email / active window in outlook for the ID number in the email body, and then in my spreadsheet I want it to scroll to and highlight the row which contains that ID number.</p>\n\n<p>So in this instance the user will be taken to row 6 in my spreadsheet and this entire row will be highlighted.</p>\n\n<p>So far I have been doing some research on how to reference the opened email or active window in Outlook using VBA but I am not sure how I could utilize this to do what I need it to.  </p>\n\n<p>Please can someone point me in the right direction and show me how I might do this?</p>\n\n<p>Researched source to reference active Outlook window:</p>\n\n<pre><code>Set objItem = GetCurrentItem()\n\n\nFunction GetCurrentItem() As Object\n    Dim objApp As Outlook.Application\n\n    Set objApp = Application\n    On Error Resume Next\n    Select Case TypeName(objApp.ActiveWindow)\n        Case \"Explorer\"\n            Set GetCurrentItem = objApp.ActiveExplorer.Selection.Item(1)\n        Case \"Inspector\"\n            Set GetCurrentItem = objApp.ActiveInspector.CurrentItem\n    End Select\n\n    Set objApp = Nothing\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1445425130, "post_id": 33257339, "comment_id": 54316060, "body": "Please can you post the code you are currently using?"}, {"owner": {"reputation": 95, "user_id": 4309559, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8b1e179046348a1cdc73c8e759a4f55?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4309559/chris"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1445425759, "post_id": 33257339, "comment_id": 54316496, "body": "Added to original post"}], "answers": [{"tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": false, "score": 0, "last_activity_date": 1445475001, "last_edit_date": 1445475001, "creation_date": 1445433479, "answer_id": 33260428, "question_id": 33257339, "link": "https://stackoverflow.com/questions/33257339/multiple-checkboxes-in-dropdown-list-for-multiple-cells/33260428#33260428", "title": "Multiple checkboxes in dropdown list for multiple cells", "body": "<p>I think I'd use a <code>Userform</code> if I were doing this.</p>\n\n<p>You can insert one in your editor and make it look like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/YkEMi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YkEMi.png\" alt=\"enter image description here\"></a></p>\n\n<p>I've added a <code>Label</code> and changed its properties as follows:</p>\n\n<ul>\n<li>Name = lblPrompt</li>\n<li>Autosize = true</li>\n<li>Wordwrap = false</li>\n</ul>\n\n<p>I've added a <code>Listbox</code> and changed its properties as follows:</p>\n\n<ul>\n<li>Name = lboxItems</li>\n<li>MultiSelect = 1 - fmMultiSelectMulti</li>\n<li>ListStyle = 1 - fmListStyleOption</li>\n<li>List item = Sheet2!A1:A7 ~> use the range of your own items.</li>\n</ul>\n\n<p>I've added 2 <code>CommandButtons</code> and named them btnOk and btnCanx (and changed their captions to 'OK' and 'Cancel'.</p>\n\n<p>Then in the code for the Userform, I've used:</p>\n\n<pre><code>Option Explicit\nPrivate mCell As Range\nPublic Sub PopUp(user As String, cell As Range)\n    Dim i As Integer\n\n    Set mCell = cell\n    lblPrompt = \"Downloads by \" &amp; user\n    For i = 0 To lboxItems.ListCount - 1\n        lboxItems.Selected(i) = False\n    Next\n    Me.Show\nEnd Sub\n\nPrivate Sub btnCanx_Click()\n    Me.Hide\nEnd Sub\n\nPrivate Sub btnOk_Click()\n    Dim i As Integer\n    Dim itemText As String\n\n    For i = 0 To lboxItems.ListCount - 1\n        If lboxItems.Selected(i) Then\n            If Len(itemText) &gt; 0 Then\n                itemText = itemText &amp; \", \"\n            End If\n            itemText = itemText &amp; lboxItems.List(i)\n        End If\n    Next\n\n    mCell.Value = itemText\n\n    Me.Hide\n\nEnd Sub\n</code></pre>\n\n<p>And, finally, on the <code>Worksheet</code> code behind. I've put:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    Dim cell As Range\n    Dim user As String\n\n    For Each cell In Target.Cells\n        If Not Intersect(cell, Columns(\"K\")) Is Nothing Then\n            user = CStr(cell.Offset(, -10).Value2)\n            UserForm1.PopUp user, cell\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 4309559, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8b1e179046348a1cdc73c8e759a4f55?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4309559/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2178, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1445475001, "creation_date": 1445424547, "last_edit_date": 1445425750, "question_id": 33257339, "link": "https://stackoverflow.com/questions/33257339/multiple-checkboxes-in-dropdown-list-for-multiple-cells", "title": "Multiple checkboxes in dropdown list for multiple cells", "body": "<p>I have a column K that is headed with \"Downloads\". I want to be able to click a cell in column K, then a listbox with checkboxes appears and I select from a list of 7 (which is stored in another sheet) the names of the files that have been downloaded by that user. These are then added to the cell, separated by commas.</p>\n\n<p>The issue I'm having is that each cell in column K needs to be different, so for example, if my list of downloads is \"Item A, Item B, Item C\" etc. and then in K3 I check Item A, then it should display just Item A. However, then if I click K29 and select Item A, B and C, then it should display \"Item A, Item B, Item C\" in that cell.</p>\n\n<p>Here's an example of something I was testing which didn't work as it filled EVERY cell in column K with what I checked. Also, the dropdown was always visible and I only want it visible when a cell is clicked:</p>\n\n<pre><code>Private Sub ListBox1_Change()\n\nDim lngCurrentItem As Long\nDim strCurrentItem As String\nDim strAllSelectedItems As String\nDim rngOutput As Range\n\nSet rngOutput = [K1:K999]\n\nstrAllSelectedItems = \"\"\n\nFor i = 0 To ListBox1.ListCount - 1\n    strCurrentItem = ListBox1.List(i)\n\nIf ListBox1.Selected(i) Then\n    If strAllSelectedItems = \"\" Then\n        strAllSelectedItems = strCurrentItem\n    Else\n        strAllSelectedItems = strAllSelectedItems &amp; \" - \" &amp; strCurrentItem\n    End If\nEnd If\n\nNext i\n\nIf strAllSelectedItems = \"\" Then\nrngOutput = \"No Items Selected\"\nElseIf InStr(1, strAllSelectedItems, \" - \", vbTextCompare) &gt; 0 Then\nrngOutput = strAllSelectedItems &amp; \" Are Selected\"\nElse\n    rngOutput = strAllSelectedItems &amp; \" Is Selected\"\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "edited": false, "score": 0, "creation_date": 1445424064, "post_id": 33256973, "comment_id": 54315387, "body": "Range is wrong, you have selected a cell ie H7,"}], "answers": [{"comments": [{"owner": {"reputation": 374, "user_id": 5298113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ddeb90b5992f09f794ecf95531dcd73?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio Internicola", "link": "https://stackoverflow.com/users/5298113/sergio-internicola"}, "edited": false, "score": 0, "creation_date": 1445428856, "post_id": 33257368, "comment_id": 54318602, "body": "Newjenn&#39;s answer is correct, because xlToRight finds the next non-empty cell from your cell towards right. You must start from the extreme right of the row, and serch the leftmost non-empty column, in order to find the very last non-empty column."}, {"owner": {"reputation": 23, "user_id": 5471064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb8360c87a8548678a211ac59b36b65c?s=128&d=identicon&r=PG&f=1", "display_name": "Rossco Picotrain", "link": "https://stackoverflow.com/users/5471064/rossco-picotrain"}, "edited": false, "score": 0, "creation_date": 1445431088, "post_id": 33257368, "comment_id": 54320038, "body": "There are further columns containing data further right so I&#39;m not looking to find the last column in the enitre sheet. A.S.H has found the issue , i was being a dumbass and using xlRight and not xltoRight"}], "tags": [], "owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "is_accepted": false, "score": 1, "last_activity_date": 1445424613, "creation_date": 1445424613, "answer_id": 33257368, "question_id": 33256973, "link": "https://stackoverflow.com/questions/33256973/lastcol-rangea7-endxlright-column/33257368#33257368", "title": "lastcol =Range(&quot;a7&quot;).End(xlRight).Column", "body": "<p>To find the last column in the first row use the below code</p>\n\n<pre><code>dim lastcolumn as long \n\nlastcolumn = Worksheets(\"Current Month\").Cells(1, Columns.Count).End(xlToLeft).Column\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 5471064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb8360c87a8548678a211ac59b36b65c?s=128&d=identicon&r=PG&f=1", "display_name": "Rossco Picotrain", "link": "https://stackoverflow.com/users/5471064/rossco-picotrain"}, "edited": false, "score": 1, "creation_date": 1445431110, "post_id": 33257432, "comment_id": 54320057, "body": "Cheers for this, I was blind to that!"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 23, "user_id": 5471064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb8360c87a8548678a211ac59b36b65c?s=128&d=identicon&r=PG&f=1", "display_name": "Rossco Picotrain", "link": "https://stackoverflow.com/users/5471064/rossco-picotrain"}, "edited": false, "score": 1, "creation_date": 1445452602, "post_id": 33257432, "comment_id": 54334671, "body": "@RosscoPicotrain These constants&#39; names are pretty much confusing... Cheers :)"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 2, "last_activity_date": 1445424807, "creation_date": 1445424807, "answer_id": 33257432, "question_id": 33256973, "link": "https://stackoverflow.com/questions/33256973/lastcol-rangea7-endxlright-column/33257432#33257432", "title": "lastcol =Range(&quot;a7&quot;).End(xlRight).Column", "body": "<p>Use <code>xlToRight</code> instead of <code>xlRight</code>. These are not the same constant. The <code>End</code> function does not understand the xlRight constant.</p>\n"}], "owner": {"reputation": 23, "user_id": 5471064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb8360c87a8548678a211ac59b36b65c?s=128&d=identicon&r=PG&f=1", "display_name": "Rossco Picotrain", "link": "https://stackoverflow.com/users/5471064/rossco-picotrain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1864, "favorite_count": 0, "accepted_answer_id": 33257432, "answer_count": 2, "score": 2, "last_activity_date": 1445425074, "creation_date": 1445423438, "last_edit_date": 1445425074, "question_id": 33256973, "link": "https://stackoverflow.com/questions/33256973/lastcol-rangea7-endxlright-column", "title": "lastcol =Range(&quot;a7&quot;).End(xlRight).Column", "body": "<p>I'm looking to find the last column in a range with data in it (the width of the range is variable month on month). The formula I am using throws an <em>Application defined or Object defined error</em>. This is the code:</p>\n\n<pre><code>lastcol = Worksheets(\"Current Month\").Range(\"H7\").End(xlRight).Column\n</code></pre>\n\n<p>I'm puzzled as the code below works:</p>\n\n<pre><code>lastrow = Worksheets(\"Current Month\").Range(\"B7\").End(xlDown).Row\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1445423188, "post_id": 33256452, "comment_id": 54314855, "body": "What are you using k for? The whole for loop are useless"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1445423429, "post_id": 33256452, "comment_id": 54314997, "body": "BTW, when defining variable as in <code>Dim a, b As String</code>, <code>As String</code> only applies to b, not to a. If you want a to be a String, you need to repeat <code>Dim a As String, b As String</code>. Same for the Long on the next line."}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1445431518, "post_id": 33256452, "comment_id": 54320395, "body": "How does the &quot;user generate a number&quot;? button click? Your code would be easier to understand if you assigned meaningful variable names"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5448850, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8ds_I4EPuZo/AAAAAAAAAAI/AAAAAAAAAB8/9P-N6rZLehY/photo.jpg?sz=128", "display_name": "mack mishra", "link": "https://stackoverflow.com/users/5448850/mack-mishra"}, "edited": false, "score": 0, "creation_date": 1445427370, "post_id": 33256662, "comment_id": 54317616, "body": "sir, this code is not working properly,if there is possible try to send full code .....for this will thankful to you"}, {"owner": {"reputation": 1, "user_id": 5448850, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8ds_I4EPuZo/AAAAAAAAAAI/AAAAAAAAAB8/9P-N6rZLehY/photo.jpg?sz=128", "display_name": "mack mishra", "link": "https://stackoverflow.com/users/5448850/mack-mishra"}, "edited": false, "score": 0, "creation_date": 1445429993, "post_id": 33256662, "comment_id": 54319351, "body": "what we are getting is that the sequence is generating numbers irrespective of prefix like given below - ABC0000 , ABC0001 , ABC0002 ,GIJ0003 , GIJ0004 , GIJ0005 rather it should be GIJ0000 , GIJ0001 , GIJ0002"}], "tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 0, "last_activity_date": 1445430640, "last_edit_date": 1445430640, "creation_date": 1445422549, "answer_id": 33256662, "question_id": 33256452, "link": "https://stackoverflow.com/questions/33256452/generation-of-sequential-serial-number-based-on-prefix-value/33256662#33256662", "title": "Generation of sequential serial number based on prefix value", "body": "<p>VBA does not seem necessary for this. Assuming you have your prefixes in separate cells in ColumnA starting in Row1, put in B1:  </p>\n\n<pre><code>=A1&amp;TEXT(COUNTIF(A$1:A1,A1)-1,\"0000\")  \n</code></pre>\n\n<p>and double-click its fill handle.  </p>\n\n<p><a href=\"https://i.stack.imgur.com/O4D1H.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/O4D1H.jpg\" alt=\"SO33256452 example\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1445431095, "last_edit_date": 1445431095, "creation_date": 1445429913, "answer_id": 33259131, "question_id": 33256452, "link": "https://stackoverflow.com/questions/33256452/generation-of-sequential-serial-number-based-on-prefix-value/33259131#33259131", "title": "Generation of sequential serial number based on prefix value", "body": "<p>From your code, I assume that you have a ComboBox named ComboBox1, a CommandButton named CommandButton1 and a TextBox named TextBox1, all on a UserForm, and with ComboBox1 filled with the possible values for prefixes.</p>\n\n<p>The following code will put the next available code(1) for the selected prefix into the TextBox.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n        Dim a As String\n        Dim i As Long, j As Long\n        a = ComboBox1.Text\n        i = Application.WorksheetFunction.Match(a &amp; \"9999\", Range(\"A1:A1000\"), 1)\n        j = CLng(Mid$(Cells(i, 1).Value, Len(a) + 1)) + 1\n        TextBox1.Text = a &amp; Format(j, \"0000\")\nEnd Sub\n</code></pre>\n\n<p>Your code is also doing a lot of unnecessary stuff.</p>\n\n<p>(1) only if data is sorted.</p>\n"}], "owner": {"reputation": 1, "user_id": 5448850, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8ds_I4EPuZo/AAAAAAAAAAI/AAAAAAAAAB8/9P-N6rZLehY/photo.jpg?sz=128", "display_name": "mack mishra", "link": "https://stackoverflow.com/users/5448850/mack-mishra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1026, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1445431095, "creation_date": 1445422026, "last_edit_date": 1445422204, "question_id": 33256452, "link": "https://stackoverflow.com/questions/33256452/generation-of-sequential-serial-number-based-on-prefix-value", "title": "Generation of sequential serial number based on prefix value", "body": "<p>We have prefix defined already (say ABC, GIJ, THK, JLK ...so on) and want to create a sequential number when a user wants to generate a number for each of these prefix like given below:</p>\n\n<p>ABC0000 , ABC0001 , ABC0002 ...ABC9999 same for GIJ0000 , GIJ0001 , GIJ0002 ...GIJ9999.</p>\n\n<p>Given below is the code written for the above logic, but it does not achieve the requirement: </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nWith ComboBox1.Value\n\nDim a, b As String\n\nDim i, j, k, l, x, q, m, temp As Long\n\na = ComboBox1.Text\n\ni = Application.WorksheetFunction.Match(a, Range(\"A1:A1000\"), 0)\n\nj = Cells(i, 2)\n\nl = j * 1000\n\nFor q = 2 To 100\n\nFor m = 2 To 100\n\nIf Cells(q, m).Value &lt; 0 Then\n\nk = m\n\nEnd If\n\nNext\n\nNext\n\nx = l\n\nIf Cells(i, GC).Value = temp Then\n\nclick = click + 1\n\nElse\n\nclick = 0\n\nEnd If*\n\nCells(i, GC) = x + click\n\nTextBox1.Text = x + click\n\ntemp = Cells(i, GC).Value\n\nEnd With\n\nGC = GC + 1\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 4321, "user_id": 2377949, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/7s8BI.jpg?s=128&g=1", "display_name": "ruedi", "link": "https://stackoverflow.com/users/2377949/ruedi"}, "edited": false, "score": 0, "creation_date": 1445422198, "post_id": 33256463, "comment_id": 54314240, "body": "Exactly what I was looking for. Thanks a lot!"}], "tags": [], "owner": {"reputation": 5527, "user_id": 4082955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e670bd7627dcaaceead20dfdc02a7589?s=128&d=identicon&r=PG&f=1", "display_name": "Fratyx", "link": "https://stackoverflow.com/users/4082955/fratyx"}, "is_accepted": true, "score": 1, "last_activity_date": 1445422067, "creation_date": 1445422067, "answer_id": 33256463, "question_id": 33256372, "link": "https://stackoverflow.com/questions/33256372/use-find-function-to-search-values-in-formulas/33256463#33256463", "title": "Use Find Function to search values in Formulas", "body": "<p>You have to pass parameter <code>LookIn:=xlValues</code> to the <code>Find</code> function because you are not looking for 19 in the formulas but in the results (=values).</p>\n"}], "owner": {"reputation": 4321, "user_id": 2377949, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/7s8BI.jpg?s=128&g=1", "display_name": "ruedi", "link": "https://stackoverflow.com/users/2377949/ruedi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 33256463, "answer_count": 1, "score": 0, "last_activity_date": 1445425983, "creation_date": 1445421834, "last_edit_date": 1531164843, "question_id": 33256372, "link": "https://stackoverflow.com/questions/33256372/use-find-function-to-search-values-in-formulas", "title": "Use Find Function to search values in Formulas", "body": "<p>In the first column of my excel sheet I have formulas like <code>=Rank(J2; J$2:J$237)</code>. Every result of this is unique. Now I try to find the row of the value 19 using the find function. But whatever I have tried yet <code>myCell</code> is always nothing even though I am sure that 19 exists in column one.</p>\n\n<pre><code>Set myCell = .Range(\"A1:A\" &amp; lastRow).Find(What:=19, lookat:=xlWhole, LookIn:=xlFormulas)\n</code></pre>\n\n<p>Could anyone help me out here and tell me what parameters I have to set to use the find function or if it is even possible. Reading the documentation I thought it would be <code>xlFormulas</code>, but that seems to be wrong.</p>\n"}, {"tags": ["excel", "vba", "sap", "wsh"], "comments": [{"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1445426600, "post_id": 33256214, "comment_id": 54317098, "body": "I think there will be two sessions running simultaneously (export file opens in new one), look for the one with the given Workbook name. Close this workbook/session, then reopen it in the current session."}, {"owner": {"reputation": 11, "user_id": 5470806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04453f4c7fb12d93b1967b84dd37452e?s=128&d=identicon&r=PG&f=1", "display_name": "C. Dan", "link": "https://stackoverflow.com/users/5470806/c-dan"}, "reply_to_user": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1445430858, "post_id": 33256214, "comment_id": 54319905, "body": "Thanks for the answer, but could you explain it to me? I could not close the workbook &quot;export.xlsx&quot; in any way, because it is not open during the runtime, but opens afterwards. Is closing a &quot;session&quot; different?"}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1445504335, "post_id": 33256214, "comment_id": 54354663, "body": "Of course it takes up to a minute for SAP to export it, you could of course wait for it. Technically I&#39;d try hitting <code>Back</code> until I succeed (blocked while the export is going, single thread?) then would <code>Wait</code> two more seconds for the workbook to open."}, {"owner": {"reputation": 8896, "user_id": 9150270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07e89ef7ec2f93f949e76081bd9d1749?s=128&d=identicon&r=PG&f=1", "display_name": "Sandra Rossi", "link": "https://stackoverflow.com/users/9150270/sandra-rossi"}, "edited": false, "score": 0, "creation_date": 1605365684, "post_id": 33256214, "comment_id": 114630350, "body": "It&#39;s possible to work with any Windows application by using <a href=\"https://answers.sap.com/questions/737136/sap-gui-74-patch-12---disallow-excel-auto-open.html\" rel=\"nofollow noreferrer\"><code>GetObject</code></a> (by using either <code>winmgmts:</code> or the Excel file name) or <code>AppActivate</code> with <a href=\"https://stackoverflow.com/questions/59847954/how-can-i-write-sap-gui-script-for-a-sap-pop-up-window\">WScript shell</a>."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 5018991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7462d2c990f32c462a5b6c0047684d7b?s=128&d=identicon&r=PG&f=1", "display_name": "n00bster", "link": "https://stackoverflow.com/users/5018991/n00bster"}, "is_accepted": false, "score": 0, "last_activity_date": 1446457320, "creation_date": 1446457320, "answer_id": 33474657, "question_id": 33256214, "link": "https://stackoverflow.com/questions/33256214/sap-gui-script-opens-an-excel-window-and-i-cant-stop-it/33474657#33474657", "title": "SAP GUI script opens an Excel window and I can&#39;t stop it", "body": "<p>As far as I know, SAP SDK export functions always use a dummy file in order to process exporting of data. This is by so, created via the Auto Open exported file calls. You may try to allow this in order for you to open new exported file after calling refresh() method. See <a href=\"http://rmps.cygnaltech.net/?p=779\" rel=\"nofollow\">http://rmps.cygnaltech.net/?p=779</a></p>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 5604959, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jINnUAJfobw/AAAAAAAAAAI/AAAAAAAAAAA/kSao16ZY6Sg/photo.jpg?sz=128", "display_name": "Joe Messingschlager", "link": "https://stackoverflow.com/users/5604959/joe-messingschlager"}, "is_accepted": false, "score": 0, "last_activity_date": 1561124897, "last_edit_date": 1561124897, "creation_date": 1561123660, "answer_id": 56704430, "question_id": 33256214, "link": "https://stackoverflow.com/questions/33256214/sap-gui-script-opens-an-excel-window-and-i-cant-stop-it/56704430#56704430", "title": "SAP GUI script opens an Excel window and I can&#39;t stop it", "body": "<p>My VBA routines usually do a lot of work after I save the SAP output to Excel format. Like your experience, Excel immediately tries to open the file after the macro completes. I usually go right into post-processing the data in other VBA routines. I discovered that if I do two things in the VBA algorithm, the file isn't opened and the VBA isn't interrupted. Here's what I do:</p>\n\n<ol>\n<li><p>Immediately after I export the file from SAP, I rename the file by concatenating the date and time before the .XLS in the filename. I save that name in the Excel file and open it separately. If your VBA ends after the export, you will get a file not found error in Excel.</p></li>\n<li><p>After the rename, I immediately go on to open the renamed file or to other routines in the VBA, most of the time the open of the can't-be-found filename does not interrupt the VBA processing.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 5604959, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jINnUAJfobw/AAAAAAAAAAI/AAAAAAAAAAA/kSao16ZY6Sg/photo.jpg?sz=128", "display_name": "Joe Messingschlager", "link": "https://stackoverflow.com/users/5604959/joe-messingschlager"}, "is_accepted": false, "score": 0, "last_activity_date": 1615561019, "creation_date": 1615561019, "answer_id": 66602268, "question_id": 33256214, "link": "https://stackoverflow.com/questions/33256214/sap-gui-script-opens-an-excel-window-and-i-cant-stop-it/66602268#66602268", "title": "SAP GUI script opens an Excel window and I can&#39;t stop it", "body": "<p>I figured out a work around, which I observed one time when I ran a VBA with SAP scripting and Excel was too busy to answer SAP's open file request. So, when SAP goes to open the file, it tries to open it in the newest instance of Excel. If your script is running in a spreadsheet in an older instance, SAP will send the open file command to the new one, which means the Excel open error message will show up in the newer separate instance of Excel. Here's how you do it:</p>\n<ol>\n<li>Open your spreadsheet with the macro</li>\n<li>After it opens, hold down the ALT key</li>\n<li>Still holding down ALT, new right mouse the Excel icon in the task bar</li>\n<li>Still holding down ALT, select the Excel icon from the pop up menu</li>\n<li>Still holding down ALT, eventually a message will appear to ask if you want a new instance, answer Yes</li>\n<li>When the green Excel start up message is displayed, release the ALT key Make sure that\nthe new instance is open to a blank spreadsheet</li>\n<li>Now run your macro/script like normal.</li>\n</ol>\n<p>Works like a charm in Excel 365. I have not tested it in older versions. Eventually, you have to go to the new instance of Excel and clear out all the error messages, one by one.</p>\n<p>In addition to this, you may need to keep the new instance from opening the file anyway. I handle this by renaming the SAP export file in the directory immediately after exporting the file. I rename the file by adding a date stamp in the file name. That way I make sure that the new instance does not by chance open the exported file. So, if I'm always exporting to SAP_MMUsers.xlsx, I rename it to SAP_MMUsers_0312.xlsx in VBA coding. So, I'm always exporting to SAP_MMUsers.xlsx and only have to answer the SAP GUI &quot;allow&quot; questions the first time I run the macro/script. The export file name should not exist in the directory, so I don't have to code for the Replace option and I have the output saved with a timestamp if I need to go back and look at the original data. As a point of my process, I always delete any SAP export files in the directory that follow my naming convention for SAP exports (they always begin with &quot;SAP_&quot;). That way the process has some redundancy built in to the VBA code to avoid processing interruptions.</p>\n"}], "owner": {"reputation": 11, "user_id": 5470806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04453f4c7fb12d93b1967b84dd37452e?s=128&d=identicon&r=PG&f=1", "display_name": "C. Dan", "link": "https://stackoverflow.com/users/5470806/c-dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 7405, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1618189385, "creation_date": 1445421439, "last_edit_date": 1445423002, "question_id": 33256214, "link": "https://stackoverflow.com/questions/33256214/sap-gui-script-opens-an-excel-window-and-i-cant-stop-it", "title": "SAP GUI script opens an Excel window and I can&#39;t stop it", "body": "<p>I'm trying to automate SAP export to an Excel file, which in turn is then used by another Excel file with some VBA code to automate filtering and formatting the data.</p>\n\n<p>I've got it all running, except for one (seemingly minor) problem: SAP always opens the exported Excel file automatically and there seems to be no way of stopping this as it seems to happen AFTER the subroutines to import the Data in Excel VBA have finished (they contain the SAP GUI script).  </p>\n\n<p>If I only run the <code>sap_export</code> subroutine, then the Excel file opens, which is simply annoying. But if I run <code>refresh_sap()</code>, which calls <code>sap_export()</code>, followed by <code>refresh()</code>, which accesses the exported Excel file importing data, I get the prompt telling me that the file is already in use.</p>\n\n<p>I have found no way to stop the file from being opened by the SAP GUI script as it does not seem to happen during run time. I suspect that this is why I couldn't find any way to use Application.Wait or DoEvents to solve this. However long I wait, it will not work, as the file is simply never open until after runtime.</p>\n\n<pre><code>Sub refresh_sap()       \n    Call sap_export\n    Call refresh\nEnd Sub\n\nSub refresh()\n\n    'refreshes the connection to the SAP-exported Excel-file\n\n    ActiveWorkbook.Connections(\"export\").refresh\n\n    'deleting unwanted data\n\n    ActiveWorkbook.Sheets(\"PC-Liste komplett\").Select\n    Selection.AutoFilter\n    ActiveSheet.ListObjects(\"Tabelle_export\").Range.AutoFilter Field:=4, Criteria1:=\"L\u00f6schen\"\n    Range(\"A2\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Range(Selection, Selection.End(xlToRight)).Select\n    Selection.EntireRow.Delete\n    ActiveSheet.ListObjects(\"Tabelle_export\").Range.AutoFilter Field:=4\n    Range(\"A1\").Select   \nEnd Sub\n\nSub sap_export()\n\n    Dim set0 As Integer\n    Dim set1 As String\n    Dim set2 As Boolean\n\n    'vbs-script recorded with the SAP-GUI\n\n    If Not IsObject(sapp) Then\n       Set SapGuiAuto = GetObject(\"SAPGUI\")\n       Set sapp = SapGuiAuto.GetScriptingEngine\n    End If\n    If Not IsObject(Scon) Then\n       Set Scon = sapp.Children(0)\n    End If\n    If Not IsObject(session) Then\n       Set session = Scon.Children(0)\n    End If\n    If IsObject(WScript) Then\n       WScript.connectobject session, \"on\"\n       WScript.connectobject sapp, \"on\"\n    End If\n\n    session.findById(\"wnd[0]/tbar[0]/okcd\").Text = \"/n KE5X\"\n    session.findById(\"wnd[0]\").sendVKey 0\n    session.findById(\"wnd[0]/usr/ctxtGT_PRCTR-LOW\").Text = \"*\"\n    session.findById(\"wnd[0]\").sendVKey 8        \n    session.findById(\"wnd[0]/usr/cntlGRID1/shellcont/shell/shellcont[1]/shell\").contextMenu\n    session.findById(\"wnd[0]/usr/cntlGRID1/shellcont/shell/shellcont[1]/shell\").selectContextMenuItem \"&amp;XXL\"\n\n    If session.findById(\"wnd[1]/usr/radRB_1\").Selected = True Then\n        set0 = 0\n    ElseIf session.findById(\"wnd[1]/usr/radRB_2\").Selected = True Then\n        set0 = 1\n    ElseIf session.findById(\"wnd[1]/usr/radRB_OTHERS\").Selected = True Then\n        set0 = 2\n    End If\n\n    set1 = session.findById(\"wnd[1]/usr/cmbG_LISTBOX\").Key\n    set2 = session.findById(\"wnd[1]/usr/chkCB_ALWAYS\").Selected        \n    session.findById(\"wnd[1]/usr/radRB_OTHERS\").Select\n    session.findById(\"wnd[1]/usr/cmbG_LISTBOX\").Key = \"10\"\n    session.findById(\"wnd[1]/usr/chkCB_ALWAYS\").Selected = False        \n    session.findById(\"wnd[1]\").sendVKey 0\n    session.findById(\"wnd[1]/usr/ctxtDY_PATH\").Text = \"S:\\FIN-Alle\\Kostenstellen - Innenauftragsliste\\SAP\"\n    session.findById(\"wnd[1]/tbar[0]/btn[11]\").press    \n    session.findById(\"wnd[0]/usr/cntlGRID1/shellcont/shell/shellcont[1]/shell\").contextMenu\n    session.findById(\"wnd[0]/usr/cntlGRID1/shellcont/shell/shellcont[1]/shell\").selectContextMenuItem \"&amp;XXL\"\n\n    Select Case set0\n        Case 0\n        session.findById(\"wnd[1]/usr/radRB_1\").Select\n        Case 1\n        session.findById(\"wnd[1]/usr/radRB_2\").Select\n        Case 2\n        session.findById(\"wnd[1]/usr/radRB_OTHERS\").Select\n    End Select\n\n    session.findById(\"wnd[1]/usr/cmbG_LISTBOX\").Key = set1\n    session.findById(\"wnd[1]/usr/chkCB_ALWAYS\").Selected = set2\n    session.findById(\"wnd[1]\").sendVKey 12\n    session.findById(\"wnd[0]/tbar[0]/okcd\").Text = \"/n\"\n    session.findById(\"wnd[0]\").sendVKey 0\nEnd Sub\n</code></pre>\n\n<p>As I have the impression that I can do nothing to close the file within the subroutines (as it only opens after the run time) I'm currently looking for a way to: tell SAP not to open the file at all, or to prohibit it from being able to access Excel, or maybe just close SAP altogether and see if that works - although I would prefer not to do that.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1445420156, "post_id": 33255576, "comment_id": 54312837, "body": "In VBA you cannot declare a variable and initialise it at the same time (other than its default value)."}, {"owner": {"reputation": 440, "user_id": 4288959, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/0TCNu.png?s=128&g=1", "display_name": "Greenberet", "link": "https://stackoverflow.com/users/4288959/greenberet"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1445420727, "post_id": 33255576, "comment_id": 54313232, "body": "@Rory According to <a href=\"http://stackoverflow.com/questions/19369132/declare-and-initialize-string-array-in-vba#comment43045594_19369188\">another comment</a> it is possible in one line: <code>Dim a() As String: a = Split(&quot;Value1,Value2&quot;, &quot;,&quot;)</code> May this be applicable somehow for 2-D arrays?"}, {"owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "edited": false, "score": 0, "creation_date": 1445422340, "post_id": 33255576, "comment_id": 54314334, "body": "@Greenberet Colon is just the synonym of the new line in VBA. That way you can write whole application in one line by replacing all new lines with colons."}, {"owner": {"reputation": 440, "user_id": 4288959, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/0TCNu.png?s=128&g=1", "display_name": "Greenberet", "link": "https://stackoverflow.com/users/4288959/greenberet"}, "edited": false, "score": 0, "creation_date": 1445422659, "post_id": 33255576, "comment_id": 54314529, "body": "Oh.. I think <i>I can see clearly now</i>. The basic A for my Q is a rather big NO then :)"}, {"owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "edited": false, "score": 0, "creation_date": 1445423417, "post_id": 33255576, "comment_id": 54314985, "body": "No, there are always some work-arounds :)"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1445424574, "post_id": 33255576, "comment_id": 54315697, "body": "Yes, the basic answer to the question you asked is no! :)"}], "answers": [{"comments": [{"owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "edited": false, "score": 0, "creation_date": 1445424772, "post_id": 33256809, "comment_id": 54315825, "body": "Thanks. Explained eloquently"}, {"owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "edited": false, "score": 0, "creation_date": 1445427036, "post_id": 33256809, "comment_id": 54317394, "body": "I am thinking of my answer"}, {"owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "reply_to_user": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "edited": false, "score": 0, "creation_date": 1445429413, "post_id": 33256809, "comment_id": 54319009, "body": "I focus on 2D arrays. As for 1D arrays your answer is correct. The only problem is that the array created by <code>Array</code> function is of <code>Variant</code> type and you cannot declare it as <code>String</code>."}, {"owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "edited": false, "score": 0, "creation_date": 1445432020, "post_id": 33256809, "comment_id": 54320777, "body": "Thanks for explaining the nuance of array function"}], "tags": [], "owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "is_accepted": false, "score": 2, "last_activity_date": 1445422965, "creation_date": 1445422965, "answer_id": 33256809, "question_id": 33255576, "link": "https://stackoverflow.com/questions/33255576/how-to-declare-initialize-1-d-and-2-d-fixed-size-array-by-enumerating-the-valu/33256809#33256809", "title": "How to declare (initialize) 1-D and 2-D fixed-size array by enumerating the values?", "body": "<p>The most reasonable way to make it more elegant is by creating the new function that creates 2D array based on the given string.</p>\n\n<p>It could look like below:</p>\n\n<pre><code>Public Function create2DStringArray(ParamArray values() As Variant) As String()\n    Dim varItem As Variant\n    Dim strArray() As String\n    Dim arraySize As Long\n    Dim result() As String\n    Dim iterator As Long\n    '-------------------------------------------------------------------------------------------------\n\n    On Error Resume Next\n    arraySize = UBound(values) - LBound(values) + 1\n    On Error GoTo 0\n\n\n    ReDim result(0 To arraySize - 1, 0 To 1)\n\n\n    For Each varItem In values\n        strArray = VBA.Split(varItem, \";\")\n        result(iterator, 0) = strArray(0)\n        result(iterator, 1) = strArray(1)\n        iterator = iterator + 1\n    Next varItem\n\n\n    create2DStringArray = result\n\n\nEnd Function\n</code></pre>\n\n<p>Now, you could initialize your String array like that:</p>\n\n<pre><code>Dim a() As String\na = create2DStringArray(\"one;first\", \"two;second\", \"three;third\")\n</code></pre>\n\n<hr>\n\n<p>Note that the function above has some limitations:</p>\n\n<ul>\n<li><p>it can take only up to 30 parameters,</p></li>\n<li><p>it doesn't work if any of the given string contains semicolon inside (unless you chose another separator, I used semicolon above).</p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "is_accepted": false, "score": 1, "last_activity_date": 1445423162, "creation_date": 1445423162, "answer_id": 33256883, "question_id": 33255576, "link": "https://stackoverflow.com/questions/33255576/how-to-declare-initialize-1-d-and-2-d-fixed-size-array-by-enumerating-the-valu/33256883#33256883", "title": "How to declare (initialize) 1-D and 2-D fixed-size array by enumerating the values?", "body": "<p>For one dimensional Array</p>\n\n<pre><code>Sub aArray()\n\nDim myarray As Variant\n\nmyarray = Array(\"One\", \"Two\", \"Three\")\n\n\nFor i = 0 To UBound(myarray, 1)\n\nDebug.Print myarray(i)\n\nNext\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 440, "user_id": 4288959, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/0TCNu.png?s=128&g=1", "display_name": "Greenberet", "link": "https://stackoverflow.com/users/4288959/greenberet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1445423162, "creation_date": 1445419686, "last_edit_date": 1445421710, "question_id": 33255576, "link": "https://stackoverflow.com/questions/33255576/how-to-declare-initialize-1-d-and-2-d-fixed-size-array-by-enumerating-the-valu", "title": "How to declare (initialize) 1-D and 2-D fixed-size array by enumerating the values?", "body": "<p>I want to store constant name pairs in a 2-D array of strings. I can write:</p>\n\n<pre><code>Dim a(2, 1) As String     '0 to 2, and 0 to 1\na(0, 0) = \"one\"\na(0, 1) = \"first\"\na(1, 0) = \"two\"\na(1, 1) = \"second\"\na(2, 0) = \"three\"\na(2, 1) = \"third\"\n</code></pre>\n\n<p>But I think it would be more elegant and more extendable if I made VBA set the sizes of the array by looking at the instantly given content. I imagine something like this:</p>\n\n<pre><code> Dim a({\"one\",\"first\"}, _\n       {\"two\",\"second\"}, _\n       {\"three\",\"third\"}) as String\n</code></pre>\n\n<p>Then I realized I don't even know how to declare a 1-D array by instant enumeration (initialization).  </p>\n\n<p>Is this possible at all? If yes, how?</p>\n\n<p>Is there official documentation out there covering this Q? (<a href=\"https://msdn.microsoft.com/EN-US/library/office/gg264224.aspx\" rel=\"nofollow\">This</a> isn't.)</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 933, "user_id": 5345818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f648ca9f16c3a02a085cf79fa59c282?s=128&d=identicon&r=PG", "display_name": "asdev", "link": "https://stackoverflow.com/users/5345818/asdev"}, "is_accepted": false, "score": 1, "last_activity_date": 1445420050, "creation_date": 1445420050, "answer_id": 33255702, "question_id": 33255560, "link": "https://stackoverflow.com/questions/33255560/ms-access-vba-call-variable/33255702#33255702", "title": "MS Access - VBA call variable", "body": "<p>You have to use a string concatenation. You combine two strings with the ampersand: &amp;</p>\n\n<pre><code>Dim Test as String\nTest = 500\n\nDoCmd.OpenForm \"NAME_OF_FORM\", acNormal, \"\", \"[NUMBER] =\" &amp; Test, , acHidden\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5470786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7b5acd55b05cc397a5620425f5fd8f5?s=128&d=identicon&r=PG&f=1", "display_name": "Progs", "link": "https://stackoverflow.com/users/5470786/progs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1445420050, "creation_date": 1445419649, "question_id": 33255560, "link": "https://stackoverflow.com/questions/33255560/ms-access-vba-call-variable", "title": "MS Access - VBA call variable", "body": "<p>I am using VBA to develop a code which will automatically open an Access' form when a condition is met. Part of the Code is the following:</p>\n\n<pre><code>Private Sub Command10_Click()\n\nDoCmd.RunCommand acCmdRefresh\n\nDoCmd.OpenForm \"NAME_OF_FORM\", acNormal, \"\", \"[NUMBER] = 500\", , acHidden\n</code></pre>\n\n<p>Instead of setting \"[NUMBER] = 500\", I want to give a variable. Let's say:</p>\n\n<pre><code>Dim Test as String\n\nTest = 500\n</code></pre>\n\n<p>When I try to run the following:</p>\n\n<pre><code>DoCmd.OpenForm \"NAME_OF_FORM\", acNormal, \"\", \"[NUMBER] = Test\", , acHidden\n</code></pre>\n\n<p>The command does not run, but it runs when I give the condition \"[NUMBER] = 500\".</p>\n\n<p>Can you suggest anything?</p>\n"}, {"tags": ["vba", "excel", "sharepoint", "checkout"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1445422589, "post_id": 33254701, "comment_id": 54314484, "body": "Did you see this solution: <a href=\"http://stackoverflow.com/questions/22330499/checkout-workbook-in-vba\" title=\"checkout workbook in vba\">stackoverflow.com/questions/22330499/checkout-workbook-in-vb&zwnj;&#8203;a</a> Does it apply? Or maybe this one: <a href=\"http://stackoverflow.com/questions/24145177/what-makes-workbooks-cancheckout-fail\" title=\"what makes workbooks cancheckout fail\">stackoverflow.com/questions/24145177/&hellip;</a> ?"}, {"owner": {"reputation": 395, "user_id": 1329974, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f0e30723bd9f2047995e3a2da94a4f5d?s=128&d=identicon&r=PG", "display_name": "GBSingh", "link": "https://stackoverflow.com/users/1329974/gbsingh"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1445424250, "post_id": 33254701, "comment_id": 54315506, "body": "@Ralph. Thanks for those links, I think I missed them when I did a search. anyway the first link is very similar to what my issue is and to over come it I am now checking if the file can be checked in instead, and it seems to be working. Thanks once again for the links. :)"}], "owner": {"reputation": 395, "user_id": 1329974, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f0e30723bd9f2047995e3a2da94a4f5d?s=128&d=identicon&r=PG", "display_name": "GBSingh", "link": "https://stackoverflow.com/users/1329974/gbsingh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 693, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1445417303, "creation_date": 1445417037, "last_edit_date": 1445417303, "question_id": 33254701, "link": "https://stackoverflow.com/questions/33254701/cancheckout-not-returning-the-correct-value", "title": ".CanCheckOut not returning the correct value?", "body": "<p>I am trying to check if a file, stored on a SharePoint server, can be checked out or not so I can alert the user and stop them from editing the workbook without checking out the file. I have tried the code below but when I try to run it, it believes it is not possible to check out and doesn't do anything. Yet when I check the SharePoint server it says that it is not checked out and can be checked out.  </p>\n\n<pre><code>Function CheckOutCheck2() As Boolean\n'CheckOutCheck2 = True\nIf Workbooks.CanCheckOut(\"FilePath\") = True Then\n    MsgBox \"Please make sure the workbook is checkout before making any changes\", vbInformation, \"Check Out\"\n    CheckOutCheck2 = True\n    Debug.Print (\"Can Check Out\")\nEnd If\nIf Workbooks.CanCheckOut(\"Filepath\") = False Then\n    CheckOutCheck2 = False\n    Debug.Print (\"Cant Check Out\")\nEnd If\nEnd Function\n</code></pre>\n\n<p>and when I click my button I do this:</p>\n\n<pre><code>If CheckOutCheck2() = True Then\n    Exit Sub\nElse\n    CreateNew.Show\nEnd If\n</code></pre>\n\n<p>I want to be able to stop the user from doing anything until the file is checked out.  </p>\n\n<p>Anybody have any idea why this might be happening?</p>\n"}, {"tags": ["excel", "octave", "vba"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1445422261, "post_id": 33254670, "comment_id": 54314280, "body": "What have you coded thus far? Please show is the current state of you code."}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 1, "creation_date": 1445426555, "post_id": 33254670, "comment_id": 54317058, "body": "Why not <code>Abc\t123\tGhi\t789\tJkl\t000</code>?"}, {"owner": {"reputation": 1, "user_id": 5470636, "user_type": "registered", "profile_image": "https://graph.facebook.com/1510153275969741/picture?type=large", "display_name": "Klim Tan", "link": "https://stackoverflow.com/users/5470636/klim-tan"}, "edited": false, "score": 0, "creation_date": 1445628153, "post_id": 33254670, "comment_id": 54418697, "body": "The 4th possibility has been added in for clarity as pointed out by Axel. Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "is_accepted": false, "score": 0, "last_activity_date": 1445676932, "creation_date": 1445676932, "answer_id": 33316316, "question_id": 33254670, "link": "https://stackoverflow.com/questions/33254670/nchoosek-or-excel-query/33316316#33316316", "title": "&#39;Nchoosek&#39; or Excel query", "body": "<p>You could have the approach from your link a little bit more general. My code should be able working with a variable count of columns.</p>\n\n<pre><code>Sub CreatePermutation()\n\n Dim lFirstCellRow As Long\n Dim lSecondCellRow As Long\n Dim lThirdCellRow As Long\n Dim lNumRows As Long\n Dim iNumCols As Integer\n Dim lOutputRow As Long\n\n With ActiveSheet\n\n  'start your source data in A1 without empty cells\n  lNumRows = .Cells(1, 1).End(xlDown).Row()\n  If lNumRows = .Rows.Count Then lNumRows = 1\n  iNumCols = .Cells(1, 1).End(xlToRight).Column()\n  If iNumCols = .Columns.Count Then iNumCols = 1\n\n  'target data will begin after one empty row below the source data\n  lOutputRow = lNumRows + 2\n\n  For lFirstCellRow = 1 To lNumRows - 2\n   For lSecondCellRow = lFirstCellRow + 1 To lNumRows - 1\n    For lThirdCellRow = lSecondCellRow + 1 To lNumRows\n\n     .Range(.Cells(lOutputRow, 1), .Cells(lOutputRow, iNumCols)).Value = .Range(.Cells(lFirstCellRow, 1), .Cells(lFirstCellRow, iNumCols)).Value\n     .Range(.Cells(lOutputRow, 1 + iNumCols), .Cells(lOutputRow, 2 * iNumCols)).Value = .Range(.Cells(lSecondCellRow, 1), .Cells(lSecondCellRow, iNumCols)).Value\n     .Range(.Cells(lOutputRow, 1 + 2 * iNumCols), .Cells(lOutputRow, 3 * iNumCols)).Value = .Range(.Cells(lThirdCellRow, 1), .Cells(lThirdCellRow, iNumCols)).Value\n\n     lOutputRow = lOutputRow + 1\n\n    Next lThirdCellRow\n   Next lSecondCellRow\n  Next lFirstCellRow\n\n End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5470636, "user_type": "registered", "profile_image": "https://graph.facebook.com/1510153275969741/picture?type=large", "display_name": "Klim Tan", "link": "https://stackoverflow.com/users/5470636/klim-tan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 187, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1445676932, "creation_date": 1445416948, "last_edit_date": 1531161705, "question_id": 33254670, "link": "https://stackoverflow.com/questions/33254670/nchoosek-or-excel-query", "title": "&#39;Nchoosek&#39; or Excel query", "body": "<p>Data is in the following format, with each row one data set:</p>\n\n<pre><code>     Column A          Column B\n      Abc              123\n      Def              456\n      Ghi              789\n      Jkl              000\n</code></pre>\n\n<p>I am trying to list combinations of all possible groups of three data sets. For example:</p>\n\n<pre><code>      Column A.  B.   C.    D.   E.  F.\n      Abc       123  Def    456  Ghi 789\n      Abc       123  Def    456  Jkl 000\n      Def       456  Ghi    789  Jkl 000\n      Abc.      123 Ghi     789  JKl 000\n</code></pre>\n\n<p>In reality the actual number of columns exceeds 150 and rows exceed 50, so <a href=\"https://stackoverflow.com/questions/22689075/excel-permutations-without-repetition-from-values-in-multiple-columns\">Excel permutations without repetition from values in multiple columns</a> is not applicable. </p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "edited": false, "score": 0, "creation_date": 1445421690, "post_id": 33254478, "comment_id": 54313914, "body": "Could you provide some example as inputs"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 5389734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4cf4ef0f7aaf6758b1156a209625e1e?s=128&d=identicon&r=PG&f=1", "display_name": "alex123456789", "link": "https://stackoverflow.com/users/5389734/alex123456789"}, "edited": false, "score": 0, "creation_date": 1445423736, "post_id": 33256382, "comment_id": 54315174, "body": "Thanks newjenn.  I did not explain my problem accurately first time round (lack of vba knowledge).  The row is not dynamic as stated earlier.  The array is static.  What changes is the row selection..."}, {"owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "reply_to_user": {"reputation": 25, "user_id": 5389734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4cf4ef0f7aaf6758b1156a209625e1e?s=128&d=identicon&r=PG&f=1", "display_name": "alex123456789", "link": "https://stackoverflow.com/users/5389734/alex123456789"}, "edited": false, "score": 0, "creation_date": 1445423966, "post_id": 33256382, "comment_id": 54315320, "body": "Then your code not require for loop, you can pass rRange(rowselectionvalue,columnvalue)"}, {"owner": {"reputation": 25, "user_id": 5389734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4cf4ef0f7aaf6758b1156a209625e1e?s=128&d=identicon&r=PG&f=1", "display_name": "alex123456789", "link": "https://stackoverflow.com/users/5389734/alex123456789"}, "edited": false, "score": 0, "creation_date": 1445428256, "post_id": 33256382, "comment_id": 54318196, "body": "Ok, reading my problem maybe I did not explain the problem properly again.  The rRange variable only indexes a single cell in column 5 - as matched by the value in ComboBox1.  The array to be written by writeLine will be column 6:49 of the row matched by rRange.  does that make sense?"}, {"owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "reply_to_user": {"reputation": 25, "user_id": 5389734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4cf4ef0f7aaf6758b1156a209625e1e?s=128&d=identicon&r=PG&f=1", "display_name": "alex123456789", "link": "https://stackoverflow.com/users/5389734/alex123456789"}, "edited": false, "score": 0, "creation_date": 1445428539, "post_id": 33256382, "comment_id": 54318377, "body": "What is your input to write line?  for example Rrange will fetch row from user, that row need to be input to the writeline function"}, {"owner": {"reputation": 25, "user_id": 5389734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4cf4ef0f7aaf6758b1156a209625e1e?s=128&d=identicon&r=PG&f=1", "display_name": "alex123456789", "link": "https://stackoverflow.com/users/5389734/alex123456789"}, "edited": false, "score": 0, "creation_date": 1445429216, "post_id": 33256382, "comment_id": 54318879, "body": "I have added code to my original question.  Hopefully it will help."}, {"owner": {"reputation": 25, "user_id": 5389734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4cf4ef0f7aaf6758b1156a209625e1e?s=128&d=identicon&r=PG&f=1", "display_name": "alex123456789", "link": "https://stackoverflow.com/users/5389734/alex123456789"}, "edited": false, "score": 0, "creation_date": 1445431882, "post_id": 33256382, "comment_id": 54320666, "body": "These are the function inputs: &#39;Function writeLine(ID As String, writeArray() As String) As Boolean&#39;.  ID is the Combobox value, writeArray is the array that I am trying to create."}, {"owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "reply_to_user": {"reputation": 25, "user_id": 5389734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4cf4ef0f7aaf6758b1156a209625e1e?s=128&d=identicon&r=PG&f=1", "display_name": "alex123456789", "link": "https://stackoverflow.com/users/5389734/alex123456789"}, "edited": false, "score": 0, "creation_date": 1445433298, "post_id": 33256382, "comment_id": 54321734, "body": "Is writearray() is 1D or 2D. What the array contains? I couldnt understand column 6:49 what it mean? is array need to get value from rRange value.?"}, {"owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "reply_to_user": {"reputation": 25, "user_id": 5389734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4cf4ef0f7aaf6758b1156a209625e1e?s=128&d=identicon&r=PG&f=1", "display_name": "alex123456789", "link": "https://stackoverflow.com/users/5389734/alex123456789"}, "edited": false, "score": 0, "creation_date": 1445433370, "post_id": 33256382, "comment_id": 54321793, "body": "For Example Is Writearray(rowvalue, columnvalue) from rRange? if so ,"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1445435038, "post_id": 33256382, "comment_id": 54322965, "body": "I don&#39;t think you need to write the contents of the cells in columns 6:49 (F:AW) to an array to write to a text file. Couldn&#39;t you just loop through them and create a string out of them? Something like <code>For i = 1 to 44 string = string &amp; range.offset(0,i)</code>"}, {"owner": {"reputation": 25, "user_id": 5389734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4cf4ef0f7aaf6758b1156a209625e1e?s=128&d=identicon&r=PG&f=1", "display_name": "alex123456789", "link": "https://stackoverflow.com/users/5389734/alex123456789"}, "edited": false, "score": 0, "creation_date": 1445435174, "post_id": 33256382, "comment_id": 54323075, "body": "writearray() is 2D. 1 row, 43 columns.  Each column will have either a &quot;1&quot; or &quot;&quot; depending on a condition (not stated here).  If I understand correctly, Writearray(rowvalue, columnvalue) where rowvalue changes for each loop of write line function, and columnvalue is the range of columns F:BA."}, {"owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "edited": false, "score": 0, "creation_date": 1445435797, "post_id": 33256382, "comment_id": 54323556, "body": "row number start from ?"}, {"owner": {"reputation": 25, "user_id": 5389734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4cf4ef0f7aaf6758b1156a209625e1e?s=128&d=identicon&r=PG&f=1", "display_name": "alex123456789", "link": "https://stackoverflow.com/users/5389734/alex123456789"}, "reply_to_user": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1445437777, "post_id": 33256382, "comment_id": 54325149, "body": "@Kyle - i think the writeLine function writes each element of the (desired) array to a string variable, element-by-element and separated by vbtab.  The string variable is then written to the text file.  So I need to provide the function with the reference range/array with which it compiles the string variable with.  My difficulty is to provide this reference range/array.  newjenn - the row number starts from rRange (rRange references a row within column 5, and the row ranges depending on the value of comboBox1 in the userform)"}, {"owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "edited": false, "score": 0, "creation_date": 1445438997, "post_id": 33256382, "comment_id": 54326090, "body": "@so first, we need to find the starting row and ending row, Inorder to finalize the row range. will rRange contains both the range?"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "reply_to_user": {"reputation": 25, "user_id": 5389734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4cf4ef0f7aaf6758b1156a209625e1e?s=128&d=identicon&r=PG&f=1", "display_name": "alex123456789", "link": "https://stackoverflow.com/users/5389734/alex123456789"}, "edited": false, "score": 0, "creation_date": 1445441887, "post_id": 33256382, "comment_id": 54328260, "body": "@alex123456789 I guess my point is, I would skip the array all together, so directly with a string, and write to the file that way. Why bother with an array, particularly passing an array, when it isn&#39;t necessary?"}, {"owner": {"reputation": 25, "user_id": 5389734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4cf4ef0f7aaf6758b1156a209625e1e?s=128&d=identicon&r=PG&f=1", "display_name": "alex123456789", "link": "https://stackoverflow.com/users/5389734/alex123456789"}, "edited": false, "score": 0, "creation_date": 1445442568, "post_id": 33256382, "comment_id": 54328749, "body": "@ Kyle - Thanks for the comment.  We are trying to add functionality to code already in use.  To avoid global changes, we just want to adjust our code to fit in."}], "tags": [], "owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "is_accepted": false, "score": 0, "last_activity_date": 1445437078, "last_edit_date": 1445437078, "creation_date": 1445421855, "answer_id": 33256382, "question_id": 33254478, "link": "https://stackoverflow.com/questions/33254478/dynamic-row-and-static-column-array-for-write-line-loop/33256382#33256382", "title": "Dynamic row and static column array for &#39;write line&#39; loop", "body": "<p>Use Ubound to get the range as array.   </p>\n\n<p>Private Sub CommandButton18_Click()</p>\n\n<pre><code>Dim rRange As Range\nDim colno As Long\nDim rownumber As Long\nDim sString As String\n\n    lastrow = 10\n\nFor colno = 6 To 43\n   For rownumber = 1 To lastrow\n       sString = Worksheets(\"sheet1\").Cells(rownumber, colno)\n       Next rownumber\n    Next\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 25, "user_id": 5389734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4cf4ef0f7aaf6758b1156a209625e1e?s=128&d=identicon&r=PG&f=1", "display_name": "alex123456789", "link": "https://stackoverflow.com/users/5389734/alex123456789"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 659, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1445437078, "creation_date": 1445416340, "last_edit_date": 1445429143, "question_id": 33254478, "link": "https://stackoverflow.com/questions/33254478/dynamic-row-and-static-column-array-for-write-line-loop", "title": "Dynamic row and static column array for &#39;write line&#39; loop", "body": "<p>I need to generate an array for a 'write line' custom function.  This function writes a single row of cells (the array) to a text file during a loop.<br>\nThis array is static in size.<br>\nThe row to be written to the text file is 'detected' by the Rng variable below:</p>\n\n<pre><code>Set Rng = Worksheets(\"Sheet1\").Columns(5).Find(userform1.ComboBox1.Value)    \n</code></pre>\n\n<p>i.e. the Rng variable only indexes a single cell in column 5 - as matched by the value in ComboBox1. The array to be written by writeLine will be column 6:49 of the row matched by Rng.  </p>\n\n<p>The arguments for the 'write line' function are </p>\n\n<ol>\n<li>the value of the combobox i.e. <code>userform1.combobox1.value</code>, and</li>\n<li>the array to be written in the 'write line' function</li>\n</ol>\n\n<p>So far, I have this:</p>\n\n<pre><code>Private Sub CommandButton18_Click()\n\nDim Range As Range\nDim Array As Range\n\nSet Range =      Worksheets(\"Sheet1\").Columns(5).Find(userform1.ComboBox1.Value) ''anticipated to set the row index of the array???\n\nArray = ????\n\nFunction.writeLine(userform1.ComboBox1.Value,????)\n\nEnd Sub\n</code></pre>\n\n<p>The trouble I am having is to create an array that incorporates the changing row whilst having the number of columns fixed?</p>\n\n<p>Here is part of the writeLine function:</p>\n\n<pre><code>Do Until objTF.AtEndOfStream\n    readString = objTF.readline\n    data = Split(readString, vbTab)\n    foundID = data(0)\n    If StrComp(**foundID, ID**, 1) &lt;&gt; 0 Then\n        objTF2.writeLine (readString)\n    ElseIf StrComp(**foundID, ID**, 1) = 0 Then\n        'write initial value outside the loop\n        strTmp = Split(readString, strDelim)\n        'Modify the data array to include the data provided by writeArray\n        For argPos = 5 To UBound(data)\n            'check for index out of bounds, stop writing if it is!\n            If (argPos - 5) &gt; UBound(writeArray) Then Exit For 'need to check this will exit if the value is index out of bounds.\n            data(argPos) = writeArray(dataPos)\n            dataPos = dataPos + 1\n        Next argPos\n        'Take each entry from data and build a string delimited by strDelim\n        Do Until counter &gt; UBound(data)\n            resultStr = IIf(counter &lt;= UBound(data), resultStr &amp; data(counter) &amp; strDelim, resultStr &amp; data(counter))\n            counter = counter + 1\n        Loop\n        'output to temp file\n        objTF2.writeLine (resultStr)...\n</code></pre>\n\n<p>Basically, the \"foundID\" and \"ID\" are the variables to be matched in order to write the array to the text file.  The \"ID\" is the ComboBox1.value.  \"foundID\" is the value in column 5 of the spreadsheet.  Column 6:49 (the array) are to be written to the text file.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1445428704, "post_id": 33254222, "comment_id": 54318499, "body": "Not sure I understand: &quot;create a cross reference&quot; - <i>Where</i> would you like to create that cross-reference? You are at the <i>target</i> that reference would point to. Where would you want the source link to be? Creating a cross-reference per se is as easy as turning on the macro recorder... Please specify <i>exactly</i> what you want, including expected output and what you have tried so far."}, {"owner": {"reputation": 133, "user_id": 1517526, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/054e4d2296a33c452e436d63fdaefa47?s=128&d=identicon&r=PG", "display_name": "mt.andi", "link": "https://stackoverflow.com/users/1517526/mt-andi"}, "reply_to_user": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1445430159, "post_id": 33254222, "comment_id": 54319462, "body": "I want to create it in the clipboard (GeneratedReference.PutInClipboard). Use case: click on the number of the list, Ctrl-C, click anywhere you want to paste cross-refference to that list-element, Ctrl-V, list element number is getting pasted there as a cross-reference."}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1445430735, "post_id": 33254222, "comment_id": 54319826, "body": "This has nothing to do with &quot;cross-reference&quot; then. You can copy text to the clipboard using <code>DataObject</code> and <code>.SetText</code> as demonstrated here: <a href=\"http://word.mvps.org/faqs/MacrosVBA/ManipulateClipboard.htm\" rel=\"nofollow noreferrer\">word.mvps.org/faqs/MacrosVBA/ManipulateClipboard.htm</a> and get the list number of the current pargraph using <code>Selection.Paragraphs(1).Range.ListFormat</code>. Does that do the trick?"}, {"owner": {"reputation": 133, "user_id": 1517526, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/054e4d2296a33c452e436d63fdaefa47?s=128&d=identicon&r=PG", "display_name": "mt.andi", "link": "https://stackoverflow.com/users/1517526/mt-andi"}, "reply_to_user": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1445436682, "post_id": 33254222, "comment_id": 54324260, "body": "I want to do the same thing that the Cross Reference window does, when you select reference type &quot;Numbered item&quot; and insert reference to &quot;Paragraph number&quot; (<a href=\"http://i.imgur.com/biByqFj.png\" rel=\"nofollow noreferrer\">i.imgur.com/biByqFj.png</a>), But to do this without the window and insert cross referrence in the clipboard instead of the document straight ahead. The document has too many lists, so it&#39;s hard to use that window. It would save a lot of time if we could copy-paste them with hotkeys only."}], "answers": [{"tags": [], "owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "is_accepted": false, "score": 0, "last_activity_date": 1445439416, "creation_date": 1445439416, "answer_id": 33262680, "question_id": 33254222, "link": "https://stackoverflow.com/questions/33254222/how-to-copy-reference-to-the-active-list-number-in-word/33262680#33262680", "title": "How to copy reference to the active list number in Word?", "body": "<p>I've tinkered around for the fun of it and long story short: I don't think you will manage to do that. Reason: this is the code for creating a cross reference to a numbered item in VBA:</p>\n\n<pre><code>Set r = Selection.Range\n\nr.InsertCrossReference ReferenceType:=\"Numbered item\", _\n        ReferenceKind:=wdNumberRelativeContext, ReferenceItem:=\"5\", _\n        InsertAsHyperlink:=True, IncludePosition:=False, SeparateNumbers:=False, _\n        SeparatorString:=\" \"\n</code></pre>\n\n<p>Trouble here is the ReferenceItem:=\"5\". When I recorded this, it was simply the fifth numbered item regardless of its list level.\nSo all you have to do now is to find a way to identify a numbered item as the nth numbered item in your document.</p>\n\n<p>If you can solve that, you can assign a key combination to copy a reference to the current list item like this:</p>\n\n<pre><code>Sub CopyReference()\nDim r As Range\nDim dObject As DataObject\n\nSet dObject = New DataObject\n\nSet r = Selection.Range\n\nr.InsertCrossReference ReferenceType:=\"Nummeriertes Element\", _\n        ReferenceKind:=wdNumberRelativeContext, ReferenceItem:=\"5\", _\n        InsertAsHyperlink:=True, IncludePosition:=False, SeparateNumbers:=False, _\n        SeparatorString:=\" \"\n\ndObject.SetText r.Paragraphs(1).Range.Fields(1).Code\nr.Paragraphs(1).Range.Fields(1).Delete\ndObject.PutInClipboard\n\nEnd Sub\n</code></pre>\n\n<p>And another key combination to paste your reference like this:</p>\n\n<pre><code>Sub pasteField()\nDim fld As Field, dObject As DataObject\nDim gg\n\nSet fld = ActiveDocument.Fields.Add(Selection.Range, wdFieldRef)\nSet dObject = New DataObject\ndObject.GetFromClipboard\ngg = dObject.GetText\nfld.Code.Text = gg\nfld.Update\nEnd Sub\n</code></pre>\n\n<p>As you can see, I haven't actually copied the cross reference field but only its code.</p>\n"}, {"comments": [{"owner": {"reputation": 133, "user_id": 1517526, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/054e4d2296a33c452e436d63fdaefa47?s=128&d=identicon&r=PG", "display_name": "mt.andi", "link": "https://stackoverflow.com/users/1517526/mt-andi"}, "edited": false, "score": 0, "creation_date": 1445455653, "post_id": 33262921, "comment_id": 54336390, "body": "Yeah, I was trying to emulate the window logic, but your solution does exactly what I needed. I just added timestamp as UID for new References: sMyRef = &quot;<i>MyRef</i>&quot; &amp; DateDiff(&quot;s&quot;, #1/1/1970#, Now()) And added InsertAsHyperlink:=True to this line: rng.InsertCrossReference wdRefTypeBookmark, wdNumberFullContext, sMyRef, True Thanks a lot!"}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1445502139, "post_id": 33262921, "comment_id": 54353344, "body": "Yeah, probably better with a bookmark. Does the cut work too? It didn&#39;t when I tried it. I did have a RDP open that could have messed with my clipboard but copy and cut didn&#39;t work for me there with the field."}, {"owner": {"reputation": 133, "user_id": 1517526, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/054e4d2296a33c452e436d63fdaefa47?s=128&d=identicon&r=PG", "display_name": "mt.andi", "link": "https://stackoverflow.com/users/1517526/mt-andi"}, "reply_to_user": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1445513882, "post_id": 33262921, "comment_id": 54360530, "body": "@LocEngineer Yes, the cut works. It looks a bit strange when it adds a line of the text and immediately removes it, but it does the trick. Much better way to create bookmarks to the list elements than using standard window."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1445526379, "post_id": 33262921, "comment_id": 54368855, "body": "@LocEngineer. Your code uses PutInClipboard instead of cut, and as far as I can tell is only taking the text, not the field?"}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1445527150, "post_id": 33262921, "comment_id": 54369387, "body": "@CindyMeister Yes. Like I said for some reason it would not copy the field correctly, paste would yield nothing. So I created a temporary crossref, copied the field code to clipboard. The second code then creates a new field and sets the field code to the clipboard contents. Long-winded but it simply did not copy the field try as I may."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1445535772, "post_id": 33262921, "comment_id": 54374605, "body": "@LocEngineer. Huh, would have been interesting to watch over your shoulder :-) For future reference, that&#39;s why the rng.Select (commented out) is in there. I had to try a couple of times, as well. Writing to Field.Code won&#39;t encompass the entire field, so the MoveEnd is in there to ensure I pick up all of it before cutting."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1445440107, "creation_date": 1445440107, "answer_id": 33262921, "question_id": 33254222, "link": "https://stackoverflow.com/questions/33254222/how-to-copy-reference-to-the-active-list-number-in-word/33262921#33262921", "title": "How to copy reference to the active list number in Word?", "body": "<p>After looking at the object model and how Word behaves I think you can manage something, but perhaps not exactly the way you envisioned. The problem lies with the Numbered Items, which seem to be oriented to captions rather than numbered lines... In any case, when a cross-reference is inserted via the dialog box to a \"Numbered item\" Word does create a bookmark and then reference that. So my suggestion emulates that behavior, as in the following code snippet.</p>\n\n<p>What you'll need/want to do is maintain a \"counter\" for incrementing the bookmark name (or you could generate GUIDs, the way Word does). My demo has the bookmark name hard-coded. </p>\n\n<p>This example sets the <em>hidden</em> bookmark at the beginning of the paragraph where the current selection is. It then inserts a cross-reference, extends the Range to include the cross-reference (since the method does not return a range or object) and cuts it to the clipboard. The user can then paste it wherever he wants.</p>\n\n<pre><code>Sub InsertThenCopyCrossRef()\n    Dim rng As word.Range, rngBkm As word.Range\n    Dim bkm As word.Bookmark\n    Dim sMyRef As String\n\n    sMyRef = \"_MyRef_1\" 'a counter or something to make name unique!\n    Set rng = Selection.Range\n    Set rngBkm = rng.Duplicate.Paragraphs(1).Range\n    rngBkm.Collapse wdCollapseStart\n    Set bkm = ActiveDocument.Bookmarks.Add(sMyRef, rngBkm)\n    rng.InsertCrossReference wdRefTypeBookmark, wdNumberFullContext, sMyRef\n    rng.MoveEnd wdWord, 1\n    rng.Fields(1).Cut\n    'rng.Select\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 1517526, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/054e4d2296a33c452e436d63fdaefa47?s=128&d=identicon&r=PG", "display_name": "mt.andi", "link": "https://stackoverflow.com/users/1517526/mt-andi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 379, "favorite_count": 0, "accepted_answer_id": 33262921, "answer_count": 2, "score": -1, "last_activity_date": 1445440107, "creation_date": 1445415557, "last_edit_date": 1445437246, "question_id": 33254222, "link": "https://stackoverflow.com/questions/33254222/how-to-copy-reference-to-the-active-list-number-in-word", "title": "How to copy reference to the active list number in Word?", "body": "<p>I have a lot of lists in my document with numbers that look like \"1.3.2\" and I want to automate the process of creating a cross-references to the list elements.</p>\n\n<p>I'm trying to make a macro that will:</p>\n\n<ul>\n<li>detect the list element, cursor is positioned at;</li>\n<li>create a cross reference to the list element with number as a reference text (i.e. \"1.3.2\");</li>\n<li>put it into the clipboard;</li>\n<li>make \"LCtrl+C\" hotkey launch that macro when cursor is positioned at the list number (optional: only for the lists with declared style(s)).</li>\n</ul>\n\n<p>How do I achieve that with VBA?</p>\n"}, {"tags": ["vba", "excel", "hyperlink"], "answers": [{"comments": [{"owner": {"reputation": 235, "user_id": 4990837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10152990063981295/picture?type=large", "display_name": "Gray Meiring", "link": "https://stackoverflow.com/users/4990837/gray-meiring"}, "edited": false, "score": 0, "creation_date": 1445417042, "post_id": 33254532, "comment_id": 54310824, "body": "Thank you! I am new to VBA. How do I add the filedatetime function to my above VBA code? So that it places the dates modified next to each hyperlink?"}, {"owner": {"reputation": 590, "user_id": 2250595, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/74f417b7aa939eaad4b1afb301487ad4?s=128&d=identicon&r=PG", "display_name": "mauek unak", "link": "https://stackoverflow.com/users/2250595/mauek-unak"}, "reply_to_user": {"reputation": 235, "user_id": 4990837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10152990063981295/picture?type=large", "display_name": "Gray Meiring", "link": "https://stackoverflow.com/users/4990837/gray-meiring"}, "edited": false, "score": 0, "creation_date": 1445417372, "post_id": 33254532, "comment_id": 54311024, "body": "I just edited my answer, it will show dates as you requested"}, {"owner": {"reputation": 235, "user_id": 4990837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10152990063981295/picture?type=large", "display_name": "Gray Meiring", "link": "https://stackoverflow.com/users/4990837/gray-meiring"}, "edited": false, "score": 0, "creation_date": 1445417781, "post_id": 33254532, "comment_id": 54311281, "body": "Wonderful! Worked perfectly! Thanks so much"}], "tags": [], "owner": {"reputation": 590, "user_id": 2250595, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/74f417b7aa939eaad4b1afb301487ad4?s=128&d=identicon&r=PG", "display_name": "mauek unak", "link": "https://stackoverflow.com/users/2250595/mauek-unak"}, "is_accepted": true, "score": 1, "last_activity_date": 1445417797, "last_edit_date": 1445417797, "creation_date": 1445416517, "answer_id": 33254532, "question_id": 33254048, "link": "https://stackoverflow.com/questions/33254048/for-a-folder-show-dates-last-modified-of-files-next-to-cells-hyperlinking-to-th/33254532#33254532", "title": "For a folder, show Dates Last Modified of files next to cells hyperlinking to the files", "body": "<p>I believe <code>filedatetime</code> function is one you are looking for</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Yes, skkakkar's answer is even better, I edited my code with his suggestion :</p>\n\n<pre><code>Sub Hyperlink()\nDim objFSO As Object, objFolder As Object, objFile As Object\nDim i As Integer\n\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\nSet objFolder = objFSO.GetFolder(\"S:\\Promigen Orders\")\ni = 1\n\nFor Each objFile In objFolder.Files\n\nRange(Cells(i + 1, 1), Cells(i + 1, 1)).Select\n\nActiveSheet.Hyperlinks.Add Anchor:=Selection, Address:= _\nobjFile.Path, TextToDisplay:=objFile.Name\n\nRange(Cells(i + 1, 2), Cells(i + 1, 2)) = objFile.DateLastModified\ni = i + 1\nNext objFile\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "is_accepted": false, "score": 1, "last_activity_date": 1445417580, "creation_date": 1445417580, "answer_id": 33254898, "question_id": 33254048, "link": "https://stackoverflow.com/questions/33254048/for-a-folder-show-dates-last-modified-of-files-next-to-cells-hyperlinking-to-th/33254898#33254898", "title": "For a folder, show Dates Last Modified of files next to cells hyperlinking to the files", "body": "<p>Just add one line in your code as shown below</p>\n\n<pre><code>  TextToDisplay:=objFile.Name\nRange(Cells(i + 1, 2), Cells(i + 1, 2)).Value2 = Format(objFile.DateLastModified, \"dd-mmm-yyyy\")\n\ni = i + 1\n</code></pre>\n"}], "owner": {"reputation": 235, "user_id": 4990837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10152990063981295/picture?type=large", "display_name": "Gray Meiring", "link": "https://stackoverflow.com/users/4990837/gray-meiring"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1126, "favorite_count": 0, "accepted_answer_id": 33254532, "answer_count": 2, "score": 1, "last_activity_date": 1458145010, "creation_date": 1445414885, "last_edit_date": 1445416134, "question_id": 33254048, "link": "https://stackoverflow.com/questions/33254048/for-a-folder-show-dates-last-modified-of-files-next-to-cells-hyperlinking-to-th", "title": "For a folder, show Dates Last Modified of files next to cells hyperlinking to the files", "body": "<p>I have an Excel spreadsheet and use VBA to show a list of files in a specific folder. The VBA also creates hyperlinks for me. That is working fine.  However, it does not place the Dates Last Modified in the cells next to each hyperlink. </p>\n\n<p>For example, if <code>TestFold.pdf</code> is in cell A1 - I want the date last modified of this file (hyperlink) in cell B1 (next to it).</p>\n\n<p>My end goal is every time a new folder is added to the server location, I can simply run my VBA and get the list of all files in that folder as hyperlinks (which I have already done) and with their last modified date next to them.</p>\n\n<p>My VBA for getting the folders and displaying as hyperlinks is as follows:</p>\n\n<pre><code>Sub Hyperlink()\nDim objFSO As Object\nDim objFolder As Object\nDim objFile As Object\nDim i As Integer\n\n\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\n\nSet objFolder = objFSO.GetFolder(\"S:\\Promigen Orders\")\ni = 1\n\nFor Each objFile In objFolder.Files\n\nRange(Cells(i + 1, 1), Cells(i + 1, 1)).Select\n\nActiveSheet.Hyperlinks.Add Anchor:=Selection, Address:= _\n    objFile.Path, _\n    TextToDisplay:=objFile.Name\ni = i + 1\nNext objFile\nEnd Sub\n</code></pre>\n\n<p>Can it be added to this VBA?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1445415109, "post_id": 33253868, "comment_id": 54309594, "body": "I wouldn&#39;t even attempt to use that file. The object you have selected appears to have the name and properties of <code>ThisWorkbook</code> (which is in keeping with the icon displayed) in spite of appearing to be a worksheet."}, {"owner": {"reputation": 116, "user_id": 5470349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d15e5ee4eb6e9dad71f52f967b41f46?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/5470349/josh"}, "edited": false, "score": 0, "creation_date": 1445505441, "post_id": 33253868, "comment_id": 54355381, "body": "Unfortunately in this corporate environment our systems are locked down and I&#39;m unable to utilise LibreOffice, OpenOffice. The same goes for restrictions of transferring to another computer for rectifying."}], "owner": {"reputation": 116, "user_id": 5470349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d15e5ee4eb6e9dad71f52f967b41f46?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/5470349/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1445416625, "creation_date": 1445414293, "last_edit_date": 1445416625, "question_id": 33253868, "link": "https://stackoverflow.com/questions/33253868/excel-recovered-unreadable-content-worksheet-as-class-and-cant-be-deleted", "title": "Excel recovered unreadable content (worksheet) as class and can&#39;t be deleted", "body": "<p>I have a tracking tool that follows a process at work over a 14 week cycle. When we start a new cycle of the process (approximately 50 times per year) we use the latest template to create a new tracking file (updated 4-5 times per year with improvements and bug fixes).</p>\n\n<p>This morning we received the <em>Excel found unreadable content...</em> error message opening a particular instance of the tool halfway through the cycle. Upon \"recovering\" the file Excel then identifies what was affected and that data is not recovered.</p>\n\n<p><a href=\"https://i.stack.imgur.com/MIZ4m.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MIZ4m.jpg\" alt=\"Recovery message box\"></a>  </p>\n\n<p>The lost data is generic and of no value, however with the macros and formulas developed the SHEET NAME is.</p>\n\n<p>The problem comes by way of the \"recovered\" sheet being morphed into a class I cannot delete. There are a lot of formulas and macros that reference this sheet and they CANNOT be changed at this stage. </p>\n\n<p><a href=\"https://i.stack.imgur.com/x7OWu.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/x7OWu.jpg\" alt=\"Project Explorer screenshot with right-click menu\"></a>  </p>\n\n<p>I even tried unzipping the .xlsx package and removing the offending worksheet, rels, etc., but can't seem to clear it all.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1445413630, "post_id": 33253570, "comment_id": 54308810, "body": "Are you running this code <b>in</b> Excel?"}, {"owner": {"reputation": 43, "user_id": 5123668, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c54a0fdf7ddd99ff347dcc6b2606fb00?s=128&d=identicon&r=PG&f=1", "display_name": "RobRaj", "link": "https://stackoverflow.com/users/5123668/robraj"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1445413852, "post_id": 33253570, "comment_id": 54308933, "body": "No, in Outlook. Sorry, I forgot to mention."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1445414027, "post_id": 33253570, "comment_id": 54309007, "body": "That&#39;s the problem then. You aren&#39;t creating an <code>Excel.Application</code> object or properly qualifying any of your excel objects."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 5123668, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c54a0fdf7ddd99ff347dcc6b2606fb00?s=128&d=identicon&r=PG&f=1", "display_name": "RobRaj", "link": "https://stackoverflow.com/users/5123668/robraj"}, "edited": false, "score": 0, "creation_date": 1445432274, "post_id": 33253882, "comment_id": 54320958, "body": "I&#39;m sorry that I don&#39;t check long enough, but I see that unfortunately even if macro works fine (there is no error), I can&#39;t open Excel file - after opening Excel there is no Workbook - only grey background. Do you know how I can fix it?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 43, "user_id": 5123668, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c54a0fdf7ddd99ff347dcc6b2606fb00?s=128&d=identicon&r=PG&f=1", "display_name": "RobRaj", "link": "https://stackoverflow.com/users/5123668/robraj"}, "edited": false, "score": 0, "creation_date": 1445433787, "post_id": 33253882, "comment_id": 54322081, "body": "I&#39;ve made a small change to the code that should fix that but first off you&#39;ll need to use the View - Unhide menu to make the workbook visible and then save it."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 1, "last_activity_date": 1445433750, "last_edit_date": 1445433750, "creation_date": 1445414348, "answer_id": 33253882, "question_id": 33253570, "link": "https://stackoverflow.com/questions/33253570/opening-excel-file-in-vba-run-time-error-462-the-remote-server-machine-does/33253882#33253882", "title": "Opening Excel file in VBA: Run-time error \u2018462\u2019: The remote server machine does not exist or is unavialiable", "body": "<p>This should work for you (make sure you kill any hidden Excel.exe instances left over from your previous code first):</p>\n\n<pre><code>Dim ark                   As Excel.Workbook\nDim xlSheet               As Excel.Worksheet\nDim a                     As Long\n\nSet ark = GetObject(scexcel)\nark.Application.Visible = True\nSet xlSheet = ark.Worksheets(\"Sheet1\")\nWith xlSheet\n    a = .Range(\"B\" &amp; .Rows.Count).End(xlUp).Row + 1\n    .Cells(a, 2).Value = \"ABC\"\n    .Cells(a, 3).Value = \"DEF\"\n    .Cells(a, 4).Value = \"GHI\"\n    .Cells(a, 5).Value = \"JKL\"\nEnd With\nSet xlSheet = Nothing\nark.Close SaveChanges:=True\n\nSet ark = Nothing\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 5123668, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c54a0fdf7ddd99ff347dcc6b2606fb00?s=128&d=identicon&r=PG&f=1", "display_name": "RobRaj", "link": "https://stackoverflow.com/users/5123668/robraj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2339, "favorite_count": 0, "accepted_answer_id": 33253882, "answer_count": 1, "score": 2, "last_activity_date": 1582630601, "creation_date": 1445413197, "last_edit_date": 1582630601, "question_id": 33253570, "link": "https://stackoverflow.com/questions/33253570/opening-excel-file-in-vba-run-time-error-462-the-remote-server-machine-does", "title": "Opening Excel file in VBA: Run-time error \u2018462\u2019: The remote server machine does not exist or is unavialiable", "body": "<p>I need to create a macro that opens an Excel file, and saves some files inside the Workbook. The problem is that when I want to run macro more than once in a short time (which unfortunately I need to do), I receive error '462': The remote server machine does not exist or is unavialiable. </p>\n\n<p>I've read about this and tried to fix it: I've created a special module at the beginning to kill Excel process: </p>\n\n<pre><code>Call KillExcel\n\nFunction KillExcel()\n\nDim oServ As Object\nDim cProc As Variant\nDim oProc As Object\n\nSet oServ = GetObject(\"winmgmts:\")\nSet cProc = oServ.ExecQuery(\"Select * from Win32_Process\")\n\nFor Each oProc In cProc\n\n    'Rename EXCEL.EXE in the line below with the process that you need to Terminate.\n    'NOTE: It is 'case sensitive\n\n    If oProc.Name = \"EXCEL.EXE\" Or oProc.Name = \"EXCEL.EXE *32\" Then\n     ' MsgBox \"KILL\"   ' used to display a message for testing pur\n      errReturnCode = oProc.Terminate()\n    End If\nNext\n\nEnd Function\n</code></pre>\n\n<p>But unfortunately even if I close this processes I still receive this error. The part of code where I use Excel looks like this: </p>\n\n<pre><code>Dim ark As Excel.Workbook\nDim xlSheet As Excel.Worksheet\n\nSet ark = Excel.Workbooks.Open(FileName:=scexcel)\nSet xlSheet = ark.Worksheets(\"Sheet1\")\na = Sheets(\"Sheet1\").Range(\"B\" &amp; Rows.Count).End(xlUp).Row + 1\n\n\nCells(a, 2).Value = \"ABC\"\nCells(a, 3).Value = \"DEF\"\nCells(a, 4).Value = \"GHI\"\nCells(a, 5).Value = \"JKL\"\n\na = a + 1\n\nSet xlSheet = Nothing\nark.Close SaveChanges:=True\n\nSet ark = Nothing\n</code></pre>\n\n<p>If it helps, the macro fails every time I run it multiple times in a short time period at line: </p>\n\n<pre><code>Set ark = Excel.Workbooks.Open(FileName:=scexcel)\n</code></pre>\n\n<p>Note that <code>scexcel</code> is the path of Excel file. </p>\n\n<p>Can you please help me with this problem?</p>\n"}, {"tags": ["html", "vba", "excel", "upload", "image-uploading"], "comments": [{"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1445894479, "post_id": 33253517, "comment_id": 54507565, "body": "1st, you&#39;re navigating to <code>URL</code>, but declared <code>DestURL</code> so the code should be: <code>WebBrowser.Navigate DestURL</code>. 2nd, look at the HTML source. The file selection box at that URL is in an iframe, so the input is really called <code>fileUpload</code> and resides at free-online-ocr.com/upload.aspx. Other controls on that page are programmatically created and hidden (eg <code>__EVENTVALIDATION</code>) and likely exist solely to prevent scripted automation of their free service. It may be that instead of sending the file as if a button were pressed, you may want to investigate automating the file selection process."}, {"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1445954659, "post_id": 33253517, "comment_id": 54534689, "body": "I looked at this again, and you have another issue. The link (OCR Site) in your description is to newocr.com, but the link in your code is to free-online-ocr.com. That makes it unclear which site you&#39;re actually trying to interface with and the code is drastically different depending on which site you actually intend to automate. Is this just some link building scheme for search engine rankings, or do you need to clean up your post?"}, {"owner": {"reputation": 1054, "user_id": 4570833, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/32210239f8744a4f4b127350f75e54e2?s=128&d=identicon&r=PG&f=1", "display_name": "Adhil", "link": "https://stackoverflow.com/users/4570833/adhil"}, "reply_to_user": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1446000271, "post_id": 33253517, "comment_id": 54557695, "body": "its newocr.com, I did noticed that and reconfigured the code accordingly before I posted. sorry I used the wrong OCR Site here."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1446097548, "post_id": 33253517, "comment_id": 54604718, "body": "<a href=\"https://wqweto.wordpress.com/2011/07/12/vb6-using-wininet-to-post-binary-file/\" rel=\"nofollow noreferrer\">wqweto.wordpress.com/2011/07/12/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1054, "user_id": 4570833, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/32210239f8744a4f4b127350f75e54e2?s=128&d=identicon&r=PG&f=1", "display_name": "Adhil", "link": "https://stackoverflow.com/users/4570833/adhil"}, "edited": false, "score": 1, "creation_date": 1445848624, "post_id": 33314905, "comment_id": 54478642, "body": "Thank you so much, maybe you could elaborate a bit further regarding this?"}, {"owner": {"reputation": 1054, "user_id": 4570833, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/32210239f8744a4f4b127350f75e54e2?s=128&d=identicon&r=PG&f=1", "display_name": "Adhil", "link": "https://stackoverflow.com/users/4570833/adhil"}, "edited": false, "score": 0, "creation_date": 1445848812, "post_id": 33314905, "comment_id": 54478733, "body": "Thank you so much, but how can you but how can you send a multibyte data to the web browser?"}, {"owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "reply_to_user": {"reputation": 1054, "user_id": 4570833, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/32210239f8744a4f4b127350f75e54e2?s=128&d=identicon&r=PG&f=1", "display_name": "Adhil", "link": "https://stackoverflow.com/users/4570833/adhil"}, "edited": false, "score": 0, "creation_date": 1445848859, "post_id": 33314905, "comment_id": 54478758, "body": "The link which i have provided contains detail solution."}, {"owner": {"reputation": 1054, "user_id": 4570833, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/32210239f8744a4f4b127350f75e54e2?s=128&d=identicon&r=PG&f=1", "display_name": "Adhil", "link": "https://stackoverflow.com/users/4570833/adhil"}, "edited": false, "score": 0, "creation_date": 1445854429, "post_id": 33314905, "comment_id": 54481881, "body": "I am using the code from the link given in the link you sent me -&gt; <a href=\"http://www.motobit.com/tips/detpg_uploadvbsie/\" rel=\"nofollow noreferrer\">link</a>, but the file still isn&#39;t getting uploaded."}, {"owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "reply_to_user": {"reputation": 1054, "user_id": 4570833, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/32210239f8744a4f4b127350f75e54e2?s=128&d=identicon&r=PG&f=1", "display_name": "Adhil", "link": "https://stackoverflow.com/users/4570833/adhil"}, "edited": false, "score": 0, "creation_date": 1445856138, "post_id": 33314905, "comment_id": 54482930, "body": "@R3uK Could you plz help adhil in this."}, {"owner": {"reputation": 1054, "user_id": 4570833, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/32210239f8744a4f4b127350f75e54e2?s=128&d=identicon&r=PG&f=1", "display_name": "Adhil", "link": "https://stackoverflow.com/users/4570833/adhil"}, "edited": false, "score": 0, "creation_date": 1445869183, "post_id": 33314905, "comment_id": 54491396, "body": "Does anyone have an answer?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1446024511, "post_id": 33314905, "comment_id": 54566744, "body": "@newjenn : I already offered the bounty, so I won&#39;t spend a lot of time on this (and I&#39;ve never worked with this, I&#39;m just interested to see how that could work). If you want the bounty, edit your answer to be more detailed or directly applied to the OP question so that he can understand. Have you a working solution? Because this not a &quot;link only question&quot; (flag qualification), but it is not really detailed either! Good luck with this! ;)"}, {"owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1446029377, "post_id": 33314905, "comment_id": 54569896, "body": "@R3uK I asked because i thought you knew the answer. Hope for the best. I am also don&#39;t know the exact solution."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1446195931, "post_id": 33314905, "comment_id": 54652526, "body": "@newjenn : I don&#39;t know the exact, I might arrive to it with some work, but I&#39;m pretty limited on time. The bounty is almost over, if you want the 50 points, please try to elaborate more (there is also a link that was post into the OP comments). good luck!"}, {"owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1446197538, "post_id": 33314905, "comment_id": 54653492, "body": "@R3uK I try to be elaborate. Hope some one get the infomtion and provide complete solution."}, {"owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1446200744, "post_id": 33314905, "comment_id": 54655543, "body": "@R3uK you are generous. Thanks"}, {"owner": {"reputation": 282, "user_id": 5314940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1rJke.gif?s=128&g=1", "display_name": "Micha\u0142 Lipok", "link": "https://stackoverflow.com/users/5314940/micha%c5%82-lipok"}, "edited": false, "score": 0, "creation_date": 1610973927, "post_id": 33314905, "comment_id": 116293688, "body": "Any body have complete solution? It look like example from  <code>http:&#47;&#47;www.motobit.com&#47;tips&#47;detpg_uploadvbsie&#47;</code> do not work."}], "tags": [], "owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "is_accepted": false, "score": 2, "last_activity_date": 1446197476, "last_edit_date": 1446197476, "creation_date": 1445665030, "answer_id": 33314905, "question_id": 33253517, "link": "https://stackoverflow.com/questions/33253517/upload-a-file-via-input-input-in-html-form-with-vba/33314905#33314905", "title": "Upload a file via &lt;input \\input&gt; in HTML form with VBA", "body": "<p>You can use ScriptUtils.ASPForm to accept uploaded files in ASP. ScriptUtils.ASPForm contains hi-performance, low resources consumption algorithm which can accept up to 2GB of data.</p>\n\n<ol>\n<li><p>There are some steps to upload file using http and multipart/form-data document. First of all we have to read file from a disk. We can use Scripting.FileSystemObject to read text data, or ADODB.Stream to read any file. The GetFile function does the work using ADODB.Stream.</p></li>\n<li><p>The second task we need to complete is a build of multipart/form-data document. The document contains from several fields separated by boundary. Each of the fields has its own header, which contains information about field name, file name and content-type of the source file. ADO Recordset object has a great method AppendChunk, which lets you join parts of multipart/form-data document (open boundary + headers + file contents + close boundary). You can see the code in BuildFormData function.</p></li>\n<li><p>Last task is send the multipart/form-data document as a post request to server with multipart/form-data Content-Type header. We can use at least two object to send POST request - XMLHttp or InternetExplorer. This script uses Navigate method of InternetExplorer.Application object. You can see the code in IEPostBinaryRequest function</p></li>\n</ol>\n\n<p>please look into the below link for more information.</p>\n\n<p><a href=\"http://www.motobit.com/tips/detpg_uploadvbsie/\" rel=\"nofollow\">http://www.motobit.com/tips/detpg_uploadvbsie/</a></p>\n\n<p>GetFile method is converting the file to UTF-8. \nPdf will have more than 128 byte, \nyou need to convert it to multi byte string</p>\n\n<pre><code>'Converts OLE string To multibyte stringFunction StringToMB(S)\n  Dim I, B\n  For I = 1 To Len(S)\n    B = B &amp; ChrB(Asc(Mid(S, I, 1)))\n  Next\n  StringToMB = B End Function\n</code></pre>\n\n<p>Please refer this page</p>\n\n<p><a href=\"http://www.mrexcel.com/forum/excel-questions/861695-using-xmlhttp-upload-file-api.html#post4192153\" rel=\"nofollow\">http://www.mrexcel.com/forum/excel-questions/861695-using-xmlhttp-upload-file-api.html#post4192153</a></p>\n"}, {"tags": [], "owner": {"reputation": 1750, "user_id": 5904821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f67d465df9dc23fa24ada92ec31dc26?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Moss", "link": "https://stackoverflow.com/users/5904821/rich-moss"}, "is_accepted": false, "score": 0, "last_activity_date": 1483465211, "last_edit_date": 1495541787, "creation_date": 1483465211, "answer_id": 41449259, "question_id": 33253517, "link": "https://stackoverflow.com/questions/33253517/upload-a-file-via-input-input-in-html-form-with-vba/41449259#41449259", "title": "Upload a file via &lt;input \\input&gt; in HTML form with VBA", "body": "<p>I've spent several days experimenting with the same technique - using the Navigate method of the InternetExplorer.Application COM interface to upload a file. <br/>\nThe documentation for <a href=\"https://msdn.microsoft.com/en-us/library/aa752093(v=vs.85).aspx\" rel=\"nofollow noreferrer\">Navigate</a> indicates that specifying the postdata parameter will trigger an HTTP POST, but in my experience the Content-Type is also a determining factor. Using Fiddler I found that it was consistently sending GET HTTP method instead of POST when Content-Type = multipart/form-data. <br/></p>\n\n<p>Sending the GET verb will tell the server to ignore any form data, and only process the URI. <br/></p>\n\n<p><a href=\"https://stackoverflow.com/questions/24971418/get-response-header-using-internetexplorer-applicaion\">This page</a> indicates he had some success with the XMLHTTP object that allows finer control over the HTTP request. Here's some Powershell code that demonstrates this technique: <br/></p>\n\n<pre><code>$http = (New-Object -ComObject \"MSXML2.XMLHTTP\") \n$http.Open(\"POST\",$DestURL,$false)\n$http.SetRequestHeader(\"Content-Type\", \"multipart/form-data; boundary=\" + $boundary)\n$http.Send($PostData) \n</code></pre>\n"}], "owner": {"reputation": 1054, "user_id": 4570833, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/32210239f8744a4f4b127350f75e54e2?s=128&d=identicon&r=PG&f=1", "display_name": "Adhil", "link": "https://stackoverflow.com/users/4570833/adhil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2132, "favorite_count": 2, "answer_count": 2, "score": 6, "last_activity_date": 1483465211, "creation_date": 1445412959, "last_edit_date": 1445962527, "question_id": 33253517, "link": "https://stackoverflow.com/questions/33253517/upload-a-file-via-input-input-in-html-form-with-vba", "title": "Upload a file via &lt;input \\input&gt; in HTML form with VBA", "body": "<p>I am trying to upload a picture file to <a href=\"https://www.newocr.com/\" rel=\"noreferrer\">OCR Site</a>, however, the PDF file doesn't get uploaded into the site. </p>\n\n<p>I am using the following code to achieve it and below is the HTML segment :</p>\n\n<pre><code>Sub DownPDF()\n\n    Dim FileName As String: FileName = \"C:\\Users\\310217955\\Documents\\pdfdown\\SGSSI001_HL1464_2011.pdf\"\n    Dim DestURL As String: DestURL = \"https://www.newocr.com/\"\n    Dim FieldName As String: FieldName = \"userfile\"\n    Call UploadFile(DestURL, FileName, FieldName)\n\nEnd Sub\n\n\n'******************* upload - begin\n'Upload file using input type=file\nSub UploadFile(DestURL, FileName, FieldName)\n  'Boundary of fields.\n  'Be sure this string is Not In the source file\n  Const Boundary = \"---------------------------0123456789012\"\n\n  Dim FileContents, FormData\n  'Get source file As a binary data.\n  FileContents = GetFile(FileName)\n\n  'Build multipart/form-data document\n  FormData = BuildFormData(FileContents, Boundary, FileName, FieldName)\n\n  'Post the data To the destination URL\n  IEPostBinaryRequest DestURL, FormData, Boundary\nEnd Sub\n\n'Build multipart/form-data document with file contents And header info\nFunction BuildFormData(FileContents, Boundary, FileName, FieldName)\n  Dim FormData, Pre, Po\n  Const ContentType = \"application/upload\"\n\n  'The two parts around file contents In the multipart-form data.\n  Pre = \"--\" + Boundary + vbCrLf + mpFields(FieldName, FileName, ContentType)\n  Po = vbCrLf + \"--\" + Boundary + \"--\" + vbCrLf\n\n  'Build form data using recordset binary field\n  Const adLongVarBinary = 205\n  Dim RS: Set RS = CreateObject(\"ADODB.Recordset\")\n  RS.Fields.Append \"b\", adLongVarBinary, Len(Pre) + LenB(FileContents) + Len(Po)\n  RS.Open\n  RS.AddNew\n    Dim LenData\n    'Convert Pre string value To a binary data\n    LenData = Len(Pre)\n    RS(\"b\").AppendChunk (StringToMB(Pre) &amp; ChrB(0))\n    Pre = RS(\"b\").GetChunk(LenData)\n    RS(\"b\") = \"\"\n\n    'Convert Po string value To a binary data\n    LenData = Len(Po)\n    RS(\"b\").AppendChunk (StringToMB(Po) &amp; ChrB(0))\n    Po = RS(\"b\").GetChunk(LenData)\n    RS(\"b\") = \"\"\n\n    'Join Pre + FileContents + Po binary data\n    RS(\"b\").AppendChunk (Pre)\n    RS(\"b\").AppendChunk (FileContents)\n    RS(\"b\").AppendChunk (Po)\n  RS.Update\n  FormData = RS(\"b\")\n  RS.Close\n  BuildFormData = FormData\nEnd Function\n\n'sends multipart/form-data To the URL using IE\nFunction IEPostBinaryRequest(URL, FormData, Boundary)\n  'Create InternetExplorer\n  Dim IE: Set IE = CreateObject(\"InternetExplorer.Application\")\n\n  'You can uncoment Next line To see form results\n  IE.Visible = True\n\n  'Send the form data To URL As POST multipart/form-data request\n  IE.Navigate URL, , , FormData, _\n    \"Content-Type: multipart/form-data; boundary=\" + Boundary + vbCrLf\n\n  Do While IE.Busy Or IE.readyState &lt;&gt; 4\n    Wait 1, \"Upload To \" &amp; URL\n  Loop\n\n  'Get a result of the script which has received upload\n  On Error Resume Next\n  IEPostBinaryRequest = IE.document.body.innerHTML\n  'IE.Quit\nEnd Function\n\n'Infrormations In form field header.\nFunction mpFields(FieldName, FileName, ContentType)\n  Dim MPTemplate 'template For multipart header\n  MPTemplate = \"Content-Disposition: form-data; name=\"\"{field}\"\";\" + _\n   \" filename=\"\"{file}\"\"\" + vbCrLf + _\n   \"Content-Type: {ct}\" + vbCrLf + vbCrLf\n  Dim Out\n  Out = Replace(MPTemplate, \"{field}\", FieldName)\n  Out = Replace(Out, \"{file}\", FileName)\n  mpFields = Replace(Out, \"{ct}\", ContentType)\nEnd Function\n\n\nSub Wait(Seconds, Message)\n  On Error Resume Next\n  CreateObject(\"wscript.shell\").Popup Message, Seconds, \"\", 64\nEnd Sub\n\n\n'Returns file contents As a binary data\nFunction GetFile(FileName)\n  Dim Stream: Set Stream = CreateObject(\"ADODB.Stream\")\n  Stream.Type = 1 'Binary\n  Stream.Open\n  Stream.LoadFromFile FileName\n  GetFile = Stream.Read\n  Stream.Close\nEnd Function\n\n'Converts OLE string To multibyte string\nFunction StringToMB(S)\n  Dim I, B\n  For I = 1 To Len(S)\n    B = B &amp; ChrB(Asc(Mid(S, I, 1)))\n  Next\n  StringToMB = B\nEnd Function\n'******************* upload - end\n\n'******************* Support\n'Basic script info\nSub InfoEcho()\n  Dim Msg\n  Msg = Msg + \"Upload file using http And multipart/form-data\" &amp; vbCrLf\n  Msg = Msg + \"Copyright (C) 2001 Antonin Foller, PSTRUH Software\" &amp; vbCrLf\n  Msg = Msg + \"use\" &amp; vbCrLf\n  Msg = Msg + \"[cscript|wscript] fupload.vbs file url [fieldname]\" &amp; vbCrLf\n  Msg = Msg + \"  file ... Local file To upload\" &amp; vbCrLf\n  Msg = Msg + \"  url ... URL which can accept uploaded data\" &amp; vbCrLf\n  Msg = Msg + \"  fieldname ... Name of the source form field.\" &amp; vbCrLf\n  Msg = Msg + vbCrLf + CheckRequirements\n  WScript.Echo Msg\n  WScript.Quit\nEnd Sub\n\n'Checks If all of required objects are installed\nFunction CheckRequirements()\n  Dim Msg\n  Msg = \"This script requires some objects installed To run properly.\" &amp; vbCrLf\n  Msg = Msg &amp; CheckOneObject(\"ADODB.Recordset\")\n  Msg = Msg &amp; CheckOneObject(\"ADODB.Stream\")\n  Msg = Msg &amp; CheckOneObject(\"InternetExplorer.Application\")\n  CheckRequirements = Msg\n'  MsgBox Msg\nEnd Function\n\n'Checks If the one object is installed.\nFunction CheckOneObject(oClass)\n  Dim Msg\n  On Error Resume Next\n  CreateObject oClass\n  If Err = 0 Then Msg = \"OK\" Else Msg = \"Error:\" &amp; Err.Description\n  CheckOneObject = oClass &amp; \" - \" &amp; Msg &amp; vbCrLf\nEnd Function\n</code></pre>\n\n<p>Here is the HTML segment.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;input name=\"userfile\" id=\"userfile\" type=\"file\"&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 1355, "user_id": 4121920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/183acca97aee37decce653048e68f307?s=128&d=identicon&r=PG&f=1", "display_name": "Coder375", "link": "https://stackoverflow.com/users/4121920/coder375"}, "is_accepted": false, "score": 0, "last_activity_date": 1445411778, "creation_date": 1445411778, "answer_id": 33253126, "question_id": 33252826, "link": "https://stackoverflow.com/questions/33252826/vba-vlookup-for-entire-column/33253126#33253126", "title": "Vba: vlookup for entire column", "body": "<p>You could use relative references in an R1C1 formula, then just paste it to your destination range, you'd need to find the destination range first, perhaps using something like .end(xldown).row </p>\n\n<p>See this for reference on the general idea:</p>\n\n<p><a href=\"http://macromatician.blogspot.co.uk/2013/02/how-to-add-formula-to-worksheet-range.html\" rel=\"nofollow\">http://macromatician.blogspot.co.uk/2013/02/how-to-add-formula-to-worksheet-range.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 590, "user_id": 2250595, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/74f417b7aa939eaad4b1afb301487ad4?s=128&d=identicon&r=PG", "display_name": "mauek unak", "link": "https://stackoverflow.com/users/2250595/mauek-unak"}, "is_accepted": false, "score": 2, "last_activity_date": 1445422835, "creation_date": 1445422835, "answer_id": 33256756, "question_id": 33252826, "link": "https://stackoverflow.com/questions/33252826/vba-vlookup-for-entire-column/33256756#33256756", "title": "Vba: vlookup for entire column", "body": "<p>let's say you want to add formula <code>=VLOOKUP(B2,'VLOOKUP Table'!A$2:B$1000,2,TRUE)</code>\nto range D3:D10, where 'B2' will increment after every row, then the code would be :</p>\n\n<pre><code>Range(\"D3:D10\").Formula= \"=VLOOKUP(B2,'VLOOKUP Table'!A$2:B$1000,2,TRUE)\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 148, "user_id": 5358214, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4abea1cb7447d094bb060ae269ffb7a0?s=128&d=identicon&r=PG&f=1", "display_name": "Uppah", "link": "https://stackoverflow.com/users/5358214/uppah"}, "is_accepted": false, "score": 1, "last_activity_date": 1445499652, "creation_date": 1445499652, "answer_id": 33275678, "question_id": 33252826, "link": "https://stackoverflow.com/questions/33252826/vba-vlookup-for-entire-column/33275678#33275678", "title": "Vba: vlookup for entire column", "body": "<pre><code>Dim This As Worksheet\n\nSet This = ThisWorkbook.Sheets(1)\n\nThis.Activate\n    This.Range(\"D7\", Range(\"A2\").End(xlDown).Offset(0, 3)).Formula = \"=VLOOKUP(B2,[INSERT SHEET]!$A:$D,2,FALSE)\"\n</code></pre>\n\n<p>If the data is in sheet2, you just insert <code>sheet2</code> in the <code>[INSERT SHEET]</code>. It doesn't matter if the name is sheet2 or named something else, just call it sheet2</p>\n"}], "owner": {"reputation": 21, "user_id": 5438879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b78f8fe91382388da6895e01dd12750?s=128&d=identicon&r=PG&f=1", "display_name": "jlyh11", "link": "https://stackoverflow.com/users/5438879/jlyh11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12215, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1445499652, "creation_date": 1445410552, "question_id": 33252826, "link": "https://stackoverflow.com/questions/33252826/vba-vlookup-for-entire-column", "title": "Vba: vlookup for entire column", "body": "<p>I have column B with cost centre codes and column D with department. i need to do a vlookup to fill in the department name of the relevant cost centre code. </p>\n\n<p>The current code is like this:\nDim MyStringVar1= Application.Vlookup(Range(\"B7\"),_\nWorksheets(\"VLOOKUP Table\").Range(\"A2:B1000\"),2,True)</p>\n\n<p>However, i dont just want to do vlookup for D7 only but rather the entire column. My range is not fixed(there may be 100 or 200rows in Column B,depending on the number of projects.)</p>\n\n<p>How do I apply the formula for the entire column? Instead of D7 only</p>\n"}, {"tags": ["vba", "excel", "runtime-error", "do-while"], "comments": [{"owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 0, "creation_date": 1445400883, "post_id": 33250783, "comment_id": 54303403, "body": "&quot;When written like this I get runtime errors.&quot; If only there was a way we could see those errors ... hang on a sec, I&#39;ve just had a thought - you could <b><i>post them along with your question!!</i></b> :-) In any case, executing <code>Do While quantity &lt; 0</code> <i>before</i> checking if it&#39;s a number is probably not going to work."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 5469773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40568e2c2ce7ac72a4cade5e2ca6a377?s=128&d=identicon&r=PG&f=1", "display_name": "S. Dixon", "link": "https://stackoverflow.com/users/5469773/s-dixon"}, "edited": false, "score": 0, "creation_date": 1445403634, "post_id": 33250966, "comment_id": 54304172, "body": "Thank you for this, solves the problem perfectly. Also thank you for elaborating on where I went wrong and the changes you made, very big help!"}], "tags": [], "owner": {"reputation": 9447, "user_id": 934407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e4853446771f472109e6944025c6791?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/934407/matt"}, "is_accepted": true, "score": 1, "last_activity_date": 1445446477, "last_edit_date": 1445446477, "creation_date": 1445401753, "answer_id": 33250966, "question_id": 33250783, "link": "https://stackoverflow.com/questions/33250783/vba-excel-do-while-loop-runtime-error/33250966#33250966", "title": "VBA Excel Do While Loop Runtime Error", "body": "<p>Have made a couple of changes to your code:</p>\n\n<ol>\n<li>Used the IsNumeric function Or'ed with a test for the value in the loop: the Val function will convert any non numeric value to zero so this statement allows you to check both whether the user entered a number and if so is it zero or above.</li>\n<li>Amended the message to make it clear to the user that anything less than zero isn't valid, previously they could have entered a negative number and been told they hadn't entered a number at all.</li>\n<li>I've also returned the value after converting it, previously you weren't returning it from the function.</li>\n</ol>\n\n<p>You might also want to consider allowing the user to use the cancel option from the input box. This will return an empty string and as it stands would be confusing and a little annoying for the user if they clicked cancel and was continuously told to enter a number. You could return a default value in this case perhaps, depends on how you need to use this function.</p>\n\n<p>Also, this function will currently allow the user to enter integers and decimals, presumably this is what you need. It's a good idea to use specific types for your functions (as well as for their parameters) so adding As String to the prompt parameter and perhaps As Double to the function would make the code clearer and give you more compile time safety.</p>\n\n<pre><code>Function getQuantity(prompt)\n\nDim quantity As String\nquantity = InputBox(prompt)\n\nDo While Not IsNumeric(quantity) Or Val(quantity) &lt; 0\n    MsgBox (\"Incorrect value, please enter a valid number of zero or above\")\n    quantity = InputBox(prompt)\nLoop\n\ngetQuantity = Val(quantity)\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5469773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40568e2c2ce7ac72a4cade5e2ca6a377?s=128&d=identicon&r=PG&f=1", "display_name": "S. Dixon", "link": "https://stackoverflow.com/users/5469773/s-dixon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 962, "favorite_count": 0, "accepted_answer_id": 33250966, "answer_count": 1, "score": 1, "last_activity_date": 1445446477, "creation_date": 1445400417, "last_edit_date": 1531164843, "question_id": 33250783, "link": "https://stackoverflow.com/questions/33250783/vba-excel-do-while-loop-runtime-error", "title": "VBA Excel Do While Loop Runtime Error", "body": "<p><br/>\nVery new to coding with VBA in excel, what I'm trying to do is have a Do While loop that takes user input and if it is either not a number or less than 0 returns an error message and re-prompts the user to enter a value until it hits the prerequisites. I have tried doing this in a few ways but cant seem to figure out the specifics behind it. My code currently looks like:</p>\n\n<pre><code>Function getQuantity(prompt)\n\nDim quantity As String\n\nquantity = InputBox(prompt)\n\nDo While quantity &lt; 0\n    If Not IsNumeric(quantity) Then\n        MsgBox (\"Incorrect Value, Numbers Only Please!\")\n        quantity = InputBox(prompt)\n    End If\nLoop\n\nEnd Function\n</code></pre>\n\n<p>When written like this I get runtime errors.<br/><br/> If I just use: </p>\n\n<pre><code>Function getQuantity(prompt)\n\nDim quantity As String\n\nquantity = InputBox(prompt)\n\n If Not IsNumeric(quantity) Then\n        MsgBox (\"Incorrect Value, Numbers Only Please!\")\n        quantity = InputBox(prompt)\n End If\n\nEnd Function\n</code></pre>\n\n<p>this, it does what I want except it only re-prompts once before continuing because it is not in a loop. Basically I want it to loop until it gets a number that is 0 or greater, and displays the error message and re-prompts the user until this happens.  <br/> <br/> Thanks in advance for any help!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1445398300, "post_id": 33250260, "comment_id": 54302723, "body": "What are you trying to do? This does not make sense to me."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1449587689, "post_id": 33250260, "comment_id": 56065492, "body": "Have you tried the answer provided?"}], "answers": [{"tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": true, "score": 1, "last_activity_date": 1445405408, "creation_date": 1445405408, "answer_id": 33251609, "question_id": 33250260, "link": "https://stackoverflow.com/questions/33250260/autofill-simulation/33251609#33251609", "title": "AutoFill simulation", "body": "<p>Your code needs several improvements, but this line:</p>\n\n<pre><code>Selection.AutoFill Destination:=Range(Cells(Count, A), Cells(Count, B)), Type:=xlFillDefault\n</code></pre>\n\n<p>in particular is the one giving the error 1004.</p>\n\n<p>At this point the <code>Selection</code> range is cell <code>A2</code> however the <code>Destination</code> range is <code>A1</code> and the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff195345(v=office.15).aspx\" rel=\"nofollow\">Range.AutoFill Method</a> specifically says:</p>\n\n<blockquote>\n  <p>The destination must include the source range.</p>\n</blockquote>\n\n<p>Correct this line but also it's suggested:</p>\n\n<ul>\n<li>A complete debug of the code</li>\n<li>Declare all your variables</li>\n<li>Avoid the use of the Select method</li>\n</ul>\n"}], "owner": {"reputation": 200, "user_id": 5024605, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/15efe9db962038121154688795014a40?s=128&d=identicon&r=PG&f=1", "display_name": "SunRay", "link": "https://stackoverflow.com/users/5024605/sunray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 33251609, "answer_count": 1, "score": -1, "last_activity_date": 1445405408, "creation_date": 1445396835, "last_edit_date": 1445399123, "question_id": 33250260, "link": "https://stackoverflow.com/questions/33250260/autofill-simulation", "title": "AutoFill simulation", "body": "<p>I am running a simulation to find out the number of trials needed to run before a success is found. This is my sample idea of how it is going to work. Column A contains a simple formula <code>=A1+1</code> (which means previous row +1). The simulation should end when the value reaches <code>10</code>.  </p>\n\n<pre><code>Sub RunEX25()  \nA = 1  \nB = 1  \nDo While True  \n     Count = Count + 1\n     Range(\"A2\").Select  \n     Selection.AutoFill Destination:=Range(Cells(Count, A), Cells(Count, B)), Type:=xlFillDefault\n     Cells(Count, A).Select  \n     If Cells(Count, A).Value = 10 Then  \n         Exit Do  \n     End If  \nLoop\n</code></pre>\n\n<p>The problem when I run this code is that error 1004 pops out.</p>\n\n<p>Can anyone help me rectify this problem?</p>\n"}, {"tags": ["sql", "excel", "vba", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 534, "user_id": 4544699, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/94a327d133b968b7357f5764fc8178d5?s=128&d=identicon&r=PG&f=1", "display_name": "IronKirby", "link": "https://stackoverflow.com/users/4544699/ironkirby"}, "edited": false, "score": 0, "creation_date": 1445395879, "post_id": 33250119, "comment_id": 54302144, "body": "Job has the data type Number with a field size of &quot;double&quot; and is accepting up to 4 Decimal Places."}, {"owner": {"reputation": 360, "user_id": 3222163, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3183d7919c011d0cb6516561e026e64d?s=128&d=identicon&r=PG&f=1", "display_name": "danielle", "link": "https://stackoverflow.com/users/3222163/danielle"}, "reply_to_user": {"reputation": 534, "user_id": 4544699, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/94a327d133b968b7357f5764fc8178d5?s=128&d=identicon&r=PG&f=1", "display_name": "IronKirby", "link": "https://stackoverflow.com/users/4544699/ironkirby"}, "edited": false, "score": 0, "creation_date": 1445398078, "post_id": 33250119, "comment_id": 54302653, "body": "have you tried casting your job variable to double? Try changing this: &#39;Job = Worksheets(&quot;test&quot;).Range(&quot;D2&quot;).Value&#39; to this: &#39;Job = CDbl(Worksheets(&quot;test&quot;).Range(&quot;D2&quot;).Value)&#39;"}, {"owner": {"reputation": 534, "user_id": 4544699, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/94a327d133b968b7357f5764fc8178d5?s=128&d=identicon&r=PG&f=1", "display_name": "IronKirby", "link": "https://stackoverflow.com/users/4544699/ironkirby"}, "edited": false, "score": 0, "creation_date": 1445400825, "post_id": 33250119, "comment_id": 54303389, "body": "Hi Danielle, I tried that as well and it&#39;s the same error still. :("}, {"owner": {"reputation": 360, "user_id": 3222163, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3183d7919c011d0cb6516561e026e64d?s=128&d=identicon&r=PG&f=1", "display_name": "danielle", "link": "https://stackoverflow.com/users/3222163/danielle"}, "reply_to_user": {"reputation": 534, "user_id": 4544699, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/94a327d133b968b7357f5764fc8178d5?s=128&d=identicon&r=PG&f=1", "display_name": "IronKirby", "link": "https://stackoverflow.com/users/4544699/ironkirby"}, "edited": false, "score": 0, "creation_date": 1445405434, "post_id": 33250119, "comment_id": 54304748, "body": "Can you put a breakpoint on <i>cn.Execute strQuery</i> and take note of the value of <i>strQuery</i> and post it here?"}, {"owner": {"reputation": 534, "user_id": 4544699, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/94a327d133b968b7357f5764fc8178d5?s=128&d=identicon&r=PG&f=1", "display_name": "IronKirby", "link": "https://stackoverflow.com/users/4544699/ironkirby"}, "edited": false, "score": 0, "creation_date": 1445406429, "post_id": 33250119, "comment_id": 54305082, "body": "strQuery = &quot;INSERT INTO MasterTable ([Id], [Positions], [BU], [Job]) VALUES (&quot;&quot;, &quot;Business Analyst&quot;, &quot;Finance&quot;, 0.8); &quot; And then it breaks at that point for reasons unknown."}, {"owner": {"reputation": 360, "user_id": 3222163, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3183d7919c011d0cb6516561e026e64d?s=128&d=identicon&r=PG&f=1", "display_name": "danielle", "link": "https://stackoverflow.com/users/3222163/danielle"}, "reply_to_user": {"reputation": 534, "user_id": 4544699, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/94a327d133b968b7357f5764fc8178d5?s=128&d=identicon&r=PG&f=1", "display_name": "IronKirby", "link": "https://stackoverflow.com/users/4544699/ironkirby"}, "edited": false, "score": 0, "creation_date": 1445406677, "post_id": 33250119, "comment_id": 54305187, "body": "can you also post the structure of <i>ID</i>, <i>Positions</i>, and <i>BU</i>"}, {"owner": {"reputation": 534, "user_id": 4544699, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/94a327d133b968b7357f5764fc8178d5?s=128&d=identicon&r=PG&f=1", "display_name": "IronKirby", "link": "https://stackoverflow.com/users/4544699/ironkirby"}, "edited": false, "score": 0, "creation_date": 1445406968, "post_id": 33250119, "comment_id": 54305323, "body": "ID - Automated Number, Positions (String), BU (String)"}, {"owner": {"reputation": 534, "user_id": 4544699, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/94a327d133b968b7357f5764fc8178d5?s=128&d=identicon&r=PG&f=1", "display_name": "IronKirby", "link": "https://stackoverflow.com/users/4544699/ironkirby"}, "edited": false, "score": 0, "creation_date": 1445408186, "post_id": 33250119, "comment_id": 54305853, "body": "Hi Danielle, I actually included the number field and had it populated - and it FINALLY inserts now. I didn&#39;t realize that because I had the type set as AUTO Populate, I don&#39;t need to insert data. But because in my insert statement I still referenced ID, it chucked an error message because It was inserting &quot;NULL&quot; values in the ID area. Thanks for your help!"}, {"owner": {"reputation": 360, "user_id": 3222163, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3183d7919c011d0cb6516561e026e64d?s=128&d=identicon&r=PG&f=1", "display_name": "danielle", "link": "https://stackoverflow.com/users/3222163/danielle"}, "reply_to_user": {"reputation": 534, "user_id": 4544699, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/94a327d133b968b7357f5764fc8178d5?s=128&d=identicon&r=PG&f=1", "display_name": "IronKirby", "link": "https://stackoverflow.com/users/4544699/ironkirby"}, "edited": false, "score": 0, "creation_date": 1445408466, "post_id": 33250119, "comment_id": 54305975, "body": "Glad to have helped you! :)"}], "tags": [], "owner": {"reputation": 360, "user_id": 3222163, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3183d7919c011d0cb6516561e026e64d?s=128&d=identicon&r=PG&f=1", "display_name": "danielle", "link": "https://stackoverflow.com/users/3222163/danielle"}, "is_accepted": true, "score": 1, "last_activity_date": 1445407687, "last_edit_date": 1445407687, "creation_date": 1445395687, "answer_id": 33250119, "question_id": 33249650, "link": "https://stackoverflow.com/questions/33249650/data-type-mismatch-access-2010/33250119#33250119", "title": "Data-type mismatch Access 2010", "body": "<p>Do you intend the value of <em>ID</em> to be obtained from the excel (<code>Id = Worksheets(\"test\").Range(\"A2\").Value</code>)? </p>\n\n<p>I think it is causing the error. If a field on access is of AutoNumber data type, you don't have to include it on your INSERT query as access automatically assigns a value for this in incremental manner. </p>\n\n<p>If you want access to automatically assign a value for <em>ID</em>, change this: </p>\n\n<pre><code>    strQuery = \"INSERT INTO MasterTable ([Id], [Positions], [BU], [Job]) \" &amp; _\n           \"VALUES (\"\"\" &amp; Id &amp; \"\"\", \"\"\" &amp; Positions &amp; \"\"\", \"\"\" &amp; BU &amp; \"\"\", \" &amp; Job &amp; \"); \"\n</code></pre>\n\n<p>to this: </p>\n\n<pre><code>     strQuery = \"INSERT INTO MasterTable ([Positions], [BU], [Job]) \" &amp; _\n           \"VALUES (\"\"\" &amp; Positions &amp; \"\"\", \"\"\" &amp; BU &amp; \"\"\", \" &amp; Job &amp; \"); \"\n</code></pre>\n"}], "owner": {"reputation": 534, "user_id": 4544699, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/94a327d133b968b7357f5764fc8178d5?s=128&d=identicon&r=PG&f=1", "display_name": "IronKirby", "link": "https://stackoverflow.com/users/4544699/ironkirby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "accepted_answer_id": 33250119, "answer_count": 1, "score": 1, "last_activity_date": 1445407687, "creation_date": 1445392239, "last_edit_date": 1445406513, "question_id": 33249650, "link": "https://stackoverflow.com/questions/33249650/data-type-mismatch-access-2010", "title": "Data-type mismatch Access 2010", "body": "<p>We have been creating a HR Database using Access as the back-end and Excel as the front-end. When I run my macro in Excel to insert entries into the MasterTable it says; \"Data Type Mismatch\". The only field that I had changed was the \"Job\" Field which required a value between <code>0.0</code> - <code>1.0</code> (i.e. <code>0.2</code> means they are only working one day).</p>\n\n<p>Previously when I inserted entries in the decimal place would not show until I changed the field type in Access to accept decimals. After this change, the macro no longer works.  </p>\n\n<p>Can anyone point out why this is?  </p>\n\n<p>I have only just started learning SQL/Access so it is very likely I made a very basic mistake.</p>\n\n<p>I searched up on SO a few other answers which talked about using the DECIMAL field instead of changing the properties field but this didn't solve my issue. My code:  </p>\n\n  \n\n<pre><code>    Sub ExportDataToAccess()\n\n    Dim cn As Object\n    Dim strQuery As String\n    Dim Id As String\n    Dim Positions As String\n    Dim BU As String\n    Dim Job As Double\n    Dim Variance As String\n    Dim myDB As String\n\n    'Initialize Variables\n    Id = Worksheets(\"test\").Range(\"A2\").Value\n    Positions = Worksheets(\"test\").Range(\"B2\").Value\n    BU = Worksheets(\"test\").Range(\"C2\").Value\n    Job = Worksheets(\"test\").Range(\"D2\").Value\n    myDB = \"X:\\Users\\ADMIN\\Documents\\HR_Establishment_DB1.accdb\"\n    Set cn = CreateObject(\"ADODB.Connection\")\n\n    With cn\n        .Provider = \"Microsoft.ACE.OLEDB.12.0\"    'For *.ACCDB Databases\n        .ConnectionString = myDB 'Connects to my DB\n        .Open\n    End With\n\n\n    strQuery = \"INSERT INTO MasterTable ([Id], [Positions], [BU], [Job]) \" &amp; _\n               \"VALUES (\"\"\" &amp; Id &amp; \"\"\", \"\"\" &amp; Positions &amp; \"\"\", \"\"\" &amp; BU &amp; \"\"\", \" &amp; Job &amp; \"); \"\n\n    cn.Execute strQuery\n    cn.Close\n    Set cn = Nothing\n\n\n    End Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/LEjoV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LEjoV.png\" alt=\"Excel Snapshot\"></a>\n<a href=\"https://i.stack.imgur.com/yH18T.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yH18T.png\" alt=\"Access Structure\"></a></p>\n"}, {"tags": ["sql", "vba", "excel"], "comments": [{"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 1, "creation_date": 1445391677, "post_id": 33249570, "comment_id": 54301060, "body": "Just from the TITLE of your question... this is a bad idea!"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1445391749, "post_id": 33249570, "comment_id": 54301081, "body": "...but to help... the double unary (--) is used twice in your formula and these are not necessary since you are already multiplying the two column results. Get rid of them. It should make a little faster."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1445393235, "post_id": 33249570, "comment_id": 54301460, "body": "I&#39;ve got to go out on an errand. If this has not been answered by the time I return I&#39;ll have a go at a VBA routine to do it for you."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1445399863, "post_id": 33249570, "comment_id": 54303117, "body": "Can I see a small sample of the data in each column please?"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1445456300, "post_id": 33249570, "comment_id": 54336745, "body": "I&#39;m just about finished with a solution for you and I would like to test on a small representative sample, say a few hundred rows of data. Could you send that to me? My email address is:    daniel.ferry@gmail.com"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1445458850, "post_id": 33249570, "comment_id": 54338044, "body": "Please do send the file if you can (please see my previous comment), but also can you tell me how long this calculation takes to complete (if it does not crash first)?"}, {"owner": {"reputation": 13, "user_id": 5469450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d28268452acb6649297b4c72afdab532?s=128&d=identicon&r=PG&f=1", "display_name": "MIAB1290", "link": "https://stackoverflow.com/users/5469450/miab1290"}, "reply_to_user": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1445478930, "post_id": 33249570, "comment_id": 54345327, "body": "Thank you for helping me out, it crashes with 1M rows, with 100k, it takes 15 mins. I will send over sample data now, thanks so much!!!"}], "answers": [{"comments": [{"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 1, "creation_date": 1445392107, "post_id": 33249619, "comment_id": 54301174, "body": "While PowerPivot may work well in this case, I suspect that a well-written VBA procedure would produce very acceptable results."}, {"owner": {"reputation": 61, "user_id": 5466906, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Amvy7jXrHho/AAAAAAAAAAI/AAAAAAAAAbk/l4MEBr6Mz9A/photo.jpg?sz=128", "display_name": "Israel Holetz", "link": "https://stackoverflow.com/users/5466906/israel-holetz"}, "reply_to_user": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1445392505, "post_id": 33249619, "comment_id": 54301281, "body": "You can&#39;t handle this much info even in a Dictionary, and you can&#39;t possible think of looping thru all ranges. So, it&#39;s not about the structure, but the limitations of handling so much info and the delay to get any data from the applictation into the VBA."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 1, "creation_date": 1445392788, "post_id": 33249619, "comment_id": 54301353, "body": "Really? Umm... what are you talking about? A million rows by three columns? Easy and very fast in a variant array."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1445392884, "post_id": 33249619, "comment_id": 54301380, "body": "Indeed but no need for the external libraries (ADO/DAO). The native SAFEARRAY will do just fine."}, {"owner": {"reputation": 61, "user_id": 5466906, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Amvy7jXrHho/AAAAAAAAAAI/AAAAAAAAAbk/l4MEBr6Mz9A/photo.jpg?sz=128", "display_name": "Israel Holetz", "link": "https://stackoverflow.com/users/5466906/israel-holetz"}, "reply_to_user": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1445393015, "post_id": 33249619, "comment_id": 54301414, "body": "You got me.. I don&#39;t know why I always tought the limitiation of an array was 256.. I think I confused it with Collection someday.. my bad xD"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1445533840, "post_id": 33249619, "comment_id": 54373533, "body": "Israel, please see my answer."}], "tags": [], "owner": {"reputation": 61, "user_id": 5466906, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Amvy7jXrHho/AAAAAAAAAAI/AAAAAAAAAbk/l4MEBr6Mz9A/photo.jpg?sz=128", "display_name": "Israel Holetz", "link": "https://stackoverflow.com/users/5466906/israel-holetz"}, "is_accepted": false, "score": 0, "last_activity_date": 1445391990, "creation_date": 1445391990, "answer_id": 33249619, "question_id": 33249570, "link": "https://stackoverflow.com/questions/33249570/index-match-array-formula-for-1m-rows/33249619#33249619", "title": "INDEX MATCH array formula for 1M rows", "body": "<p>Excel isn't really made for large ammount of data, and probably no code will do it faster for you then a builtin excel formula. In this case, I would sugest you to give a try to the PowerPivot addin, and see how it handles the situation.</p>\n"}, {"tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": true, "score": 1, "last_activity_date": 1445642179, "last_edit_date": 1445642179, "creation_date": 1445533180, "answer_id": 33286524, "question_id": 33249570, "link": "https://stackoverflow.com/questions/33249570/index-match-array-formula-for-1m-rows/33286524#33286524", "title": "INDEX MATCH array formula for 1M rows", "body": "<p>Place the following VBA routines in a standard code module.</p>\n\n<p>Run the MIAB1290() routine.</p>\n\n<p>This emulates the precise outcome of your INDEX/MATCH formula, but it is much more efficient. On my computer, a million records are correctly correlated and the results displayed in <strong>Column G</strong> in just 10 seconds.</p>\n\n<pre><code>Public Sub MIAB1290()\n\n    Dim lastB&amp;, k&amp;, e, f, z, v, w, vErr, r As Range\n\n    With [a2]\n        Set r = .Resize(.Item(.Parent.Rows.Count - .Row + 1, 5).End(xlUp).Row - .Row + 1, .Item(, .Parent.Columns.Count - .Column + 1).End(xlToLeft).Column - .Column + 1)\n        lastB = .Item(.Parent.Rows.Count - .Row + 1, 2).End(xlUp).Row - .Row + 1\n    End With\n\n    With r\n        .Worksheet.Sort.SortFields.Clear\n        .Sort Key1:=.Item(1, 2), Order1:=1, Key2:=.Item(1, 2), Order2:=1, Header:=xlYes\n        v = .Value2\n    End With\n\n    ReDim w(1 To UBound(v), 1 To 1)\n    vErr = CVErr(xlErrNA)\n\n    For k = 2 To UBound(v)\n        e = v(k, 5)\n        f = v(k, 6)\n        w(k, 1) = vErr\n        z = BSearch(v, 2, e, 1, lastB)\n        If z Then\n            Do While v(z, 2) = e\n                If Abs(v(z, 3) - f) &lt;= 3 Then\n                    w(k, 1) = v(z, 1)\n                    Exit Do\n                End If\n                z = z + 1\n                If z &gt; UBound(v) Then Exit Do\n            Loop\n        End If\n    Next\n\n    r(1, 8).Resize(r.Rows.Count) = w\n\nEnd Sub\n\n\nPrivate Function BSearch(vA, col&amp;, vVal, ByVal first&amp;, ByVal last&amp;)\n    Dim k&amp;, middle&amp;\n    While last &gt;= first\n        middle = (last + first) / 2\n        Select Case True\n            Case vVal &lt; vA(middle, col)\n                last = middle - 1\n            Case vVal &gt; vA(middle, col)\n                first = middle + 1\n            Case Else\n                k = middle - 1\n                Do While vA(k, col) = vA(middle, col)\n                    k = k - 1\n                    If k &gt; last Then Exit Do\n                Loop\n                BSearch = k + 1\n                Exit Function\n        End Select\n    Wend\n    BSearch = 0\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5469450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d28268452acb6649297b4c72afdab532?s=128&d=identicon&r=PG&f=1", "display_name": "MIAB1290", "link": "https://stackoverflow.com/users/5469450/miab1290"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 984, "favorite_count": 0, "accepted_answer_id": 33286524, "answer_count": 2, "score": 1, "last_activity_date": 1445642179, "creation_date": 1445391513, "last_edit_date": 1445392138, "question_id": 33249570, "link": "https://stackoverflow.com/questions/33249570/index-match-array-formula-for-1m-rows", "title": "INDEX MATCH array formula for 1M rows", "body": "<p>I have two sets of data that need to be matched based on IDs and timestamp (+/- 3 units converted from time), and below is the formula that I've been using in Excel to do the matching. Recently I've had to run this formula on up to 1 million rows in Excel, and it takes a REALLY long time, crashes too. I'm wondering if there is a faster way to do this, if not in Excel?</p>\n\n<pre><code>=INDEX(A:A,MATCH(1,--(B:B=E3)*--(ABS(C:C-F3)&lt;=3),0),1)\n</code></pre>\n\n<p>Data Set 1:\nColumn A: States\nColumn B: IDs\nColumn C: Timestamp</p>\n\n<p>Data Set 2:\nColumn D: Email Addresses\nColumn E: IDs\nColumn F: Timestamp</p>\n\n<p><strong>Column G</strong>: <code>=INDEX(A:A,MATCH(1,--(B:B=E3)*--(ABS(C:C-F3)&lt;=3),0),1)</code></p>\n\n<p>Goal: Append \"States\" Column to Data Set 2 matched on IDs and Timestamp (+/- 3 time units) match.</p>\n\n<p>Just don't know how to run this formula on very large data sets.</p>\n"}, {"tags": ["vba", "loops", "rows", "visible"], "answers": [{"comments": [{"owner": {"reputation": 859, "user_id": 2666502, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/zGVE6.gif?s=128&g=1", "display_name": "mtholen", "link": "https://stackoverflow.com/users/2666502/mtholen"}, "edited": false, "score": 0, "creation_date": 1445470727, "post_id": 33250221, "comment_id": 54343135, "body": "GD Joao, if my answer has solved your problem, then please accept it as the correct answer ? You can do by clicking the large &quot;V&quot; tick at the top of my answer."}, {"owner": {"reputation": 3404, "user_id": 2181188, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/7JwZP.jpg?s=128&g=1", "display_name": "Fandango68", "link": "https://stackoverflow.com/users/2181188/fandango68"}, "edited": false, "score": 0, "creation_date": 1552866073, "post_id": 33250221, "comment_id": 97161905, "body": "SpecialCells only works if the filter is continuous."}], "tags": [], "owner": {"reputation": 859, "user_id": 2666502, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/zGVE6.gif?s=128&g=1", "display_name": "mtholen", "link": "https://stackoverflow.com/users/2666502/mtholen"}, "is_accepted": true, "score": 8, "last_activity_date": 1567362447, "last_edit_date": 1567362447, "creation_date": 1445396502, "answer_id": 33250221, "question_id": 33249555, "link": "https://stackoverflow.com/questions/33249555/excel-vba-loop-through-visible-filtered-rows/33250221#33250221", "title": "Excel VBA loop through visible filtered rows", "body": "<p>Your code contains several errors and you provide little additional information to allow us to help you, but to put in an attempt.</p>\n\n<p>Please see below code and compare to yours, the below code is closest to what you are trying to do and is tested and working.</p>\n\n<pre><code>Dim cnp As String\nDim nome As String\nDim filter_rng As Range\nDim rw As Range\nDim last_row As Long 'last visible data row\nDim dest_row As Long 'row to paste the colected data\n\nlast_row = 200\ndest_row = 1\n\nSet filter_rng = Sheets(1).Range(\"A5:Y\" &amp; last_row)\n\n'collect data\nFor Each rw In filter_rng.SpecialCells(xlCellTypeVisible)\n    'Worksheets(1).Activate\n    cnp = Sheets(1).Range(\"A\" &amp; rw.Row).Value\n    nome = Sheets(1).Range(\"B\" &amp; rw.Row).Value\n\n'copy data to another worksheet first data line is cell A2\n    'Worksheets(2).Activate\n    Sheets(2).Range(\"A\" &amp; dest_row + 1).Value = cnp\n    Sheets(2).Range(\"B\" &amp; dest_row + 1).Value = nome\n\nNext rw\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5469452, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6mL1q73yuTM/AAAAAAAAAAI/AAAAAAAAFKc/qZGGF9L9qxc/photo.jpg?sz=128", "display_name": "Joao Santos", "link": "https://stackoverflow.com/users/5469452/joao-santos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29848, "favorite_count": 1, "accepted_answer_id": 33250221, "answer_count": 1, "score": 2, "last_activity_date": 1567362447, "creation_date": 1445391424, "question_id": 33249555, "link": "https://stackoverflow.com/questions/33249555/excel-vba-loop-through-visible-filtered-rows", "title": "Excel VBA loop through visible filtered rows", "body": "<p>I have a excel table with a autofilter.</p>\n\n<p>In the filtered table i only have few rows filtered.</p>\n\n<p>My objective is icterate all visible rows to colect data to copy to anothe sheet.</p>\n\n<p>I want a way to collect a variable with the the fisrt visible row number.</p>\n\n<p>my draft code is:</p>\n\n<pre><code>Dim cnp As String\nDim nome As String\nDim filter_rng As Range\nDim rw As Range\nDim last_row As Long 'last visible data row\nDim dest_row As Long 'row to paste the colected data\n\nSet filter_rng = Range(\"A5:Y\" &amp; last_row).Rows.SpecialCells(xlCellTypeVisible)\n'collect data\nFor Each rw In filter_rng.SpecialCells(xlCellTypeVisible)\n    workshett(1).Activate\n    cnp = Range(\"a\" &amp; rw).Value\n    nome = Range(\"b\" &amp; rw).Value\n\n'copy data to another worksheet first data line is cell A2\n    Worksheet(2).Activate\n    Range(\"A\" &amp; dest_row + 1).Value = cnp\n    Range(\"b\" &amp; dest_row + 1).Value = nome\n\nNext rw\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 0, "last_activity_date": 1445401694, "last_edit_date": 1445401694, "creation_date": 1445401391, "answer_id": 33250902, "question_id": 33249090, "link": "https://stackoverflow.com/questions/33249090/formatting-columns-depending-on-column-headers/33250902#33250902", "title": "Formatting columns depending on column headers", "body": "<p>Try this</p>\n\n<pre><code>Public Sub Proper_text()\n    Dim ws As Worksheet, ur As Range, fr As Long, lr As Long, lc As Long, x As Range\n\n    Set ws = ActiveSheet\n    Set ur = ws.UsedRange\n    fr = ur.Row\n    lr = ur.Row + ur.Rows.Count - 1\n    lc = ur.Column + ur.Columns.Count - 1\n\n    Application.ScreenUpdating = False\n\n    For Each x In ur.Range(ur.Cells(fr, ur.Column), ur.Cells(fr, lc))\n        x.Offset(, lc).Formula = \"=UPPER(\" &amp; x.Address(False, False) &amp; \")\"\n    Next\n\n    For Each x In ur.Range(ur.Cells(fr + 1, ur.Column), ur.Cells(fr + 1, lc))\n\n        If UCase(x.Offset(-1).Value2) = \"HEADER_2\" Then\n            x.Offset(, lc).Formula = \"=PROPER(\" &amp; x.Address(False, False) &amp; \")\"\n        Else\n            x.Offset(, lc).Formula = \"=UPPER(\" &amp; x.Address(False, False) &amp; \")\"\n        End If\n\n    Next\n\n    Set x = ws.Range(ws.Cells(fr + 1, lc + 1), ur.Cells(fr + 1, lc * 2))\n    x.AutoFill Destination:=ur.Range(ur.Cells(fr + 1, lc + 1), ur.Cells(lr, lc * 2))\n\n    ur.Range(ur.Cells(fr, lc + 1), ur.Cells(lr, lc * 2)).Copy\n    ur.Range(ur.Cells(fr, ur.Column), ur.Cells(lr, lc)).PasteSpecial Paste:=xlPasteValues\n\n    ur.Range(ur.Cells(fr, lc + 1), ur.Cells(fr, lc * 2)).EntireColumn.Delete\n\n    Application.ScreenUpdating = True\n    ws.Cells(1).Select\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Result</p>\n\n<pre><code>Before:                                     After:\n\nHEAser_1    HEADer_2    heaDER_3            HEASER_1    HEADER_2    HEADER_3\n--------    --------    --------            --------    --------    --------\n    1       sTphn       pRCELL               1          Stphn       PRCELL\n    2       ADIL        mlr                  2          Adil        MLR\n    3       Mlling      sNN                  3          Mlling      SNN\n    4       Rosemary    Irvine               4          Rosemary    IRVINE\n    5                                        5\n    6       JIA         pAn                  6          Jia         PAN\n    7       MAJID       doost                7          Majid       DOOST\n    8       WILLIAM     smith                8          William     SMITH\n    9                                        9\n   10       VIssUT      domklAng             10         Vissut      DOMKLANG\n   11       RoDNy       mCdermid             11         Rodny       MCDERMID\n   12       RoBrt       pACker               12         Robrt       PACKER\n   13       PAUL        retz                 13         Paul        RETZ\n   14       TRoY        mACpherson           14         Troy        MACPHERSON\n   15       CATHRYN     stAfford             15         Cathryn     STAFFORD\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4721450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fe19a6348953415795bafbfee1fe1ce?s=128&d=identicon&r=PG&f=1", "display_name": "python newbie", "link": "https://stackoverflow.com/users/4721450/python-newbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1445401694, "creation_date": 1445387971, "last_edit_date": 1531164843, "question_id": 33249090, "link": "https://stackoverflow.com/questions/33249090/formatting-columns-depending-on-column-headers", "title": "Formatting columns depending on column headers", "body": "<p>I'm trying to write a macro where it changes the formatting of the cells depending on the column header.</p>\n\n<p>Header_2 needs to be PROPER case, \nHeader_3 needs to be UPPER case,\nall column headers need to be UPPER case.</p>\n\n<p>I've over simplified the example, but in reality I have 80 columns with an average of 3,000 rows with blanks within the columns - thus the macro needs to run without me selecting or specifying the range.</p>\n\n<p>Below is my code so far - although I keep getting 'mismatch' error (not sure how to fix it)</p>\n\n<p>Thanks in advance for any insight or help you are able to provide!</p>\n\n<p>Here is my data:</p>\n\n<p><a href=\"https://i.stack.imgur.com/JA33W.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JA33W.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code> Sub Proper_text()\n\n\n\nDim i As Integer\n\n\nFor i = 1 To 80\n    If Cells(1, i).Value = \"HEADER_2\" Then\n\n        For Each cell In Columns(i)\n\n            If Not IsEmpty(cell) Then\n\n                cell.Value = WorksheetFunction.Proper(cell.Value)\n\n\n            End If\n\n        Next cell\n\n    End If\nNext i\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1445386872, "post_id": 33248863, "comment_id": 54299955, "body": "Which line has the error?"}, {"owner": {"reputation": 59, "user_id": 5469369, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8339004c098c480f89ba74f446a5cff6?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Ardakanian", "link": "https://stackoverflow.com/users/5469369/jordan-ardakanian"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1445386907, "post_id": 33248863, "comment_id": 54299966, "body": "It does not say. When you click the button i get the error."}, {"owner": {"reputation": 859, "user_id": 2666502, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/zGVE6.gif?s=128&g=1", "display_name": "mtholen", "link": "https://stackoverflow.com/users/2666502/mtholen"}, "edited": false, "score": 1, "creation_date": 1445394379, "post_id": 33248863, "comment_id": 54301742, "body": "GD Jordan, what Om3r is referring to is setting a breakpoint on -for example- on the Private Sub line, that way your code will break once you click the button. Assuming you use MS Access you can then step through the code by using F8, you can see the progression of the execution and watch which statement is executed last, just prior to the error occurring."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 5469369, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8339004c098c480f89ba74f446a5cff6?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Ardakanian", "link": "https://stackoverflow.com/users/5469369/jordan-ardakanian"}, "edited": false, "score": 0, "creation_date": 1445388293, "post_id": 33249027, "comment_id": 54300294, "body": "Thanks for the help. I replaced the insert statement with the second line of code you wrote and im stlll getting the same error."}, {"owner": {"reputation": 59, "user_id": 5469369, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8339004c098c480f89ba74f446a5cff6?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Ardakanian", "link": "https://stackoverflow.com/users/5469369/jordan-ardakanian"}, "edited": false, "score": 0, "creation_date": 1445388325, "post_id": 33249027, "comment_id": 54300302, "body": "this is a detailed explanation of our error  This error occurs when an event has failed to run because the location of the logic for the event cannot be evaluated. For example, if the OnOpen property of a form is set to =[Field], this error occurs because a macro or event name is expected to run when the event occurs."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1445387388, "creation_date": 1445387388, "answer_id": 33249027, "question_id": 33248863, "link": "https://stackoverflow.com/questions/33248863/getting-error-in-vba-and-cannot-figure-it-out/33249027#33249027", "title": "Getting Error in vba and cannot figure it out", "body": "<pre><code>DoCmd.RunSQL \"select * from Rule where ChangedFlag = 1 and Years = \" + _\n         years2 + \" and Months = \" + months2 + \" and CountyID = \" + countyID2 + \"\"\n\n\nDoCmd.RunSQL \"insert into Rule values (Years, Months, CountyID) Values \" &amp; _\n             \" (years2, months2, countyID2)\"\n</code></pre>\n\n<p>In your second SQL statement you're trying to insert literal values \"years2\", \"months2\" and \"countyID2\".</p>\n\n<p>Compare that with your first statement...</p>\n"}, {"tags": [], "owner": {"reputation": 859, "user_id": 2666502, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/zGVE6.gif?s=128&g=1", "display_name": "mtholen", "link": "https://stackoverflow.com/users/2666502/mtholen"}, "is_accepted": false, "score": 0, "last_activity_date": 1445394223, "last_edit_date": 1445394223, "creation_date": 1445393621, "answer_id": 33249829, "question_id": 33248863, "link": "https://stackoverflow.com/questions/33248863/getting-error-in-vba-and-cannot-figure-it-out/33249829#33249829", "title": "Getting Error in vba and cannot figure it out", "body": "<p>GD Jordan,</p>\n\n<p>Your error indicates that you do not get a connection to the database. Which would make sense as you have not indicated where, or to what object, the connection should be made.</p>\n\n<p>In your code you have declared <code>SQL</code> and subsequently use it in your <code>OpenRecordSet(SQL)</code> statement, yet the variable <code>SQL</code> is not defined (i.e. it is declared but does not contain any value or information with which to execute the <code>OpenRecordSet()</code> method)</p>\n\n<p>Please see: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff820966.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff820966.aspx</a>\nFor more information on the appropriate use of the <code>OpenRecordSet()</code> method.</p>\n\n<p>Once you have checked that you indeed get the connection (using debugger in VB editor for example) you can then determine how you want your code to interact with the <code>rs</code> object.</p>\n\n<p>By the way there is more wrong with your code, but let's focus on getting the connections first...</p>\n\n<p>Good luck !</p>\n"}], "owner": {"reputation": 59, "user_id": 5469369, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8339004c098c480f89ba74f446a5cff6?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Ardakanian", "link": "https://stackoverflow.com/users/5469369/jordan-ardakanian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1445394223, "creation_date": 1445386140, "question_id": 33248863, "link": "https://stackoverflow.com/questions/33248863/getting-error-in-vba-and-cannot-figure-it-out", "title": "Getting Error in vba and cannot figure it out", "body": "<p>Trying to get this code to work when hitting a button but im getting this erorr</p>\n\n<p>\"A problem occurred while Microsoft Accces was communicating with the OLE server or Acitve X Control.\"</p>\n\n<p>here is the code</p>\n\n<pre><code>enter code here\n\nPrivate Sub Command36_Click()\n\nDim months2, years2, countyID2 As Integer\nDim dr As SqlDataReader\nDim dbs As DAO.Database\nDim rs As DAO.Recordset\nSet dbs = CurrentDb\nDim SQL\n\nmonths2 = txtMonths.Value\nyears2 = txtYears.Value\ncountyID2 = txtCountyID.Value\n\nSet rs = dbs.OpenRecordset(SQL)\n\n\nDoCmd.RunSQL \"select * from Rule where ChangedFlag = 1 and Years = \" +         years2 + \" and Months = \" + months2 + \" and CountyID = \" + countyID2 + \"\"\n\nIf IsNull(rs) Then MsgBox \"Hearing dates are already assigned! Please choose   another county, year, or month!\"\nElse\nDoCmd.RunSQL \"insert into Rule values (Years, Months, CountyID) Values  (years2, months2, countyID2)\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["performance", "vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1445385385, "post_id": 33248758, "comment_id": 54299623, "body": "First try turning off screenupdating and see if that improves things."}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1445385952, "post_id": 33248800, "comment_id": 54299734, "body": "If he turns off screen updating and calculation too, that&#39;d be super fast."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 4, "last_activity_date": 1445385596, "creation_date": 1445385596, "answer_id": 33248800, "question_id": 33248758, "link": "https://stackoverflow.com/questions/33248758/very-slow-removing-command-buttons-and-rows-from-sheet/33248800#33248800", "title": "Very slow removing command buttons and rows from sheet", "body": "<p>Instead of deleting rows one-by-one try something like this (untested):</p>\n\n<pre><code>Sub ResetForm_Click()\n\n    Dim Contr\n    Dim controlname As String\n    Dim WS As Worksheet, rDel As Range\n\n    Set WS = ActiveSheet\n\n        For Each Contr In WS.OLEObjects\n\n        controlname = Mid(Contr.Name, 1, 2)\n\n            If controlname = \"CB\" Then\n                If rDel Is Nothing then\n                    Set rDel = Contr.TopLeftCell\n                Else\n                    Set rDel = Application.Union(rDel, Contr.TopLeftCell)\n                End If \n                Contr.Delete\n            End If\n\n        Next\n\n        If Not rDel Is Nothing then rDel.EntireRow.Delete \n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1445385609, "creation_date": 1445385609, "answer_id": 33248806, "question_id": 33248758, "link": "https://stackoverflow.com/questions/33248758/very-slow-removing-command-buttons-and-rows-from-sheet/33248806#33248806", "title": "Very slow removing command buttons and rows from sheet", "body": "<p>Without editing your macro too much, turn off screen updating and autocalculation, see if that helps.</p>\n\n<p>At the beginning of your macro (I usually put it after my declarations), add</p>\n\n<pre><code>Application.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n</code></pre>\n\n<p>Then at the end (before <code>End Sub</code>), turn them back on</p>\n\n<pre><code>Application.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 5360428, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/36397e24a14f58c986584989210d79db?s=128&d=identicon&r=PG&f=1", "display_name": "Hareborn", "link": "https://stackoverflow.com/users/5360428/hareborn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 33248800, "answer_count": 2, "score": 1, "last_activity_date": 1445390638, "creation_date": 1445385297, "last_edit_date": 1445390638, "question_id": 33248758, "link": "https://stackoverflow.com/questions/33248758/very-slow-removing-command-buttons-and-rows-from-sheet", "title": "Very slow removing command buttons and rows from sheet", "body": "<p>This sub removes all command buttons and their associated rows that were created programmatically on a sheet. It takes around 20 seconds to remove 60 command buttons and rows. I've stepped through it and can find no problems with it.</p>\n\n<pre><code>Sub ResetForm_Click()\n\n    Dim Contr\n    Dim controlname As String\n    Dim WS As Worksheet\n\n    Set WS = ActiveSheet\n\n        For Each Contr In WS.OLEObjects\n\n        controlname = Mid(Contr.Name, 1, 2)\n\n            If controlname = \"CB\" Then\n                Contr.TopLeftCell.Rows.EntireRow.Delete\n                Contr.Delete\n            End If\n\n        Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "function", "excel", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 5372339, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0b55704d3a6d5f337fe0cc32b9b78622?s=128&d=identicon&r=PG&f=1", "display_name": "Yusuf", "link": "https://stackoverflow.com/users/5372339/yusuf"}, "edited": false, "score": 0, "creation_date": 1445430823, "post_id": 33249367, "comment_id": 54319882, "body": "Hi Israel, Thanks for your reply. I would like to clarify, I want the week number of the year. for eg:assuming todays date 21st of October would mean that Week Number = 43.  Also could you please let me know where should I place the code?"}, {"owner": {"reputation": 61, "user_id": 5466906, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Amvy7jXrHho/AAAAAAAAAAI/AAAAAAAAAbk/l4MEBr6Mz9A/photo.jpg?sz=128", "display_name": "Israel Holetz", "link": "https://stackoverflow.com/users/5466906/israel-holetz"}, "reply_to_user": {"reputation": 31, "user_id": 5372339, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0b55704d3a6d5f337fe0cc32b9b78622?s=128&d=identicon&r=PG&f=1", "display_name": "Yusuf", "link": "https://stackoverflow.com/users/5372339/yusuf"}, "edited": false, "score": 0, "creation_date": 1445476923, "post_id": 33249367, "comment_id": 54344825, "body": "You mean your function? Or your entire code? A function it&#39;s usually placed inside a module, that way you can access it anywhere (userforms, another modules, classes, worksheet&#39;s code). As for the whole code, you can have an ideia from here: <a href=\"http://www.contextures.com/xlvba01.html\" rel=\"nofollow noreferrer\">link</a>.... You can also make a VBScript from it, and run it independently outside the office platform. There is also a compiler for it: <a href=\"http://www.vbsedit.com/\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 31, "user_id": 5372339, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0b55704d3a6d5f337fe0cc32b9b78622?s=128&d=identicon&r=PG&f=1", "display_name": "Yusuf", "link": "https://stackoverflow.com/users/5372339/yusuf"}, "edited": false, "score": 0, "creation_date": 1445613734, "post_id": 33249367, "comment_id": 54410766, "body": "I meant placing the &#39;line&#39; of code/function if anyone could suggest me for getting the week number. Well, anyways I have done it the easy way... I have simply referenced the Weeknumber from the regular Excel formula in the sheet and its working without any issues. Thanks for your patience .. Cheers :)"}], "tags": [], "owner": {"reputation": 61, "user_id": 5466906, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Amvy7jXrHho/AAAAAAAAAAI/AAAAAAAAAbk/l4MEBr6Mz9A/photo.jpg?sz=128", "display_name": "Israel Holetz", "link": "https://stackoverflow.com/users/5466906/israel-holetz"}, "is_accepted": false, "score": 0, "last_activity_date": 1445391094, "last_edit_date": 1445391094, "creation_date": 1445390088, "answer_id": 33249367, "question_id": 33248566, "link": "https://stackoverflow.com/questions/33248566/getting-week-number-in-powerpoint/33249367#33249367", "title": "Getting week number in PowerPoint", "body": "<p>Your function asks for a data input (\"D\"), and it's not optional. If you want to retrieve the day of the week of today (\"Date\" system variable), you should call it like this:</p>\n\n<pre><code>WeekNumm = WeekNum(Date)\n</code></pre>\n\n<p>Also, you are using a Set statement in \"Set wk = WeekNumm\". As the variable isn't an object, you have to use (a preferably omitted) Let.</p>\n\n<p>Also, your function will not return the day of the week, because \"ww\" means the week number of the year. If you want the day of the week by this approach, you have to use \"w\".</p>\n\n<p>For a better approach, you should use the builtin function <a href=\"https://msdn.microsoft.com/en-us/library/82yfs2zh(v=vs.90).aspx\" rel=\"nofollow\" title=\"Weekday\">Weekday</a> to get the weekday.</p>\n\n<p>Like:</p>\n\n<pre><code>iWeekDay = Weekday(Date,vbUseSystemDayOfWeek) 'Retrieves today's day of the week (Tuesday = 3...)\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5372339, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0b55704d3a6d5f337fe0cc32b9b78622?s=128&d=identicon&r=PG&f=1", "display_name": "Yusuf", "link": "https://stackoverflow.com/users/5372339/yusuf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1533, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1445391094, "creation_date": 1445384010, "last_edit_date": 1445390928, "question_id": 33248566, "link": "https://stackoverflow.com/questions/33248566/getting-week-number-in-powerpoint", "title": "Getting week number in PowerPoint", "body": "<p>I have got a code to generate PowerPoint with an Excel file. I have mostly modified the code as per my requirement, but I want to add one more feature into my .ppt. I want VBA to extract Week Number from some source and do the following:</p>\n\n<ol>\n<li>Rename my .ppt as \"XXX_Weeknumber.ppt\" </li>\n<li>In one of the textboxes in the slides I want to add the same Weeknumber. </li>\n</ol>\n\n<p>I tried getting the week number by using the function WeekNum and trying to call the function in my Main Sub but unfortunately doesn't work!  </p>\n\n<p>My code for function in Module 1:</p>\n\n<pre><code>Function WeekNum(D As Date) As Integer\nWeekNum = CInt(Format(D, \"ww\", 2))\nEnd Function\n</code></pre>\n\n<p>Code for the .xls to .ppt in Module 2:</p>\n\n<pre><code>Dim oPPTApp As PowerPoint.Application\nDim oPPTShape As PowerPoint.Shape\nDim oPPTShape2 As PowerPoint.Shape\nDim oPPTFile As PowerPoint.Presentation\nDim PPSlide As PowerPoint.slide\nDim SlideNum As Integer\nDim rng As Range\nDim WeekNumm$\n\n\nSub PPTableMacro()\nDim sourcexl As Workbook\n\nDim wk As Integer\n\nDim strPresPath As String, strExcelFilePath As String, strNewPresPath As String\nstrExcelFilePath = \"C:\\MySource.xls\"\nstrPresPath = \"C:\\Presentation1.ppt\"\nCall WeekNum\nWeekNumm = WeekNum()\nSet wk = WeekNumm\nstrNewPresPath = \"C:\\Presentation1_\" &amp; wk &amp; \".ppt\" 'This is how I want the name\nstrNewPresPath = \"C:\\new1.ppt\"\n\nSet oPPTApp = CreateObject(\"PowerPoint.Application\")\noPPTApp.Visible = msoTrue\n\nSet oPPTFile = oPPTApp.Presentations.Open(strPresPath)\nSlideNum = 2\n\noPPTFile.Slides(SlideNum).Select\nSet oPPTShape = oPPTFile.Slides(SlideNum).Shapes(\"Table 1\")\n\nSet sourcexl = Workbooks.Open(strExcelFilePath) 'Source excel file\nWith sourcexl\n.Sheets(\"Sheet1\").Activate\noPPTShape.Table.Cell(1, 1).Shape.TextFrame.TextRange.Text = Cells(1, 1).Text\noPPTShape.Table.Cell(1, 2).Shape.TextFrame.TextRange.Text = Cells(1, 2).Text\noPPTShape.Table.Cell(1, 3).Shape.TextFrame.TextRange.Text = Cells(1, 3).Text\noPPTShape.Table.Cell(2, 1).Shape.TextFrame.TextRange.Text = Cells(2, 1).Text\noPPTShape.Table.Cell(2, 2).Shape.TextFrame.TextRange.Text = Cells(2, 2).Text\noPPTShape.Table.Cell(2, 3).Shape.TextFrame.TextRange.Text = Cells(2, 3).Text\n\nEnd With\n\nSet oPPTShape2 = oPPTFile.Slides(SlideNum).Shapes(\"TextBox 1\")\nText1 = \"weekXX\" ' actually wanted week number here\noPPTShape2.TextFrame.TextRange.Text = Text1\n\noPPTFile.SaveAs strNewPresPath\n'oPPTFile.Close\n'oPPTApp.Quit\n\nSet oPPTShape = Nothing\nSet oPPTFile = Nothing\nSet oPPTApp = Nothing\n\nMsgBox \"Presentation Created\", vbOKOnly + vbInformation\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": false, "score": 0, "last_activity_date": 1445522429, "last_edit_date": 1445522429, "creation_date": 1445384206, "answer_id": 33248607, "question_id": 33248541, "link": "https://stackoverflow.com/questions/33248541/view-names-of-controls-in-worksheet/33248607#33248607", "title": "View names of controls in worksheet", "body": "<p>You can get the real name of the form control from the Immediate Window in the VBE by executing this line:</p>\n\n<pre><code>?Sheet2.Shapes(1).Name\n</code></pre>\n\n<p>Form controls are actually shapes in the object model.</p>\n\n<p>The above assumes you have no other shapes on the worksheet.</p>\n\n<p><strong>Of course</strong> you can also see the name (and edit it) from the Name Box if the control is selected.</p>\n\n<p>Once you have the name you can use  it in code like so:</p>\n\n<pre><code>MsgBox Sheet2.Shapes(\"List Box 1\").Top\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4695741, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-I-RkAT5oTbM/AAAAAAAAAAI/AAAAAAAABJU/c4NjNWtJjf4/photo.jpg?sz=128", "display_name": "Jack Lusk", "link": "https://stackoverflow.com/users/4695741/jack-lusk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 161, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1445522429, "creation_date": 1445383873, "question_id": 33248541, "link": "https://stackoverflow.com/questions/33248541/view-names-of-controls-in-worksheet", "title": "View names of controls in worksheet", "body": "<p>So I feel a little foolish asking this question.  I have spent plenty of time searching and only found a crude work-around.  I have given this due diligence before posting.</p>\n\n<p>For controls placed within a worksheet I cannot pull up the properties or even view the name to reference in code.  The work-around I came across is if you right-click on the control (listbox in this case) and choose assign macro.  It will suggest a macro name with the control name (e.g. ListBox13_change).  In the code I refer to this listbox as Sheet2.ListBox13, but getting an error message for missing object.</p>\n\n<p>With ActiveX controls or controls within a userform I can view the properties.  I don't know why I am having trouble with this case.  </p>\n\n<p>Any guidance is much appreciated. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2090, "user_id": 3230456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86b80866ac0d8165eabbf5679353633?s=128&d=identicon&r=PG&f=1", "display_name": "codersl", "link": "https://stackoverflow.com/users/3230456/codersl"}, "edited": false, "score": 0, "creation_date": 1445390846, "post_id": 33248404, "comment_id": 54300844, "body": "Before posting your question you need to make sure that the code is valid!"}], "answers": [{"tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": false, "score": 0, "last_activity_date": 1445408116, "creation_date": 1445408116, "answer_id": 33252194, "question_id": 33248404, "link": "https://stackoverflow.com/questions/33248404/excel-vba-index-match-multiple-criteria/33252194#33252194", "title": "Excel VBA: Index-Match Multiple Criteria", "body": "<p>Most operations are performed quite different using VBA than doing them manually. If you want to work with VBA then should do some research about working with variables and objects. This pages should be of interest.</p>\n\n<p><a href=\"http://www.excelfunctions.net/VBA-Variables-And-Constants.html\" rel=\"nofollow\">Variables &amp; Constants</a>, <a href=\"http://www.excelfunctions.net/Excel-Objects.html\" rel=\"nofollow\">Excel Objects</a>, <a href=\"https://msdn.microsoft.com/EN-US/library/office/gg264723.aspx\" rel=\"nofollow\">With Statement</a> &amp; <a href=\"https://msdn.microsoft.com/en-us/library/office/dn301006.aspx\" rel=\"nofollow\">Range Properties (Excel)</a></p>\n\n<p>I have done some changes to your code, see comments within, and refer to the pages mentioned above.</p>\n\n<pre><code>Sub Rng_HideColumns()\nDim rTrg As Range, rCol As Range\nDim sCllVal As String\n    Rem Set rTrg = ThisWorkbook.Sheets(\"Sht(0)\").Range(\"D9:CC9,D8:CC8\")\n    Rem Refers to the worksheet you want to work with instead or using the active worksheet\n    With ThisWorkbook.Sheets(\"Sht(0)\")\n\n        Rem Get value to match\n        sCllVal = .Range(\"A6\").Value2 &amp; 12\n\n        Rem Set Range to Search\n        Set rTrg = .Range(\"D8:CC9\")\n        For Each rCol In rTrg.Columns\n            With rCol\n                If .Cells(2).Value2 &amp; .Cells(1).Value2 = sCllVal Then\n                    .EntireColumn.Hidden = 1\n                Else\n                    .EntireColumn.Hidden = 0\n    End If: End With: Next: End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5442946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1652673ed83705240fb7da2c4abc2c83?s=128&d=identicon&r=PG&f=1", "display_name": "Swmeyers", "link": "https://stackoverflow.com/users/5442946/swmeyers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 260, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1445408116, "creation_date": 1445382832, "last_edit_date": 1531164843, "question_id": 33248404, "link": "https://stackoverflow.com/questions/33248404/excel-vba-index-match-multiple-criteria", "title": "Excel VBA: Index-Match Multiple Criteria", "body": "<p>I am trying to produce a VBA function that will hide all columns for which cells D9:CC9 are not equal to \"A6\" and cells D8:CC8 are not equal to \"12.\" Based on the script below, the system keeps returning an error. I am new to VBA, was hoping someone might be able to assist.</p>\n\n<p>Thanks!</p>\n\n<pre><code>Dim MyCell As Range\n       Set MyCell = Range(\"D9:CC9,D8:CC8\")\n             For Each cell In MyCell\n                   If cell.Value &lt;&gt; WorksheetFunction.Index(Range(\"D9:CC9\"),WorksheetFunction.Match(Range(\"A6\")&amp;\"12\",Range(\"D9:CC9\")&amp;Range(\"D8:CC8\"), 0))\n                        cell.EntireColumn.Hidden = True\n\n                   End If\n\n             Next cell\n</code></pre>\n"}, {"tags": ["excel", "replace", "find", "range", "vba"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1445405663, "creation_date": 1445405663, "answer_id": 33251655, "question_id": 33248115, "link": "https://stackoverflow.com/questions/33248115/filter-specific-month-in-dataset-and-replace-each-day-of-that-filtered-month-wit/33251655#33251655", "title": "filter specific month in dataset and replace each day of that filtered month with its first day (excel vba)", "body": "<pre><code>Columns(\"V\").Replace What:=\"10/*/2015\", Replacement:=\"10/1/2015\", _\n                    LookAt:= xlPart, SearchOrder:=xlByRows, _\n                    MatchCase:=False\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5469191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36290c1e0c5f01d58f94d681a25245cb?s=128&d=identicon&r=PG&f=1", "display_name": "nico", "link": "https://stackoverflow.com/users/5469191/nico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1449656607, "creation_date": 1445381197, "last_edit_date": 1531161705, "question_id": 33248115, "link": "https://stackoverflow.com/questions/33248115/filter-specific-month-in-dataset-and-replace-each-day-of-that-filtered-month-wit", "title": "filter specific month in dataset and replace each day of that filtered month with its first day (excel vba)", "body": "<p>this is a question on how to create a macro in VBA that would perform the following:</p>\n\n<p>I would like to basically replace a month broken out by day (i.e 10/01/2015, 10/02/2015, etc...) with only the first day of the month (10/01/2015) in a specific column.</p>\n\n<p>So the macro would \"find\" the column based on the column header (contract date) then it would replace all days for October 2015 (has to be year specific) with the first day of that month. </p>\n\n<p>So I can get the macro to replace a certain pre-determined value:</p>\n\n<pre><code>Sub ReplaceTitleMs()\nColumns(\"V\").Replace    What:=\"10/02/2015\", _\n                        Replacement:=\"10/01/2015\", _\n                        LookAt:=xlPart, _\n                        SearchOrder:=xlByRows, _\n                        MatchCase:=False, _\n                        SearchFormat:=False, _\n                        ReplaceFormat:=False\n</code></pre>\n\n<p>But I can't figure out how to filter down to a specific month and replace multiple values (without listing every single possibilities in the macro).</p>\n\n<p>Please help! :)</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1445381012, "post_id": 33247926, "comment_id": 54298474, "body": "Does that code not work?"}, {"owner": {"reputation": 95, "user_id": 5051416, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a3ec7ed914aa1d305e709a218bd01e83?s=128&d=identicon&r=PG&f=1", "display_name": "synthaxe", "link": "https://stackoverflow.com/users/5051416/synthaxe"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1445381073, "post_id": 33247926, "comment_id": 54298498, "body": "It does not work with the if statement, but if i remove it, it works."}, {"owner": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "edited": false, "score": 0, "creation_date": 1445381239, "post_id": 33247926, "comment_id": 54298544, "body": "the time is always going to be less than 23:59. them minute after that, it&#39;s going to be 00:00, which is also less than 23:59.  You will need to work out some other logic to decide if you need to take a day off"}, {"owner": {"reputation": 95, "user_id": 5051416, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a3ec7ed914aa1d305e709a218bd01e83?s=128&d=identicon&r=PG&f=1", "display_name": "synthaxe", "link": "https://stackoverflow.com/users/5051416/synthaxe"}, "reply_to_user": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "edited": false, "score": 0, "creation_date": 1445381345, "post_id": 33247926, "comment_id": 54298585, "body": "@SeanC that&#39;s what I&#39;ve been thinking about. Isn&#39;t there a way to declare the input as <code>&quot;Time&quot;</code> in VBA?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "edited": false, "score": 0, "creation_date": 1445388053, "post_id": 33247926, "comment_id": 54300240, "body": "What if you took the left part of the time and the right part, and compared them? I.e. 23:59 - compare the 23 against 24 (being midnight), and the 59 against 00?   And @SeanC - I need to take a day off, my own logic says so! :P"}, {"owner": {"reputation": 95, "user_id": 5051416, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a3ec7ed914aa1d305e709a218bd01e83?s=128&d=identicon&r=PG&f=1", "display_name": "synthaxe", "link": "https://stackoverflow.com/users/5051416/synthaxe"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1445389581, "post_id": 33247926, "comment_id": 54300547, "body": "@BruceWayne and how do you propose I do that? By putting them in an array? I&#39;m actually thinking of putting the string 23:00 to 23:59 in an array(59) and compare them with 00:00 (12:00 AM) via for loop. Do you think this would work?"}, {"owner": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "edited": false, "score": 0, "creation_date": 1445395855, "post_id": 33247926, "comment_id": 54302135, "body": "what about deciding when you should <b>not</b> take a day off, and compare that instead?"}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 5051416, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a3ec7ed914aa1d305e709a218bd01e83?s=128&d=identicon&r=PG&f=1", "display_name": "synthaxe", "link": "https://stackoverflow.com/users/5051416/synthaxe"}, "edited": false, "score": 0, "creation_date": 1445416229, "post_id": 33250296, "comment_id": 54310269, "body": "looks awesome, will try this when I get home and let you know how it goes"}], "tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": false, "score": 0, "last_activity_date": 1445397118, "creation_date": 1445397118, "answer_id": 33250296, "question_id": 33247926, "link": "https://stackoverflow.com/questions/33247926/use-input-as-basis-of-what-date-to-display/33250296#33250296", "title": "Use input as basis of what date to display", "body": "<p>This solution assumes the following:</p>\n\n<ul>\n<li><code>StatusBox.Value</code> is an Excel serial number formatted with a time format <em>(no Date included)</em> , as such <code>StatusBox.Value</code> is a decimal number with a value ranging from <code>0</code> <em>(zero)</em> to <code>0.99988426</code>, representing the times from <code>0:00:00</code> <em>(12:00:00 AM)</em> to <code>23:59:59</code> <em>(11:59:59 P.M.)</em>. Therefore when this serial number reaches the 24 hours becomes <code>1</code> (one).</li>\n</ul>\n\n<p>Based on the above replace this:</p>\n\n<p><code>If StatusBox.Value &lt;= \"23:59\"</code> ...</p>\n\n<p>with this </p>\n\n<p><code>If StatusBox.Value &lt;= 1</code> ...</p>\n\n<p>However if <code>StatusBox.Value</code> includes an <code>[expected Date value]</code> then use this  as replacement line:</p>\n\n<p><code>If StatusBox.Value &lt;= [expected Date value]</code> ...</p>\n\n<p><a href=\"https://i.stack.imgur.com/anHMg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/anHMg.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 95, "user_id": 5051416, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a3ec7ed914aa1d305e709a218bd01e83?s=128&d=identicon&r=PG&f=1", "display_name": "synthaxe", "link": "https://stackoverflow.com/users/5051416/synthaxe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1445397118, "creation_date": 1445380165, "question_id": 33247926, "link": "https://stackoverflow.com/questions/33247926/use-input-as-basis-of-what-date-to-display", "title": "Use input as basis of what date to display", "body": "<p>I need a way to use the input on a userform to determine the date that will be displayed on the output. Here's my code:</p>\n\n<pre><code>If StatusBox.Value &lt;= \"23:59\" And ShiftCode.Value = \"AP\" Then\n    Cells(emptyRow, 8).Value = ((Date - 1) + \" \" + StatusBox.Value + \" \" + \"CEST\")\nElse\n    Cells(emptyRow, 8).Value = (Date + \" \" + StatusBox.Value + \" \" + \"CEST\")\nEnd If\n</code></pre>\n\n<p>Basically I need the date to be displayed as <code>Date - 1</code> when the input from StatusBox.Value is less than or equal to <code>11:59 PM or 23:59</code> the inputs on the <code>StatusBox</code> field will always be in the 12-Hour format.  </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1445382330, "post_id": 33247844, "comment_id": 54298883, "body": "A heading of what???"}, {"owner": {"reputation": 131, "user_id": 5469176, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/031e28aeacbf16f3a78ece53dcc8f18b?s=128&d=identicon&r=PG&f=1", "display_name": "SFro", "link": "https://stackoverflow.com/users/5469176/sfro"}, "reply_to_user": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1445386615, "post_id": 33247844, "comment_id": 54299892, "body": "The heading will be the name of the checkbox that was selected"}], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 5469176, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/031e28aeacbf16f3a78ece53dcc8f18b?s=128&d=identicon&r=PG&f=1", "display_name": "SFro", "link": "https://stackoverflow.com/users/5469176/sfro"}, "edited": false, "score": 0, "creation_date": 1445430476, "post_id": 33251730, "comment_id": 54319647, "body": "Sorry should have specified, I would need it for ActiveX type"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1445406088, "creation_date": 1445406088, "answer_id": 33251730, "question_id": 33247844, "link": "https://stackoverflow.com/questions/33247844/moving-between-cells-based-on-checkbox-status/33251730#33251730", "title": "Moving between cells based on checkbox status", "body": "<p>Assuming \"forms\" checkboxes (vs. ActiveX type)</p>\n\n<pre><code>dim i, n, s\n\nn = 0\nfor i = 1 to 10\n    s = \"Check Box \" &amp; i\n    if activesheet.checkboxes(s).Value = 1 then\n        Activesheet.range(\"A1\").offset(0, n).value = s\n        n = n + 1\n    end if\nnext i\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 5469176, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/031e28aeacbf16f3a78ece53dcc8f18b?s=128&d=identicon&r=PG&f=1", "display_name": "SFro", "link": "https://stackoverflow.com/users/5469176/sfro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1445406088, "creation_date": 1445379806, "last_edit_date": 1445391217, "question_id": 33247844, "link": "https://stackoverflow.com/questions/33247844/moving-between-cells-based-on-checkbox-status", "title": "Moving between cells based on checkbox status", "body": "<p>I am trying to generate a unique output when a button is clicked on one sheet that will depend on the state of a group of check boxes.</p>\n\n<p>There is a group of ten boxes, any of which can be selected for a maximum of ten. When the button is clicked, the name of each check box will appear sequentially. So for example:  </p>\n\n<p>Check box 1 and 3 are checked, the button is clicked, then the output to the cells will look like: [Check Box1] [Check Box3]</p>\n\n<p>However if boxes 1 2 3 9 are checked, it will display:\n[Check Box1] [Check Box2] [Check Box3] etc....</p>\n\n<p>My main issue is that I only want the name of the checkbox to appear as a heading if it is selected.</p>\n"}, {"tags": ["excel", "vbscript", "vba"], "comments": [{"owner": {"reputation": 95, "user_id": 3606394, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a98e1605b1f9098ee0f6a009db24c6a7?s=128&d=identicon&r=PG&f=1", "display_name": "forwardslashend", "link": "https://stackoverflow.com/users/3606394/forwardslashend"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1445624910, "post_id": 33247567, "comment_id": 54416992, "body": "@findwindow I have added my code below."}], "answers": [{"tags": [], "owner": {"reputation": 95, "user_id": 3606394, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a98e1605b1f9098ee0f6a009db24c6a7?s=128&d=identicon&r=PG&f=1", "display_name": "forwardslashend", "link": "https://stackoverflow.com/users/3606394/forwardslashend"}, "is_accepted": true, "score": 0, "last_activity_date": 1445460834, "creation_date": 1445460834, "answer_id": 33269038, "question_id": 33247567, "link": "https://stackoverflow.com/questions/33247567/iterate-through-cells-in-a-column-if-contains-criteria-copy-row-to-new-sheet/33269038#33269038", "title": "Iterate through cells in a column, if contains criteria, copy row to new sheet", "body": "<p>I realize I should have posted my attempt at it before asking. Anyway, I figured out how to do it. I am new to VBA but this worked:</p>\n\n<pre><code>Set mainSht = Worksheets(\"Sheet1\")  ' Copy From this sheet\n\n'Find the last row with data in specified column.\nLR = mainSht.Cells(Rows.Count, \"F\").End(xlUp).Row\n\nSet LRange = mainSht.Range(\"F2:F\" &amp; LR)\n\n'Find max number in the range\nmax = Application.WorksheetFunction.max(LRange)\n\n'Look at every cell in cpecified column\nFor Each Cell In LRange\n For i = 1 To max\n\n    cIndex = CStr(i)\n\n    If Cell.Value Like \"1\" + cIndex + \"?\" Then    'check to See if C equals value                                       \n        sheetName = \"1\" + cIndex\n\n        'Check if worksheet exists\n        Set wsCheck = Nothing\n        On Error Resume Next\n        Set wsCheck = ActiveWorkbook.Worksheets(sheetName)\n        On Error GoTo 0\n\n        'If worksheet does not exist, create new\n        If wsCheck Is Nothing Then\n            Worksheets.Add(After:=ActiveWorkbook.Sheets(ActiveWorkbook.Sheets.Count)).Name = sheetName\n        End If\n\nSet Pastesheet = Worksheets(sheetName)  ' Paste to this sheet\n            Cell.EntireRow.Copy  ' Copy the row\n            Pastesheet.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValuesAndNumberFormats\n    End If\n    Next\n\nNext Cell  ' Now we check the next cell in chosen column\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 3606394, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a98e1605b1f9098ee0f6a009db24c6a7?s=128&d=identicon&r=PG&f=1", "display_name": "forwardslashend", "link": "https://stackoverflow.com/users/3606394/forwardslashend"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 446, "favorite_count": 0, "accepted_answer_id": 33269038, "answer_count": 1, "score": 0, "last_activity_date": 1445460834, "creation_date": 1445378421, "last_edit_date": 1531161705, "question_id": 33247567, "link": "https://stackoverflow.com/questions/33247567/iterate-through-cells-in-a-column-if-contains-criteria-copy-row-to-new-sheet", "title": "Iterate through cells in a column, if contains criteria, copy row to new sheet", "body": "<p>I have a spreadsheet similar to the following:</p>\n\n<pre>\n<b>Name       Title        ID</b>\nPerson 1    Title 1     1\nPerson 2    Title 2     11\nPerson 3    Title 3     111\nPerson 4    Title 4     1111\nPerson 5    Title 5     12\nPerson 6    Title 6     121\nPerson 7    Title 7     1211\nPerson 8    Title 8     1212\nPerson 9    Title 9     122\nPerson 10   Title 10    13\nPerson 11   Title 11    131\nPerson 12   Title 12    1311\nPerson 13   Title 13    1312\nPerson 14   Title 14    13121\nPerson 15   Title 15    1313\nPerson 16   Title 16    132\nPerson 17   Title 17    1321\nPerson 18   Title 18    14\nPerson 19   Title 19    15\nPerson 20   Title 20    151\nPerson 21   Title 21    1512\n</pre>\n\n<p>I want to iterate through each cell in the \"ID\" column. \nIf the column contains a value, then copy the entire row to a new sheet.</p>\n\n<p>Here's the tricky part: </p>\n\n<pre>\n - The first number will always start with 1. \n - I want the script to search \"ID\" for 1 + another single digit (10,11,12,13...). \n   For all cells that match the criteria copy that row to a new sheet. \n - When that is done, now search for 11 + another single digit (111,112,113,114...). \n - When that is done, now search for 12 + another digit (121,122,123,124...)\n</pre>\n\n<p>This should keep going: </p>\n\n<pre>\nSearch \"ID\" for:    Finds all:\n    19              191, 192, 193, 194...\n    124            1241, 1242, 1243, 1244...\n    1111            11111, 11112, 11113, 11114, 11115...\n    1127           11271, 11272, 11273, 11274... \n    12345           123451, 123452, 123453, 123454, 123455...\n</pre>\n\n<p>The preceding digits before the '+ another single digit' dictate what sheet it should go in. </p>\n\n<pre>\n - If search for 1 + another single digit - these should all go on a single sheet.\n - If searching for 11 + another single digit - these should go on a single sheet.\n - If search for 1234 + another single digit - these should go on a single sheet.\n - So on and so forth.\n</pre>\n"}, {"tags": ["vba", "excel", "pdf", "acrobat"], "comments": [{"owner": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "edited": false, "score": 0, "creation_date": 1445381748, "post_id": 33247537, "comment_id": 54298720, "body": "I would think that perhaps that&#39;s not quite the field name.  It errors there and you get &quot;Object required&quot;.  Is there some whitespace at the end of the field? If you change the name of the fields to something else and update the code with that name does the same error occur?  my two cents."}, {"owner": {"reputation": 2177, "user_id": 1211997, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/289e883b1531a6c68ce799642e3b918e?s=128&d=identicon&r=PG", "display_name": "rheitzman", "link": "https://stackoverflow.com/users/1211997/rheitzman"}, "edited": false, "score": 0, "creation_date": 1445457562, "post_id": 33247537, "comment_id": 54337373, "body": "<code>getNthFieldName</code> is a method on AcroPDDoc(), in the JavaScript references at least, so perhaps some of the other properties and methods are also valid. I think JSObject() may support a subset - I doubt it can be used to create objects. JSObject is evidently an Interop creature that isn&#39;t documented anywhere I can find."}, {"owner": {"reputation": 2177, "user_id": 1211997, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/289e883b1531a6c68ce799642e3b918e?s=128&d=identicon&r=PG", "display_name": "rheitzman", "link": "https://stackoverflow.com/users/1211997/rheitzman"}, "edited": false, "score": 1, "creation_date": 1445458411, "post_id": 33247537, "comment_id": 54337823, "body": "Here&#39;s a JavaScript reference that lists properties and methods - not sure what the overlap is with the Acrobat 1.0 interop.dll <a href=\"http://www.adobe.com/content/dam/Adobe/en/devnet/acrobat/pdfs/reader_overview.pdf\" rel=\"nofollow noreferrer\">adobe.com/content/dam/Adobe/en/devnet/acrobat/pdfs/&hellip;</a> see print page 10/11 for getNthFieldName. Doesn&#39;t document the objects, just lists them."}], "answers": [{"comments": [{"owner": {"reputation": 858, "user_id": 2496046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bd9b13a03c118e4d796f5e2d3f290e6d?s=128&d=identicon&r=PG", "display_name": "Greg Lovern", "link": "https://stackoverflow.com/users/2496046/greg-lovern"}, "edited": false, "score": 0, "creation_date": 1445457165, "post_id": 33248563, "comment_id": 54337194, "body": "Thanks, I was able to use getNthFieldName to return the very long full field &quot;names&quot; (they look like fully qualified references), which in turn worked in my original code. Details in my update above."}, {"owner": {"reputation": 2177, "user_id": 1211997, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/289e883b1531a6c68ce799642e3b918e?s=128&d=identicon&r=PG", "display_name": "rheitzman", "link": "https://stackoverflow.com/users/1211997/rheitzman"}, "reply_to_user": {"reputation": 858, "user_id": 2496046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bd9b13a03c118e4d796f5e2d3f290e6d?s=128&d=identicon&r=PG", "display_name": "Greg Lovern", "link": "https://stackoverflow.com/users/2496046/greg-lovern"}, "edited": false, "score": 0, "creation_date": 1445457962, "post_id": 33248563, "comment_id": 54337584, "body": "The field names should match the form field definitions as seen in AcroBat when you have the PDF open for editing. (Tools (upper right menu bar), Forms, Edit).  The authoring person/program probably selected the field names, perhaps naming them some that they could be referenced over several versions."}, {"owner": {"reputation": 54, "user_id": 9873038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7307104004465b1d5fafe0de28e894a?s=128&d=identicon&r=PG&f=1", "display_name": "Cullen", "link": "https://stackoverflow.com/users/9873038/cullen"}, "edited": false, "score": 1, "creation_date": 1532457448, "post_id": 33248563, "comment_id": 89979916, "body": "I know this post is almost three years old, but if anybody comes through here: <a href=\"https://www.adobe.com/content/dam/acom/en/devnet/acrobat/pdfs/Acro6JS.pdf\" rel=\"nofollow noreferrer\">adobe.com/content/dam/acom/en/devnet/acrobat/pdfs/Acro6JS.pd&zwnj;&#8203;f</a> this is the documentation for use in pdfs and <a href=\"https://www.adobe.com/content/dam/acom/en/devnet/acrobat/pdfs/VBJavaScript.pdf\" rel=\"nofollow noreferrer\">adobe.com/content/dam/acom/en/devnet/acrobat/pdfs/&hellip;</a> this talks about use in VBA but isn&#39;t a full reference"}], "tags": [], "owner": {"reputation": 2177, "user_id": 1211997, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/289e883b1531a6c68ce799642e3b918e?s=128&d=identicon&r=PG", "display_name": "rheitzman", "link": "https://stackoverflow.com/users/1211997/rheitzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1445383994, "creation_date": 1445383994, "answer_id": 33248563, "question_id": 33247537, "link": "https://stackoverflow.com/questions/33247537/not-seeing-pdf-fields-from-excel-vba/33248563#33248563", "title": "Not seeing PDF fields from Excel VBA", "body": "<p>iTextSharp is much easier to use!</p>\n\n<p>That said, here's a snippet to read all fields.</p>\n\n<pre><code>Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click\n    Dim pdfForm As Acrobat.AcroPDDoc\n    Dim jso As Object ' ?\n    Dim s As String = \"\"\n    Dim i As Integer\n    Dim strFullPath As String = \"H:\\OIS\\ENFORCE\\OPEN_BURN\\Ag\\temp\\Open_Burn_Template_Out.pdf\"\n    Try\n        pdfForm = New Acrobat.AcroPDDoc\n        pdfForm.Open(strFullPath)\n        jso = pdfForm.GetJSObject\n        For i = 0 To jso.numfields() - 1\n            s = jso.getNthFieldName(i)\n            Debug.Print(s &amp; \": \" &amp; jso.getField(s).value)\n        Next\n    Catch ex As Exception\n        MsgBox(ex.Message)\n    End Try\nEnd Sub\n</code></pre>\n\n<p>It could be your \"form\" doesn't have any fields (or a flattened form), or the names are off. </p>\n\n<p>The JSObject properties are a bit of a mystery. I found a post that used reflection to extract data but it just so happens that the JSObject properties are usable if you know what they are! e.g. numfields, getNthFieldName</p>\n\n<p>If anyone finds a reference link for JSObject please post in comments.</p>\n"}, {"comments": [{"owner": {"reputation": 858, "user_id": 2496046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bd9b13a03c118e4d796f5e2d3f290e6d?s=128&d=identicon&r=PG", "display_name": "Greg Lovern", "link": "https://stackoverflow.com/users/2496046/greg-lovern"}, "edited": false, "score": 0, "creation_date": 1445456454, "post_id": 33249396, "comment_id": 54336815, "body": "Thanks, this is interesting, but leaves me with the same problem as before. Same error on the same line, for the same reason."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 0, "last_activity_date": 1445390260, "creation_date": 1445390260, "answer_id": 33249396, "question_id": 33247537, "link": "https://stackoverflow.com/questions/33247537/not-seeing-pdf-fields-from-excel-vba/33249396#33249396", "title": "Not seeing PDF fields from Excel VBA", "body": "<p>Not quite intuitive in the <a href=\"http://www.adobe.com/content/dam/Adobe/en/devnet/acrobat/pdfs/iac_developer_guide.pdf\" rel=\"nofollow\">Adobe Acrobat OLE</a> documentation but connsider using the AvDoc (UI) object as a \"middle man\" between document and app (<code>Form &lt; UI &lt; App</code>). Essentially, the <a href=\"http://www.khk.net/wordpress/2009/03/04/adobe-acrobat-and-vba-an-introduction/\" rel=\"nofollow\">AvDoc</a> is the user interface object that the user interacts with while the PDDoc is the background object the user does not see but Adobe Acrobat maintains access to.</p>\n\n<p>Notice too I open the document with <code>formDoc</code>, a different PDDoc, than the one used for JSObject as <code>formDoc</code> inherits from the AVDoc object. Again, this automation is not well documented as Adobe leans more to Javascript than VBA, so this is mostly learned through trial and error.</p>\n\n<pre><code>Sub Main()\n    Dim AcroApp As Acrobat.CAcroApp\n    Dim formUI As Acrobat.CAcroAVDoc\n    Dim srcDoc As Acrobat.CAcroPDDoc, formDoc As Acrobat.CAcroPDDoc\n    Dim jso As Object\n    Dim strFullPath As String, text1 As String, text2 As String\n\n    Set AcroApp = CreateObject(\"AcroExch.App\")\n    Set formUI = CreateObject(\"AcroExch.AVDoc\")\n    Set srcDoc = CreateObject(\"AcroExch.PDDoc\")\n\n    strFullPath = Application.GetOpenFilename()\n    srcDoc.Open (strFullPath)\n\n    If formUI.Open(strFullPath, \"\") = True Then\n        Set formDoc = formUI.GetPDDoc()        \n        Set jso = formDoc.GetJSObject()\n\n        ' EXTRACT FORM FIELDS' TEXT\n         text1 = jso.GetField(\"MFR_ctrl33605579\").Value    \n    End If\n\n   ' UNINTIALIZING PDF OBJECTS\n    Set jso = Nothing\n    Set formDoc = Nothing         \n    Set srcDoc = Nothing \n    Set formUI = Nothing\n    Set AcroApp = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 858, "user_id": 2496046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bd9b13a03c118e4d796f5e2d3f290e6d?s=128&d=identicon&r=PG", "display_name": "Greg Lovern", "link": "https://stackoverflow.com/users/2496046/greg-lovern"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4359, "favorite_count": 0, "accepted_answer_id": 33248563, "answer_count": 2, "score": 0, "last_activity_date": 1445456911, "creation_date": 1445378259, "last_edit_date": 1445456911, "question_id": 33247537, "link": "https://stackoverflow.com/questions/33247537/not-seeing-pdf-fields-from-excel-vba", "title": "Not seeing PDF fields from Excel VBA", "body": "<p>I've been tasked with creating an Excel tool to import data from thousands of PDFs into Excel. I've installed Adobe Acrobat X Professional, and it seems to be working fine. I'm using Excel 2007.</p>\n\n<p>I found sample code here:\n<a href=\"http://khkonsulting.com/2010/09/reading-pdf-form-fields-with-vba/\" rel=\"nofollow\">http://khkonsulting.com/2010/09/reading-pdf-form-fields-with-vba/</a></p>\n\n<p>And modifying it only slightly to prompt me to browse to the PDF file, and setting a reference to \"Adobe Acrobat 10.0 Type Library\", I'm trying this code:</p>\n\n<pre><code>Sub Main()\nDim AcroApp As Acrobat.CAcroApp\nDim theForm As Acrobat.CAcroPDDoc\nDim jso As Object\nDim text1, text2 As String\n\nSet AcroApp = CreateObject(\"AcroExch.App\")\nSet theForm = CreateObject(\"AcroExch.PDDoc\")\n\nDim strFullPath As String\nstrFullPath = Application.GetOpenFilename()\ntheForm.Open (strFullPath) 'theForm.Open (\"C:\\temp\\sampleForm.pdf\")\n\nSet jso = theForm.GetJSObject\n\n' get the information from the form fields Text1 and Text2\ntext1 = jso.getfield(\"MFR_ctrl33605579\").Value 'jso.getfield(\"Text1\").Value\n'(etc)\nEnd Sub\n</code></pre>\n\n<p>(\"MFR_ctrl33605579\" is the name of one of the text fields; I found that in the editor that is part of or included with Acrobat Pro, called \"Adobe LiveCycle Designer\".)</p>\n\n<p>It runs without error until it gets to the getfield method. Then I get the error \"Object required\".</p>\n\n<p>If I run TypeName on AcroApp, theForm, and jso, I get CAcroApp, CAcroPDDoc, and object respectively:</p>\n\n<pre><code>?typename(AcroApp)\nCAcroApp\n?typename(theForm)\nCAcroPDDoc\n?typename(jso)\nObject\n</code></pre>\n\n<p>If I put them in the Watches window, I initially get plus signs to the left of all three of them, but if I click on those plus signs, only one line appears under each one, saying \"&lt; No Variables >\" in the Value column.</p>\n\n<p>I wondered if the document was somehow locked against being read in this way. I read that if it was locked, a padlock would appear at the upper left in Acrobat, and it would not allow saving as text. But no padlock appears that I see, and it does allow saving as plain text. So as far as I can tell it doesn't seem to be locked.</p>\n\n<p>Any suggestions on what I can try?</p>\n\n<p>UPDATE:</p>\n\n<p>I'm just getting started trying the suggestions, but I wanted to note that after trying rheitzman's For loop to get the field name (using getNthFieldName), I see that my code works if I use this for the field name:</p>\n\n<pre><code>form1[0].QuestionnaireForm[0].sbfrmProfile[0].sbfrmContact[0].sbfrmManufacturerDetails[0].MFR_ctrl33605579[0]\n</code></pre>\n\n<p>Or in other words:</p>\n\n<pre><code>text1 = jso.getfield(\"MFR_form1[0].QuestionnaireForm[0].sbfrmProfile[0].sbfrmContact[0].sbfrmManufacturerDetails[0].MFR_ctrl33605579[0]\").Value\n</code></pre>\n\n<p>That would allow me to identify fields by that very long, apparently fully-qualified reference, which would get me through the project. But first I'm going to check the other ideas to see if the fields can be found by short name only.</p>\n\n<p>UPDATE 2:</p>\n\n<p>I see now that I can inspect some details of some of the object model in the Object Browser (filter Libraries on Acrobat), even though it doesn't show up in the Watch window.</p>\n\n<p>However, it doesn't show objects created by methods, such as the object created by the AcroExch.PDDoc.GetJSObject method (see AcroPDDoc in the object model). The method of that object used here, getNthFieldName, does not appear in the object browser at all.</p>\n\n<p>And, I don't see any other way there of identifying the fields by their short field names.</p>\n\n<p>So ... for this project, I'm just going to use the long field names returned by getNthFieldName.</p>\n"}, {"tags": ["excel", "syntax-error", "datasource", "pivot-table", "vba"], "answers": [{"tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": false, "score": 0, "last_activity_date": 1448203925, "creation_date": 1448203925, "answer_id": 33856100, "question_id": 33247320, "link": "https://stackoverflow.com/questions/33247320/run-time-error-13-while-changing-the-pivotcache/33856100#33856100", "title": "Run time error 13 - While changing the pivotcache", "body": "<p>The code is actually trying to create one <code>PivotCache</code> for each <code>PivotTable</code>.</p>\n\n<p>I suggest to create just one <code>PivotCache</code> per external workbook then change the <code>PivotCache</code> of each <code>PivotTable</code> as it corresponds.</p>\n\n<p>Replace your the part that changes the Pivot Cache with this code:</p>\n\n<pre><code>Dim Pch1 As PivotCache, Pch2 As PivotCache\n\nWith Windows(\"Forward Bookings\")\n    With .PivotCaches\n        Set Pch1 = .Create(SourceType:=xlDatabase, _\n            SourceData:=Workbooks(libro1).Sheets(\"Input\").Range(\"A1\").CurrentRegion)\n        Set Pch1 = .Create(SourceType:=xlDatabase, _\n            SourceData:=Workbooks(libro2).Sheets(\"Input\").Range(\"A1\").CurrentRegion)\n    End With\n    For Each hoja In .Worksheets\n        For Each pt In hoja.PivotTables\n            Select Case Right(pt.Name, 1)\n            Case 1\n                'cambiar cache a\u00f1o anterior\n                pt.ChangePivotCache (Pch1)\n            Case 2\n                'cambiar cache a\u00f1o actual\n                pt.ChangePivotCache (Pch2)\n            End Select\n\nNext: Next: End With\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5098561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107944f0cf3ae8a4358007a13629e336?s=128&d=identicon&r=PG&f=1", "display_name": "Tomas de la Carrera", "link": "https://stackoverflow.com/users/5098561/tomas-de-la-carrera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 221, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1448203925, "creation_date": 1445377364, "last_edit_date": 1531161705, "question_id": 33247320, "link": "https://stackoverflow.com/questions/33247320/run-time-error-13-while-changing-the-pivotcache", "title": "Run time error 13 - While changing the pivotcache", "body": "<p>Im new on this forum. I wanted to ask if anyone can help me with this. I wrote a macro that changes all the pivottables sources on which if the name of the pt ends with 1 it applies one source from another xlsx file and if its 2 it gives another one from another file. I keep both books open during the macro to make sure it doesnt break on that side. But in \"case 2\" it always throws the run time error 13 : type missmatch . Can anyone help me fix this. Thanks before hand!</p>\n\n<pre><code>Sub origen_tablas_fwb()\n\nDim hoja As Worksheet\nDim pt As PivotTable\nDim a1, a2, j As Long\nDim libro1, libro2 As String\n\na2 = Workbooks(\"Global ETdlc.xlsx\").Worksheets(\"Comando\").Range(\"A7\").Value\na1 = a2 - 1\nWindows(\"Global ETdlc.xlsx\").Activate\nSheets(\"Comando\").Activate\nj = Sheets(\"Comando\").Range(\"N1\", Range(\"N1\").End(xlDown)).Rows.Count\nlibro2 = Workbooks(\"Global ETdlc.xlsx\").Worksheets(\"Comando\").Range(\"B8\").Value\nFor i = 1 To j\n    If Cells(i, 14).Value = libro2 Then\n    libro1 = Cells(i, 15).Value\n    End If\nNext i\n\n'Workbooks.Open Filename:=\"C:\\Respaldo Reservas\\FEEDS+FWB\\\" &amp; a1 &amp; \"\\\" &amp; libro1\n'Workbooks.Open Filename:=\"C:\\Respaldo Reservas\\FEEDS+FWB\\\" &amp; a2 &amp; \"\\\" &amp; libro2\n\n'Workbooks.Open Filename:=\"C:\\Informes\\Forward Bookings\"\nWindows(\"Forward Bookings\").Activate\nFor Each hoja In ActiveWorkbook.Worksheets\n    For Each pt In Worksheets(hoja.Name).PivotTables\n        Select Case Right(pt.Name, 1)\n        Case 1\n        'cambiar cache a\u00f1o anterior\n        ActiveSheet.pt.ChangePivotCache ActiveWorkbook. _\n        PivotCaches.Create(SourceType:=xlDatabase, _\n        SourceData:=Workbooks(libro1).Sheets(\"Input\").Range(\"A1\").CurrentRegion)\n        Case 2\n        'cambiar cache a\u00f1o actual\n        ActiveSheet.pt.ChangePivotCache ActiveWorkbook. _\n        PivotCaches.Create(SourceType:=xlDatabase, _\n        SourceData:=Workbooks(libro2).Sheets(\"Input\").Range(\"A1\").CurrentRegion)\n        End Select\n    Next pt\nNext hoja\nWindows(libro1).Close\nWindows(libro2).Close\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "file-copying"], "answers": [{"tags": [], "owner": {"reputation": 10875, "user_id": 2392157, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QEWAU.png?s=128&g=1", "display_name": "miroxlav", "link": "https://stackoverflow.com/users/2392157/miroxlav"}, "is_accepted": false, "score": 2, "last_activity_date": 1445378071, "last_edit_date": 1445378071, "creation_date": 1445376904, "answer_id": 33247212, "question_id": 33247139, "link": "https://stackoverflow.com/questions/33247139/vba-filecopy-file-not-found-issue/33247212#33247212", "title": "VBA FileCopy: file not found issue", "body": "<p>You need to specify <strong>destination folder + destination file name</strong> (and not only destination folder).</p>\n\n<p>So this will work:</p>\n\n \n\n<pre class=\"lang-vb prettyprint-override\"><code>FileCopy fileName, destinationFolder &amp; \"\\\" &amp; FSO.GetBaseName(FileItem) &amp; \".AETCLS\"\n</code></pre>\n\n<p>You were probably assuming this will work like a file manager application, where giving destination folder is enough... :) But when programming, you need to specify destination path exactly as it is, i.e. including the file name.</p>\n\n<p>One of my friends was getting similar error on creating directory <code>newdir1\\newdir2\\newdir3</code>. It was not working despite his best effort. But the solution was to create <code>newdir1</code>, then it became possible to specify <code>newdir1\\newdir2</code>, then finally <code>newdir1\\newdir2\\newdir3</code>. Programming file operations does not do the job often seen in file managers, but everything must be specified in detail and performed in elementary steps.</p>\n"}, {"tags": [], "owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "is_accepted": false, "score": 0, "last_activity_date": 1445380714, "creation_date": 1445380714, "answer_id": 33248033, "question_id": 33247139, "link": "https://stackoverflow.com/questions/33247139/vba-filecopy-file-not-found-issue/33248033#33248033", "title": "VBA FileCopy: file not found issue", "body": "<p>Thanks for your help. What I discovered is that you have to have the full destination path, including the file name, even though it isn't changing. Solved!</p>\n"}], "owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3556, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1445380714, "creation_date": 1445376572, "last_edit_date": 1445378001, "question_id": 33247139, "link": "https://stackoverflow.com/questions/33247139/vba-filecopy-file-not-found-issue", "title": "VBA FileCopy: file not found issue", "body": "<p>I am working on a project in VBA where I'm searching a directory for files of a certain date that also meet other criteria, and all of that is working fine. What I am stuck on, which should be a trivial issue, is that when I try to use FileCopy to copy the file to another folder, I keep getting a path/file access error. This confuses me because I am pulling the path directly from the FileItem I'm using to search for the criteria, I'm the person who created both the source and destination folders, and put the files in the source folder. Any thoughts?</p>\n\n<pre><code>Sub ListFilesInFolder()\n\n    Dim counter As Integer\n    Dim theString1 As String, theString2 As String\n        theString1 = \"ISA*00*\"\n        theString2 = \"ISA|00|\"\n    Dim line As String, fileName As String\n    Dim datestring As String\n        'datestring = Format(FileItem.DateLastModified, \"mm/dd/yyyy\")\n    Dim today As String\n        today = Format(DateAdd(\"d\", -2, Date), \"mm/dd/yyyy\")\n    Dim destinationFolder As String\n        destinationFolder = \"C:\\Users\\kragan\\Desktop\\test\\folder2\"\n    Dim file As TextStream\n    Dim FSO As Scripting.FileSystemObject\n        Set FSO = New Scripting.FileSystemObject\n    Dim SourceFolder As Scripting.Folder\n        Set SourceFolder = FSO.GetFolder(\"C:\\Users\\kragan\\Desktop\\test\\folder1\")\n    Dim FileItem As Scripting.file\n\n    For Each FileItem In SourceFolder.Files\n    datestring = \"10/18/2015\"\n        If (datestring = today) Then\n            Do While (SourceFolder &lt;&gt; \"\")\n                Set file = FSO.OpenTextFile(FileItem)\n                counter = 0\n\n                Do While Not file.AtEndOfLine And counter &lt; 1\n                    line = file.ReadLine\n\n                    If InStr(1, line, theString1, vbTextCompare) &gt; 0 Or InStr(1, line, theString2, vbTextCompare) &gt; 0 Then\n                        fileName = \"C:\\Users\\kragan\\Desktop\\test\\folder1\\\" + FSO.GetBaseName(FileItem) + \".AETCLS\"\n\n    'The line where I get the error:\n                        FileCopy fileName, destinationFolder\n\n                        file.Close\n                        counter = counter + 1\n                        Exit Do\n                    End If\n                Loop\n            Loop\n        End If\n    Next FileItem\n    MsgBox (\"done\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "combobox", "userform"], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 5389207, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/50764df5fc97ed3885860bb101305936?s=128&d=identicon&r=PG&f=1", "display_name": "CORNAKI", "link": "https://stackoverflow.com/users/5389207/cornaki"}, "edited": false, "score": 0, "creation_date": 1445376986, "post_id": 33247171, "comment_id": 54296744, "body": "I CANT THANK YOU ENOUGH,I knew it was ridiculous easy, and i knew i was thinking too hard about it. Thanks so much."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 77, "user_id": 5389207, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/50764df5fc97ed3885860bb101305936?s=128&d=identicon&r=PG&f=1", "display_name": "CORNAKI", "link": "https://stackoverflow.com/users/5389207/cornaki"}, "edited": false, "score": 0, "creation_date": 1445377091, "post_id": 33247171, "comment_id": 54296802, "body": "@CORNAKI YOU DEFINITELY LIKE THE CAPS. :) You are welcome.  If you are inclined would you mark it as correct."}, {"owner": {"reputation": 77, "user_id": 5389207, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/50764df5fc97ed3885860bb101305936?s=128&d=identicon&r=PG&f=1", "display_name": "CORNAKI", "link": "https://stackoverflow.com/users/5389207/cornaki"}, "edited": false, "score": 0, "creation_date": 1445377400, "post_id": 33247171, "comment_id": 54296956, "body": "Can i ask a question, just to understand better. What i see from your answer is - if there is an error then do &#39;first thing&#39; and ifnot then do &#39;second thing&#39; - But your code is doing the opposite. It works perfect but i would like to understand. Thanks"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 77, "user_id": 5389207, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/50764df5fc97ed3885860bb101305936?s=128&d=identicon&r=PG&f=1", "display_name": "CORNAKI", "link": "https://stackoverflow.com/users/5389207/cornaki"}, "edited": false, "score": 0, "creation_date": 1445377581, "post_id": 33247171, "comment_id": 54297066, "body": "@CORNAKI With IFError() it is the opposite.  It tries to do the first thing, if an error results then it does the second thing otherwise it returns the value found in the first formula."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 77, "user_id": 5389207, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/50764df5fc97ed3885860bb101305936?s=128&d=identicon&r=PG&f=1", "display_name": "CORNAKI", "link": "https://stackoverflow.com/users/5389207/cornaki"}, "edited": false, "score": 0, "creation_date": 1445377807, "post_id": 33247171, "comment_id": 54297170, "body": "Also with the Vlookup function notice I have<code>application</code> in front not <code>worksheetfunction</code>,  This allows a #N/A to be returned.  With the <code>WorksheetFunction</code> it does not allow the #N/A to return as a value and stops the code."}, {"owner": {"reputation": 77, "user_id": 5389207, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/50764df5fc97ed3885860bb101305936?s=128&d=identicon&r=PG&f=1", "display_name": "CORNAKI", "link": "https://stackoverflow.com/users/5389207/cornaki"}, "edited": false, "score": 0, "creation_date": 1445378045, "post_id": 33247171, "comment_id": 54297276, "body": "great stuff appreciate it!"}, {"owner": {"reputation": 77, "user_id": 5389207, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/50764df5fc97ed3885860bb101305936?s=128&d=identicon&r=PG&f=1", "display_name": "CORNAKI", "link": "https://stackoverflow.com/users/5389207/cornaki"}, "edited": false, "score": 0, "creation_date": 1451442133, "post_id": 33247171, "comment_id": 56785694, "body": "you took care of this a long time ago, and i appreciate it, BUT, i just nticed it is doing something weird that is causing problems. It always gives a zero value into the cell if the vlookup doesn&#39;t find anything. It doesn&#39;t even entre the &quot;enter new info&quot; just a zero"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1445376727, "creation_date": 1445376727, "answer_id": 33247171, "question_id": 33247110, "link": "https://stackoverflow.com/questions/33247110/userform-combobox/33247171#33247171", "title": "UserForm ComboBox", "body": "<p>You should be able to do it all with one line:</p>\n\n<pre><code>Private Sub TextBox1_Enter()\n    If cbocolor.value &lt;&gt; \"\" Then\n\n        TextBox1.value = WorksheetFunction.IfError(Application.VLookup(cbocolor.value, _\n           Worksheets(\"CONTACTS\").Range(\"allcontacts\"), 2, False), \"Enter New Info\")\n\n   End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 5389207, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/50764df5fc97ed3885860bb101305936?s=128&d=identicon&r=PG&f=1", "display_name": "CORNAKI", "link": "https://stackoverflow.com/users/5389207/cornaki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "accepted_answer_id": 33247171, "answer_count": 1, "score": 0, "last_activity_date": 1445395678, "creation_date": 1445376467, "last_edit_date": 1445395678, "question_id": 33247110, "link": "https://stackoverflow.com/questions/33247110/userform-combobox", "title": "UserForm ComboBox", "body": "<p>I have a UserForm that has one ComboBox and a TextBox. The TextBox needs to do a vlookup for the value of the ComboBox but ONLY if that value exists in the list, if not, I want nothing to appear in the TextBox so the user can enter new information.  </p>\n\n<p>This is how far I have got:</p>\n\n<pre><code>Private Sub TextBox1_Enter()\nIf cbocolor.Value &lt;&gt; \"\" Then\n\nDim evalStr As String\nDim check As Variant\nevalStr = WorksheetFunction.VLookup(cbocolor.Value,        worksheets(\"CONTACTS\").Range(\"allcontacts\"), 2, False)\ncheck = Evaluate(evalStr)\nIf VarType(check) = vbError Then\nTextBox1.Value = \"Enter new info\"\n\nElse\nvar1 = WorksheetFunction.VLookup(cbocolor.Value,      Worksheets(\"CONTACTS\").Range(\"allcontacts\"), 2, False)\nTextBox1.Value = var1\n\n\n\nEnd If\n</code></pre>\n"}, {"tags": ["class", "excel", "dictionary", "vba"], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 5468752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5c0c0f3a12524c2f2608ff6d22b02e1?s=128&d=identicon&r=PG&f=1", "display_name": "Jcarneir", "link": "https://stackoverflow.com/users/5468752/jcarneir"}, "is_accepted": false, "score": 1, "last_activity_date": 1445378188, "creation_date": 1445378188, "answer_id": 33247518, "question_id": 33246830, "link": "https://stackoverflow.com/questions/33246830/error-in-my-vba-code-function-show-in-inner-dictionary-increases-count-by-1/33247518#33247518", "title": "Error in my VBA Code. Function Show in Inner Dictionary Increases Count by 1", "body": "<p>Solved. The code i right!!!</p>\n\n<p>Vba dictionary has an issue when accessing and item that not exists: vba creates an empty item with an empty key.</p>\n\n<p>The code never evaluate a not existing element but in the watch window I have an expression that was viewing an external variable of dictionary type. When entering to the module show, the watching expression add an item. </p>\n\n<p>I just cleaned the watching window.</p>\n"}], "owner": {"reputation": 21, "user_id": 5468752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5c0c0f3a12524c2f2608ff6d22b02e1?s=128&d=identicon&r=PG&f=1", "display_name": "Jcarneir", "link": "https://stackoverflow.com/users/5468752/jcarneir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1445378188, "creation_date": 1445375398, "last_edit_date": 1531164843, "question_id": 33246830, "link": "https://stackoverflow.com/questions/33246830/error-in-my-vba-code-function-show-in-inner-dictionary-increases-count-by-1", "title": "Error in my VBA Code. Function Show in Inner Dictionary Increases Count by 1", "body": "<p>I created 2 Classes. An Internal_Dict with items of type \"double\" and an external Dict with items of type Internal_Dict. Both classes have a Show procedure to print the data. I created a test procedure to verifies both classes. Internal_Dict it's Ok but External_Dict has an issue: when the trace enter the show function the count increases by one. It creates a new item with an empty key. That generates an error when try to print that new item.</p>\n\n<pre><code>Class Module IntDict  \n'private Attributes  \nPrivate pInternalDict As Scripting.Dictionary\n\n'Class Initialize/Terminate methods  \nPrivate Sub Class_Initialize()  \nSet pInternalDict = New Scripting.Dictionary  \nEnd Sub\n\nPrivate Sub Class_Terminate()  \nSet pInternalDict = Nothing  \nEnd Sub\n\n'Add/Count/Items/Item/Remove/Remove All Methods  \nPublic Function Add(Key As Variant, Item As Double)  \npInternalDict.Add Key:=Key, Item:=Item  \nEnd Function\n\nPublic Function Update(Key As Variant, Item As Double)  \nIf pInternalDict.Exists(Key) Then  \n    pInternalDict.Item(Key) = pInternalDict.Item(Key) + Item  \nElse  \n    pInternalDict.Add Key:=Key, Item:=Item  \nEnd If  \nEnd Function\n\nPublic Property Get Count() As Long  \nCount = pInternalDict.Count  \nEnd Property\n\nPublic Property Get Items() As Scripting.Dictionary  \nSet Items = pInternalDict  \nEnd Property\n\nPublic Property Get Item(vItem As Variant) As Double  \nItem = pInternalDict.Item(vItem)  \nEnd Property\n\nPublic Function Exists(vItem As Variant) As Boolean  \nExists = pRentas.Exists(vItem)  \nEnd Function\n\nPublic Sub Show()  \nDim vKey As Variant\n\nFor Each vKey In pInternalDict.Keys  \n    Debug.Print vKey &amp; \"|\" &amp; pInternalDict.Item(vKey)  \nNext  \nEnd Sub\n\nClass Module ExtDict  \n'private Attributes  \nPrivate pExternalDict As Scripting.Dictionary  \n\n'Class Initialize/Terminate methods  \nPrivate Sub Class_Initialize()   \nSet pExternalDict = New Scripting.Dictionary  \nEnd Sub\n\nPrivate Sub Class_Terminate()  \nSet pExternalDict = Nothing  \nEnd Sub\n\n'Add/Count/Items/Item/Remove/Remove All Methods  \nPublic Function Add(Key As Variant, Item As CInternalDict)  \npExternalDict.Add Key:=Key, Item:=Item  \nEnd Function\n\nPublic Function Update(ExternalKey As Variant, InternalKey As Variant,   Item As Double)  \nDim newIntDict As CInternalDict  \n\nIf pExternalDict.Exists(ExternalKey) Then  \n    With pExternalDict.Item(ExternalKey)  \n        Call .Update(InternalKey, Item)  \n    End With  \nElse  \n    Set newIntDict = New CInternalDict  \n    newIntDict.Add Key:=InternalKey, Item:=Item  \n    pExternalDict.Add Key:=ExternalKey, Item:=newIntDict  \nEnd If  \nEnd Function\n\nPublic Property Get Count() As Long  \nCount = pExternalDict.Count  \nEnd Property\n\nPublic Property Get Items() As Scripting.Dictionary  \nSet Items = pExternalDict  \nEnd Property\n\nPublic Property Get Item(vItem As Variant) As CRentasCasa  \nItem = pExternalDict.Item(vItem)  \nEnd Property\n\nPublic Function Exists(vItem As Variant) As Boolean  \nExists = pExternalDict.Exists(vItem)  \nEnd Function\n\nPublic Sub Show()  \nDim vKey As Variant  \nDim dItem As CInternalDict  \n\nFor Each vKey In pExternalDict.Keys  \n    Debug.Print vKey 'Print external key  \n    Set dItem = pExternalDict.Item(vKey)  \n    dItem.Show 'Show Internal Dict  \nNext  \nEnd Sub\n\n=========================\n'Externals procedures\n\nSub Test_InternalDict() 'It's OK  \nDim myIntDict As CInternalDict  \n\nSet myIntDict = New CInternalDict  \n    myIntDict.Update \"IntBox1\", 1500  \n    myIntDict.Update \"IntBox2\", 1800  \n    myIntDict.Update \"IntBox1\", 200  \n    myIntDict.Update \"IntBox2\", 100  \n    myIntDict.Update \"IntBox1\", 100  \n    myIntDict.Update \"IntBox3\", 1500  \n    myIntDict.Update \"IntBox4\", 1900  \n    myIntDict.Show  \nSet myIntDict = Nothing  \nEnd Sub\n\n'Creates the ExternalDict in the right way but show call has a bad behavior  \nSub Test_ExternalDict()   \nDim myExtDict As CExternalDict\n\nSet myExtDict = New CExternalDict  \n    myExtDict.Update \"ExtBox1\", 6, 1500  \n    myExtDict.Update \"ExtBox1\", 8, 1800  \n    myExtDict.Update \"ExtBox2\", 5, 100  \n    myExtDict.Update \"ExtBox3\", 7, 1900  \n    myExtDict.Update \"ExtBox1\", 7, 1600  \n    myExtDict.Update \"ExtBox2\", 8, 1900  \n    myExtDict.Update \"ExtBox3\", 4, 100  \n    myExtDict.Update \"ExtBox1\", 7, 300  \n    myExtDict.Update \"ExtBox2\", 5, 1400  \n    myExtDict.Update \"ExtBox3\", 4, 1500  \n    myExtDict.Update \"ExtBox1\", 6, 200  \n    myExtDict.Update \"ExtBox3\", 5, 200  \n    myExtDict.Update \"ExtBox3\", 5, 1800  \n    myExtDict.Update \"ExtBox3\", 7, -100  \n    myExtDict.Show 'ERROR. Add an Item when enter in the Show Function  \nSet myExtDict = Nothing\nEnd Sub`\n</code></pre>\n\n<p>'Any clue????</p>\n"}, {"tags": ["vba", "date", "select", "weekday"], "comments": [{"owner": {"reputation": 29, "user_id": 5455711, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c6aa296acc7b696c1902fd916522ae45?s=128&d=identicon&r=PG&f=1", "display_name": "marvellosity123", "link": "https://stackoverflow.com/users/5455711/marvellosity123"}, "edited": false, "score": 0, "creation_date": 1445375562, "post_id": 33246743, "comment_id": 54295992, "body": "it doesnt work if I remove the select case thing it runs. but I want it to say none during the weekends, and Im not sure how."}, {"owner": {"reputation": 29, "user_id": 5455711, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c6aa296acc7b696c1902fd916522ae45?s=128&d=identicon&r=PG&f=1", "display_name": "marvellosity123", "link": "https://stackoverflow.com/users/5455711/marvellosity123"}, "edited": false, "score": 0, "creation_date": 1445375754, "post_id": 33246743, "comment_id": 54296111, "body": "Also it now says invalid procedure call"}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1445376310, "last_edit_date": 1445376310, "creation_date": 1445375819, "answer_id": 33246938, "question_id": 33246743, "link": "https://stackoverflow.com/questions/33246743/vba-finding-weekend-and-choosing-array-response/33246938#33246938", "title": "vba finding weekend and choosing array response", "body": "<p>A couple of things:</p>\n\n<p>(1) weekdayname() does not return a number, it requires an integer indicating the day in the week you want, and it returns a string with the actual name eg \"Monday\".  The function you want is WeekDay().</p>\n\n<p>(2) To iterate through theDate, The loop was in the wrong place.</p>\n\n<p>(3) The instr() function does not place a value into an array, it will search a string and return the starting position of the search string as an integer.</p>\n\n<p>Try this:</p>\n\n<pre><code>Sub fixandresponse()\n\nDim count As Integer\n\nDim thedate As Date\n\nDim typesofproblems() As Variant\n\nthedate = DateSerial(2014, 9, 1)\n\ntypesofproblems = Array(\"bought new hardware\", \"Phone Support\", \"New User Request\", \"Rent Hardware\")\nFor count = 2 To 366\n    Select Case Weekday(thedate)\n            Case 1, 7\n                Range(\"B\" &amp; count) = \"none\"\n                Range(\"A\" &amp; count) = thedate\n        Case Else\n                Range(\"B\" &amp; count) = typesofproblems(WorksheetFunction.RandBetween(0, 3))\n                Range(\"A\" &amp; count) = thedate\n    End Select\n    thedate = thedate + 1\nNext\n\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 5455711, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c6aa296acc7b696c1902fd916522ae45?s=128&d=identicon&r=PG&f=1", "display_name": "marvellosity123", "link": "https://stackoverflow.com/users/5455711/marvellosity123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 33246938, "answer_count": 1, "score": 0, "last_activity_date": 1445550083, "creation_date": 1445375026, "last_edit_date": 1445550083, "question_id": 33246743, "link": "https://stackoverflow.com/questions/33246743/vba-finding-weekend-and-choosing-array-response", "title": "vba finding weekend and choosing array response", "body": "<p>How do I get column b to display \"none\" on a weekend? The code runs, but I don't see anything different than what would be without the select case.</p>\n\n<pre><code>Sub fixandresponse()\nDim count As Integer\nDim thedate As Date\nDim typesofproblems() As Variant\nthedate = DateSerial(2014, 9, 1)\n\ntypesofproblems = Array(\"bought new hardware\", \"Phone Support\", \"New User Request\", \"Rent Hardware\")\n\n\nSelect Case WeekdayName(thedate)\n\nCase 1, 7: Instr(typesofproblems) = \"none\"\nFor count = 2 To 366\n\nRange(\"B\" &amp; count) = typesofproblems(WorksheetFunction.RandBetween(0, 3))\nRange(\"A\" &amp; count) = thedate\n\nthedate = thedate + 1\nNext\n\nEnd Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "performance", "vba"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1445375411, "post_id": 33246653, "comment_id": 54295920, "body": "What is <code>j</code> supposed to be? Every time you change a cell value the code is kicking in.  And it is kicking in constantly, because you are changing cell values in the code."}, {"owner": {"reputation": 8007, "user_id": 5426909, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/axmqU.jpg?s=128&g=1", "display_name": "Robin Gertenbach", "link": "https://stackoverflow.com/users/5426909/robin-gertenbach"}, "edited": false, "score": 1, "creation_date": 1445376613, "post_id": 33246653, "comment_id": 54296544, "body": "This is better put in codereview <a href=\"http://codereview.stackexchange.com/\">codereview.stackexchange.com</a>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1445377022, "post_id": 33246653, "comment_id": 54296761, "body": "This would probably work better as a sub that gets called from the combobox1_change.  Put a loop in that works through all the desired cells."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1445384031, "post_id": 33246653, "comment_id": 54299283, "body": "Damn... Pretty tough to divine/guess what you are trying to do with this... Please edit your question to include more details!"}, {"owner": {"reputation": 319, "user_id": 1597345, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6b322fa36dd281baa818e0a81d80146?s=128&d=identicon&r=PG", "display_name": "M Faizan Farooq", "link": "https://stackoverflow.com/users/1597345/m-faizan-farooq"}, "edited": false, "score": 0, "creation_date": 1445407940, "post_id": 33246653, "comment_id": 54305742, "body": "Well everytime, when cell value (1,2) changes it will copy that value and the value of cell (10,19) and paste it in column A &amp; B respectively."}], "answers": [{"comments": [{"owner": {"reputation": 319, "user_id": 1597345, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6b322fa36dd281baa818e0a81d80146?s=128&d=identicon&r=PG", "display_name": "M Faizan Farooq", "link": "https://stackoverflow.com/users/1597345/m-faizan-farooq"}, "edited": false, "score": 0, "creation_date": 1445418454, "post_id": 33247413, "comment_id": 54311731, "body": "changed  If Intersect(Target, &quot;A:A&quot;) to If Intersect(Target, range(&quot;A:A&quot;)) and defined dim a &amp; b as variant the code worked for me thanks alot sir for timely reply."}], "tags": [], "owner": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "is_accepted": true, "score": 0, "last_activity_date": 1445377738, "creation_date": 1445377738, "answer_id": 33247413, "question_id": 33246653, "link": "https://stackoverflow.com/questions/33246653/how-can-i-optimise-this-code/33247413#33247413", "title": "How can I optimise this code?", "body": "<p>First, your formatting makes it difficult to read.<br>\nSecond, you are not disabling events when changing values, causing an eventual stack overflow or out of memory error, which will slow excel down.</p>\n\n<p>Formatted and improved code:</p>\n\n<pre><code>Dim a \nDim j As Integer\nDim b \nDim l As Integer\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\nIf Intersect(Target, \"A:A\") Is Nothing Then Exit Sub 'don't run unless change in column A\n\nApplication.EnableEvents = False 'stop executing this code until we are done\nIf Cells(j + 3, 1).Value = Cells(j + 2, 1).Value Then\n    j = j\nElse\n    j = j + 1\nEnd If\n\nIf l &lt; j Then\n    b = Cells(10, 19).Value\n    Cells(j + 1, 2).Value = b\nEnd If\n\nl = j\na = Cells(1, 2).Value\nCells(j + 3, 1).Value = a\nApplication.EnableEvents = True\nEnd Sub\n\nPrivate Sub Combobox1_Change()\nCells(1, 2) = Combobox1.Value\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 319, "user_id": 1597345, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6b322fa36dd281baa818e0a81d80146?s=128&d=identicon&r=PG", "display_name": "M Faizan Farooq", "link": "https://stackoverflow.com/users/1597345/m-faizan-farooq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 1, "accepted_answer_id": 33247413, "answer_count": 1, "score": -2, "last_activity_date": 1445408802, "creation_date": 1445374637, "last_edit_date": 1445408802, "question_id": 33246653, "link": "https://stackoverflow.com/questions/33246653/how-can-i-optimise-this-code", "title": "How can I optimise this code?", "body": "<p>Everytime, when cell value (1,2) changes it will copy that value and the value of cell (10,19) and paste it in column A &amp; B respectively\nMy Excel VBA makes Excel hang when the value of cell (1,2) changes:</p>\n\n<pre><code>Dim a As Variant\n\nDim j As Integer\nDim b As Variant\nDim l As Integer\n\n\n\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\nIf Cells(j + 3, 1).Value = Cells(j + 2, 1).Value Then\n          j = j\n          Else\n          j = j + 1\n\n        End If\n\n  If l &lt; j Then\nb = Cells(10, 19).Value\n Cells(j + 1, 2).Value = b\n\nEnd If\nl = j\na = Cells(1, 2).Value\nCells(j + 3, 1).Value = a\n\n\nEnd Sub\n\nPrivate Sub Combobox1_Change()\n Cells(1, 2) = Combobox1.Value\n\nEnd Sub  \n</code></pre>\n\n<p>How can I prevent this from happening?</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010", "ms-access-2007", "ms-access-2013"], "comments": [{"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 1, "creation_date": 1445390692, "post_id": 33245849, "comment_id": 54300814, "body": "What tells your form you are &#39;finished&#39; - didn&#39;t see a Save or Add button. If you make the controls on your form &#39;unbound&#39;, and you have a &#39;Save&#39; button, you could loop thru each serial # field and if not empty, save a record to your database."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1445421987, "post_id": 33245849, "comment_id": 54314103, "body": "Use a bound form, and in the BeforeUpdate event set the DefaultValue property of the fields with &quot;fixed&quot; content. When moving to a new record, the fields will display the default value."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5411284, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HPfgJYgYx0A/AAAAAAAAAAI/AAAAAAAAAEs/hYE9k3Cz_UY/photo.jpg?sz=128", "display_name": "Chris Rowley", "link": "https://stackoverflow.com/users/5411284/chris-rowley"}, "edited": false, "score": 0, "creation_date": 1445525012, "post_id": 33262818, "comment_id": 54367751, "body": "Thanks for all of the help, Matt. I really appreciate it.One thing I did notice was that the subform keeps every past record entered and basically turns into the entire list of meters. When there are new meters to add the Form just adds the new entries to the bottom of the sub-form.I was wondering if there were a way to clear the previous entries and have only the new records appear each time I want to make an entry. I researched recordsets a little bit and wasn&#39;t able to find a concrete explanation/solution so if you could help, that would be very much appreciated. Thanks again!"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1445528120, "post_id": 33262818, "comment_id": 54370108, "body": "Chris, to get around that you can do one of several things. If your rule is that EVERY time you open that form to ADD records, you could use the Form_Open event to find the highest &#39;ID&#39; currently in your table then set your form filter to &#39;[ID] &gt; nnn&#39;"}, {"owner": {"reputation": 23, "user_id": 5411284, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HPfgJYgYx0A/AAAAAAAAAAI/AAAAAAAAAEs/hYE9k3Cz_UY/photo.jpg?sz=128", "display_name": "Chris Rowley", "link": "https://stackoverflow.com/users/5411284/chris-rowley"}, "edited": false, "score": 0, "creation_date": 1445613513, "post_id": 33262818, "comment_id": 54410610, "body": "@MattHall, Everything worked, and your solution is exactly what I was looking for. I was even able to incorporate drop down menus for the standard values to make the form more robust and data entry quicker. As an intern, this is just a side project I picked up on my own because its something I saw that needed fix. Haven&#39;t shown my supervisor any of it yet, he is going to be blown away. Thanks so much for the help!"}, {"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1445614426, "post_id": 33262818, "comment_id": 54411223, "body": "No worries, glad I could help. I&#39;m by no means an expert, but feel free to drop me an email if you want to pick my brains... matthew.richard.hall@gmail.com"}, {"owner": {"reputation": 154, "user_id": 4796154, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad6fe6c93748ebb9612ea4b812d86a79?s=128&d=identicon&r=PG&f=1", "display_name": "MrrMan", "link": "https://stackoverflow.com/users/4796154/mrrman"}, "edited": false, "score": 0, "creation_date": 1537127304, "post_id": 33262818, "comment_id": 91660119, "body": "Old thread i know, but how would i do this if i had a fixed number of rows that needed to be created, and i just needed to modify a &quot;score&quot; field for each?"}], "tags": [], "owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "is_accepted": true, "score": 2, "last_activity_date": 1445592972, "last_edit_date": 1445592972, "creation_date": 1445439838, "answer_id": 33262818, "question_id": 33245849, "link": "https://stackoverflow.com/questions/33245849/create-multiple-records-in-one-form-only-one-field-changes-per-record/33262818#33262818", "title": "Create Multiple Records in One Form. Only One Field Changes per Record", "body": "<p>You could bind a subform to the table that stores your meter records and then have some unbound fields on your main form that allows you to enter the information that would be repeated in your batch of records. You could also put another unbound text box on the main form to specify the number of records you want that will have this repeated information.</p>\n\n<p>So in the mock-up below, you'd specify how many records you want (red box), e.g. 10 records:</p>\n\n<p><a href=\"https://i.stack.imgur.com/pfrbW.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pfrbW.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Then you'd supply the data that would be repeated for these 10 records (blue boxes):</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZeYHU.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZeYHU.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>You'd then click a button that would create the number of records specified with the repeated information given:</p>\n\n<p><a href=\"https://i.stack.imgur.com/2mDtH.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2mDtH.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>It would then just be a case completing the unique serial number for each of the records in the batch you have generated.</p>\n\n<p>Here's the VBA I used on the Add button:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub cmdAddRecords_Click()\n\n    batchAdd Me.txtRecords\n    Me.tblMeters_sub.Requery\n\nEnd Sub\n</code></pre>\n\n<p>...and the <code>batchAdd</code> sub routine it calls:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub batchAdd(records As Integer)\n\n    Dim db As DAO.Database\n    Dim rs As DAO.Recordset\n    Dim i As Integer\n\n    Set db = CurrentDb\n    Set rs = db.OpenRecordset(\"tblMeters\")\n\n    i = 1\n\n    Do While i &lt;= records\n\n        rs.AddNew\n        rs!SerialNumber = \"\"\n        rs!MeterFirmware = Me.MeterFirmware\n        rs!MeterCatalog = Me.MeterCatalog\n        rs!Customer = Me.Customer\n        rs!MeterKh = Me.MeterKh\n        rs!MeterForm = Me.MeterForm\n        rs!MeterType = Me.MeterType\n        rs!MeterVoltage = Me.MeterVoltage\n        rs.Update\n\n        i = i + 1\n\n    Loop\n\n    rs.Close\n    Set rs = Nothing\n    Set db = Nothing\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://drive.google.com/file/d/0B-J5B7nFljZiUHBOd2xtMmFwaVU/view?usp=sharing\" rel=\"nofollow noreferrer\">Here's a link to the mock-up</a> (if you want a closer look).</p>\n\n<p><strong>Update</strong></p>\n\n<p>In response to your query about whether the subform could be filtered so it doesn't just become a big list of all meters, you could add another field to the <em>tblMeters</em> table that will take the date and time that you added records to the table:</p>\n\n<p><a href=\"https://i.stack.imgur.com/pf4Co.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pf4Co.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>You'd then need to add another line to the <code>batchAdd</code> sub that will put the system time and date in this new field:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>...\n\nDo While i &lt;= records\n\n    rs.AddNew\n    rs!SerialNumber = \"\"\n    rs!MeterFirmware = Me.MeterFirmware\n    rs!MeterCatalog = Me.MeterCatalog\n    rs!Customer = Me.Customer\n    rs!MeterKh = Me.MeterKh\n    rs!MeterForm = Me.MeterForm\n    rs!MeterType = Me.MeterType\n    rs!MeterVoltage = Me.MeterVoltage\n    rs!DateAdded = Now                  ' &lt;-- HERE!\n    rs.Update\n\n    i = i + 1\n\nLoop\n\n...\n</code></pre>\n\n<p>You'll then need to change the subform's Record Source property (Design View > select subform > Property Sheet > Data tab > Record Source):</p>\n\n<p><a href=\"https://i.stack.imgur.com/L0ow6.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/L0ow6.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Put the following SQL in there:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT TOP 15 tblMeters.SerialNumber, tblMeters.MeterFirmware, tblMeters.MeterCatalog, \ntblMeters.Customer, tblMeters.MeterType, tblMeters.MeterForm, tblMeters.MeterKh, \ntblMeters.MeterVoltage, tblMeters.DateAdded \nFROM tblMeters \nORDER BY tblMeters.DateAdded DESC;\n</code></pre>\n\n<p>... which will order the records by the date/time field (most recent at the top) and then show only the first 15 of these records. If you want a different number of records change the <code>TOP 15</code> bit to a different number of your choosing.</p>\n\n<p>When you click \"Add\", your new batch of records should be added to the top of the list and the list should stay at a maximum of 15 records (or whatever number you specify in <code>TOP ...</code>)</p>\n\n<p>Be aware that when I was testing this, clicking the \"Add\" button rapidly a few times seemed to cause the sql to not bother with the <code>TOP ...</code> filter, but as long there's like a second or more between each \"Add\" click it seemed to work fine. </p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 23, "user_id": 5411284, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HPfgJYgYx0A/AAAAAAAAAAI/AAAAAAAAAEs/hYE9k3Cz_UY/photo.jpg?sz=128", "display_name": "Chris Rowley", "link": "https://stackoverflow.com/users/5411284/chris-rowley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7400, "favorite_count": 0, "accepted_answer_id": 33262818, "answer_count": 1, "score": 2, "last_activity_date": 1481217260, "creation_date": 1445371464, "question_id": 33245849, "link": "https://stackoverflow.com/questions/33245849/create-multiple-records-in-one-form-only-one-field-changes-per-record", "title": "Create Multiple Records in One Form. Only One Field Changes per Record", "body": "<p>Where I work we receive electronic meters from customers and try to solve the errors they have. We will receive 4-8 meters at a time that all have the same problem, same specs, same everything, the only thing different between each meter is the Serial Number. I want to be able to enter every serial number, and the common specs all in one form to create multiple records. </p>\n\n<p>Here's a pic of what I have for the form. I was able to create records for just one serial number at a time, but I would like to do it all at once to make data entry quicker and easier.</p>\n\n<p><a href=\"http://i.stack.imgur.com/H9HKC.jpg\" rel=\"nofollow\">Meter Entry Form</a></p>\n\n<p>So summary, Multiple Meters, all identical specs, different serial numbers. I want to enter it all into a form and have multiple records created. Thanks for any help or insight you can provide me.</p>\n\n<p>-Chris</p>\n"}, {"tags": ["vba", "email", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1445405801, "creation_date": 1445405801, "answer_id": 33251676, "question_id": 33245423, "link": "https://stackoverflow.com/questions/33245423/outlook-find-email-in-inbox-by-string-part-of-body/33251676#33251676", "title": "Outlook find Email in inbox by string (part of body)", "body": "<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff869662.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">Find</a> method locates and returns a Microsoft Outlook item object that satisfies the given Filter. See <a href=\"https://msdn.microsoft.com/en-us/library/office/ff869374.aspx\" rel=\"nofollow\">Filtering Items Using Query Keywords</a> for more information about possible query strings. After the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff869662.aspx\" rel=\"nofollow\">Find</a> method runs, the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff862482.aspx\" rel=\"nofollow\">FindNext</a> method finds and returns the next Outlook item in the specified collection. For example:</p>\n\n<pre><code> Sub DemoFindNext() \n  Dim myNameSpace As Outlook.NameSpace \n  Dim tdystart As Date \n  Dim tdyend As Date \n  Dim myAppointments As Outlook.Items \n  Dim currentAppointment As Outlook.AppointmentItem \n\n  Set myNameSpace = Application.GetNamespace(\"MAPI\") \n  tdystart = VBA.Format(Now, \"Short Date\") \n  tdyend = VBA.Format(Now + 1, \"Short Date\") \n  Set myAppointments = myNameSpace.GetDefaultFolder(olFolderCalendar).Items \n  Set currentAppointment = myAppointments.Find(\"[Start] &gt;= \"\"\" &amp; tdystart &amp;    \"\"\" and [Start] &lt;= \"\"\" &amp; tdyend &amp; \"\"\"\") \n  While TypeName(currentAppointment) &lt;&gt; \"Nothing\" \n   MsgBox currentAppointment.Subject \n   Set currentAppointment = myAppointments.FindNext \n  Wend \n End Sub\n</code></pre>\n"}], "owner": {"reputation": 373, "user_id": 5016015, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/8db9fd08a36b419616afc14ff5545cb3?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/5016015/volker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 430, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1445405801, "creation_date": 1445369982, "question_id": 33245423, "link": "https://stackoverflow.com/questions/33245423/outlook-find-email-in-inbox-by-string-part-of-body", "title": "Outlook find Email in inbox by string (part of body)", "body": "<p>I simply want to select all mail in my inbox that contain (in Body) a certain string. I thought Find would be a good Approach. Rather to make a for..each on all items in inbox...<br>\nHowever my command does (see below) not work. It brings \"invalid condition\"</p>\n\n<p>Set Msg = Inbox.Items.Find(\"abc\")</p>\n\n<p>2 Questions:<br>\n1. How to fill in the desired condition?<br>\n2. What is result of that find? A single email or a collection I need to put in a variant or so</p>\n"}, {"tags": ["ms-access", "vba", "autosave"], "comments": [{"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 1, "creation_date": 1445391129, "post_id": 33244831, "comment_id": 54300909, "body": "There is no &#39;auto save&#39; option in Access. I have experienced your pain many times, but once you solve the cause of the crash, you are way ahead! I just learned to be excessive in clicking Save and making backup copies each day."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 1, "creation_date": 1445421397, "post_id": 33244831, "comment_id": 54313712, "body": "When you close Access, it asks if you want to save the current changes. Of course, if you click no, they are gone. So click Yes. Or just make it a habit to compile and save whenever you feel for it."}, {"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 1, "creation_date": 1445441106, "post_id": 33244831, "comment_id": 54327705, "body": "If you&#39;re running the kind of code that could potentially crash Access (e.g. looping / recursion / requesting a lot of memory), surely getting in to the habit of saving before running would be a good thing to start doing? Ctrl + S and then F5.. easy-peasy."}, {"owner": {"reputation": 2524, "user_id": 2705042, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/ShRFK.jpg?s=128&g=1", "display_name": "spinjector", "link": "https://stackoverflow.com/users/2705042/spinjector"}, "edited": false, "score": 0, "creation_date": 1519048327, "post_id": 33244831, "comment_id": 84738635, "body": "For a while I was working on VBA code that liked to crash a lot and lose my code. I started to add <code>DoCmd.Save</code> to the beginning of the procedures so the DB saved itself every time the code ran while I was developing it."}], "owner": {"reputation": 520, "user_id": 2253067, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zQzsZ.jpg?s=128&g=1", "display_name": "Martin F", "link": "https://stackoverflow.com/users/2253067/martin-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 500, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594643429, "creation_date": 1445367853, "last_edit_date": 1594643429, "question_id": 33244831, "link": "https://stackoverflow.com/questions/33244831/how-to-get-access-to-auto-save-my-vba-code-changes", "title": "How to get Access to auto save my VBA code changes", "body": "<p>I'm fed up with Access crashing after I've written and run some code and forgot to manually save it and hence all the new code is gone. How can I get Access to automatically save my VBA code upon, say, compile or run? I don't see any settings in VBA and I don't see any answers to a Google search. (Also, I don't think I've faced this problem in any other IDE.)</p>\n"}, {"tags": ["excel", "vba", "sendkeys", "formula-editor"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1445369120, "post_id": 33244813, "comment_id": 54292543, "body": "can you post the code so we have a better idea of what you are trying to accomplish? Also, all the user has to do is physically moves his eyes up into the formula bar, correct? Or am I missing something?"}, {"owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1445372141, "post_id": 33244813, "comment_id": 54294249, "body": "I edited the post to make things clearer hopefully. Line 2621, second column is where the macro drops the user. Right now the send key lets the user change the value in the cell but not allow them to makes changes from the formula bar. On more then one occasion people have said they wanted this feature. I&#39;d like to just say no, everything is fine as is, but I figured I&#39;d give it a shot. Maybe there&#39;s some magic that can help get them to the formula bar"}], "answers": [{"comments": [{"owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "edited": false, "score": 0, "creation_date": 1445372553, "post_id": 33245478, "comment_id": 54294458, "body": "I will test this this afternoon and see if this doesn&#39;t affect the 4 columns that the user can use for inputs"}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 3, "last_activity_date": 1445370501, "last_edit_date": 1445370501, "creation_date": 1445370134, "answer_id": 33245478, "question_id": 33244813, "link": "https://stackoverflow.com/questions/33244813/excel-2010-vba-send-keys-to-simulate-clicking-the-formula-bar/33245478#33245478", "title": "excel 2010 vba send keys to simulate clicking the formula bar", "body": "<p>I don't believe there is a single keypress to \"activate\" the formula bar. There is probably a way to do with multiple keypress events like <code>&lt;alt&gt;&lt;tab&gt;&lt;tab&gt;...~nine years later and a couple of other keys~...&lt;tab&gt;&lt;tab&gt;</code> </p>\n\n<p>The quicker and more direct way would be to turn off the \"EditDirectlyInCell\" setting:</p>\n\n<pre><code>Application.EditDirectlyInCell = False\n</code></pre>\n\n<p>This will bring the cursor to the formula bar when you sendkey <code>F2</code></p>\n\n<p>You could just turn this thing off on <code>Workbook_Open()</code> in the workbook's code:</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Application.EditDirectlyInCell = False\nEnd Sub\n</code></pre>\n\n<p>Perhaps on <code>Workbook_BeforeClose()</code> you could toggle that setting back on so you don't change their defaults:</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n    Application.EditDirectlyInCell = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 13832604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d127c31ee8f8e5e5c457ea258f4cd5d?s=128&d=identicon&r=PG&f=1", "display_name": "Sindula", "link": "https://stackoverflow.com/users/13832604/sindula"}, "is_accepted": false, "score": 1, "last_activity_date": 1593413910, "creation_date": 1593413910, "answer_id": 62632778, "question_id": 33244813, "link": "https://stackoverflow.com/questions/33244813/excel-2010-vba-send-keys-to-simulate-clicking-the-formula-bar/62632778#62632778", "title": "excel 2010 vba send keys to simulate clicking the formula bar", "body": "<p>maybe this will help, i set the <strong>Application.EditDirectlyInCell</strong> to false, before entering <em>cell editing</em>, then call <strong>DoEvents</strong> before returning EditDirectlyInCell to true</p>\n<pre><code>Sub EditRange(ByVal Target As Range)          'so any change in target would not affect\n                                              'the caller's variable\n\n    Set Target = Target.Areas(1).Resize(1, 1) 'to make sure the target is single cell\n\n    Target.Worksheet.Activate                 'to make sure the worksheet is active\n\n    Target.Activate                           'activate the designated cell\n\n    Application.EditDirectlyInCell = False    'turn cell editing to false, any attempt _\n                                               to edit cell will be done in formula bar\n\n    SendKeys &quot;{F2}&quot;                           'send F2 to start editing the cell\n\n    DoEvents                                  'make sure every command is fully executed\n\n    Application.EditDirectlyInCell = True     'return in cell editing to default value\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2238, "favorite_count": 0, "accepted_answer_id": 33245478, "answer_count": 2, "score": 0, "last_activity_date": 1593457934, "creation_date": 1445367821, "last_edit_date": 1593457934, "question_id": 33244813, "link": "https://stackoverflow.com/questions/33244813/excel-2010-vba-send-keys-to-simulate-clicking-the-formula-bar", "title": "excel 2010 vba send keys to simulate clicking the formula bar", "body": "<p>Google hasn't given me quite what I want, I thought maybe SO might have the answer. </p>\n\n<p>Instead of using a input box or user prompt that asks the user for info that will be stored in cell, I'm looking for some code to simulate clicking in the formula bar. I am currently using sendkeys method with \"F2\" to allow the user to enter info into the selected cell. It would be much easier to look into the formula bar, instead of a single cell in a sea of data. </p>\n\n<pre><code>Sub CopyTemplate()\n\n'ActiveWorkbook.Save\nWorksheets(\"HR-Cal\").Activate\nDim rng As Range\nDim trng As Range\nDim tco As String\n'Use the InputBox select row to insert copied cells\nSet rng = Application.InputBox(\"select row to paste into\", \"Insert template location\", Default:=ActiveCell.Address, Type:=8)\nIf rep = vbCancel Then\nEnd If\n\nstartrow = rng.Row\n'  MsgBox \"row =\" &amp; startrow\nRange(\"AG2\") = startrow\n\nApplication.ScreenUpdating = False\n\n'copy template block\nRange(\"C6\").End(xlDown).Select\nRange(\"AG1\") = ActiveCell.Row\n\ntco = \"A5:AN\" &amp; Range(\"AG1\")\nRange(tco).Select\nSelection.Copy\n\nRange(\"A\" &amp; Range(\"AG2\")).Activate\nSelection.Insert Shift:=xlDown\n\nRange(\"c100000\").End(xlUp).Select\nSelection.End(xlUp).Select\n'select first value\n\nRange(\"AG1:AG2\").ClearContents\n\nApplication.ScreenUpdating = True\n\nSendKeys \"{F2}\"\nSendKeys \"{BS}\"\n\nEnd Sub\n</code></pre>\n\n<p>when the codes runs this is what the user sees (col 2 col 2621)<a href=\"https://i.stack.imgur.com/2swZ5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2swZ5.png\" alt=\"enter image description here\"></a></p>\n"}]