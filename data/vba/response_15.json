[{"tags": ["python", "excel", "vba", "xlsm", "xlwings"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4821805, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Z3h9NQTfxy8/AAAAAAAAAAI/AAAAAAAAABk/e3yg5XbyvNM/photo.jpg?sz=128", "display_name": "BPT", "link": "https://stackoverflow.com/users/4821805/bpt"}, "edited": false, "score": 0, "creation_date": 1429791871, "post_id": 29820048, "comment_id": 47772882, "body": "Yes, it does indeed work with .xlsm files. However, I was trying to use the defined template files (.xltm). Apparently the default behavior of Excel, on opening a template file, is to set the &quot;save&quot; method to .xlsx (instead of .xlsm). So, opening a template (.xltm) prevents saving as a macro enabled file (.xlsm). The workaround is to not use a template file (easy enough, but not very general). Since this is a behavior of the win32com.client interface to Excel, and not xlwings itself, I&#39;ll look there for the right approach. Adding the check to xlwings looks very easy to do."}, {"owner": {"reputation": 5157, "user_id": 918626, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d8c377a6e6f8a5a6910bb62f51c6f853?s=128&d=identicon&r=PG", "display_name": "Felix Zumstein", "link": "https://stackoverflow.com/users/918626/felix-zumstein"}, "reply_to_user": {"reputation": 1, "user_id": 4821805, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Z3h9NQTfxy8/AAAAAAAAAAI/AAAAAAAAABk/e3yg5XbyvNM/photo.jpg?sz=128", "display_name": "BPT", "link": "https://stackoverflow.com/users/4821805/bpt"}, "edited": false, "score": 0, "creation_date": 1429792669, "post_id": 29820048, "comment_id": 47773571, "body": "ah - sorry - missed that &quot;t&quot;."}, {"owner": {"reputation": 5157, "user_id": 918626, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d8c377a6e6f8a5a6910bb62f51c6f853?s=128&d=identicon&r=PG", "display_name": "Felix Zumstein", "link": "https://stackoverflow.com/users/918626/felix-zumstein"}, "reply_to_user": {"reputation": 1, "user_id": 4821805, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Z3h9NQTfxy8/AAAAAAAAAAI/AAAAAAAAABk/e3yg5XbyvNM/photo.jpg?sz=128", "display_name": "BPT", "link": "https://stackoverflow.com/users/4821805/bpt"}, "edited": false, "score": 0, "creation_date": 1429792772, "post_id": 29820048, "comment_id": 47773665, "body": "Have a look here (this should be added to xlwings, too): <a href=\"http://stackoverflow.com/questions/21306275/pywin32-saving-as-xlsm-file-instead-of-xlsx\" title=\"pywin32 saving as xlsm file instead of xlsx\">stackoverflow.com/questions/21306275/&hellip;</a>"}], "tags": [], "owner": {"reputation": 5157, "user_id": 918626, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d8c377a6e6f8a5a6910bb62f51c6f853?s=128&d=identicon&r=PG", "display_name": "Felix Zumstein", "link": "https://stackoverflow.com/users/918626/felix-zumstein"}, "is_accepted": false, "score": 1, "last_activity_date": 1429783181, "creation_date": 1429783181, "answer_id": 29820048, "question_id": 29811116, "link": "https://stackoverflow.com/questions/29811116/xlwings-does-not-support-writing-of-xlsm-files/29820048#29820048", "title": "&quot;xlwings&quot; : does not support writing of .xlsm files?", "body": "<p>What are you trying to do with <code>xl_workbook.SaveAs(path)</code>?</p>\n\n<p>The following works:</p>\n\n<pre><code>&gt;&gt;&gt; from xlwings import Workbook\n&gt;&gt;&gt; wb = Workbook(r'C:\\full\\path\\to\\file.xlsm')\n&gt;&gt;&gt; wb.save('new_name.xlsm')\n</code></pre>\n\n<p>Without specifying a full name when saving, it'll currently (v0.3.4) save it in the default Excel directory, which probably should be improved to be the current Python working directory to be in line with what it does with a new file.</p>\n\n<p>Note that after saving a Workbook under a new name, <code>wb</code> above still refers to the old file and so <code>wb.close()</code> will have no effect on the new file. This should also be improved so that <code>Workbook.save()</code> returns the new Workbook object. I'll open issues on the GitHub page to cover these improvements.</p>\n"}], "owner": {"reputation": 1, "user_id": 4821805, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Z3h9NQTfxy8/AAAAAAAAAAI/AAAAAAAAABk/e3yg5XbyvNM/photo.jpg?sz=128", "display_name": "BPT", "link": "https://stackoverflow.com/users/4821805/bpt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2740, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429783181, "creation_date": 1429747162, "last_edit_date": 1429747624, "question_id": 29811116, "link": "https://stackoverflow.com/questions/29811116/xlwings-does-not-support-writing-of-xlsm-files", "title": "&quot;xlwings&quot; : does not support writing of .xlsm files?", "body": "<p>I've tried a simple test using \"xlwings_0.3.4\" to open an excel .xltm file and save it again, to make sure that the VBA modules are kept. I couldn't get it to work.</p>\n\n<p>If I give a file extension in the save step, the file is saved as an .xlsx file. The module is carried along, but with the extension change it isn't recognized as a valid VBA module. If I do not specify a file extension, it is automatically saved as .xlsx:</p>\n\n<pre><code>WB=xlwings.Workbook('template.xltm')\nWB.save('outfile')\nWB.close()\n</code></pre>\n\n<p>This gives an xlsx file.</p>\n\n<p>Trying to set the file to xlsm generates an error:</p>\n\n<pre><code>WB.save('outfile.xlsm')\nWB.close()\nxl_workbook.SaveAs(path)\n</code></pre>\n\n<p>will generate an error:</p>\n\n<pre><code>xl_workbook.SaveAs(path)\nFile \"&lt;COMObject Open&gt;\", line 7, in SaveAs\npywintypes.com_error: (-2147352567, 'Exception occurred.', (0, u'Microsoft          Excel', u'This extension can not be used with the selected file type. Change the   file extension in the File name text box or select a different file type by changing the Save as type.', u'xlmain11.chm', 0, -2146827284), None)\n</code></pre>\n\n<p>This seems to be inherent to the application object returned by <code>GetActiveObject('Excel.Application')</code>.</p>\n\n<p>Is there a switch (like the <code>'keep_VBA=True'</code> switch in openpyxl?), or is it not possible to save xlsm files with xlwings?</p>\n"}, {"tags": ["excel", "vba", "embed", "powerpoint", "add-in"], "answers": [{"comments": [{"owner": {"reputation": 1071, "user_id": 1093111, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/42808d0742af6ac66f05e593b1e06067?s=128&d=identicon&r=PG", "display_name": "user1093111", "link": "https://stackoverflow.com/users/1093111/user1093111"}, "edited": false, "score": 0, "creation_date": 1429746095, "post_id": 29810916, "comment_id": 47749751, "body": "I guess so. Just trying to avoid leaving the presentation"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1429750852, "post_id": 29810916, "comment_id": 47751286, "body": "Insert the Excel document as an object, then give it an Action Setting of Object Action:  Open or Edit (try both, see which suits your PPT version and tastes best).  Here, either one opens the document in Excel atop the presentation window; no need to bounce out and open Excel or make sure it&#39;s open first so you can Alt Tab to it (bows to Ingeborg ... Hiya, ma&#39;am!)"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1429753196, "post_id": 29810916, "comment_id": 47752019, "body": "@SteveRindsberg, Hiya back. You should post that as an answer, so I can upvote it."}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1429746022, "creation_date": 1429746022, "answer_id": 29810916, "question_id": 29810789, "link": "https://stackoverflow.com/questions/29810789/interactive-excel-worksheet-in-powerpoint/29810916#29810916", "title": "Interactive Excel worksheet in PowerPoint", "body": "<p>You can embed an Excel object into a PowerPoint slide and edit the Excel cells in PowerPoint when designing the slide, but not when running the presentation.</p>\n\n<p>An open Excel file is just one <kbd>Alt</kbd>-<kbd>Tab</kbd> away. Why make things more complicated than they need to be. </p>\n"}, {"tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1429805475, "creation_date": 1429805475, "answer_id": 29828975, "question_id": 29810789, "link": "https://stackoverflow.com/questions/29810789/interactive-excel-worksheet-in-powerpoint/29828975#29828975", "title": "Interactive Excel worksheet in PowerPoint", "body": "<p>Insert the Excel document as an object:</p>\n\n<p>Insert | Object | Create From File and browse to the file you want to insert.</p>\n\n<p>While it's selected, give it an Action Setting:</p>\n\n<p>Insert | Links | Action</p>\n\n<p>In the dialog box that appears, choose Object Action: Open or Edit</p>\n\n<p>Try both, see which suits your PPT version and tastes best. Here, either one opens the document in Excel atop the presentation window; no need to bounce out and open Excel or make sure it's open first.</p>\n"}], "owner": {"reputation": 1071, "user_id": 1093111, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/42808d0742af6ac66f05e593b1e06067?s=128&d=identicon&r=PG", "display_name": "user1093111", "link": "https://stackoverflow.com/users/1093111/user1093111"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1311, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1429805475, "creation_date": 1429745343, "last_edit_date": 1429746493, "question_id": 29810789, "link": "https://stackoverflow.com/questions/29810789/interactive-excel-worksheet-in-powerpoint", "title": "Interactive Excel worksheet in PowerPoint", "body": "<p>I'm wondering if there is a solution to add an interactive Excel worksheet into a PowerPoint slide.  The idea would be to explain a model without having to move to Excel.  The table would not have to update or save, just present the current data. It could even be pasted in.</p>\n\n<p>It might look like:</p>\n\n<p><img src=\"https://i.stack.imgur.com/Xk3J5.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["sql", "vba"], "comments": [{"owner": {"reputation": 60275, "user_id": 1073631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12b7f78513c544111980c6308b25a4ed?s=128&d=identicon&r=PG", "display_name": "sgeddes", "link": "https://stackoverflow.com/users/1073631/sgeddes"}, "edited": false, "score": 1, "creation_date": 1429741762, "post_id": 29810077, "comment_id": 47748175, "body": "What data type is <code>TRXHRUNT</code> -- are you attempting to <code>sum</code> a <code>varchar</code>?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1429746976, "post_id": 29810077, "comment_id": 47750035, "body": "and how does &quot;Rack build&quot; factor in here?"}, {"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 0, "creation_date": 1429750671, "post_id": 29810077, "comment_id": 47751222, "body": "Either <code>TRXHRUNT</code> or <code>TRXDSCRN</code> has a value of <code>&#39;Rack build&#39;</code> for one of the records."}], "answers": [{"tags": [], "owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "is_accepted": false, "score": 1, "last_activity_date": 1429752321, "last_edit_date": 1429752321, "creation_date": 1429751930, "answer_id": 29811898, "question_id": 29810077, "link": "https://stackoverflow.com/questions/29810077/vba-adodb-commandstring-error/29811898#29811898", "title": "VBA ADODB CommandString Error", "body": "<p>If CallNumber.Value is really an int, then one of your records has a value of 'Rack build' for <code>TRXDSCRN</code>.</p>\n\n<p>Try this select:</p>\n\n\n\n<pre><code>SELECT * FROM CTI_Timetrack_Open_and_Closed WHERE TRXDSCRN = 'Rack build';\n</code></pre>\n\n<p>If there are actually integer values in that column, and you really do want to search for an integer there, you will need to pass it as a string by adding single quotes around <code>CallNumber.Value</code>:</p>\n\n<pre><code>cmdString.CommandText = \"SELECT SUM(TRXHRUNT)/100 from CTI_Timetrack_Open_and_Closed where TRXDSCRN = '\" &amp; CallNumber.Value &amp; \"'\"\n</code></pre>\n\n<p><a href=\"https://xkcd.com/327/\" rel=\"nofollow\">You really should be using command parameters though</a> to pass the <code>CallNumber.Value</code> in. Otherwise somebody could wreak havoc on your database by passing the following string in for the CallNumber (if it accepts strings):</p>\n\n<pre><code>'; DELETE FROM CTI_Timetrack_Open_and_Closed;--close command with comment\n</code></pre>\n\n<p>You can use parameters to solve that <a href=\"http://en.wikipedia.org/wiki/SQL_injection\" rel=\"nofollow\">SQL injection</a> and others using this:</p>\n\n<pre><code>cmdString.CommandText = \"SELECT SUM(TRXHRUNT)/100 from CTI_Timetrack_Open_and_Closed where TRXDSCRN = ?\";\n\nDim Pm As ADODB.Parameter\nSet Pm = cmdString.CreateParameter(\"parentid\", adNumeric, adParamInput)\nPm.Value = CallNumber.Value\ncmdstring.Parameters.Append Pm\n</code></pre>\n\n<p>I know that <code>TRXHRUNT</code> is not the problem, because if you try to sum on a <code>varchar</code>, you get the following error:</p>\n\n<blockquote>\n  <p>Msg 8117, Level 16, State 1, Line 2</p>\n  \n  <p>Operand data type varchar is invalid for sum operator.</p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 4718208, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BUPHiCd1F20/AAAAAAAAAAI/AAAAAAAAAFY/XBWhE_ndG4c/photo.jpg?sz=128", "display_name": "Lavell Lovett", "link": "https://stackoverflow.com/users/4718208/lavell-lovett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429752321, "creation_date": 1429741675, "last_edit_date": 1429741935, "question_id": 29810077, "link": "https://stackoverflow.com/questions/29810077/vba-adodb-commandstring-error", "title": "VBA ADODB CommandString Error", "body": "<p>So I've got an interesting problem. I'm working with VB modifier (VBA) in Microsoft GP2013, and all I want to do is reference a table in one of our databases, grabbing total amount of call hours based on the service call number (job number) entered. To do so, I have opened an SQL connection, with an SQL command to do so. The problem is, I consistently get conversion errors regardless of how I convert the data coming in, and the data the SQL command is referencing. Here is the error I get:</p>\n\n<blockquote>\n  <p>Conversion failed when converting the varchar value 'Rack build' to data type int. </p>\n</blockquote>\n\n<p>Here is the command string:</p>\n\n<pre><code>cmdString.CommandText = \"SELECT SUM(TRXHRUNT)/100 from CTI_Timetrack_Open_and_Closed where TRXDSCRN = \" &amp; CallNumber.Value &amp; \"\"\n</code></pre>\n\n<p>Where <code>CallNumber.Value</code> is an integer being populated by our form. I've wrapped my head around this all day, and the answer is probably very simple. I am looking for any advice to alleviate this error. Thanks. </p>\n"}, {"tags": ["excel", "vba", "function", "execution", "skip"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1429741490, "post_id": 29809944, "comment_id": 47748060, "body": "Sorry but your problem is not reproducible. When I run your sub, I get inside the function without problems. Could you please add a reproducible test case?"}, {"owner": {"reputation": 14691, "user_id": 3098818, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/f5a94273c00a346b63559ab9da92925f?s=128&d=identicon&r=PG&f=1", "display_name": "yoshiserry", "link": "https://stackoverflow.com/users/3098818/yoshiserry"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1429743913, "post_id": 29809944, "comment_id": 47748973, "body": "I&#39;ve tried putting just a string in the function when I call it, so there is a value in place of sheet name. Neither works. It just skips over the function. I can&#39;t provide an example workbook."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1429744460, "post_id": 29809944, "comment_id": 47749172, "body": "If you cannot provide a reproducible example, I think you cannot get much help here because your code is supposed to work as you expect, and this is what it actually does on my computer. So either is a problem of your machine (try into another one), or you&#39;re omitting relevant part of code."}], "answers": [{"comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1429744361, "post_id": 29810321, "comment_id": 47749140, "body": "<code>sheet_name</code> is declared as string, which means it has a defalut value of <code>&quot;&quot;</code> since compilation. Even if not assigned, there&#39;s no reason why it shouldn&#39;t get into the function (indeed, the code above runs straight in my computer)."}, {"owner": {"reputation": 14691, "user_id": 3098818, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/f5a94273c00a346b63559ab9da92925f?s=128&d=identicon&r=PG&f=1", "display_name": "yoshiserry", "link": "https://stackoverflow.com/users/3098818/yoshiserry"}, "edited": false, "score": 0, "creation_date": 1429745138, "post_id": 29810321, "comment_id": 47749407, "body": "I agree I see no reason why execution shouldn&#39;t move inside the function I am stumped."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 14691, "user_id": 3098818, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/f5a94273c00a346b63559ab9da92925f?s=128&d=identicon&r=PG&f=1", "display_name": "yoshiserry", "link": "https://stackoverflow.com/users/3098818/yoshiserry"}, "edited": false, "score": 0, "creation_date": 1429749182, "post_id": 29810321, "comment_id": 47750789, "body": "@yoshiserry  Are both the <i>Sub</i> and the <i>function</i> in the same standard module ??"}, {"owner": {"reputation": 14691, "user_id": 3098818, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/f5a94273c00a346b63559ab9da92925f?s=128&d=identicon&r=PG&f=1", "display_name": "yoshiserry", "link": "https://stackoverflow.com/users/3098818/yoshiserry"}, "edited": false, "score": 0, "creation_date": 1429751551, "post_id": 29810321, "comment_id": 47751509, "body": "they are actually all these functions, subs are inside a module which I get to by clicking on my import_form which I created. Is there a limit to the number of functions or procedures you can write when the functions subs are inside a module from a userform?"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1429742847, "creation_date": 1429742847, "answer_id": 29810321, "question_id": 29809944, "link": "https://stackoverflow.com/questions/29809944/when-code-is-executed-execution-wont-move-inside-a-excel-vba-function/29810321#29810321", "title": "when code is executed execution won&#39;t move inside a excel vba function", "body": "<p>Put a value in sheet_name and try again.</p>\n"}, {"tags": [], "owner": {"reputation": 14691, "user_id": 3098818, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/f5a94273c00a346b63559ab9da92925f?s=128&d=identicon&r=PG&f=1", "display_name": "yoshiserry", "link": "https://stackoverflow.com/users/3098818/yoshiserry"}, "is_accepted": false, "score": 0, "last_activity_date": 1429833040, "creation_date": 1429833040, "answer_id": 29836352, "question_id": 29809944, "link": "https://stackoverflow.com/questions/29809944/when-code-is-executed-execution-wont-move-inside-a-excel-vba-function/29836352#29836352", "title": "when code is executed execution won&#39;t move inside a excel vba function", "body": "<p>What caused some functions to stop working (and execution of code to not reach the function definition or move inside it) was unloading the form. </p>\n\n<p>All the functions and sub procedures were defined in a module which is part of the form. </p>\n\n<p>Therefore you can only access this module by clicking on the controls on the form.</p>\n\n<p>This meant that I only had one folder FORMS - which had one form inside it, and didn't have a Modules Folder which would normally appear in the VBA Project section.</p>\n\n<p>Therefore I can either:\n1) wait until all the data processing has been done before unloading the form right at the last minute </p>\n\n<p>or </p>\n\n<p>2) move the functions to a new module (External to the Form in the MODULES folder) so when the fuctions and sub procedures are called they don't rely on the form being open.</p>\n"}], "owner": {"reputation": 14691, "user_id": 3098818, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/f5a94273c00a346b63559ab9da92925f?s=128&d=identicon&r=PG&f=1", "display_name": "yoshiserry", "link": "https://stackoverflow.com/users/3098818/yoshiserry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 315, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1429833040, "creation_date": 1429741084, "question_id": 29809944, "link": "https://stackoverflow.com/questions/29809944/when-code-is-executed-execution-wont-move-inside-a-excel-vba-function", "title": "when code is executed execution won&#39;t move inside a excel vba function", "body": "<p>For VBA functions and most programming in general i understand general program execution to occur something like this...</p>\n\n<p>Inside a sub procedure if you call a function (it should return a value), in this case it would return a value to variable num.</p>\n\n<p>To expand this means that execution reaches the line where I call the function, and should then skip down to where the function is written, and go through executing each line inside that function.</p>\n\n<p>This is how it has worked for me previously when I use the F8 key to highlight and follow the code execution line by line. </p>\n\n<p><strong>The problem</strong>\nThe problem is when execution reaches the line inside the sub procedure where the function is called the function is just skipped over and execution doesn't go inside the function and run each line inside it.</p>\n\n<p>(and I should say when this happened I had 95% of a working program, and i've tried re-writing the function, calling other functions).</p>\n\n<p>But whenever a function is called execution of the code doesn't go into the function itself it just skips over it, and the variable that holds the result of the function therefore is left empty.</p>\n\n<p>I've tried creating breakpoints at the beginning of the function and when the function is called in the sub procedure however this hasn't worked.</p>\n\n<p>At the very least execution should get to the definition of the function (Function FirstRow() etc) and throw and error but it's not doing that.</p>\n\n<pre><code>Sub Main\n\n    Dim num as double\n\n    Dim sheet_name as string\n\n    num = FirstRow(sheet_name)\n\nEnd Sub\n\nFunction FirstRow(sheet as string) as double\n\n    select case sheet '&lt;&lt;----- execution never gets inside the function\n\n    case \"sheet\"\n        FirstRow = 8\n    case \"sheet2\"\n        FirstRow = 12\n\n    end select\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 783742, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/XdhlD.jpg?s=128&g=1", "display_name": "luskbo", "link": "https://stackoverflow.com/users/783742/luskbo"}, "edited": false, "score": 0, "creation_date": 1429743755, "post_id": 29810302, "comment_id": 47748921, "body": "Thanks for the comment. Again, I tried the Outlook.Folder type and received the same error. I just tried the Object type as I couldn&#39;t think of anything else.  I just need to get access to the Parent of inbox, so I can get a folder on the same level as the inbox."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 155, "user_id": 783742, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/XdhlD.jpg?s=128&g=1", "display_name": "luskbo", "link": "https://stackoverflow.com/users/783742/luskbo"}, "edited": false, "score": 0, "creation_date": 1429744255, "post_id": 29810302, "comment_id": 47749101, "body": "objInbox.Parent.Folders(&quot;Any folder name&quot;)"}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1429742755, "creation_date": 1429742755, "answer_id": 29810302, "question_id": 29809850, "link": "https://stackoverflow.com/questions/29809850/outlook-vba-2013-access-parent-folders/29810302#29810302", "title": "Outlook VBA 2013 Access Parent Folders", "body": "<p>The following code will not work. </p>\n\n<pre><code> strFolderName = objInbox.Folders.Parent()\n</code></pre>\n\n<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff860950.aspx\" rel=\"nofollow\">Folders</a> collection does't provide the Parent method.</p>\n\n<pre><code> objMailbox = iNameSpace.Folders(strFolderName)\n</code></pre>\n\n<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff864011.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">Folders</a> property doesn't accept an object arguments.</p>\n"}, {"comments": [{"owner": {"reputation": 155, "user_id": 783742, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/XdhlD.jpg?s=128&g=1", "display_name": "luskbo", "link": "https://stackoverflow.com/users/783742/luskbo"}, "edited": false, "score": 1, "creation_date": 1429748519, "post_id": 29810622, "comment_id": 47750563, "body": "Thank! This finally worked. <code>Const olFolderInbox = 6         objMailbox = iNameSpace.GetDefaultFolder(olFolderInbox).Parent()         objFolder = objMailbox.Folders.Item(&quot;Europe&quot;)</code>"}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1429744423, "creation_date": 1429744423, "answer_id": 29810622, "question_id": 29809850, "link": "https://stackoverflow.com/questions/29809850/outlook-vba-2013-access-parent-folders/29810622#29810622", "title": "Outlook VBA 2013 Access Parent Folders", "body": "<p>To access the parent of the Inbox folder, try <code>iNameSpace.GetDefaultFolder(olFolderInbox).Parent</code></p>\n\n<p>To access a folder on the same level as the Inbox, try <code>iNameSpace.GetDefaultFolder(olFolderInbox).Parent.Folders.Item(\"The Folder name\")</code></p>\n"}], "owner": {"reputation": 155, "user_id": 783742, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/XdhlD.jpg?s=128&g=1", "display_name": "luskbo", "link": "https://stackoverflow.com/users/783742/luskbo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1358, "favorite_count": 0, "accepted_answer_id": 29810622, "answer_count": 2, "score": 0, "last_activity_date": 1429744423, "creation_date": 1429740680, "question_id": 29809850, "link": "https://stackoverflow.com/questions/29809850/outlook-vba-2013-access-parent-folders", "title": "Outlook VBA 2013 Access Parent Folders", "body": "<p>Okay, I was reading a tutorial on how to access parent folders outside of the Inbox and noticed that it was using \"Set\". To my knowledge, this command is deprecated and seems so whenever I have tried to use it in my code.</p>\n\n<p><a href=\"http://blogs.technet.com/b/heyscriptingguy/archive/2006/08/03/how-can-i-get-access-to-a-mail-folder-that-isn-t-a-subfolder-of-my-outlook-inbox.aspx\" rel=\"nofollow\">http://blogs.technet.com/b/heyscriptingguy/archive/2006/08/03/how-can-i-get-access-to-a-mail-folder-that-isn-t-a-subfolder-of-my-outlook-inbox.aspx</a></p>\n\n<pre><code>    ' Set Outlook parameters\n    objOutlook = CreateObject(\"Outlook.Application\")\n    iNameSpace = myOlApp.GetNamespace(\"MAPI\")                       ' Set current NameSpace\n    Dim oExp As Outlook.Explorer\n    Dim oSel As Outlook.Selection\n    oExp = objOutlook.ActiveExplorer\n    oSel = oExp.Selection\n    Dim strFolderName As Object\n    Dim objInbox As Outlook.Folder\n    Dim objMailbox As Outlook.Folder\n    Dim objFolder As Outlook.Folder\n\n\n    Const olFolderInbox = 6\n    objInbox = iNameSpace.GetDefaultFolder(olFolderInbox)\n    strFolderName = objInbox.Folders.Parent()\n    objMailbox = iNameSpace.Folders(strFolderName)\n    objFolder = objMailbox.Folders(\"Europe\")\n</code></pre>\n\n<p>When trying the code above, I get a type error: Additional information: Type mismatch, on this line:</p>\n\n<pre><code>    objMailbox = iNameSpace.Folders(strFolderName)\n</code></pre>\n\n<p>When I change this to an \"Object\", I get the same error.</p>\n\n<p>Any Idea what I am doing wrong?</p>\n"}, {"tags": ["excel", "vba", "outlook", "task", "paste"], "answers": [{"comments": [{"owner": {"reputation": 313, "user_id": 4785983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153768040479638/picture?type=large", "display_name": "Andres Felipe Martinez", "link": "https://stackoverflow.com/users/4785983/andres-felipe-martinez"}, "edited": false, "score": 0, "creation_date": 1429881888, "post_id": 29823377, "comment_id": 47823268, "body": "Thanks for the answer. Unfortunately, after reading and trying, I was unable to make it work. I guess I don&#39;t have enough knowledge. Thanks for the info."}, {"owner": {"reputation": 313, "user_id": 4785983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153768040479638/picture?type=large", "display_name": "Andres Felipe Martinez", "link": "https://stackoverflow.com/users/4785983/andres-felipe-martinez"}, "edited": false, "score": 0, "creation_date": 1434041773, "post_id": 29823377, "comment_id": 49623538, "body": "Marking it as solved, because after trying for months, this was the solution. Thanks a lot."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": true, "score": 1, "last_activity_date": 1429791786, "creation_date": 1429791786, "answer_id": 29823377, "question_id": 29809721, "link": "https://stackoverflow.com/questions/29809721/paste-formatted-excel-range-into-outlook-task/29823377#29823377", "title": "Paste formatted Excel range into Outlook task", "body": "<p>Outlook uses Word as an email editor. You can use the Word object model for making manipulatins on the message body. The WordEditor property of the Inspector class returns an instance of the Document class (from the Word object model) which represents the body. You can read more about that way and all possible ways in the <a href=\"http://msdn.microsoft.com/en-us/library/dd492012.aspx\" rel=\"nofollow\">Chapter 17: Working with Item Bodies</a>. </p>\n\n<p>That way you can use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837760(v=office.15).aspx\" rel=\"nofollow\">Copy</a> method of the Range class to copy the range to the Clipboard. Then you can use the Paste method from the Word object model to paste data into the document which represents the message body.</p>\n"}], "owner": {"reputation": 313, "user_id": 4785983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153768040479638/picture?type=large", "display_name": "Andres Felipe Martinez", "link": "https://stackoverflow.com/users/4785983/andres-felipe-martinez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1017, "favorite_count": 0, "accepted_answer_id": 29823377, "answer_count": 1, "score": 0, "last_activity_date": 1429791786, "creation_date": 1429740140, "last_edit_date": 1429743660, "question_id": 29809721, "link": "https://stackoverflow.com/questions/29809721/paste-formatted-excel-range-into-outlook-task", "title": "Paste formatted Excel range into Outlook task", "body": "<p>I've been trying to create a sub that would take some information from an Excel selection and create a new task on Outlook. The body of the task should feature the comment from the first cell (which it already does) but before all that I want to paste the range as it looks in Excel, then the comment, and then again, the range.  </p>\n\n<p><img src=\"https://i.stack.imgur.com/RNpmk.jpg\" alt=\"http://i.imgur.com/WW77xgs.jpg\"></p>\n\n<p>Here's my code:</p>\n\n<pre><code>Sub CreateReminder()\n\nDim olApp As Object\nDim olRem As Object\nDim myRange As Range\nDim contact As String\nDim company As String\nDim city As String\nDim state As String\nDim cmt As comment\nDim comment As String\nDim strdate As Date\nDim remdate As Date\n\nSet olApp = CreateObject(\"Outlook.Application\")\nSet olRem = olApp.CreateItem(3)\n\nSet myRange = Selection\n\n\nIf ActiveCell.comment Is Nothing Then\n    Exit Sub\nElse\n    Set cmt = ActiveCell.comment\nEnd If\ncompany = myRange.Columns(1).Text\ncontact = myRange.Columns(2).Text\nIf InStr(contact, \"/\") &lt;&gt; 0 Then\ncontact = Left(contact, InStr(contact, \"/\") - 1)\nEnd If\ncity = myRange.Columns(7).Text\nstate = myRange.Columns(8).Text\nmyRange.Copy\ncomment = cmt.Text\nstrdate = Date\nremdate = Format(Now)\n\nrangeaddress = myRange.Address\nwrksheetname = ActiveSheet.Name\n\nWith olRem\n\n.Subject = \"Call \" &amp; contact &amp; \" - \" &amp; company &amp; \" - \" &amp; city &amp; \", \" &amp; state\n.display\n SendKeys \"{TAB 9}\"\n SendKeys \"^{v}\"\n .body = Chr(10) &amp; comment &amp; Chr(10)\n '.startdate = strdate\n '.remindertime = remdate\n '.reminderset = True\n '.showcategoriesdialog\n End With\n\n Set olApp = Nothing\n Set olRem = Nothing\n\n End Sub\n</code></pre>\n\n<p>As you can see, I am able to paste using a SendKeys method, but it is sort of a hack, and not... sophisticated. I'm sure there's another way of doing it, any ideas?</p>\n\n<p>I found code for pasting as HTML to an email, but as I understand, the Mail item allows for HTML, but not the Task item.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 657, "user_id": 3876260, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Np7SC.jpg?s=128&g=1", "display_name": "NaeiKinDus", "link": "https://stackoverflow.com/users/3876260/naeikindus"}, "edited": false, "score": 0, "creation_date": 1429739685, "post_id": 29809586, "comment_id": 47747243, "body": "How about giving us some piece of code first ?"}, {"owner": {"reputation": 11, "user_id": 4821584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78bd5614f5cec869a28d1503b72df04a?s=128&d=identicon&r=PG&f=1", "display_name": "Crimsontide57", "link": "https://stackoverflow.com/users/4821584/crimsontide57"}, "reply_to_user": {"reputation": 657, "user_id": 3876260, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Np7SC.jpg?s=128&g=1", "display_name": "NaeiKinDus", "link": "https://stackoverflow.com/users/3876260/naeikindus"}, "edited": false, "score": 0, "creation_date": 1429739799, "post_id": 29809586, "comment_id": 47747302, "body": "Sorry never been on this site before, it was recommended to me by a friend. Here is the original question. The file Sales.xlsx contains sales data of a firm for its different regions in a given month. Write a macro that italicizes and changes the font color to blue for the months Region 8 had sales less than a cutoff level provided by the user in an InputBox. For example, if the user enters 10000 in the InputBox, the macro should search for the months where sales in Region 8 are less than 10000. Then, the macro should turn cells E9, F9, I9, J9, K9, and L9 to italic with blue font."}, {"owner": {"reputation": 11, "user_id": 4821584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78bd5614f5cec869a28d1503b72df04a?s=128&d=identicon&r=PG&f=1", "display_name": "Crimsontide57", "link": "https://stackoverflow.com/users/4821584/crimsontide57"}, "reply_to_user": {"reputation": 657, "user_id": 3876260, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Np7SC.jpg?s=128&g=1", "display_name": "NaeiKinDus", "link": "https://stackoverflow.com/users/3876260/naeikindus"}, "edited": false, "score": 0, "creation_date": 1429739862, "post_id": 29809586, "comment_id": 47747327, "body": "Sub Homework7Problem2() &#39; Keyboard Shortcut: Ctrl+b     Dim Cutoff As String     Cutoff = InputBox(&quot;Enter the cutoff level you would like to use&quot;, &quot;CutoffLevel&quot;)     If Range(&quot;B2:M41&quot;).Cells &lt; CutoffLevel Then Range(&quot;B2:M41&quot;).Cells.Font.Italic = True     With Selection.Font         .Color = -4165632         .TintAndShade = 0     End With     End If      End Sub"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1429739874, "post_id": 29809586, "comment_id": 47747338, "body": "Why does this need to be VBA? You could designate a specific cell to be your input box, and then use conditional formatting to accomplish this"}, {"owner": {"reputation": 657, "user_id": 3876260, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Np7SC.jpg?s=128&g=1", "display_name": "NaeiKinDus", "link": "https://stackoverflow.com/users/3876260/naeikindus"}, "edited": false, "score": 0, "creation_date": 1429739881, "post_id": 29809586, "comment_id": 47747344, "body": "No problem mate, but you should take a look at the rules to get started on StackOverflow, they are useful. Also you should edit your question to add your code in it and be sure to use the [code] tag :)"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1429739894, "post_id": 29809586, "comment_id": 47747351, "body": "Are you asking us to do your homework for you?"}, {"owner": {"reputation": 11, "user_id": 4821584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78bd5614f5cec869a28d1503b72df04a?s=128&d=identicon&r=PG&f=1", "display_name": "Crimsontide57", "link": "https://stackoverflow.com/users/4821584/crimsontide57"}, "edited": false, "score": 0, "creation_date": 1429740002, "post_id": 29809586, "comment_id": 47747408, "body": "It needs to be VBA because this is for a class I am taking that specifies it as such. I already submitted my assignment with the given code for partial credit but the final exam is upcoming and I just wanted to crack this problem. And I&#39;m sorry if I broke any of the rules :("}, {"owner": {"reputation": 11, "user_id": 4821584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78bd5614f5cec869a28d1503b72df04a?s=128&d=identicon&r=PG&f=1", "display_name": "Crimsontide57", "link": "https://stackoverflow.com/users/4821584/crimsontide57"}, "edited": false, "score": 0, "creation_date": 1429740109, "post_id": 29809586, "comment_id": 47747459, "body": "I am not asking anyone to do this for me, I have part of the code and the homework is already long passed. I&#39;m just curious as to how to finish the code past the InputBox. I just don&#39;t know how to proceed writing the conditional statements"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1429740185, "post_id": 29809586, "comment_id": 47747499, "body": "Fair enough, I missed the code you had put in the comments"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1429740387, "post_id": 29809586, "comment_id": 47747582, "body": "On the left bottom of Excel there&#39;s a small button called &quot;Record macro&quot;. Click on it, make the action manually and then stop it to see what is the code you wrote; 95% of your mark will be already there."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4821584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78bd5614f5cec869a28d1503b72df04a?s=128&d=identicon&r=PG&f=1", "display_name": "Crimsontide57", "link": "https://stackoverflow.com/users/4821584/crimsontide57"}, "edited": false, "score": 0, "creation_date": 1429740756, "post_id": 29809822, "comment_id": 47747750, "body": "I am no longer getting an error message but no cells are highlighted! Any idea what the problem might be? Thank you so much for your help also! I do generally apologize for my total ignorance, I&#39;m not well versed in any code except some self taught HTML and Wikipedia mark up language."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1429741112, "post_id": 29809822, "comment_id": 47747898, "body": "Probably because the <code>Cutoff</code> variable is a string and the values in range B2:M41 are numbers so the comparison is failing due to mismatched data types."}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "reply_to_user": {"reputation": 11, "user_id": 4821584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78bd5614f5cec869a28d1503b72df04a?s=128&d=identicon&r=PG&f=1", "display_name": "Crimsontide57", "link": "https://stackoverflow.com/users/4821584/crimsontide57"}, "edited": false, "score": 0, "creation_date": 1429741480, "post_id": 29809822, "comment_id": 47748052, "body": "@Crimsontide57 Yeah, I got the title of the inputbox and the variablename messed up, should be fixed now. I also made sure that I  attempt to convert the input to a <code>Long</code>.  You can still run into trouble though, if whoever inputs data enters something else than a number."}], "tags": [], "owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "is_accepted": false, "score": 0, "last_activity_date": 1429741387, "last_edit_date": 1429741387, "creation_date": 1429740506, "answer_id": 29809822, "question_id": 29809586, "link": "https://stackoverflow.com/questions/29809586/in-vba-given-an-input-box-value-write-a-program-that-changes-the-font-to-italic/29809822#29809822", "title": "In VBA Given an input box value, write a program that changes the font to italic for cells in a range below the given value", "body": "<p>There are a couple of ways you can do this, comparing the entire range to the cutoff-value as you've done won't work, but you can loop through the entire range and apply the formatting to any cell that fulfill the conditions:</p>\n\n<pre><code>Sub Homework7Problem2()\n  ' Keyboard Shortcut: Ctrl+b\n  Dim Cutoff As String\n  Dim c As Range\n\n  Cutoff = InputBox(\"Enter the cutoff level you would like to use\", \"CutoffLevel\")\n\n  For Each c In Range(\"B2:M41\")\n    If c &lt; CLng(Cutoff) Then\n      c.Font.Italic = True\n      c.Font.Color = -4165632\n      c.Font.TintAndShade = 0\n    End If\n  Next\nEnd Sub\n</code></pre>\n\n<p>Alternately you could use a macro to apply somee conditional formatting to the range:</p>\n\n<pre><code>Sub Homework7Problem2()\n  ' Keyboard Shortcut: Ctrl+b\n  Dim Cutoff As String\n\n  Cutoff = InputBox(\"Enter the cutoff level you would like to use\", \"CutoffLevel\")\n\n  With Range(\"B2:M41\")\n    ' First delete earlier conditional formatting, to avoid conflicts\n    .FormatConditions.Delete\n    ' Add new conditional formatting\n    .FormatConditions.Add Type:=xlCellValue, Operator:=xlLess, Formula1:=\"=\" &amp; Cutoff\n    With .FormatConditions(1).Font\n      .Italic = True\n      .Color = -4165632\n      .TintAndShade = 0\n    End With\n  End With\nEnd Sub\n</code></pre>\n\n<p>I'd argue that it'd be much simpler to just apply the conditional formatting from the conditional formatting dialogue in Excel, but since the problem requires VBA, I suppose you may  get some use out of this.</p>\n"}, {"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 2, "last_activity_date": 1429742442, "creation_date": 1429742442, "answer_id": 29810224, "question_id": 29809586, "link": "https://stackoverflow.com/questions/29809586/in-vba-given-an-input-box-value-write-a-program-that-changes-the-font-to-italic/29810224#29810224", "title": "In VBA Given an input box value, write a program that changes the font to italic for cells in a range below the given value", "body": "<p>Basically you'd need to loop over the cells and determine which ones meet the criteria (in this case, cells that are less than the cutoff). Once you have identified those cells, you can format them however you like.  I prefer to put them in to a range variable and then format all of the identified cells all at once at the end which is much faster than formatting each identified cell individually as you find it.  As you learn more VBA you'll find that this is considered good practice.</p>\n\n<p>Here is the commented code:</p>\n\n<pre><code>Sub Homework7Problem2()\n\n    'Declare Variables\n    Dim rngSales As Range       'Range to store the Sales cells\n    Dim SalesCell As Range      'Loop variable for rngSales\n    Dim rngBelowTarget As Range 'Range to store cells that are below the target/cutoff\n    Dim dTarget As Double       'Variable used to store the target/cutoff entered by the user\n\n    'Define what cells to check\n    Set rngSales = Range(\"B2:M41\")\n\n    'Reset formatting so that only cells below the new target will be formatted\n    With rngSales\n        .Font.Italic = False\n        .Font.Color = vbBlack\n    End With\n\n    'Use Application.InputBox and set the Type parameter to 1 to force a number\n    dTarget = Application.InputBox(\"Enter the cutoff level you would like to use:\", \"Cutoff Level\", Type:=1)\n    If dTarget = 0 Then Exit Sub   'User pressed cancel\n\n    'Verify if there will be any matching cells\n    If WorksheetFunction.CountIf(rngSales, \"&lt;\" &amp; dTarget) = 0 Then\n        'If no matching cells, return error and exit the subroutine\n        MsgBox \"No months found to have sales less than [\" &amp; dTarget &amp; \"]\", , \"No Matches\"\n        Exit Sub\n    End If\n\n    'Loop though each cell in the range\n    For Each SalesCell In rngSales.Cells\n        If SalesCell.Value &lt; dTarget Then\n            'If a matching cell is found, add it to the rngBelowTarget variable\n            If rngBelowTarget Is Nothing Then\n                'This is the first cell found\n                Set rngBelowTarget = SalesCell\n            Else\n                'This is for subsequent cells found, add them to the variable\n                Set rngBelowTarget = Union(rngBelowTarget, SalesCell)\n            End If\n        End If\n    Next SalesCell\n\n    'Format cells that meet the condition\n    With rngBelowTarget\n        .Font.Italic = True\n        .Font.Color = vbBlue\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4821584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78bd5614f5cec869a28d1503b72df04a?s=128&d=identicon&r=PG&f=1", "display_name": "Crimsontide57", "link": "https://stackoverflow.com/users/4821584/crimsontide57"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1389, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1429742442, "creation_date": 1429739603, "last_edit_date": 1429740282, "question_id": 29809586, "link": "https://stackoverflow.com/questions/29809586/in-vba-given-an-input-box-value-write-a-program-that-changes-the-font-to-italic", "title": "In VBA Given an input box value, write a program that changes the font to italic for cells in a range below the given value", "body": "<p>I've gotten fairly confused on this problem. The question as stated above asks you to write a program that gives an input box where you may enter a cutoff level. Once the cutoff level is given all values in the range on the sheet below that cutoff level need to be italicized. Where I get stuck is making the code select cells, not the whole range. Any suggestions?</p>\n\n<h2>Assignment</h2>\n\n<p>The file Sales.xlsx contains sales data of a firm for its different regions in a given month. Write a macro that italicizes and changes the font color to blue for the months Region 8 had sales less than a cutoff level provided by the user in an InputBox. For example, if the user enters 10000 in the InputBox, the macro should search for the months where sales in Region 8 are less than 10000. Then, the macro should turn cells E9, F9, I9, J9, K9, and L9 to italic with blue font</p>\n\n<h2>My attempt</h2>\n\n<pre><code>Sub Homework7Problem2() \n' Keyboard Shortcut: Ctrl+b \nDim Cutoff As String \nCutoff = InputBox(\"Enter the cutoff level you would like to use\", \"CutoffLevel\")\nIf Range(\"B2:M41\").Cells &lt; CutoffLevel Then \n    Range(\"B2:M41\").Cells.Font.Italic = True \n    With Selection.Font \n        .Color = -4165632 \n        .TintAndShade = 0 \n    End With \nEnd If \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1429739764, "post_id": 29809545, "comment_id": 47747284, "body": "It appears to me that what you want to do is loop through all of the cells within a range and pop up a <code>msgbox</code> if one of those numbers exceeds a threshold?"}, {"owner": {"reputation": 133, "user_id": 4020383, "user_type": "registered", "accept_rate": 18, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rj Joplin", "link": "https://stackoverflow.com/users/4020383/rj-joplin"}, "reply_to_user": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1429739958, "post_id": 29809545, "comment_id": 47747390, "body": "That would be correct."}, {"owner": {"reputation": 133, "user_id": 4020383, "user_type": "registered", "accept_rate": 18, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rj Joplin", "link": "https://stackoverflow.com/users/4020383/rj-joplin"}, "reply_to_user": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1429740084, "post_id": 29809545, "comment_id": 47747445, "body": "If it would continue through the cells once if found a threshold, that would be preferred as well. I wouldn&#39;t want it to stop if it found one."}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 4020383, "user_type": "registered", "accept_rate": 18, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rj Joplin", "link": "https://stackoverflow.com/users/4020383/rj-joplin"}, "edited": false, "score": 0, "creation_date": 1429740586, "post_id": 29809711, "comment_id": 47747664, "body": "I will try that, but could you explain something so I have a deeper understanding rather than just copy/paste.   When you utilize the cells(i ,3), does this automatically cycle through? Essentially using i as a placekeeper?   (apologize if this is a stupid question, I have not been working with VBA a terribly long time)"}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "reply_to_user": {"reputation": 133, "user_id": 4020383, "user_type": "registered", "accept_rate": 18, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rj Joplin", "link": "https://stackoverflow.com/users/4020383/rj-joplin"}, "edited": false, "score": 0, "creation_date": 1429740659, "post_id": 29809711, "comment_id": 47747708, "body": "It will &#39;cycle&#39; through cells C1 through C100. C is the 3rd column, hence the 3. i refers to the row numbers 1 through 100. Not a stupid question at all. Keep learning!"}, {"owner": {"reputation": 133, "user_id": 4020383, "user_type": "registered", "accept_rate": 18, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rj Joplin", "link": "https://stackoverflow.com/users/4020383/rj-joplin"}, "edited": false, "score": 0, "creation_date": 1429740795, "post_id": 29809711, "comment_id": 47747768, "body": "Also, is it much more complicated to reference a separate cell? The reason I don&#39;t really want to reference cells specifically is that the cell is categorized by a date/time, which is in column A, and the data itself is in column C. Being able to see the timestamp initially gets rid of more searching."}, {"owner": {"reputation": 133, "user_id": 4020383, "user_type": "registered", "accept_rate": 18, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rj Joplin", "link": "https://stackoverflow.com/users/4020383/rj-joplin"}, "edited": false, "score": 0, "creation_date": 1429740825, "post_id": 29809711, "comment_id": 47747783, "body": "Thank you for the explanation."}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "reply_to_user": {"reputation": 133, "user_id": 4020383, "user_type": "registered", "accept_rate": 18, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rj Joplin", "link": "https://stackoverflow.com/users/4020383/rj-joplin"}, "edited": false, "score": 0, "creation_date": 1429789353, "post_id": 29809711, "comment_id": 47770928, "body": "I&#39;m not sure I follow your last comment."}, {"owner": {"reputation": 133, "user_id": 4020383, "user_type": "registered", "accept_rate": 18, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rj Joplin", "link": "https://stackoverflow.com/users/4020383/rj-joplin"}, "edited": false, "score": 0, "creation_date": 1429792653, "post_id": 29809711, "comment_id": 47773554, "body": "I want the box that pops up to be able to reference a timestamp located in the A column but do the analyses on the C column. So If C3 is over, It would return the timestamp A3 in the message box."}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "reply_to_user": {"reputation": 133, "user_id": 4020383, "user_type": "registered", "accept_rate": 18, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rj Joplin", "link": "https://stackoverflow.com/users/4020383/rj-joplin"}, "edited": false, "score": 0, "creation_date": 1429793290, "post_id": 29809711, "comment_id": 47774083, "body": "Very well then. I edited my solution somewhat to address this."}], "tags": [], "owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "is_accepted": false, "score": 1, "last_activity_date": 1429793266, "last_edit_date": 1429793266, "creation_date": 1429740083, "answer_id": 29809711, "question_id": 29809545, "link": "https://stackoverflow.com/questions/29809545/how-to-reference-a-cell-in-a-msgbox-when-another-box-has-a-certain-value-in-exce/29809711#29809711", "title": "How to reference a cell in a msgBox when another box has a certain value in excel (VBA).", "body": "<p>Why not try something like</p>\n\n<pre><code>for i = 1 to 100\n  if cells(i, 3) &gt; 3.45 then\n    msgbox \"Cell C\" &amp; i &amp; \" is too high. The corresponding time stamp is \" &amp; cells(i, 1) &amp; \".\"\n  end if\nnext i\n</code></pre>\n\n<p>This will alert the user each time a cell in that range was \"too high\".</p>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 0, "last_activity_date": 1429761707, "creation_date": 1429761707, "answer_id": 29813417, "question_id": 29809545, "link": "https://stackoverflow.com/questions/29809545/how-to-reference-a-cell-in-a-msgbox-when-another-box-has-a-certain-value-in-exce/29813417#29813417", "title": "How to reference a cell in a msgBox when another box has a certain value in excel (VBA).", "body": "<p>Single liner without loops (for fun - touch harder to understand!)</p>\n\n<pre><code>MsgBox Join(Filter(Application.Transpose(Application.Evaluate(\"=IF(ISNUMBER(C1:C100),IF(C1:C100&gt;3.45,\"\"C\"\"&amp; ROW(C1:C100),\"\"x\"\"),\"\"x\"\")\")), \"x\", False), \",\")\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 4020383, "user_type": "registered", "accept_rate": 18, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rj Joplin", "link": "https://stackoverflow.com/users/4020383/rj-joplin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 863, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1429793266, "creation_date": 1429739473, "question_id": 29809545, "link": "https://stackoverflow.com/questions/29809545/how-to-reference-a-cell-in-a-msgbox-when-another-box-has-a-certain-value-in-exce", "title": "How to reference a cell in a msgBox when another box has a certain value in excel (VBA).", "body": "<p>I am attempting to get a corresponding cell to be entered into a msgBox when a cell in that row hits a certain value. For instance, if C1 > 3.45, I want a message box saying \"The value at \" + Range(\"A1\") + \" is too high.\" This would extend for the entirety of the array.</p>\n\n<p>I have been attempting to modify the simple script. </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Set Target = Me.Range(\"C1:C100\")\n    If Target.Value &gt; 3.45 Then\n        MsgBox \"The Value at \"+ Range(\"A1:A100\") + \" exceeded limit.\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>I know I am missing something, but I can't figure out how to correlate the numbers, and have them return. I know that I could with a Match and utilizing the general form of </p>\n\n<pre><code> Set targetRange = [range]\n targetRange.FormulaArray = \"=[insert array formula]\"\n</code></pre>\n\n<p>But I can't seem to get them to work correctly. </p>\n\n<p>Thank you in advance for the help.  </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 283, "user_id": 4801586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PJcwl.png?s=128&g=1", "display_name": "314UnreadEmails", "link": "https://stackoverflow.com/users/4801586/314unreademails"}, "edited": false, "score": 0, "creation_date": 1429738877, "post_id": 29809242, "comment_id": 47746886, "body": "If you just paste &quot;=NETWORKDAYS(RC[-14],RC[-12],&#39;Non-Valuation Days&#39;!R[-7]C[-18]:R[57]C[-18])&quot; into the worksheet what does it return?"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1429739223, "post_id": 29809242, "comment_id": 47747046, "body": "what does the real formula look like?"}, {"owner": {"reputation": 481, "user_id": 4678346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6845c5e542113332da5214c2bd77b7df?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4678346/james"}, "reply_to_user": {"reputation": 283, "user_id": 4801586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PJcwl.png?s=128&g=1", "display_name": "314UnreadEmails", "link": "https://stackoverflow.com/users/4801586/314unreademails"}, "edited": false, "score": 0, "creation_date": 1429739247, "post_id": 29809242, "comment_id": 47747057, "body": "@314unreadEmails it returns the difference between the days . But when the user enters a date not to b include I have to update the calculation manully"}, {"owner": {"reputation": 481, "user_id": 4678346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6845c5e542113332da5214c2bd77b7df?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4678346/james"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1429739591, "post_id": 29809242, "comment_id": 47747197, "body": "@Davesexcel the formulea is =NETWORKDAYS(E11,G11,&#39;Non-Valuation Days&#39;!A4:A49)"}, {"owner": {"reputation": 481, "user_id": 4678346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6845c5e542113332da5214c2bd77b7df?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4678346/james"}, "edited": false, "score": 0, "creation_date": 1429739657, "post_id": 29809242, "comment_id": 47747230, "body": "Between A4-A49 in Non valuation days worksheet the user can input the days not to be included."}, {"owner": {"reputation": 481, "user_id": 4678346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6845c5e542113332da5214c2bd77b7df?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4678346/james"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1429739776, "post_id": 29809242, "comment_id": 47747289, "body": "@pnuts even if the code is reran , i have to go where there is red flag error to update it."}, {"owner": {"reputation": 481, "user_id": 4678346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6845c5e542113332da5214c2bd77b7df?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4678346/james"}, "edited": false, "score": 0, "creation_date": 1429739991, "post_id": 29809242, "comment_id": 47747404, "body": "one cell will update however the rest need to be update manually. i though    the loop would have done the trick"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1429740622, "post_id": 29809242, "comment_id": 47747682, "body": "I think it should be` &quot;=NETWORKDAYS(RC[-14],RC[-12],&#39;Non-Valuation Days&#39;!R4C1:R49C1)&quot;` which works out to be,<code>=NETWORKDAYS(E11,G11,&#39;Non-Valuation Days&#39;!$A$4:$A$49)</code>"}, {"owner": {"reputation": 481, "user_id": 4678346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6845c5e542113332da5214c2bd77b7df?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4678346/james"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1429740843, "post_id": 29809242, "comment_id": 47747790, "body": "@Davesexcel thanks for that. you correct. School boy error on my part ."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1429751342, "post_id": 29809242, "comment_id": 47751448, "body": "You should name the range <code>&#39;Non-Valuation Days&#39;!$A$4:$A$49</code> or probably a whole column for these Non-Valuation days, it makes maintenance much easier. And use this name in the NetWorkDays formula."}], "answers": [{"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": true, "score": 0, "last_activity_date": 1429741069, "creation_date": 1429741069, "answer_id": 29809941, "question_id": 29809242, "link": "https://stackoverflow.com/questions/29809242/vba-networkdays-not-updating-formulea/29809941#29809941", "title": "VBA networkdays not updating formulea", "body": "<p>it should be<code>\"=NETWORKDAYS(RC[-14],RC[-12],'Non-Valuation Days'!R4C1:R49C1)\"</code> </p>\n"}], "owner": {"reputation": 481, "user_id": 4678346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6845c5e542113332da5214c2bd77b7df?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4678346/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 29809941, "answer_count": 1, "score": 0, "last_activity_date": 1429741069, "creation_date": 1429738250, "last_edit_date": 1429739071, "question_id": 29809242, "link": "https://stackoverflow.com/questions/29809242/vba-networkdays-not-updating-formulea", "title": "VBA networkdays not updating formulea", "body": "<p>I have a macro which <strong>calculates the number of days between two days</strong>. In a separate worksheet the <strong>user can input the days to exclude from the calculation.</strong> </p>\n\n<p>However the macro is <strong>not updating calculation</strong> based on the users request to exclude certain days. Please see my code below. </p>\n\n<blockquote>\n  <p>Sub Numberof_Days()</p>\n  \n  <p>Dim LastRow As Long</p>\n\n<pre><code>LastRow = ActiveSheet.Range(\"G\" &amp; Rows.Count).End(xlUp).row\nRange(\"S11\").Select\nDo Until ActiveCell.row = LastRow + 1\n    If IsEmpty(ActiveCell) Then\nActiveCell.FormulaR1C1 = _\n    \"=NETWORKDAYS(RC[-14],RC[-12],'Non-Valuation Days'!R[-7]C[-18]:R[57]C[-18])\"\n    End If\n    ActiveCell.Offset(1, 0).Select\nLoop End Sub\n</code></pre>\n</blockquote>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1429740062, "post_id": 29808808, "comment_id": 47747439, "body": "If I input <code>125</code>, which is the cube root of <code>5</code>, I correctly get the answer <code>Is cube</code> even if you&#39;re saying that it works only for <code>2</code> and <code>3</code>. I think you should clarify what is the input, the output you expect and the output you get for us to understand what you mean. Otherwise, I can only say that <i>given your description, your code should work fine</i>."}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1429767076, "post_id": 29808808, "comment_id": 47756344, "body": "@MatteoNNZ without dimension b as long the code above fails for me as int(b) returns 4."}, {"owner": {"reputation": 869, "user_id": 4437159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a32f5d6d49f7d05252f3fc8cc526763?s=128&d=identicon&r=PG&f=1", "display_name": "stucharo", "link": "https://stackoverflow.com/users/4437159/stucharo"}, "edited": false, "score": 0, "creation_date": 1429806618, "post_id": 29808808, "comment_id": 47785056, "body": "@Apurva I hope you&#39;ve found the answer to your question.  If so, it is customary here to accept the answer which provided the best solution to your problem.  You can read more about that <a href=\"http://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work\">here</a>."}], "answers": [{"tags": [], "owner": {"reputation": 869, "user_id": 4437159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a32f5d6d49f7d05252f3fc8cc526763?s=128&d=identicon&r=PG&f=1", "display_name": "stucharo", "link": "https://stackoverflow.com/users/4437159/stucharo"}, "is_accepted": true, "score": 2, "last_activity_date": 1429740771, "last_edit_date": 1429740771, "creation_date": 1429739957, "answer_id": 29809684, "question_id": 29808808, "link": "https://stackoverflow.com/questions/29808808/checking-if-a-number-has-an-integer-cubic-root/29809684#29809684", "title": "Checking if a number has an integer cubic root", "body": "<p>Since you are passing in a <code>Long</code> I'll assume that you won't have a number bigger than roughly 2*10^9 so this should always work.  It's a slight variation where you truncate the double and then compare to the two nearest integers to make sure you catch any rounding errors.</p>\n\n<p>Edit: In VBA the truncating would always round so it's only neccessary to check the 3rd root value:</p>\n\n<pre><code>Public Function Iscube(a As Long) As Boolean\n\nDim b As Integer\nb = CInt(a ^ (1# / 3#))\n\nIf (b ^ 3 = a) Then\n    Iscube = True\nElse\n    Iscube = False\nEnd If\n\nEnd Function\n</code></pre>\n\n<p>If you need a number larger than a <code>Long</code> you'll need to change your input type and you might want to consider an iterative method like a binary search or a Newton-Raphson solver instead.</p>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 1, "last_activity_date": 1429767035, "creation_date": 1429767035, "answer_id": 29814475, "question_id": 29808808, "link": "https://stackoverflow.com/questions/29808808/checking-if-a-number-has-an-integer-cubic-root/29814475#29814475", "title": "Checking if a number has an integer cubic root", "body": "<p><em>Existing Code</em></p>\n\n<p>Your code will work if you add a<br>\n<code>dim b as long</code> </p>\n\n<p>If you debug your code you will see that feeding in 125 gives you</p>\n\n<blockquote>\n  <p>b = 5<br>\n  Int(b) = 4</p>\n</blockquote>\n\n<p><em>Updated Code</em></p>\n\n<p>You can shorten your boolean test to this</p>\n\n<pre><code>Function Iscube(lngIn As Long) As Boolean\nIscube = (Val(lngIn ^ (1 / 3)) = Int(Val(lngIn ^ (1 / 3))))\nEnd Function\n</code></pre>\n\n<p>Note that if you call it with a double, it will opearte on the long portion only (so it would see <code>IsCube(64.01)</code>as <code>IsCube(64)</code>)</p>\n"}], "owner": {"reputation": 55, "user_id": 4774927, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Yx_QRP14ZD4/AAAAAAAAAAI/AAAAAAAAFqE/L4e07AH1c_U/photo.jpg?sz=128", "display_name": "Apurva ", "link": "https://stackoverflow.com/users/4774927/apurva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 29809684, "answer_count": 2, "score": 5, "last_activity_date": 1429792312, "creation_date": 1429736696, "last_edit_date": 1429769832, "question_id": 29808808, "link": "https://stackoverflow.com/questions/29808808/checking-if-a-number-has-an-integer-cubic-root", "title": "Checking if a number has an integer cubic root", "body": "<p>I am trying to check whether a given number is cuberoot or not in VBA.<br>\nThe following code works only for 2 and 3 as answers, it does not work after that.<br>\nI am trying to figure out what is wrong in the code.</p>\n\n<pre><code>Sub cuberoot()\n    Dim n As Long, p As Long, x As Long, y As Long\n\n    x = InputBox(\"x= \")\n    If Iscube(x) Then\n        MsgBox (\"Is cube\")\n    Else\n        MsgBox (\"No cube\")\n    End If\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Private Function Iscube(a As Long) As Boolean\n    b = a ^ (1 / 3)\n    If b = Int(b) Then\n        Iscube = True\n    Else\n        Iscube = False\n    End If\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "formatting", "cell", "vba"], "comments": [{"owner": {"reputation": 31907, "user_id": 1016435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec5b5b34bc32793b277190147e60b5b?s=128&d=identicon&r=PG", "display_name": "xQbert", "link": "https://stackoverflow.com/users/1016435/xqbert"}, "edited": false, "score": 0, "creation_date": 1429735991, "post_id": 29808321, "comment_id": 47745286, "body": "Pretty sure this isn&#39;t possible in formula&#39;s.  It could be done using VBA from what I&#39;m reading... <a href=\"http://www.mrexcel.com/forum/excel-questions/265158-concatenate-keep-formatting.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 1, "last_activity_date": 1429776858, "creation_date": 1429776858, "answer_id": 29817479, "question_id": 29808321, "link": "https://stackoverflow.com/questions/29808321/replace-commas-with-lf-but-keeping-color-formatting-within-cell/29817479#29817479", "title": "Replace commas with LF - BUT keeping color formatting within cell?", "body": "<p>You would need to loop:</p>\n\n<pre><code>Sub replaceCommas()\n    Dim cell As Range\n    Dim n As Long\n    For Each cell In Selection.Cells\n        For n = 1 To Len(cell.Value2)\n            If cell.Characters(n, 1).Text = \",\" Then cell.Characters(n, 1).Text = vbLf\n        Next n\n    Next cell\nEnd Sub\n</code></pre>\n\n<p>for example. Note that there can be issues with accessing Characters if the cells contain a lot of text.</p>\n"}], "owner": {"reputation": 1, "user_id": 4821193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b9a888f95b70f259640ef8b735811aa?s=128&d=identicon&r=PG&f=1", "display_name": "Kerstin Queeney", "link": "https://stackoverflow.com/users/4821193/kerstin-queeney"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429776858, "creation_date": 1429735114, "last_edit_date": 1531164843, "question_id": 29808321, "link": "https://stackoverflow.com/questions/29808321/replace-commas-with-lf-but-keeping-color-formatting-within-cell", "title": "Replace commas with LF - BUT keeping color formatting within cell?", "body": "<p>I have a list of names within a cell, that differ in color and are separated by comma. All I want to achieve now is to replace the commas with a LF.   I can only find replacement methods that then also remove the different coloring of the names ( e.g. Cells.Replace ( \",\" ,  \"\"&amp;CHR(10) &amp; \"\", ....). Any suggestions ?</p>\n"}, {"tags": ["vba", "excel", "csv"], "comments": [{"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 1, "creation_date": 1429737587, "post_id": 29808162, "comment_id": 47746217, "body": "How about instead of identifying the last row, you identify the last column with something like <code>LastColumn = cells(1,16000).end(xltoleft).column</code> and then you could place the new file one column after that?"}], "answers": [{"tags": [], "owner": {"reputation": 85, "user_id": 4793927, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh5.googleusercontent.com/-htfTTycgtcY/AAAAAAAAAAI/AAAAAAAADRE/AWfETYPt0yA/photo.jpg?sz=128", "display_name": "ChiHam", "link": "https://stackoverflow.com/users/4793927/chiham"}, "is_accepted": false, "score": 0, "last_activity_date": 1429739956, "creation_date": 1429739956, "answer_id": 29809682, "question_id": 29808162, "link": "https://stackoverflow.com/questions/29808162/sorting-data-from-multiple-csvs-into-a-single-workbook/29809682#29809682", "title": "Sorting data from multiple .csv&#39;s into a single workbook", "body": "<p>This macro might help.</p>\n\n<pre><code>Sub simpleXlsMerger() Dim bookList As Workbook Dim mergeObj As Object, dirObj As Object, filesObj As Object, everyObj As Object Application.ScreenUpdating = False Set mergeObj = CreateObject(\"Scripting.FileSystemObject\")\n\n'change folder path of excel files here Set dirObj = mergeObj.Getfolder(\"C:\\Users\\guillermo.rojas\\Documents\\Desktop\\Reports\\EOD\") Set filesObj = dirObj.Files For Each everyObj In filesObj Set bookList\n= Workbooks.Open(everyObj)\n\n'change \"A2\" with cell reference of start point for every files here 'for example \"B3:IV\" to merge all files start from columns B and rows 3 'If you're files using more than IV column, change it to the latest column 'Also change \"A\" column on \"A65536\" to the same column as start point Range(\"A2:IV\" &amp; Range(\"A65536\").End(xlUp).Row).Copy ThisWorkbook.Worksheets(1).Activate\n\n'Do not change the following column. It's not the same column as above Range(\"A65536\").End(xlUp).Offset(1, 0).PasteSpecial Application.CutCopyMode = False bookList.Close Next End Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 110, "user_id": 4695744, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-ZWK1GNVm3VE/AAAAAAAAAAI/AAAAAAAAIzA/W3kd_AxFWMQ/photo.jpg?sz=128", "display_name": "Anurag Singh", "link": "https://stackoverflow.com/users/4695744/anurag-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1429741833, "last_edit_date": 1429741833, "creation_date": 1429740331, "answer_id": 29809765, "question_id": 29808162, "link": "https://stackoverflow.com/questions/29808162/sorting-data-from-multiple-csvs-into-a-single-workbook/29809765#29809765", "title": "Sorting data from multiple .csv&#39;s into a single workbook", "body": "<p>Find the LastColumn in the SummarySheet using the following code: </p>\n\n<pre><code>LastColumn = Workbk.Worksheets(1).Cells(1, Columns.Count).End(xlToLeft).Column\n</code></pre>\n\n<p>Then convert the LastColumn Number to letter using the following code or function:</p>\n\n<pre><code>LastColumnLetter = CovertToLetter(LastColumn)\n\nPublic Function ConvertToLetter(iCol As Long) As String\n   Dim iAlpha As Long\n   Dim iRemainder As Long\n   iAlpha = Int(iCol / 27)\n   iRemainder = iCol - (iAlpha * 26)\n   If iAlpha &gt; 0 Then\n      ConvertToLetter = Chr(iAlpha + 64)\n   End If\n   If iRemainder &gt; 0 Then\n      ConvertToLetter = ConvertToLetter &amp; Chr(iRemainder + 64)\n   End If\nEnd Function\n</code></pre>\n\n<p>Now Change DestRange like below</p>\n\n<pre><code> DestRange = SummarySheet.Range(LastColumnLetter &amp; 1)\n</code></pre>\n\n<p>Then increase the count of LastColumn as LastColumn = LastColumn + 1</p>\n"}], "owner": {"reputation": 59, "user_id": 2146211, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/65995285a2ff8ef690f7f23aec2ef574?s=128&d=identicon&r=PG", "display_name": "user2146211", "link": "https://stackoverflow.com/users/2146211/user2146211"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1429741833, "creation_date": 1429734560, "last_edit_date": 1429737534, "question_id": 29808162, "link": "https://stackoverflow.com/questions/29808162/sorting-data-from-multiple-csvs-into-a-single-workbook", "title": "Sorting data from multiple .csv&#39;s into a single workbook", "body": "<p>I have a VBA script that reads through each CSV in a given folder, reads the data in and places it into a workbook. It then goes to the next .csv and appends that data to the very last row of the previous set of data.  </p>\n\n<p>I would instead like it to append the data from each .csv along the columns not the rows, however I am having some trouble wrapping my head around how to do this.  Here is the code:</p>\n\n<pre><code>Sub MergeAllWorkbooks()\nDim SummarySheet As Worksheet\nDim FolderPath As String\nDim NRow As Long\nDim FileName As String\nDim WorkBk As Workbook\nDim SourceRange As Range\nDim DestRange As Range\nDim LastRow As Long\nDim inputValue As Variant\n\nSet SummarySheet = Workbooks.Add(xlWBATWorksheet).Worksheets(1)\n\ninputValue = InputBox(\"Input File Path:\")\nFolderPath = inputValue\n\nNRow = 1\n\nFileName = Dir(FolderPath &amp; \"*csv*\")\n\nDo While FileName &lt;&gt; \"\"\n\n    Set WorkBk = Workbooks.Open(FolderPath &amp; FileName)\n\n\n    SummarySheet.Range(\"A\" &amp; NRow).Value = FileName\n\n\n\n    LastRow = WorkBk.Worksheets(1).Cells.Find(What:=\"*\", _\n             After:=WorkBk.Worksheets(1).Cells.Range(\"A1\"), _\n             SearchDirection:=xlPrevious, _\n             LookIn:=xlFormulas, _\n             SearchOrder:=xlByRows).Row\n    Set SourceRange = WorkBk.Worksheets(1).Range(\"A1:B\" &amp; LastRow)\n\n    Set DestRange = SummarySheet.Range(\"B\" &amp; NRow)\n    Set DestRange = DestRange.Resize(SourceRange.Rows.Count, SourceRange.Columns.Count)\n\n    DestRange.Value = SourceRange.Value\n\n    NRow = NRow + DestRange.Rows.Count\n\n    WorkBk.Close savechanges:=False\n\n    FileName = Dir()\nLoop\n\nSummarySheet.Columns.AutoFit\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "loops", "excel", "for-loop"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1429736795, "post_id": 29808082, "comment_id": 47745760, "body": "I&#39;ve provided an answer in terms of the code being reduced - however asking for general advice about speeding up code is a bit out of scope for SO. If you have a particular example then you could post that as a separate question or even submit your code to the Code Review site - hope that helps :)"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 1, "creation_date": 1429736927, "post_id": 29808082, "comment_id": 47745833, "body": "WOW! there is potential for 31 trillion loops, I bet a filter could do what you are asking for, even setting ranges dynamically could help as well, as others have said, link us up to a sample workbook"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 2, "creation_date": 1429737139, "post_id": 29808082, "comment_id": 47745949, "body": "As a CR regular (and among the top VBA reviewers on CR), I agree with @SOofWXLS, posting <i>your complete working code</i> over on <a href=\"https://codereview.stackexchange.com\">Code Review</a> will certainly tremendously improve this code&#39;s performance, readability and maintainability."}, {"owner": {"reputation": 187, "user_id": 4495174, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f4d37f89eb7a16cfd1a2c364919f5985?s=128&d=identicon&r=PG&f=1", "display_name": "dom176", "link": "https://stackoverflow.com/users/4495174/dom176"}, "edited": false, "score": 0, "creation_date": 1429737769, "post_id": 29808082, "comment_id": 47746310, "body": "I would be very interested in that. I am unsure of the legality as I work for a large company. I imagine there is some sort of intellectual property thing barring me from inputting my code. Also I imagine I would have to change some identifiers to preserve some sense of confidentiality."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1429738357, "post_id": 29808082, "comment_id": 47746616, "body": "That&#39;s why you make it a sample workbook with fake data not the actual workbook with real data."}], "answers": [{"comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1429736869, "post_id": 29808731, "comment_id": 47745802, "body": "I never used to - however I work in an environment where report formats are forever changed to meet user requirements, and so <code>.Find()</code> quickly became my best friend for working with headers!"}, {"owner": {"reputation": 187, "user_id": 4495174, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f4d37f89eb7a16cfd1a2c364919f5985?s=128&d=identicon&r=PG&f=1", "display_name": "dom176", "link": "https://stackoverflow.com/users/4495174/dom176"}, "edited": false, "score": 0, "creation_date": 1429737576, "post_id": 29808731, "comment_id": 47746210, "body": "I am unfamiliar with the .find function therefore I am unsure if will work as intended. Let me do some research in conjunction with your answer and I&#39;ll get back to you. That foundRng variable looks greek to me atm."}, {"owner": {"reputation": 187, "user_id": 4495174, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f4d37f89eb7a16cfd1a2c364919f5985?s=128&d=identicon&r=PG&f=1", "display_name": "dom176", "link": "https://stackoverflow.com/users/4495174/dom176"}, "edited": false, "score": 0, "creation_date": 1429738042, "post_id": 29808731, "comment_id": 47746441, "body": "After looking through it I think this solution will work well @SOofWXLS is it possible for you to elaborate on some of the sections of your code and explain their functionality?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 187, "user_id": 4495174, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f4d37f89eb7a16cfd1a2c364919f5985?s=128&d=identicon&r=PG&f=1", "display_name": "dom176", "link": "https://stackoverflow.com/users/4495174/dom176"}, "edited": false, "score": 0, "creation_date": 1429738054, "post_id": 29808731, "comment_id": 47746448, "body": "@dom176 <code>.Find</code> returns a <code>Range</code> object if it succeeds - if it doesn&#39;t find anything, it returns a <i>null reference</i>, and in VBA that&#39;s <code>Nothing</code>. So <code>If Not foobar Is Nothing Then</code> will execute code when <code>foobar</code> has an actual object reference."}, {"owner": {"reputation": 187, "user_id": 4495174, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f4d37f89eb7a16cfd1a2c364919f5985?s=128&d=identicon&r=PG&f=1", "display_name": "dom176", "link": "https://stackoverflow.com/users/4495174/dom176"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1429738447, "post_id": 29808731, "comment_id": 47746660, "body": "so if my assumptions are correct, after the .find step hdhaircut will be set to the entire range of the column that contains the header haircut and same for the hdTradeID variable. Even after reading through the foundrng variable declaration I still don&#39;t understand what is being applied. @Mat&#39;sMug"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1429738604, "post_id": 29808731, "comment_id": 47746739, "body": "I&#39;ve added comments in the code to hopefully guide you along with @Mat&#39;sMug comments"}, {"owner": {"reputation": 187, "user_id": 4495174, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f4d37f89eb7a16cfd1a2c364919f5985?s=128&d=identicon&r=PG&f=1", "display_name": "dom176", "link": "https://stackoverflow.com/users/4495174/dom176"}, "edited": false, "score": 0, "creation_date": 1429738851, "post_id": 29808731, "comment_id": 47746873, "body": "@SOofWXLS thank you I want to confirm that works before I accept the answer so allow me to attempt to implement the code first, before I accept the answer."}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 4, "last_activity_date": 1429738568, "last_edit_date": 1429738568, "creation_date": 1429736483, "answer_id": 29808731, "question_id": 29808082, "link": "https://stackoverflow.com/questions/29808082/condense-largelyunpractical-loop-based-vba-code-nested-for-next-loops/29808731#29808731", "title": "Condense largely(Unpractical) loop based VBA code; nested For...Next loops", "body": "<p>If I understand the logic correctly then you can replace all but one of the loops with a <code>.Find()</code> method like so:</p>\n\n<pre><code>'// Dimension range objects for use\nDim hdHaricut As Excel.Range\nDim hdTradeID As Excel.Range\nDim foundRng As Excel.Range\n\nWith Anvil\n    With .Range(\"A1:A80\") '// Range containing headers\n        '// Find the cell within the above range that contains a certain string, if it exists set the Range variable to be that cell.\n        Set hdHaircut = .Find(What:=\"Haircut\", LookAt:=xlWhole)\n        Set hdTradeID = .Find(What:=\"Trade ID\", LookAt:=xlWhole)\n    End With\n    '// Only if BOTH of the above range objects were found, will the following block be executed.\n    If Not hdHaricut Is Nothing And Not hdTradeID Is Nothing Then\n        For t = 2 To 70000\n            '// Using the .Column property of the hdTradeID range, we can see if the value of Cells(t, hdTradeColumn) exists \n            '// in the other sheet by using another .Find() method.\n            Set foundRng = ALLCs.Range(ALLCs.Cells(16, 34), ALLCs.Cells(70000, 34)).Find(What:=.Cells(t, hdTradeID.Column).Value, LookAt:=xlWhole)\n            '// If it exists, then pass that value to another cell on the same row\n            If Not foundRng Is Nothing Then ALLCs.Cells(foundRng.Row, 27).Value = .Cells(t, hdHaircut.Column).Value\n            '// Clear the foundRng variable from memory to ensure it isn't mistaken for a match in the next iteration.\n            Set foundRng = Nothing\n        Next\n    End If\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 187, "user_id": 4495174, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f4d37f89eb7a16cfd1a2c364919f5985?s=128&d=identicon&r=PG&f=1", "display_name": "dom176", "link": "https://stackoverflow.com/users/4495174/dom176"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 254, "favorite_count": 1, "accepted_answer_id": 29808731, "answer_count": 1, "score": 2, "last_activity_date": 1429792918, "creation_date": 1429734282, "question_id": 29808082, "link": "https://stackoverflow.com/questions/29808082/condense-largelyunpractical-loop-based-vba-code-nested-for-next-loops", "title": "Condense largely(Unpractical) loop based VBA code; nested For...Next loops", "body": "<p>Hello everyone alright let start by giving some brief background on my project then I will follow up with my specific issue and code.</p>\n\n<p>Currently I am building a program to automate the process of filling a template. This template exceeds 60,000 rows of data quite often and I've built the large majority of it to work month to month by plugging in new data sheets and running it. Currently all of the work is based off of one data sheet which I import into excel manually. This data sheet does not contain all the data I need to populate the template so now I am beginning to bring in additional data to supplement this. The problem herein lies with data association. When I was originally pulling from one data sheet I didn't have to worry if the data I pulled for each row coincided with the other rows because it all came from the same sheet. Now I have to cross check data across two sheets to confirm it is pulling the correct information.</p>\n\n<p>Now for what you need to know. I am trying to fill a column that will be referred to as Haircut, but before I do that I need to confirm that I am pulling the correct haircut number in correlation to a Trade ID which was already populated into the template in a previous line of code.</p>\n\n<p>Using similar logic that I have been using throughout my entire project this is a snippet of code I have to perform this task.</p>\n\n<pre><code>    Dim anvil as Worksheet\n    Dim ALLCs as worksheet\n    Dim DS as worksheet\n    '''''''''''''''''''''''''''''code above this line is irrelevant to answer this question\n    ElseIf InStr(1, DS.Cells(x, 2), \"Haircut\") Then\n    Anvil.Select\n        For y = 1 To 80\n            If Anvil.Cells(1, y) = \"Haircut\" Then\n                For Z = 1 To 80\n                    If Anvil.Cells(1, Z) = \"Trade ID\" Then\n                        For t = 2 To 70000\n                            For u = 16 To 70000\n                                If Anvil.Cells(t, Z) = ALLCs.Cells(u, 34) Then\n                                ALLCs.Cells(u, 27) = Anvil.Cells(t, y)\n                                End If\n                            Next\n                        Next\n                    End If\n                Next\n            End If\n        Next\n</code></pre>\n\n<p>This code coupled with my other code I assume will in theory work, but I can only imagine that it will take an unbelievable amount of time(this program already takes 7 and a half minutes to run). Any suggestions on how to rewrite this code with better functionality, following this general logic?</p>\n\n<p>Any help is appreciated, whether you completely revamp the code, or if you offer suggestions on how to cut down loops. I am also looking for suggestions to speed up the code in general aside from screen updating and calculation suggestions.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1429734340, "post_id": 29807906, "comment_id": 47744276, "body": "Set the worksheet being copied to a variable, now you have a reference to it and can continue your code using the variable as well as change the name at the same time.  <a href=\"http://stackoverflow.com/a/7692456/2521004\">Here is an example</a> by Tim Williams"}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1429737906, "post_id": 29807906, "comment_id": 47746383, "body": "And if you wanted to go down the road you are suggestion, <code>mySheet = inputbox(...</code> should do the trick."}], "answers": [{"comments": [{"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1429801035, "post_id": 29827212, "comment_id": 47780665, "body": "inb4 methods, not rules"}], "tags": [], "owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "is_accepted": false, "score": 1, "last_activity_date": 1429800995, "creation_date": 1429800995, "answer_id": 29827212, "question_id": 29807906, "link": "https://stackoverflow.com/questions/29807906/asking-user-input-to-copy-sheets-in-vba/29827212#29827212", "title": "Asking user input to copy sheets in VBA", "body": "<pre><code>Set targetWorkbook = Application.ActiveWorkbook\nFilter = \"Text files (*.xls*),*.xls*\"\nCaption = \"Please Select the Target file\"\nRet = Application.GetOpenFilename(Filter, , Caption)\n\nIf Ret = False Then Exit Sub\nSet wb = Workbooks.Open(Ret, False) 'why set it on application level when it's an optional argument?\n\nFor Each Worksheet In wb\n    If LCase(Worksheet.Name) Like \"*changing*\" Then                              'it might be changing but it probably has a fixed part, right? 'note: you can use wildcards and string conversion rules\n        Worksheet.Move After:=targetWorkbook.Sheets(targetWorkbook.Sheets.Count) 'do whatever it did before\n    End If\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "edited": false, "score": 1, "creation_date": 1429802174, "post_id": 29827335, "comment_id": 47781655, "body": "Got it. Will try to use this. Its just  the data  I use of a  file not updated by me and have seen sheet names changing, so just wanted to make it general. Thanks"}], "tags": [], "owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "is_accepted": true, "score": 1, "last_activity_date": 1429801270, "creation_date": 1429801270, "answer_id": 29827335, "question_id": 29807906, "link": "https://stackoverflow.com/questions/29807906/asking-user-input-to-copy-sheets-in-vba/29827335#29827335", "title": "Asking user input to copy sheets in VBA", "body": "<pre><code>Sub ertdfgcvb()\nSet targetWorkbook = Application.ActiveWorkbook\nFilter = \"Text files (*.xls*),*.xls*\"\nCaption = \"Please Select the Target file\"\nRet = Application.GetOpenFilename(Filter, , Caption)\n\nIf Ret = False Then Exit Sub\nSet wb = Workbooks.Open(Ret, False) 'why set it on application level when it's an optional argument?\n\nshname = InputBox(\"What worksheet are you looking for?\", \"Changing sheet names are for losers\")\nFor Each Worksheet In wb\n    If LCase(Worksheet.Name) Like \"*\" &amp; LCase(shname) &amp; \"*\" Then                              'it might be changing but it probably has a fixed part, right? 'note: you can use wildcards and string conversion rules\n        Worksheet.Move After:=targetWorkbook.Sheets(targetWorkbook.Sheets.Count) 'do whatever it did before\n    End If\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 653, "favorite_count": 0, "accepted_answer_id": 29827335, "answer_count": 2, "score": 0, "last_activity_date": 1429801270, "creation_date": 1429733726, "question_id": 29807906, "link": "https://stackoverflow.com/questions/29807906/asking-user-input-to-copy-sheets-in-vba", "title": "Asking user input to copy sheets in VBA", "body": "<p>I want to copy sheets from a particular workbook in VBA to my Active Workbook and do a lot of calculations using it. Now the problem is that the target sheet name always keeps on changing and I always get an error.</p>\n\n<pre><code>Set targetWorkbook = Application.ActiveWorkbook\nfilter = \"Text files (*.xls*),*.xls*\"\nCaption = \"Please Select the Target file\"\nRet = Application.GetOpenFilename(filter, , Caption)\n\nIf Ret = False Then Exit Sub\nApplication.AskToUpdateLinks = False\nSet wb = Workbooks.Open(Ret)\nApplication.AskToUpdateLinks = True\nwb.Worksheets(\"**This Keeeps on Changing**\").Move After:=targetWorkbook.Sheets(targetWorkbook.Sheets.Count)\n</code></pre>\n\n<p>Can I select or Input the name in a MsgBox or something similar so that I dont get an error. Please help.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1547823343, "post_id": 29807691, "comment_id": 95336771, "body": "I&#39;m a little puzzled, why can&#39;t you just probe the object model with a bit of late binding to slyly evade compile errors?  <a href=\"https://exceldevelopmentplatform.blogspot.com/2019/01/vba-how-to-tell-if-running-in-excel-or.html\" rel=\"nofollow noreferrer\">exceldevelopmentplatform.blogspot.com/2019/01/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 4365, "user_id": 1887723, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/nNfYR.png?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/1887723/alex"}, "edited": false, "score": 0, "creation_date": 1429734027, "post_id": 29807805, "comment_id": 47744086, "body": "Excellent, first part works. Now how could I make MyProgram.exe pop up infront of my Excel file? To tell the user that it&#39;s already opened."}], "tags": [], "owner": {"reputation": 12273, "user_id": 1048539, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b2bfeca28ec73556f395bed4668f9e16?s=128&d=identicon&r=PG", "display_name": "enderland", "link": "https://stackoverflow.com/users/1048539/enderland"}, "is_accepted": true, "score": 17, "last_activity_date": 1500659839, "last_edit_date": 1500659839, "creation_date": 1429733387, "answer_id": 29807805, "question_id": 29807691, "link": "https://stackoverflow.com/questions/29807691/determine-if-application-is-running-with-excel/29807805#29807805", "title": "Determine if application is running with Excel", "body": "<p>You can check this more directly by getting a list of open processes.</p>\n\n<p>This will search based on the process name, returning true/false as appropriate.</p>\n\n<pre><code>Sub exampleIsProcessRunning()  \n    Debug.Print IsProcessRunning(\"MyProgram.EXE\")\n    Debug.Print IsProcessRunning(\"NOT RUNNING.EXE\")\n\nEnd Sub\n\nFunction IsProcessRunning(process As String)\n    Dim objList As Object\n\n    Set objList = GetObject(\"winmgmts:\") _\n        .ExecQuery(\"select * from win32_process where name='\" &amp; process &amp; \"'\")\n\n    If objList.Count &gt; 0 Then\n        IsProcessRunning = True\n    Else\n        IsProcessRunning = False\n    End If\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4365, "user_id": 1887723, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/nNfYR.png?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/1887723/alex"}, "is_accepted": false, "score": 2, "last_activity_date": 1429794610, "creation_date": 1429794610, "answer_id": 29824462, "question_id": 29807691, "link": "https://stackoverflow.com/questions/29807691/determine-if-application-is-running-with-excel/29824462#29824462", "title": "Determine if application is running with Excel", "body": "<p>Here's how I brought the search window to front:</p>\n\n<pre><code>Private Const SW_RESTORE = 9\n\nPrivate Declare Function BringWindowToTop Lib \"user32\" (ByVal hwnd As Long) As Long\nPrivate Declare Function FindWindow Lib \"user32\" Alias \"FindWindowA\" (ByVal lpClassName As Any, ByVal lpWindowName As Any) As Long\nPrivate Declare Function ShowWindow Lib \"user32\" (ByVal hwnd As Long, ByVal nCmdShow As Long) As Long\n\nPrivate Sub btnSearch_Click()\n    Dim x As Variant\n    Dim Path As String\n\n    If IsProcessRunning(\"MyProgram.exe\") = False Then\n        Path = \"C:\\Tmp\\MyProgram.exe\"\n        x = Shell(Path, vbNormalFocus)\n    Else\n        Dim THandle As Long\n        THandle = FindWindow(vbEmpty, \"Window / Form Text\")\n        Dim iret As Long\n        iret = BringWindowToTop(THandle)\n        Call ShowWindow(THandle, SW_RESTORE)\n    End If\nEnd Sub\n</code></pre>\n\n<p>Now if the window was minimized and the user clicks the search button again, the window will simply pop up.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5985865, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154551378475744/picture?type=large", "display_name": "Rodney Cuthbertson", "link": "https://stackoverflow.com/users/5985865/rodney-cuthbertson"}, "is_accepted": false, "score": -1, "last_activity_date": 1456488269, "creation_date": 1456488269, "answer_id": 35651239, "question_id": 29807691, "link": "https://stackoverflow.com/questions/29807691/determine-if-application-is-running-with-excel/35651239#35651239", "title": "Determine if application is running with Excel", "body": "<p>Just wanted to say thank you for this solution. Only just started playing around with code and wanted to automate my job a bit. This code will paste current selection in excel sheet into an already open application with as single click. Will make my life so much easier!! </p>\n\n<p>Thanks for sharing</p>\n\n<pre><code>Public Const SW_RESTORE = 9\n\nPublic Declare Function BringWindowToTop Lib \"user32\" (ByVal hwnd As Long) As Long\nPublic Declare Function FindWindow Lib \"user32\" Alias \"FindWindowA\" (ByVal lpClassName As Any, ByVal lpWindowName As Any) As Long\nPublic Declare Function ShowWindow Lib \"user32\" (ByVal hwnd As Long, ByVal nCmdShow As Long) As Long\n\nPublic Sub updatepart()\n'\n' updatepart Macro\n' copies current selection\n' finds and focuses on all ready running Notepad application called Test\n' pastes value into Notepad document\n' Keyboard Shortcut: Ctrl+u\n'\nDim data As Range\nSet data = Application.Selection\nIf data.Count &lt;&gt; 1 Then\n    MsgBox \"Selection is too large\"\n    Exit Sub\nEnd If\n\nSelection.Copy\n\n\nIf IsProcessRunning(\"Notepad.EXE\") = False Then\n    MsgBox \"Notepad is down\"\nElse\n    Dim THandle As Long\n    THandle = FindWindow(vbEmpty, \"Test - Notepad\")\n    Dim iret As Long\n    iret = BringWindowToTop(THandle)\n    Call ShowWindow(THandle, SW_RESTORE)\nEnd If\nwaittime (500)\n'Call SendKeys(\"{F7}\")\nCall SendKeys(\"^v\", True) '{F12}\nCall SendKeys(\"{ENTER}\")\n\nEnd Sub\n\nFunction waittime(ByVal milliseconds As Double)\n    Application.Wait (Now() + milliseconds / 24 / 60 / 60 / 1000)\nEnd Function\n\nFunction IsProcessRunning(process As String)\nDim objList As Object\n\nSet objList = GetObject(\"winmgmts:\") _\n    .ExecQuery(\"select * from win32_process where name='\" &amp; process &amp; \"'\")\n\nIf objList.Count &gt; 0 Then\n    IsProcessRunning = True\nElse\n    IsProcessRunning = False\nEnd If\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 137, "user_id": 2774915, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/95065537515292c3d6482280095c48b8?s=128&d=identicon&r=PG&f=1", "display_name": "MILO", "link": "https://stackoverflow.com/users/2774915/milo"}, "is_accepted": false, "score": 0, "last_activity_date": 1590212546, "last_edit_date": 1590212546, "creation_date": 1589344328, "answer_id": 61766487, "question_id": 29807691, "link": "https://stackoverflow.com/questions/29807691/determine-if-application-is-running-with-excel/61766487#61766487", "title": "Determine if application is running with Excel", "body": "<p>Just want to point out that the Window Text may change when documents are open in the application instance.</p>\n\n<p>For example, I was trying to bring CorelDRAW to focus and everything would work fine so long as there wasn't a document open in Corel, if there was, I would need to pass the complete name to <code>FindWindow()</code> including the open document.</p>\n\n<p>So, instead of just:</p>\n\n<p><code>FindWindow(\"CorelDRAW 2020 (64-Bit)\")</code> </p>\n\n<p>It would have to be:</p>\n\n<p><code>FindWindow(\"CorelDRAW 2020 (64-Bit) - C:\\CompletePath\\FileName.cdr\")</code> </p>\n\n<p>As that is what would be returned from <code>GetWindowText()</code></p>\n\n<p>Obviously this is an issue as you don't know what document a user will have open in the application, so for anyone else who may be coming here, years later, who may be experiencing the same issue, here's what I did.</p>\n\n<pre><code>Option Explicit\nPrivate Module\n\nPrivate Const EXE_NAME As String = \"CorelDRW.exe\"\nPrivate Const WINDOW_TEXT As String = \"CorelDRAW 2020\" ' This is common with all opened documents\n\nPrivate Const GW_HWNDNEXT = 2\nPrivate Const SW_RESTORE = 9\n\nPrivate Declare PtrSafe Function ShowWindow Lib \"user32\" (ByVal hWnd As Long, ByVal nCmdShow As Long) As Long\nPrivate Declare PtrSafe Function GetWindow Lib \"user32\" (ByVal hWnd As Long, ByVal wCmd As Long) As Long\nPrivate Declare PtrSafe Function FindWindow Lib \"user32\" Alias \"FindWindowA\" (ByVal lpClassName As Any, ByVal lpWindowName As Any) As Long\nPrivate Declare PtrSafe Function GetWindowText Lib \"user32\" Alias \"GetWindowTextA\" (ByVal hWnd As Long, ByVal lpString As String, ByVal cch As Long) As Long\n\nPublic Sub FocusIfRunning(parAppName as String, parWindowText as String)\n\n    Dim oProcs As Object\n    Dim lWindowHandle As Long\n    Dim sWindowText As String\n    Dim sBuffer As String\n\n    ' Create WMI object and execute a WQL query statement to find if your application\n    ' is a running process. The query will return an SWbemObjectSet.\n\n    Set oProcs = GetObject(\"winmgmts:\").ExecQuery(\"SELECT * FROM win32_process WHERE \" &amp; _\n                            \"name = '\" &amp; parAppName &amp; \"'\")\n\n    ' The Count property of the SWbemObjectSet will be &gt; 0 if there were\n    ' matches to your query.\n\n    If oProcs.Count &gt; 0 Then\n\n        ' Go through all the handles checking if the start of the GetWindowText()\n        ' result matches your WindowText pre-file name.\n        ' GetWindowText() needs a buffer, that's what the Space(255) is.\n\n        lWindowHandle = FindWindow(vbEmpty, vbEmpty)\n\n        Do While lWindowHandle\n\n            sBuffer = Space(255)\n            sWindowText = Left(sBuffer, GetWindowText(lWindowHandle, sBuffer, 255))\n\n            If Mid(sWindowText, 1, Len(parWindowText)) Like parWindowText Then Exit Do\n\n            ' Get the next handle. Will return 0 when there are no more.\n\n            lWindowHandle = GetWindow(lWindowHandle, GW_HWNDNEXT)\n\n        Loop\n\n        Call ShowWindow(lWindowHandle , SW_RESTORE)\n\n    End If\n\nEnd Sub\n\nPrivate Sub btnFocusWindow_Click()\n    Call FocusIfRunning(EXE_NAME, WINDOW_TEXT)\nEnd Sub\n</code></pre>\n\n<p>Hopefully somebody gets use from this and doesn't have to spend the time on it I did.</p>\n"}], "owner": {"reputation": 4365, "user_id": 1887723, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/nNfYR.png?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/1887723/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29149, "favorite_count": 4, "accepted_answer_id": 29807805, "answer_count": 4, "score": 9, "last_activity_date": 1590212546, "creation_date": 1429732977, "question_id": 29807691, "link": "https://stackoverflow.com/questions/29807691/determine-if-application-is-running-with-excel", "title": "Determine if application is running with Excel", "body": "<h2>Goal</h2>\n\n<p>Have an Excel file with a \"Search\" button that opens a custom program. This program is used for researches. If the program is already opened when the user clicks on the button, make it popup and focus on that given program.</p>\n\n<h2>Current Situation</h2>\n\n<p>Here's the code I'm trying to use to make it work:</p>\n\n<p><strong>Search Button</strong></p>\n\n<pre><code>Private Sub btnSearch_Click()\n    Dim x As Variant\n    Dim Path As String\n\n    If Not IsAppRunning(\"Word.Application\") Then\n        Path = \"C:\\Tmp\\MyProgram.exe\"\n        x = Shell(Path, vbNormalFocus)\n    End If\nEnd Sub\n</code></pre>\n\n<p><strong>IsAppRunning()</strong></p>\n\n<pre><code>Function IsAppRunning(ByVal sAppName) As Boolean\n    Dim oApp As Object\n    On Error Resume Next\n    Set oApp = GetObject(, sAppName)\n    If Not oApp Is Nothing Then\n        Set oApp = Nothing\n        IsAppRunning = True\n    End If\nEnd Function\n</code></pre>\n\n<p>This code will work only when I put \"Word.Application\" as the executable. If I try to put \"MyProgram.Application\" the function will never see the program is running. How can I find that \"MyProgram.exe\" is currently opened?</p>\n\n<p>Further more, I'd need to put the focus on it...</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1429733631, "post_id": 29807579, "comment_id": 47743879, "body": "Do the answers to <a href=\"http://superuser.com/questions/284022/comparing-two-strings-in-excel\">this question</a> give you the answer? To sum up, if you just put <code>=EXACT(A1,B1)</code> in <code>C1</code> and copy down to you&#39;ll get the boolean value for whether or not they match, without having to use VBA. To  get match / not match, just put that boolean into an <code>IF</code>-statement."}, {"owner": {"reputation": 17, "user_id": 4275943, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d8986bde2ec903534530d81f29825e12?s=128&d=identicon&r=PG", "display_name": "saurabh sharma", "link": "https://stackoverflow.com/users/4275943/saurabh-sharma"}, "reply_to_user": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1429734008, "post_id": 29807579, "comment_id": 47744078, "body": "@eirikdaude i have tried this EXACT statement, for cases like YES &amp; yEs it gives me value as false although these 2 strings are equal."}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1429734200, "post_id": 29807579, "comment_id": 47744208, "body": "Does <code>=A1=B1</code> work? It seems to do when I test it, while <code>EXACT</code> gives me the same results as for you. If it works I&#39;ll write my comments up as an answer and delete the comments."}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 1, "creation_date": 1429738275, "post_id": 29807579, "comment_id": 47746561, "body": "If you want to match regardless of case, convert both cells with <code>UPPER</code>. So <code>=UPPER(A1)=UPPER(B1)</code> will return true or false."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1429776964, "post_id": 29807579, "comment_id": 47761930, "body": "A simple equality test will not be case-sensitive as a formula so there is no need for case conversion here."}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1429785424, "post_id": 29807579, "comment_id": 47768015, "body": "If you want to do this in VBA you would use <code>StrComp()</code>."}], "answers": [{"tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": true, "score": 0, "last_activity_date": 1429741014, "creation_date": 1429741014, "answer_id": 29809929, "question_id": 29807579, "link": "https://stackoverflow.com/questions/29807579/string-comparison-in-excel-vba/29809929#29809929", "title": "String comparison in Excel VBA", "body": "<p>You don't really need VBA to do this, but if yes then you can simply write an UDF specifying (on top of the module) that you're using the <a href=\"http://chandoo.org/wp/2011/12/01/case-in-sensitive-string-compare-vba/\" rel=\"nofollow\">Compare text</a> option.</p>\n\n<pre><code>Option Compare Text\nPublic Function compareText(ByVal str1 As String, ByVal str2 As String) As String\n\n    If str1 = str2 Then\n        compareText = \"Match\"\n    Else\n        compareText = \"Do not match\"\n    End If\n\nEnd Function\n</code></pre>\n\n<p>Once this is added, say you have the data in cells <code>A1</code> and <code>B1</code>, then you simply add into the cell <code>C1</code> the formula <code>=compareText(A1,B1)</code> and you scroll it down for the other values. </p>\n\n<p>Please note that this is the most efficient approach, since the <code>Option Compare Text</code> will perform a binary comparison of the strings (not having to convert to <code>UPPER</code> any string before comparing, something that would affect performance if the amount of data is really huge as you say).</p>\n"}], "owner": {"reputation": 17, "user_id": 4275943, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d8986bde2ec903534530d81f29825e12?s=128&d=identicon&r=PG", "display_name": "saurabh sharma", "link": "https://stackoverflow.com/users/4275943/saurabh-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3234, "favorite_count": 0, "accepted_answer_id": 29809929, "answer_count": 1, "score": 0, "last_activity_date": 1429741014, "creation_date": 1429732631, "last_edit_date": 1429734291, "question_id": 29807579, "link": "https://stackoverflow.com/questions/29807579/string-comparison-in-excel-vba", "title": "String comparison in Excel VBA", "body": "<p>There is a huge set of data in two columns. I have to print whether the two strings are matching or not into a third column as match/not match.</p>\n\n<pre><code>For example-  YES &amp; YeS match\n              yes &amp; YES match\n              ye2 &amp; yes No match &amp; so on\n</code></pre>\n\n<p>I have been doing this manually, checking values in each column then writing as match/no match. Would appreciate some help to make the process automated.</p>\n"}, {"tags": ["vba", "excel", "vbscript"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1429731213, "post_id": 29807148, "comment_id": 47742333, "body": "Can you post more of the code? I see you&#39;re using &quot;Selection&quot; a lot, which can cause errors (you want to <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">avoid</a> using &quot;select&quot; whenever possible)."}, {"owner": {"reputation": 231, "user_id": 4783170, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1c983d95d2e9c8daa7867dacd4a02d29?s=128&d=identicon&r=PG&f=1", "display_name": "asdfasfd", "link": "https://stackoverflow.com/users/4783170/asdfasfd"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1429731404, "post_id": 29807148, "comment_id": 47742446, "body": "@user3578951 That&#39;s the vba macro excel generated. Instead of selection I need to make it apply to a specific row since the excel object is hidden until it&#39;s finished the script. I&#39;ll edit what I did but I know it&#39;s wrong. I did get the constants in but I&#39;m not sure where to go from there."}, {"owner": {"reputation": 114165, "user_id": 13087, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/260e2731006271646d36705a95c4db48?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/13087/joe"}, "edited": false, "score": 0, "creation_date": 1429732347, "post_id": 29807148, "comment_id": 47743045, "body": "You&#39;ll get more help if you post code for a minimal, complete, verifiable example (<a href=\"http://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>) and explain what result you expect, and what result you obtain."}], "answers": [{"comments": [{"owner": {"reputation": 231, "user_id": 4783170, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1c983d95d2e9c8daa7867dacd4a02d29?s=128&d=identicon&r=PG&f=1", "display_name": "asdfasfd", "link": "https://stackoverflow.com/users/4783170/asdfasfd"}, "edited": false, "score": 0, "creation_date": 1429732842, "post_id": 29807544, "comment_id": 47743381, "body": "that worked, thank you so much"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1429732489, "creation_date": 1429732489, "answer_id": 29807544, "question_id": 29807148, "link": "https://stackoverflow.com/questions/29807148/convert-vba-code-to-run-in-vbscript/29807544#29807544", "title": "Convert VBA code to run in vbscript", "body": "<p>Untested:</p>\n\n<pre><code>Dim rng, fc, rowNum, finalRowNum, objWorkSheet\n\n'...\n'...\nSet rng = objWorkSheet.Range(\"K\" &amp; rowNum + 2)\n\n'vbscript doesn't support named arguments, only positional\nSet fc = rng.FormatConditions.Add(1, 2, _\n                                 \"=$I$\" &amp; finalRowNum, _\n                                 \"=$J$\" &amp; finalRowNum)\nfc.SetFirstPriority\n\nWith fc.Interior\n    .PatternColorIndex = -4105\n    .Color = 255\n    .TintAndShade = 0\nEnd With\n\nfc.StopIfTrue = False\n</code></pre>\n"}], "owner": {"reputation": 231, "user_id": 4783170, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1c983d95d2e9c8daa7867dacd4a02d29?s=128&d=identicon&r=PG&f=1", "display_name": "asdfasfd", "link": "https://stackoverflow.com/users/4783170/asdfasfd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 384, "favorite_count": 0, "closed_date": 1429893295, "accepted_answer_id": 29807544, "answer_count": 1, "score": 1, "last_activity_date": 1429733999, "creation_date": 1429731093, "last_edit_date": 1429733999, "question_id": 29807148, "link": "https://stackoverflow.com/questions/29807148/convert-vba-code-to-run-in-vbscript", "closed_reason": "Duplicate", "title": "Convert VBA code to run in vbscript", "body": "<p>I have this VBA code for conditional formatting.</p>\n\n<pre><code>Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlNotBetween, _\n    Formula1:=\"=$I$10\", Formula2:=\"=$J$10\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 255\n    .TintAndShade = 0\nEnd With\n     Selection.FormatConditions(1).StopIfTrue = False\nEnd Sub\n</code></pre>\n\n<p>I have a vbscript that creates an Excel sheet and I need to apply that VBA code to a cell in the Excel sheet as it is created. Having issues getting it to run. I know I need to sub the actual values for the excel constants but there's more to it I just don't get</p>\n\n<p>What I've done so far</p>\n\n<pre><code>     priceRange = \"K\"&amp;rowNum + 2\n     objWorkSheet.Range(priceRange).FormatConditions.Add Type:=1, Operator:=2, Formula1:=\"=$I$\"&amp;finalRowNum + 1&amp;\"\", Formula2:=\"=$J$\"&amp;finalRowNum + 1&amp;\"\"\n     objWorkSheet.Range(priceRange).FormatConditions(objExcel.Selection.FormatConditions.Count).SetFirstPriority\n     objWorkSheet.Range(priceRange).FormatConditions(1).Interior.PatternColorIndex = -4105\n     objWorkSheet.Range(priceRange).FormatConditions(1).Interior.Color = 255\n     objWorkSheet.Range(priceRange).FormatConditions(1).Interior.TintAndShade = 0\n     objWorkSheet.Range(priceRange).FormatConditions(1).StopIfTrue = False\n</code></pre>\n\n<p>I need it to apply the conditional formatting to the a specific cell (the one I defined as priceRange)</p>\n"}, {"tags": ["excel", "if-statement", "multiple-conditions", "vba"], "comments": [{"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1429732728, "post_id": 29807137, "comment_id": 47743303, "body": "What are the four conditions? From your <code>IF</code>-statement I interpret them as <code>condition1 = CBool([raport_glowny.Cells(i, R_delivedate_C) = Date(Arkusz6.DeliveryDaySMS)])</code>, <code>condition2 = CBool([raport_glowny.Cells(i, R_deliverytime_C &gt;= CDate(Arkusz6.DeliveryHourSMS)])</code>, <code>condition3 = CBool([raport_glowny.Cells(i, R_deliverytime_C &lt; CDate(Arkusz6.DeliveryHourSMS)])</code>, and <code>condition4 = CBool([raport_glowny.Cells(i, R_deliverytime_C).Value &gt; 0])</code>. Is this correct?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1429732792, "post_id": 29807137, "comment_id": 47743345, "body": "You say &quot;If condition 4 is true then ignore other conditions&quot; but then below you have acceptable condition(s) where Condition 4 is false. Which is it? I notice that Condition 3 is always TRUE. Also what about (TRUE OR TRUE) AND (TRUE OR TRUE)? Is that a potential solution?"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 2, "creation_date": 1429758572, "post_id": 29807137, "comment_id": 47753603, "body": "Might as well give sample data and expected result."}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1429759510, "post_id": 29807137, "comment_id": 47753896, "body": "What you have right now is basically this: <code>If FirstCheck Or SecondCheck And ThirdCheck Then</code> ... Clearly this is an issue with parenthesis. You might consider breaking these boolean values out into functions to make it easier to read and then putting it back together afterwards. Also, I don&#39;t completely understand <code>(TRUE or TRUE)</code> as that last condition."}, {"owner": {"reputation": 27, "user_id": 4821060, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nTXEJD9oyeE/AAAAAAAAAAI/AAAAAAAAABo/STi9lxEdDfA/photo.jpg?sz=128", "display_name": "Ketyas", "link": "https://stackoverflow.com/users/4821060/ketyas"}, "reply_to_user": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1429797284, "post_id": 29807137, "comment_id": 47777546, "body": "@eirikdaude, `condition1=((raport_glowny.Cells(i, R_delivedate_C).Value = CDate(Arkusz6.DeliveryDaySMS)) _ And (raport_glowny.Cells(i, R_deliverytime_C).Value &gt;= CDate(Arkusz6.DeliveryHourSMS.Value))) , condition2=((raport_glowny.Cells(i, R_delivedate_C).Value = CDate(Arkusz6.DeliveryDaySMS) + 1) _ And (raport_glowny.Cells(i, R_deliverytime_C).Value &lt; CDate(Arkusz6.DeliveryHourSMS.Value))), condition3=(raport_glowny.Cells(i, R_deliverytime_C).Value &gt; 0), condition4=(Arkusz6.cbSMSforecast = True)"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1429797501, "post_id": 29807137, "comment_id": 47777719, "body": "What about condition 4?"}, {"owner": {"reputation": 27, "user_id": 4821060, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nTXEJD9oyeE/AAAAAAAAAAI/AAAAAAAAABo/STi9lxEdDfA/photo.jpg?sz=128", "display_name": "Ketyas", "link": "https://stackoverflow.com/users/4821060/ketyas"}, "edited": false, "score": 0, "creation_date": 1429797684, "post_id": 29807137, "comment_id": 47777849, "body": "Condition4 is  Arkusz6.cbSMSforecast = True, &quot;cbSMSforecast&quot; is checkbox, and if i check this box them whole &quot;if&quot; is true"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1429798086, "post_id": 29807137, "comment_id": 47778179, "body": "Then what are those 4 statements that you say your code has to comply with? I assumed that was what you put your condition into in order?"}], "owner": {"reputation": 27, "user_id": 4821060, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nTXEJD9oyeE/AAAAAAAAAAI/AAAAAAAAABo/STi9lxEdDfA/photo.jpg?sz=128", "display_name": "Ketyas", "link": "https://stackoverflow.com/users/4821060/ketyas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1286, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1429759658, "creation_date": 1429731056, "last_edit_date": 1531161705, "question_id": 29807137, "link": "https://stackoverflow.com/questions/29807137/if-vba-multiple-conditions", "title": "If VBA multiple conditions", "body": "<p>I have a problem with my VBA code and instructions <code>IF</code>, I have to use a multi-conditionig, but VBA, if I check the condition 4 as true always ignores other conditions.</p>\n\n<blockquote>\n  <p>((Condition 1) or (Condition 2)) and (condition 3 or condition 4)</p>\n</blockquote>\n\n<p>Needs to macro accepts only the specified options:</p>\n\n<blockquote>\n  <p>((TRUE) or (FALSE)) and (TRUE or FALSE)<br>\n  ((TRUE) or (FALSE)) and (TRUE or TRUE)<br>\n  ((FALSE) or (TRUE)) and (TRUE or FALSE)<br>\n  ((FALSE) or (TRUE)) and (TRUE or TRUE)<br></p>\n</blockquote>\n\n<p>There is real code:</p>\n\n<pre><code>If ((raport_glowny.Cells(i, R_delivedate_C).Value = CDate(Arkusz6.DeliveryDaySMS)) _\nAnd (raport_glowny.Cells(i, R_deliverytime_C).Value &gt;= CDate(Arkusz6.DeliveryHourSMS.Value))) _\nOr ((raport_glowny.Cells(i, R_delivedate_C).Value = CDate(Arkusz6.DeliveryDaySMS) + 1) _\nAnd (raport_glowny.Cells(i, R_deliverytime_C).Value &lt; CDate(Arkusz6.DeliveryHourSMS.Value))) _\nAnd ((raport_glowny.Cells(i, R_deliverytime_C).Value &gt; 0) _\nOr (Arkusz6.cbSMSforecast = True)) Then\n</code></pre>\n\n<p>If anyone can help I will be very grateful</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1429735635, "post_id": 29806947, "comment_id": 47745041, "body": "What about putting <code>code to handle out of range error</code> in its own procedure and calling it from whichever error handler you want?"}], "answers": [{"comments": [{"owner": {"reputation": 1570, "user_id": 3324507, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/653f2f879a98a201288ef32e6e344163?s=128&d=identicon&r=PG&f=1", "display_name": "sgp667", "link": "https://stackoverflow.com/users/3324507/sgp667"}, "edited": false, "score": 0, "creation_date": 1429795033, "post_id": 29811586, "comment_id": 47775540, "body": "Yup that makes more sense to me"}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 1, "last_activity_date": 1429750031, "creation_date": 1429750031, "answer_id": 29811586, "question_id": 29806947, "link": "https://stackoverflow.com/questions/29806947/vba-selective-error-handling/29811586#29811586", "title": "VBA Selective Error Handling", "body": "<p>Typically you would do this the other way around unless you want to have a Select Case that includes <a href=\"https://support.microsoft.com/en-us/kb/146864\" rel=\"nofollow\">all possible errors you can run into</a>. The typical use for doing something like this is if the error is recoverable.  If you want to do it in the context of the error handler (harder to debug if it <em>isn't</em> recoverable because you lose the information from the original error), I'd do something like this:</p>\n\n<pre><code>Sub correct()\n    On Error GoTo CorrectHandler\n    wrong\n    Exit Sub\nCorrectHandler:\n    Debug.Print Err.Number\nEnd Sub\n\nSub wrong()\n    Dim BadArray(1 To 1) As Variant\n\n    On Error GoTo WrongHandler\n\n    Dim i As Integer\n    i = 1 / 0\n    BadArray(100) = 1\n\n    Exit Sub\nWrongHandler:\n    If Err.Number = 11 Then\n        Debug.Print \"I can divide by 0, no problem.\"\n        Resume Next\n    Else\n        Err.Raise Err.Number\n    End If\nEnd Sub\n</code></pre>\n\n<p>Generally though, it's better to handle these inline.  Turn off the error handler, and then test for an error number:</p>\n\n<pre><code>Sub wrong()\n    Dim BadArray(1 To 1) As Variant\n    Dim i As Integer\n\n    'I think the next line might fail for some reason...\n    On Error Resume Next\n    i = 1 / 0\n    If Err.Number = 11 Then\n        Debug.Print \"I can divide by 0, no problem.\"\n    ElseIf Err.Number &lt;&gt; 0 Then\n        Debug.Print \"What the hell? Didn't expect that.\"\n        Err.Raise Err.Number\n    End If\n    'Turn error handling back on.\n    On Error GoTo 0\n\n    BadArray(100) = 1\nEnd Sub\n</code></pre>\n\n<p>In this case, the out of bounds assignment throws but it get caught in the calling function's handler.</p>\n"}], "owner": {"reputation": 1570, "user_id": 3324507, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/653f2f879a98a201288ef32e6e344163?s=128&d=identicon&r=PG&f=1", "display_name": "sgp667", "link": "https://stackoverflow.com/users/3324507/sgp667"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 1, "accepted_answer_id": 29811586, "answer_count": 1, "score": 2, "last_activity_date": 1429750031, "creation_date": 1429730416, "last_edit_date": 1531164843, "question_id": 29806947, "link": "https://stackoverflow.com/questions/29806947/vba-selective-error-handling", "title": "VBA Selective Error Handling", "body": "<p>How can I trap only particular errors in VBA?</p>\n\n<p>So far I have been raising another error with same number in error handler( the one that I don't want to use for this particualr error) to pass the error to another handler, but that makes my code bloated.</p>\n\n<p>I was wondering if there is a better way?</p>\n\n<p>Example of how I have been doing this thus far:</p>\n\n<pre><code>sub correct()\n    On Error GoTo CorrectHandler\n    wrong\nCorrectHandler:\n    'some code to handle out of range error (aka Err.Number 9)\nEnd Sub\n\nSub wrong()\n    Dim BadArray(1 To 1) as Variant\n    On Error GoTo WrongHandler\n    BadArray(100) = 1\nWrongHandler:\n    Select Case Err.Number\n        Case 9\n            Err.Raise 9\n        'Code to handle other errors\n    End Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 193, "user_id": 1586303, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/42736209bde3ef40c23d29827309c2bb?s=128&d=identicon&r=PG", "display_name": "Chuck", "link": "https://stackoverflow.com/users/1586303/chuck"}, "edited": false, "score": 0, "creation_date": 1429804860, "post_id": 29811973, "comment_id": 47783756, "body": "Yes, this did the trick, thanks very much. I had used code hat Word generated, that&#39;s why I was all hung up on using the <code>Selection</code> object. I also had problems with the loop that surrounded this code - was running into problems with the StoryRanges, which was confusing me, too. The extra <code>End If</code> is from me &quot;whittling down&quot; the code to present to everyone. Anyhow, it&#39;s all working now, thanks again! Chuckles..."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 1, "last_activity_date": 1429752396, "creation_date": 1429752396, "answer_id": 29811973, "question_id": 29806765, "link": "https://stackoverflow.com/questions/29806765/cant-set-footnote-in-word-doc-using-excel-vba/29811973#29811973", "title": "Can&#39;t set footnote in Word doc using Excel VBA", "body": "<p>You are correct that you can't add a footnote inside of a Content Control.  The solution is exactly what you are trying to do - put it in the document after.  The problem is that you are trying to add it using the Selection object. </p>\n\n<p>Since you already have a Range within the context of the Document (oRange), just work with it directly:</p>\n\n<pre><code>'\n' Insert the footnote\n'\n\n'Move the oRange to an \"insertion point\" after the control.\noRange.Start = cc.Range.End + 1\n'Collapse it.\noRange.End = oRange.Start\n'Add your space.\noRange.Text = \" \"\n\nWith oRange.FootnoteOptions\n    .Location = wdBottomOfPage\n    .NumberingRule = wdRestartContinuous\n    .StartingNumber = 1\n    .NumberStyle = wdNoteNumberStyleArabic\n    .LayoutColumns = 0\nEnd With\n\noRange.Footnotes.Add Range:=oRange, Text:=\"Case Opening Date changed from \" &amp; _\n                     strOriginalDate &amp; \" to \" &amp; strCOD &amp; \" on \" &amp; Date\n</code></pre>\n\n<p>There's really no reason to be mucking around with the Selection - it's just a glorified Range with the added benefit of doing all the annoying things that Word does \"for your benefit\" (like grabbing the trailing space) while you're highlighting with the mouse.</p>\n\n<p>I'll also note that you can omit the <code>Reference:=\"\"</code> - it gets set to an empty string by default.  You also have a floating <code>End If</code> inside your With block.</p>\n"}], "owner": {"reputation": 193, "user_id": 1586303, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/42736209bde3ef40c23d29827309c2bb?s=128&d=identicon&r=PG", "display_name": "Chuck", "link": "https://stackoverflow.com/users/1586303/chuck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 548, "favorite_count": 1, "accepted_answer_id": 29811973, "answer_count": 1, "score": 0, "last_activity_date": 1429806565, "creation_date": 1429729742, "last_edit_date": 1429806565, "question_id": 29806765, "link": "https://stackoverflow.com/questions/29806765/cant-set-footnote-in-word-doc-using-excel-vba", "title": "Can&#39;t set footnote in Word doc using Excel VBA", "body": "<p>I have numerous WORD documents that have several Content Controls in them. I am using an Excel file to update the WORD docs. When I make an update, I need to insert a footnote describing the change. I can update the contents of the Content Control just fine, but I am having problems inserting the footnote. Here's my code:</p>\n\n<pre><code>Set cc = oRange.ContentControls(intCounter)\nstrOriginalDate = cc.Range.Text\n\nIf wrdDoc.ProtectionType &lt;&gt; wdNoProtection Then\n    wrdDoc.Unprotect strSheetPassword\nEnd If\n\nIf wrdDoc.FormsDesign = False Then\n    wrdDoc.ToggleFormsDesign\nEnd If\ncc.Range.Text = strCOD\n'\n' Insert the footnote\n'\noRange = wrdDoc.Range(cc.Range.End, cc.Range.End)\noRange.Select\nSelection.MoveRight Units:=wdCharacter, Count:=1\nSelection.TypeText Text:=\" \"\nWith Selection\n    With .FootnoteOptions\n        .Location = wdBottomOfPage\n        .NumberingRule = wdRestartContinuous\n        .StartingNumber = 1\n        .NumberStyle = wdNoteNumberStyleArabic\n        .LayoutColumns = 0\n    End With\n    .Footnotes.Add Range:=cc.Range, Text:=\"Case Opening Date changed from \" &amp; _\n    strOriginalDate &amp; \" to \" &amp; strCOD &amp; \" on \" &amp; Date, Reference:=\"\"\n    End If\nEnd With\n\nwrdDoc.ToggleFormsDesign\nwrdDoc.Protect Type:=wdAllowOnlyFormFields, Password:=strSheetPassword\nwrdDoc.Save\n</code></pre>\n\n<p>When I get down to the line <code>Selection.MoveRight Units:=wdCharacter, Count:=1</code>, I get an error that says <code>Object doesn't support this property or method</code>. In essence, I'm trying to move to the end of the control, then on the next step, I'm trying to move beyond/outside the control.</p>\n\n<p>When I comment out that line and the line that follows it, I end up trying to insert the footnote into the content control. That fails on the <code>With .FootnoteOptions</code> line, possibly because the content control I'm using is a date picker.</p>\n"}, {"tags": ["sql-server", "ms-access", "vba"], "comments": [{"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1429729688, "post_id": 29806595, "comment_id": 47741365, "body": "What ahve you tried so far? Have you looked at the <code>ADODB.Connection</code> for your transaction processing, and <code>ADODB.Command</code> for your parameterized queries? All the queries can be Sql Server stored procedures if that makes it easier."}, {"owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 0, "creation_date": 1429747182, "post_id": 29806595, "comment_id": 47750105, "body": "<i>&quot;Does using ADO and BeginTrans make the most sense for me?&quot;</i> - It certainly sounds like a good place to start. Give it a try and let us know if you need further assistance."}], "owner": {"reputation": 2688, "user_id": 2718295, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7a0108422b842227a6b9cc92a5c114a5?s=128&d=identicon&r=PG", "display_name": "cowbert", "link": "https://stackoverflow.com/users/2718295/cowbert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 164, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1429729210, "creation_date": 1429729210, "question_id": 29806595, "link": "https://stackoverflow.com/questions/29806595/sql-server-transactions-and-parameterized-queries-from-access-2007-dao-ado", "title": "SQL Server transactions and parameterized queries from Access 2007 (DAO? ADO?)", "body": "<p>I am being forced to port a SQL load script to VBA in Access 2007 where I read flatfiles and then insert into SQL Server (using ODBC and parameterized query strings). Can someone post a full example of how to use either DAO querydef or ADO so that my inserts are executed in a single transaction on the SQL Server? I not need linked tables, file is read and all transforms are done in VBA prior to insert and done using stored procs and triggers in SQL Server after the load. But I do need to be able to rollback my multiple-inserts if there is an ODBC error.</p>\n\n<p>None of the other stackoverflow posts I've found make much sense to me; all I know is that \"ODBCDirect workspaces\" are not supported in Access 2007. Does using ADO and BeginTrans make the most sense for me?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 43, "user_id": 3478792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/016f318157fecd282a08871992eb0d78?s=128&d=identicon&r=PG&f=1", "display_name": "Bhavya", "link": "https://stackoverflow.com/users/3478792/bhavya"}, "edited": false, "score": 0, "creation_date": 1429729687, "post_id": 29806365, "comment_id": 47741364, "body": "Using the SheetName explicitly helped get over the error. Given that the chart is on a different sheet than the data sheet, I guess I could not sue the <code>ActiveSheet</code>. However, given that I had renamed the sheet earlier, I guess I cant even use the <code>wbk.Sheets(1)</code>. Using the name explicitly worked."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1429759362, "post_id": 29806365, "comment_id": 47753841, "body": "What do you want to accomplish? Can you illustrate it?"}], "owner": {"reputation": 43, "user_id": 3478792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/016f318157fecd282a08871992eb0d78?s=128&d=identicon&r=PG&f=1", "display_name": "Bhavya", "link": "https://stackoverflow.com/users/3478792/bhavya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 373, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1429730418, "creation_date": 1429728455, "last_edit_date": 1429730418, "question_id": 29806365, "link": "https://stackoverflow.com/questions/29806365/creating-a-chart-and-adding-new-series-to-it", "title": "Creating a chart and adding new series to it", "body": "<p>I am trying to add a new chart to my workbook using the code below. However, every time I try to run it, I get the error <code>object doesn't support this property or method</code> on the Name property. I tried to use the fully qualified workbook name as well but still no luck. Code:</p>\n\n<pre><code>Charts.Add\nWith ActiveChart.SeriesCollection.NewSeries\n        .Name = ActiveSheet.Range(\"A2\")\n        .Values = ActiveSheet.Range(\"B2:AK2\")\n        .XValues = ActivehSheet.Range(\"A2:A7\")\nEnd With\n</code></pre>\n\n<p>I even tried using the code in the following way:</p>\n\n<pre><code>Charts.Add\nWith ActiveChart.SeriesCollection.NewSeries\n        .Name = finalViewsWbk.Sheets(1).Range(finalViewsWbk.Sheets(1).Cells(2, 1))\n        .Values = finalViewsWbk.Sheets(1).Range(\"B2:AK2\")\n        .XValues = finalViewsWbk.Sheets(1).Range(\"A2:A7\")\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 4820891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d1f3f47faa7b3a94d9ae0cdc63263bd?s=128&d=identicon&r=PG&f=1", "display_name": "alex m", "link": "https://stackoverflow.com/users/4820891/alex-m"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1429733684, "post_id": 29806017, "comment_id": 47743905, "body": "Thank you, I updated my post"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4820891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d1f3f47faa7b3a94d9ae0cdc63263bd?s=128&d=identicon&r=PG&f=1", "display_name": "alex m", "link": "https://stackoverflow.com/users/4820891/alex-m"}, "edited": false, "score": 0, "creation_date": 1429789507, "post_id": 29806243, "comment_id": 47771059, "body": "How do I make your macro to continue selecting and not just stop at the first one found? Sorry, I have no experience with this"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 1, "user_id": 4820891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d1f3f47faa7b3a94d9ae0cdc63263bd?s=128&d=identicon&r=PG&f=1", "display_name": "alex m", "link": "https://stackoverflow.com/users/4820891/alex-m"}, "edited": false, "score": 0, "creation_date": 1429791310, "post_id": 29806243, "comment_id": 47772417, "body": "@alexm  see my <b>EDIT#1</b>"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1429791282, "last_edit_date": 1429791282, "creation_date": 1429728084, "answer_id": 29806243, "question_id": 29806017, "link": "https://stackoverflow.com/questions/29806017/selecting-data-cells-with-data-cells-under-them/29806243#29806243", "title": "selecting data cells with data cells under them", "body": "<p>Here is an example for a typical column, column <strong>C</strong>:</p>\n\n<pre><code>Sub CSelect()\n    Dim kolumn As String, N As Long\n    Dim i As Long\n    kolumn = \"C\"\n    N = Cells(Rows.Count, kolumn).End(xlUp).Row\n    For i = 1 To N\n        If Cells(i, kolumn).Value &lt;&gt; \"\" And Cells(i + 1, kolumn).Value &lt;&gt; \"\" Then\n            Cells(i, kolumn).Select\n            Exit Sub\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/DyL96.png\" alt=\"enter image description here\"></p>\n\n<p>NOTE:</p>\n\n<p>This will only select the first cell meeting the selection criteria.</p>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>The sub will <em>Select</em> all the cells in a column meeting the criteria:</p>\n\n<pre><code>Sub CSelectALL()\n    Dim kolumn As String, N As Long\n    Dim i As Long, rng As Range\n    kolumn = \"C\"\n    N = Cells(Rows.Count, kolumn).End(xlUp).Row\n    Set rng = Nothing\n\n    For i = 1 To N\n        If Cells(i, kolumn).Value &lt;&gt; \"\" And Cells(i + 1, kolumn).Value &lt;&gt; \"\" Then\n            If rng Is Nothing Then\n                Set rng = Cells(i, kolumn)\n            Else\n                Set rng = Union(rng, Cells(i, kolumn))\n            End If\n        End If\n    Next i\n\n    If rng Is Nothing Then\n    Else\n        rng.Select\n    End If\nEnd Sub\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/iKpm7.png\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 1, "user_id": 4820891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d1f3f47faa7b3a94d9ae0cdc63263bd?s=128&d=identicon&r=PG&f=1", "display_name": "alex m", "link": "https://stackoverflow.com/users/4820891/alex-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429791282, "creation_date": 1429727345, "last_edit_date": 1429733467, "question_id": 29806017, "link": "https://stackoverflow.com/questions/29806017/selecting-data-cells-with-data-cells-under-them", "title": "selecting data cells with data cells under them", "body": "<p>is it possible to select cells in excel that are only above cells with data (the cell below the one that needs to be selected needs to have data)? if every cell in a column has data then only the top cell should be selected. if there is no data cells above or below the cell then it should not be selected. Thank you</p>\n\n<p>I found this macro to select all data cells in range, is it possible to add an IF for the \"data below\" into this? I tried, Im really green with VBA. Thank you.</p>\n\n<pre><code>Sub SelectNotBlackRange()\n'Update20131220\nDim Rng As Range\nDim WorkRng As Range\nDim OutRng As Range\nOn Error Resume Next\nxTitleId = \"KutoolsforExcel\"\nSet WorkRng = Application.Selection\nSet WorkRng = Application.InputBox(\"Range\", xTitleId, WorkRng.Address, Type:=8)\nFor Each Rng In WorkRng\n    If Rng.Value &lt;&gt; \"\" Then\n        If OutRng Is Nothing Then\n            Set OutRng = Rng\n        Else\n            Set OutRng = Union(OutRng, Rng)\n        End If\n    End If\nNext\nIf Not OutRng Is Nothing Then\n    OutRng.Select\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "pdf"], "comments": [{"owner": {"reputation": 321, "user_id": 3026842, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4b0ddfd1473f28b90224090f001dd1ad?s=128&d=identicon&r=PG&f=1", "display_name": "arbitel", "link": "https://stackoverflow.com/users/3026842/arbitel"}, "edited": false, "score": 0, "creation_date": 1429730768, "post_id": 29805578, "comment_id": 47742041, "body": "I did get this to work for now by hiding all Sheets by name if they&#39;re not between Sheet3 and Sheet &quot;Post&quot;. Kind of a manual workaround as if there&#39;s a sheet in the future added that needs to be hidden outside of the Sheet 3 to &quot;Post&quot; then I&#39;ll have to go in and add code to hide. I&#39;m still searching for an answer and will post solution if I find!"}], "answers": [{"comments": [{"owner": {"reputation": 321, "user_id": 3026842, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4b0ddfd1473f28b90224090f001dd1ad?s=128&d=identicon&r=PG&f=1", "display_name": "arbitel", "link": "https://stackoverflow.com/users/3026842/arbitel"}, "edited": false, "score": 0, "creation_date": 1429729342, "post_id": 29805940, "comment_id": 47741124, "body": "Playing around with this idea. Although, I don&#39;t think I want to subtract to from i as I&#39;m trying to capture Sheet 3 to &quot;Post&quot;. Thanks for response, I&#39;ll play around with this idea and see if I can get it to work"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 321, "user_id": 3026842, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4b0ddfd1473f28b90224090f001dd1ad?s=128&d=identicon&r=PG&f=1", "display_name": "arbitel", "link": "https://stackoverflow.com/users/3026842/arbitel"}, "edited": false, "score": 0, "creation_date": 1429729820, "post_id": 29805940, "comment_id": 47741452, "body": "@user3026842 the <code>aSheetnames()</code> array starts at 1, while <code>i</code> starts at 3. If you don&#39;t subtract 2 from it, you&#39;ll end up with 2 empty spots in the array, and I&#39;m not sure what that would do to the <code>.ExportAsFixedFormat</code>. But, as I said, untested code to push you in a possibly right direction, so see where it gets you."}, {"owner": {"reputation": 321, "user_id": 3026842, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4b0ddfd1473f28b90224090f001dd1ad?s=128&d=identicon&r=PG&f=1", "display_name": "arbitel", "link": "https://stackoverflow.com/users/3026842/arbitel"}, "edited": false, "score": 0, "creation_date": 1429730051, "post_id": 29805940, "comment_id": 47741590, "body": "Ah gotcha, thanks for explanation. I&#39;m in the very early stages of VBA learning. I think this will work, I&#39;ll letcha know"}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 1, "last_activity_date": 1429727119, "creation_date": 1429727119, "answer_id": 29805940, "question_id": 29805578, "link": "https://stackoverflow.com/questions/29805578/changing-vba-that-creates-multiple-pdfs-to-single-pdf/29805940#29805940", "title": "Changing VBA that creates Multiple PDFs to Single PDF", "body": "<p>If you select multiple worksheet tabs with the mouse, then select print, it will print them all as one print job, so give it a try in code:</p>\n\n<pre><code>Sub SaveAllPDF()\nDim i As Integer\nDim Fname As String\nDim TabCount As Long\nDim aSheetnames As Variant\n\nTabCount = Sheets(\"Post\").Index\n'Set the TabCount to the last cell you want to PDF\n\nDim dialog As FileDialog\nDim path As String\n\nSet dialog = Application.FileDialog(msoFileDialogFolderPicker)\ndialog.AllowMultiSelect = False\nIf dialog.Show = -1 Then\n    path = dialog.SelectedItems(1)\n    ' Begin the loop.\n    For i = 3 To TabCount\n    'Set i = the number of the first sheet you want to PDF in order from left to right To TabCount\n        If Sheets(i).Visible &lt;&gt; xlSheetVisible Then\n        Else\n            redim preserve aSheetnames(i-2)  'subtract 2, since i starts at 3\n            asheetnames(i-2) = sheets(i).name  'build array of the sheets to print\n        End If\n     Next\n     Fname = 'make something up here for your bulk file name\n     Sheets(asheetnames).ExportAsFixedFormat Type:=xlTypePDF, FileName:=path &amp; \"\\\" &amp; Fname, Quality:=xlQualityStandard, _\n                IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=True\n\nEnd If\nEnd Sub\n</code></pre>\n\n<p><strong>NOTE</strong>: No guarantees expressed or implied, you may have to do some debugging, as this is off the top of my head, but it just might work...</p>\n"}, {"comments": [{"owner": {"reputation": 321, "user_id": 3026842, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4b0ddfd1473f28b90224090f001dd1ad?s=128&d=identicon&r=PG&f=1", "display_name": "arbitel", "link": "https://stackoverflow.com/users/3026842/arbitel"}, "edited": false, "score": 0, "creation_date": 1429729225, "post_id": 29805961, "comment_id": 47741041, "body": "Thanks for response. Unfortunately, Acrobat can&#39;t be assumed to be on each machine and I have no control over that. There&#39;s a changing # of sheets outside of Worksheet 3 to &quot;Post&quot; that can&#39;t be included in this PDF so Exporting the entire Workbook won&#39;t be an option. Although that did spark an idea to maybe try and hide all sheets outside of Worksheet 3 to &quot;Post&quot; (i.e. hide sheet 1, 2, 16 and on). &quot;Post&quot; is Sheet 14."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 0, "last_activity_date": 1429727187, "creation_date": 1429727187, "answer_id": 29805961, "question_id": 29805578, "link": "https://stackoverflow.com/questions/29805578/changing-vba-that-creates-multiple-pdfs-to-single-pdf/29805961#29805961", "title": "Changing VBA that creates Multiple PDFs to Single PDF", "body": "<p>Instead of exporting each worksheet <strong>inside</strong> the loop, export the entire workbook <strong>outside</strong> the loop with <a href=\"https://msdn.microsoft.com/en-us/library/office/ff198122.aspx\" rel=\"nofollow\">Workbook.ExportAsFixedFormat</a>.</p>\n\n<p>With this method, arguments <code>From</code> and <code>To</code> allow you to select what pages to output. However, you need to know where the visible worksheets page numbers lie. It may not necessarily be per their worksheet number as some worksheets can print into multiple pages. Find page numbers by manually saving entire workbook in PDF.</p>\n\n<p>Alternatively, you can continue with your loop and combine multiple PDFs using the <a href=\"http://www.adobe.com/content/dam/Adobe/en/devnet/acrobat/pdfs/iac_api_reference.pdf\" rel=\"nofollow\">Adobe Acrobat SDK</a>. See <code>AcroExch.AvDoc</code> and <code>AcroExch.PDDoc</code> objects. However, users of your Excel workbook will need to have Adobe Acrobat (not just the free Reader) installed on their machines to reference the Adobe API in VBA.</p>\n"}, {"comments": [{"owner": {"reputation": 321, "user_id": 3026842, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4b0ddfd1473f28b90224090f001dd1ad?s=128&d=identicon&r=PG&f=1", "display_name": "arbitel", "link": "https://stackoverflow.com/users/3026842/arbitel"}, "edited": false, "score": 0, "creation_date": 1429729464, "post_id": 29806240, "comment_id": 47741202, "body": "Thanks for response! Looking into how I can make sure all sheets outside of Sheet 3 to &quot;Post&quot; are hidden while keeping the sheets between Sheet 3 to &quot;Post&quot; unaffected and then applying the regular export as PDF code you mentioned. I&#39;ll post if I can get it to work"}], "tags": [], "owner": {"reputation": 98, "user_id": 4768222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01a95e0c39b1991cb1e7f2f85d820ca4?s=128&d=identicon&r=PG&f=1", "display_name": "Kdean571", "link": "https://stackoverflow.com/users/4768222/kdean571"}, "is_accepted": false, "score": 1, "last_activity_date": 1429728080, "creation_date": 1429728080, "answer_id": 29806240, "question_id": 29805578, "link": "https://stackoverflow.com/questions/29805578/changing-vba-that-creates-multiple-pdfs-to-single-pdf/29806240#29806240", "title": "Changing VBA that creates Multiple PDFs to Single PDF", "body": "<p>This works in my file for emailing visible tabs as pdf's your use while different the same applies...you don't need to code for hidden/not hidden with this </p>\n\n<pre><code>' Export activesheet as PDF\n With ActiveWorkbook\n      .ExportAsFixedFormat Type:=xlTypePDF, Filename:=PdfFile,  \n              Quality:=xlQualityStandard, IncludeDocProperties:=True,     \n                     IgnorePrintAreas:=False, OpenAfterPublish:=False\n End With\n</code></pre>\n"}], "owner": {"reputation": 321, "user_id": 3026842, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4b0ddfd1473f28b90224090f001dd1ad?s=128&d=identicon&r=PG&f=1", "display_name": "arbitel", "link": "https://stackoverflow.com/users/3026842/arbitel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 680, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1429728080, "creation_date": 1429725851, "question_id": 29805578, "link": "https://stackoverflow.com/questions/29805578/changing-vba-that-creates-multiple-pdfs-to-single-pdf", "title": "Changing VBA that creates Multiple PDFs to Single PDF", "body": "<p>The code below is working great to create PDFs from Worksheet 3 to the Worksheet named \"Post\" while ignoring any hidden sheets.  It creates an individual PDF for each of these worksheets. This is linked to a shape that users click and are then prompted to select a folder to save all the PDFs.</p>\n\n<p><strong>I'm trying to alter the code below to do the exact same thing EXCEPT create a single PDF with each visible worksheet between sheet 3 and \"Post\".</strong></p>\n\n<p>I've been massaging the code around for a while and am wondering if anyone knows the best way to accomplish this?</p>\n\n<pre><code>Sub SaveAllPDF()\nDim i As Integer\nDim Fname As String\nDim TabCount As Long\n\nTabCount = Sheets(\"Post\").Index\n'Set the TabCount to the last cell you want to PDF\n\nDim dialog As FileDialog\nDim path As String\n\nSet dialog = Application.FileDialog(msoFileDialogFolderPicker)\ndialog.AllowMultiSelect = False\nIf dialog.Show = -1 Then\n    path = dialog.SelectedItems(1)\n    ' Begin the loop.\n    For i = 3 To TabCount\n    'Set i = the number of the first sheet you want to PDF in order from left to right To TabCount\n        If Sheets(i).Visible &lt;&gt; xlSheetVisible Then\n        Else\n            With Sheets(i)\n                Fname = .Range(\"C15\") &amp; \" \" &amp; .Range(\"E13\") &amp; \"-\" &amp; .Range(\"B1\")\n                'The Fname above is equaling the cells that the PDF's filename will be\n                'The folder directory below is where the PDF files will be saved\n                .ExportAsFixedFormat Type:=xlTypePDF, FileName:=path &amp; \"\\\" &amp; Fname, Quality:=xlQualityStandard, _\n                IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=False\n            End With\n        End If\n    Next i\n\n    Call Shell(\"explorer.exe\" &amp; \" \" &amp; path &amp; \"\\\", vbNormalFocus)\n    'This opens the folder where the PDFs are saved\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "range", "max", "named"], "answers": [{"comments": [{"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 2, "creation_date": 1429726225, "post_id": 29805472, "comment_id": 47739199, "body": "The inner <code>MAX</code> functions are redundant, so the equivalent would be <code>&quot;=MAX(Named_Range1,Named_Range2,Named_Range3)&quot;</code>"}], "tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 0, "last_activity_date": 1429725491, "creation_date": 1429725491, "answer_id": 29805472, "question_id": 29805251, "link": "https://stackoverflow.com/questions/29805251/maximum-of-multiple-named-ranges/29805472#29805472", "title": "Maximum of Multiple Named Ranges", "body": "<p>For the result to be placed in F9, please try:  </p>\n\n<pre><code>Sub Maximal()\n   Range(\"F9\").Formula = \"=MAX(MAX(Named_Range1),MAX(Named_Range2),MAX(Named_Range3))\"\nEnd Sub \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "is_accepted": true, "score": 0, "last_activity_date": 1429727619, "creation_date": 1429727619, "answer_id": 29806097, "question_id": 29805251, "link": "https://stackoverflow.com/questions/29805251/maximum-of-multiple-named-ranges/29806097#29806097", "title": "Maximum of Multiple Named Ranges", "body": "<p>If you don't want to place the formula in one of the cells and calculate the result in VBA code, you can also use the following code:</p>\n\n<pre><code>Dim rng1 As Range, rng2 As Range, rng3 As Range\nDim y As Double\n\nSet rng1 = ThisWorkbook.Names(\"Named_Range1\").RefersToRange\nSet rng2 = ThisWorkbook.Names(\"Named_Range2\").RefersToRange\nSet rng3 = ThisWorkbook.Names(\"Named_Range3\").RefersToRange\n\ny = WorksheetFunction.Max(rng1, rng2, rng3) \n</code></pre>\n\n<p>If named ranges are in another workbook, replace <code>ThisWorkbook</code> with <code>Workbooks(\"workbook name\")</code></p>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1429729141, "creation_date": 1429729141, "answer_id": 29806570, "question_id": 29805251, "link": "https://stackoverflow.com/questions/29805251/maximum-of-multiple-named-ranges/29806570#29806570", "title": "Maximum of Multiple Named Ranges", "body": "<p>If the three ranges are in the same sheet then:</p>\n\n<pre><code>Sub MaxMax()\n    Dim r As Range\n    Set r = Union(Range(Named_Range1), Range(Named_Range2), Range(Named_Range3))\n    MsgBox Application.WorksheetFunction.Max(r)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 3938366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60ceaa5768478df6064b76b36ee00a17?s=128&d=identicon&r=PG&f=1", "display_name": "Brayson Snow", "link": "https://stackoverflow.com/users/3938366/brayson-snow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 633, "favorite_count": 0, "accepted_answer_id": 29806097, "answer_count": 3, "score": 0, "last_activity_date": 1429729141, "creation_date": 1429724803, "last_edit_date": 1429724862, "question_id": 29805251, "link": "https://stackoverflow.com/questions/29805251/maximum-of-multiple-named-ranges", "title": "Maximum of Multiple Named Ranges", "body": "<p>I am having a lot of trouble with this one. I want to replicate this value in VBA:  </p>\n\n<pre><code>=MAX(MAX(Named_Range1),MAX(Named_Range2),MAX(Named_Range3)) \n</code></pre>\n\n<p>I am having an impossible time trying to get this done.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1429725141, "post_id": 29805193, "comment_id": 47738460, "body": "One very quick way would be to add up all the numbers: <code>a+b+c+d+e+f+g+h=sumtotal</code>, then compare <code>sumtotal</code> with <code>a*8</code>. Basically, <code>if (a*8) = sumtotal then all_numbers_are_equal</code>. Probably quicker than a big logical statement. (and by the way, your first <code>If</code> statement is not proper syntax and will not compile.)"}, {"owner": {"reputation": 31, "user_id": 4820745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbbd3fe8a5844dc2908a4c190e75587e?s=128&d=identicon&r=PG&f=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/4820745/sean"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1429725196, "post_id": 29805193, "comment_id": 47738505, "body": "Yeah I knew that the first statement wouldn&#39;t work, that was supposed to be a demonstration of what I was aiming to do. The solution to add all the numbers up is really helpful, that should solve my problem very easily! Like you said, much quicker than a large series of logical statements!"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1429745717, "post_id": 29805193, "comment_id": 47749619, "body": "@PeterT - That doesn&#39;t work for finding either all unique numbers or finding out if they are all the same.  Consider (in order of a-h): <code>6, 7, 7, 5, 5, 4, 4, 10 --&gt;  (6*8) = 6+7+7+5+5+4+4+10</code>.   Or all unique numbers: <code>6, 1, 8, 5, 10, 2, 9, 7 --&gt; (6*8) = 6+1+8+5+10+2+9+7</code>."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1429796455, "post_id": 29805193, "comment_id": 47776816, "body": "And here I thought I was being clever. @Comintern, you&#39;re perfectly right of course. I added another potential answer below to satisfy my need to at least put out a complete and correct answer ;)"}], "answers": [{"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 1, "last_activity_date": 1429746460, "creation_date": 1429746460, "answer_id": 29810986, "question_id": 29805193, "link": "https://stackoverflow.com/questions/29805193/how-to-check-that-multiple-values-are-not-equal-in-vba/29810986#29810986", "title": "How to check that multiple values are not equal in VBA?", "body": "<p>The quick and dirty way to do this is with a Dictionary, which requires a unique key.  Just keep dumping numbers in from your array until you hit one that's already in the Dictionary.  Just make it into a function and pass your array to it:</p>\n\n<pre><code>Private Function AllUnique(incoming As Variant) As Boolean\n\n    If Not IsArray(incoming) Then Err.Raise 13\n\n    Dim candidates As Scripting.Dictionary\n    Set candidates = New Scripting.Dictionary\n\n    Dim index As Long\n    For index = LBound(incoming) To UBound(incoming)\n        If candidates.Exists(incoming(index)) Then Exit Function\n        candidates.Add incoming(index), index\n    Next index\n\n    AllUnique = True\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "is_accepted": false, "score": 0, "last_activity_date": 1429750330, "last_edit_date": 1429750330, "creation_date": 1429749112, "answer_id": 29811451, "question_id": 29805193, "link": "https://stackoverflow.com/questions/29805193/how-to-check-that-multiple-values-are-not-equal-in-vba/29811451#29811451", "title": "How to check that multiple values are not equal in VBA?", "body": "<p>I am going to throw in the direct comparison method:</p>\n\n<pre><code>Public Function AreEqual(ParamArray values() As Variant) As Boolean\n    Dim i As Long, j As Long, N As Long\n    Dim x As Double\n    N = UBound(values) + 1\n    For i = 1 To N - 1\n        x = values(i - 1)\n        For j = i + 1 To N\n            If values(j - 1) &lt;&gt; x Then\n                AreEqual = False\n                Exit Function\n            End If\n        Next j\n    Next i\n    AreEqual = True\nEnd Function\n</code></pre>\n\n<p>To be used as</p>\n\n<pre><code>If AreEqual(num1,num2,num3,...) then\n   ...\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 0, "last_activity_date": 1429797163, "creation_date": 1429797163, "answer_id": 29825584, "question_id": 29805193, "link": "https://stackoverflow.com/questions/29805193/how-to-check-that-multiple-values-are-not-equal-in-vba/29825584#29825584", "title": "How to check that multiple values are not equal in VBA?", "body": "<p>As a slight variation of the <code>Collection</code> answer given above by @ja72, this function should be able to take any set of simple values of any type and determine if they're all identical or not. (The exception to this being the fourth test line for Strings, in which the <code>Collection</code> key is not case-sensitive.) I'm taking advantage of the hashing algorithm for adding keys to a <code>Collection</code> to ensure unique-ness.</p>\n\n\n\n<pre><code>Option Explicit\n\nSub Test()\n    Debug.Print AllValuesIdentical(14, 14, 14, 14, 14, 14, 14, 14, 14) 'true\n    Debug.Print AllValuesIdentical(5, 5, 5, 5, 5, 3, 5, 5)             'false\n    Debug.Print AllValuesIdentical(\"go\", \"go\", \"go\", \"go\")             'true\n    Debug.Print AllValuesIdentical(\"go\", \"go\", \"go\", \"GO\")             'also true\n    Debug.Print AllValuesIdentical(283.14, 283.14, 283.14)             'true\nEnd Sub\n\nFunction AllValuesIdentical(ParamArray vals() As Variant) As Boolean\n    Dim uniqueCheck As Collection\n    Dim val As Variant\n    Set uniqueCheck = New Collection\n    On Error Resume Next\n    For Each val In vals\n        uniqueCheck.Add val, CStr(val)\n    Next val\n    If uniqueCheck.Count = 1 Then\n        AllValuesIdentical = True\n    Else\n        AllValuesIdentical = False\n    End If\n    On Error GoTo 0\n    Set uniqueCheck = Nothing\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 4820745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbbd3fe8a5844dc2908a4c190e75587e?s=128&d=identicon&r=PG&f=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/4820745/sean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6187, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1429797163, "creation_date": 1429724631, "question_id": 29805193, "link": "https://stackoverflow.com/questions/29805193/how-to-check-that-multiple-values-are-not-equal-in-vba", "title": "How to check that multiple values are not equal in VBA?", "body": "<p>I want to print a list of eight numbers to the worksheet, but only if they are all unique.</p>\n\n<p>An ideal code would be something along the lines of</p>\n\n<pre><code>If a &lt;&gt; b &lt;&gt; c Then\n</code></pre>\n\n<p>Rather than</p>\n\n<pre><code>If a &lt;&gt; b And a &lt;&gt; c And b &lt;&gt; c Then\n</code></pre>\n\n<p>Is this possible, given that the values are called from an array using the code following:</p>\n\n<pre><code>Cells(2, 8) = numarr(i)\nCells(2, 9) = numarr(j)\nCells(2, 10) = numarr(k)\nCells(2, 11) = numarr(l)\nCells(3, 8) = numarr(m)\nCells(3, 9) = numarr(n)\nCells(3, 10) = numarr(o)\nCells(3, 11) = numarr(p)\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1429724648, "post_id": 29805105, "comment_id": 47738113, "body": "If it works when debugging but fails when run straight through, likely it&#39;s a timing issue and your page is not fully loaded, or the element you&#39;re trying to access has not been added to the page&#39;s content.  Try adding a short &quot;wait&quot; before trying to access the element in question."}, {"owner": {"reputation": 39, "user_id": 4820706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2472b88cbd1bfc46f3c4808254054a3?s=128&d=identicon&r=PG&f=1", "display_name": "TheLeastofThese", "link": "https://stackoverflow.com/users/4820706/theleastofthese"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1429724934, "post_id": 29805105, "comment_id": 47738317, "body": "Hi, I added Application.Wait (Now + TimeValue(&quot;0:00:10&quot;)) and this did the trick, is there a better way to do this?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1429725114, "post_id": 29805105, "comment_id": 47738443, "body": "You can wrap the <code>getelementbyid()</code> in a loop until the return value is not <code>Nothing</code> (but you should also add a time limit on how long you&#39;re prepared to wait so you can break out of the loop if the element never appears...)"}, {"owner": {"reputation": 39, "user_id": 4820706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2472b88cbd1bfc46f3c4808254054a3?s=128&d=identicon&r=PG&f=1", "display_name": "TheLeastofThese", "link": "https://stackoverflow.com/users/4820706/theleastofthese"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1429725832, "post_id": 29805105, "comment_id": 47738915, "body": "What would that look like?"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 4820706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2472b88cbd1bfc46f3c4808254054a3?s=128&d=identicon&r=PG&f=1", "display_name": "TheLeastofThese", "link": "https://stackoverflow.com/users/4820706/theleastofthese"}, "edited": false, "score": 0, "creation_date": 1429793312, "post_id": 29806761, "comment_id": 47774098, "body": "I am struggling to get this to work, where do I apply this? Sorry for the simple questions!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 39, "user_id": 4820706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2472b88cbd1bfc46f3c4808254054a3?s=128&d=identicon&r=PG&f=1", "display_name": "TheLeastofThese", "link": "https://stackoverflow.com/users/4820706/theleastofthese"}, "edited": false, "score": 0, "creation_date": 1429801110, "post_id": 29806761, "comment_id": 47780732, "body": "Replace the third from last line of your code with the first block of my example code, and include the function in your module."}, {"owner": {"reputation": 39, "user_id": 4820706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2472b88cbd1bfc46f3c4808254054a3?s=128&d=identicon&r=PG&f=1", "display_name": "TheLeastofThese", "link": "https://stackoverflow.com/users/4820706/theleastofthese"}, "edited": false, "score": 0, "creation_date": 1429806169, "post_id": 29806761, "comment_id": 47784718, "body": "Thank you, I got an Object Required error on <code>Set rv = doc.getElementById(id)</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 39, "user_id": 4820706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2472b88cbd1bfc46f3c4808254054a3?s=128&d=identicon&r=PG&f=1", "display_name": "TheLeastofThese", "link": "https://stackoverflow.com/users/4820706/theleastofthese"}, "edited": false, "score": 0, "creation_date": 1429806313, "post_id": 29806761, "comment_id": 47784817, "body": "In that case then you may also need to test if <code>doc</code> is Nothing"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 2, "last_activity_date": 1429729731, "creation_date": 1429729731, "answer_id": 29806761, "question_id": 29805105, "link": "https://stackoverflow.com/questions/29805105/vba-object-required-error-trying-to-get-innertext/29806761#29806761", "title": "VBA Object Required Error Trying To Get InnerText", "body": "<p>Something like this (untested):</p>\n\n<pre><code>Dim el as object\n'...\n\nSet el = WaitForElement(IE.Document, \"routemi\", 1)\nIf Not el is Nothing Then\n    Sheet1.Range(\"E5\").Value = el.innerText\nElse\n    Msgbox \"Element 'routemi' not found!\"\n    Exit Sub\nEnd if\n</code></pre>\n\n<p>Utility function to get an element by id, waiting until it appears:</p>\n\n<pre><code>Function WaitForElement(doc As Object, id As String, maxWaitSec As Double) As Object\n    Dim rv As Object, t\n\n    t = Timer\n    Do\n        Set rv = doc.getElementById(id)\n        DoEvents\n    Loop While rv Is Nothing And (Timer - t) &lt; maxWaitSec\n\n    Set WaitForElement = rv\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1545678196, "creation_date": 1545678196, "answer_id": 53916934, "question_id": 29805105, "link": "https://stackoverflow.com/questions/29805105/vba-object-required-error-trying-to-get-innertext/53916934#53916934", "title": "VBA Object Required Error Trying To Get InnerText", "body": "<p>You need to leave proper waits at each point (after <code>.Navigate2</code> and <code>.Click</code>) to allow for page loading. I use CSS selectors to target ids as modern browsers are optimized for CSS. Also, I updated method for page navigation to <code>.Navigate2</code>.</p>\n\n<pre><code>Option Explicit\nPublic Sub Distance()\n    Dim ie As New InternetExplorer\n    With ie\n        .Visible = True\n\n            .Navigate2 \"http://www.distance-cities.com/\"\n\n            While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n            With .document\n                .querySelector(\"#from\").Value = \"Stillwater, OK\"\n                .querySelector(\"#to\").Value = \"Hollis, OK\"\n                .querySelector(\"[type=submit]\").Click\n            End With\n\n           While .Busy Or .readyState &lt; 4: DoEvents: Wend\n           Debug.Print .document.querySelector(\"#routemi\").innerText\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 4820706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2472b88cbd1bfc46f3c4808254054a3?s=128&d=identicon&r=PG&f=1", "display_name": "TheLeastofThese", "link": "https://stackoverflow.com/users/4820706/theleastofthese"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1756, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1545678196, "creation_date": 1429724368, "last_edit_date": 1429762793, "question_id": 29805105, "link": "https://stackoverflow.com/questions/29805105/vba-object-required-error-trying-to-get-innertext", "title": "VBA Object Required Error Trying To Get InnerText", "body": "<p>I am trying to create a code that will go to a website, put in data, submit it, and then return the answer to a cell in excel. When I step through it, it works fine, but when I just try to run it, I get run-time error 424; Object Required. </p>\n\n<p>I tried looking for a good answer, but I am just not grasping on how to quite fix this. Where is my issue? How do I correct it?</p>\n\n<pre><code>Sub Distance()\n\n\nDim IE As Object\n\n' Create InternetExplorer Object\nSet IE = CreateObject(\"InternetExplorer.Application\")\n\n' Make visible\nIE.Visible = True\n\n' Go to site\nIE.Navigate \"http://www.distance-cities.com/\"\n\n' Wait while IE loading...\nDo Until IE.READYSTATE = 4\n    DoEvents\nLoop\n\nIE.Document.getelementbyId(\"from\").Value = \"Stillwater, OK\"\nIE.Document.getelementbyId(\"to\").Value = \"Hollis, OK\"\nIE.Document.forms(0).submit\n\nDo Until IE.READYSTATE = 4\n    DoEvents\nLoop\n\n'*Below is where I get my error\nSheet1.Range(\"E5\").Value = IE.Document.getelementbyId(\"routemi\").InnerText\nIE.Quit\n\nEnd Sub\n</code></pre>\n\n<p>I apologize if this is a bit messy.</p>\n\n<p>Thanks for you help!</p>\n"}, {"tags": ["vba", "excel", "ms-word", "copy-paste"], "answers": [{"tags": [], "owner": {"reputation": 43, "user_id": 4792075, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bb7b07d9097f67bcbc4eb5a5d887dc8c?s=128&d=identicon&r=PG&f=1", "display_name": "CorinneGermany", "link": "https://stackoverflow.com/users/4792075/corinnegermany"}, "is_accepted": true, "score": 0, "last_activity_date": 1429734084, "creation_date": 1429734084, "answer_id": 29808004, "question_id": 29804799, "link": "https://stackoverflow.com/questions/29804799/can-not-copy-from-excel-and-paste-to-a-form-edit-restricted-word-document-unless/29808004#29808004", "title": "Can not copy from Excel and paste to a Form Edit restricted Word document unless restriction is turned off", "body": "<p>Because its a Formfield and not just a bookmark I changing the code as below which resolved the strange red font issue.  I can now copy to the document protected.</p>\n\n<pre><code>From\nBrandstetterDoc.Bookmarks(\"Text65\").Range.Text = ws.Range(\"ARZKrankenhaus\").Value\nTo\nActiveDocument.FormFields(\"Text65\").Result = ws.Range(\"ARZKrankenhaus\").Value\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 4792075, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bb7b07d9097f67bcbc4eb5a5d887dc8c?s=128&d=identicon&r=PG&f=1", "display_name": "CorinneGermany", "link": "https://stackoverflow.com/users/4792075/corinnegermany"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 29808004, "answer_count": 1, "score": 0, "last_activity_date": 1462560023, "creation_date": 1429723484, "last_edit_date": 1531164843, "question_id": 29804799, "link": "https://stackoverflow.com/questions/29804799/can-not-copy-from-excel-and-paste-to-a-form-edit-restricted-word-document-unless", "title": "Can not copy from Excel and paste to a Form Edit restricted Word document unless restriction is turned off", "body": "<p>I am copying Excel cell contents to a bookmark on a Form Edit restricted (2010) Word document but it will only paste if the protection is turned off.</p>\n\n<p>The code I currently have to turn the protection on again afterwards errors.  What is the correct code?</p>\n\n<p>Is there a way to make this copy and paste without turning off the protection? </p>\n\n<p>Second problem is that when the text is pasted to the bookmark the font is Red (if manually entered on the document it is in black).  The Word default is set as black (I reset the default for good measure).  Typing in a new document is in black, however, when Word opens the font icon shows red even though checking the default it is still shows black.  Can I define the font colour in the VBA to override this issue until is is resolved or can you suggest a way to fix the Word default?</p>\n\n<pre><code>Sub Arzbericht_Brandstetter()\n\n' x - Defined Cell Names -  ARTBrandPATH   ,  ARTBrandDOC\n\n'                               Excel          Word Bookmark\n' x - Defined Cell Names -  ARZKrankenhaus       Text65\n\n\nDim wb As Workbook\nDim ws As Worksheet\nSet wb = ActiveWorkbook\nSet ws = ActiveSheet\n\nDim Wd As Object\nDim wdDoc As Object\nDim BrandstetterDoc As Object\nDim BrandstetterPath As String\n\nDim f As Boolean\n\nBrandstetterPath = ActiveSheet.Range(\"ARTBrandPATH\").Value &amp; ActiveSheet.Range(\"ARTBrandDOC\").Value &amp; \".doc\"  ' x\n\n'    On Error Resume Next\n\nSet BrandstetterDoc = GetObject(BrandstetterPath)\n\nIf BrandstetterDoc Is Nothing Then\n    Set Wd = GetObject(, \"Word.Application\")\n    If Wd Is Nothing Then\n        Set Wd = CreateObject(\"Word.Application\")\n        If Wd Is Nothing Then\n            MsgBox \"Failed to start Word!\", vbCritical\n            Exit Sub\n        End If\n        f = True\n    End If\n    Set BrandstetterDoc = Wd.Documents.Open(BrandstetterPath)\n    If BrandstetterDoc Is Nothing Then\n        MsgBox \"Failed to open Brandstetter Document!\" &amp; vbNewLine &amp; _\n                   \" Check File Directory is correct\", vbCritical\n        If f Then\n            Wd.Quit\n        End If\n        Exit Sub\n    End If\n    Wd.Visible = True\nElse\n    With BrandstetterDoc.Parent\n        .Visible = True\n        .Activate\n\n\n'  Turn Protection OFF\n        With ActiveDocument\n            .Unprotect \"xxxxx\"\n            .Protect wdAllowOnlyRevisions, , Password:=\"xxxxx\"\n        End With\n\n        BrandstetterDoc.Bookmarks(\"Text65\").Range.Text = ws.Range(\"ARZKrankenhaus\").Value\n\n\n'  Turn Protection ON   (Restricted Editing)\n'           ActiveDocument.Protect Type:=wdAllowOnlyFormFields, NoReset:=True\n\n    End With\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["mysql", "database", "ms-access", "vba", "ms-access-2007"], "comments": [{"owner": {"reputation": 502, "user_id": 1154932, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6f5391c6e52959a3b2bdfd5342827cc5?s=128&d=identicon&r=PG", "display_name": "thomasw_lrd", "link": "https://stackoverflow.com/users/1154932/thomasw-lrd"}, "edited": false, "score": 1, "creation_date": 1429722978, "post_id": 29804098, "comment_id": 47736946, "body": "What does your database structure look like?  The only way to really do this is to find the fields that are exactly the same."}, {"owner": {"reputation": 5315, "user_id": 3689364, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/1wGCo.jpg?s=128&g=1", "display_name": "EliteRaceElephant", "link": "https://stackoverflow.com/users/3689364/eliteraceelephant"}, "edited": false, "score": 0, "creation_date": 1429780771, "post_id": 29804098, "comment_id": 47764613, "body": "Like the other commentator mentioned you need to tell us your data structure and what you tried so far first."}, {"owner": {"reputation": 1, "user_id": 4820487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/982b3f2ef31a008591c96e6ec6c1bb88?s=128&d=identicon&r=PG&f=1", "display_name": "carpediam9", "link": "https://stackoverflow.com/users/4820487/carpediam9"}, "edited": false, "score": 0, "creation_date": 1430243302, "post_id": 29804098, "comment_id": 47974578, "body": "I have edited my question. Please let me know if you need more info."}], "owner": {"reputation": 1, "user_id": 4820487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/982b3f2ef31a008591c96e6ec6c1bb88?s=128&d=identicon&r=PG&f=1", "display_name": "carpediam9", "link": "https://stackoverflow.com/users/4820487/carpediam9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 187, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1430243259, "creation_date": 1429721484, "last_edit_date": 1430243259, "question_id": 29804098, "link": "https://stackoverflow.com/questions/29804098/duplicate-customers-with-different-customer-id", "title": "Duplicate Customers with Different Customer Id", "body": "<p>I have a Customer table with customer id which is an auto number and the primary key. Also i have another table Orders where customer id is a foreign key. In my customers table one customer is assigned multiple ids how do i resolve that ? also one customer can have multiple orders so how can i assign same customer id for multiple orders without manually doing so? </p>\n\n<p>I have a Customer Table with following fields:\n1- CustomerId - Autonumber - Primary key 2- BuyerName 3- AddStreet1 4- AddStreet2 5- AddCity 6- AddState 7- AddZipCode 8- AddCountry 9- PhoneNo 10- Email 11- Company 12- ReceiptName\nI have another table named Orders with following fields:\n1- OrderId - Primary Key\n2- CustomerId\n3- PurcahseDate\n4- FulfillmentCenter\n5- SalesChannel\n6- AdditionalInfo\n I have a relation between customer.customerid and orders.customerid of one to many. i.e one customer can have multiple orders. Now if my data in customer table has same customer twice then the particular customer gets two ids. now if i run a duplicate query and remove the customers, i would like orders table to change the customer id. that is my prime question.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel", "vbscript"], "comments": [{"owner": {"reputation": 2590, "user_id": 4507417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a027c3ea839c86e05de0c5f22fc6a7d0?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Stejskal", "link": "https://stackoverflow.com/users/4507417/marek-stejskal"}, "edited": false, "score": 1, "creation_date": 1429721124, "post_id": 29803708, "comment_id": 47735686, "body": "Have you tried recording the macro for setting up the conditional formatting, cleaning it up a bit and using it as a vbscript?"}, {"owner": {"reputation": 231, "user_id": 4783170, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1c983d95d2e9c8daa7867dacd4a02d29?s=128&d=identicon&r=PG&f=1", "display_name": "asdfasfd", "link": "https://stackoverflow.com/users/4783170/asdfasfd"}, "reply_to_user": {"reputation": 2590, "user_id": 4507417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a027c3ea839c86e05de0c5f22fc6a7d0?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Stejskal", "link": "https://stackoverflow.com/users/4507417/marek-stejskal"}, "edited": false, "score": 0, "creation_date": 1429721364, "post_id": 29803708, "comment_id": 47735863, "body": "I&#39;m actually using vbscript to do the entire thing. I need to figure out how to apply that formatting using the vbscript. The screencap came from the worksheet I&#39;m using as a reference when I work on my generated one."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1429721711, "post_id": 29803708, "comment_id": 47736088, "body": "This should help you convert your recorded and edited VBA to vbscript: <a href=\"http://www.planetcobalt.net/sdb/vba2vbs.shtml\" rel=\"nofollow noreferrer\">planetcobalt.net/sdb/vba2vbs.shtml</a>"}, {"owner": {"reputation": 2590, "user_id": 4507417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a027c3ea839c86e05de0c5f22fc6a7d0?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Stejskal", "link": "https://stackoverflow.com/users/4507417/marek-stejskal"}, "edited": false, "score": 0, "creation_date": 1429722684, "post_id": 29803708, "comment_id": 47736755, "body": "@Alexf11 - If you have no access to any version of Excel, then it&#39;s going to be difficult for you. If this is really the case, ask Google for usage of Range.FormatConditions (specifically Range.FormatConditions.Add)"}, {"owner": {"reputation": 231, "user_id": 4783170, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1c983d95d2e9c8daa7867dacd4a02d29?s=128&d=identicon&r=PG&f=1", "display_name": "asdfasfd", "link": "https://stackoverflow.com/users/4783170/asdfasfd"}, "edited": false, "score": 0, "creation_date": 1429722966, "post_id": 29803708, "comment_id": 47736937, "body": "I have access to excel. The screenshot is of the conditional formatting I need set up. That one was set up manually in the excel file I&#39;m trying to mimic with my vbscript. I need to automate it. If it were a macro that set up that conditional it wouldn&#39;t be hard but it was set up manually."}, {"owner": {"reputation": 2590, "user_id": 4507417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a027c3ea839c86e05de0c5f22fc6a7d0?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Stejskal", "link": "https://stackoverflow.com/users/4507417/marek-stejskal"}, "edited": false, "score": 0, "creation_date": 1429723237, "post_id": 29803708, "comment_id": 47737105, "body": "@Alexf11 So I don&#39;t see the problem. Record creating this conditional formatting anywhere and re-use the code in vbs, it&#39;s just a few lines."}, {"owner": {"reputation": 231, "user_id": 4783170, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1c983d95d2e9c8daa7867dacd4a02d29?s=128&d=identicon&r=PG&f=1", "display_name": "asdfasfd", "link": "https://stackoverflow.com/users/4783170/asdfasfd"}, "reply_to_user": {"reputation": 2590, "user_id": 4507417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a027c3ea839c86e05de0c5f22fc6a7d0?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Stejskal", "link": "https://stackoverflow.com/users/4507417/marek-stejskal"}, "edited": false, "score": 0, "creation_date": 1429724102, "post_id": 29803708, "comment_id": 47737705, "body": "@Marek Stejskal how do I record creating it if it was created manually by using the conditional formatting button on excel."}, {"owner": {"reputation": 2590, "user_id": 4507417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a027c3ea839c86e05de0c5f22fc6a7d0?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Stejskal", "link": "https://stackoverflow.com/users/4507417/marek-stejskal"}, "edited": false, "score": 0, "creation_date": 1429724497, "post_id": 29803708, "comment_id": 47738003, "body": "@Alexf11 On the Developer tab of the Ribbon there is a button &#39;Record Macro&#39;. It&#39;s also at the lower left corner. You may need to activate the Developer tab by going into File-&gt;Options-&gt;Customize Ribbon. This is the most basic stuff, you should know how to record a macro if you are working with Excel."}, {"owner": {"reputation": 231, "user_id": 4783170, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1c983d95d2e9c8daa7867dacd4a02d29?s=128&d=identicon&r=PG&f=1", "display_name": "asdfasfd", "link": "https://stackoverflow.com/users/4783170/asdfasfd"}, "reply_to_user": {"reputation": 2590, "user_id": 4507417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a027c3ea839c86e05de0c5f22fc6a7d0?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Stejskal", "link": "https://stackoverflow.com/users/4507417/marek-stejskal"}, "edited": false, "score": 0, "creation_date": 1429728803, "post_id": 29803708, "comment_id": 47740782, "body": "@MarekStejskal edited my post to include the code generated. Working on getting it to work in my vbscript"}, {"owner": {"reputation": 231, "user_id": 4783170, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1c983d95d2e9c8daa7867dacd4a02d29?s=128&d=identicon&r=PG&f=1", "display_name": "asdfasfd", "link": "https://stackoverflow.com/users/4783170/asdfasfd"}, "reply_to_user": {"reputation": 2590, "user_id": 4507417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a027c3ea839c86e05de0c5f22fc6a7d0?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Stejskal", "link": "https://stackoverflow.com/users/4507417/marek-stejskal"}, "edited": false, "score": 0, "creation_date": 1429733244, "post_id": 29803708, "comment_id": 47743645, "body": "@MarekStejskal Got it working"}, {"owner": {"reputation": 2590, "user_id": 4507417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a027c3ea839c86e05de0c5f22fc6a7d0?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Stejskal", "link": "https://stackoverflow.com/users/4507417/marek-stejskal"}, "edited": false, "score": 0, "creation_date": 1429736098, "post_id": 29803708, "comment_id": 47745366, "body": "@AlexFerreira Glad to hear that"}], "answers": [{"tags": [], "owner": {"reputation": 231, "user_id": 4783170, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1c983d95d2e9c8daa7867dacd4a02d29?s=128&d=identicon&r=PG&f=1", "display_name": "asdfasfd", "link": "https://stackoverflow.com/users/4783170/asdfasfd"}, "is_accepted": true, "score": 1, "last_activity_date": 1429733277, "creation_date": 1429733277, "answer_id": 29807776, "question_id": 29803708, "link": "https://stackoverflow.com/questions/29803708/vba-conditional-formatting-if-cell-not-between/29807776#29807776", "title": "VBA Conditional Formatting if Cell Not Between", "body": "<p>The code that worked</p>\n\n<pre><code>Set rng = objWorkSheet.Range(\"K\" &amp; rowNum + 2)\n\n'vbscript doesn't support named arguments, only positional\nSet fc = rng.FormatConditions.Add(1, 2, _\n                                 \"=$I$\" &amp; finalRowNum, _\n                                 \"=$J$\" &amp; finalRowNum)\nfc.SetFirstPriority\n\nWith fc.Interior\n    .PatternColorIndex = -4105\n    .Color = 255\n    .TintAndShade = 0\nEnd With\n\nfc.StopIfTrue = False\n</code></pre>\n"}], "owner": {"reputation": 231, "user_id": 4783170, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1c983d95d2e9c8daa7867dacd4a02d29?s=128&d=identicon&r=PG&f=1", "display_name": "asdfasfd", "link": "https://stackoverflow.com/users/4783170/asdfasfd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1394, "favorite_count": 1, "accepted_answer_id": 29807776, "answer_count": 1, "score": 1, "last_activity_date": 1429733277, "creation_date": 1429720314, "last_edit_date": 1531164843, "question_id": 29803708, "link": "https://stackoverflow.com/questions/29803708/vba-conditional-formatting-if-cell-not-between", "title": "VBA Conditional Formatting if Cell Not Between", "body": "<p>I need to apply conditional formatting to a cell using VBScript to change the background color of the cell if it's value is not between the value of two other cells:</p>\n\n<p><img src=\"https://i.stack.imgur.com/yKS19.png\" alt=\"Picture of an Excel Dialog\"></p>\n\n<p>code from the macro</p>\n\n<pre><code>Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlNotBetween, _\n    Formula1:=\"=$I$28\", Formula2:=\"=$J$28\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 255\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\nEnd Sub\n</code></pre>\n\n<p>My conversion to vbscript that isn't working</p>\n\n<pre><code>    priceRange = \"K\"&amp;rowNum + 2\n    objWorkSheet.Range(priceRange).FormatConditions.Add Type:=1, Operator:=2, Formula1:=\"=$I$\"&amp;finalRowNum + 1&amp;\"\", Formula2:=\"=$J$\"&amp;finalRowNum + 1&amp;\"\"\n    objWorkSheet.Range(priceRange).FormatConditions(objExcel.Selection.FormatConditions.Count).SetFirstPriority\n    objWorkSheet.Range(priceRange).FormatConditions(1).Interior.PatternColorIndex = -4105\n    objWorkSheet.Range(priceRange).FormatConditions(1).Interior.Color = 255\n    objWorkSheet.Range(priceRange).FormatConditions(1).Interior.TintAndShade = 0\n    objWorkSheet.Range(priceRange).FormatConditions(1).StopIfTrue = False\n</code></pre>\n"}, {"tags": ["vba", "excel", "combobox"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1429721341, "post_id": 29803615, "comment_id": 47735850, "body": "The details you provide should show the code you use to populate the comboboxes, and should give some indication as to what range and worksheets the data is located in, you haven&#39;t provided any of that."}, {"owner": {"reputation": 137, "user_id": 4724127, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1682dac646466b000de6d9c96ed9092f?s=128&d=identicon&r=PG&f=1", "display_name": "Isaac Rothstein", "link": "https://stackoverflow.com/users/4724127/isaac-rothstein"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1429721580, "post_id": 29803615, "comment_id": 47736013, "body": "I understand that I didn&#39;t provide any code for review.  Is there a better way to phrase my question in order to get feedback about my methodology, rather than my code?  The type of answer I&#39;m seeking if in the form of:  &quot;No, you should use the Count function rather than the Countif function, for reasons x,y,z.&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 137, "user_id": 4724127, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1682dac646466b000de6d9c96ed9092f?s=128&d=identicon&r=PG&f=1", "display_name": "Isaac Rothstein", "link": "https://stackoverflow.com/users/4724127/isaac-rothstein"}, "edited": false, "score": 0, "creation_date": 1429722547, "post_id": 29804376, "comment_id": 47736653, "body": "Thank you Marek.  I now have a pile of keywords to begin searching.  Off to do some research.  <i>zip</i>"}, {"owner": {"reputation": 2590, "user_id": 4507417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a027c3ea839c86e05de0c5f22fc6a7d0?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Stejskal", "link": "https://stackoverflow.com/users/4507417/marek-stejskal"}, "reply_to_user": {"reputation": 137, "user_id": 4724127, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1682dac646466b000de6d9c96ed9092f?s=128&d=identicon&r=PG&f=1", "display_name": "Isaac Rothstein", "link": "https://stackoverflow.com/users/4724127/isaac-rothstein"}, "edited": false, "score": 0, "creation_date": 1429722899, "post_id": 29804376, "comment_id": 47736889, "body": "@IsaacRothstein Come back with your results, we can have another look at it."}, {"owner": {"reputation": 137, "user_id": 4724127, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1682dac646466b000de6d9c96ed9092f?s=128&d=identicon&r=PG&f=1", "display_name": "Isaac Rothstein", "link": "https://stackoverflow.com/users/4724127/isaac-rothstein"}, "edited": false, "score": 0, "creation_date": 1430319081, "post_id": 29804376, "comment_id": 48015444, "body": "I&#39;ve been able to make progress towards a solution.  I&#39;ve gotten as far as performing the search and generating the results.  <a href=\"http://stackoverflow.com/questions/29947244/how-do-i-get-vba-loop-result-to-populate-a-combobox\" title=\"how do i get vba loop result to populate a combobox\">stackoverflow.com/questions/29947244/&hellip;</a>"}], "tags": [], "owner": {"reputation": 2590, "user_id": 4507417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a027c3ea839c86e05de0c5f22fc6a7d0?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Stejskal", "link": "https://stackoverflow.com/users/4507417/marek-stejskal"}, "is_accepted": true, "score": 1, "last_activity_date": 1429722284, "creation_date": 1429722284, "answer_id": 29804376, "question_id": 29803615, "link": "https://stackoverflow.com/questions/29803615/how-do-i-populate-a-combobox-with-the-names-of-a-worksheet-as-the-result-of-a/29804376#29804376", "title": "How do I populate a combobox with the name(s) of a worksheet as the result of a date selection?", "body": "<p>Okay, so here's me pointing you in the right/possible/some? direction.</p>\n\n<ul>\n<li>The first combobox should trigger a <code>Change</code> event when you select a date</li>\n<li>On that event you should map a procedure, that would</li>\n<li>A) Cycle all the worksheets (<code>Workbook.Worksheets</code> collection)</li>\n<li>B) Check each <code>Worksheet</code> for the date in Column X</li>\n<li>C) How you do the checking is up to you, you may wish to experiment with <code>Find</code> method of object <code>Range</code> (record macro for <code>Ctrl+F</code> and see how it works), but be careful about the error handling (when match is not found) </li>\n<li>D) If the date is found, <code>Worksheet.Name</code> is added to the item collection of your first combobox.</li>\n</ul>\n"}], "owner": {"reputation": 137, "user_id": 4724127, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1682dac646466b000de6d9c96ed9092f?s=128&d=identicon&r=PG&f=1", "display_name": "Isaac Rothstein", "link": "https://stackoverflow.com/users/4724127/isaac-rothstein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 29804376, "answer_count": 1, "score": 0, "last_activity_date": 1429722284, "creation_date": 1429720037, "last_edit_date": 1429720400, "question_id": 29803615, "link": "https://stackoverflow.com/questions/29803615/how-do-i-populate-a-combobox-with-the-names-of-a-worksheet-as-the-result-of-a", "title": "How do I populate a combobox with the name(s) of a worksheet as the result of a date selection?", "body": "<p>I have 2 comboboxes.  The 1st combobox (CboReviewDate) holds dates.  The 2nd combobox (CboReviewModule) will be populated with the names of all the worksheets in the active workbook (if they contain a date in column \"x\" that matches the date selected in CboReviewDate).</p>\n\n<p>I need help setting up the logic and choosing the correct search tool.\nWill this logic flow work?\nWill the loop routine erase the existing entry in CboReviewModule?</p>\n\n<p>This is a learning process for me, so I would like to develop the code myself.  Please just point me in the right direction.</p>\n\n<p>Here is my pseudocode:</p>\n\n<pre><code>'Run on \"CboReviewDate\"_change state\n'CountIf (date in column \"x\" = \"CboReviewDate.Value\") in worksheet 1 of active workbook\n'if result &lt;&gt; 0 then pass name of worksheet to variable \"a\"\n'.additem to \"CboReviewModule\" using value of variable \"a\"\n'reset value of variable \"a\" and loop until all worksheets in active workbook have been searched\n</code></pre>\n"}, {"tags": ["vba", "excel", "pivot-table"], "comments": [{"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 0, "creation_date": 1429717562, "post_id": 29802507, "comment_id": 47733159, "body": "Have you tried going through with break points to see if it does get updated at all on first attempt?"}], "answers": [{"comments": [{"owner": {"reputation": 505, "user_id": 791533, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/dcb9cc8bf286b0a72971190de472ab6c?s=128&d=identicon&r=PG", "display_name": "Lukasz", "link": "https://stackoverflow.com/users/791533/lukasz"}, "edited": false, "score": 0, "creation_date": 1429718720, "post_id": 29802959, "comment_id": 47734073, "body": "That was it! Thank you."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 1, "last_activity_date": 1429718341, "creation_date": 1429718341, "answer_id": 29802959, "question_id": 29802507, "link": "https://stackoverflow.com/questions/29802507/refreshing-pivottable-in-excel-2007-vba-doesnt-work/29802959#29802959", "title": "Refreshing PivotTable in Excel 2007 VBA doesn&#39;t work", "body": "<p>Make sure the connection doesn't refresh in the background:</p>\n\n<pre><code>Dim c As WorkbookConnection\nSet c = ThisWorkbook.Connections.Item(\"Sheet1\")\n\nsSQL = \"Select * from Table1 \"     \n\nc.OLEDBConnection.CommandText = sSQL\nc.OLEDBConnection.CommandType = xlCmdSql\nc.OLEDBConnection.Backgroundquery = False\nc.Refresh\n\nFor Each pivot In ThisWorkbook.Worksheets(\"Sheet1\").PivotTables\n\n    pivot.RefreshTable\n\nNext\n</code></pre>\n"}], "owner": {"reputation": 505, "user_id": 791533, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/dcb9cc8bf286b0a72971190de472ab6c?s=128&d=identicon&r=PG", "display_name": "Lukasz", "link": "https://stackoverflow.com/users/791533/lukasz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 389, "favorite_count": 0, "accepted_answer_id": 29802959, "answer_count": 1, "score": 0, "last_activity_date": 1429718341, "creation_date": 1429717234, "question_id": 29802507, "link": "https://stackoverflow.com/questions/29802507/refreshing-pivottable-in-excel-2007-vba-doesnt-work", "title": "Refreshing PivotTable in Excel 2007 VBA doesn&#39;t work", "body": "<p>I'm trying to update a pivot table from VBA after it's source sql data table is refreshed. No matter what I do, the Pivot Table will only get refreshed the <strong>2nd time</strong> this code is executed. I've tried all combinations and orders of pivot.RefreshTable and pivot.Update, adding Do Events, setting Application.ScreenUpdating to false before and True after. I'm running out of ideas. Each Time the data is modified in SQL,  I have to execute it once to see it in the source table and again to see it in the pivot table.</p>\n\n<pre><code>Dim c As WorkbookConnection\nSet c = ThisWorkbook.Connections.Item(\"Sheet1\")\n\nsSQL = \"Select * from Table1 \"     \n\nc.OLEDBConnection.CommandText = sSQL\nc.OLEDBConnection.CommandType = xlCmdSql\nc.Refresh\n\nFor Each pivot In ThisWorkbook.Worksheets(\"Sheet1\").PivotTables\n\n    pivot.RefreshTable\n    pivot.Update\n    pivot.PivotCache.Refresh\n    DoEvents\n    pivot.RefreshTable\n    pivot.Update\n    pivot.PivotCache.Refresh\nNext\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "edited": false, "score": 0, "creation_date": 1429715628, "post_id": 29801831, "comment_id": 47731697, "body": "For each paragraph in active document paragraphs, if is hidden then delete, save as, close without saving changes."}, {"owner": {"reputation": 541, "user_id": 3762977, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/suRLj.jpg?s=128&g=1", "display_name": "user3762977", "link": "https://stackoverflow.com/users/3762977/user3762977"}, "reply_to_user": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "edited": false, "score": 0, "creation_date": 1429715895, "post_id": 29801831, "comment_id": 47731899, "body": "Thanks Tomalak, yeah I&#39;ve been trying it that way but it&#39;s complicated to select the text that&#39;s hidden, and it seems to require making it non-hidden, in order to delete it. If you have any pointers about doing this pls let me know."}, {"owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "edited": false, "score": 0, "creation_date": 1429716063, "post_id": 29801831, "comment_id": 47732040, "body": "Besides telling you the basic concept, no. I&#39;m on mobile right now, so that&#39;s difficult anyway. But do add the code you have been trying it with and describe the difficulties you&#39;ve had with it,  others will find this information useful."}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1429716179, "post_id": 29801831, "comment_id": 47732144, "body": "Tried <code>wdFormatFilteredHTML</code> ? Its supposed to strip out the massive bloat/junk that it usually spits out."}, {"owner": {"reputation": 61736, "user_id": 43846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TGOxx.png?s=128&g=1", "display_name": "stuartd", "link": "https://stackoverflow.com/users/43846/stuartd"}, "edited": false, "score": 0, "creation_date": 1429716561, "post_id": 29801831, "comment_id": 47732445, "body": "Word&#39;s Replace functionality has the option to replace any hidden text with nothing, effectively removing it -     Selection.Find.ClearFormatting     Selection.Find.Font.Hidden = True     Selection.Find.Replacement.ClearFormatting     With Selection.Find         .Text = &quot;&quot;         .Replacement.Text = &quot;&quot;         .Forward = True         .Wrap = wdFindContinue         .Format = True      End With     Selection.Find.Execute Replace:=wdReplaceAll"}, {"owner": {"reputation": 541, "user_id": 3762977, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/suRLj.jpg?s=128&g=1", "display_name": "user3762977", "link": "https://stackoverflow.com/users/3762977/user3762977"}, "edited": false, "score": 0, "creation_date": 1429716821, "post_id": 29801831, "comment_id": 47732610, "body": "Alex K. Yes, filteredHTML strips out some things but not hidden text."}], "owner": {"reputation": 541, "user_id": 3762977, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/suRLj.jpg?s=128&g=1", "display_name": "user3762977", "link": "https://stackoverflow.com/users/3762977/user3762977"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 534, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1429723276, "creation_date": 1429715505, "last_edit_date": 1429723276, "question_id": 29801831, "link": "https://stackoverflow.com/questions/29801831/word-vba-saveas-without-hidden-text", "title": "Word VBA &quot;Saveas&quot; without hidden text?", "body": "<p>Is there a way to programmatically saveas from a Microsoft Word .docm without including hidden text?</p>\n\n<p>I'm having users click a button that does a few other things and then opens up a save as dialog to save the .docm file as an .html file, by using this in the Word VB editor:</p>\n\n<pre><code>With Dialogs(wdDialogFileSaveAs)\n    .Format = wdFormatHTML\n    .Show\nEnd With\n</code></pre>\n\n<p>It saves everything that appears on the page but also saves the paragraphs that are currently hidden. (They're also hidden in the Web display of the html page, but the hidden content is still in the .html, marked with <code>mso-hideall</code> tags.) I would like to only save the content that is <em>not</em> hidden, if possible, so that it's not in the html file at all.</p>\n\n<p>I don't see anything that provides for that <a href=\"https://msdn.microsoft.com/en-us/library/office/ff836084.aspx\" rel=\"nofollow\">here</a>, but I'm wondering if anyone might know of a way to do this using VB.</p>\n\n<p>I've been working on deleting the hidden text using VBA, but it's tricky because you have to show it first, then select it, then delete it, and which parts are hidden is different each time depending on what the user selects in the Word .docm document.</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>Here's the complete code I have now:</p>\n\n<pre><code>Public strActiveOption As String\n\nPrivate Sub OptionConcept_Click()\nstrActiveOption = \"OptionConcept\"\n\nBookmarks(\"ConceptText\").Range.Font.Hidden = False\nBookmarks(\"TaskText\").Range.Font.Hidden = True\nBookmarks(\"RefText\").Range.Font.Hidden = True\n\n\n\n\nEnd Sub\n\nPrivate Sub OptionTask_Click()\nstrActiveOption = \"OptionTask\"\nBookmarks(\"TaskText\").Range.Font.Hidden = False\nBookmarks(\"ConceptText\").Range.Font.Hidden = True\nBookmarks(\"RefText\").Range.Font.Hidden = True\n\n\nEnd Sub\n\n\n\nPrivate Sub OptionReference_Click()\nstrActiveOption = \"OptionReference\"\nBookmarks(\"RefText\").Range.Font.Hidden = False\nBookmarks(\"ConceptText\").Range.Font.Hidden = True\nBookmarks(\"TaskText\").Range.Font.Hidden = True\n\n\nEnd Sub\n\nPrivate Sub formatSave_Click()\n'Concept Content = 3\n'Task Steps = 4\n'ReferenceData = 5\n\nSelect Case strActiveOption\n Case \"OptionConcept\"\n ActiveDocument.ContentControls(4).Delete\n ActiveDocument.ContentControls(5).Delete\nCase \"OptionTask\"\n ActiveDocument.ContentControls(3).Delete\n ActiveDocument.ContentControls(5).Delete\nCase \"OptionReference\"\n ActiveDocument.ContentControls(3).Delete\n ActiveDocument.ContentControls(4).Delete\nCase Else\n    MsgBox \"Invalid option\"\nEnd Select\n\nWith Dialogs(wdDialogFileSaveAs)\n    .Format = wdFormatHTML\n    .Show\nEnd With\nEnd Sub\n</code></pre>\n\n<p>What it does: There are three option buttons on the page, and content controls are hidden or unhidden depending on which one the user selects. The code in <code>Private Sub formatSave_Click()</code> reads which one is selected and tries to delete the appropriate hidden text.</p>\n\n<p><strong>Problems:</strong></p>\n\n<p>Everything in the first subs works perfectly, down to <code>Private Sub formatSave_Click()</code>. After that, it seems to not be able to see the hidden contentcontrols in order to delete them. I tried adding this after 'Private Sub formatSave_Click()'</p>\n\n<pre><code>ActiveWindow.View.ShowHiddenText = True\n</code></pre>\n\n<p>but it doesn't seem to work. </p>\n\n<p>Also it would be a lot easier to select the content controls by tag instead of by index. I tried this, without success:</p>\n\n<pre><code>ActiveDocument.SelectContentControlsByTag(\"TaskSteps\").Delete\n</code></pre>\n\n<p>\"TaskSteps\" being the tag name for control (4).</p>\n\n<p><strong>UPDATE II</strong></p>\n\n<p><em>(Suggestion from stuartd)</em></p>\n\n<p>This isn't working to delete hidden text, but maybe I don't have it formatted correctly? </p>\n\n<pre><code>Private Sub formatSave_Click()\n\nSelection.Find.ClearFormatting\nSelection.Find.Font.Hidden = True\nSelection.Find.Replacement.ClearFormatting\nWith Selection.Find\n.Text = \"\"\n.Replacement.Text = \"\"\n.Forward = True\n.Wrap = wdFindContinue\n.Format = True\nEnd With\nSelection.Find.Execute Replace:=wdReplaceAll\n\nEnd Sub\n</code></pre>\n\n<p><strong>SOLUTION:</strong></p>\n\n<p>Okay I got my original code to work. This is what was happening:</p>\n\n<p>VB deleted ContentControls(4)</p>\n\n<p>I next told it to delete ContentControls(5)</p>\n\n<p>Except that now, with (4) deleted, ContentControls(5) was now ContentControls(4).</p>\n\n<p>So I changed the numbering as shown below, and now it works, and deletes the correct ones:</p>\n\n<pre><code>Private Sub formatSave_Click()\n'Concept Content = 3\n'Task Steps = 4\n'ReferenceData = 5\n\nActiveDocument.ActiveWindow.View.ShowHiddenText = True\n\nSelect Case strActiveOption\n    Case \"OptionConcept\"\n     ActiveDocument.ContentControls(4).Delete\n     ActiveDocument.ContentControls(4).Delete\n    Case \"OptionTask\"\n     ActiveDocument.ContentControls(3).Delete\n     ActiveDocument.ContentControls(4).Delete\n    Case \"OptionReference\"\n     ActiveDocument.ContentControls(3).Delete\n     ActiveDocument.ContentControls(3).Delete\n    Case Else\n        MsgBox \"Invalid option\"\nEnd Select\n\nEnd Sub\n</code></pre>\n\n<p>I looked at what debug was telling me, stopping on the second deletion in each series, and I finally realized what was going on.</p>\n\n<p>Thanks for all the suggestions.</p>\n"}, {"tags": ["vba", "email", "outlook"], "comments": [{"owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "edited": false, "score": 3, "creation_date": 1429715535, "post_id": 29801710, "comment_id": 47731624, "body": "All of the file names I&#39;ve ever seen in that format start with two backslashes... \\\\  instead of \\ maybe doublecheck to see if you copied the <i>entire</i> path?"}, {"owner": {"reputation": 329, "user_id": 4483889, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/08eea0bc7e9b732e1e49e59423aed31a?s=128&d=identicon&r=PG&f=1", "display_name": "New2VBA", "link": "https://stackoverflow.com/users/4483889/new2vba"}, "reply_to_user": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "edited": false, "score": 0, "creation_date": 1429721713, "post_id": 29801710, "comment_id": 47736090, "body": "Not quite sure how I messed that one up. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1429715726, "creation_date": 1429715726, "answer_id": 29801924, "question_id": 29801710, "link": "https://stackoverflow.com/questions/29801710/save-email-attachment-over-file-from-outlook/29801924#29801924", "title": "Save Email Attachment Over File From Outlook", "body": "<p>Try to specify any local location. After saving the attachment to the disk you can move the saved file wherever you need.</p>\n"}], "owner": {"reputation": 329, "user_id": 4483889, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/08eea0bc7e9b732e1e49e59423aed31a?s=128&d=identicon&r=PG&f=1", "display_name": "New2VBA", "link": "https://stackoverflow.com/users/4483889/new2vba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 170, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593248519, "creation_date": 1429715195, "last_edit_date": 1593248519, "question_id": 29801710, "link": "https://stackoverflow.com/questions/29801710/save-email-attachment-over-file-from-outlook", "title": "Save Email Attachment Over File From Outlook", "body": "<p>I'm trying to use VBA to download the attachments in a specific outlook folder, save over a file on my hard drive (with that file's name) and then delete the email.</p>\n\n<p>On the following line of code I'm receiving an error saying that the path does not exist. I'm copy and pasting the path so it should be correct.</p>\n\n<pre><code>atmt.SaveAsFile FileName\n</code></pre>\n\n<p>The entire code is below</p>\n\n<pre><code>Dim ns As Namespace\nDim inbox As MAPIFolder\nDim item As Object\nDim atmt As Attachment\nDim FileName As String\nDim i As Integer\nDim SubFolder As MAPIFolder\nDim SubSubFolder As MAPIFolder\nDim VariableName As Name\nSet ns = getnamespace(\"MAPI\")\nSet inbox = ns.GetDefaultFolder(olFolderInbox)\nSet SubFolder = inbox.Folders(\"Consulta Emails - Passivo\nSet SubSubFolder = inbox.Folders(\"Consulta Emails - Lastro\")\n\ni = 0\n\nIf SubFolder.Items.Count = 0 Then\nMsgBox \"Ainda n\u00e3o recebeu as planilhas necess\u00e1rias\"\nExit Sub\nElse: End If\nIf SubFolder.Items.Count &gt; 0 Then\nFor Each item In SubFolder.Items\nFor Each atmt In item.attachments\n    FileName = \"\\dsapc429pfs.pactual.net\\homefolder02$\\wellsty\\Desktop\\Arthur Projects\\Controle de Lastros\\March tests\\Consulta Passivo - Email.xls\" 'muda path; vai salvar com o mesmo nome'\n    atmt.SaveAsFile FileName\ni = i + 1\nitem.Delete 'apagar os emails depois de baixar os anexos'\nNext atmt\nNext item\nEnd If\n</code></pre>\n"}, {"tags": ["sql-server", "vba", "ms-access", "report", "linked-tables"], "comments": [{"owner": {"reputation": 5789, "user_id": 2679750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8CvF.jpg?s=128&g=1", "display_name": "Mark C.", "link": "https://stackoverflow.com/users/2679750/mark-c"}, "edited": false, "score": 0, "creation_date": 1429714716, "post_id": 29801466, "comment_id": 47731018, "body": "What line does the error occur on?"}, {"owner": {"reputation": 4523, "user_id": 2587505, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/420ced8f2b2cf49afc3302ec25690b29?s=128&d=identicon&r=PG", "display_name": "Sai Avinash", "link": "https://stackoverflow.com/users/2587505/sai-avinash"}, "reply_to_user": {"reputation": 5789, "user_id": 2679750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8CvF.jpg?s=128&g=1", "display_name": "Mark C.", "link": "https://stackoverflow.com/users/2679750/mark-c"}, "edited": false, "score": 0, "creation_date": 1429714754, "post_id": 29801466, "comment_id": 47731049, "body": "It is completing the execution of entire code block but still is going into error handler"}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 1, "creation_date": 1429714969, "post_id": 29801466, "comment_id": 47731193, "body": "put exit handler just before the ErrorHandler:  :) You need to exit the sub before reaching the error label."}, {"owner": {"reputation": 4523, "user_id": 2587505, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/420ced8f2b2cf49afc3302ec25690b29?s=128&d=identicon&r=PG", "display_name": "Sai Avinash", "link": "https://stackoverflow.com/users/2587505/sai-avinash"}, "edited": false, "score": 0, "creation_date": 1429715690, "post_id": 29801466, "comment_id": 47731733, "body": "@krish..OMG..i could not believe how missed that . Thanks for pointing it out"}], "owner": {"reputation": 4523, "user_id": 2587505, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/420ced8f2b2cf49afc3302ec25690b29?s=128&d=identicon&r=PG", "display_name": "Sai Avinash", "link": "https://stackoverflow.com/users/2587505/sai-avinash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 476, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1429714932, "creation_date": 1429714567, "last_edit_date": 1429714932, "question_id": 29801466, "link": "https://stackoverflow.com/questions/29801466/error-assigning-pass-through-query-to-report-recordsource-in-vba-code", "title": "Error assigning pass through query to report recordsource in VBA code", "body": "<p><strong>I have the following code :</strong></p>\n\n<pre><code>    Private Sub Report_Open(Cancel As Integer)\n      On Error GoTo ErrorHandler\n        Dim isPTQueryExists As Integer\n    isPTQueryExists = IsQuery(\"myTestQuery\")\n    If isPTQueryExists = -1 Then\n    Set qdf = CurrentDb.QueryDefs(\"myTestQuery\")\n    qdf.SQL =\"my SQL query\" \n    Me.RecordSource = \"myTestQuery\"\n    End If\n    Else\n    Dim DatabaseName As String\n    Dim ServerName As String\n    ServerName = \"XXXX\"\n    DatabaseName = \"XXXX\"\n    Set qdf = CurrentDb.CreateQueryDef(\"myTestQuery\")\n    strConnectionString = \"XXXX\" \n    qdf.Connect = strConnectionString\n   qdf.SQL = \"My SQL Query\"\n   Me.RecordSource = \"myTestQuery\"\nEnd If\nErrorHandler:\n MsgBox Err.Description\nEnd Sub\n\n********************************************************\n      ' FUNCTION: IsTableQuery()\n      '\n      ' PURPOSE: Determine if a table or query exists.\n      '\n      ' ARGUMENTS:\n      '   DbName: The name of the database. If the database name\n      '           is \"\" the current database is used.\n      '    TName: The name of a table or query.\n      '\n      ' RETURNS: True (it exists) or False (it does not exist).\n      '\n      '********************************************************\n      Function IsQuery(QName As String) As Integer\n      Dim Found As Integer\n      Dim QueryName As String\n      Const NAME_NOT_IN_COLLECTION = 3265\n         ' Assume the table or query does not exist.\n         Found = False\n         ' Trap for any errors.\n         On Error Resume Next\n         ' See if the name is in the Queries collection.\n         QueryName = CurrentDb.QueryDefs(QName$).Name\n         If Err &lt;&gt; NAME_NOT_IN_COLLECTION Then Found = True\n         IsQuery = Found\n      End Function\n</code></pre>\n\n<p>I have a report . <strong>I am trying to set the record source of a query dynamically from VBA code to a pass through query</strong> . </p>\n\n<p>I <code>dont have the Query Def created at the design time</code> and i am <strong>not specifying</strong> any record source for report and design time</p>\n\n<p>In the code , i am checking if the Query Def already exists , if so , i am just <strong>changing the SQL property of it and setting the record source .</strong></p>\n\n<p>If the <strong>query def is not available</strong> , then i am <strong>creating a new</strong> one an then setting it as record source.</p>\n\n<p>The problem here is : whenever i execute the code , it is showing an error:</p>\n\n<p><strong>\"Item not found in collection\"</strong> . If i <strong>click on OK button of message box</strong> then it <code>continues to run and then displays the report</code> .</p>\n\n<p><strong>But , i am not sure why the error is occuring ,and why the code is not failing with that error ?</strong></p>\n\n<p>Any thoughts on this? . I have put lot of efforts tounderstand this but in vain</p>\n\n<p><strong>Updated :</strong></p>\n\n<p>If i dont use any error handler , it is not throwing any exception </p>\n"}, {"tags": ["excel", "vba", "range"], "comments": [{"owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1429714786, "post_id": 29801412, "comment_id": 47731073, "body": "My eyes hurt! Stop using <code>select</code> before referencing a cell with <code>ActiveSheet</code>. Try instead using <code>Sheets(&quot;Summary&quot;).Range(&quot;A1048555&quot;).End(xlUp).Row</code>"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 5, "creation_date": 1429714964, "post_id": 29801412, "comment_id": 47731190, "body": "<code>ActiveSheet</code> and <code>ActiveWorkbook</code> are best friends of <i>it works when debugging but not when running</i>. Follow @Gareth suggestion, get rid of <code>Active</code> stuffs and use unique references instead. You need to debug it properly, i.e. without <code>Active</code> stuffs flashing the code."}, {"owner": {"reputation": 261, "user_id": 1346347, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/40b2d18ad54bc35e09a52cdcb8e1c8cf?s=128&d=identicon&r=PG", "display_name": "VeVi", "link": "https://stackoverflow.com/users/1346347/vevi"}, "edited": false, "score": 0, "creation_date": 1429776816, "post_id": 29801412, "comment_id": 47761825, "body": "Thanks for your tip, but even when I get rid of the active stuff, I still get the same error."}], "answers": [{"comments": [{"owner": {"reputation": 261, "user_id": 1346347, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/40b2d18ad54bc35e09a52cdcb8e1c8cf?s=128&d=identicon&r=PG", "display_name": "VeVi", "link": "https://stackoverflow.com/users/1346347/vevi"}, "edited": false, "score": 0, "creation_date": 1429776898, "post_id": 29804091, "comment_id": 47761878, "body": "Thank you for your response. This code is so much cleaner than what I wrote. But I still have the same error at the same place."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 261, "user_id": 1346347, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/40b2d18ad54bc35e09a52cdcb8e1c8cf?s=128&d=identicon&r=PG", "display_name": "VeVi", "link": "https://stackoverflow.com/users/1346347/vevi"}, "edited": false, "score": 0, "creation_date": 1429806248, "post_id": 29804091, "comment_id": 47784764, "body": "@VeVi - I can run this with no problem in Excel 2010 <code>Sheet1.Range(&quot;A1:E1,I1:O1,Q1,V1&quot;).Copy Sheet2.Range(&quot;A1&quot;)</code>  What version of Excel are you using?"}, {"owner": {"reputation": 261, "user_id": 1346347, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/40b2d18ad54bc35e09a52cdcb8e1c8cf?s=128&d=identicon&r=PG", "display_name": "VeVi", "link": "https://stackoverflow.com/users/1346347/vevi"}, "edited": false, "score": 0, "creation_date": 1429863347, "post_id": 29804091, "comment_id": 47810365, "body": "well, I have a very strange problem with that. At 1 page I use range like that and there is no problem. But at this page it doesn&#39;t work. I really don&#39;t understand it. I work with excel 2010."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 261, "user_id": 1346347, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/40b2d18ad54bc35e09a52cdcb8e1c8cf?s=128&d=identicon&r=PG", "display_name": "VeVi", "link": "https://stackoverflow.com/users/1346347/vevi"}, "edited": false, "score": 0, "creation_date": 1429892347, "post_id": 29804091, "comment_id": 47830972, "body": "Unless you can share your workbook there&#39;s not much more I can suggest, and in any case you seem to have a work-around."}, {"owner": {"reputation": 261, "user_id": 1346347, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/40b2d18ad54bc35e09a52cdcb8e1c8cf?s=128&d=identicon&r=PG", "display_name": "VeVi", "link": "https://stackoverflow.com/users/1346347/vevi"}, "edited": false, "score": 0, "creation_date": 1430142593, "post_id": 29804091, "comment_id": 47917926, "body": "Your help and suggestions are very much appreciated! At the moment it works, when I have some more time I&#39;m gonna look deeper into it ;o)"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1429721452, "creation_date": 1429721452, "answer_id": 29804091, "question_id": 29801412, "link": "https://stackoverflow.com/questions/29801412/method-range-of-object-worksheet-failed-1004/29804091#29804091", "title": "Method Range of object_worksheet failed 1004", "body": "<p>Compiled but not tested\"</p>\n\n<pre><code>Private Sub btnGetDevices_Click()\n'open every sheet after summary\n'copy columns A,B,C,D,E,I,J,K,L,M,N,O, Q,V to summary\n\nDim sh As Worksheet, shtsumm As Worksheet\nDim copyrange As Range, arrExclude, rw As Range\nDim lastRow As Long, i As Long, rng As Range\nDim NameDevice, adressDevice\n\n    'sheets to ignore\n    arrExclude = Array(\"Database\", \"Template\", \"Help\", \"OVERVIEW\", _\n                      \"Develop\", \"Schedule\", \"Information\", \"Announcements\", _\n                      \"Summary\")\n\n    Set shtsumm = Sheets(\"Summary\")\n\n    Application.ScreenUpdating = False\n\n    shtsumm.Rows(4 &amp; \":\" &amp; shtsumm.Rows.Count).Delete\n    For Each sh In ActiveWorkbook.Worksheets\n\n        If IsError(Application.Match(sh.Name, arrExclude, 0)) Then\n\n            lastRow = sh.Cells(sh.Rows.Count, \"L\").End(xlUp).Row\n\n            For i = 14 To lastRow\n\n                  Set rw = sh.Rows(i)\n\n                  If rw.Cells(1, \"Q\").Value &lt;&gt; Empty And _\n                     rw.Cells(1, \"N\").Value &lt;&gt; \"Designer\" And _\n                     rw.Cells(1, \"O\").Value &lt;&gt; \"Layouter\" Then\n\n                      NameDevice = rw.Range(\"Q1\").Value\n                      adressDevice = rw.Range(\"Q1\").Value '&lt;&lt;&lt;typo ?\n\n                      'find destination\n                      Set rng = shtsumm.Cells(Rows.Count, \"A\").End(xlUp).Offset(1, 0)\n\n                      rng.Value = sh.Name\n                      'Here Range is relative to *rw*, not to the whole sheet\n                      rw.Range(\"A1:E1,I1:O1,Q1,V1\").Copy rng.Offset(0, 1)\n                      rng.Resize(1, 15).Borders.LineStyle = xlContinuous\n\n                      shtsumm.Hyperlinks.Add _\n                         anchor:=rng.EntireRow.Cells(1, \"N\"), _\n                         Address:=\"\", SubAddress:=\"'\" &amp; sh.Name &amp; \"'!A1\", _\n                         TextToDisplay:=NameDevice\n                  End If\n            Next\n        End If\n    Next\n\n    Application.ScreenUpdating = True\n\n    shtsumm.Activate\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 261, "user_id": 1346347, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/40b2d18ad54bc35e09a52cdcb8e1c8cf?s=128&d=identicon&r=PG", "display_name": "VeVi", "link": "https://stackoverflow.com/users/1346347/vevi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 551, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429799663, "creation_date": 1429714461, "last_edit_date": 1429799663, "question_id": 29801412, "link": "https://stackoverflow.com/questions/29801412/method-range-of-object-worksheet-failed-1004", "title": "Method Range of object_worksheet failed 1004", "body": "<p>I wrote some code which works perfectly as it should when I debug it. But when I remove the breakpoint and just run the code, it give a runtime error: </p>\n\n<p>runtime error '1004'\nMethod Range of object_worksheet failed.</p>\n\n<p>It refers to  the next line:</p>\n\n<pre><code>Set copyrange = sh.Range(\"A\" &amp; i &amp; \":E\" &amp; i &amp; \",I\" &amp; i &amp; \":O\" &amp; i &amp; \",Q\" &amp; i &amp; \",V\" &amp; i) 'name column in sheet  = Q\n</code></pre>\n\n<p>But while debugging it, there isn't a problem. Maybe the cache is full?</p>\n\n<pre><code>Private Sub btnGetDevices_Click()\n'open every sheet after summary\n'copy columns A,B,C,D,E,I,J,K,L,M,N,O, Q,V to summary\n\nDim sh As Worksheet\nDim copyrange As Range\n\nApplication.ScreenUpdating = False\nSheets(\"Summary\").Rows(4 &amp; \":\" &amp; Sheets(\"Summary\").Rows.Count).Delete\nFor Each sh In ActiveWorkbook.Worksheets\n    If sh.Name &lt;&gt; \"Database\" And sh.Name &lt;&gt; \"Template\" And sh.Name &lt;&gt; \"Help\" And sh.Name &lt;&gt; \"OVERVIEW\" And sh.Name &lt;&gt; \"Develop\" And sh.Name &lt;&gt; \"Schedule\" And sh.Name &lt;&gt; \"Information\" And sh.Name &lt;&gt; \"Announcements\" And sh.Name &lt;&gt; \"Summary\" Then\n        sh.Select\n        LastRow = ActiveSheet.Range(\"L1048555\").End(xlUp).Row\n\n        For i = 14 To LastRow\n\n              If sh.Range(\"Q\" &amp; i).Value &lt;&gt; Empty And sh.Range(\"N\" &amp; i).Value &lt;&gt; \"Designer\" And sh.Range(\"O\" &amp; i).Value &lt;&gt; \"Layouter\" Then\n              Set copyrange = sh.Range(\"A\" &amp; i &amp; \":E\" &amp; i &amp; \",I\" &amp; i &amp; \":O\" &amp; i &amp; \",Q\" &amp; i &amp; \",V\" &amp; i) 'name column in sheet  = Q\n              NameDevice = sh.Range(\"Q\" &amp; i).Value\n              adressDevice = sh.Range(\"Q\" &amp; i)\n              copyrange.Copy\n              Sheets(\"Summary\").Select\n\n              LastRowsummary = ActiveSheet.Range(\"A1048555\").End(xlUp).Row\n              Range(\"B\" &amp; LastRowsummary + 1).Select\n              ActiveSheet.Paste\n              Range(\"A\" &amp; LastRowsummary + 1) = sh.Name\n              Range(\"A\" &amp; LastRowsummary + 1, \"O\" &amp; LastRowsummary + 1).Borders.LineStyle = xlContinuous\n\n              Sheets(\"Summary\").Hyperlinks.Add anchor:=Sheets(\"Summary\").Range(\"N\" &amp; LastRowsummary + 1), Address:=\"\", SubAddress:=\"'\" &amp; sh.Name &amp; \"'!A1\", TextToDisplay:=NameDevice\n              End If\n\n\n\n        Next\n\n\n    End If\n\n\nNext\nApplication.ScreenUpdating = True\n\nSheets(\"Summary\").Activate\n\nEnd Sub\n</code></pre>\n\n<p><strong>*edit</strong>: After some testing I noticed that the error is gone when I use a full range of columns instead of only some columns.</p>\n\n<p>with error: </p>\n\n<pre><code>Set copyrange = sh.Range(\"A\" &amp; i &amp; \",V\" &amp; i)\n</code></pre>\n\n<p>w/o error:</p>\n\n<pre><code>Set copyrange = sh.Range(\"A\" &amp; i &amp; \":E\" &amp; i)\n</code></pre>\n\n<p><strong>*second edit:</strong></p>\n\n<p>I'm using the code from 'Tim Williams'. There was the same error. Instead of using:</p>\n\n<pre><code>rw.Range(\"A1:E1,I1:O1,Q1,V1\").Copy rng.Offset(0, 1)\n</code></pre>\n\n<p>I've found a workaround. I split it up. </p>\n\n<pre><code>rw.Range(\"I1:O1\").Copy rng.Offset(0, 6)\nrw.Range(\"Q1\").Copy rng.Offset(0, 13)\nrw.Range(\"V1\").Copy rng.Offset(0, 14)\n</code></pre>\n\n<p>Now this works without error. But if anyone knows what causes the problem, you may always share it. Thanks in advance.</p>\n\n<p><strong>*third edit:</strong></p>\n\n<p>I still don't know why it doesn't work. It has something to do with range from different columns. The funny (and very frustrated part) is that I use range this way in another sheet and there I don't have this problem. It is driving me mad. Does someone have an idea?</p>\n"}, {"tags": ["vba", "excel", "average"], "answers": [{"comments": [{"owner": {"reputation": 431, "user_id": 8470267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb03d7c71895822a3a0922d7a0684059?s=128&d=identicon&r=PG&f=1", "display_name": "mrduncle1", "link": "https://stackoverflow.com/users/8470267/mrduncle1"}, "edited": false, "score": 0, "creation_date": 1571632902, "post_id": 29802868, "comment_id": 103291751, "body": "Should the last line be: Cells(j, 20).Value = Application.WorkSheetFunction.Average(myRange)"}], "tags": [], "owner": {"reputation": 283, "user_id": 4801586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PJcwl.png?s=128&g=1", "display_name": "314UnreadEmails", "link": "https://stackoverflow.com/users/4801586/314unreademails"}, "is_accepted": true, "score": 5, "last_activity_date": 1429822051, "last_edit_date": 1429822051, "creation_date": 1429718129, "answer_id": 29802868, "question_id": 29800992, "link": "https://stackoverflow.com/questions/29800992/average-in-vba-in-excel/29802868#29802868", "title": "Average in VBA in Excel", "body": "<p>Look closely at what you're trying to do in this code:</p>\n\n<pre><code>l = Cells(i, 12).Value\nm = Cells(k, 12).Value\n\nCells(j, 20).Value = [Average (l : m)]\n</code></pre>\n\n<p>You're assigning a \"long\" value to each of <code>l</code> and <code>m</code> and then calling them in the average function as if they were references to a cell.</p>\n\n<p>I suggest that you add a range variable, assign the <em>location</em> of the data you want to average and use that as your function argument.</p>\n\n<p>Something like:</p>\n\n<pre><code>Dim myRange as Range\n\n'Loop code here\nSet myRange = Range(\"L\" &amp; i &amp; \":L\" &amp; k)\nCells(j, 20).Value = Application.Average(myRange)\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 4819972, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c8d00191b3a6139b3c7fc488807f4dc4?s=128&d=identicon&r=PG&f=1", "display_name": "Harshit Mehra", "link": "https://stackoverflow.com/users/4819972/harshit-mehra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40948, "favorite_count": 0, "accepted_answer_id": 29802868, "answer_count": 1, "score": 2, "last_activity_date": 1618138158, "creation_date": 1429713539, "last_edit_date": 1618138158, "question_id": 29800992, "link": "https://stackoverflow.com/questions/29800992/average-in-vba-in-excel", "title": "Average in VBA in Excel", "body": "<p>I am new to VBA in excel. I have a range of data with 11 000 numbers. I want to calculate the average of first 60, then next 60 until the end. I did some programming but it isn't working. Can someone please help me with it?</p>\n<pre><code>Sub Hourlyaverage()\n    Dim i As Long, j As Long, k As Long, l  As Long, m As Long\n    \n    Sheets(&quot;DUT1_Test51_excel&quot;).Select\n    \n    i = 3\n    j = 3\n    k = 63\n        \n    Do While Cells(i, 12).Value &lt;&gt; &quot;&quot;\n        \n        l = Cells(i, 12).Value\n        m = Cells(k, 12).Value\n        \n        Cells(j, 20).Value = [Average (l : m)]\n        i = i + 60\n        j = j + 1\n        k = k + 60\n    Loop\n    \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "vbscript"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1429713429, "post_id": 29800713, "comment_id": 47729882, "body": "Why not: <code>Split(array(0,x), &quot;_&quot;)(1)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 37163, "user_id": 603855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91b541c001a51839aebfb1da088861b9?s=128&d=identicon&r=PG", "display_name": "Ekkehard.Horner", "link": "https://stackoverflow.com/users/603855/ekkehard-horner"}, "is_accepted": false, "score": 1, "last_activity_date": 1429714870, "creation_date": 1429714870, "answer_id": 29801583, "question_id": 29800713, "link": "https://stackoverflow.com/questions/29800713/trouble-with-vbs-instr-using-a-nested-instr-as-the-optional-start-argument/29801583#29801583", "title": "Trouble with VBS InStr - using a nested InStr as the optional start argument", "body": "<p>The easy solution is using Split():</p>\n\n<pre><code>&gt;&gt; Dim array(0,0)\n&gt;&gt; array(0,0) = \"USA_66544_File.doc\"\n&gt;&gt; WScript.Echo array(0,0), Split(array(0,0), \"_\")(1)\n&gt;&gt;\nUSA_66544_File.doc 66544\n</code></pre>\n\n<p>I used the variable name <code>array</code> in this demo, because I want to make sure that re/mis-using the name of the <a href=\"https://msdn.microsoft.com/en-us/library/dsxhtazh%28v=vs.84%29.aspx\" rel=\"nofollow\">Array()</a> function does not throw an error. Still choosing a better name is advisable.</p>\n\n<p>If you want to use Mid() and Instr(), do it step by step:</p>\n\n<pre><code>&gt;&gt; s = \"USA_66544_File.doc\"\n&gt;&gt; f = InStr(1, s, \"_\") + 1\n&gt;&gt; t = InStr(f, s, \"_\")\n&gt;&gt; l = t - f\n&gt;&gt; WScript.Echo Mid(s, f, l)\n&gt;&gt;\n66544\n</code></pre>\n\n<p>After having done it correctly, optimizing is easy:</p>\n\n<pre><code>&gt;&gt; s = \"USA_66544_File.doc\"\n&gt;&gt; f = InStr(1, s, \"_\") + 1\n&gt;&gt; WScript.Echo Mid(s, f, InStr(f, s, \"_\") - f)\n&gt;&gt;\n66544\n</code></pre>\n\n<p>Inlining f (i.e. repeating the expression) would surely not be an optimization, especially if you consider the need to add some error checks.</p>\n"}], "owner": {"reputation": 21, "user_id": 4170440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e19fa08af6c02d528108ab8a7c952dd?s=128&d=identicon&r=PG&f=1", "display_name": "DoubleUB", "link": "https://stackoverflow.com/users/4170440/doubleub"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 488, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1429714870, "creation_date": 1429712823, "last_edit_date": 1531164843, "question_id": 29800713, "link": "https://stackoverflow.com/questions/29800713/trouble-with-vbs-instr-using-a-nested-instr-as-the-optional-start-argument", "title": "Trouble with VBS InStr - using a nested InStr as the optional start argument", "body": "<p>Good morn all...I need some help porting a function from VBA to VBS</p>\n\n<p>Here is an example of the data set my question is based on. </p>\n\n<pre><code>USA_66544_File.doc\nRUS_3465_File.txt\n</code></pre>\n\n<p>I used the function to extract the string of numbers between the two underscores. In case it matters, i started off by breaking the string into segments, based on the underscore, then patched this together to isolate just the string i wanted.</p>\n\n<pre><code>=MID(A5,FIND(\"_\",A5)+1,FIND(\"_\",A5,FIND(\"_\",A5)+1)-FIND(\"_\",A5)-1) '##original working in Excel\n</code></pre>\n\n<p>The output from the above would be 66544 and 3465 respectively.</p>\n\n<p>I then needed to port this function to VBS.  MID is ok, but FIND changes to InStr.  Also, my cell reference (A5) changes to a 2D array of size array(1,7) </p>\n\n<pre><code>MID(array(0,x),InStr(array(0,x),\"_\")+1,InStr(InStr(array(0,x),\"_\")+1),array(0,x),\"_\")'-(Instr(array(0,x),\"_\")-1)\n</code></pre>\n\n<p>I am getting the error \"Wrong number of arguments or invalid property assignment\".  </p>\n\n<p>Here is what i think i am doing. MID accepts three arguments, with the last being optional. </p>\n\n<pre><code>MID(string, start, [# of char to return]\n</code></pre>\n\n<ol>\n<li>string = array(0,x)</li>\n<li>start = InStr(array(0,x),\"_\")+1 (this should find an underscore,\nthen return the next number)</li>\n<li>length =\nInstr(Instr(array(0,x),\"<em>\"),array(0,x),\"</em>\")-Instr(array(0,x),\"_\")-1</li>\n</ol>\n\n<p>So to bring it all together in case it matters, in my 2D array, the first dimension will contain the full string</p>\n\n<pre><code>USA_66544_File.doc\nRUS_3465_File.txt\n</code></pre>\n\n<p>And the second, the output from the function</p>\n\n<pre><code>66544\n3465\n</code></pre>\n\n<p>I anyone can help me make sense of this, I'd greatly appreciate it.\nThanks,\nHerb</p>\n"}, {"tags": ["vba", "excel", "for-loop"], "comments": [{"owner": {"reputation": 731, "user_id": 1505019, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7b88fdc5f054ea6f18af95365a85826b?s=128&d=identicon&r=PG", "display_name": "bmende", "link": "https://stackoverflow.com/users/1505019/bmende"}, "edited": false, "score": 0, "creation_date": 1462376953, "post_id": 29800363, "comment_id": 61615041, "body": "If an answer solved your problem you can click the check mark to help reward those who helped you :)"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 4137886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a69e7ffb8b0a3a2464707ecd947355a3?s=128&d=identicon&r=PG&f=1", "display_name": "DomSchwe", "link": "https://stackoverflow.com/users/4137886/domschwe"}, "edited": false, "score": 0, "creation_date": 1429713141, "post_id": 29800638, "comment_id": 47729605, "body": "Did this, except moved the status bar to only update to reflect the date, it worked great!"}], "tags": [], "owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "is_accepted": false, "score": 2, "last_activity_date": 1429713136, "last_edit_date": 1429713136, "creation_date": 1429712660, "answer_id": 29800638, "question_id": 29800363, "link": "https://stackoverflow.com/questions/29800363/vba-nested-for-loop-crashing-excel/29800638#29800638", "title": "VBA Nested For Loop Crashing Excel", "body": "<p>Try this. You don't need to keep selecting the sheets as this will an an additional overhead to excel. Instead just reference the cell like so:</p>\n\n<pre><code>Sub Create()\nDim dates, groups, current As Integer\nDim dateValue As Date\nDim groupValue As String\nDim cell As Long\n\nApplication.ScreenUpdating = False\nSheets(3).Cells.Clear\ncell = 1\n\nFor dates = 1 To 730\n\n    dateValue = Sheets(1).Cells(dates, 1).Value\n\n    For groups = 1 To 155\n\n        Application.StatusBar = dateValue &amp; \" \" &amp; groupValue\n\n        groupValue = Sheets(2).Cells(groups, 1).Value\n\n        Sheets(3).Cells(cell, 1) = dateValue\n        Sheets(3).Cells(cell, 2) = groupValue\n\n        cell = cell + 1\n\n    Next groups\n\nNext dates\n\nApplication.StatusBar = False\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 4137886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a69e7ffb8b0a3a2464707ecd947355a3?s=128&d=identicon&r=PG&f=1", "display_name": "DomSchwe", "link": "https://stackoverflow.com/users/4137886/domschwe"}, "edited": false, "score": 0, "creation_date": 1429713091, "post_id": 29800653, "comment_id": 47729558, "body": "Removing all of the &#39;.Select&#39; worked perfectly! And thank you for pointing out the status bar issue, once I changed it to only reflect the date value then everything worked."}], "tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": true, "score": 2, "last_activity_date": 1429712684, "creation_date": 1429712684, "answer_id": 29800653, "question_id": 29800363, "link": "https://stackoverflow.com/questions/29800363/vba-nested-for-loop-crashing-excel/29800653#29800653", "title": "VBA Nested For Loop Crashing Excel", "body": "<p>Remove the <code>.Select</code> calls.</p>\n\n<pre><code>groupValue = Sheets(2).Cells(groups, 1).Value\n</code></pre>\n\n<p>Is better than</p>\n\n<pre><code>Sheets(2).Select\ngroupValue = Cells(groups, 1).Value\n</code></pre>\n\n<p><code>.Select</code> is slow and expensive and unnecessary.</p>\n\n<p>Does the statusbar actually update? doing so 100k times is likewise a bottleneck; use a mod counter to update every nth iteration.</p>\n"}], "owner": {"reputation": 55, "user_id": 4137886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a69e7ffb8b0a3a2464707ecd947355a3?s=128&d=identicon&r=PG&f=1", "display_name": "DomSchwe", "link": "https://stackoverflow.com/users/4137886/domschwe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 522, "favorite_count": 0, "accepted_answer_id": 29800653, "answer_count": 2, "score": 2, "last_activity_date": 1429713136, "creation_date": 1429712106, "question_id": 29800363, "link": "https://stackoverflow.com/questions/29800363/vba-nested-for-loop-crashing-excel", "title": "VBA Nested For Loop Crashing Excel", "body": "<p>I am currently trying to create a list of all possible combinations of entries from two separate sheets, but whenever I try to run it, Excel crashes after about 20 seconds. Does anybody have any tips for how to make this more efficiently, or a way to make this work? Thanks!</p>\n\n<pre><code>Sub Create()\nDim dates, groups, current As Integer\nDim dateValue As Date\nDim groupValue As String\nDim cell As Long\n\nApplication.ScreenUpdating = False\nSheets(3).Cells.Clear\ncell = 1\n\nFor dates = 1 To 730\n\n    Sheets(1).Select\n    dateValue = Cells(dates, 1).Value\n\n    For groups = 1 To 155\n\n        Application.StatusBar = dateValue &amp; \" \" &amp; groupValue\n\n        Sheets(2).Select\n        groupValue = Cells(groups, 1).Value\n\n        Sheets(3).Select\n\n        Cells(cell, 1) = dateValue\n        Cells(cell, 2) = groupValue\n\n        cell = cell + 1\n\n    Next groups\n\nNext dates\n\nApplication.StatusBar = False\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["windows", "vba", "excel", "adodb"], "comments": [{"owner": {"reputation": 898, "user_id": 1877243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a8367ce3b86fa61716da633427c1d1?s=128&d=identicon&r=PG", "display_name": "Tim Sands", "link": "https://stackoverflow.com/users/1877243/tim-sands"}, "edited": false, "score": 2, "creation_date": 1429712865, "post_id": 29800151, "comment_id": 47729348, "body": "Unfortunately, the best advice is don&#39;t use Excel as an authentication system.  You&#39;ll have to spend tons of time recreating the wheel, and when you&#39;re done, it won&#39;t be a very round wheel. You&#39;ll need a one way encryption hashing, since storing passwords as plain text is a no-no."}, {"owner": {"reputation": 377, "user_id": 4515246, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/97a1a7d84c476fd43e855aac6622de1b?s=128&d=identicon&r=PG&f=1", "display_name": "otus", "link": "https://stackoverflow.com/users/4515246/otus"}, "reply_to_user": {"reputation": 898, "user_id": 1877243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a8367ce3b86fa61716da633427c1d1?s=128&d=identicon&r=PG", "display_name": "Tim Sands", "link": "https://stackoverflow.com/users/1877243/tim-sands"}, "edited": false, "score": 0, "creation_date": 1429713168, "post_id": 29800151, "comment_id": 47729645, "body": "Thanks for you answer.Actually i&#39;m told to do so even if it&#39;s not a good practice. Can you please give more details or links about what I have to do."}], "answers": [{"tags": [], "owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "is_accepted": false, "score": 0, "last_activity_date": 1429713653, "creation_date": 1429713653, "answer_id": 29801054, "question_id": 29800151, "link": "https://stackoverflow.com/questions/29800151/limit-access-to-an-excel-file-database/29801054#29801054", "title": "Limit access to an Excel file database", "body": "<p>Safeguards:</p>\n\n<ol>\n<li>Hide the window when reading, at the end of the sub close the workbook.</li>\n<li>Password protect the workbook, its VBE with a separate password.</li>\n<li>Password protect the sub that calls the workbook (containing the password as plain text).</li>\n<li>Events to every possible occasion to close the workbook if accessed manually.</li>\n<li>If someone only needs to read it, a query can be set up on the fly then disconnected ASAP.</li>\n</ol>\n\n<p>Make sure you double- and triplecheck whether you can use alternatives, Excel is not safe.</p>\n"}, {"tags": [], "owner": {"reputation": 898, "user_id": 1877243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a8367ce3b86fa61716da633427c1d1?s=128&d=identicon&r=PG", "display_name": "Tim Sands", "link": "https://stackoverflow.com/users/1877243/tim-sands"}, "is_accepted": false, "score": 0, "last_activity_date": 1429714412, "creation_date": 1429714412, "answer_id": 29801390, "question_id": 29800151, "link": "https://stackoverflow.com/questions/29800151/limit-access-to-an-excel-file-database/29801390#29801390", "title": "Limit access to an Excel file database", "body": "<p>Instead of using Excel to store passwords, you can test who is currently logged in to windows via <code>curr_user=Environ(\"USERNAME\")</code> in VBA.  </p>\n\n<p>This pushes the authentication to Windows and you don't have to store passwords. Then you just need to look up the <code>curr_user</code> on a list of authorized users, which is better than storing a list of users and passwords. @user3819867 's suggestions would still apply to this 'user list', just as it would to a 'user and password' list.</p>\n\n<p>Only trade-off is that you couldn't run the Excel database on someone else's computer, but that might be a reasonable compromise compared to the alternative.</p>\n"}], "owner": {"reputation": 377, "user_id": 4515246, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/97a1a7d84c476fd43e855aac6622de1b?s=128&d=identicon&r=PG&f=1", "display_name": "otus", "link": "https://stackoverflow.com/users/4515246/otus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1429714412, "creation_date": 1429711624, "question_id": 29800151, "link": "https://stackoverflow.com/questions/29800151/limit-access-to-an-excel-file-database", "title": "Limit access to an Excel file database", "body": "<p>I'm using some Excel files like databases. </p>\n\n<p>Those files are read by a VBA code that extract data from it. </p>\n\n<p>For example I've created an Excel file containing logins and password to build an authentification system. </p>\n\n<p>What I would like to do now is to limit access to those files so that only my code can access/modify them.</p>\n"}, {"tags": ["excel", "vba", "adobe-analytics", "reportbuilder"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4819079, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155442042520524/picture?type=large", "display_name": "Bas Van de Pol", "link": "https://stackoverflow.com/users/4819079/bas-van-de-pol"}, "is_accepted": false, "score": 0, "last_activity_date": 1429783153, "creation_date": 1429783153, "answer_id": 29820033, "question_id": 29800016, "link": "https://stackoverflow.com/questions/29800016/adobe-report-builder-macro-for-multiple-workbooks/29820033#29820033", "title": "Adobe Report builder macro for multiple workbooks", "body": "<p>I found a line that could prove a solution. The Report Builder excel plug-in finishes it's work but unfortunately I get an error</p>\n\n<p>Line:</p>\n\n<blockquote>\n  <p>Threading.thread.Sleep (60000)</p>\n</blockquote>\n\n<p>Error:</p>\n\n<blockquote>\n  <p>object required 424</p>\n</blockquote>\n\n<p>VBA used:</p>\n\n<pre><code>Application.Wait (Now() + TimeValue(\"00:00:02\"))\nApplication.CommandBars(\"Adobe Report Builder Toolbar\").Controls(5).Execute\nApplication.Wait (Now() + TimeValue(\"00:00:010\"))\nThreading.thread.Sleep (60000)\n\nSheets(\"Week on week 2015\").Select\nActiveWorkbook.RefreshAll\nActiveWorkbook.RefreshAll\nActiveWorkbook.RefreshAll\nRange(\"F8\").Select\nActiveWorkbook.RefreshAll\nActiveWorkbook.Save\nActiveWindow.Close\n</code></pre>\n\n<p>Does anyone have a solution for this? </p>\n"}], "owner": {"reputation": 1, "user_id": 4819079, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155442042520524/picture?type=large", "display_name": "Bas Van de Pol", "link": "https://stackoverflow.com/users/4819079/bas-van-de-pol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 403, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429783153, "creation_date": 1429711360, "last_edit_date": 1429711978, "question_id": 29800016, "link": "https://stackoverflow.com/questions/29800016/adobe-report-builder-macro-for-multiple-workbooks", "title": "Adobe Report builder macro for multiple workbooks", "body": "<p>I came accross a problem here this week. In my case I try to update report builder via macro and then refresh the file to update pivots. I want to do this for multiple workbooks.</p>\n\n<p>I used this macro:</p>\n\n<pre><code>Application.Wait (Now() + TimeValue(\"00:00:02\"))\n\nDim addIn As COMAddIn\nDim automationObject As Object\nDim success As String\nSet addIn = Application.COMAddIns(\"ReportBuilderAddIn.Connect\")\nSet automationObject = addIn.Object\nsuccess = automationObject.RefreshAllRequests(ActiveWorkbook)\nApplication.Wait (Now() + TimeValue(\"00:00:10\"))\n\nSheets(\"Week on week 2015\").Select\nActiveWorkbook.RefreshAll\nActiveWorkbook.RefreshAll\nActiveWorkbook.RefreshAll\nRange(\"F8\").Select\nActiveWorkbook.RefreshAll\nActiveWorkbook.Save\nActiveWindow.Close\n</code></pre>\n\n<p>It seems the second Application.Wait is screwing the whole macro up. When I don't use the second Application.Wait the issue is that the RefreshAll will start too early while Report Builder is still running. The first file will close and save while the second file opens. This won't work due to the fact that the first file still hass Report Builder running.</p>\n\n<p>Conclusion: \nDoes anyone know a better way to wait/pauze the macro while Report Builder can finish it's update? \nOr does anyone know how to call the success line and activate a second part of the macro by identifying the completion of the succesline? </p>\n"}, {"tags": ["vba", "excel", "excel-2010", "outlook-2010"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1429711578, "post_id": 29799468, "comment_id": 47728233, "body": "I&#39;d suggest adding <code>.Chart.ChartArea.Clear</code> before you paste the picture in."}, {"owner": {"reputation": 321, "user_id": 2195626, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/G9vYL.jpg?s=128&g=1", "display_name": "Mike Marshall", "link": "https://stackoverflow.com/users/2195626/mike-marshall"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1429711770, "post_id": 29799468, "comment_id": 47728393, "body": "Where would I place this in the code?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1429711924, "post_id": 29799468, "comment_id": 47728523, "body": "Just before <code>.Chart.Paste</code>"}, {"owner": {"reputation": 321, "user_id": 2195626, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/G9vYL.jpg?s=128&g=1", "display_name": "Mike Marshall", "link": "https://stackoverflow.com/users/2195626/mike-marshall"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1429715434, "post_id": 29799468, "comment_id": 47731544, "body": "Clearing the chart did not work, but I finally discovered the root issue.  In both cases where the Jpeg would show the chart in the background I was tying to convert a range with two separate Pivot Tables.  If the range I am selecting only has one pivot table, it will work every time.  When I try to include two pivot tables it will not work."}], "answers": [{"tags": [], "owner": {"reputation": 321, "user_id": 2195626, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/G9vYL.jpg?s=128&g=1", "display_name": "Mike Marshall", "link": "https://stackoverflow.com/users/2195626/mike-marshall"}, "is_accepted": false, "score": 1, "last_activity_date": 1429725587, "last_edit_date": 1429725587, "creation_date": 1429716930, "answer_id": 29802388, "question_id": 29799468, "link": "https://stackoverflow.com/questions/29799468/error-converting-excel-range-to-jpeg-and-inserting-into-outlook/29802388#29802388", "title": "Error converting Excel range to Jpeg and inserting into Outlook", "body": "<p>The issue is created when trying to convert more than one table into a picture.  My solution was to create each table as its own Jpeg, and insert each jpeg into the Email.  </p>\n"}], "owner": {"reputation": 321, "user_id": 2195626, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/G9vYL.jpg?s=128&g=1", "display_name": "Mike Marshall", "link": "https://stackoverflow.com/users/2195626/mike-marshall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 742, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1460550540, "creation_date": 1429710164, "last_edit_date": 1531164843, "question_id": 29799468, "link": "https://stackoverflow.com/questions/29799468/error-converting-excel-range-to-jpeg-and-inserting-into-outlook", "title": "Error converting Excel range to Jpeg and inserting into Outlook", "body": "<p>I have code to convert a range in Excel 2010 to a Jpeg and insert that into Outlook 2010.  The code converts the range to a chart and then creates the Jpeg.  The Jpeg will sometimes get corrupted and show the chart in the background behind the range I am attempting to show.  Here is an example:</p>\n\n<p><img src=\"https://i.stack.imgur.com/0dMqb.jpg\" alt=\"Jpeg Error\"></p>\n\n<p>Here is my code for this:</p>\n\n<pre><code>Sub Mail_AS_Pic()\n\nDim TempFilePath As String\nDim OutApp As Outlook.Application\nDim OutMail As Outlook.MailItem\n\nOn Error Resume Next\n\nKill TempFilePath &amp; \"Quota.jpg\"\n\nDim sh As Worksheet\nSet sh = Sheets(\"Strategic\")\n\n    'Create a new Microsoft Outlook session\n    Set OutApp = CreateObject(\"outlook.application\")\n    'create a new message\n    Set OutMail = OutApp.CreateItem(olMailItem)\n\n    With OutMail\n        .SentOnBehalfOfName = \"Me@Me.Com\"\n        .Display\n        .Subject = \"Strategic Sales\"\n        .To = \"Me@Me.Com\"\n        Call createJpg(\"Strategic\", \"A1:F11\", \"Quota\")\n        'This runs the macro below and creates the jpeg\n        TempFilePath = Environ$(\"temp\") &amp; \"\\\"\n        .Attachments.Add TempFilePath &amp; \"Quota.jpg\", olByValue, 0\n        'we attached the embedded image with a Position at 0 (makes the attachment hidden)\n        '.Attachments.Add \n        'Then we add an html &lt;img src=''&gt; link to this image\n        'Note than you can customize width and height - not mandatory\n\n        '&lt;br&gt;&lt;br&gt; is a return or line space\n        .HTMLBody = \"&lt;br&gt;\" _\n            &amp; \"Attached please find the Strategic Sales for the month.\" _\n            &amp; \"&lt;br&gt;&lt;br&gt;\" _\n            &amp; \"Please reach out to me with any questions.\" _\n            &amp; \"&lt;br&gt;&lt;br&gt;\" _\n            &amp; \"&lt;img src='cid:Quota.jpg'\" &amp; \"width=width height=heigth&gt;&lt;br&gt;&lt;br&gt;\" _\n            &amp; \"&lt;br&gt;&lt;br&gt;\" _\n            &amp; \"Thank you,\" _\n            &amp; .HTMLBody\n\n        .Display\n        '.Send\n    End With\n\nKill TempFilePath &amp; \"Quota.jpg\"\n\nSet sh = Nothing\nSet OutApp = Nothing\nSet OutMail = Nothing\n\n\nEnd Sub\n\nSub createJpg(Namesheet As String, nameRange As String, nameFile As String)\nThisWorkbook.Activate\nWorksheets(Namesheet).Activate\nSet Plage = Nothing\nSet Plage = ThisWorkbook.Worksheets(Namesheet).Range(nameRange)\nPlage.CopyPicture\nWith ThisWorkbook.Worksheets(Namesheet).ChartObjects.Add(Plage.Left, Plage.Top, Plage.width, Plage.height)\n    .Activate\n    .Chart.Paste\n    .Chart.Export Environ$(\"temp\") &amp; \"\\\" &amp; nameFile &amp; \".jpg\", \"JPG\"\nEnd With\n    Worksheets(Namesheet).ChartObjects(Worksheets(Namesheet).ChartObjects.Count).Delete\n\nSet Plage = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>I am using this code in several Workbook, one of which creates a Jpeg for two separate ranges.  One of the conversions works every time, the other creates and error every time.  Both are converting data from a Pivot table.</p>\n\n<p>I've been trying to solve this for some time with no luck.  Any help would be appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1429710566, "post_id": 29799420, "comment_id": 47727354, "body": "Is the data in the Column H validation a number? Or is it some text, which would identify the row to copy?  Does your data go from Col. A to G? What does the data look like?"}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1429711583, "post_id": 29799420, "comment_id": 47728242, "body": "I would use color, font size changes or comments. If there is e.g. a comment saying &quot;already copied&quot; then do nothing, otherwise copy row and add the comment &quot;already copied&quot;."}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1429712201, "post_id": 29799420, "comment_id": 47728763, "body": "@Rookie: you could use a formula in a hidden column that marks the row for copying based on column H and J. Then run a macro that copies the marked rows."}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1429712272, "post_id": 29799420, "comment_id": 47728826, "body": "@Rookie: See <a href=\"http://stackoverflow.com/questions/16268911/copy-a-row-in-excel-if-it-matches-a-specific-criteria-into-a-new-worksheet\">SO: copy-a-row-in-excel-if-it-matches-a-specific-criteria-into-a&zwnj;&#8203;-new-worksheet</a> and <a href=\"http://stackoverflow.com/questions/21074874/vba-copy-rows-that-meet-criteria-to-another-sheet\">SO - 2107487: vba-copy-rows-that-meet-criteria-to-another-sheet</a>"}, {"owner": {"reputation": 1, "user_id": 4819623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8946c873e991102f606c8fc7e5e5f491?s=128&d=identicon&r=PG&f=1", "display_name": "Rookie", "link": "https://stackoverflow.com/users/4819623/rookie"}, "edited": false, "score": 0, "creation_date": 1429713736, "post_id": 29799420, "comment_id": 47730189, "body": "My Col H data is a data validation list - all text, and any selection (cell is not null) identifies the row as one to be copied.  I don&#39;t want users having to add a comment, i.e. &quot;already copied&quot; anywhere, but would prefer the macro added something like this it auto-magically, when the copy was performed.  I&#39;m going to check out the links provided and see if I can make a go of it.  thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1429719736, "creation_date": 1429719736, "answer_id": 29803507, "question_id": 29799420, "link": "https://stackoverflow.com/questions/29799420/excel-vba-and-moving-rows/29803507#29803507", "title": "Excel, VBA and moving rows", "body": "<p>Okay - with the info. I have gathered from your posts, I have the following:</p>\n\n<pre><code>Sub copyRows()\nDim xRow As Integer, xCol As Integer, lastCol As Integer\nDim dataValidation As Range, rowToCopy As Integer, copyRange As Range, destRange As Range\nDim copyWSRow As Integer, jColValue As String\nDim origWS As Worksheet, copyWS As Worksheet\n\nSet origWS = ActiveSheet\n\n' Edit these two lines as needed.  If you have the \"copy\" worksheet already, comment out the first line\n' and then change the 'Sheets(\"Copy\")' to 'Sheets(\"_____\")'\nWorksheets.Add(after:=Worksheets(1)).Name = \"Copy\"\nSet copyWS = Sheets(\"Copy\")\n\norigWS.Activate\n\nSet dataValidation = origWS.Cells(1, 8) ' Cell H1 has your data validation.  Change this as necessary\nrowToCopy = dataValidation.Value\n\n'find the last column used, that isn't Col. H.  If it's column H, assume G is the last column\nlastCol = origWS.Cells(1, 1).End(xlToRight).Column\nIf lastCol = 8 Then lastCol = lastCol - 1\n\nWith origWS\nSet copyRange = .Range(.Cells(rowToCopy, 1), .Cells(rowToCopy, lastCol))\nEnd With\n\n'What's the next available row in the Copy WS?\nIf copyWS.UsedRange.Rows.Count = 1 And copyWS.Cells(1, 1).Value = \"\" Then\n    copyWSRow = 1\nElse\n    copyWSRow = copyWS.UsedRange.Rows.Count + 1 ' count the used rows, and add one to make the next blank row the row to copy to\nEnd If\n'Set the destination Range\n\nWith copyWS\nSet destRange = .Range(.Cells(copyWSRow, 1), .Cells(copyWSRow, lastCol))\nEnd With\n\n'Now, just copy the info over (technically, just set values equal)\ndestRange.Value = copyRange.Value\n\n'Now, check to see if Column J has any info - if so, add to the line we just did in the Copy WS\nIf origWS.Cells(1, 10).Value &lt;&gt; \"\" Then\n    jColValue = origWS.Cells(1, 10).Value\n    copyWS.Cells(copyWSRow, 10).Value = jColValue\nEnd If\n\n\n\n ' Add note that the row was copied\n    origWS.Cells(rowToCopy,13).Value = \"Already Copied\"\n\n    End Sub\n</code></pre>\n\n<p>A few notes: I have assumed that the right most column, with data you want to copy, will be Column G - since H has the row value.</p>\n\n<p>Also, I have H1 as the cell that has your data validation - you might need to edit this as necessary.</p>\n\n<p>I tested this with some data, in column A through G, with H1 and J1 being the data validation (where it outputs a number) and J1 as the \"extra\" information.  If you want the 'extra info' to be on EACH row of the data, and not in one absolute spot, just change the <code>jColValue</code> formula to <code>jColValue = origWS.Cells(rowToCopy,10).Value</code>.</p>\n\n<p>And of course, if this doesn't work or needs tweaking, just let me know.    </p>\n"}], "owner": {"reputation": 1, "user_id": 4819623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8946c873e991102f606c8fc7e5e5f491?s=128&d=identicon&r=PG&f=1", "display_name": "Rookie", "link": "https://stackoverflow.com/users/4819623/rookie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 306, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429719736, "creation_date": 1429710031, "last_edit_date": 1531161705, "question_id": 29799420, "link": "https://stackoverflow.com/questions/29799420/excel-vba-and-moving-rows", "title": "Excel, VBA and moving rows", "body": "<p>I am a rookie re: VBA and macros (creating or running).  I need some assistance with code that will help me copy a row from one spreadsheet to another, leaving it in the original sheet and marking somehow (I think), or otherwise ensuring it's not copied again in the future.  I found a few posts about moving rows, most relied on a date entry, but this does not work for my purpose. My sheet has a column (H) with drop down data validation - any entry into the cell from the drop down will identify the row as one to copy to the next sheet.  However, there is also a column that follows (J), where data entry is optional, and I don't want the row copied before giving the user the opportunity to enter into that column, so that it's contents would copy also (or maybe that's a set of separate code?).  Rows copied to new spreadsheet should be inserted into next available row. thank you for any assistance &amp; instructions you can offer.</p>\n"}, {"tags": ["ms-access", "vba", "msgbox", "subform"], "comments": [{"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1429711147, "post_id": 29799390, "comment_id": 47727850, "body": "you have asked this question already? anyhow, can you share your table definitions for user, group and office? I have the feeling your DB design is incorrect. Also Form_delete will fire the number of times the records are selected to delete. From_onbeforedelete will only fire once"}, {"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 0, "creation_date": 1429711327, "post_id": 29799390, "comment_id": 47728027, "body": "This has been asked before and then the question deleted by the author. it was <a href=\"http://stackoverflow.com/questions/29557179/access-vba-form-delete-sub-runs-twice-times\" title=\"access vba form delete sub runs twice times\">stackoverflow.com/questions/29557179/&hellip;</a>"}, {"owner": {"reputation": 117, "user_id": 4018649, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/2c18d55b2a894be50c850e03b3812a2c?s=128&d=identicon&r=PG&f=1", "display_name": "nayomi", "link": "https://stackoverflow.com/users/4018649/nayomi"}, "edited": false, "score": 0, "creation_date": 1429712514, "post_id": 29799390, "comment_id": 47729023, "body": "I ask the question again to find a solution"}], "answers": [{"tags": [], "owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "is_accepted": false, "score": 0, "last_activity_date": 1429815659, "creation_date": 1429815659, "answer_id": 29832147, "question_id": 29799390, "link": "https://stackoverflow.com/questions/29799390/access-vba-why-form-delete-sub-runs-twice-times/29832147#29832147", "title": "access vba: why form_delete sub runs twice times", "body": "<p>Nayomi, </p>\n\n<p><code>Form_Delete()</code> is not what you should use here. Looking at your <code>Private Sub buro_delete()</code> code, you are <em>updating</em> the underlying data to remove a foreign key. You are not deleting anything. </p>\n\n<p>Instead, use a 'Delete' command button, and move your event code there:</p>\n\n<pre><code>' your command button\nPrivate Sub cmdDeleteForeignKey)\n   If MsgBox(\"are you sure?\", vbYesNo, \"MsgBox\") = vbYes Then\n      Call buro_delete\n      Me.Requery\n   End If\nEnd Sub\n</code></pre>\n\n<p>You can also use the <code>Form_KeyDown</code> event to call the code when the user presses the Del key.</p>\n"}], "owner": {"reputation": 117, "user_id": 4018649, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/2c18d55b2a894be50c850e03b3812a2c?s=128&d=identicon&r=PG&f=1", "display_name": "nayomi", "link": "https://stackoverflow.com/users/4018649/nayomi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 402, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594644895, "creation_date": 1429709974, "last_edit_date": 1594644895, "question_id": 29799390, "link": "https://stackoverflow.com/questions/29799390/access-vba-why-form-delete-sub-runs-twice-times", "title": "access vba: why form_delete sub runs twice times", "body": "<p>I work with Access 97.</p>\n\n<p>I have a subform attached to a parent form.\nThe parent form is based on a database table and the subform based on select query: selects the offices that belongs to a group.</p>\n\n<p>I would allow user to pull an office from his group, so I thought about using the delete button and use The event delete as below:</p>\n\n<pre><code>Private Sub Form_Delete(Cancel As Integer)\n\nIf MsgBox(\"are you sure?\", vbYesNo, \"MsgBox\") = vbYes Then\n   Call buro_delete\nElse\n    Cancel = True\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Office and his group linked by a foreign key.\nThe office will not remove physically, but we will put the foreign key column to null.</p>\n\n<p><strong>buro_delete</strong></p>\n\n<pre><code>Private Sub buro_delete()\nDim l_adoConn As New ADODB.Connection\nDim l_adoCmd As New ADODB.Command\nDim l_ID As Long\nDim l_Sql As String\n\n l_adoConn.CommandTimeout = g_CmdTimeOut\n l_adoConn.Open (Allgemein.g_ADOConnStr)\n Set l_adoCmd.ActiveConnection = l_adoConn\n l_adoCmd.CommandType = adCmdText\n l_adoCmd.CommandTimeout = g_CmdTimeOut\n l_ID = Me.BTE_NR\n l_Sql = \"Update BUEROS Set KL_KETTE_ID=null Where BTE_NR=\" &amp; l_ID\n l_adoCmd.CommandText = l_Sql\n l_adoCmd.Execute\nEnd Sub\n</code></pre>\n\n<p>At run of the program, when I click on the delete button on any column in the subform, the msgbox is displayed the first time and it takes my answer (either yes or no) and then it appears for the second time.</p>\n\n<p>I make a breakpoints and I debug, I see that the system runs the form_delete sub, call the buro_delete sub, and then returns at beginning of buro_delete sub and complete running second time.</p>\n\n<p>why form_delete sub runs twice times?</p>\n\n<p>any idea please</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1429709299, "creation_date": 1429709299, "answer_id": 29799088, "question_id": 29798528, "link": "https://stackoverflow.com/questions/29798528/change-background-colour-based-on-current-background-colour/29799088#29799088", "title": "Change background colour based on current background colour", "body": "<p>Try:</p>\n\n<pre><code>Sub disco()\n    Dim col As Variant\n    Cells.Select\n    col = Selection.Interior.ColorIndex\n    If col = -4142 Then\n            Selection.Interior.ColorIndex = 1\n    ElseIf col = 1 Then\n            Selection.Interior.ColorIndex = -4142\n    End If\n    Range(\"a1\").Select\nEnd Sub\n</code></pre>\n\n<p><strong><em>NOTES:</em></strong></p>\n\n<p>we use <em>col</em> as a <strong>Variant</strong><br>we do not use 0</p>\n"}], "owner": {"reputation": 193, "user_id": 4768829, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/10155344932220401/picture?type=large", "display_name": "HotSauceCoconuts", "link": "https://stackoverflow.com/users/4768829/hotsaucecoconuts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429709299, "creation_date": 1429707978, "question_id": 29798528, "link": "https://stackoverflow.com/questions/29798528/change-background-colour-based-on-current-background-colour", "title": "Change background colour based on current background colour", "body": "<p>just playing around with vba, wanted to see if I could make the screen blink, but having trouble. </p>\n\n<p>I'm getting an object error at the moment.</p>\n\n<pre><code>Sub disco()\n\nDim col As Range\nCells.Select\nSet col = Selection.Interior.ColorIndex\n\nIf col = 0 Then\n        Selection.Interior.ColorIndex = 1\nElseIf col = 1 Then\n        Selection.Interior.ColorIndex = 0\nEnd If\n\nRange(\"a1\").Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba", "concatenation"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1429710198, "post_id": 29798411, "comment_id": 47727017, "body": "I don&#39;t really follow that example (read: I didn&#39;t really read it thoroughly or test it) but can&#39;t you use the <code>CountIf</code> function to determine &quot;the amount of products they bought&quot;?"}, {"owner": {"reputation": 26666, "user_id": 4564247, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Ig4ew.jpg?s=128&g=1", "display_name": "Pierre L", "link": "https://stackoverflow.com/users/4564247/pierre-l"}, "edited": false, "score": 0, "creation_date": 1429710402, "post_id": 29798411, "comment_id": 47727205, "body": "the approach in the technique will work if you add a formula counting the amount of times each name appears etc... But the bigger question is to consider if going through the hassle of creating multiple helper tables and a slew of formulas is the best way to achieve your goal? You are trying to make Excel do something with formulas that it is not made for. If you do this on a regular basis, you may want to consider one of the open-source data analysis programs or Excel VBAs that are purpose-built for this kind of job.(VBA, Python, R, etc...)"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1429710455, "post_id": 29798411, "comment_id": 47727255, "body": "Or VBA. A custom function could do this really easily."}, {"owner": {"reputation": 26666, "user_id": 4564247, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Ig4ew.jpg?s=128&g=1", "display_name": "Pierre L", "link": "https://stackoverflow.com/users/4564247/pierre-l"}, "edited": false, "score": 0, "creation_date": 1429710610, "post_id": 29798411, "comment_id": 47727396, "body": "Yes, David, thank you. just added"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1429710698, "creation_date": 1429710698, "answer_id": 29799708, "question_id": 29798411, "link": "https://stackoverflow.com/questions/29798411/concatenate-values-from-corresponding-table/29799708#29799708", "title": "Concatenate values from corresponding table", "body": "<p>I will delete this post as soon as you accept another person's non-vba solution.</p>\n\n<p>If we start with:</p>\n\n<p><img src=\"https://i.stack.imgur.com/Fxlnc.png\" alt=\"enter image description here\"></p>\n\n<p>and run this macro:</p>\n\n<pre><code>Sub ReOrganize()\n    Dim i As Long, N As Long, j As Long, st As String\n    Dim M As Long\n    Range(\"A:A\").Copy Range(\"E1\")\n    Range(\"E:E\").RemoveDuplicates Columns:=1, Header:=xlNo\n    N = Cells(Rows.Count, \"E\").End(xlUp).Row\n    M = Cells(Rows.Count, \"B\").End(xlUp).Row\n\n    For i = 1 To N\n        st = \"\"\n        v1 = Cells(i, \"E\").Value\n        For j = 1 To M\n            v2 = Cells(j, \"A\").Value\n            If v1 = v2 Then\n                st = st &amp; \", \" &amp; Cells(j, \"B\").Value\n            End If\n        Next j\n        Cells(i, \"F\").Value = Mid(st, 2)\n    Next i\nEnd Sub\n</code></pre>\n\n<p>we will get:</p>\n\n<p><img src=\"https://i.stack.imgur.com/dztnD.png\" alt=\"enter image description here\"></p>\n"}, {"tags": [], "owner": {"reputation": 898, "user_id": 1877243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a8367ce3b86fa61716da633427c1d1?s=128&d=identicon&r=PG", "display_name": "Tim Sands", "link": "https://stackoverflow.com/users/1877243/tim-sands"}, "is_accepted": false, "score": 0, "last_activity_date": 1429711151, "creation_date": 1429711151, "answer_id": 29799910, "question_id": 29798411, "link": "https://stackoverflow.com/questions/29798411/concatenate-values-from-corresponding-table/29799910#29799910", "title": "Concatenate values from corresponding table", "body": "<p>As pointed out in the comments it can be done with formulas, but VBA would really be ideal.  Limiting to only formulas adds quite a bit of complexity to it. </p>\n\n<p>That said, I'm a sucker for an Excel-Only challenge.  See <a href=\"https://dl.dropboxusercontent.com/u/10791482/SO_TableLookup.xlsx\" rel=\"nofollow noreferrer\">example workbook here</a></p>\n\n<p><img src=\"https://i.stack.imgur.com/CHfTD.png\" alt=\"Screenshot of working example\"></p>\n\n<p>Raw data is in Blue font, formulas in black. Helper tables have green headings.</p>\n\n<ul>\n<li>E5: <code>= COUNTIF(B$5:B5,B5)</code>.  Counts how many instances of Name have come before it in the table.</li>\n<li>F5: <code>=B5&amp;\"_\"&amp;E5</code></li>\n<li>E14: <code>=IFERROR(INDEX($C$5:$C$9,MATCH($B14&amp;\"_\"&amp;E$13,$F$5:$F$9,0)),\"\")</code>. This looks up 'John_1' or similar from the helper table.  If no matches are found, it returns a blank string \"\".</li>\n<li>F14: Same as E14, with \", \" appended to the output</li>\n</ul>\n"}], "owner": {"reputation": 431, "user_id": 447175, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/483e8f5d7c97fc6a596dcc2cf2d3b6e2?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/447175/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1429854354, "creation_date": 1429707703, "last_edit_date": 1429854354, "question_id": 29798411, "link": "https://stackoverflow.com/questions/29798411/concatenate-values-from-corresponding-table", "title": "Concatenate values from corresponding table", "body": "<p>I'm looking for a non-VBA approach for concatenating a list of of products from a corresponding table. If possible I would prefer to use an array-based formula.</p>\n\n<p>For instance, you have a table of Customers and each Item they bought.</p>\n\n<pre><code>John    Apple\nSteve   Orange\nJohn    Pear\nSteve   Grapes\nJohn    Tomato\n</code></pre>\n\n<p>Then on a separate table I would like to list each person (one per line), and list the products they bought separated by a comma:</p>\n\n<pre><code>John    Apple, Pear, Tomato\nSteve   Orange, Grapes\n</code></pre>\n\n<p>The closest thing I can find is <a href=\"http://fiveminutelessons.com/learn-microsoft-excel/use-index-lookup-multiple-values-list\" rel=\"nofollow\">this guide</a>, which I can adapt to concatenate but you would need to know the amount of products they bought.</p>\n"}, {"tags": ["vba", "excel", "excel-2013"], "answers": [{"comments": [{"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1429708109, "post_id": 29798513, "comment_id": 47725209, "body": "If you want to do it manually, you can do so via the View (sorry, no Cyrillic knowledge) &gt; Window &gt; Unhide icon."}, {"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 0, "creation_date": 1429708228, "post_id": 29798513, "comment_id": 47725321, "body": "not helpful  (( i get error  Object variable or With block variable not set"}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "reply_to_user": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 0, "creation_date": 1429708281, "post_id": 29798513, "comment_id": 47725359, "body": "<code>ActiveWindow.Visible = True</code>?"}, {"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 1, "creation_date": 1429708282, "post_id": 29798513, "comment_id": 47725360, "body": "oh yes i found this dialog windows"}], "tags": [], "owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "is_accepted": true, "score": 1, "last_activity_date": 1429707951, "creation_date": 1429707951, "answer_id": 29798513, "question_id": 29798407, "link": "https://stackoverflow.com/questions/29798407/excel-stops-opening-xlsm-file-after-running-code/29798513#29798513", "title": "Excel stops opening XLSM file after running code", "body": "<pre><code>Visible:=False\n</code></pre>\n\n<p>You ordered it to be invisible. Try setting the property to <em>True</em>.</p>\n"}], "owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 29798513, "answer_count": 1, "score": 1, "last_activity_date": 1429854855, "creation_date": 1429707693, "last_edit_date": 1429854855, "question_id": 29798407, "link": "https://stackoverflow.com/questions/29798407/excel-stops-opening-xlsm-file-after-running-code", "title": "Excel stops opening XLSM file after running code", "body": "<p>After running this code</p>\n\n<pre><code>Application.ScreenUpdating = False\nWorkbooks.Open Filename:=FilePath, UpdateLinks:=True, ReadOnly:=True\nActiveWindow.Visible = False\nThisWorkbook.Activate\nApplication.ScreenUpdating = True\n</code></pre>\n\n<p>Excel opening my file with blank page, all pages exist in VBA editor.\nAll menu items is not accessible</p>\n\n<p><img src=\"https://i.stack.imgur.com/WRzz2.png\" alt=\"enter image description here\">\n<img src=\"https://i.stack.imgur.com/zNKUO.png\" alt=\"enter image description here\"></p>\n\n<p>Whats hapens?</p>\n\n<p>SOLVED:</p>\n\n<p><img src=\"https://i.stack.imgur.com/OLMbe.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1429708000, "post_id": 29798365, "comment_id": 47725137, "body": "Not clear what you&#39;re trying to achieve. Please edit your question to describe exactly what the problem is with you code: desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. See: <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>."}, {"owner": {"reputation": 628, "user_id": 4595909, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/135635506b604fd32a3c74aeddad8b0f?s=128&d=identicon&r=PG&f=1", "display_name": "kitap mitap", "link": "https://stackoverflow.com/users/4595909/kitap-mitap"}, "edited": false, "score": 0, "creation_date": 1429708382, "post_id": 29798365, "comment_id": 47725454, "body": "Reach array&#39;s elements with an index which is being increnmented in the for loop instead of <code>for each</code>."}], "answers": [{"comments": [{"owner": {"reputation": 693, "user_id": 4478535, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6cac7e1c914834ce39a218d4837cbd90?s=128&d=identicon&r=PG&f=1", "display_name": "hc91", "link": "https://stackoverflow.com/users/4478535/hc91"}, "edited": false, "score": 0, "creation_date": 1429711103, "post_id": 29798750, "comment_id": 47727809, "body": "Ahh, I see. There isn&#39;t a way of doing two of Next j and Next tab_name so you include them within the loop. Thanks."}], "tags": [], "owner": {"reputation": 628, "user_id": 4595909, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/135635506b604fd32a3c74aeddad8b0f?s=128&d=identicon&r=PG&f=1", "display_name": "kitap mitap", "link": "https://stackoverflow.com/users/4595909/kitap-mitap"}, "is_accepted": true, "score": 1, "last_activity_date": 1429708524, "creation_date": 1429708524, "answer_id": 29798750, "question_id": 29798365, "link": "https://stackoverflow.com/questions/29798365/vba-next-loop-at-the-same-time/29798750#29798750", "title": "VBA Next loop at the same time", "body": "<p>Reach array's elements with an index. I assume you want to increment index with every loop of inner <code>for</code> loop.</p>\n\n<pre><code>tab_names = Array(\"11EB\", \"11WB\", \"12EB\", \"12WB\", \"13EB\", \"13WB\", \"14EB\", \"14WB\", \"15NB\", \"15SB\", \"16NB\", \"16SB\", \"17EB\", \"17WB\", \"18EB\", \"18WB\", \"19NB\", \"19SB\", \"20NB\", \"20SB\", \"21NB\", \"21SB\", \"22NB\", \"22SB\", \"23NB\", \"23SB\", \"24NB\", \"24SB\", \"25NB\", \"25SB\", \"26NB\", \"26SB\", \"27EB\", \"27WB\", \"28EB\", \"28WB\", \"29EB\", \"29WB\", \"30EB\", \"30WB\", \"31NB\", \"31SB\", \"32NB\", \"32SB\", \"33EB\", \"33WB\", \"34EB\", \"34WB\", \"35NB\", \"35SB\", \"36NB\", \"36SB\", \"37EB\", \"37WB\", \"38NB\", \"38SB\", \"39NB\", \"39SB\", \"40EB\", \"40WB\", \"41EB\", \"41WB\", \"A12NB\", \"A12SB\", \"M11NB\", \"M11SB\", \"M25NB\", \"M25SB\", \"A120EB\", \"A120WB\", \"A120AEB\", \"A120AWB\")\n   For i = 9 To 24\n     For j = 3 To 291 Step 4\n\n        Sheets(\"Front Page\").Cells(2, 2) = Cells(i, 1)\n\n        Cells(i, j) = Sheets(tab_names((j-3)/4)).Cells(2993, 9)\n        Cells(i, j + 1) = Sheets(tab_names((j-3)/4)).Cells(2993, 22)\n        Cells(i, j + 2) = Sheets(tab_names((j-3)/4)).Cells(2993, 35)\n        Cells(i, j + 3) = Sheets(tab_names((j-3)/4)).Cells(2993, 48)\n     Next j\n Next i\n</code></pre>\n"}], "owner": {"reputation": 693, "user_id": 4478535, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6cac7e1c914834ce39a218d4837cbd90?s=128&d=identicon&r=PG&f=1", "display_name": "hc91", "link": "https://stackoverflow.com/users/4478535/hc91"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 435, "favorite_count": 0, "accepted_answer_id": 29798750, "answer_count": 1, "score": 0, "last_activity_date": 1429708524, "creation_date": 1429707602, "last_edit_date": 1531164843, "question_id": 29798365, "link": "https://stackoverflow.com/questions/29798365/vba-next-loop-at-the-same-time", "title": "VBA Next loop at the same time", "body": "<p>I need to have <code>Next tab_name</code> and <code>Next j</code> at the same time. Is there any way to do this?</p>\n\n<pre><code>tab_names = Array(\"11EB\", \"11WB\", \"12EB\", \"12WB\", \"13EB\", \"13WB\", \"14EB\", \"14WB\", \"15NB\", \"15SB\", \"16NB\", \"16SB\", \"17EB\", \"17WB\", \"18EB\", \"18WB\", \"19NB\", \"19SB\", \"20NB\", \"20SB\", \"21NB\", \"21SB\", \"22NB\", \"22SB\", \"23NB\", \"23SB\", \"24NB\", \"24SB\", \"25NB\", \"25SB\", \"26NB\", \"26SB\", \"27EB\", \"27WB\", \"28EB\", \"28WB\", \"29EB\", \"29WB\", \"30EB\", \"30WB\", \"31NB\", \"31SB\", \"32NB\", \"32SB\", \"33EB\", \"33WB\", \"34EB\", \"34WB\", \"35NB\", \"35SB\", \"36NB\", \"36SB\", \"37EB\", \"37WB\", \"38NB\", \"38SB\", \"39NB\", \"39SB\", \"40EB\", \"40WB\", \"41EB\", \"41WB\", \"A12NB\", \"A12SB\", \"M11NB\", \"M11SB\", \"M25NB\", \"M25SB\", \"A120EB\", \"A120WB\", \"A120AEB\", \"A120AWB\")\n   For i = 9 To 24\n    For Each indiv_tab In tab_names\n     For j = 3 To 291 Step 4\n\n        Sheets(\"Front Page\").Cells(2, 2) = Cells(i, 1)\n\n        Cells(i, j) = Sheets(indiv_tab).Cells(2993, 9)\n        Cells(i, j + 1) = Sheets(indiv_tab).Cells(2993, 22)\n        Cells(i, j + 2) = Sheets(indiv_tab).Cells(2993, 35)\n        Cells(i, j + 3) = Sheets(indiv_tab).Cells(2993, 48)\n     Next j\n   Next\n Next i\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "textbox"], "comments": [{"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 1, "creation_date": 1429706461, "post_id": 29797694, "comment_id": 47723868, "body": "What do you mean by equation? Can you show it?"}, {"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "reply_to_user": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 0, "creation_date": 1429706925, "post_id": 29797694, "comment_id": 47724264, "body": "Behind Part Removal is the addition of 3 other textboxes on the form: =CDbl(Nz([txtpart1hrs],0))+CDbl(Nz([txtpart2hrs],0))+CDbl(Nz&zwnj;&#8203;([txtpart3hrs],0))"}, {"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "reply_to_user": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 0, "creation_date": 1429706965, "post_id": 29797694, "comment_id": 47724297, "body": "Total Hours is similar but has more textboxes added together. I was thinking maybe me.totalhours = 0"}, {"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 0, "creation_date": 1429707580, "post_id": 29797694, "comment_id": 47724815, "body": "So when the textboxes get cleared the formula just shows up ####?"}, {"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 0, "creation_date": 1429713147, "post_id": 29797694, "comment_id": 47729617, "body": "Try my answer then. You will need to change the variables names as I cannot see all your code to do it"}], "answers": [{"comments": [{"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "reply_to_user": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1429779265, "post_id": 29798502, "comment_id": 47763498, "body": "If you could also give me your entire code for this I will look into it"}, {"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1429790579, "post_id": 29798502, "comment_id": 47771883, "body": "Ok awesome Ill add what I have but its quite lengthy because I have the code under the command button that adds the record to the table. Ill try to cut it down to just the important parts. Thanks :)"}, {"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1429791195, "post_id": 29798502, "comment_id": 47772342, "body": "My error handle keeps popping up for some reason, but it still sends the email and Ive provided a picture of what shows up in the boxes."}, {"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "reply_to_user": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1429792519, "post_id": 29798502, "comment_id": 47773447, "body": "Unfortunatly I cannot see the picture as I am at work and it is blocked. However if the email still gets send and the errHandle always appears do you have an exit function/sub just before the errHandle code is?"}, {"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1429793164, "post_id": 29798502, "comment_id": 47773986, "body": "Yes I do for the code if the email is sent and if it is not sent"}, {"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1429793693, "post_id": 29798502, "comment_id": 47774416, "body": "Im getting an Run-time error. It says &quot;You cant assign a vlue to this object&quot; for the else portion of the code you suggested."}, {"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "reply_to_user": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1429794200, "post_id": 29798502, "comment_id": 47774846, "body": "Try chaning txtPartRemoval to txtPartRemove.value. I am trying to recreate it and get the error now"}, {"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "reply_to_user": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1429795462, "post_id": 29798502, "comment_id": 47775930, "body": "Hmm not sure then to be honest. I thought I had replicated it and managed to fix it with that last bit of code. I had it set to when ever I click it will check to see if the txtPartHrs = &quot;&quot;. If they are not &quot;&quot; then puts the formula in and spits out the result. I will keep looking though"}, {"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "reply_to_user": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1429860392, "post_id": 29798502, "comment_id": 47808578, "body": "Would it be possible if you uploaded your workbook. Take out any important information and data and then I can try and see why it is happening. As I cannot see why it is working for me when I tried to replicate it, I must of clearly not replicated it enough. So post all your code to so I can look through it"}, {"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1429878242, "post_id": 29798502, "comment_id": 47820547, "body": "Could I just email it to you?"}, {"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "reply_to_user": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1429881104, "post_id": 29798502, "comment_id": 47822728, "body": "Wouldnt be able to open it from email as at work. Maybe put all your code in paste bin and post the link?"}, {"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1429891614, "post_id": 29798502, "comment_id": 47830513, "body": "I cant get on paste bin its blocked at my job."}], "tags": [], "owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1429860294, "last_edit_date": 1429860294, "creation_date": 1429707929, "answer_id": 29798502, "question_id": 29797694, "link": "https://stackoverflow.com/questions/29797694/clear-textboxes-that-have-equations-behind-them/29798502#29798502", "title": "Clear textboxes that have equations behind them", "body": "<p>You could do something like if the textboxes are clear do make the formula something else.</p>\n\n<pre><code>if [txtPart1Hrs] = \"\" or [txtPart2Hrs] = \"\" or [txtPart3hrs] = \"\" then \n     formulaBox = \"\"\nelse\n    formulaBox = \"=CDbl(Nz([txtpart1hrs],0))+CDbl(Nz([txtpart2hrs],0))+CDbl(Nz([txtpart3hrs],0))\"\nend if\n</code></pre>\n\n<p>Just replace formulabox with what ever you have set for the text box that contains the formula</p>\n\n<p>EDIT Updated code</p>\n\n<p>Change </p>\n\n<pre><code>txtPartRemoval = \"=CDbl(Nz([txtpart1hrs],0))+CDbl(Nz([txtpart2hrs],0))+CDbl(Nz([txtpart3hrs],0))\" \n</code></pre>\n\n<p>to </p>\n\n<pre><code>txtPartRemoval.Value = CDbl(Nz([txtpart1hrs], 0)) + CDbl(Nz([txtpart2hrs], 0)) + CDbl(Nz([txtpart3hrs], 0))\n</code></pre>\n\n<p>try changing </p>\n\n<pre><code>txtPartRemoval.Value = CDbl(Nz([txtpart1hrs], 0)) + CDbl(Nz([txtpart2hrs], 0)) + CDbl(Nz([txtpart3hrs], 0))\n</code></pre>\n\n<p>to </p>\n\n<pre><code>txtPartRemoval.Value = CDbl([txtpart1hrs].value) + CDbl([txtpart2hrs].value) + CDbl([txtpart3hrs].value)\n</code></pre>\n\n<p>As it will not run at all if one of the boxes is empty anyway due to the check to see if it = \"\". </p>\n"}], "owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1591771107, "creation_date": 1429705917, "last_edit_date": 1591771107, "question_id": 29797694, "link": "https://stackoverflow.com/questions/29797694/clear-textboxes-that-have-equations-behind-them", "title": "Clear textboxes that have equations behind them", "body": "<p>I have constructed a Form in access with two textboxes (Total Hours and Part Removal) that have equations behind them. I now have coded a command to send an email at the click of a command button. Also, I have the code to clear the other textboxes on the form after the email has been sent. Is there a way to clear a textbox that has an equation behind it and have it be able to be used again when the user send the email? Right now when the email is sent the equation textboxes pop up with #### inside. </p>\n\n<p>Thanks in advance :)</p>\n\n<pre><code>On Error GoTo errhandle\nMe.Filter = \"CurrentDate= #\" &amp; Format(Me!CurrentDate, \"yyyy\\-mm\\-dd\") &amp; \"# and DiscoverTime= '\" &amp; Me!DiscoverTime &amp; \"' and TailNumber= '\" &amp; Me!TailNumber &amp; \"' and FleetID= '\" &amp; Me!FleetID &amp; \"'\"\nMe.FilterOn = True\nDoCmd.SendObject acSendForm, \"frmETIC\", acFormatPDF, \"email\", \"\", \"\", \"Recovery Report\", \"Attached is the submitted Recovery Report\"\n\nIf [txtpart1hrs] = \"\" Or [txtpart2hrs] = \"\" Or [txtpart3hrs] = \"\" Then\n txtPartRemoval = \"\"\nElse\ntxtPartRemoval = \"=CDbl(Nz([txtpart1hrs],0))+CDbl(Nz([txtpart2hrs],0))+CDbl(Nz([txtpart3hrs],0))\"\nEnd If\n\n\nMe.CurrentDate = vbNullString\nMe.DiscoverTime = vbNullString\nMe.TailNumber = vbNullString\nMe.FleetID = vbNullString\nMe.ETIC = vbNullString\nMe.NonRteWorkCard = vbNullString\nMe.txtWorkOrder = vbNullString\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/09SVi.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["vba", "excel", "autofilter"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1429705267, "post_id": 29797294, "comment_id": 47722872, "body": "The first argument to <code>autofilter</code> is Field which is the column number, so if you simply filter the whole sheet (using UsedRange) you can specify the column number if you know it."}, {"owner": {"reputation": 780, "user_id": 3725491, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Pijf2.jpg?s=128&g=1", "display_name": "Amber", "link": "https://stackoverflow.com/users/3725491/amber"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1429874866, "post_id": 29797294, "comment_id": 47818195, "body": "Downvoter, please comment why."}], "answers": [{"tags": [], "owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "is_accepted": true, "score": 1, "last_activity_date": 1429706666, "last_edit_date": 1429706666, "creation_date": 1429705568, "answer_id": 29797546, "question_id": 29797294, "link": "https://stackoverflow.com/questions/29797294/autofilter-without-using-range/29797546#29797546", "title": "AutoFilter without using Range", "body": "<p>Just use the auto filter on the column then. <code>range(\"A1\").autofilter</code></p>\n\n<p>change the A to what ever column you need. Selecting the range and the first cell will pull all in a filter that column that is connected. So it will filter all up to any blanks.</p>\n"}, {"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 1, "last_activity_date": 1429705974, "creation_date": 1429705974, "answer_id": 29797712, "question_id": 29797294, "link": "https://stackoverflow.com/questions/29797294/autofilter-without-using-range/29797712#29797712", "title": "AutoFilter without using Range", "body": "<p>You can just filter the entire column, don't worry about ranges.</p>\n\n<pre><code>   Columns(\"E:E\").AutoFilter Field:=1, Criteria1:=\"a\"\n</code></pre>\n"}], "owner": {"reputation": 780, "user_id": 3725491, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Pijf2.jpg?s=128&g=1", "display_name": "Amber", "link": "https://stackoverflow.com/users/3725491/amber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 818, "favorite_count": 0, "accepted_answer_id": 29797546, "answer_count": 2, "score": -1, "last_activity_date": 1429706666, "creation_date": 1429704940, "question_id": 29797294, "link": "https://stackoverflow.com/questions/29797294/autofilter-without-using-range", "title": "AutoFilter without using Range", "body": "<p>I'm trying to filter a column in a worksheet based on a specific value using <a href=\"/questions/tagged/autofilter\" class=\"post-tag\" title=\"show questions tagged &#39;autofilter&#39;\" rel=\"tag\">autofilter</a>. But the workbook which I'm supposed to filter data in is generated dynamically so I don't know what to put in Range().</p>\n\n<p>However, I do know the position of this column (as in \"3rd from dynamically generated column\").</p>\n\n<p>Can anyone please tell me how I can use <a href=\"/questions/tagged/autofilter\" class=\"post-tag\" title=\"show questions tagged &#39;autofilter&#39;\" rel=\"tag\">autofilter</a> when I only know the column number?</p>\n"}, {"tags": ["excel", "vba", "filter", "pivot"], "answers": [{"tags": [], "owner": {"reputation": 103, "user_id": 3800275, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2748dd4b7e0bc2f8c18d13357e6f7cff?s=128&d=identicon&r=PG&f=1", "display_name": "Nadz", "link": "https://stackoverflow.com/users/3800275/nadz"}, "is_accepted": false, "score": 0, "last_activity_date": 1429709788, "creation_date": 1429709788, "answer_id": 29799302, "question_id": 29796567, "link": "https://stackoverflow.com/questions/29796567/excel-vba-to-filter-pivot-row-labels-by-date-range/29799302#29799302", "title": "EXCEL VBA to Filter Pivot Row Labels by Date Range", "body": "<p>Nevermind, the second code worked, i was ignorantly calling the incorrect pivot table in the code:</p>\n\n<pre><code>Call Filter_PivotField_by_Date_Range( _\nPT.PivotFields(\"Date\"), dtFrom, dtTo)\n</code></pre>\n\n<p>I simply changed PT to PT1, and voila :)\nHope this helps anyone having a similar issue in the future</p>\n"}], "owner": {"reputation": 103, "user_id": 3800275, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2748dd4b7e0bc2f8c18d13357e6f7cff?s=128&d=identicon&r=PG&f=1", "display_name": "Nadz", "link": "https://stackoverflow.com/users/3800275/nadz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1260, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429709788, "creation_date": 1429703208, "last_edit_date": 1429704524, "question_id": 29796567, "link": "https://stackoverflow.com/questions/29796567/excel-vba-to-filter-pivot-row-labels-by-date-range", "title": "EXCEL VBA to Filter Pivot Row Labels by Date Range", "body": "<p>Good day,</p>\n\n<p>I am trying to filter a pivot table row label (\"Dates\") based on a date range in other cells (basically to select the date along with the past 6 days), through cell referencing (\"E6:E12\")</p>\n\n<p>I googled a lot and found a few codes, which work great; however the code breaks randomly, not sure why</p>\n\n<p>Can anyone propose an easier VBA to filter row labels based on date range</p>\n\n<p>Code:</p>\n\n<pre><code>Public Function Filter_PivotField_by_Date_Range(pvtField As PivotField, _\n    dtFrom As Date, dtTo As Date)\nDim bTemp As Boolean, i As Long\nDim dtTemp As Date, sItem1 As String\n\nOn Error Resume Next\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n\nWith pvtField\n    .Parent.ManualUpdate = True\n    For i = 1 To .PivotItems.Count\n        dtTemp = .PivotItems(i)\n        bTemp = (dtTemp &gt;= dtFrom) And _\n            (dtTemp &lt;= dtTo)\n        If bTemp Then\n            sItem1 = .PivotItems(i)\n            Exit For\n        End If\n    Next i\n    If sItem1 = \"\" Then\n        MsgBox \"No items are within the specified dates.\"\n        Exit Function\n    End If\n    If .Orientation = xlPageField Then .EnableMultiplePageItems = True\n    .PivotItems(sItem1).Visible = True\n    For i = 1 To .PivotItems.Count\n        dtTemp = .PivotItems(i)\n        If .PivotItems(i).Visible &lt;&gt; _\n            ((dtTemp &gt;= dtFrom) And (dtTemp &lt;= dtTo)) Then\n            .PivotItems(i).Visible = Not .PivotItems(i).Visible\n        End If\n    Next i\nEnd With\n\npvtField.Parent.ManualUpdate = False\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\nEnd Function\n\nSub TESTUPDATE()\n\n'Set the Variables to be used\nDim PT As PivotTable\nDim PT1 As PivotTable\nDim Field As PivotField\nDim NewCat As String\n\n'Here you amend to suit your data\nSet PT = Workbooks(\"KPI     Dashboard\").Worksheets(\"Sheet1\").PivotTables(\"TESTPIVOT\")\nSet PT1 = Workbooks(\"KPI  Dashboard\").Worksheets(\"Sheet1\").PivotTables(\"PivotTable2\")\nSet Field = PT.PivotFields(\"Date\")\nSet Field1 = PT1.PivotFields(\"Date\")\nNewCat = Workbooks(\"KPI Dashboard\").Worksheets(\"Sheet1\").Range(\"E7\").Value\n\n'This updates and refreshes the PIVOT table\nWith PT\nField.ClearAllFilters\nField.CurrentPage = NewCat\nPT.RefreshTable\nEnd With\n\n'This is the actual code that applies the filter    \nDim Rng As Range\nDim PItem As PivotItem\nWith ActiveSheet\n    Set Rng = .Range(\"G10:G15\")\n    For Each PItem In  .PivotTables(\"PivotTable2\").RowFields(\"Date\").PivotItems\n    PItem.Visible = WorksheetFunction.CountIf(Rng, PItem.Name) &gt; 0\n    Next PItem\nEnd With   \nEnd Sub\n</code></pre>\n\n<p>I am getting error with PItem.Visible = WorksheetFunction.CountIf(Rng, PItem.Name) > 0 \"Run Time Error - 1004. Unable to set the visible property of the pivotitem class\"</p>\n\n<p>There is another piece of code that replaces the last piece of previous code which is responsible for applying the filter; however does not work at all (ie no changes on the pivot):</p>\n\n<pre><code>Dim dtFrom As Date, dtTo As Date\n\nWith Sheets(\"Sheet1\")\n    dtFrom = .Range(\"E12\")\n    dtTo = .Range(\"E7\")\nEnd With\n\nWith PT1\nCall Filter_PivotField_by_Date_Range( _\n    PT.PivotFields(\"Date\"), dtFrom, dtTo)\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel", "cells"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 2, "creation_date": 1429703022, "post_id": 29796196, "comment_id": 47720963, "body": "Welcome to SO! Post the code you found, and your best attempt (even if it&#39;s only a comment like &quot;I think something needs to go here&quot;), and you&#39;ll get help. SO isn&#39;t a code writing service, and most people won&#39;t just do it for you."}, {"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "edited": false, "score": 0, "creation_date": 1429705227, "post_id": 29796196, "comment_id": 47722832, "body": "Welcome to VBA coding. Here are some sites to get you started : <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264383.aspx\" rel=\"nofollow noreferrer\">Welcome to the Visual Basic for Applications language reference for Office 2013</a>, to skip the theories - <a href=\"https://msdn.microsoft.com/EN-US/library/office/jj692818.aspx\" rel=\"nofollow noreferrer\">Visual Basic language reference</a>"}, {"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "edited": false, "score": 0, "creation_date": 1429705616, "post_id": 29796196, "comment_id": 47723174, "body": "And <a href=\"https://msdn.microsoft.com/en-us/library/office/ee861528.aspx\" rel=\"nofollow noreferrer\">Welcome to the Excel 2013 developer reference</a>"}, {"owner": {"reputation": 1570, "user_id": 3324507, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/653f2f879a98a201288ef32e6e344163?s=128&d=identicon&r=PG&f=1", "display_name": "sgp667", "link": "https://stackoverflow.com/users/3324507/sgp667"}, "edited": false, "score": 0, "creation_date": 1429713128, "post_id": 29796196, "comment_id": 47729592, "body": "@chiv I am assuming that neither I nor Jeanno  answered your question completly becuase you haven&#39;t maked neither answer as correct. If we are slightly off give us more information and we will improve upon the answers."}], "answers": [{"tags": [], "owner": {"reputation": 1570, "user_id": 3324507, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/653f2f879a98a201288ef32e6e344163?s=128&d=identicon&r=PG&f=1", "display_name": "sgp667", "link": "https://stackoverflow.com/users/3324507/sgp667"}, "is_accepted": true, "score": 1, "last_activity_date": 1429705245, "last_edit_date": 1429705245, "creation_date": 1429704867, "answer_id": 29797264, "question_id": 29796196, "link": "https://stackoverflow.com/questions/29796196/add-amount-of-blank-rows-based-on-cell-value/29797264#29797264", "title": "Add amount of blank rows based on cell value", "body": "<p>Following worked for me:</p>\n\n<pre><code>Sub add_blank_rows()\n    Dim Awsh      As Worksheet\n    Dim ARow      As Range\n    Dim AColumn   As Range\n    Dim UsedRange As Range\n    Dim to_insert As Integer\n    Dim count     As Integer\n\n    Set Awsh = ActiveSheet\n    Set UsedRange = Awsh.UsedRange\n    Set AColumn = Range(Cells(1, 26), Cells(UsedRange.End(xlDown).Row, 26))\n\n    For Each ARow In AColumn\n        If Not ARow.Offset(1, 0) = ARow And _\n           IsNumeric(ARow.Offset(1, 0)) And _\n           IsNumeric(ARow) Then\n\n            to_insert = ARow\n\n            For count = 1 To to_insert\n                ARow.Offset(1).EntireRow.Insert\n            Next count\n        End If\n    Next ARow\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "is_accepted": false, "score": 1, "last_activity_date": 1429705604, "creation_date": 1429705604, "answer_id": 29797561, "question_id": 29796196, "link": "https://stackoverflow.com/questions/29796196/add-amount-of-blank-rows-based-on-cell-value/29797561#29797561", "title": "Add amount of blank rows based on cell value", "body": "<p>You first need to determine which is the last row containing a unique value because after this row is when blanks are inserted. I have added an extra column \"C\" to indicate whether the row is the last one. </p>\n\n<pre><code>Sub AssignLast()\n    Dim i As Long\n\n    For i = 1 To Cells(Cells.Rows.Count, 1).End(xlUp).Row\n        If i = 1 Then\n            If Range(\"A\" &amp; i).Value &lt;&gt; Range(\"A\" &amp; i + 1).Value Then\n                Range(\"C\" &amp; i).Value = 1\n            End If\n        Else\n            If Range(\"A\" &amp; i).Value = Range(\"A\" &amp; i - 1).Value And _\n                Range(\"A\" &amp; i).Value &lt;&gt; Range(\"A\" &amp; i + 1).Value Then\n                    Range(\"C\" &amp; i).Value = 1\n            End If\n        End If\n    Next i\nEnd Sub\n\nSub InsertBlankRows()\n    Dim i As Long\n\n    For i = 1 To Cells(Cells.Rows.Count, 1).End(xlUp).Row\n        If Range(\"C\" &amp; i).Value = 1 Then\n            Rows(i + 1 &amp; \":\" &amp; i + Range(\"B\" &amp; i).Value).Insert Shift:=xlDown\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15, "user_id": 4819017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3afb35e2512cf63d44fe7a88c8a821bc?s=128&d=identicon&r=PG&f=1", "display_name": "chiv", "link": "https://stackoverflow.com/users/4819017/chiv"}, "is_accepted": false, "score": 0, "last_activity_date": 1429763356, "creation_date": 1429763356, "answer_id": 29813700, "question_id": 29796196, "link": "https://stackoverflow.com/questions/29796196/add-amount-of-blank-rows-based-on-cell-value/29813700#29813700", "title": "Add amount of blank rows based on cell value", "body": "<p>Thank you all very much for your help, you've got an awesome and helpful community here!</p>\n\n<p>Special thanks to @sgp667, this worked like a charm:</p>\n\n<pre><code>Sub add_blank_rows()\nDim Awsh      As Worksheet\nDim ARow      As Range\nDim AColumn   As Range\nDim UsedRange As Range\nDim to_insert As Integer\nDim count     As Integer\n\nSet Awsh = ActiveSheet\nSet UsedRange = Awsh.UsedRange\nSet AColumn = Range(Cells(1, 26), Cells(UsedRange.End(xlDown).Row, 26))\n\nFor Each ARow In AColumn\n    If Not ARow.Offset(1, 0) = ARow And _\n       IsNumeric(ARow.Offset(1, 0)) And _\n       IsNumeric(ARow) Then\n\n        to_insert = ARow\n\n        For count = 1 To to_insert\n            ARow.Offset(1).EntireRow.Insert\n        Next count\n    End If\nNext ARow\n</code></pre>\n\n<p>End Sub</p>\n\n<p>Cheers!</p>\n"}], "owner": {"reputation": 15, "user_id": 4819017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3afb35e2512cf63d44fe7a88c8a821bc?s=128&d=identicon&r=PG&f=1", "display_name": "chiv", "link": "https://stackoverflow.com/users/4819017/chiv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 29797264, "answer_count": 3, "score": 1, "last_activity_date": 1429763356, "creation_date": 1429702290, "last_edit_date": 1429703294, "question_id": 29796196, "link": "https://stackoverflow.com/questions/29796196/add-amount-of-blank-rows-based-on-cell-value", "title": "Add amount of blank rows based on cell value", "body": "<p>As the majority of those seeking aid here I am new to VBA, but I figured there is no way to solve my problem with conventional formulas hence the explanation:</p>\n\n<p>I have several sets of materiel codes in col. A sorted from smallest to largest, their corresponding data in columns B to Y. What I need is add an amount of blank rows below every set of codes equalling the corresponding value in col. Z, below is an example of \"before\"</p>\n\n<pre><code> - Col. A   ----  Col. Z\n - 65504927 - 3\n - 65504927 - 3\n - 65504927 - 3\n - 65505044 - 1\n - 65505044 - 1\n - 65505044 - 1\n - 65505151 - 0\n - 65505151 - 0\n - 65505297 - 2\n - 65505297 - 2\n</code></pre>\n\n<p>and After - </p>\n\n<pre><code>- Col. A   ----  Col. Z\n- 65504927 - 3\n- 65504927 - 3\n- 65504927 - 3\n- \"blank row\"\n- \"blank row\"\n- \"blank row\"\n- 65505044 - 1\n- 65505044 - 1\n- 65505044 - 1\n- \"blank row\"\n- 65505151 - 0\n- 65505151 - 0\n- 65505297 - 2\n- 65505297 - 2\n- \"blank row\"\n- \"blank row\"\n</code></pre>\n\n<p>I found a suggestion for a similar problem in one of the posts here (it adds a single row after every set of data) but I can't yet grasp VB architecture enough to make alterations, so I'd greatly appreciate your help, thanks in advance.</p>\n"}, {"tags": ["vba", "excel", "variables", "string-concatenation"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1429703107, "post_id": 29795973, "comment_id": 47721029, "body": "Welcome to SO! Post your code attempts (just edit your OP and paste them at the end), and you&#39;ll get help. SO isn&#39;t a code writing service, and most people won&#39;t just do it for you"}, {"owner": {"reputation": 35, "user_id": 4819061, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/07c819c65c2d9640387ff63e810194a9?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4819061/chris"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1429703747, "post_id": 29795973, "comment_id": 47721561, "body": "Done! It&#39;s really not that great of an attempt but I only know basic stuff unfortunately :("}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1429704381, "post_id": 29795973, "comment_id": 47722137, "body": "Start by clicking <code>Debug</code> in the VBE, then <code>Compile</code>. Fix all the compile-time errors in your code. That will help you get moving in the right direction."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1429714860, "post_id": 29795973, "comment_id": 47731132, "body": "If your updated code is formatted that same with (with the exclusion of the &quot;&gt;&quot;) in the VBE, I&#39;d <b>strongly</b> suggest reformatting the way I posted it - it will be <i>much</i> more readable for you. If it got that way when you pasted it into SO, then never mind..."}], "answers": [{"tags": [], "owner": {"reputation": 630, "user_id": 1172412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3c75a1f9d4ab98bff7c279c49c242913?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/1172412/steven"}, "is_accepted": false, "score": 0, "last_activity_date": 1429717637, "last_edit_date": 1429717637, "creation_date": 1429705870, "answer_id": 29797677, "question_id": 29795973, "link": "https://stackoverflow.com/questions/29795973/vba-concatenate-cells-from-two-columns-based-on-criteria-present-in-a-third/29797677#29797677", "title": "VBA Concatenate Cells from two columns based on criteria present in a third", "body": "<p>If I have interpreted your question correctly, I think you may have overcomplicated it!</p>\n\n<pre><code>Sub Notestidy()    \n\n    Dim cc, sc, nc As String\n    Dim ws As Worksheet\n\n    Set ws = Sheet1\n\n    cc = \"G\"\n    sc = \"H\"\n    nc = \"F\"\n\n    Dim i, max As Integer\n    max = ws.UsedRange.Rows.Count\n\n    For i = 2 To max\n\n        If ws.Range(nc &amp; i).Value = \"Missing Audio\" Or ws.Range(nc &amp; i).Value = \"Missing Audio/Subs\" Then\n\n            ws.Range(sc &amp; i).Value = ws.Range(cc &amp; i).Value &amp; \" \" &amp; ws.Range(sc &amp; i).Value\n\n        End If\n\n    Next i\n\n    Set ws = Nothing\nEnd Sub\n</code></pre>\n\n<p>Edit: Or as per FreeMan's answer utilising the Find method:</p>\n\n<pre><code>Sub Notestidy()\n\n    Dim w1 As Worksheet\n    Dim result As Range\n    Dim FirstRow As Integer\n\n    Set w1 = Worksheets(\"Sheet1\")\n    FirstRow = 0\n\n    With w1.Range(\"F:F\")\n        Set result = .Find(What:=\"Missing Audio\", LookIn:=xlValues, LookAt:=xlPart)\n\n        If Not result Is Nothing Then\n            FirstRow = result.Row\n            Do\n                w1.Range(\"H\" &amp; result.Row) = w1.Range(\"G\" &amp; result.Row) &amp; w1.Range(\"H\" &amp; result.Row)\n                Set result = .FindNext(result)\n            Loop While Not result Is Nothing And result.Row &lt;&gt; FirstRow\n        End If\n    End With\n\n    Set w1 = Nothing\n    Set result = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 4819061, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/07c819c65c2d9640387ff63e810194a9?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4819061/chris"}, "edited": false, "score": 0, "creation_date": 1429709801, "post_id": 29797692, "comment_id": 47726709, "body": "Hey! Thanks so much for your help! The issue I am running into now is that when it finds the first occurrence of &quot;Missing Audio&quot; it stops. Would I need to employ the first row command you outlined here? or is there just something obvious I&#39;m missing? (Its likely the latter to be fair)"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 35, "user_id": 4819061, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/07c819c65c2d9640387ff63e810194a9?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4819061/chris"}, "edited": false, "score": 0, "creation_date": 1429710573, "post_id": 29797692, "comment_id": 47727364, "body": "When you say &quot;stops&quot;, do you mean there&#39;s an error, or that it only finds one &quot;Missing Audio&quot;?  If there&#39;s an error, what is it? If it only finds one &quot;Missing Audio&quot; then exits, try adding <code>SearchDirection:=xlNext, MatchCase:=False</code> to the initial <code>.Find()</code> statement. (Should probably add that in anyway...)"}, {"owner": {"reputation": 35, "user_id": 4819061, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/07c819c65c2d9640387ff63e810194a9?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4819061/chris"}, "edited": false, "score": 0, "creation_date": 1429714129, "post_id": 29797692, "comment_id": 47730551, "body": "Sorry I should have been clearer, there is no error with the macro, just that was doing the first line of data is found. I added the above statements to the original .Find statement but the problem still happens. I can&#39;t work out why, I&#39;ll paste the current code below, maybe you will see something obvious"}, {"owner": {"reputation": 35, "user_id": 4819061, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/07c819c65c2d9640387ff63e810194a9?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4819061/chris"}, "edited": false, "score": 0, "creation_date": 1429714392, "post_id": 29797692, "comment_id": 47730770, "body": "<code>Sub Notestidy()  Dim w1 As Worksheet Dim rng As Range Dim FirstRow As Integer    Set w1 = Worksheets(&quot;Sheet1&quot;) FirstRow = 0   Set rng = w1.Range(&quot;F:F&quot;).Find(What:=&quot;Missing Audio&quot;, LookIn:=xlValues, _   LookAt:=xlPart, SearchDirection:=xlNext, MatchCase:=False) While Not rng Is Nothing   If FirstRow &lt;&gt; rng.Row Then     If FirstRow = 0 Then       FirstRow = rng.Row     End If     w1.Range(&quot;H&quot; &amp; rng.Row) = w1.Range(&quot;G&quot; &amp; rng.Row) &amp; w1.Range(&quot;H&quot; &amp; rng.Row)     rng.FindNext After:=rng   Else     Set rng = Nothing   End If Wend  Application.ScreenUpdating = True  End Sub</code>"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 35, "user_id": 4819061, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/07c819c65c2d9640387ff63e810194a9?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4819061/chris"}, "edited": false, "score": 0, "creation_date": 1429714500, "post_id": 29797692, "comment_id": 47730864, "body": "As you just figured out, code in comments is unreadable.  :)  Edit your OP then paste this in at the end as a new block of code, without deleting the original"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 35, "user_id": 4819061, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/07c819c65c2d9640387ff63e810194a9?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4819061/chris"}, "edited": false, "score": 0, "creation_date": 1429714980, "post_id": 29797692, "comment_id": 47731202, "body": "Have you stepped through line by line? What is causing it to drop out of the <code>While not rng is nothing</code> loop? Is it immediately after <code>rng.FindNext</code> or is hitting <code>Set rng = Nothing</code>?"}, {"owner": {"reputation": 630, "user_id": 1172412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3c75a1f9d4ab98bff7c279c49c242913?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/1172412/steven"}, "edited": false, "score": 0, "creation_date": 1429715501, "post_id": 29797692, "comment_id": 47731599, "body": "FindNext returns a range which you are not setting. That could be an issue."}, {"owner": {"reputation": 35, "user_id": 4819061, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/07c819c65c2d9640387ff63e810194a9?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4819061/chris"}, "edited": false, "score": 0, "creation_date": 1429715729, "post_id": 29797692, "comment_id": 47731763, "body": "When I f8 through the code I get a &quot;Run-Time Error &#39;9&#39;: Subscript out of range&quot; error on the line: <code>Set w1 = Worksheets(&quot;Sheet1&quot;)</code>"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 35, "user_id": 4819061, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/07c819c65c2d9640387ff63e810194a9?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4819061/chris"}, "edited": false, "score": 0, "creation_date": 1429715787, "post_id": 29797692, "comment_id": 47731810, "body": "Do you have a worksheet named <i>exactly</i> <code>Sheet1</code>? If not, change that to match what worksheet you do have. Also, @Chris, make sure you note <a href=\"http://stackoverflow.com/questions/29795973/vba-concatenate-cells-from-two-columns-based-on-criteria-present-in-a-third/29797692?noredirect=1#comment47731599_29797692\">this change</a>."}, {"owner": {"reputation": 35, "user_id": 4819061, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/07c819c65c2d9640387ff63e810194a9?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4819061/chris"}, "edited": false, "score": 0, "creation_date": 1429716178, "post_id": 29797692, "comment_id": 47732142, "body": "yeah the sheet is names &quot;Sheet1&quot; I&#39;m not sure why it&#39;s throwing a hissy fit over this.   In regards to the FindNext range, would that just need a .range field immediately following it?"}, {"owner": {"reputation": 630, "user_id": 1172412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3c75a1f9d4ab98bff7c279c49c242913?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/1172412/steven"}, "edited": false, "score": 0, "creation_date": 1429717832, "post_id": 29797692, "comment_id": 47733385, "body": "You need to set the FindNext like this: Set rng = rng.FindNext(rng) to avoid a syntax error. I don&#39;t think FindNext should be called on the result. I have updated my answer to demonstrate."}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": true, "score": 1, "last_activity_date": 1429715578, "last_edit_date": 1429715578, "creation_date": 1429705910, "answer_id": 29797692, "question_id": 29795973, "link": "https://stackoverflow.com/questions/29795973/vba-concatenate-cells-from-two-columns-based-on-criteria-present-in-a-third/29797692#29797692", "title": "VBA Concatenate Cells from two columns based on criteria present in a third", "body": "<p>A couple of pointers to get you started:</p>\n\n<ul>\n<li>never use <code>Application.ScreenUpdating = False</code> until your code works. It only hides what's going on and make it much more difficult to figure out issues</li>\n<li>There are very rare and specific times you want to use <code>On Error Resume Next</code>, and this isn't one of them. All it does is mask the fact that a run-time error occurred. It allows you to handle specific errors that you expect might happen. That's not what you're after here.</li>\n<li>Assignment of worksheets &amp; ranges to variables instead of using <code>Active...</code> is <em>excellent</em>!</li>\n<li><code>.String</code> is not a valid method or object, and when not included in a <code>With...End With</code> block, the leading-dot notation is invalid</li>\n<li>Combining multiple statements on a single line with the <code>:</code> is valid, and some people do it. My personal opinion is that it makes code more difficult to read and mentally parse, even though the compiler has no issue with it. This is especially true when you combine some code on one line with <code>:</code>, then have additional code to be executed in that code block that's not combined on that one line.</li>\n<li>Proper and consistent indentation will help you figure out your code blocks and where to end a block that's begun.</li>\n<li>Built in functions, like <code>.Find()</code> are much, much faster than looping through blocks of cells looking for things.</li>\n</ul>\n\n<p>so...</p>\n\n<pre><code>Sub Notestidy()\n\nDim w1 As Worksheet\nDim rng As Range\nDim FirstRow as Integer\n\n'Application.ScreenUpdating = False\n\nSet w1 = Worksheets(\"Sheet1\")\nFirstRow = 0\n\n'find \"Missing Audio\" in column F\nset rng = w1.Range(\"F:F\").Find (What:=\"Missing Audio\", LookIn:=xlValues, _\n  LookAt:=xlPart)              'look at some additional parameters here\nWhile Not rng is Nothing       'if we found it somewhere\n  If FirstRow &lt;&gt; rng.row Then  'we haven't wrapped back around to the first found item\n    If FirstRow = 0 then       'this is our first time through the loop\n      FirstRow = rng.row       'Store off the first found row\n    End If\n    'Assign H = F &amp; H for this row. \n    w1.Range(\"H\" &amp; rng.row) = w1.Range(\"F\" &amp; rng.row) &amp; w1.Range(\"H\" &amp; rng.row) \n'------------------------\n'update this line:\n    Set rng = rng.FindNext After:=rng  'find the next occurrence\n  Else\n    set rng = nothing          'we've wrapped around the search, let's get out\n  End If\nWend\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p><strong>A couple of final notes</strong>:</p>\n\n<ul>\n<li>Be aware that <code>.Find()</code> will use whatever parameters were last set in the search dialog box and that parameters set in code will be reflected in the dialog box. There's nothing wrong with this, you just need to understand that anything you <em>don't</em> explicitly set when calling it from code will leave you using whatever random setting happened to be from your last search. You may want to look at the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746%28v=office.14%29.aspx\" rel=\"nofollow\">MS Docs on <code>.find()</code></a> for all the parameters.</li>\n<li>While on the topic of <code>.Find()</code> it will wrap around and find the first occurrence again. If you're not replacing what you're finding, you'll end up in an infinite loop, so you have to store off a marker of some sort (<code>FirstRow</code>, in this case) so you know when you get back there.</li>\n<li>On the <code>w1.Range(\"H\" &amp; rng.row) =</code> line, you can add some sort of delimited in there between the country code (Col F) and the string in Col H if you want. I didn't know what you may have wanted, so I just slammed them together.</li>\n<li>Step through your code in the debugger using the <kbd>F8</kbd> key to execute 1 line of code at a time. That will help you understand what's going on in your code.</li>\n</ul>\n"}], "owner": {"reputation": 35, "user_id": 4819061, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/07c819c65c2d9640387ff63e810194a9?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4819061/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1314, "favorite_count": 0, "accepted_answer_id": 29797692, "answer_count": 2, "score": 0, "last_activity_date": 1429717637, "creation_date": 1429701738, "last_edit_date": 1429714605, "question_id": 29795973, "link": "https://stackoverflow.com/questions/29795973/vba-concatenate-cells-from-two-columns-based-on-criteria-present-in-a-third", "title": "VBA Concatenate Cells from two columns based on criteria present in a third", "body": "<p>I'm currently trying to combine two sets of data from two different columns based upon another set of data being present within a third column. </p>\n\n<p>In this case I need basic country tags from column G (Strings of three letter codes) to be joined to the front of the string present in column H providing the string \"Missing Audio\" or \"Missing Audio/Subs\" is present in column F</p>\n\n<p>My current fixed variable is that all data will start on the sixth row of their various columns however they will run to an undetermined point.  </p>\n\n<p>I've got various pieces of attempted code I'd be happy to post, but none of them seem to work and I'm beginning to get the impression that I've over complicated the process in my head and its creating a form of coders block! Any help offered would be massively appreciated</p>\n\n<p>As Asked here is my attempt, trying to pull in a basic Concatenate script with the variable requirements:</p>\n\n<pre><code>Sub Notestidy()\n\nDim w1 As Worksheet\nDim c As Range, AC As String\nDim rng As Range, rng2 As Range, iRow As Integer, iCol As Integer, i As Integer\n\nApplication.ScreenUpdating = False\nSet w1 = Worksheets(\"Sheet1\")\nSet rng = w1.Range(\"G6\", w1.Range(\"G\" &amp; Rows.Count).End(X1up))\nSet rng2 = w1.Range(\"H6\", w1.Range(\"H\" &amp; Rows.Count).End(X1up))\n\nFor Each c In w1.Range(\"F6\", w1.Range(\"F\" &amp; Rows.Count).End(xlUp))\n  AC = .String(\"Missing Audio\", \"Missing Audio/Subs\")\n  On Error Resume Next\n  If c = Range Then\n    Dim varConctnt As Variant\n    For iRow = 1 To rng.Rows.Count: rng2.Rows.Count\n    For iCol = 1 To rng.Columns.Count: rng2.Columns.Count\n    If Not rng(iRow, iCol).Value = vbNullString Then\n      varConctnt = varConctnt &amp; \", \" &amp; rng(iRow, iCol).Value\n    End If\nNext iCol\nIf varConctnt = vbNullString Then MsgBox \"Empty Array\": GoTo skip1\nMsgBox Mid(varConctnt, 2)\nvarConctnt = \"\"\n\nskip1:\nNext iRow\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>New Code Attempt:</p>\n\n<pre><code>&gt; Sub Notestidy()\n&gt; \n&gt; Dim w1 As Worksheet Dim rng As Range Dim FirstRow As Integer\n&gt; \n&gt; \n&gt; \n&gt; Set w1 = Worksheets(\"Sheet1\") FirstRow = 0\n&gt; \n&gt; \n&gt; Set rng = w1.Range(\"F:F\").Find(What:=\"Missing Audio\",\n&gt; LookIn:=xlValues, _   LookAt:=xlPart, SearchDirection:=xlNext,\n&gt; MatchCase:=False) While Not rng Is Nothing   If FirstRow &lt;&gt; rng.Row\n&gt; Then\n&gt;     If FirstRow = 0 Then\n&gt;       FirstRow = rng.Row\n&gt;     End If\n&gt;     w1.Range(\"H\" &amp; rng.Row) = w1.Range(\"G\" &amp; rng.Row) &amp; w1.Range(\"H\" &amp; rng.Row)\n&gt;     rng.FindNext After:=rng   Else\n&gt;     Set rng = Nothing   End If Wend\n&gt; \n&gt; Application.ScreenUpdating = True\n&gt; \n&gt; End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "is_accepted": false, "score": 0, "last_activity_date": 1429702676, "creation_date": 1429702676, "answer_id": 29796352, "question_id": 29794965, "link": "https://stackoverflow.com/questions/29794965/searching-specific-outlook-folder/29796352#29796352", "title": "Searching Specific Outlook Folder", "body": "<p>You can specify the folder to search in, within the inbox, by using the <code>.Folders</code> property. </p>\n\n<pre><code>Set myInbox = myNameSpace.GetDefaultFolder(olFolderInbox).Folders(\"myFolder\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 99, "user_id": 2519726, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bf95ae9c2094f7bc9c5cb1afb7360271?s=128&d=identicon&r=PG", "display_name": "user2519726", "link": "https://stackoverflow.com/users/2519726/user2519726"}, "edited": false, "score": 0, "creation_date": 1429755006, "post_id": 29796963, "comment_id": 47752594, "body": "hi guys, i just came online today. i&#39;ll try your codes now."}, {"owner": {"reputation": 99, "user_id": 2519726, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bf95ae9c2094f7bc9c5cb1afb7360271?s=128&d=identicon&r=PG", "display_name": "user2519726", "link": "https://stackoverflow.com/users/2519726/user2519726"}, "edited": false, "score": 0, "creation_date": 1429756654, "post_id": 29796963, "comment_id": 47753053, "body": "for this line:  Set myInbox = myNameSpace.GetDefaultFolder(olFolderInbox).Folders(&quot;myFolde&zwnj;&#8203;r&quot;) ... what if it&#39;s in a subfolder?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 99, "user_id": 2519726, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bf95ae9c2094f7bc9c5cb1afb7360271?s=128&d=identicon&r=PG", "display_name": "user2519726", "link": "https://stackoverflow.com/users/2519726/user2519726"}, "edited": false, "score": 0, "creation_date": 1429790465, "post_id": 29796963, "comment_id": 47771788, "body": "That&#39;s the answer given by @vockz.  To get a subfolder with this method you&#39;d use: <code>Set myInbox = myNameSpace.GetDefaultFolder(olFolderInbox).Folders(&quot;Temp&quot;).&zwnj;&#8203;Folders(&quot;aa&quot;)</code>  For more subfolders it may be better to put within a loop: <code>Dim sInbox As String   Dim sPath() As String Dim i As Long  sInbox = &quot;Temp\\aa&quot; sPath = Split(sInbox, &quot;\\&quot;)  Set myInbox = myNameSpace.GetDefaultFolder(olFolderInbox) For i = LBound(sPath) To UBound(sPath)     Set myInbox = myInbox.Folders(sPath(i)) Next i</code>"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1429704183, "creation_date": 1429704183, "answer_id": 29796963, "question_id": 29794965, "link": "https://stackoverflow.com/questions/29794965/searching-specific-outlook-folder/29796963#29796963", "title": "Searching Specific Outlook Folder", "body": "<p>I've had a play around and come up with the code below.  No need to set references to Outlook.</p>\n\n<pre><code>Sub Test1()\n\n    Dim oOutlook As Object 'Outlook.Application\n    Dim nNameSpace As Object 'Outlook.Namespace\n    Dim mFolderSelected As Object 'Outlook.MAPIFolder\n    Dim cFolder As Object\n    Dim oItem As Object\n    Dim oMyItem As Object\n    Dim sOutlookSearch As String\n    Dim aFolders() As String\n    Dim i As Long\n\n    'sOutlookSearch needs to be something like:\n    '\"Mailbox - Darren Bartrup-Cook\\Inbox\"\n\n    sOutlookSearch = ThisWorkbook.Worksheets(\"Sheet1\").Cells(1, 4)\n    sOutlookSearch = Replace(sOutlookSearch, \"/\", \"\\\")\n    aFolders() = Split(sOutlookSearch, \"\\\")\n\n    Set oOutlook = GetObject(, \"Outlook.Application\")\n    Set nNameSpace = oOutlook.GetNamespace(\"MAPI\")\n\n    Set mFolderSelected = nNameSpace.Folders.Item(aFolders(0))\n    If Not mFolderSelected Is Nothing Then\n        For i = 1 To UBound(aFolders)\n            Set cFolder = mFolderSelected.Folders\n            Set mFolderSelected = Nothing\n            Set mFolderSelected = cFolder.Item(aFolders(i))\n            If mFolderSelected Is Nothing Then\n              Exit For\n            End If\n        Next i\n    End If\n\n    'Set mFolderSelected = nNameSpace.PickFolder 'Alternative to above code block - just pick the folder.\n\n    For Each oItem In mFolderSelected.items\n        If oItem.class = 43 Then '43 = olmail\n            If InStr(1, oItem.Subject, \"sketch\") &gt; 0 Then\n                Debug.Print \"Found:  \" &amp; oItem.sendername\n                Exit For\n            End If\n        End If\n    Next oItem\n\nEnd Sub\n</code></pre>\n\n<p>The code block for finding the correct folder was taken from here:\n<a href=\"http://www.outlookcode.com/d/code/getfolder.htm\" rel=\"nofollow\">http://www.outlookcode.com/d/code/getfolder.htm</a></p>\n"}], "owner": {"reputation": 99, "user_id": 2519726, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bf95ae9c2094f7bc9c5cb1afb7360271?s=128&d=identicon&r=PG", "display_name": "user2519726", "link": "https://stackoverflow.com/users/2519726/user2519726"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4602, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1429704183, "creation_date": 1429699178, "last_edit_date": 1495534210, "question_id": 29794965, "link": "https://stackoverflow.com/questions/29794965/searching-specific-outlook-folder", "title": "Searching Specific Outlook Folder", "body": "<p>I've been scouring the internet for an easy way for a macro to search an Outlook specific folder (not the Inbox!) using an activecell holder. I've tried <a href=\"https://stackoverflow.com/questions/20082550/excel-vba-for-searching-in-mails-of-outlook\">Excel VBA for searching in mails of Outlook</a> and <a href=\"https://stackoverflow.com/questions/21549938/vba-search-in-outlook\">VBA Search in Outlook</a> to no avail. First I was having issues using Outlook references which is now resolved. The closest I was able to get was by using this code:</p>\n\n<pre><code>Dim myOlApp As New Outlook.Application\nDim myNameSpace As Outlook.NameSpace\nDim myInbox As Outlook.MAPIFolder\nDim myitems As Outlook.Items\nDim myitem As Object\nDim Found As Boolean\nDim OutlookSearch as string\n\nOutlooksearch = Cstr(Activecell.cells(1,4).Value)\n\nSet myNameSpace = myOlApp.GetNamespace(\"MAPI\")\nSet myInbox = myNameSpace.GetDefaultFolder(olFolderInbox)\nSet myitems = myInbox.Items\nFound = False\n\nFor Each myitem In myitems\n    If myitem.Class = olMail Then\n        If InStr(1, myitem.Subject, \"sketch\") &gt; 0 Then\n            Debug.Print \"Found\"\n            Found = True\n        End If\n    End If\nNext myitem\n\n'If the subject isn't found:\nIf Not Found Then\n    MsgBox \"Cannot find\"\nEnd If\n\nmyOlApp.Quit\nSet myOlApp = Nothing\n</code></pre>\n\n<p>So now, what I want to do is use the string that is in Activecell.cells(1, 4). as the parameter for the subject and do a search in a specific outlook folder in the inbox, to make it narrower. All I'm able to get is the MsgBox even if I've sent an email containing matching values with activecell.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4818925, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-TR-nQfRd63U/AAAAAAAAAAI/AAAAAAAAAF8/plw1YshDLPI/photo.jpg?sz=128", "display_name": "Yinghui Tan", "link": "https://stackoverflow.com/users/4818925/yinghui-tan"}, "edited": false, "score": 0, "creation_date": 1429753631, "post_id": 29796016, "comment_id": 47752162, "body": "Thanks for the quick reply! I&#39;ll give it a spin."}], "tags": [], "owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "is_accepted": false, "score": 1, "last_activity_date": 1429701842, "creation_date": 1429701842, "answer_id": 29796016, "question_id": 29794943, "link": "https://stackoverflow.com/questions/29794943/concatenated-formula-in-vba-editor-not-appearing/29796016#29796016", "title": "Concatenated formula in VBA editor not appearing", "body": "<p>You are mixing VBA code with a formula. You would not be able to <code>Sheets(2).range(cells(7,1))</code> inside of a formula. You would either need to take that part out of quotations so for example you will need to match your code to be something like <code>VLookup(rc1,\" &amp;  Sheets(2).Range(Cells(7, 1) \" &amp;, REST OF CODE</code></p>\n\n<p>Or use the actual sheet reference. So it would be <code>VLookup(rc1, Sheet2!A7, REST OF CODE</code> whenever you have a VBA reference to a sheet or VBA code reference.</p>\n\n<p>You would need to make sure you do this for all your code. As you cannot use the vba reference to cells or sheets in an actuall sheet formula like you have tried to do.</p>\n"}], "owner": {"reputation": 1, "user_id": 4818925, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-TR-nQfRd63U/AAAAAAAAAAI/AAAAAAAAAF8/plw1YshDLPI/photo.jpg?sz=128", "display_name": "Yinghui Tan", "link": "https://stackoverflow.com/users/4818925/yinghui-tan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429701842, "creation_date": 1429699118, "question_id": 29794943, "link": "https://stackoverflow.com/questions/29794943/concatenated-formula-in-vba-editor-not-appearing", "title": "Concatenated formula in VBA editor not appearing", "body": "<p>Sorry if this has been asked, can't seem to find similar questions. </p>\n\n<p>I have a pretty long formula that I need to put into a cell via a macro (see below), using FormulaR1C1. I know the text string itself can fit, as i happened to omitt the first =, and the entire string of text was input into the cell. When I add it back in though, nothing appears in the desired cell. </p>\n\n<p>Context: I'm trying to find that data from a column from each month's worksheet (thus there are 12), and summing that up. As for why I'm using the column function for the vlookup column, its so that i can do a fill later on.\nThe iferror is to make sure that if the sheet doesn't exist, the formula will still work.</p>\n\n<p>Anyone able to assist me? Thanks...</p>\n\n<pre><code>Cells(3, 3).FormulaR1C1 = \"=IfError(Vlookup(rc1, Sheets(1).Range(Cells(7, 1), Cells(8000, 60)), COLUMN(R[-2]C[32]), False), 0)\" &amp; _\n    \"+ IfError(VLookup(rc1, Sheets(2).Range(Cells(7, 1), Cells(8000, 60)), COLUMN(R[-2]C[32]), False), 0)\" &amp; _\n    \"+ IfError(VLookup(rc1, Sheets(3).Range(Cells(7, 1), Cells(8000, 60)), COLUMN(R[-2]C[32]), False), 0)\" &amp; _\n    \"+ IfError(VLookup(rc1, Sheets(4).Range(Cells(7, 1), Cells(8000, 60)), COLUMN(R[-2]C[32]), False), 0)\" &amp; _\n    \"+ IfError(VLookup(rc1, Sheets(5).Range(Cells(7, 1), Cells(8000, 60)), COLUMN(R[-2]C[32]), False), 0)\" &amp; _\n    \"+ IfError(VLookup(rc1, Sheets(6).Range(Cells(7, 1), Cells(8000, 60)), COLUMN(R[-2]C[32]), False), 0)\" &amp; _\n    \"+ IfError(VLookup(rc1, Sheets(7).Range(Cells(7, 1), Cells(8000, 60)), COLUMN(R[-2]C[32]), False), 0)\" &amp; _\n    \"+ IfError(VLookup(rc1, Sheets(8).Range(Cells(7, 1), Cells(8000, 60)), COLUMN(R[-2]C[32]), False), 0)\" &amp; _\n    \"+ IfError(VLookup(rc1, Sheets(9).Range(Cells(7, 1), Cells(8000, 60)), COLUMN(R[-2]C[32]), False), 0)\" &amp; _\n    \"+ IfError(VLookup(rc1, Sheets(10).Range(Cells(7, 1), Cells(8000, 60)), COLUMN(R[-2]C[32]), False), 0)\" &amp; _\n    \"+ IfError(VLookup(rc1, Sheets(11).Range(Cells(7, 1), Cells(8000, 60)), COLUMN(R[-2]C[32]), False), 0)\" &amp; _\n    \"+ IfError(VLookup(rc1, Sheets(12).Range(Cells(7, 1), Cells(8000, 60)), COLUMN(R[-2]C[32]), False), 0)\"\n</code></pre>\n"}, {"tags": ["vba", "surveymonkey"], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 4568803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/abed51cc509770a558da4f4fa1e0630c?s=128&d=identicon&r=PG&f=1", "display_name": "Mats Olsson", "link": "https://stackoverflow.com/users/4568803/mats-olsson"}, "edited": false, "score": 0, "creation_date": 1429727640, "post_id": 29796717, "comment_id": 47740052, "body": "Thanks @trigger! I will add error code to this project as soon as I have the basics working. Your code seem useful to me when I am there!"}], "tags": [], "owner": {"reputation": 671, "user_id": 4807661, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/52988a9e8b5c67060718b0de863bd041?s=128&d=identicon&r=PG", "display_name": "Trigger", "link": "https://stackoverflow.com/users/4807661/trigger"}, "is_accepted": false, "score": 1, "last_activity_date": 1429703595, "creation_date": 1429703595, "answer_id": 29796717, "question_id": 29794868, "link": "https://stackoverflow.com/questions/29794868/vba-and-surveymonkey-api/29796717#29796717", "title": "VBA and SurveyMonkey API", "body": "<p>The purpose of this code is to show error handling. This is vbscript but vbscript is pastable into VBA. The error will probably tell you why.</p>\n\n<p><strong>ALWAYS DO ERRORS on files (users delete them), networking or internet (they are not guaranteed to work), and registry reads (users delete them)</strong>.</p>\n\n<p>The URL has to be 100% correct. Unlike a browser there is no code to fix urls.</p>\n\n<p>The purpose of my program is to get error details.</p>\n\n<p>How I get a correct URL is to type my url in a browser, navigate, and the correct URL is often in the address bar. The other way is to use Properties of a link etc to get the URL.</p>\n\n<p>Also <code>Microsoft.XMLHTTP</code> maps to <code>Microsoft.XMLHTTP.1.0</code>. <code>HKEY_CLASSES_ROOT\\Msxml2.XMLHTTP</code> maps to <code>Msxml2.XMLHTTP.3.0</code>. Try a later one</p>\n\n<p>Try this way using xmlhttp. Edit the url's etc. If it seems to work comment out the if / end if to dump info even if seeming to work. It's vbscript but vbscript works in vb6. </p>\n\n<pre><code> On Error Resume Next\n Set File = WScript.CreateObject(\"Microsoft.XMLHTTP\")\n File.Open \"GET\", \"http://www.microsoft.com/en-au/default.aspx\", False\n 'This is IE 8 headers\n File.setRequestHeader \"User-Agent\", \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0; SLCC1; .NET CLR 2.0.50727; Media Center PC 5.0; .NET CLR 1.1.4322; .NET CLR 3.5.30729; .NET CLR 3.0.30618; .NET4.0C; .NET4.0E; BCD2000; BCD2000)\"\n File.Send\n If err.number &lt;&gt; 0 then \n    line =\"\"\n    Line  = Line &amp;  vbcrlf &amp; \"\" \n    Line  = Line &amp;  vbcrlf &amp; \"Error getting file\" \n    Line  = Line &amp;  vbcrlf &amp; \"==================\" \n    Line  = Line &amp;  vbcrlf &amp; \"\" \n    Line  = Line &amp;  vbcrlf &amp; \"Error \" &amp; err.number &amp; \"(0x\" &amp; hex(err.number) &amp; \") \" &amp; err.description \n    Line  = Line &amp;  vbcrlf &amp; \"Source \" &amp; err.source \n    Line  = Line &amp;  vbcrlf &amp; \"\" \n    Line  = Line &amp;  vbcrlf &amp; \"HTTP Error \" &amp; File.Status &amp; \" \" &amp; File.StatusText\n    Line  = Line &amp;  vbcrlf &amp;  File.getAllResponseHeaders\n    wscript.echo Line\n    Err.clear\n    wscript.quit\n End If\n\nOn Error Goto 0\n\n Set BS = CreateObject(\"ADODB.Stream\")\n BS.type = 1\n BS.open\n BS.Write File.ResponseBody\n BS.SaveToFile \"c:\\users\\test.txt\", 2\n</code></pre>\n\n<p>Also see if these other objects work.</p>\n\n<pre><code>C:\\Users&gt;reg query hkcr /f xmlhttp\n\nHKEY_CLASSES_ROOT\\Microsoft.XMLHTTP\nHKEY_CLASSES_ROOT\\Microsoft.XMLHTTP.1.0\nHKEY_CLASSES_ROOT\\Msxml2.ServerXMLHTTP\nHKEY_CLASSES_ROOT\\Msxml2.ServerXMLHTTP.3.0\nHKEY_CLASSES_ROOT\\Msxml2.ServerXMLHTTP.4.0\nHKEY_CLASSES_ROOT\\Msxml2.ServerXMLHTTP.5.0\nHKEY_CLASSES_ROOT\\Msxml2.ServerXMLHTTP.6.0\nHKEY_CLASSES_ROOT\\Msxml2.XMLHTTP\nHKEY_CLASSES_ROOT\\Msxml2.XMLHTTP.3.0\nHKEY_CLASSES_ROOT\\Msxml2.XMLHTTP.4.0\nHKEY_CLASSES_ROOT\\Msxml2.XMLHTTP.5.0\nHKEY_CLASSES_ROOT\\Msxml2.XMLHTTP.6.0\n\nEnd of search: 12 match(es) found.\n</code></pre>\n\n<h2>Also be aware there is a limit on how many times you can call any particular XMLHTTP object before a lockout occurs. If that happens, and it does when debugging code, just change to a different xmlhttp object</h2>\n"}, {"comments": [{"owner": {"reputation": 101, "user_id": 4568803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/abed51cc509770a558da4f4fa1e0630c?s=128&d=identicon&r=PG&f=1", "display_name": "Mats Olsson", "link": "https://stackoverflow.com/users/4568803/mats-olsson"}, "edited": false, "score": 0, "creation_date": 1429872964, "post_id": 29830015, "comment_id": 47816957, "body": "Thanks @Tony. It works! I am now plunging into the JSON world. Confusion is where I am at right now ;-)"}], "tags": [], "owner": {"reputation": 545, "user_id": 3062422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5RveE.jpg?s=128&g=1", "display_name": "Tony Mayse", "link": "https://stackoverflow.com/users/3062422/tony-mayse"}, "is_accepted": true, "score": 2, "last_activity_date": 1429808587, "creation_date": 1429808587, "answer_id": 29830015, "question_id": 29794868, "link": "https://stackoverflow.com/questions/29794868/vba-and-surveymonkey-api/29830015#29830015", "title": "VBA and SurveyMonkey API", "body": "<p>You're sending your API key as part of the request body of your POST request. Add the query parameter to the URL directly and this should work.</p>\n\n<pre><code>\"https://api.surveymonkey.net/v2/surveys/get_survey_list?api_key=\" &amp; apiKey\n</code></pre>\n\n<p>You'll then need to use \"send\" to send a JSON encoded request object. For get_survey_list, an empty object (\"{}\") will get your started.</p>\n"}], "owner": {"reputation": 101, "user_id": 4568803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/abed51cc509770a558da4f4fa1e0630c?s=128&d=identicon&r=PG&f=1", "display_name": "Mats Olsson", "link": "https://stackoverflow.com/users/4568803/mats-olsson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 666, "favorite_count": 0, "accepted_answer_id": 29830015, "answer_count": 2, "score": 0, "last_activity_date": 1429808587, "creation_date": 1429698931, "last_edit_date": 1429699043, "question_id": 29794868, "link": "https://stackoverflow.com/questions/29794868/vba-and-surveymonkey-api", "title": "VBA and SurveyMonkey API", "body": "<p>I have tried to do access the SM API through VBA. I have left out the JSON for now as I am already in trouble. The below is giving me \"Developer Inactive\" as a result, though I have another project in VB.NET (using a .NET DLL) where the same key and token works fine and I can retrieve the list of surveys.\nWhat am I doing wrong? </p>\n\n<pre><code>Public Sub GetSMList()\n\nDim apiKey As String\nDim Token As String\nDim sm As Object\n\napiKey = \"myKey\" \nToken = \"myToken\"\n\nSet sm = CreateObject(\"MSXML2.XMLHTTP.6.0\")\n\nWith sm\n    .Open \"POST\", \"https://api.surveymonkey.net/v2/surveys/get_survey_list\", False\n    .setRequestHeader \"Authorization\", \"Bearer \" &amp; Token\n    .setRequestHeader \"Content-Type\", \"application/json\"\n\n    .send \"api_key=\" &amp; apiKey\n\n    result = .responseText\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vlookup", "vba"], "comments": [{"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 2, "creation_date": 1429698435, "post_id": 29794493, "comment_id": 47717490, "body": "Welcome to StackOverflow. Please show us the code you have so we can help improve or optimize it."}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1429698916, "post_id": 29794493, "comment_id": 47717829, "body": "To optimize this process you might consider treating your source and new data as tables, and query them using the Jet Text file driver with an update query. See <a href=\"https://msdn.microsoft.com/en-us/library/ms974559.aspx\" rel=\"nofollow noreferrer\">MSDN: Much ADO about Text Files</a> and <a href=\"https://support.microsoft.com/en-us/kb/278973?wa=wsignin1.0\" rel=\"nofollow noreferrer\">MS KB: ExcelADO demonstrates how to use ADO to read and write data in Excel workbooks</a>"}, {"owner": {"reputation": 27, "user_id": 4818787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6d820987a09e9b8863fe9cacd4a396?s=128&d=identicon&r=PG&f=1", "display_name": "xoPIEMANox", "link": "https://stackoverflow.com/users/4818787/xopiemanox"}, "edited": false, "score": 0, "creation_date": 1429700558, "post_id": 29794493, "comment_id": 47719136, "body": "I&#39;m hoping to set up a Macro within excel so using the VB editor in excel and call it from my &#39;PersonalMacro&#39; set of data (I have others to remove columns and find unique flags)..  Tidying up code as we speak as it was a complete mess!!!"}], "answers": [{"tags": [], "owner": {"reputation": 869, "user_id": 4437159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a32f5d6d49f7d05252f3fc8cc526763?s=128&d=identicon&r=PG&f=1", "display_name": "stucharo", "link": "https://stackoverflow.com/users/4437159/stucharo"}, "is_accepted": true, "score": 1, "last_activity_date": 1429803448, "last_edit_date": 1429803448, "creation_date": 1429710596, "answer_id": 29799663, "question_id": 29794493, "link": "https://stackoverflow.com/questions/29794493/update-specific-values-within-a-large-array-where-they-match-a-secondary-array/29799663#29799663", "title": "Update specific values within a large array where they match a secondary array (like a vlookup)", "body": "<p>Here's a piece of code I developed for something similar but I've tweaked a bit to suit your question.  It might need some tidying up since I don't have access to your files to test it with:</p>\n\n<pre><code>Sub Flags()\n\n'Assuming your flag map is in a 2 column range in a worksheet\n'you can create an array then add it to a collection\n'so you can access each entry in col2 by the key from col1\nDim fMap() As Variant\nDim FlagMap As New Collection\n\nfMap = Range(\"A1:B6\") 'range where FlagMap stored\n\nDim i As Integer        'We can reuse this in other counters....\nFor i = LBound(fMap) To UBound(fMap)\n    FlagMap.Add CStr(fMap(i, 2)), CStr(fMap(i, 1)) 'FlagMap range has \"Key\" field 1st - assign to Collection correctly\nNext i\n\n'Create a FileSystemObject to work with your csv's\nDim fso As Object\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\n\n'Create a file object to contain your original csv\nDim ifil As Object\nSet ifil = fso.GetFile(\"C:\\completepath\\myinfile.csv\")\n\n'Create a textstream from the input csv file\nDim its As Object\nSet its = ifil.OpenAsTextStream()\n\n'We can also output this back into a new csv by\n'creating  a textstream to let us write to a new file\nDim ots As Object\nSet ots = fso.CreateTextFile(\"C:\\completepath\\myoutfile.csv\")\n\n'We'll also need a string variable to send to this stream\nDim oStr As String\n\n'Create a counter to keep track of lines through your\n'input textstream\nDim lineCounter As Integer\nlineCounter = 0\n\n'You can split each line into an array delimited by \",\" using\n'the \"Split\" function so we need an array variable to hold this\nDim lineArray() As String\n\n'Because this steps through row wise, we also need an\n'collection to hold references to the columns of interest\n'and a variant to access them again\nDim cols As New Collection\nDim col as Variant\n\n'Continue a loop until you reach the end of your textstream\n'i.e. the end of your input csv file\nDo While Not its.AtEndOfStream\n\n    'Increment your line counter\n    lineCounter = lineCounter + 1\n    lineArray = Split(its.ReadLine, \",\")\n\n    'If you are on the first row, find all the interesting columns\n    If lineCounter = 1 Then ' assuming the headings are on row 1\n        For i = LBound(lineArray) To UBound(lineArray)\n            'If we find a heading ending in \"_flag\" then store its\n            'column number in the cols collection.\n            If Right(lineArray(i), 5) = \"_flag\" Then\n                cols.Add i 'Add ref of where heading \"_flag\" is to limit lookup just to those areas and not the whole dataset\n            End If\n        Next i\n\n    'If it's not the first row then process the data as normal\n    Else\n        'Just look at the columns of interest\n        For Each col In cols\n            'Replace the value in that column with the corresponding\n            'value in the FlagMap\n            lineArray(CInt(col)) = FlagMap(lineArray(CInt(col))) 'this is the lookup in the collection based on the \"key\"\n        Next col\n    End If\n\n    'Now print the line back out to your new csv file\n    oStr = \"\"\n    For i = LBound(lineArray) To UBound(lineArray)\n        oStr = oStr + lineArray(i) &amp; \",\"\n    Next i\n    oStr = Left(oStr, Len(oStr) - 1)\n\n    ots.WriteLine (oStr)\n\nLoop\n\n'Close the textstreams\nits.Close\nots.Close\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/aa242724%28v=vs.60%29.aspx\" rel=\"nofollow\"><code>TextStream</code></a> will let you read and write .csv files in VBA without opening them in excel. <a href=\"https://msdn.microsoft.com/en-us/library/a1y8b3b3%28v=vs.90%29.aspx\" rel=\"nofollow\"><code>Collections</code></a> allows you to develop <code>'key':{value}</code> relationships, which sounds a bit like your FlagMap.</p>\n"}], "owner": {"reputation": 27, "user_id": 4818787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6d820987a09e9b8863fe9cacd4a396?s=128&d=identicon&r=PG&f=1", "display_name": "xoPIEMANox", "link": "https://stackoverflow.com/users/4818787/xopiemanox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 29799663, "answer_count": 1, "score": 2, "last_activity_date": 1429803448, "creation_date": 1429698018, "last_edit_date": 1531161705, "question_id": 29794493, "link": "https://stackoverflow.com/questions/29794493/update-specific-values-within-a-large-array-where-they-match-a-secondary-array", "title": "Update specific values within a large array where they match a secondary array (like a vlookup)", "body": "<p>I have been tasked to write a \"simple\" macro in Excel to perform the following tasks that I can do with VLOOKUPs relatively easily but due to the size of the data can take in some instances a day and totally locks up the PC.</p>\n\n<p>I have a .csv with various headers which I need to interrogate to find and replace values in those columns with headers ending in \"_flag\".</p>\n\n<p>The \"flags\" (used to identify confidence levels of the data) have been updated and all the older data needs to be refreshed accordingly.</p>\n\n<p>I have what I refer to as a \"FlagMap\" that lists the old flag and what the corresponding new flag should be as a separate table.</p>\n\n<p>Normally in Excel I'd have a worksheet (named range) with the FlagMap and the CSV on another tab and put in a dummy column manually next to the column to change and run a VLOOKUP - Have done some of the smaller datasets but given the amount I have to do I'd be retired before I finish (some have 20 columns with \"flags\" (40 columns in total) and up to 70,000 rows).</p>\n\n<p>I have worked out the process but am really stuck with the coding.</p>\n\n<p>Overall loop of\nFind column with heading ending in \"_flag\"\n   If True Loop through vlookup style code to change\n     based on if cell in source data = a flag in FlagMap(COL1) replace it with FlagMap(COL2) value\nEnd Change Loop\nNext Column</p>\n\n<p>One of the key things is can I replace blank (flags) in the original source data (by specifying a blank entry and corresponding flag in the FlagMap array).</p>\n\n<p>My code is a complete mess as I've tried to build it bit by bit (by recording macros etc.. was looking at using Filters on the columns).</p>\n\n<p>CODE as follows: It doesn't seem to do anything though; brain-hurts....\n    Sub FlagUpdate_v00()</p>\n\n<pre><code>Dim wsDATA As Worksheet 'original data to be updated\nDim wsFLAG As Worksheet 'Flag mapping lookup sheet\nDim rFLAGMAP As Range 'Flag mapping range n ROWs &amp; 2 COLs(no headers)\nDim rDATA As Range 'Data to update\nDim i As Long, j As Long, n As Long 'Loop counters\nDim FlagLRow As Long, DataLRow As Long 'last row numbers of corresponding data tables\nDim FlagArray, DataArray, TempArray() As String  'lookup values\n\nSet wsDATA = ThisWorkbook.Sheets(\"TEST\") 'assigns location of data\nSet wsFLAG = ThisWorkbook.Sheets(\"FlagMap\") 'assigns location of flags\n\n'lastrow = Cells.SpecialCells(xlCellTypeLastCell).Row\n'FlagLRow = wsFLAG.Cells(Rows.Count, 1).End(x1Up).Row 'Sets number of rows upper bound of loop *NOT WORKING\n'DataLRow = wsDATA.Cells(Rows.Count, 1).End(x1Up).Row 'Sets number of rows upper bound of loop *NOT WORKING\nFlagLRow = wsFLAG.Cells.SpecialCells(xlCellTypeLastCell).Row 'Sets number of rows upper bound of loop\nDataLRow = wsDATA.Cells.SpecialCells(xlCellTypeLastCell).Row 'Sets number of rows upper bound of loop\n\nSet rFLAGMAP = wsFLAG.Range(\"A2:A\" &amp; FlagLRow) 'sets range of flags to avoiding column header\n\n'this will need to be within a loop to only select range of those columns ending \"_Flag\"\n'Set rDATA = wsDATA.Range(ColLoopRef &amp; \"2:A\" &amp; DataLRow) 'set range to update\nSet rDATA = wsDATA.Range(\"F2:F\" &amp; DataLRow) 'test data only looking at one small column of data\n\nFlagArray = rFLAGMAP.Value 'set contents of array\nDataArray = rDATA.Value 'set contents of array\n\n'Loop to replace\n For i = LBound(DataArray) To UBound(DataArray) 'start end values of i loop (Original Flag)\n    For j = LBound(FlagArray) To UBound(FlagArray) 'start end values of j loop (FlagMap)\n        If DataArray(i, 1) = FlagArray(j, 1) Then 'if Original Data Flag matches the value in the FlagMap\n            Set DataArray(i, 1) = FlagArray(j, 2) 'replace it with that from column 2\n        End If 'all flags should be Mapped hence always finds one\n        'only issue may be blanks!!\n    Next j 'loop through the MAPPEDFLAG list (ie. a vlookup) 1st\nNext i 'move on to the next DATA flag to be re-flagged\n\n\nEnd Sub\n</code></pre>\n\n<p>Thanks to @stucharo for highlighting the exact example I have which is as follows:</p>\n\n<p>Current data set in the form of a CSV</p>\n\n<pre><code>   h1        h2     h3_flag      h4     h5_flag      h6\n-------------------------------------------------------------\n   val1      val2      val3      val4      val5      val6\n   val2      val3      val4      val5      val6      val1\n   val3      val4      val5      val6      val1      val2\n   val4      val5      val6      val1      val2      val3\n   val5      val6      val1      val2      val3      val4\n   val6      val1      val2      val3      val4      val5\n</code></pre>\n\n<p>Flag Mapping table</p>\n\n<pre><code> flag      alt.   \n--------------------\nval1      vala\nval2      valb\nval3      valc\nval4      vald\nval5      vale\nval6      valf\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>    h1        h2     h3_flag      h4     h5_flag      h6\n-------------------------------------------------------------\n   val1      val2      valc      val4      vale      val6\n   val2      val3      vald      val5      valf      val1\n   val3      val4      vale      val6      vala      val2\n   val4      val5      valf      val1      valb      val3\n   val5      val6      vala      val2      valc      val4\n   val6      val1      valb      val3      vald      val5\n</code></pre>\n"}, {"tags": ["csv", "ms-access", "vba", "pipe", "columnheader"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4818583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4367e63843129bf71159e02fd7d4c6a1?s=128&d=identicon&r=PG&f=1", "display_name": "Sc0tty", "link": "https://stackoverflow.com/users/4818583/sc0tty"}, "edited": false, "score": 0, "creation_date": 1429711781, "post_id": 29795977, "comment_id": 47728404, "body": "Excellent! Works perfectly.  I was putting in the name property but not quite like that. I see where I was going wrong now.  Thanks a lot for your help."}], "tags": [], "owner": {"reputation": 1561, "user_id": 4783374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ktbGv.jpg?s=128&g=1", "display_name": "PhilS", "link": "https://stackoverflow.com/users/4783374/phils"}, "is_accepted": true, "score": 0, "last_activity_date": 1429701742, "creation_date": 1429701742, "answer_id": 29795977, "question_id": 29793474, "link": "https://stackoverflow.com/questions/29793474/access-export-pipe-delim-csv-with-headers-using-vba/29795977#29795977", "title": "Access - Export pipe delim CSV with headers using VBA", "body": "<p>You need to write the Name-Property of the recordset fields to the file as well.</p>\n\n<p>Insert this into your code to achieve that:</p>\n\n<pre><code>[...]\nOpen strFilePath For Output As #intFile\n\nIf Not rst.EOF Then\n   For intCount = 0 To rst.Fields.Count - 1\n      strHold = strHold &amp; rst.Fields(intCount).Name &amp; \"|\"\n   Next\n   If Right(strHold, 1) = \"|\" Then\n      strHold = Left(strHold, Len(strHold) - 1)\n   End If\n   Print #intFile, strHold\n   strHold = vbNullString\nEnd If\n\nDo Until rst.EOF\n[...]\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4818583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4367e63843129bf71159e02fd7d4c6a1?s=128&d=identicon&r=PG&f=1", "display_name": "Sc0tty", "link": "https://stackoverflow.com/users/4818583/sc0tty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1161, "favorite_count": 0, "accepted_answer_id": 29795977, "answer_count": 1, "score": 0, "last_activity_date": 1594644903, "creation_date": 1429695484, "last_edit_date": 1594644903, "question_id": 29793474, "link": "https://stackoverflow.com/questions/29793474/access-export-pipe-delim-csv-with-headers-using-vba", "title": "Access - Export pipe delim CSV with headers using VBA", "body": "<p>this is the first question I've posted so hopefully don't break any site rules!  I have looked for the answer but can't seem to find quite what I'm looking for.</p>\n\n<p>I have a piece of VB code which is exporting data but it's not including the column headers which I need.</p>\n\n<p>I'm using Access 2010, and I'm exporting a pipe delimited CSV file to a folder location of my choice. I'm exporting from a table in access which has been created from a parent table using several queries, so it's basically just a table of results that I'm trying to export in CSV.</p>\n\n<p>Here is the code I'm using that IS exporting as pipe delim CSV but not adding headers;</p>\n\n<pre><code>Private Sub BtnExportCSV_Click()\n\nDim db As DAO.Database\nDim rst As DAO.Recordset\nDim intFile As Integer\nDim strFilePath As String\nDim intCount As Integer\nDim strHold\n\nstrFilePath = \"I:\\Data\\test.csv\"\n\nSet db = CurrentDb\n\nSet rst = db.OpenRecordset(\"T_Export_CSV\", dbOpenForwardOnly)\n\nintFile = FreeFile\n\n\nOpen strFilePath For Output As #intFile\n\nDo Until rst.EOF\n   For intCount = 0 To rst.Fields.Count - 1\n    strHold = strHold &amp; rst(intCount).Value &amp; \"|\"\n   Next\n   If Right(strHold, 1) = \"|\" Then\n      strHold = Left(strHold, Len(strHold) - 1)\n   End If\n   Print #intFile, strHold\n   rst.MoveNext\n   strHold = vbNullString\nLoop\n\nClose intFile\nrst.Close\nSet rst = Nothing\n\nMsgBox (\"Export Completed Successfully\")\n\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance for the help!</p>\n\n<p>Scott</p>\n"}, {"tags": ["excel", "excel-2010", "vba"], "answers": [{"comments": [{"owner": {"reputation": 481, "user_id": 2927815, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/283bf22ebaa99bcca7fcf7cd35dc6bef?s=128&d=identicon&r=PG&f=1", "display_name": "Guzzyman", "link": "https://stackoverflow.com/users/2927815/guzzyman"}, "edited": false, "score": 0, "creation_date": 1429695966, "post_id": 29793503, "comment_id": 47715643, "body": "Hi @Smackenzie, That I know already. But the challenge is the worksheet may be hidden. I can&#39;t see any sheet called datareference in the workbook. If the sheet is hidden, how can I unhide it?"}, {"owner": {"reputation": 481, "user_id": 2927815, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/283bf22ebaa99bcca7fcf7cd35dc6bef?s=128&d=identicon&r=PG&f=1", "display_name": "Guzzyman", "link": "https://stackoverflow.com/users/2927815/guzzyman"}, "edited": false, "score": 0, "creation_date": 1429700901, "post_id": 29793503, "comment_id": 47719369, "body": "Hi @Smackenzie , You response guided me in the right direction. I had to enable the Data Reference sheet in the vba code to make it visible."}, {"owner": {"reputation": 2456, "user_id": 1754307, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/7170dd9a6ce7317ab73835c15ef1d9f7?s=128&d=identicon&r=PG", "display_name": "smackenzie", "link": "https://stackoverflow.com/users/1754307/smackenzie"}, "reply_to_user": {"reputation": 481, "user_id": 2927815, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/283bf22ebaa99bcca7fcf7cd35dc6bef?s=128&d=identicon&r=PG&f=1", "display_name": "Guzzyman", "link": "https://stackoverflow.com/users/2927815/guzzyman"}, "edited": false, "score": 0, "creation_date": 1429791578, "post_id": 29793503, "comment_id": 47772627, "body": "Hi.  Glad you fixed it.  If your question had mentioned you couldn&#39;t see the sheet - I would have given a different answer ;)"}], "tags": [], "owner": {"reputation": 2456, "user_id": 1754307, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/7170dd9a6ce7317ab73835c15ef1d9f7?s=128&d=identicon&r=PG", "display_name": "smackenzie", "link": "https://stackoverflow.com/users/1754307/smackenzie"}, "is_accepted": true, "score": 1, "last_activity_date": 1429695580, "creation_date": 1429695580, "answer_id": 29793503, "question_id": 29793076, "link": "https://stackoverflow.com/questions/29793076/how-to-get-the-input-range-and-cell-link-of-an-excel-sheet/29793503#29793503", "title": "How to get the input range and cell link of an excel sheet", "body": "<p>The drop down list is getting its values from the Input Range.  So in a worksheet called Data References (it may be hidden, it may not), in cells U10 to U14, there are some values which are what appear in the drop down list.</p>\n\n<p>When you select an item in the drop down list, it places the number of the item you selected in the Cell link (cell U17).  So if you pick the first item in the list, the value 1 will be placed into the cell U17 in the Data References worksheet.   This numeric value allows you index into the cells (using a formula or code), to work out the value which was selected (for example using an OFFSET formula, you can work out from the Cell link value, what value in the list in the range U10 to U14 is actually selected).</p>\n\n<p>If you want to expand, adjust the list - simply add a list of items into some cells somewhere, and add the cell reference in the Input Range section.  The drop down will pick up the values from these cells.</p>\n"}], "owner": {"reputation": 481, "user_id": 2927815, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/283bf22ebaa99bcca7fcf7cd35dc6bef?s=128&d=identicon&r=PG&f=1", "display_name": "Guzzyman", "link": "https://stackoverflow.com/users/2927815/guzzyman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1264, "favorite_count": 0, "closed_date": 1429723668, "accepted_answer_id": 29793503, "answer_count": 1, "score": -2, "last_activity_date": 1429695580, "creation_date": 1429694563, "last_edit_date": 1531161705, "question_id": 29793076, "link": "https://stackoverflow.com/questions/29793076/how-to-get-the-input-range-and-cell-link-of-an-excel-sheet", "closed_reason": "Not suitable for this site", "title": "How to get the input range and cell link of an excel sheet", "body": "<p>I am new to VBA programming so please don't be offended with this non-technical question.</p>\n\n<p>I have an excel workbook with macros which was passworded. I was able to break the password using <a href=\"https://i.stack.imgur.com/JlhK5.png\" rel=\"nofollow noreferrer\">this tool</a></p>\n\n<p>I edited the file to suit my purpose but I wasn't able to change the values to the drop down list. How can I get the input range and the cell link of the excel sheet in the picture below?</p>\n\n<p><img src=\"https://i.stack.imgur.com/JlhK5.png\" alt=\"enter image description here\"></p>\n\n<p>What does that line in the Input range and cell link mean and how can I get to update the values?</p>\n"}, {"tags": ["excel", "excel-2013", "vba"], "comments": [{"owner": {"reputation": 869, "user_id": 4437159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a32f5d6d49f7d05252f3fc8cc526763?s=128&d=identicon&r=PG&f=1", "display_name": "stucharo", "link": "https://stackoverflow.com/users/4437159/stucharo"}, "edited": false, "score": 0, "creation_date": 1429693296, "post_id": 29791226, "comment_id": 47713761, "body": "Do you see the &quot;Working...&quot; and &quot;Still working...&quot; etc. or is the whole status bar blank?"}, {"owner": {"reputation": 1218, "user_id": 794000, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5971a89ddf93af266741f99c66f5a4d6?s=128&d=identicon&r=PG", "display_name": "IRHM", "link": "https://stackoverflow.com/users/794000/irhm"}, "reply_to_user": {"reputation": 869, "user_id": 4437159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a32f5d6d49f7d05252f3fc8cc526763?s=128&d=identicon&r=PG&f=1", "display_name": "stucharo", "link": "https://stackoverflow.com/users/4437159/stucharo"}, "edited": false, "score": 0, "creation_date": 1429693480, "post_id": 29791226, "comment_id": 47713893, "body": "Hi @stucharo, thank you for coming back to me with this. The only message I see is &quot;Still Working&quot;, but it has been suggested to me that this may be because the process is so instaneous and that&#39;s why I don&#39;t see this text. Kind Regards. Chris"}, {"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1429693599, "post_id": 29791226, "comment_id": 47713980, "body": "wait a minute, you&#39;re not adding any new information to what you just asked in your previous question: <a href=\"http://stackoverflow.com/questions/29789439/status-bar-progress-meter-not-showing-messages\">Status Bar Progress Meter not showing messages</a>"}, {"owner": {"reputation": 1218, "user_id": 794000, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5971a89ddf93af266741f99c66f5a4d6?s=128&d=identicon&r=PG", "display_name": "IRHM", "link": "https://stackoverflow.com/users/794000/irhm"}, "reply_to_user": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1429694068, "post_id": 29791226, "comment_id": 47714323, "body": "Hi @Jean-Fran&#231;oisCorbett, with respect that&#39;s what I was trying to say at the time, but you suggested a new post. The issue is the fact that the blue scrolling markers are not being shown in the &#39;Status Bar&#39;. Kind Regards."}, {"owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1429694501, "post_id": 29791226, "comment_id": 47714605, "body": "What happens when you set breakpoints or step through the code (<code>Shift</code> + <code>F8</code> in the VBA editor)?  That should let you see the status bar changes slowly as you step through."}, {"owner": {"reputation": 1218, "user_id": 794000, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5971a89ddf93af266741f99c66f5a4d6?s=128&d=identicon&r=PG", "display_name": "IRHM", "link": "https://stackoverflow.com/users/794000/irhm"}, "reply_to_user": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1429694882, "post_id": 29791226, "comment_id": 47714867, "body": "Hi @aucuparia, when I step through the code all of the text messages appear and the &#39;Status Bar expands in size when it reaches these parts of the code <code>String(10, ChrW(9609))</code> with the 10 indicating the number of blocks to display. Kind Regards Chris"}, {"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1429695223, "post_id": 29791226, "comment_id": 47715114, "body": "How long does the whole code take to execute? What happens if you put a <code>DoEvents</code> after each <code>StatusBar</code> statement?"}, {"owner": {"reputation": 1218, "user_id": 794000, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5971a89ddf93af266741f99c66f5a4d6?s=128&d=identicon&r=PG", "display_name": "IRHM", "link": "https://stackoverflow.com/users/794000/irhm"}, "reply_to_user": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1429695687, "post_id": 29791226, "comment_id": 47715447, "body": "Hi @Jean-Fran&#231;oisCorbett. At the moment this takes about 5 minutes but in the near future more data will be added which will increase the time the data extract takes. I can confirm that I&#39;ve implemented the <code>DoEvents</code> but unfortunately this has no effect. Many thanks and kind regards. Chris"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1429696686, "post_id": 29791226, "comment_id": 47716197, "body": "Why don&#39;t you use a userform instead?"}, {"owner": {"reputation": 1218, "user_id": 794000, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5971a89ddf93af266741f99c66f5a4d6?s=128&d=identicon&r=PG", "display_name": "IRHM", "link": "https://stackoverflow.com/users/794000/irhm"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1429696847, "post_id": 29791226, "comment_id": 47716322, "body": "Hi @Rory, thank you for taking the time to come back to me with this. I had though of that, but the problem I have is that we use dual montiors, and I wan&#39;t sure how to always make sure that the userform appeared on the screen where the macro was being run. Kind Regards. Chris"}, {"owner": {"reputation": 869, "user_id": 4437159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a32f5d6d49f7d05252f3fc8cc526763?s=128&d=identicon&r=PG&f=1", "display_name": "stucharo", "link": "https://stackoverflow.com/users/4437159/stucharo"}, "edited": false, "score": 0, "creation_date": 1429698407, "post_id": 29791226, "comment_id": 47717466, "body": "Have you tried changing <code>ChrW(9609)</code> to a simple <code>A</code>?  It might be that your system represents <code>ChrW(9609)</code> differently.  Also, <code>ChrW(9608)</code> and <code>ChrW(9610)</code> should give you pretty much the same character, do they do anything different?"}, {"owner": {"reputation": 1218, "user_id": 794000, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5971a89ddf93af266741f99c66f5a4d6?s=128&d=identicon&r=PG", "display_name": "IRHM", "link": "https://stackoverflow.com/users/794000/irhm"}, "reply_to_user": {"reputation": 869, "user_id": 4437159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a32f5d6d49f7d05252f3fc8cc526763?s=128&d=identicon&r=PG&f=1", "display_name": "stucharo", "link": "https://stackoverflow.com/users/4437159/stucharo"}, "edited": false, "score": 0, "creation_date": 1429699233, "post_id": 29791226, "comment_id": 47718076, "body": "Hi @stucharo, thank you for coming back to me with this.I&#39;ve tried both suggestions and although changing the character to 9611 for example changes the height of the status bar, there is no blue content to this. Kind Regards. Chris"}, {"owner": {"reputation": 869, "user_id": 4437159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a32f5d6d49f7d05252f3fc8cc526763?s=128&d=identicon&r=PG&f=1", "display_name": "stucharo", "link": "https://stackoverflow.com/users/4437159/stucharo"}, "edited": false, "score": 0, "creation_date": 1429699860, "post_id": 29791226, "comment_id": 47718582, "body": "What colour is it?  <code>ChrW(9609)</code> should just return the unicode character that looks like a rectangular block, the blue colour is a property of the statusbar"}, {"owner": {"reputation": 1218, "user_id": 794000, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5971a89ddf93af266741f99c66f5a4d6?s=128&d=identicon&r=PG", "display_name": "IRHM", "link": "https://stackoverflow.com/users/794000/irhm"}, "reply_to_user": {"reputation": 869, "user_id": 4437159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a32f5d6d49f7d05252f3fc8cc526763?s=128&d=identicon&r=PG&f=1", "display_name": "stucharo", "link": "https://stackoverflow.com/users/4437159/stucharo"}, "edited": false, "score": 0, "creation_date": 1429701032, "post_id": 29791226, "comment_id": 47719472, "body": "Hi @stucharo, I think we may be onto something here. If I look very very closely  Chrw(9609) are definietely white blocks. Kind Regards. chris"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1429703521, "post_id": 29791226, "comment_id": 47721367, "body": "Run it in debug and post a screenshot of what you <i>do</i> see while it&#39;s running - that might help us. I just ran it in Excel 2010, and it works just fine. I get a black box on a grey background, and is exactly what I&#39;d expect with the <code>Silver</code> color scheme. I changed to the <code>Blue</code> color scheme and get dark blue boxes on a light blue background."}, {"owner": {"reputation": 1218, "user_id": 794000, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5971a89ddf93af266741f99c66f5a4d6?s=128&d=identicon&r=PG", "display_name": "IRHM", "link": "https://stackoverflow.com/users/794000/irhm"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1429704578, "post_id": 29791226, "comment_id": 47722316, "body": "Hi @Freeman, thank you for looking at my post. I&#39;ll post the screen shot on return home this evening if that&#39;s ok. In terms of the debug screen there is nothing out of the ordinary that happens. The debug works through each line highlighting them in yellow as you would expect. I hope this helps. Kind Regards"}, {"owner": {"reputation": 1218, "user_id": 794000, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5971a89ddf93af266741f99c66f5a4d6?s=128&d=identicon&r=PG", "display_name": "IRHM", "link": "https://stackoverflow.com/users/794000/irhm"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1429717001, "post_id": 29791226, "comment_id": 47732747, "body": "Hi @Freeman, as discussed earlier, I&#39;ve enclosed the screenshot you asked for in my original post which shows the &#39;Status Bar&#39; when I run the code through debug or indeed not in debug. Kind Regards. Chris"}, {"owner": {"reputation": 5277, "user_id": 156648, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2dc62782d79a90b829e96f36f48fe164?s=128&d=identicon&r=PG", "display_name": "guitarthrower", "link": "https://stackoverflow.com/users/156648/guitarthrower"}, "edited": false, "score": 1, "creation_date": 1429718389, "post_id": 29791226, "comment_id": 47733797, "body": "Progress bars are cool, but sometimes it&#39;s just easier to show a percent complete."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 5277, "user_id": 156648, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2dc62782d79a90b829e96f36f48fe164?s=128&d=identicon&r=PG", "display_name": "guitarthrower", "link": "https://stackoverflow.com/users/156648/guitarthrower"}, "edited": false, "score": 2, "creation_date": 1429718642, "post_id": 29791226, "comment_id": 47734006, "body": "Well, it does look like the white bar is growing, so it does indicate some change, but it&#39;s not as cool as the little blocks.  I&#39;ve only got <i>2010</i>, so I can&#39;t help you with the <i>2013</i> issue...  @guitarthrower has a valid point, that may be a better bet in this situation..."}, {"owner": {"reputation": 1218, "user_id": 794000, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5971a89ddf93af266741f99c66f5a4d6?s=128&d=identicon&r=PG", "display_name": "IRHM", "link": "https://stackoverflow.com/users/794000/irhm"}, "reply_to_user": {"reputation": 5277, "user_id": 156648, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2dc62782d79a90b829e96f36f48fe164?s=128&d=identicon&r=PG", "display_name": "guitarthrower", "link": "https://stackoverflow.com/users/156648/guitarthrower"}, "edited": false, "score": 0, "creation_date": 1429721262, "post_id": 29791226, "comment_id": 47735800, "body": "Hi @guitarthrower, thank you for taking the time to reply to my post, and a very worthwhile point.Could you perhaps explain or show me how I may do this please. Many thanks and kind regards. Chris"}, {"owner": {"reputation": 1218, "user_id": 794000, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5971a89ddf93af266741f99c66f5a4d6?s=128&d=identicon&r=PG", "display_name": "IRHM", "link": "https://stackoverflow.com/users/794000/irhm"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1429721311, "post_id": 29791226, "comment_id": 47735830, "body": "Hi @FreeMan, thank you very much for your help it is truly appreciated and as you say a good point from guitarthrower. Kind Regards. Chris"}, {"owner": {"reputation": 869, "user_id": 4437159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a32f5d6d49f7d05252f3fc8cc526763?s=128&d=identicon&r=PG&f=1", "display_name": "stucharo", "link": "https://stackoverflow.com/users/4437159/stucharo"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1429724346, "post_id": 29791226, "comment_id": 47737891, "body": "I get exactly the same as @FreeMan on Excel 2010 and changing themes on Excel 2013 gives white rectangles on variously grey backgrounds.  However, that&#39;s not neccessarily a bad thing.....the subsequent unicode characters are rectangles of reducing width so you could make a status bar that grows really smoothly if you added a bit more code around what you have.  Or just set the Statusbar text to a percentage."}, {"owner": {"reputation": 1218, "user_id": 794000, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5971a89ddf93af266741f99c66f5a4d6?s=128&d=identicon&r=PG", "display_name": "IRHM", "link": "https://stackoverflow.com/users/794000/irhm"}, "reply_to_user": {"reputation": 869, "user_id": 4437159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a32f5d6d49f7d05252f3fc8cc526763?s=128&d=identicon&r=PG&f=1", "display_name": "stucharo", "link": "https://stackoverflow.com/users/4437159/stucharo"}, "edited": false, "score": 0, "creation_date": 1429767088, "post_id": 29791226, "comment_id": 47756350, "body": "Hi @stucharo, thank you very much for the confirmation, all your help and for the suggestion on the progress bar. Kind regards. Chris"}], "answers": [{"comments": [{"owner": {"reputation": 1218, "user_id": 794000, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5971a89ddf93af266741f99c66f5a4d6?s=128&d=identicon&r=PG", "display_name": "IRHM", "link": "https://stackoverflow.com/users/794000/irhm"}, "edited": false, "score": 0, "creation_date": 1429767013, "post_id": 29806917, "comment_id": 47756312, "body": "Hi @guitarthrower thank you very much for this. I&#39;ll be able to work with this. Kind Regards. Chris"}], "tags": [], "owner": {"reputation": 5277, "user_id": 156648, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2dc62782d79a90b829e96f36f48fe164?s=128&d=identicon&r=PG", "display_name": "guitarthrower", "link": "https://stackoverflow.com/users/156648/guitarthrower"}, "is_accepted": true, "score": 0, "last_activity_date": 1429730272, "creation_date": 1429730272, "answer_id": 29806917, "question_id": 29791226, "link": "https://stackoverflow.com/questions/29791226/progress-meter-characters-not-displaying-as-intended/29806917#29806917", "title": "Progress Meter characters not displaying as intended", "body": "<p>If you would like, you could replace the bar with a percentage. I typically calculate percentages based on how far through the process the procedure is. In your case you appear to be assigning specific values to your progress, which works as well. </p>\n\n<p>To implement, it would be as simple as replacing this line in your code:</p>\n\n<pre><code>Application.StatusBar = String(5, ChrW(9609)) &amp; \" Working...\"\n</code></pre>\n\n<p>With the following:</p>\n\n<pre><code>Application.StatusBar = \"Working... 16% complete\"\n</code></pre>\n\n<p>(16% because 5/30 from your code).</p>\n\n<p>If you wanted it to be calculated, you could do the following:</p>\n\n<pre><code>Application.StatusBar = \"Working... \" &amp; Round(1 / 6 * 100, 0) &amp; \"%\"\n</code></pre>\n\n<p>You could replace both <code>1</code> and <code>6</code> with variables as needed.</p>\n"}, {"comments": [{"owner": {"reputation": 1218, "user_id": 794000, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5971a89ddf93af266741f99c66f5a4d6?s=128&d=identicon&r=PG", "display_name": "IRHM", "link": "https://stackoverflow.com/users/794000/irhm"}, "edited": false, "score": 0, "creation_date": 1429855053, "post_id": 29823378, "comment_id": 47805770, "body": "Hi @Jean-Fran&#231;ois Corbett, thank you for coming back to me with this. It&#39;s not the gaps that are the issue, they can be seen if I look closely, it&#39;s the coloured blocks I&#39;m not getting. They&#39;re white rather than blue. Kind Regards Chris"}, {"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "reply_to_user": {"reputation": 1218, "user_id": 794000, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5971a89ddf93af266741f99c66f5a4d6?s=128&d=identicon&r=PG", "display_name": "IRHM", "link": "https://stackoverflow.com/users/794000/irhm"}, "edited": false, "score": 0, "creation_date": 1429858979, "post_id": 29823378, "comment_id": 47807720, "body": "Same difference! It&#39;s just the font!"}], "tags": [], "owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "is_accepted": false, "score": 0, "last_activity_date": 1429858964, "last_edit_date": 1429858964, "creation_date": 1429791793, "answer_id": 29823378, "question_id": 29791226, "link": "https://stackoverflow.com/questions/29791226/progress-meter-characters-not-displaying-as-intended/29823378#29823378", "title": "Progress Meter characters not displaying as intended", "body": "<p>You're expecting blue <code>\u2589\u2589\u2589\u2589\u2589</code> with a little tiny narrow gap between each rectangle symbol <code>\u2589</code>. </p>\n\n<p>But you're getting white \u2589\u2589\u2589\u2589\u2589 with no gaps. </p>\n\n<p>The answer to \"why is this happening\" is the following: it's just a different font! </p>\n\n<p>Apparently the Excel 2013 font is white and makes the rectangles a tiny bit wider than the Excel 2010 font such that the gap disappears -- and the rectangles aren't blue but white. </p>\n\n<p>Note that this in no way impedes the functionality of the progress bar. It's just a question of aesthetics and taste \u2014 whether you prefer blue or white, <a href=\"https://duckduckgo.com/?q=tuck+no+tuck&amp;ia=videos&amp;iai=bl3HcIXvIo0\" rel=\"nofollow\">gaps or no gaps</a>. </p>\n"}], "owner": {"reputation": 1218, "user_id": 794000, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5971a89ddf93af266741f99c66f5a4d6?s=128&d=identicon&r=PG", "display_name": "IRHM", "link": "https://stackoverflow.com/users/794000/irhm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 651, "favorite_count": 0, "accepted_answer_id": 29806917, "answer_count": 2, "score": -1, "last_activity_date": 1429858964, "creation_date": 1429689575, "last_edit_date": 1531164843, "question_id": 29791226, "link": "https://stackoverflow.com/questions/29791226/progress-meter-characters-not-displaying-as-intended", "title": "Progress Meter characters not displaying as intended", "body": "<p>I'm trying to implement a 'Status Bar Progress Meter' I've found <a href=\"http://datapigtechnologies.com/blog/index.php/show-a-progress-meter-in-the-status-bar/\" rel=\"nofollow noreferrer\">here</a> and implemented this in my code as below:</p>\n\n<pre><code>Private Sub btnFetchFiles_Click()\n\n    Dim j As Integer\n\n        iRow = 20\n        fPath = \"\\\\c\\s\\CAF1\\Dragon Mentor Group\\Dragon Scripts\\Current\\April 2015\"\n        If fPath &lt;&gt; \"\" Then\n\n            ' make StatusBar visible\n            Application.DisplayStatusBar = True\n            Set FSO = New Scripting.FileSystemObject\n            'First Message\n            Application.StatusBar = String(5, ChrW(9609)) &amp; \" Working...\"\n            If FSO.FolderExists(fPath) &lt;&gt; False Then\n                'Second Message\n                Application.StatusBar = String(10, ChrW(9609)) &amp; \" Working...\"\n                Set SourceFolder = FSO.GetFolder(fPath)\n                'Third Message\n                Application.StatusBar = String(15, ChrW(9609)) &amp; \" Working...\"\n                IsSubFolder = True\n                'Fourth Message\n                Application.StatusBar = String(15, ChrW(9609)) &amp; \" Still Working...\"\n                Call DeleteRows\n                If AllFilesCheckBox.Value = True Then\n                'Fifth Message\n                Application.StatusBar = String(15, ChrW(9609)) &amp; \" Still Working...\"\n                    Call ListFilesInFolder(SourceFolder, IsSubFolder)\n                    Call ResultSorting(xlAscending, \"C20\")\n                    Call FormatCells\n                Else\n                    Call ListFilesInFolderXtn(SourceFolder, IsSubFolder)\n                    Call ResultSorting(xlAscending, \"C20\")\n                    Call FormatCells\n                End If\n                'Sixth Message\n                Application.StatusBar = String(20, ChrW(9609)) &amp; \"Still Working...\"\n                lblFCount.Caption = iRow - 20\n                'Seventh Message\n                Application.StatusBar = String(25, ChrW(9609)) &amp; \"Almost Done...\"\n            Else\n                MsgBox \"Selected Path Does Not Exist !!\" &amp; vbNewLine &amp; vbNewLine &amp; \"Select Correct One and Try Again !!\"\n            End If\n        Else\n            MsgBox \"Folder Path Can not be Empty !!\" &amp; vbNewLine &amp; vbNewLine &amp; \"\"\n        End If\n                'Eigth Message\n                Application.StatusBar = String(30, ChrW(9609)) &amp; \"All Files Extracted...\"\n       'Relinquish the StatusBar\n        Application.StatusBar = False\n    End Sub\n</code></pre>\n\n<p>You will see in the image below that there is a blue progress meter running from left to right with small rectangles, </p>\n\n<p><img src=\"https://i.stack.imgur.com/rd560.png\" alt=\"\"></p>\n\n<p>but when I run my script, I'm left not with small rectangles but with a continuous white bar as shown here:</p>\n\n<p><img src=\"https://i.stack.imgur.com/mjRUo.png\" alt=\"\"></p>\n\n<p>Why? Where have I gone wrong?</p>\n"}, {"tags": ["vba", "loops", "save", "ms-word"], "comments": [{"owner": {"reputation": 15122, "user_id": 4519059, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/MBHID.png?s=128&g=1", "display_name": "shA.t", "link": "https://stackoverflow.com/users/4519059/sha-t"}, "edited": false, "score": 0, "creation_date": 1429689754, "post_id": 29790854, "comment_id": 47711345, "body": "When should files save?, If you just need to find files in a directory you will found many solutions of that here like using <code>Scripting</code> com ;)."}, {"owner": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "reply_to_user": {"reputation": 15122, "user_id": 4519059, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/MBHID.png?s=128&g=1", "display_name": "shA.t", "link": "https://stackoverflow.com/users/4519059/sha-t"}, "edited": false, "score": 0, "creation_date": 1429690648, "post_id": 29790854, "comment_id": 47711888, "body": "I&#39;m using this in addition to a text comparison macro where two files will be compared, and an additional &quot;results&quot; file will be created in a new word document. I want to save these results file in a specified folder."}, {"owner": {"reputation": 15122, "user_id": 4519059, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/MBHID.png?s=128&g=1", "display_name": "shA.t", "link": "https://stackoverflow.com/users/4519059/sha-t"}, "edited": false, "score": 0, "creation_date": 1429699001, "post_id": 29790854, "comment_id": 47717896, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/29767537/loop-comparison-macro\">Loop comparison macro</a>"}], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "edited": false, "score": 0, "creation_date": 1429695561, "post_id": 29791963, "comment_id": 47715332, "body": "Not sure if i&#39;m getting this right... but the FileSystemObject gets files from a specific folder/drive right? What i&#39;m trying to do is to save files into a specific folder/drive. Therefore, the files do not exist yet and i dont think FileSystemObject will work?? I&#39;m very new to this though so I may be wrong."}, {"owner": {"reputation": 15122, "user_id": 4519059, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/MBHID.png?s=128&g=1", "display_name": "shA.t", "link": "https://stackoverflow.com/users/4519059/sha-t"}, "reply_to_user": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "edited": false, "score": 0, "creation_date": 1429697534, "post_id": 29791963, "comment_id": 47716801, "body": "@JunJie Oh!, So you want to make a new Excel file with your results?, I add a solution ;)."}], "tags": [], "owner": {"reputation": 15122, "user_id": 4519059, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/MBHID.png?s=128&g=1", "display_name": "shA.t", "link": "https://stackoverflow.com/users/4519059/sha-t"}, "is_accepted": false, "score": 0, "last_activity_date": 1429697515, "last_edit_date": 1495540623, "creation_date": 1429691768, "answer_id": 29791963, "question_id": 29790854, "link": "https://stackoverflow.com/questions/29790854/vba-automatically-saving-files/29791963#29791963", "title": "VBA automatically saving files", "body": "<p>When you want to work with files with some functionality I suggest you to use <a href=\"https://stackoverflow.com/a/3236348/4519059\">FileSystemObject com object</a>.</p>\n\n<p>There are many examples of using it in projects like:</p>\n\n<ol>\n<li><a href=\"https://stackoverflow.com/a/26750246/4519059\">Get content of the directory using wildcast with FileSystemObject</a></li>\n<li><a href=\"https://stackoverflow.com/q/18966991/4519059\">How can I use the FileSystemObject to \u201cCopy and rename\u201d</a></li>\n</ol>\n\n<p>You can also use <code>like</code> operator in your loop for finding files -in (1) sample-; like this:</p>\n\n<pre><code>IF (f1.name like \"ResultTest*.docx\") THEN\n    ' Write your code here\nEND IF\n</code></pre>\n\n<hr>\n\n<ul>\n<li><a href=\"http://www.mrexcel.com/forum/excel-questions/50109-creating-new-excel-file-using-visual-basic-applications.html\" rel=\"nofollow noreferrer\">Source</a></li>\n</ul>\n\n\n\n<pre><code>On Error Resume Next\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\n' Getting file name by default input window\nFlname = InputBox(\"Enter File Name :\", \"Creating New File...\")\nIf Flname &lt;&gt; \"\" Then\n\n    ' adding a new workbook\n    Set NewWkbk = Workbooks.Add\n\n    ' Copy data from a sheet (e.g 5) from current workbook to a sheet (e.g 1) in that new one\n    ThisWorkbook.Sheets(5).Copy Before:=NewWkbk.Sheets(1)\n\n    ' Create excel file by saving the new workbook as file name\n    NewWkbk.SaveAs ThisWorkbook.Path &amp; \"\\\" &amp; Flname\n\n    If Err.Number = 1004 Then\n        NewWkbk.Close\n        MsgBox \"File Name Not Valid.\"\n        Exit Sub\n    End If\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 851, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429697515, "creation_date": 1429688444, "last_edit_date": 1429689585, "question_id": 29790854, "link": "https://stackoverflow.com/questions/29790854/vba-automatically-saving-files", "title": "VBA automatically saving files", "body": "<p>I'm trying to automatically save files in a specified folder.\nLike having <code>ResultTest1</code>, <code>ResultTest2</code>, <code>ResultTest3</code>, and so forth.</p>\n\n<pre><code>Dim savedName As String\nDim arNames() As String\nDim myCount As Integer\n\nsavedName = Dir$(\"D:\\Users\\tmp4jj\\Desktop\\ComparisonTool\\ResultTest*.docx\")\nDo Until savedName = \"\"\n    myCount = myCount + 1\n    ReDim Preserve arNames(1 To myCount)\n    arNames(myCount) = savedName\n    savedName = Dir$\nLoop\n</code></pre>\n\n<p>I've been trying out this code but I'm not sure if it'll actually work. Also, I tried recording a macro where I changed the options of the saved file's destination beforehand. These codes popped out, not exactly sure if it'll help.</p>\n\n<pre><code>ActiveDocument.SaveAs2 FileName:=\"ResultTest.docx\", FileFormat:= _\nwdFormatXMLDocument, LockComments:=False, Password:=\"\", AddToRecentFiles _\n:=True, WritePassword:=\"\", ReadOnlyRecommended:=False, EmbedTrueTypeFonts _\n:=False, SaveNativePictureFormat:=False, SaveFormsData:=False, _\nSaveAsAOCELetter:=False, CompatibilityMode:=14\n</code></pre>\n"}, {"tags": ["excel", "vba", "powershell"], "comments": [{"owner": {"reputation": 17, "user_id": 4336861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f83098dec27abd4e0d0dfb356ba6fe80?s=128&d=identicon&r=PG", "display_name": "Kay Nix", "link": "https://stackoverflow.com/users/4336861/kay-nix"}, "edited": false, "score": 0, "creation_date": 1429702282, "post_id": 29790734, "comment_id": 47720416, "body": "i have more then 5000 rows, i was hoping i could apply a function like: Worksheets(&quot;Sheet1&quot;).Range(&quot;A2:A5000&quot;).ConvertToNumber"}], "answers": [{"tags": [], "owner": {"reputation": 3078, "user_id": 2633276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DqoAh.jpg?s=128&g=1", "display_name": "Rubanov", "link": "https://stackoverflow.com/users/2633276/rubanov"}, "is_accepted": false, "score": 0, "last_activity_date": 1429694564, "last_edit_date": 1429694564, "creation_date": 1429692591, "answer_id": 29792284, "question_id": 29790734, "link": "https://stackoverflow.com/questions/29790734/powershell-function-for-convert-to-number/29792284#29792284", "title": "powershell function for convert to number", "body": "<p>In Powershell there are several ways to do conversions to an integer. (Powershell does not have a data type number)</p>\n\n<pre><code>$myInt = [int]\"4527427\"\n$myInt = [int]::Parse(\"4527427\")    \n$myInt = [System.Convert]::ToInt32(\"4527427\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 36251, "user_id": 311712, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Ea76T.jpg?s=128&g=1", "display_name": "David Brabant", "link": "https://stackoverflow.com/users/311712/david-brabant"}, "is_accepted": false, "score": 0, "last_activity_date": 1429717444, "last_edit_date": 1429717444, "creation_date": 1429696613, "answer_id": 29793966, "question_id": 29790734, "link": "https://stackoverflow.com/questions/29790734/powershell-function-for-convert-to-number/29793966#29793966", "title": "powershell function for convert to number", "body": "<pre><code>$csvData = @\"\nA,B\n01234567, 01234567.05\n-123, 00045.06\n\"@\n\n# Or Import-Csv &lt;yourpath&gt; -delimiter &lt;yourdelimiter&gt; in your case\n$csv = ConvertFrom-Csv $csvData -delimiter ','\n\nWrite-Host \"\"\nWrite-Host \"Before conversion\"\n$csv\n\nWrite-Host \"\"\nWrite-Host \"After conversion\"\n\n\n# Or Import-Csv &lt;yourpath&gt; -delimiter &lt;yourdelimiter&gt; | %{ etc... in your case\n$csv = ConvertFrom-Csv $csvData -Delimiter ',' | %{\n new-object PSObject -prop @{\n    A = [int] ($_.A);\n    B = [double] ($_.B);\n  }\n}\n\n$csv\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 4336861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f83098dec27abd4e0d0dfb356ba6fe80?s=128&d=identicon&r=PG", "display_name": "Kay Nix", "link": "https://stackoverflow.com/users/4336861/kay-nix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1534, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1429717444, "creation_date": 1429688092, "question_id": 29790734, "link": "https://stackoverflow.com/questions/29790734/powershell-function-for-convert-to-number", "title": "powershell function for convert to number", "body": "<p>Im using powershell to open two excel workbook and copy data from one into another, the data I'm importing contains both text and numeric data.  After it's been imported, everything is treated as text. \ni have two columns: A and B\nA has the following: 01234567 should get converted into 1234567\nB has the following: 01234567.05 should get converted into 1234567.05</p>\n\n<p>Of course I could manually do the \"Convert to Number\" function, but this import is done automatically so no manual action need to be performed. (another way to do it manually is to use the Text-to-column)</p>\n\n<p>This is not working, not even manually, if i try to make the conversion using the formating function, its not doing anything\nWorksheets(\"Sheet1\").Range(\"A2:A5000\").NumberFormat = \"0000000\"</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "edited": false, "score": 0, "creation_date": 1429691130, "post_id": 29790637, "comment_id": 47712222, "body": "Does it need to be automated (VBA), or is a manual approach as shA.t suggests sufficient?"}, {"owner": {"reputation": 11, "user_id": 4818061, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153598708524879/picture?type=large", "display_name": "Paul Burrows", "link": "https://stackoverflow.com/users/4818061/paul-burrows"}, "reply_to_user": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "edited": false, "score": 0, "creation_date": 1429831186, "post_id": 29790637, "comment_id": 47798810, "body": "I was looking more towards an automated resolution due to the amount of sheets being created I was hoping to speed up the current process"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4818061, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153598708524879/picture?type=large", "display_name": "Paul Burrows", "link": "https://stackoverflow.com/users/4818061/paul-burrows"}, "edited": false, "score": 0, "creation_date": 1429831145, "post_id": 29791388, "comment_id": 47798799, "body": "I was looking more towards an automated resolution due to the amount of sheets being created I was hoping to speed up the current process"}], "tags": [], "owner": {"reputation": 15122, "user_id": 4519059, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/MBHID.png?s=128&g=1", "display_name": "shA.t", "link": "https://stackoverflow.com/users/4519059/sha-t"}, "is_accepted": false, "score": 0, "last_activity_date": 1429931713, "last_edit_date": 1429931713, "creation_date": 1429690131, "answer_id": 29791388, "question_id": 29790637, "link": "https://stackoverflow.com/questions/29790637/vba-coding-to-create-txt-files-for-each-sheet-in-excel-2010/29791388#29791388", "title": "VBA coding to create .txt files for each sheet in Excel 2010", "body": "<p>Just follow this solution:</p>\n\n<ol>\n<li><code>File</code> > <code>Export</code> > <code>Change File Type</code> > <code>Text (Tab delimited)(*.txt)</code></li>\n<li>In <em>Save As ...</em>  window select name of text file for first sheet and <kbd>OK</kbd>.</li>\n<li>Repeat saving your text files as (2).</li>\n</ol>\n\n<p>I think, When you don't need any functionality more than this you don't need to recreate wheel ;).</p>\n\n<hr>\n\n<p>I think you need to use this statement:</p>\n\n<pre><code>Dim ws As Worksheet\n\nFor Each ws In ActiveWorkbook.Sheets\n\n    ws.Activate\n    ActiveWorkbook.SaveAs Filename:=\"C:\\\" + ws.Name + \".txt\", _\n                  FileFormat:=xlText, CreateBackup:=False\n\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 4818061, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153598708524879/picture?type=large", "display_name": "Paul Burrows", "link": "https://stackoverflow.com/users/4818061/paul-burrows"}, "edited": false, "score": 0, "creation_date": 1430118324, "post_id": 29843681, "comment_id": 47902086, "body": "Worked a treat Miss Palmer you are an angel I was way off on my script"}], "tags": [], "owner": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "is_accepted": false, "score": 1, "last_activity_date": 1429867625, "creation_date": 1429867625, "answer_id": 29843681, "question_id": 29790637, "link": "https://stackoverflow.com/questions/29790637/vba-coding-to-create-txt-files-for-each-sheet-in-excel-2010/29843681#29843681", "title": "VBA coding to create .txt files for each sheet in Excel 2010", "body": "<p>This should get you going. It creates a new .txt file for each worksheet in the workbook, saving to the same directory as the workbook itself is in.</p>\n\n<p>Let me know if you have any trouble with it.</p>\n\n<pre><code>Sub TextFileExport()\n\n    Dim rngCell As Range\n    Dim shtWorkSheet As Worksheet\n    Dim i As Integer\n    Dim strFilename As String   'text file filename\n\n    'specify output name here\n    strFilename = \"OutputName\"\n\n    'loop through worksheets\n    For Each shtWorkSheet In ThisWorkbook.Worksheets\n\n        'create new file name\n        i = i + 1\n        Open ThisWorkbook.Path &amp; \"\\\" &amp; strFilename &amp; \"Sheet_\" &amp; i &amp; \".txt\" For Output As #1\n\n        'loop through cells\n        For Each rngCell In shtWorkSheet.UsedRange\n\n            If rngCell.Text &lt;&gt; \"\" Then\n                'print the line\n                Print #1, rngCell.Text\n            End If\n\n        Next rngCell\n\n    'close so can reopen next one\n    Close #1\n\n    Next shtWorkSheet\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4818061, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153598708524879/picture?type=large", "display_name": "Paul Burrows", "link": "https://stackoverflow.com/users/4818061/paul-burrows"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1999, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1429931713, "creation_date": 1429687734, "last_edit_date": 1531161705, "question_id": 29790637, "link": "https://stackoverflow.com/questions/29790637/vba-coding-to-create-txt-files-for-each-sheet-in-excel-2010", "title": "VBA coding to create .txt files for each sheet in Excel 2010", "body": "<p>I'm working on a spreadsheet that contains 2 columns of data <code>customer</code>, <code>product</code> and I have created a macro to separate the list into individual sheets per product which is working like a dream. Now, I want to create a Text (MS-DOS) <code>.txt</code> file for each of the sheets and for them to save in a specific location.</p>\n\n<p>Not sure what information is required after this as the sheets that are created are just 1 column with the customers name the sheet is named after the product.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 678, "user_id": 755082, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2FDR.jpg?s=128&g=1", "display_name": "Armin Sadeghi", "link": "https://stackoverflow.com/users/755082/armin-sadeghi"}, "is_accepted": true, "score": 0, "last_activity_date": 1429687726, "creation_date": 1429687726, "answer_id": 29790635, "question_id": 29790508, "link": "https://stackoverflow.com/questions/29790508/how-can-i-display-the-excel-publish-as-pdf-or-xps-dialog-using-vba/29790635#29790635", "title": "How can I display the Excel Publish as PDF or XPS dialog using VBA?", "body": "<p>After some investigation I still can't find any way of displaying this dialog using <code>Application.Dialogs</code>, however I can display it using this:</p>\n\n<pre><code>Application.CommandBars.ExecuteMso \"FileSaveAsPdfOrXps\"\n</code></pre>\n\n<p>Works in Excel 2007, 2010 and 2013.</p>\n"}, {"comments": [{"owner": {"reputation": 678, "user_id": 755082, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2FDR.jpg?s=128&g=1", "display_name": "Armin Sadeghi", "link": "https://stackoverflow.com/users/755082/armin-sadeghi"}, "edited": false, "score": 0, "creation_date": 1429753650, "post_id": 29795176, "comment_id": 47752173, "body": "I&#39;m aware of ExportAsFixedFormat, however this doesn&#39;t help because there are a whole host of options that you can specify (like which page to publish, the quality etc, and so I would have to end up recreating the whole Publish as PDF or XPS dialog, along with options. That being said, your workaround is worth noting and may help others who want a simplified interface."}], "tags": [], "owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "is_accepted": false, "score": 1, "last_activity_date": 1429699709, "creation_date": 1429699709, "answer_id": 29795176, "question_id": 29790508, "link": "https://stackoverflow.com/questions/29790508/how-can-i-display-the-excel-publish-as-pdf-or-xps-dialog-using-vba/29795176#29795176", "title": "How can I display the Excel Publish as PDF or XPS dialog using VBA?", "body": "<p>I have a work-around which could work for you.</p>\n\n<p>1) Create a userform which asks whether the user would like to save as XPS or PDF. Create 2 buttons on the userform, one showing text \"XPS\" and the other showing text \"PDF\".</p>\n\n<p>2) Add code to each button, so that when pressed, it will save the document in the format specified by the user.</p>\n\n<p>In module with code:</p>\n\n<pre><code>userform_save.Show\n</code></pre>\n\n<p>In the xps button:</p>\n\n<pre><code>Private Sub cb_xps_Click()\n    ActiveSheet.ExportAsFixedFormat Type:=xlTypeXPS, Filename:=filepath &amp; xpsName\n    Unload Me\nEnd Sub\n</code></pre>\n\n<p>In the pdf button:</p>\n\n<pre><code>Private Sub cb_pdf_Click()\n    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:=filepath &amp; pdfName\n    Unload Me\nEnd Sub\n</code></pre>\n\n<p>Let me know your thoughts.</p>\n"}], "owner": {"reputation": 678, "user_id": 755082, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2FDR.jpg?s=128&g=1", "display_name": "Armin Sadeghi", "link": "https://stackoverflow.com/users/755082/armin-sadeghi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1513, "favorite_count": 0, "accepted_answer_id": 29790635, "answer_count": 2, "score": 0, "last_activity_date": 1429699709, "creation_date": 1429687410, "last_edit_date": 1531164843, "question_id": 29790508, "link": "https://stackoverflow.com/questions/29790508/how-can-i-display-the-excel-publish-as-pdf-or-xps-dialog-using-vba", "title": "How can I display the Excel Publish as PDF or XPS dialog using VBA?", "body": "<p>I know I can use the following VBA to display the regular Excel (2010) Save As dialog (which is close), but how do I display the specific \"Publish as PDF or XPS\" dialog? This dialog limits the file types to PDF and XPS and is the one I am after, but there doesn't seem to be an enumeration for it in the <code>XlBuiltInDialog</code> enumeration.</p>\n\n<pre><code>Application.Dialogs(xlDialogSaveAs).Show\n</code></pre>\n\n<p>This particular dialog is accessed through the GUI by going to File -> Save &amp; Send -> Create PDF/XPS Document -> Create PDF/XPS.</p>\n"}, {"tags": ["sql", "vba", "ms-access", "select", "insert"], "comments": [{"owner": {"reputation": 344, "user_id": 1235144, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/503f770edf9315397dbc40b285775363?s=128&d=identicon&r=PG", "display_name": "Morteza", "link": "https://stackoverflow.com/users/1235144/morteza"}, "edited": false, "score": 0, "creation_date": 1429690543, "post_id": 29790112, "comment_id": 47711813, "body": "It doesnt let me to somthing like this <code>INSERT INTO Report  ( brand, Bag, Acc, Id) Select Top 1 * from  ((SELECT TOP 1 Brand FROM (SELECT Brand,date FROM Report WHERE ID= x) WHERE Brand IS NOT NULL), &#39;&#39;,&#39;&#39;,5022)</code>"}, {"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1429695023, "post_id": 29790112, "comment_id": 47714977, "body": "Could you show some example data? Your query is beyond comprehension."}], "answers": [{"comments": [{"owner": {"reputation": 344, "user_id": 1235144, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/503f770edf9315397dbc40b285775363?s=128&d=identicon&r=PG", "display_name": "Morteza", "link": "https://stackoverflow.com/users/1235144/morteza"}, "edited": false, "score": 0, "creation_date": 1429687503, "post_id": 29790423, "comment_id": 47709929, "body": "it says this operation is not allowed in subqueries!"}, {"owner": {"reputation": 5125, "user_id": 2958272, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/0ocAT.jpg?s=128&g=1", "display_name": "sqluser", "link": "https://stackoverflow.com/users/2958272/sqluser"}, "reply_to_user": {"reputation": 344, "user_id": 1235144, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/503f770edf9315397dbc40b285775363?s=128&d=identicon&r=PG", "display_name": "Morteza", "link": "https://stackoverflow.com/users/1235144/morteza"}, "edited": false, "score": 0, "creation_date": 1429689398, "post_id": 29790423, "comment_id": 47711134, "body": "You should look into your query. You can use <code>INSERT INTO SELECT</code> if you want to <code>INSERT</code> from a <code>SELECT</code> statement."}, {"owner": {"reputation": 344, "user_id": 1235144, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/503f770edf9315397dbc40b285775363?s=128&d=identicon&r=PG", "display_name": "Morteza", "link": "https://stackoverflow.com/users/1235144/morteza"}, "edited": false, "score": 0, "creation_date": 1429689507, "post_id": 29790423, "comment_id": 47711190, "body": "I have used it if you check the second query it is insert with select"}, {"owner": {"reputation": 344, "user_id": 1235144, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/503f770edf9315397dbc40b285775363?s=128&d=identicon&r=PG", "display_name": "Morteza", "link": "https://stackoverflow.com/users/1235144/morteza"}, "edited": false, "score": 0, "creation_date": 1429689644, "post_id": 29790423, "comment_id": 47711281, "body": "Is it possible to use variable in access sql query?"}, {"owner": {"reputation": 5125, "user_id": 2958272, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/0ocAT.jpg?s=128&g=1", "display_name": "sqluser", "link": "https://stackoverflow.com/users/2958272/sqluser"}, "reply_to_user": {"reputation": 344, "user_id": 1235144, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/503f770edf9315397dbc40b285775363?s=128&d=identicon&r=PG", "display_name": "Morteza", "link": "https://stackoverflow.com/users/1235144/morteza"}, "edited": false, "score": 0, "creation_date": 1429689662, "post_id": 29790423, "comment_id": 47711289, "body": "You can. <code>SELECT &#39;a&#39;, a FROM table</code>. first a is actual a but the 2nd a is coming from table"}, {"owner": {"reputation": 344, "user_id": 1235144, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/503f770edf9315397dbc40b285775363?s=128&d=identicon&r=PG", "display_name": "Morteza", "link": "https://stackoverflow.com/users/1235144/morteza"}, "edited": false, "score": 0, "creation_date": 1429689675, "post_id": 29790423, "comment_id": 47711300, "body": "Sth like INSERT INTO Report ( Brand, NameP ,id) values ((@brand), 5, 5022); @Brand =INSERT INTO TempSelect ( Brand, NameP ,id) values ((&quot;SELECT Brand,date FROM Report WHERE ID=5022) WHERE Brand IS NOT NULL ORDER BY date DESC Union All SELECT top 1 null FROM report WHERE Brand IS NULL&quot;), 5, 5022);"}, {"owner": {"reputation": 344, "user_id": 1235144, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/503f770edf9315397dbc40b285775363?s=128&d=identicon&r=PG", "display_name": "Morteza", "link": "https://stackoverflow.com/users/1235144/morteza"}, "edited": false, "score": 0, "creation_date": 1429690076, "post_id": 29790423, "comment_id": 47711532, "body": "&quot;You know the both of them are working correctly. I want to use second one then I bring date int it: <code>INSERT INTO Report ( brand, Bag, Acc, Id , NameP, DATE)</code> Now I can use select for brand and bag and ... BUt I do want to set the date value from a variable&quot;"}, {"owner": {"reputation": 5125, "user_id": 2958272, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/0ocAT.jpg?s=128&g=1", "display_name": "sqluser", "link": "https://stackoverflow.com/users/2958272/sqluser"}, "reply_to_user": {"reputation": 344, "user_id": 1235144, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/503f770edf9315397dbc40b285775363?s=128&d=identicon&r=PG", "display_name": "Morteza", "link": "https://stackoverflow.com/users/1235144/morteza"}, "edited": false, "score": 0, "creation_date": 1429690556, "post_id": 29790423, "comment_id": 47711817, "body": "In this part <code>Select Top 1 * from</code>, instead of using *, put the aliases you are getting from your subquery and for date, use the variable you have"}], "tags": [], "owner": {"reputation": 5125, "user_id": 2958272, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/0ocAT.jpg?s=128&g=1", "display_name": "sqluser", "link": "https://stackoverflow.com/users/2958272/sqluser"}, "is_accepted": false, "score": 0, "last_activity_date": 1429688098, "last_edit_date": 1429688098, "creation_date": 1429687203, "answer_id": 29790423, "question_id": 29790112, "link": "https://stackoverflow.com/questions/29790112/how-can-i-merge-these-two-access-sql-queries/29790423#29790423", "title": "How Can I merge these two Access Sql queries", "body": "<p>Your query is not clear but your query should be something like this:</p>\n\n<pre><code>INSERT INTO Report (id, [date], namep , [NEXTC], [Nurse], brand, Bag, Acc, Id , NameP)\nSELECT TOP 1 'value1', 'value2', ..., FROM yourTable ...\n</code></pre>\n\n<p>Using <a href=\"http://www.w3schools.com/sql/sql_insert_into_select.asp\" rel=\"nofollow\">INSERT INTO SELECT</a></p>\n\n<p><code>value1</code>, <code>value2</code> could be statistic but also you can get some value from <code>yourtable</code></p>\n"}, {"tags": [], "owner": {"reputation": 757, "user_id": 3144631, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/898fa2f075c04e7b40d1480791d1e0c3?s=128&d=identicon&r=PG", "display_name": "Rahmani", "link": "https://stackoverflow.com/users/3144631/rahmani"}, "is_accepted": true, "score": 1, "last_activity_date": 1429695210, "creation_date": 1429695210, "answer_id": 29793356, "question_id": 29790112, "link": "https://stackoverflow.com/questions/29790112/how-can-i-merge-these-two-access-sql-queries/29793356#29793356", "title": "How Can I merge these two Access Sql queries", "body": "<p>Test this, it should work (maybe some parentheses be wrong, check it before use):</p>\n\n<pre><code>DoCmd.RunSQL \"insert into Report (id, [date], namep , [NEXTC], [Nurse], brand, Bag, Acc, Id , NameP)\" &amp; _\n\" values (\" &amp; Chr(34) &amp; x &amp; Chr(34) &amp; \" ,\" &amp; Chr(34) &amp; b &amp; Chr(34) &amp; \",\" &amp; \"5,\" &amp; _\n\" \" &amp; Chr(34) &amp; c &amp; Chr(34) &amp; \", \" &amp; Chr(34) &amp; n &amp; Chr(34) &amp; \", \" &amp; _\n\"(SELECT TOP 1 Brand FROM (SELECT * FROM Report WHERE ID=\" &amp; x &amp; _\n\") WHERE Brand IS NOT NULL ORDER BY date DESC Union All SELECT top 1 null FROM report WHERE Brand IS NULL) AS Brand \" &amp; \", \" &amp; _\n\"(SELECT TOP 1 Bag FROM (SELECT * FROM Report WHERE ID=\" &amp; x &amp; _\n\") WHERE Bag IS NOT NULL ORDER BY date DESC Union All SELECT top 1 null FROM report WHERE Bag IS NULL) AS Bag \" &amp; \", \" &amp; _\n\"(SELECT TOP 1 ACC FROM (SELECT * FROM Report WHERE ID=\" &amp; x &amp; _\n\") WHERE ACC IS NOT NULL ORDER BY date DESC Union All SELECT top 1 null FROM report WHERE ACC IS NULL) AS ACC \" &amp; \", \" &amp; _\n\"(SELECT TOP 1 ID FROM Report WHERE ID=\" &amp; x &amp; \") AS ID,\" &amp; _\n \"( SELECT TOP 1 NameP FROM Report WHERE ID=\" &amp; x &amp; \") as NameP )\"\n</code></pre>\n"}], "owner": {"reputation": 344, "user_id": 1235144, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/503f770edf9315397dbc40b285775363?s=128&d=identicon&r=PG", "display_name": "Morteza", "link": "https://stackoverflow.com/users/1235144/morteza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 29793356, "answer_count": 2, "score": 2, "last_activity_date": 1594644908, "creation_date": 1429686218, "last_edit_date": 1594644908, "question_id": 29790112, "link": "https://stackoverflow.com/questions/29790112/how-can-i-merge-these-two-access-sql-queries", "title": "How Can I merge these two Access Sql queries", "body": "<p>I want to merge these two queries into one query.\nHere are the codes.\nit's one table for both, but you see different data from different parts.\nJust I want to make one record with only one query.</p>\n\n<pre><code>&gt; DoCmd.RunSQL \"insert into Report (id, [date], namep , [NEXTC],\n&gt; [Nurse])\" &amp; _ \" values (\" &amp; Chr(34) &amp; x &amp; Chr(34) &amp; \" ,\" &amp; Chr(34) &amp; b\n&gt; &amp; Chr(34) &amp; \",\" &amp; \"5,\" &amp; _ \" \" &amp; Chr(34) &amp; c &amp; Chr(34) &amp; \", \" &amp;\n&gt; Chr(34) &amp; n &amp; Chr(34) &amp; \")\"\n</code></pre>\n\n<p>and this one</p>\n\n<pre><code>DoCmd.RunSQL \"INSERT INTO Report ( brand, Bag, Acc, Id , NameP)\" &amp; _\n\"Select Top 1 * from\" &amp; _\n    \"(SELECT TOP 1 Brand FROM (SELECT * FROM Report WHERE ID=\" &amp; _\n    x &amp; _\n    \") WHERE Brand IS NOT NULL ORDER BY date DESC Union All SELECT top 1 null FROM report WHERE Brand IS NULL) AS Brand,\" &amp; _\n    \"(SELECT TOP 1 Bag FROM (SELECT * FROM Report WHERE ID=\" &amp; _\n    x &amp; _\n    \") WHERE Bag IS NOT NULL ORDER BY date DESC Union All SELECT top 1 null FROM report WHERE Bag IS NULL) AS Bag,\" &amp; _\n    \"(SELECT TOP 1 ACC FROM (SELECT * FROM Report WHERE ID=\" &amp; _\n    x &amp; _\n    \") WHERE ACC IS NOT NULL ORDER BY date DESC Union All SELECT top 1 null FROM report WHERE ACC IS NULL) AS ACC,\" &amp; _\n \"(SELECT TOP 1 ID FROM Report WHERE ID=\" &amp; _\n x &amp; _\n \") AS ID,\" &amp; _\n \"( SELECT TOP 1 NameP FROM Report WHERE ID=\" &amp; _\n x &amp; _\n \") as NameP;\"\n</code></pre>\n"}, {"tags": ["excel", "vba", "login", "unspecified"], "comments": [{"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "edited": false, "score": 0, "creation_date": 1429693103, "post_id": 29790015, "comment_id": 47713599, "body": "I think the error lies in <code>wd.document.Title</code> because you are accessing a <code>.document</code> member. This is valid for <code>InternetExplorer</code> object, but I don&#39;t think it&#39;s valid for Shell Window."}, {"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "edited": false, "score": 0, "creation_date": 1429694386, "post_id": 29790015, "comment_id": 47714526, "body": "Can you do a <code>TypeName(wd.document.Title)</code>. I bet it is not a string nor nothing?"}, {"owner": {"reputation": 110, "user_id": 4810986, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205233566631456/picture?type=large", "display_name": "Justin Michael Chia", "link": "https://stackoverflow.com/users/4810986/justin-michael-chia"}, "edited": false, "score": 0, "creation_date": 1429710945, "post_id": 29790015, "comment_id": 47727667, "body": "if i were to step in line by line it works but when i run it, it just gets stuck at that error."}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 1, "creation_date": 1432613043, "post_id": 29790015, "comment_id": 48980048, "body": "Consider posting your solution so the next poor guy that has a hit on this page when he searches, doesn&#39;t pull his hair out because there is no solution. I&#39;m guessing your error handling may have obscured the error"}], "answers": [{"tags": [], "owner": {"reputation": 585, "user_id": 4460182, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1e75dc00dcb34d07bc66907235da9973?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/4460182/tom"}, "is_accepted": false, "score": 0, "last_activity_date": 1431488418, "creation_date": 1431488418, "answer_id": 30205253, "question_id": 29790015, "link": "https://stackoverflow.com/questions/29790015/keep-getting-run-time-error-vba/30205253#30205253", "title": "Keep getting run-time error VBA", "body": "<p>I have had an issue like this before, what I found was that VBA is trying to do an operation to an object before that object has been created or changed as the code would expect. Hence when stepping through the code work because it has ample time between steps to complete calculations.</p>\n"}], "owner": {"reputation": 110, "user_id": 4810986, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205233566631456/picture?type=large", "display_name": "Justin Michael Chia", "link": "https://stackoverflow.com/users/4810986/justin-michael-chia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 958, "favorite_count": 2, "answer_count": 1, "score": 4, "last_activity_date": 1432612594, "creation_date": 1429685915, "last_edit_date": 1432612594, "question_id": 29790015, "link": "https://stackoverflow.com/questions/29790015/keep-getting-run-time-error-vba", "title": "Keep getting run-time error VBA", "body": "<p>I am trying to get this to log into my website with a main login page and a second One Time Password(OTP) page. But i am getting and error</p>\n\n<p>run-time error '-2147467259 (80004005)':</p>\n\n<p>Automation error</p>\n\n<p>Unspecified error</p>\n\n<p>found at this line:  </p>\n\n<pre><code> If InStr(wd.document.Title, \"Sales Force Automation\") &lt;&gt; 0 Then\n</code></pre>\n\n<p>What am i doing wrong here? I am new to this language as i just started learning it 2 days ago.</p>\n\n<pre><code>Dim wd As SHDocVw.InternetExplorer\n\nSub login()\n    Dim username As Range\n    Dim password As Range\n    Dim otp As Range\n    Dim myValue As Variant\n\n    Set wd = CreateObject(\"InternetExplorer.Application\")\n    wd.silent = True\n    wd.navigate \"Http://www.XXXXXXXXXXX.com\"\n    wd.Visible = True\n\n    Set username = Range(\"B1\")\n    Set password = Range(\"B2\")\n\n    While wd.Busy\n        DoEvents\n    Wend\n\n    wd.document.all.UserId.Value = username\n    wd.document.all.password.Value = password\n\n    Application.Wait (Now + TimeValue(\"0:00:10\"))\n\n    wd.document.all.btnobj.Click\n\n    myValue = InputBox(\"Enter OTP\")\n    Range(\"B3\").Value = myValue\n\n\nErr_Clear:\n    If Err &lt;&gt; 0 Then\n        Err.Clear\n        Resume Next\n    End If\n\n    Call FindTicketWindow\nEnd Sub\n\nSub FindTicketWindow()\n    Dim otp As Range\n\n    For Each wd In CreateObject(\"Shell.Application\").Windows\n        If wd = \"Internet Explorer\" Then\n            If InStr(wd.document.Title, \"Sales Force Automation\") &lt;&gt; 0 Then\n                Application.Wait (Now + TimeValue(\"0:01:00\"))\n                Exit For\n            End If\n        End If\n    Next wd\n\n    Set otp = Range(\"B3\")\n\n    While wd.Busy\n        DoEvents\n    Wend\n\n    myVar = wd.document.Title\n\n    wd.document.all.verficationcode.Value = otp\n    Application.Wait (Now + TimeValue(\"0:00:10\"))\n    wd.document.all.btnobj.Click\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 4737658, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6d241c7a4fb7e84e38acda5d476fadfb?s=128&d=identicon&r=PG&f=1", "display_name": "Kunal", "link": "https://stackoverflow.com/users/4737658/kunal"}, "edited": false, "score": 0, "creation_date": 1429686756, "post_id": 29790022, "comment_id": 47709398, "body": "Hi Mike, thank you for this quick response. Adding a option to allow users to upload file is not the requirement. Requirement is that user should be able to select a bunch of rows from a spreadhseet and paste it in the form and if needed edit it."}], "tags": [], "owner": {"reputation": 407, "user_id": 4749636, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10206359356052702/picture?type=large", "display_name": "Mike Stratton", "link": "https://stackoverflow.com/users/4749636/mike-stratton"}, "is_accepted": false, "score": 1, "last_activity_date": 1429685936, "creation_date": 1429685936, "answer_id": 29790022, "question_id": 29789809, "link": "https://stackoverflow.com/questions/29789809/insert-a-spreadsheet-in-a-form-vb/29790022#29790022", "title": "Insert a spreadsheet in a form VB", "body": "<p>Create a class that allows the user to <a href=\"https://msdn.microsoft.com/en-us/library/w3kksch7.aspx\" rel=\"nofollow\">upload a file</a> (spreadsheet that has been saved in a .csv format) and then use the <a href=\"https://msdn.microsoft.com/en-us/library/cakac7e6.aspx\" rel=\"nofollow\">TextFieldParser object</a> to read the file. </p>\n"}, {"tags": [], "owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1429696304, "creation_date": 1429696304, "answer_id": 29793811, "question_id": 29789809, "link": "https://stackoverflow.com/questions/29789809/insert-a-spreadsheet-in-a-form-vb/29793811#29793811", "title": "Insert a spreadsheet in a form VB", "body": "<p>You could use a List box, however you will need to set the columns and the user will have to make sure they select only that amount of columns. Then have a paste button in the form which will take the clipboard and add it to the list box.</p>\n"}, {"tags": [], "owner": {"reputation": 63, "user_id": 4737658, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6d241c7a4fb7e84e38acda5d476fadfb?s=128&d=identicon&r=PG&f=1", "display_name": "Kunal", "link": "https://stackoverflow.com/users/4737658/kunal"}, "is_accepted": false, "score": 0, "last_activity_date": 1430147201, "creation_date": 1430147201, "answer_id": 29899375, "question_id": 29789809, "link": "https://stackoverflow.com/questions/29789809/insert-a-spreadsheet-in-a-form-vb/29899375#29899375", "title": "Insert a spreadsheet in a form VB", "body": "<p>I got it working using datasheet bound to a table.\nthanks for the help guys.</p>\n"}], "owner": {"reputation": 63, "user_id": 4737658, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6d241c7a4fb7e84e38acda5d476fadfb?s=128&d=identicon&r=PG&f=1", "display_name": "Kunal", "link": "https://stackoverflow.com/users/4737658/kunal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1430147201, "creation_date": 1429685347, "question_id": 29789809, "link": "https://stackoverflow.com/questions/29789809/insert-a-spreadsheet-in-a-form-vb", "title": "Insert a spreadsheet in a form VB", "body": "<p>I am trying to insert a spreadsheet like functionality in a form where user can copy a subset data from one spreadhseet and paste it in the spreadsheet in the form. \nI tried creating a datasheet form but I am unable to add anything to it. I also tried creating bunch of text boxes for representing columns but in this case I can only paste one row from spreadhseet to this form.</p>\n\n<p>Any help or pointer will be of great help.</p>\n"}, {"tags": ["vba", "excel", "powerpivot"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1429696786, "post_id": 29789772, "comment_id": 47716279, "body": "Which version of Excel?"}, {"owner": {"reputation": 72, "user_id": 4499291, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/870035ea548cd7986b9867bd817aaf9c?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Dahlen", "link": "https://stackoverflow.com/users/4499291/erik-dahlen"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1429696933, "post_id": 29789772, "comment_id": 47716375, "body": "excel 2013... (do it matter?)"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1429698205, "post_id": 29789772, "comment_id": 47717296, "body": "Yes - those steps don&#39;t work in 2010. :)"}, {"owner": {"reputation": 72, "user_id": 4499291, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/870035ea548cd7986b9867bd817aaf9c?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Dahlen", "link": "https://stackoverflow.com/users/4499291/erik-dahlen"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1429698631, "post_id": 29789772, "comment_id": 47717622, "body": "Ok, good to know :) but you don&#39;t know the answer to the question?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1429700503, "post_id": 29789772, "comment_id": 47719099, "body": "I don&#39;t have 2013 available here to test. If you do it manually, then in the immediate window enter: <code>?activesheet.listobjects(1).querytable.connection</code>, what output do you get?"}, {"owner": {"reputation": 72, "user_id": 4499291, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/870035ea548cd7986b9867bd817aaf9c?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Dahlen", "link": "https://stackoverflow.com/users/4499291/erik-dahlen"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1429701178, "post_id": 29789772, "comment_id": 47719590, "body": "Sry but I don&#39;t understand which &quot;immediate window&quot; I should enter it..."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1429701397, "post_id": 29789772, "comment_id": 47719749, "body": "Open the VB editor, press Ctrl+G (or View - Immediate Window) and paste the code in, then press Enter."}, {"owner": {"reputation": 72, "user_id": 4499291, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/870035ea548cd7986b9867bd817aaf9c?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Dahlen", "link": "https://stackoverflow.com/users/4499291/erik-dahlen"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1429701456, "post_id": 29789772, "comment_id": 47719796, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/75930/discussion-between-erik-dahlen-and-rory\">continue this discussion in chat</a>."}, {"owner": {"reputation": 5277, "user_id": 156648, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2dc62782d79a90b829e96f36f48fe164?s=128&d=identicon&r=PG", "display_name": "guitarthrower", "link": "https://stackoverflow.com/users/156648/guitarthrower"}, "edited": false, "score": 0, "creation_date": 1429717932, "post_id": 29789772, "comment_id": 47733460, "body": "that same link you provided gives an option to do the same thing using PowerQuery, which is available as a free add-in to Excel 2010."}, {"owner": {"reputation": 72, "user_id": 4499291, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/870035ea548cd7986b9867bd817aaf9c?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Dahlen", "link": "https://stackoverflow.com/users/4499291/erik-dahlen"}, "edited": false, "score": 0, "creation_date": 1429782563, "post_id": 29789772, "comment_id": 47766003, "body": "yes, I saw that, but is it easier do write a macro for PowerQuery to fetch data than for PowerPivot? And do you know how to do this?"}], "owner": {"reputation": 72, "user_id": 4499291, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/870035ea548cd7986b9867bd817aaf9c?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Dahlen", "link": "https://stackoverflow.com/users/4499291/erik-dahlen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1219, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1429698704, "creation_date": 1429685208, "last_edit_date": 1531164843, "question_id": 29789772, "link": "https://stackoverflow.com/questions/29789772/how-to-copy-the-powerpivot-data-into-the-excel-workbook-as-a-table-with-vba", "title": "How to copy the PowerPivot data into the Excel workbook as a table with VBA?", "body": "<p>I have found in another post how to copy PowerPivot data into an Excel 2013 workbook, <a href=\"https://stackoverflow.com/questions/25510224/how-do-you-copy-the-powerpivot-data-into-the-excel-workbook-as-a-table\">post</a>. But now I want to do the same thing as the answer but with a macro. (Unfortunately I can't leave a comment so I have to ask it as a new question.)</p>\n\n<p>What I want to do is done by the following steps:</p>\n\n<ol>\n<li>Select the <strong>Data tab</strong></li>\n<li>Select <strong>Existing connections</strong></li>\n<li>Choose the connection one wants.</li>\n<li>Press <strong>Ok</strong></li>\n<li>Press <strong>Table</strong> at the radio button option</li>\n<li>Choose a new sheet (you can choose to put it somewhere in an existing as well but not what i try to do here.)</li>\n<li>Press <strong>Ok</strong></li>\n</ol>\n\n<p>I can't record a macro while I do this, so do anyone know the VBA code to do this?</p>\n"}, {"tags": ["excel", "excel-2013", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1218, "user_id": 794000, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5971a89ddf93af266741f99c66f5a4d6?s=128&d=identicon&r=PG", "display_name": "IRHM", "link": "https://stackoverflow.com/users/794000/irhm"}, "edited": false, "score": 0, "creation_date": 1429686712, "post_id": 29789770, "comment_id": 47709368, "body": "Hi I&#39;ve been back to my code and changed this so the number increases, but I&#39;m still left with a white back gorund and the text. Kind Regards. Chris"}, {"owner": {"reputation": 1218, "user_id": 794000, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5971a89ddf93af266741f99c66f5a4d6?s=128&d=identicon&r=PG", "display_name": "IRHM", "link": "https://stackoverflow.com/users/794000/irhm"}, "edited": false, "score": 0, "creation_date": 1429687881, "post_id": 29789770, "comment_id": 47710173, "body": "Hi, thank you for coming back to me with this. I did actually make a note in my original post which said <i>The problem I have is that the progress bar doesn&#39;t move across the Status Bar....</i>, so I thought this encompassed the problem unless you think another post is still needed. Kind regards. Chris"}, {"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "reply_to_user": {"reputation": 1218, "user_id": 794000, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5971a89ddf93af266741f99c66f5a4d6?s=128&d=identicon&r=PG", "display_name": "IRHM", "link": "https://stackoverflow.com/users/794000/irhm"}, "edited": false, "score": 0, "creation_date": 1429688310, "post_id": 29789770, "comment_id": 47710468, "body": "I&#39;ve done my best to answer given the information you provided. Not clear what you mean by &quot;progress bar doesn&#39;t move&quot;."}, {"owner": {"reputation": 1218, "user_id": 794000, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5971a89ddf93af266741f99c66f5a4d6?s=128&d=identicon&r=PG", "display_name": "IRHM", "link": "https://stackoverflow.com/users/794000/irhm"}, "edited": false, "score": 0, "creation_date": 1429688363, "post_id": 29789770, "comment_id": 47710505, "body": "Hi, ok, I&#39;ll post another question and take from there. Kind Regards. Chris"}], "tags": [], "owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "is_accepted": true, "score": 1, "last_activity_date": 1429685980, "last_edit_date": 1429685980, "creation_date": 1429685199, "answer_id": 29789770, "question_id": 29789439, "link": "https://stackoverflow.com/questions/29789439/status-bar-progress-meter-not-showing-messages/29789770#29789770", "title": "Status Bar Progress Meter not showing messages", "body": "<p>The reason you don't see them is that they are immediately overwritten by the next <code>StatusBar</code> message. </p>\n\n<p>Take this for example:</p>\n\n<pre><code>   'Eigth Message\n   Application.StatusBar = String(5, ChrW(9609)) &amp; \"All Files Extracted...\"\n   'After the previous message has displayed for zero seconds, \n   'Relinquish the StatusBar\n   Application.StatusBar = False\n</code></pre>\n\n<p>You're displaying a message and erasing it right away. </p>\n\n<p>Same idea for your first message. The statements that occur in between probably execute in less than a millisecond, so that's how long your first message will show; hence you don't see it. Which, in a way, makes total sense, because there is no need for a progress meter to be displayed if progress is instantaneous. </p>\n\n<p>The example in the <a href=\"http://datapigtechnologies.com/blog/index.php/show-a-progress-meter-in-the-status-bar/\" rel=\"nofollow\">link you provide</a> uses <code>Application.Wait</code> statements to force the program to wait while the progress bare is being shown. But that's just for illustration purposes; you would never slow down your actual program on purpose like that. </p>\n\n<hr>\n\n<p>The reason the progress bar isn't getting longer and longer is that you are explicitly telling it to stay the same length:</p>\n\n<pre><code>String(5, ChrW(9609)) \n</code></pre>\n\n<p>will always return a progress bar that is five characters long: <code>\u2589\u2589\u2589\u2589\u2589</code>. The example in the <a href=\"http://datapigtechnologies.com/blog/index.php/show-a-progress-meter-in-the-status-bar/\" rel=\"nofollow\">link you provide</a> makes it grow from 5 to 10 to 15. </p>\n"}], "owner": {"reputation": 1218, "user_id": 794000, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5971a89ddf93af266741f99c66f5a4d6?s=128&d=identicon&r=PG", "display_name": "IRHM", "link": "https://stackoverflow.com/users/794000/irhm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1384, "favorite_count": 0, "accepted_answer_id": 29789770, "answer_count": 1, "score": 0, "last_activity_date": 1429685980, "creation_date": 1429684147, "last_edit_date": 1531164843, "question_id": 29789439, "link": "https://stackoverflow.com/questions/29789439/status-bar-progress-meter-not-showing-messages", "title": "Status Bar Progress Meter not showing messages", "body": "<p>I'm trying to put together a 'Status Bar Progress Meter' to help the user when loading a lengthy macro.</p>\n\n<p>I've carried out some research and found <a href=\"http://datapigtechnologies.com/blog/index.php/show-a-progress-meter-in-the-status-bar/\" rel=\"nofollow\">this</a> to be the type that I'd like to use.</p>\n\n<p>The problem I have is that the progress bar doesn't move across the Status Bar and the first and last messages i.e. \"Working\" and \"All Files Extracted\" are not shown. Where have I gone wrong?</p>\n\n<pre><code>Private Sub btnFetchFiles_Click()\n\n    Dim j As Integer\n\n        iRow = 20\n        fPath = \"\\\\c\\s\\CAF1\\Dragon Mentor Group\\Dragon Scripts\\Current\\April 2015\"\n        If fPath &lt;&gt; \"\" Then\n\n            ' make StatusBar visible\n            Application.DisplayStatusBar = True\n            Set FSO = New Scripting.FileSystemObject\n            'First Message\n            Application.StatusBar = String(5, ChrW(9609)) &amp; \" Working...\"\n            If FSO.FolderExists(fPath) &lt;&gt; False Then\n                'Second Message\n                Application.StatusBar = String(5, ChrW(9609)) &amp; \" Working...\"\n                Set SourceFolder = FSO.GetFolder(fPath)\n                'Third Message\n                Application.StatusBar = String(5, ChrW(9609)) &amp; \" Working...\"\n                IsSubFolder = True\n                'Fourth Message\n                Application.StatusBar = String(5, ChrW(9609)) &amp; \" Still Working...\"\n                Call DeleteRows\n                If AllFilesCheckBox.Value = True Then\n                'Fifth Message\n                Application.StatusBar = String(5, ChrW(9609)) &amp; \" Still Working...\"\n                    Call ListFilesInFolder(SourceFolder, IsSubFolder)\n                    Call ResultSorting(xlAscending, \"C20\")\n                    Call FormatCells\n                Else\n                    Call ListFilesInFolderXtn(SourceFolder, IsSubFolder)\n                    Call ResultSorting(xlAscending, \"C20\")\n                    Call FormatCells\n                End If\n                'Sixth Message\n                Application.StatusBar = String(5, ChrW(9609)) &amp; \"Still Working...\"\n                lblFCount.Caption = iRow - 20\n                'Seventh Message\n                Application.StatusBar = String(5, ChrW(9609)) &amp; \"Almost Done...\"\n            Else\n                MsgBox \"Selected Path Does Not Exist !!\" &amp; vbNewLine &amp; vbNewLine &amp; \"Select Correct One and Try Again !!\"\n            End If\n        Else\n            MsgBox \"Folder Path Can not be Empty !!\" &amp; vbNewLine &amp; vbNewLine &amp; \"\"\n        End If\n                'Eigth Message\n                Application.StatusBar = String(5, ChrW(9609)) &amp; \"All Files Extracted...\"\n       'Relinquish the StatusBar\n        Application.StatusBar = False\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "edited": false, "score": 0, "creation_date": 1429695587, "post_id": 29789328, "comment_id": 47715352, "body": "If you copy something, you should paste it, right?"}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1429704092, "post_id": 29789328, "comment_id": 47721868, "body": "If your first two sentences are true, then there is either a problem with the Excel file or with the Excel application. First I would try open the file and save it with new name and location. Then try copying sheets again in this new file. If it still does not work, then I would try a repair installation of the Excel application."}], "answers": [{"comments": [{"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 0, "creation_date": 1429700972, "post_id": 29793901, "comment_id": 47719424, "body": "the same error on <code>ThisWorkbook.Worksheets(&quot;Baza&quot;).Copy Before:=wBo.Sheets(1)</code>"}], "tags": [], "owner": {"reputation": 1300, "user_id": 3005534, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/giBVn.jpg?s=128&g=1", "display_name": "Miguel_Ryu", "link": "https://stackoverflow.com/users/3005534/miguel-ryu"}, "is_accepted": true, "score": 0, "last_activity_date": 1429696490, "creation_date": 1429696490, "answer_id": 29793901, "question_id": 29789328, "link": "https://stackoverflow.com/questions/29789328/excel-2013-cannot-copy-sheets/29793901#29793901", "title": "Excel 2013 cannot copy sheets", "body": "<p>Try defining the destination for the Copy method.</p>\n\n<pre><code>Sub TransEx()\nDim TemplatesFolder As String, FileName As String\n    TemplatesFolder = Replace(ThisWorkbook.FullName, ThisWorkbook.Name, \"\")\n    FileName = TemplatesFolder &amp; \"Transactions\" &amp; \".xlsx\"\n    If Len(Dir(FileName)) &lt;&gt; 0 Then Kill FileName\n\n    Set wbO = Workbooks.Add\n\n    ThisWorkbook.Worksheets(\"Baza\").Copy Before:=wbO.Sheets(1)\n\n\n    Application.ActiveWorkbook.SaveAs FileName, FileFormat:=51\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 391, "favorite_count": 0, "accepted_answer_id": 29793901, "answer_count": 1, "score": 1, "last_activity_date": 1429759822, "creation_date": 1429683812, "last_edit_date": 1429759822, "question_id": 29789328, "link": "https://stackoverflow.com/questions/29789328/excel-2013-cannot-copy-sheets", "title": "Excel 2013 cannot copy sheets", "body": "<p>When I try to copy sheet manually to new workbook, Excel do nothing<br>\nWhen I try to copy sheet manually to end of workbook, Excel makes empty new sheet.</p>\n\n<p>When I try to copy sheet with VBA:</p>\n\n<pre><code>Sub TransEx()\n    Dim TemplatesFolder As String, FileName As String\n    TemplatesFolder = Replace(ThisWorkbook.FullName, ThisWorkbook.Name, \"\")\n    FileName = TemplatesFolder &amp; \"Transactions\" &amp; \".xlsx\"\n    If Len(Dir(FileName)) &lt;&gt; 0 Then Kill FileName\n\n    ThisWorkbook.Worksheets(\"Baza\").Copy\n\n    Application.ActiveWorkbook.SaveAs FileName, FileFormat:=51\nEnd Sub\n</code></pre>\n\n<p>I got error  on <code>ThisWorkbook.Worksheets(\"Baza\").Copy</code></p>\n\n<blockquote>\n  <p>Run-time error '1004': copy method of worksheet class failed</p>\n</blockquote>\n\n<p>How to Fix that?</p>\n"}, {"tags": ["excel", "vba", "reference"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 4792075, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bb7b07d9097f67bcbc4eb5a5d887dc8c?s=128&d=identicon&r=PG&f=1", "display_name": "CorinneGermany", "link": "https://stackoverflow.com/users/4792075/corinnegermany"}, "edited": false, "score": 0, "creation_date": 1429684778, "post_id": 29788995, "comment_id": 47708229, "body": "Thank you that works fine.  Appreciate the explanation also to help for next time."}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": true, "score": 0, "last_activity_date": 1429682563, "creation_date": 1429682563, "answer_id": 29788995, "question_id": 29788694, "link": "https://stackoverflow.com/questions/29788694/using-named-cell-in-case-statment-to-end-autofilter-not-working/29788995#29788995", "title": "Using named cell in case statment to end autofilter not working", "body": "<p>If you are to compare the address and make a named range as reference, then you have to use the address of that range.</p>\n\n<pre><code>Case Range(\"NameOfRange\").Address\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 4792075, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bb7b07d9097f67bcbc4eb5a5d887dc8c?s=128&d=identicon&r=PG&f=1", "display_name": "CorinneGermany", "link": "https://stackoverflow.com/users/4792075/corinnegermany"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 29788995, "answer_count": 1, "score": 0, "last_activity_date": 1429682563, "creation_date": 1429681431, "question_id": 29788694, "link": "https://stackoverflow.com/questions/29788694/using-named-cell-in-case-statment-to-end-autofilter-not-working", "title": "Using named cell in case statment to end autofilter not working", "body": "<p>I want to use a cell defineds name rather the the actual cell reference (Case \"$L$75\") for the code to identify end of data for the Auto filter.  Currently just replacing the cell reference with the cell defined name errors.\nThe filter is not made available for the user to use which is why it is not just set up as a table.</p>\n\n<pre><code>Sub X_HideBlankRows_Angebot()\n\n ' ***** Hide Blank rows in Kosten Table\n\n ' x - Defined Cell Names ANKosten\n ' x                      ANKostenEndCell\n\nSheets(\"5_Angebot\").Select\n\nDim c As Range\nDim i As Integer\nDim rng As Range\nSet rng = Range(\"ANKosten\")        ' x\ni = rng.Cells(1, 1).Column - 1\n\nFor Each c In Range(\"ANKosten\")    ' x\n    Select Case c.Address\n    Case \"$L$75\"\n       c.AutoFilter Field:=c.Column - i, Criteria1:=\"inUse\", _\n         Visibledropdown:=False\n    Case Else\n       c.AutoFilter Field:=c.Column - i, _\n         Visibledropdown:=False\n End Select\nNext\n\nRange(\"B51\").Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1429675682, "post_id": 29787426, "comment_id": 47704586, "body": "Comment out the <code>On Error Resume Next</code> and run it again.  Are you getting any runtime errors?"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 3492483, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/100000133164252/picture?type=large", "display_name": "wamaral", "link": "https://stackoverflow.com/users/3492483/wamaral"}, "edited": false, "score": 0, "creation_date": 1429719368, "post_id": 29787935, "comment_id": 47734534, "body": "Didn&#39;t know UserInterfaceOnly:=True existed! Slapped that in the initialize workbook module and now it works like a charm! Thanks Comintern! And good info about hiding worksheets, I will keep that in mind going forward."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 0, "last_activity_date": 1429678460, "last_edit_date": 1429678460, "creation_date": 1429677945, "answer_id": 29787935, "question_id": 29787426, "link": "https://stackoverflow.com/questions/29787426/paste-after-unprotecting-worksheet-not-working/29787935#29787935", "title": "Paste after unprotecting worksheet not working", "body": "<p>The real answer to this is actually not to unprotect the Worksheet at all.  Protect it with a different password that <strong><em>isn't</em></strong> stored in the file anywhere, but set the parameter <code>UserInterfaceOnly:=True</code>.  This will allow the macro to make changes to the worksheet, and even if the user find the hidden sheet they won't be able to find the password.</p>\n\n<p>Speaking of hiding it, you should <strong><em>really</em></strong> hide it. As far as I know this is only possible through VBA, but you can set the Worksheet to <code>xlSheetVeryHidden</code>, either through the VBE...</p>\n\n<p><img src=\"https://i.stack.imgur.com/dV264.png\" alt=\"VBE hidden property\"></p>\n\n<p>...or in code:</p>\n\n<pre><code>Worksheets(\"Changes\").Visible = xlSheetVeryHidden\n</code></pre>\n\n<p>Then password protect the VBA project with the same password as the Worksheet, and nobody is going to find it but you unless they know the name of the sheet and manually type it into a cell formula:</p>\n\n<pre><code>=Changes!A1\n</code></pre>\n\n<p>If you want to avoid <strong><em>that</em></strong> possibility, just name the Worksheet something non-obvious or even total gibberish. The likelihood of an unsuspecting user typing this into a cell...</p>\n\n<pre><code>=kusidkeshlkiehas!A1\n</code></pre>\n\n<p>...is virtually zero.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5365848, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/78e1182a64bf411442b7d5dc8f484382?s=128&d=identicon&r=PG", "display_name": "Darrell Dixon", "link": "https://stackoverflow.com/users/5365848/darrell-dixon"}, "is_accepted": false, "score": 0, "last_activity_date": 1442975560, "creation_date": 1442975560, "answer_id": 32730039, "question_id": 29787426, "link": "https://stackoverflow.com/questions/29787426/paste-after-unprotecting-worksheet-not-working/32730039#32730039", "title": "Paste after unprotecting worksheet not working", "body": "<p>I have found that occasionally doing an Unprotect on the active sheet will change the active sheet to a different sheet. I haven\u2019t figured out under what circumstances this occurs or why the particular sheet that ends up selected gets selected. Could this be your problem? I solved this problem by having one routine that is called to do all Unprotects. In that routine I save the active sheet name before doing the Unprotect and then re-select the saved sheet. I haven't seen this problem with Protecting a sheet but just to be safeI have done the same thing with a Protect routine.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7098899, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/f1cc733e9fb0f8ff7cdd74186476fe39?s=128&d=identicon&r=PG", "display_name": "PN PAVANKUMAR", "link": "https://stackoverflow.com/users/7098899/pn-pavankumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1477991532, "creation_date": 1477991532, "answer_id": 40357024, "question_id": 29787426, "link": "https://stackoverflow.com/questions/29787426/paste-after-unprotecting-worksheet-not-working/40357024#40357024", "title": "Paste after unprotecting worksheet not working", "body": "<p>I tried to copy a range from one work book(selection.copy only once and keeping the workbook open) and through \"for loop\", to many other work books(ActiveSheet.Unprotect \"password\", ActiveSheet.Paste).</p>\n\n<p>This works fine during 1st trial but fails during subsequent trials on the same file with a message \"<strong>Error 1004 Paste Method of Worksheet Failed</strong>\" suggested by Mr Darrel Dixon and various other solutions of \"UserInterfaceOnly:=True\" etc but the error is repeating. The sheet appears UNPROTECTED at that stage and copy from source workbook and paste into destination workbook MANUALLY works fine but through VBA macro, it fails.</p>\n\n<p>Finally, I tried repeating \"selection.copy\" from source workbook after \"ActiveSheet.Unprotect\" on each destination workbook/each iteration of for loop.</p>\n\n<p>Even though this appears to be inefficient code, this alone solved the problem of PASTE failure after UNPROTECTING a worksheet.</p>\n"}], "owner": {"reputation": 27, "user_id": 3492483, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/100000133164252/picture?type=large", "display_name": "wamaral", "link": "https://stackoverflow.com/users/3492483/wamaral"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1589, "favorite_count": 0, "accepted_answer_id": 29787935, "answer_count": 3, "score": 0, "last_activity_date": 1477991532, "creation_date": 1429674720, "last_edit_date": 1442977601, "question_id": 29787426, "link": "https://stackoverflow.com/questions/29787426/paste-after-unprotecting-worksheet-not-working", "title": "Paste after unprotecting worksheet not working", "body": "<p>I have two sheets \"<code>Request</code>\" and \"<code>Changes</code>\" both protected by same password. Password has been stored as a constant in another module. I have tested this code when \"<code>Changes</code>\" sheet in unprotected and it works, however for some reason, if I have to unprotect the sheet before pasting it won't paste. </p>\n\n<p>I am simplifying trying to keep a record of what was deleted in the workbook by placing the info in a protected sheet \"<code>Changes</code>\" that is hidden.</p>\n\n<pre><code>Sub PODelete()\nDim rng As Range, ws As Worksheet, ws1 As Worksheet, lr As Integer\nSet ws = Sheets(\"Request\")\nSet ws1 = Sheets(\"Changes\")\nlr = ws1.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row 'Last non-blank row for column A\n\nOn Error Resume Next\nSet rng = Application.InputBox(\"Select a range\", Type:=8)\nIf Not rng Is Nothing Then\n    ' Checks to see if column A is selected\n    If rng.Cells.Column = 1 Then\n\n        ' Checks to see that only 1 cell is selected\n        If rng.Cells.Count &gt; 1 Then\n            MsgBox \"Select only one P.O. Number to remove\"\n        Else\n\n            ' Select entire row\n            rng.EntireRow.Copy\n            ' Activate sheet and pastes values\n            Sheets(\"Changes\").Activate\n            ws1.Unprotect Password:=worksheetpassword\n            Cells(lr, 1).EntireRow.Select\n            Selection.PasteSpecial Paste:=xlPasteValues\n\n            ws1.Protect Password:=worksheetpassword, DrawingObjects:=True, Contents:=True, Scenarios:=True\n            ' Deletes range\n            ws.Activate\n            ws.Unprotect Password:=worksheetpassword\n            rng.EntireRow.Delete\n            ws.Protect Password:=worksheetpassword, DrawingObjects:=True, Contents:=True, Scenarios:=True\n\n        End If\n    Else\n        MsgBox \"Select P.O. Number to remove\"\n    End If\n\nElse\n    Exit Sub\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Once again, if I run this macro with the \"<code>Changes</code>\" sheet unlocked it will work.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 4378838, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/3b613784f8f0a676212f967fdec23c5b?s=128&d=identicon&r=PG&f=1", "display_name": "pradeep", "link": "https://stackoverflow.com/users/4378838/pradeep"}, "edited": false, "score": 0, "creation_date": 1429758583, "post_id": 29812924, "comment_id": 47753606, "body": "I am able to send the correct data to sheet3, but i have having difficulty in setting color code for not found values. I am unable to change the color as per the logic."}], "tags": [], "owner": {"reputation": 5, "user_id": 4378838, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/3b613784f8f0a676212f967fdec23c5b?s=128&d=identicon&r=PG&f=1", "display_name": "pradeep", "link": "https://stackoverflow.com/users/4378838/pradeep"}, "is_accepted": false, "score": 0, "last_activity_date": 1429758426, "creation_date": 1429758426, "answer_id": 29812924, "question_id": 29787210, "link": "https://stackoverflow.com/questions/29787210/finding-cell-values-in-same-sheet-multiple-times-and-values-next-to-the-found-va/29812924#29812924", "title": "Finding cell values in same sheet multiple times and values next to the found values", "body": "<pre><code>    Option Explicit\nPrivate Sub FindingPortPwwn_Click()\n\nDim SourcePort As Range\nDim firstaddress As String\nDim i As Long, j As Long, N As Long\nDim counter As Integer\nDim WorkingSheet As Worksheet\n\n'Stopping Application Alerts\nApplication.DisplayAlerts = False\n\n'OR You can mention the Sheet name\nOn Error GoTo SheetNotFound:\nSheets(\"Final Results Sheet\").Delete\n\n'Creating a New Results Worksheet.\nThisWorkbook.Worksheets.Add(After:=Worksheets(\"Input_Worksheet\")).Name = \"Final Results Sheet\"\n\n\n\n'Enabling Application alerts once we are done with our task\nApplication.DisplayAlerts = True\n\n\n\n\nSet WorkingSheet = ActiveWorkbook.Worksheets(2)\nWorkingSheet.Activate\nN = WorkingSheet.Cells(Rows.Count, \"A\").End(xlUp).Row\n\n'MsgBox (N)\nFor i = 1 To N\n    'MsgBox (WorkingSheet.Cells(i, \"A\").Value)\n    'MsgBox (WorkingSheet.Cells(i, \"A\").Offset(0, 1).Value)\n  Set SourcePort = WorkingSheet.Cells.Find(WorkingSheet.Cells(i, \"A\").Value, WorkingSheet.Cells(i, \"A\"), LookIn:=xlValues)\n    'MsgBox (SourcePort.Address)\n    firstaddress = SourcePort.Address\n    Do\n    If (InStr(SourcePort.Value, \",\")) Then\n       If WorkingSheet.Cells(i, \"A\").Offset(0, 2).Value = SourcePort.Offset(0, 1).Value Then\n            ThisWorkbook.Worksheets(3).Cells(i, \"A\").Value = WorkingSheet.Cells(i, \"A\").Value\n            ThisWorkbook.Worksheets(3).Cells(i, \"A\").Offset(0, 2) = WorkingSheet.Cells(i, \"A\").Offset(0, 2).Value\n\n       Else\n            ThisWorkbook.Worksheets(3).Cells(i, \"A\").Value = WorkingSheet.Cells(i, \"A\").Value\n            ThisWorkbook.Worksheets(3).Cells(i, \"A\").Offset(0, 2).Value = WorkingSheet.Cells(i, \"A\").Offset(0, 2).Value\n            ThisWorkbook.Worksheets(3).Cells(i, \"A\").Offset(0, 2).Interior.Color = RGB(255, 126, 135)\n        End If\n\n\n    Else\n      If WorkingSheet.Cells(i, \"A\").Offset(0, 1).Value = SourcePort.Offset(0, 1).Value Then\n        ThisWorkbook.Worksheets(3).Cells(i, \"A\").Value = WorkingSheet.Cells(i, \"A\").Value\n        ThisWorkbook.Worksheets(3).Cells(i, \"A\").Offset(0, 1) = WorkingSheet.Cells(i, \"A\").Offset(0, 1).Value\n\n      Else\n        ThisWorkbook.Worksheets(3).Cells(i, \"A\").Value = WorkingSheet.Cells(i, \"A\").Value\n        ThisWorkbook.Worksheets(3).Cells(i, \"A\").Offset(0, 1).Value = WorkingSheet.Cells(i, \"A\").Offset(0, 1).Value\n        ThisWorkbook.Worksheets(3).Cells(i, \"A\").Offset(0, 1).Interior.Color = RGB(255, 0, 0)\n      End If\n    End If\n\n    Set SourcePort = WorkingSheet.Cells.FindNext(SourcePort)\n    Loop While Not SourcePort Is Nothing And firstaddress &lt;&gt; SourcePort.Address\n    MsgBox (SourcePort.Value)  \nNext i\n    Exit Sub\n    SheetNotFound:\n      MsgBox (\" Final Results Worksheet not Found\")\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 4378838, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/3b613784f8f0a676212f967fdec23c5b?s=128&d=identicon&r=PG&f=1", "display_name": "pradeep", "link": "https://stackoverflow.com/users/4378838/pradeep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 152, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1457547450, "creation_date": 1429673518, "last_edit_date": 1531164843, "question_id": 29787210, "link": "https://stackoverflow.com/questions/29787210/finding-cell-values-in-same-sheet-multiple-times-and-values-next-to-the-found-va", "title": "Finding cell values in same sheet multiple times and values next to the found values", "body": "<pre><code>Source Port #   Source Port Description Source port Pwwn            Switch Port     Switch Port Description Flolgi port Flogi pwwn\nfc1/1   Test_port_description_1 21:00:00:00:12:34:56:78         fc1/1   Test_port_description_1     \nfc1/2   Test_port_description_2 21:00:00:00:12:34:56:79         fc1/2   Test_port_description_2 fc1/0,abde  21:00:00:00:12:34:56:78\nfc1/3   Test_port_description_3 21:00:00:00:12:34:56:80         fc1/3   Test_port_description   fc1/2,abde  21:00:00:00:12:34:56:79\nfc1/4   Test_port_description_4 21:00:00:00:12:34:56:81         fc1/4   Test_port_description_4 fc1/1,abde  21:00:00:00:12:34:56:80\nfc1/5   Test_port_description_5 21:00:00:00:12:34:56:82         fc1/5   Test_port_description_5 fc1/4,abde  21:00:00:00:12:34:56:81\n                            fc1/5,abde  21:00:00:00:12:34:56:82\n</code></pre>\n\n<p>Here is a sample of the data in my input file. I have an Excel sheet with a command button, and clicking it will activate sheet2 which has my input. </p>\n\n<p>Column A is my source. I want to check each element in that column (A1, A2, etc.) and check if it is found in the sheet. If it is found, I then need to check select next cell value and compare it with next cell value found. If they both are same then both A2,B2 values should be copied to sheet3.<br>\nI have to search again in sheet2 and see if it is found then this time I need to check 2 cells to the right of the current element, with the element. Copy them to sheet3.</p>\n\n<p>For example.<br>\nA2=fc1/1,B2=Test_port_description_1,c2=21:00:00:00:12:34:56:7<br>\nFirst I want select A2 value and try to find it in sheet.<br>\nWhen find A2=fc1/1 is found in f2=fc1/1 now I need to check if \nB2 value is equal to G2 value. If both of them are same copy both A2 and B2 values to sheet3.</p>\n\n<p>Again I want to continue search A2=fc1/1 is found H5=fc1/1,abde. Now I need to check if C2=21:00:00:00:12:34:56:78 is same as H6=21:00:00:00:12:34:56:78 if same then copy the values C3 next column where values are found, if not found give color coding to the cells.. like red for second column and yellow for 3column in sheet 3...</p>\n"}, {"tags": ["vba", "loops", "ms-word"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1429672467, "post_id": 29786971, "comment_id": 47703731, "body": "Do the templateX.docx and and spoolX.txt always correspond to each other, or do you need to check all combinations? Is it working otherwise?"}, {"owner": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1429672843, "post_id": 29786971, "comment_id": 47703828, "body": "Yes, they do correspond to each other. I need templateX to be compared with spoolX, templateY with spoolY for example. The macro I have now only compairs a pair of documents, I need a loop to run through the whole folder."}, {"owner": {"reputation": 15122, "user_id": 4519059, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/MBHID.png?s=128&g=1", "display_name": "shA.t", "link": "https://stackoverflow.com/users/4519059/sha-t"}, "edited": false, "score": 0, "creation_date": 1429699025, "post_id": 29786971, "comment_id": 47717916, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/29767537/loop-comparison-macro\">Loop comparison macro</a>"}], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "edited": false, "score": 0, "creation_date": 1429675027, "post_id": 29787255, "comment_id": 47704368, "body": "sorry to ask, but is spool* supposed to remain that way? Also templ should be changed back to template right? I&#39;m very new to this so i apologize if I&#39;m asking obvious questions.. The line of code starting from Application.Compare documents has an error when i change templ back to template."}, {"owner": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "edited": false, "score": 0, "creation_date": 1429675098, "post_id": 29787255, "comment_id": 47704392, "body": "Also, i changed Dim template_doc As Word.Document to Dim template_doc As Documents. Likewise for the spool one, as the spool files are actually .txt files. Does that affect anything? Thanks so much for your help, Comintern!"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "edited": false, "score": 0, "creation_date": 1429675126, "post_id": 29787255, "comment_id": 47704402, "body": "@JunJie - Yes.  It&#39;s exactly like typing <code>Dir spool*.txt</code> in a console window.  <code>templ</code> is the name of the variable that the matching file name goes in."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "edited": false, "score": 0, "creation_date": 1429675251, "post_id": 29787255, "comment_id": 47704447, "body": "@JunJie - You need to leave the <code>As Document</code> as is.  Document is the type of object for the variable.  The only thing you should change from the code posted above is to replace the <code>&quot;D:\\...\\ComparisonTool\\&quot;</code> with the original <code>&quot;D:\\Users\\tmp4jj\\Desktop\\ComparisonTool\\&quot;</code>."}, {"owner": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "edited": false, "score": 0, "creation_date": 1429675712, "post_id": 29787255, "comment_id": 47704597, "body": "Theres an error as it reads the template files as a .txt file. Only the spool files are in .txt and the template ones are in .docx. The error lies in this line: &quot;Set template_doc = Documents.Open(&quot;D:\\Users\\tmp4jj\\Desktop\\ComparisonTool\\&quot; &amp; templ)&quot; is there any way to fix this??"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "edited": false, "score": 0, "creation_date": 1429676015, "post_id": 29787255, "comment_id": 47704697, "body": "@JunJie - Does it give you an error, or just not do anything?"}, {"owner": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "edited": false, "score": 0, "creation_date": 1429676264, "post_id": 29787255, "comment_id": 47704786, "body": "It&#39;s an error, sorry for the confusion, I missed out a word earlier and thought the code wasn&#39;t working at all. It&#39;s a run-time error 5174 where the specified file can&#39;t be found. The code is searching for template1.txt but my template files are all in docx."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "edited": false, "score": 0, "creation_date": 1429676546, "post_id": 29787255, "comment_id": 47704866, "body": "@JunJie - Doh!  I totally missed the different file extensions.  See the edit."}, {"owner": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "edited": false, "score": 0, "creation_date": 1429682179, "post_id": 29787255, "comment_id": 47706894, "body": "Great its working! Thanks a bunch! One more question, do you know how to save the compared results automatically in a pre-designated folder? What happens now is that the compared files are opened in a new Word document. Is it possible to set a destination for it to be saved automatically?"}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 0, "last_activity_date": 1429676518, "last_edit_date": 1429676518, "creation_date": 1429673764, "answer_id": 29787255, "question_id": 29786971, "link": "https://stackoverflow.com/questions/29786971/vba-loop-for-calling-files-in-a-folder/29787255#29787255", "title": "VBA loop for calling files in a folder", "body": "<p>If the filenames always correspond, you can use the Dir$() function with a wildcard to find one or the other of the pair, then build the other filename out of the result.  Dir$() returns the next result on subsequent calls, and then an empty String when all the files have been returned.  This makes it easy to build a loop around:</p>\n\n<pre><code>ChangeFileOpenDirectory \"D:\\...\\ComparisonTool\\\"\nDim template_doc As Word.Document\nDim spool_doc As Word.Document\n\nDim spool As String\nDim templ As String\nspool = Dir$(\"D:\\...\\ComparisonTool\\spool*.txt\")\nDo While spool &lt;&gt; vbNullString\n    templ = \"template\" &amp; Left$(Left$(Right$(spool, Len(spool) - 5), _\n            Len(spool) - 4), Len(spool) - 9) &amp; \".docx\"\n    Set template_doc = Documents.Open(\"D:\\...\\ComparisonTool\\\" &amp; templ)\n    Set spool_doc = Documents.Open(\"D:\\...\\ComparisonTool\\\" &amp; spool)\n\n    Application.CompareDocuments OriginalDocument:=Documents(templ) _\n        , RevisedDocument:=Documents(spool), Destination:= _\n        wdCompareDestinationNew, Granularity:=wdGranularityWordLevel, _\n        CompareFormatting:=False, CompareCaseChanges:=True, _\n        CompareWhitespace:=False, CompareTables:=True, CompareHeaders:=True, _\n        CompareFootnotes:=True, CompareTextboxes:=True, CompareFields:=True, _\n        CompareComments:=True, CompareMoves:=False, RevisedAuthor:=\"UOB\", _\n        IgnoreAllComparisonWarnings:=False\n\n    spool = Dir$\nLoop\n</code></pre>\n\n<p>NOTE: I shortened the directory names to get rid of the side scrolling - you'll need to replace them with the actual directory path.</p>\n"}], "owner": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 200, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429691843, "creation_date": 1429671868, "last_edit_date": 1429691843, "question_id": 29786971, "link": "https://stackoverflow.com/questions/29786971/vba-loop-for-calling-files-in-a-folder", "title": "VBA loop for calling files in a folder", "body": "<p>I'm trying to create a macro which compares text files. However, I need a loop to compare all the files within a folder.</p>\n\n<p>The macro I have now only compares between template1 and spool1 for example.\nI need a loop that compares template1 with spool1.. template2 with spool2 etc. Any idea on how to do so? </p>\n\n<p>I think I have to add the files into a collection first and then call it.. I'm not sure though.</p>\n\n<p>Here's my codes</p>\n\n<pre><code>ChangeFileOpenDirectory \"D:\\Users\\tmp4jj\\Desktop\\ComparisonTool\\\"\nDim template1 As Word.Document\nDim spool1 As Word.Document\nSet template1 = Documents.Open(\"D:\\Users\\tmp4jj\\Desktop\\ComparisonTool\\template1.docx\")\nSet spool1 = Documents.Open(\"D:\\Users\\tmp4jj\\Desktop\\ComparisonTool\\spool1.txt\")\n\nApplication.CompareDocuments OriginalDocument:=Documents(\"template1.docx\") _\n    , RevisedDocument:=Documents(\"spool1.txt\"), Destination:= _\n    wdCompareDestinationNew, Granularity:=wdGranularityWordLevel, _\n    CompareFormatting:=False, CompareCaseChanges:=True, CompareWhitespace:= _\n    False, CompareTables:=True, CompareHeaders:=True, CompareFootnotes:=True, _\n     CompareTextboxes:=True, CompareFields:=True, CompareComments:=True, _\n    CompareMoves:=False, RevisedAuthor:=\"UOB\", IgnoreAllComparisonWarnings:= _\n    False\n</code></pre>\n\n<p>Thanks in advance as I'm very new to coding!</p>\n"}, {"tags": ["excel", "oracle11g", "ado", "vba"], "answers": [{"tags": [], "owner": {"reputation": 123, "user_id": 6370467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9778aeec18a9b296a9f8c4da6cc9041?s=128&d=identicon&r=PG&f=1", "display_name": "V. Wolf", "link": "https://stackoverflow.com/users/6370467/v-wolf"}, "is_accepted": false, "score": 0, "last_activity_date": 1469456932, "creation_date": 1469456932, "answer_id": 38570468, "question_id": 29786583, "link": "https://stackoverflow.com/questions/29786583/microsoftodbc-driver-managerdata-source-name-not-found-and-no-default-driver/38570468#38570468", "title": "[Microsoft][ODBC Driver Manager]Data source name not found and no default driver specified", "body": "<p>I think you need to set up the <strong>user</strong> <strong>DSN</strong> via <em>ODBC Data Source Admin (32 bit/64 bit)</em>. Also be sure that your colleague's PC has all drivers you need to run the code.</p>\n\n<p>Cheers.</p>\n"}], "owner": {"reputation": 213, "user_id": 853779, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/735dfabd3d1c16fcca1face6a8e20a18?s=128&d=identicon&r=PG", "display_name": "Zhe Xin", "link": "https://stackoverflow.com/users/853779/zhe-xin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2114, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1469456932, "creation_date": 1429669180, "last_edit_date": 1531164843, "question_id": 29786583, "link": "https://stackoverflow.com/questions/29786583/microsoftodbc-driver-managerdata-source-name-not-found-and-no-default-driver", "title": "[Microsoft][ODBC Driver Manager]Data source name not found and no default driver specified", "body": "<p>I write some VBA code in my spreadsheet in excel 2013, the code will connect Oracle 11g to write some data into it. I use following code to connect remote Oracle server:    </p>\n\n<pre><code>Private Function open_DB(tnsInfo As String, userName As String, pwd As String) As ADODB.Connection\n    Dim conn As ADODB.Connection\n    Dim connStr As String\n    Dim tnsInfoArr As Variant\n\n    tnsInfoArr = getTnsProperty(tnsInfo, \";\")\n\n    On Error GoTo Error_Handling\n    Set conn = New ADODB.Connection\n    'connStr =\n    connStr = \"Driver={Microsoft ODBC for Oracle}; \" &amp; _\n                 \"CONNECTSTRING=(DESCRIPTION=\" &amp; _\n                 \"(ADDRESS=(PROTOCOL=TCP)\" &amp; _\n                 \"(HOST=\" &amp; tnsInfoArr(1) &amp; \")(PORT=\" &amp; tnsInfoArr(2) &amp; \"))\" &amp; _\n                 \"(CONNECT_DATA=(SERVICE_NAME=\" &amp; tnsInfoArr(0) &amp; \"))); uid=\" &amp; userName &amp; \" ;pwd=\" &amp; pwd &amp; \";\"\n    conn.ConnectionString = connStr\n    conn.CursorLocation = adUseClient\n    conn.Open\n    conn.CommandTimeout = 120\n    If conn.State = adStateOpen Then\n        'MsgBox \"connect to Oracle successfully\"\n        'conn.Close\n    End If\n    Set open_DB = conn\nEnd Function   \n</code></pre>\n\n<p>this code works fine in my computer but it doesn't work in my colleague's PC, following error messages displayed in my colleague's machine:<br>\n[Microsoft][ODBC Driver Manager]Data source name not found and no default driver specified<br>\nADO error #:-2147467259<br>\n...<br>\ndo my colleague need some configuration on his PC? but I remember that I have not configure something in my own computer.<br>\ncan anybody tell me how to solve this problem?<br>\nMy OS version is 64-bit windows 7 enterprise edition SP1\nand I use MS Office 2013 64-bit edition.</p>\n"}, {"tags": ["php", "vba", "ms-word"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user557846"}, "edited": false, "score": 0, "creation_date": 1429666478, "post_id": 29786183, "comment_id": 47702120, "body": "why not create the document formated in the first place?"}, {"owner": {"reputation": 95, "user_id": 3634933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33af293d64cbf195482c0b163d12e404?s=128&d=identicon&r=PG&f=1", "display_name": "user3634933", "link": "https://stackoverflow.com/users/3634933/user3634933"}, "edited": false, "score": 0, "creation_date": 1429666541, "post_id": 29786183, "comment_id": 47702145, "body": "it downloads data from a SQL database and then the values are put onto the word document and it is not formatted the way i want it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user557846"}, "edited": false, "score": 0, "creation_date": 1429666617, "post_id": 29786183, "comment_id": 47702165, "body": "so um so the formatting how you want it then"}, {"owner": {"reputation": 95, "user_id": 3634933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33af293d64cbf195482c0b163d12e404?s=128&d=identicon&r=PG&f=1", "display_name": "user3634933", "link": "https://stackoverflow.com/users/3634933/user3634933"}, "edited": false, "score": 0, "creation_date": 1429666758, "post_id": 29786183, "comment_id": 47702204, "body": "different font, different color, and add paragraph spacing. i suppose its not really a big deal if they have to do it themselves, but i thought i would look into it because i was curious and so far have found nothing"}, {"owner": {"user_type": "does_not_exist", "display_name": "user557846"}, "edited": false, "score": 0, "creation_date": 1429666788, "post_id": 29786183, "comment_id": 47702212, "body": "you can do it when you create the file, seems like that&#39;s the right time to do it."}, {"owner": {"reputation": 95, "user_id": 3634933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33af293d64cbf195482c0b163d12e404?s=128&d=identicon&r=PG&f=1", "display_name": "user3634933", "link": "https://stackoverflow.com/users/3634933/user3634933"}, "edited": false, "score": 0, "creation_date": 1429666850, "post_id": 29786183, "comment_id": 47702229, "body": "Cheers, I will look into formatting it at that point."}], "owner": {"reputation": 95, "user_id": 3634933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33af293d64cbf195482c0b163d12e404?s=128&d=identicon&r=PG&f=1", "display_name": "user3634933", "link": "https://stackoverflow.com/users/3634933/user3634933"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 498, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594069679, "creation_date": 1429666383, "last_edit_date": 1594069679, "question_id": 29786183, "link": "https://stackoverflow.com/questions/29786183/automatically-format-a-word-document-php-word-macros", "title": "automatically format a word document PHP, word Macros", "body": "<p>I have an idea that I am unsure of it being plausible. I have a script that creates a word document that is not formatted at all, what i want to do is have it automatically formatted or a one click solution so that the user doesn't have to waste time formatting it. <br><br>\nMy approach is I want a macro to follow the created document so that whoever downloads the document also gets the macro and they can just click the macro to format the document.</p>\n\n<p>here is my word macro</p>\n\n<pre><code>Sub FormatText()\n'\n' FormatText Macro\n'\n'\nSelection.WholeStory\nSelection.Font.Name = \"Trebuchet MS\"\nSelection.Font.Size = 10\nWith Selection.ParagraphFormat\n    .LeftIndent = CentimetersToPoints(0)\n    .RightIndent = CentimetersToPoints(0)\n    .SpaceBefore = 0\n    .SpaceBeforeAuto = False\n    .SpaceAfter = 5\n    .SpaceAfterAuto = True\n    .LineSpacingRule = wdLineSpaceSingle\n    .Alignment = wdAlignParagraphLeft\n    .WidowControl = True\n    .KeepWithNext = False\n    .KeepTogether = False\n    .PageBreakBefore = False\n    .NoLineNumber = False\n    .Hyphenation = True\n    .FirstLineIndent = CentimetersToPoints(0)\n    .OutlineLevel = wdOutlineLevelBodyText\n    .CharacterUnitLeftIndent = 0\n    .CharacterUnitRightIndent = 0\n    .CharacterUnitFirstLineIndent = 0\n    .LineUnitBefore = 0\n    .LineUnitAfter = 0\n    .MirrorIndents = False\n    .TextboxTightWrap = wdTightNone\nEnd With\nSelection.Font.Color = 4214888\nEnd Sub\n</code></pre>\n\n<p>and here is the php script that creates the document.</p>\n\n<pre><code>&lt;?php \nfunction createDoc() {\n$information = \"\";\nforeach ($_POST['docText'] as  $value) {\n    $information .= $value; \n}\n\n$file = \"ProposalCredentials.doc\";\nfile_put_contents($file, $information, LOCK_EX);\n}\n\nfunction download() {\n\n$file = 'ProposalCredentials.doc';\nheader('Content-type: application/msword');\nheader('Content-length: ' .filesize($file));\nheader('Content-Disposition: attachment; filename='.$file);\nreadfile($file);\n}\n\ncreateDoc();\ndownload();\n\n?&gt;\n</code></pre>\n\n<p>Can this type of thing be done?<br>\nIs this the right path to be heading?<br>\nOr should I be focusing on the headers and formatting there?<br>\nOr should I focus on the variable $information and format it there?<br>\nOr do I have to get each user to create the macro on there computer?(trying to avoid this)</p>\n\n<p>A push in the right direction would be greatly appreciated.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1429667481, "post_id": 29786172, "comment_id": 47702377, "body": "You screen shot is not very informative. As for your code, it has many issues. Please post a better screen shot and the actual result you need."}], "answers": [{"comments": [{"owner": {"reputation": 333, "user_id": 3713336, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6425c70806faa65b4a79711c38b0edd6?s=128&d=identicon&r=PG&f=1", "display_name": "user3713336", "link": "https://stackoverflow.com/users/3713336/user3713336"}, "edited": false, "score": 0, "creation_date": 1429758127, "post_id": 29787032, "comment_id": 47753468, "body": "@Comintem thanks working fine but can you explain me second line please what does -1 and are you starting from 0 or 1 i see the dashes but where is the start point"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 333, "user_id": 3713336, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6425c70806faa65b4a79711c38b0edd6?s=128&d=identicon&r=PG&f=1", "display_name": "user3713336", "link": "https://stackoverflow.com/users/3713336/user3713336"}, "edited": false, "score": 0, "creation_date": 1429790773, "post_id": 29787032, "comment_id": 47772019, "body": "@user3713336 - InStr is 1 based, so the first parameter is to start from the first character in the cell.  It returns the position of what you are searching, so to get a count of characters up to that point you have to subtract 1. For example, <code>xxxx-xxxx</code> would return 5 because &#39;-&#39; is the 5th character."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 1, "last_activity_date": 1429672302, "last_edit_date": 1495540624, "creation_date": 1429672302, "answer_id": 29787032, "question_id": 29786172, "link": "https://stackoverflow.com/questions/29786172/count-characters-between-two-empty-space-to-dashes-in-vba/29787032#29787032", "title": "Count characters between two empty space to dashes() in vba", "body": "<p>The code posted has multiple issues:</p>\n\n<ol>\n<li><code>Worksheet</code> is not a valid object - you need to use <code>Worksheets</code>.</li>\n<li><code>.len</code> is not a property of a Range object.</li>\n<li>Even in <code>.len</code> was a property of a Range, you would need a\nde-reference operator (aka '.') in here: <code>Range(\"A\"&amp;x)len(Left,\"-\")</code></li>\n<li>If you intend to use the function <code>Len()</code>, it only takes one argument.</li>\n<li>You apparently are trying to loop, but you need to use either a For\nor For Each loop - it won't loop automatically when you increment x\nat the bottom of the sub.</li>\n<li><code>Right</code> is a function, but you're calling it without arguments and they are not optional.</li>\n<li>Similarly, <code>Left</code> is a function, but you're also calling it without\nthe required arguments.</li>\n<li><code>totallen</code> is not declared anywhere, so <code>Len(totallen)</code> will assume\nthat totallen is a Variant (default for undeclared variables), then\ncast it to a String, and then always return 0 because it has never\nbeen given a value.</li>\n<li>Anything else I may have missed.</li>\n</ol>\n\n<p>The solution is to use the <a href=\"https://msdn.microsoft.com/en-us/library/8460tsh1%28v=vs.90%29.aspx\" rel=\"nofollow noreferrer\">InStr function</a>.  It returns the location in a string of a given sub-string.</p>\n\n<pre><code>Sub xn()\n\n    Dim x As Long\n    Dim sheet As Worksheet\n\n    Set sheet = ActiveWorkbook.Worksheets(\"Sheet1\")\n    For x = 1 To sheet.Range(\"A\" &amp; sheet.Rows.Count).End(xlUp).Row\n        sheet.Cells(x, 2) = InStr(1, sheet.Cells(x, 1), \"-\") - 1\n    Next x\n\nEnd Sub\n</code></pre>\n\n<p>I'd also recommend taking a look at the MSDN article on <a href=\"https://msdn.microsoft.com/en-us/library/aa221353%28v=office.11%29.aspx\" rel=\"nofollow noreferrer\">Looping Through a Range of Cells</a> (2003 vintage, but still valid), and <a href=\"https://stackoverflow.com/questions/11169445/error-finding-last-used-cell-in-vba\">Error Finding Last Used cell In VBA</a>.</p>\n"}], "owner": {"reputation": 333, "user_id": 3713336, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6425c70806faa65b4a79711c38b0edd6?s=128&d=identicon&r=PG&f=1", "display_name": "user3713336", "link": "https://stackoverflow.com/users/3713336/user3713336"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 29787032, "answer_count": 1, "score": 0, "last_activity_date": 1429672302, "creation_date": 1429666281, "last_edit_date": 1429667400, "question_id": 29786172, "link": "https://stackoverflow.com/questions/29786172/count-characters-between-two-empty-space-to-dashes-in-vba", "title": "Count characters between two empty space to dashes() in vba", "body": "<p>How do I get the length of character between beginning with space and ending with * Here is the image. Column B shows the total len before dasher(-) and my code</p>\n\n<p><img src=\"https://i.stack.imgur.com/Zq71C.png\" alt=\"enter image description here\"></p>\n\n<pre><code>Sub xn()\n    Dim x As Integer\n    x = 1\n    If Worksheet(\"Sheet1\").Range(\"A\"&amp; x).len(Right,\" \") Or _\n    Worksheet(\"Sheet1\").Range(\"A\"&amp;x)len(Left,\"-\") Then\n        len(totallen)\n    End If\n    x = x + 1\nEnd Sub\n</code></pre>\n"}, {"tags": ["c#", "excel", "vba"], "comments": [{"owner": {"reputation": 1399, "user_id": 4527057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a5947a7625a180577e321ead1c56769?s=128&d=identicon&r=PG&f=1", "display_name": "lloyd", "link": "https://stackoverflow.com/users/4527057/lloyd"}, "edited": false, "score": 1, "creation_date": 1429663612, "post_id": 29785380, "comment_id": 47701250, "body": "have you tried to <a href=\"http://www.vbaexpress.com/forum/showthread.php?16786-Bug-in-Run-Application-Excel-2003-dash-in-filename\" rel=\"nofollow noreferrer\">wrap the hypen workbook in single quotes</a>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1429663652, "post_id": 29785380, "comment_id": 47701271, "body": "<a href=\"http://www.rondebruin.nl/win/s9/win001.htm\" rel=\"nofollow noreferrer\">rondebruin.nl/win/s9/win001.htm</a>  Always safer to quote the workbook name..."}], "answers": [{"tags": [], "owner": {"reputation": 1399, "user_id": 4527057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a5947a7625a180577e321ead1c56769?s=128&d=identicon&r=PG&f=1", "display_name": "lloyd", "link": "https://stackoverflow.com/users/4527057/lloyd"}, "is_accepted": true, "score": 4, "last_activity_date": 1429663659, "creation_date": 1429663659, "answer_id": 29785768, "question_id": 29785380, "link": "https://stackoverflow.com/questions/29785380/running-excel-macro-in-a-specific-workbook-fails-from-c/29785768#29785768", "title": "Running Excel macro in a specific workbook fails from C#", "body": "<p>Wrap the workbook name in <a href=\"http://www.vbaexpress.com/forum/showthread.php?16786-Bug-in-Run-Application-Excel-2003-dash-in-filename\" rel=\"nofollow\">quotes</a></p>\n\n<pre><code>string macro = string.Format(\"'{0}'!{1}\", workbook.Name, macroName);\nApplication.Run(macro);\n</code></pre>\n"}], "owner": {"reputation": 1836, "user_id": 1414258, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/wXqjQ.jpg?s=128&g=1", "display_name": "stuzor", "link": "https://stackoverflow.com/users/1414258/stuzor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1035, "favorite_count": 1, "accepted_answer_id": 29785768, "answer_count": 1, "score": 4, "last_activity_date": 1429669023, "creation_date": 1429661343, "last_edit_date": 1429669023, "question_id": 29785380, "link": "https://stackoverflow.com/questions/29785380/running-excel-macro-in-a-specific-workbook-fails-from-c", "title": "Running Excel macro in a specific workbook fails from C#", "body": "<p>I'm trying to run a macro in an Excel workbook from C# using the standard Microsoft.Office.Interop.Excel library. In my scenario the version of Excel could be either 2010 or 2013. </p>\n\n<p>There could be multiple workbooks open for the same Application object, each potentially with the same macro names, so I'm explicitly passing in the workbook name</p>\n\n<pre><code>string macro = string.Format(\"{0}!{1}\", workbook.Name, macroName);\nApplication.Run(macro);\n</code></pre>\n\n<p>Weirdly, I get a COMException if the workbook name has hyphens in it:</p>\n\n<pre><code>Application.Run(\"My-Workbook!macro1\")\n</code></pre>\n\n<p>But runs fine without hyphens:</p>\n\n<pre><code>Application.Run(\"MyWorkbook!macro1\")\n</code></pre>\n\n<p>Is it just me or is this weird? Can anyone think of a workaround? </p>\n"}, {"tags": ["csv", "ms-access", "vba", "ms-access-2013"], "answers": [{"comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1429707736, "post_id": 29798086, "comment_id": 47724940, "body": "Set a reference to the MS Office Type Library if you want to use that named constant (<i>msoFileDialogFolderPicker</i>).  Alternatively, you could substitute the constant&#39;s value (4) and avoid the need to set a reference."}, {"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1429707894, "post_id": 29798086, "comment_id": 47725055, "body": "Oh year sorry I got to mention that. However VBA might notice it needs it and ask to add automattically."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1429708142, "post_id": 29798086, "comment_id": 47725237, "body": "If you can get Access to do that, please tell me how.  Thanks."}, {"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1429709731, "post_id": 29798086, "comment_id": 47726664, "body": "I cannot replicate it now. However when I first added it into my code a dialog popped up saying something like this may need an reference to work. Do you want to add it. But I cannot get it to come up again. But might be best to just use the value 4 instead of the full name"}], "tags": [], "owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "is_accepted": true, "score": 2, "last_activity_date": 1429706883, "creation_date": 1429706883, "answer_id": 29798086, "question_id": 29784391, "link": "https://stackoverflow.com/questions/29784391/show-the-save-as-dialog-when-exporting-in-csv-from-access/29798086#29798086", "title": "Show the save as dialog when exporting in csv from Access", "body": "<p>You could use the code</p>\n\n<pre><code>Dim getFolder As Object\nDim sLoc as string\n\nSet getFolder = Application.FileDialog(msoFileDialogFolderPicker)\nWith getFolder\n    .AllowMultiSelect = False\n    If .Show = True Then\n        sLoc = getFolder.SelectedItems(1) &amp; \"\\\"\n    End If\nend with\n</code></pre>\n\n<p>Then you can add your code like </p>\n\n<pre><code>DoCmd.TransferText acExportDelim, \"[Name of the Specific]\", \"[Name of the query]\", sLoc &amp; [Name of file].csv\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 4095976, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0c443648d1a65d4983873cd337d3a5ac?s=128&d=identicon&r=PG&f=1", "display_name": "Ponzaro", "link": "https://stackoverflow.com/users/4095976/ponzaro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 826, "favorite_count": 0, "accepted_answer_id": 29798086, "answer_count": 1, "score": 0, "last_activity_date": 1429706883, "creation_date": 1429655775, "question_id": 29784391, "link": "https://stackoverflow.com/questions/29784391/show-the-save-as-dialog-when-exporting-in-csv-from-access", "title": "Show the save as dialog when exporting in csv from Access", "body": "<p>I'm using this simple code module to export a table in a csv file:</p>\n\n<pre><code>Function ExportQuery()\n DoCmd.TransferText acExportDelim, \"[Name of the Specific]\", \"[Name of the query]\",\"[Name of file].csv\"\nEnd Function\n</code></pre>\n\n<p>But this exports the file in Documents Folder.</p>\n\n<p>How can I do to make that when this module runs, it open the save as dialog and let me choose the folder in which save the file?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel", "dom", "xml-parsing"], "comments": [{"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 2, "creation_date": 1429660742, "post_id": 29784058, "comment_id": 47700331, "body": "&quot;Microsoft.XMLDOM&quot; isn&#39;t the correct namespace and ProgID to instantiate a DOM document. The &quot;Microsoft&quot; namespace was dropped many years ago in favour of &quot;MSXML2&quot; and the most up-to-date DOM document is &quot;DOMDocument.6.0&quot;. For details on which MSXML2 version to use see <a href=\"http://blogs.msdn.com/b/xmlteam/archive/2006/10/23/using-the-right-version-of-msxml-in-internet-explorer.aspx\" rel=\"nofollow noreferrer\">here</a>"}], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 4643092, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-AItmzNvImlw/AAAAAAAAAAI/AAAAAAAAAEY/eXrF39bZ1Dk/photo.jpg?sz=128", "display_name": "NRH", "link": "https://stackoverflow.com/users/4643092/nrh"}, "edited": false, "score": 0, "creation_date": 1429711855, "post_id": 29785808, "comment_id": 47728470, "body": "Very informative, thanks. I&#39;m a little confused now though, in Tools &gt; References I have selected &#39;Microsoft XML v6.0&#39;. Does that mean that I&#39;m using &#39;newest&#39; object syntax? Also, since I&#39;m very new to this, I don&#39;t quite understand InteliSense, I can see it when I hit CTRL+Space but I don&#39;t think that&#39;s what you mean, is it?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 181, "user_id": 4643092, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-AItmzNvImlw/AAAAAAAAAAI/AAAAAAAAAEY/eXrF39bZ1Dk/photo.jpg?sz=128", "display_name": "NRH", "link": "https://stackoverflow.com/users/4643092/nrh"}, "edited": false, "score": 0, "creation_date": 1429743375, "post_id": 29785808, "comment_id": 47748789, "body": "@NRH - Actually, what you see with CTRL+Space is exactly what I mean.  And yes, XML v6.0 is the most recent.  The point that we were making is that since you already have a reference, there isn&#39;t a reason to use <code>CreateObject(&quot;Microsoft.XMLDOM&quot;)</code> and declare <code>As Object</code>. You can use the strongly typed declarations."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 1, "last_activity_date": 1429663889, "creation_date": 1429663889, "answer_id": 29785808, "question_id": 29784058, "link": "https://stackoverflow.com/questions/29784058/vba-if-object-is-nothing/29785808#29785808", "title": "VBA If &lt;object&gt; Is Nothing", "body": "<p>The reason your loop is still executing is simply that <code>If Author Is Nothing</code> evaluates as true. The call to XMLFile.SelectNodes returns an IXMLDOMNodeList, which is an enumerable container.  In fact, the reason that it can be used with For Each syntax depends on this.  In general, any enumeration returned by a function will give you an enumerable with no items in it rather than a null object. The For Each syntax is equivalent to doing this:</p>\n\n<pre><code>Do While Author.NextNode()\n    '...\nLoop\n</code></pre>\n\n<p>...or...</p>\n\n<pre><code>For i = 0 To (Author.Length - 1)\n    '...\nNext i\n</code></pre>\n\n<p>For Each just has the benefit of being more readable. </p>\n\n<p>The error you get actually isn't related to the question you're asking, and correcting the check on the return value of <code>XMLFile.SelectNodes(\"/catalog/book/banana\")</code> won't solve the error if you don't get any results.  The error lies in trying to use your arrays after the loop if they aren't instantiated (although the added End would have solved that).</p>\n\n<p>When you exit the loop and get here...</p>\n\n<pre><code>Range(\"A3\").Resize(j, 1).Value = WorksheetFunction.Transpose(AuthorArray)\nRange(\"B3\").Resize(j, 1).Value = WorksheetFunction.Transpose(BookTypeArray)\n</code></pre>\n\n<p>...your AuthorArray and BookTypeArray have only been initialized if you've been through the loop, because you are relying on the ReDim Preserve in the Sub AddValue to initialize them.  This has 2 solutions.  You can either put an Exit Sub in your test of the return value:</p>\n\n<pre><code>If Author.Length = 0 Then\n    MsgBox (\"Not Found\")\n    Range(\"A1\").Value = \"Not found\"\n    Exit Sub\nEnd If\n</code></pre>\n\n<p>Or you can initialize the arrays at the start of the function.</p>\n\n<pre><code>AuthorArray = Split(vbNullString)\nBookTypeArray = Split(vbNullString)\n</code></pre>\n\n<p>This also has the added benefit of allowing you to skip all of the hoops in your array resizing to determine if they have been initialized. <code>Split(vbNullString)</code> will return an array with a UBound of -1 (<code>MyVariantArray = Array()</code> will do the same for arrays of Variant).  That allows you to rewrite Sub AddValue like this:</p>\n\n<pre><code>Sub AddValue(arr, v)\n    ReDim Preserve arr(UBound(arr) + 1)\n    arr(UBound(arr)) = v\nEnd Sub\n</code></pre>\n\n<p>Finally, I'd take @SOofXWLS's suggestion and @barrowc's suggestions and use explicit object types since you are late binding.  That way your IntelliSense will show auto-complete lists at very least.  If you don't know what types of objects are returned, just hit F2 for the Object Browser and check:</p>\n\n<p><img src=\"https://i.stack.imgur.com/hGkA2.png\" alt=\"SelectNodes in the Object Browser window\"></p>\n\n<p>If you don't know where to even start with a new object model, you can also use this quick and dirty trick...</p>\n\n<pre><code>Dim XMLFile As Object\nSet XMLFile = CreateObject(\"Microsoft.XMLDOM\")\nDebug.Print TypeName(XMLFile)   'DOMDocument\n</code></pre>\n\n<p>... and then...</p>\n\n<pre><code>Dim XMLFile As DOMDocument\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 4643092, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-AItmzNvImlw/AAAAAAAAAAI/AAAAAAAAAEY/eXrF39bZ1Dk/photo.jpg?sz=128", "display_name": "NRH", "link": "https://stackoverflow.com/users/4643092/nrh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12171, "favorite_count": 0, "accepted_answer_id": 29785808, "answer_count": 1, "score": 1, "last_activity_date": 1429663889, "creation_date": 1429654127, "question_id": 29784058, "link": "https://stackoverflow.com/questions/29784058/vba-if-object-is-nothing", "title": "VBA If &lt;object&gt; Is Nothing", "body": "<p>I want to test an object to see if it doesn't exist. If it does not exist, I just want to have a MsgBox show up (or write Error in cell A1 or something). Banana does not exist in this XML. </p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;catalog&gt;\n&lt;book id=\"Adventure\"&gt;\n   &lt;author&gt;Gambardella, Matthew&lt;/author&gt;\n   &lt;title&gt;XML Developer's Guide&lt;/title&gt;\n   &lt;price&gt;44.95&lt;/price&gt;\n&lt;/book&gt;\n&lt;book id=\"Adventure\"&gt;\n   &lt;author&gt;Ralls, Kim&lt;/author&gt;\n   &lt;title&gt;Midnight Rain&lt;/title&gt;\n   &lt;price&gt;5.95&lt;/price&gt;\n&lt;/book&gt;\n&lt;book id=\"Adventure\"&gt;\n   &lt;author&gt;Boal, John&lt;/author&gt;\n   &lt;title&gt;Mist&lt;/title&gt;\n   &lt;price&gt;15.95&lt;/price&gt;\n&lt;/book&gt;\n&lt;book id=\"Mystery\"&gt;\n   &lt;author&gt;Ralls, Kim&lt;/author&gt;\n   &lt;title&gt;Some Mystery Book&lt;/title&gt;\n   &lt;price&gt;9.95&lt;/price&gt;\n&lt;/book&gt;\n&lt;/catalog&gt;\n</code></pre>\n\n<p>The test code:</p>\n\n<pre><code>Sub mySub()\n\nDim XMLFile As Variant\nDim Author As Object\nDim athr As String, BookType As String, Title As String, StoreLocation As String\nDim AuthorArray() As String, BookTypeArray() As String, TitleArray() As String, StoreLocationArray() As String\nDim i As Long, x As Long, j As Long, pn As Object, loc As Object, arr, ln As String, loc2 As Object\n\nDim mainWorkBook As Workbook\nDim n As IXMLDOMNode\nSet mainWorkBook = ActiveWorkbook\nSet XMLFile = CreateObject(\"Microsoft.XMLDOM\")\nXMLFile.Load (\"C:\\BooksOriginal.xml\")\n\nx = 1\nj = 0\n\n\nSet Author = XMLFile.SelectNodes(\"/catalog/book/banana\")\n\nIf Author Is Nothing Then\n    MsgBox (\"Not Found\")\n    Range(\"A1\").Value = \"Not found\"\nEnd If\n\nIf Not Author Is Nothing Then\n    For i = 0 To (Author.Length - 1)\n\n    athr = Author(i).Text\n\n    If athr = \"Ralls, Kim\" Then\n\n        Set pn = Author(i).ParentNode\n        BookType = pn.getAttribute(\"id\")\n        Title = pn.getElementsByTagName(\"title\").Item(0).nodeTypedValue\n\n        AddValue AuthorArray, athr\n        AddValue BookTypeArray, BookType\n        AddValue TitleArray, Title\n        AddValue StoreLocationArray, StoreLocation\n\n        j = j + 1\n        x = x + 1\n    End If\nNext\n    Range(\"A3\").Resize(j, 1).Value = WorksheetFunction.Transpose(AuthorArray)\n    Range(\"B3\").Resize(j, 1).Value = WorksheetFunction.Transpose(BookTypeArray)\nEnd If\n\nEnd Sub\n\n'Utility method - resize an array as needed, and add a new value\nSub AddValue(arr, v)\n    Dim i As Long\n    i = -1\n    On Error Resume Next\n    i = UBound(arr) + 1\n    On Error GoTo 0\n    If i = -1 Then i = 0\n    ReDim Preserve arr(0 To i)\n    arr(i) = v\nEnd Sub\n</code></pre>\n\n<p>Why does this block not do anything? I feel like it's being completely overlooked at by VBA. I even tried putting an End in the If statement.</p>\n\n<pre><code>If Author Is Nothing Then\n    MsgBox (\"Not Found\")\n    Range(\"A1\").Value = \"Not found\"\n    End\nEnd If\n</code></pre>\n\n<p>Also, the error is also thrown at the print range line.. which is in the If Not Author Is Nothing statement. Very strange.</p>\n"}, {"tags": ["excel", "excel-formula", "vlookup", "vba"], "comments": [{"owner": {"reputation": 2706, "user_id": 4230650, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Xfm2v.jpg?s=128&g=1", "display_name": "Marcel", "link": "https://stackoverflow.com/users/4230650/marcel"}, "edited": false, "score": 0, "creation_date": 1429653396, "post_id": 29783812, "comment_id": 47697601, "body": "so can you give an example? what do you expect to achieve? an example please"}, {"owner": {"reputation": 43, "user_id": 989937, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/921aa051f80d30ce1303efa44b13d05f?s=128&d=identicon&r=PG", "display_name": "user989937", "link": "https://stackoverflow.com/users/989937/user989937"}, "reply_to_user": {"reputation": 2706, "user_id": 4230650, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Xfm2v.jpg?s=128&g=1", "display_name": "Marcel", "link": "https://stackoverflow.com/users/4230650/marcel"}, "edited": false, "score": 0, "creation_date": 1429681656, "post_id": 29783812, "comment_id": 47706653, "body": "Sure, so lets say that i have in my dataset (picture 1, above), a displayName of &quot;Refresh&quot;.  It has the RVID of InvoiceHomeFlow/InvoiceHomePF, VID of /Invoiceworkbench, component Type me.xyz.RichCommandImageLink, an action type &#39;Action&#39;, and Click Type &#39;Query&#39;.  This maps to the second row&#39;s criteria of the second image, above.  My dataset then needs to be updated to have &#39;2000&#39; as the &quot;Corrected Threshold&quot; and a &quot;Final Display Name&quot; of &#39;Landing Page Region Refresh&#39;."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 989937, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/921aa051f80d30ce1303efa44b13d05f?s=128&d=identicon&r=PG", "display_name": "user989937", "link": "https://stackoverflow.com/users/989937/user989937"}, "edited": false, "score": 0, "creation_date": 1429826390, "post_id": 29791999, "comment_id": 47797004, "body": "that might work! using array lookups it for some reason fails if you give it more than 2 columns to match"}], "tags": [], "owner": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "is_accepted": false, "score": 2, "last_activity_date": 1429691850, "creation_date": 1429691850, "answer_id": 29791999, "question_id": 29783812, "link": "https://stackoverflow.com/questions/29783812/multiple-criteria-in-a-lookup-formula-conditional-lookup/29791999#29791999", "title": "Multiple criteria in a lookup formula--conditional lookup", "body": "<p>A shortcut I often use when looking up on multiple criteria is to add a dummy column to each table that just concatenates the variables you want to look up on. Then you just do an index match (or vlookup) on this concatenated column.</p>\n"}], "owner": {"reputation": 43, "user_id": 989937, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/921aa051f80d30ce1303efa44b13d05f?s=128&d=identicon&r=PG", "display_name": "user989937", "link": "https://stackoverflow.com/users/989937/user989937"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1429691850, "creation_date": 1429653103, "last_edit_date": 1531161705, "question_id": 29783812, "link": "https://stackoverflow.com/questions/29783812/multiple-criteria-in-a-lookup-formula-conditional-lookup", "title": "Multiple criteria in a lookup formula--conditional lookup", "body": "<p>I have data of the following table format:\n<img src=\"https://i.stack.imgur.com/GbMfc.jpg\" alt=\"Original Data Set\"></p>\n\n<p>As you can see I have a few descriptor columns (view ID, Region View ID, Client ID, Display Name, etc), with one incorrect column (wrong_threshold).</p>\n\n<p>I'd like to \"correct\" Display name and Wrong Threshold using criteria from the following table:\n<img src=\"https://i.stack.imgur.com/Y12iM.jpg\" alt=\"Criteria for Correction\"></p>\n\n<p>Corrected Display name is based on all of the other criteria except for threshold.</p>\n\n<p>Threshold is corrected based on all criteria.</p>\n\n<p>My problem is that if this were simpler I would do a lookup using an array formula.\nHowever there is so many criteria to select from here I am not sure that would work.  Any suggestions on this would be appreciated please.</p>\n\n<p>Edit: so lets say that i have in my dataset (picture 1, above), a displayName of \"Refresh\". It has the RVID of InvoiceHomeFlow/InvoiceHomePF, VID of /Invoiceworkbench, component Type me.xyz.RichCommandImageLink, an action type 'Action', and Click Type 'Query'. This maps to the second row's criteria of the second image, above. My dataset then needs to be updated to have '2000' as the \"Corrected Threshold\" and a \"Final Display Name\" of 'Landing Page Region Refresh'. </p>\n"}, {"tags": ["c#", "vba", "excel", "pivot-table"], "answers": [{"comments": [{"owner": {"reputation": 199, "user_id": 3885851, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/550725b3479929eca9c0063eda6584bd?s=128&d=identicon&r=PG&f=1", "display_name": "MoralesJosue", "link": "https://stackoverflow.com/users/3885851/moralesjosue"}, "edited": false, "score": 0, "creation_date": 1429658186, "post_id": 29784163, "comment_id": 47699583, "body": "does this method affect if the pivot table is in another worksheet, some how I cant get it right. (It isn&#39;t displaying the data)."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 199, "user_id": 3885851, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/550725b3479929eca9c0063eda6584bd?s=128&d=identicon&r=PG&f=1", "display_name": "MoralesJosue", "link": "https://stackoverflow.com/users/3885851/moralesjosue"}, "edited": false, "score": 0, "creation_date": 1429658661, "post_id": 29784163, "comment_id": 47699713, "body": "@MoralesJosue No, it should work just the same way. But take note that you cannot directly use my formula. You need to create your own and adjust it accordingly."}, {"owner": {"reputation": 199, "user_id": 3885851, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/550725b3479929eca9c0063eda6584bd?s=128&d=identicon&r=PG&f=1", "display_name": "MoralesJosue", "link": "https://stackoverflow.com/users/3885851/moralesjosue"}, "edited": false, "score": 1, "creation_date": 1429730826, "post_id": 29784163, "comment_id": 47742078, "body": "Finally got it working properly, didn&#39;t know about the GETPIVOTDATA."}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": true, "score": 1, "last_activity_date": 1429656427, "last_edit_date": 1429656427, "creation_date": 1429654619, "answer_id": 29784163, "question_id": 29783501, "link": "https://stackoverflow.com/questions/29783501/copy-values-from-pivot-table-to-sheet-in-specific-cell/29784163#29784163", "title": "Copy values from pivot table to sheet in specific cell", "body": "<p>You do not need VBA to do this. Use <a href=\"http://www.contextures.com/xlPivot06.html\" rel=\"nofollow noreferrer\"><code>GETPIVOTDATA</code></a>.</p>\n\n<p><strong>Consider below replicated data:</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/jQGLv.png\" alt=\"enter image description here\"></p>\n\n<p>In above sample, I copied some of your data in your screen shot, made a pivot out of it, put it in the same sheet and also put the table you need to populate below it. Then I use <code>GETPIVOTDATA</code>. I feel I need to show you how it is done even though it is well explained in the link I posted.</p>\n\n<p>So we use this formula:</p>\n\n<blockquote>\n  <p>=GETPIVOTDATA(\"Sum of \"&amp;$I18,$I$2,\"Date\",J$17,\"Opt\",$I$16,\"Id\",$J$16)</p>\n</blockquote>\n\n<p>in <code>Cell J14</code>. Take note that instead of using <em>Day 1, Day2.. etc</em> on your destination table, we used the actual date. Why? Because we need that in our <code>GETPIVOTDATA</code> Formula. Then copy the formula to the rest of the cells.</p>\n\n<p><strong>Result:</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/ZAyOT.png\" alt=\"enter image description here\"></p>\n\n<p>Now, <code>GETPIVOTDATA</code> errors out if it does not find anything which matches the criteria you supplied, so you might want to incorporate error handling using <code>IFERROR</code> statement.</p>\n\n<p><strong>Final Formula:</strong></p>\n\n<blockquote>\n  <p>=IFERROR(GETPIVOTDATA(\"Sum of \"&amp;$I18,$I$2,\"Date\",J$17,\"Opt\",$I$16,\"Id\",$J$16),0)</p>\n</blockquote>\n\n<p>Although you prefer VBA, I don't think a better approach than the built-in Excel functionality is more suitable in your case.</p>\n"}], "owner": {"reputation": 199, "user_id": 3885851, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/550725b3479929eca9c0063eda6584bd?s=128&d=identicon&r=PG&f=1", "display_name": "MoralesJosue", "link": "https://stackoverflow.com/users/3885851/moralesjosue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1448, "favorite_count": 0, "accepted_answer_id": 29784163, "answer_count": 1, "score": 1, "last_activity_date": 1429656427, "creation_date": 1429651918, "last_edit_date": 1429654439, "question_id": 29783501, "link": "https://stackoverflow.com/questions/29783501/copy-values-from-pivot-table-to-sheet-in-specific-cell", "title": "Copy values from pivot table to sheet in specific cell", "body": "<p>I have some data that is displayed in a pivot table, from that pivot table I currently copy and paste them in another table with the corresponding current day, with so many operation numbers it takes about 1hr to complete this process daily, I'm trying to make a macro in which will help me in making this process in less time</p>\n\n<p>This is the pivot table in which I copy the data</p>\n\n<p><img src=\"https://i.stack.imgur.com/VAWSf.jpg\" alt=\"Pivot Table\"></p>\n\n<p>and here is where I paste it (in this table I use it to create some graphs) </p>\n\n<p><img src=\"https://i.stack.imgur.com/bGj9U.jpg\" alt=\"enter image description here\"></p>\n\n<p>Both tables consist of many different numbers of operation, as you can imagine this is very tedious.</p>\n\n<p>Any help or ideas that can help me solve this is appreciated, I'm willing to try some other alternatives like fomulas, <strong>vba (preferred)</strong>, even closedxml for c#.</p>\n\n<p>I dont know if im explaining my self?\nThis is my logic.</p>\n\n<ol>\n<li>Look for operation number</li>\n<li>Copy Sum of \"Sx\"</li>\n<li>Look in other sheet for the same operation number.</li>\n<li>Paste value in corresponding day.</li>\n<li>Look for same operation number with next \"Sx\"<br>\n.<br>\n.<br></li>\n<li>End</li>\n</ol>\n\n<p>Right now I'm just focusing on Operation1, since in Operation2 I use another sheet in which I do the same thing. (will probably use the same code as Operation1). </p>\n\n<p>To clarify I'm not asking for someone to just give me the solution (although it is appreciated ), but any guide on this is helpful.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "edited": false, "score": 0, "creation_date": 1429651738, "post_id": 29783399, "comment_id": 47696844, "body": "Is this your full code?  It looks like <code>templateworkbookname</code> is not defined, which would raise a <code>Subscript out of range</code> error."}, {"owner": {"reputation": 3, "user_id": 4509998, "user_type": "registered", "profile_image": "https://graph.facebook.com/1338030822/picture?type=large", "display_name": "John Connolly", "link": "https://stackoverflow.com/users/4509998/john-connolly"}, "reply_to_user": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "edited": false, "score": 0, "creation_date": 1429651882, "post_id": 29783399, "comment_id": 47696911, "body": "No, it&#39;s not the full code, but it is defined (edited it now)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1429651905, "post_id": 29783399, "comment_id": 47696917, "body": "s/defined/**assigned**. and that should really be a <code>String</code>, not a <code>Variant</code>."}, {"owner": {"reputation": 3, "user_id": 4509998, "user_type": "registered", "profile_image": "https://graph.facebook.com/1338030822/picture?type=large", "display_name": "John Connolly", "link": "https://stackoverflow.com/users/4509998/john-connolly"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1429652359, "post_id": 29783399, "comment_id": 47697103, "body": "@Mat&#39;s Mug changed, but the sheet copying still doesn&#39;t work"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1429652505, "post_id": 29783399, "comment_id": 47697171, "body": "I am not sure why your doing this, if you are just copying all the sheets to a new workbook, why not just save the original workbook as a new name?"}, {"owner": {"reputation": 3, "user_id": 4509998, "user_type": "registered", "profile_image": "https://graph.facebook.com/1338030822/picture?type=large", "display_name": "John Connolly", "link": "https://stackoverflow.com/users/4509998/john-connolly"}, "edited": false, "score": 0, "creation_date": 1429652731, "post_id": 29783399, "comment_id": 47697275, "body": "Well I&#39;m doing it multiple times. I figure it&#39;s faster than opening/ reopening? Not sure. Even if not it may end up being a subset of sheets in the future so I&#39;d like to know."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4509998, "user_type": "registered", "profile_image": "https://graph.facebook.com/1338030822/picture?type=large", "display_name": "John Connolly", "link": "https://stackoverflow.com/users/4509998/john-connolly"}, "edited": false, "score": 0, "creation_date": 1429711120, "post_id": 29784779, "comment_id": 47727825, "body": "Hi thanks, but I&#39;m putting all of this in a loop to do it multiple times, and at some point this will be part of an addin. So I need the main macro to call the template workbook and then add another for it to save to"}], "tags": [], "owner": {"reputation": 5111, "user_id": 1359088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f4ffb15d50db85cc68143626a8e0046?s=128&d=identicon&r=PG", "display_name": "James Toomey", "link": "https://stackoverflow.com/users/1359088/james-toomey"}, "is_accepted": false, "score": 0, "last_activity_date": 1429657699, "creation_date": 1429657699, "answer_id": 29784779, "question_id": 29783399, "link": "https://stackoverflow.com/questions/29783399/copying-an-array-of-sheets-vba/29784779#29784779", "title": "Copying an array of sheets vba", "body": "<p>I changed your code around a bit because this seemed like what you wanted to accomplish. If you have a new, blank Workbook open, then this will open the <code>test.xlsx</code> one, then copy in the sheets, then close it, and your blank workbook will now have the 3 sheets from <code>test.xlsx</code> in it. Note that I had to provide the entire path to <code>test.xlsx</code> so it could find it.</p>\n\n<pre><code>Set currentworkbook = ActiveSheet\nDim templateworkbookname as String\ntemplateworkbookname = \"c:\\test.xlsx\"\n\nSet wb = Workbooks.Open(templateworkbookname)\n\nDim ws() As Variant\nDim j As Integer\nReDim ws(wb.Worksheets.Count)\nFor j = 1 To wb.Worksheets.Count\n    ws(j) = wb.Worksheets(j).Name\nNext\n\nFor j = 1 To UBound(ws)\n    wb.Worksheets(j).Copy Before:=currentworkbook\nNext\n\nwb.Close\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4509998, "user_type": "registered", "profile_image": "https://graph.facebook.com/1338030822/picture?type=large", "display_name": "John Connolly", "link": "https://stackoverflow.com/users/4509998/john-connolly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1268, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429657699, "creation_date": 1429651474, "last_edit_date": 1429652313, "question_id": 29783399, "link": "https://stackoverflow.com/questions/29783399/copying-an-array-of-sheets-vba", "title": "Copying an array of sheets vba", "body": "<p>I was trying to copy a bunch of sheets from a template file to a new file, but this was resulting in the formulas referring to the original template- so I saw online that I should use an array- but now getting a \"Subscript out of range\" error. What am I doing wrong-it errors on the last line? Also i tried ws() as string and that did not work either.</p>\n\n<pre><code>Dim templateworkbookname As string\ntemplateworkbookname=\"test.xlsx\"\nDim ws() As Variant   \n        Dim j As Integer\n        ReDim ws(Workbooks(templateworkbookname).Worksheets.Count)\n        For j = 1 To Workbooks(templateworkbookname).Worksheets.Count\n                ws(j) = Workbooks(templateworkbookname).Worksheets(j).Name\n        Next\n        Set newbook = Workbooks.Add\n        Workbooks(templateworkbookname).Worksheets(ws).Copy Before:=newbook.Sheets(1)\n</code></pre>\n"}, {"tags": ["windows", "oracle", "vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1429664536, "post_id": 29783134, "comment_id": 47701532, "body": "Are you configuring the ODBC driver through the ODBC Data Source Administrator, or using some other method?"}, {"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 1, "creation_date": 1429711712, "post_id": 29783134, "comment_id": 47728350, "body": "If you like to install both Oracle Clients (32 bit and 64 bit), follow this instruction: <a href=\"http://stackoverflow.com/questions/24104210/badimageformatexception-this-will-occur-when-running-in-64-bit-mode-with-the-32#24120100\">Stack Overflow - Install Oracle x86 and x64</a>. Note, in order to configure 32 bit ODBC drivers launch <code>c:\\Windows\\SysWOW64\\odbcad32.exe</code>, for 64 bit drivers lauch <code>c:\\Windows\\System32\\odbcad32.exe</code>. Both have exactly the same outline but the listed drives are different."}], "answers": [{"tags": [], "owner": {"reputation": 421, "user_id": 5024658, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-md8UhJRxd_g/AAAAAAAAAAI/AAAAAAAAhyg/igUflaP6DH4/photo.jpg?sz=128", "display_name": "Liss", "link": "https://stackoverflow.com/users/5024658/liss"}, "is_accepted": false, "score": 0, "last_activity_date": 1438100390, "creation_date": 1438100390, "answer_id": 31681938, "question_id": 29783134, "link": "https://stackoverflow.com/questions/29783134/getting-ms-office-2013-32-bit-excel-and-access-to-connect-to-oracle-database-w/31681938#31681938", "title": "Getting MS Office 2013 (32 bit) Excel and Access to connect to Oracle database when both 32 and 64 clients are installed", "body": "<p>I had a similar issue trying with a Teradata ODBC connection that I had to fix by actually specifying where the dll was located.  My connection string ended up looking something like this.  I gave up on trying to use DSN names as well due to a different problem.</p>\n\n<pre><code>ODBC;DefaultDir=C:\\Program Files (x86)\\Teradata\\Client\\14.10\\ODBC Driver for Teradata\\Lib\\tdata32.dll;DRIVER={Teradata};DBCName=ourserver.com;\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 4816549, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-aEMNpPg1jwg/AAAAAAAAAAI/AAAAAAAAMNA/7SdKpWakips/photo.jpg?sz=128", "display_name": "Erin Ukestad", "link": "https://stackoverflow.com/users/4816549/erin-ukestad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3333, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1438100390, "creation_date": 1429650455, "question_id": 29783134, "link": "https://stackoverflow.com/questions/29783134/getting-ms-office-2013-32-bit-excel-and-access-to-connect-to-oracle-database-w", "title": "Getting MS Office 2013 (32 bit) Excel and Access to connect to Oracle database when both 32 and 64 clients are installed", "body": "<p>I am having some issues with Microsoft Office products after installing both the 32 bit and 64 bit clients for Oracle 11gr2 on my machine. I'm currently running Windows 7 64 bit with Microsoft Office 32 bit.</p>\n\n<p>We are dependent on some 32 bit applications and are working with a team of people - most of whom have 32 bit OS machines, so I need to run Office 32 bit.</p>\n\n<p>Currently, I'm creating and maintaining some Excel macro-enabled workbooks that our staff uses to submit information to access databases. The access databases make connections to oracle using the sqora32.dll driver and the excel workbooks connect using oraclient11.dll. </p>\n\n<p>I recently got a build of ArcGIS Pro, which requires a 64 bit oracle client and have been testing it for use on our production floor. I thought I had successfully installed the 64 bit oracle instant client (I have the full administrator version of the 32 bit oracle client) because everything worked great. The rest of my 32 bit software connects fine. However, when I try to make an oracle connection through access, the driver fails or I get a kernelbase error and Access completely crashes.</p>\n\n<p>When I try the query through Excel vba, I get an error from the Oracle ODBC Driver. It says, Internal Error - unable to initialize NLS during driver load. My event log shows the oraclient11.dll failing. When I try connecting using the \"Run as administrator\" option, the applications don't completely crash, they just stop working.</p>\n\n<p>I've tried uninstalling and reinstalling the 32 bit oracle client, setting oracle_home environment variable, a work-around using softlinks in c:\\windows\\system32 and changing the order of the entries in the PATH environment variable, and setting the NLS_LANG environment variable.</p>\n\n<p>I would really like to figure this out without having to find another machine to test Pro on. Can anyone help me out with this? Because my 32 bit software is connecting correctly, I think it has something to do with Office trying to use the 64 bit drivers, but I'm not an expert on this. So, I don't know. </p>\n\n<p>Any help would be very much appreciated. If this has been answered before, can you please provide a link? I've been searching this for most of last week through today and have been unable to find anything that addresses my particular issue.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 2, "creation_date": 1429660800, "post_id": 29783038, "comment_id": 47700347, "body": "You need to use the <code>Is</code> keyword when using this operators in a <code>Case</code> statement."}], "answers": [{"comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 1, "creation_date": 1429657870, "post_id": 29783978, "comment_id": 47699443, "body": "You need to change <code>Case aux &lt; 97</code> to <code>Case Is &lt; 97</code> for your third test to be evaluated correctly. Nonetheless still good job for sorting out first two conditions. :)"}], "tags": [], "owner": {"reputation": 593, "user_id": 1771869, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d9c162845273ba3a1aaa34ed74342bbe?s=128&d=identicon&r=PG", "display_name": "Carol", "link": "https://stackoverflow.com/users/1771869/carol"}, "is_accepted": true, "score": 1, "last_activity_date": 1429653779, "creation_date": 1429653779, "answer_id": 29783978, "question_id": 29783038, "link": "https://stackoverflow.com/questions/29783038/error-comparing-decimal-values-in-vba/29783978#29783978", "title": "Error comparing decimal values in vba", "body": "<p>I did it work changing:</p>\n\n<pre><code>aux = 97.8000030517578\nSelect Case aux\n        Case 99 to 100\n            Debug.Print \"Menor que 100\"\n        Case 97 to 98.999\n            Debug.Print \"Medio\"\n        Case aux &lt; 97\n            Debug.Print \"malo\"\n    End Select\n</code></pre>\n\n<p>I don't know if there's other way.</p>\n"}, {"comments": [{"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1429658191, "post_id": 29784714, "comment_id": 47699589, "body": "That is brilliant, I have never thought to use a case statement in this way."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 3, "creation_date": 1429660973, "post_id": 29784714, "comment_id": 47700393, "body": "@DanDonoghue AFAIK this is the only way to use a <code>Case</code> statement with the <code>And</code> or <code>Or</code> operators. Very handy tip if you understand the logic."}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 2, "last_activity_date": 1429657366, "creation_date": 1429657366, "answer_id": 29784714, "question_id": 29783038, "link": "https://stackoverflow.com/questions/29783038/error-comparing-decimal-values-in-vba/29784714#29784714", "title": "Error comparing decimal values in vba", "body": "<p>Here is another way:</p>\n\n<pre><code>aux = 97.8000030517578\nSelect Case True\nCase aux &gt;= 99 And aux &lt; 100: Debug.Print \"Menor que 100\"\nCase aux &gt;= 97 And aux &lt; 99: Debug.Print \"Medio\"\nCase aux &lt; 97: Debug.Print \"malo\"\nEnd Select\n</code></pre>\n\n<p>In your first attempt, you are not actually testing the <code>aux</code> but the statements.<br>\nSo might as well select the case where that statement is <code>True</code>.</p>\n"}], "owner": {"reputation": 593, "user_id": 1771869, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d9c162845273ba3a1aaa34ed74342bbe?s=128&d=identicon&r=PG", "display_name": "Carol", "link": "https://stackoverflow.com/users/1771869/carol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 29783978, "answer_count": 2, "score": 1, "last_activity_date": 1429657966, "creation_date": 1429650082, "last_edit_date": 1429657966, "question_id": 29783038, "link": "https://stackoverflow.com/questions/29783038/error-comparing-decimal-values-in-vba", "title": "Error comparing decimal values in vba", "body": "<p>I got the next code:</p>\n\n<pre><code>aux = 97.8000030517578\n\nSelect Case aux\nCase aux &lt; 100\n    Debug.Print \"Menor que 100\"\nCase aux &gt;= 97 And aux &lt; 100\n    Debug.Print \"Medio\"\nCase aux &lt; 97\n    Debug.Print \"malo\"\nEnd Select\n</code></pre>\n\n<p>And it doesn't accomplish any condition in the select, so it doesn't print anything. Any idea, help?</p>\n"}, {"tags": ["mysql", "vba"], "comments": [{"owner": {"reputation": 662, "user_id": 3998520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d77a6e0a246452554f23ba41d0245bf?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew", "link": "https://stackoverflow.com/users/3998520/matthew"}, "edited": false, "score": 0, "creation_date": 1429650529, "post_id": 29782843, "comment_id": 47696236, "body": "Since I can&#39;t test to know for sure, I&#39;ll put it as comment:  ### CnnStr = &quot;DRIVER = {MySql ODBC 5.3 Driver}; SERVER =&quot; &amp; ServerName &amp; &quot;; Database =&quot; &amp; DBName &amp; &quot;; USER =&quot; &amp; User &amp; &quot;; PASSWORD =&quot; &amp; PWD &amp; &quot;; Option=3&quot; ###  When connecting to a remote SQL database in python, I had a similar error, which was resolved by removing the spaces. From <a href=\"http://www.connectionstrings.com/sql-server-2008/\" rel=\"nofollow noreferrer\">connectionstrings.com/sql-server-2008</a> , you can see that there are no spaces. Try changing that first"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1429657650, "post_id": 29782843, "comment_id": 47699362, "body": "Have you installed the MySQL ODBC driver? Go into ODBC Administrator (the 32 bit one) and create a <i>file</i> dsn and test it. Then open that file and you should find a string approximating what you need in your connection string above."}, {"owner": {"reputation": 147, "user_id": 4367857, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e144e1ed7e0c525fa991750ec1b1dde3?s=128&d=identicon&r=PG&f=1", "display_name": "Bunny", "link": "https://stackoverflow.com/users/4367857/bunny"}, "edited": false, "score": 0, "creation_date": 1429715188, "post_id": 29782843, "comment_id": 47731357, "body": "I am trying to connect to my database website."}, {"owner": {"reputation": 147, "user_id": 4367857, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e144e1ed7e0c525fa991750ec1b1dde3?s=128&d=identicon&r=PG&f=1", "display_name": "Bunny", "link": "https://stackoverflow.com/users/4367857/bunny"}, "edited": false, "score": 0, "creation_date": 1429715727, "post_id": 29782843, "comment_id": 47731762, "body": "I am trying to connect to my website database. I have tried testing the connection using ODBC Administrator, I always have a Connection failed message &quot;[MYSQL][odbc 5.3(w) Driver]Host&#39;myhost&#39; is not allowed to connect to this MySQL server:  Bellow is the input:  TCP/IP Server: the IP of my websit (I used this ip to log into phpmyadmin which works just fine) User: root Password: mypassword  Is there anything I did wrong? Please, help."}], "owner": {"reputation": 147, "user_id": 4367857, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e144e1ed7e0c525fa991750ec1b1dde3?s=128&d=identicon&r=PG&f=1", "display_name": "Bunny", "link": "https://stackoverflow.com/users/4367857/bunny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 687, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1429678937, "creation_date": 1429649320, "last_edit_date": 1429678937, "question_id": 29782843, "link": "https://stackoverflow.com/questions/29782843/how-to-connect-to-mysql-using-vba-in-excel-2007", "title": "How to connect to mysql using vba in excel 2007", "body": "<p>I have used the code bellow to connect to mysql and I have install mysql odbc connector version 5.3.</p>\n\n<pre><code>'Connect to database\nFunction CnnOpen(ByVal ServerName As String, ByVal DBName As String, _\nByVal TblName As String, ByVal User As String, ByVal PWD As String)\n\n    Dim CnnStr As String\n    Set Cnn = CreateObject(\"ADODB.Connection\")\n    Cnn.CommandTimeout = 15\n    CnnStr = \"DRIVER = {MySql ODBC 5.3 Driver}; SERVER =\" &amp; ServerName &amp; _\n             \"; Database =\" &amp; DBName &amp; \"; USER =\" &amp; User &amp; \"; PASSWORD =\" _\n             &amp; PWD &amp; \"; Option=3\"\n    Cnn.ConnectionString = CnnStr\n    Cnn.Open\nEnd Function\n</code></pre>\n\n<p>I have the following error:</p>\n\n<blockquote>\n  <p>Run-time error '-2147467259 (80004005)':\n  [Microsoft][ODBC Driver Manager]Data source name not found and\n  no default driver specified</p>\n</blockquote>\n\n<p>Is there any incorrect connection string or any mistake in the code? Please, help.</p>\n"}, {"tags": ["excel", "csv", "vba"], "answers": [{"comments": [{"owner": {"reputation": 956, "user_id": 3469496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/4jWVm.jpg?s=128&g=1", "display_name": "CactusCake", "link": "https://stackoverflow.com/users/3469496/cactuscake"}, "edited": false, "score": 0, "creation_date": 1429652339, "post_id": 29783467, "comment_id": 47697096, "body": "In addition you could put <code>Application.Calculation = xlCalculationManual</code> before you start the loop and <code>Application.Calculation = xlCalculationAutomatic</code> after the loop has finished. This way, if you have formulas that are dependent on the values in your target range (or ANY volatile functions) then they only need to update once instead of 75 times."}, {"owner": {"reputation": 679, "user_id": 4552218, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/9692b43a8e2fdee1a7de122f5ea37876?s=128&d=identicon&r=PG&f=1", "display_name": "ForJ9", "link": "https://stackoverflow.com/users/4552218/forj9"}, "edited": false, "score": 0, "creation_date": 1429724041, "post_id": 29783467, "comment_id": 47737651, "body": "It helps me a lot :) Now I can speed up all of my code :) Before: 20 seconds, afterwards: instant :D"}], "tags": [], "owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "is_accepted": true, "score": 2, "last_activity_date": 1429651737, "creation_date": 1429651737, "answer_id": 29783467, "question_id": 29782294, "link": "https://stackoverflow.com/questions/29782294/load-csv-file-faster/29783467#29783467", "title": "Load CSV File faster", "body": "<p>Here are two things you can do to speed up your code:</p>\n\n<ol>\n<li>Only do the double-quote character replacement once.</li>\n<li>Write all the data to the cells once.</li>\n</ol>\n\n<p>The second item will probably give you the most speed up as reading/writing cells is time-consuming.  Try this code:</p>\n\n<pre><code>If Dir(FilePath &amp; Worksheets(\"List\").Cells(datarow, 2) &amp; \".csv\") &lt;&gt; \"\" Then\n\n    Open FilePath &amp; Worksheets(\"List\").Cells(datarow, 2) &amp; \".csv\" For Input As #2\n    Line Input #2, LineFromFile\n    LineFromFile = Replace(LineFromFile, Chr(34), \"\")\n    lineitems = Split(LineFromFile, \";\")\n\n    With Worksheets(\"Calendar\")\n        .Range(.Cells(datarow, 2), .Cells(datarow, 367)).Value = lineitems\n    End With\n\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 679, "user_id": 4552218, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/9692b43a8e2fdee1a7de122f5ea37876?s=128&d=identicon&r=PG&f=1", "display_name": "ForJ9", "link": "https://stackoverflow.com/users/4552218/forj9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 892, "favorite_count": 0, "accepted_answer_id": 29783467, "answer_count": 1, "score": 1, "last_activity_date": 1429651737, "creation_date": 1429647479, "last_edit_date": 1531161705, "question_id": 29782294, "link": "https://stackoverflow.com/questions/29782294/load-csv-file-faster", "title": "Load CSV File faster", "body": "<p>I load around 75 CSV files containing one line.</p>\n\n<pre><code>For dataRow = 8 To Worksheets(\"Liste\").Range(\"B65535\").End(xlUp).Row\n\n        If Dir(FilePath &amp; Worksheets(\"List\").Cells(dataRow, 2) &amp; \".csv\") &lt;&gt; \"\" Then\n\n            Open FilePath &amp; Worksheets(\"List\").Cells(dataRow, 2) &amp; \".csv\" For Input As #2\n            Line Input #2, LineFromFile\n            LineItems = Split(LineFromFile, \";\")\n\n            itemNumber = 0\n            For i = 2 To 367\n               Worksheets(\"Calendar\").Cells(dataRow, i).value = Replace(LineItems(itemNumber), Chr(34), \"\")\n               itemNumber = itemNumber + 1\n            Next\n\n        End If\n\n        Close #2\n    Next\n</code></pre>\n\n<p>The Problem is, that this code is very slow. It takes around 20 seconds to load this data. (27450 data sets, 27,3kb)</p>\n\n<p>Is there a way to speed up the loading? I think my SSD is fast enough.</p>\n"}, {"tags": ["excel", "time", "intervals", "vba"], "comments": [{"owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "edited": false, "score": 0, "creation_date": 1429648511, "post_id": 29782256, "comment_id": 47695061, "body": "Once it begins running, should it run every hour indefinitely?  If not, when should the stop time be each day?  Does it need to happen all within Excel?"}, {"owner": {"reputation": 71, "user_id": 4775059, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j6WreyA8PEw/AAAAAAAAAAI/AAAAAAAABtc/Th92hEsZQPg/photo.jpg?sz=128", "display_name": "Dennis", "link": "https://stackoverflow.com/users/4775059/dennis"}, "reply_to_user": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "edited": false, "score": 0, "creation_date": 1429649677, "post_id": 29782256, "comment_id": 47695793, "body": "it should continue to run as long as the spreadsheet is open. Yes, it needs to happen within excel. I have one spreadsheet that is on display all the time. It needs to update from two other workbooks. This macro opens the other two workbooks, updates, saves and closes but the display workbook remains open."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 4775059, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j6WreyA8PEw/AAAAAAAAAAI/AAAAAAAABtc/Th92hEsZQPg/photo.jpg?sz=128", "display_name": "Dennis", "link": "https://stackoverflow.com/users/4775059/dennis"}, "edited": false, "score": 0, "creation_date": 1429653012, "post_id": 29782942, "comment_id": 47697421, "body": "I like this idea although I&#39;m not sure how to refresh the display worksheet that is already open once the other two have been updated and closed. Does it need to be or since it is already open will the data live refresh? The display worksheet is just simple links. a1 = a1 (workbook A) a2= a2 (workbook B). The display worksheet is open at all times. I could have task scheduler open the macro book, the macro will run on open, update the other two books and close them leaving the display workbook the only one open."}], "tags": [], "owner": {"reputation": 318, "user_id": 4721565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/700af168e5e09a36b844328770337189?s=128&d=identicon&r=PG&f=1", "display_name": "Lumigraphics", "link": "https://stackoverflow.com/users/4721565/lumigraphics"}, "is_accepted": false, "score": 2, "last_activity_date": 1429649707, "creation_date": 1429649707, "answer_id": 29782942, "question_id": 29782256, "link": "https://stackoverflow.com/questions/29782256/code-to-run-macro-on-time-interval/29782942#29782942", "title": "Code to run macro on time interval?", "body": "<p>Windows has a built-in Task Scheduler. Put your macro into a workbook and set it to run on the WorkBook.Open event. <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196215.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff196215.aspx</a></p>\n\n<p>Set the Task Scheduler to open that Excel file every hour, run the macro, and have it close the file at the end. This cuts down on memory usage vs keeping Excel running. Task Scheduler also has the ability (for example) to send an email, so you could set it to email you when the task ran each hour.</p>\n"}, {"tags": [], "owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "is_accepted": false, "score": 7, "last_activity_date": 1429651474, "last_edit_date": 1495540039, "creation_date": 1429650430, "answer_id": 29783124, "question_id": 29782256, "link": "https://stackoverflow.com/questions/29782256/code-to-run-macro-on-time-interval/29783124#29783124", "title": "Code to run macro on time interval?", "body": "<p><a href=\"https://stackoverflow.com/users/4721565/lumigraphics\">Lumigraphics</a> raises a good point about memory usage, which should be considered.  In the interest of learning I will present an alternate solution that doesn't require task scheduler and will work completely within the display workbook.</p>\n\n<p>In the VB Editor, add this new subroutine</p>\n\n<pre><code>Public Sub RefreshDataEachHour()\n\n    Application.OnTime Now + TimeValue(\"01:00:00\"), \"Refresh_All\"\n\nEnd Sub\n</code></pre>\n\n<p>And add the following line to the end of your <code>Refresh_All</code> routine</p>\n\n<p><code>Call RefreshDataEachHour</code></p>\n\n<p>When the <code>Refresh_All</code> routine is run for the first time it will call this new procedure, which will then wait an hour and then call <code>Refresh_All</code>.  Again at the end of <code>Refresh_All</code> it returns to this stored procedure, which will wait an hour again, then call <code>Refresh_All</code>, etc.  This will repeat until the Excel application is exited.</p>\n\n<p><strong>This part below is beyond the scope of your question, but I feel it important to mention anyways.</strong></p>\n\n<p>Basically, <code>Application.OnTime</code> schedules a task to run at some point in the future.  You may want to end this scheduled task at some point in time.  To do so you must call the <code>Application.OnTime</code> method with an argument <code>Schedule:=False</code> and you must pass in the exact time that you scheduled the procedure with your first <code>Application.OnTime</code> call.</p>\n\n<p>To handle this case, declare a global variable (outside of all of your subroutines) and pass that variable into a new subroutine that will cancel the task.</p>\n\n<p>For example, you can declare</p>\n\n<p><code>Public RunWhen As Date</code></p>\n\n<p>Then you would modify the above procedure as follows:</p>\n\n<pre><code>Public Sub RefreshDataEachHour()\n\n    RunWhen = Now + TimeValue(\"01:00:00\")\n    Application.OnTime EarliestTime:=RunWhen,Procedure:=\"Refresh_All\",Schedule:=True\n\nEnd Sub\n</code></pre>\n\n<p>Then you can add another subroutine that would handle the canceling of the task, like so:</p>\n\n<pre><code>Public Sub CancelRefresh()\n\n    Application.OnTime EarliestTime:=RunWhen, Procedure:=\"Refresh_All\", Schedule:=False\n\nEnd Sub\n</code></pre>\n\n<p>Whenever you use <code>Call CancelRefresh</code> that <em>should</em> remove your procedure from the queue.</p>\n"}], "owner": {"reputation": 71, "user_id": 4775059, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j6WreyA8PEw/AAAAAAAAAAI/AAAAAAAABtc/Th92hEsZQPg/photo.jpg?sz=128", "display_name": "Dennis", "link": "https://stackoverflow.com/users/4775059/dennis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12574, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1429651474, "creation_date": 1429647366, "last_edit_date": 1531161705, "question_id": 29782256, "link": "https://stackoverflow.com/questions/29782256/code-to-run-macro-on-time-interval", "title": "Code to run macro on time interval?", "body": "<p>How can I set a macro to run at a specific time and then at set intervals afterwards? I would like it to run at the top of each hour so I would like to start it at 07:00AM for example and then every hour after I want it to run again. Here is the code:</p>\n\n<pre><code>Sub Refresh_All()\n'\n' Refresh_All Macro\n'\n' Keyboard Shortcut: Ctrl+Y\n'\n    ChDir \"Q:\\Quality Control\"\n    Workbooks.Open Filename:= _\n        \"Q:\\Quality Control\\Internal Failure Log - Variable Month.xlsm\"\n    Dim endTime As Date\n    endTime = DateAdd(\"s\", 10, Now())\n    Do While Now() &lt; endTime\nDoEvents\n    Loop\n    ActiveWorkbook.RefreshAll\n       endTime = DateAdd(\"s\", 10, Now())\n    Do While Now() &lt; endTime\n        DoEvents\n    Loop\nActiveWorkbook.Save\n    endTime = DateAdd(\"s\", 5, Now())\n    Do While Now() &lt; endTime\n        DoEvents\n    Loop\n    ActiveWindow.Close\n    ChDir \"Q:\\Reports\"\n    Workbooks.Open Filename:= _\n        \"Q:\\Reports\\Finished-Transfer Report-variable month.xlsm\"\n        endTime = DateAdd(\"s\", 10, Now())\n    Do While Now() &lt; endTime\n        DoEvents\n    Loop\nActiveWorkbook.RefreshAll\n     endTime = DateAdd(\"s\", 10, Now())\n    Do While Now() &lt; endTime\n        DoEvents\n    Loop\nActiveWorkbook.Save\n        endTime = DateAdd(\"s\", 5, Now())\n    Do While Now() &lt; endTime\n        DoEvents\n    Loop\nActiveWindow.Close\n    ActiveWorkbook.RefreshAll\n        endTime = DateAdd(\"s\", 10, Now())\n    Do While Now() &lt; endTime\n        DoEvents\n    Loop\nActiveWorkbook.Save\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "hyperlink"], "answers": [{"comments": [{"owner": {"reputation": 183, "user_id": 2946872, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5fa42752e3bedb6437ed2baec3f228b8?s=128&d=identicon&r=PG&f=1", "display_name": "TheBigAmbiguous", "link": "https://stackoverflow.com/users/2946872/thebigambiguous"}, "edited": false, "score": 0, "creation_date": 1429743757, "post_id": 29782811, "comment_id": 47748922, "body": "Huh. Could&#39;ve swore I tried that and it didn&#39;t work. But now it works. Doesn&#39;t make sense. Anyway thanks for the answer!"}], "tags": [], "owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "is_accepted": true, "score": 3, "last_activity_date": 1429649863, "last_edit_date": 1429649863, "creation_date": 1429649221, "answer_id": 29782811, "question_id": 29781940, "link": "https://stackoverflow.com/questions/29781940/how-to-get-the-location-of-a-clicked-hyperlink/29782811#29782811", "title": "How to get the location of a clicked hyperlink?", "body": "<p>This seems to work for me:</p>\n\n<pre><code>Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)\n\n    Debug.Print Target.Range.Address\n\nEnd Sub\n</code></pre>\n\n<p>In your example I put a hyperlink in B4 by right-clicking --> Hyperlink --> Place in this Document --> Sheet1, cell reference X30.</p>\n\n<p>When I click the link the output I get in the immediate window is</p>\n\n<p><code>$B$4</code></p>\n\n<p>This is the address of where the hyperlink resides.</p>\n\n<p>Additionally, if you're going to be hyperlinking to other sheets and you want to see the 'parent' (or where the hyperlink originated from) sheet name you can use the following code:</p>\n\n<pre><code>Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)\n\n    Debug.Print \"'\" &amp; Target.Range.Parent.Name &amp; \"'!\" &amp; Target.Range.Address\n\nEnd Sub\n</code></pre>\n\n<p>In my quick test I put a hyperlink on Sheet3 that referenced cell A1 on Sheet1 and, when clicked, it returned</p>\n\n<p><code>'Sheet3'!$B$2</code></p>\n"}], "owner": {"reputation": 183, "user_id": 2946872, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5fa42752e3bedb6437ed2baec3f228b8?s=128&d=identicon&r=PG&f=1", "display_name": "TheBigAmbiguous", "link": "https://stackoverflow.com/users/2946872/thebigambiguous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2731, "favorite_count": 0, "accepted_answer_id": 29782811, "answer_count": 1, "score": 2, "last_activity_date": 1594106038, "creation_date": 1429646302, "last_edit_date": 1594106038, "question_id": 29781940, "link": "https://stackoverflow.com/questions/29781940/how-to-get-the-location-of-a-clicked-hyperlink", "title": "How to get the location of a clicked hyperlink?", "body": "<p>Suppose I have a hyperlink residing in cell B4 that will send the user to cell X30. The typical VBA hyperlink-clicking event only gives you access to the hyperlink's &quot;target&quot; (cell X30). But I want to obtain the <em>location</em> (cell B4) of the hyperlink, so that the code I run can be dependent on <em>where</em> the hyperlink physically is. Is there a way to do this?</p>\n<p>One option I've already tried is using the ActiveCell object. Problem is, for each hyperlink I would need to specify its own location <em>as</em> the target, because ActiveCell only operates <em>after</em> the hyperlink is followed, meaning it refers to the target, not the location. Actually doing this <em>could</em> work, since I only use the hyperlink as a macro-initiating button (not as a 'link'), but since I have so many of them and will be copy-pasting them, I would need a way of auto-specifying &quot;target = self&quot; or something (rather than &quot;target = B4&quot;).</p>\n"}, {"tags": ["vba", "excel", "pivot", "excel-2010"], "comments": [{"owner": {"reputation": 93, "user_id": 4570045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70bfa73fea7427e9819d28f1edf6c83?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Wickett", "link": "https://stackoverflow.com/users/4570045/mark-wickett"}, "edited": false, "score": 1, "creation_date": 1429671815, "post_id": 29781936, "comment_id": 47703579, "body": "Does <code>Sheet4</code> exist when you attempt to run this code? If so, what&#39;s on this worksheet before you run the code? It could be that it can&#39;t put the PivotTable in the location you&#39;re specifying. Also, what is the error message and number that you&#39;re getting?"}, {"owner": {"reputation": 3, "user_id": 4816499, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1EAZA.jpg?s=128&g=1", "display_name": "Fernando Zori", "link": "https://stackoverflow.com/users/4816499/fernando-zori"}, "reply_to_user": {"reputation": 93, "user_id": 4570045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70bfa73fea7427e9819d28f1edf6c83?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Wickett", "link": "https://stackoverflow.com/users/4570045/mark-wickett"}, "edited": false, "score": 0, "creation_date": 1429881333, "post_id": 29781936, "comment_id": 47822878, "body": "No, the Sheet4 doesn&#39;t exists. The error I&#39;m getting is 1004 Compile Error Expected: Expression focusing in the &quot;:=&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4816499, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1EAZA.jpg?s=128&g=1", "display_name": "Fernando Zori", "link": "https://stackoverflow.com/users/4816499/fernando-zori"}, "edited": false, "score": 0, "creation_date": 1430409970, "post_id": 29884731, "comment_id": 48064991, "body": "Thank you very much Mark! I&#39;ve followed your advice and now it works!"}], "tags": [], "owner": {"reputation": 93, "user_id": 4570045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70bfa73fea7427e9819d28f1edf6c83?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Wickett", "link": "https://stackoverflow.com/users/4570045/mark-wickett"}, "is_accepted": true, "score": 0, "last_activity_date": 1430090005, "creation_date": 1430090005, "answer_id": 29884731, "question_id": 29781936, "link": "https://stackoverflow.com/questions/29781936/compile-error-expected-expression-pivottable/29884731#29884731", "title": "Compile Error: Expected: Expression PivotTable", "body": "<p>You're missing the <code>_</code> symbol to carry over the statement to the next line. That will eliminate your compile error.</p>\n\n<p>However, I'd also look at ensuring your references to <code>Sheet4</code> are okay: when you add a new worksheet, there's no guarantee that Excel will call it <code>Sheet4</code>, so either you should force the name in the <code>.Add</code> statement, or don't explicitly refer to it as <code>Sheet4</code> after the creation of the pivot table. When Excel adds a sheet, the new sheet becomes the active one anyway.</p>\n"}], "owner": {"reputation": 3, "user_id": 4816499, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1EAZA.jpg?s=128&g=1", "display_name": "Fernando Zori", "link": "https://stackoverflow.com/users/4816499/fernando-zori"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1020, "favorite_count": 0, "accepted_answer_id": 29884731, "answer_count": 1, "score": 0, "last_activity_date": 1430090005, "creation_date": 1429646295, "last_edit_date": 1429648281, "question_id": 29781936, "link": "https://stackoverflow.com/questions/29781936/compile-error-expected-expression-pivottable", "title": "Compile Error: Expected: Expression PivotTable", "body": "<p>I'm currently having this issue while running VBA code. I've created code that downloads a report from SAP GUI and with that spreadsheet I need to create a PivotTable. I used the Macro Recorder to create the pivot but I'm having this issue while running it.</p>\n\n<pre><code>Range(\"A1\").Select\nRange(Selection, Selection.End(xlToRight)).Select\nRange(Selection, Selection.End(xlDown)).Select\nSheets.Add\nActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n    \"Sheet1!R1C1:R1500C18\", Version:=xlPivotTableVersion14).CreatePivotTable\n    TableDestination:=\"Sheet4!R3C1\", TableName:=\"PivotTable1\", DefaultVersion _\n    :=xlPivotTableVersion14\nSheets(\"Sheet4\").Select\nCells(3, 1).Select\nWith ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Company Code\")\n    .Orientation = xlRowField\n    .Position = 1\nEnd With\nWith ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"FI / MM Doc\")\n    .Orientation = xlRowField\n    .Position = 2\nEnd With\nActiveSheet.PivotTables(\"PivotTable1\").AddDataField ActiveSheet.PivotTables( _\n    \"PivotTable1\").PivotFields(\"Document number\"), \"Count of Document number\", _\n    xlCount\n</code></pre>\n\n<p>The issue appears in the <code>Tabledestination:=\"Sheet4!R3C1\"</code>, row showing up the \":=\" as an unexpected error.</p>\n\n<p>Do you guys know how can I solve this?</p>\n"}, {"tags": ["oracle", "vba", "excel", "adodb"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1429658856, "post_id": 29781931, "comment_id": 47699773, "body": "What type of query is <code>SQLFinal</code> (view/table) ? Are you using the exact same login across the computers which show different results? Is it always the same set of results which are missing, and is there anything specific about the missing results?"}, {"owner": {"reputation": 11, "user_id": 4816388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/944709c5ddb842d708d7c1e4563e14f3?s=128&d=identicon&r=PG&f=1", "display_name": "JNelson", "link": "https://stackoverflow.com/users/4816388/jnelson"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1429715530, "post_id": 29781931, "comment_id": 47731620, "body": "Hi Tim,  SQLFinal is a table query.  We are using the same database login across all of the computers. It is always the same set of results that are missing. I have not been able to identify any specific attribute that would make these results different."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1429719573, "post_id": 29781931, "comment_id": 47734681, "body": "If you convert the query to a &quot;select count(something) from...&quot; does it give the same number across the different machines?  Does the query involve any dates in the select clause ?"}, {"owner": {"reputation": 11, "user_id": 4816388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/944709c5ddb842d708d7c1e4563e14f3?s=128&d=identicon&r=PG&f=1", "display_name": "JNelson", "link": "https://stackoverflow.com/users/4816388/jnelson"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1429798045, "post_id": 29781931, "comment_id": 47778139, "body": "we are getting the same reduced set of values on some of the computers and on others we are getting the full set.  So while counts are the same for each group they differ between the two."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1429800977, "post_id": 29781931, "comment_id": 47780617, "body": "Have you tried switching to a DSN-less connection string?"}, {"owner": {"reputation": 11, "user_id": 4816388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/944709c5ddb842d708d7c1e4563e14f3?s=128&d=identicon&r=PG&f=1", "display_name": "JNelson", "link": "https://stackoverflow.com/users/4816388/jnelson"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1429810050, "post_id": 29781931, "comment_id": 47787341, "body": "I&#39;ll try that, is there a good resource on how to do this in VBA?  so far all of my attempts with a DSN-less connection string  have been unsuccessful."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1429824202, "post_id": 29781931, "comment_id": 47795836, "body": "As long as the Oracle client and drivers are installed then I&#39;ve not had any problem in the past.  Eg: a connection string like <code>Provider=OraOLEDB.Oracle;Password=PWHere;User ID=UserHere;Data Source=TNSEntryHere;</code> usually works no problem."}, {"owner": {"reputation": 11, "user_id": 4816388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/944709c5ddb842d708d7c1e4563e14f3?s=128&d=identicon&r=PG&f=1", "display_name": "JNelson", "link": "https://stackoverflow.com/users/4816388/jnelson"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1429890249, "post_id": 29781931, "comment_id": 47829598, "body": "This looks to have solved the problem, Which is great!!  Thanks a million Tim.   Do you know why doing this solves this problem?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1429892031, "post_id": 29781931, "comment_id": 47830776, "body": "You&#39;re using a lot of options in your original DSN-based connection string: I have no idea what any of those do, so it&#39;s difficult to suggest anything.  Also, without seeing the exact SQL there&#39;s a whole set of potential clues missing."}, {"owner": {"reputation": 274, "user_id": 463960, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4219687ab887c79d121e27e3a2612e92?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/463960/dave"}, "edited": false, "score": 0, "creation_date": 1452036972, "post_id": 29781931, "comment_id": 56991946, "body": "I had a similar problem that was solved by ensuring that the count(foo) item in the SELECT list, had an alias named for it, i.e. SELECT count(foo) as MyCount.  Someone knew that the lack of an alias can confuse ADODB."}], "owner": {"reputation": 11, "user_id": 4816388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/944709c5ddb842d708d7c1e4563e14f3?s=128&d=identicon&r=PG&f=1", "display_name": "JNelson", "link": "https://stackoverflow.com/users/4816388/jnelson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 535, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1429647243, "creation_date": 1429646279, "last_edit_date": 1429647243, "question_id": 29781931, "link": "https://stackoverflow.com/questions/29781931/vba-query-using-adodb-returning-different-results-on-different-computers", "title": "VBA Query using ADODB returning different results on different computers", "body": "<p>In VBA macro in Excel I have an issue where the exact same query with the exact same database credentials are returning different results depending on what computer the script is being executed.  Some pull all of the correct results, others have results missing.</p>\n\n<p>If we execute the query using Toad or any other tool that can execute oracle it has worked correctly on every machine tested.</p>\n\n<p>So far we have found out that the following things are not causing the issue:</p>\n\n<ul>\n<li>Oracle Driver version (instant client vs full both tested no correlation found)</li>\n<li>Excel versions (everyone at my company has the same build of excel)</li>\n<li>VBA project references are the same. </li>\n<li>Confirmed all machines are pointing to the correct database.</li>\n<li>ODBC Settings are the same</li>\n</ul>\n\n<p>All machines tested are running Excel 2010 on windows 7, The Database is Oracle 11, </p>\n\n<p>Here is the script</p>\n\n<pre><code>Dim cn\nSet cn = CreateObject(\"ADODB.Connection\")\nDim rs\nSet rs = CreateObject(\"ADODB.Recordset\")\ncn.ConnectionString = \"DSN=#####;UID=####;PWD=#####;DBQ=######;DBA=W;APA=T;EXC=F;FEN=T;QTO=T;FRC=10;FDL=10;LOB=T;RST=T;BTD=F;BNF=F;BAM=IfAllSuccessful;NUM=NLS;DPM=F;MTS=T;MDI=F;CSR=F;FWC=F;FBS=64000;TLO=O;MLD=0;ODA=F\"`  \n\n`cn.Open`\n\n`Set rs = cn.Execute(SQLfinal)`\n\nDim iCol As Integer\nDim iRow As Integer\n\nfldCount = rs.Fields.Count\nFor iCol = 1 To fldCount\n    Sheets(\"8. Data\").Cells(12, iCol).Value = rs.Fields(iCol - 1).Name\nNext    \nSheets(\"8. ####\").Cells(13, 1).CopyFromRecordset rs \nrs.Close\n\nSet rs = Nothing\ncn.Close\n\nRows(\"12:12\").Select\nSelection.AutoFilter\nWith Selection.Interior\n    .Pattern = xlSolid\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorAccent1\n    .TintAndShade = 0.599993896298105\n    .PatternTintAndShade = 0\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2010"], "answers": [{"comments": [{"owner": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "edited": false, "score": 0, "creation_date": 1429644746, "post_id": 29781464, "comment_id": 47692959, "body": "This has to be done with vba since this is only one step in my macro and this also has to be run on multiple sheets"}, {"owner": {"reputation": 956, "user_id": 3469496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/4jWVm.jpg?s=128&g=1", "display_name": "CactusCake", "link": "https://stackoverflow.com/users/3469496/cactuscake"}, "edited": false, "score": 3, "creation_date": 1429645164, "post_id": 29781464, "comment_id": 47693248, "body": "Have you tried recording a macro, hitting that very same &quot;remove duplicates&quot; button and then seeing what code it gives you?"}], "tags": [], "owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "is_accepted": false, "score": 1, "last_activity_date": 1429644660, "creation_date": 1429644660, "answer_id": 29781464, "question_id": 29781415, "link": "https://stackoverflow.com/questions/29781415/find-each-different-cells-value-in-a-specific-column/29781464#29781464", "title": "Find each different cells value in a specific column", "body": "<p>Under the \"Data\" tab, choose \"Remove Duplicates\".</p>\n"}, {"tags": [], "owner": {"reputation": 344, "user_id": 1445609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba139f5c8152aeb92705236e7faa53d0?s=128&d=identicon&r=PG", "display_name": "davidmneedham", "link": "https://stackoverflow.com/users/1445609/davidmneedham"}, "is_accepted": false, "score": 0, "last_activity_date": 1429645171, "creation_date": 1429645171, "answer_id": 29781612, "question_id": 29781415, "link": "https://stackoverflow.com/questions/29781415/find-each-different-cells-value-in-a-specific-column/29781612#29781612", "title": "Find each different cells value in a specific column", "body": "<p>The VBA method RemoveDuplicates operates on a Range and does the same thing as the menu option.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff193823(v=office.14).aspx\" rel=\"nofollow\">Microsoft MSDN Reference for Excel 2010 RemoveDuplicates</a></p>\n"}, {"comments": [{"owner": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "edited": false, "score": 0, "creation_date": 1429705246, "post_id": 29781659, "comment_id": 47722848, "body": "This works perfectly, but the example I had in my question is not exactly what I have in my sheet. I updated my question now to show you. There is a space between every product and I don&#39;t want the space to be copied."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "edited": false, "score": 0, "creation_date": 1429711484, "post_id": 29781659, "comment_id": 47728147, "body": "@phil652  See my <b>EDIT#1</b>"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1429711458, "last_edit_date": 1429711458, "creation_date": 1429645313, "answer_id": 29781659, "question_id": 29781415, "link": "https://stackoverflow.com/questions/29781415/find-each-different-cells-value-in-a-specific-column/29781659#29781659", "title": "Find each different cells value in a specific column", "body": "<p>Give this a try:</p>\n\n<pre><code>Sub Macro1()\n    Selection.Copy\n    Range(\"A1:A12\").Copy Range(\"H1\")\n    ActiveSheet.Range(\"$H$1:$H$12\").RemoveDuplicates Columns:=1, Header:=xlNo\nEnd Sub\n</code></pre>\n\n<p><strong><em>EDIT#1:</em></strong></p>\n\n<p>To get rid of the spaces, use this instead:</p>\n\n<pre><code>Sub Macro1()\n    Selection.Copy\n    Range(\"A1:A12\").Copy Range(\"H1\")\n    Range(\"$H$1:$H$12\").RemoveDuplicates Columns:=1, Header:=xlNo\n    Range(\"$H$1:$H$12\").Cells.SpecialCells(xlCellTypeBlanks).Delete\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 29781659, "answer_count": 3, "score": 0, "last_activity_date": 1429711458, "creation_date": 1429644484, "last_edit_date": 1429704485, "question_id": 29781415, "link": "https://stackoverflow.com/questions/29781415/find-each-different-cells-value-in-a-specific-column", "title": "Find each different cells value in a specific column", "body": "<p>Sorry if this have been ask before. I don't really know what to look for. I have an excel sheet where on column A I have something that looks like this</p>\n\n<pre><code>       A\n________________  \n1 |  Banana\n2 |  Banana\n3 |  Banana\n4 |  Banana\n5 |\n6 |  Potato\n7 |  Potato\n8 |  Potato\n9 |  Potato\n10|\n11|  Noodles\n12|  Noodles\n13|  Noodles\n14|  Noodles\n</code></pre>\n\n<p>But I want to change it to</p>\n\n<pre><code>       H\n________________  \n1 |  Banana\n2 |  Potato\n3 |  Noodles\n</code></pre>\n\n<p>I know how to find a word in a column but I don't know how to find all the different ones. Is there an easy way to do this?</p>\n"}, {"tags": ["vba", "ms-word", "paste"], "answers": [{"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 1, "last_activity_date": 1429669661, "creation_date": 1429669661, "answer_id": 29786662, "question_id": 29781261, "link": "https://stackoverflow.com/questions/29781261/word-paste-behavior-not-the-same-in-vba/29786662#29786662", "title": "Word Paste Behavior Not the Same in VBA", "body": "<p>The problem is likely the default behaviour of Word to add a hyperlink if it recognizes that the text you pasted is a URL.  If you're doing this in a loop, it does the same thing as if you put the cursor at the end of the URL and hit the space-bar.</p>\n\n<p>The easiest way to avoid this is to just operate on the hyperlink <em>Ranges</em> themselves and just change the text property.  When you change HyperLink.Range.Text, it has the side effect of also removing the hyperlink at the same time.</p>\n\n<p>Give this a shot:</p>\n\n<pre><code>Sub Replace_w_URLs()\n\n    Dim url As Range\n    Do While Selection.Hyperlinks.Count &gt; 0\n        Set url = Hyperlinks(1).Range.Duplicate\n        url.Text = Hyperlinks(1).Address\n    Loop\n\nEnd Sub\n</code></pre>\n\n<p>It should replace all of the hyperlinks in your Selection with the underlying URLs.</p>\n"}], "owner": {"reputation": 33, "user_id": 4342530, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1111038641/picture?type=large", "display_name": "Vince Earl", "link": "https://stackoverflow.com/users/4342530/vince-earl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1594069686, "creation_date": 1429644011, "last_edit_date": 1594069686, "question_id": 29781261, "link": "https://stackoverflow.com/questions/29781261/word-paste-behavior-not-the-same-in-vba", "title": "Word Paste Behavior Not the Same in VBA", "body": "<p>I have a document with a number of embedded hyperlinks to convert to plain hyperlinks. Whether they get pasted as clickable URLs or plaintext URLs doesn't matter, as long as it's actually displaying the URL.</p>\n\n<p>For example, I need to change <a href=\"http://en.wikipedia.org/wiki/Microsoft_Word\" rel=\"nofollow\">Microsoft Word</a> to <a href=\"http://en.wikipedia.org/wiki/Microsoft_Word\" rel=\"nofollow\">http://en.wikipedia.org/wiki/Microsoft_Word</a> (either clickable or not).</p>\n\n<p>In Word, if I select the hyperlink, right click, choose \"copy hyperlink,\" then paste special, text only, I get the optimal result (non-clickable URL). If I record VBA code that does the exact same thing, the result is the original embedded link. I've played with various options: turning off smart paste, cut and paste, turning off autoformat of hyperlinks, changing the default paste options, but none of these change my end result. </p>\n\n<pre><code>Sub Replace_w_URLs()\n'\n' Replace_w_URLs Macro\n'\n'\nSelection.NextField.Select\nSelection.Range.Hyperlinks(1).Range.Fields(1).Result.Select\nSelection.Copy\nSelection.TypeBackspace\nSelection.PasteSpecial Link:=False, DataType:=20, Placement:=wdInLine, _\n    DisplayAsIcon:=False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "copy-paste"], "comments": [{"owner": {"reputation": 956, "user_id": 3469496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/4jWVm.jpg?s=128&g=1", "display_name": "CactusCake", "link": "https://stackoverflow.com/users/3469496/cactuscake"}, "edited": false, "score": 1, "creation_date": 1429644390, "post_id": 29781214, "comment_id": 47692763, "body": "Does it still get as far as bringing up the dialog? If it&#39;s running too fast and skipping something then you may need to add a <code>Do Events</code> line to slow it down enough to finish one operation before starting the next."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1429649706, "post_id": 29781214, "comment_id": 47695806, "body": "What about using <code>WSCopy.Range(&quot;A1:BZ5000&quot;)</code> ?"}, {"owner": {"reputation": 57, "user_id": 4560920, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cab58c95eb1ee09944d2b165cda8a6ef?s=128&d=identicon&r=PG&f=1", "display_name": "B West", "link": "https://stackoverflow.com/users/4560920/b-west"}, "reply_to_user": {"reputation": 956, "user_id": 3469496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/4jWVm.jpg?s=128&g=1", "display_name": "CactusCake", "link": "https://stackoverflow.com/users/3469496/cactuscake"}, "edited": false, "score": 0, "creation_date": 1429683935, "post_id": 29781214, "comment_id": 47707756, "body": "@JoeMalpass, it makes sense that something might be getting skipped. That would explain why it would work when stepping through but not from a command button. I do get to the filedialog and the chosen workbook opens but nothing gets copied.  Where should I add the &quot;Do Events&quot;? Post an answer with your suggestion so I can select it as the answer."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 4560920, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cab58c95eb1ee09944d2b165cda8a6ef?s=128&d=identicon&r=PG&f=1", "display_name": "B West", "link": "https://stackoverflow.com/users/4560920/b-west"}, "edited": false, "score": 0, "creation_date": 1430156650, "post_id": 29799785, "comment_id": 47927650, "body": "I&#39;ve tried moving the <code>DoEvents</code> loop to different places and it still does the same thing. It opens the file to be copied and then just exits the subroutine. I think that I have isolated the problem to the line <code>If StrComp(WSCopy.CodeName, &quot;Sheet1&quot;, vbTextCompare) = 0 Then</code>. If I comment that line (and the &quot;end if&quot;), everything works fine."}], "tags": [], "owner": {"reputation": 956, "user_id": 3469496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/4jWVm.jpg?s=128&g=1", "display_name": "CactusCake", "link": "https://stackoverflow.com/users/3469496/cactuscake"}, "is_accepted": false, "score": 0, "last_activity_date": 1429710880, "creation_date": 1429710880, "answer_id": 29799785, "question_id": 29781214, "link": "https://stackoverflow.com/questions/29781214/frustration-with-vba-copy-paste-from-workbook-to-workbook/29799785#29799785", "title": "Frustration with VBA copy-paste from workbook to workbook", "body": "<p>If my suspicion is correct and the macro is getting ahead of itself, this should slow it down enough to execute properly. My best guess is that is is not allowing time for the value in <code>stReport</code> to be set, so I have put a loop there, but you may need to try moving it around. You can test to see where the macro runs away from itself by setting a bunch of breakpoints and seeing which ones allow you to successfully resume the rest of the script after stopping at, and which ones leave it broken.</p>\n\n<p>I'm fairly new to <code>DoEvents</code> myself and I'm aware it can be CPU intensive if not used properly, so save your work before testing this just in case you need to force close.</p>\n\n<pre><code>'Must have reference to \"Microsoft Scripting Runtime\" checked\nDim fso As New FileSystemObject \nDim wsData as Worksheet\nDim stPDFName As String\nDim stFileName As String\nDim stReport As String\nDim WSCopy As Worksheet\nDim FD As Office.FileDialog\nSet wsData = ThisWorkbook.Sheets(\"Sheet1\")\nSet FD = Application.FileDialog(msoFileDialogFilePicker)\n    FD.InitialFileName = \"J:\\Laboratory\\Reports\\2015\" \n    FD.Show\n\n        Do Until Not(IsEmpty(stReport))\n            stReport = FD.SelectedItems(1)\n            DoEvents\n        Loop\n\n    stFileName = fso.GetFileName(stReport)\n    stPDFName = Left$(stReport, InStrRev(stReport, \".\") - 1) &amp; \".pdf\"\nIf Dir(stPDFName) = \"\" Then\n    MsgBox \"Matching PDF version of this report does not exist\":\n    Exit Sub\nElse\n    Workbooks.Open (stReport)\n    For Each WSCopy In Workbooks(stFileName).Worksheets\n    If StrComp(WSCopy.CodeName, \"Sheet1\", vbTextCompare) = 0 Then\n        WSCopy.Range(\"A1\", \"BZ5000\").Copy\n        wsData.Range(\"E2\").PasteSpecial\n        wsData.Columns.AutoFit\n        Workbooks(stFileName).Close\n        Exit For\n\n    End If\nNext WSCopy\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 4560920, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cab58c95eb1ee09944d2b165cda8a6ef?s=128&d=identicon&r=PG&f=1", "display_name": "B West", "link": "https://stackoverflow.com/users/4560920/b-west"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 378, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1430243890, "creation_date": 1429643852, "last_edit_date": 1430243890, "question_id": 29781214, "link": "https://stackoverflow.com/questions/29781214/frustration-with-vba-copy-paste-from-workbook-to-workbook", "title": "Frustration with VBA copy-paste from workbook to workbook", "body": "<p>I've been trying to figure out this subroutine for days. I have read every post about VBA copy-paste on this site and haven't found the answer yet. The concept is so simple but when I run it from a command button, it stops after the copy workbook opens, the copy doesn't execute.  When I step through in debug, it works as expected. Does anyone see any obvious errors?</p>\n\n<pre><code>'Must have reference to \"Microsoft Scripting Runtime\" checked\nDim fso As New FileSystemObject \nDim wsData as Worksheet\nDim stPDFName As String\nDim stFileName As String\nDim stReport As String\nDim WSCopy As Worksheet\nDim FD As Office.FileDialog\nSet wsData = ThisWorkbook.Sheets(\"Sheet1\")\nSet FD = Application.FileDialog(msoFileDialogFilePicker)\n        FD.InitialFileName = \"J:\\Laboratory\\Reports\\2015\" \n        FD.Show\n        stReport = FD.SelectedItems(1)\n        stFileName = fso.GetFileName(stReport)\n        stPDFName = Left$(stReport, InStrRev(stReport, \".\") - 1) &amp; \".pdf\"\n    If Dir(stPDFName) = \"\" Then\n        MsgBox \"Matching PDF version of this report does not exist\":\n        Exit Sub\n    Else\n        Workbooks.Open (stReport)\n        For Each WSCopy In Workbooks(stFileName).Worksheets\n        If StrComp(WSCopy.CodeName, \"Sheet1\", vbTextCompare) = 0 Then\n            WSCopy.Range(\"A1\", \"BZ5000\").Copy\n            wsData.Range(\"E2\").PasteSpecial\n            wsData.Columns.AutoFit\n            Workbooks(stFileName).Close\n            Exit For\n\n        End If\n    Next WSCopy\n    End If\n</code></pre>\n\n<p>Edit: I believe that I have narrowed down the problem to the line:\n     <code>If StrComp(WSCopy.CodeName, \"Sheet1\", vbTextCompare) = 0 Then</code>\nWhen I step through the routine, the <code>StrComp</code> evaluates properly. If I comment out the <code>If/End If</code> lines, the routine works as expected. I use this line to avoid problems that occur when someone moves or renames a worksheet. </p>\n"}, {"tags": ["excel", "vba", "ibm-midrange"], "comments": [{"owner": {"reputation": 2797, "user_id": 1867590, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/np7f8.png?s=128&g=1", "display_name": "JFS", "link": "https://stackoverflow.com/users/1867590/jfs"}, "edited": false, "score": 0, "creation_date": 1429642665, "post_id": 29780415, "comment_id": 47691707, "body": "Wow! What kind of VBA stuff is that. I&#39;ve never seen that before. Cool!"}, {"owner": {"reputation": 215, "user_id": 2850760, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bbeeff90a4dd9aca3b0c90359456b617?s=128&d=identicon&r=PG&f=1", "display_name": "Kurt Marshman", "link": "https://stackoverflow.com/users/2850760/kurt-marshman"}, "reply_to_user": {"reputation": 2797, "user_id": 1867590, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/np7f8.png?s=128&g=1", "display_name": "JFS", "link": "https://stackoverflow.com/users/1867590/jfs"}, "edited": false, "score": 0, "creation_date": 1429643052, "post_id": 29780415, "comment_id": 47691954, "body": "lol... you at least broke up my day."}, {"owner": {"reputation": 2590, "user_id": 4507417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a027c3ea839c86e05de0c5f22fc6a7d0?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Stejskal", "link": "https://stackoverflow.com/users/4507417/marek-stejskal"}, "edited": false, "score": 1, "creation_date": 1429644299, "post_id": 29780415, "comment_id": 47692707, "body": "Is there any reason why you wouldn&#39;t create the combination of the queries on the server?"}, {"owner": {"reputation": 215, "user_id": 2850760, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bbeeff90a4dd9aca3b0c90359456b617?s=128&d=identicon&r=PG&f=1", "display_name": "Kurt Marshman", "link": "https://stackoverflow.com/users/2850760/kurt-marshman"}, "edited": false, "score": 0, "creation_date": 1429644526, "post_id": 29780415, "comment_id": 47692840, "body": "yes....I do not have that ability/access.... at best I would have to bring them in to MS Access and create it."}, {"owner": {"reputation": 3101, "user_id": 167478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f77f8328db85911cfbfba4662bb73?s=128&d=identicon&r=PG", "display_name": "Fink", "link": "https://stackoverflow.com/users/167478/fink"}, "edited": false, "score": 0, "creation_date": 1429649489, "post_id": 29780415, "comment_id": 47695663, "body": "An alternative would be to write the recordset to a worksheet within the workbook, then base the pivot table off the local worksheet data."}, {"owner": {"reputation": 215, "user_id": 2850760, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bbeeff90a4dd9aca3b0c90359456b617?s=128&d=identicon&r=PG&f=1", "display_name": "Kurt Marshman", "link": "https://stackoverflow.com/users/2850760/kurt-marshman"}, "reply_to_user": {"reputation": 3101, "user_id": 167478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f77f8328db85911cfbfba4662bb73?s=128&d=identicon&r=PG", "display_name": "Fink", "link": "https://stackoverflow.com/users/167478/fink"}, "edited": false, "score": 0, "creation_date": 1429649571, "post_id": 29780415, "comment_id": 47695718, "body": "@Fink I was able to figure it out.  I will post the fix."}], "answers": [{"tags": [], "owner": {"reputation": 215, "user_id": 2850760, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bbeeff90a4dd9aca3b0c90359456b617?s=128&d=identicon&r=PG&f=1", "display_name": "Kurt Marshman", "link": "https://stackoverflow.com/users/2850760/kurt-marshman"}, "is_accepted": false, "score": 0, "last_activity_date": 1429687334, "last_edit_date": 1429687334, "creation_date": 1429650295, "answer_id": 29783088, "question_id": 29780415, "link": "https://stackoverflow.com/questions/29780415/build-refreshable-query-from-multiple-connections-as400-ibmi/29783088#29783088", "title": "Build Refreshable Query From Multiple Connections AS400 IBMi", "body": "<p>Well, I figured this out.  Instead of adding connections that already existed, I added a new one and defined it.</p>\n\n<pre><code>\"Test\" is the name of the connection\n\"x\" is the description\n\"Conn\" is the connection string\n\"Cmdarray\" is the sql\n\nSub CreatePivotTable()\nDim Cmdarray\nDim Conn\n\nCmdarray = Array(\"SELECT ISWH as WH, ISPART as Part,PMDESC as Description, ISCF01 as AC FROM \"\"PRD\"\".\"\"Y2K\"\".\"\"IS\"\" LEFT JOIN \"\"PRD\"\".\"\"Y2K\"\".\"\"PM\"\" ON \"\"PRD\"\".\"\"Y2K\"\".\"\"IS\"\".ISPART = \"\"PRD\"\".\"\"Y2K\"\".\"\"PM\"\".PMPART WHERE (ISWH) IN ('XX')\")\n\nConn = \"ODBC;DSN=s111111111;\"\n\nActiveWorkbook.Connections.Add \"Test\", \"x\", Conn, Cmdarray\n\nActiveWorkbook.PivotCaches.Create(SourceType:=xlExternal, SourceData:= _\n    ActiveWorkbook.Connections(\"Test\"), Version:=xlPivotTableVersion14). _\n    CreatePivotTable TableDestination:=ActiveCell, TableName:=\"PivotTable1\", DefaultVersion:=xlPivotTableVersion14\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 215, "user_id": 2850760, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bbeeff90a4dd9aca3b0c90359456b617?s=128&d=identicon&r=PG&f=1", "display_name": "Kurt Marshman", "link": "https://stackoverflow.com/users/2850760/kurt-marshman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 302, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1429687334, "creation_date": 1429641250, "last_edit_date": 1429648745, "question_id": 29780415, "link": "https://stackoverflow.com/questions/29780415/build-refreshable-query-from-multiple-connections-as400-ibmi", "title": "Build Refreshable Query From Multiple Connections AS400 IBMi", "body": "<p>My attempt was to create a simple PivotTable on the fly from multiple tables from an AS400 IBMi. That was achieved, but the PivotTable is not \"refreshable\".</p>\n\n<p>So I started looking at posts about programmatically creating connections and came up with the example below that is refreshable, but to only one table:</p>\n\n<pre><code>    ActiveWorkbook.Connections.AddFromFile \"N:\\apps\\excel\\connections\\PRD IS.odc\"\nWith ActiveWorkbook.Connections(\"PRD IS\").ODBCConnection\n    .BackgroundQuery = True\n    .CommandText = Array(\"SELECT * FROM \"\"PRD\"\".\"\"Y2K\"\".\"\"IS\"\"\")\n    .CommandType = xlCmdSql\n    .Connection = \"ODBC;DSN=s11111111;\"\n    .RefreshOnFileOpen = False\n    .SavePassword = False\n    .SourceConnectionFile = \"N:\\apps\\excel\\connections\\PRD IS.odc\"\n    .SourceDataFile = \"\"\n    .ServerCredentialsMethod = xlCredentialsMethodIntegrated\n    .AlwaysUseConnectionFile = False\nEnd With\nWith ActiveWorkbook.Connections(\"PRD IS\")\n    .Name = \"PRD IS\"\nEnd With\n\n    ActiveWorkbook.PivotCaches.Create(SourceType:=xlExternal, SourceData:= _\n    ActiveWorkbook.Connections(\"PRD IS\"), Version:=xlPivotTableVersion14). _\n    CreatePivotTable TableDestination:=ActiveCell, TableName:=\"PivotTable1\", DefaultVersion:=xlPivotTableVersion14\n</code></pre>\n\n<p>Is it possible to use two connections, combine them, and create the final result that is refreshable?</p>\n\n<p>The second connection would be:</p>\n\n<pre><code>      ActiveWorkbook.Connections.AddFromFile \"N:\\apps\\excel\\connections\\PRD PM.odc\"\nWith ActiveWorkbook.Connections(\"PRD PM\").ODBCConnection\n    .BackgroundQuery = True\n    .CommandText = Array(\"SELECT * FROM \"\"PRD\"\".\"\"Y2K\"\".\"\"PM\"\"\")\n    .CommandType = xlCmdSql\n    .Connection = \"ODBC;DSN=s111111111;\"\n    .RefreshOnFileOpen = False\n    .SavePassword = False\n    .SourceConnectionFile = \"N:\\apps\\excel\\connections\\PRD PM.odc\"\n    .SourceDataFile = \"\"\n    .ServerCredentialsMethod = xlCredentialsMethodIntegrated\n    .AlwaysUseConnectionFile = False\nEnd With\nWith ActiveWorkbook.Connections(\"PRD PM\")\n    .Name = \"PRD PM\"\nEnd With \n</code></pre>\n\n<p>Currently working code:</p>\n\n<pre><code>Sub CreatePivotTable()\n'Declare variables\nDim Conn As ADODB.Connection\nDim Cmd As ADODB.Command\nDim Param As ADODB.Parameter\nDim rs As ADODB.Recordset\n\nSet Conn = New ADODB.Connection\nSet Cmd = New ADODB.Command\nSet rs = New ADODB.Recordset\n\n'Open Connection'\nConn.ConnectionString = \"DSN=s11111111;\"\nConn.Open\n\n'Set and Excecute SQL Command'\nSet Cmd.ActiveConnection = Conn\n\nCmd.CommandText = \"SELECT ISWH as WH,ISPART as Part,PMDESC as Description,ISCF01 As AC, PMPCLS As PC, PMPLIN As PL\" &amp; _\n\" FROM Y2K.IS LEFT JOIN Y2K.PM ON Y2K.IS.ISPART = Y2K.PM.PMPART\" &amp; _\n\" WHERE(ISWH) in ('XX')\" &amp; _\n\" AND (ISCF01) not in ('B','D')\" &amp; _\n\" AND (PMPLIN) in ('YY')\" &amp; _\n\" AND (PMPCLS) like ('Z%')\"\n\nCmd.CommandType = adCmdText\n\n'Open Recordset'\nSet rs.Source = Cmd\nrs.Open\n\n'Create a PivotTable cache and report.\nSet objPivotCache = ActiveWorkbook.PivotCaches.Add(SourceType:=xlExternal)\nSet objPivotCache.Recordset = rs\nobjPivotCache.CreatePivotTable TableDestination:=ActiveCell, TableName:=\"PivotTable1\"\n\nWith ActiveSheet.PivotTables(\"PivotTable1\")\n    .SmallGrid = False\n    With .PivotFields(\"WH\")\n        .Orientation = xlRowField\n        .Position = 1\n    End With\n    With .PivotFields(\"Part\")\n        .Orientation = xlRowField\n        .Position = 1\n    End With\n    With .PivotFields(\"PL\")\n        .Orientation = xlColumnField\n        .Position = 1\n    End With\n    With .PivotFields(\"PC\")\n        .Orientation = xlDataField\n        .Position = 1\n    End With\n End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql-server", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 2983064, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/108929de6cc4850bd1803f882331e395?s=128&d=identicon&r=PG&f=1", "display_name": "user2983064", "link": "https://stackoverflow.com/users/2983064/user2983064"}, "edited": false, "score": 0, "creation_date": 1429642309, "post_id": 29780595, "comment_id": 47691501, "body": "No unfortunately not, the database is 100 million rows. Im not sure it is the constant connections, because if I use the workbook for 7000 files it ends up really slow and never speeds up again. but if I paste all the code into a new workbook and run it fresh, then it goes back to being very fast. So I think there is something Im not deleting after each connection that is slowing it all down."}], "tags": [], "owner": {"reputation": 111, "user_id": 4802868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7053c9d9457583a9a26b3711a3076311?s=128&d=identicon&r=PG&f=1", "display_name": "NikG", "link": "https://stackoverflow.com/users/4802868/nikg"}, "is_accepted": false, "score": 0, "last_activity_date": 1429641765, "creation_date": 1429641765, "answer_id": 29780595, "question_id": 29780394, "link": "https://stackoverflow.com/questions/29780394/sql-query-loop-slowing-over-time/29780595#29780595", "title": "SQL query loop slowing over time", "body": "<p>I would guess the slowdown is caused by connecting to/disconnecting from the database 7000 times... Is it possible to run the query once to pull the entire Mastertable_proc into Excel and then use a loop to process and save each unique Compnumber?</p>\n"}], "owner": {"reputation": 5, "user_id": 2983064, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/108929de6cc4850bd1803f882331e395?s=128&d=identicon&r=PG&f=1", "display_name": "user2983064", "link": "https://stackoverflow.com/users/2983064/user2983064"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 150, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429648896, "creation_date": 1429641197, "last_edit_date": 1429648896, "question_id": 29780394, "link": "https://stackoverflow.com/questions/29780394/sql-query-loop-slowing-over-time", "title": "SQL query loop slowing over time", "body": "<p>I have a database stored locally and am using Excel to get small tables from it, which I then process, format etc and save as flat files. There are about 7,000 files I need from it.</p>\n\n<p>The process starts off very fast, but over time it slows down and each file ends up taking about 10x the time of the first ones. Here is the loop:</p>\n\n<pre><code>        For i = firstrow + 1 To lastrow\n\n    RemoveConnections\n    Application.CutCopyMode = False\n\n        'Get annual data\n\n        Sheets(\"data\").Cells.Delete\n        sqlstring1 = \"SELECT [compnumber],[mapcode],[amount],[reportd],[reportm],[reporty]  FROM [Mergent].[dbo].[Mastertable_proc]\" &amp; _\n        \"WHERE Compnumber = '\" &amp; Sheets(\"list\").Cells(i, 1).Value &amp; \"' and reporttype='A';\"\n        connstring = _\n        \"ODBC;Driver=SQL Server;Server=MY-PC;UID=Andy;Trusted_Connection=Yes;Database=DataM\"\n        With Sheets(\"data\").QueryTables.Add(Connection:=connstring, Destination:=Sheets(\"data\").Range(\"a1\"), Sql:=sqlstring1)\n        .RefreshStyle = xlOverwriteCells\n        .Refresh BackgroundQuery:=False\n        End With\n\n...\n\nprocesses data and saves file\n\n...\n\nnext i\n</code></pre>\n\n<p>The following Remove Connections macro is called at the start of each loop to drop all the existing connections:</p>\n\n<pre><code>Sub RemoveConnections()\nDim xConnect As Object\nOn Error Resume Next\nFor Each xConnect In ActiveWorkbook.Connections\nxConnect.Delete\nNext xConnect\nFor Each listobj In Sheets(\"data\").ListObjects\nlistobj.Delete\nNext listobj\nEnd Sub\n</code></pre>\n\n<p>I'm fairly sure the processing itself and saving files isn't the problem, as I can run the macro without it all and it still slows over time.</p>\n\n<p>Anyone have any ideas why this is slowing down? I notice that SQLserver.exe takes up more and more RAM on my computer as time goes by, but I am still well within my maximum when it slows, but it tells me I'm doing something wrong in the loop like not closing a connection or something.</p>\n\n<p>I have also tried a version which edits a single connection in each loop, so doesn't create a new one each time, yet it still slows over time and I have no idea why.</p>\n"}, {"tags": ["arrays", "excel", "vba", "xml-parsing"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1429640277, "post_id": 29779847, "comment_id": 47690312, "body": "Would help to show more of your code."}, {"owner": {"reputation": 181, "user_id": 4643092, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-AItmzNvImlw/AAAAAAAAAAI/AAAAAAAAAEY/eXrF39bZ1Dk/photo.jpg?sz=128", "display_name": "NRH", "link": "https://stackoverflow.com/users/4643092/nrh"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1429642140, "post_id": 29779847, "comment_id": 47691400, "body": "@TimWilliams Sorry, I forgot to add it earlier."}], "answers": [{"tags": [], "owner": {"reputation": 181, "user_id": 4643092, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-AItmzNvImlw/AAAAAAAAAAI/AAAAAAAAAEY/eXrF39bZ1Dk/photo.jpg?sz=128", "display_name": "NRH", "link": "https://stackoverflow.com/users/4643092/nrh"}, "is_accepted": false, "score": 0, "last_activity_date": 1429643805, "creation_date": 1429643805, "answer_id": 29781196, "question_id": 29779847, "link": "https://stackoverflow.com/questions/29779847/print-arrays-one-after-the-other/29781196#29781196", "title": "Print arrays one after the other", "body": "<p>I just realized my error.. and it's due to confusion of variable names.</p>\n\n<p>The lesson here is to not have awful and similar variable names. </p>\n"}], "owner": {"reputation": 181, "user_id": 4643092, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-AItmzNvImlw/AAAAAAAAAAI/AAAAAAAAAEY/eXrF39bZ1Dk/photo.jpg?sz=128", "display_name": "NRH", "link": "https://stackoverflow.com/users/4643092/nrh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429649075, "creation_date": 1429639335, "last_edit_date": 1429649075, "question_id": 29779847, "link": "https://stackoverflow.com/questions/29779847/print-arrays-one-after-the-other", "title": "Print arrays one after the other", "body": "<p>I'm having a hard time figuring out how to print a group - say three - arrays one after the other.</p>\n\n<pre><code>Node A\n    Element 1\n    Element 2\n    Element 3\nNode B\n    Element 1\n    Element 2\n    Element 3\n    Element 4\nNode C\n    Element 1\n    Element 2\n    Element 3\n</code></pre>\n\n<p>Each node has different attributes, so my code is set up to go to each node with that specific attribute and populate an array. But when I go to print, each statement just overlaps the next. I can't figure out how to print the arrays without just shifting the starting cell.</p>\n\n<p>For example,</p>\n\n<pre><code>Range(\"A\" &amp; j + 3).Value = WorksheetFunction.Transpose(myArray1)\nRange(\"B\" &amp; j + 3).Value = WorksheetFunction.Transpose(myArray2)\n</code></pre>\n\n<p>I want to start printing at A3 and increment by <code>j</code>, but all this does is push the printing to A5 (if j = 2). I know that I have to increment, I just don't know how.</p>\n\n<p>Edit: Here's my main chunk of code:</p>\n\n<pre><code>For i = 0 To (count - 1)\nReDim Preserve NodeIDArray(0 To count)\nReDim Preserve NodeVersionArray(0 To count)\nReDim Preserve NodeIDArray_v13(0 To count)\nReDim Preserve NodeIDArray_v14(0 To count)\nReDim Preserve NodeID_Version13(0 To count)\nReDim Preserve NodeID_Version14(0 To count)\nReDim Preserve NodeIDNameArray(0 To count)\nReDim Preserve CellIDArray(0 To count)\n\nIf NodeVersionArray(i) = \"13\" Then\n    NodeID_Version13 = NodeIDArray(i)\n    NodeIDArray_v13(i) = NodeID_Version13\n    Node_Version13 = NodeVersionArray(i)\n    NodeID_Version13(i) = Node_Version13\n\n\n    Set version13_loc = XMLFile.SelectNodes(\"/home/Equipment[@id='\" &amp; NodeID_Version13 &amp; \"' and @version='\" &amp; Node_Version13 &amp; \"']/room/cell\")\n    Set version_13_count = XMLFile.SelectNodes(\"/home/Equipment[@version='13']\")\n    For j = 0 To (version13_loc.Length - 1)\n        ReDim Preserve CellIDArray(0 To j)\n        ReDim Preserve NodeIDNameArray(0 To j)\n        ReDim Preserve CellIDNameArray13(0 To j)\n        ReDim Preserve NodeIDNameArray13(0 To j)\n\n        CellID = version13_loc(j).getAttribute(\"id\")\n        NodeIDName = version13_loc(j).ParentNode.ParentNode.getAttribute(\"id\")\n        CellIDArray(j) = CellID\n        NodeIDNameArray(j) = NodeIDName\n\n        v13Count = version_13_count.Length\n\n        Range(\"A\" &amp; j + 3).Value = WorksheetFunction.Transpose(NodeIDNameArray)\n        Range(\"B\" &amp; j + 3).Value = WorksheetFunction.Transpose(CellIDArray)\n     Next\n     Call PrintDatav13(NodeIDNameArray, CellIDArray, j, v13Count)\nElseIf NodeVersionArray(i) = \"14\" Then\n    NodeID_Version14 = NodeIDArray(i)\n    NodeIDArray_v14(i) = NodeID_Version14\n    Node_Version14 = NodeVersionArray(i)\n    NodeID_Version14(i) = Node_Version14\n\n    Set version14_loc = XMLFile.SelectNodes(\"/home/Equipment[@id='\" &amp; NodeID_Version14 &amp; \"' and @version='\" &amp; Node_Version14 &amp; \"']/room/cell/location\")\n    For k = 0 To (version14_loc.Length - 1)\n        ReDim Preserve CellIDArray(0 To k)\n        ReDim Preserve NodeIDNameArray(0 To k)\n        ReDim Preserve CellIDNameArray14(0 To k)\n        ReDim Preserve NodeIDNameArray14(0 To k)\n        ReDim Preserve PurposeNameArray(0 To k)\n\n        PurposeName = version14_loc(k).Text\n        CellID = version14_loc(k).ParentNode.ParentNode.ParentNode.ParentNode.getAttribute(\"id\")\n        NodeIDName = version14_loc(k).ParentNode.ParentNode.ParentNode.ParentNode.ParentNode.ParentNode.getAttribute(\"id\")\n\n        If PurposeName = \"Red\" Or PurposeName = \"Orange\" Or PurposeName = \"Blue\" Then\n\n            CellIDArray(h) = CellID\n            NodeIDNameArray(h) = NodeIDName\n            PurposeNameArray(h) = PurposeName\n\n            h = h + 1\n        End If\n    Next\n    Call PrintDatav14(CellIDArray, NodeIDNameArray, PurposeNameArray, h)\nElse\n    MsgBox (\"Wrong Version\")\nEnd If\n\n\nNext\n\nSub PrintDatav14(NodeIDNameArray, CellIDArray, PurposeNameArray, h)\nRange(\"A3\").Resize(h, 1).Value = WorksheetFunction.Transpose(NodeIDNameArray)\nRange(\"B3\").Resize(h, 1).Value = WorksheetFunction.Transpose(CellIDArray)\nRange(\"C3\").Resize(h, 1).Value = WorksheetFunction.Transpose(PurposeNameArray)\nEnd Sub\n</code></pre>\n\n<p>So for version 13 (after the first IF) I try to print after the statement. For version 14, I create a sub that prints (just for experimental purposes). They however overlap.</p>\n"}, {"tags": ["vba", "email", "outlook"], "comments": [{"owner": {"reputation": 512, "user_id": 1914656, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/4cf45d8a607254deed38c63a6d77eadb?s=128&d=identicon&r=PG", "display_name": "Jay", "link": "https://stackoverflow.com/users/1914656/jay"}, "edited": false, "score": 0, "creation_date": 1429639625, "post_id": 29779782, "comment_id": 47689932, "body": "Apparently moving each email items in your inbox is like deleting each rows in your table in excel. The selected BEST ANSWER in the link below seem to have the info I need"}], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 9, "last_activity_date": 1488519483, "last_edit_date": 1488519483, "creation_date": 1430198218, "answer_id": 29910853, "question_id": 29779782, "link": "https://stackoverflow.com/questions/29779782/how-to-move-each-emails-from-inbox-to-a-sub-folder/29910853#29910853", "title": "How to move each emails from inbox to a sub-folder", "body": "<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff860683.aspx\" rel=\"noreferrer\">here is good link</a> </p>\n\n<p>Moves Outlook Mail items to a Sub folder by Email address</p>\n\n<pre><code>Option Explicit\nPublic Sub Move_Items()\n'   // Declare your Variables\n    Dim Inbox As Outlook.MAPIFolder\n    Dim SubFolder As Outlook.MAPIFolder\n    Dim olNs As Outlook.NameSpace\n    Dim Item As Object\n    Dim Items As Outlook.Items\n    Dim lngCount As Long\n\n    On Error GoTo MsgErr\n'    Set Inbox Reference\n    Set olNs = Application.GetNamespace(\"MAPI\")\n    Set Inbox = olNs.GetDefaultFolder(olFolderInbox)\n    Set Items = Inbox.Items\n\n'   // Loop through the Items in the folder backwards\n    For lngCount = Items.Count To 1 Step -1\n        Set Item = Items(lngCount)\n\n        If Item.Class = olMail Then\n            Select Case Item.SenderEmailAddress\n\n'               // Email_One\n                Case \"Email_One@email.com\"\n'                   // Set SubFolder of Inbox\n                    Set SubFolder = Inbox.Folders(\"Folder One\")\n                    Set Item = Items.Find(\"[SenderEmailAddress] = 'Email_One@email.com'\")\n                    If TypeName(Item) &lt;&gt; \"Nothing\" Then\n'                       // Mark As Read\n                        Item.UnRead = False\n'                       // Move Mail Item to sub Folder\n                        Item.Move SubFolder\n                    End If\n\n'               // Email_Two\n                Case \"Email_Two@email.com\"\n'                   // Set SubFolder of Inbox\n                    Set SubFolder = Inbox.Folders(\"Folder Two\")\n                    Set Item = Items.Find(\"[SenderEmailAddress] = 'Email_Two@email.com'\")\n                    If TypeName(Item) &lt;&gt; \"Nothing\" Then\n'                       // Mark As Read\n                        Item.UnRead = False\n'                       // Move Mail Item to sub Folder\n                        Item.Move SubFolder\n                    End If\n\n            End Select\n        End If\n    Next lngCount\n\nMsgErr_Exit:\n    Set Inbox = Nothing\n    Set SubFolder = Nothing\n    Set olNs = Nothing\n    Set Item = Nothing\n    Set Items = Nothing\n\n    Exit Sub\n\n'// Error information\nMsgErr:\n    MsgBox \"An unexpected Error has occurred.\" _\n         &amp; vbCrLf &amp; \"Error Number: \" &amp; Err.Number _\n         &amp; vbCrLf &amp; \"Error Description: \" &amp; Err.Description _\n         , vbCritical, \"Error!\"\n    Resume MsgErr_Exit\nEnd Sub\n</code></pre>\n\n<p>Or to move all Mail items Inbox to sub folder</p>\n\n<pre><code>Option Explicit\nPublic Sub Move_Items()\n'   // Declare your Variables\n    Dim Inbox As Outlook.MAPIFolder\n    Dim SubFolder As Outlook.MAPIFolder\n    Dim olNs As Outlook.NameSpace\n    Dim Item As Object\n    Dim lngCount As Long\n    Dim Items As Outlook.Items\n\n    On Error GoTo MsgErr\n'    Set Inbox Reference\n    Set olNs = Application.GetNamespace(\"MAPI\")\n    Set Inbox = olNs.GetDefaultFolder(olFolderInbox)\n    Set Items = Inbox.Items\n\n'   // Loop through the Items in the folder backwards\n    For lngCount = Items.Count To 1 Step -1\n        Set Item = Items(lngCount)\n\n        Debug.Print Item.Subject\n\n        If Item.Class = olMail Then\n'           // Set SubFolder of Inbox\n            Set SubFolder = Inbox.Folders(\"Temp\")\n'           // Mark As Read\n            Item.UnRead = False\n'           // Move Mail Item to sub Folder\n            Item.Move SubFolder\n        End If\n    Next lngCount\n\nMsgErr_Exit:\n    Set Inbox = Nothing\n    Set SubFolder = Nothing\n    Set olNs = Nothing\n    Set Item = Nothing\n\n    Exit Sub\n\n'// Error information\nMsgErr:\n    MsgBox \"An unexpected Error has occurred.\" _\n         &amp; vbCrLf &amp; \"Error Number: \" &amp; Err.Number _\n         &amp; vbCrLf &amp; \"Error Description: \" &amp; Err.Description _\n         , vbCritical, \"Error!\"\n    Resume MsgErr_Exit\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 512, "user_id": 1914656, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/4cf45d8a607254deed38c63a6d77eadb?s=128&d=identicon&r=PG", "display_name": "Jay", "link": "https://stackoverflow.com/users/1914656/jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41564, "favorite_count": 1, "closed_date": 1430599095, "answer_count": 1, "score": 5, "last_activity_date": 1592694777, "creation_date": 1429639094, "last_edit_date": 1592694777, "question_id": 29779782, "link": "https://stackoverflow.com/questions/29779782/how-to-move-each-emails-from-inbox-to-a-sub-folder", "closed_reason": "Duplicate", "title": "How to move each emails from inbox to a sub-folder", "body": "<p>I seem to be getting issues with moving emails from inbox to a sub-folder of inbox. I always thought my code was working until today. I noticed it's only moving half of the emails. I do not need a \"move all\" code, I have a purpose for this but I just need to move each emails and not all at once (I needed to check each emails). Please take a look at my code below. <code>myNamespace.Folders.Item(1).Folders.Item(2)</code> is my main Inbox.</p>\n\n<pre><code>Sub MoveEachInboxItems()\n    Dim myNamespace As Outlook.NameSpace\n    Set myNamespace = Application.GetNamespace(\"MAPI\")\n\n    For Each Item In myNamespace.Folders.Item(1).Folders.Item(2).Items\n        Dim oMail As Outlook.MailItem: Set oMail = Item\n           Item.UnRead = True\n           Item.move myNamespace.Folders.Item(1).Folders.Item(2).Folders(\"Other Emails\")\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 12281, "user_id": 1322268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EfWtq.jpg?s=128&g=1", "display_name": "shawnt00", "link": "https://stackoverflow.com/users/1322268/shawnt00"}, "edited": false, "score": 0, "creation_date": 1429638833, "post_id": 29779515, "comment_id": 47689375, "body": "You mean <code>group in (3, 4)</code>? I don&#39;t know if Access supports multi-value parameters but that&#39;s probably what you should be looking at. You wouldn&#39;t need 4 trillion tests even if you ended up using VBA."}, {"owner": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "reply_to_user": {"reputation": 12281, "user_id": 1322268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EfWtq.jpg?s=128&g=1", "display_name": "shawnt00", "link": "https://stackoverflow.com/users/1322268/shawnt00"}, "edited": false, "score": 0, "creation_date": 1429639416, "post_id": 29779515, "comment_id": 47689789, "body": "<a href=\"https://accessexperts.com/blog/2013/09/23/are-you-in-or-are-you-out-not-in/\" rel=\"nofollow noreferrer\">accessexperts.com/blog/2013/09/23/&hellip;</a>"}, {"owner": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "reply_to_user": {"reputation": 12281, "user_id": 1322268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EfWtq.jpg?s=128&g=1", "display_name": "shawnt00", "link": "https://stackoverflow.com/users/1322268/shawnt00"}, "edited": false, "score": 0, "creation_date": 1429639436, "post_id": 29779515, "comment_id": 47689799, "body": "The link says in(3, 4) is correct not in (3, 4)"}, {"owner": {"reputation": 12281, "user_id": 1322268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EfWtq.jpg?s=128&g=1", "display_name": "shawnt00", "link": "https://stackoverflow.com/users/1322268/shawnt00"}, "edited": false, "score": 1, "creation_date": 1429639740, "post_id": 29779515, "comment_id": 47689997, "body": "The space is not significant and most SQL is written with it there. I was concerned about the comma though: you wrote <code>34</code> which might have changed this into an entirely different question."}, {"owner": {"reputation": 12281, "user_id": 1322268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EfWtq.jpg?s=128&g=1", "display_name": "shawnt00", "link": "https://stackoverflow.com/users/1322268/shawnt00"}, "edited": false, "score": 2, "creation_date": 1429639938, "post_id": 29779515, "comment_id": 47690110, "body": "Here&#39;s is are some suggested approaches. You could also try another approach by populating another table with the values of your &quot;groups&quot; and using <code>IN (select group from &lt;mygroups&gt;)</code>. <a href=\"https://support.microsoft.com/en-us/kb/210530\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/kb/210530</a>"}, {"owner": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "reply_to_user": {"reputation": 12281, "user_id": 1322268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EfWtq.jpg?s=128&g=1", "display_name": "shawnt00", "link": "https://stackoverflow.com/users/1322268/shawnt00"}, "edited": false, "score": 0, "creation_date": 1429639976, "post_id": 29779515, "comment_id": 47690124, "body": "The problem is when I set the parameter in the form equal to &quot;3,4&quot; it reads it as &quot;34&quot; and if I set it to &quot;3, 4&quot; with a space I get an error"}, {"owner": {"reputation": 12281, "user_id": 1322268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EfWtq.jpg?s=128&g=1", "display_name": "shawnt00", "link": "https://stackoverflow.com/users/1322268/shawnt00"}, "edited": false, "score": 0, "creation_date": 1429649779, "post_id": 29779515, "comment_id": 47695844, "body": "It&#39;s probably doing some implicit casting from a string value to a numeric. The comma is probably being ignored as a thousands separator. The approach with a single parameter isn&#39;t going to word. Read the article if you want an approach based on substring matches."}], "answers": [{"tags": [], "owner": {"reputation": 705, "user_id": 4163002, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/30e77d3fa90ca3c96cf94a3fca4614ee?s=128&d=identicon&r=PG&f=1", "display_name": "ZX9", "link": "https://stackoverflow.com/users/4163002/zx9"}, "is_accepted": false, "score": 3, "last_activity_date": 1429733950, "last_edit_date": 1495542178, "creation_date": 1429649132, "answer_id": 29782786, "question_id": 29779515, "link": "https://stackoverflow.com/questions/29779515/using-parameter-from-form-in-in-statement/29782786#29782786", "title": "Using parameter from form in IN statement", "body": "<p>I can't figure out a way to do it with <code>IN</code>.</p>\n\n<p>My solution: in a VBA module in your database, write a sub to build a query based on the values in the form control. Let's use the <code>Split</code> method to make an array, which we can iterate through to build a query. </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub MakeTheQuery()\nDim strSQL As String, db As DAO.Database\nSet db = CurrentDb()\n\nstrSQL = \"SELECT sum(id) AS numobs _\nFROM table WHERE (\"\n\nValue = Forms!YourForm!YourControl.Caption\n'The property may vary with controls ^\n\n'Create an array from the control values\nanArray = Split(Value, \",\")\n\n'Add to the query for each value\nFor i = LBound(anArray) To (UBound(anArray) - 1)\nstrSQL = strSQL &amp; \" ErrorKey.ID = \" &amp; anArray(i) &amp; \" OR\"\nNext i\n\n'Wrap it all up\nstrSQL = strSQL &amp; \" ErrorKey.ID = \" &amp; anArray(UBound(anArray)) &amp; \")\"\n\n'Assign SQL to query\ndb.QueryDefs!YourQuery.SQL = strSQL\n\nEnd Sub\n</code></pre>\n\n<p>Please keep in mind this assumes that the string from the form control will be formatted with <strong>no spaces</strong>, but you can easily change that by using <code>anArray = Split(Value, \", \")</code> instead (note the space add after the comma).</p>\n\n<p>To assign the VBA sub to a button or other control on your form by going to <code>Layout View</code>, clicking on a control, going to the <code>Event</code> tab on the Property Sheet, hitting the <kbd>...</kbd> button beside the On Click. Hit <code>Code Builder</code>. Put <code>Call MakeTheQuery</code> in the sub that it builds for you. If you want to run the query, too, put <code>DoCmd.OpenQuery \"YourQuery\"</code>.</p>\n\n<p>You can also use this method to <a href=\"https://stackoverflow.com/questions/28199777/access-dynamic-query-better-to-build-one-conditional-sql-query-or-multiple-que/28199953#28199953\">build a more complex, dynamic parameter query</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "edited": false, "score": 0, "creation_date": 1429726515, "post_id": 29791727, "comment_id": 47739376, "body": "How would I implement this? I entered this code into the module for my form, but how do I call it/use it? Thanks"}, {"owner": {"reputation": 705, "user_id": 4163002, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/30e77d3fa90ca3c96cf94a3fca4614ee?s=128&d=identicon&r=PG&f=1", "display_name": "ZX9", "link": "https://stackoverflow.com/users/4163002/zx9"}, "reply_to_user": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "edited": false, "score": 0, "creation_date": 1429728146, "post_id": 29791727, "comment_id": 47740352, "body": "Hi @Carl I&#39;ve edited the question with some implementation details. You just need to run this sub to change the query (<code>Call MakeTheQuery</code>) and then <a href=\"http://stackoverflow.com/questions/9929009/ms-access-execute-a-saved-query-by-name-in-vba\">run the query</a>. Make sure you replace all of the names of things, too."}, {"owner": {"reputation": 705, "user_id": 4163002, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/30e77d3fa90ca3c96cf94a3fca4614ee?s=128&d=identicon&r=PG&f=1", "display_name": "ZX9", "link": "https://stackoverflow.com/users/4163002/zx9"}, "reply_to_user": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "edited": false, "score": 0, "creation_date": 1429734004, "post_id": 29791727, "comment_id": 47744070, "body": "@Carl I attempted to edit the above answer, seeing as it is more streamlined, but my edit was rejected. I&#39;ve added implementation information on my answer."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 7135, "user_id": 11768, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/bc0d35aa0f058db77e5e78179124228d?s=128&d=identicon&r=PG", "display_name": "st78", "link": "https://stackoverflow.com/users/11768/st78"}, "edited": false, "score": 0, "creation_date": 1548751579, "post_id": 29791727, "comment_id": 95643759, "body": "@st78: Read the question and answer again, please. The value is pulled from the <i>Caption</i> property which is beyond user control."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 0, "last_activity_date": 1429722296, "last_edit_date": 1429722296, "creation_date": 1429691148, "answer_id": 29791727, "question_id": 29779515, "link": "https://stackoverflow.com/questions/29779515/using-parameter-from-form-in-in-statement/29791727#29791727", "title": "Using parameter from form in IN statement", "body": "<p>This can be very simply done with a sub in a VBA module:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub MakeTheQuery()\n    Dim db As DAO.Database\n    Dim strSQL As String\n    Dim strElements As String\n\n    Set db = CurrentDb()\n\n    strSQL = \"SELECT Sum(id) AS numobs \" &amp; _\n        \"FROM ErrorKey WHERE ErrorKey.ID In ({0});\"\n\n    ' Example: \"3,5\"\n    strElements = Forms!YourForm!YourControl.Caption\n\n    ' Assign SQL to query\n    db.QueryDefs!YourQuery.SQL = Replace(strSQL, \"{0}\", strElements)\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6651260, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/68efd987e43b8fdad70a03f135fab67a?s=128&d=identicon&r=PG", "display_name": "greg", "link": "https://stackoverflow.com/users/6651260/greg"}, "is_accepted": false, "score": 0, "last_activity_date": 1469731812, "creation_date": 1469731812, "answer_id": 38644509, "question_id": 29779515, "link": "https://stackoverflow.com/questions/29779515/using-parameter-from-form-in-in-statement/38644509#38644509", "title": "Using parameter from form in IN statement", "body": "<p>You may consider Instr() function instead of In. Assuming you are generating the numbered list procedurally rather than forcing the end user to type a comma-separated list, you can change the format. We typically use pipe separators, so for example, the input may look like this:\n    <code>[form]![form1]![group]=\"|3|4|\"</code>\nThis is passed to the query as a single string parameter and tested in the Instr() function as follows:\n    <code>Instr([form]![form1]![group],\"|\" &amp; group &amp; \"|\")&gt;0\n    ' Instr() returns a numeric value of the position in the first argument where the second argument is found.</code>\nThe pipes ensure we don't get false positives (for example, finding 3 when we pass 34). We use this with multi-select listboxes and a custom VBA function, but it's perfectly viable any time you have control over the format.\n<a href=\"https://support.office.com/en-us/article/InStr-Function-85d3392c-3b1c-4232-bb18-77cd0cb8a55b\" rel=\"nofollow\">Instr Function - support.office.com</a></p>\n"}], "owner": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "accepted_answer_id": 29791727, "answer_count": 3, "score": 1, "last_activity_date": 1469731812, "creation_date": 1429638259, "question_id": 29779515, "link": "https://stackoverflow.com/questions/29779515/using-parameter-from-form-in-in-statement", "title": "Using parameter from form in IN statement", "body": "<p>I have a form with several inputs, that are then passed on to a query. This is pretty straightforward, except I want one of my parameters to be used in an IN statement in my sql like such:</p>\n\n<pre><code>Select sum(id) as numobs from table where year=[form]![form1]![year] and (group in([form]![form1]![group]));\n</code></pre>\n\n<p>When [form]![form1]![group]=\"3,4\" it querys \"group in(34)\" and if [form]![form1]![group]=\"3, 4\" then I get an error saying \"This expression is typed incorrectly, or it is too complex to be evaluated...\"</p>\n\n<p>I would like to be able to enter multiple numbers separated by a comma in a field in a form, and then have a query use the result in an IN statement. Does this seem doable? </p>\n\n<p>I know with VBA I could do if-then statements to look at every possible combination of group numbers (there are over 40 groups so combinatorically there are over 4 trillion ways to combine the 40+ groups since the sum of 42 choose k from 0 to 42 is over 4 trillion) so using the IN statement seems like a better option.</p>\n\n<p>Any ideas on how to get the IN statement to work with a parameter from a form?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "forms", "ms-access", "controls", "subform"], "answers": [{"comments": [{"owner": {"reputation": 193, "user_id": 1756239, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5281965cbb1c388f76ff2bccd82ec61d?s=128&d=identicon&r=PG", "display_name": "designspeaks", "link": "https://stackoverflow.com/users/1756239/designspeaks"}, "edited": false, "score": 0, "creation_date": 1429712067, "post_id": 29784024, "comment_id": 47728650, "body": "Thanks for the response. The action is being called from a completely different form so I believe the &quot;Me&quot; distinction won&#39;t work."}, {"owner": {"reputation": 2590, "user_id": 4507417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a027c3ea839c86e05de0c5f22fc6a7d0?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Stejskal", "link": "https://stackoverflow.com/users/4507417/marek-stejskal"}, "reply_to_user": {"reputation": 193, "user_id": 1756239, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5281965cbb1c388f76ff2bccd82ec61d?s=128&d=identicon&r=PG", "display_name": "designspeaks", "link": "https://stackoverflow.com/users/1756239/designspeaks"}, "edited": false, "score": 0, "creation_date": 1429714493, "post_id": 29784024, "comment_id": 47730858, "body": "That doesn&#39;t matter, it can be replaced by parent form, the tab control handling is what is important."}, {"owner": {"reputation": 2590, "user_id": 4507417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a027c3ea839c86e05de0c5f22fc6a7d0?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Stejskal", "link": "https://stackoverflow.com/users/4507417/marek-stejskal"}, "reply_to_user": {"reputation": 193, "user_id": 1756239, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5281965cbb1c388f76ff2bccd82ec61d?s=128&d=identicon&r=PG", "display_name": "designspeaks", "link": "https://stackoverflow.com/users/1756239/designspeaks"}, "edited": false, "score": 0, "creation_date": 1429720649, "post_id": 29784024, "comment_id": 47735386, "body": "Edited my answer to replicate your problem on my example more closely."}, {"owner": {"reputation": 193, "user_id": 1756239, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5281965cbb1c388f76ff2bccd82ec61d?s=128&d=identicon&r=PG", "display_name": "designspeaks", "link": "https://stackoverflow.com/users/1756239/designspeaks"}, "edited": false, "score": 0, "creation_date": 1429794824, "post_id": 29784024, "comment_id": 47775386, "body": "Thanks a ton! Worked great"}], "tags": [], "owner": {"reputation": 2590, "user_id": 4507417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a027c3ea839c86e05de0c5f22fc6a7d0?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Stejskal", "link": "https://stackoverflow.com/users/4507417/marek-stejskal"}, "is_accepted": true, "score": 1, "last_activity_date": 1429720607, "last_edit_date": 1429720607, "creation_date": 1429653976, "answer_id": 29784024, "question_id": 29779042, "link": "https://stackoverflow.com/questions/29779042/calling-a-control-on-a-subform/29784024#29784024", "title": "Calling a Control on a subform", "body": "<p>The thing is that you must treat the tab control as a special kind of container, with each page behaving similarly to another subform.</p>\n\n<p>I have created an example, see picture below.\n<img src=\"https://i.stack.imgur.com/HxgPJ.jpg\" alt=\"enter image description here\"></p>\n\n<p>The main form contains a TabControl (named tabControl) and the first page contains a subform (called SubForm) and that contains a text box (txb).</p>\n\n<p>To get to the value of the text box you will need to path through the tab control like this:</p>\n\n<pre><code>Me.tabControl.Pages(0).Controls(\"SubForm\")!txb.Value\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Me.tabControl.Pages(\"Page1\").Controls(\"SubForm\")!txb.Value\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Me.tabControl.Pages(\"Page1\").Controls(\"SubForm\").Controls(\"txb\").Value\n</code></pre>\n\n<p>Notice that the SubForm is part of the \"Controls\" collection of the page, so you'll need to identify the tab control first, then the page (either by name or zero-based index) and then the subform itself to get to it's controls.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>If you want to call it from a form-independent code, you can target the form like this</p>\n\n<pre><code>Forms!MainForm!tabControl.Pages(\"Page1\").Controls(\"SubForm\")!txb.Value\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 1756239, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5281965cbb1c388f76ff2bccd82ec61d?s=128&d=identicon&r=PG", "display_name": "designspeaks", "link": "https://stackoverflow.com/users/1756239/designspeaks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "accepted_answer_id": 29784024, "answer_count": 1, "score": 0, "last_activity_date": 1594459135, "creation_date": 1429636843, "last_edit_date": 1594459135, "question_id": 29779042, "link": "https://stackoverflow.com/questions/29779042/calling-a-control-on-a-subform", "title": "Calling a Control on a subform", "body": "<p>I'm looking for a way to access a control on a subform, currently everything I have tried gives me an error of \"cannot find\". </p>\n\n<blockquote>\n  <p>my main form \"frm_View\" contains the subform \"subform_View2\"</p>\n  \n  <p>subform_View2 contains a tab container</p>\n  \n  <p>the tab container contains yet another subform \"subform_View3\" on the\n  first tab</p>\n  \n  <p>Separate form \"frmAnswers\"</p>\n</blockquote>\n\n<p>I need to access a control on subform_View3 in order to insert information obtained from frmAnswers.</p>\n\n<p>I've tried:</p>\n\n<pre><code>me.subform_view3!frm_View!control1\nme.subform_view3!subform_view2!subform_View3!control1\n</code></pre>\n"}]