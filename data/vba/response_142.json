[{"tags": ["excel", "vba", "background", "formula"], "answers": [{"comments": [{"owner": {"reputation": 241, "user_id": 3889320, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cc999e4ead1d8f02ea1ad4b27b0d5bdc?s=128&d=identicon&r=PG&f=1", "display_name": "Thisisstackoverflow", "link": "https://stackoverflow.com/users/3889320/thisisstackoverflow"}, "edited": false, "score": 0, "creation_date": 1506636783, "post_id": 46460041, "comment_id": 79913191, "body": "So is there a way to fix this other than the workaround provided by Bharat?"}, {"owner": {"reputation": 839, "user_id": 6478363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222535f9bbc7882d4d6d49fe6054a8a6?s=128&d=identicon&r=PG&f=1", "display_name": "TotsieMae", "link": "https://stackoverflow.com/users/6478363/totsiemae"}, "edited": false, "score": 0, "creation_date": 1506652837, "post_id": 46460041, "comment_id": 79916743, "body": "There may be another way, I&#39;m not sure, but I agree with the accepted answer. However, you could always approach the solution by placing your helper columns (I &amp; J in my screenshot above) in columns A &amp; B and hiding them; I&#39;ve found them to be less likely to be messed up by the user when placed there. You may also want to consider using defined names for the formulas in columns I &amp; J to help clean up the worksheet a bit.  Also, please see my edit above. @Bharat Anand deserves full credit for the answer, but hopefully this screenshot helps clarify the accepted answer."}, {"owner": {"reputation": 839, "user_id": 6478363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222535f9bbc7882d4d6d49fe6054a8a6?s=128&d=identicon&r=PG&f=1", "display_name": "TotsieMae", "link": "https://stackoverflow.com/users/6478363/totsiemae"}, "edited": false, "score": 0, "creation_date": 1506706176, "post_id": 46460041, "comment_id": 79942511, "body": "You&#39;re very welcome! I attempted just now to add clarification (for both future me and future visitors). I hope it doesn&#39;t end up confusing you."}], "tags": [], "owner": {"reputation": 839, "user_id": 6478363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222535f9bbc7882d4d6d49fe6054a8a6?s=128&d=identicon&r=PG&f=1", "display_name": "TotsieMae", "link": "https://stackoverflow.com/users/6478363/totsiemae"}, "is_accepted": false, "score": 2, "last_activity_date": 1506706090, "last_edit_date": 1506706090, "creation_date": 1506565782, "answer_id": 46460041, "question_id": 46458614, "link": "https://stackoverflow.com/questions/46458614/how-to-set-the-background-of-three-cells-based-off-of-the-value-in-one-other-cel/46460041#46460041", "title": "How to set the background of three cells based off of the value in one other cell, relatively?", "body": "<p>A partial answer to your question has to do with your relative formula - <code>=SUM(H5:H7)</code> - under conditional formatting. Using this formula causes <strong>$E$5</strong> to use <code>=SUM(H5:H7)</code> to determine its formatting, <strong>$E$6</strong> to use <code>=SUM(H6:H8)</code> to determine its formatting, and so on. This ultimately leads to issues with the conditional formatting even before you begin copying the cells down.</p>\n\n<p><b>EDIT:</b> <i>(piggy-backing off @Bharat Anand's answer)</i></p>\n\n<p>@Bharat Anand's answer appears to be the best way to accomplish this question.</p>\n\n<p>@Thisisstackoverflow requested clarification (under the accepted answer) and I'm hoping my screenshot below will help.</p>\n\n<p>I set my worksheet up in what I believe is the exact same manner as @Bharat Anand, and it seems that the column letters may have been off. Setting mine up like this made it work correctly.</p>\n\n<p><a href=\"https://i.stack.imgur.com/10WPT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/10WPT.png\" alt=\"Excel visual of StackOverflow question of &quot;How to set the background of three cells based off of the value in one other cell, relatively?&quot;\"></a></p>\n\n<p><strong>EDIT:</strong> <em>(clarification for future visitors)</em></p>\n\n<p>I really liked @Bharat Anand's solution, so I wanted to explain how it works (using the images/formulas in the solution as reference):</p>\n\n<p>The calculation in <strong>Column I</strong> is setup to return a number that will only appear <em>three times</em>, in succession, in <strong>Column I</strong>; in this way it kind of behaves like a unique identifier, allowing other formulas to reference these values for calculation purposes.</p>\n\n<p><em>Three times</em> is key for the original poster because they were looking for a range of <em>three</em> cells to be formatted based on a sum of <em>three</em> cells. For example, the formula in <strong>Column I</strong> can be modified to </p>\n\n<p><code>=ROUNDDOWN((ROW()-b)/a,0)</code> </p>\n\n<p>where:</p>\n\n<p><code>a</code> is your desired number of cells to format/sum, and</p>\n\n<p><code>b</code> is equal to <code>a</code> - 1.</p>\n\n<p><br/>\nUsing the formula in <code>J5</code> as an example, this <code>SUMIF</code> formula uses <code>I3:I7</code>, which includes <em>two</em> (or <code>b</code>, as setup in my explanation above) rows above and <em>two</em> (<code>b</code>) rows below to decide if <code>I5</code> equals any of the values found in <code>I3:I7</code>. It's important to include the <em>two</em> rows above and <em>two</em> rows below so that the range overlaps the same <em>three</em> cells to meet the requested requirements.</p>\n\n<p>When <code>I5</code> finds a match, the formula looks to <strong>Column H</strong> to sum those rows in <code>H3:H7</code> where <code>I3:I7</code> equals <code>I5</code>. In this example, <code>J5</code>, <code>J6</code>, and <code>J7</code> will each equal 32. </p>\n\n<p>Using the simple conditional formatting formula that was setup, we know that cells in <strong>Column E</strong> should be highlighted when the corresponding row in <strong>Column H</strong> is greater than 30. According to the original question, this should be done in ranges that are <em>three</em> (<code>a</code>) rows tall. We already handled for that, so all that was left was to make sure the conditional formatting spanned the data area in <strong>Column E</strong>.</p>\n\n<p><em>I'm hoping I don't confuse and/offend anyone with this explanation, but it's how I understand it. I like the proposed solution and explaining it to myself again helps me solidify how it works.</em></p>\n"}, {"comments": [{"owner": {"reputation": 241, "user_id": 3889320, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cc999e4ead1d8f02ea1ad4b27b0d5bdc?s=128&d=identicon&r=PG&f=1", "display_name": "Thisisstackoverflow", "link": "https://stackoverflow.com/users/3889320/thisisstackoverflow"}, "edited": false, "score": 0, "creation_date": 1506626496, "post_id": 46460505, "comment_id": 79908798, "body": "Thank you so much for taking the time to replicate my problem and spelling out a fix."}, {"owner": {"reputation": 241, "user_id": 3889320, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cc999e4ead1d8f02ea1ad4b27b0d5bdc?s=128&d=identicon&r=PG&f=1", "display_name": "Thisisstackoverflow", "link": "https://stackoverflow.com/users/3889320/thisisstackoverflow"}, "edited": false, "score": 0, "creation_date": 1506632832, "post_id": 46460505, "comment_id": 79911775, "body": "I&#39;m having trouble understanding the SUMIF in Col K. Either I completely misunderstand the concept of what it&#39;s doing, or our column letters do not line up. What values should columns I and H be in your example above? Was I literally supposed to add two blank columns as well?"}, {"owner": {"reputation": 839, "user_id": 6478363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222535f9bbc7882d4d6d49fe6054a8a6?s=128&d=identicon&r=PG&f=1", "display_name": "TotsieMae", "link": "https://stackoverflow.com/users/6478363/totsiemae"}, "reply_to_user": {"reputation": 241, "user_id": 3889320, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cc999e4ead1d8f02ea1ad4b27b0d5bdc?s=128&d=identicon&r=PG&f=1", "display_name": "Thisisstackoverflow", "link": "https://stackoverflow.com/users/3889320/thisisstackoverflow"}, "edited": false, "score": 0, "creation_date": 1506694205, "post_id": 46460505, "comment_id": 79935688, "body": "@Thisisstackoverflow, did you ever figure out the SUMIFS function?"}, {"owner": {"reputation": 241, "user_id": 3889320, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cc999e4ead1d8f02ea1ad4b27b0d5bdc?s=128&d=identicon&r=PG&f=1", "display_name": "Thisisstackoverflow", "link": "https://stackoverflow.com/users/3889320/thisisstackoverflow"}, "edited": false, "score": 0, "creation_date": 1506701110, "post_id": 46460505, "comment_id": 79940024, "body": "No I didn&#39;t. I understand what SUMIF does, but I don&#39;t understand what it is accomplishing here, particularly because of the columns and rows used. Actually, I see your clarification below. Thank you."}], "tags": [], "owner": {"reputation": 402, "user_id": 5373329, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153280169888425/picture?type=large", "display_name": "Bharat Anand", "link": "https://stackoverflow.com/users/5373329/bharat-anand"}, "is_accepted": true, "score": 2, "last_activity_date": 1506667521, "last_edit_date": 1506667521, "creation_date": 1506569280, "answer_id": 46460505, "question_id": 46458614, "link": "https://stackoverflow.com/questions/46458614/how-to-set-the-background-of-three-cells-based-off-of-the-value-in-one-other-cel/46460505#46460505", "title": "How to set the background of three cells based off of the value in one other cell, relatively?", "body": "<h2><strong>Problem:</strong></h2>\n\n<p>If I correctly understand, what you are trying to achieve is to have the range <code>E5:E7</code> formatted strictly based upon <code>H5:H7</code>, then the next three-cell range -  <code>E8:E10</code> - based upon <code>H8:H10</code> and so on. You can do this by implementing the below solution:</p>\n\n<h2><strong>Solution:</strong></h2>\n\n<p><strong>Step 1:</strong> Setup Columns as Below</p>\n\n<p><a href=\"https://i.stack.imgur.com/N4fFQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/N4fFQ.png\" alt=\"Excel visual of StackOverflow question of &quot;How to set the background of three cells based off of the value in one other cell, relatively?&quot;\"></a></p>\n\n<p><br>\n<strong>Step 2:</strong> Implement Conditional Formatting as Below</p>\n\n<p><a href=\"https://i.stack.imgur.com/icExd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/icExd.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<h2><strong>Explanation:</strong></h2>\n\n<p>I have recreated your issue and I see your problem; it was not that obvious until I played around with changing values of different cells in <code>Column H</code>.</p>\n\n<p>Apparently, this has to do with how Excel interprets your instructions (formula) supplied under conditional formatting. To understand this let's first focus on the behavior of cells <code>E5</code>, <code>E6</code> and <code>E7</code> as a function of values in <code>Column H</code>. </p>\n\n<p>With the formula <code>=SUM(H5:H7)&gt;30</code> did you notice that:</p>\n\n<ol>\n<li><code>E5</code> format depends upon <code>=SUM(H5:H7)</code>,</li>\n<li><code>E6</code> format depends upon <code>=SUM(H6:H8)</code>, and </li>\n<li><code>E7</code> format depends upon <code>=SUM(H7:H9)</code> and </li>\n</ol>\n\n<p>when you copy the range <code>E5:E7</code> three cells down into <code>E8:E10</code>, the expected behavior is:</p>\n\n<ol>\n<li><code>E8</code> format depends upon <code>=SUM(H8:H10)</code>,</li>\n<li><code>E9</code> format depends upon <code>=SUM(H9:H11)</code>, and</li>\n<li><code>E10</code> format depends upon <code>=SUM(H10:H12)</code></li>\n</ol>\n\n<p>And this is exactly how the range <code>E8:E10</code> will behave once the above solution is applied.</p>\n"}], "owner": {"reputation": 241, "user_id": 3889320, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cc999e4ead1d8f02ea1ad4b27b0d5bdc?s=128&d=identicon&r=PG&f=1", "display_name": "Thisisstackoverflow", "link": "https://stackoverflow.com/users/3889320/thisisstackoverflow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 46460505, "answer_count": 2, "score": 0, "last_activity_date": 1570285434, "creation_date": 1506554194, "last_edit_date": 1570285434, "question_id": 46458614, "link": "https://stackoverflow.com/questions/46458614/how-to-set-the-background-of-three-cells-based-off-of-the-value-in-one-other-cel", "title": "How to set the background of three cells based off of the value in one other cell, relatively?", "body": "<p>I'm trying to make a formula that will color code three cells that are directly above/below each other. The color coding depends on the sum of three other cells that are directly above/below each other, and directly across from the cells to be colored.</p>\n\n<p>This part is easy. The rule is:</p>\n\n<pre><code>Forumula: =SUM(H5:H7)&gt;30\n</code></pre>\n\n<p>And it applies to:</p>\n\n<pre><code>$E$5:$E$7\n</code></pre>\n\n<p>However, the issue is that when I copy the cells that are being colored (E's) to three more cells below them for the next batch, the relative formula does not work as expected. It applies the formula on H6:H8 (+1) instead of H8:H10 (+3).</p>\n\n<p>Is there a way to get the relativeformula to work as expected? I hope this was clear enough. I know it's hard to visual a spreadsheet, but ultimately I need the relative forumla to add +3 instead of +1 when it is copied.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 515, "user_id": 2949700, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6Yssn.png?s=128&g=1", "display_name": "Socii", "link": "https://stackoverflow.com/users/2949700/socii"}, "edited": false, "score": 0, "creation_date": 1506554406, "post_id": 46458551, "comment_id": 79872654, "body": "You should be able to use the <code>PasteSpecial</code> method to paste the cell values instead of formulas: <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-pastespecial-method-excel\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/vba/excel-vba/articles/&hellip;</a>. Can you post the code you have so far?"}], "answers": [{"comments": [{"owner": {"reputation": 211, "user_id": 8651782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d71f253fb066108065e8b7ff5a747f?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Fenner", "link": "https://stackoverflow.com/users/8651782/joshua-fenner"}, "edited": false, "score": 0, "creation_date": 1506554884, "post_id": 46458668, "comment_id": 79872764, "body": "I am not sure if there is any special cell formatting you are trying to preserve.  This will not do that for you."}, {"owner": {"reputation": 113, "user_id": 8686166, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DXvp3.jpg?s=128&g=1", "display_name": "Kaynex", "link": "https://stackoverflow.com/users/8686166/kaynex"}, "edited": false, "score": 0, "creation_date": 1506554984, "post_id": 46458668, "comment_id": 79872783, "body": "I am using the second code, from Gary&#39;s Student&#39;s answer, as the first code didn&#39;t work for me. I thought by simply putting .Value at the end it would work, but the code didn&#39;t run. I am not trying to preserve any formatting."}, {"owner": {"reputation": 211, "user_id": 8651782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d71f253fb066108065e8b7ff5a747f?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Fenner", "link": "https://stackoverflow.com/users/8651782/joshua-fenner"}, "reply_to_user": {"reputation": 113, "user_id": 8686166, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DXvp3.jpg?s=128&g=1", "display_name": "Kaynex", "link": "https://stackoverflow.com/users/8686166/kaynex"}, "edited": false, "score": 0, "creation_date": 1506555031, "post_id": 46458668, "comment_id": 79872795, "body": "@Kaynex this code didn&#39;t run?  hmm Do you have a sheet with index 6?"}], "tags": [], "owner": {"reputation": 211, "user_id": 8651782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d71f253fb066108065e8b7ff5a747f?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Fenner", "link": "https://stackoverflow.com/users/8651782/joshua-fenner"}, "is_accepted": true, "score": 3, "last_activity_date": 1506556117, "last_edit_date": 1506556117, "creation_date": 1506554619, "answer_id": 46458668, "question_id": 46458551, "link": "https://stackoverflow.com/questions/46458551/copy-values-from-same-row-on-multiple-worksheets-to-one-worksheet/46458668#46458668", "title": "Copy values from same row on multiple worksheets to one worksheet", "body": "<p>adding the <code>.value</code> to the rows you are interested in should solve your reference issue.    </p>\n\n<pre><code>Sub row_copy()\n\nFor i = 1 To Worksheets.Count - 1\n\n   Sheets(6).Rows(i) = Sheets(i).Rows(7).Value 'added .value and reversed order of that code\n\nNext i\n\nEnd Sub\n</code></pre>\n\n<h2>Edit</h2>\n\n<p>The second answer</p>\n\n<pre><code>Sub copyrow()\nDim Nrow As Long, Nsheet As Long\nDim i As Long\n\nNrow = 7\nNsheet = 6\n\nFor i = 1 To Nsheet - 1\n    Sheets(Nsheet).Rows(i) = Sheets(i).Rows(7).Value\n    'Sheets(i).Cells(Nrow, 1).EntireRow.Copy Sheets(Nsheet).Cells(i, 1)\nNext i\nEnd Sub\n</code></pre>\n\n<p>A way to be sure and get every sheet except the sheet you are writing to.</p>\n\n<pre><code>Sub row_copy()\nDim i As Long\ni = 1\n\nWith Application.Sheets(\"Your Sheet Name\")\n\n    For Each Item In Worksheets\n\n        If Item.Name &lt;&gt; .Name Then\n            .Rows(i) = Sheets(i).Rows(7).Value\n            i = i + 1\n        End If\n\n    Next\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 8686166, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DXvp3.jpg?s=128&g=1", "display_name": "Kaynex", "link": "https://stackoverflow.com/users/8686166/kaynex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 726, "favorite_count": 0, "accepted_answer_id": 46458668, "answer_count": 1, "score": 1, "last_activity_date": 1506556117, "creation_date": 1506553779, "question_id": 46458551, "link": "https://stackoverflow.com/questions/46458551/copy-values-from-same-row-on-multiple-worksheets-to-one-worksheet", "title": "Copy values from same row on multiple worksheets to one worksheet", "body": "<p>I have a code from this similar question:\n<a href=\"https://stackoverflow.com/questions/37835442/copy-the-same-row-from-multiple-sheets-into-one-sheet-in-excel?newreg=975c05dce9b5425e8d764\">copy the same row from multiple sheets into one sheet in excel</a></p>\n\n<p>The second answer (from Gary's Student) features the code, and it works perfectly for most of my data. The code in question will take the same row from each worksheet in an excel file, and put all of those rows into the last worksheet. </p>\n\n<p>Problem is, some of my data is made of references. When I run the code, I don't want to copy over \"= B12\", but I want the paste special value. Can anyone edit the code to work like this? </p>\n"}, {"tags": ["excel", "spreadsheet", "vba"], "answers": [{"comments": [{"owner": {"reputation": 850, "user_id": 1168628, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/ff73593a0f5582ef9129c5a323245175?s=128&d=identicon&r=PG", "display_name": "Hightower", "link": "https://stackoverflow.com/users/1168628/hightower"}, "edited": false, "score": 0, "creation_date": 1506577708, "post_id": 46458475, "comment_id": 79878305, "body": "Thanks. This solution works with me. however, I forgot to mention that I have many of these matrix views, I was trying to define a generic way of working.  at the moment, Address is relative to the sheet, not relative to the range."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 850, "user_id": 1168628, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/ff73593a0f5582ef9129c5a323245175?s=128&d=identicon&r=PG", "display_name": "Hightower", "link": "https://stackoverflow.com/users/1168628/hightower"}, "edited": false, "score": 0, "creation_date": 1506602519, "post_id": 46458475, "comment_id": 79893722, "body": "@Hightower I updated my code. You would create a new range for each of your 3x3 blocks in the <code>Matrix(i)</code> range."}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 3, "last_activity_date": 1506602466, "last_edit_date": 1506602466, "creation_date": 1506553318, "answer_id": 46458475, "question_id": 46458437, "link": "https://stackoverflow.com/questions/46458437/excel-vba-determine-the-location-of-a-3x3-range-relative-to-activecell/46458475#46458475", "title": "Excel VBA determine the location of a 3X3 range relative to activeCell", "body": "<p>This should be in your <strong>Sheet Object</strong>, not in a standard module.</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n\n    Dim ws As Worksheet:    Set ws = ThisWorkbook.Worksheets(1)\n    Dim Matrix(1 To 2) As Range, i As Long\n    Set Matrix(1) = ws.Range(\"A1:C3\")\n    Set Matrix(2) = ws.Range(\"F1:H3\")\n\n    For i = LBound(Matrix) To UBound(Matrix)\n        Set iSect = Application.Intersect(Target, Matrix(i))\n        If Not iSect Is Nothing Then\n            Exit For\n        End If\n    Next\n\n    If Not iSect Is Nothing Then\n        MsgBox \"Target located in Range # \" &amp; i &amp; \" at: \" &amp; Target.Address\n    Else\n        MsgBox \"Does NOT interesect in any of my ranges!\"\n    End If\n\n    Cancel = True\n\nEnd Sub\n</code></pre>\n\n<p>If <code>Cancel = True</code>, then your cell will not be in editing mode.</p>\n\n<p>You can take the range from <code>Target</code> and make your comparisons with that.</p>\n"}], "owner": {"reputation": 850, "user_id": 1168628, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/ff73593a0f5582ef9129c5a323245175?s=128&d=identicon&r=PG", "display_name": "Hightower", "link": "https://stackoverflow.com/users/1168628/hightower"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 46458475, "answer_count": 1, "score": 2, "last_activity_date": 1506602466, "creation_date": 1506553042, "last_edit_date": 1531164843, "question_id": 46458437, "link": "https://stackoverflow.com/questions/46458437/excel-vba-determine-the-location-of-a-3x3-range-relative-to-activecell", "title": "Excel VBA determine the location of a 3X3 range relative to activeCell", "body": "<p>I have a 3 x 3 range in Excel which is defined as a range. I would like to know where the user has clicked when double-clicking in any of the blue cells. - the area is defined as a range. </p>\n\n<p><a href=\"https://i.stack.imgur.com/lL2a3.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lL2a3.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I have tried to create a function to find out this selection, however its a little difficult for my basic skills. </p>\n\n<p>my idea is to assign an integer value (1 - 9) to each cell in the matrix and have a function to return that value. </p>\n\n<blockquote>\n  <p>Edited question based on provided answer</p>\n</blockquote>\n\n<pre><code>Function relRange(rangeIn As Range, activeCell) As Integer\nrelRange = 0\nIf (rangeIn.Rows.Count = 6) And (rangeIn.Columns.Count = 6) Then  ' range has double merged cells\n    ' comparison code to determine where the activecell is relative to the 3x3 array\n\n        If rangeIn.Cells(5, 1).Address = activeCell Then relRange = 1 '1\n        If rangeIn.Cells(3, 1).Address = activeCell Then relRange = 2 '2\n        If rangeIn.Cells(5, 3).Address = activeCell Then relRange = 3 '3\n        If rangeIn.Cells(3, 3).Address = activeCell Then relRange = 4 '4\n        If rangeIn.Cells(1, 1).Address = activeCell Then relRange = 5 '5\n        If rangeIn.Cells(5, 5).Address = activeCell Then relRange = 6 '6\n        If rangeIn.Cells(1, 3).Address = activeCell Then relRange = 7 '7\n        If rangeIn.Cells(3, 5).Address = activeCell Then relRange = 8 '8\n        If rangeIn.Cells(1, 5).Address = activeCell Then relRange = 9 '9\n\nEnd If\nEnd Function\n</code></pre>\n\n<p>I have this function working now, was surprised that there was not an easier way.  </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 211, "user_id": 8651782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d71f253fb066108065e8b7ff5a747f?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Fenner", "link": "https://stackoverflow.com/users/8651782/joshua-fenner"}, "edited": false, "score": 0, "creation_date": 1506557106, "post_id": 46458188, "comment_id": 79873281, "body": "I just took a quick peak but at a glance... In changing that cell you &quot;reset&quot; the validation by deleting it, then put it back on.  Meaning the value contained never actually went through the validation process."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1506559997, "post_id": 46458188, "comment_id": 79873875, "body": "One way is to do only PasteSpecial (which can preserve the validation), and then use event code to check that the value pasted conforms to the underlying validation rules.  If the type of paste is not under your control, you will need to intercept the paste events and convert them to paste special. <a href=\"http://www.jkp-ads.com/articles/catchpaste.asp?AllComments=True\" rel=\"nofollow noreferrer\">Catching Paste Operations</a> by Jan Karel Pieterse purports to do this, but I have not tested it myself."}, {"owner": {"reputation": 439, "user_id": 8221156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0630c5eb8859be4063f55d8389373460?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/8221156/gene"}, "edited": false, "score": 0, "creation_date": 1506569225, "post_id": 46458188, "comment_id": 79875978, "body": "What is this Subroutine (or a part of it) that you are showing here? What triggers it to run to begin with?"}, {"owner": {"reputation": 211, "user_id": 8651782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d71f253fb066108065e8b7ff5a747f?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Fenner", "link": "https://stackoverflow.com/users/8651782/joshua-fenner"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1506569252, "post_id": 46458188, "comment_id": 79875982, "body": "@RonRosenfeld That is a Gem.  I wonder if it works."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1506586605, "post_id": 46458188, "comment_id": 79883169, "body": "Are you using the <code>Worksheet_Change</code> event?"}, {"owner": {"reputation": 961, "user_id": 8054843, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5509c35e6566c57c5ec9fe5e7d559181?s=128&d=identicon&r=PG&f=1", "display_name": "ipenguin67", "link": "https://stackoverflow.com/users/8054843/ipenguin67"}, "reply_to_user": {"reputation": 439, "user_id": 8221156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0630c5eb8859be4063f55d8389373460?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/8221156/gene"}, "edited": false, "score": 0, "creation_date": 1506608999, "post_id": 46458188, "comment_id": 79898485, "body": "@Gene and Macro Man I am using a Worksheet_SelectionChange event, as i want the validation to update for a given cell in my range as soon as it&#39;s clicked on. One interesting thing is I need to click enter twice before I can exit the cell. RonRosenfeld, I will check out that method -- looks involved, but hopefully it can solve this problem!"}, {"owner": {"reputation": 961, "user_id": 8054843, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5509c35e6566c57c5ec9fe5e7d559181?s=128&d=identicon&r=PG&f=1", "display_name": "ipenguin67", "link": "https://stackoverflow.com/users/8054843/ipenguin67"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1506631834, "post_id": 46458188, "comment_id": 79911305, "body": "@RonRosenfeld I tested Jan&#39;s code but it hasn&#39;t worked for me so far. When I copy and Paste, then hit Enter, it doesn&#39;t do anything at first except clear the &quot;copy range&quot; dotted lines around the source data. Then when I hit Enter again, it moves to the next cell, but there&#39;s no error. Incidentally though, I tried right-click, Paste Special, Values and still didn&#39;t see my validation fire."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1506632232, "post_id": 46458188, "comment_id": 79911523, "body": "I wouldn&#39;t expect the validation to fire. By doing Paste Special, the advantage is that you don&#39;t destroy the validation rules in the cell.  You still have to check that the entry is valid by comparing it with the validation rules.  You can do that with event code.  The advantage of Jan&#39;s code is that it should convert Paste into Paste Special.  But you still have to recheck that the entry is valid.  As I wrote above."}, {"owner": {"reputation": 961, "user_id": 8054843, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5509c35e6566c57c5ec9fe5e7d559181?s=128&d=identicon&r=PG&f=1", "display_name": "ipenguin67", "link": "https://stackoverflow.com/users/8054843/ipenguin67"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1507128808, "post_id": 46458188, "comment_id": 80089631, "body": "@RonRosenfeld I apologize for my noobishness, but can you clarify what you mean by &quot;use event code&quot; here? I am not sure how I can make a worksheet_change event fire from the &quot;IsValidationOK()&quot; function."}], "owner": {"reputation": 961, "user_id": 8054843, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5509c35e6566c57c5ec9fe5e7d559181?s=128&d=identicon&r=PG&f=1", "display_name": "ipenguin67", "link": "https://stackoverflow.com/users/8054843/ipenguin67"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 982, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1506551376, "creation_date": 1506551376, "question_id": 46458188, "link": "https://stackoverflow.com/questions/46458188/vba-data-validation-does-not-work-when-copy-paste-from-another-cell", "title": "VBA Data validation does not work when copy/paste from another cell", "body": "<p>I have dynamic data validation across a range of cells that updates the target cell every time one is selected. For example, I have a column with the header \"University\" that is pulling data from a University list on another page. The validation works great when typing in the cell or when selecting from the drop-down.</p>\n\n<p>However, when I copy an invalid value from another cell (e.g. 55555) and paste it in the University column, it allows me to press enter and move to the next cell without giving me an alert.</p>\n\n<pre><code>Dim rngDV As Range\nDim oldVal As String\nDim newVal As String\nDim strList As String\n\n    Dim ws As Worksheet\n    Dim RefRng As Range, RngFind As Range, NewRng As Range, hdr\n    Dim RefList As Range, c As Range, rngHeaders As Range, msg\n\n    On Error GoTo ErrHandling\n\n    Set ws = ThisWorkbook.Worksheets(\"Candidate Picklist\")\n\n    'only deal with the selected cell(s)\n    Set NewRng = Application.Intersect(Me.Range(\"A12:T101\"), Target)\n    If Not NewRng Is Nothing Then\n\n        Set rngHeaders = ws.Range(\"A11:ZZ11\")\n\n        For Each c In NewRng\n            c.Validation.Delete 'delete previous validation\n            hdr = Me.Cells(11, c.Column).Value\n\n            If Len(hdr) &gt; 0 Then\n                Set RngFind = rngHeaders.Find(hdr, , xlValues, xlWhole)\n                'matched header?\n                If Not RngFind Is Nothing Then\n\n                    Set RefList = ws.Range(RngFind.Offset(1, 0), _\n                                           RngFind.Offset(1, 0).End(xlDown))\n                        With c.Validation\n                                .Add Type:=xlValidateList, _\n                                     AlertStyle:=xlValidAlertStop, _\n                                     Formula1:=\"='\" &amp; ws.Name &amp; \"'!\" &amp; RefList.Address\n                               .IgnoreBlank = True\n                                .InCellDropdown = True\n                                .InputTitle = \"\"\n                                .ErrorTitle = \"\"\n                                .InputMessage = \"\"\n                                .ErrorMessage = \"\"\n                                .ShowInput = True\n                                .ShowError = True\n                        End With\n                End If 'matched header\n            End If 'has header\n\n        Next c\n    End If 'in required range\n</code></pre>\n"}, {"tags": ["vba", "image", "ms-word"], "comments": [{"owner": {"reputation": 2702, "user_id": 2923336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LmjCO.png?s=128&g=1", "display_name": "Francois", "link": "https://stackoverflow.com/users/2923336/francois"}, "edited": false, "score": 0, "creation_date": 1506554146, "post_id": 46458181, "comment_id": 79872593, "body": "At least show what you have tried, or try something first :)"}], "answers": [{"comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 1, "creation_date": 1506559128, "post_id": 46458675, "comment_id": 79873708, "body": "that does not hide the object, it deletes it.  something like <code>objPic.visible = false</code> would hide it"}], "tags": [], "owner": {"reputation": 1, "user_id": 8686087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfe3a5fd7c731d467147eda361ed4ef4?s=128&d=identicon&r=PG&f=1", "display_name": "L. White", "link": "https://stackoverflow.com/users/8686087/l-white"}, "is_accepted": false, "score": -1, "last_activity_date": 1506554655, "creation_date": 1506554655, "answer_id": 46458675, "question_id": 46458181, "link": "https://stackoverflow.com/questions/46458181/hide-image-in-ms-office-vba/46458675#46458675", "title": "Hide image in MS Office VBA", "body": "<p>Found a solution:</p>\n\n<pre><code>Dim objPic As Shape\nFor Each objPic In ActiveDocument.Shapes\n    objPic.Delete\nNext objPic\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8686087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfe3a5fd7c731d467147eda361ed4ef4?s=128&d=identicon&r=PG&f=1", "display_name": "L. White", "link": "https://stackoverflow.com/users/8686087/l-white"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 620, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1506561218, "creation_date": 1506551339, "last_edit_date": 1506561218, "question_id": 46458181, "link": "https://stackoverflow.com/questions/46458181/hide-image-in-ms-office-vba", "title": "Hide image in MS Office VBA", "body": "<p>Used to write macros for Excel, it was easier, because the program showed the names of all the shapes / objects / pictures. Now I have a task in front of me: there is a picture or shapes in the document (MS Word), it is necessary to write a function or procedure that will hide / show my object. Thank you!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1506560478, "post_id": 46458168, "comment_id": 79873976, "body": "On which line exactly is the error being given?"}, {"owner": {"reputation": 3, "user_id": 8686004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eac9763ec2c8752e9c7f03cc96ecfcec?s=128&d=identicon&r=PG&f=1", "display_name": "BeanCounterWife", "link": "https://stackoverflow.com/users/8686004/beancounterwife"}, "reply_to_user": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1506560854, "post_id": 46458168, "comment_id": 79874057, "body": "Hey Chris....  The error throws at .Copy PasteStart  Before I added the second worksheet, the import worked just fine."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8686004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eac9763ec2c8752e9c7f03cc96ecfcec?s=128&d=identicon&r=PG&f=1", "display_name": "BeanCounterWife", "link": "https://stackoverflow.com/users/8686004/beancounterwife"}, "edited": false, "score": 0, "creation_date": 1506717416, "post_id": 46466292, "comment_id": 79947963, "body": "Thanks Joshua, that did the trick!  And yes, it&#39;s a one time use for each import using the master.  Have a fantastic weekend!"}], "tags": [], "owner": {"reputation": 211, "user_id": 8651782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d71f253fb066108065e8b7ff5a747f?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Fenner", "link": "https://stackoverflow.com/users/8651782/joshua-fenner"}, "is_accepted": true, "score": 0, "last_activity_date": 1506592742, "creation_date": 1506592742, "answer_id": 46466292, "question_id": 46458168, "link": "https://stackoverflow.com/questions/46458168/import-data-from-one-workbook-to-another/46466292#46466292", "title": "Import Data From one workbook to another", "body": "<p>if you only want Sheet1 then get rid of the loop.  </p>\n\n<p>Instead of:    </p>\n\n<pre><code>For Each Sheet In wb2.Sheets\nWith Sheet.Cells.Range(\"B9:B27\")\n    .Copy PasteStart\n    Set PasteStart = PasteStart.Offset(.Rows.Count)\nEnd With\nNext Sheet\n</code></pre>\n\n<p>Try:</p>\n\n<pre><code>wb2.sheets(1).range(\"B9:B27\").copy PasteStart\n</code></pre>\n\n<p>it seems like this is a one time use so no need to <code>Set PasteStart =</code> again.  Hope this helps</p>\n"}], "owner": {"reputation": 3, "user_id": 8686004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eac9763ec2c8752e9c7f03cc96ecfcec?s=128&d=identicon&r=PG&f=1", "display_name": "BeanCounterWife", "link": "https://stackoverflow.com/users/8686004/beancounterwife"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1976, "favorite_count": 0, "accepted_answer_id": 46466292, "answer_count": 1, "score": 0, "last_activity_date": 1506592742, "creation_date": 1506551267, "last_edit_date": 1531164843, "question_id": 46458168, "link": "https://stackoverflow.com/questions/46458168/import-data-from-one-workbook-to-another", "title": "Import Data From one workbook to another", "body": "<p>I currently have a master workbook that I use to create external pdf forms.  My current code lets me browse to a folder and select another workbook to pull specific data from and paste it into the Master.</p>\n\n<p>The data is copied from external workbook, sheet1, and pasted to active workbook, sheet1. The code I am working with is \"For Each Sheet.\" Works like a charm.</p>\n\n<p>The problem is that I have added another sheet to the workbooks and it's throwing a Run-time error 1004.  I need to recode it so it copies from only sheet1 in the external workbook and pastes only to sheet1 of the Master (active).</p>\n\n<p>Any ideas?  Thanks for any help you can pass along.</p>\n\n<pre><code>Sub ImportData()\n\nDim wb1 As Workbook\nDim wb2 As Workbook\nDim Sheet As Worksheet\nDim PasteStart As Range\n\nDim sh As Worksheet\nDim strXLSFile As String, strPDFFile As String, strFolder As String\n\nstrFolder = \"H:\\Company Data\\Firm Files\\Client Data Workbooks\\Excel Data-Client Info\"\n\nSet wb1 = ActiveWorkbook\nSet PasteStart = [Client_Data]\n\nFileToOpen = Application.GetOpenFilename _\n(Title:=\"Please choose a Report to Parse\", _\nFileFilter:=\"Report Files *.xlsm (*.xlsm),\")\n\nIf FileToOpen = False Then\n    MsgBox \"No File Specified.\", vbExclamation, \"ERROR\"\n    Exit Sub\nElse\n    Set wb2 = Workbooks.Open(Filename:=FileToOpen)\nFor Each Sheet In wb2.Sheets\n    With Sheet.Cells.Range(\"B9:B27\")\n        .Copy PasteStart\n        Set PasteStart = PasteStart.Offset(.Rows.Count)\n    End With\n    Next Sheet\n\nEnd If\n\nwb2.Close False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "xpath", "ie-automation"], "answers": [{"tags": [], "owner": {"reputation": 558, "user_id": 7927748, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/62bb7763ae9694456113fb6787786e9a?s=128&d=identicon&r=PG&f=1", "display_name": "Torc", "link": "https://stackoverflow.com/users/7927748/torc"}, "is_accepted": false, "score": 1, "last_activity_date": 1506553727, "creation_date": 1506553727, "answer_id": 46458546, "question_id": 46458019, "link": "https://stackoverflow.com/questions/46458019/can-i-automate-a-website-using-xpaths-in-vba/46458546#46458546", "title": "Can I automate a website using xpaths in vba?", "body": "<p>It looks like it's possible. My initial reference is to WiseOwlTutorials :\n<a href=\"https://www.youtube.com/watch?v=sGw6r5GVA5g\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=sGw6r5GVA5g</a></p>\n\n<p>Another reference (more specific to XML / using Xpaths) is from AnalystCave:\n<a href=\"http://analystcave.com/vba-xml-working-xml-files/\" rel=\"nofollow noreferrer\">http://analystcave.com/vba-xml-working-xml-files/</a></p>\n\n<p>W3Schools looks like it has some good information on syntax as well:\n<a href=\"https://www.w3schools.com/xml/xpath_syntax.asp\" rel=\"nofollow noreferrer\">https://www.w3schools.com/xml/xpath_syntax.asp</a></p>\n\n<p>You will need to go into Tools > References > Select Microsoft XML, v6.0 (or latest) and then set a DOMDocument which will have a collection of nodes. </p>\n\n<pre><code>    Dim XDoc As MSXML2.DOMDocument60\n    Set List = XDoc.SelectNodes(\"//FirstChild/ChildNodes[reference number]/innerText\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": false, "score": -1, "last_activity_date": 1506585779, "last_edit_date": 1506585779, "creation_date": 1506558827, "answer_id": 46459144, "question_id": 46458019, "link": "https://stackoverflow.com/questions/46458019/can-i-automate-a-website-using-xpaths-in-vba/46459144#46459144", "title": "Can I automate a website using xpaths in vba?", "body": "<p>Add a reference to <code>microsoft HTML object library</code>.\nYou might want to add <code>microsoft XML</code> as well.</p>\n"}, {"tags": [], "owner": {"reputation": 101, "user_id": 7524850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38a5563dea0d32093c89d4e1c8e1a6ad?s=128&d=identicon&r=PG&f=1", "display_name": "N Hanson", "link": "https://stackoverflow.com/users/7524850/n-hanson"}, "is_accepted": false, "score": 0, "last_activity_date": 1506587930, "creation_date": 1506587930, "answer_id": 46464649, "question_id": 46458019, "link": "https://stackoverflow.com/questions/46458019/can-i-automate-a-website-using-xpaths-in-vba/46464649#46464649", "title": "Can I automate a website using xpaths in vba?", "body": "<p>It's definitely possible, but in my experience I have found it easier to work around XPATH by locating using tag names or class. </p>\n\n<p>It looks like there is plenty of discussion online for using Selenium VBA if that's applicable to your use case.</p>\n\n<pre><code>Private IE As Object\n\nSet IE = CreateObject(\"InternetExplorer.Application\")\n\nURL = \"https://www.google.co.uk/\"\nIE.Visible = False/True\nIE.Navigate URL\nIE.document.getElementsByClassName(\"*class name*\")\nIE.document.getElementsByTagName(\"*tag name*\")\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8658499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d537fb97b88b5d26dd54bf68d40c7c34?s=128&d=identicon&r=PG&f=1", "display_name": "jameslennberg", "link": "https://stackoverflow.com/users/8658499/jameslennberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1400, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1506587930, "creation_date": 1506550334, "question_id": 46458019, "link": "https://stackoverflow.com/questions/46458019/can-i-automate-a-website-using-xpaths-in-vba", "title": "Can I automate a website using xpaths in vba?", "body": "<p>I am trying to automate downloading files from a website. I have used xpaths to control a website in java in the past, and would like to use them in VBA for this project. Is it possible to use something like getElementByXpath() and if so, what references would I need to include in my project? </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 1101, "user_id": 3626160, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U5qkD.png?s=128&g=1", "display_name": "TheAtomicOption", "link": "https://stackoverflow.com/users/3626160/theatomicoption"}, "is_accepted": true, "score": 0, "last_activity_date": 1506552505, "creation_date": 1506552505, "answer_id": 46458360, "question_id": 46457934, "link": "https://stackoverflow.com/questions/46457934/excel-list-vba-add-from-cells/46458360#46458360", "title": "Excel list, VBA add from cells", "body": "<p>The main thing missing from your macro is a loop for the data, and a loop for the empty cells. </p>\n\n<p>If you're planning to use this more than once, you might also want to select the correct column more carefully as it currently starts from whatever cell is selected.</p>\n\n<p>Perhaps something like this:</p>\n\n<pre><code>Sub FillVariations()\n' \n' Makro8 Makro\n'\n'figure out how far down data goes\nRange(\"AZ2\").Select\nSelection.End(xlDown).Select\nDim endrow\nendrow = Selection.Row\n\n'always start in the correct column\nRange(\"E1\").Select\nSelection.End(xlDown).Select\n\n\nDim basename\n\n'loop through all data\nDo While ActiveCell.Row &lt; endrow\n    'Store cell of current base name\n    basename = Selection.Address\n\n    'loop through empty cells and set formula if cell isn't empty\n    Do While True\n        ActiveCell.Offset(1, 0).Activate\n\n        'if next cell isn't empty, isn't past the end of the list, go to outer loop\n        If ActiveCell.Formula = \"\" And ActiveCell.Row &lt;= endrow Then\n            ActiveCell.Formula = \"=CONCATENATE(\" &amp; basename &amp; \",\"\" - \"\",\" &amp; \"AZ\" &amp; Selection.Row &amp; \")\"\n        Else\n            Exit Do\n        End If\n    Loop\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 439, "user_id": 8221156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0630c5eb8859be4063f55d8389373460?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/8221156/gene"}, "is_accepted": false, "score": 0, "last_activity_date": 1506571277, "creation_date": 1506571277, "answer_id": 46460762, "question_id": 46457934, "link": "https://stackoverflow.com/questions/46457934/excel-list-vba-add-from-cells/46460762#46460762", "title": "Excel list, VBA add from cells", "body": "<p>One obvious problem with your approach is that there is a limit of how many characters can be stored in a worksheet cell (32,767 max?); this might be enough for you, of course, but if not...</p>\n\n<p>Another thought is that you are trying to set it up like recording a macro of doing it \"by hand\" and not really automating  the process.</p>\n\n<p>Anyways, this (with whatever needed modifications) should do it efficiently. The <code>sCSV</code> string can be saved as a text/csv file.</p>\n\n<pre><code>Private Sub Build_String_CSV()\n    Dim iRowStart As Long\n    Dim iRowEnd As Long\n    Dim i As Long\n    Dim sCSV As String\n\n    iRowStart = 1 ' or whatever\n    iRowEnd = 800 ' or whatever\n    ' Note that the values above can be found dynamically, of course\n    For i = iRowStart To iRowEnd\n            sCSV = sCSV &amp; \" - \" &amp; ActiveSheet.Range(\"AZ\" &amp; i)\n    Next\n    sCSV = sCSV = Mid(sC,SV, 4, 10000000) ' remove the very first 3 characters: space-dash-space\n    ' Save the sCSV string as csv file\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 8536374, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ACxCHO6IhjE/AAAAAAAAAAI/AAAAAAAACT4/BZ2GW_2I_9g/photo.jpg?sz=128", "display_name": "hedburgaren", "link": "https://stackoverflow.com/users/8536374/hedburgaren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 314, "favorite_count": 0, "accepted_answer_id": 46458360, "answer_count": 2, "score": 1, "last_activity_date": 1506584244, "creation_date": 1506549906, "last_edit_date": 1506584244, "question_id": 46457934, "link": "https://stackoverflow.com/questions/46457934/excel-list-vba-add-from-cells", "title": "Excel list, VBA add from cells", "body": "<p>I am building a CSV-file of products to import to a webshop. As the products have different attributes (sizes and/or colors) I need to add these as variations in the file. In total I have around 800 rows and need to fill the blank spaces like shown in the picture below. The range of variations varies between three and five.</p>\n\n<p><img src=\"https://i.stack.imgur.com/5zNQB.png\" alt=\"Screendump, Excel\"></p>\n\n<p>I've been struggling to get some sort of VBA-code to work.</p>\n\n<pre><code>Sub FillVariations()\n'\n' Makro8 Makro\n'\n\n' Find row with content and copy\n\n    Selection.End(xlDown).Select\n    Selection.Copy\n\n' Move one step down\n\n    ActiveCell.Offset(1, 0).Activate\n\n' Add =\" &lt;ctrl-v&gt; \" &amp; \" - \" &amp; az&lt;samerow&gt;\n\n    ActiveCell.FormulaR1C1 = _\n        \"=\"\"Axelv\u00e4ska/handv\u00e4ska, Crazy Horse, RCH7\"\" &amp; \"\" - \"\" &amp; RC[47]\"\n\n' Move one step down\n\n    ActiveCell.Offset(1, 0).Activate\n\nEnd Sub\n</code></pre>\n\n<p>Ctrl-V is the thought, but does not (obviously) work. </p>\n\n<p>Basically: Move down one row. If the cell has contents - copy it. Move down one row. Paste the content, add a space, hyphen and another space then paste the content from column AZ on the same row. Move down one row. If the cell is empty, then paste the previously copied content, add space, hyphen and space and paste the AZ contents from the new row...</p>\n\n<p>I'd greatly appreciate any help!</p>\n"}, {"tags": ["image", "excel", "vba"], "comments": [{"owner": {"reputation": 916, "user_id": 1290118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15bb8719fcee276c022948f3d1d7b998?s=128&d=identicon&r=PG", "display_name": "jhenderson2099", "link": "https://stackoverflow.com/users/1290118/jhenderson2099"}, "edited": false, "score": 3, "creation_date": 1506549985, "post_id": 46457637, "comment_id": 79871414, "body": "Please review <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a> and revise your question."}, {"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1506550585, "post_id": 46457637, "comment_id": 79871618, "body": "If your drop down is in a cell and named myDropDown you can select picture like this: <code>ActiveSheet.Shapes(ActiveSheet.Range(&quot;myDropDown&quot;).Value).Se&zwnj;&#8203;lect</code>  Hope this helps get you started."}], "owner": {"reputation": 17, "user_id": 8685931, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214598844466424/picture?type=large", "display_name": "Irina", "link": "https://stackoverflow.com/users/8685931/irina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 316, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1506639382, "creation_date": 1506548362, "last_edit_date": 1531164843, "question_id": 46457637, "link": "https://stackoverflow.com/questions/46457637/working-with-pictures-in-excel-vba", "title": "working with pictures in excel VBA", "body": "<p>I have 6 pictures.  I need to make a drop down box with names of all pictures, then when user selects a certain value from drop down box, I need to select that picture, copy and paste it into designated place in my excel file.  Any help would be greatly appreciated!</p>\n\n<p>Here is what I ended up doing, maybe not elegant, but got the job done for now:</p>\n\n<p>Sub DropDown60_Change()</p>\n\n<pre><code>With ActiveSheet\n    .Shapes(\"Picture 19\").Visible = False\n    .Shapes(\"Picture 20\").Visible = False\n    .Shapes(\"Picture 21\").Visible = False\n    .Shapes(\"Picture 22\").Visible = False\n    .Shapes(\"Chart 4\").Visible = False\n    Select Case .Shapes(\"Drop Down 60\").ControlFormat.Value\n    Case 1\n        .Shapes(\"Picture 19\").Visible = True\n    Case 2\n        .Shapes(\"Picture 20\").Visible = True\n    Case 3\n        .Shapes(\"Picture 21\").Visible = True\n    Case 4\n        .Shapes(\"Picture 22\").Visible = True\n    Case 5\n        .Shapes(\"Chart 4\").Visible = True\n    End Select\nEnd With\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1506549000, "post_id": 46457621, "comment_id": 79871086, "body": "When you click on the Tools --&gt; References, nothing happens?"}, {"owner": {"reputation": 223, "user_id": 7039125, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/805dafea7a1ec52382acdefd6636b847?s=128&d=identicon&r=PG&f=1", "display_name": "BH57", "link": "https://stackoverflow.com/users/7039125/bh57"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1506552942, "post_id": 46457621, "comment_id": 79872288, "body": "Correct, if I click it in another book its fine, but the one with the issue just does nothing"}, {"owner": {"reputation": 414, "user_id": 124253, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/203edb4cc6c5d04e6afccab0ddf1cbfe?s=128&d=identicon&r=PG", "display_name": "Sergey Dirin", "link": "https://stackoverflow.com/users/124253/sergey-dirin"}, "edited": false, "score": 0, "creation_date": 1551455882, "post_id": 46457621, "comment_id": 96659147, "body": "I have the same problem"}, {"owner": {"reputation": 369, "user_id": 5620644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70050e5c09ce3171441cb1f0edc3bfd?s=128&d=identicon&r=PG&f=1", "display_name": "Andras", "link": "https://stackoverflow.com/users/5620644/andras"}, "edited": false, "score": 0, "creation_date": 1567620044, "post_id": 46457621, "comment_id": 102020425, "body": "I have only seen this when a Macro was still running but I scrolled away to look at something else, then I forgot about the Macro still running... but this way References is also disabled (grayed out). In your case it is not disabled, is it?"}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 4746374, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_hZLxgkv9KE/AAAAAAAAAAI/AAAAAAAAAFI/-z6U5hNpDxM/photo.jpg?sz=128", "display_name": "Leonardo Fernandez", "link": "https://stackoverflow.com/users/4746374/leonardo-fernandez"}, "is_accepted": false, "score": 0, "last_activity_date": 1506549033, "creation_date": 1506549033, "answer_id": 46457768, "question_id": 46457621, "link": "https://stackoverflow.com/questions/46457621/references-in-vba-editor-not-opening/46457768#46457768", "title": "References in VBA editor not opening", "body": "<p>This has happened to me before. As usual, I'd suggest restarting Office. If that does not work, then go to Control Panel> Uninstalled Software> Microsoft Office. click on \"Modify\" and then once the wizard comes up, select \"Repair\". </p>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 3021917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5468d91ceb9417ca6afe38b1bb574277?s=128&d=identicon&r=PG&f=1", "display_name": "coolactuary", "link": "https://stackoverflow.com/users/3021917/coolactuary"}, "is_accepted": false, "score": 1, "last_activity_date": 1563438523, "creation_date": 1563438523, "answer_id": 57090209, "question_id": 46457621, "link": "https://stackoverflow.com/questions/46457621/references-in-vba-editor-not-opening/57090209#57090209", "title": "References in VBA editor not opening", "body": "<p>This has happened to me twice in the last week. For me not only did nothing open under \"tools / references\" but although the VBA modules were visible they were completely empty. I don't know the cause, but I speculate that it is some combination of:</p>\n\n<ul>\n<li>The Power Pivot addin (I'm using Office 365 FWIW)</li>\n<li>Dax Studio (this was present second time but not first)</li>\n<li>The MS scripting runtime reference/library</li>\n</ul>\n\n<p>The first time I managed to retrieve the situation, through a complex procedure; I'm not sure what part of the process worked the magic and for me it's not replicable.\nThe second time (this morning) I adopted a simpler procedure.</p>\n\n<ol>\n<li>I did the Office repair. That didn't work for me either.</li>\n<li>I opened an empty .xlsm and went into the VBE. </li>\n<li>I added a reference to the scripting runtime (Tools/References behaved as expected)</li>\n<li>Leaving this empty .xlsm open I opened the s/sheet that was giving me the problem.</li>\n<li>Voila: I got all my VBA back, Tools/References is OK.</li>\n</ol>\n\n<p>Happy bunny - for now. </p>\n"}, {"tags": [], "owner": {"reputation": 25, "user_id": 11447345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37f666ebfe3fbc37885ff17bdf2adade?s=128&d=identicon&r=PG&f=1", "display_name": "BuhBlake", "link": "https://stackoverflow.com/users/11447345/buhblake"}, "is_accepted": false, "score": 1, "last_activity_date": 1579267677, "creation_date": 1579267677, "answer_id": 59788355, "question_id": 46457621, "link": "https://stackoverflow.com/questions/46457621/references-in-vba-editor-not-opening/59788355#59788355", "title": "References in VBA editor not opening", "body": "<p>This can happen for any number of reasons, as VBA and excel are very sensitive.\nWhat i would suggest is unprotecting your workbook in any way that it is protected for now. Then try accessing your file via \"safe mode\" by holding ctrl when opening excel. Take the time to back up any important VBA codes. If you can't fix the errors in safe mode you may need to recreate the workbook with the saved VBA codes.</p>\n\n<p>Also if you have a personal XLSB workbook it may have been corrupted. Go to your excel's XLSB file location and check by opening it and seeing if there are any issues.</p>\n\n<p>I recently had this issue because i protected a sheet that VBA was trying to access when running a code so make sure everything is in order of when it was last working.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 13360711, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158562290582018/picture?type=large", "display_name": "Scott Ayers", "link": "https://stackoverflow.com/users/13360711/scott-ayers"}, "is_accepted": false, "score": 0, "last_activity_date": 1587374299, "creation_date": 1587374299, "answer_id": 61318965, "question_id": 46457621, "link": "https://stackoverflow.com/questions/46457621/references-in-vba-editor-not-opening/61318965#61318965", "title": "References in VBA editor not opening", "body": "<p>I just fixed this issue by getting somebody else on the network in my office to go into the file (which worked for them), then saving it as a trusted file. I suppose this would work by emailing a copy of the file to a different device and going into it on there. While on the different device you can also go into VBA Editor > Tools > References then untick all that aren't necessary. This may or may not be necessary. More technical solutions may be available but this seems to be a simple one that worked for me.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 13602170, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/560830462060762970d74285941994c1?s=128&d=identicon&r=PG", "display_name": "kristiantonev", "link": "https://stackoverflow.com/users/13602170/kristiantonev"}, "is_accepted": false, "score": 1, "last_activity_date": 1590235426, "creation_date": 1590235426, "answer_id": 61971743, "question_id": 46457621, "link": "https://stackoverflow.com/questions/46457621/references-in-vba-editor-not-opening/61971743#61971743", "title": "References in VBA editor not opening", "body": "<p>I also managet to fix it by disabling all macros, saving the file, and then enabling them from the \"Macro Security\" in the Developer tab.</p>\n"}, {"comments": [{"owner": {"reputation": 155, "user_id": 10084505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f11b965ba99caf12808437ef14ae02ee?s=128&d=identicon&r=PG&f=1", "display_name": "Wallnussfolie", "link": "https://stackoverflow.com/users/10084505/wallnussfolie"}, "edited": false, "score": 0, "creation_date": 1612121997, "post_id": 64104029, "comment_id": 116661982, "body": "Thanks, this worked for me as well"}], "tags": [], "owner": {"reputation": 11, "user_id": 14355407, "user_type": "registered", "profile_image": "https://graph.facebook.com/10164011549645705/picture?type=large", "display_name": "Sharan Nair", "link": "https://stackoverflow.com/users/14355407/sharan-nair"}, "is_accepted": false, "score": 1, "last_activity_date": 1601302756, "creation_date": 1601302756, "answer_id": 64104029, "question_id": 46457621, "link": "https://stackoverflow.com/questions/46457621/references-in-vba-editor-not-opening/64104029#64104029", "title": "References in VBA editor not opening", "body": "<p>This worked for me -\na. Copy/paste the problematic file to a new location. The error seems to be resolved in the file in the new location.\nb. Delete the problematic file in the original location (optional)\nc. Copy/paste the corrected file back to the original location.(optional)</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14500315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99b23fa3a6e9108df91890e49779af88?s=128&d=identicon&r=PG&f=1", "display_name": "AVB", "link": "https://stackoverflow.com/users/14500315/avb"}, "is_accepted": false, "score": 0, "last_activity_date": 1603373638, "creation_date": 1603373638, "answer_id": 64483387, "question_id": 46457621, "link": "https://stackoverflow.com/questions/46457621/references-in-vba-editor-not-opening/64483387#64483387", "title": "References in VBA editor not opening", "body": "<p>After opening in Safe Mode, go in to VBA and under Debug -&gt; Compile VBA Project</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 2077164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4655fbb9d1ef1b45275c92e078e4cbf2?s=128&d=identicon&r=PG", "display_name": "eroock", "link": "https://stackoverflow.com/users/2077164/eroock"}, "is_accepted": false, "score": 0, "last_activity_date": 1612868595, "creation_date": 1612868595, "answer_id": 66117700, "question_id": 46457621, "link": "https://stackoverflow.com/questions/46457621/references-in-vba-editor-not-opening/66117700#66117700", "title": "References in VBA editor not opening", "body": "<p>What worked for me:</p>\n<ul>\n<li>open a blank excel file</li>\n<li>go into VBA and disable Microsoft Office 15.0 Object Library (might be a different one for you)</li>\n<li>Close Excel</li>\n<li>Reopen and active Microsoft Office 15.0 Object Library</li>\n</ul>\n"}], "owner": {"reputation": 223, "user_id": 7039125, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/805dafea7a1ec52382acdefd6636b847?s=128&d=identicon&r=PG&f=1", "display_name": "BH57", "link": "https://stackoverflow.com/users/7039125/bh57"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21054, "favorite_count": 4, "answer_count": 8, "score": 7, "last_activity_date": 1612868595, "creation_date": 1506548305, "last_edit_date": 1582287335, "question_id": 46457621, "link": "https://stackoverflow.com/questions/46457621/references-in-vba-editor-not-opening", "title": "References in VBA editor not opening", "body": "<p>I am getting an error saying \"Can't find project or library\" error message when I try to run a VBA project.  I am trying to go into the References to see if there is something there that is causing an issue, but when I click on it, it does nothing.</p>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2473, "user_id": 3788685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0153b937db548cca172e6a78e71eabe3?s=128&d=identicon&r=PG&f=1", "display_name": "user3788685", "link": "https://stackoverflow.com/users/3788685/user3788685"}, "edited": false, "score": 0, "creation_date": 1506550472, "post_id": 46457618, "comment_id": 79871585, "body": "Welcome to SO; Show us what you have tried! What was the one you found that &#39;sort of worked&#39;? You should have a read of the <a href=\"https://stackoverflow.com/help\">help center</a> on how to ask a good question."}, {"owner": {"reputation": 7, "user_id": 8685753, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-bobo7e1wgjM/AAAAAAAAAAI/AAAAAAAACvQ/VBThUKTJEj0/photo.jpg?sz=128", "display_name": "Kam ", "link": "https://stackoverflow.com/users/8685753/kam"}, "edited": false, "score": 0, "creation_date": 1506551276, "post_id": 46457618, "comment_id": 79871860, "body": "Ya thanks for that! I noticed that too but couldn&#39;t find the edit button."}, {"owner": {"reputation": 7, "user_id": 8685753, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-bobo7e1wgjM/AAAAAAAAAAI/AAAAAAAACvQ/VBThUKTJEj0/photo.jpg?sz=128", "display_name": "Kam ", "link": "https://stackoverflow.com/users/8685753/kam"}, "reply_to_user": {"reputation": 2473, "user_id": 3788685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0153b937db548cca172e6a78e71eabe3?s=128&d=identicon&r=PG&f=1", "display_name": "user3788685", "link": "https://stackoverflow.com/users/3788685/user3788685"}, "edited": false, "score": 0, "creation_date": 1506551606, "post_id": 46457618, "comment_id": 79871978, "body": "@user3788685 So iv been working on this for a couple months now. Ive forgotten the source of the original solution. I&#39;m not new to VBA, I can read the code mostly and puzzle piece code together to create programs that work for me but that doesn&#39;t mean that I always understand 100% what im looking at. The code that I have been using I found on a different forum and i&#39;m not even sure I am reading it correctly. Ill post it momentarily"}, {"owner": {"reputation": 2473, "user_id": 3788685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0153b937db548cca172e6a78e71eabe3?s=128&d=identicon&r=PG&f=1", "display_name": "user3788685", "link": "https://stackoverflow.com/users/3788685/user3788685"}, "edited": false, "score": 0, "creation_date": 1506551722, "post_id": 46457618, "comment_id": 79872000, "body": "You can edit your question by clicking <a href=\"https://stackoverflow.com/posts/46457618/edit\">Here</a>"}, {"owner": {"reputation": 7, "user_id": 8685753, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-bobo7e1wgjM/AAAAAAAAAAI/AAAAAAAACvQ/VBThUKTJEj0/photo.jpg?sz=128", "display_name": "Kam ", "link": "https://stackoverflow.com/users/8685753/kam"}, "edited": false, "score": 0, "creation_date": 1506553255, "post_id": 46457618, "comment_id": 79872380, "body": "All edits have been made. If anybody is still confused as to what I am trying to do please don&#39;t hesitate to ask. Thanks!"}, {"owner": {"reputation": 7, "user_id": 8685753, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-bobo7e1wgjM/AAAAAAAAAAI/AAAAAAAACvQ/VBThUKTJEj0/photo.jpg?sz=128", "display_name": "Kam ", "link": "https://stackoverflow.com/users/8685753/kam"}, "reply_to_user": {"reputation": 2473, "user_id": 3788685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0153b937db548cca172e6a78e71eabe3?s=128&d=identicon&r=PG&f=1", "display_name": "user3788685", "link": "https://stackoverflow.com/users/3788685/user3788685"}, "edited": false, "score": 0, "creation_date": 1506554718, "post_id": 46457618, "comment_id": 79872723, "body": "@user3788685 I went back and found the first solution that &quot;Kind of&quot; worked. I edited the question to post the link."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1506560548, "post_id": 46457618, "comment_id": 79873994, "body": "the code that you posted appears to be ok. what is the undesired behaviour?"}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 8685753, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-bobo7e1wgjM/AAAAAAAAAAI/AAAAAAAACvQ/VBThUKTJEj0/photo.jpg?sz=128", "display_name": "Kam ", "link": "https://stackoverflow.com/users/8685753/kam"}, "edited": false, "score": 0, "creation_date": 1506619217, "post_id": 46466686, "comment_id": 79904849, "body": "This is perfect. If somebody was getting ready to update some of the data in the worksheet and opened the userform and accidently made a typo in textbox1 or textbox2 would it be possible to have a message box pop up that says something like &quot;data not found&quot; so the user would know that the data he intended to update was not updated properly? Right now if you make a typo the userform just closes and there is no way to know if what you intended to update was updated properly."}, {"owner": {"reputation": 7, "user_id": 8685753, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-bobo7e1wgjM/AAAAAAAAAAI/AAAAAAAACvQ/VBThUKTJEj0/photo.jpg?sz=128", "display_name": "Kam ", "link": "https://stackoverflow.com/users/8685753/kam"}, "edited": false, "score": 0, "creation_date": 1506637929, "post_id": 46466686, "comment_id": 79913442, "body": "Thank you so much! The program works except that every time I execute the program I get the message &quot;In some Cases Data not Found!!,Check the Dates with Red Font&quot;  regardless of whether or not the information in textbox1 and textbox2 is correct."}, {"owner": {"reputation": 7, "user_id": 8685753, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-bobo7e1wgjM/AAAAAAAAAAI/AAAAAAAACvQ/VBThUKTJEj0/photo.jpg?sz=128", "display_name": "Kam ", "link": "https://stackoverflow.com/users/8685753/kam"}, "edited": false, "score": 0, "creation_date": 1506639060, "post_id": 46466686, "comment_id": 79913731, "body": "Iv updated the code in the question. I made the changes you suggested but also added a few things so it would properly fit my needs. Namely:"}, {"owner": {"reputation": 7, "user_id": 8685753, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-bobo7e1wgjM/AAAAAAAAAAI/AAAAAAAACvQ/VBThUKTJEj0/photo.jpg?sz=128", "display_name": "Kam ", "link": "https://stackoverflow.com/users/8685753/kam"}, "edited": false, "score": 0, "creation_date": 1506639409, "post_id": 46466686, "comment_id": 79913822, "body": "I changed &quot;Dim datee As Date&quot; to &quot;Dim datee As Integer&quot;, changed &quot;If IsDate(TextBox2.Text)&quot; to &quot;If IsNumeric(TextBox2.Text)&quot;, deleted the &quot;And WS.Cells(r, 2) = datee&quot; in &quot;If WS.Cells(r, 3) = TextBox1.Text And WS.Cells(r, 2) = datee Then&quot; added more text box references and changed the wording in the messages code. Take a look at what iv&#39;e got so far. Maybe there is an error in what i tried to adjust. Thanks again!"}, {"owner": {"reputation": 561, "user_id": 8558614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2h6yS.jpg?s=128&g=1", "display_name": "Nikolaos Polygenis", "link": "https://stackoverflow.com/users/8558614/nikolaos-polygenis"}, "reply_to_user": {"reputation": 7, "user_id": 8685753, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-bobo7e1wgjM/AAAAAAAAAAI/AAAAAAAACvQ/VBThUKTJEj0/photo.jpg?sz=128", "display_name": "Kam ", "link": "https://stackoverflow.com/users/8685753/kam"}, "edited": false, "score": 0, "creation_date": 1506660836, "post_id": 46466686, "comment_id": 79918539, "body": "In 1 hour I will be in the office and I will update the code"}, {"owner": {"reputation": 561, "user_id": 8558614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2h6yS.jpg?s=128&g=1", "display_name": "Nikolaos Polygenis", "link": "https://stackoverflow.com/users/8558614/nikolaos-polygenis"}, "reply_to_user": {"reputation": 7, "user_id": 8685753, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-bobo7e1wgjM/AAAAAAAAAAI/AAAAAAAACvQ/VBThUKTJEj0/photo.jpg?sz=128", "display_name": "Kam ", "link": "https://stackoverflow.com/users/8685753/kam"}, "edited": false, "score": 0, "creation_date": 1506666085, "post_id": 46466686, "comment_id": 79920107, "body": "The code has been fixed..please check...if its ok...please accept my answer"}, {"owner": {"reputation": 7, "user_id": 8685753, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-bobo7e1wgjM/AAAAAAAAAAI/AAAAAAAACvQ/VBThUKTJEj0/photo.jpg?sz=128", "display_name": "Kam ", "link": "https://stackoverflow.com/users/8685753/kam"}, "edited": false, "score": 0, "creation_date": 1506701824, "post_id": 46466686, "comment_id": 79940426, "body": "I have a meeting that I need to go to so will not be able to check this until the second half of my day. I will get back to you as soon as I can if this works or not. If I can get this to work you bet I will accept your answer."}, {"owner": {"reputation": 561, "user_id": 8558614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2h6yS.jpg?s=128&g=1", "display_name": "Nikolaos Polygenis", "link": "https://stackoverflow.com/users/8558614/nikolaos-polygenis"}, "reply_to_user": {"reputation": 7, "user_id": 8685753, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-bobo7e1wgjM/AAAAAAAAAAI/AAAAAAAACvQ/VBThUKTJEj0/photo.jpg?sz=128", "display_name": "Kam ", "link": "https://stackoverflow.com/users/8685753/kam"}, "edited": false, "score": 0, "creation_date": 1506704697, "post_id": 46466686, "comment_id": 79941796, "body": "Ok no problem!!"}, {"owner": {"reputation": 7, "user_id": 8685753, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-bobo7e1wgjM/AAAAAAAAAAI/AAAAAAAACvQ/VBThUKTJEj0/photo.jpg?sz=128", "display_name": "Kam ", "link": "https://stackoverflow.com/users/8685753/kam"}, "edited": false, "score": 0, "creation_date": 1506721414, "post_id": 46466686, "comment_id": 79949393, "body": "I was able to take a look at the code. It looks like you changed r =2 to r=1. Im not sure why but for whatever reason it doesn&#39;t seem to want to follow the &quot;If WS.Cells(r, 2) = TextBox1.Text Then&quot; command. It seems that even if this command is true it still thinks it&#39;s false and executes the &quot;Else&quot; command and as a result displays the msgbox saying &quot;Sales Order Number not found.&quot; . Any Idea on how to prevent this from happening?"}, {"owner": {"reputation": 7, "user_id": 8685753, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-bobo7e1wgjM/AAAAAAAAAAI/AAAAAAAACvQ/VBThUKTJEj0/photo.jpg?sz=128", "display_name": "Kam ", "link": "https://stackoverflow.com/users/8685753/kam"}, "edited": false, "score": 0, "creation_date": 1506727650, "post_id": 46466686, "comment_id": 79950950, "body": "Awesome. Thank you so much. Everything works flawlessly.How to I accepts your answer here so I can help you out with your score?"}, {"owner": {"reputation": 561, "user_id": 8558614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2h6yS.jpg?s=128&g=1", "display_name": "Nikolaos Polygenis", "link": "https://stackoverflow.com/users/8558614/nikolaos-polygenis"}, "reply_to_user": {"reputation": 7, "user_id": 8685753, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-bobo7e1wgjM/AAAAAAAAAAI/AAAAAAAACvQ/VBThUKTJEj0/photo.jpg?sz=128", "display_name": "Kam ", "link": "https://stackoverflow.com/users/8685753/kam"}, "edited": false, "score": 0, "creation_date": 1506727748, "post_id": 46466686, "comment_id": 79950974, "body": "on the left on zero click the up arrow"}, {"owner": {"reputation": 7, "user_id": 8685753, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-bobo7e1wgjM/AAAAAAAAAAI/AAAAAAAACvQ/VBThUKTJEj0/photo.jpg?sz=128", "display_name": "Kam ", "link": "https://stackoverflow.com/users/8685753/kam"}, "edited": false, "score": 0, "creation_date": 1506727923, "post_id": 46466686, "comment_id": 79951013, "body": "I hit the up arrow and nothing happens. Is there a way I can chat you? This thread is getting a little long. Im curious to know if you offer consulting services but would prefer to not talk about it on a public thread."}, {"owner": {"reputation": 7, "user_id": 8685753, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-bobo7e1wgjM/AAAAAAAAAAI/AAAAAAAACvQ/VBThUKTJEj0/photo.jpg?sz=128", "display_name": "Kam ", "link": "https://stackoverflow.com/users/8685753/kam"}, "edited": false, "score": 0, "creation_date": 1506728185, "post_id": 46466686, "comment_id": 79951055, "body": "Awesome. is there a way to chat with you instead of on this thread? I am wondering if you would be willing to quote me on a project I would like to get started."}], "tags": [], "owner": {"reputation": 561, "user_id": 8558614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2h6yS.jpg?s=128&g=1", "display_name": "Nikolaos Polygenis", "link": "https://stackoverflow.com/users/8558614/nikolaos-polygenis"}, "is_accepted": true, "score": 0, "last_activity_date": 1506666006, "last_edit_date": 1506666006, "creation_date": 1506593960, "answer_id": 46466686, "question_id": 46457618, "link": "https://stackoverflow.com/questions/46457618/updating-excel-worksheet-data-with-userform/46466686#46466686", "title": "Updating excel worksheet data with userform", "body": "<p>Please try this (we suppose that our sheet is the sheet2) :</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CommandButton1_Click()\n\nDim WS As Worksheet\nDim lastrow As Long\nDim r As Long\nDim datee As Date\n\n\nApplication.ScreenUpdating = False\n\n\n\n\n\nIf IsDate(TextBox2.Text) Then\n\n\n\nOn Error GoTo ErrorHandler\n\ndatee = TextBox2.Text\n\n\nSet WS = ActiveWorkbook.Worksheets(\"sheet2\")\nlastrow = WS.Cells(Rows.Count, \"A\").End(xlUp).Row\n\n\nFor r = 2 To lastrow\n\n\nIf WS.Cells(r, 3) = TextBox1.Text And WS.Cells(r, 2) = datee Then\n\n    WS.Cells(r, 4).Value = TextBox2.Text\n    WS.Cells(r, 5).Value = TextBox3.Text\n    WS.Cells(r, 2).Font.Color = vbRed\n    WS.Cells(r, 3).Font.Color = vbRed\n    WS.Cells(r, 4).Font.Color = vbRed\n    WS.Cells(r, 5).Font.Color = vbRed\n\n    MsgBox \"Success\", vbInformation\n\n\nTextBox1.Text = \"\"\n\nTextBox2.Text = \"\"\n\nTextBox3.Text = \"\"\n\nUnload Me\n\n\nApplication.ScreenUpdating = True\n\nExit Sub\n\nEnd If\n\nNext\n\n\n\nMsgBox \"Data not Found!!\", vbCritical\n\n\n\n\nTextBox1.Text = \"\"\n\nTextBox2.Text = \"\"\n\nTextBox3.Text = \"\"\n\nUnload Me\n\n\nApplication.ScreenUpdating = True\n\nExit Sub\n\nErrorHandler: MsgBox \"Sorry an Error occured. \" &amp; vbCrLf &amp; Err.Description\n\nExit Sub\n\nEnd If\n\nMsgBox \"Please Insert Date in the Date Box\", vbCritical\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 8685753, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-bobo7e1wgjM/AAAAAAAAAAI/AAAAAAAACvQ/VBThUKTJEj0/photo.jpg?sz=128", "display_name": "Kam ", "link": "https://stackoverflow.com/users/8685753/kam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1454, "favorite_count": 0, "accepted_answer_id": 46466686, "answer_count": 1, "score": 0, "last_activity_date": 1506666006, "creation_date": 1506548286, "last_edit_date": 1506638942, "question_id": 46457618, "link": "https://stackoverflow.com/questions/46457618/updating-excel-worksheet-data-with-userform", "title": "Updating excel worksheet data with userform", "body": "<p>I am trying to enter in information in a database that I have in excel using a userform. The catch here is that I need to be able to enter data into a specific cell using a text box. For example, I open the userform and in textbox1 I type 123 in textbox2 I type 321. When I hit the submit button in the userform the code should look for the text \"123\" in a specific column. If the text \"123\" exists in the column specified in the code then it should take the data entered in textbox2(321) and put it in a cell adjacent to the cell containing the text 123 </p>\n\n<p>I have combed the internet looking for a solution to this and only found one that only sort of worked. </p>\n\n<p>This is the link to that solution:\n<a href=\"https://youtu.be/cKKgYPfq3_I\" rel=\"nofollow noreferrer\">https://youtu.be/cKKgYPfq3_I</a></p>\n\n<p>The code wouldn't work consistently though. I don't know if this is because some of the edits I made to the code in this video caused the errors or if the code itself had any errors. </p>\n\n<p>This will be for a database that will have a ton of information on it. Having a function like this would make it a lot easier for someone to update information on the database. You could have for example a list of phone numbers and names. With this function it would allow you to enter a name in one text box and a new phone number in the second text box. You could then update an individuals phone number when pushing the submit button. </p>\n\n<p>Any suggestions would be a huge help. </p>\n\n<p>Thanks in advance!  </p>\n\n<p>Below is what I have so far that I found from a different forum and edited from some help that I got from here. It doesn't seem to work. Then again it could be because the code wasn't at all intended for what I would like it to do. (My knowledge of VBA is limited to puzzle piecing code together that I can find that seems to work.)</p>\n\n<pre><code>    Option Explicit\n\nPrivate Sub CommandButton1_Click()\n\nDim WS As Worksheet\nDim lastrow As Long\nDim r As Long\nDim datee As Integer\nDim m As Integer\n\nApplication.ScreenUpdating = False\n\n\n\nm = 1\n\n\nIf IsNumeric(TextBox2.Text) Then\n\n\n\nOn Error GoTo ErrorHandler\n\ndatee = TextBox2.Text\n\n\nSet WS = ActiveWorkbook.Worksheets(\"Scrap\")\nlastrow = WS.Cells(Rows.Count, \"A\").End(xlUp).Row\n\n\nFor r = 1 To lastrow\n\n\nIf WS.Cells(r, 2) = TextBox1.Text Then\n\n    WS.Cells(r, 5).Value = TextBox2.Text\n    WS.Cells(r, 8).Value = TextBox3.Text\n    WS.Cells(r, 9).Value = TextBox4.Text\n    WS.Cells(r, 10).Value = TextBox5.Text\n    WS.Cells(r, 11).Value = TextBox6.Text\n    WS.Cells(r, 12).Value = TextBox7.Text\n    WS.Cells(r, 13).Value = TextBox8.Text\n    WS.Cells(r, 14).Value = TextBox9.Text\n    WS.Cells(r, 15).Value = TextBox10.Text\n    WS.Cells(r, 16).Value = TextBox11.Text\n    WS.Cells(r, 17).Value = TextBox12.Text\n    WS.Cells(r, 18).Value = TextBox13.Text\n    WS.Cells(r, 19).Value = TextBox14.Text\n\n\n    Else\n\n    WS.Cells(r, 2).Font.Color = vbRed\n\n     m = 0\n\n\nEnd If\n\nNext\nIf m = 0 Then\n\nMsgBox \"Sales Order number not found,make sure the Sales Order Number you entered is correct\", vbCritical\n\nElse\n\nMsgBox \"Success\", vbInformation\n\nEnd If\n\nTextBox1.Text = \"\"\n\nTextBox2.Text = \"\"\n\nTextBox3.Text = \"\"\n\nTextBox4.Text = \"\"\n\nTextBox5.Text = \"\"\n\nTextBox6.Text = \"\"\n\nTextBox7.Text = \"\"\n\nTextBox8.Text = \"\"\n\nTextBox9.Text = \"\"\n\nTextBox10.Text = \"\"\n\nTextBox11.Text = \"\"\n\nTextBox12.Text = \"\"\n\nTextBox13.Text = \"\"\n\nTextBox14.Text = \"\"\n\nUnload Me\n\n\nApplication.ScreenUpdating = True\n\nExit Sub\n\nErrorHandler: MsgBox \"Sorry an Error occured. \" &amp; vbCrLf &amp; Err.Description\n\nEnd If\n\nMsgBox \"Please Insert Data\", vbCritical\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access-2016"], "answers": [{"tags": [], "owner": {"reputation": 146, "user_id": 8661377, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uyj1M.jpg?s=128&g=1", "display_name": "JonRo", "link": "https://stackoverflow.com/users/8661377/jonro"}, "is_accepted": false, "score": 0, "last_activity_date": 1506551808, "creation_date": 1506551808, "answer_id": 46458251, "question_id": 46457514, "link": "https://stackoverflow.com/questions/46457514/query-error-on-a-recordset-update-vba-line/46458251#46458251", "title": "Query error on a recordset.update vba line", "body": "<p>This is why I stopped using lookup fields :-( <p>I would delete the table <code>TemporaryTNLabels</code> or rename it to <code>TemporaryTNLabels_OLD</code>. Then recreate the table <code>TemporaryTNLabels</code> from scratch with only one field <code>ParcelNumber</code>, and start from there.</p>\n"}], "owner": {"reputation": 1, "user_id": 8171776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d255cf9bceb22a74c03a6af2e07aebe8?s=128&d=identicon&r=PG&f=1", "display_name": "megruder79", "link": "https://stackoverflow.com/users/8171776/megruder79"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 182, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1506551808, "creation_date": 1506547776, "question_id": 46457514, "link": "https://stackoverflow.com/questions/46457514/query-error-on-a-recordset-update-vba-line", "title": "Query error on a recordset.update vba line", "body": "<p>I am trying to print multiple labels for multiple records. The number of labels is consistent for any one run of the label report and all labels for the same record need to be together on the printed sheet. Parameters are entered on TakeNoticeForm and once a button is clicked a recordset, rsQuery, is created with TakeNoticeLabelQuery. Another recordset is created, rsTable, based on a table, TemporaryTNLabels. This table is a copy of my main table, Certificates, without data. I'm using nested For loops to parse through the query results and add \"x\" copies of said record into the temp table, which will then be used to print the labels. Once the labels are printed the data will be cleared from the temp table for use again later. </p>\n\n<p>Everything I have so far appears to work until I actually start adding data to my temp table. I get Error 3991 - \"The query failed to execute because the identifier '[Certificates].[TownshipID]' could not be found\" and it points to .Update. [TownshipID] is a lookup field in the Certificates table that was the original for TemporaryTNLabels. I tried to keep the copy intact for possible reuse with other reports but I don't <em>need</em> that field for this report so deleted the lookup field from the temp table to hopefully solve the problem. TakeNoticeLabelQuery is actually a copy of another query, TakeNoticeQuery, that did reference Township information. Again, I was hoping to reuse objects but made a copy and only kept what I needed, which has no reference to TownshipID.</p>\n\n<p>After stripping everything unnecessary away, I can't figure out why it's still trying to find [TownshipID]. I'm still trying to wrap my head around recordsets so wondering if the problem is actually elsewhere, buty I'm confused as to how this error is even remotely related to my code. Any help is appreciated. The SQL for the query and code for generating label data are below.</p>\n\n<pre><code>SELECT Certificates.DatabaseID, Certificates.CertCounty, Certificates.TaxYear, Certificates.ParcelNumber, Certificates.MailToFirstName, Certificates.MailToLastName, Certificates.MailToAlso, Certificates.MailToCity, Certificates.MailToState, Certificates.MailToZip\nFROM Counties INNER JOIN Certificates ON Counties.ID = Certificates.CertCounty\nWHERE (((Certificates.DatabaseID) Between ([Forms]![TakeNoticeForm]![FirstDBTextbox]) And ([Forms]![TakeNoticeForm]![LastDBTextbox])) AND ((Certificates.CertCounty) Like [Forms]![TakeNoticeForm]![CountyCombobox] &amp; '*') AND ((Certificates.TaxYear) Like [Forms]![TakeNoticeForm]![TaxYearTextbox] &amp; '*')) OR (((Certificates.CertCounty) Like [Forms]![TakeNoticeForm]![CountyCombobox] &amp; '*') AND ((Certificates.TaxYear) Like [Forms]![TakeNoticeForm]![TaxYearTextbox] &amp; '*') AND ((IsNull([Forms]![TakeNoticeForm]![FirstDBTextbox]))&lt;&gt;False) AND ((IsNull([Forms]![TakeNoticeForm]![LastDBTextbox]))&lt;&gt;False));\n\nOption Compare Database\nOption Explicit\n\nPrivate Sub TNLabelPreviewButton_Click()\n    Dim iTab As Integer\n    Dim iLabel As Integer\n    Dim numLabels As Integer\n    Dim totalRecords As Long\n    Dim db As DAO.Database\n    Dim qdf As DAO.QueryDef\n    Dim rsTable As DAO.Recordset\n    Dim rsQuery As DAO.Recordset\n\n    ' Set query definition for creating recordset\n    Set db = CurrentDb()\n    Set qdf = db.QueryDefs(\"TakeNoticeLabelQuery\")\n    If CurrentProject.AllForms(\"TakeNoticeForm\").IsLoaded Then\n        qdf.Parameters(\"[Forms]![TakeNoticeForm]![FirstDBTextbox]\") = [Forms]![TakeNoticeForm]![FirstDBTextbox]\n        qdf.Parameters(\"[Forms]![TakeNoticeForm]![LastDBTextbox]\") = [Forms]![TakeNoticeForm]![LastDBTextbox]\n        qdf.Parameters(\"[Forms]![TakeNoticeForm]![CountyCombobox]\") = [Forms]![TakeNoticeForm]![CountyCombobox]\n        qdf.Parameters(\"[Forms]![TakeNoticeForm]![TaxYearTextbox]\") = [Forms]![TakeNoticeForm]![TaxYearTextbox]\n'        qdf.Parameters(\"[Forms]![TakeNoticeForm]![TakeNoticeDateTextbox]\") = [Forms]![TakeNoticeForm]![TakeNoticeDateTextbox]\n    Else\n        qdf.Parameters(\"[Forms]![TakeNoticeForm]![FirstDBTextbox]\") = \"\"\n        qdf.Parameters(\"[Forms]![TakeNoticeForm]![LastDBTextbox]\") = \"\"\n        qdf.Parameters(\"[Forms]![TakeNoticeForm]![CountyCombobox]\") = \"\"\n        qdf.Parameters(\"[Forms]![TakeNoticeForm]![TaxYearTextbox]\") = \"\"\n'        qdf.Parameters(\"[Forms]![TakeNoticeForm]![TakeNoticeDateTextbox]\") = CStr(Date)\n    End If\n    Set rsQuery = qdf.OpenRecordset\n    rsQuery.MoveLast\n    totalRecords = rsQuery.RecordCount\n\n    'Close and delete records from TemporaryTNLabels table.\n    DoCmd.SetWarnings False\n    DoCmd.Close acTable, \"TemporaryTNLabels\"\n    DoCmd.RunSQL \"DELETE FROM [TemporaryTNLabels]\"\n    DoCmd.SetWarnings True\n\n    numLabels = Me.NumLabelsTextbox\n    MsgBox numLabels &amp; \" labels\"\n\n    'Open a table-type Recordset\n    Set rsTable = db.OpenRecordset(\"TemporaryTNLabels\", dbOpenTable)\n\n    rsQuery.MoveFirst\n    With rsTable\n        For iTab = 1 To totalRecords\n            For iLabel = 1 To numLabels\n                Debug.Print rsQuery!DatabaseID\n                .AddNew\n                !ParcelNumber = rsQuery!ParcelNumber\n                .Update                 ' &lt;-------------------------This is where the error points.\n                .Bookmark = .LastModified\n            Next iLabel\n            rsQuery.MoveNext\n        Next iTab\n    End With\n\n'    DoCmd.OpenReport ReportName:=\"TakeNoticeLabelReport\", View:=acViewPreview\n\n    rsTable.Close\n    Set rsQuery = Nothing\n    Set qdf = Nothing\n    Set db = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "page-break", "vba"], "answers": [{"comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1506548542, "post_id": 46457466, "comment_id": 79870899, "body": "@K.Davis And why would a sheet be deleted?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1506548644, "post_id": 46457466, "comment_id": 79870940, "body": "@K.Davis And that is completely irrelevant to this macro. <code>ws_count</code> is dynamically created each time - That&#39;s exactly why we use <code>ws_count</code> here instead of a static number like <code>80</code>."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1506548761, "post_id": 46457466, "comment_id": 79870993, "body": "@K.Davis I think you&#39;re misreading the effect of <code>ThisWorkbook.Sheets(i).Activate</code> - <b>Sheet name</b> is irrelevant - that is iterating through the sheets, in order, that exist in the workbook."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1506548864, "post_id": 46457466, "comment_id": 79871036, "body": "If I had 5 sheets, named &quot;Tim&quot;, &quot;Bob&quot;, &quot;Mary&quot;, &quot;Michael&quot;, and &quot;Joe&quot;, <code>ThisWorkbook.Sheets(3).Name</code> would return &quot;Mary&quot;."}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": true, "score": 0, "last_activity_date": 1506547534, "creation_date": 1506547534, "answer_id": 46457466, "question_id": 46457353, "link": "https://stackoverflow.com/questions/46457353/vba-excel-page-break-at-change-in-cell-to-every-worksheet-in-the-workbook/46457466#46457466", "title": "VBA Excel page break at change in cell to every worksheet in the workbook", "body": "<p>A little bit of a sloppy solution (because you shouldn't really use <code>activate</code>), but this should work:   </p>\n\n<pre><code>Option Explicit\nSub Set_PageBreaks()\n\nApplication.ScreenUpdating = False\n\nDim ws_count As Long, i as long, lastrow As Long, c As Range\nws_count = ThisWorkbook.Worksheets.Count\n\nFor i = 1 to ws_count\n\n    ThisWorkbook.Sheets(i).Activate\n\n    lastrow = Cells(Rows.Count, \"B\").End(xlUp).Row\n\n    For Each c In Range(\"A2:A\" &amp; lastrow)\n        If c.Offset(1, 0).Value &lt;&gt; c.Value And c.Offset(1, 0) &lt;&gt; \"\" Then\n            c.Offset(1, 0).PageBreak = xlPageBreakManual\n        End If\n    Next c\n\nNext i\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 0, "last_activity_date": 1506550546, "creation_date": 1506550546, "answer_id": 46458065, "question_id": 46457353, "link": "https://stackoverflow.com/questions/46457353/vba-excel-page-break-at-change-in-cell-to-every-worksheet-in-the-workbook/46458065#46458065", "title": "VBA Excel page break at change in cell to every worksheet in the workbook", "body": "<p>Here is how I would handle your issue:</p>\n\n<pre><code>Option Explicit\n\nSub Set_PageBreaks()\n\n    Dim Sheet As Worksheet, C As Range, lastrow As Long\n\n    Call SpeedUpCode(True)\n\n    For Each Sheet In ThisWorkbook.Sheets\n        lastrow = Cells(Rows.Count, \"B\").End(xlUp).Row\n        For Each C In Range(\"A2:A\" &amp; lastrow)\n            If C.Offset(1, 0).Value &lt;&gt; C.Value And C.Offset(1, 0) &lt;&gt; \"\" Then\n                C.Offset(1, 0).PageBreak = xlPageBreakManual\n            End If\n        Next C\n    Next Sheet\n\n    Call SpeedUpCode(False)\n\nEnd Sub\n\nSub SpeedUpCode(ByVal Value As Boolean)\n    With Application\n        If Value = True Then\n            .ScreenUpdating = False\n            .Calculation = xlCalculationManual\n        ElseIf Value = False Then\n            .ScreenUpdating = True\n            .Calculation = xlCalculationAutomatic\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8685723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18338122b9c0192b3da31f33050bc8c9?s=128&d=identicon&r=PG&f=1", "display_name": "bbarth", "link": "https://stackoverflow.com/users/8685723/bbarth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 316, "favorite_count": 0, "accepted_answer_id": 46457466, "answer_count": 2, "score": 0, "last_activity_date": 1506550546, "creation_date": 1506547013, "last_edit_date": 1531164843, "question_id": 46457353, "link": "https://stackoverflow.com/questions/46457353/vba-excel-page-break-at-change-in-cell-to-every-worksheet-in-the-workbook", "title": "VBA Excel page break at change in cell to every worksheet in the workbook", "body": "<p>I have some code to add a page break at a change in cell contents, however I am unable to get it to run for more than the active sheet. I have about 80 sheets I need to run this on and need it to run at the same time. I have tried running it on ThisWorkbook, but it doesn't work. It will work great on a sheet by sheet basis, but not on the entire workbook.</p>\n\n<pre><code>Option Explicit\n\nSub Set_PageBreaks()\n\n    Dim lastrow As Long, c As Range\n\n    lastrow = Cells(Rows.Count, \"B\").End(xlUp).Row\n\n    Application.ScreenUpdating = False\n\n    For Each c In Range(\"A2:A\" &amp; lastrow)\n        If c.Offset(1, 0).Value &lt;&gt; c.Value And c.Offset(1, 0) &lt;&gt; \"\" Then\n            c.Offset(1, 0).PageBreak = xlPageBreakManual\n        End If\n    Next c\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 0, "creation_date": 1506547056, "post_id": 46457326, "comment_id": 79870325, "body": "Yes. Search for <code>Workbook.name</code>, <code>Like</code> operator and wildcards. Come back after you did your research with specific questions and code examples."}], "answers": [{"comments": [{"owner": {"reputation": 110, "user_id": 8676713, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/95724206c280d2070460f995332e8788?s=128&d=identicon&r=PG&f=1", "display_name": "yossup", "link": "https://stackoverflow.com/users/8676713/yossup"}, "edited": false, "score": 0, "creation_date": 1506694409, "post_id": 46485834, "comment_id": 79935803, "body": "I tried removing the space in the sheet name, and editing my code accordingly. However, now I am recieving the same error at line: Set lastcell = wb.Sheets(&quot;Proof&quot;).Range(&quot;C3&quot; &amp; Rows.Count).End(xlUp).Offset(1)"}, {"owner": {"reputation": 101, "user_id": 7524850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38a5563dea0d32093c89d4e1c8e1a6ad?s=128&d=identicon&r=PG&f=1", "display_name": "N Hanson", "link": "https://stackoverflow.com/users/7524850/n-hanson"}, "reply_to_user": {"reputation": 110, "user_id": 8676713, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/95724206c280d2070460f995332e8788?s=128&d=identicon&r=PG&f=1", "display_name": "yossup", "link": "https://stackoverflow.com/users/8676713/yossup"}, "edited": false, "score": 0, "creation_date": 1506695135, "post_id": 46485834, "comment_id": 79936266, "body": "@yossup is your expectation that lastcell = the last row (+1) in column C?"}, {"owner": {"reputation": 101, "user_id": 7524850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38a5563dea0d32093c89d4e1c8e1a6ad?s=128&d=identicon&r=PG&f=1", "display_name": "N Hanson", "link": "https://stackoverflow.com/users/7524850/n-hanson"}, "reply_to_user": {"reputation": 110, "user_id": 8676713, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/95724206c280d2070460f995332e8788?s=128&d=identicon&r=PG&f=1", "display_name": "yossup", "link": "https://stackoverflow.com/users/8676713/yossup"}, "edited": false, "score": 0, "creation_date": 1506696153, "post_id": 46485834, "comment_id": 79936947, "body": "@yossup I have edited my original answer with a solution."}, {"owner": {"reputation": 110, "user_id": 8676713, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/95724206c280d2070460f995332e8788?s=128&d=identicon&r=PG&f=1", "display_name": "yossup", "link": "https://stackoverflow.com/users/8676713/yossup"}, "edited": false, "score": 1, "creation_date": 1506697696, "post_id": 46485834, "comment_id": 79937971, "body": "Ha, it turns out my Proof tab had an extra space! thanks N Hanson"}], "tags": [], "owner": {"reputation": 101, "user_id": 7524850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38a5563dea0d32093c89d4e1c8e1a6ad?s=128&d=identicon&r=PG&f=1", "display_name": "N Hanson", "link": "https://stackoverflow.com/users/7524850/n-hanson"}, "is_accepted": true, "score": 1, "last_activity_date": 1506696139, "last_edit_date": 1506696139, "creation_date": 1506677203, "answer_id": 46485834, "question_id": 46457326, "link": "https://stackoverflow.com/questions/46457326/subscript-out-of-range-even-though-i-have-specified-ranges-and-worksheets/46485834#46485834", "title": "Subscript out of range, even though I have specified ranges and worksheets", "body": "<p>It <em>looks</em> like the name of your Bank Statement tab has a space appended to the end.</p>\n\n<p>i.e.</p>\n\n<p>\"Bank Statement \"\nvs\n\"Bank Statement\"</p>\n\n<p>I have tested your code and it works without a problem, so that could be the answer.</p>\n\n<p>Edit:</p>\n\n<p>To find the last cell +1 in column C as assign to range variable, change the below:</p>\n\n<p><code>Set lastcell = wb.Sheets(\"Proof\").Range(\"C3\" &amp; Rows.Count).End(xlUp).Offset(1)</code></p>\n\n<p>to</p>\n\n<p><code>Set lastcell = wb.Sheets(\"Proof\").Range(\"C5000\").End(xlUp).Offset(1)</code></p>\n\n<p>As long as your expected last cell is lower than 5000 this should work. Your <code>Range()</code> will need to be larger than your highest expected row. If you expect to have 10 rows of data <code>Range(\"A50\")</code> would work, but if you have 10,000 rows, <code>Range(\"A10001\")</code> would be required, etc.</p>\n"}], "owner": {"reputation": 110, "user_id": 8676713, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/95724206c280d2070460f995332e8788?s=128&d=identicon&r=PG&f=1", "display_name": "yossup", "link": "https://stackoverflow.com/users/8676713/yossup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 46485834, "answer_count": 1, "score": -2, "last_activity_date": 1506696139, "creation_date": 1506546896, "last_edit_date": 1506634837, "question_id": 46457326, "link": "https://stackoverflow.com/questions/46457326/subscript-out-of-range-even-though-i-have-specified-ranges-and-worksheets", "title": "Subscript out of range, even though I have specified ranges and worksheets", "body": "<p>I am recieving a subscript out of range error for the last piece of logic in my code:</p>\n\n<pre><code>Sub Extract_Bank_Amount()\n\nDim wb As Workbook\nDim ws As Worksheet\nDim rng1 As Range, rng2 As Range, lastcell As Range\nDim lRow As Long, i As Long\n\nSet wb = ActiveWorkbook\nSet ws = wb.Sheets(\"Bank Statement\")\n\nSet rng1 = wb.Sheets(\"Payroll Journal\").Range(\"B1\")\nSet rng2 = wb.Sheets(\"Payroll Journal\").Range(\"B3\")\nSet lastcell = wb.Sheets(\"Proof\").Range(\"C3\" &amp; Rows.Count).End(xlUp).Offset(1)\n\n\n wb.Sheets(\"Bank Statement\").Activate\n\n With ws\n\n    lRow = .Range(\"B\" &amp; .Rows.Count).End(xlUp).Row\n\n       For i = 2 To lRow\n\n           If .Range(\"A\" &amp; i).Value = rng1 Then\n           If .Range(\"C\" &amp; i).Value = rng2 Then\n                lastcell = .Range(\"B\" &amp; i).Value\n           End If\n           End If\n    Next i\nEnd With\nEnd Sub\n</code></pre>\n\n<p>It gives me a subscript out of range at this line:</p>\n\n<pre><code>Set ws = wb.Sheets(\"Bank Statement\")\n</code></pre>\n\n<p>I appreciate any help, thanks. <a href=\"https://i.stack.imgur.com/rBrd0.png\" rel=\"nofollow noreferrer\">link to screenshot of sheet</a></p>\n"}, {"tags": ["vba", "format", "label", "protected", "trendline"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1506547404, "post_id": 46457202, "comment_id": 79870472, "body": "Unprotect the sheet, do the change, re-protect the sheet."}, {"owner": {"reputation": 81, "user_id": 8636130, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c4df4ab32ceea69e1355823354c825d0?s=128&d=identicon&r=PG", "display_name": "L Kadue", "link": "https://stackoverflow.com/users/8636130/l-kadue"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1506547572, "post_id": 46457202, "comment_id": 79870529, "body": "Shouldn&#39;t there be a more precise way to do it?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1506547658, "post_id": 46457202, "comment_id": 79870561, "body": "I don&#39;t understand what &quot;precise&quot; means in this context. The sheet is protected, a user can&#39;t modify it - code can&#39;t modify it either, that&#39;s what it&#39;s being protected for."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1506547695, "post_id": 46457202, "comment_id": 79870577, "body": "Actually, there is: <a href=\"https://stackoverflow.com/a/126032/1188513\">stackoverflow.com/a/126032/1188513</a> - if <i>that</i> doesn&#39;t work, then you&#39;re out of options."}, {"owner": {"reputation": 81, "user_id": 8636130, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c4df4ab32ceea69e1355823354c825d0?s=128&d=identicon&r=PG", "display_name": "L Kadue", "link": "https://stackoverflow.com/users/8636130/l-kadue"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1506549349, "post_id": 46457202, "comment_id": 79871194, "body": "I&#39;ve already set the protect to UserInterfaceOnly. That&#39;s how I&#39;m able to run my VBA at all. For some reason when my trendline is being added it&#39;s protected from the vba."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1506549497, "post_id": 46457202, "comment_id": 79871244, "body": "So, I guess that leaves one option then!"}], "owner": {"reputation": 81, "user_id": 8636130, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c4df4ab32ceea69e1355823354c825d0?s=128&d=identicon&r=PG", "display_name": "L Kadue", "link": "https://stackoverflow.com/users/8636130/l-kadue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 314, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1506546726, "creation_date": 1506546260, "last_edit_date": 1506546726, "question_id": 46457202, "link": "https://stackoverflow.com/questions/46457202/vba-how-to-change-datalabel-numberformat-when-protected", "title": "VBA: how to change DataLabel NumberFormat when Protected", "body": "<p>I am adding a Trendline to a Chart and want to change the NumberFormat in the datalabel before I capture the datalabel as a string. Originally I was doing it like this:</p>\n\n<pre><code>Sub AddLine()\n    ActiveChart.SeriesCollection(1).Trendlines.Add Type:=xlLinear, _\n        intercept:=0, DisplayEquation:=1, DisplayRSquared:=1, Name:=\"Linear\"\nEnd Sub\nSub Eqn()\n    Dim t As Trendline\n    Dim eqn As String\n    Set t = ActiveChart.SeriesCollection(1).Trendlines(1)\n    t.DataLabel.NumberFormat = \"0.0000E+00\"\n    Application.Wait (Now + TimeValue(\"0:00:01\"))\n    eqn = ActiveChart.SeriesCollection(1).Trendlines(1).DataLabel.text\n    'other stuff\nEnd Sub\nSub Run()\n    Call AddLine\n    Call Eqn\nEnd Sub\n</code></pre>\n\n<p>This was working fine until I started protecting my sheets. I specifically protected my sheets in VBA so I could use UserInterFaceOnly:=True. Despite this, VBA is throwing an error when I try to change the NumberFormat. I tried to get around this by changing my code to the following:</p>\n\n<pre><code>Sub AddLine()\n    With ActiveChart.SeriesCollection(1)\n        .Trendlines.Add Type:=xlExponential, Forward:=0, Backward:=0, _\n            DisplayEquation:=1, DisplayRSquared:=1, Name:=\"Exponential\"\n        .Trendlines(1).DataLabel.NumberFormat = \"0.0000E+00\"\n    End With\nEnd Sub\nSub Eqn()\n    Dim eqn As String\n    Application.Wait (Now + TimeValue(\"0:00:01\"))\n    eqn = ActiveChart.SeriesCollection(1).Trendlines(1).DataLabel.text\n    'other stuff\nEnd Sub\nSub Run()\n    Call AddLine\n    Call Eqn\nEnd Sub\n</code></pre>\n\n<p>This also worked just fine when it was operating without protection, but again threw an error when I got to setting the NumberFormat when it was protected.</p>\n\n<p>Is there a way to change the NumberFormat of a Trendline.DataLabel when the worksheet is protected with UserInterFaceOnly:=True?</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1506548526, "post_id": 46456885, "comment_id": 79870895, "body": "I don&#39;t think Access SQL recognizes IF EXISTS. Regardless, RunSQL is for action sql like DELETE, INSERT, UPDATE, CREATE TABLE. Options: 1. Declare and open a recordset object and check its recordcount property 2. set table links and use DLookup() on the link."}, {"owner": {"reputation": 11, "user_id": 6179054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f14ff91a38aab0c5fd7afa3586dc28?s=128&d=identicon&r=PG&f=1", "display_name": "Exeter", "link": "https://stackoverflow.com/users/6179054/exeter"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1506601184, "post_id": 46456885, "comment_id": 79892781, "body": "@June7 - I was hoping I was misusing IF EXISTS being a rookie. I am using your option 1 now or at least have the first of the 3 built and tested.  Thank you."}, {"owner": {"reputation": 11, "user_id": 6179054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f14ff91a38aab0c5fd7afa3586dc28?s=128&d=identicon&r=PG&f=1", "display_name": "Exeter", "link": "https://stackoverflow.com/users/6179054/exeter"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1507297501, "post_id": 46456885, "comment_id": 80166199, "body": "@June7 - if you write option 1 up I&#39;ll mark it as the answer. Thanks."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1507312912, "post_id": 46456885, "comment_id": 80174987, "body": "That&#39;s okay. If you developed working code and want to show answer for other readers, go ahead."}], "answers": [{"comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1506588599, "post_id": 46462618, "comment_id": 79884552, "body": "Would have to set links to the remote tables to use domain aggregate function."}, {"owner": {"reputation": 11, "user_id": 6179054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f14ff91a38aab0c5fd7afa3586dc28?s=128&d=identicon&r=PG&f=1", "display_name": "Exeter", "link": "https://stackoverflow.com/users/6179054/exeter"}, "edited": false, "score": 0, "creation_date": 1506601294, "post_id": 46462618, "comment_id": 79892860, "body": "@Kostas K - I&#39;ll look at this but I think June7 is correct. It seems difficult to get to remote data without links in Access. Thank you."}], "tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1506581156, "creation_date": 1506581156, "answer_id": 46462618, "question_id": 46456885, "link": "https://stackoverflow.com/questions/46456885/access-2010-determine-existence-of-record-in-one-of-three-remote-mdb-files-for/46462618#46462618", "title": "Access 2010 - Determine existence of record in one of three remote mdb files for subsequent select", "body": "<p>How about a simple Function to check if exists by passing the table name and value?</p>\n\n<p>Something like this:</p>\n\n<pre><code>Public Function ExistInTable(Byval TableName As String, ByVal Value As String) As Boolean\n    ExistInTable = (DCount(\"*\", TableName, \"[SKUNo]='\" &amp; Value &amp; \"'\" &gt; 0)\nEnd Function\n</code></pre>\n\n<p>To call it:</p>\n\n<pre><code>Sub Test()\n    If ExistInTable(\"T1\", \"Whatever\") Then 'Exists in T1\n    If ExistInTable(\"T2\", \"Whatever\") Then 'Exists in T2\n    '....\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 6179054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f14ff91a38aab0c5fd7afa3586dc28?s=128&d=identicon&r=PG&f=1", "display_name": "Exeter", "link": "https://stackoverflow.com/users/6179054/exeter"}, "edited": false, "score": 0, "creation_date": 1506601450, "post_id": 46465174, "comment_id": 79892974, "body": "I&#39;ll try this approach and let you know. I have a machine down so I don&#39;t know if I&#39;ll get to it today. Thank you for your input."}, {"owner": {"reputation": 11, "user_id": 6179054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f14ff91a38aab0c5fd7afa3586dc28?s=128&d=identicon&r=PG&f=1", "display_name": "Exeter", "link": "https://stackoverflow.com/users/6179054/exeter"}, "edited": false, "score": 0, "creation_date": 1506685349, "post_id": 46465174, "comment_id": 79930549, "body": "@ June 7 - I missed the question yesterday, answer is yes, in a perfect world. In reality, those tables are manually maintained so ..."}], "tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 1, "last_activity_date": 1506709248, "last_edit_date": 1506709248, "creation_date": 1506589431, "answer_id": 46465174, "question_id": 46456885, "link": "https://stackoverflow.com/questions/46456885/access-2010-determine-existence-of-record-in-one-of-three-remote-mdb-files-for/46465174#46465174", "title": "Access 2010 - Determine existence of record in one of three remote mdb files for subsequent select", "body": "<p>Will the sought for SKU always occur in only 1 of the tables? </p>\n\n<p>If you don't want to set table links or use VBA recordsets, only other approach I can see is a query object with a dynamic parameter that references a form control for the SKU input. No idea if this will be faster and will need a query for each remote table.<br>\n<code>SELECT SKUNo FROM xxTable IN \"S:\\Our Inventory\\Cust Sleeves.mdb\" WHERE SKUNo = Forms!formname!cbxSKU</code></p>\n\n<p>Then just do DCount on the query.</p>\n\n<pre><code>Dim intDbToSearch As Integer\nIf DCount(\"*\", \"xxQuery\") &gt; 0 Then\n    intDbToSearch = 1\nEnd If\n</code></pre>\n\n<p>Could UNION the SELECT statements so would have only 1 query object to work with.  </p>\n\n<pre><code>SELECT \"x1\" AS Source, SKUNo FROM xxTable IN \"S:\\Our Inventory 1\\Cust Sleeves.mdb\" WHERE SKUNo = Forms!formname!cbxSKU\nUNION SELECT \"x2\", SKUNo FROM xxTable IN \"S:\\Our Inventory 2\\Cust Sleeves.mdb\" WHERE SKUNo = Forms!formname!cbxSKU\nUNION SELECT \"x3\", SKUNo FROM xxTable IN \"S:\\Our Inventory 3\\Cust Sleeves.mdb\" WHERE SKUNo = Forms!formname!cbxSKU;\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6179054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f14ff91a38aab0c5fd7afa3586dc28?s=128&d=identicon&r=PG&f=1", "display_name": "Exeter", "link": "https://stackoverflow.com/users/6179054/exeter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1507297414, "creation_date": 1506544900, "last_edit_date": 1507297414, "question_id": 46456885, "link": "https://stackoverflow.com/questions/46456885/access-2010-determine-existence-of-record-in-one-of-three-remote-mdb-files-for", "title": "Access 2010 - Determine existence of record in one of three remote mdb files for subsequent select", "body": "<p>There are three mdb files in folders on a network drive that may hold the required record(s). How do I determine which db holds the record(s), ideally without data transfer/linking/etc.? Then a single SQL or DAO select can get the data from the correct db. Note: I'm trying to use Access as a front end to SQL using existing Access data spread all around the network drives.</p>\n\n<p>My current solution of configuring 3 DAO objects and checking for no results, in succession until found, seems to load the remote tables to the local recordset and takes too long.</p>\n\n<p>Is there a way to use IF EXISTS in this scenario?</p>\n\n<p>This code throws \"Invalid SQL statement; expected DELETE,INSERT,PROCEDURE,SELECT,OR UPDATE\" error but is generally what I'd like to do :</p>\n\n<pre><code>Dim strSQL As String\nDim strSku As String\nDim intDbToSearch As Integer\nstrSku = DLookup(\"SKUNo\", \"tblCurrentItem\")   'Note: this returns valid SKU#\nstrSQL = \"IF EXISTS(SELECT xxTable.SKUNo \"\nstrSQL = strSQL &amp; \"FROM [S:\\Our Inventory\\Cust Sleeves.mdb].[xxTable] \"\nstrSQL = strSQL &amp; \"Where xxTable.SKUNo = \" &amp; \"'\" &amp; strSku &amp; \"') Then intDbToSearch = 1\"  \n\nDoCmd.RunSQL strSQL\n</code></pre>\n\n<p>This is one of three IF Exists that would run if SKUNo not found in db 1 or 2.</p>\n\n<p>Ultimately intDbToSearch should point to db 1,2,or 3 if SKUNo found or 0 if not.</p>\n\n<p>Thanks</p>\n\n<p>In the end, I pushed usage rules for the 3 databases upstream and can now predetermine which database to search. Thanks again for your input.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1506544783, "post_id": 46456818, "comment_id": 79869328, "body": "Try to add &quot;Application.Volatile&quot; on top of your function, it should do what you want."}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 1, "creation_date": 1506547401, "post_id": 46456818, "comment_id": 79870469, "body": "If CalculateFullRebuild does not work something else is wrong. Try calling the finction from a sub in vba, see what it returns."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1506547762, "post_id": 46456818, "comment_id": 79870603, "body": "those statements are all <code>comments</code>. you do not have any executable statements in your sub"}, {"owner": {"reputation": 61, "user_id": 2725068, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/7d662ee35d453ce723524d90b59f7ce6?s=128&d=identicon&r=PG&f=1", "display_name": "Draco Mraz", "link": "https://stackoverflow.com/users/2725068/draco-mraz"}, "edited": false, "score": 0, "creation_date": 1506581132, "post_id": 46456818, "comment_id": 79879923, "body": "Application.volatile dont work in my case. Maybe there is something other wrong."}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 2725068, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/7d662ee35d453ce723524d90b59f7ce6?s=128&d=identicon&r=PG&f=1", "display_name": "Draco Mraz", "link": "https://stackoverflow.com/users/2725068/draco-mraz"}, "is_accepted": false, "score": 0, "last_activity_date": 1506601945, "creation_date": 1506601945, "answer_id": 46469267, "question_id": 46456818, "link": "https://stackoverflow.com/questions/46456818/how-to-autoexecute-or-calculate-own-written-excel-vba-public-functions-in-define/46469267#46469267", "title": "How to autoexecute or calculate own written Excel vba public functions in defined cells", "body": "<p>The solution for this problem is:\ni have had the code in the wrong Object/module.\ni putted it in Microsoft Excel Objects \\ This Workbook\nand Worksheet5 (Aktie).\nBefore i had it in Module \\ modul 1 where i have the public functions too.</p>\n"}], "owner": {"reputation": 61, "user_id": 2725068, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/7d662ee35d453ce723524d90b59f7ce6?s=128&d=identicon&r=PG&f=1", "display_name": "Draco Mraz", "link": "https://stackoverflow.com/users/2725068/draco-mraz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1506601945, "creation_date": 1506544604, "last_edit_date": 1506577974, "question_id": 46456818, "link": "https://stackoverflow.com/questions/46456818/how-to-autoexecute-or-calculate-own-written-excel-vba-public-functions-in-define", "title": "How to autoexecute or calculate own written Excel vba public functions in defined cells", "body": "<p>I wrote a public function in VBA which make a <code>HTTP-request</code> to a Website and returns back a double value.</p>\n\n<p>I use the function in 5 cells. When i open the <code>Excel-File</code> the cells don't update automatically.</p>\n\n<p>How to setup Excel to execute the SelfMade public functions in some cells?</p>\n\n<p>I have tested the following VBA statements but nothing works.</p>\n\n<pre><code>Private Sub Workbook_Open()\n'Application.Calculation = xlCalculationAutomatic\n'Application.CalculateFull\n'Application.CalculateFullRebuild\n'Worksheets(\"Aktie\").Activate\n'Range(\"J3:J6\").Calculate\n'ActiveWorkbook.RefreshAll\n'Range(\"J3:J6\").Select\n\n'Worksheets(\"Aktie\").Range(\"J3:J6\").Calculate\n\nEnd Sub\n</code></pre>\n\n<p>What i am doing wrong?</p>\n\n<p>Which settings i have to make?</p>\n\n<p>Where to put he VBA code to autoExecute it when open the XLS?</p>\n"}, {"tags": ["vba", "excel", "powerpoint"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1506544663, "post_id": 46456480, "comment_id": 79869265, "body": "<code>IQRngRef</code> is an array of <code>Range</code> objects, but you&#39;re assigning its indices with <code>Variant</code> values / the <i>contents</i> of <code>Range</code> objects. Either use <code>Set</code> and drop the <code>.Value</code> (to work with <code>Range</code> objects), or declare it as a variant array."}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1506544668, "post_id": 46456480, "comment_id": 79869268, "body": "try declaring them as variant like <code>Dim IQRngRef() As variant</code> or <code>Dim IQRngRef()</code>"}], "answers": [{"comments": [{"owner": {"reputation": 225, "user_id": 8592765, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cfbc123f552b4961420b8690b0e70fac?s=128&d=identicon&r=PG&f=1", "display_name": "Pinlop", "link": "https://stackoverflow.com/users/8592765/pinlop"}, "edited": false, "score": 1, "creation_date": 1506546635, "post_id": 46456963, "comment_id": 79870166, "body": "This is the first time I understood what <code>Set</code> does after reading over many, many posts. Thank you! .... But my problems are not all fixed :( I get a <code>Run-Time Error 9</code> now on <code>Set tempRng(0) = ShRef.Columns(1)</code> and am expecting to get one on <code>Set unionVariable = tempRng(0)</code> as well?"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 3, "last_activity_date": 1506545245, "creation_date": 1506545245, "answer_id": 46456963, "question_id": 46456480, "link": "https://stackoverflow.com/questions/46456480/run-time-error-91-on-arrays/46456963#46456963", "title": "Run-time error 91 on arrays", "body": "<pre><code>Dim something() As String\n</code></pre>\n\n<p>That's declaring a dynamically-sized array, where each item is a <code>String</code>. Once it's resized, you can do this (assuming <code>i</code> is within the boundaries of the array):</p>\n\n<pre><code>something(i) = \"foo\"\n</code></pre>\n\n<p>Now this:</p>\n\n<pre><code>Dim something() As Range\n</code></pre>\n\n<p>That's declaring a dynamically-sized array, where each item is a <code>Range</code>. Once it's resized, you can do this (assuming <code>i</code> is within the boundaries of the array):</p>\n\n<pre><code>Set something(i) = Range(\"A1\")\n</code></pre>\n\n<p>Notice the <code>Set</code> keyword - it's <em>required</em> in VBA, whenever you're assigning an <em>object reference</em>. <code>Range</code> being an object, you need the <code>Set</code> keyword for that assignment.</p>\n\n<p>In your code:</p>\n\n<blockquote>\n<pre><code>tempRng(0) = ShRef.Columns(1)\n</code></pre>\n</blockquote>\n\n<p>That's indeed a <code>Range</code>, but the <code>Set</code> keyword is missing. That will throw the RTE91 you're getting.</p>\n\n<p>Same here:</p>\n\n<blockquote>\n<pre><code>unionVariable = tempRng(0)\n</code></pre>\n</blockquote>\n\n<p>You can't assign an object reference without the <code>Set</code> keyword.</p>\n\n<p>Here though:</p>\n\n<blockquote>\n<pre><code>IQRngRef(iCol) = ShRef.Range(ShRef.Cells(1, iCol), ShRef.Cells(rowNumb, iCol)).Value\n</code></pre>\n</blockquote>\n\n<p>That's not a <code>Range</code>. It's the <code>.Value</code> of a <code>Range</code>, and that's a <code>Variant</code> - not an object, so adding the <code>Set</code> keyword isn't going to fix anything. If you mean <code>IQRngRef</code> to hold <code>Range</code> objects, you need to do this:</p>\n\n<pre><code>Set IQRngRef(iCol) = ShRef.Range(ShRef.Cells(1, iCol), ShRef.Cells(rowNumb, iCol))\n</code></pre>\n"}], "owner": {"reputation": 225, "user_id": 8592765, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cfbc123f552b4961420b8690b0e70fac?s=128&d=identicon&r=PG&f=1", "display_name": "Pinlop", "link": "https://stackoverflow.com/users/8592765/pinlop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 555, "favorite_count": 0, "accepted_answer_id": 46456963, "answer_count": 1, "score": 2, "last_activity_date": 1506545245, "creation_date": 1506543308, "last_edit_date": 1531164843, "question_id": 46456480, "link": "https://stackoverflow.com/questions/46456480/run-time-error-91-on-arrays", "title": "Run-time error 91 on arrays", "body": "<p>I'm getting <code>Run-time error 91</code> on several variable, and I really have no idea what I'm doing wrong...</p>\n\n<p>The variables are: <code>IQRngRef</code>, <code>tempRng</code>, <code>unionVariable</code></p>\n\n<p>I assume it has something with them all being arrays with the exception of unionVariable (at least it shouldn't be).</p>\n\n<p>Could I get some help here please?</p>\n\n<pre><code>    Option Explicit\n\n    Private Sub averageScoreRelay()\n        ' 1. Run from PPT and open an Excel file\n        ' 2. Start at slide 1 and find a box that contains the words \"iq_\", if it has those words then it will have numbers after it like so \"iq_43\" or \"iq_43, iq_56,iq_72\".\n        ' 3. find those words and numbers in the opened Excel file after splitting and re-formating string.\n        ' 3. Copy column into a new sheets and repeat for all \"iq_'s\" until sheets 2 has a table.\n        ' 4. Copy table from xl Paste Table into ppt\n        ' 5. Do this for every slide\n\n        'Timer start\n        Dim StartTime As Double\n        Dim SecondsElapsed As Double\n        StartTime = Timer\n\n\n        'Create variables\n        Dim xlApp As Excel.Application\n        Dim xlWB As Excel.Workbook\n        Dim ShRef As Excel.Worksheet\n        Dim pptPres As Object\n        Dim colNumb As Long\n        Dim rowNumb As Long\n\n        ' Create new excel instance and open relevant workbook\n        Set xlApp = New Excel.Application\n        'xlApp.Visible = True 'Make Excel visible\n        Set xlWB = xlApp.Workbooks.Open(\"C:\\Users\\Pinlop\\Desktop\\Gate\\Macros\\averageScores\\pptxlpratice\\dummy2.xlsx\", True, False, , , , True, Notify:=False) 'Open relevant workbook\n        If xlWB Is Nothing Then                      ' may not need this if statement. check later.\n            MsgBox (\"Error retrieving Average Score Report, Check file path\")\n            Exit Sub\n        End If\n        xlApp.DisplayAlerts = False\n\n        'Find # of iq's in workbook\n        Set ShRef = xlWB.Worksheets(\"Sheet1\")\n        colNumb = ShRef.Cells(1, ShRef.Columns.Count).End(xlToLeft).Column\n        rowNumb = ShRef.Cells(ShRef.Rows.Count, 1).End(xlUp).Row\n\n        Dim IQRef() As String\n        Dim iCol As Long\n        Dim IQRngRef() As Range\n\n        ReDim IQRef(colNumb)\n        ReDim IQRngRef(colNumb)\n\n        ' capture IQ refs locally\n        For iCol = 2 To colNumb\n            IQRngRef(iCol) = ShRef.Range(ShRef.Cells(1, iCol), ShRef.Cells(rowNumb, iCol)).Value\n            IQRef(iCol) = ShRef.Cells(1, iCol).Value\n        Next iCol\n\n        'Make pptPres the ppt active\n        Set pptPres = PowerPoint.ActivePresentation\n\n        'Create variables for the slide loop\n        Dim pptSlide As Slide\n        Dim Shpe As Shape\n        Dim pptText As String\n        Dim iq_Array As Variant\n        Dim arrayLoop As Long\n        Dim myShape As Object\n        Dim outCol As Long\n        Dim i As Long\n        Dim lRows As Long\n        Dim lCols As Long\n        Dim k As Long\n\n        'Loop through each pptSlide and check for IQ text box, grab avgScore values and create pptTable\n        For Each pptSlide In pptPres.Slides\n\n            i = 0\n            pptSlide.Select\n\n            'searches through shapes in the slide\n            For Each Shpe In pptSlide.Shapes\n\n                If Not Shpe.HasTextFrame Then GoTo nextShpe 'boom, one less nested If statement\n                If Not Shpe.TextFrame.HasText Then GoTo nextShpe ' boom, another nested If statement bites the dust\n\n                outCol = 0\n\n                'Set pptText as the Text in the box, then make it lowercase and trim Spaces and Enters\n                pptText = Shpe.TextFrame.TextRange\n                pptText = LCase(Replace(pptText, \" \", vbNullString))\n                pptText = Replace(Replace(Replace(pptText, vbCrLf, vbNullString), vbCr, vbNullString), vbLf, vbNullString)\n\n\n                'Identify if within text there is \"iq_\"\n                If InStr(1, pptText, \"iq_\") &lt;= 0 Then GoTo nextShpe\n\n                'set iq_Array as an array of the split iq's\n                iq_Array = Split(pptText, \",\")\n\n                Dim hasIQs As Boolean\n                Dim checkStr As String\n                Dim pCol As Long\n                Dim checkOne\n\n                checkOne = iq_Array(0)\n\n                hasIQs = Left(checkOne, 3) = \"iq_\"\n\n                Dim tempRng() As Range\n\n                If hasIQs Then\n                    ' paste inital column into temporary worksheet\n                    tempRng(0) = ShRef.Columns(1)\n                End If\n\n                ' loop for each iq_ in the array\n                For arrayLoop = LBound(iq_Array) To UBound(iq_Array)\n                    ' Take copy of potential ref and adjust to standard if required\n                    checkStr = iq_Array(arrayLoop)\n                    If hasIQs And Left(checkStr, 3) &lt;&gt; \"iq_\" Then checkStr = \"iq_\" &amp; checkStr\n\n                    ' Look for existence of corresponding column in local copy array\n                    pCol = 0\n                    For iCol = 2 To colNumb\n                        If checkStr = IQRef(iCol) Then\n                            pCol = iCol\n                            Exit For\n                        End If\n                    Next iCol\n\n                    If pCol &gt; 0 Then\n                        ' Paste the corresponding column into the forming table\n                        outCol = outCol + 1\n                        tempRng(outCol) = ShRef.Columns(pCol)\n                    End If\n\n                Next arrayLoop\n\n                If outCol &gt; 1 Then                   'data was added\n                    ' Copy table\n\n                    Dim unionVariable As Range\n\n                    unionVariable = tempRng(0)\n\n\n                    For k = 1 To i\n                        unionVariable = Union(unionVariable, tempRng(k))\n                    Next k\n\n                    unionVariable.Copy               ' all the data added to ShWork\n\ntryAgain:\n\n                    ActiveWindow.ViewType = ppViewNormal\n                    ActiveWindow.Panes(2).Activate\n\n                    Set myShape = pptSlide.Shapes.PasteSpecial(DataType:=ppPasteHTML, Link:=msoFalse)\n\n                    On Error GoTo tryAgain\n                    On Error GoTo clrSht\n\n                    'Set position:\n                    myShape.Left = -200\n                    myShape.Top = 150 + i\n                    i = i + 150\n\n                End If\n\nclrSht:\n\n                'Clear Sheet2 for next slide\n                Erase tempRng()\n\nnextShpe:\n\n            Next Shpe\n\nnextSlide:\n\n        Next pptSlide\n\n        xlWB.Close\n        xlApp.Quit\n\n        xlApp.DisplayAlerts = True\n\n        'End Timer\n        SecondsElapsed = Round(Timer - StartTime, 2)\n        MsgBox \"This code ran successfully in \" &amp; SecondsElapsed &amp; \" seconds\", vbInformation\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1506546917, "creation_date": 1506546917, "answer_id": 46457332, "question_id": 46456319, "link": "https://stackoverflow.com/questions/46456319/copying-worksheets-from-multiple-workbooks-into-one-workbook-pasting-to-the-righ/46457332#46457332", "title": "Copying worksheets from multiple workbooks into one workbook pasting to the right", "body": "<p>Assuming the FSO bit is right, try this</p>\n\n<pre><code>Sub simpleXlsMerger()\n\nDim bookList As Workbook\nDim mergeObj As Object, dirObj As Object, filesObj As Object, everyObj As Object\nDim c As Long\n\nApplication.ScreenUpdating = False\n\nSet mergeObj = CreateObject(\"Scripting.FileSystemObject\")\nSet dirObj = mergeObj.Getfolder(\"C:\\Users\\a0086850\\Documents\\421\\2017\")\nSet filesObj = dirObj.Files\n\nFor Each everyObj In filesObj\n    Set bookList = Workbooks.Open(everyObj)\n    c = c + 1\n    bookList.Sheets(1).Range(\"F37:F53\").Copy ThisWorkbook.Worksheets(\"2017\").Cells(1, c)\n    bookList.Close\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 211, "user_id": 8651782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d71f253fb066108065e8b7ff5a747f?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Fenner", "link": "https://stackoverflow.com/users/8651782/joshua-fenner"}, "is_accepted": false, "score": 0, "last_activity_date": 1506593164, "creation_date": 1506593164, "answer_id": 46466439, "question_id": 46456319, "link": "https://stackoverflow.com/questions/46456319/copying-worksheets-from-multiple-workbooks-into-one-workbook-pasting-to-the-righ/46466439#46466439", "title": "Copying worksheets from multiple workbooks into one workbook pasting to the right", "body": "<p>If this is just something you need quick I suggest RDBMerge.  A fantastic tool for merging workbooks/worksheets.  <a href=\"https://www.rondebruin.nl/win/addins/rdbmerge.htm\" rel=\"nofollow noreferrer\">RDBMerge</a></p>\n"}], "owner": {"reputation": 19, "user_id": 8685519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d9d929567dc9abb9e2a4d858b4d3e23?s=128&d=identicon&r=PG&f=1", "display_name": "Dan C", "link": "https://stackoverflow.com/users/8685519/dan-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 146, "favorite_count": 1, "answer_count": 2, "score": -1, "last_activity_date": 1506593164, "creation_date": 1506542573, "last_edit_date": 1506543047, "question_id": 46456319, "link": "https://stackoverflow.com/questions/46456319/copying-worksheets-from-multiple-workbooks-into-one-workbook-pasting-to-the-righ", "title": "Copying worksheets from multiple workbooks into one workbook pasting to the right", "body": "<p>I would really appreciate some help right now.</p>\n\n<p>I am trying to take a range of cells <code>F37:F53</code> from <code>Sheet1</code> of multiple workbooks and paste it into <code>Sheet1</code> of a new workbook. The one issue I am having is that all the data pastes down in one column. What I actually want is each set of data to paste to the column to the right. So in other words <code>F37:F53</code> of workbook 1 should be pasted into <code>A1</code> of the final workbook. Then <code>F37:F53</code> of workbook 2 should be pasted into <code>B1</code> of the final workbook. So on and so forth with a limit of 365 columns</p>\n\n<p>I would really appreciate some help as I am fairly new to VBA</p>\n\n<p>Thank you in advance!</p>\n\n<p><strong>Here is what I have so far:</strong></p>\n\n<pre><code>Sub simpleXlsMerger()\nDim bookList As Workbook\nDim mergeObj As Object, dirObj As Object, filesObj As Object, everyObj As Object\nApplication.ScreenUpdating = False\nSet mergeObj = CreateObject(\"Scripting.FileSystemObject\")\n\nSet dirObj = mergeObj.Getfolder(\"C:\\Users\\a0086850\\Documents\\421\\2017\")\nSet filesObj = dirObj.Files\nFor Each everyObj In filesObj\nSet bookList = Workbooks.Open(everyObj)\n\nRange(\"F37:F53\" &amp; Range(\"F65536\").End(xlUp).Row).Copy\nThisWorkbook.Worksheets(\"2017\").Activate\n\nRange(\"A65536\").End(xlUp).Offset(1, 0).PasteSpecial\nApplication.CutCopyMode = False\nbookList.Close\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1506542214, "post_id": 46456191, "comment_id": 79868034, "body": "<code>&quot;Buy Notional Amount&quot;</code> needs to be <code>&quot;&quot;Buy Notional Amount&quot;&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1506542972, "post_id": 46456277, "comment_id": 79868424, "body": "instead of Activecell, seletion, and select I can just use rng right?"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1506543197, "post_id": 46456277, "comment_id": 79868549, "body": "@excelguy Yes that should work for you.You wouldn&#39;t need the <code>Range(&quot;R2&quot;).Select</code> line at all."}, {"owner": {"reputation": 187, "user_id": 7240351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08f022d85c0352244628cabc55dcb16a?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej Lipinski", "link": "https://stackoverflow.com/users/7240351/maciej-lipinski"}, "reply_to_user": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1517409221, "post_id": 46456277, "comment_id": 84084500, "body": "@excelguy take a look at this question about avoiding using Select and ActiveCell <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a>"}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 1, "last_activity_date": 1517408809, "last_edit_date": 1517408809, "creation_date": 1506542386, "answer_id": 46456277, "question_id": 46456191, "link": "https://stackoverflow.com/questions/46456191/vba-if-and-vlookup-statement/46456277#46456277", "title": "VBA, IF and Vlookup statement", "body": "<p>In VBA, when you use quotation marks you are setting a boundary to a string. You should use double quotes. </p>\n\n<pre><code>Range(\"R2\").Select\n    ActiveCell = \"=IF(valumeasure3!E2=\"\"Buy Notional Amount\"\",VLOOKUP(C2,valumeasure3!C:U, COLUMNS(C:U),FALSE),0)\"    ''buy currency amt\n    Selection.AutoFill Destination:=Range(\"R2:R4182\")\n</code></pre>\n\n<p>However, a suggestion is that I would recommend that you not use <code>.Select</code> and <code>ActiveCell</code> whenever possible.</p>\n\n<pre><code>Dim Rng as Range\nSet Rng = Range(\"R2\")\nRng.Value = ....\n</code></pre>\n"}], "owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 46456277, "answer_count": 1, "score": 1, "last_activity_date": 1517408809, "creation_date": 1506542042, "question_id": 46456191, "link": "https://stackoverflow.com/questions/46456191/vba-if-and-vlookup-statement", "title": "VBA, IF and Vlookup statement", "body": "<p>I have the following formula,</p>\n\n<pre><code>=IF(valumeasure3!E2=\"Buy Notional Amount\",VLOOKUP(C2,valumeasure3!C:U, COLUMNS(C:U),FALSE),0)\n</code></pre>\n\n<p>trying to automate this formula in vba, I get a syntax error. Vlookup formulas work fine, but as soon as I do the IF statement i get syntax error. I believe it is to do with the <code>=</code></p>\n\n<pre><code>Range(\"R2\").Select\n        ActiveCell = \"=IF(valumeasure3!E2=\"Buy Notional Amount\",VLOOKUP(C2,valumeasure3!C:U, COLUMNS(C:U),FALSE),0)\"   ''buy currency amt\n        Selection.AutoFill Destination:=Range(\"R2:R4182\")\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1506544455, "post_id": 46456137, "comment_id": 79869164, "body": "What are the values of <code>nUnique</code> and <code>i</code> when it errors? And why not use the Dictionary method?"}, {"owner": {"reputation": 961, "user_id": 8054843, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5509c35e6566c57c5ec9fe5e7d559181?s=128&d=identicon&r=PG&f=1", "display_name": "ipenguin67", "link": "https://stackoverflow.com/users/8054843/ipenguin67"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1506545425, "post_id": 46456137, "comment_id": 79869678, "body": "Both are 1 when it errors. I have seen references to Dictionary elsewhere, but I am mostly unfamiliar, and from what I have read, I don&#39;t see how it gives me any advantage over Arrays. Once I&#39;ve set my array of unique values, my next step will be to set a range.value = varUnique, which seems easier with arrays than dictionaries/collections."}], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1506545804, "creation_date": 1506545804, "answer_id": 46457097, "question_id": 46456137, "link": "https://stackoverflow.com/questions/46456137/vba-capturing-unique-values-into-an-array-is-throwing-subscript-out-of-range/46457097#46457097", "title": "VBA: Capturing unique values into an array is throwing subscript out of range", "body": "<p>I've only changed a couple of things, but when you write a range to an array it is automatically 2D so <code>varIn</code> needs a second dimension. Also tweaked your final output line to automatically adjust to the size of <code>varUnique</code>. The advantage of a Dictionary is that it can automatically produce unique values, i.e. it can overwrite duplicates to not repeated.</p>\n\n<pre><code>Sub FindUnique()\n\nDim rngIn As Range\nDim varIn As Variant\nDim varUnique As Variant\nDim iInCol As Long\nDim iInRow As Long\nDim iUnique As Long\nDim nUnique As Long\nDim isUnique As Boolean\nDim i As Integer\nDim ResultingStatus As Range\nDim WhenAction As Range\nDim EvalForm As Range\n\nSet ResultingStatus = Range(\"A15:Z15\").Find(\"Resulting Status\")\nSet WhenAction = Range(\"A15:Z15\").Find(\"When can this action\")\nSet EvalForm = Range(\"A15:Z15\").Find(\"Evaluation Form\")\nSet rngIn = Range(ResultingStatus.Offset(1, 0).Address, ResultingStatus.Offset(1000, 0).End(xlUp).Address)\nvarIn = rngIn.Value\n\nReDim varUnique(1 To UBound(varIn))\n\nnUnique = 0\nFor i = LBound(varIn) To UBound(varIn)\n    isUnique = True\n    For iUnique = 1 To nUnique\n        If varIn(i, 1) = varUnique(iUnique) Then\n            isUnique = False\n            Exit For\n        End If\n    Next iUnique\n    If isUnique = True Then\n        nUnique = nUnique + 1\n        varUnique(nUnique) = varIn(i, 1)\n    End If\nNext i\n\n'// varUnique now contains only the unique values.\n'// Trim off the empty elements:\nReDim Preserve varUnique(1 To nUnique)\n\nRange(\"B28\").Resize(nUnique) = Application.Transpose(varUnique)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 961, "user_id": 8054843, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5509c35e6566c57c5ec9fe5e7d559181?s=128&d=identicon&r=PG&f=1", "display_name": "ipenguin67", "link": "https://stackoverflow.com/users/8054843/ipenguin67"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 46457097, "answer_count": 1, "score": 0, "last_activity_date": 1506545804, "creation_date": 1506541823, "question_id": 46456137, "link": "https://stackoverflow.com/questions/46456137/vba-capturing-unique-values-into-an-array-is-throwing-subscript-out-of-range", "title": "VBA: Capturing unique values into an array is throwing subscript out of range", "body": "<p>I <a href=\"https://stackoverflow.com/questions/46414881/removing-duplicates-through-vba-still-throws-pop-up-despite-displayalerts-false/46436285#46436285\">previously posted</a> about using one dynamic list from a column on my sheet (column C in this case) as the source for data validation in column D, while requiring unique values. I was trying RemoveDuplicates before, but that method did not seem to work, so I chose to go with an array. I found Jean-Francois Corbett's post in <a href=\"https://stackoverflow.com/questions/5890257/populate-unique-values-into-a-vba-array-from-excel\">this thread</a> helpful, but as I am new to arrays I think I am doing something wrong.</p>\n\n<p>His example was a 2-dimensional array, but my list is 1-dimensional. So I edited his methodology a bit while leaving the structure largely intact. The code below seems to work fine up until \"varUnique(nUnique) = varIn(i)\" near the end of the sub, at which point it throws error 9: Subscript out of range. </p>\n\n<pre><code>Sub FindUnique()\n    Dim rngIn As Range\n    Dim varIn As Variant\n    Dim varUnique As Variant\n    Dim iInCol As Long\n    Dim iInRow As Long\n    Dim iUnique As Long\n    Dim nUnique As Long\n    Dim isUnique As Boolean\n    Dim i As Integer\n\nDim ResultingStatus As Range\nDim WhenAction As Range\nDim EvalForm As Range\nSet ResultingStatus = Range(\"A15:Z15\").Find(\"Resulting Status\")\nSet WhenAction = Range(\"A15:Z15\").Find(\"When can this action\")\nSet EvalForm = Range(\"A15:Z15\").Find(\"Evaluation Form\")\n\n    Set rngIn = Range(ResultingStatus.Offset(1, 0).Address, ResultingStatus.Offset(1000, 0).End(xlUp).Address)\n    varIn = rngIn.Value\n\n    ReDim varUnique(1 To UBound(varIn))\n\n    nUnique = 0\n    For i = LBound(varIn) To UBound(varIn)\n\n\n            isUnique = True\n            For iUnique = 1 To nUnique\n                If varIn(i) = varUnique(iUnique) Then\n                    isUnique = False\n                    Exit For\n                End If\n            Next iUnique\n\n            If isUnique = True Then\n                nUnique = nUnique + 1\n                varUnique(nUnique) = varIn(i)\n            End If\n\n\n    Next i\n\n    '// varUnique now contains only the unique values.\n    '// Trim off the empty elements:\n    ReDim Preserve varUnique(1 To nUnique)\n\n\n    Range(\"B28:D50\").Value = varUnique\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops", "case"], "answers": [{"comments": [{"owner": {"reputation": 481, "user_id": 4678346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6845c5e542113332da5214c2bd77b7df?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4678346/james"}, "edited": false, "score": 0, "creation_date": 1506545821, "post_id": 46456966, "comment_id": 79869849, "body": "thanks that it works to lock the cells. I would have assume if i double click would request for a password since it is locked."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 481, "user_id": 4678346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6845c5e542113332da5214c2bd77b7df?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4678346/james"}, "edited": false, "score": 0, "creation_date": 1506546141, "post_id": 46456966, "comment_id": 79869987, "body": "So somebody double clicks on a cell, you want the date etc added, but then you want them to be able to go back and edit the cell?"}, {"owner": {"reputation": 481, "user_id": 4678346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6845c5e542113332da5214c2bd77b7df?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4678346/james"}, "edited": false, "score": 0, "creation_date": 1506546560, "post_id": 46456966, "comment_id": 79870139, "body": "A user will double click on the cell  and it will be locked. But a different user whose is responsible for amending the file should be able to double click on that protected cell and enter a password to unlock the cell."}, {"owner": {"reputation": 1602, "user_id": 5682919, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4rC18.png?s=128&g=1", "display_name": "jsanchezs", "link": "https://stackoverflow.com/users/5682919/jsanchezs"}, "reply_to_user": {"reputation": 481, "user_id": 4678346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6845c5e542113332da5214c2bd77b7df?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4678346/james"}, "edited": false, "score": 0, "creation_date": 1506547126, "post_id": 46456966, "comment_id": 79870351, "body": "@James is it neccesary that this responsible user enters the password?, why don&#180;t just use SJR code after a user validation so it enables the cell automatically to make modifications ?"}, {"owner": {"reputation": 481, "user_id": 4678346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6845c5e542113332da5214c2bd77b7df?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4678346/james"}, "reply_to_user": {"reputation": 1602, "user_id": 5682919, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4rC18.png?s=128&g=1", "display_name": "jsanchezs", "link": "https://stackoverflow.com/users/5682919/jsanchezs"}, "edited": false, "score": 0, "creation_date": 1506548349, "post_id": 46456966, "comment_id": 79870821, "body": "@jsanchezs that&#39;s an idea. Can u explain that.  So once it&#39;s time stamped  &amp; locked. How would I unlock the cell."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1506545257, "creation_date": 1506545257, "answer_id": 46456966, "question_id": 46456041, "link": "https://stackoverflow.com/questions/46456041/locking-unlocking-cells-excel-vba/46456966#46456966", "title": "Locking/Unlocking cells excel VBA", "body": "<p>Does this do the job? Not sure what you want to happen if someone wants to change a filled cell. You could have a separate SelectionChange or Change event to handle that.</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n\nWith Target\n    If .Column = 4 Then\n        Select Case .Row\n            Case 20, 24, 25, 27, 28, 30 - 35, 37, 38, 40, 42 - 44, 54 - 56, 58, 59, 61 - 65\n                ActiveSheet.Protect Password:=\"Test\", userinterfaceonly:=True\n                .Value2 = \"Prepared By\" &amp; \"  \" &amp; Environ(\"Username\")\n                .Value2 = .Value2 &amp; \"  \" &amp; Format(Now, \"yyyy-MM-dd hh:mm:ss\")\n                .Locked = True\n        End Select\n    End If\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 481, "user_id": 4678346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6845c5e542113332da5214c2bd77b7df?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4678346/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 46456966, "answer_count": 1, "score": 0, "last_activity_date": 1506545257, "creation_date": 1506541443, "last_edit_date": 1531164843, "question_id": 46456041, "link": "https://stackoverflow.com/questions/46456041/locking-unlocking-cells-excel-vba", "title": "Locking/Unlocking cells excel VBA", "body": "<p>I have a code i am trying to apply. The <strong>Objective</strong> of the macro is that when the relevant cell is double clicked a time stamp is applied then cell is locked from editing. If cells need to be edited then a password needs to be applied.</p>\n\n<p>The <strong>problem</strong> is that i am not able to get the locking of the cells and password to work.</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n\n    Application.EnableEvents = False\n\n    With Target\n        If .Column = 4 Then\n            Select Case .Row\n                Case 20, 24, 25, 27, 28, 30, 31, 32, 33, 34, 35, 37, 38, 40, 42, 43, 44, 54, 55, 56, 58, 59, 61, 62, 63, 64, 65\n                    .Value2 = \"Prepared By\" &amp; \"  \" &amp; Environ(\"Username\")\n                    .Value2 = .Value2 &amp; \"  \" &amp; Format(Now, \"yyyy-MM-dd hh:mm:ss\")\n                    .Value2 = .Locked = True\n                     .Value2 = ActiveSheet.Protect Password:=\"Test\"\n                    End Select\n                  End If\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1506543749, "post_id": 46456432, "comment_id": 79868833, "body": "I need it to work on multi select and deselect, i want to check and uncheck items on listbox and put a &quot;1&quot; in the worksheet staying which items was clicked ect."}, {"owner": {"reputation": 770, "user_id": 7086396, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLANabdeAgw/AAAAAAAAAAI/AAAAAAAAAQ4/eCyC7wOMQlU/photo.jpg?sz=128", "display_name": "Moacir", "link": "https://stackoverflow.com/users/7086396/moacir"}, "reply_to_user": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1506544116, "post_id": 46456432, "comment_id": 79869018, "body": "Replace my msgbox with whatever code you need it to execute when you deselect."}, {"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1506544172, "post_id": 46456432, "comment_id": 79869039, "body": "yes, but it only works on single select/deselect, as soon as i select another item on the list, its stuck on the first item index and not the one that was select or deselect."}, {"owner": {"reputation": 770, "user_id": 7086396, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLANabdeAgw/AAAAAAAAAAI/AAAAAAAAAQ4/eCyC7wOMQlU/photo.jpg?sz=128", "display_name": "Moacir", "link": "https://stackoverflow.com/users/7086396/moacir"}, "reply_to_user": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1506544325, "post_id": 46456432, "comment_id": 79869104, "body": "Oh, so you need a memory. Like &quot;How it was&quot; and &quot;How is it now&quot;"}, {"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1506544403, "post_id": 46456432, "comment_id": 79869141, "body": "yeah i need to check it and then put a 1 on A1 lets say for item 1, then when i come back and uncheck item 1 from listbox, the 1 in A1 will be gone, i need to be able to multi do this with multiply items."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1506548225, "post_id": 46456432, "comment_id": 79870774, "body": "what about the other items in the listbox? you should have explained all this  when you posted your question."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "reply_to_user": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 1, "creation_date": 1506548327, "post_id": 46456432, "comment_id": 79870811, "body": "you should accept @pokemon_Man &#39;s  answer because it solves the question that you posted. the additional stuff that you want is not part of the original question."}], "tags": [], "owner": {"reputation": 770, "user_id": 7086396, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLANabdeAgw/AAAAAAAAAAI/AAAAAAAAAQ4/eCyC7wOMQlU/photo.jpg?sz=128", "display_name": "Moacir", "link": "https://stackoverflow.com/users/7086396/moacir"}, "is_accepted": true, "score": 0, "last_activity_date": 1506543047, "creation_date": 1506543047, "answer_id": 46456432, "question_id": 46455984, "link": "https://stackoverflow.com/questions/46455984/return-the-index-of-the-deselected-item-of-a-list-box/46456432#46456432", "title": "Return the index of the deselected item of a list box?", "body": "<p>Something like this would work:</p>\n\n<pre><code>Private Sub ListBox1_Change()\nDim lItem, indexNum As Long\nFor lItem = 0 To Me.ListBox1.ListCount - 1\n    If Me.ListBox1.Selected(lItem) Then\n        indexNum = lItem + 1\n    Else\n        indexNum = lItem + 1\n        deselected = indexNum\n        MsgBox deselected\n    End If\nNext lItem\nEnd Sub\n</code></pre>\n\n<p>If it is selected, it sums. Otherwise, it adds a new one but do the thing you want (In my case msgbox)</p>\n\n<p>Remember to stop the code with a exit for if you only need the first deselected item. On my example I had a list with 5 items. If I selected all of them, nothing happened. If I then selected the first one, it would give me 2, 3, 4, and 5 on msgboxes</p>\n"}], "owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 336, "favorite_count": 0, "accepted_answer_id": 46456432, "answer_count": 1, "score": 0, "last_activity_date": 1506543047, "creation_date": 1506541233, "last_edit_date": 1531164843, "question_id": 46455984, "link": "https://stackoverflow.com/questions/46455984/return-the-index-of-the-deselected-item-of-a-list-box", "title": "Return the index of the deselected item of a list box?", "body": "<p>I'm aware of finding the index of the item selected but how would i go about finding the item that was deselected? I have a list box that has mutli select and checkbox option. When I deselect a item, I want to know the index of it.</p>\n\n<p>Here's my code to get index of selected.</p>\n\n<pre><code>Private Sub ListBox1_Change()\nDim lItem, indexNum As Long\nFor lItem = 0 To Me.ListBox1.ListCount - 1\n    If Me.ListBox1.Selected(lItem) Then\n        indexNum = lItem + 1\n    End If\nNext lItem\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "if-statement", "user-defined-functions", "vba"], "comments": [{"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 0, "creation_date": 1506541400, "post_id": 46455923, "comment_id": 79867607, "body": "Multiple IF statements work fine in Excel VBA, I use them all the time.  I would check the actual text in <code>GetBTM = &quot;Customer Wires&quot;</code>, there may be an unprintable character in there."}], "answers": [{"comments": [{"owner": {"reputation": 3000, "user_id": 292973, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/de98e76d77be51182efd9eb4bddffb2a?s=128&d=identicon&r=PG", "display_name": "Mutuelinvestor", "link": "https://stackoverflow.com/users/292973/mutuelinvestor"}, "edited": false, "score": 0, "creation_date": 1506541488, "post_id": 46456007, "comment_id": 79867652, "body": "Thanks for the reply, so I need to utilize a Nested If Statement because the function takes the last value produced in its body.  I should have known better. Thanks again."}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 1, "last_activity_date": 1506541323, "creation_date": 1506541323, "answer_id": 46456007, "question_id": 46455923, "link": "https://stackoverflow.com/questions/46455923/is-it-possible-to-have-more-than-one-if-statement-in-an-excel-vba-user-defined-f/46456007#46456007", "title": "Is it possible to have more than one if statement in an excel VBA User Defined Function", "body": "<p>Does this help you?</p>\n\n<pre><code>Public Function GetBTM(bai As Integer, comment As String, amt As Double)\n\n    If (bai = 195) Then\n      GetBTM = \"Customer Wires\"\n    ElseIf (bai = 399 And Application.WorksheetFunction.Find(\"MOV TIT\", comment) &gt; 0) Then\n      GetBTM = \"Customer Wires\"\n    End If\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 3000, "user_id": 292973, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/de98e76d77be51182efd9eb4bddffb2a?s=128&d=identicon&r=PG", "display_name": "Mutuelinvestor", "link": "https://stackoverflow.com/users/292973/mutuelinvestor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1506541636, "creation_date": 1506541001, "last_edit_date": 1531164843, "question_id": 46455923, "link": "https://stackoverflow.com/questions/46455923/is-it-possible-to-have-more-than-one-if-statement-in-an-excel-vba-user-defined-f", "title": "Is it possible to have more than one if statement in an excel VBA User Defined Function", "body": "<p>I've created the following function in Excel VBA:</p>\n\n<pre><code>Function GetBTM(bai As Integer, comment As String, amt As Double)\nIf (bai = 195) Then\n  GetBTM = \"Customer Wires\"\nEnd If\n\nIf (bai = 399 And Application.WorksheetFunction.Find(\"MOV TIT\", comment) &gt; 0) Then\n  GetBTM = \"Customer Wires\"\nEnd If\n\nEnd Function\n</code></pre>\n\n<p>When I use the function in a spreadsheet, Only the second if statment works, the first statement results in #value. I believe my sytax is correct, so I'm not sure where I am going wrong. </p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 3, "creation_date": 1506541679, "post_id": 46455863, "comment_id": 79867748, "body": "Is this VBA? I am not familiar with aButton Released event. There is a MouseUp event, but no Released event."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1506593099, "post_id": 46455863, "comment_id": 79887662, "body": "I agree with Tim. Are the subs called by an event or by code?"}, {"owner": {"reputation": 198, "user_id": 1678946, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/roMlK.jpg?s=128&g=1", "display_name": "David Mancini", "link": "https://stackoverflow.com/users/1678946/david-mancini"}, "edited": false, "score": 0, "creation_date": 1506642064, "post_id": 46455863, "comment_id": 79914536, "body": "What happens if you just use <code>Dim o As Object</code>?"}, {"owner": {"reputation": 88, "user_id": 7906748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88042850fd7fc7a1233748dd5d8107cd?s=128&d=identicon&r=PG&f=1", "display_name": "eric", "link": "https://stackoverflow.com/users/7906748/eric"}, "edited": false, "score": 0, "creation_date": 1506724786, "post_id": 46455863, "comment_id": 79950347, "body": "This worked.  Thank you.  For the others, the hosting application is FactoryTalk View SE, it&#39;s just standard event handlers."}], "owner": {"reputation": 88, "user_id": 7906748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88042850fd7fc7a1233748dd5d8107cd?s=128&d=identicon&r=PG&f=1", "display_name": "eric", "link": "https://stackoverflow.com/users/7906748/eric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 154, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1506724941, "creation_date": 1506540741, "last_edit_date": 1506724941, "question_id": 46455863, "link": "https://stackoverflow.com/questions/46455863/vba-cant-take-reference-of-an-object", "title": "VBA can&#39;t take reference of an object", "body": "<p>I've got an array I need to populate with references to labels on a display.  I've managed to reduce my issue to a MWE below:</p>\n\n<pre><code>Private Sub Button1_Released()\n    Me.TestLabel.Caption = \"Button1\"\nEnd Sub\n\nPrivate Sub Button2_Released()\n    Dim o As MSForms.Label\n    Set o = Me.TestLabel\n    o.Caption = \"Button2\"\nEnd Sub\n</code></pre>\n\n<p>The code for button1 works while buttton2 fails with message, \"Method Caption of object ILabelControl failed (0x80010105)\".</p>\n\n<p>TypeName(Me.TestLabel) returns \"Label\".  When I change my Dim to \"Label\" instead of \"MSForms.Label\" I get behavior that looks like an uninitialized variable being accessed.  For example: sometimes button2 will produce chinese characters in the label, often nothing happens but the VBA module will crash.</p>\n\n<p>I have tried removing and restoring the typelib reference with no effect.  I have tried changing the reference from the office v16 fm20.dll to the syswow64 v14 fm20.dll with no effect.</p>\n\n<p>This is a previously functioning application developed on one machine and moved to another.  I have considered recreating the displays, but the MWE comes from a new display, created on the new machine, with just a label and two buttons.</p>\n\n<p>Pretty stuck here.</p>\n\n<p>ed:  changing the dim from MSForms.Label to Object worked</p>\n"}, {"tags": ["vba", "hyperlink", "excel-2010"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1506593208, "post_id": 46455460, "comment_id": 79887726, "body": "Can you show us the code that does not work?"}, {"owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "edited": false, "score": 0, "creation_date": 1506614783, "post_id": 46455460, "comment_id": 79902356, "body": "@peakpeak.........the only code I had was to add a hyperlink but was struggling to add the report name.  The answer from braX below worked for me....."}], "answers": [{"comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1506539544, "post_id": 46455525, "comment_id": 79866595, "body": "decent answer, but you did not address the crux of the problem: <i>trouble getting the report name and URL together to create the hyperlink</i>"}, {"owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "edited": false, "score": 1, "creation_date": 1506614875, "post_id": 46455525, "comment_id": 79902396, "body": "@braX..........thanks for the answer.......I was able to figure it out with the solution you provided.  Thanks for your help......."}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": true, "score": 0, "last_activity_date": 1506539627, "last_edit_date": 1506539627, "creation_date": 1506539377, "answer_id": 46455525, "question_id": 46455460, "link": "https://stackoverflow.com/questions/46455460/excel-vba-create-a-hyperlink/46455525#46455525", "title": "Excel vba create a hyperlink", "body": "<p>Here is how to create a hyperlink on the active cell: (Use the <em>TextToDisplay</em> argument for the report name)</p>\n\n<pre><code>Range(\"A1\").Select\nSelection.ClearContents\nActiveSheet.Hyperlinks.Add Anchor:=Selection, Address:= _\n    \"https://peoplesoft/psreports/prd/\", TextToDisplay:= _\n    \"Report Name\"\n</code></pre>\n"}], "owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9915, "favorite_count": 0, "accepted_answer_id": 46455525, "answer_count": 1, "score": 0, "last_activity_date": 1506539627, "creation_date": 1506539159, "question_id": 46455460, "link": "https://stackoverflow.com/questions/46455460/excel-vba-create-a-hyperlink", "title": "Excel vba create a hyperlink", "body": "<p>I'm trying to create a hyperlink with vba.  I have a macro that extracts a report name (string) and report ID (string) from a website.  These 2 pieces of info are written to the 'Results' sheet in Excel.  So far, so good.  </p>\n\n<p>The next step is to create a hyperlink in the 3rd column that appears to be the Report Name.  However, the URL for the hyperlink is <a href=\"https://PeopleSoft/psreports/prd/\" rel=\"nofollow noreferrer\">https://PeopleSoft/psreports/prd/</a> and the Report ID.  It would look like this:\n<a href=\"https://PeopleSoft/psreports/prd/123456\" rel=\"nofollow noreferrer\">https://PeopleSoft/psreports/prd/123456</a>.  </p>\n\n<p>I can put the URL together.  However, what I'm trying to do is create a hyperlink in the 3rd column and looks like the report name in the first column.</p>\n\n<p>I'm having trouble getting the report name and URL together to create the hyperlink.  Is this possible?  Any help would be greatly appreaciated.......</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 2, "creation_date": 1506538826, "post_id": 46455346, "comment_id": 79866204, "body": "Where is the rest of your code? The only thing you are showing us is the SQL statement. You combine the SQL statement with VBA code, as VBA is not a type of query."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1506539728, "post_id": 46455346, "comment_id": 79866696, "body": "You have to turn the SQL statement into VBA <code>string</code> type variable and there is specific syntax for that."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 3, "creation_date": 1506540163, "post_id": 46455346, "comment_id": 79866948, "body": "Also, can&#39;t &#39;run&#39; a SELECT sql. SELECT sql is used to set a RecordSource object or form/report RecordSource property. Only action sql can be run - UPDATE, INSERT, DELETE, SELECT INTO. You can Open a SELECT query object. But why open query object? Why not create report using the query as RecordSource?"}, {"owner": {"reputation": 967, "user_id": 6860396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2335c5b5ac2454a5b20ba41ab74f95f0?s=128&d=identicon&r=PG&f=1", "display_name": "BellHopByDayAmetuerCoderByNigh", "link": "https://stackoverflow.com/users/6860396/bellhopbydayametuercoderbynigh"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1506542631, "post_id": 46455346, "comment_id": 79868249, "body": "@ScottHoltzman - see my edit.  I failed to realize I omitted my VBA syntax"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1506548544, "post_id": 46455346, "comment_id": 79870901, "body": "@BellHopByDayAmetuerCoderByNigh - See comment by June7. Also, I am wary of <code>ConcatRelated</code>. I bet Access doesn&#39;t like that syntax."}, {"owner": {"reputation": 967, "user_id": 6860396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2335c5b5ac2454a5b20ba41ab74f95f0?s=128&d=identicon&r=PG&f=1", "display_name": "BellHopByDayAmetuerCoderByNigh", "link": "https://stackoverflow.com/users/6860396/bellhopbydayametuercoderbynigh"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1506554217, "post_id": 46455346, "comment_id": 79872610, "body": "@June7 &amp; ScottHoltzman - It is a Select Into statement."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1506560308, "post_id": 46455346, "comment_id": 79873943, "body": "Sorry, completely missed the Into keyword."}], "answers": [{"comments": [{"owner": {"reputation": 967, "user_id": 6860396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2335c5b5ac2454a5b20ba41ab74f95f0?s=128&d=identicon&r=PG&f=1", "display_name": "BellHopByDayAmetuerCoderByNigh", "link": "https://stackoverflow.com/users/6860396/bellhopbydayametuercoderbynigh"}, "edited": false, "score": 0, "creation_date": 1506597924, "post_id": 46461353, "comment_id": 79890647, "body": "[userID] is a short text type field."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 967, "user_id": 6860396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2335c5b5ac2454a5b20ba41ab74f95f0?s=128&d=identicon&r=PG&f=1", "display_name": "BellHopByDayAmetuerCoderByNigh", "link": "https://stackoverflow.com/users/6860396/bellhopbydayametuercoderbynigh"}, "edited": false, "score": 0, "creation_date": 1506630579, "post_id": 46461353, "comment_id": 79910743, "body": "Ooops! Did you find my extra ) typo? Edited answer again."}], "tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": true, "score": 1, "last_activity_date": 1506630320, "last_edit_date": 1506630320, "creation_date": 1506575243, "answer_id": 46461353, "question_id": 46455346, "link": "https://stackoverflow.com/questions/46455346/convert-access-sql-to-vba/46461353#46461353", "title": "Convert Access SQL To VBA", "body": "<p>I did some testing. Assuming userID is number type field, see if this works for you:</p>\n\n<pre><code>DoCmd.RunSQL (\"SELECT DISTINCT informationTable.userID, \" &amp; _\n    \"ConcatRelated('itemsold','[informationTable]','userID=' &amp; [userID]) AS NameOfItemSold \" &amp; _\n    \"INTO CRInformationTable FROM informationTable;\")\n</code></pre>\n\n<p>If userID is text type:  </p>\n\n<pre><code>\"ConcatRelated('itemsold','[informationTable]','userID=\" &amp; Chr(34) &amp; \"' &amp; [userID] &amp; '\" &amp; Chr(34) &amp; \"') AS NameOfItemSold \" &amp; _\n</code></pre>\n\n<p>Instead of Chr(34):</p>\n\n<pre><code>\"ConcatRelated('itemsold','[informationTable]','userID=\"\"' &amp; [userID] &amp; '\"\"') AS NameOfItemSold \" &amp; _\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 1, "last_activity_date": 1557519456, "last_edit_date": 1557519456, "creation_date": 1512061404, "answer_id": 47578827, "question_id": 46455346, "link": "https://stackoverflow.com/questions/46455346/convert-access-sql-to-vba/47578827#47578827", "title": "Convert Access SQL To VBA", "body": "<p>I've used this nifty tool many times with great success.</p>\n\n<p><strong>Creating the form</strong></p>\n\n<p>The form just needs two text boxes, and a command button. SQL statements can be quite long, so you put the text boxes on different pages of a tab control.</p>\n\n<p>Create a new form (in design view.)<br>\nAdd a tab control.<br>\nIn the first page of the tab control, add a unbound text box.\nSet its Name property to txtSql.<br>\nIncrease its Height and Width so you can see many long lines at once.<br>\nIn the second page of the tab control, add another unbound text box.<br>\nName it txtVBA, and increase its height and width.<br>\nAbove the tab control, add a command button.\nName it cmdSql2Vba.<br>\nSet its On Click property to [Event Procedure].<br>\nClick the Build button (...) beside this property.<br>\nWhen Access opens the code window, set up the code like this:  </p>\n\n<pre><code>    Private Sub cmdSql2Vba_Click()\n        Dim strSql As String\n        'Purpose:   Convert a SQL statement into a string to paste into VBA code.\n        Const strcLineEnd = \" \"\" &amp; vbCrLf &amp; _\" &amp; vbCrLf &amp; \"\"\"\"\n\n        If IsNull(Me.txtSQL) Then\n            Beep\n        Else\n            strSql = Me.txtSQL\n            strSql = Replace(strSql, \"\"\"\", \"\"\"\"\"\")  'Double up any quotes.\n            strSql = Replace(strSql, vbCrLf, strcLineEnd)\n            strSql = \"strSql = \"\"\" &amp; strSql &amp; \"\"\"\"\n            Me.txtVBA = strSql\n            Me.txtVBA.SetFocus\n            RunCommand acCmdCopy\n        End If\n    End Sub\n</code></pre>\n\n<p><strong>Using the form</strong></p>\n\n<p>Open your query in SQL View, and copy the SQL statement to clipboard (Ctrl+C.)<br>\nPaste into the first text box (Ctrl+V.)<br>\nClick the button.<br>\nPaste into a new line in your VBA procedure (Ctrl+V.)  </p>\n\n<p><a href=\"https://i.stack.imgur.com/Z0OTv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Z0OTv.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"http://allenbrowne.com/ser-71.html\" rel=\"nofollow noreferrer\">http://allenbrowne.com/ser-71.html</a></p>\n"}], "owner": {"reputation": 967, "user_id": 6860396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2335c5b5ac2454a5b20ba41ab74f95f0?s=128&d=identicon&r=PG&f=1", "display_name": "BellHopByDayAmetuerCoderByNigh", "link": "https://stackoverflow.com/users/6860396/bellhopbydayametuercoderbynigh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4751, "favorite_count": 0, "accepted_answer_id": 46461353, "answer_count": 2, "score": 0, "last_activity_date": 1557519456, "creation_date": 1506538714, "last_edit_date": 1506554194, "question_id": 46455346, "link": "https://stackoverflow.com/questions/46455346/convert-access-sql-to-vba", "title": "Convert Access SQL To VBA", "body": "<p>I am in need of converting this Access SQL Query to a VBA Query -></p>\n\n<pre><code>SELECT informationTable.userID, \nConcatRelated('itemSold','[informationTable]',\"userID='\" &amp; [userID] &amp; \"'\") AS NameOfItemSold\nFROM informationTable\nGROUP BY informationTable.userID;\n</code></pre>\n\n<p>I tried ths VBA</p>\n\n<pre><code>DoCmd.RunSQL (\"SELECT informationTable.userID,\n ConcatRelated('itemsold','[informationTable]','userID= ' &amp; Chr(34)  &amp; [userID] &amp; Chr(34) &amp; ') AS NameOfItemSold \nInto CRInformationTable\nFROM informationTable \nGROUP BY informationTable.userID;\")\n</code></pre>\n\n<p>but I get an error of </p>\n\n<blockquote>\n  <p>A RunSQL action requires an argument consisiting of an SQL statement</p>\n</blockquote>\n"}, {"tags": ["excel", "matrix", "excel-formula", "pivot-table", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1506538649, "post_id": 46455290, "comment_id": 79866117, "body": "You can always run the macros from an external workbook to create your tables."}, {"owner": {"reputation": 18731, "user_id": 37710, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/80b9bce2ab2ae2602d75894c966b4fa5?s=128&d=identicon&r=PG", "display_name": "n8wrl", "link": "https://stackoverflow.com/users/37710/n8wrl"}, "edited": false, "score": 0, "creation_date": 1506538788, "post_id": 46455290, "comment_id": 79866186, "body": "What are you going to do with the result? If you plan to use what your client enters to drive some system configuration, it might make sense to point them at the configuration tool itself, otherwise you&#39;ll be re-entering changes they make forever."}, {"owner": {"reputation": 123, "user_id": 3281379, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a03011d18c8cddb44bae348b1b422409?s=128&d=identicon&r=PG&f=1", "display_name": "Griven", "link": "https://stackoverflow.com/users/3281379/griven"}, "edited": false, "score": 0, "creation_date": 1506539797, "post_id": 46455290, "comment_id": 79866734, "body": "This result would be a starting point for me, and an ongoing form of documentation for them, to be used in populating the tool and auditing their own processes separately from the tool."}], "answers": [{"tags": [], "owner": {"reputation": 1135, "user_id": 3165466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef259905fd034ee6a4c74269b89d0457?s=128&d=identicon&r=PG&f=1", "display_name": "Gordon", "link": "https://stackoverflow.com/users/3165466/gordon"}, "is_accepted": false, "score": 0, "last_activity_date": 1506695719, "creation_date": 1506695719, "answer_id": 46491145, "question_id": 46455290, "link": "https://stackoverflow.com/questions/46455290/how-can-i-generate-a-matrix-based-on-two-columns-from-two-tables/46491145#46491145", "title": "How can I generate a matrix based on two columns from two tables?", "body": "<p>If the image below is what you're looking for then you can use the method below and then copy and paste as values on the sheet that you send to the client.</p>\n\n<p><a href=\"https://i.stack.imgur.com/MsWcz.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MsWcz.jpg\" alt=\"Pivot View\"></a></p>\n\n<p>You need to manually create unique list of Apps.</p>\n\n<p>Next to each App there will be several array formulas to extract the associated roles.</p>\n\n<p><code>=IFERROR(INDEX($B$3:$C$14,SMALL(IF(($B$3:$B$14=$C17),ROW($B$3:$C$14)-2),ROW($1:$1)),2),\"\")</code></p>\n\n<p>if your data is in a excel Table then the formula is easier to create and read.</p>\n\n<p><code>=IFERROR(INDEX(Table1,SMALL(IF((Table1[App Name]=$C16),ROW(Table1)-2),ROW($1:$1)),2),\"\")</code></p>\n\n<p>This is an array formula so you need to use <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>Enter</kbd> to submit the formula.</p>\n\n<p>The formula can be auto filled across but you will get the same value under each role.  You need to change <code>ROW($1:$1)</code> to <code>ROW($2:$2)</code> under role 2 and <code>ROW($3:$3)</code> under role 3 etc. for as many roles as you think you will need. remembering to use <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>Enter</kbd> after each change.</p>\n\n<p>Then simply fill down and it will populate all the roles for each App in your list.</p>\n\n<p>Save a copy as a template and use copy and paste as values to remove all the scary formulas before you end it to your client.</p>\n"}], "owner": {"reputation": 123, "user_id": 3281379, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a03011d18c8cddb44bae348b1b422409?s=128&d=identicon&r=PG&f=1", "display_name": "Griven", "link": "https://stackoverflow.com/users/3281379/griven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2145, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1506695719, "creation_date": 1506538524, "last_edit_date": 1531161705, "question_id": 46455290, "link": "https://stackoverflow.com/questions/46455290/how-can-i-generate-a-matrix-based-on-two-columns-from-two-tables", "title": "How can I generate a matrix based on two columns from two tables?", "body": "<p>I'm working on creating an authorization matrix to hand out to my clients.  My Excel workbook contains two tables: Applications and Permissions/Roles.</p>\n\n<p>I'd like to take the first column of each table and dynamically generate an X,Y matrix on another worksheet, where my client can mark the combinations of application/role that are required.</p>\n\n<p>So far, I've tried a pivot table, but those cannot be edited.  I'd like to stay away from macros, since this will be given out to external clients.</p>\n\n<p>In the end, I'd like to get a dynamically generated matrix that looks like the following:</p>\n\n<pre><code>Role 1 | Role 2 | Role 3 | Role 4 | ... | Role n |\nApp 1  |        |        |        |     |        |\nApp 2  |        |        |        |     |        |\nApp 3  |        |        |        |     |        |\nApp 4  |        |        |        |     |        |\n...    |        |        |        |     |        |\nApp n  |        |        |        |     |        |\n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["vba", "excel", "internet-explorer"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 2, "creation_date": 1506538623, "post_id": 46455231, "comment_id": 79866101, "body": "You define <code>uid</code> and <code>pwd</code> but then when you are using them, you are calling them <code>UserID</code> and <code>Password</code> - is that intentional or a bug?"}, {"owner": {"reputation": 31, "user_id": 8685105, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CUtE9Nw7UFY/AAAAAAAAAAI/AAAAAAAAATY/c-p8NEfx5gc/photo.jpg?sz=128", "display_name": "Prem Prakash", "link": "https://stackoverflow.com/users/8685105/prem-prakash"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1506607737, "post_id": 46455231, "comment_id": 79897583, "body": "Jean, This is intentional to hide credentials. Thankyou."}], "answers": [{"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 3, "last_activity_date": 1506540710, "last_edit_date": 1506540710, "creation_date": 1506539563, "answer_id": 46455579, "question_id": 46455231, "link": "https://stackoverflow.com/questions/46455231/not-able-to-login-to-my-indeed-account-using-vba/46455579#46455579", "title": "Not able to login to my indeed account using VBA", "body": "<p>When you use <code>getElementsByClassName</code>, you have to determine which class name you are wanting, as there can be many. If your class name is unique (which in this case it appears it could be), you can simply add a (0) to the end. If you want to search through all the class names you could use a <code>For Each...Next</code> statement.</p>\n\n<p>Notice the different between these:\n<code>getElementByID()</code> and <code>getElementsByClassName()</code>? Elements is plural when used with ClassName, so you need to designate which element of that class you want.</p>\n\n<p>Try replacing your line with this:</p>\n\n<pre><code>Set ieElement = objIE.Document.getElementsByClassName(\"sg-btn sg-btn-primary btn-signin\")(0)\n</code></pre>\n\n<p>The method you are currently using would work along these lines:</p>\n\n<pre><code>Dim ieElements, ieElemBtn, ieElement\nSet ieElements = objIE.Document.getElementsByClassName(\"sg-btn sg-btn-primary btn-signin\")\nFor Each ieElement in ieElements\n    If ieElement ..... Then \n        Set ieElemBtn = ieElement\n        Exit For\n    End If\nNext ieElement \nieElemBtn.Click\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8685105, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CUtE9Nw7UFY/AAAAAAAAAAI/AAAAAAAAATY/c-p8NEfx5gc/photo.jpg?sz=128", "display_name": "Prem Prakash", "link": "https://stackoverflow.com/users/8685105/prem-prakash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1506540710, "creation_date": 1506538305, "last_edit_date": 1531164843, "question_id": 46455231, "link": "https://stackoverflow.com/questions/46455231/not-able-to-login-to-my-indeed-account-using-vba", "title": "Not able to login to my indeed account using VBA", "body": "<p>On line:</p>\n\n<pre><code>Set ieElement = objIE.Document.getElementsByClassName(\"sg-btn sg-btn-primary btn-signin\")\n</code></pre>\n\n<p><code>ieElement.Click</code> of the below code throws an error called \"Object does not support this property or method\".</p>\n\n<pre><code>Sub login()\n    Dim objIE As InternetExplorer\n    Dim uid As String\n    Dim pwd As String\n    Dim rng As Range\n    Dim sh As Worksheet\n    Dim ieElement As Object\n\n    Set sh = Sheets(\"Indeed Resume Download\")\n    Set rng = sh.Range(\"A2\")\n\n    On Error Resume Next\n    objIE.Quit\n    Set objIE = Nothing\n    On Error GoTo 0\n\n    uid = rng.Value\n    pwd = rng.Offset(0, 1).Value\n\n    Dim j As Long\n\n    Set objIE = New InternetExplorer 'Initialize internet object\n    objIE.Navigate \"https://secure.indeed.com/account/loginservice=my&amp;hl=en_IN&amp;co=IN&amp;continue=https%3A%2F%2Fwww.indeed.co.in%2F\"\n    objIE.Visible = True\n\n    objIE.Document.all.signin_email.Value = UserID    \n    objIE.Document.all.signin_password.Value = Password\n\n    Set ieElement = objIE.Document.getElementsByClassName(\"sg-btn sg-btn-primary btn-signin\")\n    ieElement.Click\n\n    For j = 2 To sh.Cells(Rows.Count, 27).End(xlUp).Row\n\n    Set objIE = New InternetExplorer\n    With objIE\n    .Navigate sh.Range(\"CA\" &amp; j).Value\n\n    Do While .Busy = True\n        DoEvents\n    Loop\n\n    Do While .Busy: Loop\n    Do While .ReadyState &lt;&gt; READYSTATE_COMPLETE: Loop\n    Do While .Busy: Loop\n\n    End With\n\n    Do While objIE.Busy = True\n        DoEvents\n    Loop\n\n    Next j\n\n    Set objIE = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1506537208, "post_id": 46454840, "comment_id": 79865322, "body": "You can try this on the click even for the checkbox, but it may not work well as the Checkbox will be the thing that has the focus once it&#39;s clicked: <code>ActiveCell = Range(CheckBox1.TopLeftCell.Address)</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1506538120, "post_id": 46454840, "comment_id": 79865823, "body": "Don&#39;t <code>Select</code>. And why <code>FormulaR1C1</code> when you just want to set its value? <code>Activecell.Offset(3,1).Value = &quot;Needed&quot;</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1506538167, "post_id": 46454840, "comment_id": 79865859, "body": "Is the checkbox an <i>ActiveX</i> control or a <i>Forms</i> control?"}, {"owner": {"reputation": 77, "user_id": 6553486, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4ad425977be36715febd425c140261bf?s=128&d=identicon&r=PG", "display_name": "Xander", "link": "https://stackoverflow.com/users/6553486/xander"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1506538457, "post_id": 46454840, "comment_id": 79866016, "body": "@Mat&#39;sMug it&#39;s a Forms control. And changing the verbage of how I&#39;m inserting that value doesn&#39;t really address my problem. I still need to make the checkbox the active cell so the offset will point to the correct cell."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1506538607, "post_id": 46454840, "comment_id": 79866093, "body": "It doesn&#39;t really address <i>that</i> problem, but looking at any of the thousand-or-so questions on this site involving run-time errors stemming from <code>Select</code> and <code>Activate</code>, I <b>STRONGLY</b> recommend you &quot;change the verbiage of how you&#39;re inserting that value&quot;. Just sayin&#39;."}, {"owner": {"reputation": 77, "user_id": 6553486, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4ad425977be36715febd425c140261bf?s=128&d=identicon&r=PG", "display_name": "Xander", "link": "https://stackoverflow.com/users/6553486/xander"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1506538669, "post_id": 46454840, "comment_id": 79866131, "body": "@Mat&#39;sMug I&#39;m not saying it isn&#39;t a good suggestion, I&#39;m just saying it&#39;s not particularly helpful in answering the question I asked."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1506538719, "post_id": 46454840, "comment_id": 79866157, "body": "Hence why I posted it as a comment rather than as an answer. Geez. Also you explicitly ask about how to make it &quot;the active cell&quot; - which points directly to that: bad idea, there&#39;s certainly a better way."}, {"owner": {"reputation": 77, "user_id": 6553486, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4ad425977be36715febd425c140261bf?s=128&d=identicon&r=PG", "display_name": "Xander", "link": "https://stackoverflow.com/users/6553486/xander"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1506538987, "post_id": 46454840, "comment_id": 79866287, "body": "@Mat&#39;sMug I need to check a checkbox, and upon its being checked I need to add text to cells that are located at specific distances beneath it. I can&#39;t explicitly call the cell ranges because then if rows are added above them it&#39;ll render the macro inaccurate. If you&#39;ve got a better way then by all means feel free to share."}, {"owner": {"reputation": 77, "user_id": 6553486, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4ad425977be36715febd425c140261bf?s=128&d=identicon&r=PG", "display_name": "Xander", "link": "https://stackoverflow.com/users/6553486/xander"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1506539070, "post_id": 46454840, "comment_id": 79866330, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/155453/discussion-between-xander-and-mats-mug\">continue this discussion in chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1506543196, "post_id": 46456419, "comment_id": 79868547, "body": "How do you get that to fire? I created a Form checkbox, and clicking it and uncliking it does nothing."}, {"owner": {"reputation": 2212, "user_id": 6935152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f02ebbd76d4b518363a38bbbdf8e2c7f?s=128&d=identicon&r=PG&f=1", "display_name": "kaza", "link": "https://stackoverflow.com/users/6935152/kaza"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1506543270, "post_id": 46456419, "comment_id": 79868591, "body": "Unfortunately you have to do it once for each of the checkboxes you&#39;ve."}, {"owner": {"reputation": 77, "user_id": 6553486, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4ad425977be36715febd425c140261bf?s=128&d=identicon&r=PG", "display_name": "Xander", "link": "https://stackoverflow.com/users/6553486/xander"}, "edited": false, "score": 0, "creation_date": 1506603377, "post_id": 46456419, "comment_id": 79894388, "body": "@bulbus so if I&#39;m understanding this correctly, I have to give an index value to each checkbox in the spreadsheet in order to make this work?"}, {"owner": {"reputation": 2212, "user_id": 6935152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f02ebbd76d4b518363a38bbbdf8e2c7f?s=128&d=identicon&r=PG&f=1", "display_name": "kaza", "link": "https://stackoverflow.com/users/6935152/kaza"}, "edited": false, "score": 0, "creation_date": 1506605791, "post_id": 46456419, "comment_id": 79896173, "body": "When you right click assign macro on the check box, it will automatically show you the Sub name like <code>Checkbox2_Click</code>, <code>Checkbox3_Click</code>,<code>Checkbox4_Click</code>... Use the same digit/index in the line Set <code>chkBox = ActiveSheet.CheckBoxes(1)</code>"}, {"owner": {"reputation": 2212, "user_id": 6935152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f02ebbd76d4b518363a38bbbdf8e2c7f?s=128&d=identicon&r=PG&f=1", "display_name": "kaza", "link": "https://stackoverflow.com/users/6935152/kaza"}, "edited": false, "score": 0, "creation_date": 1506612614, "post_id": 46456419, "comment_id": 79900972, "body": "I&#39;ve update the answer with the workflow you should follow to achieve this. See if it helps!"}, {"owner": {"reputation": 2212, "user_id": 6935152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f02ebbd76d4b518363a38bbbdf8e2c7f?s=128&d=identicon&r=PG&f=1", "display_name": "kaza", "link": "https://stackoverflow.com/users/6935152/kaza"}, "reply_to_user": {"reputation": 77, "user_id": 6553486, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4ad425977be36715febd425c140261bf?s=128&d=identicon&r=PG", "display_name": "Xander", "link": "https://stackoverflow.com/users/6553486/xander"}, "edited": false, "score": 0, "creation_date": 1506618676, "post_id": 46456419, "comment_id": 79904509, "body": "@Xander did the detail help you?"}], "tags": [], "owner": {"reputation": 2212, "user_id": 6935152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f02ebbd76d4b518363a38bbbdf8e2c7f?s=128&d=identicon&r=PG&f=1", "display_name": "kaza", "link": "https://stackoverflow.com/users/6935152/kaza"}, "is_accepted": true, "score": 1, "last_activity_date": 1506612583, "last_edit_date": 1506612583, "creation_date": 1506542951, "answer_id": 46456419, "question_id": 46454840, "link": "https://stackoverflow.com/questions/46454840/make-a-cell-active-when-checkbox-is-checked/46456419#46456419", "title": "Make a cell active when checkbox is checked", "body": "<p>This works for Form Control CheckBox Object<br>\nMake sure that your index of checkbox and the index in <code>ActiveSheet.CheckBoxes(1)</code>\nare the same...</p>\n\n<pre><code>Sub Checkbox1_Click()\n Dim chkBox As CheckBox\n Set chkBox = ActiveSheet.CheckBoxes(1)\n Range(chkBox.LinkedCell).Offset(3, 1).Value=\"Needed\"\nEnd Sub\n</code></pre>\n\n<p>You can also do the fill-with-<code>Needed</code> based on the value in the <code>LinkedCell</code>.</p>\n\n<p>If your check box is an ActiveX Control. You can do the similar action method on it.</p>\n\n<hr>\n\n<p><strong>EDITED</strong> to show more detail<br></p>\n\n<p>The workflow for Checkbox form control would be as below:-<br>\n 1. RightClick the check box-> Format Control<br>\n<img src=\"https://i.stack.imgur.com/b94pV.png\" alt=\"enter image description here\"><br>\n 2. Cell Link, this would typically be the cell behind the check-box, you want anchored(you can set the font color to white so that it doesn't show the values)<br><img src=\"https://i.stack.imgur.com/tcHal.png\" alt=\"enter image description here\"><br>\n 3. RightClick the check box-> Assign Macro<br>\n<img src=\"https://i.stack.imgur.com/l8B5F.png\" alt=\"enter image description here\"><br>\n 4. Click \"New\"<br>\n<img src=\"https://i.stack.imgur.com/8GnSU.png\" alt=\"enter image description here\"><br>\n 5. It show create the below snippet for you<br></p>\n\n<pre><code>Sub CheckBox2_Click()\n\nEnd Sub\n</code></pre>\n\n<p>6. Fill in the Sub with the code I had shown you before..<br></p>\n\n<pre><code>Sub Checkbox2_Click()\n Dim chkBox As CheckBox\n Set chkBox = ActiveSheet.CheckBoxes(2)\n Range(chkBox.LinkedCell).Offset(3, 1).Value=\"Needed\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 6553486, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4ad425977be36715febd425c140261bf?s=128&d=identicon&r=PG", "display_name": "Xander", "link": "https://stackoverflow.com/users/6553486/xander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1540, "favorite_count": 0, "accepted_answer_id": 46456419, "answer_count": 1, "score": 1, "last_activity_date": 1507555507, "creation_date": 1506536915, "last_edit_date": 1507555507, "question_id": 46454840, "link": "https://stackoverflow.com/questions/46454840/make-a-cell-active-when-checkbox-is-checked", "title": "Make a cell active when checkbox is checked", "body": "<p>I have a checkbox sitting in a cell in an Excel spreadsheet. I'm writing a macro that places text in certain cells using the <code>Activecell.Offset</code> function, like so:</p>\n\n<pre><code>Activecell.Offset(3,1).Value = \"Needed\"\n</code></pre>\n\n<p>However, to make this work as desired, I need to have the cell which contains the checkbox be made the Active cell when the box is checked. How do I do this?</p>\n"}, {"tags": ["vba", "excel", "date", "reversing"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1506536730, "post_id": 46454663, "comment_id": 79865060, "body": "Are the international settings on your computer set for dd/mm/yyyy ?"}, {"owner": {"reputation": 3, "user_id": 8289960, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gh1jm.jpg?s=128&g=1", "display_name": "Aur&#233;lio S. C. C. P&#243;voa", "link": "https://stackoverflow.com/users/8289960/aur%c3%a9lio-s-c-c-p%c3%b3voa"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1506537088, "post_id": 46454663, "comment_id": 79865264, "body": "I don&#39;t know. How can I check this? I&#39;m new at VBA so I don&#39;t really understand how it works and how it relates to the OS."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1506537264, "post_id": 46454663, "comment_id": 79865362, "body": "<a href=\"https://support.office.com/en-us/article/Change-your-date-format-c2557873-d161-4ad6-ae67-32b45c4d8484\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}, {"owner": {"reputation": 770, "user_id": 7086396, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLANabdeAgw/AAAAAAAAAAI/AAAAAAAAAQ4/eCyC7wOMQlU/photo.jpg?sz=128", "display_name": "Moacir", "link": "https://stackoverflow.com/users/7086396/moacir"}, "edited": false, "score": 0, "creation_date": 1506537673, "post_id": 46454663, "comment_id": 79865591, "body": "Use <code>Format(InsertedDate, &quot;mm&#47;dd&#47;yyyy&quot;)</code> and it will work if I recall correctly."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1506538439, "post_id": 46454663, "comment_id": 79865999, "body": "As long as Excel understands dates as being dates, you don&#39;t need to worry about what they look like"}, {"owner": {"reputation": 3, "user_id": 8289960, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gh1jm.jpg?s=128&g=1", "display_name": "Aur&#233;lio S. C. C. P&#243;voa", "link": "https://stackoverflow.com/users/8289960/aur%c3%a9lio-s-c-c-p%c3%b3voa"}, "reply_to_user": {"reputation": 770, "user_id": 7086396, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLANabdeAgw/AAAAAAAAAAI/AAAAAAAAAQ4/eCyC7wOMQlU/photo.jpg?sz=128", "display_name": "Moacir", "link": "https://stackoverflow.com/users/7086396/moacir"}, "edited": false, "score": 0, "creation_date": 1506539221, "post_id": 46454663, "comment_id": 79866422, "body": "@Moacir I already tried that, didn&#39;t work. But thanks anyway."}, {"owner": {"reputation": 3, "user_id": 8289960, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gh1jm.jpg?s=128&g=1", "display_name": "Aur&#233;lio S. C. C. P&#243;voa", "link": "https://stackoverflow.com/users/8289960/aur%c3%a9lio-s-c-c-p%c3%b3voa"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1506539338, "post_id": 46454663, "comment_id": 79866479, "body": "@Mat&#39;sMug In fact, I really need Excel to understand the date that user typed because of the IF statement that follows. If the date is wrong, the IF statement will proceed to ELSE and that doesn&#39;t work for me. But thanks for the reply!"}], "answers": [{"comments": [{"owner": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 0, "creation_date": 1506539219, "post_id": 46455259, "comment_id": 79866421, "body": "In cases where user might use use either date formats (m/d/yy or d/m/yy) it appears to me this function will not be able to recognize that. You might want to test for local date settings."}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "reply_to_user": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 0, "creation_date": 1506539982, "post_id": 46455259, "comment_id": 79866835, "body": "@VictorK Fixed =]"}, {"owner": {"reputation": 3, "user_id": 8289960, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gh1jm.jpg?s=128&g=1", "display_name": "Aur&#233;lio S. C. C. P&#243;voa", "link": "https://stackoverflow.com/users/8289960/aur%c3%a9lio-s-c-c-p%c3%b3voa"}, "edited": false, "score": 0, "creation_date": 1506540940, "post_id": 46455259, "comment_id": 79867358, "body": "Thanks, man! I really appreciate your help! I&#39;ll try your code and I&#39;ll get back to you!"}], "tags": [], "owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "is_accepted": false, "score": 0, "last_activity_date": 1507139948, "last_edit_date": 1507139948, "creation_date": 1506538424, "answer_id": 46455259, "question_id": 46454663, "link": "https://stackoverflow.com/questions/46454663/date-automatically-reversing-vba-excel/46455259#46455259", "title": "Date Automatically Reversing VBA Excel", "body": "<p>I just could think of a way to make it on the hardest way, which is extracting each element and comparing.</p>\n\n<pre><code>diamesano = Me.BoxDate.Value\n'diamesano = \"12/18/2017\"\n\n    dia = CLng(Left(diamesano, 2))\n    mes = CLng(Left(Mid(diamesano, 4), 2))\n    ano = CLng(Right(diamesano, 4)) 'Assuming year with 4 digits, otherwise some tweaks are necessary\n    Debug.Print \"day: \" &amp; dia &amp; \" month: \" &amp; mes &amp; \" Year: \" &amp; ano\n\n    date_error = 0\n    If mes &gt;= 1 And mes &lt;= 12 Then 'Check if month is ok\n        mesAno = (Right(diamesano, 7))\n        DiasNoMes = Day(DateSerial(Year(mesAno), Month(mesAno) + 1, 0))\n        If dia &gt;= 1 And dia &lt;= DiasNoMes Then 'Check the amount of days on this month and if is in range\n            Debug.Print \"OK\"\n           'Do something because the Date is valid!\n        Else\n            date_error = 1\n        End If\n    Else\n            date_error = 1\n    End If\n\nIf date_error = 1 Then\n         Debug.Print \"NOK\"\n        'Date is invalid =P\nEnd If\n</code></pre>\n\n<p>Tried to use <code>IsDate()</code> function, but it reversed the date, even if formatting <code>\"dd/mm/yyyy\"</code> is used before.</p>\n\n<h1>Edit:</h1>\n\n<h3>UDF to split the date</h3>\n\n<p>If the user input another format as \"d/m/yy\", the code below will correct. In which the function EXTRACTELEMENT will split the String by <code>/</code> and get the elements.</p>\n\n<pre><code>Function EXTRACTELEMENT(Txt As String, n, Separator As String) As String\n On Error GoTo ErrHandler:\n EXTRACTELEMENT = Split(Application.Trim(Mid(Txt, 1)), Separator)(n - 1)\n Exit Function\nErrHandler:\n    ' error handling code\n    MsgBox \"ERROR: Verify if the data exists, example if the separator is correct.\"\n    On Error GoTo 0\nEnd Function\n</code></pre>\n\n<p>So to use the UDF, if the date is <code>diamesano = \"2/5/14\"</code></p>\n\n<ul>\n<li>the day will be <code>EXTRACTELEMENT(CStr(diamesano), 1, \"/\")</code> where 1 is the 1st element that is the value 2</li>\n<li>the month will be <code>EXTRACTELEMENT(CStr(diamesano), 2, \"/\")</code> where 2 is the 2nd element that is the value 5</li>\n<li>the year will be <code>EXTRACTELEMENT(CStr(diamesano), 3, \"/\")</code> where 3 is the 3rd element that is the value 14</li>\n</ul>\n\n<h3>Code to use the UDF and check dates</h3>\n\n<p>And the code changes to:</p>\n\n<pre><code>diamesano = \"12/18/2017\"\n\n    dia = CLng(EXTRACTELEMENT(CStr(diamesano), 1, \"/\"))\n    mes = CLng(EXTRACTELEMENT(CStr(diamesano), 2, \"/\"))\n    ano = CLng(EXTRACTELEMENT(CStr(diamesano), 3, \"/\"))\n    Debug.Print \"day: \" &amp; dia &amp; \" month: \" &amp; mes &amp; \" Year: \" &amp; ano\n\n    date_error = 0\n    If mes &gt;= 1 And mes &lt;= 12 Then 'Check if month is ok\n        mesAno = mes &amp; \"/\" &amp; ano\n        DiasNoMes = Day(DateSerial(Year(mesAno), Month(mesAno) + 1, 0))\n        If dia &gt;= 1 And dia &lt;= DiasNoMes Then 'Check the amount of days on this month and if is in range\n            Debug.Print \"OK\"\n           'Do something because the Date is valid!\n        Else\n           date_error = 1\n        End If\n    Else\n        date_error = 1\n    End If\n\n    If date_error = 1 Then\n             Debug.Print \"NOK\"\n            'Date is invalid =P\n    End If\n</code></pre>\n\n<h3>Create UDF to check if the Date is right</h3>\n\n<pre><code>Function IsDateRight(diamesano) As String\n    On Error GoTo ErrHandler:\n    dia = CLng(Split(Application.Trim(Mid(CStr(diamesano), 1)), \"/\")(0))\n    mes = CLng(Split(Application.Trim(Mid(CStr(diamesano), 1)), \"/\")(1))\n    ano = CLng(Split(Application.Trim(Mid(CStr(diamesano), 1)), \"/\")(2))\n\n    'Debug.Print \"day: \" &amp; dia &amp; \" month: \" &amp; mes &amp; \" Year: \" &amp; ano\n\n    date_error = 0\n    If mes &gt;= 1 And mes &lt;= 12 Then 'Check if month is ok\n        mesAno = mes &amp; \"/\" &amp; ano\n        DiasNoMes = Day(DateSerial(Year(mesAno), Month(mesAno) + 1, 0))\n        If dia &gt;= 1 And dia &lt;= DiasNoMes Then 'Check the amount of days on this month and if is in range\n            IsDateRight = \"Yes\"\n           'Do something because the Date is valid!\n        Else\n           date_error = 1\n        End If\n    Else\n        date_error = 1\n    End If\n\n    If date_error = 1 Then\n             IsDateRight = \"No\"\n            'Date is invalid =P\n    End If\n    Exit Function\n    ErrHandler:\n    ' error handling code\n    MsgBox \"ERROR: Verify if the data exists, example if the separator is correct.\"\n    On Error GoTo 0\nEnd Function\n</code></pre>\n\n<p>And a test:</p>\n\n<p><a href=\"https://i.stack.imgur.com/xHyge.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xHyge.png\" alt=\"IsDateRight?\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 8289960, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gh1jm.jpg?s=128&g=1", "display_name": "Aur&#233;lio S. C. C. P&#243;voa", "link": "https://stackoverflow.com/users/8289960/aur%c3%a9lio-s-c-c-p%c3%b3voa"}, "edited": false, "score": 0, "creation_date": 1506540021, "post_id": 46455423, "comment_id": 79866862, "body": "I tried this code and seemed like a solution to me, but Excel returned me a InsertedDate = 12/06/2018. The code goes to ELSE because Application.International(xlMDY) is false and the DateSerial assigns 12/06/2018 to InsertedDate. Maybe we are missing something, because the code looks perfect for what I want!"}, {"owner": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "reply_to_user": {"reputation": 3, "user_id": 8289960, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gh1jm.jpg?s=128&g=1", "display_name": "Aur&#233;lio S. C. C. P&#243;voa", "link": "https://stackoverflow.com/users/8289960/aur%c3%a9lio-s-c-c-p%c3%b3voa"}, "edited": false, "score": 0, "creation_date": 1506540194, "post_id": 46455423, "comment_id": 79866964, "body": "@Aur&#233;lioS.C.C.P&#243;voa I am working on an edit right now. Check in a few minutes. Also can you tell me what was entered as well as what was returned?"}, {"owner": {"reputation": 3, "user_id": 8289960, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gh1jm.jpg?s=128&g=1", "display_name": "Aur&#233;lio S. C. C. P&#243;voa", "link": "https://stackoverflow.com/users/8289960/aur%c3%a9lio-s-c-c-p%c3%b3voa"}, "edited": false, "score": 0, "creation_date": 1506540558, "post_id": 46455423, "comment_id": 79867167, "body": "Assuming the user entered 12/18/2017, the value assigned to the variable InsertedDate was 12/06/2018. I&#39;ll wait. Thanks!"}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1506540695, "post_id": 46455423, "comment_id": 79867246, "body": "Yes, it is the same of excel formula <code>=DATE(2017;18;12)</code>, which means month 12 (1 year) + month 6, so you go to 2018"}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1506541883, "post_id": 46455423, "comment_id": 79867858, "body": "Nice UDF! Gonna try it"}, {"owner": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "reply_to_user": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1506541946, "post_id": 46455423, "comment_id": 79867890, "body": "@danieltakeshi I am still testing it as I was modifying it from existing UDF"}, {"owner": {"reputation": 3, "user_id": 8289960, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gh1jm.jpg?s=128&g=1", "display_name": "Aur&#233;lio S. C. C. P&#243;voa", "link": "https://stackoverflow.com/users/8289960/aur%c3%a9lio-s-c-c-p%c3%b3voa"}, "edited": false, "score": 0, "creation_date": 1506541947, "post_id": 46455423, "comment_id": 79867891, "body": "So, I was thinking. The result is a valid date (12/06/2018) although it doesn&#39;t work for me, because what I want is that VBA code to inform me that the date inserted is not valid. That&#39;s what&#39;s inside the IF statement. The ELSE statement is for valid dates.  If the user types 12/18/2017 I want the code to print: Invalid date! But if it the InsertedDate variable holds 12/06/2018 like it happened, the code will consider it a valid date and proceed to the ELSE statement. I was looking at the DateSerial Function online and it really must be the way."}, {"owner": {"reputation": 3, "user_id": 8289960, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gh1jm.jpg?s=128&g=1", "display_name": "Aur&#233;lio S. C. C. P&#243;voa", "link": "https://stackoverflow.com/users/8289960/aur%c3%a9lio-s-c-c-p%c3%b3voa"}, "edited": false, "score": 0, "creation_date": 1506542008, "post_id": 46455423, "comment_id": 79867928, "body": "Sorry, I didn&#39;t saw the edit. I&#39;ll try it immediately!"}, {"owner": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 0, "creation_date": 1506542330, "post_id": 46455423, "comment_id": 79868100, "body": "I did some more adjustments in the end to account for the local formatting."}, {"owner": {"reputation": 3, "user_id": 8289960, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gh1jm.jpg?s=128&g=1", "display_name": "Aur&#233;lio S. C. C. P&#243;voa", "link": "https://stackoverflow.com/users/8289960/aur%c3%a9lio-s-c-c-p%c3%b3voa"}, "edited": false, "score": 0, "creation_date": 1506542611, "post_id": 46455423, "comment_id": 79868239, "body": "It worked! I really appreciate it, man! Thank you so much! Although I just tried inserting 30/02/2017 and it considered the date valid! Hahahahaha! Well, that&#39;s not a real problem, I think I can handle it now, based on your code! I&#39;ll study it so I can use it some similar codes I have. Thanks again!"}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1506542701, "post_id": 46455423, "comment_id": 79868280, "body": "You could just change from 31, to the line of code i used as <code>DiasNoMes</code> which is DaysInMonth, because if you enter day 31 in February, it should return as invalid."}, {"owner": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "reply_to_user": {"reputation": 3, "user_id": 8289960, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gh1jm.jpg?s=128&g=1", "display_name": "Aur&#233;lio S. C. C. P&#243;voa", "link": "https://stackoverflow.com/users/8289960/aur%c3%a9lio-s-c-c-p%c3%b3voa"}, "edited": false, "score": 0, "creation_date": 1506542793, "post_id": 46455423, "comment_id": 79868337, "body": "@Aur&#233;lioS.C.C.P&#243;voa yes, it has issues with 31-30-28 days, I&#39;ll work on that one day :) . Thank you for accepting the answer"}], "tags": [], "owner": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "is_accepted": true, "score": 0, "last_activity_date": 1506542646, "last_edit_date": 1506542646, "creation_date": 1506538994, "answer_id": 46455423, "question_id": 46454663, "link": "https://stackoverflow.com/questions/46454663/date-automatically-reversing-vba-excel/46455423#46455423", "title": "Date Automatically Reversing VBA Excel", "body": "<p>If you choose data type as <code>Date</code> it will automatically convert dates to american format.<br>\nMy suggestion is to check the date format of the user and assume he uses the same (and it is not the safest assumption):</p>\n\n<pre><code>If Application.International(xlMDY) then\n     InsertedDate = Me.BoxDate.Value\nElse:\n     Arr = Split(Me.BoxDate.Value,\"/\")\n     InsertedDate = DateSerial(Arr(2),Arr(1),Arr(0))\nEnd if\n</code></pre>\n\n<p>But it assumes that user has used \"/\" as a delimite - and there could be a lot of other scenarios. You can use a date picker instead or a function that will validate the date.</p>\n\n<p>EDIT:\nActually here is a variation of function I use and its implementation in your code:</p>\n\n<pre><code>Sub TestDate()\nIf ConformDate(Me.BoxDate.Value) = \"\" Then\n    MsgBox \"Invalid Date!\"\nElse\n    MsgBox \"\" &amp; ConformDate(Me.BoxDate.Value) &amp; \" is a valid date\"\nEnd If\nEnd Sub\n\nFunction ConformDate(DataToTransform As String) As String\n\nDim DTT         As String\nDim delim       As String\nDim i           As Integer\nDTT = DataToTransform\n\nDTT = Trim(DTT)\nWith CreateObject(\"VBScript.RegExp\")\n    .Pattern = \"\\s+\"\n    .Global = True\n    DTT = .Replace(DTT, \" \")\nEnd With\nSelect Case True\n   Case (DTT Like \"*/*/*\")\n        delim = \"/\"\n   Case (DTT Like \"*-*-*\")\n        delim = \"-\"\n   Case (DTT Like \"*.*.*\")\n        delim = \".\"\n   Case (DTT Like \"* * *\")\n        delim = \" \"\n   Case Else\n        ConformDate = \"\"\n        Exit Function\nEnd Select\nArr = Split(DTT, delim)\nIf UBound(Arr) &lt; 2 Then\n    ConformDate = \"\"\n    Exit Function\nEnd If\nDim Arrm(2) As String\nIf Application.International(xlMDY) Then\n    Arrm(0) = Arr(0)\n    Arrm(1) = Arr(1)\n    Arrm(2) = Arr(2)\nElse\n    Arrm(0) = Arr(1)\n    Arrm(1) = Arr(0)\n    Arrm(2) = Arr(2)\nEnd If\nFor i = LBound(Arrm) To UBound(Arrm)\n    If Not IsNumeric(Arrm(i)) Then\n        ConformDate = \"\"\n        Exit Function\n    End If\nSelect Case i\n        Case 0\n            ' Month\n            If Len(Arrm(i)) &lt; 1 Or Len(Arrm(i)) &gt; 2 Then\n                ConformDate = \"\"\n                Exit Function\n            End If\n            If Left(Arrm(i), 1) = \"0\" And Len(Arrm(i)) = 1 Then\n                ConformDate = \"\"\n                Exit Function\n            End If\n            If Left(Arrm(i), 1) = \"0\" Then Arr(i) = Right(Arrm(i), 1)\n            If Arrm(i) &gt; 12 Then\n                ConformDate = \"\"\n                Exit Function\n            End If\n        Case 1\n            ' Day\n            If Len(Arrm(i)) &lt; 1 Or Len(Arrm(i)) &gt; 2 Then\n                ConformDate = \"\"\n                Exit Function\n            End If\n\n            If Left(Arrm(i), 1) = \"0\" And Len(Arrm(i)) = 1 Then\n                ConformDate = \"\"\n                Exit Function\n            End If\n            If Left(Arrm(i), 1) = \"0\" Then Arrm(i) = Right(Arrm(i), 1)\n                If Arrm(i) &gt; 31 Then\n                ConformDate = \"\"\n                Exit Function\n            End If\n            Case 2\n            ' Year\n            If Not (Len(Arrm(i)) = 2 Or Len(Arrm(i)) = 4) Then\n                ConformDate = \"\"\n                Exit Function\n            End If\n            If Len(Arrm(i)) = 2 Then Arrm(i) = Left(Year(Date), 2) &amp; CStr(Arrm(i))\n End Select\nNext\n\nIf Application.International(xlMDY) Then\n    ConformDate = Format((DateSerial(CInt(Arrm(2)), CInt(Arrm(0)), CInt(Arrm(1)))), \"dd/mm/yyyy\")\nElse\n     ConformDate = Format((DateSerial(CInt(Arrm(2)), CInt(Arrm(1)), CInt(Arrm(0)))), \"dd/mm/yyyy\")\nEnd If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8289960, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gh1jm.jpg?s=128&g=1", "display_name": "Aur&#233;lio S. C. C. P&#243;voa", "link": "https://stackoverflow.com/users/8289960/aur%c3%a9lio-s-c-c-p%c3%b3voa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1083, "favorite_count": 0, "accepted_answer_id": 46455423, "answer_count": 2, "score": 0, "last_activity_date": 1507139948, "creation_date": 1506536292, "question_id": 46454663, "link": "https://stackoverflow.com/questions/46454663/date-automatically-reversing-vba-excel", "title": "Date Automatically Reversing VBA Excel", "body": "<p>So, I'm having some problems with dates that are reversing themselves in VBA when assigned to a Date variable. It's simpler than it sounds, but it's really bugging me.</p>\n\n<p>Code:</p>\n\n<pre><code>Dim InsertedDate as Date\n\nOn Error Resume Next\n\nInsertedDate = Me.BoxDate.Value\n\nIf InsertedDate = 0 Then\n\n     'Do Something\n\nElse\n\n     'Do Something Different\n\nEnd If\n</code></pre>\n\n<p>So let's assume that user types a value like</p>\n\n<pre><code>12/18/2017\n</code></pre>\n\n<p>I'm brazilian, so that means the user typed the 12th day of the 18th month. Since there's no 18th month in the year, the user shouldn't be able to type that date and InsertedDate should be equal to 0, right? Or not? I mean, I'm not really sure how Excel work dates. </p>\n\n<p>Anyway, what happens is: Excel automatically reverses the date to </p>\n\n<pre><code>18/12/2017       'InsertedDate Value\n</code></pre>\n\n<p>instead of InsertedDate being</p>\n\n<pre><code>12/18/2017       'InsertedDate Value\n</code></pre>\n\n<p>And the code goes to 'Do Something Different. So, how do I solve this? Notice that I haven't assigned the variable value to anything. The process of reversion happens automatically when assigning the value to the variable. I've already tried</p>\n\n<pre><code>Format(InsertedDate, \"dd/mm/yyyy\")    'Did not work\n</code></pre>\n\n<p>and</p>\n\n<pre><code>InsertedDate = CDate(Me.BoxDate.Value)  'Did not work\n</code></pre>\n\n<p>and I tried converting the values in other variables and stuff. So, I'm lost. If anyone could help me, I'd be extremely grateful. Thank you in advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "edited": false, "score": 0, "creation_date": 1506536237, "post_id": 46454603, "comment_id": 79864812, "body": "There are probably email security settings you can&#39;t get around without assistance from your sysAdmin but disabling these safety features is not advisable. Surely, there is a common file share you can save it to then include a link in the email to the file so they can pull the <code>xlsm</code> down to their local machine."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1506536445, "post_id": 46454603, "comment_id": 79864914, "body": "What is the error, and what instruction is causing it?"}], "answers": [{"comments": [{"owner": {"reputation": 427, "user_id": 4995049, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/60e3b321eb9b28047e4a7966cdb756ab?s=128&d=identicon&r=PG&f=1", "display_name": "Coding Novice", "link": "https://stackoverflow.com/users/4995049/coding-novice"}, "edited": false, "score": 0, "creation_date": 1506604381, "post_id": 46454684, "comment_id": 79895142, "body": "Thank you this was very helpful! The only problem that I am encountering with this is that the file format although macro enabled does not preserve the existing macros in the document."}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": true, "score": 1, "last_activity_date": 1506536341, "creation_date": 1506536341, "answer_id": 46454684, "question_id": 46454603, "link": "https://stackoverflow.com/questions/46454603/emailing-workbook-with-macros-and-all/46454684#46454684", "title": "Emailing Workbook With Macros and All", "body": "<p>you need to also include this argument in your <code>.SaveAs</code> line.</p>\n\n<pre><code>FileFormat:=xlOpenXMLWorkbookMacroEnabled\n</code></pre>\n"}], "owner": {"reputation": 427, "user_id": 4995049, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/60e3b321eb9b28047e4a7966cdb756ab?s=128&d=identicon&r=PG&f=1", "display_name": "Coding Novice", "link": "https://stackoverflow.com/users/4995049/coding-novice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 46454684, "answer_count": 1, "score": -1, "last_activity_date": 1506536341, "creation_date": 1506536054, "question_id": 46454603, "link": "https://stackoverflow.com/questions/46454603/emailing-workbook-with-macros-and-all", "title": "Emailing Workbook With Macros and All", "body": "<p>I have a workbook that I am trying to email with macros. This way the recipient will also be able to use the macros that are included with the workbook. This will make office life easier for my company. I have tried setting the saved file name to .xlsm, but that causes an error.</p>\n\n<p>This is my code (which is adapted from sources online)</p>\n\n<pre><code>Sub MailGo()\n 'Variable declaration\nDim oApp As Object, _\noMail As Object, _\nWB As Workbook, _\nFileName As String, MailSub As String, MailTxt As String\n\n 'Turns off screen updating\nApplication.ScreenUpdating = False\n\n 'Makes a copy of the active sheet and save it to\n 'a temporary file\nActiveSheet.Copy\nSet WB = ActiveWorkbook\nFileName = \"Text.xls\"\nOn Error Resume Next\nKill \"C:\\\" &amp; FileName\nOn Error GoTo 0\nWB.SaveAs FileName:=\"C:\\Users\\Public\\Documents\" &amp; FileName\n\n 'Creates and shows the outlook mail item\nSet oApp = CreateObject(\"Outlook.Application\")\nSet oMail = oApp.CreateItem(0)\nWith oMail\n    .To = \"wesley.x.sherow@us.tel.com\"\n    .Cc = \"\"\n    .Bcc = \"\"\n    .Subject = \"LotInput\"\n    .Body = \"LotInput\"\n    .Attachments.Add WB.FullName\n    .Display\n    .send\nEnd With\n\n 'Deletes the temporary file\nWB.ChangeFileAccess Mode:=xlReadOnly\nKill WB.FullName\nWB.Close SaveChanges:=False\n\n 'Restores screen updating and release Outlook\nApplication.ScreenUpdating = True\nSet oMail = Nothing\nSet oApp = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "pivot-table"], "comments": [{"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1506541117, "post_id": 46454256, "comment_id": 79867453, "body": "Frank...can you post a link to a screenshot that illustrates what you are trying to accomplish?"}, {"owner": {"reputation": 1, "user_id": 4287305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7a9482b81165f95193f05c1ce732283?s=128&d=identicon&r=PG&f=1", "display_name": "Frank MacLoud", "link": "https://stackoverflow.com/users/4287305/frank-macloud"}, "reply_to_user": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1506634323, "post_id": 46454256, "comment_id": 79912371, "body": "Hi Jeffrey, it took me a while but at the end it was super easy. PivotCell.RowItems.Count was the information I needed. Depending on the count I wanted to manipulate the cell."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4287305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7a9482b81165f95193f05c1ce732283?s=128&d=identicon&r=PG&f=1", "display_name": "Frank MacLoud", "link": "https://stackoverflow.com/users/4287305/frank-macloud"}, "is_accepted": false, "score": 0, "last_activity_date": 1506634491, "creation_date": 1506634491, "answer_id": 46478670, "question_id": 46454256, "link": "https://stackoverflow.com/questions/46454256/how-do-i-check-to-which-row-area-field-a-cell-in-a-pivottable-belongs-to/46478670#46478670", "title": "How do I check to which row area field a cell in a pivottable belongs to?", "body": "<p>It took me a while. But at the end I just needed PivotCell.RowItems.Count</p>\n\n<p>Depending on the Count result I can new manipulate the cell.</p>\n"}], "owner": {"reputation": 1, "user_id": 4287305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7a9482b81165f95193f05c1ce732283?s=128&d=identicon&r=PG&f=1", "display_name": "Frank MacLoud", "link": "https://stackoverflow.com/users/4287305/frank-macloud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1506634491, "creation_date": 1506534764, "question_id": 46454256, "link": "https://stackoverflow.com/questions/46454256/how-do-i-check-to-which-row-area-field-a-cell-in-a-pivottable-belongs-to", "title": "How do I check to which row area field a cell in a pivottable belongs to?", "body": "<p>I have a PivotTable in compact form layout (default layout) with multiple row area fields. This results in multiple grouping levels with buttons to collapse or expand rows.</p>\n\n<p>I want to modify a cell depending on the grouping level the row is in.</p>\n\n<p>How can I check in which row the cell is in?</p>\n\n<p>The only idea I had so far was to check the value of the leftmost cell in the corresponding row and compare it with each item from each rowField.</p>\n\n<p>But I guess there is a smarter way?</p>\n"}, {"tags": ["arrays", "excel", "autofilter", "vba"], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 8151407, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/af61628042d4fec525196a23f7e0e9a0?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/8151407/ben"}, "edited": false, "score": 0, "creation_date": 1506558265, "post_id": 46454662, "comment_id": 79873524, "body": "Sorry if this was unclear. I do NOT want to use this method. I want to use the one that is already defined AKA StartingArray is what I want to use."}, {"owner": {"reputation": 657, "user_id": 5994620, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UjudG.jpg?s=128&g=1", "display_name": "BerticusMaximus", "link": "https://stackoverflow.com/users/5994620/berticusmaximus"}, "reply_to_user": {"reputation": 151, "user_id": 8151407, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/af61628042d4fec525196a23f7e0e9a0?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/8151407/ben"}, "edited": false, "score": 0, "creation_date": 1506606031, "post_id": 46454662, "comment_id": 79896360, "body": "Even if you&#39;re not manually creating that array the syntax in the third line should work for you. <code>Criteria1:=StoredArray</code> instead of <code>Criteria1:=Array(StoredArray.Values)</code> if I still don&#39;t understand please go into more detail so we can help."}, {"owner": {"reputation": 151, "user_id": 8151407, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/af61628042d4fec525196a23f7e0e9a0?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/8151407/ben"}, "edited": false, "score": 0, "creation_date": 1507057247, "post_id": 46454662, "comment_id": 80057562, "body": "I am still having the same issues as I mentioned below. When I use the <code>Criteria1:=StoredArray</code> I am getting it to filter but only a filter for the first value in my array. I am suspecting that I might need to redefine the array and it might be due to the size or dimensions. Help on this work be greatly appreciated as I can not figure out why it is doing this. Please see the photo in the original post to see how the variable <code>StoredArray</code> is being defined."}, {"owner": {"reputation": 657, "user_id": 5994620, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UjudG.jpg?s=128&g=1", "display_name": "BerticusMaximus", "link": "https://stackoverflow.com/users/5994620/berticusmaximus"}, "reply_to_user": {"reputation": 151, "user_id": 8151407, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/af61628042d4fec525196a23f7e0e9a0?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/8151407/ben"}, "edited": false, "score": 0, "creation_date": 1507058501, "post_id": 46454662, "comment_id": 80058166, "body": "@Ben Okay I think I found your issue. You have a single array but have it set up as a multi dimensional <code>(1 To 3, 1 To 1)</code> the <code>1 To 1</code> is completely useless here and screwing you up. Could you post the code on where you&#39;re pulling that array from or populating it?"}], "tags": [], "owner": {"reputation": 657, "user_id": 5994620, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UjudG.jpg?s=128&g=1", "display_name": "BerticusMaximus", "link": "https://stackoverflow.com/users/5994620/berticusmaximus"}, "is_accepted": false, "score": 1, "last_activity_date": 1506536291, "creation_date": 1506536291, "answer_id": 46454662, "question_id": 46454236, "link": "https://stackoverflow.com/questions/46454236/autofilter-criteria-with-array/46454662#46454662", "title": "Autofilter Criteria with Array", "body": "<p>I think your issue is with how you're defining your array. Try this instead.</p>\n\n<pre><code>Dim StoredArrayString As Variant\nStoredArrayString = Array(\"73578\", \"78759\", \"78765\")\nActiveSheet.Range(\"$A$1:$AL$1002\").AutoFilter Field:=17, _\n        Criteria1:=StoredArrayString, Operator:=xlFilterValues\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 151, "user_id": 8151407, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/af61628042d4fec525196a23f7e0e9a0?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/8151407/ben"}, "edited": false, "score": 0, "creation_date": 1506558681, "post_id": 46454681, "comment_id": 79873614, "body": "This is close to working for me the Issue that I am having is that it is only using the first value in my array. See the array that is defined above in the photo."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1506536334, "creation_date": 1506536334, "answer_id": 46454681, "question_id": 46454236, "link": "https://stackoverflow.com/questions/46454236/autofilter-criteria-with-array/46454681#46454681", "title": "Autofilter Criteria with Array", "body": "<p>Starting with:</p>\n\n<p><a href=\"https://i.stack.imgur.com/cG0yt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cG0yt.png\" alt=\"enter image description here\"></a></p>\n\n<p>and run:</p>\n\n<pre><code>Sub Macro7()\n    Dim ary(1 To 3) As String\n    ary(1) = \"Alice\"\n    ary(2) = \"Boris\"\n    ary(3) = \"James\"\n    ActiveSheet.Range(\"$A$1:$D$22\").AutoFilter Field:=3, Criteria1:=ary, Operator:=xlFilterValues\nEnd Sub\n</code></pre>\n\n<p>will produce:</p>\n\n<p><a href=\"https://i.stack.imgur.com/UZxUG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UZxUG.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 881, "user_id": 681076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b3d54cbc4d678ba19de7ee8aea25cb1?s=128&d=identicon&r=PG", "display_name": "Guedes", "link": "https://stackoverflow.com/users/681076/guedes"}, "edited": false, "score": 0, "creation_date": 1613001800, "post_id": 66146383, "comment_id": 116945280, "body": "It seems a new <i>question</i> to me, but you post it as an <i>answer</i>. What about change it to a comment or even a new question?"}, {"owner": {"reputation": 43, "user_id": 11374493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12426f91c60fb3a094632c563f16cdf?s=128&d=identicon&r=PG&f=1", "display_name": "Asd13", "link": "https://stackoverflow.com/users/11374493/asd13"}, "reply_to_user": {"reputation": 881, "user_id": 681076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b3d54cbc4d678ba19de7ee8aea25cb1?s=128&d=identicon&r=PG", "display_name": "Guedes", "link": "https://stackoverflow.com/users/681076/guedes"}, "edited": false, "score": 0, "creation_date": 1613034752, "post_id": 66146383, "comment_id": 116953076, "body": "Hi Guedes, apologies, thought I needed a minimum number reputation. Could you help with above pls? The Array that I am referencing is in another worksheet, but I do not know how I can reference that worksheet. Pls help"}], "tags": [], "owner": {"reputation": 43, "user_id": 11374493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12426f91c60fb3a094632c563f16cdf?s=128&d=identicon&r=PG&f=1", "display_name": "Asd13", "link": "https://stackoverflow.com/users/11374493/asd13"}, "is_accepted": false, "score": 0, "last_activity_date": 1612997980, "creation_date": 1612997980, "answer_id": 66146383, "question_id": 46454236, "link": "https://stackoverflow.com/questions/46454236/autofilter-criteria-with-array/66146383#66146383", "title": "Autofilter Criteria with Array", "body": "<p>I have a similar problem.</p>\n<p>I'm trying to use array as critera, but my criteria (currently 1/1/2023) is dynamic and sits in another worksheet. How can I get the code to pick up this criteria from the other worksheet (Sheet3) for example.</p>\n<pre><code>'\n' data_test_2 Macro\n'\n\n'\n    With Worksheets(&quot;LNG_PORTFOLIO_2023_SG_HIST&quot;).Range(&quot;A1&quot;)\n    .AutoFilter Field:=28, Operator:=xlFilterValues, Criteria2:=Array(1, &quot;1/1/2023&quot;)\n\nEnd With\nEnd Sub```\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 8151407, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/af61628042d4fec525196a23f7e0e9a0?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/8151407/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7049, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1612997980, "creation_date": 1506534697, "last_edit_date": 1531164843, "question_id": 46454236, "link": "https://stackoverflow.com/questions/46454236/autofilter-criteria-with-array", "title": "Autofilter Criteria with Array", "body": "<p>I have been looking to find a solution and cant find anything online that fully explains what is going on. I looked at some other posts but they all seem to fall a bit short. </p>\n\n<p>When I run this bit of code it works perfectly (as it was recorded).</p>\n\n<pre><code>ActiveSheet.Range(\"$A$1:$AL$1002\").AutoFilter Field:=17, Criteria1:=Array( _\n    \"73578\", \"78759\", \"78765\"), Operator:=xlFilterValues\n</code></pre>\n\n<p>But then when I try to make it more robust it fails. I want to change the Criteria1 argument to an already stored array.</p>\n\n<p>I am trying to get the following to work.</p>\n\n<pre><code>ActiveSheet.Range(\"$A$1:$AL$1002\").AutoFilter Field:=17, _\n    Criteria1:=Array(StoredArray.Values), Operator:=xlFilterValues\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/gshQ8.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gshQ8.jpg\" alt=\"Array values\"></a></p>\n\n<p>I have the array stored and I manipulate it anyway but I have yet to get anything to work. I have also tried to create a string to be exactly like the recorded macro but that does not work either. </p>\n\n<pre><code>Dim StoredArrayString as Variant\nStoredArrayString = \"73578\"\", \"\"78759\"\", \"\"78765\"\nActiveSheet.Range(\"$A$1:$AL$1002\").AutoFilter Field:=17, _\n        Criteria1:=StoredArrayString, Operator:=xlFilterValues\n</code></pre>\n\n<p>Thanks for the help here I have spent lots of time on MSDN trying to research this issue but can't find a solution.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 251, "user_id": 6451218, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a0578b1c77c327c900a26f0f02328fc?s=128&d=identicon&r=PG&f=1", "display_name": "XLmatters", "link": "https://stackoverflow.com/users/6451218/xlmatters"}, "edited": false, "score": 1, "creation_date": 1506535159, "post_id": 46454032, "comment_id": 79864245, "body": "I&#39;ve should have come up with this ... slipping lately :).  This worked the trick.  Thanks."}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": true, "score": 2, "last_activity_date": 1506533874, "creation_date": 1506533874, "answer_id": 46454032, "question_id": 46453999, "link": "https://stackoverflow.com/questions/46453999/delete-column-if-header-does-not-contain/46454032#46454032", "title": "Delete Column if Header does not Contain", "body": "<p>You can use <code>And</code></p>\n\n<pre><code>If InStr(3, ActiveSheet.UsedRange.Cells(3, currentColumn).Value, _\n       \"Homer\", vbBinaryCompare) = 0 And InStr(3, ActiveSheet.UsedRange.Cells(3, currentColumn).Value, _\n       \"Marge\", vbBinaryCompare) = 0 Then\nActiveSheet.Columns(currentColumn).Delete\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 251, "user_id": 6451218, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a0578b1c77c327c900a26f0f02328fc?s=128&d=identicon&r=PG&f=1", "display_name": "XLmatters", "link": "https://stackoverflow.com/users/6451218/xlmatters"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 439, "favorite_count": 0, "accepted_answer_id": 46454032, "answer_count": 1, "score": 1, "last_activity_date": 1506540569, "creation_date": 1506533735, "last_edit_date": 1506540569, "question_id": 46453999, "link": "https://stackoverflow.com/questions/46453999/delete-column-if-header-does-not-contain", "title": "Delete Column if Header does not Contain", "body": "<p>The following code works if one word is used, although, I would like it to look for two words.  So if column header, found in row 3, does not contain \"Homer\" or \"Marge\", delete that entire column.</p>\n\n<pre><code>Sub DontDelete()\n\nDim currentColumn As Integer\n\n'Delete if the cell doesn't contain \"Homer\" OR \"Marge\"\nIf InStr(3, _\n   ActiveSheet.UsedRange.Cells(3, currentColumn).Value, _\n       \"Homer\", vbBinaryCompare) = 0 Then\n\nActiveSheet.Columns(currentColumn).Delete\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>How can I incorporate <code>OR \"Marge\"</code> into this statement?</p>\n"}, {"tags": ["arrays", "vba", "excel", "dynamic-arrays"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1506533684, "post_id": 46453875, "comment_id": 79863508, "body": "Can you add some code to show how the first sub is being called? wbCurrent doesn&#39;t seem to be defined anywhere. And why is the array being redimensioned if the value is found. Why not just not add the value if it already exists?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 2, "creation_date": 1506533745, "post_id": 46453875, "comment_id": 79863535, "body": "You should look into using a <code>Scripting Dictionary</code> instead, as it has an <code>.Exists</code> method you can use to easily create a distinct list. It can then later be turned into an <code>Array</code>"}, {"owner": {"reputation": 33, "user_id": 8684622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a1f9fecf48f8f5c99dd6acacad3cbe6?s=128&d=identicon&r=PG&f=1", "display_name": "PrimeTurtler", "link": "https://stackoverflow.com/users/8684622/primeturtler"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1506534537, "post_id": 46453875, "comment_id": 79863921, "body": "@braX In some instances I need 2 parts to my array, in others only 1. I&#39;ve done it this way so I can reuse my array sub in multiple places. From what I can tell <code>Scripting Dictionaries</code> don&#39;t allow me to do that.  @SJR If the value is not found then the function returns <code>False</code> and the value is added. If the value is found then the function returns <code>True</code> and the <code>If</code> statement is skipped."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1506534945, "post_id": 46453875, "comment_id": 79864124, "body": "@PrimeTurtler Sure it can.  With just the two items, you could use the <code>Key</code> and <code>Value</code> parameters; or you could store both parts as the <code>Value</code> in an array."}, {"owner": {"reputation": 33, "user_id": 8684622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a1f9fecf48f8f5c99dd6acacad3cbe6?s=128&d=identicon&r=PG&f=1", "display_name": "PrimeTurtler", "link": "https://stackoverflow.com/users/8684622/primeturtler"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1506535662, "post_id": 46453875, "comment_id": 79864519, "body": "@RonRosenfeld I was under the impression I couldn&#39;t do that, though now I have no idea where I got that idea from. I&#39;ll try it and post an update."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1506535772, "post_id": 46453875, "comment_id": 79864581, "body": "<code>Key</code> is what you are using to test for duplicates. You can then store whatever you want -- string, number, array, object, etc -- as the <code>Value</code>"}], "answers": [{"tags": [], "owner": {"reputation": 211, "user_id": 8651782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d71f253fb066108065e8b7ff5a747f?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Fenner", "link": "https://stackoverflow.com/users/8651782/joshua-fenner"}, "is_accepted": false, "score": 0, "last_activity_date": 1506538943, "creation_date": 1506538943, "answer_id": 46455407, "question_id": 46453875, "link": "https://stackoverflow.com/questions/46453875/vba-dynamic-array-duplicating-some-values-in-error/46455407#46455407", "title": "VBA dynamic array duplicating some values in error", "body": "<h1>Problems</h1>\n\n<p>You are checking for strings inside a variant array.  The data could be string or number, therefore giving you duplicates.  I suggest changing your function <code>Function IsInArray(stringToBeFound As String, arr As Variant) As Boolean</code> to <code>Function IsInArray(stringToBeFound As Variant, arr() As Variant) As Boolean</code></p>\n\n<p>There are a few variables that need to be Declared.  See below.</p>\n\n<pre><code>Sub ProductNumberArray(strWrkShtName As String, strFindColumn As String, blAsGrp As Boolean, iStart As Integer)\nDim i As long, j as long 'just use long for i.  integers are silently converted to long anyway.  leaving j undeclared makes it variant.\nDim lastRow As Integer\nDim iFindColumn As Integer\nDim checkString As Variant ' changed to variant\nDim arrProductNumber() as Variant ' delcare a dynamic array\n\nReDim arrProductNumber(0 To 0) ' making it an array\n\nj = 0 'giving somewhere to start\n\nWith wbCurrent.Worksheets(strWrkShtName)\n    iFindColumn = .UsedRange.Find(strFindColumn, .Range(\"A1\"), xlValues, xlWhole, xlByColumns).Column\n    lastRow = .Cells(Rows.Count, iFindColumn).End(xlUp).row\n    For i = iStart To lastRow\n        checkString = .Cells(i, iFindColumn).Value\n        If IsInArray(checkString, arrProductNumber) = False Then\n            If blAsGrp = False Then\n                ReDim Preserve arrProductNumber(0 To j)\n                arrProductNumber(j) = checkString\n                j = j + 1\n            Else\n                ReDim Preserve arrProductNumber(1, 0 To j)\n                arrProductNumber(0, j) = .Cells(i, iFindColumn - 1).Value\n                arrProductNumber(1, j) = checkString\n                j = j + 1\n            End If\n        End If\n    Next i\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1506540098, "creation_date": 1506540098, "answer_id": 46455712, "question_id": 46453875, "link": "https://stackoverflow.com/questions/46453875/vba-dynamic-array-duplicating-some-values-in-error/46455712#46455712", "title": "VBA dynamic array duplicating some values in error", "body": "<p>I'm guessing that you are getting duplicates because <code>j</code> and  <code>arrProductNumber</code> is are Global variables.  You should get rid of the Globals by passing the Worksheet to a function that will return your array.</p>\n\n<p>You could simply add the Cell references to a Scripting.Dictionary</p>\n\n<pre><code>If not dic.Exists(Cell.Value) then dic.Add Cell.Value, Cell\n</code></pre>\n\n<p>and later retrieve the reference by it's key value</p>\n\n<pre><code>ProductOffset = dic(\"PID798YD\").Offset(0,-1)\n</code></pre>\n\n<p>Here I use an ArrayList (I could have used a Scripting.Dictionary) to check for duplicates and act as a counter to Redim a multidimensional array.</p>\n\n<hr>\n\n<pre><code>Sub TestgetProductData()\n    Dim results As Variant\n    results = getProductData(ActiveSheet, \"Column 5\", True, 3)\n    Stop\n    results = getProductData(ActiveSheet, \"Column 5\", False, 3)\n    Stop\nEnd Sub\n\nFunction getProductData(ws As Worksheet, ColumnHeader As String, blAsGrp As Boolean, iStart As Integer) As Variant\n    Dim results As Variant\n    Dim cell As Range, Source As Range\n    Dim list As Object\n    Set list = CreateObject(\"System.Collections.ArrayList\")\n\n    With ws.UsedRange\n        Set Source = .Find(ColumnHeader, .Range(\"A1\"), xlValues, xlWhole, xlByColumns)\n        If Not Source Is Nothing Then\n            Set Source = Intersect(.Cells, Source.EntireColumn)\n            Set Source = Intersect(.Cells, Source.Offset(iStart))\n            For Each cell In Source\n                If Not list.Contains(cell.Value) Then\n\n                    If blAsGrp Then\n                        If list.Count = 0 Then ReDim results(0 To 1, 0 To 0)\n\n                        ReDim Preserve results(0 To 1, 0 To list.Count)\n                        results(0, list.Count) = cell.Offset.Value\n                        results(1, list.Count) = cell.Value\n                    End If\n                    list.Add cell.Value\n                End If\n            Next\n        End If\n    End With\n    If blAsGrp Then\n        getProductData = results\n    Else\n        getProductData = list.ToArray\n    End If\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5449, "user_id": 1961728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bqpz6.png?s=128&g=1", "display_name": "robinCTS", "link": "https://stackoverflow.com/users/1961728/robincts"}, "edited": false, "score": 1, "creation_date": 1506597581, "post_id": 46456992, "comment_id": 79890447, "body": "Nice one! See my answer for the neat way to extract values from the dictionary."}], "tags": [], "owner": {"reputation": 33, "user_id": 8684622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a1f9fecf48f8f5c99dd6acacad3cbe6?s=128&d=identicon&r=PG&f=1", "display_name": "PrimeTurtler", "link": "https://stackoverflow.com/users/8684622/primeturtler"}, "is_accepted": false, "score": 1, "last_activity_date": 1506545352, "creation_date": 1506545352, "answer_id": 46456992, "question_id": 46453875, "link": "https://stackoverflow.com/questions/46453875/vba-dynamic-array-duplicating-some-values-in-error/46456992#46456992", "title": "VBA dynamic array duplicating some values in error", "body": "<p>Per the recommendations of @RonRosenfield and @braX, I tried a <code>Scripting.Dictionary</code> and came up with this answer. It both creates and checks the values, unlike my previous method which used a sub to create and a function to check.</p>\n\n<pre><code>Sub ProductNumberDictionary(strWrkShtName As String, strFindCol As String, blAsGrp As Boolean, iStart As Integer)\n    Dim i As Integer\n    Dim iLastRow As Integer\n    Dim iFindCol As Integer\n    Dim strCheck As String\n\n    Set dictProductNumber = CreateObject(\"Scripting.Dictionary\")\n\n    With wbCurrent.Worksheets(strWrkShtName)\n        iFindCol = .UsedRange.Find(strFindCol, .Cells(1, 1), xlValues, xlWhole, xlByColumns).Column\n        iLastRow = .Cells(Rows.Count, iFindCol).End(xlUp).row\n        For i = iStart To iLastRow\n            strCheck = .Cells(i, iFindCol).Value\n            If dictProductNumber.exists(strCheck) = False Then\n                If blAsGrp = False Then\n                    dictProductNumber.Add Key:=strCheck\n                Else\n                    dictProductNumber.Add Key:=strCheck, Item:=.Cells(i, iFindCol - 1).Value\n                End If\n            End If\n        Next\n    End With\nEnd Sub\n</code></pre>\n\n<p>I had some difficulty with getting values from this dictionary, but found that this worked:</p>\n\n<pre><code>    Dim o as Variant\n    i = 0\n    For Each o In dictProductNumber.Keys\n        .Cells(iRowStart + i, iFirstCol + 1) = o 'returns the value of the key\n        .Cells(iRowStart + i, iFirstCol + 2) = dictProductNumber(o) 'returns the item stored with the key\n        i = i + 1\n    Next\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 8684622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a1f9fecf48f8f5c99dd6acacad3cbe6?s=128&d=identicon&r=PG&f=1", "display_name": "PrimeTurtler", "link": "https://stackoverflow.com/users/8684622/primeturtler"}, "edited": false, "score": 0, "creation_date": 1506604073, "post_id": 46467812, "comment_id": 79894926, "body": "I&#39;m choosing this answer because it solved the question I was asking, instead of creating a new way to answer the problem (like I did with my <code>Scripting.Dictionary</code>). Adding the <code>LBound</code> code fixed the problem. Thanks!"}], "tags": [], "owner": {"reputation": 5449, "user_id": 1961728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bqpz6.png?s=128&g=1", "display_name": "robinCTS", "link": "https://stackoverflow.com/users/1961728/robincts"}, "is_accepted": true, "score": 1, "last_activity_date": 1506597412, "creation_date": 1506597412, "answer_id": 46467812, "question_id": 46453875, "link": "https://stackoverflow.com/questions/46453875/vba-dynamic-array-duplicating-some-values-in-error/46467812#46467812", "title": "VBA dynamic array duplicating some values in error", "body": "<p>None of the (wild) guesses so far as to what's causing the duplicate issue you're having are even close. It is actually caused by a bug in your code.</p>\n\n<p>In your <code>IsInArray</code> function, you finish the array loop index at the wrong value. <code>For i = 1 To UBound(arr, 2)</code> should be <code>For i = 1 To UBound(arr, 2) - LBound(arr, 2) + 1</code>. As your index finishes one short, this means that the compare string is never checked against the last array item and as a consequence, the second of any consecutive identical values will be copied across as a duplicate. Always use both <code>LBound</code> and <code>UBound</code> in the index parameters to avoid this and similar types of bugs.</p>\n\n<p><br>However, this fix is redundant as the function can be rewritten to avoid a loop altogether. I've also added a few other enhancements:</p>\n\n<pre><code>Function IsInArray(stringToBeFound As String, arr As Variant) As Boolean\n  Dim bDimen As Long\n  Dim i As Long\n\n  On Error Resume Next\n    bDimen = 2\n    If IsError(UBound(arr, 2)) Then bDimen = bDimen - 1\n    If IsError(UBound(arr, 1)) Then bDimen = bDimen - 1\n  On Error GoTo 0\n\n  Select Case bDimen\n    Case 0:\n    ' Uninitialized array - return false\n    Case 1:\n      On Error Resume Next\n        IsInArray = Application.Match(stringToBeFound, arr, 0)\n      On Error GoTo 0\n    Case 2:\n      On Error Resume Next\n        IsInArray = Application.Match(stringToBeFound, Application.Index(arr, 2), 0)\n      On Error GoTo 0\n    Case Else\n      ' Err.Raise vbObjectError + 666, Description:=\"Never gets here error.\"\n  End Select\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>Here is my take on a dictionary solution:</p>\n\n<pre><code>Public Function ProductNumberDict _\n                ( _\n                           ByVal TheWorksheet As Worksheet, _\n                           ByVal Header As String, _\n                           ByVal AsGroup As Boolean, _\n                           ByVal Start As Long _\n                ) _\n        As Scripting.Dictionary\n\n  Set ProductNumberDict = New Scripting.Dictionary\n  With TheWorksheet.Rows(1).Cells(WorksheetFunction.Match(Header, TheWorksheet.Rows(1), 0)).EntireColumn\n    Dim rngData As Range\n    Set rngData = TheWorksheet.Range(.Cells(Start), .Cells(Rows.Count).End(xlUp))\n  End With\n  Dim rngCell As Range\n  For Each rngCell In rngData\n    With rngCell\n      If Not ProductNumberDict.Exists(.Value2) Then\n        ProductNumberDict.Add .Value2, IIf(AsGroup, .Offset(, -1).Value2, vbNullString)\n      End If\n    End With\n  Next rngCell\nEnd Function\n</code></pre>\n\n<p>And here is how to call the function:</p>\n\n<pre><code>Sub UpdatePSI()\n\n  Dim wkstForecast As Worksheet\n  Set wkstForecast = ActiveWorkbook.Worksheets(\"Forecast\")\n\n' ...\n\n  Dim dictProductNumbers As Scripting.Dictionary\n  Set dictProductNumbers = ProductNumberDict(wkstForecast, \"Item\", False, 7)\n  Set dictProductNumbers = ProductNumberDict(wkstForecast, \"Item\", True, 3)\n\n  Dim iRowStart As Long: iRowStart = 2\n  Dim iFirstCol As Long: iFirstCol = 5\n  With wkstForecast.Cells(iRowStart, iFirstCol).Resize(RowSize:=dictProductNumbers.Count)\n  .Offset(ColumnOffset:=1).Value = WorksheetFunction.Transpose(dictProductNumbers.Keys)\n  .Offset(ColumnOffset:=2).Value = WorksheetFunction.Transpose(dictProductNumbers.Items)\n  End With\n\n' ...\n\nEnd Sub\n</code></pre>\n\n<p>Note in particular the non-loop method used to copy the dictionary contents to the worksheet.</p>\n"}], "owner": {"reputation": 33, "user_id": 8684622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a1f9fecf48f8f5c99dd6acacad3cbe6?s=128&d=identicon&r=PG&f=1", "display_name": "PrimeTurtler", "link": "https://stackoverflow.com/users/8684622/primeturtler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 46467812, "answer_count": 4, "score": 2, "last_activity_date": 1506601448, "creation_date": 1506533251, "last_edit_date": 1506601448, "question_id": 46453875, "link": "https://stackoverflow.com/questions/46453875/vba-dynamic-array-duplicating-some-values-in-error", "title": "VBA dynamic array duplicating some values in error", "body": "<p>I want to preface this by saying I have no idea whatsoever <em>why</em> my code is doing what it is doing. I'm really hoping one of the VBA gurus on here can help. Also, this is my first post so I did my best to follow the rules, but if I did anything wrong please point it out.</p>\n\n<hr>\n\n<p>I have a sub that iterates through a column of data and creates an array. It calls a function that checks to see if the particular value is already in the array. If it is not, then the array is re-dimensioned, the value is inserted, and the process begins again, continuing until the end of the list is reached. I end up with an array totaling 41 values, but 4 of them have been duplicated twice, so there are only 37 unique values in the array.</p>\n\n<p>I can't for the life of me figure out what sets these values apart or why they are being duplicated. The total list is 700+ values long so I figured I should see other values duplicated, but I'm not.</p>\n\n<p>Here is the code for the sub that creates the array:</p>\n\n<pre><code>Sub ProductNumberArray(strWrkShtName As String, strFindColumn As String, blAsGrp As Boolean, iStart As Integer)\n    Dim i As Integer\n    Dim lastRow As Integer\n    Dim iFindColumn As Integer\n    Dim checkString As String\n\n    With wbCurrent.Worksheets(strWrkShtName)\n        iFindColumn = .UsedRange.Find(strFindColumn, .Range(\"A1\"), xlValues, xlWhole, xlByColumns).Column\n        lastRow = .Cells(Rows.Count, iFindColumn).End(xlUp).row\n        For i = iStart To lastRow\n            checkString = .Cells(i, iFindColumn).Value\n            If IsInArray(checkString, arrProductNumber) = False Then\n                If blAsGrp = False Then\n                    ReDim Preserve arrProductNumber(0 To j)\n                    arrProductNumber(j) = checkString\n                    j = j + 1\n                Else\n                    ReDim Preserve arrProductNumber(1, 0 To j)\n                    arrProductNumber(0, j) = .Cells(i, iFindColumn - 1).Value\n                    arrProductNumber(1, j) = checkString\n                    j = j + 1\n                End If\n            End If\n        Next i\n    End With\nEnd Sub\n</code></pre>\n\n<p>And here is the code that checks to see if the <code>checkString</code> value is in the array:</p>\n\n<pre><code>Function IsInArray(stringToBeFound As String, arr As Variant) As Boolean\n    Dim bDimen As Byte, i As Long\n\n    On Error Resume Next\n    If IsError(UBound(arr, 2)) Then bDimen = 1 Else bDimen = 2\n    On Error GoTo 0\n\n    Select Case bDimen\n    Case 1\n        On Error Resume Next\n        IsInArray = Application.Match(stringToBeFound, arr, 0)\n        On Error GoTo 0\n    Case 2\n        For i = 1 To UBound(arr, 2)\n            On Error Resume Next\n            IsInArray = Application.Match(stringToBeFound, Application.Index(arr, , i), 0)\n            On Error GoTo 0\n            If IsInArray = True Then Exit For\n        Next\n    End Select\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>Any help at all will be most welcome. I've been able to find answers to all my questions previously (or at least debug and see an obvious problem) but this one has stumped me. I hope someone can figure out what is going on.</p>\n\n<hr>\n\n<p><strong>[EDIT]</strong> Here is the code where the sub is being called:</p>\n\n<pre><code>Sub UpdatePSI()    \n    Set wbCurrent = Application.ActiveWorkbook\n    Set wsCurrent = wbCurrent.ActiveSheet\n\n    frmWorkbookSelect.Show\n\n    If blFrmClose = True Then 'if the user closes the selection form, the sub is exited\n        blFrmClose = False\n        Exit Sub\n    End If\n\n    Set wsSelect = wbSelect.Sheets(1)\n\n    Call ProductNumberArray(\"Forecast\", \"Item\", True, 3)\n</code></pre>\n\n<p><code>wbCurrent</code>, <code>wsCurrent</code>, and <code>blFrmClose</code> are defined in the general declarations.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 257, "user_id": 7599555, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1ad4da36973bc823d25aff12f6c1e6b6?s=128&d=identicon&r=PG&f=1", "display_name": "NickJS", "link": "https://stackoverflow.com/users/7599555/nickjs"}, "edited": false, "score": 0, "creation_date": 1506540911, "post_id": 46453601, "comment_id": 79867341, "body": "Thank you, Cyril! This actually worked pretty well. I didn&#39;t see that the variable was in the &quot; &quot; , and wasn&#39;t behaving as a variable. I had to correct my loop too. appreciate your help!      ~Nick"}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": true, "score": 0, "last_activity_date": 1506532217, "creation_date": 1506532217, "answer_id": 46453601, "question_id": 46453441, "link": "https://stackoverflow.com/questions/46453441/get-the-differences-between-2-integer-columns-into-third-column/46453601#46453601", "title": "get the differences between 2 Integer columns into third column", "body": "<p>For any input of \"i\" into the formula, you need to use \" &amp; i &amp; \" when using using a formula=\"\", such as:</p>\n\n<pre><code>\"=A\" &amp; i &amp; \"+B\" &amp; i\n</code></pre>\n\n<p>When you change to just a formula that doesn't input a formula to the cell (math happens in VBA), you can ignore the Excel formatting and \"\" blocking, such as:</p>\n\n<pre><code>= Cells(i,\"A\").Value +  Cells(i,\"B\").Value\n</code></pre>\n\n<p>Make sure to use your loop variable where appropriate, so that you would have an outcome in a loop like:</p>\n\n<pre><code>Dim i as Long\nFor i = 1 to 10\n    Cells(i,\"C\").Formula = Cells(i,\"A\").Value + Cells(i,\"B\").Value\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 0, "last_activity_date": 1506532261, "creation_date": 1506532261, "answer_id": 46453616, "question_id": 46453441, "link": "https://stackoverflow.com/questions/46453441/get-the-differences-between-2-integer-columns-into-third-column/46453616#46453616", "title": "get the differences between 2 Integer columns into third column", "body": "<p>Why looping ? Unless I misunderstood the question, something like this should do the trick:</p>\n\n<pre><code>Range(\"X3:X\"&amp; lastrow).Formula = \"=C3-D3\"\n</code></pre>\n\n<p>The formula will adjust.</p>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1506533387, "last_edit_date": 1506533387, "creation_date": 1506532982, "answer_id": 46453803, "question_id": 46453441, "link": "https://stackoverflow.com/questions/46453441/get-the-differences-between-2-integer-columns-into-third-column/46453803#46453803", "title": "get the differences between 2 Integer columns into third column", "body": "<p>vba needs to be outside the quotes and you do not need the loop:</p>\n\n<pre><code>Range(Cells(3, NextColumn), Cells(lastRow, NextColumn)).Formula = \"=\" &amp; Cells(3, firstCol).Address(0, 0) &amp; \"-\" &amp; Cells(3, lastCol).Address(0, 0)\n</code></pre>\n\n<p>No loop needed.  Excel will change the relative references as needed.</p>\n"}], "owner": {"reputation": 257, "user_id": 7599555, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1ad4da36973bc823d25aff12f6c1e6b6?s=128&d=identicon&r=PG&f=1", "display_name": "NickJS", "link": "https://stackoverflow.com/users/7599555/nickjs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 46453601, "answer_count": 3, "score": 1, "last_activity_date": 1506533387, "creation_date": 1506531663, "last_edit_date": 1531164843, "question_id": 46453441, "link": "https://stackoverflow.com/questions/46453441/get-the-differences-between-2-integer-columns-into-third-column", "title": "get the differences between 2 Integer columns into third column", "body": "<p>I have to calculate the difference between the values of 2 columns(firstCol and lastCol) and set those differences in a different column(NextColumn). The row count keeps changing, so I have to calculate the rowCount before calculating the difference. I'm trying to write a loop using Range so that the difference can be calculated but it doesn't seem to work.  </p>\n\n<pre><code>For i = 3 To lastRow\n\nRange(Cells(3, NextColumn), Cells(lastRow, NextColumn)).FormulaR1C1 = \"=Range(Cells(i, firstCol),Cells(i,firstCol)).Value - Range(Cells(i, lastCol),Cells(i,lastCol)).Value\"\n\nNext i\n</code></pre>\n\n<p>Any help would be greatly appreciated!</p>\n\n<p>Thank you\nNick</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 770, "user_id": 7086396, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLANabdeAgw/AAAAAAAAAAI/AAAAAAAAAQ4/eCyC7wOMQlU/photo.jpg?sz=128", "display_name": "Moacir", "link": "https://stackoverflow.com/users/7086396/moacir"}, "edited": false, "score": 2, "creation_date": 1506531810, "post_id": 46453371, "comment_id": 79862557, "body": "You got the Col and Rol inverted. First is Row, second is Col"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1506531815, "post_id": 46453371, "comment_id": 79862559, "body": "Firstly, <code>Cells()</code> has row as the first argument, not the second."}], "owner": {"reputation": 75, "user_id": 4704693, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/519fb5bb78e28685fc65c0e5106f8775?s=128&d=identicon&r=PG&f=1", "display_name": "kalame04", "link": "https://stackoverflow.com/users/4704693/kalame04"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "closed_date": 1506532607, "answer_count": 0, "score": 2, "last_activity_date": 1506531732, "creation_date": 1506531460, "last_edit_date": 1506531732, "question_id": 46453371, "link": "https://stackoverflow.com/questions/46453371/one-gives-me-an-error-the-other-does-not-range-clearcontents", "closed_reason": "Duplicate", "title": "One Gives Me An Error, The Other Does Not. Range.ClearContents", "body": "<p>I am trying to loop the rows and delete them if a certain cell has Zero</p>\n\n<pre><code>Range(Cells(rCol, rRow), Cells(cCol, cRow)).ClearContents \n</code></pre>\n\n<p>This gives me an error:  Cannot change part of a merged cell. There are 0 merged cells in the entire workbook.</p>\n\n<pre><code>Range(\"C11:N11\").ClearContents \n</code></pre>\n\n<p>This is the same thing as above, but the variables are replaced with integer values and works!</p>\n\n<p>HOW?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3640, "user_id": 5463636, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hwpDa.jpg?s=128&g=1", "display_name": "freginold", "link": "https://stackoverflow.com/users/5463636/freginold"}, "edited": false, "score": 0, "creation_date": 1506532305, "post_id": 46453358, "comment_id": 79862817, "body": "Are you sure <code>UserAndEid</code> is a string and not a number?"}, {"owner": {"reputation": 2212, "user_id": 6935152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f02ebbd76d4b518363a38bbbdf8e2c7f?s=128&d=identicon&r=PG&f=1", "display_name": "kaza", "link": "https://stackoverflow.com/users/6935152/kaza"}, "edited": false, "score": 1, "creation_date": 1506532475, "post_id": 46453358, "comment_id": 79862887, "body": "What is the IDE highlighting on when it throws the error?"}, {"owner": {"reputation": 79, "user_id": 4047502, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/c7YBX.jpg?s=128&g=1", "display_name": "SteelyDanFan", "link": "https://stackoverflow.com/users/4047502/steelydanfan"}, "edited": false, "score": 0, "creation_date": 1506533976, "post_id": 46453358, "comment_id": 79863637, "body": "See edits at end of question"}, {"owner": {"reputation": 3640, "user_id": 5463636, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hwpDa.jpg?s=128&g=1", "display_name": "freginold", "link": "https://stackoverflow.com/users/5463636/freginold"}, "edited": false, "score": 0, "creation_date": 1506537329, "post_id": 46453358, "comment_id": 79865410, "body": "<code>Y</code> is definitely declared as the workbook variable? Can you test that?"}, {"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "edited": false, "score": 0, "creation_date": 1506539950, "post_id": 46453358, "comment_id": 79866821, "body": "In Immediate window, run this: <code>?Y.Sheets(1).Name</code>, or add a line to your code above the error line: <code>Debug.Print Y.Sheets(1).Name</code>. Did you receive an error? Or did you receive the correct sheet name? If error, you can be sure the <code>Y</code> is the problem. Else, dont know."}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1506555935, "post_id": 46453358, "comment_id": 79872991, "body": "Check Tools &gt; References for any references marked as &quot;Missing:&quot; Any missing references can cause weird errors with built-in functions"}], "answers": [{"comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 1, "creation_date": 1506564063, "post_id": 46459589, "comment_id": 79874823, "body": "use <code>worksheets(1)</code> instead. the worksheets object does not include chart sheets"}], "tags": [], "owner": {"reputation": 79, "user_id": 4047502, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/c7YBX.jpg?s=128&g=1", "display_name": "SteelyDanFan", "link": "https://stackoverflow.com/users/4047502/steelydanfan"}, "is_accepted": true, "score": 0, "last_activity_date": 1506562273, "creation_date": 1506562273, "answer_id": 46459589, "question_id": 46453358, "link": "https://stackoverflow.com/questions/46453358/excel-error-object-doesnt-support-this-property-or-method/46459589#46459589", "title": "Excel error - object doesn&#39;t support this property or method", "body": "<p>Thanks to all for the pointers,they helped me find the issue:</p>\n\n<pre><code> Sheets(1)\n</code></pre>\n\n<p>I remembered that I had added a chart to the workbook and this was <code>Chart1</code>.\nAs <code>Sheets</code> includes Charts and Worksheets the addition of <code>Chart1</code> made <code>Sheets(1)</code> ambiguous, as it could no longer only be referring to 'Worksheets1'.</p>\n\n<p>I have to say that the error message could have helped more here - if a variable is ambiguous the error message will say so, why not in the case of objects?</p>\n"}], "owner": {"reputation": 79, "user_id": 4047502, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/c7YBX.jpg?s=128&g=1", "display_name": "SteelyDanFan", "link": "https://stackoverflow.com/users/4047502/steelydanfan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1801, "favorite_count": 0, "accepted_answer_id": 46459589, "answer_count": 1, "score": 0, "last_activity_date": 1506562273, "creation_date": 1506531393, "last_edit_date": 1506554864, "question_id": 46453358, "link": "https://stackoverflow.com/questions/46453358/excel-error-object-doesnt-support-this-property-or-method", "title": "Excel error - object doesn&#39;t support this property or method", "body": "<p>This line of code:</p>\n\n<pre><code>    Y.Sheets(1).Cells(i, 1) = Y.Sheets(1).Cells(i, 1).value &amp; \" (\" &amp; Right(UserAndEid, Len(UserAndEid) - InStr(1, UserAndEid, \"Emp\") - 7) &amp; \")\"\n</code></pre>\n\n<p>Throws this error:</p>\n\n<blockquote>\n  <p>Excel (2007) VBA Object doesn't support this property or method</p>\n</blockquote>\n\n<p><code>Y</code> is a declared workbook variable. <code>Sheets(1)</code> is the sheet I am addressing (not using the sheet caption name as it is changed by the same procedure).\n<code>UserAndEid</code> is a piece of text taken from a cell in another declared workbook.</p>\n\n<p>All I am doing is adding the peice of text to that which is already in the cell in row \"A\". I had it working yesterday, am sure I haven't changed anything, but today it will not work.</p>\n\n<p>Any ideas?</p>\n\n<p>Edit \nUserAndEid is declared as a string but will contain numbers.</p>\n\n<pre><code> Dim UserAndEid As String\n</code></pre>\n\n<p>The whole line is highlighted in yellow in the debugger.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1506531828, "post_id": 46453445, "comment_id": 79862571, "body": "I didn&#39;t check where your output was, so I just used Sheets(&quot;Output&quot;).  Make sure you have a header in Columns(1)/Columns(&quot;A&quot;), since that gives &quot;m&quot; a place to start.  Assumes Sheets(&quot;List&quot;) is where the user inputs their list of product #s, and Sheets(&quot;Products&quot;) is a master list."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 1, "creation_date": 1506532298, "post_id": 46453445, "comment_id": 79862813, "body": "@sc1324 So in this case, each instance of <i>Sheets(&quot;Output&quot;)</i> would become <i>Sheets(&quot;Monthly Template&quot;)</i>, yes?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1506532639, "post_id": 46453445, "comment_id": 79862983, "body": "@sc1324 Right now, this code would be stand-alone with the assumption that each sheet is in the same workbook.  You would want this in the Workbook that contains the list that people are filling in (with Sheets(&quot;List&quot;), most likely tied to a &quot;GO&quot; button, where this code would run.  As it appears you are using different workbooks, you will need to make adjustments with the objects (object being Workbook.Sheet.Range) that is within this code."}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1506538446, "post_id": 46453445, "comment_id": 79866007, "body": "I changed my question so hopefully this helps clarifies what I need to achieve @Cyril"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 1, "creation_date": 1506542324, "post_id": 46453445, "comment_id": 79868098, "body": "@sc1324 To be fair, your initial question was answered; it would be more appropriate to apply this, then ask another question about separating, particularly because that is a bit more work.  Getting each unique value to its own Sheet, then running a loop for each sheet, would be the most straightforward approach; you would then be able to move a sheet to a new workbook."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1506542860, "post_id": 46453445, "comment_id": 79868366, "body": "@sc1324 Look at what I&#39;ve added; that should be a place to start.  Look at <a href=\"https://stackoverflow.com/questions/20246465/how-to-copy-only-a-single-worksheet-to-another-workbook-using-vba\" title=\"how to copy only a single worksheet to another workbook using vba\">stackoverflow.com/questions/20246465/&hellip;</a> for saving a single sheet to a new workbook."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1506545964, "post_id": 46453445, "comment_id": 79869913, "body": "@sc1324 Ahh, my apologies with that presumption.  I hope that getting the items to individual sheets is a better solution, as that is a much easier outcome to save those sheets, per the linked post.  Good luck and let me know the outcome!"}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 4, "last_activity_date": 1506542832, "last_edit_date": 1506542832, "creation_date": 1506531671, "answer_id": 46453445, "question_id": 46453295, "link": "https://stackoverflow.com/questions/46453295/split-data-into-multiple-workbooks-based-on-cell-value-in-excel-using-vba/46453445#46453445", "title": "Split data into multiple workbooks based on cell value in Excel using vba", "body": "<p>Try two loops for this, making sure you sort by the product in the main list to make this a little quicker.  </p>\n\n<pre><code>Dim i as Long, j as Long, k as Long, l as Long, m as Long\nWith Sheets(\"List\")\n    j = .Cells( .Rows.Count, 1).End(xlUp).Row\nEnd With\nWith Sheets(\"Products\")\n    l = .Cells( .Rows.Count, 1).End(xlUp).Row\nEnd With\nFor i = 2 to j\n    For k = 2 to l\n        If Sheets(\"List\").Cells(i,1).Value = Sheets(\"Products\").Cells(k,1).Value Then\n            With Sheets(\"Output\")\n                m = .Cells( .Rows.Count, 1).End(xlUp).Row\n            End With\n            Sheets(\"Output\").Rows(m+1).Value = Sheets(\"Products\").Rows(k).Value\n        End If\n    Next k\nNext i\n</code></pre>\n\n<hr>\n\n<p><strong>Edit</strong></p>\n\n<p>Will try to piecemeal something to give at least a lead to splitting into different sheets, rather than having one output sheet (this will not be tested, just free-coding):</p>\n\n<pre><code>Dim i as Long, j as Long, k as Long, l as Long, m as Long, n as String\nWith Sheets(\"List\")\n    j = .Cells( .Rows.Count, 1).End(xlUp).Row\nEnd With\nWith Sheets(\"Products\")\n    l = .Cells( .Rows.Count, 1).End(xlUp).Row\nEnd With\nFor i = 2 to j\n    n = Sheets(\"List\").Cells(i,1).Value\n    Sheets.Add(After:=Sheets(Sheets.Count)).Name = n\n    Sheets(n).Cells(1,1).Value = n\n    Sheets(n).Rows(2).Value = Sheets(\"Products\").Rows(1).Value\n    For k = 2 to l\n        With Sheets(n)\n            If .Cells(1,1).Value = Sheets(\"Products\").Cells(k,1).Value Then\n            m = .Cells( .Rows.Count, 1).End(xlUp).Row\n            .Rows(m+1).Value = Sheets(\"Products\").Rows(k).Value\n        End If\n    Next k\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1507138275, "post_id": 46539197, "comment_id": 80095249, "body": "hi, sorry it took me a while to get back on this task but i have some questions. i posted some pictures so it can help you visualize my results so i am assuming I need to modify my original codes with Cyril&#39;s and yours. Questions 1) the codes in List is already the parent code (4 digits) so i dont know why we need to do it in Products and in List. So the List has the products that I need to generate reports"}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1507138368, "post_id": 46539197, "comment_id": 80095297, "body": "2) Your codes do give me separate reports, however, when I open the 32 reports vba generated, it only gave me one product, so something is off. I updated Master to Monthly Template since my codes already did the importing new data into Monthly Template already."}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1507138497, "post_id": 46539197, "comment_id": 80095369, "body": "The last one is what my desire result should be. I can reformat but the issue right now is it only populating one product and secondly, we don&#39;t really need to find parent code (left(cell,4) since the list will be given."}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1507145682, "post_id": 46539197, "comment_id": 80099260, "body": "I incorporated my original codes with Cyril&#39;s codes and let me try to incorporate yours. I still don&#39;t quite understand with the 2 with statements where you try to add /dict(Key).Add cell.Value/"}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1507147361, "post_id": 46539197, "comment_id": 80100116, "body": "Ok, now i m having trouble transferring data...I updated the codes based on your input, can you help? It transferred all the product data but not that specific product."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 7, "last_activity_date": 1507147360, "last_edit_date": 1507147360, "creation_date": 1507015417, "answer_id": 46539197, "question_id": 46453295, "link": "https://stackoverflow.com/questions/46453295/split-data-into-multiple-workbooks-based-on-cell-value-in-excel-using-vba/46539197#46539197", "title": "Split data into multiple workbooks based on cell value in Excel using vba", "body": "<p>I seen no reason why to save copies of <strong>Monthly Template.xlsm</strong>.  The OP's code simply creates a list on a worksheet and saves it to file.  I might be some formatting missing that would normally get saved over from the Master File.</p>\n\n<p><code>getMonthlyFileName(DateOf, Product)</code> - creates a file path (Root Path\\Year of Date\\Month of Date\\Product - Prodcut mmm.dd.yyyy.xlsx.  In this way, the Product files can be stored in an easy to lookup structure.</p>\n\n<p><a href=\"https://i.stack.imgur.com/37fb9.jpg\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/37fb9.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub CreateMonthlyReports()\n    Dim cell As Range\n    Dim dict As Object, vKey As Variant\n    Dim Key As String\n    Dim SheetsInNewWorkbook As Long\n    Dim DateOf As Date\n\n    DateOf = DateSerial(Year(Date), Month(Date), 1)\n\n    With Application\n        .ScreenUpdating = False\n        SheetsInNewWorkbook = .SheetsInNewWorkbook\n        .SheetsInNewWorkbook = 1\n    End With\n\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n    With ThisWorkbook.Worksheets(\"List\")\n        For Each cell In .Range(\"A1\", .Range(\"A\" &amp; .Rows.Count).End(xlUp))\n            Key = Left(cell.Value, 4)\n            'Store an ArrayList in the Scripting.Dictionary that can be retrieved using the Product Key\n            If Not dict.exists(Key) Then dict.Add Key, CreateObject(\"System.Collections.ArrayList\")\n        Next\n    End With\n\n    With Workbooks(\"Master.xlsx\").Worksheets(\"Products\")\n        For Each cell In .Range(\"H2\", .Range(\"H\" &amp; .Rows.Count).End(xlUp))\n            Key = Left(cell.Value, 4)\n            'Add the Products to the ArrayList in the Scripting.Dictionary that is associated with the Product Key\n            If dict.exists(Key) Then dict(Key).Add cell.Value\n        Next\n    End With\n\n    For Each vKey In dict\n        If dict(vKey).Count &gt; 0 Then\n            With Workbooks.Add\n                With .Worksheets(1)\n                    .Name = \"Products\"\n                    .Range(\"A1\").Value = \"Products\"\n                    .Range(\"A2\").Resize(dict(vKey).Count).Value = Application.Transpose(dict(vKey).ToArray)\n                End With\n                .SaveAs FileName:=getMonthlyFileName(DateOf, CStr(vKey)), FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\n                .Close SaveChanges:=False\n            End With\n        End If\n    Next\n\n    With Application\n        .ScreenUpdating = True\n        .SheetsInNewWorkbook = SheetsInNewWorkbook\n    End With\n\nEnd Sub\n\nFunction getMonthlyFileName(DateOf As Date, Product As String) As String\n    Dim path As String\n\n    path = ThisWorkbook.path &amp; \"\\Product Reports\\\"\n\n    If Len(Dir(path, vbDirectory)) = 0 Then MkDir path\n\n    path = path &amp; Format(DateOf, \"yyyy\") &amp; \"\\\"\n\n    If Len(Dir(path, vbDirectory)) = 0 Then MkDir path\n\n    path = path &amp; Format(DateOf, \"mmm\") &amp; \"\\\"\n\n    If Len(Dir(path, vbDirectory)) = 0 Then MkDir path\n\n    getMonthlyFileName = path &amp; \"Product - \" &amp; Product &amp; Format(DateOf, \" mmm.dd.yyyy\") &amp; \".xlsx\"\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 101, "user_id": 8545195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34aa5865da7622d58df39ba9487c98fd?s=128&d=identicon&r=PG&f=1", "display_name": "Luan Yi", "link": "https://stackoverflow.com/users/8545195/luan-yi"}, "is_accepted": false, "score": 1, "last_activity_date": 1507578054, "last_edit_date": 1507578054, "creation_date": 1507577691, "answer_id": 46653774, "question_id": 46453295, "link": "https://stackoverflow.com/questions/46453295/split-data-into-multiple-workbooks-based-on-cell-value-in-excel-using-vba/46653774#46653774", "title": "Split data into multiple workbooks based on cell value in Excel using vba", "body": "<p>I don't know why some people doing VBA thinks declaring all the variables with weird names before a thousand lines of code is a good idea.........</p>\n\n<p>Anyways..back to the question, I believe what you are trying to achieve is:</p>\n\n<p>1) Specify a list whilst the code iterates through the list and filters the data based on the listed items.\n2) Creates a workbook where the filtered the data is copied over.\n3) saving the workbook to somewhere you'll specify, with a specific name.</p>\n\n<p>So naturally, your programme access point should be the one that iterates through the specified list, which should be your main function.</p>\n\n<p>Then inside main function you'll have a Sub that deals with whatever the product ID is, and then filters on your product ID, then copies the data into a newly created workbook.</p>\n\n<p>Last step would be naming the new workbook and saving it close it.</p>\n\n<p>So here is some code skeleton that hopefully will help you with creating the monthly reports. You'll have to write yourself how you want to copy the data from your master workbook to the destination workbook (it should be simple enough, just filter the source list and copy the results to the destination workbook, no dictionary nor arraylist is needed).</p>\n\n<pre><code>Sub main()\n    Dim rngIdx As Range\n    Set rngIdx = ThisWorkbook.Sheets(\"where your list is\").Range(\"A1\")\n\n    With Application\n        .DisplayAlerts = False\n        .ScreenUpdating = False\n    End With\n\n    While (rngIdx.Value &lt;&gt; \"\")\n        Call create_report(rngIdx.Value)\n        Set rngIdx = rngIdx.Offset(1, 0)\n    Wend\n\n    With Application\n        .DisplayAlerts = True\n        .ScreenUpdating = True\n    End With\nEnd Sub\n\nSub create_report(ByVal product_ID As String)\n    Dim dest_wbk As Workbook\n    Set dest_wbk = Workbooks.Add\n\n    Call do_whatever(ThisWorkbook, dest_wbk, product_ID)\n\n    dest_wbk.SaveAs getMonthlyFileName(some_date, product_ID)\n    dest_wbk.Close\n\nEnd Sub\n\nSub do_whatever(source_wbk As Workbook, dest_wbk As Workbook, ByVal product_ID As String)\n    ' this is the code where you copy from your master data to the destination workbook\n    ' modify sheet names, formatting.......etc.\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2697, "favorite_count": 1, "accepted_answer_id": 46539197, "answer_count": 3, "score": 6, "last_activity_date": 1507578054, "creation_date": 1506531157, "last_edit_date": 1531164843, "question_id": 46453295, "link": "https://stackoverflow.com/questions/46453295/split-data-into-multiple-workbooks-based-on-cell-value-in-excel-using-vba", "title": "Split data into multiple workbooks based on cell value in Excel using vba", "body": "<p>Each month I get our sales report and it contains quantities of goods we sold along with product details, and I created a template using vba where user can specify a product and it can create a excel report for them. </p>\n\n<p>However, I would like to expand/modify so if I have multiple excel reports instead of just one report. I would like excel to separate however many product codes I input or listed. </p>\n\n<p>Now, I added a tab called list in my template which I can list the # of product codes (the 4 digit number, in column A) where vba should read from but I need help on modifying the codes so instead of asking the user, it reads the list instead. Secondly, since master file contains all of the products and I maybe just need 20 or 30 of them, I will need the vba codes to be flexible as possible. </p>\n\n<p>The way i set it up, I am basically updating/copying new info from Master file into Monthly Template and re-saving Monthly Template as product codes product as of 9.1.2017 file.</p>\n\n<pre><code>Sub monthly()\n\n\nDim x1 As Workbook, y1 As Workbook\nDim ws1, ws2 As Worksheet\nDim LR3, LR5 As Long\nDim ws3 As Worksheet\nDim Rng3, Rng4 As Range\nDim x3 As Long\n\nSet x1 = Workbooks(\"Master.xlsx\")\nSet y1 = Workbooks(\"Monthly Template.xlsm\")\n\nSet ws1 = x1.Sheets(\"Products\")\nSet ws2 = y1.Sheets(\"Products\")\nSet ws3 = y1.Sheets(\"List\")\n\nws2.Range(\"A3:AA30000\").ClearContents\nws1.Cells.Copy ws2.Cells\n\nx1.Close True\n\nLR5 = ws3.Cells(Rows.Count, \"A\").End(xlUp).Row\n\nWith y1.Sheets(\"List\")\nRange(\"A1:A32\").Sort key1:=Range(\"A1\"), Order1:=xlAscending\nEnd With\n\n\n\n\n\nLR3 = ws2.Cells(Rows.Count, \"A\").End(xlUp).Row\n\n\nSet Rng3 = ws2.Range(\"AC3:AC\" &amp; LR3)\n\nSet Rng4 = ws3.Range(\"A1:A\" &amp; LR5)\n\nFor n = 3 To LR3\nws2.Cells(n, 29).FormulaR1C1 = \"=LEFT(RC[-21], 4)\"\nNext n\n\n\n\nWith y1.Sheets(\"List\")\n    j = .Cells(.Rows.Count, 1).End(xlUp).Row\nEnd With\nWith ws2\n    l = .Cells(.Rows.Count, 1).End(xlUp).Row\nEnd With\nFor i = 1 To j\n    For k = 3 To l\n        If Sheets(\"List\").Cells(i, 1).Value = Sheets(\"Products\").Cells(k, 29).Value Then\n            With Sheets(\"Output\")\n                m = .Cells(.Rows.Count, 1).End(xlUp).Row\n            End With\n            Sheets(\"Output\").Rows(m + 1).Value = Sheets(\"Products\").Rows(k).Value\n        End If\n    Next k\nNext i\n\nSheets(\"Output\").Columns(\"AC\").ClearContents\n\n\n   Dim cell As Range\n    Dim dict As Object, vKey As Variant\n    Dim Key As String\n    Dim SheetsInNewWorkbook As Long\n    Dim DateOf As Date\n\n\n    DateOf = DateSerial(Year(Date), Month(Date), 1)\n\n    With Application\n        .ScreenUpdating = False\n        SheetsInNewWorkbook = .SheetsInNewWorkbook\n        .SheetsInNewWorkbook = 1\n    End With\n\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n    With ThisWorkbook.Worksheets(\"List\")\n        For Each cell In .Range(\"A1\", .Range(\"A\" &amp; .Rows.Count).End(xlUp))\n            Key = Left(cell.Value, 4)\n            'Store an ArrayList in the Scripting.Dictionary that can be retrieved using the Product Key\n            If Not dict.exists(Key) Then dict.Add Key, CreateObject(\"System.Collections.ArrayList\")\n        Next\n    End With\n\n    With Workbooks(\"Monthly Template.xlsm\").Worksheets(\"Output\")\n        For Each cell In .Range(\"H2\", .Range(\"A\" &amp; .Rows.Count).End(xlUp))\n            Key = Left(cell.Value, 4)\n            'Add the Products to the ArrayList in the Scripting.Dictionary that is associated with the Product Key\n            If dict.exists(Key) Then dict(Key).Add cell.Value\n        Next\n    End With\n\n    For Each vKey In dict\n        If dict(vKey).Count &gt; 0 Then\n            With Workbooks.Add\n                With .Worksheets(1)\n                    .Name = \"Products\"\n                   ' .Range(\"A1\").Value = \"Products\"\n\n                    Workbooks(\"Monthly Template.xlsm\").Worksheets(\"Output\").Cells.Copy Worksheets(1).Cells\n\n                      For Z = 1 To LR5\n                      For x3 = Rng3.Rows.Count To 1 Step -1\n                        If InStr(1, Rng3.Cells(x3, 1).Text, Workbooks(\"Monthly Template.xlsm\").Worksheets(\"List\").Cells(Z, 1).Text) = 0 Then\n                            Rng3.Cells(x3, 1).EntireRow.Delete\n                        End If\n                        Next x3\n                        Next Z\n\n\n                    '.Range(\"A2\").Resize(dict(vKey).Count).Value = Application.Transpose(dict(vKey).ToArray)\n                End With\n                .SaveAs Filename:=getMonthlyFileName(DateOf, CStr(vKey)), FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\n                .Close SaveChanges:=False\n            End With\n        End If\n    Next\n\n    With Application\n        .ScreenUpdating = True\n        .SheetsInNewWorkbook = SheetsInNewWorkbook\n    End With\n\nEnd Sub\n\nFunction getMonthlyFileName(DateOf As Date, Product As String) As String\n    Dim path As String\n\n    path = ThisWorkbook.path &amp; \"\\Product Reports\\\"\n\n    If Len(Dir(path, vbDirectory)) = 0 Then MkDir path\n\n    path = path &amp; Format(DateOf, \"yyyy\") &amp; \"\\\"\n\n    If Len(Dir(path, vbDirectory)) = 0 Then MkDir path\n\n    path = path &amp; Format(DateOf, \"mmm\") &amp; \"\\\"\n\n    If Len(Dir(path, vbDirectory)) = 0 Then MkDir path\n\n    getMonthlyFileName = path &amp; \"Product - \" &amp; Product &amp; Format(DateOf, \" mmm.dd.yyyy\") &amp; \".xlsx\"\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1506530930, "post_id": 46453212, "comment_id": 79862084, "body": "How is the macro being interrupted?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1506531708, "post_id": 46453212, "comment_id": 79862507, "body": "If you are the cause of the interruption, you will just have to turn it back on yourself manually. There is no &quot;Interrupt&quot; Event to put code in."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1506532696, "post_id": 46453212, "comment_id": 79863019, "body": "Also consider <i>why</i> are you interrupting your code? Perhaps you can break it up into multiple parts so you don&#39;t need to, or add a way to handle that reason within the code?  This may be an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY Problem</a>."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1506534080, "post_id": 46453212, "comment_id": 79863695, "body": "Look at <code>Application.EnableCancelKey</code> <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/application-enablecancelkey-property-excel\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/vba/excel-vba/articles/&hellip;</a>"}, {"owner": {"reputation": 5449, "user_id": 1961728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bqpz6.png?s=128&g=1", "display_name": "robinCTS", "link": "https://stackoverflow.com/users/1961728/robincts"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1506534220, "post_id": 46453212, "comment_id": 79863768, "body": "@TimWilliams Just beat you:)"}, {"owner": {"reputation": 5449, "user_id": 1961728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bqpz6.png?s=128&g=1", "display_name": "robinCTS", "link": "https://stackoverflow.com/users/1961728/robincts"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1506534280, "post_id": 46453212, "comment_id": 79863792, "body": "@braX Actually there is, sort of."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 5449, "user_id": 1961728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bqpz6.png?s=128&g=1", "display_name": "robinCTS", "link": "https://stackoverflow.com/users/1961728/robincts"}, "edited": false, "score": 0, "creation_date": 1506534508, "post_id": 46453212, "comment_id": 79863907, "body": "@robinCTS - nice... learn new things every day."}, {"owner": {"reputation": 1, "user_id": 8467972, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156417341453906/picture?type=large", "display_name": "Phil Lancaster", "link": "https://stackoverflow.com/users/8467972/phil-lancaster"}, "edited": false, "score": 0, "creation_date": 1506584372, "post_id": 46453212, "comment_id": 79881773, "body": "I&#39;m interrupting (usually by mashing esc) because the code takes around 30m to run sometimes and as it&#39;s not finished, sometimes I need to interrupt it to make changes to the sheet or the code. I&#39;m just looking for a way to make sure everything gets returned to normal automatically."}], "answers": [{"tags": [], "owner": {"reputation": 5449, "user_id": 1961728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bqpz6.png?s=128&g=1", "display_name": "robinCTS", "link": "https://stackoverflow.com/users/1961728/robincts"}, "is_accepted": false, "score": 0, "last_activity_date": 1506534166, "creation_date": 1506534166, "answer_id": 46454103, "question_id": 46453212, "link": "https://stackoverflow.com/questions/46453212/vba-run-code-when-macro-interrupted/46454103#46454103", "title": "VBA - run code when macro interrupted", "body": "<p>If you really <em>really</em> need to do this, then this is how:</p>\n\n<pre><code>Sub YourSub()\n  On Error GoTo ErrHandler:\n  Application.EnableCancelKey = xlErrorHandler\n\n  ' You code goes here\n\nErrHandler:\n  With Err\n    If .Number &lt;&gt; 18 Then\n      .Raise .Number, .Source, .Description, .HelpFile, .HelpContext\n    End If\n  End With\n  Application.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n\n<p>However, there are better ways to achieve whatever it is you are trying to achieve. For example, polling for user input.</p>\n"}], "owner": {"reputation": 1, "user_id": 8467972, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156417341453906/picture?type=large", "display_name": "Phil Lancaster", "link": "https://stackoverflow.com/users/8467972/phil-lancaster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 336, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1506534166, "creation_date": 1506530818, "last_edit_date": 1506533165, "question_id": 46453212, "link": "https://stackoverflow.com/questions/46453212/vba-run-code-when-macro-interrupted", "title": "VBA - run code when macro interrupted", "body": "<p>I have to change several defaults which my macro fixes at the end, but if I need to interrupt the macro, the settings will not be reset.\nSo if the code contains</p>\n\n<pre><code>Application.Calculation = xlCalculationManual\n</code></pre>\n\n<p>then I would have</p>\n\n<pre><code>Private Sub IfInterrupted()\n    Application.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n\n<p>Is there any way to do this?</p>\n"}, {"tags": ["python", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1506531627, "post_id": 46452970, "comment_id": 79862456, "body": "You <b>DEFINITELY</b> don&#39;t have that code in VBA - that If-Else syntax isn&#39;t legal. Also, find a way to avoid <code>GoTo</code> jumps. 99.99999% of the time they&#39;re avoidable."}], "answers": [{"comments": [{"owner": {"reputation": 331, "user_id": 8684461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/994a4d0b1fd6b485eff841dd69d91d6b?s=128&d=identicon&r=PG&f=1", "display_name": "JPWilson", "link": "https://stackoverflow.com/users/8684461/jpwilson"}, "edited": false, "score": 0, "creation_date": 1506550607, "post_id": 46453170, "comment_id": 79871624, "body": "For the validity check, how can I change it so that instead of it cancelling the script it loops until the user has put in a valid input. For example for loan amount i did this. I cant seem to format the comment reply so the code is messed up sorry but im sure you get what im going after.   .loanAmt = 0 while True:     try:         LoanAmt = int(input (&#39;What Is Your Desired Loan Amount? &#39;))     except ValueError:      print(&quot;Not A Valid Choice!&quot;)      continue     else:      print(&#39;Your Desired Loan Amount is &#163; &#39; + str(LoanAmt))      break"}], "tags": [], "owner": {"reputation": 23864, "user_id": 146073, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2c69ccb9eb83c7ef2ba155a850df68a9?s=128&d=identicon&r=PG", "display_name": "holdenweb", "link": "https://stackoverflow.com/users/146073/holdenweb"}, "is_accepted": true, "score": 0, "last_activity_date": 1506594929, "last_edit_date": 1506594929, "creation_date": 1506530700, "answer_id": 46453170, "question_id": 46452970, "link": "https://stackoverflow.com/questions/46452970/gathering-numerical-data-from-a-string-input/46453170#46453170", "title": "Gathering numerical data from a string input", "body": "<p>In Python this would most likely be computed using a dict, a hash-based data structure that allows lookup of (fairly) arbitrary keys. Such a dict can be created as follows</p>\n\n<pre><code>rate_dict = {\"AAA\": 0.01, \"A\": 0.03, \"BBB\", 0.05, \"BB\", 0.06, \"CCC\": 0.08, \"DDD\": 0.1}\n</code></pre>\n\n<p>You would then set the interest rate (using Python's standard naming conventions) using</p>\n\n<pre><code>int_rate = rate_dict[credit_rate]\n</code></pre>\n\n<p>If <code>credit_rate</code> is set from user input you may need to check whether it's valid or not. You can do that with</p>\n\n<pre><code>if credit_rate in rate_dict:\n    ...\n</code></pre>\n\n<p>If you want to ask the user for a valid input, start with an invalid value and iterate until the user has provided a valid one. A simple way to do this would be</p>\n\n<pre><code>credit_rate = '*'\nwhile credit_rate not in rate_dict:\n    credit_rate = input(\"Credit rating: \")\n</code></pre>\n\n<p>If you wanted to provide error messages then an infinite loop with a <code>break</code> on an acceptable value might be more readable.</p>\n\n<pre><code>while True:\n    credit_rate = input(\"Credit rating: \")\n    if credit_rate in rate_table:\n        int_rate = rate_dict[credit_rate]\n        break\n    print(credit_rate, \"is not a known credit rating\"\n</code></pre>\n\n<p>Readers using Python 2 should take care to use the <code>raw_input</code> built-in, since in that older version <code>input</code> tries to evaluate the input as a Python expression.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 4597131, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UiueCl0ACcI/AAAAAAAAAAI/AAAAAAAADTk/5dobO9hf2rA/photo.jpg?sz=128", "display_name": "Rahul Deshmukh", "link": "https://stackoverflow.com/users/4597131/rahul-deshmukh"}, "is_accepted": false, "score": 0, "last_activity_date": 1506532256, "creation_date": 1506532256, "answer_id": 46453613, "question_id": 46452970, "link": "https://stackoverflow.com/questions/46452970/gathering-numerical-data-from-a-string-input/46453613#46453613", "title": "Gathering numerical data from a string input", "body": "<p>Python also provides a default dictionary that returns a default value if key does not exist in the dictionary. </p>\n\n<pre><code>from collections import defaultdict\nrates = defaultdict(lambda: None, { \n                     \"AAA\" : 0.01, \"A\" : 0.03,\n                     \"BBB\" : 0.05, \"BB\" : 0.06, \n                     \"CCC\" : 0.08, \"DDD\" : 0.1  \n                      })\n</code></pre>\n\n<p>So</p>\n\n<pre><code>rate = rates['AAA'] #rate = 0.01\n</code></pre>\n\n<p>and</p>\n\n<pre><code>rate = rates['D']) #rate = None\n</code></pre>\n"}], "owner": {"reputation": 331, "user_id": 8684461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/994a4d0b1fd6b485eff841dd69d91d6b?s=128&d=identicon&r=PG&f=1", "display_name": "JPWilson", "link": "https://stackoverflow.com/users/8684461/jpwilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 46453170, "answer_count": 2, "score": -1, "last_activity_date": 1506594929, "creation_date": 1506529969, "last_edit_date": 1506531549, "question_id": 46452970, "link": "https://stackoverflow.com/questions/46452970/gathering-numerical-data-from-a-string-input", "title": "Gathering numerical data from a string input", "body": "<p>I would like to get user input for their credit rating e.g AAA, A, BBB etc and then assign an interest rate to this. For example, if the user has a good credit rating e.g AAA I would charge an interest rate of 1 %.</p>\n\n<p>I have inserted the code I used in VBA for this specific function so you have an Idea of what I want / How it works although I have deleted various lines as I have only added the code to give a better visual of what I am trying to do.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>creditRate = InputBox(\"Please enter credit rating:\")\n\nIf creditRate = \"AAA\" Then GoTo intcalc Else\nIf creditRate = \"A\" Then GoTo intcalc Else\nIf creditRate = \"BBB\" Then GoTo intcalc Else\nIf creditRate = \"BB\" Then GoTo intcalc Else\nIf creditRate = \"CCC\" Then GoTo intcalc Else\nIf creditRate = \"DDD\" Then GoTo intcalc Else\n\nIf creditRate = \"AAA\" Then intRate = 0.01 Else\nIf creditRate = \"A\" Then intRate = 0.03 Else\nIf creditRate = \"BBB\" Then intRate = 0.05 Else\nIf creditRate = \"BB\" Then intRate = 0.06 Else\nIf creditRate = \"CCC\" Then intRate = 0.08 Else\nIf creditRate = \"DDD\" Then intRate = 0.1 Else\n</code></pre>\n"}, {"tags": ["vba", "excel", "sorting", "excel-2013"], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 8308768, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ecd14388deeb33874cb5d1b7fdcc8db1?s=128&d=identicon&r=PG&f=1", "display_name": "rdplanglois", "link": "https://stackoverflow.com/users/8308768/rdplanglois"}, "edited": false, "score": 0, "creation_date": 1506534819, "post_id": 46453137, "comment_id": 79864048, "body": "I&#39;m afraid that didn&#39;t work... I got the following error: <code>Run-time error &#39;1004&#39;: The sort reference is not valid. Make sure that it&#39;s within the data you want to sort, and the first Sort By box isn&#39;t the same or blank.</code>"}, {"owner": {"reputation": 5449, "user_id": 1961728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bqpz6.png?s=128&g=1", "display_name": "robinCTS", "link": "https://stackoverflow.com/users/1961728/robincts"}, "edited": false, "score": 0, "creation_date": 1506542962, "post_id": 46453137, "comment_id": 79868418, "body": "It&#39;s not &quot;proper syntax&quot;. It&#39;s a different sort method based on the <code>Worksheet.Sort</code> property instead of the <code>Range.Sort</code> method."}, {"owner": {"reputation": 211, "user_id": 8651782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d71f253fb066108065e8b7ff5a747f?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Fenner", "link": "https://stackoverflow.com/users/8651782/joshua-fenner"}, "reply_to_user": {"reputation": 5449, "user_id": 1961728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bqpz6.png?s=128&g=1", "display_name": "robinCTS", "link": "https://stackoverflow.com/users/1961728/robincts"}, "edited": false, "score": 0, "creation_date": 1506553504, "post_id": 46453137, "comment_id": 79872441, "body": "@robinCTS roger that one. New to the site and lingo.  Just know how to do some stuff."}, {"owner": {"reputation": 5449, "user_id": 1961728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bqpz6.png?s=128&g=1", "display_name": "robinCTS", "link": "https://stackoverflow.com/users/1961728/robincts"}, "edited": false, "score": 0, "creation_date": 1506570310, "post_id": 46453137, "comment_id": 79876212, "body": "@JoshuaFenner Sorry about that. I just thought you might be implying the OP was using the sort incorrectly and thought it needed correction. Looks like you weren&#39;t, so everything&#39;s good."}], "tags": [], "owner": {"reputation": 211, "user_id": 8651782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d71f253fb066108065e8b7ff5a747f?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Fenner", "link": "https://stackoverflow.com/users/8651782/joshua-fenner"}, "is_accepted": false, "score": 1, "last_activity_date": 1506530568, "creation_date": 1506530568, "answer_id": 46453137, "question_id": 46452723, "link": "https://stackoverflow.com/questions/46452723/excel-2013-vba-use-successive-columns-to-sort-large-range/46453137#46453137", "title": "Excel 2013 VBA use successive columns to sort large range", "body": "<p>I have modified your code to use proper syntax.  Note the difference.</p>\n\n<pre><code>Sub RefreshAll()\n    Workbooks(ThisWorkbook.Name).RefreshAll\n\n    With Worksheets(\"Detailed Budget Report\").Sort\n        .SortFields.Clear\n        .SortFields.Add Key:=Range(\"Sort_1st\"), Order:=xlAscending\n        .SortFields.Add Key:=Range(\"Sort_2nd\"), Order:=xlAscending\n        .SetRange Range(\"RC_number\")\n        .Header = xlYes\n        .Apply\n    End With\nEnd Sub\n</code></pre>\n\n<p>Reminder: <code>.SortFields.Clear</code> may seem redundant but if you are applying multiple different sorts to the same sheet it can save some headache. </p>\n"}, {"comments": [{"owner": {"reputation": 77, "user_id": 8308768, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ecd14388deeb33874cb5d1b7fdcc8db1?s=128&d=identicon&r=PG&f=1", "display_name": "rdplanglois", "link": "https://stackoverflow.com/users/8308768/rdplanglois"}, "edited": false, "score": 0, "creation_date": 1506544735, "post_id": 46456341, "comment_id": 79869301, "body": "Hello Robin. Thank-you for your time. Version _RS throwes the error, <code>Run-time error &#39;91&#39;: Object variable or With block not set</code>, on the <code>With .AutoFilter.Sort</code> line.  Version _Q1 runs, but does not sort the second column, only the first (my original problem).  Version _A1 no longer throws an error (thank-you for that), but, as with _Q1, still only sorts the first argument.  I&#39;m strating to think I&#39;m missing something very basic...."}, {"owner": {"reputation": 5449, "user_id": 1961728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bqpz6.png?s=128&g=1", "display_name": "robinCTS", "link": "https://stackoverflow.com/users/1961728/robincts"}, "reply_to_user": {"reputation": 77, "user_id": 8308768, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ecd14388deeb33874cb5d1b7fdcc8db1?s=128&d=identicon&r=PG&f=1", "display_name": "rdplanglois", "link": "https://stackoverflow.com/users/8308768/rdplanglois"}, "edited": false, "score": 0, "creation_date": 1506545272, "post_id": 46456341, "comment_id": 79869601, "body": "@rdplanglois I highly doubt that different versions of Excel would behave differently for sorting. I suspect you have a corrupted workbook, Excel or OS. Try starting Excel in safe mode, creating a brand new workbook and copying the examples here into it. Then setup some test data manually. The next options, if this still fails, are to try another computer/office installation or re-installing Office/Excel on your computer."}, {"owner": {"reputation": 77, "user_id": 8308768, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ecd14388deeb33874cb5d1b7fdcc8db1?s=128&d=identicon&r=PG&f=1", "display_name": "rdplanglois", "link": "https://stackoverflow.com/users/8308768/rdplanglois"}, "edited": false, "score": 0, "creation_date": 1506545415, "post_id": 46456341, "comment_id": 79869666, "body": "Thanks Robin. My work-day is done, so, I&#39;ll try this with some test data at home. Is it possible that, being an office computer, some portion of the VBA is disabled by the security settings, but that the disablement isn&#39;t throwing an error?"}, {"owner": {"reputation": 5449, "user_id": 1961728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bqpz6.png?s=128&g=1", "display_name": "robinCTS", "link": "https://stackoverflow.com/users/1961728/robincts"}, "reply_to_user": {"reputation": 77, "user_id": 8308768, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ecd14388deeb33874cb5d1b7fdcc8db1?s=128&d=identicon&r=PG&f=1", "display_name": "rdplanglois", "link": "https://stackoverflow.com/users/8308768/rdplanglois"}, "edited": false, "score": 0, "creation_date": 1506545630, "post_id": 46456341, "comment_id": 79869775, "body": "@rdplanglois That seems extremely unlikely. The only thing I can think of is a corruption issue. Unless the workbook is protected?"}, {"owner": {"reputation": 77, "user_id": 8308768, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ecd14388deeb33874cb5d1b7fdcc8db1?s=128&d=identicon&r=PG&f=1", "display_name": "rdplanglois", "link": "https://stackoverflow.com/users/8308768/rdplanglois"}, "edited": false, "score": 0, "creation_date": 1506551294, "post_id": 46456341, "comment_id": 79871871, "body": "I made the workbook myself, so, I know it&#39;s not protected. I just got home and made one from scratch, using my original code. It only sorted the first criteria. I tried all your edited ones, and all of them sort only the first criteria too. Then I tried splitting out the the two criteria into separate <code>With</code> statements (shoulda thought of that at work), and it <i>finally</i> sorted the second criteria as well as the first. I&#39;ve <b>no</b> idea why splitting the sort criteria into separate arguments seems to be necessary, and I feel like there ought to be a more elegant solution, but, there we have it."}, {"owner": {"reputation": 5449, "user_id": 1961728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bqpz6.png?s=128&g=1", "display_name": "robinCTS", "link": "https://stackoverflow.com/users/1961728/robincts"}, "reply_to_user": {"reputation": 77, "user_id": 8308768, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ecd14388deeb33874cb5d1b7fdcc8db1?s=128&d=identicon&r=PG&f=1", "display_name": "rdplanglois", "link": "https://stackoverflow.com/users/8308768/rdplanglois"}, "edited": false, "score": 0, "creation_date": 1506570086, "post_id": 46456341, "comment_id": 79876161, "body": "@rdplanglois I originally had the two criteria in separate <code>With</code>s too but then thought &quot;there ought to be a more elegant solution&quot; and that&#39;s when I rolled them into one! What version of Excel are you using?"}, {"owner": {"reputation": 77, "user_id": 8308768, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ecd14388deeb33874cb5d1b7fdcc8db1?s=128&d=identicon&r=PG&f=1", "display_name": "rdplanglois", "link": "https://stackoverflow.com/users/8308768/rdplanglois"}, "edited": false, "score": 0, "creation_date": 1506602995, "post_id": 46456341, "comment_id": 79894077, "body": "Office 2010, on a Windows 7 system."}], "tags": [], "owner": {"reputation": 5449, "user_id": 1961728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bqpz6.png?s=128&g=1", "display_name": "robinCTS", "link": "https://stackoverflow.com/users/1961728/robincts"}, "is_accepted": false, "score": 0, "last_activity_date": 1506542690, "creation_date": 1506542690, "answer_id": 46456341, "question_id": 46452723, "link": "https://stackoverflow.com/questions/46452723/excel-2013-vba-use-successive-columns-to-sort-large-range/46456341#46456341", "title": "Excel 2013 VBA use successive columns to sort large range", "body": "<p>I have no idea why your code doesn't work on your computer as it works perfectly on mine. (I <em>am</em> running Excel 2007, though.)</p>\n\n<p>In fact, all three of the appropriate methods (out of five total) to perform a sort in Excel work fine for me.</p>\n\n<p>This is the one you haven't seen yet, using <code>AutoFilter.Sort</code>: </p>\n\n<pre><code>Sub RefreshAll_RS()\n  Workbooks(ThisWorkbook.Name).RefreshAll\n\n  With ActiveWorkbook.Worksheets(\"Detailed Budget Report\")\n    .Range(\"RC_number\").CurrentRegion.AutoFilter\n    .Range(\"RC_number\").Select\n    With .AutoFilter.Sort\n      .Header = xlYes\n      .SortFields.Add Key:=Range(\"Sort_2nd\"), Order:=xlAscending\n      .Apply\n      .SortFields.Clear\n      .SortFields.Add Key:=Range(\"Sort_1st\"), Order:=xlAscending\n      .Apply\n    End With\n    .Range(\"RC_number\").CurrentRegion.AutoFilter\n  End With\nEnd Sub\n</code></pre>\n\n<p>Then there's your version, using <code>Range.Sort</code>. (I've modified it slightly but it's still functionally equivalent.)</p>\n\n<pre><code>Sub RefreshAll_Q1()\n  Workbooks(ThisWorkbook.Name).RefreshAll\n\n  With Worksheets(\"Detailed Budget Report\").Range(\"RC_number\").CurrentRegion\n    .Sort _\n      key1:=\"Sort_1st\", order1:=xlAscending, _\n      key2:=\"Sort_2nd\", order2:=xlAscending, _\n      Header:=xlYes\n  End With\nEnd Sub\n</code></pre>\n\n<p>And finally, there's <a href=\"https://stackoverflow.com/users/8651782/joshua-fenner\">Joshua</a>'s version, using <code>Worksheet.Sort</code>. (I've fixed the incorrect <code>.SetRange</code> parameter bug, so it now works.)</p>\n\n<pre><code>Sub RefreshAll_A1()\n  Workbooks(ThisWorkbook.Name).RefreshAll\n\n  With Worksheets(\"Detailed Budget Report\").Sort\n    .SortFields.Clear\n    .SortFields.Add Key:=Range(\"Sort_1st\"), Order:=xlAscending\n    .SortFields.Add Key:=Range(\"Sort_2nd\"), Order:=xlAscending\n    .SetRange Range(\"RC_number\").CurrentRegion\n    .Header = xlYes\n    .Apply\n  End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 8308768, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ecd14388deeb33874cb5d1b7fdcc8db1?s=128&d=identicon&r=PG&f=1", "display_name": "rdplanglois", "link": "https://stackoverflow.com/users/8308768/rdplanglois"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1506542690, "creation_date": 1506529098, "question_id": 46452723, "link": "https://stackoverflow.com/questions/46452723/excel-2013-vba-use-successive-columns-to-sort-large-range", "title": "Excel 2013 VBA use successive columns to sort large range", "body": "<p>I've tried to research why this isn't working, but I've hit a wall, because, so far as I can tell, my code ought to be doing the trick...</p>\n\n<p>My situation is that I'm building a spreadsheet to simplify a budget reporting process for my office. As I'm the only one with a half-decent understanding of Excel, I want to make this as braindead and simple for the other users as possible. To that end, <em>VBA to the rescue!</em> as it will take care of importing the data and doing all the sorting for me (them) with just one click.</p>\n\n<p>The imported data is 24 columns wide and may grow to as much as 2500 lines by year-end. Once the data is imported, I need to sort by mulitple column types, one after the other, sucessively. So:\n- Import data\n- sort by date\n- sort by transacation type\n- sort by billed budget\n- etc (6 sorts total)</p>\n\n<p>This is my code at the moment:</p>\n\n<pre><code>Sub RefreshAll()\n    Workbooks(ThisWorkbook.Name).RefreshAll\n\n    With Worksheets(\"Detailed Budget Report\")\n        .Range(\"RC_number\").CurrentRegion.Sort _\n            key1:=Range(\"Sort_1st\"), order1:=xlAscending, _\n            key2:=Range(\"Sort_2nd\"), order2:=xlAscending, _\n            Header:=xlYes\n    End With\nEnd Sub\n</code></pre>\n\n<p>The <strong>refresh all</strong> will pull from the import file anew, to make sure the spreadsheet is up-to-date. Then, I've got to sort it all. Thanks to the brilliant response at the bottom of <a href=\"https://stackoverflow.com/questions/27571923/sorting-worksheet-data-by-column-values-using-excel-vba\">this post</a>, I learned about using range names, and <a href=\"http://www.informit.com/articles/article.aspx?p=2021718&amp;seqNum=5\" rel=\"nofollow noreferrer\">this page</a> showed me how to reference other worksheets.</p>\n\n<p>Here's the problem: only the first sort key is working. The code doesn't throw an error, it doesn't halt, it <em>appears</em> to execute correctly. But, only the first sort argument gets actioned; no matter what range I input as the first key, nor what range I enter as the second, only the first gets sorted.</p>\n\n<p>Can anybody help me figure out what I'm doing wrong?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1506530762, "post_id": 46452675, "comment_id": 79861985, "body": "If you&#39;re doing that in a loop, won&#39;t you be overwriting? Also, is cashb a single cell or column? If so <code>cashb.offset(,5).column</code> will do the latter."}, {"owner": {"reputation": 19, "user_id": 8614725, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab5ccfc6355887a6184e4e34debd17b1?s=128&d=identicon&r=PG&f=1", "display_name": "leoj", "link": "https://stackoverflow.com/users/8614725/leoj"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1506531749, "post_id": 46452675, "comment_id": 79862525, "body": "You&#39;re right I think that is the problem I&#39;m having. Is there an alternative to my solution without looping? I&#39;m fairly new to excel, my solution might be inconsistent.Yes, cashb is a column of 5 rows. Thanks for your help, will try to add the line of code to my solution."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1506531946, "post_id": 46452675, "comment_id": 79862629, "body": "Why are you looping through <code>rngTicker</code>? If the font color index is 33 in more than one cell what should happen? Start with what you are trying to achieve rather than the detail of the code."}, {"owner": {"reputation": 19, "user_id": 8614725, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab5ccfc6355887a6184e4e34debd17b1?s=128&d=identicon&r=PG&f=1", "display_name": "leoj", "link": "https://stackoverflow.com/users/8614725/leoj"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1506532370, "post_id": 46452675, "comment_id": 79862844, "body": "There are multiple cells with the color lightblue. If the cells are light blue its takes that value and pastes them on another sheet &#39;live&#39; along with another column(column A). Everything in the code works until I try to paste a range underneath rngcel in the &#39;live&quot; sheet. I received help from another user on the site who advised me to loop."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1506532610, "post_id": 46452675, "comment_id": 79862967, "body": "But as I say if you hard code A35 you will overwrite each time. Do you want cashb added to the first empty row each time? I&#39;m also confused because at the top you want to add cashb to the prices sheet, but in your code extract you are adding to the live sheet."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 8614725, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab5ccfc6355887a6184e4e34debd17b1?s=128&d=identicon&r=PG&f=1", "display_name": "leoj", "link": "https://stackoverflow.com/users/8614725/leoj"}, "edited": false, "score": 0, "creation_date": 1506535420, "post_id": 46454053, "comment_id": 79864385, "body": "This solution does work. Except I&#39;m getting the same outcome as my other solution.Everything works perfectly, except Cash balances keeps pasting above rngcell. Also, Cashbalances has 5 rows.It doesn&#39;t specifically need to be &quot;A35&quot; I just want it underneath rngcell. I&#39;m sorry if I&#39;m not explaining my question well. Heres an image of the desired outcome. <a href=\"https://imgur.com/a/KCK7M\" rel=\"nofollow noreferrer\">imgur.com/a/KCK7M</a>    Thank you, I appreciate your time and effort."}, {"owner": {"reputation": 211, "user_id": 8651782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d71f253fb066108065e8b7ff5a747f?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Fenner", "link": "https://stackoverflow.com/users/8651782/joshua-fenner"}, "reply_to_user": {"reputation": 19, "user_id": 8614725, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab5ccfc6355887a6184e4e34debd17b1?s=128&d=identicon&r=PG&f=1", "display_name": "leoj", "link": "https://stackoverflow.com/users/8614725/leoj"}, "edited": false, "score": 0, "creation_date": 1506553276, "post_id": 46454053, "comment_id": 79872388, "body": "<code>CB = Cashb.Offset(, 5).Value</code> should work nicely for populating the variant array also.  IDK try it out."}, {"owner": {"reputation": 19, "user_id": 8614725, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab5ccfc6355887a6184e4e34debd17b1?s=128&d=identicon&r=PG&f=1", "display_name": "leoj", "link": "https://stackoverflow.com/users/8614725/leoj"}, "edited": false, "score": 0, "creation_date": 1507034470, "post_id": 46454053, "comment_id": 80043639, "body": "Unfortunately ,neither solutions  worked for me.I kept getting subscript out of range error on &quot;.Cells(LastRow + j, 1) = CB(j)&quot; . I&#39;m sure if I was a little more experienced I could&#39;ve debugged it. Thanks, I appreciated your time and effort."}, {"owner": {"reputation": 19, "user_id": 8614725, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab5ccfc6355887a6184e4e34debd17b1?s=128&d=identicon&r=PG&f=1", "display_name": "leoj", "link": "https://stackoverflow.com/users/8614725/leoj"}, "edited": false, "score": 0, "creation_date": 1507034645, "post_id": 46454053, "comment_id": 80043756, "body": "Heres the code I used . <code>sheet.Range(&quot;Cashbalances&quot;).Select      Selection.Copy        liveprice.Activate      With Worksheets(&quot;sheet1&quot;)      lastrow2 = Selection.End(xlDown).row       Range(&quot;A1&quot;).Select        Range(&quot;A&quot; &amp; lastrow2).Select          ActiveSheet.Paste       End With</code>"}], "tags": [], "owner": {"reputation": 211, "user_id": 8651782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d71f253fb066108065e8b7ff5a747f?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Fenner", "link": "https://stackoverflow.com/users/8651782/joshua-fenner"}, "is_accepted": true, "score": 0, "last_activity_date": 1506552966, "last_edit_date": 1506552966, "creation_date": 1506533944, "answer_id": 46454053, "question_id": 46452675, "link": "https://stackoverflow.com/questions/46452675/pasting-multiple-ranges-to-another-sheet-in-vba/46454053#46454053", "title": "Pasting multiple ranges to another sheet in vba", "body": "<h2>Try This</h2>\n\n<pre><code>Sub liveP()\n\nApplication.ScreenUpdating = False\n\nDim rngTicker As Range\nDim rngCel As Variant 'used in for each this should be variant\nDim Cashb As Range\nDim ws As Worksheet\nDim LastRow As Long 'dimensioned variable for the last row\nDim CashbRows As Long 'dimensioned variable for Cashb rows\nSet ws = ThisWorkbook.Sheets.Add(After:= _\n         ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))\n         ws.Name = \"Live\"\nSet rngTicker = Worksheets(\"prices\").Range(\"H16:H200\")\nSet Cashb = Sheets(\"prices\").Range(\"cashbalances\")\n'Assuming \"cashbalances\" is a named range in the worksheet\n\nCashbRows = Cashb.Rows.Count\n\nFor Each rngCel In rngTicker\n\n    If rngCel.Font.ColorIndex = 33 Then\n     With Worksheets(\"Live\")\n        LastRow = .Cells(Rows.Count, 1).End(xlUp).Row + 1 'set lastrow variable\n        .Cells(LastRow, 1) = rngCel.Offset(0, -7).Value 'putting value 7 columns before into live worksheet column A\n        .Cells(LastRow, 2) = rngCel.Value 'putting value into live worksheet column B\n        .Range(.Cells(35, 1), .Cells(35 + CashbRows, 1)) = Cashb.Offset(, 5).Value 'im not really sure if this line is going to work at all\n\n        'New data that im posting on the Live sheet'\n          .Range(\"C2:H33\").Formula = \"=($B2 +$C5)\"\n          .Range(\"A1\") = \"Header1\"\n          .Range(\"B1\") = \"Header2\"\n          .Range(\"C1\") = \"Header3\"\n          .Range(\"D1\") = \"Header4\"\n          .Range(\"E1\") = \"Header5\"\n          .Range(\"F1\") = \"Header6\"\n     End With\n\n    End If\n\nNext\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<h2>Modifications:</h2>\n\n<p>rngCel is now a variant not a range</p>\n\n<p>Using a LastRow Variable to get away from offset</p>\n\n<p>Removed the array when placing data into \"LIVE\" because why not</p>\n\n<p>CashbRows will now only be calculated one time before the loop.  Saving time</p>\n\n<p>The <code>With Worksheets(\"Live\")</code> statement is a time saving measure.</p>\n\n<p>You were calling A35 as a range, which it is not, then resizing to a range maybe?  Hard to know when I cant tell what \"cashbalances\" is.  If \"cashbalances is only 1 row or may ever be 1 row, then you will need to add an <code>If Then Else</code> control to handle it.</p>\n\n<p>Also A35 gets overwritten every single loop...  so not sure what you want to do there.  </p>\n\n<p>I hope I was able to understand your questions well enough to get you going in the right direction.</p>\n\n<h2>EDIT</h2>\n\n<p>Stop treating \"cashbalances\" as a named range.  I believe VBA is hanging onto the original row numbers of the range, similar to how Variant arrays start at 1 when assigned as I do in the following.  It does not look like you are modifying \"cashbalances\" so create a variant array before the loop but after CashbRows.</p>\n\n<p>EXAMPLE:</p>\n\n<pre><code>Dim CB() as variant, j as long\nwith sheets(\"PUT THE SHEET NAME OR INDEX HERE\")\nCB = .range(.cells(1,6), .cells(CashbRows,6)).value 'address to whatever .offset(,5) is\n'i assumed cashb was in column A \n</code></pre>\n\n<p>Instead of <code>.Range(.Cells(35, 1), .Cells(35 + CashbRows, 1)) = Cashb.Offset(, 5).Value</code> Use:</p>\n\n<pre><code>For j = 1 to CashbRows\n    .cells(34 + j, 1) = CB(j)\nNext j\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 8614725, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab5ccfc6355887a6184e4e34debd17b1?s=128&d=identicon&r=PG&f=1", "display_name": "leoj", "link": "https://stackoverflow.com/users/8614725/leoj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 46454053, "answer_count": 1, "score": 0, "last_activity_date": 1506552966, "creation_date": 1506528946, "last_edit_date": 1506529934, "question_id": 46452675, "link": "https://stackoverflow.com/questions/46452675/pasting-multiple-ranges-to-another-sheet-in-vba", "title": "Pasting multiple ranges to another sheet in vba", "body": "<p>I'd like the code to paste 'cashb' underneath 'rngcel', but every time \nI run the code 'cashb''s value  appears above 'rngCel'.value. Rngcell's range is from A2:A34, I'd like 'Cashb' to appear right below it at A35.  I tried putting 'A35' in the \nrange but it does not work. </p>\n\n<p>This is the code that I want to appear below rngcel.value.</p>\n\n<pre><code>Sheets(\" Price\").Range(\"A35\").Resize(Cashb.Rows.Count).Value = Cashb.Value\n</code></pre>\n\n<p>I'd also like to return the column that's 5 columns  to the right of \"cashb\"range\nI appreciate any help that I receive. </p>\n\n<p>This is the code that I have.Thanks in advance.</p>\n\n<pre><code>    Sub liveP()\n\n   Application.ScreenUpdating = False\n\n    Dim rngTicker As Range\n    Dim rngCel As Range\n    Dim Cashb As Range\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Sheets.Add(After:= _\n             ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))\n             ws.Name = \"Live\"\n    Set rngTicker = Worksheets(\"prices\").Range(\"H16:H200\") \n    Set Cashb = Sheets(\"prices\").Range(\"cashbalances\")\n\n\n    For Each rngCel In rngTicker\n\n        If rngCel.Font.ColorIndex = 33 Then\n         Worksheets(\"Live\").Cells(Rows.Count, 1).End(xlUp).offset(1).Resize(1, 2).Value = Array(rngCel.offset(, \"-7\").Value, rngCel.Value) ' this is range cell value'\n         WorkSheets(\"Live\").Range(\"A35\").Resize(Cashb.Rows.Count).Value = Cashb.Value.offset ' this is the value I'd like to appear under rngcel value\n\n            'New data that im posting on the Live sheet'\n              Sheets(\"Live\").Range(\"C2:H33\").Formula = \"=($B2 +$C5)\"\n              Sheets(\"Live\").Range(\"A1\") = \"Header1\"\n              Sheets(\"Live\").Range(\"B1\") = \"Header2\"\n              Sheets(\"Live\").Range(\"C1\") = \"Header3\"\n              Sheets(\"Live\").Range(\"D1\") = \"Header4\"\n              Sheets(\"Live\").Range(\"E1\") = \"Header5\"\n              Sheets(\"Live\").Range(\"F1\") = \"Header6\"\n\n        End If\n\n\n    Next\n\n\n  Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "worksheet-function"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1506530882, "post_id": 46452648, "comment_id": 79862047, "body": "What&#39;s your problem - does the code not work, not do what you want....?"}, {"owner": {"reputation": 17, "user_id": 5101930, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/27fed10df36c6d52f49e1d72bc098b95?s=128&d=identicon&r=PG&f=1", "display_name": "Zden\u011bk Bu\u017ega", "link": "https://stackoverflow.com/users/5101930/zden%c4%9bk-bu%c5%bega"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1506531187, "post_id": 46452648, "comment_id": 79862215, "body": "This code doesn&#39;t work. It will load the text from cell when I click but when I make a change and press Enter, it will move to next row which will change variable in on old_value. Sometimes it even showed empty cell in old_value even if there was text in cell and in cell beneath it."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 5101930, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/27fed10df36c6d52f49e1d72bc098b95?s=128&d=identicon&r=PG&f=1", "display_name": "Zden\u011bk Bu\u017ega", "link": "https://stackoverflow.com/users/5101930/zden%c4%9bk-bu%c5%bega"}, "edited": false, "score": 1, "creation_date": 1506535466, "post_id": 46453374, "comment_id": 79864405, "body": "It worked! Propably global variable and Targets made it work because otherwise mine code was the same. Thanks a lot for help. Marking your post as answer for anyone who would need help in this matter."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 17, "user_id": 5101930, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/27fed10df36c6d52f49e1d72bc098b95?s=128&d=identicon&r=PG&f=1", "display_name": "Zden\u011bk Bu\u017ega", "link": "https://stackoverflow.com/users/5101930/zden%c4%9bk-bu%c5%bega"}, "edited": false, "score": 0, "creation_date": 1506535537, "post_id": 46453374, "comment_id": 79864440, "body": "Thanks. Yes, I should have mentioned that making it a global variable is the main thing."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1506531463, "creation_date": 1506531463, "answer_id": 46453374, "question_id": 46452648, "link": "https://stackoverflow.com/questions/46452648/private-sub-worksheet-selectionchange-worksheet-change/46453374#46453374", "title": "Private Sub Worksheet_SelectionChange/Worksheet_Change", "body": "<p>Not re-writing all your code, but in essence you have to do this to store the value when the cell is selected and then after it is changed. You don't need the newcellvalue variable as Target captures that.</p>\n\n<pre><code>Dim OldCellValue\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\nDim newcellvalue\n\nnewcellvalue = Target.Value\n\nMsgBox \"Old \" &amp; OldCellValue &amp; \", New \" &amp; newcellvalue\n\nEnd Sub\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n\nOldCellValue = Target.Value\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 5101930, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/27fed10df36c6d52f49e1d72bc098b95?s=128&d=identicon&r=PG&f=1", "display_name": "Zden\u011bk Bu\u017ega", "link": "https://stackoverflow.com/users/5101930/zden%c4%9bk-bu%c5%bega"}, "edited": false, "score": 0, "creation_date": 1506535509, "post_id": 46453553, "comment_id": 79864427, "body": "Thanks a lot for help. Using global variable was the key to make it work."}], "tags": [], "owner": {"reputation": 415, "user_id": 2063351, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/3ac89cdd2a3f6639430635a9ace207df?s=128&d=identicon&r=PG", "display_name": "user2063351", "link": "https://stackoverflow.com/users/2063351/user2063351"}, "is_accepted": false, "score": 0, "last_activity_date": 1506532069, "creation_date": 1506532069, "answer_id": 46453553, "question_id": 46452648, "link": "https://stackoverflow.com/questions/46452648/private-sub-worksheet-selectionchange-worksheet-change/46453553#46453553", "title": "Private Sub Worksheet_SelectionChange/Worksheet_Change", "body": "<p>I think you're on the right track. I would use a global variable to track the current/old value so you can compare it in the Worksheet_Change event.</p>\n\n<p>Something like this:</p>\n\n<pre><code>Private old_value As String\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n    If Target.Cells.Count &gt; 1 Then Exit Sub\n\n    old_value = Target.Text\n\n    'Debug to check the old_value\n    'Debug.Print \"old_value = \" + old_value\nEnd Sub\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim Area As Range\n    Dim OutlApp As Object\n    Dim IsCreated As Boolean\n    Dim cell As String\n    Dim new_value As String\n\n    Set Area = Range(\"A1:E20\")\n\n    If Target.Cells.Count &gt; 1 Then Exit Sub\n\n    If Not Intersect(Target, Area) Is Nothing Then\n        new_value = Target.Text\n\n        'Debug to compare values\n        'Debug.Print \"new_value = \" + new_value\n        'Debug.Print \"old_value = \" + old_value\n\n        If new_value &lt;&gt; old_value Then\n            'Debug to compare\n            'Debug.Print \"new_value and old_value are different\"\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>Keep in mind that the Worksheet_SelectionChange event is going to fire every time you navigate between cells. So, if you change the value of a cell and press the Enter key, the value of old_value is going to change because you are resetting the value in the Worksheet_SelectionChange event. You need to perform the comparison and send the email before the selection changes.</p>\n\n<p>Also, you'll probably want to use .Value for the cell instead of .Text. See this post for the differences: <a href=\"https://stackoverflow.com/questions/17359835/what-is-the-difference-between-text-value-and-value2\">What is the difference between .text, .value, and .value2?</a></p>\n"}], "owner": {"reputation": 17, "user_id": 5101930, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/27fed10df36c6d52f49e1d72bc098b95?s=128&d=identicon&r=PG&f=1", "display_name": "Zden\u011bk Bu\u017ega", "link": "https://stackoverflow.com/users/5101930/zden%c4%9bk-bu%c5%bega"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1235, "favorite_count": 0, "accepted_answer_id": 46453374, "answer_count": 2, "score": -1, "last_activity_date": 1506532069, "creation_date": 1506528872, "last_edit_date": 1506530791, "question_id": 46452648, "link": "https://stackoverflow.com/questions/46452648/private-sub-worksheet-selectionchange-worksheet-change", "title": "Private Sub Worksheet_SelectionChange/Worksheet_Change", "body": "<p>Good day, I need to create 2 private macros in one workbook - one which stores content of cell after clicking on it and second one which will store the new value of cell and send and email with body of old text in cell and new text in cell. </p>\n\n<p>Truth to be told, I'm not sure if this is the right way to do it (or if it's even possible) but I don't work with private macros often so I will appreciate any help. Thanks a lot!</p>\n\n<p>That is what i got so far:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\nIf Target.Cells.Count &gt; 1 Then Exit Sub\nOldCellValue = ActiveCell.text\nold_value = OldCellValue\nEnd Sub\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\nDim Area As Range\nDim OutlApp As Object\nDim IsCreated As Boolean\nDim cell As String\nDim old_value As String\nDim new_value As String\n\nSet Area = Range(\"A1:E20\")\n\nIf Target.Cells.Count &gt; 1 Then Exit Sub\n\nIf Not Intersect(Target, Area) Is Nothing Then\n\ncell = ActiveCell.Address\nnew_value = ActiveCell.text\n\nOn Error Resume Next\n Set OutlApp = GetObject(, \"Outlook.Application\")\n If Err Then\n   Set OutlApp = CreateObject(\"Outlook.Application\")\n   IsCreated = True\n End If\n OutlApp.Visible = True\n On Error GoTo 0\n\n With OutlApp.CreateItem(0)\n\n   .Subject = \"Change in table\"\n   .to = \"someones email\"\n   .HTMLBody = \"Change in cell \" &amp; \"&lt;B&gt;\" &amp; cell &amp; \"&lt;/B&gt;&lt;br&gt;\" _\n                &amp; \"Old value: \" &amp; old_value &amp; \"New value: \" &amp; new_value\n\n   On Error Resume Next\n   .Send\n   Application.Visible = True\n   On Error GoTo 0\n\n End With\n\n If IsCreated Then OutlApp.Quit\n\n Set OutlApp = Nothing\n\nEnd With\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1506530495, "post_id": 46452305, "comment_id": 79861859, "body": "Can you explain how your example relates to your code? If you want to preserve formatting you&#39;ll have to store the previous settings and then re-instate them after adding new text."}, {"owner": {"reputation": 35, "user_id": 2371229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413898460bccc637a67269f826fb36d4?s=128&d=identicon&r=PG", "display_name": "user2371229", "link": "https://stackoverflow.com/users/2371229/user2371229"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1506531822, "post_id": 46452305, "comment_id": 79862564, "body": "Apologies, the Disney characters were given to me as a redaction.  The data is structured in a grid of &quot;Needs Categories&quot; and specific &quot;Needs&quot; of data-sets and/or documents. Donald Duck 1 is a &quot;Needs Category&quot; and Minnie Mouse 1 is a more detailed &quot;Need&quot;.  As the code loops through the grid, it finds a &quot;1&quot; which indicates that there is a need in that intersection. +1 and -1 are just comparisons of &quot;child&quot; categories to a &quot;parent&quot; standard.  For each need that it finds in the grid, it is adding the new line in the form of &quot;Needs Category - Need&quot; to the existing list"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1506531829, "post_id": 46452305, "comment_id": 79862572, "body": "You say you are &quot;adding concatenated text&quot; - can you give an example of original text and final expected output - it&#39;s not clear from the example"}, {"owner": {"reputation": 35, "user_id": 2371229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413898460bccc637a67269f826fb36d4?s=128&d=identicon&r=PG", "display_name": "user2371229", "link": "https://stackoverflow.com/users/2371229/user2371229"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1506531927, "post_id": 46452305, "comment_id": 79862616, "body": "The color coding is reference to that &quot;child/parent&quot; comparison to the standard."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1506531999, "post_id": 46452305, "comment_id": 79862652, "body": "Can you provide a plain English example - DIsney characters are fine!"}, {"owner": {"reputation": 35, "user_id": 2371229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413898460bccc637a67269f826fb36d4?s=128&d=identicon&r=PG", "display_name": "user2371229", "link": "https://stackoverflow.com/users/2371229/user2371229"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1506532005, "post_id": 46452305, "comment_id": 79862661, "body": "Within a single cell, I start with --- &quot;Donald Duck 1 - Minnie Mouse 1 Donald Duck 2 - Minnie Mouse 2 Donald Duck 3 - Minnie Mouse 3&quot; --- and need to add --- &quot;Donald Duck 4 - Minnie Mouse 4&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1506532553, "creation_date": 1506532553, "answer_id": 46453693, "question_id": 46452305, "link": "https://stackoverflow.com/questions/46452305/using-charcter-insert-to-format-pieces-of-text-in-a-cell-vba/46453693#46453693", "title": "Using Charcter().Insert to format pieces of text in a cell (VBA)", "body": "<p>Perhaps this simple example will help. If you have the starting text as in your example in A1 and then \"Donald Duck 4 - Minnie Mouse 4\" in A5 this will add it to the end and colour the text red.</p>\n\n<pre><code>Sub x()\n\nDim r As Range, n As Long\n\nn = Len(Range(\"A5\")) 'new text added to end of A1\n\nWith Range(\"A1\")\n    .Characters(Len(.Value) + 1).Insert (vbCrLf &amp; Range(\"A5\"))\n    .Characters(Len(.Value) - n, n + 1).Font.Color = vbRed\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 2371229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413898460bccc637a67269f826fb36d4?s=128&d=identicon&r=PG", "display_name": "user2371229", "link": "https://stackoverflow.com/users/2371229/user2371229"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1506532553, "creation_date": 1506527793, "last_edit_date": 1531164843, "question_id": 46452305, "link": "https://stackoverflow.com/questions/46452305/using-charcter-insert-to-format-pieces-of-text-in-a-cell-vba", "title": "Using Charcter().Insert to format pieces of text in a cell (VBA)", "body": "<p>I'm trying to insert a new line of text into an existing cell without losing the formatting.  </p>\n\n<p>In a single cell, I have a loop to add concatenated text based on a column in the sheet. This works fine, but I need to be able to format certain lines GREEN if it's additive and RED if it's removed when compared to a global standard.</p>\n\n<p>For Example:</p>\n\n<p>\"Donald Duck 1 - Minnie Mouse  1</p>\n\n<p>Donald Duck 2 - Minnie Mouse  2  (GREEN)</p>\n\n<p>Donald Duck 3 - Minnie Mouse  3</p>\n\n<p>Donald Duck 4 - Minnie Mouse  4 (RED)</p>\n\n<p>Goofy - 39 - Pluto - 39</p>\n\n<p>Goofy - 42 - Pluto - 42\"</p>\n\n<p>My current code does the loop, but the problem with this is that I lose the existing formatting every time I overwrite with a new data line in that cell.</p>\n\n<pre><code>If ActiveCell.Offset(0, ColumnOffset) = 1 Then\n\n     Need = ActiveCell.Offset(NeedNameOffset, ColumnOffset).Value\n     DocCode = ActiveCell.Offset(NeedNameOffset + 1, ColumnOffset).Value\n\n         If NeedsType = \"Data Needs\" Then\n            DestDataNeedsCell.Value = DestDataNeedsCell.Value &amp; NeedsCategory &amp; \" - \" &amp; Need &amp; vbCrLf\n\n         ElseIf NeedsType = \"Document Needs\" Then\n            DestDocNeedsCell.Value = DestDocNeedsCell.Value &amp; NeedsCategory &amp; \" - \" &amp; Need &amp; \" (\" &amp; DocCode &amp; \")\" &amp; vbCrLf\n\n         End If\n</code></pre>\n\n<p>I tried using a Character().Insert function which seemed to work at first, but for some reason does not add in all of the data.  I also don't think my method of changing colors is properly changing just the active line.</p>\n\n<pre><code>If ActiveCell.Offset(0, ColumnOffset) = 1 Then\n\n   strValue = ActiveCell.Offset(0, ColumnOffset).Value\n   Need = ActiveCell.Offset(NeedNameOffset, ColumnOffset).Value\n   DocCode = ActiveCell.Offset(NeedNameOffset + 1, ColumnOffset).Value\n\n     If NeedsType = \"Data Needs\" Then\n        If strValue = \"+1\" Then\n           startChar = Len(DestDataNeedsCell)\n           DestDataNeedsCell.Characters(Len(DestDataNeedsCell) + 1, 1).Insert (NeedsCategory &amp; \" - \" &amp; Need &amp; vbCrLf)\n           endChar = Len(DestDataNeedsCell)\n           DestDataNeedsCell.Characters(Start:=startChar, Length:=endChar).Font.Color = vbGreen\n\n        ElseIf strValue = \"-1\" Then\n           startChar = Len(DestDataNeedsCell)\n           DestDataNeedsCell.Characters(Len(DestDataNeedsCell) + 1, 1).Insert (NeedsCategory &amp; \" - \" &amp; Need &amp; vbCrLf)\n           endChar = Len(DestDataNeedsCell)\n           DestDataNeedsCell.Characters(Start:=startChar, Length:=endChar).Font.Color = vbRed\n        Else\n           DestDataNeedsCell.Characters(Len(DestDataNeedsCell) + 1, 1).Insert (NeedsCategory &amp; \" - \" &amp; Need &amp; vbCrLf)\n     End If\n</code></pre>\n"}, {"tags": ["vba", "excel", "userform"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1506527988, "post_id": 46452296, "comment_id": 79860400, "body": "Get rid of <code>End</code>. That statement exits all procedures. There is almost never a reason to use it."}, {"owner": {"reputation": 321, "user_id": 4915723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b8417efa4b79cbcf3463d38ccfedb7b5?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Bailey", "link": "https://stackoverflow.com/users/4915723/sean-bailey"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1506528401, "post_id": 46452296, "comment_id": 79860670, "body": "I have tried this - unfortunately it does not work and in the case of this code I have used <i>End</i> too ensure the public sub does not carry on if no drop downs are selected."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1506528658, "post_id": 46452296, "comment_id": 79860849, "body": "In which case, clearly removing it <b>does</b> work to return control to the public sub. Your public sub should then be checking to see if a value was selected."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 2, "creation_date": 1506528665, "post_id": 46452296, "comment_id": 79860855, "body": "Find another way to proceed then. For example, have a public Boolean variable which serves as a flag which the public sub can check when execution gets back to it. In the absence of <code>End</code>, execution always returns to the caller when the called sub finishes. I really don&#39;t know of a single instance in which <code>End</code> is necessary."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 1, "creation_date": 1506528748, "post_id": 46452296, "comment_id": 79860905, "body": "You should post the code that shows the Userform."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1506528824, "post_id": 46452296, "comment_id": 79860945, "body": "Your public Sub can read the values of controls on a hidden form, and then <code>Unload</code> it."}, {"owner": {"reputation": 321, "user_id": 4915723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b8417efa4b79cbcf3463d38ccfedb7b5?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Bailey", "link": "https://stackoverflow.com/users/4915723/sean-bailey"}, "edited": false, "score": 0, "creation_date": 1506529064, "post_id": 46452296, "comment_id": 79861085, "body": "All I have updated so all the userforms code is present in the orginal post"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1506529259, "post_id": 46452296, "comment_id": 79861190, "body": "Erm, what <code>Public Sub</code> are you talking about? Where&#39;s the code that <i>displays</i> the userform?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1506529341, "post_id": 46452296, "comment_id": 79861251, "body": "Unless you&#39;re showing a form non-modally, <i>the opening code always halts until the form is closed</i>.  maybe that&#39;s your problem?"}, {"owner": {"reputation": 321, "user_id": 4915723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b8417efa4b79cbcf3463d38ccfedb7b5?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Bailey", "link": "https://stackoverflow.com/users/4915723/sean-bailey"}, "edited": false, "score": 0, "creation_date": 1506529471, "post_id": 46452296, "comment_id": 79861315, "body": "I have included the start of the public sub also - Unsure what Non-modally &quot;means&quot;"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1506529523, "post_id": 46452296, "comment_id": 79861345, "body": "Don&#39;t worry about it. Now that we see how the form is shown, we know it&#39;s modal (user can&#39;t click outside the form until it&#39;s closed)."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1506530549, "creation_date": 1506530549, "answer_id": 46453128, "question_id": 46452296, "link": "https://stackoverflow.com/questions/46452296/userform-return-to-public-sub-from-private-sub/46453128#46453128", "title": "Userform - Return to public sub from private sub", "body": "<p>Unless you're showing a form non-modally, <em>the opening code always halts until the form is closed</em></p>\n"}, {"comments": [{"owner": {"reputation": 321, "user_id": 4915723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b8417efa4b79cbcf3463d38ccfedb7b5?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Bailey", "link": "https://stackoverflow.com/users/4915723/sean-bailey"}, "edited": false, "score": 0, "creation_date": 1506590590, "post_id": 46453302, "comment_id": 79885917, "body": "Thanks so much for all your help! Your explanations has enhanced my VBA &amp; Userform knowledge it is much appreciated!"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 4, "last_activity_date": 1506531479, "last_edit_date": 1506531479, "creation_date": 1506531167, "answer_id": 46453302, "question_id": 46452296, "link": "https://stackoverflow.com/questions/46452296/userform-return-to-public-sub-from-private-sub/46453302#46453302", "title": "Userform - Return to public sub from private sub", "body": "<p><strong>First thing</strong>, remove <code>End</code>, everywhere. <code>End</code> is a big red NUKE 'EM ALL button that <em>ends</em> execution right there and then - after <code>End</code> has executed, it doesn't matter where you were in the call stack, for <strong><em>there is no call stack anymore</em></strong>; your code isn't running anymore, there's nowhere to \"return\" to.</p>\n\n<p><strong>Second thing</strong>, don't keep state in the <em>default instance</em> of a form. Treat it like the object it is, and <code>New</code> up a new instance when you need one - that way you don't need to be bothered with <code>Unload</code>ing it and/or resetting the state between calls: the <code>_Initialize</code> handler will run every time, and there won't be a need to <code>Clear</code> the items from the previous call, since you'll be working with a fresh instance every time. You do that like this:</p>\n\n<pre><code>With New UserForm3 'UserForm_Initialize handler runs here\n    .Show 'UserForm_Activate handler runs here\n    'anything after .Show will only run after the form is closed\n    If Not .Cancelled Then\n        Sheet8.Range(\"I16\").Value = .ComboBox1.Text\n    End If\nEnd With 'UserForm_Terminate handler runs here\n</code></pre>\n\n<p>Notice the worksheet is NOT being written to by the form - <em>it's not its job</em>! So how do we make that <code>Cancelled</code> member legal?</p>\n\n<p>First you <strong>name things</strong> and make <code>CommandButton1</code> be <code>OkButton</code> and <code>CommandButton2</code> be <code>CancelButton</code> - or whatever - just not Button1 and Button2.</p>\n\n<p>I like that you're <em>hiding</em> the form instance instead of nuking it with <code>Unload Me</code>, however you're <em>explicitly</em> working off the <em>default instance</em> again, which means the above <code>New UserForm3</code> code will not be hiding the same instance that's being shown. <strong>NEVER</strong> qualify member calls with a default instance when you mean to work with <code>Me</code>.</p>\n\n<p>In other words:</p>\n\n<pre><code>UserForm3.Hide 'hides the default instance of UserForm3\n\nMe.Hide 'hides whatever the current instance is\n\nHide 'same as Me.Hide\n</code></pre>\n\n<p>So. Add a <code>Private isCancelled As Boolean</code> private field (module-level variable), and then expose a <code>Public Property Get Cancelled() As Boolean</code> public property getter that returns it:</p>\n\n<pre><code>Option Explicit\nPrivate isCancelled As Boolean\n\nPublic Property Get Cancelled() As Boolean\n    Cancelled = isCancelled\nEnd Property\n</code></pre>\n\n<p>Next, make your cancel button set the flag:</p>\n\n<pre><code>Private Sub CancelButton_Click()\n    isCancelled = True\n    Me.Hide\nEnd Sub\n</code></pre>\n\n<p>Then make the <code>QueryClose</code> handler set it too - and use the existing named constants wherever possible:</p>\n\n<pre><code>Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\n    If CloseMode = vbFormControlMenu Then\n        Cancel = True\n        isCancelled = True\n        Me.Hide\n    End If\nEnd Sub\n</code></pre>\n\n<p>Then implement your \"happy-path\" logic in the OK button's handler:</p>\n\n<pre><code>Private Sub OkButton_Click()\n    Me.Hide\nEnd Sub\n</code></pre>\n\n<p>I would disable the OK button until the user makes a selection - that way they can either cancel, x-out, or make a valid selection!</p>\n\n<pre><code>Public Property Get SelectedBoard() As String\n    SelectedBoard = IIf(Me.ComboBox1.ListIndex = -1, vbNullString, Me.ComboBox1.Text)\nEnd Property\n\nPrivate Sub ComboBox1_Change()\n    ValidateForm\nEnd Sub\n\nPrivate Sub ValidateForm()\n    Me.OkButton.Enabled = (SelectedBoard &lt;&gt; vbNullString)\nEnd Sub\n\nPrivate Sub UserForm_Activate()\n    ValidateForm\nEnd Sub\n</code></pre>\n\n<p>And now the caller can look like this:</p>\n\n<pre><code>With New UserForm3\n    .Show\n    If Not .Cancelled Then\n        Sheet8.Range(\"I16\").Value = .SelectedBoard\n    Else\n        MsgBox \"No board was selected, please re-run macro and select appropriate board\"\n    End If\nEnd With\n</code></pre>\n\n<p>And now you have a form that's nothing more than an I/O device for your code, as it should be. And you're using objects instead of global state.</p>\n\n<h2>TL;DR:</h2>\n\n<ul>\n<li>Remove <code>End</code> instruction wherever they are.</li>\n<li>Don't reference <code>UserForm3</code> inside <code>UserForm3</code> (use <code>Me</code> instead).</li>\n<li>Work with a fresh <code>New</code> instance every time.</li>\n<li>Expose <code>Property Get</code> members for the calling code to access, to abstract away controls that the caller doesn't need to care about.</li>\n<li>Don't allow the form to be okayed in an invalid state.</li>\n</ul>\n"}], "owner": {"reputation": 321, "user_id": 4915723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b8417efa4b79cbcf3463d38ccfedb7b5?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Bailey", "link": "https://stackoverflow.com/users/4915723/sean-bailey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 706, "favorite_count": 0, "accepted_answer_id": 46453302, "answer_count": 2, "score": 2, "last_activity_date": 1506531479, "creation_date": 1506527750, "last_edit_date": 1531164843, "question_id": 46452296, "link": "https://stackoverflow.com/questions/46452296/userform-return-to-public-sub-from-private-sub", "title": "Userform - Return to public sub from private sub", "body": "<p>I have the below code which is a private sub which is initialized from Userform3.show in a public sub, as far as I am aware the code below works however it does not return to the public sub on completion. </p>\n\n<p>Please note when I change the value of sheet8.range(I16) another private sub is called. However I believe the below code is the issue. </p>\n\n<p>Can anyone advise how I can get the private sub to return to the public sub on completion?</p>\n\n<hr>\n\n<pre><code>Private Sub UserForm_Initialize()\n'populate \"Combo-Box with Boards\n\nWith Me.ComboBox1\n.Clear ' clear previous items (not to have \"doubles\")\n.AddItem \"BISSB\"\n.AddItem \"MORIB\"\n.AddItem \"RMIB\"\nEnd With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nIf Me.ComboBox1.ListIndex = -1 Then\nUserForm3.Hide\nMsgBox \"No board was selected, please re-run macro and select appropriate board\"\nExit Sub\n\nElse\nSheet8.Range(\"I16\").Value = ComboBox1.Text\n\nEnd If\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Private Sub CommandButton2_Click()\nUserForm3.Hide\nMsgBox \"No board was selected, please re-run macro and select appropriate board\"\nEnd\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\n If CloseMode = 0 Then\n    MsgBox \"No board was selected, please re-run macro and select appropriate board\"\n    End\n    End If\nEnd Sub\n</code></pre>\n\n<p>Start of Public Sub</p>\n\n<pre><code>Sub newResumeAssessment_Click()\nDim answer As Variant\nDim Proceed As Boolean\nDim Uname As String\n\nIf UCase(Sheets(\"Main Menu\").Range(\"A1\")) = \"YES\" Then\n\nanswer = 6\n\nElse\n\n    answer = MsgBox(\"Click Yes to start a Business Case.\" &amp; _\n      vbCrLf &amp; \"Click No to resume the Business Case.\" &amp; vbCrLf &amp; _\n      \"Click Cancel to go back to the main menu.\" &amp; vbNewLine &amp; _\n      vbNewLine &amp; \"Please note, you will need to load the board submission \" &amp; _\n      \"tracker before you start a new business case.\", 35, \"Business Case\")\n\nEnd If\n\nIf answer = 6 Then\n\nUserForm3.Show\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 1, "creation_date": 1506526404, "post_id": 46451803, "comment_id": 79859355, "body": "I am not sure you can check if ranges equate each other. But you can do that with their addresses: <code>If rngT1.Address = Range(&quot;A2:D2&quot;).Address Then</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1506526820, "post_id": 46451803, "comment_id": 79859639, "body": "Unrelated, but drop the <code>.Select</code> and do <code>[ActiveSheet.]Rows(&quot;1:1&quot;).AutoFilter</code> instead."}], "answers": [{"tags": [], "owner": {"reputation": 3060, "user_id": 1101846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f30e989c661c62552c62e7af06f2d0e?s=128&d=identicon&r=PG&f=1", "display_name": "Cor_Blimey", "link": "https://stackoverflow.com/users/1101846/cor-blimey"}, "is_accepted": true, "score": 1, "last_activity_date": 1506526463, "creation_date": 1506526463, "answer_id": 46451906, "question_id": 46451803, "link": "https://stackoverflow.com/questions/46451803/vba-my-code-is-recieving-a-type-mismatch-error/46451906#46451906", "title": "VBA, my code is recieving a type mismatch error", "body": "<p>You cannot compare Arrays like that (which is what you are implicitly doing as Range.Value is the default property of a range).</p>\n\n<p>Not entirely sure what you are trying to do, but if you are trying to check that the two references refer to the same range you can do </p>\n\n<p><code>If Range1.Address = Range2.Address Then...</code></p>\n"}], "owner": {"reputation": 110, "user_id": 8676713, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/95724206c280d2070460f995332e8788?s=128&d=identicon&r=PG&f=1", "display_name": "yossup", "link": "https://stackoverflow.com/users/8676713/yossup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 46451906, "answer_count": 1, "score": 0, "last_activity_date": 1506526765, "creation_date": 1506526166, "last_edit_date": 1506526765, "question_id": 46451803, "link": "https://stackoverflow.com/questions/46451803/vba-my-code-is-recieving-a-type-mismatch-error", "title": "VBA, my code is recieving a type mismatch error", "body": "<p>The line that is recieving the error is:</p>\n\n<pre><code>If rngT1 = Range(\"A2:D2\") Then\n</code></pre>\n\n<p>This is the full subroutine:</p>\n\n<pre><code> Sub Copy_and_Paste_Other_Expenses()\n     'Copy  Expense into the Payroll Journal\n\n     Dim rngT1 As Range\n\n        'Set the worksheet name and range appropriately\n    Set rngT1 = Range(ActiveSheet.Range(\"A2\"), ActiveSheet.Range(\"D2\").End(xlDown))\n\n\n\n\n     'Paste other expense in  in payroll Journal\n\n    If rngT1 = Range(\"A2:D2\") Then\n\n       rngT1.Copy\n\n    ActiveWorkbook.Sheets(\"Payroll Journal\").Range(\"N43:Q43\").PasteSpecial xlPasteValues\n\n    ElseIf rngT1 &lt;&gt; ActiveWorkbook.Sheets(\"dat.\").Range(\"A2:D2\") Then\n\n      rngT1.Copy\n\n     ActiveWorkbook.Sheets(\"Payroll Journal\").Range(\"N43:Q46\").PasteSpecial xlPasteValues\n\n     End If\n    Rows(\"1:1\").Select\n\n    'Turn off Filter\n\n    Selection.AutoFilter\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1506527926, "post_id": 46451741, "comment_id": 79860357, "body": "What line is giving you that error?"}, {"owner": {"reputation": 75, "user_id": 4704693, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/519fb5bb78e28685fc65c0e5106f8775?s=128&d=identicon&r=PG&f=1", "display_name": "kalame04", "link": "https://stackoverflow.com/users/4704693/kalame04"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1506528034, "post_id": 46451741, "comment_id": 79860438, "body": "Range(Cells(rCol, rRow), Cells(cCol, cRow)).ClearContents There are no merged cells anywhere"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1506529181, "post_id": 46451741, "comment_id": 79861149, "body": "How can you be so sure that <code>Range(Cells(rCol, rRow), Cells(cCol, cRow)).ClearContents</code> does not contain any merged cells? Did you check on <b>all</b> sheets? Because this line of code does not refer to any particular sheet. So, it could be <code>Sheet1.Range(Sheet1.Cells(rCol, rRow), Sheet1.Cells(cCol, cRow)).ClearContents</code> or <code>Sheet2.Range(Sheet2.Cells(rCol, rRow), Sheet2.Cells(cCol, cRow)).ClearContents</code> or <code>Sheet3.Range(Sheet3.Cells(rCol, rRow), Sheet3.Cells(cCol, cRow)).ClearContents</code> .... and so on for all 10 sheets."}, {"owner": {"reputation": 5449, "user_id": 1961728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bqpz6.png?s=128&g=1", "display_name": "robinCTS", "link": "https://stackoverflow.com/users/1961728/robincts"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1506531258, "post_id": 46451741, "comment_id": 79862255, "body": "@Ralph Actually, that line of code <b><i>does</i></b> refer to a particular worksheet - the active sheet. Which, if you look at the preceding code, is the <code>To DNP</code> worksheet."}], "answers": [{"tags": [], "owner": {"reputation": 5449, "user_id": 1961728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bqpz6.png?s=128&g=1", "display_name": "robinCTS", "link": "https://stackoverflow.com/users/1961728/robincts"}, "is_accepted": false, "score": 1, "last_activity_date": 1506530801, "creation_date": 1506530801, "answer_id": 46453206, "question_id": 46451741, "link": "https://stackoverflow.com/questions/46451741/copy-ranges-to-master-table-and-remove-ranges-from-master-table-if-cell-0/46453206#46453206", "title": "Copy ranges to master table and remove ranges from master table if cell = 0", "body": "<p>You're getting the error because you have the row and column values swapped around. The row parameter comes first and <em>then</em> comes the column parameter.</p>\n\n<p>Your code should read as follows:</p>\n\n<pre><code>If Cells(cRow, cCol).Value = \"0\" Then\n    Range(Cells(rRow, rCol), Cells(cRow, cCol)).ClearContents\nEnd If\n</code></pre>\n\n<p>You are trying to clear column 11 from rows 3 to 14 of the \"To DNP\" worksheet, which obviously contains merged cells.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8285860"}, "is_accepted": false, "score": 0, "last_activity_date": 1506612082, "creation_date": 1506612082, "answer_id": 46472830, "question_id": 46451741, "link": "https://stackoverflow.com/questions/46451741/copy-ranges-to-master-table-and-remove-ranges-from-master-table-if-cell-0/46472830#46472830", "title": "Copy ranges to master table and remove ranges from master table if cell = 0", "body": "<p>For anyone else that stops by; here is simple code to clear a specific range in a row if one cell contains a specific value.</p>\n\n<pre><code>For Each cell In Range(\"C11:N50\")\n   If cell.Value2 = \"0\" Then\n        Set cRng = Range(\"C\" &amp; cell.Row &amp; \":\" &amp; \"O\" &amp; cell.Row)\n        ' Or Set clearRng = Range(\"C\" &amp; cell.Row &amp; \":O\" &amp; cell.Row)\n        cRng.Clear\n   End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 4704693, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/519fb5bb78e28685fc65c0e5106f8775?s=128&d=identicon&r=PG&f=1", "display_name": "kalame04", "link": "https://stackoverflow.com/users/4704693/kalame04"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1506612082, "creation_date": 1506526007, "last_edit_date": 1506526487, "question_id": 46451741, "link": "https://stackoverflow.com/questions/46451741/copy-ranges-to-master-table-and-remove-ranges-from-master-table-if-cell-0", "title": "Copy ranges to master table and remove ranges from master table if cell = 0", "body": "<p>There are 10 Sheets (Sheet1...Sheet10) with tables in the same range (C25:G34 &amp; C42:N51).</p>\n\n<p><a href=\"https://i.stack.imgur.com/pSIFv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pSIFv.png\" alt=\"Worksheets Source Tables\"></a></p>\n\n<p>The rows have to be copied if the 'Total Weight' column has value > 0. The copied rows go to two summary tables: </p>\n\n<p>To Westrock Table -> Westrock Summary Table </p>\n\n<p>To DNP Table -> DNP Summary Table</p>\n\n<p>Summary Table:\nWestrock\n<a href=\"https://i.stack.imgur.com/04ECL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/04ECL.png\" alt=\"Westrock Summary\"></a></p>\n\n<p>Summary Table:\nDNP\n<a href=\"https://i.stack.imgur.com/L7Ifz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/L7Ifz.png\" alt=\"enter image description here\"></a></p>\n\n<p>I'm on Mac, so PowerQuery is not an option. I'm new to VBA; this is what I have so far:</p>\n\n<pre><code>Sub ToDNP()\n\nApplication.ScreenUpdating = False\n\nWorksheets(\"Jupiter\").Activate\nRange(\"C42:N51\").Select\nSelection.Copy\nWorksheets(\"To DNP\").Activate\nRange(\"C11\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n'Application.CutCopyMode = False\n\nWorksheets(\"Windsor\").Activate\nRange(\"C42:N51\").Select\nSelection.Copy\nWorksheets(\"To DNP\").Activate\nRange(\"C21\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\nWorksheets(\"Orlando\").Activate\nRange(\"C42:N51\").Select\nSelection.Copy\nWorksheets(\"To DNP\").Activate\nRange(\"C31\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\nWorksheets(\"Woodland\").Activate\nRange(\"C42:N51\").Select\nSelection.Copy\nWorksheets(\"To DNP\").Activate\nRange(\"C41\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n\nDim rRow As Integer, rCol As Integer\nDim cRow As Integer, cCol As Integer\n\nrCol = 3\nrRow = 11\ncCol = 14\ncRow = 11\n\nFor cRow = 11 To 50\n\n    If Cells(cCol, cRow).Value = \"0\" Then\n        Range(Cells(rCol, rRow), Cells(cCol, cRow)).ClearContents\n    End If\n    rRow = rRow + 1\n\nNext cRow\n\nEnd Sub\n</code></pre>\n\n<p>This is giving me an error:</p>\n\n<blockquote>\n  <p>Error: Cannot change part of a merged Cell</p>\n</blockquote>\n"}, {"tags": ["vba", "excel", "sharepoint"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1506526069, "post_id": 46451726, "comment_id": 79859109, "body": "<a href=\"http://vbadud.blogspot.com/2008/08/vba-send-file-to-recycle-bin.html\" rel=\"nofollow noreferrer\">vbadud.blogspot.com/2008/08/vba-send-file-to-recycle-bin.htm&zwnj;&#8203;l</a>"}, {"owner": {"reputation": 178, "user_id": 7471653, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/2e5550ec3fa7f88c501339973a9311cf?s=128&d=identicon&r=PG&f=1", "display_name": "Katie", "link": "https://stackoverflow.com/users/7471653/katie"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1506530304, "post_id": 46451726, "comment_id": 79861771, "body": "@brax Thanks, that seems to work on locally stored files, but not on sharepoint"}], "owner": {"reputation": 178, "user_id": 7471653, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/2e5550ec3fa7f88c501339973a9311cf?s=128&d=identicon&r=PG&f=1", "display_name": "Katie", "link": "https://stackoverflow.com/users/7471653/katie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 539, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1506525971, "creation_date": 1506525971, "last_edit_date": 1531164843, "question_id": 46451726, "link": "https://stackoverflow.com/questions/46451726/vba-delete-sharepoint-file-recycle-bin", "title": "VBA Delete Sharepoint File - Recycle Bin", "body": "<p>Is there a way to delete a file from SharePoint using VBA without calling the SharePoint API and still have it go to the recycle bin? The \"Kill\" statement removes the files but does not send them to the SharePoint recycle bin, so I am hesitant to use it in a macro that others will run.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 5, "creation_date": 1506525874, "post_id": 46451665, "comment_id": 79858990, "body": "<i>I would like to create a VBA macro</i> - Please read <a href=\"https://meta.stackoverflow.com/questions/284236/why-is-can-someone-help-me-not-an-actual-question\">Why is &quot;Can Someone Help Me&quot; not an actual question</a>"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1506525900, "post_id": 46451665, "comment_id": 79859005, "body": "What advantage are you expecting to gain by doing in in VBA vs a formula that is already working?"}, {"owner": {"reputation": 11, "user_id": 8684055, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nta-f--h_w4/AAAAAAAAAAI/AAAAAAAAAA0/7s2o8rEYYRw/photo.jpg?sz=128", "display_name": "Gabriel Jalbert", "link": "https://stackoverflow.com/users/8684055/gabriel-jalbert"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1506526461, "post_id": 46451665, "comment_id": 79859380, "body": "@braX 58 The excel file is generated by another software, and I don&#39;t want to have to ask the other users to copy/paste the data to a template file then risk them tempering with the formula (which are complex because of the numbering system) the macro would ensure that no error could be made. The parent are afterward input into our erp system."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1506526900, "post_id": 46451665, "comment_id": 79859689, "body": "Can we see a copy of the working formula that you are using? It may help show exactly what method you are using to extract the parent number."}, {"owner": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "edited": false, "score": 0, "creation_date": 1506527094, "post_id": 46451665, "comment_id": 79859834, "body": "this should help point you in the right direction: <a href=\"https://stackoverflow.com/questions/18617349/excel-last-character-string-match-in-a-string\" title=\"excel last character string match in a string\">stackoverflow.com/questions/18617349/&hellip;</a>"}, {"owner": {"reputation": 11, "user_id": 8684055, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nta-f--h_w4/AAAAAAAAAAI/AAAAAAAAAA0/7s2o8rEYYRw/photo.jpg?sz=128", "display_name": "Gabriel Jalbert", "link": "https://stackoverflow.com/users/8684055/gabriel-jalbert"}, "reply_to_user": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "edited": false, "score": 0, "creation_date": 1506527966, "post_id": 46451665, "comment_id": 79860385, "body": "@SeanC I&#39;ve updated my question to include the formula."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8684055, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nta-f--h_w4/AAAAAAAAAAI/AAAAAAAAAA0/7s2o8rEYYRw/photo.jpg?sz=128", "display_name": "Gabriel Jalbert", "link": "https://stackoverflow.com/users/8684055/gabriel-jalbert"}, "edited": false, "score": 0, "creation_date": 1507305083, "post_id": 46452448, "comment_id": 80170906, "body": "@R-roe Thanks, that worked great. I changed however your  :  stringToFind = Left(cell, level - 3 + level) to be    stringToFind = Left(cell, InStrRev(cell, &quot;.&quot;) - 1)    since the original one didn&#39;t work well with item numbers like &quot;1.10.4.1&quot; as it would try to find the string &quot;1.10.&quot; as the parent."}], "tags": [], "owner": {"reputation": 609, "user_id": 8453036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/369b931407d4e81468045e4084aa357c?s=128&d=identicon&r=PG&f=1", "display_name": "R. Roe", "link": "https://stackoverflow.com/users/8453036/r-roe"}, "is_accepted": true, "score": 0, "last_activity_date": 1506540378, "last_edit_date": 1506540378, "creation_date": 1506528222, "answer_id": 46452448, "question_id": 46451665, "link": "https://stackoverflow.com/questions/46451665/excel-vba-find-part-number-from-indented-bom/46452448#46452448", "title": "Excel VBA find part number from indented BOM", "body": "<p>I figured what the heck I want to figure this out so this is how I would do it.</p>\n\n<pre><code>Dim splitVariable As Variant\nDim level As Integer\nDim stringToFind As String\n\nFor Each cell In Range(\"A1:A\" &amp; [A1].End(xlDown).Row)\n\n    splitVariable = Split(cell.Value, \".\") 'split the cell on the period to find the level\n\n    level = UBound(splitVariable) + 1 'add one because array is 0 indexed\n\n    If level &gt; 1 Then 'don't do anything for the first level\n\n        stringToFind = Left(cell, level - 3 + level) 'get the level of the parent\n\n        For Each parentCell In Range(\"A1:A\" &amp; [A1].End(xlDown).Row)  'loop through rang again to find level\n\n            If parentCell.Value = stringToFind Then 'when the parent is found then paste it to column C\n                cell.Offset(0, 2) = parentCell.Offset(0, 1)\n                Exit For\n            End If\n        Next\n    End If\nNext\n</code></pre>\n\n<p>don't know if that helps at all.</p>\n"}], "owner": {"reputation": 11, "user_id": 8684055, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nta-f--h_w4/AAAAAAAAAAI/AAAAAAAAAA0/7s2o8rEYYRw/photo.jpg?sz=128", "display_name": "Gabriel Jalbert", "link": "https://stackoverflow.com/users/8684055/gabriel-jalbert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 774, "favorite_count": 1, "closed_date": 1506556481, "accepted_answer_id": 46452448, "answer_count": 1, "score": -1, "last_activity_date": 1506540378, "creation_date": 1506525776, "last_edit_date": 1506527850, "question_id": 46451665, "link": "https://stackoverflow.com/questions/46451665/excel-vba-find-part-number-from-indented-bom", "closed_reason": "Needs more focus", "title": "Excel VBA find part number from indented BOM", "body": "<p>We have a software (Solidworks) from wich we extract a Bill of Materials in an Excel spreadsheet.\nIt returns the following data:<br>\n<a href=\"https://i.stack.imgur.com/WE7yt.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WE7yt.jpg\" alt=\"BOM Export result\"></a></p>\n\n<p>I would like to create a VBA macro that populates column C (parent) with the parent part number. For exemple cell C6 would display : 101-07798-111.</p>\n\n<p>I managed to do it with an Excel formula directly in the worksheet, however I would like to do it with a VBA macro.</p>\n\n<p>The excel formula requires 2 columns. \n\"Column D\" in wich I do a concatenate of a letter and the data of \"column A\".\n\"Column E\" wich does an Index(match) search of \"column A\" data to return the value of \"Column B\".</p>\n\n<p>Column D formula : =CONCATENATE(\"A\";A3) *without this step the main formula have errors</p>\n\n<p>Column E formula : =INDEX($B$1:$B$250;MATCH((IFERROR(LEFT(D3; FIND(\"$\"; SUBSTITUTE(D3; \".\"; \"$\"; LEN(D3)-LEN(SUBSTITUTE(D3; \".\"; \"\"))))-1);\"-\"));$D$1:$D$250;0))</p>\n\n<p>I found ways to have a VBA script populate the rows with the formula; however since the formula contain a lot of \" it causes error in the script.</p>\n\n<p>What could be the best way to use the data in \"column a\" to get the value of \"column B\" in a vba script?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1506527078, "post_id": 46451603, "comment_id": 79859823, "body": "The code you posted simply lists the count of items in each folder.  And you really have not defined what output you want.  Please help us out."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1506564869, "post_id": 46451603, "comment_id": 79874986, "body": "@WayneG.Dunn, OP wants to print to a text file instead of the immediate window."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1506567824, "post_id": 46451603, "comment_id": 79875667, "body": "To write to a file what your Debug.Print produces, you can either use &#39;Open For Output... and Print&#39; or File System Object  Text Stream...&#39;. Not near my PC at the moment, but can give examples tomorrow. Lots of samples online if you Google: vba write to text file"}, {"owner": {"reputation": 25, "user_id": 7306240, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-N8wc3aOnJsI/AAAAAAAAAAI/AAAAAAAAACI/iG0qbanYSKI/photo.jpg?sz=128", "display_name": "Nicholas Rudd", "link": "https://stackoverflow.com/users/7306240/nicholas-rudd"}, "edited": false, "score": 0, "creation_date": 1506604439, "post_id": 46451603, "comment_id": 79895183, "body": "Thanks Wayne if you can let me know what you think is best I would appreciate it"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 7306240, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-N8wc3aOnJsI/AAAAAAAAAAI/AAAAAAAAACI/iG0qbanYSKI/photo.jpg?sz=128", "display_name": "Nicholas Rudd", "link": "https://stackoverflow.com/users/7306240/nicholas-rudd"}, "edited": false, "score": 0, "creation_date": 1507028862, "post_id": 46471728, "comment_id": 80040153, "body": "Thank Wayne! That was spot on!"}], "tags": [], "owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "is_accepted": true, "score": 0, "last_activity_date": 1506609112, "creation_date": 1506609112, "answer_id": 46471728, "question_id": 46451603, "link": "https://stackoverflow.com/questions/46451603/outputting-vba-results-to-text-file-in-outlook-2010/46471728#46471728", "title": "Outputting VBA results to text file in Outlook 2010", "body": "<p>The following is your code, converted to call a function, passing it a string, that will write to a text file.  Change the file path &amp; name to suit your needs.</p>\n\n<p>Personally, I don't like the call method because it is a waste to check if the file exists, etc. for every call. However, since your code had two subroutines that need to write text, I was too lazy to embed the proper code in your code. You could either leave as is (if seldom used), or combine together if desired.</p>\n\n<pre><code>Option Explicit\n\nSub CountItemsInMBX()\nDim outapp  As Outlook.Application\nDim olns    As Outlook.NameSpace\n\n    Set outapp = CreateObject(\"Outlook.Application\")\n    Set olns = outapp.GetNamespace(\"MAPI\")\n\n    'Debug.Print GetSubFolderCount(olns.GetDefaultFolder(olFolderInbox).Parent)\n    Write_To_MyLog GetSubFolderCount(olns.GetDefaultFolder(olFolderInbox).Parent)\nEnd Sub\n\nFunction GetSubFolderCount(objParentFolder As MAPIFolder) As Long\nDim currentFolders  As Folders\nDim fldCurrent      As MAPIFolder\nDim TempFolderCount As Integer\n\n    Set currentFolders = objParentFolder.Folders\n    If currentFolders.Count &gt; 0 Then\n\n        Set fldCurrent = currentFolders.GetFirst\n        While Not fldCurrent Is Nothing\n            TempFolderCount = TempFolderCount + GetSubFolderCount(fldCurrent)\n            Set fldCurrent = currentFolders.GetNext\n        Wend\n        'Debug.Print objParentFolder.Name &amp; \" - \" &amp; objParentFolder.Items.Count\n        Write_To_MyLog objParentFolder.Name &amp; \" - \" &amp; objParentFolder.Items.Count\n        GetSubFolderCount = TempFolderCount + objParentFolder.Items.Count\n    Else\n        'Debug.Print objParentFolder.Name &amp; \" - \" &amp; objParentFolder.Items.Count\n        Write_To_MyLog objParentFolder.Name &amp; \" - \" &amp; objParentFolder.Items.Count\n        GetSubFolderCount = objParentFolder.Items.Count\n\n    End If\n\nEnd Function\n\nPublic Function Write_To_MyLog(sText As String)\nDim oFSO        As FileSystemObject\nDim oFile       As File\nDim oStream     As TextStream\n\n    On Error GoTo Error_trap\n\n    Set oFSO = New FileSystemObject\n\n    If Not oFSO.FileExists(\"C:\\Temp\\Outlook_Folders.txt\") Then\n        Set oStream = oFSO.CreateTextFile(\"C:\\Temp\\Outlook_Folders.txt\")\n        oStream.WriteLine \" \"\n    Else\n        Set oFile = oFSO.GetFile(\"C:\\Temp\\Outlook_Folders.txt\")\n        Set oStream = oFile.OpenAsTextStream(ForAppending, TristateMixed)\n    End If\n\n    oStream.WriteLine sText\n    oStream.Close\n    Set oStream = Nothing\n    Set oFile = Nothing\n    Set oFSO = Nothing\n\nEarly_Exit:\n    Exit Function\n\nError_trap:\nDim strError    As String\n\n    strError = \"In subroutine: Write_To_MyLog \" &amp; vbCrLf &amp; _\n                Err.Number &amp; vbCrLf &amp; vbCrLf &amp; Err.Description &amp; vbCrLf &amp; _\n                        \"At Line: \" &amp; Erl\n    Err.Source = \"Module_Utilities: Write_To_MyLog  at Line: \" &amp; Erl\n    MsgBox \"Error: \" &amp; strError\n    'Write_To_Log strError   ' This is a call to a function that saves the error info to a database table.\n    Resume Early_Exit\n    Resume Next\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7306240, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-N8wc3aOnJsI/AAAAAAAAAAI/AAAAAAAAACI/iG0qbanYSKI/photo.jpg?sz=128", "display_name": "Nicholas Rudd", "link": "https://stackoverflow.com/users/7306240/nicholas-rudd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 46471728, "answer_count": 1, "score": 0, "last_activity_date": 1506609112, "creation_date": 1506525591, "question_id": 46451603, "link": "https://stackoverflow.com/questions/46451603/outputting-vba-results-to-text-file-in-outlook-2010", "title": "Outputting VBA results to text file in Outlook 2010", "body": "<p>I am trying to make the below output into a text file on my desktop. I am very new (as in today) and I found the below script online, I have gotten my head around what each but does however I am struggling to make it output as a text file. I am not sure where the commands should go (beginning middle or end?) to do this. I have found one command but I am  getting errors left right and centre. Please help. </p>\n\n<pre><code>Sub CountItemsInMBX()\n\nDim outapp As Outlook.Application\nSet outapp = CreateObject(\"Outlook.Application\")\nDim olns As Outlook.NameSpace\nSet olns = outapp.GetNamespace(\"MAPI\")\n\n\nDebug.Print GetSubFolderCount(olns.GetDefaultFolder(olFolderInbox).Parent)\n\nEnd Sub\n\nFunction GetSubFolderCount(objParentFolder As MAPIFolder) As Long\nDim currentFolders As Folders\nDim fldCurrent As MAPIFolder\n\n\nSet currentFolders = objParentFolder.Folders\nIf currentFolders.Count &gt; 0 Then\n\nSet fldCurrent = currentFolders.GetFirst\nWhile Not fldCurrent Is Nothing\nTempFolderCount = TempFolderCount + GetSubFolderCount(fldCurrent)\nSet fldCurrent = currentFolders.GetNext\nWend\nDebug.Print objParentFolder.Name &amp; \" - \" &amp; objParentFolder.Items.Count\nGetSubFolderCount = TempFolderCount + objParentFolder.Items.Count\nElse\nDebug.Print objParentFolder.Name &amp; \" - \" &amp; objParentFolder.Items.Count\nGetSubFolderCount = objParentFolder.Items.Count\n\nEnd If\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1506525320, "post_id": 46451373, "comment_id": 79858609, "body": "Is this exactly as you have it in your file? You&#39;re missing the <code>()</code> after <code>Sub addvalue()</code>..."}, {"owner": {"reputation": 3640, "user_id": 5463636, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hwpDa.jpg?s=128&g=1", "display_name": "freginold", "link": "https://stackoverflow.com/users/5463636/freginold"}, "edited": false, "score": 0, "creation_date": 1506525768, "post_id": 46451373, "comment_id": 79858909, "body": "You&#39;d have to parse the string returned by <code>ActiveCell.Formula</code> and split it based on the <code>+</code> or other symbol. If all you need to do is add 10, @ScottCraner&#39;s solution seems easy enough."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 8684016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2b657ed59a42f8ac4d5a929f317c624?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/8684016/nate"}, "edited": false, "score": 0, "creation_date": 1506534253, "post_id": 46451577, "comment_id": 79863776, "body": "I&#39;d rather not just append a +10 as it will do this multiple times and it will get messy. I&#39;d like it to actually replace the + 4 with +14 if possible"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 71, "user_id": 8684016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2b657ed59a42f8ac4d5a929f317c624?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/8684016/nate"}, "edited": false, "score": 0, "creation_date": 1506535044, "post_id": 46451577, "comment_id": 79864180, "body": "@nate the problem comes when you have <code>+ C8</code> if we split on the <code>+</code> and try to add 10 to that it does not work.  You will need to put a lot of checking in the code to ensure you are appropriately adding the <code>10</code> to the correct value.  If you can guarantee that the last value is always <code>+ somenumber</code> then it gets easier.    What happens when the value is <code>=4 + A1</code> compared to <code>=A1 + 4</code> to <code>=A1 + A2</code> to <code>=A1 + 4 + A2</code> to <code>=A1 + 4 * A2</code>.  There are just too many possibilities. The code would need to be massive to ensure all cases are accounted for."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 71, "user_id": 8684016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2b657ed59a42f8ac4d5a929f317c624?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/8684016/nate"}, "edited": false, "score": 0, "creation_date": 1506536734, "post_id": 46451577, "comment_id": 79865065, "body": "@Nate see edit.  It should work for most simple formulas."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 6, "last_activity_date": 1506536707, "last_edit_date": 1506536707, "creation_date": 1506525483, "answer_id": 46451577, "question_id": 46451373, "link": "https://stackoverflow.com/questions/46451373/excel-macro-to-add-value-to-a-cell-with-a-formula/46451577#46451577", "title": "Excel macro to add value to a cell with a formula", "body": "<p>getting to change the formula itself is problematic.  but you can append the <code>+10</code> to the end and get <code>=A1 + 4 + 10</code> with:</p>\n\n<pre><code>ActiveCell.Formula = ActiveCell.Formula &amp; \"+ 10\"\n</code></pre>\n\n<p>The issue is that <code>ActiveCell.Formula</code> returns a string and you cannot add a number to a string.  You need to concatenate the string and the new part.</p>\n\n<hr>\n\n<p>Edit</p>\n\n<p>To make it so it changes the value instead of concatenating:</p>\n\n<pre><code>Sub addvalue()\n'Keyboard Shortcut: Ctrl+Shift+A\nDim strsplit() As String\nDim i As Long\nDim dn As Boolean\n\n\ndn = False\n\nstrsplit = Split(Mid(ActiveCell.Formula, 2), \"+\")\nFor i = LBound(strsplit) To UBound(strsplit)\n\n    If IsNumeric(strsplit(i)) Then\n        strsplit(i) = CDbl(strsplit(i)) + 10\n        dn = True\n        Exit For\n    End If\nNext i\n\nActiveCell.Formula = \"=\" &amp; Join(strsplit, \"+\") &amp; IIf(dn, \"\", \"+ 10\")\n\nEnd Sub\n</code></pre>\n\n<p>This may not work in all cases but for simple formulas it does.</p>\n"}], "owner": {"reputation": 71, "user_id": 8684016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2b657ed59a42f8ac4d5a929f317c624?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/8684016/nate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1988, "favorite_count": 1, "answer_count": 1, "score": 7, "last_activity_date": 1506536707, "creation_date": 1506524898, "last_edit_date": 1506526065, "question_id": 46451373, "link": "https://stackoverflow.com/questions/46451373/excel-macro-to-add-value-to-a-cell-with-a-formula", "title": "Excel macro to add value to a cell with a formula", "body": "<p>I am trying to set up a macro to add a value, say 10, to an existing cell that has a formula in it. I would like the cell to maintain the formula. </p>\n\n<p>Here is what I've done so far:</p>\n\n<pre><code>Sub addvalue \n'Keyboard Shortcut: Ctrl+Shift+A\n\nActiveCell.Formula = ActiveCell.Formula + 10\n\nEnd Sub\n</code></pre>\n\n<p>This isn't working for me. It works when the cell is just a number, but not when the cell I am trying to adjust is a formula. </p>\n\n<p>If the cell I'm trying to adjust contains <code>=A1 + 4</code> and I run this macro, I'd like it to be <code>=A1 + 14</code> after the macro runs.</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1506604280, "post_id": 46451315, "comment_id": 79895069, "body": "Have you checked that the two stored queries are actually pulling the expected data when fed with the same date parameter ?  <code>qry_DRReport_CCP</code> and <code>qry_DRReport_CNP</code> ?"}, {"owner": {"reputation": 33, "user_id": 8005111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afdd0ceadf7d3c294824a34e54c5d1ad?s=128&d=identicon&r=PG&f=1", "display_name": "Eli A", "link": "https://stackoverflow.com/users/8005111/eli-a"}, "reply_to_user": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1506614706, "post_id": 46451315, "comment_id": 79902310, "body": "Yes.  I&#39;ve opened the ACCESS database, and run the queries from there manually entering the date range, and they each pull the correct data from their respective tables."}], "owner": {"reputation": 33, "user_id": 8005111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afdd0ceadf7d3c294824a34e54c5d1ad?s=128&d=identicon&r=PG&f=1", "display_name": "Eli A", "link": "https://stackoverflow.com/users/8005111/eli-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 163, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1594639034, "creation_date": 1506524709, "last_edit_date": 1594639034, "question_id": 46451315, "link": "https://stackoverflow.com/questions/46451315/multiple-querydef-copyfromrecordset-duplicating-data", "title": "Multiple QueryDef/CopyFromRecordset duplicating data", "body": "<p>So, I'm having some issues with a DAO pull in Excel 2013.  I've pasted my code below for review.</p>\n\n<p>The issue I'm having is, the 2nd <code>CopyFromRecordset</code> duplicates the data from the first.  Eg:  </p>\n\n<ul>\n<li>First pull is 1500 lines  </li>\n<li>Second pull should be 1200 lines from <strong>different tables</strong>  \n\n<ul>\n<li>Second pull instead is the same 1500 lines as the first pull  </li>\n</ul></li>\n</ul>\n\n<p>I've attempted to isolate the problem, and added some watches to the DB/Qry/RS variables, and they all checkout, as well as the SQL lines.  I added some 'close' and 'Nothing' lines for each of the variables to attempt to clear any residual data I was missing.  I even tried clearing the clipboard with a <code>CutCopyMode=False</code> statement; that didn't work either.</p>\n\n<p>Everything else about the code below works, except the data it's spitting out.  I have two other pulls I need to perform from the same database, but would like to figure these out before I mess with those, ha ha.  </p>\n\n<p>Thank you in advance for your help!!</p>\n\n<pre><code>Dim dt_EndDate As Date\n\nDim wkbk_PMC As Workbook\n\n\nDim MyDatabase As DAO.Database\nDim MyQueryDef As DAO.QueryDef\nDim MyRecordset As DAO.Recordset\nDim MyTableDef As DAO.TableDef\n\ndt_EndDate = DateSerial(Year(Date), Month(Date) + 2, 0)\n\nApplication.ScreenUpdating = True\nApplication.StatusBar = \"Generating Reports...\"\nApplication.ScreenUpdating = False\n\nSet wkbk_PMC = Workbooks.Add\n\n    With wkbk_PMC\n        .SaveAs Filename:=CreateObject(\"Wscript.Shell\").specialfolders(\"Desktop\") &amp; \"\\\" &amp; Month(Date) &amp; \"-\" &amp; Day(Date) &amp; \"-\" &amp; Year(Date) &amp; \" - Coordinator Weekly Meeting\"\n    End With\n\nSet MyDatabase = DBEngine.OpenDatabase(\"N:\\Database\\Coordinator Reports.accdb\")\nSet MyQueryDef = MyDatabase.QueryDefs(\"qry_DRReport_CNP\")\n\nWith MyQueryDef\n    .Parameters(\"[dt_EndDate]\") = dt_EndDate\nEnd With\n\nSet MyRecordset = MyQueryDef.OpenRecordset\n\nwkbk_PMC.Sheets(1).Range(\"A3\").CopyFromRecordset MyRecordset\nFor i = 1 To MyRecordset.Fields.Count\n    wkbk_PMC.Sheets(1).Cells(2, i).Value = MyRecordset.Fields(i - 1).Name\nNext i\n\nMyRecordset.Close           ' Added to attempt to sever all connection to previous DB/Qry/RS\nMyQueryDef.Close            ' Added to attempt to sever all connection to previous DB/Qry/RS\nMyDatabase.Close            ' Added to attempt to sever all connection to previous DB/Qry/RS\nSet MyRecordset = Nothing   ' Added to attempt to sever all connection to previous DB/Qry/RS\nSet MyQueryDef = Nothing    ' Added to attempt to sever all connection to previous DB/Qry/RS\nSet MyDatabase = Nothing    ' Added to attempt to sever all connection to previous DB/Qry/RS\n\nSet MyDatabase = DBEngine.OpenDatabase(\"N:\\Database\\Coordinator Reports.accdb\")\nSet MyQueryDef = MyDatabase.QueryDefs(\"qry_DRReport_CCP\")\n\nWith MyQueryDef\n    .Parameters(\"[dt_EndDate]\") = dt_EndDate\nEnd With\n\nSet MyRecordset = MyQueryDef.OpenRecordset\n\nlRow = wkbk_PMC.Sheets(1).Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nwkbk_PMC.Sheets(1).Range(\"A\" &amp; (lRow + 1)).CopyFromRecordset MyRecordset\n\nMyRecordset.Close\nMyQueryDef.Close\nMyDatabase.Close\n</code></pre>\n"}, {"tags": ["vba", "excel", "powerpoint"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1506524503, "post_id": 46451184, "comment_id": 79858057, "body": "Yes, it is possible for Powerpoint to &quot;talk to&quot; Excel like that."}, {"owner": {"reputation": 1, "user_id": 8683889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60fd0a1a9591228c432dd6a42ebfef22?s=128&d=identicon&r=PG&f=1", "display_name": "Dan R", "link": "https://stackoverflow.com/users/8683889/dan-r"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1506524561, "post_id": 46451184, "comment_id": 79858095, "body": "how can I do it?"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1506524910, "post_id": 46451184, "comment_id": 79858334, "body": "Add a reference to <code>Microsoft.Excel</code>Object library into your VBA project,  create an <code>Excel.Application</code> object within the Powerpoint Code and use it to open an Excel Workbook and write to the sheet of your choice."}], "answers": [{"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1506525131, "creation_date": 1506525131, "answer_id": 46451453, "question_id": 46451184, "link": "https://stackoverflow.com/questions/46451184/use-powerpoint-variable-in-excel-vba/46451453#46451453", "title": "Use PowerPoint variable in Excel (VBA)", "body": "<p>Here's a late binding example: (this goes into Powerpoint VBA)</p>\n\n<pre><code>Option Explicit\n\nPublic braX As Integer\n\nPublic Sub test()\n  braX = 10\n  Dim xlApp As Object\n  Dim xlBooks As Object\n  Dim xlBook As Object\n  Dim xlSheet As Object\n  Set xlApp = CreateObject(\"Excel.Application\")\n  xlApp.Visible = True\n  Set xlBooks = xlApp.workbooks\n  Set xlBook = xlBooks.Add()\n  Set xlSheet = xlBook.Worksheets(1)\n  xlSheet.Range(\"A1\") = braX\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8683889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60fd0a1a9591228c432dd6a42ebfef22?s=128&d=identicon&r=PG&f=1", "display_name": "Dan R", "link": "https://stackoverflow.com/users/8683889/dan-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 566, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1506525131, "creation_date": 1506524373, "question_id": 46451184, "link": "https://stackoverflow.com/questions/46451184/use-powerpoint-variable-in-excel-vba", "title": "Use PowerPoint variable in Excel (VBA)", "body": "<p>I have a PowerPoint Presentation and an Excel file. In my PPT I use a public variable <code>Public cnt As Long</code> and the following two functions to add to <code>cnt</code> or subtract (as example):</p>\n\n<pre><code>Private Sub CommandButton1_Click()\ncnt = cnt + 1\nMe.CommandButton3.Caption = \"cnt up = \" &amp; cnt\nEnd Sub\n\n\nPrivate Sub CommandButton2_Click()\ncnt = cnt - 1\nMe.CommandButton3.Caption = \"cnt down = \" &amp; cnt\nEnd Sub\n</code></pre>\n\n<p>Users will click on one of the two buttons during the PPT show which will add or subtract from the <code>cnt</code> variable. So during the PPT show <code>cnt</code> may change from 1 to 2 then to 3 and so on.</p>\n\n<p>What I want is to document the value of <code>cnt</code> in an excel file. So for example during the PPT show value of <code>cnt</code> should be shown in cell \"A1\". Is this possible?</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1506523903, "post_id": 46450753, "comment_id": 79857657, "body": "One approach (although I don&#39;t like it that much), is writing a bot that detects the active window. Based on which window is active switch the default browser by changing the registry setting. See <a href=\"https://stackoverflow.com/questions/24350930/changing-webbrowser-default\" title=\"changing webbrowser default\">stackoverflow.com/questions/24350930/&hellip;</a>. I&#39;d recommend using the autohotkey or autoit languages to do something like this, however you could do it in VBA. However, I feel like someone may have a better approach. Best of luck."}, {"owner": {"reputation": 159, "user_id": 6601416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e778dd73774b0aa57e8e9ee0034ffa62?s=128&d=identicon&r=PG&f=1", "display_name": "Raghu Sodha", "link": "https://stackoverflow.com/users/6601416/raghu-sodha"}, "edited": false, "score": 0, "creation_date": 1508418015, "post_id": 46450753, "comment_id": 80608247, "body": "If you can set Chrome as default browser on your machine then &quot;<a href=\"https://www.ietab.net\" rel=\"nofollow noreferrer\">ietab.net</a>&quot; is your solution. You can configure URLs with wildcards that you want to open in IE. I am using this extension since last one year and it is flawless."}, {"owner": {"reputation": 900, "user_id": 3902663, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/IQyER.jpg?s=128&g=1", "display_name": "SATO Yusuke", "link": "https://stackoverflow.com/users/3902663/sato-yusuke"}, "reply_to_user": {"reputation": 159, "user_id": 6601416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e778dd73774b0aa57e8e9ee0034ffa62?s=128&d=identicon&r=PG&f=1", "display_name": "Raghu Sodha", "link": "https://stackoverflow.com/users/6601416/raghu-sodha"}, "edited": false, "score": 0, "creation_date": 1508772550, "post_id": 46450753, "comment_id": 80733346, "body": "@RaghuSodha Thank you for your comment, but it seems to have to change default browser from IE to Chrome. As I wrote in the question, my company uses a software asset management system, so the administrators can change default browser to IE silently and forcibly."}], "owner": {"reputation": 900, "user_id": 3902663, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/IQyER.jpg?s=128&g=1", "display_name": "SATO Yusuke", "link": "https://stackoverflow.com/users/3902663/sato-yusuke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593076646, "creation_date": 1506523214, "last_edit_date": 1593076646, "question_id": 46450753, "link": "https://stackoverflow.com/questions/46450753/switch-launched-browser-according-to-clicked-url-on-outlook", "title": "Switch launched browser according to clicked URL on Outlook", "body": "<ul>\n<li>Our company use some in-house web systems for daily business operations. These systems are optimized to IE, and don't function properly when you access to those applications via Chrome or Firefox.</li>\n<li>I am using mattermost and GitHub Enterprise for development environment. These services limits functionalities when you access to those services via IE.</li>\n<li>I have to set the default browser to IE  according to guidelines in our company (and administrators can reset the default browser to IE).</li>\n</ul>\n\n<p>So when I receive a mail that contains a URL of GitHub pull request, I have to launch Chrome, copy the URL in the mail, and paste it to addresses bar (you also have to close IE window if you clicked the URL by mistake).</p>\n\n<p>I want Outlook to launch IE when I click the URL of the in-house web system, and launch Chrome when I click the URL of mattermost or GitHub Enterprise.</p>\n\n<p>My question is: How can I change launched browser according to clicked URL on Outlook?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 2, "creation_date": 1506522690, "post_id": 46450505, "comment_id": 79856750, "body": "Please post any code you have tried thusfar; Stack Overflow is a collaborative website, not a code-for-you service.  If you need help getting started, use the Macro Recorder in the Developer tab of Excel.  Regarding the loop aspect, look into dynamic last row, For loops, and/or For Each loops."}, {"owner": {"reputation": 454, "user_id": 6320022, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/10205374177708738/picture?type=large", "display_name": "Daniel Via&#241;o", "link": "https://stackoverflow.com/users/6320022/daniel-via%c3%b1o"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1506525138, "post_id": 46450505, "comment_id": 79858486, "body": "Sorry, I edited with the code now. My approach is a normal filter with: starting with, but it just allows 2 parameters apparently."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1506528170, "post_id": 46450505, "comment_id": 79860520, "body": "Use any of the solutions provided here to delete the rows you don&#39;t want: <a href=\"https://stackoverflow.com/questions/36873359/fastest-way-to-delete-rows-which-cannot-be-grabbed-with-specialcells\" title=\"fastest way to delete rows which cannot be grabbed with specialcells\">stackoverflow.com/questions/36873359/&hellip;</a>"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1506530332, "post_id": 46450505, "comment_id": 79861790, "body": "@DanielVia&#241;o Just to be sure, you want to delete rows, not just filter?  Both mine and MGae2M&#39;s responses delete.  Your code just autofilters.  With that in mind, it might be best to also copy the content to a new sheet, then doe the deletion, as to not affect your source data."}], "answers": [{"comments": [{"owner": {"reputation": 454, "user_id": 6320022, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/10205374177708738/picture?type=large", "display_name": "Daniel Via&#241;o", "link": "https://stackoverflow.com/users/6320022/daniel-via%c3%b1o"}, "edited": false, "score": 0, "creation_date": 1507055748, "post_id": 46452777, "comment_id": 80056826, "body": "The issue now is that when I delete the cell, range changes and so loop is missing data. If Cell A49 is deleted then the value at A50 moves up to A49 and is never checked, so I am keeping some unwanted columns"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 454, "user_id": 6320022, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/10205374177708738/picture?type=large", "display_name": "Daniel Via&#241;o", "link": "https://stackoverflow.com/users/6320022/daniel-via%c3%b1o"}, "edited": false, "score": 1, "creation_date": 1507059080, "post_id": 46452777, "comment_id": 80058464, "body": "@DanielVia&#241;o Check Edit2... when deleting you want to specify that you are stepping throught he loop in the negative direction, such that LR to 2 Step -1."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": true, "score": 1, "last_activity_date": 1507059051, "last_edit_date": 1507059051, "creation_date": 1506529304, "answer_id": 46452777, "question_id": 46450505, "link": "https://stackoverflow.com/questions/46450505/removing-rows-with-value-different-to-a-list/46452777#46452777", "title": "Removing rows with value different to a list", "body": "<p>You can use a For loop to go through the rows, and an If statement to determine which Cells meet the criteria.  This will be a long string for the if statement, but should work:</p>\n\n<pre><code>Dim i as Long, LR as Long\nLR = cells(rows.count,1).End(xlUp).Row\nFor i = 2 to LR\n    If Left(Cells(i,1).Value,1) = \"E\" OR Left(Cells(i,1).Value,1) = \"L\" OR Left(Cells(i,1).Value,2) = \"GC\" OR Left(Cells(i,1).Value,2) = \"UD\" OR Left(Cells(i,1).Value,2) = \"UG\" OR Left(Cells(i,1).Value,2) = \"UB\" OR Left(Cells(i,1).Value,2) = \"UK\" OR Left(Cells(i,1).Value,1) = \"B\" Then\n        'Nothing\n    Else\n        Rows(i).Delete\n    End If\nNext i\n</code></pre>\n\n<p>All of the work is in that If-statement.  You could make it If Not Left(...), if you wanted to forgo the Else part.  This assumes you are working in Column 1 (A). </p>\n\n<hr>\n\n<p><strong>Edit</strong></p>\n\n<p>Per the second comment I left on the post, try working in a new sheet with the .Delete code:</p>\n\n<pre><code>Sheets(\"SOURCENAME\").Copy Sheets(Sheets.Count)\n</code></pre>\n\n<p>You then would run the loop on the newly created sheet</p>\n\n<hr>\n\n<p><strong>Edit2:</strong></p>\n\n<p>When deleting cells, you want to go backwards such that:</p>\n\n<pre><code>For i = LR to 2 Step -1\n    'Stuff\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "is_accepted": false, "score": 1, "last_activity_date": 1507052578, "last_edit_date": 1507052578, "creation_date": 1506529342, "answer_id": 46452794, "question_id": 46450505, "link": "https://stackoverflow.com/questions/46450505/removing-rows-with-value-different-to-a-list/46452794#46452794", "title": "Removing rows with value different to a list", "body": "<p>Run below in each Sheet that you need check above</p>\n\n<pre><code>Sub RemoveRows()\n\n    Dim sh As Long\n    Dim i As Long\n\n    sh = ActiveSheet.Cells(Rows.Count, \"A\").End(xlUp).Row\n\n    For i = 1 To sh\n\n    ' Checking criteria section:        \n    If InStr(1, Cells(i, \"A\").Value, \"E\") = 1 Then Exit Sub\n    If InStr(1, Cells(i, \"A\").Value, \"L\") = 1 Then Exit Sub\n    If InStr(1, Cells(i, \"A\").Value, \"GC\") = 1 Then Exit Sub\n    If InStr(1, Cells(i, \"A\").Value, \"UD\") = 1 Then Exit Sub\n    If InStr(1, Cells(i, \"A\").Value, \"UG\") = 1 Then Exit Sub\n    If InStr(1, Cells(i, \"A\").Value, \"UB\") = 1 Then Exit Sub\n    If InStr(1, Cells(i, \"A\").Value, \"UK\") = 1 Then Exit Sub\n    If InStr(1, Cells(i, \"A\").Value, \"B\") = 1 Then Exit Sub\n\n    Cells(i, \"A\").EntireRow.Delete\n\nEnd Sub\n</code></pre>\n\n<p>Regard.</p>\n"}], "owner": {"reputation": 454, "user_id": 6320022, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/10205374177708738/picture?type=large", "display_name": "Daniel Via&#241;o", "link": "https://stackoverflow.com/users/6320022/daniel-via%c3%b1o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "closed_date": 1506551684, "accepted_answer_id": 46452777, "answer_count": 2, "score": -2, "last_activity_date": 1507059051, "creation_date": 1506522527, "last_edit_date": 1506528667, "question_id": 46450505, "link": "https://stackoverflow.com/questions/46450505/removing-rows-with-value-different-to-a-list", "closed_reason": "Needs more focus", "title": "Removing rows with value different to a list", "body": "<p>I have 4 excel files with around 2000 rows each.\nIn A column, I have several 4 characters strings.</p>\n\n<p>I want to remove all the rows except the ones with codes starting with:</p>\n\n<p>E, L, GC, UD, UG, UB, UK, B</p>\n\n<p>There are too many for filtering one by one, I guess a macro would be a better solution.</p>\n\n<p>My code is this one, but it is just leaving the B values instead of all the interesting ones:</p>\n\n<pre><code>ActiveSheet.Range(\"$A$1:$A$1379\").AutoFilter Field:=1, Criteria1:=Array(\"=E*\", _\n    \"=GC*\", \"=UD*\", _\n    \"=UG*\", \"=UB*\", _\n    \"=UK*\", \"=B*\"), _\n    Operator:=xlOr\n</code></pre>\n\n<p>How would you do it?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2960, "user_id": 2099119, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/y8nHi.png?s=128&g=1", "display_name": "waka", "link": "https://stackoverflow.com/users/2099119/waka"}, "edited": false, "score": 0, "creation_date": 1506522487, "post_id": 46450447, "comment_id": 79856603, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/24652537/run-time-error-1004\">Run-time error 1004</a>"}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1506523838, "post_id": 46450807, "comment_id": 79857615, "body": "Alternatively use sheet names in the formula directly: <code>Selection.Formula = &quot;=IFERROR(VLOOKUP(&#39;Sheet1(CT)&#39;!$E$2,&#39;[Cycle time list of products.xls]Sheet1&#39;!$A$1:$C$300,3,FALSE),0)&quot;</code>"}, {"owner": {"reputation": 11, "user_id": 8683746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed9d038ebc57da0fd4c6c48f3e02eb0b?s=128&d=identicon&r=PG&f=1", "display_name": "Mads.R", "link": "https://stackoverflow.com/users/8683746/mads-r"}, "edited": false, "score": 0, "creation_date": 1506524063, "post_id": 46450807, "comment_id": 79857749, "body": "So I did this and now is says: Run-time error &#39;9&#39;: Subscript out of range"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 11, "user_id": 8683746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed9d038ebc57da0fd4c6c48f3e02eb0b?s=128&d=identicon&r=PG&f=1", "display_name": "Mads.R", "link": "https://stackoverflow.com/users/8683746/mads-r"}, "edited": false, "score": 0, "creation_date": 1506524380, "post_id": 46450807, "comment_id": 79857965, "body": "@Mads.R Check the sheet names and workbook names as spelled correctly."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 11, "user_id": 8683746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed9d038ebc57da0fd4c6c48f3e02eb0b?s=128&d=identicon&r=PG&f=1", "display_name": "Mads.R", "link": "https://stackoverflow.com/users/8683746/mads-r"}, "edited": false, "score": 2, "creation_date": 1506524460, "post_id": 46450807, "comment_id": 79858025, "body": "Also this assumes that the workbook <code>&quot;Cycle time list of products.xls&quot;</code> is open.  If it is closed then you will need to open it. @Mads.R"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 4, "last_activity_date": 1506523688, "last_edit_date": 1506523688, "creation_date": 1506523386, "answer_id": 46450807, "question_id": 46450447, "link": "https://stackoverflow.com/questions/46450447/excel-macro-run-time-error-1004/46450807#46450807", "title": "Excel Macro: Run-time Error 1004", "body": "<p>you have way too many <code>\"</code> and you are not properly concatenating the formula with vba:</p>\n\n<pre><code>.Formula = \"=IFERROR(VLOOKUP(\" &amp; ActiveWorkbook.Sheets(\"Sheet1(CT)\").Range(\"E2\").Address(0,0,,1) &amp; \",\" &amp; Workbooks(\"Cycle time list of products.xls\").Sheets(\"Sheet1\").Range(\"A1:C300\").Address(1,1,,1) &amp; \",3,FALSE),0)\"\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8683746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed9d038ebc57da0fd4c6c48f3e02eb0b?s=128&d=identicon&r=PG&f=1", "display_name": "Mads.R", "link": "https://stackoverflow.com/users/8683746/mads-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 347, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1506525480, "creation_date": 1506522374, "last_edit_date": 1506525480, "question_id": 46450447, "link": "https://stackoverflow.com/questions/46450447/excel-macro-run-time-error-1004", "title": "Excel Macro: Run-time Error 1004", "body": "<p>I am making an Excel Macro, but keeps getting Run-time error 1004: on this piece of code. </p>\n\n<pre><code>FormulaR1C1 = \"=IFERROR(\"\"VLOOKUP(\"\"(Active.Workbook.Sheets(\"\"Sheet1(CT)\"\").Range(\"\"E2\"\")),Application.Goto Workbooks(\"\"Cycle time list of products.xls\"\").Sheets(\"\"Sheet1\"\").Range(\"\"A1:C300\"\")\"\",\"\"3\"\",\"\"FALSE\"\")\"\",0)\"\n</code></pre>\n"}, {"tags": ["regex", "vba", "excel"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 3, "creation_date": 1506522254, "post_id": 46450331, "comment_id": 79856454, "body": "You can use the built-in Excel &quot;Text to Columns&quot; and that will split it properly. No VBA needed."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1506522598, "post_id": 46450331, "comment_id": 79856682, "body": "@braX - if I understand the OP, which I may not, they don&#39;t want it split on commas inside quotes so &quot;likes apples, oranges and plums&quot; should be left alone."}, {"owner": {"reputation": 23, "user_id": 6108478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d959c8041b11c9d40209de0e231d7f70?s=128&d=identicon&r=PG&f=1", "display_name": "Otto Kopp", "link": "https://stackoverflow.com/users/6108478/otto-kopp"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1506522775, "post_id": 46450331, "comment_id": 79856812, "body": "@SJR - this is absolutely true, sorry for being unclear."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1506522983, "post_id": 46450331, "comment_id": 79856975, "body": "OK, are the quoted/non-quoted bits of text intermingled randomly or is there a pattern?"}, {"owner": {"reputation": 23, "user_id": 6108478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d959c8041b11c9d40209de0e231d7f70?s=128&d=identicon&r=PG&f=1", "display_name": "Otto Kopp", "link": "https://stackoverflow.com/users/6108478/otto-kopp"}, "edited": false, "score": 0, "creation_date": 1506523324, "post_id": 46450331, "comment_id": 79857219, "body": "the pattern is pretty much what I tried to convey in my OP. it starts with an ID, then it goes through a bunch of tags which are all within double quotation marks and ends with a comment, which is also in double quotation and the only way a comma can actually appear within double quotation. The comment is user input and could be anything."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1506523524, "post_id": 46450331, "comment_id": 79857363, "body": "In that case why not split on <code>,&quot;</code> and then remove any extraneous quote marks at the end with replace?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1506523611, "post_id": 46450331, "comment_id": 79857439, "body": "@SJR Text to columns handles that - it assumes the quote to be a text qualifier by default and will not split on commas within them."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1506523763, "post_id": 46450331, "comment_id": 79857562, "body": "@Rory - the light dawns, thanks. First comment solved it after all (I take it all back @braX)"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1506523787, "post_id": 46450331, "comment_id": 79857583, "body": "Text to Columns will do what you want, differently than the split function."}, {"owner": {"reputation": 23, "user_id": 6108478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d959c8041b11c9d40209de0e231d7f70?s=128&d=identicon&r=PG&f=1", "display_name": "Otto Kopp", "link": "https://stackoverflow.com/users/6108478/otto-kopp"}, "edited": false, "score": 0, "creation_date": 1506525106, "post_id": 46450331, "comment_id": 79858468, "body": "Awesome, this totally solves it. Thank you. How do you flag a post as &quot;solved in comments&quot;? :)"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1506525418, "post_id": 46450331, "comment_id": 79858664, "body": "You can&#39;t, can only ask @braX to post that as an answer."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1506525714, "post_id": 46450331, "comment_id": 79858876, "body": "@Otto I added it as an answer for you."}], "answers": [{"comments": [{"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1506528891, "post_id": 46451006, "comment_id": 79860987, "body": "<a href=\"https://regex101.com/r/obs8ID/1\" rel=\"nofollow noreferrer\">Output</a> of a test, so it seems it is working, however, a <code>&quot;</code> was deleted to work, so in Excel does it have to be doubled <code>&quot;&quot;</code> to recognize <code>&quot;</code>?"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 1, "creation_date": 1506531365, "post_id": 46451006, "comment_id": 79862315, "body": "That&#39;s correct. To input a double quote, you need to double the double quote. :)"}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 1, "last_activity_date": 1506523895, "creation_date": 1506523895, "answer_id": 46451006, "question_id": 46450331, "link": "https://stackoverflow.com/questions/46450331/replace-all-characters-in-a-string-unless-they-are-within-double-quotes/46451006#46451006", "title": "Replace all characters in a String, unless they are within double quotes", "body": "<p>Please give this a try and see if you get the desired output.</p>\n\n<p>Tweak the variables if required.</p>\n\n<pre><code>Sub SplittingStringsUsingRegEx()\nDim lr As Long, c As Long\nDim Rng As Range, cell As Range\nDim RE, Match, Matches\n\nApplication.ScreenUpdating = False\nlr = Cells(Rows.Count, 1).End(xlUp).Row\nSet Rng = Range(\"A1:A\" &amp; lr)\n\nSet RE = CreateObject(\"VBScript.RegExp\")\nWith RE\n    .Global = True\n    .Pattern = \"\\d+|\"\".+?\"\"\"\nEnd With\n\nc = 2\n\nFor Each cell In Rng\n    If RE.test(cell.Value) Then\n        Set Matches = RE.Execute(cell.Value)\n        For Each Match In Matches\n            Cells(cell.Row, c) = Replace(Match, \"\"\"\", \"\")\n            c = c + 1\n        Next Match\n    End If\n    c = 2\nNext cell\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1506524781, "creation_date": 1506524781, "answer_id": 46451335, "question_id": 46450331, "link": "https://stackoverflow.com/questions/46450331/replace-all-characters-in-a-string-unless-they-are-within-double-quotes/46451335#46451335", "title": "Replace all characters in a String, unless they are within double quotes", "body": "<p>Without <em>Regex</em>:</p>\n\n<p>We need to \"protect\" commas that are encapsulated with double quotes:</p>\n\n<pre><code>Sub ProtectStuff()\n    Dim i As Long, N As Long, v As String, v2 As String\n    Dim ProtectMode As Boolean, DQ As String, rep As String\n    Dim CH As String, arr\n\n    DQ = \"\"\"\"\n    rep = Chr(1)\n    N = Cells(Rows.Count, \"A\").End(xlUp).Row\n\n    For i = 1 To N\n        v = Cells(i, \"A\").Value\n        If v &lt;&gt; \"\" Then\n            ProtectMode = False\n            v2 = \"\"\n            For j = 1 To Len(v)\n                CH = Mid(v, j, 1)\n                If CH = DQ Then ProtectMode = Not ProtectMode\n                If CH = \",\" And ProtectMode Then CH = rep\n                v2 = v2 &amp; CH\n            Next j\n        End If\n\n        arr = Split(v2, \",\")\n        j = 2\n        For Each a In arr\n            Cells(i, j) = Replace(a, rep, \",\")\n            j = j + 1\n        Next a\n    Next i\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/16RYy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/16RYy.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1506525458, "creation_date": 1506525458, "answer_id": 46451567, "question_id": 46450331, "link": "https://stackoverflow.com/questions/46450331/replace-all-characters-in-a-string-unless-they-are-within-double-quotes/46451567#46451567", "title": "Replace all characters in a String, unless they are within double quotes", "body": "<p>Text to Columns will do what you want, differently than the split function.</p>\n"}], "owner": {"reputation": 23, "user_id": 6108478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d959c8041b11c9d40209de0e231d7f70?s=128&d=identicon&r=PG&f=1", "display_name": "Otto Kopp", "link": "https://stackoverflow.com/users/6108478/otto-kopp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 1, "answer_count": 3, "score": 2, "last_activity_date": 1506525458, "creation_date": 1506522025, "last_edit_date": 1531164843, "question_id": 46450331, "link": "https://stackoverflow.com/questions/46450331/replace-all-characters-in-a-string-unless-they-are-within-double-quotes", "title": "Replace all characters in a String, unless they are within double quotes", "body": "<p>I am sadly unfamiliar with regular expressions since I'm not a programmer, but I would guess this problem is easily solvable using regex (I am definitely open to other suggestions, though)</p>\n\n<p>I want to use the split function to split the value of a cell and spread it out over multiple cells. The delimiter is a comma. The problem though is that some users use commas in comments for example, which the Split function uses to split the string mid-comment.</p>\n\n<p>for example a cell containing the value:</p>\n\n<blockquote>\n  <p>0001,\"name\",\"address\",\"likes apples, oranges\n  and plums\"</p>\n</blockquote>\n\n<p>needs to be split into multiple cells saying 0001 \"name\" \"address\" and \"likes apples, oranges and plums\".</p>\n\n<p>my code splits the comment as well, and I want it to ignore the comment or everything else withing double quotes. here is a sample:</p>\n\n<pre><code>Sub SplittingStrings()\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim strInput As String\n    Dim counter As Integer\n    Dim cell As Variant\n    Dim splitCount As Integer\n    Dim splitString() As String\n    Dim category As Variant\n\n    Set wb = ActiveWorkbook\n    Set ws = wb.ActiveSheet\n\n    counter = 1\n\n    For Each cell In Range(\"A1\", \"A2000\")\n\n        If cell.Value &lt;&gt; \"\" Then\n            strInput = cell.Value\n            splitCount = 2\n            splitString = Split(strInput, \",\")\n\n            For Each category In splitString\n                Cells(counter, splitCount).Value = category\n                splitCount = splitCount + 1\n            Next category\n        End If\n\n        counter = counter + 1\n\n    Next cell\n\n\nEnd Sub\n</code></pre>\n\n<p>how do I exclude stuff withing the double quotes from being considered by the split function?</p>\n"}, {"tags": ["excel", "vba", "loops", "offset"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1506521549, "post_id": 46450043, "comment_id": 79855949, "body": "For starters, it looks like you&#39;re missing an <code>End If</code> in your loop."}, {"owner": {"reputation": 424, "user_id": 7676648, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/MKp0t.jpg?s=128&g=1", "display_name": "Apurv Pawar", "link": "https://stackoverflow.com/users/7676648/apurv-pawar"}, "edited": false, "score": 0, "creation_date": 1506521817, "post_id": 46450043, "comment_id": 79856152, "body": "also, .Cells(i + 1, &quot;H&quot;).Value = .Cells(i + 1, &quot;F&quot;).Value will get values in H Col. And why you are checking i and entering data in i+1.Is that the requirement"}], "answers": [{"tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": true, "score": 1, "last_activity_date": 1506522531, "last_edit_date": 1506522531, "creation_date": 1506522193, "answer_id": 46450394, "question_id": 46450043, "link": "https://stackoverflow.com/questions/46450043/vba-code-that-will-look-for-certain-criteria-and-if-it-matches-place-data-from-a/46450394#46450394", "title": "VBA code that will look for certain criteria and if it matches place data from a different column into a another one", "body": "<p>Try this</p>\n\n<pre><code>Sub Demo()\n    Dim ws As Worksheet\n    Dim cel As Range, fCell As Range, lCell As Range\n    Dim lastRow As Long\n    Dim flag As Boolean\n\n    Set ws = ThisWorkbook.Sheets(\"Sheet4\")      'change Sheet4 to your data sheet\n    flag = False\n\n    With ws\n        lastRow = .Cells(.Rows.Count, \"C\").End(xlUp).Row    'last row with data in Column C\n\n        For Each cel In .Range(\"C2:C\" &amp; lastRow)   'loop through each cell in Column C\n            If UCase(cel.Value) = \"CIRCUM + SPA\" Then   'check if Command Name is \"CIRCUM + SPA\"\n                If cel.Offset(, 1).Value = 100 Then     'check if SP is 100\n                    Set fCell = cel.Offset(1, 0)        'set first cell to be copied in fCell\n                    flag = True\n                ElseIf cel.Offset(, 1).Value = 0 Then   'check if SP is 0\n                    If flag Then                        'move ahead only if (\"CIRCUM + SPA\" &amp; 100) already found\n                        Set lCell = cel.Offset(-1, 0)   'set last cell to be copied in lCell\n                        Set rng = .Range(fCell, lCell).Offset(, 3)  'set range using fCell and lCell\n                        rng.Cut rng.Offset(, 2)         'move data from Column F to Column H\n                        flag = False\n                    End If\n                End If\n            End If\n        Next cel\n    End With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/9VS91.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9VS91.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 15, "user_id": 8663150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a7d4e7bbcd99792e6c48a66ecda7e89?s=128&d=identicon&r=PG&f=1", "display_name": "TrB2222", "link": "https://stackoverflow.com/users/8663150/trb2222"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 46450394, "answer_count": 1, "score": 1, "last_activity_date": 1506526173, "creation_date": 1506521225, "last_edit_date": 1506526173, "question_id": 46450043, "link": "https://stackoverflow.com/questions/46450043/vba-code-that-will-look-for-certain-criteria-and-if-it-matches-place-data-from-a", "title": "VBA code that will look for certain criteria and if it matches place data from a different column into a another one", "body": "<p>I need help with a VBA code that will look for certain criteria and if it matches place data from a different column into a another one. </p>\n\n<p>If column C says \"Circum + spa\" and D says \"100\" then the values in row F need to move over two columns to H \nuntil column C says \"Circum + spa\" and D says \"0\" (where it will stay in column F.) \nfinished result will looks like a snake.</p>\n\n<p>The code I have started with this process with is: </p>\n\n<pre><code>    Dim l As Long\n    With ActiveSheet\n        l = .Cells(.Rows.Count, \"C\").End(xlUp).Row\n        For i = 1 To l\n            If .Cells(i, \"C\").Value2 = \"CIRCUM + SPA\" And \n            .Cells(i, \"D\") = \"100\" Then\n            .Cells(i + 1, \"F\").Value = .Cells(i + 1, \"H\").Value\n        Next\n    End With\n</code></pre>\n\n<p>But currently it just makes one row down in column F empty... I have also attempted cut/paste and an offset but all I get are error messages.</p>\n\n<p>I also know that using +1 isn't going to work in final result because I need it to grab everything until the other condition is met.</p>\n\n<p>I have not started on that yet, but would appreciate any advise on a Do-Until loop. </p>\n\n<p>I have attached pictures of what my worksheet looks like now vs what I need it to look like after the macro runs. Also, the rows that move will not always contain 4 cells, sometimes there will be more that's why I need the do until rather than a set range.</p>\n\n<p><a href=\"https://i.stack.imgur.com/fRRaw.jpg\" rel=\"nofollow noreferrer\">before</a>[1]\n<a href=\"https://i.stack.imgur.com/FrDOB.jpg\" rel=\"nofollow noreferrer\">after</a> (2)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 2, "creation_date": 1506521815, "post_id": 46449965, "comment_id": 79856147, "body": "So are you asking how to find the last row?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1506521850, "post_id": 46449965, "comment_id": 79856173, "body": "<code>lLastRow = ActiveSheet.Cells(ActiveSheet.Rows.Count, 1).End(xlUp).Row</code>"}, {"owner": {"reputation": 117, "user_id": 8258717, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/52a918937aa43687810cca7fc265e9a1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/8258717/dan"}, "reply_to_user": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1506524947, "post_id": 46449965, "comment_id": 79858362, "body": "@danieltakeshi from the link I have worked out how to do the last row, how do I only apply this to sheets renamed from 2-20?"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1506527942, "post_id": 46449965, "comment_id": 79860369, "body": "To apply your code only to sheets with a particular number in their name you could do something like <code>If IsNumeric(i.Name) Then</code> and then <code>If CInt(i.Name) &gt;= 2 And CInt(i.Name) &lt;= 20 Then</code>."}], "answers": [{"tags": [], "owner": {"reputation": 561, "user_id": 8558614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2h6yS.jpg?s=128&g=1", "display_name": "Nikolaos Polygenis", "link": "https://stackoverflow.com/users/8558614/nikolaos-polygenis"}, "is_accepted": false, "score": 0, "last_activity_date": 1506532914, "last_edit_date": 1506532914, "creation_date": 1506525015, "answer_id": 46451406, "question_id": 46449965, "link": "https://stackoverflow.com/questions/46449965/vba-to-select-last-row-in-print-layout-then-paste-value-in-it-and-loop-over-a-s/46451406#46451406", "title": "VBA to Select last row in print layout, then paste value in it and loop over a selected number of sheets (the bottom line is a varible.)", "body": "<p>We suppose that the rows you want to copy are in the sheet1(<code>Sheet1.Rows(\"1:3\")</code>), </p>\n\n<p>run <code>Sub CallAll</code></p>\n\n<p>( i have used this reference: <a href=\"https://www.rondebruin.nl/win/s9/win005.htm\" rel=\"nofollow noreferrer\">https://www.rondebruin.nl/win/s9/win005.htm</a>)</p>\n\n<pre><code>Option Explicit\n\n\nSub CallAll()\n\ncopy_rows\nprotect_unprotect\n\nEnd Sub\n\n\n\nSub copy_rows()\n\n    Sheet1.Rows(\"1:3\").Select\n    Selection.Copy\n\nEnd Sub\n\nSub protect_unprotect()\n\nDim i As Worksheet\n\n\nFor Each i In ThisWorkbook.Sheets\n  If i.ProtectContents = True Then\n  i.Unprotect Password:=\"Password\"\n  copy_rows\n  End If\nNext\n\n\nFor Each i In ThisWorkbook.Sheets\n\ni.Activate\nCall LastRow_Example(i)\n\nNext\n\n\nFor Each i In ThisWorkbook.Sheets\n\nIf i.ProtectContents = False Then\n\ni.Protect Password:=\"Password\"\n\nEnd If\n\nNext\n\nEnd Sub\n\n\nSub LastRow_Example(sh As Worksheet)\n\n    Dim LastRow As Long\n    Dim rng As Range\n\n\n    ' Use all cells on the sheet\n    Set rng = sh.Cells\n\n\n    ' Find the last row\n    LastRow = Last(1, rng)\n\n    ' After the last row with data change the value of the cell in Column A\n\n\n\n    rng.Parent.Cells(LastRow + 1, 1).Select\n\n    ActiveSheet.Paste\n\nEnd Sub\n\nFunction Last(choice As Long, rng As Range)\n\n    Dim lrw As Long\n    Dim lcol As Long\n\n    Select Case choice\n\n    Case 1:\n        On Error Resume Next\n        Last = rng.Find(What:=\"*\", _\n                        After:=rng.Cells(1), _\n                        Lookat:=xlPart, _\n                        LookIn:=xlFormulas, _\n                        SearchOrder:=xlByRows, _\n                        SearchDirection:=xlPrevious, _\n                        MatchCase:=False).Row\n        On Error GoTo 0\n\n    Case 2:\n        On Error Resume Next\n        Last = rng.Find(What:=\"*\", _\n                        After:=rng.Cells(1), _\n                        Lookat:=xlPart, _\n                        LookIn:=xlFormulas, _\n                        SearchOrder:=xlByColumns, _\n                        SearchDirection:=xlPrevious, _\n                        MatchCase:=False).Column\n        On Error GoTo 0\n\n    Case 3:\n        On Error Resume Next\n        lrw = rng.Find(What:=\"*\", _\n                       After:=rng.Cells(1), _\n                       Lookat:=xlPart, _\n                       LookIn:=xlFormulas, _\n                       SearchOrder:=xlByRows, _\n                       SearchDirection:=xlPrevious, _\n                       MatchCase:=False).Row\n        On Error GoTo 0\n\n        On Error Resume Next\n        lcol = rng.Find(What:=\"*\", _\n                        After:=rng.Cells(1), _\n                        Lookat:=xlPart, _\n                        LookIn:=xlFormulas, _\n                        SearchOrder:=xlByColumns, _\n                        SearchDirection:=xlPrevious, _\n                        MatchCase:=False).Column\n        On Error GoTo 0\n\n        On Error Resume Next\n        Last = rng.Parent.Cells(lrw, lcol).Address(False, False)\n        If Err.Number &gt; 0 Then\n            Last = rng.Cells(1).Address(False, False)\n            Err.Clear\n        End If\n        On Error GoTo 0\n\n    End Select\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "is_accepted": true, "score": 0, "last_activity_date": 1506596875, "last_edit_date": 1506596875, "creation_date": 1506528286, "answer_id": 46452477, "question_id": 46449965, "link": "https://stackoverflow.com/questions/46449965/vba-to-select-last-row-in-print-layout-then-paste-value-in-it-and-loop-over-a-s/46452477#46452477", "title": "VBA to Select last row in print layout, then paste value in it and loop over a selected number of sheets (the bottom line is a varible.)", "body": "<p>To loop through the Sheets and get the last Row from column \"A\", use this code as Sample, for Sheets 2-22, using the name of those Sheets and NOT index:</p>\n\n<pre><code>Dim ws As Worksheet\nDim i As Long, lLastRow As Long\n\nFor i = 2 To 22 'From 2 to 22 named\n    Set ws = ThisWorkbook.Sheets(CStr(i))\n    lLastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row\n\n    Debug.Print ws.Name &amp; \" \" &amp; ws.Cells(lLastRow, 1).Address\nNext i\n</code></pre>\n\n<p>If you want to get the last row from all Sheets from the Workbook or using the index number, the pro of using the index number is that the Sheet name can vary.</p>\n\n<pre><code>Dim ws As Worksheet\nDim i As Long, lLastRow As Long\n\nFor i = 2 To ThisWorkbook.Sheets.Count 'For all Sheets or For i = 2 To 22 to end on 22\n    Set ws = ThisWorkbook.Sheets(i)\n    lLastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row\n\n    Debug.Print ws.Name &amp; \" \" &amp; ws.Cells(lLastRow, 1).Address\nNext i\n</code></pre>\n\n<p>So to paste something, you would paste on the next row, so use: <code>lLastRow+1</code></p>\n"}], "owner": {"reputation": 117, "user_id": 8258717, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/52a918937aa43687810cca7fc265e9a1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/8258717/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 280, "favorite_count": 0, "accepted_answer_id": 46452477, "answer_count": 2, "score": 0, "last_activity_date": 1506596875, "creation_date": 1506521038, "last_edit_date": 1506521391, "question_id": 46449965, "link": "https://stackoverflow.com/questions/46449965/vba-to-select-last-row-in-print-layout-then-paste-value-in-it-and-loop-over-a-s", "title": "VBA to Select last row in print layout, then paste value in it and loop over a selected number of sheets (the bottom line is a varible.)", "body": "<p>I have a number of sheets that all need the same three rows pasted in at the end of the document, the row number for the document end is different on every sheet.</p>\n\n<p>The sheets named 2-22, will need to be activated, un protected, the rows pasted at the end then re protected and looped to do the same for the next sheet.</p>\n\n<p>See below for code, as you will see there are gaps as I cant seem to find away to select the correct row and loop it for certain sheets not every sheet.</p>\n\n<pre><code>Dim i As Worksheet\nFor Each i In ThisWorkbook.Sheets\ni.Activate\n\nactivesheet.unprotect password:=\"Password\"\n\nselection.paste\n\nactivesheet.protect password:=\"Password\"\nNext i\n</code></pre>\n"}, {"tags": ["vba", "countif"], "comments": [{"owner": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 1, "creation_date": 1506520464, "post_id": 46449663, "comment_id": 79855140, "body": "How about replacing <code>CountIf(Range(&quot;M:M&quot;), &quot;Non Available&quot;)</code> with <code>Countifs(Range(M:M),&quot;Non Available&quot;,Range(M:M),&quot;To investigate&quot;)</code>. It is also a good idea to qualify(define) all of the ranges with a worksheet like: <code>Worksheets(&quot;Summary&quot;).Range(&quot;M:M&quot;)</code>"}, {"owner": {"reputation": 47, "user_id": 8155558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e527318c91c07920527b679e1a2cee56?s=128&d=identicon&r=PG&f=1", "display_name": "Jeofbist3", "link": "https://stackoverflow.com/users/8155558/jeofbist3"}, "reply_to_user": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 0, "creation_date": 1506521181, "post_id": 46449663, "comment_id": 79855665, "body": "thanks already! and what about the code line If Cell = &quot;Non Available&quot; Then ? Should I put If Cell = &quot;Non Available&quot; or &quot;To investigate&quot; Then ?"}, {"owner": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 0, "creation_date": 1506521315, "post_id": 46449663, "comment_id": 79855778, "body": "<code>If Cell = &quot;Non Available&quot; or Cell = &quot;To investigate&quot;</code> should work"}], "answers": [{"comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1506521970, "post_id": 46450163, "comment_id": 79856263, "body": "<code>COUNTIFS</code> will not work for two different criteria in the <i>same</i> column."}, {"owner": {"reputation": 179, "user_id": 7684046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/527159e9ffe0426a59486efdebaa278b?s=128&d=identicon&r=PG&f=1", "display_name": "Lincoln", "link": "https://stackoverflow.com/users/7684046/lincoln"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1506522283, "post_id": 46450163, "comment_id": 79856476, "body": "@Rory You are right. See the code: I think it is possible only <code>COUNTIF</code>"}, {"owner": {"reputation": 47, "user_id": 8155558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e527318c91c07920527b679e1a2cee56?s=128&d=identicon&r=PG&f=1", "display_name": "Jeofbist3", "link": "https://stackoverflow.com/users/8155558/jeofbist3"}, "edited": false, "score": 0, "creation_date": 1506523131, "post_id": 46450163, "comment_id": 79857086, "body": "@Lincoln : why did you put the sign + between the &#39;Application.WorksheetFunctionCountif&#39; in the Do  While ? And, should I also put the line  Cell.EntireRow.Copy Destination:=Worksheets(&quot;Summar... just under the line Case Cell = &quot;To Investigate&quot; ? Thanks"}, {"owner": {"reputation": 179, "user_id": 7684046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/527159e9ffe0426a59486efdebaa278b?s=128&d=identicon&r=PG&f=1", "display_name": "Lincoln", "link": "https://stackoverflow.com/users/7684046/lincoln"}, "reply_to_user": {"reputation": 47, "user_id": 8155558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e527318c91c07920527b679e1a2cee56?s=128&d=identicon&r=PG&f=1", "display_name": "Jeofbist3", "link": "https://stackoverflow.com/users/8155558/jeofbist3"}, "edited": false, "score": 1, "creation_date": 1506527268, "post_id": 46450163, "comment_id": 79859931, "body": "@Jeofbist3 As it was mentioned by Rory it is not possible to countif same column by two criteria. Hence, use + to add two countif with two one criteria each"}, {"owner": {"reputation": 179, "user_id": 7684046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/527159e9ffe0426a59486efdebaa278b?s=128&d=identicon&r=PG&f=1", "display_name": "Lincoln", "link": "https://stackoverflow.com/users/7684046/lincoln"}, "reply_to_user": {"reputation": 47, "user_id": 8155558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e527318c91c07920527b679e1a2cee56?s=128&d=identicon&r=PG&f=1", "display_name": "Jeofbist3", "link": "https://stackoverflow.com/users/8155558/jeofbist3"}, "edited": false, "score": 1, "creation_date": 1506528456, "post_id": 46450163, "comment_id": 79860722, "body": "@Jeofbist3 also if you have lot of formulas in file don&#39;t forget to turn of <a href=\"https://answers.microsoft.com/en-us/msoffice/forum/msoffice_excel-mso_winother/applicationcalculation-xlcalculationautomatic/dad23ef7-dcaf-4eeb-8419-9d5427ea338f?auth=1\" rel=\"nofollow noreferrer\">Calculations</a> and <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/application-screenupdating-property-excel\" rel=\"nofollow noreferrer\">screen updating</a>"}], "tags": [], "owner": {"reputation": 179, "user_id": 7684046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/527159e9ffe0426a59486efdebaa278b?s=128&d=identicon&r=PG&f=1", "display_name": "Lincoln", "link": "https://stackoverflow.com/users/7684046/lincoln"}, "is_accepted": false, "score": 2, "last_activity_date": 1506528218, "last_edit_date": 1506528218, "creation_date": 1506521552, "answer_id": 46450163, "question_id": 46449663, "link": "https://stackoverflow.com/questions/46449663/vba-add-argument-in-countif/46450163#46450163", "title": "VBA - add argument in countif", "body": "<p>As @Victor K suggests try using countifs and don't forget to add condition to if regarding 'To investigate'</p>\n\n<pre><code>Sub removing_rows()\nDim Check As Range, lastrow As Long, lastrow2 As Long\nlastrow = Worksheets(\"Summary\").UsedRange.Rows.Count\nlastrow2 = Worksheets(\"Summarybis\").UsedRange.Rows.Count\n\nDo While ((Application.WorksheetFunction.CountIf(Range(\"M:M\"), \"Non Available\") + Application.WorksheetFunction.CountIf(Range(\"M:M\"), \"To investigate\")) &gt; 0)\nSet Check = Sheets(\"Summary\").Range(\"M1:M\" &amp; lastrow)\nFor Each Cell In Check\nSelect Case True\n    Case Cell = \"Non Available\"\n    Cell.EntireRow.Copy Destination:=Worksheets(\"Summarybis\").Range(\"A\" &amp; lastrow2 + 1)\n    Cell.EntireRow.Delete\n    lastrow2 = lastrow2 + 1\n    Case Cell = \"To Investigate\"\n    Cell.EntireRow.Copy Destination:=Worksheets(\"Summarybis\").Range(\"A\" &amp; lastrow2 + 1)\n    Cell.EntireRow.Delete\n    lastrow2 = lastrow2 + 1\nEnd Select\nNext\nLoop\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 47, "user_id": 8155558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e527318c91c07920527b679e1a2cee56?s=128&d=identicon&r=PG&f=1", "display_name": "Jeofbist3", "link": "https://stackoverflow.com/users/8155558/jeofbist3"}, "is_accepted": false, "score": 0, "last_activity_date": 1506525944, "creation_date": 1506525944, "answer_id": 46451718, "question_id": 46449663, "link": "https://stackoverflow.com/questions/46449663/vba-add-argument-in-countif/46451718#46451718", "title": "VBA - add argument in countif", "body": "<p>I wasn't very clear on one point : I also want to delete the rows with values 'To investigate' from sheet 'Summary' in column M and also put them in sheet 'Summarybis'.</p>\n\n<p>I've tried the following (based on Lincoln's answer): </p>\n\n<pre><code>Sub removing_rows()\nDim Check As Range, lastrow As Long, lastrow2 As Long\nlastrow = Worksheets(\"Summary\").UsedRange.Rows.Count\nlastrow2 = Worksheets(\"Summarybis\").UsedRange.Rows.Count\nIf lastrow2 = 1 Then\nlastrow2 = 0\nElse\nEnd If\nDo While ((Application.WorksheetFunction.CountIf(Range(\"M:M\"), \"Non Available\") + Application.WorksheetFunction.CountIf(Range(\"M:M\"), \"To investigate\")) &gt; 0)\nSet Check = Range(\"M2:M\" &amp; lastrow)\nFor Each Cell In Check\nSelect Case True\n    Case Cell = \"Non Available\"\n    Cell.EntireRow.Copy Destination:=Worksheets(\"Summarybis\").Range(\"A\" &amp; lastrow2 + 1)\n    Cell.EntireRow.Delete\n    lastrow2 = lastrow2 + 1\n    Case Cell = \"To Investigate\"\n    Cell.EntireRow.Copy Destination:=Worksheets(\"Summarybis\").Range(\"A\" &amp; lastrow2 + 1)\n    Cell.EntireRow.Delete\n    lastrow2 = lastrow2 + 1\nEnd Select\nNext\nLoop\nEnd Sub\n</code></pre>\n\n<p>But Excel is freezing and no output is given.. Anyone has an idea? :)</p>\n"}, {"tags": [], "owner": {"reputation": 179, "user_id": 7684046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/527159e9ffe0426a59486efdebaa278b?s=128&d=identicon&r=PG&f=1", "display_name": "Lincoln", "link": "https://stackoverflow.com/users/7684046/lincoln"}, "is_accepted": false, "score": 0, "last_activity_date": 1509231684, "creation_date": 1509231684, "answer_id": 46995335, "question_id": 46449663, "link": "https://stackoverflow.com/questions/46449663/vba-add-argument-in-countif/46995335#46995335", "title": "VBA - add argument in countif", "body": "<p>Please find corrected version of code, if you still need it:</p>\n\n<pre><code>Option Explicit\n\nSub removing_rows()\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n\nDim Check As Range, cell As Range\nDim rngS As Worksheet, rngSbis As Worksheet\nDim lastrow As Long, lastrow2 As Long, i As Long\nDim ro() As Integer, drow As Integer\nConst key_word1 = \"TO INVESTIGATE\"\nConst key_word2 = \"NON AVAILABLE\"\n\nSet rngS = ThisWorkbook.Worksheets(\"Summary\")\nSet rngSbis = ThisWorkbook.Worksheets(\"Summarybis\")\n\n'Storing last rows to the varibles for future use\nlastrow = rngS.UsedRange.Rows.Count + 1\n\nReDim Preserve ro(lastrow)\ni = 0\n'Copy of all rows that contains key words to the 'S' tab\nSet Check = rngS.Range(\"M2:M\" &amp; lastrow)\nFor Each cell In Check\nSelect Case True\n    Case UCase(cell.Value2) = key_word2\n    cell.EntireRow.Copy\n    rngSbis.Cells(rngSbis.Rows.Count, 1).End(xlUp).Offset(1).PasteSpecial xlPasteValues\n    ro(i) = cell.Row\n    i = i + 1\n    Case UCase(cell.Value2) = key_word1\n    cell.EntireRow.Copy\n    rngSbis.Cells(rngSbis.Rows.Count, 1).End(xlUp).Offset(1).PasteSpecial xlPasteValues\n    ro(i) = cell.Row\n    i = i + 1\nEnd Select\nNext\n'Deleting all rows with key words\nFor i = UBound(ro) To LBound(ro) Step -1\n    On Error Resume Next\n    rngS.Rows(ro(i)).Delete\nNext i\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 8155558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e527318c91c07920527b679e1a2cee56?s=128&d=identicon&r=PG&f=1", "display_name": "Jeofbist3", "link": "https://stackoverflow.com/users/8155558/jeofbist3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1509231684, "creation_date": 1506520294, "question_id": 46449663, "link": "https://stackoverflow.com/questions/46449663/vba-add-argument-in-countif", "title": "VBA - add argument in countif", "body": "<p>The code below aims to remove every row when the value in column M is 'Non Available' from sheet 'Summary' and put the entire row in another sheet 'Summarybis'. I'd like to add one argument in the countif function such as also removing every row with value in column M as 'To investigate'. How can I do except by creating a new code and replacing what I need? </p>\n\n<pre><code>Sub removing_rows()\nDim Check As Range, lastrow As Long, lastrow2 As Long\nlastrow = Worksheets(\"Summary\").UsedRange.Rows.Count\nlastrow2 = Worksheets(\"Summarybis\").UsedRange.Rows.Count\nIf lastrow2 = 1 Then\nlastrow2 = 0\nElse\nEnd If\nDo While Application.WorksheetFunction.CountIf(Range(\"M:M\"), \"Non Available\") &gt; 0\nSet Check = Range(\"M2:M\" &amp; lastrow)\nFor Each Cell In Check\n    If Cell = \"Non Available\" Then\n        Cell.EntireRow.Copy Destination:=Worksheets(\"Summarybis\").Range(\"A\" &amp; lastrow2 + 1)\n        Cell.EntireRow.Delete\n        lastrow2 = lastrow2 + 1\n        Else:\n    End If\nNext\nLoop\nEnd Sub\n</code></pre>\n\n<p>Finally, I think the above code is not entirely defined because it may happen that no output is produced (nothing is filled in sheet 'Summarybis'). What am I missing?</p>\n\n<p>Thank you so much in advance ! :)</p>\n"}, {"tags": ["excel", "vba", "variables", "range", "selection"], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1506520170, "post_id": 46449601, "comment_id": 79854901, "body": "beat me be seconds."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1506520251, "post_id": 46449601, "comment_id": 79854958, "body": "FWIW; @Ji\u0159&#237;Jezdinsk&#253; one should avoid using <code>.Select</code> and just do the action wanted. ie <code>Sheets(&quot;Sim&quot;).Range(&quot;A&quot; &amp; x &amp; &quot;:B&quot; &amp; y).Copy</code>"}, {"owner": {"reputation": 5, "user_id": 8400017, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-HYgmi91Xbzw/AAAAAAAAAAI/AAAAAAAAAG0/NsyGixjI2Gg/photo.jpg?sz=128", "display_name": "Ji\u0159&#237; Jezdinsk&#253;", "link": "https://stackoverflow.com/users/8400017/ji%c5%99%c3%ad-jezdinsk%c3%bd"}, "edited": false, "score": 0, "creation_date": 1506576942, "post_id": 46449601, "comment_id": 79878011, "body": "Thanks for the solution (I just totally forgot about another &amp;). And also thanks for the select notice."}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": true, "score": 2, "last_activity_date": 1506520144, "creation_date": 1506520144, "answer_id": 46449601, "question_id": 46449578, "link": "https://stackoverflow.com/questions/46449578/vba-select-range-with-two-variables/46449601#46449601", "title": "VBA Select range with two variables", "body": "<p>You left out an ampersand....</p>\n\n<pre><code>Sheets(\"Sim\").Range(\"A\" &amp; x &amp; \":B\" &amp; y).Select\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 8400017, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-HYgmi91Xbzw/AAAAAAAAAAI/AAAAAAAAAG0/NsyGixjI2Gg/photo.jpg?sz=128", "display_name": "Ji\u0159&#237; Jezdinsk&#253;", "link": "https://stackoverflow.com/users/8400017/ji%c5%99%c3%ad-jezdinsk%c3%bd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6972, "favorite_count": 0, "accepted_answer_id": 46449601, "answer_count": 1, "score": 0, "last_activity_date": 1506520144, "creation_date": 1506520076, "question_id": 46449578, "link": "https://stackoverflow.com/questions/46449578/vba-select-range-with-two-variables", "title": "VBA Select range with two variables", "body": "<p>I am trying to select range. I have no problem selecting it with variable, lets say x and y are variables. I have no problem writing code to select range from e.g. <code>A1:By</code>. But How do I select a range from <code>Ax:By</code> ? Is there simple one line solution to this?</p>\n\n<p>Thanks in advance for help</p>\n\n<p>My code for A1:By which works</p>\n\n<pre><code>Sheets(\"Sim\").Range(\"A1:B\" &amp; y).Select\n</code></pre>\n\n<p>My made code from Ax:By which does not work</p>\n\n<pre><code>Sheets(\"Sim\").Range(\"A\" &amp; x \":B\" &amp; y).Select\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1506519877, "post_id": 46449389, "comment_id": 79854655, "body": "<code>Myarr = ActiveSheet.Range(&quot;S6, U6, W6&quot;)</code> is loading the array with  only one value, the value in S6"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1506519917, "post_id": 46449389, "comment_id": 79854694, "body": "Can you not accomplish this with a simple formula? Why do you need VBA?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1506519956, "post_id": 46449389, "comment_id": 79854725, "body": "@braX <code>Selection.PasteSpecial xlPasteFormats</code> one cannot copy formats with formulas."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1506519982, "post_id": 46449389, "comment_id": 79854749, "body": "What are you trying to accomplish with this code?"}, {"owner": {"reputation": 37, "user_id": 8683363, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155752200597938/picture?type=large", "display_name": "Desmond Teoh", "link": "https://stackoverflow.com/users/8683363/desmond-teoh"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1506520280, "post_id": 46449389, "comment_id": 79854982, "body": "@ScottCraner craner im actually developing a macro and this code is actually copying a cell format from <i>D6</i> cell and paste it to multiple cells in this case i tried to use array.. and i want to paste to the last row of my data set and yes i do notice it only return with the value in S6.."}, {"owner": {"reputation": 37, "user_id": 8683363, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155752200597938/picture?type=large", "display_name": "Desmond Teoh", "link": "https://stackoverflow.com/users/8683363/desmond-teoh"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1506520373, "post_id": 46449389, "comment_id": 79855058, "body": "@braX the manual of copying format is by format printer.. and i have like 20 plus cells to format every single time and data range is pretty huge. i do not want to format the whole column as well because it will interfere with my header which is why it starts with row 6.."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1506520383, "post_id": 46449389, "comment_id": 79855071, "body": "So you want to paste the format of D6 into S6:Slastrow,U6:Ulastrow,..."}, {"owner": {"reputation": 37, "user_id": 8683363, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155752200597938/picture?type=large", "display_name": "Desmond Teoh", "link": "https://stackoverflow.com/users/8683363/desmond-teoh"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1506520430, "post_id": 46449389, "comment_id": 79855105, "body": "@ScottCraner yes something like that.. and also to the last row of my data region under the column S6, U6 and etc"}], "answers": [{"comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1506521738, "post_id": 46449892, "comment_id": 79856082, "body": "@ScottCraner Couldn&#39;t we do something like <code>Union(.Range(&quot;S6:S&quot; &amp; lastrow), .Range(&quot;U6:U&quot; &amp; lastrow), .Range(&quot;W6:W&quot; &amp; lastrow)).PasteSpecial xlPasteFormats</code> to do the paste of formats in one shot? I doubt this will make for any real improvements though, and readability is far better with a loop."}, {"owner": {"reputation": 37, "user_id": 8683363, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155752200597938/picture?type=large", "display_name": "Desmond Teoh", "link": "https://stackoverflow.com/users/8683363/desmond-teoh"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1506521858, "post_id": 46449892, "comment_id": 79856175, "body": "@RyanWildry if thats the case my code will be swarm with (range(&quot;??:?&quot;) as there are like 20 plus columns do this..."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1506522114, "post_id": 46449892, "comment_id": 79856358, "body": "Yup agreed, loop is the way to go, but just pointing out there is a way (although not feasible here) to do the assignment of formats with non-contiguous ranges using union. More of a hey, this might be useful, it might be faster in some rare circumstances when assigning lots of formats, as this should be a touch faster."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1506522144, "post_id": 46449892, "comment_id": 79856380, "body": "@RyanWildry Yes or one could loop through the array and create a unioned range then apply the format in one shot."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1506522202, "post_id": 46449892, "comment_id": 79856419, "body": "@RyanWildry there are many ways, but my comment stating not possible in one shot is not to the placing of the format but the calling of the range itself."}, {"owner": {"reputation": 37, "user_id": 8683363, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155752200597938/picture?type=large", "display_name": "Desmond Teoh", "link": "https://stackoverflow.com/users/8683363/desmond-teoh"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1506522249, "post_id": 46449892, "comment_id": 79856450, "body": "@RyanWildry got you!  thanks for your suggestion anyway!"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1506522398, "post_id": 46449892, "comment_id": 79856559, "body": "@ScottCraner Gotcha, make sense. Thanks all."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1506521341, "last_edit_date": 1506521341, "creation_date": 1506520869, "answer_id": 46449892, "question_id": 46449389, "link": "https://stackoverflow.com/questions/46449389/assign-range-to-an-array-and-paste-data-to-the-array/46449892#46449892", "title": "Assign range to an array and paste data to the array", "body": "<p>You will need to load the ranges as strings:</p>\n\n<blockquote>\n  <p><code>\"S6:S\"</code></p>\n</blockquote>\n\n<p>As the <code>&amp;</code> concatenates a string.  So Lastrow being a number one needs to include the <code>S</code> for then end cell.</p>\n\n<p>Also avoid using <code>.Select</code> it slows the code down.</p>\n\n<p>You will also need to loop through the array.  It will not work as one shot.</p>\n\n<pre><code>Dim lastrow As String\nDim Myarr() As Variant\nDim str As Variant\nlastrow = ActiveSheet.Cells(Rows.Count, \"A\").End(xlUp).Row\n\nMyarr = Array(\"S6:S\", \"U6:U\", \"W6:W\")\nRange(\"D6\").Copy\nFor Each str In Myarr\n    Range(str &amp; lastrow).PasteSpecial xlPasteFormats\nNext str\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 8683363, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155752200597938/picture?type=large", "display_name": "Desmond Teoh", "link": "https://stackoverflow.com/users/8683363/desmond-teoh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 46449892, "answer_count": 1, "score": 0, "last_activity_date": 1506521341, "creation_date": 1506519525, "question_id": 46449389, "link": "https://stackoverflow.com/questions/46449389/assign-range-to-an-array-and-paste-data-to-the-array", "title": "Assign range to an array and paste data to the array", "body": "<p>i am very new to coding and recently attended a few beginner training to VBA. i started learning array and was thinking to assign a range to it and use this array in my excel function(copy paste) like below.. im sure thisis not the right way to do it since i got an error with my range...</p>\n\n<pre><code>Dim lastrow As String\nDim Myarr As Variant\n\nlastrow = ActiveSheet.Cells(Rows.Count, \"A\").End(xlUp).Row\n\nMyarr = ActiveSheet.Range(\"S6, U6, W6\")\nRange(\"D6\").Select\nSelection.Copy\nRange(Myarr &amp; lastrow).Select\nSelection.PasteSpecial xlPasteFormats\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 1, "creation_date": 1506520679, "post_id": 46449243, "comment_id": 79855333, "body": "why is this set twice? fn = FreeFile"}, {"owner": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "edited": false, "score": 0, "creation_date": 1506523738, "post_id": 46449243, "comment_id": 79857547, "body": "Access has tools for Importing and exporting delimited text files. just link to the files, create a <code>Union</code> query to unite the data, and export this union query to a delimited text file. look into <code>Import&#47;Export protocols</code> to have a semicolon as your delimiter. Let Access do the work for you..."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 1, "creation_date": 1506533632, "post_id": 46449243, "comment_id": 79863477, "body": "@DougCoats that&#39;s actually valid. FreeFile returns an unused file pointer. If you want to open another file, you should get a new unused pointer."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1506556080, "post_id": 46449243, "comment_id": 79873024, "body": "ah didnt see the close line. it was early lol"}, {"owner": {"reputation": 1311, "user_id": 3969244, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/WvEa9.jpg?s=128&g=1", "display_name": "Antonio Mailtraq", "link": "https://stackoverflow.com/users/3969244/antonio-mailtraq"}, "reply_to_user": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "edited": false, "score": 0, "creation_date": 1506593424, "post_id": 46449243, "comment_id": 79887862, "body": "@marlan thank you for reply but I need use access with autoexec forplanned operation. I can&#39;t import it manually with internal access tools"}, {"owner": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "edited": false, "score": 0, "creation_date": 1506611607, "post_id": 46449243, "comment_id": 79900272, "body": "Use <a href=\"https://msdn.microsoft.com/VBA/Access-VBA/articles/docmd-transfertext-method-access\" rel=\"nofollow noreferrer\"><code>DoCmd.TransferText</code></a> to import and export in VBA. only the <code>Import&#47;Export specification</code> (I&#39;ve mistakenly called above <i>protocol</i> ) must be <a href=\"https://support.office.com/en-us/article/Save-the-details-of-an-import-or-export-operation-as-a-specification-6B94E183-2B10-4333-A31A-001FE75321B5\" rel=\"nofollow noreferrer\">created and saved, using the manual tools</a>. you then can use them in this<code>TransferText</code>  function."}], "answers": [{"tags": [], "owner": {"reputation": 709, "user_id": 6269045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jBdtv.jpg?s=128&g=1", "display_name": "BitAccesser", "link": "https://stackoverflow.com/users/6269045/bitaccesser"}, "is_accepted": true, "score": 0, "last_activity_date": 1506733554, "creation_date": 1506733554, "answer_id": 46498593, "question_id": 46449243, "link": "https://stackoverflow.com/questions/46449243/combining-multiple-files-in-to-one-text-using-ms-access/46498593#46498593", "title": "Combining multiple files in to one text using ms access", "body": "<p>As your code works for files with windows EOL format (CR (Carriage Return) + LF (Line Feed)), I guess your files are UNIX EOL format (just LF, no CR), check this with a texteditor like e.g. Notepad++ (View->Show Symbol->Show End of Line). This causes<code>Line Input</code>to read the whole file in one line as it breaks on CR. Then you skip the first line and nothing is inserted, because all text is in this line.</p>\n\n<p>You can use<code>FileSystemObject</code>to avoid this as it breaks on LF.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function xExtract()\n\nConst ForReading = 1, ForWriting = 2, ForAppending = 8 'iomode constants\nConst TristateUseDefault = -2, TristateTrue = -1, TristateFalse = 0 'format constants\nDim xArray As Variant, dati As Variant\nDim i As Long, d As Long\nDim xPath As String, new_file As String, dato As String, StrFileName As String\nDim FSO As Object, TextStreamIn As Object, TextStreamOut As Object\n\n\nxPath = CurrentProject.Path\nnew_file = xPath &amp; \"\\PDS.txt\"\n\nxArray = Array(\"D1\", \"D2\", \"D3\", \"D4\", \"D5\", \"D6\")\n\n\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\n\nSet TextStreamOut = FSO.OpenTextFile(new_file, ForWriting, True, TristateUseDefault) 'open textstream to write\n\nFor i = 0 To UBound(xArray) 'loop through files\n    StrFileName = \"\\\\myserver\\inetpub\\ftproot\\PDS_\" &amp; xArray(i) &amp; \".txt\"\n\n    Set TextStreamIn = FSO.OpenTextFile(StrFileName, ForReading) ' open textstream to read\n\n    TextStreamIn.SkipLine 'skip first line with headers\n\n    Do Until TextStreamIn.AtEndOfStream 'loop through lines\n        dati = Split(TextStreamIn.Readline, Chr(9))\n        For d = 0 To UBound(dati)\n            If d = 0 Then\n                dato = Trim(dati(d))\n            Else\n                dato = dato &amp; \";\" &amp; Trim(dati(d))\n            End If\n        Next\n        TextStreamOut.WriteLine dato 'write line to file\n    Loop\n    TextStreamIn.Close 'close textstream\nNext i 'next file\n\nTextStreamOut.Close\nSet TextStreamOut = Nothing\nSet TextStreamIn = Nothing\nSet FSO = Nothing\n\nApplication.Quit\nEnd Function\n</code></pre>\n\n<p>If you want to stay with<code>Open file</code>you can split the first (and only) line on LF (<code>Split(dato,vbLf</code>) and ignore the first element, but you have to check the file is UNIX EOL format, FSO covers both.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4957636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb3468db5befc130612026fa9796f11d?s=128&d=identicon&r=PG", "display_name": "Carl Brady", "link": "https://stackoverflow.com/users/4957636/carl-brady"}, "is_accepted": false, "score": 0, "last_activity_date": 1618384426, "last_edit_date": 1618384426, "creation_date": 1618331294, "answer_id": 67078836, "question_id": 46449243, "link": "https://stackoverflow.com/questions/46449243/combining-multiple-files-in-to-one-text-using-ms-access/67078836#67078836", "title": "Combining multiple files in to one text using ms access", "body": "<p>Here's code that works for concatenating comma delimited text files (probably would work for any text files).  Pretty crude. Needs error handler and would benefit from common dialog to select output folder and file name. Also I don't like using non-typed variables, but I don't know what type of object some of them are and can't figure it out from Microsoft help. Warning, don't put output in same folder - might result in endless loop - trust me I tried it</p>\n<pre><code>Public Function CFiles(Filepath As String) As String\n\n    Dim FSO As Scripting.FileSystemObject\n    Dim SourceFolder As Folder\n    Dim Filein As Object\n    Dim fileout As Object\n    Dim strText As String\n    Dim TheInputfile As Object\n    Dim filename As String\n\n    Set FSO = New Scripting.FileSystemObject\n    Set SourceFolder = FSO.GetFolder(Filepath)\n \n    Set fileout = FSO.CreateTextFile(&quot;c:\\InvestmentsPersonal\\files\\backup\\output.txt&quot;, ForAppending, False)\n\n    \n    For Each Filein In SourceFolder.Files\n        filename = Filein.Name\n        Set TheInputfile = FSO.OpenTextFile(Filepath &amp; filename, ForReading)\n        strText = TheInputfile.ReadAll\n        TheInputfile.Close\n        fileout.WriteLine strText\n    Next\n    \n    fileout.Close\n    Set fileout = Nothing\n    \n    Set Filein = Nothing\n    Set SourceFolder = Nothing\n    Set FSO = Nothing\n    CFiles = &quot;c:\\InvestmentsPersonal\\files\\backup\\output.txt&quot;\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1311, "user_id": 3969244, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/WvEa9.jpg?s=128&g=1", "display_name": "Antonio Mailtraq", "link": "https://stackoverflow.com/users/3969244/antonio-mailtraq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 356, "favorite_count": 0, "accepted_answer_id": 46498593, "answer_count": 2, "score": 0, "last_activity_date": 1618384426, "creation_date": 1506519081, "last_edit_date": 1506520473, "question_id": 46449243, "link": "https://stackoverflow.com/questions/46449243/combining-multiple-files-in-to-one-text-using-ms-access", "title": "Combining multiple files in to one text using ms access", "body": "<p>I have 6 text files in one folder. </p>\n\n<p>I want combine selected files in to one text using access. </p>\n\n<p>I have tried this code without success, because the one text file is created but is empty</p>\n\n<p>Can any one help me on this?</p>\n\n<p>Thanks in advance, my code below.</p>\n\n<p>Lines in the text file:</p>\n\n<pre><code>xN;xDate;xNode;xCO;\n100;2017-09-26 00:00:00;Valley;D6;\n101;2017-09-25 00:00:00;Valley;D3;\n...\n...\n</code></pre>\n\n<p>Code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim xPath\nFunction xExtract()\n    Dim xArray() As Variant\n    Dim I As Integer\n    Dim StrFileName As String\n\n    xPath = CurrentProject.Path\n\nPDS:\nxArray = Array(\"D1\", \"D2\", \"D3\", \"D4\", \"D5\", \"D6\")\n\n                     new_file = \"\" &amp; xPath &amp; \"\\PDS.txt\"\n\n                     fn = FreeFile\n                     Open new_file For Output As fn\n                     Close\n                     For I = 0 To UBound(xArray)\n\n                     StrFileName = \"\\\\myserver\\inetpub\\ftproot\\PDS_\" &amp; xArray(I) &amp; \".txt\"\n\n                      fn = FreeFile\n                      Open StrFileName For Input As fn\n                      Open new_file For Append As fn + 1\n\n                      Line Input #fn, dato\n\n                      Do While Not EOF(fn)\n                        Line Input #fn, dato\n                        dati = Split(dato, Chr(9))\n                        For d = 0 To UBound(dati)\n                            If d = 0 Then\n                                dato = Trim(dati(d))\n                            Else\n                                dato = dato &amp; \";\" &amp; Trim(dati(d))\n                            End If\n                        Next\n\n                        Print #fn + 1, dato\n\n                      Loop\n                      Close\n                     Next I   \n\n    Application.Quit\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1506518868, "post_id": 46448824, "comment_id": 79853875, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/9373082/detect-whether-excel-workbook-is-already-open\">Detect whether Excel workbook is already open</a>"}, {"owner": {"reputation": 27, "user_id": 8439643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46ae10e70fc24728df811f6ec4c5f5cf?s=128&d=identicon&r=PG&f=1", "display_name": "Sture", "link": "https://stackoverflow.com/users/8439643/sture"}, "reply_to_user": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1506519594, "post_id": 46448824, "comment_id": 79854448, "body": "Thanx! Am I thinking this wrong? I was thinking to check with - If workbook &quot;Filename&quot; is not open go to next.  I don&#39;t want to get a message, just want Macro to keep on running :)"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1506519713, "post_id": 46448824, "comment_id": 79854527, "body": "I&#39;d step through the workbooks collection (a collection of workbooks that are open in the application) and check if the name is in a list of file names that need looking at- if it is then copy/paste the info.  If <code>Masterfile</code> is the file that your code is in you can refer to it using <code>ThisWorkbook</code>."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1506519848, "post_id": 46448824, "comment_id": 79854634, "body": "@danieltakeshi Would that code you point to indicate if the workbook is open by someone else, in which case you wouldn&#39;t be able to copy from it as you may not have it open - someone else does."}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1506520050, "post_id": 46448824, "comment_id": 79854798, "body": "What i understood is that the OP wants the status of the workbook open, if is not open (which is status <code>False</code>) just skip this code.  <code>I want the macro to skip it if Workbook is not open</code>"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1506520160, "post_id": 46448824, "comment_id": 79854897, "body": "I understood it as the OP needs the workbook open in their Excel so they can copy data out of it - <code>if I don&#39;t have the new workbook open</code>"}, {"owner": {"reputation": 27, "user_id": 8439643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46ae10e70fc24728df811f6ec4c5f5cf?s=128&d=identicon&r=PG&f=1", "display_name": "Sture", "link": "https://stackoverflow.com/users/8439643/sture"}, "edited": false, "score": 0, "creation_date": 1506520883, "post_id": 46448824, "comment_id": 79855475, "body": "I will be the only one having these workbooks open so that&#39;s safe.@danieltakeshi you are right, if is not open skip this part of the code. I&#39;ll try working with Status False and see what happens."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 8439643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46ae10e70fc24728df811f6ec4c5f5cf?s=128&d=identicon&r=PG&f=1", "display_name": "Sture", "link": "https://stackoverflow.com/users/8439643/sture"}, "edited": false, "score": 0, "creation_date": 1506522030, "post_id": 46449903, "comment_id": 79856299, "body": "I copy from each file into separate sheets in Masterfile. then I have other macro matching data into another sheet and creating a report. S I do not think that one will work. Sorry for not telling you this."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1506522393, "post_id": 46449903, "comment_id": 79856558, "body": "That&#39;s ok, I&#39;m used to it....  It will work as far as checking the other workbook is open by you, you just need a mechanism for saying <i>this file to this sheet</i>."}, {"owner": {"reputation": 27, "user_id": 8439643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46ae10e70fc24728df811f6ec4c5f5cf?s=128&d=identicon&r=PG&f=1", "display_name": "Sture", "link": "https://stackoverflow.com/users/8439643/sture"}, "edited": false, "score": 0, "creation_date": 1506603418, "post_id": 46449903, "comment_id": 79894426, "body": "Found a simple way with OnErrorGoTo Have not used that one before so learnt something new :)"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 27, "user_id": 8439643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46ae10e70fc24728df811f6ec4c5f5cf?s=128&d=identicon&r=PG&f=1", "display_name": "Sture", "link": "https://stackoverflow.com/users/8439643/sture"}, "edited": false, "score": 0, "creation_date": 1506603818, "post_id": 46449903, "comment_id": 79894732, "body": "Glad you found a way.  I&#39;d stay away from using On Errors for anything other than trapping unhandled errors, but as long as it works for you."}, {"owner": {"reputation": 27, "user_id": 8439643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46ae10e70fc24728df811f6ec4c5f5cf?s=128&d=identicon&r=PG&f=1", "display_name": "Sture", "link": "https://stackoverflow.com/users/8439643/sture"}, "edited": false, "score": 0, "creation_date": 1506674314, "post_id": 46449903, "comment_id": 79924256, "body": "May I ask, Why is that?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 27, "user_id": 8439643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46ae10e70fc24728df811f6ec4c5f5cf?s=128&d=identicon&r=PG&f=1", "display_name": "Sture", "link": "https://stackoverflow.com/users/8439643/sture"}, "edited": false, "score": 0, "creation_date": 1506702266, "post_id": 46449903, "comment_id": 79940677, "body": "It could hide other problems in your code.  For example: your code may successfully activate the right workbook, it may copy the correct range, but for one file the cells may be merged and when you try and paste an error occurs - the code won&#39;t let you know this, it will just treat it as though you couldn&#39;t reference the file and move onto the next file.  Saying that though - there are times when you do just ignore errors. :)"}, {"owner": {"reputation": 27, "user_id": 8439643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46ae10e70fc24728df811f6ec4c5f5cf?s=128&d=identicon&r=PG&f=1", "display_name": "Sture", "link": "https://stackoverflow.com/users/8439643/sture"}, "edited": false, "score": 0, "creation_date": 1507191742, "post_id": 46449903, "comment_id": 80114797, "body": "Would it be a better idea do divide this into separate subs like: Sub1 Window Electra copy etc etc, call sub 2 end sub, Sub 2 Window Telecom copy etc etc, call sub 3, end sub,  Sub 3 window Data copy etc etc.  Do you understand how I think?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 27, "user_id": 8439643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46ae10e70fc24728df811f6ec4c5f5cf?s=128&d=identicon&r=PG&f=1", "display_name": "Sture", "link": "https://stackoverflow.com/users/8439643/sture"}, "edited": false, "score": 0, "creation_date": 1507192321, "post_id": 46449903, "comment_id": 80115104, "body": "No.  Each procedure would contain pretty much the same code - the only thing you&#39;d be changing is the file name and the destination sheet.  I&#39;d have just the workbook containing the code open at the start.  Let the code open the workbook, copy the data and close it again - I&#39;ll update my answer to include that option."}, {"owner": {"reputation": 27, "user_id": 8439643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46ae10e70fc24728df811f6ec4c5f5cf?s=128&d=identicon&r=PG&f=1", "display_name": "Sture", "link": "https://stackoverflow.com/users/8439643/sture"}, "edited": false, "score": 0, "creation_date": 1507193683, "post_id": 46449903, "comment_id": 80115891, "body": "Ok thanks! I got this question right now  from the person who will use this process later on. &quot; If I have two of the files that contain data available one day and run this macro. can I just continue another day when I get the other two-three datafiles?&quot;  I have not managed do do this in a good way  without having to open all files. would your solution work that way?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 27, "user_id": 8439643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46ae10e70fc24728df811f6ec4c5f5cf?s=128&d=identicon&r=PG&f=1", "display_name": "Sture", "link": "https://stackoverflow.com/users/8439643/sture"}, "edited": false, "score": 0, "creation_date": 1507194473, "post_id": 46449903, "comment_id": 80116334, "body": "It will open the workbooks listed in the <code>dict.Add</code> code and will throw an error if any of those files don&#39;t exist.  You could test if the file exists before attempting to open it using code similar to the answer in this link:  <a href=\"https://stackoverflow.com/questions/16351249/vba-check-if-file-exists\" title=\"vba check if file exists\">stackoverflow.com/questions/16351249/vba-check-if-file-exist&zwnj;&#8203;s</a> (<code>Len(Dir(&quot;C:\\Test\\Book2.xlsm&quot;)) &lt;&gt; 0</code>.  To avoid copy the same data twice you could move the file to an archive folder after it&#39;s been used using code found in this link:  <a href=\"https://www.rondebruin.nl/win/s3/win026.htm\" rel=\"nofollow noreferrer\">rondebruin.nl/win/s3/win026.htm</a>"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1507192528, "last_edit_date": 1507192528, "creation_date": 1506520890, "answer_id": 46449903, "question_id": 46448824, "link": "https://stackoverflow.com/questions/46448824/if-file-is-not-open-go-to-next/46449903#46449903", "title": "If file is not open go to next", "body": "<p>This code will step through the workbooks that you have open and check against a list of file names that you need.</p>\n\n<p>There's a couple of problems that could occur:</p>\n\n<p>Your workbook must have a sheet called <code>Sheet1</code> as the code doesn't check for this.  </p>\n\n<p>If you have a file called <code>book1.xlsm</code> and <code>1book1.xlsm</code>.  <code>book1.xlsm</code> occurs in both.  </p>\n\n<p>Finding the last cell in columns <code>A:K</code> could be improved.  Currently it will go from <code>A2</code> to the last row containing data in column <code>K</code>.  </p>\n\n<p>All information will be pasted starting at cell <code>A2</code>.  You need code to find the last row on the <code>Electra</code> sheet as well.        </p>\n\n<pre><code>Sub Test() \n\n    Dim sFileNames As String\n    Dim wrkBk As Workbook\n\n    sFileNames = \"Somebook.xls, book1.xlsm, book2.xlsx\"\n\n    For Each wrkBk In Workbooks\n        If InStr(UCase(sFileNames), UCase(wrkBk.Name)) &gt; 0 Then\n            With wrkBk.Worksheets(\"Sheet1\")\n                .Range(.Cells(2, 1), .Cells(.Rows.Count, 11).End(xlUp)).Copy\n                ThisWorkbook.Worksheets(\"Electra\").Range(\"A2\").PasteSpecial xlPasteValues\n            End With\n        End If\n    Next wrkBk  \n\nEnd Sub\n</code></pre>\n\n<p><strong>Edit:</strong><br>\nTo paste to different sheets in the <code>MasterFile</code> one option is to use a dictionary to hold workbook &amp; destination sheet pairings.  </p>\n\n<p>This code will add the file names as keys and the destination sheets as values.  It then checks if the workbook name exists within the dictionary, if it does it copies the data from <code>Sheet1</code> and pastes the values into relevant sheet.  </p>\n\n<pre><code>Sub Test()\n\n    Dim dict As Object\n    Dim wrkBk As Workbook\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n\n    dict.CompareMode = vbTextCompare\n    dict.Add \"Book2.xlsx\", \"Sheet1\"\n    dict.Add \"Book3.xlsx\", \"Sheet2\"\n\n    For Each wrkBk In Workbooks\n        If dict.exists(wrkBk.Name) Then\n            With wrkBk.Worksheets(\"Sheet1\")\n                .Range(.Cells(2, 1), .Cells(.Rows.Count, 11).End(xlUp)).Copy\n                ThisWorkbook.Worksheets(dict(wrkBk.Name)).Range(\"A2\").PasteSpecial xlPasteValues\n            End With\n        End If\n    Next wrkBk\n\nEnd Sub\n</code></pre>\n\n<p><strong>Edit 2:</strong><br>\nIf the source workbooks are all closed at the start then use this code to open the relevant files, copy the info and close the file again.  </p>\n\n<pre><code>Sub Test()\n\n    Dim dict As Object\n    Dim wrkBk As Workbook\n    Dim vItem As Variant\n    Dim sPath As String\n\n    'All workbooks to open will be in this folder.\n    'Remember to include the final back-slash (\\).\n    sPath = \"C:\\Test\\\"\n\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n\n    dict.CompareMode = vbTextCompare\n\n    'If files will not all be in the same folder, then\n    'full file path must be included here and remove\n    'references to sPath variable in the code.\n    dict.Add \"Book2.xlsx\", \"Sheet1\"\n    dict.Add \"Book3.xlsx\", \"Sheet2\"\n\n    For Each vItem In dict\n        Set wrkBk = Workbooks.Open(sPath &amp; vItem)\n        With wrkBk.Worksheets(\"Sheet1\")\n            .Range(.Cells(2, 1), .Cells(.Rows.Count, 11).End(xlUp)).Copy\n            ThisWorkbook.Worksheets(dict(wrkBk.Name)).Range(\"A2\").PasteSpecial xlPasteValues\n        End With\n        wrkBk.Close SaveChanges:=False\n    Next vItem\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27, "user_id": 8439643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46ae10e70fc24728df811f6ec4c5f5cf?s=128&d=identicon&r=PG&f=1", "display_name": "Sture", "link": "https://stackoverflow.com/users/8439643/sture"}, "is_accepted": false, "score": 0, "last_activity_date": 1507194778, "creation_date": 1507194778, "answer_id": 46581856, "question_id": 46448824, "link": "https://stackoverflow.com/questions/46448824/if-file-is-not-open-go-to-next/46581856#46581856", "title": "If file is not open go to next", "body": "<p>This is maybee the most good looking but it actually worked, I never done Call before so I just had to try. I can run this multiple time with different books open and it don't bug out or mess things up. As faar as two test are made.\n    Sub Steg11()\n    '\n    ' Steg1 Macro</p>\n\n<p>' Macrot flyttar data fr\u00e5n CDPPT fil med f\u00f6rs\u00e4ljningsdata, \n   ' fr\u00e5n fil  med Electras f\u00f6rs\u00e4ljning och fil med produktdata.\n   ' Kopierar formler, rensar f\u00f6rs\u00e4ljning till Lagerh\u00e5llare</p>\n\n<pre><code>Dim MainWkbk As Workbook\nDim NextWkbk As Workbook\nSet MainWkbk = ActiveWorkbook\nSet NextWkbk = ActiveWorkbook\n\nApplication.Calculation = xlCalculationManual\nApplication.ScreenUpdating = False\nApplication.DisplayStatusBar = False\nApplication.EnableEvents = False\nActiveSheet.DisplayPageBreaks = False\n\n' Letar in CDPPT, l\u00e4gger in formler, sorterar bladet.\nOn Error GoTo 3\nWindows(\"CDPPT.xlsx\").Activate\nRange(Range(\"A2\"), Range(\"A2\").End(xlToRight).End(xlDown)).Copy\nWorkbooks(\"Datamatchningsfil.xlsm\").Sheets(\"CDPPT\").Activate\nRange(\"A2\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n\nSheets(\"CDPPT\").Select\nRange(Range(\"I2\"), Range(\"I2\").End(xlToRight)).Copy\nRange(\"H2\").Select\nSelection.End(xlDown).Select\nActiveCell.Offset(0, 1).Select\nRange(Selection, Selection.End(xlUp)).Offset(1, 0).Select\nActiveSheet.Paste\n\nApplication.Goto Sheets(\"CDPPT\").Range(\"A:M\")\nSelection.Sort Key1:=Range(\"E1\"), Order1:=xlDescending, Header:=xlGuess, _\nOrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _\nDataOption1:=xlSortNormal\n\n\n'Tar bort data d\u00e4r telia inte ska betala skatt\nApplication.Goto Sheets(\"CDPPT\").Range(\"E1\")\nActiveSheet.Range(\"$A:$M\").AutoFilter Field:=5, Criteria1:=\"=*BRIGHTSTAR*\" _\n    , Operator:=xlAnd\nActiveCell.Offset(1, 0).Activate\nRange(Selection, Selection.End(xlDown)).Select\nSelection.EntireRow.Delete\nActiveSheet.ShowAllData\nActiveWorkbook.RefreshAll\nActiveSheet.Range(\"$A:$M\").AutoFilter Field:=5, Criteria1:=\"=*ELECTRA*\" _\n    , Operator:=xlAnd\nActiveWindow.SmallScroll Down:=-6\nActiveCell.Offset(1, 0).Activate\nRange(Selection, Selection.End(xlDown)).Select\nSelection.EntireRow.Delete\nActiveSheet.ShowAllData\nActiveWorkbook.RefreshAll\nActiveSheet.Range(\"$A:$M\").AutoFilter Field:=5, Criteria1:=\"=*Ingram*\" _\n    , Operator:=xlAnd\nActiveWindow.SmallScroll Down:=-9\nActiveCell.Offset(1, 0).Activate\nRange(Selection, Selection.End(xlDown)).Select\nSelection.EntireRow.Delete\nActiveSheet.ShowAllData\nActiveWorkbook.RefreshAll\nActiveSheet.Range(\"$A:$M\").AutoFilter Field:=3, Criteria1:=\"=*brev*\" _\n    , Operator:=xlAnd\nActiveCell.Offset(1, 0).Activate\nRange(Selection, Selection.End(xlDown)).Select\nSelection.EntireRow.Delete\nActiveSheet.ShowAllData\nActiveWorkbook.RefreshAll\nActiveSheet.Range(\"$A:$M\").AutoFilter Field:=3, Criteria1:=\"=*Konfig*\" _\n    , Operator:=xlAnd\nActiveCell.Offset(1, 0).Activate\nRange(Selection, Selection.End(xlDown)).Select\nSelection.EntireRow.Delete\nActiveSheet.ShowAllData\nActiveWorkbook.RefreshAll\nActiveSheet.Range(\"$A:$M\").AutoFilter Field:=5, Criteria1:=\"=*(Manuellt \ninmatad)*\" _\n    , Operator:=xlAnd\nActiveCell.Offset(1, 0).Activate\nRange(Selection, Selection.End(xlDown)).Select\nSelection.EntireRow.Delete\nActiveSheet.ShowAllData\nActiveWorkbook.RefreshAll\n\n3\nCall Produktdata\nEnd Sub\n\nSub Produktdata()\n\n'Letar in produktdata\nOn Error GoTo 4\nWindows(\"Produktdata.xlsx\").Activate\nIf ActiveSheet.AutoFilterMode Then Cells.AutoFilter\nRange(Range(\"A:J\"), Range(\"A:J\").End(xlDown)).Copy\nWorkbooks(\"Datamatchningsfil.xlsm\").Sheets(\"Produktdata\").Activate\nRange(\"A1\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n4\nCall Electra\nEnd Sub\n\nSub Electra()\n'Letar in data fr\u00e5n Lagerh\u00e5llare\nOn Error GoTo 5\nWindows(\"Electra sales.xlsx\").Activate\nRange(Range(\"A2:K2\"), Range(\"A2:K2\").End(xlDown)).Copy\nWorkbooks(\"Datamatchningsfil.xlsm\").Sheets(\"Electra\").Activate\nRange(\"A2\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n5\nCall TalkTelecom\nEnd Sub\n\nSub TalkTelecom()\n\n'Letar in data fr\u00e5n Lagerh\u00e5llare\nOn Error GoTo 6\nWindows(\"TalkTelecom.xlsx\").Activate\nRange(Range(\"A2:K2\"), Range(\"A2:K2\").End(xlDown)).Copy\nWorkbooks(\"Datamatchningsfil.xlsm\").Sheets(\"TalkTelecom\").Activate\nRange(\"A2\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n6\nCall Techdata\nEnd Sub\n\nSub Techdata()\n'Letar in data fr\u00e5n Lagerh\u00e5llare\nOn Error GoTo 7\nWindows(\"TechData.xlsx\").Activate\nRange(Range(\"A2:K2\"), Range(\"A2:K2\").End(xlDown)).Copy\nWorkbooks(\"Datamatchningsfil.xlsm\").Sheets(\"TechData\").Activate\nRange(\"A2\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n7\nCall Continue\nEnd Sub\n\nSub Continue()\n\n' Utf\u00f6r text till kolumn\nApplication.Goto Sheets(\"Produktdata\").Range(\"C:C\")\nColumns(\"C:C\").Select\nSelection.TextToColumns Destination:=Range(\"C1\"), DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _\n    Semicolon:=False, Comma:=False, Space:=False, Other:=False, FieldInfo _\n    :=Array(1, 1), TrailingMinusNumbers:=True\n\nApplication.Goto Sheets(\"CDPPT\").Range(\"F:F\")\nColumns(\"F:F\").Select\nSelection.TextToColumns Destination:=Range(\"F1\"), DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _\n    Semicolon:=False, Comma:=False, Space:=False, Other:=False, FieldInfo _\n    :=Array(1, 1), TrailingMinusNumbers:=True\n\nApplication.Calculation = xlCalculationAutomatic\nActiveWorkbook.RefreshAll\n\n'L\u00e4gger in \u00e5r och m\u00e5nad i blad arbetsbeskrivning\nApplication.Goto Sheets(\"CDPPT\").Range(\"G2\")\nRange(\"G2\").Copy\nSheets(\"Arbetsbeskrivning\").Select\nRange(\"C10\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nRange(\"D10\").Activate\nApplication.CutCopyMode = False\nActiveCell.FormulaR1C1 = \"=RIGHT(RC[-1],2)\"\nRange(\"D10\").Copy\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nRange(\"D10\").Select\nSelection.TextToColumns Destination:=Range(\"D10\"), DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _\n    Semicolon:=False, Comma:=False, Space:=False, Other:=False, FieldInfo _\n    :=Array(1, 1), TrailingMinusNumbers:=True\nRange(\"D9\").Activate\nActiveCell.FormulaR1C1 = \"=VLOOKUP(R[1]C,Datalistor!R[-6]C[1]:R[5]C[2],2,0)\"\nRange(\"C9\").Activate\nActiveCell.FormulaR1C1 = \"=Left(R[1]C,4)\"\nRange(\"C4\").Activate\n\n\n' kopierar data och skapar Pivotdata Telia f\u00f6rs\u00e4ljning\nSheets(\"CDPPT\").Select\nRange(Range(\"A2\"), Range(\"A2\").End(xlToRight).End(xlDown)).Copy \nDestination:=Sheets(\"Matchning\"). _\n    Range(\"A2\")\nApplication.CutCopyMode = False\nSheets(\"CDPPT\").Select\nRange(Range(\"A2\"), Range(\"A2\").End(xlToRight).End(xlDown)).Copy \nDestination:=Sheets(\"Pivotgrund\"). _\n    Range(\"A2\")\nApplication.CutCopyMode = False\n\nActiveWorkbook.RefreshAll\n\n' Tar bort dubletter\nApplication.Goto Sheets(\"Matchning\").Range(\"A:M\")\nSelection.Sort Key1:=Range(\"F1\"), Order1:=xlDescending, Header:=xlGuess, _\nOrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _\nDataOption1:=xlSortNormal\nApplication.Goto Sheets(\"Matchning\").Range(\"A1\")\nRange(Range(\"A1\"), Range(\"A1\").End(xlToRight).End(xlDown)).Select\nActiveSheet.Range(\"A:L\").RemoveDuplicates Columns:=6, Header:= _\n    xlYes\n\nActiveWorkbook.RefreshAll\n\n' letar in Pivotdata\nApplication.Goto Sheets(\"Matchning\").Range(\"H2\")\nActiveCell.FormulaR1C1 = \"=VLOOKUP(C[-2],Pivot!C[-7]:C[-6],2,0)\"\nRange(\"H2\").Select\nSelection.Copy\nRange(Selection, Selection.End(xlDown)).Select\nActiveSheet.Paste\n\nActiveWorkbook.RefreshAll\n\n' Skapar fil med prod med saknad data\nApplication.Goto Sheets(\"Matchning\").Range(\"A1\")\nRange(\"A1\").Select\nActiveSheet.Range(\"$A:P\").AutoFilter Field:=12, Criteria1:= _\n    \"Check for data\"\nRange(Range(\"A1\"), Range(\"A1\").End(xlToRight).End(xlDown)).Copy\nRange(\"A1\").Select\nWorkbooks.Add\nActiveSheet.Paste\nActiveWorkbook.Windows(1).Caption = \"Produktdata saknas\"\nColumns(\"M:P\").Select\nSelection.Delete Shift:=xlToLeft\nRange(\"A1\").Select\n\nWindows(\"Datamatchningsfil.xlsm\").Activate\nApplication.Goto Sheets(\"Matchning\").Range(\"A1\")\nActiveSheet.ShowAllData\n\n\nActiveWorkbook.RefreshAll\nApplication.ScreenUpdating = True\n\nSheets(\"Arbetsbeskrivning\").Select\nRange(\"C13\").Select\nWith Selection.Font\n    .Color = -16776961\n    .TintAndShade = 0\nEnd With\nSelection.Font.Bold = True\nActiveCell.FormulaR1C1 = _\n    \"Steg 1 klart!\"\nRange(\"C14\").Select\n\n\nApplication.DisplayStatusBar = True\nApplication.EnableEvents = True\nApplication.Calculation = xlCalculationAutomatic\n\nMsgBox (\"Steg 1 klart\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 8439643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46ae10e70fc24728df811f6ec4c5f5cf?s=128&d=identicon&r=PG&f=1", "display_name": "Sture", "link": "https://stackoverflow.com/users/8439643/sture"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1507194778, "creation_date": 1506517922, "last_edit_date": 1506526160, "question_id": 46448824, "link": "https://stackoverflow.com/questions/46448824/if-file-is-not-open-go-to-next", "title": "If file is not open go to next", "body": "<p>From multiple workbooks I copy info into one Workbook. This works like a charm. I just got informed that in a few weeks I'll have to add another file to copy data from. I wanted to get the Macro going now but if I don't have the new workbook open the macro gets stuck. I have tried a few different ways but I don't get it to work.\nI have the same code going with the other 3 workbooks, so when this comes I want the macro to skip it if Workbook is not open.\nAny suggestions? </p>\n\n<pre><code>Windows(\"filename.xlsx\").Activate\nRange(Range(\"A2:K2\"), Range(\"A2:K2\").End(xlDown)).Copy\nWorkbooks(\"Masterfile.xlsm\").Sheets(\"Electra\").Activate\nRange(\"A2\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n</code></pre>\n"}, {"tags": ["vba", "excel", "pivot-table"], "answers": [{"comments": [{"owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "edited": false, "score": 0, "creation_date": 1506518361, "post_id": 46448854, "comment_id": 79853508, "body": "Perfect! I will accept the answer in 5 minutes because it does not allow me! How about the second part of the question? any solution?"}, {"owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "edited": false, "score": 0, "creation_date": 1506520639, "post_id": 46448854, "comment_id": 79855293, "body": "One last question! I updated a picture of my excel to show you the problem.. The last row has blank as a row value... why does this happen and how can I fix it?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "edited": false, "score": 1, "creation_date": 1506521743, "post_id": 46448854, "comment_id": 79856086, "body": "@PericlesFaliagas Your source range is too big. You should be using <code>Set PRange = DSheet.Cells(6, 1).Resize(LastRow - 5, LastCol)</code> since it starts in row 6."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 4, "last_activity_date": 1506518691, "last_edit_date": 1506518691, "creation_date": 1506518017, "answer_id": 46448854, "question_id": 46448817, "link": "https://stackoverflow.com/questions/46448817/vba-code-for-creating-pivot-table/46448854#46448854", "title": "VBA code for creating Pivot Table", "body": "<p>You can toggle the subtotals:</p>\n\n<pre><code>With PTable.PivotFields(\"Commodity Code\")\n.Orientation = xlRowField\n.Position = 1\n.Name = \"Commodity Code\"\n.Subtotals(1) = True\n.Subtotals(1) = False\nEnd With\n</code></pre>\n\n<p>to change the header, change the table layout to tabular</p>\n\n<pre><code>PTable.LayoutRowDefault = xlTabularRow\n</code></pre>\n\n<p>before you add the fields. BTW, you should be using <code>PTable</code> rather than <code>ActiveSheet.PivotTables(\"PivotTable\")</code> in the rest of your code.</p>\n"}], "owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1828, "favorite_count": 0, "accepted_answer_id": 46448854, "answer_count": 1, "score": 1, "last_activity_date": 1506520701, "creation_date": 1506517899, "last_edit_date": 1506520701, "question_id": 46448817, "link": "https://stackoverflow.com/questions/46448817/vba-code-for-creating-pivot-table", "title": "VBA code for creating Pivot Table", "body": "<p>I have created a macro that builds a pivot table. It runs great but I want to dismiss the circled content in the screenshot provided .. I dont want to have the total inside the pivot. Only at the bottom the Grand Total! I am providing my code and a screenshot. Moreover, is it possible to substitute the \"Row Labels\" text in column B with \"FDD\"?</p>\n\n<p><a href=\"https://i.stack.imgur.com/YEe6l.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YEe6l.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/0nOwv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0nOwv.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>     Sub aa()\n\n 'Declare Variables\n    Dim PSheet As Worksheet\n    Dim DSheet As Worksheet\n    Dim PCache As PivotCache\n    Dim PTable As PivotTable\n    Dim PRange As Range\n    Dim LastRow As Long\n    Dim LastCol As Long\n\n    'Insert a New Blank Worksheet\n    On Error Resume Next\n    Application.DisplayAlerts = False\n    Worksheets(\"Customs_report\").Delete\n    Sheets.Add Before:=ActiveSheet\n    ActiveSheet.Name = \"Customs_report\"\n    Application.DisplayAlerts = True\n    Set PSheet = Worksheets(\"Customs_report\")\n    Set DSheet = Worksheets(\"Zeikan\")\n\n    'Define Data Range\n    LastRow = DSheet.Cells(Rows.Count, 1).End(xlUp).Row\n    LastCol = DSheet.Cells(6, Columns.Count).End(xlToLeft).Column\n    Set PRange = DSheet.Cells(6, 1).Resize(LastRow, LastCol)\n\n    'Define Pivot Cache\n    Set PCache = ActiveWorkbook.PivotCaches.Create _\n    (SourceType:=xlDatabase, SourceData:=PRange). _\n    CreatePivotTable(TableDestination:=PSheet.Cells(2, 2), _\n    TableName:=\"PivotTable\")\n\n    'Insert Blank Pivot Table\n    Set PTable = PCache.CreatePivotTable _\n    (TableDestination:=PSheet.Cells(1, 1), TableName:=\"PivotTable\")\n\n    'Insert Row Fields\n    With ActiveSheet.PivotTables(\"PivotTable\").PivotFields(\"Commodity Code\")\n    .Orientation = xlRowField\n    .Position = 1\n    .Name = \"Commodity Code\"\n    End With\n    With ActiveSheet.PivotTables(\"PivotTable\").PivotFields(\"Location\")\n    .Orientation = xlRowField\n    .Position = 2\n    End With\n\n    'Insert Column Fields\n    With ActiveSheet.PivotTables(\"PivotTable\").PivotFields(\"Quantity (cases/sw)\")\n    .Orientation = xlDataField\n    .Position = 1\n    .Function = xlSum\n    .Name = \"Sum of Quantity (cases/sw)\"\n    End With\n    With ActiveSheet.PivotTables(\"PivotTable\").PivotFields(\"Quantity (items)\")\n    .Orientation = xlDataField\n    .Position = 2\n    .Function = xlSum\n    .Name = \"Sum of Quantity (items)\"\n    End With\n    With ActiveSheet.PivotTables(\"PivotTable\").PivotFields(\"Net value\")\n    .Orientation = xlDataField\n    .Position = 3\n    .Function = xlSum\n    .Name = \"Sum of Net value\"\n    End With\n    With ActiveSheet.PivotTables(\"PivotTable\").PivotFields(\"Gross weight (Kg)\")\n    .Orientation = xlDataField\n    .Position = 4\n    .Function = xlSum\n    .Name = \"Sum of Gross weight (Kg)\"\n    End With\n    With ActiveSheet.PivotTables(\"PivotTable\").PivotFields(\"Net weight (Kg)\")\n    .Orientation = xlDataField\n    .Position = 5\n    .Function = xlSum\n    .Name = \"Sum of Net weight (Kg)\"\n    End With\n\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1506517041, "post_id": 46448475, "comment_id": 79852536, "body": "<a href=\"https://stackoverflow.com/questions/16627441/excel-vba-using-filesystemobject-to-list-file-last-date-modified\" title=\"excel vba using filesystemobject to list file last date modified\">stackoverflow.com/questions/16627441/&hellip;</a>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1506517642, "post_id": 46448475, "comment_id": 79853008, "body": "Wouldn&#39;t <code>FileDateTime</code> suffice for that?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1506519378, "post_id": 46448475, "comment_id": 79854285, "body": "VBA does not support reading from closed documents.  If you want to access built-in properties from a closed document, you will need to install the MS supplied DLL file called DSO OLE Document Properties Reader 2.1.  See Chip Pearsons page on <a href=\"http://www.cpearson.com/excel/docprop.aspx\" rel=\"nofollow noreferrer\">Document Properties</a>.  Or you can use the <code>FileSystemObject</code> to access the <code>LastModified</code> time.  Whether that will provide the same information as the built-in property is not known to me.  But perhaps the result will be sufficient (and it is simpler to implement)."}], "answers": [{"tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": false, "score": 0, "last_activity_date": 1506520407, "creation_date": 1506520407, "answer_id": 46449712, "question_id": 46448475, "link": "https://stackoverflow.com/questions/46448475/find-last-save-time-of-a-closed-workbook/46449712#46449712", "title": "Find last save time of a closed workbook", "body": "<p>Something like this should do the trick. You'll need to use the <code>FileSystemObject</code> in this example. I'm using late binding in the example, but you may get some performance improvements if you switch to early binding.</p>\n\n<pre><code>Option Explicit\n\nPrivate Function LastModified(ByRef filePath As String) As Date\n    'Set a default value\n    LastModified = vbNull\n\n    If Len(Trim$(filePath)) = 0 Then Exit Function\n\n    With CreateObject(\"Scripting.FileSystemObject\")\n        If .FileExists(filePath) Then LastModified = .GetFile(filePath).DateLastModified\n    End With\n\nEnd Function\n\nSub SOExample()\n    'Specify a path to a file you want to get LastModified Date\n    Dim filePath As String: filePath = \"MyPathToAFile\"\n\n    'Return a date or vbNull\n    Dim myDate As Date: myDate = LastModified(filePath)\n\n    'Output the Date if it isn't vbNull\n    If Not myDate = vbNull Then Debug.Print myDate\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 8683072, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155613460500692/picture?type=large", "display_name": "Lars H&#248;isveen", "link": "https://stackoverflow.com/users/8683072/lars-h%c3%b8isveen"}, "is_accepted": false, "score": 1, "last_activity_date": 1506708265, "creation_date": 1506708265, "answer_id": 46494616, "question_id": 46448475, "link": "https://stackoverflow.com/questions/46448475/find-last-save-time-of-a-closed-workbook/46494616#46494616", "title": "Find last save time of a closed workbook", "body": "<p>The Filesystemobject worked but I needed then to print it to cells, as it would'nt call the function.</p>\n\n<p>The FileDateTime worked for me though :)</p>\n\n<pre><code>Function LastModified() as Date\n\n  LastModified = FileDateTime(\"filepath\")\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8683072, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155613460500692/picture?type=large", "display_name": "Lars H&#248;isveen", "link": "https://stackoverflow.com/users/8683072/lars-h%c3%b8isveen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2162, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1506708265, "creation_date": 1506516948, "last_edit_date": 1506528232, "question_id": 46448475, "link": "https://stackoverflow.com/questions/46448475/find-last-save-time-of-a-closed-workbook", "title": "Find last save time of a closed workbook", "body": "<p>I am trying to make a macro that can reference when another workbook was last updated without opening it.</p>\n\n<p>I found this one but it only works on the active workbook:</p>\n\n<pre><code>Function LastModified() as Date\n\n  LastModified = ActiveWorkbook.BuiltinDocumentProperties(\"Last Save Time\")\n\nEnd Function\n</code></pre>\n\n<p>What I want is something like this:</p>\n\n<pre><code>Function LastModified() as Date\n\n  LastModified = path.\"c:/test.xlsx\".BuiltinDocumentProperties(\"Last Save Time\")\n\nEnd Function\n</code></pre>\n\n<p>But that didn't work of course. How do I fix this?</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "answers": [{"tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": true, "score": 0, "last_activity_date": 1506904997, "creation_date": 1506904997, "answer_id": 46518235, "question_id": 46448176, "link": "https://stackoverflow.com/questions/46448176/how-to-get-the-table-name-and-column-name-from-data-model-of-selected-cell-in-ex/46518235#46518235", "title": "How to get the table name and column name from data model of selected cell in excel API", "body": "<p>use the watch window to examine the <code>Range(\"c1\")</code> object</p>\n\n<pre><code>columnNumber = Range(\"c1\").Column\n\ntableName = Range(\"c1\").ListObject.Name\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8682933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d629de4eb9767cf3ed4b736a5f2795?s=128&d=identicon&r=PG&f=1", "display_name": "Chaitanya", "link": "https://stackoverflow.com/users/8682933/chaitanya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 631, "favorite_count": 1, "accepted_answer_id": 46518235, "answer_count": 1, "score": 0, "last_activity_date": 1506904997, "creation_date": 1506516095, "last_edit_date": 1506526051, "question_id": 46448176, "link": "https://stackoverflow.com/questions/46448176/how-to-get-the-table-name-and-column-name-from-data-model-of-selected-cell-in-ex", "title": "How to get the table name and column name from data model of selected cell in excel API", "body": "<p>Currently I am working on Excel add in which is present in office developer tools.</p>\n\n<p>But I am very much new to this. I have a requirement which is described in below lines.</p>\n\n<p>Is there a way to get table name and column name from where the data is fetched(i.e if a cube formula contains a cell name as C1 then is there any possibility to get table name and column name corresponding to value in C1 in data model) based on the cell names that are present in cube formula. Currently I am getting all the Cell values corresponding to Cell names in cube formula.</p>\n\n<p>But I didnt find a way to get the table specific details.</p>\n\n<p>Could you please help me in achieving the above scenario.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 5450121, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c4c620970c5e639ac1a3fb7059756144?s=128&d=identicon&r=PG&f=1", "display_name": "premiumcopypaper", "link": "https://stackoverflow.com/users/5450121/premiumcopypaper"}, "edited": false, "score": 0, "creation_date": 1506601577, "post_id": 46448702, "comment_id": 79893064, "body": "Columns C + D do not both have to be filled in, but at least one does, if I try to insert between B2 and F2 in your formula the following: <code>(IF(AND(C2=&quot;&quot;, D2=&quot;&quot;)))</code> I get a &quot;the formula you typed contains an error&quot; message, what am I missing?"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 2, "last_activity_date": 1506517557, "creation_date": 1506517557, "answer_id": 46448702, "question_id": 46448146, "link": "https://stackoverflow.com/questions/46448146/counting-blanks-in-specific-columns-only/46448702#46448702", "title": "Counting blanks in specific columns only", "body": "<p>You were quite close:</p>\n\n<pre><code>=(A2=\"\")+(B2=\"\")+(F2=\"\")+(G2=\"\")+(H2=\"\")+(I2=\"\")+(J2=\"\")+(M2=\"\")+(N2=\"\")+(R2=\"\")+(S2=\"\")+(T2=\"\")+(V2=\"\")+(W2=\"\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": false, "score": 2, "last_activity_date": 1506517607, "creation_date": 1506517607, "answer_id": 46448717, "question_id": 46448146, "link": "https://stackoverflow.com/questions/46448146/counting-blanks-in-specific-columns-only/46448717#46448717", "title": "Counting blanks in specific columns only", "body": "<p>Try</p>\n\n<pre><code>=SUM(COUNTIF(INDIRECT({\"A2\",\"B2\",\"F2\",\"G2\",\"H2\",\"I2\",\"J2\",\"M2\",\"N2\",\"R2\",\"S2\",\"T2\",\"V2\",\"W2\"}),\"\"))\n</code></pre>\n\n<p>or</p>\n\n<pre><code>=SUM(COUNTIF(INDIRECT({\"A2:B2\",\"F2:J2\",\"M2:N2\",\"R2:T2\",\"V2:W2\"}),\"\"))\n</code></pre>\n\n<p><strong><em>Note :</em></strong> <code>INDIRECT</code> is a volatile function. For details on volatile function see <a href=\"http://www.decisionmodels.com/calcsecretsi.htm\" rel=\"nofollow noreferrer\">this</a>.</p>\n"}], "owner": {"reputation": 147, "user_id": 5450121, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c4c620970c5e639ac1a3fb7059756144?s=128&d=identicon&r=PG&f=1", "display_name": "premiumcopypaper", "link": "https://stackoverflow.com/users/5450121/premiumcopypaper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 46448702, "answer_count": 2, "score": 0, "last_activity_date": 1506525722, "creation_date": 1506516013, "last_edit_date": 1506525722, "question_id": 46448146, "link": "https://stackoverflow.com/questions/46448146/counting-blanks-in-specific-columns-only", "title": "Counting blanks in specific columns only", "body": "<p>I've got a spreadsheet with Columns A to X. I want to audit whether inputs are made by counting the number of blanks. <code>COUNTBLANK</code> requires a range, but I've got columns that are mandatory to fill in and those that are non-mandatory. I've tried the following formula:</p>\n\n<p><code>=COUNTIF((A2, B2, F2, G2, H2, I2, J2, M2, N2, R2, S2, T2, V2, W2), \"\")</code> however I get a <code>#VALUE</code> error. </p>\n"}, {"tags": ["vba", "excel", "userform"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 3, "creation_date": 1506515873, "post_id": 46448025, "comment_id": 79851701, "body": "Do what exactly? Exit if nothing is selected? <code>If cmb.listindex=-1 then exit sub</code>"}], "answers": [{"comments": [{"owner": {"reputation": 321, "user_id": 4915723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b8417efa4b79cbcf3463d38ccfedb7b5?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Bailey", "link": "https://stackoverflow.com/users/4915723/sean-bailey"}, "edited": false, "score": 0, "creation_date": 1506517236, "post_id": 46448164, "comment_id": 79852701, "body": "Thanks for the above - My Userform is called UserForm3 which causes an error on the lines &quot;Fruits_CB&quot; can you advise how I fix this?"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "reply_to_user": {"reputation": 321, "user_id": 4915723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b8417efa4b79cbcf3463d38ccfedb7b5?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Bailey", "link": "https://stackoverflow.com/users/4915723/sean-bailey"}, "edited": false, "score": 1, "creation_date": 1506518903, "post_id": 46448164, "comment_id": 79853907, "body": "Fruits_CB is the name of the combobox, the userform is referenced by the &quot;Me&quot; keyword. You need to change Fruits_CB to whatever your combobox is called. @SeanBailey"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 321, "user_id": 4915723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b8417efa4b79cbcf3463d38ccfedb7b5?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Bailey", "link": "https://stackoverflow.com/users/4915723/sean-bailey"}, "edited": false, "score": 0, "creation_date": 1506521017, "post_id": 46448164, "comment_id": 79855554, "body": "@SeanBailey did you understand what eirikdaude wrote to you in the comment above ?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1506521873, "post_id": 46448164, "comment_id": 79856185, "body": "No real need to clear the combobox in the <code>Initialize</code> event. I&#39;d also recommend using <code>List</code> with an array rather than <code>AddItem</code>. FWIW."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 2, "last_activity_date": 1506516064, "creation_date": 1506516064, "answer_id": 46448164, "question_id": 46448025, "link": "https://stackoverflow.com/questions/46448025/userform-drop-down-list-vba/46448164#46448164", "title": "Userform Drop down list VBA", "body": "<p>To populate the <code>Fruits_CB</code> combo-box on <code>UserForm_Initialize</code> event use the code below:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\n' populate \"Fruits_CB\" Combo-Box with fruits\nWith Me.Fruits_CB\n    .Clear ' clear previous items (not to have \"doubles\")\n    .AddItem \"Apples\"\n    .AddItem \"Oranges\"\n    .AddItem \"Pears\"\n    .AddItem \"Bananas\"\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>If the user is not selecting any item from the list, and then clicks the button, use the <code>Sub</code> below:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nIf Me.Fruits_CB.ListIndex = -1 Then\n    Exit Sub\nElse\n    ' Do something    \nEnd If  \n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 321, "user_id": 4915723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b8417efa4b79cbcf3463d38ccfedb7b5?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Bailey", "link": "https://stackoverflow.com/users/4915723/sean-bailey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12853, "favorite_count": 0, "accepted_answer_id": 46448164, "answer_count": 1, "score": -1, "last_activity_date": 1506516064, "creation_date": 1506515703, "last_edit_date": 1531164843, "question_id": 46448025, "link": "https://stackoverflow.com/questions/46448025/userform-drop-down-list-vba", "title": "Userform Drop down list VBA", "body": "<p>All, </p>\n\n<p>I have created a Userform (Userform 3) which I wish to have a basic drop down list of 4 Items - Apples / Oranges / Pears / bananas. (Hard coded in the background VBA) and if none of the selections are selected by the users to exit sub. </p>\n\n<p>Please can someone advise how I would do this?</p>\n\n<p>Inserted picture for reference?</p>\n\n<p><a href=\"https://i.stack.imgur.com/l8Ohz.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/l8Ohz.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 561, "user_id": 8558614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2h6yS.jpg?s=128&g=1", "display_name": "Nikolaos Polygenis", "link": "https://stackoverflow.com/users/8558614/nikolaos-polygenis"}, "is_accepted": false, "score": 0, "last_activity_date": 1506517374, "creation_date": 1506517374, "answer_id": 46448623, "question_id": 46447945, "link": "https://stackoverflow.com/questions/46447945/extracting-appointments-from-shared-outlook-calendar-to-excel/46448623#46448623", "title": "Extracting appointments from shared Outlook calendar to Excel", "body": "<p>You have to change:</p>\n\n<p><code>Set olFolder = olNS.GetSharedDefaultFolder(objOwner, olFolderCalendar)</code></p>\n\n<p>with this :</p>\n\n<p><code>Set olFolder = olNS.GetDefaultFolder(9)</code></p>\n"}, {"comments": [{"owner": {"reputation": 1245, "user_id": 5938276, "user_type": "registered", "accept_rate": 38, "profile_image": "https://lh6.googleusercontent.com/-zolc90p2grA/AAAAAAAAAAI/AAAAAAAAOBU/TloVnogHxWU/photo.jpg?sz=128", "display_name": "Al Grant", "link": "https://stackoverflow.com/users/5938276/al-grant"}, "edited": false, "score": 0, "creation_date": 1554428662, "post_id": 46448705, "comment_id": 97758235, "body": "@Ryan Would you please be able to look at this similar question <a href=\"https://stackoverflow.com/questions/55526145/excel-vba-create-meeting-in-non-default-calendar\" title=\"excel vba create meeting in non default calendar\">stackoverflow.com/questions/55526145/&hellip;</a>"}], "tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": true, "score": 1, "last_activity_date": 1506517872, "last_edit_date": 1506517872, "creation_date": 1506517568, "answer_id": 46448705, "question_id": 46447945, "link": "https://stackoverflow.com/questions/46447945/extracting-appointments-from-shared-outlook-calendar-to-excel/46448705#46448705", "title": "Extracting appointments from shared Outlook calendar to Excel", "body": "<p>Welcome to StackOverflow!</p>\n\n<p>The cause of your issue was using an object for <code>olFolderCalendar</code>, however in context for what you are trying to do you want an <code>Enumeration</code> value of olFolderCalendar which has a value of <strong>9</strong>. </p>\n\n<p>I've tidied up the code, and made a few optimization to make this code faster, and added a basic error handler. Great first post :)</p>\n\n<pre><code>Option Explicit\n\nPublic Sub ListAppointments()\nOn Error GoTo ErrHand:\n\n    Application.ScreenUpdating = False\n\n    'This is an enumeration value in context of getDefaultSharedFolder\n    Const olFolderCalendar As Byte = 9\n\n    Dim olApp       As Object: Set olApp = CreateObject(\"Outlook.Application\")\n    Dim olNS        As Object: Set olNS = olApp.GetNamespace(\"MAPI\")\n    Dim olFolder    As Object\n    Dim olApt       As Object\n    Dim objOwner    As Object: Set objOwner = olNS.CreateRecipient(\"emailAddressHERE\")\n    Dim NextRow     As Long\n    Dim ws          As Worksheet: Set ws = ThisWorkbook.Sheets(\"Sheet1\")\n\n    objOwner.Resolve\n\n    If objOwner.Resolved Then \n        Set olFolder = olNS.GetSharedDefaultFolder(objOwner, olFolderCalendar)\n    end if\n\n    ws.Range(\"A1:D1\").Value2 = Array(\"Subject\", \"Start\", \"End\", \"Location\")\n\n    'Ensure there at least 1 item to continue\n    If olFolder.Items.Count = 0 Then Exit Sub\n\n    'Create an array large enough to hold all records\n    Dim myArr() As Variant: ReDim myArr(0 To 3, 0 To olFolder.Items.Count - 1)\n\n    'Add the records to an array\n    'Add this error skip, as I found some of my calendar items don't have all properties e.g. a start time\n    On Error Resume Next\n    For Each olApt In olFolder.Items\n        myArr(0, NextRow) = olApt.Subject\n        myArr(1, NextRow) = olApt.Start\n        myArr(2, NextRow) = olApt.End\n        myArr(3, NextRow) = olApt.Location\n        NextRow = NextRow + 1\n    Next\n    On Error GoTo 0\n\n    'Write all records to a worksheet from an array, this is much faster\n    ws.Range(\"A2:D\" &amp; NextRow + 1).Value = WorksheetFunction.Transpose(myArr)\n\n    'AutoFit\n    ws.Columns.AutoFit\n\ncleanExit:\n    Application.ScreenUpdating = True\n    Exit Sub\n\nErrHand:\n    'Add error handler\n    Resume cleanExit\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 74, "user_id": 11334657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30a1d1e108366422e8078b0e0bdd9859?s=128&d=identicon&r=PG&f=1", "display_name": "Flaw98", "link": "https://stackoverflow.com/users/11334657/flaw98"}, "is_accepted": false, "score": 1, "last_activity_date": 1556865885, "creation_date": 1556865885, "answer_id": 55964554, "question_id": 46447945, "link": "https://stackoverflow.com/questions/46447945/extracting-appointments-from-shared-outlook-calendar-to-excel/55964554#55964554", "title": "Extracting appointments from shared Outlook calendar to Excel", "body": "<p>here's the code @Ryan Wildry wrote for you with a start and end date input, in case you want to export it for a specified period of time. You need to add the following lines:</p>\n\n<pre><code>Dim FromDate As Date\n    Dim ToDate As Date\n\n   FromDate = InputBox(\"Enter the start date (format: yyyy/mm/dd)\")\n   ToDate = InputBox(\"Enter the end date(format: yyyy/mm/dd)\")\n   For Each olApt In olFolder.Items\n    If (olApt.Start &gt;= FromDate And olApt.Start &lt;= ToDate) Then\n        myArr(0, NextRow) = olApt.Subject\n        myArr(1, NextRow) = olApt.Start\n        myArr(2, NextRow) = olApt.End\n        myArr(3, NextRow) = olApt.Categories\n        NextRow = NextRow + 1\n        Else\n        End If\n    Next\n    On Error GoTo 0\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 8682954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03304bbbf9a47cc0bd625790d5f31a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Rixius", "link": "https://stackoverflow.com/users/8682954/rixius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5028, "favorite_count": 0, "accepted_answer_id": 46448705, "answer_count": 3, "score": 1, "last_activity_date": 1581086225, "creation_date": 1506515523, "last_edit_date": 1506559187, "question_id": 46447945, "link": "https://stackoverflow.com/questions/46447945/extracting-appointments-from-shared-outlook-calendar-to-excel", "title": "Extracting appointments from shared Outlook calendar to Excel", "body": "<p>I am trying to extract appointments from a shared Outlook calendar to Excel using a VBA macro in Excel. The code fails whether I try to define <strong>objOwner</strong> and <strong>olFolderCalendar</strong> as either <strong>Object</strong> or <strong>Outlook.Recipient</strong> / <strong>Outlook.Folder</strong> for use in the <strong>GetSharedDefaultFolder</strong> method.</p>\n\n<p>I get the <strong>Run-time error '13': Type mismatch</strong> error on the following line:</p>\n\n<pre><code>Set olFolder = olNS.GetSharedDefaultFolder(objOwner, olFolderCalendar)\n</code></pre>\n\n<p>What am I doing wrong?</p>\n\n<pre><code>Sub ListAppointments()\n\nDim olApp As Object\nDim olNS As Object\nDim olFolder As Object\nDim olApt As Object\nDim objOwner As Object\nDim olFolderCalendar As Object\n\nDim NextRow As Long\n\nSet olApp = CreateObject(\"Outlook.Application\")\n\nSet olNS = olApp.GetNamespace(\"MAPI\")\n\nSet objOwner = olNS.CreateRecipient(\"test@test.com\")\n\nobjOwner.Resolve\n\nIf objOwner.Resolved Then\n\n    MsgBox objOwner.Name\n    Set olFolder = olNS.GetSharedDefaultFolder(objOwner, olFolderCalendar)\n\nEnd If\n\nRange(\"A1:D1\").Value = Array(\"Subject\", \"Start\", \"End\", \"Location\")\n\nNextRow = 2\n\nFor Each olApt In olFolder.Items\n    Cells(NextRow, \"A\").Value = olApt.Subject\n    Cells(NextRow, \"B\").Value = olApt.Start\n    Cells(NextRow, \"C\").Value = olApt.End\n    Cells(NextRow, \"D\").Value = olApt.Location\n    NextRow = NextRow + 1\nNext olApt\n\nSet olApt = Nothing\nSet olFolder = Nothing\nSet olNS = Nothing\nSet olApp = Nothing\n\nColumns.AutoFit\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "primary-key", "auto-increment"], "comments": [{"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "edited": false, "score": 1, "creation_date": 1506514718, "post_id": 46447568, "comment_id": 79850977, "body": "You cannot change data type to autoncrement if table has data even in table layout editor. So, try to delete data, change data type and then import again. That may be tricky - you will need to update all foreign keys"}, {"owner": {"reputation": 2024, "user_id": 3718031, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/wfBC6.jpg?s=128&g=1", "display_name": "VBobCat", "link": "https://stackoverflow.com/users/3718031/vbobcat"}, "reply_to_user": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "edited": false, "score": 0, "creation_date": 1506515410, "post_id": 46447568, "comment_id": 79851403, "body": "@SergeyS. Thanks! If I wanted to delete all current data inside the Sub above, which command should I use?"}, {"owner": {"reputation": 2024, "user_id": 3718031, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/wfBC6.jpg?s=128&g=1", "display_name": "VBobCat", "link": "https://stackoverflow.com/users/3718031/vbobcat"}, "reply_to_user": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "edited": false, "score": 0, "creation_date": 1506516049, "post_id": 46447568, "comment_id": 79851809, "body": "@SergeyS. I know now: <code>DoCmd.RunSQL &quot;DELETE * FROM &quot; &amp; table.Name</code>"}, {"owner": {"reputation": 2024, "user_id": 3718031, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/wfBC6.jpg?s=128&g=1", "display_name": "VBobCat", "link": "https://stackoverflow.com/users/3718031/vbobcat"}, "reply_to_user": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "edited": false, "score": 0, "creation_date": 1506516320, "post_id": 46447568, "comment_id": 79852013, "body": "@SergeyS. But no, the error persists even if the tables are empty... :-("}], "owner": {"reputation": 2024, "user_id": 3718031, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/wfBC6.jpg?s=128&g=1", "display_name": "VBobCat", "link": "https://stackoverflow.com/users/3718031/vbobcat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 757, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1506514320, "creation_date": 1506514320, "question_id": 46447568, "link": "https://stackoverflow.com/questions/46447568/change-attributes-for-existing-field-with-access-vba", "title": "Change attributes for existing field with Access VBA", "body": "<p>I imported like 40 tables from MySql database to Access using ODBC driver, because that server will go down for several days and I need to keep my application running. Everything went fine (app accepted new connection to Access database) <strong><em>except</em></strong> for definition of primary key (each table's first field is named \"id\", has type Integer and is AutoIncremented, was lost during import.</p>\n\n<p>I tried to write a VBA Sub to restore these settings for imported tables, but it is raising error when trying to set AutoIncrement attribute. This is my code:</p>\n\n<pre><code>Option Explicit\nOption Compare Database\n\nPublic Sub RestorePrimaryKeys()\n    Dim db As dao.Database\n    Set db = CurrentDb()\n    Dim tables As dao.TableDefs\n    Set tables = db.TableDefs\n    Dim table As dao.TableDef\n    For Each table In tables\n        If table.Name Like \"table*\" Then\n            If table.Indexes.Count = 0 Then\n                If table.fields(0).Name = \"id\" Then\n                    Dim field As dao.Field2\n                    Set field = table.fields(0)\n\n                    field.Attributes = field.Attributes Or FieldAttributeEnum.dbAutoIncrField\n                    'raises \"Invalid operation (3219)\"\n\n                    Dim pkindex As Index\n                    Set pkindex = table.CreateIndex(\"Primary Key\")\n                    Dim fields As dao.fields\n                    Set fields = pkindex.fields\n                    fields.Append field\n                    pkindex.Primary = True\n                    table.Indexes.Append pkindex\n                End If\n            End If\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>Well, I could do it manually with table layout editor, but there are as I said about 40 tables. And if I could do it manually, why wouldn't I can with VBA? What am I doing wrong here?</p>\n\n<p>Thank you very much.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1506513659, "post_id": 46447289, "comment_id": 79850286, "body": "Can you run that query without the code? What happens then?"}], "answers": [{"comments": [{"owner": {"reputation": 1913, "user_id": 2470603, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6590b90317023caf0ae68e9709c5fcc6?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/2470603/michael"}, "edited": false, "score": 0, "creation_date": 1506516147, "post_id": 46447482, "comment_id": 79851888, "body": "You are correct - I do have reference to a form control in the query!"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 0, "last_activity_date": 1506514044, "creation_date": 1506514044, "answer_id": 46447482, "question_id": 46447289, "link": "https://stackoverflow.com/questions/46447289/run-time-error-3061-too-few-parameters-expected-1-access-2013/46447482#46447482", "title": "Run-time error &#39;3061&#39;. Too few parameters. Expected 1 Access 2013", "body": "<p>Most likely you have in your query a reference to a <em>form control</em>.</p>\n\n<p>The value from this you must pass as a parameter if you run the query from code.</p>\n\n<p>So, create a <em>QueryDef</em> object in your function, pass the parameter, and open your recordset from the QueryDef object.</p>\n"}], "owner": {"reputation": 1913, "user_id": 2470603, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6590b90317023caf0ae68e9709c5fcc6?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/2470603/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1081, "favorite_count": 0, "accepted_answer_id": 46447482, "answer_count": 1, "score": 0, "last_activity_date": 1506514044, "creation_date": 1506513460, "question_id": 46447289, "link": "https://stackoverflow.com/questions/46447289/run-time-error-3061-too-few-parameters-expected-1-access-2013", "title": "Run-time error &#39;3061&#39;. Too few parameters. Expected 1 Access 2013", "body": "<p>I use this line of code:</p>\n\n<pre><code>Call SendTQ2XLWbSheetData(\"qryCustExportStyColOnlyDrop\", \"Data\", \"C:\\Users\\\" &amp; GetLogonName() &amp; \"\\FWD Order Customer Export.xlsm\")\n</code></pre>\n\n<p>To call and pass parameters to this Function:</p>\n\n<pre><code>Public Function SendTQ2XLWbSheetData(strTQName As String, strSheetName As String, strFilePath As String)\n' strTQName is the name of the table or query you want to send to Excel\n' strSheetName is the name of the sheet you want to send it to\n' strFilePath is the name and path of the file you want to send this data into.\n\n    Dim rst As DAO.Recordset\n    Dim ApXL As Object\n    Dim xlWBk As Object\n    Dim xlWSh As Object\n    Dim fld As DAO.Field\n    Dim strPath As String\n    Const xlCenter As Long = -4108\n    Const xlBottom As Long = -4107\n    On Error GoTo err_handler\n\n    strPath = strFilePath\n\n    Set rst = CurrentDb.OpenRecordset(strTQName)\n\n    Set ApXL = CreateObject(\"Excel.Application\")\n\n    Set xlWBk = ApXL.Workbooks.Open(strPath)\n\n    ApXL.Visible = True\n\n    Set xlWSh = xlWBk.Worksheets(strSheetName)\n\n    xlWSh.Visible = True\n\n    xlWSh.Activate\n\n    'clear any current size ranges\n    ApXL.Range(\"DataRange\").Select\n    ApXL.Selection.ClearContents\n\n    xlWSh.Range(\"A1\").Select\n\n    For Each fld In rst.Fields\n        ApXL.ActiveCell = fld.Name\n        ApXL.ActiveCell.Offset(0, 1).Select\n    Next\n\n    rst.MoveFirst\n\n    xlWSh.Range(\"A2\").CopyFromRecordset rst\n\n    xlWSh.Visible = False\n\n\n    rst.Close\n\n    Set rst = Nothing\n\n\n    xlWBk.Close True\n\n    Set xlWBk = Nothing\n\n    ApXL.Quit\n\n    Set ApXL = Nothing\n\nExit_SendTQ2XLWbSheet:\n    Exit Function\n\nerr_handler:\n    DoCmd.SetWarnings True\n    MsgBox Err.Description, vbExclamation, Err.Number\n    Resume Exit_SendTQ2XLWbSheet\nEnd Function\n</code></pre>\n\n<p>However, when I run it I keep receiving error 3061 Too Few Parameters - Expected 1.  When I step through, it is this line of code causing the error:</p>\n\n<pre><code>Set rst = CurrentDb.OpenRecordset(strTQName)\n</code></pre>\n\n<p>However if I hover over the above line in debug, it is showing the name of the query (qryCustExportStyColOnlyDrop) I am passing.</p>\n\n<p>What am I missing?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["vba", "comparison-operators"], "answers": [{"comments": [{"owner": {"reputation": 534, "user_id": 2398630, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423e9611f4212cb6f66cd30c9da6410f?s=128&d=identicon&r=PG", "display_name": "Siyon DP", "link": "https://stackoverflow.com/users/2398630/siyon-dp"}, "edited": false, "score": 0, "creation_date": 1506511458, "post_id": 46446592, "comment_id": 79848909, "body": "highest_header_count is an integer, Case tests for <b>its</b> value.   When you put the Cases below, you actually test against Boolean values that are casted to ints."}], "tags": [], "owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "is_accepted": false, "score": 3, "last_activity_date": 1506511186, "creation_date": 1506511186, "answer_id": 46446592, "question_id": 46446282, "link": "https://stackoverflow.com/questions/46446282/vba-comparison-operators-evaluating-incorrect-with-case/46446592#46446592", "title": "VBA Comparison Operators Evaluating Incorrect with Case", "body": "<p>Your Select Case is comparing an integer with a value of 0 to a Boolean.</p>\n\n<p><code>a = b</code> is True which is -1,\n<code>a &lt; b</code> is False which is 0,\n<code>a &gt; b</code> is False which is 0.</p>\n\n<p>So that is why you are getting a hit on <code>a &lt; b</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 101, "user_id": 7524850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38a5563dea0d32093c89d4e1c8e1a6ad?s=128&d=identicon&r=PG&f=1", "display_name": "N Hanson", "link": "https://stackoverflow.com/users/7524850/n-hanson"}, "edited": false, "score": 0, "creation_date": 1506512492, "post_id": 46446638, "comment_id": 79849571, "body": "Ahhh that&#39;s where i was going wrong, major brain fart. <code>Select Case True</code> vs <code>Select Case ...no useful condition</code> Thank you very much!"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 101, "user_id": 7524850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38a5563dea0d32093c89d4e1c8e1a6ad?s=128&d=identicon&r=PG&f=1", "display_name": "N Hanson", "link": "https://stackoverflow.com/users/7524850/n-hanson"}, "edited": false, "score": 0, "creation_date": 1506512579, "post_id": 46446638, "comment_id": 79849613, "body": "@NHanson Don&#39;t worry, it happens with all of us. Glad you found it helpful."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1506512759, "post_id": 46446638, "comment_id": 79849703, "body": "@sktneer actualy you can use <code>Select Case a - b</code>, see my code below. Also, first 2 scenarios lead to the same result <code>highest_header_count = b</code>, so you can &quot;merge&quot; these 2 cases"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1506512993, "post_id": 46446638, "comment_id": 79849841, "body": "@ShaiRado Using case a-b is irrelevant here as you will have to evaluate all other cases based on this single case. Using True makes the code simple, easy to read and easy to understand. :)"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1506513087, "post_id": 46446638, "comment_id": 79849907, "body": "@sktneer tomato to-ma-to , at least merge both 2 first scenarios, or is it also easier to read this way ?"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1506513217, "post_id": 46446638, "comment_id": 79850009, "body": "@ShaiRado Well that&#39;s not a point to argue. It&#39;s just matter of your choice. :)"}, {"owner": {"reputation": 101, "user_id": 7524850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38a5563dea0d32093c89d4e1c8e1a6ad?s=128&d=identicon&r=PG&f=1", "display_name": "N Hanson", "link": "https://stackoverflow.com/users/7524850/n-hanson"}, "edited": false, "score": 1, "creation_date": 1506515120, "post_id": 46446638, "comment_id": 79851222, "body": "Thanks for the input all. I&#39;ve actually settled on a slightly less verbose solution that still satisfies my use case by using <code>iif()</code>. <code>a = 24, b = 24, highest_header = iif(a &lt; b, b, a)</code>"}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 1, "last_activity_date": 1506511336, "creation_date": 1506511336, "answer_id": 46446638, "question_id": 46446282, "link": "https://stackoverflow.com/questions/46446282/vba-comparison-operators-evaluating-incorrect-with-case/46446638#46446638", "title": "VBA Comparison Operators Evaluating Incorrect with Case", "body": "<p>You need IF Else statements instead of Select Case here.\nAlso in the Select Case you are using the wrong variable highest_header_count.</p>\n\n<pre><code>Sub highest_header()\nDim highest_header_count As Integer\nDim a As Integer\nDim b As Integer\n\na = 24\nb = 24\n\nDebug.Print a '24\nDebug.Print b '24\nDebug.Print TypeName(a) 'Integer\nDebug.Print TypeName(b) 'Integer\n\nIf a = b Then\n    highest_header_count = b\nElseIf a &lt; b Then\n    highest_header_count = b\nElseIf a &gt; b Then\n    highest_header_count = a\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>OR use your code like this...</p>\n\n<pre><code>Sub highest_header()\nDim highest_header_count As Integer\nDim a As Integer\nDim b As Integer\n\na = 24\nb = 24\n\nDebug.Print a '24\nDebug.Print b '24\nDebug.Print TypeName(a) 'Integer\nDebug.Print TypeName(b) 'Integer\n\nSelect Case True\n    Case a = b\n        highest_header_count = b\n    Case a &lt; b\n        highest_header_count = b\n    Case a &gt; b\n        highest_header_count = a\nEnd Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 3, "last_activity_date": 1506511345, "creation_date": 1506511345, "answer_id": 46446643, "question_id": 46446282, "link": "https://stackoverflow.com/questions/46446282/vba-comparison-operators-evaluating-incorrect-with-case/46446643#46446643", "title": "VBA Comparison Operators Evaluating Incorrect with Case", "body": "<hr>\n\n<pre><code>Option Explicit\n\nPublic Sub HighestHeader()\n    Dim highest_header_count As Long\n    Dim a As Long\n    Dim b As Long\n\n    a = 24\n    b = 24\n\n    Debug.Print a '24\n    Debug.Print b '24\n    Debug.Print TypeName(a) 'Long\n    Debug.Print TypeName(b) 'Long\n\n    Select Case a\n        Case Is = b\n            highest_header_count = b\n        Case Is &lt; b\n            highest_header_count = b\n        Case Is &gt; b\n            highest_header_count = a\n    End Select\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>You are comparing <code>highest_header_count</code> against the 3 comparisons (<code>a = b</code>, etc)</p>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1506512868, "last_edit_date": 1506512868, "creation_date": 1506512513, "answer_id": 46446982, "question_id": 46446282, "link": "https://stackoverflow.com/questions/46446282/vba-comparison-operators-evaluating-incorrect-with-case/46446982#46446982", "title": "VBA Comparison Operators Evaluating Incorrect with Case", "body": "<p><strong>Or</strong>, you can use <code>Select Case</code>, just \"trick\" it a little.</p>\n\n<p>You can use <code>Select Case a - b</code> , and then check <code>Case 0</code>, <code>Case Is &lt; 0</code> and <code>Case Is &gt; 0</code>, see my code below:</p>\n\n<pre><code>Sub highest_header()\n\nDim highest_header_count As Integer\nDim a As Integer\nDim b As Integer\n\na = 24\nb = 24\n\nDebug.Print a '24\nDebug.Print b '24\nDebug.Print TypeName(a) 'Integer\nDebug.Print TypeName(b) 'Integer\n\nSelect Case a - b\n    Case 0\n        highest_header_count = b\n    Case Is &lt; 0\n        highest_header_count = b\n    Case Is &gt; 0\n        highest_header_count = a\nEnd Select\n\nEnd Sub\n</code></pre>\n\n<p>You can make the <code>Select Case</code> even shorter:</p>\n\n<pre><code>Select Case a - b\n    Case 0, Is &lt; 0 ' &lt;-- both scenarios lead to the same result\n        highest_header_count = b      \n    Case Is &gt; 0\n        highest_header_count = a\nEnd Select\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 7524850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38a5563dea0d32093c89d4e1c8e1a6ad?s=128&d=identicon&r=PG&f=1", "display_name": "N Hanson", "link": "https://stackoverflow.com/users/7524850/n-hanson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 1, "accepted_answer_id": 46446638, "answer_count": 4, "score": 2, "last_activity_date": 1506512868, "creation_date": 1506510251, "last_edit_date": 1506510897, "question_id": 46446282, "link": "https://stackoverflow.com/questions/46446282/vba-comparison-operators-evaluating-incorrect-with-case", "title": "VBA Comparison Operators Evaluating Incorrect with Case", "body": "<p>I have a code block which is consistently evaluating incorrectly . I'm at a loss as to why this might be. </p>\n\n<p>I've determined that it must be something to do with my 'Select Case' at the very least. If the order of operators is changed, e.g. <code>=, &gt;, &lt;</code> or <code>&lt;, =, &gt;</code> etc. the evaluation changes. </p>\n\n<p>My expectation is that the evaluation would be <code>a = b</code> with the eventuality that <code>highest_header = 24</code> - While <code>24</code> is inevitably assigned to <code>highest_header</code>, my code does so using what I believe to be the wrong 'Case'.</p>\n\n<p>I have simplified the code snippet slightly, but the result is the same - the comparison is being evaluated as <code>a = b = FALSE</code> and <code>a &lt; b = TRUE</code></p>\n\n<pre><code>Sub highest_header()\nDim highest_header_count As Integer\nDim a As Integer\nDim b As Integer\n\na = 24\nb = 24\n\nDebug.Print a '24\nDebug.Print b '24\nDebug.Print TypeName(a) 'Integer\nDebug.Print TypeName(b) 'Integer\n\nSelect Case highest_header_count\n    Case a = b\n        highest_header_count = b\n    Case a &lt; b\n        highest_header_count = b\n    Case a &gt; b\n        highest_header_count = a\nEnd Select\n\nEnd Sub\n</code></pre>\n\n<p>Any insight would be appreciated.</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1506510680, "post_id": 46446226, "comment_id": 79848382, "body": "This can be done in 3 steps without VBA. If you are interested let me know. The same 3 steps can be written in code and it will probably work more efficiently and faster than what you have here. Again, if you are interested, I can explain in an answer."}, {"owner": {"reputation": 59, "user_id": 1685602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2ccec9914cc6052a1a088b1b1e25cef6?s=128&d=identicon&r=PG", "display_name": "NelsonFerro", "link": "https://stackoverflow.com/users/1685602/nelsonferro"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1506520125, "post_id": 46446226, "comment_id": 79854875, "body": "Hi Scott, thank you for your comment, I believe that all examples are useful for the solving of this situation, if you could provide an answer it would be great."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 1685602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2ccec9914cc6052a1a088b1b1e25cef6?s=128&d=identicon&r=PG", "display_name": "NelsonFerro", "link": "https://stackoverflow.com/users/1685602/nelsonferro"}, "edited": false, "score": 0, "creation_date": 1506519455, "post_id": 46446364, "comment_id": 79854348, "body": "Thank you very much for you support.  I only have one extra question. The variable &quot;MaxDateCurrentIM&quot; is currently as type Date, and that throws an error of Type Mismatch.  The same thing happens if it&#39;s define as string, and if I define it as range it gives a error of &quot;Object variable or With block variable not set&quot;  Any ideias why?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1506521760, "post_id": 46446364, "comment_id": 79856100, "body": "When it errors, what is the value of MaxDateCurrentIM?"}, {"owner": {"reputation": 59, "user_id": 1685602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2ccec9914cc6052a1a088b1b1e25cef6?s=128&d=identicon&r=PG", "display_name": "NelsonFerro", "link": "https://stackoverflow.com/users/1685602/nelsonferro"}, "edited": false, "score": 0, "creation_date": 1506521876, "post_id": 46446364, "comment_id": 79856188, "body": "It errors exactly when trying to set the value in MaxDateCurrentIM: MaxDateCurrentIM = Evaluate(&quot;=MAX(IF(&quot; &amp; imrange.Address &amp; &quot;=&quot; &amp; currentIM &amp; &quot;,&quot; &amp; dateRange.Address &amp; &quot;))&quot;)"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1506522207, "post_id": 46446364, "comment_id": 79856427, "body": "OK, but what do you think the value should be - have you checked? Perhaps there is an error value?"}, {"owner": {"reputation": 59, "user_id": 1685602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2ccec9914cc6052a1a088b1b1e25cef6?s=128&d=identicon&r=PG", "display_name": "NelsonFerro", "link": "https://stackoverflow.com/users/1685602/nelsonferro"}, "edited": false, "score": 0, "creation_date": 1506523053, "post_id": 46446364, "comment_id": 79857014, "body": "In this case for IM IM1131366 the value should be 12-09-2017  08:21:02 and if I apply the formula in one cell in the sheet that is the value it returns."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 59, "user_id": 1685602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2ccec9914cc6052a1a088b1b1e25cef6?s=128&d=identicon&r=PG", "display_name": "NelsonFerro", "link": "https://stackoverflow.com/users/1685602/nelsonferro"}, "edited": false, "score": 0, "creation_date": 1506523199, "post_id": 46446364, "comment_id": 79857138, "body": "Try putting this &quot;=MAX(IF(&quot; &amp; imrange.Address &amp; &quot;=&quot; &amp; currentIM &amp; &quot;,&quot; &amp; dateRange.Address &amp; &quot;))&quot; in a message box or the immediate window and check the resultant string is as you expect."}, {"owner": {"reputation": 59, "user_id": 1685602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2ccec9914cc6052a1a088b1b1e25cef6?s=128&d=identicon&r=PG", "display_name": "NelsonFerro", "link": "https://stackoverflow.com/users/1685602/nelsonferro"}, "edited": false, "score": 0, "creation_date": 1506524899, "post_id": 46446364, "comment_id": 79858326, "body": "Well in the immediate window it returns a compile error expected expression. However I&#39;ve put a message box in the code and the return is: &quot;Evaluate(=MAX(IF($A$2:$A$5897=IM1131366;$E$2:$E$5896))&quot; Witch is wrong it shoul be &quot;IM1131366&quot; and not IM1131366 without the &quot;&quot; so I modify the code to: =MAX(IF(&quot; &amp; imRange.Address &amp; &quot;=&quot;&quot;&quot; &amp; currentIM &amp; &quot;&quot;&quot;;&quot; &amp; dateRange.Address &amp; &quot;)). And if I copy the msgbox result to the cell works fine. But in VBA it still gives the same error."}, {"owner": {"reputation": 59, "user_id": 1685602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2ccec9914cc6052a1a088b1b1e25cef6?s=128&d=identicon&r=PG", "display_name": "NelsonFerro", "link": "https://stackoverflow.com/users/1685602/nelsonferro"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1506525217, "post_id": 46446364, "comment_id": 79858540, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/155437/discussion-between-nelsonferro-and-sjr\">continue this discussion in chat</a>."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 59, "user_id": 1685602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2ccec9914cc6052a1a088b1b1e25cef6?s=128&d=identicon&r=PG", "display_name": "NelsonFerro", "link": "https://stackoverflow.com/users/1685602/nelsonferro"}, "edited": false, "score": 0, "creation_date": 1506525268, "post_id": 46446364, "comment_id": 79858572, "body": "<code>MaxDateCurrentIM = Evaluate(&quot;=MAX(IF(&quot; &amp; imrange.Address &amp; &quot;=&quot;&quot;&quot; &amp; currentIM &amp; &quot;&quot;&quot;,&quot; &amp; dateRange.Address &amp; &quot;))&quot;)</code> should do it (amended above)."}, {"owner": {"reputation": 59, "user_id": 1685602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2ccec9914cc6052a1a088b1b1e25cef6?s=128&d=identicon&r=PG", "display_name": "NelsonFerro", "link": "https://stackoverflow.com/users/1685602/nelsonferro"}, "edited": false, "score": 0, "creation_date": 1506591429, "post_id": 46446364, "comment_id": 79886489, "body": "Even this didn&#39;t solve the problem 100% it got me in the right direction. Thank you SJR"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 59, "user_id": 1685602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2ccec9914cc6052a1a088b1b1e25cef6?s=128&d=identicon&r=PG", "display_name": "NelsonFerro", "link": "https://stackoverflow.com/users/1685602/nelsonferro"}, "edited": false, "score": 0, "creation_date": 1506591650, "post_id": 46446364, "comment_id": 79886654, "body": "That&#39;s funny, it worked for me. Thanks for accepting the answer."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1506525202, "last_edit_date": 1506525202, "creation_date": 1506510506, "answer_id": 46446364, "question_id": 46446226, "link": "https://stackoverflow.com/questions/46446226/vba-excel-2010-delete-rows-without-max-value-of-column-based-in-another-column/46446364#46446364", "title": "VBA Excel 2010 - Delete Rows without max value of column based in another column", "body": "<p>Can you try this? Your formula syntax was off I think. (Also why set currentIM twice?) Plus, when deleting rows you need to go backwards.</p>\n\n<pre><code>Public Sub sbMaxDateByIM()\n\nDim max As Date\nDim currentIM As String\nDim MaxDateCurrentIM As Date\nDim dateRange As Range\nDim imrange As Range\n\nWith Sheets(\"sheet1\")\n    Set dateRange = .Range(.Range(\"E2\"), .Range(\"E2\").End(xlDown))\n    Set imrange = .Range(.Range(\"A2\"), .Range(\"A2\").End(xlDown))\nEnd With\n\nApplication.ScreenUpdating = False\nApplication.Sheets(\"UniqueIMS\").Activate\n\nFor IM = 1 To Range(Range(\"A1\"), Range(\"A1\").End(xlDown)).Rows.Count\n    currentIM = Sheets(\"sheet1\").Cells(IM, 1).Value\n    MaxDateCurrentIM = Evaluate(\"=MAX(IF(\" &amp; imrange.Address &amp; \"=\"\"\" &amp; currentIM &amp; \"\"\",\" &amp; dateRange.Address &amp; \"))\")\n    For J = Range(Range(\"E2\"), Range(\"E2\").End(xlDown)).Rows.Count + 1 To 2 Step -1\n        If currentIM = Sheets(\"Sheet1\").Cells(IM, 1).Value And CDate(Sheets(\"Sheet1\").Cells(J, 5).Value) &lt; MaxDateCurrentIM Then\n            Rows(J).EntireRow.Delete\n        End If\n    Next J\nNext IM\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1506510543, "creation_date": 1506510543, "answer_id": 46446379, "question_id": 46446226, "link": "https://stackoverflow.com/questions/46446226/vba-excel-2010-delete-rows-without-max-value-of-column-based-in-another-column/46446379#46446379", "title": "VBA Excel 2010 - Delete Rows without max value of column based in another column", "body": "<p>Evaluate is used to run Excel functions - but Excel has no idea what imrange and currentim are, they only exist inside the vba routine. You either need to rewrite your maxif in terms excel understands, or use vba code to do the same job as maxif</p>\n"}], "owner": {"reputation": 59, "user_id": 1685602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2ccec9914cc6052a1a088b1b1e25cef6?s=128&d=identicon&r=PG", "display_name": "NelsonFerro", "link": "https://stackoverflow.com/users/1685602/nelsonferro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 46446364, "answer_count": 2, "score": 0, "last_activity_date": 1506525202, "creation_date": 1506510050, "last_edit_date": 1506522061, "question_id": 46446226, "link": "https://stackoverflow.com/questions/46446226/vba-excel-2010-delete-rows-without-max-value-of-column-based-in-another-column", "title": "VBA Excel 2010 - Delete Rows without max value of column based in another column", "body": "<p>I've got an excel spreadsheet with several columns, two of them have an ID (that repeats itself) and a date.</p>\n\n<p>What I'm trying to accomplish is to delete all rows by ID leaving only the row with the max date.</p>\n\n<p>I have a second sheet with all the unique IM's.</p>\n\n<p>This is what I have at the moment:</p>\n\n<pre><code>Public Sub sbMaxDateByIM()\n\nDim max As Date\nDim currentIM As String\nDim MaxDateCurrentIM As Date\nDim dateRange As Range\nDim imrange As Range\n\nApplication.Sheets(\"sheet1\").Activate\n\n\nSet dateRange = ActiveSheet.Range(ActiveSheet.Range(\"E2\"), ActiveSheet.Range(\"E2\").End(xlDown))\nSet imrange = ActiveSheet.Range(ActiveSheet.Range(\"A2\"), ActiveSheet.Range(\"A2\").End(xlDown))\n\nApplication.ScreenUpdating = False\nApplication.Sheets(\"UniqueIMS\").Activate\n\n    For IM = 1 To ActiveSheet.Range(ActiveSheet.Range(\"A1\"), ActiveSheet.Range(\"A1\").End(xlDown)).Rows.Count\n\n           currentIM = Sheets(\"UniqueIMS\").Cells(IM, 1).Value\n\n            MaxDateCurrentIM = Evaluate(\"=MAX(IF(\"\"imrange\"\"=\"\"currentIM\"\",))\"\"dateRange\"\"\")\n\n        For J = 2 To Range(Range(\"E2\"), Range(\"E2\").End(xlDown)).Rows.Count + 1\n\n             If currentIM = Sheets(\"Sheet1\").Cells(IM, 1).Value And CDate(Sheets(\"Sheet1\").Cells(J, 5).Value) &lt; MaxDateCurrentIM Then\n                Rows(J).EntireRow.Delete\n             End If\n\n        Next J\n    Next IM\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Any ideias would be very much appreciated, the line of code not working is:</p>\n\n<pre><code>MaxDateCurrentIM = Evaluate(\"=MAX(IF(\"\"imrange\"\"=\"\"currentIM\"\",))\"\"dateRange\"\"\")\n</code></pre>\n"}, {"tags": ["vba", "excel", "oledb", "powerquery"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6504349, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vsCKL.jpg?s=128&g=1", "display_name": "poisonapple_x", "link": "https://stackoverflow.com/users/6504349/poisonapple-x"}, "edited": false, "score": 0, "creation_date": 1506593132, "post_id": 46446693, "comment_id": 79887680, "body": "I did try a few variations of DoEvents but it doesn&#39;t seem to process the load. Tried this to be sure though and sadly still doesn&#39;t work, tried moving it to directly after the refresh but still no joy. The funny thing is if I put a break in the code or step through it the load will complete, it&#39;s like the code needs to physically stop executing before it will update the load status."}], "tags": [], "owner": {"reputation": 1269, "user_id": 6065711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bedb05fd942a5a6acd9870d295d3afd9?s=128&d=identicon&r=PG&f=1", "display_name": "Jochen", "link": "https://stackoverflow.com/users/6065711/jochen"}, "is_accepted": false, "score": 1, "last_activity_date": 1506511535, "creation_date": 1506511535, "answer_id": 46446693, "question_id": 46446171, "link": "https://stackoverflow.com/questions/46446171/power-query-tables-wont-download-data-until-vba-finishes-executing/46446693#46446693", "title": "Power Query Tables won&#39;t download data until VBA finishes executing", "body": "<p>Instead of <code>Application.Wait</code> try the following:</p>\n\n<pre><code>Do until now() &gt;= waittime\n    DoEvents\nLoop\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6504349, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vsCKL.jpg?s=128&g=1", "display_name": "poisonapple_x", "link": "https://stackoverflow.com/users/6504349/poisonapple-x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 807, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1508602127, "creation_date": 1506509868, "last_edit_date": 1508602127, "question_id": 46446171, "link": "https://stackoverflow.com/questions/46446171/power-query-tables-wont-download-data-until-vba-finishes-executing", "title": "Power Query Tables won&#39;t download data until VBA finishes executing", "body": "<p>I have a spreadsheet with 4 worksheets, each one connected to a power query which connects to an OLEDB database and runs a select to import data into the workbook.</p>\n\n<p>I am trying to automate the refresh of the queries.</p>\n\n<p>I have VBA in the workbook which<br>\n - disables background refresh,<br>\n - runs Workbook.RefreshAll,<br>\n - resets the background refresh to true (as I need this for the automation software to be able to run it in the first place) and<br>\n - then waits 30 seconds to give the automation software a bit of time before it starts saving the workbook.</p>\n\n<p>All the software does is call the macro in the workbook and then save following execution.</p>\n\n<p>The queries correctly execute one after the other and I can tell the data in the tables has refreshed.</p>\n\n<p>The power query confirmation that the rows have been downloaded happens after the VBA completes executing, so the automation software saves it before this is done and Excel reports the download as having failed. This isn't a problem when everything works, but we won't know when the download has truly failed, unless I add in some sort of a row count comparison which is really a workaround rather than an actual solution.</p>\n\n<p>I have tried creating two subs in the workbook, one to do the refresh and then another which calls the first sub and then waits 30 seconds, I was hoping the download would complete after the first sub finishes executing, but this doesn't happen. I have tried refreshing one connection at a time instead of using RefreshAll, tried refreshing the actual power query tables instead of the connections and have tried refreshing with background query set to true and then looping until the refresh is marked as complete (which works if you step through it, but crashes if you just run the VBA in full).</p>\n\n<p>I also tried saving the spreadsheet at the end of the VBA, but it still waits until the save is complete to update the power query status.</p>\n\n<p>My latest VBA:</p>\n\n<pre><code>Sub Workbook_RefreshAll()\n\nApplication.DisplayAlerts = False\n\nFor Each objConnection In ThisWorkbook.Connections\n\n    'Temporarily disable background-refresh\n    objConnection.OLEDBConnection.BackgroundQuery = False\n    objConnection.OLEDBConnection.MaintainConnection = False\n\nNext\n\nActiveWorkbook.RefreshAll\n\nFor Each objConnection In ThisWorkbook.Connections\n\n    'Re-enable background-refresh\n    objConnection.OLEDBConnection.BackgroundQuery = True\n    objConnection.OLEDBConnection.MaintainConnection = True\n\nNext\n\nnewHour = Hour(Now())\nnewMinute = Minute(Now())\nnewSecond = Second(Now()) + 30\nwaitTime = TimeSerial(newHour, newMinute, newSecond)\n\nApplication.Wait waitTime\n\nEnd Sub\n</code></pre>\n\n<p>(I can't remember whether the maintain connection parameter actually helped as I as trying to force the connection to drop after each refresh, but it works so haven't taken it out.)</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 321, "user_id": 4915723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b8417efa4b79cbcf3463d38ccfedb7b5?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Bailey", "link": "https://stackoverflow.com/users/4915723/sean-bailey"}, "edited": false, "score": 1, "creation_date": 1506511852, "post_id": 46446161, "comment_id": 79849176, "body": "@SeanBailey I would be careful using <code>IsEmpty</code> function, be careful of the &quot;hiding&quot; spaces. That function won&#39;t consider a cell with space in it as <code>Empty</code>, the <code>Trim</code> option will get rid of all the spaces"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 2, "last_activity_date": 1506509847, "creation_date": 1506509847, "answer_id": 46446161, "question_id": 46446091, "link": "https://stackoverflow.com/questions/46446091/worksheet-change-event/46446161#46446161", "title": "Worksheet Change Event", "body": "<p>Replace:</p>\n\n<pre><code>If KeyCells Is Nothing Then Exit Sub\n</code></pre>\n\n<p>With:</p>\n\n<pre><code>If Trim(WSname) = \"\" Then Exit Sub\n</code></pre>\n\n<p><strong>Explanation</strong>: you already use <code>Set KeyCells = Range(\"I16\")</code> in your code, so you set your <code>KeyCells</code> Range, therefore it will never be <code>Nothing</code>.\nYou want to check the value of <code>KeyCells</code> range, and you have your <code>WSname</code> String variable.</p>\n"}, {"tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": true, "score": 1, "last_activity_date": 1506509934, "creation_date": 1506509934, "answer_id": 46446199, "question_id": 46446091, "link": "https://stackoverflow.com/questions/46446091/worksheet-change-event/46446199#46446199", "title": "Worksheet Change Event", "body": "<p>Instead of </p>\n\n<pre><code>If KeyCells Is Nothing Then Exit Sub\n</code></pre>\n\n<p>use</p>\n\n<pre><code>If IsEmpty(KeyCells) Then Exit Sub\n</code></pre>\n\n<p>The <strong>ISEMPTY</strong> function can be used to check for blank cells. If cell is blank it will return <code>TRUE</code> else <code>FALSE</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 179, "user_id": 7684046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/527159e9ffe0426a59486efdebaa278b?s=128&d=identicon&r=PG&f=1", "display_name": "Lincoln", "link": "https://stackoverflow.com/users/7684046/lincoln"}, "is_accepted": false, "score": 0, "last_activity_date": 1506509935, "creation_date": 1506509935, "answer_id": 46446200, "question_id": 46446091, "link": "https://stackoverflow.com/questions/46446091/worksheet-change-event/46446200#46446200", "title": "Worksheet Change Event", "body": "<p>You are already declare and set KeyCells to \"I16\". This is why if condition doesnt work - because KeyCells already contains cell. Ask if WSname = \"\" or check other way if it contains value or no.</p>\n"}, {"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 0, "last_activity_date": 1506510619, "creation_date": 1506510619, "answer_id": 46446402, "question_id": 46446091, "link": "https://stackoverflow.com/questions/46446091/worksheet-change-event/46446402#46446402", "title": "Worksheet Change Event", "body": "<p>I think the correct way to use Change Event code is to tell the code when to be automatically triggered and perform some actions.</p>\n\n<p>Right now, your code will be triggered and perform the actions defined in the code each time when any cell on the sheet gets changed.</p>\n\n<p><strong>I assume, you want to trigger the Change Event Code and perform some predefined actions only when the cell I16 gets changed and then rename the sheets as per the code. Right?</strong></p>\n\n<p>If so, you may try something like this...</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Target.CountLarge &gt; 1 Then Exit Sub\nDim KeyCells As Range\nSet KeyCells = Range(\"I16\")\nDim WSname As String\nWSname = Range(\"I16\").Value\n\nIf Not Intersect(Target, KeyCells) Is Nothing Then\n    If Target &lt;&gt; \"\" Then\n        Sheet23.Name = \"BISSB\"\n        Sheet25.Name = \"RMIB\"\n        Sheet26.Name = \"MORIB\"\n        Worksheets(WSname).Name = \"Stage 3 V1\"\n    End If\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 321, "user_id": 4915723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b8417efa4b79cbcf3463d38ccfedb7b5?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Bailey", "link": "https://stackoverflow.com/users/4915723/sean-bailey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 358, "favorite_count": 0, "accepted_answer_id": 46446199, "answer_count": 4, "score": 1, "last_activity_date": 1506510619, "creation_date": 1506509668, "last_edit_date": 1531164843, "question_id": 46446091, "link": "https://stackoverflow.com/questions/46446091/worksheet-change-event", "title": "Worksheet Change Event", "body": "<p>I have the below code which I effectively want to rename worksheets based on the Value of I16. However if the target address is blank/ Nothing I wish to exit the sub. (this part of the code is not working).</p>\n\n<p>If anyone could advise how I could resolve this issue it would be greatly appreciated.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim KeyCells As Range\nSet KeyCells = Range(\"I16\")\nDim WSname As String\nWSname = Range(\"I16\").Value\n\nIf KeyCells Is Nothing Then Exit Sub\n\nSheet23.Name = \"BISSB\"\nSheet25.Name = \"RMIB\"\nSheet26.Name = \"MORIB\"\nWorksheets(WSname).Name = \"Stage 3 V1\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 0, "creation_date": 1506508814, "post_id": 46445555, "comment_id": 79847107, "body": "Well how have you kept the leading zeros in column A? I imagine you&#39;ve done something like formatting them as text? In that case, do something similar for the new column"}], "answers": [{"tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1506508773, "creation_date": 1506508773, "answer_id": 46445748, "question_id": 46445555, "link": "https://stackoverflow.com/questions/46445555/copying-formatting-in-excel/46445748#46445748", "title": "Copying Formatting in Excel", "body": "<p>If this is a formatting issue, why not copy the format with <code>PasteSpecial</code> for the whole column.</p>\n\n<pre><code>Columns(\"B\").Copy\nColumns(\"A\").PasteSpecial Paste:=xlPasteFormats\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 129, "user_id": 5422778, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fe13b488fe52181a97dd0d6a0f10f149?s=128&d=identicon&r=PG&f=1", "display_name": "Big_Papa_B", "link": "https://stackoverflow.com/users/5422778/big-papa-b"}, "edited": false, "score": 0, "creation_date": 1506511009, "post_id": 46445925, "comment_id": 79848623, "body": "Hello, Thank you, this worked great, the code is now working"}], "tags": [], "owner": {"reputation": 44, "user_id": 3852433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6880f8ffbfcc886108a40c9451ea8d0?s=128&d=identicon&r=PG", "display_name": "Tony Wilson", "link": "https://stackoverflow.com/users/3852433/tony-wilson"}, "is_accepted": true, "score": 1, "last_activity_date": 1506509198, "creation_date": 1506509198, "answer_id": 46445925, "question_id": 46445555, "link": "https://stackoverflow.com/questions/46445555/copying-formatting-in-excel/46445925#46445925", "title": "Copying Formatting in Excel", "body": "<p>Try adding the line</p>\n\n<pre><code>Columns(\"A:A\").NumberFormat = \"@\"\n</code></pre>\n\n<p>after the <code>Selection.Insert</code>.  This will make the format of the whole column text which is the only way that you will not lose the leading zeroes on numbers.</p>\n"}, {"comments": [{"owner": {"reputation": 129, "user_id": 5422778, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fe13b488fe52181a97dd0d6a0f10f149?s=128&d=identicon&r=PG&f=1", "display_name": "Big_Papa_B", "link": "https://stackoverflow.com/users/5422778/big-papa-b"}, "edited": false, "score": 0, "creation_date": 1506511088, "post_id": 46446029, "comment_id": 79848668, "body": "Thank you for the response, but I was still facing the same issue, using the Columns(&quot;A:A&quot;).NumberFormat = &quot;@&quot; as suggested below corrected the issue"}], "tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": false, "score": 0, "last_activity_date": 1506509491, "creation_date": 1506509491, "answer_id": 46446029, "question_id": 46445555, "link": "https://stackoverflow.com/questions/46445555/copying-formatting-in-excel/46446029#46446029", "title": "Copying Formatting in Excel", "body": "<p>Try this</p>\n\n<pre><code>Sub CopyBoldText()\n    Columns(\"A\").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromRightOrAbove\n    Columns(\"B\").Copy\n    Columns(\"A\").PasteSpecial xlPasteFormats\n    Application.CutCopyMode = False\n\n    Dim c As Range\n    For Each c In Intersect(Columns(\"B\"), ActiveSheet.UsedRange)\n        If c.Font.Bold Then c.Offset(, -1).Value = c.Value\n    Next c\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 5422778, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fe13b488fe52181a97dd0d6a0f10f149?s=128&d=identicon&r=PG&f=1", "display_name": "Big_Papa_B", "link": "https://stackoverflow.com/users/5422778/big-papa-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 46445925, "answer_count": 3, "score": 0, "last_activity_date": 1506512736, "creation_date": 1506508130, "last_edit_date": 1506512736, "question_id": 46445555, "link": "https://stackoverflow.com/questions/46445555/copying-formatting-in-excel", "title": "Copying Formatting in Excel", "body": "<p>I am facing an issue with a small piece of VBA I have been using.</p>\n\n<p>I have values in Column A, I want only values in bold to remain into Column A.</p>\n\n<p>The Code I am using is:</p>\n\n<pre><code>Sub CopyBoldText()\nColumns(\"A:A\").Select\nSelection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrBelow = 0\nDim c As Range\nFor Each c In Intersect(Columns(\"B\"), ActiveSheet.UsedRange)\nIf c.Font.Bold Then c.Offset(, -1).Value = c.Value\nNext c\nEnd Sub\n</code></pre>\n\n<p>My issue is that the values in Column A are numbers with proceeding zero's when the values are copied and inserted in Column A these leading values are dropped.</p>\n\n<p>I have tried varying the CopyOrigin switch between the following :</p>\n\n<pre><code>xlFormatFromLeftOrBelow = 0\nxlFormatFromLeftOrBelow = 1\nxlFormatFromRightOrBelow = 0\nxlFormatFromRightOrBelow = 1\n</code></pre>\n\n<p>But each time the values still appear without the leading Zeroes.</p>\n"}, {"tags": ["vba", "excel", "userform"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1506506813, "post_id": 46445027, "comment_id": 79845844, "body": "Is this a typo? <code>.Cells(2.1)</code> Don&#39;t see how the code can work at all if not."}, {"owner": {"reputation": 179, "user_id": 7684046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/527159e9ffe0426a59486efdebaa278b?s=128&d=identicon&r=PG&f=1", "display_name": "Lincoln", "link": "https://stackoverflow.com/users/7684046/lincoln"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1506507205, "post_id": 46445027, "comment_id": 79846096, "body": "What do you mean &quot;typo&quot;? And yes it works :)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1506507330, "post_id": 46445027, "comment_id": 79846169, "body": "@SJR - <code>Cells(2.1)</code> is translated to <code>Cells(2)</code> and this is exactly what the OP wants. That&#39;s a bit strange, it both works and does not work in the same time. :)"}, {"owner": {"reputation": 179, "user_id": 7684046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/527159e9ffe0426a59486efdebaa278b?s=128&d=identicon&r=PG&f=1", "display_name": "Lincoln", "link": "https://stackoverflow.com/users/7684046/lincoln"}, "edited": false, "score": 0, "creation_date": 1506507499, "post_id": 46445027, "comment_id": 79846284, "body": "oh crap. Haven&#39;t even noticed that it is written with <b>dot</b> &quot;.&quot;, thanks. But still it works :)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1506507591, "post_id": 46445027, "comment_id": 79846346, "body": "@Lincoln - it works, but not exactly the way it should be. It works as if it is <code>Cells(2)</code>, and it gives you B1. If it was <code>Cells(2,1)</code>, it should have been A2."}, {"owner": {"reputation": 179, "user_id": 7684046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/527159e9ffe0426a59486efdebaa278b?s=128&d=identicon&r=PG&f=1", "display_name": "Lincoln", "link": "https://stackoverflow.com/users/7684046/lincoln"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1506507726, "post_id": 46445027, "comment_id": 79846441, "body": "Edited! @Vityata What about copy of the whole sheet range? why it does not work time to time!?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1506508232, "post_id": 46445027, "comment_id": 79846769, "body": "@Vityata - thanks, that surprises me, learnt something new. Lincoln - I suggest you comment out the On Error line so you can see what&#39;s going on."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1506508447, "post_id": 46445027, "comment_id": 79846900, "body": "Also where do you declare <code>lrow</code> and <code>lcol</code>?"}, {"owner": {"reputation": 179, "user_id": 7684046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/527159e9ffe0426a59486efdebaa278b?s=128&d=identicon&r=PG&f=1", "display_name": "Lincoln", "link": "https://stackoverflow.com/users/7684046/lincoln"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1506508499, "post_id": 46445027, "comment_id": 79846932, "body": "@Vityata Do not take it serious, haven&#39;t yet rewrite this part."}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1506509096, "post_id": 46445027, "comment_id": 79847297, "body": "When you select the listbox it closes because You tell it to:  Private Sub ListBox1_Click()     ThisWorkbook.Sheets(ListBox1.Value).Activate     Unload Me End Sub  The UNLOAD actually closes the form"}, {"owner": {"reputation": 179, "user_id": 7684046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/527159e9ffe0426a59486efdebaa278b?s=128&d=identicon&r=PG&f=1", "display_name": "Lincoln", "link": "https://stackoverflow.com/users/7684046/lincoln"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1506509629, "post_id": 46445027, "comment_id": 79847664, "body": "@HarassedDad Hi, Yeah I know. The problem is with inputbox it disappears  when macro runs (application.inputbox)"}, {"owner": {"reputation": 179, "user_id": 7684046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/527159e9ffe0426a59486efdebaa278b?s=128&d=identicon&r=PG&f=1", "display_name": "Lincoln", "link": "https://stackoverflow.com/users/7684046/lincoln"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1506509715, "post_id": 46445027, "comment_id": 79847725, "body": "@Vityata lrow and lcol are declared in Private Sub as per code above. Maybe I am missing something else"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1506510711, "post_id": 46445027, "comment_id": 79848405, "body": "They are therefore only available to that sub. You need to declare outside the procedure if you want them to public."}, {"owner": {"reputation": 179, "user_id": 7684046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/527159e9ffe0426a59486efdebaa278b?s=128&d=identicon&r=PG&f=1", "display_name": "Lincoln", "link": "https://stackoverflow.com/users/7684046/lincoln"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1506511232, "post_id": 46445027, "comment_id": 79848756, "body": "@SJR Added. Accidently delete them with comments. Does the merged cells could be the possible reason?"}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1506515592, "post_id": 46445027, "comment_id": 79851531, "body": "What if the user wants to cancel the paste while the sheets userform is showing? Also, the do loop after showing the form is not needed as Userformxx.Show already halts the code until the userform is either hidden or unloaded."}, {"owner": {"reputation": 179, "user_id": 7684046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/527159e9ffe0426a59486efdebaa278b?s=128&d=identicon&r=PG&f=1", "display_name": "Lincoln", "link": "https://stackoverflow.com/users/7684046/lincoln"}, "reply_to_user": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1506517319, "post_id": 46445027, "comment_id": 79852779, "body": "@jkpieterse This is also the issue that I have. I dont now why but without <code>doevents</code> loop the code runs behind userform and it copy and paste nothing. That is why I have add this part"}], "owner": {"reputation": 179, "user_id": 7684046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/527159e9ffe0426a59486efdebaa278b?s=128&d=identicon&r=PG&f=1", "display_name": "Lincoln", "link": "https://stackoverflow.com/users/7684046/lincoln"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1506511146, "creation_date": 1506506644, "last_edit_date": 1506511146, "question_id": 46445027, "link": "https://stackoverflow.com/questions/46445027/problems-with-copy-of-max-range-user-selected-range", "title": "Problems with Copy of max range. User selected range", "body": "<p>I am trying to write a macro that will ask user to provide workbook, macro opens workbook. Than user selects the range for copy and specifies the worksheet to which paste data in Userform. Macro copy selected Range to the specified worksheet.</p>\n\n<p>But I face some problems with it.</p>\n\n<p>Here is code:</p>\n\n<pre><code>Public Sub copy_WB()\nApplication.DisplayAlerts = False\nDim wbk As Workbook, answer As String,lrow as long, lcol as long\nDim UserRange As Range\n\nPrompt = \"Select a cell for the output.\"\nTitle = \"Select a cell\"\n\nanswer = MsgBox(\"Would you like to clear all data?\", vbYesNo, \"Confirmation\")\nIf answer = vbYes Then\n    Call clear_all\nEnd If\n\nSet wbk = Get_workbook\nIf wbk Is Nothing Then\nExit Sub\nEnd If\n'   Display the Input Box\n    On Error Resume Next\n    Set UserRange = Application.InputBox( _\n        Prompt:=Prompt, _\n        Title:=Title, _\n        Type:=8) 'Range selection\n\n'   Was the Input Box canceled?\n    If UserRange Is Nothing Then\n        MsgBox \"Canceled.\"\n        Exit Sub\n    Else\n        UserRange.Parent.Parent.Activate\n        UserRange.Parent.Activate\n        lrow = UserRange(UserRange.Count).Row\n        lcol = UserRange(UserRange.Count).Columns\n\n        If lrow &gt; 1000000 Or lcol &gt; 15000 Then\n        ActiveSheet.UsedRange.Copy\n        Else\n        UserRange.Copy\n        End If\n\n        sh_sel.Show\n        Do While IsUserFormLoaded(\"sh_sel\")\n            DoEvents\n        Loop\n\n        ActiveSheet.Range(\"A2\").PasteSpecial xlPasteValues\n        Application.CutCopyMode = False\n    End If\n\nThisWorkbook.Worksheets(3).Range(\"A1\") = lrow\nThisWorkbook.Worksheets(3).Range(\"A2\") = lcol\nwbk.Close False\nApplication.DisplayAlerts = True\nEnd Sub\n\n\nPrivate Sub clear_all()\nDim wb As Workbook, shs As Worksheet, lrow As Single, lcol As Single\nSet wb = ThisWorkbook\n\nFor Each shs In wb.Worksheets\n\n    With shs.UsedRange\n        lrow = .Rows(.Rows.Count).Row\n        lcol = .Columns(.Columns.Count).Column\n    End With\n        If Not (lrow = 0 Or lrow = 1) Then\n    With shs\n        .Range(.Cells(2, 1), .Cells(lrow, lcol)).clear\n    End With\n        End If\nNext shs\n\nEnd Sub\n\nFunction Get_workbook() As Workbook\n    Dim wbk As Workbook, pathb As String\n    pathb = ThisWorkbook.path\n    ChDir pathb\n\n\n    wbk_name = Application.GetOpenFilename(Title:=\"Please choose File:\", FileFilter:=\"Excel Files *.xls*(*.xls*),\")\n        On Error Resume Next\n        If Len(Dir(wbk_name)) = 0 Then\n        MsgBox \"The file was not chosen - macro off.\"\n        Exit Function\n        Else\n        Set wbk = Workbooks.Open(wbk_name)\n        End If\n        Set Get_workbook = wbk\n\nEnd Function\n\nFunction IsUserFormLoaded(ByVal UFName As String) As Boolean\n    Dim UForm As Object\n\n    IsUserFormLoaded = False\n    For Each UForm In VBA.UserForms\n        If UForm.Name = UFName Then\n            IsUserFormLoaded = True\n            Exit For\n        End If\n    Next\nEnd Function 'IsUserFormLoaded\n</code></pre>\n\n<p>The first problem that I am facing is when user press\n<a href=\"https://i.stack.imgur.com/PFuSA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PFuSA.png\" alt=\"enter image description here\"></a>\nThe button which locates in the upper left corner of the sheet to select the entire sheet range, it will not be copied. I was trying to correct it somehow by adding the condition of last row of selected range is bigger then...(see code please).</p>\n\n<p>But it does not actually works. sometimes it copy range, sometimes no.</p>\n\n<p>The second problem: inputbox is disappears when macro run. Have no idea why it happans.</p>\n\n<p>Userform code:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    Dim sh As Worksheet\n\n    For Each sh In ThisWorkbook.Sheets\n        ListBox1.AddItem sh.Name\n    Next sh\n\nMe.StartUpPosition = 0\n  Me.Left = Application.Left + (0.5 * Application.Width) - (0.5 * Me.Width)\n  Me.Top = Application.Top + (0.5 * Application.Height) - (0.5 * Me.Height)\n    HideTitleBar.HideTitleBar Me\nEnd Sub\n\n\nPrivate Sub ListBox1_Click()\n    ThisWorkbook.Sheets(ListBox1.Value).Activate\n    Unload Me\nEnd Sub\n</code></pre>\n\n<p>User forms contains list of sheets in current workbook, after user selection of the sheet data would be pasted.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 19035, "user_id": 22114, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/22b28304599446b3d3aaaf123e7240ff?s=128&d=identicon&r=PG", "display_name": "Treb", "link": "https://stackoverflow.com/users/22114/treb"}, "edited": false, "score": 0, "creation_date": 1506505913, "post_id": 46444721, "comment_id": 79845230, "body": "Please post some code example of what you have done so far. Without it I can&#39;t say what needs to be changed..."}, {"owner": {"reputation": 15, "user_id": 8682044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20f414b42e9883ffb38677e91b19a15a?s=128&d=identicon&r=PG&f=1", "display_name": "GrayC", "link": "https://stackoverflow.com/users/8682044/grayc"}, "reply_to_user": {"reputation": 19035, "user_id": 22114, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/22b28304599446b3d3aaaf123e7240ff?s=128&d=identicon&r=PG", "display_name": "Treb", "link": "https://stackoverflow.com/users/22114/treb"}, "edited": false, "score": 0, "creation_date": 1506506025, "post_id": 46444721, "comment_id": 79845309, "body": "In terms of removing records prior to a date and time, i&#39;m at a start point with that.  This will be done before any of the other rules so is essentially independent of it.  I can add the rest if needs be, but it is a bit of a hatchet job so far."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1506508819, "post_id": 46444721, "comment_id": 79847110, "body": "You could just clear all the data before pulling in new data. <code>Thisworkbook.Worksheets(&quot;Sheet1&quot;).Cells.ClearContents</code>.  <code>Cells</code> refers to all cells on the sheet - you can change this to a range of cells to limit which ones will be cleared of data."}, {"owner": {"reputation": 15, "user_id": 8682044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20f414b42e9883ffb38677e91b19a15a?s=128&d=identicon&r=PG&f=1", "display_name": "GrayC", "link": "https://stackoverflow.com/users/8682044/grayc"}, "edited": false, "score": 0, "creation_date": 1506509483, "post_id": 46444721, "comment_id": 79847567, "body": "Hi Darren, Unfortunately the extract that gets pulled doesn&#39;t define what is new or what has been existing previously.  For example, if the extract gets pulled three times in a day, the same data would be on each extract.  The data gets imported in to another system, and i am looking to avoid data getting uploaded multiple times."}], "owner": {"reputation": 15, "user_id": 8682044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20f414b42e9883ffb38677e91b19a15a?s=128&d=identicon&r=PG&f=1", "display_name": "GrayC", "link": "https://stackoverflow.com/users/8682044/grayc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1506524165, "creation_date": 1506505776, "last_edit_date": 1506524165, "question_id": 46444721, "link": "https://stackoverflow.com/questions/46444721/excel-vba-macro-remove-records-older-than-a-certain-date-and-time", "title": "Excel VBA Macro - remove records older than a certain date and time", "body": "<p>I'm very new to VBA etc. and having a bit of trouble getting a Macro to work for what I want from it.</p>\n\n<p>I am trying to build a tool that will translate data received from a data extract to be in the format that I require.  I can run the import fine, however the challenge that I am having is that the extract will be pulled mutliple times a day with old records remaining on there.</p>\n\n<p>The data has an assigned date and time, so I am hoping to build a rule that stores the latest assigned date and time from each macro run, and then the next time the macro is run, it will remove the records prior to that date and time.</p>\n\n<p>Any help is appreciated.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 2531448, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/db646201976f8a6c7bda45ede27473ab?s=128&d=identicon&r=PG", "display_name": "Jay C", "link": "https://stackoverflow.com/users/2531448/jay-c"}, "edited": false, "score": 1, "creation_date": 1506505674, "post_id": 46444605, "comment_id": 79845059, "body": "I&#39;m officially an idiot. Instantly resolved the issue, thanks very much."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 37, "user_id": 2531448, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/db646201976f8a6c7bda45ede27473ab?s=128&d=identicon&r=PG", "display_name": "Jay C", "link": "https://stackoverflow.com/users/2531448/jay-c"}, "edited": false, "score": 1, "creation_date": 1506512677, "post_id": 46444605, "comment_id": 79849664, "body": "@JayC if SJR answer helped you, then you should accept it as &quot;ANSWER&quot;, click on the gray check-mark on the left side of his answer, and it will trun green"}, {"owner": {"reputation": 37, "user_id": 2531448, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/db646201976f8a6c7bda45ede27473ab?s=128&d=identicon&r=PG", "display_name": "Jay C", "link": "https://stackoverflow.com/users/2531448/jay-c"}, "edited": false, "score": 1, "creation_date": 1506528496, "post_id": 46444605, "comment_id": 79860748, "body": "I was intending to, unfortunately it slipped my mind as you can&#39;t accept an answer within the first 15 minutes of raising a query. Cheers for the reminder"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 3, "last_activity_date": 1506505458, "creation_date": 1506505458, "answer_id": 46444605, "question_id": 46444545, "link": "https://stackoverflow.com/questions/46444545/excel-vba-match-if-value-is-null/46444605#46444605", "title": "Excel VBA Match if value is null", "body": "<p>Use this instead. Using Application instead of WorksheetFunction enables the error to be trapped and tested.</p>\n\n<pre><code>i = Application.IfError(Application.Match(UserName, EL.Range(\"A:A\"), 0), 0)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 3, "last_activity_date": 1506506649, "creation_date": 1506506649, "answer_id": 46445029, "question_id": 46444545, "link": "https://stackoverflow.com/questions/46444545/excel-vba-match-if-value-is-null/46445029#46445029", "title": "Excel VBA Match if value is null", "body": "<p>I would use a slightly different approach to trap an error on <code>Application.Match</code> function:</p>\n\n<pre><code>Dim i As Variant\n\ni = Application.Match(UserName, EL.Range(\"A:A\"), 0)\n' if Match wasn't able to found a \"match\"\nIf IsError(i) Then i = 0\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 2531448, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/db646201976f8a6c7bda45ede27473ab?s=128&d=identicon&r=PG", "display_name": "Jay C", "link": "https://stackoverflow.com/users/2531448/jay-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1908, "favorite_count": 0, "accepted_answer_id": 46444605, "answer_count": 2, "score": 2, "last_activity_date": 1506506649, "creation_date": 1506505270, "question_id": 46444545, "link": "https://stackoverflow.com/questions/46444545/excel-vba-match-if-value-is-null", "title": "Excel VBA Match if value is null", "body": "<p>I have a piece of code within a larger script that simply allocates a value to \"i\" based on a match. The idea being I want it to give the match value if the value entered is found, or 0 if not. If it's 0, I can then exit sub with a message to the user. However, any time the match finds a null value, it just kills the sub, instead of it being handled as part of the iferror I've introduced. I've tried various manners of checking (using iif(iserror) for example) but none seem to work.</p>\n\n<p>Code causing the issue is below:</p>\n\n<pre><code>i = Application.WorksheetFunction.IfError(Application.WorksheetFunction.Match(username, EL.Range(\"A:A\"), 0), 0)\n</code></pre>\n\n<p>i is dim as an integer</p>\n\n<p>Username is dim as a string, and comes from an inputbox</p>\n\n<p>EL is dim as a worksheet, and contains the correct info.</p>\n\n<p>This has absolutely no issues if I introduce any name that exists, it only fails as soon as I input a name that does not work, and I'm sort of stumped as to why. I see no reason for it to fail, but feel like I'm missing something simply and in-my-face.</p>\n"}, {"tags": ["vb.net", "excel", "vba"], "comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1506505084, "post_id": 46444139, "comment_id": 79844634, "body": "What have you tried? Your question is too vague to respond to without seeing either a) some code that you&#39;ve attempted yourself or b) a much more detailed explanation of what you want to achieve."}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1506512282, "post_id": 46444139, "comment_id": 79849443, "body": "What is <code>code.Description</code> and after assigning <code>code.Description = grid((r - 1), 3).ToString &amp; s</code> what are you doing with <code>code.Description</code>, need to see more code."}], "answers": [{"comments": [{"owner": {"reputation": 1079, "user_id": 6827197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/445d726384a840c085144bdced116a32?s=128&d=identicon&r=PG&f=1", "display_name": "a-burge", "link": "https://stackoverflow.com/users/6827197/a-burge"}, "edited": false, "score": 0, "creation_date": 1506505484, "post_id": 46444593, "comment_id": 79844929, "body": "For something bound to recur, might be worth writing VBA to do similar."}], "tags": [], "owner": {"reputation": 1079, "user_id": 6827197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/445d726384a840c085144bdced116a32?s=128&d=identicon&r=PG&f=1", "display_name": "a-burge", "link": "https://stackoverflow.com/users/6827197/a-burge"}, "is_accepted": false, "score": 1, "last_activity_date": 1506505420, "creation_date": 1506505420, "answer_id": 46444593, "question_id": 46444139, "link": "https://stackoverflow.com/questions/46444139/how-can-i-refer-to-a-data-in-a-different-row/46444593#46444593", "title": "How can I refer to a data in a different row?", "body": "<p>If it is a one-off, try the below. This will basically put a formula in every cell that refers to the cell immediately above it:</p>\n\n<ol>\n<li>Select column A (from top until bottom of list (row N)</li>\n<li>Press <code>ctrl</code> + <code>g</code> to open the GoTo dialogue</li>\n<li>Press <code>Special</code></li>\n<li>Select <code>Blanks</code> from the radio buttons </li>\n</ol>\n\n<p>The above will select all the blank cells in column A. Now enter <code>=</code> and press <code>up arrow</code>. Enter the formula by holding down <code>ctrl</code> while pressing enter. That will enter the same formula in every cell.</p>\n"}, {"tags": [], "owner": {"reputation": 403, "user_id": 8102155, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/lXDxu.png?s=128&g=1", "display_name": "Dinesh Vilas Pawar", "link": "https://stackoverflow.com/users/8102155/dinesh-vilas-pawar"}, "is_accepted": false, "score": 0, "last_activity_date": 1506505764, "creation_date": 1506505764, "answer_id": 46444716, "question_id": 46444139, "link": "https://stackoverflow.com/questions/46444139/how-can-i-refer-to-a-data-in-a-different-row/46444716#46444716", "title": "How can I refer to a data in a different row?", "body": "<p>From your question I Guess that, you must be define a variable for last column Value. and check the value in respective column, if it  is empty then use column value if not empty  then take current value as last value.</p>\n\n<p>'<code>Dim LastValue as string \nLastValue = sheet(\"SheetName\").cells(i,\"Column Name\").value\nfor i = 2 to LastRow '&gt;&gt;&gt;&gt; here i am assume you run code in for loop from row to \n                           'to last count row(LastRow as variable)\n'Put your sheet name at \"SheetName\" and column index (like \"A\",\"B\",\"C\"...) at \"Column Name\"\nif sheet(\"SheetName\").cells(i,\"Column Name\").value &lt;&gt;\"\" then\nLastValue = sheet(\"SheetName\").cells(i,\"Column Name\").value\nend if\n'(Do your stuff using LastValue , you may generate lastvalue 1, lastvalue2 ..etc)\nnext'for loop end here</code></p>\n"}, {"tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": false, "score": 1, "last_activity_date": 1506506000, "creation_date": 1506506000, "answer_id": 46444803, "question_id": 46444139, "link": "https://stackoverflow.com/questions/46444139/how-can-i-refer-to-a-data-in-a-different-row/46444803#46444803", "title": "How can I refer to a data in a different row?", "body": "<p>Try</p>\n\n<pre><code>Sub Demo()\n    Dim ws As Worksheet\n\n    Set ws = ThisWorkbook.Sheets(\"Sheet3\")      'change Sheet3 to your data sheet\n    With .Range(\"A:A\").SpecialCells(xlCellTypeBlanks)\n        .FormulaR1C1 = \"=R[-1]C\"\n        .Value = .Value\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 205, "user_id": 7193776, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dcf45c91d9ec3918cc24f4bcc372af11?s=128&d=identicon&r=PG&f=1", "display_name": "Matteo", "link": "https://stackoverflow.com/users/7193776/matteo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1506506070, "creation_date": 1506504225, "last_edit_date": 1531161705, "question_id": 46444139, "link": "https://stackoverflow.com/questions/46444139/how-can-i-refer-to-a-data-in-a-different-row", "title": "How can I refer to a data in a different row?", "body": "<p>I've got an Excel file with N rows and M columns. Usually data are organized one per row, but it can happens that a data occupy more than a row. In this case how can I express that the second (or next) row has to refer to the first row?</p>\n\n<p><a href=\"https://i.stack.imgur.com/xzpgL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xzpgL.png\" alt=\"enter image description here\"></a></p>\n\n<p>In this example, AP.01 has got 5 rows of description, so how can I say that the other 4 rows refer also to the first code?</p>\n\n<p><strong>EDIT</strong> once that I did the association I have to export my Excel file into an Access DB. So I want to see the tables with the correct data.\nIf I have only one row for the description I wrote this code and it works:</p>\n\n<pre><code>If grid(r, 3).Text.Length &gt; 255 Then\n       code.Description = grid(r, 3).Text.ToString.Substring(0, 252) + \"...\"\n       Else\n          code.Description = grid(r, 3).Text.ToString\nEnd If\n</code></pre>\n\n<p>Instead if I have more than one row for the description I wrote this code and it doesn't work:</p>\n\n<pre><code>Do While grid(r, 1).ToString = \"\"\n                    If grid(r, 1).ToString = \"\" And grid(r, 3).ToString IsNot Nothing Then\n                        Dim s As String\n                        s = grid(r, 3).ToString\n                        code.Description = grid((r - 1), 3).ToString &amp; s\n                    End If\n                Loop\n</code></pre>\n"}, {"tags": ["vba", "excel", "catia"], "comments": [{"owner": {"reputation": 756, "user_id": 7659015, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10210265350104599/picture?type=large", "display_name": "Putxe", "link": "https://stackoverflow.com/users/7659015/putxe"}, "edited": false, "score": 0, "creation_date": 1506504720, "post_id": 46443825, "comment_id": 79844390, "body": "It&#39;s  strange because when I&#39;m trying your code with mySheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:=&quot;D:\\Excel_1.pdf&quot;, Quality:=xlQualityStandard  the pdf in output is colored. I presume when I read your question that you run your macro from Catia. Can you test your code from Excel (Excel &gt; Visual Basic), and say to me if the pdf is still not colored ?"}, {"owner": {"reputation": 756, "user_id": 7659015, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10210265350104599/picture?type=large", "display_name": "Putxe", "link": "https://stackoverflow.com/users/7659015/putxe"}, "edited": false, "score": 0, "creation_date": 1506504931, "post_id": 46443825, "comment_id": 79844524, "body": "Delete also the &quot; , _&quot; after xlQualityStandard if you are no other parameters after this."}, {"owner": {"reputation": 85, "user_id": 8677989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d08386dba4b1477b1611ac54d688411c?s=128&d=identicon&r=PG&f=1", "display_name": "CodeCatia", "link": "https://stackoverflow.com/users/8677989/codecatia"}, "reply_to_user": {"reputation": 756, "user_id": 7659015, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10210265350104599/picture?type=large", "display_name": "Putxe", "link": "https://stackoverflow.com/users/7659015/putxe"}, "edited": false, "score": 0, "creation_date": 1506507929, "post_id": 46443825, "comment_id": 79846570, "body": "Thank you for your response. I have figured out what was problem, and it wasn&#39;t in code (beside unintentional &quot;,_&quot; part:)). I had to remove Page Setup/Sheet/Print check mark from Black and white. I was so focused on code that i didn&#39;t look to page set up options in excel."}], "answers": [{"tags": [], "owner": {"reputation": 85, "user_id": 8677989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d08386dba4b1477b1611ac54d688411c?s=128&d=identicon&r=PG&f=1", "display_name": "CodeCatia", "link": "https://stackoverflow.com/users/8677989/codecatia"}, "is_accepted": false, "score": 2, "last_activity_date": 1506514769, "creation_date": 1506514769, "answer_id": 46447707, "question_id": 46443825, "link": "https://stackoverflow.com/questions/46443825/how-to-create-a-color-pdf-from-excel-using-catia-vba/46447707#46447707", "title": "how to create a color pdf from excel using (Catia) vba", "body": "<p>If someone have same problem as I did, just add this code before exporting to pdf:</p>\n\n<pre><code>mySheet.PageSetup.BlackAndWhite = False\n</code></pre>\n\n<p>this will set sheet to print in color.</p>\n\n<p>so, code will look like this:</p>\n\n<pre><code>Sub CATMain()\n\nSet xlApp = CreateObject(\"Excel.Application\")\nSet mydoc = xlApp.Workbooks.Open(\"D:\\Excel_1.xls\")\nSet mySheet = mydoc.Sheets.Item(1)\n\nmySheet.PageSetup.BlackAndWhite = False\n\nmySheet.ExportAsFixedFormat Type:=xlTypePDF, _\nfileName:=\"D:\\Excel_1.pdf\", _\nQuality:=xlQualityStandard\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 8677989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d08386dba4b1477b1611ac54d688411c?s=128&d=identicon&r=PG&f=1", "display_name": "CodeCatia", "link": "https://stackoverflow.com/users/8677989/codecatia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 645, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1506514769, "creation_date": 1506503309, "last_edit_date": 1531164843, "question_id": 46443825, "link": "https://stackoverflow.com/questions/46443825/how-to-create-a-color-pdf-from-excel-using-catia-vba", "title": "how to create a color pdf from excel using (Catia) vba", "body": "<p>Hej, I am new in coding. I am trying my best but I am stuck. I have searched internet and stackoverflow but haven't find answer.\nI am writing code in Catia V5 VBA and I want to export excel to pdf. Excel has some pictures in color and I want that pdf is also in <strong>color</strong>. But I always end up with pdf in Black &amp; white. This is my basic code:</p>\n\n<pre><code>Sub CATMain()\nSet xlApp = CreateObject(\"Excel.Application\")\nSet mydoc = xlApp.Workbooks.Open(\"D:\\Excel_1.xls\")\nSet mySheet = mydoc.Sheets.Item(1)\n\nmySheet.ExportAsFixedFormat Type:=xlTypePDF, _\n    fileName:=\"D:\\Excel_1.pdf\", _\n    Quality:=xlQualityStandard, _\nEnd Sub\n</code></pre>\n\n<p>I have looked for other parameters of \"ExportAsFixedFormat\" method, but there isn't any about color.</p>\n\n<p>In despair I have also tried:</p>\n\n<pre><code>xlApp.ActiveWorkbook.SaveAs \"D:\\Excel_1.pdf\"\n</code></pre>\n\n<p>But I get error saying: \"Adobe Acribat could not open 'Excel_1.pdf' because it is either not a supported file type or because the file has been damaged\"</p>\n\n<p>Workbook.SaveAs method has \"FileFormat\" parameter but there isn't pdf in list of suportet file formats. </p>\n\n<p>do you know what method should I use to get colored pdf?</p>\n\n<p>thanks in advance</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 10287, "user_id": 2545784, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4zVa6.png?s=128&g=1", "display_name": "LS_\u1d05\u1d07\u1d20", "link": "https://stackoverflow.com/users/2545784/ls-%e1%b4%85%e1%b4%87%e1%b4%a0"}, "edited": false, "score": 0, "creation_date": 1506503714, "post_id": 46443745, "comment_id": 79843675, "body": "Being this an Excel macro, what batch have you put in task scheduler?"}, {"owner": {"reputation": 61, "user_id": 2914838, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/533015076/picture?type=large", "display_name": "Iva Bazhunaishvili", "link": "https://stackoverflow.com/users/2914838/iva-bazhunaishvili"}, "reply_to_user": {"reputation": 10287, "user_id": 2545784, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4zVa6.png?s=128&g=1", "display_name": "LS_\u1d05\u1d07\u1d20", "link": "https://stackoverflow.com/users/2545784/ls-%e1%b4%85%e1%b4%87%e1%b4%a0"}, "edited": false, "score": 0, "creation_date": 1506516152, "post_id": 46443745, "comment_id": 79851894, "body": "@LS_\u1d05\u1d07\u1d20 I was using the VBScript described here: <a href=\"http://krgreenlee.blogspot.com/2006/04/excel-running-excel-on-windows-task.html\" rel=\"nofollow noreferrer\">Excel: Running Excel on Windows Task Scheduler</a> and my batch file looked like this: <code>start &quot;&quot; &quot;D:\\Documents\\Macros\\___\\Run__Rep.vbs&quot;</code>"}, {"owner": {"reputation": 10287, "user_id": 2545784, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4zVa6.png?s=128&g=1", "display_name": "LS_\u1d05\u1d07\u1d20", "link": "https://stackoverflow.com/users/2545784/ls-%e1%b4%85%e1%b4%87%e1%b4%a0"}, "edited": false, "score": 0, "creation_date": 1506518483, "post_id": 46443745, "comment_id": 79853586, "body": "So, another question... What does VBS contains?"}, {"owner": {"reputation": 61, "user_id": 2914838, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/533015076/picture?type=large", "display_name": "Iva Bazhunaishvili", "link": "https://stackoverflow.com/users/2914838/iva-bazhunaishvili"}, "reply_to_user": {"reputation": 10287, "user_id": 2545784, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4zVa6.png?s=128&g=1", "display_name": "LS_\u1d05\u1d07\u1d20", "link": "https://stackoverflow.com/users/2545784/ls-%e1%b4%85%e1%b4%87%e1%b4%a0"}, "edited": false, "score": 0, "creation_date": 1506521231, "post_id": 46443745, "comment_id": 79855701, "body": "@LS_\u1d05\u1d07\u1d20 I&#39;ve edited the post (added the VBS code)."}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 2914838, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/533015076/picture?type=large", "display_name": "Iva Bazhunaishvili", "link": "https://stackoverflow.com/users/2914838/iva-bazhunaishvili"}, "edited": false, "score": 0, "creation_date": 1506515356, "post_id": 46445223, "comment_id": 79851363, "body": "many thanks! Your method worked out! I was using the method described here: Excel: <a href=\"http://krgreenlee.blogspot.com/2006/04/excel-running-excel-on-windows-task.html\" rel=\"nofollow noreferrer\">Running Excel on Windows Task Scheduler</a> but it wouldn&#39;t work out as I mentioned above. I only have one question left: in the script described on the website there&#39;s given way of not quitting Excel if there are other instances running, but with your script it still doesn&#39;t quit other instnaces of Excel, should I leave it as it is, or use that checking method?"}, {"owner": {"reputation": 561, "user_id": 8558614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2h6yS.jpg?s=128&g=1", "display_name": "Nikolaos Polygenis", "link": "https://stackoverflow.com/users/8558614/nikolaos-polygenis"}, "reply_to_user": {"reputation": 61, "user_id": 2914838, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/533015076/picture?type=large", "display_name": "Iva Bazhunaishvili", "link": "https://stackoverflow.com/users/2914838/iva-bazhunaishvili"}, "edited": false, "score": 0, "creation_date": 1506515963, "post_id": 46445223, "comment_id": 79851758, "body": "do you want to quit all instances or only the instance of the script?"}, {"owner": {"reputation": 61, "user_id": 2914838, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/533015076/picture?type=large", "display_name": "Iva Bazhunaishvili", "link": "https://stackoverflow.com/users/2914838/iva-bazhunaishvili"}, "edited": false, "score": 0, "creation_date": 1506516260, "post_id": 46445223, "comment_id": 79851961, "body": "Only the instance of the script, meaning I want other instances to be left running (in case there are other instances)."}, {"owner": {"reputation": 10287, "user_id": 2545784, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4zVa6.png?s=128&g=1", "display_name": "LS_\u1d05\u1d07\u1d20", "link": "https://stackoverflow.com/users/2545784/ls-%e1%b4%85%e1%b4%87%e1%b4%a0"}, "edited": false, "score": 0, "creation_date": 1506518587, "post_id": 46445223, "comment_id": 79853668, "body": "What is <code>CreateObject (&quot;Wscript.Shell&quot;)</code> for?"}, {"owner": {"reputation": 10287, "user_id": 2545784, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4zVa6.png?s=128&g=1", "display_name": "LS_\u1d05\u1d07\u1d20", "link": "https://stackoverflow.com/users/2545784/ls-%e1%b4%85%e1%b4%87%e1%b4%a0"}, "edited": false, "score": 0, "creation_date": 1506519108, "post_id": 46445223, "comment_id": 79854072, "body": "Althrough your solution may work, you failed to identify OP issue and as well, you&#39;re not explaining why your answer is a solution to OP problem."}, {"owner": {"reputation": 561, "user_id": 8558614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2h6yS.jpg?s=128&g=1", "display_name": "Nikolaos Polygenis", "link": "https://stackoverflow.com/users/8558614/nikolaos-polygenis"}, "reply_to_user": {"reputation": 10287, "user_id": 2545784, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4zVa6.png?s=128&g=1", "display_name": "LS_\u1d05\u1d07\u1d20", "link": "https://stackoverflow.com/users/2545784/ls-%e1%b4%85%e1%b4%87%e1%b4%a0"}, "edited": false, "score": 0, "creation_date": 1506519786, "post_id": 46445223, "comment_id": 79854586, "body": "@LS_\u1d05\u1d07\u1d20 You have right, I just copy the sub that OP use and I forgot to erase CreateObject (&quot;Wscript.Shell&quot;).i will be editing the answer.Thanks!!"}, {"owner": {"reputation": 561, "user_id": 8558614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2h6yS.jpg?s=128&g=1", "display_name": "Nikolaos Polygenis", "link": "https://stackoverflow.com/users/8558614/nikolaos-polygenis"}, "reply_to_user": {"reputation": 10287, "user_id": 2545784, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4zVa6.png?s=128&g=1", "display_name": "LS_\u1d05\u1d07\u1d20", "link": "https://stackoverflow.com/users/2545784/ls-%e1%b4%85%e1%b4%87%e1%b4%a0"}, "edited": false, "score": 0, "creation_date": 1506520739, "post_id": 46445223, "comment_id": 79855378, "body": "@LS_\u1d05\u1d07\u1d20  my answer for your second question is that I have explained the steps with details to make the whole thing work, and I have already answer to a new question that OP had. I didn&#39;t only give to OP a code. The OP problem was that does the macro work normally WITHOUT Task Scheduler and not with...with my answer OP can find the reason of the issue."}, {"owner": {"reputation": 10287, "user_id": 2545784, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4zVa6.png?s=128&g=1", "display_name": "LS_\u1d05\u1d07\u1d20", "link": "https://stackoverflow.com/users/2545784/ls-%e1%b4%85%e1%b4%87%e1%b4%a0"}, "edited": false, "score": 0, "creation_date": 1506529682, "post_id": 46445223, "comment_id": 79861444, "body": "So, why doesn&#39;t the macro run with task scheduler?"}, {"owner": {"reputation": 561, "user_id": 8558614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2h6yS.jpg?s=128&g=1", "display_name": "Nikolaos Polygenis", "link": "https://stackoverflow.com/users/8558614/nikolaos-polygenis"}, "edited": false, "score": 0, "creation_date": 1506530177, "post_id": 46445223, "comment_id": 79861717, "body": "I have already answer to this(&quot;with my answer OP can find the reason of the issue. &quot;)"}], "tags": [], "owner": {"reputation": 561, "user_id": 8558614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2h6yS.jpg?s=128&g=1", "display_name": "Nikolaos Polygenis", "link": "https://stackoverflow.com/users/8558614/nikolaos-polygenis"}, "is_accepted": true, "score": 0, "last_activity_date": 1506519841, "last_edit_date": 1506519841, "creation_date": 1506507188, "answer_id": 46445223, "question_id": 46443745, "link": "https://stackoverflow.com/questions/46443745/excel-vba-code-throws-run-time-error-429-while-sending-outlook-email-using-task/46445223#46445223", "title": "Excel VBA code throws run-time error 429 while sending Outlook email using Task Scheduler", "body": "<p>Please follow the below:</p>\n\n<p>1) Write in an excel file which saved as SendEmail.xlsm, your Sub:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub send_email()\n\n\n\nDim OutApp As Object\nDim OutMail As Object\n\nSet OutApp = CreateObject(\"Outlook.Application\") \nSet OutMail = OutApp.CreateItem(0)\n\nOn Error Resume Next\nWith OutMail\n    .to = \"email@email.com\"\n    .CC = \"\"\n    .BCC = \"\"\n    .Subject = \"subj\"\n    .Body = \"body\"\n    .Attachments.Add ActiveWorkbook.FullName\n    .Send\nEnd With\nOn Error GoTo 0\n\nSet OutMail = Nothing\nSet OutApp = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>2) Open a notepad write this Code and save it as vbs (SendEmail.vbs)</p>\n\n<pre><code>Dim args, objExcel\n\nSet args = WScript.Arguments\nSet objExcel = CreateObject(\"Excel.Application\")\n\nobjExcel.Workbooks.Open args(0)\nobjExcel.Visible = True\n\nobjExcel.Run \"send_email\"\n\nobjExcel.ActiveWorkbook.Save\nobjExcel.ActiveWorkbook.Close(0)\nobjExcel.Quit\n</code></pre>\n\n<p>3) Open a notepad write this code and save as bat (SendEmail.bat),I have saved it on my desktop, you can save it everywhere you want.</p>\n\n<pre><code>cscript \"D:\\desktop\\SendEmail.vbs\" \"D:\\desktop\\SendEmail.xlsm\"\n</code></pre>\n\n<p>4) Create a task in the scheduler which calls the SendEmail.bat</p>\n"}, {"comments": [{"owner": {"reputation": 61, "user_id": 2914838, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/533015076/picture?type=large", "display_name": "Iva Bazhunaishvili", "link": "https://stackoverflow.com/users/2914838/iva-bazhunaishvili"}, "edited": false, "score": 0, "creation_date": 1506513771, "post_id": 46446291, "comment_id": 79850362, "body": "Thank you for the answer. I tried to amend it your way, but unfortunately I&#39;m getting the same error when trying to run it from Task Scheduler (otherwise it  works just fine, once again). The thing is that apparently when runing from Task Scheduler the code omitted &#39;GetObject &#39; line and threw an error at &#39;CreateObject&#39; line."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "reply_to_user": {"reputation": 61, "user_id": 2914838, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/533015076/picture?type=large", "display_name": "Iva Bazhunaishvili", "link": "https://stackoverflow.com/users/2914838/iva-bazhunaishvili"}, "edited": false, "score": 1, "creation_date": 1506527229, "post_id": 46446291, "comment_id": 79859910, "body": "You need to check the privileges for TS. Apparently they are not enough ..."}, {"owner": {"reputation": 61, "user_id": 2914838, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/533015076/picture?type=large", "display_name": "Iva Bazhunaishvili", "link": "https://stackoverflow.com/users/2914838/iva-bazhunaishvili"}, "edited": false, "score": 0, "creation_date": 1506528280, "post_id": 46446291, "comment_id": 79860593, "body": "You are totally correct. I was running the task with &quot;highest privileges&quot;, when I unchecked it the script executed normally."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "is_accepted": false, "score": 1, "last_activity_date": 1506510290, "creation_date": 1506510290, "answer_id": 46446291, "question_id": 46443745, "link": "https://stackoverflow.com/questions/46443745/excel-vba-code-throws-run-time-error-429-while-sending-outlook-email-using-task/46446291#46446291", "title": "Excel VBA code throws run-time error 429 while sending Outlook email using Task Scheduler", "body": "<p>You should first check if Outlook is running and if so, attach to it and not creating a new session:</p>\n\n<pre><code>On Error Resume Next\nSet objOutlook = GetObject(, \"Outlook.Application\")    'Error if Outlook not running\nOn Error GoTo 0\nIf objOutlook Is Nothing Then  'Outlook not running so start it\n    Set objOutlook = CreateObject(\"Outlook.Application\")\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 2914838, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/533015076/picture?type=large", "display_name": "Iva Bazhunaishvili", "link": "https://stackoverflow.com/users/2914838/iva-bazhunaishvili"}, "is_accepted": false, "score": 2, "last_activity_date": 1506528678, "creation_date": 1506528678, "answer_id": 46452594, "question_id": 46443745, "link": "https://stackoverflow.com/questions/46443745/excel-vba-code-throws-run-time-error-429-while-sending-outlook-email-using-task/46452594#46452594", "title": "Excel VBA code throws run-time error 429 while sending Outlook email using Task Scheduler", "body": "<p>The reason which was resulting in error was that I was trying to run the task \"with highest privileges\":<a href=\"https://i.stack.imgur.com/btmSS.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/btmSS.jpg\" alt=\"\"></a></p>\n\n<p>This was apparently not feasible in my environment, so when I unchecked it both the VBScript I was using and VBScript suggested by @Nikolaos Polygenis execute normally.</p>\n"}], "owner": {"reputation": 61, "user_id": 2914838, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/533015076/picture?type=large", "display_name": "Iva Bazhunaishvili", "link": "https://stackoverflow.com/users/2914838/iva-bazhunaishvili"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1395, "favorite_count": 0, "accepted_answer_id": 46445223, "answer_count": 3, "score": 2, "last_activity_date": 1506528678, "creation_date": 1506503082, "last_edit_date": 1506521184, "question_id": 46443745, "link": "https://stackoverflow.com/questions/46443745/excel-vba-code-throws-run-time-error-429-while-sending-outlook-email-using-task", "title": "Excel VBA code throws run-time error 429 while sending Outlook email using Task Scheduler", "body": "<p>I'm using Excel VBA macro to send automated emails (Outlook 2013) which runs with Windows Task Scheduler (I'm using batch file to do that) at specified time every day. When I run my macro without Task Scheduler it executes normally (emails are sent), but when I use Task Scheduler for that I receive \"run-time error 429\", this only happens when the VBA macro tries to create Outlook object:  </p>\n\n<pre><code>Dim OutApp As Object\nDim OutMail As Object\n\nSet OutApp = CreateObject(\"Outlook.Application\") 'The error happens here\nSet OutMail = OutApp.CreateItem(0)\n\nOn Error Resume Next\nWith OutMail\n    .to = \"email@email.com\"\n    .CC = \"\"\n    .BCC = \"\"\n    .Subject = \"subj\"\n    .Body = \"body\"\n    .Attachments.Add ActiveWorkbook.FullName\n    .Send\nEnd With\nOn Error GoTo 0\n\nSet OutMail = Nothing\nSet OutApp = Nothing\n</code></pre>\n\n<p>The above error only happens if the Outlook application is open on the computer.\nNow what I don't understand is:</p>\n\n<ol>\n<li><p>Why does the macro work normally WITHOUT Task Scheduler (Despite Outlook being open or not) and why doesn't it work there?</p></li>\n<li><p>How to make the whole process execute using Task Scheduler and not to depend on Outlook app being open or closed? (i.e. I want the macro to run no matter which applications are open/closed).</p></li>\n</ol>\n\n<p>Advice would be highly appreciated. </p>\n\n<p>Edit: Here is the VBScript code I'm using to execute macro (in repsonse to  LS_\u1d05\u1d07\u1d20's question):</p>\n\n<pre><code>    Dim WshShell\nSet WshShell = CreateObject(\"WScript.Shell\")\n\n' Create an Excel instance\nDim myExcelWorker\nSet myExcelWorker = CreateObject(\"Excel.Application\") \n\n' Disable Excel UI elements\nmyExcelWorker.DisplayAlerts = False\nmyExcelWorker.AskToUpdateLinks = False\nmyExcelWorker.AlertBeforeOverwriting = False\nmyExcelWorker.FeatureInstall = msoFeatureInstallNone\n\n' Tell Excel what the current working directory is \n' (otherwise it can't find the files)\nDim strSaveDefaultPath\nDim strPath\nstrSaveDefaultPath = myExcelWorker.DefaultFilePath\nstrPath = WshShell.CurrentDirectory\nmyExcelWorker.DefaultFilePath = strPath\n\n' Open the Workbook specified on the command-line \nDim oWorkBook\nDim strWorkerWB\nstrWorkerWB = strPath &amp; \"\\____DailyReport.xlsm\"\n\nSet oWorkBook = myExcelWorker.Workbooks.Open(strWorkerWB)\n\n' Build the macro name with the full path to the workbook\nDim strMacroName\nstrMacroName = \"'\" &amp; strPath &amp; \"\\____DailyReport.xlsm'\" &amp; \"!Module1.____DailyRep\"\non error resume next \n   ' Run the calculation macro\n   myExcelWorker.Run strMacroName\n   if err.number &lt;&gt; 0 Then\n      ' Error occurred - just close it down.\n   End If\n   err.clear\non error goto 0 \n\n'oWorkBook.Save \n'oWorkBook.Close &lt;&lt;--- we don't need these two because we close the WB in the VBA macro\n\nmyExcelWorker.DefaultFilePath = strSaveDefaultPath\n\n' Clean up and shut down\nSet oWorkBook = Nothing\n\n' Don\u2019t Quit() Excel if there are other Excel instances \n' running, Quit() will \n'shut those down also\nif myExcelWorker.Workbooks.Count = 0 Then\n   myExcelWorker.Quit\nEnd If\n\nSet myExcelWorker = Nothing\nSet WshShell = Nothing\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2003", "excel-2016"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1506501966, "post_id": 46443251, "comment_id": 79842549, "body": "&quot;<i>I am not clear on what the macro is supposed to be doing</i>&quot; How can we help if even <i>you</i> don&#39;t know what the code is doing? The code looks like it is worth to completely re-write it (looks like a mess of bad practices), but therefore you need to know what it should do first."}, {"owner": {"reputation": 523, "user_id": 942329, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/54d7d9aaa4fc9bb64f1cd7a889caec3f?s=128&d=identicon&r=PG", "display_name": "Eds", "link": "https://stackoverflow.com/users/942329/eds"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1506504466, "post_id": 46443251, "comment_id": 79844207, "body": "Because the macro was recorded over 10 years ago and the majority of us in IT and the end users who are using the report were not even with the company at that time. The user who recorded the macro is no longer with the business, so we can&#39;t ask them what the intention behind the macro is. The end users can tell us what fields they expect to be adjusted by the macro and have obviously highlighted errors, but what I mean by my statement is, I don&#39;t know HOW the macro is going about achieving its goal (i.e the actual code)."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1506506082, "post_id": 46443251, "comment_id": 79845347, "body": "I understand your situation, but I see no chance to find an issue like that here. The code doesn&#39;t do anything spectacular, just one copy paste action, one autofill action (probably copy a formula down) and refreshing some query tables. That&#39;s it. But it&#39;s almost impossible to say what&#39;s going wrong here outgoing from just that piece of code you showed (it looks messy because it was recorded but I see nothing wrong with it). This might be the wrong place to ask such a question. Alternatively you need to hire someone who can check the whole file including formulas and query tables for you."}, {"owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "edited": false, "score": 0, "creation_date": 1506506275, "post_id": 46443251, "comment_id": 79845466, "body": "I would suggest checking the code against the Excel worksheets. Do the sheet names mentioned still exist? Do the ranges mentioned have data in them etc.Alternatively use debug to view code execution line by line to see where possible errors might occur."}, {"owner": {"reputation": 523, "user_id": 942329, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/54d7d9aaa4fc9bb64f1cd7a889caec3f?s=128&d=identicon&r=PG", "display_name": "Eds", "link": "https://stackoverflow.com/users/942329/eds"}, "edited": false, "score": 0, "creation_date": 1506512770, "post_id": 46443251, "comment_id": 79849709, "body": "All the data seems ok, and all references and formulas are valid, until the macro is run. Manually correcting what the macro breaks returns the correct data, and further runs of the macro (even after data changes) don&#39;t exhibit the same issues. The report ran fine in 2013 on a Friday, and then after upgrading to 2016, the exact same file exhibits these problems on the Monday. For now, the manual corrections seem to be sufficient for this report, I am just worried we have more hidden away that will have the same problems."}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1506556752, "post_id": 46443251, "comment_id": 79873171, "body": "The list of changed features from Office 2013 to Office 2016 is at <a href=\"https://technet.microsoft.com/en-us/library/mt715497(v=office.16).aspx\" rel=\"nofollow noreferrer\">technet.microsoft.com/en-us/library/mt715497(v=office.16).as&zwnj;&#8203;px</a>"}, {"owner": {"reputation": 523, "user_id": 942329, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/54d7d9aaa4fc9bb64f1cd7a889caec3f?s=128&d=identicon&r=PG", "display_name": "Eds", "link": "https://stackoverflow.com/users/942329/eds"}, "edited": false, "score": 0, "creation_date": 1506589196, "post_id": 46443251, "comment_id": 79884961, "body": "Thanks for that. Doesn&#39;t look to be anything related to VBA or Macros, so guess it&#39;s something else."}], "answers": [{"tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1506514443, "creation_date": 1506514443, "answer_id": 46447610, "question_id": 46443251, "link": "https://stackoverflow.com/questions/46443251/are-there-any-compatibility-issues-with-macros-between-excel-2013-and-2016/46447610#46447610", "title": "Are there any compatibility issues with Macros between Excel 2013 and 2016", "body": "<p>Looks like some of the original code was recorded. This (below) appears to give the same functionality, removing extraneous and unnecessary code. (but I can't see the original sheets of course so treat this cautiously)</p>\n\n<pre><code>Sub EquivalentFunctIonality\nDim qt as QueryTable\nDim ws as Worksheet\nFor each ws in Worksheets\nFor Each qt in ws.querytables\nqt.refresh BackgroundQuery:=False\nNext qt\nnext ws\nWith Worksheets(\"Job Costs\")\n.Range(\"N2:T2\").Copy .range(Range(\"N3\"),.range(\"n3\").End(xlDown))\nEnd With\nEnd Sub\n</code></pre>\n\n<p>See if this still gives errors.</p>\n"}, {"tags": [], "owner": {"reputation": 523, "user_id": 942329, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/54d7d9aaa4fc9bb64f1cd7a889caec3f?s=128&d=identicon&r=PG", "display_name": "Eds", "link": "https://stackoverflow.com/users/942329/eds"}, "is_accepted": false, "score": 0, "last_activity_date": 1506592235, "creation_date": 1506592235, "answer_id": 46466097, "question_id": 46443251, "link": "https://stackoverflow.com/questions/46443251/are-there-any-compatibility-issues-with-macros-between-excel-2013-and-2016/46466097#46466097", "title": "Are there any compatibility issues with Macros between Excel 2013 and 2016", "body": "<p>At this time I have not been able to find any change to 2016 that could be related to this issue.</p>\n\n<p>I have just made manual corrections to the invalid references generated by the first run of the Macro, and allowed it to re-run (apparently successfully every subsequent time).</p>\n\n<p>I have asked the end user to continually monitor the data in the workbook to ensure it is accurate, and will tackle any future workbooks with the same kind of issue in a similar way.</p>\n"}], "owner": {"reputation": 523, "user_id": 942329, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/54d7d9aaa4fc9bb64f1cd7a889caec3f?s=128&d=identicon&r=PG", "display_name": "Eds", "link": "https://stackoverflow.com/users/942329/eds"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1866, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1506592235, "creation_date": 1506501729, "last_edit_date": 1506502110, "question_id": 46443251, "link": "https://stackoverflow.com/questions/46443251/are-there-any-compatibility-issues-with-macros-between-excel-2013-and-2016", "title": "Are there any compatibility issues with Macros between Excel 2013 and 2016", "body": "<p>We have a user with an old 97-2003 Excel document with macros in, which they were using and running in 2013 without issue.</p>\n\n<p>We have now upgraded to 2016 over the weekend, and when running the first macro in the workbook, cells that would normally show us a value, now show #REF!</p>\n\n<p>Oddly, if we correct some of the references manually after the macro has run, then run the macro again, it does not have the same issue the second time around.</p>\n\n<p>We are wondering if there are any changes in 2016 that might cause macros to behave in this way?</p>\n\n<p>The first macro we are running is below:</p>\n\n<pre><code>Sub Update()\n'\n' Macro1 Macro\n' Macro recorded 28/06/2007 by PETER WILSON\n''\n'\n    Sheets(\"DCodes2\").Select\n    Range(\"C4\").Select\n    Application.CutCopyMode = False\n    Selection.QueryTable.Refresh BackgroundQuery:=False\n    Sheets(\"Summary\").Select\n    Range(\"D23\").Select\n    Sheets(\"Sales Inv\").Select\n    Range(\"a2\").Select\n    Selection.QueryTable.Refresh BackgroundQuery:=False\n    Range(\"K5\").Select\n    Sheets(\"Invoices\").Select\n    Selection.QueryTable.Refresh BackgroundQuery:=False\n    Sheets(\"Job Costs\").Select\n    ActiveWindow.LargeScroll ToRight:=-1\n    Range(\"C2\").Select\n    Selection.QueryTable.Refresh BackgroundQuery:=False\n    ActiveWindow.SmallScroll ToRight:=6\n    Range(\"N2:T2\").Select\n    Selection.AutoFill Destination:=Range(\"N2:T284\")\n    Range(\"N2:T284\").Select\n    Range(\"N3\").Select\n    Range(\"J28\").Select\n    Sheets(\"Job Costs\").Select\n    ActiveWindow.SmallScroll ToRight:=-1\n    Range(\"N2:T2\").Select\n    ActiveWindow.LargeScroll ToRight:=-2\n    ActiveWindow.SmallScroll ToRight:=9\n    Selection.AutoFilter Field:=1\n    Range(\"N2:T2\").Select\n    Selection.Copy\n    Range(\"N3\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    ActiveSheet.Paste\n    Sheets(\"Daybook\").Select\n    Range(\"B2\").Select\n    Application.CutCopyMode = False\n    Selection.QueryTable.Refresh BackgroundQuery:=False\n    Sheets(\"Job Costs\").Select\n    Range(\"N2:U2\").Select\n    Sheets(\"Summary\").Select\n    Range(\"I8\").Select\n\n\n'\nEnd Sub\n</code></pre>\n\n<p>I am not clear on what the macro is supposed to be doing, so I am hesitant to go through and try to manually correct for the user in case I get something wrong, and I don't know enough about Visual Basic to determine what the above code is doing at each step.</p>\n"}, {"tags": ["excel", "vba", "indexing", "match", "vlookup"], "comments": [{"owner": {"reputation": 2700, "user_id": 8126658, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/V9KCd.jpg?s=128&g=1", "display_name": "GGO", "link": "https://stackoverflow.com/users/8126658/ggo"}, "edited": false, "score": 1, "creation_date": 1506501404, "post_id": 46442904, "comment_id": 79842181, "body": "Please show us your code"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 8681526, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OE10Ixx6OaQ/AAAAAAAAAAI/AAAAAAAARdU/vJehS9sXKL4/photo.jpg?sz=128", "display_name": "nA Na", "link": "https://stackoverflow.com/users/8681526/na-na"}, "edited": false, "score": 0, "creation_date": 1507449542, "post_id": 46443589, "comment_id": 80207461, "body": "Thank you so much!"}], "tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": true, "score": 0, "last_activity_date": 1506502670, "creation_date": 1506502670, "answer_id": 46443589, "question_id": 46442904, "link": "https://stackoverflow.com/questions/46442904/excel-need-to-match-names-with-data-multiple-times/46443589#46443589", "title": "Excel - Need to match names with Data multiple times", "body": "<p>Assuming your data is in range <code>A:E</code> then in <code>Cell F2</code> enter the following formula</p>\n\n<pre><code>=IFERROR(INDEX($A$1:$A$6,SMALL(IF(({\"M\",\"SS\"}=$C$1:$C$6)+({\"M\",\"SS\"}=$D$1:$D$6)+({\"M\",\"SS\"}=$D$1:$D$6)&gt;0,ROW($A$1:$A$6)),ROW(1:1)),1),\"\")\n</code></pre>\n\n<p>This is an array formula so commit it by pressing <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>Enter</kbd>. Drag/Copy down as required. Change ranges in formula as per your data.</p>\n\n<p><a href=\"https://i.stack.imgur.com/H2uA5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/H2uA5.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 29, "user_id": 8681526, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OE10Ixx6OaQ/AAAAAAAAAAI/AAAAAAAARdU/vJehS9sXKL4/photo.jpg?sz=128", "display_name": "nA Na", "link": "https://stackoverflow.com/users/8681526/na-na"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 46443589, "answer_count": 1, "score": -3, "last_activity_date": 1506502670, "creation_date": 1506500679, "question_id": 46442904, "link": "https://stackoverflow.com/questions/46442904/excel-need-to-match-names-with-data-multiple-times", "title": "Excel - Need to match names with Data multiple times", "body": "<p>I need help with the following: </p>\n\n<pre>\nNames: Misc: D1: D2: D3:\n\nName1 stuff2 D  D  M\nName2 car    D  D  M\nName3 black  M  M  SS\nName4 34     SS SS SS\nName5 7      SS SS D\n</pre>\n\n<p>I am looking to grab the names for each Day and list them either in a cell. \nSo if I am looking for names that have M and SS the following names would be listed into the cell; Name3, Name4, Name5. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 161, "user_id": 5847288, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/dda2fadf981ca09c990415c821421e0e?s=128&d=identicon&r=PG&f=1", "display_name": "robin", "link": "https://stackoverflow.com/users/5847288/robin"}, "edited": false, "score": 0, "creation_date": 1506501628, "post_id": 46442692, "comment_id": 79842329, "body": "Thank you sir for sharing"}], "tags": [], "owner": {"reputation": 1292, "user_id": 1887634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57d96d668a832a01e56fae26fc8859bc?s=128&d=identicon&r=PG", "display_name": "Alan", "link": "https://stackoverflow.com/users/1887634/alan"}, "is_accepted": false, "score": 0, "last_activity_date": 1506499986, "creation_date": 1506499986, "answer_id": 46442692, "question_id": 46442622, "link": "https://stackoverflow.com/questions/46442622/excel-fill-formula-till-last-row/46442692#46442692", "title": "excel fill formula till last row", "body": "<p>This might speed it up - turn off the screen updating while it is running.</p>\n\n<pre><code>Application.ScreenUpdating = False\nApplication.ScreenUpdating = True\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 561, "user_id": 8558614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2h6yS.jpg?s=128&g=1", "display_name": "Nikolaos Polygenis", "link": "https://stackoverflow.com/users/8558614/nikolaos-polygenis"}, "is_accepted": false, "score": 0, "last_activity_date": 1506501195, "creation_date": 1506501195, "answer_id": 46443070, "question_id": 46442622, "link": "https://stackoverflow.com/questions/46442622/excel-fill-formula-till-last-row/46443070#46443070", "title": "excel fill formula till last row", "body": "<p>Please try this:   </p>\n\n<pre><code> Option Explicit\n\nSub fillFormula()\n\n\nDim wbk1 As Workbook\nDim lastRow As Long\n\n\nSet wbk1 = ActiveWorkbook\n\n    With wbk1.Sheets(\"sheet1\")\n\n      lastRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n      lastRow = lastRow - 1\n\n\n      .Range(\"AE3:AE\" &amp; lastRow).Formula = _\n       \"=IFERROR(INDEX(setting!C[-17],MATCH(smart!RC[-9],\" _\n       &amp; \"setting!C[-18],0)),\"\"\"\")\"\n\n\n\n    End With\n\n\n\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 161, "user_id": 5847288, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/dda2fadf981ca09c990415c821421e0e?s=128&d=identicon&r=PG&f=1", "display_name": "robin", "link": "https://stackoverflow.com/users/5847288/robin"}, "edited": false, "score": 0, "creation_date": 1506501680, "post_id": 46443090, "comment_id": 79842362, "body": "Thank you sir for sharing!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 1, "last_activity_date": 1506501250, "creation_date": 1506501250, "answer_id": 46443090, "question_id": 46442622, "link": "https://stackoverflow.com/questions/46442622/excel-fill-formula-till-last-row/46443090#46443090", "title": "excel fill formula till last row", "body": "<p>You should turn off both ScreenUpdating and Calculations when working with large numbers of formulas.</p>\n\n<p>This line <code>If col_AE &lt;&gt; vbNullString Then</code> isn't doing anything.</p>\n\n<p>Option Explicit</p>\n\n<pre><code>Sub FillRows()\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n    Dim col_AE As String\n\n    With Sheet1\n\n        For j = 3 To .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row - 1\n            If .Range(\"ae\" &amp; j).Value = vbNullString Then\n                .Range(\"ae\" &amp; j).FormulaR1C1 = \"=IFERROR(INDEX(setting!C[-17],MATCH(smart!RC[-9],setting!C[-18],0)),\"\"\"\")\"\n            End If\n        Next j\n\n    End With\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>The majority of the processing time is being used because the sheet is recalculating every time a formula is added.  I would just turn off ScreenUpdating and Calculations and replace all the formulas.  In this way I know that the formulas are consistent and that any errors introduced by users would be corrected.</p>\n\n<pre><code>Sub FillRows2()\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n    Dim col_AE As String\n\n    With Sheet1\n        .Range(\"A3\", \"A\" &amp; .Rows.Count).End(xlUp).FormulaR1C1 = \"=IFERROR(INDEX(setting!C[-17],MATCH(smart!RC[-9],setting!C[-18],0)),\"\"\"\")\"\n    End With\n\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 161, "user_id": 5847288, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/dda2fadf981ca09c990415c821421e0e?s=128&d=identicon&r=PG&f=1", "display_name": "robin", "link": "https://stackoverflow.com/users/5847288/robin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 887, "favorite_count": 0, "accepted_answer_id": 46443090, "answer_count": 3, "score": 0, "last_activity_date": 1506501250, "creation_date": 1506499743, "question_id": 46442622, "link": "https://stackoverflow.com/questions/46442622/excel-fill-formula-till-last-row", "title": "excel fill formula till last row", "body": "<p>I have below vba code to put a formula in cell AE3 then copy down to last row, i have 5000+ rows but wonder why it take so long to process (about 5 min. and still running), is there a better way to do this? i want copy down to last row as the list is dynamic data with different ranges every day. Thanks.</p>\n\n<pre><code> Sub FillRows()\n Dim col_AE As String\n Sheet1.Select\n\ncol_AE = \"=IFERROR(INDEX(setting!C[-17],MATCH(smart!RC[-9],setting!C[-18],0)),\"\"\"\")\"\n If col_AE &lt;&gt; vbNullString Then\n    For j = 3 To Range(\"A\" &amp; Rows.Count).End(xlUp).Row - 1\n        If Range(\"ae\" &amp; j).Value = vbNullString Then\n            Range(\"ae\" &amp; j).Value = col_AE\n        End If\n    Next j\n   End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "for-loop", "ms-word", "userform"], "comments": [{"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1506501245, "post_id": 46442554, "comment_id": 79842090, "body": "You didnt specify Worksheet. Try <code>.Worksheet(&quot;SheetName&quot;).Find ...</code>"}], "answers": [{"tags": [], "owner": {"reputation": 615, "user_id": 6236294, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/10204431270580592/picture?type=large", "display_name": "Ibn e Ashiq", "link": "https://stackoverflow.com/users/6236294/ibn-e-ashiq"}, "is_accepted": true, "score": 1, "last_activity_date": 1529647173, "last_edit_date": 1529647173, "creation_date": 1507278367, "answer_id": 46601468, "question_id": 46442554, "link": "https://stackoverflow.com/questions/46442554/opening-workbook-as-object-from-ms-word-and-find-text-using-checkbox-delete-ent/46601468#46601468", "title": "Opening Workbook as object from Ms-Word and Find text using checkbox, Delete entire Row then Close workbook", "body": "<p>You don't need to open workbook and make it visible. This may work for you. <code>Workbooks.close</code> will close all workbooks if exist.</p>\n\n<pre><code>Dim WB As Workbook\nSet WB = Workbooks.Open(\"C:\\Users\\dell\\Desktop\\EMEA CEEMEA\\EMEA CC FINAL LIST.xls\")\nDim C As MSForms.Control\nFor Each C In Me.Controls\nIf TypeName(C) = \"CheckBox\" Then\nIf C.Value = True Then\nIf C.Caption = \"Select All\" Then\nElse\n\n\nWith WB\n    .Application.Sheets(\"Sheet2\").Select\n    .Application.Range(\"A1\").Select\n\n    .Application.Cells.Find(What:=C.Caption, After:=ActiveCell, LookIn:=xlFormulas, _\n    LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n    MatchCase:=False, SearchFormat:=False).Activate\n\n    .Application.ActiveCell.Rows(\"1:1\").EntireRow.Select\n    .Application.Selection.Delete Shift:=xlUp\n\nEnd With\n\nEnd If\nEnd If\nEnd If\nNext C\n\nWB.Close SaveChanges:=True\nWorkbooks.Close\nSet WB = Nothing\n</code></pre>\n"}], "owner": {"reputation": 36, "user_id": 8640475, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o6Ic_uLdmg4/AAAAAAAAAAI/AAAAAAAAAjI/Nuvg0kY84Z4/photo.jpg?sz=128", "display_name": "Muhammad Bilal", "link": "https://stackoverflow.com/users/8640475/muhammad-bilal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 1, "accepted_answer_id": 46601468, "answer_count": 1, "score": 0, "last_activity_date": 1593731097, "creation_date": 1506499500, "last_edit_date": 1593731097, "question_id": 46442554, "link": "https://stackoverflow.com/questions/46442554/opening-workbook-as-object-from-ms-word-and-find-text-using-checkbox-delete-ent", "title": "Opening Workbook as object from Ms-Word and Find text using checkbox, Delete entire Row then Close workbook", "body": "<p>My situation is I am opening <code>Workbook</code> from <code>MS Word</code> where I find some Text and delete entire Row of found Text. To achieve that I am using <a href=\"https://i.stack.imgur.com/3bmiz.png\" rel=\"nofollow noreferrer\">Userform</a> having Check-boxes and Buttons. The code below loop through all check-boxes and if <code>C.Value</code> return <code>True</code> it perform action by pressing <strong>CEEMEA</strong> Button.</p>\n\n<p>I am having problem with <code>Excel Object</code> naming <code>Xc</code>.</p>\n\n<p>For the first time I run <strong>CEEMEA</strong> macro it run properly (Opens workbook--> Find text--> delete row--> close workbook, etc);</p>\n\n<p>but second time, it return error <em><code>Run-time Error '13': Type mismatch</code>.</em> , so far I think there may be something left on first run, which I did not Quit/Close/set to nothing, (duplication of workbook)</p>\n\n<p>I had checked all spellings, Everything is Correct.</p>\n\n<p>I had <code>Xc.Quit</code> at the end, and <code>Set Xc= Nothing</code>. </p>\n\n<p>I did not understand where its going wrong. I thing on the first run there may be something which I did not <code>Quit</code> or <code>Set</code> to <code>Nothing</code>. I put whole code below. kindly help...</p>\n\n<p>If there is beter way of doing this job kindly suggest.</p>\n\n<pre><code>Dim Xc As Object\nSet Xc = CreateObject(\"Excel.Application\")\nXc.Visible = True\nSet Wb = Xc.Workbooks.Open(\"C:\\Users\\dell\\Desktop\\EMEA CEEMEA\\EMEA CC FINAL LIST.xls\")\n\nDim C As MSForms.Control\nFor Each C In Me.Controls\n    If TypeName(C) = \"CheckBox\" Then\n    If C.Value = True Then\n    If C.Caption = \"Select All\" Then\n    Else\n\n    Dim ff As String\n    ff = Trim(C.Caption)\n  With Wb\n        .Application.Sheets(\"Sheet2\").Select\n        .Application.Range(\"A1\").Select\n\n        .Application.Cells.Find(What:=ff, After:=ActiveCell, LookIn:=xlFormulas, _\n        LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n        MatchCase:=False, SearchFormat:=False).Activate\n        .Application.ActiveCell.Rows(\"1:1\").EntireRow.Select\n        .Application.Selection.Delete Shift:=xlUp\n        .Application.Range(\"A1\").Select\n\n  End With\n\n    End If\n    End If\n    End If\nNext C\n\nWb.Close SaveChanges:=True\nWorkbooks.Close\nSet Wb = Nothing\nXc.Quit\nSet Xc = Nothing\n</code></pre>\n"}, {"tags": ["vba", "excel", "copy"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 3, "creation_date": 1506499580, "post_id": 46442400, "comment_id": 79841138, "body": "It would be easier for everyone if <b>you</b> point out the error, and then let us help you to fix it.  Which line does it crash on?  What error message do you get?  If it doesn&#39;t crash, what is it not doing that you think it should be doing?"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 2, "creation_date": 1506500077, "post_id": 46442400, "comment_id": 79841419, "body": "In principle the code works (just tested it), but there are so many things that can fail (Reader doesn&#39;t start, PDF-File cannot be opened, PDF contains only an image to name only a few) that you really should tell what exactly your problem is - and what you already did by yourself to find the problem"}, {"owner": {"reputation": 133, "user_id": 8674336, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/e98e54e12ecc096c09664a2785312cfc?s=128&d=identicon&r=PG&f=1", "display_name": "saurabh255", "link": "https://stackoverflow.com/users/8674336/saurabh255"}, "edited": false, "score": 0, "creation_date": 1506502898, "post_id": 46442400, "comment_id": 79843140, "body": "it is copying the file from pdf by copying it but actually not pasting it to the excel"}, {"owner": {"reputation": 133, "user_id": 8674336, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/e98e54e12ecc096c09664a2785312cfc?s=128&d=identicon&r=PG&f=1", "display_name": "saurabh255", "link": "https://stackoverflow.com/users/8674336/saurabh255"}, "edited": false, "score": 0, "creation_date": 1506502956, "post_id": 46442400, "comment_id": 79843175, "body": "pdf is having a table with two columns name and phone no. it is copying it but pasting not it in excel"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1506504193, "post_id": 46442400, "comment_id": 79844010, "body": "And after copying, you can paste it into excel manually?"}, {"owner": {"reputation": 133, "user_id": 8674336, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/e98e54e12ecc096c09664a2785312cfc?s=128&d=identicon&r=PG&f=1", "display_name": "saurabh255", "link": "https://stackoverflow.com/users/8674336/saurabh255"}, "edited": false, "score": 0, "creation_date": 1506504680, "post_id": 46442400, "comment_id": 79844360, "body": "yes i can but i want to automate it"}, {"owner": {"reputation": 133, "user_id": 8674336, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/e98e54e12ecc096c09664a2785312cfc?s=128&d=identicon&r=PG&f=1", "display_name": "saurabh255", "link": "https://stackoverflow.com/users/8674336/saurabh255"}, "edited": false, "score": 0, "creation_date": 1506504730, "post_id": 46442400, "comment_id": 79844399, "body": "plus two column are coming in same cell... and it is not  matching the exact table format of the pdf"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1506505302, "post_id": 46442400, "comment_id": 79844814, "body": "Try the Paste-Command with <code>wkSheet.Paste</code> rather than <code>SendKeys &quot;^v&quot;</code>. However, it will paste what is copied from the PDF - it&#39;s not an Excel issue if the <code>copy</code>-Part doesn&#39;t copy the data as you expect. Maybe you have to write some code to divide the data into 2 columns"}, {"owner": {"reputation": 133, "user_id": 8674336, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/e98e54e12ecc096c09664a2785312cfc?s=128&d=identicon&r=PG&f=1", "display_name": "saurabh255", "link": "https://stackoverflow.com/users/8674336/saurabh255"}, "edited": false, "score": 0, "creation_date": 1506505566, "post_id": 46442400, "comment_id": 79844985, "body": "ohk thank u so much thomas"}], "answers": [{"tags": [], "owner": {"reputation": 82, "user_id": 8470984, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bdaf6144b39d501104f1ccb5bbdccb8f?s=128&d=identicon&r=PG&f=1", "display_name": "Fong", "link": "https://stackoverflow.com/users/8470984/fong"}, "is_accepted": true, "score": 0, "last_activity_date": 1506500791, "creation_date": 1506500791, "answer_id": 46442936, "question_id": 46442400, "link": "https://stackoverflow.com/questions/46442400/how-to-copy-data-from-pdf-and-paste-it-into-excel-using-vba/46442936#46442936", "title": "how to copy data from pdf and paste it into excel using vba", "body": "<p>It's best if you don't hard code your macros. The below code will allow you to select the file you want, so you wont have problem with opening the PDF file. </p>\n\n<pre><code>Sub run()\n\n\nDim fn As String\n\nWith Application.FileDialog(msoFileDialogOpen)\n.AllowMultiSelect = False\nIf .Show = -1 Then\nfn = .SelectedItems(1)\nElse\nMsgBox \"You cancel the process.\"\nExit Sub\nEnd If\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 8674336, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/e98e54e12ecc096c09664a2785312cfc?s=128&d=identicon&r=PG&f=1", "display_name": "saurabh255", "link": "https://stackoverflow.com/users/8674336/saurabh255"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3629, "favorite_count": 0, "accepted_answer_id": 46442936, "answer_count": 1, "score": -1, "last_activity_date": 1506505685, "creation_date": 1506499011, "last_edit_date": 1506505685, "question_id": 46442400, "link": "https://stackoverflow.com/questions/46442400/how-to-copy-data-from-pdf-and-paste-it-into-excel-using-vba", "title": "how to copy data from pdf and paste it into excel using vba", "body": "<p>i have tried this code but it is not working properly kindly help me with this.</p>\n\n<pre><code>Sub Shell_Copy_Paste()\n\n   Dim o As Variant\n   Dim wkSheet As Worksheet\n\n   Set wkSheet = ActiveSheet\n\n   o = Shell(\"C:\\Program Files (x86)\\Adobe\\Acrobat Reader DC\\Reader\\AcroRd32.exe C:\\Users\\saurabh.ad.sharma\\Desktop\\red.pdf\", vbNormalFocus)\n\n   Application.Wait (Now + TimeSerial(0, 0, 2)) 'Wait for Acrobat to load\n\n   SendKeys \"^a\"   'Select All\n   SendKeys \"^c\"   'Copy\n   SendKeys \"%{F4}\"    'Close shell application\n\n   wkSheet.Range(\"B5\").Select\n   SendKeys \"^v\"   'Paste\n\nEnd Sub\n</code></pre>\n\n<p>kindly point out the error and me with this</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1506499303, "creation_date": 1506499303, "answer_id": 46442494, "question_id": 46442354, "link": "https://stackoverflow.com/questions/46442354/sorting-values-in-pivot-table/46442494#46442494", "title": "Sorting values in Pivot Table", "body": "<p>Use the code below to <code>Sort</code> the <code>PivotTable</code> according to \"Warning\" <code>PivotField</code> :</p>\n\n<pre><code>Dim PvtSht As Worksheet\nDim PvtTbl As PivotTable\n\n' set the worksheet object where the Pivot-Table is locates\nSet PvtSht = Worksheets(\"WARNINGS\")\n\n' set the Pivot-Table object\nSet PvtTbl = PvtSht.PivotTables(\"WarningsPivotTable\")\n\nWith PvtTbl\n    'Sort from Largest for PivotFiels \"Warning\"\n    .PivotFields(\"Warning\").AutoSort xlDescending, \"Warning\"\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 17, "user_id": 7850454, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/768ff3d4ea1d25f9725b1cca88d92dec?s=128&d=identicon&r=PG&f=1", "display_name": "Joaquim Agostinho", "link": "https://stackoverflow.com/users/7850454/joaquim-agostinho"}, "is_accepted": false, "score": 0, "last_activity_date": 1506523486, "creation_date": 1506523486, "answer_id": 46450843, "question_id": 46442354, "link": "https://stackoverflow.com/questions/46442354/sorting-values-in-pivot-table/46450843#46450843", "title": "Sorting values in Pivot Table", "body": "<p>Thank you for your reply.</p>\n\n<p>Getting an \"Unable to get the PivotFields property of the PivotTable class\" error.</p>\n\n<p>Is it because I would need to replace the \"Warning\" below by the column/field I want to sort it? If so, the column/field I want to sort is the Grand Totals.</p>\n\n<p>PivotFields(\"Warning\").AutoSort xlDescending, \"Warning\"</p>\n"}], "owner": {"reputation": 17, "user_id": 7850454, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/768ff3d4ea1d25f9725b1cca88d92dec?s=128&d=identicon&r=PG&f=1", "display_name": "Joaquim Agostinho", "link": "https://stackoverflow.com/users/7850454/joaquim-agostinho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1000, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1506523486, "creation_date": 1506498857, "last_edit_date": 1531164843, "question_id": 46442354, "link": "https://stackoverflow.com/questions/46442354/sorting-values-in-pivot-table", "title": "Sorting values in Pivot Table", "body": "<p>A Pivot table is created using values form a Data Connection.</p>\n\n<p>I saved a macro to sort the values but am now getting a \"Subscript out of Range\" warning when I try to run it after updating to another connection. I guess the macro script is using a static range that I need to replace so that it can run to whatever Pivot Table results I may have.</p>\n\n<p>But which line of the macro code do I need to replace?</p>\n\n<pre><code>Sub SortLargestWarningsCount()\n\n'Find the last used column in a Row\n    Dim LastCol As Integer\n    With ActiveSheet\n        LastCol = .Cells(6, .Columns.Count).End(xlToLeft).Column\n    End With\n\nWorksheets(\"WARNINGS\").Cells(6, LastCol).Activate\nActiveCell.Offset(1, 0).Activate\n\n'Sort from Largest\n    ActiveSheet.PivotTables(\"WarningsPivotTable\").PivotFields( _\n    \"[Warnings].[Column5].[Column5]\").AutoSort xlDescending, _\n    \"[Measures].[Count of Column5]\", ActiveSheet.PivotTables(\"WarningsPivotTable\"). _\n    PivotColumnAxis.PivotLines(12), 1\nEnd Sub\n</code></pre>\n\n<p>Thank you for your help.</p>\n"}, {"tags": ["vba", "excel", "pdf"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1506498325, "post_id": 46441871, "comment_id": 79840379, "body": "Can you check if the Property <code>Print object</code> for the images is set? (Right click on image, &quot;Format Picture&quot;, &quot;Properties&quot;)"}, {"owner": {"reputation": 123, "user_id": 7746302, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/600d7439413cb33871a0962cdb0c2e8e?s=128&d=identicon&r=PG&f=1", "display_name": "tj123", "link": "https://stackoverflow.com/users/7746302/tj123"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1506499716, "post_id": 46441871, "comment_id": 79841224, "body": "Yes Print object is selected"}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 7746302, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/600d7439413cb33871a0962cdb0c2e8e?s=128&d=identicon&r=PG&f=1", "display_name": "tj123", "link": "https://stackoverflow.com/users/7746302/tj123"}, "edited": false, "score": 0, "creation_date": 1506500865, "post_id": 46442542, "comment_id": 79841879, "body": "Thanks - but my range is dynamic, so its always in columns A:K but can be varied row lengths ... Thats why I had named the offset [Destination]."}, {"owner": {"reputation": 561, "user_id": 8558614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2h6yS.jpg?s=128&g=1", "display_name": "Nikolaos Polygenis", "link": "https://stackoverflow.com/users/8558614/nikolaos-polygenis"}, "reply_to_user": {"reputation": 123, "user_id": 7746302, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/600d7439413cb33871a0962cdb0c2e8e?s=128&d=identicon&r=PG&f=1", "display_name": "tj123", "link": "https://stackoverflow.com/users/7746302/tj123"}, "edited": false, "score": 0, "creation_date": 1506504351, "post_id": 46442542, "comment_id": 79844127, "body": "please check again ...i did it with the dynamic rows"}], "tags": [], "owner": {"reputation": 561, "user_id": 8558614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2h6yS.jpg?s=128&g=1", "display_name": "Nikolaos Polygenis", "link": "https://stackoverflow.com/users/8558614/nikolaos-polygenis"}, "is_accepted": true, "score": 0, "last_activity_date": 1506507857, "last_edit_date": 1506507857, "creation_date": 1506499463, "answer_id": 46442542, "question_id": 46441871, "link": "https://stackoverflow.com/questions/46441871/excel-images-not-exporting-to-pdf-after-copypicture/46442542#46442542", "title": "Excel images not exporting to PDF after copypicture", "body": "<p>please try the below..we suppose that images are in sheet2</p>\n\n<pre><code>Option Explicit\n\nSub printPDFSave()\n\nDim rng As Range\nDim fPathFile As Variant\nDim sh As Shape\nDim ShRow As Long\n\nFor Each sh In Sheet2.Shapes\n    ShRow = sh.BottomRightCell.Row\nNex\n\nSet rng = Sheet2.Range(\"A1:K\" &amp; ShRow)\n\nfPathFile = Application.GetSaveAsFilename(filefilter:=\"PDF Files (*.pdf), *.pdf\")\n\nIf fPathFile &lt;&gt; False Then\n    rng.ExportAsFixedFormat Type:=xlTypePDF, Filename:=fPathFile, Quality:=xlQualityStandard, _\n    IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=False\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 7746302, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/600d7439413cb33871a0962cdb0c2e8e?s=128&d=identicon&r=PG&f=1", "display_name": "tj123", "link": "https://stackoverflow.com/users/7746302/tj123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 359, "favorite_count": 0, "accepted_answer_id": 46442542, "answer_count": 1, "score": 0, "last_activity_date": 1506507857, "creation_date": 1506497244, "question_id": 46441871, "link": "https://stackoverflow.com/questions/46441871/excel-images-not-exporting-to-pdf-after-copypicture", "title": "Excel images not exporting to PDF after copypicture", "body": "<p>Have worked to copy a range of cells as picture to a seperate worksheet <a href=\"https://stackoverflow.com/questions/46423307/convert-excel-rows-to-pdf-loop\">here.</a> The range of cells automatically populate based on self selection on another worksheet - so this effectively builds a series of images intended to be and indicator pack.</p>\n\n<p>Have now written something to export to PDF - the print area uses the offset function depending on the number of indicators selected.</p>\n\n<p>But the export to PDF runs but does not pick up the pictures - can you help?</p>\n\n<pre><code>Sub printPDFSave()\n\nDim rng As Range\nDim fPathFile As Variant\n\nSet rng = [Destination]\n\nfPathFile = Application.GetSaveAsFilename(filefilter:=\"PDF Files (*.pdf), *.pdf\")\nIf fPathFile &lt;&gt; False Then\n    rng.ExportAsFixedFormat Type:=xlTypePDF, Filename:=fPathFile,  Quality:=xlQualityStandard, _\n    IncludeDocProperties:=True, IgnorePrintAreas:=False,  OpenAfterPublish:=False\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 3, "creation_date": 1506496879, "post_id": 46441568, "comment_id": 79839579, "body": "Why not apply a custom number format with &quot;00&quot;? That way the numbers will remain as numbers and you don&#39;t need to format the column as Text."}, {"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 2, "creation_date": 1506496881, "post_id": 46441568, "comment_id": 79839581, "body": "I suggest you do some research, try something, then come back with any specific problem you&#39;re having with your attempt."}, {"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "edited": false, "score": 0, "creation_date": 1506498844, "post_id": 46441568, "comment_id": 79840680, "body": "If the cell content is <code>-9</code> then it should be <code>-09</code> or <code>09</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8681072, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AzD2rabPrVA/AAAAAAAAAAI/AAAAAAAAAFA/xc8Woe-w7Mw/photo.jpg?sz=128", "display_name": "Peter", "link": "https://stackoverflow.com/users/8681072/peter"}, "edited": false, "score": 0, "creation_date": 1506677412, "post_id": 46442800, "comment_id": 79926218, "body": "Thank you very much Peh,  But the cells are still remaining like &quot;General&quot; format in whole column.  I did manual format reclass to Text and after macro run, its automatically switched to General. Also if you have 0 in the cell, it supposed to be 00. I tryed to macro by different solutions how to include 0 before the digit 1,2,3..but its still replacing me whole column for 00 which is not possible. There are several different codes like 0, 2, which shoudl include also 0 like 00,02,...but also text characters AC, EF, etc. which should not be overwritten."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 1, "user_id": 8681072, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AzD2rabPrVA/AAAAAAAAAAI/AAAAAAAAAFA/xc8Woe-w7Mw/photo.jpg?sz=128", "display_name": "Peter", "link": "https://stackoverflow.com/users/8681072/peter"}, "edited": false, "score": 0, "creation_date": 1506683070, "post_id": 46442800, "comment_id": 79929265, "body": "With the first code (1) all cells in column K become usere defined format <code>&quot;00&quot;</code>. With the second code (2) (if you did not change anything) all non-empty cells in column K will be format &quot;Text&quot;. All <code>0</code> become <code>00</code>. So I don&#39;t see any issues. If you think something goes wrong then please give a detailed example what the (a) source data is, (b) what my code makes out of it and (c) what you expect it to be!"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1506500352, "creation_date": 1506500352, "answer_id": 46442800, "question_id": 46441568, "link": "https://stackoverflow.com/questions/46441568/how-to-put-character-if-there-is-one-digit-in-cell-in-vba-macro/46442800#46442800", "title": "How to put character if there is one digit in cell in VBA Macro?", "body": "<p>There are 2 solutions:</p>\n\n<ol>\n<li>Format the numbers</li>\n<li>Convert numbers to text and format them</li>\n</ol>\n\n<h3>1. Format the numbers</h3>\n\n<p>The advantage of this solution is that the numbers will still be numbers (not text) but formatted with leading zeros. Therefore you still can calculate with these numbers as before.</p>\n\n<pre><code>Public Sub ChangeNumberFormat()\n    ThisWorkbook.Worksheets(\"YourDesiredSheetName\").Columns(\"K\").NumberFormat = \"00\"\n    'this will keep them numbers but only change the format of them\nEnd Sub\n</code></pre>\n\n<p>Note that you don't need to do this necessarily with VBA you can just set a user defined cell format <code>00</code> for column K (open format cells with <kbd>Ctrl</kbd> + <kbd>1</kbd>).</p>\n\n<hr>\n\n<h3>2. Convert numbers to text and format them</h3>\n\n<p>If you really need to convert them to text this would be a possible solution. But I really don't recommend that because you cannot calculate with these \"numbers\" anymore because they are converted to text.</p>\n\n<p>The trick would be to format the number with numberformat first and then convert it to text (see comments in the code).</p>\n\n<pre><code>Option Explicit 'force variable declaring\n\nPublic Sub FixLeadingZerosInText()\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"YourDesiredSheetName\") '&lt;-- change your sheet name here\n\n    Dim lRow As Long\n    lRow = ws.Cells(ws.Rows.Count, \"K\").End(xlUp).Row  'find last used row in column K\n\n    Dim iCell As Range\n    For Each iCell In ws.Range(\"K1:K\" &amp; lRow)          'loop from row 1 to last used in column K\n        If iCell.Value &lt; 10 And iCell.Value &gt; -10 Then 'check if it is a one digit number\n            Dim tmpText As String\n            tmpText = Format(iCell.Value, \"00\")        'format the one digit number\n            iCell.NumberFormat = \"@\"                   'convert number to text\n            iCell.Value = tmpText                      're-write formatted number\n        End If\n        iCell.NumberFormat = \"@\" 'make all other numbers in column K formatted as text too\n    Next iCell\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8681072, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AzD2rabPrVA/AAAAAAAAAAI/AAAAAAAAAFA/xc8Woe-w7Mw/photo.jpg?sz=128", "display_name": "Peter", "link": "https://stackoverflow.com/users/8681072/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1506500352, "creation_date": 1506496209, "last_edit_date": 1506497483, "question_id": 46441568, "link": "https://stackoverflow.com/questions/46441568/how-to-put-character-if-there-is-one-digit-in-cell-in-vba-macro", "title": "How to put character if there is one digit in cell in VBA Macro?", "body": "<p>I would like to ask, how to put character, in this case <code>0</code> to cell, if the cell already contains digit in it. \nTo clarify what do I mean, if on the cell is number <code>5</code>, I would like to put before the number <code>5</code>, number <code>0</code> to have the result <code>05</code>. </p>\n\n<p>As far as I know, cell format should be TEXT to avoid automatic Excel correction. But, this question is specific due to several different characters in the cells. In some point I got in the same column different characters in the cells (<code>1</code>, <code>2</code>, <code>3</code>, <code>AV</code>, <code>AR</code>, <code>IX</code> etc.). </p>\n\n<p>For example: I would like to select column K, find the numeric characters with one digit (<code>1</code>, <code>2</code>, <code>3</code>, <code>-9</code>) and paste there <code>0</code> before it to have two space digit like <code>01</code>, <code>02</code>, <code>03</code>, \u2026</p>\n\n<p>Of course, with macro. I know how to put Text format to it, but do not know how to manage the whole macro function to select column K, format whole column as text, find one digit number in the column and paste <code>0</code> before it.</p>\n\n<p>Does anybody know how to do that?<br>\nMany thanks in advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1506493826, "post_id": 46440540, "comment_id": 79837958, "body": "why do you set this variable <code>Set KWHWB = ActiveWorkbook</code> and then still refer to <code>ActiveWorkbook</code> in your code?"}, {"owner": {"reputation": 19, "user_id": 8680769, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155862081072376/picture?type=large", "display_name": "Maksim Maksimovi\u0107", "link": "https://stackoverflow.com/users/8680769/maksim-maksimovi%c4%87"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1506496408, "post_id": 46440540, "comment_id": 79839333, "body": "You are right, I will make the change, but I don&#39;t believe that&#39;s the problem with my code, do you?"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1506548670, "post_id": 46440540, "comment_id": 79870955, "body": "no it is not the problem"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 8680769, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155862081072376/picture?type=large", "display_name": "Maksim Maksimovi\u0107", "link": "https://stackoverflow.com/users/8680769/maksim-maksimovi%c4%87"}, "edited": false, "score": 0, "creation_date": 1506510092, "post_id": 46445734, "comment_id": 79847976, "body": "Thanks a lot for your reply. I am working in the Controlling and Budgeting Department of a large production company. I am working with at least 50 different Excel files, each of which has at least 10 Worksheets, and all of these are linked together. I really cannot see how we can transition to a different platform. I simply cannot start making changes one at a time, because there is no one thing in this entire mess which is not connected to 30 other things. Individual files can&#39;t be repaired - I would put my life on it. I am trying to ease some processes with Macros, but here I am."}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 0, "last_activity_date": 1506508724, "creation_date": 1506508724, "answer_id": 46445734, "question_id": 46440540, "link": "https://stackoverflow.com/questions/46440540/vba-doesnt-update-excel-links/46445734#46445734", "title": "VBA doesn&#39;t update Excel links", "body": "<p>...and so it begins!  I apologize in advance if I make this problem sound worse it turns out to me, but I'll share how an identical situation turned our for me (and some possible fixes).</p>\n\n<p>Honestly, reading your story triggered PTSD-like panic, of me being in the same situation: working for years with a plethora of interlinked spreadsheets, macros mashing together countless ever-changing ever-changing data sources... and <strong>successfully</strong> handing financial and analysis reporting for multiple corporations, working miracles with inconceivable amounts of data, stretching Excel to the sheer limits of capability.  It was a fragile yet awesome time of my life...  Read: <a href=\"http://fortune.com/2012/10/01/confessions-of-an-excel-addict/\" rel=\"nofollow noreferrer\">\u201cConfessions of an Excel addict\u201d</a>   </p>\n\n<p>\u2026until things started going wrong.  Read: <a href=\"https://www.pcworld.com/article/143348/article.html\" rel=\"nofollow noreferrer\">\u201cIs Business Overworking Excel?\u201d</a></p>\n\n<p>Excel is very powerful but it has limitations, and when it's stretched too thin with too many interrelated dependencies, things like a minor unexpected change, or an otherwise-minor network hiccup or power fluctuation, can become the <em>butterfly that starts a hurricane</em> of headache, especially if your office is as dependent on this data &amp; reporting as I suspect.  Read about: <a href=\"https://en.wikipedia.org/wiki/Data_degradation\" rel=\"nofollow noreferrer\">\"Data Degradation\"</a>  </p>\n\n<p>The workaround to this particular problem is a matter of patience and  troubleshooting skills.  I hope you have extra some time on your hands.</p>\n\n<p>At least all but one the identical files are <em>potentially</em> okay; that narrows it down a LOT -- but does <strong>not</strong> necessarily mean that the problem is in <em>that</em> file.  (i.e., an error in a <em>different</em> file could be causing this one to act up.)  Did you try <strong>skipping that file</strong> and moving on the next file?  Delete and repopulate the data for the last week?  What changed?  Watch: <a href=\"https://youtu.be/MCsRGNSbWxk\" rel=\"nofollow noreferrer\">\u201cTroubleshooting Theory\u201d</a>  </p>\n\n<p>Beyond that, my next step would be to start big and narrow down the issue from there, so you\u2019re dealing with the whole haystack at once.  By the sounds of it, even if the issue is only one cell, finding it is literally a <em>one in a million</em> shot. Read: <a href=\"https://support.office.com/en-us/article/Repair-a-corrupted-workbook-153a45f4\" rel=\"nofollow noreferrer\">\u201cRepair a corrupted workbook\u201d</a>  (Microsoft\u2019s only advice)</p>\n\n<p>Make an extra backup of <em>everything</em> (all files, month-to-date and even prior if possible). This could be a pain, or a <strong><em>real</em></strong> pain, but since you have a separate \u201cbackup\u201d copy of last month's data, make yet another copy of ALL of it, then go through the files one by one, <em>carefully</em> deleting all of last month's data, and once they\u2019re all empty, copy <em>this month's data</em> into them.  Make sure you change any dates and links that need to be updated.  Before seeing if it worked, <strong>triple-check</strong> that you haven't missed anything in restoring this month's data to last month's files.  Memorize: <a href=\"https://www.google.ca/search?q=rule%20of%203%20backups\" rel=\"nofollow noreferrer\">\u201cThe 3-2-1 Backup Rule\u201d</a>  </p>\n\n<p>Then pray to the Excel Gods while trying to run the processes you normally would.  If you're lucky, everything will run smoothly, with minimal to no data loss, nor overnights at the office.</p>\n\n<p>If it worked, Congratulations!  But I'm not done yet! </p>\n\n<p>Immediately make <strong>yet another</strong> backup set of this months\u2019 (working) files, and store them nowhere near where they were. (I learned the hard way why copying a file to a different folder on the same drive is not a good idea.)  Afterwards, destroy the faulty copy of the files, and defrag every computer the data ever touches.</p>\n\n<p>Finally, and <strong>this is the most important step</strong>, it's time to acknowledge that Excel has done its job well, but it's time to transition to a system that is intended for this type of data management.</p>\n\n<p>In my experience, once \"minor\" issues like this start, it's only going to keep on happening.  \"Workarounds\" will be putting out fires more and more often.  Finally, I admitted to myself that it was time to transition everything to Microsoft Access.  Research: \u201cWhen is it time to switch from Excel to Access?\u201d  <a href=\"https://www.google.ca/searchq=when+is+it+time+to+switch+from+excel+to+access\" rel=\"nofollow noreferrer\">https://www.google.ca/searchq=when+is+it+time+to+switch+from+excel+to+access</a></p>\n\n<p>Even if you don't have a lot of experience with Access and are looking at a sudden learning-curve, the change will be relatively easy since Excel and Access are made to work with each other, and soon you and everyone else in the company will be thankful you did, for it's increased usability &amp; reliability, with an interface you put together to meet your exact needs, and expansion is never an issue. Read: \u201cTop 10 reasons to use Access with Excel\u201d  <a href=\"https://support.office.com/en-us/article/Top-10-reasons-to-use-Access-with-Excel\" rel=\"nofollow noreferrer\">https://support.office.com/en-us/article/Top-10-reasons-to-use-Access-with-Excel</a></p>\n\n<p>Access and I sort of had a \"shotgun wedding\" but we lived happily ever after.  Life at the office became easier than ever, I was learning new skills on the company\u2019s dime, and things improved further when I finally convinced the higher-ups to shell out some real money for a top-shelf SQL Server package, redundant backups, \u201clive\u201d automatic reporting. Access was still there as the pretty front-end face, while SQL lived in the dark basement, alone, handling all the heavy lifting but never complaining.  Read: <a href=\"https://www.google.ca/search?q=moving%20ahead%20in%20your%20data%20analysis%20career%20at%20any%20age&amp;ie=utf-8&amp;oe=utf-8&amp;gws_rd=cr&amp;dcr=0&amp;ei=inXLWaW9DYeIjwPwmr64DA\" rel=\"nofollow noreferrer\">\u201cHow to start any career without any experience\u201d</a> </p>\n\n<p>In fact, the system ended up working out so well that the company decided to re-sell it to other similar companies, which basically consisted of nothing more than copy &amp; pasting the existing files, changing a logo here or a report name there.</p>\n\n<p>I was rewarded immensely for being such a forward-thinking superstar...  I never told them that I wasn't exactly <em>taking initiative</em> at the time, and even I didn't realize until later just how close we were to catastrophic data loss.   Read: <a href=\"http://www.dpbestflow.org/backup/backup-overview\" rel=\"nofollow noreferrer\">\u201cBackup Overview\u201d</a>  </p>\n\n<p>And we all lived happily ever after.  I like answering Excel questions online because after that, everything seems easy.     ...until today when I read your post.  Hopefully you can get this fixed up before you realize how close you might have been to having a <em>reallllly</em> bad day.</p>\n\n<p><strong>Good Luck!</strong>       Watch: <a href=\"https://youtu.be/kOO31qFmi9A\" rel=\"nofollow noreferrer\">\u201cMy Old Friend Excel\u201d</a>(Original TV Commercial, 1992)</p>\n"}], "owner": {"reputation": 19, "user_id": 8680769, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155862081072376/picture?type=large", "display_name": "Maksim Maksimovi\u0107", "link": "https://stackoverflow.com/users/8680769/maksim-maksimovi%c4%87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 683, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1506508724, "creation_date": 1506492254, "last_edit_date": 1506492721, "question_id": 46440540, "link": "https://stackoverflow.com/questions/46440540/vba-doesnt-update-excel-links", "title": "VBA doesn&#39;t update Excel links", "body": "<p>I am new here. Thanks to everyone who is making a contribution, and sharing their knowledge.</p>\n\n<p>I have a whole network of Excel files linked between themselves. At the beginning of every month, I am making copies of each file, reflecting the month and year in the name of each file. \nIn order not to link them one by one every month, I made a Macro following a simple logic. The Macro seems to work for most of the files, however, in one file, I encountered a problem.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Dim MISWB As Workbook\nWorkbooks.Open Filename:=\"Y:\\AM\\20\" &amp; Godina &amp; \"\\MIS_\" &amp; Godina &amp; \"\\1MIS\" &amp; Godina &amp; Mesec &amp; \".xlsx\", UpdateLinks:=0\nSet MISWB = ActiveWorkbook\n\n'*****INPUT*****\nChDir \"Y:\\AM\\20\" &amp; Godina &amp; \"\\INPUT_\" &amp; Godina\nActiveWorkbook.ChangeLink Name:=\"Y:\\AM\\20\" &amp; Godina &amp; \"\\INPUT_\" &amp; Godina &amp; \"\\INPUT\" &amp; Godina &amp; PrethodenMesec &amp; \".xlsx\", NewName:= _\n\"INPUT\" &amp; Godina &amp; Mesec &amp; \".xlsx\", Type:=xlExcelLinks\n\nWhere:\n- Godina = year\n- Mesec = current month\n- Prethoden mesec = previous month\n</code></pre>\n\n<p>Well, when I have the file INPUT1709.xlsx open in the background, the Macro seems to be updating the link correctly.\nWhen I don't have it open, and run the Macro, it doesn't change the link correctly, as if \"INPUT1709.xlsx\" doesn't exist. That's what it says when I click \"OPEN SOURCE\" from the \"EDIT LINKS\" tab.</p>\n\n<p>In other files, the same code works without a problem, no matter if the INPUT file is open or not. For example:</p>\n\n<pre><code>'|***********************KWH***********************|\nDim KWHWB As Workbook\nWorkbooks.Open Filename:=\"Y:\\AM\\20\" &amp; Godina &amp; \"\\KWH_\" &amp; Godina &amp; \"\\KWh_\" &amp; Godina &amp; Mesec &amp; \".xls\", UpdateLinks:=0\nSet KWHWB = ActiveWorkbook\n\n'*****INPUT*****\nChDir \"Y:\\AM\\20\" &amp; Godina &amp; \"\\INPUT_\" &amp; Godina\nActiveWorkbook.ChangeLink Name:=\"Y:\\AM\\20\" &amp; Godina &amp; \"\\INPUT_\" &amp; Godina &amp; \"\\INPUT\" &amp; Godina &amp; PrethodenMesec &amp; \".xlsx\", NewName:= _\n\"INPUT\" &amp; Godina &amp; Mesec &amp; \".xlsx\", Type:=xlExcelLinks\n</code></pre>\n\n<p>Any ideas what is going on here?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1506491767, "post_id": 46440400, "comment_id": 79836982, "body": "You haven&#39;t tried <code>LCase(Format(Range(&quot;D6&quot;).Value,&quot;ddd mm-dd&quot;))</code>?"}, {"owner": {"reputation": 13, "user_id": 8680690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da2f38aeac0cf16255549cc40bb27f3f?s=128&d=identicon&r=PG&f=1", "display_name": "Nikhil Thomas", "link": "https://stackoverflow.com/users/8680690/nikhil-thomas"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1506491949, "post_id": 46440400, "comment_id": 79837046, "body": "I dont know to use it... am new to vba"}, {"owner": {"reputation": 13, "user_id": 8680690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da2f38aeac0cf16255549cc40bb27f3f?s=128&d=identicon&r=PG&f=1", "display_name": "Nikhil Thomas", "link": "https://stackoverflow.com/users/8680690/nikhil-thomas"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1506492071, "post_id": 46440400, "comment_id": 79837097, "body": "For selecting a single cell i got Activesheet.name=Range(&quot;B5&quot;) ... but i want column B6 value also in the format i specified... any help will be appreciated"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1506492099, "post_id": 46440400, "comment_id": 79837111, "body": "@NikhilThomas see my answer and code below"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8680690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da2f38aeac0cf16255549cc40bb27f3f?s=128&d=identicon&r=PG&f=1", "display_name": "Nikhil Thomas", "link": "https://stackoverflow.com/users/8680690/nikhil-thomas"}, "edited": false, "score": 0, "creation_date": 1506492623, "post_id": 46440494, "comment_id": 79837356, "body": "Getting error as &quot;wrong number of arguments or invalid property assignment&quot;"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 13, "user_id": 8680690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da2f38aeac0cf16255549cc40bb27f3f?s=128&d=identicon&r=PG&f=1", "display_name": "Nikhil Thomas", "link": "https://stackoverflow.com/users/8680690/nikhil-thomas"}, "edited": false, "score": 0, "creation_date": 1506492674, "post_id": 46440494, "comment_id": 79837373, "body": "@NikhilThomas when you run the code in debug mode (press <b>F8</b>) at which line are you getting this error ?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 13, "user_id": 8680690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da2f38aeac0cf16255549cc40bb27f3f?s=128&d=identicon&r=PG&f=1", "display_name": "Nikhil Thomas", "link": "https://stackoverflow.com/users/8680690/nikhil-thomas"}, "edited": false, "score": 0, "creation_date": 1506493200, "post_id": 46440494, "comment_id": 79837625, "body": "@NikhilThomas Try closing Excel and restarting, start from scratch, and paste this code in a &quot;clean&quot; workbook, with judt the data in &quot;D5&quot; and &quot;D6&quot;"}, {"owner": {"reputation": 13, "user_id": 8680690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da2f38aeac0cf16255549cc40bb27f3f?s=128&d=identicon&r=PG&f=1", "display_name": "Nikhil Thomas", "link": "https://stackoverflow.com/users/8680690/nikhil-thomas"}, "edited": false, "score": 0, "creation_date": 1506494335, "post_id": 46440494, "comment_id": 79838217, "body": "It was an error from my side.... i pasted in wrong column...  its working perfect. Thanks a lot Shai"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 2, "last_activity_date": 1506492048, "creation_date": 1506492048, "answer_id": 46440494, "question_id": 46440400, "link": "https://stackoverflow.com/questions/46440400/vba-code-to-rename-a-sheet/46440494#46440494", "title": "VBA code to rename a sheet", "body": "<p>Try the code below:</p>\n\n<pre><code>Option Explicit\n\nSub RenameActiveSheet()\n\nDim ShtName As String\n\nWith ActiveSheet\n    ShtName = Left(.Range(\"D5\").Value2, 3) &amp; \" \" &amp; Format(.Range(\"D6\").Value, \"mm-dd\")\n    .Name = ShtName\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 8680690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da2f38aeac0cf16255549cc40bb27f3f?s=128&d=identicon&r=PG&f=1", "display_name": "Nikhil Thomas", "link": "https://stackoverflow.com/users/8680690/nikhil-thomas"}, "edited": false, "score": 0, "creation_date": 1506493086, "post_id": 46440616, "comment_id": 79837562, "body": "I hv only one sub function.. if i need to make this change at last before End Sub how to modify it"}], "tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": false, "score": 0, "last_activity_date": 1506552636, "last_edit_date": 1506552636, "creation_date": 1506492632, "answer_id": 46440616, "question_id": 46440400, "link": "https://stackoverflow.com/questions/46440400/vba-code-to-rename-a-sheet/46440616#46440616", "title": "VBA code to rename a sheet", "body": "<p>Since no relation on how Worksheets are to be renamed based on your Output, I will just show you key components to do so.</p>\n\n<p>Below will rename <em>every</em> worksheet based on a date value in <strong>D6</strong> of each one.</p>\n\n<pre><code>Option Explicit\n\nSub SO46440400()\n    Dim oWS As Worksheet\n    ' Assuming rename each sheet based on a cell value (D6) on that sheet:\n    For Each oWS In ThisWorkbook.Worksheets\n        oWS.Name = LCase(Format(DateValue(oWS.Range(\"D6\").Value), \"ddd mm-dd\"))\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8680690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da2f38aeac0cf16255549cc40bb27f3f?s=128&d=identicon&r=PG&f=1", "display_name": "Nikhil Thomas", "link": "https://stackoverflow.com/users/8680690/nikhil-thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4893, "favorite_count": 0, "accepted_answer_id": 46440494, "answer_count": 2, "score": -3, "last_activity_date": 1506552636, "creation_date": 1506491574, "last_edit_date": 1531164843, "question_id": 46440400, "link": "https://stackoverflow.com/questions/46440400/vba-code-to-rename-a-sheet", "title": "VBA code to rename a sheet", "body": "<p>I have a VBA code which generate a set of outputs. After the output is generated we want to rename the sheet by taking value from two cells namely D5 and D6.</p>\n\n<p>D5 value is <code>Wednesday</code><br>\nD6 value is <code>September 13, 2017</code></p>\n\n<p>Name format for sheet: <code>wed 09-13</code></p>\n\n<p>Please help.</p>\n"}, {"tags": ["excel", "sharepoint", "vba"], "comments": [{"owner": {"reputation": 27, "user_id": 4570477, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-aCRqw4PpVRY/AAAAAAAAAAI/AAAAAAAAACA/cFEagw7lDz0/photo.jpg?sz=128", "display_name": "Jayson D", "link": "https://stackoverflow.com/users/4570477/jayson-d"}, "edited": false, "score": 0, "creation_date": 1507089796, "post_id": 46440095, "comment_id": 80067464, "body": "So I have tried IE Automation but I am very new to VBA and it&#39;s overly complicated for my level. What I&#39;ve been reading is to somehow use the following code from the site I am accessing but it just doesn&#39;t seem to work for example code I have tried; &lt;span class=&quot;ms-cui-ctl-mediumlabel&quot; unselectable=&quot;on&quot;&gt;Export to Excel&lt;/span&gt;"}, {"owner": {"reputation": 27, "user_id": 4570477, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-aCRqw4PpVRY/AAAAAAAAAAI/AAAAAAAAACA/cFEagw7lDz0/photo.jpg?sz=128", "display_name": "Jayson D", "link": "https://stackoverflow.com/users/4570477/jayson-d"}, "edited": false, "score": 0, "creation_date": 1507090034, "post_id": 46440095, "comment_id": 80067530, "body": "I basically want it to load the page &quot;which I can do&quot; and then click the &quot;Export to Excel&quot; button in the toolbar on the SharePoint site but can&#39;t get that to happen, the page loads then nothing. Can anyone show me how I would achieve this? Tutorials say to call the class or tag but can&#39;t determine what is what. I&#39;m sorry lame I know but I am very new to all this :("}], "answers": [{"tags": [], "owner": {"reputation": 25, "user_id": 4959076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qUyNa.png?s=128&g=1", "display_name": "themaksmw", "link": "https://stackoverflow.com/users/4959076/themaksmw"}, "is_accepted": false, "score": 0, "last_activity_date": 1506493620, "creation_date": 1506493620, "answer_id": 46440849, "question_id": 46440095, "link": "https://stackoverflow.com/questions/46440095/navigate-to-sharepoint-site-and-export-data/46440849#46440849", "title": "Navigate to Sharepoint Site and Export Data", "body": "<p>If you want a macro in Excel that works with a webpage like a person would, you can use IE automation. There you can tell IE to go to a specified URL, press explicit buttons, enter some text, wait for the page to load, etc. You'll find plenty guides for \"excel vba ie automation\".</p>\n"}], "owner": {"reputation": 27, "user_id": 4570477, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-aCRqw4PpVRY/AAAAAAAAAAI/AAAAAAAAACA/cFEagw7lDz0/photo.jpg?sz=128", "display_name": "Jayson D", "link": "https://stackoverflow.com/users/4570477/jayson-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 199, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1506493620, "creation_date": 1506490056, "last_edit_date": 1531164843, "question_id": 46440095, "link": "https://stackoverflow.com/questions/46440095/navigate-to-sharepoint-site-and-export-data", "title": "Navigate to Sharepoint Site and Export Data", "body": "<p>I know a little about Excel VBA but this is a little over my head (may not even be possible).</p>\n\n<p>Is there a way to write code to;</p>\n\n<ul>\n<li>Navigate to a sharepoint web addresss</li>\n<li>In the 'Library' menu at the top it is selected</li>\n<li>'Export Data' is clicked </li>\n</ul>\n\n<p>Basically mimicking how an actual person would interact to achieve this?</p>\n\n<p>I've looked everywhere but can't find anything which is making me think it is not possible, but have seen things 'not thought possible' achieved through this site so thought I'd give it a shot.</p>\n\n<p>Can anyone help me with this please?</p>\n"}, {"tags": ["excel", "charts", "vba"], "owner": {"reputation": 82, "user_id": 8470984, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bdaf6144b39d501104f1ccb5bbdccb8f?s=128&d=identicon&r=PG&f=1", "display_name": "Fong", "link": "https://stackoverflow.com/users/8470984/fong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1506489781, "creation_date": 1506489302, "last_edit_date": 1531161705, "question_id": 46439947, "link": "https://stackoverflow.com/questions/46439947/why-doesnt-my-chart-in-excel-2013-auto-update-whenever-i-add-in-additional-data", "title": "Why doesn&#39;t my chart in excel 2013 auto update whenever i add in additional data?", "body": "<p>I'm still new to VBA thus I don't have much knowledge in VBA. Regarding this matter I've searched it online and tried most of the given solutions on Stack Overflow and still couldn't make it work. The only way that work is by doing it manually daily which I hope not to. Everyday I will add data into the worksheet to generate a comparison chart for me. I've tried using various  method :\n - chart.refresh\n - do events\n - refreshall </p>\n\n<p>Sadly, none of them work for my workbook. Other than that, I have 2 chart that needs to be updated in a worksheet and I have 3 worksheets. So I will be literally updating 6 charts at once. Is there a way to make it work without doing it manually ? </p>\n\n<p><a href=\"https://i.stack.imgur.com/Tuim4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Tuim4.png\" alt=\"The highlighted area in the first picture is for the chart on the left \"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/1s76V.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1s76V.png\" alt=\"The highlighted area in the second picture is for the chart on the right\"></a></p>\n\n<p>This is the code that I'm working on right now and updating the chart is the last part already. </p>\n\n<pre><code>Sub trial()\n\nDim wb As Workbook, wb2 As Workbook, wb3 As Workbook\nDim ws As Worksheet\n\nDim fn As String\n\nSet wb = ActiveWorkbook\nSet ws = Sheets.Add(After:=Sheets(Worksheets.Count))\nDim Ret\n\n    Ret = Application.GetOpenFilename(\"Lkl Files (*.lkl), *.lkl\")\n\n    If Ret &lt;&gt; False Then\n        With ActiveSheet.QueryTables.Add(Connection:= _\n        \"TEXT;\" &amp; Ret, Destination:=Range(\"$A$1\"))\n        .Name = \"SPC_PLTB_450B_12092107_25\u00b0C_CW\"\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .TextFilePromptOnRefresh = False\n        .TextFilePlatform = 65001\n        .TextFileStartRow = 1\n        .TextFileParseType = xlDelimited\n        .TextFileTextQualifier = xlTextQualifierDoubleQuote\n        .TextFileConsecutiveDelimiter = False\n        .TextFileTabDelimiter = True\n        .TextFileSemicolonDelimiter = False\n        .TextFileCommaDelimiter = False\n        .TextFileSpaceDelimiter = False\n        .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)\n        .TextFileDecimalSeparator = \",\"\n        .TextFileThousandsSeparator = \".\"\n        .TextFileTrailingMinusNumbers = True\n        .Refresh BackgroundQuery:=False\n\n        End With\n    End If\n\n\n    Sheets(2).Activate\n\n    'this is for the date (loop)\n\n    Dim FirstCell As String\n        Dim i As Integer\n            FirstCell = \"C19\"\n            Range(FirstCell).Select\n            Do Until ActiveCell.Value = \"\"\n            If ActiveCell.Value = \"\" Then\n            Exit Do\n            Else\n            ActiveCell.Offset(1, 0).Select\n            End If\n            Loop\n            ActiveCell = Format(Date, \"mm/dd/yyyy\")\n\n    ws.Activate\n    ws.AutoFilterMode = False\n    ws.Range(\"$A$9:$P$417\").AutoFilter Field:=5, Criteria1:= _\n        \"1\"\n    Range(\"F31:F401\").Select\n    Selection.Copy\n\n\n\n    Sheets(2).Activate\n\n\n    'this is for the raw data\n\n            FirstCell = \"D19\"\n            Range(FirstCell).Select\n            Do Until ActiveCell.Value = \"\"\n            If ActiveCell.Value = \"\" Then\n            Exit Do\n            Else\n            ActiveCell.Offset(1, 0).Select\n            End If\n            Loop\n\n\n    Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n        False, Transpose:=True\n\n   Sheets(3).Activate\n    FirstCell = \"C19\"\n            Range(FirstCell).Select\n            Do Until ActiveCell.Value = \"\"\n            If ActiveCell.Value = \"\" Then\n            Exit Do\n            Else\n            ActiveCell.Offset(1, 0).Select\n            End If\n            Loop\n            ActiveCell = Format(Date, \"mm/dd/yyyy\")\n\n    ws.Activate\n\n    Range(\"D31:D401\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n\n\n    Sheets(3).Activate\n            FirstCell = \"D19\"\n            Range(FirstCell).Select\n            Do Until ActiveCell.Value = \"\"\n            If ActiveCell.Value = \"\" Then\n            Exit Do\n            Else\n            ActiveCell.Offset(1, 0).Select\n            End If\n            Loop\n\n\n    Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n        False, Transpose:=True\n\n        Sheets(4).Activate\n    FirstCell = \"C19\"\n            Range(FirstCell).Select\n            Do Until ActiveCell.Value = \"\"\n            If ActiveCell.Value = \"\" Then\n            Exit Do\n            Else\n            ActiveCell.Offset(1, 0).Select\n            End If\n            Loop\n            ActiveCell = Format(Date, \"mm/dd/yyyy\")\n\n    ws.Activate\n\n    Range(\"G31:G401\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n\n\n\n    Sheets(4).Activate\n    FirstCell = \"D19\"\n            Range(FirstCell).Select\n            Do Until ActiveCell.Value = \"\"\n            If ActiveCell.Value = \"\" Then\n            Exit Do\n            Else\n            ActiveCell.Offset(1, 0).Select\n            End If\n            Loop\n\n\n    Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n        False, Transpose:=True\n\nWorksheets(5).Delete\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 6, "last_activity_date": 1506489392, "creation_date": 1506489392, "answer_id": 46439965, "question_id": 46439799, "link": "https://stackoverflow.com/questions/46439799/getting-compile-error-argument-type-mismatch-error/46439965#46439965", "title": "Getting compile error: argument type mismatch error", "body": "<p>When you define <code>Dim a, b As String</code> it means <strong>only</strong> <code>b As String</code> while <code>a As Variant</code>. You need to define the type explicitly for each variable you define.</p>\n\n<p>Modify your line to: <code>Dim a As String, b As String</code>, and it will work.</p>\n"}], "owner": {"reputation": 27, "user_id": 6920766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef11ef2c1e3bad666ea76937d57ec15b?s=128&d=identicon&r=PG&f=1", "display_name": "Hemz", "link": "https://stackoverflow.com/users/6920766/hemz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 329, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1506489392, "creation_date": 1506488391, "last_edit_date": 1531164843, "question_id": 46439799, "link": "https://stackoverflow.com/questions/46439799/getting-compile-error-argument-type-mismatch-error", "title": "Getting compile error: argument type mismatch error", "body": "<pre><code>Option Explicit\n\nSub data()\n\nDim a, b As String\n\na = \"demo\"\nb = \"text\"    \n\nCall getValue(a, b)\n\nEnd Sub\n\n\nSub getValue(a As String, b As String)    \n\nCells(1, 1).Value = a\nCells(1, 2).Value = b\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>I am getting compile time error: byref argument type mismatch error on above code</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 3003, "user_id": 7644018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yE50W.png?s=128&g=1", "display_name": "Paul T.", "link": "https://stackoverflow.com/users/7644018/paul-t"}, "edited": false, "score": 1, "creation_date": 1506488337, "post_id": 46439459, "comment_id": 79835812, "body": "...and the errors would be? (add them to the bottom of the question)"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1506490363, "post_id": 46439459, "comment_id": 79836487, "body": "I can&#39;t replicate this. A where statement, when you&#39;re storing it in the queries SQL, is limited by the total amount of characters allowed in an SQL statement, 65536 characters. If you&#39;re referring to a table, I think you can go up to a string of 1GB, but I haven&#39;t tried if those work in WHERE statements."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7708075, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e52aa54d73c1b327c829c690be357385?s=128&d=identicon&r=PG&f=1", "display_name": "Yash R.", "link": "https://stackoverflow.com/users/7708075/yash-r"}, "edited": false, "score": 0, "creation_date": 1506505981, "post_id": 46441389, "comment_id": 79845276, "body": "Hi Andre, thanks for the answer. I&#39;ve removed distinct from SQL2, but I&#39;m getting same error."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 13, "user_id": 7708075, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e52aa54d73c1b327c829c690be357385?s=128&d=identicon&r=PG&f=1", "display_name": "Yash R.", "link": "https://stackoverflow.com/users/7708075/yash-r"}, "edited": false, "score": 0, "creation_date": 1506506178, "post_id": 46441389, "comment_id": 79845402, "body": "Please show the final content of <code>SQL2</code> before you open the recordset. (Edit your question and add it there) @YashR."}, {"owner": {"reputation": 13, "user_id": 7708075, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e52aa54d73c1b327c829c690be357385?s=128&d=identicon&r=PG&f=1", "display_name": "Yash R.", "link": "https://stackoverflow.com/users/7708075/yash-r"}, "edited": false, "score": 0, "creation_date": 1506506862, "post_id": 46441389, "comment_id": 79845873, "body": "Hi Andre, when I removed Distinct from SQL2, I got exact value of  MyString. But when I try to execute   Set temprsGenerate = CurrentDb().OpenRecordset(SQL3) it gives error. Is there any limitation of recordset when the fields of table is/are memo?"}, {"owner": {"reputation": 13, "user_id": 7708075, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e52aa54d73c1b327c829c690be357385?s=128&d=identicon&r=PG&f=1", "display_name": "Yash R.", "link": "https://stackoverflow.com/users/7708075/yash-r"}, "edited": false, "score": 0, "creation_date": 1506507813, "post_id": 46441389, "comment_id": 79846499, "body": "The value of SQL3 is:                                                                                                      Select intID from IPDMst where TXTliteral=&#39;PO_EDGE_00503|Device Charge_1|Device Type~Smartphone~Manufacturer~Apple~Model~iPhone 6~Capacity~32 GB~Colour~Space Grey~Blue Tick~FALSE~4GX~TRUE~Splash Proof~FALSE~Removable Battery~FALSE~Expandable Memory~FALSE~HD Video Recording~TRUE~NFC~TRUE~Featured~FALSE~Bonus Gift~FALSE~Operating System~ios~Hot Buy~FALSE~Root Offering~Mobility Offer~&#39;"}, {"owner": {"reputation": 13, "user_id": 7708075, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e52aa54d73c1b327c829c690be357385?s=128&d=identicon&r=PG&f=1", "display_name": "Yash R.", "link": "https://stackoverflow.com/users/7708075/yash-r"}, "edited": false, "score": 0, "creation_date": 1506508695, "post_id": 46441389, "comment_id": 79847037, "body": "when I copy SQL3 and run it in MS Access in Query Design, it gives error. When I reduce the size of string in where clause to 255 characters, it works. I dont know what I&#39;m missing here."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 13, "user_id": 7708075, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e52aa54d73c1b327c829c690be357385?s=128&d=identicon&r=PG&f=1", "display_name": "Yash R.", "link": "https://stackoverflow.com/users/7708075/yash-r"}, "edited": false, "score": 0, "creation_date": 1506510834, "post_id": 46441389, "comment_id": 79848501, "body": "What <b>exact error</b> do you get when you run SQL3 from the query editor? @YashR."}, {"owner": {"reputation": 13, "user_id": 7708075, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e52aa54d73c1b327c829c690be357385?s=128&d=identicon&r=PG&f=1", "display_name": "Yash R.", "link": "https://stackoverflow.com/users/7708075/yash-r"}, "edited": false, "score": 0, "creation_date": 1506518921, "post_id": 46441389, "comment_id": 79853920, "body": "Hi Andre. I&#39;ve updated the question. Please click on the Error Description at the end of the question to view screenshot of the error."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 13, "user_id": 7708075, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e52aa54d73c1b327c829c690be357385?s=128&d=identicon&r=PG&f=1", "display_name": "Yash R.", "link": "https://stackoverflow.com/users/7708075/yash-r"}, "edited": false, "score": 0, "creation_date": 1506520339, "post_id": 46441389, "comment_id": 79855030, "body": "You didn&#39;t mention that the table is linked from SQL Server. -- Try <code>TXTliteral LIKE &#39;&quot; &amp; ...</code> instead of <code>TXTliteral=&#39;&quot; &amp; ...</code> -- Or use a Pass-Through query."}, {"owner": {"reputation": 13, "user_id": 7708075, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e52aa54d73c1b327c829c690be357385?s=128&d=identicon&r=PG&f=1", "display_name": "Yash R.", "link": "https://stackoverflow.com/users/7708075/yash-r"}, "edited": false, "score": 0, "creation_date": 1506572774, "post_id": 46441389, "comment_id": 79876809, "body": "Hi Andre, I regret I forgot to mention that all tables are linked from SQL Server. I tried using LIKE but I got same error. Is something wrong in using recordset?"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 2, "last_activity_date": 1506495560, "creation_date": 1506495560, "answer_id": 46441389, "question_id": 46439459, "link": "https://stackoverflow.com/questions/46439459/field-with-memo-datatype-in-a-recordset/46441389#46441389", "title": "field with memo datatype in a recordset", "body": "<p><code>DISTINCT</code> and Memo fields don't go together.</p>\n\n<p><a href=\"http://allenbrowne.com/ser-63.html\" rel=\"nofollow noreferrer\">http://allenbrowne.com/ser-63.html</a></p>\n\n<blockquote>\n  <p>Access truncates the memo if you ask it to process the data based on the memo: aggregating, de-duplicating, formatting, and so on.</p>\n</blockquote>\n\n<p><strong>Uniqueness</strong>: Since you asked the query to return only distinct values, Access must compare the memo field against all other records. The comparison causes truncation.</p>\n\n<p>Remove DISTINCT from the SELECT SQL.<br>\nYou may need to create another query that selects the distinct values without the memo, and then use it as the source for another query that retrieves the memo without de-duplicating.</p>\n"}], "owner": {"reputation": 13, "user_id": 7708075, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e52aa54d73c1b327c829c690be357385?s=128&d=identicon&r=PG&f=1", "display_name": "Yash R.", "link": "https://stackoverflow.com/users/7708075/yash-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1506520109, "creation_date": 1506486020, "last_edit_date": 1506520109, "question_id": 46439459, "link": "https://stackoverflow.com/questions/46439459/field-with-memo-datatype-in-a-recordset", "title": "field with memo datatype in a recordset", "body": "<p>Is there any specific number of characters in string while use it in where clause?</p>\n\n<pre><code>SQL2 = \"SELECT DISTINCT \" &amp; a &amp; \" AS MyString,\" &amp; b &amp; \" FROM tempExtractedtbl\"\nSet rsGenerate = CurrentDb().OpenRecordset(SQL2)\nDo While Not rsGenerate.EOF\n    SQL3 = \"Select intId from IPDMst where TXTliteral='\" &amp; \n    rsGenerate.Fields(\"MyString\").Value &amp; \"'\"\n\n    Set temprsGenerate = CurrentDb().OpenRecordset(SQL3)\n</code></pre>\n\n<p>Here value of MyString in tempExtractedtbl is:</p>\n\n<pre><code>PO_EDGE_00503|Device Charge_1|Device \nType~Smartphone~Manufacturer~Apple~Model~iPhone 6~Capacity~32 \nGB~Colour~Space Grey~Blue Tick~FALSE~4GX~TRUE~Splash Proof~FALSE~Removable \nBattery~FALSE~Expandable Memory~FALSE~HD Video \nRecording~TRUE~NFC~TRUE~Featured~FALSE~Bonus Gift~FALSE~Operating \nSystem~ios~Hot Buy~FALSE~Root Offering~Mobility Offer~\n</code></pre>\n\n<p>But when its stored in recordset, the value of MyString is trimmed to 255 characters. When i execute </p>\n\n<pre><code>?rsGenerate.Fields(\"MyString\").Value\n</code></pre>\n\n<p>in immediate window, I get MyString as </p>\n\n<pre><code>PO_EDGE_00503|Device Charge_1|Device \nType~Smartphone~Manufacturer~Apple~Model~iPhone 6~Capacity~32 \nGB~Colour~Space Grey~Blue Tick~FALSE~4GX~TRUE~Splash Proof~FALSE~Removable \nBattery~FALSE~Expandable Memory~FALSE~HD Video \nRecording~TRUE~NFC~TRUE~Featured~F\n</code></pre>\n\n<p>And when I execute SQL3 I get following errors as MyString is trimmed.</p>\n\n<p><img src=\"https://i.stack.imgur.com/fGBSi.png\" alt=\"Error Description\"></p>\n\n<p>Is there any limitation of recordset for memo field as MyString is a field having memo datatype. Is there a way out to store string having length more than 255 characters in a recordset and use it?</p>\n"}, {"tags": ["html", "excel", "vba", "web", "automation"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 1, "creation_date": 1506483638, "post_id": 46439041, "comment_id": 79834639, "body": "i do not see any <code>a</code> tags in the html sample you provided.   ... can you post the html with the <code>a</code> tag? ... can you share the URL?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1506485192, "post_id": 46439041, "comment_id": 79834952, "body": "A frame is simlar to the <code>window</code> object - next level is <code>document</code> so you likely need something like:  <code>For Each l2 In theFrame.document.getElementsByTagName(&quot;a&quot;)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 9690512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SSZDp.jpg?s=128&g=1", "display_name": "Tom K", "link": "https://stackoverflow.com/users/9690512/tom-k"}, "is_accepted": false, "score": 1, "last_activity_date": 1525399237, "last_edit_date": 1525399237, "creation_date": 1525390350, "answer_id": 50165116, "question_id": 46439041, "link": "https://stackoverflow.com/questions/46439041/accessing-embedded-html-elements-with-vba-web-automation/50165116#50165116", "title": "Accessing Embedded HTML Elements with VBA Web Automation", "body": "<p>Tim Williams is right, there will be another document embedded in the frame. I was having a similar problem and was able to access the elements I needed using <strong>contentDocument</strong>.</p>\n\n<p>For Example:</p>\n\n<pre><code>TheFrame.contentDocument.getElementsByTagName(\"a\")\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8680085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97614caff10ff375ba3edcbeccd07ce4?s=128&d=identicon&r=PG&f=1", "display_name": "CluelessProgrammer", "link": "https://stackoverflow.com/users/8680085/cluelessprogrammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 745, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525399237, "creation_date": 1506483157, "question_id": 46439041, "link": "https://stackoverflow.com/questions/46439041/accessing-embedded-html-elements-with-vba-web-automation", "title": "Accessing Embedded HTML Elements with VBA Web Automation", "body": "<p>I just picked up VBA a few weeks ago and I'm working on a project that will be able to retrieve info from a web page for me. As is, the task can take me up to 5 hours to complete manually. I'm trying to click a link on a .jsp page, located on an embedded webpage that uses javascript to navigate within the frames, from a VBA script running in excel. Unfortunately the webpage has strict rules about linking from outside sources, but the webpage hierarchy is like this:</p>\n\n<pre><code>&lt;html&gt;\n    &lt;head&gt;&lt;/head&gt;\n    &lt;frameset&gt;\n        &lt;frame name=\"DontCare1\"&gt;&lt;/frame&gt;\n        &lt;frameset&gt;\n            &lt;frame name=\"OtherFrame1\"&gt;&lt;/frame&gt;\n            &lt;frame name=\"FrameName\"&gt;\n               #document&lt;html&gt;&lt;/html&gt; \n               &lt;!--Inspect Page shows that the html is inside the #document tag--&gt;\n            &lt;/frame&gt;\n            &lt;frame name=\"OtherFrame2\"&gt;&lt;/frame&gt;\n        &lt;/frameset&gt;\n        &lt;frame name=\"DontCare2\"&gt;&lt;/frame&gt;\n    &lt;/frameset&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>Now, I know my code is setup to correctly manipulate web pages because before getting to this point it accesses a standard  page and can log the user in by entering their info and clicking submit so I'm fairly certain all my libraries and references are in order.</p>\n\n<p>I've got a poor method to get the deepest frame as shown here:</p>\n\n<pre><code>Dim theFrame As HTMLIFrame\nDim l2 As Variant, l3 As Variant, l4 As Variant\nFor Each l2 In .Document.getElementsByTagName(\"frameset\")\n            For Each l3 In l2.getElementsByTagName(\"frameset\")\n                For Each l4 In l3.getElementsByTagName(\"frame\")\n                    If l4.Name = \"FrameName\" Then\n                        Set theFrame = l4 ' Find HTML page in this frame\n                    End If\n                Next l4\n            Next l3\n        Next l2\n</code></pre>\n\n<p>I have verified that it is setting theFrame to the correct frame. Now I thought that something like:</p>\n\n<pre><code>For Each l2 In theFrame.getElementsByTagName(\"a\")\n            If l2.href=\"LinkIWantToClick\" Then\n                l2.Click\n                Exit For\n            End If\n        Next l2\n</code></pre>\n\n<p>Would work but theFrame.getElementsByTagName(\"a\") returns an empty collection or occasionally throws runtime errors 91 or 438. I've searched just about every combination I can think of that may have a solution I could adapt to use but no such luck so far.</p>\n\n<p>I've got more functionality to build into this after getting the link clicked, but I think after I know how to access that link I should be good to access anything else located on these pages. Still new to this language and don't necessarily know what I'm doing yet, hopefully I didn't miss an obvious mistake, so any advice you could give would be helpful.</p>\n"}]