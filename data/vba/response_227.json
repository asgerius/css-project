[{"tags": ["sql", "vba", "ms-word"], "comments": [{"owner": {"reputation": 738, "user_id": 11218205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea0f36074b704f686940881088809458?s=128&d=identicon&r=PG&f=1", "display_name": "Dr Phil", "link": "https://stackoverflow.com/users/11218205/dr-phil"}, "edited": false, "score": 1, "creation_date": 1557964896, "post_id": 56158972, "comment_id": 98946741, "body": "Most likely you have a whitespoace difference or none printable characters. What is your source database? Can you run the query there?"}, {"owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 2, "creation_date": 1557966637, "post_id": 56158972, "comment_id": 98947036, "body": "Edit your question and show some sample results with duplicates."}], "answers": [{"tags": [], "owner": {"reputation": 574, "user_id": 10270827, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Zg20K6ddUR8/AAAAAAAAAAI/AAAAAAAAACM/5CYLYoCCjlI/photo.jpg?sz=128", "display_name": "Sean Brookins", "link": "https://stackoverflow.com/users/10270827/sean-brookins"}, "is_accepted": false, "score": 0, "last_activity_date": 1557976803, "creation_date": 1557976803, "answer_id": 56160330, "question_id": 56158972, "link": "https://stackoverflow.com/questions/56158972/query-with-distinct-returning-duplicate-results/56160330#56160330", "title": "Query with DISTINCT returning duplicate results", "body": "<p>You likely have duplicate rows being returned. You might be able to use a CTE. Example:</p>\n\n<pre><code>;WITH catCTE([ecatalogue_key], \n            [LocHolderName], \n            [EADUnitTitle])\n     AS (SELECT DISTINCT \n                [Ecatalogue_key], \n                [LOCHOLDERNAME], \n                [EADUNITTITLE]\n         FROM   [ecatalog].[csv]),\n     eadCTE([NamFullName])\n     AS (SELECT DISTINCT \n                [ecatalogue_key], \n                [namfullname]\n         FROM   [EADOrigi].[csv])\n     SELECT [o].[NamFullName], \n            [e].[LocHolderName], \n            [e].[EADUnitTitle]\n     FROM   [catCTE] AS [e]\n            JOIN [eadCTE] AS [o] ON [e].[ecatalogue_key] = [o].[ecatalogue_key];\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19, "user_id": 11506813, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wdQp66u8RkM/AAAAAAAAAAI/AAAAAAAAAF4/9rLkN_mOFzs/photo.jpg?sz=128", "display_name": "Lachlan Glanville", "link": "https://stackoverflow.com/users/11506813/lachlan-glanville"}, "is_accepted": false, "score": 0, "last_activity_date": 1557984193, "creation_date": 1557984193, "answer_id": 56161360, "question_id": 56158972, "link": "https://stackoverflow.com/questions/56158972/query-with-distinct-returning-duplicate-results/56161360#56161360", "title": "Query with DISTINCT returning duplicate results", "body": "<p>Strangely enough, this seems to have resolved itself and is returning exactly what it should be. I suspect it has more to do with Word and VBA than SQL. Apologies to those who spent time responding.</p>\n"}], "owner": {"reputation": 19, "user_id": 11506813, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wdQp66u8RkM/AAAAAAAAAAI/AAAAAAAAAF4/9rLkN_mOFzs/photo.jpg?sz=128", "display_name": "Lachlan Glanville", "link": "https://stackoverflow.com/users/11506813/lachlan-glanville"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1557984193, "creation_date": 1557963643, "last_edit_date": 1557981350, "question_id": 56158972, "link": "https://stackoverflow.com/questions/56158972/query-with-distinct-returning-duplicate-results", "title": "Query with DISTINCT returning duplicate results", "body": "<p>I'm attempting to create a label merge in Word using VBA to pull the data via ODBC. However, despite using DISTINCT, I'm getting duplicate values (thus duplicate labels). All fields selected need to be unique, I'm not trying to filter on a single field. I'm pretty green with SQL, what have I missed here? If I open the recipient list in Word, it tells me there are duplicates.</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT DISTINCT o.NamFullName, e.LocHolderName, e.EADUnitTitle \nFROM ecatalog.csv AS e \nINNER JOIN EADOrigi.csv AS o ON e.ecatalogue_key = o.ecatalogue_key\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1557987087, "post_id": 56158017, "comment_id": 98951377, "body": "You might benefit from reading  <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11506468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3157337e3f53650a4ff6cbce38cb74e0?s=128&d=identicon&r=PG&f=1", "display_name": "chase_work85", "link": "https://stackoverflow.com/users/11506468/chase-work85"}, "edited": false, "score": 0, "creation_date": 1557958668, "post_id": 56158115, "comment_id": 98945509, "body": "Awesome, thank you very much.  I made a few small changes.  I was wondering though, when it copies the value from the one worksheet and pastes into the other, is there a way to paste just the value and not overwrite the formula thats in the cell?"}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "reply_to_user": {"reputation": 11, "user_id": 11506468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3157337e3f53650a4ff6cbce38cb74e0?s=128&d=identicon&r=PG&f=1", "display_name": "chase_work85", "link": "https://stackoverflow.com/users/11506468/chase-work85"}, "edited": false, "score": 0, "creation_date": 1557958968, "post_id": 56158115, "comment_id": 98945584, "body": "@chase_work85 how would you paste a value and NOT overwrite the formula? A value would eliminate any formula currently in the cell?"}, {"owner": {"reputation": 11, "user_id": 11506468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3157337e3f53650a4ff6cbce38cb74e0?s=128&d=identicon&r=PG&f=1", "display_name": "chase_work85", "link": "https://stackoverflow.com/users/11506468/chase-work85"}, "edited": false, "score": 0, "creation_date": 1557961814, "post_id": 56158115, "comment_id": 98946173, "body": "I apologize I didnt explain correctly in my previous post, I have the number stored as text by adding a leading apostrophe, is there way that when it pastes the value it can paste it as a number stored as text?"}, {"owner": {"reputation": 11, "user_id": 11506468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3157337e3f53650a4ff6cbce38cb74e0?s=128&d=identicon&r=PG&f=1", "display_name": "chase_work85", "link": "https://stackoverflow.com/users/11506468/chase-work85"}, "edited": false, "score": 0, "creation_date": 1557965343, "post_id": 56158115, "comment_id": 98946811, "body": "Thank you everybody!! So everything seems to be working now except once the macro goes through one iteration it doesn&#39;t advance down to the second cell in the c1:c range (c2, then c3, then c4, etc) . It just goes back to c1 and displays that value again over and over"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1557967474, "post_id": 56158115, "comment_id": 98947141, "body": "I assumed you were going to add code to print out each sheet, and then run the complete loop.  Is that not what you&#39;re doing - you just want that each time you run this the next row gets chosen?"}, {"owner": {"reputation": 11, "user_id": 11506468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3157337e3f53650a4ff6cbce38cb74e0?s=128&d=identicon&r=PG&f=1", "display_name": "chase_work85", "link": "https://stackoverflow.com/users/11506468/chase-work85"}, "edited": false, "score": 0, "creation_date": 1557975837, "post_id": 56158115, "comment_id": 98948522, "body": "Thank you for your help Tim. I wasnt able to paste the full code earlier.  Here&#39;s what I have.  <a href=\"https://pastebin.com/bxge2XVC\" rel=\"nofollow noreferrer\">pastebin.com/bxge2XVC</a>  same as above with exception of  transposing the source and destination worksheet and added the print code."}, {"owner": {"reputation": 11, "user_id": 11506468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3157337e3f53650a4ff6cbce38cb74e0?s=128&d=identicon&r=PG&f=1", "display_name": "chase_work85", "link": "https://stackoverflow.com/users/11506468/chase-work85"}, "edited": false, "score": 0, "creation_date": 1557976679, "post_id": 56158115, "comment_id": 98948684, "body": "So I just changed the cells(.rows.count,3) to cells(.rows.count,4) and for whatever reason its cycling through correct, when it was three it would hit c2 and then go back to c1.  not sure why"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1557977303, "post_id": 56158115, "comment_id": 98948791, "body": "That&#39;s odd - it should have gone up to the last-occupied cell in ColC..."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1557967639, "last_edit_date": 1557967639, "creation_date": 1557957103, "answer_id": 56158115, "question_id": 56158017, "link": "https://stackoverflow.com/questions/56158017/loop-through-column-and-copy-paste-each-value-to-another-workbook/56158115#56158115", "title": "Loop through column and copy/paste each value to another workbook", "body": "<p>Untested:</p>\n\n<pre><code>Sub Macro4()\n\n    Dim c As Range, rng As Range\n\n    'get the range to loop over\n    with Sheets(\"COIN TESTING\")\n        Set rng = .Range(\"C1:C\" &amp; .cells(.rows.count,3).end(xlUp).Row)\n    end with\n\n    'process each cell in turn\n    For each c in rng.cells\n\n        'is there a value to transfer?\n        If Len(c.value) &gt; 0 then\n            'directly assign the value - no need for copy/paste\n            Sheets(\"TESTING\").Range(\"J2\").Value = c.value\n\n            'calculate and print out sheet\n            Sheets(\"TESTING\").UsedRange.Calculate 'refresh formulas\n            Sheets(\"TESTING\").PrintOut\n\n        End if\n\n    Next c\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11506468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3157337e3f53650a4ff6cbce38cb74e0?s=128&d=identicon&r=PG&f=1", "display_name": "chase_work85", "link": "https://stackoverflow.com/users/11506468/chase-work85"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557987068, "creation_date": 1557956526, "last_edit_date": 1557987068, "question_id": 56158017, "link": "https://stackoverflow.com/questions/56158017/loop-through-column-and-copy-paste-each-value-to-another-workbook", "title": "Loop through column and copy/paste each value to another workbook", "body": "<p>I have to create a macro for work in excel and getting lost and was wondering if yall could assist. </p>\n\n<p>So I have two workbooks. The first workbook (TEST) has a form that I need to print, the second workbook (Coin Test) has raw data. I have a cell in the form workbook where if I paste an item number from the raw data workbook it'll automatically pull all of the item information from the raw data sheet via a formula and fill in the form (Item Number, Item specifications, Item price, etc). </p>\n\n<p>So what I need to do is automate going to the raw data sheet, copying the first item number from C1 and then go to the form workbook and pasting that item number into the cell J2 where it'll automatically fill out the form and then print that form and then go back to the raw data workbook and go down to the next item number and rinse and repeat. I was trying to piece together codes together, here is my monster so far. Thank you all for any assistance</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Macro4()\n\n'Macro4 Macro\n\n  Sheets(\"TESTING\").Select\n  Selection.Copy\n\n  Sheets(\"COIN TESTING\").Select\n  ActiveSheet.Paste\n\n  For Each Cell In Range(\"C$:C$\")\n\n    If Cell.Value = vbNullString Then Exit For\n\n    Range(\"C$:C$\").Value = Cell.Value\n    Cell.Offset(1, 0).Value = Range(\"J2\").Value\n\n  Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1557956045, "post_id": 56157810, "comment_id": 98944797, "body": "What is the actual problem you&#39;re having?"}, {"owner": {"reputation": 1681, "user_id": 8309643, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GKYcGO_qCIE/AAAAAAAAAAI/AAAAAAAAB8o/PJdqYRCGzdU/photo.jpg?sz=128", "display_name": "Robert Todar", "link": "https://stackoverflow.com/users/8309643/robert-todar"}, "edited": false, "score": 0, "creation_date": 1557956758, "post_id": 56157810, "comment_id": 98945000, "body": "Your code is missing <code>End If</code> as well as <code>Next y</code>. Not sure if that is the issue you are dealing with?"}, {"owner": {"reputation": 25, "user_id": 11346855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/699099831fa6738d9a24120949a22131?s=128&d=identicon&r=PG&f=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/11346855/dev"}, "edited": false, "score": 0, "creation_date": 1557956767, "post_id": 56157810, "comment_id": 98945003, "body": "If the cell value in the  column of the excel sheet does not change when going downward then the code do nothing . In other words the value that has already been selected in the ajax element of web form do not change. However when the cell value in the column of the excel sheet change the above code should change the ajax element of the web form  according to the cell value."}, {"owner": {"reputation": 25, "user_id": 11346855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/699099831fa6738d9a24120949a22131?s=128&d=identicon&r=PG&f=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/11346855/dev"}, "edited": false, "score": 0, "creation_date": 1557956869, "post_id": 56157810, "comment_id": 98945034, "body": "I am very new to programming so it could be the issue."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1557957344, "post_id": 56157810, "comment_id": 98945168, "body": "What works/doesn&#39;t work? Do you get error messages - if Yes what are they and on which line?  It&#39;s not really clear exactly what you&#39;re doing in this process."}], "answers": [{"tags": [], "owner": {"reputation": 278, "user_id": 10122801, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--6lbnJnd-xQ/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oYuHOsALAxSc_52z-07zYikmrLuQ/mo/photo.jpg?sz=128", "display_name": "Havard Kleven", "link": "https://stackoverflow.com/users/10122801/havard-kleven"}, "is_accepted": false, "score": 0, "last_activity_date": 1557958308, "last_edit_date": 1557958308, "creation_date": 1557956881, "answer_id": 56158077, "question_id": 56157810, "link": "https://stackoverflow.com/questions/56157810/do-conditional-loop/56158077#56158077", "title": "Do conditional loop", "body": "<p>I believe something like this implemented in your code could work:</p>\n\n<pre><code>Function 123abc() \n\nDim i, j as string\n\ni = ThisWorkbook.Sheets(\"sheet3\").Range(\"ax\" &amp; y - 1).Value\nj = ThisWorkbook.Sheets(\"sheet3\").Range(\"ax\" &amp; y ).Value)\n\nIF i &lt;&gt; j THEN\n\n   'Do something\n\nEnd if\n\nEnd function\n</code></pre>\n\n<p>For instance at cell AX where y is 53:</p>\n\n<pre><code>If    AX52 &lt;&gt; AX53 THEN    'true\n           'something will happen\nEnd if\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 11346855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/699099831fa6738d9a24120949a22131?s=128&d=identicon&r=PG&f=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/11346855/dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1557988381, "creation_date": 1557955378, "last_edit_date": 1557988381, "question_id": 56157810, "link": "https://stackoverflow.com/questions/56157810/do-conditional-loop", "title": "Do conditional loop", "body": "<p>I am working on a column of data which is changing as it goes downward. When the value of the cell below changes, my code should do some command; if it does not change then it should do nothing.</p>\n\n<p>My codes run as follows</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>For y = 51 To 60\n\n  if ThisWorkbook.Sheets(\"sheet3\").Range(\"ax\" &amp; y).Value = _\n    ThisWorkbook.Sheets(\"sheet3\").Range(\"ax\" &amp; y - 1).Value then\n\n    With .document\n      .getElementById(\"ctl00_ContentPlaceHolder1_ddlCluster\").Focus\n      .getElementById(\"ctl00_ContentPlaceHolder1_ddlCluster\").selectedIndex = _\n                    ThisWorkbook.Sheets(\"sheet3\").Range(\"ax\" &amp; y).Value\n      .getElementById(\"ctl00_ContentPlaceHolder1_ddlCluster\").FireEvent \"onchange\"\n\n      Application.Wait Now + TimeSerial(0, 0, 3)\n    end with\n</code></pre>\n"}, {"tags": ["vba", "userform", "excel-2016"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1557955063, "post_id": 56157731, "comment_id": 98944475, "body": "See the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.thisworkbook\" rel=\"nofollow noreferrer\"><code>ThisWorkbook</code></a> documentation. It doesn&#39;t represent a <code>Sheet</code>, but a <code>Workbook</code>."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1558039397, "post_id": 56157731, "comment_id": 98979211, "body": "Now that you have shown us the full picture, it looks like your file is corrupt.   I suggest you rebuild it."}, {"owner": {"reputation": 75, "user_id": 8059760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N9i6n.jpg?s=128&g=1", "display_name": "Bar-Tzur", "link": "https://stackoverflow.com/users/8059760/bar-tzur"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1558107804, "post_id": 56157731, "comment_id": 99004384, "body": "@chris Thanks for pointing me to this resource. This may be the reason for the sheet52 and I&#39;m grateful to have a clearer understanding of the problem however, this does not resolve the issue I encountered. I tried both rebuilding the file and saving it as a binary worksheet but the sheet count is still off, now missing sheet 54. Both of these result in the same problem; I need to retrieve the number of worksheets but am still getting the sheet count-1. How to do that is the question that I need answered."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1558133771, "post_id": 56157731, "comment_id": 99013386, "body": "@baz the point is that once you have fixed the corruption, <code>Worksheets.Count</code> <i>will</i> give you the correct value."}, {"owner": {"reputation": 75, "user_id": 8059760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N9i6n.jpg?s=128&g=1", "display_name": "Bar-Tzur", "link": "https://stackoverflow.com/users/8059760/bar-tzur"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1558356620, "post_id": 56157731, "comment_id": 99063100, "body": "@chris That was part of the issue but I was still having a problem with the sheet codenames. Once I transferred all sheets to a new workbook, and saved it as a binary workbook just to be safe, I still had to use <code>ThisWorkbook.VBProject.VBComponents(&quot;Sheet1&quot;).Name = &quot;NewCodeName&quot;</code> with a <code>for</code> loop to rename each sheet between 54 and the last sheet in the workbook ."}], "answers": [{"comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1557959255, "post_id": 56157805, "comment_id": 98945658, "body": "OP says <i>worksheets in the active workbook</i> which may or may not be <code>ThisWorkbook</code>"}, {"owner": {"reputation": 278, "user_id": 10122801, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--6lbnJnd-xQ/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oYuHOsALAxSc_52z-07zYikmrLuQ/mo/photo.jpg?sz=128", "display_name": "Havard Kleven", "link": "https://stackoverflow.com/users/10122801/havard-kleven"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1557959646, "post_id": 56157805, "comment_id": 98945737, "body": "Thanks for the pointer - edited code to fit OP."}, {"owner": {"reputation": 75, "user_id": 8059760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N9i6n.jpg?s=128&g=1", "display_name": "Bar-Tzur", "link": "https://stackoverflow.com/users/8059760/bar-tzur"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1558010535, "post_id": 56157805, "comment_id": 98964144, "body": "@chris Thank you for highlighting this important distinction. However, in this case they are the same."}, {"owner": {"reputation": 75, "user_id": 8059760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N9i6n.jpg?s=128&g=1", "display_name": "Bar-Tzur", "link": "https://stackoverflow.com/users/8059760/bar-tzur"}, "edited": false, "score": 0, "creation_date": 1558010681, "post_id": 56157805, "comment_id": 98964232, "body": "@Harvard Thank you for your input but neither <code>ThisWorkbook</code> nor <code>ActiveWorkbook</code> have changed the output. I&#39;ll edit my question to show what I mean and to add additional information."}], "tags": [], "owner": {"reputation": 278, "user_id": 10122801, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--6lbnJnd-xQ/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oYuHOsALAxSc_52z-07zYikmrLuQ/mo/photo.jpg?sz=128", "display_name": "Havard Kleven", "link": "https://stackoverflow.com/users/10122801/havard-kleven"}, "is_accepted": false, "score": 0, "last_activity_date": 1557959610, "last_edit_date": 1557959610, "creation_date": 1557955337, "answer_id": 56157805, "question_id": 56157731, "link": "https://stackoverflow.com/questions/56157731/application-sheets-count-returns-a-value-off-by-1/56157805#56157805", "title": "Application.Sheets.count returns a value off by 1", "body": "<p>As @BigBen mentions, look further into the documentation on <code>ThisWorkbook</code>.</p>\n\n<p>Modified code should work out:</p>\n\n<pre><code>Private Sub UserForm_Initialize() \n\n   Dim wsCnt As Long \n   wsCnt = ActiveWorkbook.Worksheets.Count\n\n   MsgBox wsCnt\n\nEnd sub\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 8059760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N9i6n.jpg?s=128&g=1", "display_name": "Bar-Tzur", "link": "https://stackoverflow.com/users/8059760/bar-tzur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 190, "favorite_count": 0, "closed_date": 1558039651, "answer_count": 1, "score": 1, "last_activity_date": 1558124359, "creation_date": 1557954952, "last_edit_date": 1558124359, "question_id": 56157731, "link": "https://stackoverflow.com/questions/56157731/application-sheets-count-returns-a-value-off-by-1", "closed_reason": "Duplicate", "title": "Application.Sheets.count returns a value off by 1", "body": "<p>I am trying to get a count of worksheets in the active workbook. When I run <code>Application.Sheets.Count</code> the value I get is one off from what I expected I should be getting 76 and I get 75. In the project explorer I found a strange sheet labeled ThisWorkbook (See Sheet 52 in the image below). I would really like to understand this behavior as it has an impact on my later work. Any insight would be greatly appreciated.</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    Dim wsCnt As Long \n    wsCnt = Application.Sheets.Count\n    MsgBox wsCnt\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Keq0d.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Keq0d.png\" alt=\"enter image description here\"></a></p>\n\n<p>Edit: In light of some of the contributions below, I offer the following to further clarify what I'm seeing and to provide greater insight into why it is important within this context.</p>\n\n<p>The above image is now a more complete picture of what I'm seeing. Note that <code>ThisWorkbook</code> is at the bottom of the Project Explorer window. For some reason however, sheet 52 is also called <code>ThisWorkbook</code>. </p>\n\n<p>This is contextually important because this value is later used to increment through all created sheets, the number of which will change over time. Since <code>Sheet52</code> increments the sheet count but not the number of sheets, I'm coming up short by one. I could conceivably introduce a workaround by just adding one, then checking to ensure that the sheet value is not equal to 52 on each iteration of the loop but in addition to being an inelegant approach this may also cause issues in the future if the anomaly crops up again. I would really like to understand this behavior. I haven't found anything in the documentation to indicate that this sheet needs to be created and I haven't seen a <code>ThisWorkbook</code> sheet being created before like the case of Sheet52 nor can I fathom any reason why it would need to be created. I defer to the collective wisdom of the community.</p>\n\n<p>Edit 2: Concerning the duplicate question</p>\n\n<p>The suggestion that this question is a duplicate emanates from my curiosity as to what was happening to generate <code>Sheet52</code>. The question however, pertains to getting the wrong sheet count, which is not addressed in <a href=\"https://stackoverflow.com/questions/18273071/excel-vba-project-has-generated-multiple-workbook-objects\">that post</a>. This information was instructive in some regards and did ultimately get me closer to the answer.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1557954135, "post_id": 56157542, "comment_id": 98944137, "body": "There&#39;s no <code>DateTime</code> library in C# either; <code>DateTime</code> is a <code>struct</code> defined in the <code>System</code> namespace. In VBA you have the <code>VBA.DateTime</code> module, exposing a number of functions including <code>Date</code>, <code>DateAdd</code>, <code>DateDiff</code>, <code>DateValue</code>, <code>TimeValue</code>, <code>TimeSerial</code>, and several others. Hit F2 in the VBE to bring up the <a href=\"https://stackoverflow.com/a/56122859/1188513\">Object Browser</a> and dig everything you need."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1557954261, "post_id": 56157542, "comment_id": 98944180, "body": "That said, not sure what that function is trying to achieve with <code>Ticks</code>."}, {"owner": {"reputation": 19, "user_id": 5329503, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ad9396339b1280f797fd74b858e493df?s=128&d=identicon&r=PG&f=1", "display_name": "Michal", "link": "https://stackoverflow.com/users/5329503/michal"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1557955617, "post_id": 56157542, "comment_id": 98944651, "body": "example, HourIndex=<code>3230</code> returns <code>15-05-2015@14:00</code>. I can not get <code>TimeSpan</code> in VBA"}, {"owner": {"reputation": 19, "user_id": 5329503, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ad9396339b1280f797fd74b858e493df?s=128&d=identicon&r=PG&f=1", "display_name": "Michal", "link": "https://stackoverflow.com/users/5329503/michal"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1557957149, "post_id": 56157542, "comment_id": 98945112, "body": "I come manage to get answer I want to post to help other but seems my account will be blocked from answering ... ? what is going on here.... does it mean is better not share if I come across answer?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1557957461, "post_id": 56157542, "comment_id": 98945193, "body": "You&#39;re not blocked from answering, SO is just prompting whether you really mean to answer your own question. Possible that there&#39;s a wait period though."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1557957641, "post_id": 56157542, "comment_id": 98945246, "body": "From what I gather you want to get the date for 2015-01-01 (trivial), then divide HourIndex by 24 and add that, then add the remainder. I still don&#39;t see why you would need to get ticks involved in the C# solution though."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 5329503, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ad9396339b1280f797fd74b858e493df?s=128&d=identicon&r=PG&f=1", "display_name": "Michal", "link": "https://stackoverflow.com/users/5329503/michal"}, "edited": false, "score": 0, "creation_date": 1557954855, "post_id": 56157649, "comment_id": 98944389, "body": "I am trying using standard 2015 year transform hour from simulation to Date for easier identification and results interpretations. Thanks for your solution but this is not what I am looking for."}, {"owner": {"reputation": 278, "user_id": 10122801, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--6lbnJnd-xQ/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oYuHOsALAxSc_52z-07zYikmrLuQ/mo/photo.jpg?sz=128", "display_name": "Havard Kleven", "link": "https://stackoverflow.com/users/10122801/havard-kleven"}, "reply_to_user": {"reputation": 19, "user_id": 5329503, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ad9396339b1280f797fd74b858e493df?s=128&d=identicon&r=PG&f=1", "display_name": "Michal", "link": "https://stackoverflow.com/users/5329503/michal"}, "edited": false, "score": 0, "creation_date": 1557954977, "post_id": 56157649, "comment_id": 98944434, "body": "I see, I&#39;m not too familiar with that method unfortunately."}], "tags": [], "owner": {"reputation": 278, "user_id": 10122801, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--6lbnJnd-xQ/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oYuHOsALAxSc_52z-07zYikmrLuQ/mo/photo.jpg?sz=128", "display_name": "Havard Kleven", "link": "https://stackoverflow.com/users/10122801/havard-kleven"}, "is_accepted": false, "score": 0, "last_activity_date": 1557954499, "creation_date": 1557954499, "answer_id": 56157649, "question_id": 56157542, "link": "https://stackoverflow.com/questions/56157542/how-to-calculated-date-from-absolute-hour/56157649#56157649", "title": "How to calculated Date from absolute hour?", "body": "<p>What are your expected result? The current time and date?</p>\n\n<p>If so you may simply use</p>\n\n<pre><code>Now()\n</code></pre>\n\n<p>This returns dd.mm.yyyy hh:mm from your system date/time. </p>\n\n<p>Include it in another statement, for instance</p>\n\n<pre><code>    Dim rng, rng2 as range\n    Set rng = ActiveSheet.Range(\"A1\")\n    Set rng2 = ActiveSheet.Range(\"A2\")\n    rng = Now()\n</code></pre>\n\n<p>To get the hours here, a simple variant could be</p>\n\n<pre><code>     rng2 = Right(rng, 5)\n</code></pre>\n\n<p>There is of course other ways without writing to sheet, try storing in a variable for example. However this illustrates the point.. Handling the date as a string let's you edit it with left/right functions etc. </p>\n"}], "owner": {"reputation": 19, "user_id": 5329503, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ad9396339b1280f797fd74b858e493df?s=128&d=identicon&r=PG&f=1", "display_name": "Michal", "link": "https://stackoverflow.com/users/5329503/michal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1557954893, "creation_date": 1557953900, "last_edit_date": 1557954893, "question_id": 56157542, "link": "https://stackoverflow.com/questions/56157542/how-to-calculated-date-from-absolute-hour", "title": "How to calculated Date from absolute hour?", "body": "<p>How to calculate absolute hour in VBA excel. I have c# code just need help transforming into VBA Excel. I am missing DateTime library in VBA.\nI am trying using standard 2015 year transform absolute hour[1-8760] from simulation hour to Date for easier identification and results interpretations.</p>\n\n<pre><code>public static string FromHourToDateString(int HourIndex)\n{\n   DateTime aDateTime = new DateTime(TimeSpan.FromHours(HourIndex).Ticks + new DateTime(2015, 1, 1).Ticks);\n   return aDateTime.ToString(\"dd-MM-yyyy@HH:mm\");\n}\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "ms-access-reports"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11506352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de47fcf46b6e9f4c72478dc334d6cb97?s=128&d=identicon&r=PG&f=1", "display_name": "Jake22305", "link": "https://stackoverflow.com/users/11506352/jake22305"}, "edited": false, "score": 0, "creation_date": 1558003991, "post_id": 56157490, "comment_id": 98960359, "body": "Thanks Tim, I&#39;ll give that a try"}, {"owner": {"reputation": 11, "user_id": 11506352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de47fcf46b6e9f4c72478dc334d6cb97?s=128&d=identicon&r=PG&f=1", "display_name": "Jake22305", "link": "https://stackoverflow.com/users/11506352/jake22305"}, "edited": false, "score": 0, "creation_date": 1558004341, "post_id": 56157490, "comment_id": 98960575, "body": "I&quot;ve added the code and get the following error: Run-time error &#39;3265&#39; Item not found in this collection. When I open the code this is whats getting the error: temp = rs(&quot;EENo&quot; &amp; &quot;Employee Name&quot;)"}, {"owner": {"reputation": 11, "user_id": 11506352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de47fcf46b6e9f4c72478dc334d6cb97?s=128&d=identicon&r=PG&f=1", "display_name": "Jake22305", "link": "https://stackoverflow.com/users/11506352/jake22305"}, "edited": false, "score": 0, "creation_date": 1558038682, "post_id": 56157490, "comment_id": 98978896, "body": "I&#39;ve tried the above update (temp = rs(&quot;EENo&quot;).Value &amp; rs(&quot;Employee Name&quot;).Value) and get the error &quot;Item not found in this collection&quot;. It must be something that i&#39;m missing..."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 11, "user_id": 11506352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de47fcf46b6e9f4c72478dc334d6cb97?s=128&d=identicon&r=PG&f=1", "display_name": "Jake22305", "link": "https://stackoverflow.com/users/11506352/jake22305"}, "edited": false, "score": 0, "creation_date": 1558041212, "post_id": 56157490, "comment_id": 98979887, "body": "Edited again after actually looking at your SQL  You&#39;re only returning a single column in your query results."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1558041181, "last_edit_date": 1558041181, "creation_date": 1557953689, "answer_id": 56157490, "question_id": 56157386, "link": "https://stackoverflow.com/questions/56157386/saving-access-report-with-distinct-name/56157490#56157490", "title": "Saving Access Report with Distinct Name", "body": "<p>This should work:</p>\n\n<pre><code>temp = rs(\"EENo\").Value &amp; rs(\"Employee Name\").Value\nMyFileName = \"Statement_\" &amp; rs(\"Employee Name\").Value &amp; \"_\" &amp; _\n              Format(rs(\"EENo\").Value, \"000000\") &amp; \".PDF\"\n</code></pre>\n\n<p>EDIT: I had not really looked at your SQL, and missed that you're combining the two columns in your query.  I don't use access but try:</p>\n\n<pre><code>Set rs = db.OpenRecordset(\"SELECT distinct [EENo] , [Employee Name] FROM [Query]\", _\n                           dbOpenSnapshot)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11506352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de47fcf46b6e9f4c72478dc334d6cb97?s=128&d=identicon&r=PG&f=1", "display_name": "Jake22305", "link": "https://stackoverflow.com/users/11506352/jake22305"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1594779302, "creation_date": 1557953169, "last_edit_date": 1594779302, "question_id": 56157386, "link": "https://stackoverflow.com/questions/56157386/saving-access-report-with-distinct-name", "title": "Saving Access Report with Distinct Name", "body": "<p>I'm trying to save each individual employees statement using Access Reports. However I'm having issues with getting the <code>Employee Name</code> field to append to the <code>MyFileName</code> variable.</p>\n\n<p>I'm able to export the individual employee reports as a PDF with the following format: </p>\n\n<pre><code>Statement_[EENo].pdf\n</code></pre>\n\n<p>However, I would like to have this to include the employee name in the following format: </p>\n\n<pre><code>Statement_[Employee Name]_[EENo].pdf\n</code></pre>\n\n<pre><code>Private Sub Command2_Click()\n    Dim db As DAO.Database\n    Dim rs As DAO.Recordset\n    Dim MyFileName As String\n    Dim mypath As String\n    Dim temp As String\n\n    mypath = \"FILE LOCATION\"\n\n    Set db = CurrentDb()\n\n    Set rs = db.OpenRecordset(\"SELECT distinct [EENo] &amp; [Employee Name] FROM [Query]\", dbOpenSnapshot)\n\n    rs.MoveFirst\n    Do While Not rs.EOF\n        temp = rs(\"EENo\" &amp; \"Employee Name\")\n        MyFileName = \"Statement\" &amp; \"_\" &amp; [Employee Name] &amp; \"_\" &amp; Format(rs(\"EENo\"), \"000000\") &amp; \".PDF\"\n\n        DoCmd.OpenQuery \"1 - Query: Firm Admin_EE\"\n        DoCmd.Close acQuery, \"1 - Query: Firm Admin_EE\", acSaveYes\n        DoCmd.OpenReport \"REPORT\", acViewReport, , \"[EENo]=\" &amp; temp\n        DoCmd.OutputTo acOutputReport, \"\", acFormatPDF, mypath &amp; MyFileName\n        DoCmd.Close acReport, \"REPORT\"\n        DoEvents\n\n        rs.MoveNext\n    Loop\n\n    rs.Close\n    Set rs = Nothing\n    Set db = Nothing\nEnd Sub \n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11204121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de624ca2c6b2d4a1cdcbfb7e1bb272e8?s=128&d=identicon&r=PG&f=1", "display_name": "JuiceBoxKing", "link": "https://stackoverflow.com/users/11204121/juiceboxking"}, "edited": false, "score": 0, "creation_date": 1557955743, "post_id": 56157719, "comment_id": 98944695, "body": "I don&#39;t entirely know if this works how I need it to, I did update my post with more information as I realized that I didn&#39;t explain what it was I am doing with that data.   Maybe that helps?"}, {"owner": {"reputation": 587, "user_id": 11481315, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rZK97.png?s=128&g=1", "display_name": "viilpe", "link": "https://stackoverflow.com/users/11481315/viilpe"}, "reply_to_user": {"reputation": 3, "user_id": 11204121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de624ca2c6b2d4a1cdcbfb7e1bb272e8?s=128&d=identicon&r=PG&f=1", "display_name": "JuiceBoxKing", "link": "https://stackoverflow.com/users/11204121/juiceboxking"}, "edited": false, "score": 0, "creation_date": 1557956523, "post_id": 56157719, "comment_id": 98944947, "body": "You don&#39;t need GetObject to just get value of <b>A1</b> cell. I updated my answer."}], "tags": [], "owner": {"reputation": 587, "user_id": 11481315, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rZK97.png?s=128&g=1", "display_name": "viilpe", "link": "https://stackoverflow.com/users/11481315/viilpe"}, "is_accepted": true, "score": 0, "last_activity_date": 1557956471, "last_edit_date": 1557956471, "creation_date": 1557954893, "answer_id": 56157719, "question_id": 56157317, "link": "https://stackoverflow.com/questions/56157317/can-getobject-do-this/56157719#56157719", "title": "Can GetObject do this?", "body": "<p>Try something like this:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>    Dim XL As New Excel.Application, Filename As String\n\n    Filename = \"~ your file ~\"\n\n    XL.Workbooks.Open (Filename)\n    myrec.fields(~column name~) = XL.Worksheets(1).Range(\"A1\").value\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11204121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de624ca2c6b2d4a1cdcbfb7e1bb272e8?s=128&d=identicon&r=PG&f=1", "display_name": "JuiceBoxKing", "link": "https://stackoverflow.com/users/11204121/juiceboxking"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 56157719, "answer_count": 1, "score": 0, "last_activity_date": 1594808576, "creation_date": 1557952871, "last_edit_date": 1594808576, "question_id": 56157317, "link": "https://stackoverflow.com/questions/56157317/can-getobject-do-this", "title": "Can GetObject do this?", "body": "<p>I'm currently working on developing a macro that will input various forms into an access database. </p>\n\n<p>Due to the nature of the beast of this program, I've had to split my main program into two sub programs and call them, but I need to use getobject to call a file path twice now. </p>\n\n<p>I use getobject to open a file, and then use myrec.fields(~column name~) = xlsht.cells(1, \"a\") to populate various column values. I'm unsure if there are other \"efficient\" ways to accomplish this.</p>\n\n<p>I was wondering if it is possible to use a variable in place of the filepath with the GetObject command, instead of needing to manually replace the file path in the code. </p>\n\n<p>I've tested a fair amount of different code, including the path, class functionality but I don't think I understand VBA enough to truly make the best use of that. </p>\n\n<p>I can make it work using this</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim XL As Variant\nDim XLApp As Variant\nDim XLsht As Variant\nDim XLwrkbk As Variant\n\nSet XL = CreateObject(\"Excel.Application\")\nSet XLwrkbk = GetObject(~file path~)\nSet XLsht = XLwrkbk.Worksheets(1)\nSet MyRec = CurrentDb.OpenRecordset(\"database name\")\n</code></pre>\n\n<p>Ideally I would like it to be</p>\n\n<pre><code>Dim filename As String\nDim XL As Variant\nDim XLApp As Variant\nDim XLsht As Variant\nDim XLwrkbk As Variant\n\nfilename = \" ~insert file path~ \"\n\nSet XL = CreateObject(\"Excel.Application\")\nSet XLwrkbk = GetObject(filename)\nSet XLsht = XLwrkbk.Worksheets(1)\nSet MyRec = CurrentDb.OpenRecordset(\"database name\")\n</code></pre>\n\n<p>I receive a run time error</p>\n\n<p>Run-time error '5':\nInvalid procedure call or argument.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1557955897, "post_id": 56157251, "comment_id": 98944759, "body": "Time stamp of when the files were merged or when the files were created? For creation  you can get the data with <code>FileDateTime(fileCSV)</code> and format the string with <code>Format()</code> or <code>mid, trim, left, right</code> whatever works"}], "answers": [{"tags": [], "owner": {"reputation": 38, "user_id": 11484824, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-h8dftHJCtDE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3refPuuQllm_uuhBINVyO3oO_hUdZg/mo/photo.jpg?sz=128", "display_name": "Mario Di Noia", "link": "https://stackoverflow.com/users/11484824/mario-di-noia"}, "is_accepted": false, "score": 0, "last_activity_date": 1557960552, "creation_date": 1557960552, "answer_id": 56158612, "question_id": 56157251, "link": "https://stackoverflow.com/questions/56157251/merging-csv-files-into-one-sheet-and-obtaining-the-timestamp-and-file-name-of-ea/56158612#56158612", "title": "merging csv files into one sheet and obtaining the timestamp and file name of each csv file on a sheet", "body": "<p>Have you considered using Power query for this task?\nWith power query you can get data from folder.\nWith few simple transforms. It will combine the csv. Files and get the time date stamp amongst other things</p>\n"}], "owner": {"reputation": 1, "user_id": 11506333, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a0qEQlj_8Bk/AAAAAAAAAAI/AAAAAAAAD-o/LJxDIbEzvYY/photo.jpg?sz=128", "display_name": "James Calder", "link": "https://stackoverflow.com/users/11506333/james-calder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557960552, "creation_date": 1557952563, "last_edit_date": 1557956095, "question_id": 56157251, "link": "https://stackoverflow.com/questions/56157251/merging-csv-files-into-one-sheet-and-obtaining-the-timestamp-and-file-name-of-ea", "title": "merging csv files into one sheet and obtaining the timestamp and file name of each csv file on a sheet", "body": "<p>I have successfully merged multiple csv files. I am now trying to take the filename and created timestamp of each imported csv file and place the filename and created time stamp into a separate sheet in a specific cell. This would list the files I have merged by filename and created timestamps.</p>\n\n<p>I thought I can add some type of code into the loop. I am just not sure on the syntax to use for the timestamp and filename. I am not sure if this can be done either? Does anyone know the syntax or code to use that I can add into the loop, that would list the time stamps and file names of each imported csv file into a separate sheet? I have tried different codes, but it keeps crashing. Below is the loop that is successfully merging multiple files. If you have any questions, please let me know.  </p>\n\n<pre><code>    Dim wbout   As Workbook\n    Dim wsMstr  As Worksheet\n    Set wsMstr = ThisWorkbook.Sheets(\"Sheet1\")\n    Dim lfileCSV    As String\n    Dim fList As String\n    Dim fName As String\n    Dim fd As FileDialog\n    Dim FileChosen As Integer\n    Dim FileName As String\n    Dim i As Integer\n    Dim wbCSVDisplayOrder As Long\n    Dim M As Long\n    Dim LastRow As Long\n\n    Application.ScreenUpdating = False\n\n    'start the OUT file listing\n    fCSV = Dir(fName &amp; \"test*.CSV\")\n    RowInsert = 2\n\n    Do Until fileCSV = \"\"\n        Set wbCSV = Workbooks.Open(fileCSV)\n        With wbCSV.Worksheets(1)\n            LastRow = .Cells(Rows.Count, \"A\").End(xlUp).Row\n            .Range(\"A2:FG\" &amp; LastRow).Copy\n            wsMstr.Range(\"A\" &amp; RowInsert).PasteSpecial xlPasteValues\n\n            Application.DisplayAlerts = False\n\n            wbout.Close False\n            Application.DisplayAlerts = True\n            RowInsert = RowInsert + LastRow - 1\n        End With\n        fileCSV = Dir()\n    Loop\n</code></pre>\n\n<p>The expected results would insert the created timestamp and the filename of each imported csv file into a cell in a different sheet. An example, if you imported three csv files then the filename and timestamp for each of csv file will be listed on another sheet.</p>\n\n<p>Thank you</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 4, "creation_date": 1557951529, "post_id": 56156971, "comment_id": 98943103, "body": "is the workbook you&#39;re looking for already open? If not then you&#39;ll get that error (and would instead need to use the Workbooks.Open method).  If it is already open, then a typo from manually entering the workbook name is the most likely culprit.  Generally you should avoid that entirely though and I&#39;d recommend showing the Open File dialog so that the user can select the file they&#39;re interested in, much less room for error that way.  Even better, if you can predict the name of the workbook (because it changes in a known fashion), it would be best to generate/calculate the name."}, {"owner": {"reputation": 31, "user_id": 11364845, "user_type": "registered", "profile_image": "https://graph.facebook.com/1532703080140610/picture?type=large", "display_name": "Daniel", "link": "https://stackoverflow.com/users/11364845/daniel"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1557951831, "post_id": 56156971, "comment_id": 98943227, "body": "It wasn&#39;t open actually I feel stupid now and thanks for the suggestion. I&#39;ve been using macros for less than a month so there&#39;s a lot to learn yet."}, {"owner": {"reputation": 440, "user_id": 5128961, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SEr4k.gif?s=128&g=1", "display_name": "DavidN", "link": "https://stackoverflow.com/users/5128961/davidn"}, "edited": false, "score": 1, "creation_date": 1557953126, "post_id": 56156971, "comment_id": 98943745, "body": "Is the workbook you&#39;re trying to work with the one containing the code?  If that&#39;s the case you can just do <code>Set wk=ThisWorkbook</code> and avoid the need for a name altogether."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1557953195, "post_id": 56156971, "comment_id": 98943783, "body": "And if you need to open the worksheet, consider using <code>Application.FileDialog(msoFileDialogFilePicker)</code> instead of asking the user to type in a file name (which they will inevitably get wrong half the time)"}, {"owner": {"reputation": 31, "user_id": 11364845, "user_type": "registered", "profile_image": "https://graph.facebook.com/1532703080140610/picture?type=large", "display_name": "Daniel", "link": "https://stackoverflow.com/users/11364845/daniel"}, "reply_to_user": {"reputation": 440, "user_id": 5128961, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SEr4k.gif?s=128&g=1", "display_name": "DavidN", "link": "https://stackoverflow.com/users/5128961/davidn"}, "edited": false, "score": 0, "creation_date": 1557953515, "post_id": 56156971, "comment_id": 98943894, "body": "@DavidN it isn&#39;t unfortunately"}, {"owner": {"reputation": 31, "user_id": 11364845, "user_type": "registered", "profile_image": "https://graph.facebook.com/1532703080140610/picture?type=large", "display_name": "Daniel", "link": "https://stackoverflow.com/users/11364845/daniel"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1557954166, "post_id": 56156971, "comment_id": 98944147, "body": "@cybernetic.nomad Alright, I&#39;ll definetely use it. Do you by any chance know how can I manipulate the values of a closed Workbook?"}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1557955797, "post_id": 56156971, "comment_id": 98944714, "body": "This begs the question, why not use <code>FileDialog</code> instead? It&#39;s much more foolproof than to let users type away at file names"}, {"owner": {"reputation": 31, "user_id": 11364845, "user_type": "registered", "profile_image": "https://graph.facebook.com/1532703080140610/picture?type=large", "display_name": "Daniel", "link": "https://stackoverflow.com/users/11364845/daniel"}, "edited": false, "score": 0, "creation_date": 1557956214, "post_id": 56156971, "comment_id": 98944853, "body": "I agree with you, just leaned about this function about 1h ago."}, {"owner": {"reputation": 1681, "user_id": 8309643, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GKYcGO_qCIE/AAAAAAAAAAI/AAAAAAAAB8o/PJdqYRCGzdU/photo.jpg?sz=128", "display_name": "Robert Todar", "link": "https://stackoverflow.com/users/8309643/robert-todar"}, "edited": false, "score": 0, "creation_date": 1557957929, "post_id": 56156971, "comment_id": 98945318, "body": "Here is an example with <a href=\"https://stackoverflow.com/a/25154160/8309643\">File Dialog</a>. If you need to manipulate values in a closed workbook you&#39;ll, unfortunately, have to open it. Turning off screen updating will help performance some."}], "answers": [{"tags": [], "owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "is_accepted": true, "score": 0, "last_activity_date": 1557959260, "creation_date": 1557959260, "answer_id": 56158449, "question_id": 56156971, "link": "https://stackoverflow.com/questions/56156971/can-i-assign-a-string-value-containing-the-name-of-a-workbook-as-an-argument/56158449#56158449", "title": "Can I assign a string value containing the name of a workbook as an argument?", "body": "<blockquote>\n  <p><em>Technically this is not exactly, what you were asking for, but it is a much better programming practice to let users select files within\n  the OS interface, rather than to let them type-away at file names,\n  which ultimately arrives at the same goal.</em></p>\n</blockquote>\n\n<p>I've created a custom function for picking files via the <code>FileDialog</code> object. As an optional argument, you can enforce a specific file-type in the <code>format</code> argument.</p>\n\n<h2><code>get_file([format], [fullpath])</code></h2>\n\n<pre><code>' Returns a file name of a selected file via the .FileDialog object\n' Arguments:\n'    [format] : Optional argument, if left empty any file format can be selected, _\n                otherwise enforce what [format] was put in to be selected\n'    [fullpath] : Optional argument, if left empty will only return FileName.xxx, _\n                  otherwise will return full path (eg. D:\\MyDir\\Book.xlsx\")\n' Returns: A &lt;String&gt; with the selected filename.\n</code></pre>\n\n<p>This is how the function looks like:</p>\n\n<pre><code>Private Function get_file(Optional ByVal format As String = \"nomatch\", _\n                          Optional ByVal fullpath As Boolean = False) As String\n\n    Dim fs As FileDialog: Set fs = Application.FileDialog(msoFileDialogFilePicker)\n    Dim goodmatch As Boolean: goodmatch = False\n\n    Do Until goodmatch = True\n        With fs\n            If .Show &lt;&gt; -1 Then\n                .Title = \"Choose a Workbook to work with\"\n                .AllowMultiSelect = False\n                .InitialFileName = Application.DefaultFilePath\n            End If\n\n            If format = \"nomatch\" Then\n                goodmatch = True\n            Else\n                format = Replace(format, \".\", \"\")\n                If Mid(.SelectedItems(1), InStrRev(.SelectedItems(1), \".\") + 1) &lt;&gt; format Then\n                    MsgBox \"Please select a \" &amp; format &amp; \" file format\", vbCritical\n                Else\n                    goodmatch = True\n                End If\n            End If\n        End With\n    Loop\n\n    If fullpath = True Then\n       get_file = fs.SelectedItems(1)\n    Else\n       get_file = Mid(fs.SelectedItems(1), InStrRev(fs.SelectedItems(1), \"\\\") + 1)\n    End If\n\nEnd Function\n</code></pre>\n\n<p>Example user of the function:</p>\n\n<pre><code>Private Sub test()\n    Dim wb As Workbook: Set wb = Workbooks.Open(get_file(\".xlsx\", fullpath:= True))\n    ' saves a workbook of only .xlsx type from what user selected into wb variable\n    Debug.Print wb.Name\nEnd Sub\n</code></pre>\n\n<p>Opened the workbook with the <code>[fullpath]</code> for proper link (<code>True</code>)  wit the enforced <code>.xlsx</code> <code>[format]</code> and printed the <code>Name</code> propert of the <code>Workbook</code> object saved inside the <code>wb</code> variable</p>\n\n<p><a href=\"https://i.stack.imgur.com/ye2ks.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ye2ks.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 31, "user_id": 11364845, "user_type": "registered", "profile_image": "https://graph.facebook.com/1532703080140610/picture?type=large", "display_name": "Daniel", "link": "https://stackoverflow.com/users/11364845/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 56158449, "answer_count": 1, "score": 1, "last_activity_date": 1557987023, "creation_date": 1557951280, "last_edit_date": 1557987023, "question_id": 56156971, "link": "https://stackoverflow.com/questions/56156971/can-i-assign-a-string-value-containing-the-name-of-a-workbook-as-an-argument", "title": "Can I assign a string value containing the name of a workbook as an argument?", "body": "<p>To summarize, the workbook's name changes twice every week and me instead of thinking of another optmized way to do it automatically, decided to simply show an inputbox where the current workbook's name will be typed in and then assign it to:</p>\n\n<pre><code>Public fileName As String\nfileName = InputBox(\"Type here the current workbook's name: \")  \n</code></pre>\n\n<hr>\n\n<pre><code>Dim ext As String\next = \".xlsb\"\n\nSet wk = Excel.Workbooks(fileName &amp; ext)\n</code></pre>\n\n<blockquote>\n  <p>Error 9: subscript out of range</p>\n</blockquote>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 3, "creation_date": 1557949945, "post_id": 56156472, "comment_id": 98942478, "body": "You can only use 10 columns if you populate with <code>additem</code>. Use an array assigned to the List property, or the Rowsource property with a range address."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1557950050, "post_id": 56156472, "comment_id": 98942510, "body": "See if <a href=\"https://codereview.stackexchange.com/a/140999/23788\">this code</a> helps"}, {"owner": {"reputation": 1, "user_id": 11505711, "user_type": "registered", "profile_image": "https://graph.facebook.com/10161708434400246/picture?type=large", "display_name": "cavalierfool", "link": "https://stackoverflow.com/users/11505711/cavalierfool"}, "edited": false, "score": 0, "creation_date": 1558107149, "post_id": 56156472, "comment_id": 99004105, "body": "forgive me, but i don&#39;t understand either cryptic response.    MG  - the code page has no comments, and as far as I can tell is just referencing the same points for all versions. rory . . . I think rowsource doesn&#39;t work for me, because my elements are not in the same order as they appear in the raw data row. And I thought I was using an array assigned to the list? I mean each list item is supposed to be an array of 13 elements.  I&#39;m trying to create an array, to add to a list of arrays."}], "owner": {"reputation": 1, "user_id": 11505711, "user_type": "registered", "profile_image": "https://graph.facebook.com/10161708434400246/picture?type=large", "display_name": "cavalierfool", "link": "https://stackoverflow.com/users/11505711/cavalierfool"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557948857, "creation_date": 1557948857, "question_id": 56156472, "link": "https://stackoverflow.com/questions/56156472/userform-listbox-not-accepting-more-than-10-elements-run-time-error-380", "title": "UserForm ListBox not accepting more than 10 elements? Run-time error &#39;380&#39;", "body": "<p>Multi-Selectable Listbox on UserForm in Excel VBA is not correctly populating, past the tenth column.</p>\n\n<p>I've explicitly set my column count as 13, my syntax seems appropriate.</p>\n\n<p>I've read some other threads on this, only hints I get are a ListView item, that I can not seem to figure out how to get in to my toolbox.</p>\n\n<pre><code>Do While Not FetchSearch Is Nothing\n\n                    FetchPositionVar = FetchSearch.Address\n\n                    PossibleRecordsList.AddItem\n\n                    ListPos = PossibleRecordsList.ListCount\n\n                    PossibleRecordsList.List(ListPos - 1, 0) = Trim(ws.Cells(FetchSearch.Row, 19).Value)\n                    PossibleRecordsList.List(ListPos - 1, 1) = Trim(ws.Cells(FetchSearch.Row, 7).Value)\n                    PossibleRecordsList.List(ListPos - 1, 2) = Trim(ws.Cells(FetchSearch.Row, 8).Value)\n                    PossibleRecordsList.List(ListPos - 1, 3) = Trim(ws.Cells(FetchSearch.Row, 10).Value)\n                    PossibleRecordsList.List(ListPos - 1, 4) = Trim(ws.Cells(FetchSearch.Row, 11).Value)\n                    PossibleRecordsList.List(ListPos - 1, 5) = Trim(ws.Cells(FetchSearch.Row, 12).Value)\n                    PossibleRecordsList.List(ListPos - 1, 6) = Trim(ws.Cells(FetchSearch.Row, 1).Value)\n                    PossibleRecordsList.List(ListPos - 1, 7) = Trim(ws.Cells(FetchSearch.Row, 2).Value)\n                    PossibleRecordsList.List(ListPos - 1, 8) = Trim(ws.Cells(FetchSearch.Row, 4).Value)\n                    PossibleRecordsList.List(ListPos - 1, 9) = Trim(ws.Cells(FetchSearch.Row, 5).Value)\n                    PossibleRecordsList.List(ListPos - 1, 10) = Trim(ws.Cells(FetchSearch.Row, 6).Value)\n                    PossibleRecordsList.List(ListPos - 1, 11) = Trim(ws.Cells(FetchSearch.Row, 15).Value)\n                    PossibleRecordsList.List(ListPos - 1, 12) = RecordYear\n\n                    Set FetchSearch = FetchRange.Find(what:=FetchDataMatch, After:=Range(FetchPositionVar), SearchDirection:=xlNext, LookAt:=xlPart)\n\n                    If FirstFindPositionVar = FetchSearch.Address Then\n                        Exit Do\n                    End If\n                Loop\n</code></pre>\n\n<p>I am populating a multi-selection ListBox from multiple worksheets.\nEach list item, is an array with 13 elements, drawn from a row on one of the worksheets, after a search identifies the row with relevant data to display.</p>\n\n<p>The list will hold several \"possibly correct records\" that are then displayed for the user to multi-select.  Selected records are bumped into a different list, and used for a report generation.</p>\n\n<p>when it reaches the 11th element, I get run time error 380</p>\n"}, {"tags": ["excel", "vba", "autofilter"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5334189, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-H_x5Mir-Ons/AAAAAAAAAAI/AAAAAAAAB3g/BsL_5_cvQY0/photo.jpg?sz=128", "display_name": "Rodrigo Kroehn", "link": "https://stackoverflow.com/users/5334189/rodrigo-kroehn"}, "edited": false, "score": 0, "creation_date": 1557951196, "post_id": 56156590, "comment_id": 98942973, "body": "I&#39;m getting a Incompatible Types error using your code."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 21, "user_id": 5334189, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-H_x5Mir-Ons/AAAAAAAAAAI/AAAAAAAAB3g/BsL_5_cvQY0/photo.jpg?sz=128", "display_name": "Rodrigo Kroehn", "link": "https://stackoverflow.com/users/5334189/rodrigo-kroehn"}, "edited": false, "score": 0, "creation_date": 1557951640, "post_id": 56156590, "comment_id": 98943144, "body": "Can you share some sample criteria data from <code>FILTROMANUAL</code>? Also, <code>Dim FILTROMANUAL As Range</code>, not <code>As Variant</code>."}, {"owner": {"reputation": 21, "user_id": 5334189, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-H_x5Mir-Ons/AAAAAAAAAAI/AAAAAAAAB3g/BsL_5_cvQY0/photo.jpg?sz=128", "display_name": "Rodrigo Kroehn", "link": "https://stackoverflow.com/users/5334189/rodrigo-kroehn"}, "edited": false, "score": 0, "creation_date": 1557951647, "post_id": 56156590, "comment_id": 98943145, "body": "On the cell I have this: 4061491414, 5430490934, 743170733, 5392490936, 5422490939, 1645490146, 25494325 That is what is inside the variant"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 21, "user_id": 5334189, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-H_x5Mir-Ons/AAAAAAAAAAI/AAAAAAAAB3g/BsL_5_cvQY0/photo.jpg?sz=128", "display_name": "Rodrigo Kroehn", "link": "https://stackoverflow.com/users/5334189/rodrigo-kroehn"}, "edited": false, "score": 0, "creation_date": 1557951810, "post_id": 56156590, "comment_id": 98943222, "body": "Still can&#39;t reproduce the error. What is the exact error message?"}, {"owner": {"reputation": 21, "user_id": 5334189, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-H_x5Mir-Ons/AAAAAAAAAAI/AAAAAAAAB3g/BsL_5_cvQY0/photo.jpg?sz=128", "display_name": "Rodrigo Kroehn", "link": "https://stackoverflow.com/users/5334189/rodrigo-kroehn"}, "edited": false, "score": 0, "creation_date": 1557951885, "post_id": 56156590, "comment_id": 98943256, "body": "This is the code I&#39;m using:  &lt;code&gt;  Sub Filtro()  Dim FILTROMANUAL As Range  Set FILTROMANUAL = Sheets(&quot;21.03 a 20.04&quot;).Range(&quot;AL7&quot;)  ActiveSheet.Range(&quot;$A:$AH&quot;).AutoFilter Field:=28, Criteria1:=Split(FILTROMANUAL.Value, &quot;,&quot;), Operator:=xlFilterValues  End Sub  &lt;code&gt;  I&#39;m getting:  Execution error timer &quot;13&quot;:  Incompatibles Types"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 21, "user_id": 5334189, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-H_x5Mir-Ons/AAAAAAAAAAI/AAAAAAAAB3g/BsL_5_cvQY0/photo.jpg?sz=128", "display_name": "Rodrigo Kroehn", "link": "https://stackoverflow.com/users/5334189/rodrigo-kroehn"}, "edited": false, "score": 0, "creation_date": 1557952085, "post_id": 56156590, "comment_id": 98943325, "body": "Just to check, you get <code>4061491414, 5430490934, 743170733, 5392490936, 5422490939, 1645490146, 25494325</code> if you <code>Debug.Print FILTROMANUAL.value</code>?"}, {"owner": {"reputation": 21, "user_id": 5334189, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-H_x5Mir-Ons/AAAAAAAAAAI/AAAAAAAAB3g/BsL_5_cvQY0/photo.jpg?sz=128", "display_name": "Rodrigo Kroehn", "link": "https://stackoverflow.com/users/5334189/rodrigo-kroehn"}, "edited": false, "score": 0, "creation_date": 1557952487, "post_id": 56156590, "comment_id": 98943506, "body": "I got it @BigBen! I don&#39;t know why but the cell has 4 spaces before the actual data. Withou the spaces it worked flawlessly. Only have to instruct the user for not leaving spaces. Thank you very much!"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 21, "user_id": 5334189, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-H_x5Mir-Ons/AAAAAAAAAAI/AAAAAAAAB3g/BsL_5_cvQY0/photo.jpg?sz=128", "display_name": "Rodrigo Kroehn", "link": "https://stackoverflow.com/users/5334189/rodrigo-kroehn"}, "edited": false, "score": 0, "creation_date": 1557952528, "post_id": 56156590, "comment_id": 98943525, "body": "Cool, glad to help out! If the spaces might be an issue in the future you could add a <code>Trim</code> to remove them."}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 0, "last_activity_date": 1557949512, "creation_date": 1557949512, "answer_id": 56156590, "question_id": 56156391, "link": "https://stackoverflow.com/questions/56156391/how-to-make-a-variable-get-multiple-values-from-a-single-cell-and-use-it-as-auto/56156590#56156590", "title": "How to make a variable get multiple values from a single cell and use it as autofilter criteria", "body": "<p>You need an array of values. Using <code>Split</code> on the cell will give you that:</p>\n\n<pre><code>ActiveSheet.Range(\"$A:$AH\").AutoFilter Field:=28, Criteria1:=Split(FILTROMANUAL.Value, \",\"), Operator:=xlFilterValues\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5334189, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-H_x5Mir-Ons/AAAAAAAAAAI/AAAAAAAAB3g/BsL_5_cvQY0/photo.jpg?sz=128", "display_name": "Rodrigo Kroehn", "link": "https://stackoverflow.com/users/5334189/rodrigo-kroehn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 56156590, "answer_count": 1, "score": 0, "last_activity_date": 1557987591, "creation_date": 1557948465, "last_edit_date": 1557987591, "question_id": 56156391, "link": "https://stackoverflow.com/questions/56156391/how-to-make-a-variable-get-multiple-values-from-a-single-cell-and-use-it-as-auto", "title": "How to make a variable get multiple values from a single cell and use it as autofilter criteria", "body": "<p>I have a single cell with multiple values, sometimes can it have just one value or it can contains 10/20 and so on. I whant use this info on that specific cell as criteria to autofilter. All values in this cell are using comma between then.</p>\n\n<p>I have tried alot of array/transpose/range combination but without success</p>\n\n<pre><code>Sub Filtro()\n\nDim FILTROMANUAL As Variant\n\nSet FILTROMANUAL = Sheets(\"21.03 a 20.04\").Range(\"AL7\")\n\nActiveSheet.Range(\"$A:$AH\").AutoFilter Field:=28, Criteria1:=FILTROMANUAL, Operator:=xlFilterValues\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 5422, "user_id": 3123109, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/95c33442a31305c50683b2db05d49106?s=128&d=identicon&r=PG&f=1", "display_name": "cjones", "link": "https://stackoverflow.com/users/3123109/cjones"}, "is_accepted": true, "score": 1, "last_activity_date": 1557947677, "creation_date": 1557947677, "answer_id": 56156221, "question_id": 56156155, "link": "https://stackoverflow.com/questions/56156155/replacing-chr10-with-chr13-chr10-in-excel-for-import-into-access/56156221#56156221", "title": "Replacing Chr(10) with Chr(13) + Chr(10) in Excel for import into Access", "body": "<p>Never mind, figured it out a few minutes after posting:</p>\n\n<pre><code>xl.Selection.Replace What:=\"\" &amp; Chr(10) &amp; \"\", Replacement:=\"\" &amp; Chr(13) &amp; Chr(10) &amp; \"\", LookAt:=xlPart, _\n    SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=False\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": false, "score": 0, "last_activity_date": 1557947843, "creation_date": 1557947843, "answer_id": 56156264, "question_id": 56156155, "link": "https://stackoverflow.com/questions/56156155/replacing-chr10-with-chr13-chr10-in-excel-for-import-into-access/56156264#56156264", "title": "Replacing Chr(10) with Chr(13) + Chr(10) in Excel for import into Access", "body": "<p>To preserve the Excel data, you could alternatively run the following query following the import into MS Access:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>update \n    YourTable t \nset \n    t.YourField = Replace(t.YourField, Chr(10), Chr(13) &amp; Chr(10))\nwhere \n    t.YourField like \"*\" &amp; Chr(10) &amp; \"*\" and\n    t.YourField not like \"*\" &amp; Chr(13) &amp; Chr(10) &amp; \"*\"\n</code></pre>\n"}], "owner": {"reputation": 5422, "user_id": 3123109, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/95c33442a31305c50683b2db05d49106?s=128&d=identicon&r=PG&f=1", "display_name": "cjones", "link": "https://stackoverflow.com/users/3123109/cjones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1237, "favorite_count": 0, "accepted_answer_id": 56156221, "answer_count": 2, "score": 0, "last_activity_date": 1594779313, "creation_date": 1557947366, "last_edit_date": 1594779313, "question_id": 56156155, "link": "https://stackoverflow.com/questions/56156155/replacing-chr10-with-chr13-chr10-in-excel-for-import-into-access", "title": "Replacing Chr(10) with Chr(13) + Chr(10) in Excel for import into Access", "body": "<p>The issue is that line breaks in Excel use <code>Char(10)</code>, but in Access they use <code>Char(13) &amp; Char(10)</code>. Thus, when you import in to Access from Excel, what were line breaks in Excel, are all on the same line in Access.</p>\n\n<p>I have imports automated with a button click so that some of the data can be sanitized before input. I want to add this to the sensitization, but I'm having trouble with it:</p>\n\n<pre><code>' Remove blank cells that aren't blank (i.e., pasting values of formulas with no value)\nxl.ActiveSheet.UsedRange.Select\nxl.Selection.Value = xl.Selection.Value\n\n' Replace line breaks and carriage returns with something Access recognizes\nxl.Selection.Value = Replace(xl.Selection.Value, Chr(10), Chr(13) + Chr(10))\n\n' OR this....\n\nxl.ActiveSheet.Selection.Replace _\n  What:=Chr(10), Replacement:=Chr(13) + Chr(10), _\n  SearchOrder:=xlByColumns, MatchCase:=False\n</code></pre>\n\n<p>The first approach generates:</p>\n\n<pre><code>Run-time error '13': Type mismatch\n</code></pre>\n\n<p>The second approach generates:</p>\n\n<pre><code>Run-time error '438': Object doesn't support this property or method\n</code></pre>\n\n<p>Where am I going wrong here and what would be a better way?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1557946900, "post_id": 56155992, "comment_id": 98941171, "body": "Tools &gt; References, then locate and add the <i>Microsoft Scripting Runtime</i> library. Your life will be much, <i>much</i> easier with a <code>Scripting.FileSystemObject</code>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1557947548, "post_id": 56155992, "comment_id": 98941450, "body": "That said, <code>NewPath</code> looks like it needs to be re-assigned in the <code>For Each sheetz0r</code> loop body? <code>NewPath = sheetz0r.Name</code>?"}, {"owner": {"reputation": 15, "user_id": 11505940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb4e3539d8b0e662dd1a96bfc3d3654?s=128&d=identicon&r=PG&f=1", "display_name": "Tony Jeffs", "link": "https://stackoverflow.com/users/11505940/tony-jeffs"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1557951686, "post_id": 56155992, "comment_id": 98943163, "body": "I tried the NewPath = sheetz0r.Name In a previous iteration however I receive an error code that an object is required."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1557952583, "post_id": 56155992, "comment_id": 98943546, "body": "&quot;Object Required&quot; on that value assignment would have been thrown if you did <code>Set NewPath = sheetz0r.Name</code> - only objects can be assigned with the <code>Set</code> keyword"}, {"owner": {"reputation": 15, "user_id": 11505940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb4e3539d8b0e662dd1a96bfc3d3654?s=128&d=identicon&r=PG&f=1", "display_name": "Tony Jeffs", "link": "https://stackoverflow.com/users/11505940/tony-jeffs"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1557957487, "post_id": 56155992, "comment_id": 98945198, "body": "Thank you. It works great now."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 11505940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb4e3539d8b0e662dd1a96bfc3d3654?s=128&d=identicon&r=PG&f=1", "display_name": "Tony Jeffs", "link": "https://stackoverflow.com/users/11505940/tony-jeffs"}, "edited": false, "score": 0, "creation_date": 1557949559, "post_id": 56156365, "comment_id": 98942303, "body": "Thank you. Sorry my code was so strange with the ActiveSheet.Sheets.Name I meant to take that out before posting. This helps a lot."}, {"owner": {"reputation": 15, "user_id": 11505940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb4e3539d8b0e662dd1a96bfc3d3654?s=128&d=identicon&r=PG&f=1", "display_name": "Tony Jeffs", "link": "https://stackoverflow.com/users/11505940/tony-jeffs"}, "edited": false, "score": 0, "creation_date": 1557957575, "post_id": 56156365, "comment_id": 98945228, "body": "My Issue has been solved. Sadly I do not have enough credits to upvote the answer."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 15, "user_id": 11505940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb4e3539d8b0e662dd1a96bfc3d3654?s=128&d=identicon&r=PG&f=1", "display_name": "Tony Jeffs", "link": "https://stackoverflow.com/users/11505940/tony-jeffs"}, "edited": false, "score": 1, "creation_date": 1557957735, "post_id": 56156365, "comment_id": 98945276, "body": "@TonyJeffs not until you get 15 points. But you can still mark an answer as &quot;accepted&quot; by clicking the hollow checkmark next to the voting buttons. That&#39;ll give you +2 already =)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1557948367, "creation_date": 1557948367, "answer_id": 56156365, "question_id": 56155992, "link": "https://stackoverflow.com/questions/56155992/dynamic-folder-creation-in-vba-excel/56156365#56156365", "title": "Dynamic Folder Creation in VBA Excel", "body": "<p>Move the <code>Path</code> and <code>Folder</code> assignments inside the loop body, and replace <code>&amp; NewPath</code> with <code>&amp; sheetz0r.Name</code> - not sure what <code>ActiveSheet.Sheets.Name</code> is supposed to be, the <code>Sheets</code> collection class doesn't have a <code>Name</code> member.</p>\n\n<p>I'd restructure things a bit, remove the redundant variables, and move declarations closer to their usage. I think what you mean to do is something like this?</p>\n\n<pre><code>Dim sheet As Worksheet\nFor Each sheet In ActiveWorkbook.Worksheets\n\n    Dim Path As String\n    Path = Dir(\"C:\\Test\" &amp; sheet.Name, vbDirectory)\n\n    If Path = vbNullString Then\n        If MsgBox(\"Path does not exist. Would you like to create it?\", vbYesNo, \"Create Path?\") = vbYes Then\n            VBA.FileSystem.MkDir Path\n        Else\n            Exit For\n        End If\n    End If\nNext\n</code></pre>\n\n<p>That said, verifying whether a folder exists, and creating a new one, is much simpler/cleaner using a <code>FileSystemObject</code> from the <code>Scripting</code> library - I would also abstract away the prompting part into its own function:</p>\n\n<pre><code>With New Scripting.FileSystemObject\n    Dim sheet As Worksheet\n    For Each sheet In ActiveWorkbook.Worksheets\n\n        Dim Path As String\n        Path = \"C:\\Test\\\" &amp; sheet.Name\n\n        If Not .FolderExists(Path) Then\n            If ConfirmCreateFolder(Path) Then\n                .CreateFolder Path\n            Else\n                Exit For\n            End If\n        End If\n\n    Next\nEnd With\n</code></pre>\n\n\n\n<pre><code>Private Function ConfirmCreateFolder(ByVal Path As String) As Boolean\n    Dim prompt As String\n    prompt = \"Folder '\" &amp; Path &amp; \"' does not exist. Would you like to create it?\"\n    ConfirmCreateFolder = (MsgBox(prompt, vbYesNo, \"Create Folder?\") = vbYes)            \nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 11505940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb4e3539d8b0e662dd1a96bfc3d3654?s=128&d=identicon&r=PG&f=1", "display_name": "Tony Jeffs", "link": "https://stackoverflow.com/users/11505940/tony-jeffs"}, "edited": false, "score": 0, "creation_date": 1557949575, "post_id": 56156368, "comment_id": 98942308, "body": "Thank you for your insight!"}], "tags": [], "owner": {"reputation": 173, "user_id": 1719890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd25513c710f5a3d0d21b5dc195d6621?s=128&d=identicon&r=PG", "display_name": "Jitendra Singh", "link": "https://stackoverflow.com/users/1719890/jitendra-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1557948377, "creation_date": 1557948377, "answer_id": 56156368, "question_id": 56155992, "link": "https://stackoverflow.com/questions/56155992/dynamic-folder-creation-in-vba-excel/56156368#56156368", "title": "Dynamic Folder Creation in VBA Excel", "body": "<p>Try this</p>\n\n<pre><code>Sub CheckFolder()\n    Dim Path As String\n    Dim Folder As String\n    Dim Answer As VbMsgBoxResult\n    Dim NewPath As String\n    Dim scripObj As New Scripting.FileSystemObject\n\n\n    Path = \"C:\\Test\\\"\n    For Each sheetz0r In ActiveWorkbook.Sheets\n\n    If Not scripObj.FolderExists(Path &amp; sheetz0r.Name) Then\n        Answer = MsgBox(\"Path does not exist. Would you like to create it?\", vbYesNo, \"Create Path?\")\n        Select Case Answer\n            Case vbYes\n                scripObj.CreateFolder (Path &amp; sheetz0r.Name)\n            Case Else\n                Exit Sub\n        End Select\n    End If\n    Next\nEnd Sub\n\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11505940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb4e3539d8b0e662dd1a96bfc3d3654?s=128&d=identicon&r=PG&f=1", "display_name": "Tony Jeffs", "link": "https://stackoverflow.com/users/11505940/tony-jeffs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 628, "favorite_count": 0, "accepted_answer_id": 56156365, "answer_count": 2, "score": 1, "last_activity_date": 1557948377, "creation_date": 1557946593, "last_edit_date": 1557946857, "question_id": 56155992, "link": "https://stackoverflow.com/questions/56155992/dynamic-folder-creation-in-vba-excel", "title": "Dynamic Folder Creation in VBA Excel", "body": "<p>I have several files that need to be distributed into respective folders. How can I check to see if a folder exists with a dynamic name using an excel VBA macro? </p>\n\n<p>I split a single workbook into several by the various worksheets within it. I believe it would be easiest if the macro used the name of each sheet in the original workbook to check for the existence of that folder. That way it's dynamic and I don't have to worry about coding it to search for each folder, as the data source continues to grow and need additional worksheets. I already have a code for searching for the folder, I just need to understand how to write it so that its dynamic.</p>\n\n<pre><code>Dim Path As String\nDim Folder As String\nDim Answer As VbMsgBoxResult\nDim NewPath As String\nNewPath = ActvieWorkbook.Sheets.Name\nPath = \"C:\\Test\" &amp; NewPath\nFolder = Dir(Path, vbDirectory)\nFor Each sheetz0r In ActiveWorkbook.Sheets\nIf Folder = vbNullString Then\n    Answer = MsgBox(\"Path does not exist. Would you like to create it?\", vbYesNo, \"Create Path?\")\n    Select Case Answer\n        Case vbYes\n            VBA.FileSystem.MkDir (Path)\n        Case Else\n            Exit Sub\n    End Select\nEnd If\nNext\n</code></pre>\n\n<p>In the code I have written, I just need the \"NewPath =\" line adjusted so that it will search for the sheet names.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1557947151, "post_id": 56155901, "comment_id": 98941279, "body": "I don&#39;t see how chart object could accomplish anything like this. Perhaps a subform bound to that table and using textbox Conditional Formatting could emulate the &#39;banding&#39;."}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1557947295, "post_id": 56155901, "comment_id": 98941335, "body": "Is your graph just text in boxes like in the images? If yes, your best bet is to create a table with the columns as fields and the records as lines, use VBA to empty and fill the table with values and then just open it in read-only mode. The table will maintain the formatting, you will just have to adjust the width of each columns once."}, {"owner": {"reputation": 1, "user_id": 11505598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fb24492ac5ecc19980b6b3102f0a5ed?s=128&d=identicon&r=PG&f=1", "display_name": "Tony DeCosa", "link": "https://stackoverflow.com/users/11505598/tony-decosa"}, "reply_to_user": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1557976189, "post_id": 56155901, "comment_id": 98948594, "body": "@SunKnight0 The desired graph/images would resemble those on the right side of the top image as closely as possible. The data is plotted out in GRAPHTABLE (bottom image) with each &quot;cell&quot; representing a square, and the values in them representing the vb color code (1 being black, 15 being light gray, 16 being dark gray, etc.). The values on the left side of the GRAPHTABLE are static (the structure of the graph) while the values on the right (15s and 16s) are dynamic (the data of the graph).  When I attempted embedding Excel, I did not know what formulae to use to extract the data."}, {"owner": {"reputation": 1, "user_id": 11505598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fb24492ac5ecc19980b6b3102f0a5ed?s=128&d=identicon&r=PG&f=1", "display_name": "Tony DeCosa", "link": "https://stackoverflow.com/users/11505598/tony-decosa"}, "reply_to_user": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1557976660, "post_id": 56155901, "comment_id": 98948680, "body": "@SunKnight0 Wait - I guess I don&#39;t need to have formulae in the cells, do I? Just utilize my GRAPHTABLE as a guide to sending InteriorColor data to the cells, right?"}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1558099754, "post_id": 56155901, "comment_id": 98999911, "body": "You don&#39;t even need that. Use same foreground and background color <code>conditional formatting</code> and just dump your GRAPHRABLE values into the Excel sheet."}, {"owner": {"reputation": 1, "user_id": 11505598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fb24492ac5ecc19980b6b3102f0a5ed?s=128&d=identicon&r=PG&f=1", "display_name": "Tony DeCosa", "link": "https://stackoverflow.com/users/11505598/tony-decosa"}, "edited": false, "score": 0, "creation_date": 1558134160, "post_id": 56155901, "comment_id": 99013455, "body": "I tried it and realized that, with the Excel spreadsheet embedded into the database, I do not know how to address it! The embedded spreadsheet apparently does not have a name per se. So how does one address it from without once it is embedded?  I need to either a) SEND the &quot;condition&quot; data to each individual cell so that the CF might do its thing, or b) DRAW data into the cells with formulae that would address the Access table. I am experienced with VBA but haven&#39;t a clue what that would look like..."}, {"owner": {"reputation": 1, "user_id": 11505598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fb24492ac5ecc19980b6b3102f0a5ed?s=128&d=identicon&r=PG&f=1", "display_name": "Tony DeCosa", "link": "https://stackoverflow.com/users/11505598/tony-decosa"}, "edited": false, "score": 0, "creation_date": 1558616628, "post_id": 56155901, "comment_id": 99166115, "body": "Thank you for the input on this, but I believe that I have reached a dead end on this approach. The (over-)extended number of objects it required made it too kludgy."}], "owner": {"reputation": 1, "user_id": 11505598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fb24492ac5ecc19980b6b3102f0a5ed?s=128&d=identicon&r=PG&f=1", "display_name": "Tony DeCosa", "link": "https://stackoverflow.com/users/11505598/tony-decosa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594779326, "creation_date": 1557946170, "last_edit_date": 1594779326, "question_id": 56155901, "link": "https://stackoverflow.com/questions/56155901/how-to-create-image-and-or-graph-in-microsoft-access-2010", "title": "How to create image and/or graph in Microsoft Access 2010", "body": "<p>I am porting an app over from Delphi (Pascal form with an Access database) to operate strictly in Access. I have already done all the SQL and data handling successfully; now I need to present it graphically. The form features a full-version graph, and then a zoomed-in subset of that graph: </p>\n\n<p><img src=\"https://i.stack.imgur.com/d8LET.png\" alt=\"ORIGINAL\"></p>\n\n<p>I attempted to reproduce the graph as a CHART, and as an Excel object. (Although I did not succeed with either of these approaches, I acknowledge that the solution may be in there somewhere.)</p>\n\n<p>Ultimately, I did reproduce the full graph (at center right) - but to do so, I had to create hundreds of individual picture elements, and I ran up against the \"number of objects limit\" before I could complete the \"ZOOMBOX\"... Clearly the wrong approach.</p>\n\n<p>I have plotted the elements of the graph (a subset of which would, of course, be the zoombox) into a table, which <em>could</em> be used as a sort of \"paint-by-numbers\" guide.</p>\n\n<p><img src=\"https://i.stack.imgur.com/EeG86.png\" alt=\"GRAPHTABLE\"></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "is_accepted": false, "score": 1, "last_activity_date": 1558342840, "creation_date": 1558342840, "answer_id": 56217529, "question_id": 56155849, "link": "https://stackoverflow.com/questions/56155849/moving-a-pictures-to-a-cell/56217529#56217529", "title": "Moving a pictures to a cell", "body": "<p>Use the <code>Left</code> and <code>Top</code> properties of the shape and the cell.</p>\n\n<pre><code>Selection.ShapeRange.Left = [B7].Left\nSelection.ShapeRange.Top = [B7].Top\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11505978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce2b2b09f222577795f3d784685e72a3?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan_JCP", "link": "https://stackoverflow.com/users/11505978/ryan-jcp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558344681, "creation_date": 1557945946, "last_edit_date": 1558344681, "question_id": 56155849, "link": "https://stackoverflow.com/questions/56155849/moving-a-pictures-to-a-cell", "title": "Moving a pictures to a cell", "body": "<p>I need help making a Macro move a picture to cell in excel. I can move a picture up, down, left and right. But I want the macro to move a picture to a cell (for example to cell B7) no matter where it is in the excel sheet.  </p>\n\n<p>I have tried using </p>\n\n<pre><code> Selection.ShapeRange.IncrementLeft -474.7059055118\n Selection.ShapeRange.IncrementTop -303.5293700787\nEnd Sub\n</code></pre>\n\n<p>this moves the picture, just not to the right spot</p>\n"}, {"tags": ["excel", "vba", "internet-explorer", "crystal-reports"], "comments": [{"owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "edited": false, "score": 0, "creation_date": 1557962518, "post_id": 56155831, "comment_id": 98946277, "body": "Copy the query from Crystal and run the SQL directly in Excel."}], "owner": {"reputation": 11, "user_id": 11505798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/285fc844382d3adccc704d8e44c58d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed", "link": "https://stackoverflow.com/users/11505798/ahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 263, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1557949203, "creation_date": 1557945865, "last_edit_date": 1557949203, "question_id": 56155831, "link": "https://stackoverflow.com/questions/56155831/export-crystal-report-to-pdf-through-vba", "title": "Export Crystal Report to pdf through VBA", "body": "<p>I am trying to run a report in Internet Explorer and download it in PDF. I'm able to generate the report, but the report generated is getting opened in Crystal Viewer which I'm not aware of.</p>\n\n<p>I'd like to export the report through VBA.</p>\n\n<p>I had already posted a thread in <a href=\"http://www.vbaexpress.com/forum/showthread.php?65115-Export-Crystal-Report-to-pdf\" rel=\"nofollow noreferrer\">VBAexpress</a> but didn't get a reply.</p>\n\n<pre><code>Sub Trail1()\n    Dim ie As Object\n    Dim URL As String\n    Dim PropertyNames As String\n    Dim TStatus As String\n    Dim FrmDate As String\n    Dim ToDate As String\n    Dim AsOf As String\n    Dim Vendor As String\n    Dim LockBox As String\n    Dim Parse As String\n    Dim Destination As String\n\n    PropertyNames = ThisWorkbook.Sheets(2).Range(\"C14\").Value\n    TStatus = ThisWorkbook.Sheets(2).Range(\"C15\").Value\n    FrmDate = ThisWorkbook.Sheets(2).Range(\"C16\").Value\n    ToDate = ThisWorkbook.Sheets(2).Range(\"C17\").Value\n    AsOf = ThisWorkbook.Sheets(2).Range(\"C18\").Value\n    Vendor = ThisWorkbook.Sheets(2).Range(\"C19\").Value\n    LockBox = ThisWorkbook.Sheets(2).Range(\"C20\").Value\n    Parse = ThisWorkbook.Sheets(2).Range(\"C21\").Value\n    Destination = ThisWorkbook.Sheets(2).Range(\"C22\").Value\n\n    Set ie = CreateObject(\"Internetexplorer.application\")\n    ie.Visible = True\n\n    ie.navigate \"https://www.yardipcu.com/22466colonysso/pages/SysSqlScript.aspx?Action=FILTER&amp;From=SQLREPORTS&amp;select=reports/rs_jdr_tenant_statement_cobalt.txt\"\n    Do While ie.readyState &lt;&gt; 4 Or ie.Busy: DoEvents: Loop\n\n    ie.document.getElementsByClassName(\"form_button\")(0).Click\n\n    ie.document.getElementsByName(\"phMy\")(0).Value = PropertyNames\n    ie.document.getElementsByName(\"Status\")(0).Value = TStatus\n    ie.document.getElementsByName(\"begmonth\")(0).Value = Format(FrmDate, \"MM/YYYY\")\n    ie.document.getElementsByName(\"endmonth\")(0).Value = Format(ToDate, \"MM/YYYY\")\n    ie.document.getElementsByName(\"begdate\")(0).Value = Format(AsOf, \"MM/DD/YYYY\")\n    ie.document.getElementsByName(\"vendor\")(0).Value = Vendor\n    ie.document.getElementsByName(\"lockbox\")(0).Value = LockBox\n    ie.document.getElementsByName(\"sParse\")(0).Value = Parse\n    ie.document.getElementsByName(\"RptOutput\")(0).Value = Destination\n\n    ie.document.getElementsByClassName(\"filter_submit\")(0).Click\n\n    'After this, the report will be generated in a new Crystal Report window\n    'I am not even able to get the source code from Inspect Element to proceed with the export\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "com", "ole-automation", "iunknown"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1557999822, "post_id": 56155773, "comment_id": 98958102, "body": "Interestingly, if you pass <code>MyArray</code> into a routine that accepts <code>ByRef v As Variant</code>, the <code>TypeName(v)</code> inside it is correctly <code>Unknown()</code>. So you can have <code>public function CorrectlyAssign(ByRef v As Variant) As Variant : CorrectlyAssign = v : End Function</code> and do <code>MyVariant = CorrentlyAssign(MyArray)</code>."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1558000263, "post_id": 56155773, "comment_id": 98958368, "body": "Yet another array-to-pointer bug in VBA, I am being kept amused. (Other examples are <a href=\"https://stackoverflow.com/q/3375562/11683\">stackoverflow.com/q/3375562/11683</a> and <a href=\"https://stackoverflow.com/a/183356/11683\">stackoverflow.com/a/183356/11683</a>)."}, {"owner": {"reputation": 109, "user_id": 11208356, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y4lld48G_jQ/AAAAAAAAAAI/AAAAAAAACRA/4BaQJ29sVjY/photo.jpg?sz=128", "display_name": "Mark Fernandes", "link": "https://stackoverflow.com/users/11208356/mark-fernandes"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1558030281, "post_id": 56155773, "comment_id": 98975213, "body": "Hello @GSerg - thanks for these comments. It&#39;s looking as though it is a VBA bug that occurs in type conversions from <code>vbDataObject</code>-object arrays to <code>Variant</code> data whenever array copying is involved. In the case of the <code>ByRef</code> type conversion, no array copying is involved, so the type conversion appears to be working as expected - such behaviour is still odd because it differs from the <code>ByVal</code> type conversion, with the <code>ByVal</code> behaviour being even odder."}, {"owner": {"reputation": 109, "user_id": 11208356, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y4lld48G_jQ/AAAAAAAAAAI/AAAAAAAACRA/4BaQJ29sVjY/photo.jpg?sz=128", "display_name": "Mark Fernandes", "link": "https://stackoverflow.com/users/11208356/mark-fernandes"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1558083183, "post_id": 56155773, "comment_id": 98991296, "body": "Have now sent feedback using Microsoft Excel <i>Feedback</i> feature, to Microsoft regarding this issue. Have asked them to confirm whether it is a bug."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1558083407, "post_id": 56155773, "comment_id": 98991409, "body": "Good luck with that (honestly), although I personally haven&#39;t had any success with my bug reports."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1558523018, "post_id": 56155773, "comment_id": 99127467, "body": "You&#39;re playing a dangerous game with the VBA type system.  It has no support whatsoever for IUnknown interfaces, it expects all of them to be IDispatch.  It probably suffers an internal heart attack while trying to copy the array elements on a failing QueryInterface call and punts for returning the array pointer instead.  This isn&#39;t going to get fixed, you need to declare the array As Object."}, {"owner": {"reputation": 109, "user_id": 11208356, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y4lld48G_jQ/AAAAAAAAAAI/AAAAAAAACRA/4BaQJ29sVjY/photo.jpg?sz=128", "display_name": "Mark Fernandes", "link": "https://stackoverflow.com/users/11208356/mark-fernandes"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1558526508, "post_id": 56155773, "comment_id": 99129328, "body": "Hello @HansPassant. Thanks for your feedback. I don&#39;t think you are quite right about VBA not providing any support for <code>IUnknown</code> interfaces. Some of the COM types for the .NET framework do not support <code>IDispatch</code> but still work pretty well. See <a href=\"https://marc.info/?l=ms-dcom&amp;m=103440425612266&amp;w=2\" rel=\"nofollow noreferrer\">here</a> for someone else&#39;s opinion on whether pre-.NET VB supports <code>IUnknown</code> interfaces."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1558527119, "post_id": 56155773, "comment_id": 99129640, "body": "Hmya, &quot;Of course, you can&#39;t really &quot;work&quot; with it&quot; is the relevant phrase."}, {"owner": {"reputation": 1567, "user_id": 8488913, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oF9AE.png?s=128&g=1", "display_name": "Cristian Buse", "link": "https://stackoverflow.com/users/8488913/cristian-buse"}, "edited": false, "score": 0, "creation_date": 1600175296, "post_id": 56155773, "comment_id": 113000006, "body": "I don&#39;t know why it happens but you can use <a href=\"https://stackoverflow.com/a/62416803/8488913\">this</a> or <a href=\"https://stackoverflow.com/a/55838668/8488913\">this</a> to make the copy"}], "owner": {"reputation": 109, "user_id": 11208356, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y4lld48G_jQ/AAAAAAAAAAI/AAAAAAAACRA/4BaQJ29sVjY/photo.jpg?sz=128", "display_name": "Mark Fernandes", "link": "https://stackoverflow.com/users/11208356/mark-fernandes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 484, "favorite_count": 1, "answer_count": 0, "score": 5, "last_activity_date": 1559644465, "creation_date": 1557945648, "last_edit_date": 1559644465, "question_id": 56155773, "link": "https://stackoverflow.com/questions/56155773/why-when-trying-to-assign-to-a-variant-an-array-for-some-non-idispatch-exposing", "title": "Why when trying to assign to a variant, an array for some non-IDispatch-exposing object type, is the array pointer assigned instead?", "body": "<h2>Summary</h2>\n\n<p>After declaring an array for some object type where the type doesn't use an interface that <em><a href=\"https://docs.microsoft.com/en-us/windows/desktop/midl/interface\" rel=\"nofollow noreferrer\">derives</a></em> from <a href=\"https://docs.microsoft.com/en-us/windows/desktop/com/component-object-model--com--portal\" rel=\"nofollow noreferrer\">COM</a>'s <a href=\"https://docs.microsoft.com/en-gb/windows/desktop/api/oaidl/nn-oaidl-idispatch\" rel=\"nofollow noreferrer\"><code>IDispatch</code></a> interface (&amp; so isn't properly set-up to enable [OLE] <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/_automat/\" rel=\"nofollow noreferrer\">Automation</a>'s late-binding technology), trying to assign the array to a <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/variant-data-type\" rel=\"nofollow noreferrer\"><code>Variant</code></a> variable doesn't work according to my expectations.</p>\n\n<p>Specifically, what appears to happen is that an integral <a href=\"http://www.samsvb.co.uk/index.php?page=lesson&amp;les=Lesson%2030\" rel=\"nofollow noreferrer\">pointer</a> to the array is assigned to the <code>Variant</code> variable, instead of a copy of the array.</p>\n\n<p>Can anyone explain such behaviour? Is it standard behaviour of the VBA 7.1 language? <sup>[EDIT-A1]</sup> Is it that VBA's <code>Variant</code> type can't handle such arrays? <sup>[EDIT-A2]</sup></p>\n\n<p><br></p>\n\n<p><sup>[EDIT-A1] - <strong><em>Currently (4/6/19), it's looking like it's a bug.</em></strong></sup><br>\n<sup>[EDIT-A2] - <strong><em>No, as the internal procedure parameters for <code>ByRef</code> <code>Variant</code> arguments can properly point to such arrays, if such arrays are passed as the values for such arguments.</em></strong></sup></p>\n\n<p><hr><br></p>\n\n<h2>Background</h2>\n\n<p><em>More details on what appears to be happening</em></p>\n\n<p>After inspecting various memory addresses &amp; pointers, what appears to be happening is that when assigning such arrays to <code>Variant</code> variables, the <a href=\"https://docs.microsoft.com/en-gb/office/vba/language/reference/user-interface-help/long-data-type\" rel=\"nofollow noreferrer\"><code>Long</code></a> (or <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/longptr-data-type\" rel=\"nofollow noreferrer\"><code>LongPtr</code></a>) pointers to the <em>'VB safe array pointers'</em> of the arrays, are instead being assigned. This is contrary to the array-copying behaviour documented <a href=\"https://docs.microsoft.com/en-gb/openspecs/microsoft_general_purpose_programming_languages/ms-vbal/2ae5553a-6515-4967-9b91-e06b527b137f\" rel=\"nofollow noreferrer\">here</a> in the VBA language specification as being expected behaviour. I deduced such pointer assignment was taking place after reviewing VB6 documentation on VB arrays &amp; their memory layout, stored <a href=\"https://www.codeguru.com/vb/gen/vb_misc/algorithms/article.php/c7495/How-Visual-Basic-6-Stores-Data.htm\" rel=\"nofollow noreferrer\">here</a>.\n<br><br></p>\n\n<p><em>My research into whether issue has been previously documented</em></p>\n\n<p>I've searched the internet, the <a href=\"https://docs.microsoft.com/en-gb/office/vba/api/overview/\" rel=\"nofollow noreferrer\">Office VBA Reference</a> documentation, &amp; the <a href=\"https://docs.microsoft.com/en-gb/openspecs/microsoft_general_purpose_programming_languages/ms-vbal/\" rel=\"nofollow noreferrer\">VBA language specification</a> to see whether this problem has been documented by anyone else. The only place I've found where this problem may have already been partly documented is in a Stack Overflow answer posted <a href=\"https://stackoverflow.com/questions/38726883/on-windows-with-a-c-sharp-authored-com-server-can-one-return-a-safearray-both/38728862#38728862\">here</a>. Unfortunately, the post doesn't say much about the problem.\n<br><br></p>\n\n<p><em>Specific array types that I have tested this issue with</em></p>\n\n<p>I have experienced this issue with arrays of the following object types that use interfaces not <em>deriving</em> from <code>IDispatch</code>:</p>\n\n<ul>\n<li><code>stdole.IUnknown</code> <sup>*</sup></li>\n<li><code>stdole.IFont</code></li>\n<li><code>mscoree.CorRuntimeHost</code> <sup>&dagger;</sup></li>\n<li><code>mscorlib.AppDomain</code> <sup>&dagger;</sup></li>\n<li><code>mscorlib.Type</code></li>\n</ul>\n\n<p><sup>* From OLE Automation COM type library in <code>stdole2.tlb</code>.</sup><br>\n<sup>&dagger; From COM type library for the <a href=\"https://docs.microsoft.com/en-us/dotnet/framework/\" rel=\"nofollow noreferrer\">.NET framework</a> v4.0.30319.</sup>\n<br><br></p>\n\n<p><em>More on what an object type that uses an interface not deriving from <code>IDispatch</code>, is</em></p>\n\n<p>Such object types are <code>vbDataObject</code> types. Unfortunately, the current VBA documentation on the <code>vbDataObject</code> constant is inaccurate. I'm in the process of updating the documentation, &amp; you can see my updated definition for the constant <a href=\"https://github.com/MarkFern/VBA-Docs/blob/MF-PATCH/vartype-constants.md/part_or_full_scrub/Language/Concepts/Getting-Started/vartype-constants.md\" rel=\"nofollow noreferrer\">here</a>.\n<br><br></p>\n\n<p><strong><em>[EDIT - COM specification link removed as it is no longer relevant.]</em></strong></p>\n\n<p><BR></p>\n\n<p><em>Regarding arrays of other object types</em></p>\n\n<p>Arrays of <code>vbObject</code> types (COM object types that support [OLE] Automation late-binding technology) appear to be assigned to <code>Variant</code> variables in a straight-forward &amp; expected manner - <a href=\"https://docs.microsoft.com/en-gb/openspecs/microsoft_general_purpose_programming_languages/ms-vbal/2ae5553a-6515-4967-9b91-e06b527b137f\" rel=\"nofollow noreferrer\">array is copied and directly assigned</a>.\n<br><br></p>\n\n<p><em>VBE used to crash when inspecting such arrays using a VBE watch</em></p>\n\n<p>A potentially related issue is to do with a bug that used to occur when a VBE <a href=\"https://docs.microsoft.com/en-us/office/vba/language/concepts/forms/add-a-watch-expression\" rel=\"nofollow noreferrer\"><em>watch expression</em></a> was placed on an array of a type that used an interface not <em>deriving</em> from <code>IDispatch</code>. The bug used to cause the VBE to unexpectedly crash. This bug appears to have been fixed by Microsoft within the last month.\n<br><br></p>\n\n<p><em>Software versions</em></p>\n\n<pre>  <strong>Software</strong>               | <strong>Version</strong>      \n-------------------------+---------------<br>  VBA                    | 7.1 <sup>\u2021</sup><br>-------------------------+---------------<br>  Microsoft Excel        | 2016 <sup>\u00a7</sup><br>-------------------------+---------------<br>  Microsoft Windows (OS) | 8.1 <sup>\u00b6</sup> \n</pre>\n\n<p><sup>&Dagger; Full text for version is \"Retail 7.1.1088\"&mdash;the latest version.</sup><br><sup>&sect; More specifically, the latest <a href=\"https://docs.microsoft.com/en-us/officeupdates/update-history-office365-proplus-by-date\" rel=\"nofollow noreferrer\">version &amp; build</a> (released on 3rd June 2019, version 1905, build 11629.20214), &amp; also earlier build numbers 11629.20196 &amp; 11601.20204 (first was released on 14th May 2019).\n</sup><br><sup>&para; <code>ver.exe</code> program prints <a href=\"https://en.wikipedia.org/wiki/Ver_(command)#Version_list\" rel=\"nofollow noreferrer\">\"Microsoft Windows [Version 6.3.9600]\"</a>.</sup>\n<br><br></p>\n\n<h2>Code</h2>\n\n<h3><a href=\"https://stackoverflow.com/help/reprex\" title=\"Minimal, Reproducible Example\">Reprex</a>:</h3>\n\n<pre class=\"lang-vb prettyprint-override\"><code>    Dim MyArray() As stdole.IUnknown ' Type from OLE Automation \n                                     ' COM type library in stdole2.tlb.\n    Dim MyVariant As Variant\n    MyVariant = MyArray\n</code></pre>\n\n<p>I expected <code>MyVariant</code> to store a copy of the <code>MyArray</code> array.</p>\n\n<p>Instead, in the 32-bit version of VBA, <code>MyVariant</code> stores a <code>Long</code> value that appears to be a pointer to <code>MyArray</code>.</p>\n\n<h3>Debugging issue</h3>\n\n<p>Click <a href=\"https://gist.github.com/MarkFern/b1b7e9974b454c69cbf4bdcea4bd712d\" rel=\"nofollow noreferrer\">here</a>\nfor VBA code to assist in debugging issue.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 10783243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7715546cc8acad087f4cdf383daba3d?s=128&d=identicon&r=PG", "display_name": "user10783243", "link": "https://stackoverflow.com/users/10783243/user10783243"}, "edited": false, "score": 0, "creation_date": 1558013360, "post_id": 56157658, "comment_id": 98966094, "body": "Thank you, i tried your first recommendation, and it&#39;s working very well."}], "tags": [], "owner": {"reputation": 663, "user_id": 7131122, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VRUK1MTcgY4/AAAAAAAAAAI/AAAAAAAAA_8/VlNsZARthCY/photo.jpg?sz=128", "display_name": "Christofer Weber", "link": "https://stackoverflow.com/users/7131122/christofer-weber"}, "is_accepted": true, "score": 1, "last_activity_date": 1557954540, "creation_date": 1557954540, "answer_id": 56157658, "question_id": 56155758, "link": "https://stackoverflow.com/questions/56155758/copy-cell-value-to-first-empty-cell-in-b-column/56157658#56157658", "title": "Copy cell value to first empty cell in &quot;B&quot; column", "body": "<p>Instead of trying to make an <code>IF ELSE</code> for each possible scenario, you can make a loop. </p>\n\n<p>Something along the lines of </p>\n\n<pre><code>For i = 22 To 36 'Or however far you are willing to go down\n    If Cells(i, 2) = \"\" Then '2 Here being column 2, or \"B\"\n        Cells(i, 2) = cll\n        Exit For 'Stop looking once we found the empty cell\n    End If\nNext i\n</code></pre>\n\n<p>I mostly use variation of <code>Range(\"B\" &amp; Cells(Rows.Count, 2).End(xlUp).Offset(1, 0).Row)</code><br>\nTo find the first empty cell after the last used cell. But it doesn't work if you have empty rows in-between your data.</p>\n\n<p>You could also use <code>find</code></p>\n\n<pre><code>Set emptyRng = Range(\"B22:B\" &amp; Rows.Count).Find(What:=\"\", lookat:=xlWhole)\nemptyRng.Value = cll\n</code></pre>\n\n<p>And other combinations. Here I put <code>Rows.Count</code> as end limit instead, just to show some options.</p>\n"}], "owner": {"reputation": 29, "user_id": 10783243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7715546cc8acad087f4cdf383daba3d?s=128&d=identicon&r=PG", "display_name": "user10783243", "link": "https://stackoverflow.com/users/10783243/user10783243"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 56157658, "answer_count": 1, "score": 0, "last_activity_date": 1557987581, "creation_date": 1557945555, "last_edit_date": 1557987581, "question_id": 56155758, "link": "https://stackoverflow.com/questions/56155758/copy-cell-value-to-first-empty-cell-in-b-column", "title": "Copy cell value to first empty cell in &quot;B&quot; column", "body": "<p>How to copy cell value to first empty cell in B column, so if range(\"B22\") have value than copy below</p>\n\n<p>My code is</p>\n\n<pre><code>Set Rng = Range(\"B36:B360\")\nFor Each cll In Rng\n   If cll.Row &lt; Today And cll.Value &lt;&gt; \"\" And cll.Font.Color = vbBlack Then\nIf Range(\"B22\") = \"\" Then\n    Range(\"B22\") = cll\nElse\n    Range(\"B23\") = cll\nEnd If\n</code></pre>\n\n<p>But i will have 10 cells or more that i need to copy in B22 cell and below, so there must be another way to paste these cells?</p>\n"}, {"tags": ["html", "excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 142, "user_id": 4908790, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d1cfd0fe20c8a330a906c9f03edb5f81?s=128&d=identicon&r=PG&f=1", "display_name": "JasperD", "link": "https://stackoverflow.com/users/4908790/jasperd"}, "edited": false, "score": 0, "creation_date": 1558030599, "post_id": 56171358, "comment_id": 98975368, "body": "Hi Tony, thank you for your reply! I was thinking about doing it the same way; loop through the HTML table and add the tooltip code for any value that has a comment. Does the HTML table intrinsically holds the same pattern as the Excel sheet in terms of rows/columns? Is row 1 of my range in excel the also row 1 in the HTML table - I understand from you that it is the same, which makes life easier. I thought about building the HTML table from a range from scratch as well, but I like using publishobjects as it maintains formatting automatically, so I guess approach #1 is preferred."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 142, "user_id": 4908790, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d1cfd0fe20c8a330a906c9f03edb5f81?s=128&d=identicon&r=PG&f=1", "display_name": "JasperD", "link": "https://stackoverflow.com/users/4908790/jasperd"}, "edited": false, "score": 0, "creation_date": 1558040916, "post_id": 56171358, "comment_id": 98979790, "body": "@JasperD  The Html table certainly appears to match the Excel range.  Near the bottom of <code>RangeToHtml</code> there is <code>Kill TempFile</code>.  Delete that statement and the temporary file will not be deleted so you can examine it as I did.  I can see no extra rows or columns not can I imagine why there would be."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 142, "user_id": 4908790, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d1cfd0fe20c8a330a906c9f03edb5f81?s=128&d=identicon&r=PG&f=1", "display_name": "JasperD", "link": "https://stackoverflow.com/users/4908790/jasperd"}, "edited": false, "score": 0, "creation_date": 1558041007, "post_id": 56171358, "comment_id": 98979816, "body": "@JasperD My approach 2 would also use PublishObjects. <code>RangeToHtml</code> creates a temporary workbook, copies the range to Sheet(1) and then calls PublishObjects to output Sheet(1).  You can output the range from its original worksheet if it is a simple range.  My approach 2 would leave all that complicated stuff out."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 142, "user_id": 4908790, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d1cfd0fe20c8a330a906c9f03edb5f81?s=128&d=identicon&r=PG&f=1", "display_name": "JasperD", "link": "https://stackoverflow.com/users/4908790/jasperd"}, "edited": false, "score": 0, "creation_date": 1558041217, "post_id": 56171358, "comment_id": 98979889, "body": "It is possible to convert an Excel range to Html using VBA and copy all the formatting but it takes much longer than PublishObjects."}, {"owner": {"reputation": 142, "user_id": 4908790, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d1cfd0fe20c8a330a906c9f03edb5f81?s=128&d=identicon&r=PG&f=1", "display_name": "JasperD", "link": "https://stackoverflow.com/users/4908790/jasperd"}, "edited": false, "score": 0, "creation_date": 1558043164, "post_id": 56171358, "comment_id": 98980482, "body": "Yes, I am aware of all that - I&#39;ll give it a try; and, you never know with HTML, it&#39;s sometimes counter intuitive, and I&#39;m not good at writing that at all, so that&#39;s why I had my doubts. I tried to skip creating a new workbook etc, but for some reason publishobjects doesn&#39;t seem to publish if there are multiple sheets in the workbook, hence the need to create a single-sheet workbook, it seems. Do I need to add the css bit by the way or is adding the line you put in your answer sufficient?"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 142, "user_id": 4908790, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d1cfd0fe20c8a330a906c9f03edb5f81?s=128&d=identicon&r=PG&f=1", "display_name": "JasperD", "link": "https://stackoverflow.com/users/4908790/jasperd"}, "edited": false, "score": 0, "creation_date": 1558043976, "post_id": 56171358, "comment_id": 98980697, "body": "@JasperD If you visit <a href=\"https://www.w3schools.com/howto/tryit.asp?filename=tryhow_css_tooltip\" rel=\"nofollow noreferrer\">w3schools.com/howto/tryit.asp?filename=tryhow_css_tooltip</a> you will see a complete Html file. At the top is a style element. I added the contents of that style element to the top of PublishObjects&#39; style element. I then amended some td element contents as I described in my answer.  Note, the style elements in that example position the tip badly. You will need to adjust the css to give a better appearance. I was interesting to checking it was possiblerather than getting the best possible appearance."}, {"owner": {"reputation": 142, "user_id": 4908790, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d1cfd0fe20c8a330a906c9f03edb5f81?s=128&d=identicon&r=PG&f=1", "display_name": "JasperD", "link": "https://stackoverflow.com/users/4908790/jasperd"}, "edited": false, "score": 0, "creation_date": 1558075970, "post_id": 56171358, "comment_id": 98987747, "body": "Thanks - will give it a try and will revert back if I can&#39;t figure it out - and suggestions on how to change the position? (I know virtually nothing about CSS/HTML)"}, {"owner": {"reputation": 142, "user_id": 4908790, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d1cfd0fe20c8a330a906c9f03edb5f81?s=128&d=identicon&r=PG&f=1", "display_name": "JasperD", "link": "https://stackoverflow.com/users/4908790/jasperd"}, "edited": false, "score": 0, "creation_date": 1558093534, "post_id": 56171358, "comment_id": 98996682, "body": "It doesn&#39;t work in Outlook (<a href=\"https://www.campaignmonitor.com/css/media-queries/any-hover/\" rel=\"nofollow noreferrer\">campaignmonitor.com/css/media-queries/any-hover</a>) - the title element doesn&#39;t work either, so I am going to assume that it won&#39;t be possible."}], "tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": false, "score": 1, "last_activity_date": 1558018400, "creation_date": 1558018400, "answer_id": 56171358, "question_id": 56155329, "link": "https://stackoverflow.com/questions/56155329/retain-cell-comments-when-emailing-excel-table-using-rangetohtml/56171358#56171358", "title": "Retain cell comments when emailing Excel table (using RangeToHTML)", "body": "<p>This is a partial answer.  If it looks promising, I will complete it, although probably not until the weekend.</p>\n\n<p>I have output a range using PublishObjects and have then amended the output file to add a tool tip as you require.  With Microsoft Edge, the amended file displayed correctly and the tip appeared when I hovered over the relevant cell.  I have not tried this with Outlook but I assume Outlook uses the same display engine as Edge so it should work with Outlook.  This will need to be tested before doing much more work. </p>\n\n<p>Ron de Bruin has provided an excellent routine that prepare almost any range for PublishObjects, call PublishObjects, get the file it creates and return it as a string ready to become the Html body of an email.</p>\n\n<p>As far as I can tell, there is no way of getting PublishObjects to add comments to the output in the way you require.  You will have to add the necessary code.</p>\n\n<p>With approach 1, you need new code in function <code>RangeToHtml</code> between \u201cget the file it creates\u201d and \u201creturn it as a string\u201d.  That is, you let PublishObjects do its thing and then you amend its output before returning that output to the caller.</p>\n\n<p>A lot of the code in function <code>RangeToHtml</code> allows for the range being non-contiguous which, I assume, PublishObjects does not handle.  If you have a simple range, it would be easier to create a new <code>RangeToHtml</code> that handles simple ranges plus your requirement.  This would be approach 2.</p>\n\n<p>Would approach 1 or approach 2 better meet your requirements.</p>\n\n<p>The Html file created by PublishObjects contains a single table.  There is nothing in the table to indicate which table cell comes from which Excel range cell.  If row 2, column 5, of the range has a comment, you will have to count down the s and then the s to find the corresponding table cell.  That table cell will have to be amended.  If the existing cell value is Xxxx and the comment is Yyyy, you will need to replace Xxxx with:</p>\n\n<pre><code>&lt;div class=\"tooltip\"&gt;Xxxx&lt;span class=tooltiptext&gt;Yyyy&lt;/span&gt;&lt;/div&gt;\n</code></pre>\n\n<p>Does this sound interesting?</p>\n"}], "owner": {"reputation": 142, "user_id": 4908790, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d1cfd0fe20c8a330a906c9f03edb5f81?s=128&d=identicon&r=PG&f=1", "display_name": "JasperD", "link": "https://stackoverflow.com/users/4908790/jasperd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1592464369, "creation_date": 1557943855, "last_edit_date": 1592464369, "question_id": 56155329, "link": "https://stackoverflow.com/questions/56155329/retain-cell-comments-when-emailing-excel-table-using-rangetohtml", "title": "Retain cell comments when emailing Excel table (using RangeToHTML)", "body": "<p>I'm using an adjusted version Ron de Bruin's well known 'rangetoHTML' to email an Excel range using Outlook (as found here: <a href=\"https://www.rondebruin.nl/win/s1/outlook/bmail2.htm\" rel=\"nofollow noreferrer\">https://www.rondebruin.nl/win/s1/outlook/bmail2.htm</a>). While this works fine, some of the cells have comments which logically do not get carried over into outlook.</p>\n\n<p>I thought it might be possible to add the comments as tooltips adding in a bit of CSS (as found here: <a href=\"https://www.w3schools.com/howto/howto_css_tooltip.asp\" rel=\"nofollow noreferrer\">https://www.w3schools.com/howto/howto_css_tooltip.asp</a>), but am not sure if a) Outlook supports tooltip in the HTML email (I've seen conflicting messages), and b) if it DOES, how to implement it in the html spit out by publishobjects</p>\n\n<p>Relevant bit to spit out the HTM, but am confused as to how to go about including tooltips.</p>\n\n<pre><code>   With TempWB.PublishObjects.Add( _\n        SourceType:=xlSourceRange, _\n        Filename:=TempFile, _\n        Sheet:=TempWB.Sheets(1).Name, _\n        Source:=TempWB.Sheets(1).UsedRange.Address, _\n       HtmlType:=xlHtmlStatic)\n      .Publish (True)\n  End With\n</code></pre>\n\n<p>Any help is appreciated, thank you.</p>\n"}, {"tags": ["excel", "vba", "class", "scrollbar", "userform"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1557947390, "post_id": 56155214, "comment_id": 98941381, "body": "Does <code>CadreDonnees.Repaint</code> help?"}, {"owner": {"reputation": 13, "user_id": 11505595, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157716833894131/picture?type=large", "display_name": "Vincent-Daniel Girard", "link": "https://stackoverflow.com/users/11505595/vincent-daniel-girard"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1558009986, "post_id": 56155214, "comment_id": 98963769, "body": "@MathieuGuindon YES, such an easy solution! I feel almost bad searching for hours! I&#39;m not sure how to flag your answer as an official solution though!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1558010325, "post_id": 56155214, "comment_id": 98963996, "body": "You can&#39;t mark a comment as accepted - I&#39;ve posted an actual answer below; cheers!"}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 0, "last_activity_date": 1558010254, "creation_date": 1558010254, "answer_id": 56168747, "question_id": 56155214, "link": "https://stackoverflow.com/questions/56155214/scrollbar-height-in-userform-frame-doesnt-update-right-away-i-need-to-click-it/56168747#56168747", "title": "Scrollbar height in userform frame doesn&#39;t update right away. I need to click it to update it", "body": "<p>Try invoking the <code>Repaint</code> method of your Frame control =)</p>\n\n<pre><code>CadreDonnees.Repaint\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11505595, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157716833894131/picture?type=large", "display_name": "Vincent-Daniel Girard", "link": "https://stackoverflow.com/users/11505595/vincent-daniel-girard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 441, "favorite_count": 0, "accepted_answer_id": 56168747, "answer_count": 1, "score": 1, "last_activity_date": 1558010254, "creation_date": 1557943294, "last_edit_date": 1557946114, "question_id": 56155214, "link": "https://stackoverflow.com/questions/56155214/scrollbar-height-in-userform-frame-doesnt-update-right-away-i-need-to-click-it", "title": "Scrollbar height in userform frame doesn&#39;t update right away. I need to click it to update it", "body": "<p>So I have an <strong>Excel userform that contains a frame</strong>. In this frame, there may be a X amount of dynamically added objects that fill it's content until it overfills. Of course I added a <strong>vertical scrollbar</strong> to compensate this issue, this is not the problem.</p>\n\n<p>The bottom frame with caption \"Donn\u00e9es\" is the one im talking about:\n<a href=\"https://i.stack.imgur.com/8uzSd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8uzSd.png\" alt=\"The bottom frame with caption &quot;Donn\u00e9es&quot; is the one I&#39;m talking about\"></a></p>\n\n<p>The problem is much trickier. So as you can see in the previous image, there are a bunch of buttons (actually toggle buttons). When you toggle a set of each of them, they will appear in the frame below. In fact, <strong>all the possible combinations of the toggled buttons will be shown.</strong> </p>\n\n<p>Example 1:\n<a href=\"https://i.stack.imgur.com/s7Fzs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/s7Fzs.png\" alt=\"Example 1\"></a></p>\n\n<p>Example 2:\n<a href=\"https://i.stack.imgur.com/TlObi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TlObi.png\" alt=\"Example 2\"></a></p>\n\n<p>The toggle buttons click methods are actually programmed in a class-module that calls a sub directly in the userform (named RSAjout2).</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\n'THIS PIECE OF CODE IS WRITTEN IN A CLASS-MODULE\n\n' Is not useful for this demonstration\nPublic WithEvents btn As MSForms.ToggleButton\nPublic frm As UserForm\n'''\n\n\n' Here, each button is an object that calls the refreshData function to make sure it is updated each\n' time one of then is pressed\n\nPrivate Sub btn_Click()\n    'We call the subprocedure in the userform RSAjout2\n    RSAjout2.refreshData\nEnd Sub\n</code></pre>\n\n<p>When this sub (refresh data) is called, there is a part of its code that ajusts the height of the scrollbar. </p>\n\n<pre><code>Public Sub refreshData()\n\n'###Lots of code that I dont have any problem with###\n\n    RSAjout2.CadreDonnees.ScrollHeight = totalHeight\n    'Where totalHeight is just the height of all the frames stacked in the big frame\n\n\nEnd Sub\n</code></pre>\n\n<p>And that works fine too. (So what is the problem then?)</p>\n\n<p>The problem is that <strong>when the code actually resizes the height of the scrollbar, it doesn't actually update!</strong> I have to either click on the scrollbar itself (and move it) to make it change shape or click another toggleButton (but its state is an old one). Let me show you with pictures.</p>\n\n<p>If I make a combination of tests and medias so that the number of frames overfill the container frame, it should display a scrollbar right (well its height should update)?</p>\n\n<p>Wrong:\n<a href=\"https://i.stack.imgur.com/a3oLK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/a3oLK.png\" alt=\"Wrong\"></a></p>\n\n<p>Then if I click the scrollbar, and move it just as it already existed, it suddently updates it is now visible.</p>\n\n<p>Why?\n<a href=\"https://i.stack.imgur.com/pSHFo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pSHFo.png\" alt=\"Why?\"></a></p>\n\n<p>This only happends with my toggleButtons. If I, for example, use my \"Abondonner\" button to change the height of the scrollbar, it works perfectly. Why is that so?</p>\n\n<pre><code>Private Sub Abandonner_Click()\n    'Code to test if the scrollbar updates normally from a normal click procedure\n    Me.CadreDonnees.ScrollHeight = 1000\n    'Spoiler* It works perfectly\nEnd Sub\n\n</code></pre>\n\n<p>EDIT: This seemed to do the trick. However, it is clearly not the best way to solve this problem. Well at least it works...</p>\n\n<pre><code>    'An aweful, but working solution\n    CadreDonnees.ScrollTop = 1\n    CadreDonnees.ScrollTop = 0\n    CadreDonnees.ScrollHeight = totalHeight\n    CadreDonnees.ScrollTop = 1\n    CadreDonnees.ScrollTop = 0\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 2, "creation_date": 1557942224, "post_id": 56154934, "comment_id": 98939116, "body": "It looks like you&#39;re trying to define public variables?  If that&#39;s the case, use <code>Sub</code> instead of <code>Function</code> since your function isn&#39;t actually returning anything.  If it is supposed to, then you should add <code>Set defineWorksheet = ws_18</code> just before the end of your function."}, {"owner": {"reputation": 31, "user_id": 11364845, "user_type": "registered", "profile_image": "https://graph.facebook.com/1532703080140610/picture?type=large", "display_name": "Daniel", "link": "https://stackoverflow.com/users/11364845/daniel"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1557947249, "post_id": 56154934, "comment_id": 98941314, "body": "Thanks, just realised your idea could work too but nonetheless thanks again!"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 11364845, "user_type": "registered", "profile_image": "https://graph.facebook.com/1532703080140610/picture?type=large", "display_name": "Daniel", "link": "https://stackoverflow.com/users/11364845/daniel"}, "edited": false, "score": 0, "creation_date": 1557943626, "post_id": 56155064, "comment_id": 98939784, "body": "Interesting idea I must say but the thing is that i&#39;ll be mostly using these variables to count rows and columns, for example: rowsCount = ws_18.Cells(Rows.Count, 1).End(xlUp).Row so I think the compiler might not recognize it there in the middle of a line..."}, {"owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "reply_to_user": {"reputation": 31, "user_id": 11364845, "user_type": "registered", "profile_image": "https://graph.facebook.com/1532703080140610/picture?type=large", "display_name": "Daniel", "link": "https://stackoverflow.com/users/11364845/daniel"}, "edited": false, "score": 0, "creation_date": 1557943914, "post_id": 56155064, "comment_id": 98939893, "body": "The compiler will definitely be fine with it. I&#39;ve used this approach before."}], "tags": [], "owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "is_accepted": false, "score": 0, "last_activity_date": 1557942555, "creation_date": 1557942555, "answer_id": 56155064, "question_id": 56154934, "link": "https://stackoverflow.com/questions/56154934/is-it-possible-to-return-a-worksheet-type-variable-in-a-function/56155064#56155064", "title": "Is it possible to return a worksheet type variable in a function?", "body": "<p>The general idea is sound, you just need to create one function per object:</p>\n\n<pre><code>Function wk_Base_18() as workbook\n    Set wk_Base_18 = Excel.Workbooks(\"2019.01.03.xlsb\")\nEnd Function\n\nFunction ws_18() as worksheet\n    Set ws_18 = wk_Base_18.Worksheets(\"Planilha1\")\nEnd Function\n</code></pre>\n\n<p>Then whenever you go to use the variable ws_18 or wk_Base_18, you will be calling these same functions.</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 11364845, "user_type": "registered", "profile_image": "https://graph.facebook.com/1532703080140610/picture?type=large", "display_name": "Daniel", "link": "https://stackoverflow.com/users/11364845/daniel"}, "edited": false, "score": 0, "creation_date": 1557946411, "post_id": 56155084, "comment_id": 98940955, "body": "Thanks for saving me!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 31, "user_id": 11364845, "user_type": "registered", "profile_image": "https://graph.facebook.com/1532703080140610/picture?type=large", "display_name": "Daniel", "link": "https://stackoverflow.com/users/11364845/daniel"}, "edited": false, "score": 3, "creation_date": 1557946632, "post_id": 56155084, "comment_id": 98941049, "body": "@Daniel if the sheet exists at compile-time in <code>ThisWorkbook</code>, there already is a global object/Worksheet variable for it, named after whatever that sheet module&#39;s <code>(Name)</code> property is - declaring a variable for, let alone pulling that object from the <code>ThisWorkbook.Sheets</code> or <code>ThisWorkbook.Worksheets</code> collection, is perfectly redundant - only do this for sheets created at run-time, or sheets that are in workbooks loaded at run-time."}, {"owner": {"reputation": 31, "user_id": 11364845, "user_type": "registered", "profile_image": "https://graph.facebook.com/1532703080140610/picture?type=large", "display_name": "Daniel", "link": "https://stackoverflow.com/users/11364845/daniel"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1557946999, "post_id": 56155084, "comment_id": 98941214, "body": "@MathieuGuindon I actually changed this line because I&#39;m saving the values to another workbook not <code>this.workbook</code> but thanks for the info though"}], "tags": [], "owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "is_accepted": true, "score": 1, "last_activity_date": 1557942678, "creation_date": 1557942678, "answer_id": 56155084, "question_id": 56154934, "link": "https://stackoverflow.com/questions/56154934/is-it-possible-to-return-a-worksheet-type-variable-in-a-function/56155084#56155084", "title": "Is it possible to return a worksheet type variable in a function?", "body": "<p>Yes, you can declare them as a global variable.</p>\n\n<pre><code>Public ws1 As Worksheet\n</code></pre>\n\n<p>Then instantiate the global variable during the application load event of the <a href=\"/questions/tagged/excel\" class=\"post-tag\" title=\"show questions tagged &#39;excel&#39;\" rel=\"tag\">excel</a> application</p>\n\n<pre><code>Private Sub Workbook_Open()\n     Set ws1 = ThisWorkbook.Sheets(\"YourSheetName\")\nEnd Sub\n</code></pre>\n\n<p>And now, you can refer to it via the variable, eg.</p>\n\n<pre><code>Dim x as Integer: x = ws1.Range(\"B5\")\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 11364845, "user_type": "registered", "profile_image": "https://graph.facebook.com/1532703080140610/picture?type=large", "display_name": "Daniel", "link": "https://stackoverflow.com/users/11364845/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 56155084, "answer_count": 2, "score": 0, "last_activity_date": 1557943607, "creation_date": 1557941996, "last_edit_date": 1557943607, "question_id": 56154934, "link": "https://stackoverflow.com/questions/56154934/is-it-possible-to-return-a-worksheet-type-variable-in-a-function", "title": "Is it possible to return a worksheet type variable in a function?", "body": "<p>In this project I'm developing, I created many Subs that all use the same three workbooks. But is there a better way to use these workbooks' sheets  without having to write them down everytime I create a new Sub? I tried returning it in a function but it does not work.</p>\n\n<pre><code>Function defineWorksheet() As Worksheet\n\nDim wk_Base_18 As Excel.Workbook\nDim ws_18 As Excel.Worksheet\n\nSet wk_Base_18 = Excel.Workbooks(\"2019.01.03.xlsb\")\nSet ws_18 = wk_Base_18.Worksheets(\"Planilha1\")\n\nws_18\n\nEnd Function\n</code></pre>\n\n<blockquote>\n  <p>error 91</p>\n</blockquote>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1557943214, "creation_date": 1557943214, "answer_id": 56155198, "question_id": 56154450, "link": "https://stackoverflow.com/questions/56154450/is-there-a-way-to-use-variables-in-vba-to-identify-ms-access-report-fields/56155198#56155198", "title": "Is there a way to use variables in vba to identify MS-Access report fields?", "body": "<p>Try with:</p>\n\n<pre><code>Reports(\"ReportName\")(VariableName).Width = 200\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 11500853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9128086415fd34ccd003b21d6530f4b?s=128&d=identicon&r=PG&f=1", "display_name": "Trudy", "link": "https://stackoverflow.com/users/11500853/trudy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 172, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594779340, "creation_date": 1557940129, "last_edit_date": 1594779340, "question_id": 56154450, "link": "https://stackoverflow.com/questions/56154450/is-there-a-way-to-use-variables-in-vba-to-identify-ms-access-report-fields", "title": "Is there a way to use variables in vba to identify MS-Access report fields?", "body": "<p>I am not a programmer, but have been tasked with doing this anyway!  We are working on a research project that involves testing properties of different samples.  I am trying to create a form that will generate a custom report based on what the user chooses.  So, I have multiple text boxes and check boxes to allow the user to define the query parameters (e.g. composition of the sample must contain at least 5% component A) and choose what data they are interested in seeing in said report (e.g. show pH, color, but not melting point).  I have successfully created code to generate the query, then generate a report based on that query, but the report defaults to column widths that are generally too big (for example, the pH column width is 3 inches, it only needs to be about 1).  I would like to be able to fix this, but have not been able to figure out how.  At the same time, some of these fields contain numbers that are averages of multiple test results, so I would like to limit the number of digits shown, and display them as % where appropriate.  I started with just fixing the column width issue:</p>\n\n<p>I have tried to make a collection of the fields that are included, then loop through the collection and set column widths, but cannot figure out how to identify a field with a variable:</p>\n\n<p>If I know the field name I can do this:</p>\n\n<pre><code>Reports(\"ReportName\")!FieldID.Width = 200\n</code></pre>\n\n<p>But if I have a collection of names, FieldNames, or a string VariableName, none of these work, giving me an error that FieldNames or VariableName is not a valid field in the report:</p>\n\n<pre><code>Reports(\"ReportName\")!FieldNames(1).Width = 200\nReports(\"ReportName\")![FieldNames(1)].Width = 200\nReports(\"ReportName\")![VariableName].Width = 200\n</code></pre>\n\n<p>Is there a way to reference a field name with a variable? </p>\n\n<p>Alternatively, I thought there might be a way to loop through all fields and set widths - this would involve looking up a column width for each field, which I thought to do by adding a key to a collection of column widths.  But I cannot find a way to do that, something like:</p>\n\n<pre><code>For each Field in Reports(\"Report\")\n  Field.Width = ColumnWidthCollection(Field)\nNext\n</code></pre>\n\n<p>This hangs up on the Field.Width line, with \"invalid procedure call or argument\", which brings me back to how to reference a field name with a variable.</p>\n\n<p>Any help would be greatly appreciated!</p>\n"}, {"tags": ["sql", "excel", "vba", "connection", "procedure"], "comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1557940238, "post_id": 56154368, "comment_id": 98938243, "body": "duplicate of <a href=\"https://stackoverflow.com/questions/17574524/adodb-query-timeout\">stackoverflow.com/questions/17574524/adodb-query-timeout</a>"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 1, "creation_date": 1557940251, "post_id": 56154368, "comment_id": 98938249, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/17574524/adodb-query-timeout\">ADODB query timeout</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1557942488, "post_id": 56154368, "comment_id": 98939255, "body": "@DougCoats how does a timing-out query relate to running the command asynchronously? I&#39;d submit the answer on <a href=\"https://stackoverflow.com/q/41837242/1188513\">this post</a> as a dupe target... which is essentially what Tim answered below."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1557943415, "post_id": 56154368, "comment_id": 98939678, "body": "@MathieuGuindon b/c i didnt read it thoroughly. Or b/c i said so (which while having a little bit of sass isnt helpful at all despite me trying to play it off)."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 2, "last_activity_date": 1557940714, "creation_date": 1557940714, "answer_id": 56154603, "question_id": 56154368, "link": "https://stackoverflow.com/questions/56154368/excel-execute-sql-procedure-with-vba-allow-user-to-continue-working-do-no/56154603#56154603", "title": "Excel: Execute SQL Procedure with VBA -- allow user to continue working -- do not hang the Excel Application", "body": "<p>ADO supports asynchronous operations if you declare your Connection etc using <code>WithEvents</code></p>\n\n<p>See here for example:  <a href=\"https://support.microsoft.com/en-us/help/190988/how-to-open-ado-recordsets-asynchronously-using-withevents\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-us/help/190988/how-to-open-ado-recordsets-asynchronously-using-withevents</a></p>\n"}], "owner": {"reputation": 1, "user_id": 3113282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2edde751dcf6889cb7d1161231579fdf?s=128&d=identicon&r=PG&f=1", "display_name": "user3113282", "link": "https://stackoverflow.com/users/3113282/user3113282"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559123864, "creation_date": 1557939791, "last_edit_date": 1559123864, "question_id": 56154368, "link": "https://stackoverflow.com/questions/56154368/excel-execute-sql-procedure-with-vba-allow-user-to-continue-working-do-no", "title": "Excel: Execute SQL Procedure with VBA -- allow user to continue working -- do not hang the Excel Application", "body": "<p>I have several methods of executing a stored procedure from Excel VBA. In fact, I am not even interested in returning the results of that procedure back to Excel, I just need to kick off the procedure. Though, when the procedure is running Excel \"hangs\" and because unusable to the customer, especially when the procedure run time is 5 minutes or more. </p>\n\n<p>I looked at other solutions where people instantiate a new application within a single workbook, but it wasn't clear how to execute the procedure in that context. Another solution, was opening a second workbook in the background (hidden to the user), and auto-running the macro when that workbook opens, but it's not clear to me on when I know to close it. </p>\n\n<p>My code for calling the procedure, note, this suffers from a timeout issue, any thoughts on that appreciated too: </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Workbook_Open()\n\n 'Create connection string variable\n    Dim item As String\n    Dim con As New ADODB.Connection\n\n    'Build the connection string\n    con.ConnectionString = \"Provider=SQLNCLI11;\" _\n             &amp; \"Server=MyServerName;\" _\n             &amp; \"Database=Oracle;\" _\n             &amp; \"Integrated Security=SSPI;\"\n\n   'Open the connection\n    con.Open\n\n    item = vbNullString\n\n    item = \"exec dbo.SP_ORACLE_PULL\"\n    con.Execute (item)\n\n   'Close the connection   \n    con.Close\n\n End Sub\n</code></pre>\n\n<p>Does anyone have any recommended approaches? Is it best to open a workbook hidden in the background and run the procedure from there? how would I know when to close that workbook and relay the status back to the originating workbook? Will that still \"hang\" the customers all open Excel workbooks. I searched all over and I did not find any code examples for this type of scenario. </p>\n\n<p>This is all a stopgap until we can formalize a more enterprise solution in 4-6mo.</p>\n"}, {"tags": ["arrays", "excel", "vba", "loops"], "answers": [{"comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 1, "creation_date": 1557941183, "post_id": 56154433, "comment_id": 98938690, "body": "Another modification that might speed it up is to set <code>myRange</code> dynamically to include only the range to be processed."}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1557941282, "post_id": 56154433, "comment_id": 98938735, "body": "Yea the range of A1:A9999 is just an example. Thanks for the help."}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 2, "last_activity_date": 1557940860, "last_edit_date": 1557940860, "creation_date": 1557940059, "answer_id": 56154433, "question_id": 56154365, "link": "https://stackoverflow.com/questions/56154365/how-to-modify-a-range-of-cells-without-a-loop/56154433#56154433", "title": "How To Modify A Range of Cells Without a Loop", "body": "<p>Reading/writing to/from the worksheet takes a lot of time. Do the modifications within a VBA array, then write it back.</p>\n\n<pre><code>Dim myRange As Range, myArr As Variant\nSet myRange = Range(\"A1:A9999\")\n\nmyArr = myRange\n\nFor i = 1 To UBound(myArr, 1)\n    myArr(i, 1) = \"CC_\" &amp; myArr(i, 1)\nNext i\n\nmyRange = myArr\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1557940345, "post_id": 56154438, "comment_id": 98938291, "body": "Thanks. I will give you a tick, but I should have specified &quot;without using a helper column.&quot;"}, {"owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "reply_to_user": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 1, "creation_date": 1557940400, "post_id": 56154438, "comment_id": 98938324, "body": "Thanks. The helper column helpfully vanishes afterwards. Nobody needs to know."}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1557940506, "post_id": 56154438, "comment_id": 98938375, "body": "I would disagree that people wouldn&#39;t know. The scroll bar might act under the assumption that the usedRange extends to the final column. People most definitely notice things like that."}], "tags": [], "owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "is_accepted": false, "score": 1, "last_activity_date": 1557940070, "creation_date": 1557940070, "answer_id": 56154438, "question_id": 56154365, "link": "https://stackoverflow.com/questions/56154365/how-to-modify-a-range-of-cells-without-a-loop/56154438#56154438", "title": "How To Modify A Range of Cells Without a Loop", "body": "<p>You could temporarily create a column full of functions, then paste those values over the column A values:</p>\n\n<pre><code>Range(\"XFD1:xfd9999\").Formula = \"=\"\"CC_\"\"&amp;A1\"\nCalculate\nRange(\"A1:a9999\").Value = Range(\"XFD1:XFD8\").Value\nRange(\"XFD1:XFD9999\").ClearContents\n</code></pre>\n\n<p>I'm operating on the assumption here that you are not using column XFD for anything else. If you are, you could use a different column for this purpose.</p>\n"}, {"comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1557941906, "post_id": 56154625, "comment_id": 98938968, "body": "FYI <code>Evaluate(&quot;&quot;&quot;C_&quot;&quot; &amp; &quot; &amp; .Address)</code> without the INDEX() also works fine"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1557942354, "post_id": 56154625, "comment_id": 98939179, "body": "@TimWilliams Thanks. The INDEX was force of habit as a lot of functions need a little coercion to return arrays of values."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 1, "last_activity_date": 1557940839, "creation_date": 1557940839, "answer_id": 56154625, "question_id": 56154365, "link": "https://stackoverflow.com/questions/56154365/how-to-modify-a-range-of-cells-without-a-loop/56154625#56154625", "title": "How To Modify A Range of Cells Without a Loop", "body": "<p>FWIW, you can do it without a loop using <code>Evaluate</code> like this:</p>\n\n<pre><code>Sub addText()\n     With Range(\"A1:A9999\")\n        .Value2 = .Worksheet.Evaluate(\"INDEX(\"\"CC_\"\"&amp;\" &amp; .Address &amp; \",)\")\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "is_accepted": false, "score": 0, "last_activity_date": 1560216740, "creation_date": 1560216740, "answer_id": 56535338, "question_id": 56154365, "link": "https://stackoverflow.com/questions/56154365/how-to-modify-a-range-of-cells-without-a-loop/56535338#56535338", "title": "How To Modify A Range of Cells Without a Loop", "body": "<p>I was revisiting this (trying to still make it faster) and now that I have a little better understanding, I would recommend an approach shown below. The accepted answer is hard-coded for one column, which was my example asked, but the below approach is more dynamic.</p>\n\n<pre><code>Sub sampleArraySheetEdit()\nDim aRange As Range: Set aRange = Range(\"A1:B9999\") ' or whatever your range is...\nDim vRng() As Variant: vRng = aRange\nDim r As Long, c As Long\n\n\nFor r = LBound(vRng, 1) To UBound(vRng, 1) 'this ensures all cells always accounted for\n    For c = LBound(vRng, 2) To UBound(vRng, 2)\n\n        'perform you operation here....\n        vRng(r, c) = \"CC_\" &amp; vRng(r, c)\n\n    Next c\nNext r\n\naRange = vRng\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 56154433, "answer_count": 4, "score": 0, "last_activity_date": 1560216740, "creation_date": 1557939786, "question_id": 56154365, "link": "https://stackoverflow.com/questions/56154365/how-to-modify-a-range-of-cells-without-a-loop", "title": "How To Modify A Range of Cells Without a Loop", "body": "<p>I have a massive Excel template that's having performance issues. I'd like to optimize the VBA code I'm using to modify cells to be more of an \"all at once\" approach. I have several basic functions using loops to modify values. Here's an example:</p>\n\n<pre><code>Dim aCell as Range\nFor Each aCell In Range(\"A1:A9999\").Cells\n\n    'appends prefix to value of each cell\n     aCell.Value = \"CC_\" &amp; aCell.Value\n\nNext aCell\n</code></pre>\n\n<p>While this works, the drawback of this is that it causes several recalculations and updates that slows down the template. I'm familiar with turning calculations/screen updating on and off, but for reasons I won't go into, that's not an option.</p>\n\n<p>This code below does <strong>NOT</strong> work, but it's the approach I'm looking for. Is there a way to make such a change using an array or some other tool I'm not thinking of that would minimize the templates calculation updates?</p>\n\n<pre><code>Range(\"A1:A9999\").Value = \"CC_\" &amp; Range(\"A1:A9999\").Value\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 2, "creation_date": 1557940441, "post_id": 56154127, "comment_id": 98938348, "body": "Use an <code>Advanced Filter</code> with a formula criteria of <code>int(a1)=a1</code>.  You may need to add a header row."}], "answers": [{"tags": [], "owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "is_accepted": false, "score": 0, "last_activity_date": 1557939060, "creation_date": 1557939060, "answer_id": 56154183, "question_id": 56154127, "link": "https://stackoverflow.com/questions/56154127/vba-excel-delete-chunks-of-non-integer-cells/56154183#56154183", "title": "VBA Excel delete chunks of non-integer cells", "body": "<p>Rather than IsNumeric, try comparing them against rounded values to eliminate non-integers.</p>\n\n<pre><code>Sub Macro1()\n    For Each Cell In Selection\n        If Cell.Value &lt;&gt; round(cell.value,0) Then\n            Rows(Cell.Row).ClearContents\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 226, "user_id": 2955581, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NtXN6.jpg?s=128&g=1", "display_name": "Physther", "link": "https://stackoverflow.com/users/2955581/physther"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557940531, "creation_date": 1557938803, "last_edit_date": 1557940531, "question_id": 56154127, "link": "https://stackoverflow.com/questions/56154127/vba-excel-delete-chunks-of-non-integer-cells", "title": "VBA Excel delete chunks of non-integer cells", "body": "<p>I have an excel file with a lot of data and I would like to reduce it by cutting parts of it. For instance, I would like to delete the real numbers (non-integers) and keep only the integers in the first column. There are over a thousand lines and a macro is crucial. A sample can be seen below (the red contours needs to be deleted).</p>\n\n<p><a href=\"https://i.stack.imgur.com/rMpda.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rMpda.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have tried using IsNumeric and something like this:</p>\n\n<pre><code>Sub Macro1()\nFor Each Cell In Selection\n    If Cell.Value = IsNumeric(Cell.Row) Then\n     Rows(Cell.Row).ClearContents\n    End If\nNext\nEnd Sub\n</code></pre>\n\n<p>But it doesn't work. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1557938640, "post_id": 56154055, "comment_id": 98937526, "body": "<code>Dim Test As Variant</code> <code>Test = DateValue(&quot;01 &quot; &amp; Left(Cells(1, 1), 3) &amp; &quot; 19&quot;)</code>and then: <code>If IsError(Test) Then</code> try it like that."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1557940126, "post_id": 56154055, "comment_id": 98938211, "body": "@Damian same mistake as Vityata - see <a href=\"https://stackoverflow.com/questions/56154055/how-do-i-use-iserror-on-a-function-value-instead-of-cell-value/56154425#comment98938183_56154189\">this comment</a>"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1557941783, "post_id": 56154055, "comment_id": 98938915, "body": "You are right @MathieuGuindon"}], "answers": [{"tags": [], "owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "is_accepted": false, "score": 0, "last_activity_date": 1557938785, "creation_date": 1557938785, "answer_id": 56154123, "question_id": 56154055, "link": "https://stackoverflow.com/questions/56154055/how-do-i-use-iserror-on-a-function-value-instead-of-cell-value/56154123#56154123", "title": "How do I use IsError on a function value, instead of cell value?", "body": "<p>IsError() will not catch a type mismatch. You would need to do a run-time error handler to catch an error like that after it's happened.</p>\n\n<p>On the other hand, for this use case you could use IsNumeric() instead of IsError (). I recommend something like this:</p>\n\n<pre><code>If Not (IsNumeric(Left(Cells(1, 1), 3))) Then    \n    MsgBox \"Oops, \" &amp; Left(Cells(1, 1), 3) &amp; \" is not a valid month abbreviation\"   \nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1557940063, "post_id": 56154189, "comment_id": 98938183, "body": "But it won&#39;t: if <code>Cells(1, 1)</code> is a <code>Variant&#47;Error</code>, then <code>Left(Cells(1, 1), 3)</code> is coercing it into a <code>Variant&#47;String</code>, and that&#39;s where the <i>type mismatch</i> error is thrown - well before <code>IsDate</code> gets to even run."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1557940289, "post_id": 56154189, "comment_id": 98938267, "body": "@MathieuGuindon - True, I was only testing the input from the question :)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1557940311, "post_id": 56154189, "comment_id": 98938278, "body": "I think I might have misread the question... I can&#39;t repro the type mismatch given OP&#39;s inputs, I just assumed the type mismatch was caused by a <code>Variant&#47;Error</code> cell somewhere; I do get the error given a cell error for input."}, {"owner": {"reputation": 165, "user_id": 7384402, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/697d533e7cd84e6a727bbc4135bbb444?s=128&d=identicon&r=PG&f=1", "display_name": "sethW", "link": "https://stackoverflow.com/users/7384402/sethw"}, "edited": false, "score": 0, "creation_date": 1557940698, "post_id": 56154189, "comment_id": 98938453, "body": "Apologies on that. The cell will NEVER be <code>Variant&#47;Error</code>, only the result of using the first three characters as a month. So I believe the <code>IsDate()</code> should work."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 165, "user_id": 7384402, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/697d533e7cd84e6a727bbc4135bbb444?s=128&d=identicon&r=PG&f=1", "display_name": "sethW", "link": "https://stackoverflow.com/users/7384402/sethw"}, "edited": false, "score": 0, "creation_date": 1557940790, "post_id": 56154189, "comment_id": 98938496, "body": "@sethW fair enough. note that you should NEVER assume anything about the variant subtype of a cell&#39;s value."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 165, "user_id": 7384402, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/697d533e7cd84e6a727bbc4135bbb444?s=128&d=identicon&r=PG&f=1", "display_name": "sethW", "link": "https://stackoverflow.com/users/7384402/sethw"}, "edited": false, "score": 0, "creation_date": 1557940941, "post_id": 56154189, "comment_id": 98938576, "body": "@sethW apologies, I got confused with <code>IsDate</code> here vs <code>DateValue</code> in the OP - <code>DateValue</code> <i>does</i> throw a type mismatch given non-date inputs. Point stands for variant subtype assumptions though."}, {"owner": {"reputation": 165, "user_id": 7384402, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/697d533e7cd84e6a727bbc4135bbb444?s=128&d=identicon&r=PG&f=1", "display_name": "sethW", "link": "https://stackoverflow.com/users/7384402/sethw"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1557941169, "post_id": 56154189, "comment_id": 98938684, "body": "@MathieuGuindon you&#39;re right. In my efforts to not over-explain, I perhaps left out some clarifications that could have helped. Either way, <code>IsDate()</code> works best for this scenario."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 165, "user_id": 7384402, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/697d533e7cd84e6a727bbc4135bbb444?s=128&d=identicon&r=PG&f=1", "display_name": "sethW", "link": "https://stackoverflow.com/users/7384402/sethw"}, "edited": false, "score": 0, "creation_date": 1557941260, "post_id": 56154189, "comment_id": 98938724, "body": "@sethW no, your post was fine, the reading fail is entirely on me :)"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 3, "last_activity_date": 1557939076, "creation_date": 1557939076, "answer_id": 56154189, "question_id": 56154055, "link": "https://stackoverflow.com/questions/56154055/how-do-i-use-iserror-on-a-function-value-instead-of-cell-value/56154189#56154189", "title": "How do I use IsError on a function value, instead of cell value?", "body": "<p><code>IsDate()</code> is a rather handy function, which should work as intended:</p>\n\n<pre><code>Sub TestMe()\n\n    If IsDate(\"01 \" &amp; Left(Cells(1, 1), 3) &amp; \" 19\") Then\n        Debug.Print \"It is a date!\"\n    Else\n        Debug.Print \"Oops, \" &amp; Left(Cells(1, 1), 3) &amp; \" is not a valid month abbreviation\"\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1557940013, "creation_date": 1557940013, "answer_id": 56154425, "question_id": 56154055, "link": "https://stackoverflow.com/questions/56154055/how-do-i-use-iserror-on-a-function-value-instead-of-cell-value/56154425#56154425", "title": "How do I use IsError on a function value, instead of cell value?", "body": "<p><code>Error</code> is a data type.</p>\n\n<p>The <code>IsError</code> function is used to determine whether a <code>Variant</code> has a variant subtype <code>Error</code>, i.e. whether a given value is a <code>Variant/Error</code>.</p>\n\n<p>In Excel, you get a <code>Variant/Error</code> value when you read a cell containing e.g. <code>#VALUE!</code>. Programmatically, you can get a <code>Variant/Error</code> using the <code>CVErr</code> function together with Excel errors enum values, for example:</p>\n\n<pre><code>Debug.Print IsError(CVErr(xlErrNA)) ' #N/A cell error\n</code></pre>\n\n<p>The problem in this expression:</p>\n\n<blockquote>\n<pre><code>If IsError(DateValue(\"01 \" &amp; Left(Cells(1, 1), 3) &amp; \" 19\")) = True Then\n</code></pre>\n</blockquote>\n\n<p>..is that <code>IsError</code> is given a <code>Date</code>, so the function will always return <code>False</code> (<code>= True</code> is redundant).</p>\n\n<p>But <code>IsError</code> doesn't even get to be evaluated: its arguments need to be evaluated first, and that's where the <em>type mismatch</em> error is:</p>\n\n<pre><code>Left(Cells(1, 1), 3)\n</code></pre>\n\n<p>If <code>Cells(1, 1)</code> contains a <code>Variant/Error</code> value, then coercing it into a <code>String</code> throws the <em>type mismatch</em> error that you're getting, because an <code>Error</code> can't be implicitly (or explicitly) converted to any other data type.</p>\n\n<p>The solution is to pull <code>Cells(1, 1)</code> into its own local <code>Variant</code> variable:</p>\n\n<pre><code>Dim cellValue As Variant\ncellValue = ActiveSheet.Cells(1, 1).Value 'note: made qualifier and member call explicit\n</code></pre>\n\n<p>Then you can evaluate whether that value is an <code>Error</code>:</p>\n\n<pre><code>If Not IsError(cellValue) Then\n    If IsDate(\"01 \" &amp; Left(cellValue, 3) &amp; \" 19\") Then\n        ' we're looking at a valid date value that VBA can convert to a Date data type\n    Else\n        ' we're looking at a malformed date\n    End If\nElse\n    ' cellValue is a Variant/Error that we can't use.\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 165, "user_id": 7384402, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/697d533e7cd84e6a727bbc4135bbb444?s=128&d=identicon&r=PG&f=1", "display_name": "sethW", "link": "https://stackoverflow.com/users/7384402/sethw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 56154189, "answer_count": 3, "score": 3, "last_activity_date": 1557940013, "creation_date": 1557938460, "last_edit_date": 1557939615, "question_id": 56154055, "link": "https://stackoverflow.com/questions/56154055/how-do-i-use-iserror-on-a-function-value-instead-of-cell-value", "title": "How do I use IsError on a function value, instead of cell value?", "body": "<p>I have a column in a sheet with unformatted date values. There are three types, always leading off with the month abbreviation:</p>\n\n<pre><code>JAN/19\nJAN02/19\nJAN19\n</code></pre>\n\n<p>I'm writing a macro to loop through the column and format these as dates. <code>JAN/19</code> and <code>JAN19</code> will both just be set to the first day of the month, whereas <code>JAN02/19</code> will be set as <code>01/02/19</code>.</p>\n\n<p>In order to error handle for column headings and potential blank rows at the top, I want to take the left three characters and see if they are a month abbreviation. I'm trying to use the below code:</p>\n\n<pre><code>If IsError(DateValue(\"01 \" &amp; Left(Cells(1, 1), 3) &amp; \" 19\")) = True Then\n\n     MsgBox \"Oops, \" &amp; Left(Cells(1, 1), 3) &amp; \" is not a valid month abbreviation\"\n\nEnd If\n</code></pre>\n\n<p>It skips the message box if <code>Left(Cells(1, 1), 3)</code> is a valid month abbreviation, but then gives this error if it isn't, instead of the <code>MsgBox</code> message.</p>\n\n<p><a href=\"https://i.stack.imgur.com/DeNS9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DeNS9.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 173, "user_id": 1719890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd25513c710f5a3d0d21b5dc195d6621?s=128&d=identicon&r=PG", "display_name": "Jitendra Singh", "link": "https://stackoverflow.com/users/1719890/jitendra-singh"}, "is_accepted": true, "score": 1, "last_activity_date": 1612140990, "last_edit_date": 1612140990, "creation_date": 1557938701, "answer_id": 56154096, "question_id": 56153824, "link": "https://stackoverflow.com/questions/56153824/search-a-text-inside-a-table-in-a-word-document-and-replace-it-with-an-image/56154096#56154096", "title": "search a text inside a table in a Word document and replace it with an image", "body": "<p>This should work for you. Lookig at your code,</p>\n<ul>\n<li>I see that this tag will always be present inside of a table. <strong>&quot;.Information(wdWithInTable)&quot;</strong></li>\n<li>I also changed <strong>'split'</strong> to <strong>'replace'</strong> to avoid playing with indexes.</li>\n<li>You were <strong>missing</strong> the <strong>file extension</strong> in your image code so <strong>replace</strong> <strong>'.png'</strong> with whatever format of image you have</li>\n</ul>\n<pre><code>Sub Demo()\nDim StrOut As String\nWith ActiveDocument.Range\n  With .Find\n    .ClearFormatting\n    .Replacement.ClearFormatting\n    .Text = &quot;\\&lt;tag\\&gt;*\\&lt;/tag\\&gt;&quot;\n    .Replacement.Text = &quot;&quot;\n    .Forward = True\n    .Wrap = wdFindStop\n    .Format = False\n    .MatchWildcards = True\n    .Execute\n  End With\n  Do While .Find.Found\n    If .Information(wdWithInTable) = True Then\n      StrOut = Replace(Replace(.Text, &quot;&lt;tag&gt;&quot;, &quot;&quot;), &quot;&lt;/tag&gt;&quot;, &quot;&quot;)\n    End If\n    .Collapse wdCollapseEnd\n    ' the following line yields &quot;Run-time error 9&quot;\n    .InlineShapes.AddPicture FileName:= _\n    &quot;C:\\Users\\xyz\\&quot; &amp; StrOut + &quot;.png&quot;, LinkToFile:=False _\n    , SaveWithDocument:=True\n    .Text = &quot;&quot;\n    .Find.Execute\n  Loop\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3218, "user_id": 268721, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/377b60db3c8bf7ffc68f52330a58b4b2?s=128&d=identicon&r=PG", "display_name": "tic", "link": "https://stackoverflow.com/users/268721/tic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 56154096, "answer_count": 1, "score": 0, "last_activity_date": 1612140990, "creation_date": 1557937585, "question_id": 56153824, "link": "https://stackoverflow.com/questions/56153824/search-a-text-inside-a-table-in-a-word-document-and-replace-it-with-an-image", "title": "search a text inside a table in a Word document and replace it with an image", "body": "<p>I need to replace each occurrence of <code>&lt;tag&gt;filename123&lt;/tag&gt;</code> inside a table in a Word document with the image <code>D:\\images\\filename123.jpg</code> (every tag content is different).\nI use the following code, copied from another <a href=\"https://stackoverflow.com/a/56139762/268721\">answer</a>, which does well the search command but I'm unable to make the replace line working. What's wrong?</p>\n\n<pre><code>Sub Demo()\nDim StrOut As String\nWith ActiveDocument.Range\n  With .Find\n    .ClearFormatting\n    .Replacement.ClearFormatting\n    .Text = \"\\&lt;tag\\&gt;*\\&lt;/tag\\&gt;\"\n    .Replacement.Text = \"\"\n    .Forward = True\n    .Wrap = wdFindStop\n    .Format = False\n    .MatchWildcards = True\n    .Execute\n  End With\n  Do While .Find.Found\n    If .Information(wdWithInTable) = True Then\n      StrOut = Split(Split(.Text, \"&gt;\")(1), \"&lt;\")(0)\n    End If\n    .Collapse wdCollapseEnd\n    ' the following line yields \"Run-time error 9\"\n    .InlineShapes.AddPicture FileName:= _\n    \"D:\\images\\\" &amp; StrOut, LinkToFile:=False _\n    , SaveWithDocument:=True\n    .Text = \"\"\n    .Find.Execute\n  Loop\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "batch-file", "excel-formula"], "comments": [{"owner": {"reputation": 1113, "user_id": 11059320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MCWZp.jpg?s=128&g=1", "display_name": "shadow2020", "link": "https://stackoverflow.com/users/11059320/shadow2020"}, "edited": false, "score": 0, "creation_date": 1557938413, "post_id": 56153626, "comment_id": 98937400, "body": "Sorry this isn&#39;t a duplicate. That did not fix my issue. The post below fixes it. Can we please unmark as a duplicate. the !VALUE# are supposed to be there, I just wanted to ignore them."}], "answers": [{"comments": [{"owner": {"reputation": 1113, "user_id": 11059320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MCWZp.jpg?s=128&g=1", "display_name": "shadow2020", "link": "https://stackoverflow.com/users/11059320/shadow2020"}, "edited": false, "score": 0, "creation_date": 1557938669, "post_id": 56153741, "comment_id": 98937534, "body": "Thank you sir, you are a star."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1557937291, "creation_date": 1557937291, "answer_id": 56153741, "question_id": 56153626, "link": "https://stackoverflow.com/questions/56153626/getting-around-vba-type-mismatch-for-bat-generated-in-excel/56153741#56153741", "title": "Getting around VBA type mismatch for .Bat generated in Excel", "body": "<p>You can check for errors and only use the \"good\" rows:</p>\n\n<pre><code>Dim v As Variant\n\n'....\n'....\n\n'when you already know the start and end values, use For...Next\nfor rownum = 1 to LastRow\n\n    v = targetSheet.Cells(RowNum, ColumnNum).Value\n\n    If Not IsError(v) Then  '&lt;&lt; skip any errors\n        If Len(v) &gt; 0 Then  '&lt;&lt; skip empty values\n            OutputString = OutputString &amp; Replace(v, Chr(10), vbNewLine) &amp; vbNewLine\n        End If\n    End If\n\nNext RowNum\n</code></pre>\n"}], "owner": {"reputation": 1113, "user_id": 11059320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MCWZp.jpg?s=128&g=1", "display_name": "shadow2020", "link": "https://stackoverflow.com/users/11059320/shadow2020"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 56153741, "answer_count": 1, "score": 2, "last_activity_date": 1557987554, "creation_date": 1557936754, "last_edit_date": 1557987554, "question_id": 56153626, "link": "https://stackoverflow.com/questions/56153626/getting-around-vba-type-mismatch-for-bat-generated-in-excel", "title": "Getting around VBA type mismatch for .Bat generated in Excel", "body": "<p>I have a spreadsheet that I enter data into. Filenames, and times and lots of info that in the end, generates a windows batch file. </p>\n\n<p>Image of end result of my excel formulas\nText representation of end result of my excel formulas</p>\n\n<pre><code>Column-I                Column-J                        Column-K\necho f | xcopy /f /y    \\\\server123\\data\\3838383.398    %userprofile%\\Desktop\\VT\\3838383.398\necho f | xcopy /f /y    \\\\server123\\data\\3838384.398    %userprofile%\\Desktop\\VT\\3838384.398\necho f | xcopy /f /y    \\\\server123\\data\\3838385.398    %userprofile%\\Desktop\\VT\\3838385.398\n</code></pre>\n\n<p>With that said, I have about 30 lines I enter info into. Sometimes I only need 1 line. When I do that, the remaining 29 lines are filled with #VALUE!. So it looks like this (below) when I only have 1 line of data put into the spreadsheet.</p>\n\n<pre><code>Column-I                   Column-J                    Column-K\necho f | xcopy /f /y    \\\\server123\\data\\3838383.398   %userprofile%\\Desktop\\VT\\3838383.398\necho f | xcopy /f /y       #VALUE!                      #VALUE!\necho f | xcopy /f /y       #VALUE!                      #VALUE!\necho f | xcopy /f /y       #VALUE!                      #VALUE!\n</code></pre>\n\n<p>I then use this formula to concatenate the columns I, J, K into column Z <code>=CONCATENATE(I5,J5,\" \",K5)</code></p>\n\n<p>This is where the magic happens, I have a macro that converts whatever is found in column Z into a windows .bat file. Here is the code for that: </p>\n\n<pre><code>Sub Send2Bat()\n\nDim ColumnNum: ColumnNum = 26   ' Column Z - I have the I J and K Columns concatenated there.\nDim RowNum: RowNum = 0\nDim objFSO, objFile\nDim openBat As Object\n\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\nSet objFile = objFSO.CreateTextFile(\"C:\\Users\\UserProfile\\Desktop\\VT\\Batch Files\\Convert.bat\")    'Output Path\naFile = \"C:\\Users\\UserProfile\\Desktop\\VT\\Batch Files\\\"\n\nDim OutputString: OutputString = \"\"\nDim targetSheet As Worksheet\nSet targetSheet = Application.Worksheets(\"ForBatchFile\")\n\nDim LastRow: LastRow = targetSheet.Cells(targetSheet.Rows.Count, ColumnNum).End(xlUp).Row\n\nDo\n\n    RowNum = RowNum + 1\n\n    If Not (IsEmpty(targetSheet.Cells(RowNum, ColumnNum).Value)) Then\n\n        OutputString = OutputString &amp; Replace(targetSheet.Cells(RowNum, ColumnNum).Value, Chr(10), vbNewLine) &amp; vbNewLine\n\n    End If\n\nLoop Until RowNum = LastRow\n\nobjFile.Write (OutputString)\n\n  Set openBat = CreateObject(\"Shell.Application\")\n  openBat.Open (aFile)\n\nSet objFile = Nothing\nSet objFSO = Nothing\n\n\n\nEnd Sub\n</code></pre>\n\n<p>When I have all 30 of my lines filled out, everything works perfectly. My problem is when I do not and some of the cells contain the <code>#VALUE!</code> in them, it does not output the .bat file. I get a \"Run-time error '13': type mismatch\" error. This is somewhat expected because it's the spreadsheet concatenates all kinds of stuff with dates, text, and general formats. What I would like to know is... how can I change my macro so that it only processes the lines I need without erroring out. I've tried making my variables variant types to see if that helped, of course it did not. Furthermore, how could I handle the errors and just skip lines where the type mismatch is detected? I hope this is enough details, thanks to anybody who looks at this. </p>\n"}, {"tags": ["vba", "ms-access", "listbox", "ms-access-forms"], "answers": [{"tags": [], "owner": {"reputation": 114574, "user_id": 10498828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1360dd652f1e970ba098d1d5b63c14d?s=128&d=identicon&r=PG&f=1", "display_name": "forpas", "link": "https://stackoverflow.com/users/10498828/forpas"}, "is_accepted": true, "score": 1, "last_activity_date": 1557937675, "creation_date": 1557937675, "answer_id": 56153839, "question_id": 56153597, "link": "https://stackoverflow.com/questions/56153597/problem-with-display-currency-in-listbox-on-ms-access/56153839#56153839", "title": "Problem with display currency in Listbox on MS-Access", "body": "<p>Enclose the value between double quotes (ASCII code 34):</p>\n\n<pre><code>.....&amp; \";\" &amp; Chr(34) &amp; format(tPricing,\"Currency\") &amp; Chr(34))\n</code></pre>\n"}], "owner": {"reputation": 258, "user_id": 6348445, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-X6CAwCGEuIM/AAAAAAAAAAI/AAAAAAAAACY/ZmW2Kus0yoM/photo.jpg?sz=128", "display_name": "Ants", "link": "https://stackoverflow.com/users/6348445/ants"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 56153839, "answer_count": 1, "score": 1, "last_activity_date": 1594779352, "creation_date": 1557936650, "last_edit_date": 1594779352, "question_id": 56153597, "link": "https://stackoverflow.com/questions/56153597/problem-with-display-currency-in-listbox-on-ms-access", "title": "Problem with display currency in Listbox on MS-Access", "body": "<p>Any time the listbox in MS-Access receives data, it will automatically consider commas, semi-colons or other types of delimiters and separate the values into columns within the listbox.</p>\n\n<p>Therefore, when I format the values to currency the comma it finds in <code>$2,000</code> (for example) gets delimited to <code>$2</code> (in column 1) and <code>000</code> (in column 2).</p>\n\n<p>I did set column count to 4, so I see why it is doing that but there must be a different way...</p>\n\n<p>I set the column count to 4 because I have 4 values that I want displayed in the list box.</p>\n\n<pre><code>List40.ColumnCount = 4\nList40.AddItem (strProduct &amp; \";\" &amp; mQty &amp; \";\" &amp; format(uPricing,\"Currency\") &amp; \";\" &amp; format(tPricing,\"Currency\"))\n</code></pre>\n\n<p>In summary I expect my list to look like this</p>\n\n<pre><code>+---------+----------+-----------+-----------+\n| PRODUCT | QUANTITY | UNITPRICE | TOTALCOST |\n+---------+----------+-----------+-----------+\n| abc     |        5 | $500.00   | $2,500.00 |\n+---------+----------+-----------+-----------+\n</code></pre>\n\n<p>Instead I see:   </p>\n\n<pre><code>+---------+----------+-----------+-----------+\n| PRODUCT | QUANTITY | UNITPRICE | TOTALCOST |\n+---------+----------+-----------+-----------+\n| abc     |        5 | $500.00   | $2        |\n+---------+----------+-----------+-----------+\n</code></pre>\n"}, {"tags": ["excel", "vba", "powerpoint"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1557936270, "post_id": 56153442, "comment_id": 98936416, "body": "Doesn&#39;t seem like you need 2 loops here, or <code>PPProgram</code> for that matter. Why not just save inside one main loop?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1557939605, "post_id": 56153442, "comment_id": 98937969, "body": "I think it has to do with the fact that you&#39;re closing the presentation after saving it - similar to how you need to loop backwards when deleting rows in Excel. It saves the first PowerPoint, then your <code>CurOpenPresentation</code> becomes PowerPoint2, then your loop moves to 3 and you never save 2, 4, 6... etc."}, {"owner": {"reputation": 200, "user_id": 9921408, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5QwXcZu7LNQ/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3L5hJoKezJqIl_na0GKDprd0BKiw/mo/photo.jpg?sz=128", "display_name": "Ciaran O Brien", "link": "https://stackoverflow.com/users/9921408/ciaran-o-brien"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1557994854, "post_id": 56153442, "comment_id": 98955195, "body": "@dwirony I don&#39;t quite understand how this is the case seen as the save and close are within the loop, but removing the line where I close the PowerPoint does indeed fix this problem. Thank you."}], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 2, "last_activity_date": 1557944380, "creation_date": 1557944380, "answer_id": 56155454, "question_id": 56153442, "link": "https://stackoverflow.com/questions/56153442/vba-is-only-saving-every-second-open-powerpoint-presentation/56155454#56155454", "title": "VBA is only saving every second open PowerPoint presentation", "body": "<p>You already have <code>PPApp</code> as a PowerPoint application object - continue using that and take out the lines defining <code>PPProgram</code>. </p>\n\n<p>Also, declare and instantiate an object for the presentation being added:</p>\n\n<pre><code>Dim PPPres as Object\nSet PPPres = PPApp.Presentations.Add\n</code></pre>\n\n<p>After that, use <code>PPPres</code> to work with the presentation</p>\n\n<pre><code>PPPres.Slides.Add PPPres.Slides.Count + 1, ppLayoutBlank\nPPApp.ActiveWindow.View.GotoSlide PPPres.Slides.Count\n</code></pre>\n\n<p>This also means the loop is not needed to save and close the presentation</p>\n\n<pre><code> PPPres.SaveAs path &amp; \"\\\" &amp; PPPres.FullName &amp; \".pptx\"\n Application.Wait (Now + #12:00:03 AM#) ' Wait 3 seconds to allow the computer time to save the file before it closes it\n PPPres.Close\n</code></pre>\n\n<p>It's also a good idea to explicitly release these objects before <code>End Sub</code>:</p>\n\n<pre><code>Set PPPres = Nothing\nSet PPApp = Nothing\n</code></pre>\n\n<p>If you want to always use <code>CreateObject</code> for each presentation, then the code should also <code>Quit</code> the PowerPoint application <em>before</em> setting it to Nothing. Alternatively, the code could check for the presence of PowerPoint using <code>GetObject</code> and only if it's not running use <code>CreateObject</code> to start it. There are plenty of code examples around that show how to do that.</p>\n"}, {"comments": [{"owner": {"reputation": 200, "user_id": 9921408, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5QwXcZu7LNQ/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3L5hJoKezJqIl_na0GKDprd0BKiw/mo/photo.jpg?sz=128", "display_name": "Ciaran O Brien", "link": "https://stackoverflow.com/users/9921408/ciaran-o-brien"}, "edited": false, "score": 0, "creation_date": 1558193165, "post_id": 56172278, "comment_id": 99023627, "body": "Gotcha. Thank you very much for your help. I would have never spotted that."}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": true, "score": 2, "last_activity_date": 1558021559, "creation_date": 1558021559, "answer_id": 56172278, "question_id": 56153442, "link": "https://stackoverflow.com/questions/56153442/vba-is-only-saving-every-second-open-powerpoint-presentation/56172278#56172278", "title": "VBA is only saving every second open PowerPoint presentation", "body": "<p>Let me further explain the original issue:</p>\n\n<p>Let's say you have 30 open PowerPoint presentations. You start a <code>For</code> loop to iterate through all 30. On the first iteration, your <code>CurOpenPresentation</code> (the first item in your collection of 30) is PowerPoint1. You save it to a location and close it. </p>\n\n<p>Now you have a collection of <strong>29 open PowerPoint presentations</strong>, and your <code>CurOpenPresentation</code> is now PowerPoint2 because PowerPoint1 doesn't exist in the scope anymore since you've closed it. Now you hit the <code>Next CurOpenPresentation</code> line and move from PowerPoint2 to PowerPoint3 without ever saving PowerPoint2. </p>\n\n<p>That's why you're only saving 1, 3, 5, etc. :)</p>\n"}], "owner": {"reputation": 200, "user_id": 9921408, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5QwXcZu7LNQ/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3L5hJoKezJqIl_na0GKDprd0BKiw/mo/photo.jpg?sz=128", "display_name": "Ciaran O Brien", "link": "https://stackoverflow.com/users/9921408/ciaran-o-brien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 56172278, "answer_count": 2, "score": 2, "last_activity_date": 1558021559, "creation_date": 1557935987, "last_edit_date": 1557945009, "question_id": 56153442, "link": "https://stackoverflow.com/questions/56153442/vba-is-only-saving-every-second-open-powerpoint-presentation", "title": "VBA is only saving every second open PowerPoint presentation", "body": "<p>I have 31 graphs in an Excel file which need to be exported to their own individual PowerPoint file and the subsequent 31 PowerPoint presentations should then be saved. </p>\n\n<p>Running the below code, all graphs are successfully exported to individual presentations; however, only every second presentation (PowerPoint1, PowerPoint3, PowerPoint5 etc.) is saved as a file down my machine. Any idea why? </p>\n\n<p>Note: the 'path' variable was defined earlier in the code when the user was given the option to select their own path.</p>\n\n<p>Any guidance is appreciated.</p>\n\n<pre><code>Const ppLayoutBlank = 2\nConst ppViewSlide = 1\nConst ppFixedFormatTypePDF As Long = 2\nConst ppPrintSelection As Long = 2\nOption Explicit\n\nSub ExportChartstoPowerPoint()\n\n'\n' Code to allow user to choose path goes here\n'\n\nDim chr\nFor Each chr In Sheets(\"My Excel File\").ChartObjects\n    Dim PPApp As Object\n    Set PPApp = CreateObject(\"PowerPoint.Application\")\n    PPApp.Presentations.Add\n    PPApp.ActiveWindow.ViewType = ppViewSlide\n    PPApp.ActivePresentation.Slides.Add PPApp.ActivePresentation.Slides.Count + 1, ppLayoutBlank\n    PPApp.ActiveWindow.View.GotoSlide PPApp.ActivePresentation.Slides.Count\n    chr.Select\n    ActiveChart.CopyPicture Appearance:=xlScreen, Size:=xlScreen, Format:=xlPicture\n    PPApp.ActiveWindow.View.Paste\n    PPApp.ActiveWindow.Selection.ShapeRange.Align msoAlignCenters, True\n    PPApp.ActiveWindow.Selection.ShapeRange.Align msoAlignMiddles, True\nNext chr\nPPApp.Visible = True\n\nDim CurOpenPresentation As Object\nDim PPProgram As Object\nSet PPProgram = GetObject(, \"PowerPoint.Application\")\nFor Each CurOpenPresentation In PPProgram.Presentations\n      CurOpenPresentation.SaveAs path &amp; \"\\\" &amp; CurOpenPresentation.FullName &amp; \".pptx\"\n      Application.Wait (Now + #12:00:03 AM#) ' Wait 3 seconds to allow the computer time to save the file before it closes it\n      CurOpenPresentation.Close\nNext CurOpenPresentation\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1557944572, "post_id": 56153414, "comment_id": 98940138, "body": "Please take a moment to read the site guidelines about asking questions in the <a href=\"https://stackoverflow.com/help\">help center</a>. The site rule is one question / Question. There are two good reasons for this 1) No single person may know the answers to multiple question and 2) The site concept is Q&amp;A - it&#39;s not a discussion forum. As it stands, this question is &quot;too broad&quot;. You can use the <a href=\"https://stackoverflow.com/posts/56153414/edit\">edit</a> link below the question to change its content so that it complies with the site rules."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1557944665, "post_id": 56153414, "comment_id": 98940176, "body": "Also, when tagging a question be sure to read the infomation shown when a tag is typed. The tag <code>access</code> is <b><i>not</i></b> for Microsoft Access and <code>macros</code> are explicitly <i>not</i> for coding in Office applications. If you don&#39;t tag correctly, the right people won&#39;t see the question."}], "answers": [{"tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": false, "score": 0, "last_activity_date": 1557941092, "creation_date": 1557941092, "answer_id": 56154687, "question_id": 56153414, "link": "https://stackoverflow.com/questions/56153414/auto-exporting-reports-in-microsoft-access/56154687#56154687", "title": "Auto-exporting reports in Microsoft Access", "body": "<p>In response to:</p>\n\n<blockquote>\n  <p>One: how to get Fridays date/yesterdays date and then set the vars to that.</p>\n</blockquote>\n\n<p>To calculate the date of the previous working day (not accounting for bank holidays), you could use a function such as the following:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function LastWorkingDay() As Date\n    Dim i As Integer: i = Weekday(Date, vbSaturday)\n    If i &gt; 3 Then i = 1\n    LastWorkingDay = DateAdd(\"d\", -i, Date)\nEnd Function\n</code></pre>\n\n<p>If the above is evaluated on a Saturday, Sunday or Monday, it will return the date of the previous Friday, else on any other day it will return the previous weekday.</p>\n\n<p>e.g. if run today (<code>Wednesday 2019-05-15</code>):</p>\n\n<pre><code>?LastWorkingDay\n14/05/2019 \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 11505213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0553dc49752058b5a8b849487e3c5f2a?s=128&d=identicon&r=PG&f=1", "display_name": "tomf85", "link": "https://stackoverflow.com/users/11505213/tomf85"}, "edited": false, "score": 0, "creation_date": 1557950779, "post_id": 56155985, "comment_id": 98942815, "body": "Ok is see what your saying instead of trying to run it in a loop if could just plug in the  para and each one has its own number, So then the para var would i change the &quot; BEGdate = #LastWorkDay# And ENDdate = #LastWorkingDay# ?"}], "tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": false, "score": 0, "last_activity_date": 1557946574, "creation_date": 1557946574, "answer_id": 56155985, "question_id": 56153414, "link": "https://stackoverflow.com/questions/56153414/auto-exporting-reports-in-microsoft-access/56155985#56155985", "title": "Auto-exporting reports in Microsoft Access", "body": "<p>The last work day can be found like this (assuming the code will only run Mon-Fri and not on weekends):</p>\n\n<pre><code>LastWorkDay=DateAdd(\"d\",IIF(Weekday(Date)=vbMonday,-3,-1),Date())\n</code></pre>\n\n<p>To run the export for two or more different sets of parameters you have two options:</p>\n\n<ol>\n<li><p>Different export files:\n<code>\nDoCmd.openReport reportName, acViewPreview, para_1 ,acHidden \nDoCmd.OutputTo acOutputReport, reportName, acFormatPDF, filename_1\nDocmd.Close acReport, reportName, acSaveno\nDoCmd.openReport reportName, acViewPreview, para_2 ,acHidden\nDoCmd.OutputTo acOutputReport, reportName, acFormatPDF, filename_2\nDocmd.Close acReport, reportName, acSaveno\n</code></p></li>\n<li><p>Create the report in such a way that each set of parameters is a section that starts on a new page, then set up your parameters to include all sets you want to export. For example:</p></li>\n</ol>\n\n<p><code>\npara = \"Forman IN ('Tom',Dick','Harry') AND BEGdate = 'BEGdateVaule' AND ENDdate = 'ENDdateVaule'\"\n</code></p>\n\n<p>This may require re-design of the report(s) that is being exported.</p>\n\n<p>Also, your dates should be actual dates and therefore enclosed in <code>#</code> not single quotes.</p>\n"}], "owner": {"reputation": 1, "user_id": 11505213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0553dc49752058b5a8b849487e3c5f2a?s=128&d=identicon&r=PG&f=1", "display_name": "tomf85", "link": "https://stackoverflow.com/users/11505213/tomf85"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1557946574, "creation_date": 1557935902, "last_edit_date": 1557944416, "question_id": 56153414, "link": "https://stackoverflow.com/questions/56153414/auto-exporting-reports-in-microsoft-access", "title": "Auto-exporting reports in Microsoft Access", "body": "<p>Hi all i'm a system admin just trying to automate some reports that i have to run every morning. I have first locate the report which there are many and then i have to open it feed it the date from yesterday unless it is Monday then i have to use the date from the last working day which is usually Friday. Now i can get the reports to export using the docmd.</p>\n\n<p>But what i can figure out is how to pass it some params</p>\n\n<p>So what i'm thinking that it needs to do is something like this.</p>\n\n<pre><code>Dim reportName As String  \nDim fileName As String  \nDim para As String  \n\nreportName = \"dailyReports\"  \nfileName = \"C:\\reports\\report.pdf\"  \nformanName = \"\"  \nBEGdateVaule = \"\"  \nENDdateVaule = \"\"  \npara = \"Forman = 'formanName' AND BEGdate = 'BEGdateVaule' AND ENDdate = 'ENDdateVaule'\"\n\n## if it is Monday then figure out Fridays date\n\nif (weekday(Now()= 2)[  \nset date to Fridays  \n    for %%x in (  \n        formanName = \"Tom\"  \n        formanName = \"Dick\"  \n        formanName = \"Harry\"   \n        )do(  \nrun Sub  \n)  \n## if it is tues then figure out mondays date\nect . . \n\nSub   \nDoCmd.openReport reportName, acViewPreview, para ,acHidden\nDoCmd.OutputTo acOutputReport, reportName, acFormatPDF, fileName\nDocmd.Close acReport, reportName, acSaveno  \nend sub  \n</code></pre>\n\n<p>So i think i'm on the right track but there are two things that i can figure out;</p>\n\n<p>One: how to get Fridays date/yesterdays date and then set the vars to that.<br>\nTwo: how to run the code for different formans so each on gets an export of the file by that date.</p>\n\n<p>I'm new to coding but i'm a fast study any direction here would be awesome. </p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1558214903, "creation_date": 1558214903, "answer_id": 56202986, "question_id": 56152701, "link": "https://stackoverflow.com/questions/56152701/how-to-choose-the-signature-automaticaly/56202986#56202986", "title": "How to choose the signature automaticaly?", "body": "<p>Signatures are not exposed in the Outlook Object Model at all - it would be your  responsibility to parse the HTML signature, figure out the images used, add them as attachments, set the content-id on the attachments, then modify the signature's HTML to refer to those attachment images through the content ids. You would also need to merge the HTML styles of the existing message body and the signature.</p>\n\n<p>If using <a href=\"http://www.dimastr.com/redemption\" rel=\"nofollow noreferrer\">Redemption</a> is an option, it exposes the <a href=\"http://www.dimastr.com/redemption/rdosignature.htm\" rel=\"nofollow noreferrer\">RDOSignature</a>.<code>ApplyTo</code>, which would insert the given signature into a message.</p>\n"}], "owner": {"reputation": 187, "user_id": 5112449, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLhPsCK2oQg/AAAAAAAAAAI/AAAAAAAAABs/CYy3w4tb5FI/photo.jpg?sz=128", "display_name": "David Con", "link": "https://stackoverflow.com/users/5112449/david-con"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 56202986, "answer_count": 1, "score": 1, "last_activity_date": 1592464385, "creation_date": 1557933395, "last_edit_date": 1592464385, "question_id": 56152701, "link": "https://stackoverflow.com/questions/56152701/how-to-choose-the-signature-automaticaly", "title": "How to choose the signature automaticaly?", "body": "<p>I have several signatures in html format. I need to choose one of the signatures according to the domain included in To: and CC: label.</p>\n\n<p>The code below merges the content of one file to the body of the mail.</p>\n\n<p>There are some images in the signature file .</p>\n\n<p>When I use </p>\n\n<pre><code>Set xTextStream = xFSO.OpenTextFile(xSignatureFile)\nxSignature = xTextStream.ReadAll\n</code></pre>\n\n<p>the images aren't included in the mail.</p>\n\n<p>What can I use to include images in the mail?</p>\n\n<pre><code>Private Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\nDim xMailItem As MailItem\nDim xRecipients As Recipients\nDim xRecipient As Recipient\nDim xRcpAddress As String\nDim xSignatureFile, xSignaturePath As String\nDim xFSO As Scripting.FileSystemObject\nDim xTextStream As Scripting.TextStream\nDim xSignature As String\nOn Error Resume Next\nSet xFSO = New Scripting.FileSystemObject\nIf Item.Class &lt;&gt; olMail Then Exit Sub\nSet xMailItem = Item\nSet xRecipients = xMailItem.Recipients\nxSignaturePath = CreateObject(\"WScript.Shell\").SpecialFolders(5) + \"\\Microsoft\\Signatures\\\"\nFor Each xRecipient In xRecipients\n\u00a0\u00a0\u00a0\u00a0xRcpAddress = xRecipient.Address\n\u00a0\u00a0\u00a0\u00a0Select Case xRcpAddress\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Case \"Email Address 1\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0xSignatureFile = xSignaturePath &amp; \"aaa.htm\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Exit For\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Case \"Email Address 2\", \"Email Address 3\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0xSignatureFile = xSignaturePath &amp; \"bbb.htm\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Exit For\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Case \"Email Address 4\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0xSignatureFile = xSignaturePath &amp; \"ccc.htm\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Exit For\n\u00a0\u00a0\u00a0\u00a0End Select\nNext\nSet xTextStream = xFSO.OpenTextFile(xSignatureFile)\nxSignature = xTextStream.ReadAll\nxMailItem.HTMLBody = xMailItem.HTMLBody &amp; \"\" &amp; xSignature &amp; \"\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "dependency-injection", "inversion-of-control", "ioc-container", "rubberduck"], "comments": [{"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 3, "creation_date": 1557933971, "post_id": 56152669, "comment_id": 98935099, "body": "First things first. Solve the problem of doing the equivalent of <code>CreateObject(&quot;MyVBAClass&quot;)</code> then you can start working on VBA IoC. That currently is a nontrivial problem."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 4, "creation_date": 1557935319, "post_id": 56152669, "comment_id": 98935883, "body": "Side note, I love seeing the <a href=\"https://stackoverflow.com/questions/tagged/dependency-injection\">dependency-injection</a> tag on the same post as the <a href=\"https://stackoverflow.com/questions/tagged/vba\">vba</a> tag on SO."}], "answers": [{"comments": [{"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 1, "creation_date": 1557935701, "post_id": 56153187, "comment_id": 98936087, "body": "I probably would add that this might be also a scenario where having a C# COM DLL to support additional work would be a good way to move forward. We don&#39;t have to scrap all the investments but use C# DLL to support the functionalities that are easier done in a .NET environment while providing all the capabilities you need in your current application. There are ways to xcopy deployment your C# COM DLL without any registrations."}, {"owner": {"reputation": 501, "user_id": 1259598, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e9e2654aad3d70595a49575320defb2b?s=128&d=identicon&r=PG&f=1", "display_name": "schwarz", "link": "https://stackoverflow.com/users/1259598/schwarz"}, "reply_to_user": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 0, "creation_date": 1557990491, "post_id": 56153187, "comment_id": 98952837, "body": "@this, since I started with VBA, that is what I have been noticing too...you do the bare minimum in VBA and pass on as much as possible to C# :P"}, {"owner": {"reputation": 501, "user_id": 1259598, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e9e2654aad3d70595a49575320defb2b?s=128&d=identicon&r=PG&f=1", "display_name": "schwarz", "link": "https://stackoverflow.com/users/1259598/schwarz"}, "edited": false, "score": 0, "creation_date": 1557990807, "post_id": 56153187, "comment_id": 98953010, "body": "Right then! @Mathieu Guindon, I will go for the poor man&#39;s DI like you suggested. IoC container does make sense for us but the point is, for us VBA is at the customer side. We do things in C++ or C#. But it was a cool idea to provide customers with interfaces + IoC to switch things with a change in some config file or something along those lines!"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 4, "last_activity_date": 1557935275, "last_edit_date": 1557935275, "creation_date": 1557935041, "answer_id": 56153187, "question_id": 56152669, "link": "https://stackoverflow.com/questions/56152669/ioc-container-for-vba/56153187#56153187", "title": "IoC container for VBA", "body": "<p>That's the literal <em>Holy Grail</em> we've been chasing all along: the ability to instantiate a VBA class in-process, from C# code. The minute we figure out how to do this, an IoC container for VBA code becomes a definite possibility, and would absolutely ship with Rubberduck along with a full-blown <a href=\"https://github.com/rubberduck-vba/Rubberduck/pull/4681\" rel=\"nofollow noreferrer\">mocking framework</a>.</p>\n\n<p>A VBA solution is probably not possible, since as @this alluded to, <code>New</code>ing up a class instance dynamically without a type system and without reflection, ...is pure black magic wizardry.</p>\n\n<p>Setting aside the technical issues, one has to wonder: would an IoC container make such a huge difference?</p>\n\n<p>The truth is, it wouldn't. Dependency Injection <a href=\"https://github.com/rubberduck-vba/Battleship/blob/master/src/Macros.bas#L9-L18\" rel=\"nofollow noreferrer\">doesn't need an IoC container</a>, \"Poor Man's DI\" works perfectly fine and, I may add, is even preferable.</p>\n\n<p>I submit that if you've reached the point where an IoC container makes sense for your VBA project and you understand everything about DI and SOLID and write your code accordingly... then [not to take anything away from VBA but] my assessment is that you're completely beyond ready to move on from VBA and work with more OOP-capable languages, such as VB.NET or C# - and use everything you've learned about OOP in VBA while discovering a whole new range of possibilities through parameterized constructors, class inheritance, delegates, lambdas, LINQ, and so many other things.</p>\n"}], "owner": {"reputation": 501, "user_id": 1259598, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e9e2654aad3d70595a49575320defb2b?s=128&d=identicon&r=PG&f=1", "display_name": "schwarz", "link": "https://stackoverflow.com/users/1259598/schwarz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "accepted_answer_id": 56153187, "answer_count": 1, "score": 2, "last_activity_date": 1557935275, "creation_date": 1557933303, "question_id": 56152669, "link": "https://stackoverflow.com/questions/56152669/ioc-container-for-vba", "title": "IoC container for VBA", "body": "<p>Had a nice read about DI here in VBA:</p>\n\n<p><a href=\"https://rubberduckvba.wordpress.com/2016/07/05/oop-vba-pt-2-factories-and-cheap-hotels/\" rel=\"nofollow noreferrer\">https://rubberduckvba.wordpress.com/2016/07/05/oop-vba-pt-2-factories-and-cheap-hotels/</a></p>\n\n<p>So now the next step would be use an IoC container in VBA. But I am wondering if that's even possible! I'm new to VBA and I cant figure out a few things:</p>\n\n<ol>\n<li>If done in VBA, VBA has no namespaces or Type equivalent from C#. So how would my lookup table store a unique key for a type?</li>\n<li>I thought about writing a com dll in C# and implement an IoC there but I cant figure out how to pass on a Interface type to the com interface. I cant even instantiate an interface to pass it as an object to com.</li>\n</ol>\n\n<p>Am I reduced to just using strings and implement namespaces in VBA using modules?</p>\n\n<p>PS: I did not find any exisiting implementation of IoC container for vba, so if there's any, I'm all ears!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 11497024, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SNiiEa4DfFc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdNKVCM0wLzM6Jv1nXZ2bdKLGXtwQ/mo/photo.jpg?sz=128", "display_name": "GabrieleS", "link": "https://stackoverflow.com/users/11497024/gabrieles"}, "edited": false, "score": 0, "creation_date": 1557990709, "post_id": 56152608, "comment_id": 98952959, "body": "I tried your suggestion but it doesn&#39;t work as I expect."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 25, "user_id": 11497024, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SNiiEa4DfFc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdNKVCM0wLzM6Jv1nXZ2bdKLGXtwQ/mo/photo.jpg?sz=128", "display_name": "GabrieleS", "link": "https://stackoverflow.com/users/11497024/gabrieles"}, "edited": false, "score": 0, "creation_date": 1557992050, "post_id": 56152608, "comment_id": 98953684, "body": "Well @GabrieleS you wanted to loop through your named ranges, this is how. What are you trying to do?"}, {"owner": {"reputation": 25, "user_id": 11497024, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SNiiEa4DfFc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdNKVCM0wLzM6Jv1nXZ2bdKLGXtwQ/mo/photo.jpg?sz=128", "display_name": "GabrieleS", "link": "https://stackoverflow.com/users/11497024/gabrieles"}, "edited": false, "score": 0, "creation_date": 1558014141, "post_id": 56152608, "comment_id": 98966582, "body": "Sorry, ok it works with a little modification of my code. Thank you very much."}], "tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": true, "score": 0, "last_activity_date": 1557933135, "creation_date": 1557933135, "answer_id": 56152608, "question_id": 56152544, "link": "https://stackoverflow.com/questions/56152544/how-to-loop-through-named-range-label-automatically/56152608#56152608", "title": "How to loop through named range label automatically", "body": "<p>This is how:</p>\n\n<pre><code>Option Explicit\nSub Test()\n\n    Dim MyNAmes As Name\n\n    For Each MyNAmes In ThisWorkbook.Names\n        'Your code\n    Next MyNAmes\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25, "user_id": 11497024, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SNiiEa4DfFc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdNKVCM0wLzM6Jv1nXZ2bdKLGXtwQ/mo/photo.jpg?sz=128", "display_name": "GabrieleS", "link": "https://stackoverflow.com/users/11497024/gabrieles"}, "is_accepted": false, "score": 0, "last_activity_date": 1558072814, "last_edit_date": 1558072814, "creation_date": 1558014326, "answer_id": 56170070, "question_id": 56152544, "link": "https://stackoverflow.com/questions/56152544/how-to-loop-through-named-range-label-automatically/56170070#56170070", "title": "How to loop through named range label automatically", "body": "<p>Here the code for my question, if anyone is interested:</p>\n\n<pre><code>  Option Explicit\n  Sub Protocols()\n  ActiveSheet.UsedRange.Select\n  Dim wsI As Worksheet, wsO As Worksheet\n  Dim cell As Range\n  Dim nm As Name\n\n  Set wsI = ThisWorkbook.Sheets(\"Sheet1\")\n  Set wsO = ThisWorkbook.Sheets(\"Sheet2\")\n\n  On Error Resume Next\n\n  For Each cell In Columns(\"A\").Cells\n  If IsEmpty(cell) = True Then\n  Else\n  For Each nm In ThisWorkbook.Names\n  If cell.Value = nm.Name Then Exit For\n  Next nm\n  wsI.Range(nm.Name).Copy wsO.Cells(cell.Row, \"B\")\n  End If\n  Next cell\n\n  On Error GoTo 0\n  End Sub\n</code></pre>\n\n<p>Now the doubt is: it's possible to limit the nm Name searching only in the Named Range stored in Sheet1 (wsI in the example) instead of the whole workbook? I tried to replace</p>\n\n<pre><code>  For Each nm In ThisWorkbook.Names\n</code></pre>\n\n<p>with</p>\n\n<pre><code>  For Each nm In wsI.Names   \n</code></pre>\n\n<p>But it seems not work. </p>\n\n<p>Any ideas? Do you think it was possible? </p>\n\n<p>P.S.: It's just to limit the research to the Named Range and avoid unecessary loop!</p>\n"}], "owner": {"reputation": 25, "user_id": 11497024, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SNiiEa4DfFc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdNKVCM0wLzM6Jv1nXZ2bdKLGXtwQ/mo/photo.jpg?sz=128", "display_name": "GabrieleS", "link": "https://stackoverflow.com/users/11497024/gabrieles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 56152608, "answer_count": 2, "score": 0, "last_activity_date": 1558072814, "creation_date": 1557932950, "last_edit_date": 1557933411, "question_id": 56152544, "link": "https://stackoverflow.com/questions/56152544/how-to-loop-through-named-range-label-automatically", "title": "How to loop through named range label automatically", "body": "<p>I have same many Named Range in my wsI with different label (list with different row number but same column number) (es. listA=Sheet1!$A$2:$E$4, listB=Sheet1!$A$5:$E$6 etc). Now I want to copy my Named Range in a wsO, this code works as I expect:</p>\n\n<pre><code> Sub CopyNamedRange()\n Dim wsI As Worksheet, wsO As Worksheet\n\n Set wsI = ThisWorkbook.Sheets(\"Sheet1\")\n Set wsO = ThisWorkbook.Sheets(\"Sheet2\")\n\n wsO.Range(\"A1\")= \"listA\"\n wsO.Range(\"listA\").Copy wsO.Range(\"B1\") \n\n End Sub\n</code></pre>\n\n<p>The result is to copy listA cells from the Sheet1!$A$2:$E$4 to Sheet2!$B$1:$F$3 if in Sheet2!A1 was write \"listA\".\nNow, I want to know if it's possible to create a macro that loop through all my labels of the Named Range in wsI and according to the value in Sheet2!A1, copy all the cells. \nSecondly, I will introduce a second loop through the Column \"A\" on Sheet2 in order to find all the different \"listX\" (es. listA, listB, listA, listC, listB, etc.) and copy automatically the cells in the Sheet2 (obviously if A1=listA will be occupy 3 rows from 1 to 3 the next cell in column A with a \"listX\" will be in A4 and so on).</p>\n"}, {"tags": ["excel", "vba", "string", "email"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1557932762, "post_id": 56152420, "comment_id": 98934334, "body": "What is your question though?  Exactly which part of this is giving you problems, and what have you tried to resolve that?  Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and revise your question."}, {"owner": {"reputation": 11, "user_id": 5874848, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qXtKeIrPy2A/AAAAAAAAAAI/AAAAAAAAHjU/mm7-0WPd2jg/photo.jpg?sz=128", "display_name": "Kiran Shetty", "link": "https://stackoverflow.com/users/5874848/kiran-shetty"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1557933422, "post_id": 56152420, "comment_id": 98934751, "body": "sorry about that, I have updated my query now"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1557936470, "post_id": 56152420, "comment_id": 98936507, "body": "You can use VBA to get the text from the message, use <code>Split()</code> to produce an array of lines, then loop over the array checking each line for (eg) &quot;Package Summary:&quot; - when you get a match remove the line header and place the remaining text in the appropriate row/column."}], "owner": {"reputation": 11, "user_id": 5874848, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qXtKeIrPy2A/AAAAAAAAAAI/AAAAAAAAHjU/mm7-0WPd2jg/photo.jpg?sz=128", "display_name": "Kiran Shetty", "link": "https://stackoverflow.com/users/5874848/kiran-shetty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1557936360, "creation_date": 1557932547, "last_edit_date": 1557936360, "question_id": 56152420, "link": "https://stackoverflow.com/questions/56152420/convert-email-string-text-to-excel-table", "title": "Convert email string (text) to excel table", "body": "<p><a href=\"https://i.stack.imgur.com/GzEvC.jpg\" rel=\"nofollow noreferrer\">email from which data needs to be captured</a></p>\n\n<p>I have an email string (as shown in the screenshot above) that I would like to convert to tables. The string comes in a specific format with fixed variables.\nI would like to format this string in an excel table as shown below.</p>\n\n<p>I have tried to convert this in VBA and able to extract this in string format something like below</p>\n\n<blockquote>\n  <p>Package Summary:</p>\n  \n  <p>Client:  ABC</p>\n  \n  <p>Account Executive:  John Smith (JohnSmith@abc.com)</p>\n  \n  <p>Global Region:  North America</p>\n  \n  <p>Billing Party:  XYZ</p>\n  \n  <p>Party Responsible:  JKL</p>\n  \n  <p>Platform:  JAVA</p>\n  \n  <p>Platform Price (USD):  1,200</p>\n  \n  <p>Lead Time:  1 Week</p>\n  \n  <p>URL:  <a href=\"https://google,com\" rel=\"nofollow noreferrer\">https://google,com</a></p>\n  \n  <p>Id:  00076q82uihef</p>\n  \n  <p>Response Id:  wsdiw3470972509</p>\n</blockquote>\n\n<p>However, I am not able to convert this into an array through excel using text to columns or formulas.</p>\n\n<p>It would be helpful if someone can guide in the right direction as to how this can be achieved with any manual intervention</p>\n\n<p><a href=\"https://i.stack.imgur.com/qgnBu.png\" rel=\"nofollow noreferrer\">format in excel</a></p>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1557932552, "post_id": 56152348, "comment_id": 98934211, "body": "Try <code>ComboBox1_Change()</code> event instead."}, {"owner": {"reputation": 1, "user_id": 11504212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a7499254f13419d9a7652c5456c396f?s=128&d=identicon&r=PG&f=1", "display_name": "nickthekidd", "link": "https://stackoverflow.com/users/11504212/nickthekidd"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1557934910, "post_id": 56152348, "comment_id": 98935635, "body": "Thanks - that works."}, {"owner": {"reputation": 1, "user_id": 11504212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a7499254f13419d9a7652c5456c396f?s=128&d=identicon&r=PG&f=1", "display_name": "nickthekidd", "link": "https://stackoverflow.com/users/11504212/nickthekidd"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1557934960, "post_id": 56152348, "comment_id": 98935667, "body": "However, what do I do in a similar situation when it&#39;s a textbox rather than a combo box thats changing.  Can&#39;t change the textbox to a change event or it goes crazy."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1557935032, "post_id": 56152348, "comment_id": 98935720, "body": "use the <code>_AfterUpdate</code> event for the text box."}, {"owner": {"reputation": 1, "user_id": 11504212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a7499254f13419d9a7652c5456c396f?s=128&d=identicon&r=PG&f=1", "display_name": "nickthekidd", "link": "https://stackoverflow.com/users/11504212/nickthekidd"}, "edited": false, "score": 0, "creation_date": 1557935611, "post_id": 56152348, "comment_id": 98936032, "body": "For sure, that&#39;s what I&#39;m using, but then the whole issue of my tab order doesn&#39;t seem to work.  Can&#39;t get it to tab across to the newly visible next textbox - instead it skips to the next textbox that was visible before the sub."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1557936143, "post_id": 56152348, "comment_id": 98936346, "body": "Do you have the tab order set correctly between the controls on the UserForm?"}, {"owner": {"reputation": 1, "user_id": 11504212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a7499254f13419d9a7652c5456c396f?s=128&d=identicon&r=PG&f=1", "display_name": "nickthekidd", "link": "https://stackoverflow.com/users/11504212/nickthekidd"}, "edited": false, "score": 0, "creation_date": 1557947209, "post_id": 56152348, "comment_id": 98941300, "body": "Yes, if everything was visible when the UserForm was activated, I could tab through in order.  For some reason, when I make certain fields visible on condition of others, I cannot set-focus to the newly visible cells."}], "owner": {"reputation": 1, "user_id": 11504212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a7499254f13419d9a7652c5456c396f?s=128&d=identicon&r=PG&f=1", "display_name": "nickthekidd", "link": "https://stackoverflow.com/users/11504212/nickthekidd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557932444, "creation_date": 1557932355, "last_edit_date": 1557932444, "question_id": 56152348, "link": "https://stackoverflow.com/questions/56152348/fixing-a-tab-order-issue", "title": "Fixing a tab order issue", "body": "<p>I have a VBA userform with a number of combo boxes and textboxes which sit on a multipage control tab.</p>\n\n<p>ComboBox1 is visible and set to TabIndex 26.</p>\n\n<p>Textboxes 2 and 3 are not visible and set to TabIndex 27 &amp; 28.</p>\n\n<p>Textbox 4 is visible and set to TabIndex 29.</p>\n\n<p>I have created code that if ComboBox1 after update is \"Yes\" then unhide Textboxes 2 and 3, and setfocus on Textbox 2.</p>\n\n<p>However, when executing this UserForm, if I select \"Yes\" in Combobox1, the tab goes directly to Textbox 4 - skipping Textboxes 2 and 3 (even though they are now visible).</p>\n\n<p>This is happening a few different places in my UserForm1 - sometimes after a Combobox and sometimes after a Textbox.</p>\n\n<p>Have make sure that all tab order is correct.</p>\n\n<p>Have also tried codes for SetFocus.  Have added this at various stages of the sub.</p>\n\n<pre><code>Private Sub ComboBox1_AfterUpdate()\n\n    If ComboBox1 = \"Yes\" Then\n\n        Label1148.Visible = True\n        Label1149.Visible = True\n        Textbox2.Visible = True\n        Textbox3.Visible = True\n        Me.Textbox2.SetFocus\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>I expect that if Combobox1 is selected as \"Yes\", then the tab goes directly to the (now) visible Textbox2.</p>\n\n<p>If Combobox1 is selected as \"No\", then textboxes 2 and 3 remain invisible, and tab goes straight to textbox 4.</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 4, "creation_date": 1557931958, "post_id": 56152203, "comment_id": 98933851, "body": "SUMIF and/or SUMIFS"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 4, "creation_date": 1557931967, "post_id": 56152203, "comment_id": 98933858, "body": "Have a look at the <a href=\"https://support.office.com/en-us/article/sumifs-function-c9e748f5-7ea7-455d-9406-611cebce642b\" rel=\"nofollow noreferrer\">SUMIFS function</a>."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1557932082, "post_id": 56152203, "comment_id": 98933933, "body": "<code>it needs to SUM the Forecasted value from the Capex entry and Planned from Opex</code> - and place it where? To the capex entry or to the opex entry? Or to both, in which case it is double accounting? Or to a third line?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1557932105, "post_id": 56152203, "comment_id": 98933944, "body": "<i>&quot;So in this case, there would be a column to the right with the values 1000, 2000, and 3000 respectively.&quot;</i> - where are those numbers coming from?"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1557932173, "post_id": 56152203, "comment_id": 98933988, "body": "@dwirony 1000 from forecasted for project 100, 2000 from planned for project 200, 3000 from sum of forecasted and planned for project 300."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1557932243, "post_id": 56152203, "comment_id": 98934036, "body": "@GSerg I see now... I was having a hard time following! :)"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1557932602, "post_id": 56152203, "comment_id": 98934244, "body": "If there can be up to two instances of the same project in the table, if it is guaranteed that they belong to different types, and if each instance must show the total for the two rows, then <code>=SUMIFS($C$2:$C$5,$B$2:$B$5,&quot;OPEX&quot;,$A$2:$A$5,$A2)+SUMIFS($D$&zwnj;&#8203;2:$D$5,$B$2:$B$5,&quot;CA&zwnj;&#8203;PEX&quot;,$A$2:$A$5,$A2)</code>, provided Project ID is in A1."}], "answers": [{"comments": [{"owner": {"reputation": 247, "user_id": 11477722, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JJAkyk9L4wE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcooIyOiYyRLa4HNpDUQrcHnUVRTw/mo/photo.jpg?sz=128", "display_name": "Tyler M", "link": "https://stackoverflow.com/users/11477722/tyler-m"}, "edited": false, "score": 0, "creation_date": 1557934391, "post_id": 56152591, "comment_id": 98935350, "body": "Alternatively, instead of IFS, you could also use a SWITCH() formula. For example, SWITCH(&lt;Name&gt;, CAPEX, IF(&lt;AlternateIDFound&gt;,3000,1000), OPEX, IF(&lt;AlternateIDFound&gt;,3000,2000), &lt;default value (probably &quot; &quot;)&gt;)"}], "tags": [], "owner": {"reputation": 247, "user_id": 11477722, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JJAkyk9L4wE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcooIyOiYyRLa4HNpDUQrcHnUVRTw/mo/photo.jpg?sz=128", "display_name": "Tyler M", "link": "https://stackoverflow.com/users/11477722/tyler-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1557934190, "last_edit_date": 1557934190, "creation_date": 1557933050, "answer_id": 56152591, "question_id": 56152203, "link": "https://stackoverflow.com/questions/56152203/is-there-an-excel-formula-to-sum-two-cells-if-the-id-is-duplicated/56152591#56152591", "title": "Is there an Excel Formula to sum two cells if the ID is duplicated?", "body": "<p>Sure there is, as others have mentioned it's called the <a href=\"https://exceljet.net/excel-functions/excel-sumif-function\" rel=\"nofollow noreferrer\">SUMIF</a> function. As it sounds, it sums all the values to which the critera applied is TRUE.</p>\n\n<p>However, in your example, I don't think the SUMIF function would be very useful. Rather, a carefully crafted nest of IF and IFS would solve your issue. In your example, it looks like you would SUM the values together IF 'project x' is found at least one place else in the data, AND that alternate 'project x' is of the alternate type (CAPEX vs OPEX).</p>\n\n<p>I'm assuming you have a basic knowledge of the functions I'll implement in this example, so I'll spare you the details - just know that I use the TEXTJOIN funciton to create column E, which I use as a way to check if the alternate identity (Project 3OPEX vs Project 3CAPEX) exists somewhere in the sheet. If it does, the columns F and G are summed; if not, data is used from either column F or G, depending on the Type (Column D)<a href=\"https://i.stack.imgur.com/n4QZ9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/n4QZ9.png\" alt=\"Example of formula\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 11504882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e62d1365150991e00fc2366734ea6b7?s=128&d=identicon&r=PG&f=1", "display_name": "smdgehc", "link": "https://stackoverflow.com/users/11504882/smdgehc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557934190, "creation_date": 1557931802, "last_edit_date": 1557931877, "question_id": 56152203, "link": "https://stackoverflow.com/questions/56152203/is-there-an-excel-formula-to-sum-two-cells-if-the-id-is-duplicated", "title": "Is there an Excel Formula to sum two cells if the ID is duplicated?", "body": "<p>I have a list of projects that are either Capex or Opex. If the project is Capex, it needs to use the Forecasted value, and if the project is Opex, it needs to use the Planned value. BUT, there are some projects that are both, which means it needs to SUM the Forecasted value from the Capex entry and Planned from Opex. Is there an excel formula or VBA module I can use to easily do this without making it manual?</p>\n\n<p>Here is an example of the data:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Djj4x.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Djj4x.png\" alt=\"example\"></a></p>\n\n<p>So in this case, there would be a column to the right with the values 1000, 2000, and 3000 respectively.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1557931642, "post_id": 56152106, "comment_id": 98933647, "body": "What is <code>[Liste]</code>? Which range? If you do <code>Set a = [Liste]</code> you try to assign a <code>Range</code> object to an array <code>Dim a()</code> which cannot work. So it must be <code>a = [Liste].Value</code> to get the values into the array. Probably a range with the name <code>Liste</code> does not exist in the sheet."}, {"owner": {"reputation": 9, "user_id": 11504773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22783af83260867abcfb7b8f82cfc85f?s=128&d=identicon&r=PG&f=1", "display_name": "Veri", "link": "https://stackoverflow.com/users/11504773/veri"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1557932046, "post_id": 56152106, "comment_id": 98933910, "body": "I feel so stupid now. I was just about to write an explanation about how I set up the named range [Liste] with a formula (offset formula) and realized that I had a typo in the formula (Shet1 instead of Sheet1). Once I changed it, it worked. I feel very silly now but thank you for making me go back and check it! And you are right, I changed the code back to &#39;a = [Liste]&#39;.Value for it to work"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1557932131, "post_id": 56152106, "comment_id": 98933961, "body": "No worries. Somtimes you just don&#39;t see it. Happens to everyone."}], "owner": {"reputation": 9, "user_id": 11504773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22783af83260867abcfb7b8f82cfc85f?s=128&d=identicon&r=PG&f=1", "display_name": "Veri", "link": "https://stackoverflow.com/users/11504773/veri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1557931532, "creation_date": 1557931519, "last_edit_date": 1557931532, "question_id": 56152106, "link": "https://stackoverflow.com/questions/56152106/compile-error-with-excel-vba-userform-code-with-selectionchange", "title": "Compile Error with Excel VBA UserForm Code with SelectionChange", "body": "<p>First time posting here on stackoverflow (so I hope I am following all the rules). I have looked through so many posts here (and Google in general) to find an answer but nothing I have tried worked.</p>\n\n<p>Background on my file:\nI have a sheet (sheet1) with a list of projects (for the sake of this example let's just say Apple, Banana, Orange etc). They are in column A (A2:A77 to be exact).</p>\n\n<p>Now on Sheet2, I would like to have a UserForm pop up when you click on specific cells (Let's say A2:A50 on sheet2). When the UserForm pops up, there is one dropdown list with a searchable list (combobox) and one button (basically where you \"accept\" the selection which is then added to the cell you have selected). I have found a template on this website (<a href=\"http://boisgontierjacques.free.fr/pages_site/listes_cascade.htm#ListeIntuitiveForm\" rel=\"nofollow noreferrer\">http://boisgontierjacques.free.fr/pages_site/listes_cascade.htm#ListeIntuitiveForm</a>) that does EXACTLY what I want. The website is in French but basically it is the link to the template called \"Recherche Intuitive TextBox ListBox Form\". </p>\n\n<p>As mentioned above, I have copied the code exactly as it is from the template. I have made sure the namings are the same, named range, etc but nothing worked. I have tried changing part of the codes (Setting it to a range, setting up the variable etc but always get an error).</p>\n\n<p>Here is the code I have in Sheet2 (where you click on the cells for the userform to pop up):</p>\n\n<pre><code>Private Sub WorkSheet_SelectionChange(ByVal Target as Range)\nIf Not Intersect ([A2:A50]), Target) Is Nothing And Target.Count = 1 Then\n    UserForm4.Left = Target.Left + 150\n    UserForm4.Top = Target.Top + 90 - Cells(ActiveWindow.ScrollRow, 1).Top\n    UserForm.Show\nEnd If\nEnd Sub\n</code></pre>\n\n<p>This is the code I have for the UserForm (I already double checked naming of the objects, they are the same):</p>\n\n<pre><code>Dim a()\nPrivate Sub UserForm_Initialize()\n  Set a = [Liste]\n  Me.ComboBox1.List = a\nEnd Sub\n\nPrivate Sub ComboBox1_Change()\n  Set d1 = CreateObject(\"Scripting.Dictionary\")\n  tmp = UCase(Me.ComboBox1) &amp; \"*\"\n  For Each c In a\n    If UCase(c) Like tmp Then d1(c) = \"\"\n  Next c\n  Me.ComboBox1.List = d1.keys\n  Me.ComboBox1.DropDown\nEnd Sub\n\nPrivate Sub CommandButton1_Click()\n  ActiveCell = Me.ComboBox1\n  Unload Me\nEnd Sub\n\nPrivate Sub ComboBox1_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)\n  If KeyCode = 13 Then ActiveCell = Me.ComboBox1: Unload Me\nEnd Sub\n</code></pre>\n\n<p>The template mentioned above includes the code, the UserForm, the list etc but for some reason when I try to replicate it, it gives me errors. It started with error 424 (I got around that), then error 91 (also got around that) but now it is giving me a \"Compile error: Can't assign to array\" error.</p>\n\n<p>When I try to debug (F8), it highlights this part of the code:</p>\n\n<p><code>Private Sub UserForm_Initialize()</code> - this is highlighted in yellow</p>\n\n<p><code>a = [Liste].Value</code> (this is the original version and gives me the 424 error; </p>\n\n<p>when I change it to <code>Set a = [Liste]</code> (one of the recommendations I found online) it highlights <code>a=</code> in blue and gives me the compile error.</p>\n\n<p>The code works fine in the template workbook from the website but I just can't figure out why it doesn't work in mine.</p>\n\n<p>Thank you you so much for your help, I have trying to solve this for hours now!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 3, "creation_date": 1557931836, "post_id": 56152039, "comment_id": 98933774, "body": "Try the en dash, <code>chrw$(&amp;h2013)</code>."}, {"owner": {"reputation": 123, "user_id": 11103865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53d76e9a003e290d84d65b71734bd422?s=128&d=identicon&r=PG&f=1", "display_name": "my_mistakes", "link": "https://stackoverflow.com/users/11103865/my-mistakes"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1557932627, "post_id": 56152039, "comment_id": 98934257, "body": "@GSerg en-dash works. However, for some reason company formatting wants hypens instead of en-dash.   Any ideas as to why the hypen isn&#39;t working as intended?"}], "answers": [{"comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1557932933, "post_id": 56152460, "comment_id": 98934457, "body": "This displays minus instead of zeros. So if you have a genuine zero (as opposed to a blank), it will display a minus too. I thought the idea was to only display the minus for blank cells. The minus you then see in the table comes from the format string, not from NullString."}, {"owner": {"reputation": 123, "user_id": 11103865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53d76e9a003e290d84d65b71734bd422?s=128&d=identicon&r=PG&f=1", "display_name": "my_mistakes", "link": "https://stackoverflow.com/users/11103865/my-mistakes"}, "edited": false, "score": 0, "creation_date": 1557932962, "post_id": 56152460, "comment_id": 98934472, "body": "This is correct, I originally had my  <code>numberformat=&quot;#,##0&quot; </code>"}], "tags": [], "owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "is_accepted": true, "score": 1, "last_activity_date": 1557932691, "creation_date": 1557932691, "answer_id": 56152460, "question_id": 56152039, "link": "https://stackoverflow.com/questions/56152039/issue-with-nullstring-property-displaying-as-0-in-output/56152460#56152460", "title": "Issue with .NullString property displaying &quot;-&quot; as 0 in output", "body": "<p>I suspect it might be connected to your Number Format. Try adding one more line to your code:</p>\n\n<pre><code>With ActiveSheet.PivotTables(\"ThePivotTable\")\n    .NullString = \"-\"\n    .DisplayNullString = True\n    .DataBodyRange.NumberFormat = \"#,##0.00;-#,##0.00;-\"\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 11103865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53d76e9a003e290d84d65b71734bd422?s=128&d=identicon&r=PG&f=1", "display_name": "my_mistakes", "link": "https://stackoverflow.com/users/11103865/my-mistakes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 56152460, "answer_count": 1, "score": 2, "last_activity_date": 1564504174, "creation_date": 1557931329, "last_edit_date": 1564504174, "question_id": 56152039, "link": "https://stackoverflow.com/questions/56152039/issue-with-nullstring-property-displaying-as-0-in-output", "title": "Issue with .NullString property displaying &quot;-&quot; as 0 in output", "body": "<p>I'm writing some VBA code, a section of it is supposed to fill in the PivotTable cells that are Null with the character \"-\".</p>\n\n<p>Unfortunately using \"-\" just fills the table with 0 instead; I would like the Null Values to display a dash \"-\". </p>\n\n<pre><code>With ActiveSheet.PivotTables(\"ThePivotTable\")\n .NullString = \"-\"\n .DisplayNullString = True\nEnd With\n</code></pre>\n\n<p>But oddly works for anything else \nie \"'-\" displays '- as intended, \"NA\" displays as NA as intended</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1557931210, "post_id": 56151963, "comment_id": 98933362, "body": "Should the cells be pasted next to a certain date (e.g. today or yesterday) on the Daily sheet?"}, {"owner": {"reputation": 15, "user_id": 11504836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34277a7fec0914dfa257a597e81cc8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Liam", "link": "https://stackoverflow.com/users/11504836/liam"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1558003796, "post_id": 56151963, "comment_id": 98960252, "body": "@BigBen Yes, not in a cell directly next to the date, but in the same column as yesterdays date"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 11504836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34277a7fec0914dfa257a597e81cc8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Liam", "link": "https://stackoverflow.com/users/11504836/liam"}, "edited": false, "score": 0, "creation_date": 1557931563, "post_id": 56152078, "comment_id": 98933595, "body": "Thank you! i&#39;ll give it a go, I&#39;m pretty new to this stuff, would you mind talking me through what each line does a little bit?"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 15, "user_id": 11504836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34277a7fec0914dfa257a597e81cc8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Liam", "link": "https://stackoverflow.com/users/11504836/liam"}, "edited": false, "score": 0, "creation_date": 1557938186, "post_id": 56152078, "comment_id": 98937308, "body": "@Liam there, hope it helps."}, {"owner": {"reputation": 15, "user_id": 11504836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34277a7fec0914dfa257a597e81cc8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Liam", "link": "https://stackoverflow.com/users/11504836/liam"}, "edited": false, "score": 0, "creation_date": 1558004137, "post_id": 56152078, "comment_id": 98960436, "body": "This doesn&#39;t seem to work at the moment (Error message: &quot;Object doesn&#39;t support this property or method&quot;), is this because the range isn&#39;t being referred to properly (the range of cells needed is specified in O7 via a formula i.e. formula produces &quot;Mq7:Mq9&quot; within the cell)"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 15, "user_id": 11504836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34277a7fec0914dfa257a597e81cc8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Liam", "link": "https://stackoverflow.com/users/11504836/liam"}, "edited": false, "score": 0, "creation_date": 1558005887, "post_id": 56152078, "comment_id": 98961419, "body": "@Liam try changing <code>.Find</code> for <code>.Range</code>  and add after <code>.Range(&quot;O7&quot;)</code> this <code>.Value</code>"}, {"owner": {"reputation": 15, "user_id": 11504836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34277a7fec0914dfa257a597e81cc8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Liam", "link": "https://stackoverflow.com/users/11504836/liam"}, "edited": false, "score": 0, "creation_date": 1558006397, "post_id": 56152078, "comment_id": 98961687, "body": "that works, however, is there a way i can get it to copy the values in the cells only, and not the formulas and the formatting? Thank you!"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 15, "user_id": 11504836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34277a7fec0914dfa257a597e81cc8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Liam", "link": "https://stackoverflow.com/users/11504836/liam"}, "edited": false, "score": 0, "creation_date": 1558006723, "post_id": 56152078, "comment_id": 98961892, "body": "@Liam edited my answer, check it out. Consider accepting it now that everything is sorted."}], "tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": true, "score": 0, "last_activity_date": 1558006699, "last_edit_date": 1558006699, "creation_date": 1557931439, "answer_id": 56152078, "question_id": 56151963, "link": "https://stackoverflow.com/questions/56151963/how-to-copy-data-from-one-worksheet-to-another-using-an-indirect-reference-for/56152078#56152078", "title": "How to copy data from one worksheet to another (using an indirect reference for the latter worksheet)", "body": "<p>If I didn't messed it reading your code, this should do it:</p>\n\n<pre><code>Option Explicit\nSub Test()\n\n    Dim rng As Range 'Range object, means a cell or a range of cells\n    With ThisWorkbook 'here you reference the workbook, so you don't need to write Thisworkbook everytime, just \".\"\n        Set rng = .Sheets(\"Daily\").Find(.Sheets(\"AUTOM\").Range(\"O7\")) 'we set the object rng to the cell in sheets Daily which has the Cell O7 from AUTOM sheet value.\n        .Sheets(\"AUTOM\").Range(\"C1:C5\").Copy 'copy the range from AUTOM\n        rng.PasteSpecial xlPasteValues  'and paste it's values to the range object we declared and defined above\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11504836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34277a7fec0914dfa257a597e81cc8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Liam", "link": "https://stackoverflow.com/users/11504836/liam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 1, "accepted_answer_id": 56152078, "answer_count": 1, "score": 0, "last_activity_date": 1558006699, "creation_date": 1557931116, "question_id": 56151963, "link": "https://stackoverflow.com/questions/56151963/how-to-copy-data-from-one-worksheet-to-another-using-an-indirect-reference-for", "title": "How to copy data from one worksheet to another (using an indirect reference for the latter worksheet)", "body": "<p>I'm trying to add some simple VBA functions to excel files at work (i work for a marketing company) and am struggling to code a button that can copy data from one sheet to another (the position it needs to copy to changes daily)</p>\n\n<p>I'm using VBA to try and select the range of values i need copied (and it works) but i'm struggling to paste them in the daily-changing cells required.\nI've tried writing a formula that presents a pathway to the correct cells and then introducing an indirect function to the VBA code for pasting but i can't seem to get it to work.</p>\n\n<pre><code>Sub Gross_Wrap_Click()\n\nSheets(\"AUTOM\").Select\nRange(\"C1:C5\").Select\nSelection.Copy\n\nSheets(\"Daily\").Select\nRange([indirect(\"'AUTOM!O7'\")]).Select\nSelection.Paste\n\nEnd Sub\n</code></pre>\n\n<p>I expect the end product to be the contents of cells C1:C5 in the AUTOM sheet copied and pasted to the required cells in the DAILY sheet (the required cells are derived from a function and included in VBA with an Indirect pathway).</p>\n\n<p>However, i'm just getting a load of different error messages</p>\n"}, {"tags": ["excel", "vba", "copy-paste"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 3, "creation_date": 1557929909, "post_id": 56151329, "comment_id": 98932455, "body": "What exactly is your question? Does your code not work? Does it error? If so, where and what is the error message? If it doesn&#39;t error, what does it do?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1557930377, "post_id": 56151329, "comment_id": 98932773, "body": "Also, since you just need the values, you can skip using the clipboard and set the ranges&#39; values equal to eachother: <code>pasteRange.Cells(1,eColumn).Value = cel.value</code>."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1557932645, "creation_date": 1557932645, "answer_id": 56152453, "question_id": 56151329, "link": "https://stackoverflow.com/questions/56151329/how-to-display-the-contiguous-cells-in-a-row/56152453#56152453", "title": "how to display the contiguous cells in a row", "body": "<p>Simpler approach:</p>\n\n<pre><code>Sub test()\n    Dim cel As Range, pasteRange As Range\n\n    Set pasteRange = ThisWorkbook.Sheets(\"Sheet2\").Range(\"A2\")\n    For Each cel In ThisWorkbook.Sheets(\"Sheet1\").Range(\"A2, B4, D5, E1, F3\")\n            pasteRange.Value = cel.Value\n            Set pasteRange = pasteRange.Offset(0, 1)\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1557933914, "creation_date": 1557933914, "answer_id": 56152865, "question_id": 56151329, "link": "https://stackoverflow.com/questions/56151329/how-to-display-the-contiguous-cells-in-a-row/56152865#56152865", "title": "how to display the contiguous cells in a row", "body": "<p>@TimWilliams' answer is quick and easy, but I just thought to show you how to do this with an array as well:</p>\n\n<pre><code>Sub t2()\nDim copyRange As Range, cel As Range, pasteRange As Range\nSet copyRange = ThisWorkbook.Sheets(\"Sheet1\").Range(\"A2, B4, D5, E1, F3\")\nSet pasteRange = ThisWorkbook.Sheets(\"Sheet2\").Range(\"A2\")\n\nDim copyVals() As Variant\nReDim copyVals(0 To copyRange.Cells.Count)\n\nDim n As Long\nn = 0\nFor Each cel In copyRange\n    copyVals(n) = cel.Value\n    n = n + 1\nNext cel\n\nDim k As Long\nFor k = LBound(copyVals) To UBound(copyVals)\n    pasteRange.Offset(k, 0).Value = copyVals(k)\nNext k\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 11470708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1375b37935e5893b17d45fff2979da9b?s=128&d=identicon&r=PG&f=1", "display_name": "Rocky", "link": "https://stackoverflow.com/users/11470708/rocky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1557933914, "creation_date": 1557929226, "last_edit_date": 1557929694, "question_id": 56151329, "link": "https://stackoverflow.com/questions/56151329/how-to-display-the-contiguous-cells-in-a-row", "title": "how to display the contiguous cells in a row", "body": "<p>I got 5 table headers in <code>A1:E1</code>.  I want to display the contiguous cells data <code>(A2, B4, D5, E1, F3)</code> in cells <code>A2:E2</code>.  Pls help to do so.  My code is displayed below</p>\n\n<pre><code>Sub test()\n    Dim copyRange As Range, cel As Range, pasteRange As Range, \n        erow As Long, ecolumn As Long\n    Set copyRange = ThisWorkbook.Sheets(\"Sheet1\").Range(\"A2, B4, D5, E1, F3\")\n    Set pasteRange = ThisWorkbook.Sheets(\"Sheet2\").Range(\"A2\")\n    For Each cel In copyRange\n            cel.Copy\n            erow = ActiveSheet.Cells(Rows.Count, 2).End(xlUp).Offset(1, 1).Row\n            erow = Sheet2.Cells(Rows.Count, 1).End(xlUp).Offset(0, 1).Row\n            ecolumn = Sheet2.Cells(2, Columns.Count).End(xlToLeft).Offset(0, 1).Row\n            pasteRange.Cells(1, ecolumn).PasteSpecial xlPasteValues\n    Next\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1557933209, "post_id": 56151269, "comment_id": 98934630, "body": "There&#39;s no equivalent in VBA - objects do not have a prototypical <code>toString()</code> method (ormaybe implement a default member which would produce a string).   If you&#39;re only dealing with your own classes then you could implement that, but &quot;built-in&quot; types would be an issue."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1557933378, "post_id": 56151269, "comment_id": 98934724, "body": "The default implementation of <code>toString</code> outputs the type&#39;s name. If you can&#39;t modify the class and override <code>toString</code>, you have the exact same problem in Java that you have in VBA. Something, somewhere, needs to know how to represent that object as a string."}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1557929351, "creation_date": 1557929351, "answer_id": 56151379, "question_id": 56151269, "link": "https://stackoverflow.com/questions/56151269/is-there-an-implemented-function-similar-to-the-tostring-function-in-vba/56151379#56151379", "title": "Is there an implemented function similar to the toString() function in vba?", "body": "<p>Something like that does not exist in VBA there are only the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/concepts/getting-started/type-conversion-functions\" rel=\"nofollow noreferrer\">Type conversion functions</a> like <code>CStr()</code> to convert eg. an <code>Integer</code> into a <code>String</code>.</p>\n\n<p>If you eg need to convert a <code>Collection</code> into an <code>Array</code> you will need to use a function for that.</p>\n\n<hr>\n\n<blockquote>\n  <p>But what if I don't know what kind of object will be inside my <code>LList</code> collection</p>\n</blockquote>\n\n<p>Then you will need to determine which object it is (you would probably expect eg 5 different possible objects) and do something like a <code>Select Case</code> for each different object type to convert this to a <code>String</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 11504619, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CDtQ0JZ-vNc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfR04b2dVuVLkjEnFQs2wACEpJnBw/mo/photo.jpg?sz=128", "display_name": "Willem Bielefeld", "link": "https://stackoverflow.com/users/11504619/willem-bielefeld"}, "edited": false, "score": 0, "creation_date": 1557989715, "post_id": 56152646, "comment_id": 98952490, "body": "Wow i didnt expect such a useful hint. Thank you very much. In my case i know my Collection will always have the same type of objects but it is good to know how to handle different cases aswell.  In Java i almost everytime implement toString because it is very handy in almost any case. In lots of realistic practical cases most objects have one main variable value which indicates very well what the object represents. Maybe it is justmy personal coding style but i realy missed this in in vba. It is also handy for exporting Data in txt files you can directly understand by reading easily."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 4, "last_activity_date": 1557933945, "last_edit_date": 1557933945, "creation_date": 1557933248, "answer_id": 56152646, "question_id": 56151269, "link": "https://stackoverflow.com/questions/56151269/is-there-an-implemented-function-similar-to-the-tostring-function-in-vba/56152646#56152646", "title": "Is there an implemented function similar to the toString() function in vba?", "body": "<p><code>Debug.Print</code> will implicitly attempt coerce the given <em>value expression</em> into a <code>String</code> for output.</p>\n\n<p>When you <code>Debug.Print</code> an object, VBA attempts to <code>Let</code>-coerce the object into a value - if the object doesn't have a <em>default member</em> that ultimately yields a value that can be implicitly converted to a <code>String</code>, then you get run-time error 438 \"object doesn't support this property or method\" if the class doesn't have a <em>default member</em>.</p>\n\n<p>If the object is user code (i.e. your own class module), and if it makes sense to do so, you could add a default member yourself, and have the class responsible for knowing how to represent itself as a <code>String</code> (note that the VB attribute is hidden in the VBE code panes, and must be edited outside the VBE - unless you're using <a href=\"http://www.github.com/rubberduck-vba/Rubberduck\" rel=\"nofollow noreferrer\">Rubberduck</a>, in which case you can simply add a <code>@DefaultMember</code> annotation and synchronize annotations/attributes):</p>\n\n<pre><code>'@DefaultMember\nPublic Function ToString() As String\nAttribute ToString.VB_UserMemId = 0\n    '...\nEnd Function\n</code></pre>\n\n<p>But all this does is give the class the ability to be essentially treated as a <code>String</code>, through implicit member calls. I'd call that something like an abuse a language feature (it's through this mechanism that <code>Debug.Print Excel.Application</code> outputs the application's <code>Name</code>, or <code>Debug.Print adoConnection</code> outputs the connection's <code>ConnectionString</code> property), since as you noted, you might as well just invoke that <code>ToString</code> method explicitly.</p>\n\n<p>If the object doesn't know how to represent itself as a <code>String</code>, then <em>something, somewhere</em> will have to. In Java (IIRC) and .NET this would essentially be the default <code>ToString</code> implementation:</p>\n\n<pre><code>Debug.Print TypeName(objVarXY)\n</code></pre>\n\n<p>...which is rather useless, but that's essentially what <code>ToString</code> does by default.</p>\n\n<p>Whether you're writing Java, C#, or VBA, there needs to be code responsible for knowing how to represent <code>objVarXY</code> as a <code>String</code>.</p>\n\n<p>Sadly VBA doesn't do fancypants pattern matching, so we can't <code>Select Case TypeOf obj</code> like in C# (it only recently got that ability - don't know about Java), and since <code>Select Case TypeName(obj)</code> wouldn't be type-safe, I'd go with <code>If...ElseIf</code>:</p>\n\n<pre><code>Public Function Stringify(ByVal obj As Object) As String\n    If TypeOf obj Is Something Then\n        Dim objSomething As Something\n        Set objSomething = obj ' cast to Something interface\n        Stringify = objSomething.SomeProperty\n\n    ElseIf TypeOf obj Is SomethingElse Then\n        Dim objSomethingElse As SomethingElse\n        Set objSomethingElse = obj ' cast to SomethingElse interface\n        Stringify = objSomethingElse.AnotherProperty &amp; \"[\" &amp; objSomethingElse.Foo &amp; \"]\"\n\n    'ElseIf TypeOf obj Is ... Then\n    '    ...\n    Else\n        ' we don't know what the type is; return the type name.\n        Stringify = TypeName(obj)\n    End If\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>Obviously if the collection always involves classes that you own, the better solution is to have each object know how to represent itself as a <code>String</code> value.</p>\n\n<p>But, having user classes expose a <code>ToString</code> method on their <em>default interface</em> isn't ideal: since we don't know what type we're getting from the collection, all we have is <code>Object</code> and a late-bound call - and no compile-time guarantee that the class implements a <code>ToString</code> method, and no compiler warning if we try to invoke, say, <code>ToStrnig</code>.</p>\n\n<p>The solution is to <em>not</em> put <code>ToString</code> on the classes' default interface, and formalize the behavior with some <code>IString</code> class module, which might look like this:</p>\n\n<pre><code>Option Explicit\nPublic Function ToString() As String\nEnd Funtion\n</code></pre>\n\n<p>Yup, that's the whole class.</p>\n\n<p>Now the user classes that need to be representable as strings, can do this:</p>\n\n<pre><code>Option Explicit\nImplements IString\n\nPrivate Function IString_ToString() As String\n    ' todo: implement the method!\nEnd Function\n</code></pre>\n\n<p>And now we can have early-bound assurance that the objects have a <code>ToString</code> method:</p>\n\n<pre><code>Dim o As Object\nFor Each o In MyCollection\n    If TypeOf o Is IString Then\n        Dim s As IString\n        Set s = o 'cast to IString interface\n        Debug.Print s.ToString\n    Else\n        Debug.Print TypeName(o)\n    End If\nNext\n</code></pre>\n\n<p>At the end of the day there's no magic, regardless of what language you're using.</p>\n"}], "owner": {"reputation": 3, "user_id": 11504619, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CDtQ0JZ-vNc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfR04b2dVuVLkjEnFQs2wACEpJnBw/mo/photo.jpg?sz=128", "display_name": "Willem Bielefeld", "link": "https://stackoverflow.com/users/11504619/willem-bielefeld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 570, "favorite_count": 2, "accepted_answer_id": 56152646, "answer_count": 2, "score": 0, "last_activity_date": 1557933945, "creation_date": 1557929069, "last_edit_date": 1557929154, "question_id": 56151269, "link": "https://stackoverflow.com/questions/56151269/is-there-an-implemented-function-similar-to-the-tostring-function-in-vba", "title": "Is there an implemented function similar to the toString() function in vba?", "body": "<p>I want to get an Object within a Collection as a String without calling a function for it.\ne.G.:\nIn java i can </p>\n\n<pre><code>System.out.print(objVarXY)\n</code></pre>\n\n<p>and the compiler will automatically call the objVarXY.toString() function (if implemented) </p>\n\n<p>in VBA something like this</p>\n\n<pre><code>Debug.Print parameterListe.LList.Item(1)\n</code></pre>\n\n<p>will cause an error.</p>\n\n<pre><code>Debug.Print parameterListe.LList.Item(1).toString\n</code></pre>\n\n<p>will work, if i implemented a toString Subfunction.\nBut what if i dont know what kind of object will be inside my LList collection?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 2, "creation_date": 1557928959, "post_id": 56151169, "comment_id": 98931775, "body": "Do you really need a loop? Can&#39;t you just filter column I for 20 and then copy the whole range just once?"}, {"owner": {"reputation": 3, "user_id": 11495015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73a0a0a3b09b9c20ed13b18fb069a718?s=128&d=identicon&r=PG&f=1", "display_name": "C.Edo", "link": "https://stackoverflow.com/users/11495015/c-edo"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1557929346, "post_id": 56151169, "comment_id": 98932052, "body": "I need to write code for monthly report"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1557929460, "post_id": 56151169, "comment_id": 98932140, "body": "I mean, the criteria to copy every row is that Column I equals to 20, so you don&#39;t need to loop, just filter column I to show only values equal to 20 and then copy the whole range. No need for arrays or anything else is just 1 operation."}], "owner": {"reputation": 3, "user_id": 11495015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73a0a0a3b09b9c20ed13b18fb069a718?s=128&d=identicon&r=PG&f=1", "display_name": "C.Edo", "link": "https://stackoverflow.com/users/11495015/c-edo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557933848, "creation_date": 1557928721, "last_edit_date": 1557933848, "question_id": 56151169, "link": "https://stackoverflow.com/questions/56151169/copy-specific-columns-to-another-worksheet", "title": "Copy specific columns to another worksheet", "body": "<p>I have a main table with 7 columns, codename \"ShNote\", I want to run a code that find a value of 20 on last column (\"I\"). After, it will copy automatically the name of clients (column D) and its values (based on condition must be equal to 20) on column I. \nI am expecting the macro will copy these data and paste on another sheet, codename ShPPT, on column C &amp; D, starting row = 6. </p>\n\n<p>Normally, I have 4 clients, why it only copiied 1 client \nCan you help me to look after the code please? </p>\n\n<p>I am reading on some blogs that you can use array to optimize your code to become efficient </p>\n\n<p>P.s: This is only the beginning of my code, on column I, I am looking for this range of value \n1. 20\n2. 17-20 \n3. 15 - 17 \n4. 11 - 15 \n5. &lt; 11 </p>\n\n<p>Everytime my macro run, it copy automatically the client's name and its corresponding values.</p>\n\n<pre><code>Sub NoteLog()\n\n'1. Copy the client's name and its note ranked by 4 particular conditions (20;17-20;15-17;11-15;&lt;11)\n\nDim finalrow As Long, c As Long, i As Long, rowppt As Long, colppt As Long\n\nfinalrow = ShNote.Range(\"I\" &amp; Rows.Count).End(xlUp).Row\nrowppt = ShPPT.Cells(Rows.Count, 1).End(xlUp).Row\ncolppt = ShPPT.Cells(Rows.Count, 1).End(xlUp).Row\n\nFor c = 6 To finalrow\n    If ShNote.Range(\"I\" &amp; c).Value = 20 Then\n    ShNote.Range(\"D\" &amp; c).Copy\n    ShPPT.Cells(rowppt + 6, 3).PasteSpecial xlPasteValues\n    ShNote.Range(\"I\" &amp; c).Copy\n    ShPPT.Cells(colppt + 6, 4).PasteSpecial xlPasteValues\n    End If\nNext c\n  rowppt = rowppt + 1\n  colppt = colppt + 1\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1557928594, "post_id": 56151073, "comment_id": 98931531, "body": "The error message tells you that probably <code>link</code> is <code>Nothing</code> or not a link object and therefore has no <code>.href</code>."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 2, "creation_date": 1557928679, "post_id": 56151073, "comment_id": 98931594, "body": "@JNevill <code>Set link = h.ChildNodes.Item(0)</code> - it took me a while to find it lol."}, {"owner": {"reputation": 17, "user_id": 3659746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc42e4287d75c65ccb3aac5883ab6496?s=128&d=identicon&r=PG&f=1", "display_name": "user3659746", "link": "https://stackoverflow.com/users/3659746/user3659746"}, "edited": false, "score": 0, "creation_date": 1557928732, "post_id": 56151073, "comment_id": 98931629, "body": "Thank you for the answer! ...The code is 1:1 copied from a tutorial so it should work? ... how can i determine if link is nothing? Or how to try/catch the error if it is nothing?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1557928949, "post_id": 56151073, "comment_id": 98931769, "body": "Actually this is an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY-Problem</a>: You ask X but the problem is Y. \u2022 Please <a href=\"https://stackoverflow.com/posts/56151073/edit\">edit</a> your question (don&#39;t use comments) and add more information. What is the goal of your code? What would be the expected outcome? \u2022 Also include the link of the tutorial please."}, {"owner": {"reputation": 17, "user_id": 3659746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc42e4287d75c65ccb3aac5883ab6496?s=128&d=identicon&r=PG&f=1", "display_name": "user3659746", "link": "https://stackoverflow.com/users/3659746/user3659746"}, "edited": false, "score": 0, "creation_date": 1557929448, "post_id": 56151073, "comment_id": 98932129, "body": "@PEH: Edited the question! Thx"}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1557987149, "last_edit_date": 1557987149, "creation_date": 1557930615, "answer_id": 56151810, "question_id": 56151073, "link": "https://stackoverflow.com/questions/56151073/object-doesn%c2%b4t-support-this-property-or-method/56151810#56151810", "title": "Object doesn&#180;t support this property or method", "body": "<p>The issue is that Google obviously changed the code of the website since the tutorial was written. This method is not very reliable as everytime Google changes the website it can easily break your code.</p>\n\n<p>Try the following</p>\n\n<pre><code>Set div_result = internetdata.getElementById(\"res\")\nSet header_links = div_result.getElementsByTagName(\"a\")\n\nDim h As Variant\nFor Each h In header_links\n    Cells(Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1, 1) = h.href\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 3659746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc42e4287d75c65ccb3aac5883ab6496?s=128&d=identicon&r=PG&f=1", "display_name": "user3659746", "link": "https://stackoverflow.com/users/3659746/user3659746"}, "edited": false, "score": 0, "creation_date": 1557984036, "post_id": 56152935, "comment_id": 98950330, "body": "I tried this but it says &quot;done&quot; but there are no entries in the list!"}], "tags": [], "owner": {"reputation": 173, "user_id": 1719890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd25513c710f5a3d0d21b5dc195d6621?s=128&d=identicon&r=PG", "display_name": "Jitendra Singh", "link": "https://stackoverflow.com/users/1719890/jitendra-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1557934492, "last_edit_date": 1557934492, "creation_date": 1557934137, "answer_id": 56152935, "question_id": 56151073, "link": "https://stackoverflow.com/questions/56151073/object-doesn%c2%b4t-support-this-property-or-method/56152935#56152935", "title": "Object doesn&#180;t support this property or method", "body": "<p>If you want just the web results without the featured content and video links, you can use below. Also in this code you can control the page number you want to get the links fromby changing the variable pageNo.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Dim internet As Object\n    Dim internetdata As Object\n    Dim div_result As Object\n    Dim header_links As Object\n    Dim link As Object\n    Dim URL As String\n    Const pageNo = 10  '0 is page 1, 10 is page 2 and so on  0;10;20;30;40\n\n    Set internet = CreateObject(\"InternetExplorer.Application\")\n    internet.Visible = True\n\n    URL = \"https://www.google.co.in/search?q=how+to+program+in+vba\"\n    internet.navigate URL &amp; \"&amp;start=\" &amp; pageNo\n\n    Do Until internet.readyState &gt;= 4\n        DoEvents\n    Loop\n\n    Application.Wait Now + TimeSerial(0, 0, 5)\n\n    Set internetdata = internet.document\n    Set div_result = internetdata.getElementById(\"res\")\n    Set header_links = div_result.getelementsbytagname(\"h2\")\n\n    Dim h As Variant\n    For Each div In header_links\n        If div.innertext = \"Web results\" Then\n            Set Links = div.ParentElement.getelementsbytagname(\"a\")\n            For Each link In Links\n                Cells(Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1, 1) = link.href\n            Next\n        End If\n    Next\n    MsgBox \"done\"\n\nEnd Sub\n\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 3659746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc42e4287d75c65ccb3aac5883ab6496?s=128&d=identicon&r=PG&f=1", "display_name": "user3659746", "link": "https://stackoverflow.com/users/3659746/user3659746"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 56151810, "answer_count": 2, "score": 0, "last_activity_date": 1557987149, "creation_date": 1557928438, "last_edit_date": 1557929433, "question_id": 56151073, "link": "https://stackoverflow.com/questions/56151073/object-doesn%c2%b4t-support-this-property-or-method", "title": "Object doesn&#180;t support this property or method", "body": "<p>I followed a Tutorial and have an error while executing the code i copied:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Dim internet As Object\n    Dim internetdata As Object\n    Dim div_result As Object\n    Dim header_links As Object\n    Dim link As Object\n    Dim URL As String\n\n    Set internet = CreateObject(\"InternetExplorer.Application\")\n    internet.Visible = True\n\n    URL = \"https://www.google.co.in/search?q=how+to+program+in+vba\"\n    internet.navigate URL\n\n    Do Until internet.readyState &gt;= 4\n        DoEvents\n    Loop\n\n    Application.Wait Now + TimeSerial(0, 0, 5)\n\n    Set internetdata = internet.document\n    Set div_result = internetdata.getElementById(\"res\")\n\n\n    Set header_links = div_result.getElementsByTagName(\"h3\")\n\n    For Each h In header_links\n        Set link = h.ChildNodes.Item(0)\n        Cells(Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1, 1) = link.href\n    Next\n\n    MsgBox \"done\"\n\nEnd Sub\n</code></pre>\n\n<p>The error comes at </p>\n\n<pre><code>Cells(Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1, 1) = link.href\n</code></pre>\n\n<p>What ist wrong here?</p>\n\n<p>EDIT:\nThe code should give the URLs out of a google search and write it to excel list:</p>\n\n<p>The code is copied from here:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/19976326/getting-links-url-from-a-webpage-excel-vba\">Getting Links/URL from a webpage-Excel VBA</a></p>\n"}, {"tags": ["excel", "vba", "automation"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1557926361, "post_id": 56150376, "comment_id": 98930056, "body": "You can apply a formula to an entire range at once. <code>Range(&quot;myrange&quot;).FormulaR1C1 = ...</code>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1557926876, "post_id": 56150376, "comment_id": 98930414, "body": "You might benefit from reading  <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>. \u2022 This fills the formula into range G5:G10: <code>Range(&quot;G5:G10&quot;).FormulaR1C1 = &quot;=VLOOKUP(c[-6],sheet!c[-6],1,0)&quot;</code>"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1557928532, "post_id": 56150376, "comment_id": 98931497, "body": "To add onto @BigBen , if you put a formula in a range with relative references, they will update based on the <b>first cell</b> in the range, e.g., <code>.formula = &quot;=A1&quot;</code> will show up as A1, A2, A3, A4, etc., as it fills down the column, but <code>.formula = &quot;=A$1&quot;</code> will put A$1 into all cells down the column, as opposed to column-to-column where it will go A$1, B$1, C$1, etc.  This will occur regardless of your first cell in the range being A1, GD325, etc., so it helps to keep track of your starting location."}], "owner": {"reputation": 9, "user_id": 11409984, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1HJyGjZVqAM/AAAAAAAAAAI/AAAAAAAAAAs/96G0OQPOCtg/photo.jpg?sz=128", "display_name": "Tejeshkumar Chidanandappa", "link": "https://stackoverflow.com/users/11409984/tejeshkumar-chidanandappa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557926799, "creation_date": 1557926281, "last_edit_date": 1557926799, "question_id": 56150376, "link": "https://stackoverflow.com/questions/56150376/how-to-apply-vlookup-formula-to-multiple-rows", "title": "How to Apply Vlookup formula to multiple rows", "body": "<p>I applied a Vlookup formula to a row in a column and I want to apply same formula to multiple rows of same column.</p>\n\n<p>My Code is: </p>\n\n<pre><code>Range(\"G5\")\nActiveCell.FormulaR1C1 = \"=VLOOKUP(c[-6],sheet!c[-6],1,0)\"\nRange(\"G5\")\n</code></pre>\n"}, {"tags": ["excel", "vba", "vlookup"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1557926050, "post_id": 56150250, "comment_id": 98929838, "body": "Your loop is redundant, you don&#39;t need the <code>For Each cell</code> you are already looping through columns and rows. Also, storing both sheets in 2 arrays and indexing your matches in dictionaries would speed up a lot the task."}, {"owner": {"reputation": 331, "user_id": 2979307, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/017e89fe00adb3ebe734c62bd961da44?s=128&d=identicon&r=PG&f=1", "display_name": "DutchArjo", "link": "https://stackoverflow.com/users/2979307/dutcharjo"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1557927378, "post_id": 56150250, "comment_id": 98930731, "body": "I would like to know how to store both sheets in 2 arrays and index my matches in dictionaries, but for know that would take me to much time. I updated the code with a little adjustment bases on your comment and I am happy with the result so far."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1557927584, "post_id": 56150250, "comment_id": 98930865, "body": "Are the headers the same on both sheets?"}, {"owner": {"reputation": 331, "user_id": 2979307, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/017e89fe00adb3ebe734c62bd961da44?s=128&d=identicon&r=PG&f=1", "display_name": "DutchArjo", "link": "https://stackoverflow.com/users/2979307/dutcharjo"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1557927667, "post_id": 56150250, "comment_id": 98930926, "body": "yes, they will when I change the code to add the headers to the sheet."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1557927713, "post_id": 56150250, "comment_id": 98930965, "body": "give me 5 mins i&#39;ll give you an answer that won&#39;t depend on counting where are the headers."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1557928809, "post_id": 56150250, "comment_id": 98931674, "body": "For the sake of adding information... StackOverflow is more appropriate for aiding in specific coding issues, while review and optimizing of working code is more in scope for <a href=\"https://codereview.stackexchange.com/\">CodeReview</a>."}, {"owner": {"reputation": 331, "user_id": 2979307, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/017e89fe00adb3ebe734c62bd961da44?s=128&d=identicon&r=PG&f=1", "display_name": "DutchArjo", "link": "https://stackoverflow.com/users/2979307/dutcharjo"}, "edited": false, "score": 0, "creation_date": 1557929091, "post_id": 56150250, "comment_id": 98931862, "body": "I was not aware of the existence of Code review. I will check that next time!"}], "answers": [{"comments": [{"owner": {"reputation": 331, "user_id": 2979307, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/017e89fe00adb3ebe734c62bd961da44?s=128&d=identicon&r=PG&f=1", "display_name": "DutchArjo", "link": "https://stackoverflow.com/users/2979307/dutcharjo"}, "edited": false, "score": 0, "creation_date": 1557929035, "post_id": 56151059, "comment_id": 98931834, "body": "I would never be able create this myself. I am going to test and use it, and hopefully understand it anytime soon."}], "tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": false, "score": 1, "last_activity_date": 1557928391, "creation_date": 1557928391, "answer_id": 56151059, "question_id": 56150250, "link": "https://stackoverflow.com/questions/56150250/make-routine-more-efficient/56151059#56151059", "title": "make routine more efficient?", "body": "<p>Here:</p>\n\n<pre><code>Option Explicit\nSub Test()\n\n    Dim arrSource, arrData, i As Long, j As Long, ColI As Long, ColF As Long\n    Dim DictMatches As New Scripting.Dictionary\n    Dim DictHeaders As New Scripting.Dictionary\n\n    With ThisWorkbook\n        arrSource = .Sheets(\"omzet\").UsedRange.Value\n        arrData = .Sheets(\"SheetName\").UsedRange.Value 'change this for the worksheet you are working on\n    End With\n\n    For i = 1 To UBound(arrSource, 2) 'this will store the headers position\n        DictHeaders.Add arrSource(1, i) 'this will throw an error if you have any duplicate headers\n    Next i\n\n    For i = 2 To UBound(arrSource) 'this will store the row position for each match\n        DictMatches.Add arrSource(i, 3), i 'this will throw an error if you have any duplicates\n    Next i\n\n    'Here you can change where you want to evaluate your data\n    ColI = 108\n    ColF = 112\n\n    For i = 2 To UBound(arrData) 'loop through rows\n        For j = ColI To ColF 'loop through columns\n            arrData(i, j) = arrSource(DictMatches(arrData(i, 3), DictHeaders(1, j)))\n        Next j\n    Next i\n\n    'Paste the arrData back to the sheet\n    ThisWorkbook.Sheets(\"SheetName\").UsedRange.Value = arrData\n\nEnd Sub\n</code></pre>\n\n<p>This is the fastest way, why? </p>\n\n<ol>\n<li>You store both sheets into the arrays and from then on you work only with the arrays(which means working on memory, so working faster)</li>\n<li>Using excel functions always slow downs the process, instead we are storing all the index values on rows and headers for the omzet sheet, so when you point to a value from Column C on your working sheet, it gives you the result without calculating anything.</li>\n</ol>\n\n<p>Here: <code>arrSource(DictMatches(arrData(i, 3), DictHeaders(1, j)))</code> we are giving a row position and column position.</p>\n\n<p><code>DictMatches(arrData(i, 3)</code> will give you back the row where that match was found inside the dicitonary. <code>DictHeaders(1, j)</code> will give you back the column where that header was found inside the dictionary.</p>\n\n<p>Note: for dictionaries to work you need the <code>Microsoft Scripting Runtime</code> library checked on your references. Also Dictionaries are <code>Case Sensitive</code>so  <code>Hello &lt;&gt; hello</code>.</p>\n"}], "owner": {"reputation": 331, "user_id": 2979307, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/017e89fe00adb3ebe734c62bd961da44?s=128&d=identicon&r=PG&f=1", "display_name": "DutchArjo", "link": "https://stackoverflow.com/users/2979307/dutcharjo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557928391, "creation_date": 1557925942, "last_edit_date": 1557927305, "question_id": 56150250, "link": "https://stackoverflow.com/questions/56150250/make-routine-more-efficient", "title": "make routine more efficient?", "body": "<p>I have this code to find the values that belong to the value in cell C3 (and further down):</p>\n\n<pre><code>aantalrijen = .Range(\"A2\", .Range(\"A2\").End(xlDown)).Cells.Count\n    For I = 2 To aantalrijen + 1\n        For J = 108 To 112\n            For Each cell In .Range(.Cells(2, J), .Cells(aantalrijen, J)).Cells\n                cell.Value = Application.VLookup(.Cells(I, 3), Sheets(\"omzet\").Range(\"C:DH\"), J - 2, 0)\n            Next cell\n        Next J\n    Next I\n</code></pre>\n\n<p>I am aware this cannot be the most efficient way to get the desired result. How should I adjust the code to make it the most efficient?</p>\n\n<p><strong>Update:</strong></p>\n\n<p>For now I am satisfied with this result:</p>\n\n<pre><code>aantalrijen = .Range(\"A2\", .Range(\"A2\").End(xlDown)).Cells.Count\n    For J = 108 To 112\n        For I = 2 To aantalrijen\n            .Cells(I, J).Value = Application.VLookup(.Cells(I, 3), Sheets(\"omzet\").Range(\"C:DH\"), J - 2, 0)\n        Next I\n    Next J\n\nEnd With\n</code></pre>\n\n<p>it is fast enough for me now and it returns the desired results.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 2, "creation_date": 1557925701, "post_id": 56150145, "comment_id": 98929612, "body": "There are 2 ways. <code>ThisWorkbook.RefreshAll</code> or <code>ThisWorkbook.Sheets(&quot;SheetName&quot;).Calculate</code> the first one will refresh everything on your workbook, the  second will recalculate anything on that sheet."}, {"owner": {"reputation": 1, "user_id": 11504212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a7499254f13419d9a7652c5456c396f?s=128&d=identicon&r=PG&f=1", "display_name": "nickthekidd", "link": "https://stackoverflow.com/users/11504212/nickthekidd"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1557930600, "post_id": 56150145, "comment_id": 98932943, "body": "Thanks Damian - but doesn&#39;t seem to work.  It refreshes the current workbook, but I need it also to refresh the calculation in other linked workbooks, i.e. S1 is refreshing, but still pulling old info from S2 because S2 is not refreshed."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1557930662, "post_id": 56150145, "comment_id": 98932988, "body": "Ah! That&#39;s different, are your workbooks open? If so, make a loop through all the workbooks using the <code>Workbook.RefreshAll</code>"}, {"owner": {"reputation": 1, "user_id": 11504212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a7499254f13419d9a7652c5456c396f?s=128&d=identicon&r=PG&f=1", "display_name": "nickthekidd", "link": "https://stackoverflow.com/users/11504212/nickthekidd"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1557932349, "post_id": 56150145, "comment_id": 98934105, "body": "Ideally, the downstream workbooks will all be closed.  Can I push a loop through them without opening them, and if so, how?"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1557932470, "post_id": 56150145, "comment_id": 98934157, "body": "Open-Refresh-Refresh your workbook-Close and repeat. Or open them all, refresh them all and then refresh yours to finally close them. You need to open them, Though you can do that disabling screen updating so the user won&#39;t notice &quot;much&quot; or making the application invisible."}, {"owner": {"reputation": 1, "user_id": 11504212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a7499254f13419d9a7652c5456c396f?s=128&d=identicon&r=PG&f=1", "display_name": "nickthekidd", "link": "https://stackoverflow.com/users/11504212/nickthekidd"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1557934354, "post_id": 56150145, "comment_id": 98935327, "body": "Thanks... is there a way I can import the code / calculations into the main sheet without physically moving all the tabs across?"}, {"owner": {"reputation": 1, "user_id": 11504212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a7499254f13419d9a7652c5456c396f?s=128&d=identicon&r=PG&f=1", "display_name": "nickthekidd", "link": "https://stackoverflow.com/users/11504212/nickthekidd"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1557936082, "post_id": 56150145, "comment_id": 98936308, "body": "Thanks - a little clunky but seems to work OK.  Really appreciate the help!"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1557938450, "post_id": 56150145, "comment_id": 98937419, "body": "I don&#39;t what do you want to import? Data to the sheet?"}, {"owner": {"reputation": 1, "user_id": 11504212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a7499254f13419d9a7652c5456c396f?s=128&d=identicon&r=PG&f=1", "display_name": "nickthekidd", "link": "https://stackoverflow.com/users/11504212/nickthekidd"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1557947421, "post_id": 56150145, "comment_id": 98941396, "body": "Yes, no worries - I&#39;ve managed to get your solution working... seems to be good!"}], "owner": {"reputation": 1, "user_id": 11504212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a7499254f13419d9a7652c5456c396f?s=128&d=identicon&r=PG&f=1", "display_name": "nickthekidd", "link": "https://stackoverflow.com/users/11504212/nickthekidd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557925586, "creation_date": 1557925586, "question_id": 56150145, "link": "https://stackoverflow.com/questions/56150145/executing-calculations-in-linked-spreadsheets", "title": "Executing calculations in linked spreadsheets", "body": "<p>I have built a fairly complex VBA userform in an Excel spreadsheet file (let's call it S1).  One of the outputs of this userform is a string of data that drops into a tab.</p>\n\n<p>This string of data is linked in to another spreadsheet (S2).  This is done by simply linking cells from S2 to S1, e.g. =S1,tab!A2.</p>\n\n<p>Calculations are then undertaken in S2, and a string of outputs are created in S2.  These outputs in S2 are linked back to cells in S1 (same basic method).</p>\n\n<p>I want this whole process to run automatically whilst I am executing the userform in S1, i.e. while the form is still up, I want the links to be refreshed, calculations to be made, and then bring that new information into the Userform.</p>\n\n<p>This works OK if both spreadsheets are open at the same time, but that's not practical.  Also, there will ultimately be several other downstream linked spreadsheets.</p>\n\n<p>Right now, however, whilst I can drop the string of data into S1, and pick up the new data from S1 - the calculation using that data is not being refreshed in S2.</p>\n\n<p>I have added a script to a macro that is called in the userform to drop data into S1 and pick up the calculated data in S1.</p>\n\n<p>Doesn't seem to make any difference.</p>\n\n<pre><code>ActiveWorkbook.UpdateLink Name:= _\n    \"T:\\_x\\x\\xx\\S2.xlsx\" _\n    , Type:=xlExcelLinks\n</code></pre>\n\n<p>Hoping there is a way to get these links / calculations refreshed mid stream.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 4, "creation_date": 1557925390, "post_id": 56149971, "comment_id": 98929414, "body": "loop through all the labels. <code>Dim i As Long</code> <code>i = i + Int(Label)</code> (this if your numbers are integers)."}, {"owner": {"reputation": 39, "user_id": 11241794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f9f9142489e7385f3624eb780bdb1e?s=128&d=identicon&r=PG&f=1", "display_name": "User1932s", "link": "https://stackoverflow.com/users/11241794/user1932s"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1557928518, "post_id": 56149971, "comment_id": 98931486, "body": "@Damian one last question, I would like to make my label which is a caption to equal to a cell. How can I go about this?"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1557928629, "post_id": 56149971, "comment_id": 98931559, "body": "<a href=\"https://stackoverflow.com/a/20677557/7558682\">Here</a> this will help you."}], "owner": {"reputation": 39, "user_id": 11241794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f9f9142489e7385f3624eb780bdb1e?s=128&d=identicon&r=PG&f=1", "display_name": "User1932s", "link": "https://stackoverflow.com/users/11241794/user1932s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1557926016, "creation_date": 1557925129, "last_edit_date": 1557926016, "question_id": 56149971, "link": "https://stackoverflow.com/questions/56149971/how-to-let-a-label-sum-of-other-labels", "title": "How to let a label = sum of other labels", "body": "<p>I understand that labels are stored as text.</p>\n\n<p>How can I convert my labels to numbers, so that I can have a label that's a sum of all other labels?</p>\n"}, {"tags": ["vba", "powerpoint", "powerpoint-addins"], "answers": [{"comments": [{"owner": {"reputation": 1641, "user_id": 1232660, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3843a2bbd046589aeba450315a996d8d?s=128&d=identicon&r=PG", "display_name": "Jeyekomon", "link": "https://stackoverflow.com/users/1232660/jeyekomon"}, "edited": false, "score": 0, "creation_date": 1557933228, "post_id": 56151603, "comment_id": 98934642, "body": "The steps I took were so similar in Excel and PowerPoint that I have no idea why the developers decided to deny loading macros from PowerPoint addins while allowed loading them from Excel addins. Very strange. Also I declared my subroutine explicitly as public and it did not help. Thank you for the ribbon coding advice. Though it looks like a bit of work, it seems that it is the only option."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "reply_to_user": {"reputation": 1641, "user_id": 1232660, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3843a2bbd046589aeba450315a996d8d?s=128&d=identicon&r=PG", "display_name": "Jeyekomon", "link": "https://stackoverflow.com/users/1232660/jeyekomon"}, "edited": false, "score": 1, "creation_date": 1558011986, "post_id": 56151603, "comment_id": 98965150, "body": "People think of Microsoft as one huge monolith; in reality, it&#39;s more like an empire built of many smaller fiefdoms. The PowerPoint team, in fact, is not even in Redmond with the rest of Microsoft."}], "tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": true, "score": 2, "last_activity_date": 1557930033, "creation_date": 1557930033, "answer_id": 56151603, "question_id": 56149945, "link": "https://stackoverflow.com/questions/56149945/cannot-add-a-custom-powerpoint-add-in-to-the-ribbon/56151603#56151603", "title": "Cannot add a custom PowerPoint Add-In to the ribbon", "body": "<p>PowerPoint &lt;> Excel.</p>\n\n<p>It <em>might</em> work if you declared your add-in subroutines as Public, but the usual way to do this is to add RibbonX code to your PPTM/saved PPAM that creates the buttons etc. you want.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/13842285/adding-a-macro-from-powerpoint-add-in-to-ribbon?rq=1\">Adding a macro from PowerPoint add-in to ribbon</a></p>\n\n<p>The Leaf Creations editor mentioned there is gone, but Ron DeBruin's site is a gold mine of good advice.  </p>\n\n<p>Ken Puls et al have a great book on RibbonX coding; it might seem to be out of date but most of the info is still good:</p>\n\n<p><a href=\"https://rads.stackoverflow.com/amzn/click/com/B001DIRYWU\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\">https://www.amazon.com/RibbonX-Customizing-Office-2007-Ribbon-ebook/dp/B001DIRYWU/ref=sr_1_1?keywords=ken+puls+ribbonx&amp;qid=1557929946&amp;s=gateway&amp;sr=8-1-spell</a></p>\n"}], "owner": {"reputation": 1641, "user_id": 1232660, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3843a2bbd046589aeba450315a996d8d?s=128&d=identicon&r=PG", "display_name": "Jeyekomon", "link": "https://stackoverflow.com/users/1232660/jeyekomon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 56151603, "answer_count": 1, "score": 0, "last_activity_date": 1593766476, "creation_date": 1557925046, "last_edit_date": 1593766476, "question_id": 56149945, "link": "https://stackoverflow.com/questions/56149945/cannot-add-a-custom-powerpoint-add-in-to-the-ribbon", "title": "Cannot add a custom PowerPoint Add-In to the ribbon", "body": "<p>To create an <strong>Excel Add-In (*.xlam)</strong> I follow these steps:</p>\n\n<ol>\n<li>Open a new Excel file \u2192 Developer \u2192 Visual Basic \u2192 Insert \u2192 Module</li>\n<li>Insert a most basic <a href=\"https://www.i-programmer.info/ebooks/automating-excel/1264-getting-started.html?start=1\" rel=\"nofollow noreferrer\">Hello World subroutine</a></li>\n<li>(Excel file) \u2192 Save As \u2192 Excel Add-In (*.xlam)</li>\n<li>The add-in is saved at <code>C:\\Documents and Settings\\&lt;user&gt;\\Application Data\\Microsoft\\AddIns</code></li>\n<li>Open a new Excel file \u2192 File \u2192 Options \u2192 Add-Ins \u2192 Excel Addins \u2192 Go</li>\n<li>Click checkbox to enable my Hello addin \u2192 OK</li>\n<li>(Right click on the ribbon) \u2192 Customize the Ribbon</li>\n</ol>\n\n<p>Now when I select a drop-down box <code>Choose commands from</code> and select the <code>Macros</code> option, I see my Hello subroutine listed there. I can add it to the ribbon.\n<hr>\nWhen I try to imitate this procedure to create a <strong>PowerPoint Add-In (*.ppam)</strong>, I follow all 7 steps but then I select the <code>Macros</code> option in the <code>Choose commands from</code> drop-down box and I don't see my subroutine listed there. The column is empty. I thus cannot add my add-in to the ribbon.</p>\n\n<p>What did I do wrong? Why this procedure works in Excel but not in PowerPoint? How can I add my PowerPoint Add-In to the ribbon?</p>\n"}, {"tags": ["excel", "vba", "userform"], "answers": [{"comments": [{"owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "edited": false, "score": 0, "creation_date": 1557925138, "post_id": 56149936, "comment_id": 98929230, "body": "That&#39;s what I call thinking outside the box :) This is solution to my question actually but I would like to see an option to use controls just in case I will need them in the future."}, {"owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "edited": false, "score": 0, "creation_date": 1557926233, "post_id": 56149936, "comment_id": 98929962, "body": "Ok, this is actually what I have tried already. I just found out that the problem is that if I first open userform and then run <code>Flights.WebBrowser1.Document.getElementsByName(&quot;q&quot;)(0).Value = &quot;Washington&quot;</code> by separate button it works. However if it is like in my code, it seems that page isn&#39;t loaded yet when code tries to input value to Google Maps search box. Is there any ideas how to automate the whole thing so there will be no need to click any other buttons?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "edited": false, "score": 0, "creation_date": 1557926523, "post_id": 56149936, "comment_id": 98930153, "body": "Yes you will need to check if the browser is ready and the page is loaded. See my edit. But actually the direct navigate should be a lot faster then filling the form and sending another request."}, {"owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "edited": false, "score": 0, "creation_date": 1557926888, "post_id": 56149936, "comment_id": 98930428, "body": "Thank you for your help! There is anyway some issue with <code>UserForm_Initialize</code> as it is not opening with this code. However everything works by separate button. Maybe computer is not so fast to do all the things on <code>UserForm_Initialize</code> and code should be connected to some other process."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1557926495, "last_edit_date": 1557926495, "creation_date": 1557925026, "answer_id": 56149936, "question_id": 56149742, "link": "https://stackoverflow.com/questions/56149742/search-for-city-on-google-maps-inside-excel-userform-on-initialize/56149936#56149936", "title": "Search for city on Google Maps inside Excel Userform on Initialize", "body": "<p>Just navigate to <code>https://www.google.com/maps?q=washington</code> or <code>https://maps.google.com?q=washington</code>.</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\n    Flights.WebBrowser1.Navigate \"https://maps.google.com?q=washington\"\n\nEnd Sub\n</code></pre>\n\n<p>alternatively you could try (not tested)</p>\n\n<pre><code>With Flights.WebBrowser1\n    .Navigate \"https://maps.google.com\"\n    Do While .readyState &lt;&gt; 4 Or .Busy: DoEvents: Loop 'wait until page loads\n    .Document.getElementsByName(\"q\")(0).Value = \"Washington\"\n    .Document.getElementsByID(\"searchbox_form\")(0).submit\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 56149936, "answer_count": 1, "score": 0, "last_activity_date": 1557926495, "creation_date": 1557924497, "question_id": 56149742, "link": "https://stackoverflow.com/questions/56149742/search-for-city-on-google-maps-inside-excel-userform-on-initialize", "title": "Search for city on Google Maps inside Excel Userform on Initialize", "body": "<p>I am wondering if it possible to search for specific city on Google Map inside Excel userform once Userform is opened? </p>\n\n<p>Userform has a name <code>Flights</code>. It has Web browser with name <code>WebBrowser1</code></p>\n\n<p>Here is my current code:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\n    Flights.WebBrowser1.Navigate \"https://maps.google.com\"\n\nEnd Sub\n</code></pre>\n\n<p>I have tried:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\n    Flights.WebBrowser1.Navigate \"https://maps.google.com\"\n    Flights.WebBrowser1.Document.getElementsByName(\"q\")(0).Value = \"Washington\"\n    Flights.WebBrowser1.Document.getElementsByClassName(\"searchbox-searchbutton\")(0).Click\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1557924693, "post_id": 56149441, "comment_id": 98928931, "body": "Have a look <a href=\"https://stackoverflow.com/questions/38916459/how-do-i-reference-charts-with-the-same-name-but-on-different-worksheets\">here</a>. I assume you have charts of the same name in different sheets, and activating the correct sheet seems necesary to access the correct chart. Or are your charts on the same sheet? In that case, maybe loop through these chartobjects and check their topleftcell?"}, {"owner": {"reputation": 545, "user_id": 11356960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47cda0d343183c7e4d9d5961845654b0?s=128&d=identicon&r=PG&f=1", "display_name": "NoNameNo123", "link": "https://stackoverflow.com/users/11356960/nonameno123"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1557927824, "post_id": 56149441, "comment_id": 98931038, "body": "@JvdV Same sheet. I could check for a header, that should work (do charts even have cells?), so thank you."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1557931971, "post_id": 56149441, "comment_id": 98933860, "body": "@JvdV if you programmatically create a chart, you can have the same name on a sheet (bad practice).  with that, you need to find a close target... Pythagorean theorem to find closest location to the target."}], "answers": [{"comments": [{"owner": {"reputation": 545, "user_id": 11356960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47cda0d343183c7e4d9d5961845654b0?s=128&d=identicon&r=PG&f=1", "display_name": "NoNameNo123", "link": "https://stackoverflow.com/users/11356960/nonameno123"}, "edited": false, "score": 0, "creation_date": 1557934555, "post_id": 56152105, "comment_id": 98935439, "body": "I&#39;ll have to try this tomorrow, but this looks very promising. Thank you!"}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": true, "score": 1, "last_activity_date": 1557931518, "creation_date": 1557931518, "answer_id": 56152105, "question_id": 56149441, "link": "https://stackoverflow.com/questions/56149441/vba-telling-two-charts-with-the-same-name-apart/56152105#56152105", "title": "VBA: Telling two charts with the same name apart?", "body": "<p>You can determine which chart is closest to a target location such that:</p>\n\n<pre><code>Dim ch As ChartObject, chr As Long, chc As Long, r As Long, c As Long, chin As Long, locr As Long, locc As Long\nr = 24  'row 24, target\nc = 11  'column k, target\nFor Each ch In ActiveSheet.ChartObjects\n    chr = ch.TopLeftCell.Row\n    chc = ch.TopLeftCell.Column\n    If Sqr((r - chr) ^ 2 + (c - chc) ^ 2) &lt; Sqr((r - locr) ^ 2 + (c - locc) ^ 2) Or locr = 0 Then\n        locr = chr\n        locc = chc\n        chin = ch.Index\n    End If\nNext ch\nDebug.Print chin\n</code></pre>\n\n<p>You can use the chart index (chin) to copy such that:</p>\n\n<pre><code>activesheets.chartobjects(chin).activate\nactivechart.parent.copy\n</code></pre>\n"}], "owner": {"reputation": 545, "user_id": 11356960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47cda0d343183c7e4d9d5961845654b0?s=128&d=identicon&r=PG&f=1", "display_name": "NoNameNo123", "link": "https://stackoverflow.com/users/11356960/nonameno123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 56152105, "answer_count": 1, "score": 0, "last_activity_date": 1557931731, "creation_date": 1557923532, "question_id": 56149441, "link": "https://stackoverflow.com/questions/56149441/vba-telling-two-charts-with-the-same-name-apart", "title": "VBA: Telling two charts with the same name apart?", "body": "<p>I'm working on a file that has gone through lots of hands. One of the charts I need is named \"Dummy_1\"; unfortunately, another chart has the same name. So <code>ws.ChartObjects(\"Dummy_1\").Copy</code> gives me the wrong one. </p>\n\n<p>Is there a way to differentiate between the two? Or in general, is there a way to target a chart other than by name? I know I can select it by index, but that's not really what I would call \"targeted\". Is there the possibility to pick the chart that is closest to a certain cell?  </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1557924133, "post_id": 56149414, "comment_id": 98928569, "body": "If dates don&#39;t get sorted chronologically, chances are high that they are not really dates. Please upload a data sample. Best would be an actual Excel file, so we can see the data types in the cells. Upload to an ad-free file sharing service like Dropbox or OneDrive, share the file and post a link. Post that link into your question, not a comment. then leave a comment to alert the people who are following this question."}, {"owner": {"reputation": 11, "user_id": 11492276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b90726e4e2ccb4b038992dcf461f62dc?s=128&d=identicon&r=PG&f=1", "display_name": "Manohar", "link": "https://stackoverflow.com/users/11492276/manohar"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1558356248, "post_id": 56149414, "comment_id": 99062920, "body": "Thanks. I got this problem sorted. Actually the problem is not with dates, the problem is with another column where it has data such as BIM-0000078-2019."}], "owner": {"reputation": 11, "user_id": 11492276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b90726e4e2ccb4b038992dcf461f62dc?s=128&d=identicon&r=PG&f=1", "display_name": "Manohar", "link": "https://stackoverflow.com/users/11492276/manohar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 17, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557923445, "creation_date": 1557923445, "question_id": 56149414, "link": "https://stackoverflow.com/questions/56149414/excel-secondary-sorting-doesnt-work-any-work-around-manually-or-with-vba", "title": "Excel secondary sorting doesn&#39;t work. Any work around manually or with VBA?", "body": "<p>I have data in four columns and i need data first to be sorted by column \"A and then by Column \"C\". When i use sorting at multi level still the column \"C\" didn't get sorted (Column C has dates). Any help to do it manually or with macro is much appreciated.</p>\n\n<p>I tried all ways, formatting is good, no extra spaces, no formulas...etc</p>\n"}, {"tags": ["excel", "vba", "hyperlink", "reference", "http-status-code-403"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11503880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2134c2dc254375b6ee77df06117ba4f?s=128&d=identicon&r=PG&f=1", "display_name": "Paula", "link": "https://stackoverflow.com/users/11503880/paula"}, "edited": false, "score": 0, "creation_date": 1557929876, "post_id": 56149542, "comment_id": 98932432, "body": "Hi! Thanks for answering. I changed the function for yours, and it still appears the same problem. I&#39;m trying with an URL that leads to a 404 page (<a href=\"http://www.nisbets.ie/dualit-black-kettle/cc804?vatToggle=incvat\" rel=\"nofollow noreferrer\">nisbets.ie/dualit-black-kettle/cc804?vatToggle=incvat</a>) and one that works (<a href=\"https://www.nisbets.ie/dualit-bread-toaster-6-slice-stainless-steel/e972?vatToggle=incvat\" rel=\"nofollow noreferrer\">nisbets.ie/dualit-bread-toaster-6-slice-stainless-steel/&hellip;</a>) but in both cases in the cell near them appears &quot;403 Forbidden&quot;."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 13, "user_id": 11503880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2134c2dc254375b6ee77df06117ba4f?s=128&d=identicon&r=PG&f=1", "display_name": "Paula", "link": "https://stackoverflow.com/users/11503880/paula"}, "edited": false, "score": 0, "creation_date": 1557930166, "post_id": 56149542, "comment_id": 98932612, "body": "@Paula Change <code>xhr.Open &quot;HEAD&quot;, strUrl, False</code> to <code>xhr.Open &quot;GET&quot;, strUrl, False</code>"}, {"owner": {"reputation": 13, "user_id": 11503880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2134c2dc254375b6ee77df06117ba4f?s=128&d=identicon&r=PG&f=1", "display_name": "Paula", "link": "https://stackoverflow.com/users/11503880/paula"}, "edited": false, "score": 0, "creation_date": 1558000405, "post_id": 56149542, "comment_id": 98958440, "body": "Thanks! Is it working now :) Only pitty is that it takes a lot of time to run on long lists of hyperlinks, but I guess I have to be patient! Thanks for the help."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 13, "user_id": 11503880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2134c2dc254375b6ee77df06117ba4f?s=128&d=identicon&r=PG&f=1", "display_name": "Paula", "link": "https://stackoverflow.com/users/11503880/paula"}, "edited": false, "score": 0, "creation_date": 1558000526, "post_id": 56149542, "comment_id": 98958520, "body": "@Paula Of course it takes time because it has to wait for every website to send an answer and VBA does not support multi threadding, so each URL is checked one after the other (parrallel checking would only work with multiple threads, but therefore you would need to to it with something else than Excel)."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1557924470, "last_edit_date": 1557924470, "creation_date": 1557923878, "answer_id": 56149542, "question_id": 56149150, "link": "https://stackoverflow.com/questions/56149150/bulk-check-the-status-of-an-hyperlink/56149542#56149542", "title": "Bulk check the status of an hyperlink", "body": "<p>The error occurs for example if you try to access <code>http://www.google.com</code> but it works on <code>https://www.google.com</code> (you can test it with <code>Debug.Print GetResult(\"https://www.google.com\"</code> where you get <code>200 OK</code> as result)</p>\n\n<p>So it obviously doesn't follow the redirects for the <code>http://</code> to <code>https://</code> that Google has set.</p>\n\n<p>Alternatively use the <a href=\"https://docs.microsoft.com/en-us/windows/desktop/WinHttp/winhttprequest\" rel=\"nofollow noreferrer\">WinHttpRequest object</a> as follows instead of <code>GetResult</code>:</p>\n\n<pre><code>Private Function GetResultExtended(ByVal strUrl As String) As String\n    On Error GoTo ErrorHandler\n\n    Dim xhr As Object\n    Set xhr = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\n\n    xhr.Option(6) = True 'follow redirects\n    xhr.Open \"HEAD\", strUrl, False\n    xhr.send\n\n    GetResultExtended = xhr.Status &amp; \" \" &amp; xhr.statusText\n    Exit Function\n\nErrorHandler:\n    GetResultExtended = \"Error: \" &amp; Err.Description\nEnd Function\n</code></pre>\n\n<p>Instead of <code>xhr.Option(6)</code> you could also use <code>xhr.Option(WinHttpRequestOption_EnableRedirects)</code> if you define the following <a href=\"https://docs.microsoft.com/en-us/windows/desktop/WinHttp/winhttprequestoption\" rel=\"nofollow noreferrer\">WinHttpRequestOption enumeration</a> above your function:</p>\n\n<pre><code>Option Explicit\n\nPrivate Enum WinHttpRequestOption\n    WinHttpRequestOption_UserAgentString\n    WinHttpRequestOption_URL\n    WinHttpRequestOption_URLCodePage\n    WinHttpRequestOption_EscapePercentInURL\n    WinHttpRequestOption_SslErrorIgnoreFlags\n    WinHttpRequestOption_SelectCertificate\n    WinHttpRequestOption_EnableRedirects\n    WinHttpRequestOption_UrlEscapeDisable\n    WinHttpRequestOption_UrlEscapeDisableQuery\n    WinHttpRequestOption_SecureProtocols\n    WinHttpRequestOption_EnableTracing\n    WinHttpRequestOption_RevertImpersonationOverSsl\n    WinHttpRequestOption_EnableHttpsToHttpRedirects\n    WinHttpRequestOption_EnablePassportAuthentication\n    WinHttpRequestOption_MaxAutomaticRedirects\n    WinHttpRequestOption_MaxResponseHeaderSize\n    WinHttpRequestOption_MaxResponseDrainSize\n    WinHttpRequestOption_EnableHttp1_1\n    WinHttpRequestOption_EnableCertificateRevocationCheck\nEnd Enum\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11503880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2134c2dc254375b6ee77df06117ba4f?s=128&d=identicon&r=PG&f=1", "display_name": "Paula", "link": "https://stackoverflow.com/users/11503880/paula"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "accepted_answer_id": 56149542, "answer_count": 1, "score": 1, "last_activity_date": 1557924470, "creation_date": 1557922522, "last_edit_date": 1557922959, "question_id": 56149150, "link": "https://stackoverflow.com/questions/56149150/bulk-check-the-status-of-an-hyperlink", "title": "Bulk check the status of an hyperlink", "body": "<p>I have a long list of hyperlinks on excel and would like to create a code that checks on the selection whether those links drive to an error page or not. </p>\n\n<p>I adapted the code from this post <a href=\"https://stackoverflow.com/questions/1118221/sort-dead-hyperlinks-in-excel-with-vba\">Sort dead hyperlinks in Excel with VBA?</a></p>\n\n<p>However, each time I run it the error </p>\n\n<blockquote>\n  <p>\"403 - Forbidden\" </p>\n</blockquote>\n\n<p>appears, no matter if the link works or not. </p>\n\n<p>What I would like the code to do is write in the next cell leads to a 404 page or not.\nI guess the problem is the lack of an extra line authorising excel to follow the hyperlink, but I can't think on how to solve this.</p>\n\n<p>This is the code I'm using:</p>\n\n<pre><code>Sub CheckHyperlinks()    \n    Dim oColumn As Range\n\n    Dim oCell As Range\n    For Each oCell In Selection    \n        If oCell.Hyperlinks.Count &gt; 0 Then   \n            Dim oHyperlink As Hyperlink\n            Set oHyperlink = oCell.Hyperlinks(1) ' I assume only 1 hyperlink per cell\n\n            Dim strResult As String\n            strResult = GetResult(oHyperlink.Address)\n            oCell.Offset(0, 1).Value = strResult\n        End If\n    Next oCell\nEnd Sub\n\nPrivate Function GetResult(ByVal strUrl As String) As String\n    On Error GoTo ErrorHandler\n\n    Dim oHttp As New MSXML2.XMLHTTP60\n\n    oHttp.Open \"HEAD\", strUrl, False\n    oHttp.send\n\n    GetResult = oHttp.Status &amp; \" \" &amp; oHttp.statusText\n\n    Exit Function\n\nErrorHandler:\n    GetResult = \"Error: \" &amp; Err.Description  \nEnd Function\n</code></pre>\n"}, {"tags": ["sql-server", "vba", "ms-access", "stored-procedures"], "comments": [{"owner": {"reputation": 34977, "user_id": 3711162, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7XKVx.png?s=128&g=1", "display_name": "Dan Guzman", "link": "https://stackoverflow.com/users/3711162/dan-guzman"}, "edited": false, "score": 1, "creation_date": 1557923471, "post_id": 56148797, "comment_id": 98928161, "body": "The error might be related to the value you are passing (8053). The actual parameter type of <code>decimal(3,1)</code> has a max value of 99.9."}, {"owner": {"reputation": 33, "user_id": 6590165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b2719548c8fa175184d6d975b10340a?s=128&d=identicon&r=PG&f=1", "display_name": "argent65", "link": "https://stackoverflow.com/users/6590165/argent65"}, "reply_to_user": {"reputation": 34977, "user_id": 3711162, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7XKVx.png?s=128&g=1", "display_name": "Dan Guzman", "link": "https://stackoverflow.com/users/3711162/dan-guzman"}, "edited": false, "score": 0, "creation_date": 1557927166, "post_id": 56148797, "comment_id": 98930606, "body": "Thanks for the reply. Param2 is the record id and that does function without issue. The issue is definitely with param1/ OCR_Freq variable."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1557927843, "post_id": 56148797, "comment_id": 98931053, "body": "Which OLEDB provider are you using (version)? Old version of OLEDB drivers can have issues with decimals."}, {"owner": {"reputation": 33, "user_id": 6590165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b2719548c8fa175184d6d975b10340a?s=128&d=identicon&r=PG&f=1", "display_name": "argent65", "link": "https://stackoverflow.com/users/6590165/argent65"}, "edited": false, "score": 0, "creation_date": 1557929841, "post_id": 56148797, "comment_id": 98932409, "body": "The connection string I am using is: ODBC;DRIVER={SQL Server};SERVER=serverName;DATABASE=dbaseName;Trusted_Connect&zwnj;&#8203;ion=Yes"}, {"owner": {"reputation": 33, "user_id": 6590165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b2719548c8fa175184d6d975b10340a?s=128&d=identicon&r=PG&f=1", "display_name": "argent65", "link": "https://stackoverflow.com/users/6590165/argent65"}, "edited": false, "score": 0, "creation_date": 1557931059, "post_id": 56148797, "comment_id": 98933238, "body": "I tried changing the driver from SQL Server to SQL Server Native Client 10.0 with no luck either."}], "answers": [{"comments": [{"owner": {"reputation": 1523, "user_id": 1479132, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/orlXK.jpg?s=128&g=1", "display_name": "hiFI", "link": "https://stackoverflow.com/users/1479132/hifi"}, "edited": false, "score": 0, "creation_date": 1559630030, "post_id": 56154518, "comment_id": 99470587, "body": "This worked for me. I was struggling all day long and could not find what went wrong. After reading this post, I eventually got to know that <code>decimal</code> type were the culprit"}], "tags": [], "owner": {"reputation": 33, "user_id": 6590165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b2719548c8fa175184d6d975b10340a?s=128&d=identicon&r=PG&f=1", "display_name": "argent65", "link": "https://stackoverflow.com/users/6590165/argent65"}, "is_accepted": true, "score": 1, "last_activity_date": 1557940407, "creation_date": 1557940407, "answer_id": 56154518, "question_id": 56148797, "link": "https://stackoverflow.com/questions/56148797/vba-execution-of-sql-stored-procedure-fails-with-addecimal-datatype/56154518#56154518", "title": "VBA Execution of SQL Stored Procedure Fails with adDecimal Datatype", "body": "<p>Well, the solution was staring me in the face- I forgot to set the NumericScale and precision on param1 before appending it:</p>\n\n<pre><code>'VBA CODE CORRECTED:\nDim Comm As ADODB.Command\nDim lngRecordsAffected As Long\nDim param1 As New ADODB.Parameter\nDim param2 As New ADODB.Parameter\n'************************************************\nDim ocrxid As Long\nDim OCR_Freq As Variant\nDim x As Single\n\n'testing the formatting\nx = 7.5\nOCR_Freq = x\n\n'connection stuff\nIf con.State = adStateClosed Then\n    con.ConnectionString = conConnection\n    con.Open\nEnd If\n\nSet Comm = New ADODB.Command\nWith Comm\n    .ActiveConnection = con\n    .CommandType = adCmdStoredProc\n    .CommandText = \"up_EOCR_TEST\"\n\n    '--- ADD PARAMETERS ---------------------------------------------------\n    'OCR_Freq decimal(3,1)\n    Set param1 = Comm.CreateParameter(\"@OCR_Freq\", adDecimal, adParamInput, , \nOCR_Freq)\n    param1.NumericScale = 1\n    param1.Precision = 3\n    Comm.Parameters.Append param1\n\n    Set param2 = Comm.CreateParameter(\"@OcrxId\", adInteger, adParamInput, , \n8053)\n    Comm.Parameters.Append param2\n\n    .Execute lngRecordsAffected\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 6590165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b2719548c8fa175184d6d975b10340a?s=128&d=identicon&r=PG&f=1", "display_name": "argent65", "link": "https://stackoverflow.com/users/6590165/argent65"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 329, "favorite_count": 0, "accepted_answer_id": 56154518, "answer_count": 1, "score": 0, "last_activity_date": 1557940407, "creation_date": 1557921324, "question_id": 56148797, "link": "https://stackoverflow.com/questions/56148797/vba-execution-of-sql-stored-procedure-fails-with-addecimal-datatype", "title": "VBA Execution of SQL Stored Procedure Fails with adDecimal Datatype", "body": "<p>I would appreciate any help on this problem that has me stumped:\n  I am attempting to execute a SQL Server 2008 stored procedure from Access 365 VBA and keep faulting out with \"Multiple-step OLE DB operation generated errors\".\n  This fault began when I changed a column in the target table from int datatype to decimal(3,1). (I now need to be able to store a single digit to the right of the decimal).</p>\n\n<p>For troubleshooting/ testing, I stripped the stored procedure down to update this column only. (OCR_Freq is the update column, OcrxId is the record id).</p>\n\n<p>I have verified/tried:\n    1) The table column is set to decimal(3,1).\n    2) The data type in the stored procedure variable is decimal(3,1).\n    3) The stored procedure executes without issue from SQL Server \n       Management Studio.\n    4) Changing the column datatype to decimal(18,4) had no effect.\n    4) The vba code below executes without issue if the DataType is \n       adInteger.\n    5) I use this code to execute a number of other stored procedures \n       without issue.</p>\n\n<pre><code>'VBA CODE:\nDim Comm As ADODB.Command\nDim lngRecordsAffected As Long\nDim param1 As New ADODB.Parameter\nDim param2 As New ADODB.Parameter\n'************************************************\nDim ocrxid As Long\nDim OCR_Freq As Variant\nDim x As Single\n\n'testing the formatting\nx = 7.2 'doesn't work\n'OCR_Freq = Round(x, 1) 'doesn't work\n'OCR_Freq = CDec(x) 'doesn't work\n'OCR_Freq = Round(OCR_Freq, 1) 'doesn't work\nOCR_Freq = CDec(Format(x, \"00.0\")) 'doesn't work\n\n'connection stuff\nIf con.State = adStateClosed Then\n    con.ConnectionString = conConnection\n    con.Open\nEnd If\n\nSet Comm = New ADODB.Command\nWith Comm\n    .ActiveConnection = con\n    .CommandType = adCmdStoredProc\n    .CommandText = \"up_EOCR_TEST\"\n\n    '--- ADD PARAMETERS --------------------------------\n    'OCR_Freq decimal(3,1)\n    Set param1 = Comm.CreateParameter(\"@OCR_Freq\", adDecimal, \n        adParamInput, , OCR_Freq)\n    Comm.Parameters.Append param1\n    'test record id\n    Set param2 = Comm.CreateParameter(\"@OcrxId\", adInteger, \n        adParamInput, , 8053)\n    Comm.Parameters.Append param2\n\n    .Execute lngRecordsAffected\nEnd With\n'END VBA CODE\n\n//SQL Stored Procedure:\n@OCR_Freq decimal(3,1) = null, \n@OcrxId int = null\nas\nbegin\n  UPDATE dbo.OCRX SET OCR_Freq=@OCR_Freq  WHERE OCR_ID=@OcrxId;\nEND\n</code></pre>\n\n<p>The error I am getting is \"Multiple-step OLE DB operation generated errors\"\nThe above leads me to conclude that I am not properly \"preparing\" the value in vba for the stored procedure execution- adDecimal is not happy with my variable...\nbut I am at loss as how to move forward. Any help would be appreciated.</p>\n"}, {"tags": ["excel", "vba", "sap-gui"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 11503878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2bb800ec42dccbb3aceff6b07eed3af?s=128&d=identicon&r=PG&f=1", "display_name": "user11503878", "link": "https://stackoverflow.com/users/11503878/user11503878"}, "edited": false, "score": 0, "creation_date": 1557921820, "post_id": 56148850, "comment_id": 98927100, "body": "Oh thank so much, and when I want to make an intuitive interface for my users (I want to put a box with &quot;date?&quot; written on it)?"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 23, "user_id": 11503878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2bb800ec42dccbb3aceff6b07eed3af?s=128&d=identicon&r=PG&f=1", "display_name": "user11503878", "link": "https://stackoverflow.com/users/11503878/user11503878"}, "edited": false, "score": 0, "creation_date": 1557924897, "post_id": 56148850, "comment_id": 98929070, "body": "<code>MyYear = Format(InputBox(&quot;Insert the date&quot;, &quot;Date&quot;), &quot;yyyy&quot;)</code> like this, @user11503878"}], "tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": true, "score": 0, "last_activity_date": 1557921515, "creation_date": 1557921515, "answer_id": 56148850, "question_id": 56148709, "link": "https://stackoverflow.com/questions/56148709/how-to-vary-data-using-sap-and-vba/56148850#56148850", "title": "How to vary data using SAP and vba?", "body": "<p>Like this, you should also indent your code:</p>\n\n<pre><code>Option Explicit\nSub Test()\n\n    Dim MyYear As String\n\n    MyYear = Format(Date, \"yyyy\")\n    If Not IsObject(Application) Then\n        Set SapGuiAuto = GetObject(\"SAPGUI\")\n        Set Application = SapGuiAuto.GetScriptingEngine\n    End If\n\n    If Not IsObject(Connection) Then\n        Set Connection = Application.Children(0)\n    End If\n\n    If Not IsObject(Session) Then\n        Set Session = Connection.Children(0)\n    End If\n\n    If IsObject(WScript) Then\n        WScript.ConnectObject Session, \"on\"\n        WScript.ConnectObject Application, \"on\"\n    End If\n\n    Session.findById(\"wnd[0]/usr/tabsTABSTRIP_TABBL1/tabpUCOM1/ssub%_SUBSCREEN_TABBL1:RFBILA00:0001/txtBILBJAHR\").Text = MyYear\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 11503878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2bb800ec42dccbb3aceff6b07eed3af?s=128&d=identicon&r=PG&f=1", "display_name": "user11503878", "link": "https://stackoverflow.com/users/11503878/user11503878"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 56148850, "answer_count": 1, "score": 1, "last_activity_date": 1610185037, "creation_date": 1557921075, "last_edit_date": 1610185037, "question_id": 56148709, "link": "https://stackoverflow.com/questions/56148709/how-to-vary-data-using-sap-and-vba", "title": "How to vary data using SAP and vba?", "body": "<p>First, I was able to connect SAP GUI to vba. I managed to get a script that works and that sends me an automatic transaction. I would like to know how to make the data entered on SAP for example the date is variable because the date I have to change it every year?  </p>\n\n<pre><code>   If Not IsObject(application) Then\n   Set SapGuiAuto  = GetObject(\"SAPGUI\")\n   Set application = SapGuiAuto.GetScriptingEngine\n   End If\n   If Not IsObject(connection) Then\n   Set connection = application.Children(0)\n   End If\n   If Not IsObject(session) Then\n   Set session    = connection.Children(0)\n   End If\n    If IsObject(WScript) Then\n    WScript.ConnectObject session,     \"on\"\n     WScript.ConnectObject application, \"on\"\n    End If \n   session.findById(\"wnd[0]/usr/tabsTABSTRIP_TABBL1/\n tabpUCOM1/ssub%_SUBSCREEN_TABBL1:RFBILA00:0001/txtBILBJAHR\").text = \"2015\"\n</code></pre>\n\n<p>For example, I would like the \"2015\" date to be variable, I would like every month I can change this date to put another one without having to start the extraction on SAP GUI again.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11, "user_id": 11471277, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XoBw0Kd2dfE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfPm-lKmpXXuk_ksGsZMVuJhv4N2g/mo/photo.jpg?sz=128", "display_name": "mukesh k", "link": "https://stackoverflow.com/users/11471277/mukesh-k"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1557922089, "post_id": 56148528, "comment_id": 98927267, "body": "I forgot to add code now i edited that"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1557922254, "post_id": 56148528, "comment_id": 98927376, "body": "Have a look at the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheetfunction.vlookup\" rel=\"nofollow noreferrer\">WorksheetFunction.VLookup method</a> which you can use to lookup a value in another table to get your desired value. \u2022 If that doesn&#39;t help please provide sample data or screenshots of your 2 sheets."}, {"owner": {"reputation": 11, "user_id": 11471277, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XoBw0Kd2dfE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfPm-lKmpXXuk_ksGsZMVuJhv4N2g/mo/photo.jpg?sz=128", "display_name": "mukesh k", "link": "https://stackoverflow.com/users/11471277/mukesh-k"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1558004822, "post_id": 56148528, "comment_id": 98960833, "body": "Its throwing error could you please guide me"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1558004930, "post_id": 56148528, "comment_id": 98960894, "body": "Actually you need to <a href=\"https://stackoverflow.com/posts/56148528/edit\">edit</a> your question and show the code you have tried and tell which error message you get and in which line. We can only assist you to solve your problem if you show what you have done so far."}, {"owner": {"reputation": 11, "user_id": 11471277, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XoBw0Kd2dfE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfPm-lKmpXXuk_ksGsZMVuJhv4N2g/mo/photo.jpg?sz=128", "display_name": "mukesh k", "link": "https://stackoverflow.com/users/11471277/mukesh-k"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1558079115, "post_id": 56148528, "comment_id": 98989206, "body": "Private sub worksheet_Follow hyperlink(ByVal Target As Hyperlink)  If Target. Range. Address=&quot;$G$13&quot; Then Dim cAs Excel.range Set xlsheet=Worksheets(&quot;Sheet2&quot;) On Error Resume Next For Each c In range(&quot;A1:L1&quot;) With c If c=xlsheet. Range(&quot;A2:A14) Then . AddComment . Comment. Visible=False . Comment. Text Text:=Worksheet Function.vlookup (c.Value,xlsheet.range(&quot;A2:A14&quot;),2,false).value .comment.shape.TextFrame.Autosize=false End if End with Next End if End sub"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1558079425, "post_id": 56148528, "comment_id": 98989366, "body": "Please don&#39;t put code into comments. As you can see it is not readable at all. Intead <a href=\"https://stackoverflow.com/posts/56148528/edit\">edit</a> your original question add it there and format it nicely."}, {"owner": {"reputation": 11, "user_id": 11471277, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XoBw0Kd2dfE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfPm-lKmpXXuk_ksGsZMVuJhv4N2g/mo/photo.jpg?sz=128", "display_name": "mukesh k", "link": "https://stackoverflow.com/users/11471277/mukesh-k"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1558079938, "post_id": 56148528, "comment_id": 98989620, "body": "I am unable to edit, this is the code i am working with but its not populating the cell value its just adding the comment"}], "owner": {"reputation": 11, "user_id": 11471277, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XoBw0Kd2dfE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfPm-lKmpXXuk_ksGsZMVuJhv4N2g/mo/photo.jpg?sz=128", "display_name": "mukesh k", "link": "https://stackoverflow.com/users/11471277/mukesh-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557922137, "creation_date": 1557920482, "last_edit_date": 1557922137, "question_id": 56148528, "link": "https://stackoverflow.com/questions/56148528/excel-matching-cell-values-into-comments", "title": "Excel matching cell values into comments", "body": "<p>I want my excel automatically convert the matching cell values into comments. In a sheet1, I have set of mobile brand names in first row \"A1\" to \"L1\" and in sheet 2 the first column A has the same set of mobile brand name, but the value is repeated in the same column  and in column B the name of the customer who purchases the mobile is noted. </p>\n\n<p>If the cell values of the mobile brand name matches in both the sheets. Then it should retrieve the customer name in sheet2, column B and convert it to comments in the first row of  \"A1\" to \"L1\". Kindly anyone let me know any possible code. </p>\n\n<p>This code is helps me to add comments in the first row if sheet1 but i need the exact value in column B which has matching cell value. </p>\n\n<pre><code>Sub test()\n    Dim rngDB As Range, rngComent As Range\n    Dim rng As Range\n    Dim cm As Comment, i as integer\n    Set rngComent = Sheets(1).Range(\"a1:l1\")\n    Set rngDB = Sheets(2).Range(\"b1:b20\")\n\n    For Each rng In rngComent\n        i = i + 1\n        If Not rng.Comment Is Nothing Then\n            rng.Comment.Delete\n        End If\n        Set cm = rng.AddComment\n        With cm\n            .Visible = False\n            .Text Text:=rngDB(i).Value\n        End With\n    Next rng\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba", "countif"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1557918970, "post_id": 56148032, "comment_id": 98925427, "body": "You can&#39;t directly use <code>COUNTIF</code> or whatever Excel function as such on a 2 dimensional array, populating an array from a range creates a 2 dimensional array. So you need a workaround."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1557919242, "post_id": 56148032, "comment_id": 98925567, "body": "repeats itself within a row or a column? Or within entire array?"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1557919789, "post_id": 56148032, "comment_id": 98925848, "body": "What about using a dictionary? You could add each unique item to your dictionary, and then increases the value everytime the item repeats. After that, loop trough your dictionary, If value of item &lt;4 then <code>Insufficient</code> elseif &gt;4 then <code>Excess</code> Else <code>Complete</code>. You can even know how many is the <code>Excess</code> (2,3,4...units) and same for <code>Insufficient</code>. About Dictionaries in VBA, check <a href=\"https://excelmacromastery.com/vba-dictionary/\" rel=\"nofollow noreferrer\">Excel VBA Dictionary \u2013 A Complete Guide</a>"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 11272763, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209531433178154/picture?type=large", "display_name": "Alessio_110", "link": "https://stackoverflow.com/users/11272763/alessio-110"}, "edited": false, "score": 0, "creation_date": 1557924676, "post_id": 56148328, "comment_id": 98928919, "body": "Although it works as a charm, could you please explain me also how to use late binding in preventing to check the Microsoft Scripting Runtime all the times?"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 33, "user_id": 11272763, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209531433178154/picture?type=large", "display_name": "Alessio_110", "link": "https://stackoverflow.com/users/11272763/alessio-110"}, "edited": false, "score": 0, "creation_date": 1557924965, "post_id": 56148328, "comment_id": 98929129, "body": "@Alessio_110 <a href=\"http://www.snb-vba.eu/VBA_Dictionary_en.html\" rel=\"nofollow noreferrer\">here</a> you can find anything on dictionaries, is really helpful."}], "tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": true, "score": 1, "last_activity_date": 1557920238, "last_edit_date": 1557920238, "creation_date": 1557919816, "answer_id": 56148328, "question_id": 56148032, "link": "https://stackoverflow.com/questions/56148032/countif-within-an-array-vba/56148328#56148328", "title": "CountIF within an Array VBA", "body": "<p>This should do the trick:</p>\n\n<pre><code>Option Explicit\nSub Test()\n\n    Dim MyArray, DictDuplicates As New Scripting.Dictionary, i As Long\n\n    With ThisWorkbook.Sheets(\"Sheet1\") 'change if needed\n        MyArray = .Range(.Cells(2, 1), .Cells(2, 2).End(xlDown))\n        For i = LBound(MyArray) To UBound(MyArray) 'loop to store all the items and how many times do they repeat\n            If Not DictDuplicates.Exists(MyArray(i, 2)) Then 'if doesn't exists will store it\n                DictDuplicates.Add MyArray(i, 2), 1\n            Else 'if it does exists will increment its item value\n                DictDuplicates(MyArray(i, 2)) = DictDuplicates(MyArray(i, 2)) + 1\n            End If\n        Next i\n\n        For i = LBound(MyArray) To UBound(MyArray) 'loop to give back the result\n            Select Case DictDuplicates(MyArray(i, 2))\n                Case Is &gt; 4\n                    MyArray(i, 1) = \"Excess\"\n                Case Is = 4\n                    MyArray(i, 1) = \"Complete\"\n                Case Is &lt; 4\n                    MyArray(i, 1) = \"Insufficient\"\n            End Select\n        Next i\n        .Range(.Cells(2, 1), .Cells(2, 2).End(xlDown)) = MyArray\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Note that for the <code>DictDuplicates</code> to work, you need to check the <code>Microsoft Scripting Runtime</code> library.</p>\n"}], "owner": {"reputation": 33, "user_id": 11272763, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209531433178154/picture?type=large", "display_name": "Alessio_110", "link": "https://stackoverflow.com/users/11272763/alessio-110"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 56148328, "answer_count": 1, "score": 0, "last_activity_date": 1557920238, "creation_date": 1557918857, "question_id": 56148032, "link": "https://stackoverflow.com/questions/56148032/countif-within-an-array-vba", "title": "CountIF within an Array VBA", "body": "<p>This should be easy and I think I am almost there. I would like to count how many times an entry repeats itself within a certain array. The array will be populated from a range. Eventually if the number of the count is more than 4, I would like to insert \"Excess\", otherwise if less than 4, I would like to insert \"Insufficient\", else is \"complete\". Unfortunately, even though I have learnt to do these calculations without using Arrays, I find some difficulties when switching to Arrays.</p>\n\n<p>How the code should look like</p>\n\n<pre><code>Sub test()\n    Dim MyArray() As Variant, Countarrays() As Variant, Result() As Variant\n    Dim r As Range\n    Dim rows As Integer\n\n    Worksheets(\"Sheet1\").Activate\n    Set r = Range(\"B2\", Range(\"B1\").End(xlDown))\n    MyArray = Range(\"B2\", Range(\"B1\").End(xlDown))\n    rows = Range(\"B2\", Range(\"B1\").End(xlDown)).Count\n\n    For i = 0 To rows\n        For j = 0 To rows\n        Countarrays(i, 1) = WorksheetFunction.CountIf(r, MyArray(i))\n\n        If (Countarrays(i, 1).value) &gt; 4 Then Result(j, 1) = \"Excess\"\n        ElseIf (Countarrays(i, 1).value) &lt; 4 Then Result(j, 1) = \"Insufficient\"\n        ElseIf (Countarrays(i, 1).value) = 4 Then Result(j, 1) = \"Complete\"\n        Next j\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1557919348, "post_id": 56147975, "comment_id": 98925613, "body": "hi. to start u can replace &quot;If ws.Name = fruit Then&quot;   to &quot;If ws.Name &lt;&gt; &quot;Overview&quot; Then &quot;. this will skipp the sheet overview and get all the others"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1557921031, "post_id": 56147975, "comment_id": 98926595, "body": "Do you really need an VBA solution for this? It can be done with normal Excel formulas."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 11503358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30e30b079f966bc4c194dd59aabf9320?s=128&d=identicon&r=PG&f=1", "display_name": "Sander_H", "link": "https://stackoverflow.com/users/11503358/sander-h"}, "edited": false, "score": 0, "creation_date": 1557922321, "post_id": 56148941, "comment_id": 98927419, "body": "Thank you for your feedback. The problem with this solution is that it does not save the data in the apple/banana/pear tabs if I change the data. So if I fill in data for In, Out and Extra and select 18-1-2019, it will properly be copied to the specific sheet, but if I now want to use the same overview sheet and fill in different in/Out/Extra data and a different date, the previous copied data will not be there anymore. You understand what I mean?"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 15, "user_id": 11503358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30e30b079f966bc4c194dd59aabf9320?s=128&d=identicon&r=PG&f=1", "display_name": "Sander_H", "link": "https://stackoverflow.com/users/11503358/sander-h"}, "edited": false, "score": 0, "creation_date": 1557926699, "post_id": 56148941, "comment_id": 98930284, "body": "You are right, I misunderstood your question, and forgot totally about the storing new data part. Sorry about that."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 15, "user_id": 11503358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30e30b079f966bc4c194dd59aabf9320?s=128&d=identicon&r=PG&f=1", "display_name": "Sander_H", "link": "https://stackoverflow.com/users/11503358/sander-h"}, "edited": false, "score": 0, "creation_date": 1557928181, "post_id": 56148941, "comment_id": 98931288, "body": "Please, @Sander_H ,check updated answer with IMPORT and EXPORT solutions."}, {"owner": {"reputation": 15, "user_id": 11503358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30e30b079f966bc4c194dd59aabf9320?s=128&d=identicon&r=PG&f=1", "display_name": "Sander_H", "link": "https://stackoverflow.com/users/11503358/sander-h"}, "edited": false, "score": 0, "creation_date": 1557930148, "post_id": 56148941, "comment_id": 98932593, "body": "Wow, it works! Thank you for your help. I&#39;m now gonna try to figure out what you have done. If I have any questions, I&#39;ll let you know!"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 15, "user_id": 11503358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30e30b079f966bc4c194dd59aabf9320?s=128&d=identicon&r=PG&f=1", "display_name": "Sander_H", "link": "https://stackoverflow.com/users/11503358/sander-h"}, "edited": false, "score": 0, "creation_date": 1557930279, "post_id": 56148941, "comment_id": 98932704, "body": "Glad to help @Sander_H , If you get this to work, then please, mark it as correct so the question can be closed. Thanks."}], "tags": [], "owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "is_accepted": true, "score": 0, "last_activity_date": 1557928159, "last_edit_date": 1557928159, "creation_date": 1557921807, "answer_id": 56148941, "question_id": 56147975, "link": "https://stackoverflow.com/questions/56147975/finding-filling-in-other-excel-sheets-based-on-criteria-using-vba/56148941#56148941", "title": "Finding &amp; filling in other Excel sheets based on criteria using VBA", "body": "<p>Vba solution for this:</p>\n\n<p>For this solution to work properly, you should make the sheets APPLE, BANANA and PEAR share same structure. In my example, all this 3 sheets have in column A the date, column B is <code>IN</code>, column C is <code>OUT</code> and column D is <code>EXTRA</code></p>\n\n<p>Also, in OVERVIEW sheet, make sure the terms APPLE, BANANA and PEAR are <strong>exactly</strong> equal to names of each sheet (this means no extra spaces, blanks or different chars).</p>\n\n<p>And OVERVIEW must be the active sheet.</p>\n\n<p><a href=\"https://i.stack.imgur.com/bj8AD.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bj8AD.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>My button IMPORT is linked to this code to import data. I want to import data from 17/05/2019 (the yellow rows)</p>\n\n<pre><code>Sub IMPORT_DATA()\nApplication.ScreenUpdating = False\nRange(\"B2:D4\").Clear\n\nDim i As Long\nDim TargetRow As Long\nDim TargetSheet As String\nDim TargetDate As Date\n\nTargetDate = Range(\"B6\").Value\n\nFor i = 2 To Range(\"A\" &amp; Rows.Count).End(xlUp).Row Step 1 'i=2 because dats in OVERVIEW stars at row 2, and Column A\n    TargetSheet = Range(\"A\" &amp; i).Value\n\n    'first, we make sure the date from B6 exists in the target worksheet counting\n    With Application.WorksheetFunction\n        If .CountIf(ThisWorkbook.Worksheets(TargetSheet).Range(\"A:A\"), TargetDate) &gt; 0 Then\n            TargetRow = .Match(CDbl(TargetDate), ThisWorkbook.Worksheets(TargetSheet).Range(\"A:A\"), 0)\n            Range(\"B\" &amp; i).Value = ThisWorkbook.Worksheets(TargetSheet).Range(\"B\" &amp; TargetRow).Value 'IN value\n            Range(\"C\" &amp; i).Value = ThisWorkbook.Worksheets(TargetSheet).Range(\"C\" &amp; TargetRow).Value 'IN value\n            Range(\"D\" &amp; i).Value = ThisWorkbook.Worksheets(TargetSheet).Range(\"D\" &amp; TargetRow).Value 'IN value\n        End If\n    End With\nNext i\nApplication.ScreenUpdating = True\nEnd sub\n</code></pre>\n\n<p>And after executing this code I get in OVERVIEW:</p>\n\n<p><a href=\"https://i.stack.imgur.com/6S7sT.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6S7sT.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Now I want to export some values to data, and I use this code:</p>\n\n<pre><code>Sub EXPORT_DATA()\nApplication.ScreenUpdating = False\n\nDim i As Long\nDim TargetRow As Long\nDim TargetSheet As String\nDim TargetDate As Date\n\nTargetDate = Range(\"B6\").Value\n\nFor i = 2 To Range(\"A\" &amp; Rows.Count).End(xlUp).Row Step 1 'i=2 because dats in OVERVIEW stars at row 2, and Column A\n    TargetSheet = Range(\"A\" &amp; i).Value\n\n    'first, we make sure the date from B6 exists in the target worksheet counting\n    With Application.WorksheetFunction\n        If .CountIf(ThisWorkbook.Worksheets(TargetSheet).Range(\"A:A\"), TargetDate) &gt; 0 Then\n            TargetRow = .Match(CDbl(TargetDate), ThisWorkbook.Worksheets(TargetSheet).Range(\"A:A\"), 0)\n            ThisWorkbook.Worksheets(TargetSheet).Range(\"B\" &amp; TargetRow).Value = Range(\"B\" &amp; i).Value 'IN value\n            ThisWorkbook.Worksheets(TargetSheet).Range(\"C\" &amp; TargetRow).Value = Range(\"C\" &amp; i).Value 'OUT value\n            ThisWorkbook.Worksheets(TargetSheet).Range(\"D\" &amp; TargetRow).Value = Range(\"D\" &amp; i).Value 'EXTRA value\n        End If\n    End With\nNext i\n\nMsgBox \"data exported\"\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>And after executing code, check new data (yellow rows):\n<a href=\"https://i.stack.imgur.com/AEDq5.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AEDq5.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Hope this helps a litte bit and you can adapt to your needs.</p>\n"}], "owner": {"reputation": 15, "user_id": 11503358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30e30b079f966bc4c194dd59aabf9320?s=128&d=identicon&r=PG&f=1", "display_name": "Sander_H", "link": "https://stackoverflow.com/users/11503358/sander-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 56148941, "answer_count": 1, "score": 1, "last_activity_date": 1557928159, "creation_date": 1557918707, "question_id": 56147975, "link": "https://stackoverflow.com/questions/56147975/finding-filling-in-other-excel-sheets-based-on-criteria-using-vba", "title": "Finding &amp; filling in other Excel sheets based on criteria using VBA", "body": "<p>I have a workbook with four worksheets: Overview, apple, banana and pear.\nIn the sheet overview I have a 3x3 table:</p>\n\n<pre><code>        In      Out      Extra\napple   \nbanana  \npear    \n</code></pre>\n\n<p>Cell H5 in Overview contains a date of 2019, which can be selected via a drop-down menu</p>\n\n<p>In each of the apple/banana/pear sheets, I have a 365x3 table:</p>\n\n<pre><code>               In      Out        Extra\n1-1-2019\n2-1-2019\n3-1-2019\n.\n.\n.\n31-12-2019  \n</code></pre>\n\n<p>I would like to run a macro so that the In, Out and Extra values from the Overview sheet are filled in the correct worksheet and behind the correct date in that worksheet.</p>\n\n<p>The goal would be that people fill in the overview sheet (In, Out and Extra values as well as a date), they run the macro, and data is automatically stored in the right cell in the right worksheet.</p>\n\n<p>This is a relatively easy example, the actual workbook for which I need this macro has more that 70 \"fruits\".</p>\n\n<p>I know the code below doesn't work, but I'll hope to show my way of thinking</p>\n\n<pre><code>Sub export()\n\nDim ws As Worksheet             'worksheet\n    Dim currentdate As Date         'datum\n    Dim fruit As String             'Fruit\n\n    Worksheets(\"Overview\").Activate                 'activate worksheet Overview\n    currentdate = ActiveSheet.Cells(H5)             'select date value\nfruit = Overview.Range(\u201cC6, C8\u201d)                'select range of the fruits\n\n\n    For Each ws In Worksheets                           'loop over every worksheet except the Overview sheet\n        If ws.Name = fruit Then                         'crossreference name worksheet with fruit in Overview sheet\n            ws.Activate                                 'activating the selected worksheet\n            If ws.Range(\"A1:A365\") = currentdate Then   'looking for the correct date in the selcted worksheet\n                fruit = ws.Name\n    Next ws\n\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "runtime-error", "excel-tables"], "comments": [{"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1557918939, "post_id": 56147797, "comment_id": 98925415, "body": "<code>exists</code> is not a VBA command.  What are you trying to test?"}, {"owner": {"reputation": 275, "user_id": 10506372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4352215e71f341fca321250004b14f?s=128&d=identicon&r=PG&f=1", "display_name": "BlackBear", "link": "https://stackoverflow.com/users/10506372/blackbear"}, "reply_to_user": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1557919110, "post_id": 56147797, "comment_id": 98925496, "body": "@DarrellH I copied that code from another forum posts. I want to test whether the value in <code>rng</code> is already in my combobox and if it is not it should be added. This is to avoid duplicates that exists in my table."}], "answers": [{"comments": [{"owner": {"reputation": 275, "user_id": 10506372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4352215e71f341fca321250004b14f?s=128&d=identicon&r=PG&f=1", "display_name": "BlackBear", "link": "https://stackoverflow.com/users/10506372/blackbear"}, "edited": false, "score": 0, "creation_date": 1557990527, "post_id": 56151114, "comment_id": 98952852, "body": "This code stops running when it hits the duplicate. It should continue down the list and ignore the duplicates. I solved it by placing the line <code>Exists = False</code> below the start of the <code>For Each</code> loop. Also added a <code>.Clear</code> to allow for changes in the original table source."}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "reply_to_user": {"reputation": 275, "user_id": 10506372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4352215e71f341fca321250004b14f?s=128&d=identicon&r=PG&f=1", "display_name": "BlackBear", "link": "https://stackoverflow.com/users/10506372/blackbear"}, "edited": false, "score": 0, "creation_date": 1558005824, "post_id": 56151114, "comment_id": 98961377, "body": "It was supposed to stop running.  When it finds the duplicate, no more action required.  Only if there is no duplicate, then add the item."}, {"owner": {"reputation": 275, "user_id": 10506372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4352215e71f341fca321250004b14f?s=128&d=identicon&r=PG&f=1", "display_name": "BlackBear", "link": "https://stackoverflow.com/users/10506372/blackbear"}, "edited": false, "score": 0, "creation_date": 1558111419, "post_id": 56151114, "comment_id": 99005841, "body": "The list is supposed to be populated with the unique value in the table, not until it hits the first duplicate. Either way I fixed my own version."}], "tags": [], "owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1557928551, "creation_date": 1557928551, "answer_id": 56151114, "question_id": 56147797, "link": "https://stackoverflow.com/questions/56147797/populating-activex-comboboxes-with-distinct-values/56151114#56151114", "title": "Populating ActiveX comboboxes with distinct values", "body": "<p>It is possible that someone created a function.  Try replacing this block:</p>\n\n<pre><code>' Populating combobox\nDim Exists As Boolean\nDim t As Long\n\nExists = False\n\nWith Funds_List\n    For Each Rng In tbl.ListColumns(\"Name\").DataBodyRange\n        For t = 1 To .ListCount - 1\n            If Rng.Value = CStr(.List(t)) Then\n                Exists = True\n                Exit For\n            End If\n        Next t\n        If Exists = False Then\n            .AddItem Rng.Value\n        End If\n    Next Rng\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 275, "user_id": 10506372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4352215e71f341fca321250004b14f?s=128&d=identicon&r=PG&f=1", "display_name": "BlackBear", "link": "https://stackoverflow.com/users/10506372/blackbear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 56151114, "answer_count": 1, "score": 0, "last_activity_date": 1557928551, "creation_date": 1557918157, "last_edit_date": 1557918580, "question_id": 56147797, "link": "https://stackoverflow.com/questions/56147797/populating-activex-comboboxes-with-distinct-values", "title": "Populating ActiveX comboboxes with distinct values", "body": "<p>My issue is that I want to populate an <strong>ActiveX control combobox</strong> with a specific name, <code>List_Funds</code> as I renamed it. The population is based on a specific column in a table I have generated in my workbook called <code>Table_Funds</code>. I want the combobox to only populate the unique values of the table. The code should run when I open the workbook.</p>\n\n<p>Code below with my current attempt:</p>\n\n<p>Below the code is in a designated module containing all my declarations</p>\n\n<pre><code>Option Explicit\nOption Base 0\n\n' This module contains all constants and variable declarations\n' **** Declarations ****\n\n' Worksheets and workbooks\nPublic ws             As Worksheet\nPublic ws_O           As Worksheet\nPublic ws_S           As Worksheet\nPublic wkb            As Workbook\n\n' Integers\nPublic i              As Integer\nPublic j              As Integer\n\n' Variants, objects and ranges\nPublic Data           As Variant\nPublic Funds_List     As Object\nPublic rng            As Range\nPublic tbl            As ListObject\n\nSub Fixed()\n\n    Set wkb = ThisWorkbook\n    Set ws_O = wkb.Sheets(\"Overview\")\n    Set ws_S = wkb.Sheets(\"SQL\")\n    Set Funds_List = ws_O.OLEObjects(\"List_Funds\").Object\n    Set tbl = ws_O.ListObjects(\"Table_Funds\")\n\nEnd Sub\n\n</code></pre>\n\n<p>Below the code is in ThisWorkbook module</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Workbook_Open()\n' Computing when opening workbook\n\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n    Call modCnt.Fixed\n\n    ' Populating table\n    Data = modGlobal.GetSql(modGlobal.Compose_sSql(1))\n    tbl.DataBodyRange.ClearContents\n    For i = LBound(Data, 2) To UBound(Data, 2)\n        For j = LBound(Data, 1) To UBound(Data, 1)\n            tbl.DataBodyRange(1 + i, 1 + j) = Data(j, i)\n        Next j\n    Next i\n\n    ' Populating combobox\n    With Funds_List\n        For Each rng In tbl.ListColumns(\"Name\").DataBodyRange\n            If Not .exists(rng.Value) Then ' &lt; ---- code fails here\n                .AddItem rng.Value\n            End If\n        Next rng\n    End With\n\n\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>My code fails at the line <code>If Not .exists(rng.Value) Then</code>\ngiving me </p>\n\n<blockquote>\n  <p>run-time error 438 'Object does not support this property or method.'</p>\n</blockquote>\n\n<p>The table is populating as it should (i.e. you can <em>disregard the section populating the table</em> as it calls on a sub in a different module) and watching the code I know that the <code>rng</code> takes on the correct value (first value in the databodyrange of my table).</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1557918767, "post_id": 56147707, "comment_id": 98925317, "body": "<code>Range(&quot;A1&quot;) = Macro1(&quot;YourString&quot;)</code>"}, {"owner": {"reputation": 1, "user_id": 10606130, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-US9yYJUhTbI/AAAAAAAAAAI/AAAAAAAAAH0/SPMsd6R12V4/photo.jpg?sz=128", "display_name": "Nawid ", "link": "https://stackoverflow.com/users/10606130/nawid"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1557974046, "post_id": 56147707, "comment_id": 98948182, "body": "can you explain it in more details."}], "owner": {"reputation": 1, "user_id": 10606130, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-US9yYJUhTbI/AAAAAAAAAAI/AAAAAAAAAH0/SPMsd6R12V4/photo.jpg?sz=128", "display_name": "Nawid ", "link": "https://stackoverflow.com/users/10606130/nawid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594779362, "creation_date": 1557917883, "last_edit_date": 1594779362, "question_id": 56147707, "link": "https://stackoverflow.com/questions/56147707/how-to-call-excel-function-and-send-parameters", "title": "How to call excel function and send parameters", "body": "<p>I want to call the access function and send parameters from excel\nthere is my access function </p>\n\n<pre><code>{\nFunction Macro1(source As String)\n\n    DoCmd.TransferSpreadsheet acImport, 10, \"Table1\", source, True, \"\"\n\nEnd Function\n}\n</code></pre>\n\n<p>How to call this function?</p>\n"}, {"tags": ["excel", "vba", "add-in", "locked"], "comments": [{"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1557917072, "post_id": 56147189, "comment_id": 98924340, "body": "<code>Public Sub MySub()</code>?"}, {"owner": {"reputation": 1, "user_id": 11503453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/502846384eea6bb9533a9056991389fb?s=128&d=identicon&r=PG&f=1", "display_name": "Szpadelsky", "link": "https://stackoverflow.com/users/11503453/szpadelsky"}, "reply_to_user": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 1, "creation_date": 1557917608, "post_id": 56147189, "comment_id": 98924663, "body": "Thanks, but subs are public"}], "owner": {"reputation": 1, "user_id": 11503453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/502846384eea6bb9533a9056991389fb?s=128&d=identicon&r=PG&f=1", "display_name": "Szpadelsky", "link": "https://stackoverflow.com/users/11503453/szpadelsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 211, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557916217, "creation_date": 1557916217, "question_id": 56147189, "link": "https://stackoverflow.com/questions/56147189/macros-not-showing-up-on-list-in-excel-ribbon", "title": "Macros not showing up on list in excel ribbon", "body": "<p>i made add-in for excel, i locked it with password. Now when i try to add button to ribbon, macros are not shown on macros list. When i enter password in vba editor to unlock the project macros are availible on macros list. Does someone know how to let users install add-in and add button to ribbon with asigned macro then project is locked? </p>\n\n<p>Subs are parameterless</p>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10417531"}, "edited": false, "score": 0, "creation_date": 1557916661, "post_id": 56147147, "comment_id": 98924108, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/7759962/change-font-color-for-specific-char-in-a-cell-range\">Change font color for specific char in a cell range</a>"}, {"owner": {"reputation": 11, "user_id": 11221121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26d90921c101d72e7fe3cce7a6558333?s=128&d=identicon&r=PG&f=1", "display_name": "jimmyluder123", "link": "https://stackoverflow.com/users/11221121/jimmyluder123"}, "edited": false, "score": 0, "creation_date": 1557916741, "post_id": 56147147, "comment_id": 98924159, "body": "in Excel with vba its possible, but apparently with the same Code in Access vba its not possible"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1557920544, "post_id": 56147147, "comment_id": 98926307, "body": "no it&#39;s possible - but what happens here I suspect, is that the export is messing it up. Run the format after the export rather than before."}, {"owner": {"reputation": 11, "user_id": 11221121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26d90921c101d72e7fe3cce7a6558333?s=128&d=identicon&r=PG&f=1", "display_name": "jimmyluder123", "link": "https://stackoverflow.com/users/11221121/jimmyluder123"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1557921084, "post_id": 56147147, "comment_id": 98926620, "body": "@HarassedDad thank you man you are my hero :D its worked after Export, if i open the workbook and Formate it then"}], "owner": {"reputation": 11, "user_id": 11221121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26d90921c101d72e7fe3cce7a6558333?s=128&d=identicon&r=PG&f=1", "display_name": "jimmyluder123", "link": "https://stackoverflow.com/users/11221121/jimmyluder123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 489, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594779373, "creation_date": 1557916113, "last_edit_date": 1594779373, "question_id": 56147147, "link": "https://stackoverflow.com/questions/56147147/change-excel-cell-text-color-using-vba-in-access", "title": "Change Excel cell text color using VBA in Access", "body": "<p>I have a problem with changing the color of text in a cell in an Excel worksheet using Access VBA. (I'm formatting my Excel within Access VBA then I export the Excel file)</p>\n\n<p>I want to change only the color for the first 5 Characters in a cell. I've tried using the following code:</p>\n\n<pre><code>ws.Cells(18, 6).Characters(1, 5).Font.Color = vbRed\n</code></pre>\n\n<p>But in the result (after Export) all of the characters in that cell will be changed (length of the cell is 68).</p>\n\n<p>I dont understand where the problem is in the code. Maybe I need to use a different function to <code>.Characters</code> for changing the color?</p>\n\n<p>Could someone please help me?</p>\n\n<p>Thank you very much </p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1557947824, "post_id": 56146807, "comment_id": 98941585, "body": "You can only change control size and position in design mode. It can be done programmatically, but it still requires exclusive access to the database, which means each user will have to have their own exclusive front end."}, {"owner": {"reputation": 3662, "user_id": 1281901, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d3785ec1489202606b4526c29a4e148b?s=128&d=identicon&r=PG", "display_name": "bendataclear", "link": "https://stackoverflow.com/users/1281901/bendataclear"}, "reply_to_user": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1557947918, "post_id": 56146807, "comment_id": 98941637, "body": "@Sunknight0 I don&#39;t think you read the question"}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1557948643, "post_id": 56146807, "comment_id": 98941939, "body": "Listbox boxes are sub-controls. I have never tried to dynamically adjust them, but I would expect the same rules as adjusting other control width apply. Either that o the code you are using to adjust the width (which you have not provided) is not the correct code to do so."}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1557948812, "post_id": 56146807, "comment_id": 98942003, "body": "Btw, if the question is &quot;why is my form width value not updating&quot;, the answer is, &quot;I don&#39;t know, it works for me when I need to get the form width to adjust sub-form sizes&quot;."}, {"owner": {"reputation": 3662, "user_id": 1281901, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d3785ec1489202606b4526c29a4e148b?s=128&d=identicon&r=PG", "display_name": "bendataclear", "link": "https://stackoverflow.com/users/1281901/bendataclear"}, "reply_to_user": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1557948974, "post_id": 56146807, "comment_id": 98942070, "body": "@Sunknight0 I&#39;m not trying to change the widths, I&#39;m setting the <code>columnWidths</code> property, this works without issue during run time. The problem is when the form changes size, this adjusts the listbox width as it&#39;s anchored to both sides. If you then check the <code>Listbox.Width</code> property it still reports the original size."}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1557949405, "post_id": 56146807, "comment_id": 98942245, "body": "Have you tried not using anchoring, but manually changing the size of the control? I don&#39;t use anchoring so I don&#39;t know how it works &quot;behind the scenes&quot;. It is possible that it uses temporary values for things like <code>width</code> while the object/control maintains the original values. I generally just get the form dimensions and then manually adjust any controls that need adjusting, although admittedly I have never had to adjust listbox or combo box column widths."}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1557949546, "post_id": 56146807, "comment_id": 98942297, "body": "Follow up question: If you adjust the column with using fixed numbers (even if the width is not what you want, just as a test) does it work? It is the fact that the control&#39;s <code>width</code> property is not updating the only issue?"}, {"owner": {"reputation": 3662, "user_id": 1281901, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d3785ec1489202606b4526c29a4e148b?s=128&d=identicon&r=PG", "display_name": "bendataclear", "link": "https://stackoverflow.com/users/1281901/bendataclear"}, "reply_to_user": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1558015468, "post_id": 56146807, "comment_id": 98967391, "body": "@SunKnight0 Turning off anchoring doesn&#39;t help, the form size still doesn&#39;t update. Updating the control size by setting the width works fine."}], "answers": [{"tags": [], "owner": {"reputation": 3662, "user_id": 1281901, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d3785ec1489202606b4526c29a4e148b?s=128&d=identicon&r=PG", "display_name": "bendataclear", "link": "https://stackoverflow.com/users/1281901/bendataclear"}, "is_accepted": false, "score": 1, "last_activity_date": 1557919139, "creation_date": 1557919139, "answer_id": 56148113, "question_id": 56146807, "link": "https://stackoverflow.com/questions/56146807/access-form-or-control-width-doesnt-update/56148113#56148113", "title": "Access - Form or control width doesn&#39;t update", "body": "<p>I found a messy work around (but I'm still open to suggestions for a better one).</p>\n\n<p>The only property that seems to change on resize is the <code>Form.InsideWidth</code>.</p>\n\n<p>At form load I save the difference between the Listboxes width and the inside width:</p>\n\n<pre><code>Private Sub Form_Load()\n    p_ListToWindowDiff = Me.InsideWidth - Listbox1.Width\nEnd Sub\n</code></pre>\n\n<p>Then when resized I use this to get the new listbox width:</p>\n\n<pre><code>NewListWidth = Me.InsideWidth - p_ListToWindowDiff\n</code></pre>\n"}], "owner": {"reputation": 3662, "user_id": 1281901, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d3785ec1489202606b4526c29a4e148b?s=128&d=identicon&r=PG", "display_name": "bendataclear", "link": "https://stackoverflow.com/users/1281901/bendataclear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 430, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594779387, "creation_date": 1557915064, "last_edit_date": 1594779387, "question_id": 56146807, "link": "https://stackoverflow.com/questions/56146807/access-form-or-control-width-doesnt-update", "title": "Access - Form or control width doesn&#39;t update", "body": "<p>I am trying to set listbox column widths based on the current size of the listbox, I've set it to use the <code>Listbox.Width</code> property but this never seems to update, it stays at the value set in design mode.</p>\n\n<p>Even created a new form with a resize event as below:</p>\n\n<pre><code>Private Sub Form_Resize()\n    Text0 = CStr(Me.Width) &amp; \" - \" &amp; CStr(Rnd())\nEnd Sub \n</code></pre>\n\n<p>And the width stays static as I resize it (the event is certainly firing as the random value changes).</p>\n\n<p>Is this a know problem with Access and if so are there any work-arounds?</p>\n\n<p>How can I get the current width of the control or form?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1557914883, "post_id": 56146653, "comment_id": 98923010, "body": "Don&#39;t copy <code>entirerow</code>."}, {"owner": {"reputation": 113, "user_id": 10904582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2944732016e320662ac914dab5f66b5d?s=128&d=identicon&r=PG&f=1", "display_name": "j.doe", "link": "https://stackoverflow.com/users/10904582/j-doe"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1557915316, "post_id": 56146653, "comment_id": 98923276, "body": "@SJR its working fine when i set the worksheet to a new worksheet."}, {"owner": {"reputation": 113, "user_id": 10904582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2944732016e320662ac914dab5f66b5d?s=128&d=identicon&r=PG&f=1", "display_name": "j.doe", "link": "https://stackoverflow.com/users/10904582/j-doe"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1557915358, "post_id": 56146653, "comment_id": 98923297, "body": "@SJR i want to copy thing to happen in the same sheet but in different column"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1557915452, "post_id": 56146653, "comment_id": 98923339, "body": "Did you understand my comment? <code>Set cpy = fnd.EntireRow</code> Why entirerow? You can&#39;t move an entire row 2 columns to the right. It won&#39;t fit."}, {"owner": {"reputation": 113, "user_id": 10904582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2944732016e320662ac914dab5f66b5d?s=128&d=identicon&r=PG&f=1", "display_name": "j.doe", "link": "https://stackoverflow.com/users/10904582/j-doe"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1557915618, "post_id": 56146653, "comment_id": 98923445, "body": "@SJR okay i understand now..thanks for being patient with me. what changes do you suggest?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1557915725, "post_id": 56146653, "comment_id": 98923513, "body": "Well if you just want to copy the found cell just use <code>fnd</code> in place of <code>fnd.EntireRow</code> throughout."}, {"owner": {"reputation": 113, "user_id": 10904582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2944732016e320662ac914dab5f66b5d?s=128&d=identicon&r=PG&f=1", "display_name": "j.doe", "link": "https://stackoverflow.com/users/10904582/j-doe"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1557915788, "post_id": 56146653, "comment_id": 98923558, "body": "@SJR let me try and get back to you :)"}, {"owner": {"reputation": 113, "user_id": 10904582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2944732016e320662ac914dab5f66b5d?s=128&d=identicon&r=PG&f=1", "display_name": "j.doe", "link": "https://stackoverflow.com/users/10904582/j-doe"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1557915993, "post_id": 56146653, "comment_id": 98923688, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/193386/discussion-between-j-doe-and-sjr\">continue this discussion in chat</a>."}], "owner": {"reputation": 113, "user_id": 10904582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2944732016e320662ac914dab5f66b5d?s=128&d=identicon&r=PG&f=1", "display_name": "j.doe", "link": "https://stackoverflow.com/users/10904582/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1557916792, "creation_date": 1557914559, "last_edit_date": 1557916792, "question_id": 56146653, "link": "https://stackoverflow.com/questions/56146653/vba-code-for-matching-the-string-and-copying-it", "title": "VBA code for matching the string and copying it", "body": "<p>I have code that matches the string and copies it to the next sheet. But when i make changes so that it pastes the value in the same sheet but different column it doesn't work. I am trying to match the array in the red part and copying it into the C column</p>\n\n<p><a href=\"https://i.stack.imgur.com/XxJF0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XxJF0.png\" alt=\"Sample of The xlsx\"></a></p>\n\n<pre><code>Option Explicit\nSub SearchForString()\n Dim a As Long, arr As Variant, fnd As Range, cpy As Range, addr As \n String\n On Error GoTo Err_Execute\n  'populate the array for the outer loop\n  arr = Array(\"trigger\")\n  With Worksheets(\"test\")\n   'outer loop through the array\n   For a = LBound(arr) To UBound(arr)\n       'locate first instance\n       Set fnd = .Columns(\"A\").Find(what:=arr(a), LookIn:=xlFormulas, LookAt:=xlPart, _\n                                    SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n                                    MatchCase:=False, SearchFormat:=False)\n       If Not fnd Is Nothing Then\n          'record address of first find\n           addr = fnd.Address\n           'seed the cpy range object\n           If cpy Is Nothing Then Set cpy = fnd.EntireRow\n           Do\n               'build union\n               Set cpy = Union(cpy, fnd.EntireRow)\n               'look for another\n               Set fnd = .Columns(\"A\").FindNext(after:=fnd)\n           'keep finding new matches until it loops back to the first\n           Loop Until fnd.Address = addr\n       End If\n   Next a\n  End With\n    With Worksheets(\"test\")\n    'one stop copy &amp; paste operation\n   cpy.Copy Destination:=.Cells(.Rows.Count, \"c\").End(xlUp).Offset(1, 0)\n End With\n\n  MsgBox \"All matching data has been copied.\"\n\n  Exit Sub\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1557914725, "post_id": 56146664, "comment_id": 98922906, "body": "Yeah... I copied his code, then I realized it was all wrong, already sorted."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1557914806, "post_id": 56146664, "comment_id": 98922961, "body": "LastRow and LastCol should be Cells, not Range. Find is the way to go, but worth checking first the term is found before using the column property to avoid errors, and usually worth specifying more arguments."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1557915083, "post_id": 56146664, "comment_id": 98923132, "body": "@Damian note that <code>.Cells.Find(&quot;Course Info&quot;)</code> searches in the whole sheet and not only in the header row. You could reduce search time a lot and make it more stable if you reduce it to <code>Rows(1).Find(&quot;Course Info&quot;)</code> \u2022 Also you need to define the <code>LookAt</code> parameter otherwise this is randomly <code>xlWhole</code> or <code>xlPart</code> (Excel uses whatever was used before by VBA or user interface. It has no default!)."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1557915304, "post_id": 56146664, "comment_id": 98923264, "body": "@P\u1d07\u029c - I suppose the header might not be on row 1."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1557915542, "post_id": 56146664, "comment_id": 98923398, "body": "@SJR why? The OP used <code>&quot;AB2:AB&quot; &amp; LastRow</code> to <code>Clean</code> data that means the header can only be in row 1 since data starts at 2."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1557915655, "post_id": 56146664, "comment_id": 98923471, "body": "@P\u1d07\u029c - I don&#39;t know, but surely it must be a possibility, which Find would cover."}, {"owner": {"reputation": 3, "user_id": 11503275, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-65eY1XKLsWU/AAAAAAAAAAI/AAAAAAAAAG0/A6BDjJQ3Szg/photo.jpg?sz=128", "display_name": "William Pieters-Verbiest", "link": "https://stackoverflow.com/users/11503275/william-pieters-verbiest"}, "edited": false, "score": 0, "creation_date": 1558001527, "post_id": 56146664, "comment_id": 98959035, "body": "on the code: <code>LastRow = .Range(.Rows.Count, 2).End(xlUp).row</code> I get error Run-time error &#39;1004&#39;: Method &#39;Range&#39; of object &#39;_Worksheet&#39; failed"}, {"owner": {"reputation": 3, "user_id": 11503275, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-65eY1XKLsWU/AAAAAAAAAAI/AAAAAAAAAG0/A6BDjJQ3Szg/photo.jpg?sz=128", "display_name": "William Pieters-Verbiest", "link": "https://stackoverflow.com/users/11503275/william-pieters-verbiest"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1558001934, "post_id": 56146664, "comment_id": 98959228, "body": "to add to the comment, I defined ShData this way: <code>Dim ShData As Worksheet &#39;define Wb1 + Sh&#39;s     Set Wb1 = ActiveWorkbook     Set ShData = ThisWorkbook.Worksheets(&quot;Data&quot;)</code>  Previously I used <code>Set ShData = WB1.Sheets(&quot;Data&quot;)</code>, but as I got the error too then I thought I&#39;d change it to the code of @P\u1d07\u029c"}, {"owner": {"reputation": 3, "user_id": 11503275, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-65eY1XKLsWU/AAAAAAAAAAI/AAAAAAAAAG0/A6BDjJQ3Szg/photo.jpg?sz=128", "display_name": "William Pieters-Verbiest", "link": "https://stackoverflow.com/users/11503275/william-pieters-verbiest"}, "edited": false, "score": 0, "creation_date": 1558007674, "post_id": 56146664, "comment_id": 98962433, "body": "Never mind previous comments, found out it was due to a typo in the title that I made in part Col = ...&quot;Course Info&quot;).column, thanks all for the great help!"}], "tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": false, "score": 0, "last_activity_date": 1557915187, "last_edit_date": 1557915187, "creation_date": 1557914609, "answer_id": 56146664, "question_id": 56146524, "link": "https://stackoverflow.com/questions/56146524/find-specific-column-and-clean-all-rows-under-it/56146664#56146664", "title": "find specific column and clean all rows under it", "body": "<p>Here:</p>\n\n<pre><code>Option Explicit\nSub Test()\n\n    Dim Rng As Range, Col As Long, cell As Range, LastRow As Long, LastCol As Long\n\n    With ShData\n        LastRow = .Range(.Rows.Count, 2).End(xlUp).Row\n        LastCol = .Range(1, .Columns.Count).End(xlToLeft).Column\n        Col = .Rows(1).Find(\"Course Info\").Column 'this is to find the column number\n        Set Rng = .Range(.Cells(2, Col), .Cells(LastRow, Col))\n    End With\n\n    For Each cell In Rng\n        cell = Application.WorksheetFunction.Clean(cell)\n    Next cell\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1557915574, "post_id": 56146745, "comment_id": 98923416, "body": "On your approach you could declare <code>Col As Variant</code> and get rid of the <code>On Error</code> so you can use <code>Application.Match</code> and finally <code>If Not IsError(Col)</code> right?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1557915672, "post_id": 56146745, "comment_id": 98923483, "body": "@Damian yes, you could. Whatever you prefer to use. The idea and result should be the same."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1557915245, "last_edit_date": 1557915245, "creation_date": 1557914866, "answer_id": 56146745, "question_id": 56146524, "link": "https://stackoverflow.com/questions/56146524/find-specific-column-and-clean-all-rows-under-it/56146745#56146745", "title": "find specific column and clean all rows under it", "body": "<p>Use the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Excel.WorksheetFunction.Match\" rel=\"nofollow noreferrer\">WorksheetFunction.Match method</a> to get the column number.</p>\n\n<pre><code>Option Explicit\n\nSub test()\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\n    Dim Col As Double\n    On Error Resume Next 'next line throws error if \"Course Info\" was not found\n    Col = Application.WorksheetFunction.Match(\"Course Info\", ws.Rows(1), 0)\n    On Error GoTo 0 'always re-activate error reporting\n\n    If Col &lt;&gt; 0 Then 'only do it if \"Course Info\" was found\n        Dim Cell As Range\n        For Each Cell In ws.Range(ws.Cells(2, Col), ws.Cells(ws.Rows.Count, Col).End(xlUp))\n            Cell.Value = Application.WorksheetFunction.Clean(Cell.Value)\n        Next Cell\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11503275, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-65eY1XKLsWU/AAAAAAAAAAI/AAAAAAAAAG0/A6BDjJQ3Szg/photo.jpg?sz=128", "display_name": "William Pieters-Verbiest", "link": "https://stackoverflow.com/users/11503275/william-pieters-verbiest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 1, "accepted_answer_id": 56146745, "answer_count": 2, "score": 0, "last_activity_date": 1557915245, "creation_date": 1557914147, "question_id": 56146524, "link": "https://stackoverflow.com/questions/56146524/find-specific-column-and-clean-all-rows-under-it", "title": "find specific column and clean all rows under it", "body": "<p>I have an excel sheet with a random amount of columns and rows (amount of columns/rows changes every time, as well as the location of each column) where I need to find a certain column with title \"Course Info\", and then use the CLEAN function on all rows / cells in that column (except for the title row ofcourse).</p>\n\n<p>I have the code for the clean function:</p>\n\n<pre><code>Set Rng = ShData.Range(\"AB2:AB\" &amp; LastRow)\n\nFor Each cell In Rng\n    cell.Value = Application.WorksheetFunction.Clean(cell.Value)\nNext cell\n</code></pre>\n\n<p>Problem here is that Rng is set to column AB, which isn't always that column. I have also made a LastRow &amp; LastCol code to count the amount of rows and columns, but beyond this I'm stuck.</p>\n\n<pre><code>LastRow = ShData.Range(2, Rows.Count).End(xlUp).Row\nLastCol = ShData.Range(1, Cols.Count).End(xlToLeft).Column\n</code></pre>\n"}, {"tags": ["vba", "numbers", "userform"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10698414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a578e9a665d013d4eb186188692f4a13?s=128&d=identicon&r=PG&f=1", "display_name": "Mr_Col", "link": "https://stackoverflow.com/users/10698414/mr-col"}, "edited": false, "score": 0, "creation_date": 1557926828, "post_id": 56147154, "comment_id": 98930376, "body": "Hi @TimStack - thanks for the comments above - however, when I update the code it says &#39;compile error - Method or data member not found&#39; and highlights the .WorksheetFunction"}, {"owner": {"reputation": 15, "user_id": 10698414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a578e9a665d013d4eb186188692f4a13?s=128&d=identicon&r=PG&f=1", "display_name": "Mr_Col", "link": "https://stackoverflow.com/users/10698414/mr-col"}, "edited": false, "score": 0, "creation_date": 1557927094, "post_id": 56147154, "comment_id": 98930571, "body": "I removed the application.Worksheetfunction with the my previous code of <code>Format(i, &quot;0.0&quot;)</code> - now it works perfectly - thanks for you help!"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 15, "user_id": 10698414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a578e9a665d013d4eb186188692f4a13?s=128&d=identicon&r=PG&f=1", "display_name": "Mr_Col", "link": "https://stackoverflow.com/users/10698414/mr-col"}, "edited": false, "score": 0, "creation_date": 1557927262, "post_id": 56147154, "comment_id": 98930664, "body": "Glad to see you got it working. Not sure why <code>Application.WorksheetFunction</code> won&#39;t work for you, as it&#39;s unaffected by local language settings."}, {"owner": {"reputation": 15, "user_id": 10698414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a578e9a665d013d4eb186188692f4a13?s=128&d=identicon&r=PG&f=1", "display_name": "Mr_Col", "link": "https://stackoverflow.com/users/10698414/mr-col"}, "edited": false, "score": 0, "creation_date": 1557937110, "post_id": 56147154, "comment_id": 98936806, "body": "Me neither, but the work around is fine in any case - thanks for  you help!!"}], "tags": [], "owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "is_accepted": true, "score": 2, "last_activity_date": 1557927224, "last_edit_date": 1557927224, "creation_date": 1557916124, "answer_id": 56147154, "question_id": 56146313, "link": "https://stackoverflow.com/questions/56146313/increase-combobox-with-increments-of-0-1-in-vba/56147154#56147154", "title": "Increase ComboBox with increments of 0.1 in vba", "body": "<p>Decimals are non-integer by definition. Declare <code>i</code> as double instead, and use <code>Step 0.1</code> to increment by a tenth:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\nDim sSaved As String\nDim i As Double\nDim docType As String\n\nFor i = 0 To 20.1 Step 0.1\n    cboRev.AddItem Application.WorksheetFunction.Round(i, 1)\n    'cboRev.AddItem Format(i, \"0.0\") 'alternative\nNext i\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10698414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a578e9a665d013d4eb186188692f4a13?s=128&d=identicon&r=PG&f=1", "display_name": "Mr_Col", "link": "https://stackoverflow.com/users/10698414/mr-col"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 56147154, "answer_count": 1, "score": 0, "last_activity_date": 1557930206, "creation_date": 1557913572, "last_edit_date": 1557930206, "question_id": 56146313, "link": "https://stackoverflow.com/questions/56146313/increase-combobox-with-increments-of-0-1-in-vba", "title": "Increase ComboBox with increments of 0.1 in vba", "body": "<p>I have a Combobox in a Userform in word. I am trying to make it populate the revision number of the document. At the moment I can only get it to increase in full numbers 01, 02, 03, etc.</p>\n\n<p>What I actually want it to do is increase in 0.1 increments, so - 1.0, 1.1, 1.2, 1.3, etc.</p>\n\n<p>I've tried changing the formatting from \"00\" to \"0.0\" or \"0.1\" but that just continues the format and doesn't add 0.1 to each subsequent level.</p>\n\n<pre><code>Private Sub UserForm_Initialize()\nDim sSaved As String\nDim i As Integer\nDim docType As String\n\nOn Error Resume Next\n    For i = 0 To 20\n        cboRev.AddItem Format(i, \"00\")\n    Next i\n</code></pre>\n"}, {"tags": ["excel", "vba", "powerpoint"], "comments": [{"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1557930251, "post_id": 56146311, "comment_id": 98932679, "body": "Have a look at this entry on the PPT FAQ site that I maintain:  <a href=\"http://www.pptfaq.com/FAQ00892_Using_Excel_and_Access_data_in_PowerPoint_Tables_-by_Brian_Reilly_and_Naresh_Nichani-.htm\" rel=\"nofollow noreferrer\">pptfaq.com/&hellip;</a>"}, {"owner": {"reputation": 502, "user_id": 7277322, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0VwwD.png?s=128&g=1", "display_name": "Jens.Huehn_at_SlideFab.com", "link": "https://stackoverflow.com/users/7277322/jens-huehn-at-slidefab-com"}, "edited": false, "score": 0, "creation_date": 1557947056, "post_id": 56146311, "comment_id": 98941240, "body": "In case that solving the problem somehow is more important implementing code yourself, you can have a look here: <a href=\"https://www.youtube.com/watch?v=LOT3mTA6DF8&amp;t=4s\" rel=\"nofollow noreferrer\">youtube.com/watch?v=LOT3mTA6DF8&amp;t=4s</a>  This shows how you can do this with SlideFab 2. The free lite version should be sufficient for this. In case of questions, feel free to reach out. Disclaimer: I am the owner of SlideFab 2."}, {"owner": {"reputation": 21, "user_id": 10755778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75304d1f7e6a42fc92e3a99058469e1c?s=128&d=identicon&r=PG&f=1", "display_name": "king11100234", "link": "https://stackoverflow.com/users/10755778/king11100234"}, "edited": false, "score": 0, "creation_date": 1558020348, "post_id": 56146311, "comment_id": 98970444, "body": "Ah if possible I&#39;d really like some advice on how to amend the code above, I&#39;ve had a look at those links but not found an answer there for my problem (apologies if I&#39;ve missed something there!)"}], "answers": [{"tags": [], "owner": {"reputation": 547, "user_id": 10769002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2da3297e022f0a7082ce73c500c3e65b?s=128&d=identicon&r=PG&f=1", "display_name": "Jenn", "link": "https://stackoverflow.com/users/10769002/jenn"}, "is_accepted": false, "score": 0, "last_activity_date": 1558383889, "creation_date": 1558383889, "answer_id": 56227700, "question_id": 56146311, "link": "https://stackoverflow.com/questions/56146311/how-to-loop-through-slides-in-a-presentation-pasting-a-new-excel-range-into-a-t/56227700#56227700", "title": "How to loop through slides in a presentation, pasting a new Excel range into a table in each slide", "body": "<p>I find it helpful to create tags for the PowerPoint tables set the tag name to TABLENAME and the tag value to the name of the Excel table.  Then you can loop for the specific tag in question and update that table, then move to the next.</p>\n\n<p>I also recommend putting your Excel data into tables in Excel and then referencing those in vba.</p>\n"}], "owner": {"reputation": 21, "user_id": 10755778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75304d1f7e6a42fc92e3a99058469e1c?s=128&d=identicon&r=PG&f=1", "display_name": "king11100234", "link": "https://stackoverflow.com/users/10755778/king11100234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 191, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558383889, "creation_date": 1557913557, "question_id": 56146311, "link": "https://stackoverflow.com/questions/56146311/how-to-loop-through-slides-in-a-presentation-pasting-a-new-excel-range-into-a-t", "title": "How to loop through slides in a presentation, pasting a new Excel range into a table in each slide", "body": "<p>I am attempting to paste every 20 rows from a large range in excel into powerpoint, every 20 rows in a separate table in a separate slide, using vba. I've been struggling with this for a while so any help would be greatly appreciated.</p>\n\n<p>I have already tried to loop through the excel range, which I believe works, but I have not managed to paste the ranges into separate slides - currently they paste into the same table in the same slide multiple times.</p>\n\n<p>code number 1:</p>\n\n<p>Loops through the excel range, but pastes into one specific table in one slide, rather than pastes each 20 rows into a separate table in separate slides:</p>\n\n<pre><code>Private Sub pptpasting()\nDim r As Range\nDim powerpointapp As PowerPoint.Application\nDim mypresentation As Object\n\nSet r = ThisWorkbook.Worksheets(\"...\").Range(\"C1:D847\")\nSet powerpointapp = GetObject(class:=\"PowerPoint.Application\")\nSet mypresentation = powerpointapp.Presentations(\"....ppxt\")\n\npowerpointapp.Visible = True\npowerpointapp.Activate\n\nIf powerpointapp Is Nothing Then\nMsgBox \"PowerPoint Presentation is not open, aborting.\"\nExit Sub\nEnd If\n\n'Handle if the PowerPoint Application is not found\nIf Err.Number = 429 Then\nMsgBox \"PowerPoint could not be found, aborting.\"\nExit Sub\nEnd If\nOn Error GoTo 0\n\n'Make the presentation the active presentation\nmypresentation.Windows(1).Activate\n\n'copy range in excel to paste into table on powerpoint\n\n Dim z As Integer\n 'here define the range to paste\n  For z = 1 To 150 Step 20\n  Range(r(z, 1), r(z + 19, 2)).Copy\n\n' find the table on a specific slide\n    With powerpointapp.ActivePresentation.Slides(3).Shapes(2).Table\n    .Cell(1, 1).Select\n    'paste into the table\n    powerpointapp.CommandBars.ExecuteMso (\"Paste\")\n\n    End With\nNext z\nEnd Sub\n</code></pre>\n\n<p>Code number 2:</p>\n\n<p>Here I am trying to loop through slides in the presentation, but I am failing and get the error code: Shape (unknown member) invalid request. To select a shape, its view must be active</p>\n\n<pre><code>Private Sub pptpasting()\nDim r As Range\nDim powerpointapp As PowerPoint.Application\nDim mypresentation As Object\n\nSet r = ThisWorkbook.Worksheets(\"...\").Range(\"C1:D847\")\nSet powerpointapp = GetObject(class:=\"PowerPoint.Application\")\nSet mypresentation = powerpointapp.Presentations(\"....ppxt\")\n\npowerpointapp.Visible = True\npowerpointapp.Activate\n\nIf powerpointapp Is Nothing Then\nMsgBox \"PowerPoint Presentation is not open, aborting.\"\nExit Sub\nEnd If\n\n   'Handle if the PowerPoint Application is not found\n    If Err.Number = 429 Then\n    MsgBox \"PowerPoint could not be found, aborting.\"\n    Exit Sub\n    End If\n    On Error GoTo 0\n\n'Make the presentation the active presentation\nmypresentation.Windows(1).Activate\n\n'copy range in excel to paste into table on powerpoint\n Dim i As Integer\n Dim z As Integer\n\n 'here define the range\nFor z = 1 To 150 Step 20\n    Range(r(z, 1), r(z + 19, 2)).Copy\n\n    'here loop through the slidse in the presentation, pasting into each slide\n    For i = 3 To powerpointapp.ActivePresentation.Slides.Count\n        With powerpointapp.ActivePresentation.Slides(i).Shapes(2).Table\n        'Paste the range into the table\n        .Cell(1, 1).Select\n        powerpointapp.CommandBars.ExecuteMso (\"Paste\")\n        End With\n     Next i\nNext z\n\nEnd Sub\n</code></pre>\n\n<p>As mentioned above, I expect or am trying to paste every 20 rows into a separate table in a separate slide, but both types of code I have tried don't work - 1) the first code pastes the looped through excel range into the same table in the same slide and 2) the second code has an error.</p>\n\n<p>Any help would be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba", "conditional-formatting"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10417531"}, "edited": false, "score": 0, "creation_date": 1557911574, "post_id": 56145559, "comment_id": 98920977, "body": "what is <code>Fstd.</code> and <code>FEDD.</code> ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10417531"}, "edited": false, "score": 0, "creation_date": 1557911910, "post_id": 56145559, "comment_id": 98921176, "body": "please <a href=\"https://stackoverflow.com/posts/56145559/edit\">update</a> your question, don&#39;t put code in the comments. Thank you"}, {"owner": {"reputation": 3, "user_id": 11503048, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FEjQ6eTBHrE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfxH0oJHV3Zn-Ltc4h_ndBPtcdk2w/mo/photo.jpg?sz=128", "display_name": "Sri Mallikarjun", "link": "https://stackoverflow.com/users/11503048/sri-mallikarjun"}, "edited": false, "score": 0, "creation_date": 1557911969, "post_id": 56145559, "comment_id": 98921211, "body": "ok .can you help me"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1557915909, "post_id": 56145559, "comment_id": 98923643, "body": "Welcome to SO. Try concatenating <code>Set oFormat = oRange.FormatConditions.Add(xlCellValue, xlBetween, &quot;=&quot; &amp; Fstd.Address, &quot;=&quot; &amp; FEDD.Address)</code>."}, {"owner": {"reputation": 3, "user_id": 11503048, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FEjQ6eTBHrE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfxH0oJHV3Zn-Ltc4h_ndBPtcdk2w/mo/photo.jpg?sz=128", "display_name": "Sri Mallikarjun", "link": "https://stackoverflow.com/users/11503048/sri-mallikarjun"}, "edited": false, "score": 0, "creation_date": 1557917556, "post_id": 56145559, "comment_id": 98924629, "body": "Perfect !!!.Working great.thanks a lot"}], "owner": {"reputation": 3, "user_id": 11503048, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FEjQ6eTBHrE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfxH0oJHV3Zn-Ltc4h_ndBPtcdk2w/mo/photo.jpg?sz=128", "display_name": "Sri Mallikarjun", "link": "https://stackoverflow.com/users/11503048/sri-mallikarjun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1557915668, "creation_date": 1557911424, "last_edit_date": 1557915668, "question_id": 56145559, "link": "https://stackoverflow.com/questions/56145559/excel-code-address-function-in-conditional-formatting-vba", "title": "Excel code .Address function in conditional formatting VBA", "body": "<p>Thank you in advance,\nI am trying to make conditional formatting by using vba for range of cells .but my output has <code>=\"R131C19\"</code> instead of <code>=R131C19</code> so the function is not working \nkindly help me</p>\n\n<p><a href=\"https://i.stack.imgur.com/l11kQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/l11kQ.png\" alt=\"enter image description here\"></a></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim Fstd As Range\nDim FEDD As Range\nDim oRange As Range\n\nDim oFormat As FormatCondition\nSet Fstd = Worksheets(\"Sheet2\").Cells(Last_Row, 19)\nSet FEDD = Worksheets(\"Sheet2\").Cells(Last_Row, 20)\nset lrow = Range(\"B\" &amp; Rows.Count).End(xlUp).Row + 1\n\nSet oRange = Range(\"u\" + lrow + \":\" + \"cl\" + lrow)\noRange.FormatConditions.Delete\n Set oFormat = oRange.FormatConditions.Add(xlCellValue, xlBetween, Fstd.Address, FEDD.Address)\noFormat.Font.Color = vbRed   '.interior.color=rgb(250,100,0)\noFormat.Interior.Color = vbRed\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1557910696, "post_id": 56145284, "comment_id": 98920464, "body": "You might benefit from reading  <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>."}, {"owner": {"reputation": 17, "user_id": 11304597, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sZEIZ9uUvuE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdBAPVJmwk43AbdrvvgiCpxp5X8mA/mo/photo.jpg?sz=128", "display_name": "Guimove ", "link": "https://stackoverflow.com/users/11304597/guimove"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1557911525, "post_id": 56145284, "comment_id": 98920944, "body": "Okay thank you very much! I&#39;ll read it. Do you have any idea about my problem?"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1557911758, "post_id": 56145284, "comment_id": 98921080, "body": "So your first row in the range will always be <code>B2</code>? and the last row is the one the user will provide? Where is this row number? is it provided in a sheet or do you have an <code>Input</code> dialog box capturing the number?"}, {"owner": {"reputation": 17, "user_id": 11304597, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sZEIZ9uUvuE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdBAPVJmwk43AbdrvvgiCpxp5X8mA/mo/photo.jpg?sz=128", "display_name": "Guimove ", "link": "https://stackoverflow.com/users/11304597/guimove"}, "edited": false, "score": 0, "creation_date": 1557912088, "post_id": 56145284, "comment_id": 98921298, "body": "Yes, my first line will always be B2 but the last line I filled it in myself and I change myself every time in the code. I don&#39;t know how to do an Input dialog box and I don&#39;t see how to do it because I have several calculation lines with the lines to fill in."}], "answers": [{"comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1557912156, "post_id": 56145801, "comment_id": 98921343, "body": "Or even, <code>ws.Range(&quot;B2:B&quot; &amp; LastRow).FormulaR1C1 = &quot;=CONCATENATE(RC[7],RIGHT(RC[-1]))&quot;</code> right?"}, {"owner": {"reputation": 17, "user_id": 11304597, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sZEIZ9uUvuE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdBAPVJmwk43AbdrvvgiCpxp5X8mA/mo/photo.jpg?sz=128", "display_name": "Guimove ", "link": "https://stackoverflow.com/users/11304597/guimove"}, "edited": false, "score": 0, "creation_date": 1557912227, "post_id": 56145801, "comment_id": 98921384, "body": "Thank you Peh and Damian! I&#39;ll do that, it&#39;s a very good idea.  When there are several calculation lines to be filled in, I do this for all the lines?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 17, "user_id": 11304597, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sZEIZ9uUvuE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdBAPVJmwk43AbdrvvgiCpxp5X8mA/mo/photo.jpg?sz=128", "display_name": "Guimove ", "link": "https://stackoverflow.com/users/11304597/guimove"}, "edited": false, "score": 0, "creation_date": 1557912441, "post_id": 56145801, "comment_id": 98921506, "body": "@Guimove not sure what you mean. Check  my edited answer."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 3, "last_activity_date": 1557912340, "last_edit_date": 1557912340, "creation_date": 1557912079, "answer_id": 56145801, "question_id": 56145284, "link": "https://stackoverflow.com/questions/56145284/how-to-enter-a-variable-value-decided-by-the-user-on-vba/56145801#56145801", "title": "How to enter a variable value decided by the user on vba?", "body": "<p>You can automatically find the last used row in column A for example using</p>\n\n<pre><code>LastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row  \n</code></pre>\n\n<p>So this code should fill as many rows in column B as there is data in column A</p>\n\n<pre><code>Dim ws As Worksheet\nSet ws = ThisWorkbook.Worksheets(\"Sheet1\") 'define your sheet name\n\nDim LastRow As Long\nLastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row    \n\nws.Range(\"B2\").FormulaR1C1 = \"=CONCATENATE(RC[7],RIGHT(RC[-1]))\"\nws.Range(\"B2\").AutoFill Destination:=ws.Range(\"B2:B\" &amp; LastRow), Type:=xlFillDefault\n</code></pre>\n\n<p>or even just write the formula without using Autofill into all cells directly:</p>\n\n<pre><code>ws.Range(\"B2:B\" &amp; LastRow).FormulaR1C1 = \"=CONCATENATE(RC[7],RIGHT(RC[-1]))\"\n</code></pre>\n\n<p>If you have another formula eg in column C then just add it like </p>\n\n<pre><code>Dim ws As Worksheet\nSet ws = ThisWorkbook.Worksheets(\"Sheet1\") 'define your sheet name\n\nDim LastRow As Long\nLastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row    \n\nws.Range(\"B2:B\" &amp; LastRow).FormulaR1C1 = \"=CONCATENATE(RC[7],RIGHT(RC[-1]))\"\nws.Range(\"C2:C\" &amp; LastRow).FormulaR1C1 = 'your formula here\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 11304597, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sZEIZ9uUvuE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdBAPVJmwk43AbdrvvgiCpxp5X8mA/mo/photo.jpg?sz=128", "display_name": "Guimove ", "link": "https://stackoverflow.com/users/11304597/guimove"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 56145801, "answer_count": 1, "score": 1, "last_activity_date": 1557912340, "creation_date": 1557910558, "last_edit_date": 1557910690, "question_id": 56145284, "link": "https://stackoverflow.com/questions/56145284/how-to-enter-a-variable-value-decided-by-the-user-on-vba", "title": "How to enter a variable value decided by the user on vba?", "body": "<p>I have to do a calculation on using several excel sheets and I need the user to enter the number of lines except that this number varies each year so I want this variable to be variable and entered by the user who will use the macro.  Unfortunately I can't find a way to do it. </p>\n\n<pre><code>Range(\"B2\").Select\nActiveCell.FormulaR1C1 = \"=CONCATENATE(RC[7],RIGHT(RC[-1]))\"\nRange(\"B2\").Select\nSelection.AutoFill Destination:=Range(\"B2:B95145\"), Type:=xlFillDefault\nRange(\"B2:B95145\").Select\nRange(\"J1\").Select\n</code></pre>\n\n<p>for example, when I want to perform a calculation I want the B2:B95145 to be variable, the numbers that must be entered before the macro is launched.</p>\n"}, {"tags": ["excel", "vba", "select"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1557912019, "post_id": 56145223, "comment_id": 98921246, "body": "If you are doing this with a macro then there is no need to use <code>Select</code>. If you provide your code and possibly a snapshot of your workbook, it might help to resolve your problem"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1557912341, "post_id": 56145223, "comment_id": 98921441, "body": "Like @Zac suggested you should avoid working with <code>Select</code> here is how: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a> but you can&#39;t select a worksheet unless you have as active workbook the workbook containing it, so you should first focus that workbook."}, {"owner": {"reputation": 17, "user_id": 9360923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c81bbe7373af2b103c1c86140a0ffdfd?s=128&d=identicon&r=PG", "display_name": "Danhadnagy", "link": "https://stackoverflow.com/users/9360923/danhadnagy"}, "edited": false, "score": 0, "creation_date": 1557912734, "post_id": 56145223, "comment_id": 98921687, "body": "if i just use this basic sub, i get error message  Sub data()  Sheets(1).Select      End Sub"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1557912768, "post_id": 56145223, "comment_id": 98921706, "body": "@Damian: Not sure that&#39;s true Damian.. i.e. if my active workbook is <code>WB1</code> and I want reference <code>Sheet1</code> from <code>WB2</code>, all I have to do is: <code>Workbooks(&quot;WB2&quot;).Worksheets(&quot;Sheet1&quot;)</code>. I could also use something lik: <code>With Workbooks(&quot;WB2&quot;).Worksheets(&quot;Sheet1&quot;)</code> I don&#39;t ever need to activate the WB2"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1557912907, "post_id": 56145223, "comment_id": 98921774, "body": "@Zac of course, but if you want to <code>Select</code> <code>Sheet1</code> you must activate <code>WB2</code> that&#39;s for sure."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1557913284, "post_id": 56145223, "comment_id": 98922013, "body": "I know there are exceptions to rules but my question would be: why is OP attempting to select a sheet in the first place? More often then not it&#39;s because people don&#39;t realise that they don&#39;t have to and infect it&#39;s more efficient just to reference a sheet"}, {"owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "edited": false, "score": 0, "creation_date": 1557913647, "post_id": 56145223, "comment_id": 98922241, "body": "Does the error occur all the time or just with corrupt files?"}, {"owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "edited": false, "score": 0, "creation_date": 1557913829, "post_id": 56145223, "comment_id": 98922360, "body": "Are there 2 (or more) sheets in the workbook? Try opening the file with Excel, start IDE with Alt+F11, and issue the <code>Sheets(2).Select</code> command in the immediate window. What happens then?"}, {"owner": {"reputation": 17, "user_id": 9360923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c81bbe7373af2b103c1c86140a0ffdfd?s=128&d=identicon&r=PG", "display_name": "Danhadnagy", "link": "https://stackoverflow.com/users/9360923/danhadnagy"}, "reply_to_user": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "edited": false, "score": 0, "creation_date": 1557914698, "post_id": 56145223, "comment_id": 98922889, "body": "@AcsErno yes, only with corrupt file. in every file there are exactly 2 sheets. When I use immediate windows, it works but then the macro fails again."}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1557915101, "post_id": 56145223, "comment_id": 98923141, "body": "You need to post your code and possibly a screenshot of your project window.  It is not giving you a <code>Subscript out of range</code> which would indicate it doesn&#39;t exist or recognize it.  There may be other things involved."}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1557917071, "post_id": 56145223, "comment_id": 98924338, "body": "Would also help to know where you are running your macro from, presumably not from the .xlsx file that you receive, unless you are pasting the code into the workbook when received."}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1557920734, "post_id": 56145223, "comment_id": 98926425, "body": "If the second sheet is hidden this would occur. Try using the name of the sheet rather than the index: Sheets(&quot;mysheet&quot;).activate ought to work"}], "owner": {"reputation": 17, "user_id": 9360923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c81bbe7373af2b103c1c86140a0ffdfd?s=128&d=identicon&r=PG", "display_name": "Danhadnagy", "link": "https://stackoverflow.com/users/9360923/danhadnagy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557910355, "creation_date": 1557910355, "question_id": 56145223, "link": "https://stackoverflow.com/questions/56145223/select-sheet-command-doesnt-work-in-a-corrupted-excel-file", "title": "Select sheet command doesn&#39;t work in a corrupted excel file", "body": "<p>I get an excel (xlsx) file with two sheets everyday from our business partner. I would like to analyze this data but in my macro when</p>\n\n<p>Sheets(2).Select</p>\n\n<p>I get Run-time error '1004'</p>\n\n<p>I tried with the sheet name, then I add a new sheet but I can't seletc that one either with macro. I recorded a macro 'select sheet' then I ran that macro and the same error message. Then I opened the file with </p>\n\n<p>_corruptload:=XlCorruptLoad.xlRepairFile</p>\n\n<p>but it didn't help</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "edited": false, "score": 0, "creation_date": 1557928032, "post_id": 56145175, "comment_id": 98931183, "body": "Freeze screen, Change view, Navigate, Change back, Unfreeze?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1557931539, "post_id": 56145175, "comment_id": 98933570, "body": "It works for me. But I don&#39;t use <code>Selection</code>, I use <code>ActiveDocument</code> to specify the target <code>Range</code> (whether bookmark or something else)..."}, {"owner": {"reputation": 151, "user_id": 1905429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4719c8c59a3e40c2d45d9d4240fd5a3d?s=128&d=identicon&r=PG&f=1", "display_name": "Menny Barzilay", "link": "https://stackoverflow.com/users/1905429/menny-barzilay"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1557941789, "post_id": 56145175, "comment_id": 98938921, "body": "@CindyMeister I&#39;ve tried all of which and none worked:      ActiveDocument.GoTo What:=wdGoToPage, which:=wdGoToAbsolute, Count:=1     ActiveDocument.Range.GoTo What:=wdGoToPage, which:=wdGoToAbsolute, Count:=1     Selection.GoTo What:=wdGoToBookmark, Name:=&quot;LastReadingPoint&quot;     ActiveDocument.Range.GoTo What:=wdGoToBookmark, Name:=&quot;LastReadingPoint&quot;     ActiveDocument.Range.GoToNext wdGoToPage     ActiveDocument.GoTo What:=wdGoToBookmark, Name:=&quot;LastReadingPoint&quot;"}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1558045221, "post_id": 56145175, "comment_id": 98980992, "body": "Cross-posted at: <a href=\"http://www.msofficeforums.com/word-vba/42518-can-vba-change-pages-microsoft-words-read.html\" rel=\"nofollow noreferrer\">msofficeforums.com/word-vba/&hellip;</a>.  For cross-posting etiquette, please read: <a href=\"http://www.excelguru.ca/content.php?184\" rel=\"nofollow noreferrer\">excelguru.ca/content.php?184</a>"}, {"owner": {"reputation": 151, "user_id": 1905429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4719c8c59a3e40c2d45d9d4240fd5a3d?s=128&d=identicon&r=PG&f=1", "display_name": "Menny Barzilay", "link": "https://stackoverflow.com/users/1905429/menny-barzilay"}, "reply_to_user": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "edited": false, "score": 0, "creation_date": 1558178093, "post_id": 56145175, "comment_id": 99020066, "body": "@SlowLearner basically it works (and it&#39;s a brilliant idea) but the screen still &quot;jumps&quot; when changing view even with Freeze Screen (Application.ScreenUpdating = False)."}], "answers": [{"tags": [], "owner": {"reputation": 151, "user_id": 1905429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4719c8c59a3e40c2d45d9d4240fd5a3d?s=128&d=identicon&r=PG&f=1", "display_name": "Menny Barzilay", "link": "https://stackoverflow.com/users/1905429/menny-barzilay"}, "is_accepted": true, "score": 0, "last_activity_date": 1558646495, "last_edit_date": 1558646495, "creation_date": 1558180076, "answer_id": 56198637, "question_id": 56145175, "link": "https://stackoverflow.com/questions/56145175/can-vba-change-pages-in-microsoft-words-read-mode-layout/56198637#56198637", "title": "Can VBA change pages in Microsoft Word&#39;s &quot;Read Mode&quot; Layout?", "body": "<p>After posting my answer, I was suggested with a superior answer.</p>\n\n<p>My original answer:</p>\n\n<p>At this point, I think that there is no way to control \"Reading Mode\" layout from VBA. Hence, I overcame this limitation by sending \"Right arrow\" key and \"Left arrow\" key to move one page forward and one page back respectively.</p>\n\n<pre><code>Private Sub BTN_IncPage_Click()\n    Word.Application.Activate\n    SendKeys (\"{RIGHT}\")\n    BTN_IncPage.SetFocus\nEnd Sub\n</code></pre>\n\n<p>The superior answer:</p>\n\n<p>source: <a href=\"https://social.msdn.microsoft.com/Forums/en-US/a5a198f4-f56c-4489-8ab4-3bb96db6a7f3/can-vba-change-pages-in-microsoft-words-8220read-mode8221-layout?forum=isvvba\" rel=\"nofollow noreferrer\">https://social.msdn.microsoft.com/Forums/en-US/a5a198f4-f56c-4489-8ab4-3bb96db6a7f3/can-vba-change-pages-in-microsoft-words-8220read-mode8221-layout?forum=isvvba</a></p>\n\n<p>ActiveWindow.ActivePane.PageScroll down:=1</p>\n"}, {"tags": [], "owner": {"reputation": 96, "user_id": 1196277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe953ee18cf711cc767b9f234a9d826f?s=128&d=identicon&r=PG", "display_name": "Billy", "link": "https://stackoverflow.com/users/1196277/billy"}, "is_accepted": false, "score": 1, "last_activity_date": 1579553257, "last_edit_date": 1579553257, "creation_date": 1579306667, "answer_id": 59796412, "question_id": 56145175, "link": "https://stackoverflow.com/questions/56145175/can-vba-change-pages-in-microsoft-words-read-mode-layout/59796412#59796412", "title": "Can VBA change pages in Microsoft Word&#39;s &quot;Read Mode&quot; Layout?", "body": "<p>Here are a few options, none of which are very good.</p>\n\n<ul>\n<li><p>Use <code>ScrollIntoView</code>. This function scrolls so the provided range is visible <em>somewhere</em> on the screen. If the range is already on screen, nothing will happen. If it's off-screen, it seems to end up being positioned about 1/4 of the way down, similar to what happens when you follow a hyperlink.</p>\n\n<pre><code>ActiveWindow.ScrollIntoView ActiveDocument.Bookmarks(\"LastReadingPoint\").Range\n</code></pre></li>\n<li><p>Follow an existing hyperlink within the document. This will position the target about 1/4 of the way down rather than at the top like the navigation pane or, in Word 2010, <code>GoTo</code> with a bookmark.</p>\n\n<pre><code>Dim h As Hyperlink\nFor Each h In ActiveDocument.Hyperlinks\n    If h.SubAddress = \"LastReadingPoint\" And h.Address = vbNullString And h.Type = msoHyperlinkRange Then\n        h.Follow\n        Exit For\n    End If\nNext h\n</code></pre></li>\n<li><p>Create a new hidden document with a hyperlink to the bookmark and follow it. This requires your existing document to have been saved at some point so it has a name and path. It will also increment the counter used to name new documents.</p>\n\n<pre><code>Dim d As Document\nDim h As Hyperlink\nSet d = Application.Documents.Add(Visible:=False)\nSet h = d.Hyperlinks.Add(d.Range(0, 0), ActiveDocument.FullName, \"LastReadingPoint\")\nh.Follow\nd.Close False\n</code></pre></li>\n<li><p>Temporarily exit reading mode. The screen will flash and the ribbon will briefly appear, even if you turn off <code>ScreenUpdating</code>.</p>\n\n<pre><code>Dim readingMode As Boolean\nreadingMode = ActiveDocument.ActiveWindow.View.ReadingLayout\nIf readingMode Then ActiveDocument.ActiveWindow.View.ReadingLayout = False\nSelection.GoTo wdGoToBookmark, , , \"LastReadingPoint\"\nIf readingMode Then ActiveDocument.ActiveWindow.View.ReadingLayout = True\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 151, "user_id": 1905429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4719c8c59a3e40c2d45d9d4240fd5a3d?s=128&d=identicon&r=PG&f=1", "display_name": "Menny Barzilay", "link": "https://stackoverflow.com/users/1905429/menny-barzilay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "accepted_answer_id": 56198637, "answer_count": 2, "score": 1, "last_activity_date": 1579553257, "creation_date": 1557910231, "last_edit_date": 1557961098, "question_id": 56145175, "link": "https://stackoverflow.com/questions/56145175/can-vba-change-pages-in-microsoft-words-read-mode-layout", "title": "Can VBA change pages in Microsoft Word&#39;s &quot;Read Mode&quot; Layout?", "body": "<p>I'm trying to change pages while Microsoft Word is in \"Read Mode\"* by using a VBA code, and I can't seem to find any function that allows that.</p>\n\n<p>(* Please notice that I'm talking about the \"Read Mode\" layout that you can change with the bottom-right icons in word, and not the \"Read Only\" mode that you sometimes get when you open a document from an unknown source)</p>\n\n<p>In \"Print Layout\" it is simple since I can use something like -</p>\n\n<pre><code>Selection.GoTo What:=wdGoToBookmark, Name:=\"LastReadingPoint\"\n</code></pre>\n\n<p>But It won't work while I'm in \"Read Mode\".</p>\n\n<p>None of these work:</p>\n\n<pre><code>ActiveDocument.GoTo What:=wdGoToPage, which:=wdGoToAbsolute, Count:=1\nActiveDocument.Range.GoTo What:=wdGoToPage, which:=wdGoToAbsolute, Count:=1\nSelection.GoTo What:=wdGoToBookmark, Name:=\"LastReadingPoint\"\nActiveDocument.Range.GoTo What:=wdGoToBookmark, Name:=\"LastReadingPoint\"\nActiveDocument.Range.GoToNext wdGoToPage\nActiveDocument.GoTo What:=wdGoToBookmark, Name:=\"LastReadingPoint\"\n</code></pre>\n\n<p>(LastReadingPoint is a bookmark I've added to the text)</p>\n\n<p>Any ideas or hacks?</p>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5856070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85efce5b92c7dde1821af707d717bcde?s=128&d=identicon&r=PG&f=1", "display_name": "Flexxzor", "link": "https://stackoverflow.com/users/5856070/flexxzor"}, "edited": false, "score": 0, "creation_date": 1557910565, "post_id": 56145229, "comment_id": 98920393, "body": "How should I call it in TestFunction2 ? It&#39;s in another module"}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1557910630, "post_id": 56145229, "comment_id": 98920426, "body": "Have to be careful about the downside of having public variables (have to check they&#39;ve been set in the first place), but otherwise this is one way to do it."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1557910755, "post_id": 56145229, "comment_id": 98920502, "body": "The same as you do now. It&#39;s optional to specify the module, like <code>Module1.amount</code>"}], "tags": [], "owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "is_accepted": true, "score": 0, "last_activity_date": 1557910372, "creation_date": 1557910372, "answer_id": 56145229, "question_id": 56145170, "link": "https://stackoverflow.com/questions/56145170/can-i-pass-a-variable-between-two-private-functions-in-different-modules/56145229#56145229", "title": "Can I pass a variable between two private functions in different modules?", "body": "<p>Sure, that's doable by declaring the <code>amount</code> variable as Public:</p>\n\n<pre><code>Public amount As Long 'not sure why you declared it as a string, as it seems to be a number\n\nPrivate function TestFunction1 (ByVal traffic as string) As Boolean\n    'snippet from the code\n    amount = inputbox(\"Fill in amount\")\nEnd Function\n\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5856070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85efce5b92c7dde1821af707d717bcde?s=128&d=identicon&r=PG&f=1", "display_name": "Flexxzor", "link": "https://stackoverflow.com/users/5856070/flexxzor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16, "favorite_count": 0, "accepted_answer_id": 56145229, "answer_count": 1, "score": 1, "last_activity_date": 1557911521, "creation_date": 1557910208, "question_id": 56145170, "link": "https://stackoverflow.com/questions/56145170/can-i-pass-a-variable-between-two-private-functions-in-different-modules", "title": "Can I pass a variable between two private functions in different modules?", "body": "<p>I have two private functions in two different modules. These two functions should share a common variable. How should I go about programming this?</p>\n\n<p>The current code is this:</p>\n\n<pre><code>Private function TestFunction1 (ByVal traffic as string) As Boolean\n'snippet from the code\ndim amount as string\namount = inputbox(\"Fill in amount\")\nend function\n</code></pre>\n\n<hr>\n\n<pre><code>Private Function TestFunction2 (ByVal layout as string) as Boolean\n'snippet from the code\ndim result as string\nresult = \"the amount is: \" &amp; amount\nend function\n</code></pre>\n\n<p>I know this is not a correct function but it's just a part of the code. I cannot share the entire code because of business regulations.\nHow should I go about passing the amount to the other function in another module?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["html", "excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1557911829, "post_id": 56145101, "comment_id": 98921128, "body": "There are a number of ways that you could achieve this, you could get a collection of the nodes that contain the class that you desire then loop through those assessing the inner.text or inner.html to look for your desired node (using .getElementsByClassName() <a href=\"https://stackoverflow.com/a/37840179/6387479\">see this answer</a>) - Another method which arguably would be the most efficient would be to use <code>.querySelector()</code> to locate the node directly like <a href=\"https://stackoverflow.com/q/56005033/6387479\">this question</a> / <a href=\"https://www.w3schools.com/jsref/met_document_queryselector.asp\" rel=\"nofollow noreferrer\">w3schools link</a>"}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1557912212, "post_id": 56145101, "comment_id": 98921373, "body": "<a href=\"https://www.w3schools.com/cssref/css_selectors.asp\" rel=\"nofollow noreferrer\">Another resource for the selectors</a> (not edited as character limit reached) in particular: <code>[attribute*=value]\ta[href*=&quot;w3schools&quot;]\tSelects every &lt;a&gt; element whose href attribute value contains the substring &quot;w3schools&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "edited": false, "score": 0, "creation_date": 1557913694, "post_id": 56145872, "comment_id": 98922271, "body": "this gives an error 5002 <code>Application-defined or object-defined error</code>. Also please see edited question with the rest of the source code, as it continuous. There are 5 variants with class <code>.a_1_611</code> inside <code>.data</code>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "edited": false, "score": 0, "creation_date": 1557914070, "post_id": 56145872, "comment_id": 98922505, "body": "but is the first the required one?  Put .data .a_1_611 in the browser to check in the search box. The error doesn&#39;t seem right . Is it occurring on that line?"}, {"owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "edited": false, "score": 0, "creation_date": 1557915249, "post_id": 56145872, "comment_id": 98923231, "body": "I have added to my question search result for <code>.data .a_1_611</code>. Yes, first one should be picked but it would be interesting to know how to pick also second one for example. Error points to <code>ie.document.querySelector(&quot;.data .a_1_611&quot;).innerText</code>. I have edited my code in question is it right or should there be <code>.Click</code> as it is link?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "edited": false, "score": 0, "creation_date": 1557915307, "post_id": 56145872, "comment_id": 98923268, "body": "If you want to click then ie.document.querySelector(&quot;.data .a_1_611&quot;).Click"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "edited": false, "score": 0, "creation_date": 1557915333, "post_id": 56145872, "comment_id": 98923286, "body": "The second one: .data .a_1_611 .data .a_1_611 is one way"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "edited": false, "score": 0, "creation_date": 1557915357, "post_id": 56145872, "comment_id": 98923295, "body": ".data .a_1_611:nth-of-type(2) though it might complain at that syntax"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1557915372, "last_edit_date": 1557915372, "creation_date": 1557912305, "answer_id": 56145872, "question_id": 56145101, "link": "https://stackoverflow.com/questions/56145101/web-scraping-by-link-text/56145872#56145872", "title": "Web scraping by link text", "body": "<p>They are class names not ids. A loop is perhaps required, with test of innerText value of node, if ordering changes but otherwise you want the first match for the example shown in image</p>\n\n<pre><code>.data .a_1_611\n</code></pre>\n\n<p>Which is </p>\n\n<pre><code>ie.document.querySelector(\".data .a_1_611\").click\n</code></pre>\n\n<p><code>nth-of-type</code> is useful for fixed position selection but more expensive than class selectors.</p>\n"}], "owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 56145872, "answer_count": 1, "score": 0, "last_activity_date": 1557917657, "creation_date": 1557909986, "last_edit_date": 1557917657, "question_id": 56145101, "link": "https://stackoverflow.com/questions/56145101/web-scraping-by-link-text", "title": "Web scraping by link text", "body": "<p>I have some experience and knowledge how to scrap by tagName or ClassName. However in this particular case className is not unique also link is changing all the time after accessing the page so it is not possible to get a direct link. The only unique combination is class and link text. What would be the code to access for example <code>Budget and Forecast updating</code> with <code>a_1_610</code> and <code>Budget and Forecast updating</code> with <code>a_1_611</code>?</p>\n\n<p>My code (edited according to QHarr answer):</p>\n\n<pre><code>Sub GoToLiinosBot()\n\n'This will load a webpage in IE\nDim ie As InternetExplorer\nDim HWNDSrc As Long\nDim elements As Object\n\nSet ie = Nothing\nSet ie = New InternetExplorerMedium\n\nie.Visible = True\n\nie.Navigate \"http://link.com\"\n\nWith ie\n\nDo\nDoEvents\nLoop Until ie.ReadyState = READYSTATE_COMPLETE\nEnd With\n\n    Application.Wait (Now + TimeValue(\"0:00:04\"))\n\n    ie.Document.querySelector(\".data .a_1_611\").innerText\n\n'Unload IE\nSet ie = Nothing\nEnd Sub\n</code></pre>\n\n<p>Here is source code:</p>\n\n<p><a href=\"https://i.stack.imgur.com/H4UrG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/H4UrG.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1557910136, "post_id": 56145061, "comment_id": 98920146, "body": "\u2460 Your first line of code is missing but important for us. \u2022 \u2461 Please read <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and provide a complete example of your issue including sample input and desired output data. Screenshots might help here too."}, {"owner": {"reputation": 5, "user_id": 9894235, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hX_BpFwUhEs/AAAAAAAAAAI/AAAAAAAACSI/JBfKi9taalk/photo.jpg?sz=128", "display_name": "Mastan Shaik", "link": "https://stackoverflow.com/users/9894235/mastan-shaik"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1557910202, "post_id": 56145061, "comment_id": 98920181, "body": "yes my first lien is &quot;Private Sub Worksheet_Change(ByVal Target As Excel.Range)&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1557910329, "post_id": 56145179, "comment_id": 98920256, "body": "Note that this fails if <code>Target</code> is not a single cell but a range. This breaks the ability of copy/paste ranges. To avoid that use <code>Intersect</code> like the OP already did correctly! \u2022 And do it in two distinct <code>If</code> statements. <code>Target</code> can contain column 2 and 7 <b>at the same time</b> which is not covered by <code>ElseIf</code>."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1557910690, "post_id": 56145179, "comment_id": 98920459, "body": "I&#39;ve never learn to use the intersect @P\u1d07\u029c how would I use it here? <code>If intersect(Me.Columns(2), Target) Then</code> this works if its on column 2, but wont work to any other column."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1557911149, "post_id": 56145179, "comment_id": 98920729, "body": "Just exactly as the OP did. He did everything correct (including looping through the intersected range that is missing in your code too) except that he exit sub if <code>Target</code> is not column 2 and therefore never reaches the second test for column 7. See my answer."}, {"owner": {"reputation": 5, "user_id": 9894235, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hX_BpFwUhEs/AAAAAAAAAAI/AAAAAAAACSI/JBfKi9taalk/photo.jpg?sz=128", "display_name": "Mastan Shaik", "link": "https://stackoverflow.com/users/9894235/mastan-shaik"}, "edited": false, "score": 0, "creation_date": 1557911997, "post_id": 56145179, "comment_id": 98921230, "body": "Supper Damian working exact what i expect, thanks a lot"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 5, "user_id": 9894235, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hX_BpFwUhEs/AAAAAAAAAAI/AAAAAAAACSI/JBfKi9taalk/photo.jpg?sz=128", "display_name": "Mastan Shaik", "link": "https://stackoverflow.com/users/9894235/mastan-shaik"}, "edited": false, "score": 0, "creation_date": 1557912038, "post_id": 56145179, "comment_id": 98921262, "body": "@MastanShaik you should check PEH&#39;s answer, mine won&#39;t work if you paste multiple cells."}, {"owner": {"reputation": 5, "user_id": 9894235, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hX_BpFwUhEs/AAAAAAAAAAI/AAAAAAAACSI/JBfKi9taalk/photo.jpg?sz=128", "display_name": "Mastan Shaik", "link": "https://stackoverflow.com/users/9894235/mastan-shaik"}, "edited": false, "score": 0, "creation_date": 1557915656, "post_id": 56145179, "comment_id": 98923473, "body": "@Damian,Thanks for your advise and we donot paste multiple cells,but the thing is when other user overwrite the cell,original user name getting change,it should not happen,that is the requirement"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 5, "user_id": 9894235, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hX_BpFwUhEs/AAAAAAAAAAI/AAAAAAAACSI/JBfKi9taalk/photo.jpg?sz=128", "display_name": "Mastan Shaik", "link": "https://stackoverflow.com/users/9894235/mastan-shaik"}, "edited": false, "score": 0, "creation_date": 1557915979, "post_id": 56145179, "comment_id": 98923678, "body": "@MastanShaik I don&#39;t get that, so If you change cell B2 and someone else changes later that cell, what is your goal? What should A2 be?"}, {"owner": {"reputation": 5, "user_id": 9894235, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hX_BpFwUhEs/AAAAAAAAAAI/AAAAAAAACSI/JBfKi9taalk/photo.jpg?sz=128", "display_name": "Mastan Shaik", "link": "https://stackoverflow.com/users/9894235/mastan-shaik"}, "edited": false, "score": 0, "creation_date": 1557916823, "post_id": 56145179, "comment_id": 98924194, "body": "@Damian,Yes ,if some one (other user) want to edit the data inserted in B2 as you said,First user name, who inserted the data should be remain,But here, user name get changing."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 5, "user_id": 9894235, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hX_BpFwUhEs/AAAAAAAAAAI/AAAAAAAACSI/JBfKi9taalk/photo.jpg?sz=128", "display_name": "Mastan Shaik", "link": "https://stackoverflow.com/users/9894235/mastan-shaik"}, "edited": false, "score": 0, "creation_date": 1557917178, "post_id": 56145179, "comment_id": 98924402, "body": "@MastanShaik then you just need to check wether the cell is empty or not, check out my answer, I edited it with the checking."}], "tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": true, "score": 0, "last_activity_date": 1557917149, "last_edit_date": 1557917149, "creation_date": 1557910239, "answer_id": 56145179, "question_id": 56145061, "link": "https://stackoverflow.com/questions/56145061/need-help-for-auto-user-name-and-time/56145179#56145179", "title": "Need help for Auto user name and time", "body": "<p>If I got it right, this is working for me:</p>\n\n<pre><code>Option Explicit\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    If Target.Column = 2 Then\n        If Me.Cells(Target.Row, 1) = vbNullString Then Me.Cells(Target.Row, 1) = Now()\n        If Me.Cells(Target.Row, 15) = vbNullString Then Me.Cells(Target.Row, 15) = Environ(\"username\")\n    ElseIf Target.Column = 7 Then\n        If Me.Cells(Target.Row, 9) = vbNullString Then Me.Cells(Target.Row, 9) = Now()\n        If Me.Cells(Target.Row, 14) = vbNullString Then Me.Cells(Target.Row, 14) = Environ(\"username\")\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Thought I'm not sure if you want the logging to be on the same row you are inserting data or rewrite it always on the same cell.</p>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 9894235, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hX_BpFwUhEs/AAAAAAAAAAI/AAAAAAAACSI/JBfKi9taalk/photo.jpg?sz=128", "display_name": "Mastan Shaik", "link": "https://stackoverflow.com/users/9894235/mastan-shaik"}, "edited": false, "score": 0, "creation_date": 1557912014, "post_id": 56145435, "comment_id": 98921240, "body": "Supper PEH,working exact what i expect, thanks a lot"}, {"owner": {"reputation": 5, "user_id": 9894235, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hX_BpFwUhEs/AAAAAAAAAAI/AAAAAAAACSI/JBfKi9taalk/photo.jpg?sz=128", "display_name": "Mastan Shaik", "link": "https://stackoverflow.com/users/9894235/mastan-shaik"}, "edited": false, "score": 0, "creation_date": 1557916196, "post_id": 56145435, "comment_id": 98923827, "body": "Dear PEH,thanks for your help,a small doubt, how we work in excel is ,First, Column 2 was filled then we get auto date and user name,Second, column 7 was filled then we need auto date and user name again,here what happen is,if Column 2 filled,first part of code working correct,but not 2nd part,if Column 2 not filled then only column 7 code working,any comments?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 5, "user_id": 9894235, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hX_BpFwUhEs/AAAAAAAAAAI/AAAAAAAACSI/JBfKi9taalk/photo.jpg?sz=128", "display_name": "Mastan Shaik", "link": "https://stackoverflow.com/users/9894235/mastan-shaik"}, "edited": false, "score": 0, "creation_date": 1557919370, "post_id": 56145435, "comment_id": 98925625, "body": "I don&#39;t get what you mean. Probably you need to explain it in your original question and add a screenshot or something to explain the issue better."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1557911059, "creation_date": 1557911059, "answer_id": 56145435, "question_id": 56145061, "link": "https://stackoverflow.com/questions/56145061/need-help-for-auto-user-name-and-time/56145435#56145435", "title": "Need help for Auto user name and time", "body": "<p>The problematic line is <code>If rng Is Nothing Then Exit Sub</code> because if <code>Target</code> is not in column 2 it exits sub and will never reach the second test for column 7.</p>\n\n<p>So use <code>If Not rng Is Nothing Then</code> instead:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Excel.Range)\n    Dim rng As Range, c As Range\n    Set rng = Application.Intersect(Target, Me.Columns(2))\n    If Not rng Is Nothing Then\n        For Each c In rng.Cells\n            If Len(c.Value) &gt; 0 Then\n                If Len(c.Offset(0, -1).Value) = 0 Then\n                    With c.EntireRow\n                        .Cells(1, \"A\").Value = Now()\n                        '.Cells(1, \"B\").Value = Date\n                        .Cells(1, \"O\").Value = Environ(\"username\")\n                    End With\n                End If\n            End If\n        Next c\n    End If\n\n    Set rng = Application.Intersect(Target, Me.Columns(7))\n    If Not rng Is Nothing Then\n        For Each c In rng.Cells\n            If Len(c.Value) &gt; 0 Then\n                If Len(c.Offset(0, -1).Value) = 0 Then\n                    With c.EntireRow\n                        .Cells(1, \"I\").Value = Now()\n                        '.Cells(1, \"B\").Value = Date\n                        .Cells(1, \"N\").Value = Environ(\"username\")\n                    End With\n                End If\n            End If\n        Next c\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 9894235, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hX_BpFwUhEs/AAAAAAAAAAI/AAAAAAAACSI/JBfKi9taalk/photo.jpg?sz=128", "display_name": "Mastan Shaik", "link": "https://stackoverflow.com/users/9894235/mastan-shaik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 56145179, "answer_count": 2, "score": 0, "last_activity_date": 1557917149, "creation_date": 1557909881, "last_edit_date": 1557911266, "question_id": 56145061, "link": "https://stackoverflow.com/questions/56145061/need-help-for-auto-user-name-and-time", "title": "Need help for Auto user name and time", "body": "<p>I am using an Excel in which I need to get Auto user name and Time for two entry's example\n1. If I insert a value in column 2 I need user name and time at cell \"A\" and \"O\"\n2. In same Excel sheet again for the entry at Column(7) I need date and Username at cell \"I\" and \"N\"</p>\n\n<p>My code working for single point and I am confuse how to use twice.</p>\n\n<p>Check the code I try and advise</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Excel.Range)\n    Dim rng As Range, c As Range\n    Set rng = Application.Intersect(Target, Me.Columns(2))\n    If rng Is Nothing Then Exit Sub\n    For Each c In rng.Cells\n        If Len(c.Value) &gt; 0 Then\n            If Len(c.Offset(0, -1).Value) = 0 Then\n                With c.EntireRow\n                    .Cells(1, \"A\").Value = Now()\n                    '.Cells(1, \"B\").Value = Date\n                    .Cells(1, \"O\").Value = Environ(\"username\")\n                End With\n            End If\n        End If\n\n    Set rng = Application.Intersect(Target, Me.Columns(7))\n    If rng Is Nothing Then Exit Sub\n    For Each c In rng.Cells\n        If Len(c.Value) &gt; 0 Then\n            If Len(c.Offset(0, -1).Value) = 0 Then\n                With c.EntireRow\n                    .Cells(1, \"I\").Value = Now()\n                    '.Cells(1, \"B\").Value = Date\n                    .Cells(1, \"N\").Value = Environ(\"username\")\n                End With\n            End If\n        End If\n    Next c\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1557913177, "post_id": 56144977, "comment_id": 98921936, "body": "If you try this code, will it work? <code>Workbooks.Open &quot;C:\\abc.xlsm&quot;</code> Does it open the workbook?"}, {"owner": {"reputation": 309, "user_id": 9286924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2L7p4.jpg?s=128&g=1", "display_name": "anandhu", "link": "https://stackoverflow.com/users/9286924/anandhu"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1557913246, "post_id": 56144977, "comment_id": 98921990, "body": "Yes it opens the workbook and freezes it, and the white screen forever"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1557914063, "post_id": 56144977, "comment_id": 98922501, "body": "Perhaps if you first use <code>Application.EnableEvents = False</code>? Your problem description suggests that the act of opening the workbook is triggering some event handlers."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1557916123, "post_id": 56144977, "comment_id": 98923775, "body": "If you are trying to open an XLSM workbook, maybe some macros on that workbook cause an enternal loop with your Active Workbook. As suggested by@JohnColeman, try opening it disabling macros. <a href=\"https://stackoverflow.com/questions/16301530/open-a-workbook-from-vba-and-disable-workbook-open-code\" title=\"open a workbook from vba and disable workbook open code\">stackoverflow.com/questions/16301530/&hellip;</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10417531"}, "edited": false, "score": 0, "creation_date": 1557916909, "post_id": 56144977, "comment_id": 98924248, "body": "Your code should do what you expect, it&#39;s not wrong. Does opening other workbooks work ? Where is your macro located ? (Module1 or in Worksheet ?)"}], "owner": {"reputation": 309, "user_id": 9286924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2L7p4.jpg?s=128&g=1", "display_name": "anandhu", "link": "https://stackoverflow.com/users/9286924/anandhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557912888, "creation_date": 1557909594, "last_edit_date": 1557912888, "question_id": 56144977, "link": "https://stackoverflow.com/questions/56144977/open-excel-workbook-without-open-workbook", "title": "Open Excel workbook without open workbook", "body": "<p>I have a complicated workbook which hangs up, if I attempt to open it using Workbooks.Open().<br>\nBut this won't happen, when I directly open the file from my explorer by double clicking.</p>\n\n<p>Is there some way I can open the file through VBA in same way as opening it by double clicking?</p>\n\n<p>After opening the workbook should be accessible using the below code:</p>\n\n<pre><code>workbookName=\"C:\\abc.xlsm\"\nfor each wb in workbooks \n    if(wb.name=workbookName)\n        Myworkbook=wb\n    end if\nnext\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1557909641, "creation_date": 1557909641, "answer_id": 56144991, "question_id": 56144685, "link": "https://stackoverflow.com/questions/56144685/copy-columns-based-on-the-autofiltered-column-then-paste-value-only-to-that-aut/56144991#56144991", "title": "Copy columns based on the autofiltered column, then paste value only to that autofiltered column", "body": "<p>Copy/paste in a filtered table is no good idea, because it inserts data continously even in hidden rows and messes up your data.</p>\n\n<p>I recommend the following:</p>\n\n<ul>\n<li>Filter data</li>\n<li>Loop through all visible cells and copy the data row by row</li>\n</ul>\n\n<p>If the following data is given \u2026</p>\n\n<p><a href=\"https://i.stack.imgur.com/IzPJa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IzPJa.png\" alt=\"enter image description here\"></a></p>\n\n<p>\u2026 and you want to replace <code>unkown</code> with the data in column L, you can do the following:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub FilterAndCopy()\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Tabelle1\")\n\n    'Filter data\n    ws.Range(\"B:B\").AutoFilter Field:=1, Criteria1:=\"Unknown\", Operator:=xlFilterValues\n\n    Dim LastRow As Long\n    LastRow = ws.Cells(ws.Rows.Count, \"B\").End(xlUp).Row\n\n    Dim DestinationRange As Range\n    On Error Resume Next 'next line throws error if filter returns no data rows\n    Set DestinationRange = ws.Range(\"B2\", \"B\" &amp; LastRow).SpecialCells(xlCellTypeVisible) 'find visible cells between B2 (exclude header) and last row in B\n    On Error GoTo 0 'always re-activate error reporting!\n\n    If Not DestinationRange Is Nothing Then 'do it only if there is visible data\n        Dim Cell As Range\n        For Each Cell In DestinationRange 'copy each value row wise\n            Cell.Value = Cell.Offset(ColumnOffset:=10).Value 'column L is 10 columns right of B\n        Next Cell\n    End If\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/K7gqk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/K7gqk.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "is_accepted": false, "score": 0, "last_activity_date": 1557987413, "last_edit_date": 1557987413, "creation_date": 1557910257, "answer_id": 56145187, "question_id": 56144685, "link": "https://stackoverflow.com/questions/56144685/copy-columns-based-on-the-autofiltered-column-then-paste-value-only-to-that-aut/56145187#56145187", "title": "Copy columns based on the autofiltered column, then paste value only to that autofiltered column", "body": "<p>Alternative solution - simply go through each cell in column B and replace \"Unknown\" with a respective value in column L.</p>\n\n<pre><code>Sub foo()\n    Dim lngLastRow          As Long\n    Dim rngCell             As Range\n\n    With Sheet1\n        LastRow = .Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n        For Each rngCell In .Range(\"B1:B\" &amp; LastRow)\n            If rngCell.Value = \"Unknown\" Then\n                rngCell.Value = .Range(\"L\" &amp; rngCell.Row).Value\n            End If\n        Next rngCell\n    End With\nEnd Sub\n</code></pre>\n\n<p>P.S. Make sure to replace <code>With Sheet1</code> statement with a relevant sheet name/code.</p>\n"}], "owner": {"reputation": 149, "user_id": 9900837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4dfe88bda4124ecb650d5845e758757?s=128&d=identicon&r=PG&f=1", "display_name": "Winnie-c", "link": "https://stackoverflow.com/users/9900837/winnie-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1557987413, "creation_date": 1557908587, "last_edit_date": 1557910147, "question_id": 56144685, "link": "https://stackoverflow.com/questions/56144685/copy-columns-based-on-the-autofiltered-column-then-paste-value-only-to-that-aut", "title": "Copy columns based on the autofiltered column, then paste value only to that autofiltered column", "body": "<p>I want to filter column B based on values like \"Unknown\", then filter L column to have un-null values. copy the L column. \nPaste values only to the column B.</p>\n\n<pre><code>Before:\nColumnB ..... Column L\n1 ..... a\n2 ..... b\nUnknown.c\n3.......d\nUnknown.e\nUnknown.\n\nAfter\n1 ..... a\n2 ..... b\nc.......c\n3.......d\ne.......e\nUnknown..\n</code></pre>\n\n<pre><code>    Set r1 = Range(\"B:B\").SpecialCells(xlCellTypeVisible)\n    Set r2 = Range(\"L:L\").SpecialCells(xlCellTypeVisible)\n    Set myMultipleRange = Union(r1, r2)\n    Application.ScreenUpdating = False\n    sh1.Range(\"B:L\").AutoFilter\n    sh1.Range(\"B:B\").AutoFilter Field:=1, Criteria1:=\"Unknown\", Operator:=xlFilterValues\n\n    sh1.Range(\"L:L\").AutoFilter Field:=11, Operator:=xlFilterValues, Criteria1:=\"&lt;&gt;\"\n\n    LstRw = sh1.AutoFilter.Range.Columns(1).SpecialCells(xlCellTypeVisible).Cells.Count - 1\n    If LstRw &lt;&gt; 0 Then\n        myMultipleRange.FillLeft\n    End If\n\n</code></pre>\n\n<p>The above code will copy and paste including the format. </p>\n"}, {"tags": ["excel", "vba", "ms-project"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1557906740, "post_id": 56144122, "comment_id": 98918361, "body": "Instead of <code>Application.Run</code> try <code>xlApp.Run (&quot;&#39;Open_Yard_Scheduling_tool_V8.xlsm&#39;!formulcopy&quot;)</code>"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1557906747, "post_id": 56144122, "comment_id": 98918365, "body": "Put the macro into the workbook project under the <code>Workbook_Open</code> Event"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1557906844, "post_id": 56144122, "comment_id": 98918417, "body": "@Damian This will also trigger the macro if the workbook is opened normally by hand which might not be the desired action."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1557906929, "post_id": 56144122, "comment_id": 98918471, "body": "@P\u1d07\u029c I know, shouldn&#39;t he write the <code>formulcopy</code> directly to the workbook containing the code? Not the target file."}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1557907303, "creation_date": 1557907303, "answer_id": 56144312, "question_id": 56144122, "link": "https://stackoverflow.com/questions/56144122/open-an-existing-excel-file-and-run-a-macro-in-that-file-through-ms-project/56144312#56144312", "title": "Open an existing Excel file and run a macro in that file through MS Project", "body": "<p>The issue here is that <code>Application.Run</code> refers to the MS Project application but you try to run code in the Excel application. Therefore you need to use <code>xlApp.Run</code> instead (which refers to the Excel applictation that you created with <code>Set xlApp = CreateObject(\"Excel.Application\")</code>:</p>\n\n<pre><code>xlApp.Run(\"'Open_Yard_Scheduling_tool_V8.xlsm'!formulcopy\")\n</code></pre>\n\n<p><em>Note that the full path is not needed here.</em></p>\n"}], "owner": {"reputation": 3, "user_id": 8526900, "user_type": "registered", "profile_image": "https://graph.facebook.com/1588182511251913/picture?type=large", "display_name": "Hemil Dhruv", "link": "https://stackoverflow.com/users/8526900/hemil-dhruv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 284, "favorite_count": 0, "accepted_answer_id": 56144312, "answer_count": 1, "score": 0, "last_activity_date": 1557907456, "creation_date": 1557906579, "last_edit_date": 1557907456, "question_id": 56144122, "link": "https://stackoverflow.com/questions/56144122/open-an-existing-excel-file-and-run-a-macro-in-that-file-through-ms-project", "title": "Open an existing Excel file and run a macro in that file through MS Project", "body": "<p>I want to open an Excel file named <code>Open_Yard_Scheduling_tool_V8.xlsm</code>, run a macro in the same Excel file named <code>formulcopy</code> and then copy the data from the Excel file and paste into MS Project file by writing a code in VBA in MS Project application.</p>\n\n<p>I am able to open the Excel file and copy its data and paste it into the required project file but I'm not able to run the macro file in Excel through VBA in MS Project. </p>\n\n<p>I am using the code mentioned below.</p>\n\n<pre><code>Sub ex_mac()   \n    Dim xlApp As Object\n    Dim xlWkb As Object\n\n    Set xlApp = CreateObject(\"Excel.Application\")\n    Set xlWkb = xlApp.Workbooks.Open(\"C:\\Users\\DHRUV.HEMIL.MANOJ\\Documents\\Open_Yard_Scheduling_tool_V8.xlsm\")\n\n    xlApp.Visible = True\n\n    Application.Run (\"'C:\\Users\\DHRUV.HEMIL.MANOJ\\Documents\\Open_Yard_Scheduling_tool_V8.xlsm'!formulcopy\") \nEnd Sub\n</code></pre>\n\n<p>It is only opening the required Excel file but it is not able to run the macro in the same Excel file.</p>\n"}, {"tags": ["excel", "vba", "excel-formula", "sum"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1557905576, "post_id": 56143773, "comment_id": 98917734, "body": "Note that row/column counting variables should be of type <code>Long</code> Excel has more rows than <code>Integer</code> can handle."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1557905603, "post_id": 56143773, "comment_id": 98917747, "body": "You have a large number of range objects (Range, Cells, Rows) which do not specify a wb &amp; ws. This is bound to raise errors sooner than later. Also, read on <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">how to avoid Activate and Select</a>"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1557906023, "post_id": 56143773, "comment_id": 98917987, "body": "<code>R = row</code> <code>C = Column</code> <code>R6 = Row 6</code> <code>RC1 = Row where you are inserting the formula and column 1</code>. Thought there is a builtin formula on excel called <code>SUBTOTAL</code> that allows you to do that."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1557906083, "post_id": 56143773, "comment_id": 98918022, "body": "Doesn&#39;t  <code>.Formula</code> need to be <code>.FormulaR1C1</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 74, "user_id": 11334657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30a1d1e108366422e8078b0e0bdd9859?s=128&d=identicon&r=PG&f=1", "display_name": "Flaw98", "link": "https://stackoverflow.com/users/11334657/flaw98"}, "is_accepted": true, "score": 1, "last_activity_date": 1557907097, "last_edit_date": 1557907097, "creation_date": 1557905793, "answer_id": 56143913, "question_id": 56143773, "link": "https://stackoverflow.com/questions/56143773/understanding-a-sum-formula-as-a-subtotal-within-a-for-loop/56143913#56143913", "title": "Understanding a sum formula as a subtotal within a for loop", "body": "<p>Hope I did understood what you are trying to ask. First of all you are initializing two variables, in your case i and j that are going to help you iterate through the cells.</p>\n\n<p>i and j will replace in the sum formula the first, second, third and so on <strong>row</strong> and <strong>column</strong>. So, instead of <code>=SUM(R\" &amp; j &amp; \"C:R\" &amp; i &amp; \"C)</code> you will have <code>=SUM(R1 &amp; \"C:R\" &amp; 4C)</code>.</p>\n\n<p>The difference in between A1 and R1C1 is the way you look at it and reference to it. Using R1C1 notation can help you to iterate easier through the cells. Going to the next cell (to the right) to A1 will be something like: R1C2.</p>\n"}], "owner": {"reputation": 173, "user_id": 7898021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2f50f9ecf7be9e75eabfa654b688fbe?s=128&d=identicon&r=PG&f=1", "display_name": "M. Salem", "link": "https://stackoverflow.com/users/7898021/m-salem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 56143913, "answer_count": 1, "score": 0, "last_activity_date": 1586261736, "creation_date": 1557905267, "last_edit_date": 1557919879, "question_id": 56143773, "link": "https://stackoverflow.com/questions/56143773/understanding-a-sum-formula-as-a-subtotal-within-a-for-loop", "title": "Understanding a sum formula as a subtotal within a for loop", "body": "<p>I found a Code which creates a subtotal within a table. The Formula works fine, but I do not understand the Syntax of the sum Formula for the subtotal, which is:</p>\n\n<pre><code>\"=SUM(R\" &amp; j &amp; \"C:R\" &amp; i &amp; \"C)\"\n</code></pre>\n\n<p>What is meant with <code>R</code>, <code>C:R</code> and <code>C</code>? Can anybody please translate how the respective Output, for example <code>=SUMME(E$4:E$4)</code> corresponds to this formula?</p>\n\n<p>This is the subtotal output Excel function:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Y85C2.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Y85C2.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The Code is as follows:</p>\n\n<pre><code>Dim iCol As Integer \nDim i As Integer 'Makro f?ngt ab diese Zeilenummer an\nDim j As Integer 'Makro geht mit diese Zeilenummer im Loop weiter\n\nWorksheets(\"Italy\").Activate\n\nApplication.ScreenUpdating = False\ni = 4 'Makro f?ngt ab diese Zeilenummer ab\nj = i\n\n'Loops throught Col B Checking for match then when there is no match add Sum\nDo While Range(\"A\" &amp; i) &lt;&gt; \"\"\n    If Range(\"A\" &amp; i) &lt;&gt; Range(\"A\" &amp; (i + 1)) Then\n        Rows(i + 1).Insert\n        Range(\"A\" &amp; (i + 1)) = \"Subtotal \" &amp; Range(\"A\" &amp; i).Value\n        For iCol = 5 To 11 'Columns to Sum\n            Cells(i + 1, iCol).Formula = \"=SUM(R\" &amp; j &amp; \"C:R\" &amp; i &amp; \"C)\"\n        Next iCol\n        Range(Cells(i + 1, 1), Cells(i + 1, 10)).Font.Bold = True\n        Range(Cells(i + 1, 1), Cells(i + 1, 10)).Interior.Color = RGB(221, 237, 245)\n        i = i + 2\n        j = i\n    Else\n        i = i + 1\n    End If\nLoop\nApplication.ScreenUpdating = True\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1557908335, "post_id": 56143540, "comment_id": 98919211, "body": "The error is self explanatory. A <code>Worksheet</code> does not have a method called <code>Find</code>."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1557908686, "post_id": 56143540, "comment_id": 98919397, "body": "Why are you looping within another loop? The second loop has no use at all"}, {"owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 0, "creation_date": 1557908742, "post_id": 56143540, "comment_id": 98919429, "body": "<code>ThisWorkbook.Sheets(&quot;VNF Placement&quot;).Find(Cells(i, 105), xlValues)</code> is not an assertion, it returns a range or nothing"}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 8223922, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cccbbabb82ae62e2fe98ee51df6319e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ninja", "link": "https://stackoverflow.com/users/8223922/ninja"}, "edited": false, "score": 0, "creation_date": 1557908006, "post_id": 56143628, "comment_id": 98919048, "body": "Please see above I have written the complete code. In one of the versions of my project it is working fine. But not in this sheet."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 105, "user_id": 8223922, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cccbbabb82ae62e2fe98ee51df6319e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ninja", "link": "https://stackoverflow.com/users/8223922/ninja"}, "edited": false, "score": 1, "creation_date": 1557914352, "post_id": 56143628, "comment_id": 98922672, "body": "@Ninja Your code could not work in any version of a project. A <code>Worksheet</code> does not have a method called <code>Find</code>, you cannot change that. The code you have in the question will never work."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 105, "user_id": 8223922, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cccbbabb82ae62e2fe98ee51df6319e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ninja", "link": "https://stackoverflow.com/users/8223922/ninja"}, "edited": false, "score": 0, "creation_date": 1557915354, "post_id": 56143628, "comment_id": 98923293, "body": "@Ninja glad you got it working! If my answer helped you, please accept it :)"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 1, "creation_date": 1557915588, "post_id": 56143628, "comment_id": 98923425, "body": "In that case you could answer your own question for future reference, but that&#39;s entirely optional"}], "tags": [], "owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "is_accepted": false, "score": 2, "last_activity_date": 1557910135, "last_edit_date": 1557910135, "creation_date": 1557904716, "answer_id": 56143628, "question_id": 56143540, "link": "https://stackoverflow.com/questions/56143540/find-function-in-vba-object-does-not-support-this-property-or-method/56143628#56143628", "title": "FIND function in VBA - Object does not support this property or Method", "body": "<p>You shouldn't use <code>Like</code>, that's to compare values. <code>Find</code> is a Range object that returns the range of the found value. Plus, you need to specify a range for Find to look in.</p>\n\n<p>For example:</p>\n\n<pre><code>Dim rslt As Range, i As Long, lrow As Long\n\nWith ThisWorkbook.Sheets(\"VNF Placement\")\n\n    lrow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n    For i = 2 To lrow\n        Set rslt = .Range(\"A:A\").Find(.Cells(i, 105), Lookat:=xlPart)\n        If not rslt Is Nothing Then \n            MsgBox \"The address of '\" &amp; .Cells(i, 105).Value &amp; \"' is '\" &amp; rslt.Address &amp; \"'\", vbInformation\n        End If\n    Next\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 8223922, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cccbbabb82ae62e2fe98ee51df6319e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ninja", "link": "https://stackoverflow.com/users/8223922/ninja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557910135, "creation_date": 1557904288, "last_edit_date": 1557908194, "question_id": 56143540, "link": "https://stackoverflow.com/questions/56143540/find-function-in-vba-object-does-not-support-this-property-or-method", "title": "FIND function in VBA - Object does not support this property or Method", "body": "<p>Unable to run FIND function in one sheet.</p>\n\n<p>I want to find some cell value the selected range and color it.<br>\nI am getting error as</p>\n\n<blockquote>\n  <p>Object doesn't support this property or method</p>\n</blockquote>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub coloring()\n    ThisWorkbook.Sheets(\"VNF Placement\").Activate\n\n    Dim rg As Range\n\n    Set rg = ThisWorkbook.Sheets(\"VNF Placement\").Range(\"B11:CV500\")\n    lrow = ThisWorkbook.Sheets(\"VNF Placement\").Cells(Rows.count, 105).End(xlUp).Row\n\n    g = 3   'colour index\n    i = 1\n\n    For i = 2 To lrow\n       For Each c In rg\n           If ThisWorkbook.Sheets(\"VNF Placement\").Find(Cells(i, 105), xlValues) Then\n               c.Interior.ColorIndex = g\n           End If\n       Next\n\n       g = g + 1\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1557903379, "post_id": 56143301, "comment_id": 98916664, "body": "If you just want to extract some data of the CSV, I would have a look at <a href=\"https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\">Regular Expressions</a> and process the CSV as text file with a RegEx instead of importing the whole file into Excel."}, {"owner": {"reputation": 113, "user_id": 10904582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2944732016e320662ac914dab5f66b5d?s=128&d=identicon&r=PG&f=1", "display_name": "j.doe", "link": "https://stackoverflow.com/users/10904582/j-doe"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1557903564, "post_id": 56143301, "comment_id": 98916765, "body": "@P\u1d07\u029c could suggest a solution code? or how could i incorporate multiple strings for this code?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1557904010, "post_id": 56143301, "comment_id": 98916948, "body": "Actually that would be to much for this question. But I posted a solution that extends your code below."}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1557904390, "last_edit_date": 1557904390, "creation_date": 1557903977, "answer_id": 56143463, "question_id": 56143301, "link": "https://stackoverflow.com/questions/56143301/keep-multiple-strings-and-delete-the-other-data/56143463#56143463", "title": "Keep multiple strings and delete the other data", "body": "<p>You need to define a list of keywords to keep <code>KeywordsToKeep = Array(\"Event Magnitude: \", \"Trigger Date:\")</code> and then check in another loop each keyword</p>\n\n<pre><code>Option Explicit\n\nPublic Sub DeleteNotMIS()\n    Dim LastRow As Long\n    LastRow = Cells(Rows.Count, 1).End(xlUp).Row\n\n    Dim KeywordsToKeep() As Variant\n    KeywordsToKeep = Array(\"Event Magnitude: \", \"Trigger Date:\")  'Add other keywords here\n\n    Dim iRow As Long, eKey As Variant, FoundKey As Boolean\n    For iRow = LastRow To 2 Step -1\n        FoundKey = False 'initialize\n        For Each eKey In KeywordsToKeep\n            If InStr(Cells(iRow, 1), eKey) &lt;&gt; 0 Then \n                FoundKey = True\n                Exit For 'we don't need to check further keys if we already found one.\n            End If\n        Next eKey\n        If Not FoundKey Then Rows(iRow).Delete\n    Next iRow \nEnd Sub\n</code></pre>\n\n<p><strong>If each keyword can occur only once in the CSV file \u2026</strong><br>\nthis approach is slow, because it has to check <strong>every</strong> row (row by row). A faster approach then would be to use the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Excel.Range.Find\" rel=\"nofollow noreferrer\">Range.Find method</a> to find each keyword directly and extract/copy it to a new sheet.</p>\n"}], "owner": {"reputation": 113, "user_id": 10904582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2944732016e320662ac914dab5f66b5d?s=128&d=identicon&r=PG&f=1", "display_name": "j.doe", "link": "https://stackoverflow.com/users/10904582/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 56143463, "answer_count": 1, "score": 2, "last_activity_date": 1557904390, "creation_date": 1557903198, "last_edit_date": 1557903262, "question_id": 56143301, "link": "https://stackoverflow.com/questions/56143301/keep-multiple-strings-and-delete-the-other-data", "title": "Keep multiple strings and delete the other data", "body": "<p>I am facing a minor issue, basically I have successfully done the macro process for one string. But I am unable to process the same vba macro for keeping multiple strings and delete the unwanted data present in the CSV file.</p>\n\n<p>Currently the below code only keeps the rows with string <code>Event Magnitude:</code> and deletes the rest. </p>\n\n<p>However I want to add multiple strings like <code>Event Duration:</code>,<br>\n<code>Trigger Date:</code>, <code>Trigger Time:</code> in the same macro and I am unsure how to do it.</p>\n\n<p>IF I can add multiple strings this macro will check for all 4 strings and keep that data and delete the rest of the data.</p>\n\n<pre><code>Sub DeleteNotMIS()\n    Dim r As Long, lr As Long\n    lr = Cells(Rows.Count, 1).End(xlUp).Row\n    For r = lr To 2 Step -1\n        If InStr(Cells(r, 1), \"Event Magnitude: \") = 0 Then Rows(r).Delete\n    Next r\n End Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/bO9tV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bO9tV.png\" alt=\"Sample CSV\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1557902874, "post_id": 56143175, "comment_id": 98916407, "body": "If I were you, I would use three separate textboxes, for dd, mm, and yyyy"}, {"owner": {"reputation": 51, "user_id": 9864567, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rithwik Sarma", "link": "https://stackoverflow.com/users/9864567/rithwik-sarma"}, "reply_to_user": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1557902952, "post_id": 56143175, "comment_id": 98916455, "body": "@TimStack have 6 date time pickers!"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 1, "creation_date": 1557903376, "post_id": 56143175, "comment_id": 98916662, "body": "I don&#39;t follow. Where does the GET DETAILS button retrieve its information from? And what do you mean with &quot;<i>I cannot retrieve date e.g 12/12/2019 on datepicker</i>&quot;?"}, {"owner": {"reputation": 374, "user_id": 11333965, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kX6ChNKPbZQ/AAAAAAAAAAI/AAAAAAAAAEU/Z5ZFx29rLzI/photo.jpg?sz=128", "display_name": "erazorv4", "link": "https://stackoverflow.com/users/11333965/erazorv4"}, "edited": false, "score": 0, "creation_date": 1557904492, "post_id": 56143175, "comment_id": 98917168, "body": "Please include some of your code in the question so we help you more easily."}], "owner": {"reputation": 51, "user_id": 9864567, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rithwik Sarma", "link": "https://stackoverflow.com/users/9864567/rithwik-sarma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557906474, "creation_date": 1557902712, "last_edit_date": 1557906474, "question_id": 56143175, "link": "https://stackoverflow.com/questions/56143175/restrict-textbox-in-userform-to-accept-date-in-mm-dd-yy-format", "title": "Restrict textbox in userform to accept date in mm/dd/yy format", "body": "<p><a href=\"https://i.stack.imgur.com/wNlus.png\" rel=\"nofollow noreferrer\">MY FORM</a>I have userform which takes in date e.g <code>12/12/2019</code>, Request ID (unique key) and some other fields from the user and as the user clicks the \"ADD\" button, the entry gets saved in the Excel file. I have used DatePicker to accept dates from the user. </p>\n\n<p>The entries get stored as strings in the file.\nThe add button works fine.</p>\n\n<p>Also, it has another button, \"GET DETAILS\" which retrieves the entry DIRECTLY ON THE FORM based on the \"request ID\".</p>\n\n<p>The problem I am facing is when I want to retrieve entry with request ID e.g 12201 then all the fields, except the date are retrieved and displayed in the textboxes but since date is entered using DatePicker, I cannot retrieve date e.g <code>12/12/2019</code> on datepicker. </p>\n\n<p>I am thinking to replace datepicker with textbox to accept user input date but then have to restrict the user to enter date in <code>MM/DD/YYYY</code> to maintain uniformity and prevent any errors</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1557900936, "post_id": 56142670, "comment_id": 98915533, "body": "Could it be any of your procedures did a <code>Application.EnableEvents = False</code> ? If that is the case, no events will be fired."}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1557901673, "post_id": 56142670, "comment_id": 98915841, "body": "@Damian Nope none at all. Also the odd thing is that some events work with no problem but these 2 don&#39;t work. Even another worksheet that uses the same event and code, works when I press that worksheet"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1557901837, "post_id": 56142670, "comment_id": 98915903, "body": "Try <code>ActiveSheet</code> instead <code>ThisWorkbook.Worksheets(&quot;Pay-MR&quot;)</code> and see if it works?"}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1557902241, "post_id": 56142670, "comment_id": 98916074, "body": "@Damian No improvement upon changing it. I believe the code inside is working it&#39;s the event which is not firing since if I step through the code, it works. The event is highlighted when I step through it and it works with no issue. But simply activating the worksheet does not fire it"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1557902311, "post_id": 56142670, "comment_id": 98916106, "body": "Try to add a line <code>MsgBox &quot;This is working&quot;</code> to see if it does."}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1557902376, "post_id": 56142670, "comment_id": 98916149, "body": "Oh it works. That&#39;s odd but when I step the code, it protects but doesn&#39;t when event fired. So event does work, but the code inside doesn&#39;t work when event is fired, but works when stepped through"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1557902438, "post_id": 56142670, "comment_id": 98916187, "body": "If it works, the event is firing, so the problem is on the code. Now you have your lead :)"}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1557902498, "post_id": 56142670, "comment_id": 98916208, "body": "What&#39;s wrong with it though? It works when I step through or press the run module. It&#39;s like working and not working??"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1557902924, "post_id": 56142670, "comment_id": 98916436, "body": "It is working for me... I can&#39;t tell what is wrong, could be some configuration, try it out on a clean new workbook. If it does... I&#39;d consider to move all your stuff to the new workbook."}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1557902944, "post_id": 56142670, "comment_id": 98916449, "body": "Try to use <code>Sheets()</code> instead of <code>Worksheets()</code>"}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "reply_to_user": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1557903065, "post_id": 56142670, "comment_id": 98916509, "body": "@Rawrplus You mean <code>ThisWorkbook.Sheets(&quot;DTR-MR&quot;).Protect</code>? It doesn&#39;t work as well"}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1557903105, "post_id": 56142670, "comment_id": 98916532, "body": "Yeah I did,. But that&#39;s odd, because it should work. Are you sure you&#39;re checking for what you have to / understand when <code>Worksheet_Activate</code> is fired?"}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1557903160, "post_id": 56142670, "comment_id": 98916563, "body": "Yes pretty sure cause when I run module or step through the sheet gets locked. But otherwise, it&#39;s still unlocked. Might as well just transfer everything to a new workbook as suggested. But will have to recreate the tables and all. Odd thing about VBA there are times it works for a long time then suddenly gives out. Trying out codes such as <code>ThisWorkbook.Worksheets(&quot;Pay-MR&quot;).Cells(10, 10) = &quot;Hello&quot;</code> works in the event activation so probably something to do with the protect. Even a simple <code>ThisWorkbook.Sheets(&quot;Pay-MR&quot;).Protect</code> is completely bugged out in the event"}], "owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557900402, "creation_date": 1557900402, "question_id": 56142670, "link": "https://stackoverflow.com/questions/56142670/worksheet-activate-event-is-not-firing-despite-other-events-working", "title": "Worksheet activate event is not firing despite other events working", "body": "<p>I have this code in a worksheet named \"DTR-MR\" and I have a <code>Worksheet Activate</code> event that dose not fire if I switch to the worksheet like it should. The code is:</p>\n\n<pre><code>Option Explicit\nPrivate Sub Worksheet_Activate()\n    ThisWorkbook.Worksheets(\"DTR-MR\").Protect DrawingObjects:=True, Contents:=True, Scenarios:=True, Password:=\"stamping123123123\"\nEnd Sub\n</code></pre>\n\n<p>Similarly, another worksheet that locks the worksheet on activation also doesn't activate as shown below:</p>\n\n<pre><code>Option Explicit\nPrivate Sub Worksheet_Activate()\n    ThisWorkbook.Worksheets(\"Pay-MR\").Protect DrawingObjects:=True, Contents:=True, Scenarios:=True, Password:=\"stamping123123123\"\nEnd Sub\n</code></pre>\n\n<p>However, other <code>Worksheet Activate</code> events in the worksheet fire the code inside with no problem. The code inside the bugged events works because if I manually run the code, or step through the code (F8) the worksheet is locked.</p>\n"}, {"tags": ["html", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1557912794, "post_id": 56141758, "comment_id": 98921722, "body": "Please don&#39;t post pictures of html. Use the snippet tool via <a href=\"https://stackoverflow.com/posts/56141758/edit\">edit</a> to insert html"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 11472953, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Y2e9Q9pa3UA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd8Cy0rgqYuo5pxwLSqTG4dlAeYTA/mo/photo.jpg?sz=128", "display_name": "Chum Ba", "link": "https://stackoverflow.com/users/11472953/chum-ba"}, "edited": false, "score": 0, "creation_date": 1557926278, "post_id": 56146005, "comment_id": 98929999, "body": "Sorry about the link. I didn&#39;t know how to do it properly since I&#39;m new to this. You were correct. The page did have an iframe. Sorry for not mentioning this as I did not know at the time what an iframe was but with more reading I was able to access it by following posts that you also commented in (<a href=\"https://stackoverflow.com/questions/44902558/accessing-object-in-iframe-using-vba\" title=\"accessing object in iframe using vba\">stackoverflow.com/questions/44902558/&hellip;</a>) (<a href=\"https://stackoverflow.com/questions/53951031/access-elements-inside-iframe-using-vba\" title=\"access elements inside iframe using vba\">stackoverflow.com/questions/53951031/&hellip;</a>). Thank you for being so helpful!"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1557912712, "creation_date": 1557912712, "answer_id": 56146005, "question_id": 56141758, "link": "https://stackoverflow.com/questions/56141758/vba-cant-access-nested-span-element-in-html/56146005#56146005", "title": "VBA can&#39;t access nested span element in HTML", "body": "<p>Just use the id (unless there is a parent iframe/frame)</p>\n\n<pre><code>ie.document.getElementById(\"revit_form_ComboButton_0_label\")\n</code></pre>\n\n<p>or</p>\n\n<pre><code>ie.document.querySelector(\"#revit_form_ComboButton_0_label\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 49, "user_id": 11472953, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Y2e9Q9pa3UA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd8Cy0rgqYuo5pxwLSqTG4dlAeYTA/mo/photo.jpg?sz=128", "display_name": "Chum Ba", "link": "https://stackoverflow.com/users/11472953/chum-ba"}, "is_accepted": false, "score": 1, "last_activity_date": 1557926454, "creation_date": 1557926454, "answer_id": 56150438, "question_id": 56141758, "link": "https://stackoverflow.com/questions/56141758/vba-cant-access-nested-span-element-in-html/56150438#56150438", "title": "VBA can&#39;t access nested span element in HTML", "body": "<p>This is the code I used to access the button on the iframe.</p>\n\n<pre><code>    Dim HTMLDoc As MSHTML.HTMLDocument\n    Dim iframeDoc As MSHTML.HTMLDocument\n    Dim HTMLbutton As MSHTML.IHTMLElement\n\n    Set iframeDoc = HTMLDoc.frames(\"eZlmIFrame_iframe\").Document\n    Set HTMLbutton = iframeDoc.getElementById(\"revit_form_ComboButton_0_label\")\n    HTMLbutton.Click\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 11472953, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Y2e9Q9pa3UA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd8Cy0rgqYuo5pxwLSqTG4dlAeYTA/mo/photo.jpg?sz=128", "display_name": "Chum Ba", "link": "https://stackoverflow.com/users/11472953/chum-ba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1557926454, "creation_date": 1557894315, "last_edit_date": 1557912750, "question_id": 56141758, "link": "https://stackoverflow.com/questions/56141758/vba-cant-access-nested-span-element-in-html", "title": "VBA can&#39;t access nested span element in HTML", "body": "<p>I'm having issues with accessing a button with a span tag because it is nested within multiple tags. Here is a screenshot of the code with the highlighted portion that I'm trying to click on. [1]: <a href=\"https://imgur.com/a/e7Ya412\" rel=\"nofollow noreferrer\">https://imgur.com/a/e7Ya412</a> \"HTML code\"</p>\n\n<p>I've already tried getting all of the spans element by using elementcollection but it still cannot access the span element that I need.</p>\n\n<pre><code>Dim HTMLspans As MSHTML.IHTMLElementCollection\n\n   Set HTMLspans = HTMLDoc.getElementsByTagName(\"span\")\n     For Each HTMLspan In HTMLspans\n        Debug.Print HTMLspan.getAttribute(\"id\")\n</code></pre>\n\n<p>This code will show me some span elements but not all. I also tried using nested for loops to see if I can access it like this but it still doesn't work.</p>\n\n<pre><code>For Each HTMLtable In HTMLtables.getElementsByTagName(\"table\")\n For Each HTMLtbody In HTMLtable.getElementsByTagName(\"tbody\")\n  For Each HTMLtr In HTMLtbody.getElementsByTagName(\"tr\")\n   For Each HTMLtd In HTMLtr.getElementsByTagName(\"td\")\n    For Each HTMLspan In HTMLtd.getElementsByTagName(\"span\")\n          Debug.Print HTMLspan.getAttribute(\"id\")\n          Next HTMLspan\n       Next HTMLtd\n     Next HTMLtr\n    Next HTMLtbody\n   Next HTMLtable\n</code></pre>\n\n<p>This returns some span element but it doesn't show the one that I need. </p>\n\n<p>With the right code, I expect to access the span tag with the <code>id=\"revit_form_ComboButton_0_label\"</code>\n But I can't access it. Could this code be the one that's causing issues?</p>\n\n<pre><code>&lt;!--Portlet-Outlined Start--&gt;\n</code></pre>\n\n<p>I cannot access any tags under this code and it's unfortunate that the website I'm using is not public.</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11337431, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-slPR_Riu2y4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reniwMGX1UwCXUcUkCUamplDd144g/mo/photo.jpg?sz=128", "display_name": "Noah", "link": "https://stackoverflow.com/users/11337431/noah"}, "edited": false, "score": 0, "creation_date": 1557896364, "post_id": 56141717, "comment_id": 98913957, "body": "I see. Thank you so much!"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1557893974, "creation_date": 1557893974, "answer_id": 56141717, "question_id": 56141654, "link": "https://stackoverflow.com/questions/56141654/what-is-label-not-define-in-my-vba-code/56141717#56141717", "title": "What is &quot;Label Not define&quot; in my VBA code?", "body": "<p>The offending line isn't the <code>Sub</code> declaration, it's this line:</p>\n\n<blockquote>\n<pre><code>On Error GoTo ToolingNoID_AfterUpdate_Err\n</code></pre>\n</blockquote>\n\n<p>There is no <code>ToolingNoID_AfterUpdate_Err</code> label in your procedure. Remove the <code>On Error</code> statement, or add an error-handling subroutine at the end of the procedure:</p>\n\n<pre><code>    Exit Sub\nToolingNoID_AfterUpdate_Err:\n    MsgBox Err.Description, \"Unexpected Error\", vbExclamation\nEnd Sub\n</code></pre>\n\n<p>In VBA a \"line label\" is defined by an identifier followed by a colon, at the beginning of a line of code (and ideally, sitting on its own line):</p>\n\n<pre><code>LineLabel:\n</code></pre>\n\n<p>\"Label not defined\" is the compile error you get when an instruction is referring to a label that doesn't exist in that scope.</p>\n"}], "owner": {"reputation": 11, "user_id": 11337431, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-slPR_Riu2y4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reniwMGX1UwCXUcUkCUamplDd144g/mo/photo.jpg?sz=128", "display_name": "Noah", "link": "https://stackoverflow.com/users/11337431/noah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1878, "favorite_count": 0, "accepted_answer_id": 56141717, "answer_count": 1, "score": 0, "last_activity_date": 1594779396, "creation_date": 1557893440, "last_edit_date": 1594779396, "question_id": 56141654, "link": "https://stackoverflow.com/questions/56141654/what-is-label-not-define-in-my-vba-code", "title": "What is &quot;Label Not define&quot; in my VBA code?", "body": "<p>I have the VBA code in MS Access</p>\n\n<pre><code>Private Sub ToolingNoID_AfterUpdate()\nOn Error GoTo ToolingNoID_AfterUpdate_Err\n\nDim ToolingNoID As String\nToolingNoID = InputBox(\"Please enter Tooling No\", \"Enter Tooling No\")\n\nIf (IsNull(ToolingNoID)) Then\n    Exit Sub\n    Beep\n    MsgBox \"Please enter the tooling number.\", vbOKOnly, \"\"\n    DoCmd.CancelEvent\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>The offence line is </p>\n\n<pre><code>Private Sub ToolingNoID_AfterUpdate()\n</code></pre>\n\n<p>I really have no idea which part of my code should be changed to fufill the above condition. Anyone can help me on this?</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1557930772, "post_id": 56141414, "comment_id": 98933055, "body": "FWIW I set up a small document with three pages and some random text. I set it to use different odd/even headers and footers, with different content. I then ran <code>ActiveDocument.PageSetup.OddAndEvenPagesHeaderFooter = false</code> and got no error message - changing the property worked. Is there something different about the document(s) you tried running this on? Was a document open in Word when you ran it?"}], "owner": {"reputation": 11, "user_id": 11501715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16261be3cfec3f551aeea035cead8e64?s=128&d=identicon&r=PG&f=1", "display_name": "GrowlTiger", "link": "https://stackoverflow.com/users/11501715/growltiger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1557930633, "creation_date": 1557891349, "last_edit_date": 1557930633, "question_id": 56141414, "link": "https://stackoverflow.com/questions/56141414/toggle-the-different-odd-even-pages-checkbox-in-word", "title": "Toggle the &quot;Different Odd &amp; Even Pages&quot; checkbox in Word", "body": "<p>I'm setting up a set of \"boilerplate\" Word documents.\nAll the documents have different Footers for odd and even pages.\nThe Footers are left- and right-hand biased so that double sided printing will always show important information at the thumb edge of the page.\nThe document printing default is double sided, so the Header/Footer \"Different Odd &amp; Even Pages\" box is checked. </p>\n\n<p>However there will be times when a user will want to print single sided.\nThe box will need to be unchecked.</p>\n\n<p>Each document contains a UserForm to manage features (import external values for Document Variables etc.)\nI would like to control the \"Different Footer Odds &amp; Even Pages\" feature from the UserForm via a pair of Option Buttons.</p>\n\n<p>I've searched multiple site to no avail.</p>\n\n<p>The closest that I gotten is the sample code from the <code>OddAndEvenPagesHeaderFooter</code> Help topic: </p>\n\n<pre><code>Set myDoc = Documents(\"Document1\") \nmyDoc.PageSetup.OddAndEvenPagesHeaderFooter = True \nWith myDoc.Sections(1) \n    .Headers(wdHeaderFooterPrimary).Range _ \n    .InsertAfter \"Odd Header\" \n    .Headers(wdHeaderFooterEvenPages).Range _ \n    .InsertAfter \"Even Header\" \nEnd With\n</code></pre>\n\n<p>However I don't want to create footers. I just want to toggle the <code>PageSetup.OddAndEvenPagesHeaderFooter</code> between True and False</p>\n\n<p>I have tried this \"stripped down version:</p>\n\n<pre><code>'Set OddFootersOnly\nWith ActiveDocument.PageSetup\n    .OddAndEvenPagesHeaderFooter = False\nEnd With\n</code></pre>\n\n<p>I get the following Error Message</p>\n\n<blockquote>\n  <p>Run-time error: '4608': Value out of range</p>\n</blockquote>\n"}, {"tags": ["python", "vba", "powershell", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 1216, "user_id": 2242761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dde25d431468b980cd1930747112c6f1?s=128&d=identicon&r=PG", "display_name": "Dilshad Abduwali", "link": "https://stackoverflow.com/users/2242761/dilshad-abduwali"}, "edited": false, "score": 0, "creation_date": 1557893159, "post_id": 56141494, "comment_id": 98913202, "body": "as soon as it hits the shell line cmd windows closes, unfortunately"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 1216, "user_id": 2242761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dde25d431468b980cd1930747112c6f1?s=128&d=identicon&r=PG", "display_name": "Dilshad Abduwali", "link": "https://stackoverflow.com/users/2242761/dilshad-abduwali"}, "edited": false, "score": 0, "creation_date": 1557894401, "post_id": 56141494, "comment_id": 98913469, "body": "<a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/shell-constants\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/language/reference/&hellip;</a>"}, {"owner": {"reputation": 4118, "user_id": 10316640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/989bf10b54e525330bc9631e0be9e620?s=128&d=identicon&r=PG&f=1", "display_name": "Strom", "link": "https://stackoverflow.com/users/10316640/strom"}, "reply_to_user": {"reputation": 1216, "user_id": 2242761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dde25d431468b980cd1930747112c6f1?s=128&d=identicon&r=PG", "display_name": "Dilshad Abduwali", "link": "https://stackoverflow.com/users/2242761/dilshad-abduwali"}, "edited": false, "score": 2, "creation_date": 1557896819, "post_id": 56141494, "comment_id": 98914083, "body": "@DilshadAbduwali, Unless your Python program waits on user input, the expected behavior is that it runs and then immediately closes.  To see any output use <code>Shell &quot;cmd &#47;k C:\\Python37\\python.exe C:\\scripts\\get_people.py&quot;,vbmaximizedfocus</code>"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1559184383, "last_edit_date": 1559184383, "creation_date": 1557892084, "answer_id": 56141494, "question_id": 56141399, "link": "https://stackoverflow.com/questions/56141399/running-python-or-powershell-in-vba-outlook/56141494#56141494", "title": "Running Python or PowerShell in VBA Outlook", "body": "<p>How about the following?</p>\n\n<pre><code>Option Explicit\nPublic Sub Example()\n    Shell \"cmd /k C:\\Python37\\python.exe C:\\scripts\\get_people.py\", vbmaximizedfocus \nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1216, "user_id": 2242761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dde25d431468b980cd1930747112c6f1?s=128&d=identicon&r=PG", "display_name": "Dilshad Abduwali", "link": "https://stackoverflow.com/users/2242761/dilshad-abduwali"}, "edited": false, "score": 0, "creation_date": 1557922529, "post_id": 56146926, "comment_id": 98927530, "body": "any standard cmd commands, like &#39;dir&#39;, works fine, but when I embed python.exe that runs a script is failing as soon as it hits the python line."}, {"owner": {"reputation": 464, "user_id": 6187538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cacb5a0481aaf812460831543f68b64?s=128&d=identicon&r=PG&f=1", "display_name": "dodell", "link": "https://stackoverflow.com/users/6187538/dodell"}, "reply_to_user": {"reputation": 1216, "user_id": 2242761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dde25d431468b980cd1930747112c6f1?s=128&d=identicon&r=PG", "display_name": "Dilshad Abduwali", "link": "https://stackoverflow.com/users/2242761/dilshad-abduwali"}, "edited": false, "score": 0, "creation_date": 1557925390, "post_id": 56146926, "comment_id": 98929412, "body": "Does the <i>batch</i> file work with the python.exe call?"}, {"owner": {"reputation": 1216, "user_id": 2242761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dde25d431468b980cd1930747112c6f1?s=128&d=identicon&r=PG", "display_name": "Dilshad Abduwali", "link": "https://stackoverflow.com/users/2242761/dilshad-abduwali"}, "edited": false, "score": 0, "creation_date": 1558040269, "post_id": 56146926, "comment_id": 98979540, "body": "batch script works fine with python call. not when called within VBA"}], "tags": [], "owner": {"reputation": 464, "user_id": 6187538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cacb5a0481aaf812460831543f68b64?s=128&d=identicon&r=PG&f=1", "display_name": "dodell", "link": "https://stackoverflow.com/users/6187538/dodell"}, "is_accepted": false, "score": 0, "last_activity_date": 1557915455, "creation_date": 1557915455, "answer_id": 56146926, "question_id": 56141399, "link": "https://stackoverflow.com/questions/56141399/running-python-or-powershell-in-vba-outlook/56146926#56146926", "title": "Running Python or PowerShell in VBA Outlook", "body": "<p>I created code very similar to your initial case and it worked for me. Try putting a 'pause' at the end of the batch file.</p>\n\n<p><strong>trybat.bat</strong></p>\n\n<pre><code>@echo off\necho \"hello world\"\npause\n</code></pre>\n\n<p><strong>VBA code</strong></p>\n\n<pre><code>Sub Test()\n\n  Dim wsh As Object\n  Dim waitOnReturn As Boolean: waitOnReturn = True\n  Dim windowStyle As Integer: windowStyle = 1\n\n  Set wsh = VBA.CreateObject(\"WScript.Shell\")\n\n  wsh.Run \"C:\\testdir\\trybat.bat\", windowStyle, waitOnReturn\n  MsgBox \"ran\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1216, "user_id": 2242761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dde25d431468b980cd1930747112c6f1?s=128&d=identicon&r=PG", "display_name": "Dilshad Abduwali", "link": "https://stackoverflow.com/users/2242761/dilshad-abduwali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 510, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1592464400, "creation_date": 1557891186, "last_edit_date": 1592464400, "question_id": 56141399, "link": "https://stackoverflow.com/questions/56141399/running-python-or-powershell-in-vba-outlook", "title": "Running Python or PowerShell in VBA Outlook", "body": "<p>I am trying to run a Python script using VBA in Outlook. The Python script is to fetch data using REST API and write to file in the system. I am using VBA to orchestrate this with sending emails. </p>\n\n<p>The Python script (<code>get_people.py</code>) runs from OS. It calls a REST API and gets a list of peoples names and writes to a file in OS.</p>\n\n<p>I tried two methods:</p>\n\n<ol>\n<li><p>Wrapping the Python execution in a batch file called <code>getNames.bat</code>:</p>\n\n<pre><code>#getNames.bat file\n C:\\Python37\\python.exe \"C:\\scripts\\get_people.py\"\n</code></pre>\n\n<p>and VBA to call this .bat file:</p></li>\n</ol>\n\n<pre class=\"lang-vb prettyprint-override\"><code>    Sub GetNames()\n\n       Dim wsh as Object\n       Dim waitOnReturn As Boolean: waitOnReturn = True\n       Dim windowStyle As Integer: windowStyle = 1\n       Dim sScript As String\n\n       Set wsh = VBA.CreateObject(\"WScript.Shell\")\n       Set sScript = \"C:\\scripts\\getNames.bat\"\n       wsh.Run sScript, windowStyle, waitOnReturn\n       ... \n       'Rest is reading the content of the file that written by python script and send emails to someone.\n       ...\n    Exit Sub\n</code></pre>\n\n<p>However, the Python line does not run within VBA, but it runs if I manually execute from <code>cmd.exe</code>. In VBA the cmd screen pops up quickly and disappears. </p>\n\n<ol start=\"2\">\n<li>Running Python scripts directly in VBA:</li>\n</ol>\n\n<pre class=\"lang-vb prettyprint-override\"><code>    Sub GetNames()\n\n       Dim wsh as Object\n       Dim waitOnReturn As Boolean: waitOnReturn = True\n       Dim windowStyle As Integer: windowStyle = 1\n       Dim sScript As String\n       Dim PyExe As String\n       Dim PyScript As String\n\n       Set wsh = VBA.CreateObject(\"WScript.Shell\")\n       Set PyExe = \"C:\\Python37\\python.exe\"\n       Set PyScript = \"C:\\scripts\\get_people.py\"\n\n       wsh.Run PyExe &amp; \" \" &amp; PyScript\n\n       ....\n       'This one crashes Outlook\n       ...\n\n       Exit Sub\n</code></pre>\n\n<p>I have tried PowerShell commands instead of Python in the .bat file:</p>\n\n<pre><code> #getNames.bat file\n      C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -command \"Get-Date\"\n</code></pre>\n\n<p>and this fails as well.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": true, "score": 0, "last_activity_date": 1557889853, "last_edit_date": 1557889853, "creation_date": 1557887712, "answer_id": 56141032, "question_id": 56140914, "link": "https://stackoverflow.com/questions/56140914/check-if-cells-contain-specific-word-then-delete-row/56141032#56141032", "title": "check if cells contain &quot;specific word&quot; then delete row", "body": "<p>Create a range then do 1 delete, much better than multiple deletes.</p>\n\n<pre><code>Sub Temp()\nDim DelRange As Range, iCntr  as Long\nFor iCntr = 3 to Range(\"H\" &amp; Rows.Count).End(xlUp).Row\n    If InStr(1, Range(\"H\" &amp; iCntr).Text, \"dnp\", vbTextCompare) &gt; 0 Then\n        If DelRange Is Nothing Then\n            Set DelRange = Range(\"H\" &amp; iCntr)\n        Else\n            Set DelRange = Union(DelRange, Range(\"H\" &amp; iCntr))\n        End If\n    End If\nNext iCntr\nIf Not DelRange Is Nothing Then DelRange.EntireRow.Delete\nEnd Sub\n</code></pre>\n\n<p>The reason yours wasn't working is because <code>Instr</code> returns a numeric showing the position in the first string that the second string was found. If it finds the string it will return something >0 if it doesn't it will return 0</p>\n\n<p>If you want to do it without looping the range (which will be faster) you can use <code>Find</code> like this:</p>\n\n<pre><code>Sub temp2()\nDim FoundCell As Range, LastCell As Range, DelRange As Range, FirstAddr As String\nSet LastCell = Range(\"H\" &amp; Rows.Count)\nSet FoundCell = Range(\"H:H\").Find(what:=\"dnp\", after:=LastCell)\nSet DelRange = FoundCell\nIf Not FoundCell Is Nothing Then FirstAddr = FoundCell.Address\nDo Until FoundCell Is Nothing\n    Set FoundCell = Range(\"H:H\").FindNext(after:=FoundCell)\n    Set DelRange = Union(DelRange, FoundCell)\n    If FoundCell.Address = FirstAddr Then Exit Do\nLoop\nIf Not DelRange Is Nothing Then DelRange.EntireRow.Delete\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 11425021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4603b28827c28e6543fccb9985bd9945?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/11425021/adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 56141032, "answer_count": 1, "score": 0, "last_activity_date": 1557920875, "creation_date": 1557886505, "last_edit_date": 1557920875, "question_id": 56140914, "link": "https://stackoverflow.com/questions/56140914/check-if-cells-contain-specific-word-then-delete-row", "title": "check if cells contain &quot;specific word&quot; then delete row", "body": "<p>I tried the code but it still unable to delete the cells which contains DNP. Is there something wrong with the code? Thank you</p>\n\n<p>'Check to see if column contains dnp then delete row</p>\n\n<pre><code>Last = wsInput.Range(\"H\" &amp; Rows.Count).End(xlUp).Row\nFor iCntr = Last To 3 Step -1\nIf InStr(1, wsInput.Cells(iCntr, \"H\"), \"dnp\", vbTextCompare) = \"[dnp]\"Then \n\n         wsInput.Cells(iCntr, \"H\").EntireRow.Delete\n    End If\nNext iCntr\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "is_accepted": true, "score": 0, "last_activity_date": 1557959459, "last_edit_date": 1557959459, "creation_date": 1557895275, "answer_id": 56141875, "question_id": 56140820, "link": "https://stackoverflow.com/questions/56140820/add-delete-rows-based-on-cell-value/56141875#56141875", "title": "Add/Delete Rows based on cell value", "body": "<p>I hope you appreciate how intricate this can actually be.  :-)</p>\n\n<p>Try this solution ...</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim strKey As String, lngCount As Long, lngOffset As Long\n    Dim i As Long, rngNewRows As Range, lngTopRow As Long, lngBottomRow As Long\n    Dim bInBetween As Boolean\n\n    ' Anymore than 10 cells and we'll skip this process.\n    If Target.Cells.Count &gt; 1 Then Exit Sub\n\n    If Target.Column = 2 Then\n        On Error Resume Next\n\n        Err.Clear\n\n        lngCount = Target.Value\n\n        On Error GoTo 0\n\n        If Err.Description = \"\" Then\n            If lngCount = 0 Then lngCount = 1\n\n            If lngCount &gt; 0 Then\n                ' Get the time value.\n                strKey = Target.Offset(0, -1).Text\n\n                bInBetween = False\n\n                ' Check to make sure that the user isn't entering a value in between an already exploded set of rows.\n                If Target.Row &gt; 1 Then\n                    If Target.Offset(-1, -1).Text = strKey Then bInBetween = True\n                End If\n\n                If Not bInBetween Then\n                    lngOffset = 0\n\n                    ' Now check each column below and delete or add rows depending on the count.\n                    Do While True\n                        lngOffset = lngOffset + 1\n                        If Target.Offset(lngOffset, -1).Text &lt;&gt; strKey Then Exit Do\n                    Loop\n\n                    Application.EnableEvents = False\n\n                    If lngOffset &lt; lngCount Then\n                        ' We need to add rows.\n                        Set rngNewRows = Target.Worksheet.Rows(Target.Offset(lngOffset, 0).Row &amp; \":\" &amp; Target.Offset(lngOffset, 0).Offset(lngCount - lngOffset - 1, 0).Row)\n\n                        lngTopRow = rngNewRows.Cells(1, 1).Row\n                        lngBottomRow = rngNewRows.Cells(rngNewRows.Rows.Count, 1).Row\n\n                        rngNewRows.Insert\n\n                        For i = lngTopRow To lngBottomRow\n                            Target.Worksheet.Cells(i, Target.Column - 1) = Target.Offset(0, -1).Value\n                        Next\n                    Else\n                        If lngOffset &lt;&gt; lngCount Then\n                            ' We're over the count, determine the rows to delete.\n                            Target.Worksheet.Rows(Target.Offset(lngCount, 0).Row &amp; \":\" &amp; Target.Offset(lngOffset - 1, 0).Row).Delete\n                        Else\n                            ' We have 1 row and that's all that's been asked for.\n                        End If\n                    End If\n\n                    Application.EnableEvents = True\n                End If\n            End If\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>... you clearly have some other rules that need to be applied but this should get you going.  Check out the image below to see it in action.</p>\n\n<p>A few points ...</p>\n\n<ul>\n<li><p>It tries to cater for individuals entering values in column B within the exploded range and if they do that, it won't react to the value.  Not sure if that's a requirement but I assumed it was.</p></li>\n<li><p>0 will be treated as 1, so both 1, 0 and cleared will result in the resetting of the line.</p></li>\n<li><p>Deletions happen at the bottom.  So if the number goes from 10 to 3, it will delete the last set of rows to bring it back to 3.</p></li>\n<li><p>It will only react to 1 cell at a time being changed.  It reduced the complexity of the solution.</p></li>\n</ul>\n\n<p>Outside of that, you're on your own.  :-)</p>\n\n<p><a href=\"https://i.stack.imgur.com/AYCrx.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AYCrx.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 8942076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e594933c01e21dd856a855fd6ac20b3?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/8942076/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 56141875, "answer_count": 1, "score": 0, "last_activity_date": 1557959459, "creation_date": 1557885509, "last_edit_date": 1557890730, "question_id": 56140820, "link": "https://stackoverflow.com/questions/56140820/add-delete-rows-based-on-cell-value", "title": "Add/Delete Rows based on cell value", "body": "<p>so I have an excel table with 2 columns: Times and Count, and 3 Rows: 1:00, 2:00 and 3:00 pm. I want functionality where when the user changes the count value for any of the rows, the count value minus 1 row should be added underneath. So for example for 1:00 pm below, when the user enters '4', it should add three rows below that row for a total of 4 rows. If the user changes the count to '2' it should remove 2 rows so that there are 2 total rows. This is what I have so far:</p>\n\n<pre><code>Times              Count    \n1:00pm               4         \n2:00pm               0  \n3:00pm               0  \n</code></pre>\n\n<hr>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim KeyCells As Range\n    Set KeyCells = Range(\"C5:C100\")\n\n    If Not Application.Intersect(KeyCells, Range(Target.Address)) Is Nothing Then\n        'Save Workbook before so that original document will be saved\n        ActiveWorkbook.Save\n        Dim List As Long\n        Dim i As Long\n        Dim x As Long\n        Dim ExCnt As Variant\n        Dim aVal As Integer\n\n        'Find how many rows contain data\n         List = Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n\n        For i = List To 2 Step -1\n            'Store exception value into variable\n            ExCnt = Range(\"C\" &amp; i).Value\n\n            With Range(\"C\" &amp; i)\n                'Insert rows unless text says Exception Count\n                If .Value &gt; 1 And .Value &lt;&gt; \"Exception Count\" Then\n                    .EntireRow.Copy\n                    Application.EnableEvents = False\n\n                    .Offset(1).EntireRow.Resize(.Value - 1).Insert\n                End If\n\nCleanExit:\n            End With\n        Next i\n\n        Application.EnableEvents = True\n    End If\nEnd Sub\n</code></pre>\n\n<p>This code adds the right amount of rows for each row but if the user changes the count value, the effect will compound for the existing rows.</p>\n"}, {"tags": ["vba", "ms-access", "google-earth"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1557888123, "post_id": 56140685, "comment_id": 98912347, "body": "Alternative approach is Microsoft Web Browser control. I just tested it and it works. <a href=\"https://groups.google.com/forum/?hl=en#!topic/comp.databases.ms-access/PgurnoTFIR4\" rel=\"nofollow noreferrer\">groups.google.com/forum/?hl=en#!topic/comp.databases.ms-acce&zwnj;&#8203;ss/&hellip;</a>"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1557889914, "post_id": 56140685, "comment_id": 98912654, "body": "AFAIK, passing data to GoogleEarth requires building a KML file and opening the KML. App set as default for that file type will open and load data."}, {"owner": {"reputation": 887, "user_id": 6658584, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rf6mh.jpg?s=128&g=1", "display_name": "Christiaan Adams", "link": "https://stackoverflow.com/users/6658584/christiaan-adams"}, "edited": false, "score": 0, "creation_date": 1558028537, "post_id": 56140685, "comment_id": 98974473, "body": "If Google Maps would work, then you can do this quite easily by creating a link that looks like: <a href=\"https://www.google.com/maps/search/&lt;address\" rel=\"nofollow noreferrer\">google.com/maps/search/&lt;address</a>&gt; for example:  <a href=\"https://www.google.com/maps/search/20+W+34th+St,+New+York,+NY+10001\" rel=\"nofollow noreferrer\">google.com/maps/search/20+W+34th+St,+New+York,+NY+10001</a> (make sure to replace spaces in the address with &quot;+&quot; symbols."}], "owner": {"reputation": 111, "user_id": 4946383, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/F8CZV.jpg?s=128&g=1", "display_name": "lunar8nrg", "link": "https://stackoverflow.com/users/4946383/lunar8nrg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 151, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594779409, "creation_date": 1557884201, "last_edit_date": 1594779409, "question_id": 56140685, "link": "https://stackoverflow.com/questions/56140685/hyperlink-addresses-on-access-database-to-google-earth", "title": "Hyperlink Addresses on Access Database to Google Earth", "body": "<p>I'm developing an Access Database and want to create a direct hyperlink on the forms to the customers address.  The hyperlink would open the Google Earth Pro application and use the address to locate the unit.</p>\n\n<p>I have tried a hyperlink but don't see any literature on how you can integrate with Google Earth Pro.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 0, "creation_date": 1557884800, "post_id": 56140653, "comment_id": 98911811, "body": "Can you provide a sample (image) of what your worksheet looks like?  It&#39;s all possible but the devil is in the detail on this one.  It sounds like you want to format the cell, not the column."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1557902629, "post_id": 56140653, "comment_id": 98916269, "body": "You might benefit from reading  <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>."}, {"owner": {"reputation": 43, "user_id": 11445361, "user_type": "registered", "profile_image": "https://graph.facebook.com/650951922/picture?type=large", "display_name": "Nick Vanderkooi", "link": "https://stackoverflow.com/users/11445361/nick-vanderkooi"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1558067024, "post_id": 56140653, "comment_id": 98985016, "body": "@P\u1d07\u029c that&#39;s super useful thanks"}], "answers": [{"tags": [], "owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "is_accepted": true, "score": 0, "last_activity_date": 1557886596, "creation_date": 1557886596, "answer_id": 56140922, "question_id": 56140653, "link": "https://stackoverflow.com/questions/56140653/is-there-a-way-to-format-cells-based-on-vba-reading-unit-type/56140922#56140922", "title": "Is there a way to format cells based on VBA reading unit type?", "body": "<p>You should be able to change the example code below to suit your exact requirements:</p>\n\n<pre><code>Dim lngCol As Long, i As Long\nDim str As String\n\nlngCol = Cells(2, Columns.Count).End(xlToLeft).Column\n\nFor i = 1 To lngCol\n    Select Case Cells(2, i)\n        Case \"$\": Columns(i).Style = \"Currency\"\n        Case \"%\": Columns(i).Style = \"Percent\"\n    End Select\nNext\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 11445361, "user_type": "registered", "profile_image": "https://graph.facebook.com/650951922/picture?type=large", "display_name": "Nick Vanderkooi", "link": "https://stackoverflow.com/users/11445361/nick-vanderkooi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 56140922, "answer_count": 1, "score": 0, "last_activity_date": 1557902590, "creation_date": 1557883805, "last_edit_date": 1557902590, "question_id": 56140653, "link": "https://stackoverflow.com/questions/56140653/is-there-a-way-to-format-cells-based-on-vba-reading-unit-type", "title": "Is there a way to format cells based on VBA reading unit type?", "body": "<p>I have a table. Row 2 in each column contains a heading for the unit type (such as $ values, per cent). I would like to format the values in the column based on the unit type in Row 2.</p>\n\n<p>Currently, the macro selects columns manually. (See example below).</p>\n\n<p>Is there a macro that would format the columns based on the unit type?</p>\n\n<p>Instead of the macro below, then ''if row 2 is \"per cent\" then change column format to '0%'.</p>\n\n<pre><code>Sub Format()\n\n\nColumns(\"Q:Q\").Select\nSelection.NumberFormat = \"0%\"\nColumns(\"AA:AA\").Select\nSelection.NumberFormat = \"0%\"\nColumns(\"AK:AK\").Select\nSelection.NumberFormat = \"0%\"\nColumns(\"AU:AU\").Select\nSelection.NumberFormat = \"0%\"\nColumns(\"BJ:BJ\").Select\nSelection.NumberFormat = \"0%\"\nColumns(\"BR:BR\").Select\nSelection.NumberFormat = \"0%\"\nColumns(\"BN:BN\").Select\nSelection.NumberFormat = \"0%\"\nColumns(\"BZ:BZ\").Select\nSelection.NumberFormat = \"0%\"\nColumns(\"BV:BV\").Select\nSelection.NumberFormat = \"0%\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2939, "user_id": 4711754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c25453f6a114ebb66aefcc27b0ab44d1?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Allen", "link": "https://stackoverflow.com/users/4711754/andrew-allen"}, "edited": false, "score": 1, "creation_date": 1557880721, "post_id": 56140171, "comment_id": 98911123, "body": "you&#39;ve not defined the type of <code>lookupFoundCell</code>.  I&#39;d follow error checking advice <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/error-messages/object-variable-or-with-block-variable-not-set\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 2939, "user_id": 4711754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c25453f6a114ebb66aefcc27b0ab44d1?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Allen", "link": "https://stackoverflow.com/users/4711754/andrew-allen"}, "edited": false, "score": 1, "creation_date": 1557883242, "post_id": 56140171, "comment_id": 98911549, "body": "@Andrew that link is to a .Net page, not VBA.  While it&#39;s good advice to Dim all variables,  that won&#39;t cause the error OP reports"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1557883351, "post_id": 56140171, "comment_id": 98911569, "body": "@user probably <code>rSearchRange</code> is <code>Nothing</code> after the first Find.  Add a <code>If Not rSearchRange Is Nothing Then</code>"}, {"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1557890854, "post_id": 56140171, "comment_id": 98912802, "body": "Did &quot;... .FindNext(rFoundCell)&quot;  really find anything? put debug on next line and then add watch to see what was gotten."}, {"owner": {"reputation": 1, "user_id": 11501270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e539dab11ace02c299578dc6b47b0933?s=128&d=identicon&r=PG&f=1", "display_name": "user11501270", "link": "https://stackoverflow.com/users/11501270/user11501270"}, "edited": false, "score": 0, "creation_date": 1557902495, "post_id": 56140171, "comment_id": 98916207, "body": "In step by step run (F8), I see that after first iteration in DO, in second iteration, I see that at the line:    Set rFoundCell = .FindNext(rFoundCell)      rFoundCell is changed to Nothing. This does not happen if I dont have the block starting from      With ThisWorkbook.Worksheets(&quot;Sheet3&quot;)"}], "answers": [{"comments": [{"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1557907042, "post_id": 56143578, "comment_id": 98918537, "body": "While this is always good practice (and prevents numerous <i>other</i> issues), it is not actually the cause of this one"}], "tags": [], "owner": {"reputation": 3203, "user_id": 430567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e5c53d9384850093ebc925e896629b1?s=128&d=identicon&r=PG", "display_name": "Lord Peter", "link": "https://stackoverflow.com/users/430567/lord-peter"}, "is_accepted": false, "score": 1, "last_activity_date": 1557904484, "creation_date": 1557904484, "answer_id": 56143578, "question_id": 56140171, "link": "https://stackoverflow.com/questions/56140171/i-get-an-error-while-searching-for-a-reference-in-another-sheet-within-a-with-bl/56143578#56143578", "title": "I get an error while searching for a reference in another sheet within a With block", "body": "<p>The <code>set</code> assignment requires an object, but you haven't declared (dimensioned) <code>lookupFoundCell</code>. It is therefore being defaulted to a variant.</p>\n\n<p>The Range.Find method returns a Range object so you can dimension your variable like this:</p>\n\n<pre><code>Dim lookupFoundCell as Range \n</code></pre>\n\n<p>Always use <code>Option Explicit</code> in your VBA projects and then you'll get better error checking. In this case you would have seen that you had not declared the variable.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 11501270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e539dab11ace02c299578dc6b47b0933?s=128&d=identicon&r=PG&f=1", "display_name": "user11501270", "link": "https://stackoverflow.com/users/11501270/user11501270"}, "edited": false, "score": 0, "creation_date": 1557987487, "post_id": 56144233, "comment_id": 98951537, "body": "Not sure I got it. Why would the second rFoundCell be from ThisWorkbook.Worksheets(&quot;Sheet3&quot;)? My intention is to have lookupFoundCell from ThisWorkbook.Worksheets(&quot;Sheet3&quot;). Thats why I had these statements in the With ThisWorkbook.Worksheets(&quot;Sheet3&quot;) block:                     Set lookupSearchRange = .Range(.Cells(1, 2), .Cells(.Rows.Count, 2).End(xlUp))                     With lookupSearchRange                         Set lookupFoundCell = .Find(sSbmId, LookIn:=xlValues, LookAt:=xlPart)                     &#39; End With"}, {"owner": {"reputation": 1, "user_id": 11501270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e539dab11ace02c299578dc6b47b0933?s=128&d=identicon&r=PG&f=1", "display_name": "user11501270", "link": "https://stackoverflow.com/users/11501270/user11501270"}, "edited": false, "score": 0, "creation_date": 1557987680, "post_id": 56144233, "comment_id": 98951623, "body": "Is it because the whole block is under With rSearchRange? What should be the right way to search the value from first sheet &quot;Internal_Report&quot; in the second sheet &quot;Sheet 3&quot;?"}], "tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": false, "score": 0, "last_activity_date": 1557907331, "last_edit_date": 1557907331, "creation_date": 1557906989, "answer_id": 56144233, "question_id": 56140171, "link": "https://stackoverflow.com/questions/56140171/i-get-an-error-while-searching-for-a-reference-in-another-sheet-within-a-with-bl/56144233#56144233", "title": "I get an error while searching for a reference in another sheet within a With block", "body": "<p>Step through line-by-line with <kbd>F8</kbd>, and you will see that the issue is actually here:</p>\n\n<pre><code>If Not rAllFoundCells Is Nothing Then\n    Set rAllFoundCells = Union(rAllFoundCells, rFoundCell) 'This Line Errors\nElse\n    Set rAllFoundCells = rFoundCell\nEnd If\n</code></pre>\n\n<p>The reason is quite simple: your <em>first</em> <code>rFoundCell</code> is from <code>ThisWorkbook.Worksheets(\"Internal_Report\")</code>, so <code>rAllFoundCells</code> is also on <code>ThisWorkbook.Worksheets(\"Internal_Report\")</code></p>\n\n<p>However, your <em>second</em> <code>rFoundCell</code> is from <code>ThisWorkbook.Worksheets(\"Sheet3\")</code> - you are trying to create <code>Union</code> of cells from <strong>different worksheets</strong>.  This is not a permitted action.</p>\n\n<p>To see this more clearly (but <strong>not</strong> fix the code - you need to decide what you are <em>actually</em> trying to do and rework your underlying logic first), use this:</p>\n\n<pre><code>If Not rAllFoundCells Is Nothing Then\n    Debug.Print \"rAllFoundCells: \" &amp; rAllFoundCells.Worksheet.Name\n    Debug.Print \"rFoundCell:\" &amp; rFoundCell.Worksheet.Name\n    Set rAllFoundCells = Union(rAllFoundCells, rFoundCell) 'This Line Errors\n    Debug.Print \"This line will only show if there is no error\"\nElse\n    Set rAllFoundCells = rFoundCell\nEnd If\n</code></pre>\n\n<p>You can view the Debug output in the VBE Immediate Window (<kbd>Ctrl</kbd> + <kbd>G</kbd>)</p>\n"}], "owner": {"reputation": 1, "user_id": 11501270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e539dab11ace02c299578dc6b47b0933?s=128&d=identicon&r=PG&f=1", "display_name": "user11501270", "link": "https://stackoverflow.com/users/11501270/user11501270"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1557907331, "creation_date": 1557878952, "last_edit_date": 1557894365, "question_id": 56140171, "link": "https://stackoverflow.com/questions/56140171/i-get-an-error-while-searching-for-a-reference-in-another-sheet-within-a-with-bl", "title": "I get an error while searching for a reference in another sheet within a With block", "body": "<p>This is for a vba script within Excel. I am getting an Error trying to search in another sheet inside a With block that finds a reference value</p>\n\n<p>I am not familiar with vba scripting in Excel. I read some code snippets from this site and tried it out. Not sure why do I keep getting this error </p>\n\n<blockquote>\n  <p>Run-time error '91'. </p>\n</blockquote>\n\n<p>I find out that this means \"Object variable or With block variable not set\"</p>\n\n<pre><code>Public Sub ReplaceCovCfg()\n\n    Dim sValToFind As String\n    Dim rSearchRange As Range\n    Dim sFirstAdd As String\n    Dim rFoundCell As Range\n    Dim rAllFoundCells As Range\n    Dim sSbmId As String\n    sValToFind = \"Reference\"\n    With ThisWorkbook.Worksheets(\"Internal_Report\")\n        Set rSearchRange = .Range(.Cells(1, 2), .Cells(.Rows.Count, 2).End(xlUp))\n    End With\n\n    With rSearchRange\n         Set rFoundCell = .Find(sValToFind, LookIn:=xlValues, LookAt:=xlPart)\n         If Not rFoundCell Is Nothing Then\n            sFirstAdd = rFoundCell.Address\n            Do\n\n                sMessage = sMessage &amp; rFoundCell.Row &amp; \", \"\n\n                'Create a range of found cells.\n                If Not rAllFoundCells Is Nothing Then\n                    Set rAllFoundCells = Union(rAllFoundCells, rFoundCell)\n                Else\n                    Set rAllFoundCells = rFoundCell\n                End If\n                Set rFoundCell = .FindNext(rFoundCell)\n\n                ' search in previous records\n                sSbmId = rFoundCell.Offset(0, 1).Value\n                With ThisWorkbook.Worksheets(\"Sheet3\")\n                    Set lookupSearchRange = .Range(.Cells(1, 2), .Cells(.Rows.Count, 2).End(xlUp))\n                    With lookupSearchRange\n                        Set lookupFoundCell = .Find(sSbmId, LookIn:=xlValues, LookAt:=xlPart)\n                    ' End With\n\n                        If Not lookupFoundCell Is Nothing Then\n                            rFoundCell.Offset(0, 4).Value = \"Old\"\n                        Else\n                            rFoundCell.Offset(0, 4).Value = \"New\"\n                        End If\n                    End With\n                End With\n\n            Loop While rFoundCell.Address &lt;&gt; sFirstAdd\n         End If\n    End With\n\n    rAllFoundCells.Offset(0, 1).Copy Destination:=ThisWorkbook.Worksheets(\"Sheet2\").Range(\"A2\")\n\nEnd Sub\n</code></pre>\n\n<p>Keep getting this error:</p>\n\n<blockquote>\n  <p>Run-time error '91': Object variable or With block variable not set</p>\n</blockquote>\n\n<p>for this line:</p>\n\n<pre><code>Set lookupFoundCell = .Find(sSbmId, LookIn:=xlValues, LookAt:=xlPart)\n</code></pre>\n\n<p>If I remove this line, and the following <code>If</code> block, the script manages to run without error.</p>\n\n<p>If I replace <code>sSbmId</code> with a constant string (like \"blahblah\", I still get the same error.</p>\n\n<p>Just for curiosity's sake, if I replace <code>sSbmId</code> with <code>sValToFind</code> (which doesn't make sense, the macro runs without error.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["vba", "string"], "answers": [{"comments": [{"owner": {"reputation": 3129, "user_id": 6656050, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMh8v.jpg?s=128&g=1", "display_name": "Jeremy Kahan", "link": "https://stackoverflow.com/users/6656050/jeremy-kahan"}, "edited": false, "score": 0, "creation_date": 1557878815, "post_id": 56139833, "comment_id": 98910791, "body": "note the other methods there could also be adapted for this purpose. Recursion would also be an option long the lines of if empty string, false else if the first char is not one of those 3 true, else whatever it is for the function called on the rest of the string."}], "tags": [], "owner": {"reputation": 3129, "user_id": 6656050, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMh8v.jpg?s=128&g=1", "display_name": "Jeremy Kahan", "link": "https://stackoverflow.com/users/6656050/jeremy-kahan"}, "is_accepted": true, "score": 0, "last_activity_date": 1557880262, "last_edit_date": 1557880262, "creation_date": 1557876007, "answer_id": 56139833, "question_id": 56139592, "link": "https://stackoverflow.com/questions/56139592/vba-find-string-other-than/56139833#56139833", "title": "vba find string other than", "body": "<p>Here is a strategy based on <a href=\"https://stackoverflow.com/questions/5314729/count-occurrences-of-a-character-in-a-string\">Count occurrences of a character in a string</a>\nI don't have vba handy, but this should work. The idea is to remove all these characters and see if anything is left. <code>text</code> represents your string that is being tested.</p>\n\n<pre><code>Dim TempS As String\nTempS = Replace(text, \" \" , \"\")\nTempS = Replace(TempS, \",\" , \"\")\nTempS = Replace(TempS, \"'\" , \"\")\n</code></pre>\n\n<p>and your result is <code>Len(TempS&gt;0)</code></p>\n\n<p>Another approach is to use recursion by having a base case of false if the string is empty, if the first character is one of the three call ourselves on the rest of the string, or if not the value is true. Here is the code</p>\n\n<pre><code> function hasOtherChars(s As String) As Boolean\n hasOtherChars=false\n if (len(s)=0) then\n   exit function\n end if\n Dim asciiSpace As Integer\n    asciiSpace = Asc(\" \")\n    Dim asciiComma As Integer\n    asciiComma= Asc(\",\")\n    Dim asciiApostrophe As Integer\n    asciiApostrophe = Asc(\"'\")\n Dim c as Integer\n c = Asc(Mid$(s, 1, 1))\n if ((c=asciiSpace) or (c=asciiComma) or (c=asciiApostrophe)) then\n    hasOtherChars = hasOtherChars(Mid$(s,2))\nelse\n hasOtherChars=true\n end if\nEnd function\n</code></pre>\n\n<p>Again I am borrowing from the other thread.</p>\n"}], "owner": {"reputation": 3, "user_id": 2916373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23113a9011e3acbe9b0b72d92f5970de?s=128&d=identicon&r=PG&f=1", "display_name": "user2916373", "link": "https://stackoverflow.com/users/2916373/user2916373"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "closed_date": 1557879961, "accepted_answer_id": 56139833, "answer_count": 1, "score": -3, "last_activity_date": 1557882300, "creation_date": 1557874001, "last_edit_date": 1557882300, "question_id": 56139592, "link": "https://stackoverflow.com/questions/56139592/vba-find-string-other-than", "closed_reason": "Needs details or clarity", "title": "vba find string other than", "body": "<p>I have a variable with a string...and I want to know if it contains any value other than single quote, comma and a space  (\"', \") I'm using vba in excel.</p>\n\n<p>for example, i have a varible strA = \"'test', 'player'\"\nI want to check to see if strA has any characters other than \"', \" (single quote, comma and space).</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 7, "creation_date": 1557872740, "post_id": 56139348, "comment_id": 98909482, "body": "<code>IsNumeric(Right(A6,1))</code>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1557902404, "post_id": 56139348, "comment_id": 98916162, "body": "Please not that <i>&quot;doesn&#39;t work, I have an error.&quot;</i> is no valid error description and completly meaningless. If you get errors you need to tell the error message of course."}], "answers": [{"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 3, "last_activity_date": 1557902478, "last_edit_date": 1557902478, "creation_date": 1557877274, "answer_id": 56139986, "question_id": 56139348, "link": "https://stackoverflow.com/questions/56139348/find-out-if-last-caracter-is-a-letter-or-a-number/56139986#56139986", "title": "Find out if last caracter is a letter or a number", "body": "<p>Perhaps this is an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY problem</a>.</p>\n\n<p>If your goal is </p>\n\n<ul>\n<li>to count the number of unique files, and </li>\n<li>the files are defined by the numeric beginning of the full file name,</li>\n<li>Then you can make use of the <code>Val</code> function, which will ignore any trailing non-numeric characters.</li>\n</ul>\n\n<p>For example (using a Dictionary to generate the count):</p>\n\n<pre><code>Set D = CreateObject(\"Scripting.Dictionary\")\n\nFor Each myCell In myRange\n    Key = Val(C)\n    If Not D.Exists(Key) Then D.Add Key, C.Value\nNext C\nuniqueFiles = D.Count\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "is_accepted": true, "score": 1, "last_activity_date": 1557905171, "creation_date": 1557905171, "answer_id": 56143747, "question_id": 56139348, "link": "https://stackoverflow.com/questions/56139348/find-out-if-last-caracter-is-a-letter-or-a-number/56143747#56143747", "title": "Find out if last caracter is a letter or a number", "body": "<p>To answer your question and question only:</p>\n\n<ul>\n<li>To find out whether a character <em>(or a set of characters)</em> is a number, we can use the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/isnumeric-function\" rel=\"nofollow noreferrer\"><code>IsNumeric()</code></a> function.</li>\n<li>And to get the last character out of a string we can use the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/right-function\" rel=\"nofollow noreferrer\"><code>Right()</code></a> function.</li>\n</ul>\n\n<p>I've linked to both function's documentation, so do absolutely take a gander!<br>\nYour custom function could look something like this:</p>\n\n<pre><code>Public Function is_last_num(ByVal strng as String) As Boolean\n    is_last_num = IsNumeric(Right(strng, 1))\nEnd Function\n</code></pre>\n\n<p>If you're trying to count unique files based on the number then just use what @RonRosenfeld suggested</p>\n"}], "owner": {"reputation": 111, "user_id": 7731486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2876c73e3812e900a9035a6885b9c12?s=128&d=identicon&r=PG&f=1", "display_name": "manny-", "link": "https://stackoverflow.com/users/7731486/manny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 56143747, "answer_count": 2, "score": 0, "last_activity_date": 1557905171, "creation_date": 1557872186, "last_edit_date": 1557902296, "question_id": 56139348, "link": "https://stackoverflow.com/questions/56139348/find-out-if-last-caracter-is-a-letter-or-a-number", "title": "Find out if last caracter is a letter or a number", "body": "<p>I have an Excel sheet.\nColumn A, I have different values :</p>\n\n<pre><code>A6  : 1520 A7  : 9500 A8  : 9500a A9  : 12450 A10 : 13425 A11 : 13425a\nA12 : 13425b\n</code></pre>\n\n<p>(those numbers are files numbers I've generated with the help of another vba macro using advanced filters from a database but that's not the point here.)</p>\n\n<p>What I'd like to do is count the number of different file numbers listed. \nFor me <code>13425</code>, <code>13425a</code> and <code>13425b</code> are from 1 file only.</p>\n\n<p>So in this previous example, I'd like to get the following number of different files: 4 (<code>1250</code>, <code>9500</code>, <code>12450</code> and <code>13425</code>)</p>\n\n<p>So I've tried different things :</p>\n\n<pre><code>    Dim L As Integer ' num\u00e9ro de la derni\u00e8re ligne\n    Dim I As Integer ' compteur pour it\u00e9ration\n    Dim K As String  ' dernier caract\u00e8re de la case en partant de la droite\n    Dim N As Integer ' compteur N\n\n    L = Sheets(\"Stats\").Range(\"a165536\").End(xlUp).Row 'Derni\u00e8re ligne utilis\u00e9e\n\n    Range(\"O1\") = L\n\n    N = 0 'initilisation du compteur\n\n    For I = 6 To L\n         K = Right(Range(\"A\" &amp; I), 1)\n      If IsError(K * 1) = False Then\n         N = N + 1\n         Else\n         N = N\n      End If\n    Next I\nRange(\"O2\") = N\n</code></pre>\n\n<p>But <code>IsError(K*1)</code> doesn't work, I have an error.</p>\n\n<p>In MS Excel we can use the following function: <code>=CODE(RIGHT(A6,1))</code>.\nIf the value is <code>&gt;=48 AND &lt;=57</code> I know the last caracter is a NUMBER and NOT a letter. But I think this function doesn't exist in VBA ?</p>\n\n<p>SO that's the 2 things I've tried to solve my problem but I didn't manage to find out a solution yet.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1557870710, "post_id": 56139109, "comment_id": 98908923, "body": "If <code>Z</code> is equal to <code>Z1.Value2 - 10</code>, <code>Z</code> should not be a <code>Range</code> but a <code>Double</code> for sure, but without <code>Set</code>."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1557870739, "post_id": 56139109, "comment_id": 98908936, "body": "You can&#39;t set a range of a double.  and you do not set a Double.  <code>Dim Z as Double</code> and <code>Z = Z1.Value2 - 10</code> No <code>Set</code>"}, {"owner": {"reputation": 191, "user_id": 5909783, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f313b898b5d205241ab092e57f425fec?s=128&d=identicon&r=PG&f=1", "display_name": "Studix", "link": "https://stackoverflow.com/users/5909783/studix"}, "edited": false, "score": 0, "creation_date": 1557872284, "post_id": 56139109, "comment_id": 98909360, "body": "Working Thank you. I understand."}], "owner": {"reputation": 191, "user_id": 5909783, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f313b898b5d205241ab092e57f425fec?s=128&d=identicon&r=PG&f=1", "display_name": "Studix", "link": "https://stackoverflow.com/users/5909783/studix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557901759, "creation_date": 1557870629, "last_edit_date": 1557901759, "question_id": 56139109, "link": "https://stackoverflow.com/questions/56139109/object-requested-in-a-calculus", "title": "&quot;object requested&quot; in a calculus", "body": "<p>The code below leads to an \"Object requested\" error. I tried to change Dim Z As Range into Dim Z As Double but with the same result.\nAny hint on why this is happening and how to get a solution would be very welcome.</p>\n\n<pre><code>Dim Z1 As Range\nDim Z As Range\n\nSet Z1 = Wb_Optim.Sheets(1).Cells(n + 1, \"D\")\nSet Z = Z1.Value2 - 10\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 1, "last_activity_date": 1557875167, "creation_date": 1557875167, "answer_id": 56139735, "question_id": 56138809, "link": "https://stackoverflow.com/questions/56138809/excel-split-cell-with-multiple-lines-into-rows-for-entire-table/56139735#56139735", "title": "Excel Split cell with multiple lines into rows for entire table", "body": "<p>Try this, assuming your data starts in A2:</p>\n\n<pre><code>Sub x()\n\nDim r As Long, v As Variant\n\nFor r = Range(\"A\" &amp; Rows.Count).End(xlUp).Row To 2 Step -1\n    v = Split(Cells(r, 4), vbLf)\n    If UBound(v) &gt; 0 Then\n        Cells(r + 1, 1).Resize(UBound(v), 4).Insert shift:=xlDown\n        Cells(r + 1, 1).Resize(UBound(v), 3).Value = Cells(r, 1).Resize(, 3).Value\n        Cells(r, 4).Resize(UBound(v) + 1).Value = Application.Transpose(v)\n    End If\nNext r\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1634, "user_id": 538029, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7afae584688d7ad0a09069a44f543d4b?s=128&d=identicon&r=PG", "display_name": "Jeremy F.", "link": "https://stackoverflow.com/users/538029/jeremy-f"}, "edited": false, "score": 0, "creation_date": 1557928995, "post_id": 56140166, "comment_id": 98931801, "body": "Excel puts a leading comma (by default) in the delimiter text field.  Once I removed that, it worked."}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 1, "last_activity_date": 1557878912, "creation_date": 1557878912, "answer_id": 56140166, "question_id": 56138809, "link": "https://stackoverflow.com/questions/56138809/excel-split-cell-with-multiple-lines-into-rows-for-entire-table/56140166#56140166", "title": "Excel Split cell with multiple lines into rows for entire table", "body": "<p>Pretty simple with Power Query</p>\n\n<p>All you need to do is split the <code>IPAddress</code> column by the linefeed character into Rows</p>\n\n<p><strong>Split Column dialog from UI</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/ywJqJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ywJqJ.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>M-Code</strong></p>\n\n<pre><code>let\n    Source = Excel.CurrentWorkbook(){[Name=\"Table1\"]}[Content],\n    #\"Changed Type\" = Table.TransformColumnTypes(Source,{{\"Server Name\", type text}, {\"Serial Number\", type text}, {\"OS\", type text}, {\"IPAddress\", type text}}),\n    #\"Split Column by Delimiter\" = Table.ExpandListColumn(Table.TransformColumns(#\"Changed Type\", {{\"IPAddress\", Splitter.SplitTextByDelimiter(\"#(lf)\", QuoteStyle.Csv), let itemType = (type nullable text) meta [Serialized.Text = true] in type {itemType}}}), \"IPAddress\")\nin\n    #\"Split Column by Delimiter\"\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Wkayv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Wkayv.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1634, "user_id": 538029, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7afae584688d7ad0a09069a44f543d4b?s=128&d=identicon&r=PG", "display_name": "Jeremy F.", "link": "https://stackoverflow.com/users/538029/jeremy-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1613, "favorite_count": 0, "accepted_answer_id": 56140166, "answer_count": 2, "score": 0, "last_activity_date": 1557928926, "creation_date": 1557868988, "last_edit_date": 1557928926, "question_id": 56138809, "link": "https://stackoverflow.com/questions/56138809/excel-split-cell-with-multiple-lines-into-rows-for-entire-table", "title": "Excel Split cell with multiple lines into rows for entire table", "body": "<p>In Excel (2016), I have some data that looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/6juxY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6juxY.png\" alt=\"enter image description here\"></a></p>\n\n<p>Based on a particular column, in this example the 'IPAddress' column, if there are multiple lines in the cell, separate the string into a new row and copy the remaining data into that row.</p>\n\n<p>This is what I am looking for after the script or whatever completes.</p>\n\n<p><a href=\"https://i.stack.imgur.com/BSJHQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BSJHQ.png\" alt=\"enter image description here\"></a></p>\n\n<p>I'm using the follow code from: <a href=\"https://stackoverflow.com/questions/36835884/split-cell-with-multiple-lines-into-rows\">Split cell with multiple lines into rows</a></p>\n\n<pre><code>    Sub tes_5()\n\n\n    Dim cell_value As Variant\n    Dim counter As Integer\n\n    'Row counter\n    counter = 1\n\n    'Looping trough A column define max value\n    For i = 1 To 10\n\n        'Take cell at the time\n        cell_value = ThisWorkbook.ActiveSheet.Cells(i, 1).Value\n\n        'Split cell contents\n        Dim WrdArray() As String\n        WrdArray() = Split(cell_value, vbLf)\n\n        'Place values to the B column\n        For Each Item In WrdArray\n            ThisWorkbook.ActiveSheet.Cells(counter, 2).Value = Item\n            counter = counter + 1\n        Next Item\n\n\n    Next i\nEnd Sub\n</code></pre>\n\n<p>That separates out the IPAddress column, but does not add the data for the other cells in the new row.</p>\n\n<p>Text to columns doesn't work and Power Query (<a href=\"https://www.quora.com/Is-there-a-way-in-excel-to-bulk-split-cells-with-multiple-lines-inside-into-new-rows-without-overwriting-the-existing-data-below\" rel=\"nofollow noreferrer\">https://www.quora.com/Is-there-a-way-in-excel-to-bulk-split-cells-with-multiple-lines-inside-into-new-rows-without-overwriting-the-existing-data-below</a>) doesn't work either.</p>\n\n<p>Any other suggestions?</p>\n\n<p>Update:\nJust learned that by default, Excel puts a comma at the beginning of the delimiter field, which was causing my delimiter to not work when choosing line feed.\n<a href=\"https://i.stack.imgur.com/JLSRM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JLSRM.png\" alt=\"enter image description here\"></a></p>\n\n<p>If you remove the leading comma, you \"should\" (like I did), get the desired results.</p>\n\n<p><a href=\"https://i.stack.imgur.com/jcBRh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jcBRh.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "bloomberg"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1557869143, "post_id": 56138708, "comment_id": 98908426, "body": "There are plenty of examples online of importing from Bloomberg to Excel - did you try searching Google? I&#39;m afraid your question is a bit too broad for us to help you..."}, {"owner": {"reputation": 296034, "user_id": 829571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zflGZ.png?s=128&g=1", "display_name": "assylias", "link": "https://stackoverflow.com/users/829571/assylias"}, "edited": false, "score": 0, "creation_date": 1557872039, "post_id": 56138708, "comment_id": 98909292, "body": "I&#39;m not sure you can import ECO data into Excel - have you tried to ask the Bloomberg help desk (F1 F1 on your terminal)?"}], "owner": {"reputation": 11, "user_id": 10586759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9370c32e268784d1746fd2b3d849c98a?s=128&d=identicon&r=PG&f=1", "display_name": "yyy6yypls", "link": "https://stackoverflow.com/users/10586759/yyy6yypls"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557868524, "creation_date": 1557868524, "question_id": 56138708, "link": "https://stackoverflow.com/questions/56138708/importing-eco-data-from-bloomberg-into-excel-using-vba", "title": "Importing ECO data from bloomberg into excel using VBA", "body": "<p>I am trying to import data from Bloomberg into Excel using VBA. </p>\n\n<p>Currently I'm manually pulling data from BBG by searching 'ECO' and customize my filters(date) and columns. Is there any way I can automate this process (with filter on dates and customized columns)? </p>\n\n<p>A sample code will be greatly appreciated! Thanks:)</p>\n"}, {"tags": ["excel", "vba", "excel-2016"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1557868112, "post_id": 56138377, "comment_id": 98908034, "body": "Try <code>ThisWorkbook.Close SaveChanges:=False</code>"}, {"owner": {"reputation": 593, "user_id": 10018602, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nFE-nC2Du6A/AAAAAAAAAAI/AAAAAAAAAK8/N8OGweyD3x4/photo.jpg?sz=128", "display_name": "Matt Wilson", "link": "https://stackoverflow.com/users/10018602/matt-wilson"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1557869515, "post_id": 56138377, "comment_id": 98908538, "body": "Did not work. Workbook stays open. I tried placing it above the End Sub"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1557871674, "post_id": 56138377, "comment_id": 98909183, "body": "Is your <code>Workbook_Open</code> definitely running?"}, {"owner": {"reputation": 593, "user_id": 10018602, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nFE-nC2Du6A/AAAAAAAAAAI/AAAAAAAAAK8/N8OGweyD3x4/photo.jpg?sz=128", "display_name": "Matt Wilson", "link": "https://stackoverflow.com/users/10018602/matt-wilson"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1557872391, "post_id": 56138377, "comment_id": 98909385, "body": "I stand corrected. My computer needed an update/restart. Tried your solution again and it worked. Thanks a lot!"}], "answers": [{"comments": [{"owner": {"reputation": 593, "user_id": 10018602, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nFE-nC2Du6A/AAAAAAAAAAI/AAAAAAAAAK8/N8OGweyD3x4/photo.jpg?sz=128", "display_name": "Matt Wilson", "link": "https://stackoverflow.com/users/10018602/matt-wilson"}, "edited": false, "score": 0, "creation_date": 1557869541, "post_id": 56138855, "comment_id": 98908548, "body": "Hey, didn&#39;t work unfortunately. Workbook stayed open"}], "tags": [], "owner": {"reputation": 74, "user_id": 11087287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d9d7d71a27d5ddb1f1ca086295e83ff?s=128&d=identicon&r=PG&f=1", "display_name": "jonrizz", "link": "https://stackoverflow.com/users/11087287/jonrizz"}, "is_accepted": false, "score": 0, "last_activity_date": 1557911657, "last_edit_date": 1557911657, "creation_date": 1557869279, "answer_id": 56138855, "question_id": 56138377, "link": "https://stackoverflow.com/questions/56138377/close-workbook-after-workbook-open-is-run/56138855#56138855", "title": "Close Workbook After &quot;Workbook_Open()&quot; is Run", "body": "<p>you can try this, so that the application itself will close</p>\n\n<pre><code>Application.DisplayAlerts = False\nApplication.Quit\n</code></pre>\n"}], "owner": {"reputation": 593, "user_id": 10018602, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nFE-nC2Du6A/AAAAAAAAAAI/AAAAAAAAAK8/N8OGweyD3x4/photo.jpg?sz=128", "display_name": "Matt Wilson", "link": "https://stackoverflow.com/users/10018602/matt-wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1557911657, "creation_date": 1557866891, "last_edit_date": 1557902086, "question_id": 56138377, "link": "https://stackoverflow.com/questions/56138377/close-workbook-after-workbook-open-is-run", "title": "Close Workbook After &quot;Workbook_Open()&quot; is Run", "body": "<p>I have a program that runs as soon as the workbook is open using the <code>Private Sub Workbook_Open()</code> function located in the <code>ThisWorkbook</code> object. I would like to add a closing function as well, so that basically the program will run as soon as the workbook is open, and then close right away so it never stays open, just runs and closes.</p>\n\n<p>I've tried adding:</p>\n\n<pre><code>Workbooks(\"Fire Ext. Comments EXE.xlsm\").Close SaveChanges:=False\n</code></pre>\n\n<p>...right before the <code>End Sub</code> at the bottom of the program, but the workbook stays open so I'm wondering if it belongs in a different module and then called separately? Let me know what you think. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 6, "creation_date": 1557866253, "post_id": 56138255, "comment_id": 98907387, "body": "Total and Share should be Doubles not Longs: <code>Dim Total as Double, Share as Double</code>.  Longs are integer values only no decimal."}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 1, "creation_date": 1557867770, "post_id": 56138255, "comment_id": 98907910, "body": "Also I&#39;m pretty sure you don&#39;t want to be <code>split</code>ting inside a <code>for</code> loop"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1557900593, "post_id": 56138255, "comment_id": 98915401, "body": "Please also note that if you <code>Dim total, share As Long</code> only <code>share</code> is of type <code>Long</code> but <code>total</code> is of type <code>Variant</code> you need to specify a type for <b>every</b> variable in VBA or it is <code>Variant</code> by default: <code>Dim Total as Double, Share as Double</code>. I recommend always to activate <code>Option Explicit</code>: In the VBA editor go to <i>Tools</i> \u203a <i>Options</i> \u203a <i><a href=\"https://www.excel-easy.com/vba/examples/option-explicit.html\" rel=\"nofollow noreferrer\">Require Variable Declaration</a></i>. And also use meaningful variable names. If you need to number variable names <code>split1</code> then you did something fundamentally wrong."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 11364845, "user_type": "registered", "profile_image": "https://graph.facebook.com/1532703080140610/picture?type=large", "display_name": "Daniel", "link": "https://stackoverflow.com/users/11364845/daniel"}, "edited": false, "score": 0, "creation_date": 1557937302, "post_id": 56139689, "comment_id": 98936895, "body": "Thanks! It helped me"}], "tags": [], "owner": {"reputation": 655, "user_id": 3097981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6776097221ad67f371357aaf72cbc775?s=128&d=identicon&r=PG&f=1", "display_name": "Hila DG", "link": "https://stackoverflow.com/users/3097981/hila-dg"}, "is_accepted": true, "score": 2, "last_activity_date": 1557900938, "last_edit_date": 1557900938, "creation_date": 1557874759, "answer_id": 56139689, "question_id": 56138255, "link": "https://stackoverflow.com/questions/56138255/division-result-is-0/56139689#56139689", "title": "Division result is 0", "body": "<p>Explanation about Scott Craner comment above:\n<code>Double</code> (and <code>Float</code>) has a decimal point. <code>Long</code> doesn't. <code>Long</code> is simply a bigger <code>Integer</code>.</p>\n\n<p>So if I take <code>A/B</code> and <code>A = 1</code> and <code>B = 2</code> and define both <code>A</code>, <code>B</code> as <code>Long</code> then the result would be <code>0</code>. </p>\n\n<p>If I define <code>A</code>, <code>B</code> as <code>Decimal</code> then the answer would be <code>0.5</code> (as you'd think). \nThis behaviour exists across programming languages which are typed, once you define a type (as you've done above) and it's by design. Some things (humans, cars) don't convey a real meaning beyond the decimal point (what does it mean to have <code>2.4</code> kids per family?).</p>\n\n<p>When in doubt, always check the data types available in the programming language you're using. You'd be surprised where <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/data-types/\" rel=\"nofollow noreferrer\">this discussion</a> might take you.</p>\n"}], "owner": {"reputation": 31, "user_id": 11364845, "user_type": "registered", "profile_image": "https://graph.facebook.com/1532703080140610/picture?type=large", "display_name": "Daniel", "link": "https://stackoverflow.com/users/11364845/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 56139689, "answer_count": 1, "score": 0, "last_activity_date": 1557900938, "creation_date": 1557866193, "last_edit_date": 1557900470, "question_id": 56138255, "link": "https://stackoverflow.com/questions/56138255/division-result-is-0", "title": "Division result is 0", "body": "<p>It might look stupid but as I divide 11950 by 47086514 the result is 0.</p>\n\n<p>This is what I tried:</p>\n\n<pre><code>Dim total, share As Long\nDim split1 As Variant\nsplit1 = Array(size1)\n\nFor i = 1 To size1 - 6\n    split1 = Split(vetA(i), \":\") 'vetA(1) = 11950 and total = 47086514\n    share = CLng(split1(1)) / total\n    ws.Cells(i + 4, 16).Value = share\nNext i\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11500627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96bc14955d8925fdf8effc95b9d655c8?s=128&d=identicon&r=PG&f=1", "display_name": "C.Rowe", "link": "https://stackoverflow.com/users/11500627/c-rowe"}, "edited": false, "score": 0, "creation_date": 1557871428, "post_id": 56138371, "comment_id": 98909119, "body": "Yes, I need to offset down."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1557866861, "creation_date": 1557866861, "answer_id": 56138371, "question_id": 56138168, "link": "https://stackoverflow.com/questions/56138168/excel-vba-extract-lines-containing-a-particular-name-from-multiple-text-files/56138371#56138371", "title": "Excel VBA - Extract lines containing a particular name from multiple text files", "body": "<p>You can test each line using something like this:</p>\n\n<pre><code>Dim x As Long\nx = 1\nFor i = 0 To UBound(Items)\n    If Items(i) Like \"*your value here*\" Then\n        cl.Offset(0, x).Value = Items(i) '&lt;&lt; this offsets to the right: \n                                         '   did you mean to offset down?\n        x = x + 1\n    End If\n\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 173, "user_id": 1719890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd25513c710f5a3d0d21b5dc195d6621?s=128&d=identicon&r=PG", "display_name": "Jitendra Singh", "link": "https://stackoverflow.com/users/1719890/jitendra-singh"}, "reply_to_user": {"reputation": 1, "user_id": 11500627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96bc14955d8925fdf8effc95b9d655c8?s=128&d=identicon&r=PG&f=1", "display_name": "C.Rowe", "link": "https://stackoverflow.com/users/11500627/c-rowe"}, "edited": false, "score": 0, "creation_date": 1557885695, "post_id": 56138529, "comment_id": 98911967, "body": "@C.Rowe Great. Please upvote the answer if that worked"}], "tags": [], "owner": {"reputation": 173, "user_id": 1719890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd25513c710f5a3d0d21b5dc195d6621?s=128&d=identicon&r=PG", "display_name": "Jitendra Singh", "link": "https://stackoverflow.com/users/1719890/jitendra-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1557867612, "creation_date": 1557867612, "answer_id": 56138529, "question_id": 56138168, "link": "https://stackoverflow.com/questions/56138168/excel-vba-extract-lines-containing-a-particular-name-from-multiple-text-files/56138529#56138529", "title": "Excel VBA - Extract lines containing a particular name from multiple text files", "body": "<p>When you read the line, why dont you check if the text that you want is present on it or not and then skip it based on the check</p>\n\n<pre><code>Sub ReadFilesIntoActiveSheet()\nDim fso As FileSystemObject\nDim folder As folder\nDim file As file\nDim FileText As TextStream\nDim TextLine As String\nDim Items() As String\nDim i As Long\nDim cl As Range\nDim textToSkip as String: textToSkip=\"Large Cap Index\"\n' Get a FileSystem object\nSet fso = New FileSystemObject\n' get the directory you want\nSet folder = fso.GetFolder(\"C:\\Users\\crowe12\\Desktop\\Projects\\CRSP\\Test\")\nSet cl = ActiveSheet.Cells(1, 1)\nFor Each file In folder.Files\n    Set FileText = file.OpenAsTextStream(ForReading)\n    Do While Not FileText.AtEndOfStream\n        TextLine = FileText.ReadLine\n        'You can covert this to lowercase before hand to match ignoring case\n        If Instr(1,TextLine,textToSkip) &gt; 1 Then\n         Items = Split(TextLine, \"|\")\n         cl.Value = folder &amp; \"\\\" &amp; file.Name\n         For i = 0 To UBound(Items)\n          cl.Offset(0, i + 1).Value = Items(i)\n         Next\n         Set cl = cl.Offset(1, 0)\n        End If\n    Loop\n    FileText.Close\nNext file\nSet FileText = Nothing\nSet file = Nothing\nSet folder = Nothing\nSet fso = Nothing\nEnd Sub\n</code></pre>\n\n<p>I did not change much in your code except the condition</p>\n"}], "owner": {"reputation": 1, "user_id": 11500627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96bc14955d8925fdf8effc95b9d655c8?s=128&d=identicon&r=PG&f=1", "display_name": "C.Rowe", "link": "https://stackoverflow.com/users/11500627/c-rowe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 416, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1557872220, "creation_date": 1557865784, "last_edit_date": 1557872220, "question_id": 56138168, "link": "https://stackoverflow.com/questions/56138168/excel-vba-extract-lines-containing-a-particular-name-from-multiple-text-files", "title": "Excel VBA - Extract lines containing a particular name from multiple text files", "body": "<p>Attempting to extract text lines from text files to excel, but only if they contain a certain name within the line. Ignoring the rest of the lines.</p>\n\n<p>I'm currently working with a large number of text files containing standardized information for certain products. Each file has the same list of products, but information from different dates. I've put together some code that pulls in each row from the text files contained with the directory, and includes them together in a single excel spreadsheet.</p>\n\n<p>What I would like to change is for the code to only copy over text lines containing a certain name within the line like \"Large Cap Index\". The rest of the data can be ignored. This is attempting to cut down on the amount of time it takes to pull in the data, since only about 5% of the lines within each text file is needed.</p>\n\n<pre><code>Sub ReadFilesIntoActiveSheet()\n    Dim fso As FileSystemObject\n    Dim folder As folder\n    Dim file As file\n    Dim FileText As TextStream\n    Dim TextLine As String\n    Dim Items() As String\n    Dim i As Long\n    Dim cl As Range\n    ' Get a FileSystem object\n    Set fso = New FileSystemObject\n    ' get the directory you want\n    Set folder = fso.GetFolder(\"C:\\Users\\crowe12\\Desktop\\Projects\\CRSP\\Test\")\n    Set cl = ActiveSheet.Cells(1, 1)\n    For Each file In folder.Files\n        Set FileText = file.OpenAsTextStream(ForReading)\n        Do While Not FileText.AtEndOfStream\n            TextLine = FileText.ReadLine\n            Items = Split(TextLine, \"|\")\n            cl.Value = folder &amp; \"\\\" &amp; file.Name\n            For i = 0 To UBound(Items)\n                cl.Offset(0, i + 1).Value = Items(i)\n            Next\n            Set cl = cl.Offset(1, 0)\n        Loop\n        FileText.Close\n    Next file\n    Set FileText = Nothing\n    Set file = Nothing\n    Set folder = Nothing\n    Set fso = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1557868050, "post_id": 56138010, "comment_id": 98908014, "body": "Tables have &quot;end of cell&quot; and &quot;end of row&quot;characters (for example) which might not make it into the extracted <code>Text</code> property you&#39;re searching.  If you have tables then it&#39;s best to use Word&#39;s built-in search function to find your tags."}], "answers": [{"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1557875339, "creation_date": 1557875339, "answer_id": 56139762, "question_id": 56138010, "link": "https://stackoverflow.com/questions/56138010/select-text-between-strings-repeatly-inside-a-word-table/56139762#56139762", "title": "select text between strings repeatly inside a Word table", "body": "<p>Instr is not reliable where tables and/or fields are involved. For your purposes, use a Word wildcard Find, along the lines of:</p>\n\n<pre><code>Sub Demo()\nApplication.ScreenUpdating = False\nDim StrOut As String\nWith ActiveDocument.Range\n  With .Find\n    .ClearFormatting\n    .Replacement.ClearFormatting\n    .Text = \"\\&lt;tag\\&gt;*\\&lt;/tag\\&gt;\"\n    .Replacement.Text = \"\"\n    .Forward = True\n    .Wrap = wdFindStop\n    .Format = False\n    .MatchWildcards = True\n    .Execute\n  End With\n  Do While .Find.Found\n    If .Information(wdWithInTable) = True Then\n      StrOut = StrOut &amp; vbCr &amp; Split(Split(.Text, \"&gt;\")(1), \"&lt;\")(0)\n    End If\n    .Collapse wdCollapseEnd\n    .Find.Execute\n  Loop\nEnd With\nApplication.ScreenUpdating = True\nMsgBox \"Found:\" &amp; StrOut\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3218, "user_id": 268721, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/377b60db3c8bf7ffc68f52330a58b4b2?s=128&d=identicon&r=PG", "display_name": "tic", "link": "https://stackoverflow.com/users/268721/tic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557875339, "creation_date": 1557865018, "question_id": 56138010, "link": "https://stackoverflow.com/questions/56138010/select-text-between-strings-repeatly-inside-a-word-table", "title": "select text between strings repeatly inside a Word table", "body": "<p>I've built the following code (slightly adapted from a stackoverflow <a href=\"https://stackoverflow.com/a/6426863\">answer</a>)</p>\n\n<pre><code>Sub findTest()\n    Dim firstTerm As String\n    Dim secondTerm As String\n    Dim myRange As Range\n    Dim documentText As String\n    Dim startPos As Long 'Stores the starting position of firstTerm\n    Dim stopPos As Long 'Stores the starting position of secondTerm based on first term's location\n    Dim nextPosition As Long 'The next position to search for the firstTerm\n\n    nextPosition = 1\n\n    'First and Second terms as defined by your example.  Obviously, this will have to be more dynamic\n    'if you want to parse more than justpatientFirstname.\n    firstTerm = \"&lt;tag&gt;\"\n    secondTerm = \"&lt;/tag&gt;\"\n\n    'Get all the document text and store it in a variable.\n    Set myRange = ActiveDocument.Range\n    'Maximum limit of a string is 2 billion characters.\n    'So, hopefully your document is not bigger than that.  However, expect declining performance based on how big doucment is\n    documentText = myRange '.Text\n\n    'Loop documentText till you can't find any more matching \"terms\"\n    Do Until nextPosition = 0\n        startPos = InStr(nextPosition, documentText, firstTerm, vbTextCompare)\n        stopPos = InStr(startPos, documentText, secondTerm, vbTextCompare)\n        ActiveDocument.Range(Start:=startPos + Len(firstTerm), End:=stopPos - 1).Select ' = True\n        Debug.Print Selection.Text\n        nextPosition = InStr(stopPos, documentText, firstTerm, vbTextCompare)\n    Loop\nEnd Sub\n</code></pre>\n\n<p>to search and replace (I've not implemented the replace operation yet) the text between <code>&lt;tag&gt;</code> and <code>&lt;/tag&gt;</code> text inside the cells of a table.\nIt happens that each selection shifts some characters on the right.\nFor example, if I have:</p>\n\n<pre><code>| &lt;tag&gt;Bill&lt;/tag&gt; | &lt;tag&gt;Steve&lt;/tag&gt; | &lt;tag&gt;Mark&lt;/tag&gt; |  \n</code></pre>\n\n<p>I get on the console:</p>\n\n<pre><code>ill\neve&lt;\nk&lt;/t\n</code></pre>\n\n<p>How can I solve? </p>\n"}]