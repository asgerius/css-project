[{"tags": ["excel", "vba", "datediff"], "answers": [{"tags": [], "owner": {"reputation": 468, "user_id": 4628327, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MH5Ee.png?s=128&g=1", "display_name": "Ralph J", "link": "https://stackoverflow.com/users/4628327/ralph-j"}, "is_accepted": true, "score": 1, "last_activity_date": 1479017876, "last_edit_date": 1479017876, "creation_date": 1425515201, "answer_id": 28867832, "question_id": 28867021, "link": "https://stackoverflow.com/questions/28867021/multiple-vars-for-datediff-vba/28867832#28867832", "title": "Multiple Vars for DateDiff VBA", "body": "<p>The function <code>DateSerial(2015,3,4)</code> will return the date for 3/4/2015, and with both of your dates in that format, you can subtract the one date from the other, and if the (absolute value of the) difference is > 365 then you know that they are over a year apart.</p>\n\n<pre><code>Dim A As Date\nA = DateSerial(2015, 3, 4)\nDim B As Date\nB = DateSerial(2014, 3, 2)\nDim C As Integer\nC = Abs(A - B)\nMsgBox C &amp; \" days between\"\n</code></pre>\n"}], "owner": {"reputation": 237, "user_id": 1394265, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bb79e4567f525505f41f1ec9e18e01ac?s=128&d=identicon&r=PG", "display_name": "G3TH", "link": "https://stackoverflow.com/users/1394265/g3th"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 28867832, "answer_count": 1, "score": 0, "last_activity_date": 1479017876, "creation_date": 1425511142, "question_id": 28867021, "link": "https://stackoverflow.com/questions/28867021/multiple-vars-for-datediff-vba", "title": "Multiple Vars for DateDiff VBA", "body": "<p>I have a VBA script at the moment that reads in 6 values as integers.  3 values for date, month, and year and 3 of the same type from a different location.  I'd like to take the values and check if there has been more than a year to pass between them.  DateDiff seems like the easiest way to handle this, however that function reads in the values as one DateValue (ie March 20, 2015) and my values are returned individually (08,08,2015).\nI wrote a function that stores each value into a var and then using those individually I concat them into a format that DateValue can use.\nThis works, however I am curious if there is another(better) way to handle this problem?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["excel", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1425515584, "post_id": 28866608, "comment_id": 46000185, "body": "It&#39;s really hard to understand what your data looks like, as you can imagine. Could you maybe do a screenshot and post to imgur.com or a similar image sharing site. Someone with enough points can put the picture in your post. Also, have you tried writing any VBA to solve this problem yet? It sounds like VBA will probably be the way to go since the data is so complex."}, {"owner": {"reputation": 664, "user_id": 2977281, "user_type": "registered", "profile_image": "https://graph.facebook.com/561723379/picture?type=large", "display_name": "CustodianOfCode", "link": "https://stackoverflow.com/users/2977281/custodianofcode"}, "edited": false, "score": 0, "creation_date": 1425601176, "post_id": 28866608, "comment_id": 46041636, "body": "Few things you should consider. As mentioned, VBA. Use the split function like this: varArray = split(whatever,&quot;,&quot;) will split up a comma seperated string into an array."}, {"owner": {"reputation": 664, "user_id": 2977281, "user_type": "registered", "profile_image": "https://graph.facebook.com/561723379/picture?type=large", "display_name": "CustodianOfCode", "link": "https://stackoverflow.com/users/2977281/custodianofcode"}, "edited": false, "score": 0, "creation_date": 1425601176, "post_id": 28866608, "comment_id": 46041637, "body": "Few things you should consider. As mentioned, VBA. Use the split function like this: varArray = split(whatever,&quot;,&quot;) will split up a comma seperated string into an array. Also, data-&gt;text to cols. if you have a properly organised data set, this is the easiest way to split them up. But it sounds like maybe you need to work on the data format a bit first."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 4634255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0f074f7dbff6a8c76430210c7611c32?s=128&d=identicon&r=PG", "display_name": "Sarah", "link": "https://stackoverflow.com/users/4634255/sarah"}, "edited": false, "score": 0, "creation_date": 1428505629, "post_id": 29379626, "comment_id": 47191989, "body": "Thanks @guitarthrower that&#39;s just what I needed! I know I asked for more initially, it was more of a &quot;I&#39;m stuck on assigning a variable&quot; and if I got help with that I think I can figure the rest of it out, but if someone had a suggestion for going about the code in a better way then I&#39;d appreciate that as well."}, {"owner": {"reputation": 5277, "user_id": 156648, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2dc62782d79a90b829e96f36f48fe164?s=128&d=identicon&r=PG", "display_name": "guitarthrower", "link": "https://stackoverflow.com/users/156648/guitarthrower"}, "reply_to_user": {"reputation": 15, "user_id": 4634255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0f074f7dbff6a8c76430210c7611c32?s=128&d=identicon&r=PG", "display_name": "Sarah", "link": "https://stackoverflow.com/users/4634255/sarah"}, "edited": false, "score": 0, "creation_date": 1428507219, "post_id": 29379626, "comment_id": 47193174, "body": "Glad I could help. This site works best with specific questions. When things get broad, it&#39;s more difficult to answer questions. Welcome to SO, and post other questions as you get stuck."}], "tags": [], "owner": {"reputation": 5277, "user_id": 156648, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2dc62782d79a90b829e96f36f48fe164?s=128&d=identicon&r=PG", "display_name": "guitarthrower", "link": "https://stackoverflow.com/users/156648/guitarthrower"}, "is_accepted": true, "score": 0, "last_activity_date": 1427840638, "creation_date": 1427840638, "answer_id": 29379626, "question_id": 28866608, "link": "https://stackoverflow.com/questions/28866608/separating-columns-into-multiple-columns-excel2010/29379626#29379626", "title": "Separating columns into multiple columns excel2010", "body": "<p>You have a lot of information, but at the end of your post you state you need to assign a variable.</p>\n\n<p>First we need to declare a variable. You are attempting to declare <code>x</code> as text. Text isn't a data type in VBA, so we'll use <code>String</code>.</p>\n\n<pre><code>Dim x as String\n</code></pre>\n\n<p>Now we need to assign <code>x</code> a value. Here are 2 examples</p>\n\n<pre><code>x = \"assigned value\"  'assigned by hard-coding the value\nx = Sheets(\"Sheet2\").Range(\"A1\").Value  'assigned by using the value of A1 on Sheet2\n</code></pre>\n\n<p>Now you've got some other issues in your code (pasting without copying, started a Do loop without closing it), but you'll need to specifically ask where you need help. </p>\n"}], "owner": {"reputation": 15, "user_id": 4634255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0f074f7dbff6a8c76430210c7611c32?s=128&d=identicon&r=PG", "display_name": "Sarah", "link": "https://stackoverflow.com/users/4634255/sarah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 29379626, "answer_count": 1, "score": 1, "last_activity_date": 1427840638, "creation_date": 1425509190, "last_edit_date": 1531164843, "question_id": 28866608, "link": "https://stackoverflow.com/questions/28866608/separating-columns-into-multiple-columns-excel2010", "title": "Separating columns into multiple columns excel2010", "body": "<p>What I need to do: \nI have two columns in excel, (x) and (y) essentially\nThere are multiple data sets continuing down columns A &amp; B (it ranges, but the one I've been working on goes down to about ~80,000 and has roughly 8 data sets; the full data set would be much longer)</p>\n\n<p>**Screen Shot of what the data looks like here: </p>\n\n<p><img src=\"https://i.stack.imgur.com/L7GPI.png\" alt=\"enter image description here\"></p>\n\n<p>The values continue for about 200 cells, where the header (image name, image plane, etc) repeats, and the next plane's X and Y values are listed.</p>\n\n<p>**Screen shot of what I want it to look like here: </p>\n\n<p><img src=\"https://i.stack.imgur.com/73k9V.png\" alt=\"enter image description here\"></p>\n\n<p>**I've started to write the code with a \"Do Until\" loop but get stuck with how I can assign the stop to be at a cell either with text or with \"Image Name\" as the content. Either would work.</p>\n\n<p>I wanted to get this figured out before I move on to reading the next image data sets and pasting each set three columns apart on Sheet 2 (see screen shot of what I want it to look like).</p>\n\n<p>What I've written so far (and I know it's rather lacking because I'm struggling with parts of VBA to learn it):</p>\n\n<pre><code>Sub Test2()  \n    ' Test2 Macro  \n    ' Automating  \n\n    Dim X As Text Set X:= \"Image Name\"  \n\n    'Select cell A2, *first line of data*  \n    Range(\"A2\").Select   \n    'Set Do loop to stop when end of selection is reached   \n    Do Until X(ActiveCell)  \n        Selection.Copy  \n        Sheets(\"Sheet2\").Select  \n        ActiveSheet.Paste  \n        ' Step down 1 row from present location  \n        ActiveCell.Offset(1, 0).Seclect Loop  \nEnd Sub\n</code></pre>\n\n<p>I've been able to better understand some of the functions, but I'm still missing how to assign a variable. For instance, to make X equal the string \"Image Name\" and set Do until X so that the function of the Do loop works until it hits the \"image name\" cell content (or until it hits text, either would work.)</p>\n\n<p>Thanks a bunch for any suggestions! I'll still be working on this and trying to get it right so I'll update the code if I have anything more to add.</p>\n"}, {"tags": ["arrays", "vba", "jagged-arrays"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1425515668, "post_id": 28866465, "comment_id": 46000205, "body": "See Joshua&#39;s answer here: <a href=\"http://stackoverflow.com/questions/19633937/can-you-declare-jagged-arrays-in-excel-vba-directly\" title=\"can you declare jagged arrays in excel vba directly\">stackoverflow.com/questions/19633937/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 538, "user_id": 3460414, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1G8Fc.jpg?s=128&g=1", "display_name": "Ernesto Monroy", "link": "https://stackoverflow.com/users/3460414/ernesto-monroy"}, "is_accepted": false, "score": 1, "last_activity_date": 1434622800, "creation_date": 1434622800, "answer_id": 30912681, "question_id": 28866465, "link": "https://stackoverflow.com/questions/28866465/redim-jagged-arrays-vba/30912681#30912681", "title": "Redim Jagged Arrays VBA", "body": "<p>I was wondering the same thing! </p>\n\n<p>As you mention, I can only achieve this by creating a temporary array, redimensioning and then reassigning to the original jagged array. Here is my code:</p>\n\n<pre><code>Dim StaticArray(1 To 3, 1 To 4, 1 To 12) As Variant\nDim ArrayInput() As Variant\nDim TempArray() As Variant\n\nArrayInput = Array(1, 2, 3, 4, 5)\nStaticArray(1, 1, 1) = ArrayInput\n\n'Instead of redim, store array temporarily\nTempArray = StaticArray(1, 1, 1)\n\n'Redim the temporary\nReDim Preserve TempArray(UBound(TempArray) + 1)\n\n'Asign value\nTempArray(UBound(TempArray)) = 6\n\n'Then store again on statick array\nStaticArray(1, 1, 1) = TempArray\n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 3727269, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/29522f6d1f4a1cbae715a261f2bd6b91?s=128&d=identicon&r=PG&f=1", "display_name": "JSS", "link": "https://stackoverflow.com/users/3727269/jss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1232, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1434622800, "creation_date": 1425508560, "question_id": 28866465, "link": "https://stackoverflow.com/questions/28866465/redim-jagged-arrays-vba", "title": "Redim Jagged Arrays VBA", "body": "<p>Quick Question on Jagged Arrays.  I have a static container array that will not change in size:</p>\n\n<pre><code>Dim StaticArray(1 to 3, 1 to 4, 1 to 12) as variant\n</code></pre>\n\n<p>I am assigning array values to each index in the static array as follows:</p>\n\n<pre><code>Dim ArrayInput() as Variant\nArrayInput = Array(1,2,3,4,5)\nStaticArray(1,1,1) = ArrayInput\n</code></pre>\n\n<p>After assigning the array of values into StaticArray, I want the flexibility to add one more value to the ArrayInput Variable.  </p>\n\n<p>Is there any way to redim preserve the Variant contained in StaticArray(1,1,1)?  Something like:</p>\n\n<pre><code>Redim Preserve StaticArray(1 to 3, 1 to 4, 1 to 12)(1 to ubound(?)+1)\n</code></pre>\n\n<p>Or is the only option to modify the ArrayInput variable and re-read?</p>\n\n<p>Thanks! </p>\n"}, {"tags": ["vba", "ms-word", "office-2013"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1425508275, "post_id": 28866256, "comment_id": 45997610, "body": "I know this isn&#39;t the question you&#39;re asking, but if this is all one document then why do you want/need different styles for each section? Just reading the details in your question makes me think you&#39;re headed for a doc managment nightmare, and that&#39;s <i>without</i> involving end-users who won&#39;t begin to understand how it all works."}, {"owner": {"reputation": 33378, "user_id": 2437514, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/8QN0K.jpg?s=128&g=1", "display_name": "Rick supports Monica", "link": "https://stackoverflow.com/users/2437514/rick-supports-monica"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1425508951, "post_id": 28866256, "comment_id": 45997891, "body": "well, you make a good point. But the goal is to make it so that users don&#39;t have to know how it works. the document management nightmare is what I currently have, where each metasection is contained in a separate document. every time a revision is made for a report, a new copy of each document must be created. moving all of the separate documents into one document together would go a long way to waking up from this nightmare."}, {"owner": {"reputation": 33378, "user_id": 2437514, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/8QN0K.jpg?s=128&g=1", "display_name": "Rick supports Monica", "link": "https://stackoverflow.com/users/2437514/rick-supports-monica"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1425509072, "post_id": 28866256, "comment_id": 45997946, "body": "also, as for why each section has to have different styles, that is above my pay grade. Someone else has decided this for me."}, {"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 3, "creation_date": 1425537787, "post_id": 28866256, "comment_id": 46006372, "body": "Your idea is ok as long as you really feel it will work. Consider using the following collections in your project: <code>Sections</code> which are obvious. <code>ContentControls</code> to easier manage portion of documents and <code>BuildingBlocks</code> for quick insertion of schemas/themes/styles."}, {"owner": {"reputation": 33378, "user_id": 2437514, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/8QN0K.jpg?s=128&g=1", "display_name": "Rick supports Monica", "link": "https://stackoverflow.com/users/2437514/rick-supports-monica"}, "reply_to_user": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1425583535, "post_id": 28866256, "comment_id": 46033214, "body": "@KazJaw Great tips. What about bookmarks?"}, {"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 3, "creation_date": 1425623616, "post_id": 28866256, "comment_id": 46047208, "body": "<code>Bookmarks</code> in my opinion are designed mostly to get quick reference to a certain part of document. User can easily remove it. If you replace <code>bookmark</code> content with VBA bookmark, by default, will be remove which is a (small) problem. Both <code>BuildingBlocks</code> and <code>ContentControls</code> has some events on <code>Document object level</code> which give you a lot of opportunities to control, bloc, trigger actions as a result of user action. Check <a href=\"https://msdn.microsoft.com/en-us/library/ff841931(v=office.14).aspx\" rel=\"nofollow noreferrer\">this link for Document Events</a>"}, {"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 1, "creation_date": 1425623775, "post_id": 28866256, "comment_id": 46047260, "body": "you could also hava a look at <a href=\"http://stackoverflow.com/questions/21163867/restrict-lock-bookmarks-from-editing-in-word/21260907#21260907\">this (Restrict/Lock bookmarks from editing in word)</a> just for a quick idea of benefits of <code>ContentControls</code> and related events. There you will find a <code>Bookmark</code> solution as well."}, {"owner": {"reputation": 33378, "user_id": 2437514, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/8QN0K.jpg?s=128&g=1", "display_name": "Rick supports Monica", "link": "https://stackoverflow.com/users/2437514/rick-supports-monica"}, "reply_to_user": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1425658005, "post_id": 28866256, "comment_id": 46064846, "body": "@KazJaw This is great stuff, thanks a lot."}], "answers": [{"comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 3, "creation_date": 1431981109, "post_id": 30311907, "comment_id": 48719879, "body": "Oh, I just read the comment about someone above your paygrade deciding the need for many styles. Listen, IT excuses are the best excuses. Just tell him how much more complex and unusable the many-styles-way will be. Blame Word, and make up numbers about limitations. Explain to him that making his idea work will cost 1 billion dollars and 5 years and a shiny gemstone and a dragon&#39;s liver. Whereas if you stick with the basic formatting, it is cheap and fast. Keep blaming Word and Microsoft. Remember, you are a developer. That means you are a Wizard. And you don&#39;t argue with Wizards."}, {"owner": {"reputation": 862, "user_id": 3454860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36d8d587bb86f0014ebfb3c1f208f074?s=128&d=identicon&r=PG&f=1", "display_name": "Han Soalone", "link": "https://stackoverflow.com/users/3454860/han-soalone"}, "edited": false, "score": 2, "creation_date": 1432030221, "post_id": 30311907, "comment_id": 48740002, "body": "I have pretty similar project in the past and I have to say couple words of advice. 1) Expect many of the users to be so dumb they never learn use styles no matter how easy and if by miracle they do still they never can use them in the correct place. 2) Robust design is where user isn&#39;t required to make decision how things will look, more things can be predefined the better. User only should have to worry about the content, not the appearance. 3) Lock - lock everything that is possible to be locked from editing. Every little part that is possible to be edited will and is going to be misused."}, {"owner": {"reputation": 862, "user_id": 3454860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36d8d587bb86f0014ebfb3c1f208f074?s=128&d=identicon&r=PG&f=1", "display_name": "Han Soalone", "link": "https://stackoverflow.com/users/3454860/han-soalone"}, "edited": false, "score": 2, "creation_date": 1432031011, "post_id": 30311907, "comment_id": 48740483, "body": "4) Normal user whom says he/she knows and is familiar with word usually has ability to write, bold, size text and save document. Many users don&#39;t even realize there is more to the styles than just the appearance and they don&#39;t know about them. As @vacip stated, it&#39;s very important to educate all of them to use and specifically use this single document. 5) Explain to your superiors how difficult it is to manage updates and changes to complex document, it&#39;s not just that you create a document you&#39;ll also have to change it time to time."}, {"owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 0, "creation_date": 1432128458, "post_id": 30311907, "comment_id": 48794569, "body": "I agree on educating users. Also on locking everything what is possible (I remember once I had to manage documentation of several people, so I had a clever macro which worked. But then one user asked me to unlock one thing, I did that, and he misused a bit that thing so that my macro was useless from then :D ) I also agree on handing users a pre-filled example :)"}], "tags": [], "owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "is_accepted": true, "score": 7, "last_activity_date": 1431979542, "creation_date": 1431979542, "answer_id": 30311907, "question_id": 28866256, "link": "https://stackoverflow.com/questions/28866256/using-vba-to-manage-multiple-styles-definitions-in-the-same-word-document/30311907#30311907", "title": "Using VBA to manage multiple styles definitions in the same Word document", "body": "<p>Yes, in my opinion, you are making a mistake.\nI have just recently finished a project where I have created a document template for a company. My experiences:</p>\n\n<ul>\n<li>Users vary in knowledge level (obviously)</li>\n<li>High level users don't like over-engineered files, because they can't use their own macros as they might conflict with the file's own macros, they can't use their doc properties or their own building blocks etc., as these likely won't be compatible with the macros (or at least they think they won't work, and fiddle around until they actually manage to break them)</li>\n<li>low level users are intimidated by the automatisms, and keep avoiding them as long as they can (which means as long as their bosses don't order them to use the file), after which point they start hating the file and the work</li>\n<li>Complex solutions like this one usually get abandoned after a few years. Eg. the original developer changes jobs, or moves to another department, and nobody understands the code enough to keep managing it (especially if it is not a well-documented, well-written code, which it won't be, as you are not an experienced VBA programmer).</li>\n<li>The developer (you) will be inundated with (sometimes false) bug reports and questions and minor change requests, which gets really annoying after a few weeks (trust me on that :) ). They won't dare change even a font size without consulting you, and in the end, they will ask you to do it. Or, even worse, they try to change something, break it, and then tell you to fix your bug.</li>\n<li>Your users would have to remember to use section brakes or other kinds of indicators to indicate the next section. This will seem too much for some, too complex, and if they accidentally remove a section indicator (which they inevitably will), all hell brakes lose, and worst of all:</li>\n<li><strong>Undo function will be disabled</strong> after each macro run. This, to most users, is a disaster. You don't do that to your users.</li>\n</ul>\n\n<p>So I would say don't go down the macro route. <strong>Don't use Doc properties</strong>, that didn't work at the company I was working with. (Actually an IT company, with mostly high-level users :) ) The high-level users will create and use their own doc properties, for others, it is just a hassle. <strong>Bookmarks get constantly deleted, so no-go either</strong>.</p>\n\n<p><strong>My advice:</strong></p>\n\n<ul>\n<li>Use styles. Users will learn to use them quickly.\n<ul>\n<li>Get a decent document design. Having 4 different sets of title, heading and normal styles in one document is really unprofessional. <strong>Consistency</strong> is important, especially as this seems to be a letter to you clients. (Yes, I know, your company is different and your bosses are dumb and this is a special case and and and ... Just saying, talk to a designer, and get a professional look for your template.)</li>\n<li>You can manage the Style gallery (Home tab, centre) drop down list on a template basis - so your template will load the used styles into the dropdown at the top, and remove everything else. This works really good, and even as much as 20 styles is manageable, if they are well-named.</li>\n</ul></li>\n<li>Use building blocks: title pages, tables, pre-written and formatted Quick parts (legal mumbo-jumbo, company introduction, contacts, etc.), headers and footers...</li>\n</ul>\n\n<p><strong>And, if you want happy-happy and cooperative users:</strong></p>\n\n<ul>\n<li>After creating a blank template, create a full template:\n<ul>\n<li>Fill up a document template with texts, pre-written paragraphs, pre-written titles, so they will only have to click and rewrite, without the need to format or bother with styles and Cover pages and the lot</li>\n</ul></li>\n<li>Educate the users: 2 sessions of 1,5 hour Word class can go a long way. It is a must.</li>\n</ul>\n\n<p>Long post. One last thing: creating a complex Word template, you will be sailing a sea of Word bugs and annoyances. Even without writing macros, this won't be a walk in the park. (I for example gave up on making my TOC work in Office 2013, as after 3 days and 10 versions, it still kept on creating a maximum sized extra paragraph whenever it was inserted. Only in W2013. Still no idea why, but I let it go.)</p>\n\n<p>Whatever you decide to do, best of luck, and have a lot of patience! :)</p>\n"}], "owner": {"reputation": 33378, "user_id": 2437514, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/8QN0K.jpg?s=128&g=1", "display_name": "Rick supports Monica", "link": "https://stackoverflow.com/users/2437514/rick-supports-monica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1045, "favorite_count": 0, "accepted_answer_id": 30311907, "answer_count": 1, "score": 3, "last_activity_date": 1431979542, "creation_date": 1425507732, "last_edit_date": 1490004260, "question_id": 28866256, "link": "https://stackoverflow.com/questions/28866256/using-vba-to-manage-multiple-styles-definitions-in-the-same-word-document", "title": "Using VBA to manage multiple styles definitions in the same Word document", "body": "<p>TL/DR: I have a game plan on how to do this below; however, I am wondering if my plan is going to prove to be too complicated, and what additional considerations I need to take into account before diving into building this project. Although I am not an experienced programmer, I am NOT asking for code; I am asking for feedback from experienced Word VBA programmers as to whether my entire idea/approach is one huge mistake. </p>\n\n<p>I have a document \"template\" (not yet a template file type - I hope to create that as described below) for a report. The report is broken up into different sections: </p>\n\n<pre><code>Letter to the Client\nTable of Contents\nSection I\n    Title Page\n    Body\n        1.0\n        2.0\nSection II\n    Title Page\n    Body\n        1.0\n        2.0\nAppendix A\n    Title Page\n    Body\nAppendix B\n    Title Page\n    Body\n</code></pre>\n\n<p>I want each major \"metasection\" (such as Letter, Section I, Section II, Appendices) to have different styling and formatting. This could be accomplished by having multiple styles for each metasection, e.g.: </p>\n\n<pre><code>Normal-Letter\nNormal-SectionI\nNormal-Appendices\nHeading1-Letter\nHeading1-SectionI\nHeading1-Appendices \n</code></pre>\n\n<p>This would quickly become unmanageable. </p>\n\n<p>In order to avoid users having to wade through a huge number of styles to find the correct one (and it is worth noting that if users of this report have to do this, they will likely not use styles <em>AT ALL</em>), it would be nice if I could have the same style name (e.g, <code>Normal</code>) be different depending on which section of the document it is found in. Or said another way, I would like for a document to have multiple style sets depending on the section. </p>\n\n<p>The goals for the user experience are: </p>\n\n<ol>\n<li>The user simply applies the <code>Normal</code> style, <code>Heading1</code> style, etc, as necessary. </li>\n<li>Registered section-specific style definitions are updated when styles are edited via the <code>Modify Style</code> dialog box, or other ways. </li>\n<li>The styles are applied automatically and transparently when styles are changed, or when the document is opened, saved, or printed. </li>\n<li>ALTERNATIVE: If automatic/transparent style application proves too difficult, execute the style-application routine with a simple command button. </li>\n</ol>\n\n<p>My initial idea on how I might do this in VBA is:</p>\n\n<ol>\n<li>Write VBA code (probably a class) such that there is a style registry of <code>Normal</code>s and <code>Heading1</code>s, etc., for each document section.</li>\n<li>Write a style-application subroutine which iterates through the registered document sections, selects all the parts with each registered style, and applies the section-specific style from the style registry (preserving any styling that deviates from the style definition). </li>\n<li>Write a style-update subroutine that automatically and transparently updates the registered style definitions</li>\n<li>The style-application subroutine executes any time styling is applied anywhere in one of the registered sections (so I'll need to tie into Events here).</li>\n<li>The style-update subroutine executes any time a style definition in a registered section is changed (so here's another Event I'll need to monitor).</li>\n</ol>\n\n<p>I previously <a href=\"https://superuser.com/questions/880468/have-a-different-style-set-in-different-sections-of-the-same-word-document\">asked a similar question</a> about this topic on Superuser. The feedback I received has led me to believe that I can only accomplish the behavior I want using VBA, so I am now asking a follow-up question here on Stackoverflow. </p>\n\n<p>My question is: am I making a mistake here? I have a feeling there is a better way to solve this problem (perhaps using VBA, perhaps not) than this. </p>\n"}, {"tags": ["vba", "pdf", "save-as"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 3961580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bc3e372505452d20815138f2ac5fab0?s=128&d=identicon&r=PG&f=1", "display_name": "stark", "link": "https://stackoverflow.com/users/3961580/stark"}, "edited": false, "score": 0, "creation_date": 1425505586, "post_id": 28865555, "comment_id": 45996197, "body": "Thanks for the response. I do not enjoy programming on a Mac, I have been changing the file path and got rid of the &quot;C:\\&quot; and I can get it to my desktop. The problem I am having is retrieving the Username of the User to save it on their computer. Any suggestions?"}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1425505248, "creation_date": 1425505248, "answer_id": 28865555, "question_id": 28865495, "link": "https://stackoverflow.com/questions/28865495/saving-excel-pdf-in-the-same-file-path-for-different-users-vba-mac/28865555#28865555", "title": "Saving Excel PDF in the same file path for different users VBA (MAC)", "body": "<p>I am not really across Macs but don't you need a \\ after C: when you specify the filename?.</p>\n\n<p>Possibly you need one after QB Invoices too as I am not sure if that is the start of the filename or if it is a folder?</p>\n\n<p>Also does the Mac have the same environment variables as Windows? I am not 100% sure that this will work the way it does in Windows.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 3961580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bc3e372505452d20815138f2ac5fab0?s=128&d=identicon&r=PG&f=1", "display_name": "stark", "link": "https://stackoverflow.com/users/3961580/stark"}, "edited": false, "score": 0, "creation_date": 1425506249, "post_id": 28865649, "comment_id": 45996570, "body": "I am not sure if I used the &quot;Filename&quot; function correctly. Should I use &quot;Filename&quot; or should it be a different code?"}, {"owner": {"reputation": 38, "user_id": 3212716, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/81f252dff77ea0ce472ac5e6739467e8?s=128&d=identicon&r=PG&f=1", "display_name": "simon tan", "link": "https://stackoverflow.com/users/3212716/simon-tan"}, "reply_to_user": {"reputation": 13, "user_id": 3961580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bc3e372505452d20815138f2ac5fab0?s=128&d=identicon&r=PG&f=1", "display_name": "stark", "link": "https://stackoverflow.com/users/3961580/stark"}, "edited": false, "score": 0, "creation_date": 1425511211, "post_id": 28865649, "comment_id": 45998783, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/bb238907(v=office.12).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/bb238907(v=office.12).aspx</a> shows the function without commas. Try that."}], "tags": [], "owner": {"reputation": 38, "user_id": 3212716, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/81f252dff77ea0ce472ac5e6739467e8?s=128&d=identicon&r=PG&f=1", "display_name": "simon tan", "link": "https://stackoverflow.com/users/3212716/simon-tan"}, "is_accepted": false, "score": 0, "last_activity_date": 1425505578, "creation_date": 1425505578, "answer_id": 28865649, "question_id": 28865495, "link": "https://stackoverflow.com/questions/28865495/saving-excel-pdf-in-the-same-file-path-for-different-users-vba-mac/28865649#28865649", "title": "Saving Excel PDF in the same file path for different users VBA (MAC)", "body": "<p>Try changing Environ$(\"Username\") to Environ(\"Username\") instead. Where did the $ come from?. I would just save to the root folder to see if that works. If it does, then your path is incorrect.</p>\n"}], "owner": {"reputation": 13, "user_id": 3961580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bc3e372505452d20815138f2ac5fab0?s=128&d=identicon&r=PG&f=1", "display_name": "stark", "link": "https://stackoverflow.com/users/3961580/stark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 768, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1425505578, "creation_date": 1425505037, "question_id": 28865495, "link": "https://stackoverflow.com/questions/28865495/saving-excel-pdf-in-the-same-file-path-for-different-users-vba-mac", "title": "Saving Excel PDF in the same file path for different users VBA (MAC)", "body": "<p>I am having difficulty saving Each PDF in a specific folder for various users on our network. I want the code to save a PDF version of the worksheet in this location: Macintosh HD \u25b8 Users \u25b8 (Specific Username Saving the PDF) \u25b8 Dropbox \u25b8 Froghair \u25b8 QB Invoices</p>\n\n<p>This is the code I have so far, I cannot get it to save anything. Any help is greatly appreciated. Thanks in advance!</p>\n\n<pre><code>ActiveSheet.PageSetup.PrintArea = Range(\"A1:G90\")\n\nActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, filename:=\"C:Macintosh \nHD\\Users\\\" &amp; Environ$(\"Username\") &amp; \"\\Dropbox\\Froghair\\QB Invoices\" &amp; \nThisWorkbook.Name &amp; \"Invoice \" &amp; Range(\"F6\").Text &amp; \"_copy\", \nQuality:=xlQualityStandard, _\nIncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:= _\nTrue\n</code></pre>\n"}, {"tags": ["excel", "lookup", "excel-2013", "vba"], "answers": [{"comments": [{"owner": {"reputation": 970, "user_id": 4083998, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/a342180636ab2ef90f08e1c2ae9f0527?s=128&d=identicon&r=PG&f=1", "display_name": "Chad Portman", "link": "https://stackoverflow.com/users/4083998/chad-portman"}, "edited": false, "score": 0, "creation_date": 1425596505, "post_id": 28866372, "comment_id": 46039949, "body": "This is perfect for what I need thank you sir. One question though as I have not seen this before: What does the UCase do?"}, {"owner": {"reputation": 46, "user_id": 4272820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/320479aed2ab7fb5f820684410d67329?s=128&d=identicon&r=PG&f=1", "display_name": "Clay Mitchell", "link": "https://stackoverflow.com/users/4272820/clay-mitchell"}, "reply_to_user": {"reputation": 970, "user_id": 4083998, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/a342180636ab2ef90f08e1c2ae9f0527?s=128&d=identicon&r=PG&f=1", "display_name": "Chad Portman", "link": "https://stackoverflow.com/users/4083998/chad-portman"}, "edited": false, "score": 1, "creation_date": 1425597420, "post_id": 28866372, "comment_id": 46040286, "body": "It&#39;s changing all the characters to be uppercase, that way comparison isn&#39;t case sensitive."}, {"owner": {"reputation": 970, "user_id": 4083998, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/a342180636ab2ef90f08e1c2ae9f0527?s=128&d=identicon&r=PG&f=1", "display_name": "Chad Portman", "link": "https://stackoverflow.com/users/4083998/chad-portman"}, "edited": false, "score": 0, "creation_date": 1425604761, "post_id": 28866372, "comment_id": 46042673, "body": "Perfect forward thinking"}], "tags": [], "owner": {"reputation": 46, "user_id": 4272820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/320479aed2ab7fb5f820684410d67329?s=128&d=identicon&r=PG&f=1", "display_name": "Clay Mitchell", "link": "https://stackoverflow.com/users/4272820/clay-mitchell"}, "is_accepted": true, "score": 2, "last_activity_date": 1425508188, "creation_date": 1425508188, "answer_id": 28866372, "question_id": 28865019, "link": "https://stackoverflow.com/questions/28865019/finding-id-based-on-first-and-last-name/28866372#28866372", "title": "Finding ID based on first and last name", "body": "<p>Try this for the next button</p>\n\n<pre><code>Private Sub NextButton_Click()\n\nDim emptyRow As Long\nDim matchFound As Boolean\nDim matchCount As Long\nDim matchRow As Long\nDim i As Long\n\n'Determine the first empty cell in column E\nIf Cells(1, 5).Value = \"\" Then\n    emptyRow = 1\nElse\n    emptyRow = Cells(Columns(5).Rows.Count, 5).End(xlUp).Row + 1\nEnd If\n\nmatchFound = False\nmatchCount = 0\nmatchRow = 0\n\n'Loop through all of rows that have an employee id\nFor i = 1 To Cells(Columns(1).Rows.Count, 1).End(xlUp).Row\n    If (UCase(FirstName.Value) = UCase(Cells(i, 2).Value)) And (UCase(LastName.Value) = UCase(Cells(i, 3).Value)) Then\n        matchCount = matchCount + 1\n        matchRow = i\n        matchFound = True\n    End If\nNext\n\n'Alert user of any errors\nIf matchFound = False Then\n    MsgBox (\"There are no matching entries\")\nElseIf matchCount &gt; 1 Then\n    MsgBox (\"There were multiple matches\")\nElse\n'If there are no errors add employee id to the list\n    Cells(emptyRow, 5).Value = Cells(matchRow, 1).Value\n    emptyRow = emptyRow + 1\nEnd If\n\n'Clear the userform\nFirstName.Text = \"\"\nLastName.Text = \"\"\n\nEnd Sub\n</code></pre>\n\n<p>I'm not sure what the best course of action to take if there are multiple matches, so for now I just included a message to alert the sure. It wouldn't be hard to change the code to track each of the matched rows instead of just the last one.</p>\n"}, {"tags": [], "owner": {"reputation": 186, "user_id": 4585791, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3699aa68e22875c2560d9498947f462a?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Wertz", "link": "https://stackoverflow.com/users/4585791/robert-wertz"}, "is_accepted": false, "score": 0, "last_activity_date": 1425508397, "creation_date": 1425508397, "answer_id": 28866432, "question_id": 28865019, "link": "https://stackoverflow.com/questions/28865019/finding-id-based-on-first-and-last-name/28866432#28866432", "title": "Finding ID based on first and last name", "body": "<p>I would suggest using vlookup, as it's basically designed around your problem. It takes an input, finds it in one column, then outputs the same row in a different column. It shouldn't be difficult to make the output dependent on two vlookups matching to the same output.</p>\n\n<p><a href=\"http://www.howtogeek.com/howto/13780/using-vlookup-in-excel/\" rel=\"nofollow\">http://www.howtogeek.com/howto/13780/using-vlookup-in-excel/</a></p>\n"}], "owner": {"reputation": 970, "user_id": 4083998, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/a342180636ab2ef90f08e1c2ae9f0527?s=128&d=identicon&r=PG&f=1", "display_name": "Chad Portman", "link": "https://stackoverflow.com/users/4083998/chad-portman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1740, "favorite_count": 0, "accepted_answer_id": 28866372, "answer_count": 2, "score": 1, "last_activity_date": 1425508397, "creation_date": 1425503455, "last_edit_date": 1531164843, "question_id": 28865019, "link": "https://stackoverflow.com/questions/28865019/finding-id-based-on-first-and-last-name", "title": "Finding ID based on first and last name", "body": "<p>I have a list that contains Employee ID in Col A, First Name in Col B, Last Name in Col C. I am needing to write a macro that gives a userform to input First and Last Name and from there it will put the proper Employee ID into the first unused cell in Col E and then loop back to the userform.</p>\n\n<p>I already know how to build the Userform and will have two buttons on it one that reads \"Next\" and one that reads \"End\". The \"Next\" button will loop the Userform and the \"End\" will just close the Userform.</p>\n\n<p>Plan on leaving the Userform named Userform1 and naming the input boxes as \"FirstName\" and \"LastName\". So I know that to reference these from the macro I would call for Userform1.FirstName.Value or Userform1.LastName.Value depending on which part I need at the moment. </p>\n\n<p>The part I am not sure on is how to the matching of two variables and then looking to the left for the ID. I can move the ID Col to be after the name Cols if that helps but I am still not sure how to write so that both names must match.</p>\n\n<p>As for error trapping I planned on having a MsgBox state \"There are no matching entries.\" If the person does not exist in the list. However I am unsure of how to handle the super unlikely but possible situation of if two people on the list have the same name. So any suggestions for this would be greatly appreciated. </p>\n\n<p>I am using Excel 2013.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4634046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99f1d0aca539eb764e041941ce3d11eb?s=128&d=identicon&r=PG&f=1", "display_name": "user4634046", "link": "https://stackoverflow.com/users/4634046/user4634046"}, "edited": false, "score": 0, "creation_date": 1425504252, "post_id": 28865195, "comment_id": 45995515, "body": "Thanks! This seems like a good solution. I&#39;ll try this, and let you know how it goes!"}, {"owner": {"reputation": 5277, "user_id": 156648, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2dc62782d79a90b829e96f36f48fe164?s=128&d=identicon&r=PG", "display_name": "guitarthrower", "link": "https://stackoverflow.com/users/156648/guitarthrower"}, "reply_to_user": {"reputation": 13, "user_id": 4634046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99f1d0aca539eb764e041941ce3d11eb?s=128&d=identicon&r=PG&f=1", "display_name": "user4634046", "link": "https://stackoverflow.com/users/4634046/user4634046"}, "edited": false, "score": 0, "creation_date": 1425915625, "post_id": 28865195, "comment_id": 46146069, "body": "Did it work for you? If so, you should consider marking this as the answer so others can benefit."}], "tags": [], "owner": {"reputation": 5277, "user_id": 156648, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2dc62782d79a90b829e96f36f48fe164?s=128&d=identicon&r=PG", "display_name": "guitarthrower", "link": "https://stackoverflow.com/users/156648/guitarthrower"}, "is_accepted": true, "score": 1, "last_activity_date": 1425503989, "creation_date": 1425503989, "answer_id": 28865195, "question_id": 28865013, "link": "https://stackoverflow.com/questions/28865013/find-values-in-a-worksheet-with-two-criteria-matches-copy-them-and-paste-them-t/28865195#28865195", "title": "Find values in a worksheet with two criteria matches, copy them and paste them to another sheet with VBA", "body": "<p>The <code>index</code> formula combined with <code>match</code> is built just for this.</p>\n\n<p><code>Index</code> returns a value from a specified table when you provide a row and column.</p>\n\n<p><code>Match</code> is used to return the row/column based on criteria.</p>\n\n<p>So on the <code>Interface</code> sheet (assuming your data starts in Row 1) you can place the following formula in G1 and copy it down as needed.</p>\n\n<pre><code>=INDEX(Data!$D$5:$M$160,MATCH(E1,Data!$C$5:$C$160,0),MATCH(F1,Data!$D$4:$M$4,0))\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4634046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99f1d0aca539eb764e041941ce3d11eb?s=128&d=identicon&r=PG&f=1", "display_name": "user4634046", "link": "https://stackoverflow.com/users/4634046/user4634046"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1697, "favorite_count": 0, "accepted_answer_id": 28865195, "answer_count": 1, "score": 0, "last_activity_date": 1471362235, "creation_date": 1425503441, "question_id": 28865013, "link": "https://stackoverflow.com/questions/28865013/find-values-in-a-worksheet-with-two-criteria-matches-copy-them-and-paste-them-t", "title": "Find values in a worksheet with two criteria matches, copy them and paste them to another sheet with VBA", "body": "<p>Here is my problem:</p>\n\n<p>Sheet1 = \"Interface\". Sheet2 = \"Data\". </p>\n\n<p>Column C5:C160 in \"Data\" contains a list of tasks. \nRow D4:M4 in \"Data\" contains a list of position types (jobs), which I have labelled with \"job categories\" from 1-10. The range D5:M160 contains work-hours for each task and position type.</p>\n\n<p>Values in columns E and F in \"Interface\" are related to columns C and row 4 in \"Data\" through data validation. </p>\n\n<p>What I want to do is create an advanced filter that can copy values from D5:M160 in \"Data\" and paste these in column G in \"Interface\", if the values in columns E and F \"Interface\" match the values in column C and row 4 in \"Data\" respectively, simultaneously. </p>\n\n<p>This means that it should be a macro to copy and paste values with matching multiple criteria (two criteria) from one sheet to another.</p>\n\n<p>I have tried different things, with no success. I have also tried array formulas, vlookup and sumifs with multiple criteria, but none of these seem work. </p>\n\n<p>Any ideas?</p>\n\n<p>I appreciate your help!</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4634052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47d4b8339111d638e9b72dcb20909557?s=128&d=identicon&r=PG&f=1", "display_name": "user4634052", "link": "https://stackoverflow.com/users/4634052/user4634052"}, "edited": false, "score": 0, "creation_date": 1425604696, "post_id": 28865545, "comment_id": 46042650, "body": "Thanks so much for taking the time to answer me! I&#39;ll have to try it out! Thanks so much sir!!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1, "user_id": 4634052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47d4b8339111d638e9b72dcb20909557?s=128&d=identicon&r=PG&f=1", "display_name": "user4634052", "link": "https://stackoverflow.com/users/4634052/user4634052"}, "edited": false, "score": 0, "creation_date": 1425664324, "post_id": 28865545, "comment_id": 46068693, "body": "In place of <code>Dim arrSearch() As String</code> try just <code>Dim arrSearch</code>.  If that&#39;s not the problem then it would help to specify exactly where you get the error."}, {"owner": {"reputation": 1, "user_id": 4634052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47d4b8339111d638e9b72dcb20909557?s=128&d=identicon&r=PG&f=1", "display_name": "user4634052", "link": "https://stackoverflow.com/users/4634052/user4634052"}, "edited": false, "score": 0, "creation_date": 1425664676, "post_id": 28865545, "comment_id": 46068860, "body": "Sorry, I was trying to edit my comment and then I seen you replied. Apologies"}, {"owner": {"reputation": 1, "user_id": 4634052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47d4b8339111d638e9b72dcb20909557?s=128&d=identicon&r=PG&f=1", "display_name": "user4634052", "link": "https://stackoverflow.com/users/4634052/user4634052"}, "edited": false, "score": 0, "creation_date": 1425664755, "post_id": 28865545, "comment_id": 46068907, "body": "The error was coming up at the followng line --- arrSearch = xlApp.transpose(xlApp.activesheet.Range(&quot;A1:A14&quot;).Value)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1, "user_id": 4634052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47d4b8339111d638e9b72dcb20909557?s=128&d=identicon&r=PG&f=1", "display_name": "user4634052", "link": "https://stackoverflow.com/users/4634052/user4634052"}, "edited": false, "score": 0, "creation_date": 1425669880, "post_id": 28865545, "comment_id": 46071560, "body": "And is it still erroring after changing the variable declaration ?"}, {"owner": {"reputation": 1, "user_id": 4634052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47d4b8339111d638e9b72dcb20909557?s=128&d=identicon&r=PG&f=1", "display_name": "user4634052", "link": "https://stackoverflow.com/users/4634052/user4634052"}, "edited": false, "score": 0, "creation_date": 1425906387, "post_id": 28865545, "comment_id": 46139655, "body": "Hi, thanks for the update. when I change the variable declaration, it has a compile error (Expected array) when  it gets to For IngIndex = 1 To UBound (arr Search). Many thanks for your help so far!!!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1, "user_id": 4634052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47d4b8339111d638e9b72dcb20909557?s=128&d=identicon&r=PG&f=1", "display_name": "user4634052", "link": "https://stackoverflow.com/users/4634052/user4634052"}, "edited": false, "score": 0, "creation_date": 1425922334, "post_id": 28865545, "comment_id": 46150492, "body": "You have a space in there <code>UBound (arr Search)</code>  - is that in your code? The code I posted works in my testing."}, {"owner": {"reputation": 1, "user_id": 4634052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47d4b8339111d638e9b72dcb20909557?s=128&d=identicon&r=PG&f=1", "display_name": "user4634052", "link": "https://stackoverflow.com/users/4634052/user4634052"}, "edited": false, "score": 0, "creation_date": 1425924870, "post_id": 28865545, "comment_id": 46151873, "body": "Hi, sorry that was a typo, I don&#39;t have a space in the <code>Ubound (arrSearch)</code> code within the maco. I&#39;m using Office 2007 on a windows 7 machine if that would make a difference?"}, {"owner": {"reputation": 1, "user_id": 4634052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47d4b8339111d638e9b72dcb20909557?s=128&d=identicon&r=PG&f=1", "display_name": "user4634052", "link": "https://stackoverflow.com/users/4634052/user4634052"}, "edited": false, "score": 0, "creation_date": 1425927885, "post_id": 28865545, "comment_id": 46153493, "body": "Hi, updated code, now in the original question and the comile error (Expected array) happens at <code>For lngIndex = 1 To UBound(arrSearch)</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1, "user_id": 4634052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47d4b8339111d638e9b72dcb20909557?s=128&d=identicon&r=PG&f=1", "display_name": "user4634052", "link": "https://stackoverflow.com/users/4634052/user4634052"}, "edited": false, "score": 0, "creation_date": 1425930221, "post_id": 28865545, "comment_id": 46154709, "body": "Just <code>Dim arrSearch</code> not <code>As String</code>"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1425505220, "creation_date": 1425505220, "answer_id": 28865545, "question_id": 28864944, "link": "https://stackoverflow.com/questions/28864944/vba-using-excel-data-to-search-word-document-pasting-result-into-a-table/28865545#28865545", "title": "VBA using excel data to search word document &amp; pasting result into a table", "body": "<p>To populate the array with the values in colA of the active sheet in an open instance of Excel (note there can be only one insatance of excel open or it may get the wrong instance):</p>\n\n<p>Replace</p>\n\n<pre><code>arrSearch = Split(\"Nationwide,Phrase 2,Phrase 3\", \",\")\n</code></pre>\n\n<p>with</p>\n\n<pre><code>Dim xl As Object\nSet xl = GetObject(, \"Excel.Application\")\narrSearch = xl.transpose(xl.activesheet.Range(\"A1:A14\").Value)\n</code></pre>\n\n<p>and </p>\n\n<pre><code>For lngIndex = 0 To UBound(arrSearch)\n</code></pre>\n\n<p>with</p>\n\n<pre><code>For lngIndex = 1 To UBound(arrSearch)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4634052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47d4b8339111d638e9b72dcb20909557?s=128&d=identicon&r=PG&f=1", "display_name": "user4634052", "link": "https://stackoverflow.com/users/4634052/user4634052"}, "is_accepted": true, "score": 0, "last_activity_date": 1425934740, "creation_date": 1425934740, "answer_id": 28951625, "question_id": 28864944, "link": "https://stackoverflow.com/questions/28864944/vba-using-excel-data-to-search-word-document-pasting-result-into-a-table/28951625#28951625", "title": "VBA using excel data to search word document &amp; pasting result into a table", "body": "<p>Answer by the man, the legend Tim Williams!!!! Truly thankful!!!</p>\n\n<pre><code>   Sub CopyKeywordPlusContext()\n'Modified 2-17-2015 GKM\n'Makro created on 22.01.2013\nDim oDoc As Document, oDocRecord As Document\nDim strSearch As String, arrSearch\nDim lngCharTrailing As Long, lngCharLeading As Long, lngIndex As Long, lngCount As Long\nDim lngPgNum, lngLineNum As Integer\nDim oRng As Word.Range, oRngSpan As Word.Range\nDim bFound As Boolean\nDim oTbl As Word.Table\n  strSearch = vbNullString\nDim xl As Object\nSet xl = GetObject(, \"Excel.Application\")\narrSearch = xl.transpose(xl.activesheet.Range(\"A1:A14\").Value)\n  lngCharLeading = 20\n  lngCharTrailing = 20\n  Set oDoc = ActiveDocument\n  For lngIndex = 1 To UBound(arrSearch)\n    ResetFRParams\n    bFound = False\n    lngCount = 0\n    Set oRng = oDoc.Range\n    With oRng.Find\n      .Text = LCase(arrSearch(lngIndex))\n      While .Execute\n        bFound = True\n        If oDocRecord Is Nothing Then\n          Set oDocRecord = Documents.Add\n          Set oTbl = oDocRecord.Tables.Add(oDocRecord.Range, 1, 2)\n        End If\n        lngCount = lngCount + 1\n        If lngCount = 1 Then\n          oTbl.Rows.Add\n          With oTbl.Rows.Last.Previous\n            .Cells.Merge\n            With .Cells(1).Range\n              .Text = \"Search results for \"\"\" &amp; arrSearch(lngIndex) &amp; \"\"\" + context in \" &amp; \"\"\"\" &amp; oDoc.Name &amp; \"\"\"\"\n              .Font.Bold = True\n            End With\n          End With\n        End If\n        Set oRngSpan = oRng.Duplicate\n        oRngSpan.Select\n        lngPgNum = Selection.Information(wdActiveEndPageNumber)\n        lngLineNum = Selection.Information(wdFirstCharacterLineNumber)\n        With oRngSpan\n          .MoveStart wdCharacter, -lngCharLeading\n          .MoveEnd wdCharacter, lngCharTrailing\n          Do While oRngSpan.Characters.First = vbCr\n            oRngSpan.MoveStart wdCharacter, -1\n          Loop\n          Do While oRngSpan.Characters.Last = vbCr\n            oRngSpan.MoveEnd wdCharacter, 1\n            If oRngSpan.End = oDoc.Range.End Then\n              oRngSpan.End = oRngSpan.End - 1\n              Exit Do\n            End If\n          Loop\n        End With\n        oTbl.Rows.Last.Range.Cells(1).Range.Text = Trim(oRngSpan.Text)\n        oTbl.Rows.Last.Range.Cells(2).Range.Text = \"Page: \" &amp; lngPgNum &amp; \" Line: \" &amp; lngLineNum\n        oTbl.Rows.Add\n      Wend\n    End With\n    If bFound Then\n      ResetFRParams\n      With oDocRecord.Range.Find\n        .Text = LCase(arrSearch(lngIndex))\n        .Replacement.Text = \"^&amp;\"\n        .Replacement.Highlight = True\n        .Format = True\n        .Execute Replace:=wdReplaceAll\n      End With\n    End If\n  Next lngIndex\n  oTbl.Rows.Last.Delete\nEnd Sub\nSub ResetFRParams()\n  With Selection.Find\n    .ClearFormatting\n    .Replacement.ClearFormatting\n    .Text = \"\"\n    .Replacement.Text = \"\"\n    .Replacement.Highlight = False\n    .Forward = True\n    .Wrap = wdFindStop\n    .Format = False\n    .MatchCase = False\n    .MatchWholeWord = False\n    .MatchWildcards = False\n    .MatchSoundsLike = False\n    .MatchAllWordForms = False\n    .Execute\n  End With\nlbl_Exit:\n  Exit Sub\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4634052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47d4b8339111d638e9b72dcb20909557?s=128&d=identicon&r=PG&f=1", "display_name": "user4634052", "link": "https://stackoverflow.com/users/4634052/user4634052"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1134, "favorite_count": 1, "accepted_answer_id": 28951625, "answer_count": 2, "score": 0, "last_activity_date": 1425934740, "creation_date": 1425503216, "last_edit_date": 1531164843, "question_id": 28864944, "link": "https://stackoverflow.com/questions/28864944/vba-using-excel-data-to-search-word-document-pasting-result-into-a-table", "title": "VBA using excel data to search word document &amp; pasting result into a table", "body": "<p>So I want to be able to search a word document (roughly 300 pages) and find certain phrases (one word or two words seperated by a space) (eg: Nationwide/Phrase 2/Phrase 3) which I have in column 'A' of a separate excel document (C:/Test.xlsx). Then this 'phrase' would be coiped and pasted into a table in another word document along with the context (20 characters before &amp; after the 'phrase') along the page/line number it was found. Now someone (and I'm truly thankful) had created the following macro which used an array. Unfortunatley there could be approx 100-200 words that I would be looking for and I can't get it to include them all in the array or use the excel document as the data.</p>\n\n<p>Here is the code so far</p>\n\n<p>Many thanks for looking at this!!!!!</p>\n\n<pre><code>    Sub CopyKeywordPlusContext()\n'Modified 2-17-2015 GKM\n'Makro created on 22.01.2013\nDim oDoc As Document, oDocRecord As Document\nDim strSearch As String, arrSearch\nDim lngCharTrailing As Long, lngCharLeading As Long, lngIndex As Long, lngCount As Long\nDim lngPgNum, lngLineNum As Integer\nDim oRng As Word.Range, oRngSpan As Word.Range\nDim bFound As Boolean\nDim oTbl As Word.Table\n  strSearch = vbNullString\nDim xl As Object\nSet xl = GetObject(, \"Excel.Application\")\narrSearch = xl.transpose(xl.activesheet.Range(\"A1:A14\").Value)\n  lngCharLeading = 20\n  lngCharTrailing = 20\n  Set oDoc = ActiveDocument\n  For lngIndex = 1 To UBound(arrSearch)\n    ResetFRParams\n    bFound = False\n    lngCount = 0\n    Set oRng = oDoc.Range\n    With oRng.Find\n      .Text = LCase(arrSearch(lngIndex))\n      While .Execute\n        bFound = True\n        If oDocRecord Is Nothing Then\n          Set oDocRecord = Documents.Add\n          Set oTbl = oDocRecord.Tables.Add(oDocRecord.Range, 1, 2)\n        End If\n        lngCount = lngCount + 1\n        If lngCount = 1 Then\n          oTbl.Rows.Add\n          With oTbl.Rows.Last.Previous\n            .Cells.Merge\n            With .Cells(1).Range\n              .Text = \"Search results for \"\"\" &amp; arrSearch(lngIndex) &amp; \"\"\" + context in \" &amp; \"\"\"\" &amp; oDoc.Name &amp; \"\"\"\"\n              .Font.Bold = True\n            End With\n          End With\n        End If\n        Set oRngSpan = oRng.Duplicate\n        oRngSpan.Select\n        lngPgNum = Selection.Information(wdActiveEndPageNumber)\n        lngLineNum = Selection.Information(wdFirstCharacterLineNumber)\n        With oRngSpan\n          .MoveStart wdCharacter, -lngCharLeading\n          .MoveEnd wdCharacter, lngCharTrailing\n          Do While oRngSpan.Characters.First = vbCr\n            oRngSpan.MoveStart wdCharacter, -1\n          Loop\n          Do While oRngSpan.Characters.Last = vbCr\n            oRngSpan.MoveEnd wdCharacter, 1\n            If oRngSpan.End = oDoc.Range.End Then\n              oRngSpan.End = oRngSpan.End - 1\n              Exit Do\n            End If\n          Loop\n        End With\n        oTbl.Rows.Last.Range.Cells(1).Range.Text = Trim(oRngSpan.Text)\n        oTbl.Rows.Last.Range.Cells(2).Range.Text = \"Page: \" &amp; lngPgNum &amp; \" Line: \" &amp; lngLineNum\n        oTbl.Rows.Add\n      Wend\n    End With\n    If bFound Then\n      ResetFRParams\n      With oDocRecord.Range.Find\n        .Text = LCase(arrSearch(lngIndex))\n        .Replacement.Text = \"^&amp;\"\n        .Replacement.Highlight = True\n        .Format = True\n        .Execute Replace:=wdReplaceAll\n      End With\n    End If\n  Next lngIndex\n  oTbl.Rows.Last.Delete\nEnd Sub\nSub ResetFRParams()\n  With Selection.Find\n    .ClearFormatting\n    .Replacement.ClearFormatting\n    .Text = \"\"\n    .Replacement.Text = \"\"\n    .Replacement.Highlight = False\n    .Forward = True\n    .Wrap = wdFindStop\n    .Format = False\n    .MatchCase = False\n    .MatchWholeWord = False\n    .MatchWildcards = False\n    .MatchSoundsLike = False\n    .MatchAllWordForms = False\n    .Execute\n  End With\nlbl_Exit:\n  Exit Sub\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1425502019, "post_id": 28864479, "comment_id": 45994228, "body": "<code>I know it&#39;s being skipped bc a message box</code> - that is no good, please use the debugger. The key is <code>F8</code>."}, {"owner": {"reputation": 468, "user_id": 4628327, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MH5Ee.png?s=128&g=1", "display_name": "Ralph J", "link": "https://stackoverflow.com/users/4628327/ralph-j"}, "edited": false, "score": 2, "creation_date": 1425502459, "post_id": 28864479, "comment_id": 45994467, "body": "What does the GoTo Skip1 accomplish?  Try commenting that out and see if things work better.  (Having a blank THEN action before the ELSE is legal.)  GoTo statements can mess things up, and this one serves no obvious purpose.  Definitely use the debugger -- put the red Stop Sign in the left column &amp; then F8 t step through your code to see what&#39;s happening."}, {"owner": {"reputation": 379, "user_id": 3779705, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GgjLS.jpg?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/3779705/james"}, "edited": false, "score": 0, "creation_date": 1425502676, "post_id": 28864479, "comment_id": 45994585, "body": "the purpose for the Skip1 is to skip the  x variable counter and continue to the next cell."}, {"owner": {"reputation": 379, "user_id": 3779705, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GgjLS.jpg?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/3779705/james"}, "edited": false, "score": 0, "creation_date": 1425502741, "post_id": 28864479, "comment_id": 45994632, "body": "my bigger issue is that the code isn&#39;t even get picked up...i have done the debugger and put a stop after For Each Name In ActiveWorkbook.Names and it&#39;s not being stopped there"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1425503247, "post_id": 28864479, "comment_id": 45994941, "body": "Then put a breakpoint above there and see why the condition to enter the loop is not being met. (Set a breakpoint at <code>If Sheet1.NewResource.Value = True Then</code> and step through the code from there to see what&#39;s happening. We can&#39;t do that for you, because we don&#39;t have the spreadsheet to use to do so.)"}, {"owner": {"reputation": 1918, "user_id": 3929829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cceip.jpg?s=128&g=1", "display_name": "Captain", "link": "https://stackoverflow.com/users/3929829/captain"}, "edited": false, "score": 0, "creation_date": 1425503886, "post_id": 28864479, "comment_id": 45995313, "body": "Not on my computer so can&#39;t check, but doesn&#39;t the .name give you a string of the address... I.e. Use Name.RefersToRange (or something) gives the actual range object containing cells"}, {"owner": {"reputation": 468, "user_id": 4628327, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MH5Ee.png?s=128&g=1", "display_name": "Ralph J", "link": "https://stackoverflow.com/users/4628327/ralph-j"}, "edited": false, "score": 0, "creation_date": 1425506389, "post_id": 28864479, "comment_id": 45996640, "body": "The ELSE statement will cause the x=x+1 statement to be skipped over anyway when the IF condition evaluates as TRUE.  The GoTo is unnecessary.  Concur that Name isn&#39;t what you want to call your variable!"}], "answers": [{"comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1425512810, "post_id": 28865464, "comment_id": 45999295, "body": "<code>Name</code> is a context-dependent keyword. It is only a keyword in the <code>Name ... As ...</code> clause and not a keyword anywhere else. It is okay to have a variable named <code>Name</code>. You can even do <code>Name Name As Name</code>."}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1425504940, "creation_date": 1425504940, "answer_id": 28865464, "question_id": 28864479, "link": "https://stackoverflow.com/questions/28864479/for-loop-being-skipped-over/28865464#28865464", "title": "For Loop Being Skipped Over", "body": "<p>Don't use name it is a reserved word (you can rename files with Name File1 as File2).</p>\n\n<p>Change the variable name to MyName or something similar then if you continue to experience the issue, put a stop on the code and evaluate the loop manually in the debug wind (CTRL-G) by typing ?activeworkbook.Names.Count and pressing enter (don't forget the ?) and see if you have a number above zero.</p>\n"}, {"tags": [], "owner": {"reputation": 1918, "user_id": 3929829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cceip.jpg?s=128&g=1", "display_name": "Captain", "link": "https://stackoverflow.com/users/3929829/captain"}, "is_accepted": true, "score": 1, "last_activity_date": 1425539272, "last_edit_date": 1425539272, "creation_date": 1425538949, "answer_id": 28871844, "question_id": 28864479, "link": "https://stackoverflow.com/questions/28864479/for-loop-being-skipped-over/28871844#28871844", "title": "For Loop Being Skipped Over", "body": "<p>For me, the <code>Name</code> in the for loop gives something like <code>=Sheet1!$G$2:$G$5</code> ... this doesn't match your <code>C_R</code> or whatever. I need to use <code>Name.Name</code> to get that. And then to get the range of cells for the name, I need to use <code>Name.RefersToRange</code>.</p>\n\n<p>Also, to make your <code>If</code> list easier to manage, you could use <code>Select Case</code> instead:</p>\n\n<pre><code>  Select Case Name.Name\n    Case \"C_LN\", \"C_FN\", \"C_SD\",  \"C_ED\", \"C_O\", \"C_D\", \"C_OF\", \"C_C\", \"C_M\", \"C_R\", \"C_PT\", \"C_V\", \"C_SAR\", \"C_BAR\", \"C_SR\", \"C_SS\", \"C_PO\"\n      For Each cell In Name.RefersToRange\n        Debug.Print cell.Address\n      Next cell\n    Case Else\n      Debug.Print \"Other Name\"\n  End Select\n</code></pre>\n"}], "owner": {"reputation": 379, "user_id": 3779705, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GgjLS.jpg?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/3779705/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 28871844, "answer_count": 2, "score": 0, "last_activity_date": 1425539272, "creation_date": 1425501673, "last_edit_date": 1531161705, "question_id": 28864479, "link": "https://stackoverflow.com/questions/28864479/for-loop-being-skipped-over", "title": "For Loop Being Skipped Over", "body": "<p>I have not been able to figure out why the For Loop block (with two for loops) is being skipped over by the code. I know it's being skipped bc a message box is being tripped further down in the code. Any thoughts?</p>\n\n<pre><code>Dim OL As Outlook.Application\nDim myitem As Outlook.MailItem\nDim wb As Workbook\nDim ws As Worksheet\nDim PicPath As String\nDim x, y As Integer\nDim Name As Name\nDim cell, rng1 As Range\n\n\nSet wb = ActiveWorkbook\nSet ws = wb.Sheets(\"Sheet1\")\n\nwb.Sheets(\"Sheet1\").Activate\n\n'Request type check\nIf (Sheet1.NewResource.Value = False) And (Sheet1.Modification.Value = False) Then\n    MsgBox \"Please select a Request Type of your request and complete the other mandatory fields\"\n    GoTo cont\nEnd If\n\n'checking New Resource Entry mandatory fields\nIf Sheet1.NewResource.Value = True Then\n\n    If (Sheet1.NewPOnobx.Value = False) And (Sheet1.NewPOyesbx.Value = False) Then\n        MsgBox \"Please fill the missing mandatory fields\"\n        GoTo cont\n    End If\n\n    If (Sheet1.POyesbx.Value = False) And (Sheet1.POnobx.Value = False) Then\n        MsgBox \"Please fill the missing mandatory fields\"\n        GoTo cont\n    End If\n\n    If (Sheet1.POnobx.Value = True) And (Sheet1.SOWtxt.Value = \"\") Then\n        MsgBox \"Please select a copy of the Signed Agreement\"\n        GoTo cont\n    End If\n\n    For Each Name In ActiveWorkbook.Names 'each named range in gateway fields\n        If (Name = \"C_LN\") Or (Name = \"C_FN\") Or (Name = \"C_SD\") Or (Name =  \"C_ED\") Or (Name = \"C_O\") Or (Name = \"C_D\") Or (Name = \"C_OF\") Or (Name = \"C_C\") Or (Name = \"C_M\") Or _\n        (Name = \"C_R\") Or (Name = \"C_PT\") Or (Name = \"C_V\") Or (Name = \"C_SAR\") Or (Name = \"C_BAR\") Or (Name = \"C_SR\") Or (Name = \"C_SS\") Or (Name = \"C_PO\") Then 'all gateway field names\n            x = 0\n            For Each cell In Name 'cell in the named range\n                If cell.Value = \"\" Then 'looking for blank mandatory fields\n                    If (cell.Name = \"LN_Cmt\") Or (cell.Name = \"FN_Cmt\") Or (cell.Name = \"SD_Cmt\") Or (cell.Name = \"ED_Cmt\") Or (cell.Name = \"O_Cmt\") Or _\n                    (cell.Name = \"D_Cmt\") Or (cell.Name = \"OF_Cmt\") Or (cell.Name = \"C_Cmt\") Or (cell.Name = \"M_Cmt\") Or (cell.Name = \"R_Cmt\") Or _\n                    (cell.Name = \"PT_Cmt\") Or (cell.Name = \"V_Cmt\") Or (cell.Name = \"SAR_Cmt\") Or (cell.Name = \"BAR_Cmt\") Or (cell.Name = \"SR_Cmt\") Or _\n                    (cell.Name = \"SS_Cmt\") Or (cell.Name = \"PO_Cmt\") Then\n                        GoTo skip1\n                    Else\n                        x = x + 1 '+1 for a blank mandatory field\n                    End If\n                End If\nskip1:\n            Next cell\n\n                If x &gt; 0 Then 'flag the missing info\n                    MsgBox \"Please fill the missing mandatory fields\"\n                    GoTo cont\n                End If\n\n            End If\n        Next Name\n\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba", "olap", "olap-cube"], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 4633908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7150463dfc916c35181b6273fcd8cfb?s=128&d=identicon&r=PG", "display_name": "Xeeq", "link": "https://stackoverflow.com/users/4633908/xeeq"}, "edited": false, "score": 0, "creation_date": 1426524949, "post_id": 28975798, "comment_id": 46398099, "body": "Thank you very much for your response.  I set up a table using your method above, but it is not what I was looking for.  I may be using the wrong terminology whenever I say &quot;Cube&quot;.  The &quot;Cube&quot; that each client has is showing up in the SSAS_Database_Name column, so it is only showing the one that I choose.  How can I have this list show me all of the server&#39;s available &quot;Catalogs&quot; or SSAS Databases in column A?  This would be what I need."}, {"owner": {"reputation": 5343, "user_id": 2514839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XpyI6.png?s=128&g=1", "display_name": "mmarie", "link": "https://stackoverflow.com/users/2514839/mmarie"}, "reply_to_user": {"reputation": 9, "user_id": 4633908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7150463dfc916c35181b6273fcd8cfb?s=128&d=identicon&r=PG", "display_name": "Xeeq", "link": "https://stackoverflow.com/users/4633908/xeeq"}, "edited": false, "score": 0, "creation_date": 1426528155, "post_id": 28975798, "comment_id": 46400174, "body": "Ok, I put a query at the end that should help you."}, {"owner": {"reputation": 9, "user_id": 4633908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7150463dfc916c35181b6273fcd8cfb?s=128&d=identicon&r=PG", "display_name": "Xeeq", "link": "https://stackoverflow.com/users/4633908/xeeq"}, "edited": false, "score": 0, "creation_date": 1426529708, "post_id": 28975798, "comment_id": 46401122, "body": "Wow, that did it. Our Database Admin said that this could not be done easily.  I cannot wait to show him this. Thank you so much!"}, {"owner": {"reputation": 9, "user_id": 4633908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7150463dfc916c35181b6273fcd8cfb?s=128&d=identicon&r=PG", "display_name": "Xeeq", "link": "https://stackoverflow.com/users/4633908/xeeq"}, "edited": false, "score": 0, "creation_date": 1430398946, "post_id": 28975798, "comment_id": 48056502, "body": "This method above worked great.  I now use this in many different applications.  Using this same method, is there a way to pull a list of all of the Dimensions and Measures inside the cubes?"}, {"owner": {"reputation": 5343, "user_id": 2514839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XpyI6.png?s=128&g=1", "display_name": "mmarie", "link": "https://stackoverflow.com/users/2514839/mmarie"}, "reply_to_user": {"reputation": 9, "user_id": 4633908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7150463dfc916c35181b6273fcd8cfb?s=128&d=identicon&r=PG", "display_name": "Xeeq", "link": "https://stackoverflow.com/users/4633908/xeeq"}, "edited": false, "score": 0, "creation_date": 1430413314, "post_id": 28975798, "comment_id": 48067110, "body": "Yes, there are DMVs for measures ($SYSTEM.MDSCHEMA_MEASURES) and dimensions ($SYSTEM.MDSCHEMA_DIMENSIONS). The <a href=\"http://www.mssqltips.com/sqlservertip/3006/sql-server-2012-analysis-services-ssas-dmvs/\" rel=\"nofollow noreferrer\">link</a> in my answer has the queries for them. You can query a particular cube or all cubes on a database."}, {"owner": {"reputation": 9, "user_id": 4633908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7150463dfc916c35181b6273fcd8cfb?s=128&d=identicon&r=PG", "display_name": "Xeeq", "link": "https://stackoverflow.com/users/4633908/xeeq"}, "edited": false, "score": 0, "creation_date": 1430742350, "post_id": 28975798, "comment_id": 48176346, "body": "I have searched online for a solution to pull out the Measures and Dimensions from all of the catalogs into one list, but I cannot find anything.  Do you know if this is possible?"}], "tags": [], "owner": {"reputation": 5343, "user_id": 2514839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XpyI6.png?s=128&g=1", "display_name": "mmarie", "link": "https://stackoverflow.com/users/2514839/mmarie"}, "is_accepted": false, "score": 4, "last_activity_date": 1580501403, "last_edit_date": 1580501403, "creation_date": 1426029272, "answer_id": 28975798, "question_id": 28864254, "link": "https://stackoverflow.com/questions/28864254/using-vba-in-excel-how-do-i-get-the-names-of-all-olap-cubes-on-a-server/28975798#28975798", "title": "Using VBA in Excel, how do I get the names of all OLAP Cubes on a server?", "body": "<p>The SSAS Server has <a href=\"http://www.mssqltips.com/sqlservertip/3006/sql-server-2012-analysis-services-ssas-dmvs/\" rel=\"nofollow noreferrer\">DMVs</a> that you can query to determine the number of cubes on a server. Then you can use VBA to compare that to the number of rows in the table before. Follow <a href=\"https://gqbi.wordpress.com/2013/09/04/excel-using-a-custom-mdx-query-in-excel-table/\" rel=\"nofollow noreferrer\">these instructions</a> to make the connection, or see below.</p>\n\n<ol>\n<li>Create a new connection in Excel: In the Get External Data section choose From Other Sources -> SQL Server (NOT Analysis Services). </li>\n<li>Enter connection information for any SQL Server to which you can connect (we'll change this info in a later step). </li>\n<li>Pick any database and table to which you have access. Move through the wizard and choose Only save connection at the end.  </li>\n<li>Click Connections. Find your connection and click the Properties button. </li>\n<li><p>On the Definition tab, update the connnection string to look like</p>\n\n<pre><code>Provider=MSOLAP.5;Integrated Security=SSPI;Persist Security Info=True;Initial Catalog=SSASDB;Data Source=MyServer\\MyInstance;MDX Compatibility=1;Safety Options=2;MDX Missing Member Mode=Error\n</code></pre></li>\n<li><p>Change the Command Type to Default</p></li>\n<li><p>Change the command text to the following: </p>\n\n<pre><code>SELECT \n[CATALOG_NAME] AS SSAS_Database_Name,\n[CUBE_NAME] AS Cube_or_Perspective_Name,\n[CUBE_CAPTION] AS Cube_or_Perspective_Caption,\n[CUBE_TYPE] AS Cube_Type,\n[BASE_CUBE_NAME] AS Base_Cube\nFROM \n$SYSTEM.MDSCHEMA_CUBES\nWHERE\nCUBE_SOURCE=1\nAND\n[BASE_CUBE_NAME] &lt; ''\n</code></pre></li>\n<li><p>Click OK and then click Close. </p></li>\n<li><p>Click Existing Connections. Choose your connection. </p></li>\n<li><p>Choose Table on the Import Data Window. Choose to Put your table on a new worksheet. </p></li>\n<li><p>Your table should be in columns A through E. In cell G2 put <code>Prior Row Count:</code></p></li>\n<li><p>In cell G3 put <code>Current Row Count:</code></p></li>\n<li><p>In cell H2 put 0. </p></li>\n<li><p>In cell H3, enter the following formula: </p>\n\n<pre><code>=COUNTA(Table_ExternalData_1[SSAS_Database_Name])\n</code></pre></li>\n<li><p>Write a macro that copies the value from cell H3 to H2 and then refreshes the data connection for the table. Mine looks like this: </p>\n\n<pre><code>Sub UpdateCubeCount()\n    Range(\"H3\").Select\n    Selection.Copy\n    Range(\"H2\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Range(\"B2\").Select\n    Application.CutCopyMode = False\n    Selection.ListObject.QueryTable.Refresh BackgroundQuery:=False\nEnd Sub\n</code></pre></li>\n<li><p>As a bonus, add conditional formatting to cell H3. Format it to have pink background and red text for the rule Cell Value > $H$2. </p></li>\n</ol>\n\n<p>You end up with something that looks like this:  </p>\n\n<p><img src=\"https://i.stack.imgur.com/pTlQ1.jpg\" alt=\"enter image description here\"></p>\n\n<p>Update: If you are looking for the SSAS databases rather than the cubes themselves, you can use this query instead of the one in step 7: </p>\n\n<pre><code>SELECT [catalog_name] AS SSAS_Database_Name, [date_modified] \nFROM $system.DBSCHEMA_CATALOGS\n</code></pre>\n\n<p>This would be useful if you can assume you only have one cube per database, which is fairly common.</p>\n"}], "owner": {"reputation": 9, "user_id": 4633908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7150463dfc916c35181b6273fcd8cfb?s=128&d=identicon&r=PG", "display_name": "Xeeq", "link": "https://stackoverflow.com/users/4633908/xeeq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2681, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1584009912, "creation_date": 1425500879, "last_edit_date": 1584009912, "question_id": 28864254, "link": "https://stackoverflow.com/questions/28864254/using-vba-in-excel-how-do-i-get-the-names-of-all-olap-cubes-on-a-server", "title": "Using VBA in Excel, how do I get the names of all OLAP Cubes on a server?", "body": "<p>The company creates an OLAP Cube Database for each of our clients.  I keep up with many things using values in the cubes.  Whenever a new client's cube is set up, I add a sheet to the workbook I use, and create a pivot table using that cube.</p>\n\n<p>I want to checks the server for any cubes that may have been added.</p>\n\n<p>I figured something like this would be the best way.</p>\n\n<pre><code>For Each Cube in Server.Cubes\n    MsgBox Cube.Name\nNext Cube\n</code></pre>\n\n<p>I cannot find anything of the sort.  I searched for an answer for a couple of days now.  Any ways to parse through the server looking at the available cubes?</p>\n"}, {"tags": ["vba", "excel", "save"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 4, "creation_date": 1425498102, "post_id": 28863154, "comment_id": 45991956, "body": "Possible one of your variables contains a disallowed character?"}, {"owner": {"reputation": 329, "user_id": 4483889, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/08eea0bc7e9b732e1e49e59423aed31a?s=128&d=identicon&r=PG&f=1", "display_name": "New2VBA", "link": "https://stackoverflow.com/users/4483889/new2vba"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1425498849, "post_id": 28863154, "comment_id": 45992377, "body": "Both my dates and my CompanyNameSave have either \\ or / within them. Would that affect it? How can I create conditional formatting that would remove them from the CompanyNameSave. The date I can do. Something like If CompanyNameSave.Value Contains &quot;\\&quot; Then...?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 3, "creation_date": 1425499235, "post_id": 28863154, "comment_id": 45992604, "body": "Yes, that would absolutely affect it.  Try <code>CompanyNameSave = Replace(Replace(CompanyNameSave, &quot;\\&quot;, &quot;-&quot;), &quot;&#47;&quot;, &quot;-&quot;)</code> to take care of both back and forward slash."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1425499975, "post_id": 28863154, "comment_id": 45993033, "body": "@DavidZemens - Post that as an answer so New2VBA can accept it."}], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 3, "last_activity_date": 1425501469, "last_edit_date": 1425501469, "creation_date": 1425500622, "answer_id": 28864173, "question_id": 28863154, "link": "https://stackoverflow.com/questions/28863154/save-as-using-variable-names-gives-error/28864173#28864173", "title": "Save As Using Variable Names Gives Error", "body": "<p>There are a number of things that might cause an error with the <code>Save</code> operation but probably the most common is when we attempt to automate the filename creation, and don't account for illegal characters, which can't be part of a filename.</p>\n\n<p>In your case, since you are using date values, the presence of either a <code>\\</code> or <code>/</code> in the date format would cause an error.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa365247%28v=vs.85%29.aspx\" rel=\"nofollow\">This</a> lists the reserved characters:</p>\n\n<ul>\n<li><code>&lt;</code> (less than)</li>\n<li><code>&gt;</code> (greater than)</li>\n<li><code>:</code> (colon)</li>\n<li><code>\"</code> (double quote)</li>\n<li><code>/</code> (forward slash)</li>\n<li><code>\\</code> (backslash)</li>\n<li><code>|</code> (vertical bar or pipe)</li>\n<li><code>?</code> (question mark)</li>\n<li><code>*</code> (asterisk)</li>\n</ul>\n\n<p>For your case, you may simply use a double replace:</p>\n\n<pre><code>CompanyNameSave = Replace(Replace(CompanyNameSave, \"\\\", \"-\"), \"/\", \"-\")\n</code></pre>\n\n<p>However, that doesn't account for all illegal/reserved characters. It may be helpful to write a custom function that cleans filename strings:</p>\n\n<pre><code>Function CleanFileName(name As String, Optional replaceBy As String = \"_\")\nConst reservedChars As String = \"&lt;&gt;:\"\"\"\"/\\|?*\"\nDim i As Integer\nDim ch As String\n\nFor i = 1 To Len(reservedChars)\n    ch = Mid(reservedChars, i, 1)\n\n    name = Replace(name, ch, replaceBy)\nNext\n\nCleanFileName = name\n\n\nEnd Function\n</code></pre>\n\n<p>You could then call this function, immediately before trying to save the file, like:</p>\n\n<pre><code>CompanyNameSave = CleanFileName(CompanyNameSave, \"-\")\n</code></pre>\n\n<p><strong>Note:</strong> If you omit the optional <code>replaceBy</code> argument, it will default to using an underscore <code>_</code> to replace the reserved characters.</p>\n\n<p><strong>Note also:</strong> This does not take in to account whether the file already exists.</p>\n"}], "owner": {"reputation": 329, "user_id": 4483889, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/08eea0bc7e9b732e1e49e59423aed31a?s=128&d=identicon&r=PG&f=1", "display_name": "New2VBA", "link": "https://stackoverflow.com/users/4483889/new2vba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 653, "favorite_count": 0, "accepted_answer_id": 28864173, "answer_count": 1, "score": 0, "last_activity_date": 1426010586, "creation_date": 1425497284, "last_edit_date": 1426010586, "question_id": 28863154, "link": "https://stackoverflow.com/questions/28863154/save-as-using-variable-names-gives-error", "title": "Save As Using Variable Names Gives Error", "body": "<p>Trying to save a new, not yet named, workbook (that I added using another sub) with variables for the name. When I place everything within the quotation marks it works to save (not with variables). But this code constantly gives the run-time errror '1004': Method'SaveAs'of object '_workbook' failed.</p>\n\n<pre><code>Sub SalvarTabela30()\nApplication.DisplayAlerts = False\nDim CompanyNameSave As String\nDim VencimentoSave As Date\nDim ContractNumberSave As String\nDim LastrowForSave As Long\nLastrowForSave = ActiveSheet.Cells(Rows.Count, \"D\").End(xlUp).Row\nCompanyNameSave = Range(\"A2\")\nVencimentoSave = Range(\"C\" &amp; LastrowForSave)\nContractNumberSave = Range(\"E2\")\nActiveWorkbook.SaveAs _\n   Filename:=\"\\\\dsapc429pfs.pactual.net\\homefolder02$\\wellsty\\Desktop\\\" &amp; _ \n      \"Projeto - Marina\\\" &amp; CompanyNameSave &amp; \" - \" &amp; ContractNumberSave &amp; _\n      \" - Vencimento\" &amp; \"(\" &amp; VencimentoSave &amp; \")\", FileFormat:=52\n\nApplication.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 2595, "user_id": 3897316, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6cf468fea626f3aec65a199e2f67b309?s=128&d=identicon&r=PG&f=1", "display_name": "Degustaf", "link": "https://stackoverflow.com/users/3897316/degustaf"}, "edited": false, "score": 0, "creation_date": 1425496199, "post_id": 28862809, "comment_id": 45990864, "body": "What line gets highlighted when the error is thrown?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 6, "creation_date": 1425496446, "post_id": 28862809, "comment_id": 45991004, "body": "<code>SearchRange.Find(min).Select</code> will error if <code>min</code> doesn&#39;t exist in <code>SearchRange</code>.  You should split that into two parts - first do the find and check it actually returns a range, and only then do you work on the formatting (and you don&#39;t need to <code>Select</code> anything to do that)."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1425501541, "post_id": 28862809, "comment_id": 45993948, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/21403916/excel-vba-range-find-acting-up\">Excel VBA range.find acting up</a>"}], "owner": {"reputation": 29, "user_id": 3658086, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/x8POy.gif?s=128&g=1", "display_name": "hotkoreanchick", "link": "https://stackoverflow.com/users/3658086/hotkoreanchick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 929, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1425496129, "creation_date": 1425496129, "question_id": 28862809, "link": "https://stackoverflow.com/questions/28862809/range-find-method-object-variable-or-with-block-not-set-error", "title": "Range.Find method, Object Variable or With block not set error", "body": "<p>I can't seem to debug my code on my own. I'm fairly new to VBA and I would appreciate some help!!! I'm <strong>getting the \"Object Variable or With Block Not Set\" error on \"SearchRange.Find(min).Select\" line.</strong> Thanks in advance.</p>\n\n<p>Sub FindStart()</p>\n\n<pre><code>Dim SelectedRange As Range, EachRow As Range, SearchRange As Range\nSet SelectedRange = Selection\nSet SearchRange = Rows(2)\n\nFor Each EachRow In SelectedRange.Rows\n\n    Dim min As Double\n    min = Module7.MinSelected(EachRow)\n\n    SearchRange.Find(min).Select\n\n    With Selection.Interior\n    .Pattern = xlSolid\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorAccent5\n    .TintAndShade = 0.399975585192419\n    .PatternTintAndShade = 0\n    End With\nNext EachRow\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["excel", "vba", "if-statement"], "answers": [{"tags": [], "owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "is_accepted": true, "score": 0, "last_activity_date": 1425496276, "creation_date": 1425496276, "answer_id": 28862853, "question_id": 28862759, "link": "https://stackoverflow.com/questions/28862759/vba-if-statement-mismach-error/28862853#28862853", "title": "VBA if statement mismach error", "body": "<p>You are declaring <code>discountplaceholder</code> as a <code>String</code>, but then you are assigning a value of type <code>Double</code> to it. Either declare <code>discountplaceholder</code> as a Double, or assign a <code>String</code> to it. <code>discountplaceholder = \"0.1\"</code></p>\n"}, {"tags": [], "owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "is_accepted": false, "score": 0, "last_activity_date": 1425496739, "creation_date": 1425496739, "answer_id": 28862996, "question_id": 28862759, "link": "https://stackoverflow.com/questions/28862759/vba-if-statement-mismach-error/28862996#28862996", "title": "VBA if statement mismach error", "body": "<p>Declare <code>Discounterplaceholder</code> as a <code>Double</code> or use <code>\"\"</code> when you're assigning a double value to it to convert the <code>double</code> to a <code>literal</code>.</p>\n\n<pre><code>Dim discountplaceholder As Double\n</code></pre>\n\n<p>or </p>\n\n<pre><code>Sub CALULATE()\nDim postage As String\nDim discountplaceholder As String\n\ndiscount = Range(\"d10\").Value\n\nIf discount = \"0.1\" Then\n\nMsgBox \"hello Bill\"\ndiscountplaceholder = \"0.1\"\n\nElseIf discount = \"0.05\" Then\n\nMsgBox \"hello BOB\"\ndiscountplaceholder = \"0.05\"\n\nElse\nMsgBox \"hello dan\"\ndiscountplaceholder = \"0\"\n\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2868524"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 28862853, "answer_count": 2, "score": 0, "last_activity_date": 1425496739, "creation_date": 1425495962, "question_id": 28862759, "link": "https://stackoverflow.com/questions/28862759/vba-if-statement-mismach-error", "title": "VBA if statement mismach error", "body": "<p>I am trying to create a simple if statement. This if statement should move to the else statement when the value does not satisfy else if, but instead excel gives me a error 13 mismach error. </p>\n\n<p>Here is my code:</p>\n\n<pre><code>Sub CALULATE()\nDim postage As String\nDim discountplaceholder As String\n\ndiscount = Range(\"d10\").Value\n\nIf discount = 0.1 Then\n\nMsgBox \"hello Bill\"\ndiscountplaceholder = 0.1\n\nElseIf discount = 0.05 Then\n\nMsgBox \"hello BOB\"\ndiscountplaceholder = 0.05\n\nElse\nMsgBox \"hello dan\"\ndiscountplaceholder = 0\n\nEnd If\nEnd Sub\n</code></pre>\n\n<p>The third cell value (the one it is if it isn't 0.1 or 0.05) is \"NOT APPLICABLE FOR DISCOUNT\". Does anyone know how I can solve this?</p>\n\n<p>Thanks in advance. </p>\n"}, {"tags": ["ms-access", "vba", "arcgis"], "answers": [{"tags": [], "owner": {"reputation": 753, "user_id": 4688131, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1sGNF.jpg?s=128&g=1", "display_name": "tpdance", "link": "https://stackoverflow.com/users/4688131/tpdance"}, "is_accepted": false, "score": 0, "last_activity_date": 1436552971, "creation_date": 1436552971, "answer_id": 31347863, "question_id": 28862349, "link": "https://stackoverflow.com/questions/28862349/unable-to-modify-form-in-access-when-linked-to-arcgis/31347863#31347863", "title": "Unable to modify form in Access when linked to ArcGIS", "body": "<p>From the ArcGIS 10.2 help:</p>\n\n<blockquote>\n  <p>Linked tables in Access are not viewable through an OLE DB connection, although Access queries are available. To use the linked table, create a query in Access that references the linked table and connect to the linked table through the query in the OLE DB connection.</p>\n</blockquote>\n\n<p><a href=\"http://resources.arcgis.com/en/help/main/10.2/index.html#//005s00000023000000\" rel=\"nofollow\">http://resources.arcgis.com/en/help/main/10.2/index.html#//005s00000023000000</a></p>\n"}], "owner": {"reputation": 27, "user_id": 4223262, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/be7b0871006ead7dbf4090734f386f25?s=128&d=identicon&r=PG&f=1", "display_name": "marion", "link": "https://stackoverflow.com/users/4223262/marion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1436552971, "creation_date": 1425494519, "question_id": 28862349, "link": "https://stackoverflow.com/questions/28862349/unable-to-modify-form-in-access-when-linked-to-arcgis", "title": "Unable to modify form in Access when linked to ArcGIS", "body": "<p>I created a split Access 2010 database with a backend for just tables and the frontend with queries and forms.  The frontend is linked using an OLE DB connection to ArcGIS, which works fine.  When the database connection is connected I am unable to modify my forms but I can update and create queries. </p>\n\n<p>Could this be an issue with having the forms bound to my table query? or is it because I am using a table query for the form?  I don't know how to update my table records from the form without it being bound to the table.</p>\n\n<p>This is also a multiple user database and other users maybe linking this to ArcGIS and might also need to make modifications.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 180, "user_id": 4236677, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EMte0.jpg?s=128&g=1", "display_name": "Zegad", "link": "https://stackoverflow.com/users/4236677/zegad"}, "edited": false, "score": 0, "creation_date": 1425496502, "post_id": 28862277, "comment_id": 45991040, "body": "<i>@Michale72688</i> I recomend you to use Union method as shown <a href=\"http://stackoverflow.com/questions/25785628/how-to-add-to-current-cell-selection-in-excel-vba\">here</a>, beacause your cycle is only selecting its current position instead of a range of multiples rows"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 4629238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9eab12e6df738918b6bf8dce5ecfb38?s=128&d=identicon&r=PG&f=1", "display_name": "Michael72688", "link": "https://stackoverflow.com/users/4629238/michael72688"}, "edited": false, "score": 0, "creation_date": 1425495145, "post_id": 28862490, "comment_id": 45990248, "body": "That is helpful.  When it finishes running, only the last row is selected.  So somehow I need it to keep the other rows selected also.  Thanks."}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "reply_to_user": {"reputation": 41, "user_id": 4629238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9eab12e6df738918b6bf8dce5ecfb38?s=128&d=identicon&r=PG&f=1", "display_name": "Michael72688", "link": "https://stackoverflow.com/users/4629238/michael72688"}, "edited": false, "score": 0, "creation_date": 1425501611, "post_id": 28862490, "comment_id": 45993993, "body": "After your <code>.Select</code>, add <code>False</code>. This will add each new selection to your selection. So <code>Rows(i).Select False</code>"}], "tags": [], "owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "is_accepted": false, "score": 1, "last_activity_date": 1425495020, "creation_date": 1425495020, "answer_id": 28862490, "question_id": 28862277, "link": "https://stackoverflow.com/questions/28862277/vba-excel-select-rows-with-left-value-to-variable/28862490#28862490", "title": "VBA Excel - Select rows with Left value = to variable", "body": "<p>If you are trying to select the row assigned to variable \"i\", you would use:</p>\n\n<pre><code>Sub trace1()\n    Dim trace As String\n    trace = \"T\"\n    Dim LR As Long, i As Long\n    LR = Range(\"M\" &amp; Rows.Count).End(xlUp).Row\n    For i = 1 To LR\n        If Left(Range(\"M\" &amp; i).Value, 1) = trace Then Rows(i).Select\n    Next i\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 4629238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9eab12e6df738918b6bf8dce5ecfb38?s=128&d=identicon&r=PG&f=1", "display_name": "Michael72688", "link": "https://stackoverflow.com/users/4629238/michael72688"}, "edited": false, "score": 0, "creation_date": 1425495492, "post_id": 28862527, "comment_id": 45990427, "body": "I&#39;m not sure how to do this.  I just want to select (and copy) all rows where the value in column M starts with the letter T."}, {"owner": {"reputation": 468, "user_id": 4628327, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MH5Ee.png?s=128&g=1", "display_name": "Ralph J", "link": "https://stackoverflow.com/users/4628327/ralph-j"}, "reply_to_user": {"reputation": 41, "user_id": 4629238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9eab12e6df738918b6bf8dce5ecfb38?s=128&d=identicon&r=PG&f=1", "display_name": "Michael72688", "link": "https://stackoverflow.com/users/4629238/michael72688"}, "edited": false, "score": 0, "creation_date": 1425495574, "post_id": 28862527, "comment_id": 45990488, "body": "Where do you want to copy the row to?  Also, when you say &quot;starts with the letter T&quot; to you mean that there is more in the cell in Column M than just the letter T?  Your code above will grab T in the cell, but not T12345, since the latter is not equal to T.  That can be solved too, if that&#39;s what you need."}, {"owner": {"reputation": 41, "user_id": 4629238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9eab12e6df738918b6bf8dce5ecfb38?s=128&d=identicon&r=PG&f=1", "display_name": "Michael72688", "link": "https://stackoverflow.com/users/4629238/michael72688"}, "edited": false, "score": 0, "creation_date": 1425495675, "post_id": 28862527, "comment_id": 45990559, "body": "I want to copy all the rows to another spreadsheet, but I&#39;m going to do that manually.  So Ijust want to select and copy to clipboard."}, {"owner": {"reputation": 468, "user_id": 4628327, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MH5Ee.png?s=128&g=1", "display_name": "Ralph J", "link": "https://stackoverflow.com/users/4628327/ralph-j"}, "reply_to_user": {"reputation": 41, "user_id": 4629238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9eab12e6df738918b6bf8dce5ecfb38?s=128&d=identicon&r=PG&f=1", "display_name": "Michael72688", "link": "https://stackoverflow.com/users/4629238/michael72688"}, "edited": false, "score": 0, "creation_date": 1425496806, "post_id": 28862527, "comment_id": 45991220, "body": "Nevermind what I said about not catching T12345 -- your code does that fine.  I forgot you had the Left() in there."}], "tags": [], "owner": {"reputation": 468, "user_id": 4628327, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MH5Ee.png?s=128&g=1", "display_name": "Ralph J", "link": "https://stackoverflow.com/users/4628327/ralph-j"}, "is_accepted": false, "score": 0, "last_activity_date": 1425496564, "last_edit_date": 1425496564, "creation_date": 1425495187, "answer_id": 28862527, "question_id": 28862277, "link": "https://stackoverflow.com/questions/28862277/vba-excel-select-rows-with-left-value-to-variable/28862527#28862527", "title": "VBA Excel - Select rows with Left value = to variable", "body": "<p>The expression</p>\n\n<pre><code>Rows(\"i:i\").Select\n</code></pre>\n\n<p>throws an error -- Rows() won't recognize the text value \"i:i\" as an argument.</p>\n\n<pre><code>Rows(i).Select\n</code></pre>\n\n<p>will work.  But it won't DO anything you can see, other than the last row should be selected when the code is finished running.  You may want to do whatever needs to be done to the \"T\" rows at the next step in your code before your get to the <code>Next i</code> step.</p>\n\n<p>EDIT:\nOK, you want multiple rows selected when the code is finished.  That can be done: </p>\n\n<pre><code>    Dim RowsDescript As String\n    Dim trace As String\n    trace = \"T\"\n    Dim LR As Long, i As Long\n    LR = Range(\"M\" &amp; Rows.Count).End(xlUp).Row\n    For i = 1 To LR\n        If Left(Range(\"M\" &amp; i).Value, 1) = trace Then RowsDescript = RowsDescript &amp; i &amp; \":\" &amp; i &amp; \",\"\n    Next i\n\nIf Len(RowsDescript) &gt; 0 Then\n    RowsDescript = Left(RowsDescript, Len(RowsDescript) - 1)        ' removes the last comma\n    Range(RowsDescript).Select\nEnd If\n</code></pre>\n\n<p>What you want to end up with is an expression that looks like this:</p>\n\n<pre><code>Range(\"9:9,12:12,16:16\").Select\n</code></pre>\n\n<p>How you get there is, when a row is identified as having the \"T\" that you want in it, add the row number and a colon and the row number again and a comma to the string RowDescript.  So at the end of the loop, you end up with the string having</p>\n\n<pre><code>9:9,12:12,16:16,\n</code></pre>\n\n<p>in it.  But we need to strip off that last comma, so there's the check for a non-zero length string, remove the last character, and then select those rows.</p>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 4629238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9eab12e6df738918b6bf8dce5ecfb38?s=128&d=identicon&r=PG&f=1", "display_name": "Michael72688", "link": "https://stackoverflow.com/users/4629238/michael72688"}, "edited": false, "score": 0, "creation_date": 1425495896, "post_id": 28862532, "comment_id": 45990679, "body": "Do you know how I can select all rows with column M starting with T?"}], "tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": false, "score": 0, "last_activity_date": 1425500503, "last_edit_date": 1592644375, "creation_date": 1425495206, "answer_id": 28862532, "question_id": 28862277, "link": "https://stackoverflow.com/questions/28862277/vba-excel-select-rows-with-left-value-to-variable/28862532#28862532", "title": "VBA Excel - Select rows with Left value = to variable", "body": "<p>1.&quot;T&quot; is not equal to &quot;t&quot;, to remove &quot;case sensitivity&quot; it is required to use LCase or UCase (low case or upper case)</p>\n<p>2.Rows(&quot;i:i&quot;) replaced by Row(i)</p>\n<pre><code>Sub trace1()\n    Dim trace As String\n    trace = &quot;T&quot;\n    Dim LR As Long, i As Long\n    LR = Range(&quot;M&quot; &amp; Rows.Count).End(xlUp).Row\n    For i = 1 To LR\n        If UCase(Left(Range(&quot;M&quot; &amp; i).Value, 1)) = UCase(trace) Then Rows(i).Select\n    Next i\nEnd Sub\n</code></pre>\n<p>And also one comment, at the final will be selected only last row in range, for example row 1,5 and 10 will start from &quot;T&quot;, so at the end will be selected only 10th row</p>\n<h1>updated against question in the comments</h1>\n<p>this will allow you to select rows which starting from &quot;t&quot; or &quot;T&quot;, but this method allow to select not more than 45 rows.</p>\n<pre><code>Sub Macro1()\n    Dim trace$, LR&amp;, i&amp;, Rng$\n    trace = &quot;T&quot;: Rng = &quot;&quot;\n    LR = Range(&quot;M&quot; &amp; Rows.Count).End(xlUp).Row\n    For i = 1 To LR\n        If UCase(Left(Range(&quot;M&quot; &amp; i).Value, 1)) = UCase(trace) Then Rng = Rng &amp; i &amp; &quot;:&quot; &amp; i &amp; &quot;,&quot;\n    Next i\n    Rng = Left(Rng, Len(Rng) - 1)\n    Range(Rng).Select\nEnd Sub\n</code></pre>\n<p>Use copy/paste one by one row if you need copy rows from one sheet to another, or sort range and select range from first row to the last row where  cell value start from &quot;T&quot;</p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 4626491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/744147c03bed17b159d8dce8a3afa133?s=128&d=identicon&r=PG&f=1", "display_name": "Bill Liame", "link": "https://stackoverflow.com/users/4626491/bill-liame"}, "is_accepted": false, "score": 1, "last_activity_date": 1425497192, "creation_date": 1425497192, "answer_id": 28863127, "question_id": 28862277, "link": "https://stackoverflow.com/questions/28862277/vba-excel-select-rows-with-left-value-to-variable/28863127#28863127", "title": "VBA Excel - Select rows with Left value = to variable", "body": "<p>\"Rows(\"i:i\")\" won't work.  Try collecting all the addresses of all ranges in one string and then selecting the string.  Note the comma which separates each range.</p>\n\n<pre><code>Sub trace1()\n    Dim sRange As String\n    Dim trace As String\n    trace = \"T\"\n    Dim LR As Long, i As Long\n    LR = Range(\"M\" &amp; Rows.Count).End(xlUp).Row\n    For i = 1 To LR\n        If Left(Range(\"M\" &amp; i).Value, 1) = trace Then sRange = sRange &amp; \",\" &amp; i &amp; \":\" &amp; i\n    Next i\n    Range(Mid(sRange, 2)).Select\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 4629238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9eab12e6df738918b6bf8dce5ecfb38?s=128&d=identicon&r=PG&f=1", "display_name": "Michael72688", "link": "https://stackoverflow.com/users/4629238/michael72688"}, "edited": false, "score": 0, "creation_date": 1425497828, "post_id": 28863149, "comment_id": 45991808, "body": "Thanks, this works perfectly.  Thanks again Porcupine911"}], "tags": [], "owner": {"reputation": 898, "user_id": 4425957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faea4ee63cb1f9c3e30d3faac96f978b?s=128&d=identicon&r=PG&f=1", "display_name": "Porcupine911", "link": "https://stackoverflow.com/users/4425957/porcupine911"}, "is_accepted": true, "score": 2, "last_activity_date": 1425497270, "creation_date": 1425497270, "answer_id": 28863149, "question_id": 28862277, "link": "https://stackoverflow.com/questions/28862277/vba-excel-select-rows-with-left-value-to-variable/28863149#28863149", "title": "VBA Excel - Select rows with Left value = to variable", "body": "<p>One possible way to answer the question as written:</p>\n\n<pre><code>Sub trace1()\n    Dim trace As String\n    trace = \"T\"\n    Dim LR As Long, i As Long\n\n    Dim SelectedRows As Range\n\n    LR = Range(\"M\" &amp; Rows.Count).End(xlUp).Row\n    For i = 1 To LR\n        If Not SelectedRows Is Nothing Then\n            If Left(Range(\"M\" &amp; i).Value, 1) = trace Then Set SelectedRows = Union(SelectedRows, Rows(i))\n        Else\n            If Left(Range(\"M\" &amp; i).Value, 1) = trace Then Set SelectedRows = Rows(i)\n        End If\n    Next i\n    SelectedRows.Select 'Replace with .Copy if that's what you really wanted.\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 4629238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9eab12e6df738918b6bf8dce5ecfb38?s=128&d=identicon&r=PG&f=1", "display_name": "Michael72688", "link": "https://stackoverflow.com/users/4629238/michael72688"}, "edited": false, "score": 0, "creation_date": 1425678185, "post_id": 28870757, "comment_id": 46075633, "body": "Thanks.  I&#39;ll have to remember this for the future."}], "tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 1, "last_activity_date": 1425533691, "creation_date": 1425533691, "answer_id": 28870757, "question_id": 28862277, "link": "https://stackoverflow.com/questions/28862277/vba-excel-select-rows-with-left-value-to-variable/28870757#28870757", "title": "VBA Excel - Select rows with Left value = to variable", "body": "<p>using <code>AutoFilter</code> to give you the range as is, or the actual address</p>\n\n<p>avoids slow loops</p>\n\n<pre><code>Sub trace2()\n    Dim strTrace As String\n    Dim strAddress\n    Dim rng1 As Range\n\n    strTrace = \"T\"\n    Set rng1 = Range([m1], Cells(Rows.Count, \"M\").End(xlUp))\n\n    With rng1\n        .AutoFilter 1, strTrace &amp; \"*\"\n        Set rng1 = rng1.Cells(1).Offset(1, 0).Resize(rng1.Rows.Count - 1, 1)\n        strAddress = rng1.SpecialCells(xlVisible).EntireRow.Address\n    End With\n\n    MsgBox \"rows that start with \" &amp; strTrace &amp; vbNewLine &amp; strAddress\n    ActiveSheet.AutoFilterMode = False\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 4629238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9eab12e6df738918b6bf8dce5ecfb38?s=128&d=identicon&r=PG&f=1", "display_name": "Michael72688", "link": "https://stackoverflow.com/users/4629238/michael72688"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1029, "favorite_count": 0, "accepted_answer_id": 28863149, "answer_count": 6, "score": 1, "last_activity_date": 1425533691, "creation_date": 1425494253, "question_id": 28862277, "link": "https://stackoverflow.com/questions/28862277/vba-excel-select-rows-with-left-value-to-variable", "title": "VBA Excel - Select rows with Left value = to variable", "body": "<p>Having trouble with this code.  No errors but also doesn't seem to do anything.\nIn my sheet, column \"M\" has some values that start with the letter \"T\"  I want to select the entire row for these.  Thanks in advance.</p>\n\n<pre><code>Sub trace1()\n    Dim trace As String\n    trace = \"T\"\n    Dim LR As Long, i As Long\n    LR = Range(\"M\" &amp; Rows.Count).End(xlUp).Row\n    For i = 1 To LR\n        If Left(Range(\"M\" &amp; i).Value, 1) = trace Then Rows(\"i:i\").Select\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11359, "user_id": 1624450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Lfzcq.png?s=128&g=1", "display_name": "Pieter Geerkens", "link": "https://stackoverflow.com/users/1624450/pieter-geerkens"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1425498790, "post_id": 28861117, "comment_id": 45992326, "body": "@DavidZemens OP clearly gets that - he is just mystified on how he is doing it incorrectly in this example."}, {"owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "edited": false, "score": 0, "creation_date": 1425499208, "post_id": 28861117, "comment_id": 45992587, "body": "I acutally did review that question, and still didn&#39;t see what the issue was. Thanks @TimWilliams for a perfectly complete explanation and fix."}], "answers": [{"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1425498857, "post_id": 28862926, "comment_id": 45992383, "body": "<i>It may be looking at ActiveSheet.Cells</i>  It <b>IS</b> looking at the <code>ActiveSheet.Cells</code>. Just because it&#39;s inside the parentheses doesn&#39;t exempt it from the need to be qualified :)"}], "tags": [], "owner": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "is_accepted": false, "score": 0, "last_activity_date": 1425496988, "last_edit_date": 1425496988, "creation_date": 1425496572, "answer_id": 28862926, "question_id": 28861117, "link": "https://stackoverflow.com/questions/28861117/cant-work-with-ranges-if-workbook-and-sheet-are-not-active/28862926#28862926", "title": "Can&#39;t work with ranges if workbook and sheet are not active", "body": "<p>The Cells reference within the range might be the hangup.  I've gotten weird errors when using Range() with two cells in it.  With just:</p>\n\n<pre><code>Range(Cells(1, iHeadCol), Cells(1, iLastCol))\n</code></pre>\n\n<p>It may be looking at ActiveSheet.Cells and if you try combining cells in different worksheets (or with an explicit reference on the range) you get errors.  Try explicitly referencing the cells with:</p>\n\n<pre><code>Range(wbReceive.Sheets(sExcept)Cells(1, iHeadCol), wbReceive.Sheets(sExcept)Cells(1, iLastCol))\n</code></pre>\n\n<p>It looks ugly but you can probably clean it up with some worksheet objects.</p>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 5, "last_activity_date": 1425499447, "last_edit_date": 1425499447, "creation_date": 1425496645, "answer_id": 28862963, "question_id": 28861117, "link": "https://stackoverflow.com/questions/28861117/cant-work-with-ranges-if-workbook-and-sheet-are-not-active/28862963#28862963", "title": "Can&#39;t work with ranges if workbook and sheet are not active", "body": "<pre><code>Set rExceptions = wbImport.Sheets(sSht).Range(Cells(rCell.Row, iHeadCol), _\n                                              Cells(rCell.Row, iLastCol))\n</code></pre>\n\n<p>You've qualified <code>Range</code>, but not <code>Cells</code>: either of these if not qualified with a specific sheet will refer to the ActiveSheet. Somewhat counter-intuitively, the (qualified) wrapping <code>Range</code> doesn't \"casade\" down...</p>\n\n<p>Try this:</p>\n\n<pre><code>With wbImport.Sheets(sSht)\n    Set rExceptions =  .Range(.Cells(rCell.Row, iHeadCol), _\n                              .Cells(rCell.Row, iLastCol))\nEnd with\n</code></pre>\n"}], "owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 808, "favorite_count": 0, "closed_date": 1587583125, "accepted_answer_id": 28862963, "answer_count": 2, "score": 1, "last_activity_date": 1429646800, "creation_date": 1425490618, "last_edit_date": 1531164843, "question_id": 28861117, "link": "https://stackoverflow.com/questions/28861117/cant-work-with-ranges-if-workbook-and-sheet-are-not-active", "closed_reason": "Duplicate", "title": "Can&#39;t work with ranges if workbook and sheet are not active", "body": "<p>I am getting an Application or Object Defined Error when I try to import values from one workbook to another. I have been able to resolve it by explicitly activating the workbooks and selecting the sheets before referencing the range on each, but I would like to avoid that if possible. Both workbooks are open at this point in the code. Any thoughts?</p>\n\n<p>This generates errors for me:</p>\n\n<pre><code>Dim wbImport As Workbook\nDim wbReceive As Workbook\nConst sExcept = \"Sheet2 Name\"  \nConst sSht = \"Sheet1 Name\"\nDim rExceptions As Range\n\nwbReceive.Sheets(sExcept).Rows(1).Insert shift:=xlDown\nSet rExceptions = wbImport.Sheets(sSht).Range(Cells(rCell.Row, iHeadCol), Cells(rCell.Row, iLastCol))\nwbReceive.Sheets(sExcept).Range(Cells(1, iHeadCol), Cells(1, iLastCol)).Value = rExceptions.Value 'error occurs here\n</code></pre>\n\n<p>This runs fine, but I'd like to avoid the <code>.Select</code> and <code>.Activate</code></p>\n\n<pre><code>wbReceive.Sheets(sExcept).Rows(1).Insert shift:=xlDown\nwbImport.Activate\nwbImport.Sheets(sSht).Select\nSet rExceptions = wbImport.Sheets(sSht).Range(Cells(rCell.Row, iHeadCol), Cells(rCell.Row, iLastCol))\nwbReceive.Activate\nwbReceive.Sheets(sExcept).Select\nwbReceive.Sheets(sExcept).Range(Cells(1, iHeadCol), Cells(1, iLastCol)).Value = rExceptions.Value\n</code></pre>\n\n<p>As I was debugging, it looked like cells referenced in the <code>wbReceive.Sheets(sExcept)</code> line were actually referencing a different sheet in the <code>wbReceive</code> workbook. Not sure why that would be the case though, since the wb and sheet were explicitly referenced?</p>\n"}, {"tags": ["vba", "loops", "excel", "for-loop"], "comments": [{"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 2, "creation_date": 1425488864, "post_id": 28860519, "comment_id": 45986535, "body": "Reverse your loop <code>For i = rng2.Rows.Count to 1 Step -1</code> will make you loop from bottom to top."}], "answers": [{"tags": [], "owner": {"reputation": 468, "user_id": 4628327, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MH5Ee.png?s=128&g=1", "display_name": "Ralph J", "link": "https://stackoverflow.com/users/4628327/ralph-j"}, "is_accepted": true, "score": 0, "last_activity_date": 1425490710, "creation_date": 1425490710, "answer_id": 28861155, "question_id": 28860519, "link": "https://stackoverflow.com/questions/28860519/delete-row-loop-vba/28861155#28861155", "title": "Delete row loop vba", "body": "<p>Kyle is right -- loop from bottom (rng2.Rows.Count) to top (1) with step -1, and this should work fine.</p>\n\n<p>What's doing you in is that when you delete row 5, the old row 6 is the new row 5, but the next loop is looking at row 6 -- the old Row 7, so your old Row 6 (new Row 5) never gets considered.  Looping from bottom to top solves this, because if you delete Row 5, the next row to be considered is Row 4, and it hasn't moved.</p>\n"}], "owner": {"reputation": 179, "user_id": 4581009, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e687e8e16444ce76b07e9ada1cd27bf4?s=128&d=identicon&r=PG&f=1", "display_name": "Philip", "link": "https://stackoverflow.com/users/4581009/philip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 428, "favorite_count": 0, "closed_date": 1460462008, "accepted_answer_id": 28861155, "answer_count": 1, "score": 0, "last_activity_date": 1425490710, "creation_date": 1425488784, "question_id": 28860519, "link": "https://stackoverflow.com/questions/28860519/delete-row-loop-vba", "closed_reason": "Duplicate", "title": "Delete row loop vba", "body": "<p>I have a function in vba that loops through a set of data and checks if certain values exist and if they do, delete the row.  It works but it doesn't delete all the values.  I'm pretty sure it is because the loop's upper bound is the row count of the range which with every deletion, gets smaller.  How would I change this?  Any help would be greatly appreciated!</p>\n\n<pre><code>Function DeleteClients(rng1 As Range, rng2 As Range)\n\nvData1 = rng1.Value\n\nFor i = 1 To rng2.Rows.Count\n\n    For j = LBound(vData1, 1) To UBound(vData1, 1)\n\n        If rng2.Cells(i, 1).Value = vData1(j, 1) Then\n            rng2.Cells(i, 1).EntireRow.Delete\n            Exit For\n        End If\n\n    Next j\nApplication.StatusBar = \"Deleting out excluded clients... \" &amp; i &amp; \"/\" &amp; rng2.Rows.Count &amp; \" Records Processed \" &amp; Round((i / rng2.Rows.Count) * 100, 0) &amp; \" % Complete\"\nNext i\n\nApplication.StatusBar = False\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 47, "user_id": 451627, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/35d431f0af2b3fad1f22ed347d88f57a?s=128&d=identicon&r=PG", "display_name": "Guillermo", "link": "https://stackoverflow.com/users/451627/guillermo"}, "edited": false, "score": 0, "creation_date": 1425488340, "post_id": 28860273, "comment_id": 45986174, "body": "Of course the final cleaned paragraph must be formatted as this image <a href=\"https://farm9.staticflickr.com/8677/16689915356_f42d402ef5_o.png\" rel=\"nofollow noreferrer\">farm9.staticflickr.com/8677/16689915356_f42d402ef5_o.png</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "is_accepted": false, "score": 1, "last_activity_date": 1425489396, "creation_date": 1425489396, "answer_id": 28860727, "question_id": 28860273, "link": "https://stackoverflow.com/questions/28860273/ms-word-in-selected-text-clean-all-but-the-last-end-paragraph-mark/28860727#28860727", "title": "ms word in selected text clean all but the last end-paragraph mark", "body": "<p>Use the Find and Replace functionality in Word to replace two spaces with a single space. Keep doing this until it says no more occurrences were found.</p>\n\n<p>To look for the paragraph marks, search for \"^p\" without the quotes. You can replace this with nothing or with a space.</p>\n"}, {"tags": [], "owner": {"reputation": 615, "user_id": 6236294, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/10204431270580592/picture?type=large", "display_name": "Ibn e Ashiq", "link": "https://stackoverflow.com/users/6236294/ibn-e-ashiq"}, "is_accepted": true, "score": 1, "last_activity_date": 1509088624, "creation_date": 1509088624, "answer_id": 46969529, "question_id": 28860273, "link": "https://stackoverflow.com/questions/28860273/ms-word-in-selected-text-clean-all-but-the-last-end-paragraph-mark/46969529#46969529", "title": "ms word in selected text clean all but the last end-paragraph mark", "body": "<p>You can replace all paragraph marks <code>\"^p\"</code> with nothing <code>\"\"</code>, and replace two/three <code>\"   \"</code> (blank-spaces) with one <code>\" \"</code> using code given below.</p>\n\n<p>Your document may also contain double paragraph marks i.e \"^p^p\". Replacing <code>\"^p^p\"</code> with <code>\"^p\"</code> first; will do the job.</p>\n\n<pre><code>Dim Mr As Range\nSet Mr = ActiveDocument.Content\nWith Mr.Find\n            .Wrap = wdFindContinue\n            .Text = \"^p\"\n            .Replacement.Text = \"\"\n            .Execute Replace:=wdReplaceAll\nEnd With\nWith Mr.Find\n            .Wrap = wdFindContinue\n            .Text = \"   \"\n            .Replacement.Text = \" \"\n            .Execute Replace:=wdReplaceAll\nEnd With\nWith Mr.Find\n            .Wrap = wdFindContinue\n            .Text = \"  \"\n            .Replacement.Text = \" \"\n            .Execute Replace:=wdReplaceAll\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 451627, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/35d431f0af2b3fad1f22ed347d88f57a?s=128&d=identicon&r=PG", "display_name": "Guillermo", "link": "https://stackoverflow.com/users/451627/guillermo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 595, "favorite_count": 0, "accepted_answer_id": 46969529, "answer_count": 2, "score": 0, "last_activity_date": 1509088624, "creation_date": 1425488101, "last_edit_date": 1495542503, "question_id": 28860273, "link": "https://stackoverflow.com/questions/28860273/ms-word-in-selected-text-clean-all-but-the-last-end-paragraph-mark", "title": "ms word in selected text clean all but the last end-paragraph mark", "body": "<p>I have an big .txt document imported in Word (2013 version btw).\nIn the text I have the \"paragraphs\" formatted  with several lines and \"terminated\" with a blank line.</p>\n\n<p>In Word I would like do a semi automatic improvement of these \"paragraphs\" removing all but the last end-paragraph mark.\nI can select manually the groups of lines and run the macro/vba that clean the paragraph.</p>\n\n<p>(I don't want an totally automatic function, nor change other than the loaded document)</p>\n\n<p>Please see the attached image.\nYou can see the Word end mark in each \"line\".\nI want to remove the mark in all the lines except the real last, thus getting one only paragraph with all the selected lines.</p>\n\n<p>As an addon I like also clean also the excess of spaces (shown as .... in the image), thus change n spaces to only one.</p>\n\n<p>I've tried some tips founded here (as <a href=\"https://stackoverflow.com/questions/16035530/vba-word-remove-double-paragraph-marks\">this</a>) but I think the mine is a different thing.</p>\n\n<p>Thanks very much, and sorry my poor english.</p>\n\n<p><img src=\"https://i.stack.imgur.com/jTKrE.png\" alt=\"several lines selected in order to clean an format a an paragraph\"></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 605, "user_id": 4038135, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/1a466feb6dbb26026d38b95c44d8a1b2?s=128&d=identicon&r=PG&f=1", "display_name": "KingOfTheNerds", "link": "https://stackoverflow.com/users/4038135/kingofthenerds"}, "edited": false, "score": 3, "creation_date": 1425488000, "post_id": 28860123, "comment_id": 45985960, "body": "Can you please post some more complete sample code and some context for what you&#39;re trying to do?"}, {"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 1, "creation_date": 1425488192, "post_id": 28860123, "comment_id": 45986076, "body": "Workbook does not have PivotTables property, probably it should be ActiveWorksheet.PivotTables"}], "answers": [{"tags": [], "owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "is_accepted": false, "score": 2, "last_activity_date": 1425488178, "creation_date": 1425488178, "answer_id": 28860293, "question_id": 28860123, "link": "https://stackoverflow.com/questions/28860123/microsoft-excel-macro-run-time-error-438/28860293#28860293", "title": "Microsoft Excel Macro - Run-time error &#39;438&#39;", "body": "<p>I think you need to use a worksheet reference because the PivotTables collection belongs to a worksheet, not a workbook. So try:\n    With ActiveSheet.PivotTables(\"PivotTable\").PivotFields(\"Ad Set Name\")</p>\n"}], "owner": {"reputation": 1, "user_id": 4314567, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/06dbf8c4318c905370cab8470f532233?s=128&d=identicon&r=PG&f=1", "display_name": "dexter ", "link": "https://stackoverflow.com/users/4314567/dexter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1776, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1431201073, "creation_date": 1425487698, "last_edit_date": 1431201073, "question_id": 28860123, "link": "https://stackoverflow.com/questions/28860123/microsoft-excel-macro-run-time-error-438", "title": "Microsoft Excel Macro - Run-time error &#39;438&#39;", "body": "<p>This is my first time doing excel macro, and I got this error:</p>\n\n<p>Microsoft Excel Macro - Run-time error '438'\nobject doesn't support this property or method</p>\n\n<p>The error is highlighted as this \n<strong>With ActiveWorkbook.PivotTables(\"PivotTable\").PivotFields(\"Ad Set Name\")</strong></p>\n\n<p>Does anyone knows how to resolve this, and thanks in advance!</p>\n\n<p>Best Regards\nDex</p>\n"}, {"tags": ["excel", "vba", "sorting"], "answers": [{"tags": [], "owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "is_accepted": false, "score": 1, "last_activity_date": 1425489828, "creation_date": 1425489828, "answer_id": 28860856, "question_id": 28860082, "link": "https://stackoverflow.com/questions/28860082/sorting-target-rows-alphabetically-by-first-cell-using-vba/28860856#28860856", "title": "Sorting target rows alphabetically by first Cell using VBA", "body": "<p>You will use the Sort method of the Range object.</p>\n\n<pre><code>Range(\"B:G\").Sort Key1:=Range(\"B:B\"), Order1:=xlAscending\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 4597673, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/7e185ecaefcc9c3752941a43e925b602?s=128&d=identicon&r=PG&f=1", "display_name": "Schmendlow", "link": "https://stackoverflow.com/users/4597673/schmendlow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2093, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1425489828, "creation_date": 1425487597, "question_id": 28860082, "link": "https://stackoverflow.com/questions/28860082/sorting-target-rows-alphabetically-by-first-cell-using-vba", "title": "Sorting target rows alphabetically by first Cell using VBA", "body": "<p>It's probably not that complex of an issue but I still didn't succeed:</p>\n\n<p>I have an Excel list of 6 variables starting at the range of \"B14:G14\", where in column \"B\" you have a name and in the columns \"C:G\" you have formulas that are ment to be connected to that very name. I created a button using VBA to simplify adding additional name&amp;formula complexes into the rows below, so the list does have kind of an open end.</p>\n\n<p>What I would like to do now, is create another button using VBA that sorts the rows (\"B:G\") alphabetically by the name in the first column (\"B\"). Example:</p>\n\n<pre><code>  B       C     D     E     F     G\n\nGamma   =1+1  =2+2  =3+3  =4+4  =5+5\nAlpha   =6+6  =7+7  =8+8  =9+9  =1+2\nBeta    =1+3  =1+4  =1+5  =1+6  =1+7\n</code></pre>\n\n<p><em>Button1_Click</em></p>\n\n<pre><code>  B       C     D     E     F     G\n\nAlpha   =6+6  =7+7  =8+8  =9+9  =1+2\nBeta    =1+3  =1+4  =1+5  =1+6  =1+7\nGamma   =1+1  =2+2  =3+3  =4+4  =5+5\n</code></pre>\n\n<p>It'd be awesome if anybody could help me out with this!\nThanks a lot!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 375, "user_id": 6685262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94c769f8e2647455d97981099aeab934?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/6685262/daniel"}, "edited": false, "score": 0, "creation_date": 1584991128, "post_id": 28861210, "comment_id": 107606903, "body": "Use _Exit() event instead as _Change() prevents full entry of number with decimals because it tries to reformat the full number as you type, though you haven&#39;t finished entering it. _Exit worked perfectly, though."}], "tags": [], "owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "is_accepted": false, "score": 3, "last_activity_date": 1425490883, "creation_date": 1425490883, "answer_id": 28861210, "question_id": 28860017, "link": "https://stackoverflow.com/questions/28860017/format-number-in-userform-textbox/28861210#28861210", "title": "Format number in userform textbox", "body": "<p>Here is a workaround, use the second subroutine to get the value in a string format.</p>\n\n<pre><code>Private Sub TextBox1_Change()\n    TextBox1 = Format(TextBox1, \"$#,##0.00\")\nEnd Sub\n</code></pre>\n\n<p>Then convert the format of the cell where this value was assigned.\n<code>Range(\"A1\").Value = CDbl(Range(\"A1\").Value)</code></p>\n"}, {"comments": [{"owner": {"reputation": 27967, "user_id": 1165998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e552055054e7507f0534bf56203fcb08?s=128&d=identicon&r=PG&f=1", "display_name": "David L", "link": "https://stackoverflow.com/users/1165998/david-l"}, "edited": false, "score": 1, "creation_date": 1493689560, "post_id": 43694270, "comment_id": 74501408, "body": "I think the OP is looking for a programmatic solution, not a manual one."}], "tags": [], "owner": {"reputation": 21, "user_id": 7940182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a0a1ad97bf2a87bb4035ce553c4cdca?s=128&d=identicon&r=PG&f=1", "display_name": "Minh", "link": "https://stackoverflow.com/users/7940182/minh"}, "is_accepted": false, "score": 2, "last_activity_date": 1493782580, "last_edit_date": 1493782580, "creation_date": 1493460352, "answer_id": 43694270, "question_id": 28860017, "link": "https://stackoverflow.com/questions/28860017/format-number-in-userform-textbox/43694270#43694270", "title": "Format number in userform textbox", "body": "<p>Double click on textbox and then \nYou should use AfterUpdate event</p>\n\n<pre><code>Private Sub txtmoney_AfterUpdate()\nMe.txtmoney.Value = Format(Me.txtmoney.Value, \"$#,##0.00\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11524030, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/688f77a61ae4dc09af9bf6dcf2714457?s=128&d=identicon&r=PG", "display_name": "Tyk", "link": "https://stackoverflow.com/users/11524030/tyk"}, "is_accepted": false, "score": 0, "last_activity_date": 1558275236, "creation_date": 1558275236, "answer_id": 56208634, "question_id": 28860017, "link": "https://stackoverflow.com/questions/28860017/format-number-in-userform-textbox/56208634#56208634", "title": "Format number in userform textbox", "body": "<p>Just format the destination columns to the number format, you won't have to bother wih the text box..</p>\n"}, {"tags": [], "owner": {"reputation": 375, "user_id": 6685262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94c769f8e2647455d97981099aeab934?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/6685262/daniel"}, "is_accepted": false, "score": 0, "last_activity_date": 1584991378, "creation_date": 1584991378, "answer_id": 60820274, "question_id": 28860017, "link": "https://stackoverflow.com/questions/28860017/format-number-in-userform-textbox/60820274#60820274", "title": "Format number in userform textbox", "body": "<p>Use the exit event to format, as change event tries to reformat as you type and may not allow you to even enter the whole number.</p>\n\n<pre><code>Private Sub TextBox1_Exit(ByVal Cancel As MSForms.ReturnBoolean)\n    TextBox1 = Format(TextBox1, \"$#,##0.00\")\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 13842899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee4385ad20f12d56689ed1950009c7e0?s=128&d=identicon&r=PG&f=1", "display_name": "TurtleCode", "link": "https://stackoverflow.com/users/13842899/turtlecode"}, "is_accepted": false, "score": 1, "last_activity_date": 1595885901, "last_edit_date": 1595885901, "creation_date": 1595884475, "answer_id": 63123672, "question_id": 28860017, "link": "https://stackoverflow.com/questions/28860017/format-number-in-userform-textbox/63123672#63123672", "title": "Format number in userform textbox", "body": "<p>I solved it writing this:</p>\n<pre><code>Range(&quot;A1&quot;).value = textbox1.value\n</code></pre>\n<p>instead of this</p>\n<pre><code>Range(&quot;A1&quot;).value = textbox1\n</code></pre>\n<p>In my case the <code>.value</code> made the difference.</p>\n"}], "owner": {"reputation": 21, "user_id": 4633041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/264c2cfdf040f148169641843a7bf7ee?s=128&d=identicon&r=PG&f=1", "display_name": "5kids", "link": "https://stackoverflow.com/users/4633041/5kids"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67649, "favorite_count": 1, "answer_count": 5, "score": 2, "last_activity_date": 1595885901, "creation_date": 1425487381, "last_edit_date": 1575875605, "question_id": 28860017, "link": "https://stackoverflow.com/questions/28860017/format-number-in-userform-textbox", "title": "Format number in userform textbox", "body": "<p>I have a texbox in a userform in which the user will input numbers. Those numbers will be tranfered to an Excel spreadsheet for calculation.</p>\n\n<p>I want that when the user inputs numbers in the Textbox it displays as a number in a specific format.</p>\n\n<p>For example: 2000000, I want it as 2,000,000.00 in the Textbox.</p>\n\n<p>I tried:</p>\n\n<pre><code>Public Sub UserForm_Initialize()    \n    TextBox1 = Format(TextBox1, \"$#,##0.00\")\nEnd Sub\n</code></pre>\n\n<p>But the Userform doesn't change.</p>\n\n<p>If I try the following</p>\n\n<pre><code>Private Sub TextBox1_Change()\n    TextBox1 = Format(TextBox1, \"$#,##0.00\")\nEnd Sub\n</code></pre>\n\n<p>The userform shows the number adequately, but then updates the Excel spreadsheet with a text format instead of number and the calculation doesn't run.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1425485446, "post_id": 28859230, "comment_id": 45984174, "body": "Just double the ones inside the formula string - <code>&quot;&quot;Col&quot;&quot;</code>"}, {"owner": {"reputation": 5, "user_id": 4622695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28dc80b4e4ba6464fb2832244d47c9fa?s=128&d=identicon&r=PG&f=1", "display_name": "szopax", "link": "https://stackoverflow.com/users/4622695/szopax"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1425917799, "post_id": 28859230, "comment_id": 46147589, "body": "thank you for the answer"}], "answers": [{"tags": [], "owner": {"reputation": 3671, "user_id": 1751792, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/HIRsS.jpg?s=128&g=1", "display_name": "Lopsided", "link": "https://stackoverflow.com/users/1751792/lopsided"}, "is_accepted": true, "score": 0, "last_activity_date": 1425485436, "creation_date": 1425485436, "answer_id": 28859272, "question_id": 28859230, "link": "https://stackoverflow.com/questions/28859230/adding-formula-for-drop-down-list-in-excel-vba-issue/28859272#28859272", "title": "Adding formula for drop down list in Excel VBA issue", "body": "<p>Use double quotes for literal expression...</p>\n\n<pre><code>With Range(\"H\" &amp; myRow &amp; \":H\" &amp; myRow).Validation\n.Delete\n.Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _\nOperator:=xlBetween, Formula1:=\"=OFFSET(INDIRECT($G13),0,0,COUNTA(INDIRECT($G13&amp;\"\"Col\"\")),1)\"\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 4622695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28dc80b4e4ba6464fb2832244d47c9fa?s=128&d=identicon&r=PG&f=1", "display_name": "szopax", "link": "https://stackoverflow.com/users/4622695/szopax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 660, "favorite_count": 0, "accepted_answer_id": 28859272, "answer_count": 1, "score": 0, "last_activity_date": 1425485436, "creation_date": 1425485315, "question_id": 28859230, "link": "https://stackoverflow.com/questions/28859230/adding-formula-for-drop-down-list-in-excel-vba-issue", "title": "Adding formula for drop down list in Excel VBA issue", "body": "<p>I have a VBA code that will create a drop down list when i double click a cell, but i want to change the formula for the drop down list so i can make dependent drop down lists. The problem is that the qoutes i use in the formula interfere with the ones delimiting the formula itself. I've put part of the code where the problem is down. Any help would be greatly appreciated.</p>\n\n<pre><code>With Range(\"H\" &amp; myRow &amp; \":H\" &amp; myRow).Validation\n.Delete\n.Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _\nOperator:=xlBetween, Formula1:=\"=OFFSET(INDIRECT($G13),0,0,COUNTA(INDIRECT($G13&amp;\"Col\")),1)\"\n</code></pre>\n\n<p>Thank you</p>\n"}, {"tags": ["excel", "vba", "formatting", "vlookup"], "comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 1, "creation_date": 1425486520, "post_id": 28859172, "comment_id": 45984975, "body": "I don&#39;t have time to do the code for this right now, but if you use the &quot;Match&quot; function instead of the VLookup function, then you use the num_col to get the actual cell that you are trying to copy.  Then if you use &quot;newcell.numberformat = oldcell.numberformat&quot; it will maintain the formatting."}, {"owner": {"reputation": 1985, "user_id": 3160820, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Y9E28.jpg?s=128&g=1", "display_name": "Trimax", "link": "https://stackoverflow.com/users/3160820/trimax"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1425553349, "post_id": 28859172, "comment_id": 46014598, "body": "@OpiesDad Thanks, I&#39;ll try it with Match method to locate the cell and then copy the value and the format."}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1425485550, "creation_date": 1425485550, "answer_id": 28859313, "question_id": 28859172, "link": "https://stackoverflow.com/questions/28859172/how-can-i-keep-the-date-format-from-a-vlookup-returned-value/28859313#28859313", "title": "How can I keep the date format from a VLookup returned value?", "body": "<p><code>VLOOKUP</code> doesn't care about the formatting of the data it's returning - it returns <em>data</em>, not <em>formats</em>.</p>\n\n<p>The only way to ensure the same format as the source, is to copy/paste that format, either manually or programmatically.</p>\n"}, {"tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": false, "score": 0, "last_activity_date": 1425494332, "creation_date": 1425494332, "answer_id": 28862298, "question_id": 28859172, "link": "https://stackoverflow.com/questions/28859172/how-can-i-keep-the-date-format-from-a-vlookup-returned-value/28862298#28862298", "title": "How can I keep the date format from a VLookup returned value?", "body": "<p>use this </p>\n\n<pre><code>Sheets(3).Cells(num_row, last_col_s1 + num_col - 1).Value = cdate(my_value)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 2623377, "user_type": "registered", "profile_image": "https://graph.facebook.com/1130673601/picture?type=large", "display_name": "Kenneth Westervelt", "link": "https://stackoverflow.com/users/2623377/kenneth-westervelt"}, "is_accepted": false, "score": 0, "last_activity_date": 1494865002, "creation_date": 1494865002, "answer_id": 43984342, "question_id": 28859172, "link": "https://stackoverflow.com/questions/28859172/how-can-i-keep-the-date-format-from-a-vlookup-returned-value/43984342#43984342", "title": "How can I keep the date format from a VLookup returned value?", "body": "<p>I had the same problem, and simply reformatted the VLOOKUP cell to also be in date-time format. That fixed my issue. I am not sure how date-time gets translated into a number, but it does. </p>\n"}, {"tags": [], "owner": {"reputation": 1838, "user_id": 4763959, "user_type": "registered", "accept_rate": 12, "profile_image": "https://graph.facebook.com/10204316548937223/picture?type=large", "display_name": "Shalini Baranwal", "link": "https://stackoverflow.com/users/4763959/shalini-baranwal"}, "is_accepted": false, "score": 0, "last_activity_date": 1501476834, "creation_date": 1501476834, "answer_id": 45407694, "question_id": 28859172, "link": "https://stackoverflow.com/questions/28859172/how-can-i-keep-the-date-format-from-a-vlookup-returned-value/45407694#45407694", "title": "How can I keep the date format from a VLookup returned value?", "body": "<p>i faced the same issue. After vlookup, change the format to \"ShortDate\" format. This will give you what you are looking for.</p>\n"}, {"tags": [], "owner": {"reputation": 111, "user_id": 6486100, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-t4VI7Udn6zw/AAAAAAAAAAI/AAAAAAAAAH4/y5bdXSD0N3c/photo.jpg?sz=128", "display_name": "Prasand Kumar", "link": "https://stackoverflow.com/users/6486100/prasand-kumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1501479079, "last_edit_date": 1501479079, "creation_date": 1501478937, "answer_id": 45408086, "question_id": 28859172, "link": "https://stackoverflow.com/questions/28859172/how-can-i-keep-the-date-format-from-a-vlookup-returned-value/45408086#45408086", "title": "How can I keep the date format from a VLookup returned value?", "body": "<p>Excel Formula :</p>\n\n<pre><code>=TEXT(VLOOKUP(Lookup_value,table_array,col_index_num,0),\"dd-mm-yyyy\")\n</code></pre>\n\n<p>VBA :</p>\n\n<pre><code>Sub vlookup_code()\n\n    Dim table_rng As Range\n\n    'FOR THE TIME BEING GIVING A LOOKUP VALUE\n    look_up_value = \"sekar\"\n\n    'SETTING THE TABLE ARRAY RANGE\n    Set table_rng = Sheet1.Range(\"C3\").CurrentRegion\n\n    'SINCE VLOOKUP WILL GIVE AN ERROR, IF THE LOOKUP VALUE IS NOT PRESENT\n    'TO HANDLE THIS ERROR, WE USE THE ISERROR STATEMENT\n    If IsError(Application.vlookup(look_up_value, table_rng, 2, 0)) = False Then\n\n        vlook_value = WorksheetFunction.vlookup(look_up_value, table_rng, 2, False)\n\n        'CHANGING THE VLOOKUP VALUE FORMAT TO DATE FORMAT\n        date_format = WorksheetFunction.Text(vlook_value, \"dd-mm-yyyy\")\n\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8492933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f76489061c29dcacb02eed5e6cee4df?s=128&d=identicon&r=PG&f=1", "display_name": "Sharif", "link": "https://stackoverflow.com/users/8492933/sharif"}, "is_accepted": false, "score": 0, "last_activity_date": 1509374286, "creation_date": 1509374286, "answer_id": 47017951, "question_id": 28859172, "link": "https://stackoverflow.com/questions/28859172/how-can-i-keep-the-date-format-from-a-vlookup-returned-value/47017951#47017951", "title": "How can I keep the date format from a VLookup returned value?", "body": "<p>In Microsoft Office 2016.</p>\n\n<p>Once data copied to the cell. Select the column which needs to be in date format. Right click->format cells, go to Number tab and select date from the drop-down and choose the required date format, data will be converted to date format.</p>\n"}], "owner": {"reputation": 1985, "user_id": 3160820, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Y9E28.jpg?s=128&g=1", "display_name": "Trimax", "link": "https://stackoverflow.com/users/3160820/trimax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20461, "favorite_count": 0, "answer_count": 6, "score": 4, "last_activity_date": 1609138970, "creation_date": 1425485130, "question_id": 28859172, "link": "https://stackoverflow.com/questions/28859172/how-can-i-keep-the-date-format-from-a-vlookup-returned-value", "title": "How can I keep the date format from a VLookup returned value?", "body": "<p>I have a sheet whit mixed format data (dates, double, strings, etc.).\nI search the value (my_index) in the lookup_range and I want to retrieve the data to change with it a cell in other sheet.  It works fine, but when the value returned by VLookup is a date and I set it to the other sheet it looses its date format.</p>\n\n<pre><code>Dim lookup_range As Range\nDim my_index, my_value As Variant\n\nmy_value = Application.VLookup(my_index, lookup_range, num_col, False)\nSheets(3).Cells(num_row, last_col_s1 + num_col - 1).Value = my_value\n</code></pre>\n\n<p>So, when the data in the lookup_range is <code>02/05/2014</code> the data showed at sheet-3 looks like <code>41761</code>.</p>\n\n<p>I need to keep the original data format of the data in the lookup_range.</p>\n"}, {"tags": ["vba", "loops", "excel"], "answers": [{"comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1425485233, "post_id": 28858969, "comment_id": 45984009, "body": "Slight issue - you need to qualify the <i>destination range</i> parameter to <code>TextToColumns</code> with a sheet too."}, {"owner": {"reputation": 15, "user_id": 4472997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/211f304dfe3d17683da1a4824da44517?s=128&d=identicon&r=PG&f=1", "display_name": "Rachel Dear", "link": "https://stackoverflow.com/users/4472997/rachel-dear"}, "edited": false, "score": 0, "creation_date": 1425674421, "post_id": 28858969, "comment_id": 46073946, "body": "Thanks a lot, I was being v obtuse there! Will rerun with this Mon."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 4, "last_activity_date": 1425485286, "last_edit_date": 1425485286, "creation_date": 1425484646, "answer_id": 28858969, "question_id": 28858910, "link": "https://stackoverflow.com/questions/28858910/looping-through-sheets-is-not-working/28858969#28858969", "title": "Looping through sheets is not working", "body": "<p>Your <code>With</code> block isn't qualifying the objects.</p>\n\n<pre><code>For i = 1 To Sheets.Count\n    Columns(\"A:A\").Select\n    Selection.TextToColumns Destination:=Range(\"A1\"), DataType:=xlDelimited, _\n        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _\n        Semicolon:=False, Comma:=False, Space:=False, Other:=False, FieldInfo _\n        :=Array(1, 4), TrailingMinusNumbers:=True\nNext i\n</code></pre>\n\n<p>Uqualified objects like <code>Columns(\"A:A\")</code> always refer to the <code>ActiveSheet</code> within the <code>ActiveWorkbook</code>.  You have a <code>With</code> block, but you're not associating this object with that <code>With</code> block.</p>\n\n<p>Try this:</p>\n\n<pre><code>For i = 1 To .Sheets.Count\n    .Sheets(i).Columns(\"A:A\").TextToColumns Destination:=.Range(\"A1\"), DataType:=xlDelimited, _\n        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _\n        Semicolon:=False, Comma:=False, Space:=False, Other:=False, FieldInfo _\n        :=Array(1, 4), TrailingMinusNumbers:=True\nNext i\n</code></pre>\n\n<p>Or, <strong>my preference</strong> would be to just use <code>For Each</code>, there's no reason to do an indexed loop in this case:</p>\n\n<pre><code>Dim ws as Worksheet\nWith wb\n    For each ws in .Worksheets\n        ws.Columns(\"A:A\").TextToColumns Destination:=ws.Range(\"A1\"), ...\n\n\n    Next\n    .Save\n    .Close\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 1, "last_activity_date": 1425484776, "creation_date": 1425484776, "answer_id": 28859015, "question_id": 28858910, "link": "https://stackoverflow.com/questions/28858910/looping-through-sheets-is-not-working/28859015#28859015", "title": "Looping through sheets is not working", "body": "<p>You're not specifying which sheet the code should work on and you need to qualify <em>all</em> the ranges:</p>\n\n<pre><code>Sub WMC()\n\nDim wb As Workbook\nSet wb = Workbooks.Open(Filename:=\"G:\\filedirectory.xls\")\n\nWith wb\n\nFor i = 1 To .Sheets.Count\nWith .Sheets(i)\n.Columns(\"A:A\").TextToColumns Destination:=.Range(\"A1\"), DataType:=xlDelimited, _\nTextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _\nSemicolon:=False, Comma:=False, Space:=False, Other:=False, FieldInfo _\n:=Array(1, 4), TrailingMinusNumbers:=True\nEnd With\nNext i\n\n.Save\n.Close\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 4472997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/211f304dfe3d17683da1a4824da44517?s=128&d=identicon&r=PG&f=1", "display_name": "Rachel Dear", "link": "https://stackoverflow.com/users/4472997/rachel-dear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 803, "favorite_count": 0, "accepted_answer_id": 28858969, "answer_count": 2, "score": 0, "last_activity_date": 1425485286, "creation_date": 1425484480, "question_id": 28858910, "link": "https://stackoverflow.com/questions/28858910/looping-through-sheets-is-not-working", "title": "Looping through sheets is not working", "body": "<p>I'm using the below code</p>\n\n<pre><code>Sub WMC()\n\nDim wb As Workbook\nSet wb = Workbooks.Open(Filename:=\"G:\\filedirectory.xls\")\n\nWith wb\n\nFor i = 1 To Sheets.Count\nColumns(\"A:A\").Select\nSelection.TextToColumns Destination:=Range(\"A1\"), DataType:=xlDelimited, _\nTextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _\nSemicolon:=False, Comma:=False, Space:=False, Other:=False, FieldInfo _\n:=Array(1, 4), TrailingMinusNumbers:=True\nNext i\n\nEnd With\n\nActiveWorkbook.Save\nActiveWorkbook.Close\n\nEnd Sub\n</code></pre>\n\n<p>For some reason the loop runs but doesn't move from one sheet to the next - I think it just runs the same code on the first sheet in the workbook about ten times (as I have 10 sheets). If I remove the loop it runs once and closes so the code recognizes the loop, it just doesn't follow it. I've tried variations on the above but I get the same issue each time.</p>\n\n<p>Any thoughts would be much appreciated.</p>\n\n<p>Danke</p>\n\n<p>Rachel</p>\n"}, {"tags": ["excel", "for-loop", "next", "vba"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1425543132, "post_id": 28858785, "comment_id": 46008516, "body": "If you have data in column B then you should be able to use:B65535"}], "answers": [{"tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": false, "score": 1, "last_activity_date": 1425484637, "creation_date": 1425484637, "answer_id": 28858965, "question_id": 28858785, "link": "https://stackoverflow.com/questions/28858785/vba-excel-next-row-for-loop/28858965#28858965", "title": "vba excel - next row for loop", "body": "<pre><code>.Range(\"A65535\").End(xlUp).Row\n</code></pre>\n\n<p>This will return the row number of the last empty row in the worksheet (for column A). If A2 in \"Temp Log\" is empty and every row above it is empty your FOR loop will look like:</p>\n\n<pre><code>For r = 2 to 2\n</code></pre>\n\n<p>Which will iterate exactly 0 times.</p>\n"}, {"tags": [], "owner": {"reputation": 468, "user_id": 4628327, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MH5Ee.png?s=128&g=1", "display_name": "Ralph J", "link": "https://stackoverflow.com/users/4628327/ralph-j"}, "is_accepted": false, "score": 1, "last_activity_date": 1425494336, "last_edit_date": 1425494336, "creation_date": 1425491795, "answer_id": 28861506, "question_id": 28858785, "link": "https://stackoverflow.com/questions/28858785/vba-excel-next-row-for-loop/28861506#28861506", "title": "vba excel - next row for loop", "body": "<p>IF A2 is empty AND everything below it is empty, what result do you want?  Fill only A2 with your TotalValue and stop, or keep on filling everything below A2 down to the bottom of the worksheet?</p>\n\n<p>If your .Range(#).End(xlUp).Row finds nothing in A2 nor anywhere below it, it will return 1 (not 2), and your loop would be</p>\n\n<pre><code>For R = 2 to 1\n</code></pre>\n\n<p>And that will be skipped.  (A loop with <code>For r = 2 to 2</code> WILL run, once, with r = 2).</p>\n\n<p>You may want to define the bottom row, and depending on what you find, either fill A2 with TotalValue and stop, or (if something below A2 IS populated) fill everything empty from A2 down to that last row using the loop as you have.</p>\n\n<p>Or if I've missed your intent, please explain further.</p>\n"}], "owner": {"reputation": 251, "user_id": 4233291, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/dca7b89667f1cb99a16263879305ac9b?s=128&d=identicon&r=PG&f=1", "display_name": "pexpex223", "link": "https://stackoverflow.com/users/4233291/pexpex223"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3178, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1425494336, "creation_date": 1425484137, "last_edit_date": 1531164843, "question_id": 28858785, "link": "https://stackoverflow.com/questions/28858785/vba-excel-next-row-for-loop", "title": "vba excel - next row for loop", "body": "<p>I made a vba code which I want to click on a button (testing1) to check whether range A2 in WS \"temp log\" is empty, if yes, insert value of range H1 from WS \"Main\". however, when i run through my code,  it will go to this line.<code>For r = 2 To .Range(\"AA65535\").End(xlUp).Row</code></p>\n\n<p>and it will jump to <code>end with</code> (Temp log).</p>\n\n<p>Could someone explain that why wouldn't the code run through the for loop please?</p>\n\n<pre><code>Sub testing1()\n\nDim r As Integer    \nDim totalValue As Object\n\nWith Worksheets(\"Main\")\n\n     Set totalValue = .Range(\"H1\")\n\nEnd With\n\nWith Worksheets(\"Temp log\")\n\n\n\n          For r = 2 To .Range(\"A65535\").End(xlUp).Row\n\n                If IsEmpty(.Cells(r, \"A\").Value) = True Then\n\n                   .Cells(r, \"A\").Value = totalValue\n\n                End If\n\n          Next r\nend with \n\nend sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "date", "vlookup", "mismatch"], "answers": [{"comments": [{"owner": {"reputation": 132, "user_id": 4506894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9cc78acf6a22cd0cf1c92f12170392?s=128&d=identicon&r=PG", "display_name": "aurezio", "link": "https://stackoverflow.com/users/4506894/aurezio"}, "edited": false, "score": 0, "creation_date": 1425484935, "post_id": 28858860, "comment_id": 45983805, "body": "Thanks for the answer but I keep getting the type mismatch error even after your edits..."}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "reply_to_user": {"reputation": 132, "user_id": 4506894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9cc78acf6a22cd0cf1c92f12170392?s=128&d=identicon&r=PG", "display_name": "aurezio", "link": "https://stackoverflow.com/users/4506894/aurezio"}, "edited": false, "score": 0, "creation_date": 1425485097, "post_id": 28858860, "comment_id": 45983914, "body": "Are the values in your &quot;date&quot; column stored as dates?"}, {"owner": {"reputation": 132, "user_id": 4506894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9cc78acf6a22cd0cf1c92f12170392?s=128&d=identicon&r=PG", "display_name": "aurezio", "link": "https://stackoverflow.com/users/4506894/aurezio"}, "edited": false, "score": 0, "creation_date": 1425485748, "post_id": 28858860, "comment_id": 45984396, "body": "Yes they are... Anyway it worked with the suggestion below. Thanks Kyle for your time!"}], "tags": [], "owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "is_accepted": false, "score": 0, "last_activity_date": 1425484371, "creation_date": 1425484371, "answer_id": 28858860, "question_id": 28858712, "link": "https://stackoverflow.com/questions/28858712/vba-vlookup-with-date-returns-a-type-mismatch-error/28858860#28858860", "title": "Vba Vlookup with date returns a type mismatch error", "body": "<p>Try this. Declaring a string and formatting that allows you to have the \"02-mar-15\" format. In your current code type \"Debug.Print Giov\" below the line where you assign GIOV a value. You will see in the immediate window that GIOV = \"5/15/2015\" or a date in that style.</p>\n\n<pre><code>Sub FINDDATA()\nDim Giov As String\nDim ImpPag As Variant\n\nGiov = Format(Date + 1, \"dd-mmm-yy\")\nImpPag = Application.VLookup(Giov, Range(\"A5:B9\"), 2, False)\nMsgBox ImpPag\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 132, "user_id": 4506894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9cc78acf6a22cd0cf1c92f12170392?s=128&d=identicon&r=PG", "display_name": "aurezio", "link": "https://stackoverflow.com/users/4506894/aurezio"}, "edited": false, "score": 0, "creation_date": 1425485597, "post_id": 28859131, "comment_id": 45984288, "body": "It worked! Thanks a lot! Now I have to put the ImpPag value in a email body. Have I to open another question? I already have the non-working code"}, {"owner": {"reputation": 1623, "user_id": 3745431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bd2fefe0413a3f56e3ac7104ae26dde?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/3745431/dave"}, "reply_to_user": {"reputation": 132, "user_id": 4506894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9cc78acf6a22cd0cf1c92f12170392?s=128&d=identicon&r=PG", "display_name": "aurezio", "link": "https://stackoverflow.com/users/4506894/aurezio"}, "edited": false, "score": 0, "creation_date": 1425486716, "post_id": 28859131, "comment_id": 45985102, "body": "Yes, a new question is the best option as it allows people searching for similar issues to find it easier."}], "tags": [], "owner": {"reputation": 1623, "user_id": 3745431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bd2fefe0413a3f56e3ac7104ae26dde?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/3745431/dave"}, "is_accepted": true, "score": 1, "last_activity_date": 1425485039, "creation_date": 1425485039, "answer_id": 28859131, "question_id": 28858712, "link": "https://stackoverflow.com/questions/28858712/vba-vlookup-with-date-returns-a-type-mismatch-error/28859131#28859131", "title": "Vba Vlookup with date returns a type mismatch error", "body": "<p>In Excel, dates are usually stored as a number and only shown as a string in formatting. You can check this by changing the number formatting on the date cells in your spreadsheet. </p>\n\n<p>In this case, the date you are looking up (05/03/2015) is actually stored as 42068. If you declare Giov as a Long data type you can pass the current date + 1 into the lookup. I have added a msgbox so you can see the stored date as a Long Integer before doing the lookup:</p>\n\n<pre><code>Sub FINDDATA()\nDim Giov As Long\nDim ImpPag As Variant\n\nGiov = Date + 1\nMsgBox Giov\nImpPag = Application.VLookup(Giov, Range(\"A5:B9\"), 2, False)\nMsgBox ImpPag\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 132, "user_id": 4506894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9cc78acf6a22cd0cf1c92f12170392?s=128&d=identicon&r=PG", "display_name": "aurezio", "link": "https://stackoverflow.com/users/4506894/aurezio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1703, "favorite_count": 0, "accepted_answer_id": 28859131, "answer_count": 2, "score": 0, "last_activity_date": 1425485039, "creation_date": 1425484006, "question_id": 28858712, "link": "https://stackoverflow.com/questions/28858712/vba-vlookup-with-date-returns-a-type-mismatch-error", "title": "Vba Vlookup with date returns a type mismatch error", "body": "<p>I'm trying to find a value with a Vlookup function in VBA but I get a type mismatch error on the msgbox line.</p>\n\n<p>The lookup_value is tomorrow</p>\n\n<p>Here is the code</p>\n\n<pre><code>Sub FINDDATA()\nDim Giov As Date\nDim ImpPag As Variant\n\nGiov = Format(Date + 1, \"Short Date\")\nImpPag = Application.VLookup(Giov, Range(\"A5:B9\"), 2, False)\nMsgBox ImpPag\nEnd Sub\n</code></pre>\n\n<p>And here is the array</p>\n\n<pre><code>date        value\n05-mar-15   \u20ac1.000,00 \n12-mar-15   \u20ac2.000,00 \n19-mar-15   \u20ac3.000,00 \n26-mar-15   \u20ac4.000,00\n</code></pre>\n\n<p>Can I have a little help? thanks</p>\n"}, {"tags": ["excel", "vba", "date"], "answers": [{"tags": [], "owner": {"reputation": 447, "user_id": 4047422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45d74770311e0150280317207c5dc9c7?s=128&d=identicon&r=PG&f=1", "display_name": "Rob Cutmore", "link": "https://stackoverflow.com/users/4047422/rob-cutmore"}, "is_accepted": false, "score": 0, "last_activity_date": 1425486288, "creation_date": 1425486288, "answer_id": 28859601, "question_id": 28858682, "link": "https://stackoverflow.com/questions/28858682/2-different-dates-from-the-same-formula-today/28859601#28859601", "title": "2 different dates from the same formula =TODAY()", "body": "<p>You can try setting the format of the cell in VBA while you are setting its content.</p>\n\n<pre><code>With Cells(emptyRow, 2)\n    .Value = \"=TODAY()\"\n    .NumberFormat = \"dd/mm/yyyy\"\nEnd With\n</code></pre>\n\n<p>This will at least keep the format you'd like for the cells being set from VBA.</p>\n"}], "owner": {"reputation": 142, "user_id": 2432125, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/4ecda6d70462899571eab858bc37537c?s=128&d=identicon&r=PG", "display_name": "Tom36", "link": "https://stackoverflow.com/users/2432125/tom36"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1425486288, "creation_date": 1425483915, "question_id": 28858682, "link": "https://stackoverflow.com/questions/28858682/2-different-dates-from-the-same-formula-today", "title": "2 different dates from the same formula =TODAY()", "body": "<p>I am entering a date into a cell (B2) using VBA\n     Cells(emptyRow, 2).Value = \"TODAY()\"</p>\n\n<p>This brings up the date in US format e.g 03/04/2015 (4th March 2015)</p>\n\n<p>If I enter the formula =TODAY() directly into the cell (not using VBA) it shows the date in UK formatt e.g. 04/03/2015 (4th March 2015).</p>\n\n<p>Can anyone help me with the reason for this please and how to keep it in UK formatt no matter what the users locale setting is.</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 133, "user_id": 4021883, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/512303933/picture?type=large", "display_name": "Alan Treanor", "link": "https://stackoverflow.com/users/4021883/alan-treanor"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1425508713, "post_id": 28858610, "comment_id": 45997810, "body": "It&#39;s not returning an error but it&#39;s not returning a value of the count if it matches the criteria"}, {"owner": {"reputation": 133, "user_id": 4021883, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/512303933/picture?type=large", "display_name": "Alan Treanor", "link": "https://stackoverflow.com/users/4021883/alan-treanor"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1425509593, "post_id": 28858610, "comment_id": 45998166, "body": "How do you mean @pnuts the sheet reference being the wrong way round? I&#39;ve tried to use the formula in the answer below?"}, {"owner": {"reputation": 133, "user_id": 4021883, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/512303933/picture?type=large", "display_name": "Alan Treanor", "link": "https://stackoverflow.com/users/4021883/alan-treanor"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1425510117, "post_id": 28858610, "comment_id": 45998384, "body": "Sheet1 is pickdata sorry I realise what I had done with the formula! Additionally when I remove the column A greater than zero it gives me a value!"}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 4021883, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/512303933/picture?type=large", "display_name": "Alan Treanor", "link": "https://stackoverflow.com/users/4021883/alan-treanor"}, "edited": false, "score": 0, "creation_date": 1425508669, "post_id": 28858819, "comment_id": 45997797, "body": "Unfortunately that didn&#39;t return a value of 1 when I done the slight change :-/"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 133, "user_id": 4021883, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/512303933/picture?type=large", "display_name": "Alan Treanor", "link": "https://stackoverflow.com/users/4021883/alan-treanor"}, "edited": false, "score": 0, "creation_date": 1425509310, "post_id": 28858819, "comment_id": 45998044, "body": "It should return the amount of rows that fit these criteria, not the value of 1.  When do you expect it to return the value of 1?  What did it return?"}, {"owner": {"reputation": 133, "user_id": 4021883, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/512303933/picture?type=large", "display_name": "Alan Treanor", "link": "https://stackoverflow.com/users/4021883/alan-treanor"}, "edited": false, "score": 0, "creation_date": 1425509539, "post_id": 28858819, "comment_id": 45998145, "body": "If I purposely setup one line to match the criteria Id expect 1 however all cities/towns are showing zero even though multiple match the criteria."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 133, "user_id": 4021883, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/512303933/picture?type=large", "display_name": "Alan Treanor", "link": "https://stackoverflow.com/users/4021883/alan-treanor"}, "edited": false, "score": 0, "creation_date": 1425510008, "post_id": 28858819, "comment_id": 45998342, "body": "Your explanation was unclear. It sounds like you are trying to copy the formula down in each row and list either 1 or zero for the row if this data exists in the other sheet.  Your formula was always looking at column E in sheet 1.  Try the proposed edit and you should at least get positive values."}, {"owner": {"reputation": 133, "user_id": 4021883, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/512303933/picture?type=large", "display_name": "Alan Treanor", "link": "https://stackoverflow.com/users/4021883/alan-treanor"}, "edited": false, "score": 0, "creation_date": 1425599598, "post_id": 28858819, "comment_id": 46041073, "body": "I think I&#39;ve figured a way to do this! It couldn&#39;t do the greater than blank formula so I added a column into pick data which is a simple if greater than blank true else false! Now my count if formula looks for the true statement and returns the value."}, {"owner": {"reputation": 133, "user_id": 4021883, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/512303933/picture?type=large", "display_name": "Alan Treanor", "link": "https://stackoverflow.com/users/4021883/alan-treanor"}, "edited": false, "score": 0, "creation_date": 1425599613, "post_id": 28858819, "comment_id": 46041076, "body": "Thanks for the help :-)"}], "tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": false, "score": 0, "last_activity_date": 1425510074, "last_edit_date": 1425510074, "creation_date": 1425484231, "answer_id": 28858819, "question_id": 28858610, "link": "https://stackoverflow.com/questions/28858610/count-if-multiple-criteria-data-types-match/28858819#28858819", "title": "Count IF multiple criteria/data types match", "body": "<p>The problem with your previous formula is in the final criteria.  Update to:</p>\n\n<pre><code>=COUNTIFS(PickData!D:D,Sheet1!A2,PickData!L:L,Sheet1!E2,PickData!A:A,\"&gt;0\")\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 4021883, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/512303933/picture?type=large", "display_name": "Alan Treanor", "link": "https://stackoverflow.com/users/4021883/alan-treanor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 508, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1425510074, "creation_date": 1425483746, "question_id": 28858610, "link": "https://stackoverflow.com/questions/28858610/count-if-multiple-criteria-data-types-match", "title": "Count IF multiple criteria/data types match", "body": "<p>I'm looking to generate a report to list the number of Cities/Towns that don't meet a certain criteria so on Sheet 2 I have an alphabetical list of all the cities/towns. </p>\n\n<p>I want to do a look up/count if function to state if A2(Sheet 2) can be found anywhere in Column D on Sheet 1 then count it if the date in column L (sheet 1) matches the date in Cell $E$1 (sheet 2) and Column A in Sheet 1 is greater than zero.</p>\n\n<p>I originally done this formula but it is returning an error.</p>\n\n<blockquote>\n  <p>=COUNTIFS(PickData!D:D,Sheet1!A2,PickData!L:L,Sheet1!$E$1,PickData!A:A,PickData!A:A>0)</p>\n</blockquote>\n\n<p>Is there any other formulas that I'm currently not thinking of? Or is it possible to do this via VBA and it returns the value in to column B either True if it matches or False if it doesn't?</p>\n\n<p>Thanks\nAl</p>\n"}, {"tags": ["vba", "unicode", "arabic", "powerpoint"], "comments": [{"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1425518155, "post_id": 28858551, "comment_id": 46000948, "body": "&quot;and always come with and error in the &#39;open&#39; function&quot;  What&#39;s the error message (or your best guess at a translation, in case it&#39;s not in English)"}, {"owner": {"reputation": 33, "user_id": 4632789, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153078788404286/picture?type=large", "display_name": "Andrew Raafat", "link": "https://stackoverflow.com/users/4632789/andrew-raafat"}, "reply_to_user": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1425558104, "post_id": 28858551, "comment_id": 46017269, "body": "actually it&#39;s a plain run time error every time <a href=\"http://i.imgur.com/6zKPDVx.png\" rel=\"nofollow noreferrer\">i.imgur.com/6zKPDVx.png</a>"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1425663922, "post_id": 28858551, "comment_id": 46068495, "body": "Can you post an example file on DropBox or the like?  The contents don&#39;t matter, so long as it has a name in Arabic like the ones you&#39;re working with."}, {"owner": {"reputation": 33, "user_id": 4632789, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153078788404286/picture?type=large", "display_name": "Andrew Raafat", "link": "https://stackoverflow.com/users/4632789/andrew-raafat"}, "reply_to_user": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1425723907, "post_id": 28858551, "comment_id": 46085839, "body": "sure, here is an example file <a href=\"https://www.dropbox.com/s/d2bkclpbo5y5s97/%D9%85%D9%84%D9%81%20%D8%A8%D8%A3%D8%B3%D9%85%20%D8%B9%D8%B1%D8%A8%D9%8A.ppt?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/d2bkclpbo5y5s97/&hellip;</a>"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1425781178, "post_id": 28858551, "comment_id": 46101835, "body": "Thanks.  I think the problem is that VB corrupts the file name when returning it from Dir$, so it&#39;s broken before it starts. I did a bit of googling and found this, which might help:  <a href=\"http://www.vbforums.com/showthread.php?555086-RESOLVED-Unicode-file-names&amp;highlight=FindNextFileW/#4...don&#39;t\" rel=\"nofollow noreferrer\">vbforums.com/&hellip;</a>"}], "owner": {"reputation": 33, "user_id": 4632789, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153078788404286/picture?type=large", "display_name": "Andrew Raafat", "link": "https://stackoverflow.com/users/4632789/andrew-raafat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 460, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1425483583, "creation_date": 1425483583, "last_edit_date": 1495539805, "question_id": 28858551, "link": "https://stackoverflow.com/questions/28858551/opening-files-with-arabic-unicode-characters-in-the-address-power-point-vba", "title": "Opening files with arabic Unicode characters in the address (Power Point VBA)", "body": "<p>I am trying to open a folder full of powerpoint files all with arabic (unicode) names and and edit them, then I knew about VBA and found this code <a href=\"http://www.pptfaq.com/FAQ00740_Batch_re-save_presentations-_update_older_presentations_to_newer_PowerPoint_version.htm\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>yet when I tried to use it it doesn't open the files and always come with and error in the 'open' function </p>\n\n<p>I also tried this solution <a href=\"https://stackoverflow.com/a/14292614\">here</a>  too -the StrConv function - but it doesn't seem to work either.</p>\n\n<p>here is my final code\n<pre>\nSub BatchSave()\n' Opens each PPT in the target folder and saves as PPT97-2003 format</p>\n\n<code>Dim sFolder As String\nDim sPresentationName As String\nDim oPresentation As Presentation\n\n' Get the foldername:\n\n'sFolder = InputBox(\"Folder containing PPT files to process\", \"Folder\")\nsFolder = \"E:\\taranem\\tttt\\tranem\"\nIf sFolder = \"\" Then\n    Exit Sub\nEnd If\n\n' Make sure the folder name has a trailing backslash\nIf Right$(sFolder, 1) &lt;&gt; \"\\\" Then\n    sFolder = sFolder &amp; \"\\\"\nEnd If\n\n' Are there PPT files there?\nIf Len(Dir$(sFolder &amp; \"*.PPT\")) = 0 Then\n    MsgBox \"Bad folder name or no PPT files in folder.\"\n    Exit Sub\nEnd If\n\n' Open and save the presentations\nsPresentationName = Dir$(sFolder &amp; \"*.ppt\")\nWhile sPresentationName &lt;&gt; \"\"\n    f = sFolder &amp; StrConv(sPresentationName, vbFromUnicode)\n    Set oPresentation = Presentations.Open(f, , , False)\n    Call oPresentation.SaveAs(sFolder &amp; \"N_\" &amp; sPresentationName, ppSaveAsShow)\n    oPresentation.Close\n    ' New presentation is now saved as N_originalname.ppt\n    ' Now let's rename them - comment out the next couple lines\n    '   if you don't want to do this\n    ' Original.PPT to Original.PPT.OLD\n    Name sFolder &amp; sPresentationName As sFolder &amp; sPresentationName &amp; \".OLD\"\n    ' N_Original.PPT to Original.PPT\n    Name sFolder &amp; \"N_\" &amp; sPresentationName As sFolder &amp; sPresentationName\n    sPresentationName = Dir$()\nWend\n\nMsgBox \"DONE\"\n\nEnd Sub\n</code></pre>\n\n<p></p>\n\n<p>indentation is missed up I know xD</p>\n"}, {"tags": ["vba", "excel", "header"], "answers": [{"tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": false, "score": 2, "last_activity_date": 1425482723, "creation_date": 1425482723, "answer_id": 28858219, "question_id": 28858051, "link": "https://stackoverflow.com/questions/28858051/find-header-in-vba/28858219#28858219", "title": "Find header in VBA", "body": "<p>Change the FIND method to find only an entire, and not a partial, match. Just make sure that this doesn't have negative consequences elsewhere.</p>\n\n<pre><code>Set rngHdrFound = rngHeaders.Find(HEADER_NAME,,,xlWhole)\n</code></pre>\n"}], "owner": {"reputation": 179, "user_id": 4581009, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e687e8e16444ce76b07e9ada1cd27bf4?s=128&d=identicon&r=PG&f=1", "display_name": "Philip", "link": "https://stackoverflow.com/users/4581009/philip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 679, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1438325775, "creation_date": 1425482301, "question_id": 28858051, "link": "https://stackoverflow.com/questions/28858051/find-header-in-vba", "title": "Find header in VBA", "body": "<p>I have a function in VBA that finds headers and selects the column below the header.  It works beautifully except for one instance where I am trying to find a column with CLIENT as the header and it keeps selecting the column with \"CLIENT ID as the header (which is right next to it).  I was trying to put something in the function to handle this but everytime I try to, it just fails.  Any help with this issue would be greatly appreciated! </p>\n\n<pre><code>Function FindHeader(HEADER_NAME As String, sheetName As String) As Range\n\n    Dim rngHeaders As Range\n    Dim rngHdrFound As Range\n\n    Const ROW_HEADERS As Integer = 1\n\n    Set rngHeaders = Intersect(Worksheets(sheetName).UsedRange, Worksheets(sheetName).Rows(ROW_HEADERS))\n    Set rngHdrFound = rngHeaders.Find(HEADER_NAME)\n\n    If rngHdrFound Is Nothing Then\n       MsgBox (\"ERROR: Cannot find appropriate header.\")\n        Exit Function\n    ElseIf rngHdrFound = \"CLIENT\" Then\n     'Handle Client range here   \n    End If\n\n  Set FindHeader = Range(rngHdrFound.Offset(1), rngHdrFound.End(xlDown))\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 93, "user_id": 4570045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70bfa73fea7427e9819d28f1edf6c83?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Wickett", "link": "https://stackoverflow.com/users/4570045/mark-wickett"}, "is_accepted": true, "score": 0, "last_activity_date": 1425515805, "creation_date": 1425515805, "answer_id": 28867935, "question_id": 28857616, "link": "https://stackoverflow.com/questions/28857616/populate-cells-using-drop-downlist/28867935#28867935", "title": "Populate Cells using Drop downlist", "body": "<p>If you're selecting multiple cells, then you have more than one row and/or column in your <code>Target</code> range, so statements referencing <code>.Column</code> and <code>.Row</code> are going to be ambiguous.</p>\n\n<p>If you wrap this code in a loop that steps through each cell within the range, it should update the whole range, not just the first cell.</p>\n"}], "owner": {"reputation": 3, "user_id": 4054759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8129c1e2bc3665fcc38032b73f90642f?s=128&d=identicon&r=PG&f=1", "display_name": "Chi Vai", "link": "https://stackoverflow.com/users/4054759/chi-vai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 28867935, "answer_count": 1, "score": 0, "last_activity_date": 1425515805, "creation_date": 1425481064, "last_edit_date": 1425481672, "question_id": 28857616, "link": "https://stackoverflow.com/questions/28857616/populate-cells-using-drop-downlist", "title": "Populate Cells using Drop downlist", "body": "<p>I am working on a VBA application, where when I select an option from a drop down list (created using data validation) a few columns should populate automatically. It is working fine if I select an option from the drop down list for each cell individually. However if I drag down an option over a few rows, only the data for the top row gets populated whereas that for the remaining rows do not. How do I tackle this? This is my code under Worksheet_Change function</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As range)\nIf Target.Column = 22 Then\n    ThisRow = Target.Row\n    On Error GoTo ExitSub\n    If Target.Value = \"E\" Then\n        range(\"W\" &amp; ThisRow).Value = range(\"R\" &amp; ThisRow).Value\n        range(\"X\" &amp; ThisRow).Value = \"\"\n    On Error GoTo 0\n    ElseIf Target.Value = \"T\" Then\n        range(\"W\" &amp; ThisRow).Value = \"\"\n        range(\"X\" &amp; ThisRow).Value = range(\"S\" &amp; ThisRow).Value\n    ElseIf Target.Value = \"M\" Then\n        range(\"W\" &amp; ThisRow).Value = \"\"\n        range(\"X\" &amp; ThisRow).Value = \"\"\n    ElseIf Target.Value = \"N\" Then\n        range(\"W\" &amp; ThisRow).Value = 0\n       range(\"X\" &amp; ThisRow).Value = 0\n    ElseIf Target.Value = \"R\" Then\n        range(\"W\" &amp; ThisRow).Value = range(\"T\" &amp; ThisRow).Value\n        range(\"X\" &amp; ThisRow).Value = range(\"U\" &amp; ThisRow).Value\n    End If\nEnd If\nExit Sub\nExitSub:\nExit Sub\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "if-statement", "vba"], "answers": [{"tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": true, "score": 0, "last_activity_date": 1425481110, "creation_date": 1425481110, "answer_id": 28857632, "question_id": 28857486, "link": "https://stackoverflow.com/questions/28857486/excel-if-column-against-other-column/28857632#28857632", "title": "excel - if column against other column", "body": "<p>Using <code>Array Formulas</code> is one possibility. Note: With <code>Array Formulas</code>, you have to confirm them by pressing CTRL+SHIFT+ENTER.</p>\n\n<p>Not on time: <code>=SUM(IF((Sheet1!$A$2:$A$26)&lt;=(Sheet1!$B$2:$B$26),1,0))</code></p>\n\n<p>On Time: <code>=SUM(IF((Sheet1!$A$2:$A$26)&lt;=(Sheet1!$B$2:$B$26),1,0))</code></p>\n\n<p>Does that do the trick?</p>\n"}, {"tags": [], "owner": {"reputation": 204, "user_id": 4443082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/95b3ea234841839e9cbcd2af365c40ea?s=128&d=identicon&r=PG&f=1", "display_name": "bhnn", "link": "https://stackoverflow.com/users/4443082/bhnn"}, "is_accepted": false, "score": 0, "last_activity_date": 1425482633, "creation_date": 1425482633, "answer_id": 28858185, "question_id": 28857486, "link": "https://stackoverflow.com/questions/28857486/excel-if-column-against-other-column/28858185#28858185", "title": "excel - if column against other column", "body": "<p>A simple solution would be to use a dummy column. Make your sheet look like this\nSheet1</p>\n\n<pre><code>A           B           C\nDate 1      Date 2      1\nDate 1      Date 2      1\nDate 1      Date 2      0\nDate 1      Date 2      1\nDate 1      Date 2      1\nDate 1      Date 2      1\nDate 1      Date 2      0\nDate 1      Date 2      0\nDate 1      Date 2      0\n</code></pre>\n\n<p>Sheet2</p>\n\n<pre><code>A   \nOn Time:      xx\nNot on Time:  xx\n</code></pre>\n\n<hr>\n\n<p>The column C holds a 1 if A&lt;=B in that row and 0 otherwise (A>B).</p>\n\n<p>Now</p>\n\n<ul>\n<li>edit your On Time cell to <code>=\"Not on time: \" &amp; COUNTIF($C$1:$C$15; 0)</code></li>\n<li>edit your Not on Time cell to <code>=\"Not on time: \" &amp; COUNTIF($C$1:$C$15; 1)</code></li>\n</ul>\n\n<p>I tested it and it should work to your liking. Let's hope you have the freedom to manipulate the sheet layout.</p>\n"}], "owner": {"reputation": 4943, "user_id": 989185, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/23f7b078442e7d98a9eb8383071d545c?s=128&d=identicon&r=PG", "display_name": "oliverbj", "link": "https://stackoverflow.com/users/989185/oliverbj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 28857632, "answer_count": 2, "score": 0, "last_activity_date": 1442277836, "creation_date": 1425480647, "last_edit_date": 1531161705, "question_id": 28857486, "link": "https://stackoverflow.com/questions/28857486/excel-if-column-against-other-column", "title": "excel - if column against other column", "body": "<p>I have <strong>two</strong> excel sheets. One like below:</p>\n\n<p><em>Sheet 1:</em></p>\n\n<pre><code>Column 1    Column 2\nDate 1      Date 2\nDate 1      Date 2\nDate 1      Date 2\nDate 1      Date 2\nDate 1      Date 2\nDate 1      Date 2\nDate 1      Date 2\nDate 1      Date 2\nDate 1      Date 2\n</code></pre>\n\n<p><em>Sheet 2:</em></p>\n\n<pre><code>Column 1:   \nOn Time:      xx\nNot on Time:  xx \n</code></pre>\n\n<p>So example.</p>\n\n<p>If date 1 is greater than date 2, then it should add 1 to the \"Not on time\" row. And if date 1 is less than <strong>or</strong> equals date 2, then it should add 1 to the \"On Time\" row. </p>\n\n<p><em>Please note that I have two different sheets in the same workbook</em></p>\n\n<p>How can I achieve this?</p>\n"}, {"tags": ["vba", "excel", "vbscript"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1425480613, "post_id": 28857440, "comment_id": 45980742, "body": "Try <code>wkbk.path &amp; &quot;!Macroname&quot;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 0, "last_activity_date": 1425485578, "creation_date": 1425485578, "answer_id": 28859321, "question_id": 28857440, "link": "https://stackoverflow.com/questions/28857440/call-an-excel-macro-with-variable-file-name/28859321#28859321", "title": "Call an Excel Macro with Variable file name", "body": "<p>Assuming <code>wkbk</code> is a workbook object, you can use:</p>\n\n<pre><code>objexcel.Application.Run \"'\" &amp; wkbk.Name &amp; \"'!Macroname\"\n</code></pre>\n\n<p>the single quotes are there in case the workbook name contains spaces. Note you don't need the path since the workbook is open.</p>\n"}, {"tags": [], "owner": {"reputation": 93, "user_id": 4317268, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e6fb90539c6f202c7bfdf415009b5572?s=128&d=identicon&r=PG&f=1", "display_name": "Archaimot", "link": "https://stackoverflow.com/users/4317268/archaimot"}, "is_accepted": false, "score": 1, "last_activity_date": 1425558246, "last_edit_date": 1425558246, "creation_date": 1425486260, "answer_id": 28859588, "question_id": 28857440, "link": "https://stackoverflow.com/questions/28857440/call-an-excel-macro-with-variable-file-name/28859588#28859588", "title": "Call an Excel Macro with Variable file name", "body": "<p>It works with </p>\n\n<pre><code>objexcel.run \"MacroName\"\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 4317268, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e6fb90539c6f202c7bfdf415009b5572?s=128&d=identicon&r=PG&f=1", "display_name": "Archaimot", "link": "https://stackoverflow.com/users/4317268/archaimot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1328, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1425558246, "creation_date": 1425480553, "last_edit_date": 1531164843, "question_id": 28857440, "link": "https://stackoverflow.com/questions/28857440/call-an-excel-macro-with-variable-file-name", "title": "Call an Excel Macro with Variable file name", "body": "<p>I know to run a macro in a module from vbscript it's as simple as</p>\n\n<pre><code>objexcel.Application.Run \"Filename!MacroName\"\n</code></pre>\n\n<p>But, what if the file name is variable--but the directory only contains one file (which has already been opened)?</p>\n\n<p>Could it be as simple as: </p>\n\n<pre><code>objexcel.Application.Run wkbk.path \"Macroname\"\n</code></pre>\n"}, {"tags": ["python-3.x", "vba", "ms-word"], "comments": [{"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1425481450, "post_id": 28856596, "comment_id": 45981347, "body": "have you tried with <code>wildcards</code>? <a href=\"http://www.gmayor.com/replace_using_wildcards.htm\" rel=\"nofollow noreferrer\">here you find some syntax tips</a>"}, {"owner": {"reputation": 361, "user_id": 3786973, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bv99C.jpg?s=128&g=1", "display_name": "kvdogan", "link": "https://stackoverflow.com/users/3786973/kvdogan"}, "reply_to_user": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1425482735, "post_id": 28856596, "comment_id": 45982270, "body": "Yeah, I tried that, you can make it work that way, but I still wonder why I can not make it work through IgnoreSpaces and IgnorePunct  in Word 2010 VBA."}], "owner": {"reputation": 361, "user_id": 3786973, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bv99C.jpg?s=128&g=1", "display_name": "kvdogan", "link": "https://stackoverflow.com/users/3786973/kvdogan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594070137, "creation_date": 1425478240, "last_edit_date": 1594070137, "question_id": 28856596, "link": "https://stackoverflow.com/questions/28856596/ms-word-vba-ignorespace-and-ignorepunct", "title": "MS Word VBA IgnoreSpace and IgnorePunct", "body": "<p>I am trying to automate finding and replacing two-word phrase in some Word files by using Python. </p>\n\n<p>I can find and replace whatever I want in Word by using Python, there is no problem about python and Word integration. The problem is that there is always different number of white spaces between these two words which I want to replace with single whitespace or '-'. I am trying to use 'IgnoreSpace' and 'IgnorePunct' arguments to come over this problem but they do not give any response as they are doing in the Word file when I try to do it manually. Here is my function to do this: wd_object is a VBA Range object</p>\n\n<pre><code>def find_and_replace(wd_object, find_text, replace_with, replace, wrap , \n                 forward, xformat, match_case, match_whole_word, \n                 match_wildcards, match_sounds_like, match_all_word_forms,\n                 ignore_white_space, ignore_punct):\ntry:\n    return wd_object.Find.Execute2007(FindText = find_text, ReplaceWith = replace_with,\n                                      Replace = replace, Wrap = wrap, Forward = forward,\n                                      Format = xformat, MatchCase = match_case,\n                                      MatchWholeWord = match_whole_word,\n                                      MatchWildcards = match_wildcards,\n                                      MatchSoundsLike = match_sounds_like,\n                                      MatchAllWordForms = match_all_word_forms,\n                                      IgnoreSpace = ignore_white_space,\n                                      IgnorePunct = ignore_punct)  \n</code></pre>\n\n<p>Could you please tell me why this is not working?</p>\n"}, {"tags": ["vba", "ms-word", "word-2010", "word-2013"], "comments": [{"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1514473525, "post_id": 28856311, "comment_id": 82987866, "body": "I encountered the same issue with Word 2013, and the only workaround I could find was to add a paragraph at the end of the document.  The line from @Toby worked for me - do <code>ActiveDocument.Paragraphs.Add Range:=ActiveDocument.Range(ActiveDocument.Range.End -1, ActiveDocument.Range.End -1)</code> before adding the xref if the target paragraph is the last one in the document."}], "answers": [{"comments": [{"owner": {"reputation": 210, "user_id": 3568495, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fc05d9269ccdf83f68233c8093ebba6c?s=128&d=identicon&r=PG&f=1", "display_name": "crookie", "link": "https://stackoverflow.com/users/3568495/crookie"}, "edited": false, "score": 0, "creation_date": 1425567384, "post_id": 28878580, "comment_id": 46022935, "body": "Hi Toby. Thanks for your reply, but the position I am adding the InsertCrossReference is not after the last paragraph mark, I am adding it after &quot;This is my xref &quot; and so when i try your code, it does not go in the If statement. It cannot be anything to do with the place I am adding it in, as if I add a reference to the second list member (ie ReferenceItem:=&quot;1&quot;) with everything else being the same, it all works"}], "tags": [], "owner": {"reputation": 797, "user_id": 837985, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7b389ef0cc411283ea22fb27676f4055?s=128&d=identicon&r=PG&f=1", "display_name": "gNerb", "link": "https://stackoverflow.com/users/837985/gnerb"}, "is_accepted": false, "score": 1, "last_activity_date": 1425560833, "creation_date": 1425560833, "answer_id": 28878580, "question_id": 28856311, "link": "https://stackoverflow.com/questions/28856311/insertcrossreference-fails-on-last-item/28878580#28878580", "title": "InsertCrossReference Fails On Last Item", "body": "<p>You cannot insert anything AFTER the last paragraph mark in a document. I've had this issue in the past. My work around was to pragmatically add a paragraph mark in.</p>\n\n<p>Something like the following:</p>\n\n<pre><code>Dim CRRange as Word.Range 'Make a range object to store where the cross reference will go.\nset CRRange = ActiveDocument.Range(16,16)\n\nif CRRange.end &gt;= ActiveDocument.Range.End then 'Check to see if we reached the end of the document\n    ActiveDocument.Paragraphs.Add Range:=ActiveDocument.Range(ActiveDocument.Range.End -1, ActiveDocument.Range.End -1)\nEnd If\n\nCRRange.InsertCrossReference ReferenceType:=\"Numbered item\", _\n    ReferenceKind:=wdNumberFullContext, ReferenceItem:=\"2\", InsertAsHyperlink _\n    :=True, IncludePosition:=False, SeparateNumbers:=False, SeparatorString:=\" \"\n</code></pre>\n"}], "owner": {"reputation": 210, "user_id": 3568495, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fc05d9269ccdf83f68233c8093ebba6c?s=128&d=identicon&r=PG&f=1", "display_name": "crookie", "link": "https://stackoverflow.com/users/3568495/crookie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 427, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1593951200, "creation_date": 1425477423, "last_edit_date": 1593951200, "question_id": 28856311, "link": "https://stackoverflow.com/questions/28856311/insertcrossreference-fails-on-last-item", "title": "InsertCrossReference Fails On Last Item", "body": "<p>I think I have found a bug with the InsertCrossReference. If I use from code for the last list item in the document and there being nothing after that list item, it fails with error \"Run-time error '4198' Command failed\". If you do it manually, it all works. So you are thinking, I have written the code incorrectly, but this isn't the case. To make sure, i recorded a macro of inserting the cross reference and then ran the macro it recorded and the same error happens.</p>\n\n<p>I have googled this problem and seen a couple of people raise it but a)they haven't pointed out that it only fails for the last list item and there being nothing in the document after that list item b)they haven't had any work-around replies. </p>\n\n<p>I am using Word 2010 but I have also tried it on Word 2013 and the same thing happens. </p>\n\n<p>If you want an example, if I set up the following:</p>\n\n<p>This is my xref </p>\n\n<ol>\n<li>Hello</li>\n<li>Bye</li>\n</ol>\n\n<p>where 1 and 2 are standard numbered lists and I have nothing in the document after \"Bye\" and then I run:</p>\n\n<pre><code>ActiveDocument.Range(16, 16).InsertCrossReference ReferenceType:=\"Numbered item\", _\nReferenceKind:=wdNumberFullContext, ReferenceItem:=\"2\", InsertAsHyperlink _\n:=True, IncludePosition:=False, SeparateNumbers:=False, SeparatorString:=\" \"\n</code></pre>\n\n<p>Note having nothing after \"Bye\" is key. If you start a new line, with or without a list type, the code above will work</p>\n\n<p>If anyone has any work-around for this, I'd appreciate it</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1425477336, "post_id": 28855865, "comment_id": 45978487, "body": "You opened 5 <i>If</i> clauses and closed only one."}], "answers": [{"comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1425478931, "post_id": 28856211, "comment_id": 45979613, "body": "I would put the <code>End If</code> after the <code>Else MsgBox &quot;ERROR FILE NOT SUPPORTED&quot;</code>"}], "tags": [], "owner": {"reputation": 1399, "user_id": 4584335, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q8zHtvjpvi4/AAAAAAAAAAI/AAAAAAAADEo/Mb1fVAnabIE/photo.jpg?sz=128", "display_name": "Rubik", "link": "https://stackoverflow.com/users/4584335/rubik"}, "is_accepted": false, "score": 1, "last_activity_date": 1425477104, "creation_date": 1425477104, "answer_id": 28856211, "question_id": 28855865, "link": "https://stackoverflow.com/questions/28855865/using-nested-if-statements-to-import/28856211#28856211", "title": "Using Nested IF Statements to Import", "body": "<p>Each time you've got:</p>\n\n<pre><code>Else\n\n' Cheatsheet Rev 9\nIf Range(\"C15\") = \"Peak Force\" Then\n</code></pre>\n\n<p>Try to replace <code>Else ... If</code> by <code>ElseIf</code> (in one word):</p>\n\n<pre><code>...\n' Cheatsheet Rev 9\nElseIf Range(\"C15\") = \"Peak Force\" Then\n...\n</code></pre>\n\n<p>But I can't tell where you have to put your <code>End If</code> instruction...</p>\n"}, {"comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 5, "user_id": 4392623, "user_type": "registered", "profile_image": "https://graph.facebook.com/1071293503/picture?type=large", "display_name": "Andrew Bartlett", "link": "https://stackoverflow.com/users/4392623/andrew-bartlett"}, "edited": false, "score": 0, "creation_date": 1425571818, "post_id": 28857019, "comment_id": 46026028, "body": "Please be sure to accept whichever answer you felt was most helpful. Having accepted answers helps the whole site."}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": true, "score": 0, "last_activity_date": 1425479419, "creation_date": 1425479419, "answer_id": 28857019, "question_id": 28855865, "link": "https://stackoverflow.com/questions/28855865/using-nested-if-statements-to-import/28857019#28857019", "title": "Using Nested IF Statements to Import", "body": "<p>An alternative to Rubik's perfectly acceptable method:</p>\n\n<pre><code>If Range(\"A22\") = \"Input\" Then\n  'stuff\nElse\n  If Range(\"C15\") = \"Peak Force\" Then\n    'stuff\n  Else\n    If Range(\"M15\") = \"Peak Force\" Then\n      'stuff\n    Else\n      If Range(\"M15\") = \"Cracks Through to Rivet?\" Then\n        'stuff\n      Else\n        If Range(\"M15\") = \"\" Then\n          'stuff\n        Else\n          MsgBox \"ERROR FILE NOT SUPPORTED\"\n'This is the critical difference to your code:\n        End if\n      End if\n    End if\n  End if\nEnd if\n' Re-protect the workbook\n'and the rest of your code here - be sure to get rid of the now random\n'End If that would be down there\n</code></pre>\n\n<p>If you were to just add all the <code>End If</code>s to where you've got the one now, you'd find that you would only re-protect the worksheet &amp; save your changes <em>if</em> you first saw your <code>ERROR FILE NOT SUPPORTED</code> message.</p>\n"}], "owner": {"reputation": 5, "user_id": 4392623, "user_type": "registered", "profile_image": "https://graph.facebook.com/1071293503/picture?type=large", "display_name": "Andrew Bartlett", "link": "https://stackoverflow.com/users/4392623/andrew-bartlett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 28857019, "answer_count": 2, "score": 0, "last_activity_date": 1425479419, "creation_date": 1425476195, "last_edit_date": 1531164843, "question_id": 28855865, "link": "https://stackoverflow.com/questions/28855865/using-nested-if-statements-to-import", "title": "Using Nested IF Statements to Import", "body": "<p>I am having a few issues with the following code. I have had the main block running quite nicely, however, when I added the extra if statements I am now getting an excel hang. I know this is something to do with my if statements but i am not quite versed enough to work out what I have done.\nAny help much appreciated.</p>\n\n<pre><code>Sub Import()\n' Prevent screen from updating &amp; define \"directory\" and \"Filename\"\nApplication.ScreenUpdating = False\nApplication.CalculateFull\ndirectory = \"T:\\JLR Project 2013\\Joint Data\\CHEATSHEETS\\\"\nFilename = (directory &amp; Cells(10, 16))\n\n' Define Object for Target Workbook\nDim Target_Workbook As Workbook\nDim Source_Workbook As Workbook\nDim Target_Path As String\nDim sh As Worksheet\nDim myPassword As String\nmyPassword = Password1.Password.Value\n' ------- REMOVE PASSWORD -------\n\n' Assign the Workbook File Name along with its Path\n' Change path of the Target File name\nTarget_Path = Filename\nSet Target_Workbook = Workbooks.Open(Target_Path)\n' Unprotect the sheet so as to remove information\nFor Each sh In ActiveWorkbook.Worksheets\n    sh.Unprotect Password:=myPassword\nNext sh\nSet Source_Workbook = ThisWorkbook\n' Cheatsheet Rev 10\nIf Range(\"A22\") = \"Input\" Then\n    ' Select Force from sheet and copy\n    Target_Data = Target_Workbook.Sheets(1).Range(\"c22\")\n    ' Paste Force into the big sheet\n    Source_Workbook.Sheets(1).Range(\"h19\") = Target_Data\n    ' Select Head Height DTI\n    Target_Data = Target_Workbook.Sheets(1).Range(\"e17:e21\")\n    Source_Workbook.Sheets(1).Range(\"c33:c37\") = Target_Data\n    ' Select Head Height Macro\n    Target_Data = Target_Workbook.Sheets(1).Range(\"g17:g21\")\n    Source_Workbook.Sheets(1).Range(\"d33:d37\") = Target_Data\n    ' Select Interlock\n    Target_Data = Target_Workbook.Sheets(1).Range(\"i17:j21\")\n    Source_Workbook.Sheets(1).Range(\"e33:f37\") = Target_Data\n    ' Select T-Min\n    Target_Data = Target_Workbook.Sheets(1).Range(\"m17:m21\")\n    Source_Workbook.Sheets(1).Range(\"h33:h37\") = Target_Data\n    ' Select Parameters, cracks through etc\n    Target_Data = Target_Workbook.Sheets(1).Range(\"o17:s21\")\n    Source_Workbook.Sheets(1).Range(\"c49:g53\") = Target_Data\nElse\n\n' Cheatsheet Rev 9\nIf Range(\"C15\") = \"Peak Force\" Then\n    ' Select Force from sheet and copy\n    Target_Data = Target_Workbook.Sheets(1).Range(\"C25\")\n    Source_Workbook.Sheets(1).Range(\"h19\") = Target_Data\n    ' Select Head Height DTI\n    Target_Data = Target_Workbook.Sheets(1).Range(\"e17:e21\")\n    Source_Workbook.Sheets(1).Range(\"c33:c37\") = Target_Data\n    ' Select Head Height Macro\n    Target_Data = Target_Workbook.Sheets(1).Range(\"g17:g21\")\n    Source_Workbook.Sheets(1).Range(\"d33:d37\") = Target_Data\n    ' Select Interlock\n    Target_Data = Target_Workbook.Sheets(1).Range(\"i17:j21\")\n    Source_Workbook.Sheets(1).Range(\"e33:f37\") = Target_Data\n    ' Select T-Min\n    Target_Data = Target_Workbook.Sheets(1).Range(\"m17:m21\")\n    Source_Workbook.Sheets(1).Range(\"h33:h37\") = Target_Data\n    ' Select Parameters, cracks through etc\n    Target_Data = Target_Workbook.Sheets(1).Range(\"o17:s21\")\n    Source_Workbook.Sheets(1).Range(\"c49:g53\") = Target_Data\nElse\n\n' Cheatsheet Rev 6\nIf Range(\"M15\") = \"Peak Force\" Then\n    ' Select Force from sheet and copy\n    Target_Data = Target_Workbook.Sheets(1).Range(\"M23\")\n    ' Paste Force into the big sheet\n    Source_Workbook.Sheets(1).Range(\"h19\") = Target_Data\n    Target_Data = Target_Workbook.Sheets(1).Range(\"C17:C21\")\n    Source_Workbook.Sheets(1).Range(\"c33:c37\") = Target_Data\n    Target_Data = Target_Workbook.Sheets(1).Range(\"E17:E21\")\n    Source_Workbook.Sheets(1).Range(\"d33:d37\") = Target_Data\n    Target_Data = Target_Workbook.Sheets(1).Range(\"G17:H21\")\n    Source_Workbook.Sheets(1).Range(\"e33:f37\") = Target_Data\n    Target_Data = Target_Workbook.Sheets(1).Range(\"K17:K21\")\n    Source_Workbook.Sheets(1).Range(\"h33:h37\") = Target_Data\n    Target_Data = Target_Workbook.Sheets(1).Range(\"N17:R21\")\n    Source_Workbook.Sheets(1).Range(\"c49:g53\") = Target_Data\nElse\n\n' Cheatsheet Rev 4\nIf Range(\"M15\") = \"Cracks Through to Rivet?\" Then\n    ' Select Force from sheet and copy\n    Source_Workbook.Sheets(1).Range(\"h19\") = \"--\"\n    ' Select Head Height DTI\n    Target_Data = Target_Workbook.Sheets(1).Range(\"C17:C21\")\n    Source_Workbook.Sheets(1).Range(\"c33:c37\") = Target_Data\n    ' Select Head Height Macro\n    Target_Data = Target_Workbook.Sheets(1).Range(\"E17:E21\")\n    Source_Workbook.Sheets(1).Range(\"d33:d37\") = Target_Data\n    ' Select Interlock\n    Target_Data = Target_Workbook.Sheets(1).Range(\"G17:H21\")\n    Source_Workbook.Sheets(1).Range(\"e33:f37\") = Target_Data\n    ' Select T-Min\n    Target_Data = Target_Workbook.Sheets(1).Range(\"K17:K21\")\n    Source_Workbook.Sheets(1).Range(\"h33:h37\") = Target_Data\n    ' Select Parameters, cracks through etc\n    Target_Data = Target_Workbook.Sheets(1).Range(\"M17:Q21\")\n    Source_Workbook.Sheets(1).Range(\"c49:g53\") = Target_Data\nElse\n\n' Cheatsheet Rev 2\nIf Range(\"M15\") = \"\" Then\n    ' Select Force from sheet and copy\n    Source_Workbook.Sheets(1).Range(\"h19\") = \"--\"\n    ' Select Head Height DTI\n    Target_Data = Target_Workbook.Sheets(1).Range(\"C17:C21\")\n    Source_Workbook.Sheets(1).Range(\"c33:c37\") = Target_Data\n    ' Select Head Height Macro\n    Target_Data = Target_Workbook.Sheets(1).Range(\"E17:E21\")\n    Source_Workbook.Sheets(1).Range(\"d33:d37\") = Target_Data\n    ' Select Interlock\n    Target_Data = Target_Workbook.Sheets(1).Range(\"G17:H21\")\n    Source_Workbook.Sheets(1).Range(\"e33:f37\") = Target_Data\n    ' Select T-Min\n    Target_Data = Target_Workbook.Sheets(1).Range(\"K17:K21\")\n    Source_Workbook.Sheets(1).Range(\"h33:h37\") = Target_Data\n    ' Select Parameters, cracks through etc\n    Source_Workbook.Sheets(1).Range(\"c49:g53\") = \"--\"\nElse\nMsgBox \"ERROR FILE NOT SUPPORTED\"\n\n' Re-protect the workbook\nFor Each sh In ActiveWorkbook.Worksheets\n    sh.Protect Password:=myPassword\nNext sh\n' Save any changes in the two workbooks\nSource_Workbook.Save\nTarget_Workbook.Save\nTarget_Workbook.Close False\n\n' Re-calculate all of the sheets within the targate workbook to allow images to be imported\nApplication.CalculateFull\n\nImage\n\n' Process Completed\nMsgBox \"Import Complete\"\n\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3671, "user_id": 1751792, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/HIRsS.jpg?s=128&g=1", "display_name": "Lopsided", "link": "https://stackoverflow.com/users/1751792/lopsided"}, "edited": false, "score": 1, "creation_date": 1425656413, "post_id": 28855848, "comment_id": 46063806, "body": "Not sure why this question is being marked as off-topic. The question is very specific. And the problem is too simple, I would say, to necessitate the inclusion of code examples. As a matter of fact, any additional detail would likely have made his needs harder to distinguish. I think he did exactly what a newcomer should. +1 to you crazyfrog"}, {"owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "edited": false, "score": 0, "creation_date": 1604938309, "post_id": 28855848, "comment_id": 114493306, "body": "Yeah this site can be super &quot;over the top&quot;. Too bad, because truly, this question deserves a functionalized answer, not a &quot;sub&quot; and I created one which takes the desired visible row as an argument and returns absolute, but I can&#39;t share. Who benifits?"}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 4486320, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fc3a2333ae69a766d8b1ccb32fcadbfd?s=128&d=identicon&r=PG&f=1", "display_name": "crazyfrog", "link": "https://stackoverflow.com/users/4486320/crazyfrog"}, "edited": false, "score": 0, "creation_date": 1425477556, "post_id": 28856097, "comment_id": 45978621, "body": "Thanks for your reply MikeD, but I&#39;m not looking to apply this on a specific cell. I want absolute row number (without filters on) of 20th visible row (after filter has been applied) in my table."}, {"owner": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "reply_to_user": {"reputation": 95, "user_id": 4486320, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fc3a2333ae69a766d8b1ccb32fcadbfd?s=128&d=identicon&r=PG&f=1", "display_name": "crazyfrog", "link": "https://stackoverflow.com/users/4486320/crazyfrog"}, "edited": false, "score": 0, "creation_date": 1425477824, "post_id": 28856097, "comment_id": 45978834, "body": "that is what it does ... go to the filtered table, advance to the 20th row and enter that function somewhere, pointing to any cell within that row .... you could of course look to the far left and read out the row number from Excel ... or I can elaborate more on how you can make this visible on the <b>status line</b>"}], "tags": [], "owner": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "is_accepted": false, "score": 0, "last_activity_date": 1425478277, "last_edit_date": 1425478277, "creation_date": 1425476843, "answer_id": 28856097, "question_id": 28855848, "link": "https://stackoverflow.com/questions/28855848/vba-to-return-nth-row-number-from-a-filtered-table-in-excel/28856097#28856097", "title": "VBA to return nth row number from a filtered table in excel", "body": "<p>As a function I suggest</p>\n\n<pre><code>Function RowNum(Target As Range) As Long\n    RowNum = Target.Row\nEnd Function\n</code></pre>\n\n<p>use by entering in a cell <code>=RowNum(E9)</code>. If you want the line relative to the table start and your table starts in -say- row 21, just subtract this from the result (you can use the same function to find the row of table start or course) ... e.g. <code>=rownum(A2)-rownum($A$1)</code> ... mind the absolute notation of table header!</p>\n\n<p>If you don't like this as a function, you could use the SelectionChange event to display the row number of the selected cell in the message line (optionally depending on a \"debug flag\" somewhere in your sheet).</p>\n\n<p>Tne non-VBA approach would be to use the CELL formula ... e.g. <code>=CELL(\"row\",A1)</code></p>\n"}, {"tags": [], "owner": {"reputation": 3671, "user_id": 1751792, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/HIRsS.jpg?s=128&g=1", "display_name": "Lopsided", "link": "https://stackoverflow.com/users/1751792/lopsided"}, "is_accepted": true, "score": 7, "last_activity_date": 1425482808, "last_edit_date": 1425482808, "creation_date": 1425479134, "answer_id": 28856922, "question_id": 28855848, "link": "https://stackoverflow.com/questions/28855848/vba-to-return-nth-row-number-from-a-filtered-table-in-excel/28856922#28856922", "title": "VBA to return nth row number from a filtered table in excel", "body": "<p>Simplest method is special cells. See below:</p>\n\n<pre><code>Sub test()\n\nDim i As Integer, j As Integer, k As Integer\nDim Report As Worksheet\n\nSet Report = Excel.ActiveSheet ' Store the current worksheet in a variable (always a good idea)\nDim visRng As Range ' Creating a range variable to store our table, excluding any rows that are filtered out.\nSet visRng = Report.UsedRange.SpecialCells(xlCellTypeVisible) ' Select only rows within the used range that are visible.\n\nDim r As Range \nFor Each r In visRng.Rows ' Loop through each row in our visible range ...\n    MsgBox (r.Row) ' ... and retrieve the \"absolute\" row number.\nNext\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<h2>EDIT</h2>\n\n<p>Tom claims this method will not work, but I'm pretty sure it does what you ask. Example:</p>\n\n<p>Here is my original test table--unfiltered so you can see what we're doing.\n<img src=\"https://i.stack.imgur.com/1phJd.jpg\" alt=\"Unfiltered\"></p>\n\n<p>And then we filter a couple values somewhere in the middle of the table...</p>\n\n<p><img src=\"https://i.stack.imgur.com/kbHhZ.jpg\" alt=\"Filtered\"></p>\n\n<p>Now when we run the script I posted above, our message box will show the \"absolute\" row number for each unfiltered row. Results are 1,3,4,5, and 7.</p>\n"}, {"comments": [{"owner": {"reputation": 3671, "user_id": 1751792, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/HIRsS.jpg?s=128&g=1", "display_name": "Lopsided", "link": "https://stackoverflow.com/users/1751792/lopsided"}, "edited": false, "score": 0, "creation_date": 1425481309, "post_id": 28857569, "comment_id": 45981246, "body": "Not sure what you mean. I tested my script with filtered rows in the middle of a large table. I&#39;ll post some screen shots to prove it does work as the OP requested."}, {"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "reply_to_user": {"reputation": 3671, "user_id": 1751792, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/HIRsS.jpg?s=128&g=1", "display_name": "Lopsided", "link": "https://stackoverflow.com/users/1751792/lopsided"}, "edited": false, "score": 0, "creation_date": 1425482453, "post_id": 28857569, "comment_id": 45982054, "body": "Hey @Lopsided, sorry didn&#39;t want to offend you. Maybe I got your code wrong, but it seemd to me, that it counted <i>all</i> invisible rows in the whole table. Would you be so kind to put some comments in your code? That would be very helpful. (:"}, {"owner": {"reputation": 95, "user_id": 4486320, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fc3a2333ae69a766d8b1ccb32fcadbfd?s=128&d=identicon&r=PG&f=1", "display_name": "crazyfrog", "link": "https://stackoverflow.com/users/4486320/crazyfrog"}, "edited": false, "score": 0, "creation_date": 1425639923, "post_id": 28857569, "comment_id": 46054381, "body": "Thanks a lot everyone ..... I used a combination of Lopsided and Tim&#39;s solution and it solved my problem. Really appreciated your help guys!!!!"}, {"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1425644430, "post_id": 28857569, "comment_id": 46056565, "body": "Flagging the answers would be nice. &lt;:"}], "tags": [], "owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "is_accepted": false, "score": -1, "last_activity_date": 1425480909, "creation_date": 1425480909, "answer_id": 28857569, "question_id": 28855848, "link": "https://stackoverflow.com/questions/28855848/vba-to-return-nth-row-number-from-a-filtered-table-in-excel/28857569#28857569", "title": "VBA to return nth row number from a filtered table in excel", "body": "<p>The answer brought up by @Lopsided wont work, if there are other hidden cells after the nth entry. They would then be added to the absolute position.</p>\n\n<p>This'll work, you have to change n by yourself in the script. Changing that shouldn't be to hard. If you have any questions regarding that, feel free to ask. (;</p>\n\n<pre><code>Sub absoluteRowID()\n\nDim RowCount, hiddenRows As Integer\n\n'relative position n\nn = 5\ni = 0\n\nDo While i &lt; n\n\ni = i + 1\nIf ThisWorkbook.Sheets(1).Rows(i).EntireRow.Hidden Then\n'if there is a hidden row, position is incremented\nn = n + 1\nEnd If\n'if there is no hidden row, nothing happens\n\nLoop\n\nMsgBox (i)\n\n\n\nEnd Sub\n</code></pre>\n\n<p>HTH</p>\n"}], "owner": {"reputation": 95, "user_id": 4486320, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fc3a2333ae69a766d8b1ccb32fcadbfd?s=128&d=identicon&r=PG&f=1", "display_name": "crazyfrog", "link": "https://stackoverflow.com/users/4486320/crazyfrog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13507, "favorite_count": 0, "closed_date": 1425518410, "accepted_answer_id": 28856922, "answer_count": 3, "score": 6, "last_activity_date": 1425482808, "creation_date": 1425476146, "question_id": 28855848, "link": "https://stackoverflow.com/questions/28855848/vba-to-return-nth-row-number-from-a-filtered-table-in-excel", "closed_reason": "Not suitable for this site", "title": "VBA to return nth row number from a filtered table in excel", "body": "<p>Can anyone please help me with finding the absolute row number of nth element after filter is applied in an excel table.</p>\n\n<p>For example, I have filter on and have a visible range of data element. Now 20th (nth) row in this filtered range could be 60th row (absolute sense) when no filters are on. Is there a way to find the absolute row number using VBA?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2140173"}, "edited": false, "score": 6, "creation_date": 1425475345, "post_id": 28855156, "comment_id": 45977113, "body": "Przemyslaw, you may want to &quot;ask&quot; your &quot;question&quot; / share on <a href=\"http://codereview.stackexchange.com\">CodeReview</a> rather than SO."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1425502278, "post_id": 28855156, "comment_id": 45994345, "body": "I get error <code>Method &#39;LinkedCell&#39; of object &#39;_OLEObject&#39; failed</code>. At line <code>.LinkedCell = &quot;&quot; &#39; temporary turn off of the link to the cell to avoid stange behaviour</code>. Tested with Excel 2007. Maybe you could speed up the function <code>SearchAdr</code>. Instead of looping through a <code>Range</code> get values into variant array and loop through the array elements. That is faster."}, {"owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "reply_to_user": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1425542970, "post_id": 28855156, "comment_id": 46008447, "body": "@dee Have you tested the file from download or the code posted below the download link? I have just tested the downloaded file on Excel 2003 and Excel 2010 and it works fine."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1425544153, "post_id": 28855156, "comment_id": 46009023, "body": "Well I have tested the downloaded file again with Excel 2007 but on different computer and it works fine. So the problem is probably not in the file itself, but on my home computer."}, {"owner": {"reputation": 2820, "user_id": 3390468, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/768800013/picture?type=large", "display_name": "Steven Martin", "link": "https://stackoverflow.com/users/3390468/steven-martin"}, "edited": false, "score": 0, "creation_date": 1426104975, "post_id": 28855156, "comment_id": 46241073, "body": "downloded and unlocked file, doesn&#39;t work in excel 2010 , no errors, no scroll bars.."}, {"owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "reply_to_user": {"reputation": 2820, "user_id": 3390468, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/768800013/picture?type=large", "display_name": "Steven Martin", "link": "https://stackoverflow.com/users/3390468/steven-martin"}, "edited": false, "score": 0, "creation_date": 1426150043, "post_id": 28855156, "comment_id": 46256721, "body": "@StevenMartin It works well on Excel 2013, 2010, 2007, 2003. Just check out your macro security settings. If you have xlsm file with working macros just copy my code inside."}], "answers": [{"tags": [], "owner": {"reputation": 1399, "user_id": 4584335, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q8zHtvjpvi4/AAAAAAAAAAI/AAAAAAAADEo/Mb1fVAnabIE/photo.jpg?sz=128", "display_name": "Rubik", "link": "https://stackoverflow.com/users/4584335/rubik"}, "is_accepted": false, "score": 1, "last_activity_date": 1425897352, "creation_date": 1425897352, "answer_id": 28939899, "question_id": 28855156, "link": "https://stackoverflow.com/questions/28855156/increase-speed-of-changing-excell-cells-value-with-just-a-mouse/28939899#28939899", "title": "Increase speed of changing Excell cell&#39;s value with just a mouse", "body": "<p>To make the value change when clicking on left/right arrow or inside the scrollbar, I'd rather add:</p>\n\n<pre><code>Private Sub scrlSh_Change()\nIf ActiveSheet.OLEObjects(scrlName).LinkedCell &lt;&gt; \"\" Then\n    scrlSh_Scroll\nEnd If\nEnd Sub\n</code></pre>\n\n<p>I'd prefer use typed function like <code>UCase$</code>, <code>Left$</code>, ... rather than their variant equivalent (<code>UCase</code>, <code>Left</code>, ...), but for this macro the \"true\" performance is not really required.</p>\n\n<p>Within your Worksheet_SelectionChange sub, I've replaced the <code>actSheet</code>, <code>SheetFly</code> and <code>adr</code> variables by their original values (as there are used only once). No real big improvment yet.</p>\n"}, {"comments": [{"owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1425998072, "post_id": 28965769, "comment_id": 46184568, "body": "Which part of my code should it replace? Can you explain the 3rd line of your code? What does 199 and 15 at the end stand for?"}, {"owner": {"reputation": 323, "user_id": 3795077, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tGabw.gif?s=128&g=1", "display_name": "snb", "link": "https://stackoverflow.com/users/3795077/snb"}, "reply_to_user": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1425999789, "post_id": 28965769, "comment_id": 46185922, "body": "It should replace all your code. You can check in the helpfiles of the VBEditor, what 192 (3*64) width and 15 (height) stand for."}, {"owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 1, "creation_date": 1426000454, "post_id": 28965769, "comment_id": 46186412, "body": "You have defined max as 32767 (where in your code?). The scrollbar flickers (and it should not). Scrollbar does not disappear if you select other cell i.e. <code>B2</code>. PS Incredible, I am surprised by the shortness of your code. Bravo!"}, {"owner": {"reputation": 323, "user_id": 3795077, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tGabw.gif?s=128&g=1", "display_name": "snb", "link": "https://stackoverflow.com/users/3795077/snb"}, "reply_to_user": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1426008334, "post_id": 28965769, "comment_id": 46191971, "body": "I added .object.max=200 to illustrate how you can easily adapt the properties (also the .object.min, etc.) of the scrollbar."}, {"owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1426237625, "post_id": 28965769, "comment_id": 46298237, "body": "(1) What about the flickering of the bar grey-black? Can we avoid it in your solution? (In my solution it does not flicker). (2) How to disable the scrollbar after selecting B1 cell?"}, {"owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1540907090, "post_id": 28965769, "comment_id": 93029668, "body": "I would remove the line <code>Target = Application.Max(Target, .Object.Min)</code> and its twin below."}], "tags": [], "owner": {"reputation": 323, "user_id": 3795077, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tGabw.gif?s=128&g=1", "display_name": "snb", "link": "https://stackoverflow.com/users/3795077/snb"}, "is_accepted": true, "score": 2, "last_activity_date": 1426008235, "last_edit_date": 1426008235, "creation_date": 1425996075, "answer_id": 28965769, "question_id": 28855156, "link": "https://stackoverflow.com/questions/28855156/increase-speed-of-changing-excell-cells-value-with-just-a-mouse/28965769#28965769", "title": "Increase speed of changing Excell cell&#39;s value with just a mouse", "body": "<p>I'd prefer:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n If Intersect(Target, Range(\"A1:A10\")) Is Nothing Then Exit Sub\n\n If OLEObjects.Count = 0 Then OLEObjects.Add \"Forms.ScrollBar.1\", , , , , , , Target.Offset(, 1).Left, Target.Top, 199, 15\n\n With OLEObjects(1)\n   .Top = Target.Top\n   .object.max=200\n   Target = Application.Max(Target, .Object.Min)\n   Target = Application.Min(Target, .Object.Max)\n   .LinkedCell = Target.Address\n End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 708, "favorite_count": 1, "closed_date": 1429974538, "accepted_answer_id": 28965769, "answer_count": 2, "score": 0, "last_activity_date": 1426008235, "creation_date": 1425473939, "last_edit_date": 1425542805, "question_id": 28855156, "link": "https://stackoverflow.com/questions/28855156/increase-speed-of-changing-excell-cells-value-with-just-a-mouse", "closed_reason": "Needs more focus", "title": "Increase speed of changing Excell cell&#39;s value with just a mouse", "body": "<p>I would like to increase the speed of changing Excel cell's value with a mouse only. I share my tool in hope that someone will like it and want to improve it. </p>\n\n<p>This is an example. After clicking on a defined cell containing value, scrollbar appears on the right side of a cell. You can smoothly change its value with a mouse. </p>\n\n<p><img src=\"https://i.stack.imgur.com/KWBNb.png\" alt=\"enter image description here\"></p>\n\n<p>The tool is meant to change cells value and observe formulas values dynamically. You may simplify the code however some features should not be disabled. It should always stay dynamic, that is moving the srollbar should immediately influence other cells with formulas. The srollbar should not twinkle (changing colour grey and black).</p>\n\n<p>You may simply <a href=\"https://docs.google.com/uc?authuser=0&amp;id=0B3TGVycQLkZ_RDVjMXUyanZVQm8&amp;export=download\" rel=\"nofollow noreferrer\">download the <em>scrollbar.xlsm</em> file here</a> and view the VBA code inside it. </p>\n\n<p>Or you may put this code in your sheet where you want the scollbars to appear. The name of your sheet does not matter. Right click on the sheet's name and then click <code>View Code</code>. This is the place:</p>\n\n<p><img src=\"https://i.stack.imgur.com/CcnEB.png\" alt=\"enter image description here\"></p>\n\n<p>Insert there this code:</p>\n\n<pre><code>Option Explicit\nDim previousRow, c\nConst scrlName As String = \"scrlSh\" ' the name of the scrollbar\n\n\nPrivate Sub scrlSh_GotFocus()\n    ActiveSheet.Range(ActiveSheet.OLEObjects(scrlName).TopLeftCell.Offset(0, -1).Address).Activate\nEnd Sub\n\nPrivate Sub scrlSh_Scroll()\nDim rngCell As Range\n\nSet rngCell = Sheets(\"Param\").Range(ActiveSheet.OLEObjects(scrlName).LinkedCell)\n\n    ActiveSheet.OLEObjects(scrlName).TopLeftCell.Offset(0, -1).Value = _\n        rngCell.Offset(0, 1).Value + (ActiveSheet.OLEObjects(scrlName).Object.Value * rngCell.Offset(0, 3).Value)\n\nSet rngCell = Nothing\nEnd Sub\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n' Macro concept by Przemyslaw Remin, VBA code written by Jaroslaw Smolinski\n' The Sub Worksheet_SelectionChange and function SearchAdr have to be on each sheet where scrollbars are to appear\n' Sheet Param is one for all sheets, only the columns A-G are used, othre columns can be used for something else\n' Do not change the layout of A-G columns unless you want to modify the code\n' Addresses in Param have to be with dollars (i.e. $A$3) or it may be named ranges of single cells\n' (if it starts with $ it is a cell, otherwise it is a named range)\n' the lower or upper case in addresses does not matter\n\n\nDim SheetFly As String, adr As String\nDim cCell As Range\nDim actSheet As Worksheet\nDim shScroll As Object\n\n    Set actSheet = ActiveSheet\n\n    ' checks if scrollbar exists\n    If actSheet.Shapes.Count &gt; 0 Then\n        For Each shScroll In actSheet.Shapes\n            If shScroll.Type = msoOLEControlObject And shScroll.Name = scrlName Then\n                Exit For ' scrollbar found, and the variable is set\n            End If\n        Next shScroll\n    End If\n    ' if scrollbar does not exists then it is created\n    If shScroll Is Nothing Then\n        Set shScroll = ActiveSheet.OLEObjects.Add(ClassType:=\"Forms.ScrollBar.1\", Link:=False, _\n            DisplayAsIcon:=False, Left:=0, Top:=0, Width:=64 * 3, Height:=15)\n            ' scrollbar length is set as three adjesent columns\n        shScroll.Visible = False\n        shScroll.Name = scrlName\n        shScroll.Placement = xlMoveAndSize\n    End If\n\n    shScroll.Visible = False\n    adr = Target.AddressLocal\n    SheetFly = actSheet.Name\n\n\n    ' here we set up in which cells the scrollbar has to appear. We set up only the number of rows\n    Set cCell = SearchAdr(SheetFly, adr, Sheets(\"Param\").Range(\"B2:B40\")) ' If needed it can be longer i.e. B2:B400\n    If Not cCell Is Nothing Then\n        With ActiveSheet.OLEObjects(scrlName)\n            .LinkedCell = \"\" ' temporary turn off of the link to the cell to avoid stange behaviour\n            .Object.Min = 0 ' the scale begins from 0, not negative\n            .Object.Max = Abs((cCell.Offset(0, 4).Value - cCell.Offset(0, 3).Value) / cCell.Offset(0, 5).Value)\n            .Object.SmallChange = 10   ' single change by one step\n            .Object.LargeChange = 10   ' change by jumps after clicking on scrollbar bar (\"page up\", \"page down\")\n            If Target.Value &lt;&gt; cCell.Offset(0, 2).Value And Target.Value &gt;= cCell.Offset(0, 3).Value And Target.Value &lt;= cCell.Offset(0, 4).Value Then\n                ' setting up the cells value as close as possible to the value of input by hand\n                ' rounded by step\n                ' if value is out of defined range then the last value will be used\n                cCell.Offset(0, 2).Value = Abs((Target.Value - cCell.Offset(0, 3).Value) / cCell.Offset(0, 5).Value)\n            End If\n            'Protection in case the value is out of min and max range\n            If cCell.Offset(0, 2).Value &gt; .Object.Max Then\n                cCell.Offset(0, 2).Value = .Object.Max\n            ElseIf cCell.Offset(0, 2).Value &lt; .Object.Min Then\n                cCell.Offset(0, 2).Value = .Object.Min\n            End If\n            Target.Value = cCell.Offset(0, 3).Value + (cCell.Offset(0, 5).Value * cCell.Offset(0, 2).Value)\n            .Object.Value = cCell.Offset(0, 2).Value\n            .LinkedCell = \"Param!\" &amp; cCell.Offset(0, 2).Address 'setting up linked cell\n        End With\n        ' Setting up the position and width of scrollbar with reference to the cell\n        shScroll.Top = Target.Top\n        shScroll.Left = Target.Offset(0, 1).Left + 2 'position to the right + small margin\n        shScroll.Width = Target.Offset(0, 5).Left - Target.Offset(0, 1).Left - 2 'width of 5 columns\n        shScroll.Visible = True\n    End If\n\n    Set actSheet = Nothing\n    Set shScroll = Nothing\n    Set cCell = Nothing\nEnd Sub\n\nPrivate Function SearchAdr(SheetFly As String, SearchCell As String, rng As Range) As Range\nDim cCell As Range\nDim oOOo As Name\n\n' Searching for the row with parameter for chosen cell\n' The parameter have to be in one, continouse range\n\nFor Each cCell In rng\n    If cCell.Text = \"\" Then ' check if parameters have not finished\n        Set SearchAdr = Nothing\n        Exit Function ' stop if you find first empty cell for speeding\n    ElseIf Left(cCell.Text, 1) = \"$\" Then ' normal address\n        If cCell.Offset(0, 1).Text &amp; \"!\" &amp; UCase(cCell.Text) = SheetFly &amp; \"!\" &amp; UCase(SearchCell) Then\n            Set SearchAdr = cCell\n            Exit Function   ' exit if find proper row with parameters\n        End If\n    Else ' means that found is a name\n        For Each oOOo In ActiveWorkbook.Names\n            If (oOOo.RefersTo = \"=\" &amp; SheetFly &amp; \"!\" &amp; UCase(SearchCell)) And (UCase(oOOo.Name) = UCase(cCell.Text)) Then\n                Set SearchAdr = cCell\n                Exit Function   ' exit if find proper row with parameters\n            End If\n        Next oOOo\n    End If\nNext cCell\n\nEnd Function\n</code></pre>\n\n<p>In your workbook you have to make sheet named <code>Param</code> where the parameters of scrollbar are stored. In column A and C put the name of your sheet where you want scrollbars to appear. The sheet looks like this:</p>\n\n<p><img src=\"https://i.stack.imgur.com/2fFpZ.png\" alt=\"enter image description here\"></p>\n\n<p>Now you can enjoy the scrollbar after clicking the cell in the <code>model</code> sheet. </p>\n\n<p>Note that you can define different min, max ranges and step of scrollbar change separately for every cell. Moreover, the min and max range can be negative.</p>\n"}, {"tags": ["vba", "hyperlink", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4632141, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9kiOngZn7NU/AAAAAAAAAAI/AAAAAAAAABc/JATkq4OOrBk/photo.jpg?sz=128", "display_name": "Alnair Lindalwe", "link": "https://stackoverflow.com/users/4632141/alnair-lindalwe"}, "edited": false, "score": 0, "creation_date": 1425557933, "post_id": 28866239, "comment_id": 46017175, "body": "Thanks a lot! This loop did nothing at first, but after I changed &quot;ThisDocument&quot; to &quot;ActiveDocument&quot;, it worked just perfectly!"}], "tags": [], "owner": {"reputation": 3101, "user_id": 167478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f77f8328db85911cfbfba4662bb73?s=128&d=identicon&r=PG", "display_name": "Fink", "link": "https://stackoverflow.com/users/167478/fink"}, "is_accepted": true, "score": 0, "last_activity_date": 1425507661, "creation_date": 1425507661, "answer_id": 28866239, "question_id": 28855104, "link": "https://stackoverflow.com/questions/28855104/ms-word-macro-to-replace-all-hyperlinks-with-a-single-word/28866239#28866239", "title": "MS Word Macro to replace all hyperlinks with a single word", "body": "<p>Since you have the hyperlinks already created.  It should just require looping through the documents hyperlinks collection and changing the 'TextToDisplay' property.  This should get you started:</p>\n\n<pre><code>Public Sub ChangeHyperlinksText()\n\n    Dim hlink As Hyperlink\n\n    For Each hlink In ThisDocument.Hyperlinks\n        hlink.TextToDisplay = \"Link\"\n    Next hlink\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4632141, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9kiOngZn7NU/AAAAAAAAAAI/AAAAAAAAABc/JATkq4OOrBk/photo.jpg?sz=128", "display_name": "Alnair Lindalwe", "link": "https://stackoverflow.com/users/4632141/alnair-lindalwe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1191, "favorite_count": 0, "accepted_answer_id": 28866239, "answer_count": 1, "score": 1, "last_activity_date": 1425529342, "creation_date": 1425473801, "last_edit_date": 1425529342, "question_id": 28855104, "link": "https://stackoverflow.com/questions/28855104/ms-word-macro-to-replace-all-hyperlinks-with-a-single-word", "title": "MS Word Macro to replace all hyperlinks with a single word", "body": "<p>I prepare a MS Word file with a large amount of news articles, each followed by a full, long clickable hyperlink (e.g. <a href=\"http://www.newssite.com/this-is-the-name-of-the-article.html\" rel=\"nofollow\">http://www.newssite.com/this-is-the-name-of-the-article.html</a>).</p>\n\n<p>I need to replace all the hyperlinks in the file with a single word: \"<a href=\"http://www.newssite.com/this-is-the-name-of-the-article.html\" rel=\"nofollow\">Link</a>\", while keeping their url adresses and click functionality. I can use MS Word \"change hyperlink\" dialogue to do that, but doing it by hand takes incredible amount of time.</p>\n\n<p>The hyperlinks, however, are not always formatted as 'hyperlink' style. Is there any condition for MS Word Macro replacement that will lookup hyperlinks by their functionality, not by their style or text?</p>\n\n<p>Despite this task seems to be quite common, I could not find anything like it in the web.</p>\n"}, {"tags": ["vba", "search", "vlookup"], "comments": [{"owner": {"reputation": 561, "user_id": 2225326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eab175bdf46a6d70224e635275ee9d22?s=128&d=identicon&r=PG", "display_name": "Conrad", "link": "https://stackoverflow.com/users/2225326/conrad"}, "edited": false, "score": 1, "creation_date": 1425472342, "post_id": 28854057, "comment_id": 45975197, "body": "Why do you implement such a basic feature as searching yourself? Maybe you should try to use the built-in functions like <code>VLOOKUP</code> or a combination of <code>MATCH</code> and <code>INDEX</code>. Does it have to be a macro? Is your data sorted (or sortable)?"}, {"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "reply_to_user": {"reputation": 561, "user_id": 2225326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eab175bdf46a6d70224e635275ee9d22?s=128&d=identicon&r=PG", "display_name": "Conrad", "link": "https://stackoverflow.com/users/2225326/conrad"}, "edited": false, "score": 0, "creation_date": 1425472580, "post_id": 28854057, "comment_id": 45975359, "body": "I agree with @Conrad: sounds like you can do this with built-in Excel functions. Not clear why you go down this convoluted VBA path. If you want help, please show some example input and output."}, {"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "edited": false, "score": 0, "creation_date": 1425472641, "post_id": 28854057, "comment_id": 45975393, "body": "I am a comment  and I agree with the two comments above me."}, {"owner": {"reputation": 1, "user_id": 4193938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7c1a230b712f33ac6ae7e18305197b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tantrum1701", "link": "https://stackoverflow.com/users/4193938/tantrum1701"}, "edited": false, "score": 0, "creation_date": 1425474141, "post_id": 28854057, "comment_id": 45976285, "body": "@Conrad-That is exactly why I asked this question.I am a noob and this is what I thought would do the trick. If there is a better way, please tell me how can I find it with Google."}, {"owner": {"reputation": 1, "user_id": 4193938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7c1a230b712f33ac6ae7e18305197b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tantrum1701", "link": "https://stackoverflow.com/users/4193938/tantrum1701"}, "edited": false, "score": 0, "creation_date": 1425474583, "post_id": 28854057, "comment_id": 45976596, "body": "@ Jean-Fran&#231;ois-Yes, I think so too, but I could not find anything usefull, because I can&#39;t find the correct search arguments. I don&#39;t need a solution as that will only help me how to solve this particular problem. All I need is a place to start, e.g. the right search arguments. Anyway thanks for the input everybody."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4193938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7c1a230b712f33ac6ae7e18305197b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tantrum1701", "link": "https://stackoverflow.com/users/4193938/tantrum1701"}, "edited": false, "score": 0, "creation_date": 1425475415, "post_id": 28854692, "comment_id": 45977163, "body": "I will try to implement it and come back with result"}], "tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": false, "score": 0, "last_activity_date": 1425474945, "last_edit_date": 1425474945, "creation_date": 1425472597, "answer_id": 28854692, "question_id": 28854057, "link": "https://stackoverflow.com/questions/28854057/speed-up-search-in-column/28854692#28854692", "title": "Speed up search in column", "body": "<p>use dictionary, try this</p>\n\n<pre><code>Sub test()\nDim Dic As Object, key As Variant, LR3&amp;, oCell As Range\nSet Dic = CreateObject(\"Scripting.Dictionary\")\nLR3 = Cells(Rows.Count, 1).End(xlUp).Row\nFor Each oCell In Sheet11.Range(\"A1:A\" &amp; LR3)\n    If Not Dic.exists(oCell.Value) Then\n        Dic.Add oCell.Value, oCell.Offset(, 1).Value\n    End If\nNext\nFor Each key In Dic\n    If key = FunctionalLocation.Value Then Description.Value = Dic(key)\nNext\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 4193938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7c1a230b712f33ac6ae7e18305197b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tantrum1701", "link": "https://stackoverflow.com/users/4193938/tantrum1701"}, "edited": false, "score": 0, "creation_date": 1425475585, "post_id": 28854711, "comment_id": 45977283, "body": "This is part of a userform which will be used to enter data to a database-like sheet which will be used for analizing maintenanceplans. FunctionalLocation is a partcode called KKS-code for use in powerplants and description is the partname. I have seen your approach several times, but could not find the right syntax. I hope this will help me find the solution. Thanks."}, {"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "reply_to_user": {"reputation": 1, "user_id": 4193938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7c1a230b712f33ac6ae7e18305197b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tantrum1701", "link": "https://stackoverflow.com/users/4193938/tantrum1701"}, "edited": false, "score": 0, "creation_date": 1425475859, "post_id": 28854711, "comment_id": 45977472, "body": "Maybe to explain this further:  This just puts a VLOOKUP formula which gives you exactly the value you are looking for with your algorithm. The formula is put into the first cell and then autofilled until the last one. It should be way faster than looping through every single cell. If you need help to do this in a more dynamic way, I&#39;m happy to help. (:"}, {"owner": {"reputation": 1, "user_id": 4193938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7c1a230b712f33ac6ae7e18305197b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tantrum1701", "link": "https://stackoverflow.com/users/4193938/tantrum1701"}, "edited": false, "score": 0, "creation_date": 1431083863, "post_id": 28854711, "comment_id": 48354517, "body": "Sorry for long time to react. I&#39;ve been ill. Thanks everybody."}], "tags": [], "owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "is_accepted": false, "score": -1, "last_activity_date": 1425472643, "creation_date": 1425472643, "answer_id": 28854711, "question_id": 28854057, "link": "https://stackoverflow.com/questions/28854057/speed-up-search-in-column/28854711#28854711", "title": "Speed up search in column", "body": "<p>I assume the 2nd codefragment is copied out of a larger Sub, if so, it would be helpful to know what \"FunctionalLocation\" and \"Description\" are exactly.</p>\n\n<p>But I guess this is what you want:</p>\n\n<pre><code>Sheet11.Description.Formula = \"=VLOOKUP(A2:B\" &amp; LR3 + 1 &amp; \",2,false)\"\n\nSheet11.Range(\"C2\").AutoFill Destination:=Range(\"C2:C\" &amp; LR3 + 1 &amp; \"\"), Type:=xlLinearTrend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4193938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7c1a230b712f33ac6ae7e18305197b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tantrum1701", "link": "https://stackoverflow.com/users/4193938/tantrum1701"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 179, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1425474945, "creation_date": 1425470723, "last_edit_date": 1425472384, "question_id": 28854057, "link": "https://stackoverflow.com/questions/28854057/speed-up-search-in-column", "title": "Speed up search in column", "body": "<p>In order to find specific values in a column and use the corresponding value in the next column, I use code below. Although it works perfectly, I am looking for a faster way to do this search.</p>\n\n<p>However, the column I want to search is increasing in size as you can see in the first part of the code. </p>\n\n<p>This works fast enough for columnsizes up to a few hundred values, but when it has more then 20000 values it is really slowing down. Since I have to do this some ten times in my userform I would like to do this a lot faster. </p>\n\n<pre><code>Public Function LR3() As Long   'Func.loc. HW08\n    Worksheets(\"Sheetname\").Activate\n    Application.Volatile\n    LR3 = Cells(Rows.Count, 1).End(xlUp).Row\nEnd Function\n\nFor i = 1 To LR3\n    If CStr(Sheet11.Cells(i + 1, 1).Value) = FunctionalLocation.Value Then\n        Description.Value = Sheet11.Cells(i + 1, 2).Value\n    Else\n         'no action\n    End If\nNext i\n</code></pre>\n"}, {"tags": ["string", "excel", "excel-formula", "worksheet-function", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4631628, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bW4pdDzanys/AAAAAAAAAAI/AAAAAAAAAAA/KEs0lJILm7g/photo.jpg?sz=128", "display_name": "keerthi poonja", "link": "https://stackoverflow.com/users/4631628/keerthi-poonja"}, "edited": false, "score": 1, "creation_date": 1425474179, "post_id": 28854636, "comment_id": 45976312, "body": "Thank you very much. That was of great help. :)"}], "tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": true, "score": 0, "last_activity_date": 1425472403, "creation_date": 1425472403, "answer_id": 28854636, "question_id": 28853818, "link": "https://stackoverflow.com/questions/28853818/change-a-full-column-of-such-as-f01u123456-to-f-01u-123-456/28854636#28854636", "title": "Change a full column of such as F01U123456 to F.01U.123.456", "body": "<p>A formula is sufficient:  </p>\n\n<pre><code>=LEFT(A1)&amp;\".\"&amp;MID(A1,2,3)&amp;\".\"&amp;MID(A1,5,3)&amp;\".\"&amp;MID(A1,8,3)\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4631628, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bW4pdDzanys/AAAAAAAAAAI/AAAAAAAAAAA/KEs0lJILm7g/photo.jpg?sz=128", "display_name": "keerthi poonja", "link": "https://stackoverflow.com/users/4631628/keerthi-poonja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "closed_date": 1425483625, "accepted_answer_id": 28854636, "answer_count": 1, "score": -1, "last_activity_date": 1425472403, "creation_date": 1425470067, "last_edit_date": 1531161705, "question_id": 28853818, "link": "https://stackoverflow.com/questions/28853818/change-a-full-column-of-such-as-f01u123456-to-f-01u-123-456", "closed_reason": "Needs more focus", "title": "Change a full column of such as F01U123456 to F.01U.123.456", "body": "<p>Is it possible to change a full column of such as <code>F01U123456</code> into <code>F.01U.123.456</code> with an Excel formula, or would it require a macro?</p>\n"}, {"tags": ["excel", "ota", "hp-quality-center", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1034, "user_id": 2215331, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/lrto1.jpg?s=128&g=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/2215331/leo"}, "is_accepted": false, "score": 0, "last_activity_date": 1425989399, "creation_date": 1425989399, "answer_id": 28963361, "question_id": 28853312, "link": "https://stackoverflow.com/questions/28853312/qc-alm-ota-ignorehtmlformat-is-not-working-as-expected-in-excel-vba/28963361#28963361", "title": "QC/ALM OTA- IgnoreHtmlFormat is not working as expected in Excel VBA", "body": "<p>You mention that you are updating the description.\nIf the description was created with <strong>IgnoreHtmlFormat = False</strong> then the description will contain html tags no matter the value of IgnoreHtmlFormat you are using to retrieve the info.</p>\n\n<p>My guess is that you are retrieving the descriptio, which contains HTML tags, and update it, but this time, with <strong>IgnoreHtmlFormat = True</strong>.</p>\n\n<p>Even if no HTML tags will be created in your update, the tags are already present in your updated description, and they are treated like regular text.</p>\n"}], "owner": {"reputation": 61, "user_id": 2496978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dbe3ea792739a2021e5953df2097314?s=128&d=identicon&r=PG", "display_name": "Piyush Sharma", "link": "https://stackoverflow.com/users/2496978/piyush-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 569, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1425989399, "creation_date": 1425468603, "last_edit_date": 1531164843, "question_id": 28853312, "link": "https://stackoverflow.com/questions/28853312/qc-alm-ota-ignorehtmlformat-is-not-working-as-expected-in-excel-vba", "title": "QC/ALM OTA- IgnoreHtmlFormat is not working as expected in Excel VBA", "body": "<p>I have written a code in Excel VBA for updating the descriptin of test case in test lab. In that code,Once I have connected to the project, I am setting \ntdConnection.IgnoreHtmlFormat = True and later I am updating the description.\nNow the problem I am facing is that When IgnoreHtmlFormat = True then after updating I am seeing html tags in description and When I am setting IgnoreHtmlFormat = False then I am not getting any html tags in updated description. but I think,right behaviour should be opposite of it. can anyone help me on this?</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 2398, "user_id": 3725745, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bPAUN.png?s=128&g=1", "display_name": "Aiken", "link": "https://stackoverflow.com/users/3725745/aiken"}, "edited": false, "score": 0, "creation_date": 1425472015, "post_id": 28852736, "comment_id": 45975023, "body": "Where is this code being called? It won&#39;t be easy for us to determine why you&#39;re experiencing this behavior without that information."}], "answers": [{"comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 1, "creation_date": 1425476199, "post_id": 28854136, "comment_id": 45977689, "body": "Please explain, in plain English, how this solves the problem."}, {"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "reply_to_user": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1425476300, "post_id": 28854136, "comment_id": 45977752, "body": "@user3671568 Please let me know if this answer helped you. (: .. alright, editing now"}, {"owner": {"reputation": 37, "user_id": 3671568, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vJmIv.jpg?s=128&g=1", "display_name": "user3671568", "link": "https://stackoverflow.com/users/3671568/user3671568"}, "edited": false, "score": 0, "creation_date": 1425539520, "post_id": 28854136, "comment_id": 46007011, "body": "Thanks for You help Tom. But sorry it&#39;s not working. please find below the Code which i have entered for Workbook open                        Private Sub Workbook_Open() Range(&quot;K11&quot;).Select Selection.ClearContents Range(&quot;K13&quot;).Select Selection.ClearContents With ActiveWindow .DisplayHorizontalScrollBar = False .DisplayVerticalScrollBar = False .DisplayHeadings = False End With Application.CommandBars.ActiveMenuBar.Enabled = False Application.DisplayFullScreen = True Application.CommandBars(&quot;Full Screen&quot;).Enabled = False &#39; Disable the Esc key. Application.OnKey &quot;{ESC}&quot;, &quot;&quot;"}], "tags": [], "owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1425476628, "last_edit_date": 1425476628, "creation_date": 1425470947, "answer_id": 28854136, "question_id": 28852736, "link": "https://stackoverflow.com/questions/28852736/excel-full-screen-disable-when-minimize-and-maximize/28854136#28854136", "title": "excel full screen disable when minimize and maximize", "body": "<p>Try this.</p>\n\n<pre><code>Private Sub Workbook_Open()\n'this sub is automatically called on opening the workbook\n\nApplication.WindowState = xlMaximized\n'the active window is expanded to the biggest size available \nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12961271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDYk6Bd1cN4uvrU-KMoUmLw6eHEpIr5xta__Y41Xw=k-s128", "display_name": "Jose Roberto Martins Junior", "link": "https://stackoverflow.com/users/12961271/jose-roberto-martins-junior"}, "is_accepted": false, "score": 0, "last_activity_date": 1582651320, "last_edit_date": 1582651320, "creation_date": 1582646719, "answer_id": 60398751, "question_id": 28852736, "link": "https://stackoverflow.com/questions/28852736/excel-full-screen-disable-when-minimize-and-maximize/60398751#60398751", "title": "excel full screen disable when minimize and maximize", "body": "<p>The best solution for me:</p>\n\n<p>In your workbook -> Event Windows Resize\nNot necessary disable ESC key in this situation</p>\n\n<pre><code>Private Sub Workbook_WindowResize(ByVal Wn As Window)\n   Application.DisplayFullScreen = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 3671568, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vJmIv.jpg?s=128&g=1", "display_name": "user3671568", "link": "https://stackoverflow.com/users/3671568/user3671568"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2205, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1582651320, "creation_date": 1425466772, "last_edit_date": 1425467522, "question_id": 28852736, "link": "https://stackoverflow.com/questions/28852736/excel-full-screen-disable-when-minimize-and-maximize", "title": "excel full screen disable when minimize and maximize", "body": "<p>I have below code for getting full screen view for the Excel workbook. But when I minimize the workbook and Maximize, full screen feature automatically disabling. I need full screen in all condition for this workbook. Please suggest.</p>\n\n<pre><code>Application.DisplayFullScreen = True\nApplication.CommandBars(\"Full Screen\").Enabled = False\n'Disable the Esc key.\nApplication.OnKey \"{ESC}\", \"\"\n</code></pre>\n"}, {"tags": ["excel", "vba", "position", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 4631670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b16b3eed134d01a585b6a51559e9e1d?s=128&d=identicon&r=PG&f=1", "display_name": "Charl&#233;lie Obadia", "link": "https://stackoverflow.com/users/4631670/charl%c3%a9lie-obadia"}, "edited": false, "score": 0, "creation_date": 1425478379, "post_id": 28854331, "comment_id": 45979232, "body": "See I already try that. Plus I can&#39;t use the PasteSpecial function because it doesn&#39;t work on the mac 2011 edition of office. When I try this, the object is at the top left corner because the .left and .top got set to 0 and 0 and not 234 and 186... I you need more info, don&#39;t be afraid to ask ... Thanks anyway :)"}, {"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "reply_to_user": {"reputation": 43, "user_id": 4631670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b16b3eed134d01a585b6a51559e9e1d?s=128&d=identicon&r=PG&f=1", "display_name": "Charl&#233;lie Obadia", "link": "https://stackoverflow.com/users/4631670/charl%c3%a9lie-obadia"}, "edited": false, "score": 0, "creation_date": 1425482123, "post_id": 28854331, "comment_id": 45981823, "body": "I totally misunderstood your post, maybe you should have a look at this. The interesting part is the ShapeRange-Object. I think that&#39;ll solve your problem. I will edit my code as soon as I can. But probably not for another 3 hours. <a href=\"http://stackoverflow.com/questions/7492519/paste-excel-chart-into-powerpoint-using-vba\" title=\"paste excel chart into powerpoint using vba\">stackoverflow.com/questions/7492519/&hellip;</a>"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1425483071, "post_id": 28854331, "comment_id": 45982502, "body": "Try changing  With activeSlide.Shapes.Paste  to  With activeSlide.Shapes.Paste(1)"}, {"owner": {"reputation": 43, "user_id": 4631670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b16b3eed134d01a585b6a51559e9e1d?s=128&d=identicon&r=PG&f=1", "display_name": "Charl&#233;lie Obadia", "link": "https://stackoverflow.com/users/4631670/charl%c3%a9lie-obadia"}, "edited": false, "score": 0, "creation_date": 1425485102, "post_id": 28854331, "comment_id": 45983915, "body": "Thanks for your help but the problem doesn&#39;t seem to be in the code. I think those proporties won&#39;t ever work for me. But I did find some kind of workaround : I can change the position of object in a ppt macro. So I called a ppt macro (that handles positioning) at the end of the excel macro. Thanks for your help anyway ;)"}], "tags": [], "owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1425471505, "creation_date": 1425471505, "answer_id": 28854331, "question_id": 28852502, "link": "https://stackoverflow.com/questions/28852502/unable-to-set-position-of-an-object-in-power-point-through-excel-using-vba/28854331#28854331", "title": "Unable to set position of an object in power point through excel using vba", "body": "<p>Try this:</p>\n\n<pre><code>'paste\nactiveSlide.Shapes.PasteSpecial DataType:=ppPasteEnhancedMetafile\nSet activeSlideShapeRange = activeSlide.Shapes(activeSlide.Shapes.Count)\n\n'position:\n  activeSlide.Left = 234\n  activeSlide.Top = 186\n\n'empty clipboard\nApplication.CutCopyMode = False\n</code></pre>\n\n<p>HTH</p>\n"}], "owner": {"reputation": 43, "user_id": 4631670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b16b3eed134d01a585b6a51559e9e1d?s=128&d=identicon&r=PG&f=1", "display_name": "Charl&#233;lie Obadia", "link": "https://stackoverflow.com/users/4631670/charl%c3%a9lie-obadia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1593, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1425471505, "creation_date": 1425466103, "last_edit_date": 1425467980, "question_id": 28852502, "link": "https://stackoverflow.com/questions/28852502/unable-to-set-position-of-an-object-in-power-point-through-excel-using-vba", "title": "Unable to set position of an object in power point through excel using vba", "body": "<p>I'm currently working on a macro in excel for mac 2011. The goal of the macro is to copy charts and range in power point slide. However, whenever I try to set the position using the .Left property, it reset the value of said property to zero. I don't why i does that. Maybe it's because I'm using a mac edition. But I can't seem to find someone with the same issue as me. Could you help me to correct to code I'm using if there's an error or at least try to find a workaround? I appreciate any help from you guys.</p>\n\n<p>Here my code :</p>\n\n<pre><code>Option Explicit\n\nSub Presentation()\n    Application.ScreenUpdating = False\n    'Variable\n    Dim i As Integer\n    Dim tot As Integer\n    Dim newPowerPoint As PowerPoint.Application\n    Dim activeSlide As PowerPoint.slide\n    Dim cht As Excel.ChartObject\n    Dim tbl As Range\n    Dim sChart As Chart\n    tot = InputBox(\"Saisir le nombre de slide voulu : \", \"Nombre de Slides\")\n    i = 1\n\n    On Error Resume Next\n    Set newPowerPoint = GetObject(, \"PowerPoint.Application\")\n    On Error GoTo 0\n\n    'Create a power point\n    If newPowerPoint Is Nothing Then\n        Set newPowerPoint = New PowerPoint.Application\n    End If\n\n     'Create presentation\n    If newPowerPoint.Presentations.Count = 0 Then\n        newPowerPoint.Presentations.Add\n    End If\n\n    'Show presentation\n    newPowerPoint.Visible = True\n\n    'Loops through each worksheet named 1 , 2 ...\n    While i &lt;= tot\n\n        'Activate the i worksheet\n        Worksheets(CStr(i)).Activate\n\n        'Add a slide\n        newPowerPoint.ActivePresentation.Slides.Add newPowerPoint.ActivePresentation.Slides.Count + 1, ppLayoutTitleOnly\n        newPowerPoint.ActiveWindow.View.GotoSlide newPowerPoint.ActivePresentation.Slides.Count\n        Set activeSlide = newPowerPoint.ActivePresentation.Slides(newPowerPoint.ActivePresentation.Slides.Count)\n\n        'Get title\n        activeSlide.Shapes(1).TextFrame.TextRange.Text = Range(\"A1\").Value\n\n        'Ajust title position\n        activeSlide.Shapes(1).Left = 0\n        activeSlide.Shapes(1).Top = 0\n        'Loops through each charts in the sheet\n        For Each cht In ActiveSheet.ChartObjects\n            cht.Select\n            'Copie/Colle le graphique\n            ActiveChart.ChartArea.Copy\n            activeSlide.Shapes.Paste.Select\n\n            'Ajust the chart's position to bottom right\n            With newPowerPoint.ActiveWindow.Selection.ShapeRange\n                .Align msoAlignRights, msoTrue\n                .Align msoAlignBottoms, msoTrue\n\n            End With\n        Next\n\n        'Copy / Paste the range\n        Set tbl = ActiveSheet.Range(\"B1\").CurrentRegion\n        tbl.Offset(1, 0).Resize(tbl.Rows.Count - 1, tbl.Columns.Count).Select\n        Selection.Copy\n        With activeSlide.Shapes.Paste\n        'HERE'S THE PROBLEM\n            .Width = 300 'The value of width is now set to 0 instead of 300\n            .Height = 300 'The value of height is now set to 0 instead of 300\n            .Left = 720 'The value of left is now set to 0 instead of 720\n            .Top = 888 'The value of top is now set to 0 instead of 888\n        End With\n        i = i + 1\n    Wend\n    Application.ScreenUpdating = True\n    AppActivate (\"Microsoft PowerPoint\")\n    Set activeSlide = Nothing\n    Set newPowerPoint = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Please help me, I can't seem to find any solution and please excuse me if I'm not clear enough because I am french and english isn't my natural language.</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1425481158, "post_id": 28851974, "comment_id": 45981154, "body": "Well laid out question - keep up the good start."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 4629043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc0ce08496369e50c324b443ed85b298?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Barnfield", "link": "https://stackoverflow.com/users/4629043/tom-barnfield"}, "edited": false, "score": 0, "creation_date": 1425467038, "post_id": 28852230, "comment_id": 45972093, "body": "Amazing, that&#39;s done it. Thought it would be something simple like that! Thank you!"}], "tags": [], "owner": {"reputation": 2020, "user_id": 3442153, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/hwsHp.jpg?s=128&g=1", "display_name": "K\u1d00\u03c4\u1d22", "link": "https://stackoverflow.com/users/3442153/k%e1%b4%80%cf%84%e1%b4%a2"}, "is_accepted": true, "score": 1, "last_activity_date": 1425465673, "last_edit_date": 1425465673, "creation_date": 1425465330, "answer_id": 28852230, "question_id": 28851974, "link": "https://stackoverflow.com/questions/28851974/extract-a-single-line-of-data-from-numerous-text-files-and-import-into-excel/28852230#28852230", "title": "Extract a single line of data from numerous text files and import into Excel", "body": "<p>You have to reset your <code>text</code> otherwise the content of the second file is added and not replaced and the search always find the first GPS data and stop searching:</p>\n\n<pre><code>Sub ExtractGPS()\n    Dim filename As String, nextrow As Long, MyFolder As String\n    Dim MyFile As String, text As String, textline As String, posGPS As String\n\n    MyFolder = \"C:\\Temp\\Test\\\"\n    MyFile = Dir(MyFolder &amp; \"*.txt\")\n\n    Do While MyFile &lt;&gt; \"\"\n        Open (MyFolder &amp; MyFile) For Input As #1\n        Do Until EOF(1)\n            Line Input #1, textline\n            text = text &amp; textline 'second loop text is already stored -&gt; see reset text\n        Loop\n        Close #1\n        MyFile = Dir()\n        Debug.Print text\n        posGPS = InStr(text, \"GPS Position\")\n        nextrow = ActiveSheet.Cells(Rows.Count, \"A\").End(xlUp).Row + 1\n        ActiveSheet.Cells(nextrow, \"A\").Value = Mid(text, posGPS + 33, 37)\n        text = \"\" 'reset text\n    Loop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 4629043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc0ce08496369e50c324b443ed85b298?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Barnfield", "link": "https://stackoverflow.com/users/4629043/tom-barnfield"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4857, "favorite_count": 0, "accepted_answer_id": 28852230, "answer_count": 1, "score": 3, "last_activity_date": 1425481142, "creation_date": 1425464645, "last_edit_date": 1531161705, "question_id": 28851974, "link": "https://stackoverflow.com/questions/28851974/extract-a-single-line-of-data-from-numerous-text-files-and-import-into-excel", "title": "Extract a single line of data from numerous text files and import into Excel", "body": "<p>I have hundreds of text files in a folder and I need to extract a single line from each one and put the info into excel. The text files contain all the metadata for individual photographs and I need to take out just the GPS coordinates. </p>\n\n<p>I have looked through various other similar threads e.g: <a href=\"https://stackoverflow.com/questions/26610422/extract-data-from-multiple-text-files-in-a-folder-into-excel-worksheet\">extract data from multiple text files in a folder into excel worksheet</a></p>\n\n<p>and:</p>\n\n<p><a href=\"http://www.mrexcel.com/forum/excel-questions/531515-visual-basic-applications-retrieve-data-text-file.html\" rel=\"nofollow noreferrer\">http://www.mrexcel.com/forum/excel-questions/531515-visual-basic-applications-retrieve-data-text-file.html</a> (sorry, not stackoverflow!)</p>\n\n<p>and many others, but can't quite get it to work. I'm close but not quite there. </p>\n\n<p>The data in each of the textfiles is set out like this:</p>\n\n<p>...</p>\n\n<pre><code>---- Composite ----\nAperture                        : 3.8\nGPS Altitude                    : 37.2 m Above Sea Level\nGPS Date/Time                   : 2014:05:15 10:30:55.7Z\nGPS Latitude                    : 50 deg 7' 33.40\" N\nGPS Longitude                   : 5 deg 30' 4.06\" W\nGPS Position                    : 50 deg 7' 33.40\" N, 5 deg 30' 4.06\" W\nImage Size                      : 4608x3456\n</code></pre>\n\n<p>...</p>\n\n<p>I have written the following code:</p>\n\n<pre><code>Sub ExtractGPS()\n    Dim filename As String, nextrow As Long, MyFolder As String\n    Dim MyFile As String, text As String, textline As String, posGPS As String\n\n    MyFolder = \"C:\\Users\\Desktop\\Test\\\"\n    MyFile = Dir(MyFolder &amp; \"*.txt\")\n\n    Do While MyFile &lt;&gt; \"\"\n        Open (MyFolder &amp; MyFile) For Input As #1\n        Do Until EOF(1)\n            Line Input #1, textline\n            text = text &amp; textline\n        Loop\n\n        Close #1\n        MyFile = Dir()\n        posGPS = InStr(text, \"GPS Position\")\n        nextrow = Sheet1.Cells(Rows.Count, \"A\").End(xlUp).row + 1\n        Sheet1.Cells(nextrow, \"A\").Value = Mid(text, posGPS + 33, 37)\n    Loop\nEnd Sub\n</code></pre>\n\n<p>It appears to open each of the text files and look through them but only extracts the GPS coordinates from the first file and repeatedly puts this in excel so I end up with hundreds of rows filled with the same data - the GPS coordinates from the first file in the folder.</p>\n\n<p>If anyone can help me to finish this last bit off it would be greatly appreciated!</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba", "if-statement", "excel-2010"], "comments": [{"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 1, "creation_date": 1425463230, "post_id": 28851368, "comment_id": 45969895, "body": "change this <code>Worksheet(&quot;Side&quot;)</code> to <code>Worksheets(&quot;Side&quot;)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1431, "user_id": 4473648, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5ac0b1e66e69b31e1bede0090a17e28f?s=128&d=identicon&r=PG&f=1", "display_name": "Avidan", "link": "https://stackoverflow.com/users/4473648/avidan"}, "is_accepted": false, "score": 0, "last_activity_date": 1425463555, "last_edit_date": 1425463555, "creation_date": 1425463241, "answer_id": 28851474, "question_id": 28851368, "link": "https://stackoverflow.com/questions/28851368/comparing-named-range-against-a-cell-value/28851474#28851474", "title": "Comparing named range against a cell value", "body": "<p>Change <code>Worksheet(\"Side\").Range(\"B1\")</code> to <code>Worksheets(\"Side\").Range(\"B1\")</code>. </p>\n\n<p>If the error persists please check that the sub name is not the same as the module name and that you haven't used the same name in another sub as this can cause the definition error.</p>\n\n<p>Read more about this error at\n<a href=\"https://msdn.microsoft.com/en-us/library/s8y42ktc.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/s8y42ktc.aspx</a></p>\n"}, {"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 0, "last_activity_date": 1425463368, "creation_date": 1425463368, "answer_id": 28851519, "question_id": 28851368, "link": "https://stackoverflow.com/questions/28851368/comparing-named-range-against-a-cell-value/28851519#28851519", "title": "Comparing named range against a cell value", "body": "<p>You're not indexing the collection correctly. Use</p>\n\n<pre><code>Worksheets(\"Side\").Range(\"B1\") = \"yes\"\n</code></pre>\n\n<p>Note the plural.</p>\n"}, {"tags": [], "owner": {"reputation": 82, "user_id": 4465153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91662a5cf1cf6907c34e8a484aaa2a64?s=128&d=identicon&r=PG", "display_name": "JeroenDV", "link": "https://stackoverflow.com/users/4465153/jeroendv"}, "is_accepted": false, "score": 0, "last_activity_date": 1425464545, "creation_date": 1425464545, "answer_id": 28851940, "question_id": 28851368, "link": "https://stackoverflow.com/questions/28851368/comparing-named-range-against-a-cell-value/28851940#28851940", "title": "Comparing named range against a cell value", "body": "<p>Thanks, I have managed to find the other error. Forgot to type Range(\"data\"), </p>\n\n<p>Sub whatif()</p>\n\n<pre><code>If Range(\"memory\") = Range(\"data\") Then\n    Worksheets(\"Side\").Range(\"B1\").Value = 20\nEnd If\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 82, "user_id": 4465153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91662a5cf1cf6907c34e8a484aaa2a64?s=128&d=identicon&r=PG", "display_name": "JeroenDV", "link": "https://stackoverflow.com/users/4465153/jeroendv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 28851519, "answer_count": 3, "score": -2, "last_activity_date": 1565165411, "creation_date": 1425462952, "last_edit_date": 1565165411, "question_id": 28851368, "link": "https://stackoverflow.com/questions/28851368/comparing-named-range-against-a-cell-value", "title": "Comparing named range against a cell value", "body": "<p>I'll try to make a macro with an If statement in it. But I get the error message </p>\n\n<blockquote>\n  <p>Sub or Function not defined</p>\n</blockquote>\n\n<p>The following code is used.</p>\n\n<pre><code>Sub whatif()\n\n    If Range(\"memory\") = \"data\" Then \nWorksheet(\"Side\").Range(\"B1\") = \"yes\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>I figured out the problem is line</p>\n\n<pre><code>Worksheet(\"Side\").Range(\"B1\") = \"yes\"\n</code></pre>\n\n<p>The goal is as follows. \nIf the value of cell \"memory\" is equal to the value of cell \"data\". Cell B1 of the sheets \"Side\" gains the value \"yes\".</p>\n\n<p>When commenting out the other lines it still gives an error. What does need adjustment?</p>\n\n<p>Edit: It does not give an error any more but does not the thing I want it to do. </p>\n"}, {"tags": ["vba", "excel", "auto-update"], "comments": [{"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1425464848, "post_id": 28851067, "comment_id": 45970902, "body": "Clarification needed, inter alia: What does Sheet 3 contain? The union of Sheet 1 and Sheet 2? Cat gifs? What do you want to update on Sheet 3?"}, {"owner": {"reputation": 51, "user_id": 3782929, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/dd85a84762ce7b59279dfa9cba6d5b4e?s=128&d=identicon&r=PG&f=1", "display_name": "user3782929", "link": "https://stackoverflow.com/users/3782929/user3782929"}, "reply_to_user": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1425465618, "post_id": 28851067, "comment_id": 45971349, "body": "Sheet 3 has the same data as Sheets 1 and 2 (no union, all three sheets have the same exact data but the updates will be in numbers for  sheet 1 and in sheet 2 a simple highlight will be applied - but cells updated on sheet one cannot be the same as sheet 2) and every update to sheet  1&amp; 2 should reflect on sheet 3 as well."}], "answers": [{"comments": [{"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1425466762, "post_id": 28852626, "comment_id": 45971935, "body": "To do highlight the Sheet 2 contents as well, use <code>Sheets(&quot;Sheet 2&quot;).Cells(i, j).Interior.ColorIndex = 37</code> right after the <code>Sheets(&quot;Sheet 3&quot;).Cells(i, j).Value2 = Sheets(&quot;Sheet 1&quot;).Cells(i, j).Value2</code>."}, {"owner": {"reputation": 51, "user_id": 3782929, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/dd85a84762ce7b59279dfa9cba6d5b4e?s=128&d=identicon&r=PG&f=1", "display_name": "user3782929", "link": "https://stackoverflow.com/users/3782929/user3782929"}, "edited": false, "score": 0, "creation_date": 1425468701, "post_id": 28852626, "comment_id": 45973013, "body": "Thanks but No changes are effected in sheet 3 when I update sheet 1 or 2"}], "tags": [], "owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "is_accepted": false, "score": 0, "last_activity_date": 1425466475, "creation_date": 1425466475, "answer_id": 28852626, "question_id": 28851067, "link": "https://stackoverflow.com/questions/28851067/vba-code-to-populate-an-mi-spreadsheet-with-updates-from-two-different-sheets-in/28852626#28852626", "title": "VBA Code to populate an MI spreadsheet with updates from two different sheets in the same Excel workbook", "body": "<p>Add this to the module associated with <em>Sheet 1</em>.\nThe code will copy the modified range as is to <em>Sheet 3</em>.  </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nfr = Target.Row\nlr = fr - 1 + Target.Rows.Count\nfc = Target.Column\nlc = fc - 1 + Target.Columns.Count\n\nFor i = fr To lr\n    For j = fc To lc\n        Sheets(\"Sheet 3\").Cells(i, j).Value2 = Sheets(\"Sheet 1\").Cells(i, j).Value2\n    Next\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 3782929, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/dd85a84762ce7b59279dfa9cba6d5b4e?s=128&d=identicon&r=PG&f=1", "display_name": "user3782929", "link": "https://stackoverflow.com/users/3782929/user3782929"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521290998, "creation_date": 1425462051, "last_edit_date": 1531164843, "question_id": 28851067, "link": "https://stackoverflow.com/questions/28851067/vba-code-to-populate-an-mi-spreadsheet-with-updates-from-two-different-sheets-in", "title": "VBA Code to populate an MI spreadsheet with updates from two different sheets in the same Excel workbook", "body": "<p>I have three Excel worksheets: Sheet 1, Sheet 2,Sheet 3 all with the same standard data(Column A to E are standard data in all sheets) Columns F to JF are calendar days/Months. The difference being any update to sheet one is a number in a cell  in the calendar corresponding to the Names in Column A while update to Sheet 2 is only a highlight for the applicable cell (cells updated are never the same corresponding cell in Sheet 1 or vice versa - which I think makes sense).</p>\n\n<p>Sheet 3 needs to update for every update(s) to sheet 1 and 2.</p>\n\n<p>I am looking to use VBA to do this update to sheet 3.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1425465180, "post_id": 28851027, "comment_id": 45971079, "body": "Sure, first you&#39;ll need to buy a second head for your winchester. If you mean you want to give instructions at once, then I recommend creating an <b>array</b>."}, {"owner": {"reputation": 1, "user_id": 4631350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5131be743b0d772dbe18ef8c72066c7b?s=128&d=identicon&r=PG&f=1", "display_name": "yasawa", "link": "https://stackoverflow.com/users/4631350/yasawa"}, "reply_to_user": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1425467414, "post_id": 28851027, "comment_id": 45972307, "body": "Unfortunately, not to familiar with arrays"}, {"owner": {"reputation": 1, "user_id": 4631350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5131be743b0d772dbe18ef8c72066c7b?s=128&d=identicon&r=PG&f=1", "display_name": "yasawa", "link": "https://stackoverflow.com/users/4631350/yasawa"}, "reply_to_user": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1425468230, "post_id": 28851027, "comment_id": 45972758, "body": "Made this array, working but same result:"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4631350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5131be743b0d772dbe18ef8c72066c7b?s=128&d=identicon&r=PG&f=1", "display_name": "yasawa", "link": "https://stackoverflow.com/users/4631350/yasawa"}, "edited": false, "score": 0, "creation_date": 1425466819, "post_id": 28852294, "comment_id": 45971976, "body": "Thanks Tom: Double declaration for fso (fixed), but &quot;FileSystemObject.CopyFile Source:= FromPath &amp; obj.Name, Destination:=ToPath&quot; [Object required]"}], "tags": [], "owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1425467173, "last_edit_date": 1425467173, "creation_date": 1425465488, "answer_id": 28852294, "question_id": 28851027, "link": "https://stackoverflow.com/questions/28851027/excel-vba-copy-file-from-one-folder-to-many-folders-simultaneously/28852294#28852294", "title": "Excel vba: copy file from one folder to many folders simultaneously", "body": "<p>You could use something like this for your 2nd choice solution</p>\n\n<p>I can't test it on my machine right now, but it looks like a good solution to me. (;</p>\n\n<pre><code>FileSystemObject.CopyFile Source:= FromPath +\"*.FILEEXTENSION\", Destination :=ToPath\n</code></pre>\n\n<p>If all your files have similar names in regards of \"loopability\" (sth. like video1, video2 etc.) you could maybe use something like this:</p>\n\n<pre><code>Sub CountAndCopyFiles()\nDim fso As Object\nDim FromPath As String\nDim ToPath As String\nDim objFiles As Object\nDim obj As Object\nDim lngFileCount As Long\n\nFromPath = \"C:\\video\"  \n\n\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nSet objFiles = fso.GetFolder(FromPath).Files\n\nlngFileCount = objFiles.Count\n\nFor Each obj In objFiles\n  fso.CopyFile Source:= FromPath &amp; obj.Name, Destination:=ToPath\nNext obj\n\nSet objFiles = Nothing\nSet fso = Nothing\nSet obj = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>HTH, Tom</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4631350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5131be743b0d772dbe18ef8c72066c7b?s=128&d=identicon&r=PG&f=1", "display_name": "yasawa", "link": "https://stackoverflow.com/users/4631350/yasawa"}, "is_accepted": false, "score": 0, "last_activity_date": 1425468436, "creation_date": 1425468436, "answer_id": 28853253, "question_id": 28851027, "link": "https://stackoverflow.com/questions/28851027/excel-vba-copy-file-from-one-folder-to-many-folders-simultaneously/28853253#28853253", "title": "Excel vba: copy file from one folder to many folders simultaneously", "body": "<p>Tried to make this array, but same waiting result:</p>\n\n<pre><code>Sub xArray()\n\nApplication.ScreenUpdating = False\n\n    Dim fso As Object\n    Dim FromPath As String\n    Dim ToPath As String\n    Dim Drive(1 To 2) As String\n  Drive(1) = \"O\"\n    Drive(2) = \"P\"\nFor i = 1 To 2\n    FromPath = \"C:\\video\"  \n    ToPath = Drive(i) &amp; \":\\video\"   \n\n    If Right(FromPath, 1) = \"\\\" Then\n        FromPath = Left(FromPath, Len(FromPath) - 1)\n    End If\n\n    If Right(ToPath, 1) = \"\\\" Then\n        ToPath = Left(ToPath, Len(ToPath) - 1)\n    End If\n\n    Set fso = CreateObject(\"scripting.filesystemobject\")\n\n    If fso.FolderExists(FromPath) = False Then\n        MsgBox FromPath &amp; \" doesn't exist\"\n\n        Exit Sub\n    End If\n    fso.CopyFolder Source:=FromPath, Destination:=ToPath\n\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 0, "last_activity_date": 1425487386, "creation_date": 1425487386, "answer_id": 28860023, "question_id": 28851027, "link": "https://stackoverflow.com/questions/28851027/excel-vba-copy-file-from-one-folder-to-many-folders-simultaneously/28860023#28860023", "title": "Excel vba: copy file from one folder to many folders simultaneously", "body": "<p><strong>Without Waiting</strong></p>\n\n<p>What you want to do is spawn a new, child process (or thread) to do the file copy:</p>\n\n<pre><code>fso.CopyFolder Source:=FromPath, Destination:=ToPath\n</code></pre>\n\n<p>That way, the background thread can execute the file copy, while your code goes on to identify the next file to be copied and kicks off that copy.</p>\n\n<p>As far as I know, this isn't possible in native VBA. You need a compilable language like VB, or C. It's possible that someone will come along who knows the Windows shell objects very well, and can provide you with some shell function calls that will allow you to spawn these child processes, but it would be a pretty in-depth bit of coding.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4631350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5131be743b0d772dbe18ef8c72066c7b?s=128&d=identicon&r=PG&f=1", "display_name": "yasawa", "link": "https://stackoverflow.com/users/4631350/yasawa"}, "is_accepted": false, "score": 0, "last_activity_date": 1425501833, "creation_date": 1425501833, "answer_id": 28864528, "question_id": 28851027, "link": "https://stackoverflow.com/questions/28851027/excel-vba-copy-file-from-one-folder-to-many-folders-simultaneously/28864528#28864528", "title": "Excel vba: copy file from one folder to many folders simultaneously", "body": "<p>Solved</p>\n\n<p>Using the shell command, I called a .bat file that makes the copy process</p>\n\n<p>Thanks</p>\n"}], "owner": {"reputation": 1, "user_id": 4631350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5131be743b0d772dbe18ef8c72066c7b?s=128&d=identicon&r=PG&f=1", "display_name": "yasawa", "link": "https://stackoverflow.com/users/4631350/yasawa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1729, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1425501833, "creation_date": 1425461936, "last_edit_date": 1425469382, "question_id": 28851027, "link": "https://stackoverflow.com/questions/28851027/excel-vba-copy-file-from-one-folder-to-many-folders-simultaneously", "title": "Excel vba: copy file from one folder to many folders simultaneously", "body": "<p>I want to copy files from one directory to several others, I (with searching help and ready code) succeeded in doing that, the problem is :</p>\n\n<p>The macro waits till it finishes copying all files from source to destination 1, then start copying to destination 2</p>\n\n<p>I want either to:</p>\n\n<p>Copy the 1st source to all destinations at the same time then move to source 2\nOR start copying all source files to destination 1 then move to start copying all source files to destination 2 **</p>\n\n<h2>without waiting</h2>\n\n<p>**:</p>\n\n<p>I use the following to code to copy:</p>\n\n<pre><code>Sub All()\n\n    For Each C In Worksheets(\"Path\").Range(\"A2:A21\")\n    If C.Value = \"\" Then GoTo 1\n    Call CopyFolder\n\n    Application.ScreenUpdating = True\n        Next C\n\n1 \nEnd Sub\n\n'================================================\n\nSub CopyFolder()\n    Dim fso As Object\n    Dim FromPath As String\n    Dim ToPath As String\n\n    FromPath = \"C:\\video\"  \n    ToPath = C &amp; \":\\video\"    \n\n\n    If Right(FromPath, 1) = \"\\\" Then\n        FromPath = Left(FromPath, Len(FromPath) - 1)\n    End If\n\n    If Right(ToPath, 1) = \"\\\" Then\n        ToPath = Left(ToPath, Len(ToPath) - 1)\n    End If\n\n    Set fso = CreateObject(\"scripting.filesystemobject\")\n\n    If fso.FolderExists(FromPath) = False Then\n        MsgBox FromPath &amp; \" doesn't exist\"\n\n        Exit Sub\n    End If\n\n    fso.CopyFolder Source:=FromPath, Destination:=ToPath\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1425460318, "post_id": 28850471, "comment_id": 45968111, "body": "The best way to get help here is to first try something. If you get stuck, do some research, make an attempt at fixing things yourself, and only then ask a specific question about your attempts, showing what you have tried. Questions asking for complete solutions without demonstrating research effort usually get downvoted and closed."}, {"owner": {"reputation": 19, "user_id": 3758228, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tyJUZ.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/3758228/george"}, "reply_to_user": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1425461022, "post_id": 28850471, "comment_id": 45968524, "body": "This is how far I got with trial and error. Thanks for your help."}, {"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1425467747, "post_id": 28850471, "comment_id": 45972492, "body": "So what&#39;s the problem with your current code? Please edit your question to clarify this. If you want someone to help, then please don&#39;t keep us guessing."}, {"owner": {"reputation": 19, "user_id": 3758228, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tyJUZ.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/3758228/george"}, "reply_to_user": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1425482982, "post_id": 28850471, "comment_id": 45982434, "body": "Ok. I have created the rule to move the emails to the specified folder &quot;maintenance reports&quot;. Now i want to run this script in that folder.  I know how to create the button and how to assing the macro. The only problem I&#39;m having so far is how to get the vba to recognize the emails recieved today in that folder. Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1425477736, "post_id": 28855410, "comment_id": 45978759, "body": "There is no way to customize the Ribbon UI from VBA in Outlook! Only the QAT can be customized and then a VBA macro can be assigned."}, {"owner": {"reputation": 199, "user_id": 2895887, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9599606ae4fb9b48dea03bdba292d21a?s=128&d=identicon&r=PG&f=1", "display_name": "Seth", "link": "https://stackoverflow.com/users/2895887/seth"}, "reply_to_user": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1425484141, "post_id": 28855410, "comment_id": 45983236, "body": "In Outlook 2010 you can add custom buttons to the ribbon by using the Customize Ribbon interface (found in Outlook options). From there you can add Outlook VBA macros to ribbons, or groups (or even create your own). You can even give them icons, and custom names. So, while you&#39;re right that you can&#39;t achieve the end goal from code, it&#39;s possible to do what needs to be done by using built-in Outlook features."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1425484318, "post_id": 28855410, "comment_id": 45983365, "body": "The current web site is for developers. It is expected to see programming questions, i.e. how to do the job programmatically. So, using VBA there is no way to customize the Ribbon UI."}], "tags": [], "owner": {"reputation": 199, "user_id": 2895887, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9599606ae4fb9b48dea03bdba292d21a?s=128&d=identicon&r=PG&f=1", "display_name": "Seth", "link": "https://stackoverflow.com/users/2895887/seth"}, "is_accepted": false, "score": 0, "last_activity_date": 1425474774, "creation_date": 1425474774, "answer_id": 28855410, "question_id": 28850471, "link": "https://stackoverflow.com/questions/28850471/run-this-script-outlook-vbaon-a-button-and-get-it-to-insert-in-the-next-line/28855410#28855410", "title": "Run this script (outlook VBA)on a button and get it to insert in the next line?", "body": "<ol>\n<li><p>You'll need to check each line in the worksheet for a blank value. Then if it's blank fill that row. Like so:</p>\n\n<p>Dim blankLine As Long<br>\nblankLine = 2 'or wherever you want to start<br>\nDo<br>\n   If xlSheet.Cells(1,1).Value = \"\" Then<br>\n      Exit Do<br>\n   End If<br>\n   blankLine = blankLine + 1<br>\nLoop  </p></li>\n</ol>\n\n<p>You'll then want to use <code>blankLine</code> in each statement where your filling in a value on the spreadsheet. For example, <code>xlSheet.Cells(2, blankLine).Value = Trim(Mid(line, 6))</code>.</p>\n\n<ol start=\"2\">\n<li><p>To save and close the workbook, call the <code>.Save</code> and <code>.Close</code> methods on the workbook. Example, <code>xlWB.Save</code>.</p></li>\n<li><p>There are many good examples of how to add a custom button to the ribbon on MSDN. Try <a href=\"https://msdn.microsoft.com/en-us/library/office/ee767705%28v=office.14%29.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ee767705%28v=office.14%29.aspx</a>. Search around. There's lots of tutorials out there. Essentially you'll want to wrap what you currently have inside some code that will let you loop through all the messages in a particular folder. Outlook exposes its object model for that. Check out <a href=\"https://msdn.microsoft.com/en-us/library/office/ee814736%28v=office.14%29.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ee814736%28v=office.14%29.aspx</a>.</p></li>\n</ol>\n\n<p>Good luck!</p>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 3758228, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tyJUZ.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/3758228/george"}, "edited": false, "score": 0, "creation_date": 1434986589, "post_id": 28856536, "comment_id": 49997753, "body": "Thanks Eugene! I found some of the answers with what you suggested."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 1, "last_activity_date": 1425478088, "creation_date": 1425478088, "answer_id": 28856536, "question_id": 28850471, "link": "https://stackoverflow.com/questions/28850471/run-this-script-outlook-vbaon-a-button-and-get-it-to-insert-in-the-next-line/28856536#28856536", "title": "Run this script (outlook VBA)on a button and get it to insert in the next line?", "body": "<p>I will try to answer the Outlook related part of your questions:</p>\n\n<blockquote>\n  <p>Because of the number of emails I'm getting, i would like to know how to run this on a button instead of it reading all emails that come in. Example: I would create a rule in Outlook to move all emails with the specified subject to a folder called \"Maintenance Reports\". Then, If possible, I would run the macro from that folder and get all the values into the spreadsheet at the end on the day. Is this difficult to accomplish?</p>\n</blockquote>\n\n<p>Of course, creating a new instance of the Excel Application class in the NewMailEx event handler is not the right idea. </p>\n\n<p>Also Outlook doesn't provide any way for customizing the UI using VBA. You need to develop an Outlook add-in instead. See <a href=\"https://msdn.microsoft.com/en-us/library/cc668191.aspx\" rel=\"nofollow\">Walkthrough: Creating Your First Application-Level Add-in for Outlook</a> for more information. </p>\n\n<p>You can use the <a href=\"http://msdn.microsoft.com/en-us/library/ff869662.aspx\" rel=\"nofollow\">Find</a>/<a href=\"http://msdn.microsoft.com/en-us/library/ff862482.aspx\" rel=\"nofollow\">FindNext</a> or <a href=\"http://msdn.microsoft.com/en-us/library/ff869597.aspx\" rel=\"nofollow\">Restrict</a> methods to find all items in the folder that correspond to your criteria. See the following articles for more information and sample code:</p>\n\n<ul>\n<li><a href=\"https://www.add-in-express.com/creating-addins-blog/2011/09/20/outlook-find-findnext-retrieve-mail/\" rel=\"nofollow\">How To: Use Find and FindNext methods to retrieve Outlook mail items from a folder (C#, VB.NET)</a></li>\n<li><a href=\"https://www.add-in-express.com/creating-addins-blog/2011/09/23/outlook-restrict-method-retrieve-mail/\" rel=\"nofollow\">How To: Use Restrict method to retrieve Outlook mail items from a folder</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 19, "user_id": 3758228, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tyJUZ.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/3758228/george"}, "is_accepted": true, "score": 1, "last_activity_date": 1434986419, "creation_date": 1434986419, "answer_id": 30983767, "question_id": 28850471, "link": "https://stackoverflow.com/questions/28850471/run-this-script-outlook-vbaon-a-button-and-get-it-to-insert-in-the-next-line/30983767#30983767", "title": "Run this script (outlook VBA)on a button and get it to insert in the next line?", "body": "<p>Well, despite the negative rating, I managed to get this to work following  Jean-Fran\u00e7ois Corbett advice. But to be true, I didnt ask the question because I wanted a solution. I askedthe question because i wanted some instruction how to get there. Here is the answer for anyone who would like to try:</p>\n\n<pre><code>    Option Explicit\n\n    Sub Export()\n\n    Dim xlApp As Excel.Application\n\n    Dim xlWB As Excel.Workbook\n\n    Dim xlSheet As Excel.Worksheet\n\n    Dim id As Variant\n    Dim email As Outlook.MailItem\n    Dim msgText As Variant\n    Set xlApp = CreateObject(\"Excel.Application\")\n\n\n\n    Set xlWB = xlApp.Workbooks.Open(FileName:=\"C:\\Users\\User\\Desktop\\gsmaster.xlsm\", AddTOMRU:=True, UpdateLinks:=True)\n\n    Set xlSheet = xlWB.Worksheets(\"LLCHARGES\")\n\n\n\n    Dim LR As Long\n\n    LR = xlSheet.Range(\"A\" &amp; xlSheet.Rows.Count).End(xlUp).Row + 1\n\n\n    Set email = Application.ActiveExplorer().Selection(1)\n    If email.Subject = \"Report of Property\" Then\n\n    Dim line As Variant\n\n\n\n    For Each line In Split(email.Body, vbCrLf)\n\n\n    If Left(line, 4) = \"Date\" Then\n    xlSheet.Range(\"A\" &amp; LR).Value = DateValue(Trim(Mid(line, 6)))\n    ElseIf Left(line, 5) = \"Name:\" Then\n    xlSheet.Range(\"B\" &amp; LR).Value = Trim(Mid(line, 6))\n    ElseIf Left(line, 8) = \"Sage n\u00ba:\" Then\n    xlSheet.Range(\"D\" &amp; LR).Value = Trim(Mid(line, 9))\n    ElseIf Left(line, 19) = \"Complete Checklist:\" Then\n    xlSheet.Range(\"V\" &amp; LR).Value = Trim(Mid(line, 20))\n    ElseIf Left(line, 4) = \"Job:\" Then\n    xlSheet.Range(\"G\" &amp; LR).Value = Trim(Mid(line, 5))\n    ElseIf Left(line, 9) = \"Materials\" Then\n    xlSheet.Range(\"W\" &amp; LR).Value = Trim(Mid(line, 13))\n    ElseIf Left(line, 8) = \"Duration\" Then\n    xlSheet.Range(\"X\" &amp; LR).Value = Trim(Mid(line, 12))\n\n    xlWB.Close SaveChanges:=True\n    xlApp.Quit\n    Set xlApp = Nothing\n    Else\n\n    End If\n\n\n\n    Next\n\n\n\n    Set xlApp = Nothing\n\n    MsgBox (\"Exporting Finished!\")\n    Else\n    MsgBox \"Not report email!\"\n    End If\n\n    End Sub\n\n    Sub Issue()\n    Dim xlApp2 As Excel.Application\n\n    Dim xlWB2 As Excel.Workbook\n\n    Dim xlSheet2 As Excel.Worksheet\n\n    Dim id As Variant\n    Dim email As Outlook.MailItem\n    Dim msgText As Variant\n    Set xlApp2 = CreateObject(\"Excel.Application\")\n\n\n\n    Set xlWB2 = xlApp2.Workbooks.Open(FileName:=\"C:\\Users\\User\\Desktop\\Work.xlsm\", AddTOMRU:=True, UpdateLinks:=True)\n\n    Set xlSheet2 = xlWB2.Worksheets(\"issues\")\n\n\n\n    Dim LR As Long\n\n    LR = xlSheet2.Range(\"A\" &amp; xlSheet2.Rows.Count).End(xlUp).Row + 1\n\n\n    Set email = Application.ActiveExplorer().Selection(1)\n\n    Dim line As Variant\n\n\n\n    For Each line In Split(email.Body, vbCrLf)\n\n\n\n    If Left(line, 12) = \"Unrepairable\" Then\n    MsgBox \"Issue found!\"\n    xlSheet2.Range(\"C\" &amp; LR).Value = Trim(Mid(line, 28))\n    ElseIf Left(line, 8) = \"Sage n\u00ba:\" Then\n    xlSheet2.Range(\"A\" &amp; LR).Value = Trim(Mid(line, 9))\n    ElseIf Left(line, 5) = \"Date:\" Then\n    xlSheet2.Range(\"D\" &amp; LR).Value = DateValue(Trim(Mid(line, 6)))\n\n    Else\n    If Left(line, 15) = \"No unrepairable\" Then\n    MsgBox \"No Issues found!\"\n    End If\n\n    End If\n\n\n    Next\n    xlWB2.Close SaveChanges:=True\n    xlApp2.Quit\n    Set xlApp2 = Nothing\n    Beep\n\n    MsgBox \"Document has been processed!\"\n    End Sub\n</code></pre>\n\n<p>Then I just created a button on the ribbon that would run the macros in turn. Solved with patience, trial and error.</p>\n\n<p>I post the answer to help other people, like me, who are getting started and need some guidance. \nTo those who helped: Thank you! To those who didn't: Thank you too! For the incredibly smart who think that everyone is born smart, that each individual must express himself in binary so that you may understand, i say: .....!</p>\n"}], "owner": {"reputation": 19, "user_id": 3758228, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tyJUZ.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/3758228/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1008, "favorite_count": 0, "accepted_answer_id": 30983767, "answer_count": 3, "score": -2, "last_activity_date": 1443252305, "creation_date": 1425460295, "last_edit_date": 1443252305, "question_id": 28850471, "link": "https://stackoverflow.com/questions/28850471/run-this-script-outlook-vbaon-a-button-and-get-it-to-insert-in-the-next-line", "title": "Run this script (outlook VBA)on a button and get it to insert in the next line?", "body": "<p>A few months I had a lot of help to write this script. It reads the incoming email and, if the subject is equal to the \"Report of Property\", it reads the email and opens a file and inserts the values. \nThis is what's happening:</p>\n\n<ol>\n<li>It opens the file and inserts the values in the correct colums.</li>\n</ol>\n\n<p>What it isn't doing:</p>\n\n<ol>\n<li>I want it to find the first empty line in the spreadsheet and paste the values there.</li>\n<li>I want it to save and close the spread sheet when it's done.</li>\n<li>Because of the number of emails I'm getting, i would like to know how to run this on a button instead of it reading all emails that come in. Example: I would create a rule in Outlook to move all emails with the specified subject to a folder called \"Maintenance Reports\". Then, If possible, I would run the macro from that folder and get all the values into the spreadsheet at the end on the day. Is this difficult to accomplish?</li>\n</ol>\n\n<p>Here is the script or VBA code:</p>\n\n<pre><code> Sub Application_NewMailEx(ByVal EntryIDCollection As String)\nOn Error Resume Next\nDim xlApp As Excel.Application\nDim xlWB As Excel.Workbook\nDim xlSheet As Excel.Worksheet\n\nDim id As Variant\nDim email As Outlook.MailItem\nDim msgText As Variant\n\nSet xlApp = CreateObject(\"Excel.Application\")\n\n\nFor Each id In Split(EntryIDCollection, \",\")\n\nSet email = Application.Session.GetItemFromID(id)\n\nIf email.Subject = \"Report of Property\" Then\nDim line As Variant\n\n    Set xlWB = xlApp.Workbooks.Open(FileName:=\"C:\\Users\\George\\Desktop\\gs.xlsx\", AddTOMRU:=False, UpdateLinks:=False)\n    Set xlSheet = xlWB.Worksheets(1)\n   line = xlSheet.Range(\"A\" &amp; xlSheet.Rows.Count).End(-4162).Offset(1).Row\n\n\n   For Each line In Split(email.Body, vbCrLf)\n        If Left(line, 5) = \"Name:\" Then\n             xlSheet.Range(\"B6\").Value = Trim(Mid(line, 6))\n         ElseIf Left(line, 12) = \"Time started\" Then\n             xlSheet.Range(\"A6\").Value = DateValue(Trim(Mid(line, 14)))\n          ElseIf Left(line, 8) = \"Sage n\u00ba:\" Then\n             xlSheet.Range(\"D6\").Value = Trim(Mid(line, 9))\n          ElseIf Left(line, 19) = \"Complete Checklist:\" Then\n             xlSheet.Range(\"F6\").Value = Trim(Mid(line, 20))\n         ElseIf Left(line, 4) = \"Job:\" Then\n             xlSheet.Range(\"G6\").Value = Trim(Mid(line, 6))\n          ElseIf Left(line, 9) = \"Materials\" Then\n             xlSheet.Range(\"W6\").Value = Trim(Mid(line, 13))\n          ElseIf Left(line, 8) = \"Duration\" Then\n             xlSheet.Range(\"K6\").Value = Trim(Mid(line, 12))\n\n\n\n         End If\n    Next\n\n\nElse:\n\nEnd If\n\nxlApp.Visible = True\n\nNext\nEnd Sub\n</code></pre>\n\n<p>Any help is welcome. Thank you in advance!\nGeorge</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1425460391, "post_id": 28850247, "comment_id": 45968142, "body": "The best way to get help here is to first try something. If you get stuck, do some research, make an attempt at fixing things yourself, and only then ask a specific question about your attempts, showing what you have tried. Questions asking for complete solutions without demonstrating research effort usually get downvoted and closed."}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1425464442, "post_id": 28850247, "comment_id": 45970653, "body": "I would just add an (Excel table)[<a href=\"https://support.office.com/en-za/article/Create-or-delete-an-Excel-table-in-a-worksheet-867f3add-0522-493c-94ab-b1b9933f46ca]\" rel=\"nofollow noreferrer\">support.office.com/en-za/article/&hellip;</a>. They trigger the event and pull down your formula any time a new value is entered without the nasty side-effects of VBA (blocked etc.). Works on workbooks that are not shared ones."}], "answers": [{"comments": [{"owner": {"reputation": 225, "user_id": 1425503, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/zYLp2.jpg?s=128&g=1", "display_name": "Ras Rass", "link": "https://stackoverflow.com/users/1425503/ras-rass"}, "edited": false, "score": 0, "creation_date": 1425463582, "post_id": 28851041, "comment_id": 45970105, "body": "Thank you very much for your help.. :)"}], "tags": [], "owner": {"reputation": 530, "user_id": 3569330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9A90P.png?s=128&g=1", "display_name": "jcbermu", "link": "https://stackoverflow.com/users/3569330/jcbermu"}, "is_accepted": true, "score": 0, "last_activity_date": 1425461979, "creation_date": 1425461979, "answer_id": 28851041, "question_id": 28850247, "link": "https://stackoverflow.com/questions/28850247/inserting-rows-from-the-selected-value/28851041#28851041", "title": "inserting row(s) from the selected value", "body": "<p>This VBA code takes values from cells <code>A2</code> and <code>B2</code> and generates the new rows on columns <code>D</code> and <code>E</code>:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    first_column = 4 'first column of results\n    total_months = Cells(2, 1) 'cell of total months\n    total_amount = Cells(2, 2) 'cell of total amount\n    calculated_value = total_amount / total_months\n    changed = False\n    Dim a As Range\n    Select Case Target.Address\n        Case \"$A$2\"\n            changed = True\n        Case \"$B$2\"\n            changed = True\n    End Select\n    If changed = True Then 'only updates if change cells A2 or B2\n        Columns(first_column).ClearContents\n        Columns(first_column + 1).ClearContents\n        Cells(1, first_column) = \"month\"\n        Cells(1, first_column + 1) = \"amount\"\n        For i = 2 To total_months + 1 ' loop the number of rows=totalmonths\n            Cells(i, first_column) = i - 1\n            Cells(i, first_column + 1) = calculated_value\n        Next i\n    End If\nEnd Sub\n</code></pre>\n\n<p>You have to copy the code, go to View -> Macros in Excel, create a new one (any name is valid) and on the left column double click the worksheet where you want to use it (<strong>red flag in the picture</strong>) and in the right side, paste the code. </p>\n\n<p><img src=\"https://i.stack.imgur.com/kVk95.png\" alt=\"VBA Macro on Sheet\"></p>\n\n<p>This is the way it looks:</p>\n\n<p><img src=\"https://i.stack.imgur.com/Jwp2G.png\" alt=\"excel_rows\"></p>\n"}, {"tags": [], "owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1425462069, "creation_date": 1425462069, "answer_id": 28851071, "question_id": 28850247, "link": "https://stackoverflow.com/questions/28850247/inserting-rows-from-the-selected-value/28851071#28851071", "title": "inserting row(s) from the selected value", "body": "<p>If all you are looking for is how to loop in vba then this might help you:</p>\n\n<pre><code>'12 = times you want to loop\nFor i = 1 to 12 \n\n'inserts row before row number i\nThisWorkbook.Sheets(1).Rows(i).Insert\n'fill cells with content\nSheets(1).Cells(i,1) = &lt;something\n\n'loop \nNext i\n</code></pre>\n"}], "owner": {"reputation": 225, "user_id": 1425503, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/zYLp2.jpg?s=128&g=1", "display_name": "Ras Rass", "link": "https://stackoverflow.com/users/1425503/ras-rass"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 28851041, "answer_count": 2, "score": 0, "last_activity_date": 1425462069, "creation_date": 1425459573, "last_edit_date": 1425460936, "question_id": 28850247, "link": "https://stackoverflow.com/questions/28850247/inserting-rows-from-the-selected-value", "title": "inserting row(s) from the selected value", "body": "<p>I have 2 columns A and B. </p>\n\n<pre><code>A = 12 (months)\nB = 12.000.000\nC (result) = B/A = 12.000.000 / 12 = 1.000.000\n</code></pre>\n\n<p>The result that I want will be looping automatically insert new row(s) based on months (A)</p>\n\n<pre><code>month     amount\n1        1.000.000\n2        1.000.000\n3        1.000.000\n4        1.000.000\n5        1.000.000\n6        1.000.000\n.\n.\n.\n12       1.000.000\n</code></pre>\n\n<p>this is my complete code while adding in my case :</p>\n\n<pre><code>Private Sub cmdAdd_Click()\nDim lRow As Long\nDim lPart As Long\nDim ws As Worksheet\nSet ws = Worksheets(\"PostBudgetData\")\n\nlRow = ws.Cells.Find(What:=\"*\", SearchOrder:=xlRows, _\n    SearchDirection:=xlPrevious, LookIn:=xlValues).Row + 1\n\nlPart = Me.cboMonth.ListIndex\n    If CheckBox1.Value = True Then\n    If Trim(Me.cboMonth.Value) = \"\" Then\n        Me.cboMonth.SetFocus\n        MsgBox \"Please enter a part number\"\n    Exit Sub\n    End If\nEnd If\n\n\n\n'copy the data to the database\nWith ws\n  .Cells(lRow, 1).Value = Me.cboYear.Value\nIf CheckBox1.Value = True Then\n      .Cells(lRow, 2).Value = Me.cboMonth.List(lPart, 0)\nEnd If\n  .Cells(lRow, 3).Value = Me.cboBrand.Value\n  .Cells(lRow, 4).Value = Me.cboPostBudget.Value\n  .Cells(lRow, 5).Value = Me.cboArea.Value\n  .Cells(lRow, 6).Value = Me.txtValue.Value\n  .Cells(lRow, 7).Value = Me.cboSBU.Value\nEnd With\n\n'clear the data\nMe.cboMonth.Value = \"\"\nMe.cboYear.Value = \"\"\nMe.cboBrand.Value = \"\"\nMe.cboPostBudget.Value = \"\"\nMe.cboArea.Value = \"\"\nMe.cboSBU.Value = \"\"\n\n'Me.txtValue.Value = Format(Date, \"Medium Date\")\nMe.txtValue.Value = 0\n\nIf CheckBox1.Value = True Then\n      Me.cboMonth.SetFocus\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>But it is not looping. I don't know to loop in vba while inserting new row(s) cos it just insert 1 row. This is what i tried not just I'm tired and asking without do anything. </p>\n"}, {"tags": ["excel", "powerpivot", "vba"], "answers": [{"comments": [{"owner": {"reputation": 72, "user_id": 4499291, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/870035ea548cd7986b9867bd817aaf9c?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Dahlen", "link": "https://stackoverflow.com/users/4499291/erik-dahlen"}, "edited": false, "score": 0, "creation_date": 1425459636, "post_id": 28849546, "comment_id": 45967724, "body": "Thanks, it helped me solve one of the problem, update date when update fails :) but it stil update the date when I open the excel file."}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "reply_to_user": {"reputation": 72, "user_id": 4499291, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/870035ea548cd7986b9867bd817aaf9c?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Dahlen", "link": "https://stackoverflow.com/users/4499291/erik-dahlen"}, "edited": false, "score": 0, "creation_date": 1425460536, "post_id": 28849546, "comment_id": 45968233, "body": "That&#39;s a property that has nothing to do with VBA disable it at <a href=\"https://support.office.com/en-au/article/Update-refresh-data-in-a-PivotTable-d3f74ee2-0da7-4aef-8b2f-481bb2f18218\" rel=\"nofollow noreferrer\">your Pivot&#39;s settings</a>."}, {"owner": {"reputation": 72, "user_id": 4499291, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/870035ea548cd7986b9867bd817aaf9c?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Dahlen", "link": "https://stackoverflow.com/users/4499291/erik-dahlen"}, "edited": false, "score": 1, "creation_date": 1425462013, "post_id": 28849546, "comment_id": 45969117, "body": "Ok, that might work, I solved it in a different way. Instead of letting excel determine the date for the update I send the date from the server along with the data."}], "tags": [], "owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "is_accepted": false, "score": 0, "last_activity_date": 1425457111, "creation_date": 1425457111, "answer_id": 28849546, "question_id": 28849238, "link": "https://stackoverflow.com/questions/28849238/excel-powerpivot-show-when-the-data-was-updated/28849546#28849546", "title": "Excel powerpivot, show when the data was updated?", "body": "<p>How about its event?</p>\n\n<pre><code>Private Sub Worksheet_PivotTableUpdate(ByVal Target As PivotTable) \nRange(\"date cell\").Select\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 72, "user_id": 4499291, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/870035ea548cd7986b9867bd817aaf9c?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Dahlen", "link": "https://stackoverflow.com/users/4499291/erik-dahlen"}, "is_accepted": false, "score": 1, "last_activity_date": 1425462771, "creation_date": 1425462771, "answer_id": 28851307, "question_id": 28849238, "link": "https://stackoverflow.com/questions/28849238/excel-powerpivot-show-when-the-data-was-updated/28851307#28851307", "title": "Excel powerpivot, show when the data was updated?", "body": "<p>Instead of solve it as user3819867 suggested, I solved it by adding the information from the database, which is a SQL server database so I added a view with one colum and one row (with a getdate()) and send it along with the other tables so I get one extra table named \"date\". </p>\n"}], "owner": {"reputation": 72, "user_id": 4499291, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/870035ea548cd7986b9867bd817aaf9c?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Dahlen", "link": "https://stackoverflow.com/users/4499291/erik-dahlen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1427338878, "creation_date": 1425456013, "last_edit_date": 1531164843, "question_id": 28849238, "link": "https://stackoverflow.com/questions/28849238/excel-powerpivot-show-when-the-data-was-updated", "title": "Excel powerpivot, show when the data was updated?", "body": "<p>I have an Excel sheet with powerpivot tables and charts. I want to show when the data was updated.</p>\n\n<p>I use VBA code and a button to update the data, and I use the function now() in a cell which is updated when the code is running. </p>\n\n<p>I have two problems. </p>\n\n<ul>\n<li>When I open the Excel file the date is updated even if I do not update the data on start. (I do not want the data to update on start)</li>\n<li>When the update fails the date is still updated. </li>\n</ul>\n\n<p>My VBA code look like this:</p>\n\n<pre><code>Range(\"table name\").Select\nActiveSheet.PivotTables(\"PivotTable2\").PivotCache.refresh\nRange(\"date cell\").Select\n</code></pre>\n\n<p>How to avoid update when the data is not updated?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 2274386, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c6589bf4cda642843616f78ab55d174f?s=128&d=identicon&r=PG", "display_name": "user2274386", "link": "https://stackoverflow.com/users/2274386/user2274386"}, "edited": false, "score": 0, "creation_date": 1425460111, "post_id": 28849599, "comment_id": 45967988, "body": "Thanks a lot. That did the trick. But now I realized that I&#39;ve got trouble with the EVAL function. =EVAL(&quot;income*1.19&quot;) works, but =EVAL(&quot;AND(income&gt;40, income&lt;80)&quot;) shows always false. Any idea?"}, {"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "reply_to_user": {"reputation": 33, "user_id": 2274386, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c6589bf4cda642843616f78ab55d174f?s=128&d=identicon&r=PG", "display_name": "user2274386", "link": "https://stackoverflow.com/users/2274386/user2274386"}, "edited": false, "score": 0, "creation_date": 1425461047, "post_id": 28849599, "comment_id": 45968537, "body": "you&#39;re right, but I have no idea why. you don&#39;t need your formula to do that? it seems that you need to do it in different way."}, {"owner": {"reputation": 33, "user_id": 2274386, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c6589bf4cda642843616f78ab55d174f?s=128&d=identicon&r=PG", "display_name": "user2274386", "link": "https://stackoverflow.com/users/2274386/user2274386"}, "edited": false, "score": 0, "creation_date": 1425461645, "post_id": 28849599, "comment_id": 45968900, "body": "Actually most of my checks have multiple conditions, I just wanted to start with the easieast... And I thought, that EVAL would work..."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1425463201, "post_id": 28849599, "comment_id": 45969874, "body": "AND returns <i>one</i> result based on whether <i>all</i> rows of the range meet the conditions, not an array of results for each row. It&#39;s nothing to do with <code>Evaluate</code>. You need an IF function, or a multiplication of conditions."}, {"owner": {"reputation": 33, "user_id": 2274386, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c6589bf4cda642843616f78ab55d174f?s=128&d=identicon&r=PG", "display_name": "user2274386", "link": "https://stackoverflow.com/users/2274386/user2274386"}, "edited": false, "score": 0, "creation_date": 1425463846, "post_id": 28849599, "comment_id": 45970281, "body": "Ahhh I see, Excel takes all values of the array!!! So I need one way that it takes only the values of that specific row. Thanks for the hint! But if I&#39;m doing only income&lt;40 it caluclates only on the specific row..."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1425467965, "post_id": 28849599, "comment_id": 45972622, "body": "Yep - your formula needs to be something like <code>(income&gt;10)*(income&lt;60)</code>"}, {"owner": {"reputation": 33, "user_id": 2274386, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c6589bf4cda642843616f78ab55d174f?s=128&d=identicon&r=PG", "display_name": "user2274386", "link": "https://stackoverflow.com/users/2274386/user2274386"}, "edited": false, "score": 0, "creation_date": 1425468696, "post_id": 28849599, "comment_id": 45973011, "body": "Thanks! And what would I have to do for something like OR(income&gt;10, income&lt;60)?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1425469781, "post_id": 28849599, "comment_id": 45973580, "body": "That wouldn&#39;t make a lot of sense! ;) Typically for an OR condition in an array you add rather than multiplying."}], "tags": [], "owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "is_accepted": true, "score": 0, "last_activity_date": 1425457310, "creation_date": 1425457310, "answer_id": 28849599, "question_id": 28849002, "link": "https://stackoverflow.com/questions/28849002/excel-string-evaluation-reference-on-named-range-fails/28849599#28849599", "title": "Excel String Evaluation reference on named range fails", "body": "<p>All you need is to enter your formula to excel cells as an array formula. Follow the steps:</p>\n\n<ol>\n<li>enter formula to cells</li>\n<li>select range with formulas</li>\n<li>press F2</li>\n<li>press Ctrl + Shift + Enter</li>\n</ol>\n"}], "owner": {"reputation": 33, "user_id": 2274386, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c6589bf4cda642843616f78ab55d174f?s=128&d=identicon&r=PG", "display_name": "user2274386", "link": "https://stackoverflow.com/users/2274386/user2274386"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 28849599, "answer_count": 1, "score": 0, "last_activity_date": 1425457310, "creation_date": 1425455098, "last_edit_date": 1531161705, "question_id": 28849002, "link": "https://stackoverflow.com/questions/28849002/excel-string-evaluation-reference-on-named-range-fails", "title": "Excel String Evaluation reference on named range fails", "body": "<p>I've got a named range called 'income' and a EVAL function</p>\n\n<pre><code>Function EVAL(Ref As String)\nApplication.Volatile\nEVAL = Evaluate(Ref)\nEnd Function\n</code></pre>\n\n<p>Next is a String \"income * 1.19\".\nI use the EVAL function to calculate the value. But this works only for the first value in the named range.</p>\n\n<p>Here a short example: <a href=\"https://dl.dropboxusercontent.com/u/10095862/example.xlsm\" rel=\"nofollow\">File</a></p>\n\n<p>I would appreciate any help.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel", "excel-2013"], "comments": [{"owner": {"reputation": 296034, "user_id": 829571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zflGZ.png?s=128&g=1", "display_name": "assylias", "link": "https://stackoverflow.com/users/829571/assylias"}, "edited": false, "score": 1, "creation_date": 1425459251, "post_id": 28848860, "comment_id": 45967517, "body": "is Band Number and Line Number the same thing?"}, {"owner": {"reputation": 8189, "user_id": 4342479, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ba8f7b5222688205d3047ef8093c2608?s=128&d=identicon&r=PG&f=1", "display_name": "\u0110\u1ee9c Thanh Nguy\u1ec5n", "link": "https://stackoverflow.com/users/4342479/%c4%90%e1%bb%a9c-thanh-nguy%e1%bb%85n"}, "reply_to_user": {"reputation": 296034, "user_id": 829571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zflGZ.png?s=128&g=1", "display_name": "assylias", "link": "https://stackoverflow.com/users/829571/assylias"}, "edited": false, "score": 0, "creation_date": 1425460254, "post_id": 28848860, "comment_id": 45968062, "body": "@assylias, I think that they are the same by looking at the header: Line No (book1 - column A) and Line Number (book2 - column B)"}, {"owner": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "edited": false, "score": 0, "creation_date": 1425483751, "post_id": 28848860, "comment_id": 45982949, "body": "Why not just use a VLOOKUP? Seems a much simpler way of achieving this."}], "answers": [{"tags": [], "owner": {"reputation": 8189, "user_id": 4342479, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ba8f7b5222688205d3047ef8093c2608?s=128&d=identicon&r=PG&f=1", "display_name": "\u0110\u1ee9c Thanh Nguy\u1ec5n", "link": "https://stackoverflow.com/users/4342479/%c4%90%e1%bb%a9c-thanh-nguy%e1%bb%85n"}, "is_accepted": false, "score": 0, "last_activity_date": 1425459849, "last_edit_date": 1425459849, "creation_date": 1425459446, "answer_id": 28850204, "question_id": 28848860, "link": "https://stackoverflow.com/questions/28848860/excel-vba-macro-to-import-information-from-one-book-to-another/28850204#28850204", "title": "excel vba macro to import information from one book to another", "body": "<p>Is this something you are looking for, I hope?\nYou need to match both columns so take both columns to the dictionary.</p>\n\n<pre><code>'.......\n'-------------------------------------------------------------------------\n'get the last row for w1\ni = w1.Cells.SpecialCells(xlCellTypeLastCell).Row\n'-------------------------------------------------------------------------\n' fill dictionary with data for searching\nFor Each oCell In w1.Range(\"C2:C\" &amp; i)\n    'row number for duplicates\n    z = 1: While Dic.exists(oCell.Value &amp; \"_\" &amp; oCell.Offset(, 3).Value &amp; \"_\" &amp; z): z = z + 1: Wend\n    'add data with row number to dictionary\n    If Not Dic.exists(oCell.Value &amp; \"_\" &amp; oCell.Offset(, 3).Value &amp; \"_\" &amp; z) Then\n        Dic.Add oCell.Value &amp; \"_\" &amp; oCell.Offset(, 3).Value &amp; \"_\" &amp; z, oCell.Offset(, -2).Value\n    End If\nNext\n'-------------------------------------------------------------------------\n'get the last row for w2\ni = w2.Cells.SpecialCells(xlCellTypeLastCell).Row\n'-------------------------------------------------------------------------\n'fill \"B\" with results\nFor Each oCell In w2.Range(\"D2:D\" &amp; i)\n    'determinate row number for duplicated values\n    z = 1: While Dic2.exists(oCell.Value &amp; \"_\" &amp; oCell.Offset(, 3).Value &amp; \"_\" &amp; z): z = z + 1: Wend\n    'search\n    For Each key In Dic\n        If oCell.Value &amp; \"_\" &amp; oCell.Offset(, 3).Value &amp; \"_\" &amp; z = key Then\n            oCell.Offset(, -2).Value = Dic(key)\n        End If\n    Next\n    'correction of the dictionary in case\n    'when sheet \"A\" has less duplicates than sheet \"B\"\n    If oCell.Offset(, -2).Value = \"\" Then\n        Dic2.RemoveAll: z = 1\n        For Each key In Dic\n            If oCell.Value &amp; \"_\" &amp; oCell.Offset(, 3).Value &amp; \"_\" &amp; z = key Then\n                oCell.Offset(, -2).Value = Dic(key)\n            End If\n        Next\n    End If\n    'add to dictionary already passed results for\n    'the next duplicates testing\n    If Not Dic2.exists(oCell.Value &amp; \"_\" &amp; oCell.Offset(, 3).Value &amp; \"_\" &amp; z) Then\n        Dic2.Add oCell.Value &amp; \"_\" &amp; oCell.Offset(, 3).Value &amp; \"_\" &amp; z, \"\"\n    End If\nNext\n</code></pre>\n\n<p>Btw, when I tested your code: </p>\n\n<pre><code>Set w1 = Workbooks(\"book1.xlsm\").Worksheets(1)\n</code></pre>\n\n<p>It gave me an error. Should it be like this? and same for w2</p>\n\n<pre><code>Set w1 = Workbooks.open(FULL_PATH_TO_WORKBOOK).Worksheets(1)\n</code></pre>\n\n<p>where FULL_PATH_TO_WORKBOOK can be obtained by</p>\n\n<pre><code>Thisworkbook.path &amp; Application.PathSeparator &amp; \"book1.xlsm\"\n</code></pre>\n\n<p>if you put the macros in book1</p>\n"}, {"tags": [], "owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1425459577, "creation_date": 1425459577, "answer_id": 28850249, "question_id": 28848860, "link": "https://stackoverflow.com/questions/28848860/excel-vba-macro-to-import-information-from-one-book-to-another/28850249#28850249", "title": "excel vba macro to import information from one book to another", "body": "<p>If new code isn't mandatory you could just rerun this Sub, compare the PO number this time and then delete those rows where the comparison doesn't fit.</p>\n"}], "owner": {"reputation": 79, "user_id": 4595517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33d435e41c9fff5a1348587ecec0d456?s=128&d=identicon&r=PG&f=1", "display_name": "tania", "link": "https://stackoverflow.com/users/4595517/tania"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 158, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1425477302, "creation_date": 1425454497, "last_edit_date": 1425477302, "question_id": 28848860, "link": "https://stackoverflow.com/questions/28848860/excel-vba-macro-to-import-information-from-one-book-to-another", "title": "excel vba macro to import information from one book to another", "body": "<p>I have 2 workbooks book 1 and book 2.</p>\n\n<p>Book 1 has 3 filled columns.</p>\n\n<ol>\n<li>Line number </li>\n<li>Style number  </li>\n<li>PO number</li>\n</ol>\n\n<p><img src=\"https://i.stack.imgur.com/LAdfg.png\" alt=\"enter image description here\"></p>\n\n<p>Book 2 has 2 filled columns.</p>\n\n<ol>\n<li>Style number</li>\n<li>PO number</li>\n</ol>\n\n<p><img src=\"https://i.stack.imgur.com/ZC96W.png\" alt=\"enter image description here\"></p>\n\n<p>At first I was importing the information, band number, from book 1 to book 2, by comparing style number of both books.</p>\n\n<p>When the style number from both books match then the band number from book 1 is imported to book 2.</p>\n\n<p>This is the code:</p>\n\n<pre><code>Sub procedure2()\nDim key As Variant, oCell As Range, i&amp;, z%\n    Dim w1 As Worksheet, w2 As Worksheet\n    Dim Dic As Object: Set Dic = CreateObject(\"Scripting.Dictionary\")\n    Dim Dic2 As Object: Set Dic2 = CreateObject(\"Scripting.Dictionary\")\n\n\n    'source\n    Set w1 = Workbooks(\"book1.xlsm\").Worksheets(1)\n\n    'destination\n    Set w2 = Workbooks(\"book2.xlsm\").Worksheets(1)\n\n    '-------------------------------------------------------------------------\n    'get the last row for w1\n    i = w1.Cells.SpecialCells(xlCellTypeLastCell).Row\n    '-------------------------------------------------------------------------\n    ' fill dictionary with data for searching\n    For Each oCell In w1.Range(\"C2:C\" &amp; i)\n        'row number for duplicates\n        z = 1: While Dic.exists(oCell.Value &amp; \"_\" &amp; z): z = z + 1: Wend\n        'add data with row number to dictionary\n        If Not Dic.exists(oCell.Value &amp; \"_\" &amp; z) Then\n            Dic.Add oCell.Value &amp; \"_\" &amp; z, oCell.Offset(, -2).Value\n        End If\n    Next\n    '-------------------------------------------------------------------------\n    'get the last row for w2\n    i = w2.Cells.SpecialCells(xlCellTypeLastCell).Row\n    '-------------------------------------------------------------------------\n    'fill \"B\" with results\n    For Each oCell In w2.Range(\"D2:D\" &amp; i)\n        'determinate row number for duplicated values\n        z = 1: While Dic2.exists(oCell.Value &amp; \"_\" &amp; z): z = z + 1: Wend\n        'search\n        For Each key In Dic\n            If oCell.Value &amp; \"_\" &amp; z = key Then\n                oCell.Offset(, -2).Value = Dic(key)\n            End If\n        Next\n        'correction of the dictionary in case\n        'when sheet \"A\" has less duplicates than sheet \"B\"\n        If oCell.Offset(, -2).Value = \"\" Then\n            Dic2.RemoveAll: z = 1\n            For Each key In Dic\n                If oCell.Value &amp; \"_\" &amp; z = key Then\n                    oCell.Offset(, -2).Value = Dic(key)\n                End If\n            Next\n        End If\n        'add to dictionary already passed results for\n        'the next duplicates testing\n        If Not Dic2.exists(oCell.Value &amp; \"_\" &amp; z) Then\n            Dic2.Add oCell.Value &amp; \"_\" &amp; z, \"\"\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>It works succesfully. </p>\n\n<p><strong>But now i want to import the information, band number, by comparing both the style number and PO numbers contained in book 1 and book 2.</strong></p>\n\n<p><strong>If style numbers of both books match and PO numbers of both books match then the information, the related band number should be imported.</strong></p>\n\n<p><strong>How do i modify the code in order to do this?</strong></p>\n"}, {"tags": ["windows", "vba", "powershell", "search", "vbscript"], "comments": [{"owner": {"reputation": 17, "user_id": 4136365, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/030dc9df341bcb9924bb8146227bd669?s=128&d=identicon&r=PG&f=1", "display_name": "sau6402", "link": "https://stackoverflow.com/users/4136365/sau6402"}, "reply_to_user": {"reputation": 48375, "user_id": 188331, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/UhYfd.jpg?s=128&g=1", "display_name": "Raptor", "link": "https://stackoverflow.com/users/188331/raptor"}, "edited": false, "score": 0, "creation_date": 1425453439, "post_id": 28848224, "comment_id": 45964943, "body": "I referred to the code mentioned in the link. I used it but it doesnt search for folder inside the path; rest was good"}], "answers": [{"tags": [], "owner": {"reputation": 65411, "user_id": 2861476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a68ff169e2604d79847ef252e7b20ae?s=128&d=identicon&r=PG&f=1", "display_name": "MC ND", "link": "https://stackoverflow.com/users/2861476/mc-nd"}, "is_accepted": false, "score": 0, "last_activity_date": 1425464249, "creation_date": 1425464249, "answer_id": 28851822, "question_id": 28848224, "link": "https://stackoverflow.com/questions/28848224/find-string-inside-files-and-generate-report/28851822#28851822", "title": "Find String inside Files and generate report", "body": "<pre><code>findstr /s /m /l /c:\"searchString\" \"c:\\somewhere\\*\" &gt; outputFile.txt\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 46996, "user_id": 1163423, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/HmDO9.jpg?s=128&g=1", "display_name": "Martin Brandl", "link": "https://stackoverflow.com/users/1163423/martin-brandl"}, "is_accepted": false, "score": 0, "last_activity_date": 1425470688, "creation_date": 1425470688, "answer_id": 28854041, "question_id": 28848224, "link": "https://stackoverflow.com/questions/28848224/find-string-inside-files-and-generate-report/28854041#28854041", "title": "Find String inside Files and generate report", "body": "<p>Here is a powershell solution:</p>\n\n<pre><code>$filePath = \"c:\\\"\n$searchString = \"test\"\n$outputFilePath = \"c:\\searchResults.txt\"\n\nGet-ChildItem $filePath -Recurse | Select-String $searchString | select Path, LineNumber | Out-File $outputFilePath -Force\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 4136365, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/030dc9df341bcb9924bb8146227bd669?s=128&d=identicon&r=PG&f=1", "display_name": "sau6402", "link": "https://stackoverflow.com/users/4136365/sau6402"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1425470688, "creation_date": 1425451803, "last_edit_date": 1495541572, "question_id": 28848224, "link": "https://stackoverflow.com/questions/28848224/find-string-inside-files-and-generate-report", "title": "Find String inside Files and generate report", "body": "<p>I need to search for a particular string in my system.</p>\n\n<p>I will provide a filepath</p>\n\n<p>The program should search a predefined string in that filepath which may contain multiple folders and files with different extension.\nIt should then generate a .txt report with the filenames along with their filepath that contains that string(if possible even line number)</p>\n\n<p>I have found a <a href=\"https://stackoverflow.com/questions/16233278/vb-script-to-find-a-particular-string-in-text-file-and-move-the-text-file-to-ano\">similar article here</a>, but it only searches the defined path with files. It does not recursively go through the folders located inside that path and again search for it.</p>\n"}, {"tags": ["ms-access", "collections", "vba", "copy"], "answers": [{"comments": [{"owner": {"reputation": 460, "user_id": 4209514, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/affabbb0c6c1f041d5acb34a5036648c?s=128&d=identicon&r=PG&f=1", "display_name": "Hemant Sisodia", "link": "https://stackoverflow.com/users/4209514/hemant-sisodia"}, "edited": false, "score": 0, "creation_date": 1425451569, "post_id": 28847707, "comment_id": 45964195, "body": "<code>Dim CTC As CTCDefinitionWrapper          For itemCount = 1 To TotalCollection.count         With TotalCollection.item(itemCount)             If InStr(1, workIDs, .Work_ID) &gt; 0 Then                 Set CTC = New CTCDefinitionWrapper                 Set CTC.branchesCollection = .branchesCollection                 CTC.Work_ID = .Work_ID                 If collWorkIDs Is Nothing Then Set collWorkIDs = New Collection                 collWorkIDs.Add CTC             End If         End With     Next</code>    I tried this, but no success. Could you please let me know how to use Memento in this code?"}, {"owner": {"reputation": 67, "user_id": 4622177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14aa2d93346815689226aa592b356fdb?s=128&d=identicon&r=PG&f=1", "display_name": "David McElhaney", "link": "https://stackoverflow.com/users/4622177/david-mcelhaney"}, "reply_to_user": {"reputation": 460, "user_id": 4209514, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/affabbb0c6c1f041d5acb34a5036648c?s=128&d=identicon&r=PG&f=1", "display_name": "Hemant Sisodia", "link": "https://stackoverflow.com/users/4209514/hemant-sisodia"}, "edited": false, "score": 0, "creation_date": 1425458256, "post_id": 28847707, "comment_id": 45966996, "body": "I don&#39;t think I can say it any better than the guy in the link I gave. When you go to that page, scroll down to where it says &quot;EDIT: Problem Solved:&quot;  His solution is very elegant and succinct."}], "tags": [], "owner": {"reputation": 67, "user_id": 4622177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14aa2d93346815689226aa592b356fdb?s=128&d=identicon&r=PG&f=1", "display_name": "David McElhaney", "link": "https://stackoverflow.com/users/4622177/david-mcelhaney"}, "is_accepted": false, "score": 0, "last_activity_date": 1425449381, "last_edit_date": 1495534183, "creation_date": 1425449381, "answer_id": 28847707, "question_id": 28847541, "link": "https://stackoverflow.com/questions/28847541/creating-readonly-copy-of-a-collection-in-access-vba/28847707#28847707", "title": "Creating readonly copy of a collection in access VBA", "body": "<p>This is a limitation of VB. The elegant solution is to create a \"memento\" class in your item object as mentioned in <a href=\"https://stackoverflow.com/questions/4805475/assignment-of-objects-in-vb6/4805812#4805812\">this great answer</a>.</p>\n\n<p>A simple work around might be this:</p>\n\n<p>Suppose your item class starts with three values Work_ID, Work_Name, Work_Date. Modify your code as follows:</p>\n\n<pre><code>With TotalCollection.item(itemCount)\n    If InStr(1, workIDs, .Work_ID) &gt; 0 Then\n        Set obj = New itemClass\n        obj.Work_ID   = .Work_ID\n        obj.Work_Name = .Work_Name\n        obj.Work_Date = .Work_Date\n        'And so on, for any additional fields.\n        If collWorkIDs Is Nothing Then Set collWorkIDs = New Collection\n        collWorkIDs.Add obj\n    End If\nEnd With\n</code></pre>\n\n<p>Crude, certainly. Effective, hopefully.</p>\n"}], "owner": {"reputation": 460, "user_id": 4209514, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/affabbb0c6c1f041d5acb34a5036648c?s=128&d=identicon&r=PG&f=1", "display_name": "Hemant Sisodia", "link": "https://stackoverflow.com/users/4209514/hemant-sisodia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 186, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594645303, "creation_date": 1425448578, "last_edit_date": 1594645303, "question_id": 28847541, "link": "https://stackoverflow.com/questions/28847541/creating-readonly-copy-of-a-collection-in-access-vba", "title": "Creating readonly copy of a collection in access VBA", "body": "<p>I am new to Access VBA and I am stuck in what I think a \"Language Limitation\". I have a collection of Items and I want to copy some of its items in a new collection depending on the condition and then work on that new collection. But the problem is that if I change or remove anything from that new collection, it gets changed in the previous collection also. But I dont want that to happen as it would be again used as it is in next iteration.</p>\n\n<p>The code which I have used to make the new collection is: </p>\n\n<pre><code>Private Function ReturnSubCollection(TotalCollection As Collection, workIDs As String) As Collection\n    Dim collWorkIDs As Collection\n    Dim itemCount As Integer\n    Dim obj As Object\n    For itemCount = 1 To TotalCollection.count\n        If InStr(1, workIDs, TotalCollection.item(itemCount).Work_ID) &gt; 0 Then\n            Set obj = TotalCollection.item(itemCount)\n            If collWorkIDs Is Nothing Then Set collWorkIDs = New Collection\n            collWorkIDs.Add obj\n        End If\n    Next\n\n    Set ReturnSubCollection = collWorkIDs\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "outlook"], "comments": [{"owner": {"reputation": 735, "user_id": 4619569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEDZ7.jpg?s=128&g=1", "display_name": "nicolaus-hee", "link": "https://stackoverflow.com/users/4619569/nicolaus-hee"}, "edited": false, "score": 0, "creation_date": 1433160274, "post_id": 28847516, "comment_id": 49215990, "body": "Hi @Pepperito, did I solve your problem? If yes, please mark my answer as &quot;accepted&quot; by clicking the check symbol next to it. Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 735, "user_id": 4619569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEDZ7.jpg?s=128&g=1", "display_name": "nicolaus-hee", "link": "https://stackoverflow.com/users/4619569/nicolaus-hee"}, "is_accepted": true, "score": 1, "last_activity_date": 1425450169, "last_edit_date": 1495540694, "creation_date": 1425449729, "answer_id": 28847775, "question_id": 28847516, "link": "https://stackoverflow.com/questions/28847516/how-to-call-vba-code-from-outlook-then-vba-code-from-excel/28847775#28847775", "title": "How to call VBA code from Outlook then VBA code from Excel?", "body": "<h3>Is there a way for me to run the macros automatically (ex: run the macro at 7am, 2pm and 6am)?</h3>\n\n<p>Not built into Excel. You could try a scheduled task in Windows (Accessories --> System Tools --> Task Scheduler) to open the Excel file (include parameters for file path and name). You would need to make Excel run that macro when it is opened (right click sheet, then \"View Code\" to add):</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Call MacroThatYouWantToRun()\nEnd Sub\n</code></pre>\n\n<p>More details --> <a href=\"http://support.microsoft.com/kb/265113\" rel=\"nofollow noreferrer\">http://support.microsoft.com/kb/265113</a></p>\n\n<p>I am not sure this can be just as easliy done in Outlook. Maybe this helps: <a href=\"https://stackoverflow.com/questions/12257985/outlook-vba-run-a-code-every-half-an-hour\">Outlook VBA - Run a code every half an hour</a></p>\n\n<h3>How will I set the emails as \"read\" after the information has been extracted?</h3>\n\n<p>Outlook items apparently have an \".UnRead\" property. Just set it to False for the items that you want to mark read.</p>\n\n<h3>How will I select only \"Unread\" emails to be extracted?</h3>\n\n<p>I'm not an expert but worst case, you can run a loop through all folder items and check that property for every item. If the .UnRead property is set to True, execute your command, i.e. copy some of its properties to Excel.</p>\n\n<p>Also: Ways to run through all items in an Outlook folder have been previously discussed here:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/2272361/can-i-iterate-through-all-outlook-emails-in-a-folder-including-sub-folders\">Can I iterate through all Outlook emails in a folder including sub-folders?</a></li>\n<li><a href=\"https://stackoverflow.com/questions/21556389/iterate-all-email-items-in-a-specific-outlook-folder\">Iterate all email items in a specific Outlook folder</a></li>\n<li><a href=\"https://stackoverflow.com/questions/26004315/outlook-vba-select-messages-in-sub-folder\">outlook vba select messages in sub-folder</a></li>\n</ul>\n\n<h3>How can I connect my outlook macro to my excel macro and run it automatically?</h3>\n\n<p>I don't think that is necessary. You can access one application from the other -- as you did in your example (Outlook --> Excel). If you want to go the other way round (Excel --> Outlook), consider something like:</p>\n\n<pre><code>' This is running in Excel, not Outlook\nDim objOutlook As Object\nSet objOutlook = CreateObject(\"Outlook.Application\")\nWith objOutlook\n    ' Specify the commands you want to run in Outlook\nEnd With\n</code></pre>\n\n<h3>If you want to stick with running the macro from Outlook, try changing your code like this</h3>\n\n<pre><code>' First line in Excel you want the copied data to go\nDim ExcelCount As Integer\nExcelCount = 1\n\nFor i = 1 To myfolder.Items.Count\nSet myitem = myfolder.Items(i)\n   ' Only copy data from unread items\n   If myitem.UnRead = True Then\n      xlobj.Range(\"a\" &amp; ExcelCount).Value = myitem.ReceivedTime\n      xlobj.Range(\"b\" &amp; ExcelCount).Value = myitem.Subject\n      xlobj.Range(\"c\" &amp; ExcelCount).Value = myitem.Importance\n      xlobj.Range(\"d\" &amp; ExcelCount).Value = myitem.SenderName\n\n      ' After copying the information, mark item as read\n      myitem.UnRead = False\n\n      ' Increase Excel line count\n      ExcelCount = ExcelCount + 1\n   End If\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1425475737, "creation_date": 1425475737, "answer_id": 28855702, "question_id": 28847516, "link": "https://stackoverflow.com/questions/28847516/how-to-call-vba-code-from-outlook-then-vba-code-from-excel/28855702#28855702", "title": "How to call VBA code from Outlook then VBA code from Excel?", "body": "<p>You may find the <a href=\"http://support.microsoft.com/kb/201096\" rel=\"nofollow\">How to automate Outlook from another program</a> article helpful. The article provides an overview of programming Outlook using Automation from another program.</p>\n"}], "owner": {"reputation": 9, "user_id": 1736990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a4e58acd1190069ab7a5cc0a433de93?s=128&d=identicon&r=PG", "display_name": "Pepperito", "link": "https://stackoverflow.com/users/1736990/pepperito"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 679, "favorite_count": 0, "accepted_answer_id": 28847775, "answer_count": 2, "score": -2, "last_activity_date": 1427303752, "creation_date": 1425448451, "last_edit_date": 1531164843, "question_id": 28847516, "link": "https://stackoverflow.com/questions/28847516/how-to-call-vba-code-from-outlook-then-vba-code-from-excel", "title": "How to call VBA code from Outlook then VBA code from Excel?", "body": "<p>I have a project that needs both Outlook and Excel connections. What I need is:</p>\n\n<ol>\n<li><p>Extract data of Unread emails from the Outlook Inbox (date received, sender, subject) then paste in Excel. See code below.</p></li>\n<li><p>After data is pasted in Excel, format the extracted data (I already have the code in Excel) then save the Excel file.</p></li>\n<li><p>Mark the emails that were extracted as \"Read\"</p></li>\n</ol>\n\n<p>My Questions are:</p>\n\n<ul>\n<li><p>Is there a way to run the code automatically (ex: run at 7am, 2pm and 6am)?</p></li>\n<li><p>How will I set the emails as \"read\" after the information has been extracted?</p></li>\n<li><p>How will I select only \"Unread\" emails to be extracted?</p></li>\n<li><p>How can I connect my Outlook code to my Excel code and run it automatically?</p></li>\n</ul>\n\n<p>Code in Outlook to extract data:</p>\n\n<pre><code>Sub Extract()\nSet myOlApp = Outlook.Application\nSet mynamespace = myOlApp.GetNamespace(\"mapi\")\nSet myfolder = myOlApp.ActiveExplorer.CurrentFolder\nSet xlobj = CreateObject(\"Excel.Application\")\nxlobj.Visible = True\nxlobj.workbooks.Add\n'Set Heading\nxlobj.Range(\"a\" &amp; 1).Value = \"Received time\"\nxlobj.Range(\"b\" &amp; 1).Value = \"Subject\"\nxlobj.Range(\"c\" &amp; 1).Value = \"Importance\"\nxlobj.Range(\"d\" &amp; 1).Value = \"Sender\"\nFor i = 1 To myfolder.Items.Count\n    Set myitem = myfolder.Items(i)\n    xlobj.Range(\"a\" &amp; i + 1).Value = myitem.ReceivedTime\n    xlobj.Range(\"b\" &amp; i + 1).Value = myitem.Subject\n    xlobj.Range(\"c\" &amp; i + 1).Value = myitem.Importance\n    xlobj.Range(\"d\" &amp; i + 1).Value = myitem.SenderName\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 648, "user_id": 1908806, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0e81053220eb512d279771636eac3911?s=128&d=identicon&r=PG", "display_name": "Sheridan Gray", "link": "https://stackoverflow.com/users/1908806/sheridan-gray"}, "edited": false, "score": 1, "creation_date": 1425447062, "post_id": 28847073, "comment_id": 45962698, "body": "Could you provide an example of the text in Column D?"}, {"owner": {"reputation": 1381, "user_id": 1261845, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/91bd9e6e726a54b1fae1d43e471cbc14?s=128&d=identicon&r=PG", "display_name": "Ben Strombeck", "link": "https://stackoverflow.com/users/1261845/ben-strombeck"}, "edited": false, "score": 0, "creation_date": 1425447919, "post_id": 28847073, "comment_id": 45962914, "body": "I might be missing something, but it seems like the above logic will accomplish absolutely nothing. If you paste over data with exactly what was already there, what are you accomplishing?"}, {"owner": {"reputation": 319, "user_id": 3559552, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/179c203680c4f3b99729ebc0cb29ca6f?s=128&d=identicon&r=PG&f=1", "display_name": "PootyToot", "link": "https://stackoverflow.com/users/3559552/pootytoot"}, "edited": false, "score": 0, "creation_date": 1425448071, "post_id": 28847073, "comment_id": 45962963, "body": "It would help if I gave some context, the data above is actually a mirror of an extract of timesheeting and accrual data from SAP.  If the person does a timesheet (michael jackson), the persons name comes up in the first name / last name column.  However if its an accrual for michael jacksons time, it doesn&#39;t come up as a timesheet entry, rather it comes up in Column D as a free text entry.  Its a disconnect in the way SAP records data as accruals are not considered timesheet entries.  I need to normalize it in order to achieve an automated extract to a financial tool which I am producing."}, {"owner": {"reputation": 1381, "user_id": 1261845, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/91bd9e6e726a54b1fae1d43e471cbc14?s=128&d=identicon&r=PG", "display_name": "Ben Strombeck", "link": "https://stackoverflow.com/users/1261845/ben-strombeck"}, "edited": false, "score": 0, "creation_date": 1425448230, "post_id": 28847073, "comment_id": 45963007, "body": "Ahh, so on that second line, you&#39;re wanting the code to actually put the Michael into Column A, and the Jackson into column B? (But only if the type is Journal)"}, {"owner": {"reputation": 319, "user_id": 3559552, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/179c203680c4f3b99729ebc0cb29ca6f?s=128&d=identicon&r=PG&f=1", "display_name": "PootyToot", "link": "https://stackoverflow.com/users/3559552/pootytoot"}, "edited": false, "score": 0, "creation_date": 1425448290, "post_id": 28847073, "comment_id": 45963023, "body": "Thats it!  It needs to ignore the CATS O/H or any other pointless text aside from teh first name / last name.  It needs to happen with RA (reverse accrual), AC (Accrual) and SS (Journals)"}, {"owner": {"reputation": 1381, "user_id": 1261845, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/91bd9e6e726a54b1fae1d43e471cbc14?s=128&d=identicon&r=PG", "display_name": "Ben Strombeck", "link": "https://stackoverflow.com/users/1261845/ben-strombeck"}, "edited": false, "score": 0, "creation_date": 1425448502, "post_id": 28847073, "comment_id": 45963083, "body": "Alright I&#39;ll see what I can do. This one looks fun"}, {"owner": {"reputation": 648, "user_id": 1908806, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0e81053220eb512d279771636eac3911?s=128&d=identicon&r=PG", "display_name": "Sheridan Gray", "link": "https://stackoverflow.com/users/1908806/sheridan-gray"}, "edited": false, "score": 0, "creation_date": 1425449056, "post_id": 28847073, "comment_id": 45963267, "body": "Is the ONLY text that would be in column D &quot;Michael Jackson&quot;? If so, you could do this with a function and avoid any VBA at all."}], "answers": [{"tags": [], "owner": {"reputation": 648, "user_id": 1908806, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0e81053220eb512d279771636eac3911?s=128&d=identicon&r=PG", "display_name": "Sheridan Gray", "link": "https://stackoverflow.com/users/1908806/sheridan-gray"}, "is_accepted": false, "score": 0, "last_activity_date": 1425448890, "creation_date": 1425448890, "answer_id": 28847607, "question_id": 28847073, "link": "https://stackoverflow.com/questions/28847073/excel-vba-tricky-indexing-logic-to-vba/28847607#28847607", "title": "Excel VBA - Tricky Indexing Logic to VBA", "body": "<p>I don't think I really understand the Text column and I'm not really around a computer with real Excel (Mac Excel sucks) but off the top of my head I'd approach it something like this.</p>\n\n<pre><code>Dim wSheet1 as Worksheet\n\nSub main()\n    Dim i As Long\n\n    Set wSheet1 = Sheets(wSheet1)\n\n    For i = 2 To getLastUsedRow(wSheet1)\n\n        # Requirements #1 and #2\n        If wSheet1.Cells(i, \"A\") = \"\" And wSheet1.Cells(i, \"C\") = \"Journal\" Then\n            processText(i, wSheet1.Range(\"A:A\"))\n        End If\n\n        # Requirement #5\n        If wSheet1.Cells(i, \"B\") = \"\" And wSheet1.Cells(i, \"C\") = \"Journal\" Then\n            processText(i, wSheet1.Range(\"B:B\"))\n        End If\n    Next i\nEnd Sub\n\nSub processText(i as Long, searchCol As Range)\n    Dim words as Variant\n    text = wSheet1.Cells(i, \"D\")\n\n    # Requirement #3\n    words = Split(text, \" \")\n\n    For j = 0 To UBound(words)\n        word = words(i)\n        vTest = Application.VLookup(word, searchCol, 1, False)\n        If IsError(vTest) = False Then\n            # Requirement #4\n            wSheet1.Cells(i, \"A\") = word\n        End If\n    Next j\nEnd Sub\n\nFunction getLastUsedRow(w as Worksheet)\n    getLastUsedRow = w.UsedRange.Rows.Count\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1381, "user_id": 1261845, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/91bd9e6e726a54b1fae1d43e471cbc14?s=128&d=identicon&r=PG", "display_name": "Ben Strombeck", "link": "https://stackoverflow.com/users/1261845/ben-strombeck"}, "edited": false, "score": 0, "creation_date": 1425449874, "post_id": 28847703, "comment_id": 45963563, "body": "this is really close. All you need to do to fix this is change the line of code that says &quot;match_txt = Range(&quot;D&quot; &amp; j).Value&quot; to &quot;match_txt = t&quot; (it&#39;s on there twice)."}, {"owner": {"reputation": 1381, "user_id": 1261845, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/91bd9e6e726a54b1fae1d43e471cbc14?s=128&d=identicon&r=PG", "display_name": "Ben Strombeck", "link": "https://stackoverflow.com/users/1261845/ben-strombeck"}, "edited": false, "score": 0, "creation_date": 1425450192, "post_id": 28847703, "comment_id": 45963707, "body": "Also, the first line of code -- For i = 2 To Range(&quot;A50000&quot;).End(xlUp).Row -- uses column A to determine the last used column, which is probably not reliable. Might be better to use column C, or otherwise just make sure to type something at the very bottom of column A to make sure every row is processed"}, {"owner": {"reputation": 319, "user_id": 3559552, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/179c203680c4f3b99729ebc0cb29ca6f?s=128&d=identicon&r=PG&f=1", "display_name": "PootyToot", "link": "https://stackoverflow.com/users/3559552/pootytoot"}, "edited": false, "score": 0, "creation_date": 1425450331, "post_id": 28847703, "comment_id": 45963757, "body": "This is very very close, it certainly does well, right up until this line here      match_txt = Range(&quot;D&quot; &amp; j).Value  It seems to be not copying the name, rather it copies a piece of text that might be 10 rows down from the target, its confusing as to why.  Trying to work that out on my end."}, {"owner": {"reputation": 1381, "user_id": 1261845, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/91bd9e6e726a54b1fae1d43e471cbc14?s=128&d=identicon&r=PG", "display_name": "Ben Strombeck", "link": "https://stackoverflow.com/users/1261845/ben-strombeck"}, "reply_to_user": {"reputation": 319, "user_id": 3559552, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/179c203680c4f3b99729ebc0cb29ca6f?s=128&d=identicon&r=PG&f=1", "display_name": "PootyToot", "link": "https://stackoverflow.com/users/3559552/pootytoot"}, "edited": false, "score": 1, "creation_date": 1425450421, "post_id": 28847703, "comment_id": 45963785, "body": "@PootyToot, did you get it to work with what I said? It worked for me when I replaced that one line"}], "tags": [], "owner": {"reputation": 664, "user_id": 2977281, "user_type": "registered", "profile_image": "https://graph.facebook.com/561723379/picture?type=large", "display_name": "CustodianOfCode", "link": "https://stackoverflow.com/users/2977281/custodianofcode"}, "is_accepted": true, "score": 2, "last_activity_date": 1425449367, "creation_date": 1425449367, "answer_id": 28847703, "question_id": 28847073, "link": "https://stackoverflow.com/questions/28847073/excel-vba-tricky-indexing-logic-to-vba/28847703#28847703", "title": "Excel VBA - Tricky Indexing Logic to VBA", "body": "<p>Not really sure why you want to do it, but here is vba that implements the logic you have described:</p>\n\n<pre><code>Sub t()\n    For i = 2 To Range(\"A50000\").End(xlUp).Row\n        '1. Look in the Type (C) Column\n        typ = Range(\"C\" &amp; i).Value\n\n        '2. If it encounters text in the type column that says Journal then...\n        If typ = \"Journal\" Then\n\n            '...check the cell located in the same row in the Text (D) column\n            txt = Range(\"D\" &amp; i).Value\n\n            '3. Take the free text in the text column, put it into an array.\n            txtArray = Split(txt, \" \")\n\n            '4. Use the text in the array and scan the First Name column for matching\n            'text entries, if it finds a match then take the matching text in the\n            'Text column and paste it into the First Name column. Do this until the\n            'array runs out.\n\n            For Each t In txtArray\n                For j = 2 To Range(\"A50000\").End(xlUp).Row\n                    If Range(\"A\" &amp; j).Value = t Then\n                        match_txt = Range(\"D\" &amp; j).Value\n                        Range(\"A\" &amp; i).Value = match_txt\n                    End If\n                Next j\n            Next t\n\n            '5. Restart step 4 for the Last Name column\n            'note: i would just do this in the above loop.\n            'split out here so that you can see step 5 seperately from step 4\n            For Each t In txtArray\n                For j = 2 To Range(\"A50000\").End(xlUp).Row\n                    If Range(\"B\" &amp; j).Value = t Then\n                        match_txt = Range(\"D\" &amp; j).Value\n                        Range(\"B\" &amp; i).Value = match_txt\n                    End If\n                Next j\n            Next t\n\n        End If\n\n    '6. loop back to step 1\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 319, "user_id": 3559552, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/179c203680c4f3b99729ebc0cb29ca6f?s=128&d=identicon&r=PG&f=1", "display_name": "PootyToot", "link": "https://stackoverflow.com/users/3559552/pootytoot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "accepted_answer_id": 28847703, "answer_count": 2, "score": 1, "last_activity_date": 1425449367, "creation_date": 1425445923, "last_edit_date": 1592644375, "question_id": 28847073, "link": "https://stackoverflow.com/questions/28847073/excel-vba-tricky-indexing-logic-to-vba", "title": "Excel VBA - Tricky Indexing Logic to VBA", "body": "<p>I have run into an issue with some logic in VBA which I have found in my experience very tricky to figure out, I will attempt to explain it below.</p>\n<p>I have 4 columns in my worksheet, structured as follows</p>\n<pre><code>|    A     |  |    B    |  |  C |  |  D | \n|First Name|  |Last Name|  |Type|  |Text|\n</code></pre>\n<p>I am in search of some VBA which can effectively scan the <strong>First Name</strong> column, once it encounters a blank, it initiates the following logic</p>\n<blockquote>\n<ol>\n<li>Look in the Type (C) Column</li>\n<li>If it encounters text in the type column that says <strong>Journal</strong> then check the cell located in the same row in the <strong>Text (D)</strong> column</li>\n<li>Take the free text in the <strong>text</strong> column, put it into an array.</li>\n<li>Use the text in the array and scan the <strong>First Name</strong> column for matching text entries, if it finds a match then take the matching text in the <strong>Text</strong> column and paste it into the <strong>First Name</strong> column.  Do this until the array runs out.</li>\n<li>Restart step 4 for the <strong>Last Name</strong> column</li>\n<li>Loop back to step 1</li>\n</ol>\n<p>NOTES:  The text in the <strong>Text</strong> column is a free text extract from a third party application (SAP), therefore I am running off the assumption that if it contains a First Name or Last Name, it can match it with the entries already located in the <strong>First Name</strong> and <strong>Last Name</strong> column</p>\n</blockquote>\n<p>I have been looking everywhere for syntax which can do this efficiently but I am stuck with writing the logic for this and need some advice from the community, any ideas?</p>\n<p>UPDATE:\nAn example of the data would be like this</p>\n<pre><code>|     A       |   |      B      |   |     C      |   |     D           |\n| First Name  |   |  Last Name  |   |   Type     |   |   Text          |\n| Michael     |   |  Jackson    |   |    WE      |   |  SAP CATS       |\n\n|             |   |             |   |    SS      |   |  CATS O/H Michael Jackson|\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-word", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1425458732, "post_id": 28846848, "comment_id": 45967248, "body": "wrong syntax, <code>.ScaleHeight</code> is a method, not property"}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": -1, "last_activity_date": 1456967040, "last_edit_date": 1456967040, "creation_date": 1425444618, "answer_id": 28846848, "question_id": 28846799, "link": "https://stackoverflow.com/questions/28846799/adjusting-the-size-of-smartart-nodes-using-vba-for-powerpoint/28846848#28846848", "title": "Adjusting the size of SmartArt nodes using VBA for PowerPoint", "body": "<p>You can change it by scaling it (i think):</p>\n\n<pre><code>ActivePresentation.Slides(i).Shapes(2).SmartArt.AllNodes(j).Shapes.ScaleHeight  1.75, msoFalse, msoScaleFromTopToLeft\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "is_accepted": false, "score": 0, "last_activity_date": 1432237545, "last_edit_date": 1432237545, "creation_date": 1425459049, "answer_id": 28850085, "question_id": 28846799, "link": "https://stackoverflow.com/questions/28846799/adjusting-the-size-of-smartart-nodes-using-vba-for-powerpoint/28850085#28850085", "title": "Adjusting the size of SmartArt nodes using VBA for PowerPoint", "body": "<p>It is not the fully the answer but hope it will be helpful. It seems that you can not change width or height of the node individually. But you can make a node larger or smaller in this way:</p>\n\n<pre><code>'to enlarge\nActivePresentation.Slides(i).Shapes(2).SmartArt.AllNodes(j).Larger\n\n'to make it smaller\nActivePresentation.Slides(i).Shapes(2).SmartArt.AllNodes(j).Smaller\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15, "user_id": 6066661, "user_type": "registered", "profile_image": "https://graph.facebook.com/863179337141662/picture?type=large", "display_name": "Mera Naam Parker", "link": "https://stackoverflow.com/users/6066661/mera-naam-parker"}, "is_accepted": false, "score": 0, "last_activity_date": 1501081528, "creation_date": 1501081528, "answer_id": 45330837, "question_id": 28846799, "link": "https://stackoverflow.com/questions/28846799/adjusting-the-size-of-smartart-nodes-using-vba-for-powerpoint/45330837#45330837", "title": "Adjusting the size of SmartArt nodes using VBA for PowerPoint", "body": "<p>You can use scaling and then use the width property to calculate the scaling factor. Disadvantage of this method is that it impacts the object size. I used convert to shapes to handle it. SmartArts are painful.</p>\n\n<pre><code>    Node.Shapes.ScaleWidth Application.CentimetersToPoints(4.5) / Node.Shapes.Height, msoFalse\n</code></pre>\n\n<p>The above code will scale your width to 4.5 cm.</p>\n"}], "owner": {"reputation": 1, "user_id": 4630459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25c779b546ab3357fd71d685fbd91ede?s=128&d=identicon&r=PG&f=1", "display_name": "Riley O&#39;Donnell", "link": "https://stackoverflow.com/users/4630459/riley-odonnell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2934, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1501081528, "creation_date": 1425444267, "last_edit_date": 1425447854, "question_id": 28846799, "link": "https://stackoverflow.com/questions/28846799/adjusting-the-size-of-smartart-nodes-using-vba-for-powerpoint", "title": "Adjusting the size of SmartArt nodes using VBA for PowerPoint", "body": "<p>I am wondering if there is a way to change the width/height of each individual node of a SmartArt object using VBA in PowerPoint 2010.</p>\n\n<p>I have attempted this using the following code but I end up with an error message:</p>\n\n<pre><code>ActivePresentation.Slides(i).Shapes(2).SmartArt.AllNodes(j).Shapes.Height = 100\n</code></pre>\n\n<p>I found a link to a similar question with Word 2010, and it seems as though the size can not be changed using VBA as the height property is read-only.\n<a href=\"http://www.excelforum.com/word-programming-vba-macros/860581-word-2010-smartart-vba-how-to-change-size.html\" rel=\"nofollow\">http://www.excelforum.com/word-programming-vba-macros/860581-word-2010-smartart-vba-how-to-change-size.html</a></p>\n\n<p>If anyone knows whether or not there is a possible way to do this in VBA, please let me know. Thanks!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 4460442, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/d212ed6e1333a32c85d932241fef5717?s=128&d=identicon&r=PG", "display_name": "Nabil Amer", "link": "https://stackoverflow.com/users/4460442/nabil-amer"}, "edited": false, "score": 0, "creation_date": 1425473670, "post_id": 28849734, "comment_id": 45976022, "body": "the same issue happened, the result of the first cell comes but not moving to the other cells in the same range. it read only from the first range A1 and stopped while there are other &quot;al&quot; in other cells"}, {"owner": {"reputation": 45, "user_id": 4460442, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/d212ed6e1333a32c85d932241fef5717?s=128&d=identicon&r=PG", "display_name": "Nabil Amer", "link": "https://stackoverflow.com/users/4460442/nabil-amer"}, "edited": false, "score": 1, "creation_date": 1425569158, "post_id": 28849734, "comment_id": 46024222, "body": "I really appreciate it. you give the exact thing that i want to do. best regards and hope you all the best my friend"}], "tags": [], "owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "is_accepted": false, "score": 1, "last_activity_date": 1425476855, "last_edit_date": 1425476855, "creation_date": 1425457739, "answer_id": 28849734, "question_id": 28846488, "link": "https://stackoverflow.com/questions/28846488/loop-single-row-to-get-result-based-on-if-function/28849734#28849734", "title": "Loop single row to get result based on if function", "body": "<p>You'll need to make the column a variable.<br>\nIf I got your point you might want to use <em>Select Case</em> instead of <em>If</em>.</p>\n\n<pre><code>Dim cng As Range Dim rng As Range\n\nSet rng = Range(\"A1:E1\")\n\nFor Each cng In rng\nIf Cells(1, rng.Column) = \"al\"\nThen Cells(2,rng.Column) = 8 Else Cells(2, rng.Column) = 0\nEnd If\nNext cng\nEnd Sub\n</code></pre>\n\n<p>UPDATE:<br>\nMessed up the cng-rng distinction.</p>\n\n<pre><code>Sub ert()\nDim cng As Range, rng As Range\nSet rng = Range(\"A1:E1\")\nFor Each cng In rng\n    If Cells(1, cng.Column) = \"al\" Then\n        Cells(2, cng.Column) = 8\n    Else\n        Cells(2, cng.Column) = 0\n    End If\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 4460442, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/d212ed6e1333a32c85d932241fef5717?s=128&d=identicon&r=PG", "display_name": "Nabil Amer", "link": "https://stackoverflow.com/users/4460442/nabil-amer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1425583723, "creation_date": 1425441940, "last_edit_date": 1531164843, "question_id": 28846488, "link": "https://stackoverflow.com/questions/28846488/loop-single-row-to-get-result-based-on-if-function", "title": "Loop single row to get result based on if function", "body": "<p>I am trying to do if function for each cell in one row using loop with function. To explain better, here is what I want to do:</p>\n\n<pre><code>     A      b       C       D       E\n1    al     sl      al      HD      al\n\n2 \n</code></pre>\n\n<p>I have the above excel cells in which i want to say in my code in cell <code>A2</code> </p>\n\n<pre><code>Dim cng As Range\nDim rng As Range\n\nSet rng = Range(\"A1:E1\")\n\n   For Each cng In rng\n     If Cells(1, 1) = \"al\" Then\n       Cells(2,1) = 8\n        Else\n        Cells(2, 1) = 0\n        End If\n        Next cng\nend sub\n</code></pre>\n\n<p>Here I want the code to do the same for <code>B2</code>, <code>C2</code>, <code>D2</code> and <code>E2</code> as well.\nThank you very much in advance for your help</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1425443724, "post_id": 28846177, "comment_id": 45961826, "body": "Create a scripting dictionary object (eg. &quot;dict&quot;) and loop over the sheets, and over the rows in each sheet, concatenating the values in columns A, B and C for each row into a &quot;key&quot; (e.g. by joining with a Chr(0)/vbNull character.  For each of these, check  <code>dict.Exists(theKey)</code> and add it if not found.  Finally dump all of the keys from the dictionary onto your summary sheet."}], "owner": {"reputation": 11, "user_id": 4630313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a585997425c76236792c6a5fce7a57a?s=128&d=identicon&r=PG&f=1", "display_name": "Biomechman", "link": "https://stackoverflow.com/users/4630313/biomechman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1425439577, "creation_date": 1425439577, "last_edit_date": 1531161705, "question_id": 28846177, "link": "https://stackoverflow.com/questions/28846177/excel-generating-unique-values-across-multiple", "title": "Excel Generating Unique Values Across Multiple", "body": "<p>I am working on a project that will ultimately have over 100 sheets within the same workbook and am trying to figure out a method to generate a unique list of values across all of the sheets into another sheet.It is preferred I maintain all of the sheets so the data will be much easier to organize in the future.</p>\n\n<p>The row count fluctuates from sheet to sheet while the type of text strings and the order of the columns remains the same. For example, on sheet 1 column A has the text 'red', column 2 has the text 'visual/foveal/target' and column C has 'Nontarget3'. Then in A45 and B45 the text strings are the same as A1:B1 but C1 is now 'Nontarget16' </p>\n\n<p>The same variation can be possible with the different entry being column B instead of the Col A and C (which now have the same entries). In summary, I am interested in generating a list of all unique groups of cells within adjacent columns for all the rows in each sheet and throughout the workbook. Does the StackOverflow community recommend any courses of action I can explore to try and figure this out? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 3, "creation_date": 1425437253, "post_id": 28845804, "comment_id": 45960287, "body": "You&#39;ve not told us what your code is supposed to do or in what way it&#39;s <i>not working</i>. How specifically would you like us to help you? We can&#39;t read your mind or see your screen. Please <a href=\"https://stackoverflow.com/posts/28845804/edit\">edit</a> your question to make it clear what you&#39;re asking, and ask a specific question that we can answer (other than &quot;Why isn&#39;t this working?&quot;)."}, {"owner": {"reputation": 12054, "user_id": 3614835, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/xzZDV.png?s=128&g=1", "display_name": "Jeffrey Bosboom", "link": "https://stackoverflow.com/users/3614835/jeffrey-bosboom"}, "edited": false, "score": 1, "creation_date": 1425437256, "post_id": 28845804, "comment_id": 45960288, "body": "You&#39;re more likely to get useful help if you tell us what behavior you currently get and what you expect."}, {"owner": {"reputation": 714, "user_id": 4487534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4c492024c03f7acac02476850ef9818?s=128&d=identicon&r=PG&f=1", "display_name": "Pillgram", "link": "https://stackoverflow.com/users/4487534/pillgram"}, "edited": false, "score": 0, "creation_date": 1425437379, "post_id": 28845804, "comment_id": 45960323, "body": "Hi AF786. Welcome to SO. Thank you for taking the time to post the code. It would be helpful to understand what the code is intended to do, and what it is actually doing that you did not expect."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4526619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7755432e9ea3b74e9ff63921756932d9?s=128&d=identicon&r=PG&f=1", "display_name": "AF786", "link": "https://stackoverflow.com/users/4526619/af786"}, "edited": false, "score": 0, "creation_date": 1425605005, "post_id": 28845930, "comment_id": 46042716, "body": "Hi Dan, thanks for your response. The method i use also works and so does yours. I am not sure if there are specific moments where only yours would work but i am sure mine works for now."}, {"owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "edited": false, "score": 0, "creation_date": 1425605414, "post_id": 28845930, "comment_id": 46042828, "body": "Both Sheet6.blah blah and Sheets(&quot;Sheet6&quot;).Blah Blah are valid. Check out <a href=\"http://www.ozgrid.com/VBA/excel-vba-sheet-names.htm\" rel=\"nofollow noreferrer\">ozgrid.com/VBA/excel-vba-sheet-names.htm</a> and <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837552.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/&hellip;</a>"}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": -2, "last_activity_date": 1425437997, "creation_date": 1425437997, "answer_id": 28845930, "question_id": 28845804, "link": "https://stackoverflow.com/questions/28845804/why-isnt-my-vba-code-working-on-excel/28845930#28845930", "title": "Why isnt my VBA code working on excel?", "body": "<p>You Have put the sheets in as Sheet6.blah blah when it should be Sheets(\"Sheet6\").Blah Blah</p>\n\n<p>I have made a few streamlines to your code for you, try this:</p>\n\n<pre><code>Sub AddMN()\n\n'declare the variables\n\nDim MNFX As String\nDim MNDO As String\nDim FXDO As String\nDim OPT As String\nDim i As Integer\nDim lastEmpty As Integer\n\nFXDO = Sheets(\"Sheet3\").Range(\"F3\")\nOPT = Sheets(\"Sheet3\").Range(\"H3\")\nSheets(\"Sheet6\").Activate\nlastEmpty = Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\nIf FXDO = \"FIXED\" And OPT = \"YES\" Then\n   Sheets(\"Sheet5\").Range(\"MNFX\").Copy\n   Cells(lastEmpty, 1).PasteSpecial xlPasteAll\nElseIf FXDO = \"DRAWOUT\" And OPT = \"YES\" Then\n   Sheets(\"Sheet5\").Range(\"MNDO\").Copy\n   Cells(lastEmpty, 1).PasteSpecial xlPasteAll\nEnd If\n\nWith Sheets(\"Sheet6\").Columns\n   .WrapText = False\n   .AutoFit\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 4526619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7755432e9ea3b74e9ff63921756932d9?s=128&d=identicon&r=PG&f=1", "display_name": "AF786", "link": "https://stackoverflow.com/users/4526619/af786"}, "edited": false, "score": 0, "creation_date": 1425605142, "post_id": 28846104, "comment_id": 46042751, "body": "Hi Fumu. Thanks for your response. Your method works too but so does mine. I am grateful for your response"}, {"owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "edited": false, "score": 0, "creation_date": 1425607803, "post_id": 28846104, "comment_id": 46043551, "body": "Should be <code>If IsEmpty(Cells(i, 1)) Then</code>"}], "tags": [], "owner": {"reputation": 1011, "user_id": 3770161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42f161c5406dcf4b139b8ffdcace6ed3?s=128&d=identicon&r=PG&f=1", "display_name": "Fumu 7", "link": "https://stackoverflow.com/users/3770161/fumu-7"}, "is_accepted": false, "score": -1, "last_activity_date": 1425439095, "creation_date": 1425439095, "answer_id": 28846104, "question_id": 28845804, "link": "https://stackoverflow.com/questions/28845804/why-isnt-my-vba-code-working-on-excel/28846104#28846104", "title": "Why isnt my VBA code working on excel?", "body": "<p>Your usage of 'IsEmpty' function is wrong.</p>\n\n<p>IsEmpty checks a Variant-type variable is initialized or not, so argumet of 'IsEmpty' should be a Variant.</p>\n\n<p>In your code, argumet of 'IsEmpty' is (Cells(i, 1).Value). That is not a variant, so IsEmpty returns 'FALSE' anytime.</p>\n\n<p>As the result, the variable 'lastEmpty' is 0 (initial value).  This is the problem of your code, I guess.</p>\n\n<p>To fix this problem, following part of your code</p>\n\n<pre><code>For i = 2 To 1000\n    If IsEmpty(Cells(i, 1).Value) Then\n        lastEmpty = i\n        Exit For\n    End If\nNext i\n</code></pre>\n\n<p>should be corrected as</p>\n\n<pre><code>For i = 2 To 1000\n    If Cells(i, 1).Value = \"\" Then\n        lastEmpty = i\n        Exit For\n    End If\nNext i\n</code></pre>\n\n<p>This correction makes your code works, I hope.</p>\n"}], "owner": {"reputation": 1, "user_id": 4526619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7755432e9ea3b74e9ff63921756932d9?s=128&d=identicon&r=PG&f=1", "display_name": "AF786", "link": "https://stackoverflow.com/users/4526619/af786"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 408, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1425604857, "creation_date": 1425437007, "last_edit_date": 1425437239, "question_id": 28845804, "link": "https://stackoverflow.com/questions/28845804/why-isnt-my-vba-code-working-on-excel", "title": "Why isnt my VBA code working on excel?", "body": "<p>I am at my wits end with this. I am pretty sure my logic is correct and i have defined everything properly and followed the syntax. Also, there is no error showing up for this chunk of code. Please please please take a look at it and let me know why it is not working. I just started to learn this and i am really looking for help.</p>\n\n<pre><code>Sub AddMN()\n\n'declare the variables\n\n    Dim MNFX As String\n    Dim MNDO As String\n    Dim FXDO As String\n    Dim OPT As String\n    Dim i As Integer\n    Dim lastEmpty As Integer\n\n    FXDO = Sheet3.Range(\"F3\")\n    OPT = Sheet3.Range(\"H3\")\n\n\n    Sheet6.Activate\n\n    For i = 2 To 1000\n        If IsEmpty(Cells(i, 1).Value) Then\n            lastEmpty = i\n            Exit For\n        End If\n    Next i\n\n    If FXDO = \"FIXED\" And OPT = \"YES\" Then\n\n       Cells(lastEmpty, 1).Select\n       Sheet5.Range(\"MNFX\").Copy\n       ActiveCell.PasteSpecial xlPasteAll\n\n    ElseIf FXDO = \"DRAWOUT\" And OPT = \"YES\" Then\n\n       Cells(lastEmpty, 1).Select\n       Sheet5.Range(\"MNDO\").Copy\n       ActiveCell.PasteSpecial xlPasteAll\n\n    End If\n\n    With Sheet6.Columns\n       .WrapText = False\n       .AutoFit\n    End With\n\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2007"], "comments": [{"owner": {"reputation": 714, "user_id": 4487534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4c492024c03f7acac02476850ef9818?s=128&d=identicon&r=PG&f=1", "display_name": "Pillgram", "link": "https://stackoverflow.com/users/4487534/pillgram"}, "edited": false, "score": 0, "creation_date": 1425437593, "post_id": 28845656, "comment_id": 45960390, "body": "Hi Manivannan, I assume you already know this, but in case you didn&#39;t, the VLOOKUP formula would do this job as well. If you need to do this programatically, you can call VLOOKUP with Excel.Application.WorksheetFunction.VLookup method and you don&#39;t have to rewrite the lookup function:)"}, {"owner": {"reputation": 351, "user_id": 3597166, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5046ab7628deca9e3bf1b9f780a7b192?s=128&d=identicon&r=PG&f=1", "display_name": "Manivannan KG", "link": "https://stackoverflow.com/users/3597166/manivannan-kg"}, "reply_to_user": {"reputation": 714, "user_id": 4487534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4c492024c03f7acac02476850ef9818?s=128&d=identicon&r=PG&f=1", "display_name": "Pillgram", "link": "https://stackoverflow.com/users/4487534/pillgram"}, "edited": false, "score": 1, "creation_date": 1425437793, "post_id": 28845656, "comment_id": 45960431, "body": "I need a professional VBA code. Vlookup is heavy weight component which will write the formula to every single cell we perform the action. Thank you for your answers."}], "answers": [{"comments": [{"owner": {"reputation": 351, "user_id": 3597166, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5046ab7628deca9e3bf1b9f780a7b192?s=128&d=identicon&r=PG&f=1", "display_name": "Manivannan KG", "link": "https://stackoverflow.com/users/3597166/manivannan-kg"}, "edited": false, "score": 1, "creation_date": 1425437270, "post_id": 28845740, "comment_id": 45960293, "body": "Simple words,But worth it. You&#39;re a star. Thank you so much. The function  FindRangeOfText returns as range. Absloutely working!!!"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 2, "last_activity_date": 1425436523, "creation_date": 1425436523, "answer_id": 28845740, "question_id": 28845656, "link": "https://stackoverflow.com/questions/28845656/vba-get-values-with-known-cell-address/28845740#28845740", "title": "VBA-get values with known cell address", "body": "<p>Assuming that the functions you refer to (but did not provide the code to support) will return <code>Range</code> type object (or <code>Nothing</code>), then you can simply use the <code>Offset</code> method:</p>\n\n<pre><code>If Not rngRatio Is Nothing Then\n    With rngRatio\n        Debug.Print .Offset(0,1).Address, .Offset(0,1).Value '$C$57\n        Debug.Print .Offset(0,2).Address, .Offset(0,2).Value '$D$57\n    End With\nEnd If\n</code></pre>\n\n<p>There is also a lesser-known way to do the same thing:</p>\n\n<pre><code>If Not rngRatio Is Nothing Then\n    With rngRatio\n        Debug.Print .Cells(1, 2).Value \n        Debug.Print .Cells(1, 3).Value\n    End With\nEnd With\n</code></pre>\n\n<p>My preference is for the first method, because it is explicit rather than implicit. This method is less clear, because not everyone knows intuitively that you can reference a cell <em>outside</em> of a range object, using the <code>Cells</code> property, such as:</p>\n\n<pre><code>MsgBox Range(\"A1\").Cells(1, 4).Address ' --&gt; $E$1\n\nMsgBox Range(\"A1\").Cells(4, 2).Address ' --&gt; $B$4\n</code></pre>\n"}], "owner": {"reputation": 351, "user_id": 3597166, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5046ab7628deca9e3bf1b9f780a7b192?s=128&d=identicon&r=PG&f=1", "display_name": "Manivannan KG", "link": "https://stackoverflow.com/users/3597166/manivannan-kg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 839, "favorite_count": 0, "accepted_answer_id": 28845740, "answer_count": 1, "score": 0, "last_activity_date": 1425436523, "creation_date": 1425435889, "last_edit_date": 1531164843, "question_id": 28845656, "link": "https://stackoverflow.com/questions/28845656/vba-get-values-with-known-cell-address", "title": "VBA-get values with known cell address", "body": "<p>I am trying to achive the values of a row holding specific text. Say Liquidity Coverage Ratio is the text that is available in B57. I need the value of C57 and D57. I have achieved until retreiving the address of the cell holding text.</p>\n\n<p>Kindly help me progressing further.</p>\n\n<blockquote>\n<pre><code> If fCheckSheet(forecastWorkbook, \"Calculator (FX net)\") Then\n            wsForecast.Activate\n        Else\n            ErrorStatus = \"Source Sheet:Calculator (FX net) not found\"\n            msgBoxReturn = MsgBox(ErrorStatus &amp; forecastWorkbook.FullName, vbExclamation + vbOKCancel)\n     End If\n\n     Set rngRatio = FindRangeOfText(wsForecast, \"Liquidity Coverage Ratio\")\n     'Gets the address of cell having\n     RatioAddress = rngRatio.Address\n\n     'The address is $B$57\n       '???? how to retreive values for $c$57 and $D$57\n</code></pre>\n</blockquote>\n\n<p>I really appreciate the response from stackoverflow users who made me grow from novice until this level. Thanks for your patience.</p>\n\n<p>Regards,</p>\n\n<p>Mani</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4629943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd8428c4b72c66e6b70de3cb8820a457?s=128&d=identicon&r=PG&f=1", "display_name": "NetDVL466", "link": "https://stackoverflow.com/users/4629943/netdvl466"}, "edited": false, "score": 0, "creation_date": 1426632211, "post_id": 28930325, "comment_id": 46451420, "body": "Thanks for your solution StevenMpls, however, it did not solve my problem. Bookmarks stay highlighted. Any other suggestions?"}, {"owner": {"reputation": 1, "user_id": 4629943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd8428c4b72c66e6b70de3cb8820a457?s=128&d=identicon&r=PG&f=1", "display_name": "NetDVL466", "link": "https://stackoverflow.com/users/4629943/netdvl466"}, "edited": false, "score": 0, "creation_date": 1426716443, "post_id": 28930325, "comment_id": 46492895, "body": "I found the setting for my issue. Apparently, additionally to all the different described highlighting functions for formfields there is another. It is accessible via the Developers tab on the ribbon and is placed within the controls section. By clicking the &quot;legacy tools&quot; icon one can activate/deactive the FormField shading."}, {"owner": {"reputation": 499, "user_id": 3662287, "user_type": "registered", "accept_rate": 48, "profile_image": "https://graph.facebook.com/518096139/picture?type=large", "display_name": "Steve", "link": "https://stackoverflow.com/users/3662287/steve"}, "reply_to_user": {"reputation": 1, "user_id": 4629943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd8428c4b72c66e6b70de3cb8820a457?s=128&d=identicon&r=PG&f=1", "display_name": "NetDVL466", "link": "https://stackoverflow.com/users/4629943/netdvl466"}, "edited": false, "score": 0, "creation_date": 1426721883, "post_id": 28930325, "comment_id": 46494782, "body": "Good to hear, makes sense now that you mention it."}], "tags": [], "owner": {"reputation": 499, "user_id": 3662287, "user_type": "registered", "accept_rate": 48, "profile_image": "https://graph.facebook.com/518096139/picture?type=large", "display_name": "Steve", "link": "https://stackoverflow.com/users/3662287/steve"}, "is_accepted": false, "score": 0, "last_activity_date": 1425839837, "creation_date": 1425839837, "answer_id": 28930325, "question_id": 28844332, "link": "https://stackoverflow.com/questions/28844332/word-vba-bookmark-highlight-unremovable/28930325#28930325", "title": "Word: VBA Bookmark highlight unremovable", "body": "<p>It sounds like what you are describing is how shaded fields (with bookmarks) look in Word. You cannot really change their appearance other than to turn on or off field shading and view or not view bookmarks. This is an attribute set up in Word options and presumably a setting saved per user. You get to these options by File/Options/Advanced/Show Document Content/</p>\n\n<p><img src=\"https://i.stack.imgur.com/vvGG7.png\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 1, "user_id": 4629943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd8428c4b72c66e6b70de3cb8820a457?s=128&d=identicon&r=PG&f=1", "display_name": "NetDVL466", "link": "https://stackoverflow.com/users/4629943/netdvl466"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 586, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1425839837, "creation_date": 1425426959, "last_edit_date": 1425432466, "question_id": 28844332, "link": "https://stackoverflow.com/questions/28844332/word-vba-bookmark-highlight-unremovable", "title": "Word: VBA Bookmark highlight unremovable", "body": "<p>I have a couple of Bookmarks in a template that I was provided. These Bookmarks are highlighted grey and I can't remove this highlight/shadow.</p>\n\n<p>What I have tried so far is:</p>\n\n<pre><code>ActiveDocument.FormFields(strBookmark).Range.HighlightColorIndex = wdNoHighlight\nActiveDocument.FormFields(strBookmark)..Highlight = False\n</code></pre>\n\n<p>and some other things (search results also at StackOverflow).</p>\n\n<p>Only applying another highlight can cover it up. I can't find the function within Word which controls highlighting of bookmarks.</p>\n\n<p>Unfortunately, there is a part in that template that has a grey background. Hence, a white highlighted TextBox does not really look awesome.</p>\n\n<p>I hope there is someone who is familiar with this bookmark issue and can help me out.</p>\n"}, {"tags": ["sql", "vba", "excel", "csv", "import-from-csv"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1864610"}, "edited": false, "score": 0, "creation_date": 1425426858, "post_id": 28844268, "comment_id": 45957493, "body": "Modify the VBA code so that it doesn&#39;t drop the first row, surely."}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 1, "creation_date": 1425426992, "post_id": 28844268, "comment_id": 45957537, "body": "Have you tried <code>HDR=NO</code> in the extended properties of the connection string?"}, {"owner": {"reputation": 111, "user_id": 4629993, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153082965096469/picture?type=large", "display_name": "Keith Whatling", "link": "https://stackoverflow.com/users/4629993/keith-whatling"}, "edited": false, "score": 0, "creation_date": 1425429107, "post_id": 28844268, "comment_id": 45958165, "body": "thanks hobo but its seems not that simple."}, {"owner": {"reputation": 111, "user_id": 4629993, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153082965096469/picture?type=large", "display_name": "Keith Whatling", "link": "https://stackoverflow.com/users/4629993/keith-whatling"}, "edited": false, "score": 0, "creation_date": 1425429123, "post_id": 28844268, "comment_id": 45958171, "body": "I have tried HDR= NO but now I&#39;m getting a EOF/BOF error, I get EOF = true and I can&#39;t pull the record sets."}, {"owner": {"reputation": 111, "user_id": 4629993, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153082965096469/picture?type=large", "display_name": "Keith Whatling", "link": "https://stackoverflow.com/users/4629993/keith-whatling"}, "edited": false, "score": 0, "creation_date": 1425430249, "post_id": 28844268, "comment_id": 45958505, "body": "Have sorted it, just a silly error. thanks to Barrowc, I&#39;m not great at SQL, should really brush up on it."}, {"owner": {"reputation": 6983, "user_id": 274350, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6680544d5ca7c1a0ea3eaba1f3c438f7?s=128&d=identicon&r=PG", "display_name": "Richard Neish", "link": "https://stackoverflow.com/users/274350/richard-neish"}, "reply_to_user": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 1, "creation_date": 1425555368, "post_id": 28844268, "comment_id": 46015744, "body": "Hi @barrowc I think your comment should be an answer."}], "answers": [{"tags": [], "owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "is_accepted": true, "score": 1, "last_activity_date": 1425595007, "creation_date": 1425595007, "answer_id": 28889165, "question_id": 28844268, "link": "https://stackoverflow.com/questions/28844268/importing-a-csv-file-that-has-no-headers-via-ado-into-vba/28889165#28889165", "title": "Importing a CSV file that has no headers via ADO into VBA", "body": "<p>Putting <code>HDR=NO</code> in the extended properties of the connection string should fix that error</p>\n"}], "owner": {"reputation": 111, "user_id": 4629993, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153082965096469/picture?type=large", "display_name": "Keith Whatling", "link": "https://stackoverflow.com/users/4629993/keith-whatling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 457, "favorite_count": 0, "accepted_answer_id": 28889165, "answer_count": 1, "score": 2, "last_activity_date": 1425595007, "creation_date": 1425426568, "last_edit_date": 1425427036, "question_id": 28844268, "link": "https://stackoverflow.com/questions/28844268/importing-a-csv-file-that-has-no-headers-via-ado-into-vba", "title": "Importing a CSV file that has no headers via ADO into VBA", "body": "<p>I have an old COBOL system that spits out Simple CSV files. These files have no headers. i.e. all lines in the CSV are data/record sets.</p>\n\n<p>I have the code to import the CSV file into VBA and pop it into an array. All works well but I lose the first line of data because it thinks it is a header row.</p>\n\n<p>the SQL string I am using is SELECT * FROM Data.CSV</p>\n\n<p>Shall I just pull the fields and script a work around or is there a more elegant solution.</p>\n\n<p>thanks in advance for reading this post.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1425424077, "post_id": 28843593, "comment_id": 45956433, "body": "What line has an error/highlights?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1425427696, "post_id": 28843593, "comment_id": 45957748, "body": "<a href=\"http://stackoverflow.com/questions/27411399/microsoft-excel-activex-controls-disabled\" title=\"microsoft excel activex controls disabled\">stackoverflow.com/questions/27411399/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 2, "last_activity_date": 1425433546, "creation_date": 1425433546, "answer_id": 28845329, "question_id": 28843593, "link": "https://stackoverflow.com/questions/28843593/button-visible-false-not-working-in-vba/28845329#28845329", "title": "Button.Visible=False not working in VBA", "body": "<p>Not the answer to your particular problem, but since <code>Visible</code> is a Boolean property your code can be reduced: </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Rage.Visible = (Cells(1, 12).Value = \"Barbarian\") \n\n    Brutality.Visible = (Cells(1, 12).Value = \"Barbarian\" And _\n                   WorksheetFunction.CountIf( _\n                   Cells(40, 1).Resize(22,1), \"Raging Brutality\") &gt; 0)\n\n    Sneak.Visible = (Cells(1, 12).Value = \"Rogue\")\n\n    If Not Sneak.Visible Then Cells(25, 7).Value = 0\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1425472471, "post_id": 28850455, "comment_id": 45975292, "body": "<a href=\"https://drive.google.com/file/d/0B-773Ttgo1z6OTM5TGYzOXhONTQ/view?usp=sharing\" rel=\"nofollow noreferrer\">see my example file</a>"}], "tags": [], "owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "is_accepted": false, "score": 0, "last_activity_date": 1425471126, "last_edit_date": 1495542037, "creation_date": 1425460249, "answer_id": 28850455, "question_id": 28843593, "link": "https://stackoverflow.com/questions/28843593/button-visible-false-not-working-in-vba/28850455#28850455", "title": "Button.Visible=False not working in VBA", "body": "<p>You either want to start by defining your objects</p>\n\n<pre><code>Rage = ActiveSheet.Shapes(\"Rage\")\n</code></pre>\n\n<p>or refer to them by their accepted format, e.g.</p>\n\n<pre><code>ActiveSheet.Shapes(\"Rage\").Visible = False\n</code></pre>\n\n<p>.<br>\nUsing <a href=\"https://stackoverflow.com/users/478884/tim-williams\">Tim Williams'</a> snipplet your code will look like:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    ActiveSheet.Shapes(\"Rage\").Visible = (Cells(1, 12).Value = \"Barbarian\") \n\n    ActiveSheet.Shapes(\"Brutality\").Visible = (Cells(1, 12).Value = \"Barbarian\" And _\n                   WorksheetFunction.CountIf( _\n                   Cells(40, 1).Resize(22,1), \"Raging Brutality\") &gt; 0)\n\n    ActiveSheet.Shapes(\"Sneak\").Visible = (Cells(1, 12).Value = \"Rogue\")\n\n    If Not ActiveSheet.Shapes(\"Sneak\").Visible Then Cells(25, 7).Value = 0\n\nEnd Sub\n</code></pre>\n\n<p>Make sure your objects are named <em>Rage</em>, <em>Brutality</em> and <em>Sneak</em> by checking the <a href=\"http://docs.oracle.com/cd/E23943_01/bi.1111/e22254/img/xdo11g_excel_nameboxa.gif\" rel=\"nofollow noreferrer\">name box</a> after selecting them.</p>\n\n<p>UPDATE:\nI made an even more clear and concise sub.<br>\nSeems like you can't rename the buttons, just look at their names and replace with <em>Ctrl+H</em>, for each of the names(Rage, Brutality, Sneak).  </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nActiveSheet.Shapes(\"Rage\").Visible = False 'let's make all invisible before evaluation\nActiveSheet.Shapes(\"Brutality\").Visible = False\nActiveSheet.Shapes(\"Sneak\").Visible = False\n\nSelect Case Cells(1, 12).Value\nCase \"Barbarian\"\n    ActiveSheet.Shapes(\"Rage\").Visible = True\n    If WorksheetFunction.CountIf(Range(Cells(40, 1), Cells(61, 1)), \"Raging Brutality\") Then\n    ActiveSheet.Shapes(\"Brutality\").Visible = True\n    End If\nCase \"Rogue\"\n    ActiveSheet.Shapes(\"Sneak\").Visible = True\nCase Else\n    Cells(25, 7).Value = 0\nEnd Select\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 4629868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/493f4251e37707bfe56b7ce3e929ff27?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/4629868/nathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1871, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1425471126, "creation_date": 1425423243, "last_edit_date": 1425424036, "question_id": 28843593, "link": "https://stackoverflow.com/questions/28843593/button-visible-false-not-working-in-vba", "title": "Button.Visible=False not working in VBA", "body": "<p>I have a macro enabled workbook, and in the past it has always worked fine, but ever since I had a windows update the macro has caused the workbook to crash, giving me an error of \"Run-time error '424': Object Required.\" I cant seem to figure out why my code in no longer working. Here is my code. </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n     'Rage Button\n    If Cells(1, 12).Value = \"Barbarian\" Then 'CHANGE THE CELL TO THE ADRESS OF THE TRIGGER CELL\n        Rage.Visible = True 'CHANGE TO THE NAME OF THE BUTTON\n    Else\n        Rage.Visible = False 'CHANGE TO THE NAME OF THE BUTTON\n    End If\n\n'Raging Brutality\n    If Cells(1, 12).Value = \"Barbarian\" Then\n        If WorksheetFunction.CountIf(Range(Cells(40, 1), Cells(61, 1)), \"Raging Brutality\") Then\n        Brutality.Visible = True\n        Else\n        Brutality.Visible = False\n        End If\n    Else\n        Brutality.Visible = False\n    End If\n     'Sneak Button\n    If Cells(1, 12).Value = \"Rogue\" Then 'CHANGE THE CELL TO THE ADRESS OF THE TRIGGER CELL\n        Sneak.Visible = True 'CHANGE TO THE NAME OF THE BUTTON\n    Else\n        Sneak.Visible = False 'CHANGE TO THE NAME OF THE BUTTON\n        Cells(25, 7).Value = 0\n    End If\n     End Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "sharepoint-2010", "export-to-excel"], "comments": [{"owner": {"reputation": 12772, "user_id": 490374, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8c174feb69caed3f5ba5fd68d9ab3c63?s=128&d=identicon&r=PG", "display_name": "Ann L.", "link": "https://stackoverflow.com/users/490374/ann-l"}, "edited": false, "score": 0, "creation_date": 1425422172, "post_id": 28843316, "comment_id": 45955609, "body": "So you want to export from Access to Excel, and have it &quot;Save with formats&quot; automatically?  Is that it?"}, {"owner": {"reputation": 12772, "user_id": 490374, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8c174feb69caed3f5ba5fd68d9ab3c63?s=128&d=identicon&r=PG", "display_name": "Ann L.", "link": "https://stackoverflow.com/users/490374/ann-l"}, "edited": false, "score": 0, "creation_date": 1425422314, "post_id": 28843316, "comment_id": 45955676, "body": "Wouldn&#39;t the Macro action &quot;ExportWithFormatting&quot; do what you want?"}, {"owner": {"reputation": 2062, "user_id": 1594166, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/37767b7a77ee53e1577c6e4cfdccb843?s=128&d=identicon&r=PG", "display_name": "AxGryndr", "link": "https://stackoverflow.com/users/1594166/axgryndr"}, "reply_to_user": {"reputation": 12772, "user_id": 490374, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8c174feb69caed3f5ba5fd68d9ab3c63?s=128&d=identicon&r=PG", "display_name": "Ann L.", "link": "https://stackoverflow.com/users/490374/ann-l"}, "edited": false, "score": 0, "creation_date": 1425422705, "post_id": 28843316, "comment_id": 45955849, "body": "The issue with that is the macro will not see the file name selected in the FileDialog in the VBA. I think I would have to create temp table and run some code from there. Let me try it and I will let you know."}, {"owner": {"reputation": 2062, "user_id": 1594166, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/37767b7a77ee53e1577c6e4cfdccb843?s=128&d=identicon&r=PG", "display_name": "AxGryndr", "link": "https://stackoverflow.com/users/1594166/axgryndr"}, "reply_to_user": {"reputation": 12772, "user_id": 490374, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8c174feb69caed3f5ba5fd68d9ab3c63?s=128&d=identicon&r=PG", "display_name": "Ann L.", "link": "https://stackoverflow.com/users/490374/ann-l"}, "edited": false, "score": 0, "creation_date": 1425504172, "post_id": 28843316, "comment_id": 45995465, "body": "It seems that the VBA equivalant to ExportWithFormatting is DoCmd.OutPutTo and using acFormatXLSX as the type. Thanks Ann."}, {"owner": {"reputation": 2062, "user_id": 1594166, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/37767b7a77ee53e1577c6e4cfdccb843?s=128&d=identicon&r=PG", "display_name": "AxGryndr", "link": "https://stackoverflow.com/users/1594166/axgryndr"}, "reply_to_user": {"reputation": 12772, "user_id": 490374, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8c174feb69caed3f5ba5fd68d9ab3c63?s=128&d=identicon&r=PG", "display_name": "Ann L.", "link": "https://stackoverflow.com/users/490374/ann-l"}, "edited": false, "score": 0, "creation_date": 1425509150, "post_id": 28843316, "comment_id": 45997975, "body": "So an odd issue with this - TransferSpreadsheet adds a new tab OutputTo creates a new file. That isn&#39;t going to work. I need something that seems to be in the middle of these two."}, {"owner": {"reputation": 2062, "user_id": 1594166, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/37767b7a77ee53e1577c6e4cfdccb843?s=128&d=identicon&r=PG", "display_name": "AxGryndr", "link": "https://stackoverflow.com/users/1594166/axgryndr"}, "reply_to_user": {"reputation": 12772, "user_id": 490374, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8c174feb69caed3f5ba5fd68d9ab3c63?s=128&d=identicon&r=PG", "display_name": "Ann L.", "link": "https://stackoverflow.com/users/490374/ann-l"}, "edited": false, "score": 0, "creation_date": 1425513215, "post_id": 28843316, "comment_id": 45999461, "body": "In the end I had to export the data using the OutPutTo method to two extra Excel files. From there I updated the VBA in my Excel template to copy the data into new tabs and then delete the extra files. This adds extra time to the process but at least it works."}], "owner": {"reputation": 2062, "user_id": 1594166, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/37767b7a77ee53e1577c6e4cfdccb843?s=128&d=identicon&r=PG", "display_name": "AxGryndr", "link": "https://stackoverflow.com/users/1594166/axgryndr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 994, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1425423123, "creation_date": 1425421980, "last_edit_date": 1425423123, "question_id": 28843316, "link": "https://stackoverflow.com/questions/28843316/access-vba-export-to-excel-with-formats", "title": "Access VBA Export to Excel with Formats", "body": "<p>I have Access 2010 linked to some views of a SharePoint 2010 list. The users decided they wanted to change some of the People Picker fields to enable multi-select. This broke the Access automation that I built for reporting.</p>\n\n<p>The issue is when the VBA calls</p>\n\n<pre><code> DoCmd.TransferSpreadsheet\n</code></pre>\n\n<p>What I get in these fields in Excel is</p>\n\n<pre><code> ID | LOB Exec\n 1  | 16; 235\n</code></pre>\n\n<p>When I view the query results in Access I get</p>\n\n<pre><code> ID | LOB Exec\n 1  | Last, First M, Last, First M\n</code></pre>\n\n<p>For my report obviously they want the latter. If I select Export then Excel the prompt asks if I want to Save with formats. When I do that I get the results I need. I cannot use a saved export procedure because multiple users export to multiple Excel files so I have to be able to tell the export VBA which file to export to. </p>\n\n<p>Any ideas how to duplicate this action with VBA would be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "edited": false, "score": 0, "creation_date": 1425421515, "post_id": 28842879, "comment_id": 45955334, "body": "Where is the &quot;Master macro&quot;? Is it in the relevant.xlsx file, in Outlook, or in some other Excel file?"}, {"owner": {"reputation": 23, "user_id": 4577466, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-V-GOUm7Lreo/AAAAAAAAAAI/AAAAAAAACLA/AWYyUQJC25A/photo.jpg?sz=128", "display_name": "Joshua W", "link": "https://stackoverflow.com/users/4577466/joshua-w"}, "reply_to_user": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "edited": false, "score": 0, "creation_date": 1425422105, "post_id": 28842879, "comment_id": 45955574, "body": "It&#39;s actually in a separate file it&#39;s own xlsm book to limit access to it so it&#39;s not modified or broken."}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "edited": false, "score": 0, "creation_date": 1425422343, "post_id": 28842879, "comment_id": 45955691, "body": "If you are asking if it is possible to have your macro check the modified dates of the files and optionally do the update, the answer is yes.  If you are asking if it is possible to <i>trigger</i> your macro if the csv file is modified, the answer is... maybe, if you use vbscript or taskscheduler or something external to VBA.  If it&#39;s the former, let me know and I&#39;ll post an answer for you!"}, {"owner": {"reputation": 23, "user_id": 4577466, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-V-GOUm7Lreo/AAAAAAAAAAI/AAAAAAAACLA/AWYyUQJC25A/photo.jpg?sz=128", "display_name": "Joshua W", "link": "https://stackoverflow.com/users/4577466/joshua-w"}, "reply_to_user": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "edited": false, "score": 0, "creation_date": 1425423764, "post_id": 28842879, "comment_id": 45956286, "body": "Well either really, the only limitation is taskscheduler is out of the question per the IT red tape gods unfortunately because that was the initial plan."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4577466, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-V-GOUm7Lreo/AAAAAAAAAAI/AAAAAAAACLA/AWYyUQJC25A/photo.jpg?sz=128", "display_name": "Joshua W", "link": "https://stackoverflow.com/users/4577466/joshua-w"}, "edited": false, "score": 0, "creation_date": 1425510406, "post_id": 28860595, "comment_id": 45998493, "body": "I think this will work, I may be able to get to the conditions coding by the end of the week. But I suppose as long as I can pass the dates and check for my condition it should work. I will post back at the latest next week regarding if this is solved or not."}, {"owner": {"reputation": 23, "user_id": 4577466, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-V-GOUm7Lreo/AAAAAAAAAAI/AAAAAAAACLA/AWYyUQJC25A/photo.jpg?sz=128", "display_name": "Joshua W", "link": "https://stackoverflow.com/users/4577466/joshua-w"}, "edited": false, "score": 0, "creation_date": 1425932475, "post_id": 28860595, "comment_id": 46155887, "body": "Yes this will work, I&#39;ve only had a little time to play with it so the tweaking will have to begin. It may be a resource hog though so I may have to abandon the notion of having this macro ran only. The email trigger may have to suffice for the long run, it&#39;s just a little cumbersome with too many links in the chain. Thanks!"}], "tags": [], "owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "is_accepted": true, "score": 2, "last_activity_date": 1425489011, "creation_date": 1425489011, "answer_id": 28860595, "question_id": 28842879, "link": "https://stackoverflow.com/questions/28842879/vba-macro-to-run-when-modified-workbook-date-time-is-greater-than-another/28860595#28860595", "title": "VBA Macro to run when Modified workbook Date/Time is greater than another", "body": "<p>Try using <a href=\"http://www.techonthenet.com/excel/formulas/filedatetime.php\" rel=\"nofollow\">FileDateTime</a></p>\n\n<p>At the very beginning of your Master macro, you can use FileDateTime to check the modified dates of the two files and make the decision to run the update or not.</p>\n"}], "owner": {"reputation": 23, "user_id": 4577466, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-V-GOUm7Lreo/AAAAAAAAAAI/AAAAAAAACLA/AWYyUQJC25A/photo.jpg?sz=128", "display_name": "Joshua W", "link": "https://stackoverflow.com/users/4577466/joshua-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 721, "favorite_count": 0, "accepted_answer_id": 28860595, "answer_count": 1, "score": 2, "last_activity_date": 1425489011, "creation_date": 1425420423, "last_edit_date": 1425420454, "question_id": 28842879, "link": "https://stackoverflow.com/questions/28842879/vba-macro-to-run-when-modified-workbook-date-time-is-greater-than-another", "title": "VBA Macro to run when Modified workbook Date/Time is greater than another", "body": "<p>I have a master report that is exported lets call that master.csv, I also have a report that was created to pull all relevant information from the .csv, lets call that relevant.xlsx.</p>\n\n<p>I have a Master macro that currently is opened when it opens it updates all records on relevant.xlsx then auto closes.</p>\n\n<p>Is there a condition I can write in VBA that checks if master.csv's modified date is greater than relevant.xlsx's modified day then run my master macro? </p>\n\n<p>I can do and google enough to find answers to most of my issues when it comes to coding however this is one thing that my google powers could not confirm there is an answer to.</p>\n\n<p>If you're wondering why in need this is because currently Outlook is told when to run mastermacro by a report confirmation email and we would like to get away from that incase exchange goes down for some reason.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1425465907, "post_id": 28842555, "comment_id": 45971494, "body": "Gibe some example, your description is very vague. If DCount is 0 then the client does not appear in the tblForms, so you have your answer, is that not right?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2204315"}, "reply_to_user": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1425495078, "post_id": 28842555, "comment_id": 45990208, "body": "I have a form (frmDisclosure) with a command button - on click:        Private Sub Command245_Click()     On Error GoTo Command245_Click_Err      DoCmd.OpenForm &quot;frmClient&quot;, acNormal, &quot;&quot;, &quot;[ClientID]= &quot; &amp;Me.Client, , acNormal DoCmd.Close acForm, &quot;frmDisclosure&quot;  Command245_Click_Exit:     Exit Sub  Command245_Click_Err:     MsgBox Error$     Resume Command245_Click_Exit  End Sub"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2204315"}, "is_accepted": false, "score": 0, "last_activity_date": 1425831073, "creation_date": 1425831073, "answer_id": 28928688, "question_id": 28842555, "link": "https://stackoverflow.com/questions/28842555/check-if-certain-data-exists-in-a-field-in-a-table/28928688#28928688", "title": "Check if certain data exists in a field in a table", "body": "<p>Here's the solution:\n    Public Function NumRecs() As Integer</p>\n\n<pre><code>Dim dbs As DAO.Database\nDim rs As Object\n\nSet dbs = CurrentDb\nSet rs = dbs.OpenRecordset(\"qryDisclosure\", dbOpenDynaset)\n\nIf Me.Recordset.RecordCount = 0 Then\n    NumRecs = 0\nElse\n    NumRecs = Nz(DCount(\"*\", \"qryDisclosure\", \"ClientLookup = \" &amp;   Me.ClientLookup), 0)\nEnd If\n</code></pre>\n\n<p>End Function</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2204315"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1244, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594652448, "creation_date": 1425419190, "last_edit_date": 1594652448, "question_id": 28842555, "link": "https://stackoverflow.com/questions/28842555/check-if-certain-data-exists-in-a-field-in-a-table", "title": "Check if certain data exists in a field in a table", "body": "<p>I have a table (tblForms) in which one of the fields is a lookup to another table (tblClients). How can I find if a certain Client has data or does not have data in tblForms? DCount only works if the Client does appear in tblForms.</p>\n\n<p>I have a form (frmDisclosure) with a command button - onClick:</p>\n\n<pre><code>Private Sub Command245_Click()\nOn Error GoTo Command245_Click_Err\n\nDoCmd.OpenForm \"frmClient\", acNormal, \"\", \"[ClientID]= \" &amp; Me.Client, , acNormal\nDoCmd.Close acForm, \"frmDisclosure\"\n\nCommand245_Click_Exit:\nExit Sub\n\nCommand245_Click_Err:\nMsgBox Error$\nResume Command245_Click_Exit\n\nEnd Sub\n</code></pre>\n\n<p>When I click this I get the error (N.B. I f I open frmClient directly form Switchboard I don't get the error). frmClient has a subform (continuous) frmFormsList which derives its data from:</p>\n\n<pre><code>SELECT tblForms.ClientLookup, tblForms.Issued, First(tblForms.RefNo) AS FirstOfRefNo, Last(tblForms.RefNo) AS LastOfRefNo, Count(tblForms.RefNo) AS CountOfRefNo, tblClient.KnownAs, tblClient.EMail\nFROM tblForms INNER JOIN tblClient ON tblForms.ClientLookup = tblClient.ClientID\nGROUP BY tblForms.ClientLookup, tblForms.Issued, tblClient.KnownAs, tblClient.EMail\nHAVING (((tblForms.Issued) Is Not Null));\n</code></pre>\n\n<p>This function resides in frmFormsList:</p>\n\n<pre><code>Public Function NumRecs() As Integer\n\nNumRecs = DCount(\"*\", \"tblForms\", \"ClientLookup = \" &amp; Me.ClientLookup)\n\nEnd Function\n</code></pre>\n\n<p>My query shows data where I have issued forms to a client. Therefore if I have not issued forms to a Client tne the query shows nothing for that client so does not give a result 0. I get RunTime Error 2427 \"You entered ans expression that has no value\". NumRecs = DCount(\"*\", \"tblForms\", \"ClientLookup = \" &amp; Me.ClientLookup) is highlighted in debug.</p>\n\n<p>In frm Disclosure, if I Rem out \", acNormal, \"\", \"[ClientID]= \" &amp; Me.Client, , acNormal\" the problem does not occur, but I don't get straight to the Client I am interested in. So the problem occurs when I try to open a form using the Rem'd out bit where the client has not been issued with any forms. When I opne the frm Client directly the rocord presented does not have forms issued but the problem does not occur.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "edited": false, "score": 0, "creation_date": 1425419404, "post_id": 28842516, "comment_id": 45954257, "body": "Your last row isn&#39;t filled out all the way to the column you want to highlight.  Last row is governing where it stops."}, {"owner": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "edited": false, "score": 0, "creation_date": 1425419649, "post_id": 28842516, "comment_id": 45954418, "body": "Use info from here: <a href=\"http://stackoverflow.com/questions/11926972/excel-vba-finding-the-last-column-with-data\" title=\"excel vba finding the last column with data\">stackoverflow.com/questions/11926972/&hellip;</a>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1425419735, "post_id": 28842516, "comment_id": 45954478, "body": "<code>End(direction)</code> behaves the same way as using <code>Ctrl+[arrow key]</code> in the UI.  If you have no fully-blank rows or columns the <code>Range(&quot;A1&quot;).CurrentRegion</code> should select the whole block (same as <code>Ctrl+A</code>)"}, {"owner": {"reputation": 59, "user_id": 3964100, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2fa95a9956248c18866b1844b504e301?s=128&d=identicon&r=PG&f=1", "display_name": "vlad88667", "link": "https://stackoverflow.com/users/3964100/vlad88667"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1425420028, "post_id": 28842516, "comment_id": 45954638, "body": "@TimWilliams Brilliant that should indeed work in my case! Thank you"}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 3964100, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2fa95a9956248c18866b1844b504e301?s=128&d=identicon&r=PG&f=1", "display_name": "vlad88667", "link": "https://stackoverflow.com/users/3964100/vlad88667"}, "edited": false, "score": 0, "creation_date": 1425464398, "post_id": 28842943, "comment_id": 45970623, "body": "Thanks for the info Dan, I might use it for another project. However in this one the number of columns might change so CurrentRegion seems appropriate and is working so far."}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": true, "score": 1, "last_activity_date": 1425420628, "creation_date": 1425420628, "answer_id": 28842943, "question_id": 28842516, "link": "https://stackoverflow.com/questions/28842516/vba-endxltoright-doesnt-include-all-columns/28842943#28842943", "title": "VBA : End(xlToRight) doesn&#39;t include all columns?", "body": "<p>Personally I prefer the usedrange of the activesheet than the CurrentRegion of a range:</p>\n\n<p>here are the results from a sheet I knocked up:</p>\n\n<pre><code>?activesheet.usedrange.address\n</code></pre>\n\n<p>$A$1:$H$9</p>\n\n<pre><code>?Activecell.currentregion.address\n</code></pre>\n\n<p>$A$4:$B$6</p>\n\n<p>You can see the Used Range is much larger than the current region.</p>\n\n<p>However, to delve even further, being that you know the number of columns AND you know column A always has data you are best to do this:</p>\n\n<pre><code>Set rngSource = Range(\"A1:L\" &amp; Range(\"A\" &amp; Rows.count).end(xlup).row)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 714, "user_id": 4487534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4c492024c03f7acac02476850ef9818?s=128&d=identicon&r=PG&f=1", "display_name": "Pillgram", "link": "https://stackoverflow.com/users/4487534/pillgram"}, "is_accepted": false, "score": 0, "last_activity_date": 1425438163, "last_edit_date": 1495540611, "creation_date": 1425438163, "answer_id": 28845957, "question_id": 28842516, "link": "https://stackoverflow.com/questions/28842516/vba-endxltoright-doesnt-include-all-columns/28845957#28845957", "title": "VBA : End(xlToRight) doesn&#39;t include all columns?", "body": "<p>As Dan alluded to, you can use the UsedRange property for this task. If you do a lot of VBA, you will find getting Range-Info is something you do over and over again. You may (or may not) find this useful: <a href=\"https://stackoverflow.com/a/28502702/4487534\">https://stackoverflow.com/a/28502702/4487534</a></p>\n"}], "owner": {"reputation": 59, "user_id": 3964100, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2fa95a9956248c18866b1844b504e301?s=128&d=identicon&r=PG&f=1", "display_name": "vlad88667", "link": "https://stackoverflow.com/users/3964100/vlad88667"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8282, "favorite_count": 0, "accepted_answer_id": 28842943, "answer_count": 2, "score": 0, "last_activity_date": 1425481248, "creation_date": 1425419044, "last_edit_date": 1531161705, "question_id": 28842516, "link": "https://stackoverflow.com/questions/28842516/vba-endxltoright-doesnt-include-all-columns", "title": "VBA : End(xlToRight) doesn&#39;t include all columns?", "body": "<p>The code I'm using is:</p>\n\n<pre><code>Sub selectrange()\n\nDim rngSource As Range, rngDest As Range\nSet rngSource = Range(Range(\"A1\"), Range(\"A1\").End(xlDown).End(xlToRight))\n'Only used to check the data being copied\nrngSource.Select\nSet rngDest = Range(\"A1\").End(xlToRight).Offset(0, 1)\nrngSource.Copy\nrngDest.PasteSpecial\n\nEnd Sub\n</code></pre>\n\n<p>The idea is to have the code select all the rows/columns with data and paste them in the next available section of another workbook. But by running this code only some of the columns are copied and pasted. </p>\n\n<p>The data in question has 12 columns (A to L), some of them empty aside from the header. When I used End(xlToRight).End(xlDown) the Selection stopped at the first empty cell in any row, so instead I did End(xlDown) on column A which contains dates, then End(xlToRight) to include all possible columns regardless if they have data or not.</p>\n\n<p>However when doing this, the selection arbitrarily stops at column E, despite the fact column F in populated and without blank cells...</p>\n\n<p>If anyone has any ideas it would be greatly appreciated!</p>\n\n<p>Thanks</p>\n"}, {"tags": ["string", "ms-access", "vba", "recordset"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 4560920, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cab58c95eb1ee09944d2b165cda8a6ef?s=128&d=identicon&r=PG&f=1", "display_name": "B West", "link": "https://stackoverflow.com/users/4560920/b-west"}, "edited": false, "score": 0, "creation_date": 1425504337, "post_id": 28843438, "comment_id": 45995568, "body": "Using &quot;Like&quot; worked like a charm. I posted this question out of frustration mostly. I had already gone the &quot;DELETE&quot; query route. Here&#39;s what I used instead:  <code>Dim SQL As String SQL = &quot;DELETE * FROM WRITEON WHERE WRITEON.ACOD Like &#39;*_X&#39;&quot; DoCmd.SetWarnings False DoCmd.RunSQL SQL DoCmd.SetWarnings True</code>"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 57, "user_id": 4560920, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cab58c95eb1ee09944d2b165cda8a6ef?s=128&d=identicon&r=PG&f=1", "display_name": "B West", "link": "https://stackoverflow.com/users/4560920/b-west"}, "edited": false, "score": 1, "creation_date": 1425504981, "post_id": 28843438, "comment_id": 45995903, "body": "OK, I understand now.  Thanks.  Consider using <code>CurrentDb.Execute SQL, dbFailOnError</code> instead of <code>DoCmd.RunSQL</code>.  With that method, you don&#39;t need to turn <code>SetWarnings</code> off.  With <code>SetWarnings</code> off, you suppress information which could be helpful for troubleshooting."}, {"owner": {"reputation": 57, "user_id": 4560920, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cab58c95eb1ee09944d2b165cda8a6ef?s=128&d=identicon&r=PG&f=1", "display_name": "B West", "link": "https://stackoverflow.com/users/4560920/b-west"}, "edited": false, "score": 1, "creation_date": 1425588141, "post_id": 28843438, "comment_id": 46035837, "body": "Excellent advice! Thank you. I am definitely uncomfortable using the <code>SetWarnings off&#47;on</code> workaround. Your way is much better."}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 3, "last_activity_date": 1425422463, "creation_date": 1425422463, "answer_id": 28843438, "question_id": 28842454, "link": "https://stackoverflow.com/questions/28842454/access-vba-recordset-string-comparison-not-working-with-wildcard/28843438#28843438", "title": "Access VBA recordset string comparison not working with wildcard", "body": "<p>Use <code>Like</code> instead of <code>=</code> when you're comparing a text value to a pattern.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>If ![ACOD] Like \"*_X\" Then\n    Debug.Print ![ACOD]\nEnd If\n</code></pre>\n\n<p>That should do what you want, but I'm not so sure evaluating each record in a recordset to delete the matches is the best way.  You could accomplish the same result by executing a <code>DELETE</code> query which uses that same pattern to identify which rows should be deleted.</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>DELETE FROM WRITEON\nWHERE [ACOD] Like \"*_X\";\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 4560920, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cab58c95eb1ee09944d2b165cda8a6ef?s=128&d=identicon&r=PG&f=1", "display_name": "B West", "link": "https://stackoverflow.com/users/4560920/b-west"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 526, "favorite_count": 0, "accepted_answer_id": 28843438, "answer_count": 1, "score": 2, "last_activity_date": 1425422509, "creation_date": 1425418839, "last_edit_date": 1425422509, "question_id": 28842454, "link": "https://stackoverflow.com/questions/28842454/access-vba-recordset-string-comparison-not-working-with-wildcard", "title": "Access VBA recordset string comparison not working with wildcard", "body": "<p>I have loads of experience using VBA in Excel but very little experience using VBA in Access 2010. I'm trying to delete records from a recordset where one of the fields ends in \"_X\". When I use a wildcard the comparison fails. When I use a specific string, the comparison works as expected. Here is the Code that I am using.</p>\n\n<pre><code>Dim db As Database: Set db = CurrentDb\nDim tbl As Recordset: Set tbl = db.OpenRecordset(\"WRITEON\")\nWith tbl\n    Do Until .EOF\n        If ![ACOD] = \"*_X\" Then '\"$ICP_X\" works\n            Debug.Print ![ACOD] 'For testing\n            '.Delete\n        End If\n    .MoveNext\n    Loop\nEnd With\ntbl.Close \n</code></pre>\n"}, {"tags": ["vba", "excel", "combobox"], "comments": [{"owner": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "edited": false, "score": 0, "creation_date": 1425418785, "post_id": 28842131, "comment_id": 45953906, "body": "Are the combo boxes in a user form or on a worksheet?"}, {"owner": {"reputation": 133, "user_id": 4020383, "user_type": "registered", "accept_rate": 18, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rj Joplin", "link": "https://stackoverflow.com/users/4020383/rj-joplin"}, "reply_to_user": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "edited": false, "score": 0, "creation_date": 1425431327, "post_id": 28842131, "comment_id": 45958808, "body": "The Combo Boxes are on a worksheet."}], "answers": [{"tags": [], "owner": {"reputation": 303, "user_id": 4430375, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/51ee13ebaef0e2d2b136f5f07b5f5249?s=128&d=identicon&r=PG&f=1", "display_name": "twegner", "link": "https://stackoverflow.com/users/4430375/twegner"}, "is_accepted": false, "score": 0, "last_activity_date": 1425489994, "creation_date": 1425489994, "answer_id": 28860921, "question_id": 28842131, "link": "https://stackoverflow.com/questions/28842131/vba-programming-with-multiple-conditions-using-comboboxes/28860921#28860921", "title": "VBA Programming with multiple conditions using ComboBoxes", "body": "<p>You might try to capture the combobox2 value in a string variable</p>\n\n<pre><code>dim str_comboBox2 as string\nstr_comboBox2 = Me.ComboBox2.value\n\nIf Me.ComboBox1.value = \"A\" and str_comboBox2 =\"2\" then\n</code></pre>\n\n<p>As it might be interpreting your entry as a number thus not satisfying the IF statement.</p>\n\n<p>Or change to:</p>\n\n<pre><code>If Me.ComboBox1.value = \"A\" and Me.ComboBox2.value = 2 then\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 4020383, "user_type": "registered", "accept_rate": 18, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rj Joplin", "link": "https://stackoverflow.com/users/4020383/rj-joplin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1083, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1425489994, "creation_date": 1425417704, "last_edit_date": 1425418175, "question_id": 28842131, "link": "https://stackoverflow.com/questions/28842131/vba-programming-with-multiple-conditions-using-comboboxes", "title": "VBA Programming with multiple conditions using ComboBoxes", "body": "<p>I am new to VBA programming and working through excel VBA programming by myself and have a question involving multiple ComboBoxes that are being used to determine the value of a single cell. </p>\n\n<p>I have 2 ComboBoxes. </p>\n\n<p>Right now I am using something close to this syntax </p>\n\n<pre><code>Private Sub ComboBox1_Change()\nIf Me.ComboBox1.Value = \"A\" and Me.ComboBox2.Value = \"2\" Then \nRange(\"A2\").Value = Range (\"B6\").Value\nElse Range(\"A2\").Value = Range(\"B7\")\nEnd If\n</code></pre>\n\n<p>The code is not working. I am not getting anything return in what would be A2. </p>\n\n<p>I am assuming that the entries in the ComboBoxes are strings of any sort and are correctly put into the code. </p>\n\n<p>Any more troubleshooting help would be much appreciated.</p>\n"}, {"tags": ["excel", "worksheet-function", "vba"], "comments": [{"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1425415163, "post_id": 28841415, "comment_id": 45952015, "body": "maybe this could help? <a href=\"http://stackoverflow.com/questions/4668410/how-do-i-get-the-old-value-of-a-changed-cell-in-excel-vba\" title=\"how do i get the old value of a changed cell in excel vba\">stackoverflow.com/questions/4668410/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1425416797, "creation_date": 1425416797, "answer_id": 28841894, "question_id": 28841415, "link": "https://stackoverflow.com/questions/28841415/detecting-what-value-was-in-a-cell-prior-to-a-change/28841894#28841894", "title": "Detecting what value was in a cell prior to a change", "body": "<p>We must <strong>remember</strong> what was in there.  Say cell <strong>B9</strong> was of interest.  In a <em>Standard Module</em> include the single line:</p>\n\n<pre><code>Public OldValue As Variant\n</code></pre>\n\n<p>and in the worksheet code area:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Intersect(Target, Range(\"B9\")) Is Nothing Then Exit Sub\n    v = Target.Value\n    MsgBox v &amp; vbCrLf &amp; OldValue\n    OldValue = v\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": true, "score": 1, "last_activity_date": 1425418608, "creation_date": 1425418608, "answer_id": 28842395, "question_id": 28841415, "link": "https://stackoverflow.com/questions/28841415/detecting-what-value-was-in-a-cell-prior-to-a-change/28842395#28842395", "title": "Detecting what value was in a cell prior to a change", "body": "<p>You can undo the change, populate the undone value to a variable then redo the change like so:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim OldValue As Variant, NewValue As Variant\nNewValue = Target.Value\nApplication.EnableEvents = False\nApplication.Undo\nOldValue = Target.Value\nTarget.Value = NewValue\nApplication.EnableEvents = True\nMsgBox OldValue\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 351, "user_id": 4484829, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/9e67521a149838fd6fb023c678716905?s=128&d=identicon&r=PG&f=1", "display_name": "KingKong", "link": "https://stackoverflow.com/users/4484829/kingkong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 340, "favorite_count": 0, "accepted_answer_id": 28842395, "answer_count": 2, "score": 0, "last_activity_date": 1425418608, "creation_date": 1425414972, "last_edit_date": 1531164843, "question_id": 28841415, "link": "https://stackoverflow.com/questions/28841415/detecting-what-value-was-in-a-cell-prior-to-a-change", "title": "Detecting what value was in a cell prior to a change", "body": "<p>Is there a way to detect what a cell use to contain before it was changed.  I'm trying to perform actions based on what the previous value was in a cell.  I know there's Worksheet_Change but the Target it uses is the new value.  </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 4621385, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ju9mCI37464/AAAAAAAAAAI/AAAAAAAAAm4/VagvVLhLTKk/photo.jpg?sz=128", "display_name": "Hisham Ibrahim", "link": "https://stackoverflow.com/users/4621385/hisham-ibrahim"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1425414395, "post_id": 28841103, "comment_id": 45951644, "body": "to be honest, I want a help to this, no matter the exact way (Desperation here)"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4621385, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ju9mCI37464/AAAAAAAAAAI/AAAAAAAAAm4/VagvVLhLTKk/photo.jpg?sz=128", "display_name": "Hisham Ibrahim", "link": "https://stackoverflow.com/users/4621385/hisham-ibrahim"}, "edited": false, "score": 0, "creation_date": 1425414513, "post_id": 28841274, "comment_id": 45951704, "body": "Thanks for help, but I want it done once I enter the data in the cell this might work if it was on another cell"}], "tags": [], "owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "is_accepted": true, "score": 0, "last_activity_date": 1425414312, "creation_date": 1425414312, "answer_id": 28841274, "question_id": 28841103, "link": "https://stackoverflow.com/questions/28841103/how-to-set-a-custom-roundup-in-excel/28841274#28841274", "title": "How to set a custom roundup in excel?", "body": "<p>If the value you want to round up is in <code>A1</code> and the multiplier is 80, you can use:</p>\n\n<pre><code>=ROUNDUP(a1/80,0)*80\n</code></pre>\n\n<p>Replace 80 with 100 for the second option.</p>\n"}], "owner": {"reputation": 1, "user_id": 4621385, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ju9mCI37464/AAAAAAAAAAI/AAAAAAAAAm4/VagvVLhLTKk/photo.jpg?sz=128", "display_name": "Hisham Ibrahim", "link": "https://stackoverflow.com/users/4621385/hisham-ibrahim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 1, "closed_date": 1537249339, "accepted_answer_id": 28841274, "answer_count": 1, "score": -3, "last_activity_date": 1425414312, "creation_date": 1425413675, "last_edit_date": 1531161705, "question_id": 28841103, "link": "https://stackoverflow.com/questions/28841103/how-to-set-a-custom-roundup-in-excel", "closed_reason": "Needs more focus", "title": "How to set a custom roundup in excel?", "body": "<p>I want to create in excel that rounds up a certain cell range according to the multiple of number 80 (For example if I entered in one cell 75 it will automatically round it up to 80 or 120 to 160 ...etc) and another range by the multiples of the number 100 (For example 80 -> 100, or 130 -> 200) </p>\n"}, {"tags": ["vba", "excel-2010", "subtotal", "listobject"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1425413039, "post_id": 28840857, "comment_id": 45950972, "body": "Very clever use of Stack Snippets, +1 and welcome to SO!"}, {"owner": {"reputation": 300, "user_id": 2764387, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aedffb31a6854e01fbddfb891d2439f8?s=128&d=identicon&r=PG&f=1", "display_name": "Zenigata", "link": "https://stackoverflow.com/users/2764387/zenigata"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1425413227, "post_id": 28840857, "comment_id": 45951081, "body": "Thank You :) I was looking for a way to replicate the Excel table structure...found one!"}, {"owner": {"reputation": 573, "user_id": 4123518, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e89d730cbe787ca73ca491c418bac385?s=128&d=identicon&r=PG&f=1", "display_name": "FPcond", "link": "https://stackoverflow.com/users/4123518/fpcond"}, "edited": false, "score": 0, "creation_date": 1425654273, "post_id": 28840857, "comment_id": 46062370, "body": "did you try setting the total column to a formula so its updated when value in the new column is changed"}, {"owner": {"reputation": 300, "user_id": 2764387, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aedffb31a6854e01fbddfb891d2439f8?s=128&d=identicon&r=PG&f=1", "display_name": "Zenigata", "link": "https://stackoverflow.com/users/2764387/zenigata"}, "edited": false, "score": 0, "creation_date": 1425667530, "post_id": 28840857, "comment_id": 46070276, "body": "I&#39;ll try that, although using the TotalsCalculation in the cell there is a =Subtotal() formula."}], "answers": [{"comments": [{"owner": {"reputation": 300, "user_id": 2764387, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aedffb31a6854e01fbddfb891d2439f8?s=128&d=identicon&r=PG&f=1", "display_name": "Zenigata", "link": "https://stackoverflow.com/users/2764387/zenigata"}, "edited": false, "score": 0, "creation_date": 1425667627, "post_id": 28902826, "comment_id": 46070329, "body": "Thank you for the confirmation!"}], "tags": [], "owner": {"reputation": 46, "user_id": 3521037, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gbet0.jpg?s=128&g=1", "display_name": "dasg7", "link": "https://stackoverflow.com/users/3521037/dasg7"}, "is_accepted": false, "score": 0, "last_activity_date": 1425658185, "creation_date": 1425658185, "answer_id": 28902826, "question_id": 28840857, "link": "https://stackoverflow.com/questions/28840857/excel-2010-vba-and-listobjects-subtotals-not-updating-on-table-changes/28902826#28902826", "title": "Excel 2010, VBA and ListObjects subtotals not updating on Table changes", "body": "<p>You are not missing anything. This issue seems to be a bug that Microsoft have not fixed yet. </p>\n\n<p>The only thing you can try by now is to Save/Close/Reopen the workbook by code.</p>\n"}, {"comments": [{"owner": {"reputation": 300, "user_id": 2764387, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aedffb31a6854e01fbddfb891d2439f8?s=128&d=identicon&r=PG&f=1", "display_name": "Zenigata", "link": "https://stackoverflow.com/users/2764387/zenigata"}, "edited": false, "score": 0, "creation_date": 1459408908, "post_id": 36297853, "comment_id": 60275862, "body": "<b>The clue to the solution lies in the fact that subtotals are dynamically calculated for columns that existed when the ListObject was converted from a range to a ListObject.</b> that is! Thank you for your informative answer."}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "reply_to_user": {"reputation": 300, "user_id": 2764387, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aedffb31a6854e01fbddfb891d2439f8?s=128&d=identicon&r=PG&f=1", "display_name": "Zenigata", "link": "https://stackoverflow.com/users/2764387/zenigata"}, "edited": false, "score": 0, "creation_date": 1459410692, "post_id": 36297853, "comment_id": 60277027, "body": "If this answer solves your problem, please mark it as the answer, and let&#39;s kill this zombie."}], "tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": true, "score": 2, "last_activity_date": 1459299913, "creation_date": 1459299913, "answer_id": 36297853, "question_id": 28840857, "link": "https://stackoverflow.com/questions/28840857/excel-2010-vba-and-listobjects-subtotals-not-updating-on-table-changes/36297853#36297853", "title": "Excel 2010, VBA and ListObjects subtotals not updating on Table changes", "body": "<p>There is an outstanding bug in Excel tables, and there are some subtleties that need to be addressed in order to get the outcome you require.</p>\n\n<p><strong>A crude fix using explicit calculation tricks</strong> does work, but while this approach will update the totals based on the current values in the data rows, they need to be applied every time there are changed values in the data table.</p>\n\n<p>There are 2 ways to force Excel to calculate the totals:</p>\n\n<ol>\n<li><p>You can toggle the Calculation state of the parent Worksheet:</p>\n\n<pre><code>objLO.Parent.EnableCalculation = False\nobjLO.Parent.EnableCalculation = True\n</code></pre></li>\n<li><p>Or, you can replace the <code>=</code> in the totals formulas:</p>\n\n<pre><code>objLO.TotalsRowRange.Replace \"=\", \"=\"\n</code></pre></li>\n</ol>\n\n<p>But neither of the above approaches give you a lasting solution that keeps the totals up to date <em>automatically</em>.</p>\n\n<p><strong>A better solution...</strong></p>\n\n<p>The clue to the solution lies in the fact that subtotals <em>are</em> dynamically calculated for columns that <em>existed</em> when the ListObject was converted from a range to a ListObject.</p>\n\n<p>You can exploit this knowledge, and ensure that instead of appending columns to the end/right of the ListObject, you insert them before an existing column. But as you ultimately want the new columns to be right-most, this approach will require the use of a dummy column in the original range, then all new columns are inserted <em>before</em> the Dummy column, and finally, the Dummy column can be deleted.</p>\n\n<p>See this modified code, with comments:</p>\n\n<pre><code>Function test()\n\n    Dim objLO As ListObject\n\n    'Expand the selection to grab an additional Dummy column\n    Set objLO = ActiveSheet.ListObjects.Add(xlSrcRange, Range(\"$A$1:$E$6\"), , xlYes)\n    objLO.Name = \"Recap\"\n    objLO.TableStyle = \"TableStyleMedium2\"\n\n    'Insert all of the new columns BEFORE the Dummy column\n    objLO.ListColumns.Add (objLO.ListColumns.Count)\n    objLO.HeaderRowRange(objLO.ListColumns.Count - 1) = \"Tot1\"\n    objLO.ListColumns.Add (objLO.ListColumns.Count)\n    objLO.HeaderRowRange(objLO.ListColumns.Count - 1) = \"Tot2\"\n    objLO.ListColumns.Add (objLO.ListColumns.Count)\n    objLO.HeaderRowRange(objLO.ListColumns.Count - 1) = \"Tot3\"\n    objLO.ListColumns.Add (objLO.ListColumns.Count)\n    objLO.HeaderRowRange(objLO.ListColumns.Count - 1) = \"Tot4\"\n\n    'Must show totals BEFORE applying totals, otherwise the last column defaults to Count (even if we override it)\n    objLO.ShowTotals = True\n\n    objLO.ListColumns(\"Tot1\").TotalsCalculation = xlTotalsCalculationSum\n    objLO.ListColumns(\"Tot2\").TotalsCalculation = xlTotalsCalculationSum\n    objLO.ListColumns(\"Tot3\").TotalsCalculation = xlTotalsCalculationSum\n    objLO.ListColumns(\"Tot4\").TotalsCalculation = xlTotalsCalculationSum\n\n    'Remove the extra dummy column\n    objLO.ListColumns(objLO.ListColumns.Count).Delete\n\n    'Now toggle the ShowTotals to force the ListObject to recognise the new column totals\n    objLO.ShowTotals = False\n    objLO.ShowTotals = True\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 300, "user_id": 2764387, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aedffb31a6854e01fbddfb891d2439f8?s=128&d=identicon&r=PG&f=1", "display_name": "Zenigata", "link": "https://stackoverflow.com/users/2764387/zenigata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1319, "favorite_count": 1, "accepted_answer_id": 36297853, "answer_count": 2, "score": 7, "last_activity_date": 1459299913, "creation_date": 1425412717, "question_id": 28840857, "link": "https://stackoverflow.com/questions/28840857/excel-2010-vba-and-listobjects-subtotals-not-updating-on-table-changes", "title": "Excel 2010, VBA and ListObjects subtotals not updating on Table changes", "body": "<p>So, having this structure (starting at A1 - show snippet > run):</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"true\">\r\n<div class=\"snippet-code snippet-currently-hidden\">\r\n<pre class=\"snippet-code-css lang-css prettyprint-override\"><code>table {\r\n  border-color: #BBB;\r\n  border-width: 0px 0px 1px 1px;\r\n  border-style: dotted;\r\n}\r\nbody {\r\n  font: 12px Arial, Tahoma, Helvetica, FreeSans, sans-serif;\r\n  color: #333;\r\n}\r\ntd {\r\n  border-color: #BBB;\r\n  border-width: 1px 1px 0px 0px;\r\n  border-style: dotted;\r\n  padding: 3px;\r\n}</code></pre>\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;table&gt;\r\n  &lt;tbody&gt;\r\n    &lt;tr&gt;\r\n      &lt;th&gt;&lt;/th&gt;\r\n      &lt;th&gt;A&lt;/th&gt;\r\n      &lt;th&gt;B&lt;/th&gt;\r\n      &lt;th&gt;C&lt;/th&gt;\r\n      &lt;th&gt;D&lt;/th&gt;\r\n    &lt;/tr&gt;\r\n    &lt;tr&gt;\r\n      &lt;td&gt;1&lt;/td&gt;\r\n      &lt;td&gt;Title 1&lt;/td&gt;\r\n      &lt;td&gt;Title 2&lt;/td&gt;\r\n      &lt;td&gt;Title 3&lt;/td&gt;\r\n      &lt;td&gt;Title 4&lt;/td&gt;\r\n    &lt;/tr&gt;\r\n    &lt;tr&gt;\r\n      &lt;td&gt;2&lt;/td&gt;\r\n      &lt;td&gt;GH&lt;/td&gt;\r\n      &lt;td&gt;1&lt;/td&gt;\r\n      &lt;td&gt;434&lt;/td&gt;\r\n      &lt;td&gt;4&lt;/td&gt;\r\n    &lt;/tr&gt;\r\n    &lt;tr&gt;\r\n      &lt;td&gt;3&lt;/td&gt;\r\n      &lt;td&gt;TH&lt;/td&gt;\r\n      &lt;td&gt;3&lt;/td&gt;\r\n      &lt;td&gt;435&lt;/td&gt;\r\n      &lt;td&gt;5&lt;/td&gt;\r\n    &lt;/tr&gt;\r\n    &lt;tr&gt;\r\n      &lt;td&gt;4&lt;/td&gt;\r\n      &lt;td&gt;TH&lt;/td&gt;\r\n      &lt;td&gt;4&lt;/td&gt;\r\n      &lt;td&gt;4&lt;/td&gt;\r\n      &lt;td&gt;6&lt;/td&gt;\r\n    &lt;/tr&gt;\r\n    &lt;tr&gt;\r\n      &lt;td&gt;5&lt;/td&gt;\r\n      &lt;td&gt;LH&lt;/td&gt;\r\n      &lt;td&gt;2&lt;/td&gt;\r\n      &lt;td&gt;0&lt;/td&gt;\r\n      &lt;td&gt;3&lt;/td&gt;\r\n    &lt;/tr&gt;\r\n    &lt;tr&gt;\r\n      &lt;td&gt;6&lt;/td&gt;\r\n      &lt;td&gt;EH&lt;/td&gt;\r\n      &lt;td&gt;2&lt;/td&gt;\r\n      &lt;td&gt;5&lt;/td&gt;\r\n      &lt;td&gt;36&lt;/td&gt;\r\n    &lt;/tr&gt;\r\n  &lt;/tbody&gt;\r\n&lt;/table&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I scripted some code to transform that range (A1:D6) in a ListObject, added 4 new columns and subtotals:</p>\n\n<pre><code>Function test()\n\n    Dim objLO As ListObject\n\n    Set objLO = ActiveSheet.ListObjects.Add(xlSrcRange, Range(\"$A$1:$D$6\"), , xlYes)\n    objLO.Name = \"Recap\"\n    objLO.TableStyle = \"TableStyleMedium2\"\n\n    objLO.ListColumns.Add (objLO.ListColumns.Count + 1)\n    objLO.HeaderRowRange(objLO.ListColumns.Count) = \"Tot1\"\n    objLO.ListColumns.Add (objLO.ListColumns.Count + 1)\n    objLO.HeaderRowRange(objLO.ListColumns.Count) = \"Tot2\"\n    objLO.ListColumns.Add (objLO.ListColumns.Count + 1)\n    objLO.HeaderRowRange(objLO.ListColumns.Count) = \"Tot3\"\n    objLO.ListColumns.Add (objLO.ListColumns.Count + 1)\n    objLO.HeaderRowRange(objLO.ListColumns.Count) = \"Tot4\"\n\n    objLO.ShowTotals = True\n\n    objLO.ListColumns(\"Tot1\").TotalsCalculation = xlTotalsCalculationSum\n    objLO.ListColumns(\"Tot2\").TotalsCalculation = xlTotalsCalculationSum\n    objLO.ListColumns(\"Tot3\").TotalsCalculation = xlTotalsCalculationSum\n    objLO.ListColumns(\"Tot4\").TotalsCalculation = xlTotalsCalculationSum\n\nEnd Function\n</code></pre>\n\n<p>Now if you go on any cell of the new columns and write some numbers the odd thing is that the TOTAL (subtotal) doesn't updates; but if you save the file and reopen it it would work and the totals will update.\nWhat I'm missing?</p>\n\n<p>I've already tried moving the ShowTotals after the TotalCalculation but the behavior remain the same.</p>\n\n<p>If we now rebuild the sheet from scratch and add this piece of code for subtotals for columns b, c and d after applying the style in the previous code:</p>\n\n<pre><code>objLO.ListColumns(\"b\").TotalsCalculation = xlTotalsCalculationSum\nobjLO.ListColumns(\"c\").TotalsCalculation = xlTotalsCalculationSum\nobjLO.ListColumns(\"d\").TotalsCalculation = xlTotalsCalculationSum  \n</code></pre>\n\n<p>I noticed that the subtotals for b, c and d are working but not for Tot1, Tot2 etc.</p>\n\n<p>It seems that the only workaround is to construct the raw table before adding a ListObject with the references for creating it.\nAnyone know a better solution?</p>\n\n<p>Thanks in advance :)</p>\n"}, {"tags": ["vba", "loops", "excel"], "answers": [{"comments": [{"owner": {"reputation": 300, "user_id": 2764387, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aedffb31a6854e01fbddfb891d2439f8?s=128&d=identicon&r=PG&f=1", "display_name": "Zenigata", "link": "https://stackoverflow.com/users/2764387/zenigata"}, "reply_to_user": {"reputation": 2174, "user_id": 2008576, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4f8209c20efe49a204fcc7e6e7862d0f?s=128&d=identicon&r=PG", "display_name": "tbur", "link": "https://stackoverflow.com/users/2008576/tbur"}, "edited": false, "score": 0, "creation_date": 1425420718, "post_id": 28841214, "comment_id": 45954969, "body": "You&#39;re welcome :) Maybe you could take a look <a href=\"http://stackoverflow.com/questions/28840857/excel-2010-vba-and-listobjects-subtotals-not-updating-on-table-changes\">here</a>"}], "tags": [], "owner": {"reputation": 300, "user_id": 2764387, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aedffb31a6854e01fbddfb891d2439f8?s=128&d=identicon&r=PG&f=1", "display_name": "Zenigata", "link": "https://stackoverflow.com/users/2764387/zenigata"}, "is_accepted": true, "score": 2, "last_activity_date": 1425414077, "creation_date": 1425414077, "answer_id": 28841214, "question_id": 28840670, "link": "https://stackoverflow.com/questions/28840670/issue-looping-through-charts-in-a-selected-group/28841214#28841214", "title": "Issue Looping Through Charts In A Selected Group", "body": "<p>I don't have really played much with Shapes (I did something with Charts however) adding <strong>.GroupItems</strong> after <em>Selection.ShapeRange</em> seems to work:  </p>\n\n<pre><code> For Each shp In Selection.ShapeRange.GroupItems  \n</code></pre>\n\n<p>Hope this helps :)</p>\n"}], "owner": {"reputation": 95, "user_id": 2643755, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6938fad45845a23129c9967079998cbc?s=128&d=identicon&r=PG", "display_name": "Edward Armstrong", "link": "https://stackoverflow.com/users/2643755/edward-armstrong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 564, "favorite_count": 0, "accepted_answer_id": 28841214, "answer_count": 1, "score": 0, "last_activity_date": 1425525525, "creation_date": 1425412106, "question_id": 28840670, "link": "https://stackoverflow.com/questions/28840670/issue-looping-through-charts-in-a-selected-group", "title": "Issue Looping Through Charts In A Selected Group", "body": "<p>Hello I am trying to loop through all charts in a selected group and am not having much luck. I am still getting up to speed with VBA and would appreciate any help that you have. </p>\n\n<p>Workflow:\n1) I have a set of charts that is grouped together into a array/shape range ( I right clicked all and clicked group)\n2) I want to loop through all of the chart objects in the shape range and perform a specific line of code</p>\n\n<p>I have tried to write code that does this if the object is selected but I am having an issue where it doesn't loop through a grouped object. My code is below and any help would be appreicated</p>\n\n<pre><code>Sub ChartLooping1()\nDim cht As Excel.Chart\nDim shp As Object\n  For Each shp In Selection.ShapeRange\n     If shp.Type = msoChart Then\n        Set cht = ActiveSheet.ChartObjects(shp.Name).Chart\n        MsgBox shp.Chart.Name\n     End If\n\n  Next shp\n\n\nMsgBox \"done\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 4629238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9eab12e6df738918b6bf8dce5ecfb38?s=128&d=identicon&r=PG&f=1", "display_name": "Michael72688", "link": "https://stackoverflow.com/users/4629238/michael72688"}, "edited": false, "score": 0, "creation_date": 1425412353, "post_id": 28840539, "comment_id": 45950594, "body": "Thanks for your response.  That&#39;s very close.  But it only selects the cells in column H, not the entire row."}, {"owner": {"reputation": 41, "user_id": 4629238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9eab12e6df738918b6bf8dce5ecfb38?s=128&d=identicon&r=PG&f=1", "display_name": "Michael72688", "link": "https://stackoverflow.com/users/4629238/michael72688"}, "edited": false, "score": 0, "creation_date": 1425413322, "post_id": 28840539, "comment_id": 45951135, "body": "Okay, here&#39;s what I changed:   Sub Zeros()     Dim i As Long: i = 2     Dim r As Long: r = 1     Do While Range(&quot;H&quot; &amp; i).Value = 0         i = i + 1     Loop     Rows(r &amp; &quot;:&quot; &amp; i - 1).Select End Sub"}, {"owner": {"reputation": 41, "user_id": 4629238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9eab12e6df738918b6bf8dce5ecfb38?s=128&d=identicon&r=PG&f=1", "display_name": "Michael72688", "link": "https://stackoverflow.com/users/4629238/michael72688"}, "edited": false, "score": 0, "creation_date": 1425413516, "post_id": 28840539, "comment_id": 45951223, "body": "How do I do a carriage return in the comments?  Everytime I hit enter it saves the comment instead of going to the next line."}, {"owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "reply_to_user": {"reputation": 41, "user_id": 4629238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9eab12e6df738918b6bf8dce5ecfb38?s=128&d=identicon&r=PG&f=1", "display_name": "Michael72688", "link": "https://stackoverflow.com/users/4629238/michael72688"}, "edited": false, "score": 0, "creation_date": 1425413585, "post_id": 28840539, "comment_id": 45951266, "body": "you can&#39;t do it in comments, you will need to post an answer, your code (based on my mine) works, also check my edited code <code>Range(&quot;H1:H&quot; &amp; i - 1).EntireRow.Select</code>. Please mark the question as answered if you are satisfied with the reply"}, {"owner": {"reputation": 41, "user_id": 4629238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9eab12e6df738918b6bf8dce5ecfb38?s=128&d=identicon&r=PG&f=1", "display_name": "Michael72688", "link": "https://stackoverflow.com/users/4629238/michael72688"}, "edited": false, "score": 0, "creation_date": 1425416438, "post_id": 28840539, "comment_id": 45952687, "body": "I like yours better.  Thanks"}, {"owner": {"reputation": 41, "user_id": 4629238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9eab12e6df738918b6bf8dce5ecfb38?s=128&d=identicon&r=PG&f=1", "display_name": "Michael72688", "link": "https://stackoverflow.com/users/4629238/michael72688"}, "edited": false, "score": 0, "creation_date": 1425417151, "post_id": 28840539, "comment_id": 45953068, "body": "I guess I don&#39;t have enough reputation."}], "tags": [], "owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "is_accepted": true, "score": 2, "last_activity_date": 1425412561, "last_edit_date": 1425412561, "creation_date": 1425411669, "answer_id": 28840539, "question_id": 28840332, "link": "https://stackoverflow.com/questions/28840332/vba-excel-select-all-rows-with-value-in-a-column/28840539#28840539", "title": "VBA Excel - select all rows with value in a column", "body": "<p>This will do the job</p>\n\n<pre><code>Sub CustomSelect()\n    Dim i As Long: i = 2\n    Do While Range(\"H\" &amp; i).Value = 0\n        i = i + 1\n    Loop\n    Range(\"H1:H\" &amp; i - 1).EntireRow.Select\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 4629238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9eab12e6df738918b6bf8dce5ecfb38?s=128&d=identicon&r=PG&f=1", "display_name": "Michael72688", "link": "https://stackoverflow.com/users/4629238/michael72688"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12325, "favorite_count": 0, "accepted_answer_id": 28840539, "answer_count": 1, "score": 0, "last_activity_date": 1425412561, "creation_date": 1425411058, "question_id": 28840332, "link": "https://stackoverflow.com/questions/28840332/vba-excel-select-all-rows-with-value-in-a-column", "title": "VBA Excel - select all rows with value in a column", "body": "<p>I have a spreadsheet named \"Copy\" sorted by numeric values (lowest to highest) in column H.  The sheet has headers in row 1.  The lowest value in column H is 0.  I would like to find the last row that has column H equal 0 and then select the range of rows where column H equals 0 along with the header row.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "outlook", "email-attachments"], "comments": [{"owner": {"reputation": 117, "user_id": 4618862, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/155656951037f898a4d8518c9a95684a?s=128&d=identicon&r=PG&f=1", "display_name": "nfnf", "link": "https://stackoverflow.com/users/4618862/nfnf"}, "reply_to_user": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1425430484, "post_id": 28840066, "comment_id": 45958574, "body": "Not yelling at all. I didn&#39;t include a &quot;!&quot;. I just made the important part all caps to hopefully draw someones attention that was looking for questions to answer who had dealt with this before and might be willing to assist me. The written word is easy to read into in whatever way the reader wants, but I assure you that I would be most thankful for anyone&#39;s assistance. I am very new to this and will try to edit the caps out so its not misinterpreted by others. My apologies."}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1425430616, "post_id": 28840066, "comment_id": 45958609, "body": "It was a bit of a joke. All caps translated into yelling most of the time. I reccomend swinging by the &quot;How to format in Markdown?&quot; Section of the help center."}, {"owner": {"reputation": 117, "user_id": 4618862, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/155656951037f898a4d8518c9a95684a?s=128&d=identicon&r=PG&f=1", "display_name": "nfnf", "link": "https://stackoverflow.com/users/4618862/nfnf"}, "reply_to_user": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1425430846, "post_id": 28840066, "comment_id": 45958676, "body": "Told you I was very new, I didn&#39;t even know I was being messed with. I&#39;m the &quot;new guy&quot; :)"}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 4618862, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/155656951037f898a4d8518c9a95684a?s=128&d=identicon&r=PG&f=1", "display_name": "nfnf", "link": "https://stackoverflow.com/users/4618862/nfnf"}, "edited": false, "score": 0, "creation_date": 1425477479, "post_id": 28845307, "comment_id": 45978586, "body": "I thank you for taking the time to try and assist me with this. I removed that line of code and it unfortunately still isn&#39;t working. Any other ideas would be sincerely appreciated."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "reply_to_user": {"reputation": 117, "user_id": 4618862, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/155656951037f898a4d8518c9a95684a?s=128&d=identicon&r=PG&f=1", "display_name": "nfnf", "link": "https://stackoverflow.com/users/4618862/nfnf"}, "edited": false, "score": 0, "creation_date": 1425491000, "post_id": 28845307, "comment_id": 45987846, "body": "The faulty code is a false clue. If you search for a non-VBA reason there are many results. <a href=\"http://www.msoutlook.info/question/attachments-disappear-rich-text\" rel=\"nofollow noreferrer\">msoutlook.info/question/attachments-disappear-rich-text</a> <a href=\"http://www.computerhope.com/issues/ch000728.htm\" rel=\"nofollow noreferrer\">computerhope.com/issues/ch000728.htm</a> <a href=\"https://www.novell.com/communities/coolsolutions/mystery-missing-e-mail-attachments/\" rel=\"nofollow noreferrer\">novell.com/communities/coolsolutions/&hellip;</a> <a href=\"http://support.microsoft.com/kb/958012\" rel=\"nofollow noreferrer\">support.microsoft.com/kb/958012</a>"}], "tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 2, "last_activity_date": 1425433411, "creation_date": 1425433411, "answer_id": 28845307, "question_id": 28840066, "link": "https://stackoverflow.com/questions/28840066/forward-email-with-its-attachment-in-outlook-2010/28845307#28845307", "title": "Forward Email with its attachment in Outlook 2010", "body": "<p>There is an unnecessary condition </p>\n\n<pre><code>If oExplorer.Selection.item(1).Class = olMail Then\n</code></pre>\n\n<p>that may cause the forwarding to be bypassed.</p>\n\n<pre><code>Sub ForwardEmail(item As Outlook.MailItem)\n' Dim oExplorer As Outlook.Explorer\nDim oMail As MailItem\n' Set oExplorer = Application.ActiveExplorer\n\nOn Error GoTo Release\n\n' If oExplorer.Selection.item(1).Class = olMail Then\n\nSet oMail = item.Forward\noMail.Subject = oMail.Subject\noMail.HTMLBody = \"Have a nice day.\" &amp; vbCrLf &amp; oMail.HTMLBody\noMail.Recipients.Add \"email address here\"\n\n' oMail.Save\noMail.Send\n\n' End If\n\nRelease:\nSet oMail = Nothing\n' Set oExplorer = Nothing\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 117, "user_id": 4618862, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/155656951037f898a4d8518c9a95684a?s=128&d=identicon&r=PG&f=1", "display_name": "nfnf", "link": "https://stackoverflow.com/users/4618862/nfnf"}, "edited": false, "score": 0, "creation_date": 1425479263, "post_id": 28856340, "comment_id": 45979804, "body": "Thank you very much for asssiting me. Your ammedned code was able to forward an email without an attachment, but not one with an attachment. Any further advise to try would be appreciated."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 117, "user_id": 4618862, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/155656951037f898a4d8518c9a95684a?s=128&d=identicon&r=PG&f=1", "display_name": "nfnf", "link": "https://stackoverflow.com/users/4618862/nfnf"}, "edited": false, "score": 0, "creation_date": 1425479402, "post_id": 28856340, "comment_id": 45979896, "body": "It looks like Outlook blocked the attachment. Try to call the code outside of the rule. Do you get the same issue?"}, {"owner": {"reputation": 117, "user_id": 4618862, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/155656951037f898a4d8518c9a95684a?s=128&d=identicon&r=PG&f=1", "display_name": "nfnf", "link": "https://stackoverflow.com/users/4618862/nfnf"}, "edited": false, "score": 0, "creation_date": 1425503672, "post_id": 28856340, "comment_id": 45995202, "body": "My macro doesn&#39;t appear in the &quot;Run&quot; box as an option. This is my first attempt at using vba in outlook and tried everything I could think of to get it to run. To be honest, I was a bit embarrassed I couldn&#39;t make it run without being told to by rule using script.  Its strange that your amended code (thanks you BTW again for that) allows emails to be forwarded as long as there is no attachment on it, but it won&#39;t forward the email at all if it doesn&#39;t have an attachment (i.e. it doesn&#39;t forward the email without the attachment either)."}, {"owner": {"reputation": 117, "user_id": 4618862, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/155656951037f898a4d8518c9a95684a?s=128&d=identicon&r=PG&f=1", "display_name": "nfnf", "link": "https://stackoverflow.com/users/4618862/nfnf"}, "edited": false, "score": 0, "creation_date": 1425562225, "post_id": 28856340, "comment_id": 46019678, "body": "Atafiev After some researching and trial and error I have discovered that I cannot create a macro if it contains &quot;(&quot; after the sub name (no spaces). As soon as I type the &quot;(&quot; the create button becomes inactive. Also, if I don&#39;t include the &quot;(item As Outlook.MailItem)&quot; after the first part of the sub name, then the rule wizard doesn&#39;t recognize any script to run. Thank you for taking an interest in assisting me."}, {"owner": {"reputation": 117, "user_id": 4618862, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/155656951037f898a4d8518c9a95684a?s=128&d=identicon&r=PG&f=1", "display_name": "nfnf", "link": "https://stackoverflow.com/users/4618862/nfnf"}, "edited": false, "score": 0, "creation_date": 1425562644, "post_id": 28856340, "comment_id": 46019941, "body": "After some researching and trial and error I have discovered that I cannot create a macro if it contains &quot;(&quot; after the sub name (no spaces). As soon as I type the &quot;(&quot; the create button becomes inactive. Also, if I don&#39;t include the &quot;(item As Outlook.MailItem)&quot; after the first part of the sub name, then the rule wizard doesn&#39;t recognize any script to run. Thank you for taking an interest in assisting me"}, {"owner": {"reputation": 117, "user_id": 4618862, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/155656951037f898a4d8518c9a95684a?s=128&d=identicon&r=PG&f=1", "display_name": "nfnf", "link": "https://stackoverflow.com/users/4618862/nfnf"}, "edited": false, "score": 0, "creation_date": 1425576539, "post_id": 28856340, "comment_id": 46029085, "body": "Interestingly, if the initial email is created and then the attachment is added (by clicking the paperclip and browsing) before its sent the script runs as designed. If the attachment is added via the &quot;Save and send, as attachment&quot; feature under file it does not work (i.e. the operation failed). The save and send fills out the subject line which I deleted and retyped for the rule to recognize but it didn&#39;t matter. So at least I have a work around."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": true, "score": 7, "last_activity_date": 1425477500, "creation_date": 1425477500, "answer_id": 28856340, "question_id": 28840066, "link": "https://stackoverflow.com/questions/28840066/forward-email-with-its-attachment-in-outlook-2010/28856340#28856340", "title": "Forward Email with its attachment in Outlook 2010", "body": "<p>There is no need to use the Explorer object in the code:</p>\n\n<pre><code>Sub ForwardEmail(item As Outlook.MailItem)\n  Dim oMail As MailItem    \n\n  On Error GoTo Release\n\n  If item.Class = olMail Then\n     Set oMail = item.Forward\n     oMail.Subject = oMail.Subject\n     oMail.HTMLBody = \"Have a nice day.\" &amp; vbCrLf &amp; oMail.HTMLBody\n     oMail.Recipients.Add \"email address here\"\n\n     oMail.Save\n     oMail.Send\n  End If\n Release:\n  Set oMail = Nothing\n  Set oExplorer = Nothing\nEnd Sub\n</code></pre>\n\n<p>You may find the <a href=\"https://msdn.microsoft.com/en-us/library/office/ee814736%28v=office.14%29.aspx\" rel=\"noreferrer\">Getting Started with VBA in Outlook 2010</a> article helpful.</p>\n"}], "owner": {"reputation": 117, "user_id": 4618862, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/155656951037f898a4d8518c9a95684a?s=128&d=identicon&r=PG&f=1", "display_name": "nfnf", "link": "https://stackoverflow.com/users/4618862/nfnf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18652, "favorite_count": 0, "accepted_answer_id": 28856340, "answer_count": 2, "score": 6, "last_activity_date": 1592871485, "creation_date": 1425410120, "last_edit_date": 1592871485, "question_id": 28840066, "link": "https://stackoverflow.com/questions/28840066/forward-email-with-its-attachment-in-outlook-2010", "title": "Forward Email with its attachment in Outlook 2010", "body": "<p>The below code (I pulled from several sources) now works in that when I receive an email with specific words in the subject line it triggers a script that runs the below. </p>\n\n<p>This code then keeps the subject line, adds text the message body and the forwards to the intended recipient. </p>\n\n<p>However, if the email I receive has an attachment the code no longer forwards anything. I need it to forward the attachment that was emailed to me as well (only using the code to add text to body of email otherwise I would just set a rule).</p>\n\n<p>CODE BELOW:</p>\n\n<pre><code>Sub ForwardEmail(item As Outlook.MailItem)\nDim oExplorer As Outlook.Explorer\nDim oMail As MailItem\nSet oExplorer = Application.ActiveExplorer\n\nOn Error GoTo Release\n\nIf oExplorer.Selection.item(1).Class = olMail Then\nSet oMail = item.Forward\noMail.Subject = oMail.Subject\noMail.HTMLBody = \"Have a nice day.\" &amp; vbCrLf &amp; oMail.HTMLBody\noMail.Recipients.Add \"email address here\"\n\n\noMail.Save\noMail.Send\n\nEnd If\nRelease:\nSet oMail = Nothing\nSet oExplorer = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 649, "user_id": 4271859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/300a758b7adcf9faa29b5b4beffc9528?s=128&d=identicon&r=PG&f=1", "display_name": "Yaegz", "link": "https://stackoverflow.com/users/4271859/yaegz"}, "is_accepted": true, "score": 0, "last_activity_date": 1425413228, "creation_date": 1425413228, "answer_id": 28841006, "question_id": 28839899, "link": "https://stackoverflow.com/questions/28839899/copying-the-data-in-excel-through-vba/28841006#28841006", "title": "Copying the data in Excel through VBA", "body": "<p>The line Range(\"A2:D\" &amp; LastRow).Copy has column D hardcoded into it.  This means that it will always copy A2 to D65536.  If you want specific columns(A, B, E, G) then I would recommend simply repeating your code for each column. </p>\n\n<p>For example</p>\n\n<pre><code>Range(\"A65536\").Select\nActiveCell.End(xlUp).Select\nSelection.Copy\ny.Worksheets(\"Sheet1\").Range(\"a65536\").End(xlUp).Offset(1, 0).Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n</code></pre>\n\n<p>then copy the code four times and replace the A to whatever column you want to copy or paste to.  If this isn't what you are looking for please elaborate on what you want.</p>\n"}], "owner": {"reputation": 25, "user_id": 3923765, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/88e1759fe4883820080305f986740b61?s=128&d=identicon&r=PG&f=1", "display_name": "user3923765", "link": "https://stackoverflow.com/users/3923765/user3923765"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 1, "accepted_answer_id": 28841006, "answer_count": 1, "score": 0, "last_activity_date": 1484864549, "creation_date": 1425409503, "last_edit_date": 1484864549, "question_id": 28839899, "link": "https://stackoverflow.com/questions/28839899/copying-the-data-in-excel-through-vba", "title": "Copying the data in Excel through VBA", "body": "<p>As you can see down, I am copy 4 columns of data from one workbook to another. I am stuck at a case where the destination has 8 columns and my area of columns are 1,2,5,7. can you suggest me some changes in the code please. The one below will work only for first 4 columns. Thanks. </p>\n\n<pre><code>Sub Copymc()\n\nDim x As Workbook\nDim y As Workbook\nDim rng As Range\n\nSet x = Workbooks.Open(\"H:\\testing\\Q4 2014\\US RMBS Q4.xlsx\")\nSet y = Workbooks.Open(\"H:\\testing\\demo\\test1.xlsx\")\n\nDim LastRow As Long\nDim NextRow As Long\n\nx.Worksheets(\"RL Holdings\").Activate\nRange(\"A65536\").Select\nActiveCell.End(xlUp).Select\nLastRow = ActiveCell.Row\nRange(\"A2:D\" &amp; LastRow).Copy   \n\ny.Worksheets(\"Sheet1\").Range(\"a65536\").End(xlUp).Offset(1, 0)\nApplication.CutCopyMode = False\n\nEnd sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "is_accepted": true, "score": 8, "last_activity_date": 1425408699, "last_edit_date": 1425408699, "creation_date": 1425408286, "answer_id": 28839570, "question_id": 28839435, "link": "https://stackoverflow.com/questions/28839435/how-to-overload-functions-from-the-vba-standard-library-like-isempty/28839570#28839570", "title": "How to overload functions from the VBA standard library like IsEmpty()?", "body": "<p>Yes. Explicitly reference the standard library.</p>\n\n<pre><code>VBA.IsEmpty()\n</code></pre>\n\n<p><strong>Bonus:</strong><br/>\n<code>IsEmpty</code> actually belongs to the <code>Information</code> object. A <em>fully</em> explicit call looks like this.</p>\n\n<pre><code>bool = VBA.Information.IsEmpty(var)\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/YJQ26.png\" alt=\"object browser\"></p>\n"}], "owner": {"reputation": 8724, "user_id": 619177, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/65d2dc7c8d335fa33854172a26fa46f5?s=128&d=identicon&r=PG", "display_name": "sigil", "link": "https://stackoverflow.com/users/619177/sigil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 550, "favorite_count": 2, "accepted_answer_id": 28839570, "answer_count": 1, "score": 4, "last_activity_date": 1425408699, "creation_date": 1425407825, "question_id": 28839435, "link": "https://stackoverflow.com/questions/28839435/how-to-overload-functions-from-the-vba-standard-library-like-isempty", "title": "How to overload functions from the VBA standard library like IsEmpty()?", "body": "<p>I want to make a local version of <code>IsEmpty()</code> in a class like this:</p>\n\n<pre><code>Public Dict As Dictionary\n\nPublic Function isEmpty(columnName As Variant) As Boolean\nisEmpty = IsEmpty(Dict(columnName))\nEnd Function\n</code></pre>\n\n<p>This is for information hiding, so that I can call</p>\n\n<pre><code>classInstance.isEmpty(\"someField\")\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>isEmpty(classInstance.Dict(\"someField\"))\n</code></pre>\n\n<p>and therefore not expose the class' internal data structure.</p>\n\n<p>But the problem is that the version of <code>isEmpty()</code> that I've declared seems to be overriding any reference to the VBA library version of <code>IsEmpty()</code>, because it's generating an <code>Out of stack</code> error and crashing Excel.  I assume this is because the <code>isEmpty = IsEmpty(...)</code> call is causing infinite recursion.</p>\n\n<p>Is there a way that I can explicitly reference the standard version of <code>IsEmpty()</code> that I would like to call here?</p>\n"}, {"tags": ["vba", "32bit-64bit"], "comments": [{"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1425407808, "post_id": 28839300, "comment_id": 45947894, "body": "please <a href=\"http://stackoverflow.com/help/formatting\">format code as code</a>"}, {"owner": {"reputation": 21, "user_id": 4629051, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ff892392f5f0361350e90ada65cb389?s=128&d=identicon&r=PG&f=1", "display_name": "MG2015", "link": "https://stackoverflow.com/users/4629051/mg2015"}, "reply_to_user": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1425407946, "post_id": 28839300, "comment_id": 45947981, "body": "Thank you for reformatting...rookie mistake as this is my first time posting a question..."}, {"owner": {"reputation": 5277, "user_id": 156648, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2dc62782d79a90b829e96f36f48fe164?s=128&d=identicon&r=PG", "display_name": "guitarthrower", "link": "https://stackoverflow.com/users/156648/guitarthrower"}, "edited": false, "score": 0, "creation_date": 1425408176, "post_id": 28839300, "comment_id": 45948130, "body": "are you getting an error message?"}, {"owner": {"reputation": 21, "user_id": 4629051, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ff892392f5f0361350e90ada65cb389?s=128&d=identicon&r=PG&f=1", "display_name": "MG2015", "link": "https://stackoverflow.com/users/4629051/mg2015"}, "edited": false, "score": 0, "creation_date": 1425408492, "post_id": 28839300, "comment_id": 45948340, "body": "Yes, when the user with 64 bit runs it, the error is the file (&quot;PostSMTP.xll&quot;) could not be found. Regardless if PtrSafe is included."}, {"owner": {"reputation": 360447, "user_id": 3043, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/61d2a0f034915fa9d2acd6f6b145bba8?s=128&d=identicon&r=PG", "display_name": "Joel Coehoorn", "link": "https://stackoverflow.com/users/3043/joel-coehoorn"}, "edited": false, "score": 0, "creation_date": 1425409902, "post_id": 28839300, "comment_id": 45949158, "body": "PtrSafe is only one part of it."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 4629051, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ff892392f5f0361350e90ada65cb389?s=128&d=identicon&r=PG&f=1", "display_name": "MG2015", "link": "https://stackoverflow.com/users/4629051/mg2015"}, "edited": false, "score": 0, "creation_date": 1425411287, "post_id": 28839938, "comment_id": 45949976, "body": "thanks that was very informative. For now I was able to get IT to roll back to 32 bit version while I work on getting the original xll updated."}], "tags": [], "owner": {"reputation": 360447, "user_id": 3043, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/61d2a0f034915fa9d2acd6f6b145bba8?s=128&d=identicon&r=PG", "display_name": "Joel Coehoorn", "link": "https://stackoverflow.com/users/3043/joel-coehoorn"}, "is_accepted": false, "score": 1, "last_activity_date": 1425410013, "last_edit_date": 1425410013, "creation_date": 1425409646, "answer_id": 28839938, "question_id": 28839300, "link": "https://stackoverflow.com/questions/28839300/how-to-change-vba-declaration-statement-to-be-compatible-with-windows-64-bit/28839938#28839938", "title": "How to change vba Declaration statement to be compatible with Windows 64 bit", "body": "<p>As you know, there are 64-bit and 32-bit versions of Windows. You may or may not also know that there are both 32-bit and 64-bit versions of MS Office. What you (and your IT staff) have probably missed is that <a href=\"http://www.pcpro.co.uk/news/enterprise/356173/microsoft-warns-users-off-64-bit-office-2010\" rel=\"nofollow\"><strong>Microsoft strongly recommends the 32-bit version of Office for most users, even when running 64-bit Windows.</strong></a></p>\n\n<p>This is one of the reasons why.</p>\n\n<p>Thankfully, that article was written for Office 2010. While most of the things in it are still true for Office 2013, and the general recommendation remains, you can now at least now fix your <code>DECLARE</code> statements to work with 64-bit Office if you have to. Here's the MSDN article that covers how to do it:</p>\n\n<blockquote>\n  <p><a href=\"https://msdn.microsoft.com/en-us/library/office/gg264421.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/gg264421.aspx</a></p>\n</blockquote>\n\n<p>You've already seen one part of it, but PtrSafe is not the whole story. It also involves using the right pointer type in the right scenario. Additionally, you're using an <code>xll</code> file, which was itself written using VBA. <em>You must also modify the original file to also correctly use PtrSafe and the right <code>LongPtr</code> type.</em> If you are unable to do this, the 32-bit version of Office is your only option.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8211170, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/78fdb5a60904c37a085e254ef22676ca?s=128&d=identicon&r=PG", "display_name": "Mr.Crazy", "link": "https://stackoverflow.com/users/8211170/mr-crazy"}, "is_accepted": false, "score": -1, "last_activity_date": 1498371941, "creation_date": 1498371941, "answer_id": 44743784, "question_id": 28839300, "link": "https://stackoverflow.com/questions/28839300/how-to-change-vba-declaration-statement-to-be-compatible-with-windows-64-bit/44743784#44743784", "title": "How to change vba Declaration statement to be compatible with Windows 64 bit", "body": "<p>use PtrSafe in your Function Declaration\nlike:</p>\n\n<pre><code>Public Declare PtrSafe Function\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 4629051, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ff892392f5f0361350e90ada65cb389?s=128&d=identicon&r=PG&f=1", "display_name": "MG2015", "link": "https://stackoverflow.com/users/4629051/mg2015"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3924, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1498371941, "creation_date": 1425407451, "last_edit_date": 1425408154, "question_id": 28839300, "link": "https://stackoverflow.com/questions/28839300/how-to-change-vba-declaration-statement-to-be-compatible-with-windows-64-bit", "title": "How to change vba Declaration statement to be compatible with Windows 64 bit", "body": "<p>I have a model that previously only was used by people with 32 bit Windows, but now users are being upgraded to 64 bit and I need to make the declaration statement below compatible for both systems:</p>\n\n<pre><code>'Import functions from external DLL's\nPublic Declare Function SendMailWithAttachments Lib \"PostSMTP.xll\" ( _\n                       ByVal strServer As String, _\n                       ByVal uPort As Integer, _\n                       ByVal strFrom As String, _\n                       ByVal strTo As String, _\n                       ByVal strSubject As String, _\n                       ByVal strBody As String, _\n                       ByVal strAttachments As String) As Integer\n</code></pre>\n\n<p>I tried including PtrSafe in the code but that still did not work. This is the first time I've had to make a change like this so I'm not sure where to start. Any feedback would be appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 1, "creation_date": 1425407317, "post_id": 28839213, "comment_id": 45947600, "body": "Where a <code>r</code> variable is defined?"}, {"owner": {"reputation": 627, "user_id": 3075813, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6939855d9ee7a37afc7f8517d5db2a02?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Erickson", "link": "https://stackoverflow.com/users/3075813/joseph-erickson"}, "reply_to_user": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1425407350, "post_id": 28839213, "comment_id": 45947618, "body": "R should be the column. Bad syntax for that?"}, {"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1425407389, "post_id": 28839213, "comment_id": 45947646, "body": "you didn&#39;t assign any value to r"}, {"owner": {"reputation": 627, "user_id": 3075813, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6939855d9ee7a37afc7f8517d5db2a02?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Erickson", "link": "https://stackoverflow.com/users/3075813/joseph-erickson"}, "edited": false, "score": 0, "creation_date": 1425407419, "post_id": 28839213, "comment_id": 45947667, "body": "Edited for appropriate column ref. Still, obviously, doesn&#39;t work."}, {"owner": {"reputation": 561, "user_id": 2225326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eab175bdf46a6d70224e635275ee9d22?s=128&d=identicon&r=PG", "display_name": "Conrad", "link": "https://stackoverflow.com/users/2225326/conrad"}, "edited": false, "score": 0, "creation_date": 1425407621, "post_id": 28839213, "comment_id": 45947796, "body": "What exactly are you trying to achieve with <code>x = Range(Cells(i, 18))</code>?"}, {"owner": {"reputation": 627, "user_id": 3075813, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6939855d9ee7a37afc7f8517d5db2a02?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Erickson", "link": "https://stackoverflow.com/users/3075813/joseph-erickson"}, "edited": false, "score": 0, "creation_date": 1425407670, "post_id": 28839213, "comment_id": 45947823, "body": "Im not very good at VB. It&#39;s fine guys. Gonig to do it manually. It&#39;s not really fair for me to ask this question as I haven&#39;t done the work on my end to get to the point to ask intelligent questions."}, {"owner": {"reputation": 2174, "user_id": 2008576, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4f8209c20efe49a204fcc7e6e7862d0f?s=128&d=identicon&r=PG", "display_name": "tbur", "link": "https://stackoverflow.com/users/2008576/tbur"}, "edited": false, "score": 0, "creation_date": 1425408079, "post_id": 28839213, "comment_id": 45948063, "body": "Is the goal to change the Cell value &quot;FLAG&quot; to the number one?"}], "answers": [{"tags": [], "owner": {"reputation": 5277, "user_id": 156648, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2dc62782d79a90b829e96f36f48fe164?s=128&d=identicon&r=PG", "display_name": "guitarthrower", "link": "https://stackoverflow.com/users/156648/guitarthrower"}, "is_accepted": true, "score": 2, "last_activity_date": 1425407698, "creation_date": 1425407698, "answer_id": 28839387, "question_id": 28839213, "link": "https://stackoverflow.com/questions/28839213/for-loop-excel-vba/28839387#28839387", "title": "For loop excel vba", "body": "<p>Range and Cells are 2 different ways to get the same thing.</p>\n\n<p>I.e. <code>Range(\"A1\")</code> = <code>Cells(1,1)</code></p>\n\n<p>the following should work</p>\n\n<pre><code>Sub Loopcheck()\n\n    Dim i As Integer\n    Dim x As Integer\n    Dim y As Integer\n\n    ActiveSheet.Range(\"A1\").Select\n\n\n    For i = 2 To 100\n\n        If Cells(i, 18).Value = \"FLAG\" Then\n            x = Cells(i, 18)\n            y = Cells(i, 18)\n\n            Range(x, y).Value = 1\n\n        End If\n\n    Next i\nEnd Sub\n</code></pre>\n\n<p>However, after fixing that issue, you are likely going to have another issue because it appears that you are assigning x and y values that are not integers. At least that is what it appears since in this line you are testing for text values: <code>If Cells(i, 18).Value = \"FLAG\"</code>.</p>\n"}], "owner": {"reputation": 627, "user_id": 3075813, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6939855d9ee7a37afc7f8517d5db2a02?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Erickson", "link": "https://stackoverflow.com/users/3075813/joseph-erickson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 28839387, "answer_count": 1, "score": -1, "last_activity_date": 1425407698, "creation_date": 1425407211, "question_id": 28839213, "link": "https://stackoverflow.com/questions/28839213/for-loop-excel-vba", "title": "For loop excel vba", "body": "<p>I've been using a lot of java recently and VBA within the excel environment feels difficult to troubleshoot comparitively. I'm trying to create a baisc for if loop and the error is so generic (Run-time error 1004) application-defined or object-defined error that I have no idea what to change. additionally, I'm not so familiar with VB syntax to know where I'm missing something. Code below.</p>\n\n<pre><code>Sub Loopcheck()\n\nDim i As Integer\nDim x As Integer\nDim y As Integer\n\nActiveSheet.Range(\"A1\").Select\n\n\nFor i = 2 To 100\n\nIf Cells(i, 18).Value = \"FLAG\" Then\nx = Range(Cells(i, 18))\ny = Range(Cells(i, 18))\n\nRange(x, y).Value = 1\n\nEnd If\n\nNext i\n</code></pre>\n"}, {"tags": ["excel", "oracle", "vba", "oledb", "ado"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1425408083, "post_id": 28838695, "comment_id": 45948065, "body": "If you&#39;re using 64-bit Excel (and you probably should use the 32-bit version of Office unless you <i>really</i> need 64-bit) then you also need the 64-bit Oracle client and 64-bit drivers."}, {"owner": {"reputation": 85, "user_id": 2859599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32315339d88c73b6261eff5c45c33b92?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Exter", "link": "https://stackoverflow.com/users/2859599/paul-exter"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1425409755, "post_id": 28838695, "comment_id": 45949085, "body": "Thank you, that&#39;s the sense I got but I wanted to confirm before I proceeded. They kind of upgraded us to 64 bit Office over the last few months without a good reason. Maybe they can move me back - although, if I want other people to be able to use the macro I&#39;m writing, I guess they would have to be rolled back too..."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1425410008, "post_id": 28838695, "comment_id": 45949228, "body": "Guidelines from MS on which version to use: <a href=\"https://support.office.com/en-sg/article/Choose-the-32-bit-or-64-bit-version-of-Office-2dee7807-8f95-4d0c-b5fe-6c6f49b8d261?ui=en-US&amp;rs=en-SG&amp;ad=SG\" rel=\"nofollow noreferrer\">support.office.com/en-sg/article/&hellip;</a>  Using 64-bit Office will give you a lot more compatibility issues, and if you don&#39;t really need it probably best to stay on 32-bit."}], "answers": [{"tags": [], "owner": {"reputation": 16, "user_id": 4628963, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/3f7168ea3e49a32d61867fa4e34bdc8f?s=128&d=identicon&r=PG", "display_name": "Larry", "link": "https://stackoverflow.com/users/4628963/larry"}, "is_accepted": false, "score": -2, "last_activity_date": 1425406020, "creation_date": 1425406020, "answer_id": 28838812, "question_id": 28838695, "link": "https://stackoverflow.com/questions/28838695/connecting-to-32-bit-oracle-client-with-64-bit-excel/28838812#28838812", "title": "Connecting to 32 bit Oracle client with 64 bit Excel", "body": "<p>The oracle server matters not. </p>\n\n<p>Try opening a dos window and type c:\\ tnsping yourservername</p>\n\n<p>look towards installation issues.</p>\n"}, {"comments": [{"owner": {"reputation": 85, "user_id": 2859599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32315339d88c73b6261eff5c45c33b92?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Exter", "link": "https://stackoverflow.com/users/2859599/paul-exter"}, "edited": false, "score": 0, "creation_date": 1425419913, "post_id": 28842271, "comment_id": 45954578, "body": "Thanks, you reconfirmed what Tim commented above. I talked to my IT department about the best path forward, and they suggested I just remote into a terminal where Excel and Oracle are both 32 bit, which I wish I thought of myself. I did so and my macro worked fine from there."}], "tags": [], "owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "is_accepted": true, "score": 3, "last_activity_date": 1425418178, "last_edit_date": 1495539914, "creation_date": 1425418178, "answer_id": 28842271, "question_id": 28838695, "link": "https://stackoverflow.com/questions/28838695/connecting-to-32-bit-oracle-client-with-64-bit-excel/28842271#28842271", "title": "Connecting to 32 bit Oracle client with 64 bit Excel", "body": "<p>Yes, when you use 64-bit Excel you must install also 64-bit Oracle Client and 64-bit OLE DB Provider.</p>\n\n<p>OLE DB Provider from Microsoft (i.e. <code>MSDAORA</code>) does not exist for 64-bit. It exists only for 32-bit and has been deprecated for very long time already.</p>\n\n<p>I don't know whether you need your 32-bit Oracle Client for something else, so maybe you cannot simply remove it from your PC. Here is an instruction how to install both 32-bit and 64-bit Oracle Client on one machine. \n<a href=\"https://stackoverflow.com/questions/24104210/badimageformatexception-this-will-occur-when-running-in-64-bit-mode-with-the-32#24120100\">Install Oracle Client x86 and x64</a></p>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 8067495, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-DRovEJmrZIY/AAAAAAAAAAI/AAAAAAAAZOY/63bMAlJC_8g/photo.jpg?sz=128", "display_name": "NeatCoder", "link": "https://stackoverflow.com/users/8067495/neatcoder"}, "is_accepted": false, "score": 1, "last_activity_date": 1511333094, "creation_date": 1511333094, "answer_id": 47428373, "question_id": 28838695, "link": "https://stackoverflow.com/questions/28838695/connecting-to-32-bit-oracle-client-with-64-bit-excel/47428373#47428373", "title": "Connecting to 32 bit Oracle client with 64 bit Excel", "body": "<p>I too had the same issue and the solution is to set the oracle drivers for the excel session to 32 Bit drivers and initiate the excel.</p>\n\n<p>I use the following Bat file to open the excel and it connects to oracle without any issues:</p>\n\n#\n\n<pre><code>Set Temp=C:\\Temp\nSet TMP=C:\\Temp\nSet Oracle_Home= #YourDriveLetterhere - &gt;M:\\ORA12C\\product\\12.1.0\\client_1\nSet Path=C:\\Windows;C:\\Windows\\System32;M:\\ORA12C\\product\\12.1.0\\client_1\\bin;M:\\ORA12C\\product\\12.1.0\\client_1\\nls\\mesg;M:\\ORA12C\\product\\12.1.0\\client_1\\network\\admin;\n\nSTART \"\" \"C:\\MacroFileNameWhichConnectsToOracle.xlsm\"\n</code></pre>\n\n#\n"}], "owner": {"reputation": 85, "user_id": 2859599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32315339d88c73b6261eff5c45c33b92?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Exter", "link": "https://stackoverflow.com/users/2859599/paul-exter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18478, "favorite_count": 1, "accepted_answer_id": 28842271, "answer_count": 3, "score": 5, "last_activity_date": 1511333094, "creation_date": 1425405626, "question_id": 28838695, "link": "https://stackoverflow.com/questions/28838695/connecting-to-32-bit-oracle-client-with-64-bit-excel", "title": "Connecting to 32 bit Oracle client with 64 bit Excel", "body": "<p>I'm trying to connect my Excel to Oracle with this connection string in VBA:</p>\n\n<pre><code>dim cn As New ADODB.Connection\ncn.Open \"Provider=OraOLEDB.Oracle;Data Source=source;User Id=userid;Password=pwd;\"\n</code></pre>\n\n<p>I'm getting this error:</p>\n\n<pre><code>Run-time error '3706':\nProvider cannot be found. It may not be properly installed.\n</code></pre>\n\n<p>Relevant references:</p>\n\n<pre><code>Microsoft ActiveX Data Objects 6.1 Library\nOraOLEDB 1.0 Type Library\n</code></pre>\n\n<ul>\n<li>Excel is MS Office Professional Plus 2010 64-bit </li>\n<li>Windows is 7 Enterprise, service pack 1, 64 bit</li>\n<li>Oracle client is 11.2.0 32 bit (I think)</li>\n<li>Oracle server is Oracle Database 11g Enterprise Edition Release 11.2.0.3.0 - 64bit Production</li>\n</ul>\n\n<p>Now... I have scoured the net and cannot figure out what the issue is, but my best guess is there's some 32 bit vs 64 bit conflict with drivers I'm using. I'm trying to get a sense of what path I should be taking before I involve my company's IT department to try installing stuff for me. Does the Oracle client have to be 64 bit if MS Office is? Or do I just need the 64 bit Oracle Data Access Components? I've tried a bunch of different connection strings with no success, including using MSDAORA instead of OraOLEDB.Oracle...</p>\n"}, {"tags": ["excel", "ms-access", "vba", "instance"], "answers": [{"comments": [{"owner": {"reputation": 607, "user_id": 3032689, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c7f8ee47c0aa5bced9939dde2491562f?s=128&d=identicon&r=PG&f=1", "display_name": "user3032689", "link": "https://stackoverflow.com/users/3032689/user3032689"}, "edited": false, "score": 0, "creation_date": 1454851875, "post_id": 28838849, "comment_id": 58220612, "body": "why do you need <code>XLHelper</code>?"}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "reply_to_user": {"reputation": 607, "user_id": 3032689, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c7f8ee47c0aa5bced9939dde2491562f?s=128&d=identicon&r=PG&f=1", "display_name": "user3032689", "link": "https://stackoverflow.com/users/3032689/user3032689"}, "edited": false, "score": 0, "creation_date": 1454853212, "post_id": 28838849, "comment_id": 58221026, "body": "You don&#39;t <i>need</i> it @user3032689. It could easily be a regular module or inline <code>GetExcelApp</code>&#39;s logic. I just prefer classes and functions because I think it results in cleaner code."}], "tags": [], "owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "is_accepted": false, "score": 1, "last_activity_date": 1425406497, "last_edit_date": 1425406497, "creation_date": 1425406116, "answer_id": 28838849, "question_id": 28838670, "link": "https://stackoverflow.com/questions/28838670/reference-to-current-excel-file-sheet/28838849#28838849", "title": "Reference to Current Excel file/Sheet", "body": "<p>This will get an open instance of Excel if it exists or create one if there isn't one.</p>\n\n<pre><code>Public Function GetExcelApp() As Excel.Application\n' Returns open excel instance.\n'   If it doesn't exist, creates one to return\nOn Error GoTo ErrHandler\nConst PROC_NAME As String = \"GetExcelApp\"\nConst ERR_APP_NOTRUNNING As Long = 429\n\n    Set GetExcelApp = GetObject(, \"Excel.Application\")\n\nCleanExit:\n    Exit Function\nErrHandler:\n    If Err.Number = ERR_APP_NOTRUNNING Then\n        Set GetExcelApp = CreateObject(\"Excel.Application\")\n    Else\n        Err.Raise Err.Number, GetErrorSource(PROC_NAME), Err.Description &amp; vbNewLine &amp; \"Unable to get instance of Excel.\", Err.HelpFile, Err.HelpContext\n    End If\nEnd Function\n</code></pre>\n\n<p>I keep this code in an <code>XLHelper</code> class and use it like this.</p>\n\n<pre><code>Dim helper As New XLHelper\nDim xl As Excel.Application\nDim wb As Excel.Workbook\nDim ws As Excel.Worksheet\n\nSet xl = helper.GetExcelApp\nSet wb = xl.Workbooks.Add\nSet ws = wb.Worksheets.Add\n</code></pre>\n\n<p>To get the reference of the new sheet/workbook, you just set it equal to the results of the collection's <code>Add</code> method.</p>\n\n<p>This works because <a href=\"https://msdn.microsoft.com/EN-US/library/office/ff840478.aspx\" rel=\"nofollow\"><code>Workbook.Add</code></a> and <code>Worksheets.Add</code> return the object they create.</p>\n"}], "owner": {"reputation": 111, "user_id": 4337094, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3e58f85c2321ed9adc833c81c473194b?s=128&d=identicon&r=PG&f=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/4337094/fred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 477, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1425406497, "creation_date": 1425405532, "question_id": 28838670, "link": "https://stackoverflow.com/questions/28838670/reference-to-current-excel-file-sheet", "title": "Reference to Current Excel file/Sheet", "body": "<p>I made a wizard button on a Access form where you can transfer the data of a Query to a new excel file and then the new file will automatically open. \nIs there a way to make a reference to this new file or Sheet, because i want to put something in this new file.</p>\n"}, {"tags": ["vba", "excel", "automation"], "answers": [{"tags": [], "owner": {"reputation": 571, "user_id": 4479888, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/dd43c6c7f3571cafaaa827796006d0a9?s=128&d=identicon&r=PG&f=1", "display_name": "JMichael", "link": "https://stackoverflow.com/users/4479888/jmichael"}, "is_accepted": true, "score": 0, "last_activity_date": 1425477487, "creation_date": 1425477487, "answer_id": 28856335, "question_id": 28838209, "link": "https://stackoverflow.com/questions/28838209/excel-vba-formatting-script-for-automation/28856335#28856335", "title": "Excel VBA - Formatting script for automation", "body": "<p>A couple things that are good practice to get into before I get to your actual question:</p>\n\n<p>1) Any macro that you expect to run a long time should have <code>Application.ScreenUpdating = False</code> before any actual work is done in the code, this tells Excel not to bother with changing what's displayed on the screen (big performance booster). Be sure to include an <code>Application.ScreenUpdating = True</code> near the end of your code</p>\n\n<p>2) Similar to #1, you generally want to include <code>Application.Calculation = xlManual</code> to boost performance. If you have large ranges of cells that your macro needs accurate up-to-date values from, it may be easier to leave the calculation automatic, but that doesn't appear to be the case in this instance.</p>\n\n<p>3) You don't need to create a new Excel instance (which is what your first line of code does). You're already in a perfectly good instance of Excel. This also saves you having to close the other instance at the end of the macro (or worse from forgetting to do so and having memory get hogged by Excel processes that aren't really in use)</p>\n\n<p>As to your specific problem, it sounds like you have more workbooks that Pc_profile to copy from, and that you're wanting to create a new \"db.xls\" with each run of the macro. Based on those assumptions all you need to do is nest your code starting with <code>'Open the workbook</code> and <code>objWorkbook.Worksheets(\"Sheet1\").Range(\"A14\").PasteSpecial</code> inside a Do While loop. The thing I'm not sure about is how to control the loop. If the list of files is always the same, you should just include a list on a sheet in the workbook that holds the macro and just iterate through that.</p>\n\n<p>The other thing you should do for ease of coding, and to make the loop more effective is declare and use a Worksheet variable and set if for each workbook to the appropriate sheet to pull data from. Ex.</p>\n\n<pre><code>Dim ws as Worksheet\n\n'The Dim is outside your loop, but this would be inside it\nSet ws = objWorkbook.Worksheets(\"whatever_the_sheet's_name_is\")\n</code></pre>\n\n<p>This way you can replace each occurrence of <code>objWorkbook.Worksheets(\"Pc_Profile\").</code> with <code>ws.</code>, easier to type, easier to read, easier to update, and less error prone.</p>\n\n<p>Next, you don't actually have code for moving Sheet1 to a new workbook, or renaming it. To move it (as well as the other Sheet1's yet to be created), you should, before getting to the Do While loop, have the following </p>\n\n<pre><code>Dim target as Workbook\nSet target = Application.Workbooks.Add\n</code></pre>\n\n<p>Then at almost the end of the loop, you need <code>objWorkbook.Worksheets(\"Sheet1\").Move Before:=Target.Sheets(1)</code></p>\n\n<p>Last, you need to include <code>objWorkbook.Close SaveChanges:=False</code> after you've moved Sheet1 out of the Pc_Profile and renamed it.</p>\n"}], "owner": {"reputation": 13, "user_id": 4079603, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qhKcS.png?s=128&g=1", "display_name": "Sicatron", "link": "https://stackoverflow.com/users/4079603/sicatron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1204, "favorite_count": 0, "accepted_answer_id": 28856335, "answer_count": 1, "score": 0, "last_activity_date": 1425477487, "creation_date": 1425404007, "question_id": 28838209, "link": "https://stackoverflow.com/questions/28838209/excel-vba-formatting-script-for-automation", "title": "Excel VBA - Formatting script for automation", "body": "<p>So here's what I'm trying to do:</p>\n\n<ol>\n<li>Open file: Pc_Profile</li>\n<li>Create new sheet: Sheet1</li>\n<li>Copy desired cells from Pc_Profile to Sheet1 (see script below)</li>\n<li>Copy entire Sheet1 to new excel file: db.xls</li>\n<li>Rename sheet to content of cell A5</li>\n<li>Create new sheet for next script run</li>\n</ol>\n\n<p>Basically I'm trying to automate an extraction of a TON of excel files into a single organized file. Each script call should extract to its own sheet so there's no overwritten information.</p>\n\n<p>Here is what I have working so far. It just copies the desired cells to a new sheet within the same file. </p>\n\n<pre><code>' Create Excel object\nSet objExcel = CreateObject(\"Excel.Application\")\n\n' Open the workbook\nSet objWorkbook = objExcel.Workbooks.Open _\n    (\"\\\\[directory]\\Pc_Profile.xls\")\n\n' Set to True or False, whatever you like\nobjExcel.Visible = True\n\n\nobjWorkbook.Worksheets(\"Pc_Profile\").Range(\"A5:D5\").Copy\nobjWorkbook.Worksheets(\"Sheet1\").Range(\"A1\").PasteSpecial\n\nobjWorkbook.Worksheets(\"Pc_Profile\").Range(\"A8:B8\").Copy\nobjWorkbook.Worksheets(\"Sheet1\").Range(\"A2\").PasteSpecial\n\nobjWorkbook.Worksheets(\"Pc_Profile\").Range(\"A13:B13\").Copy\nobjWorkbook.Worksheets(\"Sheet1\").Range(\"A3\").PasteSpecial\n\nobjWorkbook.Worksheets(\"Pc_Profile\").Range(\"A15:D17\").Copy\nobjWorkbook.Worksheets(\"Sheet1\").Range(\"A4\").PasteSpecial\n\nobjWorkbook.Worksheets(\"Pc_Profile\").Range(\"A24:E26\").Copy\nobjWorkbook.Worksheets(\"Sheet1\").Range(\"A7\").PasteSpecial\n\nobjWorkbook.Worksheets(\"Pc_Profile\").Range(\"A28:B30\").Copy\nobjWorkbook.Worksheets(\"Sheet1\").Range(\"A10\").PasteSpecial\n\nobjWorkbook.Worksheets(\"Pc_Profile\").Range(\"A43:B43\").Copy\nobjWorkbook.Worksheets(\"Sheet1\").Range(\"A13\").PasteSpecial\n\nobjWorkbook.Worksheets(\"Pc_Profile\").Range(\"A45:B45\").Copy\nobjWorkbook.Worksheets(\"Sheet1\").Range(\"A14\").PasteSpecial\n\n' Activate Sheet2 so you can see it actually pasted the data\nobjWorkbook.Worksheets(\"Sheet2\").Activate \n</code></pre>\n\n<p>I would really appreciate the extra push. I'm automating this for a work project and have no experience with VB - I just learned that on the go. </p>\n"}, {"tags": ["excel", "vba", "macos"], "owner": {"reputation": 6310, "user_id": 443600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/991a715e043630b0a7d9f3e8e7bad254?s=128&d=identicon&r=PG", "display_name": "yorch", "link": "https://stackoverflow.com/users/443600/yorch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 385, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1593759299, "creation_date": 1425403085, "last_edit_date": 1593759299, "question_id": 28837945, "link": "https://stackoverflow.com/questions/28837945/exporting-single-sheet-to-html", "title": "Exporting single sheet to HTML", "body": "<p>I'm trying to export a single sheet (not the whole workbook) as HTML using VBA.</p>\n\n<p>When I record a macro exporting to HTML a single sheet, I get this code:</p>\n\n<pre><code>Range(\"C36\").Select\nActiveWorkbook.SaveAs filename:= _\n    \"Macintosh HD:Users:user:Desktop:Dashboard.htm\", FileFormat:=xlHtml, _\n    PublishOption:=xlSheet\n</code></pre>\n\n<p>And the exported HTML only contains the sheet I wanted, so everything's fine till this point.</p>\n\n<p>The problem comes when I try to run the code, it creates an HTML file that contains the whole workbook and not only the sheet I wanted.</p>\n\n<p>I've looked at <a href=\"https://msdn.microsoft.com/en-us/library/office/ff841185(v=office.14).aspx\" rel=\"nofollow\">MSDN documentation</a>, and the <code>SaveAs</code> method doesn't seem to have a <code>PublishOption</code> parameter.</p>\n\n<p>Any clues?</p>\n"}, {"tags": ["vba", "hp-quality-center", "alm"], "comments": [{"owner": {"reputation": 18939, "user_id": 2756409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UIrGI.jpg?s=128&g=1", "display_name": "TylerH", "link": "https://stackoverflow.com/users/2756409/tylerh"}, "reply_to_user": {"reputation": 11359, "user_id": 1624450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Lfzcq.png?s=128&g=1", "display_name": "Pieter Geerkens", "link": "https://stackoverflow.com/users/1624450/pieter-geerkens"}, "edited": false, "score": 0, "creation_date": 1597417748, "post_id": 28837669, "comment_id": 112134865, "body": "@PieterGeerkens Nothing; QC stands for Quality Center - it&#39;s a product of Micro Focus - <a href=\"https://www.microfocus.com/en-us/products/alm-quality-center/overview\" rel=\"nofollow noreferrer\">microfocus.com/en-us/products/alm-quality-center/overview</a>"}], "answers": [{"tags": [], "owner": {"reputation": 27, "user_id": 3964938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba4864c4ea39f030aa1d4f468446a5c8?s=128&d=identicon&r=PG&f=1", "display_name": "Asjad Azeez", "link": "https://stackoverflow.com/users/3964938/asjad-azeez"}, "is_accepted": true, "score": 0, "last_activity_date": 1425483335, "creation_date": 1425483335, "answer_id": 28858456, "question_id": 28837669, "link": "https://stackoverflow.com/questions/28837669/how-to-find-test-cases-by-name-in-qc-using-vba/28858456#28858456", "title": "How to find test cases by name in QC using VBA", "body": "<p>Send a query using the TD connection object</p>\n\n<pre><code>set oCommand=oTDC.Command\noCommand.CommandText=\"Select * from TEST where TS_NAME Like'testname'\"\noRecordSet.Execute\nDo until recordset.EOR=true\n/Get your test case details\nrecordset.next\nLoop\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 3964938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba4864c4ea39f030aa1d4f468446a5c8?s=128&d=identicon&r=PG&f=1", "display_name": "Asjad Azeez", "link": "https://stackoverflow.com/users/3964938/asjad-azeez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 572, "favorite_count": 0, "accepted_answer_id": 28858456, "answer_count": 1, "score": -1, "last_activity_date": 1425483335, "creation_date": 1425402213, "question_id": 28837669, "link": "https://stackoverflow.com/questions/28837669/how-to-find-test-cases-by-name-in-qc-using-vba", "title": "How to find test cases by name in QC using VBA", "body": "<p>So i trying to find test cases by name in QC\nI can find test case by nodeID,Path etc. but not by name.\nWhat i am trying to do is Something like QC Menu->Edit->Find (Enter your test case name)\nCan this be done using OTA ?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 720, "user_id": 4462199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207bfe17a53f44de4205356ebb873b6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dubison", "link": "https://stackoverflow.com/users/4462199/dubison"}, "edited": false, "score": 0, "creation_date": 1425401901, "post_id": 28837180, "comment_id": 45944477, "body": "dont you have a password? <code>Sheet1.Unprotect Password:=&quot;Your Password&quot;</code>"}, {"owner": {"reputation": 4174, "user_id": 2085376, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/30f3b025f3dc54a77e38495c7a44a1c9?s=128&d=identicon&r=PG", "display_name": "NoIdeaHowToFixThis", "link": "https://stackoverflow.com/users/2085376/noideahowtofixthis"}, "reply_to_user": {"reputation": 720, "user_id": 4462199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207bfe17a53f44de4205356ebb873b6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dubison", "link": "https://stackoverflow.com/users/4462199/dubison"}, "edited": false, "score": 0, "creation_date": 1425402040, "post_id": 28837180, "comment_id": 45944561, "body": "Good idea but no, I did not set the password. Btw, <code>Sheet1.Unprotect Sheet1.Cells(13, &quot;E&quot;).Locked = False Sheet1.Protect</code> runs smoothly"}, {"owner": {"reputation": 720, "user_id": 4462199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207bfe17a53f44de4205356ebb873b6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dubison", "link": "https://stackoverflow.com/users/4462199/dubison"}, "edited": false, "score": 1, "creation_date": 1425402549, "post_id": 28837180, "comment_id": 45944903, "body": "I just tried your code, it worked fine for me. But I made a mistake with that. maybe you are doing the same thing. While while giving the sheet name as <code>Sheet1</code> does not mean <code>Sheets(&quot;Sheet 1&quot;)</code>. <code>Sheet1</code> means the first sheet in the workbook. Pay attention to that. :)"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1425406450, "post_id": 28837180, "comment_id": 45947123, "body": "Why set Locked to false when the sheet is already unprotected? When you reprotect the sheet (assuming no error) then that cell will be unprotected... unless of course that&#39;s your desired behavior."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1425406504, "post_id": 28837180, "comment_id": 45947146, "body": "Also, what happens if you remove the <code>Sheet1.Protect</code>, run the macro and exit at the error, then try to set the Style manually?"}, {"owner": {"reputation": 4174, "user_id": 2085376, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/30f3b025f3dc54a77e38495c7a44a1c9?s=128&d=identicon&r=PG", "display_name": "NoIdeaHowToFixThis", "link": "https://stackoverflow.com/users/2085376/noideahowtofixthis"}, "edited": false, "score": 0, "creation_date": 1425470292, "post_id": 28837180, "comment_id": 45973855, "body": "I see odd behaviour: <code>Sheet1.Range(&quot;E13&quot;).Style.Name = &quot;Percent&quot;</code> results in <code>Wrong number of arguments or invalid property assignment</code> (on an unprotected sheet)"}], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 4660494, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-H07LXV_bAXo/AAAAAAAAAAI/AAAAAAAAAZo/mB27gC6iVAc/photo.jpg?sz=128", "display_name": "Roger Currier", "link": "https://stackoverflow.com/users/4660494/roger-currier"}, "is_accepted": true, "score": 1, "last_activity_date": 1483734923, "creation_date": 1483734923, "answer_id": 41513922, "question_id": 28837180, "link": "https://stackoverflow.com/questions/28837180/unprotect-and-change-style-with-vba/41513922#41513922", "title": "Unprotect and change style with vba", "body": "<p>Had the same problem with the, 'The cell or chart you're trying to change is on a protected sheet. To make changes, click on Unprotect Sheet in the Review tab (...)', error message coming up.  </p>\n\n<p>Realized I had protection on an another worksheet in the workbook which had to be turned off before I could modify the Normal style. Makes sense if you think about it!</p>\n\n<p>Once all protection was turned off I can modify the Normal Style.</p>\n\n<p>Rogerc</p>\n"}], "owner": {"reputation": 4174, "user_id": 2085376, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/30f3b025f3dc54a77e38495c7a44a1c9?s=128&d=identicon&r=PG", "display_name": "NoIdeaHowToFixThis", "link": "https://stackoverflow.com/users/2085376/noideahowtofixthis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 955, "favorite_count": 0, "accepted_answer_id": 41513922, "answer_count": 1, "score": -1, "last_activity_date": 1483734923, "creation_date": 1425400920, "last_edit_date": 1531161705, "question_id": 28837180, "link": "https://stackoverflow.com/questions/28837180/unprotect-and-change-style-with-vba", "title": "Unprotect and change style with vba", "body": "<pre><code>Sheet1.Unprotect\nSheet1.Cells(13, \"E\").Locked = False\nSheet1.Range(\"E13\").Style.Name = \"Normal\"\nSheet1.Protect\n</code></pre>\n\n<p>Produces:</p>\n\n<blockquote>\n  <p>The cell or chart you're trying to change is on a protected sheet.\n  To make changes, click on Unprotect Sheet in the Review tab (...)</p>\n</blockquote>\n\n<p>On the other hand:</p>\n\n<pre><code>Sheet1.Unprotect\nSheet1.Cells(13, \"E\").Locked = False\nSheet1.Protect\n</code></pre>\n\n<p>runs instead properly.</p>\n"}, {"tags": ["vba", "sorting", "excel", "set"], "answers": [{"comments": [{"owner": {"reputation": 2291, "user_id": 2340690, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/25svl.jpg?s=128&g=1", "display_name": "cheezsteak", "link": "https://stackoverflow.com/users/2340690/cheezsteak"}, "reply_to_user": {"reputation": 179, "user_id": 4581009, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e687e8e16444ce76b07e9ada1cd27bf4?s=128&d=identicon&r=PG&f=1", "display_name": "Philip", "link": "https://stackoverflow.com/users/4581009/philip"}, "edited": false, "score": 0, "creation_date": 1425401511, "post_id": 28837244, "comment_id": 45944214, "body": "@Philip <code>Sheet9</code> implicitly refers to the 9th sheet of your workbook.  Do you have 9 sheets in your workbook?  Does <code>Sheets(9)</code> return an &quot;subscript out of range&quot; error?"}, {"owner": {"reputation": 179, "user_id": 4581009, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e687e8e16444ce76b07e9ada1cd27bf4?s=128&d=identicon&r=PG&f=1", "display_name": "Philip", "link": "https://stackoverflow.com/users/4581009/philip"}, "edited": false, "score": 0, "creation_date": 1425401604, "post_id": 28837244, "comment_id": 45944275, "body": "Yes <code>Sheet9</code> is a valid sheet."}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1425401806, "post_id": 28837244, "comment_id": 45944413, "body": "Which line throws the error? Is it possible that <code>Key:=rng2</code> is causing the error? Does <code>rng2</code> refer to a range on <code>Sheet9</code>"}, {"owner": {"reputation": 179, "user_id": 4581009, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e687e8e16444ce76b07e9ada1cd27bf4?s=128&d=identicon&r=PG&f=1", "display_name": "Philip", "link": "https://stackoverflow.com/users/4581009/philip"}, "edited": false, "score": 0, "creation_date": 1425401952, "post_id": 28837244, "comment_id": 45944509, "body": "No the line that throws the error is:  <code>.SetRange (Sheet9.Range(&quot;A1&quot;).CurrentRegion)</code>"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1425401977, "post_id": 28837244, "comment_id": 45944528, "body": "Interestingly enough, when I remove the parenthesis around <code>Sheet9.Range(&quot;A1&quot;).CurrentRegion</code> it seems to work. Can you test that and report back?"}, {"owner": {"reputation": 179, "user_id": 4581009, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e687e8e16444ce76b07e9ada1cd27bf4?s=128&d=identicon&r=PG&f=1", "display_name": "Philip", "link": "https://stackoverflow.com/users/4581009/philip"}, "edited": false, "score": 0, "creation_date": 1425402115, "post_id": 28837244, "comment_id": 45944621, "body": "Ok now it works but when it tries to apply it it says the sort reference is not valid...Any thoughts?"}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": true, "score": 1, "last_activity_date": 1425407937, "last_edit_date": 1425407937, "creation_date": 1425401077, "answer_id": 28837244, "question_id": 28837175, "link": "https://stackoverflow.com/questions/28837175/set-range-in-vba-sort/28837244#28837244", "title": "Set range in VBA sort", "body": "<p>EDITED BASED ON COMMENTS:</p>\n\n<p>I entered the below code into a mock spreadsheet that I created and it seems to work fine. The error described in the comments: <code>Sort Reference is not valid</code> indicates that there's possibly an issue in defining the key. Try to use my code (replace with necessary information) and let me know if it works.</p>\n\n<pre><code>Sub Doit()\n\n    Set rng2 = Sheet1.Range(\"A1:A5\")\n\n    With Sheet1.Sort\n        .SortFields.Clear\n        .SortFields.Add Key:=rng2, SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n        .SetRange Sheet1.Range(\"A1\").CurrentRegion\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Based on the ability to use <code>.End</code> for both rows and columns, I assume you have a contiguous data set. If so, instead of complicating matters, simply use:</p>\n\n<p><code>Range(\"A1\").CurrentRegion</code> to set your range object.</p>\n\n<p>This recognizes the entire dataset that is built around <code>Range(\"A1\")</code></p>\n"}], "owner": {"reputation": 179, "user_id": 4581009, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e687e8e16444ce76b07e9ada1cd27bf4?s=128&d=identicon&r=PG&f=1", "display_name": "Philip", "link": "https://stackoverflow.com/users/4581009/philip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8205, "favorite_count": 0, "accepted_answer_id": 28837244, "answer_count": 1, "score": 1, "last_activity_date": 1425407937, "creation_date": 1425400897, "last_edit_date": 1425401304, "question_id": 28837175, "link": "https://stackoverflow.com/questions/28837175/set-range-in-vba-sort", "title": "Set range in VBA sort", "body": "<p>I am trying to sort data in Excel VBA.  My sheet could have a variable amount of data so I am using the <code>Range.End</code> method to find the last row/ column of the sheet.  Though, when I try to set the range for the sort it gives me an Object Required error and I am not sure why.  I have pasted my code below. Any help would be greatly appreciated.</p>\n\n<pre><code>With Sheet9.Sort\n    .SetRange (Sheet9.Range(\"A1\").CurrentRegion)\n    .SortFields.Clear\n    .SortFields.Add Key:=rng2, SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n</code></pre>\n"}, {"tags": ["vb.net", "visual-studio-2010", "visual-studio", "vba", "visual-studio-2012"], "comments": [{"owner": {"reputation": 12321, "user_id": 770270, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e658b4994f3a50e22daf9da655ec2282?s=128&d=identicon&r=PG", "display_name": "tnw", "link": "https://stackoverflow.com/users/770270/tnw"}, "edited": false, "score": 1, "creation_date": 1425400916, "post_id": 28837112, "comment_id": 45943813, "body": "Are you writing this in <code>Visual Basic</code> or <code>C#</code>? Please show your code."}, {"owner": {"reputation": 21, "user_id": 4220458, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/985006c11249b09ff4e62dc873ae4c3f?s=128&d=identicon&r=PG&f=1", "display_name": "Nazif Jaafar", "link": "https://stackoverflow.com/users/4220458/nazif-jaafar"}, "reply_to_user": {"reputation": 12321, "user_id": 770270, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e658b4994f3a50e22daf9da655ec2282?s=128&d=identicon&r=PG", "display_name": "tnw", "link": "https://stackoverflow.com/users/770270/tnw"}, "edited": false, "score": 0, "creation_date": 1425401019, "post_id": 28837112, "comment_id": 45943872, "body": "I&#39;m using Microsoft visual studio 2013"}, {"owner": {"reputation": 21, "user_id": 4220458, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/985006c11249b09ff4e62dc873ae4c3f?s=128&d=identicon&r=PG&f=1", "display_name": "Nazif Jaafar", "link": "https://stackoverflow.com/users/4220458/nazif-jaafar"}, "reply_to_user": {"reputation": 12321, "user_id": 770270, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e658b4994f3a50e22daf9da655ec2282?s=128&d=identicon&r=PG", "display_name": "tnw", "link": "https://stackoverflow.com/users/770270/tnw"}, "edited": false, "score": 0, "creation_date": 1425401322, "post_id": 28837112, "comment_id": 45944075, "body": "I edited to show the code."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 4220458, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/985006c11249b09ff4e62dc873ae4c3f?s=128&d=identicon&r=PG&f=1", "display_name": "Nazif Jaafar", "link": "https://stackoverflow.com/users/4220458/nazif-jaafar"}, "edited": false, "score": 0, "creation_date": 1425405672, "post_id": 28838509, "comment_id": 45946705, "body": "Hi, when i try it there is still no any point plotted in the chart."}, {"owner": {"reputation": 21, "user_id": 4220458, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/985006c11249b09ff4e62dc873ae4c3f?s=128&d=identicon&r=PG&f=1", "display_name": "Nazif Jaafar", "link": "https://stackoverflow.com/users/4220458/nazif-jaafar"}, "edited": false, "score": 0, "creation_date": 1425406263, "post_id": 28838509, "comment_id": 45947018, "body": "here&#39;s the image:  <a href=\"http://i.imgur.com/Rrdpg60.png\" rel=\"nofollow noreferrer\">i.imgur.com/Rrdpg60.png</a>   is there any ways to put the exactly values on the chart?"}, {"owner": {"reputation": 21, "user_id": 4220458, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/985006c11249b09ff4e62dc873ae4c3f?s=128&d=identicon&r=PG&f=1", "display_name": "Nazif Jaafar", "link": "https://stackoverflow.com/users/4220458/nazif-jaafar"}, "edited": false, "score": 0, "creation_date": 1425408118, "post_id": 28838509, "comment_id": 45948093, "body": "Hi, there&#39;s some improvement here  !<a href=\"http://i.imgur.com/dxeXlUE.png\" rel=\"nofollow noreferrer\">IMAGE</a>  How to shows the line?"}, {"owner": {"reputation": 186, "user_id": 4585791, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3699aa68e22875c2560d9498947f462a?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Wertz", "link": "https://stackoverflow.com/users/4585791/robert-wertz"}, "reply_to_user": {"reputation": 21, "user_id": 4220458, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/985006c11249b09ff4e62dc873ae4c3f?s=128&d=identicon&r=PG&f=1", "display_name": "Nazif Jaafar", "link": "https://stackoverflow.com/users/4220458/nazif-jaafar"}, "edited": false, "score": 0, "creation_date": 1425417026, "post_id": 28838509, "comment_id": 45953010, "body": "I think that might be under the chart settings, usually you have a couple options there that you might explore"}, {"owner": {"reputation": 21, "user_id": 4220458, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/985006c11249b09ff4e62dc873ae4c3f?s=128&d=identicon&r=PG&f=1", "display_name": "Nazif Jaafar", "link": "https://stackoverflow.com/users/4220458/nazif-jaafar"}, "edited": false, "score": 0, "creation_date": 1425428839, "post_id": 28838509, "comment_id": 45958081, "body": "Do i need 3rd party apps?"}], "tags": [], "owner": {"reputation": 186, "user_id": 4585791, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3699aa68e22875c2560d9498947f462a?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Wertz", "link": "https://stackoverflow.com/users/4585791/robert-wertz"}, "is_accepted": true, "score": 1, "last_activity_date": 1425405005, "creation_date": 1425405005, "answer_id": 28838509, "question_id": 28837112, "link": "https://stackoverflow.com/questions/28837112/how-do-i-create-a-line-chart-in-visual-studio/28838509#28838509", "title": "How do I create a line chart in visual studio?", "body": "<p>For the settings in the report chart, I would suggest moving OLD and LimitPower to the \"Values\" section in the chart data and moving time to series groups. </p>\n"}], "owner": {"reputation": 21, "user_id": 4220458, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/985006c11249b09ff4e62dc873ae4c3f?s=128&d=identicon&r=PG&f=1", "display_name": "Nazif Jaafar", "link": "https://stackoverflow.com/users/4220458/nazif-jaafar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4017, "favorite_count": 1, "accepted_answer_id": 28838509, "answer_count": 1, "score": 0, "last_activity_date": 1425450690, "creation_date": 1425400739, "last_edit_date": 1425450690, "question_id": 28837112, "link": "https://stackoverflow.com/questions/28837112/how-do-i-create-a-line-chart-in-visual-studio", "title": "How do I create a line chart in visual studio?", "body": "<p>I want to create a line chart in visual studio as shown in the picture in Excel below:</p>\n\n<p><img src=\"https://i.stack.imgur.com/TL1S2.png\" alt=\"Table with line chart\"></p>\n\n<p>Before I went to Visual Studio, I tried to create a table in Microsoft access as shown in the picture below, but I am still not sure of the steps to create a chart in visual basic:</p>\n\n<p><img src=\"https://i.stack.imgur.com/al5av.png\" alt=\"enter image description here\"></p>\n\n<p>Then, in visual studio, I continued by adding a report viewer and DataGridView. In the picture shown below you can see my Form1 interface:</p>\n\n<p><img src=\"https://i.stack.imgur.com/QYYZ7.png\" alt=\"Table and report viewer\"></p>\n\n<p>Here are the settings in my report chart:\n<img src=\"https://i.stack.imgur.com/LmzGT.png\" alt=\"enter image description here\"></p>\n\n<p>However the result produces this:\n<img src=\"https://i.stack.imgur.com/r9CSZ.png\" alt=\"enter image description here\"></p>\n\n<p>Here's the code :</p>\n\n<pre><code>Public Class Form1\n\nPrivate Sub Table1BindingNavigatorSaveItem_Click(sender As Object, e As EventArgs) Handles Table1BindingNavigatorSaveItem.Click\n    Me.Validate()\n    Me.Table1BindingSource.EndEdit()\n    Me.TableAdapterManager.UpdateAll(Me._5DataSet)\n\nEnd Sub\n\nPrivate Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load\n    'TODO: This line of code loads data into the '_5DataSet.Table1' table. You can move, or remove it, as needed.\n    Me.Table1TableAdapter.Fill(Me._5DataSet.Table1)\n\n    Me.ReportViewer1.RefreshReport()\n\nEnd Sub\n\nPrivate Sub Chart1_Click(sender As Object, e As EventArgs)\n\nEnd Sub\n\nPrivate Sub ReportViewer1_Load(sender As Object, e As EventArgs) Handles ReportViewer1.Load\n\nEnd Sub\nEnd Class\n</code></pre>\n\n<p>My question is, how do I make change this so that the x-axis shows the values 1 to 24 with all the values in the chart the same as my plot in excel?</p>\n"}, {"tags": ["vba", "outlook", "asp-classic"], "comments": [{"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1425401824, "post_id": 28836888, "comment_id": 45944429, "body": "What do you do with Outlook?  Are you running against an Exchange mailbox?"}, {"owner": {"reputation": 71, "user_id": 1194621, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/c572525a5d702d05f9d3f8abe14ab88e?s=128&d=identicon&r=PG", "display_name": "Olly Stredwick", "link": "https://stackoverflow.com/users/1194621/olly-stredwick"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1425402043, "post_id": 28836888, "comment_id": 45944567, "body": "It&#39;s to create a meeting request and yes, the server running the code has outlook 2013 installed and connected to an exchange account"}, {"owner": {"reputation": 18817, "user_id": 65775, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0f073b7950ca9f3807627e7a89b814b9?s=128&d=identicon&r=PG", "display_name": "Keith", "link": "https://stackoverflow.com/users/65775/keith"}, "edited": false, "score": 0, "creation_date": 1425403601, "post_id": 28836888, "comment_id": 45945567, "body": "I don&#39;t have a full blown answer for you, but try one or both of the following: 1) Configure the DCOM permissions (Start &gt; Run &gt; dcomcnfg) for Outlook, 2) Use a different IIS user, or give the current IIS user elevated permissions."}, {"owner": {"reputation": 18817, "user_id": 65775, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0f073b7950ca9f3807627e7a89b814b9?s=128&d=identicon&r=PG", "display_name": "Keith", "link": "https://stackoverflow.com/users/65775/keith"}, "edited": false, "score": 0, "creation_date": 1425403763, "post_id": 28836888, "comment_id": 45945648, "body": "And..it is possible to use Outlook and any other Office app from IIS. It&#39;s certainly not recommended and it&#39;s a pain to get it working right but sometimes you have no choice."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1425406242, "post_id": 28836888, "comment_id": 45947005, "body": "There is a good reason why it is not recommended - it tends to blow up at the most inappropriate moment. Like when you deploy your solution in production. If you are fine with that, go ahead."}], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 2, "last_activity_date": 1425400445, "creation_date": 1425400445, "answer_id": 28836999, "question_id": 28836888, "link": "https://stackoverflow.com/questions/28836888/permission-denied-createobjectoutlook-application-asp-classic/28836999#28836999", "title": "Permission denied createobject(&quot;outlook.application&quot;) asp classic", "body": "<p><strong>Microsoft does not currently recommend, and does not support, Automation of Microsoft Office applications from any unattended, non-interactive client application or component (including ASP, ASP.NET, DCOM, and NT Services), because Office may exhibit unstable behavior and/or deadlock when Office is run in this environment.</strong></p>\n\n<p>If you are building a solution that runs in a server-side context, you should try to use components that have been made safe for unattended execution. Or, you should try to find alternatives that allow at least part of the code to run client-side. If you use an Office application from a server-side solution, the application will lack many of the necessary capabilities to run successfully. Additionally, you will be taking risks with the stability of your overall solution.</p>\n\n<p>You can read more about that in the <a href=\"https://support.microsoft.com/kb/257757/en-us?wa=wsignin1.0\" rel=\"nofollow\">Considerations for server-side Automation of Office</a> article.</p>\n"}, {"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": -2, "last_activity_date": 1425403367, "creation_date": 1425403367, "answer_id": 28838029, "question_id": 28836888, "link": "https://stackoverflow.com/questions/28836888/permission-denied-createobjectoutlook-application-asp-classic/28838029#28838029", "title": "Permission denied createobject(&quot;outlook.application&quot;) asp classic", "body": "<p>Outlook or any other Office app cannot be used in a service (such as IIS). In your particular case, <a href=\"https://msdn.microsoft.com/en-us/library/office/dd877045(v=exchg.140).aspx\" rel=\"nofollow\">EWS</a> is a good alternative.</p>\n"}], "owner": {"reputation": 71, "user_id": 1194621, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/c572525a5d702d05f9d3f8abe14ab88e?s=128&d=identicon&r=PG", "display_name": "Olly Stredwick", "link": "https://stackoverflow.com/users/1194621/olly-stredwick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 991, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1592896008, "creation_date": 1425400165, "last_edit_date": 1592896008, "question_id": 28836888, "link": "https://stackoverflow.com/questions/28836888/permission-denied-createobjectoutlook-application-asp-classic", "title": "Permission denied createobject(&quot;outlook.application&quot;) asp classic", "body": "<p>I am trying to create the object outlook.application using the code below</p>\n\n<pre><code>test = createobject(\"outlook.application\")\n</code></pre>\n\n<p>However when this is run I receive the following error</p>\n\n<p>Microsoft VBScript runtime error '800a0046'</p>\n\n<p>Permission denied: 'createobject'</p>\n\n<p>Any help would be appreciated </p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 1, "creation_date": 1425400512, "post_id": 28836848, "comment_id": 45943525, "body": "Even if this were to work, you are not actually checking the password vs. the login value.  You are checking whether the login name exists and whether the password exists, but they don&#39;t need to belong to the same user.  Try to debug.print the &quot;DLookup&quot; part of the isnull statements and find out what is being returned.  I&#39;m guessing at least one of them is always returning Null."}], "answers": [{"comments": [{"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "reply_to_user": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "edited": false, "score": 0, "creation_date": 1425402358, "post_id": 28837323, "comment_id": 45944777, "body": "You are welcome. If you found this useful, please mark it as answered (the green tick) and/or vote up ! Thanks. :)"}], "tags": [], "owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "is_accepted": true, "score": 3, "last_activity_date": 1425401314, "creation_date": 1425401314, "answer_id": 28837323, "question_id": 28836848, "link": "https://stackoverflow.com/questions/28836848/creating-login-form-on-access-using-vba/28837323#28837323", "title": "Creating Login form on Access using VBA", "body": "<p>You are not comparing the right information. You should be checking if the <code>Password</code> entered for that <code>Username</code> exists in the table. So your code should be changed to just one single DLookup, as.</p>\n\n<pre><code>Private Sub Command1_Click()\n    If IsNull(Me.txtLogin) Then\n        MsgBox \"Please Enter Login\", vbInformation, \"Need ID\"\n        Me.txtLogin.SetFocus\n    ElseIf IsNull(Me.txtPassword) Then\n        MsgBox \"Please Enter Password\",vbInformation, \"Need Password\"    \n        Me.txtPassword.SetFocus\n    Else\n        If Nz(DLookup(\"Password\", \"Preparer\", \"Login = '\" &amp; Me.txtLogin.Value &amp; \"'\")), \"GarbageEntry\") = Me.txtPassword Then\n            DoCmd.Close    \n            MsgBox \"Success\"\n            DoCmd.OpenForm \"Master\"\n        Else\n            MsgBox \"Incorrect Login or Password\"\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>In the above code, you first use the DLookup to retrieve the Password for the username. IF the username matches, a Password will be returned, ELSE a default value of \"<strong>GarbageEntry</strong>\" is returned. So the Right password (or) GarbageEntry is compared with the actual password entered. If they are the same then you give them access. Else a message. </p>\n\n<p>Hope this helps !</p>\n"}], "owner": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19514, "favorite_count": 0, "accepted_answer_id": 28837323, "answer_count": 1, "score": 1, "last_activity_date": 1495768533, "creation_date": 1425400050, "last_edit_date": 1425400433, "question_id": 28836848, "link": "https://stackoverflow.com/questions/28836848/creating-login-form-on-access-using-vba", "title": "Creating Login form on Access using VBA", "body": "<p>I am trying to create a login for my Access db, but I can't get it to work. Here is my code (keep in mind \"Preparer\" is the name of the table holding username and password info:</p>\n\n<pre><code>Private Sub Command1_Click()\n\n    If IsNull(Me.txtLogin) Then\n\n        MsgBox \"Please Enter Login\", vbInformation, \"Need ID\"\n        Me.txtLogin.SetFocus\n\n    ElseIf IsNull(Me.txtPassword) Then\n\n        MsgBox \"Please Enter Password\",vbInformation, \"Need Password\"    \n        Me.txtPassword.SetFocus\n\n    Else\n\n        If ((IsNull(DLookup(\"Login\",\"Preparer\",\"Login='&amp; Me.txtLogin.Value &amp;'\"))) or _\n        (IsNull(DLookup(\"Password\",\"Preparer\",\"Password='&amp; Me.txtPassword.Value &amp;'\")))) Then\n\n            MsgBox \"Incorrect Login or Password\"\n\n        Else\n\n            DoCmd.Close    \n            MsgBox \"Success\"\n\n            DoCmd.OpenForm \"Master\"\n\n        End If\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>The first two parts work so if login or password is blank it gives the correct error message, but whenever I put a login and password, even if they are correct (i.e. they exist in the preparer table) it gives me the \"Incorrect Login or Password\"</p>\n\n<p>I'm assuming the problem is in the code here:</p>\n\n<pre><code>If ((IsNull(DLookup(\"Login\",\"Preparer\",\"Login='&amp; Me.txtLogin.Value &amp;'\"))) or _\n    (IsNull(DLookup(\"Password\",\"Preparer\",\"Password='&amp; Me.txtPassword.Value &amp;'\")))) Then\n\n    MsgBox \"Incorrect Login or Password\"\n</code></pre>\n\n<p>Anyone understand why I can't get to the bottom else statement?</p>\n"}, {"tags": ["vba", "excel", "windows-7", "excel-2013"], "comments": [{"owner": {"reputation": 1476, "user_id": 2687063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd630664133fcc656f969d41f73e6602?s=128&d=identicon&r=PG&f=1", "display_name": "simpLE MAn", "link": "https://stackoverflow.com/users/2687063/simple-man"}, "edited": false, "score": 0, "creation_date": 1425401659, "post_id": 28836662, "comment_id": 45944301, "body": "The Dir function should help you with that.  <b><a href=\"https://msdn.microsoft.com/en-us/library/aa262726(v=vs.60).aspx\" rel=\"nofollow noreferrer\">Dir</a></b> with examples and an example from SO <b><a href=\"http://stackoverflow.com/questions/20427832/use-dir-to-find-file-without-aaa/20428231#20428231\">SO Dir example</a></b>."}, {"owner": {"reputation": 11, "user_id": 4429816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OeUiD.png?s=128&g=1", "display_name": "Kat", "link": "https://stackoverflow.com/users/4429816/kat"}, "reply_to_user": {"reputation": 1476, "user_id": 2687063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd630664133fcc656f969d41f73e6602?s=128&d=identicon&r=PG&f=1", "display_name": "simpLE MAn", "link": "https://stackoverflow.com/users/2687063/simple-man"}, "edited": false, "score": 0, "creation_date": 1425406002, "post_id": 28836662, "comment_id": 45946886, "body": "@simpLEMAn Forgive my casual understanding, but I see that it pulls the list of files within the folderpath, and I&#39;m guessing the next step would be to figure out what other VBA is needed to have the cell populate with &quot;y&quot; if a file matching the name is found? Or is it only possible to pull the list of files based on a filter and not possible for a cell to update if a file is found?"}, {"owner": {"reputation": 1476, "user_id": 2687063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd630664133fcc656f969d41f73e6602?s=128&d=identicon&r=PG&f=1", "display_name": "simpLE MAn", "link": "https://stackoverflow.com/users/2687063/simple-man"}, "edited": false, "score": 0, "creation_date": 1425407446, "post_id": 28836662, "comment_id": 45947686, "body": "You guessed right :)  I put this to point you in the right direction.  You should create a dummy folder with some files in it and test the <code>Dir</code> function.  Then update your question with the code you&#39;ve tried and where it is not working so we can help."}, {"owner": {"reputation": 11, "user_id": 4429816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OeUiD.png?s=128&g=1", "display_name": "Kat", "link": "https://stackoverflow.com/users/4429816/kat"}, "reply_to_user": {"reputation": 1476, "user_id": 2687063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd630664133fcc656f969d41f73e6602?s=128&d=identicon&r=PG&f=1", "display_name": "simpLE MAn", "link": "https://stackoverflow.com/users/2687063/simple-man"}, "edited": false, "score": 0, "creation_date": 1425410542, "post_id": 28836662, "comment_id": 45949536, "body": "@simpLEMAn Alright, what terms would I use to search further for &quot;populate cell if&quot; &quot;matches dir file name&quot;? While googling this I frequently come across finding the file name or updating the cell with the file name or the folder path name and I can&#39;t figure out what to relate that to when I want the if to match contents of a cell vs match file name and populate cell with file name. I find it very difficult to find results because when I say &quot;casual understanding&quot; its more, I get the big picture but not all the little bits and pieces until their relationship to each other is shown."}], "answers": [{"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1427099046, "last_edit_date": 1495539974, "creation_date": 1425401840, "answer_id": 28837509, "question_id": 28836662, "link": "https://stackoverflow.com/questions/28836662/vba-or-other-to-update-a-cell-with-x-or-y-when-a-file-is-saved-in-a-folder/28837509#28837509", "title": "VBA or other to update a cell with &quot;x&quot; or &quot;y&quot; when a file is saved in a folder", "body": "<p><strong>Take a look at this for scanning your files in folder, it'll be a good start!</strong></p>\n\n<p><strong><a href=\"https://stackoverflow.com/questions/29184595/loop-on-all-files-in-the-same-directory-then-detect-extension-type/29187762#29187762\">https://stackoverflow.com/questions/29184595/loop-on-all-files-in-the-same-directory-then-detect-extension-type/29187762#29187762</a></strong></p>\n\n<p>Here are some clues (I'm a bit in a hurry, I'll come back to detail if necessary)</p>\n\n<p>You can can get the Path of your Workbook like that :\n    <code>ThisWorkbook.Path</code> 'You get a string</p>\n\n<p>You can then go to your specific folder by working on the string</p>\n\n<p>Here is a code to check if the folder exist :    </p>\n\n<pre><code>If Dir(Path, 16) &lt;&gt; \"\"\n</code></pre>\n\n<p>Look at Dir specs to have more info</p>\n\n<p>And after that, I'll need to upload a VBA script (that I don't have on that computer) to have the full list of your docs in that folder and try to find \"Akora\" (or others) with Instr and it'll be a great procedure to reuse on other lines!</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 4429816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OeUiD.png?s=128&g=1", "display_name": "Kat", "link": "https://stackoverflow.com/users/4429816/kat"}, "edited": false, "score": 1, "creation_date": 1425476234, "post_id": 28845812, "comment_id": 45977719, "body": "Wow, this is amazing, I might not get to test this until next week, I&#39;ll get back to you if I have issues. This is awesome O_O"}, {"owner": {"reputation": 11, "user_id": 4429816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OeUiD.png?s=128&g=1", "display_name": "Kat", "link": "https://stackoverflow.com/users/4429816/kat"}, "edited": false, "score": 0, "creation_date": 1426000414, "post_id": 28845812, "comment_id": 46186382, "body": "I&#39;m not really sure where I&#39;m going wrong with this or if there was something I was supposed to change but missed. I tried adding the XXX at the end of the folderpath to dir to the exact folder. Also, unsure what, if anything, would need to be changed in the actual application of this. For example &quot;AAA&quot; might actually be &quot;AAA College Uni - PTA&quot; in the excel sheet in column B. I can&#39;t really alter the names in row 1 as it is used when creating reports from this spreadsheet."}, {"owner": {"reputation": 1476, "user_id": 2687063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd630664133fcc656f969d41f73e6602?s=128&d=identicon&r=PG&f=1", "display_name": "simpLE MAn", "link": "https://stackoverflow.com/users/2687063/simple-man"}, "reply_to_user": {"reputation": 11, "user_id": 4429816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OeUiD.png?s=128&g=1", "display_name": "Kat", "link": "https://stackoverflow.com/users/4429816/kat"}, "edited": false, "score": 0, "creation_date": 1426036853, "post_id": 28845812, "comment_id": 46204999, "body": "You just had to do <b>exactly</b> as it is written.  If your XXX, YYY and ZZZ folders are in &quot;D:\\Testing_Dir\\&quot;, there is nothing to change in my code to test it, just copy and paste in a code module.  In my example, AAA, BBB and CCC are your file names (or &quot;Program&quot;) and XXX, YYY and ZZ are your folders names (or &quot;Decision&quot;).  Now I expect you to come back here with your own code to show how it worked out!"}, {"owner": {"reputation": 11, "user_id": 4429816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OeUiD.png?s=128&g=1", "display_name": "Kat", "link": "https://stackoverflow.com/users/4429816/kat"}, "edited": false, "score": 0, "creation_date": 1426101004, "post_id": 28845812, "comment_id": 46238770, "body": "Okay, that is exactly what I did and it did not work. I created the excel file, created the text files, created the folder, pasted the code, changed the &quot;D:\\Testing_Dir\\&quot;, saved the workbook as .xlsm, saved the code, then ran it and nothing happened. Received no errors or notifications after running it, and no data appeared in the cells. Would it make a difference if the file was on a network drive and not a folder? <a href=\"http://i.imgur.com/sKBJ7jV.png\" rel=\"nofollow noreferrer\">this shows the code, result, and folder where it was saved.</a>"}, {"owner": {"reputation": 11, "user_id": 4429816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OeUiD.png?s=128&g=1", "display_name": "Kat", "link": "https://stackoverflow.com/users/4429816/kat"}, "edited": false, "score": 0, "creation_date": 1426101441, "post_id": 28845812, "comment_id": 46239022, "body": "Sorry for the trouble, I meant to say that I tried it on both a network drive and a local drive and neither made a difference."}, {"owner": {"reputation": 1476, "user_id": 2687063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd630664133fcc656f969d41f73e6602?s=128&d=identicon&r=PG&f=1", "display_name": "simpLE MAn", "link": "https://stackoverflow.com/users/2687063/simple-man"}, "reply_to_user": {"reputation": 11, "user_id": 4429816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OeUiD.png?s=128&g=1", "display_name": "Kat", "link": "https://stackoverflow.com/users/4429816/kat"}, "edited": false, "score": 0, "creation_date": 1426383362, "post_id": 28845812, "comment_id": 46349762, "body": "@Kat; Your <code>FolderPath</code> <b>must</b> end with a &quot;\\&quot; so that later on at the <code>dirTmp</code> line it assembles into the actual folder path we want. Let&#39;s take my code as an example. If <code>FolderPath = D:\\Testing_Dir</code> then <code>dirTmp</code> would contain <code>D:\\Testing_DirXXX\\ </code> at the first occurrence which is wrong but won&#39;t throw an error. We want <code>D:\\Testing_Dir\\XXX\\ </code> and so on."}, {"owner": {"reputation": 11, "user_id": 4429816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OeUiD.png?s=128&g=1", "display_name": "Kat", "link": "https://stackoverflow.com/users/4429816/kat"}, "edited": false, "score": 0, "creation_date": 1426509274, "post_id": 28845812, "comment_id": 46387205, "body": "I can&#39;t believe I missed that, I&#39;m sorry. It worked, I&#39;ll update back here after I adjust it to the actual file. Thank you so much."}, {"owner": {"reputation": 11, "user_id": 4429816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OeUiD.png?s=128&g=1", "display_name": "Kat", "link": "https://stackoverflow.com/users/4429816/kat"}, "edited": false, "score": 0, "creation_date": 1426708806, "post_id": 28845812, "comment_id": 46488824, "body": "I did get this working, however when running it through my folders I ran into another issue. When I run the macro before all files are in the folder, and then run it again, a &quot;y&quot; is not entered into cells that were previously blank. Maybe this is more of what I need to play with to get it working for what I need though? Is that correct?"}, {"owner": {"reputation": 1476, "user_id": 2687063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd630664133fcc656f969d41f73e6602?s=128&d=identicon&r=PG&f=1", "display_name": "simpLE MAn", "link": "https://stackoverflow.com/users/2687063/simple-man"}, "reply_to_user": {"reputation": 11, "user_id": 4429816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OeUiD.png?s=128&g=1", "display_name": "Kat", "link": "https://stackoverflow.com/users/4429816/kat"}, "edited": false, "score": 0, "creation_date": 1427120682, "post_id": 28845812, "comment_id": 46634881, "body": "@Kat; I&#39;m not sure I understand what you&#39;re trying to describe but, you could go through your code by running it line by line using F8 to see at any step the values stored whitin your variables (by hovering with mouse cursor over variables). Also, by default my <code>InStr</code> is case sensitive, if you want it not to be just change <code>InStr(dirTmp, ThisWorkbook.Worksheets(1).Cells(1, col).Value2)</code> by <code>InStr(1, dirTmp, ThisWorkbook.Worksheets(1).Cells(1, col).Value2, vbTextCompare)</code>"}], "tags": [], "owner": {"reputation": 1476, "user_id": 2687063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd630664133fcc656f969d41f73e6602?s=128&d=identicon&r=PG&f=1", "display_name": "simpLE MAn", "link": "https://stackoverflow.com/users/2687063/simple-man"}, "is_accepted": false, "score": 0, "last_activity_date": 1425437650, "last_edit_date": 1425437650, "creation_date": 1425437070, "answer_id": 28845812, "question_id": 28836662, "link": "https://stackoverflow.com/questions/28836662/vba-or-other-to-update-a-cell-with-x-or-y-when-a-file-is-saved-in-a-folder/28845812#28845812", "title": "VBA or other to update a cell with &quot;x&quot; or &quot;y&quot; when a file is saved in a folder", "body": "<p>I think this will get you started:</p>\n\n<p>To test this on your side, open a new workbook and arrange the data at same location as in the picture.<br>\n<img src=\"https://i.stack.imgur.com/6nrlY.png\" alt=\"enter image description here\"></p>\n\n<p>Then create a folder like this:<br>\n<img src=\"https://i.stack.imgur.com/hJOrZ.png\" alt=\"enter image description here\"></p>\n\n<p>In each folder, create new txt files named using \"AAA\", \"BBB\" or \"CCC\":\n<img src=\"https://i.stack.imgur.com/X7T1q.png\" alt=\"enter image description here\"></p>\n\n<p>Then create a new <code>code module</code>:<br>\n<img src=\"https://i.stack.imgur.com/c7sW5.png\" alt=\"enter image description here\"></p>\n\n<p>And paste this code in it:</p>\n\n<pre><code>Sub Put_Y_At_The_Right_Place()\n\n    Dim FolderPath As String: FolderPath = \"D:\\Testing_Dir\\\"\n    Dim dirTmp As String\n\n    Dim row As Integer\n    Dim col As Integer\n\n    For row = 2 To 4\n\n        'Each time we call \"Dir\" it switches to the next file it finds so we have to\n        'put its result in a temp variable like \"dirTmp\"\n        dirTmp = Dir(FolderPath &amp; ThisWorkbook.Worksheets(1).Cells(row, 1).Value2 &amp; \"\\\")\n\n        Do While Len(dirTmp) &gt; 0 'When \"Len(dirTmp) = 0\" no more files were found\n\n            For col = 2 To 4 'passing through column B to D\n\n                If InStr(dirTmp, ThisWorkbook.Worksheets(1).Cells(1, col).Value2) &lt;&gt; 0 Then\n                    ThisWorkbook.Worksheets(1).Cells(row, col).Value2 = \"Y\"\n                End If\n\n            Next col\n\n            dirTmp = Dir 'Calling \"Dir\" to switch to the next file\n\n        Loop\n\n    Next row\n\nEnd Sub\n</code></pre>\n\n<p>After you run this code, you should get:<br>\n<img src=\"https://i.stack.imgur.com/uoZc9.png\" alt=\"enter image description here\"></p>\n\n<p>To see what each line of code does, execute the code line by line using <code>F8</code>.</p>\n\n<p>When you understand this code, try to modify it to suit your needs.  If you have trouble doing that, come here and post what you've done and what the problems are.</p>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 11, "user_id": 4429816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OeUiD.png?s=128&g=1", "display_name": "Kat", "link": "https://stackoverflow.com/users/4429816/kat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 287, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1488362590, "creation_date": 1425399557, "last_edit_date": 1488362590, "question_id": 28836662, "link": "https://stackoverflow.com/questions/28836662/vba-or-other-to-update-a-cell-with-x-or-y-when-a-file-is-saved-in-a-folder", "title": "VBA or other to update a cell with &quot;x&quot; or &quot;y&quot; when a file is saved in a folder", "body": "<p>I've been googling this off and on over the last few months and have not been able to find a solution. It is completely possible that I just don't have the right terms to find the results needed.  </p>\n\n<p>I have a list of Schools that are being reviewed. There are different stages in this review process and I have a hard time keeping track. Our database in CRM is unable to track these items. So, I have <a href=\"http://i.imgur.com/Wvf2Hh2.png\" rel=\"nofollow\">created an excel file that I manually update</a>(hardly the best solution, and though suggestions have been made after a year there has been no improvement). </p>\n\n<ol>\n<li>School names appear at the top</li>\n<li>Stages of review are to the left, Many of the stages involve creating/saving a document</li>\n<li>When a document is created I type \"y\" into the appropriate cell  </li>\n</ol>\n\n<p>What I would like to do is have the appropriate cell update with \"y\" when a file appears in a folder if the file's name has a portion of some identifier. Example:</p>\n\n<ul>\n<li>if file (with the world \"Anoka\" in its name) appears in <em>Report Cards</em> folder, B12 = y</li>\n<li>if file (with the word \"Anoka\" in its name) appears in <em>Draft Created</em> folder, B15 = y</li>\n</ul>\n\n<p>I would repeat this for rows 16, 17, 18, 20, 25, 26, 27, and 28; accross all columns containing a program (the last column after programs has COUNTIFS to track total number of incompletes vs completes and other things). There are a total of 77 programs being tracked and human error leads to mistakes and takes up a lot of time when I have to go back to open the folders and search for the files and versions, etc.</p>\n"}, {"tags": ["vba", "internet-explorer", "excel", "dom"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 4626491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/744147c03bed17b159d8dce8a3afa133?s=128&d=identicon&r=PG&f=1", "display_name": "Bill Liame", "link": "https://stackoverflow.com/users/4626491/bill-liame"}, "edited": false, "score": 0, "creation_date": 1425442200, "post_id": 28845432, "comment_id": 45961466, "body": "Thanks for the comments:  (1) How do I know readyState=1?  Setting break points and using the VBA debugger to periodically inspect the value.  I do not know for sure that it is always 1, I do know for sure that it is never 4.  (2) Disable irrelevant stuff:  I&#39;m not positive that PeruseTheDocument is irrelevant.  However the results were the same with that procedure commented out.  (3)  IE.BUSY going false before the document is loaded:  Do you know the conditions when it goes false prematurely?  Since I don&#39;t understand the internals of IE real well, I just wait on everything."}, {"owner": {"reputation": 11, "user_id": 4443986, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/b5235aa3b927b4eab223fc50cc8ba868?s=128&d=identicon&r=PG", "display_name": "user4443986", "link": "https://stackoverflow.com/users/4443986/user4443986"}, "reply_to_user": {"reputation": 41, "user_id": 4626491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/744147c03bed17b159d8dce8a3afa133?s=128&d=identicon&r=PG&f=1", "display_name": "Bill Liame", "link": "https://stackoverflow.com/users/4626491/bill-liame"}, "edited": false, "score": 0, "creation_date": 1425800066, "post_id": 28845432, "comment_id": 46104822, "body": "Sorry, away cave diving ATM! i&#39;ll look at your code in detail in 2 days when I get home. re. (3), BUSY=TRUE means IE is busy loading or diwnloading <i>at this very instant</i>.FALSE mean&#39;s it isn;t busy loading or doiwnloading <i>at thius verhy uinstant</i>. But that does <i>not</i> mean that the loading or doiwnloading has actually finished. People misunderstand BUSY=-FALSE to mean, &quot;the document has fully loaded&quot;. That&#39;s not what it means at akkl. Apologies for typos etc, I&#39;m in cave country ATM!"}, {"owner": {"reputation": 41, "user_id": 4626491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/744147c03bed17b159d8dce8a3afa133?s=128&d=identicon&r=PG&f=1", "display_name": "Bill Liame", "link": "https://stackoverflow.com/users/4626491/bill-liame"}, "edited": false, "score": 0, "creation_date": 1425909443, "post_id": 28845432, "comment_id": 46141639, "body": "Thanks for looking at this.  The target web page doesn&#39;t do anything fancy such as AJAX or onload events.  I&#39;t just regular HTML with a bunch of images and some CSS."}, {"owner": {"reputation": 11, "user_id": 4443986, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/b5235aa3b927b4eab223fc50cc8ba868?s=128&d=identicon&r=PG", "display_name": "user4443986", "link": "https://stackoverflow.com/users/4443986/user4443986"}, "reply_to_user": {"reputation": 41, "user_id": 4626491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/744147c03bed17b159d8dce8a3afa133?s=128&d=identicon&r=PG&f=1", "display_name": "Bill Liame", "link": "https://stackoverflow.com/users/4626491/bill-liame"}, "edited": false, "score": 0, "creation_date": 1426223819, "post_id": 28845432, "comment_id": 46292991, "body": "I added a comment yesterday but it seems to have disappeared. It was, see my new answer (which was too long to add as a comment)."}], "tags": [], "owner": {"reputation": 11, "user_id": 4443986, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/b5235aa3b927b4eab223fc50cc8ba868?s=128&d=identicon&r=PG", "display_name": "user4443986", "link": "https://stackoverflow.com/users/4443986/user4443986"}, "is_accepted": false, "score": 0, "last_activity_date": 1425434225, "creation_date": 1425434225, "answer_id": 28845432, "question_id": 28836625, "link": "https://stackoverflow.com/questions/28836625/internetexplorer-application-hangs-on-readystate-1-in-vba/28845432#28845432", "title": "internetexplorer.application hangs on readystate=1 in VBA", "body": "<p>I'd say all the next as a comment, but have no comment privilige.</p>\n\n<p>(1) You say that it's stuck on readystate 1. Perhaps a silly question, but, how do you actually know that?</p>\n\n<p>(2) It helps to disable irrelevent things when debugging. So comment-out the PeruseTheDocument call, and try again (on the off-chance that it's something to do with that procedure).</p>\n\n<p>(3) Not the cause of your problem, but: while a document is loading, IE.BUSY is TRUE for most <em>but not all</em> of the time. It actually does go FALSE occasionally <em>before</em> the document has fully loaded. So waiting on IE.BUSY=FALSE is generally <em>not correct</em>. In your case that won't make any difference, because <em>then</em> you wait for readystate 4. But I'd remove the BUSY check, since it serves absolutely no purpose whatever, and it's based on a misunderstanding of what that property actually means.</p>\n\n<p>HTH</p>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 4626491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/744147c03bed17b159d8dce8a3afa133?s=128&d=identicon&r=PG&f=1", "display_name": "Bill Liame", "link": "https://stackoverflow.com/users/4626491/bill-liame"}, "edited": false, "score": 0, "creation_date": 1426255802, "post_id": 28956159, "comment_id": 46309595, "body": "Well - That didn&#39;t solve the problem but I got some insights.  I modified the MSGBOX to display the URL received:     MSGBOX &quot;WANTED &quot; &amp; SURL &amp; vblf &amp; &quot;GOT         &quot; &amp; objDoc.URL &amp; vblf &amp; left (objDoc.documentelement.outerhtml, 300)"}, {"owner": {"reputation": 41, "user_id": 4626491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/744147c03bed17b159d8dce8a3afa133?s=128&d=identicon&r=PG&f=1", "display_name": "Bill Liame", "link": "https://stackoverflow.com/users/4626491/bill-liame"}, "edited": false, "score": 0, "creation_date": 1426256313, "post_id": 28956159, "comment_id": 46309919, "body": "Well - That didn&#39;t solve the problem but I got some insights.  I modified the MSGBOX to display the URL received --&gt;     MSGBOX &quot;WANTED &quot; &amp; SURL &amp; vblf &amp; &quot;GOT         &quot; &amp; objDoc.URL &amp; vblf &amp; left (objDoc.documentelement.outerhtml, 300) &lt;-- and received &quot;GOT         about:blank&quot; on the second call -- the one with Age=18.  All the rest of the calls seemed fine.  If I tried to do the &quot;Age=18&quot; twice, the second call also worked fine.  I will try patching my code to retry when I receive &quot;about:blank&quot;."}, {"owner": {"reputation": 11, "user_id": 4443986, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/b5235aa3b927b4eab223fc50cc8ba868?s=128&d=identicon&r=PG", "display_name": "user4443986", "link": "https://stackoverflow.com/users/4443986/user4443986"}, "reply_to_user": {"reputation": 41, "user_id": 4626491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/744147c03bed17b159d8dce8a3afa133?s=128&d=identicon&r=PG&f=1", "display_name": "Bill Liame", "link": "https://stackoverflow.com/users/4626491/bill-liame"}, "edited": false, "score": 0, "creation_date": 1426308907, "post_id": 28956159, "comment_id": 46330396, "body": "Wow. I can&#39;t see any way that requesting an HTTP[S] URL could return the ABOUT:BLANK page. The ABOUT:BLANK page comes from inside a Windows DLL. It&#39;s a totally different protocol to normal HTTP[S] navigation. I recommend you track this down, instead of just retrying when you get that page.     Could you please post the smallest (minimal) version of my VBS script, modified to behave exactly as follows at your end: &quot;The last (or only) HTTP[S] URL requested by the script, actually returns the ABOUT:BLANK page&quot;."}, {"owner": {"reputation": 11, "user_id": 4443986, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/b5235aa3b927b4eab223fc50cc8ba868?s=128&d=identicon&r=PG", "display_name": "user4443986", "link": "https://stackoverflow.com/users/4443986/user4443986"}, "reply_to_user": {"reputation": 41, "user_id": 4626491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/744147c03bed17b159d8dce8a3afa133?s=128&d=identicon&r=PG&f=1", "display_name": "Bill Liame", "link": "https://stackoverflow.com/users/4626491/bill-liame"}, "edited": false, "score": 0, "creation_date": 1426558996, "post_id": 28956159, "comment_id": 46412932, "body": "It&#39;s 2 days on, so I&#39;ll assume you don&#39;t need any more help."}], "tags": [], "owner": {"reputation": 11, "user_id": 4443986, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/b5235aa3b927b4eab223fc50cc8ba868?s=128&d=identicon&r=PG", "display_name": "user4443986", "link": "https://stackoverflow.com/users/4443986/user4443986"}, "is_accepted": false, "score": 0, "last_activity_date": 1425961507, "creation_date": 1425961507, "answer_id": 28956159, "question_id": 28836625, "link": "https://stackoverflow.com/questions/28836625/internetexplorer-application-hangs-on-readystate-1-in-vba/28956159#28956159", "title": "internetexplorer.application hangs on readystate=1 in VBA", "body": "<p>(Geez this interface makes things hard!! I have to make this an answer, because it's too long for a comment.)</p>\n\n<p>Your problem doesn't occur for me.</p>\n\n<p>I don't have access to VBA, so I converted your code to VBScript. The difference is irrelevant to the issue at hand. Copy &amp; paste my code into a file with .VBS extension. Double-click to run, and you'll see each page go ready in turn.</p>\n\n<p>Note that VBScript variables are declared untyped, never eg. \"As Object\". I also made objIE local to procedure Test_IE_Interface(), then pass it explicitly to LoadAPage() - that's better design than using a global (but irrelevant to the problen at hand).</p>\n\n<p>My conclusion is that either (1) you're inadvertantly not actually showing us the actual code that is actually running; or (2) there's something wrong with your network stack or internet connectivity. Personally I doubt it is (2).</p>\n\n<p>Try my VBS code, see if it works, then convert it back to VBA and see what happens.</p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nTest_IE_Interface\nWSCRIPT.QUIT\n\nSub Test_IE_Interface()\nDim objIE\n\n    Set objIE = CreateObject(\"InternetExplorer.Application\")\n    With objIE\n      .AddressBar = True\n      .StatusBar = True\n      .MenuBar = True\n      .Toolbar = True  ' is actually a numeric property, not boolean.\n      .Visible = True\n    End With\n\n    LoadAPage objIE, \"http://events.gotsport.com/events/Default.aspx?EventID=44163\"\n    LoadAPage objIE, \"http://events.gotsport.com/events/schedule.aspx?EventID=44163&amp;Gender=Boys&amp;Age=18\"\n    LoadAPage objIE, \"http://events.gotsport.com/events/schedule.aspx?EventID=44163&amp;Gender=Boys&amp;Age=19\"\n    LoadAPage objIE, \"http://events.gotsport.com/events/schedule.aspx?EventID=44163&amp;Gender=Boys&amp;Age=13\"\n    LoadAPage objIE, \"http://events.gotsport.com/events/schedule.aspx?EventID=44163&amp;Gender=Boys&amp;Age=14\"\n    LoadAPage objIE, \"http://events.gotsport.com/events/schedule.aspx?EventID=44163&amp;Gender=Boys&amp;Age=15\"\n    LoadAPage objIE, \"http://events.gotsport.com/events/schedule.aspx?EventID=44163&amp;Gender=Boys&amp;Age=16\"\n    LoadAPage objIE, \"http://events.gotsport.com/events/schedule.aspx?EventID=44163&amp;Gender=Boys&amp;Age=17\"\n\n    objIE.Quit\n\nEnd Sub\n\nSub LoadAPage (objIE, sURL)\n    Dim objDoc\n    objIE.navigate sURL\n    Do While objIE.readyState &lt;&gt; 4\n       WSCRIPT.SLEEP 200  ' VBScript DOEVENTS/SLEEP for 0.2 seconds.\n    Loop\n    Set objDoc = objIE.document\n    MSGBOX \"GOT \" &amp; SURL &amp; vblf &amp; vblf &amp; left (objDoc.documentelement.outerhtml, 300)\nEnd Sub\n</code></pre>\n\n<hr>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 4922275, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/28f9b666b524c8716b4accf818693e52?s=128&d=identicon&r=PG", "display_name": "Wolfgang", "link": "https://stackoverflow.com/users/4922275/wolfgang"}, "is_accepted": false, "score": 1, "last_activity_date": 1432159426, "last_edit_date": 1432159426, "creation_date": 1432156578, "answer_id": 30360513, "question_id": 28836625, "link": "https://stackoverflow.com/questions/28836625/internetexplorer-application-hangs-on-readystate-1-in-vba/30360513#30360513", "title": "internetexplorer.application hangs on readystate=1 in VBA", "body": "<p>\"Funny thing\", sometimes the loop <code>objIE.readyState &lt;&gt; 4</code> works, sometimes it doesn't and hangs with <code>readyState = 1</code> (<code>READYSTATE_LOADING</code>) even though the browser window is obviously finished loading.</p>\n\n<p>It works best if I add a Sleep/DoEvents-loop (>500ms) after <code>navigate</code> and before doing anything else with the IE-object:</p>\n\n<pre><code>objIE.navigate sURL\nFor i = 0 To 10\n   DoEvents\n   Sleep 100\nNext i\n\nobjIE.Visible = True\n\nDo While objIE.readyState &lt;&gt; 4\n...\n</code></pre>\n\n<p>Hope that helps!</p>\n"}], "owner": {"reputation": 41, "user_id": 4626491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/744147c03bed17b159d8dce8a3afa133?s=128&d=identicon&r=PG&f=1", "display_name": "Bill Liame", "link": "https://stackoverflow.com/users/4626491/bill-liame"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2990, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1432159426, "creation_date": 1425399425, "last_edit_date": 1531164843, "question_id": 28836625, "link": "https://stackoverflow.com/questions/28836625/internetexplorer-application-hangs-on-readystate-1-in-vba", "title": "internetexplorer.application hangs on readystate=1 in VBA", "body": "<p>I have an Excel VBA application which uses internetexplorer.application to explore an application.  Starting around 2/21/15, this application started failing on readyState being stuck on 1 forever rather than ultimately migrating to 4.  This only occurred when navigating the second (or further) link.  The first URL works fine.</p>\n\n<p>The machine with the problem is a Core i5 M520 CPU (4 CPU) running 64-bit Windows 7.</p>\n\n<p>Another machine with a Core 2 Duo T9400 running 32-bit Windows 7 executes the code without a problem.</p>\n\n<p>This feels like some sort of race condition but I am not sure if I have to do something special under 64-bit windows.</p>\n\n<p>I am using Internet Explorer 11, Windows 7, and Excel 2003 (or 2013).  Any idea on what is going wrong?</p>\n\n<pre><code>Option Explicit\n\nPublic Declare Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long)\nDim objIE As Object\nDim iNodeCount As Long\nDim iLevel As Long\nDim iMaxLevel As Long\nDim iReadyStateLoopCount As Long\n\n'------------------------------------------------------\n'\n' Main driver of the test case\n'\n'------------------------------------------------------\n\nSub Test_IE_Interface()\n\n    Set objIE = CreateObject(\"InternetExplorer.Application\")\n    With objIE\n      .AddressBar = True\n      .StatusBar = True\n      .MenuBar = True\n      .Toolbar = True\n      .Visible = True\n    End With\n\n    LoadAPage \"http://events.gotsport.com/events/Default.aspx?EventID=44163\"\n\n    '  This example generally hangs on the following call\n\n    LoadAPage \"http://events.gotsport.com/events/schedule.aspx?EventID=44163&amp;Gender=Boys&amp;Age=18\"\n    LoadAPage \"http://events.gotsport.com/events/schedule.aspx?EventID=44163&amp;Gender=Boys&amp;Age=19\"\n    LoadAPage \"http://events.gotsport.com/events/schedule.aspx?EventID=44163&amp;Gender=Boys&amp;Age=13\"\n    LoadAPage \"http://events.gotsport.com/events/schedule.aspx?EventID=44163&amp;Gender=Boys&amp;Age=14\"\n    LoadAPage \"http://events.gotsport.com/events/schedule.aspx?EventID=44163&amp;Gender=Boys&amp;Age=15\"\n    LoadAPage \"http://events.gotsport.com/events/schedule.aspx?EventID=44163&amp;Gender=Boys&amp;Age=16\"\n    LoadAPage \"http://events.gotsport.com/events/schedule.aspx?EventID=44163&amp;Gender=Boys&amp;Age=17\"\n\n    objIE.Quit\nEnd Sub\n\n'--------------------------------------------------------------\n'\n' This routine loads a web page and then peruses the document\n'\n'--------------------------------------------------------------\n\nSub LoadAPage(sURL As String)\n    Dim sState As String\n    Dim sNewURL As String\n    Dim objDoc As Object\n\n    objIE.navigate sURL\n\n    Do While objIE.Busy\n        DoEvents\n        Sleep 10\n        DoEvents\n    Loop\n\n    ' &gt;&gt;&gt; Getting stuck in the following loop in the second call &lt;&lt;&lt;\n    ' &gt;&gt;&gt; OBJie.readyState is always 1 (READYSTATE_LOADING) &lt;&lt;&lt;\n\n    Do While objIE.readyState &lt;&gt; 4   ' READYSTATE_COMPLETE = 4\n        DoEvents\n        Sleep 10\n        DoEvents\n        iReadyStateLoopCount = iReadyStateLoopCount + 1\n    Loop\n\n    Set objDoc = objIE.document\n\n    sState = objDoc.readyState\n    Do While sState &lt;&gt; \"complete\"\n      DoEvents\n      Sleep 10\n      sState = objDoc.readyState\n    Loop\n\n    If objDoc.URL &lt;&gt; sURL Then\n        MsgBox \"The new URL was not loaded\" &amp; vbCrLf &amp; _\n               \"URL Requested: \" &amp; sURL &amp; vbCrLf &amp; _\n               \"URL Returned:  \" &amp; objDoc.URL\n    End If\n\n    iNodeCount = 0\n    iLevel = 0\n    iMaxLevel = 0\n\n    PeruseTheDocument objDoc\n\nEnd Sub\n\n'--------------------------------------------------\n'\n'  This is a dummy routine to examine the document\n'\n'--------------------------------------------------\n\nSub PeruseTheDocument(objNode As Object)\n    Dim objChild As Object\n\n    iNodeCount = iNodeCount + 1\n    iLevel = iLevel + 1\n\n    If iLevel &gt; iMaxLevel Then\n        iMaxLevel = iLevel\n    End If\n\n    If Not objNode Is Nothing Then\n        If Not IsNull(objNode.FirstChild) Then\n            Set objChild = objNode.FirstChild\n            Do Until IsNull(objChild) Or objChild Is Nothing\n\n                ' Make this go faster by not examining all nodes in the document\n\n                If iLevel &lt; 5 Then\n                    PeruseTheDocument objChild\n                End If\n\n                If IsNull(objChild.nextSibling) Then\n                    Set objChild = Nothing\n                Else\n                    Set objChild = objChild.nextSibling\n                End If\n            Loop\n        End If\n    End If\n\n    iLevel = iLevel - 1\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "optimization", "pivot-table"], "comments": [{"owner": {"reputation": 3112, "user_id": 2157378, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/00ecd09abb478d086696d9fa4f77b422?s=128&d=identicon&r=PG", "display_name": "Ditto", "link": "https://stackoverflow.com/users/2157378/ditto"}, "edited": false, "score": 0, "creation_date": 1425399621, "post_id": 28836576, "comment_id": 45942928, "body": "How often do you need to do this?  If you need to repeat this daily, than yeah, perhaps VBA. Otherwise, I wouldn&#39;t recommend it. I&#39;d recommend just using some lookups, (ie MATCH) or such and verify things, then import them."}, {"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1425400464, "post_id": 28836576, "comment_id": 45943480, "body": "I always recommend pivot tables and/or formulas over VBA when possible"}, {"owner": {"reputation": 91, "user_id": 1507828, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fd0fcf5050178511d6d53d54a06deba5?s=128&d=identicon&r=PG", "display_name": "Eric Thibeault", "link": "https://stackoverflow.com/users/1507828/eric-thibeault"}, "reply_to_user": {"reputation": 3112, "user_id": 2157378, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/00ecd09abb478d086696d9fa4f77b422?s=128&d=identicon&r=PG", "display_name": "Ditto", "link": "https://stackoverflow.com/users/2157378/ditto"}, "edited": false, "score": 0, "creation_date": 1425401948, "post_id": 28836576, "comment_id": 45944504, "body": "@Ditto: Thanks, I don&#39;t have to run this often (just on big projects that comes about three times a year.)  The rest of the time I only have to had 2-3 rows at a time and the &quot;find&quot; is much easier than this bulk task.  Why not recommanding VBA,"}, {"owner": {"reputation": 91, "user_id": 1507828, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fd0fcf5050178511d6d53d54a06deba5?s=128&d=identicon&r=PG", "display_name": "Eric Thibeault", "link": "https://stackoverflow.com/users/1507828/eric-thibeault"}, "edited": false, "score": 0, "creation_date": 1425402082, "post_id": 28836576, "comment_id": 45944596, "body": "With my given example, would it be too much to ask for a real formula to test what I want.  I really don&#39;t know how to do this either in pivot tables or formula and I would be thankfull to understand either fashion."}, {"owner": {"reputation": 3112, "user_id": 2157378, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/00ecd09abb478d086696d9fa4f77b422?s=128&d=identicon&r=PG", "display_name": "Ditto", "link": "https://stackoverflow.com/users/2157378/ditto"}, "edited": false, "score": 1, "creation_date": 1425402661, "post_id": 28836576, "comment_id": 45944979, "body": "VBA is more complex to write and maintain than just formulas (or as chancea said: pivot tables).  WIth simpler formulas, you could set those up and done.  You also have a chance to view the results prior to importing the data. VBA you&#39;d likely have it just dump the items in as well .. and if it messed up, you&#39;d have some rolling back to do ;)"}, {"owner": {"reputation": 91, "user_id": 1507828, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fd0fcf5050178511d6d53d54a06deba5?s=128&d=identicon&r=PG", "display_name": "Eric Thibeault", "link": "https://stackoverflow.com/users/1507828/eric-thibeault"}, "edited": false, "score": 0, "creation_date": 1425402812, "post_id": 28836576, "comment_id": 45945073, "body": "Thanks a lot for the info on why or not use VBA.  I&#39;ll test Isaac&#39;s solution.  Side question, why some use vlookup and other use index/match?  Would index/match be better for my purpose than vlookup?"}, {"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1425405198, "post_id": 28836576, "comment_id": 45946452, "body": "I don&#39;t have any sources off hand but if I remember correctly h/vlookup is faster for binary searches while index/match is better for large amounts of data and it is more flexible"}], "answers": [{"tags": [], "owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1425401112, "creation_date": 1425401112, "answer_id": 28837251, "question_id": 28836576, "link": "https://stackoverflow.com/questions/28836576/import-400-rows-in-20k-row-sheet-and-manipulate-before-import/28837251#28837251", "title": "Import 400 rows in 20k row sheet and manipulate before import", "body": "<p>I would get both sets of data in VBA variant arrays, then loop  to do the tests then put the arrays back. That would probably be fast enough. If its not fast enough then you could sort the data and use binary search.</p>\n\n<p>The key trick is to get the entire range into an array using a single statement:</p>\n\n<pre><code>Dim vMaster as variant\nvMaster=Worksheets(\"Master\").Range(\"a1:B20400\")\n</code></pre>\n\n<p>After updating the array you can write it back by reversing the assignment.</p>\n"}, {"comments": [{"owner": {"reputation": 91, "user_id": 1507828, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fd0fcf5050178511d6d53d54a06deba5?s=128&d=identicon&r=PG", "display_name": "Eric Thibeault", "link": "https://stackoverflow.com/users/1507828/eric-thibeault"}, "edited": false, "score": 0, "creation_date": 1425402294, "post_id": 28837440, "comment_id": 45944738, "body": "Thanks Isaac, I&#39;ll certainly test that.  It seems to be the a really good and detailed answer.  Let me get back to you afterward."}, {"owner": {"reputation": 91, "user_id": 1507828, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fd0fcf5050178511d6d53d54a06deba5?s=128&d=identicon&r=PG", "display_name": "Eric Thibeault", "link": "https://stackoverflow.com/users/1507828/eric-thibeault"}, "edited": false, "score": 1, "creation_date": 1425415932, "post_id": 28837440, "comment_id": 45952424, "body": "Hello, I tested it and it doesn&#39;t seem to work as expected. Let say in master I have &quot;def -&gt; efg&quot; and in toImport &quot;efg -&gt; yxw&quot;.  I want the master line to be changed for &quot;def -&gt; yxw&quot; and this doesn&#39;t seem to give me that opportunity."}, {"owner": {"reputation": 91, "user_id": 1507828, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fd0fcf5050178511d6d53d54a06deba5?s=128&d=identicon&r=PG", "display_name": "Eric Thibeault", "link": "https://stackoverflow.com/users/1507828/eric-thibeault"}, "edited": false, "score": 0, "creation_date": 1425416295, "post_id": 28837440, "comment_id": 45952616, "body": "Your description in #2 works great, by the way, for everything that changes the old URL from master to the new URL from toImport."}, {"owner": {"reputation": 91, "user_id": 1507828, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fd0fcf5050178511d6d53d54a06deba5?s=128&d=identicon&r=PG", "display_name": "Eric Thibeault", "link": "https://stackoverflow.com/users/1507828/eric-thibeault"}, "edited": false, "score": 0, "creation_date": 1425416423, "post_id": 28837440, "comment_id": 45952676, "body": "By the way, what would be the best stackoverflow way to add more details to my problem.  I only know the use of this comment box but can I use a &quot;answer&quot; to have more flexibility (screenshots...)?"}, {"owner": {"reputation": 1561, "user_id": 179, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ZqopD.jpg?s=128&g=1", "display_name": "Isaac Moses", "link": "https://stackoverflow.com/users/179/isaac-moses"}, "reply_to_user": {"reputation": 91, "user_id": 1507828, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fd0fcf5050178511d6d53d54a06deba5?s=128&d=identicon&r=PG", "display_name": "Eric Thibeault", "link": "https://stackoverflow.com/users/1507828/eric-thibeault"}, "edited": false, "score": 1, "creation_date": 1425416516, "post_id": 28837440, "comment_id": 45952735, "body": "@EricThibeault, to describe issues particular to a single answer, the best thing to do is comment on that answer. You can link to screenshots in a comment, if you want. To add details to the question, you can edit the question."}, {"owner": {"reputation": 91, "user_id": 1507828, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fd0fcf5050178511d6d53d54a06deba5?s=128&d=identicon&r=PG", "display_name": "Eric Thibeault", "link": "https://stackoverflow.com/users/1507828/eric-thibeault"}, "edited": false, "score": 0, "creation_date": 1425416704, "post_id": 28837440, "comment_id": 45952834, "body": "About my def, efg, yxw algebra... let&#39;s put it simple: I&#39;ll reuse the letters from my original post.  having a-&gt;b in master and b-&gt;c in toImport, I want master to be changed to a-&gt;c but the given formula let that row to a-&gt;b."}, {"owner": {"reputation": 1561, "user_id": 179, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ZqopD.jpg?s=128&g=1", "display_name": "Isaac Moses", "link": "https://stackoverflow.com/users/179/isaac-moses"}, "reply_to_user": {"reputation": 91, "user_id": 1507828, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fd0fcf5050178511d6d53d54a06deba5?s=128&d=identicon&r=PG", "display_name": "Eric Thibeault", "link": "https://stackoverflow.com/users/1507828/eric-thibeault"}, "edited": false, "score": 1, "creation_date": 1425417027, "post_id": 28837440, "comment_id": 45953011, "body": "@EricThibeault, I updated Step 2 so that it will check both columns in <code>master</code>. Hopefully, this&#39;ll do the trick."}, {"owner": {"reputation": 91, "user_id": 1507828, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fd0fcf5050178511d6d53d54a06deba5?s=128&d=identicon&r=PG", "display_name": "Eric Thibeault", "link": "https://stackoverflow.com/users/1507828/eric-thibeault"}, "edited": false, "score": 0, "creation_date": 1425421254, "post_id": 28837440, "comment_id": 45955219, "body": "it has the same behavior than the earlier version of your code but it gives a #N/A if it finds the new url from master in the old url from toImport (b in my example).  Could it be the &quot;A:B, <b>2</b>&quot; part in the vlookup that gives this error (tries to retrieve value from a wrong cell)?"}, {"owner": {"reputation": 1561, "user_id": 179, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ZqopD.jpg?s=128&g=1", "display_name": "Isaac Moses", "link": "https://stackoverflow.com/users/179/isaac-moses"}, "reply_to_user": {"reputation": 91, "user_id": 1507828, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fd0fcf5050178511d6d53d54a06deba5?s=128&d=identicon&r=PG", "display_name": "Eric Thibeault", "link": "https://stackoverflow.com/users/1507828/eric-thibeault"}, "edited": false, "score": 1, "creation_date": 1425421746, "post_id": 28837440, "comment_id": 45955434, "body": "@EricThibeault, I split out consideration of master!New into a nested IF."}, {"owner": {"reputation": 91, "user_id": 1507828, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fd0fcf5050178511d6d53d54a06deba5?s=128&d=identicon&r=PG", "display_name": "Eric Thibeault", "link": "https://stackoverflow.com/users/1507828/eric-thibeault"}, "reply_to_user": {"reputation": 1561, "user_id": 179, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ZqopD.jpg?s=128&g=1", "display_name": "Isaac Moses", "link": "https://stackoverflow.com/users/179/isaac-moses"}, "edited": false, "score": 0, "creation_date": 1425422996, "post_id": 28837440, "comment_id": 45955970, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/72180/discussion-between-eric-thibeault-and-isaac-moses\">continue this discussion in chat</a>."}, {"owner": {"reputation": 91, "user_id": 1507828, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fd0fcf5050178511d6d53d54a06deba5?s=128&d=identicon&r=PG", "display_name": "Eric Thibeault", "link": "https://stackoverflow.com/users/1507828/eric-thibeault"}, "edited": false, "score": 0, "creation_date": 1425423278, "post_id": 28837440, "comment_id": 45956086, "body": "Thanks, everything is now working really fine in a small section.  I&#39;ll now have to test it in my 20k and 400 rows sheets."}], "tags": [], "owner": {"reputation": 1561, "user_id": 179, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ZqopD.jpg?s=128&g=1", "display_name": "Isaac Moses", "link": "https://stackoverflow.com/users/179/isaac-moses"}, "is_accepted": true, "score": 1, "last_activity_date": 1425421715, "last_edit_date": 1425421715, "creation_date": 1425401621, "answer_id": 28837440, "question_id": 28836576, "link": "https://stackoverflow.com/questions/28836576/import-400-rows-in-20k-row-sheet-and-manipulate-before-import/28837440#28837440", "title": "Import 400 rows in 20k row sheet and manipulate before import", "body": "<p>Assuming that your Old URL and New URL are in columns A and B of the two sheets, you could do the following procedure:</p>\n\n<ol>\n<li><p>Sort <code>master</code> and <code>toImport</code>, each by column A.</p></li>\n<li><p>Add the following formula to column C of <code>master</code>:</p>\n\n<p><code>= IF(ISNA(VLOOKUP(A1, toImport!A:A, 1, FALSE)), IF(ISNA(VLOOKUP(B1, toImport!A:A, 1, FALSE)), B1, VLOOKUP(B1, toImport!A:B, 2, FALSE)), VLOOKUP(A1, toImport!A:B, 2, FALSE))</code></p>\n\n<p>This will give you the New URL from <code>toImport</code> for rows whose Old URL or New URL in <code>master</code> matches the Old URL in <code>toImport</code> and the New URL from <code>master</code> for rows that don't.</p></li>\n<li><p>Copy (or cut) Column C of <code>master</code> and Paste Values onto Column B.</p>\n\n<p>Now, you've handled the updates for everything on <code>toImport</code> that updates an existing URL on <code>master</code>.</p></li>\n<li><p>Add the following to columns C and D of <code>toImport</code>:</p>\n\n<p><code>= IF(ISNA(VLOOKUP(A1, master!A:A, 1, FALSE)), A1, \"\")</code><br>\n<code>= IF(ISNA(VLOOKUP(A1, master!A:A, 1, FALSE)), B1, \"\")</code></p>\n\n<p>This will give you nonblank values only when <code>toImport</code> has a new value for Old URL.</p></li>\n<li><p>Filter <code>toImport</code> for rows in which column C is not blank.</p></li>\n<li><p>Copy the block of nonblank cells in columns C and D of <code>toImport</code>, and Paste Values to the bottom of columns A and B of <code>master</code>.</p></li>\n</ol>\n\n<p>You could automate this process by recording a macro of a manual performance of the steps above. It shouldn't take too much to make this macro work in general.</p>\n"}], "owner": {"reputation": 91, "user_id": 1507828, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fd0fcf5050178511d6d53d54a06deba5?s=128&d=identicon&r=PG", "display_name": "Eric Thibeault", "link": "https://stackoverflow.com/users/1507828/eric-thibeault"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 28837440, "answer_count": 2, "score": 0, "last_activity_date": 1425421715, "creation_date": 1425399257, "last_edit_date": 1425400037, "question_id": 28836576, "link": "https://stackoverflow.com/questions/28836576/import-400-rows-in-20k-row-sheet-and-manipulate-before-import", "title": "Import 400 rows in 20k row sheet and manipulate before import", "body": "<p>I have 2 sheets with only 2 columns:</p>\n\n<ul>\n<li>Old URL</li>\n<li>New URL</li>\n</ul>\n\n<p>One sheet (master) contains 20k rows of those two columns and I have another sheet (toImport) with about 400 rows of those same two columns.</p>\n\n<p>Since it's for a redirect file sent to apache and I do this because of a big structure change in our web environment, before importing those 400 rows in the 20k rows sheet I want to evaluate some scenarios:</p>\n\n<ul>\n<li>If the old and new pair from the toImport file is already in the master file: do nothing with it</li>\n<li>If the old URL from the toImport file is in the new URL column from the master file, do the following:</li>\n<li>Put the new URL value from toImport file in the new URL value of master (in order not to create a cascading redirection)</li>\n<li>Also import the old/new pair from toImport, as-is in the master file (in order for users to access the new page if they knew the last active URL).</li>\n</ul>\n\n<p>In other words, if I have, in the master file</p>\n\n<p>a -> b</p>\n\n<p>and in the toImport file</p>\n\n<p>b -> c</p>\n\n<p>I want to be able to do the following in the master file</p>\n\n<p>a -> c</p>\n\n<p>b -> c</p>\n\n<p>What would be the best approach for this?  VBA I suppose, or pivot table?  Can someone gives me some ideas about how to address that.  Knowing that 20k rows looped 400 times can be long, their must be a quick way to work this but I have no clue.</p>\n\n<p>Thanks for your help.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 2, "creation_date": 1425398618, "post_id": 28836173, "comment_id": 45942224, "body": "This is a poorly written question.  Mainly because you haven&#39;t explained if you want to skip ONE iteration of the loop or Exit the loop completely.  Under what conditions would you like to skip/exit?  What have you tried so far other than <code>Exit</code>?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1425401547, "post_id": 28836173, "comment_id": 45944236, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/8680640/vba-how-to-conditionally-skip-a-for-loop-iteration\">VBA - how to conditionally skip a for loop iteration</a>"}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 3, "last_activity_date": 1425398899, "creation_date": 1425398899, "answer_id": 28836441, "question_id": 28836173, "link": "https://stackoverflow.com/questions/28836173/vba-stop-execution-of-current-iteration-of-loop/28836441#28836441", "title": "VBA stop execution of current iteration of loop", "body": "<p>You'll usually want to skip an iteration when a given condition is met - you have 2 options in VBA:</p>\n\n<ol>\n<li><p>Wrap the loop body in an <code>If</code> block:</p>\n\n<pre><code>    For i = 1 to 100\n        If SomeCondition Then\n            ' interesting iterations\n        End If\n    Next\n</code></pre></li>\n<li><p>Use <code>GoTo</code> to skip an iteration (and reduce nesting):</p>\n\n<pre><code>    For i = 1 to 100\n        If Not SomeCondition Then GoTo Skip\n\n        ' interesting iterations\n\nSkip:\n    Next\n</code></pre></li>\n</ol>\n\n<p>Yes, <code>GoTo</code> is bad. But this is an old language, and <code>GoTo</code> <em>does</em> have legitimate uses - that's one of them. If you keep your code clean and <a href=\"https://github.com/retailcoder/Rubberduck/wiki/Features#refactorings\" rel=\"nofollow\">extract the loop body into its own procedure</a>, there shouldn't be any readability issues with using it.</p>\n"}], "owner": {"reputation": 4959, "user_id": 783421, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7634fc50bf44d5c0e9e5cd819fb912ad?s=128&d=identicon&r=PG", "display_name": "Qbik", "link": "https://stackoverflow.com/users/783421/qbik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1037, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1425399075, "creation_date": 1425398246, "question_id": 28836173, "link": "https://stackoverflow.com/questions/28836173/vba-stop-execution-of-current-iteration-of-loop", "title": "VBA stop execution of current iteration of loop", "body": "<p>How to stop execution of current iteration of for loop statement ?\n<code>Exit</code> ends execution of whole loop, have I realy use <code>goto</code> ? </p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1425398429, "post_id": 28836075, "comment_id": 45942094, "body": "In addition, OP may need <code>InStr(LCase(txt), search) &gt; 0</code>."}, {"owner": {"reputation": 11, "user_id": 4628420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a9a6fa0b53012147cb602ddd71a562a?s=128&d=identicon&r=PG&f=1", "display_name": "Roseanne", "link": "https://stackoverflow.com/users/4628420/roseanne"}, "edited": false, "score": 0, "creation_date": 1425494310, "post_id": 28836075, "comment_id": 45989732, "body": "Thanks so much to you both!  Changing the case alone did not fix it, but it worked after I changed the case and replaced InStr(LCase(txt), search) with InStr(LCase(txt), search) &gt; 0."}], "tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": false, "score": 4, "last_activity_date": 1425397983, "creation_date": 1425397983, "answer_id": 28836075, "question_id": 28835897, "link": "https://stackoverflow.com/questions/28835897/delete-paragraphs-not-containing-country-name-in-word/28836075#28836075", "title": "Delete Paragraphs Not Containing Country Name in Word", "body": "<p>The problem is that the value you are searching for, \"Afghan,\" has a capital 'A' in it, but you have changed the paragraph text to all lowercase.  Change the value you are searching for to \"afghan\" with a lowercase 'a' and it should work.</p>\n"}], "owner": {"reputation": 11, "user_id": 4628420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a9a6fa0b53012147cb602ddd71a562a?s=128&d=identicon&r=PG&f=1", "display_name": "Roseanne", "link": "https://stackoverflow.com/users/4628420/roseanne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1425398175, "creation_date": 1425397451, "last_edit_date": 1425398175, "question_id": 28835897, "link": "https://stackoverflow.com/questions/28835897/delete-paragraphs-not-containing-country-name-in-word", "title": "Delete Paragraphs Not Containing Country Name in Word", "body": "<p>I would like to delete paragraphs in Word document not containing the name of the country I am interested in.  Based on the answer to another question on this site, I came up with:</p>\n\n<pre><code>Sub DeleteParagraphContainingString()\n\n    Dim search As String\n    search = \"Afghan\"\n\n    Dim para As Paragraph\n    For Each para In ActiveDocument.Paragraphs\n\n        Dim txt As String\n        txt = para.Range.Text\n\n        If Not InStr(LCase(txt), search) Then\n            para.Range.Delete\n        End If\n\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>However, this deletes EVERY paragraph in the document.  Can anyone tell me how to fix it?  </p>\n\n<p>Thanks!  I do not know much about Word macros, as may be obvious from this question.</p>\n"}, {"tags": ["vba", "sorting", "excel"], "comments": [{"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1425397652, "post_id": 28835719, "comment_id": 45941551, "body": "Are you sure they aren&#39;t cleared? They aren&#39;t a filter so the values won&#39;t go back to their old position, but the sort fields will be clear."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1425398069, "post_id": 28835719, "comment_id": 45941835, "body": "Maybe you are using a filter too? In that case you might want to use .ShowAllData in such way: Sheet9.ShowAllData."}, {"owner": {"reputation": 179, "user_id": 4581009, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e687e8e16444ce76b07e9ada1cd27bf4?s=128&d=identicon&r=PG&f=1", "display_name": "Philip", "link": "https://stackoverflow.com/users/4581009/philip"}, "edited": false, "score": 0, "creation_date": 1425398156, "post_id": 28835719, "comment_id": 45941900, "body": "Ok. It is clearing them. But it gives me a sort reference not valid error when I try to apply it. I have updated the question with all the code I am using."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1425398485, "post_id": 28835719, "comment_id": 45942130, "body": "You&#39;re missing a <code>.SetRange</code> call."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1595538682, "post_id": 28835719, "comment_id": 111518749, "body": "maybe the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.sortfields.add\" rel=\"nofollow noreferrer\">MSDN Documentation</a> can help?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11024131, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TFFiz.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/11024131/chris"}, "is_accepted": false, "score": 0, "last_activity_date": 1582117335, "creation_date": 1582117335, "answer_id": 60301000, "question_id": 28835719, "link": "https://stackoverflow.com/questions/28835719/clear-all-sort-fields-vba/60301000#60301000", "title": "Clear all sort fields VBA", "body": "<pre><code>ActiveSheet.Range(\"Your_Range_Value\").AutoFilter Field:=1\n</code></pre>\n\n<p>I did this for every column that has a sort field and it clears them out. Where Field:=X is the column number in your range that you want to clear.</p>\n\n<p>This is what I have in my Workbook. Sheet1 is code name of sheet, and rng is string representing the range value (\"B4:G1500\")</p>\n\n<pre><code>' Clear all filters \nSheet1.Range(rng).AutoFilter Field:=1 \nSheet1.Range(rng).AutoFilter Field:=2\nSheet1.Range(rng).AutoFilter Field:=3\nSheet1.Range(rng).AutoFilter Field:=4\nSheet1.Range(rng).AutoFilter Field:=5\nSheet1.Range(rng).AutoFilter Field:=6\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1605027494, "post_id": 64193976, "comment_id": 114524894, "body": "Unnecessary use of Select, which should be avoided"}], "tags": [], "owner": {"reputation": 1, "user_id": 6278804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdd75c70d1d68c6065f561c84a13cc9c?s=128&d=identicon&r=PG&f=1", "display_name": "UziBozi", "link": "https://stackoverflow.com/users/6278804/uzibozi"}, "is_accepted": false, "score": -1, "last_activity_date": 1601810502, "creation_date": 1601810502, "answer_id": 64193976, "question_id": 28835719, "link": "https://stackoverflow.com/questions/28835719/clear-all-sort-fields-vba/64193976#64193976", "title": "Clear all sort fields VBA", "body": "<pre><code>Dim myData As Range\n\nRange(&quot;A1&quot;).Select\nRange(Selection, Selection.End(xlToRight)).Select\nRange(Selection, Selection.End(xlDown)).Select\nSet myData = Selection\n\nmyData.Select\nmyData.AutoFilter\n</code></pre>\n<p>This will not remove the sort but will open all raws to be visible without changing the sort done before that.</p>\n"}], "owner": {"reputation": 179, "user_id": 4581009, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e687e8e16444ce76b07e9ada1cd27bf4?s=128&d=identicon&r=PG&f=1", "display_name": "Philip", "link": "https://stackoverflow.com/users/4581009/philip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 18088, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1614963640, "creation_date": 1425396865, "last_edit_date": 1425398185, "question_id": 28835719, "link": "https://stackoverflow.com/questions/28835719/clear-all-sort-fields-vba", "title": "Clear all sort fields VBA", "body": "<p>I am trying to sort data through excel VBA but it is already sorted by a different header.  How would I clear all the sort fields before I set the new one? I have tried <code>Sort.SortFields.Clear</code> but it hasn't worked. Any help would be greatly appreciated. Here's the code I'm using:</p>\n\n<pre><code> Sheet9.Activate\n\nColumns(\"J:J\").Select\nSelection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\nCells(1, \"J\").Value = \"InternalID\"\nSet rng2 = FindHeader(\"CLIENT NAME\", Sheet9.Name)\n\n\nCount = 1\n\nSheet9.Cells.Select\n\nWith Sheet9.Sort\n        .SortFields.Clear\n        .SortFields.Add Key:=rng2, SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1425396329, "post_id": 28835425, "comment_id": 45940569, "body": "Are you sure about this? That is <b>not</b> the behavior that I observe if I test it: <a href=\"http://i.imgur.com/FYx0d79.png\" rel=\"nofollow noreferrer\">i.imgur.com/FYx0d79.png</a>"}, {"owner": {"reputation": 2398, "user_id": 3725745, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bPAUN.png?s=128&g=1", "display_name": "Aiken", "link": "https://stackoverflow.com/users/3725745/aiken"}, "edited": false, "score": 0, "creation_date": 1425396746, "post_id": 28835425, "comment_id": 45940881, "body": "Which version of Excel are you using? I&#39;m using 2003 and I don&#39;t have this issue at all."}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 1, "creation_date": 1425398894, "post_id": 28835425, "comment_id": 45942420, "body": "<code>Debug.Print Len(value)</code> gives you what?"}], "answers": [{"comments": [{"owner": {"reputation": 2398, "user_id": 3725745, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bPAUN.png?s=128&g=1", "display_name": "Aiken", "link": "https://stackoverflow.com/users/3725745/aiken"}, "edited": false, "score": 0, "creation_date": 1425396654, "post_id": 28835576, "comment_id": 45940805, "body": "So... how does this answer the question? I&#39;m not saying it <i>doesn&#39;t</i> but a little explanation would go a long way to improving the answer."}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "reply_to_user": {"reputation": 2398, "user_id": 3725745, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bPAUN.png?s=128&g=1", "display_name": "Aiken", "link": "https://stackoverflow.com/users/3725745/aiken"}, "edited": false, "score": 1, "creation_date": 1425396919, "post_id": 28835576, "comment_id": 45941013, "body": "Apologies, many folks don&#39;t care for an explanation, just want a solution to their problem. Edited to include an explanation of how this works."}, {"owner": {"reputation": 2398, "user_id": 3725745, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bPAUN.png?s=128&g=1", "display_name": "Aiken", "link": "https://stackoverflow.com/users/3725745/aiken"}, "edited": false, "score": 1, "creation_date": 1425397043, "post_id": 28835576, "comment_id": 45941104, "body": "Better, but the OP supposedly isn&#39;t even getting the Line Break character in their return value of <code>Cells(1,1).Value</code>, which you&#39;ve used here within the <code>Split()</code> function (<code>.Value</code> is the default property of <code>Cells</code>). Hence all the comments on the question stating that the problem is proving difficult to reproduce."}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "reply_to_user": {"reputation": 2398, "user_id": 3725745, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bPAUN.png?s=128&g=1", "display_name": "Aiken", "link": "https://stackoverflow.com/users/3725745/aiken"}, "edited": false, "score": 0, "creation_date": 1425397527, "post_id": 28835576, "comment_id": 45941449, "body": "I&#39;m just offering up how I would approach this problem. If my solution doesn&#39;t work for the OP, they can comment with what doesn&#39;t work and I will attempt to correct my answer to suit their needs. When I posted my answer I had not seen any of the comments."}], "tags": [], "owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "is_accepted": false, "score": -1, "last_activity_date": 1425396838, "last_edit_date": 1425396838, "creation_date": 1425396438, "answer_id": 28835576, "question_id": 28835425, "link": "https://stackoverflow.com/questions/28835425/get-full-value-of-a-wrapped-text-cell-in-vba/28835576#28835576", "title": "Get full value of a wrapped text cell in vba", "body": "<p>EDIT: The split function will split text strings based on any number of characters. In this case, we are splitting by Chr(10) which is the line break character. Essentially you split the text into parts, and the split occurs at any line break, and then you put them back together in a string variable called \"value\". Now \"value\" can be used in any place you would like the full string.</p>\n\n<pre><code>Dim value as string\nDim x as Variant\nDim i as integer\n\nx = split(Cells(1,1),Chr(10))\nfor i = 0 to ubound(x)\n   value = value &amp; x(i)\nNext i\n</code></pre>\n"}], "owner": {"reputation": 1835, "user_id": 2443476, "user_type": "registered", "accept_rate": 16, "profile_image": "https://www.gravatar.com/avatar/7fafc67c892104145e8296b2242f4d43?s=128&d=identicon&r=PG", "display_name": "user2443476", "link": "https://stackoverflow.com/users/2443476/user2443476"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 756, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1425397859, "creation_date": 1425396046, "last_edit_date": 1425397859, "question_id": 28835425, "link": "https://stackoverflow.com/questions/28835425/get-full-value-of-a-wrapped-text-cell-in-vba", "title": "Get full value of a wrapped text cell in vba", "body": "<p>I have a cell A1. When I click on it, the \"wrap text\" icon is activated and the value appears like this:</p>\n\n<p>1 parent<br>\n1 child</p>\n\n<p>In vba, when I try to get the value of the cell like this:</p>\n\n<pre><code>Dim value As String\nvalue=Cells(1,1).Value\n</code></pre>\n\n<p>I only get \"1 parent\", how can I get the full value of the cell?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 4628259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae951092d642cd4d44ffacf12ff1c148?s=128&d=identicon&r=PG&f=1", "display_name": "Dustin", "link": "https://stackoverflow.com/users/4628259/dustin"}, "edited": false, "score": 0, "creation_date": 1425397230, "post_id": 28835485, "comment_id": 45941240, "body": "Your answer works like a charm, thanks for the help!  I forgot that a defined range would work for a single record. (I am way out of practice!)  Changing &#39;Value = StrConv(Value, vbProperCase)&#39; to &#39;Target.Value2 = StrConv(Value, vbProperCase)&#39; also worked in my original code. For whatever reason my code was working with Value undeclared until closing and reopening my workbook.  Thank again!"}], "tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": true, "score": 0, "last_activity_date": 1425396188, "creation_date": 1425396188, "answer_id": 28835485, "question_id": 28835309, "link": "https://stackoverflow.com/questions/28835309/trouble-using-a-for-loop-for-target-value2-property-range/28835485#28835485", "title": "Trouble using a For loop for Target.Value2 property range", "body": "<p>Try this (you need to define the variable types!)</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\nOn Error GoTo Err\n\n    If Not Intersect(Target, Range(\"I2:J999\")) Is Nothing Then\n        Application.EnableEvents = False\n        Application.ScreenUpdating = False\n\n        Dim cel as Range 'Define the type of variable formally Value\n        For Each cel In Target 'Will work for one cell or multiples\n            cel.Value = StrConv(cel.Value, vbProperCase)\n        Next cel\n\n        Application.ScreenUpdating = True\n        Application.EnableEvents = True\n\n        Exit Sub\n    End If\n\nExit Sub\n\nErr:\n    Debug.Print Err.Description\n    If Application.ScreenUpdating = False Then Application.ScreenUpdating = True\n    If Application.EnableEvents = False Then Application.EnableEvents = True\n    Exit Sub\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 4628259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae951092d642cd4d44ffacf12ff1c148?s=128&d=identicon&r=PG&f=1", "display_name": "Dustin", "link": "https://stackoverflow.com/users/4628259/dustin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 28835485, "answer_count": 1, "score": 0, "last_activity_date": 1425396188, "creation_date": 1425395640, "question_id": 28835309, "link": "https://stackoverflow.com/questions/28835309/trouble-using-a-for-loop-for-target-value2-property-range", "title": "Trouble using a For loop for Target.Value2 property range", "body": "<p>In one of my workbooks I have run into an issue in the Worksheet Change event when attempting to change the case to Proper in a range of cell values using the Target.Value2 property.</p>\n\n<p>Using the code below, when I change a single cell, the case is changed to Proper as expected. When pasting multiple cells, the case is changed to Proper for each value in the Locals window when stepping through the code, but the values pasted into the cells are not Proper case.</p>\n\n<p>Thanks in advance!</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\nOn Error GoTo Error:\n\n    If Not Intersect(Target, Range(\"I2:J999\")) Is Nothing Then\n        If Target.Cells.Count = 1 Then\n            Application.EnableEvents = False\n            Target.Value = StrConv(Target.Value, vbProperCase)\n            Application.EnableEvents = True\n            Exit Sub\n        ElseIf Target.Cells.Count &gt; 1 Then\n            Application.EnableEvents = False\n            Application.ScreenUpdating = False\n\n            For Each Value In Target.Value2\n            Value = StrConv(Value, vbProperCase)\n            Next Value\n\n            Application.ScreenUpdating = True\n            Application.EnableEvents = True\n            Exit Sub\n        End If\n    Exit Sub\n    End If\n\nExit Sub\n\nError:\n    Debug.Print Err.Description\n    If Application.ScreenUpdating = False Then Application.ScreenUpdating = True\n    If Application.EnableEvents = False Then Application.EnableEvents = True\n    Exit Sub\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "pdf"], "comments": [{"owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "edited": false, "score": 0, "creation_date": 1425399444, "post_id": 28835164, "comment_id": 45942822, "body": "Do you have Acrobat (not the Reader)  installed on your computer. If so, you can use the Acrobat object model to copy the data from PDF into Excel, without using <code>SendKeys</code>. Let me know if you do, I will post an answer with sample code"}, {"owner": {"reputation": 21, "user_id": 3027640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f82d94a691733709d1070e3b2119c8?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3027640/sam"}, "reply_to_user": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "edited": false, "score": 0, "creation_date": 1425417602, "post_id": 28835164, "comment_id": 45953288, "body": "yes i have acrobat as well"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 3027640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f82d94a691733709d1070e3b2119c8?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3027640/sam"}, "edited": false, "score": 0, "creation_date": 1425397070, "post_id": 28835550, "comment_id": 45941125, "body": "thank you. it just gave me the same result. I&#39;ll give you an example. Right now i have the range for just 2 file paths (for simplicity while i work out the bugs). It opens the first pdf i can see that it copies all the data (control-a) then the spreadsheet is activated and the right cell is selected. However it does not paste it just goes on to open the next pdf where all its data is selected, spreadsheet activated again and cell selected again, but this time it does paste the data."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 21, "user_id": 3027640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f82d94a691733709d1070e3b2119c8?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3027640/sam"}, "edited": false, "score": 0, "creation_date": 1425397854, "post_id": 28835550, "comment_id": 45941689, "body": "It may be worth trying more files to see if it only copies the second one, the last one, skips the first one, or some other combination of files."}], "tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": false, "score": 0, "last_activity_date": 1425396373, "creation_date": 1425396373, "answer_id": 28835550, "question_id": 28835164, "link": "https://stackoverflow.com/questions/28835164/copying-data-from-multiple-pdf-files/28835550#28835550", "title": "Copying data from multiple pdf files", "body": "<p>I can't quite get your code to work, but my guess is that it's copying all of the data, but overwriting it each time through the loop.  To fix this try:</p>\n\n<pre><code>ActiveSheet.Cells(1, ActiveSheet.Cells(1, Columns.Count).End(xlToLeft).Column + 1).Select\n</code></pre>\n\n<p>instead of the two lines that begin activesheet.range(\"A1\").Select and Selection.End....</p>\n"}, {"comments": [{"owner": {"reputation": 481, "user_id": 4647394, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06d6fcb008fd47cdc43d3964580baf4a?s=128&d=identicon&r=PG&f=1", "display_name": "seadoggie01", "link": "https://stackoverflow.com/users/4647394/seadoggie01"}, "edited": false, "score": 0, "creation_date": 1521466952, "post_id": 37287583, "comment_id": 85729175, "body": "I know this is old, but your &quot;Find first open column&quot; references ws not wsNew :)"}], "tags": [], "owner": {"reputation": 56, "user_id": 5216265, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QVivV.jpg?s=128&g=1", "display_name": "jlookup", "link": "https://stackoverflow.com/users/5216265/jlookup"}, "is_accepted": false, "score": 2, "last_activity_date": 1463526566, "last_edit_date": 1463526566, "creation_date": 1463526201, "answer_id": 37287583, "question_id": 28835164, "link": "https://stackoverflow.com/questions/28835164/copying-data-from-multiple-pdf-files/37287583#37287583", "title": "Copying data from multiple pdf files", "body": "<p>Jeanno's right, if you have Acrobat then using its API library to work with the file directly is much better than the workarounds. I use this every day to convert pdf files into database entries.</p>\n\n<p>Your code has a few problems, but I suspect the biggest issue is the use of <code>SendKeys \"^v\"</code> to paste into Excel. You're better off selecting the cell you want then using <code>Selection.Paste</code>. Or even better, transfer the contents of the clipboard to a variable, then parse it out as needed on the backend before writing to your spreadsheet--but that adds a bunch of complexity and doesn't help you a lot in this case.</p>\n\n<p>To use the code below, be sure to select your 'Acrobat x.x Type Library' under Tools>References.</p>\n\n<pre><code>Sub StartAdobe1()\n    Dim fName       As Variant\n    Dim wbTransfer  As Excel.Workbook\n    Dim wsNew       As Excel.Worksheet\n    Dim dOpenCol    As Double\n    Dim oPDFApp     As AcroApp\n    Dim oAVDoc      As AcroAVDoc\n    Dim oPDDoc      As AcroPDDoc\n\n    'Define your spreadsheet\n    Set wbTransfer = Workbooks(\"transfer (Autosaved).xlsm\")\n    Set wsNew = wbTransfer.Sheets(\"new\")\n    'Find first open column\n    dOpenCol = ws.Cells(1, columns.count).End(xlToleft).Column + 1\n\n    'Instantiate Acrobat Objects\n    Set oPDFApp = CreateObject(\"AcroExch.App\")\n    Set oAVDoc = CreateObject(\"AcroExch.AVDoc\")\n    Set oPDDoc = CreateObject(\"AcroExch.PDDoc\")\n\nFor Each fName In Range(\"path\")\n\n    'Open the PDF file. The AcroAVDoc.Open function returns a true/false \n    'to tell you if it worked\n    If oAVDoc.Open(fName.Text, \"\") = True Then\n        Set oPDDoc = oAVDoc.GetPDDoc\n    Else\n        Debug.Assert False\n    End If\n\n    'Copy all using Acrobat menu\n    oPDFApp.MenuItemExecute (\"SelectAll\")\n    oPDFApp.MenuItemExecute (\"Copy\")\n\n    'Paste into open column\n    wbTransfer.Activate\n    wsNew.Cells(1, dOpenCol).Select\n    ActiveSheet.Paste\n\n    'Select next open column\n    dOpenCol = dOpenCol + 1\n\n    oAVDoc.Close (1)    '(1)=Do not save changes\n    oPDDoc.Close\n\nNext\n\n    'Clean up\n    Set wbTransfer = Nothing\n    Set wsNew = Nothing\n    Set oPDFApp = Nothing\n    Set oAVDoc = Nothing\n    Set oPDDoc = Nothing\n\n\nEnd Sub\n</code></pre>\n\n<p>Note: \n1-There is also a menu item <code>oPDFApp.MenuItemExecute (\"CopyFileToClipboard\")</code> that should do the select all and copy in one step, but I have had problems with it so I stick to the two-step method above.</p>\n\n<p>2-A pdf file consists of two objects, the <code>oAVDoc</code> and the <code>oPDDoc</code>. Different aspects of the file are controlled by each. In this case you might only need the <code>oAVDoc</code>. Try commenting out the lines dealing with <code>oPDDoc</code> and see if it works without them.</p>\n"}, {"tags": [], "owner": {"reputation": 133, "user_id": 8674336, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/e98e54e12ecc096c09664a2785312cfc?s=128&d=identicon&r=PG&f=1", "display_name": "saurabh255", "link": "https://stackoverflow.com/users/8674336/saurabh255"}, "is_accepted": false, "score": 0, "last_activity_date": 1506422736, "last_edit_date": 1506422736, "creation_date": 1506420890, "answer_id": 46423678, "question_id": 28835164, "link": "https://stackoverflow.com/questions/28835164/copying-data-from-multiple-pdf-files/46423678#46423678", "title": "Copying data from multiple pdf files", "body": "<p>try this code this might work:</p>\n\n<pre><code> Sub Shell_Copy_Paste()\n\n   Dim o As Variant\n   Dim wkSheet As Worksheet\n\n   Set wkSheet = ActiveSheet\n\n   o = Shell(\"C:\\Program Files (x86)\\Adobe\\Acrobat Reader DC\\Reader\\AcroRd32.exe C:\\Users\\saurabh.ad.sharma\\Desktop\\red.pdf\", vbNormalFocus)\n\n   Application.Wait (Now + TimeSerial(0, 0, 2)) 'Wait for Acrobat to load\n\n   SendKeys \"^a\"   'Select All\n   SendKeys \"^c\"   'Copy\n   SendKeys \"%{F4}\"    'Close shell application\n\n   wkSheet.Range(\"B5\").Select\n   SendKeys \"^v\"   'Paste\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 133, "user_id": 8674336, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/e98e54e12ecc096c09664a2785312cfc?s=128&d=identicon&r=PG&f=1", "display_name": "saurabh255", "link": "https://stackoverflow.com/users/8674336/saurabh255"}, "is_accepted": false, "score": 0, "last_activity_date": 1506680728, "creation_date": 1506680728, "answer_id": 46486858, "question_id": 28835164, "link": "https://stackoverflow.com/questions/28835164/copying-data-from-multiple-pdf-files/46486858#46486858", "title": "Copying data from multiple pdf files", "body": "<p>BELOW CODE WILL COPY DATA FROM PDF &amp; will PASTE IT IN WORD THEN COPY DATA FROM WORD AND THEN PASTE IT TO THE EXCEL .</p>\n\n<p>NOW Why I am copying data from pdf to word  &amp; then copying from word and pasting it to the excel because i want the data from the pdf in exact format to my excel sheet if i copy directly from pdf to excel it will paste the whole data from pdf into a single cell means even if i am having two columns or multiple rows it will paste all of my data into one column and that too in single cell but if i copy from word to excel it will retain its original format and two columns will get pasted as two columns only in excel.</p>\n\n<pre><code>Private Sub CommandButton3_Click()  '(load pdf)\n\n\n   Dim o As Variant\nSet appWord = CreateObject(\"Word.Application\")\n o = Shell(\"C:\\Program Files (x86)\\Adobe\\Acrobat Reader DC\\Reader\\AcroRd32.exe C:\\Users\\saurabh.ad.sharma\\Desktop\\Book1.pdf\", vbNormalFocus)   'loading adobe reader &amp; pdf file from their location\n Application.Wait (Now + TimeSerial(0, 0, 2))\n   SendKeys (\"^a\")\nSendKeys (\"^c\")\n SendKeys \"%{F4}\"\nApplication.Wait Now + TimeValue(\"00:00:01\")\n Set appWord = CreateObject(\"Word.Application\")\n appWord.Visible = True\n appWord.Documents.Add.Content.Paste\nWith appWord\n\n       .ActiveDocument.SaveAs Filename:=ThisWorkbook.Path &amp; \"\\pdf\" &amp; \".docx\", FileFormat:=wdocument   'saving word file in docx format\n        .ActiveWindow.Close\n        .Quit\n    End With\n\nMsgBox \" pdf is loaded \"\nMsgBox \" Paste to EXCEL \"\n\n    Set appWord = CreateObject(\"Word.Application\")\n     appWord.Visible = True\n\n  appWord.Documents.Open \"C:\\Users\\saurabh.ad.sharma\\Desktop\\pdf.docx\" 'opening word document\n      appWord.Selection.WholeStory\n      appWord.Selection.Copy\n   Set wkSheet = ActiveSheet\n    wkSheet.Range(\"A1\").Select\n    wkSheet.Paste 'pasting to the excel file\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 133, "user_id": 8674336, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/e98e54e12ecc096c09664a2785312cfc?s=128&d=identicon&r=PG&f=1", "display_name": "saurabh255", "link": "https://stackoverflow.com/users/8674336/saurabh255"}, "is_accepted": false, "score": 0, "last_activity_date": 1506682155, "creation_date": 1506682155, "answer_id": 46487258, "question_id": 28835164, "link": "https://stackoverflow.com/questions/28835164/copying-data-from-multiple-pdf-files/46487258#46487258", "title": "Copying data from multiple pdf files", "body": "<p>This is the more modified version of my above code it will not save any document it will save data in clipboard and will do the execution fast..</p>\n\n<pre><code>Private Sub CommandButton3_Click()  '(load pdf)\n\n\n   Dim o As Variant\nSet appWord = CreateObject(\"Word.Application\")\n o = Shell(\"C:\\Program Files (x86)\\Adobe\\Acrobat Reader DC\\Reader\\AcroRd32.exe C:\\Users\\saurabh.ad.sharma\\Desktop\\Book1.pdf2\", vbNormalFocus)\n Application.Wait (Now + TimeSerial(0, 0, 2))\n   SendKeys (\"^a\")\nSendKeys (\"^c\")\n SendKeys \"%{F4}\"\nApplication.Wait Now + TimeValue(\"00:00:01\")\n Set appWord = CreateObject(\"Word.Application\")\n appWord.Visible = False\n appWord.Documents.Add.Content.Paste\nWith appWord\n\n       .Selection.WholeStory\n       .Selection.Copy\n       .ActiveDocument.Close SaveChanges:=wdDoNotSaveChanges\n       .Quit\nEnd With\n\nMsgBox \" pdf is loaded \"\nMsgBox \" Paste to EXCEL \"\n\n\n   Set wkSheet = ActiveSheet\n    wkSheet.Range(\"A1\").Select\n    wkSheet.Paste\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 11099819, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZSypH7-ojNw/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQONpOjKDcau4n6ObItVNHngfIrebw/mo/photo.jpg?sz=128", "display_name": "DMM Wallnut", "link": "https://stackoverflow.com/users/11099819/dmm-wallnut"}, "is_accepted": false, "score": 0, "last_activity_date": 1579256889, "last_edit_date": 1579256889, "creation_date": 1571306964, "answer_id": 58430079, "question_id": 28835164, "link": "https://stackoverflow.com/questions/28835164/copying-data-from-multiple-pdf-files/58430079#58430079", "title": "Copying data from multiple pdf files", "body": "<p>I had similar problem. The best solution is, as it was mentioned before, to use Adobe API. In my case it was impossible because macro was intended for 100+ users without Adobe Pro on their PC.</p>\n\n<p>Ultimate solution that I have developed recently was to build converted in C# (for free using Visual Studio and iText library), install it on end users computers and run whenever I need via VBA. Here are some links for more guidance:</p>\n\n<ol>\n<li>How to develop pdf converter in C#: <a href=\"https://www.aspforums.net/Threads/180443/Convert-a-PDF-File-to-Excel-File-using-iTextSharp-using-C-Net/\" rel=\"nofollow noreferrer\">link</a></li>\n<li>How to create Excel Addin in C#: <a href=\"https://docs.microsoft.com/en-gb/visualstudio/vsto/walkthrough-creating-your-first-vsto-add-in-for-excel?view=vs-2019\" rel=\"nofollow noreferrer\">link</a></li>\n<li>How to run C# addin from VBA: <a href=\"https://docs.microsoft.com/en-gb/visualstudio/vsto/walkthrough-calling-code-in-a-vsto-add-in-from-vba?view=vs-2019\" rel=\"nofollow noreferrer\">link</a></li>\n</ol>\n\n<p>Overall it's fairly complicated but once done works like a dream.</p>\n\n<p>Another solution as mentioned before is to use sendkeys in VBA. My experience is that it requires some optimization to handle various opening and copying times (depending on file size). Below is code that worked for me, however it's not even near that fast and stable as C# converter.</p>\n\n<pre><code>Private Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As LongPtr) 'Initialize sleep function via Windows API\nPublic Sub CopyToSheet(destinationSheet As Worksheet, pathToPdf as String)\n'Copy data from PDF to worksheet\n\n    'Initialize timer\n    Dim StartTime As Double\n    StartTime = Timer\n\n    'Clear clipboard\n    Dim myData As DataObject\n    Set myData = New DataObject\n    myData.SetText text:=Empty\n    myData.PutInClipboard\n    Set myData = Nothing\n\n    'Build file paths\n    Dim pathToAdobe As String\n    pathToAdobe = \"\"\"C:\\Program Files (x86)\\Adobe\\Acrobat Reader DC\\Reader\\AcroRd32.exe\"\"\"\n    pathToPdf = \"\"\"\" &amp; pathToPdf &amp; \"\"\"\"\n\n    'Open PDF and wait untill it is open. If file is already opened it will be just activated\n    Dim pdfId As Long\n    pdfId = Shell(pathToAdobe &amp; \" \" &amp; pathToPdf, vbMaximizedFocus)\n    Do\n        Sleep (500)\n        If Round(Timer - StartTime, 2) &gt; 9 Then MsgBox \"Failed to open PDF\": Exit Sub  'Safety check\n    Loop Until Me.IsPdfOpen(pathToPdf)\n\n    'Copy and wait until copying is completed\n    SendKeys \"^a\"\n    SendKeys \"^c\"\n    Do\n        Sleep (500)\n        If Round(Timer - StartTime, 2) &gt; 18 Then MsgBox \"Failed to copy data to clipboard\": Exit Sub  'Safety check\n    Loop Until Me.GetClipboardStatus = \"ClipboardHasData\"\n\n    'Paste data into worksheet\n    destinationSheet.Activate\n    destinationSheet.Range(\"A1\").Select\n    destinationSheet.Paste\n\n    'Close pdf\n    Call Shell(\"TaskKill /F /PID \" &amp; CStr(pdfId), vbHide)\n\n    'Clear clipboard\n    Set myData = New DataObject\n    myData.SetText text:=Empty\n    myData.PutInClipboard\n    Set myData = Nothing\n\nEnd Sub\n\nFunction IsPdfOpen(pathToPdf) As Boolean\n'Check if PDF is already opened\n\n    'Build window name (window name is name of the application on Windows task bar)\n    Dim windowName As String\n    windowName = pathToPdf\n    windowName = Mid(windowName, InStrRev(windowName, \"\\\") + 1, Len(windowName) - InStrRev(windowName, \"\\\") + 1)\n    windowName = windowName + \" - Adobe Acrobat Reader DC\"\n\n    'Try to activate application to check if is opened\n    On Error Resume Next\n    AppActivate windowName, True\n    Select Case Err.Number\n        Case 5: IsPdfOpen = False\n        Case 0: IsPdfOpen = True\n        Case Else: Debug.Assert False\n    End Select\n    On Error GoTo 0\n\nEnd Function\n\nFunction GetClipboardStatus() As String\n'Check if copying data to clipboard is completed\n\n    Dim tempString As String\n    Dim myData As DataObject\n\n    'Try to put data from clipboard to string to check if operations on clipboard are completed\n    On Error Resume Next\n    Set myData = New DataObject\n    myData.GetFromClipboard\n    tempString = myData.GetText(1)\n    If Err.Number = 0 Then\n        If tempString = \"\" Then\n            GetClipboardStatus = \"ClipboardEmpty\"\n        Else\n            GetClipboardStatus = \"ClipboardHasData\"\n        End If\n    Else\n        GetClipboardStatus = \"ClipboardBusy\"\n    End If\n    On Error GoTo 0\n\n    Set myData = Nothing\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 3027640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f82d94a691733709d1070e3b2119c8?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3027640/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38546, "favorite_count": 1, "answer_count": 6, "score": 2, "last_activity_date": 1579256889, "creation_date": 1425395230, "last_edit_date": 1571386339, "question_id": 28835164, "link": "https://stackoverflow.com/questions/28835164/copying-data-from-multiple-pdf-files", "title": "Copying data from multiple pdf files", "body": "<p>I have pdf files from which I would like to copy all the data to a column in a spreadsheet.</p>\n\n<p>Here is the code I have. All it does is open the pdf, use control-a, then control-c to copy then activates the workbook, finds an open column and pastes the data with a control-v Sendkey.</p>\n\n<p>I have a range with path names it opens and copies data from all but only pastes the last one.</p>\n\n<pre><code>Sub StartAdobe1()\n\nDim AdobeApp As String\nDim AdobeFile As String\nDim StartAdobe\nDim fname As Variant\nDim iRow As Integer\nDim Filename As String\n\nFor Each fname In Range(\"path\")\n\n    AdobeApp = \"C:\\Program Files (x86)\\Adobe\\Reader 10.0\\Reader\\AcroRd32.exe\"\n    StartAdobe = Shell(\"\" &amp; AdobeApp &amp; \" \" &amp; fname &amp; \"\", 1)\n\n    Application.Wait Now + TimeValue(\"00:00:01\")\n    SendKeys \"^a\", True\n    Application.Wait Now + TimeValue(\"00:00:01\")\n    SendKeys \"^c\"\n    Application.Wait Now + TimeValue(\"00:00:01\")\n    SendKeys (\"%{F4}\")\n    Windows(\"transfer (Autosaved).xlsm\").Activate\n    Worksheets(\"new\").Activate\n\n    ActiveSheet.Range(\"A1\").Select\n    Selection.End(xlToRight).Offset(0, 1).Select\n\n    SendKeys \"^v\"\n    Application.Wait Now + TimeValue(\"00:00:2\")\n\nNext fname\n</code></pre>\n"}]