[{"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 1, "last_activity_date": 1469664865, "creation_date": 1469664865, "answer_id": 38625172, "question_id": 38624938, "link": "https://stackoverflow.com/questions/38624938/vba-copy-sheetvalues-paste-to-sheet-with-a-variable-name/38625172#38625172", "title": "VBA - Copy sheetvalues, paste to sheet with a variable name", "body": "<p>You are missing <code>.Value</code></p>\n\n<pre><code>Worksheets(DateRange.Value).Range(\"A1\").PasteSpecial Paste:=xlPasteValues\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": true, "score": 1, "last_activity_date": 1469664941, "creation_date": 1469664941, "answer_id": 38625179, "question_id": 38624938, "link": "https://stackoverflow.com/questions/38624938/vba-copy-sheetvalues-paste-to-sheet-with-a-variable-name/38625179#38625179", "title": "VBA - Copy sheetvalues, paste to sheet with a variable name", "body": "<pre><code>Set ws = Worksheets.Add(Before:=Worksheets(\"Calc\"))\nws.Name = DateRange.Value\nWorksheets(\"WWOutput\").Range(\"A1:Q1000000\").Copy\nws.Range(\"A1\").PasteSpecial Paste:=xlPasteValues\n</code></pre>\n\n<p>This should work for your needs.  I'm setting an object reference to the worksheet you added (called <code>ws</code>) and then setting its name to the <code>DateRange.Value</code>.  At that point it's simple enough to specify the worksheet necessary when pasting.  This way you can make use of the reference in any number of ways while working with it.  Let me know if you need any further explanation?</p>\n"}], "owner": {"reputation": 27, "user_id": 6372500, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d1e8a06de85ba30dda377a376186c9cb?s=128&d=identicon&r=PG&f=1", "display_name": "Josh M.", "link": "https://stackoverflow.com/users/6372500/josh-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1154, "favorite_count": 0, "accepted_answer_id": 38625179, "answer_count": 2, "score": 0, "last_activity_date": 1469664941, "creation_date": 1469663107, "question_id": 38624938, "link": "https://stackoverflow.com/questions/38624938/vba-copy-sheetvalues-paste-to-sheet-with-a-variable-name", "title": "VBA - Copy sheetvalues, paste to sheet with a variable name", "body": "<p>I have a user form that allows people to input the date range of the series of data, which will then be later used to name the outputs from the rest of the macro. I am trying to copy all the values on the first sheet <code>WWOutput</code>, where all the data is analyzed/calculated and paste to a newly created sheet with the name of the variable <code>DateRange</code>, which will obviously change each time. </p>\n\n<p>I am currently trying this: </p>\n\n<pre><code>Worksheets.Add(Before:=Worksheets(\"Calc\")).Name = DateRange.Value\nWorksheets(\"WWOutput\").Range(\"A1:Q1000000\").Copy\nWorksheets(DateRange).Range(\"A1\").PasteSpecial Paste:=xlPasteValues\n</code></pre>\n\n<p>The new sheet is created and the worksheet is copied but it is not copying to the one I want. If I try <code>.Cells</code> instead of <code>.Range</code> it gives me \"Type Mismatch\"</p>\n\n<p>What am I doing wrong?</p>\n\n<p>Josh</p>\n"}, {"tags": ["vba", "excel", "excel-2013"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 1, "creation_date": 1469665583, "post_id": 38624631, "comment_id": 64635832, "body": "Using <code>.EntireRow.Columns(43)</code> to reference the Column 43 regardless of the starting range is pretty clever."}, {"owner": {"reputation": 970, "user_id": 4083998, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/a342180636ab2ef90f08e1c2ae9f0527?s=128&d=identicon&r=PG&f=1", "display_name": "Chad Portman", "link": "https://stackoverflow.com/users/4083998/chad-portman"}, "edited": false, "score": 0, "creation_date": 1469679480, "post_id": 38624631, "comment_id": 64638653, "body": "Thank you for the help I will test when I get back to office on Friday. But reading it makes perfect sense"}, {"owner": {"reputation": 970, "user_id": 4083998, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/a342180636ab2ef90f08e1c2ae9f0527?s=128&d=identicon&r=PG&f=1", "display_name": "Chad Portman", "link": "https://stackoverflow.com/users/4083998/chad-portman"}, "edited": false, "score": 0, "creation_date": 1469679552, "post_id": 38624631, "comment_id": 64638671, "body": "Also agree with @Thomas the .entirerow.columns(43) was sweet idea."}, {"owner": {"reputation": 970, "user_id": 4083998, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/a342180636ab2ef90f08e1c2ae9f0527?s=128&d=identicon&r=PG&f=1", "display_name": "Chad Portman", "link": "https://stackoverflow.com/users/4083998/chad-portman"}, "edited": false, "score": 0, "creation_date": 1469717089, "post_id": 38624631, "comment_id": 64662448, "body": "Couldn&#39;t wait so I remote accessed my computer at work. These slight code modifications were the perfect solutions. I do have two follow up questions for clarification. 1) You state in one of the comments to  <code>&quot;always re-enable (screenupdating setting is not persistent)&quot;</code> however the code of <code>Application.ScreenUpdating = True</code> is not there so I was curious what you mean by this. I added that line of code on mine. 2) Just wondering about the hand me down code of preventing endloops is all about if you happen to know."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1469717966, "post_id": 38624631, "comment_id": 64663148, "body": "1) that comment was poorly-worded: started off as &quot;always re-enable events &quot; but then I tagged the bit about screenupdating on the end.  I will edit that to make it clearer.  2) typically when making changes to a sheet from within an event handler it&#39;s possible to re-trigger the event, which may in some cases get you into an endless loop.   That&#39;s not the case here since just hiding or showing rows doesn&#39;t trigger the change event, so turning off events is not really retired."}, {"owner": {"reputation": 970, "user_id": 4083998, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/a342180636ab2ef90f08e1c2ae9f0527?s=128&d=identicon&r=PG&f=1", "display_name": "Chad Portman", "link": "https://stackoverflow.com/users/4083998/chad-portman"}, "edited": false, "score": 0, "creation_date": 1469805236, "post_id": 38624631, "comment_id": 64705240, "body": "Thanks for the clarification"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 4, "last_activity_date": 1469718031, "last_edit_date": 1469718031, "creation_date": 1469661010, "answer_id": 38624631, "question_id": 38624532, "link": "https://stackoverflow.com/questions/38624532/hiding-rows-with-excel-2013/38624631#38624631", "title": "Hiding Rows with Excel 2013", "body": "<p>Some adjustments to your event handler:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim rng As Range\n\n    On Error GoTo haveError\n\n    Set rng = Application.Intersect(Target, Me.Range(\"A4,D4,G4,K4,AO4,AR4,AU4,AY4\"))\n\n    If Not rng Is Nothing Then\n        Application.EnableEvents = False 'to prevent endless loop\n        Application.ScreenUpdating = False\n        CompHide\n        Application.EnableEvents = True\n    End If\n    Exit Sub\n\nhaveError:\n    'always re-enable events\n    '  (screenupdating setting is not persistent)...\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>and the other part:</p>\n\n<pre><code>Sub CompHide()\n\n    Dim sht As Worksheet, C As Range\n\n    Set sht = Sheets(\"Comparison\")\n    sht.Rows.Hidden = False\n\n    SetRowVis \"C9\", \"CMarket1\"\n    SetRowVis \"C115\", \"CMarket2\"\n    '...and the rest\n\n    For Each C In sht.Range(\"CNonTest\")\n        If C.Value = \"\" And C.EntireRow.Columns(43).Value = \"\" Then\n            C.EntireRow.Hidden = True\n        End If\n    Next\n\n    sht.Range(\"CBlank\").EntireRow.Hidden = True\nEnd Sub\n\n'utility sub...\nSub SetRowVis(addr As String, rngName As String)\n    With Sheets(\"Comparison\")\n        If .Range(addr).Value = \"Unused\" Then\n            .Range(rngName).EntireRow.Hidden = True\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 970, "user_id": 4083998, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/a342180636ab2ef90f08e1c2ae9f0527?s=128&d=identicon&r=PG&f=1", "display_name": "Chad Portman", "link": "https://stackoverflow.com/users/4083998/chad-portman"}, "edited": false, "score": 0, "creation_date": 1469679587, "post_id": 38624646, "comment_id": 64638680, "body": "Thanks for the idea even if he beat you to it."}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 1, "last_activity_date": 1469661103, "creation_date": 1469661103, "answer_id": 38624646, "question_id": 38624532, "link": "https://stackoverflow.com/questions/38624532/hiding-rows-with-excel-2013/38624646#38624646", "title": "Hiding Rows with Excel 2013", "body": "<p>1st, you have referencing issue on your <code>CompHide</code> Sub.<br>\nYou need to fully reference all <code>Range</code> object call to the worksheet.</p>\n\n<pre><code>With Sheets(\"Comparison\")\n    .Cells.EntireRow.Hidden = False\n    'Notice the dot in front of the Range object\n    If .Range(\"C9\").Value = \"Unused\" Then .Range(\"CMarket1\").EntireRow.Hidden = True\n    'Also notice that I used a one liner IF which I think is applicable for you\n    'Rest of your code go here\n    '.\n    '.\n    '.\n\nEnd With\n</code></pre>\n\n<p>2nd, take a look on Tim's post. He beats me to it. :)</p>\n"}], "owner": {"reputation": 970, "user_id": 4083998, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/a342180636ab2ef90f08e1c2ae9f0527?s=128&d=identicon&r=PG&f=1", "display_name": "Chad Portman", "link": "https://stackoverflow.com/users/4083998/chad-portman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 38624631, "answer_count": 2, "score": 2, "last_activity_date": 1469718031, "creation_date": 1469660315, "last_edit_date": 1469660385, "question_id": 38624532, "link": "https://stackoverflow.com/questions/38624532/hiding-rows-with-excel-2013", "title": "Hiding Rows with Excel 2013", "body": "<p>So I am attempting to hide rows in Excel 2013 using VBA based a several different conditions:</p>\n\n<ul>\n<li>If title of section is \"Unused\" hide section. Each section is a named range to make this easier.</li>\n<li>If row is part of the \"Cblank\" named range hide it.</li>\n<li>Now for the hard part -- For each Cell in Range(\"CNonTest\") if C.Value = \"\" and C.Columns(41).Value = \"\" Then hide them.</li>\n</ul>\n\n<p>Range(\"CNonTest\") is in Col C the extra column that should be check is Col AQ.</p>\n\n<p>For added difficulty I need this macro to run every time any 1 of 8 different validation boxes changes.</p>\n\n<p>Below is the code I currently have:</p>\n\n<pre><code>    Sub CompHide()\n\n    With Sheets(\"Comparison\").Cells\n       .EntireRow.Hidden = False\n\n    If Range(\"C9\").Value = \"Unused\" Then\n        Range(\"CMarket1\").EntireRow.Hidden = True\n    End If\n\n    If Range(\"C115\").Value = \"Unused\" Then\n        Range(\"CMarket2\").EntireRow.Hidden = True\n    End If\n\n    If Range(\"C221\").Value = \"Unused\" Then\n        Range(\"CMarket3\").EntireRow.Hidden = True\n    End If\n\n    If Range(\"C329\").Value = \"Unused\" Then\n        Range(\"CMarket4\").EntireRow.Hidden = True\n    End If\n\n    If Range(\"C437\").Value = \"Unused\" Then\n        Range(\"CMarket5\").EntireRow.Hidden = True\n    End If\n\n    If Range(\"C545\").Value = \"Unused\" Then\n        Range(\"CMarket6\").EntireRow.Hidden = True\n    End If\n\n    If Range(\"C653\").Value = \"Unused\" Then\n        Range(\"CMarket7\").EntireRow.Hidden = True\n    End If\n\n    If Range(\"C761\").Value = \"Unused\" Then\n        Range(\"CMarket8\").EntireRow.Hidden = True\n    End If\n\n    If Range(\"C869\").Value = \"Unused\" Then\n        Range(\"CMarket9\").EntireRow.Hidden = True\n    End If\n\n    If Range(\"C977\").Value = \"Unused\" Then\n        Range(\"CMarket10\").EntireRow.Hidden = True\n    End If\n\n    For Each C In Range(\"CNonTest\")\n        If C.Value = \"\" And C.Columns(41).Value = \"\" Then\n            C.EntireRow.Hidden = True\n        End If\n    Next\n\n\n\n    Range(\"CBlank\").EntireRow.Hidden = True\n\n    End With\nEnd Sub\n</code></pre>\n\n<p>Then on the Sheet I have this code:</p>\n\n<pre><code>    Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf Intersect(Target, Me.Range(\"A4\")) Is Nothing _\n    Or _\n    Intersect(Target, Me.Range(\"D4\")) Is Nothing _\n    Or _\n    Intersect(Target, Me.Range(\"G4\")) Is Nothing _\n    Or _\n    Intersect(Target, Me.Range(\"K4\")) Is Nothing _\n    Or _\n    Intersect(Target, Me.Range(\"AO4\")) Is Nothing _\n    Or _\n    Intersect(Target, Me.Range(\"AR4\")) Is Nothing _\n    Or _\n    Intersect(Target, Me.Range(\"AU4\")) Is Nothing _\n    Or _\n    Intersect(Target, Me.Range(\"AY4\")) Is Nothing _\n    Then Exit Sub\n\n    Application.EnableEvents = False 'to prevent endless loop\n    Application.ScreenUpdating = False\n\n    Call CompHide\n\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\n\n\nEnd Sub\n</code></pre>\n\n<p>For the Sheet Code I have also tried this to no avail</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf Intersect(Target, Me.Range(\"A4\")) Is Nothing Then Exit Sub\n\n    Application.EnableEvents = False 'to prevent endless loop\n    Application.ScreenUpdating = False\n\n    Call CompHide\n\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\n\n\n\nIf Intersect(Target, Me.Range(\"D4\")) Is Nothing Then Exit Sub\n\n    Application.EnableEvents = False 'to prevent endless loop\n    Application.ScreenUpdating = False\n\n    Call CompHide\n\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\n\n\n\nIf Intersect(Target, Me.Range(\"G4\")) Is Nothing Then Exit Sub\n\n    Application.EnableEvents = False 'to prevent endless loop\n    Application.ScreenUpdating = False\n\n    Call CompHide\n\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\n\n\n\nIf Intersect(Target, Me.Range(\"K4\")) Is Nothing Then Exit Sub\n\n    Application.EnableEvents = False 'to prevent endless loop\n    Application.ScreenUpdating = False\n\n    Call CompHide\n\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\n\n\n\nIf Intersect(Target, Me.Range(\"AO4\")) Is Nothing Then Exit Sub\n\n    Application.EnableEvents = False 'to prevent endless loop\n    Application.ScreenUpdating = False\n\n    Call CompHide\n\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\n\n\n\nIf Intersect(Target, Me.Range(\"AR4\")) Is Nothing Then Exit Sub\n\n    Application.EnableEvents = False 'to prevent endless loop\n    Application.ScreenUpdating = False\n\n    Call CompHide\n\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\n\n\n\nIf Intersect(Target, Me.Range(\"AU4\")) Is Nothing Then Exit Sub\n\n    Application.EnableEvents = False 'to prevent endless loop\n    Application.ScreenUpdating = False\n\n    Call CompHide\n\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\n\n\nIf Intersect(Target, Me.Range(\"AY4\")) Is Nothing Then Exit Sub\n\n    Application.EnableEvents = False 'to prevent endless loop\n    Application.ScreenUpdating = False\n\n    Call CompHide\n\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\n\n\nEnd Sub\n</code></pre>\n\n<p>This code all seems to work fine and when I step through CompHide using F8 it works perfectly. So I am thinking the issue is from the code on the sheet itself. You will see a comment in that code that mentions to prevent endless loop that comment came from some hand me down code not quite sure what it is for but figured based on the comment I would leave it.</p>\n\n<p>When I change a validation box it no longer hides the all the right things only some of them. Luckily I have not seen it hide something it was not suppose to yet. I say no longer because at first this code only looked at the first validation box but now it looks at all 8.</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1469654961, "post_id": 38623423, "comment_id": 64632621, "body": "You&#39;ll need to make an effort to do this on your own. We generally don&#39;t write code for you, but rather help you address specific problems you&#39;re running into. To get started, you&#39;ll want to take a look at the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow noreferrer\">Range.Find method</a>. If you get stuck, edit your question to include what code you&#39;ve tried."}, {"owner": {"reputation": 3, "user_id": 6636695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d44ec3619d46bc834f35a710e1c9bd0e?s=128&d=identicon&r=PG&f=1", "display_name": "Capnindigo", "link": "https://stackoverflow.com/users/6636695/capnindigo"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1470152514, "post_id": 38623423, "comment_id": 64825832, "body": "Apologies, I was in a bit of a hurry as I wrote this. I&#39;ve edited my question with what I had tried, and what error I was getting. Thanks."}], "owner": {"reputation": 3, "user_id": 6636695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d44ec3619d46bc834f35a710e1c9bd0e?s=128&d=identicon&r=PG&f=1", "display_name": "Capnindigo", "link": "https://stackoverflow.com/users/6636695/capnindigo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1470153073, "creation_date": 1469654560, "last_edit_date": 1531161705, "question_id": 38623423, "link": "https://stackoverflow.com/questions/38623423/i-need-to-generate-a-list-by-cross-referencing-two-other-datasets", "title": "I need to generate a list by cross referencing two other datasets", "body": "<p>I'm very new to trying to code and I've got a problem that has completely defeated my fledgling VBA skills. I need to take a list of recent hires and cross reference it with a list of all employees with errors, then use that data to generate a list of new hires with errors. </p>\n\n<p>The script has to check and see if a recent hire is on the error list, then check to see if the error is \"closed\" or \"closedfb\" in the Close State column. If the error is \"closedfb\", it needs to display their login, name, manager and the number of errors, in that order, on a new list. The hitch is that a given employee may appear multiple times on the errors list.</p>\n\n<p>The data sets with the new employees and errors are set up as follows:</p>\n\n<p>The first sheet is titled New_Employee_List</p>\n\n<pre><code>:Employee Login: :Employee Name: :other data: :Start Date (column 7): :Manager Login:\n         X             X               X                 X                   X\n         X             X               X                 X                   X\n         X             X               X                 X                   X\n</code></pre>\n\n<p>The second sheet is titled Errors_Raw_Data</p>\n\n<pre><code>:unused data: :Close State (column 5): :Employee (6):  :Number:\n      X              X          X         X\n      X              X          X         X\n      X              X          X         X\n</code></pre>\n\n<p>Here is what I've tried so far, starting with a bit of code I found online. \n    Sub FPS_Macro()\n    Dim NSName As String 'New Start Names\n    Dim Found As Boolean</p>\n\n<pre><code>Range(\"Sherlock_Raw_Data!H2\").Select 'First line of data\n\nNSName = Summary_Report!B2 'Search variable value\n\nDo Until IsEmpty(ActiveCell) 'Loop until cell is empty\n    If ActiveCell.Value = NSName Then\n        Found = True\n        Exit Do\n    End If\n\n    ActiveCell.Offset(1, 0).Select\nLoop\n\nIf Found = True Then 'Check for Found\n    NewStartFPS!A2 = ActiveCell\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>I'd started with just trying to get the code to run through the one sheet and find if there were matching names on the other sheet. Unfortunately the above code returns the following error.</p>\n\n<pre><code>Run time error '1004':\nMethod 'Range' of object '_Global' failed\n</code></pre>\n\n<p>Hopefully someone can point out what I'm doing wrong.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1469656234, "post_id": 38623323, "comment_id": 64633204, "body": "You are going to want to use a standard for loop and loop back wards <code>For  LastColumn to 8 Step -1</code>"}, {"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1469657126, "post_id": 38623323, "comment_id": 64633563, "body": "@ScottCraner second time today this has happened to me. I wrote up my answer before reading your comment honest! I&#39;m going to get a bad rep for this soon :s"}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1469657414, "post_id": 38623954, "comment_id": 64633670, "body": "No problem, If I had given a formula someone just copied and pasted it in an answer with no further explanation I would be mad, but you explained what was said and showed how."}, {"owner": {"reputation": 55, "user_id": 6506274, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/620084ed05ea80fd33d87198c635204d?s=128&d=identicon&r=PG&f=1", "display_name": "mynameisgooch", "link": "https://stackoverflow.com/users/6506274/mynameisgooch"}, "edited": false, "score": 1, "creation_date": 1469714928, "post_id": 38623954, "comment_id": 64660719, "body": "Thanks a lot @Gary! This got me on the right track! Never thought to work backwards like that. The only thing is I had to tweak the code a little bit to change all of the <code>.offset(0,1)</code> occurrences to <code>offset(0,-1)</code> to account for moving backwards."}], "tags": [], "owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "is_accepted": true, "score": 2, "last_activity_date": 1469657034, "creation_date": 1469657034, "answer_id": 38623954, "question_id": 38623323, "link": "https://stackoverflow.com/questions/38623323/extending-last-column-excel-vba/38623954#38623954", "title": "Extending Last Column Excel VBA", "body": "<p>There are a number of way to achieve this, retaining the code you have I would suggest the following alteration, work backwards. When you are working with a collection and adding to it then size of the collection changes but your reference is still linked to the original size. This is the problem you are having.</p>\n\n<p>By working backwards you are not affected by the change in size.</p>\n\n<p>To do this use can use <code>Step -1</code> in a loop as per below:-</p>\n\n<pre><code>Sub weekendsouts()\n\nDim OUTSDATA As Worksheet, LastColumn As Long, _\nDateCell As Range, DateRange As Range\n\nSet OUTSDATA = Worksheets(\"OUTS DATA\")\n    LastColumn = OUTSDATA.UsedRange.Columns.Count\n    Set DateRange = OUTSDATA.Range(OUTSDATA.Cells(2, 8), OUTSDATA.Cells(2, LastColumn).Address)\n\n        For LastColumn = LastColumn to 0 Step - 1 \n            'For Each DateCell In DateRange\n            Set DateCell = OUTSDATA.Cells(2,LastColumn)\n                With DateCell\n                    If .Value &lt;&gt; \"\" Then\n                        If .Offset(0, 1).Value &lt;&gt; .Value + 1 And .Offset(0, 1).Value &lt;&gt; .Value Then\n                            .Offset(0, 1).EntireColumn.Insert\n                            .EntireColumn.Copy Destination:=.Offset(-1, 1)\n                            .Offset(0, 1).Value = .Offset(0, 1).Value + 1\n                        End If\n                    End If\n                End With\n            Set DateCell = Nothing\n        Next    \n    Set DateRange = Nothing    \nSet OUTSDATA = Nothing\nEnd Sub\n</code></pre>\n\n<p>(This is untested, use as an example to adapt)</p>\n\n<p>What is happening here is that is <code>LastColumn</code> was 10 then the loop starts at ten, and the next iteration is till be 9, then 8, etc...</p>\n"}], "owner": {"reputation": 55, "user_id": 6506274, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/620084ed05ea80fd33d87198c635204d?s=128&d=identicon&r=PG&f=1", "display_name": "mynameisgooch", "link": "https://stackoverflow.com/users/6506274/mynameisgooch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 38623954, "answer_count": 1, "score": 0, "last_activity_date": 1469657034, "creation_date": 1469654152, "question_id": 38623323, "link": "https://stackoverflow.com/questions/38623323/extending-last-column-excel-vba", "title": "Extending Last Column Excel VBA", "body": "<p>I wrote this macro below to check to see if there is a gap between two dates in adjacent columns and then insert columns to fill in that gap. </p>\n\n<p>I want it to be able to run it on as many columns as there are on the worksheet, but, for some reason, DateRange is stuck on the initial size of the worksheet and is not factoring in the additional columns the macro has been adding. I've never had a problem with this before, so I'm stumped! </p>\n\n<p>Anyone out there know what I could do to fix this?</p>\n\n<pre><code>Sub weekendsouts()\n\nDim OUTSDATA As Worksheet, LastColumn As Long, _\nDateCell As Range, DateRange As Range\n\nSet OUTSDATA = Worksheets(\"OUTS DATA\")\nLastColumn = OUTSDATA.UsedRange.Columns.Count\nSet DateRange = OUTSDATA.Range(OUTSDATA.Cells(2, 8), OUTSDATA.Cells(2, LastColumn).Address)\n\nFor Each DateCell In DateRange\n    With DateCell\n        If .Value &lt;&gt; \"\" Then\n            If .Offset(0, 1).Value &lt;&gt; .Value + 1 And .Offset(0, 1).Value &lt;&gt; .Value Then\n                .Offset(0, 1).EntireColumn.Insert\n                .EntireColumn.Copy Destination:=.Offset(-1, 1)\n                .Offset(0, 1).Value = .Offset(0, 1).Value + 1\n            End If\n        End If\n    End With\nNext DateCell\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 6646817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e642b851df138d9ade9a0ab22bc2a4de?s=128&d=identicon&r=PG&f=1", "display_name": "angel", "link": "https://stackoverflow.com/users/6646817/angel"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1469658898, "post_id": 38623305, "comment_id": 64634167, "body": "Can you offer the code to do this? Thanks!"}, {"owner": {"reputation": 1, "user_id": 6646817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e642b851df138d9ade9a0ab22bc2a4de?s=128&d=identicon&r=PG&f=1", "display_name": "angel", "link": "https://stackoverflow.com/users/6646817/angel"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1469719621, "post_id": 38623305, "comment_id": 64664403, "body": "Here is my current code.  Like I said, I&#39;m a VBA newbie.  The code creates new sheets from the employee list, and copies data, but now I need it to also copy the entire sheet2 (eval form), and place the data (name cell A1 from employee list) into the form on sheet3 (new sheet) in cell D4."}], "answers": [{"tags": [], "owner": {"reputation": 11755, "user_id": 4797603, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/AwTvE.jpg?s=128&g=1", "display_name": "Ronnie Royston", "link": "https://stackoverflow.com/users/4797603/ronnie-royston"}, "is_accepted": false, "score": 0, "last_activity_date": 1469722511, "last_edit_date": 1592644375, "creation_date": 1469722511, "answer_id": 38641705, "question_id": 38623305, "link": "https://stackoverflow.com/questions/38623305/need-vb-code-that-will-merge-two-sheets-into-a-new-sheet/38641705#38641705", "title": "Need VB code that will merge two sheets into a new sheet", "body": "<h1><a href=\"https://support.office.com/en-us/article/Create-or-delete-a-macro-2841ba85-9da6-4bd7-93a4-0da90844f283?CorrelationId=633ccce5-21a8-4af4-be9e-ee7eac8683e2&amp;ui=en-US&amp;rs=en-US&amp;ad=US&amp;ocmsassetID=HP010342374\" rel=\"nofollow noreferrer\">Record a macro</a></h1>\n<p>When you record a macro, the macro recorder records all the steps required to complete the actions that you want your macro to perform.  Iterate your action once, stop recording, then view the macro to repeat and build out your final automation macro.</p>\n<p><a href=\"https://i.stack.imgur.com/hFsOG.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hFsOG.gif\" alt=\"enter image description here\" /></a></p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6646817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e642b851df138d9ade9a0ab22bc2a4de?s=128&d=identicon&r=PG&f=1", "display_name": "angel", "link": "https://stackoverflow.com/users/6646817/angel"}, "edited": false, "score": 0, "creation_date": 1469730959, "post_id": 38643046, "comment_id": 64671502, "body": "Thanks! Works great!  I added the code below to copy specific info from Sheet1 to the new sheet, but it of course pulls the data from row1 repeatedly. What do I add to have it pull the data from the next row?       Range(&quot;F4:G4&quot;).Select     ActiveCell.FormulaR1C1 = &quot;=sheet1!R[-2]C[-3]&quot;"}, {"owner": {"reputation": 2324, "user_id": 1036274, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/p07PE.jpg?s=128&g=1", "display_name": "nunzabar", "link": "https://stackoverflow.com/users/1036274/nunzabar"}, "reply_to_user": {"reputation": 1, "user_id": 6646817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e642b851df138d9ade9a0ab22bc2a4de?s=128&d=identicon&r=PG&f=1", "display_name": "angel", "link": "https://stackoverflow.com/users/6646817/angel"}, "edited": false, "score": 1, "creation_date": 1469732233, "post_id": 38643046, "comment_id": 64672240, "body": "My goal was just to point you in the right direction, angel. Think of the satisfaction you will feel when you work out the details on your own. Good luck."}], "tags": [], "owner": {"reputation": 2324, "user_id": 1036274, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/p07PE.jpg?s=128&g=1", "display_name": "nunzabar", "link": "https://stackoverflow.com/users/1036274/nunzabar"}, "is_accepted": false, "score": 0, "last_activity_date": 1469726919, "creation_date": 1469726919, "answer_id": 38643046, "question_id": 38623305, "link": "https://stackoverflow.com/questions/38623305/need-vb-code-that-will-merge-two-sheets-into-a-new-sheet/38643046#38643046", "title": "Need VB code that will merge two sheets into a new sheet", "body": "<p>This code demonstrates the basic principles you need:</p>\n\n<pre><code>Sub ExampleForAngel()\n    Dim names As Worksheet\n    Set names = Worksheets(\"Sheet1\")\n    Dim eval As Worksheet\n    Set eval = Worksheets(\"Sheet2\")\n    Dim index As Long\n    index = 0\n    Dim name As String\n    While (names.Range(\"A1\").Offset(index, 0).Value &lt;&gt; \"\")\n        name = names.Range(\"A1\").Offset(index, 0)\n        eval.Copy after:=Worksheets(Worksheets.Count)\n        ActiveSheet.name = name\n        ActiveSheet.Range(\"A2\").Value = name\n        index = index + 1\n    Wend\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6646817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e642b851df138d9ade9a0ab22bc2a4de?s=128&d=identicon&r=PG&f=1", "display_name": "angel", "link": "https://stackoverflow.com/users/6646817/angel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1469726919, "creation_date": 1469654084, "last_edit_date": 1469721786, "question_id": 38623305, "link": "https://stackoverflow.com/questions/38623305/need-vb-code-that-will-merge-two-sheets-into-a-new-sheet", "title": "Need VB code that will merge two sheets into a new sheet", "body": "<p>I am new to VB, and need some help. I have an excel 2013 workbook that has 2 sheets. Sheet1 is list of employee names (column A has 20 names), dob (column B), etc, and Sheet2 is a blank evaluation form. I need a code that will copy the entire Sheet2 (the blank form) and paste into a new Sheet3, and also pull the EmpName from row1 to a specified cell on Sheet3 (D4), same with DOB (J4), etc.  I need it to repeat this process for every name on Sheet1.  End goal is to have a workbook that contains 20 sheets, one for each employee, in the form of an evaluation. It would also be terrific if this code could name the tab the employee name.  Is this possible?  I've searched online extensively, and cannot find anything fitting.</p>\n\n<p>Here is my current code. Like I said, I'm a VBA newbie. The code creates new sheets from the employee list, and copies data, but now I need it to also copy the entire sheet2 (eval form), and place the data (name cell A1 from employee list) into the form on sheet3 (new sheet) in cell D4.</p>\n\n<p>Sub CreateSheetsFromEmployeeList()  </p>\n\n<pre><code>Dim nameSource  \nDim nameColumn      \nDim nameStartRow    As Long     \nDim nameEndRow      As Long     \nDim employeeName    As String   \nDim newSheet        As Worksheet    \n\nnameSource = \"Ayre\" \nnameColumn = \"A\"    \nnameStartRow = 2    \n\nnameEndRow = Worksheets(nameSource).Cells(Rows.Count, nameColumn).End(xlUp).Row \nDo While (nameStartRow &lt;= nameEndRow)   \n    employeeName = Sheets(nameSource).Cells(nameStartRow, nameColumn)   \n    employeeName = Trim(employeeName)   \n    If (employeeName &lt;&gt; vbNullString) Then  \n        On Error Resume Next 'do not throw error    \n        Err.Clear 'clear any existing error \n\n        Sheets(employeeName).Name = employeeName    \n        If (Err.Number &gt; 0) Then    \n            Err.Clear   \n            On Error GoTo -1    \n            Set newSheet = Sheets.Add(After:=Sheets(Sheets.Count))  \n            newSheet.Name = employeeName    \n\n            Sheets(nameSource).Activate \n            LastCol = ActiveSheet.Cells(nameStartRow, Application.Columns.Count).End(xlToLeft).Column   \n            Range(Cells(nameStartRow, 1), Cells(nameStartRow, LastCol)).Select  \n            Selection.Copy  \n\n            Sheets(employeeName).Activate  'NEW \n            Sheets(employeeName).Cells(1, \"A\").PasteSpecial \n            [a1].Select  'NEW   \n            Application.CutCopyMode = False \n            Sheets(employeeName).Columns(\"A:K\").AutoFit \n        End If  \n    End If  \n    nameStartRow = nameStartRow + 1     \nLoop    \nEnd Sub \n</code></pre>\n"}, {"tags": ["vba", "excel", "loops", "for-loop"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1469654188, "post_id": 38623282, "comment_id": 64632231, "body": "So you really just want the data entry to start at the first non-empty cell below cell A18?"}, {"owner": {"reputation": 25, "user_id": 6621077, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9fb1153ba268d258101d4627e10894ee?s=128&d=identicon&r=PG&f=1", "display_name": "Max Fitzgerald", "link": "https://stackoverflow.com/users/6621077/max-fitzgerald"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1469654285, "post_id": 38623282, "comment_id": 64632288, "body": "@dbmitch yes that&#39;s correct, and I want it to loop until the first input box receives blank entry"}], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 3, "last_activity_date": 1469654714, "creation_date": 1469654714, "answer_id": 38623447, "question_id": 38623282, "link": "https://stackoverflow.com/questions/38623282/how-can-i-run-a-loop-of-an-input-box-that-puts-the-data-on-a-different-row-in-vb/38623447#38623447", "title": "How can I run a loop of an input box that puts the data on a different row in VBA", "body": "<p>A <a href=\"https://msdn.microsoft.com/en-us/library/eked04a7.aspx\" rel=\"nofollow\">'Do ... Loop Until'</a> will serve you here.</p>\n\n<pre><code>Sub Non_stores_material_entering()\n\nDim ws as Worksheet\nSet ws = Worksheets(\"Sheet1\") 'change name as needed\n\nDo\n\n    NonStores = InputBox(\"What is the Non-Stores Material?\")\n\n    If Len(NonStores) Then\n\n        Dim lRow As Long\n        lRow = ws.Range(\"A\" &amp; ws.Rows.Count).End(xlUp).Offset(1).Row\n\n        ws.Cells(lRow, 1).Value = NonStores\n\n        LeadTimes = InputBox(\"What is the Non-Stores Material's Lead TIme?\")\n\n        ws.Cells(lRow, 3).Value = LeadTimes\n\n    End If\n\nLoop Until Len(NonStores) = 0\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 6621077, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9fb1153ba268d258101d4627e10894ee?s=128&d=identicon&r=PG&f=1", "display_name": "Max Fitzgerald", "link": "https://stackoverflow.com/users/6621077/max-fitzgerald"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 747, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1469654714, "creation_date": 1469653985, "question_id": 38623282, "link": "https://stackoverflow.com/questions/38623282/how-can-i-run-a-loop-of-an-input-box-that-puts-the-data-on-a-different-row-in-vb", "title": "How can I run a loop of an input box that puts the data on a different row in VBA", "body": "<p>I have a spreadsheet that you press a Form Control Button, and that will prompt a Input Box that asks you to enter a name of non-stores item. Then if you enter in something in the input box it will put it in cell A19, then it will ask you for the lead time of the item and put that in C19. If you don't enter anything in the Non-stores Material input it will not bring up the lead time in put box.</p>\n\n<p>What I want to happen is I press the button and it asks you if there is non-stores item, if you enter in anything it will assign that to A19 and then ask you for a lead time and assign it to C19, then loop back to ask you the name of the non-stores material and if you put in anything it assigns it now to A20 and then lead time to C20. If you enter in blank when asking for name of non-stores it will just end it. I also want this to be able to enter in some info and then later you can press the button and if there's some value in the A19 it will put it in the row below.</p>\n\n<p>Here is my Current code:</p>\n\n<pre><code>Sub Non_stores_material_entering()\n\n\nIf ActiveSheet.Range(\"A19\") = \"\" Then\nNonStores = InputBox(\"What is the Non-Stores Material?\")\nRange(\"A19\").Select\nActiveCell.Value = NonStores\nElse:\nEnd If\n\nIf ActiveSheet.Range(\"A19\") = \"\" Then\nElse:\nLeadTimes = InputBox(\"What is the Non-Stores Material's Lead TIme?\")\nRange(\"C19\").Select\nActiveCell.Value = LeadTimes\nEnd If\n\n\nEnd Sub\n</code></pre>\n\n<p>This is what it looks like for a visual purpose. <a href=\"http://i.stack.imgur.com/CixlH.png\" rel=\"nofollow\">Non-Stores Spreadsheet Picture</a></p>\n"}, {"tags": ["vba", "excel", "date", "dynamic"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1469654481, "post_id": 38623269, "comment_id": 64632391, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/34427121/excel-vba-comparing-between-a-given-date-and-given-date-2-months\">Excel VBA Comparing between a given date and (given date - 2 months)</a>"}, {"owner": {"reputation": 123, "user_id": 6190062, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ecacb85aa6e43a64450919689ec38b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Davey ", "link": "https://stackoverflow.com/users/6190062/davey"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1469655353, "post_id": 38623269, "comment_id": 64632794, "body": "It might be somewhat of a duplicate but I&#39;m still confused by it. Working on trying to understand it"}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 6190062, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ecacb85aa6e43a64450919689ec38b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Davey ", "link": "https://stackoverflow.com/users/6190062/davey"}, "edited": false, "score": 0, "creation_date": 1469658090, "post_id": 38623833, "comment_id": 64633906, "body": "I&#39;m following, that makes total sense. And yeah a function can be written. It doesn&#39;t necessarily need to be 1 expression. I just thought it could be done, but definitely not necessary"}], "tags": [], "owner": {"reputation": 597, "user_id": 2657508, "user_type": "registered", "profile_image": "https://graph.facebook.com/1637015147/picture?type=large", "display_name": "JefferMC", "link": "https://stackoverflow.com/users/2657508/jeffermc"}, "is_accepted": false, "score": -1, "last_activity_date": 1469715285, "last_edit_date": 1469715285, "creation_date": 1469656451, "answer_id": 38623833, "question_id": 38623269, "link": "https://stackoverflow.com/questions/38623269/month-ending-date-vba/38623833#38623833", "title": "Month Ending Date VBA", "body": "<p>The Weekday() function will tell you what the current day of the week is (Sun=1, Mon=2, etc.).  So, if Weekday() &lt; 4, then you want the date Weekday() days ago.  If WeekDay() >= 3, then you want 7 - Weekday() days in the future.</p>\n\n<pre><code>Function MonthEnd(d)\n    Dim actualmonthend, dow, ans\n    actualmonthend = DateSerial(Year(d), Month(d) + 1, 1) - 1\n    dow = Weekday(actualmonthend)\n    If (dow &lt; 4) Then\n        ans = actualmonthend - dow\n    Else\n        ans = actualmonthend + (7 - dow)\n    End If\n    MonthEnd = ans\nEnd Function\n</code></pre>\n\n<p>if you really just want an expression this would work:</p>\n\n<pre><code>DateSerial(Year(d), Month(d) + 1, 1) - 1 - Weekday(DateSerial(Year(d), Month(d) + 1, 1) - 1) + (7 * Abs(Weekday(DateSerial(Year(d), Month(d) + 1, 1) - 1) &gt;= 4))\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 6190062, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ecacb85aa6e43a64450919689ec38b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Davey ", "link": "https://stackoverflow.com/users/6190062/davey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1045, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1469715285, "creation_date": 1469653924, "last_edit_date": 1531164843, "question_id": 38623269, "link": "https://stackoverflow.com/questions/38623269/month-ending-date-vba", "title": "Month Ending Date VBA", "body": "<p>I need help writing one line of code in VBA to return the Month-Ending date. The logic for Month-Ending date works like this...</p>\n\n<p>If the last day of the month ends on...</p>\n\n<p>Sunday: Then last day of that month is that previous Saturday. (Yesterday)</p>\n\n<p>Monday: Then last day of that month is that previous Saturday. (2 days ago)</p>\n\n<p>Tuesday: Then last day of that month is that previous Saturday. (3 days ago)</p>\n\n<p>Wednesday:Then last day of that month is the upcoming Saturday (3 days in the future)</p>\n\n<p>Thursday: Then last day of that month is the upcoming Saturday (2 days in future)</p>\n\n<p>Friday: Then last day of that month is the upcoming Saturday (1 day in future)</p>\n\n<p>My current code is below. The formatting of the Month-Ending date is as follows. <strong>2016-07-02</strong></p>\n\n<pre><code>Sub Macro1()\nWith ActiveWorkbook.Connections(\"ABC Query\").ODBCConnection\n    .BackgroundQuery = True\n    .CommandText = Array( _\n    \"exec [dbo].[getBSC_Monthly] @MonthEndDate = **where I need the line of code**\")\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 4, "creation_date": 1469653114, "post_id": 38623015, "comment_id": 64631704, "body": "1. this is a better question for <a href=\"http://codereview.stackexchange.com\">codereview.stackexchange.com</a> 2. When you do, <b>DO NOT</b> post picture of your code and example data.  Paste the code and data directly in the post then highlight them and hit Ctrl-k to format it."}, {"owner": {"reputation": 2382, "user_id": 3596337, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/342bc87e52c3a697732300f833e50036?s=128&d=identicon&r=PG&f=1", "display_name": "keiv.fly", "link": "https://stackoverflow.com/users/3596337/keiv-fly"}, "edited": false, "score": 0, "creation_date": 1469653633, "post_id": 38623015, "comment_id": 64631933, "body": "Please post the code directly here. It would then be possible for me to run it. You can try to put a msgbox between the two parts and see if the second part is slower than the first part. Which I assume is true, because you delete rows and Excel then needs to shift lots of cells."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1469653677, "post_id": 38623015, "comment_id": 64631959, "body": "I&#39;m voting to close this question as off-topic because this question belongs on <a href=\"http://codereview.stackexchange.com/\">codereview.stackexchange.com</a>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1469653722, "post_id": 38623015, "comment_id": 64631982, "body": "@ScottCraner -  Judging by the screenshot, this isn&#39;t working code. The row delete loop is running backwards (or in the wrong direction depending on your point of view)."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1469653879, "post_id": 38623015, "comment_id": 64632073, "body": "@Comintern to be honest I went by his description that the code was working, I did not do more than a cursory view of the code."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1469653934, "post_id": 38623015, "comment_id": 64632101, "body": "@ScottCraner - I sometimes get sucked in by the novelty of code screenshots."}, {"owner": {"reputation": 2820, "user_id": 3390468, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/768800013/picture?type=large", "display_name": "Steven Martin", "link": "https://stackoverflow.com/users/3390468/steven-martin"}, "edited": false, "score": 0, "creation_date": 1469654023, "post_id": 38623015, "comment_id": 64632146, "body": "Does it always decrease by 1 cell each column to the right"}, {"owner": {"reputation": 11, "user_id": 6646725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6651dd0ff3e8a6592f8432bab8efe1c?s=128&d=identicon&r=PG&f=1", "display_name": "zanwigz", "link": "https://stackoverflow.com/users/6646725/zanwigz"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1469655333, "post_id": 38623015, "comment_id": 64632783, "body": "@ScottCraner My apologies on the poor posting etiquette.  This is my first post here, in the future I will format the code so it can be copied and go the site mentions by for code reviews."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1469655398, "post_id": 38623015, "comment_id": 64632814, "body": "@zanwigz fix it here.  Do not post it on CodeReview as they will see it as not working.  See my answer below."}, {"owner": {"reputation": 11, "user_id": 6646725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6651dd0ff3e8a6592f8432bab8efe1c?s=128&d=identicon&r=PG&f=1", "display_name": "zanwigz", "link": "https://stackoverflow.com/users/6646725/zanwigz"}, "reply_to_user": {"reputation": 2820, "user_id": 3390468, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/768800013/picture?type=large", "display_name": "Steven Martin", "link": "https://stackoverflow.com/users/3390468/steven-martin"}, "edited": false, "score": 0, "creation_date": 1469655407, "post_id": 38623015, "comment_id": 64632822, "body": "@StevenMartin yes there is always a decrease by one cell to the right."}, {"owner": {"reputation": 11, "user_id": 6646725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6651dd0ff3e8a6592f8432bab8efe1c?s=128&d=identicon&r=PG&f=1", "display_name": "zanwigz", "link": "https://stackoverflow.com/users/6646725/zanwigz"}, "reply_to_user": {"reputation": 2382, "user_id": 3596337, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/342bc87e52c3a697732300f833e50036?s=128&d=identicon&r=PG&f=1", "display_name": "keiv.fly", "link": "https://stackoverflow.com/users/3596337/keiv-fly"}, "edited": false, "score": 0, "creation_date": 1469657484, "post_id": 38623015, "comment_id": 64633701, "body": "@keiv.fly I just editted to include the code.@Comintern I changed the loop to run the other way with the Step-1.  I am running it now, however, it still seems slow (around 8 percent done after 10 min).  If it works I&#39;ll hop over to codereview to get some imput on improving the speed."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6017774"}, "edited": false, "score": 0, "creation_date": 1469671400, "post_id": 38623015, "comment_id": 64636909, "body": "See my answer here on speeding up VBA from a language viewpoint - <a href=\"http://stackoverflow.com/questions/26071366/how-to-speed-up-multiple-replacement-using-vba-in-word/26080089#26080089\" title=\"how to speed up multiple replacement using vba in word\">stackoverflow.com/questions/26071366/&hellip;</a>. It includes a link at the bottom to a page on Excel specific speeding up as well."}], "answers": [{"comments": [{"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 1, "creation_date": 1469655402, "post_id": 38623457, "comment_id": 64632816, "body": "working code compared to non working code is definitely an improvement in efficiency!"}, {"owner": {"reputation": 11, "user_id": 6646725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6651dd0ff3e8a6592f8432bab8efe1c?s=128&d=identicon&r=PG&f=1", "display_name": "zanwigz", "link": "https://stackoverflow.com/users/6646725/zanwigz"}, "edited": false, "score": 0, "creation_date": 1469657012, "post_id": 38623457, "comment_id": 64633528, "body": "@Scott Craner I just tried to run this.  While the code ran successively, after row 5304 the columns were assigned a value of N/A, whereas I should have around 117000 entries."}, {"owner": {"reputation": 11, "user_id": 6646725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6651dd0ff3e8a6592f8432bab8efe1c?s=128&d=identicon&r=PG&f=1", "display_name": "zanwigz", "link": "https://stackoverflow.com/users/6646725/zanwigz"}, "reply_to_user": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1469657238, "post_id": 38623457, "comment_id": 64633598, "body": "@ForwardEd Yes I Agree!!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 11, "user_id": 6646725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6651dd0ff3e8a6592f8432bab8efe1c?s=128&d=identicon&r=PG&f=1", "display_name": "zanwigz", "link": "https://stackoverflow.com/users/6646725/zanwigz"}, "edited": false, "score": 0, "creation_date": 1469669707, "post_id": 38623457, "comment_id": 64636582, "body": "@zanwigz did the edit work for you?  I just tried it on a 484 x 484 grid and it was less than a second.  If it worked please mark as correct by clicking the check mark by the answer."}, {"owner": {"reputation": 11, "user_id": 6646725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6651dd0ff3e8a6592f8432bab8efe1c?s=128&d=identicon&r=PG&f=1", "display_name": "zanwigz", "link": "https://stackoverflow.com/users/6646725/zanwigz"}, "edited": false, "score": 0, "creation_date": 1469719602, "post_id": 38623457, "comment_id": 64664388, "body": "@ScottCraner I am afraid it is still not working for me.  Now, it will move the second column down below the first, then the code ends."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 11, "user_id": 6646725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6651dd0ff3e8a6592f8432bab8efe1c?s=128&d=identicon&r=PG&f=1", "display_name": "zanwigz", "link": "https://stackoverflow.com/users/6646725/zanwigz"}, "edited": false, "score": 0, "creation_date": 1469719693, "post_id": 38623457, "comment_id": 64664449, "body": "What is the actual range of your dataset? @zanwigz"}, {"owner": {"reputation": 11, "user_id": 6646725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6651dd0ff3e8a6592f8432bab8efe1c?s=128&d=identicon&r=PG&f=1", "display_name": "zanwigz", "link": "https://stackoverflow.com/users/6646725/zanwigz"}, "edited": false, "score": 0, "creation_date": 1469719975, "post_id": 38623457, "comment_id": 64664652, "body": "@ScottCraner The data range is from A1 to RO483.  With 482 rows in column 1, 481 rows in column 2 ect.. stepping down until only one row of data is in the last column (RO or Column 483)."}, {"owner": {"reputation": 11, "user_id": 6646725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6651dd0ff3e8a6592f8432bab8efe1c?s=128&d=identicon&r=PG&f=1", "display_name": "zanwigz", "link": "https://stackoverflow.com/users/6646725/zanwigz"}, "edited": false, "score": 0, "creation_date": 1469720229, "post_id": 38623457, "comment_id": 64664828, "body": "@ScottCranerApologies!  Editted"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1469720378, "post_id": 38623457, "comment_id": 64664954, "body": "Like I stated in the comment earlier.  I tested it with a grid just like the one described.  At this point I cannot offer any more direction without seeing the actual data.  I had no problems and cannot replicate your issue."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1469657285, "last_edit_date": 1469657285, "creation_date": 1469654771, "answer_id": 38623457, "question_id": 38623015, "link": "https://stackoverflow.com/questions/38623015/delete-blank-cells-in-a-column/38623457#38623457", "title": "Delete blank cells in a column", "body": "<p>Because I gave errant information on where this should be posted.</p>\n\n<p>The following code will do what you want nearly instantly.</p>\n\n<p>I used arrays to limit the number of interactions with the worksheet.</p>\n\n<pre><code>Sub foo5()\nDim ws As Worksheet\nDim rng() As Variant\nDim oarr() As Variant\nDim i&amp;, j&amp;, k&amp;\n\n\nSet ws = ThisWorkbook.Worksheets(\"Sheet19\") 'Change to your sheet\nWith ws\n    rng = .Range(\"A1\", .Cells(.Cells(.Rows.Count, 1).End(xlUp).Row, .Cells(1, .Columns.Count).End(xlToLeft))).Value\n    ReDim oarr(1 To Application.WorksheetFunction.CountA(rng), 1 To 1)\n    k = 1\n    For i = LBound(rng, 1) To UBound(rng, 1)\n        For j = LBound(rng, 2) To UBound(rng, 2)\n            If rng(i, j) &lt;&gt; \"\" Then\n                oarr(k, 1) = rng(i, j)\n                k = k + 1\n            End If\n        Next j\n    Next i\n    .Range(\"A1\", .Cells(.Cells(.Rows.Count, 1).End(xlUp).Row, .Cells(1, .Columns.Count).End(xlToLeft))).Clear\n    .Range(\"A1\").Resize(UBound(oarr), 1).Value = oarr\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6646725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6651dd0ff3e8a6592f8432bab8efe1c?s=128&d=identicon&r=PG&f=1", "display_name": "zanwigz", "link": "https://stackoverflow.com/users/6646725/zanwigz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1499756881, "creation_date": 1469652893, "last_edit_date": 1499756881, "question_id": 38623015, "link": "https://stackoverflow.com/questions/38623015/delete-blank-cells-in-a-column", "title": "Delete blank cells in a column", "body": "<p>The following code converts a table of values to a single column.</p>\n\n<p>The problem is, with my table the number of rows in each column decreases by one for each successive column. Similar to the table shown below.</p>\n\n<p>I am VERY new to writing code and only know the very basics.  I copied a script found online to convert a range of values to a single column. The portion of code that I wrote to delete any blank cells is slowing the code tremendously.  To convert around 250,000 points to a column is taking roughly 9 hours.  I am hoping to reduce the processing time as this is a script I expect to use regularly.</p>\n\n<pre><code>Sub CombineColumns()\n\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\n\nDim rng As Range\nDim iCol As Long\nDim lastCell As Long\nDim K As Long\n\nK = 484\n'set K equal to the number of data points that created the range\n\n\nSet rng = ActiveCell.CurrentRegion\nlastCell = rng.Columns(1).Rows.count + 1\n\nFor iCol = 2 To rng.Columns.count\n    Range(Cells(1, iCol), Cells(rng.Columns(iCol).Rows.count, iCol)).Cut\n    ActiveSheet.Paste Destination:=Cells(lastCell, 1)\n    lastCell = lastCell + rng.Columns(iCol).Rows.count\n\nNext iCol\nDim z As Long\nDim m As Long\n\nz = K ^ 2\n\nFor Row = z To 1 Step -1\n    If Cells(Row, 1) = 0 Then\n    Range(\"A\" &amp; Row).Delete Shift:=xlUp\n\n    Application.StatusBar = \"Progress: \" &amp; Row &amp; \" of z: \" &amp; Format((z - Row) / z, \"Percent\")\n    DoEvents\n\n    End If\n\nNext\n\nApplication.StatusBar = False\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>Sample Table Structure\n<img src=\"https://i.stack.imgur.com/WphZw.png\" alt=\"Sample Table Structure\"></p>\n"}, {"tags": ["vba", "excel", "worksheet-function"], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 4682681, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/tKFRF.jpg?s=128&g=1", "display_name": "Matthew Ingle", "link": "https://stackoverflow.com/users/4682681/matthew-ingle"}, "edited": false, "score": 0, "creation_date": 1469660180, "post_id": 38623034, "comment_id": 64634571, "body": "Hi Scott,  this worked well. I needed to remove the &quot;not&quot; in the first line. Otherwise it was giving me an error if it WAS on the list.  And forgive me for not phrasing my question clearly, but this works on single cells. What I really need is one which will reject if multiple values are pasted into Column A, say 1-1000. Do you have any ideas?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 117, "user_id": 4682681, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/tKFRF.jpg?s=128&g=1", "display_name": "Matthew Ingle", "link": "https://stackoverflow.com/users/4682681/matthew-ingle"}, "edited": false, "score": 0, "creation_date": 1469660250, "post_id": 38623034, "comment_id": 64634592, "body": "I actually noticed that myself, If you look at the edit I did an hour ago I had removed it.  Please consider marking as correct."}, {"owner": {"reputation": 117, "user_id": 4682681, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/tKFRF.jpg?s=128&g=1", "display_name": "Matthew Ingle", "link": "https://stackoverflow.com/users/4682681/matthew-ingle"}, "edited": false, "score": 0, "creation_date": 1469660361, "post_id": 38623034, "comment_id": 64634623, "body": "Yes Scott! You were definitely correct. I had not refreshed my page. My mistake!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 117, "user_id": 4682681, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/tKFRF.jpg?s=128&g=1", "display_name": "Matthew Ingle", "link": "https://stackoverflow.com/users/4682681/matthew-ingle"}, "edited": false, "score": 0, "creation_date": 1469660607, "post_id": 38623034, "comment_id": 64634673, "body": "You will need to loop through the Target range and test each one. @MatthewIngle"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1469654828, "last_edit_date": 1469654828, "creation_date": 1469652998, "answer_id": 38623034, "question_id": 38622978, "link": "https://stackoverflow.com/questions/38622978/worksheet-change-compare-values-to-list/38623034#38623034", "title": "Worksheet_Change compare values to list", "body": "<p>You would add this:</p>\n\n<pre><code>If IsError(Application.Match(target.value, Worksheets(\"Worksheet 2\").Range(\"B2:B7\"), 0)) Then\n    MsgBox \"The value you entered is not valid\"\nEnd If\n</code></pre>\n\n<p>where you want in the code.</p>\n"}], "owner": {"reputation": 117, "user_id": 4682681, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/tKFRF.jpg?s=128&g=1", "display_name": "Matthew Ingle", "link": "https://stackoverflow.com/users/4682681/matthew-ingle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 38623034, "answer_count": 1, "score": 0, "last_activity_date": 1469654828, "creation_date": 1469652748, "last_edit_date": 1531164843, "question_id": 38622978, "link": "https://stackoverflow.com/questions/38622978/worksheet-change-compare-values-to-list", "title": "Worksheet_Change compare values to list", "body": "<p>I am trying to use worksheet_change as a data validation check. I want to insure values pasted into cells range a1:a3000 match a list of values from a list. I'm afraid I'm lost and don't know how to proceed.</p>\n\n<p>Here is what I have so far</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim Rang As Range\nSet Rang = Worksheets(\"DATA INPUT SHEET\").Range(\"A1:A3000\")\n    If Intersect(Target, Rang) Is Nothing Or Target.Cells.Count &gt; 1 Then Exit Sub\n</code></pre>\n\n<p>What I want to add would be along the lines of:</p>\n\n<pre><code>If Target.Value &lt;&gt; Worksheets(\"Worksheet 2\".Range(\"B2:B7\") Then\nMsgBox \"The value you entered is not valid\"\n</code></pre>\n\n<p>Does anyone have any suggestions? </p>\n"}, {"tags": ["vba", "vb6", "boolean"], "comments": [{"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 2, "creation_date": 1469651986, "post_id": 38622752, "comment_id": 64631128, "body": "VB6 at any rate had a fantastic feature where you could set a breakpoint when a variable value changed.  That would be handy to find where/when/why it allegedly changes back"}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1469652060, "post_id": 38622752, "comment_id": 64631165, "body": "Is the code that encompasses <code>OverPopluated</code> too large to post here?"}, {"owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "reply_to_user": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1469652144, "post_id": 38622752, "comment_id": 64631202, "body": "@MattCremeens let me try to show you this..."}, {"owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "reply_to_user": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1469652490, "post_id": 38622752, "comment_id": 64631383, "body": "@MattCremeens Please see edit"}, {"owner": {"reputation": 32143, "user_id": 4955425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y0RDl.jpg?s=128&g=1", "display_name": "sstan", "link": "https://stackoverflow.com/users/4955425/sstan"}, "edited": false, "score": 2, "creation_date": 1469652690, "post_id": 38622752, "comment_id": 64631483, "body": "Where does the code live?  Is it inside a class, a module?  Are your 2 snippets of code inside the same source file?  Make sure you have <code>Option Explicit</code> declared at the top of all your source files."}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 2, "creation_date": 1469652833, "post_id": 38622752, "comment_id": 64631567, "body": "I wonder by dimensioning it locally if you are overriding the global dim. What if you take out the <code>Dim OverPopulated as Boolean</code> and just left in your original <code>Global OverPopulated as Boolean</code>?"}, {"owner": {"reputation": 32143, "user_id": 4955425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y0RDl.jpg?s=128&g=1", "display_name": "sstan", "link": "https://stackoverflow.com/users/4955425/sstan"}, "reply_to_user": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1469652965, "post_id": 38622752, "comment_id": 64631628, "body": "@Matt: I assumed that <code>Dim OverPopulated as Boolean</code> was the global variable declaration.  Is <code>Global OverPopulated as Boolean</code> even valid syntax?  I&#39;ve never seen that before."}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "reply_to_user": {"reputation": 32143, "user_id": 4955425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y0RDl.jpg?s=128&g=1", "display_name": "sstan", "link": "https://stackoverflow.com/users/4955425/sstan"}, "edited": false, "score": 0, "creation_date": 1469653070, "post_id": 38622752, "comment_id": 64631686, "body": "@sstan it is valid syntax, but I like your suggestion to make sure <code>Option Explicit</code> is the first line of code."}, {"owner": {"reputation": 32143, "user_id": 4955425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y0RDl.jpg?s=128&g=1", "display_name": "sstan", "link": "https://stackoverflow.com/users/4955425/sstan"}, "reply_to_user": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 2, "creation_date": 1469653213, "post_id": 38622752, "comment_id": 64631748, "body": "@Matt: Then I think we are both suspecting the same thing: that, one way or another, OP is actually using 2 different <code>OverPopulated</code> variables."}, {"owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "edited": false, "score": 0, "creation_date": 1469653556, "post_id": 38622752, "comment_id": 64631897, "body": "Im using dim, not global my mistake. The code lives inside one form, i will eventually need it make it a global to be used by multiple forms"}, {"owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "edited": false, "score": 0, "creation_date": 1469653804, "post_id": 38622752, "comment_id": 64632029, "body": "The code in edit is what it looks like, except the dim boolean is set at a modular level and i have option explicit"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1469656904, "post_id": 38622752, "comment_id": 64633491, "body": "When <code>OverPopulated</code> gets reset are other Globals also reset?"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1469659465, "post_id": 38622752, "comment_id": 64634367, "body": "As @Plutonix suggested in very first comment, set a watch on expression <code>Overpopulated</code> and have it break when it changes value"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6017774"}, "edited": false, "score": 0, "creation_date": 1469666776, "post_id": 38622752, "comment_id": 64636033, "body": "There is no <code>Global</code> keyword in VB6. We use <code>Public</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6017774"}, "edited": false, "score": 0, "creation_date": 1469669369, "post_id": 38622752, "comment_id": 64636517, "body": "The <code>DIM</code> has to be at the top of the module, not in a code block. If functions that use it are not in that module then it must be <code>Public Dim</code>"}, {"owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "edited": false, "score": 0, "creation_date": 1469673886, "post_id": 38622752, "comment_id": 64637379, "body": "@noodles it is at the top, i set it at modular level so i can use it throughout the form. It works fine, theres a value but it changes"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6017774"}, "edited": false, "score": 0, "creation_date": 1469675138, "post_id": 38622752, "comment_id": 64637619, "body": "Your question shows it is enclosed within a procedure. Because there is code without a sub or function definition after it. Fix your question."}, {"owner": {"reputation": 826, "user_id": 4438429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2ddc13cb3128b3ca0a9299a717c1021?s=128&d=identicon&r=PG&f=1", "display_name": "topshot", "link": "https://stackoverflow.com/users/4438429/topshot"}, "edited": false, "score": 0, "creation_date": 1469711678, "post_id": 38622752, "comment_id": 64657965, "body": "So <code>OverPopulated = False</code> is only set once (in `ValidatePopulation&#39;) though it is also False by default and that Sub is only called once. And you&#39;re certain it is only declared once? And somehow after using it several times (with a value of True), it gets set back to False? Is that correct?"}, {"owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "edited": false, "score": 0, "creation_date": 1469711917, "post_id": 38622752, "comment_id": 64658154, "body": "Yes, I set it to FALSE, then once it passes the Validating, it gets set to True. I&#39;d this this flag in 2 places only. In one place it works fine the first time it hits the function, but then after it goes through the same function again it was getting set to FALSE when the value was still true. Not sure what was going on, but setting the OverPopulated as Global fixed the issue. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 826, "user_id": 4438429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2ddc13cb3128b3ca0a9299a717c1021?s=128&d=identicon&r=PG&f=1", "display_name": "topshot", "link": "https://stackoverflow.com/users/4438429/topshot"}, "edited": false, "score": 0, "creation_date": 1469712033, "post_id": 38637550, "comment_id": 64658257, "body": "Ah. I thought you said it was already in a module rather than form!"}], "tags": [], "owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "is_accepted": true, "score": 0, "last_activity_date": 1469711812, "creation_date": 1469711812, "answer_id": 38637550, "question_id": 38622752, "link": "https://stackoverflow.com/questions/38622752/why-would-a-boolean-revert-to-an-original-value/38637550#38637550", "title": "why would a boolean revert to an original value?", "body": "<p>It looks like for some reason the value was getting reset to FALSE. I took out the Dim OverPopulated as Boolean from my form code, and placed it in a GLOBAL module where all the other globals are stored. This seems to have fixed the issue of the value remaining the same while I'm manuevering in the application. Thank you for all your comments.</p>\n\n<pre><code>Global OverPopulated as Boolean \n</code></pre>\n"}], "owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 326, "favorite_count": 0, "accepted_answer_id": 38637550, "answer_count": 1, "score": -1, "last_activity_date": 1469711812, "creation_date": 1469651838, "last_edit_date": 1469710496, "question_id": 38622752, "link": "https://stackoverflow.com/questions/38622752/why-would-a-boolean-revert-to-an-original-value", "title": "why would a boolean revert to an original value?", "body": "<p>I know this might be a more of a general question, but I've looked at my code a 100 times and am not sure what's wrong. I set a global flag so that it can be used in different forms of my application.</p>\n\n<pre><code>Dim OverPopulated as Boolean\n</code></pre>\n\n<p>I have a function where I first set it to FALSE, and after it goes through some validating it gets set to TRUE.</p>\n\n<p>Now i do a bunch of stuff, go through different forms, and the value stays correct the entire time. Basically I need this value for another form, so when I check</p>\n\n<pre><code>if OverPopulated = false then\n   MsgBox \"You Can't do this and that\"\n   exit sub\nEnd if\n</code></pre>\n\n<p>Then all of the sudden it gets set to FALSE. I've went through every instance of OVERPOPULATED in my application and put a break point to it to make sure that nowhere do i set it to FALSE, except for the one time I set it to FALSE before my validation. </p>\n\n<p>I only have it in 2 other forms in my applications. There is one place where the flag is being run twice through the same statement (just like the one above). The first time it goes through, the value is correct, then it goes through again and the value is set to FALSE.</p>\n\n<p>Any ideas? if this is too vague, please let me know, I'll try to edit it.</p>\n\n<p>EDIT: I deleted a lot of the code but here's how it looks.....</p>\n\n<pre><code>Dim OverPopulated as Boolean\n</code></pre>\n\n<p>' modular level</p>\n\n<pre><code>Private Sub ValidatePopulation()\n\nDim admDate as date\n\nOverPopulated = False\n\nadmDate = Format(Now(), \"mm/dd/yyyy\")\n\n\nSelect Case revPURP\n    Case 0, 1, 2\n    'Check make sure these fields \n    'some if statements, checking, validation\n\n    Case Else ' no need to do a \nEnd Select\n\nOverPopulated = True 'I MAKE SURE IT GETS HERE and is set to TRUE!!!\n\nEnd sub\n</code></pre>\n\n<p>Now, in other functions I used it like this...</p>\n\n<pre><code>If OverPopulated = False Then\n    If optStat (0).Value = True Or optStat (1).Value = True Then\n        MsgBox \"You are not able to do this\u201d, vbCritical, \"Incorrect review status....\"\n        TabPop.Tab = 6\n    End If\n    Exit sub\nElse\n    'Proceed with SAVE\nEnd If\n</code></pre>\n\n<p>So I have this. and I have another statement just like this somewhere else. This one gets hit twice. The first time I go through it line by line and it's FALSE, then the 2nd time around the value is TRUE.</p>\n"}, {"tags": ["excel", "date", "datetime", "vba"], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 9, "user_id": 6465134, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/84248cc56a78d36e746e1e57d6b8600b?s=128&d=identicon&r=PG&f=1", "display_name": "DPatel", "link": "https://stackoverflow.com/users/6465134/dpatel"}, "edited": false, "score": 0, "creation_date": 1469652662, "post_id": 38622826, "comment_id": 64631469, "body": "@DPatel In a few minutes a check mark by the answer will be available.  Please click on it to mark as correct.  It is something only you can do."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1469652128, "creation_date": 1469652128, "answer_id": 38622826, "question_id": 38622684, "link": "https://stackoverflow.com/questions/38622684/converting-datetime-format-with-multiple-datatypes-into-date-format-in-excel/38622826#38622826", "title": "converting datetime format with multiple datatypes into date format in excel", "body": "<p>Remove the first <code>:</code> between the date and the time.</p>\n\n<p>You can do this with a formula:</p>\n\n<pre><code>=--SUBSTITUTE(A1,\":\",\" \",1)\n</code></pre>\n\n<p>Then format the cell in manner of your choosing.</p>\n\n<p><a href=\"https://i.stack.imgur.com/VZq7H.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VZq7H.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 9, "user_id": 6465134, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/84248cc56a78d36e746e1e57d6b8600b?s=128&d=identicon&r=PG&f=1", "display_name": "DPatel", "link": "https://stackoverflow.com/users/6465134/dpatel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 38622826, "answer_count": 1, "score": 0, "last_activity_date": 1469652128, "creation_date": 1469651652, "last_edit_date": 1531161705, "question_id": 38622684, "link": "https://stackoverflow.com/questions/38622684/converting-datetime-format-with-multiple-datatypes-into-date-format-in-excel", "title": "converting datetime format with multiple datatypes into date format in excel", "body": "<p>i have a datetime in the format : 26FEB2016:00:00:00.000000 in my excel sheet\ni want it to be in 02/26/2016 format.\nI tried using the format tool but it dint work. \nHow can i do this conversion ?</p>\n"}, {"tags": ["excel", "excel-2016", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1469651738, "post_id": 38622664, "comment_id": 64631016, "body": "<i>without the linked files</i> - do you mean you want a <i>values only</i> copy of the worksheet? Or just value out the hyperlinked cells and not the formula cells?"}, {"owner": {"reputation": 99, "user_id": 6241632, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/74d23fcd7775f20dba819eb06f248a23?s=128&d=identicon&r=PG&f=1", "display_name": "Karen Schaefer", "link": "https://stackoverflow.com/users/6241632/karen-schaefer"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1469651944, "post_id": 38622664, "comment_id": 64631111, "body": "my worksheet is an invoice containing internal links, I want to export it and have it still retain it&#39;s format but without the internal links (Data only) with format."}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 6241632, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/74d23fcd7775f20dba819eb06f248a23?s=128&d=identicon&r=PG&f=1", "display_name": "Karen Schaefer", "link": "https://stackoverflow.com/users/6241632/karen-schaefer"}, "edited": false, "score": 0, "creation_date": 1469653066, "post_id": 38622829, "comment_id": 64631680, "body": "how does that save a worksheet as a new workbook?  also How does that save the file without the links?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 99, "user_id": 6241632, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/74d23fcd7775f20dba819eb06f248a23?s=128&d=identicon&r=PG&f=1", "display_name": "Karen Schaefer", "link": "https://stackoverflow.com/users/6241632/karen-schaefer"}, "edited": false, "score": 0, "creation_date": 1469655327, "post_id": 38622829, "comment_id": 64632782, "body": "@KarenSchaefer - are you asking because it didn&#39;t work? or because you want to know how it works? If the 2nd, research the <code>Copy</code> method of a worksheet and the line <code>.Value = .Value</code> line will flatten any formulas in the file. Then you can save the workbook as you wish (edited that command in there, thought I thought you would know it.)"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1469655309, "last_edit_date": 1469655309, "creation_date": 1469652138, "answer_id": 38622829, "question_id": 38622664, "link": "https://stackoverflow.com/questions/38622664/save-as-worksheet-from-active-workbook-as-new-xlxs-in-new-folder-removing-the-li/38622829#38622829", "title": "Save As worksheet from active workbook as new xlxs in new folder removing the linked datasources", "body": "<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840291.aspx\" rel=\"nofollow\">ExportAsFixedFormat</a> method can only export to <a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel.xlfixedformattype.aspx\" rel=\"nofollow\">PDF or XPS</a> format.</p>\n\n<p>To create a values only copy of any worksheet use the below code:</p>\n\n<pre><code>Dim ws as Worksheet\nSet ws = Worksheets(\"mySheet\") 'change as needed\n\nws.Copy \n\nDim wb as Workbook\nSet wb = ActiveWorkbook\n\nwb.Sheets(1).UsedRange.Value = wb.Sheets(1).UsedRange.Value\nwb.SaveAs \"C:\\MyFolder\\MyWorksheet.xlsx\"\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 6241632, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/74d23fcd7775f20dba819eb06f248a23?s=128&d=identicon&r=PG&f=1", "display_name": "Karen Schaefer", "link": "https://stackoverflow.com/users/6241632/karen-schaefer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1469655309, "creation_date": 1469651551, "last_edit_date": 1531164843, "question_id": 38622664, "link": "https://stackoverflow.com/questions/38622664/save-as-worksheet-from-active-workbook-as-new-xlxs-in-new-folder-removing-the-li", "title": "Save As worksheet from active workbook as new xlxs in new folder removing the linked datasources", "body": "<p>Excel 2016\nLooking for the correct syntax to saveas a workbook with out the linked files.  what is the correct Type:=?????</p>\n\n<p>This is what I have so far</p>\n\n<pre><code> ActiveSheet.ExportAsFixedFormat Type:=xlOpenXMLWorkbook, FileName:=FilePath3, _\n        Quality:=xlQualityStandard, IncludeDocProperties:=True, _\n        IgnorePrintAreas:=False, OpenAfterPublish:=False     \n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1469651618, "post_id": 38622632, "comment_id": 64630946, "body": "&quot;...in a vertical order.&quot; - So, would this scan from A1 -&gt; A2 -&gt; A3 ... after Col. A, move to B?  Or do you go A1, B1, C1, etc. then down a row?  Also, what&#39;s the conditional formatting? We could probably take that formula and use it to pull out the data you need. Otherwise, you&#39;ll need VBA to pull Highlighted Cells (AFAIK)."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1469651634, "post_id": 38622632, "comment_id": 64630959, "body": "<i>I just can&#39;t figure out what code to type</i> - what code have you actually tried? You&#39;ll get more help if you show your efforts and where it&#39;s failing."}, {"owner": {"reputation": 5, "user_id": 6646653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e02497e1f87d5f01ca909b2245c74e43?s=128&d=identicon&r=PG&f=1", "display_name": "A.Munif", "link": "https://stackoverflow.com/users/6646653/a-munif"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1469651853, "post_id": 38622632, "comment_id": 64631062, "body": "@BruceWayne yes it means A1 -&gt; A2 -&gt; A3 and move to B. Not sure what you mean by move to B. Currently the conditional formatting is highlighting  any number less than or equal to 50."}, {"owner": {"reputation": 5, "user_id": 6646653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e02497e1f87d5f01ca909b2245c74e43?s=128&d=identicon&r=PG&f=1", "display_name": "A.Munif", "link": "https://stackoverflow.com/users/6646653/a-munif"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1469652035, "post_id": 38622632, "comment_id": 64631154, "body": "@ScottHoltzman I haven&#39;t tried any code for copying and pasting the data in the vertical order, because I don&#39;t know where to start. I&#39;m still trying to figure out through trial and error and by trying to search something similar in google"}, {"owner": {"reputation": 5, "user_id": 6646653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e02497e1f87d5f01ca909b2245c74e43?s=128&d=identicon&r=PG&f=1", "display_name": "A.Munif", "link": "https://stackoverflow.com/users/6646653/a-munif"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1469652857, "post_id": 38622632, "comment_id": 64631577, "body": "@BruceWayne on a second thought I don&#39;t think it matters how it scans as long as it can pull out the numbers"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1469652916, "post_id": 38622632, "comment_id": 64631608, "body": "But, you do want all your matches in a single column? Or would you be okay with keeping the col. A matches in col. A, B in B, etc?"}, {"owner": {"reputation": 5, "user_id": 6646653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e02497e1f87d5f01ca909b2245c74e43?s=128&d=identicon&r=PG&f=1", "display_name": "A.Munif", "link": "https://stackoverflow.com/users/6646653/a-munif"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1469653254, "post_id": 38622632, "comment_id": 64631766, "body": "@BruceWayne I would prefer all matches in a single column"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1469653997, "post_id": 38622632, "comment_id": 64632129, "body": "Can you add to the end of your post, the Conditional Formatting formula? It makes the VBA part <b>much</b> simpler, if we&#39;re just looking for values over 50, than a highlight, certain decimal, etc."}, {"owner": {"reputation": 5, "user_id": 6646653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e02497e1f87d5f01ca909b2245c74e43?s=128&d=identicon&r=PG&f=1", "display_name": "A.Munif", "link": "https://stackoverflow.com/users/6646653/a-munif"}, "edited": false, "score": 0, "creation_date": 1469654999, "post_id": 38622632, "comment_id": 64632634, "body": "@BurceWayne The values less than or equal to 50 is just an example. In my actual sheet the conditional formatting is linked to Cell D1 where I input 10,20, or 30, etc.. and it will highlight those numbers. I just wanted to figure out how to copy all these spread out numbers and paste in a orderly manner. So to answer your question no it&#39;s not just values less than or equal 50 it&#39;s less than or equal to values cell D1"}, {"owner": {"reputation": 5, "user_id": 6646653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e02497e1f87d5f01ca909b2245c74e43?s=128&d=identicon&r=PG&f=1", "display_name": "A.Munif", "link": "https://stackoverflow.com/users/6646653/a-munif"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1469659631, "post_id": 38622632, "comment_id": 64634412, "body": "@pnuts yes my entire data set will fit in one column. I only have a little over thousand rows and columns...and the highlighted data (or in this case &lt;= 50) one&#39;s will be even lesser"}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1469652969, "post_id": 38622982, "comment_id": 64631630, "body": "Since he just needs those numbers greater than 50, could we use a formula? I&#39;m thinking sort of, but to put all matches in one column would be an unwieldy array formula, if possible at all, yeah?  Just trying to work on my formula skills, so am curious"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1469653264, "post_id": 38622982, "comment_id": 64631772, "body": "good luck with that @BruceWayne - that&#39;d be a real brain-teaser for you :) I can&#39;t think of anything I am willing to explore right now (at 5pm on Wednesday!)"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1469653876, "post_id": 38622982, "comment_id": 64632072, "body": "@pnuts - comment from OP <i>(Currently the conditional formatting is highlighting any number less than or equal to 50)</i>"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1469654020, "post_id": 38622982, "comment_id": 64632144, "body": "@pnuts - no problem, I am curious to see a <code>PivotTable</code> solution, if that is what you meant by <code>&quot;PT&quot;</code>"}, {"owner": {"reputation": 5, "user_id": 6646653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e02497e1f87d5f01ca909b2245c74e43?s=128&d=identicon&r=PG&f=1", "display_name": "A.Munif", "link": "https://stackoverflow.com/users/6646653/a-munif"}, "edited": false, "score": 1, "creation_date": 1469654401, "post_id": 38622982, "comment_id": 64632349, "body": "@ScottHoltzman thanks a lot! but when I run your code it gives me an object required error. I&#39;ll try to fix it but as you mentioned it&#39;s 5pm on Wednesday I&#39;ll try to figure this out tomorrow morning."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 5, "user_id": 6646653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e02497e1f87d5f01ca909b2245c74e43?s=128&d=identicon&r=PG&f=1", "display_name": "A.Munif", "link": "https://stackoverflow.com/users/6646653/a-munif"}, "edited": false, "score": 0, "creation_date": 1469655090, "post_id": 38622982, "comment_id": 64632675, "body": "@A.Munif - make sure you properly changed the worksheet names and ranges to fit your specific worksheet. If that doesn&#39;t fix it, please tell me what line the code errors on? I tested this against a data set just like yours and it worked fully."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1469712635, "post_id": 38622982, "comment_id": 64658787, "body": "@pnuts - Ah, the old unpivot trick :) Nice suggestion, even if a bit manual."}, {"owner": {"reputation": 5, "user_id": 6646653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e02497e1f87d5f01ca909b2245c74e43?s=128&d=identicon&r=PG&f=1", "display_name": "A.Munif", "link": "https://stackoverflow.com/users/6646653/a-munif"}, "edited": false, "score": 1, "creation_date": 1469722455, "post_id": 38622982, "comment_id": 64666461, "body": "@ScottHoltzman Sir, your code works like a charm! I&#39;ll probably downsize my data-set because when I tell it to go all the way up to column XFD my PC freezes up haha."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 5, "user_id": 6646653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e02497e1f87d5f01ca909b2245c74e43?s=128&d=identicon&r=PG&f=1", "display_name": "A.Munif", "link": "https://stackoverflow.com/users/6646653/a-munif"}, "edited": false, "score": 0, "creation_date": 1469722788, "post_id": 38622982, "comment_id": 64666695, "body": "@A.Munif - glad you got an answer :) Please mark one as such so those that come after know what worked for you."}, {"owner": {"reputation": 5, "user_id": 6646653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e02497e1f87d5f01ca909b2245c74e43?s=128&d=identicon&r=PG&f=1", "display_name": "A.Munif", "link": "https://stackoverflow.com/users/6646653/a-munif"}, "edited": false, "score": 1, "creation_date": 1469723144, "post_id": 38622982, "comment_id": 64666924, "body": "@ScottHoltzman This is the first time I ever asked a question on stack overflow, I was shocked to see all these people reply instantly! I&#39;ll probably have to ask follow up questions in the future because this was just first part of a larger VBA code. Hopefully I can figure the rest out (fingers crossed)"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 5, "user_id": 6646653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e02497e1f87d5f01ca909b2245c74e43?s=128&d=identicon&r=PG&f=1", "display_name": "A.Munif", "link": "https://stackoverflow.com/users/6646653/a-munif"}, "edited": false, "score": 0, "creation_date": 1469730115, "post_id": 38622982, "comment_id": 64671042, "body": "@A.Munif - SO is great, great resource with many knowledgeable and helpful people. I rarely go elsewhere for help myself."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1469653147, "last_edit_date": 1469653147, "creation_date": 1469652759, "answer_id": 38622982, "question_id": 38622632, "link": "https://stackoverflow.com/questions/38622632/excel-vba-code-to-copy-spread-out-data-and-paste-in-vertical-order/38622982#38622982", "title": "Excel VBA code to copy spread out data and paste in vertical order", "body": "<p>Try the below. Make changes to sheet and range names as needed. It loads the data into an array, tests if each point is less than or equal to 50 (moving down the rows, then across the columns ... but you can switch the <code>For</code> statements if you want) and if so, writes to a new sheet.</p>\n\n<pre><code>Sub CopyConditionalData()\n\nDim ws1 As Worksheet, ws2 As Worksheet\nSet ws1 = Worksheets(\"Sheet1\") ' change as needed\nSet ws2 = Worksheets(\"Sheet2\") ' change as needed\n\nDim rRng As Range\nSet rRng = ws1.Range(\"A1:G100\") 'change as needed\n\nDim aRng As Variant\naRng = rRng\n\nDim lRows As Long, lCols As Long\nFor lCols = 1 To rRng.Columns.Count\n    For lRows = LBound(aRng) To UBound(aRng)\n        If aRng(lRows, lCols) &lt;= 50 Then\n            ws2.Range(\"A\" &amp; ws2.Rows.Count).End(xlUp).Offset(1) = aRng(lRows, lCols)\n        End If\n    Next\nNext\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1469653010, "post_id": 38623028, "comment_id": 64631649, "body": "<i>used conditional formatting to highlight some of the data</i> - unfortunately, for your answer, conditional formatting does not change the underlying  <code>.Interior.Pattern</code> and thus this will not work."}, {"owner": {"reputation": 5, "user_id": 6646653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e02497e1f87d5f01ca909b2245c74e43?s=128&d=identicon&r=PG&f=1", "display_name": "A.Munif", "link": "https://stackoverflow.com/users/6646653/a-munif"}, "edited": false, "score": 1, "creation_date": 1469655095, "post_id": 38623028, "comment_id": 64632683, "body": "@Arun Thomas thanks for your input! But as Scott Holtzman mentioned I don&#39;t think .Interior.Pattern will work as I have tried something similar but in the form of .Interior.ColorIndex"}], "tags": [], "owner": {"reputation": 746, "user_id": 6400030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oyeSx.png?s=128&g=1", "display_name": "Arun Thomas", "link": "https://stackoverflow.com/users/6400030/arun-thomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1469652964, "creation_date": 1469652964, "answer_id": 38623028, "question_id": 38622632, "link": "https://stackoverflow.com/questions/38622632/excel-vba-code-to-copy-spread-out-data-and-paste-in-vertical-order/38623028#38623028", "title": "Excel VBA code to copy spread out data and paste in vertical order", "body": "<p>Assuming you have 120 rows and 100 columns data in Sheet1 and the highlighted color is yellow and the highlighted data has to be copied to Sheet2, then</p>\n\n<pre><code>Dim temp As Integer\ntemp = 1\n\nFor i = 1 To 120\n    For j = 1 To 100\n        Worksheets(\"Sheet1\").Activate\n        If Cells(i, j).Interior.Color = RGB(255, 255, 0) Then\n            x = Cells(i, j).Value\n            Worksheets(\"Sheet2\").Activate\n            Cells(temp, 1).Value = x\n            temp = temp + 1\n        End If\n    Next j\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 6646653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e02497e1f87d5f01ca909b2245c74e43?s=128&d=identicon&r=PG&f=1", "display_name": "A.Munif", "link": "https://stackoverflow.com/users/6646653/a-munif"}, "edited": false, "score": 0, "creation_date": 1469659168, "post_id": 38623259, "comment_id": 64634279, "body": "Thanks a lot for your input!"}], "tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 0, "last_activity_date": 1469653887, "creation_date": 1469653887, "answer_id": 38623259, "question_id": 38622632, "link": "https://stackoverflow.com/questions/38622632/excel-vba-code-to-copy-spread-out-data-and-paste-in-vertical-order/38623259#38623259", "title": "Excel VBA code to copy spread out data and paste in vertical order", "body": "<p>so .. just copy the values below 50 :]</p>\n\n<pre><code>set cell2 = Worksheets(2).Range(\"A1\")\n\nFor Each cell in Worksheets(1).UsedRange\n    If Not IsNumeric(cell.Value) And cell.Value &lt;= 50 Then\n        cell2.Value2 = cell.Value2\n        Set cell2 = cell2.Offset(1)\n    End If\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 6646653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e02497e1f87d5f01ca909b2245c74e43?s=128&d=identicon&r=PG&f=1", "display_name": "A.Munif", "link": "https://stackoverflow.com/users/6646653/a-munif"}, "edited": false, "score": 1, "creation_date": 1469674196, "post_id": 38624531, "comment_id": 64637448, "body": "thanks for the suggestion. But that&#39;s the sort of manual work I&#39;m trying to avoid by writing the VBA code. At the end of the day I just want to assign the macro to a button, click it and let excel do all the work for me"}], "tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 0, "last_activity_date": 1469660310, "last_edit_date": 1495540739, "creation_date": 1469660310, "answer_id": 38624531, "question_id": 38622632, "link": "https://stackoverflow.com/questions/38622632/excel-vba-code-to-copy-spread-out-data-and-paste-in-vertical-order/38624531#38624531", "title": "Excel VBA code to copy spread out data and paste in vertical order", "body": "<p>I suggest removing the Conditional Formatting, labelling the matrix (rows and columns) then unpivoting (for example as shown <a href=\"https://stackoverflow.com/a/20543651/1505120\">here</a>).</p>\n\n<p>Then flagging the rows by relevant decade (10, 20, 30 etc ... as in D1) and pivoting the created Table to suit.  </p>\n"}], "owner": {"reputation": 5, "user_id": 6646653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e02497e1f87d5f01ca909b2245c74e43?s=128&d=identicon&r=PG&f=1", "display_name": "A.Munif", "link": "https://stackoverflow.com/users/6646653/a-munif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 880, "favorite_count": 0, "accepted_answer_id": 38622982, "answer_count": 4, "score": 0, "last_activity_date": 1469660310, "creation_date": 1469651375, "last_edit_date": 1469651590, "question_id": 38622632, "link": "https://stackoverflow.com/questions/38622632/excel-vba-code-to-copy-spread-out-data-and-paste-in-vertical-order", "title": "Excel VBA code to copy spread out data and paste in vertical order", "body": "<p>As you can see in the screenshot (I've provided the screenshot link below), I have an excel sheet with lots of numerical data. I have used conditional formatting to highlight some of the data. My end goal is to copy these highlighted data and paste it in vertical order in a new sheet. However, the problem I face is that these data are staggered among many rows and columns. So for instance, there will be a highlighted data in <strong>row 120 column BBQ</strong>. I want to copy &amp; paste all of these spread out highlighted data in a new sheet in vertical order. I just can't figure out what code to type :(</p>\n\n<p>Any sort of help will be appreciated. Thank You!</p>\n\n<p><a href=\"https://i.stack.imgur.com/hasuO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hasuO.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["image", "vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 10843, "user_id": 1439143, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/RxFne.png?s=128&g=1", "display_name": "Joshua Muheim", "link": "https://stackoverflow.com/users/1439143/joshua-muheim"}, "edited": false, "score": 0, "creation_date": 1471260557, "post_id": 38632463, "comment_id": 65262233, "body": "This sounds very promising, thank you. Can I add this code to a docx file so it is executed automatically every time the file is opened in Word? (I&#39;m sorry I didn&#39;t use VBA macros for many years.)"}, {"owner": {"reputation": 10843, "user_id": 1439143, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/RxFne.png?s=128&g=1", "display_name": "Joshua Muheim", "link": "https://stackoverflow.com/users/1439143/joshua-muheim"}, "edited": false, "score": 0, "creation_date": 1480318961, "post_id": 38632463, "comment_id": 68895583, "body": "I tried adding this to my document in Word 365 Mac, but when trying to run it, I get <a href=\"http://pasteboard.co/3hRLwGesT.png\" rel=\"nofollow noreferrer\">runtime error 8043</a>."}, {"owner": {"reputation": 161252, "user_id": 40347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9833194869e7f99d6e388f4aee76c1?s=128&d=identicon&r=PG", "display_name": "Dirk Vollmar", "link": "https://stackoverflow.com/users/40347/dirk-vollmar"}, "reply_to_user": {"reputation": 10843, "user_id": 1439143, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/RxFne.png?s=128&g=1", "display_name": "Joshua Muheim", "link": "https://stackoverflow.com/users/1439143/joshua-muheim"}, "edited": false, "score": 0, "creation_date": 1480336094, "post_id": 38632463, "comment_id": 68905451, "body": "If you step through your code, in that line does the error occur?"}, {"owner": {"reputation": 10843, "user_id": 1439143, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/RxFne.png?s=128&g=1", "display_name": "Joshua Muheim", "link": "https://stackoverflow.com/users/1439143/joshua-muheim"}, "edited": false, "score": 0, "creation_date": 1480510671, "post_id": 38632463, "comment_id": 68991536, "body": "Here: <code>oInlineShape.Borders.OutsideLineWidth = wdLineWidth100pt</code>. I replaced <code>100pt</code> with <code>10pt</code>, and then it run - but it didn&#39;t change any image in the file."}], "tags": [], "owner": {"reputation": 161252, "user_id": 40347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9833194869e7f99d6e388f4aee76c1?s=128&d=identicon&r=PG", "display_name": "Dirk Vollmar", "link": "https://stackoverflow.com/users/40347/dirk-vollmar"}, "is_accepted": false, "score": 1, "last_activity_date": 1480517621, "last_edit_date": 1480517621, "creation_date": 1469698418, "answer_id": 38632463, "question_id": 38622295, "link": "https://stackoverflow.com/questions/38622295/paint-a-border-around-every-image-in-a-word-document/38632463#38632463", "title": "Paint a border around every image in a Word document", "body": "<p>Unfortunately, there is no picture style concept available in Word. Therefore, something like specifying a global style for images similar to CSS is not possible. </p>\n\n<p>What you can do is write a VBA macro that adds the border to all images. The code is a little different depending on whether your image is formatted to be inline with text (<code>InlineShape</code>)  or floating (<code>Shape</code>):</p>\n\n<pre><code>Sub AddBorderToPictures()\n\n    ' Add border to pictures that are \"inline with text\"\n    Dim oInlineShape As inlineShape\n    For Each oInlineShape In ActiveDocument.InlineShapes\n        oInlineShape.Borders.Enable = True\n        oInlineShape.Borders.OutsideColor = wdColorBlack\n        oInlineShape.Borders.OutsideLineWidth = wdLineWidth100pt\n        oInlineShape.Borders.OutsideLineStyle = wdLineStyleSingle\n    Next\n\n    ' Add border to pictures that are floating\n    Dim oShape As shape\n    For Each oShape In ActiveDocument.Shapes\n        oShape.Line.ForeColor.RGB = RGB(0, 0, 0)\n        oShape.Line.Weight = 1\n        oShape.Line.DashStyle = msoLineSolid\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>If apparently setting the line width to <code>wdLineWidth100pt</code> is an issue, you can try using the actual underlying integer value instead, e.g.:</p>\n\n<pre><code>oInlineShape.Borders.OutsideLineWidth = 8\n</code></pre>\n\n<p>This is how the constant is defined:</p>\n\n<pre><code>public enum WdLineWidth\n{\n    wdLineWidth025pt = 2,\n    wdLineWidth050pt = 4,\n    wdLineWidth075pt = 6,\n    wdLineWidth100pt = 8,\n    wdLineWidth150pt = 12,\n    wdLineWidth225pt = 18,\n    wdLineWidth300pt = 24,\n    wdLineWidth450pt = 36,\n    wdLineWidth600pt = 48,\n}\n</code></pre>\n"}], "owner": {"reputation": 10843, "user_id": 1439143, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/RxFne.png?s=128&g=1", "display_name": "Joshua Muheim", "link": "https://stackoverflow.com/users/1439143/joshua-muheim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1282, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1480517621, "creation_date": 1469650134, "last_edit_date": 1469698431, "question_id": 38622295, "link": "https://stackoverflow.com/questions/38622295/paint-a-border-around-every-image-in-a-word-document", "title": "Paint a border around every image in a Word document", "body": "<p>Is there a way to add a border around every image in Word? I know that I can create a custom paragraph style with a border and put the image in there, but maybe I can just specify a global image style, like in CSS:</p>\n\n<pre><code>img { border: 1px solid #000 }\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1469649079, "post_id": 38621870, "comment_id": 64629645, "body": "Use a Dictionary instead, with the value as the key and the count in the &quot;value&quot;"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1469655666, "post_id": 38621870, "comment_id": 64632934, "body": "@Henrick - I originally gave an answer using a Dictionary but, after rereading your question and suddenly understanding what you meant by &quot;it requires checking a reference&quot;, I added an alternative method using just a user-defined type and a variable sized array."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6570969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af040e754f0be9822b08a1a9cb03119d?s=128&d=identicon&r=PG&f=1", "display_name": "Henrik", "link": "https://stackoverflow.com/users/6570969/henrik"}, "edited": false, "score": 0, "creation_date": 1469736577, "post_id": 38622322, "comment_id": 64674400, "body": "I really appreciate your help! This last one just might be perfect for my needs in this specific case!"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1469655529, "last_edit_date": 1469655529, "creation_date": 1469650242, "answer_id": 38622322, "question_id": 38621870, "link": "https://stackoverflow.com/questions/38621870/match-cell-values-and-compensate-for-duplicates/38622322#38622322", "title": "Match cell values and compensate for duplicates", "body": "<p>As Tim Williams said, use a Dictionary.</p>\n\n<p>Below is your code modified to use a Dictionary instead of a Collection (and with some other changes, such as writing the results to column C).</p>\n\n<pre><code>Sub Test()\n\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim cell As Range\n    Dim rng As Range\n    Dim key As Variant\n    Dim i As Integer\n    Dim r As Integer\n    Dim lastRow As Long\n    Dim dictValues As New Dictionary\n\n    Set wb = ActiveWorkbook\n    Set ws = wb.ActiveSheet\n\n    With ws\n        lastRow = .Cells(.Rows.Count, 1).End(xlUp).Row\n\n        Set rng = .Range(.Cells(1, 1), .Cells(lastRow, 1))\n\n        For Each cell In rng.Cells\n            If dictValues.Exists(CStr(cell.Value)) Then\n                dictValues(CStr(cell.Value)) = dictValues(CStr(cell.Value)) + 1\n            Else\n                dictValues(CStr(cell.Value)) = 1\n            End If\n        Next cell\n\n        Set rng = .Range(.Cells(1, 2), .Cells(lastRow, 2))\n\n        For Each cell In rng.Cells\n            If dictValues.Exists(CStr(cell.Value)) Then\n                dictValues(CStr(cell.Value)) = dictValues(CStr(cell.Value)) - 1\n            End If\n        Next cell\n\n        r = 0\n        For Each key In dictValues.Keys\n            For i = 1 To dictValues(key)\n                r = r + 1\n                .Cells(r, 3).Value = key\n            Next\n        Next\n    End With\nEnd Sub\n</code></pre>\n\n<p>But, if you really, really, really don't want to use a reference to the Scripting object, here is a version without using a Dictionary:</p>\n\n<pre><code>Type ValueAndCount\n    strValue As String\n    intCount As Integer\nEnd Type\n\nSub Test()\n\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim cell As Range\n    Dim rng As Range\n    Dim i As Integer\n    Dim r As Integer\n    Dim p As Integer\n    Dim lastRow As Long\n    Dim colec() As ValueAndCount\n\n    Set wb = ActiveWorkbook\n    Set ws = wb.ActiveSheet\n\n    ReDim colec(0) As ValueAndCount\n    With ws\n        lastRow = .Cells(.Rows.Count, 1).End(xlUp).Row\n\n        Set rng = .Range(.Cells(1, 1), .Cells(lastRow, 1))\n\n        For Each cell In rng.Cells\n            p = LocationInCollection(colec, CStr(cell.Value))\n            If p = 0 Then\n                p = UBound(colec) + 1\n                ReDim Preserve colec(p) As ValueAndCount\n                colec(p).strValue = CStr(cell.Value)\n                colec(p).intCount = 0\n            End If\n            colec(p).intCount = colec(p).intCount + 1\n        Next cell\n\n        Set rng = .Range(.Cells(1, 2), .Cells(lastRow, 2))\n\n        For Each cell In rng.Cells\n            p = LocationInCollection(colec, CStr(cell.Value))\n            If p &gt; 0 Then\n                colec(p).intCount = colec(p).intCount - 1\n            End If\n        Next cell\n\n        r = 0\n        For p = 1 To UBound(colec)\n            For i = 1 To colec(p).intCount\n                r = r + 1\n                .Cells(r, 3).Value = colec(p).strValue\n            Next\n        Next\n    End With\nEnd Sub\n\nPrivate Function LocationInCollection(pColl() As ValueAndCount, ByVal pKey As String) As Integer\n    Dim p As Integer\n    For p = 1 To UBound(pColl)\n        If pColl(p).strValue = pKey Then\n            LocationInCollection = p\n            Exit Function\n        End If\n    Next\n    LocationInCollection = 0\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 6570969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af040e754f0be9822b08a1a9cb03119d?s=128&d=identicon&r=PG&f=1", "display_name": "Henrik", "link": "https://stackoverflow.com/users/6570969/henrik"}, "edited": false, "score": 0, "creation_date": 1469735677, "post_id": 38623889, "comment_id": 64673954, "body": "Thank you for both your answers! The part with dictionarys will be usefull to me for other purposes, and the solution with a temporary working area is a splendid id&#233;a which I will capitalize on. Thank you for your help!"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 0, "last_activity_date": 1469656696, "creation_date": 1469656696, "answer_id": 38623889, "question_id": 38621870, "link": "https://stackoverflow.com/questions/38621870/match-cell-values-and-compensate-for-duplicates/38623889#38623889", "title": "Match cell values and compensate for duplicates", "body": "<p>This is a completely different approach to my other answer, based on the OP's comment that the result is to be written to column C (meaning that column C can be used as a temporary work area):</p>\n\n<pre><code>Sub Test()\n    Dim lastRow As Integer\n    Dim rng As Range\n    With ActiveSheet\n        lastRow = .Cells(.Rows.Count, 1).End(xlUp).Row\n        .Range(\"A1:A\" &amp; lastRow).Copy Destination:=.Range(\"C1:C\" &amp; lastRow)\n        For Each cell In .Range(\"B1:B\" &amp; lastRow)\n            Set rng = .Range(\"C1:C\" &amp; lastRow).Find(cell.Value)\n            If Not rng Is Nothing Then\n                rng.Delete shift:=xlUp\n            End If\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6570969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af040e754f0be9822b08a1a9cb03119d?s=128&d=identicon&r=PG&f=1", "display_name": "Henrik", "link": "https://stackoverflow.com/users/6570969/henrik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 38623889, "answer_count": 2, "score": 0, "last_activity_date": 1469656696, "creation_date": 1469648632, "last_edit_date": 1531164843, "question_id": 38621870, "link": "https://stackoverflow.com/questions/38621870/match-cell-values-and-compensate-for-duplicates", "title": "Match cell values and compensate for duplicates", "body": "<p>The headline isn\u00b4t very good so here is the explanation.</p>\n\n<p>I need to match cell values in column A to column B to find what cell values that are missing from column B.\nThe problem is that there might be duplicate values. I.e column A has two \"Orange\" and column B has one \"Orange\". In this case one \"Orange\" is missing.</p>\n\n<p>I will write the missing values in, let\u00b4s say, column C.</p>\n\n<p>My approach has been to try to create a collection of the valuse form Column A. Run Column B's values against the collection and delete is there is a match. Then write the remaining values in to Column C.</p>\n\n<p>However as you probaly know collection can't handle duplicate values.</p>\n\n<p>I considered using array but deleteing cells from an array seem to be no simple matter form what I have seen.</p>\n\n<p>My limitations is that I can not make any changes to the data I have in the excel file. I.e delete data or add a color to the matched cell etc, this means I can't mark the alreay matched once in a convinient way.</p>\n\n<p>I have no experience with dictionary or if it has any solution to this, but I am not sure that it\u00b4s a doable approach since it requires checking a reference.\nI don't think copying the data over to a second excel sheet is the right approach either since that might mess upp other stuff going on on the computer.</p>\n\n<p>The question is simply, what alternatives are there? If non I\u00b4ll have to make a work-around with the tools I already have. But if there is a way which I have yet not found...</p>\n\n<p>This is the collection approach I wrote.</p>\n\n<pre><code>    Sub Test()\n\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim cell As Range\n    Dim rng As Range\n\n    Dim colec As Collection\n\n    Set colec = New Collection\n\n    Set wb = ActiveWorkbook\n    Set ws = wb.ActiveSheet\n\n    Set rng = ws.Range(ws.Cells(1, 1), ws.Cells(5, 1))\n\n     For Each cell In rng.Cells\n\n        If ExistsInCollection(colec, CStr(cell.Value)) = False Then\n\n            On Error Resume Next\n            colec.Add cell.Value, CStr(cell.Value) 'Adds the first selected range to collection\n            On Error GoTo 0\n\n        Else\n\n            colec.Add cell.Value\n\n        End If\n\n    Next cell\n\n    Set rng = ws.Range(ws.Cells(1, 2), ws.Cells(4, 2))\n\n    For Each cell In rng.Cells\n\n            On Error Resume Next\n            colec.Remove (CStr(cell.Value))\n            On Error GoTo 0\n\n    Next cell\nEnd Sub\n</code></pre>\n\n<p>This is the function I copied which checks if a value already exists in the collection.</p>\n\n<pre><code>'Copied from outside source\nPrivate Function ExistsInCollection(pColl, ByVal pKey As String) As Boolean\n    On Error GoTo NoSuchKey\n    If VarType(pColl.Item(pKey)) = vbObject Then\n         ' force an error condition if key does not exist\n    End If\n    ExistsInCollection = True\n    Exit Function\n\nNoSuchKey:\n    ExistsInCollection = False\nEnd Function\n</code></pre>\n\n<p>Please tell me if I have to clarify anything.</p>\n\n<p>I am thankfull for any help you can provide!</p>\n\n<p>/Henrik</p>\n"}, {"tags": ["sql", "excel", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1469648923, "post_id": 38621873, "comment_id": 64629559, "body": "AAAAAAAAnd of course its something stupid i overlooked. Thanks so much"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 2, "creation_date": 1469649009, "post_id": 38621873, "comment_id": 64629604, "body": "@DougCoats - While you&#39;re at it, I&#39;d replace the <code>For Each sheet In ActiveWorkbook.Worksheets</code> with <code>For Each sheet In wbk.Worksheets</code>.  It doesn&#39;t make any sense to capture the reference and then not use it. Ditto every other place in that loop."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 1, "creation_date": 1469651424, "post_id": 38621873, "comment_id": 64630850, "body": "@DougCoats = you can remove the <code>Select Case</code> altogether and just write <code>vAr2 = &quot;[&quot; &amp; sheet.Name &amp; &quot;]&quot;</code>. If you need to test for only certain sheets, then <code>Case &quot;Thing&quot;, &quot;This&quot;, &quot;That&quot;, &quot;There&quot;: vAr2 = &quot;[&quot; &amp; sheet.Name &amp; &quot;]&quot;</code>"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1469662712, "post_id": 38621873, "comment_id": 64635142, "body": "@ScottHoltzman no shit? Thats pretty baller. This is def illustrating in the way i&#39;d like to learn in so much as it implicates modularity/flexibility. I wish it thought of it myself"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 1, "creation_date": 1469712509, "post_id": 38621873, "comment_id": 64658678, "body": "@DougCoats - remember, there are no original thoughts. We are all just growing in awareness. :)"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1469713357, "post_id": 38621873, "comment_id": 64659376, "body": "@ScottHoltzman thats an awefully socratic thought..... Either way I am not sure I can do away with the select case due to some sheet names do not match the tables names but that would be an easy adjustment though. I think i nay do that b/c thats a better code structure"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 3, "last_activity_date": 1469648644, "creation_date": 1469648644, "answer_id": 38621873, "question_id": 38621641, "link": "https://stackoverflow.com/questions/38621641/looping-through-each-sheet-not-working/38621873#38621873", "title": "Looping Through Each Sheet not Working", "body": "\n\n<p>You use</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Select Case ActiveSheet.Name\n</code></pre>\n\n<p>but your loop is</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>For Each sheet In ActiveWorkbook.Worksheets\n</code></pre>\n\n<p>so it always uses the first sheet (default active after opening the workbook).<br>\nIt should be:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Select Case sheet.Name\n</code></pre>\n\n<p>and your case statements would be easier just like this:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>     Case \"Thing\"\n</code></pre>\n"}], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "accepted_answer_id": 38621873, "answer_count": 1, "score": 0, "last_activity_date": 1469648658, "creation_date": 1469647816, "last_edit_date": 1531164843, "question_id": 38621641, "link": "https://stackoverflow.com/questions/38621641/looping-through-each-sheet-not-working", "title": "Looping Through Each Sheet not Working", "body": "<p>I wrote this macro to loop through all files in a folder and loop through each sheet in each file. Then on a per sheet basis run SQL to an Access DB and return results to a sheet. Problem is is that it isnt looping through each sheet, and constantly returns only the last Select Case option in debug.print. Any idea why? Do i need to statically set start sheet? This structure works perfectly in other scenarios. Is the introduction of SQL the issue?</p>\n\n<p>code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub attempttomindeIDs()\nDim db As DAO.Database\nDim rst As DAO.Recordset\nDim strConnection As String\nDim i As Integer, fld As Object\nDim vAriable As Long\nDim sheet As Worksheet\nDim wsO As Worksheet\nDim wbk As Workbook\nDim Filename As String\nDim path As String\nDim rCell As Range\nDim rRng As Range\nDim StartTime As Double\nDim SecondsElapsed As Double\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\nApplication.Calculation = xlCalculationManual\n\n' MS OFfice 15.0 Access Database engine object\n\nStartTime = Timer\n\nSet db = DBEngine.OpenDatabase(\"pathtoDB\" &amp; \"\\\" &amp; \"Microsoft1.accdb\")\n\npath = \"pathtofolder\" &amp; \"\\\"\nFilename = Dir(path &amp; \"*.xl??\")\nSet wsO = ThisWorkbook.Sheets(\"Sheet1\")\n\nDo While Len(Filename) &gt; 0\n    DoEvents\n    Set wbk = Workbooks.Open(path &amp; Filename, True, True)\n    For Each sheet In ActiveWorkbook.Worksheets\n    If sheet.Index &gt; 1 Then\n    Set rRng = sheet.Range(\"b2:b308\")\n        For Each rCell In rRng.Cells\n            If rCell &lt;&gt; \"\" Then\n                vAriable = rCell\n\n                Debug.Print \" name \"; ActiveSheet.Name\n\n                Select Case ActiveSheet.Name\n                    Case Is = \"Thing\"\n                        vAr2 = \"[Thing]\"\n                    Case Is = \"There\"\n                        vAr2 = \"[There]\"\n                    Case Is = \"That\"\n                        vAr2 = \"[That]\"\n                    Case Is = \"This\"\n                        vAr2 = \"[This]\"\n                End Select\n\n                Set rst = db.OpenRecordset(\"SELECT [ID], [Column] FROM \" &amp; vAr2 &amp; \" WHERE [ID] =\" &amp; vAriable)\n\n                wsO.Cells(Sheet1.Rows.Count, 1).End(xlUp).Offset(1, 0).CopyFromRecordset rst\n                wsO.Columns(7).Cells(Sheet1.Rows.Count, 1).End(xlUp).Offset(1, 0) = Right(ActiveWorkbook.Name, Len(ActiveWorkbook.Name) - InStr(ActiveWorkbook.Name, \"/\"))\n                wsO.Columns(9).Cells(Sheet1.Rows.Count, 1).End(xlUp).Offset(1, 0) = ActiveSheet.Name\n\n            End If\n        Next rCell\n        End If\n    Next\n    wbk.Close False\n    Filename = Dir\nLoop\n\nrst.Close\nSet rst = Nothing\ndb.Close\nSet db = Nothing\n\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\nApplication.Calculation = xlCalculationAutomatic\n\nSecondsElapsed = Round(Timer - StartTime, 2)\nMsgBox \"This code ran successfully in \" &amp; SecondsElapsed &amp; \" seconds\", vbInformation\n</code></pre>\n"}, {"tags": ["image", "vba", "excel"], "comments": [{"owner": {"reputation": 31, "user_id": 6620959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39c67fb26633cc9c257ce1c3c5f45f57?s=128&d=identicon&r=PG", "display_name": "D. B.", "link": "https://stackoverflow.com/users/6620959/d-b"}, "edited": false, "score": 0, "creation_date": 1469647391, "post_id": 38621388, "comment_id": 64628764, "body": "In an ideal world I would hope it would work like this: 1. Place all images in an array 2. using the key number of the image in the array, assign it to a corresponding cell number 3. Parse the dimensions of the corresponding cell, and apply the dimensions to the image."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1469647673, "post_id": 38621388, "comment_id": 64628901, "body": "You&#39;ll receive a lot more help if you show us what you&#39;ve tried to accomplish this. SO is not a &quot;code for me&quot; site. You have the steps, now write the code and post back where you get stuck on any steps."}, {"owner": {"reputation": 31, "user_id": 6620959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39c67fb26633cc9c257ce1c3c5f45f57?s=128&d=identicon&r=PG", "display_name": "D. B.", "link": "https://stackoverflow.com/users/6620959/d-b"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1469647786, "post_id": 38621388, "comment_id": 64628964, "body": "See edit, added what I have tried."}, {"owner": {"reputation": 31, "user_id": 6620959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39c67fb26633cc9c257ce1c3c5f45f57?s=128&d=identicon&r=PG", "display_name": "D. B.", "link": "https://stackoverflow.com/users/6620959/d-b"}, "edited": false, "score": 1, "creation_date": 1469648179, "post_id": 38621388, "comment_id": 64629172, "body": "unfortunately I only have the images in the clipboard, and not as individual files."}], "answers": [{"tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": false, "score": 0, "last_activity_date": 1469648636, "creation_date": 1469648636, "answer_id": 38621872, "question_id": 38621388, "link": "https://stackoverflow.com/questions/38621388/snap-over-250-images-to-one-image-per-cell/38621872#38621872", "title": "Snap over 250 images to one image per cell", "body": "<p>This quick loop will move through all shapes and set them to \"Move and Size with Cells\".</p>\n\n<pre><code>Sub Testing()\n\n    For x = 1 To ActiveSheet.Shapes.Count\n        ActiveSheet.Shapes(x).Placement = xlMoveAndSize\n    Next x\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6620959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39c67fb26633cc9c257ce1c3c5f45f57?s=128&d=identicon&r=PG", "display_name": "D. B.", "link": "https://stackoverflow.com/users/6620959/d-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1469648636, "creation_date": 1469646948, "last_edit_date": 1469647848, "question_id": 38621388, "link": "https://stackoverflow.com/questions/38621388/snap-over-250-images-to-one-image-per-cell", "title": "Snap over 250 images to one image per cell", "body": "<p>I am working on a spreadsheet at work and a coworker pasted over 250 images ontop of a column. The images are not snapped to the cells they correspond to, so any manipulation of the cells causes to images to be in the wrong place. </p>\n\n<p>I am looking for a way to paste all the images into cells, and have them be a part of the cell, just as if I were pasting a list of text.</p>\n\n<p>In an ideal world I would hope it would work like this: </p>\n\n<ol>\n<li>Place all images in an array </li>\n<li>using the key number of the image in the array, assign it to a corresponding cell number </li>\n<li>Parse the dimensions of the corresponding cell, and apply the dimensions to the image</li>\n</ol>\n\n<p>This is what I have tried:</p>\n\n<pre><code>Sub movePics()\n  Dim picCounter As Long\n\n  picCounter = 0\n  For Each s In ActiveSheet.Shapes\n    picCounter = picCounter + 1\n    With s\n      .Left = 100\n      .Top = ActiveSheet.Rows(picCounter).Top\n      .Placement = xlMoveAndSize\n    End With\n  Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "dictionary"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1469647069, "post_id": 38620989, "comment_id": 64628597, "body": "Every time you call SearchSAP you&#39;re recreating the Dictionary: make that <code>Static</code> instead of just using Dim."}, {"owner": {"reputation": 6639, "user_id": 1157100, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/1f9W9.png?s=128&g=1", "display_name": "200_success", "link": "https://stackoverflow.com/users/1157100/200-success"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1469650533, "post_id": 38620989, "comment_id": 64630364, "body": "@MacroMan Even though you may be correct that this question is off-topic, <a href=\"http://meta.stackoverflow.com/q/313266/1157100\">please pick a bona fide reason for closing it on Stack Overflow</a>. &quot;Belongs on <i>some other site</i>&quot; is insufficient justification for closing a question."}, {"owner": {"reputation": 6639, "user_id": 1157100, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/1f9W9.png?s=128&g=1", "display_name": "200_success", "link": "https://stackoverflow.com/users/1157100/200-success"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1469652243, "post_id": 38620989, "comment_id": 64631253, "body": "@MacroMan Even if the end result is the same, explaining your reasoning matters. Otherwise, the OP and other users have no idea <i>why</i> you think it&#39;s off-topic, and your vote would appear to be purely based on your arbitrary opinion."}, {"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1469699824, "post_id": 38620989, "comment_id": 64649451, "body": "Can the lookup ranges be sorted by column 1? this makes your search much quicker. You then use double vlookup technique, like pseudocode: <code>if(vlookup(stkCd, sortedTable, 1, true)=stkCd , then searchSap = vlookup(stkCd, sortedTable, 2, true)</code>. You can convert this to proper VBA, or a formula version. It checks that the stkCd is exactly the cell value, then if so looks up column 2. Using binary search(approximate match) speeds up the whole process. Maybe 16-20 steps to find an item using binary search(x2 because we are vlooking up twice), whereas exact match takes 20k if the item is on row 20K"}, {"owner": {"reputation": 261, "user_id": 1886177, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/802fea2c89705accabcc51f34fc99110?s=128&d=identicon&r=PG&f=1", "display_name": "Isa", "link": "https://stackoverflow.com/users/1886177/isa"}, "edited": false, "score": 0, "creation_date": 1469723673, "post_id": 38620989, "comment_id": 64667229, "body": "I did not know why Static would make a difference, but it did work. The times I have given above were only for one single execution of the function and there were no multiple calls in the function when I was testing this. Still don&#39;t really understand where the time savings came from. I am thinking it probably is more likely from using the .range approach instead of getting data cell by cell. Thanks all of you though! Appreciate it a lot!"}], "answers": [{"comments": [{"owner": {"reputation": 261, "user_id": 1886177, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/802fea2c89705accabcc51f34fc99110?s=128&d=identicon&r=PG&f=1", "display_name": "Isa", "link": "https://stackoverflow.com/users/1886177/isa"}, "edited": false, "score": 0, "creation_date": 1469723359, "post_id": 38621596, "comment_id": 64667056, "body": "10 mins to &lt;1 second. You guys are awesome! :&gt;"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 261, "user_id": 1886177, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/802fea2c89705accabcc51f34fc99110?s=128&d=identicon&r=PG&f=1", "display_name": "Isa", "link": "https://stackoverflow.com/users/1886177/isa"}, "edited": false, "score": 0, "creation_date": 1469726237, "post_id": 38621596, "comment_id": 64668764, "body": "Worth noting that if you edit the lookup range after the <code>Dict</code> variable has been initialized, you will need to reset the VBproject to clear the variable."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1470519444, "last_edit_date": 1470519444, "creation_date": 1469647685, "answer_id": 38621596, "question_id": 38620989, "link": "https://stackoverflow.com/questions/38620989/dictionary-use-ms-scripting-library-and-other-methods-of-improving-execution-t/38621596#38621596", "title": "Dictionary use (MS Scripting Library) and other methods of improving execution times in vba for excel files with greater than 100,000 rows of data", "body": "<pre><code>Public Function SearchSAP(StkCd As Long) As Long\n\n    Static Dict As scripting.dictionary 'precerved between calls\n    Dim i As Long, arr\n\n    If Dict Is Nothing Then\n        'create and populate dictionary\n        Set Dict = New scripting.dictionary\n        With ActiveWorkbook.Worksheets(\"SAP\")\n            arr = .Range(.Range(\"A2\"), _\n                         .Cells(.Rows.Count, \"A\").End(xlUp).Offset(0, 1)).Value\n        End With\n        For i = 1 To UBound(arr, 1)\n            Dict.Add arr(i, 1), arr(i, 2)\n        Next i\n    End If\n\n    If Dict.exists(cstr(StkCd)) Then\n        SearchSAP = CLng(Dict(cstr(StkCd)))\n    Else\n        SearchSAP = -1\n    End If\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 261, "user_id": 1886177, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/802fea2c89705accabcc51f34fc99110?s=128&d=identicon&r=PG&f=1", "display_name": "Isa", "link": "https://stackoverflow.com/users/1886177/isa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 1, "accepted_answer_id": 38621596, "answer_count": 1, "score": 0, "last_activity_date": 1470519444, "creation_date": 1469645494, "last_edit_date": 1495542176, "question_id": 38620989, "link": "https://stackoverflow.com/questions/38620989/dictionary-use-ms-scripting-library-and-other-methods-of-improving-execution-t", "title": "Dictionary use (MS Scripting Library) and other methods of improving execution times in vba for excel files with greater than 100,000 rows of data", "body": "<p>Consider the scenario where you have a bunch of assets, and you have numbers associated to each type of assets. We are changing these numbers from set A to set B, so I am writing a script to populate some values for Set B in a new column in excel based on the original set A number. There are 110,000 items in each set.  </p>\n\n<p>Due to the information being scattered across a lot of sheets, I have adopted a VBA approach. My original code executed via a simple comparison of the strings:</p>\n\n<pre><code>Public Function SearchSAP(StkCd As Long) As Long\n    Dim wb As Workbook\n    Dim shSAP As Worksheet\n    Dim i As Long\n\n    ' SAP sheet name is fixed and does not change\n    Set wb = ActiveWorkbook\n    Set shSAP = wb.Worksheets(\"SAP\")\n\n    ' i is the start row of the SAP sheet for data\n    i = 2\n\n    ' Define no-match value as -1\n    SearchSAP = -1        \n\n    Do While i &lt; shSAP.UsedRange.Rows.Count And i &lt; 106212\n        If shSAP.Cells(i, 1).value = Stkcd Then\n            SearchSAP = shSAP.Cells(i, 2).value\n            Exit Do\n        End If\n\n        i = i + 1\n    Loop\n\n    Set shSAP = Nothing\n    Set wb = Nothing\nEnd Function\n</code></pre>\n\n<p>This function took me forever to execute, probably closer to like 15-20 minutes on an i7 net 2.4 GHz core. I almost thought I have coded it wrong with an infinity loop. when it finally gave me \"-1\" did I realize that it really did take that long. Researching on stackoverflow, I found the post \" <a href=\"https://stackoverflow.com/questions/18656808/how-to-optimize-vlookup-for-high-search-count-alternatives-to-vlookup\">How to optimize vlookup for high search count ? (alternatives to VLOOKUP)</a>\n\" which seems to indicate that dictionary is the way to go. So I tried that:</p>\n\n<pre><code>Public Function SearchSAP(StkCd As Long) As Long\n    Dim wb As Workbook\n    Dim shSAP As Worksheet\n    Dim Dict As New Scripting.Dictionary\n    Dim i As Long\n\n    ' SAP sheet name is fixed and does not change\n    Set wb = ActiveWorkbook\n    Set shSAP = wb.Worksheets(\"SAP\")\n\n    ' i is the start row of the SAP sheet for data\n    i = 2\n\n    ' Define null value as -1\n    SearchSAP = -1\n\n    Do While i &lt; shSAP.UsedRange.Rows.Count And i &lt; 106212\n        Dict.Add shSAP.Cells(i, 1).value, shSAP.Cells(i, 2).value\n        i = i + 1\n    Loop\n\n    Do While i &lt; shSAP.UsedRange.Rows.Count And i &lt; 106212\n        If Dict.Exists(StkCd) Then\n            SearchSAP = Dict(StkCd)\n            Exit Do\n        End If\n\n        i = i + 1\n\n        If i = 150000 Then\n            Debug.Print \"Break\"\n        End If\n    Loop\n\n    Set shSAP = Nothing\n    Set wb = Nothing\nEnd Function\n</code></pre>\n\n<p>But this function still took a good 5 mins or so to figure itself out. My question then is, am I approaching this in a pretty dumb manner? How can I do this more efficiently? I am not a full time programmer, so I wasn't sure what I can do to optimize this. Any help would be great!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 32943, "user_id": 765226, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/b0Qnm.jpg?s=128&g=1", "display_name": "Alexis Olson", "link": "https://stackoverflow.com/users/765226/alexis-olson"}, "edited": false, "score": 1, "creation_date": 1469643202, "post_id": 38620279, "comment_id": 64626407, "body": "In the first case, do you want it to return the text &quot;1+2+3&quot; or the numeric value 6?"}, {"owner": {"reputation": 32943, "user_id": 765226, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/b0Qnm.jpg?s=128&g=1", "display_name": "Alexis Olson", "link": "https://stackoverflow.com/users/765226/alexis-olson"}, "edited": false, "score": 2, "creation_date": 1469643927, "post_id": 38620279, "comment_id": 64626803, "body": "Also, are you always going to have just three numbers or do you need it to work for more too? (FWIW, the number of results grows like 2^n.)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1469644274, "post_id": 38620279, "comment_id": 64627027, "body": "See <a href=\"http://stackoverflow.com/questions/31472816/expanding-column-cells-for-each-column-cell/31594569#31594569\">Expanding column cells for each column cell</a> and include a blank with every value."}, {"owner": {"reputation": 1, "user_id": 6646203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bda494ebf91ae1e0f8014954ae623e0b?s=128&d=identicon&r=PG&f=1", "display_name": "AJ C", "link": "https://stackoverflow.com/users/6646203/aj-c"}, "reply_to_user": {"reputation": 32943, "user_id": 765226, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/b0Qnm.jpg?s=128&g=1", "display_name": "Alexis Olson", "link": "https://stackoverflow.com/users/765226/alexis-olson"}, "edited": false, "score": 0, "creation_date": 1470255681, "post_id": 38620279, "comment_id": 64879752, "body": "Thank you all for the responses.  @AlexisOlson: I do not want it to return the number 6, I want it to return the combinations as 1+2=3 and 3=3...  Only addition YowE3K."}, {"owner": {"reputation": 1, "user_id": 6646203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bda494ebf91ae1e0f8014954ae623e0b?s=128&d=identicon&r=PG&f=1", "display_name": "AJ C", "link": "https://stackoverflow.com/users/6646203/aj-c"}, "edited": false, "score": 0, "creation_date": 1470255949, "post_id": 38620279, "comment_id": 64879878, "body": "Ok a more detailed explanation to my basic question: I have 15-20 Invoices consisting of various amounts. I have 3 Cost centers.  1st Cost Center = 900000, 2nd Cost Center = 600000, 3rd Cost Center = 500000.  I want the invoices to go into cost center 1, taking cost center 1 to the closest to 0 before going into cost center 2 taking it closest to 0 and then to cost center 3.  So what I want is the breakdown of the invoices that goes to cost center 1, cost center 2 and cost center 3.  Thank you"}, {"owner": {"reputation": 32943, "user_id": 765226, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/b0Qnm.jpg?s=128&g=1", "display_name": "Alexis Olson", "link": "https://stackoverflow.com/users/765226/alexis-olson"}, "edited": false, "score": 0, "creation_date": 1470281759, "post_id": 38620279, "comment_id": 64888577, "body": "@AJC I think I may understand. So your original question is part of a brute force attempt at solving a multi-stage <a href=\"https://en.wikipedia.org/wiki/Knapsack_problem\" rel=\"nofollow noreferrer\">knapsack problem</a>? Given that your n is around 20, brute force seems feasible."}], "owner": {"reputation": 1, "user_id": 6646203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bda494ebf91ae1e0f8014954ae623e0b?s=128&d=identicon&r=PG&f=1", "display_name": "AJ C", "link": "https://stackoverflow.com/users/6646203/aj-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1469644199, "creation_date": 1469643013, "last_edit_date": 1531161705, "question_id": 38620279, "link": "https://stackoverflow.com/questions/38620279/generate-a-list-of-possible-results-excel", "title": "Generate a list of possible results - Excel", "body": "<p>I want to create a list of possible results out of a set amount of numbers. See example below:</p>\n\n<p>Numbers in list:</p>\n\n<pre><code>1\n2\n3\n</code></pre>\n\n<p>The result I would want here would be:</p>\n\n<pre><code>1+2+3\n1+2\n1+3\n2+3\n1\n2\n3\n</code></pre>\n\n<p>How would I go about generating these results using either Excel or Excel VBA?</p>\n\n<p>Thank you in advance</p>\n"}, {"tags": ["vba", "loops", "filter", "macros"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6645555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4479980d9a3dcaae670fe0c9f8410249?s=128&d=identicon&r=PG&f=1", "display_name": "cameri", "link": "https://stackoverflow.com/users/6645555/cameri"}, "edited": false, "score": 0, "creation_date": 1469801893, "post_id": 38627432, "comment_id": 64703099, "body": "Thank you Shai Rado for your help. This works for my macro. I only removed the Option Explicit since I experienced &quot;compile error variable not defined&quot;. I would also like to ask if  how I can set that it will go to the next fiscal year if it happens that there are no data for a certain fiscal year?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 3, "user_id": 6645555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4479980d9a3dcaae670fe0c9f8410249?s=128&d=identicon&r=PG&f=1", "display_name": "cameri", "link": "https://stackoverflow.com/users/6645555/cameri"}, "edited": false, "score": 0, "creation_date": 1469812665, "post_id": 38627432, "comment_id": 64709349, "body": "@cameri see edited code, it will loop through the years and filter your table, later it will show you how many rows there are per year. I am not sure what you want to do in case it is 0, or if it&#39;s not 0 ?"}, {"owner": {"reputation": 3, "user_id": 6645555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4479980d9a3dcaae670fe0c9f8410249?s=128&d=identicon&r=PG&f=1", "display_name": "cameri", "link": "https://stackoverflow.com/users/6645555/cameri"}, "edited": false, "score": 0, "creation_date": 1469817398, "post_id": 38627432, "comment_id": 64711777, "body": "in case it is 0, I want it to proceed to the next fiscal year. if it is not 0 then just proceed as it is until the end. Thanks in advance. :)"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 3, "user_id": 6645555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4479980d9a3dcaae670fe0c9f8410249?s=128&d=identicon&r=PG&f=1", "display_name": "cameri", "link": "https://stackoverflow.com/users/6645555/cameri"}, "edited": false, "score": 0, "creation_date": 1469818224, "post_id": 38627432, "comment_id": 64712279, "body": "@cameri sorry, but I am not following what you need. Anyway, I think I have answered your original post"}, {"owner": {"reputation": 3, "user_id": 6645555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4479980d9a3dcaae670fe0c9f8410249?s=128&d=identicon&r=PG&f=1", "display_name": "cameri", "link": "https://stackoverflow.com/users/6645555/cameri"}, "edited": false, "score": 0, "creation_date": 1469818676, "post_id": 38627432, "comment_id": 64712514, "body": "In case one of the fiscal years has no data, say for example we omit the 2014 fiscal year in the data I provided, then I want it to go to the 2015 fiscal year immediately."}, {"owner": {"reputation": 3, "user_id": 6645555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4479980d9a3dcaae670fe0c9f8410249?s=128&d=identicon&r=PG&f=1", "display_name": "cameri", "link": "https://stackoverflow.com/users/6645555/cameri"}, "edited": false, "score": 0, "creation_date": 1469818725, "post_id": 38627432, "comment_id": 64712537, "body": "Yes, you have answered my original post. :) Thanks a lot for that!"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 3, "user_id": 6645555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4479980d9a3dcaae670fe0c9f8410249?s=128&d=identicon&r=PG&f=1", "display_name": "cameri", "link": "https://stackoverflow.com/users/6645555/cameri"}, "edited": false, "score": 0, "creation_date": 1469819130, "post_id": 38627432, "comment_id": 64712746, "body": "@cameri open a new post, and just add the code you currently have, and have screen-shots with details what you would like to do."}, {"owner": {"reputation": 3, "user_id": 6645555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4479980d9a3dcaae670fe0c9f8410249?s=128&d=identicon&r=PG&f=1", "display_name": "cameri", "link": "https://stackoverflow.com/users/6645555/cameri"}, "edited": false, "score": 0, "creation_date": 1469821054, "post_id": 38627432, "comment_id": 64713648, "body": "Thanks Shai! I posted another question. Proceed to Next Filter if Rows are Empty."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1469812612, "last_edit_date": 1469812612, "creation_date": 1469682122, "answer_id": 38627432, "question_id": 38620234, "link": "https://stackoverflow.com/questions/38620234/copy-autofiltered-data-loop-until-end/38627432#38627432", "title": "Copy AutoFiltered Data Loop Until End", "body": "<p>The code below will help you loop through the Years Filter.</p>\n\n<pre><code>Option Explicit\n\nSub Loop_FiscalYear()\n\nDim Sht                     As Worksheet\nDim Year_Loop               As Integer\nDim Year_Start              As Integer\nDim Year_Finish             As Integer\n\n' modify Sheet1 to your sheet name\nSet Sht = ThisWorkbook.Sheets(\"Sheet1\")\n\n' modify these parameters according to your needs\nYear_Start = 2012\nYear_Finish = 2016\n\nFor Year_Loop = Year_Start To Year_Finish\n    Sht.Range(\"$A$1:$D$20\").AutoFilter Field:=3, Criteria1:=Year_Loop\n\n    ' do your other stuff here.....\n\nNext Year_Loop\n\nEnd Sub\n</code></pre>\n\n<p><strong>Edit 1</strong>: Option Code number 2, count number of visible rows per Filtered Year</p>\n\n<pre><code>Sub Loop_FiscalYear()\n\nDim Sht                     As Worksheet\nDim Data_Rng                As Range\nDim Year_Loop               As Integer\nDim Year_Start              As Integer\nDim Year_Finish             As Integer\nDim VisibleRows             As Long\nDim Last_Row                As Long\nDim Last_Col                As Long\nDim RngArea\n\n' modify Sheet1 to your sheet name\nSet Sht = ThisWorkbook.Sheets(\"Sheet5\") ' (\"Sheet1\")\n\n' remove all filters from table's data\nSht.Range(\"C1\").Select\n\nIf ActiveSheet.AutoFilterMode Or ActiveSheet.FilterMode Then\n    ActiveSheet.AutoFilter.ShowAllData\nEnd If\n\n' find last row in sheet\nLast_Row = Cells(Rows.Count, \"A\").End(xlUp).row\n\n' find last column in sheet\nLast_Col = Cells(1, Columns.Count).End(xlToLeft).Column\n\nSet Data_Rng = Sht.Range(Cells(1, 1), Cells(Last_Row, Last_Col))\n\n' modify these parameters according to your needs\nYear_Start = 2012\nYear_Finish = 2016\n\nFor Year_Loop = Year_Start To Year_Finish\n\n    With Data_Rng\n        .AutoFilter Field:=3, Criteria1:=Year_Loop\n        .Select\n\n        ' count number of rows in Filtered area\n        For Each RngArea In .SpecialCells(xlCellTypeVisible).Areas\n            VisibleRows = VisibleRows + RngArea.Rows.Count\n        Next\n\n        ' MsgBox just for easy debug\n        MsgBox \"Autofilter \" &amp; VisibleRows - 1 &amp; \" rows \"\n\n        If VisibleRows = 0 Then\n            ' do something...\n\n        End If\n    End With\n\n    ' reset value for Next year loop\n    VisibleRows = 0\n\nNext Year_Loop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6645555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4479980d9a3dcaae670fe0c9f8410249?s=128&d=identicon&r=PG&f=1", "display_name": "cameri", "link": "https://stackoverflow.com/users/6645555/cameri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 319, "favorite_count": 0, "accepted_answer_id": 38627432, "answer_count": 1, "score": 0, "last_activity_date": 1469812612, "creation_date": 1469642866, "question_id": 38620234, "link": "https://stackoverflow.com/questions/38620234/copy-autofiltered-data-loop-until-end", "title": "Copy AutoFiltered Data Loop Until End", "body": "<p><a href=\"http://i.stack.imgur.com/mDjcq.jpg\" rel=\"nofollow\">Data to Filter</a></p>\n\n<p>Hi,</p>\n\n<p>I have created a macro file linked to a script. I would like it to filter the Fiscal Year Column  from the first fiscal year and copy it to another sheet then loop it until all fiscal year have been processed.</p>\n\n<p>I made a repetitive actions in the module but if I remove one of the fiscal year, it won't continue.</p>\n\n<p>How do I filter the criteria with the available fiscal years and it will loop until the end? My problem is the code below since it only specifies one fiscal year.</p>\n\n<p>ActiveSheet.Range(\"$A$1:$D$20\").AutoFilter Field:=3, Criteria1:=\"2012\"</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["vba", "button", "click"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 1, "creation_date": 1469642742, "post_id": 38620160, "comment_id": 64626125, "body": "Try using getElementsByClassName(&quot;big buttons&quot;)(Index), where Index is the occurrence of that element on the page. The index starts at 0."}, {"owner": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 0, "creation_date": 1469643652, "post_id": 38620160, "comment_id": 64626648, "body": "Try <code>tagx.click</code> instead. I think what you&#39;re doing is accessing the onclick event code instead of actually generating a click event."}, {"owner": {"reputation": 1, "user_id": 6646002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d6923b0991f1a8fb9023058d4af4b3a?s=128&d=identicon&r=PG&f=1", "display_name": "eguene", "link": "https://stackoverflow.com/users/6646002/eguene"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1469654070, "post_id": 38620160, "comment_id": 64632168, "body": "@RyanWildry Thanks, getelementsByClassName works fine, I tested on some other buttons. The problem looks to lie in the way I am clicking..."}, {"owner": {"reputation": 1, "user_id": 6646002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d6923b0991f1a8fb9023058d4af4b3a?s=128&d=identicon&r=PG&f=1", "display_name": "eguene", "link": "https://stackoverflow.com/users/6646002/eguene"}, "reply_to_user": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 0, "creation_date": 1469654158, "post_id": 38620160, "comment_id": 64632218, "body": "@Mikegrann I tried both and there is no effect - basically no clicking occurs."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1469654263, "post_id": 38620160, "comment_id": 64632275, "body": "Did you try firing an onclick event?"}, {"owner": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 0, "creation_date": 1469655094, "post_id": 38620160, "comment_id": 64632680, "body": "Check the return value of tagx.click, which will give an error code if the method fails. <a href=\"https://msdn.microsoft.com/en-us/library/aa752277(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/aa752277(v=vs.85).aspx</a>"}, {"owner": {"reputation": 1, "user_id": 6646002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d6923b0991f1a8fb9023058d4af4b3a?s=128&d=identicon&r=PG&f=1", "display_name": "eguene", "link": "https://stackoverflow.com/users/6646002/eguene"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1469657647, "post_id": 38620160, "comment_id": 64633757, "body": "@RyanWildry This is what I tried  `    Set tags = IE.document.getElementsByClassName(&quot;big buttons&quot;)       For Each tagx In tags       tagx.Click       tagx.FireEvent &quot;onclick&quot;       Next`  Does not click still"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1469714176, "post_id": 38620160, "comment_id": 64660084, "body": "If possible, post the website you are trying to control."}], "owner": {"reputation": 1, "user_id": 6646002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d6923b0991f1a8fb9023058d4af4b3a?s=128&d=identicon&r=PG&f=1", "display_name": "eguene", "link": "https://stackoverflow.com/users/6646002/eguene"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 410, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1469642577, "creation_date": 1469642577, "question_id": 38620160, "link": "https://stackoverflow.com/questions/38620160/click-a-button-with-js-without-id-vba", "title": "click a button with js without ID VBA", "body": "<p>Trying to click the following button for the whole day now but still can not find a solution (being very new).</p>\n\n<p>That is the extract from the website</p>\n\n<pre>\ninput type=\"button\" class=\"big buttons\" title=\" New\" value=\"Create new product\" onclick=\"long js sentence\" style=\"color:#000000\">\n</pre>\n\n<p>This is what I try but the event is not happening. Well, I tried many other ways, too.</p>\n\n<pre><code>Set tags = IE.document.getElementsByTagName(\"Button\")\nFor Each tagx In tags\nIf tagx.Value = \"Create new product\" Then\ntagx.onclick\nEnd If\nNext\n</code></pre>\n\n<p>Many thanks for help in advance,</p>\n"}, {"tags": ["excel", "windows-7-x64", "excel-2016", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1469642571, "post_id": 38620127, "comment_id": 64626030, "body": "Write code that goes through the sheet and locks the Odd and unlocks the even.  Then protect the sheet so that the locked are not able to be chosen."}, {"owner": {"reputation": 14758, "user_id": 654789, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/44ca44bc65f36895abb2ad8f577139e7?s=128&d=identicon&r=PG", "display_name": "puk", "link": "https://stackoverflow.com/users/654789/puk"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1469642698, "post_id": 38620127, "comment_id": 64626101, "body": "I am doing that right now, but for some reason even changing the color of an unlocked cell is causing an error"}, {"owner": {"reputation": 14758, "user_id": 654789, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/44ca44bc65f36895abb2ad8f577139e7?s=128&d=identicon&r=PG", "display_name": "puk", "link": "https://stackoverflow.com/users/654789/puk"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1469645416, "post_id": 38620127, "comment_id": 64627707, "body": "To user jeeped, this is not a duplicate. They are two different questions. Please read them again"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1469645486, "post_id": 38620127, "comment_id": 64627746, "body": "You need to use the <code>@</code> then the user name to get his attention. like @puk"}, {"owner": {"reputation": 14758, "user_id": 654789, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/44ca44bc65f36895abb2ad8f577139e7?s=128&d=identicon&r=PG", "display_name": "puk", "link": "https://stackoverflow.com/users/654789/puk"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1469645645, "post_id": 38620127, "comment_id": 64627834, "body": "@ScottCraner I thought @ only works when responding to people, I didn&#39;t know it could be used to get any user&#39;s attention."}, {"owner": {"reputation": 14758, "user_id": 654789, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/44ca44bc65f36895abb2ad8f577139e7?s=128&d=identicon&r=PG", "display_name": "puk", "link": "https://stackoverflow.com/users/654789/puk"}, "edited": false, "score": 0, "creation_date": 1469645661, "post_id": 38620127, "comment_id": 64627840, "body": "@Jeeped please explain how the two questions are duplicates."}], "owner": {"reputation": 14758, "user_id": 654789, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/44ca44bc65f36895abb2ad8f577139e7?s=128&d=identicon&r=PG", "display_name": "puk", "link": "https://stackoverflow.com/users/654789/puk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 17, "favorite_count": 0, "closed_date": 1469644633, "answer_count": 0, "score": 0, "last_activity_date": 1469642660, "creation_date": 1469642444, "last_edit_date": 1531164843, "question_id": 38620127, "link": "https://stackoverflow.com/questions/38620127/how-to-prevent-clicking-selecting-of-odd-rows-and-columns-in-excel-through-vba", "closed_reason": "Duplicate", "title": "How to prevent clicking/selecting of odd rows and columns in Excel through VBA", "body": "<p>I am using the odd rows and columns as padding right now. I am making sure the user can't insert anything in it through use of modular arithmetic: </p>\n\n<ul>\n<li>If they are in an odd row and press enter, they are shifted down one, and then they can type to edit</li>\n<li>If they are in an even row and press enter, they are shifted down two rows, then they can type to edit (or they can just type immediately to edit)</li>\n</ul>\n\n<p>Now is there any way, via VBA to restrict the users ability to select/edit odd rows and columns altogether?</p>\n\n<p><strong>EDIT:</strong> I don't expect all odd rows/columns to be uneditable from the get go. I just need a function which takes as input the row, and then makes it so the whole row can't be clicked. Likewise for columns. In this way, if the user decides to add a new row/column, I first add a row/column, make it uneditable, then I add the row/column for the user to edit</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 84, "user_id": 2132651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db0ff088728531f3c0a9e6efda12c0fd?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/2132651/anthony"}, "edited": false, "score": 0, "creation_date": 1469642442, "post_id": 38619755, "comment_id": 64625953, "body": "How far into the for loop do you get before the error?  Need more info on the debugging you&#39;ve done."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 1, "creation_date": 1469645411, "post_id": 38619755, "comment_id": 64627701, "body": "I think using &#39;dbDouble&#39; will more than meet your needs and should execute without error - no need for specifying length"}, {"owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 1, "creation_date": 1469827218, "post_id": 38619755, "comment_id": 64716201, "body": "Note that your code is using DAO objects (e.g., <code>TableDef</code>) whereas the (working) code in my answer is using ADOX objects."}, {"owner": {"reputation": 599, "user_id": 1422252, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3a0754a5356995ba9b91a3cbf43f91c4?s=128&d=identicon&r=PG", "display_name": "PhillipOReilly", "link": "https://stackoverflow.com/users/1422252/philliporeilly"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 1, "creation_date": 1469828438, "post_id": 38619755, "comment_id": 64716691, "body": "Sorry, took couple days off. It chokes on first iteration. @dbmitch, tried your simple approach and that worked! If you put it as an answer, I will select it as THE answer."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1469828697, "post_id": 38619755, "comment_id": 64716781, "body": "No problem - looks like someone closed this question off so I can&#39;t add an answer. You can just upvote my comment if you want."}], "answers": [{"comments": [{"owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 1, "creation_date": 1469672444, "post_id": 38620353, "comment_id": 64637120, "body": "re: &quot;Decimal fields have their issues&quot; - Both of those references are quite out of date (circa Access 2000 and 2003). Access 2010 does not have a problem sorting Decimal values, and exporting to text does not fail, although it does export the values with string delimiters. Allen&#39;s contributions to the Access community are legendary - and most deservedly so - but he has been retired for many years now and things that were true five (or more) versions ago are not necessarily true today."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 0, "creation_date": 1469686288, "post_id": 38620353, "comment_id": 64640991, "body": "Thank you for this information, @Gord!"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 0, "last_activity_date": 1469686337, "last_edit_date": 1469686337, "creation_date": 1469643264, "answer_id": 38620353, "question_id": 38619755, "link": "https://stackoverflow.com/questions/38619755/invalid-field-data-type-when-use-tabledef-createfield-method-vba/38620353#38620353", "title": "Invalid field Data type when use TableDef.CreateField Method VBA", "body": "<p>Follow the <a href=\"http://allenbrowne.com/ser-49.html\" rel=\"nofollow\">link</a> in your linked question, and read the footnote #7 for DECIMAL:</p>\n\n<blockquote>\n  <p>[7] Not available in the Access query interface or DAO. Use ADO to Execute the DDL query statement. </p>\n</blockquote>\n\n<p>So you'd use something like this:</p>\n\n<pre><code>strSQL = \"ALTER TABLE myTable ADD COLUMN \" &amp; myVariableNames(iCount) &amp; \" DECIMAL (20,6);\"\nCurrentProject.Connection.Execute strSQL\n</code></pre>\n\n<p>Decimal fields <s>have</s> had (see comment below) their issues, see <a href=\"http://www.fmsinc.com/microsoftaccess/database-design/decimal_data_type/index.htm\" rel=\"nofollow\">Avoid Using Decimal Field Size in Microsoft Access Tables</a>\nor <a href=\"http://allenbrowne.com/bug-08.html\" rel=\"nofollow\">http://allenbrowne.com/bug-08.html</a></p>\n\n<p>Long or Double or Currency may be better options.</p>\n"}, {"comments": [{"owner": {"reputation": 599, "user_id": 1422252, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3a0754a5356995ba9b91a3cbf43f91c4?s=128&d=identicon&r=PG", "display_name": "PhillipOReilly", "link": "https://stackoverflow.com/users/1422252/philliporeilly"}, "edited": false, "score": 0, "creation_date": 1469828640, "post_id": 38629777, "comment_id": 64716759, "body": "Gord, thanks for your time. I suspect I will use your more sophisticated approach in the future. I have a bit of a newbie question: how do I implement or reference ADOX? Access is interpreting ADOX.Table as a user-defined type right now. Thanks, Phillip"}, {"owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "reply_to_user": {"reputation": 599, "user_id": 1422252, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3a0754a5356995ba9b91a3cbf43f91c4?s=128&d=identicon&r=PG", "display_name": "PhillipOReilly", "link": "https://stackoverflow.com/users/1422252/philliporeilly"}, "edited": false, "score": 0, "creation_date": 1469829475, "post_id": 38629777, "comment_id": 64717042, "body": "In the VBA development environment you need to do <code>Tools &gt; References...</code> and add a reference for &quot;Microsoft ADO Ext. 6.0 for DDL and Security&quot;. Note that your specific question is something of  special case: Most of the time DAO offers more complete coverage of Access features than ADOX does, it&#39;s just that support for <code>Decimal</code> fields is strangely lacking in DAO."}], "tags": [], "owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "is_accepted": false, "score": 1, "last_activity_date": 1469827255, "last_edit_date": 1469827255, "creation_date": 1469690987, "answer_id": 38629777, "question_id": 38619755, "link": "https://stackoverflow.com/questions/38619755/invalid-field-data-type-when-use-tabledef-createfield-method-vba/38629777#38629777", "title": "Invalid field Data type when use TableDef.CreateField Method VBA", "body": "<p>While it remains true that DAO does not seem to expose the required properties to create a <code>Decimal</code> field, even if we try using a <code>DAO.Field2</code> object, the following ADOX code does create a <code>Decimal</code> field (tested with Access 2010):</p>\n\n\n\n<pre class=\"lang-vbs prettyprint-override\"><code>Option Compare Database\nOption Explicit\n\nSub AddNewDecimalField()\n    Dim cat As New ADOX.Catalog\n    cat.ActiveConnection = CurrentProject.Connection\n    Dim tbl As ADOX.Table\n    Set tbl = cat.Tables(\"MyTable\")\n    Dim col As New ADOX.Column\n    col.Name = \"MyNewDecimalField\"\n    col.Type = adNumeric  ' note: not adDecimal\n    col.Precision = 18\n    col.NumericScale = 8\n    tbl.Columns.Append col\nEnd Sub\n</code></pre>\n\n<p>Or, we could just use a DDL query ...</p>\n\n<pre class=\"lang-vbs prettyprint-override\"><code>CurrentProject.Connection.Execute _\n        \"ALTER TABLE MyTable ADD COLUMN MyNewDecimalField DECIMAL(18,8)\"\n</code></pre>\n\n<p>... as Andre suggests in his answer.</p>\n"}], "owner": {"reputation": 599, "user_id": 1422252, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3a0754a5356995ba9b91a3cbf43f91c4?s=128&d=identicon&r=PG", "display_name": "PhillipOReilly", "link": "https://stackoverflow.com/users/1422252/philliporeilly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1093, "favorite_count": 0, "closed_date": 1469719276, "answer_count": 2, "score": 0, "last_activity_date": 1469828885, "creation_date": 1469641106, "last_edit_date": 1495542772, "question_id": 38619755, "link": "https://stackoverflow.com/questions/38619755/invalid-field-data-type-when-use-tabledef-createfield-method-vba", "closed_reason": "Duplicate", "title": "Invalid field Data type when use TableDef.CreateField Method VBA", "body": "<p>I am attempting to add a series of fields to a Access 2016 Table, but keep encountering the error:</p>\n\n<pre><code>Runtime error '3259'\nInvalid field data type\n</code></pre>\n\n<p>I originally specified the data type as dbNumeric but changed it to dbDecimal to see if that made a difference.  The solution given <a href=\"https://stackoverflow.com/questions/180929/how-do-i-create-a-decimal-field-in-access-with-alter-table\">here</a> for CreateFields did not solve my problem, though I did not try the SQL. It did not. Here is the code:</p>\n\n<pre><code>Sub BOD_Variables()\n\n    Dim myDBS\n    Dim myTable As TableDef\n    Dim myTableName As String\n\n    myTableName = \"BOD_Data\"\n    Set myDBS = CurrentDb\n    Set myTable = myDBS.TableDefs(myTableName)\n\n    Dim myField As Field\n    Dim myVariableNames As Variant\n\n    myVariableNames = Array(\"Blank_4_SampleVol\", ... \"BOD_ Concentration _OUT\")\n\n    Dim iCount As Integer\n\n    For iCount = LBound(myVariableNames) To UBound(myVariableNames)\n    Debug.Print myVariableNames(iCount)\n\n        Set myField = myTable.CreateField(myVariableNames(iCount), dbDecimal) 'Originally specified dbNumeric for data type.\n        myTable.Fields.Append myField\n    Next  \nEnd Sub\n</code></pre>\n\n<p>I attempted to replace the call to the Array(index) with: </p>\n\n<pre><code>        Set myField = myTable.CreateField(\"Blank_4_SampleVol\", dbNumeric)\n</code></pre>\n\n<p>Still get the same error.</p>\n\n<p>I tried specifying the length as <a href=\"https://stackoverflow.com/questions/27555771/when-creating-new-table-and-field-in-vba-access-2000-getting-error-data-type-co\">discussed here</a>, but that did not correct problem. Documentation on CreateField says it ignores field length when field type is dbNumberic.</p>\n\n<p>Any ideas of what I am missing? Thanks in advance. </p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1469650742, "post_id": 38619611, "comment_id": 64630472, "body": "Confused? When no selection is made, why would the combo box have a letter selected?"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1469651066, "post_id": 38619611, "comment_id": 64630661, "body": "I think i see now what you mean - yiu&#39;re trying ot set a fixed Filter property - not in VBA code of the cboOpeningType AfterUpdate event, correct?"}, {"owner": {"reputation": 111, "user_id": 6519837, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10209398473895833/picture?type=large", "display_name": "John Wolfenstein", "link": "https://stackoverflow.com/users/6519837/john-wolfenstein"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1469653690, "post_id": 38619611, "comment_id": 64631966, "body": "@dbmitch you are correct I am not setting a filter property in VBA.  I was trying to set the SQL inside the embedded query of the form using the combo box value.  I have three combo boxes and trying to filter three fields according to their value.  If I don&#39;t enter a value I want to return all records of that field.  The rowsource of the combo box gives a single letter selection as one of the values.  When that letter is selected all records that begin with that letter.  When nothing is in the combo box I get no results at all."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1469653936, "post_id": 38619611, "comment_id": 64632103, "body": "Still doesn&#39;t make sense with what you&#39;re showing above. You need at least one field in your form filter - you have none. And that has to change with each combo box apparently."}, {"owner": {"reputation": 111, "user_id": 6519837, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10209398473895833/picture?type=large", "display_name": "John Wolfenstein", "link": "https://stackoverflow.com/users/6519837/john-wolfenstein"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1469654081, "post_id": 38619611, "comment_id": 64632174, "body": "@ dbmitch I am using the build function from the query design."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1469654306, "post_id": 38619611, "comment_id": 64632298, "body": "Ahhhh - now it makes more sense - you&#39;re setting a query criteria in your recordsource not a form filter."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1469654556, "post_id": 38619611, "comment_id": 64632429, "body": "Updated answer using recordsource criteria &quot;filter&quot;"}, {"owner": {"reputation": 111, "user_id": 6519837, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10209398473895833/picture?type=large", "display_name": "John Wolfenstein", "link": "https://stackoverflow.com/users/6519837/john-wolfenstein"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1469654685, "post_id": 38619611, "comment_id": 64632493, "body": "@dbmitch yes.  I am still in an infant stage of Access.  I improperly used the term filter.  I am setting three query parameters that use the combo box values from a list.  If I don&#39;t put a value in the combo box I want all records for that filed.  I may want to solve this through VBA, but I thought it might get complex with three boxes."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1469655118, "post_id": 38619611, "comment_id": 64632695, "body": "Try my edited answer"}, {"owner": {"reputation": 111, "user_id": 6519837, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10209398473895833/picture?type=large", "display_name": "John Wolfenstein", "link": "https://stackoverflow.com/users/6519837/john-wolfenstein"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1469655621, "post_id": 38619611, "comment_id": 64632908, "body": "@dbmitch I used this code and it says &quot;The expression you entered has an invalid string.&quot;"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1469655806, "post_id": 38619611, "comment_id": 64633005, "body": "Yeah - the wrapping of double quotes isn&#39;t needed for query - just around the filter build - removed them from edited answer"}, {"owner": {"reputation": 111, "user_id": 6519837, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10209398473895833/picture?type=large", "display_name": "John Wolfenstein", "link": "https://stackoverflow.com/users/6519837/john-wolfenstein"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 1, "creation_date": 1469656048, "post_id": 38619611, "comment_id": 64633128, "body": "@dbmitch I found it as well.  It took me little while.  The &quot;filter&quot; works great.  Thanks for the time."}], "answers": [{"tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": true, "score": 1, "last_activity_date": 1469655751, "last_edit_date": 1469655751, "creation_date": 1469651861, "answer_id": 38622756, "question_id": 38619611, "link": "https://stackoverflow.com/questions/38619611/access-query-parameter-filtering-form/38622756#38622756", "title": "Access Query Parameter Filtering Form", "body": "<p><strong>EDIT remove double quotes</strong></p>\n\n<p>This should work - and you can do same thing with your other field/combobox searches</p>\n\n<pre><code>Like IIf([Forms]![sfrWorklistFilter]![cboOpeningType]&lt;&gt;\"\",[Forms]![sfrWorklistFilter]![cboOpeningType],\"*\")\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 6519837, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10209398473895833/picture?type=large", "display_name": "John Wolfenstein", "link": "https://stackoverflow.com/users/6519837/john-wolfenstein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 38622756, "answer_count": 1, "score": 1, "last_activity_date": 1594641654, "creation_date": 1469640524, "last_edit_date": 1594641654, "question_id": 38619611, "link": "https://stackoverflow.com/questions/38619611/access-query-parameter-filtering-form", "title": "Access Query Parameter Filtering Form", "body": "<p>I am filtering a form named sfrWorklistFilter from a combo box named cboOpeningType.  The recordsource is from an embedded query on the form. If I make a selection from the combo box the filter works fine with the following code:</p>\n\n<pre><code>Forms![sfrWorklistFilter]![cboOpeningType]\n</code></pre>\n\n<p>However I need to return all records when no selection is made in which case I use the following code:</p>\n\n<pre><code>Like Forms![sfrWorklistFilter]![cboOpeningType]  &amp; \"*\"\n</code></pre>\n\n<p>The filter then does not give exact matches, but all records that begin with the letter on the combo box.</p>\n\n<p>I need exact matches for the record or if no selection is made all records.</p>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1469641100, "creation_date": 1469641100, "answer_id": 38619754, "question_id": 38619145, "link": "https://stackoverflow.com/questions/38619145/ignoring-values-after-split-and-duplicating-only-part-of-a-cell-in-access-vba/38619754#38619754", "title": "Ignoring values after split and duplicating only part of a cell in Access VBA", "body": "<p>You need to test each element in the array from Split(): </p>\n\n<pre><code>Dim newVal\nIf varData(i) Like \"App: *\" Then\n    newVal = Replace(varData(i),\"App: \", \"\")\n    'add the new record using newVal\nEnd if\n</code></pre>\n"}], "owner": {"reputation": 4124, "user_id": 3183924, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e9d0e2a47aea15d63e369970b921cca?s=128&d=identicon&r=PG&f=1", "display_name": "Paradox", "link": "https://stackoverflow.com/users/3183924/paradox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 38619754, "answer_count": 1, "score": 1, "last_activity_date": 1594641658, "creation_date": 1469638877, "last_edit_date": 1594641658, "question_id": 38619145, "link": "https://stackoverflow.com/questions/38619145/ignoring-values-after-split-and-duplicating-only-part-of-a-cell-in-access-vba", "title": "Ignoring values after split and duplicating only part of a cell in Access VBA", "body": "<p>I am trying to create a new field that contains data from a pre-existing field which has been formatted.  If a cell in the existing field contains the following data (including newline characters):</p>\n\n<pre><code>\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n\u2551       ExistingField      \u2551\n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563\n\u2551 App: Some Name           \u2551\n\u2551 App: Another Name        \u2551\n\u2551 App: A Different Name    \u2551\n\u2551 Supplier: Supplier Name  \u2551\n\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n</code></pre>\n\n<p>Then the new field should look as follows:</p>\n\n<pre><code>\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n\u2551      ExistingField      \u2551 NewField         \u2551\n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563\n\u2551 App: Some Name          \u2551 Some Name        \u2551\n\u2551 App: Another Name       \u2551                  \u2551\n\u2551 App: A Different Name   \u2551                  \u2551\n\u2551 Supplier: Supplier Name \u2551                  \u2551\n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563\n\u2551 App: Some Name          \u2551 Another Name     \u2551\n\u2551 App: Another Name       \u2551                  \u2551\n\u2551 App: A Different Name   \u2551                  \u2551\n\u2551 Supplier: Supplier Name \u2551                  \u2551\n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563\n\u2551 App: Some Name          \u2551 A Different Name \u2551\n\u2551 App: Another Name       \u2551                  \u2551\n\u2551 App: Different Name     \u2551                  \u2551\n\u2551 Supplier: Supplier Name \u2551                  \u2551\n\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n</code></pre>\n\n<p>What this is doing is looking at each value after <code>App:</code> such as <code>Some Name</code>.  For each of those values existing in a cell, the record is duplicated and each value is stored in a new record in the <code>NewField</code> field.  This table has no primary key and there can be any number of <code>App:</code> and <code>Supplier:</code> combinations in a cell under the <code>ExistingField</code>.</p>\n\n<hr>\n\n<p>I have gotten to the point where my code will split a cell on newline and duplicate records, however it is not yet ignoring <code>Supplier:</code> and it is populating the <code>NewField</code> with the entire <code>App: Some Name</code> instead of only <code>Some Name</code>.  How could I achieve the intended result?</p>\n\n<p>Here is my code so far:</p>\n\n<pre><code>Public Sub CreateNameField(tableName As String)\n\n    Dim db As DAO.Database\n\n    Set db = CurrentDb\n\n    ' Create NewField field '\n    Dim strDdl As String\n    strDdl = \"ALTER TABLE [\" &amp; tableName &amp; \"] ADD COLUMN NewField TEXT(255);\"\n\n    Debug.Print strDdl\n    CurrentProject.Connection.Execute strDdl\n\n    ' Select all fields that have a ExistingField and are unprocessed (NewField is Null) '\n    strSQL = \"SELECT *, NewField \" &amp; _\n             \" FROM [\" &amp; tableName &amp; _\n             \"] WHERE ([ExistingField] Is Not Null) AND ([NewField] Is Null)\"\n\n    Set rsADD = db.OpenRecordset(tableName, dbOpenDynaset, dbAppendOnly)\n\n    Set rs = db.OpenRecordset(strSQL, dbOpenDynaset)\n\n    With rs\n        While Not .EOF\n\n            ' Split field on newline '\n            varData = Split(rs![ExistingField], vbCrLf)\n\n            ' Update First Record '\n            ' Ensure that varData contains at least one value '\n            If UBound(varData) &gt; -1 Then\n                .Edit\n                !NewField = Trim(varData(0)) ' Remove spaces before writing new fields '\n                .Update\n            End If\n\n            ' Add records with same first field '\n            ' and new fields for remaining data at end of string '\n            For i = 1 To UBound(varData)\n                rsADD.AddNew\n                For Each fld In rsADD.Fields\n                    If fld.Name &lt;&gt; \"NewField\" Then\n                        ' Copy all fields except \"NewField\" '\n                        rsADD(fld.Name) = rs(fld.Name)\n                    End If\n                Next fld\n                ' NewField is set separately '\n                rsADD!NewField = Trim(varData(i)) ' Remove spaces before writing new fields '\n                rsADD.Update\n            Next i\n\n            .MoveNext\n        Wend\n\n        .Close\n        rsADD.Close\n\n    End With\n\n    Set rsADD = Nothing\n    Set rs = Nothing\n    db.Close\n    Set db = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "listbox", "default", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1469637168, "post_id": 38618570, "comment_id": 64622995, "body": "Each item in a <code>ListBox.Items</code> has a <code>.Selected</code> property (boolean)."}, {"owner": {"reputation": 691, "user_id": 3138025, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/TSLrq.jpg?s=128&g=1", "display_name": "user3138025", "link": "https://stackoverflow.com/users/3138025/user3138025"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1469639351, "post_id": 38618570, "comment_id": 64624185, "body": "Hi @DavidZemens,  Thanks for the reply.  How would I go about &quot;selecting&quot; a row in the ListBoxLit where I know the values of the three elements?  Something like ListBoxLit.selected = ......"}], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 1, "last_activity_date": 1469640213, "creation_date": 1469640213, "answer_id": 38619524, "question_id": 38618570, "link": "https://stackoverflow.com/questions/38618570/defaulting-to-a-particular-row-in-an-excel-listbox/38619524#38619524", "title": "Defaulting to a particular row in an Excel listbox", "body": "<p>The <code>Selected</code> method of the <code>MSForms.ListBox</code> class takes a single argument <em>index</em> which is the position within the list. </p>\n\n<pre><code>Sub SelectItemInListBox(val$, lBox as MSForms.ListBox)\n    Dim i as Long\n    For i = 0 to lBox.ListCount - 1\n        If LBox.List(i) = val Then LBox.Selected(i) = True\n    Next\nEnd Sub\n</code></pre>\n\n<p>You can call a function like this, and pass the <em>value</em> you want to select, and the listbox object itself, e.g.:</p>\n\n<pre><code>Call SelectItemInListBox(\"some value\", ListBoxLit)\n</code></pre>\n\n<p>If you have three values you can just call this function three times.</p>\n"}], "owner": {"reputation": 691, "user_id": 3138025, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/TSLrq.jpg?s=128&g=1", "display_name": "user3138025", "link": "https://stackoverflow.com/users/3138025/user3138025"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 589, "favorite_count": 0, "accepted_answer_id": 38619524, "answer_count": 1, "score": 1, "last_activity_date": 1469640213, "creation_date": 1469637000, "last_edit_date": 1531164843, "question_id": 38618570, "link": "https://stackoverflow.com/questions/38618570/defaulting-to-a-particular-row-in-an-excel-listbox", "title": "Defaulting to a particular row in an Excel listbox", "body": "<p>I have a working macro that needs an enhancement.  Part of the Macro populates a listbox in an Excel UserForm.  The code is below:</p>\n\n<pre><code>Dim objExcelApp             As Object\nDim objExcelWorkBook        As Object\nDim objExcelWorksheet       As Object\nDim varTest                 As Variant\n\nlngLastLitRow = objExcelApp.Sheets(1).UsedRange.Rows.Count\nDim strArray() As Variant\nReDim strArray(lngFilteredRowCount - 1, 2)\n\n'Load strArray\nWith objExcelWorkBook.Sheets(1)\n    'The ListBox dimention starts with (0), so set lngListBoxRow\n    lngListBoxRow = 0\n\n    'Loop through all the rows in rngLiturgies\n    For Each rngCurrentLitRow In rngLiturgies.Rows\n        'Populate lngExcelRow\n        lngExcelRow = rngCurrentLitRow.Row\n        'Select only the rows that are NOT filtered\n        If rngCurrentLitRow.EntireRow.Hidden = False Then\n\n        'Fill the array row (lngListBoxRow) with Excel data (lngExcelRow)\n        'The Array's column 0 equates to Excel's column 1\n        strArray(lngListBoxRow, 0) = objExcelWorkBook.Sheets(1).Cells(lngExcelRow, 1)\n        strArray(lngListBoxRow, 1) = objExcelWorkBook.Sheets(1).Cells(lngExcelRow, 2)\n        strArray(lngListBoxRow, 2) = objExcelWorkBook.Sheets(1).Cells(lngExcelRow, 3)\n\n        'Increment lngListBoxRow \"manually\" since it doesn't correspond to\n        'the Excel row in the FOR loop\n        lngListBoxRow = lngListBoxRow + 1\n\n        Else\n        End If\n\n    Next rngCurrentLitRow\n\nEnd With\n\n'Load ListBoxLit with strArray\nWith ListBoxLit\n    .ColumnCount = 3\n    .List = strArray\nEnd With\n</code></pre>\n\n<p>As an enhancement, I'd like to default the row in the listbox whenever a value in another form field changes.  Based on that field change, I'll know the value of three variables that correspond to the elements in the array.  How do I select the row in the listbox, when I have those three values available?\nThanks for looking at this.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51, "user_id": 6464971, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10205342851604737/picture?type=large", "display_name": "Thomas Breakell", "link": "https://stackoverflow.com/users/6464971/thomas-breakell"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1469636871, "post_id": 38618417, "comment_id": 64622808, "body": "Yes, my workbook contains many worksheets. I thought this loop would go through each worksheet but it only affects the active one."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1469636880, "post_id": 38618417, "comment_id": 64622820, "body": "<code>If Application.CountA(ws.Range(&quot;1:5&quot;) = 0 Then ws.Range(&quot;1:5&quot;).EntireRow.Delete</code> - delete rows"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1469639528, "post_id": 38618417, "comment_id": 64624286, "body": "What if there is a single value in the fourth row but no values in rows 1, 2, 3 and 5?"}, {"owner": {"reputation": 51, "user_id": 6464971, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10205342851604737/picture?type=large", "display_name": "Thomas Breakell", "link": "https://stackoverflow.com/users/6464971/thomas-breakell"}, "edited": false, "score": 0, "creation_date": 1469726761, "post_id": 38618417, "comment_id": 64669087, "body": "It shouldn&#39;t delete it if it contains values in rows 1 to 5, as it checks that whole range. I would test it if you are unsure but it seemed to work fine for me."}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 6464971, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10205342851604737/picture?type=large", "display_name": "Thomas Breakell", "link": "https://stackoverflow.com/users/6464971/thomas-breakell"}, "is_accepted": false, "score": 0, "last_activity_date": 1469637294, "creation_date": 1469637294, "answer_id": 38618659, "question_id": 38618417, "link": "https://stackoverflow.com/questions/38618417/delete-first-5-rows-of-each-worksheet-in-a-workbook-if-they-contain-no-values/38618659#38618659", "title": "Delete first 5 rows of each worksheet in a workbook if they contain no values", "body": "<p>This is the updated code, worked perfectly. Thank you all.</p>\n\n<pre><code>Sub DeleteFirst5Rows()\n    Dim ws As Worksheet\n    For Each ws In ActiveWorkbook.Worksheets\n    If Application.CountA(ws.Range(\"1:5\")) = 0 Then ws.Range(\"1:5\").EntireRow.Delete\n\n    Next ws\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 6464971, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10205342851604737/picture?type=large", "display_name": "Thomas Breakell", "link": "https://stackoverflow.com/users/6464971/thomas-breakell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 257, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1469637294, "creation_date": 1469636488, "question_id": 38618417, "link": "https://stackoverflow.com/questions/38618417/delete-first-5-rows-of-each-worksheet-in-a-workbook-if-they-contain-no-values", "title": "Delete first 5 rows of each worksheet in a workbook if they contain no values", "body": "<p>I am trying to delete all the first 5 rows of each worksheet if they do not contain any values across all columns. This program will run but only on the active worksheet. Is there something I missed?</p>\n\n<pre><code>Sub DeleteFirst5Rows()\nDim ws As Worksheet\n For Each ws In ActiveWorkbook.Worksheets\n    On Error Resume Next\n    Rows(\"1:5\").SpecialCells(xlCellTypeBlanks).EntireRow.Delete\n Next ws\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13, "user_id": 6645561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbb96999e3d91065a6ca85d03af6705c?s=128&d=identicon&r=PG&f=1", "display_name": "RAMES", "link": "https://stackoverflow.com/users/6645561/rames"}, "edited": false, "score": 0, "creation_date": 1469641943, "post_id": 38618133, "comment_id": 64625674, "body": "Thank you for cleaning up my mess Tim"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6645561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbb96999e3d91065a6ca85d03af6705c?s=128&d=identicon&r=PG&f=1", "display_name": "RAMES", "link": "https://stackoverflow.com/users/6645561/rames"}, "edited": false, "score": 0, "creation_date": 1469641901, "post_id": 38618740, "comment_id": 64625649, "body": "OUTSTANDING! Thank you! 98% closer than what I could find! Although I&#39;m still getting one blank page at the end even when I select three check boxes, the 3 sheets print but followed by one blank page"}], "tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": true, "score": 0, "last_activity_date": 1469637559, "creation_date": 1469637559, "answer_id": 38618740, "question_id": 38618133, "link": "https://stackoverflow.com/questions/38618133/display-all-worksheets-in-list-checkbox-and-multi-print-worksheet/38618740#38618740", "title": "Display all worksheets in list checkbox and multi print worksheet", "body": "<p>I think your interpretation of <code>SelectedSheets</code> is causing the problem. By iterating through worksheets and selecting specified worksheets does not add those worksheets to the <code>SelectedSheets</code> collection. The simplest way would be to print sheet by sheet on each iteration of the loop.</p>\n\n<p>So this part of your code would become:</p>\n\n<pre><code>        For Each cb In PrintDlg.CheckBoxes\n            If cb.Value = xlOn Then\n                Worksheets(cb.Caption).PrintOut copies:=1\n            End If\n        Next cb\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6645561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbb96999e3d91065a6ca85d03af6705c?s=128&d=identicon&r=PG&f=1", "display_name": "RAMES", "link": "https://stackoverflow.com/users/6645561/rames"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 38618740, "answer_count": 1, "score": 1, "last_activity_date": 1469637559, "creation_date": 1469635563, "last_edit_date": 1531161705, "question_id": 38618133, "link": "https://stackoverflow.com/questions/38618133/display-all-worksheets-in-list-checkbox-and-multi-print-worksheet", "title": "Display all worksheets in list checkbox and multi print worksheet", "body": "<p>I have an excel spreadsheet with multiple sheets and would like to be able to click a \"print\" button which in turn opens a dialog where I can check mark multiple sheets and click \"ok\" which will print the selected sheets. I've been looking thru the site and found similar cases but nothing exactly like this question.  Currently my code will only print one blank page: </p>\n\n<pre><code>Option Explicit\n\nSub SelectSheets()\n    Dim i As Integer\n    Dim TopPos As Integer\n    Dim SheetCount As Integer\n    Dim PrintDlg As DialogSheet\n    Dim CurrentSheet As Worksheet\n    Dim cb As CheckBox\n    Application.ScreenUpdating = False\n\n'   Check for protected workbook\n    If ActiveWorkbook.ProtectStructure Then\n        MsgBox \"Workbook is protected.\", vbCritical\n        Exit Sub\n    End If\n\n'   Add a temporary dialog sheet\n    Set CurrentSheet = ActiveSheet\n    Set PrintDlg = ActiveWorkbook.DialogSheets.Add\n\n    SheetCount = 0\n\n'   Add the checkboxes\n\n    TopPos = 40\n    For i = 1 To ActiveWorkbook.Worksheets.Count\n        Set CurrentSheet = ActiveWorkbook.Worksheets(i)\n'       Skip empty sheets and hidden sheets\n        If Application.CountA(CurrentSheet.Cells) &lt;&gt; 0 And _\n            CurrentSheet.Visible Then\n            SheetCount = SheetCount + 1\n            PrintDlg.CheckBoxes.Add 78, TopPos, 150, 16.5\n                PrintDlg.CheckBoxes(SheetCount).Text = _\n                    CurrentSheet.Name\n            TopPos = TopPos + 13\n        End If\n    Next i\n\n'   Move the OK and Cancel buttons\n    PrintDlg.Buttons.Left = 240\n\n'   Set dialog height, width, and caption\n    With PrintDlg.DialogFrame\n        .Height = Application.Max _\n            (68, PrintDlg.DialogFrame.Top + TopPos - 34)\n        .Width = 230\n        .Caption = \"Select sheets to print\"\n\n    End With\n\n'   Change tab order of OK and Cancel buttons\n'   so the 1st option button will have the focus\n    PrintDlg.Buttons(\"Button 2\").BringToFront\n    PrintDlg.Buttons(\"Button 3\").BringToFront\n\n'   Display the dialog box\n    CurrentSheet.Activate\n    Application.ScreenUpdating = True\n    If SheetCount &lt;&gt; 0 Then\n        If PrintDlg.Show Then\n            For Each cb In PrintDlg.CheckBoxes\n                If cb.Value = xlOn Then\n                    Worksheets(cb.Caption).Select Replace:=False\n                End If\n            Next cb\n            ActiveWindow.SelectedSheets.PrintOut copies:=1\n            ActiveSheet.Select\n\n        End If\n    Else\n        MsgBox \"All worksheets are empty.\"\n    End If\n\n'   Delete temporary dialog sheet (without a warning)\n    Application.DisplayAlerts = False\n    PrintDlg.Delete\n\n'   Reactivate original sheet\n    CurrentSheet.Activate\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "windows-7-x64", "excel-2016", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 3, "creation_date": 1469635064, "post_id": 38617814, "comment_id": 64621711, "body": "Press Enter where? Worksheet? Userform? A little more details will help :)"}, {"owner": {"reputation": 32943, "user_id": 765226, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/b0Qnm.jpg?s=128&g=1", "display_name": "Alexis Olson", "link": "https://stackoverflow.com/users/765226/alexis-olson"}, "edited": false, "score": 0, "creation_date": 1469635150, "post_id": 38617814, "comment_id": 64621762, "body": "Does this help?  <a href=\"http://stackoverflow.com/questions/11153995/is-there-any-event-that-fires-when-keys-are-pressed-when-editing-a-cell\" title=\"is there any event that fires when keys are pressed when editing a cell\">stackoverflow.com/questions/11153995/&hellip;</a>"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1469635274, "post_id": 38617814, "comment_id": 64621842, "body": "Or <a href=\"http://stackoverflow.com/questions/21453681/can-i-capture-and-emulate-a-keydown-event-in-excel-vba\">this</a> ... an old @SiddharthRout answer."}, {"owner": {"reputation": 14758, "user_id": 654789, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/44ca44bc65f36895abb2ad8f577139e7?s=128&d=identicon&r=PG", "display_name": "puk", "link": "https://stackoverflow.com/users/654789/puk"}, "reply_to_user": {"reputation": 32943, "user_id": 765226, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/b0Qnm.jpg?s=128&g=1", "display_name": "Alexis Olson", "link": "https://stackoverflow.com/users/765226/alexis-olson"}, "edited": false, "score": 0, "creation_date": 1469635422, "post_id": 38617814, "comment_id": 64621931, "body": "@AlexisOlson I saw that, but it is 32 bit and causes a compilation error. Simply changing the 32&#39;s to 64&#39;s does not fix the problem"}, {"owner": {"reputation": 14758, "user_id": 654789, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/44ca44bc65f36895abb2ad8f577139e7?s=128&d=identicon&r=PG", "display_name": "puk", "link": "https://stackoverflow.com/users/654789/puk"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1469635607, "post_id": 38617814, "comment_id": 64622047, "body": "@ScottHoltzman I copied it over into the workbook and module locations respectively, but it is complaining about the user32. How do I get around that?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1469636168, "post_id": 38617814, "comment_id": 64622415, "body": "<a href=\"http://www.jkp-ads.com/articles/apideclarations.asp\" rel=\"nofollow noreferrer\">jkp-ads.com/articles/apideclarations.asp</a>"}], "answers": [{"comments": [{"owner": {"reputation": 14758, "user_id": 654789, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/44ca44bc65f36895abb2ad8f577139e7?s=128&d=identicon&r=PG", "display_name": "puk", "link": "https://stackoverflow.com/users/654789/puk"}, "edited": false, "score": 0, "creation_date": 1469635760, "post_id": 38618151, "comment_id": 64622135, "body": "I tried that but it doesn&#39;t work. I will copy paste exactly what I have into my question."}, {"owner": {"reputation": 14758, "user_id": 654789, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/44ca44bc65f36895abb2ad8f577139e7?s=128&d=identicon&r=PG", "display_name": "puk", "link": "https://stackoverflow.com/users/654789/puk"}, "edited": false, "score": 0, "creation_date": 1469636043, "post_id": 38618151, "comment_id": 64622327, "body": "OK some progress...when I put it in <code>ThisWorkbook</code>, it generates a run time error which reads &quot;cannot run the macro ... the macro may not be available in this workbook or all macros may be disabled&quot;"}, {"owner": {"reputation": 7418, "user_id": 2983632, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IvTM4.png?s=128&g=1", "display_name": "ttaaoossuu", "link": "https://stackoverflow.com/users/2983632/ttaaoossuu"}, "reply_to_user": {"reputation": 14758, "user_id": 654789, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/44ca44bc65f36895abb2ad8f577139e7?s=128&d=identicon&r=PG", "display_name": "puk", "link": "https://stackoverflow.com/users/654789/puk"}, "edited": false, "score": 0, "creation_date": 1469636220, "post_id": 38618151, "comment_id": 64622433, "body": "Check if the Sub you subscribe to is actually the one (i.e. <code>SomeActions</code>). Also it must be in a module, not in worksheet code (see edit)."}], "tags": [], "owner": {"reputation": 7418, "user_id": 2983632, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IvTM4.png?s=128&g=1", "display_name": "ttaaoossuu", "link": "https://stackoverflow.com/users/2983632/ttaaoossuu"}, "is_accepted": true, "score": 2, "last_activity_date": 1469636250, "last_edit_date": 1469636250, "creation_date": 1469635619, "answer_id": 38618151, "question_id": 38617814, "link": "https://stackoverflow.com/questions/38617814/how-to-call-a-function-on-enter-key-in-excel-using-vba/38618151#38618151", "title": "How to call a function on ENTER key in Excel using vba", "body": "<p>First, make an callback <code>Sub</code> that performs the logic you need. Put it into a new code module (NOT into worksheet code):</p>\n\n<pre><code>Sub SomeActions()\n...\nEnd Sub\n</code></pre>\n\n<p>Then, subscribe to <code>OnKey</code> event, for example, when the user opens the workbook (this code goes into <code>ThisWorkbook</code>) module in VBA editor:</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Application.OnKey \"~\", \"SomeActions\"\nEnd Sub\n</code></pre>\n\n<p><code>\"~\"</code> means <kbd>Enter</kbd> key. For numeric keypad key use <code>\"{ENTER}\"</code>.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1469636567, "creation_date": 1469636567, "answer_id": 38618436, "question_id": 38617814, "link": "https://stackoverflow.com/questions/38617814/how-to-call-a-function-on-enter-key-in-excel-using-vba/38618436#38618436", "title": "How to call a function on ENTER key in Excel using vba", "body": "<blockquote>\n  <p><sup>What I want: Everytime the user presses, and then releases, the ENTER key, for my program to do do something (ie. create a MsgBox, or call function Foo).</sup><br/><sub> I would prefer this in the form of a MWE</sub></p>\n</blockquote>\n\n<p>If I read this correctly, you want a blank row between every user inputted value doing down and a blank column between every user inputted value going right.</p>\n\n<p>On the worksheet code sheet:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Target.Count &gt; 1 Then Exit Sub\n    Application.EnableEvents = False\n    Dim r As Long, c As Long\n    If Target.Row / 2 &lt;&gt; Int(Target.Row / 2) Then r = 1\n    If Target.Column / 2 &lt;&gt; Int(Target.Column / 2) Then c = 1\n    Target.Offset(r, c).Activate\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>This occurs for all navigation. If you only want this to occur on input, modify to suit a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839775.aspx\" rel=\"nofollow\">Worksheet_Change</a> event macro instead of a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194470.aspx\" rel=\"nofollow\">Worksheet_SelectionChange</a> event macro.</p>\n"}], "owner": {"reputation": 14758, "user_id": 654789, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/44ca44bc65f36895abb2ad8f577139e7?s=128&d=identicon&r=PG", "display_name": "puk", "link": "https://stackoverflow.com/users/654789/puk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10960, "favorite_count": 3, "accepted_answer_id": 38618151, "answer_count": 2, "score": 2, "last_activity_date": 1469636567, "creation_date": 1469634664, "last_edit_date": 1531161705, "question_id": 38617814, "link": "https://stackoverflow.com/questions/38617814/how-to-call-a-function-on-enter-key-in-excel-using-vba", "title": "How to call a function on ENTER key in Excel using vba", "body": "<p>Google should provide me with ample examples but none of them seem to work</p>\n\n<p><strong>What I want:</strong> Everytime the user presses, and then releases, the ENTER key, for my program to do do something (ie. create a MsgBox, or call function Foo). I would prefer this in the form of a MWE</p>\n\n<p><strong>What I have done:</strong> I have tried <em>googling it</em> but none of the examples are functional. They compile, but don't do anything. I have also made sure to save in a macro compatible Excel format.</p>\n\n<p><strong>What I am using:</strong> I am using Excel 2016, 64 bit with Office 365</p>\n\n<p><strong>EDIT:</strong> The user is entering this information into the worksheet. I want to intercept the user input and everytime they press ENTER, take the cursor/active cell down two rows, so there is an empty cell below every cell. If the user presses tab, I want to take the cursor/active cell right two columns, so there si an empty cell to the right of every cell.</p>\n\n<p><strong>EDIT 2:</strong> here is a MWE of what I have right now which should work, but which does nothing. I am adding this to the worksheet, and not as a module</p>\n\n<pre><code>Sub SomeActions()\n    MsgBox (\"Hello\")\nEnd Sub\n\nPrivate Sub Workbook_Open()\n    Application.OnKey \"~\", \"SomeActions\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1469635560, "post_id": 38617668, "comment_id": 64622023, "body": "If you do a <code>debug.print Element.InnerHtml</code> does the date show up in the immediate window as part of the entire InnerHtml? If so, use <code>Mid \\ Left \\ Right, etc.</code> to parse date out of string."}, {"owner": {"reputation": 205, "user_id": 3323922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d8bc71a162eb74603e49f3f626132cfb?s=128&d=identicon&r=PG&f=1", "display_name": "user3323922", "link": "https://stackoverflow.com/users/3323922/user3323922"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1469635672, "post_id": 38617668, "comment_id": 64622081, "body": "Unfortunately it is not picking up that phrase at all. I can see other phrases that falls with the td tag, but not this."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1469636570, "post_id": 38617668, "comment_id": 64622631, "body": "perhaps a debug.pring on all the <code>element2.innerhtml</code> will reveal the right one and you can then build a way to strip it out. Sometimes this is the only way i&#39;ve found things in debugging website scraping."}, {"owner": {"reputation": 205, "user_id": 3323922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d8bc71a162eb74603e49f3f626132cfb?s=128&d=identicon&r=PG&f=1", "display_name": "user3323922", "link": "https://stackoverflow.com/users/3323922/user3323922"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1469638604, "post_id": 38617668, "comment_id": 64623743, "body": "debug.print element2. has only the following options (items, length, tag, string)"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1469638744, "post_id": 38617668, "comment_id": 64623853, "body": "sorry, unfortunately, do to security restrictions where I am, I cannot scrape IE with VBA. Otherwise, I&#39;d dig in more."}], "answers": [{"comments": [{"owner": {"reputation": 205, "user_id": 3323922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d8bc71a162eb74603e49f3f626132cfb?s=128&d=identicon&r=PG&f=1", "display_name": "user3323922", "link": "https://stackoverflow.com/users/3323922/user3323922"}, "edited": false, "score": 0, "creation_date": 1469705904, "post_id": 38624662, "comment_id": 64653516, "body": "Thank You barrow. Made the changes as per to your instruction and made my code to work. Thanks a lot."}], "tags": [], "owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "is_accepted": true, "score": 0, "last_activity_date": 1469661200, "creation_date": 1469661200, "answer_id": 38624662, "question_id": 38617668, "link": "https://stackoverflow.com/questions/38617668/find-a-string-in-dom-explorer-using-vba/38624662#38624662", "title": "find a string in DOM explorer using VBA", "body": "<p>The innerHtml property picks up the content within a tag but does not pick up the tag itself. The outerHTML property includes the tag itself as well as the tag's content.</p>\n\n<p>Example:</p>\n\n<p>HTML <code>&lt;p class=\"fee fie foe fum\"&gt;bar &lt;b&gt;bat&lt;/b&gt; &lt;i&gt;cat&lt;/i&gt; car&lt;/p&gt;</code></p>\n\n<ul>\n<li>innerHTML <code>bar &lt;B&gt;bat&lt;/B&gt; &lt;I&gt;cat&lt;/I&gt; car</code></li>\n<li>outerHTML <code>&lt;P class=\"fee fie foe fum\"&gt;bar &lt;B&gt;bat&lt;/B&gt; &lt;I&gt;cat&lt;/I&gt; car&lt;/P&gt;</code></li>\n</ul>\n\n<p>To perform a text match on an attribute value of an element, you would need to look at the outerHTML property of the element and not the innerHTML property.</p>\n\n<p>However, the class attribute of an element can be accessed via the className property so you could replace the InStr on innerHTML with this:</p>\n\n<pre><code>If InStr(1, Element.className, \"value-field align-top\") Then\n</code></pre>\n\n<p>This is not ideal because it would be perfectly valid to write the class names in a different order - e.g. <code>class=\"align-top value-field\"</code> - and this would not be picked up by the InStr function.</p>\n\n<p>It would be better to start with getElementsByClassName (which doesn't care about which order the class names are in) and then use the tagName property to check we have the correct tag, like this:</p>\n\n<pre><code>Set Elements2 = Doc.getElementsByClassName(\"value-field align-top\")\n\n' code for the loops on Elements and Elements1 goes here\n\nFor Each Element In Elements2\n    If Element.tagName = \"td\" Then\n</code></pre>\n\n<p>Finally, <code>Element.getAttribute(\"value\")</code> will return Null unless the element has a named attribute called \"value\". To get the text value of the element, use this instead:</p>\n\n<pre><code>Requestdate = Element.innerText\n</code></pre>\n"}], "owner": {"reputation": 205, "user_id": 3323922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d8bc71a162eb74603e49f3f626132cfb?s=128&d=identicon&r=PG&f=1", "display_name": "user3323922", "link": "https://stackoverflow.com/users/3323922/user3323922"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 824, "favorite_count": 0, "accepted_answer_id": 38624662, "answer_count": 1, "score": 0, "last_activity_date": 1469661200, "creation_date": 1469634188, "last_edit_date": 1531164843, "question_id": 38617668, "link": "https://stackoverflow.com/questions/38617668/find-a-string-in-dom-explorer-using-vba", "title": "find a string in DOM explorer using VBA", "body": "<p>I need to find the string in the attached picture using a vba in excel. I have the code below, but it is not finding the date that I am looking for.\nThe for loop to find is at the last \"For Each Element In Elements2\"</p>\n\n<pre><code>Dim Doc As HTMLDocument\nDim Elements As IHTMLElementCollection\nDim elements1 As IHTMLElementCollection\nDim Elements2 As IHTMLElementCollection\n\nDim iCnt As Integer\nDim Element As IHTMLElement\nDim appIE As InternetExplorerMedium\n\nSheets(1).Cells(1, 1).Value = \"\"\ncomplete = 0\n\nSet appIE = New InternetExplorerMedium\nsURL = \"https://example.com\"\n\nWith appIE\n  .Navigate sURL\n  .Visible = True\n\n    Do While appIE.Busy Or appIE.ReadyState &lt;&gt; 4\n         DoEvents\n    Loop\n\n   Do While complete &lt;&gt; 1\n\n        Set Doc = appIE.Document\n        Set Elements = Doc.GetElementsByTagName(\"input\")\n        Set elements1 = Doc.GetElementsByTagName(\"strong\")\n        Set Elements2 = Doc.GetElementsByTagName(\"td\")\n\n\n            For Each Element In Elements\n                If Element.ID = \"form-id\" Then\n                    requestnumber = Element.GetAttribute(\"Value\")\n                End If\n\n                If Element.ID = \"remedy-case-info\" Then\n                   CaseInfo = Element.GetAttribute(\"Value\")\n                End If\n            Next Element\n\n\n\n            For Each Element In elements1\n\n            If InStr(1, Element.InnerHtml, \"EM\") Then\n\n                For iCnt = 1 To Len(Element.InnerText)\n                    If IsNumeric(Left(Element.InnerText, 2)) Then\n                      NumericOnly (Element.InnerText)\n                    End If\n                Next iCnt\n            End If\n            Next Element\n            AClientCount = tempcount\n\n\n\n            For Each Element In Elements2\n\n            '  If InStr(1, Element.InnerHtml, \"td\") Then\n                    If InStr(1, Element.InnerHtml, \"value-field align-top\") Then\n                            Requestdate = Element.GetAttribute(\"Value\")\n                    End If\n            ' End If\n\n            Next Element\n            Set Elements = Nothing\n\n       If requestnumber &lt;&gt; \"\" Then\n          Sheets(1).Cells(1, 1).Value = requestnumber &amp; \" - \" &amp; CaseInfo &amp; \" - \" &amp; tempcount &amp; \" - \" &amp; Requestdate\n          complete = 1\n      End If\n Loop\n.Quit\n\nEnd With\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/O37QU.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/O37QU.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 2, "creation_date": 1469633832, "post_id": 38617426, "comment_id": 64620858, "body": "Sorry, but I think you have to elaborate this, especially your code, a bit further. It&#39;s pretty unclear (to me at least)."}, {"owner": {"reputation": 32943, "user_id": 765226, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/b0Qnm.jpg?s=128&g=1", "display_name": "Alexis Olson", "link": "https://stackoverflow.com/users/765226/alexis-olson"}, "edited": false, "score": 0, "creation_date": 1469633954, "post_id": 38617426, "comment_id": 64620950, "body": "I agree with Tom. I can&#39;t understand what you are after. What do you have 60 of to loop?"}, {"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1469634018, "post_id": 38617426, "comment_id": 64621000, "body": "Ah, I think I understand now. There are 60 checkboxes with different names and depending which of these are checked, you want to append <code>a</code> with <code>&quot;Header X, &quot;</code>. And now you need a loop, to loop through all checkboxes, right?"}], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 6591314, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-B-xmgnOb1lk/AAAAAAAAAAI/AAAAAAABoAs/2xMjGWKMGP4/photo.jpg?sz=128", "display_name": "Lawrence Ferguson", "link": "https://stackoverflow.com/users/6591314/lawrence-ferguson"}, "edited": false, "score": 0, "creation_date": 1469635878, "post_id": 38617846, "comment_id": 64622212, "body": "Hi yes I think your onto what I&#39;m trying to do however, I wasn&#39;t super clear about it! Instead of header 1,2,3,n etc that was just an example. Each header is more like: BLBINL,BLBCOD,BLWARC...basically headers from an SQL table.  But yes I did plan to have them in logical order so selectSite would be first on list and the corressponding header &quot;BLBCOD&quot; would be first in 2nd list."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 145, "user_id": 6591314, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-B-xmgnOb1lk/AAAAAAAAAAI/AAAAAAABoAs/2xMjGWKMGP4/photo.jpg?sz=128", "display_name": "Lawrence Ferguson", "link": "https://stackoverflow.com/users/6591314/lawrence-ferguson"}, "edited": false, "score": 0, "creation_date": 1469636135, "post_id": 38617846, "comment_id": 64622391, "body": "If you don&#39;t provide an example that is representative ofyour actual problem, then you&#39;re going to get answers like this one, which perfectly solve the problem as-stated, but do not solve your actual problem. IF you need to implement mapping, then use <a href=\"http://stackoverflow.com/a/38617888/1467082\">the other answer</a>."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 145, "user_id": 6591314, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-B-xmgnOb1lk/AAAAAAAAAAI/AAAAAAABoAs/2xMjGWKMGP4/photo.jpg?sz=128", "display_name": "Lawrence Ferguson", "link": "https://stackoverflow.com/users/6591314/lawrence-ferguson"}, "edited": false, "score": 0, "creation_date": 1469636158, "post_id": 38617846, "comment_id": 64622407, "body": "Alternatively you can read the headers from SQL in to an array, and index that instead of hard-coding the <code>&quot;Header &quot; &amp; ...</code> string."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 1, "last_activity_date": 1469635075, "last_edit_date": 1495535244, "creation_date": 1469634765, "answer_id": 38617846, "question_id": 38617426, "link": "https://stackoverflow.com/questions/38617426/loop-through-checkboxes-on-a-sheet/38617846#38617846", "title": "Loop through checkboxes on a sheet", "body": "<p>This should handle ActiveX checkboxes.</p>\n\n<p><strong>NOTE:</strong> This requires your checkboxes are indexed correctly (i.e., the <em>first</em> one by index will correspond to \"Header 1\", the second with \"Header 2\", the <em>n</em>th with \"Header <em>n</em>\", etc...). If they are out of order, you'd need additional logic to control for that (see <a href=\"https://stackoverflow.com/a/38617888/1467082\">the other answer for a good solution</a> if that is the case).</p>\n\n<pre><code>Option Explicit\nSub LoopActiveXCheckBoxes()\n\nDim ws As Worksheet\nDim obj As OLEObject\nDim cb As CheckBox\nDim i As Long\nDim a As String\n\nSet ws = Sheets(\"controlSheet\")\nFor Each obj In ws.OLEObjects\n    If TypeName(obj.Object) = \"CheckBox\" Then\n        i = i + 1\n        If obj.Object.Value = True Then\n            a = a &amp; \"Header \" &amp; CStr(i) &amp; \",\"\n        End If\n    End If\nNext\nIf Len(a) &gt; 0 Then a = Left(a, Len(a) - 1)\n\nEnd Sub\n</code></pre>\n\n<p>For Form Control checkboxes, this would work but I'm pretty sure you're using ActiveX.</p>\n\n<pre><code>Sub LoopCheckBoxes()\n\nDim ws As Worksheet\nDim cb As CheckBox\nDim i As Long\nDim a As String\n\nSet ws = Sheets(\"controlSheet\")\nFor Each cb In ws.CheckBoxes\n    i = i + 1\n    If cb.Value = 1 Then\n        a = a &amp; \"Header \" &amp; CStr(i) &amp; \",\"\n    End If\nNext\nIf Len(a) &gt; 0 Then a = Left(a, Len(a) - 1)\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 145, "user_id": 6591314, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-B-xmgnOb1lk/AAAAAAAAAAI/AAAAAAABoAs/2xMjGWKMGP4/photo.jpg?sz=128", "display_name": "Lawrence Ferguson", "link": "https://stackoverflow.com/users/6591314/lawrence-ferguson"}, "edited": false, "score": 0, "creation_date": 1469636478, "post_id": 38617888, "comment_id": 64622584, "body": "this works perfect! thank you. in the future, Ill look to pulling them straight from SQL table, but i&#39;m new to it so one step at a time!  thanks again!"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 145, "user_id": 6591314, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-B-xmgnOb1lk/AAAAAAAAAAI/AAAAAAABoAs/2xMjGWKMGP4/photo.jpg?sz=128", "display_name": "Lawrence Ferguson", "link": "https://stackoverflow.com/users/6591314/lawrence-ferguson"}, "edited": false, "score": 0, "creation_date": 1469640175, "post_id": 38617888, "comment_id": 64624653, "body": "@LawrenceFerguson Glad I could help. Please mark the question as answered so other users know that it is closed.     You can chain solutions together. You can populate the dictionary object with key/value pairs that are pulled from a SQL table. This allows for a more dynamic solution where adding a new checkbox/filter doesn&#39;t require you to go into VBA to modify the code. You can just add a new checkbox in the Workbook with a corresponding row in the SQL table storing mappings."}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": true, "score": 1, "last_activity_date": 1469634885, "creation_date": 1469634885, "answer_id": 38617888, "question_id": 38617426, "link": "https://stackoverflow.com/questions/38617426/loop-through-checkboxes-on-a-sheet/38617888#38617888", "title": "Loop through checkboxes on a sheet", "body": "<p>Here's one header where you can create an object to hold a list of the mapping between control name and header name. Let me know of any questions.</p>\n\n<p>Dim oDictHeaders As Object</p>\n\n<pre><code>Function GetHeaders() As Object\n    If oDictHeaders Is Nothing Then\n        Set oDictHeaders = CreateObject(\"Scripting.Dictionary\")\n\n        oDictHeaders(\"SelectSite\") = \"Header 1\"\n        oDictHeaders(\"SelectStatus\") = \"Header 2\"\n        oDictHeaders(\"SelectOther\") = \"Header 3\"\n    End If\n\n    Set GetHeaders = oDictHeaders\nEnd Function\n\n\nFunction GetListOfHeaders() As String\n    Dim sOutput As String\n    Dim oDict As Object\n    Dim ctl As Object\n\n    sOutput = \"\"\n\n    Set oDict = GetHeaders()\n\n    For Each ctl In Sheet1.OLEObjects\n    Debug.Print TypeName(ctl.Object)\n        If TypeName(ctl.Object) = \"CheckBox\" Then\n            If ctl.Object.Value = True Then\n                sOutput = sOutput &amp; \", \" &amp; oDict(ctl.Name)\n            End If\n        End If\n    Next ctl\n\n    GetListOfHeaders = Mid(sOutput, 2)\nEnd Function\n\nSub Test()\n    MsgBox (GetListOfHeaders())\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 6591314, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-B-xmgnOb1lk/AAAAAAAAAAI/AAAAAAABoAs/2xMjGWKMGP4/photo.jpg?sz=128", "display_name": "Lawrence Ferguson", "link": "https://stackoverflow.com/users/6591314/lawrence-ferguson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1687, "favorite_count": 0, "accepted_answer_id": 38617888, "answer_count": 2, "score": -1, "last_activity_date": 1474835504, "creation_date": 1469633582, "last_edit_date": 1474835504, "question_id": 38617426, "link": "https://stackoverflow.com/questions/38617426/loop-through-checkboxes-on-a-sheet", "title": "Loop through checkboxes on a sheet", "body": "<p>How would I create the following as a Loop.</p>\n\n<p>Basically the first list to loop would be selectStatus, selectSite, These are check boxes on a sheet. (The below code only includes two but the full macro has about 60 to loop)</p>\n\n<p>The second loop would be the values \"Header 1\", \"Header 2\", etc. so they would both loop and change together. The first one being the checkbox name and the second being a corresponding SQL header which I want at the end to create a string.</p>\n\n<pre><code>    Sub TEST2()\n\n    If Sheets(\"controlSheet\").selectStatus.Value = True Then\n    a = \"Header 1, \"\n    Else\n    a = \"\"\n    End If\n\n    If Sheets(\"controlSheet\").selectSite.Value = True Then\n    a = a + \"Header 2, \"\n    Else\n    a = a + \"\"\n    End If\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 3, "creation_date": 1469633449, "post_id": 38617287, "comment_id": 64620576, "body": "Actually this works fine for me. What does your &quot;someformula&quot; look like?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1469633617, "post_id": 38617287, "comment_id": 64620699, "body": "Unrelated, but <code>lastRow</code> should be <code>Long</code> so it doesn&#39;t overflow."}, {"owner": {"reputation": 13, "user_id": 3870721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/301308d790853862aac17446301afe2f?s=128&d=identicon&r=PG&f=1", "display_name": "SD1717", "link": "https://stackoverflow.com/users/3870721/sd1717"}, "edited": false, "score": 0, "creation_date": 1469634342, "post_id": 38617287, "comment_id": 64621221, "body": "My formula is :        strFormula = &quot;=IF(ISNA(VLOOKUP(I2,RelByEnv,2,FALSE)),&quot;&quot;&quot;&quot;Other&quot;&quot;&quot;&quot;,VLOOKU&zwnj;&#8203;P(I2,RelByEnv,2,FALS&zwnj;&#8203;E))&quot;   This file will have less than 5000 rows so I should be ok with Integer"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1469634663, "post_id": 38617287, "comment_id": 64621435, "body": "The problem is the formula.  Too many <code>&quot;</code> see <code>&quot;=IF(ISNA(VLOOKUP(I2,RelByEnv,2,FALSE)),&quot;&quot;Other&quot;&quot;,VLOOKUP(I2&zwnj;&#8203;,RelByEnv,2,FALSE))&quot;</code>"}, {"owner": {"reputation": 13, "user_id": 3870721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/301308d790853862aac17446301afe2f?s=128&d=identicon&r=PG&f=1", "display_name": "SD1717", "link": "https://stackoverflow.com/users/3870721/sd1717"}, "edited": false, "score": 0, "creation_date": 1469634890, "post_id": 38617287, "comment_id": 64621590, "body": "That did the trick! I did not expect that to be the issue. Thanks all !"}], "owner": {"reputation": 13, "user_id": 3870721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/301308d790853862aac17446301afe2f?s=128&d=identicon&r=PG&f=1", "display_name": "SD1717", "link": "https://stackoverflow.com/users/3870721/sd1717"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1469638662, "creation_date": 1469633219, "last_edit_date": 1531164843, "question_id": 38617287, "link": "https://stackoverflow.com/questions/38617287/getting-application-defined-error-while-referring-to-range", "title": "Getting application-defined error while referring to range", "body": "<p>I am trying to fill a formula using VBA. Here is the code</p>\n\n<hr>\n\n<pre><code>    Sub AssignRel()\n\n    Dim strFormula As Variant\n    Dim lastRow As Integer\n\n    Sheets(1).Cells(1, 13).Value = \"Assigned Release\"\n    strFormula = \"someformula\"\n\n    lastRow = Range(\"M\" &amp; Rows.Count).End(xlUp).Row\n    Sheets(1).Range(\"M2\").Select\n    Sheets(1).Range(\"M2\").Formula = strFormula\n    Range(\"M2\").AutoFill Destination:=Range(\"M2:M\" &amp; lastRow)\n\n    End Sub\n</code></pre>\n\n<hr>\n\n<p>When I run it, I get an Application-defined or object-defined error on this line: </p>\n\n<pre><code>   Sheets(1).Range(\"M2\").Formula = strFormula\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1469633091, "post_id": 38617034, "comment_id": 64620312, "body": "Have a look at this, to find out how you can use objects defined it another <code>Sub</code> in a new one. <a href=\"http://stackoverflow.com/questions/22980061/excel-vba-object-sub-call-with-2-object-parameters-gives-compile-error-expected\" title=\"excel vba object sub call with 2 object parameters gives compile error expected\">stackoverflow.com/questions/22980061/&hellip;</a>"}, {"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1469634340, "post_id": 38617034, "comment_id": 64621215, "body": "By now you only define them in <code>EquationGenerate()</code>. For learning how to define objects globally, have a look at this: <a href=\"http://stackoverflow.com/questions/21380724/best-practice-for-creating-a-public-object-in-excel-vba\" title=\"best practice for creating a public object in excel vba\">stackoverflow.com/questions/21380724/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "is_accepted": true, "score": 0, "last_activity_date": 1469634214, "creation_date": 1469634214, "answer_id": 38617678, "question_id": 38617034, "link": "https://stackoverflow.com/questions/38617034/learning-vba-bodmas-generator/38617678#38617678", "title": "Learning VBA - BODMAS Generator", "body": "<p>The reason why you're facing the 'object required' error, is that you're attempting to use the variable <code>Eqn</code> within the <code>AnswerShow</code> procedure, however this variable does not exist. </p>\n\n<p>You assigned values to the properties of the object variable <code>Eqn</code>, within the <code>EquationGenerate</code> procedure, however this object was lost from memory once this procedure finished running.</p>\n\n<p>You would have to pass the <code>Eqn</code> object variable into the <code>AnswerShow</code> procedure to be able to access the properties.</p>\n\n<p>I would also recommend using a function to generate the number, instead of a procedure with a public variable. See below code.</p>\n\n<pre><code>Private Function Indicator() As String\n\n    Dim indicator_num As Integer\n\n    indicator_num = Int(Rnd * 4)\n    Select Case indicator_num\n        Case 0\n            Indicator = \"+\"\n        Case 1\n            Indicator = \"-\"\n        Case 2\n            Indicator = \"*\"\n        Case 3\n            Indicator = \"/\"\n    End Select\n\nEnd Function\n\nPrivate Function RandNum() As Integer\n\n    RandNum = Int(Rnd * 10 + 1)\n\nEnd Function\n\nSub EquationGenerate()\n\n    Dim Eqn As EqnStatements, Ind As Indicators\n\n    Eqn.Statement1 = RandNum\n    Eqn.Statement2 = RandNum\n    Eqn.Statement3 = RandNum\n\n    Ind.Indicator1 = Indicator\n    Ind.Indicator2 = Indicator\n\n    Equation = Eqn.Statement1 &amp; \" \" &amp; Ind.Indicator1 &amp; \" \" &amp; Eqn.Statement2 &amp; \" \" &amp; Ind.Indicator2 &amp; \" \" &amp; Eqn.Statement3\n\n    Cells(2, 3) = Equation\n\n    AnswerShow Eqn, Ind\n\nEnd Sub\n\n\nSub AnswerShow(ByRef Eqn As EqnStatements, ByRef Ind As Indicators)\n\n    Answer = Eqn.Statement1 &amp; Ind.Indicator1 &amp; Eqn.Statement2 &amp; Ind.Indicator2 &amp; Eqn.Statement3\n    Cells(3, 3) = Answer\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 6134207, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/75e796bee4470e732971a0103e76ec0c?s=128&d=identicon&r=PG&f=1", "display_name": "M.White", "link": "https://stackoverflow.com/users/6134207/m-white"}, "edited": false, "score": 0, "creation_date": 1469700486, "post_id": 38617741, "comment_id": 64649933, "body": "My rep isn&#39;t high enough to publicly mark your answer as useful, so I&#39;ll leave a comment. The &#39;evaluate&#39; function was the final piece to make the code work, in addition to luke_t&#39;s answer. Much appreciated"}], "tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": false, "score": 0, "last_activity_date": 1469634417, "creation_date": 1469634417, "answer_id": 38617741, "question_id": 38617034, "link": "https://stackoverflow.com/questions/38617034/learning-vba-bodmas-generator/38617741#38617741", "title": "Learning VBA - BODMAS Generator", "body": "<p>You are storing the characters '*', '/', '+' and '-' in memory locations called `Indicator'. However this does not make them take the function of an indicator.</p>\n\n<p>Theoretically you would need to write code the interpreted each of those characters and then commanded the appropriate calculation:</p>\n\n<pre><code>`If Ind = \"*\" then Ans = x * y\n</code></pre>\n\n<p>In your case there'd be a fair bit of additional coding to get the sequence right.</p>\n\n<p>As it happens VBA has an evaluate function (<a href=\"https://msdn.microsoft.com/en-us/library/office/ff193019.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff193019.aspx</a>) that will evaluate a string formula. So you could just change your <code>AnswerShow</code> line to</p>\n\n<pre><code>Answer = Evaluate(Eqn.Statement1 &amp; Ind.Indicator1 &amp; Eqn.Statement2 &amp; Ind.Indicator2 &amp; Eqn.Statement3)\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 6134207, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/75e796bee4470e732971a0103e76ec0c?s=128&d=identicon&r=PG&f=1", "display_name": "M.White", "link": "https://stackoverflow.com/users/6134207/m-white"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 1, "accepted_answer_id": 38617678, "answer_count": 2, "score": 0, "last_activity_date": 1469634417, "creation_date": 1469632493, "last_edit_date": 1469632773, "question_id": 38617034, "link": "https://stackoverflow.com/questions/38617034/learning-vba-bodmas-generator", "title": "Learning VBA - BODMAS Generator", "body": "<p>I'm teaching myself VBA using online tutorials. Using what I've learned so far I've made a simple <a href=\"https://en.wikipedia.org/wiki/Order_of_operations\" rel=\"nofollow\">BODMAS</a> question generator. However I cannot figure out how to compute the answer to the question generated. Here's what I've done:</p>\n\n<pre><code>Dim Indicator As String, Equation As String, IndicatorNum As Integer, RandNum As Integer, Answer As Integer\n\nType EqnStatements\n   Statement1 As Integer\n   Statement2 As Integer\n   Statement3 As Integer\nEnd Type\n\nType Indicators\n   Indicator1 As String\n   Indicator2 As String\nEnd Type\n\nPrivate Sub IndicatorGenerator()\n    IndicatorNum = Int(Rnd * 4)\n    Select Case IndicatorNum\n    Case Is = 0\n        Indicator = \"+\"\n    Case Is = 1\n        Indicator = \"-\"\n    Case Is = 2\n        Indicator = \"*\"\n    Case Is = 3\n        Indicator = \"/\"\nEnd Select\nEnd Sub\n\nPrivate Sub StatementGenerator()\nRandNum = Int(Rnd * 10 + 1)\nEnd Sub\n\nSub EquationGenerate()\nDim Eqn As EqnStatements, Ind As Indicators\n\n    StatementGenerator\n        Eqn.Statement1 = RandNum\n    StatementGenerator\n        Eqn.Statement2 = RandNum\n    StatementGenerator\n        Eqn.Statement3 = RandNum\n\n    IndicatorGenerator\n        Ind.Indicator1 = Indicator\n    IndicatorGenerator\n        Ind.Indicator2 = Indicator\n\n    Equation = Eqn.Statement1 &amp; \" \" &amp; Ind.Indicator1 &amp; \" \" &amp; Eqn.Statement2 &amp; \" \" &amp; Ind.Indicator2 &amp; \" \" &amp; Eqn.Statement3\n\n    Cells(2, 3) = Equation\n    End Sub\n\n\nSub AnswerShow()\n\n  Answer = Eqn.Statement1 &amp; Ind.Indicator1 &amp; Eqn.Statement2 &amp; Ind.Indicator2 &amp; Eqn.Statement3\n  Cells(3, 3) = Answer\n\nEnd Sub\n</code></pre>\n\n<p>The first main Sub works fine, and produces the output. When I run the second main sub (AnswerShow) I get an error: \"Object required\". I'm not sure how to get it to calculate the equation using the values stored in the variables.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1469632626, "post_id": 38616840, "comment_id": 64619990, "body": "When you say macro, do you mean a VBA procedure or an Access macro object?  Excel users often call VBA procedures macros, but an Access macro is something different."}, {"owner": {"reputation": 417, "user_id": 4897271, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AMOHJ.jpg?s=128&g=1", "display_name": "jjjjjjjjjjj", "link": "https://stackoverflow.com/users/4897271/jjjjjjjjjjj"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1469632693, "post_id": 38616840, "comment_id": 64620041, "body": "A third criteria: How do I cancel switching to another record? I use <code>Cancel = True</code> and <code>Me.Undo</code> to revert the data but it still switches to the other record."}, {"owner": {"reputation": 417, "user_id": 4897271, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AMOHJ.jpg?s=128&g=1", "display_name": "jjjjjjjjjjj", "link": "https://stackoverflow.com/users/4897271/jjjjjjjjjjj"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1469632842, "post_id": 38616840, "comment_id": 64620155, "body": "@HansUp It&#39;s the type that can be edited via the form&#39;s Design View or by opening the editor with Alt + F11."}], "answers": [{"comments": [{"owner": {"reputation": 417, "user_id": 4897271, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AMOHJ.jpg?s=128&g=1", "display_name": "jjjjjjjjjjj", "link": "https://stackoverflow.com/users/4897271/jjjjjjjjjjj"}, "edited": false, "score": 0, "creation_date": 1469634022, "post_id": 38617129, "comment_id": 64621003, "body": "That&#39;s clever, I would have never thought to try that. Thank you."}, {"owner": {"reputation": 417, "user_id": 4897271, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AMOHJ.jpg?s=128&g=1", "display_name": "jjjjjjjjjjj", "link": "https://stackoverflow.com/users/4897271/jjjjjjjjjjj"}, "edited": false, "score": 0, "creation_date": 1469639393, "post_id": 38617129, "comment_id": 64624212, "body": "Perhaps you could help me with an issue that popped up. The <code>On Current</code> event runs the macro for the newly selected record, not the record that the user is finishing up with. Is there another event for this?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 417, "user_id": 4897271, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AMOHJ.jpg?s=128&g=1", "display_name": "jjjjjjjjjjj", "link": "https://stackoverflow.com/users/4897271/jjjjjjjjjjj"}, "edited": false, "score": 1, "creation_date": 1469689475, "post_id": 38617129, "comment_id": 64642674, "body": "You could use another static to hold the Id of the last visited record. See edit."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 2, "last_activity_date": 1469689424, "last_edit_date": 1469689424, "creation_date": 1469632726, "answer_id": 38617129, "question_id": 38616840, "link": "https://stackoverflow.com/questions/38616840/run-vba-on-record-change-and-not-form-open-access-2013/38617129#38617129", "title": "Run VBA on record change and not form open Access 2013", "body": "<p>You can use a <em>static</em> variable:</p>\n\n<pre><code>Private Sub Form_Current()\n\n    Static Opened As Boolean\n\n    If Opened = False\n        ' Form opens.\n        Opened = True\n    Else\n        ' Do stuff.\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>To manipulate the previous record:</p>\n\n<pre><code>Private Sub Form_Current()\n\n    Static Opened As Boolean\n    Static LastId As Long\n\n    If Opened = False\n        ' Form opens.\n        Opened = True\n    ElseIf LastId &lt;&gt; 0 Then\n        ' Do stuff using LastId as the Id.            \n    End If\n\n    ' Save current Id.\n    LastId = Nz(Me!Id.Value, 0)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 417, "user_id": 4897271, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AMOHJ.jpg?s=128&g=1", "display_name": "jjjjjjjjjjj", "link": "https://stackoverflow.com/users/4897271/jjjjjjjjjjj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 610, "favorite_count": 0, "accepted_answer_id": 38617129, "answer_count": 1, "score": 0, "last_activity_date": 1469689424, "creation_date": 1469632038, "question_id": 38616840, "link": "https://stackoverflow.com/questions/38616840/run-vba-on-record-change-and-not-form-open-access-2013", "title": "Run VBA on record change and not form open Access 2013", "body": "<p>I have two criteria for my macro.</p>\n\n<ul>\n<li>It should run only when the user switches records</li>\n<li>It should run whether or not the record was modified</li>\n</ul>\n\n<p><code>On Current</code> works but it also runs on form open. <code>After Update</code> only runs if a field is changed. Is there an event that fulfils my criteria?</p>\n"}, {"tags": ["excel", "vba", "date"], "answers": [{"comments": [{"owner": {"reputation": 1320, "user_id": 2315991, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/6e307d234c7226b7d0c1198236f21c31?s=128&d=identicon&r=PG", "display_name": "ThomasMX", "link": "https://stackoverflow.com/users/2315991/thomasmx"}, "edited": false, "score": 0, "creation_date": 1469632867, "post_id": 38616970, "comment_id": 64620175, "body": "Indeed that must be one cause of the problem. But now I have an error 1004 (not valid date). I have updated my question with the new code."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 1320, "user_id": 2315991, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/6e307d234c7226b7d0c1198236f21c31?s=128&d=identicon&r=PG", "display_name": "ThomasMX", "link": "https://stackoverflow.com/users/2315991/thomasmx"}, "edited": false, "score": 0, "creation_date": 1469633116, "post_id": 38616970, "comment_id": 64620328, "body": "@ThomasMX - I think you should mark this as answered as it fixed your original problem based on the <i>&quot;invalid procedure call or argument&quot; error.</i>.  The date issue is almost a separate question - especially since you changed the original code."}, {"owner": {"reputation": 1320, "user_id": 2315991, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/6e307d234c7226b7d0c1198236f21c31?s=128&d=identicon&r=PG", "display_name": "ThomasMX", "link": "https://stackoverflow.com/users/2315991/thomasmx"}, "edited": false, "score": 0, "creation_date": 1469634031, "post_id": 38616970, "comment_id": 64621008, "body": "Got &quot;duplicate&quot; on my other question where i asked for the reason to 1004. So  had to remove the green tick. .."}, {"owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "reply_to_user": {"reputation": 1320, "user_id": 2315991, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/6e307d234c7226b7d0c1198236f21c31?s=128&d=identicon&r=PG", "display_name": "ThomasMX", "link": "https://stackoverflow.com/users/2315991/thomasmx"}, "edited": false, "score": 0, "creation_date": 1469634481, "post_id": 38616970, "comment_id": 64621305, "body": "@ThomasMX Make your date variable a string: <code>Dim MyDate as String</code> and then <code>MyDate = &quot;27&#47;01&#47;1993&quot;</code>. Make sure to use the correct date format relating to your local settings / data."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 1320, "user_id": 2315991, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/6e307d234c7226b7d0c1198236f21c31?s=128&d=identicon&r=PG", "display_name": "ThomasMX", "link": "https://stackoverflow.com/users/2315991/thomasmx"}, "edited": false, "score": 0, "creation_date": 1469634984, "post_id": 38616970, "comment_id": 64621653, "body": "@ThomasMX - see pnuts comment above if you want to re-open the other question."}, {"owner": {"reputation": 1320, "user_id": 2315991, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/6e307d234c7226b7d0c1198236f21c31?s=128&d=identicon&r=PG", "display_name": "ThomasMX", "link": "https://stackoverflow.com/users/2315991/thomasmx"}, "edited": false, "score": 1, "creation_date": 1469635269, "post_id": 38616970, "comment_id": 64621837, "body": "Well, regarding the original question (this one ) we still haven&#39;t found the 100% correct code so I think the best is if we leave this one open and leave the other one close. I&#39;ll check your suggestions later and will give you feedback ASAP."}, {"owner": {"reputation": 1320, "user_id": 2315991, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/6e307d234c7226b7d0c1198236f21c31?s=128&d=identicon&r=PG", "display_name": "ThomasMX", "link": "https://stackoverflow.com/users/2315991/thomasmx"}, "edited": false, "score": 0, "creation_date": 1469720693, "post_id": 38616970, "comment_id": 64665181, "body": "No, unfortunately not."}, {"owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "reply_to_user": {"reputation": 1320, "user_id": 2315991, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/6e307d234c7226b7d0c1198236f21c31?s=128&d=identicon&r=PG", "display_name": "ThomasMX", "link": "https://stackoverflow.com/users/2315991/thomasmx"}, "edited": false, "score": 0, "creation_date": 1469781466, "post_id": 38616970, "comment_id": 64689874, "body": "@ThomasMX See amended answer. So this doesn&#39;t work for you? Make sure the pivot table does not already contain filters on the dates."}], "tags": [], "owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "is_accepted": false, "score": 2, "last_activity_date": 1469802196, "last_edit_date": 1469802196, "creation_date": 1469632337, "answer_id": 38616970, "question_id": 38616719, "link": "https://stackoverflow.com/questions/38616719/excel-vba-change-date-filter-of-a-pivottable/38616970#38616970", "title": "Excel VBA - Change date filter of a pivottable", "body": "<p>You need to pass <code>xlDateBetween</code> into the <code>Type:=</code> parameter of the <code>PivotFilters.Add</code> method.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff193582.aspx\" rel=\"nofollow\">Here is a list</a> of constant names that can be passed into the type parameter.</p>\n\n<p>Use a string with the <code>Type:=</code> parameter. See below.</p>\n\n<pre><code>Private Sub foo()\n    Dim d As String\n\n    d = \"01/01/2016\"\n    Worksheets(\"Timeline\").PivotTables(\"PivotTable7\").PivotFields(\"EndDateFormatted\").PivotFilters.Add Type:=xlDateBetween, Value1:=d, Value2:=d\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1320, "user_id": 2315991, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/6e307d234c7226b7d0c1198236f21c31?s=128&d=identicon&r=PG", "display_name": "ThomasMX", "link": "https://stackoverflow.com/users/2315991/thomasmx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6375, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1469802196, "creation_date": 1469631761, "last_edit_date": 1469632742, "question_id": 38616719, "link": "https://stackoverflow.com/questions/38616719/excel-vba-change-date-filter-of-a-pivottable", "title": "Excel VBA - Change date filter of a pivottable", "body": "<p>I have a pivottable on my sheet and I'm trying to add a date filter:</p>\n\n<pre><code>Private Sub foo()\n\nDim MyDate\nMyDate = #1/27/1993#\nWorksheets(\"Timeline\").PivotTables(\"PivotTable7\").PivotFields(\"EndDateFormatted\").PivotFilters.Add Type:=xlBetween, Value1:=MyDate, Value2:=MyDate\n\nEnd Sub\n</code></pre>\n\n<p>How ever this results in an \"invalid procedure call or argument\" error. What am I doing wrong?</p>\n\n<p>Update:\nthx luke_t, now I know that I have to use xlDateBetween.\nNow my code looks like:</p>\n\n<pre><code>Private Sub foo()\n    Dim d As Date\n    Dim dd As Date\n\n    d = DateSerial(2016, 1, 1)\n    dd = DateSerial(2016, 1, 2)\n    Worksheets(\"Timeline\").PivotTables(\"PivotTable7\").PivotFields(\"EndDateFormatted\").PivotFilters.Add Type:=xlDateBetween, Value1:=d, Value2:=dd\nEnd Sub\n</code></pre>\n\n<p>Now it says \"the date you entered is not a valid date\" (1004). </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 4, "creation_date": 1469632006, "post_id": 38616570, "comment_id": 64619565, "body": "I think you may have forgotten to include in your question what you have tried and what aspect of it isn&#39;t working."}], "answers": [{"comments": [{"owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 0, "creation_date": 1469632269, "post_id": 38616828, "comment_id": 64619755, "body": "i forgot to check OP tag.. wasted my time"}], "tags": [], "owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "is_accepted": false, "score": 3, "last_activity_date": 1469632006, "creation_date": 1469632006, "answer_id": 38616828, "question_id": 38616570, "link": "https://stackoverflow.com/questions/38616570/how-do-i-remove-the-leading-0s-from-a-number/38616828#38616828", "title": "How do I remove the leading 0&#39;s from a number?", "body": "<p>you can use this formula. my formula source data starts from B3.</p>\n\n<pre><code>=REPLACE(B3,1,FIND(LEFT(SUBSTITUTE(B3,0,\"\")),B3)-1,\"\")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/WMTA6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WMTA6.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1469632819, "post_id": 38616852, "comment_id": 64620135, "body": "... and of course the number format shouldn&#39;t be something like this: <code>rngCell.NumberFormat = &quot;0000000000&quot;</code> ;)"}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 4, "last_activity_date": 1469632054, "creation_date": 1469632054, "answer_id": 38616852, "question_id": 38616570, "link": "https://stackoverflow.com/questions/38616570/how-do-i-remove-the-leading-0s-from-a-number/38616852#38616852", "title": "How do I remove the leading 0&#39;s from a number?", "body": "<p>For a non-VBA solution, you can highlight the entire row and go to Data>Text-To-Columns and then hit \"Finish\". Numbers will be converted to numeric format and strings will remain untouched.</p>\n\n<p>For a VBA solution, you could iterate through the cells:</p>\n\n<pre><code> For each rngCell in Sheet1.Columns(\"A\").Cells\n\n Next rngCell\n</code></pre>\n\n<p>And within that iteration, use <code>isnumeric()</code> to test before replacing</p>\n\n<pre><code> If isnumeric(rngCell.value) Then rngCell.value = rngCell.value + 0\n</code></pre>\n\n<p>Or something along those lines. You could also record that text-to-columns bit and just sub out your column's range in the VBA. Depending on how much control you need over your data transformation.</p>\n"}, {"comments": [{"owner": {"reputation": 10840, "user_id": 426422, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/cmD2F.jpg?s=128&g=1", "display_name": "Mike Cheel", "link": "https://stackoverflow.com/users/426422/mike-cheel"}, "edited": false, "score": 0, "creation_date": 1469632464, "post_id": 38616892, "comment_id": 64619886, "body": "This won&#39;t fulfill the requirement exactly. Some start with zeros but still have chars in them."}, {"owner": {"reputation": 31, "user_id": 3421658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0887694a9f9c2e0678516397a7c3da47?s=128&d=identicon&r=PG&f=1", "display_name": "user3421658", "link": "https://stackoverflow.com/users/3421658/user3421658"}, "reply_to_user": {"reputation": 10840, "user_id": 426422, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/cmD2F.jpg?s=128&g=1", "display_name": "Mike Cheel", "link": "https://stackoverflow.com/users/426422/mike-cheel"}, "edited": false, "score": 0, "creation_date": 1469633201, "post_id": 38616892, "comment_id": 64620379, "body": "I just saw that. then your could use the regex <code>^0*</code> and replace with an empty string."}], "tags": [], "owner": {"reputation": 31, "user_id": 3421658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0887694a9f9c2e0678516397a7c3da47?s=128&d=identicon&r=PG&f=1", "display_name": "user3421658", "link": "https://stackoverflow.com/users/3421658/user3421658"}, "is_accepted": false, "score": 1, "last_activity_date": 1469633467, "last_edit_date": 1469633467, "creation_date": 1469632130, "answer_id": 38616892, "question_id": 38616570, "link": "https://stackoverflow.com/questions/38616570/how-do-i-remove-the-leading-0s-from-a-number/38616892#38616892", "title": "How do I remove the leading 0&#39;s from a number?", "body": "<p>Try to convert the cell to a number and then back to string - if it fails it already was a string.\n<a href=\"https://stackoverflow.com/questions/6202074/vba-convert-string-to-int-if-string-is-a-number\">vba convert string to int if string is a number</a></p>\n\n<p><strong>Edit:</strong></p>\n\n<p>Try to solve it with an regex:</p>\n\n<pre><code>With regEx\n    .Global = True\n    .MultiLine = True\n    .IgnoreCase = False\n    .Pattern = \"^0*\"\nEnd With\n\nIf regEx.Test(strInput) Then\n    strInput = regEx.Replace(strInput, \"\")\nEnd If\n</code></pre>\n\n<p>Source: <a href=\"https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\">How to use Regular Expressions (Regex) in Microsoft Excel both in-cell and loops</a></p>\n"}, {"comments": [{"owner": {"reputation": 16, "user_id": 6560622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd3f702f95eb8dbff9c4e75931e01b0c?s=128&d=identicon&r=PG&f=1", "display_name": "thentt", "link": "https://stackoverflow.com/users/6560622/thentt"}, "reply_to_user": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1469702703, "post_id": 38617143, "comment_id": 64651467, "body": "Yes, of course i have tested it, works perfectly. Didn&#39;t it work for you?"}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1469712839, "post_id": 38617143, "comment_id": 64658956, "body": "I am working on Excel 2016. As per my understanding The ISNUMERIC function can only be used in VBA code in Microsoft Excel whereas you have mentioned that one can do it with a formula with or without VBA. Another Worksheetfunction ISNUMBER works fine for me in the formula."}, {"owner": {"reputation": 16, "user_id": 6560622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd3f702f95eb8dbff9c4e75931e01b0c?s=128&d=identicon&r=PG&f=1", "display_name": "thentt", "link": "https://stackoverflow.com/users/6560622/thentt"}, "reply_to_user": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1470148719, "post_id": 38617143, "comment_id": 64822983, "body": "Yeah, you are right. Thank you. I had to test it in an excel with an different language package. Lost in Translation."}], "tags": [], "owner": {"reputation": 16, "user_id": 6560622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd3f702f95eb8dbff9c4e75931e01b0c?s=128&d=identicon&r=PG&f=1", "display_name": "thentt", "link": "https://stackoverflow.com/users/6560622/thentt"}, "is_accepted": false, "score": 0, "last_activity_date": 1470148663, "last_edit_date": 1470148663, "creation_date": 1469632765, "answer_id": 38617143, "question_id": 38616570, "link": "https://stackoverflow.com/questions/38616570/how-do-i-remove-the-leading-0s-from-a-number/38617143#38617143", "title": "How do I remove the leading 0&#39;s from a number?", "body": "<p>You could do it with a formular with or without VBA:</p>\n\n<pre><code>=IF(ISNUMBER(Value(A1));Value(A1);A1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 4, "last_activity_date": 1469633379, "creation_date": 1469633379, "answer_id": 38617338, "question_id": 38616570, "link": "https://stackoverflow.com/questions/38616570/how-do-i-remove-the-leading-0s-from-a-number/38617338#38617338", "title": "How do I remove the leading 0&#39;s from a number?", "body": "<p>Another Non VBA Solution... (<strong>Simplest of all</strong>)</p>\n\n<ol>\n<li>Highlight the data</li>\n<li>You will see an Exclamation Mark next to your data as shown in screenshot. Click on it</li>\n<li>Click on <code>Convert To number</code> and you are done :)</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/vyV7w.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vyV7w.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Result</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/zWRnb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zWRnb.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 73, "user_id": 6415097, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/505631082977087/picture?type=large", "display_name": "Ravi Shanker Gowda", "link": "https://stackoverflow.com/users/6415097/ravi-shanker-gowda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3052, "favorite_count": 0, "accepted_answer_id": 38616852, "answer_count": 5, "score": 0, "last_activity_date": 1470148663, "creation_date": 1469631433, "last_edit_date": 1531164843, "question_id": 38616570, "link": "https://stackoverflow.com/questions/38616570/how-do-i-remove-the-leading-0s-from-a-number", "title": "How do I remove the leading 0&#39;s from a number?", "body": "<p>I want to remove all the leading 0's from the numbers in this column, without affecting the rows that start with a letter.</p>\n\n<p><a href=\"https://i.stack.imgur.com/bwlhA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bwlhA.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel", "date", "autofilter"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1469631256, "post_id": 38616475, "comment_id": 64619016, "body": "You cannot do thjat with AutoFilter. Use a dictionary to built an array for the filter criteria."}, {"owner": {"reputation": 31, "user_id": 2842252, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/db8df7fc8085a424b881f6d6e55a664c?s=128&d=identicon&r=PG&f=1", "display_name": "user2842252", "link": "https://stackoverflow.com/users/2842252/user2842252"}, "edited": false, "score": 0, "creation_date": 1469631471, "post_id": 38616475, "comment_id": 64619189, "body": "Thanks @Jeeped I tried doing that but I&#39;m unable to get it to yesterday and today&#39;s date... Please help me with the code."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1469631590, "post_id": 38616475, "comment_id": 64619269, "body": "No problem but your data pattern is unclear. Does column L have both integers and dates in it? Do you want all of these as well as all blanks in column M? Is there any column in A:U that is unique? Can you do it manually at all or is it impossible to do manually?"}, {"owner": {"reputation": 31, "user_id": 2842252, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/db8df7fc8085a424b881f6d6e55a664c?s=128&d=identicon&r=PG&f=1", "display_name": "user2842252", "link": "https://stackoverflow.com/users/2842252/user2842252"}, "edited": false, "score": 0, "creation_date": 1469633415, "post_id": 38616475, "comment_id": 64620551, "body": "In Column L there is only date values and the rest I have completed. I want to get the dates unfiltered from the range in L column. I can do it manually but not through the code. there are no uniques vaues in A:U."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1469633604, "post_id": 38616475, "comment_id": 64620691, "body": "OK, so you can filter on the dates in column L successfully. If you want to &#39;unfilter&#39; column L then use <code>ActiveSheet.Range(&quot;$A$1:$U$3804&quot;).AutoFilter Field:=12</code> (no other parameters)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1469633710, "post_id": 38616475, "comment_id": 64620766, "body": "There are ways to improve your code (notably <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196678.aspx\" rel=\"nofollow noreferrer\">Range.CurrentRegion property</a>) but I am hesitant to write a full answer as I am still unclear on what you are trying to do and how your data is set up."}, {"owner": {"reputation": 31, "user_id": 2842252, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/db8df7fc8085a424b881f6d6e55a664c?s=128&d=identicon&r=PG&f=1", "display_name": "user2842252", "link": "https://stackoverflow.com/users/2842252/user2842252"}, "edited": false, "score": 0, "creation_date": 1469636274, "post_id": 38616475, "comment_id": 64622461, "body": "Let me start from first. I have data from Column A to U. I have many criterias to select in every column. In Column L there are only dates. What I want to achieve is Unselect dates of yesterday and today and select all other dates present. thats it. My task will be completed there."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1469638173, "last_edit_date": 1469638173, "creation_date": 1469637696, "answer_id": 38618781, "question_id": 38616475, "link": "https://stackoverflow.com/questions/38616475/autofilter-a-range-excluding-two-dates/38618781#38618781", "title": "Autofilter a Range excluding two dates", "body": "<blockquote>\n  <p><sup> In Column L there are only dates. What I want to achieve is Unselect dates of yesterday and today and select all other dates present. thats it. </sup></p>\n</blockquote>\n\n<p>Filter for all dates that are not today or yesterday.</p>\n\n<pre><code>Option Explicit\n\nSub notTodayOrYesterday()\n    With Worksheets(\"Sheet5\")\n        If .AutoFilterMode Then .AutoFilterMode = False\n        With .Cells(1, 1).CurrentRegion\n            .AutoFilter Field:=12, Criteria1:=Format(Date, \"\\&lt;\\&gt;mm/dd/yyyy\"), _\n                        Operator:=xlAnd, Criteria2:=Format(Date - 1, \"\\&lt;\\&gt;mm/dd/yyyy\")\n        End With\n        If .AutoFilterMode Then .AutoFilterMode = False\n    End With\nEnd Sub\n</code></pre>\n\n<p>Note that this was tested on a computer system with MDY regional settings. If it does not work for you and your system is DMY, change the date formats.</p>\n\n<p><a href=\"https://i.stack.imgur.com/UPXjA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UPXjA.png\" alt=\"not_today_yesterday\"></a><br/>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<sup>Before Autofilter applied</sup></p>\n\n<p><a href=\"https://i.stack.imgur.com/AuokW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AuokW.png\" alt=\"not_today_yesterday\"></a><br/>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<sup>After Autofilter applied (before End Sub)</sup></p>\n"}], "owner": {"reputation": 31, "user_id": 2842252, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/db8df7fc8085a424b881f6d6e55a664c?s=128&d=identicon&r=PG&f=1", "display_name": "user2842252", "link": "https://stackoverflow.com/users/2842252/user2842252"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 169, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1469638340, "creation_date": 1469631198, "last_edit_date": 1469638340, "question_id": 38616475, "link": "https://stackoverflow.com/questions/38616475/autofilter-a-range-excluding-two-dates", "title": "Autofilter a Range excluding two dates", "body": "<p>I have the below code, In L1 I want to select all dates except for yesterday and today and in M1 unselect all. I able to do the same in M1 but unable to perform the action in L1.</p>\n\n<pre><code>Range(\"L1\").Select\nActiveSheet.Range(\"$A$1:$U$3804\").AutoFilter Field:=12, Operator:= _\n    xlFilterValues, Criteria2:=Array(1, \"2/11/2016\", 1, \"3/31/2016\", 2, \"4/5/2016\", 2, _\n    \"4/6/2016\", 2, \"4/7/2016\", 2, \"4/8/2016\", 2, \"4/11/2016\", 2, \"4/12/2016\", 2, \"4/13/2016\", _\n    2, \"4/14/2016\", 2, \"4/15/2016\", 2, \"4/18/2016\", 2, \"4/19/2016\", 2, \"4/20/2016\", 2, _\n    \"4/21/2016\", 2, \"4/22/2016\", 2, \"4/25/2016\", 0, \"10/28/2015\")\nRange(\"M1\").Select\nActiveSheet.Range(\"$A$1:$U$3804\").AutoFilter Field:=13, Criteria1:=\"=\"\n</code></pre>\n\n<p><em>From user's Comments:</em></p>\n\n<p>I have data from Column A to U. I have many criterias to select in every column. In Column L there are only dates. What I want to achieve is Unselect dates of yesterday and today and select all other dates present. thats it. My task will be completed there</p>\n"}, {"tags": ["excel", "vba", "namespaces"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1469630653, "post_id": 38616187, "comment_id": 64618545, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/38571937/vba-to-download-extract-and-import-zip-file-to-excel\">VBA to Download, Extract and Import Zip File to Excel</a>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1469630787, "post_id": 38616187, "comment_id": 64618655, "body": "Which is a duplicate of <a href=\"http://stackoverflow.com/questions/26486871/how-to-import-a-zipped-csv-hosted-online-into-excel\">How to import a zipped csv hosted online into Excel</a>. Please <a href=\"http://stackoverflow.com/posts/38571937/edit\">edit your old question</a> with your new information instead of posting a new question."}, {"owner": {"reputation": 31, "user_id": 6629935, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RfJNl.jpg?s=128&g=1", "display_name": "Bruce", "link": "https://stackoverflow.com/users/6629935/bruce"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1469632129, "post_id": 38616187, "comment_id": 64619651, "body": "I asked a question in the post of your second comment, but an Administrator deleted it because it didn&#39;t contribute.  In the other post, someone said to write the code myself.  I don&#39;t know VBA so I&#39;m learning and researching."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 6629935, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RfJNl.jpg?s=128&g=1", "display_name": "Bruce", "link": "https://stackoverflow.com/users/6629935/bruce"}, "edited": false, "score": 0, "creation_date": 1469711240, "post_id": 38616686, "comment_id": 64657583, "body": "I changed the order but I&#39;m still getting the error.  I don&#39;t know if this matters but after researching other scripts, I changed all objOApp to oApp."}, {"owner": {"reputation": 31, "user_id": 6629935, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RfJNl.jpg?s=128&g=1", "display_name": "Bruce", "link": "https://stackoverflow.com/users/6629935/bruce"}, "edited": false, "score": 0, "creation_date": 1469798295, "post_id": 38616686, "comment_id": 64700532, "body": "thanks for the help.  Do I add a Private Function UnZip(mainFolder As Variant, zipFolder As Variant) at the top?"}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "reply_to_user": {"reputation": 31, "user_id": 6629935, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RfJNl.jpg?s=128&g=1", "display_name": "Bruce", "link": "https://stackoverflow.com/users/6629935/bruce"}, "edited": false, "score": 0, "creation_date": 1469819175, "post_id": 38616686, "comment_id": 64712763, "body": "No, just a <code>Sub</code> with any name, like this: <code>Private Sub UnZip()</code>."}], "tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": false, "score": 0, "last_activity_date": 1469774030, "last_edit_date": 1469774030, "creation_date": 1469631698, "answer_id": 38616686, "question_id": 38616187, "link": "https://stackoverflow.com/questions/38616187/vba-error-on-namespace-copyhere-and-namespace-items/38616686#38616686", "title": "VBA Error on Namespace().CopyHere...and...Namespace().items", "body": "<p>Comintem is right, you should edit your old question with the added code rather than post a near identical new question. Perhaps keep this question and delete the old one.</p>\n\n<p>To answer your question, it looks as if you're passing your arguments in the wrong order to your <code>UnZip</code> function. Try changing the line to:</p>\n\n<pre><code>Call UnZip(targetFolder, targetFileZip)\n</code></pre>\n\n<p><strong>Update</strong></p>\n\n<p>It's difficult to diagnose the issues as your objects are being created and its properties/methods being called all on one line. Judging by the nature of your questions it doesn't seem as though your VBA knowledge is particularly vast and that you're trying to construct a working solution by tying various pieces of web code together. It's not my position to judge that kind of approach but my advice would be, if you take this approach, to create your objects one at a time and call its methods one at a time. This will make it far easier to diagnose your code.</p>\n\n<p>I've tried to rewrite elements of your code to show you how this could be done. It might be a bit overkill but at least it'll help you identify the precise location of any problems. Obviously change the folder names to your own.</p>\n\n<pre><code>Dim mainFolder As String\nDim zipFolder As String\nDim destinationFolder As String\nDim oShell As Object\nDim oMainFolder As Object\nDim oDestinatioFolder As Object\nDim oZipFolder As Object\nDim oZipItems As Object\n\n'Define the folder names\nmainFolder = \"C:\\Users\\User\\Downloads\\SO\\\" 'change to your own folder name\nzipFolder = \"sqlite-shell-win32-x86-3071700.zip\" 'an old sqlite download = change to your name\ndestinationFolder = Left(zipFolder, Len(zipFolder) - 4) 'name of zip folder minus the '.zip'\n\n'Create the new destination folder\nMkDir mainFolder &amp; destinationFolder\n\n'Acquire the folder items\n'create the shell object\nSet oShell = CreateObject(\"Shell.Application\")\n'create the main folder object as Folder3 item\nSet oMainFolder = oShell.Namespace(CVar(mainFolder)) 'argument must be a variant\n'create the destination folder object as Folder3 item\nSet oDestinatioFolder = oMainFolder.Items.Item(CVar(destinationFolder &amp; \"\\\")).GetFolder\n'create the zip folder object as Folder3\nSet oZipFolder = oMainFolder.Items.Item(CVar(zipFolder)).GetFolder\n\n'Extract the zip folder items and write to desination folder\noDestinatioFolder.CopyHere oZipFolder.Items, 256\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 9899115, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/c243054a75cea9597a1c6e7131d5cc0b?s=128&d=identicon&r=PG", "display_name": "Armando A Pereira", "link": "https://stackoverflow.com/users/9899115/armando-a-pereira"}, "is_accepted": false, "score": 1, "last_activity_date": 1528219648, "last_edit_date": 1528219648, "creation_date": 1528219190, "answer_id": 50705665, "question_id": 38616187, "link": "https://stackoverflow.com/questions/38616187/vba-error-on-namespace-copyhere-and-namespace-items/50705665#50705665", "title": "VBA Error on Namespace().CopyHere...and...Namespace().items", "body": "<pre><code>Dim mainFolder As String\nDim zipFolder As String\nDim destinationFolder As String\nDim oShell As Object\nDim oMainFolder As Object\nDim oDestinatioFolder As Object\nDim oZipFolder As Object\nDim oZipItems As Object\n</code></pre>\n\n<p>replace with</p>\n\n<pre><code>Dim mainFolder As Variant\nDim zipFolder As Variant\nDim destinationFolder As Variant\nDim oShell As Object\nDim oMainFolder As Object\nDim oDestinatioFolder As Object\nDim oZipFolder As Object\nDim oZipItems As Object\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6629935, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RfJNl.jpg?s=128&g=1", "display_name": "Bruce", "link": "https://stackoverflow.com/users/6629935/bruce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6961, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1586382734, "creation_date": 1469630510, "last_edit_date": 1586382734, "question_id": 38616187, "link": "https://stackoverflow.com/questions/38616187/vba-error-on-namespace-copyhere-and-namespace-items", "title": "VBA Error on Namespace().CopyHere...and...Namespace().items", "body": "<p>I'm attempting to modify a VBA script from another post (26486871).</p>\n\n<p>The script will download a Zip file, extract a text file and import the data to Excel.</p>\n\n<p>I don't know VBA so I'll tackle each of the functions one at-a-time.</p>\n\n<ol>\n<li>Create a temp directory with a randomized name................................Complete</li>\n<li>Download a Zip file from a public server...............................................Complete</li>\n<li>Extract the text file (20MB, tab-delimited)..............................................Error</li>\n<li>Import the data into the open worksheet (overwrite the existing data)...Not Yet</li>\n</ol>\n\n<p>On the Extract portion, I'm receiving a run-time error on the following line:</p>\n\n<pre><code>objOApp.Namespace(FileNameToUnzip).CopyHere objOApp.Namespace(varFileNameFolder).items, 256\n</code></pre>\n\n<blockquote>\n  <p>\"Run-time error '91:  Object variable or With block variable not set.\"</p>\n</blockquote>\n\n<p>When I hover my cursor over the variables while in Debug Mode, the directory and filenames are correct.\nI'm unsure what is not set.  I appreciate any help.</p>\n\n<pre><code>Option Explicit\n'Main Procedure\nSub DownloadExtractAndImport()\n\nDim url As String\nDim targetFolder As String, targetFileZip As String, targetFileTXT As String\n\nDim wkbAll As Workbook\nDim wkbTemp As Workbook\nDim sDelimiter As String\nDim newSheet As Worksheet\n\nurl = \"http://www.example.com/data.zip\"\ntargetFolder = Environ(\"TEMP\") &amp; \"\\\" &amp; RandomString(6) &amp; \"\\\"\nMkDir targetFolder\ntargetFileZip = targetFolder &amp; \"data.zip\"\ntargetFileTXT = targetFolder &amp; \"data.txt\"\n\n'1 download file\nDownloadFile url, targetFileZip\n\n'2 extract contents\nCall UnZip(targetFileZip, targetFolder)\n\n\nEnd Sub\n\nPrivate Sub DownloadFile(myURL As String, target As String)\n\nDim WinHttpReq As Object\nDim oStream As Object\nSet WinHttpReq = CreateObject(\"Msxml2.ServerXMLHTTP\")\nWinHttpReq.Open \"GET\", myURL, False\nWinHttpReq.send\n\nmyURL = WinHttpReq.responseBody\nIf WinHttpReq.Status = 200 Then\nSet oStream = CreateObject(\"ADODB.Stream\")\noStream.Open\noStream.Type = 1\noStream.Write WinHttpReq.responseBody\noStream.SaveToFile target, 1 ' 1 = no overwrite, 2 = overwrite\noStream.Close\nEnd If\n\nEnd Sub\n\nPrivate Function RandomString(cb As Integer) As String\n\nRandomize\nDim rgch As String\nrgch = \"abcdefghijklmnopqrstuvwxyz\"\nrgch = rgch &amp; UCase(rgch) &amp; \"0123456789\"\n\nDim i As Long\nFor i = 1 To cb\nRandomString = RandomString &amp; Mid$(rgch, Int(Rnd() * Len(rgch) + 1), 1)\nNext\n\nEnd Function\n\nPrivate Function UnZip(PathToUnzipFileTo As Variant, FileNameToUnzip As Variant)\n\nDim objOApp As Object\nDim varFileNameFolder As Variant\nvarFileNameFolder = PathToUnzipFileTo\nSet objOApp = CreateObject(\"Shell.Application\")\nobjOApp.Namespace(FileNameToUnzip).CopyHere objOApp.Namespace(varFileNameFolder).items, 256\n\nEnd Function\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel", "runtime-error"], "answers": [{"tags": [], "owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "is_accepted": false, "score": 0, "last_activity_date": 1470135336, "creation_date": 1470135336, "answer_id": 38718496, "question_id": 38615720, "link": "https://stackoverflow.com/questions/38615720/array-version-of-partial-permutation-generator-in-vba-excel/38718496#38718496", "title": "Array version of partial permutation generator in VBA Excel", "body": "<p>Finally, I found the right code to obtain all of k-permutations using the array method <strong>provided</strong> there's no duplicate data in the input. The following code works fine and pretty fast.</p>\n\n<pre><code>Dim k As Long, Permutation_Table\nSub Permutation()\nDim Data_Input, Permutation_Output\nDim Output_Row As Long, Last_Column As Long, Array_Row As Long\n\nRows(\"2:\" &amp; Rows.Count).Clear\nLast_Column = Cells(1, Columns.Count).End(xlToLeft).Column\nData_Input = Application.Transpose(Application.Transpose(Range(\"A1\", Cells(1, Last_Column))))\n\nk = InputBox(\"Input the value of k for P(\" _\n    &amp; UBound(Data_Input) &amp; \" , k) where k is an integer between 2 and \" _\n    &amp; UBound(Data_Input) &amp; \" inclusive.\", \"Permutation\", 1)\n\nArray_Row = WorksheetFunction.Fact(k) * WorksheetFunction.Combin(UBound(Data_Input), k)\n\nReDim Permutation_Table(1 To Array_Row, 1 To k)\n\nIf k &gt;= 2 And k &lt;= UBound(Data_Input) Then\n    ReDim Permutation_Output(1 To k)\n    Call Permutation_Generator(Data_Input, Permutation_Output, Output_Row, 1)\nElse\n    MsgBox \"The input [\" &amp; k &amp; \"] is invalid. The input must be an integer between 2 and \" _\n    &amp; UBound(Data_Input) &amp; \" inclusive.\"\nEnd If\nRange(\"A3\").Resize(Array_Row, k) = Permutation_Table    'Use this line if UBound(Data_Input) &lt; 10\nEnd Sub\n\nFunction Permutation_Generator(Data_Input As Variant, Permutation_Output As Variant, _\n                               Output_Row As Long, Output_Index As Integer)\nDim i As Long, j As Long, P As Boolean\n\nFor i = 1 To UBound(Data_Input)\n    P = True\n    For j = 1 To Output_Index - 1\n        If Permutation_Output(j) = Data_Input(i) Then\n            P = False\n            Exit For\n        End If\n    Next j\n    If P Then\n        Permutation_Output(Output_Index) = Data_Input(i)\n        If Output_Index = k Then\n            Output_Row = Output_Row + 1\n            For n = 1 To k\n                Permutation_Table(Output_Row, n) = Permutation_Output(n)\n            Next n\n            Debug.Print Join(Permutation_Output, \",\")    'Optional, use this line as the output if UBound(Data_Input) &gt; 9\n        Else\n            Call Permutation_Generator(Data_Input, Permutation_Output, Output_Row, Output_Index + 1)\n        End If\n    End If\nNext i\nEnd Function\n</code></pre>\n\n<p><strong>P.S.</strong> I'm still hoping someone here comes up with a better version, either a shorter or quicker version.</p>\n"}], "owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 158, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1470135336, "creation_date": 1469629395, "last_edit_date": 1469805546, "question_id": 38615720, "link": "https://stackoverflow.com/questions/38615720/array-version-of-partial-permutation-generator-in-vba-excel", "title": "Array version of partial permutation generator in VBA Excel", "body": "<p>I'm trying to make a VBA code to arrange k-element subset of an n-set into some sequence. In other word, I'm trying to list all of <a href=\"http://reference.wolfram.com/language/ref/Permutations.html\" rel=\"nofollow\">k-permutations of n</a> member set. For example, let's try to list all of <a href=\"https://www.wolframalpha.com/input/?i=Permutations%5B%7BA,B,C%7D,2%5D\" rel=\"nofollow\">2-permutations of set <strong>{A,B,C}</strong></a> where each characters are located in the cells of <code>Range(\"A1:C1\")</code>. Here are all the permutations: </p>\n\n<pre><code>{A,B}       {A,C}       {B,A}       {B,C}       {C,A}       {C,B}\n</code></pre>\n\n<p>The following code to implement the above task works fine if there's no duplicate in each of characters of data input:</p>\n\n<pre><code>Sub Permutation()\nDim Data_Input As Variant, Permutation_Output As Variant\nDim Output_Row As Long, Last_Column As Long\n\nRows(\"2:\" &amp; Rows.Count).Clear\nLast_Column = Cells(1, Columns.Count).End(xlToLeft).Column\nData_Input = Application.Transpose(Application.Transpose(Range(\"A1\", Cells(1, Last_Column))))\n\nk = InputBox(\"Input the value of k for P(\" _\n    &amp; UBound(Data_Input) &amp; \" , k) where k is an integer between 2 and \" _\n    &amp; UBound(Data_Input) &amp; \" inclusive.\", \"Permutation\", 1)\n\nIf k &gt;= 2 And k &lt;= UBound(Data_Input) Then\n    Output_Row = 2\n    ReDim Permutation_Output(1 To k)\n    Call Permutation_Generator(Data_Input, Permutation_Output, Output_Row, 1)\nElse\n    MsgBox \"The input [\" &amp; k &amp; \"] is invalid. The input must be an integer between 2 and \" _\n    &amp; UBound(Data_Input) &amp; \" inclusive.\"\nEnd If\n\nEnd Sub\n\nFunction Permutation_Generator(Data_Input As Variant, Permutation_Output As Variant, _\n                               Output_Row As Long, Output_Index As Integer)\nDim i As Long, j As Long, P As Boolean\n\nFor i = 1 To UBound(Data_Input)\n    P = True\n    For j = 1 To Output_Index - 1\n        If Permutation_Output(j) = Data_Input(i) Then\n            P = False\n            Exit For\n        End If\n    Next j\n    If P Then\n        Permutation_Output(Output_Index) = Data_Input(i)\n        If Output_Index = k Then\n            Output_Row = Output_Row + 1\n            Range(\"A\" &amp; Output_Row).Resize(, k) = Permutation_Output\n        Else\n            Call Permutation_Generator(Data_Input, Permutation_Output, Output_Row, Output_Index + 1)\n        End If\n    End If\nNext i\nEnd Function\n</code></pre>\n\n<p>Though the above code has not perfectly worked fine for processing the duplicate data, but I am trying to improve its performance by putting the input data and finding all of k-permutations in arrays. Here is the code in the array version:</p>\n\n<pre><code>Option Explicit\nPublic k As Variant, Permutation_Table As Variant\nSub Permutation()\nDim Data_Input, Permutation_Output\nDim Output_Row As Long, Last_Column As Long\n\nRows(\"2:\" &amp; Rows.Count).Clear\nLast_Column = Cells(1, Columns.Count).End(xlToLeft).Column\nData_Input = Application.Transpose(Application.Transpose(Range(\"A1\", Cells(1, Last_Column))))\n\nk = InputBox(\"Input the value of k for P(\" _\n    &amp; UBound(Data_Input) &amp; \" , k) where k is an integer between 2 and \" _\n    &amp; UBound(Data_Input) &amp; \" inclusive.\", \"Permutation\", 1)\n\nReDim Permutation_Table(1 To Output_Row - 2, 1 To k)\n\nIf k &gt;= 2 And k &lt;= UBound(Data_Input) Then\n    Output_Row = 2\n    ReDim Permutation_Output(1 To k)\n    Call Permutation_Generator(Data_Input, Permutation_Output, Output_Row, 1)\nElse\n    MsgBox \"The input [\" &amp; k &amp; \"] is invalid. The input must be an integer between 2 and \" _\n    &amp; UBound(Data_Input) &amp; \" inclusive.\"\nEnd If\nRange(\"A3\", Cells(Output_Row - 2, k)) = Permutation_Table\nEnd Sub\n\nFunction Permutation_Generator(Data_Input As Variant, Permutation_Output As Variant, _\n                               Output_Row As Long, Output_Index As Integer)\nDim i As Long, j As Long, n As Long, P As Boolean\n\nFor i = 1 To UBound(Data_Input)\n    P = True\n    For j = 1 To Output_Index - 1\n        If Permutation_Output(j) = Data_Input(i) Then\n            P = False\n            Exit For\n        End If\n    Next j\n    If P Then\n        Permutation_Output(Output_Index) = Data_Input(i)\n        If Output_Index = k Then\n            Output_Row = Output_Row + 1\n            For n = 1 To k\n            Permutation_Table(Output_Row, n) = Permutation_Output(n)\n            Next n\n        Else\n            Call Permutation_Generator(Data_Input, Permutation_Output, Output_Row, Output_Index + 1)\n        End If\n    End If\nNext i\nEnd Function\n</code></pre>\n\n<p>Unfortunately, I encountered some errors when trying to fix it. The last error I encountered is the run-time error '7'. I'm hoping someone here could help me to fix it and to better it in order to make a good partial anagram generator, i.e. it must be able to work if there are the duplicate characters. For example, let's test to list all of characters in my name: <strong>ANA</strong>. <a href=\"https://www.wolframalpha.com/input/?i=Permutations%5B%7BA,N,A%7D,3%5D\" rel=\"nofollow\">The output</a> should be <strong>ANA</strong>, <strong>AAN</strong>, and <strong>NAA</strong>, but my code returns nothing. For <a href=\"https://www.wolframalpha.com/input/?i=Permutations%5B%7BA,N,A%7D,2%5D\" rel=\"nofollow\">2-permutations of my name</a> should be <strong>AN</strong>, <strong>AA</strong>, and <strong>NA</strong> yet my code returns <strong>AN</strong>, <strong>NA</strong>, <strong>AN</strong>, and <strong>NA</strong>. <em>I'd be eternally grateful if someone here could help me.</em></p>\n"}, {"tags": ["c#", "vba", "dll", "ms-word", "com"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1469628489, "post_id": 38615237, "comment_id": 64616770, "body": "what is the error? where is the type library?"}, {"owner": {"reputation": 37, "user_id": 6386553, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/sfEcG.jpg?s=128&g=1", "display_name": "William James", "link": "https://stackoverflow.com/users/6386553/william-james"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1469628781, "post_id": 38615237, "comment_id": 64616996, "body": "@cyboashu The error occurs in the vba code at oForm1.ShowDialog. Error message is: Run-time error &#39;-2146233079 (80131509)&#39; Automation error. I am not sure what this error means but it seems generic. The tlb file is in the same folder as the dll file."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1469629139, "post_id": 38615237, "comment_id": 64617301, "body": "in your regasm use /tlb switch too...."}, {"owner": {"reputation": 37, "user_id": 6386553, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/sfEcG.jpg?s=128&g=1", "display_name": "William James", "link": "https://stackoverflow.com/users/6386553/william-james"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1469629683, "post_id": 38615237, "comment_id": 64617755, "body": "@cyboashu tried: regasm my.dll /tlb:my.tlb and it successfully ran but the same error occurs."}, {"owner": {"reputation": 37, "user_id": 6386553, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/sfEcG.jpg?s=128&g=1", "display_name": "William James", "link": "https://stackoverflow.com/users/6386553/william-james"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1469630350, "post_id": 38615237, "comment_id": 64618308, "body": "@cyboashu I had a long list of &quot;Type library exporter warnings .... Warning: Non Com visible value type &#39;System....&#39; is being referenced either from the type currently being exported or from one of its base types&quot;. But the last message says that the assembly has exported successfully."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 6386553, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/sfEcG.jpg?s=128&g=1", "display_name": "William James", "link": "https://stackoverflow.com/users/6386553/william-james"}, "edited": false, "score": 0, "creation_date": 1469693981, "post_id": 38616199, "comment_id": 64645469, "body": "Doing this located the error for me, Thanks. The error is &quot;No connection string named &#39;myEntities&#39; could be found in the application config file. The app config of the dll has the connection, so does this mean that the config of MS Word requires it?"}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1469695422, "post_id": 38616199, "comment_id": 64646356, "body": "DLLs cannot have a config file, only the EXE.  You can write a winword.exe.config file and put it in the same directory as winword.exe.  It is however brittle if other people are likely to write add-ins."}, {"owner": {"reputation": 37, "user_id": 6386553, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/sfEcG.jpg?s=128&g=1", "display_name": "William James", "link": "https://stackoverflow.com/users/6386553/william-james"}, "edited": false, "score": 0, "creation_date": 1469697748, "post_id": 38616199, "comment_id": 64647952, "body": "@HansPassant thanks, would it be possible to create a myproject.dll.config file and store the EF connection information in here? as adding a config to winword would be in a different directory as my dll, so would be annoying to maintain? many thanks"}, {"owner": {"reputation": 161252, "user_id": 40347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9833194869e7f99d6e388f4aee76c1?s=128&d=identicon&r=PG", "display_name": "Dirk Vollmar", "link": "https://stackoverflow.com/users/40347/dirk-vollmar"}, "edited": false, "score": 0, "creation_date": 1469699201, "post_id": 38616199, "comment_id": 64649044, "body": "@HansPassant: Is there any place where the numbering scheme of HRESULT values is documented? <a href=\"http://referencesource.microsoft.com/#mscorlib/system/__hresults.cs.html\" rel=\"nofollow noreferrer\">This</a> was as close as I could get, but it seems not like an official documentation."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1469699445, "post_id": 38616199, "comment_id": 64649211, "body": "Yes, the WinError.h SDK include file.  .NET specific error codes (like 1509) are in CorError.h"}], "tags": [], "owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "is_accepted": false, "score": 2, "last_activity_date": 1469633812, "last_edit_date": 1469633812, "creation_date": 1469630531, "answer_id": 38616199, "question_id": 38615237, "link": "https://stackoverflow.com/questions/38615237/calling-a-c-com-dll-from-vba/38616199#38616199", "title": "Calling a c# COM dll from vba", "body": "<blockquote>\n  <p>Run-time error '-2146233079 (80131509)' Automation error.</p>\n</blockquote>\n\n<p>8013 says that this error was caused by a .NET exception.  1509 says that it was an InvalidOperationException.  No reason to assume that this has anything to do with the way you built or registered your project.  Managed exceptions don't exactly get easier to troubleshoot when it is a native app that reports them, you for one can't get the holy stack trace to tell you where it died.</p>\n\n<p>You'll have to use the debugger to find the cause.  Project > Properties > Debug tab > select \"Start external program\" and select the Office app executable, WinWord.exe in this case.  Use Debug > Exceptions and tick the Thrown checkbox for CLR exceptions so that the debugger stops when the exception is thrown.  Press F5.  If you can't get a debugger onto the machine that fails then use the DebugDiag utility.</p>\n"}], "owner": {"reputation": 37, "user_id": 6386553, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/sfEcG.jpg?s=128&g=1", "display_name": "William James", "link": "https://stackoverflow.com/users/6386553/william-james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 354, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1469647198, "creation_date": 1469628248, "last_edit_date": 1469647198, "question_id": 38615237, "link": "https://stackoverflow.com/questions/38615237/calling-a-c-com-dll-from-vba", "title": "Calling a c# COM dll from vba", "body": "<p>I have created a class library that contains a form where the user can pick a choose items from a database. I want to be able to run this dll from vba within word, via a button on the ribbon.</p>\n\n<p>So far I have created windows form and it works as expected when built as a windows application. When built as a class library and the dll is referenced within a WordAddin project, it works as expected. The issue occurs when I attempt to run the dll form from the vba code.</p>\n\n<p>I have added the ddl as a reference and ensured that the class library is Com Visible (Properties > Build > Register for COM interop, Assembly Information > Make assembly COM-Visible and [ComVisible(true)] above the class). I have also strongly signed the project and registered without error with regAsm.exe /codebase \"ddl path\". </p>\n\n<p>Below is the vba code that is attempting to open the form. The code errors on oForm1.ShowDialog line with the error: Automation error.</p>\n\n<pre><code>Public Sub TimecardLookup()\n    Dim oForm1 As New GeldardsTimecardLookup.Form1\n    oForm1.ShowDialog\n\n    Dim a As String\n    a = oForm1.outputText\n\n    ActiveDocument.Application.Selection.Range.Text = a\nEnd Sub\n</code></pre>\n\n<p>I presume I am missing a setting in my dll, I have [ClassInterface(ClassInterfaceType.AutoDual)] enabled also, to allow for intellisense. All the class library does is show a dialog, read from a SQL database via Entity Framework and returns a string.</p>\n"}, {"tags": ["r", "vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 3, "creation_date": 1469628787, "post_id": 38615137, "comment_id": 64617001, "body": "You can take a look at <a href=\"http://stackoverflow.com/questions/14493473/how-to-add-excel-2010-macro-programmatically\">How to add excel 2010 macro programmatically</a> - it <i>might</i> be possible to port it to VBScript. If the <code>openxlsx</code> supports it, creating the file from a macro-enabled template containing the code would be the simplest solution."}], "owner": {"reputation": 1574, "user_id": 2860086, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/6747a76094a1d87b85a21ff5026425c1?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Nevsky", "link": "https://stackoverflow.com/users/2860086/alex-nevsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 211, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1469628167, "creation_date": 1469628015, "last_edit_date": 1469628167, "question_id": 38615137, "link": "https://stackoverflow.com/questions/38615137/insert-macros-in-excel-using-r-or-cmd", "title": "insert macros in excel using R or cmd", "body": "<p>I have the following problem: R script creates <code>.xlsx</code> file with a table where one of the columns is comprised of images (one image per cell) using <code>openxlsx</code> library. I need to align images in the center of the corresponding cells which seem to be impossible to do by means of <code>openxlsx</code> package. Therefore, I have written a simple <code>VB script(macro)</code> which may do it and want to embed this macro in excel using R or cmd(since R may call system comands). \nCould it be possible?</p>\n\n<p>Here is the macro if it is needed:</p>\n\n<pre><code>Sub mymacro()\n Dim Ran As Range\n Dim Sh As Shape\n For Each Sh In ActiveSheet.Shapes\n  Set Ran = Sh.TopLeftCell\n  Sh.Left = Ran.Left + (Ran.Width - Sh.Width) / 2\n  Sh.Top = Ran.Top + (Ran.Height - Sh.Height) / 2\n Next Sh\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 3, "creation_date": 1469628035, "post_id": 38615010, "comment_id": 64616442, "body": "Test for Ubound and LBound"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1469629506, "post_id": 38615010, "comment_id": 64617592, "body": "<code>On Error Resume Next</code> does not &quot;handle&quot; the error.  It explicitly <i>does not handle it</i>. See <a href=\"http://stackoverflow.com/documentation/vba/3211/error-handling\">Error Handling</a> over on Documentation."}, {"owner": {"reputation": 4124, "user_id": 3183924, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e9d0e2a47aea15d63e369970b921cca?s=128&d=identicon&r=PG&f=1", "display_name": "Paradox", "link": "https://stackoverflow.com/users/3183924/paradox"}, "edited": false, "score": 1, "creation_date": 1469630118, "post_id": 38615010, "comment_id": 64618111, "body": "Comintern: I am aware of that, hence trying to fix this properly.  I&#39;ll remove that comment since it was just a temporary measure to suppress the error."}], "answers": [{"tags": [], "owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "is_accepted": true, "score": 3, "last_activity_date": 1469628091, "creation_date": 1469628091, "answer_id": 38615173, "question_id": 38615010, "link": "https://stackoverflow.com/questions/38615010/how-to-check-if-vardata0-exists-in-access-vba-to-overcome-subscript-out-of-ra/38615173#38615173", "title": "How to check if varData(0) exists in Access VBA to overcome &quot;Subscript out of range&quot; error?", "body": "<p>Use <code>UBound(varData)&gt;-1</code> (or <code>&gt;=0</code>) to check if it has at least one value. If there is no value, UBound gives -1.</p>\n\n<pre><code>Dim varData As Variant\nDim rs      As DAO.Recordset\n\n...\n\nSet rs = db.OpenRecordset(strSQL, dbOpenDynaset)\n\n...\n\n' Get all comma delimited fields '\nvarData = Split(rs![field_to_split], \",\") \n\n' Update First Record '\nIf UBound(varData) &gt; -1 Then\n  .Edit\n  !region_split = Trim(varData(0)) ' Remove spaces before writing new fields '\n  .Update\nEnd If\n</code></pre>\n\n<p>You can also use a For loop:</p>\n\n<pre><code>For i = 0 To UBound(varData)\n  MsgBox varData(i)\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 443, "user_id": 1045151, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/2oguu.jpg?s=128&g=1", "display_name": "Sham Yemul", "link": "https://stackoverflow.com/users/1045151/sham-yemul"}, "is_accepted": false, "score": 0, "last_activity_date": 1469681433, "creation_date": 1469681433, "answer_id": 38627323, "question_id": 38615010, "link": "https://stackoverflow.com/questions/38615010/how-to-check-if-vardata0-exists-in-access-vba-to-overcome-subscript-out-of-ra/38627323#38627323", "title": "How to check if varData(0) exists in Access VBA to overcome &quot;Subscript out of range&quot; error?", "body": "<p>Use Ubound([array name],[dimension]) function that returns highest number of subscript of the array for dimension. dimension if not specified assumed 1. In your case it is single dimension array to make sure you use last index as\nnIndex = Ubound([array name]) -1 </p>\n\n<pre><code>for nIndex = 0 to Ubound(varData) - 1 \n    Debug.Print varData(nIndex)\nnext\n</code></pre>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/95b8f22f(v=vs.90).aspx\" rel=\"nofollow\">Visual Basic help for more details</a> , <a href=\"https://support.office.com/en-us/article/UBound-Function-212b1998-327b-4f1e-ba3f-db4f9b5ba251\" rel=\"nofollow\">Office Help of UBound</a></p>\n"}], "owner": {"reputation": 4124, "user_id": 3183924, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e9d0e2a47aea15d63e369970b921cca?s=128&d=identicon&r=PG&f=1", "display_name": "Paradox", "link": "https://stackoverflow.com/users/3183924/paradox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1624, "favorite_count": 0, "accepted_answer_id": 38615173, "answer_count": 2, "score": 1, "last_activity_date": 1594641650, "creation_date": 1469627708, "last_edit_date": 1594641650, "question_id": 38615010, "link": "https://stackoverflow.com/questions/38615010/how-to-check-if-vardata0-exists-in-access-vba-to-overcome-subscript-out-of-ra", "title": "How to check if varData(0) exists in Access VBA to overcome &quot;Subscript out of range&quot; error?", "body": "<p>In my program, if <code>field_to_split</code> contains the empty string, then I get the following error:</p>\n\n<blockquote>\n<pre><code>Run-time error '9':  \nSubscript out of range\n</code></pre>\n</blockquote>\n\n<p>As a temporary \"fix\", I have added in <code>On Error Resume Next</code> because after trying several different if statements, I cannot figure out how to do a check to ensure that varData is populated at at least index 0.  How could I mitigate the error occurring from this scenario?</p>\n\n<p>Here is the relevant code:</p>\n\n<pre><code>Dim varData As Variant\nDim rs      As DAO.Recordset\n\n...\n\nSet rs = db.OpenRecordset(strSQL, dbOpenDynaset)\n\n...\n\n' Get all comma delimited fields '\nvarData = Split(rs![field_to_split], \",\") \n\n' Update First Record '\nOn Error Resume Next\n.Edit\n!region_split = Trim(varData(0)) ' Remove spaces before writing new fields '\n.Update\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access", "ms-access-2010", "ado"], "comments": [{"owner": {"reputation": 836, "user_id": 6419727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e6f5532e6c9f3d91e56fdffd792dcf9?s=128&d=identicon&r=PG&f=1", "display_name": "random_answer_guy", "link": "https://stackoverflow.com/users/6419727/random-answer-guy"}, "edited": false, "score": 0, "creation_date": 1469627060, "post_id": 38614530, "comment_id": 64615712, "body": "Do you have a Form_Load event for these Forms? Odd question I know, but at one point I had almost the same issue and simply adding a Form_Load event to the Form fixed it. No code in the event just a blank Form_Load..."}, {"owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "edited": false, "score": 0, "creation_date": 1472084765, "post_id": 38614530, "comment_id": 65615068, "body": "Usually the display messes up in two cases. #1, you have columns with null bits, and #2, you don\u2019t have a row version column. I would look into both. You also want to ensure in all cases you have a PK column."}, {"owner": {"reputation": 5814, "user_id": 4408538, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cPoEu.jpg?s=128&g=1", "display_name": "Joseph Wood", "link": "https://stackoverflow.com/users/4408538/joseph-wood"}, "edited": false, "score": 0, "creation_date": 1472290732, "post_id": 38614530, "comment_id": 65700722, "body": "@ThomasG, I noticed that you said the frontend is compiled. <code>Debug --&gt;&gt; Compile VBA Project</code> can really cause some strange behavior.  Yes, it checks syntax, but it also creates a lot of junk code that can cause your application to behave strangely. Check out <a href=\"http://stackoverflow.com/a/39108956/4408538\">this answer</a> for more info.  I suggest exporting all of your modules, forms, objects, etc. into a clean access file, and be sure to not compile."}, {"owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "reply_to_user": {"reputation": 5814, "user_id": 4408538, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cPoEu.jpg?s=128&g=1", "display_name": "Joseph Wood", "link": "https://stackoverflow.com/users/4408538/joseph-wood"}, "edited": false, "score": 0, "creation_date": 1472290814, "post_id": 38614530, "comment_id": 65700748, "body": "@JosephWood it happens even on accdb/not compiled version"}, {"owner": {"reputation": 5814, "user_id": 4408538, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cPoEu.jpg?s=128&g=1", "display_name": "Joseph Wood", "link": "https://stackoverflow.com/users/4408538/joseph-wood"}, "edited": false, "score": 0, "creation_date": 1472303835, "post_id": 38614530, "comment_id": 65704558, "body": "@ThomasG, have you ever tried exporting all modules, forms, etc. and subsequently import them into a new file? Also, not sure what you mean about the accdb/not compiled version. Are you saying that this file has never had the VBA compiler run on it? Just because you make some changes, don&#39;t run the VBA compiler, and save the file, doesn&#39;t mean it isn&#39;t completely &quot;compiled&quot; (i.e. there are still <code>OpCodes</code> and <code>ExCodes</code> lurking)."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 5814, "user_id": 4408538, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cPoEu.jpg?s=128&g=1", "display_name": "Joseph Wood", "link": "https://stackoverflow.com/users/4408538/joseph-wood"}, "edited": false, "score": 0, "creation_date": 1472469094, "post_id": 38614530, "comment_id": 65748633, "body": "@JosephWood: Never using &quot;Compile&quot; is hardly practical. The correct way to clean up compiled VBA code in Access is to run a full Decompile cycle as explained here: <a href=\"http://stackoverflow.com/a/3268188/3820271\">stackoverflow.com/a/3268188/3820271</a> -- Doing this may be worth a try, though."}, {"owner": {"reputation": 5814, "user_id": 4408538, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cPoEu.jpg?s=128&g=1", "display_name": "Joseph Wood", "link": "https://stackoverflow.com/users/4408538/joseph-wood"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1472474529, "post_id": 38614530, "comment_id": 65752040, "body": "@Andre, I think you misunderstand me. I compile my projects at least once an hour, but when I&#39;m sure my code is correct and everything is working fine, I immediately export all of my code, import it into a brand new file, attach any required libraries, and save it (without compiling as there is no need, the code is correct).  If you were to compile after this, all you would be doing is creating useless junk code that as I&#39;ve said many times, can cause strange behavior. This practice is endorsed by Rob Bovey as well as Chip Pearson.  And yes, you can do this in Access as well."}, {"owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1472475423, "post_id": 38614530, "comment_id": 65752602, "body": "I tried this as specified in the question : <i>Reimporting all objects in a fresh accdb doesn&#39;t solve the problem either.</i>  The issue isn&#39;t the code, it&#39;s something in the form object."}, {"owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 1, "creation_date": 1472475847, "post_id": 38614530, "comment_id": 65752902, "body": "In the meantime. I elegantly bypassed the issue: I added a <code>.QueryDAORS</code> method to my class abstracting ADO. It takes also a SQL query in input and return a recordset, but using DAO by creating a temp QUeryDef. I just had to redeclare my temp recordsets as DAO instead of ADODB and change the method called.  That was fast. I noticed that most of the forms that had the ADO display issue still refused to show the data. I had to recreate the forms from scratch prior to use the DAO method, and now they all work perfectly. I am sticking with this. The issue was at the form level for sure."}], "answers": [{"comments": [{"owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 1, "creation_date": 1469629212, "post_id": 38615152, "comment_id": 64617371, "body": "To add to the weirdness: On the same form I had 4 subforms with this problem. I added a Load event  to the first one. Recompiled, All subforms are magically working. I am telling to myself, &quot;<i>ok let\u2019s be smart and add a Load event to all the subforms</i>&quot;, I proceed, recompile, and there NO ONE were working again ! I then removed the Load event to all of them but the first one, recompiled, and all of them are working. I just don&#39;t know what the heck is this. MS Access is definitely not an exact science."}, {"owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1472037077, "post_id": 38615152, "comment_id": 65588907, "body": "Although, this saved me for a few days...the problem is back :-) I tried every possible combination of OnLoad/OnOpen events in various forms but nothing works and I am back at the problem root with 4 or 5 subforms not showing data. So I obviously keep the upvote on your proposal, but remove the answered mark because I want this question alive and I am willing to set a bounty on it."}], "tags": [], "owner": {"reputation": 836, "user_id": 6419727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e6f5532e6c9f3d91e56fdffd792dcf9?s=128&d=identicon&r=PG&f=1", "display_name": "random_answer_guy", "link": "https://stackoverflow.com/users/6419727/random-answer-guy"}, "is_accepted": false, "score": 7, "last_activity_date": 1469628077, "last_edit_date": 1469628077, "creation_date": 1469628047, "answer_id": 38615152, "question_id": 38614530, "link": "https://stackoverflow.com/questions/38614530/ado-recordset-data-not-showing-on-form/38615152#38615152", "title": "ADO Recordset data not showing on form", "body": "<p>I've had this same issue before and simply adding a blank <code>Form_Load</code> event solved the problem. No code needs to be with the <code>Form_Load</code> it just needs to be present.</p>\n"}, {"tags": [], "owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "is_accepted": false, "score": 1, "last_activity_date": 1472650304, "creation_date": 1472650304, "answer_id": 39251070, "question_id": 38614530, "link": "https://stackoverflow.com/questions/38614530/ado-recordset-data-not-showing-on-form/39251070#39251070", "title": "ADO Recordset data not showing on form", "body": "<p>So nobody could give at this stage a clear answer to the main question :</p>\n\n<blockquote>\n  <p><strong>Why is this bug happens ?</strong></p>\n</blockquote>\n\n<p>In the meantime I have \"elegantly\" bypassed the issue by changing the method used for the subforms encountering the bug, from ADO to DAO.</p>\n\n<p>I have created a new method in my ADO abstracting class, that actually use DAO to return a recordset (not logical, but hey...).</p>\n\n<p>The code where I pass data to the form becomes :</p>\n\n<pre><code>        Set RST = Nothing\n        Set RST = Oracle_CON.QueryDAORS(SQL)\n\n        If Not RST Is Nothing Then\n            Set Form_the_form_name.Recordset = RST\n        End If\n</code></pre>\n\n<p>And here's the method <code>QueryDAORS</code> called :</p>\n\n<pre><code>Public Function QueryDAORS(ByVal SQL As String, Optional strTitle As String) As DAO.Recordset\n\n    Dim RS As DAO.Recordset\n    Dim dtTemp As Date\n    Dim strErrNumber As Long\n    Dim strErrDesc As String\n    Dim intSeconds As Long\n\n    Dim Param As Variant\n\n    On Error GoTo Query_Error\n\n    dtTemp = Now\n\n    If DBcon.state &lt;&gt; adStateOpen Then\n        Set QueryDAORS = Nothing\n    Else\n        DoCmd.Hourglass True\n\n        Set pQDEF = CurrentDb.CreateQueryDef(\"\")\n\n        pQDEF.Connect = pPassThroughString\n        pQDEF.ODBCTimeout = pTimeOut\n        pQDEF.SQL = SQL\n\n        pLastRows = 0\n        pLastSQL = SQL\n        pLastError = \"\"\n        pLastSeconds = 0\n\n\n        LogIt SQL, strTitle, , True\n\n\n        Set RS = pQDEF.OpenRecordset(dbOpenSnapshot)\n\n        intSeconds = DateDiff(\"s\", dtTemp, Now)\n\n        If RS.EOF Then\n            LogIt \"-- \" &amp; Format(Now, \"hh:nn:ss\") &amp; \" | Executed in \" &amp; intSeconds &amp; \" second\" &amp; IIf(intSeconds = 1, \"\", \"s\") &amp; \" | Now rows returned.\"\n            Set QueryDAORS = Nothing\n        Else\n            RS.MoveLast\n            pLastRows = RS.RecordCount\n            LogIt \"-- \" &amp; Format(Now, \"hh:nn:ss\") &amp; \" | Executed in \" &amp; intSeconds &amp; \" second\" &amp; IIf(intSeconds = 1, \"\", \"s\") &amp; \" | \" &amp; RS.RecordCount &amp; \" row\" &amp; IIf(RS.RecordCount = 1, \"\", \"s\") &amp; \" returned.\"\n            RS.MoveFirst\n            Set QueryDAORS = RS\n        End If\n\n    End If\n\nExit_Sub:\n    pLastSeconds = intSeconds\n    Set RS = Nothing\n\n    DoCmd.Hourglass False\n\n    Exit Function\n\nQuery_Error:\n\n    intSeconds = DateDiff(\"s\", dtTemp, Now)\n\n    strErrNumber = Err.Number\n    strErrDesc = Err.DESCRIPTION\n    pLastError = strErrDesc\n\n    MsgBox strErrDesc, vbCritical, \"Error \" &amp; pDSN\n\n    LogIt strErrDesc, , \"ERROR\"\n\n    Set QueryDAORS = Nothing\n    Resume Exit_Sub\n    Resume\nEnd Function\n</code></pre>\n\n<p>The property <code>pPassThroughString</code> is defined with another Method using the properties that I already had at my disposal in the class, because they were neccessary to open an ADO connection to the database :</p>\n\n<pre><code>Private Function pPassThroughString() As String\n\n    Select Case pRDBMS\n\n        Case \"Oracle\"\n            pPassThroughString = \"ODBC;DSN=\" &amp; pDSN &amp; \";UID=\" &amp; pUsername &amp; \";Pwd=\" &amp; XorC(pXPassword, CYPHER_KEY)\n\n        Case \"MS SQL\"\n            pPassThroughString = \"ODBC;DSN=\" &amp; pDSN &amp; \";DATABASE=\" &amp; pDBname &amp; \";Trusted_Connection=Yes\"\n\n        Case \"Sybase\"\n            pPassThroughString = \"ODBC;DSN=\" &amp; pDSN &amp; \";\"\n\n        Case Else\n            MsgBox \"RDBMS empty ! \", vbExclamation\n            LogIt \"RDBMS empty ! \", , \"ERROR\"\n\n    End Select\n\nEnd Function\n</code></pre>\n\n<p>So the issue was solved rapidly by just changing the recordset assigned to the forms from <code>ADODB.Recordset</code> to <code>DAO.recordset</code> and adapting the method called from <code>.OpenRS</code> to <code>.OpenDAORS</code>.</p>\n\n<p>The only con is that with DAO I can't use this anymore to disconnect the recordset: </p>\n\n<p><code>Set RST.ActiveConnection = Nothing</code> </p>\n\n<p>Still, I would have prefered to get an explanation and fix :(</p>\n"}], "owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1452, "favorite_count": 1, "answer_count": 2, "score": 10, "last_activity_date": 1472650304, "creation_date": 1469626512, "last_edit_date": 1472039438, "question_id": 38614530, "link": "https://stackoverflow.com/questions/38614530/ado-recordset-data-not-showing-on-form", "title": "ADO Recordset data not showing on form", "body": "<p>I've got a frustrating issue on MS Access 2010 that I would at this stage qualify as a bug. And after having tried all possible workarounds, I am out of ideas and rely on you.</p>\n\n<hr>\n\n<h2>Context</h2>\n\n<p>Huge Ms Access 2010 application with 25k lines of VBA and >50 forms. It has a client server architecture with a frontend compiled and an Access backend on the network. It makes connections to a twentish of different databases (Oracle/SQL Server/Sybase IQ).</p>\n\n<hr>\n\n<h2>The problem</h2>\n\n<p>Sometimes when I assign an ADODB recordset to a subform, its data isn't shown in bound fields. I've got <code>#Name?</code> everywhere</p>\n\n<p><strong>The data is there.</strong> I can <code>debug.print</code> it, I can see it in the Watches browser, I can read or manipulate it while looping on the recordset object with code. It just not appear in the subform.</p>\n\n<p>It can work flawlessly during months, and suddenly one form will start having this issue without any apparent reason (it might happen even on forms that  I have not changed). When it happens, it does for all users, so this is really something wrong in the frontend accdb/accde.</p>\n\n<p>The issue is not related to a specific DBMS/Driver. It can happen with Oracle or Sybase data.</p>\n\n<p>I have created my own class abstracting everything related to ADO connections and queries, and use the same technique everywhere. I've got several tenth of forms based on it and most of them works perfectly.</p>\n\n<p>I have this issue in several parts of my application, and especially in a highly complicated form with lots of subforms and code.\nOn this Main form, a few subforms have the issue, while others don't. And they have the exact same parameters.</p>\n\n<hr>\n\n<h2>The Code</h2>\n\n<p>This is how I populate a form's recordset :</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>        Set RST = Nothing\n        Set RST = New ADODB.Recordset\n        Set RST = Oracle_CON.QueryRS(SQL)\n\n        If Not RST Is Nothing Then\n            Set RST.ActiveConnection = Nothing\n            Set Form_the_form_name.Recordset = RST\n        End If\n</code></pre>\n\n<p>The code called with <code>Oracle_CON.QueryRS(SQL)</code> is</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Function QueryRS(ByVal SQL As String, Optional strTitle As String) As ADODB.Recordset\n\n    Dim dbQuery As ADODB.Command\n    Dim Output As ADODB.Recordset\n    Dim dtTemp As Date\n    Dim strErrNumber As Long\n    Dim strErrDesc As String\n    Dim intSeconds As Long\n\n    Dim Param As Variant\n\n    If DBcon.state &lt;&gt; adStateOpen Then\n        Set QueryRS = Nothing\n    Else\n        DoCmd.Hourglass True\n\n        pLastRows = 0\n        pLastSQL = SQL\n        pLastError = \"\"\n        pLastSeconds = 0\n\n        Set dbQuery = New ADODB.Command\n        dbQuery.ActiveConnection = DBcon\n        dbQuery.CommandText = SQL\n        dbQuery.CommandTimeout = pTimeOut\n\n        Set Output = New ADODB.Recordset\n\n        LogIt SQL, strTitle\n\n        dtTemp = Now\n\n        On Error GoTo Query_Error\n\n        With Output\n            .LockType = adLockPessimistic\n            .CursorType = adUseClient\n            .CursorLocation = adUseClient\n            .Open dbQuery\n        End With\n\n        intSeconds = DateDiff(\"s\", dtTemp, Now)\n\n        If Output.EOF Then\n            LogIt \"-- \" &amp; Format(Now, \"hh:nn:ss\") &amp; \" | Executed in \" &amp; intSeconds &amp; \" second\" &amp; IIf(intSeconds = 1, \"\", \"s\") &amp; \" | Now rows returned.\"\n            Set QueryRS = Nothing\n        Else\n            Output.MoveLast\n            pLastRows = Output.RecordCount\n            LogIt \"-- \" &amp; Format(Now, \"hh:nn:ss\") &amp; \" | Executed in \" &amp; intSeconds &amp; \" second\" &amp; IIf(intSeconds = 1, \"\", \"s\") &amp; \" | \" &amp; Output.RecordCount &amp; \" row\" &amp; IIf(Output.RecordCount = 1, \"\", \"s\") &amp; \" returned.\"\n            Output.MoveFirst\n            Set QueryRS = Output\n        End If\n\n    End If\n\nExit_Sub:\n    pLastSeconds = intSeconds\n    Set Output = Nothing\n    Set Parameter = Nothing\n    Set dbQuery = Nothing\n\n    DoCmd.Hourglass False\n\n    Exit Function\n\nQuery_Error:\n\n    intSeconds = DateDiff(\"s\", dtTemp, Now)\n\n    strErrNumber = Err.Number\n    strErrDesc = Err.DESCRIPTION\n    pLastError = strErrDesc\n\n    MsgBox strErrDesc, vbCritical, \"Error \" &amp; pDSN\n\n    LogIt strErrDesc, , \"ERROR\"\n\n    Set QueryRS = Nothing\n    Resume Exit_Sub\n    Resume\nEnd Function\n</code></pre>\n\n<hr>\n\n<h2>Things I tried so far</h2>\n\n<p>For the recordsets I tried every possible variation of </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>            .LockType = adLockPessimistic\n            .CursorType = adUseClient\n            .CursorLocation = adUseClient\n</code></pre>\n\n<p>The subforms handling the recordsets have all a <code>Snapshot</code> recordsettype, problem remains if I try <code>dynaset</code>. \nDataentry, Addition, deletion, edits are all disabled. It's pure read-only.</p>\n\n<p>I have a habit of disconnecting the recordsets using <code>RST.ActiveConnection = Nothing</code> so I can manipulate them afterwards, but this doesn't impact the problem either.</p>\n\n<p>It can happens with very simple queries with only one field in the <code>SELECT</code> clause and only one field bound to it on a subform.</p>\n\n<p>Reimporting all objects in a fresh accdb doesn't solve the problem either.</p>\n\n<p><strong>The solution proposed by <em>random_answer_guy</em> worked at first glance, which accreditate the bug hypothesis. Unfortunately my problems reappeared after some (totaly unrelated) changes in the main form. I am back with 4 or 5 subforms not showing data and adding/removing a Load event on all or part of them doesn't make any difference anymore</strong></p>\n\n<p>If you want more information about how weird is this issue, I advise you to read my comment on <em>random_answer_guy</em>'s answer.</p>\n\n<hr>\n\n<h2>To conclude</h2>\n\n<p>What is extremely frustrating is that I can have 2 different forms with exactly the same properties and same fields, same SQL instruction over the same DB, same recordset management code: One is showing the data and the other doesn't !</p>\n\n<p>When the problem happens, I have no other choice than erasing all objects manipulated and reimporting them from an older version or recreate them from scratch.</p>\n\n<p>If this is not a bug, I am still looking for the proper word to qualify it. </p>\n\n<p>Does anyone ever experienced the issue and has an explanation and/or a workaround to propose ?</p>\n"}, {"tags": ["sql-server", "excel", "date", "error-handling", "vba"], "comments": [{"owner": {"reputation": 13, "user_id": 6163052, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/2e78150c8ebb948f70b992e61fa1f78d?s=128&d=identicon&r=PG&f=1", "display_name": "agfila", "link": "https://stackoverflow.com/users/6163052/agfila"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1469626819, "post_id": 38614525, "comment_id": 64615543, "body": "@pnuts there&#39;s 375 right now"}, {"owner": {"reputation": 3490, "user_id": 6409000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38328843112bd53b47163ced38402a75?s=128&d=identicon&r=PG", "display_name": "Cato", "link": "https://stackoverflow.com/users/6409000/cato"}, "edited": false, "score": 1, "creation_date": 1469627338, "post_id": 38614525, "comment_id": 64615904, "body": "is the error coming from usp_RankingReport in SQL?  Does it do any dividing?  Or is the data you are putting into Excel doing any divide by zero in a cell formula?"}, {"owner": {"reputation": 13, "user_id": 6163052, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/2e78150c8ebb948f70b992e61fa1f78d?s=128&d=identicon&r=PG&f=1", "display_name": "agfila", "link": "https://stackoverflow.com/users/6163052/agfila"}, "reply_to_user": {"reputation": 3490, "user_id": 6409000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38328843112bd53b47163ced38402a75?s=128&d=identicon&r=PG", "display_name": "Cato", "link": "https://stackoverflow.com/users/6409000/cato"}, "edited": false, "score": 0, "creation_date": 1469627731, "post_id": 38614525, "comment_id": 64616216, "body": "@AndrewDeighton The stored proc does some division, but it&#39;s not giving any errors when I execute it. The data is currently null for most columns but I&#39;ve run my excel macro with null data before and it hasn&#39;t been an issue. There&#39;re also no formulas doing devision"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 3490, "user_id": 6409000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38328843112bd53b47163ced38402a75?s=128&d=identicon&r=PG", "display_name": "Cato", "link": "https://stackoverflow.com/users/6409000/cato"}, "edited": false, "score": 0, "creation_date": 1469628217, "post_id": 38614525, "comment_id": 64616583, "body": "I&#39;m with @AndrewDeighton on this one - I suspect the issue is in <code>usp_RankingReport </code>, not in your VBA."}, {"owner": {"reputation": 3490, "user_id": 6409000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38328843112bd53b47163ced38402a75?s=128&d=identicon&r=PG", "display_name": "Cato", "link": "https://stackoverflow.com/users/6409000/cato"}, "edited": false, "score": 0, "creation_date": 1469628327, "post_id": 38614525, "comment_id": 64616649, "body": "how does the error appear?  Does it pop up in a message box in Excel?  Could you be sending a zero to the stored procedure?  Could you build the stored procedure into a string then display it?  Normally a formula in excel divide by zero creates a #div0 cell - I can&#39;t say it isn&#39;t something to do with the range copy having a bad value in it somewhere"}, {"owner": {"reputation": 13, "user_id": 6163052, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/2e78150c8ebb948f70b992e61fa1f78d?s=128&d=identicon&r=PG&f=1", "display_name": "agfila", "link": "https://stackoverflow.com/users/6163052/agfila"}, "reply_to_user": {"reputation": 3490, "user_id": 6409000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38328843112bd53b47163ced38402a75?s=128&d=identicon&r=PG", "display_name": "Cato", "link": "https://stackoverflow.com/users/6409000/cato"}, "edited": false, "score": 0, "creation_date": 1469632561, "post_id": 38614525, "comment_id": 64619948, "body": "@Andrew It appears as a pop up in excel. If I&#39;m sending a zero to the stored procedure I have no idea how. The date is set 2 Saturdays ago from today (the formula in cell 2,2 in the vba) and after playing around with it, the only date that doesn&#39;t work is 7/16/2016. The Saturday before and after both work(the 30th just giving me nulls as I expected)."}, {"owner": {"reputation": 3490, "user_id": 6409000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38328843112bd53b47163ced38402a75?s=128&d=identicon&r=PG", "display_name": "Cato", "link": "https://stackoverflow.com/users/6409000/cato"}, "edited": false, "score": 0, "creation_date": 1469633385, "post_id": 38614525, "comment_id": 64620518, "body": "is there any way you can test the stored procedure with the values causing problems?  You can right click on the stored procedure in SQL management studio and &#39;execute&#39; then add your parameter values, that&#39;s all i can think of - sorry if it;s a red herring  tho"}, {"owner": {"reputation": 13, "user_id": 6163052, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/2e78150c8ebb948f70b992e61fa1f78d?s=128&d=identicon&r=PG&f=1", "display_name": "agfila", "link": "https://stackoverflow.com/users/6163052/agfila"}, "reply_to_user": {"reputation": 3490, "user_id": 6409000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38328843112bd53b47163ced38402a75?s=128&d=identicon&r=PG", "display_name": "Cato", "link": "https://stackoverflow.com/users/6409000/cato"}, "edited": false, "score": 0, "creation_date": 1469633603, "post_id": 38614525, "comment_id": 64620690, "body": "@AndrewDeighton Yes I tried that it executes with no problems in SSMS, thank you for your help though!"}], "owner": {"reputation": 13, "user_id": 6163052, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/2e78150c8ebb948f70b992e61fa1f78d?s=128&d=identicon&r=PG&f=1", "display_name": "agfila", "link": "https://stackoverflow.com/users/6163052/agfila"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1469626501, "creation_date": 1469626501, "last_edit_date": 1531161705, "question_id": 38614525, "link": "https://stackoverflow.com/questions/38614525/divde-by-0-error-with-query-in-excel", "title": "Divde by 0 Error with Query in Excel", "body": "<p>I'm running a stored procedure from Excel to output the data onto a spreadsheet. The automated test I created worked flawlessly until today when I got a \"division by 0 error\" message. The date is stored as a smalldatetime in sql and I can't change this as I don't have that level of access to the database. The code where I get an error is on the line beginning with Sheet1.Range:</p>\n\n<pre><code>curDate = ThisWorkbook.Sheets(\"Tech_Penetrate_Report_Data\").Cells(2,   2).Value\n\n\nWith rsTIP1\n.ActiveConnection = cnTIP\n.Open \"exec usp_RankingReport @Node_Id = 03,@Subsidiary_Cd = '001',@WeekEndDate = '\" &amp; curDate &amp; \"', @JobType = '1060',@ReportLevel = 1\"\nSheet1.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0).CopyFromRecordset rsTIP1\n.Close\n</code></pre>\n\n<p>End With</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1469625618, "post_id": 38614113, "comment_id": 64614613, "body": "I will assume this is for practice.  <code>=GetContent(&quot;Sheet1&quot;,&quot;B6&quot;)</code> since strings are required, they must be in quotes.  but <code>=Sheet1!B6</code> does it now without vba."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1469625658, "post_id": 38614113, "comment_id": 64614652, "body": "Also make sure the code is in a module attached to the workbook and not worksheet or ThisWorbook code."}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1469625809, "post_id": 38614113, "comment_id": 64614759, "body": "@ScottCraner not an issue with the strings being typed without quotes (vba will convert them to the string type since its specified in the function).  Look carefully in the screenshot and you&#39;ll see OP didn&#39;t capitalize, so the sheet wasn&#39;t found"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1469627162, "post_id": 38614113, "comment_id": 64615798, "body": "@RGA that would be true if the OP was referencing cells that contained the strings. But as he/she is typing them directly in the formula it must have the quotes. Otherwise how is excel to know that the B6 is the reference and not the contents in B6 on that page."}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1469627360, "post_id": 38614113, "comment_id": 64615921, "body": "@ScottCraner ahh I missed that.  Good spot"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 5327581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7586bf068b28284502c577d3cdd2fbd?s=128&d=identicon&r=PG&f=1", "display_name": "Roshan Aravinda", "link": "https://stackoverflow.com/users/5327581/roshan-aravinda"}, "is_accepted": true, "score": 0, "last_activity_date": 1469637331, "creation_date": 1469637331, "answer_id": 38618671, "question_id": 38614113, "link": "https://stackoverflow.com/questions/38614113/get-cell-content-in-one-sheet-to-another/38618671#38618671", "title": "Get Cell Content in one sheet to another", "body": "<p>I've found the answer. My function must be correct as following code.</p>\n\n<pre><code>Function GetContent(sheetName As String, cellAddress As String) As String\n    GetContent = ActiveWorkbook.Sheets(sheetName).Range(cellAddress)\nEnd Function\n</code></pre>\n\n<p>I didn't concern abot the function name and return as the same. But we have to must do it. Also in string data type we have use quotaions and Case sensitive. So thanks all of you for valuable help. It helps me to fid out the answer. Now wecan use the functions as follows.</p>\n\n<pre><code>=GetContent(\"Sheet2\",\"b5\")\n</code></pre>\n\n<p>Thank You!</p>\n"}], "owner": {"reputation": 11, "user_id": 5327581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7586bf068b28284502c577d3cdd2fbd?s=128&d=identicon&r=PG&f=1", "display_name": "Roshan Aravinda", "link": "https://stackoverflow.com/users/5327581/roshan-aravinda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 38618671, "answer_count": 1, "score": -1, "last_activity_date": 1469637331, "creation_date": 1469625428, "last_edit_date": 1531164843, "question_id": 38614113, "link": "https://stackoverflow.com/questions/38614113/get-cell-content-in-one-sheet-to-another", "title": "Get Cell Content in one sheet to another", "body": "<p>I need to get my cell content in excel worksheet to another worksheet by using a user defined function. So I searched stackoverflow and found the following vba code.</p>\n\n<pre><code>Function GetValue(sheetName As String, cellAddress As String) As Variant\n   GetSheetValue = ThisWorkbook.Sheets(sheetName).Range(cellAddress)\nEnd Function\n</code></pre>\n\n<p>This is the right thing i expected.But it doesn't work for me. I need to develop a user defined function as like follows.</p>\n\n<pre><code>=GetContent(Sheet1,B6)\n</code></pre>\n\n<p>I've tried many things but I can't do it. So I'm very appriciate any responses about this matter. (Provide Screenshots about my example)</p>\n\n<p>Thank You\n<a href=\"http://i.stack.imgur.com/Wexm6.png\" rel=\"nofollow\">ScreenShot 02</a>\n<a href=\"http://i.stack.imgur.com/BPLOC.png\" rel=\"nofollow\">ScreenShot 03</a></p>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1469625345, "post_id": 38614062, "comment_id": 64614384, "body": "Why is this tagged &quot;access&quot; if you&#39;re talking about Excel?"}, {"owner": {"reputation": 43, "user_id": 5214068, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/514911038666475/picture?type=large", "display_name": "Tarik Kaoukab", "link": "https://stackoverflow.com/users/5214068/tarik-kaoukab"}, "reply_to_user": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1469625431, "post_id": 38614062, "comment_id": 64614447, "body": "im in fact using all this in access, I&#39;m opening the excel application using vba and getting some data out of it to my tables"}, {"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 2, "creation_date": 1469625471, "post_id": 38614062, "comment_id": 64614496, "body": "Ohh and you didn&#39;t think it was relevant to mention that??  I assumed you were doing it all from within Excel based on your question, because you didn&#39;t say otherwise."}, {"owner": {"reputation": 43, "user_id": 5214068, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/514911038666475/picture?type=large", "display_name": "Tarik Kaoukab", "link": "https://stackoverflow.com/users/5214068/tarik-kaoukab"}, "reply_to_user": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1469625562, "post_id": 38614062, "comment_id": 64614563, "body": "well it changes almost nothing..."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 5214068, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/514911038666475/picture?type=large", "display_name": "Tarik Kaoukab", "link": "https://stackoverflow.com/users/5214068/tarik-kaoukab"}, "edited": false, "score": 0, "creation_date": 1469625721, "post_id": 38614110, "comment_id": 64614694, "body": "@RGA I did try that, but the processus are always there...and I&#39;m using multiple workbooks"}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "reply_to_user": {"reputation": 43, "user_id": 5214068, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/514911038666475/picture?type=large", "display_name": "Tarik Kaoukab", "link": "https://stackoverflow.com/users/5214068/tarik-kaoukab"}, "edited": false, "score": 0, "creation_date": 1469625849, "post_id": 38614110, "comment_id": 64614783, "body": "@TarikKaoukab what do you mean by &quot;processes are always there&quot;?"}, {"owner": {"reputation": 43, "user_id": 5214068, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/514911038666475/picture?type=large", "display_name": "Tarik Kaoukab", "link": "https://stackoverflow.com/users/5214068/tarik-kaoukab"}, "edited": false, "score": 0, "creation_date": 1469625922, "post_id": 38614110, "comment_id": 64614841, "body": "I still can see the EXCEL proccessus in task Manager"}], "tags": [], "owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "is_accepted": false, "score": 1, "last_activity_date": 1469625415, "creation_date": 1469625415, "answer_id": 38614110, "question_id": 38614062, "link": "https://stackoverflow.com/questions/38614062/exit-excel-session-from-access-vba-without-saving/38614110#38614110", "title": "exit excel session from Access VBA without saving", "body": "<p>Two ways to do this.  First, set the display alerts to false. Second, set the save state to true.  Both are equivalent, though the second will require a loop if multiple workbooks are open, so the first is recommended (and included below)</p>\n\n<pre><code>Application.DisplayAlerts = False\nApplication.Quit\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 5214068, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/514911038666475/picture?type=large", "display_name": "Tarik Kaoukab", "link": "https://stackoverflow.com/users/5214068/tarik-kaoukab"}, "edited": false, "score": 0, "creation_date": 1469625793, "post_id": 38614164, "comment_id": 64614746, "body": "<b>ThisWorkbook.Saved = True</b>     saves the file ?"}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "reply_to_user": {"reputation": 43, "user_id": 5214068, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/514911038666475/picture?type=large", "display_name": "Tarik Kaoukab", "link": "https://stackoverflow.com/users/5214068/tarik-kaoukab"}, "edited": false, "score": 0, "creation_date": 1469625932, "post_id": 38614164, "comment_id": 64614856, "body": "@TarikKaoukab no, it marks the file as &quot;saved&quot; even when it isn&#39;t so that you are not prompted to save"}, {"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "reply_to_user": {"reputation": 43, "user_id": 5214068, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/514911038666475/picture?type=large", "display_name": "Tarik Kaoukab", "link": "https://stackoverflow.com/users/5214068/tarik-kaoukab"}, "edited": false, "score": 0, "creation_date": 1469625945, "post_id": 38614164, "comment_id": 64614869, "body": "@TarikKaoukab Because the Saved property is set to True, Excel responds as though the workbook has already been saved and no changes have occurred since that last save. <a href=\"https://support.microsoft.com/en-us/kb/213428\" rel=\"nofollow noreferrer\">check this page</a>"}, {"owner": {"reputation": 43, "user_id": 5214068, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/514911038666475/picture?type=large", "display_name": "Tarik Kaoukab", "link": "https://stackoverflow.com/users/5214068/tarik-kaoukab"}, "edited": false, "score": 0, "creation_date": 1469626049, "post_id": 38614164, "comment_id": 64614941, "body": "great, I get the idea, but it says that the method thisworkbook.save has failed"}, {"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "reply_to_user": {"reputation": 43, "user_id": 5214068, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/514911038666475/picture?type=large", "display_name": "Tarik Kaoukab", "link": "https://stackoverflow.com/users/5214068/tarik-kaoukab"}, "edited": false, "score": 0, "creation_date": 1469626858, "post_id": 38614164, "comment_id": 64615567, "body": "@TarikKaoukab added another ex"}, {"owner": {"reputation": 43, "user_id": 5214068, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/514911038666475/picture?type=large", "display_name": "Tarik Kaoukab", "link": "https://stackoverflow.com/users/5214068/tarik-kaoukab"}, "edited": false, "score": 0, "creation_date": 1469627093, "post_id": 38614164, "comment_id": 64615736, "body": "I Found the answer and I just posted it, thanks a lot @Krib"}], "tags": [], "owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "is_accepted": true, "score": 2, "last_activity_date": 1469626840, "last_edit_date": 1469626840, "creation_date": 1469625544, "answer_id": 38614164, "question_id": 38614062, "link": "https://stackoverflow.com/questions/38614062/exit-excel-session-from-access-vba-without-saving/38614164#38614164", "title": "exit excel session from Access VBA without saving", "body": "<p>This code will hide the prompt and close without saving</p>\n\n<pre><code>Sub CloseActiveBook()\nApplication.DisplayAlerts = False\nActiveWorkbook.Close\nApplication.DisplayAlerts = True\nEnd Sub\n</code></pre>\n\n<p>Or force it</p>\n\n<pre><code>Sub Auto_Close()\nThisWorkbook.Saved = True\nEnd Sub\n</code></pre>\n\n<p>This example closes Book1.xls and discards any changes that have been made to it.</p>\n\n<pre><code>Sub saveWNoChanges ()\nWorkbooks(\"BOOK1.XLS\").Close SaveChanges:=False\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1469627081, "post_id": 38614680, "comment_id": 64615727, "body": "Glad to help. You can show your appreciation by accepting the answer ;)"}], "tags": [], "owner": {"reputation": 43, "user_id": 5214068, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/514911038666475/picture?type=large", "display_name": "Tarik Kaoukab", "link": "https://stackoverflow.com/users/5214068/tarik-kaoukab"}, "is_accepted": false, "score": 0, "last_activity_date": 1469626930, "creation_date": 1469626930, "answer_id": 38614680, "question_id": 38614062, "link": "https://stackoverflow.com/questions/38614062/exit-excel-session-from-access-vba-without-saving/38614680#38614680", "title": "exit excel session from Access VBA without saving", "body": "<p>Combining with what Mr.krib has said, ThisWorkbook.Saved = True is working if you change <strong>ThisWorkbook</strong> to the <strong>name_of_your_instance_Excel.ActiveWorkbook</strong>\nfor example:</p>\n\n<pre><code>Set myxl = CreateObject(\"Excel.Application\")\nmyxl.ActiveWorkbook.saved= True\n</code></pre>\n\n<p>P.S: It works for multiple workbooks as well!</p>\n\n<p>Thank you @Krib</p>\n"}], "owner": {"reputation": 43, "user_id": 5214068, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/514911038666475/picture?type=large", "display_name": "Tarik Kaoukab", "link": "https://stackoverflow.com/users/5214068/tarik-kaoukab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6548, "favorite_count": 0, "accepted_answer_id": 38614164, "answer_count": 3, "score": 1, "last_activity_date": 1593958196, "creation_date": 1469625273, "last_edit_date": 1593958196, "question_id": 38614062, "link": "https://stackoverflow.com/questions/38614062/exit-excel-session-from-access-vba-without-saving", "title": "exit excel session from Access VBA without saving", "body": "<p>I have been looking for a solution of exiting excel using vba and kill it's processus, but I still can't find  any solution, the methods discussed in here are about hiding the saving prompt, but how can I exit an excel application (not only the instance) without saving and of course, stop its execution?\nThank you</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "edited": false, "score": 0, "creation_date": 1469625678, "post_id": 38614046, "comment_id": 64614661, "body": "Where is the <code>Sub Form_Timer()</code> section of code?  That&#39;s where the text clearing magic will happen. <a href=\"https://msdn.microsoft.com/en-us/library/office/ff836371.aspx\" rel=\"nofollow noreferrer\">check this out</a>"}, {"owner": {"reputation": 365, "user_id": 4890963, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-736h1CBQBh8/AAAAAAAAAAI/AAAAAAAABbc/4ybXk5rbcb4/photo.jpg?sz=128", "display_name": "CyberClaw", "link": "https://stackoverflow.com/users/4890963/cyberclaw"}, "edited": false, "score": 0, "creation_date": 1469630685, "post_id": 38614046, "comment_id": 64618577, "body": "What Jimmy Smith said. I&#39;ll comment on your code though.. So, txtoutput can be a string, a int, and a boolean? That&#39;s just asking for trouble. You should require variable declaration. (VBA Window, Tools&gt;Options). Without variable declaration, a mistype will have you working on 2 different variables, like var1 and va1 and will produce errors hard to track. You should use End Ifs even for single lines split by _  I didn&#39;t either, until missing a underscore and messing up my code (and having a hard time finding the error in thousands of lines). The End If makes it way more readable."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 365, "user_id": 4890963, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-736h1CBQBh8/AAAAAAAAAAI/AAAAAAAABbc/4ybXk5rbcb4/photo.jpg?sz=128", "display_name": "CyberClaw", "link": "https://stackoverflow.com/users/4890963/cyberclaw"}, "edited": false, "score": 0, "creation_date": 1469636231, "post_id": 38614046, "comment_id": 64622440, "body": "@CyberClaw - your suggestions are not that applicable. He already has Option Explicit at top of code. txtoutput is a control that takes any form of text. If / Endif is a nice suggestion but has nothing to do with his Timer question"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1469636346, "post_id": 38614046, "comment_id": 64622504, "body": "@Matt - are you allowed to use an API call. The Sleep function is very straight forward to declare and to use and makes it very simple to apply a &quot;delay - then do something&quot; in your code"}, {"owner": {"reputation": 365, "user_id": 4890963, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-736h1CBQBh8/AAAAAAAAAAI/AAAAAAAABbc/4ybXk5rbcb4/photo.jpg?sz=128", "display_name": "CyberClaw", "link": "https://stackoverflow.com/users/4890963/cyberclaw"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1469809741, "post_id": 38614046, "comment_id": 64707889, "body": "@dbmitch - my comment refered to things that would make his code not work (even if they were not the source of the question, which like I said, Jimmy identified).  He has the option explicit but he didn&#39;t dim the Text var, possibly others. He also had 2 if then, and the commands on another line, without a underscore. nor a end if.   He assigns what I assume is a string to the txtoutput, compares it to a integer on a if, and then assigns a boolean to the control. He doesn&#39;t use Me., a text input box can&#39;t have a boolean, but that&#39;s a moot point because the if would always be false anyhow..."}], "answers": [{"tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1469636994, "creation_date": 1469636994, "answer_id": 38618567, "question_id": 38614046, "link": "https://stackoverflow.com/questions/38614046/auto-clear-text-entry-in-vba/38618567#38618567", "title": "Auto-Clear Text Entry in VBA", "body": "<p>Assuming you can use API call - I like this method better.</p>\n\n<p>You can just toggle your text control to visible/invisible </p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\n' Simple delay mechanism using Win32 API\nPrivate Declare Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long)\n\nPrivate Sub cmdShow_Click()\n    txtOutput.Visible = true\nEnd Sub\n\n\nPrivate Sub Form_Load()\n\n    txtOutput.Value = \"hello world\"\n\n    Sleep 5000 ' 5000 milliseconds = 5 second delay\n    txtOutput.Visible = false\n\nEnd Sub\n\n\nPrivate Sub cmdCheck_click()\n\n    Dim guess As Integer\n\n    guess = InStr(txtOutput.Value, txtInput.Value)\n    If guess = 0 Then\n        txtResult.Value = \"You're terrible at this game\"\n    Else\n        txtResult.Value = \"Good find!\"\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6545494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73e07e2fa89a4622a339030869c3c97b?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/6545494/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594641662, "creation_date": 1469625234, "last_edit_date": 1594641662, "question_id": 38614046, "link": "https://stackoverflow.com/questions/38614046/auto-clear-text-entry-in-vba", "title": "Auto-Clear Text Entry in VBA", "body": "<p>I am trying to finish a project in my VBA class and am stuck. I've created the program for most of the word search however I cannot get the timerInterval function to work. The challenge and code are below:</p>\n\n<ol start=\"3\">\n<li>Create a word search game that allows a user to view a string of characters for a predetermined amount of time (say 5 to 10 seconds). Build a timer to accomplish this. After time is up, hide the string of characters and prompt the user to enter one or more words he saw in the string. For example, the string of characters keoixakaccessqcinmsboxeamlz contains the words access and box. Use the InStr function to determine whether the user\u2019s guess is contained in the word search string.</li>\n</ol>\n\n<hr>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPrivate Sub cmdShow_Click()\ntxtOutput.Value = \"hello world\"\nEnd Sub\n\n\n\n\nPrivate Sub Form_Load()\ntxtOutput.Caption = Text\nIf txtOutput.DefaultValue = Text Then\nMe.TimerInterval = 5000\nIf txtOutput = 0 Then\ntxtOutput = False\n\n\nEnd Sub\n\n\nPrivate Sub cmdCheck_click()\nDim guess As Integer\nguess = InStr(txtOutput.Value, txtInput.Value)\nIf guess = 0 Then\n    txtResult.Value = \"You're terrible at this game\"\nElse\n    txtResult.Value = \"Good find!\"\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "forms", "ms-access"], "comments": [{"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1469625482, "post_id": 38613802, "comment_id": 64614507, "body": "do you have <code>liste91</code> as a control in two different forms?"}, {"owner": {"reputation": 115, "user_id": 1967649, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3UVDJ.jpg?s=128&g=1", "display_name": "oppia04", "link": "https://stackoverflow.com/users/1967649/oppia04"}, "reply_to_user": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1469626170, "post_id": 38613802, "comment_id": 64615033, "body": "no, I have only one form (projects). In this form I created a list without connection, just to show, just to know what is in. In the same form I want to fill new data in (text field) e.g project catagories. When I enter the text field the list should get visible."}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 1967649, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3UVDJ.jpg?s=128&g=1", "display_name": "oppia04", "link": "https://stackoverflow.com/users/1967649/oppia04"}, "edited": false, "score": 0, "creation_date": 1469631726, "post_id": 38615968, "comment_id": 64619360, "body": "with &quot;me.&quot; it doesnt work. but forms! projects! list91.visible=true its fine. Thank you!"}], "tags": [], "owner": {"reputation": 365, "user_id": 4890963, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-736h1CBQBh8/AAAAAAAAAAI/AAAAAAAABbc/4ybXk5rbcb4/photo.jpg?sz=128", "display_name": "CyberClaw", "link": "https://stackoverflow.com/users/4890963/cyberclaw"}, "is_accepted": true, "score": 1, "last_activity_date": 1469629960, "creation_date": 1469629960, "answer_id": 38615968, "question_id": 38613802, "link": "https://stackoverflow.com/questions/38613802/access-make-list-field-visible-when-clicking-button/38615968#38615968", "title": "access make list field visible when clicking Button", "body": "<p>You can't set focus to something not yet visible. Just switch the order:</p>\n\n<pre><code>Private Sub Befehl97_Click()\n    Me.liste91.visible = True\n    Me.liste91.SetFocus\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 1967649, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3UVDJ.jpg?s=128&g=1", "display_name": "oppia04", "link": "https://stackoverflow.com/users/1967649/oppia04"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 38615968, "answer_count": 1, "score": 0, "last_activity_date": 1593958191, "creation_date": 1469624646, "last_edit_date": 1593958191, "question_id": 38613802, "link": "https://stackoverflow.com/questions/38613802/access-make-list-field-visible-when-clicking-button", "title": "access make list field visible when clicking Button", "body": "<p>In an access form, I try to make a list field visible when the fokus is on another textfield in which new data should be filled in. The backround is that one should know the last data inputs to create a new one.\nAs a first step I tried to make the list (liste91) visible when clicking on a button, but I failed using the following code.</p>\n\n<pre><code>Private Sub Befehl97_Click()\n    Forms!projects!liste91.SetFocus\n    Me.liste91.visible = True\nEnd Sub\n</code></pre>\n\n<p>I get error in the line Me.list91\nwhat is wrong?\nthank you for your help!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1469625302, "creation_date": 1469625302, "answer_id": 38614069, "question_id": 38613720, "link": "https://stackoverflow.com/questions/38613720/how-can-i-include-multiple-ranges-to-text-to-columns-via-vba/38614069#38614069", "title": "How can I include multiple ranges to text to columns via VBA?", "body": "<p>You can combine several ranges like this:</p>\n\n<pre><code>Set rng1 = Range(\"U2:U2\")\nSet rng2 = Range(\"V2:V2\")\n'and so on..\nSet yourBigNewRange = Union(rng1, rng2, ... )\n</code></pre>\n\n<p>You can work with this new range exactly the same way you would work with any other range.</p>\n"}], "owner": {"reputation": 11, "user_id": 6496121, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/12e1780a2235d4efa72aef740fedfb28?s=128&d=identicon&r=PG&f=1", "display_name": "JHags", "link": "https://stackoverflow.com/users/6496121/jhags"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 162, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1469625302, "creation_date": 1469624423, "last_edit_date": 1531161705, "question_id": 38613720, "link": "https://stackoverflow.com/questions/38613720/how-can-i-include-multiple-ranges-to-text-to-columns-via-vba", "title": "How can I include multiple ranges to text to columns via VBA?", "body": "<p>Is there anyway to combine the following code to include the required columns in order for them to text to column or do I need to leave it as is? I have multiple ranges including U2, V2, N2, X2, AB2, &amp; Z2</p>\n\n<pre><code>Set sh = Worksheets(\"Data\")\nWith sh\nSet rng = .[U2]\nSet rng = .Range(rng, .Cells(.Rows.Count, rng.Column).End(xlUp))\n\n    rng.TextToColumns Destination:=rng, DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _\n    Semicolon:=False, Comma:=True, Space:=False, Other:=False, _\n    FieldInfo:=Array(Array(1, 1), Array(2, 1), Array(3, 1)), TrailingMinusNumbers:=True\n\nSet rng = .[V2]\nSet rng = .Range(rng, .Cells(.Rows.Count, rng.Column).End(xlUp))\n\n    rng.TextToColumns Destination:=rng, DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _\n    Semicolon:=False, Comma:=True, Space:=False, Other:=False, _\n    FieldInfo:=Array(Array(1, 1), Array(2, 1), Array(3, 1)), TrailingMinusNumbers:=True\n\nSet rng = .[N2]\nSet rng = .Range(rng, .Cells(.Rows.Count, rng.Column).End(xlUp))\n\n    rng.TextToColumns Destination:=rng, DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _\n    Semicolon:=False, Comma:=True, Space:=False, Other:=False, _\n    FieldInfo:=Array(Array(1, 1), Array(2, 1), Array(3, 1)), TrailingMinusNumbers:=True\n\nSet rng = .[X2]\nSet rng = .Range(rng, .Cells(.Rows.Count, rng.Column).End(xlUp))\n\n    rng.TextToColumns Destination:=rng, DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _\n    Semicolon:=False, Comma:=True, Space:=False, Other:=False, _\n    FieldInfo:=Array(Array(1, 1), Array(2, 1), Array(3, 1)), TrailingMinusNumbers:=True\n\nSet rng = .[AB2]\nSet rng = .Range(rng, .Cells(.Rows.Count, rng.Column).End(xlUp))\n\n    rng.TextToColumns Destination:=rng, DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _\n    Semicolon:=False, Comma:=True, Space:=False, Other:=False, _\n    FieldInfo:=Array(Array(1, 1), Array(2, 1), Array(3, 1)), TrailingMinusNumbers:=True\n\nSet rng = .[Z2]\nSet rng = .Range(rng, .Cells(.Rows.Count, rng.Column).End(xlUp))\n\n    rng.TextToColumns Destination:=rng, DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _\n    Semicolon:=False, Comma:=True, Space:=False, Other:=False, _\n    FieldInfo:=Array(Array(1, 1), Array(2, 1), Array(3, 1)), TrailingMinusNumbers:=True\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1469624479, "post_id": 38613701, "comment_id": 64613684, "body": "Use the actual Shape object, not the Selection. The selection isn&#39;t always going to be a Shape."}], "answers": [{"comments": [{"owner": {"reputation": 336, "user_id": 6614154, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/444e3eea34cc65740f5f545e34f07889?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy Morren", "link": "https://stackoverflow.com/users/6614154/jeremy-morren"}, "edited": false, "score": 1, "creation_date": 1469625015, "post_id": 38613822, "comment_id": 64614101, "body": "That seems to have solved the problem.  Yes, The cell will always be numeric (Actually, my bad, I didn&#39;t put in .Value, since it is using a formula to search for a value).  My problem was I copied the code from a Macro, so the above was the best I could do.  I&#39;m a decent programmer but wholly new to VBA, so I don&#39;t really know the syntax.  And, I didn&#39;t like using Select, but I didn&#39;t know how to put it like you put it above.  Thanks!"}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "reply_to_user": {"reputation": 336, "user_id": 6614154, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/444e3eea34cc65740f5f545e34f07889?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy Morren", "link": "https://stackoverflow.com/users/6614154/jeremy-morren"}, "edited": false, "score": 0, "creation_date": 1469625124, "post_id": 38613822, "comment_id": 64614197, "body": "@JeremyMorren no worries at all.  We all start out using Select until someone shows us the path to the light.  Check out <a href=\"http://stackoverflow.com/documentation/excel-vba/1107/vba-best-practices/9292/avoid-using-select-or-activate#t=201607271311166684891\">this documentation</a> for some more detail on avoiding select.  Happy coding!"}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "reply_to_user": {"reputation": 336, "user_id": 6614154, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/444e3eea34cc65740f5f545e34f07889?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy Morren", "link": "https://stackoverflow.com/users/6614154/jeremy-morren"}, "edited": false, "score": 0, "creation_date": 1469625251, "post_id": 38613822, "comment_id": 64614308, "body": "@JeremyMorren and, if your problem is now solved, please mark the answer as accepted to remove this from the unanswered question queue"}], "tags": [], "owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "is_accepted": true, "score": 0, "last_activity_date": 1469624687, "creation_date": 1469624687, "answer_id": 38613822, "question_id": 38613701, "link": "https://stackoverflow.com/questions/38613701/vba-shaperange-rotation-property-randomly-stops-working/38613822#38613822", "title": "VBA ShapeRange.Rotation Property randomly stops working", "body": "<p>A few things.  First, avoid select.  It isn't necessary and will save you a lot of headache and time in the future.  Second, you can reference the shape by its name right from the <code>Shapes</code> object, assuming you are only intending to rotate one shape with the code.  Finally, are you certain the value in <code>Sheets(\"Sheet2\").Range(\"H8\")</code> is numeric?  If not, this could cause an error.  The code below handles the first two issues.  Beyond that, we'll need to see more code to determine the error.</p>\n\n<pre><code>Sheets(\"Sheet1\").Shapes(\"Down Arrow 8\").Rotation = 90 + Sheets(\"Sheet2\").Range(\"H8\")\n</code></pre>\n"}], "owner": {"reputation": 336, "user_id": 6614154, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/444e3eea34cc65740f5f545e34f07889?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy Morren", "link": "https://stackoverflow.com/users/6614154/jeremy-morren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 893, "favorite_count": 0, "accepted_answer_id": 38613822, "answer_count": 1, "score": 0, "last_activity_date": 1469624687, "creation_date": 1469624380, "question_id": 38613701, "link": "https://stackoverflow.com/questions/38613701/vba-shaperange-rotation-property-randomly-stops-working", "title": "VBA ShapeRange.Rotation Property randomly stops working", "body": "<p>I am trying to rotate a shape.  Below is the relevant snippet.</p>\n\n<pre><code>Sheets(\"Sheet1\").Shapes.Range(Array(\"Down Arrow 8\")).Select\nSelection.ShapeRange.Rotation =  90 + Sheets(\"Sheet2\").Range(\"H8\")\n</code></pre>\n\n<p>My problem is that the last line randomly works and randomly doesn't!  I used to have it as a number (instead of a to string) but this refuses to work!  It worked fine, then I made some changes to the macro and then it helpfully returned Error 438 - Object doesn't support this property or method.  I fiddled around, debugged, etc (without ever changing the code) and it started working!  Then I made some more changes and it stopped working and it seems to have stopped working for good.  I literally copied this code from a recorded macro.  </p>\n\n<p>What I have tried:\nUsing CStr() to convert the value to a string\nDeclaring a variable and using the variable</p>\n\n<p>What I really don't understand is why it would work without me changing the code and them stop working without me changing the code (i.e. the relevant lines)</p>\n"}, {"tags": ["excel", "vba", "selenium-webdriver"], "comments": [{"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1469623715, "post_id": 38613307, "comment_id": 64613025, "body": "Can you please include the error you are receiving? If im not wrong you are using Java?"}, {"owner": {"reputation": 13, "user_id": 6640397, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0E_pKBBb3rA/AAAAAAAAAAI/AAAAAAAABco/RSPF_T0hGYo/photo.jpg?sz=128", "display_name": "Optimistic", "link": "https://stackoverflow.com/users/6640397/optimistic"}, "reply_to_user": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1469623760, "post_id": 38613307, "comment_id": 64613065, "body": "The error is &quot;Run-time error : Object doesn&#39;t support this property or method&quot;"}, {"owner": {"reputation": 13, "user_id": 6640397, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0E_pKBBb3rA/AAAAAAAAAAI/AAAAAAAABco/RSPF_T0hGYo/photo.jpg?sz=128", "display_name": "Optimistic", "link": "https://stackoverflow.com/users/6640397/optimistic"}, "reply_to_user": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1469623812, "post_id": 38613307, "comment_id": 64613104, "body": "It hits in this line  &quot;Set web_tr = web_table.findElementsByTagName(&quot;tr&quot;)&quot;"}, {"owner": {"reputation": 13, "user_id": 6640397, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0E_pKBBb3rA/AAAAAAAAAAI/AAAAAAAABco/RSPF_T0hGYo/photo.jpg?sz=128", "display_name": "Optimistic", "link": "https://stackoverflow.com/users/6640397/optimistic"}, "reply_to_user": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1469623960, "post_id": 38613307, "comment_id": 64613226, "body": "No. I am using excel selenium VBA code..I just import &quot;Dim selenium As New SeleniumWrapper.WebDriver&quot;"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 2, "creation_date": 1469623990, "post_id": 38613307, "comment_id": 64613254, "body": "I guess you need to specify the index of the web_table. As per my knowledge, findelements of selenium will returns an array. So my understanding is web_table is an array of objects.So try Set web_tr = web_table[0].findElementsByTagName(&quot;tr&quot;)"}, {"owner": {"reputation": 13, "user_id": 6640397, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0E_pKBBb3rA/AAAAAAAAAAI/AAAAAAAABco/RSPF_T0hGYo/photo.jpg?sz=128", "display_name": "Optimistic", "link": "https://stackoverflow.com/users/6640397/optimistic"}, "reply_to_user": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1469624215, "post_id": 38613307, "comment_id": 64613461, "body": "I took this page as a reference &quot;<a href=\"http://www.software-testing-tutorials-automation.com/2014/06/how-to-handle-dynamic-web-table-in.html\" rel=\"nofollow noreferrer\">software-testing-tutorials-automation.com/2014/06/&hellip;</a>&quot;"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1469624292, "post_id": 38613307, "comment_id": 64613526, "body": "Sorry curretly that page is not showing anything. Please give a try with what i told"}, {"owner": {"reputation": 13, "user_id": 6640397, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0E_pKBBb3rA/AAAAAAAAAAI/AAAAAAAABco/RSPF_T0hGYo/photo.jpg?sz=128", "display_name": "Optimistic", "link": "https://stackoverflow.com/users/6640397/optimistic"}, "reply_to_user": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1469624454, "post_id": 38613307, "comment_id": 64613658, "body": "When I am about to set &quot;Set web_tr = web_table[0].findElementsByTagName(&quot;tr&quot;)&quot; system throws an immediate error &quot;Compile error:  Expected: end of statement &quot;."}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1469624678, "post_id": 38613307, "comment_id": 64613848, "body": "sorry use web_table(0) instead of web_table[0]"}, {"owner": {"reputation": 13, "user_id": 6640397, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0E_pKBBb3rA/AAAAAAAAAAI/AAAAAAAABco/RSPF_T0hGYo/photo.jpg?sz=128", "display_name": "Optimistic", "link": "https://stackoverflow.com/users/6640397/optimistic"}, "reply_to_user": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1469626144, "post_id": 38613307, "comment_id": 64615012, "body": "&quot;Set web_td = web_tr.findElementsByTagName(&quot;td&quot;)&quot; Now again the same  &quot;Run-time error : Object doesn&#39;t support this property or method&quot;&quot;."}, {"owner": {"reputation": 13, "user_id": 6640397, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0E_pKBBb3rA/AAAAAAAAAAI/AAAAAAAABco/RSPF_T0hGYo/photo.jpg?sz=128", "display_name": "Optimistic", "link": "https://stackoverflow.com/users/6640397/optimistic"}, "reply_to_user": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1469626231, "post_id": 38613307, "comment_id": 64615076, "body": "&quot;Run-time error&#39;13&#39; : Type mismatch&quot; when I am changing the code to Set web_td = web_tr(0).findElementsByTagName(&quot;td&quot;)"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1469626729, "post_id": 38613307, "comment_id": 64615463, "body": "how did you declare web_tr and web_td? Can you add your entire code? in you question. Type mismatch is generally due to improper assignments like int to string etc"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1469626866, "post_id": 38613307, "comment_id": 64615574, "body": "Do you really need to set the web_td? You are directly using xpath for each td in code. I guess uncommenting your &#39;ActiveSheet.Cells(i, 1).Value... and commneting web_td set will work.Please try"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6640397, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0E_pKBBb3rA/AAAAAAAAAAI/AAAAAAAABco/RSPF_T0hGYo/photo.jpg?sz=128", "display_name": "Optimistic", "link": "https://stackoverflow.com/users/6640397/optimistic"}, "edited": false, "score": 0, "creation_date": 1469707229, "post_id": 38618033, "comment_id": 64654475, "body": "I am getting an error pop up in this line now.. the same kind of"}, {"owner": {"reputation": 13, "user_id": 6640397, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0E_pKBBb3rA/AAAAAAAAAAI/AAAAAAAABco/RSPF_T0hGYo/photo.jpg?sz=128", "display_name": "Optimistic", "link": "https://stackoverflow.com/users/6640397/optimistic"}, "edited": false, "score": 0, "creation_date": 1469707242, "post_id": 38618033, "comment_id": 64654482, "body": "Set web_td = web_tr.findElementsByTagName(&quot;td&quot;)"}, {"owner": {"reputation": 13, "user_id": 6640397, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0E_pKBBb3rA/AAAAAAAAAAI/AAAAAAAABco/RSPF_T0hGYo/photo.jpg?sz=128", "display_name": "Optimistic", "link": "https://stackoverflow.com/users/6640397/optimistic"}, "edited": false, "score": 0, "creation_date": 1469707262, "post_id": 38618033, "comment_id": 64654497, "body": "Run time error &#39;438&#39; Object doesn&#39;t support this property or method"}, {"owner": {"reputation": 13, "user_id": 6640397, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0E_pKBBb3rA/AAAAAAAAAAI/AAAAAAAABco/RSPF_T0hGYo/photo.jpg?sz=128", "display_name": "Optimistic", "link": "https://stackoverflow.com/users/6640397/optimistic"}, "edited": false, "score": 0, "creation_date": 1469707386, "post_id": 38618033, "comment_id": 64654594, "body": "And one more thing as you suggested I could not able to find the new list &quot;Dim tds As New List&quot; instead I could able to figure related to list as collection only. I used &quot;Dim tds As New Collection&quot;. Just FYI. Not sure whether any error may would occur as I am getting an error message b4 that line"}, {"owner": {"reputation": 18005, "user_id": 2386774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea7da142cb7e85d5d5a8576e2625431?s=128&d=identicon&r=PG", "display_name": "JeffC", "link": "https://stackoverflow.com/users/2386774/jeffc"}, "reply_to_user": {"reputation": 13, "user_id": 6640397, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0E_pKBBb3rA/AAAAAAAAAAI/AAAAAAAABco/RSPF_T0hGYo/photo.jpg?sz=128", "display_name": "Optimistic", "link": "https://stackoverflow.com/users/6640397/optimistic"}, "edited": false, "score": 0, "creation_date": 1490301338, "post_id": 38618033, "comment_id": 73064595, "body": "Any particular reason why you removed the accepted flag on this answer?"}], "tags": [], "owner": {"reputation": 18005, "user_id": 2386774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea7da142cb7e85d5d5a8576e2625431?s=128&d=identicon&r=PG", "display_name": "JeffC", "link": "https://stackoverflow.com/users/2386774/jeffc"}, "is_accepted": false, "score": 0, "last_activity_date": 1469635878, "last_edit_date": 1469635878, "creation_date": 1469635292, "answer_id": 38618033, "question_id": 38613307, "link": "https://stackoverflow.com/questions/38613307/using-selenium-vba-bringing-the-cell-values-from-a-dynamic-web-page-table-to-exc/38618033#38618033", "title": "Using selenium VBA bringing the cell values from a dynamic web page table to excel cells", "body": "<p>I'm not really familiar with the VBA version of Selenium but from what I can tell, I see one issue that I think is causing the error you are getting. When you use <code>.findElements*</code> (plural), it will return a collection of elements instead of just a single element. Your first line (below) is using <code>.findElements()</code> but in the second line (below) is not specifying which element of the <code>web_table</code> collection to reference.</p>\n\n<pre><code>Set web_table = selenium.findElementsByXPath(\"//table[@id='ctl00_cphContentBody_itemsTable']/tbody\")\nSet web_tr = web_table.findElementsByTagName(\"tr\")   '***** the error pop-up gets in here****\n</code></pre>\n\n<p>You can try to do one of two fixes...</p>\n\n<ol>\n<li><p>Change <code>.findElements()</code> to <code>.findElement()</code> so that you only grab the first (and probably only?) table. If you only want the first one, this is the right way to fix this.</p></li>\n<li><p>Add an index into the collection of elements from the first line, e.g. change <code>web_table.</code> to <code>web_table(1).</code> If you want a <code>TABLE</code> tag other than the first one, then add the correct reference.</p>\n\n<pre><code>Set web_table = selenium.findElementsByXPath(\"//table[@id='ctl00_cphContentBody_itemsTable']/tbody\")\nSet web_tr = web_table(1).findElementsByTagName(\"tr\")\nadd this _____________^^^\n</code></pre></li>\n</ol>\n\n<hr>\n\n<p>Additional Note:\nI had another suggestion to simplify some of your code. In your <code>For i</code> loop you have hardcoded indexes 2-7 where I think you can easily use a loop. I updated the code below. This accomplishes two things...</p>\n\n<ol>\n<li>It eliminates the repeated scraping of the page. In your original code, you are scraping one element at a time. In the code below, I grab a collection of <code>TD</code>s and then iterate through them. That way I'm only scraping the page once to get all the elements I care about and then processing that collection. It's more efficient.</li>\n<li>Simplifies the code.</li>\n</ol>\n\n\n\n<pre><code>For i = 1 To row_count\n    Set web_td = web_tr.findElementsByTagName(\"td\")\n    ActiveSheet.Cells(i, 1).Value = web_td(1).getText\n    Dim tds As New List\n    Set tds = ActiveSheet.Cells(i, 2).Value = selenium.findElementByXPath(\"//table[@id='ctl00_cphContentBody_itemsTable']/tbody/tr['i']\")\n    For j = 2 To 7\n        ActiveSheet.Cells(i, j).Value = tds(j).Text\n    Next j\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 6640397, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0E_pKBBb3rA/AAAAAAAAAAI/AAAAAAAABco/RSPF_T0hGYo/photo.jpg?sz=128", "display_name": "Optimistic", "link": "https://stackoverflow.com/users/6640397/optimistic"}, "is_accepted": false, "score": 0, "last_activity_date": 1529221447, "last_edit_date": 1529221447, "creation_date": 1469721333, "answer_id": 38641301, "question_id": 38613307, "link": "https://stackoverflow.com/questions/38613307/using-selenium-vba-bringing-the-cell-values-from-a-dynamic-web-page-table-to-exc/38641301#38641301", "title": "Using selenium VBA bringing the cell values from a dynamic web page table to excel cells", "body": "<p>Thank you both of you.</p>\n\n<p>The below code works well in finding the each cell values.</p>\n\n<pre><code>With ThisWorkbook\n        .Sheets(\"UpfrontOrder#\").Activate\n\n       Set web_table = selenium.findElementByXPath(\"//table[@id='ctl00_cphContentBody_itemsTable']/tbody\")\n       Set web_tr = web_table.findElementsByTagName(\"tr\")\n\n       row_count = selenium.findElementsByXPath(\"//table[@id='ctl00_cphContentBody_itemsTable']/tbody/tr\").Count\n\n       For i = 0 To (row_count - 2)\n\n            Set web_td = web_tr(i).findElementsByTagName(\"td\")\n            For j = 0 To 6\n                   ActiveSheet.Cells((i + 1), (j + 1)).Value = web_td(j).Text\n            Next j\n        Next i\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6640397, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0E_pKBBb3rA/AAAAAAAAAAI/AAAAAAAABco/RSPF_T0hGYo/photo.jpg?sz=128", "display_name": "Optimistic", "link": "https://stackoverflow.com/users/6640397/optimistic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4092, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1529221447, "creation_date": 1469623335, "last_edit_date": 1469623796, "question_id": 38613307, "link": "https://stackoverflow.com/questions/38613307/using-selenium-vba-bringing-the-cell-values-from-a-dynamic-web-page-table-to-exc", "title": "Using selenium VBA bringing the cell values from a dynamic web page table to excel cells", "body": "<p>I am new to selenium VBA and post googling have crated the below code in  order to bring the each cell value from a dynamic webpage using the selenium vba. I am getting error in receiving the web elements in a web_tr and web_td web elements</p>\n\n<p>Have trying with this line:</p>\n\n<pre><code>ActiveSheet.Cells(i, 1).Value = selenium.findElementByXPath(\"//table[@id='ctl00_cphContentBody_itemsTable']/tbody/tr['i']/td[1]\").Text\n</code></pre>\n\n<p>I am getting a header line item first value only though it is under the loop.</p>\n\n<p>Web_tr and web_td are web elements and receiving the web elements to these variables are the issue here. Kindly assist.</p>\n\n<hr>\n\n<pre><code>With ThisWorkbook\n        .Sheets(\"UpfrontOrder#\").Activate\n\n       Set web_table = selenium.findElementsByXPath(\"//table[@id='ctl00_cphContentBody_itemsTable']/tbody\")\n       Set web_tr = web_table.findElementsByTagName(\"tr\")   '***** the error pop-up gets in here****\n       row_count = selenium.findElementsByXPath(\"//table[@id='ctl00_cphContentBody_itemsTable']/tbody/tr\").Count\n\n       For i = 1 To row_count\n            Set web_td = web_tr.findElementsByTagName(\"td\")\n            ActiveSheet.Cells(i, 1).Value = web_td(1).getText\n\n            'ActiveSheet.Cells(i, 1).Value = selenium.findElementByXPath(\"//table[@id='ctl00_cphContentBody_itemsTable']/tbody/tr['i']/td[1]\").Text\n            ActiveSheet.Cells(i, 2).Value = selenium.findElementByXPath(\"//table[@id='ctl00_cphContentBody_itemsTable']/tbody/tr['i']/td[2]\").Text\n            ActiveSheet.Cells(i, 3).Value = selenium.findElementByXPath(\"//table[@id='ctl00_cphContentBody_itemsTable']/tbody/tr['i']/td[3]\").Text\n            ActiveSheet.Cells(i, 4).Value = selenium.findElementByXPath(\"//table[@id='ctl00_cphContentBody_itemsTable']/tbody/tr['i']/td[4]\").Text\n            ActiveSheet.Cells(i, 5).Value = selenium.findElementByXPath(\"//table[@id='ctl00_cphContentBody_itemsTable']/tbody/tr['i']/td[5]\").Text\n            ActiveSheet.Cells(i, 6).Value = selenium.findElementByXPath(\"//table[@id='ctl00_cphContentBody_itemsTable']/tbody/tr['i']/td[6]\").Text\n            ActiveSheet.Cells(i, 7).Value = selenium.findElementByXPath(\"//table[@id='ctl00_cphContentBody_itemsTable']/tbody/tr['i']/td[7]\").Text\n\n            'ActiveSheet.Cells(i, 1).Value = web_td.findElementByXPath(\"td[1]\").Text\n            'ActiveSheet.Cells(i, 2).Value = web_td(1).Text\n\n        Next i\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 306, "user_id": 3436226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f17ea341b72f6ea2576938e80fd508a6?s=128&d=identicon&r=PG&f=1", "display_name": "nilsman", "link": "https://stackoverflow.com/users/3436226/nilsman"}, "edited": false, "score": 3, "creation_date": 1469622331, "post_id": 38612857, "comment_id": 64611949, "body": "Submit the code you&#39;ve written so far."}, {"owner": {"reputation": 273, "user_id": 5629664, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/47fa747175ef94bd6b4ddef681394799?s=128&d=identicon&r=PG&f=1", "display_name": "user28", "link": "https://stackoverflow.com/users/5629664/user28"}, "reply_to_user": {"reputation": 306, "user_id": 3436226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f17ea341b72f6ea2576938e80fd508a6?s=128&d=identicon&r=PG&f=1", "display_name": "nilsman", "link": "https://stackoverflow.com/users/3436226/nilsman"}, "edited": false, "score": 0, "creation_date": 1469624156, "post_id": 38612857, "comment_id": 64613400, "body": "@nilsman i have added code, but it is not completely correct as i am using vba now for this task and i am not familiar with syntax and all."}], "answers": [{"tags": [], "owner": {"reputation": 16, "user_id": 6560622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd3f702f95eb8dbff9c4e75931e01b0c?s=128&d=identicon&r=PG&f=1", "display_name": "thentt", "link": "https://stackoverflow.com/users/6560622/thentt"}, "is_accepted": false, "score": 0, "last_activity_date": 1469630052, "creation_date": 1469630052, "answer_id": 38616012, "question_id": 38612857, "link": "https://stackoverflow.com/questions/38612857/importing-multiple-columns-from-one-sheet-to-new-sheet/38616012#38616012", "title": "importing multiple columns from one sheet to new sheet", "body": "<p>I don't know exactly what the problem is but i give it try. The code you got works perfectly, just one or two mistakes in there.</p>\n\n<pre><code>LastColumn = sht.Cells(1, -&gt;here&lt;-.Columns.Count).End(xlToLeft).Column\n</code></pre>\n\n<p>The .Columns need a object, here it would be sht.Columns.count</p>\n\n<pre><code>Next cell\n</code></pre>\n\n<p>Is missing under the last End If so the for-loop got an next</p>\n\n<p>Then you just need to the name different sheets write at this points:</p>\n\n<pre><code> Set sht = Worksheets(\"Orignal Sheet\")\n</code></pre>\n\n<p>And then you need to put a copy command in the If body that reference the current column like this:</p>\n\n<pre><code> data = cell.Value\n      If data = \"D_ID\" Then\n        MsgBox (\"Got it\")\n        Sheets(\"Table3\").Columns(cell.Columns).Copy Destination:=Sheets(\"Table4\").Columns(2)\n</code></pre>\n"}], "owner": {"reputation": 273, "user_id": 5629664, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/47fa747175ef94bd6b4ddef681394799?s=128&d=identicon&r=PG&f=1", "display_name": "user28", "link": "https://stackoverflow.com/users/5629664/user28"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 808, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1469630052, "creation_date": 1469622162, "last_edit_date": 1469624407, "question_id": 38612857, "link": "https://stackoverflow.com/questions/38612857/importing-multiple-columns-from-one-sheet-to-new-sheet", "title": "importing multiple columns from one sheet to new sheet", "body": "<p>This is my source sheet which has different columns such as D_ID, Modules, Function_Name etc.</p>\n\n<p><a href=\"https://i.stack.imgur.com/BQ4M1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BQ4M1.png\" alt=\"enter image description here\"></a></p>\n\n<p>I would like to export few columns such as \"D_ID\",\"Function_Name\",\"Sub_Unit_Number\",\"length\" from ActiveSheet to new worksheet. </p>\n\n<p>My output worksheet should look like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/U2NWQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/U2NWQ.png\" alt=\"enter image description here\"></a></p>\n\n<p>The logic that I tried to use is first to create a new worksheet using vba code and then use the for loop to go through Range (\"A1: K1\") to find if each cell value in this range matches with the string \"D_ID\" , \"Function_Name\",\"Sub_Unit_Number\",\"length\". If yes, then I need to write in new worksheet. </p>\n\n<p>But my logic is getting failed. </p>\n\n<p>I would really appreciate if someone could help me with different logic or code to get it work.</p>\n\n<pre><code>         Sub CreateNewSheet()\n         Dim rep As Integer\n         Dim sheet_name_to_create As String\n\n         sheet_name_to_create = \"Test_Sheet\"\n\n         'a statement to go through other worksheets\n         For rep = 1 To (Worksheets.Count)\n\n          'search the sheet wth the name if that exists\n         If LCase(Sheets(rep).Name) = LCase(sheet_name_to_create) Then\n           MsgBox \"This sheet already exists\"\n         Exit Sub\n         End If\n\n         Next\n\n           Sheets.Add After:=Sheets(\"Original_Sheet\")\n           Sheets(ActiveSheet.Name).Name = sheet_name_to_create\n\n           End Sub\n\n          Sub Extract_data()\n           ' this sub routine extracts D_ID, Function_Name, Sub_Unit_Number                  \n            'and Length from the Original_Sheet\n          Dim LastColumn As Integer\n          Dim cell As Range\n          Dim sht As Worksheet\n          Dim data As String\n\n\n         Set sht = Worksheets(\"Original_Sheet\")\n         LastColumn = sht.Cells(1, .Columns.Count).End(xlToLeft).Column\n\n         For Each cell In sht.Range(\"A1:K\" &amp; LastColumn).Cells\n\n         data = cell.Value\n          If data = \"D_ID\" Then\n            ' I need to import to the new worksheet\n\n          ElseIf data = \"Function_Name\" Then\n             ' I need to import to the new worksheet\n\n          ElseIf data = \"Sub_Unit_Number\" Then\n              ' I need to import to the new worksheet\n\n          ElseIf data = \"Length\" Then\n                ' I need to import to the new worksheet\n\n          End If\n          End Sub\n\n\n          Sub MyNewProcedure()\n          Call CreateNewSheet\n          Call Extract_data\n          End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access", "ms-access-2010"], "comments": [{"owner": {"reputation": 716, "user_id": 6518147, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1204875876202728/picture?type=large", "display_name": "Hynek Bernard", "link": "https://stackoverflow.com/users/6518147/hynek-bernard"}, "edited": false, "score": 0, "creation_date": 1469622063, "post_id": 38612680, "comment_id": 64611768, "body": "How it does not work, do you have any error message ?"}, {"owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "reply_to_user": {"reputation": 716, "user_id": 6518147, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1204875876202728/picture?type=large", "display_name": "Hynek Bernard", "link": "https://stackoverflow.com/users/6518147/hynek-bernard"}, "edited": false, "score": 0, "creation_date": 1469622548, "post_id": 38612680, "comment_id": 64612134, "body": "I get an error &quot;external table is not in the expected format&quot; - However if I take the password off the excel document it works fine"}, {"owner": {"reputation": 836, "user_id": 6419727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e6f5532e6c9f3d91e56fdffd792dcf9?s=128&d=identicon&r=PG&f=1", "display_name": "random_answer_guy", "link": "https://stackoverflow.com/users/6419727/random-answer-guy"}, "edited": false, "score": 0, "creation_date": 1469625564, "post_id": 38612680, "comment_id": 64614566, "body": "Are you opening the Excel doc before trying to access it?"}, {"owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "edited": false, "score": 0, "creation_date": 1469625634, "post_id": 38612680, "comment_id": 64614631, "body": "No - We are looking to automate everything so don&#39;t want to open multiple things to get the final result we are after"}, {"owner": {"reputation": 836, "user_id": 6419727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e6f5532e6c9f3d91e56fdffd792dcf9?s=128&d=identicon&r=PG&f=1", "display_name": "random_answer_guy", "link": "https://stackoverflow.com/users/6419727/random-answer-guy"}, "edited": false, "score": 0, "creation_date": 1469625745, "post_id": 38612680, "comment_id": 64614713, "body": "I think that is the issue, you must open it with password, then can execute what you want. You can open it hidden if you don&#39;t want users to see it."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1469644454, "post_id": 38612680, "comment_id": 64627125, "body": "You don&#39;t want to include the password in the linking mechanism?"}], "answers": [{"tags": [], "owner": {"reputation": 178, "user_id": 5656296, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed50544a4557d43add0caac2f8305762?s=128&d=identicon&r=PG&f=1", "display_name": "JBStovers", "link": "https://stackoverflow.com/users/5656296/jbstovers"}, "is_accepted": false, "score": 2, "last_activity_date": 1469861070, "creation_date": 1469861070, "answer_id": 38671149, "question_id": 38612680, "link": "https://stackoverflow.com/questions/38612680/connecting-password-protected-excel-to-access/38671149#38671149", "title": "Connecting password-protected Excel to Access", "body": "<p>Try using a hidden form to automatically open the Excel file when the database file is opened.  </p>\n\n<p>Add this to a new Module:</p>\n\n<pre><code>Option Compare Database\nPublic xl As Object\n\nFunction OpenExcelFile()\n    xl.Workbooks.Open \"path to file.xlsx\", , , , \"password\"\nEnd Function\n\nFunction CloseExcelFile()\n    xl.Quit\n    set xl=nothing\nEnd Function\n</code></pre>\n\n<p>Create a blank form and set the HasModule property to true.  then add the following to the form's code module.  </p>\n\n<pre><code>Private Sub Form_Load()\n    OpenExcelFile\nEnd Sub\n\nPrivate Sub Form_Close()\n    CloseExcelFile\nEnd Sub\n</code></pre>\n\n<p>Now create a new macro with an OpenForm task to open your form.  Set the window mode to 'Hidden'.  Save the macro with the name 'AutoExec'.  This makes it run when the db is opened.</p>\n\n<p>When the db is opened the macro will run and open the form hidden.  The form load event will fire, creating a public Excel.Application object that opens your excel file (you should be able to remove the password from the code if you want the user to be prompted for it).  The Excel application will remain open until the hidden form closes (when you close the database).  At that point the form close event will fire, causing the Excel Application to quit.  As long as the Excel file is open, you should be able to use linked tables and queries.</p>\n\n<p>**You could add xl.Visible=true to the OpenExcelFile function if you want it to be visible to the user.</p>\n\n<p>This link as a similar idea: <a href=\"https://www.connectionstrings.com/how-to-open-password-protected-excel-workbook/\" rel=\"nofollow\">https://www.connectionstrings.com/how-to-open-password-protected-excel-workbook/</a></p>\n"}], "owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1579, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593988492, "creation_date": 1469621714, "last_edit_date": 1593988492, "question_id": 38612680, "link": "https://stackoverflow.com/questions/38612680/connecting-password-protected-excel-to-access", "title": "Connecting password-protected Excel to Access", "body": "<p>I want to link a password-protected Excel document to Access - this is not working due to the it being password-protected.</p>\n\n<p>Does anyone have an alternative method to do this?</p>\n\n<p>It has to be password-protected unfortunately and cannot be moved to a secured folder so not sure how to do it.</p>\n\n<p>Any advice? </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1469621443, "post_id": 38612508, "comment_id": 64611310, "body": "why not just have a simple solution here, if you go inside your <code>If</code> , then after you delete the row, just add a row <code>i = i - 1</code>"}, {"owner": {"reputation": 179, "user_id": 6396578, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96416893a7a8facb68d3cebdc8e74e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Hiddenllyy", "link": "https://stackoverflow.com/users/6396578/hiddenllyy"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1469621540, "post_id": 38612508, "comment_id": 64611386, "body": "Oh so I always begain from the former line where I deleted one?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1469621666, "post_id": 38612508, "comment_id": 64611484, "body": "if you delete a line, then yes. you don&#39;t want to skip a line"}, {"owner": {"reputation": 4741, "user_id": 6405587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tJdlv.jpg?s=128&g=1", "display_name": "Sudharsan Selvaraj", "link": "https://stackoverflow.com/users/6405587/sudharsan-selvaraj"}, "edited": false, "score": 1, "creation_date": 1469621673, "post_id": 38612508, "comment_id": 64611486, "body": "And also you need to assign new value to <code>Row</code> variable. Because if you are going to delete all rows then i will be always 1 and Row will have some greater value."}], "answers": [{"comments": [{"owner": {"reputation": 179, "user_id": 6396578, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96416893a7a8facb68d3cebdc8e74e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Hiddenllyy", "link": "https://stackoverflow.com/users/6396578/hiddenllyy"}, "edited": false, "score": 0, "creation_date": 1469623100, "post_id": 38612817, "comment_id": 64612563, "body": "Sorry, I didn&#39;t quiet understand, <code>lRow</code> is the number of rows I have in this sheet? then I go from the last one row <code>lRow</code> to 6, is that?"}, {"owner": {"reputation": 1497, "user_id": 968318, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/noL7T.jpg?s=128&g=1", "display_name": "Sathish Kothandam", "link": "https://stackoverflow.com/users/968318/sathish-kothandam"}, "reply_to_user": {"reputation": 179, "user_id": 6396578, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96416893a7a8facb68d3cebdc8e74e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Hiddenllyy", "link": "https://stackoverflow.com/users/6396578/hiddenllyy"}, "edited": false, "score": 0, "creation_date": 1469623429, "post_id": 38612817, "comment_id": 64612822, "body": "Correct ! .Irow is the number of rows used in the A column"}, {"owner": {"reputation": 179, "user_id": 6396578, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96416893a7a8facb68d3cebdc8e74e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Hiddenllyy", "link": "https://stackoverflow.com/users/6396578/hiddenllyy"}, "edited": false, "score": 0, "creation_date": 1469623571, "post_id": 38612817, "comment_id": 64612929, "body": "Ok I see! Thank you very much, but I have to choose one as an answer and Mr. Darren comes first so... Well still your answer&#39;s perfect!"}, {"owner": {"reputation": 1497, "user_id": 968318, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/noL7T.jpg?s=128&g=1", "display_name": "Sathish Kothandam", "link": "https://stackoverflow.com/users/968318/sathish-kothandam"}, "reply_to_user": {"reputation": 179, "user_id": 6396578, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96416893a7a8facb68d3cebdc8e74e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Hiddenllyy", "link": "https://stackoverflow.com/users/6396578/hiddenllyy"}, "edited": false, "score": 0, "creation_date": 1469623836, "post_id": 38612817, "comment_id": 64613129, "body": "No worries. @Darren&#39;s answer is short &amp; Perfect."}], "tags": [], "owner": {"reputation": 1497, "user_id": 968318, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/noL7T.jpg?s=128&g=1", "display_name": "Sathish Kothandam", "link": "https://stackoverflow.com/users/968318/sathish-kothandam"}, "is_accepted": false, "score": 2, "last_activity_date": 1469622492, "last_edit_date": 1469622492, "creation_date": 1469622081, "answer_id": 38612817, "question_id": 38612508, "link": "https://stackoverflow.com/questions/38612508/vba-how-to-delete-the-improper-discrete-lines/38612817#38612817", "title": "VBA How to delete the improper discrete lines", "body": "<p>Let's do it in reverse order . try to modify the below code as your wish.</p>\n\n<pre><code>Sub Deleterows()\n    Dim lRow As Long\n    Dim iCntr As Long\n    lRow = Sheets(\"Data\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row ' calculates no of rows used in A column\n\n    For iCntr = lRow To 6 Step -1 ' loop in reverse order\n        If Cells(iCntr, 1) = \"str\" Then 'You can change this text\n            Sheets(\"Data\").Rows(iCntr).Delete\n        End If\n    Next\n\n    End Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 2, "last_activity_date": 1469622123, "creation_date": 1469622123, "answer_id": 38612839, "question_id": 38612508, "link": "https://stackoverflow.com/questions/38612508/vba-how-to-delete-the-improper-discrete-lines/38612839#38612839", "title": "VBA How to delete the improper discrete lines", "body": "<p>If you're deleting rows it's best to work from the bottom up.<br>\nChange <code>for i = 1 to Row</code> to <code>for i = Row to 1 Step -1</code>.</p>\n\n<p>Now when you delete a row it won't alter the row number of any rows above it.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 3, "last_activity_date": 1469622130, "creation_date": 1469622130, "answer_id": 38612845, "question_id": 38612508, "link": "https://stackoverflow.com/questions/38612508/vba-how-to-delete-the-improper-discrete-lines/38612845#38612845", "title": "VBA How to delete the improper discrete lines", "body": "<p>Always iterate backwards from last to first when deleting.  </p>\n\n<pre><code>dim i As Integer\nfor i = Row to 1 Step -1\n    If Worksheets(\"Data\").Cells(i,6).Text &lt;&gt;\"a\" Then\n        Worksheets(\"Data\").Rows(i).Delete\n    End If\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 746, "user_id": 6400030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oyeSx.png?s=128&g=1", "display_name": "Arun Thomas", "link": "https://stackoverflow.com/users/6400030/arun-thomas"}, "is_accepted": false, "score": 1, "last_activity_date": 1469623608, "creation_date": 1469623608, "answer_id": 38613416, "question_id": 38612508, "link": "https://stackoverflow.com/questions/38612508/vba-how-to-delete-the-improper-discrete-lines/38613416#38613416", "title": "VBA How to delete the improper discrete lines", "body": "<p>I would suggest you use the while loop so that you could reduce the iterations as well as the limit of the loop after deleting a row, see below</p>\n\n<pre><code>Dim i As Integer\nDim rows As Integer\nrow_count = 3\ni = 1\n\nWhile i &lt;= row_count\n    If Worksheets(\"Data\").Cells(i, 6).Text &lt;&gt; \"a\" Then\n        Worksheets(\"Data\").rows(i).Delete\n        i = i - 1\n        row_count = row_count - 1\n    End If\n    i = i + 1\nWend\n</code></pre>\n"}], "owner": {"reputation": 179, "user_id": 6396578, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96416893a7a8facb68d3cebdc8e74e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Hiddenllyy", "link": "https://stackoverflow.com/users/6396578/hiddenllyy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 38612839, "answer_count": 4, "score": 0, "last_activity_date": 1469623608, "creation_date": 1469621264, "last_edit_date": 1531164843, "question_id": 38612508, "link": "https://stackoverflow.com/questions/38612508/vba-how-to-delete-the-improper-discrete-lines", "title": "VBA How to delete the improper discrete lines", "body": "<p>I tried to delete some lines whose sixth cell doesn't contain the correct value. And Here is my code:</p>\n\n<pre><code>dim i As Integer\nfor i = 1 to Row\n    If Worksheets(\"Data\").Cells(i,6).Text &lt;&gt;\"a\" Then\n        Worksheets(\"Data\").Rows(i).Delete\n    End If\nNext i\n</code></pre>\n\n<p>And I've found that if I delete line 1 (aaa), then the former line 2(bbb) becomes line 1, perhaps it's not the line that I want to keep, but i has already became 2, so actually I missed this line (bbb) and remove directly to the former line 3 (ccc).</p>\n\n<pre><code>1 aaa =&gt; bbb\n2 bbb =&gt; ccc\n3 ccc\n</code></pre>\n\n<p>And I don't know if there is a good algorithm for this problem? Thank you.</p>\n"}, {"tags": ["html", "excel", "email", "vba"], "answers": [{"comments": [{"owner": {"reputation": 713, "user_id": 5649582, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh4.googleusercontent.com/-HUnVeS74mpQ/AAAAAAAAAAI/AAAAAAAADMQ/VxQa9JFJLKw/photo.jpg?sz=128", "display_name": "Andrew Perry", "link": "https://stackoverflow.com/users/5649582/andrew-perry"}, "edited": false, "score": 0, "creation_date": 1470814142, "post_id": 38613360, "comment_id": 65096498, "body": "Cheers - it works, but all of us here in the local office use Outlook, so I can&#39;t check if it works with other mail clients. Do you know if CID works in other clients?"}, {"owner": {"reputation": 735, "user_id": 6223038, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3d367b52256b10b8255bc9abb8740330?s=128&d=identicon&r=PG&f=1", "display_name": "vanathaiyan", "link": "https://stackoverflow.com/users/6223038/vanathaiyan"}, "reply_to_user": {"reputation": 713, "user_id": 5649582, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh4.googleusercontent.com/-HUnVeS74mpQ/AAAAAAAAAAI/AAAAAAAADMQ/VxQa9JFJLKw/photo.jpg?sz=128", "display_name": "Andrew Perry", "link": "https://stackoverflow.com/users/5649582/andrew-perry"}, "edited": false, "score": 1, "creation_date": 1470894050, "post_id": 38613360, "comment_id": 65136527, "body": "This is created using simple HTML tags only so It should work"}], "tags": [], "owner": {"reputation": 735, "user_id": 6223038, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3d367b52256b10b8255bc9abb8740330?s=128&d=identicon&r=PG&f=1", "display_name": "vanathaiyan", "link": "https://stackoverflow.com/users/6223038/vanathaiyan"}, "is_accepted": true, "score": 2, "last_activity_date": 1469623474, "creation_date": 1469623474, "answer_id": 38613360, "question_id": 38612317, "link": "https://stackoverflow.com/questions/38612317/embedding-image-in-and-attaching-files-to-email-sent-through-excel-vba/38613360#38613360", "title": "Embedding image in and attaching files to email sent through Excel VBA", "body": "<p>try the below code,</p>\n\n<p>for attaching the image to your mail(add this under create mail object),</p>\n\n<pre><code>       .Attachments.Add ThisWorkbook.Path &amp; \"\\image.png\"\n</code></pre>\n\n<p>add this into your mail body (assuming you are using table)</p>\n\n<pre><code>\"&lt;td Colspan=2&gt;&lt;img src='cid:image.png' height=205 width=1015&gt;&lt;/td&gt;\"\n</code></pre>\n"}], "owner": {"reputation": 713, "user_id": 5649582, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh4.googleusercontent.com/-HUnVeS74mpQ/AAAAAAAAAAI/AAAAAAAADMQ/VxQa9JFJLKw/photo.jpg?sz=128", "display_name": "Andrew Perry", "link": "https://stackoverflow.com/users/5649582/andrew-perry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "accepted_answer_id": 38613360, "answer_count": 1, "score": 0, "last_activity_date": 1469623474, "creation_date": 1469620733, "last_edit_date": 1531164843, "question_id": 38612317, "link": "https://stackoverflow.com/questions/38612317/embedding-image-in-and-attaching-files-to-email-sent-through-excel-vba", "title": "Embedding image in and attaching files to email sent through Excel VBA", "body": "<p>I'm writing a piece of code to populate a spreadsheet, then email it out to a bunch of people with the spreadsheet as an attachment, along with an explanatory PDF and an HTML covering letter (featuring the company logo) in the email body.</p>\n\n<p>Now, I've sent emails with Excel VBA code before, and I've formatted their layout with HTML in the <code>.HTMLBody</code>. But the other bits are causing me some bother.</p>\n\n<p>The attachments I think I can figure out; I assume I can just use multiple <code>.Attachments.Add</code> with the various files, haven't tried that.</p>\n\n<p>The main question is the company logo in the email body. I'm fairly well up on HTML, but I can't figure out how to actually embed a picture when I don't have a <code>src</code> for it.</p>\n\n<p>Googling has produced a few approaches, but they've been <code>cid</code>-based and have had comments about only working if the reader uses Outlook.</p>\n\n<p>Any suggestions? Is there a nice simple solution?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1469620850, "post_id": 38612242, "comment_id": 64610895, "body": "Is it possible that the <code>key</code> is not of the proper type when pulled from the cell?  Or that there is an extra space or something else along those lines?"}, {"owner": {"reputation": 149, "user_id": 6584418, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6660e3f529cd90d79af7d4e4d73a1105?s=128&d=identicon&r=PG&f=1", "display_name": "Matus", "link": "https://stackoverflow.com/users/6584418/matus"}, "reply_to_user": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 1, "creation_date": 1469621229, "post_id": 38612242, "comment_id": 64611161, "body": "Yes you are right. Setting initial test value to <code>key = Range(&quot;G7&quot;).Value</code> gives same error on first test. So this is where the problem lays"}, {"owner": {"reputation": 149, "user_id": 6584418, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6660e3f529cd90d79af7d4e4d73a1105?s=128&d=identicon&r=PG&f=1", "display_name": "Matus", "link": "https://stackoverflow.com/users/6584418/matus"}, "reply_to_user": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 1, "creation_date": 1469622455, "post_id": 38612242, "comment_id": 64612049, "body": "Ok, problem is in source pivottable. I need to find a way how to write it, so if there is no value found in pivottable, it skips to next rcell. Thank you for any tips"}], "answers": [{"tags": [], "owner": {"reputation": 149, "user_id": 6584418, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6660e3f529cd90d79af7d4e4d73a1105?s=128&d=identicon&r=PG&f=1", "display_name": "Matus", "link": "https://stackoverflow.com/users/6584418/matus"}, "is_accepted": true, "score": 0, "last_activity_date": 1469625653, "creation_date": 1469625653, "answer_id": 38614203, "question_id": 38612242, "link": "https://stackoverflow.com/questions/38612242/getpivotdata-in-loop-results-in-run-time-error-1004/38614203#38614203", "title": "Getpivotdata in loop results in run-time error 1004", "body": "<p>Solved. At least it acts as expected, and nothing wrong showing up so far.\nErr.Clear within the loop, so where it hits run-time error 1004 second time, it is able to load it into Err. That's how I understand it</p>\n\n<pre><code>Sub Pivot3()\n\nDim targetregion As Range\nDim pt As PivotTable\nDim rCell As Range\nDim key As Variant\nDim test As Variant\nDim group As Variant\n\nSet pt = Workbooks(\"OPEX.xlsm\").Worksheets(\"Opex_main\").PivotTables(\"PivotTable1\")\nSet targetregion = Range(\"J2:J19\")\n\n\ngroup = Range(\"A7\")\nFor Each rCell In targetregion\n        If rCell.HasFormula Then\n\n            Else\n                    Err.Clear\n                    key = Cells(rCell.Row, 7).Value\n                    On Error Resume Next                        \n                    rCell.Value = pt.GetPivotData(\"SumOfValues\", \"CC_Grouping\", group, \"GL\", key)\n\n        End If\n\nNext rCell\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 6584418, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6660e3f529cd90d79af7d4e4d73a1105?s=128&d=identicon&r=PG&f=1", "display_name": "Matus", "link": "https://stackoverflow.com/users/6584418/matus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 427, "favorite_count": 0, "accepted_answer_id": 38614203, "answer_count": 1, "score": 0, "last_activity_date": 1469625653, "creation_date": 1469620510, "last_edit_date": 1469624464, "question_id": 38612242, "link": "https://stackoverflow.com/questions/38612242/getpivotdata-in-loop-results-in-run-time-error-1004", "title": "Getpivotdata in loop results in run-time error 1004", "body": "<p>I'm trying to get Pivot Table data from a table and enter values into region. I can get the data on test, but the same operation within a loop results in a run-time error 1004. Please see the code below, and again thanks to everyone for their time. Have a nice day</p>\n\n<pre><code>Sub Pivot3()\n\nDim targetregion As Range\nDim pt As PivotTable\nDim rCell As Range\nDim key As Variant\nDim test As Variant\n\nSet pt = Workbooks(\"OPEX.xlsm\").Worksheets(\"Opex_main\").PivotTables(\"PivotTable1\")\nSet targetregion = Range(\"J2:J19\")\n\n\n'testing whether I can get pivot data\nkey = 71010080\ntest = pt.GetPivotData(\"SumOfValues\", \"CC_Grouping\", \"xyz\", \"GL\", key)\nMsgBox test\n'end of test, all good here\n\nFor Each rCell In targetregion\n        If rCell.HasFormula Then\n\n        Else\n            key = Cells(rCell.Row, 7).Value\n            MsgBox key  ' testing if key was properly loaded for the row, all good here\n\n            'here the problem occurs, yet it is same as few lines up\n            test = pt.GetPivotData(\"SumOfValues\", \"CC_Grouping\", \"xyz\", \"GL\", key)\n\n            MsgBox test  'testing if correct value was loaded from pivot table\n            rCell.Value = test\n        End If\nNext rCell\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "string", "vba"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1469619858, "post_id": 38611762, "comment_id": 64610225, "body": "MyArray = Split(MyString,&quot;,&quot;)"}, {"owner": {"reputation": 3, "user_id": 6644366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a730703670b86beaa2e8e2ea26fe51c?s=128&d=identicon&r=PG&f=1", "display_name": "Brother0", "link": "https://stackoverflow.com/users/6644366/brother0"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1469620317, "post_id": 38611762, "comment_id": 64610534, "body": "I think this would be a good way, but there is a possibility that a value also has a comma."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1469621959, "post_id": 38611762, "comment_id": 64611696, "body": "@Brother0 if your array will contain all sorts of wild chards such as <code>;</code> or <code>,</code> then you won&#39;t be able to split the string into array elements. Do you have some kind of marker ?"}, {"owner": {"reputation": 3, "user_id": 6644366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a730703670b86beaa2e8e2ea26fe51c?s=128&d=identicon&r=PG&f=1", "display_name": "Brother0", "link": "https://stackoverflow.com/users/6644366/brother0"}, "edited": false, "score": 0, "creation_date": 1469622550, "post_id": 38611762, "comment_id": 64612136, "body": "Basically the problem is that the values are not seperated by any character but their position in the string. The first four chars in the string describe the poistion of the first value, the position of the next value is then described in the 4 chars that follow. Maybe a solution with regular expression exists for my problem?"}, {"owner": {"reputation": 3, "user_id": 6644366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a730703670b86beaa2e8e2ea26fe51c?s=128&d=identicon&r=PG&f=1", "display_name": "Brother0", "link": "https://stackoverflow.com/users/6644366/brother0"}, "edited": false, "score": 0, "creation_date": 1469623711, "post_id": 38611762, "comment_id": 64613020, "body": "I found a solution via the following regular expression &quot;,?[0-9]{3}:&quot;, after that I will use the method by Stai. Thank you for your help Stai and Shai Rado, as I have some control over the data (I am exporing data from an ERP system) I&#39;think I&#39;ll be able to avoid problems that could occur as the method used depends on some assumptions (text values with the pattern of the regular expression would break the method)."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 0, "last_activity_date": 1469625148, "creation_date": 1469625148, "answer_id": 38614009, "question_id": 38611762, "link": "https://stackoverflow.com/questions/38611762/assigning-multiple-records-generated-via-string-parsing-to-a-vba-array/38614009#38614009", "title": "Assigning multiple records generated via string parsing to a VBA array", "body": "<p>You have an empty value in your example string <code>000:,</code>.   </p>\n\n<p>You can split the values by the colon and then trim the last 4 characters off of each element in the array.  I emptied the first element in the array because it contains a key not a value.    </p>\n\n<pre><code>Sub ArrayUsingSplit()\n   Const StringValues = \"006:170000,004:0002,009:000358827,009:003628325,005:71001,002:71,004:0000,000:,005:95.16,010:1000000.00\"\n   Dim arrValues\n   Dim x As Long\n\n   arrValues = Split(StringValues, \":\")\n\n   arrValues(0) = \"\"\n\n   For x = 1 To UBound(arrValues)\n        arrValues(x) = Left(arrValues(x), Len(arrValues(x)) - 4)\n   Next\n\n   Debug.Print Join(arrValues, \"~\")\nEnd Sub\n</code></pre>\n\n<p>Is this what you are doing? </p>\n\n<pre><code>Sub ArrayUsingMid()\n    Const StringValues = \"006:170000,004:0002,009:000358827,009:003628325,005:71001,002:71,004:0000,000:,005:95.16,010:1000000.00\"\n    Dim i As Long, iStart As Integer, iEnd As Integer, iLength\n\n    Dim arrValues()\n\n    iEnd = 1\n\n    Do\n        ReDim Preserve arrValues(i)\n\n        iStart = InStr(iEnd, StringValues, \":\") + 1\n        iEnd = InStr(iStart, StringValues, \":\")\n        iLength = iEnd - iStart - 4\n\n        If iEnd &gt; 0 Then\n            arrValues(i) = Mid(StringValues, iStart, iLength)\n        Else\n            arrValues(i) = Mid(StringValues, iStart)\n        End If\n\n        i = i + 1\n    Loop Until iEnd = 0\n\n\n    Debug.Print Join(arrValues, \"~\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 0, "last_activity_date": 1469724018, "creation_date": 1469724018, "answer_id": 38642191, "question_id": 38611762, "link": "https://stackoverflow.com/questions/38611762/assigning-multiple-records-generated-via-string-parsing-to-a-vba-array/38642191#38642191", "title": "Assigning multiple records generated via string parsing to a VBA array", "body": "<p>It can be a bit shorter with <code>Evaluate</code>. For example <code>a = [{001,0;005,01.23}]</code> will generate 2 dimensional array with the values <code>( 1, 0 ) , ( 5 , 1.23 )</code>. The code can be something like </p>\n\n<pre><code>s = \"006:170000,004:0002,009:000358827,009:003628325,005:71001,002:71,004:0000,000:\"\n\ns = Replace(s, \",\", \";\")\ns = Replace(s, \":\", \",0\") ' \",0 because Evaluate doesn't allow blank values like \"{1,}\"\n\na = Evaluate(\"{\" &amp; s &amp; \"}\")     ' ( 6, 170000 ), ( 4, 2 ), ( 9, 358827 ), ...\n</code></pre>\n\n<p>If you want to keep the leading zeros, you can keep them as strings:</p>\n\n<pre><code>s = \"006:170000,004:0002,009:000358827,009:003628325,005:71001,002:71,004:0000,000:\"\n\ns = Replace(s, \",\", \"\"\";\"\"\")\ns = Replace(s, \":\", \"\"\",\"\"\")\ns = \"{\"\"\" &amp; s &amp; \"\"\"}\"\n\na = Evaluate(s)       ' ( \"006\", \"170000\" ), ( \"004\", \"0002\" ), ... \n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6644366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a730703670b86beaa2e8e2ea26fe51c?s=128&d=identicon&r=PG&f=1", "display_name": "Brother0", "link": "https://stackoverflow.com/users/6644366/brother0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 1, "accepted_answer_id": 38614009, "answer_count": 2, "score": 0, "last_activity_date": 1469724018, "creation_date": 1469619125, "last_edit_date": 1469620503, "question_id": 38611762, "link": "https://stackoverflow.com/questions/38611762/assigning-multiple-records-generated-via-string-parsing-to-a-vba-array", "title": "Assigning multiple records generated via string parsing to a VBA array", "body": "<p>A line in my text file is in the following format:</p>\n\n<p><strong>length of field</strong> : value</p>\n\n<p>Example:</p>\n\n<p>\"<strong>006</strong>:170000,<strong>004</strong>:0002,<strong>009</strong>:000358827,<strong>009</strong>:003628325,<strong>005</strong>:71001,<strong>002</strong>:71,<strong>004</strong>:0000,<strong>000</strong>:,<strong>005</strong>:95.16,<strong>010</strong>:1000000.00\" ... (length can be much longer)</p>\n\n<p>*The value can also have a comma</p>\n\n<p>I am currently exporting this data in such a way that inside a loop I retrieve the first value and after that I assign this value to a predefined temporary array. This process (string parsing) is repeated until I reach the end of the string. But I find this is slow for large files. What would be a faster way to assign the values I get via parsing of the string to my array?</p>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 6619324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29ae49ec732709349b7ebd975d67dee9?s=128&d=identicon&r=PG&f=1", "display_name": "DipB", "link": "https://stackoverflow.com/users/6619324/dipb"}, "is_accepted": false, "score": 1, "last_activity_date": 1470138108, "creation_date": 1470138108, "answer_id": 38719477, "question_id": 38611431, "link": "https://stackoverflow.com/questions/38611431/tick-checkbox-on-webpage-using-vba/38719477#38719477", "title": "Tick Checkbox on Webpage using VBA", "body": "<p>I got the answer from different site. Below is the workable VBA code for the query,</p>\n\n<pre><code>Set elems = HTMLDoc.getElementsByClassName(\"check\")\nFor Each e In elems\n    If (e.getAttribute(\"value\") = \"120633\") Then\n        e.Click\n        Exit For\n    End If\nNext e\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6619324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29ae49ec732709349b7ebd975d67dee9?s=128&d=identicon&r=PG&f=1", "display_name": "DipB", "link": "https://stackoverflow.com/users/6619324/dipb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2536, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1510117580, "creation_date": 1469618155, "question_id": 38611431, "link": "https://stackoverflow.com/questions/38611431/tick-checkbox-on-webpage-using-vba", "title": "Tick Checkbox on Webpage using VBA", "body": "<p>I am trying to automate one webpage based activity, where I need to select the Checkbox. There are multiple Checkbox available on the page and out of those, I need to select a particular one. I have tried many solutions provided on internet, but it gives me only one error as \"object doesn't support this property or method\". Below is the HTML code for the Checkbox. It would be really helpful if you revert with some VBA code to perform the Tick Checkbox action.</p>\n\n<p>Also please let me know if any additional information is needed.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;input class=\"check\" submitname=\"chkPropLinkId\" type=\"checkbox\" value=\"120633\"&gt;&lt;/input&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1469619631, "post_id": 38611301, "comment_id": 64610042, "body": "Can you please share the code you have tried so far?"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1469621861, "post_id": 38611301, "comment_id": 64611627, "body": "Are you looking at combining to worksheets(Sheet1,Sheet2)  data into a single workbook (sheet1 and sheet2)"}, {"owner": {"reputation": 1, "user_id": 5898445, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c52315b0039ca0cab7b3b865d2d4402f?s=128&d=identicon&r=PG&f=1", "display_name": "sonaa", "link": "https://stackoverflow.com/users/5898445/sonaa"}, "reply_to_user": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1469622793, "post_id": 38611301, "comment_id": 64612328, "body": "I have two separate excel sheet ,i want to merge both the excel in to one excel ...say 1.xls and 2.xls so i need to append the data of 2.xls to 1.xls"}, {"owner": {"reputation": 1, "user_id": 5898445, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c52315b0039ca0cab7b3b865d2d4402f?s=128&d=identicon&r=PG&f=1", "display_name": "sonaa", "link": "https://stackoverflow.com/users/5898445/sonaa"}, "reply_to_user": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1469628999, "post_id": 38611301, "comment_id": 64617168, "body": "@siva: can you please tell me"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5898445, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c52315b0039ca0cab7b3b865d2d4402f?s=128&d=identicon&r=PG&f=1", "display_name": "sonaa", "link": "https://stackoverflow.com/users/5898445/sonaa"}, "edited": false, "score": 0, "creation_date": 1469690987, "post_id": 38628066, "comment_id": 64643614, "body": "Thanks Siva,but i am running it i am getting application object error"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "reply_to_user": {"reputation": 1, "user_id": 5898445, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c52315b0039ca0cab7b3b865d2d4402f?s=128&d=identicon&r=PG&f=1", "display_name": "sonaa", "link": "https://stackoverflow.com/users/5898445/sonaa"}, "edited": false, "score": 0, "creation_date": 1469696641, "post_id": 38628066, "comment_id": 64647188, "body": "Can you please specify the line of code which is giving error? Also which code either 1st or second"}, {"owner": {"reputation": 1, "user_id": 5898445, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c52315b0039ca0cab7b3b865d2d4402f?s=128&d=identicon&r=PG&f=1", "display_name": "sonaa", "link": "https://stackoverflow.com/users/5898445/sonaa"}, "edited": false, "score": 0, "creation_date": 1469697953, "post_id": 38628066, "comment_id": 64648136, "body": "I am getting error in the 7th line  of the code i.e... Set wb1 = Application.Workbooks.Open(&quot;C:\\Users\\...\\Desktop\\1.xlsx&quot;)"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "reply_to_user": {"reputation": 1, "user_id": 5898445, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c52315b0039ca0cab7b3b865d2d4402f?s=128&d=identicon&r=PG&f=1", "display_name": "sonaa", "link": "https://stackoverflow.com/users/5898445/sonaa"}, "edited": false, "score": 0, "creation_date": 1469698509, "post_id": 38628066, "comment_id": 64648540, "body": "Di you replace the file path with your first workbook path?. If not please do. Please change sheet names as per your needs"}, {"owner": {"reputation": 1, "user_id": 5898445, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c52315b0039ca0cab7b3b865d2d4402f?s=128&d=identicon&r=PG&f=1", "display_name": "sonaa", "link": "https://stackoverflow.com/users/5898445/sonaa"}, "edited": false, "score": 0, "creation_date": 1469699247, "post_id": 38628066, "comment_id": 64649067, "body": "Now i am getting at this line ..Set SourceDataRange = ws1.Range(Cells(1, 1), ActiveCell.SpecialCells(xlLastCell))"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "reply_to_user": {"reputation": 1, "user_id": 5898445, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c52315b0039ca0cab7b3b865d2d4402f?s=128&d=identicon&r=PG&f=1", "display_name": "sonaa", "link": "https://stackoverflow.com/users/5898445/sonaa"}, "edited": false, "score": 0, "creation_date": 1469699307, "post_id": 38628066, "comment_id": 64649117, "body": "before this line add ws1.Activate and try.Please post the exact error details.So that it will be easy to address. I have tried both the codesin my machine.Every thing work fine."}, {"owner": {"reputation": 1, "user_id": 5898445, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c52315b0039ca0cab7b3b865d2d4402f?s=128&d=identicon&r=PG&f=1", "display_name": "sonaa", "link": "https://stackoverflow.com/users/5898445/sonaa"}, "edited": false, "score": 0, "creation_date": 1469699534, "post_id": 38628066, "comment_id": 64649268, "body": "i have added but still getting the same error ,Run time error :1004,application defined or object defined error"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "reply_to_user": {"reputation": 1, "user_id": 5898445, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c52315b0039ca0cab7b3b865d2d4402f?s=128&d=identicon&r=PG&f=1", "display_name": "sonaa", "link": "https://stackoverflow.com/users/5898445/sonaa"}, "edited": false, "score": 0, "creation_date": 1469699777, "post_id": 38628066, "comment_id": 64649421, "body": "its working pretty well in my machine.Im not able figure it out why it that happening.Doues your source sheet have data?"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "reply_to_user": {"reputation": 1, "user_id": 5898445, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c52315b0039ca0cab7b3b865d2d4402f?s=128&d=identicon&r=PG&f=1", "display_name": "sonaa", "link": "https://stackoverflow.com/users/5898445/sonaa"}, "edited": false, "score": 0, "creation_date": 1469699894, "post_id": 38628066, "comment_id": 64649496, "body": "Which version of Excel are you using? Is it 2003? Also see this link <a href=\"http://stackoverflow.com/questions/17980854/vba-runtime-error-1004-application-defined-or-object-defined-error-when-select\" title=\"vba runtime error 1004 application defined or object defined error when select\">stackoverflow.com/questions/17980854/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 5898445, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c52315b0039ca0cab7b3b865d2d4402f?s=128&d=identicon&r=PG&f=1", "display_name": "sonaa", "link": "https://stackoverflow.com/users/5898445/sonaa"}, "edited": false, "score": 0, "creation_date": 1469700247, "post_id": 38628066, "comment_id": 64649764, "body": "i did not get that,i am using Excel 2007"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "reply_to_user": {"reputation": 1, "user_id": 5898445, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c52315b0039ca0cab7b3b865d2d4402f?s=128&d=identicon&r=PG&f=1", "display_name": "sonaa", "link": "https://stackoverflow.com/users/5898445/sonaa"}, "edited": false, "score": 0, "creation_date": 1469700355, "post_id": 38628066, "comment_id": 64649849, "body": "Well can you please post the source and destination dummy sample sheets"}, {"owner": {"reputation": 1, "user_id": 5898445, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c52315b0039ca0cab7b3b865d2d4402f?s=128&d=identicon&r=PG&f=1", "display_name": "sonaa", "link": "https://stackoverflow.com/users/5898445/sonaa"}, "edited": false, "score": 0, "creation_date": 1469700865, "post_id": 38628066, "comment_id": 64650182, "body": "ACCOUNT_ID\tA_NUMBER sona  \tjuhi sona12  \trupa454 i have put this in both the sheets"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "reply_to_user": {"reputation": 1, "user_id": 5898445, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c52315b0039ca0cab7b3b865d2d4402f?s=128&d=identicon&r=PG&f=1", "display_name": "sonaa", "link": "https://stackoverflow.com/users/5898445/sonaa"}, "edited": false, "score": 0, "creation_date": 1469701192, "post_id": 38628066, "comment_id": 64650417, "body": "Seems nothing wrong with data. Im not sure what else could be the reason."}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "reply_to_user": {"reputation": 1, "user_id": 5898445, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c52315b0039ca0cab7b3b865d2d4402f?s=128&d=identicon&r=PG&f=1", "display_name": "sonaa", "link": "https://stackoverflow.com/users/5898445/sonaa"}, "edited": false, "score": 0, "creation_date": 1469701466, "post_id": 38628066, "comment_id": 64650613, "body": "what error 1004 error you said earlier or some thing else?"}, {"owner": {"reputation": 1, "user_id": 5898445, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c52315b0039ca0cab7b3b865d2d4402f?s=128&d=identicon&r=PG&f=1", "display_name": "sonaa", "link": "https://stackoverflow.com/users/5898445/sonaa"}, "edited": false, "score": 0, "creation_date": 1469702629, "post_id": 38628066, "comment_id": 64651420, "body": "still the same erroe is thrown"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "reply_to_user": {"reputation": 1, "user_id": 5898445, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c52315b0039ca0cab7b3b865d2d4402f?s=128&d=identicon&r=PG&f=1", "display_name": "sonaa", "link": "https://stackoverflow.com/users/5898445/sonaa"}, "edited": false, "score": 0, "creation_date": 1469702873, "post_id": 38628066, "comment_id": 64651576, "body": "Im Sorry this is all i can suggest as of now. its working for the sample work books that  im using. Not sure why is it not working for you."}, {"owner": {"reputation": 1, "user_id": 5898445, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c52315b0039ca0cab7b3b865d2d4402f?s=128&d=identicon&r=PG&f=1", "display_name": "sonaa", "link": "https://stackoverflow.com/users/5898445/sonaa"}, "edited": false, "score": 0, "creation_date": 1469702944, "post_id": 38628066, "comment_id": 64651626, "body": "Ok Thanks for the help"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "reply_to_user": {"reputation": 1, "user_id": 5898445, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c52315b0039ca0cab7b3b865d2d4402f?s=128&d=identicon&r=PG&f=1", "display_name": "sonaa", "link": "https://stackoverflow.com/users/5898445/sonaa"}, "edited": false, "score": 0, "creation_date": 1469703000, "post_id": 38628066, "comment_id": 64651667, "body": "If you can share the Worknbooks you are using please do. I will give a try"}, {"owner": {"reputation": 1, "user_id": 5898445, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c52315b0039ca0cab7b3b865d2d4402f?s=128&d=identicon&r=PG&f=1", "display_name": "sonaa", "link": "https://stackoverflow.com/users/5898445/sonaa"}, "edited": false, "score": 0, "creation_date": 1469714430, "post_id": 38628066, "comment_id": 64660292, "body": "the code will work  fine if we will replace it with this line,  ActiveSheet.Range(&quot;A1&quot;, ActiveCell.SpecialCells(xlLastCell)).Select"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "reply_to_user": {"reputation": 1, "user_id": 5898445, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c52315b0039ca0cab7b3b865d2d4402f?s=128&d=identicon&r=PG&f=1", "display_name": "sonaa", "link": "https://stackoverflow.com/users/5898445/sonaa"}, "edited": false, "score": 0, "creation_date": 1469770769, "post_id": 38628066, "comment_id": 64684338, "body": "That&#39;s Great!!! Finally it worked.I hope it served what you are looking for"}, {"owner": {"reputation": 1, "user_id": 5898445, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c52315b0039ca0cab7b3b865d2d4402f?s=128&d=identicon&r=PG&f=1", "display_name": "sonaa", "link": "https://stackoverflow.com/users/5898445/sonaa"}, "edited": false, "score": 0, "creation_date": 1470043603, "post_id": 38628066, "comment_id": 64769174, "body": "if i have different number of columns in the second sheet,then how can we achieve the same??"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "reply_to_user": {"reputation": 1, "user_id": 5898445, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c52315b0039ca0cab7b3b865d2d4402f?s=128&d=identicon&r=PG&f=1", "display_name": "sonaa", "link": "https://stackoverflow.com/users/5898445/sonaa"}, "edited": false, "score": 0, "creation_date": 1470044174, "post_id": 38628066, "comment_id": 64769531, "body": "Above code will work fine even if it has different columns, as it blindly copy pastes details from one sheet to another. If you have any specific conditions to be met then you may have to customize the code according to your need"}, {"owner": {"reputation": 1, "user_id": 5898445, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c52315b0039ca0cab7b3b865d2d4402f?s=128&d=identicon&r=PG&f=1", "display_name": "sonaa", "link": "https://stackoverflow.com/users/5898445/sonaa"}, "edited": false, "score": 0, "creation_date": 1470045651, "post_id": 38628066, "comment_id": 64770361, "body": "ya it is working fine but header of the excel sheet is also coming ,how can we remove that?"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "reply_to_user": {"reputation": 1, "user_id": 5898445, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c52315b0039ca0cab7b3b865d2d4402f?s=128&d=identicon&r=PG&f=1", "display_name": "sonaa", "link": "https://stackoverflow.com/users/5898445/sonaa"}, "edited": false, "score": 0, "creation_date": 1470045947, "post_id": 38628066, "comment_id": 64770522, "body": "That&#39;s because you are using <code>ActiveSheet.Range(&quot;A1&quot;, ActiveCell.SpecialCells(xlLastCell)).Select </code> for copying the content from sheet1.So header row is also copied there, just replace it with <code>ActiveSheet.Range(&quot;A2&quot;, ActiveCell.SpecialCells(xlLastCell)).Select </code>"}], "tags": [], "owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "is_accepted": false, "score": 0, "last_activity_date": 1469701768, "last_edit_date": 1469701768, "creation_date": 1469685209, "answer_id": 38628066, "question_id": 38611301, "link": "https://stackoverflow.com/questions/38611301/merge-content-of-two-excel-file-using-vb-macro-code/38628066#38628066", "title": "Merge content of two Excel file using VB macro Code", "body": "<p>Below Code will Copys Entire Sheet1 of WorkBook1 and places to WorkBook2 after Sheet1</p>\n\n<pre><code>Sub CopySheet_From_WB1_To_WB2()\n    Dim wb1 As Workbook\n    Dim wb2 As Workbook\n    Dim ws1 As Worksheet\n    Dim ws2 As Worksheet\n\n   Set wb1 = Application.Workbooks.Open(\"C:\\Users\\...\\Desktop\\1.xlsx\")\n   Set ws1 = wb1.Sheets(\"sheet1\") 'replece 'Sheet1' with your sheet name\n   Set wb2 = Application.Workbooks.Open(\"C:\\Users\\...\\Desktop\\2.xlsx\")\n   'Copying WorkBook1's Sheet1 to Workbook2 after Sheet1\n    ws1.Copy After:=wb2.Sheets(\"Sheet1\") 'replece 'Sheet1' with your sheet name\n\n   wb1.Save\n   wb1.Close\n\n   wb2.Save\n   wb2.Close\n\nEnd Sub\n</code></pre>\n\n<p>Below Code will copy used cells values from Sheet1 of Workbook1 and paste after last used row of Sheet1 of Workbook2</p>\n\n<pre><code>Sub CopySheet1Data_to_Sheet2()\n    Dim wb1 As Workbook\n    Dim wb2 As Workbook\n    Dim ws1 As Worksheet\n    Dim ws2 As Worksheet\n\n    Set wb1 = Application.Workbooks.Open(\"C:\\Users\\...\\Desktop\\1.xlsx\")\n    Set ws1 = wb1.Sheets(\"sheet1\") 'replece 'Sheet1' with your sheet name\n    ws1.Range(Cells(1, 1), ActiveCell.SpecialCells(xlLastCell)).Select\n\n    Selection.Copy\n    Set wb2 = Application.Workbooks.Open(\"C:\\Users\\..\\Desktop\\2.xlsx\")\n    Set ws2 = wb2.Sheets(\"Sheet1\")\n    ws2.Activate\n    lastUsedRow = ActiveCell.SpecialCells(xlLastCell).Row\n    ws2.Cells(lastUsedRow + 1, 1).Select\n    ActiveSheet.Paste\n\n    wb1.Save\n    wb1.Close\n\n    wb2.Save\n    wb2.Close\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5898445, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c52315b0039ca0cab7b3b865d2d4402f?s=128&d=identicon&r=PG&f=1", "display_name": "sonaa", "link": "https://stackoverflow.com/users/5898445/sonaa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1472305166, "creation_date": 1469617845, "last_edit_date": 1531164843, "question_id": 38611301, "link": "https://stackoverflow.com/questions/38611301/merge-content-of-two-excel-file-using-vb-macro-code", "title": "Merge content of two Excel file using VB macro Code", "body": "<p>how to merge content of two Excel file using VB macro Code .</p>\n\n<pre><code>Sub GetSheets() \nDim temp As String \nPath = \"C:\\Users\\....\\ Desktop\\Excel combine\\\" \nFilename = Dir(Path &amp; \"*.xlsx\") \n\nDo While Filename \"\" Workbooks.Open Filename:=Path &amp; Filename, ReadOnly:=True \n\ntemp = ActiveWorkbook.Name ActiveSheet.Name = temp \n\nActiveWorkbook.Sheets(temp).Copy After:=ThisWorkbook.Sheets(1)\nWorkbooks(Filename).Close \n\nFilename = Dir() \nLoop \n\nEnd Sub\n</code></pre>\n\n<p>The code what i am getting online is not meeting the requirement.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 5180846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-SN4L4Xqqgng/AAAAAAAAAAI/AAAAAAAAACs/eyc_pQ0C5Bw/photo.jpg?sz=128", "display_name": "Tony Y", "link": "https://stackoverflow.com/users/5180846/tony-y"}, "edited": false, "score": 0, "creation_date": 1469622649, "post_id": 38611712, "comment_id": 64612219, "body": "This can only work if my data starts from row 1, right ? What code should I add if I want this function to work starting from P11 ? Because above P11 are other things such as headlines and dates"}, {"owner": {"reputation": 865, "user_id": 6588969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec413f82a9798b72db70b0585a7bec99?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Kuchlbauer", "link": "https://stackoverflow.com/users/6588969/julian-kuchlbauer"}, "reply_to_user": {"reputation": 9, "user_id": 5180846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-SN4L4Xqqgng/AAAAAAAAAAI/AAAAAAAAACs/eyc_pQ0C5Bw/photo.jpg?sz=128", "display_name": "Tony Y", "link": "https://stackoverflow.com/users/5180846/tony-y"}, "edited": false, "score": 0, "creation_date": 1469622716, "post_id": 38611712, "comment_id": 64612265, "body": "Then just replace the second line with the number you wish: e.g. i = 11"}, {"owner": {"reputation": 9, "user_id": 5180846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-SN4L4Xqqgng/AAAAAAAAAAI/AAAAAAAAACs/eyc_pQ0C5Bw/photo.jpg?sz=128", "display_name": "Tony Y", "link": "https://stackoverflow.com/users/5180846/tony-y"}, "edited": false, "score": 0, "creation_date": 1469623042, "post_id": 38611712, "comment_id": 64612524, "body": "Thank you very much!! Now works perfectly! Really appreciate your help!!"}, {"owner": {"reputation": 865, "user_id": 6588969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec413f82a9798b72db70b0585a7bec99?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Kuchlbauer", "link": "https://stackoverflow.com/users/6588969/julian-kuchlbauer"}, "reply_to_user": {"reputation": 9, "user_id": 5180846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-SN4L4Xqqgng/AAAAAAAAAAI/AAAAAAAAACs/eyc_pQ0C5Bw/photo.jpg?sz=128", "display_name": "Tony Y", "link": "https://stackoverflow.com/users/5180846/tony-y"}, "edited": false, "score": 0, "creation_date": 1469623104, "post_id": 38611712, "comment_id": 64612569, "body": "I am glad to be of service."}, {"owner": {"reputation": 9, "user_id": 5180846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-SN4L4Xqqgng/AAAAAAAAAAI/AAAAAAAAACs/eyc_pQ0C5Bw/photo.jpg?sz=128", "display_name": "Tony Y", "link": "https://stackoverflow.com/users/5180846/tony-y"}, "edited": false, "score": 0, "creation_date": 1470750553, "post_id": 38611712, "comment_id": 65069292, "body": "These days, I tried to modify your code so that it can select all blank cells first and then merge all in once.(For example, select P2:P4, then merge; instead of merge P2:P3, then unmerge, and merge P2:P4 again )   I have tried to use resize, but it doesn&#39;t work. Can I have any suggestion from you ?"}, {"owner": {"reputation": 865, "user_id": 6588969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec413f82a9798b72db70b0585a7bec99?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Kuchlbauer", "link": "https://stackoverflow.com/users/6588969/julian-kuchlbauer"}, "reply_to_user": {"reputation": 9, "user_id": 5180846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-SN4L4Xqqgng/AAAAAAAAAAI/AAAAAAAAACs/eyc_pQ0C5Bw/photo.jpg?sz=128", "display_name": "Tony Y", "link": "https://stackoverflow.com/users/5180846/tony-y"}, "edited": false, "score": 0, "creation_date": 1470750699, "post_id": 38611712, "comment_id": 65069399, "body": "Please never use select, it slows the code down unnecessarily. So you want the same behaviour, but instead of merging one by one it should be merged once for every blank area?"}, {"owner": {"reputation": 9, "user_id": 5180846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-SN4L4Xqqgng/AAAAAAAAAAI/AAAAAAAAACs/eyc_pQ0C5Bw/photo.jpg?sz=128", "display_name": "Tony Y", "link": "https://stackoverflow.com/users/5180846/tony-y"}, "edited": false, "score": 0, "creation_date": 1470751272, "post_id": 38611712, "comment_id": 65069822, "body": "oh! I have read articles about not using select. Yes I was trying to merge once for every blank area, but not all blank area in the column. (I am just curious whether this is possible ^.^ , recently I have found a lot of fun learning about vba, thanks for you help BTW)"}, {"owner": {"reputation": 865, "user_id": 6588969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec413f82a9798b72db70b0585a7bec99?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Kuchlbauer", "link": "https://stackoverflow.com/users/6588969/julian-kuchlbauer"}, "reply_to_user": {"reputation": 9, "user_id": 5180846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-SN4L4Xqqgng/AAAAAAAAAAI/AAAAAAAAACs/eyc_pQ0C5Bw/photo.jpg?sz=128", "display_name": "Tony Y", "link": "https://stackoverflow.com/users/5180846/tony-y"}, "edited": false, "score": 0, "creation_date": 1470751548, "post_id": 38611712, "comment_id": 65070056, "body": "Yes, it is possible to do it and it would be an improvement to my code :). I&#39;ll take a look at it this afternoon."}, {"owner": {"reputation": 865, "user_id": 6588969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec413f82a9798b72db70b0585a7bec99?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Kuchlbauer", "link": "https://stackoverflow.com/users/6588969/julian-kuchlbauer"}, "reply_to_user": {"reputation": 9, "user_id": 5180846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-SN4L4Xqqgng/AAAAAAAAAAI/AAAAAAAAACs/eyc_pQ0C5Bw/photo.jpg?sz=128", "display_name": "Tony Y", "link": "https://stackoverflow.com/users/5180846/tony-y"}, "edited": false, "score": 0, "creation_date": 1470807942, "post_id": 38611712, "comment_id": 65093192, "body": "Try the now edited code, it should work with the improvement."}, {"owner": {"reputation": 9, "user_id": 5180846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-SN4L4Xqqgng/AAAAAAAAAAI/AAAAAAAAACs/eyc_pQ0C5Bw/photo.jpg?sz=128", "display_name": "Tony Y", "link": "https://stackoverflow.com/users/5180846/tony-y"}, "edited": false, "score": 0, "creation_date": 1470903934, "post_id": 38611712, "comment_id": 65141939, "body": "That works perfectly! You just give me another lesson. Let me study the logic behind this code. Thank you again for your teaching!"}, {"owner": {"reputation": 865, "user_id": 6588969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec413f82a9798b72db70b0585a7bec99?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Kuchlbauer", "link": "https://stackoverflow.com/users/6588969/julian-kuchlbauer"}, "reply_to_user": {"reputation": 9, "user_id": 5180846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-SN4L4Xqqgng/AAAAAAAAAAI/AAAAAAAAACs/eyc_pQ0C5Bw/photo.jpg?sz=128", "display_name": "Tony Y", "link": "https://stackoverflow.com/users/5180846/tony-y"}, "edited": false, "score": 0, "creation_date": 1470909257, "post_id": 38611712, "comment_id": 65145529, "body": "Feel free to ask questions if necessary."}], "tags": [], "owner": {"reputation": 865, "user_id": 6588969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec413f82a9798b72db70b0585a7bec99?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Kuchlbauer", "link": "https://stackoverflow.com/users/6588969/julian-kuchlbauer"}, "is_accepted": true, "score": 1, "last_activity_date": 1470807893, "last_edit_date": 1470807893, "creation_date": 1469618965, "answer_id": 38611712, "question_id": 38611191, "link": "https://stackoverflow.com/questions/38611191/how-to-merge-cell-in-a-column-if-cell-above-it-has-content-but-itself-is-blank/38611712#38611712", "title": "How to merge cell in a column if cell above it has content but itself is blank", "body": "<p>Try this:</p>\n\n<pre><code>Dim i As Integer, a As String, b As String, c As Integer, d  As Integer\ni = 11\na = \"B\"\nb = \"P\"\nc = 0\nd = 0\nWhile Range(a &amp; i) &lt;&gt; \"\"\n    If Range(b &amp; i) = \"\" Then\n        If c = 0 And i &gt; 1 Then\n            c = i - 1\n            d = 1\n        Else\n            d = d + 1\n        End If\n    Else\n        If c &gt; 0 And d &gt; 0 Then\n            Range(b &amp; c &amp; \":\" &amp; b &amp; (c + d)).Merge\n        End If\n        c = 0\n        d = 0\n    End If\n    i = i + 1\nWend\nIf c &gt; 0 And d &gt; 0 Then\n    Range(b &amp; c &amp; \":\" &amp; b &amp; (c + d)).Merge\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 5180846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-SN4L4Xqqgng/AAAAAAAAAAI/AAAAAAAAACs/eyc_pQ0C5Bw/photo.jpg?sz=128", "display_name": "Tony Y", "link": "https://stackoverflow.com/users/5180846/tony-y"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 302, "favorite_count": 0, "accepted_answer_id": 38611712, "answer_count": 1, "score": 0, "last_activity_date": 1470807893, "creation_date": 1469617508, "last_edit_date": 1469619438, "question_id": 38611191, "link": "https://stackoverflow.com/questions/38611191/how-to-merge-cell-in-a-column-if-cell-above-it-has-content-but-itself-is-blank", "title": "How to merge cell in a column if cell above it has content but itself is blank", "body": "<p>Here is what trouble me:</p>\n\n<p>For cells in column P, for example P3, if both P2 &amp; B3 is not blank, but P3 is blank, then merge P2 with P3. And go on next cell in column P until respective cell in column B(for instance: B8) is blank, then stop.</p>\n\n<pre><code>       B      ....      P\n 1  Monitor            Tom\n 2   Mouse             Ann\n 3  Keyboard\n 4  Sticker\n 5  Speaker            John\n 6   Cable\n 7    Fan              Rose\n 8\n</code></pre>\n\n<p>So for table above, I want to merge P2:P4 &amp; P5:P6.\nI've tried several time with my poor vba skill, but failed...</p>\n\n<p>This code is what I've found in this website, and I've tried to edit it and see if this can solve my problem, but it doesn't work...</p>\n\n<pre><code>Sub Merge()\nLR = ActiveSheet.Cells(Rows.Count, \"B\").End(xlUp).Row\nFor i = 1 To LR\nIf ActiveSheet.Cells(i, 1).Value &lt;&gt; \"\" And ActiveSheet.Cells(i + 1, 1).Value = \"\" And ActiveSheet.Cells(i + 1, 2).Value &lt;&gt; \"\" Then\n   u = i + 1\n   Do While ActiveSheet.Cells(u, 1).Value = \"\" And ActiveSheet.Cells(u, 2) &lt;&gt; \"\"\n        u = u + 1\n    Loop\n    ActiveSheet.Range(\"A\" &amp; i &amp; \":A\" &amp; (u - 1)).Select\n    With Selection\n        .Merge\n        .BorderAround Weight:=xlMedium\n        .WrapText = True\n        '.VerticalAlignment = x1VAlignTop\n        '.HorizontalAlignment = xlLeft\n    End With\n    Sheets(DataSheet).Range(\"B\" &amp; i &amp; \":B\" &amp; (u - 1)).BorderAround Weight:=xlMedium\n    i = u + 1\nEnd If\n</code></pre>\n\n<p>Next i\nEnd Sub</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1469617593, "post_id": 38611087, "comment_id": 64608629, "body": "It fails because you set <code>OutMail</code> to <code>Nothing</code> within the loop but never insantiate it again within the loop. The code won&#39;t fail because of your <code>On Error Resume Next</code> line. Try setting <code>OutMail</code> within the loop."}, {"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "reply_to_user": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1469618221, "post_id": 38611087, "comment_id": 64609057, "body": "@Ambie that was it! Thx"}, {"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "reply_to_user": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1469619090, "post_id": 38611087, "comment_id": 64609657, "body": "Could you also give me a hint on why the attachment wont load (and yes I&#39;m aware that I have removed it;))"}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1469630885, "post_id": 38611087, "comment_id": 64618745, "body": "You should pose a new question for that."}, {"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "reply_to_user": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1469630944, "post_id": 38611087, "comment_id": 64618794, "body": "Figured it out. Just me being lazy"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1542135024, "post_id": 38611087, "comment_id": 93457338, "body": "The root of the problem is misuse of on Error Resume Next. Restrict use to where it is appropriate so you see errors to fix. <a href=\"https://stackoverflow.com/a/31753321/1571407\">stackoverflow.com/a/31753321/1571407</a>"}], "answers": [{"tags": [], "owner": {"reputation": 712, "user_id": 6430027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f78a373cd59d67005e32407d8b0663e?s=128&d=identicon&r=PG&f=1", "display_name": "Mono", "link": "https://stackoverflow.com/users/6430027/mono"}, "is_accepted": true, "score": 1, "last_activity_date": 1469617573, "creation_date": 1469617573, "answer_id": 38611214, "question_id": 38611087, "link": "https://stackoverflow.com/questions/38611087/failes-to-send-mail-after-first-in-loop/38611214#38611214", "title": "failes to send mail after first in loop", "body": "<p>When you set    </p>\n\n<pre><code>Set OutMail = Nothing\n</code></pre>\n\n<p>You dont have any access to the object anymore (because it is destroyed). But you set it before the loop. You need to set it in every loop then like this:</p>\n\n<pre><code>    On Error Resume Next\n    Set OutMail = OutApp.CreateItem(0)\n    With OutMail\n        .Display\n        .To = cell.Value\n        .Subject = Range(\"K12\").Value\n        .HTMLBody = strbody &amp; .HTMLBody\n        'You can add files also like this\n        '.Attachments.Add Range(\"O1\").Value\n        .Send\n    End With\n    On Error GoTo 0\n    Set OutMail = Nothing\n</code></pre>\n\n<p>So after 1 Email the oject is destroyed, but you are not aware because of the on error resume next</p>\n"}, {"comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1542121394, "post_id": 53269884, "comment_id": 93449405, "body": "This adds an EOF idea that is not applicable to the question. If you use this consider moving <code>Set mail_object = CreateObject(&quot;Outlook.Application&quot;)</code> before <code>Do Until in_file.EOF</code> and moving <code>Set mail_object = Nothing</code> after <code>Loop</code>."}], "tags": [], "owner": {"reputation": 1, "user_id": 10642789, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/e17f6eefe51190585a572fff3e07d62f?s=128&d=identicon&r=PG", "display_name": "Richard Hewitt", "link": "https://stackoverflow.com/users/10642789/richard-hewitt"}, "is_accepted": false, "score": 0, "last_activity_date": 1542055783, "creation_date": 1542055783, "answer_id": 53269884, "question_id": 38611087, "link": "https://stackoverflow.com/questions/38611087/failes-to-send-mail-after-first-in-loop/53269884#53269884", "title": "failes to send mail after first in loop", "body": "<pre><code>Tried that but it is not working for me, here is my code:\nDo Until in_file.EOF\nEmail_To = in_file!email_address\nEmail_Bcc = \"\"\nEmail_Body = in_file!email_salut &amp; \" \" &amp; in_file!email_name &amp; \", test this.\"\nEmail_Subject = \"Email Subject\"\nSet mail_object = CreateObject(\"Outlook.Application\")\nSet mail_single = mail_object.CreateItem(0)\n\nWith mail_single\n    .Subject = Email_Subject\n    .To = Email_To\n    .cc = Email_Cc\n    .BCC = Email_Bcc\n    .Body = Email_Body\n    .send\nEnd With\n\nSet mail_object = Nothing\nSet mail_single = Nothing\n\nin_file.MoveNext\n</code></pre>\n\n<p>Loop</p>\n"}], "owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 38611214, "answer_count": 2, "score": 1, "last_activity_date": 1542055783, "creation_date": 1469617168, "last_edit_date": 1531164843, "question_id": 38611087, "link": "https://stackoverflow.com/questions/38611087/failes-to-send-mail-after-first-in-loop", "title": "failes to send mail after first in loop", "body": "<p>Got a macro running through columns with mail addresses using most parts from <strong>Ron de Bruin</strong>. \nThe macro runs through just fine, but only sends the first hit in <code>column B</code> and doesn't display any of the other hits when i try to watch it? What could be the issue?</p>\n\n<p>The code is so that I can get the default signature from outlook, thats why it's <code>.Display</code> first in the code.</p>\n\n<pre><code>Sub mail_HTML()\n'For Tips see: http://www.rondebruin.nl/win/winmail/Outlook/tips.htm\n'Working in Office 2000-2016\nDim OutApp As Object\nDim OutMail As Object\nDim cell As Range\nDim strbody As String\n\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\n\nOn Error GoTo cleanup\nFor Each cell In Columns(\"B\").Cells.SpecialCells(xlCellTypeConstants)\n    If cell.Value Like \"?*@?*.?*\" And _\n       LCase(Cells(cell.Row, \"C\").Value) = \"yes\" Then\n\nstrbody = \"&lt;H3&gt;Hei \" &amp; Cells(cell.Row, \"E\").Value &amp; \"&lt;/H3&gt;\" _\n             &amp; \"&lt;p&gt;\" &amp; Range(\"k4\") &amp; \"&lt;p&gt;\"\n\n         On Error Resume Next\n        With OutMail\n            .Display\n            .To = cell.Value\n            .Subject = Range(\"K12\").Value\n            .HTMLBody = strbody &amp; .HTMLBody\n            'You can add files also like this\n            '.Attachments.Add Range(\"O1\").Value\n            .Send\n        End With\n        On Error GoTo 0\n        Set OutMail = Nothing\n    End If\nNext cell\n\ncleanup:\nSet OutApp = Nothing\nApplication.ScreenUpdating = True\nEnd Sub \n</code></pre>\n"}, {"tags": ["vba", "excel", "ole", "ibm-doors"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1469623269, "post_id": 38610807, "comment_id": 64612715, "body": "If the DOORS object doesn&#39;t expose this functionality, it&#39;s likely that the only way to do this will be with API functions.  Take a look at <a href=\"http://stackoverflow.com/questions/34440961/how-to-locate-the-window-using-findwindow-function-in-windowapi-using-vba\">How to locate the window using findwindow function in windowapi using vba?</a> and <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms646312(v=vs.85).aspx\" rel=\"nofollow noreferrer\">SetFocus</a>."}], "owner": {"reputation": 330, "user_id": 6330878, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/IDwth.jpg?s=128&g=1", "display_name": "J Lewis", "link": "https://stackoverflow.com/users/6330878/j-lewis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 668, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1469623287, "creation_date": 1469616455, "last_edit_date": 1531164843, "question_id": 38610807, "link": "https://stackoverflow.com/questions/38610807/vba-how-to-set-focus-on-ole-object-window-ibm-doors", "title": "VBA - How to set focus on OLE object window (IBM DOORS)", "body": "<p>I'm writing a script in the VB to be used in excel, I'm using OLE to run a DXL script in DOORS. The DOORS script creates a popup window, which I'd like to give focus to when it's created.</p>\n\n<p>Currently I have reference to the DOORS object, but I can't seem to find out how to set focus to the window. It might be that it's something that I have to do in the dxl, but I was wondering if there's a way to do this on the VB side of things.</p>\n\n<p>So far I have:</p>\n\n<pre><code>Public Sub DoThing()\n    Const DxlFilepath As String = \"C:\\FilePath\"\n\n    Dim DOORSObj As Object\n\n    'Double check the user wants to do this\n    vbCreateList = MsgBox(\"Current list will be lost. Please confirm to proceed? (Note: Parent folder must be selected in DOORS popup)\", vbOKCancel, \"Do thing\")\n    If (vbCreateList = vbCancel) Then\n        Exit Sub\n    End If\n\n    'Get access to the DOORS application database\n    Set DOORSObj = CreateObject(\"DOORS.Application\")\n    DOORSObj.result = \"OK\"\n    DOORSObj.runFile (DxlFilepath)\n\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["excel", "vba", "sorting"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1469616270, "post_id": 38610568, "comment_id": 64607736, "body": "Selection.Range(&quot;A4&quot;)"}, {"owner": {"reputation": 11, "user_id": 6644172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb6d5cc920bb4225b11c0b5afda199ad?s=128&d=identicon&r=PG&f=1", "display_name": "akshatha chandrashekar", "link": "https://stackoverflow.com/users/6644172/akshatha-chandrashekar"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1469617363, "post_id": 38610568, "comment_id": 64608457, "body": "Still not working.Its giving the same error :("}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1469618536, "post_id": 38610568, "comment_id": 64609267, "body": "I can&#39;t reproduce this error, but I get &quot;Sort method of Range class failed&quot; error if only one cell is selected and works if more than one cell is selected."}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 1, "creation_date": 1469619399, "post_id": 38610568, "comment_id": 64609873, "body": "If the <code>Selection</code> doesn&#39;t contain the specified key range, the sort method will fail"}], "answers": [{"comments": [{"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 1, "creation_date": 1469620174, "post_id": 38611943, "comment_id": 64610425, "body": "While accurate, you can&#39;t really sort a range of one cell :P"}], "tags": [], "owner": {"reputation": 11, "user_id": 6644080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/319472c2f890597fd71b7d061839caf9?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Podivinsky", "link": "https://stackoverflow.com/users/6644080/peter-podivinsky"}, "is_accepted": false, "score": 1, "last_activity_date": 1469625099, "last_edit_date": 1469625099, "creation_date": 1469619641, "answer_id": 38611943, "question_id": 38610568, "link": "https://stackoverflow.com/questions/38610568/sort-method-of-range-class-failed/38611943#38611943", "title": "Sort Method of Range class failed", "body": "<p>Try to avoid use of 'Selection'. Try instead a full reference:</p>\n\n<pre><code>ThisWorkbook.Sheets(\"Sheet1\").Range(\"Table1\").Sort\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6644172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb6d5cc920bb4225b11c0b5afda199ad?s=128&d=identicon&r=PG&f=1", "display_name": "akshatha chandrashekar", "link": "https://stackoverflow.com/users/6644172/akshatha-chandrashekar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 655, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1469625099, "creation_date": 1469615802, "last_edit_date": 1469616310, "question_id": 38610568, "link": "https://stackoverflow.com/questions/38610568/sort-method-of-range-class-failed", "title": "Sort Method of Range class failed", "body": "<p>I am new to VBA and having a hard time figuring out this code.I am doing a course online and i followed the same steps but somehow i'm getting an error.I recently installed Excel 2013 and dont know if thats the issue.I tried putting .Range(\"A4\") but that gives me an error of <strong>\"Invalid or Unqualified Reference\"</strong></p>\n\n<pre><code>Sub DivisionSort()\n'\n' Sort List by Division Ascending\n'\n\n'\n    Selection.Sort Key1:=Range(\"A4\"), Order1:=xlAscending, Header:=xlGuess, _\n        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _\n        DataOption1:=xlSortNormal\n\nEnd Sub\n\nSub CategorySort()\n'\n' Sort List by Category Ascending\n'\n\n'\n    Selection.Sort Key1:=Range(\"B4\"), Order1:=xlAscending, Header:=xlGuess, _\n        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _\n        DataOption1:=xlSortNormal\n\nEnd Sub\n\nSub TotalSort()\n'\n' Sort List by Total Sales Ascending\n'\n\n'\n    Selection.Sort Key1:=Range(\"F4\"), Order1:=xlAscending, Header:=xlGuess, _\n        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _\n        DataOption1:=xlSortNormal\n\nEnd Sub\n\n\nPublic Sub SortList()\n    Dim userinput As String\n    userinput = InputBox(\"1=Sort by Division, 2=Sort by Category,3=Sort by Total\")\n    If userinput = \"1\" Then\n    DivisionSort\n    ElseIf userinput = \"2\" Then\n    CategorySort\n    ElseIf userinput = \"3\" Then\n    TotalSort\n\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "macros"], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 1954762, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5677d88b35ef2df90b9c2bf06821b2fb?s=128&d=identicon&r=PG", "display_name": "user1954762", "link": "https://stackoverflow.com/users/1954762/user1954762"}, "edited": false, "score": 0, "creation_date": 1469616419, "post_id": 38610427, "comment_id": 64607830, "body": "it&#39;s making ans_str = 1 2 3 .. n .. but I actually needed as ans_str = conc(1,2,3,...n)"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 159, "user_id": 1954762, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5677d88b35ef2df90b9c2bf06821b2fb?s=128&d=identicon&r=PG", "display_name": "user1954762", "link": "https://stackoverflow.com/users/1954762/user1954762"}, "edited": false, "score": 0, "creation_date": 1469618461, "post_id": 38610427, "comment_id": 64609216, "body": "@user1954762 what do you want the answer to be ?"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1469615394, "creation_date": 1469615394, "answer_id": 38610427, "question_id": 38610236, "link": "https://stackoverflow.com/questions/38610236/macro-for-concatenating-array/38610427#38610427", "title": "Macro for concatenating array", "body": "<p>Lets say your N = 100 (for this example), see code below.</p>\n\n<pre><code>Option Explicit\n\nDim ex_Array()          As Variant\nDim i                   As Integer\nDim ans_str             As String\n\nSub concen()\n\nReDim ex_Array(0 To 100)    \nex_Array(0) = \"1\"\nex_Array(1) = \"2\"\nex_Array(3) = \"3\"\n\nFor i = 0 To UBound(ex_Array)\n    ans_str = ans_str &amp; ex_Array(i)    \nNext i    \nMsgBox ans_str\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "is_accepted": false, "score": 5, "last_activity_date": 1469615595, "creation_date": 1469615595, "answer_id": 38610501, "question_id": 38610236, "link": "https://stackoverflow.com/questions/38610236/macro-for-concatenating-array/38610501#38610501", "title": "Macro for concatenating array", "body": "<p>If you want to concatenate the whole array, use</p>\n\n<pre><code>myString = Join(array,\"\")\n</code></pre>\n\n<p>The second argument is the delimeter (default is <code>\" \"</code>, not <code>\"\"</code>)</p>\n"}], "owner": {"reputation": 159, "user_id": 1954762, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5677d88b35ef2df90b9c2bf06821b2fb?s=128&d=identicon&r=PG", "display_name": "user1954762", "link": "https://stackoverflow.com/users/1954762/user1954762"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1469616264, "creation_date": 1469614911, "last_edit_date": 1469616264, "question_id": 38610236, "link": "https://stackoverflow.com/questions/38610236/macro-for-concatenating-array", "title": "Macro for concatenating array", "body": "<p>I am having some array of value as below.</p>\n\n<pre><code>array(0) = \"1\"\narray(1) = \"2\"\narray(3) = \"3\"\n.\n.\n.\narray(n) = \"n\"\n</code></pre>\n\n<p>there are N number of array I have to append to string as</p>\n\n<pre><code>String = combined(array(0),array(1),.....,array(n))\n</code></pre>\n\n<p>can someone please advise.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1469615138, "post_id": 38610067, "comment_id": 64606954, "body": "Are you adding all the records to an array?"}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1469615642, "post_id": 38610067, "comment_id": 64607323, "body": "Yep, I need to count the records to redim the array, then i will add them in"}], "answers": [{"comments": [{"owner": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "edited": false, "score": 0, "creation_date": 1618499389, "post_id": 38610750, "comment_id": 118624663, "body": "I have a complex union in the <code>source</code> part of recordset and this method doesn&#39;t appear to work for me. Same exact declaration and everything. Also P.S. <code>GetRows()</code> is great, until your dataset is huge. Sadly, my dataset is outside the range where GetRows() works."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 7, "last_activity_date": 1469616764, "last_edit_date": 1469616764, "creation_date": 1469616285, "answer_id": 38610750, "question_id": 38610067, "link": "https://stackoverflow.com/questions/38610067/vba-rowset-does-not-support-fetching-backward-error-with-cursertype-adjusted/38610750#38610750", "title": "VBA &quot;rowset does not support fetching backward&quot; error with .cursertype adjusted", "body": "<p>The problem is caused by using conn.Execute to fill the recordset.  Setting the recordset's activeconnection to the ADODB.Connection and using the recordset's open method will fix the issue.</p>\n\n<pre><code>Function ConnectServer() As String()\n   'Working SQL Server connection\n\n    Dim conn As ADODB.Connection\n    Dim rs As ADODB.Recordset\n    Dim sConnString As String\n    Dim strSqlQuery As String\n    Dim iCols As Long\n\n    ' Create the connection string.\n    sConnString = \"Provider=SQLOLEDB;Data Source=wait;\" &amp; _\n                  \"Initial Catalog=what;\" &amp; _\n                  \"User Id=foo;\" &amp; _\n                  \"Password=bar;\"\n\n    ' Create the Connection and Recordset objects.\n    Set conn = New ADODB.Connection\n    conn.ConnectionString = sConnString\n    conn.Open\n\n    Set rs = New ADODB.Recordset\n\n    With rs\n        .ActiveConnection = conn\n        .CursorType = adOpenDynamic\n        .LockType = adLockOptimistic\n        .Source = \"SELECT * FROM b\"\n        .Open\n    End With\n\n    ' Check we have data.\n    If Not rs.EOF Then\n\n        rs.MoveLast\n        Debug.Print rs.RecordCount\n\n        'Read into array and cleanup...\n    End If\n\nEnd Function\n</code></pre>\n\n<p>You can use Recordset.GetRows() to fill the array.  No need to dim it. <a href=\"https://msdn.microsoft.com/en-us/library/ms675120(v=vs.85).aspx\" rel=\"noreferrer\">GetRows Method (ADO)</a></p>\n"}], "owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5752, "favorite_count": 2, "accepted_answer_id": 38610750, "answer_count": 1, "score": 4, "last_activity_date": 1506611594, "creation_date": 1469614483, "last_edit_date": 1531164843, "question_id": 38610067, "link": "https://stackoverflow.com/questions/38610067/vba-rowset-does-not-support-fetching-backward-error-with-cursertype-adjusted", "title": "VBA &quot;rowset does not support fetching backward&quot; error with .cursertype adjusted", "body": "<p>Using the following code I open a connection with SQL server and drop the results straight into an array.  My problem is that I get an error for the rowcount, which I need to redim my array.  The error I get is on the line indicated below and reads </p>\n\n<blockquote>\n  <p>\"rowset does not support fetching backward\"</p>\n</blockquote>\n\n<p>All answers I can find suggest the cursor type as the problem, but I have changed this as far as I can tell.  Apologies for the long code, I felt it best to leave the start in.</p>\n\n<pre><code>Function ConnectServer() As String()\n'Working SQL Server connection\n\nDim conn As ADODB.Connection\nDim rs As ADODB.Recordset\nDim sConnString As String\nDim strSqlQuery As String\nDim iCols As Long\n\n\n' Create the connection string.\nsConnString = \"Provider=SQLOLEDB;Data Source=wait;\" &amp; _\n              \"Initial Catalog=what;\" &amp; _\n              \"User Id=foo;\" &amp; _\n              \"Password=bar;\"\n\n' Create the Connection and Recordset objects.\nSet conn = New ADODB.Connection\nSet rs = New ADODB.Recordset\nrs.CursorType = adOpenDynamic\nrs.CursorLocation = adUseClient\nconn.CommandTimeout = 50\n\n' Open the connection and execute.\nconn.Open sConnString\n\n'    Debug.Print strSqlQuery\nSet rs = conn.Execute(\"SELECT DISTINCT a FROM b\")\n\n' Check we have data.\nIf Not rs.EOF Then\n'*****************Problem here********************\n    rs.MoveLast\n    Debug.Print rs.RecordCount\n\n'Read into array and cleanup...\nEnd If\n\nEnd Function\n</code></pre>\n\n<p>I don't believe this to be a duplicate of this question:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/14122308/rowset-does-not-support-scrolling-backward\">Rowset does not support scrolling backward</a></p>\n\n<p>Because I already incorporated the answer into my code and the problem still persists.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1469618789, "post_id": 38609799, "comment_id": 64609449, "body": "as far as I know the object in PowerPoint don&#39;t have names. You can get their Shape Index in the slide."}, {"owner": {"reputation": 285, "user_id": 1898642, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0b113379d3c228cac113d3051c15019f?s=128&d=identicon&r=PG", "display_name": "Orongo", "link": "https://stackoverflow.com/users/1898642/orongo"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1469620186, "post_id": 38609799, "comment_id": 64610434, "body": "You can name your shapes in Picture Tools -&gt; Selection Pane"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1469620356, "post_id": 38609799, "comment_id": 64610558, "body": "what PowerPoint version ? I couldn&#39;t find this toolbar, where is it located ?"}, {"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1469622499, "post_id": 38609799, "comment_id": 64612090, "body": "What does your code do so far or what kind of error is thrown?"}, {"owner": {"reputation": 285, "user_id": 1898642, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0b113379d3c228cac113d3051c15019f?s=128&d=identicon&r=PG", "display_name": "Orongo", "link": "https://stackoverflow.com/users/1898642/orongo"}, "edited": false, "score": 0, "creation_date": 1469623214, "post_id": 38609799, "comment_id": 64612656, "body": "PowerPoint 2010. No errors from the program. The condition &#39;If shp.Type = msoChart Then&#39; is never fulfilled."}], "answers": [{"comments": [{"owner": {"reputation": 285, "user_id": 1898642, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0b113379d3c228cac113d3051c15019f?s=128&d=identicon&r=PG", "display_name": "Orongo", "link": "https://stackoverflow.com/users/1898642/orongo"}, "edited": false, "score": 0, "creation_date": 1469620217, "post_id": 38611406, "comment_id": 64610462, "body": "I need to dim Chart. What is the dim?"}, {"owner": {"reputation": 11, "user_id": 6644080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/319472c2f890597fd71b7d061839caf9?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Podivinsky", "link": "https://stackoverflow.com/users/6644080/peter-podivinsky"}, "reply_to_user": {"reputation": 285, "user_id": 1898642, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0b113379d3c228cac113d3051c15019f?s=128&d=identicon&r=PG", "display_name": "Orongo", "link": "https://stackoverflow.com/users/1898642/orongo"}, "edited": false, "score": 0, "creation_date": 1469620552, "post_id": 38611406, "comment_id": 64610696, "body": "Dim Chart as Shape"}, {"owner": {"reputation": 285, "user_id": 1898642, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0b113379d3c228cac113d3051c15019f?s=128&d=identicon&r=PG", "display_name": "Orongo", "link": "https://stackoverflow.com/users/1898642/orongo"}, "edited": false, "score": 0, "creation_date": 1469622209, "post_id": 38611406, "comment_id": 64611860, "body": "I had to do some changes to fit to my purpose and it don&#39;t re-name my charts. I have amended my question with my code."}], "tags": [], "owner": {"reputation": 11, "user_id": 6644080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/319472c2f890597fd71b7d061839caf9?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Podivinsky", "link": "https://stackoverflow.com/users/6644080/peter-podivinsky"}, "is_accepted": false, "score": 0, "last_activity_date": 1504170501, "last_edit_date": 1504170501, "creation_date": 1469618097, "answer_id": 38611406, "question_id": 38609799, "link": "https://stackoverflow.com/questions/38609799/naming-specifc-shapes-using-vba/38611406#38611406", "title": "Naming specifc shapes using VBA", "body": "<p>If I understand correctly, you want to list names of all <strong>charts</strong> in your presentation. To do so, you can use a single loop like:</p>\n\n<pre><code>Dim shp as Shape\nFor Each shp In ActivePresentation.Slides(i).Shapes\n If shp.Type = msoChart Then\n  Debug.Print shp.Name\n End If\nNext\n</code></pre>\n\n<p>Edit: Or you can also use <code>Shape.HasChart</code> property.</p>\n\n<pre><code>If shp.HasChart Then\n Debug.Print shp.Name\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 285, "user_id": 1898642, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0b113379d3c228cac113d3051c15019f?s=128&d=identicon&r=PG", "display_name": "Orongo", "link": "https://stackoverflow.com/users/1898642/orongo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504170501, "creation_date": 1469613747, "last_edit_date": 1469622298, "question_id": 38609799, "link": "https://stackoverflow.com/questions/38609799/naming-specifc-shapes-using-vba", "title": "Naming specifc shapes using VBA", "body": "<p>I have a presentation deck in PowerPoint with many shapes. Is there a way to name all shapes that are graphs (linked from Excel workbook) only. For example one slide has 4 graphs, so the name of the shapes are MyPicture1,  MyPicture2, MyPicture3 and MyPicture4. The code so far looks like</p>\n\n<pre><code>Sub test()\nDim lctr As Long\nDim shp As shape\nDim ii As Integer\n\nFor ii = 1 To 6\n    For Each shp In ActivePresentation.Slides(ii).Shapes\n        If shp.Type = msoChart Then\n        lctr = lctr + 1\n        shp.Name = \"MyPicture\" &amp; lctr\n    End If\n    Next shp\nNext ii\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1469616999, "post_id": 38609787, "comment_id": 64608216, "body": "Can we see your code?"}, {"owner": {"reputation": 95, "user_id": 6219515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dbb06922ac958890f0d15da0ee4b45db?s=128&d=identicon&r=PG&f=1", "display_name": "chandu", "link": "https://stackoverflow.com/users/6219515/chandu"}, "reply_to_user": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1469617327, "post_id": 38609787, "comment_id": 64608433, "body": "i&#39;ve added it to the original post. thanks"}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 6219515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dbb06922ac958890f0d15da0ee4b45db?s=128&d=identicon&r=PG&f=1", "display_name": "chandu", "link": "https://stackoverflow.com/users/6219515/chandu"}, "edited": false, "score": 0, "creation_date": 1469620867, "post_id": 38611314, "comment_id": 64610899, "body": "it didn&#39;t hit the row i wanted it to, but some rows below. Also the last column on the right will always be AC, so don&#39;t need to use the RHS_column line. I think just the last line needs to be edited?"}, {"owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "reply_to_user": {"reputation": 95, "user_id": 6219515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dbb06922ac958890f0d15da0ee4b45db?s=128&d=identicon&r=PG&f=1", "display_name": "chandu", "link": "https://stackoverflow.com/users/6219515/chandu"}, "edited": false, "score": 0, "creation_date": 1469622321, "post_id": 38611314, "comment_id": 64611938, "body": "I&#39;ve changed it so it should go to the right row now.. I just left the RHS_column line in (just in case) - it won&#39;t cause any issues for you so if the columns do change in future, it&#39;ll pick that up for you."}, {"owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "reply_to_user": {"reputation": 95, "user_id": 6219515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dbb06922ac958890f0d15da0ee4b45db?s=128&d=identicon&r=PG&f=1", "display_name": "chandu", "link": "https://stackoverflow.com/users/6219515/chandu"}, "edited": false, "score": 0, "creation_date": 1469622718, "post_id": 38611314, "comment_id": 64612268, "body": "If you do want to remove it then just delete the &quot;Dim&quot; line, the RHS_column line and in the bottom line just change the ...&quot;Range(&quot;A1:&quot; &amp; RHS_Column &amp; ActiveCell.Row)&quot;... to &quot;Range(&quot;A1:AC&quot; &amp; ActiveCell.Row)&quot;"}], "tags": [], "owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "is_accepted": true, "score": 0, "last_activity_date": 1469622228, "last_edit_date": 1469622228, "creation_date": 1469617870, "answer_id": 38611314, "question_id": 38609787, "link": "https://stackoverflow.com/questions/38609787/need-some-code-to-which-changes-the-print-area-based-on-the-last-value-in-column/38611314#38611314", "title": "Need some code to which changes the print area based on the last value in column D which isn&#39;t -100% after it has been filtered", "body": "<p>Something like this?:</p>\n\n<pre><code>Sub Jeremys_Macro()\nDim RHS_Column As String\n\nRange(\"XFD1\").End(xlToLeft).Activate\nRHS_Column = Mid(ActiveCell.Address, 2, WorksheetFunction.Find(\"$\", Right(ActiveCell.Address, Len(ActiveCell.Address) - 1)) - 1) ' Find the last column\n\nRange(\"D1048576\").End(xlUp).Activate 'Finds the bottom row\nDo Until ActiveCell.Value &lt;&gt; 1 And ActiveCell.Value &lt;&gt; -1 ' loops until the cell isn't 100% *OR* -100% (I didn't know if it was 100% or -100% - the screenshot suggests it's minus)\n    ActiveCell.Offset(-1).Activate\nLoop\n\nActiveSheet.PageSetup.PrintArea = ActiveSheet.Range(\"A1:\" &amp; RHS_Column &amp; ActiveCell.Row).Address\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 6219515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dbb06922ac958890f0d15da0ee4b45db?s=128&d=identicon&r=PG&f=1", "display_name": "chandu", "link": "https://stackoverflow.com/users/6219515/chandu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 38611314, "answer_count": 1, "score": 1, "last_activity_date": 1469622228, "creation_date": 1469613719, "last_edit_date": 1531164843, "question_id": 38609787, "link": "https://stackoverflow.com/questions/38609787/need-some-code-to-which-changes-the-print-area-based-on-the-last-value-in-column", "title": "Need some code to which changes the print area based on the last value in column D which isn&#39;t -100% after it has been filtered", "body": "<p>I'm looking to get some code which sets the print area based on the last value in column D which isn't -100% after it has been filtered. See the image to understand what I mean<a href=\"https://i.stack.imgur.com/WHqFt.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WHqFt.jpg\" alt=\"here\"></a> </p>\n\n<p>My code currently sorts this data every month by column D, which is the fourth column in this image. I now need it to move the print area (the blue line) to the last row which does not contain -100.0% in Column D, in this case that is the row above (row 145).\nPlease let me know how this could be automated.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>Dim wb1 As Workbook, wb2 As Workbook, wb3 As Workbook, wb4 As Workbook\nDim ws1 As Worksheet, ws2 As Worksheet, ws3 As Worksheet, ws4 As Worksheet, ws5 As Worksheet, ws6 As Worksheet, ws7 As Worksheet\nDim lastRow As Long, i As Long\nDim value As String\nDim OldDate, NewDate As String\nDim ws As Worksheet\n\nOldDate = Format(DateSerial(Year(Date), Month(Date) - 1, 0), \"ddmmyy\")\nNewDate = Format(DateSerial(Year(Date), Month(Date), 0), \"ddmmyy\")\n\n\nSet wb4 = Workbooks.Open(\"\\\\ldnfortunenet\\fortunenetdocuments\\MAC\\IMA\\Sector Analysis\\Final\\IMA Sector Analysis \" &amp; OldDate &amp; \".xlsx\", 0)\nSet ws4 = wb4.Sheets(\"IMA 20-60\")\nSet ws5 = wb4.Sheets(\"IMA 40-85\")\nSet ws6 = wb4.Sheets(\"IMA Flexible\")\nSet ws7 = wb4.Sheets(\"Look Up Match\")\n\n\n\nws4.ListObjects(\"Table33\").Sort.SortFields. _\n    Clear\nws4.ListObjects(\"Table33\").Sort.SortFields. _\n    Add Key:=Range(\"Table33[[#All],[YTD Perf]]\"), SortOn:=xlSortOnValues, _\n    Order:=xlDescending, DataOption:=xlSortNormal\nWith ws4.ListObjects(\"Table33\").Sort\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n\nws5.ListObjects(\"Table35\").Sort.SortFields. _\n    Clear\nws5.ListObjects(\"Table35\").Sort.SortFields. _\n    Add Key:=Range(\"Table35[[#All],[YTD Perf]]\"), SortOn:=xlSortOnValues, _\n    Order:=xlDescending, DataOption:=xlSortNormal\nWith ws5.ListObjects(\"Table35\").Sort\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n\nws6.ListObjects(\"Table3\").Sort.SortFields _\n    .Clear\nws6.ListObjects(\"Table3\").Sort.SortFields _\n    .Add Key:=Range(\"Table3[[#All],[YTD Perf]]\"), SortOn:=xlSortOnValues, _\n    Order:=xlDescending, DataOption:=xlSortNormal\nWith ws6.ListObjects(\"Table3\").Sort\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "ms-access-2010"], "comments": [{"owner": {"reputation": 6980, "user_id": 4558029, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f2e68ee36e4352eed3fbd2c3131d01a1?s=128&d=identicon&r=PG&f=1", "display_name": "lokusking", "link": "https://stackoverflow.com/users/4558029/lokusking"}, "edited": false, "score": 0, "creation_date": 1469612583, "post_id": 38609209, "comment_id": 64605102, "body": "But you know SQL and what a <code>WHERE</code>-Clause is?"}, {"owner": {"reputation": 537, "user_id": 4730196, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0065a640f1aafb25f4cfafcf2c6c877f?s=128&d=identicon&r=PG&f=1", "display_name": "LostReality", "link": "https://stackoverflow.com/users/4730196/lostreality"}, "reply_to_user": {"reputation": 6980, "user_id": 4558029, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f2e68ee36e4352eed3fbd2c3131d01a1?s=128&d=identicon&r=PG&f=1", "display_name": "lokusking", "link": "https://stackoverflow.com/users/4558029/lokusking"}, "edited": false, "score": 0, "creation_date": 1469612869, "post_id": 38609209, "comment_id": 64605300, "body": "Then I would have to do 2 different queries, no ? I want all the rows, even when isValid = False, I just dont wanna display the attachment when that&#39;s the case."}], "answers": [{"comments": [{"owner": {"reputation": 537, "user_id": 4730196, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0065a640f1aafb25f4cfafcf2c6c877f?s=128&d=identicon&r=PG&f=1", "display_name": "LostReality", "link": "https://stackoverflow.com/users/4730196/lostreality"}, "edited": false, "score": 0, "creation_date": 1469621048, "post_id": 38610017, "comment_id": 64611017, "body": "It indeed works, but I still have an issue. Even though I put ValidSignature as Source of my attachment control, the picture is not displaying. But the field is not empty. <code>IIf(T_SIGNATURE.signature_validee,T_PERSONNEL.visa.FileData,&zwnj;&#8203;Null) AS ValidSignature FROM T_PERSONNEL INNER JOIN...;</code>"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 537, "user_id": 4730196, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0065a640f1aafb25f4cfafcf2c6c877f?s=128&d=identicon&r=PG&f=1", "display_name": "LostReality", "link": "https://stackoverflow.com/users/4730196/lostreality"}, "edited": false, "score": 0, "creation_date": 1469627777, "post_id": 38610017, "comment_id": 64616251, "body": "I have never worked with attachment fields, so can&#39;t really help here. I suggest a new question, including the information whether it works when you directly use the table as source instead of the query. @LostReality"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 1, "last_activity_date": 1469614355, "creation_date": 1469614355, "answer_id": 38610017, "question_id": 38609209, "link": "https://stackoverflow.com/questions/38609209/display-attachment-field-depending-on-another-boolean-field/38610017#38610017", "title": "Display attachment field depending on another boolean field", "body": "<p>Sounds like a case for the <a href=\"https://support.office.com/en-us/article/IIf-Function-32436ecf-c629-48a3-9900-647539c764e3\" rel=\"nofollow\"><code>IIf</code></a> function.</p>\n\n<pre><code>SELECT ID_signature, firstname, IIf([isValid], [signature], NULL) AS ValidSignature\nFROM &lt;your join&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 716, "user_id": 6518147, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1204875876202728/picture?type=large", "display_name": "Hynek Bernard", "link": "https://stackoverflow.com/users/6518147/hynek-bernard"}, "is_accepted": false, "score": 1, "last_activity_date": 1469614363, "creation_date": 1469614363, "answer_id": 38610018, "question_id": 38609209, "link": "https://stackoverflow.com/questions/38609209/display-attachment-field-depending-on-another-boolean-field/38610018#38610018", "title": "Display attachment field depending on another boolean field", "body": "<p>You can use IIF function, for example</p>\n\n<pre><code>select ID_signature, [txt firstname], Iif([isValid] = \"True\",[attach signature], null) as [Signature] .....\n</code></pre>\n\n<p>Also, it is unwise to use spaces in column name, it is better to use <code>_</code> instead of space.</p>\n"}], "owner": {"reputation": 537, "user_id": 4730196, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0065a640f1aafb25f4cfafcf2c6c877f?s=128&d=identicon&r=PG&f=1", "display_name": "LostReality", "link": "https://stackoverflow.com/users/4730196/lostreality"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 38610017, "answer_count": 2, "score": 0, "last_activity_date": 1469614363, "creation_date": 1469612299, "question_id": 38609209, "link": "https://stackoverflow.com/questions/38609209/display-attachment-field-depending-on-another-boolean-field", "title": "Display attachment field depending on another boolean field", "body": "<p>I have 2 tables, one contains a boolean value and the other one contains an attachment field.</p>\n\n<p>There is a 1-to-Many relationship between the 2 tables :</p>\n\n<pre><code>T1 (long ID_staff, txt firstname, attach signature)\nT2 (long ID_signature, long fk_ID_staff, boolean isValid)\n</code></pre>\n\n<p>In my form, I display the INNER JOIN of those 2 tables. As result, I have fields :</p>\n\n<pre><code>long ID_signature, txt firstname, attach signature, boolean isValid\n</code></pre>\n\n<p>What I would like to do is display my attachment (\"signature\" field) in my form ONLY if isValid equals TRUE.</p>\n\n<p>Is there an easy way to do that in VBA or directly in Access ?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1469612598, "post_id": 38609059, "comment_id": 64605116, "body": "Doing a timed task (copy the file somewhere) directly at the machine which is hosting the file, would be easier than &quot;hoping&quot; that someone works with this file at a given time..."}, {"owner": {"reputation": 460, "user_id": 5605307, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153411479543422/picture?type=large", "display_name": "Kenneth Chan", "link": "https://stackoverflow.com/users/5605307/kenneth-chan"}, "edited": false, "score": 0, "creation_date": 1469613500, "post_id": 38609059, "comment_id": 64605787, "body": "Just an other suggestion, you can write some batch script in task scheduler."}], "answers": [{"comments": [{"owner": {"reputation": 634, "user_id": 1369499, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/d8273c0ebae94eea9e71e782f05c8b5c?s=128&d=identicon&r=PG", "display_name": "PeterS", "link": "https://stackoverflow.com/users/1369499/peters"}, "edited": false, "score": 0, "creation_date": 1469613291, "post_id": 38609336, "comment_id": 64605620, "body": "What if I want to create a backup copy every the user will open the file? And append the backup filename with date and timestamp?"}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "reply_to_user": {"reputation": 634, "user_id": 1369499, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/d8273c0ebae94eea9e71e782f05c8b5c?s=128&d=identicon&r=PG", "display_name": "PeterS", "link": "https://stackoverflow.com/users/1369499/peters"}, "edited": false, "score": 0, "creation_date": 1469616638, "post_id": 38609336, "comment_id": 64607974, "body": "That would be different than setting a time schedule, but you would just call your backup macro from the workbook open event"}], "tags": [], "owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "is_accepted": true, "score": 0, "last_activity_date": 1469612618, "creation_date": 1469612618, "answer_id": 38609336, "question_id": 38609059, "link": "https://stackoverflow.com/questions/38609059/how-to-create-vba-backup-script-on-the-specified-time/38609336#38609336", "title": "How to create VBA Backup Script on the Specified Time", "body": "<p>Use this sub below and just add your own backup-saving macro called <code>BackupFile</code></p>\n\n<pre><code>Sub SetSchedule()\n\nApplication.OnTime TimeValue(\"5:00:00\"), \"BackupFile\"\n\nApplication.OnTime TimeValue(\"10:00:00\"), \"BackupFile\"\n\nApplication.OnTime TimeValue(\"16:00:00\"), \"BackupFile\"\n\nApplication.OnTime TimeValue(\"23:59:00\"), \"SetSchedule\"\n\nEnd Sub\n</code></pre>\n\n<p>And call it from the open sub:</p>\n\n<pre><code>Sub Workbook_Open()\n\n    Call SetSchedule\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 1, "last_activity_date": 1469614454, "creation_date": 1469614454, "answer_id": 38610061, "question_id": 38609059, "link": "https://stackoverflow.com/questions/38609059/how-to-create-vba-backup-script-on-the-specified-time/38610061#38610061", "title": "How to create VBA Backup Script on the Specified Time", "body": "<p>The best way would be to create a Scheduled Task to run a batch or script file that will back up your file.</p>\n\n<p>Here is are example parameters for the Scheduled Task.</p>\n\n<blockquote>\n  <p>C:\\Windows\\System32\\WScript.exe C:\\Excel Files\\backup.vbs\"</p>\n</blockquote>\n\n<p>Save this script as backup.vbs</p>\n\n<p><strong>VBScript</strong></p>\n\n<pre><code>Const FolderName = \"C:\\Excel Files\\\"\nConst FileName = \"Data.xlsm\"\nDim fso, NewName, sb\n\nSet sb = CreateObject(\"System.Text.StringBuilder\")\nsb.AppendFormat \"{0:yyyy-MM-dd} {0,8:t}\", CDate(Now)\n\nNewName = Replace(sb.ToString(), \":\" ,\".\") &amp; \" - \" &amp; FileName\n\nSet fso = WScript.CreateObject(\"Scripting.Filesystemobject\")\n\nfso.CopyFile FolderName &amp; FileName, FolderName &amp; NewName,True\n</code></pre>\n"}], "owner": {"reputation": 634, "user_id": 1369499, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/d8273c0ebae94eea9e71e782f05c8b5c?s=128&d=identicon&r=PG", "display_name": "PeterS", "link": "https://stackoverflow.com/users/1369499/peters"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 693, "favorite_count": 0, "accepted_answer_id": 38609336, "answer_count": 2, "score": -2, "last_activity_date": 1469614454, "creation_date": 1469611889, "question_id": 38609059, "link": "https://stackoverflow.com/questions/38609059/how-to-create-vba-backup-script-on-the-specified-time", "title": "How to create VBA Backup Script on the Specified Time", "body": "<p>For example, I have an excel file saved in our network drive. On that file, I want to implement a solution that will enable an automatic backup for the time specified by the user. </p>\n\n<p>For example:\nFile.xlsx</p>\n\n<p>Script will backup this file every 10:00am, 4:00PM and 5:00am. Will that be possible?</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1469613857, "post_id": 38609014, "comment_id": 64606038, "body": "what are you trying to achieve with the Nz()... if <code>[field1]</code> is null then use <code>[field2]</code>?"}, {"owner": {"reputation": 1191, "user_id": 4269118, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-BPhwWVVWLA8/AAAAAAAAAAI/AAAAAAAAAC0/G7y0OCgc4og/photo.jpg?sz=128", "display_name": "anatol", "link": "https://stackoverflow.com/users/4269118/anatol"}, "reply_to_user": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1469614003, "post_id": 38609014, "comment_id": 64606148, "body": "@LiamH, yes of course"}], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 1, "last_activity_date": 1469614162, "creation_date": 1469614162, "answer_id": 38609952, "question_id": 38609014, "link": "https://stackoverflow.com/questions/38609014/getting-unacceptable-expression-error-in-access/38609952#38609952", "title": "Getting `unacceptable expression` error in Access", "body": "<p>Apparently this is not something that can be calculated in an expression.</p>\n\n<p>The other expressions are a simple running sum, or can be calculated from the data of one record.</p>\n\n<p>You need to add <code>Nz([field1];[field2])</code> as column to your recordsource, and then you can build the Sum of that column.</p>\n"}], "owner": {"reputation": 1191, "user_id": 4269118, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-BPhwWVVWLA8/AAAAAAAAAAI/AAAAAAAAAC0/G7y0OCgc4og/photo.jpg?sz=128", "display_name": "anatol", "link": "https://stackoverflow.com/users/4269118/anatol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1469614693, "creation_date": 1469611792, "last_edit_date": 1469614693, "question_id": 38609014, "link": "https://stackoverflow.com/questions/38609014/getting-unacceptable-expression-error-in-access", "title": "Getting `unacceptable expression` error in Access", "body": "<p>I use <code>=Sum(Nz([field1];[field2]))</code> as data of textbox in report and got \n<code>unacceptable expression</code> error on this. But expressions <code>=Sum([field2])</code> and <code>=Nz([field1];[field2])</code> in other textboxes works correctly. What is the problem in first expression?<br>\nRecord source of report is stored procedure.<br>\n<strong>UPD</strong><br>\nNow got ##error instead of value in textbox with <code>=Nz([field1];[field2])</code> expression. It also can't be calculated?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3076, "user_id": 931358, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/qBSVt.jpg?s=128&g=1", "display_name": "Jurik", "link": "https://stackoverflow.com/users/931358/jurik"}, "edited": false, "score": 1, "creation_date": 1469607439, "post_id": 38607275, "comment_id": 64601592, "body": "Hi and welcome to Stackoverflow! Please take a minute and read this tutorial for better questions, especially examples about good and bad titles: <a href=\"http://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a> - everything else looks good."}, {"owner": {"reputation": 31, "user_id": 6564347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfca6ee022bcaaf1ca4085a0bd4e319d?s=128&d=identicon&r=PG&f=1", "display_name": "tetra404", "link": "https://stackoverflow.com/users/6564347/tetra404"}, "reply_to_user": {"reputation": 3076, "user_id": 931358, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/qBSVt.jpg?s=128&g=1", "display_name": "Jurik", "link": "https://stackoverflow.com/users/931358/jurik"}, "edited": false, "score": 1, "creation_date": 1469607712, "post_id": 38607275, "comment_id": 64601786, "body": "@Jurik Thank you, I will try and do better."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1469618782, "post_id": 38607275, "comment_id": 64609441, "body": "Do you know that you can search for &quot;Text1:&quot; and replace it with the same text with&#39;s it&#39;s font property set to bold. To understand it better, press CTRL H in Word and then check in <code>Format</code> under <code>Replace</code> in the dialog box."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1469619061, "post_id": 38607275, "comment_id": 64609634, "body": "Record a macro for the above. Give it a try and if you are stuck then post the code that you tried and then we will take it from there. I just tested the code and it works :)"}], "owner": {"reputation": 31, "user_id": 6564347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfca6ee022bcaaf1ca4085a0bd4e319d?s=128&d=identicon&r=PG&f=1", "display_name": "tetra404", "link": "https://stackoverflow.com/users/6564347/tetra404"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 261, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1469607683, "creation_date": 1469606828, "last_edit_date": 1531164843, "question_id": 38607275, "link": "https://stackoverflow.com/questions/38607275/how-to-write-bold-text-in-a-word-document-using-excel-vba", "title": "How to write bold text in a word document using excel-vba?", "body": "<p>Writing data in a excel doc to a word doc.\nBut I can't figure out how to make all the parts named text in bold any help would be appreciated.</p>\n\n<pre><code>    L_CurrentHeading = \"Text1: \" &amp; Cells(Q.Row, ACol) &amp; \" \" &amp; Cells(Q.Row, JCol) &amp; \"   |   Text 3: \" &amp; Cells(Q.Row, BCol)\n    L_ID = \"Text 2: \" &amp; Cells(Q.Row, CCol) &amp; \"   |   Text6: \" &amp; Cells(Q.Row, DCol) &amp; \"   |   \" &amp; Cells(Q.Row, ECol) &amp; \" Inspection \" &amp; Cells(Q.Row, FCol)\n    L_Reading = \"Text7: \" &amp; Cells(Q.Row, GCol) &amp; \" \" &amp; Cells(Q.Row, HCol)\n    L_Note = \"Text: \" &amp; Cells(Q.Row, ICol)\n    L_ID = L_ID &amp; vbCrLf &amp; L_CurrentHeading &amp; vbCrLf &amp; L_Reading &amp; vbCrLf &amp; L_Note\n</code></pre>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1469608347, "post_id": 38607590, "comment_id": 64602210, "body": "It is advisable to add e.g. <code>Sleep 50</code> in the loop, to avoid Access hogging the CPU. With this API declaration: <code>Public Declare Sub Sleep Lib &quot;kernel32&quot; (ByVal dwMilliseconds As Long)</code>"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1469610032, "post_id": 38607590, "comment_id": 64603381, "body": "<code>Sleep 50</code> is very short, I intended it to go into your loop. But the best way would be a loop that checks for existence of the imported table (again with a <code>Sleep</code> call in the loop)."}, {"owner": {"reputation": 836, "user_id": 6419727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e6f5532e6c9f3d91e56fdffd792dcf9?s=128&d=identicon&r=PG&f=1", "display_name": "random_answer_guy", "link": "https://stackoverflow.com/users/6419727/random-answer-guy"}, "edited": false, "score": 0, "creation_date": 1469622148, "post_id": 38607590, "comment_id": 64611815, "body": "I think you could simply loop<code>Do Until DCount(&quot;[Name]&quot;, &quot;MSysObjects&quot;, &quot;[Name] = &#39;&quot; &amp; tblName &amp; &quot;&#39;&quot;) = 1</code> with <code>Sleep 50</code> the only element in the loop"}], "tags": [], "owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "is_accepted": true, "score": 1, "last_activity_date": 1469610426, "last_edit_date": 1469610426, "creation_date": 1469607785, "answer_id": 38607590, "question_id": 38607144, "link": "https://stackoverflow.com/questions/38607144/issue-with-runsavedimportexport/38607590#38607590", "title": "Issue with RunSavedImportExport", "body": "<p>I have not had this specific problem before, but a similar circumstance where I can only describe it as <em>\"the code moved too fast\"</em>.</p>\n\n<p>Try adding a delay between creating the table and querying from it. Access doesn't allow <code>application.wait</code> so you could try the following:</p>\n\n<pre><code>Dim T1 As Variant\nDim T2 As Variant\n\nT1 = Now()\nT2 = DateAdd(\"s\", 1, T1)\n\nDo Until T2 &lt;= T1\n    T1 = Now()\nLoop\n</code></pre>\n\n<p>This does add a one second delay, so hopefully the time length isn't an issue for yourself. </p>\n\n<blockquote>\n  <p>EDIT</p>\n</blockquote>\n\n<p>from what @Andre has suggested in the comment, I understand this to be a smarter alternative to my delay suggestion.</p>\n\n<pre><code>option explicit\nDeclare Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long)\n\nfunction RunSavedImportExport()\n  [some code]\n  Dim T1 As Variant\n  Dim T2 As Variant\n\n  T1 = Now()\n  T2 = DateAdd(\"s\", 1, T1)\n\n  Do Until T2 &lt;= T1\n    T1 = Now()\n    sleep 50\n  Loop      \n  [some code]\nend function\n</code></pre>\n"}], "owner": {"reputation": 3542, "user_id": 2635209, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/tjsnP.jpg?s=128&g=1", "display_name": "Thomas Carlton", "link": "https://stackoverflow.com/users/2635209/thomas-carlton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 38607590, "answer_count": 1, "score": 2, "last_activity_date": 1469610426, "creation_date": 1469606413, "last_edit_date": 1469606981, "question_id": 38607144, "link": "https://stackoverflow.com/questions/38607144/issue-with-runsavedimportexport", "title": "Issue with RunSavedImportExport", "body": "<p>I have a VBA code on Access.</p>\n\n<p>I use the function <strong>RunSavedImportExport</strong> using a saved import specification. Basically it imports a CSV file and puts it in a table let's call it Table_A.</p>\n\n<p>Right after importing the file I have an SQL query on <strong>Table_A</strong>.</p>\n\n<p>When running the code, it fails on the SQL query saying that <strong>Table_A is not found</strong> and stops at this line. If I hit again run, it continues whithout any issue. </p>\n\n<p>It seems like the code moves to the second instruction while the importation has not finished yet.</p>\n\n<p>Has anyone had a problem like this ?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["image", "vba", "excel", "base64", "ms-word"], "comments": [{"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "edited": false, "score": 0, "creation_date": 1469607849, "post_id": 38606853, "comment_id": 64601878, "body": "Just found this (which looks like half of the puzzle): <a href=\"http://stackoverflow.com/questions/12795440\">stackoverflow.com/questions/12795440</a> so will have a look and post back..."}], "owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 559, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1469605559, "creation_date": 1469605559, "last_edit_date": 1495541288, "question_id": 38606853, "link": "https://stackoverflow.com/questions/38606853/vba-to-read-image-directly-from-word-document-for-base64-conversion", "title": "VBA to read image directly from word document for Base64 Conversion", "body": "<p>Basically I have a document with lots of small images and I need a fast way to build a list of unique images (and identify them in the document), I was thinking of using Base64 conversion to store each unique image in an xml file (or simply store the MD5 hash of each image).</p>\n\n<p>If the images were saved as files somewhere (i.e outside of the document) I'd be able to do this but (unless there's good reason not to) I'd like to learn how to read the image directly from the document.</p>\n\n<p>Specifically, if I have <code>myDoc.InlineShapes(myImageIndex)</code> how can I most efficiently PREPARE that to either convert to Base64 or create a hash?</p>\n\n<p>All the examples I can find assume the image is loaded from file, I'm hoping to load the image directly from the document... (e.g. <a href=\"https://stackoverflow.com/questions/2043393/convert-image-jpg-to-base64-in-excel-vba\">Convert image (jpg) to base64 in Excel VBA?</a>)</p>\n\n<p>Many thanks in advance,</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 324, "user_id": 6527224, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xcexG.jpg?s=128&g=1", "display_name": "dyslexicgruffalo", "link": "https://stackoverflow.com/users/6527224/dyslexicgruffalo"}, "edited": false, "score": 0, "creation_date": 1469605800, "post_id": 38606874, "comment_id": 64600555, "body": "Hi, thanks for the quick reply - this works great! thankyou!"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 324, "user_id": 6527224, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xcexG.jpg?s=128&g=1", "display_name": "dyslexicgruffalo", "link": "https://stackoverflow.com/users/6527224/dyslexicgruffalo"}, "edited": false, "score": 2, "creation_date": 1469605887, "post_id": 38606874, "comment_id": 64600608, "body": "no worries, don&#39;t forget to mark as the answer if it solved the issue!"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 3, "last_activity_date": 1469605607, "creation_date": 1469605607, "answer_id": 38606874, "question_id": 38606800, "link": "https://stackoverflow.com/questions/38606800/vba-rangeall-cells-but-a-few/38606874#38606874", "title": "VBA - Range(&quot;All cells but a few&quot;)", "body": "<p>use an array instead:</p>\n\n<pre><code>Sub Button21_Click()\n\nApplication.ScreenUpdating = False\n\nDim oldValues As Variant\n\nWith Worksheets(2)\n    oldValues = .Range(\"AB1:AC5\").Value\n    .Cells.ClearContents\n    .Range(\"AB1:AC5\").Value = oldValues\nEnd With\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 324, "user_id": 6527224, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xcexG.jpg?s=128&g=1", "display_name": "dyslexicgruffalo", "link": "https://stackoverflow.com/users/6527224/dyslexicgruffalo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 38606874, "answer_count": 1, "score": 2, "last_activity_date": 1469605607, "creation_date": 1469605396, "question_id": 38606800, "link": "https://stackoverflow.com/questions/38606800/vba-rangeall-cells-but-a-few", "title": "VBA - Range(&quot;All cells but a few&quot;)", "body": "<p>I am trying to clear the contents of all cells on a worksheet apart from a specific range. I have tried to copy the range to the clipboard then to paste it back on again in the same place, however excel being the usual tricky beast - it doesn't want to play ball. </p>\n\n<p>The range I would like to keep the same is AB1:AC5.</p>\n\n<p>Any Suggestions Apprichiated...</p>\n\n<p>(here is my code)</p>\n\n<pre><code>Sub Button21_Click()\n\nApplication.ScreenUpdating = False\n\nWith Worksheets(2)\n.Range(\"AB1:AC5\").Copy\n.Cells.ClearContents\n.Paste(Destination:=Sheets(\"Data\").Range(\"AB1\"))\nEnd With\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1469606027, "post_id": 38606481, "comment_id": 64600700, "body": "why don&#39;t you use excel UI built in filter features? (you should find them under &quot;Data -&gt; Sort and Filter&quot;"}, {"owner": {"reputation": 159, "user_id": 1954762, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5677d88b35ef2df90b9c2bf06821b2fb?s=128&d=identicon&r=PG", "display_name": "user1954762", "link": "https://stackoverflow.com/users/1954762/user1954762"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1469610270, "post_id": 38606481, "comment_id": 64603545, "body": "Hi, I want to do it using macro.."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1469611047, "post_id": 38606481, "comment_id": 64604069, "body": "are you using Userforms? Give more details about your user interface"}, {"owner": {"reputation": 159, "user_id": 1954762, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5677d88b35ef2df90b9c2bf06821b2fb?s=128&d=identicon&r=PG", "display_name": "user1954762", "link": "https://stackoverflow.com/users/1954762/user1954762"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1469612739, "post_id": 38606481, "comment_id": 64605207, "body": "yes I am using user forms but how to get the value once user click ok button and do the filer in excel column based on listbox selection in user form"}], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 1954762, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5677d88b35ef2df90b9c2bf06821b2fb?s=128&d=identicon&r=PG", "display_name": "user1954762", "link": "https://stackoverflow.com/users/1954762/user1954762"}, "edited": false, "score": 0, "creation_date": 1469609440, "post_id": 38606859, "comment_id": 64602954, "body": "it will take it in array.. I tested it&#39;s working... but I want if there is more than one .. where we user input count is dynamic what to be done for that case."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 159, "user_id": 1954762, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5677d88b35ef2df90b9c2bf06821b2fb?s=128&d=identicon&r=PG", "display_name": "user1954762", "link": "https://stackoverflow.com/users/1954762/user1954762"}, "edited": false, "score": 0, "creation_date": 1469609553, "post_id": 38606859, "comment_id": 64603033, "body": "So, if your question is how to take the user input dynamically, then the answer is - use events. Like this:<a href=\"http://www.cpearson.com/excel/Events.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/Events.aspx</a>"}, {"owner": {"reputation": 159, "user_id": 1954762, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5677d88b35ef2df90b9c2bf06821b2fb?s=128&d=identicon&r=PG", "display_name": "user1954762", "link": "https://stackoverflow.com/users/1954762/user1954762"}, "edited": false, "score": 0, "creation_date": 1469610303, "post_id": 38606859, "comment_id": 64603564, "body": "this site you had provided doesn&#39;t solve my purpose. anyways thanks!"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1469605567, "creation_date": 1469605567, "answer_id": 38606859, "question_id": 38606481, "link": "https://stackoverflow.com/questions/38606481/excel-macro-for-multiple-filter/38606859#38606859", "title": "Excel Macro for multiple filter", "body": "<p>In order to have more criteria in autofilter, you should give them separately. I have not seen excel taking it as an array. Separately like this:</p>\n\n<pre><code>Sub Makro2()\n\n    ActiveSheet.Range(\"$A$1:$B$8\").AutoFilter Field:=1, Criteria1:=\"123\"\n    ActiveSheet.Range(\"$A$1:$B$8\").AutoFilter Field:=2, Criteria1:=\"122\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 879, "user_id": 6340326, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QaG3S.png?s=128&g=1", "display_name": "Carrosive", "link": "https://stackoverflow.com/users/6340326/carrosive"}, "is_accepted": false, "score": 2, "last_activity_date": 1469611428, "creation_date": 1469611428, "answer_id": 38608889, "question_id": 38606481, "link": "https://stackoverflow.com/questions/38606481/excel-macro-for-multiple-filter/38608889#38608889", "title": "Excel Macro for multiple filter", "body": "<p>Your <code>Range</code> needs to be for the entire table which you wish to filter and use the <code>Field</code> parameter to specify which column to filter. e.g. <code>Range(\"A1:D50\").AutoFilter Field:=2</code> will filter the B column for a table spanning from cells <code>A1</code> to <code>D50</code>.</p>\n\n<p>Set your filter values before the AutoFilter line, this will also make it easier for you to build your dynamic feature to specify the filter values. e.g.</p>\n\n<pre><code>filterValues = Array(\"Criteria1\",\"Criteria2\", \"Criteria3\")\nRange(\"A1:D50\").AutoFilter Field:=2, Criteria1:=filterValues, Operator:=xlFilterValues\n</code></pre>\n\n<p>In order to get input from a user to populate the <code>filterValues</code> array you will need to build a userform for this. </p>\n"}], "owner": {"reputation": 159, "user_id": 1954762, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5677d88b35ef2df90b9c2bf06821b2fb?s=128&d=identicon&r=PG", "display_name": "user1954762", "link": "https://stackoverflow.com/users/1954762/user1954762"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3560, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1469611428, "creation_date": 1469604404, "last_edit_date": 1469607101, "question_id": 38606481, "link": "https://stackoverflow.com/questions/38606481/excel-macro-for-multiple-filter", "title": "Excel Macro for multiple filter", "body": "<p>I am writing a excel macro which require to get the input from user from the particular column and then filter the value based on user input.</p>\n\n<p>Note:</p>\n\n<p>1) The input should prompt for list box that will show all the values present in that column.\n2) User can select multiple value one or more.\n3) Based on user input filter the sheet and display the result.</p>\n\n<p>Experts in Macro can you please advise.</p>\n\n<p>I tried since the input values from user is dynamic(one or more selection) I am facing the challenge.</p>\n\n<p>Range(\"B2\").AutoFilter Field:=2, Criteria1:=Array(\"Selection1\",\"Selection2\"), Operator:=xlFilterValues</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3194, "user_id": 4991677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7dabe78477c4b3697c3284fb556b1eca?s=128&d=identicon&r=PG&f=1", "display_name": "FDavidov", "link": "https://stackoverflow.com/users/4991677/fdavidov"}, "edited": false, "score": 0, "creation_date": 1469604577, "post_id": 38606455, "comment_id": 64599752, "body": "Do you need to do this quite often or in a sheet with thousands of rows? If not, simply select the range of cells you want to shift and DRAG then right and up."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1469604828, "post_id": 38606455, "comment_id": 64599931, "body": "@HWQ what have you tried so far ? show us your code attempt."}, {"owner": {"reputation": 67, "user_id": 4739519, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/634c1362f734a53889dd590f4227c079?s=128&d=identicon&r=PG&f=1", "display_name": "HWQ", "link": "https://stackoverflow.com/users/4739519/hwq"}, "reply_to_user": {"reputation": 3194, "user_id": 4991677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7dabe78477c4b3697c3284fb556b1eca?s=128&d=identicon&r=PG&f=1", "display_name": "FDavidov", "link": "https://stackoverflow.com/users/4991677/fdavidov"}, "edited": false, "score": 0, "creation_date": 1469612825, "post_id": 38606455, "comment_id": 64605272, "body": "@FDavidov Yes, its Thousands of rows, otherwise I would have found a way."}, {"owner": {"reputation": 67, "user_id": 4739519, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/634c1362f734a53889dd590f4227c079?s=128&d=identicon&r=PG&f=1", "display_name": "HWQ", "link": "https://stackoverflow.com/users/4739519/hwq"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1469612879, "post_id": 38606455, "comment_id": 64605309, "body": "@ShaiRado I havent really tried anything as of yet since I couldnt figure it out."}, {"owner": {"reputation": 3194, "user_id": 4991677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7dabe78477c4b3697c3284fb556b1eca?s=128&d=identicon&r=PG&f=1", "display_name": "FDavidov", "link": "https://stackoverflow.com/users/4991677/fdavidov"}, "edited": false, "score": 0, "creation_date": 1469617652, "post_id": 38606455, "comment_id": 64608674, "body": "OK. If the file is large BUT this needs to be done only once, the best way in my opinion is to RECORD a macro and then execute it. There are plenty of examples in the internet on how to do that (here is one: <a href=\"https://www.youtube.com/watch?v=nvWpFdo7EO0\" rel=\"nofollow noreferrer\">youtube.com/watch?v=nvWpFdo7EO0</a>). You can ask Excel to execute the macro once or many times. Should not be much of an issue at all."}, {"owner": {"reputation": 67, "user_id": 4739519, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/634c1362f734a53889dd590f4227c079?s=128&d=identicon&r=PG&f=1", "display_name": "HWQ", "link": "https://stackoverflow.com/users/4739519/hwq"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1469728518, "post_id": 38606455, "comment_id": 64670151, "body": "@ShaiRado  This is what I got .. works"}], "answers": [{"tags": [], "owner": {"reputation": 67, "user_id": 4739519, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/634c1362f734a53889dd590f4227c079?s=128&d=identicon&r=PG&f=1", "display_name": "HWQ", "link": "https://stackoverflow.com/users/4739519/hwq"}, "is_accepted": false, "score": 0, "last_activity_date": 1469728466, "creation_date": 1469728466, "answer_id": 38643522, "question_id": 38606455, "link": "https://stackoverflow.com/questions/38606455/how-to-copy-paste-cells-into-respective-columns-in-excel-vba/38643522#38643522", "title": "How to copy paste cells into respective columns in Excel vba", "body": "<p>Finally had it figured out, Bad coding maybe but it works.. :) </p>\n\n<p>Thanks All for your Help .</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>Sub test()\r\nDim i As Long\r\nDim toprow As Long\r\nDim z As Long\r\nDim count As Long\r\nDim b As Long\r\n\r\ntoprow = 3\r\nb = toprow\r\nFor i = toprow To Cells(Rows.count, 1).End(xlUp).Row\r\nIf Not Cells(i, 1) = \"\" And Not Cells(i, 2) = \"\" Then\r\n     b = i\r\n     count = 0\r\n     z = i\r\nEnd If\r\n If Cells(i, 1) = \"\" Then\r\n   If Cells(i + 1, 1) = \"\" Then\r\n    z = i\r\n    If Not Cells(z + 1, 2) = \"\" Then\r\n       Cells(z + 1, 2).Cut Cells(b, 2)\r\n       i = b\r\n       b = z + 1\r\n       count = 0\r\n    ElseIf count = 0 Then\r\n       count = z\r\n       b = count\r\n   End If\r\n   \r\nEnd If\r\nEnd If\r\nNext i\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 67, "user_id": 4739519, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/634c1362f734a53889dd590f4227c079?s=128&d=identicon&r=PG&f=1", "display_name": "HWQ", "link": "https://stackoverflow.com/users/4739519/hwq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1469728466, "creation_date": 1469604347, "last_edit_date": 1531161705, "question_id": 38606455, "link": "https://stackoverflow.com/questions/38606455/how-to-copy-paste-cells-into-respective-columns-in-excel-vba", "title": "How to copy paste cells into respective columns in Excel vba", "body": "<p>I have an excel 2007 sheet where column names with data are all placed in one single column and I need to shift one column name to the left or right with data so that I can have separate columns. Can you create a VBA function where it reads all rows of the column and shift those columns with certain keywords. Such as:</p>\n\n<pre><code>A1   B1\n1     **Category1**\n      Cat1 info here\n      **cf**\n      45\n      34\n      34\n      Sf\n      542\n      234\n      234\n2     **Category2**\n      Cat2 info here\n      **cf**\n      76\n      23\n      67\n      **Sf**\n      678\n      987\n      3476\n</code></pre>\n\n<p>I Need to move \"<strong>cf</strong>\" column + data to a different column and paste it to its relevant category. So \"cf\" would shift right with data and move up along with its category. I would then delete the empty rows of B Column.</p>\n"}, {"tags": ["excel", "vba", "filter", "pivot-table"], "comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1469604366, "post_id": 38606362, "comment_id": 64599622, "body": "who are &quot;they&quot; ? Anyway you can&#39;t have a text as Value in Excel pivot unless it&#39;s a COUNTA() or similar.  In Access pivot you <i>can</i>. BTW you should tag your question <code>Excel</code>."}, {"owner": {"reputation": 143, "user_id": 4288062, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/88928ecaf192be3c161243187a4af318?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Koefoed", "link": "https://stackoverflow.com/users/4288062/sebastian-koefoed"}, "reply_to_user": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1469604745, "post_id": 38606362, "comment_id": 64599869, "body": "They are referring to the (Missing Data) PivotItems. The pivot table are based on a regular table where the &quot;ServiceRange are a mix of values and text. Would it help if I made the (Missing Data) Blank?"}], "owner": {"reputation": 143, "user_id": 4288062, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/88928ecaf192be3c161243187a4af318?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Koefoed", "link": "https://stackoverflow.com/users/4288062/sebastian-koefoed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 275, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1469605527, "creation_date": 1469604075, "last_edit_date": 1469605527, "question_id": 38606362, "link": "https://stackoverflow.com/questions/38606362/excel-pivot-table-filter-with-text-items-in-the-value-field", "title": "Excel pivot table filter with text items in the value field", "body": "<p>I am using the below code to filter on text called <code>(Missing Data)</code>, however after I've run the code the text items are still visible in the pivot table.</p>\n\n<p>Notion: the pivot table are created from a regular table, and the <code>ServiceRange</code> column consists of a mix between text items and value items.</p>\n\n<pre><code>        For Each PI In PvtTbl_RegionalPeerGroup.PivotFields(\"ServiceRange\").PivotItems\n            If PI.Caption = \"(Missing Data)\" Then\n                PI.Visible = False\n                Stop\n            End If\n        Next PI\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1469603753, "post_id": 38606139, "comment_id": 64599178, "body": "if you are getting all these options from an Excel sheet, you don&#39;t need VBA, you can just use Data --&gt; Remove Duplicates"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1469604835, "post_id": 38606139, "comment_id": 64599939, "body": "is <code>Findstring </code> to be searched in column &quot;A&quot; only and then, if found, check for adjacent cell in column B against <code>Findchange </code>? Do you have to check for ALL matching values in column &quot;A&quot;. Please add a &quot;before&quot; and &quot;after&quot; scenario"}, {"owner": {"reputation": 27, "user_id": 6371166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a3999631ddac335f9716ded8fd32eb2?s=128&d=identicon&r=PG&f=1", "display_name": "cparsons", "link": "https://stackoverflow.com/users/6371166/cparsons"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1469705183, "post_id": 38606139, "comment_id": 64653051, "body": "@ShaiRado I need to keep all previous entries in the worksheet and add new ones if Column A and B dont match TB1 and TB2 values."}, {"owner": {"reputation": 27, "user_id": 6371166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a3999631ddac335f9716ded8fd32eb2?s=128&d=identicon&r=PG&f=1", "display_name": "cparsons", "link": "https://stackoverflow.com/users/6371166/cparsons"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1469705615, "post_id": 38606139, "comment_id": 64653318, "body": "@user3598756 yes, and yes. If Column A has no match, find the next available row and add the info. If column A has at least one match I need to check the matches in their adjacent cell (column B) against &#39;findchange&#39;   if &quot;Findstring&quot; is in Col A with &#39;Findchange&#39; adjacent in Col B, return msgbox, if not add the info.  Thanks for the help."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 6371166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a3999631ddac335f9716ded8fd32eb2?s=128&d=identicon&r=PG&f=1", "display_name": "cparsons", "link": "https://stackoverflow.com/users/6371166/cparsons"}, "edited": false, "score": 0, "creation_date": 1469853462, "post_id": 38606467, "comment_id": 64721464, "body": "Thank you for your help. I have implemented your suggestions, but now I am having the issue of it will always add the information."}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "reply_to_user": {"reputation": 27, "user_id": 6371166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a3999631ddac335f9716ded8fd32eb2?s=128&d=identicon&r=PG&f=1", "display_name": "cparsons", "link": "https://stackoverflow.com/users/6371166/cparsons"}, "edited": false, "score": 0, "creation_date": 1469855556, "post_id": 38606467, "comment_id": 64721822, "body": "In your example the items are in column 1 but you are looking in column two...?"}, {"owner": {"reputation": 27, "user_id": 6371166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a3999631ddac335f9716ded8fd32eb2?s=128&d=identicon&r=PG&f=1", "display_name": "cparsons", "link": "https://stackoverflow.com/users/6371166/cparsons"}, "edited": false, "score": 0, "creation_date": 1469861243, "post_id": 38606467, "comment_id": 64722853, "body": "I need to find column 2 value first, to see  if it matches the TB1. if it matches I need to see if TB2 matches the adjacent value. if not add the TB values to the next available row."}, {"owner": {"reputation": 27, "user_id": 6371166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a3999631ddac335f9716ded8fd32eb2?s=128&d=identicon&r=PG&f=1", "display_name": "cparsons", "link": "https://stackoverflow.com/users/6371166/cparsons"}, "edited": false, "score": 0, "creation_date": 1469861502, "post_id": 38606467, "comment_id": 64722898, "body": "sorry that&#39;s correct, the data to match is in column 2 not 1."}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "reply_to_user": {"reputation": 27, "user_id": 6371166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a3999631ddac335f9716ded8fd32eb2?s=128&d=identicon&r=PG&f=1", "display_name": "cparsons", "link": "https://stackoverflow.com/users/6371166/cparsons"}, "edited": false, "score": 0, "creation_date": 1469862283, "post_id": 38606467, "comment_id": 64723051, "body": "Try stepping through your code using F8 to see why it&#39;s adding unwanted items. There is a guide to debugging in the [vba] tag-wiki I think l. I&#39;m on mobile so can&#39;t really help you any more..."}], "tags": [], "owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "is_accepted": true, "score": 0, "last_activity_date": 1469604374, "creation_date": 1469604374, "answer_id": 38606467, "question_id": 38606139, "link": "https://stackoverflow.com/questions/38606139/vba-search-a-worksheet-for-textbox1-if-tb1-is-found-check-if-tb2-text-is-adjace/38606467#38606467", "title": "VBA Search a worksheet for Textbox1, if TB1 is found check if TB2 text is adjacent", "body": "<p>You can use the <code>.Offset</code> property to access cells relative to a certain cell:</p>\n\n<pre><code>'...\nIf Not Rng Is Nothing Then\n    If Rng.Offset(0,1).Value = Findchange Then\n        MsgBox \"Item already entered.\" \n    End If\nElse\n'...\n</code></pre>\n\n<p>You can't do both checks within one line (<code>Not Rng Is Nothing And Rng.Offset(0,1).Value = Findchange</code>) because VBA will check the second condition even if the first isn't true.</p>\n\n<p>You can also search column 1 instead of the whole sheet:</p>\n\n<pre><code>Set Rng = ws.Columns(1).Find('...\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 6371166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a3999631ddac335f9716ded8fd32eb2?s=128&d=identicon&r=PG&f=1", "display_name": "cparsons", "link": "https://stackoverflow.com/users/6371166/cparsons"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "accepted_answer_id": 38606467, "answer_count": 1, "score": 1, "last_activity_date": 1470138448, "creation_date": 1469603508, "last_edit_date": 1470138448, "question_id": 38606139, "link": "https://stackoverflow.com/questions/38606139/vba-search-a-worksheet-for-textbox1-if-tb1-is-found-check-if-tb2-text-is-adjace", "title": "VBA Search a worksheet for Textbox1, if TB1 is found check if TB2 text is adjacent", "body": "<p>I am updating this in case anyone else out there may have a need for it and to see if anyone has any suggestions to this code (I am very new to VBA so any critiques are welcome). </p>\n\n<p>The following code will search Column 2 of a giving worksheet for the textBox1 value. If not found it will add the information. If it is found, it finds all instances of said find and searches the adjacent column for Textbox 2. If not found it adds the information, if it is found it returns a Msgbox.</p>\n\n<pre><code>`Private Sub cbAdd_Click()\nDim wss As Worksheet\nDim LR As Long\nDim Fnd As String, FF As String, Change As String\nDim FC As Range, LC As Range, Rng As Range, ChgId As Range\nDim FndChg As Range, SRange As Range, Rng2 As Range\n\n'tb = Text Box, cb = Combo Box\n'These are the values that need to be found, if present.\nmis = tbMis.Text\nChange = tbChg.Text\n\n'Activate the Sheet to search in, then set the search criteria.\n\nThisWorkbook.Sheets(\"DB\").Activate\nSet wss = ThisWorkbook.Sheets(\"DB\") 'wss for me is worksheet searched\nSet SRange = wss.Columns(2) 'Sets the range to search with SRange as Column  B of \"DB\"\nSet LC = SRange.Cells(SRange.Cells.count) 'Finds the LastCell (LC) of the  search range\nSet FC = SRange.Find(what:=mis, after:=LC) 'FC is the First Cell found matching \"mis\"\nLR = Cells(Rows.count, \"A\").End(xlUp).Row 'Finds the last row in the \"DB\"   worksheet, used when adding the information.\n\n'Checking to see if anything was found.\nIf FC Is Nothing Then\n    GoTo AddMis 'If the mis is not found, add the information.\nEnd If\n\nIf Not FC Is Nothing Then 'If mis was found FF (First Found) is the address  of where it was found.\n    FF = FC.Address\nEnd If\n\nSet Rng = FC\n\n'This loops the search until it finds all instances of mis in column 2.\nDo Until FC Is Nothing\nSet FC = SRange.FindNext(after:=FC) 'Continues the search after the last    found cell.\nSet Rng = Union(Rng, FC) 'Adds the found cells to my range \"Rng\".\nIf FC.Address = FF Then Exit Do 'continues the loop until it cycles to the  first found cell.\nLoop\n\nRng.Select\nSelection.Offset(0, 1).Select 'Selects adjacent cells in order to see if these match \"change\".\nSet ChgId = Selection.Find(what:=Change, Lookat:=True) 'Will compare Column 3 against info input into \"change\"\n\nIf Not ChgId Is Nothing Then\n    GoTo Duplicate\nElse\n    GoTo AddMis\nEnd If\n\n'Handlers\nAddMis:\nSheets(\"DB\").Range(\"A\" &amp; LR + 1).Value = tbSat.Text 'Adds the ComboBox1  selection to the next available row in column 1.\nSheets(\"DB\").Range(\"A\" &amp; LR + 1).Offset(0, 1).Value = tbMis.Text 'Adds tbMis  Text to the same row in column 2.\nSheets(\"DB\").Range(\"A\" &amp; LR + 1).Offset(0, 2).Value = tbChg.Text 'Adds tbChg Text to the same row in column 3.\nSheets(\"DB\").Range(\"A\" &amp; LR + 1).Offset(0, 3).Value = tbPri.Text 'Adds ComboBox2 selection to the same row in column 4.\n\nMsgbox \"Information added\" 'Lets the user know the information has been added.\nUnload Me 'Closes the Userform with the input fields\nExit Sub\nDuplicate:\nMsgbox \"Information has already been input into the database.\" 'Lets the   user know that the information already exists.\nUnload Me\nExit Sub\n\nEnd Sub'\n</code></pre>\n\n<p>I would like to thank the entire overflow community, although there may not have been a definitive answer on this question, the site and knowledge base of others available helped me ultimately solve this problem. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1469603544, "post_id": 38606056, "comment_id": 64599041, "body": "are you trying to have this formula set to this cell ?"}, {"owner": {"reputation": 889, "user_id": 6643271, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/QG2qv.jpg?s=128&g=1", "display_name": "Eem Jee", "link": "https://stackoverflow.com/users/6643271/eem-jee"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1469603818, "post_id": 38606056, "comment_id": 64599223, "body": "@ShaiRado Yes, thats what I&#39;m trying to do."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 1, "creation_date": 1469604185, "post_id": 38606056, "comment_id": 64599489, "body": "Why don&#39;t you just use a number format? Looks like you&#39;re trying to re-invent the wheel."}, {"owner": {"reputation": 889, "user_id": 6643271, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/QG2qv.jpg?s=128&g=1", "display_name": "Eem Jee", "link": "https://stackoverflow.com/users/6643271/eem-jee"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1469604440, "post_id": 38606056, "comment_id": 64599678, "body": "@teylyn Opps, but the column is not constant. That&#39;s just my sample :) Thanks"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1469604492, "post_id": 38606056, "comment_id": 64599706, "body": "The column &quot;K&quot; looks pretty constant to me. If you can identify the cell, then you can apply a number format."}, {"owner": {"reputation": 889, "user_id": 6643271, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/QG2qv.jpg?s=128&g=1", "display_name": "Eem Jee", "link": "https://stackoverflow.com/users/6643271/eem-jee"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1469604790, "post_id": 38606056, "comment_id": 64599908, "body": "@teylyn Number Format will only convert the data to positive or negative. What i want is if its a negative number, i will convert it to positive and and enclose the data with parenthesis."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1469605197, "post_id": 38606056, "comment_id": 64600200, "body": "Number formats will not convert anything. It is just formatting, i.e. display. The underlying value does not change. What you are trying to do with the macro will actually take a number and turn it into text. Unsuable for further calculations."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1469605280, "post_id": 38606056, "comment_id": 64600251, "body": "Have you done ANY research at all before asking your question? It seems you don&#39;t really understand how number formats work. And there are lots of resources about how to use number formats in VBA. You just couldn&#39;t be bothered to look, it seems."}, {"owner": {"reputation": 889, "user_id": 6643271, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/QG2qv.jpg?s=128&g=1", "display_name": "Eem Jee", "link": "https://stackoverflow.com/users/6643271/eem-jee"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1469605654, "post_id": 38606056, "comment_id": 64600467, "body": "@teylyn Yep that&#39;s what I mean .. Im sorrry, but I&#39;ve tried every suggestions, I just can&#39;t make it work. Thanks anyway."}], "answers": [{"comments": [{"owner": {"reputation": 889, "user_id": 6643271, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/QG2qv.jpg?s=128&g=1", "display_name": "Eem Jee", "link": "https://stackoverflow.com/users/6643271/eem-jee"}, "edited": false, "score": 0, "creation_date": 1469604857, "post_id": 38606586, "comment_id": 64599957, "body": "Is there&#39;s any way you can convert this to VBA?"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1469604742, "creation_date": 1469604742, "answer_id": 38606586, "question_id": 38606056, "link": "https://stackoverflow.com/questions/38606056/parenthesis-is-not-recognized/38606586#38606586", "title": "parenthesis is not recognized", "body": "<p>Select your Range, then go to <em>Format Cells</em>... --> <em>Custom</em>, and type in:</p>\n\n<pre><code>_(* #,##0_);_(* (#,##0);_(\"-\");_()\n</code></pre>\n\n<p>This will take your negative values and pout it inside brackets</p>\n"}, {"tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": true, "score": 2, "last_activity_date": 1469606864, "creation_date": 1469606864, "answer_id": 38607289, "question_id": 38606056, "link": "https://stackoverflow.com/questions/38606056/parenthesis-is-not-recognized/38607289#38607289", "title": "parenthesis is not recognized", "body": "<p>Take this as a guide:</p>\n\n<p>A negative value is copied into cell A2. A2 is then formatted to show negative values in brackets, with two decimals. </p>\n\n<pre><code>Sub test()\nRange(\"A1\").Copy Range(\"A2\")\nRange(\"A2\").NumberFormat = \"0.00;(0.00);0\"\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/LkDvd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LkDvd.png\" alt=\"enter image description here\"></a></p>\n\n<p>Nothing gets converted. No brackets are concatenated. The cell is simply formatted with a custom number format. The syntax for number formats in Excel is</p>\n\n<pre><code>&lt;format for positive values&gt;;&lt;format for negative values&gt;;&lt;format for zeroes&gt;;text\n</code></pre>\n\n<p>for example, the custom format</p>\n\n<pre><code>0;-0;;\n</code></pre>\n\n<p>will show positive values as whole numbers, negative values with a leading <code>-</code> sign, hide zeroes and hide text.</p>\n"}, {"tags": [], "owner": {"reputation": 318, "user_id": 3691612, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/FpqBe.jpg?s=128&g=1", "display_name": "romulus001", "link": "https://stackoverflow.com/users/3691612/romulus001"}, "is_accepted": false, "score": 1, "last_activity_date": 1469606978, "creation_date": 1469606978, "answer_id": 38607329, "question_id": 38606056, "link": "https://stackoverflow.com/questions/38606056/parenthesis-is-not-recognized/38607329#38607329", "title": "parenthesis is not recognized", "body": "<p>In vba code:</p>\n\n<pre><code>if wb2.ActiveSheet.Range(\"K\" &amp; lrow3 + 1).Value&lt;=0 then\n    wb2.ActiveSheet.Range(\"K\" &amp; lrow3 + 1).Value = wb2.ActiveSheet.Range(\"K\" &amp; lrow3 + 1).Value * -1\nelse\n    wb2.ActiveSheet.Range(\"K\" &amp; lrow3 + 1).numberformat = \"@\"\n    wb2.ActiveSheet.Range(\"K\" &amp; lrow3 + 1).Value = \"(\" &amp; wb2.ActiveSheet.Range(\"K\" &amp; lrow3 + 1).Value * -1 &amp; \")\"\nend if\n</code></pre>\n"}], "owner": {"reputation": 889, "user_id": 6643271, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/QG2qv.jpg?s=128&g=1", "display_name": "Eem Jee", "link": "https://stackoverflow.com/users/6643271/eem-jee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 38607289, "answer_count": 3, "score": 1, "last_activity_date": 1469606978, "creation_date": 1469603319, "last_edit_date": 1531164843, "question_id": 38606056, "link": "https://stackoverflow.com/questions/38606056/parenthesis-is-not-recognized", "title": "parenthesis is not recognized", "body": "<p>Anybody can please look at my code below in vba.</p>\n\n<pre><code> wb2.ActiveSheet.Range(\"K\" &amp; lrow3 + 1).Value = \"(\" &amp; wb2.ActiveSheet.Range(\"K\" &amp; lrow3 + 1).Value * -1 &amp; \")\"\n</code></pre>\n\n<p>This only outputs </p>\n\n<pre><code>-24.5\n</code></pre>\n\n<p>That formula will convert the value in a cell if the value of the cell is negative and put it inside the parenthesis. Thanks.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1544, "user_id": 3480318, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/bf703895923e89cd94a85d801205e4cd?s=128&d=identicon&r=PG&f=1", "display_name": "Nehal", "link": "https://stackoverflow.com/users/3480318/nehal"}, "edited": false, "score": 2, "creation_date": 1469603421, "post_id": 38605928, "comment_id": 64598959, "body": "We are here to help you solve your issues. Rather then completely answering and writing code for you. Please let us us know what efforts have you put to do this."}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1469607233, "post_id": 38605928, "comment_id": 64601472, "body": "Try using <code>match</code> or <code>countif</code> functions. You don&#39;t need VBA for this. Or you can buy a plugin that does this for you. (More reading: <a href=\"https://www.google.com\" rel=\"nofollow noreferrer\">Google</a>)"}], "answers": [{"tags": [], "owner": {"reputation": 746, "user_id": 6400030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oyeSx.png?s=128&g=1", "display_name": "Arun Thomas", "link": "https://stackoverflow.com/users/6400030/arun-thomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1469625315, "last_edit_date": 1469625315, "creation_date": 1469619115, "answer_id": 38611757, "question_id": 38605928, "link": "https://stackoverflow.com/questions/38605928/macro-to-match-two-sets-of-data/38611757#38611757", "title": "Macro to match two sets of data", "body": "<p>Assuming 'i' is the number of rows in Sheet1 and 'm' is the number of rows in Sheet2 and 7 headings in each sheets, then this is the solution where the mismatches are registered in Sheet3</p>\n\n<p>Here the Id numbers in Sheet1 is compared with Id numbers in Sheet2 and if present, then they are compared and the mismatches are reported in sheet3 in the same order of the Headings</p>\n\n<pre><code>Sub Mismatch()\n\nDim temp3 As Integer\ntemp3 = 1\n\nDim array1(7), array2(7), array3(7) As Variant\n\nFor i = 2 To 6\nWorksheets(\"Sheet1\").Activate\nFor temp = 1 To 7\n    array1(temp) = Cells(i, temp).Value\nNext temp\n\nWorksheets(\"Sheet2\").Activate\n\nFor m = 2 To 6\n    If Cells(m, 1).Value = array1(1) Then\n        For n = 1 To 7\n            For temp2 = 1 To 7\n                array2(temp2) = Cells(m, temp2).Value\n            Next temp2\n            Worksheets(\"Sheet3\").Activate\n            temp3 = temp3 + 1\n\n            Cells(temp3, 1).Value = array1(1)\n\n            For temp4 = 2 To 7\n                If array1(temp4) &lt;&gt; array2(temp4) Then\n                    Cells(temp3, temp4).Value = \"mismatch\"\n                End If\n            Next temp4\n\n            GoTo JumpToHere\n\n        Next n\n    End If\nNext m\nJumpToHere:\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>I Hope this helps</p>\n"}], "owner": {"reputation": 11, "user_id": 6049059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b68e301f3abb05e05e7539fe69fa5df8?s=128&d=identicon&r=PG&f=1", "display_name": "Keven", "link": "https://stackoverflow.com/users/6049059/keven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 545, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1469625315, "creation_date": 1469602980, "last_edit_date": 1531164843, "question_id": 38605928, "link": "https://stackoverflow.com/questions/38605928/macro-to-match-two-sets-of-data", "title": "Macro to match two sets of data", "body": "<p>I need help to write macro to compare two sheets in excel, sheet1 and sheet2 on same excel book and display all the differences between both the sheets on sheet3. \nMy headings will always be the same between sheet1 and sheet2 but the information in both the sheets may vary. \n I included the headings that will be on both the sheets:</p>\n\n<p>ID Number Date of Birth Payroll Number Surname First Name Salary  Member Group</p>\n\n<p>I am struggling with this. So please extend your helping hands \nThank you.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2820, "user_id": 3390468, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/768800013/picture?type=large", "display_name": "Steven Martin", "link": "https://stackoverflow.com/users/3390468/steven-martin"}, "edited": false, "score": 0, "creation_date": 1469598969, "post_id": 38604654, "comment_id": 64596488, "body": "As u find them , store in an 2d array  (name , row number )"}, {"owner": {"reputation": 1, "user_id": 6606032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3d47e6f65a6a1872b64518a1365ff9e?s=128&d=identicon&r=PG&f=1", "display_name": "Morlo4", "link": "https://stackoverflow.com/users/6606032/morlo4"}, "reply_to_user": {"reputation": 2820, "user_id": 3390468, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/768800013/picture?type=large", "display_name": "Steven Martin", "link": "https://stackoverflow.com/users/3390468/steven-martin"}, "edited": false, "score": 0, "creation_date": 1469599244, "post_id": 38604654, "comment_id": 64596610, "body": "Sounds like a good idea :), I&#39;ll give it a try and report back, I&#39;m still learning so please forgive the poor code."}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1469602354, "post_id": 38604654, "comment_id": 64598321, "body": "When exactly are you getting the error? While executing the <code>SelectBold</code> sub or another sub? How and where (module) are the variables declared?"}, {"owner": {"reputation": 1, "user_id": 6606032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3d47e6f65a6a1872b64518a1365ff9e?s=128&d=identicon&r=PG&f=1", "display_name": "Morlo4", "link": "https://stackoverflow.com/users/6606032/morlo4"}, "edited": false, "score": 0, "creation_date": 1470001314, "post_id": 38604654, "comment_id": 64756820, "body": "It isn&#39;t giving me an error at this stage, instead it is just storing nothing as the variable <code>bold1</code> when I want it to store the term found that is in bold"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6606032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3d47e6f65a6a1872b64518a1365ff9e?s=128&d=identicon&r=PG&f=1", "display_name": "Morlo4", "link": "https://stackoverflow.com/users/6606032/morlo4"}, "edited": false, "score": 0, "creation_date": 1470117644, "post_id": 38605843, "comment_id": 64802366, "body": "Thanks, the array based solution is the way to go! It made everything a lot neater prevents having to have so many variables."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 1, "user_id": 6606032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3d47e6f65a6a1872b64518a1365ff9e?s=128&d=identicon&r=PG&f=1", "display_name": "Morlo4", "link": "https://stackoverflow.com/users/6606032/morlo4"}, "edited": false, "score": 0, "creation_date": 1470117802, "post_id": 38605843, "comment_id": 64802427, "body": "Glad that I could help!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1469602720, "creation_date": 1469602720, "answer_id": 38605843, "question_id": 38604654, "link": "https://stackoverflow.com/questions/38604654/searching-and-returning-bold-values-in-vba/38605843#38605843", "title": "Searching and Returning bold values in VBA", "body": "<p>This will return an array of values from bold cells in column A of Page.</p>\n\n<p>You can fill a combo or list box with theses values using their list property.</p>\n\n<blockquote>\n  <p>ComboBox1.List = getSubCategories(\"Sheet1\")</p>\n</blockquote>\n\n<pre><code>Function getSubCategories(Page As String) As String()\n\n    Dim arrSubCategories() As String\n    Dim count As Long\n    Dim c As Range\n\n    With Worksheets(Page)\n        For Each c In .Range(\"A2\", .Range(\"A\" &amp; Rows.count).End(xlUp))\n            If c.Font.Bold Then\n                ReDim Preserve arrSubCategories(count)\n                arrSubCategories(count) = c.Value\n                count = count + 1\n            End If\n        Next\n    End With\n\n    getSubCategories = arrSubCategories\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1470136792, "post_id": 38608713, "comment_id": 64814026, "body": "@Morlo4: did you get through it?"}, {"owner": {"reputation": 1, "user_id": 6606032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3d47e6f65a6a1872b64518a1365ff9e?s=128&d=identicon&r=PG&f=1", "display_name": "Morlo4", "link": "https://stackoverflow.com/users/6606032/morlo4"}, "edited": false, "score": 0, "creation_date": 1470173875, "post_id": 38608713, "comment_id": 64838064, "body": "Yeah I eventually did thanks, whilst I didn&#39;t use your solution so to speak, it did help me to understand how it worked!"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 1, "user_id": 6606032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3d47e6f65a6a1872b64518a1365ff9e?s=128&d=identicon&r=PG&f=1", "display_name": "Morlo4", "link": "https://stackoverflow.com/users/6606032/morlo4"}, "edited": false, "score": 0, "creation_date": 1470175601, "post_id": 38608713, "comment_id": 64838786, "body": "Posting your solution may help other people"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1469610947, "creation_date": 1469610947, "answer_id": 38608713, "question_id": 38604654, "link": "https://stackoverflow.com/questions/38604654/searching-and-returning-bold-values-in-vba/38608713#38608713", "title": "Searching and Returning bold values in VBA", "body": "<p>you may find useful to have a <code>Range</code> returned with subcategories cells found:</p>\n\n<pre><code>Function SelectBold(Page As String, colIndex As String) As Range\n    With Worksheets(Page)\n        With .Range(colIndex &amp; \"1\", .Cells(.Rows.Count, colIndex).End(xlUp)).Offset(, .UsedRange.Columns.Count)\n            .FormulaR1C1 = \"=if(isbold(RC[-1]),\"\"\"\",1)\"\n            .Value = .Value\n            If WorksheetFunction.CountA(.Cells) &lt; .Rows.Count Then Set SelectBold = Intersect(.SpecialCells(xlCellTypeBlanks).EntireRow, .Parent.Columns(1))\n            .Clear\n        End With\n    End With\nEnd Function\n\nFunction IsBold(rCell As Range)\n    IsBold = rCell.Font.Bold\nEnd Function\n</code></pre>\n\n<p>to be possibly exploited as follows:</p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim subCategoriesRng As Range, cell As Range\n\n    Set subCategoriesRng = SelectBold(Worksheets(\"bolds\").Name, \"A\") '&lt;--| pass worksheet name and column to search in\n\n    If Not subCategoriesRng Is Nothing Then\n        For Each cell In subCategoriesRng '&lt;--| loop through subcategories cells\n            '... code\n        Next cell\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6606032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3d47e6f65a6a1872b64518a1365ff9e?s=128&d=identicon&r=PG&f=1", "display_name": "Morlo4", "link": "https://stackoverflow.com/users/6606032/morlo4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 761, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1487878942, "creation_date": 1469598415, "last_edit_date": 1487878942, "question_id": 38604654, "link": "https://stackoverflow.com/questions/38604654/searching-and-returning-bold-values-in-vba", "title": "Searching and Returning bold values in VBA", "body": "<p>I know that this probably isn't the most ideal way to to do this but just bear with me. </p>\n\n<p>I have a document with a few tables on it. I'm using a userform to search the tables/sub-categories and return the relevant values. I want to select the sub categories with a range of option buttons on a userform, these will in turn set the range for the search function to look within. I also want to dynamically update the option buttons if a new table was to be added or anything along those lines. </p>\n\n<p>The only thing that differentiates the title of a sub-category/table, and the items within it, is that the title of a sub-category/table is bold. So what I'm looking to do is search the first column of the spreadsheet and return the names of any entries in bold. These values are then used to set the names of the option buttons :).</p>\n\n<p>The following function is my attempt at finding the text entities in column a that are in bold, returning them and setting each to an individual variable to be used in another function. The <code>bold1</code> .... variables are all globally defined variables as I need them in another sub, as is the <code>page</code> variable which contains the relevant page to be used. Currently the code returns an error stating \"variable or with block not set\" and using the debugger I can see that <code>bold1</code> .... and all the other boldx variables have no value set. Does anybody know whats going on/how to fix this function.</p>\n\n<p>Thanks in advance :)</p>\n\n<pre><code>Sub SelectBold()\n    Dim Bcell As Range\n    For Each Bcell In Worksheets(Page).Range(\"A1:A500\")\n        If Bcell.Font.Bold = True Then\n            Set bold1 = Bcell\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>EDIT: I simplified the above function, to remove clutter and help narrow in on the issue. I want the above function to store the contents of the found cell (any cell in the document in bold at this stage) in the variable <code>bold1</code></p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 9902, "user_id": 1960027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z89Jo.jpg?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/1960027/simon"}, "edited": false, "score": 0, "creation_date": 1469646880, "post_id": 38609115, "comment_id": 64628496, "body": "Excellent. That does the job very nicely. Thank you."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1379931"}, "is_accepted": true, "score": 3, "last_activity_date": 1469612039, "creation_date": 1469612039, "answer_id": 38609115, "question_id": 38604356, "link": "https://stackoverflow.com/questions/38604356/how-to-distinguish-a-ms-equation-object-from-other-inlineshapes-in-a-word-docume/38609115#38609115", "title": "How to distinguish a MS Equation object from other InlineShapes in a Word document", "body": "<p>Equation 3.0 equations are embedded OLE objects (unlike the newer type of equation which uses a different mechanism. So something like</p>\n\n<pre><code>If shp.Type = wdInlineShapeEmbeddedOLEObject Then\n  If shp.OLEFormat.ClassType = \"Equation.3\" Then\n    ' it's an equation object\n  End If\nEnd If\n</code></pre>\n\n<p>This assumes that you haven't converted the shapes to something else, e.g. copied/pasted as a graphic of some kind.</p>\n"}], "owner": {"reputation": 9902, "user_id": 1960027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z89Jo.jpg?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/1960027/simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 591, "favorite_count": 1, "accepted_answer_id": 38609115, "answer_count": 1, "score": 1, "last_activity_date": 1469612039, "creation_date": 1469597104, "last_edit_date": 1495535323, "question_id": 38604356, "link": "https://stackoverflow.com/questions/38604356/how-to-distinguish-a-ms-equation-object-from-other-inlineshapes-in-a-word-docume", "title": "How to distinguish a MS Equation object from other InlineShapes in a Word document", "body": "<p>I have some MS-Word 2013 documents containing <em>Microsoft Equation 3.0</em> equations. Unfortunately, the equations change size from time to time, whether by accident or perhaps due to a bug in Word.</p>\n\n<p>To address this, I wrote a VBA macro to fix the sizes of all the equations in the document back to their original sizes, as follows:</p>\n\n<pre><code>Sub FixEquationSize()\n    Dim shp As InlineShape\n    For Each shp In ActiveDocument.InlineShapes\n         shp.ScaleHeight = 100    'The value of ScaleHeight is a percentage\n         shp.ScaleWidth = 100\n         shp.LockAspectRatio = msoFalse\n         shp.Reset\n    Next\nEnd Sub\n</code></pre>\n\n<p>... however this fixes the height and width of all <code>InlineShape</code> objects, not just the ones that are equations.</p>\n\n<p>A <a href=\"https://stackoverflow.com/questions/26043173/find-equations-in-word-and-save-each-out-as-separate-file\">previous question and answer</a> found equations in Word by iterating through <code>ActiveDocument.OMaths</code>, but that solution found equations created by <code>Insert|Symbols|Equation</code>, not equations inserted by <code>Insert|Text|Object|Microsoft Equation 3.0</code> (it is interesting that they are different!).</p>\n\n<p>If I have to iterate through <code>InlineShapes</code>, how could I distinguish <code>InlineShape</code> objects that are equations from those that are not?</p>\n"}, {"tags": ["excel", "vba", "charts", "categories"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1469604595, "post_id": 38604026, "comment_id": 64599766, "body": "Why can&#39;t you add a column to the query? It&#39;s simple enough to do without resorting to VBA to manipulate the chart."}, {"owner": {"reputation": 1, "user_id": 6228284, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80e635caabe8ee03cb8f34e91a8950f8?s=128&d=identicon&r=PG&f=1", "display_name": "Hope", "link": "https://stackoverflow.com/users/6228284/hope"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1469757499, "post_id": 38604026, "comment_id": 64681178, "body": "I guess I could but I couldn&#39;t quite figure out the logic for running totals for that column."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6228284, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80e635caabe8ee03cb8f34e91a8950f8?s=128&d=identicon&r=PG&f=1", "display_name": "Hope", "link": "https://stackoverflow.com/users/6228284/hope"}, "is_accepted": false, "score": 0, "last_activity_date": 1469757696, "creation_date": 1469757696, "answer_id": 38649391, "question_id": 38604026, "link": "https://stackoverflow.com/questions/38604026/vba-excel-pivot-chart-data-point-marker-based-on-category-name/38649391#38649391", "title": "VBA Excel Pivot Chart Data Point Marker based on Category Name", "body": "<p>I have used simple Excel formulas to determine the data point index of current month and then changed line colour through macro looping from the start of the project to current month :</p>\n\n<pre><code>        For i = 1 To DataPointIndex\n        ActiveChart.ChartArea.Select\n        ActiveChart.SeriesCollection(1).Select\n        ActiveChart.SeriesCollection(1).Points(i).Select\n        With Selection.Format.Line\n                .Visible = msoTrue\n                .ForeColor.RGB = RGB(255, 0, 0) \n                .Transparency = 0\n                .DashStyle = msoLineSolid       \n        End With\n</code></pre>\n\n<p>Similar could be done with marker, but I prefer different line colour.</p>\n"}], "owner": {"reputation": 1, "user_id": 6228284, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80e635caabe8ee03cb8f34e91a8950f8?s=128&d=identicon&r=PG&f=1", "display_name": "Hope", "link": "https://stackoverflow.com/users/6228284/hope"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 161, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1469757696, "creation_date": 1469595393, "question_id": 38604026, "link": "https://stackoverflow.com/questions/38604026/vba-excel-pivot-chart-data-point-marker-based-on-category-name", "title": "VBA Excel Pivot Chart Data Point Marker based on Category Name", "body": "<p>I have a data table in Excel that is populated through SQL query.</p>\n\n<p>This table is a data source for the pivot table, which in its turn used to created a pivot chart.</p>\n\n<p>I need to show data till this month (e.g. July-2016) in one colour and future in another. I did my research and it appears that I have to manipulate source data to do so (meaning the results of the SQL query should be changed). It is not possible in my case.</p>\n\n<p>So I decided to highlight \"Today\" data point to show where past and future meet. How can I do it using VBA? I need something with this logic:</p>\n\n<pre><code>for i=1 to category.count\nif categoryname(i)=\"July-2016\" then change marker style\nend if\nnext\n</code></pre>\n\n<p>Thank you.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 6577040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee372c9712fe996d9d1ad6c42d55dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6577040/robert"}, "edited": false, "score": 0, "creation_date": 1469605630, "post_id": 38603842, "comment_id": 64600454, "body": "Thanks. Sory for been so new in VBA. Should I copy the code and paste it as follow:"}, {"owner": {"reputation": 5, "user_id": 6577040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee372c9712fe996d9d1ad6c42d55dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6577040/robert"}, "edited": false, "score": 0, "creation_date": 1469605667, "post_id": 38603842, "comment_id": 64600474, "body": "Sub FilterRows()     Dim rSource As Range      On Error Resume Next     Set rSource = Intersect(ActiveSheet.UsedRange, Range(&quot;B2:S65536&quot; &amp; Rows.Count)).SpecialCells(xlCellTypeVisible)     On Error GoTo 0      If Not rSource Is Nothing Then          rSource.Copy Destination:=Sheet1.Range(&quot;AA2&quot;)         Cells(1, 1).Resize(160, 17).Value = Cells(Cells(Rows.Count, _                 2).End(xlUp).Row - 159, 2).Resize(160, 17).Value     End If  End Sub"}, {"owner": {"reputation": 2342, "user_id": 6283475, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/s6Dic.jpg?s=128&g=1", "display_name": "KyloRen", "link": "https://stackoverflow.com/users/6283475/kyloren"}, "reply_to_user": {"reputation": 5, "user_id": 6577040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee372c9712fe996d9d1ad6c42d55dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6577040/robert"}, "edited": false, "score": 0, "creation_date": 1469605766, "post_id": 38603842, "comment_id": 64600535, "body": "That line will copy all the rows from the last row to 160, you don&#39;t need anything else. What is the range you want the data copied to? ie, <code>Sheets(&quot;Sheet1&quot;).Range(&quot;A1)</code>"}, {"owner": {"reputation": 5, "user_id": 6577040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee372c9712fe996d9d1ad6c42d55dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6577040/robert"}, "edited": false, "score": 0, "creation_date": 1469754386, "post_id": 38603842, "comment_id": 64680515, "body": "HI&#39; I want to copy the last 160 filtered data to Sheet 4, in cell B2."}, {"owner": {"reputation": 5, "user_id": 6577040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee372c9712fe996d9d1ad6c42d55dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6577040/robert"}, "edited": false, "score": 0, "creation_date": 1469755845, "post_id": 38603842, "comment_id": 64680821, "body": "Hello KyloRen! My range with data is from Sheet1(B1 to S65536). The titles are on row 1 from B1 to S1. I want to copy the last 160 filtered data  to (&quot;Sheet4&quot;).Range (&quot;B2&quot;), The titles are already copied on Sheet4 from B1 to S1. The last 160 filtered data will then be copied to B2 to S161. Thanks"}], "tags": [], "owner": {"reputation": 2342, "user_id": 6283475, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/s6Dic.jpg?s=128&g=1", "display_name": "KyloRen", "link": "https://stackoverflow.com/users/6283475/kyloren"}, "is_accepted": false, "score": 0, "last_activity_date": 1469605932, "last_edit_date": 1469605932, "creation_date": 1469594323, "answer_id": 38603842, "question_id": 38602995, "link": "https://stackoverflow.com/questions/38602995/range-selection-from-last-160-rows/38603842#38603842", "title": "Range Selection from last 160 rows", "body": "<p>You will have to adjust where you want the output to be copied to,but try this below, Using this part of the code <code>Cells(1, 1)</code></p>\n\n<pre><code>Sub test()\n   Sheets(\"Sheet1\").Cells(2, 14).Resize(160, 17).Value = Cells(Cells(Rows.Count, _\n                2).End(xlUp).Row - 159, 2).Resize(160, 17).Value\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 5, "user_id": 6577040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee372c9712fe996d9d1ad6c42d55dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6577040/robert"}, "edited": false, "score": 0, "creation_date": 1469600308, "post_id": 38603846, "comment_id": 64597167, "body": "@Robert I updated my answer.  Let me know how it works for you."}, {"owner": {"reputation": 5, "user_id": 6577040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee372c9712fe996d9d1ad6c42d55dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6577040/robert"}, "edited": false, "score": 0, "creation_date": 1469605765, "post_id": 38603846, "comment_id": 64600534, "body": "I probably do something wrong. I insert the codes as follow but it doesn&#39;t do anything."}, {"owner": {"reputation": 5, "user_id": 6577040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee372c9712fe996d9d1ad6c42d55dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6577040/robert"}, "edited": false, "score": 0, "creation_date": 1469605855, "post_id": 38603846, "comment_id": 64600593, "body": "Sub FilterRows()     Dim rSource As Range      On Error Resume Next     Set rSource = Intersect(ActiveSheet.UsedRange, Range(&quot;B2:S65536&quot; &amp; Rows.Count)).SpecialCells(xlCellTypeVisible)     On Error GoTo 0      If Not rSource Is Nothing Then          rSource.Copy Destination:=Sheet1.Range(&quot;AA2&quot;)              End If  End Sub"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 5, "user_id": 6577040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee372c9712fe996d9d1ad6c42d55dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6577040/robert"}, "edited": false, "score": 0, "creation_date": 1469606842, "post_id": 38603846, "comment_id": 64601249, "body": "That was a modified snippet from my previous answer that didn&#39;t meet your criteria of coping no more than 160 rows.  My updated should meet all your criteria."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 5, "user_id": 6577040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee372c9712fe996d9d1ad6c42d55dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6577040/robert"}, "edited": false, "score": 0, "creation_date": 1469606932, "post_id": 38603846, "comment_id": 64601299, "body": "<code>Range(&quot;B2:S65536&quot; &amp; Rows.count)</code> is the problem.  Use <code>Range(&quot;B2:S&quot; &amp; Rows.count)</code> instead.  <code>Rows.count</code> will return the correct last row in the worksheet no matter what version on Excel that you use."}, {"owner": {"reputation": 5, "user_id": 6577040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee372c9712fe996d9d1ad6c42d55dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6577040/robert"}, "edited": false, "score": 0, "creation_date": 1469682020, "post_id": 38603846, "comment_id": 64639326, "body": "Thanks Thomas! I copied the codes entirely but it copies rows 2 to 160 with a specified criteria and not the last 160 entries having the specified criteria. Can you still help me? Thanks again"}, {"owner": {"reputation": 5, "user_id": 6577040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee372c9712fe996d9d1ad6c42d55dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6577040/robert"}, "edited": false, "score": 0, "creation_date": 1469760518, "post_id": 38603846, "comment_id": 64681858, "body": "Hi Thomas, I meant to say it only copies the rows with a specific criteria between rows 2 to 160.  Unless I did something wrong, it doesn&#39;t copy the last 160 rows with a specific criteria. Thank again."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 5, "user_id": 6577040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee372c9712fe996d9d1ad6c42d55dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6577040/robert"}, "edited": false, "score": 0, "creation_date": 1469760842, "post_id": 38603846, "comment_id": 64681913, "body": "The confusion comes from it being a filtered table.   I added a criteria clause.  You&#39;ll have to adjust it to fit your needs.  Let me know if you need a clarification."}, {"owner": {"reputation": 5, "user_id": 6577040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee372c9712fe996d9d1ad6c42d55dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6577040/robert"}, "edited": false, "score": 0, "creation_date": 1470046964, "post_id": 38603846, "comment_id": 64771154, "body": "It works great! I modified the criteria to fit my requirements. Thanks you so much Thomas. I have another question for you. If I want to copy the data on Sheet4 instead of sheet1, it doesn&#39;t work. I tried the modify your last line by changing the Sheet number as per the following:         SourceRange.Copy Destination:=Sheet4.Range(&quot;A2&quot;)."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 0, "last_activity_date": 1469760779, "last_edit_date": 1469760779, "creation_date": 1469594351, "answer_id": 38603846, "question_id": 38602995, "link": "https://stackoverflow.com/questions/38602995/range-selection-from-last-160-rows/38603846#38603846", "title": "Range Selection from last 160 rows", "body": "<p>This will copy cells B:S of the last 160 visible rows of data.</p>\n\n<pre><code>Sub CopyLastXNumberVisibleRows()\n    Const MaxRows = 160\n    Dim count As Long, lastRow As Long, x As Long\n    Dim SourceRange As Range\n\n    lastRow = Cells.Find(What:=\"*\", SearchDirection:=xlPrevious, SearchOrder:=xlByRows).Row\n\n    For x = lastRow To 2 Step -1\n        If Not Rows(x).Hidden And Cells(x,\"A\") = \"Some Criteria\" Then\n            count = count + 1\n\n            If SourceRange Is Nothing Then\n                Set SourceRange = Range(Cells(x, \"B\"), Cells(x, \"S\"))\n            Else\n                Set SourceRange = Union(SourceRange, Range(Cells(x, \"B\"), Cells(x, \"S\")))\n            End If\n\n            If count = MaxRows Then Exit For\n        End If\n    Next\n\n    If Not SourceRange Is Nothing Then\n\n        SourceRange.Copy Destination:=Sheet1.Range(\"A2\")\n\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 6577040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee372c9712fe996d9d1ad6c42d55dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6577040/robert"}, "edited": false, "score": 0, "creation_date": 1469670494, "post_id": 38605544, "comment_id": 64636731, "body": "I will try this approach as well, thank you for providing a second option."}], "tags": [], "owner": {"reputation": 164, "user_id": 6642555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577698e5f4d6349809bb9dd3c9af2ea9?s=128&d=identicon&r=PG&f=1", "display_name": "Mak", "link": "https://stackoverflow.com/users/6642555/mak"}, "is_accepted": false, "score": 0, "last_activity_date": 1469602292, "last_edit_date": 1469602292, "creation_date": 1469601806, "answer_id": 38605544, "question_id": 38602995, "link": "https://stackoverflow.com/questions/38602995/range-selection-from-last-160-rows/38605544#38605544", "title": "Range Selection from last 160 rows", "body": "<p>You can think in another way.Just copy all the filtered data to a new sheet,then use a do while loop to delete extra data.</p>\n\n<pre><code>Sub LastRows()\nDim row As Integer\n\nSheets.Add after:=Sheets(Sheets.Count)\nSheets(\"Sheet1\").Cells(1, 1).CurrentRegion.Copy ActiveSheet.Cells(1, 1) \n\nrow = Range(Cells(1, 1), Cells(1, 1).End(xlDown)).Rows.Count\n\nIf row &gt; 161 Then 'including the title\n    Rows(\"2:\" &amp; (row - 160)).Delete\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Please change \"Sheet1\" to your datasheet's name</p>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 6577040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee372c9712fe996d9d1ad6c42d55dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6577040/robert"}, "edited": false, "score": 0, "creation_date": 1469683845, "post_id": 38606424, "comment_id": 64639951, "body": "Thank you User 3598756! Your answer is beyond my knowledge! Should I insert the Function codes in a different macro and copy the codes &quot;FilteredRows(nRowToCopy, dataRng, &quot;B&quot;, &quot;S&quot;).Copy&quot; to my main codes? Do I need to set nRowsToCopy to 160? Do I need to name my table &quot;datarng&quot;? Thanks again"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 5, "user_id": 6577040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee372c9712fe996d9d1ad6c42d55dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6577040/robert"}, "edited": false, "score": 0, "creation_date": 1469685678, "post_id": 38606424, "comment_id": 64640705, "body": "place <code>FilteredRows()</code> in any module. Then in the Sub where you need to get last 160 visible rows range you 1) either define and set a <code>dataRng</code> variable of  <code>Range</code> type (<code>Dim dataRng as Range</code>, <code>Set dataRng = ActiveSheet.Range(&quot;A1:Z&quot; &amp; ActiveSheet.Cells(ActiveSheet.Rows.Count, &quot;A&quot;).End(xlUp).Row)</code>) or feed that range directly in the function call (<code>FilteredRows(nRowsToCopy, ActiveSheet.Range(&quot;A1:Z&quot; &amp; ActiveSheet.Cells(ActiveSheet.Rows.Count, &quot;A&quot;).End(xlUp).Row), &quot;B&quot;, &quot;S&quot;).Copy</code>) 2) you can either define and set <code>nRowsToCopy</code> (<code>Dim nRowsToCopy as Long</code>, <code>nRowsToCopy=160</code>) or feed 160"}, {"owner": {"reputation": 5, "user_id": 6577040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee372c9712fe996d9d1ad6c42d55dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6577040/robert"}, "edited": false, "score": 0, "creation_date": 1469759727, "post_id": 38606424, "comment_id": 64681670, "body": "Thank you again User 3598756!"}, {"owner": {"reputation": 5, "user_id": 6577040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee372c9712fe996d9d1ad6c42d55dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6577040/robert"}, "edited": false, "score": 0, "creation_date": 1469760079, "post_id": 38606424, "comment_id": 64681757, "body": "Thank you again User 3598756!  I did what you said. I receive a message error on the Line (Run-time error 1004: Application-Defined or Object-Define error) &quot; With .Offset(1, .Parent.UsedRange.Columns.count).Resize(.Rows.count - 1, 1).SpecialCells(xlCellTypeVisible).Offset(, .Parent.UsedRange.Columns.count)&quot;. Is it possible a number is missing before the &quot;,&quot; = ....Offset(, .Parent.....?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 5, "user_id": 6577040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee372c9712fe996d9d1ad6c42d55dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6577040/robert"}, "edited": false, "score": 0, "creation_date": 1469767128, "post_id": 38606424, "comment_id": 64683236, "body": "no. a missing number in Offset method stands for 0. Being the offending line after <code>With rng</code> I suspect that you didn&#39;t pass a valid <code>Range</code> object to <code>FilteredRows</code>. Check it. When you meet that error, enter <code>Debug</code> and in the Immediate Window type <code>?rng.Address</code>, press &quot;Return&quot; and see the result"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 5, "user_id": 6577040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee372c9712fe996d9d1ad6c42d55dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6577040/robert"}, "edited": false, "score": 0, "creation_date": 1470136836, "post_id": 38606424, "comment_id": 64814053, "body": "@Robert: did you get through it?"}, {"owner": {"reputation": 5, "user_id": 6577040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee372c9712fe996d9d1ad6c42d55dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6577040/robert"}, "edited": false, "score": 0, "creation_date": 1470269340, "post_id": 38606424, "comment_id": 64884732, "body": "Yes I did, sorry for not coming back earlier. Thank you so much for your help!"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 5, "user_id": 6577040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee372c9712fe996d9d1ad6c42d55dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6577040/robert"}, "edited": false, "score": 0, "creation_date": 1470724525, "post_id": 38606424, "comment_id": 65052300, "body": "@Robert: it&#39;d be nice of you to give feedbacks to people trying helping you"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1469604256, "creation_date": 1469604256, "answer_id": 38606424, "question_id": 38602995, "link": "https://stackoverflow.com/questions/38602995/range-selection-from-last-160-rows/38606424#38606424", "title": "Range Selection from last 160 rows", "body": "<p>you could use such a function:</p>\n\n<pre><code>Function FilteredRows(nRowsToCopy As Long, rng As Range, firstCol As String, lastCol As String) As Range\n    Dim firstRow As Long: firstRow = 2\n\n    With rng\n        With .Offset(1, .Parent.UsedRange.Columns.Count).Resize(.Rows.Count - 1, 1).SpecialCells(xlCellTypeVisible).Offset(, .Parent.UsedRange.Columns.Count)\n            .FormulaR1C1 = \"=max(R1C:R[-1]C)+1\"\n            If WorksheetFunction.Max(.Cells) &gt; nRowsToCopy Then firstRow = .Find(what:=WorksheetFunction.Max(.Cells) - nRowsToCopy + 1, lookat:=xlWhole, LookIn:=xlValues).Row\n            .Clear\n        End With\n        Set FilteredRows = Intersect(.SpecialCells(xlCellTypeVisible), .Parent.Columns(firstCol &amp; \":\" &amp; lastCol), .Parent.Rows(firstRow).Resize(.Rows(.Rows.Count).Row - firstRow + 1))\n    End With\nEnd Function\n</code></pre>\n\n<p>to be exploited in your main code like follows:</p>\n\n<pre><code>FilteredRows(nRowsToCopy, dataRng, \"B\", \"S\").Copy\n</code></pre>\n\n<p>where</p>\n\n<ul>\n<li><code>nRowsToCopy</code> is the (maximum) number of last filtered rows to copy</li>\n<li><code>datarng</code> is the range with all your data (headers included)</li>\n<li><code>\"B\"</code> and <code>\"S\"</code> are the first and last columns to be copied</li>\n</ul>\n"}], "owner": {"reputation": 5, "user_id": 6577040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee372c9712fe996d9d1ad6c42d55dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6577040/robert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 0, "accepted_answer_id": 38603846, "answer_count": 4, "score": 0, "last_activity_date": 1469760779, "creation_date": 1469588559, "last_edit_date": 1469591551, "question_id": 38602995, "link": "https://stackoverflow.com/questions/38602995/range-selection-from-last-160-rows", "title": "Range Selection from last 160 rows", "body": "<p>I have a filtered table from which I want to copy the last 160 entries. My codes to filter the table works fine but the following codes copy the entire 160 rows. I need the last 160 rows from Column B to S. Also, can I select the last filtered 160 rows (previously filtered with a specific criteria) and not the actual last 160 rows? As per example: last 160 rows may contain row numbers from 90 to 100 with an other criteria.</p>\n\n<p>Thanks for your help. My codes are as follow:</p>\n\n<pre><code>Sub FilterRows()\n\nDim LastRow As Long, x As Long\n\nLastRow = Cells.Find(What:=\"*\", SearchDirection:=xlPrevious, SearchOrder:=xlByRows).Row\n\nx = 160\n\nRange(LastRow - x + 1 &amp; \":\" &amp; LastRow).Copy\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "vbscript"], "comments": [{"owner": {"reputation": 145, "user_id": 6594977, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/xxT9K.jpg?s=128&g=1", "display_name": "mulla", "link": "https://stackoverflow.com/users/6594977/mulla"}, "edited": false, "score": 0, "creation_date": 1469591609, "post_id": 38602925, "comment_id": 64594126, "body": "You edit the for loop to do this using iteration count."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 1, "last_activity_date": 1469594833, "creation_date": 1469594833, "answer_id": 38603926, "question_id": 38602925, "link": "https://stackoverflow.com/questions/38602925/running-the-script-in-the-same-tab-and-window/38603926#38603926", "title": "Running the script in the same tab and window", "body": "<pre><code>Const RepeatCount = 10\n\nDim i As Integer\n\nList = Array(\"example.com\")\nSet ie = CreateObject(\"InternetExplorer.Application\")\nie.Visible = True\n\nFor i = 1 To RepeatCount\n\n    For Each URL In List\n        ie.Navigate URL\n        While ie.ReadyState &lt;&gt; 4\n        Wend\n        wscript.sleep 100000\n\n    Next\n\nNext\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 6642516, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/42eaf43022bb42a19dee0e1376b7fd95?s=128&d=identicon&r=PG&f=1", "display_name": "Salta", "link": "https://stackoverflow.com/users/6642516/salta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 38603926, "answer_count": 1, "score": -1, "last_activity_date": 1469594833, "creation_date": 1469588036, "question_id": 38602925, "link": "https://stackoverflow.com/questions/38602925/running-the-script-in-the-same-tab-and-window", "title": "Running the script in the same tab and window", "body": "<p>how to run this script over and over again (For example 10 times) in one window and on the same tab?</p>\n\n<pre><code>list = Array(\"example.com\")\nSet ie = CreateObject(\"InternetExplorer.Application\")\nie.Visible = True\n\n\nFor Each url In list\n  ie.Navigate url\n  While ie.ReadyState &lt;&gt; 4\n  Wend\n  wscript.sleep 100000  \n\nNext \n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23, "user_id": 6642481, "user_type": "registered", "profile_image": "https://graph.facebook.com/854197158018921/picture?type=large", "display_name": "Atom Luo", "link": "https://stackoverflow.com/users/6642481/atom-luo"}, "edited": false, "score": 0, "creation_date": 1469587964, "post_id": 38602881, "comment_id": 64593259, "body": "BTW, when I step into this function or use this in another macro, it actually returns the value to other macros. it&#39;s just I cannot see the print result of my own function in the immediate window"}, {"owner": {"reputation": 23, "user_id": 6642481, "user_type": "registered", "profile_image": "https://graph.facebook.com/854197158018921/picture?type=large", "display_name": "Atom Luo", "link": "https://stackoverflow.com/users/6642481/atom-luo"}, "edited": false, "score": 0, "creation_date": 1469589104, "post_id": 38602881, "comment_id": 64593524, "body": "And apparently, my excel does not recognize my own function coz I cannot find my functions while trying to insert my functions in excel"}, {"owner": {"reputation": 23, "user_id": 6642481, "user_type": "registered", "profile_image": "https://graph.facebook.com/854197158018921/picture?type=large", "display_name": "Atom Luo", "link": "https://stackoverflow.com/users/6642481/atom-luo"}, "edited": false, "score": 0, "creation_date": 1469589725, "post_id": 38602881, "comment_id": 64593668, "body": "Seems like problem solved. This happens if i put my code under the worksheets. If i copy&amp;paste my code into a new module, everything works fine"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1469658730, "post_id": 38602881, "comment_id": 64634104, "body": "User Defined Functions (<b>UDF</b>) that are in a normal module can only be called if it&#39;s loaded, either by AddIn, StartUp files."}], "answers": [{"tags": [], "owner": {"reputation": 32943, "user_id": 765226, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/b0Qnm.jpg?s=128&g=1", "display_name": "Alexis Olson", "link": "https://stackoverflow.com/users/765226/alexis-olson"}, "is_accepted": true, "score": 0, "last_activity_date": 1469592060, "last_edit_date": 1495541883, "creation_date": 1469592060, "answer_id": 38603495, "question_id": 38602881, "link": "https://stackoverflow.com/questions/38602881/excel-vba-immediate-window-produces-a-blank-line-while-testing-my-function-but/38603495#38603495", "title": "Excel VBA immediate window produces a blank line while testing my function, but works normally while testing built-in functions", "body": "<blockquote>\n  <p>This happens if i put my code under the worksheets. If i copy&amp;paste my code into a new module, everything works fine</p>\n</blockquote>\n\n<p>Yes, the code has to be in the proper place in order to reference it from the immediate window.</p>\n\n<p>Please see these other questions for more information regarding where code belongs.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/3255478/put-excel-vba-code-in-module-or-sheet\">Put Excel-VBA code in module or sheet?</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/12955461/what-difference-does-it-make-if-one-runs-a-vba-code-in-sheets-in-thisworkboo\">What difference does it make if one runs a VBA code in `Sheets`, in `ThisWorkbook`, and in `Modules`?</a></p>\n"}], "owner": {"reputation": 23, "user_id": 6642481, "user_type": "registered", "profile_image": "https://graph.facebook.com/854197158018921/picture?type=large", "display_name": "Atom Luo", "link": "https://stackoverflow.com/users/6642481/atom-luo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 380, "favorite_count": 0, "accepted_answer_id": 38603495, "answer_count": 1, "score": 2, "last_activity_date": 1469596597, "creation_date": 1469587594, "last_edit_date": 1469596597, "question_id": 38602881, "link": "https://stackoverflow.com/questions/38602881/excel-vba-immediate-window-produces-a-blank-line-while-testing-my-function-but", "title": "Excel VBA immediate window produces a blank line while testing my function, but works normally while testing built-in functions", "body": "<p>Here is what happened.\nI am just a beginner, and i was watching a tutorial video today. At 2:58, the guy in the video just tested the function and it returned a value.</p>\n\n<p>I did the exact same thing as following:</p>\n\n<pre><code>Function customDate() As String  \n    customDate = Format(Date, \"dddd dd mmmm yyyy\")\nEnd Function\n</code></pre>\n\n<p>And test this in the immediate window with the following command:</p>\n\n<pre><code>?customDate\n</code></pre>\n\n<p>the immediate window produced a blank line.</p>\n\n<p>However, if i do this with a built-in function such as:</p>\n\n<pre><code>?Date\n</code></pre>\n\n<p>it will work and give me a value.</p>\n\n<p>My question is: how do I test my own function in that window.</p>\n"}, {"tags": ["excel", "vba", "loops", "if-statement"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6639079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84d767378b2316c9238f9d67b466b082?s=128&d=identicon&r=PG&f=1", "display_name": "Lina A", "link": "https://stackoverflow.com/users/6639079/lina-a"}, "edited": false, "score": 0, "creation_date": 1469586678, "post_id": 38602465, "comment_id": 64592976, "body": "Thank youx100! Will try this! Yes the top column E I have put some value. Thank you so much"}, {"owner": {"reputation": 3, "user_id": 6639079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84d767378b2316c9238f9d67b466b082?s=128&d=identicon&r=PG&f=1", "display_name": "Lina A", "link": "https://stackoverflow.com/users/6639079/lina-a"}, "edited": false, "score": 0, "creation_date": 1469587393, "post_id": 38602465, "comment_id": 64593113, "body": "Btw, I don&#39;t want the max value between E1:E4, I just need the value above empty cell. As long as it is not zero, then the value above cell is accepted. If that&#39;s the case I just have to delete &#39;MAX(ROW($E$1:$E4)&#39; ?"}, {"owner": {"reputation": 32943, "user_id": 765226, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/b0Qnm.jpg?s=128&g=1", "display_name": "Alexis Olson", "link": "https://stackoverflow.com/users/765226/alexis-olson"}, "reply_to_user": {"reputation": 3, "user_id": 6639079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84d767378b2316c9238f9d67b466b082?s=128&d=identicon&r=PG&f=1", "display_name": "Lina A", "link": "https://stackoverflow.com/users/6639079/lina-a"}, "edited": false, "score": 0, "creation_date": 1469589625, "post_id": 38602465, "comment_id": 64593654, "body": "It&#39;s not finding the max value, it&#39;s finding the value in the max <b>row</b> that is non-blank, that is the last non-blank value in that column."}, {"owner": {"reputation": 3, "user_id": 6639079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84d767378b2316c9238f9d67b466b082?s=128&d=identicon&r=PG&f=1", "display_name": "Lina A", "link": "https://stackoverflow.com/users/6639079/lina-a"}, "edited": false, "score": 0, "creation_date": 1469601752, "post_id": 38602465, "comment_id": 64597959, "body": "Oh I see. Thanks a lot! I got it now! You have been a great help!!"}], "tags": [], "owner": {"reputation": 32943, "user_id": 765226, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/b0Qnm.jpg?s=128&g=1", "display_name": "Alexis Olson", "link": "https://stackoverflow.com/users/765226/alexis-olson"}, "is_accepted": true, "score": 2, "last_activity_date": 1469584439, "creation_date": 1469584439, "answer_id": 38602465, "question_id": 38602301, "link": "https://stackoverflow.com/questions/38602301/vba-loop-one-cell-upward-until-cell-not-equal-and-a-cell-incorporate-two-if-f/38602465#38602465", "title": "VBA loop one cell upward until cell not equal &quot;&quot; and a cell incorporate two IF functions", "body": "<p>I think you can do this without using VBA. You can use the following to get the previous non-blank value in column E:</p>\n\n<pre><code>E5=INDEX($E:$E,MAX(ROW($E$1:$E4)*(LEN($E$1:$E4)&gt;0)))\n</code></pre>\n\n<p>This formula looks in column E above cell E5 (i.e. E1:E4) and returns the one cell with the largest row value that is also not blank (length > 0).</p>\n\n<p>From there, your whole formula becomes:</p>\n\n<pre><code>E5=IF($B5=\"S\",\"\",IF($B5=\"F\",($D5*INDEX($E:$E,MAX(ROW($E$1:$E4)*(LEN($E$1:$E4)&gt;0)))+($K$1+1))/($D5+1)))\n</code></pre>\n\n<p>Note that these are array formulas, so they must be validated using Ctrl+Shift+Enter. Also, the top non-blank value in column E has to be input manually or with a different formula.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 6639079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84d767378b2316c9238f9d67b466b082?s=128&d=identicon&r=PG&f=1", "display_name": "Lina A", "link": "https://stackoverflow.com/users/6639079/lina-a"}, "edited": false, "score": 0, "creation_date": 1469594513, "post_id": 38603326, "comment_id": 64594914, "body": "Oh I&#39;m really sorry for unclear description. First column in E when B=F is equal to 1. No of failure is in cell K1, which is input by user. Thank you so much for answering! Help me a lot!!"}, {"owner": {"reputation": 3, "user_id": 6639079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84d767378b2316c9238f9d67b466b082?s=128&d=identicon&r=PG&f=1", "display_name": "Lina A", "link": "https://stackoverflow.com/users/6639079/lina-a"}, "edited": false, "score": 0, "creation_date": 1469595874, "post_id": 38603326, "comment_id": 64595336, "body": "Thank you everyone who helps me! I already got the answer!! Thanks so much!! This is an awesome community!"}], "tags": [], "owner": {"reputation": 164, "user_id": 6642555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577698e5f4d6349809bb9dd3c9af2ea9?s=128&d=identicon&r=PG&f=1", "display_name": "Mak", "link": "https://stackoverflow.com/users/6642555/mak"}, "is_accepted": false, "score": 0, "last_activity_date": 1469695529, "last_edit_date": 1469695529, "creation_date": 1469590860, "answer_id": 38603326, "question_id": 38602301, "link": "https://stackoverflow.com/questions/38602301/vba-loop-one-cell-upward-until-cell-not-equal-and-a-cell-incorporate-two-if-f/38603326#38603326", "title": "VBA loop one cell upward until cell not equal &quot;&quot; and a cell incorporate two IF functions", "body": "<ol>\n<li>What's the first value in column E when you meet the first \"F\" in\ncolumn B? I mean, there is nothing in column E, what is the \"PREVIOUS Adjusted Rank\". In this case, I just set it 0.</li>\n<li>What's  \"no of failure\"?</li>\n</ol>\n\n<p>Here is my solution for you and I set \"no of failure\" as zero.</p>\n\n<pre><code>Sub test()\nDim i, j As Integer\nDim previous As Single\nDim NoOfFailure As Single\nFor i = 2 To Cells.CurrentRegion.Rows.Count\n    If Cells(i, 2).Value = \"S\" Then\n        Cells(i, 5).Value = \"\"\n    ElseIf Cells(i, 2).Value = \"F\" Then\n        previous = 0\n        NoOfFailure = 0\n        For j = i To 2 Step -1\n            If Cells(j, 5).Value &lt;&gt; \"\" Then\n                previous = Cells(j, 5).Value\n                Exit For\n            End If\n        Next\n        Cells(i, 5).Value = (Cells(i, 4).Value * previous + NoOfFailure + 1) / (Cells(i, 4).Value + 1)\n    End If\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6639079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84d767378b2316c9238f9d67b466b082?s=128&d=identicon&r=PG&f=1", "display_name": "Lina A", "link": "https://stackoverflow.com/users/6639079/lina-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 537, "favorite_count": 0, "accepted_answer_id": 38602465, "answer_count": 2, "score": 0, "last_activity_date": 1469695529, "creation_date": 1469583009, "last_edit_date": 1469695487, "question_id": 38602301, "link": "https://stackoverflow.com/questions/38602301/vba-loop-one-cell-upward-until-cell-not-equal-and-a-cell-incorporate-two-if-f", "title": "VBA loop one cell upward until cell not equal &quot;&quot; and a cell incorporate two IF functions", "body": "<p>I'm totally new to VBA, am learning it by myself. Here is the problem:</p>\n\n<p><a href=\"http://i.stack.imgur.com/IbSOW.png\" rel=\"nofollow\">enter image description here</a></p>\n\n<p>So for Column E\nIf B = \"S\" Then\nE = \"\"  // null</p>\n\n<p>If B = \"F\" Then\nE = (Reverse Rank x <strong>PREVIOUS</strong> Adjusted Rank + no of failure + 1)/(Reverse Rank + 1)</p>\n\n<p>or in formula excel format</p>\n\n<p>E5 = ((D5*E4)+($K$1+1))/(D5+1)</p>\n\n<p>So the problem lies on the PREVIOUS adjusted rank in the formula. Say, to get value of E5 it needs value of E4 BUT if E4 = \"\" so it has to go one cell upward. If one cell upward is also =\"\", it has to go one cell upward again until is not equal &lt;> \"\".</p>\n\n<p>The problem is I'm not sure what function is right to use. I think it would be IF and LOOP but I don't understand how to write the condition. Like I said I'm totally new and time constraints cause me anxiety.  Also, if you notice, for Column E there are two IFs function I suppose? One is E is depended on Column B.</p>\n\n<p>If Range(\"B2:B\" &amp; lastRow) = \"S\" or \"F\" and one is if E=\"\" or &lt;> \"\"</p>\n\n<p>How I incorporated with that?</p>\n"}, {"tags": ["vba", "excel", "duplicates", "row"], "comments": [{"owner": {"reputation": 11, "user_id": 6569421, "user_type": "registered", "profile_image": "https://graph.facebook.com/1115383201852760/picture?type=large", "display_name": "Hugo Rafael", "link": "https://stackoverflow.com/users/6569421/hugo-rafael"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1469578990, "post_id": 38601806, "comment_id": 64591388, "body": "VBA. If it is possible"}, {"owner": {"reputation": 11, "user_id": 6569421, "user_type": "registered", "profile_image": "https://graph.facebook.com/1115383201852760/picture?type=large", "display_name": "Hugo Rafael", "link": "https://stackoverflow.com/users/6569421/hugo-rafael"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1469579852, "post_id": 38601806, "comment_id": 64591590, "body": "I added my code in the question. I don&#39;t know much of vba, so i need some help to modify the code, so it can do like the exemple showed"}, {"owner": {"reputation": 11, "user_id": 6569421, "user_type": "registered", "profile_image": "https://graph.facebook.com/1115383201852760/picture?type=large", "display_name": "Hugo Rafael", "link": "https://stackoverflow.com/users/6569421/hugo-rafael"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1469580265, "post_id": 38601806, "comment_id": 64591675, "body": "The code stops when it find the 1st duplicate. I don&#39;t know exactly how to do the loop"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1469583121, "post_id": 38601806, "comment_id": 64592246, "body": "(a) What needs to happen when there is a &quot;collision&quot;, e.g. the first row for &quot;142&quot; contains a value of 23 in column B, so what happens if the second row for &quot;142&quot; contained a value of 12 in column B?  (b) Do you need to copy the complete cell (i.e. values, formatting, colours, borders, etc, etc) or just copy the value of the cell?"}, {"owner": {"reputation": 11, "user_id": 6569421, "user_type": "registered", "profile_image": "https://graph.facebook.com/1115383201852760/picture?type=large", "display_name": "Hugo Rafael", "link": "https://stackoverflow.com/users/6569421/hugo-rafael"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1469586607, "post_id": 38601806, "comment_id": 64592961, "body": "@YowE3k a) in case of collision it can be the 2 values. Like &quot;23; 12&quot;. But maybe i will think of some msgbox to pop. b)Just the value"}], "owner": {"reputation": 11, "user_id": 6569421, "user_type": "registered", "profile_image": "https://graph.facebook.com/1115383201852760/picture?type=large", "display_name": "Hugo Rafael", "link": "https://stackoverflow.com/users/6569421/hugo-rafael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "closed_date": 1469581474, "answer_count": 0, "score": 0, "last_activity_date": 1469587398, "creation_date": 1469578436, "last_edit_date": 1469587398, "question_id": 38601806, "link": "https://stackoverflow.com/questions/38601806/excel-vba-how-to-unify-rows", "closed_reason": "Duplicate", "title": "Excel VBA - How to Unify Rows", "body": "<p>I really need some help. I have A wotkbook based on a variable called \"g/c\". The g/c is located in the column \"A\". There are some duplicated g/c in the worksheet, but with diferent data. I need to unify the in oly one row with all the data. Look at this exemple:</p>\n\n<pre><code> A    B   C   D   E   F   G   H   I   J   K   L   M  \nG/c_______________________________________________\n142|  23          4       5           6\n412|\n556|      2           2            5\n263|  6        6                              6    7\n111|                          9\n142|      5    6\n</code></pre>\n\n<p>The g/c \"142\" apear in two diferent rows and with different datas. I need a code that can do this:</p>\n\n<pre><code>  A    B   C   D   E   F   G   H   I   J   K   L   M  \nG/c__________________________________________________\n142|  23   5   6   4       5           6\n412|\n556|      2           2            5\n263|   6        6                              6    7\n111|                          9\n</code></pre>\n\n<p>The code need to delete one of the rows with the duplicated g/c (142 in this case) and combine the datas from the diferent rows (23,5,6,4,5,6). I don't need them to merge in the same cell. The numbers 5 and 6 (columns C and D) don't apear on hthe first g/c=142, the same way as 23 don't apear in the second g/c=142. By i need a row with all these values.</p>\n\n<p>I have some code:</p>\n\n<pre><code>  'Deletando duplicatas\n    ' Get count of records to search through.\n    iListCount = Sheets(\"Autom\u00f3veis\").Range(\"A1:A10000\").Rows.Count\n    Sheets(\"Autom\u00f3veis\").Range(\"A3\").Select\n    ' Loop until end of records.\n    Do Until ActiveCell = \"\"\n       ' Loop through records.\n       For iCtr = 1 To 200\n\n          ' Don't compare against yourself.\n          ' To specify a different column, change 1 to the column number.\n          If ActiveCell.Row &lt;&gt; Sheets(\"Autom\u00f3veis\").Cells(iCtr, 1).Row Then\n             ' Do comparison of next record.\n             If ActiveCell.Value = Sheets(\"Autom\u00f3veis\").Cells(iCtr, 1).Value Then\n                ' If match is true then copy the data.\n\n                      If Cells(iCtr, \"AC\") &lt;&gt; \"\" Then\n                        Cells(iCtr, \"AC\").Copy\n                        Cells(ActiveCell.Row, \"AC\").PasteSpecial\n\n                    'Increment counter to account for deleted row.\n                        End If\n                   iCtr = iCtr + 1\n             End If\n          End If\n       Next iCtr\n       ' Go to next record.\n       ActiveCell.Offset(1, 0).Select\n    Loop\n    Application.ScreenUpdating = True\n</code></pre>\n\n<p>I need to modify it to do like in the previous example. </p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 9620, "user_id": 1783163, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/BfUwH.jpg?s=128&g=1", "display_name": "peterh", "link": "https://stackoverflow.com/users/1783163/peterh"}, "edited": false, "score": 0, "creation_date": 1469764930, "post_id": 38601759, "comment_id": 64682790, "body": "Your question is quite unclear, maybe a little bit of finetuning in <a href=\"http://meta.stackoverflow.com/questions/291362/advice-for-non-native-english-speakers/291370#291370\">these</a> could help."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 6642160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-BjYm9QFejyM/AAAAAAAAAAI/AAAAAAAAABE/3kVLBEX1Bes/photo.jpg?sz=128", "display_name": "Abdel Seaf", "link": "https://stackoverflow.com/users/6642160/abdel-seaf"}, "is_accepted": true, "score": -1, "last_activity_date": 1469585690, "creation_date": 1469585690, "answer_id": 38602624, "question_id": 38601759, "link": "https://stackoverflow.com/questions/38601759/i-get-error-when-using-lstbox-in-skype-bot-code-using-skypecom4lib/38602624#38602624", "title": "I get error when using &quot;lstbox&quot; in Skype Bot code using SKYPECOM4lib", "body": "<p>I figured it out. Change it to ListBox1</p>\n"}], "owner": {"reputation": 31, "user_id": 6642160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-BjYm9QFejyM/AAAAAAAAAAI/AAAAAAAAABE/3kVLBEX1Bes/photo.jpg?sz=128", "display_name": "Abdel Seaf", "link": "https://stackoverflow.com/users/6642160/abdel-seaf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 38602624, "answer_count": 1, "score": -1, "last_activity_date": 1469764948, "creation_date": 1469578049, "last_edit_date": 1469764948, "question_id": 38601759, "link": "https://stackoverflow.com/questions/38601759/i-get-error-when-using-lstbox-in-skype-bot-code-using-skypecom4lib", "title": "I get error when using &quot;lstbox&quot; in Skype Bot code using SKYPECOM4lib", "body": "<p>When I use lstbox in VBA code for a skype bot using skype api lib and stuff I get this error. Also I saw a youtuber use it <a href=\"https://www.youtube.com/watch?v=ahkuYT7-wdU\" rel=\"nofollow\">here</a> and im using the same lib as him and same code.</p>\n\n<p><a href=\"https://i.gyazo.com/a0a08ea6af82ac10e98ba03f4c1142b6.png\" rel=\"nofollow\">Code with error</a></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 85, "user_id": 6520017, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/6b9dc53195f313e49b052444921e34a6?s=128&d=identicon&r=PG&f=1", "display_name": "Devin Roberts", "link": "https://stackoverflow.com/users/6520017/devin-roberts"}, "is_accepted": false, "score": 0, "last_activity_date": 1469576792, "creation_date": 1469576792, "answer_id": 38601594, "question_id": 38601034, "link": "https://stackoverflow.com/questions/38601034/insert-new-row-after-last-used-row-and-copy-formula-and-format-from-above/38601594#38601594", "title": "Insert new row after last used row and copy formula and format from above", "body": "<p>You just need to create variables to find the last and first empty rows and use that instead:</p>\n\n<pre><code>Sub AddNewRow()\n\n\n' AddNewRow Macro\n\nDim LastRw As Long, EmptyRw As Long\n\nEmptyRw = WorksheetFunction.CountA(Range(\"F:F\")) + 1\nLastRw = WorksheetFunction.CountA(Range(\"F:F\"))\n\nCells(EmptyRw, 6).Select\nActiveSheet.Unprotect\nSelection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\nCells(LastRw, 6).Select\nSelection.AutoFill Destination:=Range(Cells(LastRw, 6), Cells(EmptyRw, 6)), Type:=xlFillDefault\nActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _\n    , AllowFormattingCells:=True, AllowDeletingRows:=True, AllowSorting:=True _\n    , AllowFiltering:=True\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 6642001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82b05844f151aa56dc86b3287ae493f4?s=128&d=identicon&r=PG&f=1", "display_name": "Jane Wilson", "link": "https://stackoverflow.com/users/6642001/jane-wilson"}, "edited": false, "score": 0, "creation_date": 1469639803, "post_id": 38601732, "comment_id": 64624443, "body": "Thank you so much - this is so helpful!  One little hiccup I can&#39;t figure out - I have a calendar adjacent to the range that I would like to copy the conditional formatting for when the new row is inserted.  Basically the new row (with the  above code) copies everything up to H but I need it to also copy I to AM (I is a blank column with one bottom border and J-AM contain a calendar with conditional formatting).  Any help would be really appreciated."}, {"owner": {"reputation": 191, "user_id": 5149107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbf2d7652f551f5c58c3005cb880f39f?s=128&d=identicon&r=PG&f=1", "display_name": "hughg", "link": "https://stackoverflow.com/users/5149107/hughg"}, "reply_to_user": {"reputation": 11, "user_id": 6642001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82b05844f151aa56dc86b3287ae493f4?s=128&d=identicon&r=PG&f=1", "display_name": "Jane Wilson", "link": "https://stackoverflow.com/users/6642001/jane-wilson"}, "edited": false, "score": 0, "creation_date": 1469758297, "post_id": 38601732, "comment_id": 64681346, "body": "You can slip in a <code>.EntireRow</code> in there to fill down the whole row: <code>ActiveSheet.Range(&quot;A1&quot;).CurrentRegion.Offset(ActiveSheet.Ran&zwnj;&#8203;ge(&quot;A1&quot;).CurrentRegi&zwnj;&#8203;on.Rows.Count - 1).Resize(2).EntireRow.FillDown</code>"}], "tags": [], "owner": {"reputation": 191, "user_id": 5149107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbf2d7652f551f5c58c3005cb880f39f?s=128&d=identicon&r=PG&f=1", "display_name": "hughg", "link": "https://stackoverflow.com/users/5149107/hughg"}, "is_accepted": false, "score": 0, "last_activity_date": 1469577827, "creation_date": 1469577827, "answer_id": 38601732, "question_id": 38601034, "link": "https://stackoverflow.com/questions/38601034/insert-new-row-after-last-used-row-and-copy-formula-and-format-from-above/38601732#38601732", "title": "Insert new row after last used row and copy formula and format from above", "body": "<p>Could use the <code>CurrentRegion</code> to find last row and fill down from there...</p>\n\n<pre><code>Sub AddNewRow()\n\nActiveSheet.Unprotect\nActiveSheet.Range(\"A1\").CurrentRegion.Offset(ActiveSheet.Range(\"A1\").CurrentRegion.Rows.Count - 1).Resize(2).FillDown\nActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _\n    , AllowFormattingCells:=True, AllowDeletingRows:=True, AllowSorting:=True _\n    , AllowFiltering:=True\n\nEnd Sub\n</code></pre>\n\n<p>Would need to change the <code>Range(\"A1\")</code> if worksheet contents does not start in or next to cell <code>A1</code></p>\n"}], "owner": {"reputation": 11, "user_id": 6642001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82b05844f151aa56dc86b3287ae493f4?s=128&d=identicon&r=PG&f=1", "display_name": "Jane Wilson", "link": "https://stackoverflow.com/users/6642001/jane-wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3138, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1469577827, "creation_date": 1469573035, "question_id": 38601034, "link": "https://stackoverflow.com/questions/38601034/insert-new-row-after-last-used-row-and-copy-formula-and-format-from-above", "title": "Insert new row after last used row and copy formula and format from above", "body": "<p>I want a macro that will find the last row with data, then insert a new row beneath and copy the format and formula from above (formula is in column F).  The code I have inserts a new row in the same spot each time.  Is this possible?</p>\n\n<p>Here's what I have:</p>\n\n<pre><code>    Sub AddNewRow()\n'\n' AddNewRow Macro\n'\n\n'\n    Rows(\"37:37\").Select\n    ActiveSheet.Unprotect\n    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n    Range(\"F36\").Select\n    Selection.AutoFill Destination:=Range(\"F36:F37\"), Type:=xlFillDefault\n    Range(\"F36:F37\").Select\n    ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _\n        , AllowFormattingCells:=True, AllowDeletingRows:=True, AllowSorting:=True _\n        , AllowFiltering:=True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1469572604, "post_id": 38600863, "comment_id": 64589663, "body": "<code>With</code> isn&#39;t a looping structure. I&#39;m guessing you need a <a href=\"http://stackoverflow.com/documentation/vba/1873/flow-control-structures/8169/for-loop\">For loop</a>."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 1, "user_id": 4293546, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mCDlFzmFz3g/AAAAAAAAAAI/AAAAAAAABuI/2oxjCETjVYA/photo.jpg?sz=128", "display_name": "JD Stewart", "link": "https://stackoverflow.com/users/4293546/jd-stewart"}, "edited": false, "score": 0, "creation_date": 1469579508, "post_id": 38601008, "comment_id": 64591507, "body": "What&#39;s the last used row in Column A?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 1, "user_id": 4293546, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mCDlFzmFz3g/AAAAAAAAAAI/AAAAAAAABuI/2oxjCETjVYA/photo.jpg?sz=128", "display_name": "JD Stewart", "link": "https://stackoverflow.com/users/4293546/jd-stewart"}, "edited": false, "score": 0, "creation_date": 1469579795, "post_id": 38601008, "comment_id": 64591581, "body": "@JDStewart I modified the code to append a record to <code>Worksheets(&quot;fieldData&quot;)</code> every time <code>cmdAccept</code> is clicked."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1469579648, "last_edit_date": 1469579648, "creation_date": 1469572890, "answer_id": 38601008, "question_id": 38600863, "link": "https://stackoverflow.com/questions/38600863/my-formulas-work-but-do-not-refer-to-the-row-being-worked-on-in-my-with-loop/38601008#38601008", "title": "My formulas work, but do not refer to the row being worked on in my With loop", "body": "<p>Let me know how this works for you.</p>\n\n<pre><code>Private Sub cmdAccept_Click()\n\n    Dim x As Long\n    Dim fieldData As Worksheet\n\n    With Worksheets(\"fieldData\")\n        x = .Range(\"A\" &amp; Rows.Count).End(xlUp).row + 1\n        .Cells(x, 1).Value = Me.txtBox_fieldData_dateDelivered.Value\n        .Cells(x, 2).Value = Me.comboBox_fieldData_fieldName.Value\n        .Cells(x, 3).Value = Me.txtBox_fieldData_acres.Value\n        .Cells(x, 4).Value = Me.comboBox_fieldData_crop.Value\n        .Cells(x, 5).Value = Me.txtBox_fieldData_product1.Value\n        .Cells(x, 6).Value = Me.txtBox_fieldData_product2.Value\n        .Cells(x, 7).Value = Me.txtBox_fieldData_product3.Value\n        .Cells(x, 8).Value = Me.txtBox_fieldData_product4.Value\n        .Cells(x, 9).Value = Me.txtBox_fieldData_product5.Value\n        .Cells(x, 10).Value = Me.txtBox_fieldData_product6.Value\n        .Cells(x, 11).Value = \"=Range($E2:$J2)\"\n        .Cells(x, 12).Value = \"=SUM((11.06*$E2)+(11.7*$F2)+(11.04*$G\" &amp; x &amp; \")+(10.9*$H\" &amp; x &amp; \")+(10.28*$I2)+(9.5*$J2)\"\n        .Cells(x, 13).Value = \"=SUM(((11.06*$E2)*(32/100)/$C\" &amp; x &amp; \")+((11.7*$F2)*(10/100)/$C\" &amp; x &amp; \")+((11.04*$G\" &amp; x &amp; \")*(12/100)/$C\" &amp; x &amp; \")+((10.9*$H\" &amp; x &amp; \")*(8/100)/$C\" &amp; x &amp; \")+((10.28*$I2)*(7/100)/$C\" &amp; x &amp; \")+((9.5*$J2)*(0/100)/$C\" &amp; x &amp; \"))\"\n        .Cells(x, 14).Value = \"=SUM(((11.06*$E2)*(0/100)/$C\" &amp; x &amp; \")+((11.7*$F2)*(34/100)/$C\" &amp; x &amp; \")+((11.04*$G\" &amp; x &amp; \")*(0/100)/$C\" &amp; x &amp; \")+((10.9*$H\" &amp; x &amp; \")*(25/100)/$C\" &amp; x &amp; \")+((10.28*$I2)*(24/100)/$C\" &amp; x &amp; \")+((9.5*$J2)*(0/100)/$C\" &amp; x &amp; \"))\"\n        .Cells(x, 15).Value = \"=SUM(((11.06*$E2)*(0/100)/$C\" &amp; x &amp; \")+((11.7*$F2)*(0/100)/$C\" &amp; x &amp; \")+((11.04*$G\" &amp; x &amp; \")*(0/100)/$C\" &amp; x &amp; \")+((10.9*$H\" &amp; x &amp; \")*(0/100)/$C\" &amp; x &amp; \")+((10.28*$2I)*(0/100)/$C\" &amp; x &amp; \")+((9.5*$J2)*(0/100)/$C\" &amp; x &amp; \"))\"\n        .Cells(x, 16).Value = \"=SUM(((11.06*$E2)*(0/100)/$C\" &amp; x &amp; \")+((11.7*$F2)*(0/100)/$C\" &amp; x &amp; \")+((11.04*$G\" &amp; x &amp; \")*(26/100)/$C\" &amp; x &amp; \")+((10.9*$H\" &amp; x &amp; \")*(0/100)/$C\" &amp; x &amp; \")+((10.28*$I2)*(0/100)/$C\" &amp; x &amp; \")+((9.5*$J2)*(0/100)/$C\" &amp; x &amp; \"))\"\n\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4293546, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mCDlFzmFz3g/AAAAAAAAAAI/AAAAAAAABuI/2oxjCETjVYA/photo.jpg?sz=128", "display_name": "JD Stewart", "link": "https://stackoverflow.com/users/4293546/jd-stewart"}, "is_accepted": false, "score": 0, "last_activity_date": 1469629233, "creation_date": 1469629233, "answer_id": 38615656, "question_id": 38600863, "link": "https://stackoverflow.com/questions/38600863/my-formulas-work-but-do-not-refer-to-the-row-being-worked-on-in-my-with-loop/38615656#38615656", "title": "My formulas work, but do not refer to the row being worked on in my With loop", "body": "<p>Thank you, Thomas, SO much for opening my eyes to other methods of coding!!! This is the code I used making the formulas work...</p>\n\n<pre><code>Private Sub cmdAccept_Click()\nDim RowCount As Long\nDim fieldData As Worksheet\nSet fieldData = Worksheets(\"fieldData\")\n\nRowCount = fieldData.Range(\"A1\").CurrentRegion.Rows.Count + 1\nWith fieldData\n    .Cells(RowCount, 1).Value = Me.txtBox_fieldData_dateDelivered.Value\n    .Cells(RowCount, 2).Value = Me.comboBox_fieldData_fieldName.Value\n    .Cells(RowCount, 3).Value = Me.txtBox_fieldData_acres.Value\n    .Cells(RowCount, 4).Value = Me.comboBox_fieldData_crop.Value\n    .Cells(RowCount, 5).Value = Me.txtBox_fieldData_product1.Value\n    .Cells(RowCount, 6).Value = Me.txtBox_fieldData_product2.Value\n    .Cells(RowCount, 7).Value = Me.txtBox_fieldData_product3.Value\n    .Cells(RowCount, 8).Value = Me.txtBox_fieldData_product4.Value\n    .Cells(RowCount, 9).Value = Me.txtBox_fieldData_product5.Value\n    .Cells(RowCount, 10).Value = Me.txtBox_fieldData_product6.Value\n    .Range(\"K\" &amp; RowCount - 1 &amp; \":P\" &amp; RowCount).FillDown\nEnd With\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 1, "user_id": 4293546, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mCDlFzmFz3g/AAAAAAAAAAI/AAAAAAAABuI/2oxjCETjVYA/photo.jpg?sz=128", "display_name": "JD Stewart", "link": "https://stackoverflow.com/users/4293546/jd-stewart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1469629233, "creation_date": 1469572015, "last_edit_date": 1469572406, "question_id": 38600863, "link": "https://stackoverflow.com/questions/38600863/my-formulas-work-but-do-not-refer-to-the-row-being-worked-on-in-my-with-loop", "title": "My formulas work, but do not refer to the row being worked on in my With loop", "body": "<p>Using a UserForm in Excel VBA, I cannot seem to make my formula section to refer to cells on the current row being used in my code. I do not want it to only refer to row 2 data. Row 1 is a header row.</p>\n\n<p>How can I do this?</p>\n\n<pre><code>Private Sub cmdAccept_Click()\n\nDim lastrow As Long\nDim RowCount As Long\nDim fieldData As Worksheet\n    lastrow = Range(\"A65536\").End(xlUp).Row\n\nRowCount = Worksheets(\"fieldData\").Range(\"A1\").CurrentRegion.Rows.Count\nWith Worksheets(\"fieldData\").Range(\"A1\")\n    .Offset(RowCount, 0).Value = Me.txtBox_fieldData_dateDelivered.Value\n    .Offset(RowCount, 1).Value = Me.comboBox_fieldData_fieldName.Value\n    .Offset(RowCount, 2).Value = Me.txtBox_fieldData_acres.Value\n    .Offset(RowCount, 3).Value = Me.comboBox_fieldData_crop.Value\n    .Offset(RowCount, 4).Value = Me.txtBox_fieldData_product1.Value\n    .Offset(RowCount, 5).Value = Me.txtBox_fieldData_product2.Value\n    .Offset(RowCount, 6).Value = Me.txtBox_fieldData_product3.Value\n    .Offset(RowCount, 7).Value = Me.txtBox_fieldData_product4.Value\n    .Offset(RowCount, 8).Value = Me.txtBox_fieldData_product5.Value\n    .Offset(RowCount, 9).Value = Me.txtBox_fieldData_product6.Value\n    .Offset(RowCount, 10).Value = \"=Range($E2:$J2)\"\n    .Offset(RowCount, 11).Value = \"=SUM((11.06*$E2)+(11.7*$F2)+(11.04*$G2)+(10.9*$H2)+(10.28*$I2)+(9.5*$J2)\"\n    .Offset(RowCount, 12).Value = \"=SUM(((11.06*$E2)*(32/100)/$C2)+((11.7*$F2)*(10/100)/$C2)+((11.04*$G2)*(12/100)/$C2)+((10.9*$H2)*(8/100)/$C2)+((10.28*$I2)*(7/100)/$C2)+((9.5*$J2)*(0/100)/$C2))\"\n    .Offset(RowCount, 13).Value = \"=SUM(((11.06*$E2)*(0/100)/$C2)+((11.7*$F2)*(34/100)/$C2)+((11.04*$G2)*(0/100)/$C2)+((10.9*$H2)*(25/100)/$C2)+((10.28*$I2)*(24/100)/$C2)+((9.5*$J2)*(0/100)/$C2))\"\n    .Offset(RowCount, 14).Value = \"=SUM(((11.06*$E2)*(0/100)/$C2)+((11.7*$F2)*(0/100)/$C2)+((11.04*$G2)*(0/100)/$C2)+((10.9*$H2)*(0/100)/$C2)+((10.28*$2I)*(0/100)/$C2)+((9.5*$J2)*(0/100)/$C2))\"\n    .Offset(RowCount, 15).Value = \"=SUM(((11.06*$E2)*(0/100)/$C2)+((11.7*$F2)*(0/100)/$C2)+((11.04*$G2)*(26/100)/$C2)+((10.9*$H2)*(0/100)/$C2)+((10.28*$I2)*(0/100)/$C2)+((9.5*$J2)*(0/100)/$C2))\"\nEnd With\nEnd Sub\n</code></pre>\n\n<p>The user will input specific data into the UserForm, which will fill columns 1 thru column 10, click on an \"Accept Data\", then the formulas should run and the results be placed in the same row from column K thru column P. Once complete, the user will continue to input data, until they press the \"Close\" CommandButton. </p>\n"}, {"tags": ["vba", "date"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1469570960, "post_id": 38600603, "comment_id": 64589111, "body": "Nope, Excel doesn&#39;t know every holiday in every corner of the world - you have to supply it."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1469570978, "post_id": 38600603, "comment_id": 64589119, "body": "Whose holidays? US, UK, CANADA. if the US which state?  I hope the point is being made."}], "answers": [{"tags": [], "owner": {"reputation": 1575, "user_id": 6375663, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1OIBqfD_lZs/AAAAAAAAAAI/AAAAAAAAAZE/XSRY_hZ_fUk/photo.jpg?sz=128", "display_name": "Mike", "link": "https://stackoverflow.com/users/6375663/mike"}, "is_accepted": true, "score": 0, "last_activity_date": 1469634761, "last_edit_date": 1469634761, "creation_date": 1469570918, "answer_id": 38600662, "question_id": 38600603, "link": "https://stackoverflow.com/questions/38600603/vba-next-business-day-including-holiday/38600662#38600662", "title": "Vba Next Business Day Including holiday", "body": "<p>Unless you provide a list of holidays, you won't be able to calculate the next working date. Remember the rules for Easter involve the phase of the moon! So this is not a simple task. </p>\n\n<p>That is before you start to consider which different countries. Even if you restrict yourself to the US holidays, it takes a fair bit of calculations just to get the 3rd Thursday in November etc</p>\n\n<p>Here is a demonstration of how you could calculate the next working day. \nI wouldn't hold just the holidays but every date in the calendar. Note for Easter I have fudged the holiday column to get the correct next working day answer.</p>\n\n<p>You could miss a few steps in the calculation, I left them in for clarity.</p>\n\n<p><a href=\"https://i.stack.imgur.com/3hQh8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3hQh8.png\" alt=\"Excel demo\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 50, "user_id": 6529575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2940331d8a347135a34a94bb3a7c98d6?s=128&d=identicon&r=PG&f=1", "display_name": "Y H", "link": "https://stackoverflow.com/users/6529575/y-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1469635115, "creation_date": 1469635115, "answer_id": 38617964, "question_id": 38600603, "link": "https://stackoverflow.com/questions/38600603/vba-next-business-day-including-holiday/38617964#38617964", "title": "Vba Next Business Day Including holiday", "body": "<p>Use the =WORKDAY() function. You'll have to specify a range of holidays as the third parameter.</p>\n"}], "owner": {"reputation": 31, "user_id": 6471090, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a35ed29ae469ea6d5176f2578dc3e04?s=128&d=identicon&r=PG&f=1", "display_name": "mdmlll", "link": "https://stackoverflow.com/users/6471090/mdmlll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 982, "favorite_count": 0, "accepted_answer_id": 38600662, "answer_count": 2, "score": 1, "last_activity_date": 1469635115, "creation_date": 1469570594, "last_edit_date": 1469625183, "question_id": 38600603, "link": "https://stackoverflow.com/questions/38600603/vba-next-business-day-including-holiday", "title": "Vba Next Business Day Including holiday", "body": "<p>I want to have a function to return the next business day of the date that is sent in as parameter. \nWeekends and Canadian holidays should be included.\nWhat is the easiest way to do this ? Is it possible to do this without setting a reference to a range of cells for the holidays' dates? </p>\n"}, {"tags": ["excel", "excel-2016", "vba"], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 6241632, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/74d23fcd7775f20dba819eb06f248a23?s=128&d=identicon&r=PG&f=1", "display_name": "Karen Schaefer", "link": "https://stackoverflow.com/users/6241632/karen-schaefer"}, "edited": false, "score": 0, "creation_date": 1469571348, "post_id": 38600654, "comment_id": 64589248, "body": "thanks for the suggestion, however, I was hoping not to store the actual password within the code.  Is there another way?  I also want to refresh the table only, due to the rest of the worksheet has linked or calculated fields."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 99, "user_id": 6241632, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/74d23fcd7775f20dba819eb06f248a23?s=128&d=identicon&r=PG&f=1", "display_name": "Karen Schaefer", "link": "https://stackoverflow.com/users/6241632/karen-schaefer"}, "edited": false, "score": 0, "creation_date": 1469571783, "post_id": 38600654, "comment_id": 64589381, "body": "<code>Is there another way?</code> - Afraid not, and even if there were it only takes 2 seconds and about 10 lines of code to break a worksheet password anyway so I wouldn&#39;t worry about it. If someone really want&#39;s to undo that password they will find a way..."}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 0, "last_activity_date": 1469570883, "creation_date": 1469570883, "answer_id": 38600654, "question_id": 38600553, "link": "https://stackoverflow.com/questions/38600553/protected-worksheet-refresh-tablenot-pivot/38600654#38600654", "title": "Protected worksheet Refresh table(not pivot)", "body": "<p>Lock your sheet like so in the workbook open event:</p>\n\n<pre><code>Private Sub Workbook_Open()\n\n    ThisWorkbook.Sheets(\"Invoice\").Protect Password:=\"Password123\", UserInterfaceOnly:= True\n\nEnd Sub\n</code></pre>\n\n<p>The <code>UserInterfaceOnly</code> argument allows VBA to make changes to the worksheet but not the user - unforunately this option can only be used programatically on not via GUI</p>\n"}], "owner": {"reputation": 99, "user_id": 6241632, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/74d23fcd7775f20dba819eb06f248a23?s=128&d=identicon&r=PG&f=1", "display_name": "Karen Schaefer", "link": "https://stackoverflow.com/users/6241632/karen-schaefer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 534, "favorite_count": 0, "accepted_answer_id": 38600654, "answer_count": 1, "score": 0, "last_activity_date": 1469570883, "creation_date": 1469570355, "last_edit_date": 1531164843, "question_id": 38600553, "link": "https://stackoverflow.com/questions/38600553/protected-worksheet-refresh-tablenot-pivot", "title": "Protected worksheet Refresh table(not pivot)", "body": "<p>I need to protect my worksheet, but still be able to refresh the underlying data(table).  </p>\n\n<p>My worksheet is an Invoice with the body of the invoice is a table linked to underlying query.  How do I refresh this data when I have locked down (protected worksheet) w/password?  The only code I can find seems to unlock &amp; Lock by storing the password within the VBA.   There has to be another method.</p>\n"}, {"tags": ["vba", "typeconverter"], "comments": [{"owner": {"reputation": 7429, "user_id": 4811873, "user_type": "registered", "accept_rate": 6, "profile_image": "https://www.gravatar.com/avatar/2ef5bab087ac0b70e03e34b0b0009fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Robinson", "link": "https://stackoverflow.com/users/4811873/mike-robinson"}, "edited": false, "score": 1, "creation_date": 1469568160, "post_id": 38600043, "comment_id": 64588103, "body": "<i>C&#39;mon ...</i> please don&#39;t ask me to &quot;read and understand your <i>entire</i> subroutine!&quot; (I&#39;ve got plenty of bugs of my own!) <b>;-)</b> Please edit your question to <i>concentrate</i> it. Reduce it down to the shortest possible representation of <i>your <b>essential</b> question.</i> If you will most-kindly do that, then I&#39;m quite sure that you&#39;ll speedily get the answer that you seek. <i>(Another way of saying it: &quot;don&#39;t ask us to <b>look for</b> your question!&quot;)</i>"}], "answers": [{"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 3, "last_activity_date": 1469568155, "creation_date": 1469568155, "answer_id": 38600088, "question_id": 38600043, "link": "https://stackoverflow.com/questions/38600043/converting-integer-to-string-in-vba/38600088#38600088", "title": "Converting Integer to String in VBA", "body": "<p>You've declared <code>P1</code> as an Integer - If you want to change it's data type half way through the operation then you should declare it as a <code>Variant</code> instead and use implicit conversion to control the data type during execution although it would make more sense to simply declare <em>another</em> variable as a string and use that instead.</p>\n\n<hr>\n\n<p>Also, <code>CStr(P1)</code> on it's own doesn't do anything - you need to assign the return value back to the variable:</p>\n\n<pre><code>P1 = CStr(P1)\n</code></pre>\n\n<hr>\n\n<p>What would make <em>more</em> sense:</p>\n\n<pre><code>Dim P1 As Integer\nDim P1toString As String\n\n'// More code here\n\nP1toString = CStr(P1)\n\n'// More code here\n\nIf P1toString &lt;&gt; \"\" Then\n'// etc etc...\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6576927"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7953, "favorite_count": 0, "accepted_answer_id": 38600088, "answer_count": 1, "score": 1, "last_activity_date": 1469568155, "creation_date": 1469567933, "question_id": 38600043, "link": "https://stackoverflow.com/questions/38600043/converting-integer-to-string-in-vba", "title": "Converting Integer to String in VBA", "body": "<p>Here are a few bits of an overall code, and I am trying to run the variable <code>P1</code> through an <code>If statement</code>. At the end of the <code>If statement</code> if value <code>P1</code> does not meet the prior criteria, I would then like to convert <code>P1</code> to an empty string.</p>\n\n<p>I have deleted most of the irrelevant portions of the code below just to get to the point of things...</p>\n\n<pre><code>Sub SLNR\n    '&lt;Macro = SLNR&gt;\n    '&lt;Shortcut = Shift+Ctrl+S&gt;\n    '&lt;Desc = recorded 7/26/2016 12:33:03 PM&gt;\n    On Error Resume Next\n\n    ' Individual lines for the data\n    Dim L1 As String, L2 As String, L3 As String, L4 As String, L5 As String, L6 As String, L7 As String, _\n        L8 As String, L9 As String, L10 As String, L11 As String, L12 As String, L13 As String, _\n        L14 As String, L15 As String, L16 As String, L17 As String, L18 As String, L19 As String, _\n        L20 As String\n\n    Dim L As Integer    'Left column of data\n    Dim R As Integer    'Right column of data\n    Dim R2 As Integer   'The data row to be checked\n    Dim pL As Integer\n    Dim pR As Integer\n\n    Dim SP1 As String\n        SP1 = \"subj_data_field1\"\n    Dim SP2 As String\n        SP2 = \"subj_data_field2\"\n    Dim SP3 As String\n        SP3 = \"subj_data_field3\"\n\n    Dim P1 As Integer\n    Dim P2 As Integer\n    Dim P3 As Integer\n\n    Dim E As String      'Carriage Return Key shortcut\n        E = Chr$(13)\n\n    L   =   0\n    R   =   10\n    R2  =   2\n\n    pL = L + 14\n    pR = R + 13\n\n    With ActiveSession\n        .InputMode = 1\n        .Output \"MS1\" &amp; E\n        .WaitFor 0, 1, \"W,/) \"\n\n\n    ' Copying the first few characters of each line in LN report, to compare with the phone fields...\n    .Copy   L,  R2  +   0   ,   R,  R2  +   0\n        L1 = Clipboard\n    .Copy   L,  R2  +   1   ,   R,  R2  +   1\n        L2 = Clipboard\n    .Copy   L,  R2  +   2   ,   R,  R2  +   2\n        L3 = Clipboard\n    .Copy   L,  R2  +   3   ,   R,  R2  +   3\n        L4 = Clipboard\n    .Copy   L,  R2  +   4   ,   R,  R2  +   4\n        L5 = Clipboard\n    .Copy   L,  R2  +   5   ,   R,  R2  +   5\n        L6 = Clipboard\n    .Copy   L,  R2  +   6   ,   R,  R2  +   6\n        L7 = Clipboard\n    .Copy   L,  R2  +   7   ,   R,  R2  +   7\n        L8 = Clipboard\n    .Copy   L,  R2  +   8   ,   R,  R2  +   8\n        L9 = Clipboard\n    .Copy   L,  R2  +   9   ,   R,  R2  +   9\n        L10 = Clipboard\n    .Copy   L,  R2  +   10  ,   R,  R2  +   10\n        L11 = Clipboard\n    .Copy   L,  R2  +   11  ,   R,  R2  +   11\n        L12 = Clipboard\n    .Copy   L,  R2  +   12  ,   R,  R2  +   12\n        L13 = Clipboard\n    .Copy   L,  R2  +   13  ,   R,  R2  +   13\n        L14 = Clipboard\n    .Copy   L,  R2  +   14  ,   R,  R2  +   14\n        L15 = Clipboard\n    .Copy   L,  R2  +   15  ,   R,  R2  +   15\n        L16 = Clipboard\n    .Copy   L,  R2  +   16  ,   R,  R2  +   16\n        L17 = Clipboard\n    .Copy   L,  R2  +   17  ,   R,  R2  +   17\n        L18 = Clipboard\n    .Copy   L,  R2  +   18  ,   R,  R2  +   18\n        L19 = Clipboard\n    .Copy   L,  R2  +   19  ,   R,  R2  +   19\n        L20 = Clipboard\n\n\n    ' Finding field for P1\n    If L1 = SP1 Then\n        .Copy   pL,     R2  +   0   ,   pR,     R2  +   0\n            P1 = Clipboard\n    ElseIf L2 = SP1 Then\n        .Copy   pL,     R2  +   1   ,   pR,     R2  +   1\n            P1 = Clipboard\n    ElseIf L3 = SP1 Then\n        .Copy   pL,     R2  +   2   ,   pR,     R2  +   2\n            P1 = Clipboard\n    ElseIf L4 = SP1 Then\n        .Copy   pL,     R2  +   3   ,   pR,     R2  +   3\n            P1 = Clipboard\n    ElseIf L5 = SP1 Then\n        .Copy   pL,     R2  +   4   ,   pR,     R2  +   4\n            P1 = Clipboard\n    ElseIf L6 = SP1 Then\n        .Copy   pL,     R2  +   5   ,   pR,     R2  +   5\n            P1 = Clipboard\n    ElseIf L7 = SP1 Then\n        .Copy   pL,     R2  +   6   ,   pR,     R2  +   6\n            P1 = Clipboard\n    ElseIf L8 = SP1 Then\n        .Copy   pL,     R2  +   7   ,   pR,     R2  +   7\n            P1 = Clipboard\n    ElseIf L9 = SP1 Then\n        .Copy   pL,     R2  +   8   ,   pR,     R2  +   8\n            P1 = Clipboard\n    ElseIf L10 = SP1 Then\n        .Copy   pL,     R2  +   9   ,   pR,     R2  +   9\n            P1 = Clipboard\n    ElseIf L11 = SP1 Then\n        .Copy   pL,     R2  +   10  ,   pR,     R2  +   10\n            P1 = Clipboard\n    ElseIf L12 = SP1 Then\n        .Copy   pL,     R2  +   11  ,   pR,     R2  +   11\n            P1 = Clipboard\n    ElseIf L13 = SP1 Then\n        .Copy   pL,     R2  +   12  ,   pR,     R2  +   12\n            P1 = Clipboard\n    ElseIf L14 = SP1 Then\n        .Copy   pL,     R2  +   13  ,   pR,     R2  +   13\n            P1 = Clipboard\n    ElseIf L15 = SP1 Then\n        .Copy   pL,     R2  +   14  ,   pR,     R2  +   14\n            P1 = Clipboard\n    ElseIf L16 = SP1 Then\n        .Copy   pL,     R2  +   15  ,   pR,     R2  +   15\n            P1 = Clipboard\n    ElseIf L17 = SP1 Then\n        .Copy   pL,     R2  +   16  ,   pR,     R2  +   16\n            P1 = Clipboard\n    ElseIf L18 = SP1 Then\n        .Copy   pL,     R2  +   17  ,   pR,     R2  +   17\n            P1 = Clipboard\n    ElseIf L19 = SP1 Then\n        .Copy   pL,     R2  +   18  ,   pR,     R2  +   18\n            P1 = Clipboard\n    ElseIf L20 = SP1 Then\n        .Copy   pL,     R2  +   19  ,   pR,     R2  +   19\n            P1 = Clipboard\n    Else\n        CStr(P1)        \n        P1 = \"\"              ' &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;********** ISSUE IS HERE\n    End If\n\n\n    ' ......... Code has been trimmed... Showing below the reason I need P1 as an Integer\n\n    If P1 &lt;&gt; \"\" Then\n        Format(P1,000-000-0000)\n    End If\n    If P2 &lt;&gt; \"\" Then\n        Format(P2,000-000-0000)\n    End If\n    If P3 &lt;&gt; \"\" Then\n        Format(P3,000-000-0000)\n    End If\n\n' CONTINUES ON.....\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1469567041, "post_id": 38599761, "comment_id": 64587618, "body": "You&#39;re <i>always</i> just adding 1 to the value of A10, in this line: <code>Selection.Value = Range(&quot;A10&quot;).Value + 1</code>."}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1469568500, "creation_date": 1469568500, "answer_id": 38600177, "question_id": 38599761, "link": "https://stackoverflow.com/questions/38599761/excel-vba-code-for-consecutive-number-next-to-a-pasted-data/38600177#38600177", "title": "Excel VBA code for consecutive number next to a pasted data", "body": "<p>Replace your line which says</p>\n\n<pre><code>Selection.Value = Range(\"A10\").Value + 1\n</code></pre>\n\n<p>with</p>\n\n<pre><code>Selection.Value = Application.WorksheetFunction.Max(Range(\"A:A\")) + 1\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1470136884, "post_id": 38600227, "comment_id": 64814088, "body": "@SalA.: did you get through it?"}, {"owner": {"reputation": 3, "user_id": 6641723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525e5a78d08c114443a810e9b83da34a?s=128&d=identicon&r=PG&f=1", "display_name": "Sal A.", "link": "https://stackoverflow.com/users/6641723/sal-a"}, "edited": false, "score": 0, "creation_date": 1470453902, "post_id": 38600227, "comment_id": 64970450, "body": "Hi, yes I have, I appreciate you guys being so helpful, I&#39;m trying to make this little app, I have lots to go but I think is very advanced now maybe like 80% :)"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 3, "user_id": 6641723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525e5a78d08c114443a810e9b83da34a?s=128&d=identicon&r=PG&f=1", "display_name": "Sal A.", "link": "https://stackoverflow.com/users/6641723/sal-a"}, "edited": false, "score": 0, "creation_date": 1470460987, "post_id": 38600227, "comment_id": 64971426, "body": "So good coding! Then if I fulfilled your question please mark my answer as accepted. Thank you"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 1, "last_activity_date": 1469568698, "creation_date": 1469568698, "answer_id": 38600227, "question_id": 38599761, "link": "https://stackoverflow.com/questions/38599761/excel-vba-code-for-consecutive-number-next-to-a-pasted-data/38600227#38600227", "title": "Excel VBA code for consecutive number next to a pasted data", "body": "<p>Replace</p>\n\n<pre><code>Selection.Value = Range(\"A10\").Value + 1\n</code></pre>\n\n<p>With</p>\n\n<pre><code>Selection.Value = Selection.End(xlUp) + 1\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 6641723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525e5a78d08c114443a810e9b83da34a?s=128&d=identicon&r=PG&f=1", "display_name": "Sal A.", "link": "https://stackoverflow.com/users/6641723/sal-a"}, "edited": false, "score": 0, "creation_date": 1469831945, "post_id": 38604804, "comment_id": 64717788, "body": "Hi Thomas,  Some how I managed to get it working  with,      Worksheets(&quot;DATOS GENERALES&quot;).Range(&quot;F4:N20&quot;).Copy     Sheets(&quot;CARRITO&quot;).Visible = True     Sheets(&quot;CARRITO&quot;).Select     Range(&quot;B1&quot;).End(xlDown).Offset(1, -1).Select     Selection.Value = Range(&quot;A1000&quot;).End(xlUp).Value + 1     Range(&quot;B1&quot;).End(xlDown).Offset(1, 0).Select     Selection.PasteSpecial xlPasteFormats     Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone.      SkipBlanks:= _     False, Transpose:=False"}, {"owner": {"reputation": 3, "user_id": 6641723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525e5a78d08c114443a810e9b83da34a?s=128&d=identicon&r=PG&f=1", "display_name": "Sal A.", "link": "https://stackoverflow.com/users/6641723/sal-a"}, "edited": false, "score": 0, "creation_date": 1469832281, "post_id": 38604804, "comment_id": 64717874, "body": "Sorry I&#39;m new in forums and vba, 1 month experience hehe,"}, {"owner": {"reputation": 3, "user_id": 6641723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525e5a78d08c114443a810e9b83da34a?s=128&d=identicon&r=PG&f=1", "display_name": "Sal A.", "link": "https://stackoverflow.com/users/6641723/sal-a"}, "edited": false, "score": 0, "creation_date": 1470450607, "post_id": 38604804, "comment_id": 64970004, "body": "Thanks Thomas, I ended up using your suggested code and its great, I&#39;m trying to do same thing with other part of coding in same userform, but cant figure out how to repeat this code from sheet &quot;1&quot; to sheet &quot;2&quot;, I would post the code how I&#39;m trying to implement yours."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 3, "user_id": 6641723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525e5a78d08c114443a810e9b83da34a?s=128&d=identicon&r=PG&f=1", "display_name": "Sal A.", "link": "https://stackoverflow.com/users/6641723/sal-a"}, "edited": false, "score": 0, "creation_date": 1470639703, "post_id": 38604804, "comment_id": 65012239, "body": "I&#39;ll look over it tomorrow night when I get home from work."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 0, "last_activity_date": 1469599053, "creation_date": 1469599053, "answer_id": 38604804, "question_id": 38599761, "link": "https://stackoverflow.com/questions/38599761/excel-vba-code-for-consecutive-number-next-to-a-pasted-data/38604804#38604804", "title": "Excel VBA code for consecutive number next to a pasted data", "body": "<p>I refactored your code using removing unnecessary cell selection, combing range addresses and using <code>With Worksheets(\"DATOS GENERALES\")</code> to simplify referencing. I also took YowE3K suggestion and use the WorksheetFunction.Max to determine the next increment.</p>\n\n<pre><code>Private Sub CommandButton4_Click()\n    Dim Target As Range\n\n    With Worksheets(\"DATOS GENERALES\")\n        Set Target = Sheets(\"CARRITO\").Range(\"B1\").End(xlDown).Offset(1)\n        .Range(\"F4:N20\").Copy\n\n        Target.Offset(0, -1).Value = WorksheetFunction.Max(Sheets(\"CARRITO\").Columns(1)) + 1\n\n        Target.PasteSpecial xlPasteFormats\n        Target.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _\n                               False, Transpose:=False\n\n        .Range(\"F4:N22\").Cells.ClearContents\n        .Range(\"F4:N20\").ClearFormats\n        .Range(\"F4:N22,F2:G2,Q1:Q16,H2:I2\").ClearContents\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6641723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525e5a78d08c114443a810e9b83da34a?s=128&d=identicon&r=PG&f=1", "display_name": "Sal A.", "link": "https://stackoverflow.com/users/6641723/sal-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 419, "favorite_count": 0, "accepted_answer_id": 38604804, "answer_count": 3, "score": 0, "last_activity_date": 1470452910, "creation_date": 1469566679, "last_edit_date": 1470452910, "question_id": 38599761, "link": "https://stackoverflow.com/questions/38599761/excel-vba-code-for-consecutive-number-next-to-a-pasted-data", "title": "Excel VBA code for consecutive number next to a pasted data", "body": "<p>I have a Userform where a commandbutton copies data from sheet1(\"DATOS GENERALES\") range(F4:N22) and paste to sheet2(\"CARRITO\") selecting B10 and looking for next empty row.  Until now everything is going fine, but now I need it to place a consecutive number next to each paste on column 1 (A10). </p>\n\n<p>My problem is that it pastes on different rows since data varies in the number of rows that contain data. For example the first paste would start on B10:J15, at this point I should have \"01\" on A10 and next paste it starts on B16:J20 and should auto-increment A16 with \"2\" and so on.  Like I said the past on next empty cell is working fine, the issue is in the auto numbering.  I'll place sample of the code which recalls always from A10. </p>\n\n<p>I really appreciate your help.</p>\n\n<pre><code>Private Sub CommandButton4_Click()\n   Worksheets(\"DATOS GENERALES\").Range(\"F4:N20\").Copy\n   Sheets(\"CARRITO\").Select\n   Range(\"B1\").End(xlDown).Offset(1, -1).Select\n   Selection.Value = Range(\"A10\").Value + 1\n   Range(\"B1\").End(xlDown).Offset(1, 0).Select\n   Selection.PasteSpecial xlPasteFormats\n   Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _\n   False, Transpose:=False\n\n   Sheets(\"DATOS GENERALES\").Select\n   Range(\"F4:N22\").Cells.ClearContents\n   Application.CutCopyMode = False\n   Sheets(\"DATOS GENERALES\").Range(\"F4:N20\").ClearFormats\n   Range(\"F2:G2\").Cells.ClearContents\n   Range(\"Q1:Q16\").Cells.ClearContents\n   Range(\"H2:I2\").Cells.ClearContents\n\n\n\nEnd Sub\n</code></pre>\n\n<p>Currently it numbers A10 to \"1\" and A16 to \"2\" and if next past was on B25 it would put A25 to \"2\".</p>\n\n<p>The following code has Dim for all abbreviations. The values to send from one sheet to the other vary depending on type of cabinet since but for example some have hinges others have slides and others have both so on target sheet adds quantity of those and adds them, they range from column A to column M and those that dont carry any hardware of a type it would should place \"0\" on the rest of the rows. Somehow it doesnt work. </p>\n\n<p>The following is the expected code to reduce code size since if I run the code as it is now  (I would place below) the working one only in Windows 10.</p>\n\n<pre><code>Dg.Select\nIf Cells(2, 6) = \"\" Then\n    MsgBox \"SELECCIONAR MUEBLE\"\n    Range(\"Q1\").Cells.ClearContents\n    Range(\"H2:I2\").Cells.ClearContents\n    Exit Sub\n    ElseIf Cells(2, 8) = \"\" Then\n    MsgBox \"SELECCIONE CANTIDAD\"\n    Exit Sub\nElseIf Cells(1, 17) = \"\" Then\n    MsgBox \"FAVOR DE INDICAR ANCHO DEL MUEBLE\"\n    Exit Sub\nElseIf Cells(2, 17) = \"\" Then\n    MsgBox \"FAVOR DE INDICAR ALTO DEL MUEBLE\"\n    Exit Sub\n    ElseIf Cells(4, 17) = \"\" Then\n    MsgBox \"FAVOR DE INDICAR FONDO DEL MUEBLE\"\n    Exit Sub\n    ElseIf Cells(2, 6) = \"BASE TARJA\" Then\nWith Tarja\n    Set Target = Dg.Range(\"F4\")\n    .Range(\"A2:I7\").Copy\n\n    Target.PasteSpecial xlPasteFormats\n    Target.PasteSpecial Paste:=xlValues, Operation:=xlNone,                    SkipBlanks:= \n                           False, Transpose:=False\n    'HERRAJE\n    With Tarja\n    Set Target = Herraje.Range(\"A2\").End(xlDown).Offset(1)\n        Range(\"B24\").Copy  'BISAGRA 110\n        Target.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n    Set Target = Herraje.Range(\"E2\").End(xlDown).Offset(1)\n        Range(\"B21\").Copy   'PATAS\n        Target.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n    Set Target = Herraje.Range(\"F2\").End(xlDown).Offset(1)\n        Range(\"B20\").Copy   'CONFIRMATS\n        Target.PasteSpecial Paste:=xlValues, Operation:=xlNone,         SkipBlanks:=False, Transpose:=False\n    Set Target = Herraje.Range(\"G2\").End(xlDown).Offset(1)\n        Range(\"B25\").Copy   'JALADERAS\n        Target.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n    Set Target = Herraje.Range(\"H2\").End(xlDown).Offset(1)\n        Range(\"B22\").Copy   'CHILILLO 5/8\n        Target.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n    Set Target = Herraje.Range(\"I2\").End(xlDown).Offset(1)\n        Range(\"B23\").Copy   'CHILILLO BISAGRA\n        Target.PasteSpecial Paste:=xlValues, Operation:=xlNone,    SkipBlanks:=False, Transpose:=False\nEnd With\nElseIf Cells(2, 6) = \"BASE FULL DOOR\" Then\nWith Fd 'IT REPEATS \n</code></pre>\n\n<p>Current working code but to large for windows 7.</p>\n\n<pre><code>Private Sub CommandButton4_Click()\nOn Error GoTo errHandler\nApplication.ScreenUpdating = False\n\nDim wb1 As Workbook\nDim Dg, Herraje, Complementos, Carrito, Listbox, Tarja, Fd, Pc, Cajonera,       Be9, Ciegofd, Barrafd, Pantryc, Pantryh, Scomun, Sdiagonal, Se9, Shzls, Shzld,     Smicroondas, Scampana, Srefrigerador As Worksheet\nDim modulo, desgloce, cantidad As Range\n\nSet wb1 = Workbooks(\"LISTA_DE_CORTE_V1_1.xlsm\")\nSet Dg = Worksheets(\"DATOS GENERALES\")\nSet Herraje = Worksheets(\"HERRAJE\")\nSet Complementos = Worksheets(\"COMPLEMENTOS\")\nSet Carrito = Worksheets(\"CARRITO\")\nSet Listbox = Worksheets(\"LISTBOX\")\nSet Tarja = Worksheets(\"TARJA\")\nSet Fd = Worksheets(\"FULL_DOOR\")\nSet Pc = Worksheets(\"PUERTA_CAJON\")\nSet Cajonera = Worksheets(\"CAJONERA\")\nSet Be9 = Worksheets(\"ESQUINERO_90\")\nSet Ciegofd = Worksheets(\"CIEGO_FULL_DOOR\")\nSet Barrafd = Worksheets(\"BARRA_FD\")\nSet Pantryc = Worksheets(\"PANTRY_COMUN\")\nSet Pantryh = Worksheets(\"PANTRY_HORNO\")\nSet Scomun = Worksheets(\"SUPERIOR_COMUN\")\nSet Sdiagonal = Worksheets(\"SUPERIOR_DIAGONAL\")\nSet Se9 = Worksheets(\"SUP_ESQ_90\")\nSet Shzls = Worksheets(\"SUPERIOR_HZL_SENCILLO\")\nSet Shzld = Worksheets(\"SUPERIOR_HZL_DOBLE\")\nSet Smicroondas = Worksheets(\"SUPERIOR_MICRO\")\nSet Scampana = Worksheets(\"SUPERIOR_CAMPANA\")\nSet Srefrigerador = Worksheets(\"SUPERIOR_REFRI\")\n\n\nDg.Range(\"F2:G2\").Value = ComboBox7.Text\nDg.Range(\"H2:I2\").Value = TextBox15.Text\nDg.Range(\"Q1\").Value = TextBox5.Text\nDg.Range(\"Q2\").Value = TextBox6.Text\nDg.Range(\"Q4\").Value = TextBox7.Text\nDg.Range(\"Q5\").Value = TextBox9.Text\nDg.Range(\"Q6\").Value = ComboBox8.Text\nDg.Range(\"Q7\").Value = TextBox8.Text\nDg.Range(\"B18\").Value = TextBox10.Text\nDg.Range(\"B19\").Value = TextBox11.Text\nDg.Range(\"B20\").Value = TextBox12.Text\nDg.Range(\"B21\").Value = TextBox13.Text\nDg.Range(\"B22\").Value = TextBox14.Text\n\n\n    Dg.Select\nRange(\"F4:N17\").Cells.ClearContents\nIf Cells(2, 6) = \"\" Then\n    MsgBox \"SELECCIONAR MUEBLE\"\n    Range(\"Q1\").Cells.ClearContents\n    Range(\"H2:I2\").Cells.ClearContents\n    Exit Sub\nElseIf Cells(2, 8) = \"\" Then\n    MsgBox \"SELECCIONE CANTIDAD\"\n    Exit Sub\nElseIf Cells(1, 17) = \"\" Then\n    MsgBox \"FAVOR DE INDICAR ANCHO DEL MUEBLE\"\n    Exit Sub\nElseIf Cells(2, 17) = \"\" Then\n    MsgBox \"FAVOR DE INDICAR ALTO DEL MUEBLE\"\n    Exit Sub\nElseIf Cells(4, 17) = \"\" Then\n    MsgBox \"FAVOR DE INDICAR FONDO DEL MUEBLE\"\n    Exit Sub\nElseIf Cells(2, 6) = \"BASE TARJA\" Then\nDg.Select\nRange(\"F4:N22\").Cells.ClearFormats\nRange(\"F4:N22\").Cells.ClearContents\nTarja.Visible = True\nTarja.Select\nRange(\"A2:I7\").Select\nSelection.Copy\nDg.Select\nRange(\"F4\").Select\nSelection.PasteSpecial xlPasteFormats\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nDg.Select\n'HERRAJE\nHerraje.Select\nRange(\"A50\").End(xlUp).Offset(1, 0).Select\nSelection.Value = Tarja.Range(\"B24\").Value 'BISAGRA 110\nHerraje.Select\nRange(\"E50\").End(xlUp).Offset(1, 0).Select 'PATAS\nSelection.Value = Tarja.Range(\"B21\").Value\nHerraje.Select\nRange(\"F50\").End(xlUp).Offset(1, 0).Select 'CONFIRMATS\nSelection.Value = Tarja.Range(\"B20\").Value\nHerraje.Select\nRange(\"G50\").End(xlUp).Offset(1, 0).Select 'JALADERAS\nSelection.Value = Tarja.Range(\"B25\").Value\nHerraje.Select\nRange(\"H50\").End(xlUp).Offset(1, 0).Select 'CHILILLO 5/8\nSelection.Value = Tarja.Range(\"B22\").Value\nHerraje.Select\nRange(\"I50\").End(xlUp).Offset(1, 0).Select 'CHILILLO BISAGRA\nSelection.Value = Tarja.Range(\"B23\").Value\n\n\nHerraje.Select\nRange(\"B50\").End(xlUp).Offset(1, 0).Select 'BISAGRA 170\nSelection.Value = \"0\"\nHerraje.Select\nRange(\"C50\").End(xlUp).Offset(1, 0).Select 'BISAGRA UNION\nSelection.Value = \"0\"\nHerraje.Select\nRange(\"L50\").End(xlUp).Offset(1, 0).Select 'BISAGRA 45\nSelection.Value = \"0\"\nHerraje.Select\nRange(\"M50\").End(xlUp).Offset(1, 0).Select 'PINS\nSelection.Value = \"0\"\nHerraje.Select\nRange(\"D50\").End(xlUp).Offset(1, 0).Select 'RIEL\nSelection.Value = \"0\"\nHerraje.Select\nRange(\"J50\").End(xlUp).Offset(1, 0).Select 'SISTEMA HORIZONTAL\nSelection.Value = \"0\"\nRange(\"K50\").End(xlUp).Offset(1, 0).Select 'MINIFIX\nSelection.Value = \"0\"\nTarja.Visible = False\nElseIf Cells(2, 6) = \"BASE FULL DOOR\" Then\nSheets(\"DATOS GENERALES\").Select\nRange(\"F4:N22\").Cells.ClearFormats\nRange(\"F4:N22\").Cells.ClearContents\nSheets(\"FULL_DOOR\").Visible = True\nSheets(\"FULL_DOOR\").Select\nRange(\"A2:I8\").Select\nSelection.Copy\nSheets(\"DATOS GENERALES\").Select\nRange(\"F4\").Select\nSelection.PasteSpecial xlPasteFormats\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n'HERRAJE\nWorksheets(\"HERRAJE\").Select\nRange(\"A50\").End(xlUp).Offset(1, 0).Select\nSelection.Value = Worksheets(\"FULL_DOOR\").Range(\"B24\").Value 'BISAGRA 110\nWorksheets(\"HERRAJE\").Select\nRange(\"B50\").End(xlUp).Offset(1, 0).Select 'BISAGRA 170\nSelection.Value = \"0\"\nWorksheets(\"HERRAJE\").Select\nRange(\"C50\").End(xlUp).Offset(1, 0).Select 'BISAGRA UNION\nSelection.Value = \"0\"\nWorksheets(\"HERRAJE\").Select\nRange(\"L50\").End(xlUp).Offset(1, 0).Select 'BISAGRA 45\nSelection.Value = \"0\"\nWorksheets(\"HERRAJE\").Select\nRange(\"M50\").End(xlUp).Offset(1, 0).Select 'PINS\nSelection.Value = Worksheets(\"FULL_DOOR\").Range(\"B28\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"D50\").End(xlUp).Offset(1, 0).Select 'RIEL\nSelection.Value = \"0\"\nWorksheets(\"HERRAJE\").Select\nRange(\"E50\").End(xlUp).Offset(1, 0).Select\nSelection.Value = Worksheets(\"FULL_DOOR\").Range(\"B21\").Value 'PATAS\nWorksheets(\"HERRAJE\").Select\nRange(\"F50\").End(xlUp).Offset(1, 0).Select\nSelection.Value = Worksheets(\"FULL_DOOR\").Range(\"B20\").Value 'CONFIRMATS\nWorksheets(\"HERRAJE\").Select\nRange(\"G50\").End(xlUp).Offset(1, 0).Select\nSelection.Value = Worksheets(\"FULL_DOOR\").Range(\"B25\").Value 'JALADERAS\nWorksheets(\"HERRAJE\").Select\nRange(\"H50\").End(xlUp).Offset(1, 0).Select\nSelection.Value = Worksheets(\"FULL_DOOR\").Range(\"B22\").Value 'CHILILLO 5/8\nWorksheets(\"HERRAJE\").Select\nRange(\"I50\").End(xlUp).Offset(1, 0).Select\nSelection.Value = Worksheets(\"FULL_DOOR\").Range(\"B23\").Value 'CHILILLO     BISAGRA\nWorksheets(\"HERRAJE\").Select\nRange(\"J50\").End(xlUp).Offset(1, 0).Select 'SISTEMA HORIZONTAL\nSelection.Value = \"0\"\nWorksheets(\"HERRAJE\").Select\nRange(\"K50\").End(xlUp).Offset(1, 0).Select 'MINIFIX\nSelection.Value = \"0\"\nSheets(\"FULL_DOOR\").Visible = False\nElseIf Cells(2, 6) = \"BASE PUERTA CAJON\" Then\nSheets(\"DATOS GENERALES\").Select\nRange(\"F4:N22\").Cells.ClearFormats\nRange(\"F4:N22\").Cells.ClearContents\nSheets(\"PUERTA_CAJON\").Visible = True\nSheets(\"PUERTA_CAJON\").Select\nRange(\"A2:I13\").Select\nSelection.Copy\nSheets(\"DATOS GENERALES\").Select\nRange(\"F4\").Select\nSelection.PasteSpecial xlPasteFormats\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n'HERRAJE\nWorksheets(\"HERRAJE\").Select\nRange(\"A50\").End(xlUp).Offset(1, 0).Select\nSelection.Value = Worksheets(\"PUERTA_CAJON\").Range(\"B24\").Value 'BISAGRA 110\nWorksheets(\"HERRAJE\").Select\nRange(\"B50\").End(xlUp).Offset(1, 0).Select 'BISAGRA 170\nSelection.Value = \"0\"\nWorksheets(\"HERRAJE\").Select\nRange(\"C50\").End(xlUp).Offset(1, 0).Select 'BISAGRA UNION\nSelection.Value = \"0\"\nWorksheets(\"HERRAJE\").Select\nRange(\"L50\").End(xlUp).Offset(1, 0).Select 'BISAGRA 45\nSelection.Value = \"0\"\nWorksheets(\"HERRAJE\").Select\nRange(\"M50\").End(xlUp).Offset(1, 0).Select 'PINS\nSelection.Value = Worksheets(\"PUERTA_CAJON\").Range(\"B28\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"D50\").End(xlUp).Offset(1, 0).Select 'RIEL\nSelection.Value = Worksheets(\"PUERTA_CAJON\").Range(\"B26\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"E50\").End(xlUp).Offset(1, 0).Select 'PATAS\nSelection.Value = Worksheets(\"PUERTA_CAJON\").Range(\"B21\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"F50\").End(xlUp).Offset(1, 0).Select 'CONFIRMATS\nSelection.Value = Worksheets(\"PUERTA_CAJON\").Range(\"B20\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"G50\").End(xlUp).Offset(1, 0).Select 'JALADERAS\nSelection.Value = Worksheets(\"PUERTA_CAJON\").Range(\"B25\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"H50\").End(xlUp).Offset(1, 0).Select 'CHILILLO 5/8\nSelection.Value = Worksheets(\"PUERTA_CAJON\").Range(\"B22\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"I50\").End(xlUp).Offset(1, 0).Select 'CHILILLO BISAGRA\nSelection.Value = Worksheets(\"PUERTA_CAJON\").Range(\"B23\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"J50\").End(xlUp).Offset(1, 0).Select 'SISTEMA HORIZONTAL\nSelection.Value = \"0\"\nWorksheets(\"HERRAJE\").Select\nRange(\"K50\").End(xlUp).Offset(1, 0).Select 'MINIFIX\nSelection.Value = Worksheets(\"PUERTA_CAJON\").Range(\"B27\").Value\nSheets(\"PUERTA_CAJON\").Visible = False\nElseIf Cells(2, 6) = \"BASE CAJONERA\" Then\nSheets(\"DATOS GENERALES\").Select\nRange(\"F4:N22\").Cells.ClearFormats\nRange(\"F4:N22\").Cells.ClearContents\nSheets(\"CAJONERA\").Visible = True\nSheets(\"CAJONERA\").Select\nRange(\"A2:I12\").Select\nSelection.Copy\nSheets(\"DATOS GENERALES\").Select\nRange(\"F4\").Select\nSelection.PasteSpecial xlPasteFormats\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n'HERRAJE\nWorksheets(\"HERRAJE\").Select\nRange(\"A50\").End(xlUp).Offset(1, 0).Select 'BISAGRA 110\nSelection.Value = \"0\"\nWorksheets(\"HERRAJE\").Select\nRange(\"B50\").End(xlUp).Offset(1, 0).Select 'BISAGRA 170\nSelection.Value = \"0\"\nWorksheets(\"HERRAJE\").Select\nRange(\"C50\").End(xlUp).Offset(1, 0).Select 'BISAGRA UNION\nSelection.Value = \"0\"\nWorksheets(\"HERRAJE\").Select\nRange(\"L50\").End(xlUp).Offset(1, 0).Select 'BISAGRA 45\nSelection.Value = \"0\"\nWorksheets(\"HERRAJE\").Select\nRange(\"M50\").End(xlUp).Offset(1, 0).Select 'PINS\nSelection.Value = Worksheets(\"CAJONERA\").Range(\"B28\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"D50\").End(xlUp).Offset(1, 0).Select 'RIEL\nSelection.Value = Worksheets(\"CAJONERA\").Range(\"B26\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"E50\").End(xlUp).Offset(1, 0).Select 'PATAS\nSelection.Value = Worksheets(\"CAJONERA\").Range(\"B21\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"F50\").End(xlUp).Offset(1, 0).Select 'CONFIRMATS\nSelection.Value = Worksheets(\"CAJONERA\").Range(\"B20\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"G50\").End(xlUp).Offset(1, 0).Select 'JALADERAS\nSelection.Value = Worksheets(\"CAJONERA\").Range(\"B25\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"H50\").End(xlUp).Offset(1, 0).Select 'CHILILLO 5/8\nSelection.Value = Worksheets(\"CAJONERA\").Range(\"B22\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"I50\").End(xlUp).Offset(1, 0).Select 'CHILILLO BISAGRA\nSelection.Value = Worksheets(\"CAJONERA\").Range(\"B23\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"J50\").End(xlUp).Offset(1, 0).Select 'SISTEMA HORIZONTAL\nSelection.Value = \"0\"\nWorksheets(\"HERRAJE\").Select\nRange(\"K50\").End(xlUp).Offset(1, 0).Select 'MINIFIX\nSelection.Value = Worksheets(\"CAJONERA\").Range(\"B27\").Value\nSheets(\"CAJONERA\").Visible = False\nElseIf Cells(2, 6) = \"BASE ESQUINERO 90\" Then\nSheets(\"DATOS GENERALES\").Select\nRange(\"F4:N22\").Cells.ClearFormats\nRange(\"F4:N22\").Cells.ClearContents\nSheets(\"ESQUINERO_90\").Visible = True\nSheets(\"ESQUINERO_90\").Select\nRange(\"A2:I12\").Select\nSelection.Copy\nSheets(\"DATOS GENERALES\").Select\nRange(\"F4\").Select\nSelection.PasteSpecial xlPasteFormats\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n'HERRAJE\nWorksheets(\"HERRAJE\").Select\nRange(\"A50\").End(xlUp).Offset(1, 0).Select 'BISAGRA 110\nSelection.Value = \"0\"\nWorksheets(\"HERRAJE\").Select\nRange(\"B50\").End(xlUp).Offset(1, 0).Select 'BISAGRA 170\nSelection.Value = Worksheets(\"ESQUINERO_90\").Range(\"B24\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"C50\").End(xlUp).Offset(1, 0).Select 'BISAGRA UNION\nSelection.Value = Worksheets(\"ESQUINERO_90\").Range(\"B25\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"L50\").End(xlUp).Offset(1, 0).Select 'BISAGRA 45\nSelection.Value = \"0\"\nWorksheets(\"HERRAJE\").Select\nRange(\"M50\").End(xlUp).Offset(1, 0).Select 'PINS\nSelection.Value = Worksheets(\"ESQUINERO_90\").Range(\"B28\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"D50\").End(xlUp).Offset(1, 0).Select 'RIEL\nSelection.Value = \"0\"\nWorksheets(\"HERRAJE\").Select\nRange(\"E50\").End(xlUp).Offset(1, 0).Select 'PATAS\nSelection.Value = Worksheets(\"ESQUINERO_90\").Range(\"B21\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"F50\").End(xlUp).Offset(1, 0).Select 'CONFIRMATS\nSelection.Value = Worksheets(\"ESQUINERO_90\").Range(\"B20\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"G50\").End(xlUp).Offset(1, 0).Select 'JALADERAS\nSelection.Value = Worksheets(\"ESQUINERO_90\").Range(\"B26\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"H50\").End(xlUp).Offset(1, 0).Select 'CHILILLO 5/8\nSelection.Value = Worksheets(\"ESQUINERO_90\").Range(\"B22\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"I50\").End(xlUp).Offset(1, 0).Select 'CHILILLO BISAGRA\nSelection.Value = Worksheets(\"ESQUINERO_90\").Range(\"B23\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"J50\").End(xlUp).Offset(1, 0).Select 'SISTEMA HORIZONTAL\nSelection.Value = \"0\"\nWorksheets(\"HERRAJE\").Select\nRange(\"K50\").End(xlUp).Offset(1, 0).Select 'MINIFIX\nSelection.Value = \"0\"\nSheets(\"ESQUINERO_90\").Visible = False\nElseIf Cells(2, 6) = \"BASE CIEGO FULL DOOR\" Then\nSheets(\"DATOS GENERALES\").Select\nRange(\"F4:N22\").Cells.ClearFormats\nRange(\"F4:N22\").Cells.ClearContents\nSheets(\"CIEGO_FULL_DOOR\").Visible = True\nSheets(\"CIEGO_FULL_DOOR\").Select\nRange(\"A2:I9\").Select\nSelection.Copy\nSheets(\"DATOS GENERALES\").Select\nRange(\"F4\").Select\nSelection.PasteSpecial xlPasteFormats\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n'HERRAJE\nWorksheets(\"HERRAJE\").Select\nRange(\"A50\").End(xlUp).Offset(1, 0).Select\nSelection.Value = Worksheets(\"CIEGO_FULL_DOOR\").Range(\"B24\").Value 'BISAGRA     110\nWorksheets(\"HERRAJE\").Select\nRange(\"B50\").End(xlUp).Offset(1, 0).Select 'BISAGRA 170\nSelection.Value = \"0\"\nWorksheets(\"HERRAJE\").Select\nRange(\"C50\").End(xlUp).Offset(1, 0).Select 'BISAGRA UNION\nSelection.Value = \"0\"\nWorksheets(\"HERRAJE\").Select\nRange(\"L50\").End(xlUp).Offset(1, 0).Select 'BISAGRA 45\nSelection.Value = \"0\"\nWorksheets(\"HERRAJE\").Select\nRange(\"M50\").End(xlUp).Offset(1, 0).Select 'PINS\nSelection.Value = Worksheets(\"CIEGO_FULL_DOOR\").Range(\"B28\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"D50\").End(xlUp).Offset(1, 0).Select 'RIEL\nSelection.Value = Worksheets(\"CIEGO_FULL_DOOR\").Range(\"B26\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"E50\").End(xlUp).Offset(1, 0).Select 'PATAS\nSelection.Value = Worksheets(\"CIEGO_FULL_DOOR\").Range(\"B21\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"F50\").End(xlUp).Offset(1, 0).Select 'CONFIRMATS\nSelection.Value = Worksheets(\"CIEGO_FULL_DOOR\").Range(\"B20\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"G50\").End(xlUp).Offset(1, 0).Select 'JALADERAS\nSelection.Value = Worksheets(\"CIEGO_FULL_DOOR\").Range(\"B25\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"H50\").End(xlUp).Offset(1, 0).Select 'CHILILLO 5/8\nSelection.Value = Worksheets(\"CIEGO_FULL_DOOR\").Range(\"B22\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"I50\").End(xlUp).Offset(1, 0).Select 'CHILILLO BISAGRA\nSelection.Value = Worksheets(\"CIEGO_FULL_DOOR\").Range(\"B23\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"J50\").End(xlUp).Offset(1, 0).Select 'SISTEMA HORIZONTAL\nSelection.Value = \"0\"\nWorksheets(\"HERRAJE\").Select\nRange(\"K50\").End(xlUp).Offset(1, 0).Select 'MINIFIX\nSelection.Value = \"0\"\nSheets(\"CIEGO_FULL_DOOR\").Visible = False\nElseIf Cells(2, 6) = \"BASE BARRA FULL DOOR\" Then\nSheets(\"DATOS GENERALES\").Select\nRange(\"F4:N22\").Cells.ClearFormats\nRange(\"F4:N22\").Cells.ClearContents\nSheets(\"BARRA_FD\").Visible = True\nSheets(\"BARRA_FD\").Select\nRange(\"A2:I12\").Select\nSelection.Copy\nSheets(\"DATOS GENERALES\").Select\nRange(\"F4\").Select\nSelection.PasteSpecial xlPasteFormats\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n'HERRAJE\nWorksheets(\"HERRAJE\").Select\nRange(\"A50\").End(xlUp).Offset(1, 0).Select\nSelection.Value = Worksheets(\"BARRA_FD\").Range(\"B24\").Value 'BISAGRA 110\nWorksheets(\"HERRAJE\").Select\nRange(\"B50\").End(xlUp).Offset(1, 0).Select 'BISAGRA 170\nSelection.Value = \"0\"\nWorksheets(\"HERRAJE\").Select\nRange(\"C50\").End(xlUp).Offset(1, 0).Select 'BISAGRA UNION\nSelection.Value = \"0\"\nWorksheets(\"HERRAJE\").Select\nRange(\"L50\").End(xlUp).Offset(1, 0).Select 'BISAGRA 45\nSelection.Value = \"0\"\nWorksheets(\"HERRAJE\").Select\nRange(\"M50\").End(xlUp).Offset(1, 0).Select 'PINS\nSelection.Value = Worksheets(\"BARRA_FD\").Range(\"B28\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"D50\").End(xlUp).Offset(1, 0).Select 'RIEL\nSelection.Value = Worksheets(\"BARRA_FD\").Range(\"B26\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"E50\").End(xlUp).Offset(1, 0).Select 'PATAS\nSelection.Value = Worksheets(\"BARRA_FD\").Range(\"B21\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"F50\").End(xlUp).Offset(1, 0).Select 'CONFIRMATS\nSelection.Value = Worksheets(\"BARRA_FD\").Range(\"B20\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"G50\").End(xlUp).Offset(1, 0).Select 'JALADERAS\nSelection.Value = Worksheets(\"BARRA_FD\").Range(\"B25\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"H50\").End(xlUp).Offset(1, 0).Select 'CHILILLO 5/8\nSelection.Value = Worksheets(\"BARRA_FD\").Range(\"B22\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"I50\").End(xlUp).Offset(1, 0).Select 'CHILILLO BISAGRA\nSelection.Value = Worksheets(\"BARRA_FD\").Range(\"B23\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"J50\").End(xlUp).Offset(1, 0).Select 'SISTEMA HORIZONTAL\nSelection.Value = \"0\"\nWorksheets(\"HERRAJE\").Select\nRange(\"K50\").End(xlUp).Offset(1, 0).Select 'MINIFIX\nSelection.Value = \"0\"\nSheets(\"BARRA_FD\").Visible = False\nElseIf Cells(2, 6) = \"PANTRY COMUN\" Then\nSheets(\"DATOS GENERALES\").Select\nRange(\"F4:N22\").Cells.ClearFormats\nRange(\"F4:N22\").Cells.ClearContents\nSheets(\"PANTRY_COMUN\").Visible = True\nSheets(\"PANTRY_COMUN\").Select\nRange(\"A2:I10\").Select\nSelection.Copy\nSheets(\"DATOS GENERALES\").Select\nRange(\"F4\").Select\nSelection.PasteSpecial xlPasteFormats\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n'HERRAJE\nWorksheets(\"HERRAJE\").Select\nRange(\"A50\").End(xlUp).Offset(1, 0).Select\nSelection.Value = Worksheets(\"PANTRY_COMUN\").Range(\"B24\").Value 'BISAGRA 110\nWorksheets(\"HERRAJE\").Select\nRange(\"B50\").End(xlUp).Offset(1, 0).Select 'BISAGRA 170\nSelection.Value = \"0\"\nWorksheets(\"HERRAJE\").Select\nRange(\"C50\").End(xlUp).Offset(1, 0).Select 'BISAGRA UNION\nSelection.Value = \"0\"\nWorksheets(\"HERRAJE\").Select\nRange(\"L50\").End(xlUp).Offset(1, 0).Select 'BISAGRA 45\nSelection.Value = \"0\"\nWorksheets(\"HERRAJE\").Select\nRange(\"M50\").End(xlUp).Offset(1, 0).Select 'PINS\nSelection.Value = Worksheets(\"PANTRY_COMUN\").Range(\"B28\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"D50\").End(xlUp).Offset(1, 0).Select 'RIEL\nSelection.Value = \"0\"\nWorksheets(\"HERRAJE\").Select\nRange(\"E50\").End(xlUp).Offset(1, 0).Select 'PATAS\nSelection.Value = Worksheets(\"PANTRY_COMUN\").Range(\"B21\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"F50\").End(xlUp).Offset(1, 0).Select 'CONFIRMATS\nSelection.Value = Worksheets(\"PANTRY_COMUN\").Range(\"B20\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"G50\").End(xlUp).Offset(1, 0).Select 'JALADERAS\nSelection.Value = Worksheets(\"PANTRY_COMUN\").Range(\"B25\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"H50\").End(xlUp).Offset(1, 0).Select 'CHILILLO 5/8\nSelection.Value = Worksheets(\"PANTRY_COMUN\").Range(\"B22\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"I50\").End(xlUp).Offset(1, 0).Select 'CHILILLO BISAGRA\nSelection.Value = Worksheets(\"PANTRY_COMUN\").Range(\"B23\").Value\nWorksheets(\"HERRAJE\").Select\nRange(\"J50\").End(xlUp).Offset(1, 0).Select 'SISTEMA HORIZONTAL\nSelection.Value = \"0\"\nWorksheets(\"HERRAJE\").Select\nRange(\"K50\").End(xlUp).Offset(1, 0).Select 'MINIFIX\nSelection.Value = \"0\"\nSheets(\"PANTRY_COMUN\").Visible = False\n\nElse\nSheets(\"DATOS GENERALES\").Select\nRange(\"F4:N22\").Cells.ClearFormats\nRange(\"F4:N22\").Cells.ClearContents\nEnd If\n\nApplication.CutCopyMode = False\nActiveWorkbook.Save\n\n'Copiar y pegar en carrito\n\nDim Target As Range\n\nWith Worksheets(\"DATOS GENERALES\")\n    Set Target = Sheets(\"CARRITO\").Range(\"B1\").End(xlDown).Offset(1)\n    .Range(\"F4:N20\").Copy\n\n    Target.Offset(0, -1).Value =   WorksheetFunction.Max(Sheets(\"CARRITO\").Columns(1)) + 1\n\n    Target.PasteSpecial xlPasteFormats\n    Target.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _\n                           False, Transpose:=False\n\n    .Range(\"F4:N22\").Cells.ClearContents\n    .Range(\"F4:N20\").ClearFormats\n    .Range(\"F4:N22,F2:G2,Q1:Q16,H2:I2\").ClearContents\nEnd with\n\n'////////////////\n\n'Copiar y pegar de carrito a \"LISTBOX\"\nSheets(\"CARRITO\").Visible = True\nSheets(\"CARRITO\").Select\nRange(\"A1000\").End(xlUp).Select\nActiveCell.Resize(1, 2).Copy\nSheets(\"LISTBOX\").Visible = True\nSheets(\"LISTBOX\").Select\nlMaxRows = Cells(Rows.Count, \"D\").End(xlUp).Row\nRange(\"D\" &amp; lMaxRows + 1).Select\nSelection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _\n        False, Transpose:=False\nSheets(\"LISTBOX\").Visible = False\nSheets(\"CARRITO\").Visible = False\n'///////////////\nSheets(\"DATOS GENERALES\").Select\nRange(\"F4:N22\").Cells.ClearContents\nApplication.CutCopyMode = False\nSheets(\"DATOS GENERALES\").Range(\"F4:N20\").ClearFormats\nRange(\"F2:G2\").Cells.ClearContents\nRange(\"Q1:Q16\").Cells.ClearContents\nRange(\"H2:I2\").Cells.ClearContents\n\n'Listbox1 Agregar Articulo\n\nListBox1.ListIndex = ListBox1.ListIndex\nListBox2.ListIndex = ListBox2.ListIndex\n\n\n'//////////////\nWorksheets(\"HERRAJE\").Visible = False\n\n\n\nApplication.ScreenUpdating = True\nerrHandler:\nApplication.ScreenUpdating = True\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "email", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 6529044, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a5777b5404380740d92e4975ebac8e6e?s=128&d=identicon&r=PG&f=1", "display_name": "markos", "link": "https://stackoverflow.com/users/6529044/markos"}, "edited": false, "score": 0, "creation_date": 1469623653, "post_id": 38600459, "comment_id": 64612988, "body": "Very odd but when I type in the name of the distribution list I get: &quot;Outlook does not recognize one or more names&quot;"}], "tags": [], "owner": {"reputation": 32943, "user_id": 765226, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/b0Qnm.jpg?s=128&g=1", "display_name": "Alexis Olson", "link": "https://stackoverflow.com/users/765226/alexis-olson"}, "is_accepted": false, "score": 0, "last_activity_date": 1469577834, "last_edit_date": 1495535325, "creation_date": 1469569834, "answer_id": 38600459, "question_id": 38599755, "link": "https://stackoverflow.com/questions/38599755/sending-email-to-distribution-list-using-outlook/38600459#38600459", "title": "Sending email to distribution list using Outlook", "body": "<p>You should be able to use the name of the distribution list in the <code>.BCC</code> line, but I haven't tested this.</p>\n\n<pre><code>.BCC = \"Daily Matrix\"\n</code></pre>\n\n<p>For more information, see <a href=\"https://stackoverflow.com/questions/10049419/how-to-access-contact-groups-in-excel-vba\">here</a> and <a href=\"http://www.rondebruin.nl/win/s1/outlook/tips.htm\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 35, "user_id": 6529044, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a5777b5404380740d92e4975ebac8e6e?s=128&d=identicon&r=PG&f=1", "display_name": "markos", "link": "https://stackoverflow.com/users/6529044/markos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1384, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1469773788, "creation_date": 1469566651, "last_edit_date": 1469575158, "question_id": 38599755, "link": "https://stackoverflow.com/questions/38599755/sending-email-to-distribution-list-using-outlook", "title": "Sending email to distribution list using Outlook", "body": "<p>I currently have code that works perfectly  that  sends the active workbook I have open to whoever I specify. </p>\n\n<p>However, I would like to send the workbook to a distribution list in my outlook contacts called \"Daily Matrix\" and want to BCC them. I am not sure how to do that and help would be appreciated. Thanks!</p>\n\n<pre><code>Sub Mail_Workbook_1()\nDim OutApp As Object\nDim OutMail As Object\n\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\n\nOn Error Resume Next\nWith OutMail\n    .To = \"\"\n    .CC = \"\"\n    .BCC = \"\"\n    .Subject = \"Daily Matrix\"\n    .Body = \"PLEASE DO NOT DISTRIBUTE-FOR INTERNAL USE ONLY\"\n    .Attachments.Add ActiveWorkbook.FullName\n    ' You can add other files by uncommenting the following line.\n    '.Attachments.Add (\"C:\\test.txt\")\n    ' In place of the following statement, you can use \".Display\" to\n    ' display the mail.\n    .Send\nEnd With\nOn Error GoTo 0\n\nSet OutMail = Nothing\nSet OutApp = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 3, "creation_date": 1469564402, "post_id": 38599167, "comment_id": 64586305, "body": "1) write code 2) execute code 3) debug code. We help with #3. #1-2 are entirely YOUR responsibility."}, {"owner": {"reputation": 1, "user_id": 6461691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d895d3141b87e2ecb280afb378d75cd1?s=128&d=identicon&r=PG&f=1", "display_name": "Imad Ali", "link": "https://stackoverflow.com/users/6461691/imad-ali"}, "reply_to_user": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 0, "creation_date": 1469564606, "post_id": 38599167, "comment_id": 64586406, "body": "Ok, sorry. I had come up with the following, but it isn&#39;t working:  Sub HideRow()  Dim i As Long  Dim LASTROW As Long  Application.ScreenUpdating = False  LASTROW = Cells(Rows.Count, 2).End(xlUp).Row  For i = 1 To LASTROW If Range(&quot;C&quot; &amp; i).Interior.ColorIndex = 3 Then Range(&quot;C&quot; &amp; i).EntireRow.Hidden = True End If Next &#39;i Application.ScreenUpdating = True  End Sub"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1469564709, "post_id": 38599167, "comment_id": 64586458, "body": "Please put it in the Original Post Using the <a href=\"http://stackoverflow.com/posts/38599167/edit\">edit</a>"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1469565184, "post_id": 38599167, "comment_id": 64586685, "body": "Should probably add Excel-VBA tag since I do not believe excel formulas can detect anything to do with colours."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1469565419, "post_id": 38599167, "comment_id": 64586787, "body": "How is the cell colored?  Is it through Conditional Formatting?"}, {"owner": {"reputation": 1, "user_id": 6461691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d895d3141b87e2ecb280afb378d75cd1?s=128&d=identicon&r=PG&f=1", "display_name": "Imad Ali", "link": "https://stackoverflow.com/users/6461691/imad-ali"}, "edited": false, "score": 0, "creation_date": 1469565510, "post_id": 38599167, "comment_id": 64586827, "body": "No, they are coloured manually by people."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1469565745, "post_id": 38599167, "comment_id": 64586950, "body": "Are you getting an error? If so on which line?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1469565859, "post_id": 38599167, "comment_id": 64587004, "body": "Just tested and the code as is works for me.  could your users be using the wrong &quot;red&quot; fill?"}, {"owner": {"reputation": 534, "user_id": 6503620, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f6qzk.png?s=128&g=1", "display_name": "lexx9999", "link": "https://stackoverflow.com/users/6503620/lexx9999"}, "edited": false, "score": 0, "creation_date": 1469566422, "post_id": 38599167, "comment_id": 64587292, "body": "You could use: lastused = ActiveSheet.UsedRange.Row + ActiveSheet.UsedRange.Rows.Count - 1"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 2, "creation_date": 1469566552, "post_id": 38599167, "comment_id": 64587365, "body": "you wrote: &quot;Currently I have the following which isn&#39;t working:&quot;  You need to be more specific at what is not working, be descriptive and detailed as all our crystal balls are in the shop getting fixed........."}, {"owner": {"reputation": 686, "user_id": 5623502, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZYRAI.gif?s=128&g=1", "display_name": "Eric K.", "link": "https://stackoverflow.com/users/5623502/eric-k"}, "edited": false, "score": 0, "creation_date": 1469593226, "post_id": 38599167, "comment_id": 64594498, "body": "you can use autofilter to filter cells are not red color"}], "answers": [{"tags": [], "owner": {"reputation": 534, "user_id": 6503620, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f6qzk.png?s=128&g=1", "display_name": "lexx9999", "link": "https://stackoverflow.com/users/6503620/lexx9999"}, "is_accepted": false, "score": 0, "last_activity_date": 1469566283, "creation_date": 1469566283, "answer_id": 38599662, "question_id": 38599167, "link": "https://stackoverflow.com/questions/38599167/hide-all-red-cells-in-excel/38599662#38599662", "title": "Hide all red cells in Excel", "body": "<p>Are you sure LASTROW is valid, Maybe you mess up columns?</p>\n\n<p>You search last row by <code>Cells(Rows.Count, 2)</code>, 2 means column B.\nBut you check color in column C  <code>Range(\"C\" &amp; i)</code>\nBTW you could just use <code>Cells(i,3)</code> instead of <code>Range(\"C\" &amp; i)</code></p>\n"}], "owner": {"reputation": 1, "user_id": 6461691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d895d3141b87e2ecb280afb378d75cd1?s=128&d=identicon&r=PG&f=1", "display_name": "Imad Ali", "link": "https://stackoverflow.com/users/6461691/imad-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1469609470, "creation_date": 1469564346, "last_edit_date": 1469609470, "question_id": 38599167, "link": "https://stackoverflow.com/questions/38599167/hide-all-red-cells-in-excel", "title": "Hide all red cells in Excel", "body": "<p>I want to hide all RED cells within a worksheet by pressing on a command button. How can I do this by using a Macro? I also want another button to unhide them. Currently I have the following which isn't working:</p>\n\n<pre><code>Sub HideRow()    \nDim i As Long    \nDim LASTROW As Long    \nApplication.ScreenUpdating = False\n\nLASTROW = Cells(Rows.Count, 2).End(xlUp).Row\n\nFor i = 1 To LASTROW    \n    If Range(\"C\" &amp; i).Interior.ColorIndex = 3 Then    \n        Range(\"C\" &amp; i).EntireRow.Hidden = True    \n    End If    \nNext i\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Thanks,</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 1, "creation_date": 1469564187, "post_id": 38599072, "comment_id": 64586198, "body": "you have to set ws2 to an actual worksheet.  Just telling VBA that it&#39;s a worksheet doesn&#39;t cut it."}, {"owner": {"reputation": 3, "user_id": 6641648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec63d0e5e1425fcc50fd6834272def30?s=128&d=identicon&r=PG&f=1", "display_name": "pietnam", "link": "https://stackoverflow.com/users/6641648/pietnam"}, "reply_to_user": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1469568643, "post_id": 38599072, "comment_id": 64588304, "body": "oops I uploaded the wrong copy. I tried ws2 = Worksheets(&quot;Sheet2&quot;) and added the ws2. to all the methods and objects, but the macro never ran. Thank you for your help though. Without the ws2. &#39;s how would you fix the code?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6641648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec63d0e5e1425fcc50fd6834272def30?s=128&d=identicon&r=PG&f=1", "display_name": "pietnam", "link": "https://stackoverflow.com/users/6641648/pietnam"}, "edited": false, "score": 0, "creation_date": 1469586850, "post_id": 38600265, "comment_id": 64593014, "body": "Thank you very much. That was such a rookie mistake on my part"}], "tags": [], "owner": {"reputation": 1394, "user_id": 3218398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n3AML.jpg?s=128&g=1", "display_name": "hstay", "link": "https://stackoverflow.com/users/3218398/hstay"}, "is_accepted": true, "score": 1, "last_activity_date": 1469568834, "creation_date": 1469568834, "answer_id": 38600265, "question_id": 38599072, "link": "https://stackoverflow.com/questions/38599072/method-range-of-object-worksheet-failed-reason/38600265#38600265", "title": "Method &#39;Range&#39; of object&#39;_Worksheet&#39; failed reason?", "body": "<p>The problem is in:</p>\n\n<pre><code>If IsEmpty(Range(ActiveCell(, 3))) = False Then\n</code></pre>\n\n<p>ActiveCell(, 3) is already a Range so :</p>\n\n<pre><code>If IsEmpty(ActiveCell(, 3)) = False Then\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6641648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec63d0e5e1425fcc50fd6834272def30?s=128&d=identicon&r=PG&f=1", "display_name": "pietnam", "link": "https://stackoverflow.com/users/6641648/pietnam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 38600265, "answer_count": 1, "score": 0, "last_activity_date": 1469568834, "creation_date": 1469564012, "last_edit_date": 1469568341, "question_id": 38599072, "link": "https://stackoverflow.com/questions/38599072/method-range-of-object-worksheet-failed-reason", "title": "Method &#39;Range&#39; of object&#39;_Worksheet&#39; failed reason?", "body": "<pre><code>Sub tcptiff()\n\nDim TCP As String\nDim eebo As String\nDim tiff As String\nDim facpage As String\n\nOn Error GoTo Errorcatch\n\nTCP = Range(\"F1\").Value\ntiff = Range(\"F2\").Value\neebo = ActiveCell(0, 0).Value\nfacpage = ActiveCell(, 3).Value\n\nIf IsEmpty(Range(ActiveCell(, 3))) = False Then\n    If Len(eebo) = 2 Then\n        ActiveCell(, 1).Value = TCP &amp; \"-\" &amp; \"00\" &amp; Left(eebo, 1) &amp; \"-\" &amp; Right(eebo, 1)\n        ActiveCell(, 2).Value = tiff &amp; \"_Page_\" &amp; facpage\n\n    ElseIf Len(eebo) = 3 Then\n        ActiveCell(, 1).Value = TCP &amp; \"-\" &amp; \"0\" &amp; Left(eebo, 2) &amp; \"-\" &amp; Right(eebo, 1)\n        ActiveCell(, 2).Value = tiff &amp; \"_Page_\" &amp; facpage\n    End If\n\nEnd If\n\nErrorcatch:\nMsgBox Err.Description\n\nEnd Sub\n</code></pre>\n\n<p>I'm trying to write an excel macro so that it fills out two columns with relevant information from adjacent cells. I wrote the macro in Sheet2 Code. I keep getting Method 'Range' of object'_Worksheet' failed. What is the problem? I tried to specify the worksheet, but that doesn't fix the problem.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "edited": false, "score": 2, "creation_date": 1469562485, "post_id": 38598648, "comment_id": 64585307, "body": "Thousands of ActiveX controls?"}, {"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 0, "creation_date": 1469562877, "post_id": 38598648, "comment_id": 64585497, "body": "MrTryHard, great name!... ahem. First try Debug &gt; Compile... . Also CUT all the code in notebook, then save close and open the project, then paste it back in to the modules. Long shot options."}, {"owner": {"reputation": 3, "user_id": 6235522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/046306eb0679a95daff5d58b0929574f?s=128&d=identicon&r=PG&f=1", "display_name": "MrTryHard", "link": "https://stackoverflow.com/users/6235522/mrtryhard"}, "edited": false, "score": 0, "creation_date": 1469563043, "post_id": 38598648, "comment_id": 64585578, "body": "Lynn: hundreds for sure."}, {"owner": {"reputation": 3, "user_id": 6235522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/046306eb0679a95daff5d58b0929574f?s=128&d=identicon&r=PG&f=1", "display_name": "MrTryHard", "link": "https://stackoverflow.com/users/6235522/mrtryhard"}, "edited": false, "score": 1, "creation_date": 1469563127, "post_id": 38598648, "comment_id": 64585619, "body": "pnuts: I would have to transfer all their answers. It was my final option but that doesn&#39;t prevent it from happening again and it gives me no understanding of the problem."}, {"owner": {"reputation": 3, "user_id": 6235522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/046306eb0679a95daff5d58b0929574f?s=128&d=identicon&r=PG&f=1", "display_name": "MrTryHard", "link": "https://stackoverflow.com/users/6235522/mrtryhard"}, "edited": false, "score": 0, "creation_date": 1469563159, "post_id": 38598648, "comment_id": 64585640, "body": "Gary: I will try this tomorow. Any idea why it happened?"}, {"owner": {"reputation": 3, "user_id": 6235522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/046306eb0679a95daff5d58b0929574f?s=128&d=identicon&r=PG&f=1", "display_name": "MrTryHard", "link": "https://stackoverflow.com/users/6235522/mrtryhard"}, "reply_to_user": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 1, "creation_date": 1469624293, "post_id": 38598648, "comment_id": 64613529, "body": "@GaryEvans I saved the workbook in xlsx and copy/pasted all my macros, transfered the forms and modules back then savec it back to xlsm and now the buttons call the macros (which is pretty much what you suggested). It works now, so thanks a lot for your help. Do you think it happened because the user was not using the same version of excel as me?"}, {"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 1, "creation_date": 1469624761, "post_id": 38598648, "comment_id": 64613908, "body": "You&#39;ll find people will advise to not code while debugging, I.e. don&#39;t use F8 and write/fix the code as you go because this can cause odd behaviour, for example it can leave a ghost break point where there is no break point. When it happened to me this is what I done to &#39;fix&#39; the VBA storage area (its not called that but I can&#39;t think of a better way to describe it). But the version thing could be the issue too. Could you write up the details of how you fixed it as the answer? it could help people in the future"}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 6235522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/046306eb0679a95daff5d58b0929574f?s=128&d=identicon&r=PG&f=1", "display_name": "MrTryHard", "link": "https://stackoverflow.com/users/6235522/mrtryhard"}, "is_accepted": true, "score": 0, "last_activity_date": 1469624787, "creation_date": 1469624787, "answer_id": 38613862, "question_id": 38598648, "link": "https://stackoverflow.com/questions/38598648/run-time-error-32809-and-active-x-controls-changed-name/38613862#38613862", "title": "Run-time Error &#39;32809&#39; and Active X controls changed name", "body": "<p>I saved the workbook in .xlsx and copy/pasted all my macros back, transfered the forms and modules back then saved it back to .xlsm and now the buttons call the macros and no run time errors occur anymore.</p>\n"}], "owner": {"reputation": 3, "user_id": 6235522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/046306eb0679a95daff5d58b0929574f?s=128&d=identicon&r=PG&f=1", "display_name": "MrTryHard", "link": "https://stackoverflow.com/users/6235522/mrtryhard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 563, "favorite_count": 0, "accepted_answer_id": 38613862, "answer_count": 1, "score": 0, "last_activity_date": 1469624787, "creation_date": 1469562335, "question_id": 38598648, "link": "https://stackoverflow.com/questions/38598648/run-time-error-32809-and-active-x-controls-changed-name", "title": "Run-time Error &#39;32809&#39; and Active X controls changed name", "body": "<p>Huge problem here. I sent an excel form (a workbook with several sheets, thousands of active x controls and many many macros) to several people that they need to fill and return to me. Only one of the completed form I received is now completely impossible to use. All active X controls have changed name. If I select one I see the old name, but if I click on it the macro doesn't start and if I try to see its code it opens a new empty Macro with the new control name_click (Ex: a button called cmd_button1 opens a Macro called cmd_button2_click). When I start the Macro in VBA, I get the Run-time Error '32809' every time the code wants to unprotect sheets or to change the visible value of a sheet.</p>\n\n<p>I looked on other posts and every solution I found would require a huge amount of work. What happened? Is there an easy solution to this?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["arrays", "excel", "vba", "userform"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 6627076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4082b18574636ba737bab9633c4b913?s=128&d=identicon&r=PG&f=1", "display_name": "sglowats", "link": "https://stackoverflow.com/users/6627076/sglowats"}, "is_accepted": false, "score": 0, "last_activity_date": 1469639446, "creation_date": 1469639446, "answer_id": 38619288, "question_id": 38598229, "link": "https://stackoverflow.com/questions/38598229/vba-excel-2013-assign-array-values-from-another-userform/38619288#38619288", "title": "VBA Excel 2013: Assign Array Values from Another UserForm", "body": "<p>I believe I found my solution.  I had to declare the array in the module containing the code to start the program as a public variable.  After I did that and modified the code, the values were written properly to the array.</p>\n\n<p>If anyone has other solutions, though, I would like to know.  I'm not that experienced with VBA, so I want to hear other solutions.</p>\n"}], "owner": {"reputation": 11, "user_id": 6627076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4082b18574636ba737bab9633c4b913?s=128&d=identicon&r=PG&f=1", "display_name": "sglowats", "link": "https://stackoverflow.com/users/6627076/sglowats"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 476, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1469639446, "creation_date": 1469560848, "question_id": 38598229, "link": "https://stackoverflow.com/questions/38598229/vba-excel-2013-assign-array-values-from-another-userform", "title": "VBA Excel 2013: Assign Array Values from Another UserForm", "body": "<p>I'm relatively new to VBA.  I have a program I'm writing where the user is given the option to change their input from a 2 dimensional array in another user form.</p>\n\n<p>The first user form, UserForm1, allows the user to input the information from text fields and saves it to the respective array row, i, when pressing a Save command button.  </p>\n\n<p>When the user presses an OK command button, the user is asked if they want to add another set of data.  If they say no, they are asked if they want to change data.  If they say yes, then another user form, UserForm2, is opened.</p>\n\n<p>The code for UserForm1 is similar to the code below:</p>\n\n<pre><code>    Public MyArray as Variant, i as Integer\n\n    Sub Userform_Initialize()\n        ReDim MyArray(100,4)\n    End Sub\n\n    Sub SaveButton_click()\n        MyArray(i, 1) = TextField1.Value\n        MyArray(i, 2) = TextField2.Value\n        MyArray(i, 3) = TextField3.Value\n        MyArray(i, 4) = TextField4.Value\n    End Sub\n\n    Sub OKButton_click()\n        If msgbox(\"Do you want to add more data?\", vbYesNo) = vbNo Then\n            If msgbox(\"Do you have corrections to be made?\",vbYesNo) = vbYes Then\n                Load UserForm2\n                UserForm2.Show\n            Else:  Exit Sub\n            End If\n        Else:  i = i + 1\n            Exit Sub\n        End If\n    End Sub\n</code></pre>\n\n<p>In UserForm2, the user chooses the row number, i, from a combo box.  When the row number is selected, the array information is automatically populated in text fields from UserForm1.  </p>\n\n<p>When the user presses the Save command button, it should pass the information from the text fields and write it to the respective row.</p>\n\n<p>The code for UserForm2 is similar to the code below:</p>\n\n<pre><code>    Public j as integer\n\n    Sub Userform_Initialize()\n        For j = 1 to UserForm1.i\n            ComboBox1.AddItem (j)\n        Next\n    End Sub\n\n    Sub SaveButton_click()\n        UserForm1.MyArray(ComboBox1.Value, 1) = TextField1.Value\n        UserForm1.MyArray(ComboBox1.Value, 2) = TextField2.Value\n        UserForm1.MyArray(ComboBox1.Value, 3) = TextField3.Value\n        UserForm1.MyArray(ComboBox1.Value, 4) = TextField4.Value\n    End Sub\n</code></pre>\n\n<p>Stepping through the code, the values from MyArray should be properly referenced, and I can see the values initially saved from UserForm1.  However, the values are not changing as I step to the next line.</p>\n\n<p>Does anyone have a solution for my problem?  Thank you in advance for your help!</p>\n"}]