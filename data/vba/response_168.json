[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 171, "user_id": 4043328, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vu20F9pOfgw/AAAAAAAAAAI/AAAAAAAAAIc/1l4Z93gIZRE/photo.jpg?sz=128", "display_name": "mrsrizan", "link": "https://stackoverflow.com/users/4043328/mrsrizan"}, "edited": false, "score": 0, "creation_date": 1522279170, "post_id": 49545649, "comment_id": 86098817, "body": "What is the exact issue?"}, {"owner": {"reputation": 13, "user_id": 9566806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cde3d476b67379c12eec925b3e9563ad?s=128&d=identicon&r=PG&f=1", "display_name": "zJuanelo85", "link": "https://stackoverflow.com/users/9566806/zjuanelo85"}, "reply_to_user": {"reputation": 171, "user_id": 4043328, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vu20F9pOfgw/AAAAAAAAAAI/AAAAAAAAAIc/1l4Z93gIZRE/photo.jpg?sz=128", "display_name": "mrsrizan", "link": "https://stackoverflow.com/users/4043328/mrsrizan"}, "edited": false, "score": 0, "creation_date": 1522279661, "post_id": 49545649, "comment_id": 86098955, "body": "When trying to run it, I get the error &#39;Loop without Do&#39; even tho the Do is there and I closed the End If"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1522303090, "post_id": 49545649, "comment_id": 86105135, "body": "@zJuanelo85 read my answer below, a few other things you should consider"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9566806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cde3d476b67379c12eec925b3e9563ad?s=128&d=identicon&r=PG&f=1", "display_name": "zJuanelo85", "link": "https://stackoverflow.com/users/9566806/zjuanelo85"}, "edited": false, "score": 0, "creation_date": 1522281252, "post_id": 49545924, "comment_id": 86099361, "body": "Thanks, I put it right before the Loop and I didn&#39;t get the error but now I got the following: Run-time error &#39;1004&#39;:Application-defined or object-defined error ... and pointed out the &#39;ActiveCell.Offset(0, -1).Select&#39; in the first Else"}, {"owner": {"reputation": 1124, "user_id": 2149093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb03f51fd573efda46453d9b928de5e2?s=128&d=identicon&r=PG", "display_name": "Stanislas", "link": "https://stackoverflow.com/users/2149093/stanislas"}, "reply_to_user": {"reputation": 13, "user_id": 9566806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cde3d476b67379c12eec925b3e9563ad?s=128&d=identicon&r=PG&f=1", "display_name": "zJuanelo85", "link": "https://stackoverflow.com/users/9566806/zjuanelo85"}, "edited": false, "score": 0, "creation_date": 1522281888, "post_id": 49545924, "comment_id": 86099515, "body": "Make sure that ActiveCrll is on the active Worksheet. Make sure that your Offset doesn&#39;t cause impossible vales (use debug).In general avoid using <code>Select</code>, see: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using select in Excel VBA</a>"}], "tags": [], "owner": {"reputation": 1124, "user_id": 2149093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb03f51fd573efda46453d9b928de5e2?s=128&d=identicon&r=PG", "display_name": "Stanislas", "link": "https://stackoverflow.com/users/2149093/stanislas"}, "is_accepted": true, "score": 1, "last_activity_date": 1522280899, "creation_date": 1522280899, "answer_id": 49545924, "question_id": 49545649, "link": "https://stackoverflow.com/questions/49545649/loop-without-do-but-i-do/49545924#49545924", "title": "Loop without Do... but i do", "body": "<p>You're missing an <code>End With</code> statement, which is equivalent to forgetting an <code>End If</code>-statement as you pointed out yourself.</p>\n\n<p><em>Side note: I would discourage using <code>GoTo</code>-statements as they make code harder to read and maintain.</em></p>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1522302868, "creation_date": 1522302868, "answer_id": 49548945, "question_id": 49545649, "link": "https://stackoverflow.com/questions/49545649/loop-without-do-but-i-do/49548945#49548945", "title": "Loop without Do... but i do", "body": "<p>The reason for you error already got an answer in @Stanislas answer above.</p>\n\n<p>However, there are a lot other thing you should avoid in your VBA code, like how to avoid using <code>Select</code>, and <code>ActiveCell</code>, instead use fully qualified objects.</p>\n\n<p>Example, in your code you have :</p>\n\n<pre><code>Sheets(\"Edit Multiple Subscribers\").Select\nActiveSheet.Cells(i, 2).Select\nActiveCell.Offset(0, -1).Select\nActiveCell.Value = NewName\n</code></pre>\n\n<p>This could be replaced with:</p>\n\n<pre><code>Sheets(\"Edit Multiple Subscribers\").Cells(i, 2).Offset(0, -1).Value = NewName\n</code></pre>\n\n<p>which is not only shorter, but the code will run a lot faster.</p>\n\n<p><strong>Another issue</strong>: you have <code>Dim i, total As Integer</code> which means <code>total As Integer</code> but <code>i</code> is actually <code>Variant</code>. You need to define each one explicitly : <code>Dim i As Long, total As Long</code> , I am using <code>Long</code> since it's safer than <code>Integer</code> (can take higher values), and with Windows based x64 systems, they take just as much as memory.</p>\n\n<hr>\n\n<p>Implementing a few other small modifications, your code could look a little like this:</p>\n\n<pre><code>Option Explicit  ' &lt;--- get used to add this at the top of your code\n\nSub update_names()\n\nDim EMAIL As String, NewName As String\nDim i As Long, total As Long\nDim Search As Range\n\ntotal = 0\ni = 2024\nDo While i &lt; 2048\n    With Sheets(\"Edit Multiple Subscribers\")\n        EMAIL = .Cells(i, 2).Value\n        NewName = .Cells(i, 1).Value\n    End With\n\n    With Worksheets(\"MASTER\")\n        Set Search = .Cells.Find(EMAIL, LookIn:=xlValues)\n        If Search Is Nothing Then\n            Sheets(\"Edit Multiple Subscribers\").Cells(i, 2).Interior.Color = RGB(250, 0, 250)\n        Else\n            If Search.Offset(0, -1).Value &lt;&gt; NewName Then\n                NewName = Search.Value\n\n                Sheets(\"Edit Multiple Subscribers\").Cells(i, 2).Offset(0, -1).Value = NewName\n                total = total + 1\n            End If\n        End If\n    End With\n\n    i = i + 1\nLoop\n\nMsgBox \"Number Of edits: \" &amp; total\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9566806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cde3d476b67379c12eec925b3e9563ad?s=128&d=identicon&r=PG&f=1", "display_name": "zJuanelo85", "link": "https://stackoverflow.com/users/9566806/zjuanelo85"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 49545924, "answer_count": 2, "score": -1, "last_activity_date": 1522302868, "creation_date": 1522278937, "last_edit_date": 1522302209, "question_id": 49545649, "link": "https://stackoverflow.com/questions/49545649/loop-without-do-but-i-do", "title": "Loop without Do... but i do", "body": "<p>I know this has been asked many times but I keep reading and cant get it right. I have included all the necessary <code>End If</code> and the <code>Do</code> is there for my <code>Loop</code>.</p>\n\n<p><strong><em>My Code</em></strong></p>\n\n<pre><code>Sub update_names()\n\nDim EMAIL, NewName As String\nDim i, total As Integer\nDim Search As Range\n\ntotal = 0\ni = 2024\nDo While i &lt; 2048\n    Sheets(\"Edit Multiple Subscribers\").Select\n    EMAIL = Cells(i, 2).Value\n    NewName = Cells(i, 1).Value\n\n    Sheets(\"MASTER\").Select\n    With Worksheets(\"MASTER\").Cells\n        Set Search = .Find(EMAIL, LookIn:=xlValues, After:=ActiveCell)\n            If Search Is Nothing Then\n                Sheets(\"Edit Multiple Subscribers\").Select\n                Cells(i, 2).Interior.Color = RGB(250, 0, 250)\n                GoTo Add1\n            Else:\n                Search.Select\n                ActiveCell.Offset(0, -1).Select\n                If ActiveCell.Value = NewName Then\n                    GoTo Add1\n                Else:\n                    NewName = ActiveCell.Value\n                End If\n            End If\n        Sheets(\"Edit Multiple Subscribers\").Select\n\n        ActiveSheet.Cells(i, 2).Select\n        ActiveCell.Offset(0, -1).Select\n        ActiveCell.Value = NewName\n\n        total = total + 1\n\nAdd1:         i = i + 1\n\nLoop\n\nMsgBox \"Number Of edits: \" &amp; total\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "listobject"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1522279190, "post_id": 49545461, "comment_id": 86098824, "body": "What&#39;s <code>Sheet02</code>?  Where do you declare that?  You need something like <code>Worksheets(&quot;Sheet02&quot;).Cells(...)</code> or <code>Dim Sheet02 as Worksheet &#47;&#47; Set Sheet02 = Worksheets(&quot;Sheet2&quot;)</code>, no?"}, {"owner": {"reputation": 21, "user_id": 9566745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3fcdfda71562f3ec7598dabf2dd9177?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/9566745/john-smith"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1522338290, "post_id": 49545461, "comment_id": 86128219, "body": "As explained below, you can refer to Sheet codenames directly. Renamed in this way, because reasons - including but not limited to changing display names of sheets and (kinda OCD) ordering of the important ones in VBA editor."}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1522279953, "post_id": 49545759, "comment_id": 86099024, "body": "I don&#39;t believe <code>Sheet02</code> is a valid VBA reference."}, {"owner": {"reputation": 329, "user_id": 6322229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fee9a5c1946abcf7c3d4d91c1549ae54?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Anstead", "link": "https://stackoverflow.com/users/6322229/josh-anstead"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1522280306, "post_id": 49545759, "comment_id": 86099123, "body": "You are allowed to modify that in the sheet&#39;s properties to any name you would like. Much like naming a range to something other than &quot;A1&quot;.  I have to assume that is what he did. Or you would be correct that Sheet02 should be something like Sheets(2)."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1522280426, "post_id": 49545759, "comment_id": 86099156, "body": "Oh I never knew that you could rename the sheet in the Properties.  I wonder why one would do that, instead of renaming the sheet altogether. ...but that&#39;s a different question entirely.  Thanks for your comment!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1522306171, "post_id": 49545759, "comment_id": 86106506, "body": "Referring to the sheet codename property <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheet-codename-property-excel\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/vba/excel-vba/articles/&hellip;</a>"}, {"owner": {"reputation": 21, "user_id": 9566745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3fcdfda71562f3ec7598dabf2dd9177?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/9566745/john-smith"}, "edited": false, "score": 0, "creation_date": 1522337801, "post_id": 49545759, "comment_id": 86127919, "body": "Oooh my god. I found my problem. I removed my older comments as to not waste anyones time more than needed, here&#39;s what happened: I used <b>QueryTables.Add</b> to import data from a <b>.CSV file</b> before resizing, and had to add code to <b>remove the links it automatically creates</b> in excel (to refresh the data on its own) when doing so. I did, and it worked fine, I just forgot I used <i>For Each queryConnec In <b>ActiveSheet</b>.QueryTables, queryConnec.Delete</i> ... and ActiveSheet was <b>not</b> Sheet02 anymore, of course... so, the table clashed with the existing query connection within those cells...!"}, {"owner": {"reputation": 21, "user_id": 9566745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3fcdfda71562f3ec7598dabf2dd9177?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/9566745/john-smith"}, "edited": false, "score": 0, "creation_date": 1522339721, "post_id": 49545759, "comment_id": 86129174, "body": "But that&#39;s some nice, outside-the-box thinking either way, so here, have a point!"}], "tags": [], "owner": {"reputation": 329, "user_id": 6322229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fee9a5c1946abcf7c3d4d91c1549ae54?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Anstead", "link": "https://stackoverflow.com/users/6322229/josh-anstead"}, "is_accepted": false, "score": 0, "last_activity_date": 1522280817, "last_edit_date": 1522280817, "creation_date": 1522279569, "answer_id": 49545759, "question_id": 49545461, "link": "https://stackoverflow.com/questions/49545461/excel-2013-vba-listobject-table-resize-wont-work/49545759#49545759", "title": "Excel 2013 VBA ListObject Table Resize won&#39;t work", "body": "<p>Try not updating the screen and changing the focus to sheet02. Next, make your change to sheet02. Finally, return the focus to whatever sheet you were on.</p>\n\n<pre><code>Function Resize()\nLet Application.ScreenUpdating = False\n\nDim Current_Worksheet As Worksheet\nDim Sheet_02 As Worksheet\n\nSet Current_Worksheet = ActiveSheet\n\nSet Sheet_02 = Sheet02\n\nLet lastRow = Sheet_02.Cells(Rows.Count, \"G\").End(xlUp).Row\nLet newRange = \"$A1:$G$\" &amp; lastRow\n\nCall Sheet_02.Activate\nDoEvents\nSheet_02.ListObjects(\"tblDb\").Resize Range(newRange)\nDoEvents\nCall Current_Worksheet.Activate\n\nLet Application.ScreenUpdating = True\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 9566745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3fcdfda71562f3ec7598dabf2dd9177?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/9566745/john-smith"}, "is_accepted": true, "score": 1, "last_activity_date": 1522339367, "creation_date": 1522339367, "answer_id": 49560507, "question_id": 49545461, "link": "https://stackoverflow.com/questions/49545461/excel-2013-vba-listobject-table-resize-wont-work/49560507#49560507", "title": "Excel 2013 VBA ListObject Table Resize won&#39;t work", "body": "<p>After running some more tests with data below the table <em>put there by hand</em> revealed no issues with any errors whatsoever - not within the sheet, nor from outside of it.</p>\n\n<p>The problem in my case was as follows:</p>\n\n<p>I was <strong>importing data from a .CSV file by using QueryTables.Add</strong>, utilizing the import utility Excel comes with. Turns out in doing so, it <strong>creates a Query Connection</strong>, a live \"Link\" to the file you imported, so it can automatically update itself with new data from that file should it change.</p>\n\n<p>Using the import within the existing Table object in Excel didn't work, because <strong>Table objects and Query Connection content don't get along</strong> particularly well, as it turns out. At this point you might realize where this is going.</p>\n\n<p>So I expanded the code to import from the .CSV just below the table, then proceeded to remove the Query Connection from the sheet, and resize the table over the now disconnected, plain text contents of the imported .CSV file.</p>\n\n<p>The ImportCSV function just so happened to include this particular snippet of code:</p>\n\n<pre><code>For Each queryConnec In ActiveSheet.QueryTables\n  queryConnec.Delete\nNext queryConnec\n</code></pre>\n\n<p>And that's the reason why it worked within the Sheet - because I <strong>imported</strong> from within the sheet and the <strong>Query Connections have been removed</strong> in doing so. When <strong>importing from outside</strong> the sheet, the Query Connections were of course <strong>not removed</strong>, which is why resizing the Table over the live Query Connection content threw an error...</p>\n\n<p>Fixed easily by:</p>\n\n<pre><code>For Each queryConnec In Sheet02.QueryTables\n  queryConnec.Delete\nNext queryConnec\n</code></pre>\n\n<p><strong>tl;dr: A tiny oversight for a programmer, turned into a huge issue for Excel.</strong></p>\n"}], "owner": {"reputation": 21, "user_id": 9566745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3fcdfda71562f3ec7598dabf2dd9177?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/9566745/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1346, "favorite_count": 0, "accepted_answer_id": 49560507, "answer_count": 2, "score": 1, "last_activity_date": 1522339367, "creation_date": 1522277726, "question_id": 49545461, "link": "https://stackoverflow.com/questions/49545461/excel-2013-vba-listobject-table-resize-wont-work", "title": "Excel 2013 VBA ListObject Table Resize won&#39;t work", "body": "<p>I'm trying to dynamically resize a ListObject table after pasting data in the rows below with VBA. Resizing works fine as long as Sheet02, where it happens, is the active sheet - but throws an error when Sheet02 is not the active sheet. What am I missing?</p>\n\n<p><strong>Code snippet:</strong></p>\n\n<pre><code>Function Resize()\n  lastRow = Sheet02.Cells(Rows.Count, \"G\").End(xlUp).Row\n  newRange = \"$A1:$G$\" &amp; lastRow\n  Sheet02.ListObjects(\"tblDb\").Resize Range(newRange)\nEnd Function\n</code></pre>\n\n<p><strong>The Error:</strong> <em>Run-time error '1004': Application-defined or object-defined error</em></p>\n"}, {"tags": ["vba", "excel", "loops"], "comments": [{"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 1, "creation_date": 1522278595, "post_id": 49545341, "comment_id": 86098675, "body": "Change <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/application-evaluate-method-excel\" rel=\"nofollow noreferrer\"><code>Evaluate</code></a> to <a href=\"https://msdn.microsoft.com/en-us/library/office/aa220716(v=office.11).aspx\" rel=\"nofollow noreferrer\"><code>Application.Run</code></a>, and change <code>(Module1.TestSub)</code> to <code>&quot;Module1.TestSub&quot;</code> - because <code>Module1.TestSub</code> is not a Function, it doesn&#39;t return anything, so your <code>MyAction</code> string will be blank (check that with <code>Debug.Print myAction</code>)"}, {"owner": {"reputation": 1, "user_id": 9566528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ebc209f04e9fbc9fda935778b08d718?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew", "link": "https://stackoverflow.com/users/9566528/matthew"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1522285329, "post_id": 49545341, "comment_id": 86100350, "body": "Perfect! Thank you, @Chronocidal !"}], "owner": {"reputation": 1, "user_id": 9566528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ebc209f04e9fbc9fda935778b08d718?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew", "link": "https://stackoverflow.com/users/9566528/matthew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1522277085, "creation_date": 1522277085, "question_id": 49545341, "link": "https://stackoverflow.com/questions/49545341/excel-vba-in-a-loop-why-am-i-losing-my-active-workbook-when-i-evaluate-another", "title": "Excel VBA: In a loop, why am I losing my active workbook when I evaluate another sub?", "body": "<p>I am modifying a function for looping through all workbooks in a folder and performing an action on each.</p>\n\n<p>In the code below, if I un-comment the <code>Module1.TestSub</code> line, the loop performs TestSub on each file in the chosen folder, as expected.</p>\n\n<p>But I want it to work as a function, taking another sub or function as it's argument and performing that on the loop, so that I could run <code>LoopThroughWorkbooks (Module1.TestSub)</code> and not have to edit LoopThroughWorkbooks every time I want to loop a different action.</p>\n\n<p>If I instead un-comment the <code>Evaluate (myAction)</code> line, it seems to still loop through the intended files doing nothing, and performs <code>Module1.TestSub</code> on the file I had active to begin with.</p>\n\n<p>It seems like the <code>Evaluate (myAction)</code> line is losing track of the workbook opened by the loop in a way that doesn't happen when I just explicitly call <code>Module1.TestSub</code>.</p>\n\n<pre><code>Function LoopThroughWorkbooks(myAction As String)\n'PURPOSE: To loop through all xls* files in a user specified folder and perform an action\n'SOURCE: www.TheSpreadsheetGuru.com\n\n Dim wb As Workbook\n Dim myPath As String\n Dim myFile As String\n Dim myExtension As String\n Dim FldrPicker As FileDialog\n\n'Optimize Macro Speed\n Application.ScreenUpdating = False\n Application.EnableEvents = False\n Application.Calculation = xlCalculationManual\n\n'Retrieve Target Folder Path From User\n Set FldrPicker = Application.FileDialog(msoFileDialogFolderPicker)\n   With FldrPicker\n    .Title = \"Select A Target Folder\"\n    .AllowMultiSelect = False\n     If .Show &lt;&gt; -1 Then GoTo NextCode\n     myPath = .SelectedItems(1) &amp; \"\\\"\n   End With\n\n'In Case of Cancel\nNextCode:\n myPath = myPath\n If myPath = \"\" Then GoTo ResetSettings\n\n'Target File Extension (must include wildcard \"*\")\n myExtension = \"*.xls*\"\n\n'Target Path with Ending Extention\n myFile = Dir(myPath &amp; myExtension)\n\n'Loop through each Excel file in folder\n Do While myFile &lt;&gt; \"\"\n  'Set variable equal to opened workbook\n   Set wb = Workbooks.Open(Filename:=myPath &amp; myFile)\n\n  'Ensure Workbook has opened before moving on to next line of code\n   DoEvents\n\n  'Do Action Specified in Argument\n   'Module1.TestSub &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; This line works\n\n   'Evaluate (myAction) &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; This line doesn't\n\n  'Save and Close Workbook\n   wb.Close SaveChanges:=True\n\n  'Ensure Workbook has closed before moving on to next line of code\n   DoEvents\n\n  'Get next file name\n   myFile = Dir\n\n Loop\n\n'Message Box when tasks are completed\n MsgBox \"Looping Complete!\"\n\n'Reset Macro Optimization Settings\nResetSettings:\n Application.EnableEvents = True\n Application.Calculation = xlCalculationAutomatic\n Application.ScreenUpdating = True\n\nEnd Function\n</code></pre>\n\n<p>And in case it's helpful, here's Module1.TestSub:</p>\n\n<pre><code>Function TestSub()\n\nRange(\"A1\") = \"AAA\"\n\nEnd Function\n</code></pre>\n\n<p>And here's how I'm calling it:</p>\n\n<pre><code>Sub runtest()\n\nModule2.LoopThroughWorkbooks (Module1.TestSub)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1522277526, "post_id": 49545215, "comment_id": 86098399, "body": "Well I can safely assume that you are likely receiving some sort of sytax error. But you still should provide more relevant code. For example, would be nice to see the <code>wkshtArray</code> declaration, and how you assign values to it."}, {"owner": {"reputation": 9862, "user_id": 1084886, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/WSSHA.jpg?s=128&g=1", "display_name": "kad81", "link": "https://stackoverflow.com/users/1084886/kad81"}, "edited": false, "score": 0, "creation_date": 1522280464, "post_id": 49545215, "comment_id": 86099163, "body": "Hi, welcome to StackOverflow. Please be sure to state your problem clearly and ask a concise question, so that the community can best help you out. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 9566697, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5bakSMfvojY/AAAAAAAAAAI/AAAAAAAAEZQ/_oWGXJTmUXg/photo.jpg?sz=128", "display_name": "WIW Wrestling", "link": "https://stackoverflow.com/users/9566697/wiw-wrestling"}, "edited": false, "score": 0, "creation_date": 1522278245, "post_id": 49545473, "comment_id": 86098584, "body": "I&#39;m not getting anymore error messages but when I go to the cell B6 on my &quot;Totals&quot; sheet, no values on the other are summed up"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 31, "user_id": 9566697, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5bakSMfvojY/AAAAAAAAAAI/AAAAAAAAEZQ/_oWGXJTmUXg/photo.jpg?sz=128", "display_name": "WIW Wrestling", "link": "https://stackoverflow.com/users/9566697/wiw-wrestling"}, "edited": false, "score": 0, "creation_date": 1522278320, "post_id": 49545473, "comment_id": 86098605, "body": "What is the index of this worksheet in question? You will need to either change the index of the <code>Set tgtWs = ThisWorkbook.Worksheets(1)</code> to the proper index #, or use the sheet name instead."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 31, "user_id": 9566697, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5bakSMfvojY/AAAAAAAAAAI/AAAAAAAAEZQ/_oWGXJTmUXg/photo.jpg?sz=128", "display_name": "WIW Wrestling", "link": "https://stackoverflow.com/users/9566697/wiw-wrestling"}, "edited": false, "score": 0, "creation_date": 1522278384, "post_id": 49545473, "comment_id": 86098624, "body": "So if the sheet name is <code>Sheet4</code> where the totals go in, then that line should look like <code>... = ThisWorkbook.Worksheets(&quot;Sheet4&quot;)</code>"}, {"owner": {"reputation": 31, "user_id": 9566697, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5bakSMfvojY/AAAAAAAAAAI/AAAAAAAAEZQ/_oWGXJTmUXg/photo.jpg?sz=128", "display_name": "WIW Wrestling", "link": "https://stackoverflow.com/users/9566697/wiw-wrestling"}, "edited": false, "score": 0, "creation_date": 1522278673, "post_id": 49545473, "comment_id": 86098698, "body": "I change the name to worksheet that I want it on, but for some reason it is giving me the error code &quot;subscript out of range&quot;"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 31, "user_id": 9566697, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5bakSMfvojY/AAAAAAAAAAI/AAAAAAAAEZQ/_oWGXJTmUXg/photo.jpg?sz=128", "display_name": "WIW Wrestling", "link": "https://stackoverflow.com/users/9566697/wiw-wrestling"}, "edited": false, "score": 0, "creation_date": 1522278797, "post_id": 49545473, "comment_id": 86098723, "body": "Are you still using your array? You shouldn&#39;t have to now. This exact code as written should work (with the exception of the sheet name). There isn&#39;t anything in the code that would raise that error. What is the sheet name and I will edit my answer and it should be as simple as copying and pasting :)"}, {"owner": {"reputation": 31, "user_id": 9566697, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5bakSMfvojY/AAAAAAAAAAI/AAAAAAAAEZQ/_oWGXJTmUXg/photo.jpg?sz=128", "display_name": "WIW Wrestling", "link": "https://stackoverflow.com/users/9566697/wiw-wrestling"}, "edited": false, "score": 0, "creation_date": 1522279110, "post_id": 49545473, "comment_id": 86098796, "body": "No I am not using the array. The sheet name that I want the sum product in is (&quot;YTD&quot; &amp; yearNum). yearNum is a variable that is defined by the user when they enter a year in my inputbox"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 31, "user_id": 9566697, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5bakSMfvojY/AAAAAAAAAAI/AAAAAAAAEZQ/_oWGXJTmUXg/photo.jpg?sz=128", "display_name": "WIW Wrestling", "link": "https://stackoverflow.com/users/9566697/wiw-wrestling"}, "edited": false, "score": 0, "creation_date": 1522280242, "post_id": 49545473, "comment_id": 86099101, "body": "Sounds like your sheet name is bad then. Try this (updated) code and see what the msgbox prompts you as the sheet name (and take careful consideration whether it prompts with or without a space in the name)"}, {"owner": {"reputation": 31, "user_id": 9566697, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5bakSMfvojY/AAAAAAAAAAI/AAAAAAAAEZQ/_oWGXJTmUXg/photo.jpg?sz=128", "display_name": "WIW Wrestling", "link": "https://stackoverflow.com/users/9566697/wiw-wrestling"}, "edited": false, "score": 0, "creation_date": 1522281004, "post_id": 49545473, "comment_id": 86099306, "body": "Its said that [YTD2020] does not exist with no spaces, even though I was staring exactly at the sheet name. 2020 is the year that I entered."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 31, "user_id": 9566697, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5bakSMfvojY/AAAAAAAAAAI/AAAAAAAAEZQ/_oWGXJTmUXg/photo.jpg?sz=128", "display_name": "WIW Wrestling", "link": "https://stackoverflow.com/users/9566697/wiw-wrestling"}, "edited": false, "score": 0, "creation_date": 1522282009, "post_id": 49545473, "comment_id": 86099553, "body": "I am unable to reproduce your error. This works <b><a href=\"https://i.stack.imgur.com/mAPKl.gif\" rel=\"nofollow noreferrer\">perfectly fine for me</a></b>. Maybe try adding a space after the <code>YTD</code> on this line: <code>tgtName = &quot;YTD&quot; &amp; yearNum</code> just to be sure?"}, {"owner": {"reputation": 31, "user_id": 9566697, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5bakSMfvojY/AAAAAAAAAAI/AAAAAAAAEZQ/_oWGXJTmUXg/photo.jpg?sz=128", "display_name": "WIW Wrestling", "link": "https://stackoverflow.com/users/9566697/wiw-wrestling"}, "edited": false, "score": 0, "creation_date": 1522282290, "post_id": 49545473, "comment_id": 86099617, "body": "I really don&#39;t know what the problem is. Thanks for helping though"}, {"owner": {"reputation": 31, "user_id": 9566697, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5bakSMfvojY/AAAAAAAAAAI/AAAAAAAAEZQ/_oWGXJTmUXg/photo.jpg?sz=128", "display_name": "WIW Wrestling", "link": "https://stackoverflow.com/users/9566697/wiw-wrestling"}, "edited": false, "score": 0, "creation_date": 1522351313, "post_id": 49545473, "comment_id": 86135328, "body": "No they are not"}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 3, "last_activity_date": 1522281236, "last_edit_date": 1522281236, "creation_date": 1522277795, "answer_id": 49545473, "question_id": 49545215, "link": "https://stackoverflow.com/questions/49545215/how-to-use-sum-function-for-an-array-of-worksheets-in-vba/49545473#49545473", "title": "How to use Sum Function for an Array of Worksheets in VBA", "body": "<p>You can loop the worksheet collection in <code>ThisWorkbook</code> and add the values of <code>B6</code>. This will exclude the target sheet with the <code>If...Then</code> statement</p>\n\n<pre><code>Sub test()\n\n    Dim ws As Worksheet, tgtWs As Worksheet, lVal As Long\n    Dim tgtName As String, yearNum As String\n\n    Do\n        yearNum = InputBox(\"Some Text\")\n        If Not IsNumeric(yearNum) Then\n            MsgBox \"Please enter a numeric number\"\n            yearNum = \"0\"\n        End If\n    Loop Until CLng(yearNum) &gt; 0\n\n    tgtName = \"YTD\" &amp; yearNum\n\n    ' This is the ws that will contain the sum product\n    On Error GoTo ErrHandler\n    Set tgtWs = ThisWorkbook.Worksheets(tgtName)\n    On Error GoTo 0\n\n    For Each ws In ThisWorkbook.Worksheets\n        If Not ws Is tgtWs Then\n            lVal = lVal + ws.Range(\"B6\")\n        End If\n    Next ws\n\n    tgtWs.Range(\"B6\") = lVal\n\n    Exit Sub\nErrHandler:\n    MsgBox \"Sheet name [\" &amp; tgtName &amp; \"] does NOT exist!\", _\n            vbCritical, \"Invalid Sheet Name\"\n\nEnd Sub\n</code></pre>\n\n<p>If your intention is to <strong>not</strong> exclude the target sheet from your calculations, then simply remove the <code>If Not ws Is tgtWs Then</code> line.</p>\n"}], "owner": {"reputation": 31, "user_id": 9566697, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5bakSMfvojY/AAAAAAAAAAI/AAAAAAAAEZQ/_oWGXJTmUXg/photo.jpg?sz=128", "display_name": "WIW Wrestling", "link": "https://stackoverflow.com/users/9566697/wiw-wrestling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1522281236, "creation_date": 1522276328, "last_edit_date": 1522277754, "question_id": 49545215, "link": "https://stackoverflow.com/questions/49545215/how-to-use-sum-function-for-an-array-of-worksheets-in-vba", "title": "How to use Sum Function for an Array of Worksheets in VBA", "body": "<p>I have some code that is suppose to use the Sum function to add up all the values in B6 of the worksheets that are in my array and put them in B6 of my \"Totals\" worksheet</p>\n\n<pre><code>Range(\"B6\").Value = Application.Worksheet.Sum(wkshtArray).Range(\"B6\") \nwkshtArray= Array(\"Dec\" &amp; numYear, \"Nov\" &amp; numYear)\n</code></pre>\n"}, {"tags": ["excel", "userform", "resume", "data-entry", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1522276016, "post_id": 49545041, "comment_id": 86097956, "body": "<code>rem</code> is a cmd batch file method."}, {"owner": {"reputation": 3, "user_id": 9564193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d91a1d674daa0f065177488188c29923?s=128&d=identicon&r=PG&f=1", "display_name": "Someday I&#39;ll be great at VBA", "link": "https://stackoverflow.com/users/9564193/someday-ill-be-great-at-vba"}, "edited": false, "score": 0, "creation_date": 1522286700, "post_id": 49545041, "comment_id": 86100675, "body": "@Jeeped, True, I was considering a function, but not sure if that would work..."}], "owner": {"reputation": 3, "user_id": 9564193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d91a1d674daa0f065177488188c29923?s=128&d=identicon&r=PG&f=1", "display_name": "Someday I&#39;ll be great at VBA", "link": "https://stackoverflow.com/users/9564193/someday-ill-be-great-at-vba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1522276920, "creation_date": 1522275272, "last_edit_date": 1531161705, "question_id": 49545041, "link": "https://stackoverflow.com/questions/49545041/resume-from-the-cell-with-newly-entered-data-by-a-userform", "title": "Resume from the Cell with newly entered Data by a Userform", "body": "<p>I am taking over a macro for someone, trying to re-code it, and they the userform to take off from the newly entered data cell. Here is 1 userform (there are multiple userforms within this macro)</p>\n\n<pre><code>Option Explicit\n\n\nPrivate Sub UserForm_Initialize()\n\nMe.ComboBox2.List = Sheets(\"Lookups\").ListObjects(\"HilvlActivitySourceLookup\").ListColumns(1).DataBodyRange.Value\n\nEnd Sub\n\nPrivate Sub CommandButton2_Click()\n\nActiveCell.Value = ComboBox2.Value\nUnload Me\n\nEnd Sub\n\nPrivate Sub EndButton_Click()\nEnd\nEnd Sub\n</code></pre>\n\n<p>I was considering adding some code underneath <code>Command Button 2</code>, similar to:</p>\n\n<pre><code>rem process userform data\n    UserEntryFromUserform = Userform1.ListBox1.Value\n</code></pre>\n\n<p>But am not sure if I am approaching this the right way. There are multiple userforms, all coded similarly, and if you could give some suggestions on how to automatically resume, I would really appreciate it. Thanks in advance!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1522274593, "post_id": 49544652, "comment_id": 86097462, "body": "(1) You don&#39;t define <code>REQUIREMENT_ROW_COUNT</code>. (2) Should be <code>Range(&quot;AP&quot; &amp; i)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1522276354, "last_edit_date": 1522276354, "creation_date": 1522276041, "answer_id": 49545178, "question_id": 49544652, "link": "https://stackoverflow.com/questions/49544652/using-vba-to-fill-a-column-based-on-the-value-in-a-separate-sheet/49545178#49545178", "title": "Using VBA to fill a column based on the value in a separate sheet", "body": "<p>The code below does what you describe in a very simple way. I believe that if you understand it you will be able to modify it for your situation. If not, please feel free to ask questions.</p>\n\n<pre><code>Sub test()\nDim sh1 As Worksheet, sh2 As Worksheet\nDim r1 As Range, r2 As Range, i As Long\nSet sh1 = Worksheets(\"test\")\nSet sh2 = Worksheets(\"NFR_List\")\nSet r1 = sh1.Range(\"C1\")\nSet r2 = sh2.Range(\"AP1\")\ni = 0\nWhile r1.Offset(i, 0) &lt;&gt; \"\"\n  If r1.Offset(i, 0) = \"Y\" Then r2.Offset(i, 0) = \"Y\"\n  i = i + 1\nWend\nEnd Sub\n</code></pre>\n\n<p>I've assumed that Column C has no blank cells until the data is finished, but if this is not true, the code can be easily modified according to your needs.</p>\n\n<p>Another approach would be to just use a formula for this (instead of VBA), such as <code>=IF(test!C1=\"Y\", \"Y\",\"\")</code> in <code>AP1</code> (if the \"NFR_List\" sheet) and then drag the formula down.  Or you could also put the formula in using VBA using code like, <code>r2.offset(i,0).formula = ...</code> . There are many ways.</p>\n"}], "owner": {"reputation": 1, "user_id": 9566573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f85d4e28f1de4dba4068459aef69fff?s=128&d=identicon&r=PG&f=1", "display_name": "VBmthelp", "link": "https://stackoverflow.com/users/9566573/vbmthelp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522276354, "creation_date": 1522273371, "last_edit_date": 1522273701, "question_id": 49544652, "link": "https://stackoverflow.com/questions/49544652/using-vba-to-fill-a-column-based-on-the-value-in-a-separate-sheet", "title": "Using VBA to fill a column based on the value in a separate sheet", "body": "<p>I need to run a macro between two worksheets where say column C in \"Sheet 1\" has a \"Y\", I need column AP in \"Sheet 2\" to return something along the lines of \"covered\" or \"Y\". Just something to indicate that a Y was there in Sheet 1. I am mainly running issues in actually connecting the two worksheets. This code below works fine if I am running it on columns within the same work sheet. </p>\n\n<p>Code: </p>\n\n<pre><code>Private Sub Set_Border_Pattern(Requirements_Selector_Str As String)\nDim strTemp As String\nDim strRange As String\nDim strCellVal As String\n\nIf Len(Requirements_Selector_Str) &gt; 2 Then\n    strTemp = Mid(Requirements_Selector_Str, 4, 1)\nElse\n    strTemp = Requirements_Selector_Str\nEnd If\n\nWith Worksheets(\"test\")\n    For i = 2 To REQUIREMENT_ROW_COUNT\n        strRange = strTemp &amp; i\n        strCellVal = .Range(strRange).Value\n        If strCellVal = \"Y\" Then\n        Worksheets(\"NFR_List\").Range(AP &amp; i).Value = \"Y\"\n        End If\n    Next i\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1522274047, "post_id": 49544572, "comment_id": 86097253, "body": "Access has a query wizard for exactly your problem - I suggest you use it and then analyze the SQL it creates. <a href=\"https://www.tutorialspoint.com/ms_access/ms_access_unmatched_query_wizard.htm\" rel=\"nofollow noreferrer\">tutorialspoint.com/ms_access/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 9221247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7915f9743462d161838b9fc994ed1ae6?s=128&d=identicon&r=PG&f=1", "display_name": "D. Steel", "link": "https://stackoverflow.com/users/9221247/d-steel"}, "edited": false, "score": 0, "creation_date": 1522348626, "post_id": 49544806, "comment_id": 86133970, "body": "Just a clarification on &quot;...(SELECT 1...&quot;  What is the &quot;1&quot; referring to?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 33, "user_id": 9221247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7915f9743462d161838b9fc994ed1ae6?s=128&d=identicon&r=PG&f=1", "display_name": "D. Steel", "link": "https://stackoverflow.com/users/9221247/d-steel"}, "edited": false, "score": 0, "creation_date": 1522348963, "post_id": 49544806, "comment_id": 86134139, "body": "It&#39;s the number one. Nothing else. The subquery needs to return something to check if a record exists. Using 1 instead of a column is faster, and it&#39;s convention. But you might as well use 5. Or a string. It doesn&#39;t matter."}, {"owner": {"reputation": 33, "user_id": 9221247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7915f9743462d161838b9fc994ed1ae6?s=128&d=identicon&r=PG&f=1", "display_name": "D. Steel", "link": "https://stackoverflow.com/users/9221247/d-steel"}, "edited": false, "score": 0, "creation_date": 1522353069, "post_id": 49544806, "comment_id": 86136098, "body": "Also the NOT EXISTS is great as it is quite a bit faster."}, {"owner": {"reputation": 33, "user_id": 9221247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7915f9743462d161838b9fc994ed1ae6?s=128&d=identicon&r=PG&f=1", "display_name": "D. Steel", "link": "https://stackoverflow.com/users/9221247/d-steel"}, "edited": false, "score": 0, "creation_date": 1522437992, "post_id": 49544806, "comment_id": 86168382, "body": "As a follow up Access 2013 changed it from &quot;NOT EXISTS&quot; to &quot;...WHERE Exists({sql chain}) = False.  For anyone who wants to know."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 0, "last_activity_date": 1522274162, "creation_date": 1522274162, "answer_id": 49544806, "question_id": 49544572, "link": "https://stackoverflow.com/questions/49544572/endless-looping-due-to-not-in-query-access-2013-sql/49544806#49544806", "title": "Endless Looping due to NOT IN query Access 2013 SQL", "body": "<p>If the problem is the - dashes, just remove them using <code>Replace</code>:</p>\n\n<pre><code>SELECT tblA.[Phone Number]\nFROM tblA\nWHERE tblA.[Phone Number] NOT IN (SELECT Replace([Wireless Number], \"-\", \"\") FROM [tblB]);\n</code></pre>\n\n<p>Also, there's no need for a left join. A <code>Not In</code> is a subquery, so you don't need to worry about that.</p>\n\n<p>If a phone number could be <code>Null</code>, or performance is important, a <code>Not Exists</code> is often preferred over <code>Not In</code>:</p>\n\n<pre><code>SELECT tblA.[Phone Number]\nFROM tblA\nWHERE NOT EXISTS (SELECT 1 FROM [tblB] WHERE Replace(tblB.[Wireless Number], \"-\", \"\") =  tblA.[Phone Number]);\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 9221247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7915f9743462d161838b9fc994ed1ae6?s=128&d=identicon&r=PG&f=1", "display_name": "D. Steel", "link": "https://stackoverflow.com/users/9221247/d-steel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 49544806, "answer_count": 1, "score": 0, "last_activity_date": 1522274162, "creation_date": 1522272974, "question_id": 49544572, "link": "https://stackoverflow.com/questions/49544572/endless-looping-due-to-not-in-query-access-2013-sql", "title": "Endless Looping due to NOT IN query Access 2013 SQL", "body": "<p>I am trying to pull out all phone numbers that are in 1 table (A) that are <em>not</em> in another table (B).  I've tried LEFT OUTER JOIN's but that never stays very long.  As soon as I go to datasheet and back to SQL it goes back to LEFT JOIN.  </p>\n\n<p>That said, here's my code. </p>\n\n<pre><code>SELECT tblA.[Phone Number]\nFROM tblA LEFT JOIN tblB ON tblA.[Phone Number] = tblB.[Wireless Number]\nWHERE (((tblA.[Phone Number]) NOT IN (SELECT [Wireless Number] FROM \n[tblB])));\n</code></pre>\n\n<p>Trouble that I'm having over regular \"not in's\" that i've done is that the Wireless Number has \"-\"'s in it and the Phone Number does not.  The Wireless data is external data that I don't want to have to modify for ease of use.  Simply put, I don't want to modify anything in tblB.</p>\n\n<p>If someone has a simpler way of finding values not in another table, I'm all ears.  This NOT IN feature is killing me.  Thanks in advance.</p>\n\n<p>When I run the code above.  Access just spools up and nothing ever happens.  It seems to crash Access. Not sure what it's doing. </p>\n"}, {"tags": ["vba", "excel", "excel-formula", "excel-2010"], "comments": [{"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 1, "creation_date": 1522272750, "post_id": 49544468, "comment_id": 86096740, "body": "Have you made a start on the VBA code you need? It would be helpful to see a more specific statement of what you&#39;re stuck on."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1522272758, "post_id": 49544468, "comment_id": 86096745, "body": "so B2 on Sheet1 would be what?"}, {"owner": {"reputation": 37, "user_id": 9566503, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "RALF", "link": "https://stackoverflow.com/users/9566503/ralf"}, "edited": false, "score": 0, "creation_date": 1522272910, "post_id": 49544468, "comment_id": 86096807, "body": "Scott Craner- B2 needs to be T4, A2 needs to be T5 and D2 needs to be X. Thanks"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1522272990, "post_id": 49544468, "comment_id": 86096844, "body": "so you want the last filled cell in that row?"}, {"owner": {"reputation": 37, "user_id": 9566503, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "RALF", "link": "https://stackoverflow.com/users/9566503/ralf"}, "edited": false, "score": 0, "creation_date": 1522273058, "post_id": 49544468, "comment_id": 86096862, "body": "halfer- No, i haven&#39;t start yet, i found some codes but not specifically address my problem. Thanks."}, {"owner": {"reputation": 37, "user_id": 9566503, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "RALF", "link": "https://stackoverflow.com/users/9566503/ralf"}, "edited": false, "score": 0, "creation_date": 1522273175, "post_id": 49544468, "comment_id": 86096907, "body": "Scott Craner- Yes, and every time when Break-list updated need to find last cell and copy-paste to sheet 1."}, {"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1522273374, "post_id": 49544468, "comment_id": 86096984, "body": "@RALF: when replying to folks here, please use their handle e.g. <code>@halfer</code>, so they are notified. Tab auto-complete is available. Thanks."}, {"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 1, "creation_date": 1522273502, "post_id": 49544468, "comment_id": 86097029, "body": "In relation to the question, it may close as &quot;too broad&quot;. Readers have an expectation that some effort has been expended prior to posting, so that free-work requests are somewhat discouraged."}, {"owner": {"reputation": 37, "user_id": 9566503, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "RALF", "link": "https://stackoverflow.com/users/9566503/ralf"}, "reply_to_user": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1522273556, "post_id": 49544468, "comment_id": 86097054, "body": "@halfer Sorry wasn&#39;t know about that and thanks for letting me know."}, {"owner": {"reputation": 37, "user_id": 9566503, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "RALF", "link": "https://stackoverflow.com/users/9566503/ralf"}, "reply_to_user": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1522273965, "post_id": 49544468, "comment_id": 86097216, "body": "@halfer: I did try many times but did not get result. i just tried and delete it. on my next questions i will post my work as well. Thanks for letting me know."}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1522273715, "last_edit_date": 1522273715, "creation_date": 1522273345, "answer_id": 49544647, "question_id": 49544468, "link": "https://stackoverflow.com/questions/49544468/vba-code-for-skipping-the-fullempty-cells-and-get-the-last-full-cell-value-and/49544647#49544647", "title": "VBA code for skipping the full+empty cells and get the last full cell value and transfer for another sheet", "body": "<p>formula:</p>\n\n<pre><code>=INDEX(INDEX(breaklist!C:I,MATCH(A2,breaklist!B:B,0),0),MATCH(\"zzz\",INDEX(breaklist!C:I,MATCH(A2,breaklist!B:B,0),0)))\n</code></pre>\n\n<p>Put this in Cell B2 then copy down.</p>\n\n<p><a href=\"https://i.stack.imgur.com/N0KC5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/N0KC5.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 37, "user_id": 9566503, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "RALF", "link": "https://stackoverflow.com/users/9566503/ralf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 49544647, "answer_count": 1, "score": -1, "last_activity_date": 1522273756, "creation_date": 1522272510, "last_edit_date": 1522272709, "question_id": 49544468, "link": "https://stackoverflow.com/questions/49544468/vba-code-for-skipping-the-fullempty-cells-and-get-the-last-full-cell-value-and", "title": "VBA code for skipping the full+empty cells and get the last full cell value and transfer for another sheet", "body": "<p>I am trying to find out a VBA code for the following problem. I need to a VBA code which matches the name on sheet1 with breaklist and copy and paste last table(T) number to sheet one? the time slots on breaklist sheet are just for display purposes they are not real time cells.</p>\n\n<p><strong>BreakList</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/3lmBa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3lmBa.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Sheet1</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/JPdVp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JPdVp.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel", "excel-2010", "copy-paste"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1522270120, "post_id": 49543867, "comment_id": 86095490, "body": "re: <i>&#39;making the sheet 2 row heights equal to the sheet 1 row heights&#39;</i> Shouldn&#39;t you be using <code>Sheet2.Rows(i).RowHeight = .Rows(count).RowHeight</code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 9339566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36a05d4fabf9023e715dec36cd86bb8d?s=128&d=identicon&r=PG&f=1", "display_name": "PWJP", "link": "https://stackoverflow.com/users/9339566/pwjp"}, "edited": false, "score": 0, "creation_date": 1522335426, "post_id": 49544344, "comment_id": 86126379, "body": "Oh man, I feel like an idiot right now. Thank you very much. This is something I should have noticed."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1522272782, "last_edit_date": 1522272782, "creation_date": 1522271914, "answer_id": 49544344, "question_id": 49543867, "link": "https://stackoverflow.com/questions/49543867/i-am-trying-to-copy-row-heights-from-one-sheet-to-another-sheet/49544344#49544344", "title": "I am trying to copy row heights from one sheet to another sheet", "body": "<p>You are inside a With ... End With block that references sheet1 as the parent worksheet. LastRowC23 and LastRow are defined by row locations on sheet1. Count is arbitrarily assigned a value of 4.</p>\n\n<p>If you are <em>'making the sheet 2 row heights equal to the sheet 1 row heights'</em>, then you seem to be using everything backwards.</p>\n\n<pre><code>For i = LastRowC23 + 1 To LastRow\n    Sheet2.Rows(count).RowHeight = .Rows(i).RowHeight\n    count = count + 1\nNext i\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 9339566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36a05d4fabf9023e715dec36cd86bb8d?s=128&d=identicon&r=PG&f=1", "display_name": "PWJP", "link": "https://stackoverflow.com/users/9339566/pwjp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1078, "favorite_count": 0, "accepted_answer_id": 49544344, "answer_count": 1, "score": 0, "last_activity_date": 1522272782, "creation_date": 1522269949, "question_id": 49543867, "link": "https://stackoverflow.com/questions/49543867/i-am-trying-to-copy-row-heights-from-one-sheet-to-another-sheet", "title": "I am trying to copy row heights from one sheet to another sheet", "body": "<p>I am trying to copy row heights from one sheet1 to sheet2. but the following code is not working. note that the tables on both sheets are on different row numbers as well.</p>\n\n<pre><code>Call Unhide\n\nWith Sheet1\n\n    Dim LastRowC23 As Integer\n    LastRowC23 = Application.WorksheetFunction.Match(\"CYCLE 1\", \n    .Range(\"A:A\"), 0) - 1\n\n    Dim LastRow As Integer\n    LastRow = .Cells(.Rows.count, \"B\").End(xlUp).Row\n\n    .Range(\"A3:BD3\"), 0)\n\n    Dim C1StartCol As Integer\n    C1StartCol = Application.WorksheetFunction.Match(\"CYCLE 1\", \n    .Range(\"A1:BD1\"), 0)\n\n    Dim C2StartCol As Integer\n    C2StartCol = Application.WorksheetFunction.Match(\"CYCLE 2\", .Range(\"A1:BD1\"), 0)\n\n    Dim LastCol As Integer\n    LastCol = .Cells(3, .Columns.count).End(xlToLeft).Column\n\n    Sheet2.Range(\"A1:CZ200\").Clear\n\n    .Range(\"A1\", .Cells(3, C2StartCol - 1)).Copy\n    Sheet2.Range(\"A1\").PasteSpecial xlPasteAllUsingSourceTheme\n    Sheet2.Range(\"A1\").PasteSpecial xlPasteColumnWidths\n    .Range(.Cells(LastRowC23 + 1, 1), .Cells(LastRow - 1, C2StartCol - 1)).Copy\n    Sheet2.Range(\"A4\").PasteSpecial xlPasteAllUsingSourceTheme\n    Sheet2.Range(\"A4\").PasteSpecial xlPasteColumnWidths\n\n    Dim i As Integer\n    Dim count As Integer\n\n    count = 4\n\n    For i = LastRowC23 + 1 To LastRow\n        .Rows(count).RowHeight = Sheet2.Rows(i).RowHeight\n        count = count + 1\n    Next i\n\n\n\n    Sheet2.Outline.ShowLevels ColumnLevels:=1\n\nEnd With\n</code></pre>\n\n<p>The following is the part specific to row heights. Here, I am going through each row in the sheet 1 portion and making the sheet 2 row heights equal to the sheet 1 row heights.</p>\n\n<pre><code>    Dim i As Integer\n    Dim count As Integer\n\n    count = 4\n\n    For i = LastRowC23 + 1 To LastRow\n        .Rows(count).RowHeight = Sheet2.Rows(i).RowHeight\n        count = count + 1\n    Next i\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522270600, "post_id": 49543856, "comment_id": 86095757, "body": "Are you switching off the usual suspects e.g. ScreenUpdating.......?"}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522270719, "post_id": 49543856, "comment_id": 86095827, "body": "@QHarr Yes, I have turned those off in the call of <code>AddData</code>"}], "answers": [{"comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 2, "creation_date": 1522272687, "post_id": 49544289, "comment_id": 86096720, "body": "Doing <code>DoEvents</code> on <i>every</i> iteration of the For loop will slow things down quite a bit.  Given Excel doesn&#39;t &quot;freeze&quot; until you&#39;ve processed 6000 or so rows, I&#39;d suggest putting the <code>DoEvents</code> inside your <code>If (i ... </code> block"}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1522686087, "post_id": 49544289, "comment_id": 86236189, "body": "@chrisneilsen Thank, I changed the code to only be in the <code>DoEvents</code> in the progress bar and I noticed a roughly 30% increase in speed. Great suggestion thank you"}], "tags": [], "owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "is_accepted": true, "score": 0, "last_activity_date": 1522686101, "last_edit_date": 1522686101, "creation_date": 1522271626, "answer_id": 49544289, "question_id": 49543856, "link": "https://stackoverflow.com/questions/49543856/form-freezing-after-calculations/49544289#49544289", "title": "Form Freezing after Calculations", "body": "<p>Figured it out... I added in a call to <code>DoEvents</code> and that seemed to stop the screen from freezing up! :)</p>\n\n<pre><code>With ActiveSheet\n      For i = 2 To LR\n         Set newASN = New cASN\n\n         If (i Mod 500) = 0 Then\n            frmMainMenu.frameBar.Width = (i / LR) * 100\n            frmMainMenu.labelPctComplete.Caption = Int((i / LR) * 100) &amp; \"%\"\n            frmMainMenu.labelTotalASNnum.Caption = i\n            frmMainMenu.Repaint\n            DoEvents    'Added the line here\n         End If\n\n         For j = 1 To LC\n            AddData newASN, j, .Cells(i, j).value\n         Next j\n         ASN_COL.Add newASN\n      Next i\n         frmMainMenu.frameBar.Width = 100\n         frmMainMenu.labelPctComplete.Caption = \"100%\"\n         frmMainMenu.labelTotalASNnum.Caption = i - 1\n   End With\n</code></pre>\n"}], "owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 49544289, "answer_count": 1, "score": 0, "last_activity_date": 1522686101, "creation_date": 1522269914, "last_edit_date": 1531164843, "question_id": 49543856, "link": "https://stackoverflow.com/questions/49543856/form-freezing-after-calculations", "title": "Form Freezing after Calculations", "body": "<p>I'm running the below code from a Form that has a loading bar, it works perfectly... when there roughly 6000 rows, but when it gets to around the 8000th row mark, the Form freezes. It does eventually complete the process of every row, but it doesn't update my progress bar that I implemented.</p>\n\n<p>I've tried changing the <code>Mod</code> value from a few different numbers ranging from <code>5 to 500</code> and it still freezes around the 8000th row.</p>\n\n<pre><code>With ActiveSheet\n      For i = 2 To LR\n         Set newASN = New cASN\n\n         If (i Mod 500) = 0 Then\n            frmMainMenu.frameBar.Width = (i / LR) * 100\n            frmMainMenu.labelPctComplete.Caption = Int((i / LR) * 100) &amp; \"%\"\n            frmMainMenu.labelTotalASNnum.Caption = i\n            frmMainMenu.Repaint\n         End If\n\n         For j = 1 To LC\n            AddData newASN, j, .Cells(i, j).value\n         Next j\n         ASN_COL.Add newASN\n      Next i\n         frmMainMenu.frameBar.Width = 100\n         frmMainMenu.labelPctComplete.Caption = \"100%\"\n         frmMainMenu.labelTotalASNnum.Caption = i - 1\n   End With\n</code></pre>\n\n<p><strong>Does anyone know how to prevent the freezing of this Form?</strong></p>\n\n<p>Please let me know if there's anything else I need to add or clarify here... I think I may have covered all the ground that I'm having issues with.</p>\n"}, {"tags": ["arrays", "vba", "worksheet-function"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1522270024, "post_id": 49543784, "comment_id": 86095437, "body": "like this: <a href=\"https://stackoverflow.com/questions/47982724/how-to-use-or-operator-with-sumifs\" title=\"how to use or operator with sumifs\">stackoverflow.com/questions/47982724/&hellip;</a>  but instead of SUMIFS you would do the COUNTIFS the same way."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1522270085, "post_id": 49543784, "comment_id": 86095472, "body": "@ScottCraner So the array works like OR? I see that the second arg is variant."}, {"owner": {"reputation": 35, "user_id": 8797058, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fd2111a38b5982da017bd3d307983c6b?s=128&d=identicon&r=PG&f=1", "display_name": "Ben.Name", "link": "https://stackoverflow.com/users/8797058/ben-name"}, "edited": false, "score": 0, "creation_date": 1522270184, "post_id": 49543784, "comment_id": 86095526, "body": "Yes, So the array works like an or. Thanks!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1522270750, "post_id": 49543784, "comment_id": 86095842, "body": "@QHarr yes, if on the worksheet <code>=SUM(COUNTIF(A:A,{&quot;Foo&quot;,&quot;Bar&quot;})</code> this would count every cell in column A that is either <code>Foo</code> or <code>Bar</code>."}, {"owner": {"reputation": 35, "user_id": 8797058, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fd2111a38b5982da017bd3d307983c6b?s=128&d=identicon&r=PG&f=1", "display_name": "Ben.Name", "link": "https://stackoverflow.com/users/8797058/ben-name"}, "edited": false, "score": 0, "creation_date": 1522271929, "post_id": 49543784, "comment_id": 86096383, "body": "Reviewing the link Scott provided, it looks like I am to use something like    Application.Sum(Application.Countifs((Range(&quot;A:A&quot;), &quot;16-*&quot;, UserArray())))  However, this does not work, it seems like putting the whole array in there like the example works, however that is very messy. Is there a way to simply reference it within?"}, {"owner": {"reputation": 35, "user_id": 8797058, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fd2111a38b5982da017bd3d307983c6b?s=128&d=identicon&r=PG&f=1", "display_name": "Ben.Name", "link": "https://stackoverflow.com/users/8797058/ben-name"}, "edited": false, "score": 0, "creation_date": 1522273879, "post_id": 49543784, "comment_id": 86097180, "body": "To maybe clarify....      This does not work............Application.Sum(Application.Countifs((Range(&zwnj;&#8203;&quot;A:A&quot;), &quot;16-<i>&quot;, UserArray())))..........This does......................Application.Sum(Application.Counti&zwnj;&#8203;fs((Range(&quot;A:A&quot;), &quot;16-</i>&quot;, Array(&quot;Name1&quot;, &quot;Name2&quot;)))"}], "owner": {"reputation": 35, "user_id": 8797058, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fd2111a38b5982da017bd3d307983c6b?s=128&d=identicon&r=PG&f=1", "display_name": "Ben.Name", "link": "https://stackoverflow.com/users/8797058/ben-name"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1522269573, "creation_date": 1522269573, "question_id": 49543784, "link": "https://stackoverflow.com/questions/49543784/worksheetfunction-countifs-vba-that-uses-an-array", "title": "WorksheetFunction.CountIfs VBA, that uses an Array", "body": "<p>Looking to use an Array within a countif.</p>\n\n<p>Example</p>\n\n<pre><code>Sheets(\"Data\").Select\nActiveSheet.AutoFilterMode = False\nUserArray = Array(\"Name1\", \"Name2\", \"Name3\", \"Name4\")\n\nZ = Application.WorksheetFunction.CountIfs(Range(\"A:A\"), \"16-*\", Range(\"B:B\"), \"Z*\", Range(\"S:S\"), UserArray(), Range(\"AQ:AQ\"), \"\")\n</code></pre>\n\n<p>As is this will not execute line Z = countifs,etc,etc....</p>\n\n<p>How/Can you define an array within a countifs what would the syntax be?</p>\n\n<p>Thanks,</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13883, "user_id": 6815131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c38385f9eb57b70176498fa5c3b4c99?s=128&d=identicon&r=PG&f=1", "display_name": "Joe C", "link": "https://stackoverflow.com/users/6815131/joe-c"}, "edited": false, "score": 0, "creation_date": 1522269550, "post_id": 49543766, "comment_id": 86095166, "body": "This question has nothing to do with <a href=\"https://stackoverflow.com/questions/tagged/java\">java</a>.  I have removed the tag for you."}, {"owner": {"reputation": 69, "user_id": 8610459, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb95bd8ea7e1fdd9f2e75ce267c1121e?s=128&d=identicon&r=PG&f=1", "display_name": "Roca", "link": "https://stackoverflow.com/users/8610459/roca"}, "edited": false, "score": 0, "creation_date": 1522270143, "post_id": 49543766, "comment_id": 86095505, "body": "QHarr, this did not work, it&#180;s an expandable list on the website the &quot;foldinglist&quot; is only available after clicking first on &quot;foldheader0&quot; then, clicking here: &quot;foldheader1&quot;. It opens cascade style... I don&#180;t know if that makes a difference, but I did try your solution on both links (first on cascade and the one I actually want): IE.Document.getElementByID(&quot;foldinglist&quot;).Click and IE.Document.getElementByID(&quot;foldinglist&quot;).Click but no success"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522270673, "post_id": 49543766, "comment_id": 86095797, "body": "Is it an internal URL or public?"}, {"owner": {"reputation": 69, "user_id": 8610459, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb95bd8ea7e1fdd9f2e75ce267c1121e?s=128&d=identicon&r=PG&f=1", "display_name": "Roca", "link": "https://stackoverflow.com/users/8610459/roca"}, "edited": false, "score": 0, "creation_date": 1522270803, "post_id": 49543766, "comment_id": 86095864, "body": "It is an internal link, on company intranet, however, there&#180;s no URL change on the browser, so I cannot simply &quot;IE.navigate to&quot;"}, {"owner": {"reputation": 69, "user_id": 8610459, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb95bd8ea7e1fdd9f2e75ce267c1121e?s=128&d=identicon&r=PG&f=1", "display_name": "Roca", "link": "https://stackoverflow.com/users/8610459/roca"}, "edited": false, "score": 0, "creation_date": 1522270964, "post_id": 49543766, "comment_id": 86095935, "body": "The cascade (treeview) is like this: <a href=\"https://demos.telerik.com/kendo-ui/treeview/api\" rel=\"nofollow noreferrer\">link</a>"}], "answers": [{"tags": [], "owner": {"reputation": 65, "user_id": 9497458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3126e35b417982f72c3c15a11b31b8de?s=128&d=identicon&r=PG&f=1", "display_name": "bezurli", "link": "https://stackoverflow.com/users/9497458/bezurli"}, "is_accepted": false, "score": 0, "last_activity_date": 1522282259, "creation_date": 1522282259, "answer_id": 49546091, "question_id": 49543766, "link": "https://stackoverflow.com/questions/49543766/get-ie-to-click-on-a-li-link-with-vba-excel/49546091#49546091", "title": "Get IE to click on a LI link with VBA EXCEL", "body": "<p>Maybe this post can help:\n<a href=\"https://stackoverflow.com/questions/12583405/how-to-do-onclick-event-in-vba-vbscript\">How to do onclick event in VBA/VBScript</a></p>\n\n<p>However, if you try using the FireEvent, it seems to me you should use the event on the ul tag.</p>\n"}], "owner": {"reputation": 69, "user_id": 8610459, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb95bd8ea7e1fdd9f2e75ce267c1121e?s=128&d=identicon&r=PG&f=1", "display_name": "Roca", "link": "https://stackoverflow.com/users/8610459/roca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 753, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1522282259, "creation_date": 1522269484, "last_edit_date": 1522269535, "question_id": 49543766, "link": "https://stackoverflow.com/questions/49543766/get-ie-to-click-on-a-li-link-with-vba-excel", "title": "Get IE to click on a LI link with VBA EXCEL", "body": "<p>I am trying to get my code to click on a javascript li link or execute the javascript code, either one of those would solve my problem.</p>\n\n<p>This is the code I have:</p>\n\n<pre><code>Sub submitlogin()\n\nDim IE As Object\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    IE.Visible = True\n    IE.Navigate \"http://blablabla/\"\n\n\n While IE.busy: DoEvents: Wend\n On Error Resume Next\n\n\nIE.Document.getElementsByTagName(\"a\").Item(4).Click 'doesn\u00b4t work\n</code></pre>\n\n<p>I have also tried:</p>\n\n<pre><code>IE.Document.parentWindow.execScript \"checkcontained();\", \"javascript\" 'also not working\n</code></pre>\n\n<p>And tried:</p>\n\n<pre><code> Set ObjA = IE.Document.getElementByID(\"foldinglist\").getElementsByTagName(\"a\")(0)\n  ObjA.Click 'also not working\n\n\n  End Sub\n</code></pre>\n\n<p>This is the HTML:</p>\n\n<pre><code>&lt;body class=\"menu\"&gt;\n&lt;div id=\"menu\"&gt;\n    &lt;div align=\"left\" id=\"text\" style=\"position:absolute;top:0px;left:40px; width: 200px; height: 19px;display:none;\"&gt;&lt;strong&gt;&lt;b&gt;[TimeS]&lt;/b&gt;&lt;/strong&gt;&lt;/div&gt;\n    &lt;div align=\"left\" id=\"idMenu\" style=\"position:absolute;top:18px;left:7px; width: 200px; height: 19px; display:none;\"&gt;&lt;/div&gt;\n&lt;div id=\"treeview\"&gt;\n&lt;div id=\"menu_d\"&gt;\n&lt;ul style=\"\"&gt;&lt;li id=\"foldheader0\" onClick=\"JavaScript: checkcontained();\"&gt;time control\n&lt;ul id=\"foldinglist\" style=\"DISPLAY:none;\" onClick=\"JavaScript: checkcontained();\"&gt;&lt;li id=\"foldheader1\" onClick=\"JavaScript: checkcontained();\"&gt;Maintenance\n&lt;ul id=\"foldinglist\" style=\"DISPLAY:none;\" onClick=\"JavaScript: checkcontained();\"&gt;&lt;li&gt;&lt;a href=\"JavaScript: chamaPagina('../../thisthat.asp', '');\"&gt;admin&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;\n&lt;li id=\"foldheader1\" onClick=\"JavaScript: checkcontained();\"&gt;Consult/Reports\n&lt;ul id=\"foldinglist\" style=\"DISPLAY:none;\" onClick=\"JavaScript: checkcontained();\"&gt;&lt;li&gt;&lt;a href=\"JavaScript: chamaPagina('../../thisthat_redir.asp', '');\"&gt;Demonst time&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;\n&lt;li id=\"foldheader1\" onClick=\"JavaScript: checkcontained();\"&gt;help\n&lt;ul id=\"foldinglist\" style=\"DISPLAY:none;\" onClick=\"JavaScript: checkcontained();\"&gt;&lt;li&gt;&lt;a href=\"JavaScript: chamaPagina('../thisthose.html', '');\"&gt;PortariRE&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;\n\n        &lt;/ul&gt;\n        &lt;form name=\"frmMenu\"&gt;&lt;input type=\"hidden\" id=\"txtmaxnivel\" name=\"txtmaxnivel\" value=\"1\" /&gt;&lt;/form&gt;\n</code></pre>\n\n<p>I have to click (or exec) right here:</p>\n\n<pre><code>&lt;ul id=\"foldinglist\" style=\"DISPLAY:none;\" onClick=\"JavaScript: checkcontained();\"&gt;&lt;li&gt;&lt;a href=\"JavaScript: chamaPagina('../../thisthat_redir.asp', '');\"&gt;Demonst time&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access", "oledb"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1522271700, "post_id": 49543744, "comment_id": 86096280, "body": "I can&#39;t replicate that row limit for an xlsb file. Can you provide more details on it? Does it just return a limited amount of rows?"}, {"owner": {"reputation": 41, "user_id": 9361663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07416c7b998fbe87a1a5733ea86631e1?s=128&d=identicon&r=PG&f=1", "display_name": "Rascio", "link": "https://stackoverflow.com/users/9361663/rascio"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1522272703, "post_id": 49543744, "comment_id": 86096724, "body": "When the sheet I&#39;m querying has more than 65536 rows I get this error: <a href=\"https://i.stack.imgur.com/NzG6G.jpg\" rel=\"nofollow noreferrer\">Error PrintScreen</a>"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1522272778, "post_id": 49543744, "comment_id": 86096752, "body": "That&#39;s a VBA error, and I can&#39;t find that range name in your sample. Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. This is not complete, nor is it verifiable."}, {"owner": {"reputation": 41, "user_id": 9361663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07416c7b998fbe87a1a5733ea86631e1?s=128&d=identicon&r=PG&f=1", "display_name": "Rascio", "link": "https://stackoverflow.com/users/9361663/rascio"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1522273070, "post_id": 49543744, "comment_id": 86096869, "body": "I&#39;m sorry, but I could not upload my own picture as I don&#39;t have enough reputation on the forum, but  in the picture, instead of &quot;HighRange&quot;, my error message reads &quot;SheetName$A1:W100000&quot;. Pretty sure it is not VBA error for it works when I have 65536 rows with data and crashes when I have 65537 rows with data."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1522273276, "post_id": 49543744, "comment_id": 86096941, "body": "If it&#39;s not VBA, then run it outside of VBA and provide the error. I&#39;m not going to troubleshoot a VBA error without seeing any VBA..."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 1, "creation_date": 1522276431, "post_id": 49543744, "comment_id": 86098087, "body": "Isn&#39;t there something wrong if you have more than 2^16 rows? Shouldn&#39;t this data be stored in database linked to excel? <a href=\"https://stackoverflow.com/questions/24472183/excel-as-database-query-more-than-65536-rows\" title=\"excel as database query more than 65536 rows\">stackoverflow.com/questions/24472183/&hellip;</a>"}, {"owner": {"reputation": 41, "user_id": 9361663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07416c7b998fbe87a1a5733ea86631e1?s=128&d=identicon&r=PG&f=1", "display_name": "Rascio", "link": "https://stackoverflow.com/users/9361663/rascio"}, "edited": false, "score": 0, "creation_date": 1522285161, "post_id": 49543744, "comment_id": 86100308, "body": "Sales data is extracted from SAP, adjusted and modified, and then stored in Access (for BI applications). One year worth of data easily get bigger than 2^16...."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1522286131, "post_id": 49543744, "comment_id": 86100548, "body": "Why not import to access from sap, then adjust in access or linked excel."}, {"owner": {"reputation": 41, "user_id": 9361663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07416c7b998fbe87a1a5733ea86631e1?s=128&d=identicon&r=PG&f=1", "display_name": "Rascio", "link": "https://stackoverflow.com/users/9361663/rascio"}, "edited": false, "score": 0, "creation_date": 1522332016, "post_id": 49543744, "comment_id": 86123779, "body": "Could you point me a direction for me to learn what a linked excel is and how it works? Could be a viable option!"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1522344098, "post_id": 49543744, "comment_id": 86131680, "body": "e.g Data tab -&gt; external data -&gt;  from Access"}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 9361663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07416c7b998fbe87a1a5733ea86631e1?s=128&d=identicon&r=PG&f=1", "display_name": "Rascio", "link": "https://stackoverflow.com/users/9361663/rascio"}, "is_accepted": false, "score": 2, "last_activity_date": 1522275805, "creation_date": 1522275805, "answer_id": 49545130, "question_id": 49543744, "link": "https://stackoverflow.com/questions/49543744/oledb-connection-to-support-more-than-65536-rows-update-access-from-excel-sheet/49545130#49545130", "title": "OLEDB Connection to support more than 65536 rows (Update Access from Excel Sheet)", "body": "<p>Well, if somebody else comes accross the same problem:</p>\n\n<p>The issue reported here is a known bug that happens when a range is queried: <a href=\"https://stackoverflow.com/questions/38650103/problems-in-excel-2013-when-using-ranges-that-extend-beyond-row-65536\">Problems in Excel 2013 when using ranges that extend beyond row 65536</a> </p>\n\n<p>and </p>\n\n<p><a href=\"https://chandoo.org/forum/threads/excel-recordset-only-returns-65536-rows-if-you-try-to-pull-data-from-a-range.12492/\" rel=\"nofollow noreferrer\">https://chandoo.org/forum/threads/excel-recordset-only-returns-65536-rows-if-you-try-to-pull-data-from-a-range.12492/</a> )</p>\n\n<p>To bypass it the solution was to query the range using \"[SheetName$A:W]\" instead of \"[SheetName$A1:W100000]\"</p>\n\n<pre><code>SELECT * FROM [Excel 12.0;HDR=YES;DATABASE=K:\\FolderName\\FileName.xlsb].[SheetName$A:W] WHERE Data=#01/01/2018#;\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 9361663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07416c7b998fbe87a1a5733ea86631e1?s=128&d=identicon&r=PG&f=1", "display_name": "Rascio", "link": "https://stackoverflow.com/users/9361663/rascio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 670, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1522275805, "creation_date": 1522269420, "last_edit_date": 1522272889, "question_id": 49543744, "link": "https://stackoverflow.com/questions/49543744/oledb-connection-to-support-more-than-65536-rows-update-access-from-excel-sheet", "title": "OLEDB Connection to support more than 65536 rows (Update Access from Excel Sheet)", "body": "<p>I can use the following SQL command to select data from an Excel sheet to be inserted into an Access table:</p>\n\n<pre><code>SELECT * FROM [Excel 12.0;HDR=YES;DATABASE=K:\\FolderName\\FileName.xlsb].[SheetName$A1:W100000] WHERE Data=#01/01/2018#;\n</code></pre>\n\n<p>But this method is limited to the 65536 rows from old versions of excel...this is the error I get:</p>\n\n<p><img src=\"https://i.stack.imgur.com/NzG6G.jpg\" alt=\"Error Image\"></p>\n\n<p>How should I adapt this code to allow for more rows?</p>\n\n<p>I tried the following code, adapted to use ACE.OLEDB </p>\n\n<pre><code>SELECT * FROM [Microsoft.ACE.OLEDB.12.0;Excel 12.0;HDR=YES;DATABASE=K:\\FolderName\\FileName.xlsb].[SheetName$A1:W100000] WHERE Data=#01/01/2018#;\n</code></pre>\n\n<p>but I get the error: \"Cannot find installable ISAM\"</p>\n\n<p>How do I correctly specify the newer ACE.OLEDB using the same bracket format?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1522273755, "post_id": 49543655, "comment_id": 86097128, "body": "Assigning recordsource will requery your form. You don&#39;t need to perform additional requery."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1522277525, "post_id": 49543655, "comment_id": 86098398, "body": "ComName is bound to EmpId?  use <code>AfterUpdate</code>event not <code>Click</code>."}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1522335080, "post_id": 49543655, "comment_id": 86126145, "body": "What is the structure of <code>tbl_Order</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9566275, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156223716277486/picture?type=large", "display_name": "Hazem AboRawash", "link": "https://stackoverflow.com/users/9566275/hazem-aborawash"}, "edited": false, "score": 0, "creation_date": 1522299224, "post_id": 49544224, "comment_id": 86103748, "body": "I tested that but i still face the same error any help plzz as i need to to filter using combobox"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 1, "user_id": 9566275, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156223716277486/picture?type=large", "display_name": "Hazem AboRawash", "link": "https://stackoverflow.com/users/9566275/hazem-aborawash"}, "edited": false, "score": 0, "creation_date": 1522312123, "post_id": 49544224, "comment_id": 86109733, "body": "It might be simpler and faster to set the <i>Filter</i> property of the form, not the RecordSource."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1522271326, "creation_date": 1522271326, "answer_id": 49544224, "question_id": 49543655, "link": "https://stackoverflow.com/questions/49543655/access-combobox-issue/49544224#49544224", "title": "Access combobox issue?", "body": "<p><em>EmpID</em> is most likely numeric, thus:</p>\n\n<pre><code>EmName = \"SELECT * FROM tbl_Order WHERE  AssignedTo = \" &amp; Me.ComName &amp; \"\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9566275, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156223716277486/picture?type=large", "display_name": "Hazem AboRawash", "link": "https://stackoverflow.com/users/9566275/hazem-aborawash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522303395, "creation_date": 1522269089, "last_edit_date": 1522269952, "question_id": 49543655, "link": "https://stackoverflow.com/questions/49543655/access-combobox-issue", "title": "Access combobox issue?", "body": "<p>In Access I try to search using a combobox. I have 2 combo boxes, one of them works normally but another have an issue with.</p>\n\n<p>The failing code is as follows:</p>\n\n<pre><code>Private Sub ComName_Click()\n\n    Dim EmName As String\n    EmName = \"SELECT * FROM tbl_Order WHERE  AssignedTo = '\" &amp; Me.ComName &amp; \"'\"\n    Me.SearchForm.Form.RecordSource = EmName\n    Me.SearchForm.Form.Requery\n\nEnd Sub\n</code></pre>\n\n<p>and face run-time error 3464 \"data type mismatch in criteria expression\":</p>\n\n<p><img src=\"https://i.stack.imgur.com/PNoIg.png\" alt=\"run-time error, data type mismatch in criteria expression\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/dJVdG.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["excel", "range", "userform", "vba"], "answers": [{"comments": [{"owner": {"reputation": 462, "user_id": 6644572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9BxA5.jpg?s=128&g=1", "display_name": "Mahhdy", "link": "https://stackoverflow.com/users/6644572/mahhdy"}, "edited": false, "score": 1, "creation_date": 1522532388, "post_id": 49579924, "comment_id": 86192878, "body": "Thanks for your reply. I am out of office now, will check that tomorrow."}, {"owner": {"reputation": 462, "user_id": 6644572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9BxA5.jpg?s=128&g=1", "display_name": "Mahhdy", "link": "https://stackoverflow.com/users/6644572/mahhdy"}, "edited": false, "score": 1, "creation_date": 1522697312, "post_id": 49579924, "comment_id": 86242009, "body": "Thanks, yes that was the problem. your code just copies one cell, but mine also copies the whole area of non-continuous range as well. For copying by using array method. We have to address samed sized destination like the copied (selected) area. That&#39;s why I thought using copy and paste is more convenient. But I will check your code more carefully and will paste final answer here."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 462, "user_id": 6644572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9BxA5.jpg?s=128&g=1", "display_name": "Mahhdy", "link": "https://stackoverflow.com/users/6644572/mahhdy"}, "edited": false, "score": 1, "creation_date": 1522755692, "post_id": 49579924, "comment_id": 86265030, "body": "Glad you found the solution to your problem. - Edited my answer due to above comment and added example to write <b>complete ranges</b> back to your target sheet starting in cell <code>A1</code> allowing to write back one or more ranges (<i>non contiguous ranges</i>)."}, {"owner": {"reputation": 462, "user_id": 6644572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9BxA5.jpg?s=128&g=1", "display_name": "Mahhdy", "link": "https://stackoverflow.com/users/6644572/mahhdy"}, "edited": false, "score": 1, "creation_date": 1522845802, "post_id": 49579924, "comment_id": 86310792, "body": "WOW.... What I expected was just a tip, you did lots of help and support. Thanks a lot and really appreciated."}, {"owner": {"reputation": 462, "user_id": 6644572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9BxA5.jpg?s=128&g=1", "display_name": "Mahhdy", "link": "https://stackoverflow.com/users/6644572/mahhdy"}, "edited": false, "score": 0, "creation_date": 1522850580, "post_id": 49579924, "comment_id": 86314604, "body": "I checked the new code, the only problem with that is the blank columns between the copied cells. One option is asking VBA to delete all empty columns in the used range or use the offset in a way that continues from the last column. My data don&#39;t need to concatenate rows... just columns. I will post my final code here again. You developed more general code for non-continuous ranges that what I was looking."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 462, "user_id": 6644572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9BxA5.jpg?s=128&g=1", "display_name": "Mahhdy", "link": "https://stackoverflow.com/users/6644572/mahhdy"}, "edited": false, "score": 1, "creation_date": 1522858652, "post_id": 49579924, "comment_id": 86320637, "body": "Of course it&#39;s up to you to adapt this code by changing offsets and/or to use other copy methods. As I solved your actual problem and demonstrated a working approach, I&#39;d kindly ask you to mark my answer as accepted if you find it helpful."}], "tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": true, "score": 1, "last_activity_date": 1522755162, "last_edit_date": 1522755162, "creation_date": 1522436379, "answer_id": 49579924, "question_id": 49543651, "link": "https://stackoverflow.com/questions/49543651/vba-using-refedit-for-copying-range-between-workbooks/49579924#49579924", "title": "VBA- Using RefEdit for copying range between workbooks", "body": "<p><strong>No RefEdit in a modeless Userform</strong></p>\n\n<p>The problem is that you <strong>cannot use a modeless userform</strong> containing a <code>RefEdit</code> control. Otherwise Excel loses control over the keyboard focus and can only be terminated via task manager or Ctrl + Alt + Delete. So you'll have to show your <em>Userform</em> <strong>modal</strong> (e.g. expressly by <code>.Show vbModal</code> or without this default argument). </p>\n\n<p><strong>Further hints:</strong> </p>\n\n<p>Don't use a <code>RefEdit</code> control within another control, especially not within a <code>Frame</code> control, this can cause issues.</p>\n\n<p>Check if you get a valid range (see <strong>Helper function <code>getRng</code></strong> below), then you can assign the new values simply by coding <code>ThisWorkbook.Sheets(\"Transfer\").Range(\"A1\") = Range(Me.RefEdit1.Value)</code> instead of using <code>Copy</code> and <code>Paste</code>. </p>\n\n<p>For <em>non contiguos ranges</em> there are number of code examples at SO, but that's not the cause of Excel freezing. In the code example below I assume that you want to write <strong>one</strong> cell only to worksheet range <code>Target!A1</code>. </p>\n\n<p>Furthermore I added a boolean variable <code>bReady</code> in order to lock or unlock the <code>Combobox1_Change()</code> event and prevent unnecessary activations.</p>\n\n<p><strong>Code example</strong></p>\n\n<pre><code>Option Explicit         ' declaration head of UserForm Code module\nDim bReady As Boolean   ' boolean flag to show completion of workbook list\n\nPrivate Sub CommandButton1_Click()\nDim rng As Range\nSet rng = getRng(Me.RefEdit1.Value) ' &lt;&lt; use helper function getRng\nIf Not rng Is Nothing Then\n  'write only first cell back to cell Transfer!A1\n   ThisWorkbook.Sheets(\"Transfer\").Range(\"A1\").Value = rng.Cells(1).Value\n  'correct address to one cell only\n   bReady = False\n   RefEdit1.Value = rng.Parent.Name &amp; \"!\" &amp; rng.Cells(1).Address\n   bReady = True\n   RefEdit1.ControlTipText = \"Value of \" &amp; RefEdit1.Value &amp; \" = \" &amp; Format(rng.Cells(1).Value, \"General\")\nElse    ' after manual input of not existing ranges\n   RefEdit1.Value = \"\": Me.RefEdit1.ControlTipText = \"None\": Beep\n   RefEdit1.SetFocus\nEnd If\nEnd Sub\n\nPrivate Sub UserForm_Activate()\nDim wb As Workbook\nFor Each wb In Application.Workbooks\n    ComboBox1.AddItem wb.Name\nNext\nComboBox1 = ActiveWorkbook.Name\nbReady = True       ' allow workbooks activation in Combobox1_Change event\nEnd Sub\n\nPrivate Sub Combobox1_Change()\nIf Not bReady Then Exit Sub         ' avoids activation before completion of workbooks list\nIf ComboBox1 &lt;&gt; \"\" Then Application.Workbooks(ComboBox1.Text).Activate\nEnd Sub\n</code></pre>\n\n<p><strong>Helper function <code>getRng()</code></strong></p>\n\n<pre><code>Function getRng(ByVal sRng As String) As Range\n' Purpose: return valid range object or return Nothing\nOn Error Resume Next\nSet getRng = Range(sRng)\nIf Err.Number &lt;&gt; 0 Then Err.Clear\nEnd Function\n</code></pre>\n\n<blockquote>\n  <p><strong>Edit: treating non contiguous areas</strong></p>\n</blockquote>\n\n<p>Pressing the <code>Ctrl</code> key you are able to select <strong>non contiguous</strong> ranges, e.g. <code>Sheet1!D12:E15,Sheet1!B7:C10</code> as completely separate areas (separated by a colon in <code>RefEdit</code>). Referring to your comment, I added the following example how to write back contiguous and non contiguous areas via a variant datafield array (called <code>v</code> in the below example code). As far as I understood you alwayas want to start at cell A1 in your target sheet: </p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim rng As Range, r As Range, v As Variant\nDim i As Long, n As Long\nDim iRowOffset As Long, temp As Long\nDim iColOffset As Long\nDim ws  As Worksheet\nSet ws = ThisWorkbook.Worksheets(\"Transfer\")\nSet rng = getRng(Me.RefEdit1.Value) ' &lt;&lt; use helper function getRng\nIf Not rng Is Nothing Then\n  ' a) count (non) contiguous areas obtained via Ctrl-key in RefEdit (e.g. \"D13:D15,A1:B2\")\n    n = rng.Areas.Count\n  ' b) calculate necessary row/col offset to start copies at A1 in target sheet\n    iRowOffset = rng.Areas(1).Row - 1\n    iColOffset = rng.Areas(1).Column - 1\n    For i = 1 To n\n        temp = rng.Areas(i).Row - 1\n        If temp &lt; iRowOffset And temp &gt; 0 Then iRowOffset = temp\n        temp = rng.Areas(i).Column - 1\n        If temp &lt; iColOffset And temp &gt; 0 Then iColOffset = temp\n    Next i\n  ' c) write values back\n    For i = 1 To n\n      With rng.Areas(i).Parent.Name ' sheet\n         v = rng.Areas(i)           ' write values to variant 1-based 2-dim array\n         ws.Range(rng.Areas(i).Address).Offset(-iRowOffset, -iColOffset) = v\n      End With\n    Next i\n\nElse    ' after manual input of not existing ranges\n   RefEdit1.Value = \"\":  Beep\n   RefEdit1.SetFocus\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 462, "user_id": 6644572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9BxA5.jpg?s=128&g=1", "display_name": "Mahhdy", "link": "https://stackoverflow.com/users/6644572/mahhdy"}, "is_accepted": false, "score": 1, "last_activity_date": 1522858596, "creation_date": 1522858596, "answer_id": 49655823, "question_id": 49543651, "link": "https://stackoverflow.com/questions/49543651/vba-using-refedit-for-copying-range-between-workbooks/49655823#49655823", "title": "VBA- Using RefEdit for copying range between workbooks", "body": "<p>Thanks to T.M. for his huge help. </p>\n\n<p>By changing his code I came to this answer. also, copy and paste method was working for me, but that was not a good practice.</p>\n\n<p>Anyway, all the credit goes for T.M. </p>\n\n<pre><code>Private Sub btnCopy_Click()\nDim rng As Range, v As Variant\nDim i As Long, n As Long, colno As Long\nDim ws  As Worksheet\nSet ws = ThisWorkbook.Worksheets(\"Transfer\")\nSet rng = getRng(Me.RefEdit1.Value) ' &lt;&lt; use helper function getRng\n\nIf Not rng Is Nothing Then\n    ws.UsedRange.Clear\n  ' a) count (non) contiguous areas obtained via Ctrl-key in RefEdit (e.g. \"D13:D15,A1:B2\")\n    n = rng.Areas.Count\n  ' c) write values back\n    For i = 1 To n\n         v = rng.Areas(i)           ' write values to variant 1-based 2-dim array\n         colno = IIf(ws.Cells(1, 1) = \"\", 1, ws.Range(\"xfd1\").End(xlToLeft).Column + 1)       ' FINDS THE LAST EMPTY COLUMN\n         ws.Cells(1, colno).Resize(rng.Areas(i).Rows.Count, rng.Areas(i).Columns.Count) = v\n    Next i\n\nElse    ' after manual input of not existing ranges\n   RefEdit1.Value = \"\":  Beep\n   RefEdit1.SetFocus\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 462, "user_id": 6644572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9BxA5.jpg?s=128&g=1", "display_name": "Mahhdy", "link": "https://stackoverflow.com/users/6644572/mahhdy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 732, "favorite_count": 0, "accepted_answer_id": 49579924, "answer_count": 2, "score": 1, "last_activity_date": 1522858596, "creation_date": 1522269078, "last_edit_date": 1531161705, "question_id": 49543651, "link": "https://stackoverflow.com/questions/49543651/vba-using-refedit-for-copying-range-between-workbooks", "title": "VBA- Using RefEdit for copying range between workbooks", "body": "<p>I wanted to copy some not continous ranges from several workbook/ worksheets to a specific sheet. I am using a userform and RefEdit control on that. But the Excel freezs each time I am calling the form and addressing the ranges! I can't do anything except End Excel!\nHere is my Code. </p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim rng As Range\nSet rng = Range(Me.RefEdit1.Value)\nrng.Copy\nThisWorkbook.Sheets(\"Transfer\").Range(\"a1\").PasteSpecial xlPasteValues\nEnd Sub \n\nPrivate Sub UserForm_Activate()\nFor Each wb In Application.Workbooks\n   ComboBox1.AddItem wb.Name\nNext\nComboBox1 = ActiveWorkbook.Name\nEnd Sub\n\nPrivate Sub Combobox1_Change()\nIf ComboBox1 &lt;&gt; \"\" Then Application.Workbooks(ComboBox1.Text).Activate\nEnd Sub\n</code></pre>\n\n<p>My Form was showed modeless. </p>\n\n<p><a href=\"https://1drv.ms/u/s!ArGi1KRQ5iItga8CLrZr9JpB67dEUw\" rel=\"nofollow noreferrer\">https://1drv.ms/u/s!ArGi1KRQ5iItga8CLrZr9JpB67dEUw</a></p>\n\n<p>So really not sure I can copy with this method or not. As I was not able to test my form. \nThanks, \nM</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1522269418, "post_id": 49543396, "comment_id": 86095092, "body": "Look into what ADODB can do for you."}], "answers": [{"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 0, "last_activity_date": 1522269466, "creation_date": 1522269466, "answer_id": 49543757, "question_id": 49543396, "link": "https://stackoverflow.com/questions/49543396/vba-to-properly-access-multi-user-database/49543757#49543757", "title": "VBA to properly access multi user database", "body": "<p>Your problem is: a snapshot-type recordset is always read-only. Specifying any edit lock options will throw a run-time error, since snapshot-type recordsets don't do locking. </p>\n\n<p>I can't reproduce the behavior, but you can try the following:</p>\n\n<pre><code>Set db = OpenDatabase(g400DBPath, False, False) 'Read-only can lead to exclusive locks since more specific locks are stored in the DB\nSet rs = db.OpenRecordset(sSQL, dbOpenSnapshot, dbReadOnly)\n</code></pre>\n\n<p>Alternatively, you could try using ADO and disconnected recordsets. DAO doesn't offer that functionality as far as I know.</p>\n"}], "owner": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 343, "favorite_count": 0, "accepted_answer_id": 49543757, "answer_count": 1, "score": 0, "last_activity_date": 1594636348, "creation_date": 1522268066, "last_edit_date": 1594636348, "question_id": 49543396, "link": "https://stackoverflow.com/questions/49543396/vba-to-properly-access-multi-user-database", "title": "VBA to properly access multi user database", "body": "<p>I have an Excel Add-In project that I'm working on which has multiple users accessing a database on the server.  Currently all the code works and everything processes correctly as long as only one user is accessing the database at a time.  I'm using DAO to access the database and passing an SQL string it to retrieve records using the following lines of code</p>\n\n<pre><code>Set db = OpenDatabase(g400DBPath, , True)\nSet rs = db.OpenRecordset(sSQL, dbOpenSnapshot)\n</code></pre>\n\n<p>This creates an issue where if more than one person attempts to access the database at the same time, only the first person is able to access it.  I tried changing the recordset line of code to the following</p>\n\n<pre><code>Set rs = db.OpenRecordset(sSQL, dbOpenSnapshot, , dbOptimistic)\n</code></pre>\n\n<p>but that gives me the following error:  Run-time error '3001: Invalid Argument</p>\n\n<p>How would I go about setting the access to the record set so that multiple users can run the report?  The users are not updating any information in the database at all, everything is read only.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 1, "creation_date": 1522270084, "post_id": 49543370, "comment_id": 86095471, "body": "&quot;Name can move a file across drives, but it can only rename an existing directory or folder when both newpathname and oldpathname are located on the same drive&quot;... So why not move the file first then rename it?"}, {"owner": {"reputation": 181, "user_id": 2078603, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/da4e9ae6fff5a52b79cabdfa2dc4ca76?s=128&d=identicon&r=PG", "display_name": "Don6558", "link": "https://stackoverflow.com/users/2078603/don6558"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1522274699, "post_id": 49543370, "comment_id": 86097501, "body": "File is on remote drive. I tried Name function and it caused compile error. I use FSO and it won&#39;t access remote drive. I hardcoded path to local drive file and it works. Hardcode path to remote drive file and it gives me &quot;File Not Found&quot; error."}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1522274797, "post_id": 49543370, "comment_id": 86097552, "body": "is it a mapped drive, UNC path?  provide a bit more context."}, {"owner": {"reputation": 181, "user_id": 2078603, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/da4e9ae6fff5a52b79cabdfa2dc4ca76?s=128&d=identicon&r=PG", "display_name": "Don6558", "link": "https://stackoverflow.com/users/2078603/don6558"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1522275194, "post_id": 49543370, "comment_id": 86097701, "body": "These files reside on a USB HD. It is recognized as a local drive on my computer so why should I be having any problems with it. I do love this type of forum for problems. It just occurred to me that maybe there is a problem with the HD. I&#39;ll check. In the meantime, shouldn&#39;t my code be working? Obviously nothing jumped out at you so my syntax must be correct."}, {"owner": {"reputation": 365, "user_id": 6698332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/394297b64c4b4332e72ea15b93f86187?s=128&d=identicon&r=PG&f=1", "display_name": "user6698332", "link": "https://stackoverflow.com/users/6698332/user6698332"}, "edited": false, "score": 0, "creation_date": 1522276989, "post_id": 49543370, "comment_id": 86098244, "body": "@Don6558, my answer below posted not as solution, but as lowlevel step by step tool, which may not work in your current environment, but it may helps to localise the problem."}], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 2078603, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/da4e9ae6fff5a52b79cabdfa2dc4ca76?s=128&d=identicon&r=PG", "display_name": "Don6558", "link": "https://stackoverflow.com/users/2078603/don6558"}, "edited": false, "score": 0, "creation_date": 1522775081, "post_id": 49545234, "comment_id": 86278459, "body": "I&#39;ve just now gotten back to this project. I now realize that the problems I&#39;m having has to do with Reference&#39;s. I&#39;ve tried to add a reference to VBA and excel tells me &quot;Name Conflict&quot;. I&#39;ve searched to find what reference I should add to access FileCopy and cannot find any info. I used to program a lot in VBA and VB 6 and for the life of me I don&#39;t remember having to add a reference for file access. Believe me, I do appreciate your help but I&#39;ve wasted too much time on this problem. I&#39;ll do a vb.net app instead."}], "tags": [], "owner": {"reputation": 365, "user_id": 6698332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/394297b64c4b4332e72ea15b93f86187?s=128&d=identicon&r=PG&f=1", "display_name": "user6698332", "link": "https://stackoverflow.com/users/6698332/user6698332"}, "is_accepted": false, "score": 0, "last_activity_date": 1522276404, "creation_date": 1522276404, "answer_id": 49545234, "question_id": 49543370, "link": "https://stackoverflow.com/questions/49543370/rename-file-on-different-drive-using-vba/49545234#49545234", "title": "Rename File on Different Drive Using VBA", "body": "<p>If there was no misunderstanding...</p>\n\n<p>FSO... it's bad in any case. It's just a bugsful API wrapper, written with a left chicken paw.\nThere are pure VB &amp; API for more sophisticated cases.</p>\n\n<p>No external libs &amp; objects:</p>\n\n<pre><code>Public Sub sp_PrjFilMov()\nDim i As Byte\nDim sNam$, sExt$, sPthSrc$, sPthTgt$, sDir$\n\n    sPthSrc = \"V:\\\"\n    sPthTgt = \"R:\\\"\n\n    sNam = \"Empty_\"\n    sExt = \".dmy\"   ' dummy\n\n    For i = 1 To 5 ' create set of files for test\n        Call sx_CrtFil(i, sPthSrc, sNam, sExt)\n    Next\n\n    sDir = Dir(sPthSrc &amp; \"*\" &amp; sExt, vbNormal) ' lookup for our files ..\n    Do\n        'Debug.Print sDir\n        Select Case LenB(sDir)\n            Case 0\n                Exit Do         ' *** EXIT DO\n            Case Else\n                Call sx_MovFil(sPthSrc, sDir, sPthTgt) ' ..  &amp; move them to another disk\n                sDir = Dir\n        End Select\n    Loop\n    Stop\nEnd Sub\n\nPrivate Sub sx_CrtFil(pNmb As Byte, pPth$, pNam$, pExt$)\nDim iFilNmb%\nDim sFilNam$\n    sFilNam = pPth &amp; pNam &amp; CStr(pNmb) &amp; pExt\n    iFilNmb = FreeFile\n    Open sFilNam For Output As #iFilNmb\n    Close #iFilNmb\nEnd Sub\n\nPrivate Sub sx_MovFil(pPnmSrc$, pFnm$, pPthTgt$)\nDim sSrcPne$\n    sSrcPne = pPnmSrc &amp; pFnm\n    'Debug.Print \"Move \" &amp; sSrcPne &amp; \" --&gt; \" &amp; pPthTgt\n    Call FileCopy(sSrcPne, pPthTgt &amp; pFnm)\n    Call Kill(sSrcPne)\nEnd Sub\n'\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 2078603, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/da4e9ae6fff5a52b79cabdfa2dc4ca76?s=128&d=identicon&r=PG", "display_name": "Don6558", "link": "https://stackoverflow.com/users/2078603/don6558"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 349, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522276404, "creation_date": 1522267957, "last_edit_date": 1531164843, "question_id": 49543370, "link": "https://stackoverflow.com/questions/49543370/rename-file-on-different-drive-using-vba", "title": "Rename File on Different Drive Using VBA", "body": "<p>I have a list of file names in a worksheet. I want to read a name, find the actual file, rename it and move on to the next name.</p>\n\n<p>The 1st part, retrieving the name from the worksheet and modifying it to the new name is not a problem. The problem is assigning the new name to the file.</p>\n\n<p>The Name function does not work because the files are on a different drive. I also tried Scripting.FileSystemObject. </p>\n\n<p>The code runs but no change is made.\nHere is the code I  used...</p>\n\n<pre><code>Dim fso, f\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nOn Error Resume Next\nSet f = fso.GetFile(fOldName)\nIf Not Err = 53 Then 'File not found\n  'Rename file\n  f.Name = fNewName\nEnd If\n</code></pre>\n\n<p>Did I make a code mistake I'm not seeing? Should I be using/doing something else?</p>\n\n<p>Finding info on VBA and/or VB6 is getting pretty rare these days.</p>\n\n<p>BTW. This is for Excel 2016.</p>\n\n<p>Tks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1522268354, "post_id": 49543156, "comment_id": 86094504, "body": "For the first statement -- <i>the variable <code>i</code> changes from 1 to 49</i> -- I interpret as <code>i = 1</code>, <code>i = 2</code>, <code>i = 3</code>, ... , <code>i = 48</code>, and <code>i = 49</code>.  However, I&#39;m slightly confused on your description of the issue. Does it go <code>i = 1</code>, <code>i = 2</code>, ... , <code>i = 147</code>, and <code>i = 148</code>? Or <code>i = 100</code>, <code>i = 101</code>, ... , <code>i = 148</code>?"}, {"owner": {"reputation": 1, "user_id": 9566157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc0a352f252dc1842ba9be6c135856bf?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/9566157/tom"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1522274266, "post_id": 49543156, "comment_id": 86097332, "body": "Variable \u201ei\u201d \u2013 in some random runs of macro - goes \u201ci=1, i=2\u2026i=148\u201d, but names of files are changed in range 100-148. I have absolutely no idea how it works."}, {"owner": {"reputation": 365, "user_id": 6698332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/394297b64c4b4332e72ea15b93f86187?s=128&d=identicon&r=PG&f=1", "display_name": "user6698332", "link": "https://stackoverflow.com/users/6698332/user6698332"}, "edited": false, "score": 0, "creation_date": 1522277891, "post_id": 49543156, "comment_id": 86098489, "body": "@Tom, look <a href=\"https://stackoverflow.com/a/49545234/6698332\">here</a>, please..."}, {"owner": {"reputation": 1, "user_id": 9566157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc0a352f252dc1842ba9be6c135856bf?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/9566157/tom"}, "edited": false, "score": 0, "creation_date": 1522296533, "post_id": 49543156, "comment_id": 86103085, "body": "So it is API wrapper. I think that is a pretty convincing explanation of this issue. Thank you for your help."}], "owner": {"reputation": 1, "user_id": 9566157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc0a352f252dc1842ba9be6c135856bf?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/9566157/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1522272324, "creation_date": 1522267162, "last_edit_date": 1522272324, "question_id": 49543156, "link": "https://stackoverflow.com/questions/49543156/vba-macro-doesnt-count-name-files-in-a-directory-properly", "title": "VBA macro doesn&#39;t count/name files in a directory properly", "body": "<p>I\u2019ve made a simply macro to change names of files in a directory. At first it seemed correct, but then I\u2019ve noticed something strange. For instance there is 48 files in a directory and initially the macro numbers files properly \u2013 \u201c1\u201d, \u201c2\u201d, \u201c3\u201d and so forth (in Immediate window the variable \u201ci\u201d changes from 1 to 49), but if I run the macro several times, sometimes the variable \u201ci\u201d changes  from 1 to 148 and a first number of files starts from 100: \u201c100\u201d, \u201c101\u201d, \u201c102\u201d et cetera. Then I run the macro again and it counts files properly, then \u2013 again \u2013 an error mentioned above occurs \u2026 and so on. I don\u2019t see any rule in it. Any help is greatly appreciated.</p>\n\n<pre><code>Sub nameChange()\nDim source As FileSystemObject\nDim fold As folder\nDim fObj As File\nDim path As String, newName As String, number As String, ext As String\nDim i As Long\n\nOn Error GoTo closeSub\nWith Application.FileDialog(msoFileDialogFolderPicker)\n  .Show\n  path = Application.FileDialog(msoFileDialogFolderPicker).SelectedItems(1)\nEnd With\n\nSet source = New FileSystemObject\nSet fold = source.GetFolder(path)\ni = 1\nnewName = InputBox(\"New name\")\n\nFor Each fObj In fold.Files\n  ext = Mid(fObj.Name, (InStrRev(fObj.Name, \".\")))\n  Name fObj As path &amp; \"\\\" &amp; newName &amp; i &amp; ext\n  i = i + 1\nNext fObj\n\ncloseSub:\n Exit Sub\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1522266692, "post_id": 49542971, "comment_id": 86093576, "body": "<code>Set myrange = wd.Selection</code>. Are you sure myrange is a valid object to pass to <code>wd.TablesOfContents.Add</code>? check all the arguments in that method against what you are passing. <code>Type Mismatch</code> error implies you are passing an incorrect object type into an argument."}, {"owner": {"reputation": 33, "user_id": 9076564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31259ac954fdc69ae3d80c2c473dfa1a?s=128&d=identicon&r=PG&f=1", "display_name": "Ashr ", "link": "https://stackoverflow.com/users/9076564/ashr"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1522267283, "post_id": 49542971, "comment_id": 86093896, "body": "my VBA knowledge is very limited, I assume when i set myrange=wd.Selection and use it in TOC.add it  will look at the whole document to build the TOC.  if remove myrange , the error changes to &quot;Argument not optional&quot;."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1522268379, "post_id": 49542971, "comment_id": 86094515, "body": "you are getting what i am saying. now just make sure that wd.Selection qualifies as valid range to pass in that instance...  checking the <a href=\"https://msdn.microsoft.com/en-us/vba/word-vba/articles/tablesofcontents-add-method-word?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">msdn article</a> clearly shows this where the error is. the range argument shows where you actually want to <i>place</i> the TOC, not what you want to consider in the TOC range."}, {"owner": {"reputation": 33, "user_id": 9076564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31259ac954fdc69ae3d80c2c473dfa1a?s=128&d=identicon&r=PG&f=1", "display_name": "Ashr ", "link": "https://stackoverflow.com/users/9076564/ashr"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1522274729, "post_id": 49542971, "comment_id": 86097521, "body": "@Scott. Thanks for pointing me in the right direction. i set a Set myRange = wd.ActiveDocument.Range(0, 0) and it placed TOC at the top of the document. I should have asked the question sooner i spent some hours trying to figure it out.  Thanks Again."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1522289336, "post_id": 49542971, "comment_id": 86101251, "body": "We&#39;ve all spent hours (or days even) trying to figure it out only to find someone else give us the answer in seconds :) And I&#39;m sure we&#39;ll do it some more too :) Glad you got it."}], "owner": {"reputation": 33, "user_id": 9076564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31259ac954fdc69ae3d80c2c473dfa1a?s=128&d=identicon&r=PG&f=1", "display_name": "Ashr ", "link": "https://stackoverflow.com/users/9076564/ashr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 372, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1522289461, "creation_date": 1522266496, "last_edit_date": 1531164843, "question_id": 49542971, "link": "https://stackoverflow.com/questions/49542971/insert-toc-in-word-document-from-excel-vba", "title": "Insert TOC in Word Document from Excel VBA", "body": "<p>I have an Excel worksheet which has list of links to Html files. I loop through these html files and insert each file into a word document while creating heading 1 references which i later use to create a TOC.  Right now everything works from excel VBA except the TOC part, i am able to create the TOC manually using the word> references > insert TOC.  However the VBA code for TablesofContents.Add give an error </p>\n\n<blockquote>\n  <p>\"Run-time error 13 - Type mismacth\"</p>\n</blockquote>\n\n<p>If i remove the TOC VBA code rest of the macro runs as i expect. Not quite sure what is wrong with the code. </p>\n\n<pre><code>Sub Macro3()\nDim rngA As Range\nDim cell As Range\n\nSet fso = CreateObject(\"scripting.filesystemobject\") 'Need this to interact \n  with the windows filesystem\nSet wd = CreateObject(\"word.application\") ' need this to open any word documents\n\n\nDQ = Chr(34) ' double quote will used later for string processing\n\nSet F = fso.GetFolder(InputBox(\"Enter location where Collated Document is to \n be created\"))\n orent = Application.InputBox(prompt:=\"Enter Orientation 1 for Landscape, 0 \n for Portrait \")\nTyp = Application.InputBox(prompt:=\"Enter type\")\n\n\nIf orent = 1 Then\n    orentt = \"Landscape\"\nElseIf orent = 0 Then\n   orentt = \"Portrait\"\n End If\n\n Set rngA = Range(\"A1\", Range(\"A65536\").End(xlUp))\n\n wd.Documents.Add\n  wd.ActiveDocument.SaveAs F &amp; \"\\\" &amp; \"TLF_collated.docx\"\n  wd.Documents.Open F &amp; \"\\\" &amp; \"TLF_collated.docx\"\n\nWith wd.ActiveDocument\n    .PageSetup.Orientation = orent\n    .Paragraphs.LineUnitAfter = 0\n    .Paragraphs.LineUnitBefore = 0\n    '.Selection.wholestory\n    '.Selection.Font.Name = \"Times New Roman\"\n\n\n\n  End With\n\n\n\n\n\n\n For Each cell In rngA\n\n If cell.Value = Typ Then\n\n\n   wd.Selection.Style = (\"Heading 1\")\n    wd.Selection.TypeText Text:=Typ &amp; \" \" &amp; cell.Offset(0, 1).Value &amp; \" : \" \n    &amp; cell.Offset(0, 2).Value\n    wd.Selection.TypeParagraph\n    wd.Selection.InsertFile CStr(Replace(Replace(cell.Offset(0, 4).Formula, \n    \"=HYPERLINK(\" &amp; DQ, \"\"), DQ &amp; \",\" &amp; DQ &amp; cell.Offset(0, 4).Value &amp; DQ &amp; \n       \")\", \"\"))\n    wd.Selection.EndKey\n    wd.Selection.InsertBreak 3\n    wd.Selection.InsertBreak 2\n\n\n\n End If\n Next cell\n\nSet myrange = wd.Selection\n    myrange.WholeStory\n    myrange.Font.Name = \"Arial\"\n    myrange.ParagraphFormat.SpaceAfter = 0\n    myrange.ParagraphFormat.SpaceBefore = 0\n\n     wd.Selection.HomeKey\n     wd.Selection.MoveUp\n\n       wd.TablesOfContents.Add myrange, _\n                                UseFields:=True, _\n                                UseHeadingStyles:=True, _\n                                UpperHeadingLevel:=1\n\n\nwd.ActiveDocument.Save\nwd.ActiveDocument.Close\n\n\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "import", "getfiles"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1522266588, "post_id": 49542781, "comment_id": 86093518, "body": "Do you know how to declare and assign a variable?"}, {"owner": {"reputation": 3, "user_id": 9566110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/672b47e7e9bead81665ef027596aac78?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/9566110/alex"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1522266711, "post_id": 49542781, "comment_id": 86093586, "body": "I do not, that sounds rather useful though."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1522267358, "post_id": 49542781, "comment_id": 86093939, "body": "<code>Dim path As String</code> declares a string variable, named <code>path</code>. Then you can prompt for a file name, say, <code>path = Application.GetOpenFileName</code> - and now that <code>path</code> has the value, you can concatenate it into your connection string, e.g. <code>Connection:=&quot;TEXT;&quot; &amp; path</code>. This is fairly basic stuff you can find literally everywhere on this site - good luck!"}, {"owner": {"reputation": 3, "user_id": 9566110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/672b47e7e9bead81665ef027596aac78?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/9566110/alex"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1522332582, "post_id": 49542781, "comment_id": 86124190, "body": "Thanks! I am new, bet you couldn&#39;t tell :)"}], "owner": {"reputation": 3, "user_id": 9566110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/672b47e7e9bead81665ef027596aac78?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/9566110/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1522271878, "creation_date": 1522265730, "last_edit_date": 1522271878, "question_id": 49542781, "link": "https://stackoverflow.com/questions/49542781/user-prompted-to-select-a-file-to-be-imported", "title": "User prompted to select a file to be imported", "body": "<p>First time caller, long time listener.</p>\n\n<p>I am trying to create a vba function to import a .csv file of the users choice into a specific sheet using the comma as the only delimiter.</p>\n\n<p>From the macro I recorded. I'd like to change the part where a specific file is chose to </p>\n\n<pre><code>Sub Macro2()\n'\n' Macro2 Macro\n'\n\n'\nWith ActiveSheet.QueryTables.Add(Connection:= _\n    \"TEXT;Y:\\CDM\\FromOptum\\Salesforce\\Campaigns\\AddCampaign_106_CNSOH_MMP_2018032812040.csv\" _\n    , Destination:=Range(\"$B$10\"))\n    .Name = \"AddCampaign_106_CNSOH_MMP_2018032812040_6\"\n    .FieldNames = True\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .TextFilePromptOnRefresh = False\n    .TextFilePlatform = 437\n    .TextFileStartRow = 1\n    .TextFileParseType = xlDelimited\n    .TextFileTextQualifier = xlTextQualifierDoubleQuote\n    .TextFileConsecutiveDelimiter = False\n    .TextFileTabDelimiter = False\n    .TextFileSemicolonDelimiter = False\n    .TextFileCommaDelimiter = True\n    .TextFileSpaceDelimiter = False\n    .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, _\n    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 _\n    , 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, _\n    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 _\n    , 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)\n    .TextFileTrailingMinusNumbers = True\n    .Refresh BackgroundQuery:=False\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "range", "user-defined"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1522264115, "post_id": 49542141, "comment_id": 86092174, "body": "GetOpenFilename method displays the standard Open dialog box and retrieves a file name specified from a filtered list provided by the user.  <a href=\"https://msdn.microsoft.com/en-us/library/office/hh710200(v=office.14).aspx#odc_xl4_ta_ProgrammaticallySelectFileforMac_IntroducingGetOpenFileNameMethod\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/&hellip;</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522264162, "post_id": 49542141, "comment_id": 86092203, "body": "Are you intending to have the user select from a dialog box?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1522264207, "post_id": 49542141, "comment_id": 86092225, "body": "^ what he said. You still need to <code>Set wb = Application.Workbooks.Open(path)</code> (assuming <code>Dim path As String</code> and <code>Dim wb As Workbook</code>, and <code>path = Application.GetOpenFilename</code>) - and then you can do <code>wb.Worksheets(&quot;Sheet 1&quot;).Range(whatever)</code>"}, {"owner": {"reputation": 1602, "user_id": 5682919, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4rC18.png?s=128&g=1", "display_name": "jsanchezs", "link": "https://stackoverflow.com/users/5682919/jsanchezs"}, "edited": false, "score": 0, "creation_date": 1522266099, "post_id": 49542141, "comment_id": 86093250, "body": "Do you compare the range from the selected book with an already open book ?, or does the comparation correspond to different sheets of the same selected book ?"}, {"owner": {"reputation": 1, "user_id": 7932174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed4dff593c7ef2c48b30e7629f599e95?s=128&d=identicon&r=PG&f=1", "display_name": "Zac M", "link": "https://stackoverflow.com/users/7932174/zac-m"}, "edited": false, "score": 0, "creation_date": 1522266562, "post_id": 49542141, "comment_id": 86093506, "body": "Thanks! Mathieu Guindon, you have answered my question. Adding in the code using your assumptions worked. Would you like me answer my question using your comment or edit my question to include your comment as an answer?"}], "owner": {"reputation": 1, "user_id": 7932174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed4dff593c7ef2c48b30e7629f599e95?s=128&d=identicon&r=PG&f=1", "display_name": "Zac M", "link": "https://stackoverflow.com/users/7932174/zac-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1522264136, "creation_date": 1522263265, "last_edit_date": 1522264136, "question_id": 49542141, "link": "https://stackoverflow.com/questions/49542141/return-range-from-another-workbook", "title": "Return range from another workbook", "body": "<p>sorry if my question is an easy one. I am still getting the hang of vba.</p>\n\n<p>Is there anyway to have a macro select a workbook defined by the user, then use that range for calculations? An example of what I am trying to do is in the code below:</p>\n\n<pre><code>Sub Other_Workbook_Range()\n\n    Dim wb As String\n    wb = Application.GetOpenFilename\n\n    If Range(\"A1\").Value = Workbooks(wb).Worksheets(\"Sheet 1\").Range(\"H74\").Value Then\n\n        MsgBox \"Okay\"\n\n    Else\n\n        MsgBox \"Fix\"\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>I don't think this code will work, but it is the best example I have of what I am trying to do. Let me know if I can clarify further. Thank you for your help in advance!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 9524071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b102701c1173723a115aa31ae9d2a225?s=128&d=identicon&r=PG&f=1", "display_name": "dejioni", "link": "https://stackoverflow.com/users/9524071/dejioni"}, "edited": false, "score": 0, "creation_date": 1522265227, "post_id": 49542458, "comment_id": 86092754, "body": "Worked perfectly."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 37, "user_id": 9524071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b102701c1173723a115aa31ae9d2a225?s=128&d=identicon&r=PG&f=1", "display_name": "dejioni", "link": "https://stackoverflow.com/users/9524071/dejioni"}, "edited": false, "score": 0, "creation_date": 1522265262, "post_id": 49542458, "comment_id": 86092777, "body": "@dejioni please mark as correct by clicking the check mark by the answer."}, {"owner": {"reputation": 37, "user_id": 9524071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b102701c1173723a115aa31ae9d2a225?s=128&d=identicon&r=PG&f=1", "display_name": "dejioni", "link": "https://stackoverflow.com/users/9524071/dejioni"}, "edited": false, "score": 0, "creation_date": 1522348552, "post_id": 49542458, "comment_id": 86133936, "body": "is it possible to do this for an entire row"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1522264885, "last_edit_date": 1522264885, "creation_date": 1522264487, "answer_id": 49542458, "question_id": 49542116, "link": "https://stackoverflow.com/questions/49542116/non-linear-interpolation-with-the-forecast-function/49542458#49542458", "title": "Non linear Interpolation with the Forecast function", "body": "<p>forcast wants a range or an array and not numbers which is what you are passing with <code>indexys:indexys1</code>  You are passing the values of the index, so it would return something like <code>104:34</code> and not a range or an array.</p>\n\n<p>You could change the Forcast line to:</p>\n\n<pre><code>Sheets(1).Range(\"g3\").value = Application.Forecast(temp, Array(indexys, indexys1), Array(indexxs, indexxs1))\n</code></pre>\n\n<p>and it will work, but there are better, quicker methods to get the outcome desired using vba and not worksheet functions.</p>\n\n<p>So we can get rid of the index and create an array of the values.  Then use those arrays in the formula.</p>\n\n<pre><code> Sub interp()\n Dim temp As Long\n Dim var As Long\n Dim var1 As Long\n Dim xs As Range\n Dim ys As Range\n\n With Worksheets(1)\n     Set xs = .Range(\"A8:A19\")\n     Set ys = .Range(\"B8:B19\")\n     temp = .Range(\"E3\").value\n\n\n    var = WorksheetFunction.Match(temp, xs, 1)\n    var1 = var + 1\n\n\n     Dim y As Variant\n     y = .Range(ys.Cells(var, 1), ys.Cells(var1, 1)).value\n     Dim x As Variant\n     x = .Range(xs.Cells(var, 1), xs.Cells(var1, 1)).value\n\n\n    .Range(\"g3\").value = Application.WorksheetFunction.Forecast(temp, y, x)\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 9524071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b102701c1173723a115aa31ae9d2a225?s=128&d=identicon&r=PG&f=1", "display_name": "dejioni", "link": "https://stackoverflow.com/users/9524071/dejioni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 664, "favorite_count": 0, "accepted_answer_id": 49542458, "answer_count": 1, "score": 0, "last_activity_date": 1522264885, "creation_date": 1522263178, "last_edit_date": 1531164843, "question_id": 49542116, "link": "https://stackoverflow.com/questions/49542116/non-linear-interpolation-with-the-forecast-function", "title": "Non linear Interpolation with the Forecast function", "body": "<p>I would like to do a nonlinear interpolation of a particular number in a column and get the equivalent number in the second column. It gives me a compiler error with list separator or )</p>\n\n<pre><code> Sub interp()\n Dim temp As Integer\n Dim var As Integer\n Dim var1 As Integer\n Dim xs As Range\n Dim ys As Range\n Set xs = Sheets(1).Range(\"A8:A19\")\n Set ys = Sheets(1).Range(\"B8:B19\")\n temp = Sheets(1).Range(\"E3\").Value\n Dim indexxs As Integer\n Dim indexys As Integer\n Dim indexxs1 As Integer\n Dim indexys1 As Integer\n\n\n var = WorksheetFunction.Match(temp, xs, 1)\n var1 = WorksheetFunction.Match(temp, xs, 1) + 1\n\n\n indexxs = Application.WorksheetFunction.Index(xs, var)\n indexxs1 = Application.WorksheetFunction.Index(xs, var1)\n indexys = Application.WorksheetFunction.Index(ys, var)\n indexys1 = Application.WorksheetFunction.Index(ys, var1)\n\n\n\n\n Sheets(1).Range(\"g3\").Value = Application.WorksheetFunction.Forecast(temp,indexys:indexys1,indexxs:indexxs1)\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9565439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecab41f1343aea5259696a598e0c533e?s=128&d=identicon&r=PG&f=1", "display_name": "DatabaseGangsta", "link": "https://stackoverflow.com/users/9565439/databasegangsta"}, "edited": false, "score": 0, "creation_date": 1522270363, "post_id": 49542947, "comment_id": 86095616, "body": "I appreciate the feedback; however, I&#39;m not allowed admin rights and therefore cannot download any add-ins."}], "tags": [], "owner": {"reputation": 73, "user_id": 8112768, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YwG2xyFC2F0/AAAAAAAAAAI/AAAAAAAAABI/0yQHQXxB65E/photo.jpg?sz=128", "display_name": "JMartinez", "link": "https://stackoverflow.com/users/8112768/jmartinez"}, "is_accepted": false, "score": 0, "last_activity_date": 1522266387, "creation_date": 1522266387, "answer_id": 49542947, "question_id": 49542026, "link": "https://stackoverflow.com/questions/49542026/convert-txt-file-to-xlsx-remove-unneeded-rows-format-columns-correctly/49542947#49542947", "title": "Convert .txt file to .xlsx &amp; remove unneeded rows &amp; format columns correctly", "body": "<p>I'd recommend you not to re-invent the wheel. Microsoft provides an excellent add-on to accomplish this task, Power Query.</p>\n\n<p>It lets you to load every file in a folder and process it in bulks.\n<a href=\"https://www.excelcampus.com/powerquery/power-query-overview/\" rel=\"nofollow noreferrer\">Here you have a brief introduction of what can do for you.</a></p>\n"}], "owner": {"reputation": 11, "user_id": 9565439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecab41f1343aea5259696a598e0c533e?s=128&d=identicon&r=PG&f=1", "display_name": "DatabaseGangsta", "link": "https://stackoverflow.com/users/9565439/databasegangsta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1522266387, "creation_date": 1522262867, "last_edit_date": 1522263322, "question_id": 49542026, "link": "https://stackoverflow.com/questions/49542026/convert-txt-file-to-xlsx-remove-unneeded-rows-format-columns-correctly", "title": "Convert .txt file to .xlsx &amp; remove unneeded rows &amp; format columns correctly", "body": "<p>I've got a folder which contains .txt files (they contain PHI, so I can't upload the .txt file, or an example without PHI, or even any images of it). I need an excel macro, which will allow the user to choose the folder containing the file, and will then insert the .txt file data into a new excel workbook, format the rows and columns appropriately, and finally save the file to the same folder that the source was found in. \nSo far I've got all of that working except for the formatting of rows and columns. As of now, the .txt data is inserted to a new workbook &amp; worksheet, but I can't seem to figure out how to get rid of rows I don't need, or how to get the columns formatted appropriately. </p>\n\n<p>Again, I can't upload the .txt file (or anything) because the Healthcare organization I work for blocks it - even if I've removed all PHI. </p>\n\n<p>Below is the macro I've created so far:</p>\n\n<pre><code>    Private Sub CommandButton2_Click()\n\n    On Error GoTo err\n\n    'Allow the user to choose the FOLDER where the TEXT file(s) are located\n    'The resulting EXCEL file will be saved in the same location\n        Dim FldrPath As String\n        Dim fldr As FileDialog\n        Dim fldrChosen As Integer\n\n        Set fldr = Application.FileDialog(msoFileDialogFolderPicker)\n        With fldr\n            .Title = \"Select a Folder containing the Text File(s)\"\n            .AllowMultiSelect = False\n            .InitialFileName = \"\\\\FILELOCATION\"\n            fldrChosen = .Show\n\n            If fldrChosen &lt;&gt; -1 Then\n                MsgBox \"You Chose to Cancel\"\n            Else\n                FldrPath = .SelectedItems(1)\n            End If\n\n        End With\n\n\n    If FldrPath &lt;&gt; \"\" Then\n\n        'Make a new workbook\n            Dim newWorkbook As Workbook\n            Set newWorkbook = Workbooks.Add\n\n        'Make worksheet1 of new workbook active\n            newWorkbook.Worksheets(1).Activate\n\n\n        'Completed files are saved in the chosen source file folder\n               Dim CurrentFile As String: CurrentFile = Dir(FldrPath &amp; \"\\\" &amp; \"*.txt\")\n               Dim strLine() As String\n               Dim LineIndex As Long\n\n               Application.ScreenUpdating = False\n               Application.DisplayAlerts = False\n               While CurrentFile &lt;&gt; vbNullString\n                   'How many rows to place in Excel ABOVE the data we are inserting\n                   LineIndex = 0\n                   Close #1\n                   Open FldrPath &amp; \"\\\" &amp; CurrentFile For Input As #1\n                   While Not EOF(1)\n                        'Adds number of rows below the inserted row of data\n                        LineIndex = LineIndex + 1\n\n                        ReDim Preserve strLine(1 To LineIndex)\n                        Line Input #1, strLine(LineIndex)\n\n                   Wend\n                   Close #1\n\n                   With ActiveSheet.Range(\"A1\").Resize(LineIndex, 1)\n                       .Value = WorksheetFunction.Transpose(strLine)\n                       .TextToColumns Other:=True, OtherChar:=\"|\"\n                   End With\n\n                   ActiveSheet.UsedRange.EntireColumn.AutoFit\n                   ActiveSheet.Name = Replace(CurrentFile, \".txt\", \"\")\n                    ActiveWorkbook.SaveAs FldrPath &amp; \"\\\" &amp; Replace(CurrentFile, \".txt\", \".xls\"), xlNormal\n                   ActiveWorkbook.Close\n\n                   CurrentFile = Dir\n               Wend\n               Application.DisplayAlerts = True\n               Application.ScreenUpdating = True\n    End If\n\n    Done:\n        Exit Sub\n\n    err:\n        MsgBox \"The following ERROR Occurred:\" &amp; vbNewLine &amp; err.Description\n        ActiveWorkbook.Close\n\n\n    End Sub\n</code></pre>\n\n<p>Any ideas of how I can delete entire lines from being brought into excel? \nAnd how I can format the columns appropriately? So that I'm not getting 3 columns from the .txt file all jammed into 1 column in the resulting excel file?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1522268493, "post_id": 49541684, "comment_id": 86094588, "body": "Are some of the column headers duplicated more than once? Are duplicated headers always adjacent to each other? And also, how many rows would the longest column have?"}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1522269537, "post_id": 49541684, "comment_id": 86095157, "body": "My money is on PowerQuery for this challenge. Writing robust VBA is hard. Doing this with PowerQuery is so easy it borders on trivial. It might be slightly slower on a very large data set - particularly when compared against a Dictionary approach such as Ron Rosenfield&#39;s great approach, but it is simple to the point that a non VBA developer can pick up the basics of PowerQuery in mere hours and often the basics is all you need to do something that would otherwise require quite advanced VBA. And it takes years for a non VBA developer to become a VBA developer."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1523046247, "post_id": 49541684, "comment_id": 86414322, "body": "So did you end up using any of the below approaches?"}], "answers": [{"comments": [{"owner": {"reputation": 161, "user_id": 5116096, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/c717c7306b8fe66f91656a0f5496b805?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Oliver", "link": "https://stackoverflow.com/users/5116096/brent-oliver"}, "edited": false, "score": 0, "creation_date": 1522263609, "post_id": 49542132, "comment_id": 86091911, "body": "Did not work, that deleted some of the columns with duplicate header names, but did not merge any of the data prior to deletion. Still have (some) duplicate headers as well."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 161, "user_id": 5116096, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/c717c7306b8fe66f91656a0f5496b805?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Oliver", "link": "https://stackoverflow.com/users/5116096/brent-oliver"}, "edited": false, "score": 0, "creation_date": 1522263808, "post_id": 49542132, "comment_id": 86092011, "body": "@BrentOliver Works fine on my sample data and the data you posted as well, no issues here - something is different in your actual data than from what you&#39;ve posted - Are your headers in row 1, data beginning in column A?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 161, "user_id": 5116096, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/c717c7306b8fe66f91656a0f5496b805?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Oliver", "link": "https://stackoverflow.com/users/5116096/brent-oliver"}, "edited": false, "score": 0, "creation_date": 1522263981, "post_id": 49542132, "comment_id": 86092116, "body": "@BrentOliver I can see that one issue is how I&#39;m getting the last row of data, but that should still merge in 90% of it."}, {"owner": {"reputation": 161, "user_id": 5116096, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/c717c7306b8fe66f91656a0f5496b805?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Oliver", "link": "https://stackoverflow.com/users/5116096/brent-oliver"}, "edited": false, "score": 0, "creation_date": 1522264055, "post_id": 49542132, "comment_id": 86092141, "body": "The data in columns A-W is identifying data for the row in question. Columns X on are as shown in sample data. Just removed A-W and reran. Deleted more data, but nothing merged. Real data has large amount of blank cells (either 150 or 200 cells on each row of over 3000 is populated."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 161, "user_id": 5116096, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/c717c7306b8fe66f91656a0f5496b805?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Oliver", "link": "https://stackoverflow.com/users/5116096/brent-oliver"}, "edited": false, "score": 0, "creation_date": 1522264449, "post_id": 49542132, "comment_id": 86092344, "body": "@BrentOliver I can&#39;t do much more for you with what you&#39;ve given me to work with - If it works on your sample data but not on your actual worksheet, then your sample data is not a true depiction of your real data."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1522268817, "post_id": 49542132, "comment_id": 86094775, "body": "@dwirony Perhaps the issue is due to more than one duplicate column, plus duplicate columns not always being located adjacent to each other, as per my question above."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1522269319, "post_id": 49542132, "comment_id": 86095052, "body": "@dwirony There&#39;s a couple of issues with your code as written. First, when deleting columns in a loop you need to work from right to left and use a negative step. Otherwise your code will skip the column that just took the place of the one you just deleted. Second, your line If lastrow &lt; lastrow2 should be If lastrow &gt; lastrow2 (This doesn&#39;t effect output, but is just an efficiency thing). There&#39;s a couple more changes I&#39;d make, and I might post a rewrite shortly to demonstrate."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1522273065, "post_id": 49542132, "comment_id": 86096867, "body": "@jeffreyweir The poster gave minimal data to work with so I assumed here could only be 2 columns (1 duplicate). In that case, I don&#39;t need to step backwards through my loop because it wouldn&#39;t matter. I see the efficiency part that you&#39;re talking about regarding lastrow, but the output is the same so I&#39;m not worried about it."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 1, "creation_date": 1522273987, "post_id": 49542132, "comment_id": 86097223, "body": "Point taken: if your assumptions were correct, no need for negative loop. That&#39;s the problem with working off requirements derived from sample data. I think the OP did a reasonable job of providing starter-for-10 sample data...but they don&#39;t know what you need to know for this specific approach. Whereas the other two approaches (PQ, Dictionary) didn&#39;t need anything more from the OP: they are both robust to multiple columns and don&#39;t even care about column order. But gotta say your comment that your not &quot;worried&quot; about efficiency has me scratching my head. Isn&#39;t that what we strive for?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1522417237, "post_id": 49542132, "comment_id": 86158428, "body": "@jeffreyweir The assignment of value to <code>lastrow</code> would be so minimal that no one would ever notice that kind of difference... It completely depends on the kind of efficiency we&#39;re talking about here."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1522442028, "post_id": 49542132, "comment_id": 86170053, "body": "So what &quot;other&quot; types of efficiency are there?"}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": -1, "last_activity_date": 1522264071, "last_edit_date": 1522264071, "creation_date": 1522263236, "answer_id": 49542132, "question_id": 49541684, "link": "https://stackoverflow.com/questions/49541684/merging-data-in-excel/49542132#49542132", "title": "Merging data in Excel", "body": "<p>This might work for you:</p>\n\n<pre><code>Sub Test()\n\nDim lastcol As Long, lastrow As Long, lastrow2 As Long, i As Long, j As Long, k As Long\n\nlastcol = ActiveSheet.Cells(1, ActiveSheet.Columns.Count).End(xlToLeft).Column\n\nFor i = 1 To lastcol\n    For j = i To lastcol\n        If Cells(1, i).Value = Cells(1, j).Value And i &lt;&gt; j Then 'Merge em\n            lastrow = ActiveSheet.Cells(ActiveSheet.Rows.Count, i).End(xlUp).Row\n            lastrow2 = ActiveSheet.Cells(ActiveSheet.Rows.Count, j).End(xlUp).Row\n\n            If lastrow &lt; lastrow2 Then\n                lastrow = lastrow2\n            End If\n\n                For k = 2 To lastrow\n                    If Cells(k, j).Value &lt;&gt; \"\" Then\n                        Cells(k, i).Value = Cells(k, j).Value\n                    End If\n                Next k\n\n                Columns(j).Delete Shift:=xlToLeft\n                Exit For\n        End If\n    Next j\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>Test data:</p>\n\n<p><a href=\"https://i.stack.imgur.com/YWYmb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YWYmb.png\" alt=\"TestData\"></a></p>\n\n<p>On your test data:</p>\n\n<p><a href=\"https://i.stack.imgur.com/B1dGF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/B1dGF.png\" alt=\"TestData2\"></a></p>\n\n<p>Not sure why my picture isn't coming through... Sorry about that. EDIT: Looks like it's working now.</p>\n"}, {"tags": [], "owner": {"reputation": 1946, "user_id": 8828524, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z001KmBq-2Y/AAAAAAAAAAI/AAAAAAAAIlU/paK7lD3iHuw/photo.jpg?sz=128", "display_name": "virtualdvid", "link": "https://stackoverflow.com/users/8828524/virtualdvid"}, "is_accepted": false, "score": 2, "last_activity_date": 1522283611, "last_edit_date": 1522283611, "creation_date": 1522265587, "answer_id": 49542744, "question_id": 49541684, "link": "https://stackoverflow.com/questions/49541684/merging-data-in-excel/49542744#49542744", "title": "Merging data in Excel", "body": "<p>You can do this easily with <strong>Power query</strong>. It is an add-in for Excel 2010+ (by default in Excel 2016 known as Get &amp; Transform). There you can connect directly Excel with any source of data and then transform the data in the Query Editor. For your case follow this steps:</p>\n\n<p><a href=\"https://i.stack.imgur.com/MQanp.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MQanp.gif\" alt=\"\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1522274530, "post_id": 49543012, "comment_id": 86097439, "body": "This is really clever, Ron. Probably only thing I would change is go with late bound to avoid the need to set a reference. But I like your approach!"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1522286700, "post_id": 49543012, "comment_id": 86100676, "body": "@jeffreyweir Thanks.  I generally prefer early-binding as it is a bit more efficient, usually enables intellisense, and also shows the reference in the Object Browser. For me, this makes code development easier.  For distribution, and sometimes to maintain changing reference issues, late-binding certainly has an advantage.  It&#39;s trivial to change the above code to incorporate late-binding."}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 2, "last_activity_date": 1522273052, "last_edit_date": 1522273052, "creation_date": 1522266673, "answer_id": 49543012, "question_id": 49541684, "link": "https://stackoverflow.com/questions/49541684/merging-data-in-excel/49543012#49543012", "title": "Merging data in Excel", "body": "<p>Hopefully this should work.\nI use a dictionary storing arrays to dedupe the columns.\nNote that you MUST set a reference as in the comments (or make some small changes to use late-binding).  And also you will need to change the source and results worksheet names to align with your data.</p>\n\n<p>Furthermore, an assumption is that the source data table is the only thing on this worksheet, and it starts in <code>A1</code>.  The <code>LastRowCol</code> function detects the end point of the data.</p>\n\n<p>If your source data table does not meet these requirements, changes will need to be made to detect the correct data area.</p>\n\n<pre><code>'Set reference to Microsoft Scripting Runtime\nOption Explicit\nSub CombineColumns()\n    Dim wsSrc As Worksheet, wsRes As Worksheet, rRes As Range\n    Dim vSrc As Variant, vRes As Variant\n    Dim dD As Dictionary\n    Dim I As Long, J As Long\n    Dim lLastRowCol() As Long\n    Dim V() As Variant\n\n'set Source and REsults worksheets, ranges\n Set wsSrc = Worksheets(\"sheet5\")\n Set wsRes = Worksheets(\"sheet6\")\n    Set rRes = wsRes.Cells(1, 1)\n\n'Get source data into vba array\nWith wsSrc\n    lLastRowCol = LastRowCol(wsSrc.Name)\n    vSrc = .Range(.Cells(1, 1), .Cells(lLastRowCol(0), lLastRowCol(1)))\nEnd With\n\n'Collect and merge the data\nSet dD = New Dictionary\nReDim V(2 To UBound(vSrc, 1))\nFor J = 1 To UBound(vSrc, 2)\n    If Not dD.Exists(vSrc(1, J)) Then 'set new dictionary item\n        For I = 2 To UBound(vSrc, 1)\n            V(I) = vSrc(I, J)\n        Next I\n        dD.Add Key:=vSrc(1, J), Item:=V\n    Else 'combine the columns\n        For I = 2 To UBound(vSrc, 1)\n            If vSrc(I, J) &lt;&gt; \"\" Then\n                V = dD(vSrc(1, J))\n                V(I) = vSrc(I, J)\n                dD(vSrc(1, J)) = V\n            End If\n        Next I\n    End If\nNext J\n\n'Write results to output array\nReDim vRes(0 To UBound(vSrc, 1) - 1, 1 To dD.Count)\n\n'Headers\nJ = 0\nDim V1 As Variant\nFor Each V1 In dD.Keys\n    J = J + 1\n    vRes(0, J) = V1\nNext V1\n\n'Data\nFor J = 1 To UBound(vRes, 2)\n    I = 0\n    For Each V1 In dD(vRes(0, J))\n        I = I + 1\n        vRes(I, J) = V1\n    Next V1\nNext J\n\n'write the results\nSet rRes = rRes.Resize(UBound(vRes, 1) + 1, UBound(vRes, 2))\nWith rRes\n    .EntireColumn.Clear\n    .Value = vRes\n    With .Rows(1)\n        .Font.Bold = True\n        .HorizontalAlignment = xlCenter\n    End With\n    .EntireColumn.AutoFit\nEnd With\n\nEnd Sub\n\nPrivate Function LastRowCol(Worksht As String) As Long()\n    Dim WS As Worksheet, R As Range\n    Dim LastRow As Long, LastCol As Long\n    Dim L(1) As Long\nSet WS = Worksheets(Worksht)\nWith WS\n    Set R = .Cells.Find(what:=\"*\", after:=.Cells(1, 1), _\n                    LookIn:=xlValues, searchorder:=xlByRows, _\n                    searchdirection:=xlPrevious)\n\n    If Not R Is Nothing Then\n        LastRow = R.Row\n        LastCol = .Cells.Find(what:=\"*\", after:=.Cells(1, 1), _\n                    LookIn:=xlValues, searchorder:=xlByColumns, _\n                    searchdirection:=xlPrevious).Column\n    Else\n        LastRow = 1\n        LastCol = 1\n    End If\nEnd With\n\nL(0) = LastRow\nL(1) = LastCol\nLastRowCol = L\nEnd Function\n</code></pre>\n\n<p><strong>Original Data</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/MbJjF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MbJjF.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Combined</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/xbLUf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xbLUf.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": false, "score": 0, "last_activity_date": 1522274764, "last_edit_date": 1522274764, "creation_date": 1522272064, "answer_id": 49544384, "question_id": 49541684, "link": "https://stackoverflow.com/questions/49541684/merging-data-in-excel/49544384#49544384", "title": "Merging data in Excel", "body": "<p>PowerQuery is by far the best tool for this, because you can whip together a solution in mere minutes without expending too much brain power. </p>\n\n<p>But for completeness, here's a VBA solution that will do what you want, and that also handles more than two duplicate columns. It assumes these columns will always be located alongside, as with your sample data.</p>\n\n<p>This took me between 30mins and 60mins to put together and troubleshoot, because I was trying to optimize and dealing with columns you delete takes a bit of thought. By contrast, putting together a solution in PQ probably would have taken me mere minutes. That's why I voted for the approach that @virtualdvid took. And in terms of efficiency and robustness, my approach isn't as fast or robust as Rick's Dictionary approach below. This horse would come in a distant third compared to PQ or Dictionary.</p>\n\n<pre><code>Sub Test()\n\nDim lLastRow As Long\nDim lLastCol As Long\nDim i As Long\nDim j As Long\nDim k As Long\nDim sHeader1 As String\nDim sHeader2 As String\n\nlLastCol = ActiveSheet.Cells(1, ActiveSheet.Columns.Count).End(xlToLeft).Column\n\nFor i = lLastCol To 1 Step -1\n    sHeader1 = Cells(1, i)\n    For j = i - 1 To 1 Step -1\n        sHeader2 = Cells(1, j)\n        If sHeader2 &lt;&gt; sHeader1 Then Exit For\n        If sHeader1 = sHeader2 Then\n            lLastRow = ActiveSheet.Cells(ActiveSheet.Rows.Count, i).End(xlUp).Row\n            For k = 2 To lLastRow\n                If Cells(k, i).Value &lt;&gt; \"\" Then\n                    Cells(k, j).Value = Cells(k, i).Value\n                End If\n            Next k\n            Columns(i).Delete Shift:=xlToLeft\n        End If\n    Next j\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>Note that this is not optimal VBA. You can optimize this further by turning off screenupdating. Even better, don't bother doing that but instead pull ALL the data into VBA in one go in a Variant Array, do the consolidation there using similar code, then dump it back into the worksheet in one go. And even better than that would be a Dictionary approach similar to Ricks. </p>\n"}], "owner": {"reputation": 161, "user_id": 5116096, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/c717c7306b8fe66f91656a0f5496b805?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Oliver", "link": "https://stackoverflow.com/users/5116096/brent-oliver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1522283611, "creation_date": 1522261728, "last_edit_date": 1531161705, "question_id": 49541684, "link": "https://stackoverflow.com/questions/49541684/merging-data-in-excel", "title": "Merging data in Excel", "body": "<p>Working with Excel files that contain over 3000 columns, and having an issue that there are several column headers that are duplicated. When this data is fed into another system it errors out. Looking for a way to merge the columns in the spreadsheet. Same header can appear in two to six columns, but each row of data only populates a single column.</p>\n\n<p>I have seen one post that merges the column headers of the duplicates are next to each other, and I can do this (as I have in my sample data), but that post only merges the header data.</p>\n\n<p>Not sure how to attach sample data, but hope people can see this:</p>\n\n<pre><code>1350725  1350725  1350740  1350813  1351468 1351468\nB                          A        C\n         A        C        B                E\nC                 D        C        E  \nA                 C        C        D\nB                          E                B\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 5, "creation_date": 1522257639, "post_id": 49540518, "comment_id": 86088449, "body": "It&#39;s because you have &quot;endless&quot; <code>If</code>s and <code>Else</code> with enough <code>End If</code> to close all your <code>If</code>s. change to <code>Select Case mes</code> , and then nested below <code>Case &quot;01&quot;</code> etc..."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1522259104, "post_id": 49540518, "comment_id": 86089263, "body": "Pasting your procedure into <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">this online indenter</a> should give you an idea of what&#39;s going on / how VBA is understanding this code."}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1522259384, "post_id": 49540518, "comment_id": 86089432, "body": "You have 7 Do&#39;s and 7 Loop(s), but your termination of IF and use of ELSE certainly won&#39;t compile.  Every IF block needs an END IF, count your IFs and your END IFs and place appropriately to close the logic or use Case Select structure for readability."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1522259455, "post_id": 49540518, "comment_id": 86089483, "body": "@MathieuGuindon what happened to the famous &quot;Mat&#39;s Mug&quot; ?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1522259572, "post_id": 49540518, "comment_id": 86089542, "body": "@ShaiRado I&#39;m <a href=\"https://codereview.meta.stackexchange.com/q/8654/23788\">putting down my mug</a> (stepping down as a moderator on CR), and decided to &quot;unify&quot; all my online profiles - so I now have the same handle and <i>mugshot</i> everywhere (except on Twitter, where I&#39;m remaining <code>@rubberduckvba</code>) =)"}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1522267547, "post_id": 49540518, "comment_id": 86094059, "body": "Hint: Any time you see repeating code (like copy and pasted with small changes) it is time to move the code in a subroutine.Then the structure of the program becomes more apparent and you will notice where you are missing an <code>End If</code> or <code>Loop</code> statement."}], "answers": [{"comments": [{"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1522267329, "post_id": 49541153, "comment_id": 86093923, "body": "There is still a lot of repeating code. I would recommend getting rid <code>celula1_linha_startdate = Range(&quot;B10&quot;).Row</code> type statements since it will always evaluate to 10. The rows can be hardcoded in an array, or better yet stored in a separate sheet for more flexibility."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 1, "creation_date": 1522268735, "post_id": 49541153, "comment_id": 86094731, "body": "@ja I did think about doing clever matching the array positions to the result of the <code>Select Case</code> (like if it&#39;s 1, 5, etc.), but I didn&#39;t want to over-complicate things for the poster. I might come back tomorrow and write a whole new solution from scratch :)."}, {"owner": {"reputation": 7, "user_id": 9565462, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Paula Espinosa Santos", "link": "https://stackoverflow.com/users/9565462/paula-espinosa-santos"}, "edited": false, "score": 0, "creation_date": 1522342376, "post_id": 49541153, "comment_id": 86130796, "body": "thank you very much for the help!! it helped A LOT! really! I am still having problems with these 2 lines here:mes_startdate = Mid(Cells(j, 9), 4, 2);  mes_enddate = Mid(Cells(j, 10), 4, 2). It says that it  says &quot;type mismatch&quot;. Do you have any idea of whats going on?"}, {"owner": {"reputation": 7, "user_id": 9565462, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Paula Espinosa Santos", "link": "https://stackoverflow.com/users/9565462/paula-espinosa-santos"}, "edited": false, "score": 0, "creation_date": 1522343415, "post_id": 49541153, "comment_id": 86131355, "body": "I have another question: when you use my array it means both &quot;components&quot; of the needs to be equal at the same time to 01 or 02 or 03 etc.?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 7, "user_id": 9565462, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Paula Espinosa Santos", "link": "https://stackoverflow.com/users/9565462/paula-espinosa-santos"}, "edited": false, "score": 0, "creation_date": 1522346250, "post_id": 49541153, "comment_id": 86132778, "body": "@PaulaEspinosaSantos You&#39;re getting a <code>Type Mismatch</code> there because you&#39;re trying to get an integer from that, but somehow you&#39;re getting something that isn&#39;t numeric with your <code>Mid</code> formula. You could try changing their types to <code>Variant</code> and see what your <code>Mid</code> formula is actually pulling."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1522346296, "post_id": 49541153, "comment_id": 86132810, "body": "And to your second point, no, that array is just testing the first one (separately), then testing the second one. It just substitutes the second one in after testing for the first one - they can still have different values."}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 3, "last_activity_date": 1522262324, "last_edit_date": 1522262324, "creation_date": 1522259666, "answer_id": 49541153, "question_id": 49540518, "link": "https://stackoverflow.com/questions/49540518/loop-without-a-do/49541153#49541153", "title": "Loop without a do", "body": "<p>Holyyy wow you've got a lot here - so I took a <em>shot</em> at cleaning this up for you because I've been there before, so I know your pain. A couple notes...</p>\n\n<ol>\n<li><p>Put <code>Option Explicit</code> at the start of your modules and move all your declarations (<code>Dim</code>) to the top of the subroutine (outside of your loops). You can save some space by putting similar declarations on the same line, as I have here.</p></li>\n<li><p>You need to utilize <code>Select Case</code>, <code>ElseIf</code> and arrays. I just go through 1 <code>Select Case</code> twice to get your values that you need for <code>mes_startdate</code> and <code>mes_enddate</code>. Another thing to note - not all <code>If</code> statements need an <code>Else</code> with them. If there's no case for <code>Else</code>, just exclude it altogether!</p></li>\n<li><p>When changing the <code>Interior.Color</code> of a cell, you can kind of cheat by <em>only</em> changing the color, and leaving out the other details (if they're not changing).  That was able to cut out a lot of clutter. <strong>Note how I also got rid of <code>Select</code> by just explicitly referring to the cells!</strong></p></li>\n</ol>\n\n<p>There are others things in here that I cleaned up, but I'd just say you should compare and look for those changes yourself. I actually have no clue what you're trying to accomplish here, so this might not <em>work</em> but it's in the right format to move forward from here.</p>\n\n<pre><code>Option Explicit\nSub days()\n\n    Dim i As Long, j As Long\n    Dim mes_startdate As Integer, mes_enddate As Integer\n    Dim startdate As Date, enddate As Date\n    Dim teammember As String, coursetype As String\n    Dim celula1_linha_startdate As Integer, celula1_linha_enddate As Integer\n    Dim nome_linha As Integer\n    Dim startdate_coluna As Integer, enddate_coluna As Integer\n    Dim myarray As Variant\n\n    myarray = Array(mes_startdate, mes_enddate)\n    Sheets(\"Costs\").Activate\n\n    j = 2\n\n    Do Until Cells(j, 9) = \"\"\n\n        mes_startdate = Mid(Cells(j, 9), 4, 2)\n        mes_enddate = Mid(Cells(j, 10), 4, 2)\n        startdate = Cells(j, 9).Value\n        enddate = Cells(j, 10).Value\n        teammember = Cells(j, 2).Value\n        coursetype = Cells(j, 4).Value\n\n        Sheets(\"Days\").Activate\n\n        For i = 0 To UBound(myarray)\n            Select Case myarray(i)\n            Case \"01\"\n                celula1_linha_startdate = Range(\"B10\").Row\n            Case \"02\"\n                celula1_linha_startdate = Range(\"B31\").Row\n            Case \"03\"\n                celula1_linha_startdate = Range(\"B52\").Row\n            Case \"04\"\n                celula1_linha_startdate = Range(\"B73\").Row\n            Case \"05\"\n                celula1_linha_startdate = Range(\"B93\").Row\n            Case \"06\"\n                celula1_linha_startdate = Range(\"B113\").Row\n            Case \"07\"\n                celula1_linha_startdate = Range(\"B133\").Row\n            Case \"08\"\n                celula1_linha_startdate = Range(\"B153\").Row\n            Case \"09\"\n                celula1_linha_startdate = Range(\"B173\").Row\n            Case \"10\"\n                celula1_linha_startdate = Range(\"B173\").Row\n            Case \"11\"\n                celula1_linha_startdate = Range(\"B193\").Row\n            Case \"12\"\n                celula1_linha_startdate = Range(\"B213\").Row\n            End Select\n        Next i\n\n        nome_linha = celula1_linha_startdate + 2\n\n        Do Until Cells(nome_linha, 1).Value = teammember\n            nome_linha = celula1_linha_startdate + 1\n        Loop\n\n        startdate_coluna = 2\n\n        Do Until Cells(celula1_linha_startdate, startdate_coluna).Value = startdate\n            startdate_coluna = startdate_coluna + 1\n        Loop\n\n        enddate_coluna = 2\n\n        Do Until Cells(celula1_linha_enddate, enddate_coluna).Value = enddate\n            enddate_coluna = enddate_coluna + 1\n        Loop\n\n        If mes_startdate = mes_enddate Then\n\n            Do Until Cells(celula1_linha_startdate, startdate_coluna).Value = Cells(celula1_linha_enddate, enddate_coluna).Value\n\n                If coursetype = \"E-learning\" Then\n                    Cells(nome_linha, startdate_coluna).Interior.ThemeColor = xlThemeColorAccent6\n                ElseIf coursetype = \"International Courses\" Then\n                    Cells(nome_linha, startdate_coluna).Interior.Color = 10498160\n                ElseIf coursetype = \"National Courses Inside Rio de Janeiro\" Then\n                    Cells(nome_linha, startdate_coluna).Interior.Color = 49407\n                ElseIf coursetype = \"National Courses Outside Rio de Janeiro\" Then\n                    Cells(nome_linha, startdate_coluna).Interior.Color = 12611584\n                ElseIf coursetype = \"Other Courses\" Then\n                    Cells(nome_linha, startdate_coluna).Interior.Color = 192\n                End If\n\n                startdate_coluna = startdate_coluna + 1\n\n            Loop\n\n        Else\n\n            Do Until Cells(celula1_linha_startdate, startdate_coluna).Value = Cells(celula1_linha_startdate, 32).Value\n\n                If coursetype = \"E-learning\" Then\n                    Cells(nome_linha, enddate_coluna).Interior.ThemeColor = xlThemeColorAccent6\n                ElseIf coursetype = \"International Courses\" Then\n                    Cells(nome_linha, enddate_coluna).Interior.Color = 10498160\n                ElseIf coursetype = \"National Courses Inside Rio de Janeiro\" Then\n                    Cells(nome_linha, enddate_coluna).Interior.Color = 49407\n                ElseIf coursetype = \"National Courses Outside Rio de Janeiro\" Then\n                    Cells(nome_linha, enddate_coluna).Interior.Color = 12611584\n                ElseIf coursetype = \"Other Courses\" Then\n                    Cells(nome_linha, enddate_coluna).Interior.Color = 192\n                End If\n\n                startdate_coluna = startdate_coluna + 1\n            Loop\n\n            Do Until Cells(celula1_linha_enddate, enddate_coluna).Value = Cells(celula1_linha_enddate, 1).Value\n\n                If coursetype = \"E-learning\" Then\n                    Cells(nome_linha, enddate_coluna).Interior.ThemeColor = xlThemeColorAccent6\n                ElseIf coursetype = \"International Courses\" Then\n                    Cells(nome_linha, enddate_coluna).Interior.Color = 10498160\n                ElseIf coursetype = \"National Courses Inside Rio de Janeiro\" Then\n                    Cells(nome_linha, enddate_coluna).Interior.Color = 49407\n                ElseIf coursetype = \"National Courses Outside Rio de Janeiro\" Then\n                    Cells(nome_linha, enddate_coluna).Interior.Color = 12611584\n                ElseIf coursetype = \"Other Courses\" Then\n                    Cells(nome_linha, enddate_coluna).Interior.Color = 192\n                End If\n\n                enddate_coluna = enddate_coluna - 1\n            Loop\n\n        End If\n\n        j = j + 1\n\n    Loop\n\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT</strong> I put this in Mat's <a href=\"http://rubberduckvba.com/Indentation\" rel=\"nofollow noreferrer\">Rubberduck Indenter</a> because I could see it was a bit all over the place, and I didn't feel like fixing that myself so I used this great tool! :)</p>\n"}], "owner": {"reputation": 7, "user_id": 9565462, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Paula Espinosa Santos", "link": "https://stackoverflow.com/users/9565462/paula-espinosa-santos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1522280758, "creation_date": 1522257288, "last_edit_date": 1522257916, "question_id": 49540518, "link": "https://stackoverflow.com/questions/49540518/loop-without-a-do", "title": "Loop without a do", "body": "<p>I don't know why VBA keeps returning me the message \"loop without a do\" for the following structure.</p>\n\n<p>The error is related with the last \"loop\", that should be related with the first\nDo Until(Do Until Cells(j, 9) &lt;> \"\")</p>\n\n<p>Ps: the idea is to have a form that will feed the sheet costs, where we can find start date, end date, course type and team members name.\nThen, depending on course type, it should go to the other sheet (days), where you will find a calendar divided by months. Excel should find the right start and end date, then the right team member name and then, depending on course type, it should paint the cells between start and end date of different colours.</p>\n\n<p>Can someone help me?</p>\n\n<pre><code>Sub days()\n\n  Sheets(\"Costs\").Activate\n\n    j = 2\n  Do Until Cells(j, 9) = \"\"\n    Dim mes_startdate As Integer\n    mes_startdate = Mid(Cells(j, 9), 4, 2)\n    Dim mes_enddate As Integer\n    mes_enddate = Mid(Cells(j, 10), 4, 2)\n    Dim startdate As Date\n    startdate = Cells(j, 9).Value\n    Dim enddate As Date\n    enddate = Cells(j, 10).Value\n    Dim teammember As String\n    teammember = Cells(j, 2).Value\n    Dim coursetype As String\n    coursetype = Cells(j, 4).Value\n\n        Sheets(\"Days\").Activate\n\n        Dim celula1_linha_startdate As Integer\n\n        If mes_startdate = \"01\" Then\n            celula1_linha_startdate = Range(\"B10\").Row\n        Else\n        If mes_startdate = \"02\" Then\n            celula1_linha_startdate = Range(\"B31\").Row\n        Else\n        If mes_startdate = \"03\" Then\n            celula1_linha_startdate = Range(\"B52\").Row\n        Else\n        If mes_startdate = \"04\" Then\n            celula1_linha_startdate = Range(\"B73\").Row\n        Else\n        If mes_startdate = \"05\" Then\n            celula1_linha_startdate = Range(\"B93\").Row\n        Else\n        If mes_startdate = \"06\" Then\n            celula1_linha_startdate = Range(\"B113\").Row\n        Else\n        If mes_startdate = \"07\" Then\n            celula1_linha_startdate = Range(\"B133\").Row\n        Else\n        If mes_startdate = \"08\" Then\n            celula1_linha_startdate = Range(\"B153\").Row\n        Else\n        If mes_startdate = \"09\" Then\n            celula1_linha_startdate = Range(\"B173\").Row\n        Else\n        If mes_startdate = \"10\" Then\n            celula1_linha_startdate = Range(\"B173\").Row\n        Else\n        If mes_startdate = \"11\" Then\n            celula1_linha_startdate = Range(\"B193\").Row\n        Else\n        If mes_startdate = \"12\" Then\n            celula1_linha_startdate = Range(\"B213\").Row\n        Else\n        End If\n\n        If mes_enddate = \"01\" Then\n            celula1_linha_enddate = Range(\"B10\").Row\n        Else\n        If mes_enddate = \"02\" Then\n            celula1_linha_enddate = Range(\"B31\").Row\n        Else\n        If mes_enddate = \"03\" Then\n            celula1_linha_enddate = Range(\"B52\").Row\n        Else\n        If mes_enddate = \"04\" Then\n            celula1_linha_enddate = Range(\"B73\").Row\n        Else\n        If mes_enddate = \"05\" Then\n            celula1_linha_enddate = Range(\"B93\").Row\n        Else\n        If mes_enddate = \"06\" Then\n            celula1_linha_enddate = Range(\"B113\").Row\n        Else\n        If mes_enddate = \"07\" Then\n            celula1_linha_enddate = Range(\"B133\").Row\n        Else\n        If mes_enddate = \"08\" Then\n            celula1_linha_enddate = Range(\"B153\").Row\n        Else\n        If mes_enddate = \"09\" Then\n            celula1_linha_enddate = Range(\"B173\").Row\n        Else\n        If mes_enddate = \"10\" Then\n            celula1_linha_enddate = Range(\"B173\").Row\n        Else\n        If mes_enddate = \"11\" Then\n            celula1_linha_enddate = Range(\"B193\").Row\n        Else\n        If mes_enddate = \"12\" Then\n            celula1_linha_enddate = Range(\"B213\").Row\n        Else\n        End If\n\n        nome_linha = celula1_linha_startdate + 2\n\n        Do Until Cells(nome_linha, 1).Value = teammember\n\n            nome_linha = celula1_linha_startdate + 1\n\n        Loop\n\n        startdate_coluna = 2\n\n        Do Until Cells(celula1_linha_startdate, startdate_coluna).Value = startdate\n\n            startdate_coluna = startdate_coluna + 1\n\n        Loop\n\n        enddate_coluna = 2\n\n        Do Until Cells(celula1_linha_enddate, enddate_coluna).Value = enddate\n\n            enddate_coluna = enddate_coluna + 1\n\n        Loop\n\n    If mes_startdate = mes_enddate Then\n\n        Do Until Cells(celula1_linha_startdate, startdate_coluna).Value = Cells(celula1_linha_enddate, enddate_coluna).Value\n\n        If coursetype = \"E-learning\" Then\n            Cells(nome_linha, startdate_coluna).Select\n            With Selection.Interior\n            .Pattern = xlSolid\n            .PatternColorIndex = xlAutomatic\n            .ThemeColor = xlThemeColorAccent6\n            .TintAndShade = 0\n            .PatternTintAndShade = 0\n            End With\n        Else\n        End If\n        If coursetype = \"International Courses\" Then\n            Cells(nome_linha, startdate_coluna).Select\n            With Selection.Interior\n            .Pattern = xlSolid\n            .PatternColorIndex = xlAutomatic\n            .Color = 10498160\n            .TintAndShade = 0\n            .PatternTintAndShade = 0\n            End With\n        Else\n        End If\n        If coursetype = \"National Courses Inside Rio de Janeiro\" Then\n            Cells(nome_linha, startdate_coluna).Select\n            With Selection.Interior\n            .Pattern = xlSolid\n            .PatternColorIndex = xlAutomatic\n            .Color = 49407\n            .TintAndShade = 0\n            .PatternTintAndShade = 0\n            End With\n        Else\n        End If\n        If coursetype = \"National Courses Outside Rio de Janeiro\" Then\n            Cells(nome_linha, startdate_coluna).Select\n            With Selection.Interior\n            .Pattern = xlSolid\n            .PatternColorIndex = xlAutomatic\n            .Color = 12611584\n            .TintAndShade = 0\n            .PatternTintAndShade = 0\n            End With\n        Else\n        End If\n        If coursetype = \"Other Courses\" Then\n            Cells(nome_linha, startdate_coluna).Select\n            With Selection.Interior\n            .Pattern = xlSolid\n            .PatternColorIndex = xlAutomatic\n            .Color = 192\n            .TintAndShade = 0\n            .PatternTintAndShade = 0\n            End With\n        Else\n        'Nothing should happen\n        End If\n\n        startdate_coluna = startdate_coluna + 1\n\n        Loop\n    Else\n        Do Until Cells(celula1_linha_startdate, startdate_coluna).Value = Cells(celula1_linha_startdate, 32).Value\n\n        If coursetype = \"E-learning\" Then\n            Cells(nome_linha, enddate_coluna).Select\n            With Selection.Interior\n            .Pattern = xlSolid\n            .PatternColorIndex = xlAutomatic\n            .ThemeColor = xlThemeColorAccent6\n            .TintAndShade = 0\n            .PatternTintAndShade = 0\n            End With\n        Else\n        End If\n        If coursetype = \"International Courses\" Then\n            Cells(nome_linha, enddate_coluna).Select\n            With Selection.Interior\n            .Pattern = xlSolid\n            .PatternColorIndex = xlAutomatic\n            .Color = 10498160\n            .TintAndShade = 0\n            .PatternTintAndShade = 0\n            End With\n        Else\n        End If\n        If coursetype = \"National Courses Inside Rio de Janeiro\" Then\n            Cells(nome_linha, enddate_coluna).Select\n            With Selection.Interior\n            .Pattern = xlSolid\n            .PatternColorIndex = xlAutomatic\n            .Color = 49407\n            .TintAndShade = 0\n            .PatternTintAndShade = 0\n            End With\n        Else\n        End If\n        If coursetype = \"National Courses Outside Rio de Janeiro\" Then\n            Cells(nome_linha, enddate_coluna).Select\n            With Selection.Interior\n            .Pattern = xlSolid\n            .PatternColorIndex = xlAutomatic\n            .Color = 12611584\n            .TintAndShade = 0\n            .PatternTintAndShade = 0\n            End With\n        Else\n        End If\n        If coursetype = \"Other Courses\" Then\n            Cells(nome_linha, enddate_coluna).Select\n            With Selection.Interior\n            .Pattern = xlSolid\n            .PatternColorIndex = xlAutomatic\n            .Color = 192\n            .TintAndShade = 0\n            .PatternTintAndShade = 0\n            End With\n        Else\n        'Nothing should happen\n        End If\n\n        startdate_coluna = startdate_coluna + 1\n        Loop\n\n\n        Do Until Cells(celula1_linha_enddate, enddate_coluna).Value = Cells(celula1_linha_enddate, 1).Value\n\n        If coursetype = \"E-learning\" Then\n            Cells(nome_linha, enddate_coluna).Select\n            With Selection.Interior\n            .Pattern = xlSolid\n            .PatternColorIndex = xlAutomatic\n            .ThemeColor = xlThemeColorAccent6\n            .TintAndShade = 0\n            .PatternTintAndShade = 0\n            End With\n        Else\n        End If\n        If coursetype = \"International Courses\" Then\n            Cells(nome_linha, enddate_coluna).Select\n            With Selection.Interior\n            .Pattern = xlSolid\n            .PatternColorIndex = xlAutomatic\n            .Color = 10498160\n            .TintAndShade = 0\n            .PatternTintAndShade = 0\n            End With\n        Else\n        End If\n        If coursetype = \"National Courses Inside Rio de Janeiro\" Then\n            Cells(nome_linha, enddate_coluna).Select\n            With Selection.Interior\n            .Pattern = xlSolid\n            .PatternColorIndex = xlAutomatic\n            .Color = 49407\n            .TintAndShade = 0\n            .PatternTintAndShade = 0\n            End With\n        Else\n        End If\n        If coursetype = \"National Courses Outside Rio de Janeiro\" Then\n            Cells(nome_linha, enddate_coluna).Select\n            With Selection.Interior\n            .Pattern = xlSolid\n            .PatternColorIndex = xlAutomatic\n            .Color = 12611584\n            .TintAndShade = 0\n            .PatternTintAndShade = 0\n            End With\n        Else\n        End If\n\n        If coursetype = \"Other Courses\" Then\n            Cells(nome_linha, enddate_coluna).Select\n            With Selection.Interior\n            .Pattern = xlSolid\n            .PatternColorIndex = xlAutomatic\n            .Color = 192\n            .TintAndShade = 0\n            .PatternTintAndShade = 0\n            End With\n        Else\n        'Nothing should happen\n        End If\n\n        enddate_coluna = enddate_coluna - 1\n        Loop\n    End If\n\n\n    j = j + 1\n  Loop\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1522255473, "post_id": 49539908, "comment_id": 86087188, "body": "On which line ?"}, {"owner": {"reputation": 365, "user_id": 9393184, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eVIhBhcNQ8Q/AAAAAAAAAAI/AAAAAAAAmmg/KIgV06D6Mtg/photo.jpg?sz=128", "display_name": "Rahilkhan Pathan", "link": "https://stackoverflow.com/users/9393184/rahilkhan-pathan"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1522255529, "post_id": 49539908, "comment_id": 86087224, "body": "Line 22 or .Add(Connection:=&quot;TEXT;&quot; &amp; folder, Destination:=Range(&quot;dest&quot;))"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1522255539, "post_id": 49539908, "comment_id": 86087231, "body": "You just need <code>Range(dest)</code> as <code>dest</code> is a string variable not a named range."}, {"owner": {"reputation": 365, "user_id": 9393184, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eVIhBhcNQ8Q/AAAAAAAAAAI/AAAAAAAAmmg/KIgV06D6Mtg/photo.jpg?sz=128", "display_name": "Rahilkhan Pathan", "link": "https://stackoverflow.com/users/9393184/rahilkhan-pathan"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1522255609, "post_id": 49539908, "comment_id": 86087275, "body": "New err: 438 Object doesn&#39;t support this property or method.  Range is always in (&quot;   &quot;)"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1522255624, "post_id": 49539908, "comment_id": 86087288, "body": "Quotes around a variable is a no-go; you also need to save the lastRow long as part of the string to include a quotation around it as part of dest.  You also could have done: .Add(Connection:=&quot;TEXT;&quot; &amp; folder, Destination:=Range(&quot;$A$&quot; &amp; lastRow))"}, {"owner": {"reputation": 365, "user_id": 9393184, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eVIhBhcNQ8Q/AAAAAAAAAAI/AAAAAAAAmmg/KIgV06D6Mtg/photo.jpg?sz=128", "display_name": "Rahilkhan Pathan", "link": "https://stackoverflow.com/users/9393184/rahilkhan-pathan"}, "edited": false, "score": 0, "creation_date": 1522255653, "post_id": 49539908, "comment_id": 86087304, "body": "when I write only dest, it says type mismatch."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1522255785, "post_id": 49539908, "comment_id": 86087369, "body": "@RahilkhanPathan was editing my comment as you sent yours.  See the comment about dest, but you should probably use the other suggestion, do not use dest at all and carry in your lastRow"}, {"owner": {"reputation": 365, "user_id": 9393184, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eVIhBhcNQ8Q/AAAAAAAAAAI/AAAAAAAAmmg/KIgV06D6Mtg/photo.jpg?sz=128", "display_name": "Rahilkhan Pathan", "link": "https://stackoverflow.com/users/9393184/rahilkhan-pathan"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1522255785, "post_id": 49539908, "comment_id": 86087370, "body": "@Cyril  Holy moly it works, I am sure I have already tried that. But WORKS now. THANK YOU!!!!"}], "answers": [{"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1522256109, "post_id": 49540152, "comment_id": 86087559, "body": "I&#39;m curious as to why this worked but the variable approach didn&#39;t. Doesn&#39;t make sense to me?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1522256395, "post_id": 49540152, "comment_id": 86087743, "body": "@SJR I tried to explain that in the comments... I&#39;ve had this happen to me once before.  Dim dest as String, dest = &quot;&quot; &amp; &quot;$A$&quot; &amp;  lastRow &amp; &quot;&quot;, that way it fits the Range(&quot;&quot;) model.  It&#39;s still better to Dim dest as Range, Set dest = ..."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1522256582, "post_id": 49540152, "comment_id": 86087845, "body": "Thanks Cyril, yes agreed."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": true, "score": 2, "last_activity_date": 1522255854, "creation_date": 1522255854, "answer_id": 49540152, "question_id": 49539908, "link": "https://stackoverflow.com/questions/49539908/importing-data-from-csv-to-xlsm/49540152#49540152", "title": "Importing Data from CSV to XLSM", "body": "<p>Answer was solved in the comments</p>\n\n<pre><code>.Add(Connection:=\"TEXT;\" &amp; folder, Destination:=Range(\"$A$\" &amp; lastRow))\n</code></pre>\n"}], "owner": {"reputation": 365, "user_id": 9393184, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eVIhBhcNQ8Q/AAAAAAAAAAI/AAAAAAAAmmg/KIgV06D6Mtg/photo.jpg?sz=128", "display_name": "Rahilkhan Pathan", "link": "https://stackoverflow.com/users/9393184/rahilkhan-pathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 414, "favorite_count": 1, "accepted_answer_id": 49540152, "answer_count": 1, "score": 0, "last_activity_date": 1522255854, "creation_date": 1522255066, "last_edit_date": 1522255635, "question_id": 49539908, "link": "https://stackoverflow.com/questions/49539908/importing-data-from-csv-to-xlsm", "title": "Importing Data from CSV to XLSM", "body": "<p>Following is the macro code for my application to get the data from a CSV file to an Excel file. It is located in the same location. But I am unable to import the data.</p>\n\n<p>It is giving an error: </p>\n\n<blockquote>\n  <p>Runtime Error 1004 Method 'Range of object' _Global' failed.</p>\n</blockquote>\n\n<p>Excel VBA based application code:</p>\n\n<pre><code>Sub LoadFromFile()\nDim fileName As String\nDim folder As String\nDim lastRow As Long\nDim dest As String\n\n\nIf IsEmpty(Range(\"A1\").Value) = True Then\n    lastRow = 1\nElse: If IsEmpty(Range(\"A1\").Value) = False Then GoTo Line1x\nLine1x:\nWith ActiveSheet\n        lastRow = ActiveSheet.Cells.Find(\"*\", SearchOrder:=xlByRows, LookIn:=xlValues, SearchDirection:=xlPrevious).Row\n    End With\n        End If\nActiveSheet.UsedRange.Clear\n\ndest = \"$A$\" &amp; lastRow\nfolder = \"C:\\xampp\\htdocs\\sites\\repairrequest\\database.csv\"\n\nWith ActiveSheet.QueryTables _\n    .Add(Connection:=\"TEXT;\" &amp; folder, Destination:=Range(\"dest\"))\n    .FieldNames = True\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .TextFilePromptOnRefresh = False\n    .TextFilePlatform = 850\n    .TextFileStartRow = 1\n    .TextFileParseType = xlDelimited\n    .TextFileTextQualifier = xlTextQualifierDoubleQuote\n    .TextFileConsecutiveDelimiter = False\n    .TextFileTabDelimiter = False\n    .TextFileSemicolonDelimiter = False\n    .TextFileCommaDelimiter = True\n    .TextFileSpaceDelimiter = False\n    .TextFileColumnDataTypes = Array(1, 1, 1, 1)\n    .TextFileTrailingMinusNumbers = True\n    .Refresh BackgroundQuery:=False\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "userform", "vba"], "answers": [{"tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": true, "score": 0, "last_activity_date": 1522256841, "creation_date": 1522256841, "answer_id": 49540404, "question_id": 49539877, "link": "https://stackoverflow.com/questions/49539877/userform-crashes-excel-on-attempted-load-listed-as-access-error-i-believe-its/49540404#49540404", "title": "Userform crashes excel on attempted load; listed as access error, I believe it&#39;s tied to linking labels to cells", "body": "<p>In case anyone else has a similar issue in the future, here's the answer I found that works... </p>\n\n<p>Move all of the label caption code to a sub in the UserForm code (Right click userform name -> View code) under Private Sub UserForm_Initialize(), so the labels occur with the loading.</p>\n\n<p>Then the Selection_Change code does the checks for the appropriate range and just loads the userForm.</p>\n\n<hr>\n\n<p>SelectionChange: </p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Cells(918, 6).Value = \"No\" Then Exit Sub\n    If Target.Count &gt; 1 Then Exit Sub\n    Dim r As Long, t As Long\n    r = ActiveCell.Row\n    t = 0\n    Select Case r\n        Case 25 To 44 '1\n            t = 24\n        Case 115 To 134 '2\n            t = 114\n        Case 205 To 224 '3\n            t = 204\n        Case 295 To 314 '4\n            t = 294\n        Case 385 To 404 '5\n            t = 384\n        Case 475 To 494 '6\n            t = 474\n        Case 565 To 584 '7\n            t = 564\n        Case 655 To 674 '8\n            t = 654\n        Case 745 To 764 '9\n            t = 744\n        Case 835 To 854 '10\n            t = 834\n    End Select\n    If t = 0 Then Exit Sub\n    If Intersect(Target, Range(Cells(t + 1, 3), Cells(t + 20, 3))) Is Nothing Then Exit Sub\n    Stb.Show\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Initialize: </p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    Dim r As Long, c As Long, i As Long, t As Long\n    r = ActiveCell.Row\n    c = ActiveCell.Column\n    Select Case r\n        Case 25 To 44 '1\n            i = 52\n            t = 24\n        Case 115 To 134 '2\n            i = 142\n            t = 114\n        Case 205 To 224 '3\n            i = 232\n            t = 204\n        Case 295 To 314 '4\n            i = 322\n            t = 294\n        Case 385 To 404 '5\n            i = 412\n            t = 384\n        Case 475 To 494 '6\n            i = 502\n            t = 474\n        Case 565 To 584 '7\n            i = 592\n            t = 564\n        Case 655 To 674 '8\n            i = 682\n            t = 654\n        Case 745 To 764 '9\n            i = 772\n            t = 744\n        Case 835 To 854 '10\n            i = 862\n            t = 834\n    End Select\n    With Sheets(\"Stability\")\n        Stb.Cond1.Caption = .Cells(r, c + 1)\n        Stb.Cond2.Caption = .Cells(r, c + 1)\n        Stb.TP01.Caption = .Cells(t, c + 3)\n        Stb.TP02.Caption = .Cells(t, c + 4)\n        Stb.TP03.Caption = .Cells(t, c + 5)\n        Stb.TP04.Caption = .Cells(t, c + 6)\n        Stb.TP05.Caption = .Cells(t, c + 7)\n        Stb.TP06.Caption = .Cells(t, c + 8)\n        Stb.TP07.Caption = .Cells(t, c + 9)\n        Stb.TP08.Caption = .Cells(t, c + 10)\n        Stb.TP09.Caption = .Cells(t, c + 11)\n        Stb.TP10.Caption = .Cells(t, c + 12)\n        Stb.TP11.Caption = .Cells(t, c + 13)\n        Stb.TP12.Caption = .Cells(t, c + 14)\n        Stb.TP13.Caption = .Cells(t, c + 15)\n        Stb.TP14.Caption = .Cells(t, c + 16)\n        Stb.TP15.Caption = .Cells(t, c + 17)\n        Stb.TP16.Caption = .Cells(t, c + 18)\n        Stb.TP17.Caption = .Cells(t, c + 19)\n        Stb.TP18.Caption = .Cells(t, c + 20)\n        Stb.TP19.Caption = .Cells(t, c + 21)\n        Stb.TP20.Caption = .Cells(t, c + 22)\n        Stb.TP21.Caption = .Cells(t, c + 23)\n        Stb.TP22.Caption = .Cells(t, c + 24)\n        Stb.TP23.Caption = .Cells(t, c + 25)\n        Stb.TP24.Caption = .Cells(t, c + 26)\n        Stb.TP25.Caption = .Cells(t, c + 27)\n        Stb.TP26.Caption = .Cells(t, c + 28)\n        Stb.TP27.Caption = .Cells(t, c + 29)\n        Stb.TP28.Caption = .Cells(t, c + 30)\n        Stb.TP29.Caption = .Cells(t, c + 31)\n        Stb.TP01x.Caption = .Cells(t, c + 3)\n        Stb.TP02x.Caption = .Cells(t, c + 4)\n        Stb.TP03x.Caption = .Cells(t, c + 5)\n        Stb.TP04x.Caption = .Cells(t, c + 6)\n        Stb.TP05x.Caption = .Cells(t, c + 7)\n        Stb.TP06x.Caption = .Cells(t, c + 8)\n        Stb.TP07x.Caption = .Cells(t, c + 9)\n        Stb.TP08x.Caption = .Cells(t, c + 10)\n        Stb.TP09x.Caption = .Cells(t, c + 11)\n        Stb.TP10x.Caption = .Cells(t, c + 12)\n        Stb.TP11x.Caption = .Cells(t, c + 13)\n        Stb.TP12x.Caption = .Cells(t, c + 14)\n        Stb.TP13x.Caption = .Cells(t, c + 15)\n        Stb.TP14x.Caption = .Cells(t, c + 16)\n        Stb.TP15x.Caption = .Cells(t, c + 17)\n        Stb.TP16x.Caption = .Cells(t, c + 18)\n        Stb.TP17x.Caption = .Cells(t, c + 19)\n        Stb.TP18x.Caption = .Cells(t, c + 20)\n        Stb.TP19x.Caption = .Cells(t, c + 21)\n        Stb.TP20x.Caption = .Cells(t, c + 22)\n        Stb.TP21x.Caption = .Cells(t, c + 23)\n        Stb.TP22x.Caption = .Cells(t, c + 24)\n        Stb.TP23x.Caption = .Cells(t, c + 25)\n        Stb.TP24x.Caption = .Cells(t, c + 26)\n        Stb.TP25x.Caption = .Cells(t, c + 27)\n        Stb.TP26x.Caption = .Cells(t, c + 28)\n        Stb.TP27x.Caption = .Cells(t, c + 29)\n        Stb.TP28x.Caption = .Cells(t, c + 30)\n        Stb.TP29x.Caption = .Cells(t, c + 31)\n        Stb.tA.Caption = .Cells(i, c + 1)\n        Stb.tB.Caption = .Cells(i + 1, c + 1)\n        Stb.tC.Caption = .Cells(i + 2, c + 1)\n        Stb.tD.Caption = .Cells(i + 3, c + 1)\n        Stb.tE.Caption = .Cells(i + 4, c + 1)\n        Stb.tF.Caption = .Cells(i + 5, c + 1)\n        Stb.tG.Caption = .Cells(i + 6, c + 1)\n        Stb.tH.Caption = .Cells(i + 7, c + 1)\n        Stb.tI.Caption = .Cells(i + 8, c + 1)\n        Stb.tJ.Caption = .Cells(i + 9, c + 1)\n        Stb.tK.Caption = .Cells(i + 10, c + 1)\n        Stb.tL.Caption = .Cells(i + 11, c + 1)\n        Stb.tM.Caption = .Cells(i + 12, c + 1)\n        Stb.tN.Caption = .Cells(i + 13, c + 1)\n        Stb.teO.Caption = .Cells(i + 14, c + 1)\n        Stb.tP.Caption = .Cells(i + 15, c + 1)\n        Stb.tQ.Caption = .Cells(i + 16, c + 1)\n        Stb.tR.Caption = .Cells(i + 17, c + 1)\n        Stb.tS.Caption = .Cells(i + 18, c + 1)\n        Stb.tT.Caption = .Cells(i + 19, c + 1)\n        Stb.tU.Caption = .Cells(i + 20, c + 1)\n        Stb.tV.Caption = .Cells(i + 21, c + 1)\n        Stb.tW.Caption = .Cells(i + 22, c + 1)\n        Stb.tX.Caption = .Cells(i + 23, c + 1)\n        Stb.tY.Caption = .Cells(i + 24, c + 1)\n        Stb.tZ.Caption = .Cells(i + 25, c + 1)\n        'skip row 78\n        Stb.oA.Caption = .Cells(i + 27, c + 1)\n        Stb.oB.Caption = .Cells(i + 28, c + 1)\n        Stb.oC.Caption = .Cells(i + 29, c + 1)\n        Stb.oD.Caption = .Cells(i + 30, c + 1)\n        Stb.oE.Caption = .Cells(i + 31, c + 1)\n        Stb.oF.Caption = .Cells(i + 32, c + 1)\n        Stb.oG.Caption = .Cells(i + 33, c + 1)\n        Stb.oH.Caption = .Cells(i + 34, c + 1)\n        Stb.oI.Caption = .Cells(i + 35, c + 1)\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 49540404, "answer_count": 1, "score": 0, "last_activity_date": 1522256841, "creation_date": 1522254963, "last_edit_date": 1531164843, "question_id": 49539877, "link": "https://stackoverflow.com/questions/49539877/userform-crashes-excel-on-attempted-load-listed-as-access-error-i-believe-its", "title": "Userform crashes excel on attempted load; listed as access error, I believe it&#39;s tied to linking labels to cells", "body": "<p>Will provide the problem signature at the bottom, as this is related, but isn't particularly the question.</p>\n\n<hr>\n\n<p><strong>Background:</strong></p>\n\n<p>I created a userform tied to a selection_change, which loads <em>provided</em> the VBA form builder for the form has been viewed.  All of the labels in the userform are tied to cells on a specific page of the workbook the userform is housed.</p>\n\n<hr>\n\n<p><strong>Issue:</strong></p>\n\n<p>That provisional in the background is important... if you just try to load the userform on the sheet, Excel crashes. </p>\n\n<p>I believe the issue is that I caption the labels of the userform (Stb) before the userform has ever been loaded.  In using Stb.Show before the labeling, I get the basic form (I am unsure if the form can just be refreshed, which might be easier); if I try Unload Stb after Stb.Show, then I still have to action Stb before anything happens (force closing without having to look at it would be a workaround).</p>\n\n<hr>\n\n<p><strong>Question:</strong></p>\n\n<p>Is there a way to get the userform to either refresh all of the label captions once it has loaded?</p>\n\n<p>Or, is there a way to force Unload the userform, after .Show, so I have an object to apply the captions?</p>\n\n<p>Third thing, is there another approach which might be more preferable (<em>this is subjective; not intending to have a million options, but still want to ask</em>)?</p>\n\n<hr>\n\n<p><strong>Code in question:</strong></p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Cells(918, 6).Value = \"No\" Then Exit Sub\n    If Target.Count &gt; 1 Then Exit Sub\n    Dim r As Long, c As Long, i As Long, t As Long\n    r = ActiveCell.Row\n    c = ActiveCell.Column\n    i = 0\n    Select Case r\n        Case 25 To 44 '1\n            i = 52\n            t = 24\n        Case 115 To 134 '2\n            i = 142\n            t = 114\n        Case 205 To 224 '3\n            i = 232\n            t = 204\n        Case 295 To 314 '4\n            i = 322\n            t = 294\n        Case 385 To 404 '5\n            i = 412\n            t = 384\n        Case 475 To 494 '6\n            i = 502\n            t = 474\n        Case 565 To 584 '7\n            i = 592\n            t = 564\n        Case 655 To 674 '8\n            i = 682\n            t = 654\n        Case 745 To 764 '9\n            i = 772\n            t = 744\n        Case 835 To 854 '10\n            i = 862\n            t = 834\n    End Select\n    If i = 0 Then Exit Sub\n    If Intersect(Target, Range(Cells(t + 1, 3), Cells(t + 20, 3))) Is Nothing Then Exit Sub\n    With Sheets(\"Stability\")\n        Stb.Cond1.Caption = .Cells(r, c + 1)\n        Stb.Cond2.Caption = .Cells(r, c + 1)\n        Stb.TP01.Caption = .Cells(t, c + 3)\n        Stb.TP02.Caption = .Cells(t, c + 4)\n        Stb.TP03.Caption = .Cells(t, c + 5)\n        Stb.TP04.Caption = .Cells(t, c + 6)\n        Stb.TP05.Caption = .Cells(t, c + 7)\n        Stb.TP06.Caption = .Cells(t, c + 8)\n        Stb.TP07.Caption = .Cells(t, c + 9)\n        Stb.TP08.Caption = .Cells(t, c + 10)\n        Stb.TP09.Caption = .Cells(t, c + 11)\n        Stb.TP10.Caption = .Cells(t, c + 12)\n        Stb.TP11.Caption = .Cells(t, c + 13)\n        Stb.TP12.Caption = .Cells(t, c + 14)\n        Stb.TP13.Caption = .Cells(t, c + 15)\n        Stb.TP14.Caption = .Cells(t, c + 16)\n        Stb.TP15.Caption = .Cells(t, c + 17)\n        Stb.TP16.Caption = .Cells(t, c + 18)\n        Stb.TP17.Caption = .Cells(t, c + 19)\n        Stb.TP18.Caption = .Cells(t, c + 20)\n        Stb.TP19.Caption = .Cells(t, c + 21)\n        Stb.TP20.Caption = .Cells(t, c + 22)\n        Stb.TP21.Caption = .Cells(t, c + 23)\n        Stb.TP22.Caption = .Cells(t, c + 24)\n        Stb.TP23.Caption = .Cells(t, c + 25)\n        Stb.TP24.Caption = .Cells(t, c + 26)\n        Stb.TP25.Caption = .Cells(t, c + 27)\n        Stb.TP26.Caption = .Cells(t, c + 28)\n        Stb.TP27.Caption = .Cells(t, c + 29)\n        Stb.TP28.Caption = .Cells(t, c + 30)\n        Stb.TP29.Caption = .Cells(t, c + 31)\n        Stb.TP01x.Caption = .Cells(t, c + 3)\n        Stb.TP02x.Caption = .Cells(t, c + 4)\n        Stb.TP03x.Caption = .Cells(t, c + 5)\n        Stb.TP04x.Caption = .Cells(t, c + 6)\n        Stb.TP05x.Caption = .Cells(t, c + 7)\n        Stb.TP06x.Caption = .Cells(t, c + 8)\n        Stb.TP07x.Caption = .Cells(t, c + 9)\n        Stb.TP08x.Caption = .Cells(t, c + 10)\n        Stb.TP09x.Caption = .Cells(t, c + 11)\n        Stb.TP10x.Caption = .Cells(t, c + 12)\n        Stb.TP11x.Caption = .Cells(t, c + 13)\n        Stb.TP12x.Caption = .Cells(t, c + 14)\n        Stb.TP13x.Caption = .Cells(t, c + 15)\n        Stb.TP14x.Caption = .Cells(t, c + 16)\n        Stb.TP15x.Caption = .Cells(t, c + 17)\n        Stb.TP16x.Caption = .Cells(t, c + 18)\n        Stb.TP17x.Caption = .Cells(t, c + 19)\n        Stb.TP18x.Caption = .Cells(t, c + 20)\n        Stb.TP19x.Caption = .Cells(t, c + 21)\n        Stb.TP20x.Caption = .Cells(t, c + 22)\n        Stb.TP21x.Caption = .Cells(t, c + 23)\n        Stb.TP22x.Caption = .Cells(t, c + 24)\n        Stb.TP23x.Caption = .Cells(t, c + 25)\n        Stb.TP24x.Caption = .Cells(t, c + 26)\n        Stb.TP25x.Caption = .Cells(t, c + 27)\n        Stb.TP26x.Caption = .Cells(t, c + 28)\n        Stb.TP27x.Caption = .Cells(t, c + 29)\n        Stb.TP28x.Caption = .Cells(t, c + 30)\n        Stb.TP29x.Caption = .Cells(t, c + 31)\n        Stb.tA.Caption = .Cells(i, c + 1)\n        Stb.tB.Caption = .Cells(i + 1, c + 1)\n        Stb.tC.Caption = .Cells(i + 2, c + 1)\n        Stb.tD.Caption = .Cells(i + 3, c + 1)\n        Stb.tE.Caption = .Cells(i + 4, c + 1)\n        Stb.tF.Caption = .Cells(i + 5, c + 1)\n        Stb.tG.Caption = .Cells(i + 6, c + 1)\n        Stb.tH.Caption = .Cells(i + 7, c + 1)\n        Stb.tI.Caption = .Cells(i + 8, c + 1)\n        Stb.tJ.Caption = .Cells(i + 9, c + 1)\n        Stb.tK.Caption = .Cells(i + 10, c + 1)\n        Stb.tL.Caption = .Cells(i + 11, c + 1)\n        Stb.tM.Caption = .Cells(i + 12, c + 1)\n        Stb.tN.Caption = .Cells(i + 13, c + 1)\n        Stb.teO.Caption = .Cells(i + 14, c + 1)\n        Stb.tP.Caption = .Cells(i + 15, c + 1)\n        Stb.tQ.Caption = .Cells(i + 16, c + 1)\n        Stb.tR.Caption = .Cells(i + 17, c + 1)\n        Stb.tS.Caption = .Cells(i + 18, c + 1)\n        Stb.tT.Caption = .Cells(i + 19, c + 1)\n        Stb.tU.Caption = .Cells(i + 20, c + 1)\n        Stb.tV.Caption = .Cells(i + 21, c + 1)\n        Stb.tW.Caption = .Cells(i + 22, c + 1)\n        Stb.tX.Caption = .Cells(i + 23, c + 1)\n        Stb.tY.Caption = .Cells(i + 24, c + 1)\n        Stb.tZ.Caption = .Cells(i + 25, c + 1)\n        'skip row 78\n        Stb.oA.Caption = .Cells(i + 27, c + 1)\n        Stb.oB.Caption = .Cells(i + 28, c + 1)\n        Stb.oC.Caption = .Cells(i + 29, c + 1)\n        Stb.oD.Caption = .Cells(i + 30, c + 1)\n        Stb.oE.Caption = .Cells(i + 31, c + 1)\n        Stb.oF.Caption = .Cells(i + 32, c + 1)\n        Stb.oG.Caption = .Cells(i + 33, c + 1)\n        Stb.oH.Caption = .Cells(i + 34, c + 1)\n        Stb.oI.Caption = .Cells(i + 35, c + 1)\n        Stb.Show\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Problem signature:</strong></p>\n\n<pre><code>  Problem Event Name:   APPCRASH\n  Application Name: EXCEL.EXE\n  Application Version:  16.0.8431.2236\n  Application Timestamp:    5a9aa882\n  Fault Module Name:    unknown\n  Fault Module Version: 0.0.0.0\n  Fault Module Timestamp:   00000000\n  Exception Code:   c0000005\n  Exception Offset: 00000000\n  OS Version:   6.1.7601.2.1.0.256.4\n  Locale ID:    1033\n</code></pre>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522513512, "post_id": 49539873, "comment_id": 86187595, "body": "Yes. Use <a href=\"https://stackoverflow.com/questions/7844171/screen-dimensions-in-visual-basic\">Windows API</a> to get the screen resolution of the screen in question and have code that sizes accordingly."}], "answers": [{"tags": [], "owner": {"reputation": 86, "user_id": 7031901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d41c012fe17cfc8d865fc090083c547?s=128&d=identicon&r=PG&f=1", "display_name": "Jerry", "link": "https://stackoverflow.com/users/7031901/jerry"}, "is_accepted": false, "score": 0, "last_activity_date": 1522260257, "creation_date": 1522260257, "answer_id": 49541313, "question_id": 49539873, "link": "https://stackoverflow.com/questions/49539873/auto-adjust-excel-userform-for-different-computer-screens/49541313#49541313", "title": "auto adjust excel userform for different computer screens", "body": "<p>Untested but reliable websites:</p>\n\n<p><a href=\"https://www.ozgrid.com/forum/forum/help-forums/excel-general/142634-vba-to-automatically-resize-user-form-depending-on-screen-resolution\" rel=\"nofollow noreferrer\">OzGrid</a> </p>\n\n<p><a href=\"http://visualbasic.happycodings.com/forms/code48.html\" rel=\"nofollow noreferrer\">Happy Codings</a></p>\n"}, {"comments": [{"owner": {"reputation": 1443, "user_id": 2836233, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/axEu6.jpg?s=128&g=1", "display_name": "Victor Anuebunwa", "link": "https://stackoverflow.com/users/2836233/victor-anuebunwa"}, "edited": false, "score": 1, "creation_date": 1541369240, "post_id": 53145626, "comment_id": 93183191, "body": "Welcome to Stack Overflow! It&#39;s always better to add a few lines to explain your answer."}, {"owner": {"reputation": 3020, "user_id": 2813804, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/061Zc.jpg?s=128&g=1", "display_name": "Akshay Paliwal", "link": "https://stackoverflow.com/users/2813804/akshay-paliwal"}, "edited": false, "score": 1, "creation_date": 1541400710, "post_id": 53145626, "comment_id": 93189563, "body": "Welcome to Stack Overflow! It&#39;s always better to add a few lines to explain your answer."}, {"owner": {"reputation": 13, "user_id": 7920138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/497f3069874aa181936de1899d749950?s=128&d=identicon&r=PG&f=1", "display_name": "Muni0408", "link": "https://stackoverflow.com/users/7920138/muni0408"}, "edited": false, "score": 0, "creation_date": 1565020814, "post_id": 53145626, "comment_id": 101210957, "body": "Thank you very much everyone :) it has been a while writing VBA codes."}], "tags": [], "owner": {"reputation": 1, "user_id": 10605069, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/8f94ca48b5df7bf5d1a82997ac44c1c0?s=128&d=identicon&r=PG", "display_name": "Jesus Hector", "link": "https://stackoverflow.com/users/10605069/jesus-hector"}, "is_accepted": false, "score": 0, "last_activity_date": 1541400315, "last_edit_date": 1541400315, "creation_date": 1541366721, "answer_id": 53145626, "question_id": 49539873, "link": "https://stackoverflow.com/questions/49539873/auto-adjust-excel-userform-for-different-computer-screens/53145626#53145626", "title": "auto adjust excel userform for different computer screens", "body": "<pre><code>Private Sub UserForm_Initialize()\n\n    With Application\n\n        .WindowState = xlMaximized\n\n        Zoom = Int(.Width / Me.Width * 80)\n\n        Width = .Width\n\n        Height = .Height\n\n    End With\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7920138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/497f3069874aa181936de1899d749950?s=128&d=identicon&r=PG&f=1", "display_name": "Muni0408", "link": "https://stackoverflow.com/users/7920138/muni0408"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1483, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1541400315, "creation_date": 1522254955, "question_id": 49539873, "link": "https://stackoverflow.com/questions/49539873/auto-adjust-excel-userform-for-different-computer-screens", "title": "auto adjust excel userform for different computer screens", "body": "<p>I have an excel userform that opens fine and I can see full of it. But in some of my teammates computer it is not showing full, some of it is not visible. Is there a way I can make my userform show completely on everybody's screen irrespective of the screen and probably screen size? Thank you all in advance. </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1522255173, "creation_date": 1522255173, "answer_id": 49539940, "question_id": 49539857, "link": "https://stackoverflow.com/questions/49539857/left-align-row-2-in-all-sheets/49539940#49539940", "title": "Left Align Row 2 in all Sheets", "body": "<p>You need to refer to the <code>ws</code> variable in your loop (otherwise only the active sheet will have the code applied) and you don't need to Select. Also, for one line the With is overkill I'd say.</p>\n\n<pre><code>Sub leftAlign()\n Dim ws As Worksheet\n For Each ws In Worksheets\n    With ws.Rows(2)\n        .HorizontalAlignment = xlLeft\n    End With\n Next ws\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 303, "user_id": 3070543, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/a8BCI.jpg?s=128&g=1", "display_name": "Seth", "link": "https://stackoverflow.com/users/3070543/seth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 49539940, "answer_count": 1, "score": 0, "last_activity_date": 1522255173, "creation_date": 1522254911, "question_id": 49539857, "link": "https://stackoverflow.com/questions/49539857/left-align-row-2-in-all-sheets", "title": "Left Align Row 2 in all Sheets", "body": "<p>I am trying to align all the second rows in my spreadsheet. The code I wrote is not looping through all the sheets and only applying the left align to the first sheet.</p>\n\n<pre><code>Sub leftAlign()\n Dim ws As Worksheet\n For Each ws In Worksheets\n    Rows(2).Select\n    With Selection\n        .HorizontalAlignment = xlLeft\n    End With\n Next ws\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 1, "creation_date": 1522268967, "post_id": 49539543, "comment_id": 86094856, "body": "At <code>_Open</code>is too early as no controls are availible (use this event for datasource changes or validation access rights). Use the <code>Report_Load</code>event instead."}, {"owner": {"reputation": 118, "user_id": 2002716, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/63eba881cbc82d9e4ba86dc3da5ac0e0?s=128&d=identicon&r=PG", "display_name": "user2002716", "link": "https://stackoverflow.com/users/2002716/user2002716"}, "reply_to_user": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1522294796, "post_id": 49539543, "comment_id": 86102638, "body": "Alright I\u2019ll give that a try in the AM, thanks!"}, {"owner": {"reputation": 118, "user_id": 2002716, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/63eba881cbc82d9e4ba86dc3da5ac0e0?s=128&d=identicon&r=PG", "display_name": "user2002716", "link": "https://stackoverflow.com/users/2002716/user2002716"}, "reply_to_user": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1522333708, "post_id": 49539543, "comment_id": 86125086, "body": "That worked, thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 118, "user_id": 2002716, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/63eba881cbc82d9e4ba86dc3da5ac0e0?s=128&d=identicon&r=PG", "display_name": "user2002716", "link": "https://stackoverflow.com/users/2002716/user2002716"}, "edited": false, "score": 0, "creation_date": 1522294747, "post_id": 49544817, "comment_id": 86102621, "body": "That is column, table, and where. I even check another database I made filled with code where it works, same format."}], "tags": [], "owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "is_accepted": false, "score": 0, "last_activity_date": 1522309987, "last_edit_date": 1522309987, "creation_date": 1522274218, "answer_id": 49544817, "question_id": 49539543, "link": "https://stackoverflow.com/questions/49539543/assign-value-to-report-text-box-on-open/49544817#49544817", "title": "Assign value to report text box on open", "body": "<p>Your dlookup where condition is wrong. It must be\n <code>result= dlookup (retrievingColumnName, TableName, [whereCondition]).</code></p>\n\n<p>Where WhereCondition could be:\nNumberColumn=1\nTextColumn='This is a text'</p>\n\n<p>Search for dlookup and you will see many examples. </p>\n\n<p>I see you have modified your question. As suggested, controls on \"on open\" might not be ready for you take values. You can try to move your code to \"on load\" or try to set focus and then asssign value.</p>\n"}], "owner": {"reputation": 118, "user_id": 2002716, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/63eba881cbc82d9e4ba86dc3da5ac0e0?s=128&d=identicon&r=PG", "display_name": "user2002716", "link": "https://stackoverflow.com/users/2002716/user2002716"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1013, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594636308, "creation_date": 1522253863, "last_edit_date": 1594636308, "question_id": 49539543, "link": "https://stackoverflow.com/questions/49539543/assign-value-to-report-text-box-on-open", "title": "Assign value to report text box on open", "body": "<pre><code>Private sub Report_Open (Cancel As Integer)\nDim var1 As Variant\nVar1=DLookup(\u201c[Menu_Item]\u201d, \u201c[Thaw_Tags]\u201d, \u201c[ID] = 1\u201d)\nMe.Text34.Value= var1\nEnd Sub\n</code></pre>\n\n<p>I\u2019m trying to get a textbox to get information from a table on open, using a Report. Yet when I open the report i get the error \u201cyou can\u2019t assign a value to this object\u201d. What am I doing wrong?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 1, "creation_date": 1522254194, "post_id": 49539459, "comment_id": 86086412, "body": "A quick option is using <code>autofilter</code> and only visible cells to populate your <code>range_Copy</code>. Or do you want the &quot;createSheets&quot; sub to handle the blank rows?"}, {"owner": {"reputation": 990, "user_id": 2014897, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/CAo50.jpg?s=128&g=1", "display_name": "G-J", "link": "https://stackoverflow.com/users/2014897/g-j"}, "reply_to_user": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1522255095, "post_id": 49539459, "comment_id": 86086967, "body": "The code needs to handle it all. The original sheet is a copy and paste from an external source. Trying to get the code to pull out just what we need."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1522255298, "post_id": 49539459, "comment_id": 86087085, "body": "Or maybe use SpecialCells?"}], "answers": [{"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1522254732, "post_id": 49539758, "comment_id": 86086759, "body": "column &quot;E&quot;, not column &quot;A&quot;"}, {"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1522254842, "post_id": 49539758, "comment_id": 86086822, "body": "@ShaiRado The answer was incomplete :) Thanks for the remark."}, {"owner": {"reputation": 990, "user_id": 2014897, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/CAo50.jpg?s=128&g=1", "display_name": "G-J", "link": "https://stackoverflow.com/users/2014897/g-j"}, "edited": false, "score": 0, "creation_date": 1522255287, "post_id": 49539758, "comment_id": 86087075, "body": "I&#39;m definitely not a VBA expert... trying to understand your code... How would I do the actual copy?"}], "tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 1, "last_activity_date": 1522256502, "last_edit_date": 1522256502, "creation_date": 1522254615, "answer_id": 49539758, "question_id": 49539459, "link": "https://stackoverflow.com/questions/49539459/vba-copy-range-if-cell-not-empty/49539758#49539758", "title": "VBA - Copy Range if cell not empty", "body": "<p>I think below code will help you. Useful information here is, that you can reference a cell in a range using relative reference, i.e. <code>Range(\"D4:E6\").Cells(1, 1)</code> is reference to cell <code>D4</code>. This way you can easily loop through given range.</p>\n\n<pre><code>Sub LoppthroughRange()\nDim i As Long, j As Long, rng As Range\nSet rng = Range(\"E:T\")\nFor i = 1 To rng.Rows.Count\n    If Not IsEmpty(rng.Cells(i, 1)) Then\n        For j = 1 To rng.Columns.Count\n            'copy all cells in a row\n        Next\n    End If\nNext\n\nEnd Sub\n</code></pre>\n\n<p>Putting it all together, you should use:</p>\n\n<pre><code>Sub createSheets(range_Copy As Range, range_Paste As Range)\n    Dim i As Long, j As Long, k As Long\n    k = 1\n\n    For i = 1 To range_Copy.Rows.Count\n        If Not IsEmpty(range_Copy.Cells(i, 1)) Then\n            With range_Copy\n                .Range(Cells(i, 1), Cells(i, .Columns.Count)).Copy\n            End With\n            With range_Paste\n                .Range(Cells(k, 1), Cells(k, .Columns.Count)).PasteSpecial xlValues\n                .Range(Cells(k, 1), Cells(k, .Columns.Count)).PasteSpecial xlFormats\n            End With\n            k = k + 1\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 990, "user_id": 2014897, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/CAo50.jpg?s=128&g=1", "display_name": "G-J", "link": "https://stackoverflow.com/users/2014897/g-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5073, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522256502, "creation_date": 1522253623, "last_edit_date": 1531161705, "question_id": 49539459, "link": "https://stackoverflow.com/questions/49539459/vba-copy-range-if-cell-not-empty", "title": "VBA - Copy Range if cell not empty", "body": "<p>I currently have this code:</p>\n\n<pre><code>Sub createSheets(range_Copy As Range, range_Paste As Range)\n    'Copy the data\n    range_Copy.Copy\n\n    'Paste the data into the new worksheet\n    With range_Paste\n        .PasteSpecial xlPasteValues\n        .PasteSpecial xlPasteFormats\n    End With\nEnd Sub\n</code></pre>\n\n<p>...and this...</p>\n\n<pre><code>Call createSheets(Sheets(\"Export from QB - Annual Sales\").Range(\"E:T\"), Sheets(\"Sales - \" &amp; Sales_Date_Annual).Range(\"A1\"))\n</code></pre>\n\n<p>It works great but what I actually want to do is... when copying the range E:T, I only want to copy the rows that do not have a blank value in column E... regardless if there is anything in the other columns.</p>\n"}, {"tags": ["vba", "excel", "automation"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1522253165, "post_id": 49539224, "comment_id": 86085718, "body": "Shouldn&#39;t <code>If FR = 0 Then</code> be <code>If Not FR = 0 Then</code>? What are you doing when <code>FR</code> gets a match?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1522255412, "post_id": 49539224, "comment_id": 86087151, "body": "So, what&#39;s the problem with your code? Are you getting an error? What error specifically? Where? Or is it not doing its job? What are you getting vs what you&#39;re expecting? Your post is incomplete. Please see <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "owner": {"reputation": 81, "user_id": 8635780, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a6a1f2938c54b10f5a34f00f775ebd18?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/8635780/jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1522254053, "creation_date": 1522252892, "last_edit_date": 1522254053, "question_id": 49539224, "link": "https://stackoverflow.com/questions/49539224/comparing-two-cells-from-different-excel-files", "title": "Comparing two cells from different Excel files", "body": "<p>I am creating a automation code in VBA to compare cells data from in two separate excel files. I daily run the report file from our application and compare if records are in my master file manually If not I insert it, so my macro would be compare code number if my master excel doesn't have then records are automatically inserted and make a highlight in daily report.</p>\n\n<p>These two excel files I have..</p>\n\n<p>1) This is daily report excel file.</p>\n\n<pre><code>  Code Number   Code Type   Reason       Date           work start\n   NCO3293     Normal   Upgrade      2018-02-14     2018-02-14 \n   NCO1123     Normal   Fix      2018-02-14     2018-02-14 \n   NCO2032     Normal   Improvement  2018-02-13     2018-02-13 \n   NCO1102     Normal   Upgrade      2018-02-14     2018-02-14 \n   NCO3042     Normal   Fix      2018-02-14     2018-02-14\n</code></pre>\n\n<p>2) This is my master excel file.</p>\n\n<pre><code>  Code Number   Code Type   Reason       Date           work start\n   NCO2934     Normal   Upgrade      2018-02-14     2018-02-14 \n   NCO4032     Normal   Fix      2018-02-14     2018-02-14 \n   NCO3013     Normal   Improvement  2018-02-13     2018-02-13 \n   NCO1102     Normal   Upgrade      2018-02-14     2018-02-14 \n   NCO3042     Normal   Fix      2018-02-14     2018-02-14\n</code></pre>\n\n<p>As you can see cell number 1 to 3 are different. so I would like to put whole cells to master excel..</p>\n\n<pre><code>Sub SNC_Script()\n\nApplication.ScreenUpdating = False\n\nDim wb As Workbook\nDim ThisBook As Workbook  'Mster workbook\nDim SNCBook As Workbook   'SNC workbook\nDim c As Range, LR As Long, FR As Long\nDim CheckedOpen As Integer\nDim w1 As Worksheet, w2 As Worksheet\n\nSet ThisBook = ThisWorkbook\n\n'==================================\n'Find SNC workbook if it is opened\n'==================================\nFor Each wb In Workbooks\n      If Left(wb.Name, 3) = \"SNC\" Then\n        Set SNCBook = wb\n        CheckedOpen = 1\n      End If\nNext\n\nIf CheckedOpen &lt;&gt; 1 Then\n    MsgBox \"Can't find SNC files..please open a SNC file\"\nElse\n    Set w1 = ThisBook.Worksheets(\"Sheet1\")\n    Set w2 = SNCBook.Worksheets(\"Sheet1\")\n    LR = w1.Cells(Rows.Count, 1).End(xlUp).Row\n    With w1.Range(\"C1:C\" &amp; LR)\n        .FormulaR1C1 = \"RC[-2]&amp;RC[-1]\"\n        .Value = .Value\n    End With\n    LR = w2.Cells(Rows.Count, 1).End(xlUp).Row\n    With w2.Range(\"C1:C\" &amp; LR)\n        .FormulaR1C1 = \"RC[-2]&amp;RC[-1]\"\n        .Value = .Value\n    End With\n    For Each c In w2.Range(\"C1\", w2.Range(\"C\" &amp; Rows.Count).End(xlUp))\n    FR = 0\n    On Error Resume Next\n    FR = Application.Match(c, w1.Columns(3), 0)\n    On Error GoTo 0\n    If FR = 0 Then\n      c.Offset(, -2).Resize(, 2).Font.Bold = True\n    End If\nNext c\nw1.Columns(3).ClearContents\nw2.Columns(3).ClearContents\n\nEnd If\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Can anyone let me know what's my problem in code?\nI really appreciate it.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1522254378, "post_id": 49539150, "comment_id": 86086524, "body": "In Excel how can you tell if a number is a Double?  The <code>cell</code> function will return info about the cell such as the format, but <code>0.00</code> returns F2 and <code>#,##0.00</code> returns <code>,2</code>  Does it matter if it&#39;s a double?  Would an integer do as well?"}, {"owner": {"reputation": 13, "user_id": 9565097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d79639ad965ea5d3c378c0499db4a3a4?s=128&d=identicon&r=PG&f=1", "display_name": "ep2020", "link": "https://stackoverflow.com/users/9565097/ep2020"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1522257456, "post_id": 49539150, "comment_id": 86088351, "body": "The values need multiple places after the decimal so an integer type variable won&#39;t work."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9565097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d79639ad965ea5d3c378c0499db4a3a4?s=128&d=identicon&r=PG&f=1", "display_name": "ep2020", "link": "https://stackoverflow.com/users/9565097/ep2020"}, "edited": false, "score": 0, "creation_date": 1522257411, "post_id": 49539802, "comment_id": 86088320, "body": "This isn&#39;t quite what I need. I edited my original response so hopefully that clears up any confusion. Thank you though!"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 13, "user_id": 9565097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d79639ad965ea5d3c378c0499db4a3a4?s=128&d=identicon&r=PG&f=1", "display_name": "ep2020", "link": "https://stackoverflow.com/users/9565097/ep2020"}, "edited": false, "score": 0, "creation_date": 1522260399, "post_id": 49539802, "comment_id": 86090017, "body": "@ep2020 I see.. So how far do the columns extend? Are you trying to utilize <code>LastCol</code> here?"}, {"owner": {"reputation": 13, "user_id": 9565097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d79639ad965ea5d3c378c0499db4a3a4?s=128&d=identicon&r=PG&f=1", "display_name": "ep2020", "link": "https://stackoverflow.com/users/9565097/ep2020"}, "edited": false, "score": 0, "creation_date": 1522261066, "post_id": 49539802, "comment_id": 86090409, "body": "It&#39;s from Row 3-27 and Column AB-AN. I&#39;m not sure what LastCol does."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 13, "user_id": 9565097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d79639ad965ea5d3c378c0499db4a3a4?s=128&d=identicon&r=PG&f=1", "display_name": "ep2020", "link": "https://stackoverflow.com/users/9565097/ep2020"}, "edited": false, "score": 0, "creation_date": 1522261901, "post_id": 49539802, "comment_id": 86090893, "body": "@ep2020 I&#39;ve fixed the code. This is creating an array for each row, but it&#39;s being overwritten each time it goes to the next row - I&#39;m assuming you&#39;re going to be doing something with that array each time within the loop?"}, {"owner": {"reputation": 13, "user_id": 9565097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d79639ad965ea5d3c378c0499db4a3a4?s=128&d=identicon&r=PG&f=1", "display_name": "ep2020", "link": "https://stackoverflow.com/users/9565097/ep2020"}, "edited": false, "score": 0, "creation_date": 1522283680, "post_id": 49539802, "comment_id": 86099942, "body": "Thank you very much this is exactly what I needed!"}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 1, "last_activity_date": 1522261843, "last_edit_date": 1522261843, "creation_date": 1522254771, "answer_id": 49539802, "question_id": 49539150, "link": "https://stackoverflow.com/questions/49539150/find-first-four-cells-in-a-row/49539802#49539802", "title": "Find first four cells in a row", "body": "<p>I changed things up a bit, I think this should suffice:</p>\n\n<pre><code>Sub Test()\n\nDim TIGA As Variant, i As Long, j As Long, k As Long\n\nReDim TIGA(0 To 3)\n\nFor i = 3 To 27\n    k = 0\n    For j = 28 To 40\n        If Cells(i, j) &lt;&gt; \"\" Then\n            If IsNumeric(Cells(i, j)) = True And InStr(Cells(i, j), \".\") &gt; 0 Then 'make sure it's a double\n\n                TIGA(k) = Cells(i, j)\n                k = k + 1\n\n                If k = 3 Then\n                    Exit For\n                End If\n\n            End If\n        End If\n    Next j\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9565097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d79639ad965ea5d3c378c0499db4a3a4?s=128&d=identicon&r=PG&f=1", "display_name": "ep2020", "link": "https://stackoverflow.com/users/9565097/ep2020"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522261843, "creation_date": 1522252670, "last_edit_date": 1522257368, "question_id": 49539150, "link": "https://stackoverflow.com/questions/49539150/find-first-four-cells-in-a-row", "title": "Find first four cells in a row", "body": "<p>I am trying to find the first four cells along a row that contain values and the type is Double. I want to add the values of the cells to an array and also locate the cells locations for future use. I need to work down 23 rows after as well. Some of the rows don't contain any values. The matrix starts with cell AB3 </p>\n\n<p>I've been trying to start with a For loop so I can work down the rows and then having a For loop inside that to create a new array every time I move to a new row. \nThe code I need looks something like this.</p>\n\n<pre><code>For i = 3 to 27\n    For j = 0 to 3\n        TIGA(j) = Range(Cells(i, j + 28), Cells(last cell)).Find(first               \n        value and then the next three)\n</code></pre>\n\n<p>Again I need to work across from left to right in each row. First I need to add the first four values in a row to an array. Next I need to save the column number for each of the values because I need to know what column they're in later on in my code. After I get the information for one your I need to loop it down for the rest. The array with the values and any variable/array used for the cells location can be restarted every time the code loops through for the new row. Thank you!\n<a href=\"https://i.stack.imgur.com/lFJni.png\" rel=\"nofollow noreferrer\">Here's what's the data looks like.</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1522252793, "post_id": 49539126, "comment_id": 86085429, "body": "Replace <b>Empty</b> with <b>&quot;&quot;</b> and try again."}, {"owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "edited": false, "score": 2, "creation_date": 1522253051, "post_id": 49539126, "comment_id": 86085621, "body": "Learn to debug. Watch the value of i after each loop."}, {"owner": {"reputation": 1, "user_id": 9329259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/646d1a07cf7c9f36872329ee53fe1da3?s=128&d=identicon&r=PG&f=1", "display_name": "BRolf", "link": "https://stackoverflow.com/users/9329259/brolf"}, "reply_to_user": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "edited": false, "score": 0, "creation_date": 1522254137, "post_id": 49539126, "comment_id": 86086382, "body": "@D_Bester the issue isnt that I dont know how to debug... the issue is I cant get out of the loop. Nothing happens to the value of the cell because the first part of the code does what I want it to. Where I am failing is figuring out something to triger the loop to stop (in my case the &quot;End&quot;)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1522254636, "post_id": 49539126, "comment_id": 86086702, "body": "<code>Empty</code> doesn&#39;t mean what you think it does. You check for <code>Empty</code> using the <code>IsEmpty</code> function, and that returns <code>True</code> when the cell&#39;s value is a <code>Variant</code> that has <i>no value</i> - not even an empty string."}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 2, "last_activity_date": 1522253219, "creation_date": 1522253219, "answer_id": 49539338, "question_id": 49539126, "link": "https://stackoverflow.com/questions/49539126/exiting-a-do-while-loop/49539338#49539338", "title": "Exiting a Do While Loop", "body": "<p>According to what you describe, you can loose the loop and use <code>Find</code> instead, try the code below:</p>\n\n<pre><code>Option Explicit\n\nSub LoopEmailAdd()\n\nDim FindRng As Range\n\nSet FindRng = Columns(3).Find(\"End\")\n\n' make sure Find was successful finding \"End\"\nIf Not FindRng Is Nothing Then\n    Cells(FindRng.Row - 1, \"C\").Copy Range(\"L1\")\nElse ' in case Find failed\n    MsgBox \"Unable to find End in column C\", vbCritical\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9329259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/646d1a07cf7c9f36872329ee53fe1da3?s=128&d=identicon&r=PG&f=1", "display_name": "BRolf", "link": "https://stackoverflow.com/users/9329259/brolf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1522256948, "creation_date": 1522252607, "last_edit_date": 1522254103, "question_id": 49539126, "link": "https://stackoverflow.com/questions/49539126/exiting-a-do-while-loop", "title": "Exiting a Do While Loop", "body": "<p>I have written this sub as part of a larger piece of code. Effectively what I am trying to do is go down column C, copy where there is a value until I hit \"End\" and paste in \"L1\". If there is no value in the cell I don't want the loop to end as there will be gaps. When I try to run the code, it gets stuck in the loop without exiting. </p>\n\n<pre><code>Sub LoopEmailAdd()\n\nDim i As Long\n\ni = 1\n\nDo While Cells(1, \"C\").Value = \"Email\"\n    If Cells(1 + i, \"C\").Value &lt;&gt; Empty And Cells(1 + i, \"C\").Value &lt;&gt; \"End\" Then\n        Cells(1 + i, \"C\").Copy _\n        Destination:=Range(\"L1\")\n        i = i + 1\n    ElseIf Cells(1 + i, \"C\").Value = \"End\" Then\n        Exit Do\n    End If\nLoop\n\nEnd Sub     \n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 1863, "user_id": 2730283, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jqcif.jpg?s=128&g=1", "display_name": "Stefan Crain", "link": "https://stackoverflow.com/users/2730283/stefan-crain"}, "edited": false, "score": 0, "creation_date": 1522252572, "post_id": 49538799, "comment_id": 86085254, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/37837817/why-does-this-vba-table-relink-code-result-in-error-3219\">Why does this vba table relink code result in error 3219?</a>"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1522268674, "post_id": 49538799, "comment_id": 86094686, "body": "Any reason for those short text fields (6 and 3 chars max)?"}], "answers": [{"tags": [], "owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "is_accepted": false, "score": 0, "last_activity_date": 1524375796, "last_edit_date": 1524375796, "creation_date": 1522268594, "answer_id": 49543541, "question_id": 49538799, "link": "https://stackoverflow.com/questions/49538799/access-vba-adding-fields-error-3219/49543541#49543541", "title": "ACCESS VBA adding fields Error 3219", "body": "<p>As <a href=\"https://msdn.microsoft.com/en-us/library/office/ff820791.aspx\" rel=\"nofollow noreferrer\">Fields.Append</a> is a sub (not a function) you have to pass its arguments without parentheses (or add a<code>Call</code>at beginning). Also reuse your database reference (<code>db</code>). </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim db As DAO.Database 'Library name to clearfy reference (e.g ADODB has a database object too)\nSet db = CurrentDb()\n'add columns\nWith db.TableDefs(\"SCHEDE\") 'for DRY\n    .Fields.Append .CreateField(\"cliente\", dbText, 6)\n    .Fields.Append .CreateField(\"da_canc\", dbText, 3)\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9565052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d6ad3120b1ecca35e47c1047f1837cc?s=128&d=identicon&r=PG&f=1", "display_name": "Paolo Perazzani", "link": "https://stackoverflow.com/users/9565052/paolo-perazzani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 514, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594644850, "creation_date": 1522251764, "last_edit_date": 1594644850, "question_id": 49538799, "link": "https://stackoverflow.com/questions/49538799/access-vba-adding-fields-error-3219", "title": "ACCESS VBA adding fields Error 3219", "body": "<p>i'm trying to add 2 columns to the table \"schede\" but i always return Error 3219. Can anyone help? Here is the code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim db As Database\nSet db = CurrentDb()\n'add columns\nDim campo1 As Field\nSet campo1 = db.TableDefs(\"SCHEDE\").CreateField(\"cliente\", dbText, 6)\nCurrentDb.TableDefs(\"SCHEDE\").Fields.Append (campo1)\nSet campo1 = CurrentDb.TableDefs(\"SCHEDE\").CreateField(\"da_canc\", dbText, 3)\nCurrentDb.TableDefs(\"SCHEDE\").Fields.Append (campo1)\n</code></pre>\n"}, {"tags": ["excel", "vba", "copy", "named-ranges"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1522251933, "post_id": 49538753, "comment_id": 86084783, "body": "is the trial run workbook open?"}, {"owner": {"reputation": 79, "user_id": 8958383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74735c1e2375cb9ca948310e7a7d2136?s=128&d=identicon&r=PG&f=1", "display_name": "Evan Callahan", "link": "https://stackoverflow.com/users/8958383/evan-callahan"}, "edited": false, "score": 0, "creation_date": 1522251945, "post_id": 49538753, "comment_id": 86084791, "body": "Have you tried to Dim x as Range?"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "reply_to_user": {"reputation": 79, "user_id": 8958383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74735c1e2375cb9ca948310e7a7d2136?s=128&d=identicon&r=PG&f=1", "display_name": "Evan Callahan", "link": "https://stackoverflow.com/users/8958383/evan-callahan"}, "edited": false, "score": 0, "creation_date": 1522252015, "post_id": 49538753, "comment_id": 86084837, "body": "@EvanCallahan, you&#39;d immediately get a type mismatch as the <code>Names</code> collection contains <code>Name</code> objects. You should dimension x, but <code>Dim x As Name</code> (and you should also give it a better variable name!)"}, {"owner": {"reputation": 79, "user_id": 8958383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74735c1e2375cb9ca948310e7a7d2136?s=128&d=identicon&r=PG&f=1", "display_name": "Evan Callahan", "link": "https://stackoverflow.com/users/8958383/evan-callahan"}, "edited": false, "score": 0, "creation_date": 1522252219, "post_id": 49538753, "comment_id": 86084992, "body": "Haha sorry about that, it was the <code>Name:=x.Name</code> part that made me think maybe x could be a range and then VBA would recognize the name of that range.  Still learning myself!"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "reply_to_user": {"reputation": 79, "user_id": 8958383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74735c1e2375cb9ca948310e7a7d2136?s=128&d=identicon&r=PG&f=1", "display_name": "Evan Callahan", "link": "https://stackoverflow.com/users/8958383/evan-callahan"}, "edited": false, "score": 0, "creation_date": 1522252283, "post_id": 49538753, "comment_id": 86085036, "body": "@EvanCallahan I don&#39;t blame you. It&#39;s case in point -- that&#39;s what happens if you don&#39;t name your variables carefully!"}, {"owner": {"reputation": 85, "user_id": 7370496, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3228b7ce8618bc620f3e1c67bce9d2db?s=128&d=identicon&r=PG&f=1", "display_name": "ladymrt", "link": "https://stackoverflow.com/users/7370496/ladymrt"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1522252626, "post_id": 49538753, "comment_id": 86085300, "body": "@CallumDA that&#39;s what I was wondering about. So maybe <code>Dim myrgnm As Name</code> and replace all the x&#39;s with myrgnm?"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1522252819, "post_id": 49538753, "comment_id": 86085455, "body": "@ladymrt, because you haven&#39;t declared <code>x</code> is is implicitly a <code>Variant</code> type. When you try to use it in your for loop it is cast to a <code>Variant&#47;Name</code>. It won&#39;t be causing a problem, because VBA understands it is a name, but avoid all confusion by declaring it as a name in the first place. Hopefully my answer clears up the main problems :)"}], "answers": [{"tags": [], "owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1522254999, "creation_date": 1522254999, "answer_id": 49539889, "question_id": 49538753, "link": "https://stackoverflow.com/questions/49538753/copy-all-named-ranges-to-another-workbook/49539889#49539889", "title": "Copy all named ranges to another workbook", "body": "<p>Hard to tell but I suspect that your RefersTo string is >256 characters: If so it will fail because VBA cannot handle refersto strings>256 characters.</p>\n"}], "owner": {"reputation": 85, "user_id": 7370496, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3228b7ce8618bc620f3e1c67bce9d2db?s=128&d=identicon&r=PG&f=1", "display_name": "ladymrt", "link": "https://stackoverflow.com/users/7370496/ladymrt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2218, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1522254999, "creation_date": 1522251642, "last_edit_date": 1522254236, "question_id": 49538753, "link": "https://stackoverflow.com/questions/49538753/copy-all-named-ranges-to-another-workbook", "title": "Copy all named ranges to another workbook", "body": "<p>So I've been fussing with the Microsoft Support answer to this question but their code is simply not working. I'm confused about how they do not define x, or maybe x always equals a variable in VBA? Anyway, I am trying to copy <b>all</b> named ranges in one workbook and bring them over to another workbook. I have to do this for 50-odd workbooks and there are 30-40 named ranges in the base workbook. I really do not want to have to copy-paste these buggers manually. Here's the code they gave for this problem:</p>\n\n<pre><code>Sub Copy_All_Defined_Names()\n   ' Loop through all of the defined names in the active\n   ' workbook.\n     For Each x In ActiveWorkbook.Names\n      ' Add each defined name from the active workbook to\n      ' the target workbook (\"Book2.xls\" or \"Book2.xlsm\").\n      ' \"x.value\" refers to the cell references the\n      ' defined name points to.\n      Workbooks(\"trial run.xlsm\").Names.Add Name:=x.Name, _\n         RefersTo:=x.Value\n   Next x\nEnd Sub\n</code></pre>\n\n<p>Running this gives me the following error:</p>\n\n<p><a href=\"https://i.stack.imgur.com/XmCSz.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XmCSz.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>and highlights the following code:</p>\n\n<p><a href=\"https://i.stack.imgur.com/slLkF.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/slLkF.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>\"trial run.xlsm\" is just a blank workbook and is saved as macro-enabled; this is my target workbook. Seems silly to have to ask for help debugging a macro that microsoft wrote, but I'm kinda at the end of my rope here.</p>\n\n<p>For the original page I got this from, see here: <a href=\"https://support.microsoft.com/en-us/help/213389/how-to-programmatically-copy-all-range-names-in-excel\" rel=\"nofollow noreferrer\">Microsoft Support</a></p>\n\n<p>This is what my named ranges look like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/GzlOx.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GzlOx.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["python", "regex", "vba", "python-3.x", "excel"], "comments": [{"owner": {"reputation": 21991, "user_id": 75103, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7dfc20ceb7d6e1686d9be8f68469afa7?s=128&d=identicon&r=PG", "display_name": "thebjorn", "link": "https://stackoverflow.com/users/75103/thebjorn"}, "edited": false, "score": 0, "creation_date": 1522251153, "post_id": 49538395, "comment_id": 86084207, "body": "You should do a first pass over the code to replace comments with empty strings."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1522251483, "post_id": 49538395, "comment_id": 86084468, "body": "I think you should also consider <i>5</i> to handle lines like <b><i>DoEvents &#39; allow user interaction</i></b>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1522251823, "post_id": 49538395, "comment_id": 86084699, "body": "You&#39;re missing line continuations, for one. Consider <a href=\"https://stackoverflow.com/a/41616800/1188513\">this answer</a>; if you&#39;re trying to make a tool that supports all legal code, regular expresions won&#39;t cut it."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1522252474, "post_id": 49538395, "comment_id": 86085183, "body": "Also <code>Rem this is a comment using a deprecated but legal syntax</code> ;-)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1522252659, "post_id": 49538395, "comment_id": 86085330, "body": "I&#39;m very curious about what you&#39;re <i>actually</i> trying to achieve here. Consider using an actual lexer and parser. Regex will only give you nightmares. Been there, done that."}, {"owner": {"reputation": 1, "user_id": 9564346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a27a96c4ab1df556b4ce04e95d36a5e8?s=128&d=identicon&r=PG&f=1", "display_name": "Chen", "link": "https://stackoverflow.com/users/9564346/chen"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1522255373, "post_id": 49538395, "comment_id": 86087128, "body": "@MathieuGuindon thank you. Ultimately, I am trying to make a tool that will output a high level simple summary of what the VBA code is doing and identify poor programming practice along the way (so good to know Rem is deprecated comment syntax). I posted this question because I am starting by identifying key statements and functions that are not commented out. Maybe you can point me to a tool that already does this or something similar? Or point me in a better direction. Also, what do you recommend for a VBA lexer/parser? Appreciate your time."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1522255742, "post_id": 49538395, "comment_id": 86087338, "body": "I own/manage the <a href=\"https://github.com/rubberduck-vba/Rubberduck\" rel=\"nofollow noreferrer\">Rubberduck</a> OSS project (it&#39;s in C#) - my first attempts at parsing VBA code involved Regex, and were absolutely and thoroughly doomed. Now we use Antlr4 syntax to describe the language grammar and Antlr generates a lexer and a parser for us. 3 years later our grammar is 99.9% there, and we account for module &amp; member attributes (which you normally only get if you export the code files - we get them from the VBE&#39;s guts) and had to implement the language specs to correctly resolve the identifier references."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1522255880, "post_id": 49538395, "comment_id": 86087426, "body": "With proper knowledge of all the declarations and references, we&#39;re able to easily determine whether a variable is used or not, whether a function&#39;s return value is assigned (and soon-ish, whether it&#39;s assigned <i>in all code paths</i>), whether you&#39;re implicitly invoking a class&#39; default member, etc. VBA is excruciatingly hard to parse, especially when you want a tool that can take whatever legal code you throw at it! Rubberduck is licensed under GPLv3, and warmly welcomes new contributors!"}], "owner": {"reputation": 1, "user_id": 9564346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a27a96c4ab1df556b4ce04e95d36a5e8?s=128&d=identicon&r=PG&f=1", "display_name": "Chen", "link": "https://stackoverflow.com/users/9564346/chen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "closed_date": 1522251888, "answer_count": 0, "score": 0, "last_activity_date": 1522251547, "creation_date": 1522250615, "last_edit_date": 1522251547, "question_id": 49538395, "link": "https://stackoverflow.com/questions/49538395/find-pattern-in-line-of-vba-code-that-is-not-a-comment", "closed_reason": "Duplicate", "title": "Find pattern in line of VBA code that is not a comment", "body": "<p>I'm trying to use python/regex to search through lines of VBA code to determine if a certain string pattern exists but only when the string pattern is not commented out. </p>\n\n<p>For example, let's say the string pattern of interest is \"aaa bbb ccc\" and the lines of code I have are:</p>\n\n<pre><code>'aaa bbb ccc\n'   aaa bbb ccc\n' xxx aaa bbb ccc\n    'xxx aaa bbb ccc xxx \nxxx ' xxx aaa bbb ccc xxx \naaa bbb ccc 'xxx \nxxx aaa bbb ccc\n</code></pre>\n\n<p>which is assigned to the Python variable of \"vbaLines\". I want my code to identify line 6 and line 7.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>re.findall(\"(?i)\" + \"(?&lt;!\\S)\" + \"aaa bbb ccc\" + \"(?!\\S)\", vbaLines)\n</code></pre>\n\n<p>The problem with my code is that it finds 6 occurrences of the pattern (all lines except for line 1). I want my code to only identify line 6 and line 7 because these are the only two lines with \"aaa bbb ccc\" where \"aaa bbb ccc\" is not commented out.</p>\n\n<p>Also, I am unfamiliar with VBA, so I do not know if I am missing additional ways in which code is commented out.</p>\n"}, {"tags": ["vba", "excel", "for-loop"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1522250103, "post_id": 49538168, "comment_id": 86083437, "body": "Where do you use <code>I</code> are you trying to check 10 times for quotes, if so you are reopening the workbook each time."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1522250183, "post_id": 49538168, "comment_id": 86083502, "body": "Why are you looping <code>i</code> if you are not using it in the loop? What is it you want to loop through?"}, {"owner": {"reputation": 15, "user_id": 6594544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b4f928e03deabbc27fb4967904af4d1?s=128&d=identicon&r=PG&f=1", "display_name": "Derek", "link": "https://stackoverflow.com/users/6594544/derek"}, "edited": false, "score": 0, "creation_date": 1522250471, "post_id": 49538168, "comment_id": 86083742, "body": "I&#39;m drawing a file path from a list of clients and file names in an excel file. The goal is to open the file in the file path listed, check it for quotes, close the file, and mark the original list telling me whether or not it contains quotes. The for loop was meant to do this process for several items on the list."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1522251148, "post_id": 49538168, "comment_id": 86084201, "body": "@Derek Right now your <code>For</code> loop is just doing the same thing 10 times in a row, nothing is changing on each iteration."}, {"owner": {"reputation": 15, "user_id": 6594544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b4f928e03deabbc27fb4967904af4d1?s=128&d=identicon&r=PG&f=1", "display_name": "Derek", "link": "https://stackoverflow.com/users/6594544/derek"}, "edited": false, "score": 0, "creation_date": 1522251514, "post_id": 49538168, "comment_id": 86084494, "body": "If I copied this correctly,  1. It should get the file path from the active cell and its row. 2. Open the file at the path it got. 3. Look inside it for quotes and A. Return to the original spreadsheet to say quotes were found or B. Place a period. 5. Move to the next row. The issue is that it will cycle through that as expected, but only for about 10 times."}], "owner": {"reputation": 15, "user_id": 6594544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b4f928e03deabbc27fb4967904af4d1?s=128&d=identicon&r=PG&f=1", "display_name": "Derek", "link": "https://stackoverflow.com/users/6594544/derek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1522249912, "creation_date": 1522249912, "question_id": 49538168, "link": "https://stackoverflow.com/questions/49538168/for-loop-vba-not-populating-cells-correctly", "title": "For loop VBA not populating cells correctly", "body": "<p>I have some code that worked fine: it opens a file name from a list, finds if it contains a quote, and returns the status into the list, but I added a For loop and found it only works when set to about \"1 to 10\". Anything much bigger returns the wrong value in several instances. What step have I missed? (I had commented out extra parts which have been removed here.)</p>\n\n<pre><code>Sub BadCharactersFinder()\nApplication.ScreenUpdating = False\n\n    Dim foundDoubleQuote As Variant\n    Dim ClientID As String\n    Dim PDSfilename As String\n    Dim fname As String\n\n    ClientID = ActiveCell.Value\n    PDSfilename = ActiveCell.Offset(0, 1)\n    fname = \"N:\\DOWNLOAD\\XYZfoldername\\\" &amp; ClientID &amp; \"\\original\\\" &amp; XYZfilename\n\nFor i = 1 To 10\n\n    Set WBopener = Application.Workbooks.Open(fname)\n    Set foundDoubleQuote = ActiveSheet.Cells.Find(\"\"\"\", ActiveSheet.Cells(1, 1), xlValues, xlPart, xlByRows)\n\n            If (Not foundDoubleQuote Is Nothing) Then\n                ActiveWorkbook.Close savechanges:=False\n                ActiveCell.Offset(0, 15).Value = \"Contains quotes\"\n            Else\n                ActiveWorkbook.Close savechanges:=False\n                ActiveCell.Offset(0, 15).Value = \".\"\n            End If\n\n    Application.CutCopyMode = False\n    ActiveCell.Offset(1, 0).Select\n    Do Until ActiveCell.Height &lt;&gt; 0\n    ActiveCell.Offset(1, 0).Select\n\n    Loop\n\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "database", "vba", "ms-access"], "comments": [{"owner": {"reputation": 5019, "user_id": 1964648, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d5f77ba39b005427467303d0b7bec048?s=128&d=identicon&r=PG&f=1", "display_name": "NDJ", "link": "https://stackoverflow.com/users/1964648/ndj"}, "edited": false, "score": 0, "creation_date": 1522250198, "post_id": 49538149, "comment_id": 86083509, "body": "I haven&#39;t done any access for a long time, but I&#39;m pretty sure you need apostrophes for strings (&#39;) and maybe # for date/time?  Also it&#39;d be worth looking into parameterized queries."}, {"owner": {"reputation": 6480, "user_id": 455582, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7179dc2d6cfd749a15d189f29164a60a?s=128&d=identicon&r=PG&f=1", "display_name": "Twelfth", "link": "https://stackoverflow.com/users/455582/twelfth"}, "edited": false, "score": 0, "creation_date": 1522250873, "post_id": 49538149, "comment_id": 86084017, "body": "NDJ seems right.   Instead of running the SQL, print it out instead. The error will be easy to spot, no &#39; in values line seems right.  If you can&#39;t get it from there, post whatever print sSQL returns and we can go from there"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1522251914, "post_id": 49538149, "comment_id": 86084769, "body": "Is that exactly as it appears in the VBE?  You&#39;ve got no line continuation characters."}, {"owner": {"reputation": 5, "user_id": 8755692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5996481f81c13468efcb339697382dfe?s=128&d=identicon&r=PG&f=1", "display_name": "RC94", "link": "https://stackoverflow.com/users/8755692/rc94"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1522252397, "post_id": 49538149, "comment_id": 86085120, "body": "@DarrenBartrup-Cook no, I have the SQL all on one line"}, {"owner": {"reputation": 498, "user_id": 4175929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7fda691816cbdf05d24dd2149beeee?s=128&d=identicon&r=PG", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4175929/jeffrey"}, "edited": false, "score": 0, "creation_date": 1522252722, "post_id": 49538149, "comment_id": 86085380, "body": "You are setting a string, strings are not objects and cannot be set.  Try removing that."}, {"owner": {"reputation": 5, "user_id": 8755692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5996481f81c13468efcb339697382dfe?s=128&d=identicon&r=PG&f=1", "display_name": "RC94", "link": "https://stackoverflow.com/users/8755692/rc94"}, "reply_to_user": {"reputation": 498, "user_id": 4175929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7fda691816cbdf05d24dd2149beeee?s=128&d=identicon&r=PG", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4175929/jeffrey"}, "edited": false, "score": 0, "creation_date": 1522253365, "post_id": 49538149, "comment_id": 86085873, "body": "Thank you @jeffrey and everyone else as well"}], "answers": [{"comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 1, "creation_date": 1522270165, "post_id": 49539167, "comment_id": 86095514, "body": "Add <a href=\"https://stackoverflow.com/questions/49509615/how-do-i-use-parameters-in-vba-in-the-different-contexts-in-microsoft-access\">parameters</a> to prevent errors by by wrong values entered (e.g.  quotes in <code>Me.txtENTNAME</code>)."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1522309954, "post_id": 49539167, "comment_id": 86108512, "body": "@ComputerVersteher Good link for the parameters."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 0, "last_activity_date": 1522252723, "creation_date": 1522252723, "answer_id": 49539167, "question_id": 49538149, "link": "https://stackoverflow.com/questions/49538149/creating-data-entry-form-using-button-vba/49539167#49539167", "title": "Creating data entry form using button VBA", "body": "<p>From what I can see there's a couple of mistakes in the code.</p>\n\n<p>You only use <code>SET</code> when setting a reference to an object - sSQL is a text string.<br>\n<code>DoCmd.RunSQL</code> shouldn't have a full-stop after <code>RunSQL</code>- just the text string.<br>\nIf <code>Me.txtENTNAME</code> is a text string it should have an apostrophe before and after it.</p>\n\n<pre><code>Private Sub Command28_Click()\n\n    Dim sSQL As String\n\n    'No Set &amp; ' before and after Me.txtENTNAME (assuming it's text).\n    sSQL = \"INSERT INTO TEST (Carrier_Ent_ID, Row_Insert_TS, Row_Update_TS, \" &amp; _\n           \"Row_Insert_User_ID, Row_Update_User_ID, Carrier_Ent_Name, Active) \" &amp; _\n           \"VALUES (\" &amp; Me.txtENTID &amp; \",\" &amp; Me.txtDate &amp; \",\" &amp; Me.txtDate &amp; \",\" &amp; _\n           Me.cmboUserID &amp; \",\" &amp; Me.cmboUserID &amp; \",'\" &amp; Me.txtENTNAME &amp; \"',\" &amp; Me.txtActive &amp; \"); \"\n\n    'No full stop after RunSQL.\n    DoCmd.RunSQL sSQL\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 8755692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5996481f81c13468efcb339697382dfe?s=128&d=identicon&r=PG&f=1", "display_name": "RC94", "link": "https://stackoverflow.com/users/8755692/rc94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 337, "favorite_count": 0, "accepted_answer_id": 49539167, "answer_count": 1, "score": 0, "last_activity_date": 1593973658, "creation_date": 1522249851, "last_edit_date": 1593973658, "question_id": 49538149, "link": "https://stackoverflow.com/questions/49538149/creating-data-entry-form-using-button-vba", "title": "Creating data entry form using button VBA", "body": "<p>I am trying to create a basic data entry form, however, it is turning into more trouble than I anticipated..  I have the form created, now I am just trying to INSERT the data into the DB (TEST).  I am receiving an \"Object Required\" error.  Any suggestions? All of the txt boxes are verified to be correct.  This is all being done through Access VBA</p>\n\n<pre><code>Private Sub Command28_Click()\n\n\n\nDim sSQL As String\n\nSet sSQL = \"INSERT INTO TEST (Carrier_Ent_ID, Row_Insert_TS, Row_Update_TS, \n            Row_Insert_User_ID, Row_Update_User_ID, Carrier_Ent_Name, Active) \nVALUES (\" &amp; Me.txtENTID &amp; \",\" &amp; Me.txtDate &amp; \",\" &amp; Me.txtDate &amp; \",\" &amp; \n            Me.cmboUserID &amp; \",\" &amp; Me.cmboUserID &amp; \",\" &amp; Me.txtENTNAME &amp; \",\" \n          &amp; Me.Txtactive &amp; \"); \"\n\n\nDoCmd.RunSQL.sSQL\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "copy-paste"], "comments": [{"owner": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "edited": false, "score": 0, "creation_date": 1522251792, "post_id": 49538020, "comment_id": 86084676, "body": "Are you trying to place a copy of this file into all subfolders of the given destination directory? Can you help us understand why you want to make multiple copies of the file?"}, {"owner": {"reputation": 1, "user_id": 9541512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce40f4a538ccde41d4cca60131e177e4?s=128&d=identicon&r=PG&f=1", "display_name": "drautio72", "link": "https://stackoverflow.com/users/9541512/drautio72"}, "reply_to_user": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "edited": false, "score": 0, "creation_date": 1522255189, "post_id": 49538020, "comment_id": 86087024, "body": "Correct.  Sorry I wasn&#39;t clear on that I am trying to copy a file Doug.pdf from the root Billing Folder into a hundred or so company folders that exist in that same directory.  So in S:\\Billing there is Doug.pdf  and I want to copy Doug.pdf into  S:\\Billing\\Company A,   S:\\Billing\\Company B,   S:\\Billing\\Company C,   S:\\Billing\\Company d etc."}, {"owner": {"reputation": 1, "user_id": 9541512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce40f4a538ccde41d4cca60131e177e4?s=128&d=identicon&r=PG&f=1", "display_name": "drautio72", "link": "https://stackoverflow.com/users/9541512/drautio72"}, "reply_to_user": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "edited": false, "score": 0, "creation_date": 1522256208, "post_id": 49538020, "comment_id": 86087619, "body": "As to the why on earth am I trying to do this with Excel VBA When the following command line does the job:     <code>for &#47;D %x in (&quot;S:\\Billing folder\\*.*&quot;) DO COPY &quot;S:\\Billing folder\\*.pdf&quot; &quot;%x\\&quot;</code> Is because Excel VBA is basically the only code I can run in the virtual environment I work in. As I said in my original post if trying to get the for loop that seems so simple in the command line is difficult to force VBA to do I will just run the command line. I thought it would be nice if I could find a way to do operations like that with VBA for future projects. @SmrtGrunt"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9541512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce40f4a538ccde41d4cca60131e177e4?s=128&d=identicon&r=PG&f=1", "display_name": "drautio72", "link": "https://stackoverflow.com/users/9541512/drautio72"}, "edited": false, "score": 0, "creation_date": 1522261775, "post_id": 49540719, "comment_id": 86090814, "body": "@SmartGrunt Wow thank you for an amazingly quick solution I have a test area to test in, I will test it thoroughly and make sure it works!"}, {"owner": {"reputation": 1, "user_id": 9541512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce40f4a538ccde41d4cca60131e177e4?s=128&d=identicon&r=PG&f=1", "display_name": "drautio72", "link": "https://stackoverflow.com/users/9541512/drautio72"}, "edited": false, "score": 0, "creation_date": 1522263383, "post_id": 49540719, "comment_id": 86091774, "body": "@SmartGrunt I am getting a compile error that:  <code>Dim fso As Scripting.FileSystemObject </code> is a User-Defined Type that is not defined. Then the VBA debugger highlights the  Sub Put_A_File_In_All_Subfolders list of arguments as if initializing fso as Scripting.FileSystemObject needed to be included in the arguments of the Sub. I am not certain how to remedy this compile error. I am also not sure what I just wrote makes enough sense LOL bear with me new here to stackoverflow as a question poster. I have used this resource countless times in my coding adventures."}, {"owner": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "reply_to_user": {"reputation": 1, "user_id": 9541512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce40f4a538ccde41d4cca60131e177e4?s=128&d=identicon&r=PG&f=1", "display_name": "drautio72", "link": "https://stackoverflow.com/users/9541512/drautio72"}, "edited": false, "score": 0, "creation_date": 1522265458, "post_id": 49540719, "comment_id": 86092896, "body": "@drautio72 - In your VBA editor, go to Tools --&gt; References --&gt; Make sure &quot;Microsoft Scripting Runtime&quot; library is enabled. That should fix it."}, {"owner": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "reply_to_user": {"reputation": 1, "user_id": 9541512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce40f4a538ccde41d4cca60131e177e4?s=128&d=identicon&r=PG&f=1", "display_name": "drautio72", "link": "https://stackoverflow.com/users/9541512/drautio72"}, "edited": false, "score": 0, "creation_date": 1522265600, "post_id": 49540719, "comment_id": 86092980, "body": "You might also need &quot;System&quot; enabled. I don&#39;t remember which library it&#39;s in."}, {"owner": {"reputation": 1, "user_id": 9541512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce40f4a538ccde41d4cca60131e177e4?s=128&d=identicon&r=PG&f=1", "display_name": "drautio72", "link": "https://stackoverflow.com/users/9541512/drautio72"}, "edited": false, "score": 0, "creation_date": 1522269403, "post_id": 49540719, "comment_id": 86095078, "body": "@SmartGrunt Well super close now! But I am getting Run-time error &#39;5&#39;: Invalid procedure call or argument when it gets down to: <code>Set fsoSubFolder = currentFolder.SubFolders.Item(intSubFolder)</code> Any thoughts?"}, {"owner": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "reply_to_user": {"reputation": 1, "user_id": 9541512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce40f4a538ccde41d4cca60131e177e4?s=128&d=identicon&r=PG&f=1", "display_name": "drautio72", "link": "https://stackoverflow.com/users/9541512/drautio72"}, "edited": false, "score": 0, "creation_date": 1522379444, "post_id": 49540719, "comment_id": 86144112, "body": "Sorry for the delayed response... I haven&#39;t seen that error, but it probably has to do with spaces in the directory names: <a href=\"https://stackoverflow.com/questions/30538131/run-time-error-5-invalid-procedure-call-or-argument\" title=\"run time error 5 invalid procedure call or argument\">stackoverflow.com/questions/30538131/&hellip;</a>"}], "tags": [], "owner": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1522261019, "last_edit_date": 1522261019, "creation_date": 1522258065, "answer_id": 49540719, "question_id": 49538020, "link": "https://stackoverflow.com/questions/49538020/copying-1-file-into-multiple-subdirectories/49540719#49540719", "title": "Copying 1 file into multiple subdirectories", "body": "<p>Try the following code:</p>\n\n<pre><code>'*****************************************************\n' FUNCTION HEADER: Put_A_File_In_All_Subfolders\n'\n' Purpose:  Looks for the specified file, and if it exists it\n'       puts the file in all subfolders of the target path.\n'\n' Inputs:\n'       blnFirstIteration: True / false for whether this is the first function call\n'       strFromPath As String: The path where the file to copy is located.\n'       strToPath As String: The path where the destination folder tree exists.\n'       strFileToCopy: The filename to copy.\n'*****************************************************\n\nSub Put_A_File_In_All_Subfolders( _\n    blnFirstIteration As Boolean, _\n    strFromPath As String, _\n    strToPath As String, _\n    strFileToCopy As String)\n\nDim fso As Scripting.FileSystemObject\nSet fso = New Scripting.FileSystemObject\n\nDim blnEverythingIsValid As Boolean\nblnEverythingIsValid = True\n\n'If this is the first run, check to make sure the initial file\n'exists at that path, else throw error messages:\nIf blnFirstIteration Then\n    If Right(strFromPath, 1) &lt;&gt; \"\\\" Then\n        strFromPath = strFromPath &amp; \"\\\"\n    End If\n\n    If fso.FolderExists(strFromPath) = False Then\n        MsgBox strFromPath &amp; \" doesn't exist\"\n        blnEverythingIsValid = False\n    Else\n        If Not fso.FileExists(strFromPath &amp; strFileToCopy) Then\n            MsgBox strFileToCopy &amp; \" doesn't exist in \" &amp; strFromPath\n            blnEverythingIsValid = False\n        End If\n    End If\n\n    If fso.FolderExists(strToPath) = False Then\n        MsgBox strToPath &amp; \" doesn't exist\"\n        blnEverythingIsValid = False\n    End If\nEnd If\n\nIf blnEverythingIsValid Then\n    If Right(strToPath, 1) &lt;&gt; \"\\\" Then\n        strToPath = strToPath &amp; \"\\\"\n    End If\n\n    'Copy the file to the destination folder\n    fso.CopyFile (strFromPath &amp; strFileToCopy), strToPath, True\n\n    'Run the sub recursively for each subfolder\n    Dim vntSubFolder As Variant\n    Dim currentFolder As Scripting.Folder\n    Set currentFolder = fso.GetFolder(strToPath)\n\n    'Check to see if there are subfolders\n    If currentFolder.SubFolders.Count &gt; 0 Then\n        For Each vntSubFolder In currentFolder.SubFolders\n            'Dim fsoSubFolder As Scripting.Folder\n            'Set fsoSubFolder = currentFolder.SubFolders.item(vntSubFolder)\n\n            Dim strSubFolderPath As String\n            strSubFolderPath = vntSubFolder.Path\n\n            Put_A_File_In_All_Subfolders False, strFromPath, strSubFolderPath, strFileToCopy\n        Next vntSubFolder\n    End If\nElse\n    Set fso = Nothing\n    Exit Sub\nEnd If\n\nSet fso = Nothing\nEnd Sub\n</code></pre>\n\n<p>You can call it using:</p>\n\n<pre><code>Put_A_File_In_All_Subfolders True, \"C:\\PathWithFile\\\", \"C:\\RootDestinationFolder\", \"Filename.ext\"\n</code></pre>\n\n<p>I mashed that up quickly, so please test before using widely...</p>\n"}], "owner": {"reputation": 1, "user_id": 9541512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce40f4a538ccde41d4cca60131e177e4?s=128&d=identicon&r=PG&f=1", "display_name": "drautio72", "link": "https://stackoverflow.com/users/9541512/drautio72"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 157, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522261019, "creation_date": 1522249439, "last_edit_date": 1522249500, "question_id": 49538020, "link": "https://stackoverflow.com/questions/49538020/copying-1-file-into-multiple-subdirectories", "title": "Copying 1 file into multiple subdirectories", "body": "<p>I have found one code snippet that successfully copies 1 file to one specific directory. However what I am trying to piece together is a way to copy one file into hundreds of subdirectories. I have also found code that recursively cycles through subfolders and allows you to take action upon the files in the subfolders. Surely there must be a mash up of these two codes that would allow me to copy the 1 file into numerous subdirectories.\nIf this is not possible I have working code for a command prompt.</p>\n\n<pre><code>Sub Copy_Certain_Files_In_Folder()\n'This example copy all Excel files from FromPath to ToPath.\n'Note: If the files in ToPath already exist it will overwrite\n'existing files in this folder\n\nDim fso As Object\nDim FromPath As String\nDim ToPath As String\nDim FileExt As String\n\n'FromPath = \"C:\\Users\\Ron\\Data\"  '&lt;&lt; Change\n'ToPath = \"C:\\Users\\Ron\\Test\"    '&lt;&lt; Change\n\nFileExt = \"*.pdf\"  '&lt;&lt; Change\n'You can use *.* for all files or *.doc for Word files\n\nIf Right(FromPath, 1) &lt;&gt; \"\\\" Then\n    FromPath = FromPath &amp; \"\\\"\nEnd If\n\nSet fso = CreateObject(\"scripting.filesystemobject\")\n\nIf fso.FolderExists(FromPath) = False Then\n    MsgBox FromPath &amp; \" doesn't exist\"\n    Exit Sub\nEnd If\n\nIf fso.FolderExists(ToPath) = False Then\n    MsgBox ToPath &amp; \" doesn't exist\"\n    Exit Sub\nEnd If\n\nfso.CopyFile Source:=FromPath &amp; FileExt, Destination:=ToPath\nMsgBox \"You can find the files from \" &amp; FromPath &amp; \" in \" &amp; ToPath\n\nEnd Sub\n</code></pre>\n\n<p>Code that cycles through subfolders:</p>\n\n<pre><code>Dim FileSystem As Object\nDim HostFolder As String\n\nHostFolder = \"C:\\\"\n\nSet FileSystem = CreateObject(\"Scripting.FileSystemObject\")\nDoFolder FileSystem.GetFolder(HostFolder)\n\nSub DoFolder(Folder)\nDim SubFolder\nFor Each SubFolder In Folder.SubFolders\n    DoFolder SubFolder\nNext\nDim File\nFor Each File In Folder.Files\n    ' Operate on each file\nNext\nEnd Sub\n</code></pre>\n\n<p>Any advice is welcome!</p>\n"}, {"tags": ["vba", "excel", "internet-explorer"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1522263746, "post_id": 49537537, "comment_id": 86091989, "body": "Try to opt to XHR instead of IE."}], "answers": [{"tags": [], "owner": {"reputation": 123770, "user_id": 2830850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e48b39b77bf324de9aeefd6c5bfc10c6?s=128&d=identicon&r=PG&f=1", "display_name": "Tarun Lalwani", "link": "https://stackoverflow.com/users/2830850/tarun-lalwani"}, "is_accepted": true, "score": 1, "last_activity_date": 1522690774, "last_edit_date": 1522690774, "creation_date": 1522678904, "answer_id": 49613044, "question_id": 49537537, "link": "https://stackoverflow.com/questions/49537537/ie-click-not-working-properly-due-to-value-onchange/49613044#49613044", "title": "IE .Click not working properly due to value onchange", "body": "<p>I think you can try something like below</p>\n\n<pre><code>If el.Name = \"leg_campo1\" Then\n    el.Value = \"Conta de Desenvolvimento Energ\u00e9tico\"\n    Set evnt = doc.ownerDocument.createEvent(\"HTMLEvents\")\n    evnt.initEvent \"change\", True, True\n    el.dispatchEvent evnt\nEnd If\n</code></pre>\n\n<p>This comes from the below thread</p>\n\n<p><a href=\"https://stackoverflow.com/questions/2490825/how-to-trigger-event-in-javascript\">How to trigger event in JavaScript?</a></p>\n"}], "owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 412, "favorite_count": 1, "accepted_answer_id": 49613044, "answer_count": 1, "score": 0, "last_activity_date": 1522690774, "creation_date": 1522248142, "last_edit_date": 1531164843, "question_id": 49537537, "link": "https://stackoverflow.com/questions/49537537/ie-click-not-working-properly-due-to-value-onchange", "title": "IE .Click not working properly due to value onchange", "body": "<h2>Problem</h2>\n\n<p>Trying to automate a search on this website <a href=\"http://biblioteca.aneel.gov.br/index.html\" rel=\"nofollow noreferrer\">http://biblioteca.aneel.gov.br/index.html</a>.</p>\n\n<p>Where the search is made on a hidden tab:</p>\n\n<p><a href=\"https://i.stack.imgur.com/zsi71.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zsi71.png\" alt=\"Hidden tab of the search\"></a></p>\n\n<ul>\n<li>So the hidden tab is named: Legisla\u00e7\u00e3o</li>\n</ul>\n\n<p>And the html Code:</p>\n\n<pre><code>&lt;a name=\"lk_legis\" class=\"link_abas\" id=\"lk_leg\" onclick=\"move_layer('legislacao', parent.hiddenFrame.layerX);\" href=\"#\"&gt;\n\n    &lt;span class=\"text-aba\" id=\"aba_leg\"&gt;Legisla\u00e7\u00e3o&lt;/span&gt;\n\n&lt;/a&gt;\n</code></pre>\n\n<ul>\n<li>The field to fill is: Todos os campos</li>\n</ul>\n\n<p>And the HTML Code:</p>\n\n<pre><code>&lt;td&gt;&lt;input name=\"leg_campo1\" tabindex=\"1\" class=\"inputLegEsq\" style=\"margin-top: 0px;\" onkeypress=\"return validaTecla(1,this,event,5,5613,'','parent.hiddenFrame.modo_busca',0)\" onchange=\"atualizaLeg_campos();\" type=\"text\" maxlength=\"500\" value=\"\"&gt;&lt;/td&gt;        \n</code></pre>\n\n<ul>\n<li>And the Search Button: Busca</li>\n</ul>\n\n<p>And the HTML Code:</p>\n\n<pre><code>    &lt;input name=\"bt_comb\" tabindex=\"20\" title=\"Submeter busca\" class=\"button_busca\" style=\"margin-bottom: 5px;\" onclick=\"return Confere(5613,5,'',parent.hiddenFrame.modo_busca)\" type=\"button\" value=\"Buscar\"&gt;\n    &lt;input name=\"bt_limpar\" tabindex=\"21\" title=\"Limpar campos\" class=\"button_busca\" onclick=\"Resetar();atribuiLegs();\" type=\"button\" value=\"Limpar\"&gt;\n</code></pre>\n\n<h2>Atempts to Solve</h2>\n\n<p>So I tried to solve with the code below:</p>\n\n<pre><code>'Declara fun\u00e7\u00e3o Sleep\n#If VBA7 Then\nPublic Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As LongPtr) 'For 64 Bit Systems\n#Else\nPublic Declare Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long) 'For 32 Bit Systems\n#End If\nSub CDE_ANEEL()\n\n    Dim IE As Object\n    Dim doc As Object, doc1 As Object, doc2 As Object, aba As Object\n    Dim el\n\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n\n    IE.navigate \"http://biblioteca.aneel.gov.br/index.html\"\n    IE.Visible = True\n    EsperaIE IE, 2500\n    Set doc = IE.document.getElementsbyTagName(\"frame\")(0).contentdocument.body\n    Set doc1 = doc.getElementsbyClassName(\"inputLegEsq\")\n    Set doc2 = doc.getElementsbyClassName(\"button_busca\")\n    Set aba = doc.getElementsbyClassName(\"text-aba\")\n\n    For Each el In aba\n        'Debug.Print el.InnerText\n        If el.InnerText = \"Legisla\u00e7\u00e3o\" Then el.Click\n    Next el\n\n    For Each el In doc1\n        'Debug.Print el.Name, el.Value\n        If el.Name = \"leg_campo1\" Then\n        el.Value = \"Conta de Desenvolvimento Energ\u00e9tico\"\n        el.InnerText = \"Conta de Desenvolvimento Energ\u00e9tico\"\n        el.Click\n        el.Focus\n        End If\n    Next el\n\n    'Aperta Enter\n    Sleep 5000\n\n    'Application.SendKeys (\"~\"), True\n\n\n\n        'Apertar Bot\u00e3o\n    For Each el In doc2\n        Debug.Print el.Title, el.onclick\n        Debug.Print InStr(1, el.onclick, \"Confere(5613,5,'',parent.hiddenFrame.modo_busca)\")\n        If InStr(1, el.onclick, \"Confere(5613,5,'',parent.hiddenFrame.modo_busca)\") &gt; 0 Then\n        el.Click\n        Exit For\n        End If\n    Next el\n\n\nEnd Sub\n\nPublic Sub EsperaIE(IE As Object, Optional time As Long = 250)\n'C\u00f3digo de: https://stackoverflow.com/questions/33808000/run-time-error-91-object-variable-or-with-block-variable-not-set\nDim i As Long\nDo\n    Sleep time\n    Debug.Print CStr(i) &amp; vbTab &amp; \"Ready: \" &amp; CStr(IE.READYSTATE = 4) &amp; _\n                vbCrLf &amp; vbTab &amp; \"Busy: \" &amp; CStr(IE.Busy)\n    i = i + 1\nLoop Until IE.READYSTATE = 4 Or Not IE.Busy\nEnd Sub\n</code></pre>\n\n<p>However, When the button to search is Clicked. It isn't recognizing as having Data on the Field. </p>\n\n<p>I think it is due to the value onchange function. That is fired only when something is typed and not when the value changes...</p>\n\n<p>I could solve pressing enter with: <code>Application.SendKeys (\"~\"), True</code>.</p>\n\n<p>But I want to make <code>IE.visible=False</code>. So how to search it correctly without having to press <kbd>Enter</kbd>?</p>\n\n<p>p.s.: I am trying to make on VBA, because of another functions. Some people said to use Selenium VBA, however, I never used it.</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 4, "creation_date": 1522248185, "post_id": 49537439, "comment_id": 86081874, "body": "Holy frickin .select, Batman..."}, {"owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 2, "creation_date": 1522248521, "post_id": 49537439, "comment_id": 86082128, "body": "@Cyril that is a select comment if ever I saw one"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1522248665, "post_id": 49537439, "comment_id": 86082240, "body": "I suggest reading <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a> use that information to refactor your entire code completely and then come back with your clean code and without <code>.Select</code>. You should be able to condense that code to less than 20 lines I think."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1522248763, "post_id": 49537439, "comment_id": 86082343, "body": "And work up from the bottom. If you use Down with only one cell you will go to the last row and then you can&#39;t offset a further row down because you will be off the edge of Excel world."}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1522250502, "post_id": 49537849, "comment_id": 86083753, "body": "<code>.Cells(4,1).End(xlDown)</code> is missing a <code>.Row</code> (twice)"}, {"owner": {"reputation": 21, "user_id": 9564558, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bsu8KwyRab8/AAAAAAAAAAI/AAAAAAAAABo/2b_ReAF681c/photo.jpg?sz=128", "display_name": "Roberto", "link": "https://stackoverflow.com/users/9564558/roberto"}, "edited": false, "score": 0, "creation_date": 1522250504, "post_id": 49537849, "comment_id": 86083756, "body": "<code>.Range(&quot;A4:G&quot; &amp; .Cells(4, 1).End(xlDown)).Copy</code>  gives me &quot;Runtime-error 1004 application defined or object-defined error&quot;"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 21, "user_id": 9564558, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bsu8KwyRab8/AAAAAAAAAAI/AAAAAAAAABo/2b_ReAF681c/photo.jpg?sz=128", "display_name": "Roberto", "link": "https://stackoverflow.com/users/9564558/roberto"}, "edited": false, "score": 0, "creation_date": 1522251767, "post_id": 49537849, "comment_id": 86084663, "body": "@Roberto my bad; I forgot to add in .Row after the .End()  See my edit."}, {"owner": {"reputation": 21, "user_id": 9564558, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bsu8KwyRab8/AAAAAAAAAAI/AAAAAAAAABo/2b_ReAF681c/photo.jpg?sz=128", "display_name": "Roberto", "link": "https://stackoverflow.com/users/9564558/roberto"}, "edited": false, "score": 0, "creation_date": 1522258813, "post_id": 49537849, "comment_id": 86089104, "body": "Same problem, <b>&quot;Runtime-error 1004 PasteSepcial method of Range class failed&quot;</b>   <code>With Sheets(&quot;PULOVER&quot;)         lr = Sheets(&quot;c&quot;).Cells(Sheets(&quot;c&quot;).Rows.Count, 1).End(xlUp).Row         .Range(&quot;A4:G&quot; &amp; .Cells(4, 1).End(xlDown).Row).Copy         Sheets(&quot;c&quot;).Cells(lr + 1, 1).PasteSpecial Paste:=xlPasteValues         Application.CutCopyMode = False     End With</code>"}, {"owner": {"reputation": 21, "user_id": 9564558, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bsu8KwyRab8/AAAAAAAAAAI/AAAAAAAAABo/2b_ReAF681c/photo.jpg?sz=128", "display_name": "Roberto", "link": "https://stackoverflow.com/users/9564558/roberto"}, "edited": false, "score": 0, "creation_date": 1522258940, "post_id": 49537849, "comment_id": 86089174, "body": "for some reason it sees this particular sheet as if it is blank ,but it&#39;s not.It just has only one row of data (A4:G4) but if i write another row of data,it has no problem....I don&#39;t understand why"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 21, "user_id": 9564558, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bsu8KwyRab8/AAAAAAAAAAI/AAAAAAAAABo/2b_ReAF681c/photo.jpg?sz=128", "display_name": "Roberto", "link": "https://stackoverflow.com/users/9564558/roberto"}, "edited": false, "score": 0, "creation_date": 1522261468, "post_id": 49537849, "comment_id": 86090631, "body": "@Roberto I think I know what it is... pastespecial is requiring a whole range to paste into, so it can list values only.  If you were to just paste, it wouldn&#39;t be an issue.  Will update code in a sec to show that range."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 21, "user_id": 9564558, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bsu8KwyRab8/AAAAAAAAAAI/AAAAAAAAABo/2b_ReAF681c/photo.jpg?sz=128", "display_name": "Roberto", "link": "https://stackoverflow.com/users/9564558/roberto"}, "edited": false, "score": 0, "creation_date": 1522261811, "post_id": 49537849, "comment_id": 86090842, "body": "@Roberto Note the addition of olr (other last row)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1522303669, "post_id": 49537849, "comment_id": 86105363, "body": "@Cyril for your interest, the issue here is <code>xlDown</code> in <code>.Cells(4,1).End(xlDown).Row</code> because if row 4 is the only data row <code>xlDown</code> will go until the very end of the worksheet and copy that all. But when you try to paste that it exceeds the rows of the master sheet (just too many rows were copied). Therefore <code>.Cells(.Rows.Count, 1).End(xlUp).Row</code> would work better (together with a check that it has to be \u2265 4) see in my answer aswell."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1522329061, "post_id": 49537849, "comment_id": 86121408, "body": "@P\u1d07\u029c thanks for the follow-up!  I was thinking he used that specifically because of non-contiguous data (hence my comment about finding a contiguous data source in the code snippet)."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1522329234, "post_id": 49537849, "comment_id": 86121526, "body": "@Cyril Yes, I thought that too at first and only figured out because of his comment at my answer, where he tells that there is only one row of data in row 4 of one of the sheets."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 0, "last_activity_date": 1522261568, "last_edit_date": 1522261568, "creation_date": 1522248949, "answer_id": 49537849, "question_id": 49537439, "link": "https://stackoverflow.com/questions/49537439/master-sheet-copy-paste-error-1004/49537849#49537849", "title": "Master sheet copy-paste error 1004", "body": "<p>This hurt me to read through... consolidation time, plus dynamic last row: </p>\n\n<pre><code>Sub MockImportNewData()\n    Dim lr as Long, olr as Long\n    Application.ScreenUpdating = False\n    With Sheets(\"BLUGI\")\n        lr = Sheets(\"Master\").Cells(Sheets(\"Master\").Rows.Count, 1).End(xlUp).Row\n        olr = .Cells(4,1).End(xlDown).Row\n        .Range(\"A4:G\" &amp; ).Copy\n        Sheets(\"MASTER\").Range( Sheets(\"MASTER\").Cells(lr+1, 1), Sheets(\"MASTER\").Cells(lr+olr+1,7)).PasteSpecial Paste:=xlPasteValues\n    End With\n    With Sheets(\"PANT\")\n        lr = Sheets(\"Master\").Cells(Sheets(\"Master\").Rows.Count, 1).End(xlUp).Row\n        olr = .Cells(4,1).End(xlDown).Row\n        .Range(\"A4:G\" &amp; .Cells(4,1).End(xlDown).Row).Copy\n        Sheets(\"MASTER\").Range( Sheets(\"MASTER\").Cells(lr+1, 1), Sheets(\"MASTER\").Cells(lr+olr+1,7)).PasteSpecial Paste:=xlPasteValues            \n    End With\n    Application.CutCopyMode = False\n\n'Start with the above and work from there\n'You may want to find the CONTIGUOUS (that's the real word) range to find the last row\n'Any breaks in the contiguous range will break .End(xlDown)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 9564558, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bsu8KwyRab8/AAAAAAAAAAI/AAAAAAAAABo/2b_ReAF681c/photo.jpg?sz=128", "display_name": "Roberto", "link": "https://stackoverflow.com/users/9564558/roberto"}, "edited": false, "score": 0, "creation_date": 1522251192, "post_id": 49538348, "comment_id": 86084233, "body": "<code>.Cells(lr + 1, 1).PasteSpecial Paste:=xlPasteValues</code> give me &quot;Runtime-error 1004 PasteSepcial method of Range class failed&quot;"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 21, "user_id": 9564558, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bsu8KwyRab8/AAAAAAAAAAI/AAAAAAAAABo/2b_ReAF681c/photo.jpg?sz=128", "display_name": "Roberto", "link": "https://stackoverflow.com/users/9564558/roberto"}, "edited": false, "score": 0, "creation_date": 1522251826, "post_id": 49538348, "comment_id": 86084703, "body": "@Roberto This happened because of a sheet with no data in it. see my edited answer."}, {"owner": {"reputation": 21, "user_id": 9564558, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bsu8KwyRab8/AAAAAAAAAAI/AAAAAAAAABo/2b_ReAF681c/photo.jpg?sz=128", "display_name": "Roberto", "link": "https://stackoverflow.com/users/9564558/roberto"}, "edited": false, "score": 1, "creation_date": 1522252000, "post_id": 49538348, "comment_id": 86084824, "body": "it manages to copy the first 3 sheets <b>BLUGI</b> , <b>PANT</b> , <b>BLUZE</b> ,but for some reason it stops at the 4th sheet <b>PULOVER</b> . I suspect that it has something to do with the fact that I have only 1 row of data(A4:G4) in that sheet ."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 21, "user_id": 9564558, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bsu8KwyRab8/AAAAAAAAAAI/AAAAAAAAABo/2b_ReAF681c/photo.jpg?sz=128", "display_name": "Roberto", "link": "https://stackoverflow.com/users/9564558/roberto"}, "edited": false, "score": 0, "creation_date": 1522252460, "post_id": 49538348, "comment_id": 86085175, "body": "@Roberto then see my edit again. I changed how the last row is found"}, {"owner": {"reputation": 21, "user_id": 9564558, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bsu8KwyRab8/AAAAAAAAAAI/AAAAAAAAABo/2b_ReAF681c/photo.jpg?sz=128", "display_name": "Roberto", "link": "https://stackoverflow.com/users/9564558/roberto"}, "edited": false, "score": 0, "creation_date": 1522257731, "post_id": 49538348, "comment_id": 86088502, "body": "It Worked! Thanks a lot!"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1522252080, "last_edit_date": 1522252080, "creation_date": 1522250467, "answer_id": 49538348, "question_id": 49537439, "link": "https://stackoverflow.com/questions/49537439/master-sheet-copy-paste-error-1004/49538348#49538348", "title": "Master sheet copy-paste error 1004", "body": "<p>Since all worksheets seem to have the same structure you can just loop through the sheet names:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub MockImportNewData()\n    Dim SheetNames As Variant\n    SheetNames = Array(\"BLUGI\", \"PANT\", \"BLUZE\", \"PULOVER\", \"FUSTE\", \"ROCHII\", \"GECI\", \"GEANTA\", \"ACCESORII\")\n\n    Application.ScreenUpdating = False           \n\n    Dim SheetName As Variant\n    For Each SheetName In SheetNames\n        Dim lr As Long\n\n        With Worksheets(SheetName)\n            lr = .Cells(.Rows.Count, 4).End(xlUp).Row \n            If lr &lt; 4 Then\n                MsgBox \"Nothing to copy in: \" &amp; SheetName\n                GoTo NextIteration\n            End If\n            .Range(\"A4:G\" &amp; lr).Copy\n        End With\n\n        With Worksheets(\"Master\")\n            lr = .Cells(.Rows.Count, 1).End(xlUp).Row\n             .Cells(lr + 1, 1).PasteSpecial Paste:=xlPasteValues\n        End With\n\n        Application.CutCopyMode = False\n\nNextIteration:\n    Next SheetName\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Probably a good idea to additionally implement an error handling if <code>SheetName</code> is not found.</p>\n"}], "owner": {"reputation": 21, "user_id": 9564558, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bsu8KwyRab8/AAAAAAAAAAI/AAAAAAAAABo/2b_ReAF681c/photo.jpg?sz=128", "display_name": "Roberto", "link": "https://stackoverflow.com/users/9564558/roberto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 49538348, "answer_count": 2, "score": -1, "last_activity_date": 1522261568, "creation_date": 1522247900, "last_edit_date": 1522249650, "question_id": 49537439, "link": "https://stackoverflow.com/questions/49537439/master-sheet-copy-paste-error-1004", "title": "Master sheet copy-paste error 1004", "body": "<p>I am new to VBA formulas in Excel.</p>\n\n<p>I have a workbook with multiple sheets which needs to be copied (only values) in a master sheet in the same workbook. The problem is I get an error on one of my sheets: </p>\n\n<blockquote>\n  <p>Runtime error 1004:<br>\n  The information cannot be pasted because the Copy area and the paste area are not the same size and shape.</p>\n</blockquote>\n\n<p>I noticed that this error occurs only if I have only one row in my table that is not blank.</p>\n\n<p>Here is my Code: </p>\n\n<pre><code>Sub MockImportNewData()\n\nApplication.ScreenUpdating = False\n\n        Sheets(\"BLUGI\").Select\n        Range(\"A4:G4\").Select\n        Range(Selection, Selection.End(xlDown)).Select\n        Selection.Copy\n        Sheets(\"MASTER\").Select\n        Range(\"A3\").Select\n        Selection.PasteSpecial Paste:=xlPasteValues\n        Application.CutCopyMode = False\n        Sheets(\"PANT\").Select\n        Range(\"A4:G4\").Select\n        Range(Selection, Selection.End(xlDown)).Select\n        Selection.Copy\n        Sheets(\"MASTER\").Select\n        Range(\"A3\").Select\n        Selection.End(xlDown).Select\n        ActiveCell.Offset(1, 0).Select\n        Selection.PasteSpecial Paste:=xlPasteValues\n        Application.CutCopyMode = False\n        Sheets(\"BLUZE\").Select\n        Range(\"A4:G4\").Select\n        Range(Selection, Selection.End(xlDown)).Select\n        Selection.Copy\n        Sheets(\"MASTER\").Select\n        Range(\"A3\").Select\n        Selection.End(xlDown).Select\n        ActiveCell.Offset(1, 0).Select\n        Selection.PasteSpecial Paste:=xlPasteValues\n        Application.CutCopyMode = False\n        Sheets(\"PULOVER\").Select\n        Range(\"A4:G4\").Select\n        Range(Selection, Selection.End(xlDown)).Select\n        Selection.Copy\n        Sheets(\"MASTER\").Select\n        Range(\"A3\").Select\n        Selection.End(xlDown).Select\n        ActiveCell.Offset(1, 0).Select\n        Selection.PasteSpecial Paste:=xlPasteValues\n        Application.CutCopyMode = False\n        Sheets(\"FUSTE\").Select\n        Range(\"A4:G4\").Select\n        Range(Selection, Selection.End(xlDown)).Select\n        Selection.Copy\n        Sheets(\"MASTER\").Select\n        Range(\"A3\").Select\n        Selection.End(xlDown).Select\n        ActiveCell.Offset(1, 0).Select\n        Selection.PasteSpecial Paste:=xlPasteValues\n        Application.CutCopyMode = False\n        Sheets(\"ROCHII\").Select\n        Range(\"A4:G4\").Select\n        Range(Selection, Selection.End(xlDown)).Select\n        Selection.Copy\n        Sheets(\"MASTER\").Select\n        Range(\"A3\").Select\n        Selection.End(xlDown).Select\n        ActiveCell.Offset(1, 0).Select\n        Selection.PasteSpecial Paste:=xlPasteValues\n        Application.CutCopyMode = False\n        Sheets(\"GECI\").Select\n        Range(\"A4:G4\").Select\n        Range(Selection, Selection.End(xlDown)).Select\n        Selection.Copy\n        Sheets(\"MASTER\").Select\n        Range(\"A3\").Select\n        Selection.End(xlDown).Select\n        ActiveCell.Offset(1, 0).Select\n        Selection.PasteSpecial Paste:=xlPasteValues\n        Application.CutCopyMode = False\n        Sheets(\"GEANTA\").Select\n        Range(\"A4:G4\").Select\n        Range(Selection, Selection.End(xlDown)).Select\n        Selection.Copy\n        Sheets(\"MASTER\").Select\n        Range(\"A3\").Select\n        Selection.End(xlDown).Select\n        ActiveCell.Offset(1, 0).Select\n        Selection.PasteSpecial Paste:=xlPasteValues\n        Application.CutCopyMode = False\n        Sheets(\"ACCESORII\").Select\n        Range(\"A4:G4\").Select\n        Range(Selection, Selection.End(xlDown)).Select\n        Selection.Copy\n        Sheets(\"MASTER\").Select\n        Range(\"A3\").Select\n        Selection.End(xlDown).Select\n        ActiveCell.Offset(1, 0).Select\n        Selection.PasteSpecial Paste:=xlPasteValues\n        Application.CutCopyMode = False\n        Sheets(\"Master\").Select\n        Range(\"A5\").Select\n\n        End Sub\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1522247923, "post_id": 49537409, "comment_id": 86081658, "body": "The short answer is in vba it does not matter.  If you are going to try and assign the array to a worksheet range then it does as it is a horizontal array."}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1522249001, "creation_date": 1522249001, "answer_id": 49537868, "question_id": 49537409, "link": "https://stackoverflow.com/questions/49537409/in-vba-is-a-one-dimensional-array-a-row-a-column-or-any/49537868#49537868", "title": "In VBA, is a one-dimensional array a row, a column, or any?", "body": "<p>It doesn't matter. VBA exists outside of Excel, e.g. in PowerPoint or in Word. There you have no rows or columns, but arrays exist.</p>\n"}], "owner": {"reputation": 101, "user_id": 5156380, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh6.googleusercontent.com/-ijCwuL_0MtI/AAAAAAAAAAI/AAAAAAAAACM/b-_iMqxRTSI/photo.jpg?sz=128", "display_name": "sergio trajano", "link": "https://stackoverflow.com/users/5156380/sergio-trajano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 49537868, "answer_count": 1, "score": 0, "last_activity_date": 1522249001, "creation_date": 1522247836, "last_edit_date": 1531164843, "question_id": 49537409, "link": "https://stackoverflow.com/questions/49537409/in-vba-is-a-one-dimensional-array-a-row-a-column-or-any", "title": "In VBA, is a one-dimensional array a row, a column, or any?", "body": "<p>When working with a one dimensinal array in VBA, should we think of it as a row, a column or it doesn't matter?</p>\n"}, {"tags": ["vba", "excel", "ms-office", "date-range"], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 9564606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SpYs2.jpg?s=128&g=1", "display_name": "yourleftleg", "link": "https://stackoverflow.com/users/9564606/yourleftleg"}, "edited": false, "score": 0, "creation_date": 1522249900, "post_id": 49537512, "comment_id": 86083281, "body": "This works! Instead of using:    If Cells(cnt, 1) = 1 or Cells(cnt, 1) = 2 or Cells(cnt, 1) = 4 Then Is there any way for me to say something like    IF Cells(cnt, 1) = &lt;one of the values in this set range&gt;  In a simple line of code?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 47, "user_id": 9564606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SpYs2.jpg?s=128&g=1", "display_name": "yourleftleg", "link": "https://stackoverflow.com/users/9564606/yourleftleg"}, "edited": false, "score": 0, "creation_date": 1522254706, "post_id": 49537512, "comment_id": 86086745, "body": "@yourleftleg  - congrats! :) If you have 3 conditions you need 3 conditions."}, {"owner": {"reputation": 47, "user_id": 9564606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SpYs2.jpg?s=128&g=1", "display_name": "yourleftleg", "link": "https://stackoverflow.com/users/9564606/yourleftleg"}, "edited": false, "score": 1, "creation_date": 1522255951, "post_id": 49537512, "comment_id": 86087468, "body": "I actually ended up figuring out that I could essentially do   iserror(Application.Match(CLng(.Cells(cnt, 2)), famedates, 0)) as the one line of code to check my exportdates range. That worked as well!"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 47, "user_id": 9564606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SpYs2.jpg?s=128&g=1", "display_name": "yourleftleg", "link": "https://stackoverflow.com/users/9564606/yourleftleg"}, "edited": false, "score": 0, "creation_date": 1522257039, "post_id": 49537512, "comment_id": 86088111, "body": "@yourleftleg - this is probably better, but thus you have to take care of a new variable - &quot;famedates&quot;."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 0, "last_activity_date": 1522256941, "last_edit_date": 1522256941, "creation_date": 1522248078, "answer_id": 49537512, "question_id": 49537281, "link": "https://stackoverflow.com/questions/49537281/if-date-in-this-range-can-be-found-in-separate-range-delete-row/49537512#49537512", "title": "If Date in this range can be found in separate range, delete row", "body": "<p>Whenever you have to delete many rows in Excel with VBA, the best practice is to assign these rows to a range and to delete the range at the end.</p>\n\n<p>Thus, your code should be refactored in this part:</p>\n\n<pre><code>For r = Historical.Cells(Rows.Count, 1).End(xlUp).Row To 1 Step -1\n    If Historical.Cells(r, 2).Value = exportdates(1, 1).Value Or _\n        Historical.Cells(r, 2).Value = exportdates(2, 1).Value Or _\n        Historical.Cells(r, 2).Value = exportdates(3, 1).Value _\n        Then Historical.Rows(r).Delete\nNext\n</code></pre>\n\n<p>This is a simple sample that you can use for the refactoring (just make sure to write a few times <code>1</code> in <code>Range(\"A1:A20\")</code> to see how it works:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim deleteRange As Range\n    Dim cnt         As Long\n\n    For cnt = 20 To 1 Step -1\n        If Cells(cnt, 1) = 1 Then\n            If Not deleteRange Is Nothing Then\n                Set deleteRange = Union(deleteRange, Cells(cnt, 1))\n            Else\n                Set deleteRange = Cells(cnt, 1)\n            End If\n        End If\n    Next cnt\n\n    deleteRange.EntireRow.Select\n    Stop\n    deleteRange.EntireRow.Delete\n\nEnd Sub\n</code></pre>\n\n<p>Once you run the code it stops at the <code>Stop</code> sign. You see that the rows to be deleted are selected. Once you continue with <kbd>F5</kbd> they would be deleted. Consider removing the <code>Stop</code> and <code>.Select</code> line in your code.</p>\n\n<p>Some general ideas how to speed up code: <a href=\"https://stackoverflow.com/a/49514930/5448626\">https://stackoverflow.com/a/49514930/5448626</a></p>\n"}], "owner": {"reputation": 47, "user_id": 9564606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SpYs2.jpg?s=128&g=1", "display_name": "yourleftleg", "link": "https://stackoverflow.com/users/9564606/yourleftleg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 49537512, "answer_count": 1, "score": 1, "last_activity_date": 1522256941, "creation_date": 1522247460, "last_edit_date": 1522249597, "question_id": 49537281, "link": "https://stackoverflow.com/questions/49537281/if-date-in-this-range-can-be-found-in-separate-range-delete-row", "title": "If Date in this range can be found in separate range, delete row", "body": "<p>I have a Excel workbook, almost like a database, where I update Historical data each week. Using a separate sub, I pull in an Export as a worksheet to the book. I find the unique dates that are in the export. I then look at Historical data, and if the Historical date matches one of the Export dates, I delete the row in Historical. Eventually I copy and paste the Export in to the Historical data tab.</p>\n\n<p>The code below works how I'd like it to, but I have some questions after the block of code:</p>\n\n<pre><code>Sub AddNewData()\n\n'This will take what's in Export and put it in to Historical\n\nDim Historical As Worksheet\nDim Export As Worksheet\nDim exportdates As Range\n\nSet Historical = ThisWorkbook.Worksheets(\"Historical\")\nSet Export = ThisWorkbook.Worksheets(\"Export\")\n\n'Pulling unique values of dates from this range and pasting to M1:\nExport.Range(\"B2:B\" &amp; Export.Cells(Export.Rows.Count, 1).End(xlUp).Row).AdvancedFilter _\n    Action:=xlFilterCopy, CopyToRange:=Export.Range(\"M1\"), Unique:=True\n\n'Originally I was thinking I could make this a list of some sort vlookup or match?\n'As of now, though, it goes unused...:\nSet exportdates = Export.Range(\"M1:M\" &amp; Export.Cells(Export.Rows.Count, 13).End(xlUp).Row)\n\nFor r = Historical.Cells(Rows.Count, 1).End(xlUp).Row To 1 Step -1\n    If Historical.Cells(r, 2).Value = exportdates(1, 1).Value Or _\n        Historical.Cells(r, 2).Value = exportdates(2, 1).Value Or _\n        Historical.Cells(r, 2).Value = exportdates(3, 1).Value _\n        Then Historical.Rows(r).Delete\nNext\n\n'Copying and pasting Export data to Historical tab\nExport.Range(\"A2:J\" &amp; Export.Cells(Export.Rows.Count, 1).End(xlUp).Row).Copy\nHistorical.Range(\"A\" &amp; Historical.Cells(Historical.Rows.Count, 1).End(xlUp).Row + 1).PasteSpecial xlPasteValues\n\nApplication.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n\n<p>1) Can that IF statement be condensed somehow using the exportdates range?</p>\n\n<p>2) This works just fine for a few hundred rows of data when my dates are simply the first of each month, but I also have an export that has each day as a date that I'll have to match with a different tab with daily information. That one has THOUSANDS of rows. I don't believe this macro will be much more efficient than simply sorting by date and eliminating myself? Can I change the IF statement to be more inclusive, like question 1?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1522247731, "post_id": 49537093, "comment_id": 86081508, "body": "I&#39;d warmly recommend you look into what <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">proper indentation</a> can do to your code&#39;s readability."}, {"owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "edited": false, "score": 2, "creation_date": 1522249144, "post_id": 49537093, "comment_id": 86082655, "body": "Do you really need two timers? Say the big clock rotates twice as fast as the little clock ... you only need one timer, but on each iteration of your <code>do loop</code>, you rotate the small clock half as much as you rotate the big clock. So you end up with one <code>timeout</code> sub, and one <code>do loop</code>. Your problem is that both loops cannot run simultaneously as Excel Vba is not multi-threaded."}, {"owner": {"reputation": 61, "user_id": 2529787, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4c2f0188b58242dea8120eb782cac903?s=128&d=identicon&r=PG", "display_name": "baskinsr", "link": "https://stackoverflow.com/users/2529787/baskinsr"}, "edited": false, "score": 0, "creation_date": 1522250562, "post_id": 49537093, "comment_id": 86083799, "body": "I didn&#39;t need two timers. I didn&#39;t realize I could set one of the clocks to rotate based on the speed of the other clock. That made everything much simpler and worked perfectly!"}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1522249411, "creation_date": 1522249411, "answer_id": 49538013, "question_id": 49537093, "link": "https://stackoverflow.com/questions/49537093/rotate-2-images-on-separate-timers/49538013#49538013", "title": "Rotate 2 images on separate timers", "body": "<p>You could do something like this</p>\n\n<p>Normal Module :</p>\n\n<pre><code>Public c As clsTimer\n\nSub Button1_Click()\n\n    Set c = New clsTimer\n    Set c.s1 = ThisWorkbook.Worksheets(\"Sheet1\").Shapes(1)\n    Set c.s2 = ThisWorkbook.Worksheets(\"Sheet1\").Shapes(2)\n    c.start 1, 2        \n\nEnd Sub\n</code></pre>\n\n<p>and a class module, <code>clsTimer</code></p>\n\n<pre><code>Public s1 As Shape\nPublic s2 As Shape\n\nPublic Function start(lngInterval1 As Long, lnginterval2 As Long)\n\nDim s As Long\nDim lngSecCount As Long\n\nResetTimer:\n\ns = Timer\n\nDo Until Timer &gt; s + 1\n    DoEvents\nLoop\n\nlngSecCount = lngSecCount + 1\n\nIf lngSecCount Mod lngInterval1 = 0 Then s1.Rotation = s1.Rotation + 1\nIf lngSecCount Mod lnginterval2 = 0 Then s2.Rotation = s2.Rotation + 1\n\nGoTo ResetTimer\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 2529787, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4c2f0188b58242dea8120eb782cac903?s=128&d=identicon&r=PG", "display_name": "baskinsr", "link": "https://stackoverflow.com/users/2529787/baskinsr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1522249411, "creation_date": 1522247000, "last_edit_date": 1522248549, "question_id": 49537093, "link": "https://stackoverflow.com/questions/49537093/rotate-2-images-on-separate-timers", "title": "Rotate 2 images on separate timers", "body": "<p>I am trying to rotate 2 separate images in the same macro on different timers. I want them to start at the same time, but rotate at different speeds. I have been able to get them to rotate together, but only at the same speed. My attempt to get them to separate as caused them to run, at best, one before the other, or the second one does not rotate at all</p>\n\n<p>My code currently looks like:</p>\n\n<pre><code>Sub macro()\n\n    rep_count = 0\n\n    Do\n    DoEvents\n\n        rep_count = rep_count + 1\n\n        Sheet1.Shapes(\"Little Clock\").Rotation = rep_count\n        timeout (0.01)\n        Loop Until rep_count = 360\n\n    Do\n    DoEvents\n\n        Sheet1.Shapes(\"Big Clock\").Rotation = rep_count\n        timeout2 (0.01)\n        Loop Until rep_count = 360\n\nEnd Sub\n\nSub timeout(duration_ms As Double)\n    Start_Time = Timer\n    Do\n    DoEvents\n        Loop Until (Timer - Start_Time) &gt;= 0.1\nEnd Sub\n\nSub timeout2(duration_ms As Double)\n    Start_Time = Timer\n    Do\n    DoEvents\n        Loop Until (Timer - Start_Time) &gt;= 0.7\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "powershell", "vba"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1522246584, "post_id": 49536777, "comment_id": 86080521, "body": "Can you simulate the click of the &quot;Tab&quot; button through PowerShell?"}, {"owner": {"reputation": 1207, "user_id": 4991132, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ik_eSRX6tiM/AAAAAAAAAAI/AAAAAAAACrA/dJyE8-u1pr4/photo.jpg?sz=128", "display_name": "thom schumacher", "link": "https://stackoverflow.com/users/4991132/thom-schumacher"}, "edited": false, "score": 0, "creation_date": 1522246791, "post_id": 49536777, "comment_id": 86080708, "body": "if you look at this blog post it might get you started in the right direction: <a href=\"http://vcloud-lab.com/entries/powershell/powershell-poshgui-convert-user-to-sid-and-vice-versa-using\" rel=\"nofollow noreferrer\">vcloud-lab.com/entries/powershell/&hellip;</a>"}, {"owner": {"reputation": 1207, "user_id": 4991132, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ik_eSRX6tiM/AAAAAAAAAAI/AAAAAAAACrA/dJyE8-u1pr4/photo.jpg?sz=128", "display_name": "thom schumacher", "link": "https://stackoverflow.com/users/4991132/thom-schumacher"}, "edited": false, "score": 0, "creation_date": 1522246827, "post_id": 49536777, "comment_id": 86080741, "body": "Sapien.com has PowerShell Studio that you can get a 30 day trial of that will also help get you started. this site will also help <a href=\"http://www.poshgui.com\" rel=\"nofollow noreferrer\">poshgui.com</a>"}, {"owner": {"reputation": 33567, "user_id": 1358, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5f10d1a484dac4a364246bf9f410e9b?s=128&d=identicon&r=PG", "display_name": "EBGreen", "link": "https://stackoverflow.com/users/1358/ebgreen"}, "edited": false, "score": 0, "creation_date": 1522246896, "post_id": 49536777, "comment_id": 86080803, "body": "I would probably just rewrite the VBA entirely in Powershell if this were my issue to solve. If that is not an option then you can load the worksheet and access the OLE objects on it. I don&#39;t have the time to write a proper answer but this link shows doing it with a checkbox. <a href=\"https://social.msdn.microsoft.com/Forums/office/en-US/09e31365-2997-48ff-9e98-b01468ed805c/powershell-and-excels-form-controls?forum=exceldev\" rel=\"nofollow noreferrer\">social.msdn.microsoft.com/Forums/office/en-US/&hellip;</a>"}], "owner": {"reputation": 11, "user_id": 9564265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e722528d786accb7602c5b8c828089f?s=128&d=identicon&r=PG&f=1", "display_name": "vamosdipa", "link": "https://stackoverflow.com/users/9564265/vamosdipa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 416, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1522247548, "creation_date": 1522246115, "last_edit_date": 1531161705, "question_id": 49536777, "link": "https://stackoverflow.com/questions/49536777/fill-excel-vba-forms-and-submit-using-powershell", "title": "Fill Excel VBA Forms and submit using Powershell", "body": "<p>My excel file has a VBA macro button. Upon clicking the button, it invokes a function named <code>MyMacro</code>. The process in turn returns a form named <code>SampleForm</code> (like below) where the end user has to enter the <strong>Name</strong> and then click on <strong>OK</strong> to complete the operation.</p>\n\n<p><img src=\"https://i.stack.imgur.com/el1zi.png\" alt=\"SampleForm\"></p>\n\n<p><strong>Name</strong> would be always same for a given user. Let us assume the value of the Name input is always <strong>John</strong>.</p>\n\n<p>My goal is to automate this whole operation using Powershell. I am calling the concerned macro via <code>Run(\"MyMacro\")</code>. Powershell successfully invokes the macro function, shows the form and then waits for input to proceed further. At this stage, I am clueless on how to access <code>SampleForm</code> from Powershell, fill it and then submit. </p>\n\n<pre><code>$Excel = New-Object -comobject Excel.Application\n$FilePath = 'MyFile.xls'\n$Workbook = $excel.Workbooks.Open($FilePath)\n$App = $excel.Application\n$App.Run(\"MyMacro\")\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-office"], "comments": [{"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1522245865, "post_id": 49536631, "comment_id": 86079940, "body": "Is it possible there is no match?  See <a href=\"https://stackoverflow.com/q/27302794/2521004\">this post</a> for more info"}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "reply_to_user": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1522246468, "post_id": 49536631, "comment_id": 86080425, "body": "It is quite possible, but if I try convert the Int which is &quot;I&quot; to a str then i get &quot;subscript out of range&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1522310956, "post_id": 49537559, "comment_id": 86109061, "body": "Perfect! Thank you Portland Runner :)"}], "tags": [], "owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "is_accepted": true, "score": 1, "last_activity_date": 1522248184, "creation_date": 1522248184, "answer_id": 49537559, "question_id": 49536631, "link": "https://stackoverflow.com/questions/49536631/vba-apply-filter-with-partial-header-match/49537559#49537559", "title": "VBA - Apply Filter With Partial Header Match", "body": "<p><code>Application.Match</code> returns an error when no match is found.  Your using <code>IsError</code> to check for errors but the code is stopping before that point.  You need to skip the errors so that you can catch them later in code.</p>\n\n<p>Try adding: <code>On Error Resume Next</code></p>\n\n<p>Full Code:</p>\n\n<pre><code>Sub WorksheetLoop()\n    Dim WS_Count As Integer, i As Integer, count As Integer\n    Dim rngData As Range\n\n    ' Set WS_Count equal to the number of worksheets in the active\n    ' workbook.\n    WS_Count = ActiveWorkbook.Worksheets.count\n\n    'If Application.Match finds no match it will throw an error so we need to skip them\n    On Error Resume Next\n\n    ' Begin the loop.\n    For i = 1 To WS_Count\n       With Worksheets(i)\n           count = Application.Match(\"*STATUS*\", Worksheets(i).Range(\"A1:AZ1\"), 0)\n\n           If Not IsError(count) Then\n               Set rngData = .Range(\"A1\").CurrentRegion\n               rngData.AutoFilter Field:=count, Criteria1:=\"INACTIVE\"\n           End If\n       End With\n    Next i\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Tested</strong> on simple data set</p>\n\n<p>Before:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Avvmp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Avvmp.png\" alt=\"enter image description here\"></a></p>\n\n<p>After:</p>\n\n<p><a href=\"https://i.stack.imgur.com/dRJY7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dRJY7.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 49537559, "answer_count": 1, "score": 0, "last_activity_date": 1525768754, "creation_date": 1522245713, "last_edit_date": 1531164843, "question_id": 49536631, "link": "https://stackoverflow.com/questions/49536631/vba-apply-filter-with-partial-header-match", "title": "VBA - Apply Filter With Partial Header Match", "body": "<p>I posted a question for a macro solution to applying a filter across multiple worksheets based on header match. </p>\n\n<p>Link: <a href=\"https://stackoverflow.com/questions/49531902/loop-through-multiple-worksheets-and-apply-filter\">Loop Through Multiple Worksheets and Apply Filter</a></p>\n\n<p>I require help with a partial header match and not just an exact match, because, some of the headers will not be an exact match for the criteria - i.e, some will have \"STATUS\" as the header, some will be \"<em>prefix</em>_Status\", others \"CurrentStatus\" and so on.. So I need to use the <code>Instr</code> function (Unless there's some better option) to find any header that contains the word <strong>STATUS</strong> but I cannot seem to figure out where or how to use it..</p>\n\n<p>I have the current solution which throws the following error on the <code>Match</code> line: </p>\n\n<blockquote>\n  <p>Type Mismatch</p>\n</blockquote>\n\n<pre><code>Sub WorksheetLoop()\n\n         Dim WS_Count As Integer\n         Dim I As Integer\n\n         ' Set WS_Count equal to the number of worksheets in the active\n         ' workbook.\n         WS_Count = ActiveWorkbook.Worksheets.count\n\n         ' Begin the loop.\n         For I = 1 To WS_Count\n\n            Dim count As Integer, rngData As Range\n\n            With Worksheets(I)\n                Set rngData = .Range(\"A1\").CurrentRegion\n\n                count = Application.Match(\"*STATUS*\", Worksheets(I).Range(\"A1:AZ1\"), 0)\n\n                If Not IsError(count) Then\n                    rngData.autofilter Field:=count, Criteria1:=\"INACTIVE\"\n                End If\n\n            End With\n\n         Next I\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 1, "creation_date": 1522245420, "post_id": 49536454, "comment_id": 86079605, "body": "How can we <i>reproduce</i> your problem? We need a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 147, "user_id": 9446506, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-ysBC7WQsCUI/AAAAAAAAAAI/AAAAAAAAFPw/OFpVp5M12OI/photo.jpg?sz=128", "display_name": "Remi", "link": "https://stackoverflow.com/users/9446506/remi"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1522245604, "post_id": 49536454, "comment_id": 86079743, "body": "@CallumDa That is the problem! There is no problem a lot of the time until there is a problem. So I want this code to only run after a confirmation. I.E. put a pause in the automation. This problem will occur 1 in 25 times currently."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1522247603, "post_id": 49536454, "comment_id": 86081412, "body": "Please don&#39;t put answers in the question - you can self-answer your own question by posting an actual <i>answer</i> in the provided space below. Anything else defeats the Q&amp;A nature of this site - Stack Overflow isn&#39;t some discussion forum where answers are in all kinds of random places; users <i>expect</i> to find answers under <i>answers</i>, and the OP is <i>expected</i> to contain a specific <i>question</i>. Take the <a href=\"https://stackoverflow.com/tour\">tour</a> if you haven&#39;t already. Cheers!"}, {"owner": {"reputation": 147, "user_id": 9446506, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-ysBC7WQsCUI/AAAAAAAAAAI/AAAAAAAAFPw/OFpVp5M12OI/photo.jpg?sz=128", "display_name": "Remi", "link": "https://stackoverflow.com/users/9446506/remi"}, "edited": false, "score": 0, "creation_date": 1522249924, "post_id": 49536454, "comment_id": 86083303, "body": "Saw the button below, thanks."}], "answers": [{"tags": [], "owner": {"reputation": 147, "user_id": 9446506, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-ysBC7WQsCUI/AAAAAAAAAAI/AAAAAAAAFPw/OFpVp5M12OI/photo.jpg?sz=128", "display_name": "Remi", "link": "https://stackoverflow.com/users/9446506/remi"}, "is_accepted": false, "score": 0, "last_activity_date": 1522249902, "creation_date": 1522249902, "answer_id": 49538161, "question_id": 49536454, "link": "https://stackoverflow.com/questions/49536454/way-to-avoid-false-entries/49538161#49538161", "title": "Way to Avoid False Entries", "body": "<p><strong>EDIT: SOLVED!!</strong></p>\n\n<pre><code>   Private Sub Worksheet_Calculate()\n\n        Dim n As Long\n        Dim rspn As VbMsgBoxResult\n\n        rspn = MsgBox(\"Did you want to add a project?\", vbYesNo)\n\n    If rspn = vbNo Then Exit Sub\n    'code\n         n = GetTableSize()\n        If n &gt; LastRowNumber Then NewDatabaseEntry\n        ' Always set LastRowNumber so that even after entries are deleted (n &lt; NumRows),\n        ' adding new entries will work correctly.\n        LastRowNumber = n\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 9446506, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-ysBC7WQsCUI/AAAAAAAAAAI/AAAAAAAAFPw/OFpVp5M12OI/photo.jpg?sz=128", "display_name": "Remi", "link": "https://stackoverflow.com/users/9446506/remi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522249902, "creation_date": 1522245289, "last_edit_date": 1522249883, "question_id": 49536454, "link": "https://stackoverflow.com/questions/49536454/way-to-avoid-false-entries", "title": "Way to Avoid False Entries", "body": "<p>I have a macro that adds records to a storage table if a feeder table has a new row added.\nIt works fine and doesn't produce errors.\nThere are times however when it adds records <strong><em>when no new row was added</em></strong> to the feeder table.</p>\n\n<p>I was wondering what I would need to add to always confirm before adding a new record?</p>\n\n<p>Code:</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n\n\n    Dim n As Long\n    n = GetTableSize() '**GetTableSize monitors a static cell which calculates table number of used rows in a table. If that number is different than LastRowNumber...**\n    If n &gt; LastRowNumber Then NewDatabaseEntry **' NewDatabaseEntry adds new records\n    ' Always set LastRowNumber so that even after entries are deleted (n &lt; NumRows),\n    ' adding new entries will work correctly.**\n    LastRowNumber = n 'It then resets the values so they are equal again\n\n\nEnd Sub\n</code></pre>\n\n<p>Sometimes, I'm working in the feeder table, and then I go check the records table and a new set of records has been added, even though no new rows were added.\nIs there a way to add a message box that asks if you meant to add a new record and if you click no, it stops this from running?</p>\n\n<p>I am currently getting errors for the code below. This could be a solution if I get it to work correctly right?</p>\n"}, {"tags": ["regex", "vba", "excel"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1522245314, "post_id": 49536344, "comment_id": 86079494, "body": "What have you tried?  What defines <code>Blue 1</code> and <code>Blue 2</code> vs just <code>Blue</code>?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1522245817, "post_id": 49536344, "comment_id": 86079910, "body": "What VBA code have you used?  <b>What defines <code>Blue 1</code> and <code>Blue 2</code> vs just <code>Blue</code></b> <i>(Edit your question to show the code.  It is pretty hard to read in the comment section)</i>"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9564203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d32634bd52e6d4473285e62c12f94ddd?s=128&d=identicon&r=PG&f=1", "display_name": "Ctala23", "link": "https://stackoverflow.com/users/9564203/ctala23"}, "edited": false, "score": 0, "creation_date": 1522246628, "post_id": 49536735, "comment_id": 86080559, "body": "Wow! I am embarrassed it was that simple. I mean, there is still some variability I have to account for, but that was actually what I needed. I cannot tell you how many weird formulas I have run through to try to get this. Thank you so much."}, {"owner": {"reputation": 18939, "user_id": 2756409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UIrGI.jpg?s=128&g=1", "display_name": "TylerH", "link": "https://stackoverflow.com/users/2756409/tylerh"}, "edited": false, "score": 0, "creation_date": 1522257179, "post_id": 49536735, "comment_id": 86088184, "body": "If this is not an answer then it should not be posted as one."}, {"owner": {"reputation": 18939, "user_id": 2756409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UIrGI.jpg?s=128&g=1", "display_name": "TylerH", "link": "https://stackoverflow.com/users/2756409/tylerh"}, "reply_to_user": {"reputation": 13, "user_id": 9564203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d32634bd52e6d4473285e62c12f94ddd?s=128&d=identicon&r=PG&f=1", "display_name": "Ctala23", "link": "https://stackoverflow.com/users/9564203/ctala23"}, "edited": false, "score": 0, "creation_date": 1522257217, "post_id": 49536735, "comment_id": 86088209, "body": "@Ctala23 if this solves your problem, please click the green check mark to the left of the answer to indicate to others that it&#39;s a working solution. (also, welcome to Stack Overflow)"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 18939, "user_id": 2756409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UIrGI.jpg?s=128&g=1", "display_name": "TylerH", "link": "https://stackoverflow.com/users/2756409/tylerh"}, "edited": false, "score": 0, "creation_date": 1522312298, "post_id": 49536735, "comment_id": 86109827, "body": "@TylerH I posted as an answer for improved formatting and the image."}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 0, "last_activity_date": 1522246007, "creation_date": 1522246007, "answer_id": 49536735, "question_id": 49536344, "link": "https://stackoverflow.com/questions/49536344/extracting-irregular-dates-associated-with-specific-words-in-single-cell-with-mu/49536735#49536735", "title": "Extracting Irregular Dates Associated with Specific Words in Single Cell with Multiple Lines in Excel", "body": "<p>NOT AN ANSWER : It doesn't really need code, you can use <code>MID</code> <code>FIND</code> <code>SUBSTITUTE</code>  quickly playing, I used the following </p>\n\n<p><code>=IF(FIND(C$1,$B2,1)-11&lt;11,MID($B2,1,10),MID($B2,FIND(C$1,$B2,1)-11,10))</code></p>\n\n<p>Which gives this, <a href=\"https://i.stack.imgur.com/OJAN6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OJAN6.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 13, "user_id": 9564203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d32634bd52e6d4473285e62c12f94ddd?s=128&d=identicon&r=PG&f=1", "display_name": "Ctala23", "link": "https://stackoverflow.com/users/9564203/ctala23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "closed_date": 1522247426, "accepted_answer_id": 49536735, "answer_count": 1, "score": -1, "last_activity_date": 1522257154, "creation_date": 1522244968, "last_edit_date": 1522257154, "question_id": 49536344, "link": "https://stackoverflow.com/questions/49536344/extracting-irregular-dates-associated-with-specific-words-in-single-cell-with-mu", "closed_reason": "Not suitable for this site", "title": "Extracting Irregular Dates Associated with Specific Words in Single Cell with Multiple Lines in Excel", "body": "<p>This is my first post on here, so please excuse any mistakes.</p>\n\n<p>I have a column of cells. Each cell contains a variable number of lines withing the cell. Most lines contain a date. The format of the date varies slightly. Sometimes it is in the format MM/DD/YYYY, sometimes it will be MM/DD/YY, etc. My goal is to extract the date associated with a specific word in each line. Also, each cell is on a row with an identifying number. Therefore, I need the output to be along the same row. </p>\n\n<p>Example:<br>\n<a href=\"https://i.stack.imgur.com/lTLT7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lTLT7.png\" alt=\"Desired Output\"></a></p>\n\n<p>I have tried every extract date formula I can find and I have run into three problems: </p>\n\n<ol>\n<li>how to pull multiple dates from the cell, </li>\n<li>how to compensate for the fact that some rows have dates that are formatted differently, and </li>\n<li>how to pull dates only associated with certain words on the same line as the date.</li>\n</ol>\n\n<p>It appears that my best option would be to use Regular Expressions. However, I have just started playing around with VBA and every function I have found that seems related to my issue I have been unable to adapt to my specific problem. I was using this post as a guide to build my function initially, but I cannot get it to work: <a href=\"https://stackoverflow.com/questions/37145856/extracting-multiple-dates-from-a-single-cell?utm_medium=organic&amp;utm_source=google_rich_qa&amp;utm_campaign=google_rich_qa\">Extracting Multiple Dates from a single cell</a></p>\n\n<p>Originally, I tried breaking the lines up by doing text to column and this formula: </p>\n\n<pre><code>=IF(SEARCH(\"Red\",D2),DATE(MID(D2,SEARCH(\"??/??/20??\",D2)+6,4),MID(D2,SEARCH(\"??/??/20??\",D2),2),MID(D2,SEARCH(\"??/??/20??\",D2)+3,2)), \"No Red Date\")\n</code></pre>\n\n<p>However, text to column was not working because of irregular spacing issues. And Blue 1 and Blue 2 is just there to compensate for if there are multiple Blue dates in the cell, which there often are</p>\n"}, {"tags": ["vba", "excel", "conditional-formatting"], "comments": [{"owner": {"reputation": 91, "user_id": 7557408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e2ce02d4f8e8c9251c5fa62c54dfef3?s=128&d=identicon&r=PG&f=1", "display_name": "Ionut", "link": "https://stackoverflow.com/users/7557408/ionut"}, "edited": false, "score": 1, "creation_date": 1522245020, "post_id": 49536300, "comment_id": 86079208, "body": "try to change Tabelle4.Cells(&quot;B2&quot;) to Tabelle4.Range(&quot;B2&quot;).Value Also change Interior.color with Interior.CoroIndex"}, {"owner": {"reputation": 113, "user_id": 9456216, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ba5693829f4c7340e117d99a258fb421?s=128&d=identicon&r=PG&f=1", "display_name": "HPM", "link": "https://stackoverflow.com/users/9456216/hpm"}, "reply_to_user": {"reputation": 91, "user_id": 7557408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e2ce02d4f8e8c9251c5fa62c54dfef3?s=128&d=identicon&r=PG&f=1", "display_name": "Ionut", "link": "https://stackoverflow.com/users/7557408/ionut"}, "edited": false, "score": 0, "creation_date": 1522245247, "post_id": 49536300, "comment_id": 86079427, "body": "@Ionut With <code>Tabelle4.Range(&quot;B2&quot;).Value</code> the code works smooth.  Thanks alot :) Though, I did not apply <code>ColorIndex</code>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 91, "user_id": 7557408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e2ce02d4f8e8c9251c5fa62c54dfef3?s=128&d=identicon&r=PG&f=1", "display_name": "Ionut", "link": "https://stackoverflow.com/users/7557408/ionut"}, "edited": false, "score": 0, "creation_date": 1522245308, "post_id": 49536300, "comment_id": 86079489, "body": "@Ionut - <code>ColorIndex</code> should give an error."}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 9456216, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ba5693829f4c7340e117d99a258fb421?s=128&d=identicon&r=PG&f=1", "display_name": "HPM", "link": "https://stackoverflow.com/users/9456216/hpm"}, "edited": false, "score": 0, "creation_date": 1522245645, "post_id": 49536512, "comment_id": 86079777, "body": "That&#39;s right but wouldn&#39;t have solved my problem with the condition :)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 113, "user_id": 9456216, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ba5693829f4c7340e117d99a258fb421?s=128&d=identicon&r=PG&f=1", "display_name": "HPM", "link": "https://stackoverflow.com/users/9456216/hpm"}, "edited": false, "score": 0, "creation_date": 1522245870, "post_id": 49536512, "comment_id": 86079944, "body": "@HPM - true, but it is a good idea to start from something small and working and then build further."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1522245432, "creation_date": 1522245432, "answer_id": 49536512, "question_id": 49536300, "link": "https://stackoverflow.com/questions/49536300/excel-vba-conditional-formatting-error/49536512#49536512", "title": "Excel VBA Conditional Formatting Error", "body": "<p>This is how the code would look like, if you simplify it as much as possible:</p>\n\n<pre><code>Sub ColorTest()\n\n    Dim cellClr     As Long\n    Dim fontClr     As Long\n    Dim cell        As Range\n\n    cellClr = RGB(232, 245, 246)\n    fontClr = RGB(26, 155, 167)\n\n    For Each cell In Range(Cells(1, 1), Cells(5, 5))\n        If cell &lt;&gt; \"\" And cell.Value &lt;= 5 Then\n            cell.Interior.Color = cellClr\n            cell.Font.Color = fontClr\n        End If\n    Next cell\n\nEnd Sub\n</code></pre>\n\n<p>Now, if you enter something in the Range <code>A1:E5</code> of the <code>ActiveSheet</code>, it will become green with green background.</p>\n"}], "owner": {"reputation": 113, "user_id": 9456216, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ba5693829f4c7340e117d99a258fb421?s=128&d=identicon&r=PG&f=1", "display_name": "HPM", "link": "https://stackoverflow.com/users/9456216/hpm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 164, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522245432, "creation_date": 1522244832, "question_id": 49536300, "link": "https://stackoverflow.com/questions/49536300/excel-vba-conditional-formatting-error", "title": "Excel VBA Conditional Formatting Error", "body": "<p>I am using the following code to format the <code>Cell.Interior.Color</code> and <code>Cell.Font.Color</code> of certain cells which fullfill a in <code>Tabelle4.Cells(\"B2\")</code> pre-definied criteria:</p>\n\n<pre><code>Sub ColorTest1()\n\nDim lastcell As Long\nDim Cellclr As Long\nDim Fontclr As Long\n\nlastcell = Tabelle3.Range(\"C1048576\").End(xlUp).Row\nCellclr = RGB(232, 245, 246)\nFontclr = RGB(26, 155, 167)\n\n\n    For Each Cell In Tabelle3.Range(Tabelle3.Cells(9, 3), Tabelle3.Cells(lastcell, 3))\n\n        If Cell &lt;&gt; \"\" And Cell.Value &lt;= Tabelle4.Cells(\"B2\") Then\n\n            Cell.Interior.Color = Cellclr\n            Cell.Font.Color = Fontclr\n\n        End If\n\n    Next Cell\n\nEnd Sub\n</code></pre>\n\n<p>However my condition line is not working out, but no error shown:</p>\n\n<pre><code>If Cell &lt;&gt; \"\" And Cell.Value &lt;= Tabelle4.Cells(\"B2\") Then\n</code></pre>\n\n<p>Does someone know whats going on here and probably how to fix it? </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1522244790, "post_id": 49536216, "comment_id": 86079000, "body": "Welcome to SO. If you show the work you&#39;ve done to try to accomplish this yourself and provide an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> we can help you a lot more. For more understanding, see <a href=\"https://meta.stackoverflow.com/questions/284236/why-is-can-someone-help-me-not-an-actual-question\">why is &quot;please help&quot; not a question</a>."}, {"owner": {"reputation": 1292, "user_id": 1887634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57d96d668a832a01e56fae26fc8859bc?s=128&d=identicon&r=PG", "display_name": "Alan", "link": "https://stackoverflow.com/users/1887634/alan"}, "edited": false, "score": 0, "creation_date": 1522367434, "post_id": 49536216, "comment_id": 86141517, "body": "Data Filter isn&#39;t an option?"}], "owner": {"reputation": 1, "user_id": 9564336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6232eef457720f985d9302e7d9e8a154?s=128&d=identicon&r=PG&f=1", "display_name": "Hablomos", "link": "https://stackoverflow.com/users/9564336/hablomos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1522367149, "creation_date": 1522244636, "last_edit_date": 1531164843, "question_id": 49536216, "link": "https://stackoverflow.com/questions/49536216/hiding-rows-based-on-linked-cells-in-excel", "title": "Hiding Rows Based on linked cells in Excel", "body": "<p>I am brand new to VBA but I'm trying to accomplish the following task in Excel.\nI have cells <code>B3:B192</code> on sheet2 linked to <code>D3:D192</code> on sheet1. On sheet2 any row that doesn't have a value in column B to be hidden. I've been looking around at some of the questions others have asked regarding similar problems but I can't seem to make anything work for me.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1522244351, "post_id": 49536048, "comment_id": 86078655, "body": "You could do <code>wsNew.Cells(1, 2) = var</code> but then you haven&#39;t defined <code>wsNew</code>."}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 1, "creation_date": 1522245119, "post_id": 49536048, "comment_id": 86079312, "body": "<code>var</code> is a bad name for a <code>String</code> variable. It reads as though it&#39;s a <code>Variant</code> type. Actually, though, it&#39;s a bad name for <i>any</i> variable. Instead, name it something meaningful, e.g. <i>managerName</i> or <i>productDescription</i>...etc."}], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1522261583, "last_edit_date": 1522261583, "creation_date": 1522244348, "answer_id": 49536095, "question_id": 49536048, "link": "https://stackoverflow.com/questions/49536048/referring-to-a-new-worksheet-with-variable-name/49536095#49536095", "title": "Referring to a new worksheet with variable name", "body": "<p>You will need to assign the Worksheet Object to a variable then you can refer directly to it in the code. You'll also need to explicitcly reference the <code>Activesheet</code>, otherwise the code will not work as expected, especially in this case.</p>\n\n<pre><code>Dim wsCurr as Worksheet\nSet wsCurr = Worksheets(\"mySheet\") 'change as needed (I avoid ActiveSheet whenever possible)\n\nDim myVariable As String\nmyVariable = wsCurr.Range(\"A34\").Value\n\nDim wsNew as Worksheet      \nSet wsNew = Sheets.Add(After:=wsCurr)\n\nwsNew.Cells(1, 2) = myVariable\n</code></pre>\n\n<p>Also, notice how I changed <code>var</code> to <code>myVariable</code>. CallumDA has a great point in the comment below your post about naming variables.</p>\n"}, {"comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1522261620, "post_id": 49541057, "comment_id": 86090711, "body": "it&#39;s because you need to place arguments in parens when assigning to an object. I forgot that in my original answer but edited it in."}], "tags": [], "owner": {"reputation": 45, "user_id": 8724170, "user_type": "registered", "profile_image": "https://graph.facebook.com/871112756397408/picture?type=large", "display_name": "nh3", "link": "https://stackoverflow.com/users/8724170/nh3"}, "is_accepted": false, "score": 0, "last_activity_date": 1522259303, "creation_date": 1522259303, "answer_id": 49541057, "question_id": 49536048, "link": "https://stackoverflow.com/questions/49536048/referring-to-a-new-worksheet-with-variable-name/49541057#49541057", "title": "Referring to a new worksheet with variable name", "body": "<p>This:</p>\n\n<pre><code>Dim wsCurr as Worksheet\nSet wsCurr = Worksheets(\"mySheet\") 'change as needed (I avoid ActiveSheet whenever possible)\n\nDim myVariable As String\nmyVariable = wsCurr.Range(\"A34\").Value\n\nDim wsNew as Worksheet      \nSet wsNew = Sheets.Add After:=wsCurr\n\nwsNew.Cells(1, 2) = myVariable\n</code></pre>\n\n<p>worked like a charm, many thanks to all of you.</p>\n\n<p>Only this smallest thing was something Excel gave me error:</p>\n\n<pre><code>Set wsNew = Sheets.Add After:=wsCurr\n</code></pre>\n\n<p>So by changing that to this:</p>\n\n<pre><code>Set wsNew = Sheets.Add(After:=wsCurr)\n</code></pre>\n\n<p>Made it to work perfectly.</p>\n"}], "owner": {"reputation": 45, "user_id": 8724170, "user_type": "registered", "profile_image": "https://graph.facebook.com/871112756397408/picture?type=large", "display_name": "nh3", "link": "https://stackoverflow.com/users/8724170/nh3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 847, "favorite_count": 0, "accepted_answer_id": 49536095, "answer_count": 2, "score": 1, "last_activity_date": 1522261583, "creation_date": 1522244209, "last_edit_date": 1522245335, "question_id": 49536048, "link": "https://stackoverflow.com/questions/49536048/referring-to-a-new-worksheet-with-variable-name", "title": "Referring to a new worksheet with variable name", "body": "<p>So what I want to do is like this in visual basic VBA for Excel:</p>\n\n<pre><code>Dim var As String\nDim wsNew as Worksheet  \n\nSheets.Add After:=ActiveSheet\n\nvar = Range(\"A34\").Value\nWorksheets(wsNew).Cells(1, 2) = var\n</code></pre>\n\n<p>But in this case line: <code>Worksheets(wsNew).Cells(1, 2) = var</code><br>\ngives error </p>\n\n<blockquote>\n  <p>Run-time error 13, type mismatch</p>\n</blockquote>\n\n<p>I don't want to give string name to the new worksheet because then I would always have to rename the sheets. So is it possible to refer to a worksheet in VBA with variable name instead of string name.</p>\n"}, {"tags": ["string", "excel", "variables", "fixed-length-record", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1522244463, "post_id": 49535927, "comment_id": 86078745, "body": "you dim <code>HilvlActivity</code> but you use <code>HilvlActivitySource</code> and the length <code>String * 3</code> applies to the first but your range is in the second. So your question is not very clear."}, {"owner": {"reputation": 3, "user_id": 9564193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d91a1d674daa0f065177488188c29923?s=128&d=identicon&r=PG&f=1", "display_name": "Someday I&#39;ll be great at VBA", "link": "https://stackoverflow.com/users/9564193/someday-ill-be-great-at-vba"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1522244625, "post_id": 49535927, "comment_id": 86078865, "body": "@ PEH Sorry, wrote the range from memory, the string variable name and declared range are supposed to be the same."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1522244830, "post_id": 49535927, "comment_id": 86079036, "body": "but then you still assign a <code>.Row</code> which is a row number to a string, which also doesn&#39;t make much sense. Please <a href=\"https://stackoverflow.com/posts/49535927/edit\">edit</a> and update your question to what you actually mean then."}, {"owner": {"reputation": 3, "user_id": 9564193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d91a1d674daa0f065177488188c29923?s=128&d=identicon&r=PG&f=1", "display_name": "Someday I&#39;ll be great at VBA", "link": "https://stackoverflow.com/users/9564193/someday-ill-be-great-at-vba"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1522245281, "post_id": 49535927, "comment_id": 86079464, "body": "@ PEH Hmm, I see what you mean. The row would take the count and not the values of the cells. I was going to have to re-structure the range, but I really appreciate you pointing it out. Thanks!"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1522245625, "post_id": 49535927, "comment_id": 86079764, "body": "Yes and even if you take the values of the range (multiple cells), you cannot push them into 1 string. You would need at least an array for that. I think you are totally up the wrong tree with what you are trying to do and already asked the wrong question. So what are you really trying to do?"}, {"owner": {"reputation": 3, "user_id": 9564193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d91a1d674daa0f065177488188c29923?s=128&d=identicon&r=PG&f=1", "display_name": "Someday I&#39;ll be great at VBA", "link": "https://stackoverflow.com/users/9564193/someday-ill-be-great-at-vba"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1522246890, "post_id": 49535927, "comment_id": 86080799, "body": "@PEH I am trying to take an entire row whose cells each contain a value mix of letters and numbers (only 3 characters are allowed per cell) and then set the range of that row as the entire row. I was doing arrays but this is a project for another team, and they want everything in variables that are not arrays (or constants). So I am trying trying to minimizing the data type because it is going to be more inefficient by not using arrays."}, {"owner": {"reputation": 3, "user_id": 9564193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d91a1d674daa0f065177488188c29923?s=128&d=identicon&r=PG&f=1", "display_name": "Someday I&#39;ll be great at VBA", "link": "https://stackoverflow.com/users/9564193/someday-ill-be-great-at-vba"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1522247172, "post_id": 49535927, "comment_id": 86081036, "body": "@ PEH I believe that @Chronocidal  has answered my question. Thank you though! :)"}], "answers": [{"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1522244409, "post_id": 49536053, "comment_id": 86078706, "body": "Interesting, never knew that existed."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1522244534, "post_id": 49536053, "comment_id": 86078797, "body": "@SJR - this exists for backwards compatibility, I doubt that it can be of any practical use."}, {"owner": {"reputation": 3, "user_id": 9564193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d91a1d674daa0f065177488188c29923?s=128&d=identicon&r=PG&f=1", "display_name": "Someday I&#39;ll be great at VBA", "link": "https://stackoverflow.com/users/9564193/someday-ill-be-great-at-vba"}, "edited": false, "score": 0, "creation_date": 1522244725, "post_id": 49536053, "comment_id": 86078955, "body": "@Vityata that&#39;s what I thought, the string is just setting the length per cell in a range, so I am wondering now if the problem is how I declared the range as the entire row. Thanks!"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 3, "user_id": 9564193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d91a1d674daa0f065177488188c29923?s=128&d=identicon&r=PG&f=1", "display_name": "Someday I&#39;ll be great at VBA", "link": "https://stackoverflow.com/users/9564193/someday-ill-be-great-at-vba"}, "edited": false, "score": 1, "creation_date": 1522244799, "post_id": 49536053, "comment_id": 86079010, "body": "@BellaS.Holt <b>No</b> - the <code>Range</code> is <b>not</b> having its length set, the <code>String</code> variable is.  If you wanted to do that, use Data Validation instead."}, {"owner": {"reputation": 3, "user_id": 9564193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d91a1d674daa0f065177488188c29923?s=128&d=identicon&r=PG&f=1", "display_name": "Someday I&#39;ll be great at VBA", "link": "https://stackoverflow.com/users/9564193/someday-ill-be-great-at-vba"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1522245958, "post_id": 49536053, "comment_id": 86080017, "body": "@Chronocidal I am sorry, I am really not approaching this right, so if I say a Dim S as String * 3 and then equal it to a range of an entire row, each cell in the row is set to 3 characters (not the variable) per a cell in the range row? Is that correct?"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 3, "user_id": 9564193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d91a1d674daa0f065177488188c29923?s=128&d=identicon&r=PG&f=1", "display_name": "Someday I&#39;ll be great at VBA", "link": "https://stackoverflow.com/users/9564193/someday-ill-be-great-at-vba"}, "edited": false, "score": 0, "creation_date": 1522246219, "post_id": 49536053, "comment_id": 86080224, "body": "@BellaS.Holt No, the <code>String</code> variable <code>HiLvlActivity</code> is set to a string of the first 3 characters (padded with spaces) of the row <i>number</i> the cell.  You want <code>Dim rCell As Range: For Each rCell In Range(&quot;F3&quot;,Range(&quot;F3&quot;).End(xlDown)): rCell.Value = Left(rCell.Value &amp; Space(3),3): Next rCell</code> to trim the values to the first 3 characters with space-padding at the end"}, {"owner": {"reputation": 3, "user_id": 9564193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d91a1d674daa0f065177488188c29923?s=128&d=identicon&r=PG&f=1", "display_name": "Someday I&#39;ll be great at VBA", "link": "https://stackoverflow.com/users/9564193/someday-ill-be-great-at-vba"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1522247111, "post_id": 49536053, "comment_id": 86080978, "body": "@Chronocidal, I have not see variables defined that way and definitely need to look into other resources. But the code makes a lot more sense. (kinda like whenever Arthur Doyle explains Sherlock Holmes reasoning for his answer that solved the case). Perfect, thank you!"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1522244840, "last_edit_date": 1522244840, "creation_date": 1522244226, "answer_id": 49536053, "question_id": 49535927, "link": "https://stackoverflow.com/questions/49535927/by-creating-a-variable-that-is-defined-as-a-string-with-a-fixed-length-is-the-u/49536053#49536053", "title": "By creating a Variable that is defined as a string with a fixed-length, is the used bytes per cell or range?", "body": "<p><code>Dim a as String * 10</code> means that the string <code>a</code> will be always of length <code>10</code> and if an assigned value goes above this length it will be cut to the first <code>10</code> chars.</p>\n\n<p>This illustrates it:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim a   As String * 3\n    Dim b   As String\n    Dim c   As String * 10\n\n    a = \"ABCD\"\n    b = \"ABCD\"\n    c = \"ABCD\"\n\n    Debug.Print a                    'ABC\n    Debug.Print b                    'ABCD\n    Debug.Print Len(c)               '10  \n    Range(\"A1\") = StrReverse(c)      '      DCBA in range \"A1\" with 6 empty spaces upfront\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": true, "score": 0, "last_activity_date": 1522244692, "creation_date": 1522244692, "answer_id": 49536237, "question_id": 49535927, "link": "https://stackoverflow.com/questions/49535927/by-creating-a-variable-that-is-defined-as-a-string-with-a-fixed-length-is-the-u/49536237#49536237", "title": "By creating a Variable that is defined as a string with a fixed-length, is the used bytes per cell or range?", "body": "<p>Well, first:  You haven't defined <code>HilvlActivitySource</code> as a variable anywhere...</p>\n\n<p>The length of a fixed-length-string is applied to the string variable itself.  For example:</p>\n\n<pre><code>Dim HilvlActivity as String * 3\nHilvlActivity = ActiveSheet.Range(\"F3\").Value\nMsgBox Len(HilvlActivity)\n</code></pre>\n\n<p>will <strong>always</strong> show the message <code>3</code> - if F3 contains less than 3 characters, then there will be spaces added to the end.  If F3 contains <em>more</em> than 3 characters, then only the first 3 will be stored.</p>\n"}], "owner": {"reputation": 3, "user_id": 9564193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d91a1d674daa0f065177488188c29923?s=128&d=identicon&r=PG&f=1", "display_name": "Someday I&#39;ll be great at VBA", "link": "https://stackoverflow.com/users/9564193/someday-ill-be-great-at-vba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 638, "favorite_count": 0, "accepted_answer_id": 49536237, "answer_count": 2, "score": 0, "last_activity_date": 1522244840, "creation_date": 1522243848, "last_edit_date": 1531161705, "question_id": 49535927, "link": "https://stackoverflow.com/questions/49535927/by-creating-a-variable-that-is-defined-as-a-string-with-a-fixed-length-is-the-u", "title": "By creating a Variable that is defined as a string with a fixed-length, is the used bytes per cell or range?", "body": "<p>as a relatively new user to Excel, I could not seem to find any confirmation if the a string with a fixed-length has the memory assigned per range or cell. </p>\n\n<p>I am thinking it is per range, because I could not create a string with a fixed-length and set the range as the last cell in a row.</p>\n\n<p>Ex:</p>\n\n<pre><code>Dim HilvlActivity as String * 3\nHilvlActivitySource = Range(\"F3\", \"F:F\").End(xlDown).Row\n</code></pre>\n\n<p>And instead, had to use</p>\n\n<pre><code>Dim HilvlActivity as String * 5000\nHilvlActivitySource = Range(\"F3\", \"F:F\").End(xlDown).Row\n</code></pre>\n\n<p>So my question is basically: is the assigned fixed-length definition per cell (Ex: F3) or per the entire assigned range?</p>\n\n<p>I may be overthinking this, or should have coded the end of the row more efficiently (will change later). But this is still a basic concept that I want to make sure I understand. Some of the information I have looked into is John Walkenbach's book for Power Programming with VBA, Microsoft (<a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/data-types/string-data-type\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/data-types/string-data-type</a>), PowerSpreadSheets (<a href=\"https://powerspreadsheets.com/vba-data-types/#Long-VBA-Data-Type\" rel=\"nofollow noreferrer\">https://powerspreadsheets.com/vba-data-types/#Long-VBA-Data-Type</a>), but still can't seem to find the correct answer. </p>\n\n<p>Anyone know of any good resources that really dives into variable details, it would be appreciate. Otherwise, thanks for the help! :)</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": false, "score": 1, "last_activity_date": 1522244380, "creation_date": 1522244380, "answer_id": 49536104, "question_id": 49535895, "link": "https://stackoverflow.com/questions/49535895/find-and-replace-multiple-text-strings-on-multiple-text-files-from-a-folder/49536104#49536104", "title": "Find and Replace Multiple Text Strings on Multiple Text Files from a folder", "body": "<p>Borrowed from <a href=\"https://social.msdn.microsoft.com/Forums/en-US/62fceda5-b21a-40b6-857c-ad28f12c1b23/use-excel-vba-to-open-a-text-file-and-search-it-for-a-specific-string?forum=isvvba\" rel=\"nofollow noreferrer\">https://social.msdn.microsoft.com/Forums/en-US/62fceda5-b21a-40b6-857c-ad28f12c1b23/use-excel-vba-to-open-a-text-file-and-search-it-for-a-specific-string?forum=isvvba</a></p>\n\n<pre><code>Sub SearchTextFile()\n    Const strFileName = \"C:\\MyFiles\\TextFile.txt\"\n    Const strSearch = \"Some Text\"\n    Dim strLine As String\n    Dim f As Integer\n    Dim lngLine As Long\n    Dim blnFound As Boolean\n    f = FreeFile\n    Open strFileName For Input As #f\n    Do While Not EOF(f)\n        lngLine = lngLine + 1\n        Line Input #f, strLine\n        If InStr(1, strLine, strSearch, vbBinaryCompare) &gt; 0 Then\n            MsgBox \"Search string found in line \" &amp; lngLine, vbInformation\n            blnFound = True\n            Exit Do\n        End If\n    Loop\n    Close #f\n    If Not blnFound Then\n        MsgBox \"Search string not found\", vbInformation\n    End If\nEnd Sub\n</code></pre>\n\n<p>This is simply just finding the match. You can use the built in function \"Replace\" which land the total fix. You would also have to fit in the \"loop through files\" code, which here is a snippet. </p>\n\n<pre><code>Dim StrFile As String\nStrFile = Dir(pathtofile &amp; \"\\*\" &amp; \".txt\")\nDo While Len(StrFile) &gt; 0\n    Debug.Print StrFile\n    StrFile = Dir\nLoop\n</code></pre>\n\n<p>I wouldve made this a comment, but it was too much text. This isnt meant to be a full blown answer, just giving you the pieces you need to put it all together on your own. </p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 6443781, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YB6CB1WJABA/AAAAAAAAAAI/AAAAAAAAEdI/vTwUfAKOxmU/photo.jpg?sz=128", "display_name": "Jayakumar krishnamoorthy", "link": "https://stackoverflow.com/users/6443781/jayakumar-krishnamoorthy"}, "is_accepted": false, "score": 1, "last_activity_date": 1522305105, "creation_date": 1522305105, "answer_id": 49549434, "question_id": 49535895, "link": "https://stackoverflow.com/questions/49535895/find-and-replace-multiple-text-strings-on-multiple-text-files-from-a-folder/49549434#49549434", "title": "Find and Replace Multiple Text Strings on Multiple Text Files from a folder", "body": "<p>Thanks for all your help. I have found alternate solution using the below EXE. FART.exe (FART - Find and Replace Text). I have create a batch file with the below command example.</p>\n\n<p><a href=\"https://emtunc.org/blog/03/2011/farting-the-easy-way-find-and-replace-text/\" rel=\"nofollow noreferrer\">https://emtunc.org/blog/03/2011/farting-the-easy-way-find-and-replace-text/</a></p>\n\n<p><a href=\"http://fart-it.sourceforge.net/\" rel=\"nofollow noreferrer\">http://fart-it.sourceforge.net/</a></p>\n\n<p>Examples:</p>\n\n<p>fart \"C:\\APRIL2011\\Scripts\\someFile.txt\" oldText newText</p>\n\n<p>This line instructs FART to simply replace the string oldText with newText.</p>\n\n<p>fart -i -r \"C:\\APRIL2011\\Scripts*.prm\" march2011 APRIL2011</p>\n\n<p>This line will instruct FART to recursively (-r) search for any file with the .prm extension in the \\Scripts folder. The -i flag tells FART to ignore case-sensitivity when looking for the string.</p>\n"}], "owner": {"reputation": 23, "user_id": 6443781, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YB6CB1WJABA/AAAAAAAAAAI/AAAAAAAAEdI/vTwUfAKOxmU/photo.jpg?sz=128", "display_name": "Jayakumar krishnamoorthy", "link": "https://stackoverflow.com/users/6443781/jayakumar-krishnamoorthy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2306, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1522439543, "creation_date": 1522243738, "last_edit_date": 1531164843, "question_id": 49535895, "link": "https://stackoverflow.com/questions/49535895/find-and-replace-multiple-text-strings-on-multiple-text-files-from-a-folder", "title": "Find and Replace Multiple Text Strings on Multiple Text Files from a folder", "body": "<p>I'm working on the vba code to accomplish the following tasks</p>\n\n<ol>\n<li>Word Document Open a Text file from the folder</li>\n<li>Find and replace the text (multiple Text) based on a excel sheet (which have find what and replace with)</li>\n<li>Process all text files in the folder and save it.</li>\n</ol>\n\n<p>I would like to customize the below code for the above requirement, </p>\n\n<p>I'm using Office 2016 and I think I have to replace Application.FileSearch in the script to ApplicationFileSearch for 2003 and prior office editions.</p>\n\n<p>I try to accomplish using the word macro recorder and also used notepad++, I've recorded in Notepad++ also and it works for one file, I would like to do batch process all files in the folder and save it after replacing the text. </p>\n\n<p>As there is too many lines there to replace more than 30 or more lines to replace, I would like the code to look for the text from a excel file like find what and replace with columns.</p>\n\n<pre><code> Sub FindReplaceAllDocsInFolder( )\n Dim i As Integer\n Dim doc As Document\n Dim rng As Range\n\n With Application.FileSearch\n.NewSearch\n.LookIn = \"C:\\My Documents\"\n.SearchSubFolders = False\n.FileType = msoFileTypeWordDocuments\nIf Not .Execute( ) = 0 Then\n    For i = 1 To .FoundFiles.Count\n         Set doc = Documents.Open(.FoundFiles(i))\n            For Each rng In doc.StoryRanges\n             With rng.Find\n                .ClearFormatting\n                .Replacement.ClearFormatting\n                .Text = \"Dewey &amp; Cheatem\"\n                .Replacement.Text = \"Dewey, Cheatem &amp; Howe\"\n                .Forward = True\n                .Wrap = wdFindContinue\n                .Format = False\n                .MatchCase = False\n                .MatchWholeWord = False\n                .MatchWildcards = False\n                .MatchSoundsLike = False\n                .MatchAllWordForms = False\n                .Execute Replace:=wdReplaceAll\n             End With\n            Next rng\n         doc.Save\n         doc.Close\n\n         Set rng = Nothing\n         Set doc = Nothing\n    Next i\nElse\n    MsgBox \"No files matched \" &amp; .FileName\nEnd If\n End With\n End Sub\n</code></pre>\n\n<p>Thanks\nJay</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 91, "user_id": 7557408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e2ce02d4f8e8c9251c5fa62c54dfef3?s=128&d=identicon&r=PG&f=1", "display_name": "Ionut", "link": "https://stackoverflow.com/users/7557408/ionut"}, "edited": false, "score": 0, "creation_date": 1522244253, "post_id": 49535883, "comment_id": 86078581, "body": "Try open your files like this: directory = &quot;Path to your files&quot; filename = Dir(directory &amp; &quot;<i>.xl*</i>&quot;)     Do While filename &lt;&gt; &quot;&quot;     Workbooks.Open (directory &amp; filename)  loop  and use &#39;Option Explicit&#39; right before you sub"}, {"owner": {"reputation": 91, "user_id": 7557408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e2ce02d4f8e8c9251c5fa62c54dfef3?s=128&d=identicon&r=PG&f=1", "display_name": "Ionut", "link": "https://stackoverflow.com/users/7557408/ionut"}, "edited": false, "score": 0, "creation_date": 1522244287, "post_id": 49535883, "comment_id": 86078604, "body": "Also do you receive your error at a specific line or when you try to run your code? If you want me to post the code bellow let me know"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1522265731, "post_id": 49535883, "comment_id": 86093058, "body": "There are multiple issues with your code, but they are not related to <code>Sub or function not defined</code>. It might be about macros in the files you are opening."}], "answers": [{"comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1522265352, "post_id": 49542567, "comment_id": 86092836, "body": "Evaluating <code>(MyFile)</code>, while unnecessary here and <a href=\"https://stackoverflow.com/q/8070033/11683\">harmful in certain cases</a>, is valid, possible and yields <code>MyFile</code> as a result."}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1522356001, "post_id": 49542567, "comment_id": 86137537, "body": "Downvoted? This is VBA, and the use of () on a left hand call of a function/method does cause issues - I have experienced this myself - something seemingly innocuous is not passed correctly."}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1522356263, "post_id": 49542567, "comment_id": 86137666, "body": "@GSerg: Read the additional explanation that is linked in the answer you linked - you will see that the &quot;certain cases&quot; is a bit broader than what you are implying."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1522358886, "post_id": 49542567, "comment_id": 86138895, "body": "It is <i>my</i> answer, and I added that link to it specifically because I had read the explanation it pointed to. I am saying that in this particular case <code>(MyFile)</code> is not causing any problems to the OP, and certainly not the <code>Sub or function not defined</code> error. It is correct that the parentheses must be removed. But they happen to cause no harm in this particular case, so an answer that suggests <code>(MyFile)</code> as the sole reason of the problem is wrong (and therefore should be downvoted). At most, you should have left a comment saying, &quot;As a side note, you should remove the parentheses&quot;."}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1522360717, "post_id": 49542567, "comment_id": 86139591, "body": "@GSerg: In my experience, it may contribute to the overall answer.Yes, you may have different experiences. Secondly, Comments are not there to provide answers (partial or otherwise) - I would have thought that you would already know that. If you know that this is not the problem and you can point to the problem, then provide an answer yourself."}], "tags": [], "owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "is_accepted": false, "score": -1, "last_activity_date": 1522264899, "creation_date": 1522264899, "answer_id": 49542567, "question_id": 49535883, "link": "https://stackoverflow.com/questions/49535883/sub-or-function-error/49542567#49542567", "title": "Sub or function error", "body": "<p>The following line will be causing some grief:</p>\n\n<pre><code>Workbooks.Open (MyFile)\n</code></pre>\n\n<p>The <code>()</code> means that VBA is trying to evaluate <code>MyFile</code> before running the <code>Open</code> command. Of course, <code>MyFile</code> is a string/path so can't run.</p>\n\n<p>Try</p>\n\n<pre><code>Workbooks.Open MyFile\n</code></pre>\n\n<p>instead.</p>\n"}], "owner": {"reputation": 1, "user_id": 9562988, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Z6V0hskg8Ak/AAAAAAAAAAI/AAAAAAAAAGw/DkAnxHDXqeY/photo.jpg?sz=128", "display_name": "kenny Hatontola", "link": "https://stackoverflow.com/users/9562988/kenny-hatontola"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 181, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522264899, "creation_date": 1522243709, "last_edit_date": 1522244380, "question_id": 49535883, "link": "https://stackoverflow.com/questions/49535883/sub-or-function-error", "title": "Sub or function error", "body": "<p>I am new to vba, I want to transfer data from multiple sheets in one folder to one sheet. I wrote the programme as follows:</p>\n\n<pre><code>Sub LoopThroughDirectory()\n\nDim MyFile As String\nDim erow\nMyFile = Dir(\"C:\\Bulletinwork\\\")\n\nDo While Len(MyFile) &gt; 0\nIf MyFile = \"Bmaster.xlsm\" Then\nExit Sub\nEnd If\n\nWorkbooks.Open (MyFile)\nRange(\"A4:I42\").Copy\nActiveWorkbook.Close\n\nerow = Sheet1.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\nActiveSheet.Paste Destination:=Worksheets(\"Sheet1\").Range(Cells(erow, 1), Cells(erow, 9))\n\nMyFile = Dir\n\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>Can someone help me find the reason why when I try to run the programme, I get an error message saying \"sub or function not defined\".</p>\n\n<p>Kenny</p>\n"}, {"tags": ["c#", "vba", "ms-word", "interop", "word-style"], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1522338460, "last_edit_date": 1522338460, "creation_date": 1522243882, "answer_id": 49535939, "question_id": 49535021, "link": "https://stackoverflow.com/questions/49535021/vba-style-linktolisttemplate-listtemplate-nothing-in-c-word-interop/49535939#49535939", "title": "VBA &quot;style().LinkToListTemplate ListTemplate := Nothing&quot; in c# word interop", "body": "<p>The <code>LinkToListTemplate</code> method wants a <code>ListTemplate</code> object. VBA isn't so choosy, it figures it out for the developer. The following works for me:</p>\n\n<pre><code>Word.ListTemplate lt = null;\nstyl.LinkToListTemplate(lt); \n</code></pre>\n\n<p>Note: While testing I noticed that doing this creates additional ListTemplates in the document. This can be a problem if you do it a lot in the one document. In the version where ListTemplates were introduced (97, as I recall) it could corrupt files, or even crash them. MS fixed that by having Word automatically delete unused LTs when a critical number accumulated. But it can affect file size. Just FYI :-)</p>\n"}], "owner": {"reputation": 35, "user_id": 9327786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f3d68b1c18915d767a8d33333bd086c?s=128&d=identicon&r=PG&f=1", "display_name": "Thucasimp", "link": "https://stackoverflow.com/users/9327786/thucasimp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 256, "favorite_count": 0, "accepted_answer_id": 49535939, "answer_count": 1, "score": 1, "last_activity_date": 1593814803, "creation_date": 1522241342, "last_edit_date": 1593814803, "question_id": 49535021, "link": "https://stackoverflow.com/questions/49535021/vba-style-linktolisttemplate-listtemplate-nothing-in-c-word-interop", "title": "VBA &quot;style().LinkToListTemplate ListTemplate := Nothing&quot; in c# word interop", "body": "<p>There is a word VBA method \"style(\"style\").LinkToListTemplate ListTemplate:=Nothing\" which is used to set the style numbering to None.\nMy problem is that I cannot find the same in C# word interop. \nThe method exists but does not work with style.LinkToListTemplate(null).</p>\n"}, {"tags": ["vba", "excel", "loops"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 3, "creation_date": 1522241122, "post_id": 49534877, "comment_id": 86076190, "body": "Please use proper indentation, otherwise it&#39;s almost impossible to read. I&#39;ve done it for you this time -- thanks to <a href=\"http://rubberduckvba.com/Indentation\" rel=\"nofollow noreferrer\">RubberDuck</a>"}], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 5608610, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/65dad4d3a6dfc409707bb54fc67a728b?s=128&d=identicon&r=PG&f=1", "display_name": "glarys", "link": "https://stackoverflow.com/users/5608610/glarys"}, "edited": false, "score": 0, "creation_date": 1522256720, "post_id": 49535400, "comment_id": 86087919, "body": "Thanks for that! Still does not run through though; don&#39;t have time today anymore but will check tomorrow again and then get back to you (and also accept your answer if I get it to work...)"}, {"owner": {"reputation": 131, "user_id": 5608610, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/65dad4d3a6dfc409707bb54fc67a728b?s=128&d=identicon&r=PG&f=1", "display_name": "glarys", "link": "https://stackoverflow.com/users/5608610/glarys"}, "edited": false, "score": 0, "creation_date": 1522256839, "post_id": 49535400, "comment_id": 86087996, "body": "Thanks, that&#39;s very kind of you, highly appreciated! :)"}, {"owner": {"reputation": 131, "user_id": 5608610, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/65dad4d3a6dfc409707bb54fc67a728b?s=128&d=identicon&r=PG&f=1", "display_name": "glarys", "link": "https://stackoverflow.com/users/5608610/glarys"}, "edited": false, "score": 0, "creation_date": 1522334689, "post_id": 49535400, "comment_id": 86125848, "body": "I double checked my code and with the help of your comments and this code <a href=\"https://gist.github.com/ijd65/6075855\" rel=\"nofollow noreferrer\">gist.github.com/ijd65/6075855</a> could fix mine. In the answer I post the script that I got"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 3, "last_activity_date": 1522245054, "last_edit_date": 1522245054, "creation_date": 1522242295, "answer_id": 49535400, "question_id": 49534877, "link": "https://stackoverflow.com/questions/49534877/find-cells-and-copy-the-following-cell-to-a-separate-worksheet/49535400#49535400", "title": "Find cells and copy the following cell to a separate worksheet", "body": "<p>In <code>Sub WorksheetLoop()</code></p>\n\n<p>This   <code>Dim DestSh As Worksheet</code> should go before <code>Set DestSh = ActiveWorkbook.Worksheets.Add</code></p>\n\n<p>Use Option Explicit at the top of your code and you will also realise you have to declare</p>\n\n<pre><code>  Dim Last As Long\n</code></pre>\n\n<p>And that you have range variables that you later try to add things to that may cause type mismatches e.g.</p>\n\n<p>You may want</p>\n\n<pre><code>Set copyra = ra.Offset(, 1)\n</code></pre>\n\n<p>Rather than </p>\n\n<pre><code> copyra = ra + 1 \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 131, "user_id": 5608610, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/65dad4d3a6dfc409707bb54fc67a728b?s=128&d=identicon&r=PG&f=1", "display_name": "glarys", "link": "https://stackoverflow.com/users/5608610/glarys"}, "is_accepted": false, "score": 1, "last_activity_date": 1523879450, "last_edit_date": 1523879450, "creation_date": 1522334540, "answer_id": 49558971, "question_id": 49534877, "link": "https://stackoverflow.com/questions/49534877/find-cells-and-copy-the-following-cell-to-a-separate-worksheet/49558971#49558971", "title": "Find cells and copy the following cell to a separate worksheet", "body": "<p>I figured out how to solve the problem. Below there is the code for those who might need it   </p>\n\n<pre><code> Option Explicit\n\n    'Define last row and column\n\n    Function LastRow(sh As Worksheet)\n        On Error Resume Next\n        LastRow = sh.Cells.Find(What:=\"*\", _\n                                After:=sh.Range(\"B1\"), _\n                                Lookat:=xlPart, _\n                                LookIn:=xlFormulas, _\n                                SearchOrder:=xlByRows, _\n                                SearchDirection:=xlPrevious, _\n                                MatchCase:=False).Row\n        On Error GoTo 0\n    End Function\n\n    Function LastCol(sh As Worksheet)\n        On Error Resume Next\n        LastCol = sh.Cells.Find(What:=\"*\", _\n                                After:=sh.Range(\"B1\"), _\n                                Lookat:=xlPart, _\n                                LookIn:=xlFormulas, _\n                                SearchOrder:=xlByColumns, _\n                                SearchDirection:=xlPrevious, _\n                                MatchCase:=False).Column\n        On Error GoTo 0\n    End Function\n\n    Sub WorksheetLoop()\n\n        ' Add a new summary worksheet\n\n        Dim sh As Worksheet\n        Dim DestSh As Worksheet\n        Dim Last As Long\n        Dim copyra As Range\n        Dim ra As Range\n        With Application\n            .ScreenUpdating = False\n            .EnableEvents = False\n        End With\n\n\n        Set DestSh = ActiveWorkbook.Worksheets.Add\n        DestSh.Name = \"MergeSheet\"\n\n\n\n        For Each sh In ActiveWorkbook.Worksheets\n            If sh.Name &lt;&gt; DestSh.Name Then\n\n                ' Find the last row with data on the summary worksheet.\n                Last = LastRow(DestSh)\n\n\n                'Find address of N in every Worksheet\n                Set ra = sh.Cells.Find(What:=\"N\", LookIn:=xlFormulas, Lookat _\n                                       :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n                                       False, SearchFormat:=False)\n                ' Find the address of the right cell\n                Set copyra = ra.Offset(, 1)\n                'Copy the cell to the MergeSheet\n                copyra.Copy\n\n                With DestSh.Cells(Last + 1, \"B\")\n                    .PasteSpecial xlPasteValues\n                    .PasteSpecial xlPasteFormats\n                    Application.CutCopyMode = False\n                End With\n\n            End If\n        Next\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 5608610, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/65dad4d3a6dfc409707bb54fc67a728b?s=128&d=identicon&r=PG&f=1", "display_name": "glarys", "link": "https://stackoverflow.com/users/5608610/glarys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 49535400, "answer_count": 2, "score": 0, "last_activity_date": 1523879450, "creation_date": 1522240940, "last_edit_date": 1522241617, "question_id": 49534877, "link": "https://stackoverflow.com/questions/49534877/find-cells-and-copy-the-following-cell-to-a-separate-worksheet", "title": "Find cells and copy the following cell to a separate worksheet", "body": "<p>I have an excel Workbook with several worksheets. Each of them contain value \"N\" in different places of the worksheet. I need to copy the value that is to the right from the value \"N\" to a separate worksheet. The copied values should be stored in worksheet as a column.</p>\n\n<p>I assume that I need to loop through each worksheet, find address of \"N\" cell and copy/paste the cell which is to the right:</p>\n\n<pre><code>'Define last row and column\n\nFunction LastRow(sh As Worksheet)\n    On Error Resume Next\n    LastRow = sh.Cells.Find(What:=\"*\", _\n                            After:=sh.Range(\"B1\"), _\n                            LookAt:=xlPart, _\n                            LookIn:=xlFormulas, _\n                            SearchOrder:=xlByRows, _\n                            SearchDirection:=xlPrevious, _\n                            MatchCase:=False).Row\n    On Error GoTo 0\nEnd Function\n\nFunction LastCol(sh As Worksheet)\n    On Error Resume Next\n    LastCol = sh.Cells.Find(What:=\"*\", _\n                            After:=sh.Range(\"B1\"), _\n                            LookAt:=xlPart, _\n                            LookIn:=xlFormulas, _\n                            SearchOrder:=xlByColumns, _\n                            SearchDirection:=xlPrevious, _\n                            MatchCase:=False).Column\n    On Error GoTo 0\nEnd Function\n\nSub WorksheetLoop()\n\n    ' Add a new summary worksheet\n\n    Set DestSh = ActiveWorkbook.Worksheets.Add\n    DestSh.Name = \"MergeSheet\"\n\n    Dim sh As Worksheet\n    Dim DestSh As Worksheet\n    Dim copyra As Range\n    For Each sh In ActiveWorkbook.Worksheets\n        Dim ra As Range\n        'Find address of N in every Worksheet\n        Set ra = sh.Cells.Find(What:=\"N\", LookIn:=xlFormulas, LookAt _\n                               :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n                               False, SearchFormat:=False)\n        ' Find the address of the right cell\n        copyra = ra + 1\n        'Copy the cell to the MergeSheet\n        copyra.Copy\n        With DestSh.Cells(Last + 1, \"B\")\n            .PasteSpecial xlPasteValues\n            .PasteSpecial xlPasteFormats\n            Application.CutCopyMode = False\n        End With\n\n\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>However, when I run this code it returns an error \"Duplicate declaration in current scope\" and it's not clear for me where I have the duplicate declarations.</p>\n"}, {"tags": ["vba", "outlook", "outlook-addin"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1522242742, "post_id": 49534860, "comment_id": 86077435, "body": "You&#39;ll need to show us what you&#39;ve tried first before anyone can help you here... this is a bit too specific of a request for help. Maybe you should hire a programmer?"}, {"owner": {"reputation": 1, "user_id": 9563948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Usnoq.jpg?s=128&g=1", "display_name": "Satish", "link": "https://stackoverflow.com/users/9563948/satish"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1522316941, "post_id": 49534860, "comment_id": 86112954, "body": "have added the coding where i reach right now if you can help in remaining part"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9563948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Usnoq.jpg?s=128&g=1", "display_name": "Satish", "link": "https://stackoverflow.com/users/9563948/satish"}, "edited": false, "score": 0, "creation_date": 1522316948, "post_id": 49541272, "comment_id": 86112959, "body": "have added the coding where i reach right now if you can help in remaining part"}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1522260141, "creation_date": 1522260141, "answer_id": 49541272, "question_id": 49534860, "link": "https://stackoverflow.com/questions/49534860/email-status-tracking/49541272#49541272", "title": "Email Status tracking", "body": "<p>Use <code>Application.ItemSend</code> event to process message just before they are sent. You can display a user form and cancel the message submission (if necessary)</p>\n"}], "owner": {"reputation": 1, "user_id": 9563948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Usnoq.jpg?s=128&g=1", "display_name": "Satish", "link": "https://stackoverflow.com/users/9563948/satish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1592699512, "creation_date": 1522240900, "last_edit_date": 1592699512, "question_id": 49534860, "link": "https://stackoverflow.com/questions/49534860/email-status-tracking", "title": "Email Status tracking", "body": "<p>I am looking for script in vba on MS outlook using which I can track the email response time and other details like type of email, status etc. I have some knowledge of Outlook VBA but not sure if it's possible using below steps:</p>\n\n<ol>\n<li><p>On clicking the send button there should be userform where we have dropdown like type of email and status etc.</p></li>\n<li><p>Send Button on userform which will orignally send email after verifing few condition like attachment, copy email to a person etc</p></li>\n<li><p>Once I click send button on userform it should capture info of this email like sent to, subject, time also if its a reply email received from, received email subject and time and then transfer the info to excel file</p></li>\n</ol>\n\n<p>Step 1 &amp; 2 I am ok with Step 3 where I need help I know this can be done using tracking conversation but not sure how \n(<a href=\"https://msdn.microsoft.com/en-us/library/office/cc765583.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/cc765583.aspx?f=255&amp;MSPPError=-2147217396</a>)</p>\n\n<p>Appreciate any help in completing the development.</p>\n\n<pre><code>this is what i have writen so far \nThisOutllokSession:\n\nPrivate Sub Application_ItemSend(ByVal CurrentEmail As Object, Cancel As Boolean)    \nUserForm1.Show\nCancel = True\nMsgBox UserForm1.ComboBox1.Value &amp; vbNewLine &amp; UserForm1.ComboBox2.Value &amp; vbNewLine &amp; currentemail.to &amp; vbNewLine &amp; currentemail.Subject\nUnload UserForm1\n\\\\\\\\\\\\\\\\\\\\\\\\\\\\need help\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\nhere i want to get the from Email ID, email recieved time, Subject \n\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\nEnd Sub\n\nUserform1 Coding\nPrivate Sub Submit_Click()\nMe.Hide\nEnd Sub\n\nPrivate Sub Cancel_Click()\nUnload Me\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\nMe.ComboBox1.AddItem \"Responce\"\nMe.ComboBox1.AddItem \"Question\"\nMe.ComboBox1.AddItem \"Feedback\"\n\nMe.ComboBox2.AddItem \"Pending\"\nMe.ComboBox2.AddItem \"Complete\"\nMe.ComboBox2.AddItem \"Follow Up\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1522240849, "post_id": 49534649, "comment_id": 86075942, "body": "Can you just go to File -&gt; Options -&gt; Proofing and check &quot;Hide spelling errors in this document only&quot;?"}, {"owner": {"reputation": 11, "user_id": 847090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/372ac214cbd73761a570d5a313047efb?s=128&d=identicon&r=PG", "display_name": "Katto Ishimura", "link": "https://stackoverflow.com/users/847090/katto-ishimura"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1522240951, "post_id": 49534649, "comment_id": 86076044, "body": "I guess I could, but I would like to be able to automize this for multiple documents in a loop."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1522241045, "post_id": 49534649, "comment_id": 86076130, "body": "Then maybe try this: <code>ActiveDocument.ShowGrammaticalErrors = False     ActiveDocument.ShowSpellingErrors = False</code> on each iteration of your documents."}, {"owner": {"reputation": 11, "user_id": 847090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/372ac214cbd73761a570d5a313047efb?s=128&d=identicon&r=PG", "display_name": "Katto Ishimura", "link": "https://stackoverflow.com/users/847090/katto-ishimura"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1522241646, "post_id": 49534649, "comment_id": 86076600, "body": "That worked great, thank you"}], "answers": [{"tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 0, "last_activity_date": 1522527024, "creation_date": 1522527024, "answer_id": 49591948, "question_id": 49534649, "link": "https://stackoverflow.com/questions/49534649/word-vba-ignore-all/49591948#49591948", "title": "Word VBA ignore all", "body": "<p>You can use this on each iteration of the documents:</p>\n\n<pre><code>ActiveDocument.ShowGrammaticalErrors = False \nActiveDocument.ShowSpellingErrors = False\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 847090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/372ac214cbd73761a570d5a313047efb?s=128&d=identicon&r=PG", "display_name": "Katto Ishimura", "link": "https://stackoverflow.com/users/847090/katto-ishimura"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522527024, "creation_date": 1522240343, "last_edit_date": 1522244161, "question_id": 49534649, "link": "https://stackoverflow.com/questions/49534649/word-vba-ignore-all", "title": "Word VBA ignore all", "body": "<p>I would like to scan an entire Word document and ignore all spelling errors.</p>\n\n<p>I found this line but it is specific to a certain string.</p>\n\n<pre><code>ActiveDocument.Styles(\"Test\").NoProofing = True\n</code></pre>\n\n<p>How do I do it for all errors?</p>\n"}, {"tags": ["excel", "vba", "bar-chart"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522242722, "post_id": 49534646, "comment_id": 86077420, "body": "Could you perhaps create a pivotchart and then use a timeline slicer?"}, {"owner": {"reputation": 31, "user_id": 9385580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/703115cd2f7bc7add22a23394ec04caf?s=128&d=identicon&r=PG&f=1", "display_name": "Flo", "link": "https://stackoverflow.com/users/9385580/flo"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522243481, "post_id": 49534646, "comment_id": 86078010, "body": "maybe... but the daily user is on average older than me and could be confused. I want to minimize this possibility by making it as &quot;standard&quot; as they are used to know. In the end it&#39;s all about how much the user likes to use it :( thanks for the idea!"}], "answers": [{"comments": [{"owner": {"reputation": 2665, "user_id": 1685894, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/eTSNC.jpg?s=128&g=1", "display_name": "Aditya", "link": "https://stackoverflow.com/users/1685894/aditya"}, "edited": false, "score": 0, "creation_date": 1522247575, "post_id": 49536688, "comment_id": 86081382, "body": "while your suggestion can be a solution, but to support that as answer you need to post relevant codes as well. Otherwise this is better as comment ..."}, {"owner": {"reputation": 75, "user_id": 9528775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/994cbc7c9384aad07b50d6c825674fb0?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/9528775/james"}, "reply_to_user": {"reputation": 2665, "user_id": 1685894, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/eTSNC.jpg?s=128&g=1", "display_name": "Aditya", "link": "https://stackoverflow.com/users/1685894/aditya"}, "edited": false, "score": 0, "creation_date": 1522247823, "post_id": 49536688, "comment_id": 86081573, "body": "I wanted to post it as a comment but don&#39;t have enough reputation. This is my first post. It sounds like what they want to do is well supported by features already in excel, and no code is necessary. In that case, is an answer without code inappropriate? Thanks!"}, {"owner": {"reputation": 31, "user_id": 9385580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/703115cd2f7bc7add22a23394ec04caf?s=128&d=identicon&r=PG&f=1", "display_name": "Flo", "link": "https://stackoverflow.com/users/9385580/flo"}, "edited": false, "score": 0, "creation_date": 1522312361, "post_id": 49536688, "comment_id": 86109854, "body": "Hi James, thanks for your first answer ever here :) Also thanks for the duration - that&#39;s basically, what we are doing. We&#39;ve also build a process percentage in there - but all of this is off Topic. But thanks for sharing the idea anyway! &lt;3                  Back to the main point: Your picture already shows, that this solution just cuts off the day from the date. What I need is, that it only sets a new tick really every first of each month. (Otherways your not able to see, whether the action should be finished at the end or at the beginning of March.) But thanks for the reply nevertheless!"}], "tags": [], "owner": {"reputation": 75, "user_id": 9528775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/994cbc7c9384aad07b50d6c825674fb0?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/9528775/james"}, "is_accepted": false, "score": 0, "last_activity_date": 1522245885, "creation_date": 1522245885, "answer_id": 49536688, "question_id": 49534646, "link": "https://stackoverflow.com/questions/49534646/bar-chart-with-first-each-month-while-having-different-durations/49536688#49536688", "title": "Bar chart with first each month while having different durations", "body": "<p>I think you can just use a 2D horizontal stacked bar chart. </p>\n\n<p>Set the start of the chart's x-axis as the first day of the earliest month that appears in the project schedule. </p>\n\n<p>Series 1 for each task is the difference between the task start date and the date which starts the chart's x-axis. This allows you to show tasks which don't all start at the same date. Set the bar portion for this series to transparent.</p>\n\n<p>Series 2 for each task is the task duration in days. This portion of each bar should be set to be visible.</p>\n\n<p>Format the X-axis of the chart to Category: Date, Type: Month-Year. This will set each tick to the first day of each month.</p>\n\n<p><a href=\"https://i.stack.imgur.com/rccyT.png\" rel=\"nofollow noreferrer\">Formatted bar chart</a></p>\n"}], "owner": {"reputation": 31, "user_id": 9385580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/703115cd2f7bc7add22a23394ec04caf?s=128&d=identicon&r=PG&f=1", "display_name": "Flo", "link": "https://stackoverflow.com/users/9385580/flo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1522245885, "creation_date": 1522240341, "question_id": 49534646, "link": "https://stackoverflow.com/questions/49534646/bar-chart-with-first-each-month-while-having-different-durations", "title": "Bar chart with first each month while having different durations", "body": "<p>After publishing a too broad question in the first place, I want to ask for a second time \u2013 more problem-focused.\nThe shown bar chart is needed for a broad variety of projects and will be used for 6 month projects as well as for 3 year projects. \nBut it will be forwarded \u2013 so it should look professional.\nFor this reason I want to change the dates on the x-axis to the first of every month. For a fixed period of time, I would be able to do so. But for a broad variety of durations, it\u2019ll have to have some vba code in the background \u2013 and that\u2019s where I\u2019m dipping in the dark. All my testing with start and end date didn\u2019t work out. There\u2019s too much variety in these numbers.</p>\n\n<p>I\u2019ll show the vba of the chart down below. It\u2019s just recorded and has no special tricks inside.</p>\n\n<p>Is there a way, to get there? With calculation between start and end date, I didn\u2019t get a reliable result for first of each month for a random time period.</p>\n\n<p>Thanks for your help! &lt;3</p>\n\n<p><a href=\"https://i.stack.imgur.com/fWVr1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fWVr1.png\" alt=\"Source and bar chart. Note: dates are dd.mm.yy\"></a></p>\n\n<pre><code>Sub testStackoverflow()\nActiveSheet.Shapes.AddChart.Select\nActiveChart.ChartType = xlBarStacked\nActiveChart.SetSourceData Source:=Range(\"testStckoverflow!$A$86:$B$96\")\nActiveChart.Legend.Select\nSelection.Delete\nActiveSheet.ChartObjects(\"Diagramm 3\").Activate\nActiveChart.ChartTitle.Select\nSelection.Delete\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1522240714, "post_id": 49534596, "comment_id": 86075833, "body": "What are the rules so it selects those numbers?  Is it from end of first alpha string to start of next?  Three characters before hyphen and seven after?"}, {"owner": {"reputation": 23, "user_id": 9498103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd70f72c1be9e4d997a2556c485e9853?s=128&d=identicon&r=PG&f=1", "display_name": "Norbulus", "link": "https://stackoverflow.com/users/9498103/norbulus"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1522242212, "post_id": 49534596, "comment_id": 86077017, "body": "Thanks, but managed to solve.                                                                                                                                                         Private Sub UserForm_Initialize()  Me.TextBox1.MaxLength = 24  End Sub  Private Sub TextBox1_Change()     If Len(TextBox1.Text) = TextBox1.MaxLength Then     TextBox1.Value = Mid(TextBox1.Value, 2, 11)          End If  End Sub"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1522242813, "post_id": 49534596, "comment_id": 86077485, "body": "@Norbulus you can post it as an answer (instead of a comment) and after waiting a day you can accept your own answer as solution."}], "owner": {"reputation": 23, "user_id": 9498103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd70f72c1be9e4d997a2556c485e9853?s=128&d=identicon&r=PG&f=1", "display_name": "Norbulus", "link": "https://stackoverflow.com/users/9498103/norbulus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1522242737, "creation_date": 1522240196, "last_edit_date": 1531164843, "question_id": 49534596, "link": "https://stackoverflow.com/questions/49534596/how-to-remove-the-unwanted-barcode-characted-vba", "title": "How to remove the unwanted barcode characted (VBA)", "body": "<p>I ran into an obstacle and would like to ask for your help.</p>\n\n<p>How can I solve it that not to show the all scanned characters in textbox.</p>\n\n<p>Original scanned data </p>\n\n<pre><code>P338-7755885BP0097170824\n</code></pre>\n\n<p>Necessary data (that's what I want to display in textbox)</p>\n\n<pre><code>338-7755885\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/uYjgH.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uYjgH.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["sql", "date", "ms-access", "time", "vba"], "answers": [{"comments": [{"owner": {"reputation": 402, "user_id": 1521171, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/82da6ea566a810493e10a7cba82eb421?s=128&d=identicon&r=PG", "display_name": "Tarun. P", "link": "https://stackoverflow.com/users/1521171/tarun-p"}, "edited": false, "score": 0, "creation_date": 1523024791, "post_id": 49535496, "comment_id": 86402627, "body": "your comment makes sense to me and now i am converting the difference of dates in second and then make a sum of all the seconds, In the last i am converting those seconds in to days, hours:minutes:seconds."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1522242547, "creation_date": 1522242547, "answer_id": 49535496, "question_id": 49534583, "link": "https://stackoverflow.com/questions/49534583/addition-of-days-with-hours-minutes-second-in-vba/49535496#49535496", "title": "Addition of days with hours , minutes , second in vba", "body": "<p>You should always leave the time as a Date, until you're going to format it. Since you didn't, you're getting yourself in a bit of a mess.</p>\n\n<p>We need 2 functions, one to cast a date to the hh:mm:ss format, and one to cast it back to a date.</p>\n\n<pre><code>Public Function DateToHHMMSS(theDate As Date) As String\n    DateToHHMMSS = Int(CSng(theDate * 24)) &amp; \":\" &amp; Format(theDate, \"nn:ss\")\nEnd Function\n\nPublic Function HHMMSSToDate(theString As String) As Date\n    Dim dateArr As Variant\n    dateArr = Split(theString, \":\")\n    If UBound(dateArr) = 2 Then\n        HHMMSSToDate = TimeSerial(dateArr(0), dateArr(1), dateArr(2))\n    End If\nEnd Function\n</code></pre>\n\n<p>With these functions, you can easily add these dates together, for example:</p>\n\n<pre><code>DateToHHMMSS(HHMMSSToDate(\"104:40:00\") + HHMMSSToDate(\"20:21:00\"))\n</code></pre>\n\n<p>And to cast a string to a date, simply use:</p>\n\n<pre><code>DateToHHMMSS(\"104:40:00\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 402, "user_id": 1521171, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/82da6ea566a810493e10a7cba82eb421?s=128&d=identicon&r=PG", "display_name": "Tarun. P", "link": "https://stackoverflow.com/users/1521171/tarun-p"}, "edited": false, "score": 0, "creation_date": 1523024637, "post_id": 49536167, "comment_id": 86402517, "body": "function FormatHourMinute in my case will not going to help me because I would like to get the difference between 2nd &#39;StartDate&#39; with 1st &#39;EndDate&#39; and than sum them all. But still you function is going to work for to caluclate the difference between the two dates."}, {"owner": {"reputation": 402, "user_id": 1521171, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/82da6ea566a810493e10a7cba82eb421?s=128&d=identicon&r=PG", "display_name": "Tarun. P", "link": "https://stackoverflow.com/users/1521171/tarun-p"}, "edited": false, "score": 0, "creation_date": 1523134891, "post_id": 49536167, "comment_id": 86437427, "body": "I am getting an error while running the query on sqlfiddle. something is missing or messed up."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 402, "user_id": 1521171, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/82da6ea566a810493e10a7cba82eb421?s=128&d=identicon&r=PG", "display_name": "Tarun. P", "link": "https://stackoverflow.com/users/1521171/tarun-p"}, "edited": false, "score": 0, "creation_date": 1523171956, "post_id": 49536167, "comment_id": 86443894, "body": "sql fiddle is for mysql only. Use the query designer in Access."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1523029331, "last_edit_date": 1523029331, "creation_date": 1522244535, "answer_id": 49536167, "question_id": 49534583, "link": "https://stackoverflow.com/questions/49534583/addition-of-days-with-hours-minutes-second-in-vba/49536167#49536167", "title": "Addition of days with hours , minutes , second in vba", "body": "<p>Just sum the time difference:</p>\n\n<pre><code>Select Sum([DateEnde] - [DateStart])\nFrom MTTR\n</code></pre>\n\n<p>and then format it using a function like this:</p>\n\n<pre><code>Public Function FormatHourMinute( _\n  ByVal datTime As Date, _\n  Optional ByVal strSeparator As String = \":\") _\n  As String\n\n' Returns count of days, hours and minutes of datTime\n' converted to hours and minutes as a formatted string\n' with an optional choice of time separator.\n'\n' Example:\n'   datTime: #10:03# + #20:01#\n'   returns: 30:04\n'\n' 2005-02-05. Cactus Data ApS, CPH.\n\n  Dim strHour       As String\n  Dim strMinute     As String\n  Dim strHourMinute As String\n\n  strHour = CStr(Fix(datTime) * 24 + Hour(datTime))\n  ' Add leading zero to minute count when needed.\n  strMinute = Right(\"0\" &amp; CStr(Minute(datTime)), 2)\n  strHourMinute = strHour &amp; strSeparator &amp; strMinute\n\n  FormatHourMinute = strHourMinute\n\nEnd Function\n</code></pre>\n\n<p>like this:</p>\n\n<pre><code>Select \n    *,\n    Nz((Select Top 1 T.DateStart \n    From MTTR As T \n    Where T.LFD_NR &gt; MTTR.LFD_NR\n    Order By LFD_NR Desc), [DateEnde]) - DateEnde As TimeDiff\nFrom \n    MTTR\n</code></pre>\n\n<p>Save this as, say, MTTR_Diff.</p>\n\n<p>Then:</p>\n\n<pre><code>Select \n    FormatHourMinute(Sum([TimeDiff))\nFrom \n    MTTR_Diff\n</code></pre>\n"}], "owner": {"reputation": 402, "user_id": 1521171, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/82da6ea566a810493e10a7cba82eb421?s=128&d=identicon&r=PG", "display_name": "Tarun. P", "link": "https://stackoverflow.com/users/1521171/tarun-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 375, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1523029331, "creation_date": 1522240155, "last_edit_date": 1522243901, "question_id": 49534583, "link": "https://stackoverflow.com/questions/49534583/addition-of-days-with-hours-minutes-second-in-vba", "title": "Addition of days with hours , minutes , second in vba", "body": "<p>I have database with Column 'StartDate' as '01/01/2018 10:00' and 'EndDate' as '01/01/2018 11:25'. I have multiple recordset based on certain criteria.</p>\n\n<p>I would like to calculate the difference between 2nd 'StartDate' with 1st 'EndDate' and than sum them all the difference.</p>\n\n<p>I have put the sample database here</p>\n\n<p><a href=\"http://sqlfiddle.com/#!9/2cc5ba\" rel=\"nofollow noreferrer\">http://sqlfiddle.com/#!9/2cc5ba</a></p>\n\n<p>I am thinking that using query it is not possible so i have started doing this using vba.</p>\n\n<p>using the help of function elapsedtime from below link</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/vba/access-vba/articles/calculate-elapsed-time\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/access-vba/articles/calculate-elapsed-time</a></p>\n\n<p>I am able to get the difference as string for first row as 145:30:00 in \"hour:minute:second\"</p>\n\n<p>Problem No:1\nhow can i change this string as date-time format .</p>\n\n<p>I have tried 'Format(CDate(Caclute_time), \"hh:mm:ss\")' but it gives me an eroor Type mismatch.</p>\n\n<p>Problem No:2</p>\n\n<p>How can i add the time \nfor eg. 104:40:00 (hh:mm:ss) + 20:21:00 (hh:mm:ss) which give me results as 125:01:00</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1522239388, "post_id": 49533830, "comment_id": 86074819, "body": "I&#39;m not following your problem. You save the Heading 1 content in StrFlNm, so you have it available and are using it in your code to save the document?"}, {"owner": {"reputation": 11, "user_id": 9563747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a50c21f0b3e0080d8ec8c84e0c5dc6b?s=128&d=identicon&r=PG&f=1", "display_name": "JPG", "link": "https://stackoverflow.com/users/9563747/jpg"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1522239940, "post_id": 49533830, "comment_id": 86075222, "body": "Each document will be saved 1.1.1.rtf 1.1.2.rtf but I don&#39;t need the Heading in the output text itself."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1522242113, "post_id": 49533830, "comment_id": 86076942, "body": "Then your code isn&#39;t clear. Maybe a comment or two in it would help... I think use multiple Ranges: one for the first heading 1 you find. Cycle again to get the next (if any) for a second range. Then use Find on the Range between the two Heading to get each Heading 3? And repeat to the end of the doc. Does that make sense?"}, {"owner": {"reputation": 11, "user_id": 9563747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a50c21f0b3e0080d8ec8c84e0c5dc6b?s=128&d=identicon&r=PG&f=1", "display_name": "JPG", "link": "https://stackoverflow.com/users/9563747/jpg"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1522310090, "post_id": 49533830, "comment_id": 86108570, "body": "Can we change the question to &quot;How to split Word document on style to new documents named as the style, but exclude the style data&quot;"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1522337316, "post_id": 49533830, "comment_id": 86127622, "body": "Sure - anything that&#39;s more accurate is welcome. Could you also expand your sample &quot;document&quot; (if necessary) to show the first Heading level and make the Heading 1 a bit more obvious. We need to be able to recreate your situation - this is going to be time consuming and every effort on your part to reduce that is helpful."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9563747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a50c21f0b3e0080d8ec8c84e0c5dc6b?s=128&d=identicon&r=PG&f=1", "display_name": "JPG", "link": "https://stackoverflow.com/users/9563747/jpg"}, "edited": false, "score": 0, "creation_date": 1522305411, "post_id": 49545479, "comment_id": 86106137, "body": "Thank you for your effort. It gave an error on run             Set DocTgt = Documents.Add(DocSrc.AttachedTemplate)  This was given as the error on debug"}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "reply_to_user": {"reputation": 11, "user_id": 9563747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a50c21f0b3e0080d8ec8c84e0c5dc6b?s=128&d=identicon&r=PG&f=1", "display_name": "JPG", "link": "https://stackoverflow.com/users/9563747/jpg"}, "edited": false, "score": 0, "creation_date": 1522305577, "post_id": 49545479, "comment_id": 86106210, "body": "You could try deleting (DocSrc.AttachedTemplate) or changing it to (DocSrc.AttachedTemplate.FullName)"}, {"owner": {"reputation": 11, "user_id": 9563747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a50c21f0b3e0080d8ec8c84e0c5dc6b?s=128&d=identicon&r=PG&f=1", "display_name": "JPG", "link": "https://stackoverflow.com/users/9563747/jpg"}, "edited": false, "score": 0, "creation_date": 1522310267, "post_id": 49545479, "comment_id": 86108674, "body": "Great! Got it working now. Posted two versions one for docx and rtf. full stop also allowed as legal in filename output"}], "tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1522305705, "last_edit_date": 1522305705, "creation_date": 1522277819, "answer_id": 49545479, "question_id": 49533830, "link": "https://stackoverflow.com/questions/49533830/how-to-split-a-word-document-docx-or-rtf-using-a-heading1-style-as-the-split/49545479#49545479", "title": "How to split a Word document (docx or rtf) using a heading1 style as the split", "body": "<p>Try something based on:</p>\n\n<pre><code>Sub SplitDoc()\nApplication.ScreenUpdating = False\nDim Rng As Range, DocSrc As Document, DocTgt As Document\nDim i As Long, StrTxt As String: Const StrNoChr As String = \"\"\"*./\\:?|\"\nSet DocSrc = ActiveDocument\nWith DocSrc.Range\n  With .Find\n    .ClearFormatting\n    .Replacement.ClearFormatting\n    .Format = True\n    .Forward = True\n    .Text = \"\"\n    .Style = wdStyleHeading1\n    .Replacement.Text = \"\"\n    .Wrap = wdFindStop\n    .Execute\n  End With\n  Do While .Find.Found\n    Set Rng = .Paragraphs(1).Range\n    Set Rng = Rng.GoTo(What:=wdGoToBookmark, Name:=\"\\HeadingLevel\")\n    Set DocTgt = Documents.Add(DocSrc.AttachedTemplate)\n    With DocTgt\n      .Range.FormattedText = Rng.FormattedText\n      StrTxt = Split(.Paragraphs.First.Range.Text, vbCr)(0)\n      ' Strip out illegal characters\n      For i = 1 To Len(StrNoChr)\n        StrTxt = Replace(StrTxt, Mid(StrNoChr, i, 1), \"_\")\n      Next\n      .Paragraphs.First.Range.Delete\n      .SaveAs2 FileName:=DocSrc.Path &amp; \"\\\" &amp; StrTxt &amp; \".docx\", FileFormat:=wdFormatXMLDocument, AddToRecentFiles:=False\n      .Close False\n    End With\n    .Start = Rng.End\n    .Find.Execute\n  Loop\nEnd With\nSet Rng = Nothing: Set DocSrc = Nothing: Set DocTgt = Nothing\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 9563747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a50c21f0b3e0080d8ec8c84e0c5dc6b?s=128&d=identicon&r=PG&f=1", "display_name": "JPG", "link": "https://stackoverflow.com/users/9563747/jpg"}, "edited": false, "score": 0, "creation_date": 1522315576, "post_id": 49550601, "comment_id": 86111947, "body": "These work but how do I make it run &quot;silent&quot;. The fist macro I posted did not open Word and flash, it all worked in the background. I was running all these from the VBA window"}, {"owner": {"reputation": 11, "user_id": 9563747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a50c21f0b3e0080d8ec8c84e0c5dc6b?s=128&d=identicon&r=PG&f=1", "display_name": "JPG", "link": "https://stackoverflow.com/users/9563747/jpg"}, "edited": false, "score": 0, "creation_date": 1522323656, "post_id": 49550601, "comment_id": 86117451, "body": "In fact it was because the window had opened behind the VBA window so I did not see it flashing madly. Is there a way to prevent the window opening?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1522489838, "post_id": 49550601, "comment_id": 86180665, "body": "On StackOverflow you shouldn&#39;t try to make an on-going discussion about your code - this isn&#39;t a &quot;forum&quot; venue. StackOverflow is a Q &amp; A site. A Question should be very specific. If you get an Answer that solves your problem, mark that as &quot;the&quot; Answer. If you then run into a new problem, post a new Question, and again, make the question very specific about the code you have. You might want to read the <a href=\"https://stackoverflow.com/help\">help center</a> about how the site works..."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1522489945, "post_id": 49550601, "comment_id": 86180690, "body": "Also, you should not alter your Question in a way to invalidate the Answer. That doesn&#39;t help the next person who comes along looking for help in a similar situation."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1522489961, "post_id": 49550601, "comment_id": 86180693, "body": "And you should UPVOTE any contributions that help you."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1522490232, "post_id": 49550601, "comment_id": 86180754, "body": "I&#39;ve rolled back the edits that removed the code as that&#39;s important for the question - otherwise it becomes &quot;too broad&quot;."}, {"owner": {"reputation": 11, "user_id": 9563747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a50c21f0b3e0080d8ec8c84e0c5dc6b?s=128&d=identicon&r=PG&f=1", "display_name": "JPG", "link": "https://stackoverflow.com/users/9563747/jpg"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1522529485, "post_id": 49550601, "comment_id": 86192128, "body": "For versions of these macro that don&#39;t flash open windows see these solutions to that issue <a href=\"https://stackoverflow.com/questions/49588295/is-there-a-way-to-run-this-macro-in-word-without-word-opening-other-windows-and\" title=\"is there a way to run this macro in word without word opening other windows and\">stackoverflow.com/questions/49588295/&hellip;</a>"}], "tags": [], "owner": {"reputation": 11, "user_id": 9563747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a50c21f0b3e0080d8ec8c84e0c5dc6b?s=128&d=identicon&r=PG&f=1", "display_name": "JPG", "link": "https://stackoverflow.com/users/9563747/jpg"}, "is_accepted": false, "score": 0, "last_activity_date": 1522316819, "last_edit_date": 1522316819, "creation_date": 1522309497, "answer_id": 49550601, "question_id": 49533830, "link": "https://stackoverflow.com/questions/49533830/how-to-split-a-word-document-docx-or-rtf-using-a-heading1-style-as-the-split/49550601#49550601", "title": "How to split a Word document (docx or rtf) using a heading1 style as the split", "body": "<p>These two sets macro will work. Each one splits a document on Heading1 style into separate documents with the document named as the Heading1 it was split at, and the Heading1 is not included in the new document. That is just perfect.\nHere are the two sets of macro two for output in .rtf and two for docx Also in these macro I removed the . from being an illegal character as I did need the output to be as per the Heading1 exactly. Thanks macropod for taking the time to sort this. I will try to learn more about macros.</p>\n\n<p>Jon.</p>\n\n<pre><code>Sub SplitDocOnHeading1ToRtfWithHeadingInOutput()\n'Splits the document on Heading1 style, into new documents, Heading1 is  included in the data.\n\n\n\nApplication.ScreenUpdating = False\nDim Rng As Range, DocSrc As Document, DocTgt As Document\nDim i As Long, StrTxt As String: Const StrNoChr As String = \"\"\"*/\\:?|\"\nSet DocSrc = ActiveDocument\nWith DocSrc.Range\n  With .Find\n    .ClearFormatting\n    .Replacement.ClearFormatting\n    .Format = True\n    .Forward = True\n    .Text = \"\"\n    .Style = wdStyleHeading1\n    .Replacement.Text = \"\"\n    .Wrap = wdFindStop\n    .Execute\n  End With\n  Do While .Find.Found\n    Set Rng = .Paragraphs(1).Range\n    Set Rng = Rng.GoTo(What:=wdGoToBookmark, Name:=\"\\HeadingLevel\")\n    Set DocTgt = Documents.Add(DocSrc.AttachedTemplate.FullName)\n    With DocTgt\n    Application.ScreenUpdating = False\n      .Range.FormattedText = Rng.FormattedText\n      StrTxt = Split(.Paragraphs.First.Range.Text, vbCr)(0)\n      ' Strip out illegal characters\n      For i = 1 To Len(StrNoChr)\n        StrTxt = Replace(StrTxt, Mid(StrNoChr, i, 1), \"_\")\n      Next\n      '.Paragraphs.First.Range.Delete 'un comment this line if you don't want to retain headings in the output file\n      .SaveAs2 FileName:=DocSrc.Path &amp; \"\\\" &amp; StrTxt &amp; \".rtf\", Fileformat:=wdFormatRTF, AddToRecentFiles:=False\n      .Close False\n    End With\n    .Start = Rng.End\n    .Find.Execute\n  Loop\nEnd With\nSet Rng = Nothing: Set DocSrc = Nothing: Set DocTgt = Nothing\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Sub SplitDocOnHeading1ToRtfNoHeadingInOutput()\n'Splits the document on Heading1 style, into new documents, Heading1 is NOT included in the data\n\n\n\nApplication.ScreenUpdating = False\nDim Rng As Range, DocSrc As Document, DocTgt As Document\nDim i As Long, StrTxt As String: Const StrNoChr As String = \"\"\"*/\\:?|\"\nSet DocSrc = ActiveDocument\nWith DocSrc.Range\n  With .Find\n    .ClearFormatting\n    .Replacement.ClearFormatting\n    .Format = True\n    .Forward = True\n    .Text = \"\"\n    .Style = wdStyleHeading1\n    .Replacement.Text = \"\"\n    .Wrap = wdFindStop\n    .Execute\n  End With\n  Do While .Find.Found\n    Set Rng = .Paragraphs(1).Range\n    Set Rng = Rng.GoTo(What:=wdGoToBookmark, Name:=\"\\HeadingLevel\")\n    Set DocTgt = Documents.Add(DocSrc.AttachedTemplate.FullName)\n    With DocTgt\n    Application.ScreenUpdating = False\n      .Range.FormattedText = Rng.FormattedText\n      StrTxt = Split(.Paragraphs.First.Range.Text, vbCr)(0)\n      ' Strip out illegal characters\n      For i = 1 To Len(StrNoChr)\n        StrTxt = Replace(StrTxt, Mid(StrNoChr, i, 1), \"_\")\n      Next\n      .Paragraphs.First.Range.Delete 'comment out this line if you want to retain headings in the output file\n      .SaveAs2 FileName:=DocSrc.Path &amp; \"\\\" &amp; StrTxt &amp; \".rtf\", Fileformat:=wdFormatRTF, AddToRecentFiles:=False\n      .Close False\n    End With\n    .Start = Rng.End\n    .Find.Execute\n  Loop\nEnd With\nSet Rng = Nothing: Set DocSrc = Nothing: Set DocTgt = Nothing\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>    Sub SplitDocOnHeading1ToDocxWithHeadingInOutput()\n    'Splits the document on Heading1 style, into new documents, Heading1 is  included in the data.\n\n\n\n    Application.ScreenUpdating = False\n    Dim Rng As Range, DocSrc As Document, DocTgt As Document\n    Dim i As Long, StrTxt As String: Const StrNoChr As String = \"\"\"*/\\:?|\"\n    Set DocSrc = ActiveDocument\n    With DocSrc.Range\n      With .Find\n        .ClearFormatting\n        .Replacement.ClearFormatting\n        .Format = True\n        .Forward = True\n        .Text = \"\"\n        .Style = wdStyleHeading1\n        .Replacement.Text = \"\"\n        .Wrap = wdFindStop\n        .Execute\n      End With\n      Do While .Find.Found\n        Set Rng = .Paragraphs(1).Range\n        Set Rng = Rng.GoTo(What:=wdGoToBookmark, Name:=\"\\HeadingLevel\")\n        Set DocTgt = Documents.Add(DocSrc.AttachedTemplate.FullName)\n        With DocTgt\n        Application.ScreenUpdating = False\n          .Range.FormattedText = Rng.FormattedText\n          StrTxt = Split(.Paragraphs.First.Range.Text, vbCr)(0)\n          ' Strip out illegal characters\n          For i = 1 To Len(StrNoChr)\n            StrTxt = Replace(StrTxt, Mid(StrNoChr, i, 1), \"_\")\n          Next\n          '.Paragraphs.First.Range.Delete 'un comment this line if you don't want to retain headings in the output file\n          .SaveAs2 FileName:=DocSrc.Path &amp; \"\\\" &amp; StrTxt &amp; \".docx\", Fileformat:=wdFormatXMLDocument, AddToRecentFiles:=False\n          .Close False\n        End With\n        .Start = Rng.End\n        .Find.Execute\n      Loop\n    End With\n    Set Rng = Nothing: Set DocSrc = Nothing: Set DocTgt = Nothing\n    Application.ScreenUpdating = True\n    End Sub\n\n\nSub SplitDocOnHeading1ToDocxNoHeadingInOutput()\n        'Splits the document on Heading1 style, into new documents, Heading1 is NOT included in the data\n\n\n\n        Application.ScreenUpdating = False\n        Dim Rng As Range, DocSrc As Document, DocTgt As Document\n        Dim i As Long, StrTxt As String: Const StrNoChr As String = \"\"\"*/\\:?|\"\n        Set DocSrc = ActiveDocument\n        With DocSrc.Range\n          With .Find\n            .ClearFormatting\n            .Replacement.ClearFormatting\n            .Format = True\n            .Forward = True\n            .Text = \"\"\n            .Style = wdStyleHeading1\n            .Replacement.Text = \"\"\n            .Wrap = wdFindStop\n            .Execute\n          End With\n          Do While .Find.Found\n            Set Rng = .Paragraphs(1).Range\n            Set Rng = Rng.GoTo(What:=wdGoToBookmark, Name:=\"\\HeadingLevel\")\n            Set DocTgt = Documents.Add(DocSrc.AttachedTemplate.FullName)\n            With DocTgt\n            Application.ScreenUpdating = False\n              .Range.FormattedText = Rng.FormattedText\n              StrTxt = Split(.Paragraphs.First.Range.Text, vbCr)(0)\n              ' Strip out illegal characters\n              For i = 1 To Len(StrNoChr)\n                StrTxt = Replace(StrTxt, Mid(StrNoChr, i, 1), \"_\")\n              Next\n              .Paragraphs.First.Range.Delete 'comment out this line if you want to retain headings in the output file\n              .SaveAs2 FileName:=DocSrc.Path &amp; \"\\\" &amp; StrTxt &amp; \".docx\", Fileformat:=wdFormatXMLDocument, AddToRecentFiles:=False\n              .Close False\n            End With\n            .Start = Rng.End\n            .Find.Execute\n          Loop\n        End With\n        Set Rng = Nothing: Set DocSrc = Nothing: Set DocTgt = Nothing\n        Application.ScreenUpdating = True\n        End Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9563747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a50c21f0b3e0080d8ec8c84e0c5dc6b?s=128&d=identicon&r=PG&f=1", "display_name": "JPG", "link": "https://stackoverflow.com/users/9563747/jpg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 595, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1522490186, "creation_date": 1522237992, "last_edit_date": 1522490186, "question_id": 49533830, "link": "https://stackoverflow.com/questions/49533830/how-to-split-a-word-document-docx-or-rtf-using-a-heading1-style-as-the-split", "title": "How to split a Word document (docx or rtf) using a heading1 style as the split", "body": "<p>I have a large file I have split into many separate rtf files with this slightly modified code I got online. The problem was I didn't want to include the Heading 1 text in the output file. However the Heading 1 data is used to create the filename of each output document.</p>\n\n<p>This is the format of the file I am splitting to new files.</p>\n\n<p>1.1.1 This would be marked Heading1 style</p>\n\n<p>some text in here some text in here some text in here some text in here</p>\n\n<p>1.1.2 This would be marked Heading1 style</p>\n\n<p>some text in here some text in here some text in here some text in here</p>\n\n<p>1.1.3 This would be marked Heading1 style</p>\n\n<p>some text in here some text in here some text in here some text in here</p>\n\n<p>=============================================================================== So what it outputs are files named 1.1.1.rtf, 1.1.2.rtf etc and would just contain the body text, but no heading.</p>\n\n<p>repeats to end</p>\n\n<p>Any guidance will be appreciated.</p>\n\n<pre><code>Sub aSplitOnHeadings()\n'\n' SplitOnHeadings Macro\n'\n'\nApplication.ScreenUpdating = False\nDim StrTmplt As String, StrPath As String, StrFlNm As String, Rng As Range, Doc As Document, i As Long, extension As String\nextension = \".rtf\" ' Jon added so we can have 1.1.1 for the references\nWith ActiveDocument\n  StrTmplt = .AttachedTemplate.FullName\n  StrPath = .Path &amp; \"\\\"\n  With .Range\n    With .Find\n      .ClearFormatting\n      .Replacement.ClearFormatting\n      .Text = \"\"\n      .Style = \"Heading 1\"\n      .Replacement.Text = \"\"\n      .Forward = True\n      .Wrap = wdFindStop\n      .Format = True\n      .MatchCase = False\n      .MatchWholeWord = False\n      .MatchWildcards = False\n      .MatchSoundsLike = False\n      .MatchAllWordForms = False\n      .Execute\n    End With\n\n\n        Do While .Find.Found\n\n          Set Rng = .Paragraphs(1).Range.Duplicate\n\n\n                With Rng\n                  StrFlNm = Replace(.Text, vbCr, \"\")\n\n                  For i = 1 To 255 'I took out the chr 46 the full stop because it is legal 44 comma\n                    Select Case i\n                      Case 1 To 31, 33, 34, 37, 42, 47, 58 - 63, 91 - 93, 96, 124, 147, 148\n                      StrFlNm = Replace(StrFlNm, Chr(i), \"\")\n                    End Select\n                  Next\n\n                        Do\n\n                        If .Paragraphs.Last.Range.End = ActiveDocument.Range.End Then Exit Do\n\n                          Select Case .Paragraphs.Last.Next.Style\n\n                            Case \"Heading 1\"\n                            Selection.EndKey Unit:=wdLine\n                              Exit Do\n                            Case Else\n                              .MoveEnd wdParagraph, 1\n                            End Select\n                        Loop\n\n                End With\n\n          Set Doc = Documents.Add(Template:=StrTmplt, Visible:=False)\n          With Doc\n            .Range.FormattedText = Rng.FormattedText\n            .SaveAs2 FileName:=StrPath &amp; StrFlNm &amp; extension, Fileformat:=wdFormatRTF, AddToRecentFiles:=False\n            .Close False\n          End With\n          .Collapse wdCollapseEnd\n          .Find.Execute\n        Loop\n  End With\nEnd With\nSet Doc = Nothing: Set Rng = Nothing\nApplication.ScreenUpdating = True\n'.SaveAs2 FileName:=StrPath &amp; StrFlNm, FileFormat:=wdFormatRTF, AddToRecentFiles:=False\n'.SaveAs2 FileName:=StrPath &amp; StrFlNm, Fileformat:=wdFormatXMLDocument, AddToRecentFiles:=False\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-2016", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1522237500, "post_id": 49533596, "comment_id": 86073441, "body": "<code>GetSaveAsFilename</code> only returns a path &amp; filename it does not save. You will need to use something like <code>ThisWorkbook.SaveAs</code>"}, {"owner": {"reputation": 26, "user_id": 9563727, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9Xklm3ZDbPc/AAAAAAAAAAI/AAAAAAAAABA/JL-Yf6rzacI/photo.jpg?sz=128", "display_name": "Simo Todorov", "link": "https://stackoverflow.com/users/9563727/simo-todorov"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1522237637, "post_id": 49533596, "comment_id": 86073544, "body": "I wanted to leave the option for the person to choose a directory before saving, so the actual clicking of &quot;Save&quot; is manual. Also, I just tried ThisWorkbook.SaveAs and it still did not want to save the file."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1522237774, "post_id": 49533596, "comment_id": 86073637, "body": "You can. Just see my answer below."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 1, "creation_date": 1522239092, "post_id": 49533596, "comment_id": 86074626, "body": "You&#39;ve written <code>Dim IntialName</code>, but tried to use <code>InitialName</code> - that extra <code>i</code> makes a difference.  You may want to add <code>Option Explicit</code> to the top of the Module (turn on &quot;Require Variable Declaration&quot; in Tools &gt; Options to do this automatically in future)"}], "answers": [{"comments": [{"owner": {"reputation": 26, "user_id": 9563727, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9Xklm3ZDbPc/AAAAAAAAAAI/AAAAAAAAABA/JL-Yf6rzacI/photo.jpg?sz=128", "display_name": "Simo Todorov", "link": "https://stackoverflow.com/users/9563727/simo-todorov"}, "edited": false, "score": 0, "creation_date": 1522238437, "post_id": 49533747, "comment_id": 86074128, "body": "Ok, so i added     ActiveWorkbook.SaveAs Filename:=fileSaveName but now it give me an error 1004 what am i doing wrong? I placed this command after the filesavename line and before the If statement for the msgbox"}, {"owner": {"reputation": 26, "user_id": 9563727, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9Xklm3ZDbPc/AAAAAAAAAAI/AAAAAAAAABA/JL-Yf6rzacI/photo.jpg?sz=128", "display_name": "Simo Todorov", "link": "https://stackoverflow.com/users/9563727/simo-todorov"}, "edited": false, "score": 0, "creation_date": 1522239362, "post_id": 49533747, "comment_id": 86074801, "body": "Runtime error 1004 this extension can not be used with the selected file type. Change the file extension in the file name text box or select a different file type by changing the Save as type."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 26, "user_id": 9563727, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9Xklm3ZDbPc/AAAAAAAAAAI/AAAAAAAAABA/JL-Yf6rzacI/photo.jpg?sz=128", "display_name": "Simo Todorov", "link": "https://stackoverflow.com/users/9563727/simo-todorov"}, "edited": false, "score": 0, "creation_date": 1522239473, "post_id": 49533747, "comment_id": 86074887, "body": "you need to specify the fileformat, see my edit (I didn&#39;t see it was a macro enabled file)"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1522239564, "post_id": 49533747, "comment_id": 86074951, "body": "Running the code I also get Error 1004 at the <code>Range(&quot;A1&quot;).Select</code> lines - this seems to be because <code>Range</code> is not qualified.  <code>ActiveSheet.Range(&quot;A1&quot;).Select</code> will work, but it would be better to store your created workbook in a <code>Workbook</code> object, and avoid using <code>ActiveSheet</code> or <code>Select</code> wherever possible"}, {"owner": {"reputation": 26, "user_id": 9563727, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9Xklm3ZDbPc/AAAAAAAAAAI/AAAAAAAAABA/JL-Yf6rzacI/photo.jpg?sz=128", "display_name": "Simo Todorov", "link": "https://stackoverflow.com/users/9563727/simo-todorov"}, "edited": false, "score": 0, "creation_date": 1522239584, "post_id": 49533747, "comment_id": 86074975, "body": "Yes! Thank you very much. It worked. The msgBox still appears but the file saves fine. Ill just remove that last part i guess. Much appreciated."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 1, "creation_date": 1522239894, "post_id": 49533747, "comment_id": 86075197, "body": "<code>fileSavename</code> contains the location you are saving the file, e.g. <code>&quot;C:\\Book.xlsm&quot;</code> - this will evaluate to <code>True</code>, i.e. <code>Not False</code>.  You <i>might</i> be able to use <code>If Not ActiveWorkbook.Saved Then</code> to see if the file thinks it&#39;s saved?"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1522239458, "last_edit_date": 1522239458, "creation_date": 1522237743, "answer_id": 49533747, "question_id": 49533596, "link": "https://stackoverflow.com/questions/49533596/cannot-save-file-in-excel-after-using-filesavename-in-vba/49533747#49533747", "title": "Cannot save file in Excel after using filesavename in VBA", "body": "<p><code>GetSaveAsFilename</code> does not save a file.<br>\nIt only does what the function name says: Get a SaveAs filename from the dialog box.</p>\n\n<p>So your variable <code>fileSaveName</code> just contains a file path and file name that was chosen in the dialog box, and you still need to save the file yourself.</p>\n\n<p>Fore example to save the current workbook (that workbook code is running at) with the chosen filename:</p>\n\n<pre><code>ThisWorkbook.SaveAs Filename:=fileSaveName \n</code></pre>\n\n<p>or for the active workbook (that workbook that is on top):</p>\n\n<pre><code>ActiveWorkbook.SaveAs Filename:=fileSaveName\n</code></pre>\n\n<p>For macro enabled files define a file format according to <a href=\"https://msdn.microsoft.com/de-de/vba/excel-vba/articles/xlfileformat-enumeration-excel\" rel=\"nofollow noreferrer\">XlFileFormat-Enumeration</a>:</p>\n\n<pre><code>ActiveWorkbook.SaveAs Filename:=fileSaveName, FileFormat:=xlOpenXMLWorkbookMacroEnabled\n</code></pre>\n"}], "owner": {"reputation": 26, "user_id": 9563727, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9Xklm3ZDbPc/AAAAAAAAAAI/AAAAAAAAABA/JL-Yf6rzacI/photo.jpg?sz=128", "display_name": "Simo Todorov", "link": "https://stackoverflow.com/users/9563727/simo-todorov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2153, "favorite_count": 0, "accepted_answer_id": 49533747, "answer_count": 1, "score": 0, "last_activity_date": 1522239458, "creation_date": 1522237330, "last_edit_date": 1531161705, "question_id": 49533596, "link": "https://stackoverflow.com/questions/49533596/cannot-save-file-in-excel-after-using-filesavename-in-vba", "title": "Cannot save file in Excel after using filesavename in VBA", "body": "<p>So i have this VBA at work, that I made a while ago. It used to work perfectly, but as of today it will not save my file after it opens the Save as window. It just goes to the MsgBox ive given it.</p>\n\n<p>At first the problem was that LDate = Date somehow started returning the date with a forward slash. Ive fixed this by adding a format for LDate. But the bigger problem remains. No matter what i do, what code i remove or add, what name i write manually, the file wont save in any folder i give it.</p>\n\n<pre><code>Sub Export()\n'\n' Export Macro\n'\n    ' copy range from work workbook, create a new workbook and paste selection\n    Sheets(\"NewTemplate\").Range(\"A1:M29\").Copy\n    Workbooks.Add\n    Range(\"A1\").Select\n    Selection.PasteSpecial Paste:=xlPasteColumnWidths, Operation:=xlNone, _\n        SkipBlanks:=False, Transpose:=False\n    ActiveSheet.Paste\n\n    ' rename active sheet and active workbook\n    ActiveSheet.Name = \"Create\"\n    ActiveWorkbook.Windows(1).Caption = \"Newly Generated Table\"\n    Range(\"A1\").Select\n     Application.CutCopyMode = False\n\n    ' open Save As window, set file save name to custom prefix + date\n    Dim IntialName As String\n    Dim fileSaveName As Variant\n    InitialName = \"Import_Feature_Values_\"\n    Dim LDate As String\n    LDate = Date\n    LDate = Format(Now, \"dd_mm_yyyy\")\n    fileSaveName = Application.GetSaveAsFilename(FileFilter:= _\n                                                 \"Microsoft Excel Macro- Enabled Worksheet (*.xlsm), *.xlsm\", InitialFileName:=InitialName &amp; LDate)\n\n    'error box if filesavename fails\n    If fileSaveName &lt;&gt; False Then\n    MsgBox \"Failed to Save as \" &amp; fileSaveName\n    End If\n'\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word", "word-table"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1522235511, "post_id": 49532952, "comment_id": 86072123, "body": "Can you show what the value of <code>RevisionDate</code> is please?"}, {"owner": {"reputation": 3, "user_id": 9563263, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "7schlaefer", "link": "https://stackoverflow.com/users/9563263/7schlaefer"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1522236049, "post_id": 49532952, "comment_id": 86072449, "body": "In the code above it works because i get it from the running text, so <code>RevisionDate</code> is &quot;28.03.18&quot;.  When using the bookmark on the cell, <code>Selection</code> is &quot;28.03.18 []&quot; and when it reaches <code>RevisionDate = CDate(temp)</code> it gives an error without storing anything"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9563263, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "7schlaefer", "link": "https://stackoverflow.com/users/9563263/7schlaefer"}, "edited": false, "score": 0, "creation_date": 1522237933, "post_id": 49533383, "comment_id": 86073761, "body": "Still getting the error... This is just changing the format of the date, right? Because it works fine when the bookmark is on &quot;28.03.18&quot; (<code>runningText</code>) outside of the table."}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": -1, "last_activity_date": 1522237025, "last_edit_date": 1522237025, "creation_date": 1522236719, "answer_id": 49533383, "question_id": 49532952, "link": "https://stackoverflow.com/questions/49532952/reading-date-from-table-in-word-without-additional-characters/49533383#49533383", "title": "Reading date from table in Word without additional characters", "body": "<p>You could try something along these lines</p>\n\n<pre><code>Sub test()\n\nDim d As Date\n\nd = CDate(Replace(ThisDocument.GoTo(wdGoToBookmark, , , \"TEST_BM\").Text, \".\", \"/\"))\n\nDebug.Print d\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1522238228, "creation_date": 1522238228, "answer_id": 49533912, "question_id": 49532952, "link": "https://stackoverflow.com/questions/49532952/reading-date-from-table-in-word-without-additional-characters/49533912#49533912", "title": "Reading date from table in Word without additional characters", "body": "<p>Your guess about the table cell is correct, but you can work around that by trimming off the extraneous character(s). End-of-cell is a Chr(13) + Chr(7) (Word paragraph plus cell structure marker).</p>\n\n<p>There are various ways to code this, but I have the following function at-hand:</p>\n\n<pre><code>'Your code, relevant lines, slightly altered:\n  Selection.GoTo what:=wdGoToBookmark, Name:=\"runningText\"\n\n  temp = TrimCellText(Selection.Text)\n\n  RevisionDate = CDate(temp)\n  Debug.Print (RevisionDate)\n\n'Function to return string without end-of-cell characters\nFunction TrimCellText(s As String) As String\n    Do While Len(s) &gt; 0 And (Right(s, 1) = Chr(13) Or Right(s, 1) = Chr(7))\n        s = Left(s, Len(s) - 1)\n    Loop\n    TrimCellText = s\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1522276685, "creation_date": 1522276685, "answer_id": 49545283, "question_id": 49532952, "link": "https://stackoverflow.com/questions/49532952/reading-date-from-table-in-word-without-additional-characters/49545283#49545283", "title": "Reading date from table in Word without additional characters", "body": "<p>If the date is the only content in the cell you could use:</p>\n\n<pre><code>Dim Dt As Date\nDt = CDate(Replace(Split(ActiveDocument.Bookmarks(\"runningText\").Range.Text, vbCr)(0), \".\", \"/\"))\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9563263, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "7schlaefer", "link": "https://stackoverflow.com/users/9563263/7schlaefer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 49533912, "answer_count": 3, "score": 0, "last_activity_date": 1544110999, "creation_date": 1522235390, "last_edit_date": 1544110999, "question_id": 49532952, "link": "https://stackoverflow.com/questions/49532952/reading-date-from-table-in-word-without-additional-characters", "title": "Reading date from table in Word without additional characters", "body": "<p>so I started with VBA yesterday and keep running into walls. In the long run, I'm trying to create a Word template that checks if it's still up to date or if it's time for revision. </p>\n\n<p>Right now I want to store a date from the document in a variable. I couldn't find a method to directly read out something in date format so now I'm using Selection.Text and CDate but that gives me an error (incompatible types) because my selection seems to contain another character or marker ([]). I'm guessing it has something to do with the fact that the bookmark is on a cell of a table within my Word document because it works fine in the running text.</p>\n\n<p>I'm doing this in a table because this way I can be sure where the date in question is in the document and because I'm not sure how to reset the bookmark after the date has been changed.</p>\n\n<p>I tried to limit the selection to the date by using \nSelection.SetRange Start:=0, End:=8 (and a few variations) but that selects only a space and the ominous marker (or another cell entirely).</p>\n\n<p>I have also looked into Ranges but as far as I can tell it doesn't solve my problem and I can't really use them yet, so for now I'm sticking to selection.</p>\n\n<p>This is my code:</p>\n\n<pre><code>Sub ChangeNextRev()\n\nDim nextRevision As Date\nDim RevisionDate As Date\nDim temp As String\n\n'Selection.GoTo what:=wdGoToBookmark, Name:=\"lastRevision\"\n'Selection.SetRange Start:=0, End:=8\n\n'Selection.GoTo what:=wdGoToBookmark, Name:=\"lastRevision\"\nSelection.GoTo what:=wdGoToBookmark, Name:=\"runningText\"\n\ntemp = Selection.Text\n\nRevisionDate = CDate(temp)\nDebug.Print (RevisionDate)\n\nnextRevision = RevisionDate + 14\n\nWith Selection\n\n.GoTo what:=wdGoToBookmark, Name:=\"nextRevision\"\n.TypeText Text:=Format$(nextRevision, \"DD.MM.YY\")\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Can someone point me in the right direction? How can I only select the date I need? Is there an easier way besides a table to control where the date is entered or to find it afterwards?\nAny help on where I'm going wrong would be greatly appreciated :)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 2, "creation_date": 1522234941, "post_id": 49532778, "comment_id": 86071723, "body": "That wont work.  As the range will be an array, you need to use <code>worksheetfunction.countif</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1522236944, "post_id": 49532778, "comment_id": 86073064, "body": "I&#39;m unclear on how you would deal with empty cell which register as both ISNUMBER and equal to <code>&quot;&quot;</code>."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1522256724, "post_id": 49532778, "comment_id": 86087922, "body": "@ADRSAL  did you get to test any of the answers you got ? any feedback ?"}, {"owner": {"reputation": 33, "user_id": 9455311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f0f6ab0adbaadfb31b50d871c3042a7?s=128&d=identicon&r=PG&f=1", "display_name": "ADRSAL", "link": "https://stackoverflow.com/users/9455311/adrsal"}, "edited": false, "score": 0, "creation_date": 1522304519, "post_id": 49532778, "comment_id": 86105695, "body": "Yes I did. basically the main function of column G is like a data validation. If the answer of E-F=0, then it&#39;s correct, if not 0, then the msg comes up. what I&#39;ve noticed is that every time I input a value in column E, a mismatch error comes up. is there a way to go about this?"}], "answers": [{"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1522235755, "post_id": 49532878, "comment_id": 86072279, "body": "Maybe add a check first that there are non-zero values to save looping?"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 1, "creation_date": 1522235861, "post_id": 49532878, "comment_id": 86072344, "body": "Also, might be worth dynamically getting the last used row rather than a static range"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1522239159, "post_id": 49532878, "comment_id": 86074663, "body": "@SJR - yup, it will be faster."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1522239181, "post_id": 49532878, "comment_id": 86074677, "body": "@Zac - it depends from the intentions of the OP, but it is a good idea."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 2, "last_activity_date": 1522235673, "last_edit_date": 1522235673, "creation_date": 1522235139, "answer_id": 49532878, "question_id": 49532778, "link": "https://stackoverflow.com/questions/49532778/msgbox-for-a-range-of-cells/49532878#49532878", "title": "MsgBox for a range of cells", "body": "<p>Try like this:</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n\n    Dim myCell As Range\n\n    For Each myCell In Range(\"G20:G100\")\n        If myCell &lt;&gt; 0 Then\n            MsgBox myCell.Address &amp; \" is not equal to 0\", vbOKOnly\n            Exit Sub\n        End If\n    Next myCell        \nEnd Sub\n</code></pre>\n\n<p>It checks every cell in the range. For the first cell it finds with a different value than 0, it gives a <code>MsgBox</code> with its address and it exits.</p>\n\n<p>You can make the <code>MsgBox</code> a bit more informative, showing the current value of the cell like this:</p>\n\n<pre><code>MsgBox myCell.Address &amp; \" is \" &amp; myCell.Text, vbOKOnly\n</code></pre>\n\n<p>If you remove the <code>Exit Sub</code> it will show different <code>MsgBox</code>-es for each cell that is different than <code>0</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 2, "last_activity_date": 1522242306, "last_edit_date": 1522242306, "creation_date": 1522236888, "answer_id": 49533450, "question_id": 49532778, "link": "https://stackoverflow.com/questions/49532778/msgbox-for-a-range-of-cells/49533450#49533450", "title": "MsgBox for a range of cells", "body": "<p>The code below is a little longer, but you will get the result in 1 summary <code>MsgBox</code> with a list of all cells in the <code>Range(\"G20:G\" &amp;LastRow)</code> which are <code>&lt;&gt;0</code>.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n\n    Dim myCell As Range, LastRow As Long\n    Dim MsgString As String\n\n    LastRow = Cells(Rows.Count, \"G\").End(xlUp).Row ' get last row with data in Column G\n    ' making sure there is at least 1 cell with data in it below \"G20\"\n    If LastRow &lt; 20 Then\n        MsgBox \"Your range from G20 and below is empty\", vbCritical\n        Exit Sub\n    End If\n\n    For Each myCell In Range(\"G20:G\" &amp; LastRow)\n        If myCell.Value &lt;&gt; 0 Then\n            If MsgString &lt;&gt; \"\" Then  ' not first cell which is &lt;&gt; 0\n                MsgString = MsgString &amp; vbCr &amp; myCell.Address\n            Else\n                MsgString = myCell.Address\n            End If\n        End If\n    Next myCell\n\n    MsgBox \"The following cells are not equal to 0 :\" &amp; vbCr &amp; MsgString, vbOKOnly\n\nEnd Sub\n</code></pre>\n\n<p><strong>Note</strong>: cell which are <code>Empty</code> do not enter the criteria of <code>&lt;&gt;0</code>, so if you want also to find empty cells as well, the code will need some slight modifications.</p>\n"}], "owner": {"reputation": 33, "user_id": 9455311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f0f6ab0adbaadfb31b50d871c3042a7?s=128&d=identicon&r=PG&f=1", "display_name": "ADRSAL", "link": "https://stackoverflow.com/users/9455311/adrsal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5801, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1522242306, "creation_date": 1522234832, "last_edit_date": 1522235334, "question_id": 49532778, "link": "https://stackoverflow.com/questions/49532778/msgbox-for-a-range-of-cells", "title": "MsgBox for a range of cells", "body": "<p>I'm trying to create a code that displays a MsgBox if contents in cells of column G are not equal to 0. Code works with just one cell but not with the full range (G20:G100). \ncan you please help.\nthanks</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n\nIf Sheets(\"Sheet1\").Range(\"G20:G100\").Value &lt;&gt; 0 Then\n    MsgBox \"Not equal to 0\", vbOKOnly\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1522235123, "post_id": 49532695, "comment_id": 86071844, "body": "Using .Select is the main issue here. You should avoid using select when possible"}, {"owner": {"reputation": 658, "user_id": 2843172, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0c8ae2f7e942c1deea7da8b4a6a8e254?s=128&d=identicon&r=PG&f=1", "display_name": "Clouse24", "link": "https://stackoverflow.com/users/2843172/clouse24"}, "edited": false, "score": 0, "creation_date": 1522235144, "post_id": 49532695, "comment_id": 86071859, "body": "I would recommend not applying the auto filter. Even when using excel without running any VBA autofilters slow performance as it&#39;s reapplying the filter every time any thing happens"}, {"owner": {"reputation": 3, "user_id": 9563515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e0d7edf88575ec7b51b587f66421645?s=128&d=identicon&r=PG&f=1", "display_name": "Djuna Tree", "link": "https://stackoverflow.com/users/9563515/djuna-tree"}, "reply_to_user": {"reputation": 658, "user_id": 2843172, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0c8ae2f7e942c1deea7da8b4a6a8e254?s=128&d=identicon&r=PG&f=1", "display_name": "Clouse24", "link": "https://stackoverflow.com/users/2843172/clouse24"}, "edited": false, "score": 0, "creation_date": 1522237042, "post_id": 49532695, "comment_id": 86073126, "body": "@Clouse24 I agree, but do you have a suggestion for deleting those entries where column A contains a zero?"}, {"owner": {"reputation": 658, "user_id": 2843172, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0c8ae2f7e942c1deea7da8b4a6a8e254?s=128&d=identicon&r=PG&f=1", "display_name": "Clouse24", "link": "https://stackoverflow.com/users/2843172/clouse24"}, "edited": false, "score": 0, "creation_date": 1522237487, "post_id": 49532695, "comment_id": 86073429, "body": "I personally would iterate over the range using a for loop. An example could be similar to this: <a href=\"http://excelerator.solutions/vba-starter-kit/vba-starter-kit-section-5-code-examples/\" rel=\"nofollow noreferrer\">excelerator.solutions/vba-starter-kit/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1522236361, "post_id": 49532946, "comment_id": 86072677, "body": "<a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>"}], "tags": [], "owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "is_accepted": true, "score": 0, "last_activity_date": 1522235378, "creation_date": 1522235378, "answer_id": 49532946, "question_id": 49532695, "link": "https://stackoverflow.com/questions/49532695/beginner-vba-for-excel-how-can-i-speed-up-my-code/49532946#49532946", "title": "Beginner VBA for Excel: how can I speed up my code?", "body": "<p>One short answer would be to stop using Select and ActiveCell when you can: </p>\n\n<p>Example</p>\n\n<pre><code>Range(\"A1:G1\").Select\n            Selection.Delete Shift:=xlUp\n        Dim LastRow As Long\n            LastRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n                Range(\"A1:G\" &amp; LastRow).Select\n                Selection.Copy\n</code></pre>\n\n<p>Could become</p>\n\n<pre><code>Range(\"A1:G1\").Delete Shift:=xlUp\n        Dim LastRow As Long\n            LastRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n                Range(\"A1:G\" &amp; LastRow).Copy\n</code></pre>\n\n<p>If you apply this to your whole code, it should get far faster already </p>\n\n<p>For some other examples on how to avoid copy paste for example you can check Ozgrid:\n<a href=\"http://www.ozgrid.com/VBA/SpeedingUpVBACode.htm\" rel=\"nofollow noreferrer\">http://www.ozgrid.com/VBA/SpeedingUpVBACode.htm</a></p>\n"}], "owner": {"reputation": 3, "user_id": 9563515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e0d7edf88575ec7b51b587f66421645?s=128&d=identicon&r=PG&f=1", "display_name": "Djuna Tree", "link": "https://stackoverflow.com/users/9563515/djuna-tree"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "closed_date": 1522235468, "accepted_answer_id": 49532946, "answer_count": 1, "score": 0, "last_activity_date": 1522235378, "creation_date": 1522234599, "last_edit_date": 1531164843, "question_id": 49532695, "link": "https://stackoverflow.com/questions/49532695/beginner-vba-for-excel-how-can-i-speed-up-my-code", "closed_reason": "Duplicate", "title": "Beginner VBA for Excel: how can I speed up my code?", "body": "<p>I've been working on the following VBA code for Excel. It updates a \"DATA\" sheet of about 12,800 records with fresh information pasted into the sheet \"Update2\", while retaining any records which an update is not available for. This is for a university department, so its intended use is to be run once or twice a year as a records update.</p>\n\n<p>This currently is taking 2m10s to run, and I'd appreciate any guidance. I've tried a few things (as you can see) but I'm reaching the end of my ability. Thanks.</p>\n\n<pre><code>Application.Calculation = xlCalculationManual\n    Application.ScreenUpdating = False\n        Application.StatusBar = \"Please wait. Updating records.\"\n    Sheets(\"Update2\").Select\n        'The lines below delete the the rows where regnum is zero and the header row.\n        On Error Resume Next\n        Rows(\"1:1\").Select\n            Selection.AutoFilter\n                ActiveSheet.Range(\"$A$1:$G$12231\").AutoFilter Field:=1, Criteria1:=\"0\"\n            Dim LastZero As Long\n                LastZero = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n                    Range(\"A2:G\" &amp; LastZero).Select\n                    Selection.EntireRow.Delete\n            ActiveSheet.Range(\"$A$1:$G$12152\").AutoFilter Field:=1\n        If Err Then\n            'do nothing. This ignores a case where there are no rows where regnum is zero.\n        End If\n        Range(\"A1:G1\").Select\n            Selection.Delete Shift:=xlUp\n        Dim LastRow As Long\n            LastRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n                Range(\"A1:G\" &amp; LastRow).Select\n                Selection.Copy\n            Sheets(\"DATA\").Select\n                Range(\"A2:G2\").Select\n                Selection.Insert Shift:=xlDown\n        Columns(\"A:J\").Select\n            ActiveSheet.Range(\"A:J\").RemoveDuplicates Columns:=1, Header:=xlYes\n            'This removes duplicate regnums.\n            'Unfortunately, this breaks all the formulae. Solutions welcome.\n            'What follows is a trudging rewrite of each formula.\n        Range(\"H2\").Select\n            ActiveCell = \"=INDEX($M$2:$M$10, MATCH((LEFT($F2,1)),$L$2:$L$10,0))\"\n        Range(\"I2\").Select\n            ActiveCell = [redacted]\n            'An INDEX-MATCH referring to another spreadsheet in the same folder.\n            Range(\"J2\").Select\n            ActiveCell = \"=INDEX(S:S, MATCH($C2,R:R,0))\"\n        Dim LastData As Long\n            LastData = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n                Range(\"H2:J2\").Copy Range(\"H2:J\" &amp; LastData)\n        Application.ScreenUpdating = True\n        Application.Calculation = xlCalculationAutomatic\n            Application.StatusBar = \"Update complete.\"\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 4, "creation_date": 1522233964, "post_id": 49532282, "comment_id": 86071041, "body": "add code to the question."}], "answers": [{"tags": [], "owner": {"reputation": 92, "user_id": 8289199, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tHt2Q.jpg?s=128&g=1", "display_name": "Prakash", "link": "https://stackoverflow.com/users/8289199/prakash"}, "is_accepted": false, "score": 0, "last_activity_date": 1522234259, "creation_date": 1522234259, "answer_id": 49532559, "question_id": 49532282, "link": "https://stackoverflow.com/questions/49532282/copy-a-single-column-from-an-excel-file-to-a-text-file/49532559#49532559", "title": "Copy a single column from an excel file to a text file", "body": "<p>In Your Code You Use </p>\n\n<pre><code> For P=1 to Lastcolumn\n wsData=ActiveSheet.Cells(1,P).value\n Next\n</code></pre>\n\n<p>I Think This Is your Problem. You Split All the cell Values and then Write it into the txt file . You just wonna try to mention that Particular row count and you will get Solution.</p>\n"}], "owner": {"reputation": 1, "user_id": 9563463, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156657738583888/picture?type=large", "display_name": "Dave Houghton", "link": "https://stackoverflow.com/users/9563463/dave-houghton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522235217, "creation_date": 1522233423, "last_edit_date": 1522235217, "question_id": 49532282, "link": "https://stackoverflow.com/questions/49532282/copy-a-single-column-from-an-excel-file-to-a-text-file", "title": "Copy a single column from an excel file to a text file", "body": "<p>I am using the attached <a href=\"https://i.stack.imgur.com/9abgf.png\" rel=\"nofollow noreferrer\">Code Here</a> and at the moment the code that I have copies all the columns to the txt file.</p>\n\n<p>I have 2 columns and the column \"B\" needs to be copied to txt file. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1522233063, "post_id": 49532125, "comment_id": 86070342, "body": "&quot;Does not work&quot; is unhelpful but my guess is that instead of &quot;$G$24:$H$54&quot; you need to check the intersect of Target and this range. As you have in the next line as it happens!"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1522233301, "post_id": 49532125, "comment_id": 86070533, "body": "It&#39;s also hard to work out the logic of what you&#39;re doing in the second Case block. What happens if they change H30?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1522233373, "post_id": 49532125, "comment_id": 86070589, "body": "also <code>EnableEvents = True</code> and <code>ScreenUpdating = True</code> must be AFTER <code>End Select</code> otherwise they are part of case 2 and stay <code>False</code> in case 1"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9563362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/770c7b4ae2b431a0f4587572efaf42e8?s=128&d=identicon&r=PG&f=1", "display_name": "klove112", "link": "https://stackoverflow.com/users/9563362/klove112"}, "edited": false, "score": 1, "creation_date": 1522282549, "post_id": 49532290, "comment_id": 86099680, "body": "Thank you very much! This works perfectly. I am new to VBA so these forums really help me understand it more. Again, thank you!"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1522233445, "creation_date": 1522233445, "answer_id": 49532290, "question_id": 49532125, "link": "https://stackoverflow.com/questions/49532125/combining-select-case-as-cell-and-range-in-worksheet-change/49532290#49532290", "title": "Combining Select Case as Cell and Range in Worksheet_Change", "body": "<p>This is a possible solution:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n\n    Select Case True\n\n    Case Not Intersect(Target, Range(\"G6\")) Is Nothing\n        If InStr(1, Range(\"G6\"), \"PUMP\") &gt; 0 Then\n            MsgBox (\"Pump\")\n        ElseIf InStr(1, Range(\"G6\"), \"SKID\") &gt; 0 Then\n            MsgBox (\"Skid\")\n        End If\n\n    Case Not Intersect(Target, Range(\"G24:H54\")) Is Nothing\n        If InStr(1, Range(\"G24\"), \"Calculate\") &gt; 0 _\n                    And InStr(1, Range(\"G25\"), \"Outside Shelter\") &gt; 0 Then\n            Cells(19, 8).Value = Sheets(\"1\").Cells(159, 6).Value\n            Cells(20, 9).Value = Sheets(\"1\").Cells(163, 6).Value\n            Cells(19, 11).Value = Sheets(\"1\").Cells(160, 6).Value\n            Cells(20, 10).Value = Sheets(\"1\").Cells(164, 6).Value\n        ElseIf InStr(1, Range(\"G24\"), \"Calculate\") &gt; 0 _\n                    And InStr(1, Range(\"G25\"), \"Inside Shelter\") &gt; 0 Then\n            Cells(19, 8).Value = Sheets(\"1\").Cells(182, 6).Value\n            Cells(20, 9).Value = Sheets(\"1\").Cells(187, 6).Value\n            Cells(19, 11).Value = Sheets(\"1\").Cells(183, 6).Value\n            Cells(20, 10).Value = Sheets(\"1\").Cells(188, 6).Value\n        End If\n\n    End Select\n\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>The idea is use <code>Select Case True</code>, which selects the <code>Not Intersect(Range1, Range2) Is Nothing</code>. And in general, it is better to work with the <code>Range(\"G6\")</code> and compare it with <code>Target</code> than with <code>$G$6</code> and compare it with <code>Target.Address</code>.</p>\n"}], "owner": {"reputation": 13, "user_id": 9563362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/770c7b4ae2b431a0f4587572efaf42e8?s=128&d=identicon&r=PG&f=1", "display_name": "klove112", "link": "https://stackoverflow.com/users/9563362/klove112"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1089, "favorite_count": 1, "accepted_answer_id": 49532290, "answer_count": 1, "score": 1, "last_activity_date": 1522239854, "creation_date": 1522232950, "last_edit_date": 1531164843, "question_id": 49532125, "link": "https://stackoverflow.com/questions/49532125/combining-select-case-as-cell-and-range-in-worksheet-change", "title": "Combining Select Case as Cell and Range in Worksheet_Change", "body": "<p>I have a current worksheet that needs to have values from another worksheet when values from a certain range are changed. \nAlso, I need to watch a certain cell value to execute another action, for this case, show a Msgbox. </p>\n\n<p>I am using<code>Worksheet_Change(ByVal Target As Range)</code> event but the whole code does not work when I specify <code>Select Case \"$G$6\"</code> and <code>Case \"$G$24:$H$54\"</code> and tried <code>Case Else</code> but did not work. </p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n\n    Select Case Target.Address\n\n        Case \"$G$6\"\n            If InStr(1, Range(\"G6\"), \"PUMP\") &gt; 0 Then\n                MsgBox (\"Pump\")\n            ElseIf InStr(1, Range(\"G6\"), \"SKID\") &gt; 0 Then\n                MsgBox (\"Skid\")\n            End If\n\n        Case \"$G$24:$H$54\"\n        If Not Application.Intersect(Target, Range(\"G24:H54\")) Is Nothing Then\n            If InStr(1, Range(\"G24\"), \"Calculate\") &gt; 0 And InStr(1, Range(\"G25\"), \"Outside Shelter\") &gt; 0 Then\n                Cells(19, 8).Value = Sheets(\"1\").Cells(159, 6).Value\n                Cells(20, 9).Value = Sheets(\"1\").Cells(163, 6).Value\n                Cells(19, 11).Value = Sheets(\"1\").Cells(160, 6).Value\n                Cells(20, 10).Value = Sheets(\"1\").Cells(164, 6).Value\n            ElseIf InStr(1, Range(\"G24\"), \"Calculate\") &gt; 0 And InStr(1, Range(\"G25\"), \"Inside Shelter\") &gt; 0 Then\n                Cells(19, 8).Value = Sheets(\"1\").Cells(182, 6).Value\n                Cells(20, 9).Value = Sheets(\"1\").Cells(187, 6).Value\n                Cells(19, 11).Value = Sheets(\"1\").Cells(183, 6).Value\n                Cells(20, 10).Value = Sheets(\"1\").Cells(188, 6).Value\n            End If\n        End If\n\n        Application.EnableEvents = True\n        Application.ScreenUpdating = True\n\n    End Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1522233689, "post_id": 49531985, "comment_id": 86070822, "body": "Hi Vitata, thank you for the reply.. I included the &quot;with&quot; statement but it&#39;s still only applying to the sheet that I execute the macro on.."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1522233823, "post_id": 49531985, "comment_id": 86070922, "body": "@EitelDagnin - are you sure? Can you save the excel file, exit, open it and try again? Have you see the <code>.</code>  before the <code>Range</code> in the code? There are 2 of them and they are quite important."}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1522234472, "post_id": 49531985, "comment_id": 86071404, "body": "Sorry I deleted my last comment because I didn&#39;t see you updated the post... I do apologize, I didn&#39;t notice the dots in the code above, I simply added the &quot;with&quot; statement. I put the dots there and it works perfectly but when it gets to the 4th sheet, I get the Error Message: &quot;Unable to get the Match property of the WoeksheetFunction class&quot;. In my last comment below to SJR, this is the SAME sheet that SJR&#39;s code seems to &quot;skip&quot;. Any suggestions?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 1, "creation_date": 1522234721, "post_id": 49531985, "comment_id": 86071580, "body": "@EitelDagnin - it skips the worksheet, because the <code>count</code> returns an error, as far as the &quot;STATUS&quot; is not found in it. Probably it is written <code>&quot;STATUS &quot;</code> with a space after or before or anything."}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1522239384, "post_id": 49531985, "comment_id": 86074816, "body": "I checked what possible spaces in the word and there were extra spaces.. I removed the spaces and it still didn&#39;t apply the filter correctly. I then searched for all blank rows and removed them and then it worked 100%."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1522239466, "post_id": 49531985, "comment_id": 86074884, "body": "@EitelDagnin - congrats! Now you have a working code :)"}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 1, "creation_date": 1522239692, "post_id": 49531985, "comment_id": 86075053, "body": "Thank you for the help Vityata :)"}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1522241049, "post_id": 49531985, "comment_id": 86076136, "body": "Vityata, can you perhaps assist with the second part of the question regarding the Instr?"}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1522244802, "post_id": 49531985, "comment_id": 86079016, "body": "I made the changes and I am getting an error in the Match line - Type Mismatch"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1522245066, "post_id": 49531985, "comment_id": 86079265, "body": "@EitelDagnin - it is probably something small, but it would be probably a better idea to ask a new question, so more people can take a look at it. Make sure to include input, expected output and exact error."}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1522245234, "post_id": 49531985, "comment_id": 86079412, "body": "I will do so - Thank you Vityata for your help :)"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 4, "last_activity_date": 1522241489, "last_edit_date": 1522241489, "creation_date": 1522232544, "answer_id": 49531985, "question_id": 49531902, "link": "https://stackoverflow.com/questions/49531902/vba-loop-through-multiple-worksheets-and-apply-filter/49531985#49531985", "title": "VBA - Loop Through Multiple Worksheets and Apply Filter", "body": "<p>You are referring always to the <code>ActiveSheet</code>, whenever you do not specify the worksheet explicitly in your code. Thus, in the <code>Range()</code> you have to refer to the worksheet like this:</p>\n\n<p>From:</p>\n\n<pre><code>Set rngData = Range(\"A1\").CurrentRegion\ncount = Application.WorksheetFunction.Match(\"STATUS\", Range(\"A1:AZ1\"), 0)\n</code></pre>\n\n<p>Change to:</p>\n\n<pre><code>With Worksheets(I)\n    Set rngData = .Range(\"A1\").CurrentRegion\n    count = Application.WorksheetFunction.Match(\"STATUS\", .Range(\"A1:AZ1\"), 0)\nEnd With\n</code></pre>\n\n<p>The dots in the code between <code>With Worksheets(I) - End With</code> are what makes the difference:</p>\n\n<p><a href=\"https://i.stack.imgur.com/mMf9U.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mMf9U.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>Concerning the <code>Application.WorksheetFunction.Match</code>, it only matches cells which contain <strong>exactly</strong> the word \"STATUS\". If there is something else like a space before or a sign after, then something like this is a good idea:</p>\n\n<pre><code>count = Application.Match(\"*STATUS*\", Worksheets(1).Range(\"A1:AZ1\"), 0)\n</code></pre>\n\n<p>Then a check is still needed. Like this:</p>\n\n<pre><code>If Not IsError(count) Then\n    rngData.autofilter Field:=count, Criteria1:=\"INACTIVE\"\nEnd If\n</code></pre>\n\n<hr>\n\n<p>Concerning the second part of the question, use <code>*</code> around the value in the Match function:</p>\n\n<pre><code>Public Sub TestMe()    \n    Range(\"E1\") = \"5teSt34\"\n    Debug.Print Application.WorksheetFunction.Match(\"*Test*\", Range(\"A1:H1\"), 0)    \nEnd Sub\n</code></pre>\n\n<p>Will always return <code>5</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1522233544, "post_id": 49532054, "comment_id": 86070717, "body": "Hi SJR, thank you it seems to be half working... The first 3 worksheets the filter is applied and then I get the Error Message: &quot;Unable to get the Match property of the WoeksheetFunction class&quot;. Currently there are 10 worksheets, but sometimes there might be less and sometimes there can be more.."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1522233616, "post_id": 49532054, "comment_id": 86070773, "body": "I&#39;ve made a change above, can you try again please."}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1522234117, "post_id": 49532054, "comment_id": 86071147, "body": "It is working fantastically! :) There&#39;s just ONE worksheet that it&#39;s not applying to. I have triple checked and the header is spelled correctly and the column does contact the correct search criteria. Other than that, the solution works great! Any suggestions for the one sheet?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1522234410, "post_id": 49532054, "comment_id": 86071359, "body": "Do you mean it doesn&#39;t apply the filter? Step through the code and check the value of <code>count</code>."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1522235426, "post_id": 49532054, "comment_id": 86072062, "body": "By the way did you add the wildcards into your match line? <code>&quot;*STATUS*&quot;</code>."}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1522239321, "post_id": 49532054, "comment_id": 86074774, "body": "Sorry, no it didn&#39;t apply the filter and no I did not add the wildcards in the match line.. I did add them and it applied the filter but it didn&#39;t apply it correctly - i.e, it still showed other results. I checked what Vityata mentioned above about possible spaces in the word and there were extra spaces.. I removed the spaces and it still didn&#39;t apply the filter correctly. I then searched for all blank rows and removed them and then it worked 100%. I don&#39;t know why, but only this one sheet is giving issues. Will need to account for these issues I suppose."}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1522239703, "post_id": 49532054, "comment_id": 86075059, "body": "Thank you for the help SJR :)"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1522239852, "post_id": 49532054, "comment_id": 86075166, "body": "My pleasure. Perhaps you have some hidden characters. If you have spaces in the &quot;INACTIVE&quot; also you need to use wildcards for the filter as well as the match."}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1522240021, "post_id": 49532054, "comment_id": 86075303, "body": "So if I understand correctly, wildcards account for variations of the text, as in lower case, upper case, more characters or less characters etc?"}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1522241062, "post_id": 49532054, "comment_id": 86076146, "body": "SJR, can you perhaps assist with the second part of the question regarding the Instr?"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 2, "last_activity_date": 1522233575, "last_edit_date": 1522233575, "creation_date": 1522232731, "answer_id": 49532054, "question_id": 49531902, "link": "https://stackoverflow.com/questions/49531902/vba-loop-through-multiple-worksheets-and-apply-filter/49532054#49532054", "title": "VBA - Loop Through Multiple Worksheets and Apply Filter", "body": "<p>Basically what you need to do is reference the sheet in your code as you loop through, which you are not doing - you are only referring to the active sheet by not including any references.</p>\n\n<p>With Match you can use wildcards.</p>\n\n<pre><code>Sub WorksheetLoop()\n\nDim WS_Count As Long\nDim I As Long\n\nWS_Count = ActiveWorkbook.Worksheets.count\n\nDim count As Variant, rngData As Range\nFor I = 1 To WS_Count\n   Set rngData = Worksheets(I).Range(\"A1\").CurrentRegion\n   count = Application.Match(\"STATUS\", Worksheets(I).Range(\"A1:AZ1\"), 0)\n   If IsNumeric(count) Then rngData.AutoFilter Field:=count, Criteria1:=\"INACTIVE\"\nNext I\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1618, "favorite_count": 0, "accepted_answer_id": 49531985, "answer_count": 2, "score": 3, "last_activity_date": 1525768766, "creation_date": 1522232315, "last_edit_date": 1525768766, "question_id": 49531902, "link": "https://stackoverflow.com/questions/49531902/vba-loop-through-multiple-worksheets-and-apply-filter", "title": "VBA - Loop Through Multiple Worksheets and Apply Filter", "body": "<p>I need to apply the same filter to all the worksheets in the same workbook.</p>\n\n<p>All the sheets have headers in the first row, but the header name that the filter is supposed to be applied to is not always in the same column, i.e, worksheet one the header in question is in column H, in worksheet 2 it's in column A, in worksheet 3 it's in column L and so on... </p>\n\n<p>Also, some of the headers will not be an exact match for the criteria - i.e, some will have \"STATUS\" as the header, some will be \"<em>prefix</em>_Status\", others \"CurrentStatus\" and so on.. So I need to use the <code>Instr</code> funciton (Unless there's some better option) but I cannot seem to figure out where or how to use it..</p>\n\n<p>Here is the code I have so far:</p>\n\n<pre><code>Sub WorksheetLoop()\n\n         Dim WS_Count As Integer\n         Dim I As Integer\n\n         ' Set WS_Count equal to the number of worksheets in the active\n         ' workbook.\n         WS_Count = ActiveWorkbook.Worksheets.count\n\n         ' Begin the loop.\n         For I = 1 To WS_Count\n\n            Dim count As Integer, rngData As Range\n            Set rngData = Range(\"A1\").CurrentRegion\n\n            count = Application.WorksheetFunction.Match(\"STATUS\", Range(\"A1:AZ1\"), 0)\n\n            rngData.autofilter Field:=count, Criteria1:=\"INACTIVE\"\n\n         Next I\n\nEnd Sub\n</code></pre>\n\n<p>This code applies the filter to only ONE sheet.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 3, "creation_date": 1522231678, "post_id": 49531647, "comment_id": 86069327, "body": "Why not pivot table or power query?"}, {"owner": {"reputation": 9, "user_id": 9562998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01274a5111d4405a738027c11b7e033?s=128&d=identicon&r=PG&f=1", "display_name": "S&#248;ren", "link": "https://stackoverflow.com/users/9562998/s%c3%b8ren"}, "edited": false, "score": 0, "creation_date": 1522231883, "post_id": 49531647, "comment_id": 86069496, "body": "The data is already in a pivot table and the job can be done manually by using the sorting function. What I&#39;m looking for is a way to automatically produce a list that can be printed separately and handed to someone who can then order the parts."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522232664, "post_id": 49531647, "comment_id": 86070079, "body": "why not have the pivottable already sorted and how you want it to look then target the part of the pivottable containing the data you want for export? Using this great article <a href=\"https://peltiertech.com/referencing-pivot-table-ranges-in-vba/\" rel=\"nofollow noreferrer\">peltiertech.com/referencing-pivot-table-ranges-in-vba</a>"}], "answers": [{"tags": [], "owner": {"reputation": 9, "user_id": 9562998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01274a5111d4405a738027c11b7e033?s=128&d=identicon&r=PG&f=1", "display_name": "S&#248;ren", "link": "https://stackoverflow.com/users/9562998/s%c3%b8ren"}, "is_accepted": true, "score": 0, "last_activity_date": 1610530202, "last_edit_date": 1610530202, "creation_date": 1523015861, "answer_id": 49692336, "question_id": 49531647, "link": "https://stackoverflow.com/questions/49531647/counting-occurrence-of-unique-rows-and-produce-summary-in-table/49692336#49692336", "title": "Counting occurrence of unique rows and produce summary in table", "body": "<p>I solved the problem myself. If anyone happens to read this and want an answer, the heart of the code looks like this (directly copied from my code based on another case, it will thus not run on its own):</p>\n<pre><code>Dim i As Long\nDim nr_rows As Long\n\nSheets(&quot;Ark1&quot;).Cells(1, 1).Select\nSheets(&quot;Ark1&quot;).UsedRange.Clear\n\n'Counts number of occurances based on two criteria: the connection type and model number\n\nWith ActiveSheet\nnr_rows = Cells(Rows.Count, 1).End(xlUp).Row\n\nFor i = 1 To nr_rows 'Cells(i, 7) indicates destination column\n      Cells(i, 7).Formula = &quot;=SUM(COUNTIFS(B1:B200,B1:B200,F1:F200,F1:F200))&quot;\nNext i\n\nEnd With\n\n'Removes duplicates based on all columns\nApplication.Calculation = xlCalculationManual\n\nActiveCell.Range(&quot;A1:G200&quot;).Select\nActiveSheet.Range(&quot;$A$1:$G$200&quot;).RemoveDuplicates Columns:=Array(1, 2, 3, 4, 5, 6, 7), Header:=xlNo\n\n'Sorts the range alphabetically based on Column E, the manufacturer\nRange(&quot;A1:G50&quot;).Sort Key1:=Range(&quot;E:E&quot;)\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 9562998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01274a5111d4405a738027c11b7e033?s=128&d=identicon&r=PG&f=1", "display_name": "S&#248;ren", "link": "https://stackoverflow.com/users/9562998/s%c3%b8ren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "closed_date": 1523113655, "accepted_answer_id": 49692336, "answer_count": 1, "score": -3, "last_activity_date": 1610530202, "creation_date": 1522231526, "last_edit_date": 1522239960, "question_id": 49531647, "link": "https://stackoverflow.com/questions/49531647/counting-occurrence-of-unique-rows-and-produce-summary-in-table", "closed_reason": "Needs details or clarity", "title": "Counting occurrence of unique rows and produce summary in table", "body": "<p>I am attempting to produce a macro in VBA and Excel that will be able to count unique occurrences of rows, open a new Excel sheet and paste a summary order list containing the number of occurrences. </p>\n\n<p>I'm fairly new to VBA and I'm still reading up on it using Excel VBA for Dummies. Thus, any help on how to get started is much appreciated. I've read other posts and experimented with SUM and COUNT.IF to some degree of success.</p>\n\n<p>Basically, I am dealing with order lists of process equipment and instruments such as valves, pressure gages etc. The list is filled in and several duplicates of the same item with a unique part number will occur in one big mess of information. Due to this, it is, thus, diffucult to count the number of unique items to be ordered and mistakes can easily happen. The goal can be summed up as follows:</p>\n\n<ul>\n<li>Count number of occurances of rows (a unique part) <em>based on a unique tag number</em> (se example image)</li>\n<li>Produce a summary table that can be printed separately (preferably in a new sheet) containing one row with each unique item (could be the first occurance of that unique row from the top) and the corresponding number of occurances in the entire range.</li>\n</ul>\n\n<p>As an example, I've prepared an order list for fruits for different supermarket chains as seen in the image link below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/dNxYh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dNxYh.png\" alt=\"enter image description here\"></a></p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 1, "creation_date": 1522229715, "post_id": 49530914, "comment_id": 86067830, "body": "As you have answered your own question and you seem happy with it.. it might be worth accepting your own answer, just to close the query"}, {"owner": {"reputation": 243, "user_id": 4791411, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Dy9Mf.png?s=128&g=1", "display_name": "Calaom", "link": "https://stackoverflow.com/users/4791411/calaom"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1522230025, "post_id": 49530914, "comment_id": 86068063, "body": "@Zac Even when using the Q&amp;A style told by the website, I cannot accept the answer before two days it seems..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1522230382, "post_id": 49530914, "comment_id": 86068307, "body": "I think it&#39;s either 24 or 48 hours before you can accept your own solution as an answer but it&#39;s worth revisiting the thread."}, {"owner": {"reputation": 243, "user_id": 4791411, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Dy9Mf.png?s=128&g=1", "display_name": "Calaom", "link": "https://stackoverflow.com/users/4791411/calaom"}, "edited": false, "score": 0, "creation_date": 1522230588, "post_id": 49530914, "comment_id": 86068480, "body": "@Jeeped It is so that if someone wants to add something on the thread?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1522230918, "post_id": 49530914, "comment_id": 86068742, "body": "Yeah, I suppose. I see the rule as stopping anyone from self-answering and gaining immediate brownie points."}], "tags": [], "owner": {"reputation": 243, "user_id": 4791411, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Dy9Mf.png?s=128&g=1", "display_name": "Calaom", "link": "https://stackoverflow.com/users/4791411/calaom"}, "is_accepted": true, "score": 2, "last_activity_date": 1522231236, "last_edit_date": 1522231236, "creation_date": 1522229494, "answer_id": 49530914, "question_id": 49530913, "link": "https://stackoverflow.com/questions/49530913/vba-not-using-my-windows-region-settings/49530914#49530914", "title": "VBA not using my windows region settings", "body": "<p>Nevermind, I found the answer while writing the question.</p>\n\n<p>The problem came from the fact I wasn't using the Local in my saveAs, and also the fact I was saving again just after that (which bypass the Local in saveAs).</p>\n\n<p>So the final code is simply adds <code>Local:=True</code> to the <code>SaveAs</code>:</p>\n\n<pre><code>ActiveWorkbook.SaveAs Filename:= _\nActiveWorkbook.path+\"\\\"+Left(ActiveWorkbook.Name, Len(ActiveWorkbook.Name) - 4)+\".csv\", _  \nFileFormat:=xlCSVMSDOS, CreateBackup:=False, Local:=True\n</code></pre>\n"}], "owner": {"reputation": 243, "user_id": 4791411, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Dy9Mf.png?s=128&g=1", "display_name": "Calaom", "link": "https://stackoverflow.com/users/4791411/calaom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 49530914, "answer_count": 1, "score": 0, "last_activity_date": 1522231236, "creation_date": 1522229494, "question_id": 49530913, "link": "https://stackoverflow.com/questions/49530913/vba-not-using-my-windows-region-settings", "title": "VBA not using my windows region settings", "body": "<p>I am trying to automate some actions I have to do under excel.\nAfter using the recording option (even if I have some knowledge in VBA), the Macro is the next:</p>\n\n<pre><code>Sub MacroPOI()\n\n    Selection.SpecialCells(xlCellTypeBlanks).Select\n    Selection.EntireRow.Delete\n    Rows(\"1:4\").Select\n    Selection.Delete Shift:=xlUp\n    Columns(\"A:A\").Select\n    Selection.TextToColumns Destination:=Range(\"A1\"), DataType:=xlDelimited, _\n        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _\n        Semicolon:=False, Comma:=True, Space:=False, Other:=False, FieldInfo _\n        :=Array(Array(1, 2), Array(2, 1), Array(3, 1)), TrailingMinusNumbers:=True\n    ActiveWorkbook.SaveAs Filename:= _\n        ActiveWorkbook.path + \"\\\" + Left(ActiveWorkbook.Name, Len(ActiveWorkbook.Name) - 4) + \".csv\", _\n        FileFormat:=xlCSVMSDOS, CreateBackup:=False\n    ActiveWorkbook.Save\n    ActiveWindow.Close\nEnd Sub\n</code></pre>\n\n<p>The problem is that when I do it myself (while recording), the result file uses <strong>semicolon</strong> as separator (My region setting is set to France) but not when I execute the VBA code where I get <strong>comma</strong> as separator.</p>\n\n<p>I was hoping for semicolon...</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1522228135, "post_id": 49530170, "comment_id": 86066575, "body": "Noone wants you to share a workbook (especially with vba code inside). However, you may share a bit more of the code. In general, write <code>End</code> after the <code>Unload UserForm</code> line and see whether it has &quot;fixed&quot; the bugs."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1522228391, "post_id": 49530170, "comment_id": 86066793, "body": "@Vityata There isn&#39;t really any other code to it is the issue. Tried adding <code>End</code> after <code>Unload</code> still same issue"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6632933"}, "edited": false, "score": 0, "creation_date": 1522228766, "post_id": 49530170, "comment_id": 86067057, "body": "Can you try debugging it? see if which part it executes on certain actions?"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1522228775, "post_id": 49530170, "comment_id": 86067063, "body": "Firstly, I agree with @Vityata. But more importantly, I&#39;m struggling to understand the issue (which is where a snippet of your code might help). Are you saying that while your form is open you update <code>Activesheet</code> but when you unload the form, you are unable to interact with your sheet? Also not sure what you meant by: <b><code>although visually has changed for all other purposes it is still set to the previous one</code></b>?"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1522229093, "post_id": 49530170, "comment_id": 86067312, "body": "@ramedju Have updated with the load and unload procedures. Have debugged it many times - It all executes correctly."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1522229185, "post_id": 49530170, "comment_id": 86067385, "body": "@Zac whilst the userform is open I change the <code>Activesheet</code> to another one. When I unload the userform the correct sheet is displayed but any action that I do to that sheet it is like I&#39;m doing it on the previous sheet. If I try to unprotect it the previous sheet gets unprotected and not the active one. I also can&#39;t scroll on the sheet and any <code>cell.Locked</code> settings are taken from the previous sheet as well"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1522229545, "post_id": 49530170, "comment_id": 86067698, "body": "I assume that you are performing some form of copy from your <code>Previous sheet</code> to your <code>Activesheet</code>? if that&#39;s the case, we need to see the code unfortunately. It would be very difficult (if not almost impossible) to figure out what&#39;s going on without knowing what the code is doing. I suspect it&#39;s some action in your code that might be the root cause"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 1, "creation_date": 1522229600, "post_id": 49530170, "comment_id": 86067746, "body": "@Tom Yes, I have experience the same. I will post a code that will replicate it although I have not found the solution yet too. Let me just check if I can replicate it this time using Excel 2016"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1522229709, "post_id": 49530170, "comment_id": 86067827, "body": "@Zac There&#39;s no copy. There is a sql connection which populates the sheet."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1522229735, "post_id": 49530170, "comment_id": 86067853, "body": "@L42 Brilliant thank you - so do you know what causes it then?"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1522230101, "post_id": 49530170, "comment_id": 86068113, "body": "@Tom Actually, not yet, I am trying to replicate it using minimal code, but can&#39;t seem to do it. But basically, <code>Unload</code> statement is executed after retrieving data from a database and dumped in the Excel sheet activated. The sheet is activated but you cannot scroll. You cannot edit it as well not until you select another sheet and then go back to it."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1522230286, "post_id": 49530170, "comment_id": 86068243, "body": "@Tom Btw, if you load the <code>Userform</code> modeless (e.g. <code>Userform1.Show vbModeless</code> ), issue seems to disappears and activates the sheet just fine."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1522230326, "post_id": 49530170, "comment_id": 86068273, "body": "Only thing that comes to mind after looking at the code you&#39;ve provided, have you tried disconnecting from DB before you Unload the form?"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1522230392, "post_id": 49530170, "comment_id": 86068315, "body": "@L42 I&#39;ve tried loading the Userform <code>vbModeless</code> and it throws an error on a line where I set the <code>ActiveConnection</code>. Interestingly though. I&#39;ve got two copies of the tool with different connection methods. In the other one (Where the connection method is done in a module) It works fine. The one with an issue the connection method is written as a Class. But other then that the code is pretty much the same"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1522230525, "post_id": 49530170, "comment_id": 86068427, "body": "@Zac it is disconnected before I unload"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1522230835, "post_id": 49530170, "comment_id": 86068681, "body": "@Tom I will get back once I can re-create this. I can&#39;t atm (it seems I have to connect to a database, do the dump and update of sheet), but I confirm that this happens to me too."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1522230940, "post_id": 49530170, "comment_id": 86068755, "body": "@L42 Great thank you - I&#39;m glad it&#39;s not just me. Any idea of when you will be able to post your version of it? I&#39;m going to remove my code as I don&#39;t think it adds anything to the question. Hopefully we will be able to find a solution for this."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1522231038, "post_id": 49530170, "comment_id": 86068841, "body": "@Tom Don&#39;t remove it. A little clue is better than no clue at all. As for when I will post, as soon as I can replicated it consistently."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1522231239, "post_id": 49530170, "comment_id": 86068996, "body": "@L42 ok have rolled back."}], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1522231124, "creation_date": 1522227452, "last_edit_date": 1531161705, "question_id": 49530170, "link": "https://stackoverflow.com/questions/49530170/excel-not-handling-unload-of-userform-correctly", "title": "Excel not handling unload of Userform correctly", "body": "<p>I unfortunately can't share the workbook that this is happening in due to security reasons. But I was wondering if anyone had experienced the following and if so how they had fixed it. </p>\n\n<p>I'm having an issue where I unload one of the userforms in my workbook using </p>\n\n<pre><code>Unload UserForm\n</code></pre>\n\n<p>Whilst this userform is open it also changes the <code>Activesheet</code>. After the code has finished running it seems that the <code>Activesheet</code> although visually has changed for all other purposes it is still set to the previous one. </p>\n\n<p>I am then unable to scroll (unless I double click into a cell first) and the whole sheet tells me it is locked (until I somehow trigger the Change procedure or manually toggle between another sheet and back). </p>\n\n<p>I've also tried to <code>Unprotect</code> the sheet but in doing so the Ribbon continues on saying <code>Unprotect sheet</code> but oddly the sheet which was active when I loaded the userform becomes unprotected instead.</p>\n\n<p>The Userform is loaded by using <code>UserForm.Show</code>. I haven't experienced this behaviour in any other workbooks that I have.</p>\n\n<p>Have tried:</p>\n\n<ul>\n<li>Toggling <code>EnablingEvents</code></li>\n<li>Toggling <code>ScreenUpdating</code></li>\n<li>Resetting the freeze panes area</li>\n<li>Changing where the destination sheet is activated</li>\n</ul>\n\n<p>All to no avail. Has anyone come across similar or know of a reason this behaviour could be experienced?</p>\n\n<p><strong><em>Edit:</em></strong></p>\n\n<p>Load procedure:</p>\n\n<pre><code>Sub SearchRev_Button()\n    If ConnectToDB() = True Then\n        Review_Search.Show\n        Call CloseConnections\n    End If\nEnd Sub\n</code></pre>\n\n<p>Unload procedure:</p>\n\n<pre><code>Private Sub LoadReviewButton_Click()\n\n    'Loads the selected review to be edited\n\n    Application.Calculation = xlCalculationManual\n    If Me.ResultListBox.ListIndex = -1 Then Exit Sub\n\n    Select Case rs.Fields(\"ReviewMethod\").Value\n        Case \"Review\"\n        If rs.Fields(\"ReviewMethod\").Value = \"ChangeReview\" Then Review_ChangeReviewType.Show\n\n        FetchReviewDetail ReviewID\n        Unload Me ' &lt;-- This is the line that unloads the userform to return to sheet\n        Case \"ISP\"\n        Unload Me\n        ISP_Dash.Show\n\n        Case Else\n        MsgBox prompt:=\"You cannot make changes to this review\", Title:=TitleString\n    End Select\n\n    Application.Calculation = xlCalculationAutomatic\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "if-statement"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1522227877, "post_id": 49530147, "comment_id": 86066377, "body": "Where does <code>Status</code> come from? Also, assume <code>Count_of_ID</code> is column <code>M</code>?"}, {"owner": {"reputation": 390, "user_id": 3154332, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/35fb3b6dbc40b31bf25c623fba5313fd?s=128&d=identicon&r=PG&f=1", "display_name": "brainac", "link": "https://stackoverflow.com/users/3154332/brainac"}, "edited": false, "score": 0, "creation_date": 1522228155, "post_id": 49530147, "comment_id": 86066587, "body": "maybe just sort by End Date and Amount, then remove duplicates by Client ID? I can&#39;t check your file, but if you want to keep initial order of rows, add ordinal number column beforehand, then sort by it after removing duplicates."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1522229083, "post_id": 49530147, "comment_id": 86067302, "body": "In the 3rd, do you need all the IF&#39;s for Keep?  Can this be done with an OR?"}, {"owner": {"reputation": 1, "user_id": 5868392, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156486841745158/picture?type=large", "display_name": "Noele", "link": "https://stackoverflow.com/users/5868392/noele"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1522229289, "post_id": 49530147, "comment_id": 86067458, "body": "HI @Tom, Status is a column that I hid. It says whether the contract was renewed, expired, is in the renewal process or if it is the customer&#39;s first contract. If it is the first contract. If the contract is in the renewal process or if it is the customer&#39;s first contract, the customer id is deemed not eligable and removed from the analysis"}, {"owner": {"reputation": 1, "user_id": 5868392, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156486841745158/picture?type=large", "display_name": "Noele", "link": "https://stackoverflow.com/users/5868392/noele"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1522229371, "post_id": 49530147, "comment_id": 86067526, "body": "Hi @Nathan_Sav, Do you think including or would enable me to significantly decrease the size of the formula?"}, {"owner": {"reputation": 380, "user_id": 5423218, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f7b59b832166bdb7fb0e9f32d1b2555f?s=128&d=identicon&r=PG&f=1", "display_name": "AndyW", "link": "https://stackoverflow.com/users/5423218/andyw"}, "edited": false, "score": 0, "creation_date": 1522231029, "post_id": 49530147, "comment_id": 86068832, "body": "Noele, have you used Named formulas on Excel before? By creating a formula I can reduce the whole OR(Status... to a single word which clarifies the formula a lot"}, {"owner": {"reputation": 1, "user_id": 5868392, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156486841745158/picture?type=large", "display_name": "Noele", "link": "https://stackoverflow.com/users/5868392/noele"}, "reply_to_user": {"reputation": 380, "user_id": 5423218, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f7b59b832166bdb7fb0e9f32d1b2555f?s=128&d=identicon&r=PG&f=1", "display_name": "AndyW", "link": "https://stackoverflow.com/users/5423218/andyw"}, "edited": false, "score": 0, "creation_date": 1522232634, "post_id": 49530147, "comment_id": 86070062, "body": "HI @AndyW :) I have used defined names of columns and used those in formulas (Status is also the name of a column). How are you able to reduce the whole OR(Status...) to a single word?"}], "answers": [{"tags": [], "owner": {"reputation": 380, "user_id": 5423218, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f7b59b832166bdb7fb0e9f32d1b2555f?s=128&d=identicon&r=PG&f=1", "display_name": "AndyW", "link": "https://stackoverflow.com/users/5423218/andyw"}, "is_accepted": false, "score": 0, "last_activity_date": 1522233381, "creation_date": 1522233381, "answer_id": 49532270, "question_id": 49530147, "link": "https://stackoverflow.com/questions/49530147/too-many-if-statements-excel-vba/49532270#49532270", "title": "Too many IF statements Excel / VBA", "body": "<p>I would use Named Formulae. They are not widely used in Excel but very powerful. As an example I reduced</p>\n\n<pre><code>=IF(OR(Status=\"\"in renewing process\"\",Status=\"\"first contract still running\"\")\n</code></pre>\n\n<p>to a single word returning true or false using a named formula. I have used relative addressing, excel handles this for you. The attached image should give you all the information you need to use it. I clicked on B2 and built the formula as normal, tested it then copied it, right clicked >DefineName, gave it a name and pasted the formula into 'refers to'.\nTo use it then just add the Name into the cell and Excel handles all the relative addressing stuff.</p>\n\n<p><a href=\"https://i.stack.imgur.com/AAMzy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AAMzy.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 5868392, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156486841745158/picture?type=large", "display_name": "Noele", "link": "https://stackoverflow.com/users/5868392/noele"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 170, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1522233381, "creation_date": 1522227381, "last_edit_date": 1522227526, "question_id": 49530147, "link": "https://stackoverflow.com/questions/49530147/too-many-if-statements-excel-vba", "title": "Too many IF statements Excel / VBA", "body": "<p>I have added some sample data in this file to explain my problem a bit better. I have blended out the columns which have no relevance to the formula: <a href=\"https://docs.google.com/spreadsheets/d/1_lq0mYPF2ICiFgehQz_YkOa28JUyamG4G8ObV957onY/edit?usp=sharing\" rel=\"nofollow noreferrer\">https://docs.google.com/spreadsheets/d/1_lq0mYPF2ICiFgehQz_YkOa28JUyamG4G8ObV957onY/edit?usp=sharing</a></p>\n\n<p>My initial file has one row per contract. I want to end up with one row per customer ID. I need to only keep the most recent contract, so the contract with the end date closest to Now(). If one customer ID has two contracts ending at the same time, I would like to keep the row with the higher monthly invoice amount. </p>\n\n<p>I have been doing this with IF statements but there must be a more efficient way. At the moment the highest number of contracts a customer has with 3, but this will increase in the coming months and my if statement method will no longer be viable.</p>\n\n<p>Here is my current formula.</p>\n\n<pre><code>Range(\"P2\").Select\n    ActiveCell.FormulaR1C1 = _\n        \"=IF(OR(Status=\"\"in renewing process\"\",Status=\"\"first contract still running\"\"),\"\"Not Eligable\"\",IF(Count_of_ID=1,\"\"keep\"\",IF(Count_of_ID=2,(IF(AND(RC[-15]=R[1]C[-15],MIN(RC[-1],R[1]C[-1])=RC[-1]),\"\"keep\"\",\"\"delete\"\")),IF(Count_of_ID=3,IF(AND(RC[-15]=R[1]C[-15],RC[-15]=R[2]C[-15],MIN(RC[-1],R[1]C[-1],R[2]C[-1])=RC[-1]),\"\"keep\"\",\"\"delete\"\")))))\"\n\nRange(\"P3\").Select\n    ActiveCell.FormulaR1C1 = _\n        \"=IF(OR(Status=\"\"in renewing process\"\",Status=\"\"first contract still running\"\"),\"\"Not Eligable\"\",IF(Count_of_ID=1,\"\"keep\"\",IF(Count_of_ID=2,(IF(AND(RC[-15]=R[1]C[-15],MIN(RC[-15],R[1]C[-15])=RC[-15]),\"\"keep\"\",IF(Count_of_ID=2,(IF(AND(RC[-15]=R[-1]C[-15],MIN(RC[-15],R[-1]C[-15])=RC[-15]),\"\"keep\"\",\"\"delete\"\")))),IF(Count_of_ID=3,IF(AND(RC[-15]=R[1]C[-15],RC[-15]=R[2]C[\" &amp; _\n        \"-15],MIN(RC[-15],R[1]C[-15],R[2]C[-15])=RC[-15]),\"\"keep\"\",IF(Count_of_ID=3,IF(AND(RC[-15]=R[1]C[-15],RC[-15]=R[-1]C[-15],MIN(RC[-15],R[1]C[-15],R[-1]C[-15])=RC[-15]),\"\"keep\"\",\"\"delete\"\"))))))))\" &amp; _\n        \"\"\n\nRange(\"P4\").Select\n    ActiveCell.FormulaR1C1 = _\n        \"=IF(OR(Status=\"\"in renewing process\"\",Status=\"\"first contract still running\"\"),\"\"Not Eligable\"\",IF(Count_of_ID=1,\"\"keep\"\",(IF(AND(Count_of_ID=2,RC[-15]=R[1]C[-15],MIN(RC[-1],R[1]C[-1])=RC[-1]),\"\"keep\"\",IF(AND(Count_of_ID=2,RC[-15]=R[-1]C[-15],MIN(RC[-1],R[-1]C[-1])=RC[-1]),\"\"keep\"\",IF(AND(Count_of_ID=3,RC[-15]=R[1]C[-15],RC[-15]=R[2]C[-15],MIN(RC[-1],R[1]C[-1],R[2]C\" &amp; _\n        \"[-1])=RC[-1]),\"\"keep\"\",IF(AND(Count_of_ID=3,RC[-15]=R[1]C[-15],RC[-15]=R[-1]C[-15],MIN(RC[-1],R[1]C[-1],R[-1]C[-1])=RC[-1]),\"\"keep\"\",IF(AND(Count_of_ID=3,RC[-15]=R[-1]C[-15],RC[-15]=R[-2]C[-15],MIN(RC[-1],R[-1]C[-1],R[-2]C[-1])=RC[-1]),\"\"keep\"\",\"\"delete\"\"))))))))\" &amp; _\n        \"\"\n    Range(\"P4\").Select\n    Selection.AutoFill Destination:=Range(\"P4:P\" &amp; Lastrow)\n</code></pre>\n\n<p>Any help much appreciated! </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1522227542, "post_id": 49530124, "comment_id": 86066156, "body": "\u2460 <code>Workbooks(test).Worksheets(&quot;Sheet1&quot;)</code> doesn&#39;t make much sense instead use <code>Set test = Worksheets(&quot;Sheet1&quot;)</code> and then you can use it eg like <code>test.Range(&quot;A2&quot;)\u2026</code> \u2461 you don&#39;t need to select and activate \u2462 Don&#39;t use <code>On Error Resume Next</code> it makes you just blind for any errors, but they still occur. You just don&#39;t see them. Use a proper error handling instead. Remove it (both!) and tell in your question which errors you get and where. \u2463 And it may be a good idea to clean up your code and use proper indentation. This is essential to understand and read code easily, especially for beginners."}, {"owner": {"reputation": 151, "user_id": 9167485, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3e9b292e1271d971bc2542a5642984d?s=128&d=identicon&r=PG&f=1", "display_name": "alex2002", "link": "https://stackoverflow.com/users/9167485/alex2002"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1522227873, "post_id": 49530124, "comment_id": 86066376, "body": "I didn&#39;t get any errors on the code below. Yes, I will try to take into consideration your advice and give it another interpretation. Thanks! :)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1522228286, "post_id": 49530124, "comment_id": 86066709, "body": "Of course you didn&#39;t get any errors, because of <code>On Error Resume Next</code> you cannot see them! \u2464 you might also consider using meaningful variable names instead of <code>A, G, h, i</code> which makes it <b>much</b> easier to understand. E.g Using <code>i</code> as a range is very unusual because almost everyone uses <code>i</code> as a counter. Eg instead of <code>h</code> name it <code>EmailAddress</code> this is something you easily understand while reading the code while <code>h</code> is very meaningless."}, {"owner": {"reputation": 151, "user_id": 9167485, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3e9b292e1271d971bc2542a5642984d?s=128&d=identicon&r=PG&f=1", "display_name": "alex2002", "link": "https://stackoverflow.com/users/9167485/alex2002"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1522229054, "post_id": 49530124, "comment_id": 86067278, "body": "just added my second interpretation. Thanks"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1522229558, "post_id": 49530124, "comment_id": 86067707, "body": "hm your code still leaves some questions: You <code>Set sh1</code> but then use <code>sh1Rec</code> which is not declared as a variable. Make sure you use <code>Option Explicit</code> and you declare <b>every</b> variable properly. Without <code>Option Explicit</code> you won&#39;t see any variable missnamings like that. \u2022 Also you still use <code>On Error Resume Next</code>. \u2022 And <code>h = sh2 .Cells(A, 2).Value</code> would eg. read row A column 2. \u2022 And I really suggest again to indent your code properly which is necessary to understand the logical structure of your code more easily."}, {"owner": {"reputation": 151, "user_id": 9167485, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3e9b292e1271d971bc2542a5642984d?s=128&d=identicon&r=PG&f=1", "display_name": "alex2002", "link": "https://stackoverflow.com/users/9167485/alex2002"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1522229999, "post_id": 49530124, "comment_id": 86068051, "body": "Yes, was my mistake as I just copied the code for the mail part without realizing the &quot;error resume..&quot; part. I have declared the variables correctly now. The logic for me seems pretty straight now, at least as I am reading the code, but as I said, I am not able to set the &quot;Else&quot;. I guess a loop should be used in order to verify column A and B from sheet 2? Thanks"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 151, "user_id": 9167485, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3e9b292e1271d971bc2542a5642984d?s=128&d=identicon&r=PG&f=1", "display_name": "alex2002", "link": "https://stackoverflow.com/users/9167485/alex2002"}, "edited": false, "score": 0, "creation_date": 1522230113, "post_id": 49530124, "comment_id": 86068121, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/167714/discussion-between-p-and-alex2002\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 151, "user_id": 9167485, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3e9b292e1271d971bc2542a5642984d?s=128&d=identicon&r=PG&f=1", "display_name": "alex2002", "link": "https://stackoverflow.com/users/9167485/alex2002"}, "is_accepted": false, "score": 2, "last_activity_date": 1522743507, "last_edit_date": 1522743507, "creation_date": 1522232919, "answer_id": 49532116, "question_id": 49530124, "link": "https://stackoverflow.com/questions/49530124/return-value-of-dynamically-determined-cell/49532116#49532116", "title": "Return value of dynamically determined cell", "body": "<p>With the help of \"PEH\" i succeed in finding a solution for this:</p>\n\n<pre><code>Sub mail()\n\n    Dim A As Long\n    Dim sh1 As Worksheet\n    Dim sh2 As Worksheet\n    Dim wb As Workbook\n\n    Dim check\n\n    Set wb = Excel.ActiveWorkbook\n    Set sh1 = wb.Worksheets(1)\n    Set sh2 = wb.Worksheets(2)\n\n    For A = 2 To sh1.Cells(Rows.Count, \"A\").End(xlUp).Row\n        check = Application.match(sh1.Cells(A, 1).Value, sh2.Columns(1), 0)\n\n        If IsError(check) And Not IsEmpty(sh1.Cells(A, 1)) Then\n            MsgBox \"No email was found!\"\n        Else\n            h = sh2.Cells(check, 2).Value\n\n\n            Set OutApp = CreateObject(\"Outlook.Application\")\n            Set OutMail = OutApp.createItem(olmailitem)\n            Set wb2 = ActiveWorkbook\n            wb.Save\n\n            With OutMail\n                .Display\n                .To = h\n                .cc = \"\"\n                .BCC = \"\"\n                .Subject = \"Test - \" '&amp; B &amp; \" \" &amp; F\n                .htmlbody = \"&lt;p style='font-family:calibri;font-size:15'&gt;\" &amp; \"Hi \" &amp; C &amp; \"&lt;BR/&gt;\" &amp; \"&lt;BR/&gt;\" &amp; \"Please check the attached template.\" &amp; \"&lt;br/&gt;\" &amp; \"&lt;BR/&gt;\" &amp; \"Change data if required.\" &amp; \"&lt;BR/&gt;\" &amp; \"&lt;br/&gt;\" &amp; \"This e-mail has been automatically send! \" &amp; \"&lt;br/&gt;\" &amp; \"&lt;br/&gt;\" &amp; \"With best regards,\" &amp; \"&lt;br/&gt;\" &amp; \"&lt;br/&gt;\"\n                .attachments.Add wb2.FullName\n            End With\n\n            wb.Close\n        End If\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 9167485, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3e9b292e1271d971bc2542a5642984d?s=128&d=identicon&r=PG&f=1", "display_name": "alex2002", "link": "https://stackoverflow.com/users/9167485/alex2002"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1522743537, "creation_date": 1522227331, "last_edit_date": 1531164843, "question_id": 49530124, "link": "https://stackoverflow.com/questions/49530124/return-value-of-dynamically-determined-cell", "title": "Return value of dynamically determined cell", "body": "<p>The code below verifies if column A in \"Sheet1\" has the same value as column A in \"Sheet2\". If so, an email address should be taken from column B \"Sheet2\".</p>\n\n<p>My problem is getting the email address from \"Sheet2\" column B.</p>\n\n<pre><code>Sub mail()\n\n    Dim A As Long\n    Dim sh1 As Worksheet\n    Dim sh2 As Worksheet\n    Dim wb As Workbook\n    Dim check\n\n    Set wb = Excel.ActiveWorkbook\n    Set sh1 = wb.Worksheets(1)\n    Set sh2 = wb.Worksheets(2)\n    Application.ScreenUpdating = False\n\n    For A = 2 To sh1.Cells(Rows.Count, \"A\").End(xlUp).Row\n\n        check = Application.match(sh1.Cells(A, 1).Value, sh2.Columns(1), 0)\n\n        If IsError(check) Then\n            MsgBox \"No email was found!\"\n        Else\n            ' i am not able to set this.\n            'h = take the email address from sheet2 column B\n\n            Set OutApp = CreateObject(\"Outlook.Application\")\n            Set OutMail = OutApp.createItem(olmailitem)\n            Set wb2 = ActiveWorkbook\n            ActiveWorkbook.Save\n\n            With OutMail\n                .Display\n                .To = h ' attached the email address\n                .cc = \"\"\n                .BCC = \"\"\n                .Subject = \"Test - \" '&amp; B &amp; \" \" &amp; F\n                .htmlbody = \"&lt;p style='font-family:calibri;font-size:15'&gt;\" &amp; \"Hi \" &amp; C &amp; \"&lt;BR/&gt;\" &amp; \"&lt;BR/&gt;\" &amp; \"Please check the attached template.\" &amp; \"&lt;br/&gt;\" &amp; \"&lt;BR/&gt;\" &amp; \"Change data if required.\" &amp; \"&lt;BR/&gt;\" &amp; \"&lt;br/&gt;\" &amp; \"This e-mail has been automatically send! \" &amp; \"&lt;br/&gt;\" &amp; \"&lt;br/&gt;\" &amp; \"With best regards,\" &amp; \"&lt;br/&gt;\" &amp; \"&lt;br/&gt;\" \n                .attachments.Add wb2.FullName\n            End With\n\n            ActiveWorkbook.Close              \n        End If\n\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "csv"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1522227333, "post_id": 49529705, "comment_id": 86066027, "body": "If you want to check the CSV, use Notepad++ or even better, a HexEdit app."}, {"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "edited": false, "score": 0, "creation_date": 1522228700, "post_id": 49529705, "comment_id": 86067003, "body": "<b>You need unique line separator, which isn&#39;t used inside values.</b>"}], "answers": [{"tags": [], "owner": {"reputation": 35, "user_id": 8627895, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/30e3e28a3900170750d265f59c72537b?s=128&d=identicon&r=PG&f=1", "display_name": "Peace_Man", "link": "https://stackoverflow.com/users/8627895/peace-man"}, "is_accepted": false, "score": 0, "last_activity_date": 1522255123, "creation_date": 1522255123, "answer_id": 49539923, "question_id": 49529705, "link": "https://stackoverflow.com/questions/49529705/importing-csv-cant-split-correctly/49539923#49539923", "title": "Importing CSV cant split correctly", "body": "<p>Use the built-in wizard to clarify the breaks in your data. Like comma, space, tab etc. </p>\n"}], "owner": {"reputation": 1, "user_id": 9558258, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "MBakes", "link": "https://stackoverflow.com/users/9558258/mbakes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1522255123, "creation_date": 1522226064, "last_edit_date": 1522236921, "question_id": 49529705, "link": "https://stackoverflow.com/questions/49529705/importing-csv-cant-split-correctly", "title": "Importing CSV cant split correctly", "body": "<p>I am importing a csv to excel, the csv file looks like this if i open it up in notepad:</p>\n\n<p>\"Name\",\u201did\u201d,\u201dcomment\u201d,\u201ddate\u201d\u201dMike\u201d,\u201d123\u201d,\u201dNA------save notes above this line------\u201c,\u201d01/03/2018\u201d\u201dJane\u201d,\u201d278\u201d,\u201dANS----save notes above this line\u201d,\u201d01/02/2017\u201d</p>\n\n<p>Now if i open it in word and check where the breaks are, they appear at the end of each line correctly but there are also breaks in the comment field and if i load the whole file into an array called whole_file and then split like this:</p>\n\n<pre><code> lines = Split(whole_file, vbCrLf)\n</code></pre>\n\n<p>it will split correctly on the first line as these are the headers but on the following lines it will split at the carriages in the comments which i don't want it to do. If i remove chr(13) &amp; chr(10) then the above split will not work. My question is what can i do to prepare my CSV so these carriages are removed from the comments or is there a way split each line say at the quotation marks which do not have a apostrophe in between?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "timer"], "answers": [{"tags": [], "owner": {"reputation": 365, "user_id": 8375323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/918083780ee76a16a744266bda3aae03?s=128&d=identicon&r=PG&f=1", "display_name": "Suniti Yadav", "link": "https://stackoverflow.com/users/8375323/suniti-yadav"}, "is_accepted": false, "score": 1, "last_activity_date": 1522282402, "last_edit_date": 1522282402, "creation_date": 1522226205, "answer_id": 49529757, "question_id": 49529673, "link": "https://stackoverflow.com/questions/49529673/converting-a-timer-to-show-seconds-only/49529757#49529757", "title": "Converting a timer to show seconds only", "body": "<p>Please refer this link:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/9640266\">Convert HH:MM:SS string to seconds only in javascript</a></p>\n\n<p>And try this:</p>\n\n<pre><code>var hms = '02:04:33';   // your input string\nvar a = hms.split(':'); // split it at the colons\n\n// minutes are worth 60 seconds. Hours are worth 60 minutes.\nvar seconds = (+a[0]) * 60 * 60 + (+a[1]) * 60 + (+a[2]); \n\nconsole.log(seconds);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1522227012, "last_edit_date": 1522227012, "creation_date": 1522226690, "answer_id": 49529927, "question_id": 49529673, "link": "https://stackoverflow.com/questions/49529673/converting-a-timer-to-show-seconds-only/49529927#49529927", "title": "Converting a timer to show seconds only", "body": "<p>This is probably the easiest and the most comprehensive way, as a minute has 60 seconds and one hour has 3600 seconds. </p>\n\n<p>Thus 1 minute and 30 seconds would be <code>0*3600 + 1*60 + 30</code>:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim myTime As Date\n    myTime = TimeSerial(0, 1, 30)\n    Debug.Print Hour(myTime) * 3600 + Minute(myTime) * 60 + Second(myTime)\n\nEnd Sub\n</code></pre>\n\n<p>It takes <code>1:30</code> and it returns <code>90</code>. You may consider writing a separate function like this one as well:</p>\n\n<pre><code>Public Function TimeToSeconds(Optional hours As Long = 0, _\n                                Optional minutes As Long = 0, _\n                                Optional seconds As Long = 0) As Long\n\n    TimeToSeconds = hours * 3600 + minutes * 60 + seconds\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9562691, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MprcmQxGeN4/AAAAAAAAAAI/AAAAAAAABSM/0v4HOXgbDQg/photo.jpg?sz=128", "display_name": "Jared ", "link": "https://stackoverflow.com/users/9562691/jared"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1522282402, "creation_date": 1522225964, "question_id": 49529673, "link": "https://stackoverflow.com/questions/49529673/converting-a-timer-to-show-seconds-only", "title": "Converting a timer to show seconds only", "body": "<p>I have a timer set as a VB object in a spread sheet. It currently displays as \nhh:mm:ss.00. I need it to display as seconds only (no miliseconds or minutes, IE 1:30 should show as 90).</p>\n\n<pre><code>Dim StopTimer As Boolean\nDim Etime As Single\nDim Etime0 As Single\nDim LastEtime As Single\n\nPrivate Sub CommandButton1_Click()\nStopTimer = False\nEtime0 = Timer() - LastEtime\nDo Until StopTimer\nEtime = Int((Timer() - Etime0) * 100) / 100\nIf Etime &gt; LastEtime Then\nLastEtime = Etime\nLabel1.Caption = Format(Etime / 86400, \"hh:mm:ss.\") &amp; Format(Etime * 100 Mod 100, \"00\")\nDoEvents\nEnd If\nLoop\nEnd Sub\n\nPrivate Sub CommandButton2_Click()\nStopTimer = True\nBeep\n    With New MSForms.DataObject\n        .SetText Label1.Caption\n        .PutInClipboard\n    End With\nEnd Sub\n\nPrivate Sub CommandButton3_Click()\nStopTimer = True\nEtime = 0\nEtime0 = 0\nLastEtime = 0\nLabel1.Caption = \"00\"\nEnd Sub\n</code></pre>\n\n<p>I'm sure I'm simply overlooking something obvious but I'm not overly familiar with timers and formatting.</p>\n"}, {"tags": ["vba", "ms-word", "word-field"], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1522234202, "last_edit_date": 1522234202, "creation_date": 1522227378, "answer_id": 49530145, "question_id": 49529516, "link": "https://stackoverflow.com/questions/49529516/display-all-field-codes-instead-of-results/49530145#49530145", "title": "display all field codes (instead of results)", "body": "<p>You can use the <code>View.ShowFieldCodes</code> property which takes/accepts a Boolean:</p>\n\n<pre><code>ActiveWindow.View.ShowFieldCodes = True\n</code></pre>\n\n<p>It doesn't matter whether any or no field codes are currently displayed: ALL will be displayed.      </p>\n"}], "owner": {"reputation": 434, "user_id": 9075944, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/1cfe5b6b167756a9d0b83c40cf631bdf?s=128&d=identicon&r=PG&f=1", "display_name": "Tuberose", "link": "https://stackoverflow.com/users/9075944/tuberose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 49530145, "answer_count": 1, "score": 0, "last_activity_date": 1593883183, "creation_date": 1522225459, "last_edit_date": 1593883183, "question_id": 49529516, "link": "https://stackoverflow.com/questions/49529516/display-all-field-codes-instead-of-results", "title": "display all field codes (instead of results)", "body": "<p>I need to display the fields code and use:</p>\n\n<pre><code>Document.Content.Fields.ToggleShowCodes\n</code></pre>\n\n<p>I have fields, some are in text boxes and need showing all of them.</p>\n\n<p>But the above toggles - and I need more control. If the codes are showing, performs display fields results.</p>\n\n<p>So I need if fields code are showing, do nothing, else show all fields code, even if they're are in the text boxes.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1522225497, "post_id": 49529495, "comment_id": 86064686, "body": "Why simulate a click? Just have it save as pdf in the code direct."}, {"owner": {"reputation": 75, "user_id": 8769700, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/10156011668317079/picture?type=large", "display_name": "Jext", "link": "https://stackoverflow.com/users/8769700/jext"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522225945, "post_id": 49529495, "comment_id": 86065000, "body": "Hi, because I email individual and in batch - so individual I want them to click save, but in batch it must just save it and move to the next email - hope that makes sense"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1522226420, "post_id": 49529495, "comment_id": 86065338, "body": "So does your code know if this is a batch? If yes, use a conditional in your code to either use SaveAs, or not. Same way you&#39;d decide whether the code should <i>click the button</i>."}, {"owner": {"reputation": 75, "user_id": 8769700, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/10156011668317079/picture?type=large", "display_name": "Jext", "link": "https://stackoverflow.com/users/8769700/jext"}, "edited": false, "score": 0, "creation_date": 1522226966, "post_id": 49529495, "comment_id": 86065733, "body": "so if I get this correctly, all I need to do is change my code to        Fname = Application.SaveAsFilename(ws.Name &amp; &quot;<i>&quot; &amp; Range(&quot;M21&quot;) &amp; &quot;</i>&quot; &amp; _             VBA.Strings.Format(Now, &quot;ddmmyy&quot;), filefilter:=FileFormatstr, _             Title:=&quot;Create PDF&quot;)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522228271, "post_id": 49529495, "comment_id": 86066697, "body": "Have a look through some of these <a href=\"https://www.google.co.uk/search?q=save+file+as+pdf+vba&amp;oq=save+file+as+pdf+vba&amp;aqs=chrome..69i57j0l5.4691j0j7&amp;sourceid=chrome&amp;ie=UTF-8\" rel=\"nofollow noreferrer\">google.co.uk/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "is_accepted": false, "score": 0, "last_activity_date": 1522246177, "creation_date": 1522246177, "answer_id": 49536803, "question_id": 49529495, "link": "https://stackoverflow.com/questions/49529495/simulate-click-on-save-button/49536803#49536803", "title": "Simulate click on SAVE button", "body": "<p>The code that you have uses <strong><em>GetSaveAsFilename</em></strong> and this is the <a href=\"https://msdn.microsoft.com/en-us/library/office/aa195748(v=office.11).aspx\" rel=\"nofollow noreferrer\">official document</a> of it &amp; if you read the first line in the document it will state the functionality which is - <em>Displays the standard Save As dialog box and gets a file name from the user without actually saving any files.</em></p>\n\n<p>But what you are trying to do is Save the file automatically without showing the dialog box in the form of a PDF.Therefore, you need to use <strong><em>ExportAsFixedFormat</em></strong> and this is the <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/workbook-exportasfixedformat-method-excel\" rel=\"nofollow noreferrer\">official document</a> of it.</p>\n\n<p>So, you can use something like this:-</p>\n\n<pre><code>ActiveWorkbook.ExportAsFixedFormat Type:=xlTypePDF FileName:=\"sales.pdf\" Quality:=xlQualityStandard DisplayFileAfterPublish:=True\n</code></pre>\n\n<p>And to answer your case, you will need an if else loop on your program to switch between both of your cases.</p>\n"}], "owner": {"reputation": 75, "user_id": 8769700, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/10156011668317079/picture?type=large", "display_name": "Jext", "link": "https://stackoverflow.com/users/8769700/jext"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522246177, "creation_date": 1522225376, "last_edit_date": 1522226308, "question_id": 49529495, "link": "https://stackoverflow.com/questions/49529495/simulate-click-on-save-button", "title": "Simulate click on SAVE button", "body": "<p>I run a vba sub routine which creates a PDF file - and all works, the only issue I now have is that I do not want the user to have to click on the save button and want to simulate this in VBA. My code is as follows\"</p>\n\n<pre><code>Fname = Application.GetSaveAsFilename(ws.Name &amp; \"_\" &amp; Range(\"M21\") &amp; \"_\" &amp; _\n            VBA.Strings.Format(Now, \"ddmmyy\"), filefilter:=FileFormatstr, _\n            Title:=\"Create PDF\")\n</code></pre>\n\n<p>Not to sure what and where I need to add the code to force the save </p>\n\n<p>Any help will be appreciated. </p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 1, "creation_date": 1522226320, "post_id": 49529290, "comment_id": 86065262, "body": "You could also create opt as a Module variable rather than a Sub variable? Put <code>Private opt As Control</code> just after your <code>Option Explicit</code> and remove <code>Dim opt As Variant</code>, then you can use <code>If Not opt.Value Then MsgBox &quot;F&quot;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 2, "last_activity_date": 1522227330, "last_edit_date": 1522227330, "creation_date": 1522225537, "answer_id": 49529546, "question_id": 49529290, "link": "https://stackoverflow.com/questions/49529290/use-checkbox-dynamically-added-to-userform/49529546#49529546", "title": "Use checkbox dynamically added to userform", "body": "<p>This is what you are thinking of:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub UserForm_Initialize()\n    Dim opt As Variant\n    Set opt = Me.Controls.Add(\"Forms.checkbox.1\", \"CheckBox1\", True)\nEnd Sub\n\nPrivate Sub CommandButton1_Click()\n    If Not Me.Controls(\"CheckBox1\") Then\n        MsgBox \"F\"\n    End If\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>However</strong>, depending on your experience and desires to write better code, you may decide to follow some MVC pattern in working with Forms. Read these for some more ideas about it:</p>\n\n<ul>\n<li><p><a href=\"https://codereview.stackexchange.com/questions/154401/handling-dialog-closure-in-a-vba-user-form\">https://codereview.stackexchange.com/questions/154401/handling-dialog-closure-in-a-vba-user-form</a></p></li>\n<li><p><a href=\"http://www.vitoshacademy.com/vba-the-perfect-userform-in-vba/\" rel=\"nofollow noreferrer\">http://www.vitoshacademy.com/vba-the-perfect-userform-in-vba/</a> (Disclaimer - this is my blog)</p></li>\n<li><p><a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/</a></p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1522225830, "creation_date": 1522225830, "answer_id": 49529634, "question_id": 49529290, "link": "https://stackoverflow.com/questions/49529290/use-checkbox-dynamically-added-to-userform/49529634#49529634", "title": "Use checkbox dynamically added to userform", "body": "<p>It will need to be as follows</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nIf Me.Controls(\"Checkbox1\").Value = False Then\nMsgBox \"F\"\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 9380143, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ivgeni Feldman", "link": "https://stackoverflow.com/users/9380143/ivgeni-feldman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 838, "favorite_count": 0, "accepted_answer_id": 49529546, "answer_count": 2, "score": 2, "last_activity_date": 1593024394, "creation_date": 1522224695, "last_edit_date": 1593024394, "question_id": 49529290, "link": "https://stackoverflow.com/questions/49529290/use-checkbox-dynamically-added-to-userform", "title": "Use checkbox dynamically added to userform", "body": "<p>I add <code>CheckBox1</code> to my <code>UserForm</code> with this code:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    Dim opt As Variant\n    Set opt = UserForm1.Controls.Add(\"Forms.checkbox.1\", \"CheckBox1\", True)\nEnd Sub\n</code></pre>\n\n<p>Now when I click on a <code>CommandButton</code> I want to Check if the <code>CheckBox1</code> is checked or not:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    If CheckBox1.Value = False Then\n        MsgBox \"F\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>But this code doesn't work; I think because the check box is added dynamically.<br>\nThis is just a simplification of the code for solving the problem.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "answers": [{"tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": true, "score": 1, "last_activity_date": 1522226421, "last_edit_date": 1522226421, "creation_date": 1522226065, "answer_id": 49529706, "question_id": 49529279, "link": "https://stackoverflow.com/questions/49529279/vba-access-insert-into-error/49529706#49529706", "title": "VBA Access. Insert Into Error", "body": "<p>Field <code>Components ID</code> has a space so enclose in [ ]. Use <code>ItemData</code> to read value from list item.</p>\n\n<pre><code>With Me.listComponents1\n    For Each varItem In .ItemsSelected\n        strSQL = \"INSERT INTO tblMasterData\" &amp; _\n                    \"([Components ID])\" &amp; _\n                     \"Values(\" &amp; .ItemData(varItem) &amp; \")\"\n        CurrentDb.Execute strSQL, dbFailOnError\n    Next\nEnd With\n</code></pre>\n\n<p>Advise not to uses spaces nor punctuation/special characters (underscore only exception) in naming convention.</p>\n"}], "owner": {"reputation": 25, "user_id": 9527824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f2c20e326538f36652dac82f192086c?s=128&d=identicon&r=PG&f=1", "display_name": "user9527824", "link": "https://stackoverflow.com/users/9527824/user9527824"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 49529706, "answer_count": 1, "score": 0, "last_activity_date": 1522345109, "creation_date": 1522224667, "last_edit_date": 1522345109, "question_id": 49529279, "link": "https://stackoverflow.com/questions/49529279/vba-access-insert-into-error", "title": "VBA Access. Insert Into Error", "body": "<p>I have a listbox named listComponents1 and I want the items selected in this by the user to be populated in field Components ID of the table tblMasterData. In my table the field Components ID is of type number. I have written the code but I get an error saying syntax error in Insert Into statement. Can someone help with this issue?</p>\n\n<pre><code>For Each varItem In Me.listComponents1.ItemsSelected\n    strSQL = \"INSERT INTO tblMasterData\" &amp; _\n                \"(Components ID)\" &amp; _\n                 \"Values(\" &amp; Me.listComponents1.Column(0, varItem) &amp; \")\"\n    CurrentDb.Execute strSQL, dbFailOnError\nNext\n</code></pre>\n"}, {"tags": ["excel", "vba", "lotus-notes"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5620986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e102f64c36576093f78f96e84293a696?s=128&d=identicon&r=PG&f=1", "display_name": "nikhil", "link": "https://stackoverflow.com/users/5620986/nikhil"}, "edited": false, "score": 0, "creation_date": 1522311552, "post_id": 49534964, "comment_id": 86109383, "body": "Thank You Very Much @Torsten Link. The Code is working absolutely fine....."}], "tags": [], "owner": {"reputation": 10664, "user_id": 2266289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17776372b3ca8289aa964360a7a60b35?s=128&d=identicon&r=PG", "display_name": "Torsten Link", "link": "https://stackoverflow.com/users/2266289/torsten-link"}, "is_accepted": true, "score": 4, "last_activity_date": 1522241198, "creation_date": 1522241198, "answer_id": 49534964, "question_id": 49529041, "link": "https://stackoverflow.com/questions/49529041/vba-code-for-copying-body-of-a-stationery-mail-into-a-new-mail-in-lotus-notes/49534964#49534964", "title": "vba code for copying body of a stationery mail into a new mail in lotus notes", "body": "<p>In Domino there are Default item names to store data in. The Body (inlcuding all attachments) in a mail is always called \"Body\", and not \"ATTACHMENTS\" as in your example. </p>\n\n<p>You need to replace these lines</p>\n\n<pre><code>Set AttachME = nMailDoc.CreateRichTextItem(\"ATTACHMENT\")\n'Open the PDF folder and attach the files\n...\n</code></pre>\n\n<p>with these</p>\n\n<pre><code>Dim bodyStationary as NotesRichtextItem\n'- get the richtext from the stationary\nSet bodyStationary = nCursor.GetFirstItem( \"Body\" )\n\n'- create richtextitem in new document\nSet AttachME = nMailDoc.CreateRichTextItem(\"Body\")\n\n'- append the stationary\nCall AttachMe.AppendRTItem( bodyStationary )\n\n'- add the attachments\n'Open the PDF folder and attach the files\n...\n</code></pre>\n\n<p>If you want to have the attachments above the text of the stationary, just move the AppendRTItem below the Foreach- loop.</p>\n\n<p>Don't forget to add <code>Attachme.AddNewline( 2 )</code> in that case, as otherwise the text will directly follow the attachments.</p>\n"}], "owner": {"reputation": 3, "user_id": 5620986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e102f64c36576093f78f96e84293a696?s=128&d=identicon&r=PG&f=1", "display_name": "nikhil", "link": "https://stackoverflow.com/users/5620986/nikhil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 638, "favorite_count": 0, "accepted_answer_id": 49534964, "answer_count": 1, "score": 0, "last_activity_date": 1522241198, "creation_date": 1522223900, "last_edit_date": 1522226134, "question_id": 49529041, "link": "https://stackoverflow.com/questions/49529041/vba-code-for-copying-body-of-a-stationery-mail-into-a-new-mail-in-lotus-notes", "title": "vba code for copying body of a stationery mail into a new mail in lotus notes", "body": "<p>I am trying to create a macro which will open a new lotus notes mail, attaches certain files to it and copy and paste the body from a stationery mail. </p>\n\n<p>I am stuck in the last part where I have to copy the BODY of the stationery mail and paste it in the new mail which I have created.</p>\n\n<p>Below is the code which I have tried, but only the files are getting attached but unable to copy the body from the stationery</p>\n\n<p>Any Help is appreciated........</p>\n\n<pre><code>isattached = False\nApplication.ScreenUpdating = False\n'Start Lotus Notes Session\nSet nSession = CreateObject(\"Notes.NotesSession\")\nOn Error GoTo err_send\nSet nMailDb = nSession.GetDatabase(\"\", \"mailin/GBG180.nsf\")\n\n' Open the Stationery View\nSet nView = nMailDb.GetView(\"Stationery\")\nSet nWorkspace = CreateObject(\"Notes.NotesUIWorkspace\")\nSet nCursor = nView.GetFirstDocument\n\nDo While Not nCursor Is Nothing\n    ' get stationery value\n    StationeryName = nCursor.GetItemValue(\"MailStationeryName\")(0)\n    ' match form template selection versus stationery\n    If StationeryName = St_name Then\n\n        Set nMailDoc = nMailDb.CreateDocument(\"Memo\")\n        Set AttachME = nMailDoc.CreateRichTextItem(\"ATTACHMENT\")\n        'Open the PDF folder and attach the files\n        Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n        Set objFolder = objFSO.GetFolder(PdfPath)\n        For Each objFile In objFolder.Files\n            Set EmbedObj = AttachME.EmbedObject(1454, \"\", PdfPath &amp; objFile.Name)\n            isattached = True\n            Application.Wait (15)\n        Next\n        subjectname = policy_num &amp; \"-\" &amp; aname &amp; \"-FoS Invoice &amp; Wording\" &amp; \" \" &amp; Format(DateValue(Now()), \"YYYY\") &amp; \"- Confidential\"\n\n        If (isattached) Then\n            'Set nMailDoc = nWorkspace.EDITDOCUMENT(True, nCursor)\n            nMailDoc.Subject = subjectname\n        Else\n            Set nMailDoc = Nothing\n            Set AttachME = Nothing\n            Exit Function\n        End If\n        nMailDoc.Save True, True, False\n        Set nMailDoc = Nothing\n        Set nCursor = Nothing\n\n        GoTo nMail_OK\n    Else\n        Set nCursor = nView.GetNextDocument(nCursor)\n    End If\nLoop\n</code></pre>\n"}, {"tags": ["excel", "solver", "vba"], "comments": [{"owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 0, "creation_date": 1522222155, "post_id": 49528429, "comment_id": 86062618, "body": "Maybe it is because of the commas that I see in your original question? (<code>\u201cTesta\u201d</code>). Notice, that in the edited version there are the correct commas (<code>&quot;Testa&quot;</code>). In the original <a href=\"https://opensolver.org/help/comment-page-38/\" rel=\"nofollow noreferrer\">OpenSolver help page</a>, I see the wrong commas too, which may cause problems, if pasted like that..."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1522222197, "post_id": 49528429, "comment_id": 86062651, "body": "You will need to explain what &quot;<i>how I can add big ranges like sAdjust efficiently?</i>&quot; means. That&#39;s too less information. Do you get any errors? What is your issue?"}, {"owner": {"reputation": 57, "user_id": 4497888, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b4f300f8e6adb46a4903fecafdeeed91?s=128&d=identicon&r=PG&f=1", "display_name": "Doule", "link": "https://stackoverflow.com/users/4497888/doule"}, "edited": false, "score": 1, "creation_date": 1522222698, "post_id": 49528429, "comment_id": 86062964, "body": "I&#39;ll edit the first post with more information. The commas are correct in vba, when I copied they got distorted."}, {"owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 2, "creation_date": 1522222960, "post_id": 49528429, "comment_id": 86063131, "body": "Try <code>Set</code>, because that is how <code>Range</code> objects are supposed to be created. E. g., <code>Set rA3 = Sheets(&quot;Testa&quot;).Range(&quot;V1&quot;)</code>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1522223007, "post_id": 49528429, "comment_id": 86063156, "body": "@Doule just make you use <code>Option Explicit</code> then it tells you if your quotes are correct or not! Wrong quotes are considered as variable an throw a variable not defined error."}, {"owner": {"reputation": 57, "user_id": 4497888, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b4f300f8e6adb46a4903fecafdeeed91?s=128&d=identicon&r=PG&f=1", "display_name": "Doule", "link": "https://stackoverflow.com/users/4497888/doule"}, "edited": false, "score": 1, "creation_date": 1522223498, "post_id": 49528429, "comment_id": 86063478, "body": "Did both those things and I got rid of the error ! Thanks."}], "owner": {"reputation": 57, "user_id": 4497888, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b4f300f8e6adb46a4903fecafdeeed91?s=128&d=identicon&r=PG&f=1", "display_name": "Doule", "link": "https://stackoverflow.com/users/4497888/doule"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 176, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1522223149, "creation_date": 1522221735, "last_edit_date": 1531164843, "question_id": 49528429, "link": "https://stackoverflow.com/questions/49528429/specifying-range-for-opensolver-in-vba", "title": "Specifying range for Opensolver in vba", "body": "<p>I\u2019ve set different ranges like so:</p>\n\n<pre><code>rA3 = Sheets(\"Testa\").Range(\"V1\")\nrB3 = Sheets(\"Testa\").Range(\"W1\")\nrA4 = Sheets(\"Testa\").Range(\"I2:K200\")\nsAdjust = Sheets(\"Testa\").Range(\"F2:K200\")\nOpenSolver.AddConstraint LHSRange:=rA3, Relation:=RelationGE, RHSRange:=rB3\n</code></pre>\n\n<p>From what I see, these don't seem to be recognized by <code>OpenSolver.SetObjectiveFunctionCell</code> or <code>OpenSolver.AddConstraint</code>, you have to add them using <code>Cells(i,j)</code> and <code>Union</code>. \nWhenever I try to compile the code I get the following error </p>\n\n<blockquote>\n  <p>Erreur de compilation Type d'arguments ByRef incompatible</p>\n</blockquote>\n\n<p>which loosely translated means that the <code>ByRef</code> argument is incompatible. </p>\n\n<p>Does anyone know how I can add big ranges like <code>sAdjust</code> efficiently?</p>\n"}, {"tags": ["vba", "excel", "with-statement"], "comments": [{"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1522221401, "post_id": 49528224, "comment_id": 86062127, "body": "Write a function that checks if a sheet exists and create only when the function returns False (it doesn&#39;t exist)."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 6355232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/093873125a7bd14f69cef56691beda8e?s=128&d=identicon&r=PG&f=1", "display_name": "RobertC", "link": "https://stackoverflow.com/users/6355232/robertc"}, "edited": false, "score": 0, "creation_date": 1522222291, "post_id": 49528310, "comment_id": 86062703, "body": "Thank you, Shai Rado. The code you provided along with the explanations work and made me understand the proper logic/syntax."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 2, "last_activity_date": 1522221406, "creation_date": 1522221406, "answer_id": 49528310, "question_id": 49528224, "link": "https://stackoverflow.com/questions/49528224/vba-with-end-with-add-only-2-sheets/49528310#49528310", "title": "VBA - With/End With Add only 2 Sheets", "body": "<p>You can save all worksheet names in an array <code>SheetNamesArr</code>, and afterwards check if the sheet name, for instance \"ClientList\" is found within the array that holds all sheet names.</p>\n\n<p>You can check if \"ClientList\" already exists in the array by using <code>Application.Match</code> function:</p>\n\n<pre><code>If IsError(Application.Match(\"ClientList\", SheetNamesArr, 0)) Then\n</code></pre>\n\n<p>If <code>IsError</code> will result to <code>True</code> it means this worksheet doesn't exist yet, and you can safely add it, otherwise do nothing.</p>\n\n<p><strong><em>Code</em></strong></p>\n\n<pre><code>Option Explicit\n\nSub CreateSheet()\n\nDim i As Long\nDim SheetNamesArr() As String\n\nReDim SheetNamesArr(100) ' redim to large size, will optimize size later\n\nFor i = 1 To ThisWorkbook.Sheets.Count\n    SheetNamesArr(i - 1) = ThisWorkbook.Sheets(i).Name\nNext i\nReDim Preserve SheetNamesArr(0 To i - 2) ' resize to size of populated sheet names\n\nWith ThisWorkbook\n    ' using Match, means if IsError sheet name not found in current array of sheet names &gt;&gt; you can add it\n    If IsError(Application.Match(\"ClientList\", SheetNamesArr, 0)) Then\n        .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"ClientList\"\n    End If\n    ' same as previous Match\n    If IsError(Application.Match(\"ProviderList\", SheetNamesArr, 0)) Then\n        .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"ProviderList\"\n    End If\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1522222387, "post_id": 49528528, "comment_id": 86062769, "body": "<i>&#39;as this is default workbook to use when workbook reference isn&#39;t used.&#39;</i> - not if it isn&#39;t the activeworkbook."}, {"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "edited": false, "score": 0, "creation_date": 1522222526, "post_id": 49528528, "comment_id": 86062860, "body": "Hm, I think I understand remark, but not fully... That&#39;s way I avoid using <code>ActiveWorkbook</code> etc. :) And use refernces."}, {"owner": {"reputation": 51, "user_id": 6355232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/093873125a7bd14f69cef56691beda8e?s=128&d=identicon&r=PG&f=1", "display_name": "RobertC", "link": "https://stackoverflow.com/users/6355232/robertc"}, "edited": false, "score": 0, "creation_date": 1522222531, "post_id": 49528528, "comment_id": 86062867, "body": "Thank you, Micha\u0142 Turczyn! It works and, indeed, the code is simpler!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1522222725, "post_id": 49528528, "comment_id": 86062974, "body": "... and what if you have a <i>ClientList</i> worksheet but not a <i>ProviderList</i> worksheet (or vice versa)?"}, {"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "edited": false, "score": 0, "creation_date": 1522224277, "post_id": 49528528, "comment_id": 86063968, "body": "@Jeeped It&#39;s based on assumption, that these sheets can only be added together."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1522224934, "post_id": 49528528, "comment_id": 86064359, "body": "I&#39;m not saying it&#39;s bad code and your assumptions may well be correct; I was just pointing out potential logic flaws for future viewers of your solution."}, {"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "edited": false, "score": 0, "creation_date": 1522225077, "post_id": 49528528, "comment_id": 86064445, "body": "@Jeeped I totally agree with you. I just made clarification, so OP won&#39;t be confused (that&#39;s why upvoted all your comments)."}], "tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": true, "score": 1, "last_activity_date": 1522222095, "creation_date": 1522222095, "answer_id": 49528528, "question_id": 49528224, "link": "https://stackoverflow.com/questions/49528224/vba-with-end-with-add-only-2-sheets/49528528#49528528", "title": "VBA - With/End With Add only 2 Sheets", "body": "<p>Here's different aproach:</p>\n\n<pre><code>Sub CreateSheet()\n    Dim sh As Worksheet\n    For Each sh In Sheets\n        'if we have already sheet with given name, then exit sub (means no adding new sheets)\n        If sh.Name = \"ClientList\" Or sh.Name = \"ProviderList\" Then\n            Exit Sub\n        End If\n    Next\n    Sheets.Add(After:=Sheets(Sheets.Count)).Name = \"ClientList\"\n    Sheets.Add(After:=Sheets(Sheets.Count)).Name = \"ProviderList\"\nEnd Sub\n</code></pre>\n\n<p>It's not necessary to use <code>With ThisWorkbook</code> as this is default workbook to use when workbook reference isn't used.</p>\n"}], "owner": {"reputation": 51, "user_id": 6355232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/093873125a7bd14f69cef56691beda8e?s=128&d=identicon&r=PG&f=1", "display_name": "RobertC", "link": "https://stackoverflow.com/users/6355232/robertc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 49528528, "answer_count": 2, "score": 1, "last_activity_date": 1522222095, "creation_date": 1522221082, "last_edit_date": 1531164843, "question_id": 49528224, "link": "https://stackoverflow.com/questions/49528224/vba-with-end-with-add-only-2-sheets", "title": "VBA - With/End With Add only 2 Sheets", "body": "<p>I have written the following code:</p>\n\n<pre><code>Sub CreateSheet()\n    With ThisWorkbook\n        .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"ClientList\"\n        .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"ProviderList\"\n    End With\nEnd Sub\n</code></pre>\n\n<p>My problem is the following: after the code creates the two sheets, I want it to stop and create no other sheets even if I run it again. I want to add 2 and only 2 sheets!<br>\nWhat it does now is to create those two sheets and if I run it again it will try to create other sheets and I get the error message saying \"The name is already taken. Try a different one.\" \nCould you please help me? </p>\n"}, {"tags": ["excel", "copy-paste", "unique-values", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1522220974, "post_id": 49528106, "comment_id": 86061871, "body": "I dunno. <code>RanglFilterCopy</code> is slow on my computer."}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1522223362, "post_id": 49528106, "comment_id": 86063374, "body": "You can also use <code>Dictionary</code> object to find out unique entries in VBA."}, {"owner": {"reputation": 1, "user_id": 4208304, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-se2hQ9K7NVI/AAAAAAAAAAI/AAAAAAAAADg/0AFcyvXUx0k/photo.jpg?sz=128", "display_name": "Peter Mole", "link": "https://stackoverflow.com/users/4208304/peter-mole"}, "edited": false, "score": 0, "creation_date": 1522237386, "post_id": 49528106, "comment_id": 86073370, "body": "Thanks for the tip on the Dictionary Object, another thing to add to my homework list :)...."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1522265544, "post_id": 49528106, "comment_id": 86092949, "body": "What determines which columns are included, if they&#39;re not sequential?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4208304, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-se2hQ9K7NVI/AAAAAAAAAAI/AAAAAAAAADg/0AFcyvXUx0k/photo.jpg?sz=128", "display_name": "Peter Mole", "link": "https://stackoverflow.com/users/4208304/peter-mole"}, "edited": false, "score": 0, "creation_date": 1522221220, "post_id": 49528223, "comment_id": 86062008, "body": "My issue is that I need unique values from multiple columns so for example column 1 will have any number of duplicates but I only want the unique list from all the duplicates, column 5 likewise but there are not duplicates across multiple columns only within each individual column. The other issue is ignorance in that I have no experience with &quot;Power Query / Get and Transform&quot;. I will do a little homework in this regard so thank you for your tip."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1522221671, "post_id": 49528223, "comment_id": 86062314, "body": "How do you think the <a href=\"https://stackoverflow.com/questions/tagged/excel\">excel</a> tag should handle <i>&#39;use Power Query&#39;</i> responses? This response seems a little light on details but given the complete lack of sample data beyond a description, it is all one can offer without speculation."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1522221979, "post_id": 49528223, "comment_id": 86062517, "body": "If there are no duplicates across columns, then what are you arguing?  Combine all values into one column and remove duplicates. You could even do that in Excel, without Power Query."}, {"owner": {"reputation": 1, "user_id": 4208304, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-se2hQ9K7NVI/AAAAAAAAAAI/AAAAAAAAADg/0AFcyvXUx0k/photo.jpg?sz=128", "display_name": "Peter Mole", "link": "https://stackoverflow.com/users/4208304/peter-mole"}, "edited": false, "score": 0, "creation_date": 1522237168, "post_id": 49528223, "comment_id": 86073208, "body": "I have added some further details and some code that I got to work to achieve what I was looking for but I suspect my code is the very long road to a much shorter solution for those more knowledgeable. I thank you all for your comments and as a absolute novice I appreciate you taking the time."}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 1, "last_activity_date": 1522221080, "creation_date": 1522221080, "answer_id": 49528223, "question_id": 49528106, "link": "https://stackoverflow.com/questions/49528106/excel-vba-getting-a-list-of-unique-entries-across-various-columns-and-combine/49528223#49528223", "title": "Excel VBA - Getting a list of unique entries across various columns and combine into a single column of unique items", "body": "<p>In this day and age I would use Power Query / Get and Transform. Pull all the data tables into queries, delete all but the one column you are interested in, append the queries and delete duplicates.</p>\n\n<p>If the data changes, just hit the Refresh All button. Viola.</p>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 0, "last_activity_date": 1522239256, "creation_date": 1522239256, "answer_id": 49534270, "question_id": 49528106, "link": "https://stackoverflow.com/questions/49528106/excel-vba-getting-a-list-of-unique-entries-across-various-columns-and-combine/49534270#49534270", "title": "Excel VBA - Getting a list of unique entries across various columns and combine into a single column of unique items", "body": "<p>Here is some code that should run reasonably quickly.\nAs written, the Table name, worksheet names, and the particular columns to copy are hard coded.</p>\n\n<p>The data is read into a variant array for speed of processing (usually faster than accessing the worksheets).</p>\n\n<p>The <code>Collection</code> object is used to remove duplicates (and blanks are tested for and skipped).  One could use the <code>Dictionary</code> object, and which would be faster depends on the size of the data. Other differences:</p>\n\n<ul>\n<li>The <code>Collection</code> object throws an error if you have a duplicate key.</li>\n<li>The <code>Dictionary</code> object has a <code>.Exists</code> method</li>\n<li>The <code>Dictionary</code> object requires early or late binding to <code>Microsoft Scripting Runtime</code></li>\n<li>The <code>Collection</code> object is native VBA.</li>\n</ul>\n\n<p>Hopefully, this code will give you some clues.</p>\n\n<pre><code>Option Explicit\nSub deDupe()\n    Dim wsSrc As Worksheet, wsRes As Worksheet, rRes As Range\n    Dim vSrc As Variant, vRes As Variant\n    Dim cUniques As Collection\n    Dim I As Long, J As Long\n    Dim colArray\n    Dim V\n\n'Columns to include\n' 1 = first column in table\ncolArray = Array(1, 3, 5) 'Note this will be zero-based array\n\n'Change sheet names for data and results as needed\nSet wsSrc = Worksheets(\"sheet1\")\nSet wsRes = Worksheets(\"sheet2\")\n    Set rRes = wsRes.Cells(1, 1) 'put first cell of unique list anyplace\n\n'Read data into variant array for speed\nvSrc = wsSrc.ListObjects(\"Table1\").DataBodyRange\n\n'Collect the unique values\nSet cUniques = New Collection\nOn Error Resume Next 'Duplicate keys in .Add method --&gt; error\nFor J = 0 To UBound(colArray)\n    For I = 1 To UBound(vSrc)\n        V = vSrc(I, colArray(J))\n        If V &lt;&gt; \"\" Then\n            cUniques.Add Item:=V, Key:=CStr(V)\n        End If\n    Next I\nNext J\nOn Error GoTo 0\n\n'create results array\nReDim vRes(1 To cUniques.Count, 1 To 1)\nFor I = 1 To UBound(vRes, 1)\n    vRes(I, 1) = cUniques(I)\nNext I\n\n'Write the results\nSet rRes = rRes.Resize(UBound(vRes, 1), 1)\nWith rRes\n    .EntireColumn.Clear\n    .Value = vRes\n    .EntireColumn.AutoFit\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4208304, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-se2hQ9K7NVI/AAAAAAAAAAI/AAAAAAAAADg/0AFcyvXUx0k/photo.jpg?sz=128", "display_name": "Peter Mole", "link": "https://stackoverflow.com/users/4208304/peter-mole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2788, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1599855739, "creation_date": 1522220647, "last_edit_date": 1531161705, "question_id": 49528106, "link": "https://stackoverflow.com/questions/49528106/excel-vba-getting-a-list-of-unique-entries-across-various-columns-and-combine", "title": "Excel VBA - Getting a list of unique entries across various columns and combine into a single column of unique items", "body": "<p>I am trying to get a list of unique data from multiple columns into a single column.</p>\n\n<p>I found the following code which works great;</p>\n\n<pre><code>RanglFilterCopy, CopyToRange:=Range(\"B1\"), Uniqe(\"A1:A6\").AdvancedFilter Action:=xue:=True\n</code></pre>\n\n<p>Source of this was (and thank you to <a href=\"https://stackoverflow.com/users/495455/jeremy-thompson\">https://stackoverflow.com/users/495455/jeremy-thompson</a> for posting): \n<a href=\"https://stackoverflow.com/questions/36044556/quicker-way-to-get-all-unique-values-of-a-column-in-vba\">Quicker way to get all unique values of a column in VBA?</a></p>\n\n<p>My issue is, I don't want to be limited to a set range (i.e. I want the range to be dynamic based on the entered data) as the range may change and I want to capture unique values across multiple columns, not just 1.</p>\n\n<p>I am thinking that I need to do something along the following lines but really am lost where to start in terms of VBA code.</p>\n\n<ol>\n<li>Get all values from Column (1) and copy to a new Column (x)</li>\n<li>Get all values from Column (2...n) and add the data to the next empty cell in Column (x) <strong>NOTE: Column selection is not sequential (i.e. May be Column 1, 4, 7 and 9 rather than 1,2,3,4,5,6,7,8,9 if that makes a difference in terms of being able to loop through a range)</strong></li>\n<li>Once all Columns (1...n) are copied across to Column (x), check Column (x), work out the unique values and transfer only these unique values to Column (y)</li>\n<li>Check Column (y) a final time to ensure there are no duplicated (if there are correct them)</li>\n<li>Clean up and get rid of everything except the original source data within the Table and Column (y) which hopefully now contains my unique values (i.e. get rid of Column (x)).</li>\n</ol>\n\n<p>Points to consider;</p>\n\n<ol>\n<li>The data is contained in \"Columns\" within a \"Table\" on a specific worksheet Example of a Column within my Table is -> <code>Range(\"Table1[StileCode]\")</code></li>\n<li>I want to specify the start cell in Column (y) to place the unique values which will be on a different worksheet to the source data.</li>\n<li>The data added to the target sheet and column, i.e. Column (y) will ideally be contained in a \"Named Range\" on the worksheet.</li>\n<li>The \"Named Range\" is used in formulas on the source worksheet via an index/match scenario (i.e. the reason I want unique values).</li>\n</ol>\n\n<p>Summary\nI want to basically dynamically create a unique list on the fly (or when I choose to run the code) which captures all the unique values at that point in time.</p>\n\n<p>I know this is a big ask but any assistance/guidance would be greatly appreciated.</p>\n\n<p>OK - Done a little homework and the following seems to work, please don't laugh, I am no VBA expert so I am imagining that the code is clunky and could most probably be achieved with less code.</p>\n\n<p>Any suggestions would be appreciated.</p>\n\n<p>I created a new workbook with Sheet1 and Sheet 2.</p>\n\n<p>The data is in columns A, B, C, D and E of Sheet1.</p>\n\n<p><img src=\"https://i.stack.imgur.com/0RCmk.png\" alt=\"Table of Data\"></p>\n\n<p>Code as follows;</p>\n\n<pre><code>Sub TestTheoryCopy()\n    Dim sourceWS As Worksheet\n    Dim targetWS As Worksheet\n    Dim sourceValues As Range\n    Dim targetRange As Range\n\n    Set sourceWS = ThisWorkbook.Sheets(\"Sheet1\")\n    Set targetWS = ThisWorkbook.Sheets(\"Sheet2\")\n\n    Dim i As Integer\n\n    Dim dataColA As Integer\n    dataColA = 1\n\n    Dim dataColC As Integer\n    dataColC = 3\n\n    Dim dataColE As Integer\n    dataColE = 5\n\n    Dim startRange As Range\n    Dim ra As Range\n\n    targetWS.Cells.Clear\n\n    For i = dataColA To dataColA\n        Set startRange = sourceWS.Range(\"A2\").Offset(0, i - 1)\n        Set ra = sourceWS.Range(startRange, sourceWS.Cells(Rows.Count, startRange.Column).End(xlUp))\n        ra.Copy\n        targetWS.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues\n    Next i\n\n    For i = dataColC To dataColC\n        Set startRange = sourceWS.Range(\"A2\").Offset(0, i - 1)\n        Set ra = sourceWS.Range(startRange, sourceWS.Cells(Rows.Count, startRange.Column).End(xlUp))\n        ra.Copy\n        targetWS.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues\n    Next i\n\n    For i = dataColE To dataColE\n        Set startRange = sourceWS.Range(\"A2\").Offset(0, i - 1)\n        Set ra = sourceWS.Range(startRange, sourceWS.Cells(Rows.Count, startRange.Column).End(xlUp))\n        ra.Copy\n        targetWS.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues\n    Next i\n\n    targetWS.Activate\n\n    RemoveBlankCells 'If blank cells are included I wanted to remove them from the dataset\n\n    Dim FoundFromColumnsRangeA As Range\n    Dim uniqueIDs As Range\n\n    Set FoundFromColumnsRangeA = Sheets(\"Sheet2\").UsedRange\n    FoundFromColumnsRangeA.Columns(1).Select\n\n    With Selection\n        .AdvancedFilter Action:=xlFilterCopy, CopyToRange:=Range(\"B1\"), Unique:=True\n    End With\n\n    Set uniqueIDs = Sheets(\"Sheet2\").UsedRange\n    FoundFromColumnsRangeA.Columns(2).Select\n\n    With Selection\n        .AdvancedFilter Action:=xlFilterCopy, CopyToRange:=Range(\"C2\"), Unique:=True\n    End With\n\n    RemoveBlankCells\n\n    Columns(\"A:B\").EntireColumn.Delete\n\nEnd Sub\n\nPrivate Sub RemoveBlankCells()\n'PURPOSE: Deletes single cells that are blank located inside a designated range\n'SOURCE: www.TheSpreadsheetGuru.com\n\nDim ws As Worksheet\nDim rng As Range\n\nSet ws = ThisWorkbook.Sheets(\"Sheet2\")\n\n'Store blank cells inside a variable\n  On Error GoTo NoBlanksFound\n    Set rng = ws.Range(\"A:A\").SpecialCells(xlCellTypeBlanks)\n  On Error GoTo 0\n\n'Delete blank cells and shift upward\n  rng.Rows.Delete Shift:=xlShiftUp\n\nExit Sub\n\n'ERROR HANLDER\nNoBlanksFound:\n  MsgBox \"No Blank cells were found\"\n\nEnd Sub\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["vba", "excel", "userform"], "comments": [{"owner": {"reputation": 583, "user_id": 7499107, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k8p4p.jpg?s=128&g=1", "display_name": "Romcel Geluz", "link": "https://stackoverflow.com/users/7499107/romcel-geluz"}, "edited": false, "score": 1, "creation_date": 1522219877, "post_id": 49527864, "comment_id": 86061244, "body": "tried to check if the values in both tb_a &amp; tb_b are integers?"}, {"owner": {"reputation": 35, "user_id": 7690026, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JmtAm.jpg?s=128&g=1", "display_name": "00253", "link": "https://stackoverflow.com/users/7690026/00253"}, "reply_to_user": {"reputation": 583, "user_id": 7499107, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k8p4p.jpg?s=128&g=1", "display_name": "Romcel Geluz", "link": "https://stackoverflow.com/users/7499107/romcel-geluz"}, "edited": false, "score": 0, "creation_date": 1522220224, "post_id": 49527864, "comment_id": 86061436, "body": "@RomcelGeluz  Yes, I double checked. I ran the code step by step and it doesn&#39;t even get into  &quot;with mainform...&quot;. Code above the &quot;with mainform&quot; will run ok."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 3, "creation_date": 1522220694, "post_id": 49527864, "comment_id": 86061705, "body": "just a note (not the solution): <code>Dim a,b as integer</code> only declares <code>b As Integer</code> but leaves <code>a As Variant</code> you need to specify a type for <b>every</b> variable."}, {"owner": {"reputation": 583, "user_id": 7499107, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k8p4p.jpg?s=128&g=1", "display_name": "Romcel Geluz", "link": "https://stackoverflow.com/users/7499107/romcel-geluz"}, "edited": false, "score": 1, "creation_date": 1522221151, "post_id": 49527864, "comment_id": 86061972, "body": "tried passing the mainForm into a variable as Object type? Like, <code>Dim objThis as object: set objThis = mainForm</code>."}, {"owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "edited": false, "score": 3, "creation_date": 1522221610, "post_id": 49527864, "comment_id": 86062279, "body": "I would suspect an unfortunate combination of having an <code>On Error Resume Next</code> somewhere in the caller module AND not having mainForm as a valid object. Put this before <code>With mainForm</code> to check: <code>On Error Goto 0 : Debug.Print mainForm.Caption</code>"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1522223971, "post_id": 49527864, "comment_id": 86063783, "body": "do you have any code in userform_intialize event?"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1522226579, "post_id": 49527864, "comment_id": 86065460, "body": "What happens if you open the UserForm and hit F5 to run it?  (i.e. Is there an error in the Initialise <code>UserForm_Initialize</code> event?)  Also, you&#39;re not <code>.Show</code>ing your UserForm?"}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1522236704, "post_id": 49531275, "comment_id": 86072913, "body": "Using <code>On Error Resume Next</code> without a proper error handling is always a very bad idea. Because it make you blind for errors but it does not prevent you from errors it just hides them."}], "tags": [], "owner": {"reputation": 35, "user_id": 7690026, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JmtAm.jpg?s=128&g=1", "display_name": "00253", "link": "https://stackoverflow.com/users/7690026/00253"}, "is_accepted": false, "score": 1, "last_activity_date": 1522230447, "creation_date": 1522230447, "answer_id": 49531275, "question_id": 49527864, "link": "https://stackoverflow.com/questions/49527864/vba-is-skipping-code-when-a-userform-reference-is-reached-attempting-to-write-t/49531275#49531275", "title": "VBA is skipping code when a userform reference is reached? Attempting to write to another wbk", "body": "<p>As AcsErno suggested in the comments, there was a <code>on error resume next</code> that I didn't notice, and it kept me from learning that the form is failing to load a <code>rowsource</code> property of a combobox.</p>\n\n<p>The <code>rowsource</code> was specified as follows:<br>\n<code>mainForm.cb_Wiresize.RowSource = wiresizesWSheet.Name &amp; \"!\" &amp; wiresizesFinalRange.Address</code>  </p>\n\n<p>The workbook that is opened to be written in also becomes active, and then the range that I specified as rowsource refers to a worksheet that doesn't exist - because I specified it only as \"worksheet + range\", instead of \"workbook + worksheet + range\".</p>\n\n<p>To expand on my question, how can I refer to the specific workbook object using the syntax posted above? I tried different formulations but none worked.</p>\n"}], "owner": {"reputation": 35, "user_id": 7690026, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JmtAm.jpg?s=128&g=1", "display_name": "00253", "link": "https://stackoverflow.com/users/7690026/00253"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522230447, "creation_date": 1522219735, "last_edit_date": 1522220555, "question_id": 49527864, "link": "https://stackoverflow.com/questions/49527864/vba-is-skipping-code-when-a-userform-reference-is-reached-attempting-to-write-t", "title": "VBA is skipping code when a userform reference is reached? Attempting to write to another wbk", "body": "<p>I'm using a userform to collect data and add it to an empty line in a workbook.\nStructure of code is as follows:</p>\n\n<ol>\n<li>Main sub <code>s_OpenWriteToTargetFile</code> is called from userform <code>mainForm</code>.</li>\n<li>It checks availability of the target workbook. </li>\n<li>It opens the target workbook. </li>\n<li>It calls sub \"<em>s_WriteLines</em>\". Everything is OK up to this point.</li>\n<li>Sub <code>s_WriteLines</code> should load textbox values from <code>mainForm</code> into various variables and paste them into the target workbook. </li>\n</ol>\n\n<p>For some reason, code execution jumps out of <code>s_WriteLines</code> as soon as it reaches <code>With MainForm...</code>, and it returns to the mother sub.</p>\n\n<p><strong>s_WriteLines sub</strong> </p>\n\n<pre><code>Sub s_WriteLines  \n    Dim a,b as integer    \n\n    With mainForm    \n        a = .tb_a.Value    \n        b = .tb_b.Value    \n    End With    \nEnd Sub\n</code></pre>\n\n<p>I can't wrap my head around it. Does this have something to do with the modality of the userform?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1522220025, "post_id": 49527837, "comment_id": 86061319, "body": "The same way you would with 5x2 cells or 2x5 cells on the worksheet."}, {"owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "edited": false, "score": 0, "creation_date": 1522220274, "post_id": 49527837, "comment_id": 86061469, "body": "@Jeeped I am confused! The position of the minimum value changes so I do not know how extract the positions adjacent."}, {"owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "edited": false, "score": 0, "creation_date": 1522220455, "post_id": 49527837, "comment_id": 86061580, "body": "@Jeeped I tried this:- p = Application.Match(Application.Min(arr), arr, 0)      Debug.Print p   To find the position of the minimum value but this gives me an error."}], "answers": [{"comments": [{"owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "edited": false, "score": 0, "creation_date": 1522234658, "post_id": 49528883, "comment_id": 86071529, "body": "appreciate your help but your answer is too complex for me! Not sure that I understand it. I am a newbie. I am able to find the minimum value in my array which in your example would be -3 but I want to how, once I have found the minimum value, to return the value associated with it in Col B. In your example it is 8."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "edited": false, "score": 0, "creation_date": 1522235343, "post_id": 49528883, "comment_id": 86072000, "body": "See my edit version 2. You have an array in which you loop the arr(currRow,1) which is the each row column 1 (i.e. A) and you find the minimum and retrieve the second column , arr(currRow,2) , value to get what is in column B"}, {"owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "edited": false, "score": 1, "creation_date": 1522237143, "post_id": 49528883, "comment_id": 86073196, "body": "Thank you for your patience! I have now had my aha moment and have got it. you are a scholar and a gentleman."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1522235166, "last_edit_date": 1522235166, "creation_date": 1522223399, "answer_id": 49528883, "question_id": 49527837, "link": "https://stackoverflow.com/questions/49527837/how-to-find-a-value-in-an-array/49528883#49528883", "title": "How to find a value in an array?", "body": "<p>Here is logic for one way ( note I am reading the array in from the sheet rather than having it already specified).</p>\n\n<p>I loop columns as there are less columns than rows. I seed an initial valid minimum value by taking column 1 minimum <code>Application.WorksheetFunction.Min(Application.WorksheetFunction.Index(arr, 0, 1))</code> . I set this value to that of a future column minimum if that future minimum is less than the existing.</p>\n\n<p><code>Application.WorksheetFunction.Index</code> is used to <a href=\"https://stackoverflow.com/questions/175170/how-do-i-slice-an-array-in-excel-vba\">slice</a> the array. By specifying \nIndex(array,0,1) I am slicing column wise as opposed to Index(array,1,0) which would be row wise. There are limitations on the array dimensions that will be handled by Index.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub GetMinumum()\n\nDim arr()\n\narr = ThisWorkbook.Worksheets(\"Sheet3\").Range(\"A1\").CurrentRegion.Value\n\nDim currColumn As Long\n\nDim currMinimum As Double\n\n'set starting value for comparison\ncurrMinimum = Application.WorksheetFunction.Min(Application.WorksheetFunction.Index(arr, 0, 1))\n\nFor currColumn = LBound(arr, 2) To UBound(arr, 2)\n\n    If Application.WorksheetFunction.Min(Application.WorksheetFunction.Index(arr, 0, currColumn)) &lt; currMinimum Then\n\n      currMinimum = Application.WorksheetFunction.Min(Application.WorksheetFunction.Index(arr, 0, currColumn))\n\n    End If\n\nNext currColumn\n\nDebug.Print currMinimum\n\nEnd Sub\n</code></pre>\n\n<p>Output is -3</p>\n\n<p><a href=\"https://i.stack.imgur.com/9fJGa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9fJGa.png\" alt=\"Data\"></a></p>\n\n<p>Version 2 to get adjacent value</p>\n\n<pre><code>Option Explicit\n\nPublic Sub GetMinumum()\n\n    Dim arr()\n\n    arr = ThisWorkbook.Worksheets(\"Sheet3\").Range(\"A1\").CurrentRegion.Value\n\n    Dim currRow As Long\n\n    Dim currMinimum As Double\n    currMinimum = arr(1, 1)\n    Dim outputValue As Variant\n    outputValue = vbNullString\n\n    For currRow = LBound(arr, 1) To UBound(arr, 1)\n\n        If arr(currRow, 1) &lt; currMinimum Then\n            currMinimum = arr(currRow, 1)\n            outputValue = arr(currRow, 2)\n        End If\n    Next currRow\n\n    Debug.Print outputValue\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 49528883, "answer_count": 1, "score": -1, "last_activity_date": 1522235166, "creation_date": 1522219636, "question_id": 49527837, "link": "https://stackoverflow.com/questions/49527837/how-to-find-a-value-in-an-array", "title": "How to find a value in an array?", "body": "<p>I have an array:-\nDim arr(0 To 5, 1 To 2) As Variant</p>\n\n<p>I am able to find the minimum value in the array using:-</p>\n\n<p>Debug.Print Application.Min(arr)</p>\n\n<p>How do I find the values that are populated adjacent to the minimum value?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1522219406, "post_id": 49527746, "comment_id": 86061008, "body": "Share a screen-shot of your data, and highlight the range you are trying to <code>Select</code>. B.T.W, there&#39;s no need to <code>Select</code> the range, if you want later on to <code>Copy</code> it, you can directly <code>Copy</code> the range"}, {"owner": {"reputation": 3, "user_id": 9449331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e84297dd28652711f153cce4c224fa3?s=128&d=identicon&r=PG&f=1", "display_name": "Gowtham", "link": "https://stackoverflow.com/users/9449331/gowtham"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1522219711, "post_id": 49527746, "comment_id": 86061167, "body": "Hi @ShaiRado , Thanks for replying. I don&#39;t want to copy the range. Rather I want to do something else"}, {"owner": {"reputation": 583, "user_id": 7499107, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k8p4p.jpg?s=128&g=1", "display_name": "Romcel Geluz", "link": "https://stackoverflow.com/users/7499107/romcel-geluz"}, "edited": false, "score": 0, "creation_date": 1522220046, "post_id": 49527746, "comment_id": 86061330, "body": "try doing it with <code>Set dr = Range(Selection, Cells(Rows.Count, Selection.Column).End(xlUp).End(xlToRight))</code>"}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 0, "creation_date": 1522220092, "post_id": 49527746, "comment_id": 86061356, "body": "what do you think the <code>xlToRight</code> is doing on its own there?"}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 1, "creation_date": 1522220154, "post_id": 49527746, "comment_id": 86061393, "body": "also don&#39;t post your code in a picture. Post it here"}, {"owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 0, "creation_date": 1522221599, "post_id": 49527746, "comment_id": 86062275, "body": "<code>End(xlUp)(xlToRight)</code> ? This is not valid. Use <code>End(xlUp).End(xlToRight)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522778250, "post_id": 49528424, "comment_id": 86280277, "body": "Did the above make sense or is there something further I need to add?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1522222164, "last_edit_date": 1522222164, "creation_date": 1522221717, "answer_id": 49528424, "question_id": 49527746, "link": "https://stackoverflow.com/questions/49527746/what-is-wrong-with-the-following-vba-code-related-to-range-selection/49528424#49528424", "title": "What is wrong with the following VBA Code related to range selection?", "body": "<p>If you are trying to go right and down of current selection then consider the following code.</p>\n\n<p>As you later attempt to select in sheet 1 I am going to assume you actually meant <code>Worksheet(\"Sheet1\")</code>. </p>\n\n<p>If that is the case you can more safely do the following:</p>\n\n<pre><code>Sub hi()\n\n    Dim dr As Range\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        Set dr = .Range(Selection, .Cells(.Rows.Count, Selection.Column).End(xlUp).End(xlToRight))\n\n    End With\n\n    Debug.Print dr.Address\n\nEnd Sub\n</code></pre>\n\n<p>Note:</p>\n\n<p>Bear in mind that <code>Cells</code> /<code>Range</code> without a qualifying Worksheet will use the <strong><code>Activesheet</code></strong>. See the excellent discussion here:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/36368220/is-the-in-range-necessary-when-defined-by-cells\">Is the . in .Range necessary when defined by .Cells?</a>. </p>\n\n<p>Synopsis: </p>\n\n<p>With \".\" is faster, avoids potential for error 1004 and is generally considered best practice.</p>\n"}], "owner": {"reputation": 3, "user_id": 9449331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e84297dd28652711f153cce4c224fa3?s=128&d=identicon&r=PG&f=1", "display_name": "Gowtham", "link": "https://stackoverflow.com/users/9449331/gowtham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522222164, "creation_date": 1522219309, "last_edit_date": 1522221111, "question_id": 49527746, "link": "https://stackoverflow.com/questions/49527746/what-is-wrong-with-the-following-vba-code-related-to-range-selection", "title": "What is wrong with the following VBA Code related to range selection?", "body": "<pre><code>Set dr = Range(Selection, Cells(Rows.Count, Selection.Column).End(xlUp)(xlToRight))\n</code></pre>\n\n<p>Basically, I want to select a whole range spanning across numerous rows and columns with data being populated interspersed</p>\n\n<p>It works perfectly upto Xlup. But when I add Xltoright, it doesn't take effect.</p>\n\n<p><a href=\"https://i.stack.imgur.com/nklwi.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1522217835, "creation_date": 1522217835, "answer_id": 49527384, "question_id": 49527328, "link": "https://stackoverflow.com/questions/49527328/application-defined-or-object-defined-error-when-assigning-formula/49527384#49527384", "title": "Application-defined or object-defined error when assigning formula", "body": "<p>Unless you are using the <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-formulalocal-property-excel\" rel=\"nofollow noreferrer\">.FormulaLocal</a> property, simply use EN-US syntax, functions and regional list separators with <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-formula-property-excel\" rel=\"nofollow noreferrer\">.Formula</a> or <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-formular1c1-property-excel\" rel=\"nofollow noreferrer\">.FormulaR1C1</a>. They will adjust accordingly on the worksheet.</p>\n\n<pre><code>Worksheets(\"Sheet1\").Range(\"A1\").Formula = \"=RANK(AA12, AA12:AA23)\"\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1522218292, "post_id": 49527437, "comment_id": 86060458, "body": "mmehta, please see <a href=\"https://stackoverflow.com/questions/42583139/error-1004-formulalocal-with-seerro/42584609?s=1|64.7569#42584609\">this</a> and <a href=\"https://stackoverflow.com/questions/35724156/different-languages-issue-when-inserting-formula-from-vba/35724386?s=1|0.0000#35724386\">this</a> and <a href=\"https://stackoverflow.com/questions/28557438/excel-vba-run-time-error-1004-when-inserting-or-value-formula-into-cell/28557516?s=2|0.0000#28557516\">this</a> and <a href=\"https://stackoverflow.com/questions/32319125/vba-code-string-to-cell-not-working-run-time-error-1004/32319224?s=3|0.0000#32319224\">this</a> and ... etc."}], "tags": [], "owner": {"reputation": 113, "user_id": 9558833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a49b2018447d86b03a0666881911164?s=128&d=identicon&r=PG&f=1", "display_name": "mmehta", "link": "https://stackoverflow.com/users/9558833/mmehta"}, "is_accepted": false, "score": 0, "last_activity_date": 1522218067, "creation_date": 1522218067, "answer_id": 49527437, "question_id": 49527328, "link": "https://stackoverflow.com/questions/49527328/application-defined-or-object-defined-error-when-assigning-formula/49527437#49527437", "title": "Application-defined or object-defined error when assigning formula", "body": "<p>Are you executing this code in same excel where you are writing the code?\nIf this has to be executed in different excel file then you have to mention name of excel file.\nWorkbooks().Worksheets(\"Sheet1\").Range(\"A1\").Formula = \"=RANK(AA12\" &amp; CStr(Application.International(xlListSeparator)) &amp; \"AA12:AA23)\"</p>\n"}], "owner": {"reputation": 2343, "user_id": 1203670, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/33f7f4678ffc60354d859d7bb861549d?s=128&d=identicon&r=PG", "display_name": "Snowflake", "link": "https://stackoverflow.com/users/1203670/snowflake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 49527384, "answer_count": 2, "score": 1, "last_activity_date": 1522218067, "creation_date": 1522217602, "question_id": 49527328, "link": "https://stackoverflow.com/questions/49527328/application-defined-or-object-defined-error-when-assigning-formula", "title": "Application-defined or object-defined error when assigning formula", "body": "<p>I have a small question regarding the following piece of code:</p>\n\n<pre><code>Worksheets(\"Sheet1\").Range(\"A1\").Formula = \"=RANK(AA12\" &amp; CStr(Application.International(xlListSeparator)) &amp; \"AA12:AA23)\"\n</code></pre>\n\n<p>You can safely assume that \"Sheet1\" exists. The code gives me Application-defined or object-defined when I execute the code. I was wondering what is wrong. I think my formula has been defined correctly.</p>\n"}, {"tags": ["vba", "excel", "pull"], "comments": [{"owner": {"reputation": 579, "user_id": 7471560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86af0401de69dad1bb3edd70a4920976?s=128&d=identicon&r=PG&f=1", "display_name": "LJ01", "link": "https://stackoverflow.com/users/7471560/lj01"}, "edited": false, "score": 0, "creation_date": 1522217072, "post_id": 49527134, "comment_id": 86059865, "body": "Tried adding a command to delete the data you don&#39;t need? It might save you some coding time, it won&#39;t execute as fast though"}, {"owner": {"reputation": 93, "user_id": 4964842, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2fdfc008abebd148260dcb2a34d69d22?s=128&d=identicon&r=PG&f=1", "display_name": "Apis ", "link": "https://stackoverflow.com/users/4964842/apis"}, "reply_to_user": {"reputation": 579, "user_id": 7471560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86af0401de69dad1bb3edd70a4920976?s=128&d=identicon&r=PG&f=1", "display_name": "LJ01", "link": "https://stackoverflow.com/users/7471560/lj01"}, "edited": false, "score": 0, "creation_date": 1522217517, "post_id": 49527134, "comment_id": 86060063, "body": "That solution also can. But I must do that way without editing source file. @LJ01"}, {"owner": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "edited": false, "score": 0, "creation_date": 1522218356, "post_id": 49527134, "comment_id": 86060489, "body": "Would something like this for the last statement in the For...Next loop work?  If xValue = &quot;PASS&quot; Then xArr(iRow + 1, iCol + 1) = xValue"}, {"owner": {"reputation": 93, "user_id": 4964842, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2fdfc008abebd148260dcb2a34d69d22?s=128&d=identicon&r=PG&f=1", "display_name": "Apis ", "link": "https://stackoverflow.com/users/4964842/apis"}, "edited": false, "score": 0, "creation_date": 1522229967, "post_id": 49527134, "comment_id": 86068023, "body": "I have tried but didn&#39;t work. thank you."}, {"owner": {"reputation": 579, "user_id": 7471560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86af0401de69dad1bb3edd70a4920976?s=128&d=identicon&r=PG&f=1", "display_name": "LJ01", "link": "https://stackoverflow.com/users/7471560/lj01"}, "edited": false, "score": 0, "creation_date": 1522256174, "post_id": 49527134, "comment_id": 86087599, "body": "I was thinking removing spare stuff after you copy it to your new sheet..."}], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 4964842, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2fdfc008abebd148260dcb2a34d69d22?s=128&d=identicon&r=PG&f=1", "display_name": "Apis ", "link": "https://stackoverflow.com/users/4964842/apis"}, "edited": false, "score": 0, "creation_date": 1522229930, "post_id": 49528001, "comment_id": 86067996, "body": "I have tried your query. But after the condition is &quot;FAIL&quot; and xValue is 1.654,  It pop out error &quot;Subscript out of range&quot;      xArr(iRow + 1, iCol + 1) = xValue"}], "tags": [], "owner": {"reputation": 113, "user_id": 9558833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a49b2018447d86b03a0666881911164?s=128&d=identicon&r=PG&f=1", "display_name": "mmehta", "link": "https://stackoverflow.com/users/9558833/mmehta"}, "is_accepted": true, "score": 0, "last_activity_date": 1522233987, "last_edit_date": 1522233987, "creation_date": 1522220282, "answer_id": 49528001, "question_id": 49527134, "link": "https://stackoverflow.com/questions/49527134/pull-data-from-another-workbook-with-condition/49528001#49528001", "title": "Pull data from another workbook with condition", "body": "<p>Try using the below code.</p>\n\n<pre><code>Sub Button1_Click()\nDim iLast As Long\nDim i As Long, j As Long, k As Long\nDim targetlastrow As Long, sourcelstrow As Long\nDim Sourcelastcol As Long\nDim source As Worksheet\nDim target As Worksheet\nDim InputRng As Range\nDim OutRng As Range\nDim ConRng As Range\nDim xCol As Integer\n\nSet source = Workbooks(\"workbook1\").Sheets(1)\nSet target = Workbooks(\"workbook2\").Sheets(\"Sheet1\")\nxRow = 10\nSet InputRng = source.Range(\"F2:F\" &amp; 41)\nSet InputRng = InputRng.Columns(1)\nSet ConRng = source.Range(\"C2:C\" &amp; 41)\nSet ConRng = ConRng.Columns(1)\nSet OutRng = Application.InputBox(\"Out put to (single cell):\", xTitleId, Type:=8)\nk = 0\nxCol = InputRng.Cells.Count / xRow\nReDim xArr(1 To xRow, 1 To xCol + 1)\n    For i = 0 To InputRng.Cells.Count - 1\n        xValue = InputRng.Cells(i + 1)\n        xCon = ConRng.Cells(i + 1)\n        If xCon = \"PASS\" Then\n            iRow = k Mod xRow\n            iCol = VBA.Int(k / xRow)\n            xArr(iRow + 1, iCol + 1) = xValue\n        Else\n            k = k - 1\n        End If\n        k = k + 1\n    Next\n    OutRng.Resize(UBound(xArr, 1), UBound(xArr, 2)).Value = xArr\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 4964842, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2fdfc008abebd148260dcb2a34d69d22?s=128&d=identicon&r=PG&f=1", "display_name": "Apis ", "link": "https://stackoverflow.com/users/4964842/apis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 49528001, "answer_count": 1, "score": 1, "last_activity_date": 1522233987, "creation_date": 1522216764, "last_edit_date": 1522217077, "question_id": 49527134, "link": "https://stackoverflow.com/questions/49527134/pull-data-from-another-workbook-with-condition", "title": "Pull data from another workbook with condition", "body": "<p>I'm trying to pull data from workbook1 into workbook2 which satisfied certain condition from workbook1. Below is my code.</p>\n\n<pre><code>Sub Button1_Click()\nDim iLast As Long\nDim i As Long, j As Long\nDim targetlastrow As Long, sourcelstrow As Long\nDim Sourcelastcol As Long\nDim source As Worksheet\nDim target As Worksheet\nDim InputRng As Range\nDim OutRng As Range\nDim xCol As Integer\n\nSet source = Workbooks(\"workbook1\").Sheets(1)\nSet target = Workbooks(\"workbook2\").Sheets(\"Sheet1\")\nxRow = 10\nSet InputRng = source.Range(\"F2:F\" &amp; 41)\nSet InputRng = InputRng.Columns(1)\nSet OutRng = Application.InputBox(\"Out put to (single cell):\", xTitleId, Type:=8)\n\nxCol = InputRng.Cells.Count / xRow\nReDim xArr(1 To xRow, 1 To xCol + 1)\n    For i = 0 To InputRng.Cells.Count - 1\n        xValue = InputRng.Cells(i + 1)\n        iRow = i Mod xRow\n        iCol = VBA.Int(i / xRow)\n        xArr(iRow + 1, iCol + 1) = xValue\n    Next\n    OutRng.Resize(UBound(xArr, 1), UBound(xArr, 2)).Value = xArr\nEnd Sub\n</code></pre>\n\n<p>This is sample output workbook2</p>\n\n<p><a href=\"https://i.stack.imgur.com/7OIV1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7OIV1.png\" alt=\"enter image description here\"></a></p>\n\n<p>Sample data from workbook1</p>\n\n<p><a href=\"https://i.stack.imgur.com/HrKc8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HrKc8.png\" alt=\"enter image description here\"></a></p>\n\n<p>Currently I managed to pull all first 40 data from workbook1:Column F. But I'm trying to pull the first 40 data with only PASS condition. Refer to Workbook1 column C. </p>\n\n<p>Please help. I'm new using this vba.</p>\n"}, {"tags": ["vba", "excel", "random"], "comments": [{"owner": {"reputation": 579, "user_id": 7471560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86af0401de69dad1bb3edd70a4920976?s=128&d=identicon&r=PG&f=1", "display_name": "LJ01", "link": "https://stackoverflow.com/users/7471560/lj01"}, "edited": false, "score": 0, "creation_date": 1522216880, "post_id": 49527093, "comment_id": 86059772, "body": "Could you sort both alphabetically then adapt =Rand() formula to randomise selection?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522216903, "post_id": 49527093, "comment_id": 86059779, "body": "why would you need VBA?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522217413, "post_id": 49527093, "comment_id": 86060012, "body": "Take your pick of off the shelf  (code and formula) solutions google gives immediately:  <a href=\"https://answers.microsoft.com/en-us/msoffice/forum/msoffice_excel-mso_winother-mso_2013_release/vba-code-for-generate-random-number-between-2/f662cdd8-a101-46a4-aeb8-fde4942f8985\" rel=\"nofollow noreferrer\">answers.microsoft.com/en-us/msoffice/forum/&hellip;</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1522217559, "post_id": 49527093, "comment_id": 86060085, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/2884972/repeating-random-variables-in-vba\">Repeating random variables in VBA</a>    Just set two ranges (1 for boy, 1 for girl)"}], "answers": [{"tags": [], "owner": {"reputation": 1747, "user_id": 3952933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f45c3dd484d7d4b84cc94cbed15cef2?s=128&d=identicon&r=PG&f=1", "display_name": "Aritesh", "link": "https://stackoverflow.com/users/3952933/aritesh"}, "is_accepted": false, "score": 0, "last_activity_date": 1522216939, "creation_date": 1522216939, "answer_id": 49527166, "question_id": 49527093, "link": "https://stackoverflow.com/questions/49527093/how-to-draw-a-pair-of-boy-and-a-girl-in-a-competition-excel-vba/49527166#49527166", "title": "how to draw a pair of boy and a girl in a competition excel vba", "body": "<p>You can do it without VBA as well - </p>\n\n<p>see the formula in screenshot - </p>\n\n<p><a href=\"https://i.stack.imgur.com/Ip5z5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ip5z5.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1522239024, "post_id": 49527396, "comment_id": 86074578, "body": "Had to +1 this as it&#39;s a completely over the top answer to a question that&#39;ll probably be closed. :)"}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 2, "last_activity_date": 1522232894, "last_edit_date": 1522232894, "creation_date": 1522217908, "answer_id": 49527396, "question_id": 49527093, "link": "https://stackoverflow.com/questions/49527093/how-to-draw-a-pair-of-boy-and-a-girl-in-a-competition-excel-vba/49527396#49527396", "title": "how to draw a pair of boy and a girl in a competition excel vba", "body": "<p>This is overkill, but I slapped it together just together just for fun.  It selects a random name from any number of lists (one per column) including colors and sound while choosing.</p>\n\n<p><sup>I just hit double-backspace while about to submit my edit, losing it all, so this is the short version -  less information and links.</sup></p>\n\n<p><a href=\"https://i.stack.imgur.com/h9rMh.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/h9rMh.gif\" alt=\"img\"></a></p>\n\n<pre><code>Option Explicit  'always use this!\n\nConst shtName = \"RandVBA\" 'name of worksheet\nConst cellRange = \"B5:C14\" 'cell range (each column gets separate selection)\n\nPublic Declare Function Beep Lib \"kernel32\" _\n   (ByVal dwFreq As Long, _\n    ByVal dwDuration As Long) As Long\n\n\nSub chooseRandomColumns()\n    'selects a random cells from each column in range, with colors and sound\n\n    Randomize\n    Dim cr As Range, col As Range, x As Long, n As Long, winners As String\n    Set cr = Sheets(shtName).Range(cellRange)\n\n    For x = 1 To 20\n        cr.Cells.Interior.Color = RGB(255, 255, 255) 'reset background colors\n        winners = \"\" 'erase winners names\n        For Each col In cr.Columns\n            n = Int(Rnd() * cr.Rows.Count) + cr.Row 'pick random cell in column\n            Sheets(shtName).Cells(n, col.Column).Interior.Color = _\n                RGB(Int(Rnd() * 256), Int(Rnd() * 256), Int(Rnd() * 256)) 'random color\n            winners = winners &amp; \" - \" &amp; Sheets(shtName).Cells(n, col.Column) &amp; vbLf\n        Next col\n\n        Beep Int(Rnd() * 2000) + 300, 125 'random beep 125ms/300-2300Hz\n        DoEvents 'catch-up\n    Next x\n\n    MsgBox \"The winners are:\" &amp; vbLf &amp; vbLf &amp; winners, vbExclamation, \"Winners!\"\n\nEnd Sub\n</code></pre>\n\n<p><strong>Download</strong> sample <code>.XLSM</code> workbook with these examples <a href=\"https://storage.jumpshare.com/download/ri6poZ8xQE2lhY4llyWarhYu52OqzcFtOFRz53srU7A73SMV6qGraZr3qvKebZwepwn8eVHqDjeIQHzkFPoNfQ\" rel=\"nofollow noreferrer\">here</a>.  (File contains VBA/Macros so you may get a security warning when opening.)</p>\n\n<hr>\n\n<h1>Pick randomly from a list Without Excel</h1>\n\n<p><strong>You can also do this online (completely without Excel) using <a href=\"https://www.random.org/lists/\" rel=\"nofollow noreferrer\">RANDOM.ORG</a>.</strong> </p>\n\n<p><a href=\"https://i.stack.imgur.com/QGWUh.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QGWUh.gif\" alt=\"img\"></a></p>\n\n<hr>\n\n<h1>Pick randomly from a list with Excel (No VBA)</h1>\n\n<p><a href=\"https://i.stack.imgur.com/6X9d4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6X9d4.png\" alt=\"img\"></a></p>\n\n<p><strong>Formula in <code>C3</code>:</strong>  </p>\n\n<pre><code>=OFFSET(C5,RAND()*10,0)\n</code></pre>\n\n<p><strong>Formula in <code>D3</code>:</strong></p>\n\n<pre><code>=OFFSET(D5,RAND()*10,0)\n</code></pre>\n\n<hr>\n\n<h2>More Information:</h2>\n\n<ul>\n<li><p><strong><a href=\"https://support.office.com/en-us/article/offset-function-c8de19ae-dd79-4b9b-a14e-b4d906d11b66\" rel=\"nofollow noreferrer\">Offset Function</a> (Excel)</strong></p></li>\n<li><p><strong><a href=\"https://support.office.com/en-us/article/rand-function-4cbfa695-8869-4788-8d90-021ea9f5be73\" rel=\"nofollow noreferrer\">Rand Function</a> (Excel)</strong></p></li>\n</ul>\n"}], "owner": {"reputation": 71, "user_id": 5866783, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b84666cb4d9b38d8a9aa79f2bde7d659?s=128&d=identicon&r=PG&f=1", "display_name": "rakesh  seebaruth", "link": "https://stackoverflow.com/users/5866783/rakesh-seebaruth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1537113912, "creation_date": 1522216543, "last_edit_date": 1537113912, "question_id": 49527093, "link": "https://stackoverflow.com/questions/49527093/how-to-draw-a-pair-of-boy-and-a-girl-in-a-competition-excel-vba", "title": "how to draw a pair of boy and a girl in a competition excel vba", "body": "<p>I have 20 kids composing of 10 boys in column A and 10 girls in Column B . I need excel vba to choose a pair of boy and girl at random  for the 20 kids.</p>\n\n<p>thanks</p>\n"}, {"tags": ["excel", "vba", "ms-word", "ole"], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1522220213, "creation_date": 1522220213, "answer_id": 49527982, "question_id": 49527056, "link": "https://stackoverflow.com/questions/49527056/error-when-using-find-replace-method-in-an-embedded-word-document-in-excel-vba/49527982#49527982", "title": "Error when using find/replace method in an embedded Word document in Excel VBA", "body": "<p>The issue here is that the <code>OLEObjects</code> has no <code>.Content</code> property. That is also what the error tells you.</p>\n\n<p>Therefore you have to use <code>oDoc.Object.Content.Find</code> instead. And you don't need to <code>oDoc.Activate</code> the document, it will also work without.</p>\n\n<p>The following should work:</p>\n\n<pre><code>Public Sub ReplaceTextinOLEObject\n    Dim oDoc As OLEObject\n    Set oDoc = Worksheets(\"Sheet1\").OLEObjects(\"Rec1\")\n    'oDoc.Activate 'remove this line, activate is not needed here\n    With oDoc.Object.Content.Find\n        .ClearFormatting\n        .Text = \"hi\"\n        .Replacement.ClearFormatting\n        .Replacement.Text = \"hello\"\n        .Execute Replace:=wdReplaceAll, Forward:=True, Wrap:=wdFindContinue\n    End With\n    Word.Application.Quit wdDoNotSaveChanges\nEnd Sub\n</code></pre>\n\n<p><em>Note: Of course the \"Microsoft Word 16.0 Object Library\" (version may vary) needs to be referenced to run this code.</em></p>\n"}], "owner": {"reputation": 434, "user_id": 9075944, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/1cfe5b6b167756a9d0b83c40cf631bdf?s=128&d=identicon&r=PG&f=1", "display_name": "Tuberose", "link": "https://stackoverflow.com/users/9075944/tuberose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 290, "favorite_count": 0, "accepted_answer_id": 49527982, "answer_count": 1, "score": 1, "last_activity_date": 1549013892, "creation_date": 1522216392, "last_edit_date": 1549013892, "question_id": 49527056, "link": "https://stackoverflow.com/questions/49527056/error-when-using-find-replace-method-in-an-embedded-word-document-in-excel-vba", "title": "Error when using find/replace method in an embedded Word document in Excel VBA", "body": "<p>I have an embedded word document in my worksheet, names <code>\"Rec1\"</code></p>\n\n<p>So using before:</p>\n\n<pre><code>Sub ReplaceTextinOLEObject\n    Dim oDoc As OLEObject\n    Set oDoc = Worksheets(\"Sheet1\").OLEObjects(\"Rec1\")\n    oDoc.Activate\n    With oDoc.Content.Find\n        .ClearFormatting\n        .Text = \"hi\"\n        .Replacement.ClearFormatting\n        .Replacement.Text = \"hello\"\n        .Execute Replace:=wdReplaceAll, Forward:=True, Wrap:=wdFindContinue\n    End With\n    Word.Application.Quit wdDoNotSaveChanges\nEnd Sub\n</code></pre>\n\n<p>When perform running above, the <code>With</code> part committed below error:</p>\n\n<blockquote>\n  <p>Run-time error '438':<br>\n  object doesn't support this property or method</p>\n</blockquote>\n\n<p>What is the problem of the using <code>Find</code> object for OLE embedded word documents?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 348, "user_id": 6268900, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10204696681176720/picture?type=large", "display_name": "Praveen DA", "link": "https://stackoverflow.com/users/6268900/praveen-da"}, "edited": false, "score": 0, "creation_date": 1522213679, "post_id": 49526459, "comment_id": 86058549, "body": "Smallest value of which column.. &#39;min(A1:S10)&#39; is the you have use"}, {"owner": {"reputation": 1, "user_id": 9561817, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "eric choi", "link": "https://stackoverflow.com/users/9561817/eric-choi"}, "reply_to_user": {"reputation": 348, "user_id": 6268900, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10204696681176720/picture?type=large", "display_name": "Praveen DA", "link": "https://stackoverflow.com/users/6268900/praveen-da"}, "edited": false, "score": 0, "creation_date": 1522250937, "post_id": 49526459, "comment_id": 86084063, "body": "Sorry, mates. I forgot to mention that the data set have 12457 rows of data.It just a part of it. Here is another capture of my data set. (btw, can anyone tell me how i can post the table here instead of capturing it?)"}], "answers": [{"tags": [], "owner": {"reputation": 640, "user_id": 5323498, "user_type": "registered", "profile_image": "https://graph.facebook.com/957949454262350/picture?type=large", "display_name": "Adisak Anusornsrirung", "link": "https://stackoverflow.com/users/5323498/adisak-anusornsrirung"}, "is_accepted": false, "score": 0, "last_activity_date": 1522214319, "creation_date": 1522214319, "answer_id": 49526622, "question_id": 49526459, "link": "https://stackoverflow.com/questions/49526459/excel-giving-the-smallest-value-between-2-values/49526622#49526622", "title": "(Excel) Giving the smallest value between 2 values", "body": "<p>Simply put the formula '=Min(D77:D84)' in cell P77\nand '=Min(D84:D97)' in cell P84</p>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 2, "last_activity_date": 1522256841, "last_edit_date": 1522256841, "creation_date": 1522215987, "answer_id": 49526965, "question_id": 49526459, "link": "https://stackoverflow.com/questions/49526459/excel-giving-the-smallest-value-between-2-values/49526965#49526965", "title": "(Excel) Giving the smallest value between 2 values", "body": "<p>There are lots of functions/ways to calculate Minimum in addition to the <code>MIN</code> function and it is <strong>worth</strong> being familiar with them as you will require different ones according to your data.</p>\n\n<p>So quick rundown of some of the main offerings:</p>\n\n<p><strong>SMALL function:</strong> </p>\n\n<p>I would consider also the more versatile <a href=\"https://support.office.com/en-us/article/small-function-17da8222-7c82-42b2-961b-14c45384df07\" rel=\"nofollow noreferrer\">SMALL</a> function</p>\n\n<p><code>=SMALL(D77:D84,1)</code> in cell P77 </p>\n\n<p><code>=SMALL(D84:D97,1)</code> in cell P84</p>\n\n<p>You put the array (the range of cells to compare) then the k-th smallest item in that range that you want to retrieve e.g. put 1 to get the smallest, as above, comparable to MIN function, or 2 to get the second smallest etc.</p>\n\n<p>Official blurb below:</p>\n\n<blockquote>\n  <p>Description</p>\n  \n  <p>Returns the k-th smallest value in a data set. Use this function to\n  return values with a particular relative standing in a data set.</p>\n  \n  <p>Syntax</p>\n  \n  <p>SMALL(array, k)</p>\n  \n  <p>The SMALL function syntax has the following arguments:</p>\n  \n  <p>Array    Required. An array or range of numerical data for which you\n  want to determine the k-th smallest value.</p>\n  \n  <p>K    Required. The position (from the smallest) in the array or range\n  of data to return.</p>\n</blockquote>\n\n<p><strong>AGGREGATE Function:</strong></p>\n\n<p>Consider the even more versatile <a href=\"https://support.office.com/en-us/article/aggregate-function-43b9278e-6aa7-4f17-92b6-e19993fa26df\" rel=\"nofollow noreferrer\">AGGREGATE</a> function which can cope with hidden rows in the range, errors etc. You can specify a host of additional requirements whilst still getting the minimum value</p>\n\n<p>General syntax for first form:</p>\n\n<blockquote>\n  <p>AGGREGATE(function_num, options, ref1, [ref2], \u2026)</p>\n</blockquote>\n\n<p>Function 5 is Minimum.  Options are viewable at link I gave but 7 is ignore errors and hidden rows. So, you could use:</p>\n\n<pre><code>=AGGREGATE(5,7,D77:D84)\n</code></pre>\n\n<p>The AGGREGATE option above is the only version that will still return the minimum correctly if there is an error in the range D77:D84 e.g. a DIV/0 error.</p>\n\n<p><strong>SUBTOTAL Function:</strong></p>\n\n<p>Similar to the AGGREGATE function is the <a href=\"https://support.office.com/en-ie/article/subtotal-function-7b027003-f060-4ade-9040-e478765b9939\" rel=\"nofollow noreferrer\">SUBTOTAL</a> function.</p>\n\n<p>You can use <code>SUBTOTAL(5, D77:D84)</code> where 5 specifies you want the minimum for the range. This will not ignore errors. SUBTOTAL(105,D77:D84) will ignore hidden rows though.</p>\n"}], "owner": {"reputation": 1, "user_id": 9561817, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "eric choi", "link": "https://stackoverflow.com/users/9561817/eric-choi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1522256841, "creation_date": 1522213423, "last_edit_date": 1522251319, "question_id": 49526459, "link": "https://stackoverflow.com/questions/49526459/excel-giving-the-smallest-value-between-2-values", "title": "(Excel) Giving the smallest value between 2 values", "body": "<p><a href=\"https://i.stack.imgur.com/CPzHd.png\" rel=\"nofollow noreferrer\">Excel data table</a></p>\n\n<p>I am new to here. If I have any mistake in making new post, Please tell me and I am ready to correct my mistake.</p>\n\n<p>For above pic, I want to extract the 2 smallest values in column D respectively between row 77 and row 84, and between row 84 and 97. The resulting values are shown in P77 and P84 respectively.</p>\n\n<p>How should I write the excel formula for it? Or it needs VBA to code it?</p>\n\n<p>Thanks a lot for your sincere help!</p>\n\n<p>(Update)\n<a href=\"https://i.stack.imgur.com/Ke1nG.png\" rel=\"nofollow noreferrer\">data set</a>\nabove pic is another capture of my data set which filtered the day with \"Bullish breaking candle/bearish breaking candle\" only.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522212355, "post_id": 49525847, "comment_id": 86058155, "body": "...and <i>of course</i> you have a recent backup of the file, <i>right?</i>  No?  What would you do if it was the entire file that had gone corrupt today?  (I know, this won&#39;t solve today&#39;s problem... but hopefully today&#39;s issue will trigger you to start backing up.  We all need to learn the hard way, and thankfully it&#39;s nothing major this time!)  :-)"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522212534, "post_id": 49525847, "comment_id": 86058203, "body": "Can you give a little more detail of what yo mean by &quot;changing the Y-Axis&quot;?  Doesn&#39;t the chart&#39;s <code>Auto</code> Min/Max scale setting work?"}, {"owner": {"reputation": 147, "user_id": 9446506, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-ysBC7WQsCUI/AAAAAAAAAAI/AAAAAAAAFPw/OFpVp5M12OI/photo.jpg?sz=128", "display_name": "Remi", "link": "https://stackoverflow.com/users/9446506/remi"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522212670, "post_id": 49525847, "comment_id": 86058245, "body": "@ashleedawg it&#39;s a waterfall chart so auto scaling makes it illegible most of the time. Right now, I have assigned the macro by having it run when you click the chart. But I thought this could work another way with just a tweak."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1522213302, "post_id": 49525847, "comment_id": 86058446, "body": "A waterfall chart can be a bit finicky to setup, but once it&#39;s setup correctly, you shouldn&#39;t need to adjust every time the data changes,  Is the issue that your data includes totals that need to be represented on the chart?"}, {"owner": {"reputation": 147, "user_id": 9446506, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-ysBC7WQsCUI/AAAAAAAAAAI/AAAAAAAAFPw/OFpVp5M12OI/photo.jpg?sz=128", "display_name": "Remi", "link": "https://stackoverflow.com/users/9446506/remi"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522213410, "post_id": 49525847, "comment_id": 86058478, "body": "@ashleedawg Yep, that is the issue. Throws everything off."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522213768, "post_id": 49525847, "comment_id": 86058583, "body": "Have you got the data point(s) for the total(s) &quot;<b>Set as Total</b>&quot;? (See the <a href=\"https://support.office.com/en-us/article/create-a-waterfall-chart-in-office-2016-8de1ece4-ff21-4d37-acd7-546f5527f185\" rel=\"nofollow noreferrer\"><code>Start totals or subtotals from..</code> section here</a>.  The only reason you should need to change the Upper/Lower bounds is to <b><i>exclude</i></b> data (outside of adjustment for totals). Make sure to <code>Reset</code> the Axis bounds and then Excel will automatically <i>include</i> the entire range (in any chart) if it&#39;s setup properly - which is usually by default. It might be as simple as creating a new chart."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1522213946, "post_id": 49525847, "comment_id": 86058628, "body": "Also see the &quot;Identifying the totals&quot; section of <a href=\"https://peltiertech.com/new-waterfall-chart-excel-2016/\" rel=\"nofollow noreferrer\">this page</a>."}], "owner": {"reputation": 147, "user_id": 9446506, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-ysBC7WQsCUI/AAAAAAAAAAI/AAAAAAAAFPw/OFpVp5M12OI/photo.jpg?sz=128", "display_name": "Remi", "link": "https://stackoverflow.com/users/9446506/remi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1522213103, "creation_date": 1522209447, "last_edit_date": 1531164843, "question_id": 49525847, "link": "https://stackoverflow.com/questions/49525847/y-axis-auto-scaling-module-not-activating-on-change", "title": "Y-Axis Auto-Scaling Module Not Activating On Change", "body": "<p>My code for scaling the Y-Axis on a waterfall chart was working perfectly yesterday yet does nothing today.\nIf it does not scale, the chart is pretty much illegible because the projects being compared can vary by thousands to millions of dollars.\nIt monitors the minimum and max values in static cells and changes the scale based on the code below.\nI know the change event is the correct one as it was working yesterday.\nCould I ensure that it always runs without resorting to using a button?\nThere is no error message either when I run it.</p>\n\n<pre><code>  Option Explicit\n        Sub ChangeAxisScales_Calculate()\n           Dim objCht As ChartObject\n           For Each objCht In Sheets(\"Price Bridge Chart\").ChartObjects\n              With objCht.Chart\n                 ' Value (Y) Axis\n                 With .Axes(xlValue)\n                    .MaximumScale = ActiveSheet.Range(\"L34\").Value + 2000000 \n                    .MinimumScale = ActiveSheet.Range(\"K34\").Value - 2000000 \n                    MsgBox \"Max = \" &amp; .MaximumScale '- For Error Checking\n                    MsgBox \"Min = \" &amp; .MinimumScale ' - For Error Checking\n                    .MajorUnit = 250000 'Chart horizontal lines\n                    End With\n              End With\n           Next objCht\n        End Sub\n</code></pre>\n"}, {"tags": ["excel", "ms-access", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 1235, "user_id": 736694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a653dd4c531fe67209cee664848722b?s=128&d=identicon&r=PG", "display_name": "Yserbius", "link": "https://stackoverflow.com/users/736694/yserbius"}, "edited": false, "score": 0, "creation_date": 1522207729, "post_id": 49525587, "comment_id": 86057001, "body": "I&#39;m not really sure what you&#39;re asking. The query you posted having an issue with is the exact same one as the one in your code. What&#39;s the problem? What errors are you getting?"}, {"owner": {"reputation": 13, "user_id": 9403427, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5e68680111e855e1448c16a6e7b88129?s=128&d=identicon&r=PG&f=1", "display_name": "Accexcessel", "link": "https://stackoverflow.com/users/9403427/accexcessel"}, "reply_to_user": {"reputation": 1235, "user_id": 736694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a653dd4c531fe67209cee664848722b?s=128&d=identicon&r=PG", "display_name": "Yserbius", "link": "https://stackoverflow.com/users/736694/yserbius"}, "edited": false, "score": 0, "creation_date": 1522207933, "post_id": 49525587, "comment_id": 86057063, "body": "I&#39;m trying to import C_Paso2_SM_Cuplas but the code imports C_Paso1_SM_Cuplas!! See the difference: I need Paso2 and it imports Paso1. When I import Tables instead of Queries it works fine"}, {"owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "edited": false, "score": 0, "creation_date": 1522208624, "post_id": 49525587, "comment_id": 86057236, "body": "Are there any records in <code>C_Paso2_SM_Cuplas</code>?   Add <code>rs.Close</code>, <code>Set rs = Nothing</code>, <code>cn.Close</code>, and <code>Set cn = Nothing</code> before <code>End Sub</code>."}, {"owner": {"reputation": 13, "user_id": 9403427, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5e68680111e855e1448c16a6e7b88129?s=128&d=identicon&r=PG&f=1", "display_name": "Accexcessel", "link": "https://stackoverflow.com/users/9403427/accexcessel"}, "edited": false, "score": 0, "creation_date": 1522209174, "post_id": 49525587, "comment_id": 86057348, "body": "No, there is just one C_Paso2_SM_Cuplas. But the data pasted in data_sht is the one from C_Paso1_SM_Cuplas"}, {"owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "edited": false, "score": 1, "creation_date": 1522213685, "post_id": 49525587, "comment_id": 86058552, "body": "Can your code show the headers of <code>C_Paso2_SM_Cuplas</code>?"}, {"owner": {"reputation": 13, "user_id": 9403427, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5e68680111e855e1448c16a6e7b88129?s=128&d=identicon&r=PG&f=1", "display_name": "Accexcessel", "link": "https://stackoverflow.com/users/9403427/accexcessel"}, "edited": false, "score": 0, "creation_date": 1522374685, "post_id": 49525587, "comment_id": 86143181, "body": "The headers are normal things like &quot;Cost&quot;, &quot;Quantity&quot; and things like that"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9403427, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5e68680111e855e1448c16a6e7b88129?s=128&d=identicon&r=PG&f=1", "display_name": "Accexcessel", "link": "https://stackoverflow.com/users/9403427/accexcessel"}, "edited": false, "score": 0, "creation_date": 1522374780, "post_id": 49547880, "comment_id": 86143207, "body": "I will be able to try it on Tuesday. But why do you need a password? It&#39;s an Access file. Will it work in a .accdb instead of a .mdb? Thanks"}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "reply_to_user": {"reputation": 13, "user_id": 9403427, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5e68680111e855e1448c16a6e7b88129?s=128&d=identicon&r=PG&f=1", "display_name": "Accexcessel", "link": "https://stackoverflow.com/users/9403427/accexcessel"}, "edited": false, "score": 0, "creation_date": 1522376607, "post_id": 49547880, "comment_id": 86143593, "body": "That&#39;s just an example.  If you don&#39;t need a password, just leave it out.  You can find all kinds of connection strings for Access using the link below.   <a href=\"https://www.connectionstrings.com/access/\" rel=\"nofollow noreferrer\">connectionstrings.com/access</a>"}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1522296507, "creation_date": 1522296507, "answer_id": 49547880, "question_id": 49525587, "link": "https://stackoverflow.com/questions/49525587/copy-query-from-access-to-excel/49547880#49547880", "title": "Copy Query from Access to Excel", "body": "<p>Try this DAO solution.</p>\n\n<pre><code>Sub ImportFromAccessToExcel()\n\n    Dim db1 As Database\n    Dim db2 As Database\n    Dim recSet As Recordset\n    Dim strConnect As String\n\n    Set db1 = OpenDatabase(\"C:\\Database1.mdb\")\n    strConnect = db1.QueryDefs(\"Query3\").Connect _\n    &amp; \"DSN=myDsn;USERNAME=myID;PWD=myPassword\"\n\n    Set db2 = OpenDatabase(\"\", False, False, strConnect)\n    db2.Close\n    Set db2 = Nothing\n\n    Set recSet = db1.OpenRecordset(\"Query3\")\n\n    With ActiveSheet.QueryTables.Add(Connection:=recSet, Destination:=Range(\"$A$4\"))\n        .Name = \"Connection\"\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .BackgroundQuery = True\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .PreserveColumnInfo = True\n        .Refresh BackgroundQuery:=False\n\n    End With\n\n    recSet.Close\n    db1.Close\n    Set recSet = Nothing\n    Set db1 = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9403427, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5e68680111e855e1448c16a6e7b88129?s=128&d=identicon&r=PG&f=1", "display_name": "Accexcessel", "link": "https://stackoverflow.com/users/9403427/accexcessel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522307386, "creation_date": 1522207492, "last_edit_date": 1531161705, "question_id": 49525587, "link": "https://stackoverflow.com/questions/49525587/copy-query-from-access-to-excel", "title": "Copy Query from Access to Excel", "body": "<p>I'm having some problems when I try to import a Query from Access to Excel. </p>\n\n<p>Some days ago I programmed a code (with some help of Google haha) to import a Table from Access to Excel:</p>\n\n<pre><code>Sub importQuery(DBFullName As String, data_sht As Worksheet)\n\n     Dim cn As Object, rs As Object\n\n     Dim i As Integer\n\n     Dim TargetRange As Range\n\n     Dim rows As Long, cols As Long\n\n     Dim dataEmpty As Boolean\n\n     Dim lastColString As String\n\n\n\n     data_sht.Activate   \n\n     Application.ScreenUpdating = False\n\n     Set TargetRange = data_sht.Range(\"A1\")\n\n     Set cn = CreateObject(\"ADODB.Connection\")\n\n     cn.Open \"Provider=Microsoft.Ace.OLEDB.12.0; Data Source=\" &amp; DBFullName &amp; \";\" 'the Access file is .accdb\n\n\n     Set rs = CreateObject(\"ADODB.Recordset\")\n\n     rs.Open \"SELECT * FROM C_Paso2_SM_Cuplas\", cn, , , adCmdUnspecified\n\n     cols = rs.Fields.Count\n\n     rows = data_sht.Range(\"A\" &amp; data_sht.rows.Count).End(xlUp).Row \n\n     ' Copy titles of the Access Query\n\n     For i = 0 To (cols - 1)\n\n         TargetRange.Offset(0, i).Value = rs.Fields(i).Name\n\n     Next\n\n     ' Copy data\n\n     TargetRange.Offset(1, 0).CopyFromRecordset rs\nEnd Sub\n</code></pre>\n\n<p>That code works but when I do this: </p>\n\n<pre><code>rs.Open \"SELECT * FROM C_Paso2_SM_Cuplas\", cn, , , adCmdUnspecified\n</code></pre>\n\n<p>I'm importing another Query called C_Paso<strong>1</strong>_SM_Cuplas, from the same file. What can I do? Why am I importing C_Paso<strong>1</strong>_SM_Cuplas when I say C_Paso<strong>2</strong>_SM_Cuplas? Is there other possibility to import an Access Query to Excel?</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 9531726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bab87df50add1a391bd7ab25480e3a84?s=128&d=identicon&r=PG&f=1", "display_name": "user9531726", "link": "https://stackoverflow.com/users/9531726/user9531726"}, "edited": false, "score": 0, "creation_date": 1522275257, "post_id": 49526900, "comment_id": 86097726, "body": "FoxFire and you, Kathrine, have answered similarly to one another as well as answered my question.  In my case I was frustrated to realize several queries are same and I do not want to use the tables directly.  As silly as it may sound I will be naming the query similar to the table and not as the form I am using it in. This way I can use it again and again  in my case.. &quot;qryLogIn&quot;   Sounds logic but for &quot;beginners&quot; sometimes it is not obvious that their nose is midway between their ears.  I will select your answer. FoxFire has enough points. do not spend it all at once.:)"}], "tags": [], "owner": {"reputation": 421, "user_id": 9493203, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6FCFL.jpg?s=128&g=1", "display_name": "Katerine459", "link": "https://stackoverflow.com/users/9493203/katerine459"}, "is_accepted": true, "score": 1, "last_activity_date": 1522215669, "creation_date": 1522215669, "answer_id": 49526900, "question_id": 49525117, "link": "https://stackoverflow.com/questions/49525117/dlookup-query-vs-table-in-ms-access-vba/49526900#49526900", "title": "DLookup: query vs. table in MS Access VBA?", "body": "<p>In DLookup? I've never encountered a difference. Pretty sure performance is the same. The advantages I can think of to using a query are unrelated to performance:</p>\n\n<ul>\n<li>Simplicity: if, for example, you later decide to have something like an \"Active\" flag in the table, and you want everything that references the table to filter out \"inactive\" records, you can just change the query.</li>\n<li>Security: this is more if the tables are in a linked server, but you may not want to reference the tables directly.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "is_accepted": false, "score": 1, "last_activity_date": 1522228739, "creation_date": 1522228739, "answer_id": 49530618, "question_id": 49525117, "link": "https://stackoverflow.com/questions/49525117/dlookup-query-vs-table-in-ms-access-vba/49530618#49530618", "title": "DLookup: query vs. table in MS Access VBA?", "body": "<p>First of all, your question should say <strong>that you mean using <code>DLookUp</code>.</strong></p>\n\n<p>Second, in the case of DLookup, no, there is no difference.</p>\n\n<p>But to be honest, just in that case. Queries are, with no doubt, more helpful to work with. Queries allow you to call for data in the way you want, sorted, with different parameters, grouping data (even from different tables).</p>\n\n<p>To make it really simple, a table is like a store, where you save your goodies, and the query would be like a smart worker that gets for you in seconds the info the customer needs (or the boss), and this worker can adapt to any need.</p>\n\n<p>That's my POV, anyways.</p>\n"}], "owner": {"reputation": 23, "user_id": 9531726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bab87df50add1a391bd7ab25480e3a84?s=128&d=identicon&r=PG&f=1", "display_name": "user9531726", "link": "https://stackoverflow.com/users/9531726/user9531726"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 482, "favorite_count": 0, "accepted_answer_id": 49526900, "answer_count": 2, "score": 0, "last_activity_date": 1522254267, "creation_date": 1522203954, "last_edit_date": 1522254267, "question_id": 49525117, "link": "https://stackoverflow.com/questions/49525117/dlookup-query-vs-table-in-ms-access-vba", "title": "DLookup: query vs. table in MS Access VBA?", "body": "<p>What is the difference between these two lines of code in MS Access VBA. does it really make a difference?</p>\n\n<p>Facts:</p>\n\n<ol>\n<li>tblLogin is a linked table </li>\n<li>qryA is = tblLogin.*</li>\n</ol>\n\n<p>-</p>\n\n<pre><code>DLookup(\"EmployeeID\", \"qryA\", \"[EmployeeID]=\" &amp; Me.empID) &amp; \"\" = \"\"\n</code></pre>\n\n<p>vs</p>\n\n<pre><code>DLookup(\"EmployeeID\", \"tblLogin\", \"[EmployeeID]=\" &amp; Me.empID) &amp; \"\" = \"\"\n</code></pre>\n\n<p>are there any restrictions that makes us want to go create a query identical to a table?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 169, "user_id": 3673417, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/4b76ffec12c15f199bf4595c57d7f880?s=128&d=identicon&r=PG&f=1", "display_name": "user3673417", "link": "https://stackoverflow.com/users/3673417/user3673417"}, "edited": false, "score": 0, "creation_date": 1522216919, "post_id": 49525625, "comment_id": 86059790, "body": "Thank you. Works a treat."}, {"owner": {"reputation": 169, "user_id": 3673417, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/4b76ffec12c15f199bf4595c57d7f880?s=128&d=identicon&r=PG&f=1", "display_name": "user3673417", "link": "https://stackoverflow.com/users/3673417/user3673417"}, "edited": false, "score": 0, "creation_date": 1522217543, "post_id": 49525625, "comment_id": 86060075, "body": "If I wanted to extend the functionality so that it would pickup a quantity column for each Feature would this be possible? ie if in the raw data table I inserted a new column between each existing Feature column, naming them as Feature1_Qty etc would it be possible to copy the data in the pair of columns to the combined table (which would now have 2 columns). The number of Feature_Qty rows = the associated feature column rows. I assume it would mean introducing something like .ListColumns(c.Value2 &amp; &quot;_Qty&quot;).DataBodyRange.SpecialCells(xlCellTypeConstants).Copy _"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 169, "user_id": 3673417, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/4b76ffec12c15f199bf4595c57d7f880?s=128&d=identicon&r=PG&f=1", "display_name": "user3673417", "link": "https://stackoverflow.com/users/3673417/user3673417"}, "edited": false, "score": 0, "creation_date": 1522217955, "post_id": 49525625, "comment_id": 86060297, "body": "@user3673417 Yes it is possible but not the way you described it in your comment but a bit simpler"}, {"owner": {"reputation": 169, "user_id": 3673417, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/4b76ffec12c15f199bf4595c57d7f880?s=128&d=identicon&r=PG&f=1", "display_name": "user3673417", "link": "https://stackoverflow.com/users/3673417/user3673417"}, "edited": false, "score": 0, "creation_date": 1522218171, "post_id": 49525625, "comment_id": 86060395, "body": "Just solved it by using resize, .DataBodyRange.Resize(, 2). Thank you for your help"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 169, "user_id": 3673417, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/4b76ffec12c15f199bf4595c57d7f880?s=128&d=identicon&r=PG&f=1", "display_name": "user3673417", "link": "https://stackoverflow.com/users/3673417/user3673417"}, "edited": false, "score": 0, "creation_date": 1522218228, "post_id": 49525625, "comment_id": 86060426, "body": "@user3673417 Yes, exactly :)"}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": true, "score": 2, "last_activity_date": 1522208971, "last_edit_date": 1522208971, "creation_date": 1522207768, "answer_id": 49525625, "question_id": 49525107, "link": "https://stackoverflow.com/questions/49525107/combine-specific-table-columns/49525625#49525625", "title": "Combine Specific Table Columns", "body": "<p>You can try this provided you set up your source tables.<br>\nPre-requisite: Create there(3) tables, named <em>RawData</em>, <em>Helper</em> and <em>Combined</em>.<br>\nWhere:</p>\n\n<ul>\n<li><em>RawData</em> is where your data lies</li>\n<li><em>Helper</em> (a single column table) is the list of headers you want to combine</li>\n<li><em>Combined</em> (a single column table) is the list of combined items from selected columns</li>\n</ul>\n\n<hr>\n\n<pre><code>Sub terrain()\n    Dim rD As ListObject, cT As ListObject, hT As ListObject\n    Dim c As Range\n\n    With Sheet1 '/* change to your actual sheet name or sheet code name */\n\n        Set rD = .ListObjects(\"RawData\")\n        Set cT = .ListObjects(\"Combined\")\n        Set hT = .ListObjects(\"Helper\")\n\n        With rD\n            On Error Resume Next\n            cT.DataBodyRange.Delete xlUp\n            On Error GoTo 0\n\n            If Not hT.DataBodyRange Is Nothing Then\n                For Each c In hT.DataBodyRange\n                    If cT.DataBodyRange Is Nothing Then\n                        On Error Resume Next\n                        .ListColumns(c.Value2).DataBodyRange. _\n                        SpecialCells(xlCellTypeConstants).Copy _\n                        cT.HeaderRowRange.Offset(1, 0)\n                        On Error GoTo 0\n                    Else\n                        On Error Resume Next\n                        .ListColumns(c.Value2).DataBodyRange. _\n                        SpecialCells(xlCellTypeConstants).Copy _\n                        cT.DataBodyRange.Range(\"A\" &amp; cT.ListRows.Count + 1)\n                        On Error GoTo 0\n                    End If\n                Next\n            End If\n        End With\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>If however, the column names you provided in your <em>Helper</em> table does not exist, this will result to <code>Subcript out of range</code> error. What I did is not so neat enclosing the copy part with <code>On Error Resume Next</code> and <code>On Error Goto 0</code>.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": -1, "last_activity_date": 1522214636, "creation_date": 1522214636, "answer_id": 49526680, "question_id": 49525107, "link": "https://stackoverflow.com/questions/49525107/combine-specific-table-columns/49526680#49526680", "title": "Combine Specific Table Columns", "body": "<p>Your problem was intriguing but this is largely untested because, quite frankly, I have better things to do with my time than retype your sample data from an image. Happily, it does compile however. Well, it will compile just as soon as you retype the code from my image.</p>\n\n<p><a href=\"https://i.stack.imgur.com/KtWMA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KtWMA.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 169, "user_id": 3673417, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/4b76ffec12c15f199bf4595c57d7f880?s=128&d=identicon&r=PG&f=1", "display_name": "user3673417", "link": "https://stackoverflow.com/users/3673417/user3673417"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 49525625, "answer_count": 2, "score": 0, "last_activity_date": 1522214636, "creation_date": 1522203854, "last_edit_date": 1522206187, "question_id": 49525107, "link": "https://stackoverflow.com/questions/49525107/combine-specific-table-columns", "title": "Combine Specific Table Columns", "body": "<p>I am looking to combine specific columns in a table, specified by the column header, into one column outside of the table. So far I have the below script that works okay except that it combines adjacent columns only and the column numbers are static.</p>\n\n<p>I would like to develop the script so that it works with non-continuous ranges based the column header names. I was going to use a helper column to list the column headers to combine. The below screenshot shows an example where in the helper column H three column headers have been listed (in reality the number of column headers listed will vary) and based on this the data in those columns have been combined to form a new consolidated list in column J. I would like to achieve this using <em>VBA</em> rather than <em>Power Query</em> due to earlier versions of Excel.</p>\n\n<p><a href=\"https://i.stack.imgur.com/IgRob.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IgRob.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub combine()\n\nDim LR As Long, i As Long\n\nFor i = 1 To 6\n    LR = Cells(Rows.Count, i).End(xlUp).Row\n    Range(Cells(2, i), Cells(LR, i)).Copy _\n        Destination:=Cells(Rows.Count, 10).End(xlUp).Offset(1)\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "vlookup", "userform"], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1522209766, "post_id": 49524953, "comment_id": 86057494, "body": "Alternatively, use <code>Application.VLookup</code> and declare <code>Eval2</code> as a <code>Variant</code>; if VLookup fails, <code>Eval2</code> will contain an error value that you can validate with <code>If IsError(Eval2) Then</code> before using it as a <code>String</code>."}, {"owner": {"reputation": 21, "user_id": 7543071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43441ddb306f141ee6eb1dcd469b69f3?s=128&d=identicon&r=PG&f=1", "display_name": "RB1994", "link": "https://stackoverflow.com/users/7543071/rb1994"}, "edited": false, "score": 0, "creation_date": 1522236654, "post_id": 49524953, "comment_id": 86072889, "body": "You were correct, this did allow the code to run properly. However, I cant seem to ever get the VLookup to work. I have even tried searching inside a copy of the same spreadsheet, which should guarantee a match, with no luck. Do you have any more suggestions?"}, {"owner": {"reputation": 43, "user_id": 8953195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52ca75caa839d93018537e80caf65b27?s=128&d=identicon&r=PG&f=1", "display_name": "Moist Carrot", "link": "https://stackoverflow.com/users/8953195/moist-carrot"}, "edited": false, "score": 0, "creation_date": 1522250334, "post_id": 49524953, "comment_id": 86083637, "body": "There&#39;s nothing I can really suggest without seeing some sample data/code. Would you be able to edit your question to provide a minimal working sample of your error?"}], "tags": [], "owner": {"reputation": 43, "user_id": 8953195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52ca75caa839d93018537e80caf65b27?s=128&d=identicon&r=PG&f=1", "display_name": "Moist Carrot", "link": "https://stackoverflow.com/users/8953195/moist-carrot"}, "is_accepted": false, "score": 1, "last_activity_date": 1522209639, "last_edit_date": 1522209639, "creation_date": 1522202632, "answer_id": 49524953, "question_id": 49524793, "link": "https://stackoverflow.com/questions/49524793/populate-textboxes-with-vlookup-from-other-workbooks/49524953#49524953", "title": "Populate Textboxes with VLookup from Other Workbooks", "body": "<p>When you say error code 1004, I am going to assume it tells you something like \"Unable to get VLookup property\" or something. If so, then that means your VLookup is returning an error, which will cause your code to stop executing. To fix this, try incorporating:</p>\n\n<pre><code>Private Sub CommandButton1_Click()    \n    On Error GoTo ErrHandler\n\n    '...your code...\n\n    Exit Sub\n\nErrHandler:\n    If Err.Number &lt;&gt; 0 Then\n       TextBox2.Text = Eval2\n    Else\n       Msgbox \"VLookup did not return a value\"\n    End If\n</code></pre>\n\n<p>into your code to see if that works. This is the best suggestion I can give without any data or the full module to do a test but give it a shot anyways.</p>\n"}], "owner": {"reputation": 21, "user_id": 7543071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43441ddb306f141ee6eb1dcd469b69f3?s=128&d=identicon&r=PG&f=1", "display_name": "RB1994", "link": "https://stackoverflow.com/users/7543071/rb1994"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 323, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522209639, "creation_date": 1522201200, "question_id": 49524793, "link": "https://stackoverflow.com/questions/49524793/populate-textboxes-with-vlookup-from-other-workbooks", "title": "Populate Textboxes with VLookup from Other Workbooks", "body": "<p>I'm a new VBA user and I've run into a bit of a roadblock on my first real UserForm task. I am trying to populate two separate UserForm textboxes with information from VLookup in VBA. The point is to choose two workbooks by path/filename, and run a VLookup based on the ActiveCell in the open workbook. The end goal is to have the user choose which value is preferred, select it, and the new value will be stored in the open workbook. Right now I have a ClickButton that runs the macro (bear with me), and this is the code:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim PR As String\nDim Eval2 As String\nDim book1 As Workbook\nDim extwbk As Workbook\nDim x As Range\n\n\nSet book1 = ThisWorkbook\nSet extwbk = Workbooks.Open(\"C:\\Documents\\ReviewBook.xlsx\")\nSet x = extwbk.Worksheets(\"Sheet2\").Range(\"A1:A100\")\n\n\nPR = Cells(ActiveCell.Row, 1).Value\nEval2 = Application.WorksheetFunction.VLookup(PR, x, 5, False)\nextwbk.Close savechanges:=False\n\nTextbox.Text = PR\nFilePath1.Text = FP1\nFP2 = FilePath2.Text\n\nTextBox2.Text = Eval2\n\nEnd Sub\n</code></pre>\n\n<p>I've had to clean this up from what's actually in my VBA, let me know if anything doesn't work or is unclear. I keep getting Error Code '1004.' Like I said I'm just trying to get \"TextBox2.Text\" to be the value from a VLookup. Thanks for any clarifications or help!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 2, "last_activity_date": 1522199839, "last_edit_date": 1522199839, "creation_date": 1522198506, "answer_id": 49524476, "question_id": 49524239, "link": "https://stackoverflow.com/questions/49524239/copying-multiple-cells-in-excel/49524476#49524476", "title": "Copying multiple cells in Excel", "body": "<p>Try this is assuming your data is consistently alternating (Name,acount).</p>\n\n<pre><code>Sub marine()\n    Dim lr As Long, i As Long\n    Dim sh1 As Worksheet, sh2 As Worksheet\n    '/* declare the worksheets and use variables in the rest of the code */\n    Set sh1 = Sheets(\"Sheet1\"): Set sh2 = Sheets(\"Sheet2\")\n\n    With sh1\n        lr = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row '/* get the last row in Sheet1 */\n        For i = 1 To lr '/* loop to all rows identified */\n            If i Mod 2 = 1 Then '/* check if odd or even, copy in A if odd */\n                .Range(\"A\" &amp; i).Copy _\n                sh2.Range(\"A\" &amp; sh2.Rows.Count).End(xlUp).Offset(1, 0)\n            Else '/* copy in D otherwise */\n                .Range(\"A\" &amp; i).Copy _\n                sh2.Range(\"D\" &amp; sh2.Rows.Count).End(xlUp).Offset(1, 0)\n            End If\n        Next\n    End With\nEnd Sub\n</code></pre>\n\n<p>Above copies data from <em>Sheet1</em> to <em>Sheet2</em> but leaves the 1st row blank.<br>\nAlso, it always copy data on the last row of each column in <em>Sheet2</em> (A and D).<br> So another approach would be:</p>\n\n<pre><code>Sub ject()\n    Dim lr As Long, i As Long, lr2 As Long\n    Dim sh1 As Worksheet, sh2 As Worksheet\n    Dim rNames As Range, rAcct As Range\n    Set sh1 = Sheets(\"Sheet1\"): Set sh2 = Sheets(\"Sheet2\")\n\n    With sh1\n        lr = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n        For i = 1 To lr\n            If i Mod 2 = 1 Then\n                If rNames Is Nothing Then '/* get all the cells with names */\n                    Set rNames = .Range(\"A\" &amp; i)\n                Else\n                    Set rNames = Union(rNames, .Range(\"A\" &amp; i))\n                End If\n            Else\n                If rAcct Is Nothing Then '/* get all the cells with accounts */\n                    Set rAcct = .Range(\"A\" &amp; i)\n                Else\n                    Set rAcct = Union(rAcct, .Range(\"A\" &amp; i))\n                End If\n            End If\n        Next\n    End With\n\n    With sh2\n        '/* get the last filled Names column in Sheet2 */\n        lr2 = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n        rNames.Copy .Range(\"A\" &amp; lr2) '/* execute 1 time copy */\n        rAcct.Copy .Range(\"D\" &amp; lr2) '/* execute 1 time copy */\n    End With\nEnd Sub\n</code></pre>\n\n<p>Above code ensures that the correct account is adjacent to the correct name.<br>\nAnd you might gain execution performance too since one(1) time copy is executed. HTH.</p>\n\n<p><strong>P.S.</strong> As much as possible, <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">avoid using <code>Select</code></a>.</p>\n"}, {"tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1522220089, "last_edit_date": 1522220089, "creation_date": 1522219760, "answer_id": 49527872, "question_id": 49524239, "link": "https://stackoverflow.com/questions/49524239/copying-multiple-cells-in-excel/49527872#49527872", "title": "Copying multiple cells in Excel", "body": "<p>Logic I implemented is to loop until last row in <code>Sheet1</code> in step of 2. Loop variable indicates always row with name, the following row is account number, so it's easy in a loop to assign these values to particular columns on the other sheet. Also, I used another variable <code>j</code>, which indicates consecutive rows in <code>Sheet2</code>.</p>\n\n<p>Solution:</p>\n\n<pre><code>Sub CopyData()\n\nDim sourceWs As Worksheet, targetWs As Worksheet, i As Long, lastRow As Long, j As Long\nj = 1\nSet sourceWs = Worksheets(\"Sheet1\")\nSet targetWs = Worksheets(\"Sheet2\")\nlastRow = sourceWs.Cells(sourceWs.Rows.Count, 1).End(xlUp).Row\n\nFor i = 1 To lastRow Step 2\n    targetWs.Cells(j, 1) = sourceWs.Cells(i, 1)\n    targetWs.Cells(j, 4) = sourceWs.Cells(i + 1, 1)\n    j = j + 1\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9561156, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--UoXZKGvaCU/AAAAAAAAAAI/AAAAAAAAAFg/Z2oARx-ro1w/photo.jpg?sz=128", "display_name": "Treena", "link": "https://stackoverflow.com/users/9561156/treena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 942, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1522220089, "creation_date": 1522196236, "last_edit_date": 1522198074, "question_id": 49524239, "link": "https://stackoverflow.com/questions/49524239/copying-multiple-cells-in-excel", "title": "Copying multiple cells in Excel", "body": "<p>I am new to this but I am trying to copy multiple cells in an excel workbook and paste them into a separate tab of the same workbook. </p>\n\n<p><img src=\"https://i.stack.imgur.com/nMAFy.png\" alt=\"Example:\"></p>\n\n<p>Above is a sample of what my spreadsheet looks like, but my spreadsheet has over 800 lines of data. </p>\n\n<p>I need the names to be copied and put into column A of Sheet2 and then the account numbers into column D of Sheet2. </p>\n\n<p>I have tried this 2 different ways. </p>\n\n<ol>\n<li><p>Using below code:</p>\n\n<pre><code>Sheets(\"Sheet1\").Select\nRange(\"A1,A3,A5,A7,A9\").Select    \nRange(\"A10\").Activate\nSelection.Copy\nSheets(\"Sheet2\").Select\nRange(\"A1\").Select\nActiveSheet.Paste\nSheets(\"Sheet1\").Select\nRange(\"A2,A4,A6,A8,A10\").Select    \nRange(\"A10\").Activate\nSelection.Copy\nSheets(\"Sheet2\").Select\nRange(\"D1\").Select\nActiveSheet.Paste\n</code></pre>\n\n<p>This gives me a <code>Compile Error Syntax Error</code>.</p></li>\n<li><p>Code #2</p>\n\n<pre><code>Range(\"A2\").Select\nSelection.Cut\nRange(\"D1\").Select\nActiveSheet.Paste\nRange(\"A4\").Select\nSelection.Cut\nRange(\"D3\").Select\nActiveSheet.Paste\n...\n</code></pre>\n\n<p>This is keeping them in the same tab, instead of pasting them into a separate tab (I would just copy them over later). I repeat this for each customer. This one gives me a range error that basically says it's too large. Unfortunately, I can't recreate it because I deleted it. </p></li>\n</ol>\n\n<p>Does anyone have a simpler way of doing this that won't cause an error? </p>\n"}, {"tags": ["vba", "ms-access-2010", "dao"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1522218214, "post_id": 49524173, "comment_id": 86060419, "body": "You&#39;ve got a typo there: <code>rs.Filter</code> not <code>rs.Fliter</code>. Is that representative of the actual code?"}, {"owner": {"reputation": 123, "user_id": 4458908, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/80419f0d9ab442fa73906d07ed70f8e8?s=128&d=identicon&r=PG&f=1", "display_name": "Kai", "link": "https://stackoverflow.com/users/4458908/kai"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1522223318, "post_id": 49524173, "comment_id": 86063352, "body": "Sorry, have corrected that mistake. That mistake is not representative of the actual code"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1522225423, "post_id": 49524173, "comment_id": 86064646, "body": "What&#39;s the field type of the <code>DocumentRef</code> field?"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1522276328, "post_id": 49524173, "comment_id": 86098054, "body": "Does it work if use use just one or the other filters?"}, {"owner": {"reputation": 123, "user_id": 4458908, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/80419f0d9ab442fa73906d07ed70f8e8?s=128&d=identicon&r=PG&f=1", "display_name": "Kai", "link": "https://stackoverflow.com/users/4458908/kai"}, "edited": false, "score": 0, "creation_date": 1522280932, "post_id": 49524173, "comment_id": 86099283, "body": "<code>DocumentRef</code> is <code>string</code> Yes, it does works if using only just one of the filters. Either one will works, but not both"}, {"owner": {"reputation": 123, "user_id": 4458908, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/80419f0d9ab442fa73906d07ed70f8e8?s=128&d=identicon&r=PG&f=1", "display_name": "Kai", "link": "https://stackoverflow.com/users/4458908/kai"}, "edited": false, "score": 1, "creation_date": 1522292747, "post_id": 49524173, "comment_id": 86102096, "body": "Opps, input wrong. corrected it"}], "answers": [{"comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1522277115, "post_id": 49545208, "comment_id": 86098289, "body": "You recognised the dot between rs and Filter? But where condition would be more common."}, {"owner": {"reputation": 123, "user_id": 4458908, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/80419f0d9ab442fa73906d07ed70f8e8?s=128&d=identicon&r=PG&f=1", "display_name": "Kai", "link": "https://stackoverflow.com/users/4458908/kai"}, "edited": false, "score": 0, "creation_date": 1522281233, "post_id": 49545208, "comment_id": 86099353, "body": "Its the actual code provided. I can&#39;t copy and paste as I&#39;m developing on another laptop which is not supposed to be air-gap."}], "tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1522294909, "last_edit_date": 1522294909, "creation_date": 1522276263, "answer_id": 49545208, "question_id": 49524173, "link": "https://stackoverflow.com/questions/49524173/dao-recordset-filter-function-cannot-filter-with-2-properties/49545208#49545208", "title": "DAO recordset filter function cannot filter with 2 properties", "body": "<p>It's much easier to troubleshoot if your provide your actual code via copy/paste.\nThat being said, I'm just wondering why you're using two recordsets?\nDo you get the proper answer if you actually do your loop on the real filtered recordset?</p>\n\n<p>Eliminate the line</p>\n\n<pre><code>Set rsFiltered = rs.OpenRecordset\n</code></pre>\n\n<p>Use this block of code on <strong>rs</strong> instead of <strong>rsFiltered</strong></p>\n\n<pre><code>Do While Not rs.EOF\n    ' Do Something\nLoop\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1522285852, "post_id": 49546178, "comment_id": 86100478, "body": "Strange. <code>Option Explicit</code>? Why 2 recordsets and not using a where condtion in rs? And of course use <a href=\"https://stackoverflow.com/questions/49509615/how-do-i-use-parameters-in-vba-in-the-different-contexts-in-microsoft-access\">parameters</a>"}], "tags": [], "owner": {"reputation": 123, "user_id": 4458908, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/80419f0d9ab442fa73906d07ed70f8e8?s=128&d=identicon&r=PG&f=1", "display_name": "Kai", "link": "https://stackoverflow.com/users/4458908/kai"}, "is_accepted": true, "score": 0, "last_activity_date": 1522282879, "creation_date": 1522282879, "answer_id": 49546178, "question_id": 49524173, "link": "https://stackoverflow.com/questions/49524173/dao-recordset-filter-function-cannot-filter-with-2-properties/49546178#49546178", "title": "DAO recordset filter function cannot filter with 2 properties", "body": "<p>I have changed the codes a little bit and it works. But not sure why though.</p>\n\n<pre><code>Private Function getCheckedRecordsFromDB(ByVal cmNum As String) As Boolean\n    Dim rs As Recordset\n    Dim rsFiltered As Recordset\n    Dim dSerial As Double\n\n    'Gets different fields from different tables and store them into rs\n    Set rs = CurrentDb.OpenRecordset(\"QueryMemoOutFrm\")\n\n    rs.Filter = \"Doctype='Outgoing' AND DocumentRef='\" &amp; cmNum &amp; \"'\"\n    Set rsFiltered = rs.OpenRecordset\n\n    ' newly added\n    rsFiltered.MoveFirst\n\n        Do While Not rsFiltered.EOF\n            dSerial = rsFiltered!SerialNo\n            rsFiltered.MoveNext\n        Loop\n\n    rs.Close\n    Set rs = Nothing\n    rsFiltered.Close\n    Set rsFiltered = Nothing\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 4458908, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/80419f0d9ab442fa73906d07ed70f8e8?s=128&d=identicon&r=PG&f=1", "display_name": "Kai", "link": "https://stackoverflow.com/users/4458908/kai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2396, "favorite_count": 0, "accepted_answer_id": 49546178, "answer_count": 2, "score": 0, "last_activity_date": 1522294909, "creation_date": 1522195638, "last_edit_date": 1522292699, "question_id": 49524173, "link": "https://stackoverflow.com/questions/49524173/dao-recordset-filter-function-cannot-filter-with-2-properties", "title": "DAO recordset filter function cannot filter with 2 properties", "body": "<p>I am using VBA in MS Access 2010.</p>\n\n<p>I am currently trying to filter from a recordset with 2 fields.\nHowever i tired, it will not filter as per what i want.</p>\n\n<p>But if i were to filter based on only one field, the recordset is able to filter accordingly.</p>\n\n<p>This is what I have now.</p>\n\n<pre><code>Private Function getCheckedRecordsFromDB(ByVal cmNum As String) As Boolean\n    Dim rs As Recordset\n    Dim rsFiltered As Recordset\n    Dim iSeral As Integer\n\n    'Gets different fields from different tables and store them into rs\n    Set rs = CurrentDb.OpenRecordset(\"QueryMemoOutFrm\")\n\n    ' Its not working during the filtering, keeps returning nothing found\n    rs.Filter = \"Doctype='Outgoing' AND DocumentRef='\" &amp; cmNum &amp; \"'\"\n    Set rsFiltered = rs.OpenRecordset\n\n    Do While Not rsFiltered.EOF\n        ' Do Something\n    Loop\n\n    rs.Close\n    Set rs = Nothing\n    rsFiltered.Close\n    Set rsFiltered = Nothing\nEnd Function\n</code></pre>\n\n<p>I have read the documentation on MSDN, and does not see where did i go wrong. (Maybe i've missed out something)</p>\n"}]